var GC;(()=>{var r,n,t;function i(t){var e,e,e=n[t];return void 0!==e||(e=n[t]={exports:{}},r[t](e,e.exports,i)),e.exports}r={"./node_modules_local/@spreadjs/js-sheets-common/dist/gc.spread.common.js":t=>{var a;!function(){"use strict";var r,n,t,e,i;function o(t){var e,e,e=n[t];return void 0!==e||(e=n[t]={exports:{}},r[t].call(e.exports,e,e.exports,o)),e.exports}r={"./src/common/common.entry.ts":function(t,e,r){var n,i,o,a,u,s,f,y,c,m,M,h,n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&("get"in i?e.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){t[n=void 0===n?r:n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.B3=e.rbush=e.CultureManager=e.CultureInfo=e.zf=e.$T=e.st=e.ct=e.Uf=e.lt=e.ft=void 0,o=r("./src/common/util/colorhelper.ts"),Object.defineProperty(e,"ft",{enumerable:!0,get:function(){return o.ft}}),a=r("./src/common/util/types.ts"),Object.defineProperty(e,"lt",{enumerable:!0,get:function(){return a.lt}}),u=r("./src/common/util/arrayhelper.ts"),Object.defineProperty(e,"Uf",{enumerable:!0,get:function(){return u.Uf}}),s=r("./src/common/util/datetimehelper.ts"),Object.defineProperty(e,"ct",{enumerable:!0,get:function(){return s.ct}}),Object.defineProperty(e,"B3",{enumerable:!0,get:function(){return s.getSR}}),f=r("./src/common/util/numberhelper.ts"),Object.defineProperty(e,"st",{enumerable:!0,get:function(){return f.st}}),y=r("./src/common/util/regexhelper.ts"),Object.defineProperty(e,"$T",{enumerable:!0,get:function(){return y.$T}}),c=r("./src/common/util/stringhelper.ts"),Object.defineProperty(e,"zf",{enumerable:!0,get:function(){return c.zf}}),m=r("./src/common/util/rbush.ts"),Object.defineProperty(e,"rbush",{enumerable:!0,get:function(){return m.rbush}}),M=r("./src/common/util/common.ts"),Object.defineProperty(e,"HandleExcelSpecialDate",{set:function(t){M.HandleExcelSpecialDate=t},get:function(){return M.HandleExcelSpecialDate}}),i(r("./src/common/util/common.ts"),e),h=r("./src/common/culture/cultureInfo.ts"),Object.defineProperty(e,"CultureInfo",{enumerable:!0,get:function(){return h.CultureInfo}}),Object.defineProperty(e,"CultureManager",{enumerable:!0,get:function(){return h.CultureManager}}),i(r("./src/common/util/functionhelper.ts"),e)},"./src/common/culture/cultureInfo.ts":function(j,t,e){var r,n,u,a,i,f,o,s,y,n,c,e,m,M,h,d,E,e,n,l,r,v,g,p,F,R,b,n,_,w,D,H;function N(t){return t.split("\xa0").join(" ").toUpperCase()}function k(t){for(var e,r,n,e=[],r=0,n=t.length;r<n;r++)e[r]=N(t[r]);return e}function $(t,e,r){var t=N(t),e=e.indexOf(t);return e=-1===e?r.indexOf(t):e}function S(t){if(t){var t=t.charCodeAt(0);if(11904<=t&&t<12032||8208<=t&&t<8252||12288<=t&&t<40960||43360<=t&&t<43392||44032<=t&&t<55215||63744<=t&&t<64256||65280<=t&&t<65535)return!0}return!1}function I(t,e,r){var n;return" "===t||r&&"\u3000"===t?0:(n=r&&r(t),e.lineBreakingForbidStart&&-1!==e.lineBreakingForbidStart.indexOf(t)?!r||n?7:6:e.lineBreakingForbidEnd&&-1!==e.lineBreakingForbidEnd.indexOf(t)?!r||n?5:4:n?2:e.lineBreakingChar&&-1!==e.lineBreakingChar.indexOf(t)?3:1)}function P(t,e,r){var n,i,o,a,u,s;if(!t)return[];for(n=[t[0]],o=I(t[i=0],e,r),a=1;a<t.length;a++)u=I(t[a],e,r),h[s=o+""+u]&&n[++i]===f&&(n[i]=""),n[i]+=t[a],o=u;return n}function x(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"},scientificNotation:"0.##############E+00"},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={},this.displayName="",this.predefinedFormats={},this.TimelineDateOrder=[M.quarterOrMonth,M.date,M.year],this.TimelineDateSuffix={year:"",quarter:"",month:"",date:""},this.TextFormat={lineBreakingChar:[" ","-"]}}function C(){}function B(){var t,e,t=_.call(this)||this;return T.call(t,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),T.call(t,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!(e=["MMM yyyy","MMMM yyyy"]),e]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" H:mm:ss",t.name=function(){return"en-US"},t.displayName="English (United States)",t.id=1033,t.predefinedFormats={Accounting:'_([$$-409]* #,##0.00_);_([$$-409]* (#,##0.00);_([$$-409]* "-"??_);_(@_)',Comma:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',Currency:["[$$-409]#,##0","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);([$$-409]#,##0)","[$$-409]#,##0_);[Red]([$$-409]#,##0)"],Date:["m/d/yyyy","[$-409]dddd, mmmm dd, yyyy","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmm d, yyyy;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","m/d/yyyy;@","[$-409]d-mmm-yyyy;@"],Time:["[$-409]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","mm:ss.0;@","[h]:mm:ss;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@"],Special:{"Zip Code":"00000","Zip Code + 4":"00000-0000","Phone Number":"[<=9999999]###-####;(###) ###-####","Social Security Number":"000-00-0000"}},t}function L(){var t,e,r,n,i,n,t=w.call(this)||this,e,r;return T.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u5104",Trillions:"\u5146"}]),T.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],n=["1","2","3","4","5","6","7","8","9","10","11","12",""],n,"\u5348\u524d",!(n=["yyyy\u5e74M\u6708d\u65e5","yyyy\u5e74M\u6708dd\u65e5","yyyy\u5e74MM\u6708d\u65e5","yyyy\u5e74MM\u6708dd\u65e5"]),["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",i=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],i,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",n,"ggge/mmmm/d\u65e5"]),t.DateTimeFormat.eras=!0,t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.QPt=['gggee"\u5e74"MM"\u6708"dd"\u65e5','gggee"\u5e74"M"\u6708"d"\u65e5','ge"\u5e74"M"\u6708"d"\u65e5','ggge"\u5e74"M"\u6708"d"\u65e5','ggee"\u5e74"M"\u6708"d"\u65e5','gge"\u5e74"M"\u6708"d"\u65e5'],t.name=function(){return"ja-JP"},t.id=1041,t.displayName="Japanese (Japan)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\xa5-411]* #,##0.00_-;-[$\xa5-411]* #,##0.00_-;_-[$\xa5-411]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\xa5-411]#,##0_);[Red]([$\xa5-411]#,##0)","[$\xa5-411]#,##0_);([$\xa5-411]#,##0)","[$\xa5-411]#,##0;[Red][$\xa5-411]#,##0","[$\xa5-411]#,##0;-[$\xa5-411]#,##0","[$\xa5-411]#,##0;[Red]-[$\xa5-411]#,##0"],Date:["yyyy/mm/dd","[$-411]dddd, mmmm dd, yyyy",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"yyyy/m/d;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@"],Time:["[$-411]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@",'h"\u6642"mm"\u5206";@','h"\u6642"mm"\u5206"ss"\u79d2";@'],Special:{"\u90f5\u4fbf\u756a\u53f7":"[<=999]000;[<=9999]000-00;000-0000","\u96fb\u8a71\u756a\u53f7\uff08\u6771\u4eac)":"[<=99999999]####-####;(00) ####-####","\u6b63\u8ca0\u8a18\u53f7 \uff08+ = \u25b3; - = \u25b2)":'"\u25b3" #,##0;"\u25b2" #,##0',"\u6f22\u6570\u5b57\uff08\u5341\u4e8c\u4e07\u4e09\u5343\u56db\u767e\uff09":"[DBNum1][$-411]General","\u5927\u5b57 (\u58f1\u62fe\u5f10\u842c\u53c2\u9621\u56db\u767e)":"[DBNum2][$-411]General","\u5168\u89d2 (\uff11\uff12\uff13\uff14\uff15)":"[DBNum3][$-411]0","\u5168\u89d2 \u6841\u533a\u5207\u308a\uff08\uff11\uff12,\uff13\uff14\uff15\uff09":"[DBNum3][$-411]#,##0"}},t.TimelineDateOrder=[M.year,M.quarterOrMonth,M.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"\u6708",date:"\u65e5"},t.TextFormat={lineBreakingChar:[" ","\u3000","-"],lineBreakingForbidStart:["!","%",")",",",".",":",";","?","]","}","\uff01","\uff05","\uff09","\uff0c","\uff0e","\uff1a","\uff1b","\uff1f","\uff3d","\uff5d","\u300d","\u3002","\u3001","\u30fc"],lineBreakingForbidEnd:["(","[","{","\uff08","\uff3b","\uff5b","\u300c","$","\uff04","\\","\uffe5"],lineBreakingStrategy:function(t,e){return P(t,e,S)}},t}function A(){var t,e,r,n,i,n,t=D.call(this)||this,e,r;return T.call(t,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:o,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},{Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u4ebf",Trillions:"\u5146"}]),T.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],n=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],n,"\u4e0a\u5348",!(n=["yyyy\u5e74M\u6708","M\u6708d\u65e5","yyyy\u5e74M\u6708d\u65e5","h\u65f6mm\u5206","h\u65f6mm\u5206ss\u79d2"]),["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",i=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],i,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",n]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"zh-cn"},t.id=2052,t.displayName="Chinese (China)",t.isJCKCulture=!0,t.localeCompare=function(t,e){return t.localeCompare(e,"zh")},t.predefinedFormats={Accounting:'_ [$\xa5-804]* #,##0.00_ ;_ [$\xa5-804]* -#,##0.00_ ;_ [$\xa5-804]* "-"??_ ;_ @_ ',Comma:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ',Currency:["[$\xa5-804]#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]#,##0","[$\xa5-804]#,##0;[$\xa5-804]-#,##0","[$\xa5-804]#,##0;[Red][$\xa5-804]-#,##0"],Date:["yyyy/m/d","[$-804]dddd, mmmm dd, yyyy","yyyy-mm-dd;@",'[DBNum1][$-804]yyyy"\u5e74"m"\u6708"d"\u65e5";@','[DBNum1][$-804]yyyy"\u5e74"m"\u6708";@','[DBNum1][$-804]m"\u6708"d"\u65e5";@',"[$-409]yyyy/m/d h:mm AM/PM;@",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"mm/dd/yy;@","m/d/yy;@","yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["[$-804]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@",'h"\u65f6"mm"\u5206";@','h"\u65f6"mm"\u5206"ss"\u79d2";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@','[$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2";@','[DBNum1][$-804]h"\u65f6"mm"\u5206";@','[DBNum1][$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@'],Special:{"\u90ae\u653f\u7f16\u7801":"000000","\u4e2d\u6587\u5c0f\u5199\u5b57\u6bcd":"[DBNum1][$-804]General","\u4e2d\u6587\u5927\u5199\u5b57\u6bcd":"[DBNum2][$-804]General"}},t.TimelineDateOrder=[M.year,M.quarterOrMonth,M.date],t.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"",date:"\u65e5"},t.TextFormat={lineBreakingChar:[" ","\u3000","-"],lineBreakingForbidStart:["!","%",")",",",".",":",";","?","]","}","\uff01","\uff05","\uff09","\uff0c","\uff0e","\uff1a","\uff1b","\uff1f","\uff3d","\uff5d"],lineBreakingForbidEnd:["(","[","{","\uff08","\uff3b","\uff5b"],lineBreakingStrategy:function(t,e){return P(t,e,S)}},t}function G(){var t,e,r,n,n,t=H.call(this)||this,e,r;return T.call(t,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"\u20a9",!1,{1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]},4:{letters:["\uc870","\ucc9c","\ubc31","\uc2ed","\uc5b5","\ucc9c","\ubc31","\uc2ed","\ub9cc","\ucc9c","\ubc31","\uc2ed",""],numbers:["\u25cb","\uc77c","\uc774","\uc0bc","\uc0ac","\uc624","\uc721","\uce60","\ud314","\uad6c"]}},{Hundreds:"\ubc31",Thousands:"\ucc9c",Millions:"\ubc31\ub9cc",Billions:"10\uc5b5",Trillions:"\uc870"}]),T.call(t,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],n=["1","2","3","4","5","6","7","8","9","10","11","12",""],n,"\uc624\uc804",!(n=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""]),["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",n,n,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'","yyyy\ub144/mmmm/d\uc77c"]),t.DateTimeFormat.defaultDatePattern=t.DateTimeFormat.shortDatePattern+" "+t.DateTimeFormat.longTimePattern,t.name=function(){return"ko-kr"},t.id=1042,t.displayName="Korean (Korea)",t.isJCKCulture=!0,t.predefinedFormats={Accounting:'_-[$\u20a9-412]* #,##0.00_-;-[$\u20a9-412]* #,##0.00_-;_-[$\u20a9-412]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red][$\u20a9-412]#,##0","[$\u20a9-412]#,##0;-[$\u20a9-412]#,##0","[$\u20a9-412]#,##0;[Red]-[$\u20a9-412]#,##0"],Date:["yyyy-mm-dd",'yyyy"\ub144" m"\uc6d4" d"\uc77c" dddd',"yyyy-mm-dd;@",'yyyy"\ub144" m"\uc6d4" d"\uc77c";@','yy"\u5e74" m"\u6708" d"\u65e5";@','yyyy"\ub144" m"\uc6d4";@','m"\uc6d4" d"\uc77c";@',"yy-m-d;@","yy-m-d h:mm;@",'m"\u6708"d"\u65e5";@',"[$-412]yy-m-d AM/PM h:mm;@","yy/m/d;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["[$-412]h:mm:ss AM/PM","h:mm;@","h:mm:ss;@","[$-412]AM/PM h:mm;@","[$-412]AM/PM h:mm:ss;@","[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'yyyy"-"m"-"d h:mm;@','[$-412]yyyy"-"m"-"d AM/PM h:mm;@','[$-409]yyyy"-"m"-"d h:mm AM/PM;@','h"\uc2dc" mm"\ubd84";@','h"\uc2dc" mm"\ubd84" ss"\ucd08";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84" ss"\ucd08";@'],Special:{"\uc6b0\ud3b8 \ubc88\ud638":"000-000","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 4\uc790\ub9ac)":"[<=999999]####-####;(0##) ####-####","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 3\uc790\ub9ac)":"[<=9999999]###-####;(0##) ###-####","\uc8fc\ubbfc\ub4f1\ub85d\ubc88\ud638":"000000-0000000","\uc22b\uc790(\ud55c\uc790)":"[DBNum1][$-412]General","\uc22b\uc790(\ud55c\uc790-\uac16\uc740\uc790)":"[DBNum2][$-412]General","\uc22b\uc790(\ud55c\uae00)":"[DBNum4][$-412]General"}},t.TimelineDateOrder=[M.year,M.quarterOrMonth,M.date],t.TimelineDateSuffix={year:"\ub144",quarter:"",month:"\uc6d4",date:"\uc77c"},t}function T(t,e,r){for(var n,i,o,a,n=this,o=0,a=e.length;o<a;o++)i=e[o],n[t][i]=r[o]}function z(t,e){var r;"object"==typeof document&&("function"!=typeof CustomEvent?(r=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):r=new CustomEvent("cultureChanged",{}),r.cultureInfo=t,i.gcCultureInfo=t,i.gcCultureObj=e,document.dispatchEvent(r))}function O(){this.KPt=1,this.JPt={}}r=this&&this.__extends||(b=function(t,e){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CultureManager=t.XPt=t.CultureInfo=t.TimelineDateOrder=void 0,n=e("./src/common/util/types.ts"),u=e("./src/common/util/common.ts"),a=e("./src/common/util/arrayhelper.ts"),i="undefined"!=typeof window?window:e.g,f=void 0,o=null,s=n.lt.y0,y=n.lt.Dh,e=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],m=(n=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(c=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"]),s(n,function(t,r){s(c,function(t,e){t<c.length-4&&m.push(r+" "+e)})}),m=m.concat(e),s(e,function(t,r){s(c,function(t,e){t<c.length-4&&m.push(r+" "+e)})}),(n=M=t.TimelineDateOrder||(t.TimelineDateOrder={}))[n.year=1]="year",n[n.quarterOrMonth=2]="quarterOrMonth",n[n.date=3]="date",h={"00":1,"01":1,"02":1,"03":1,"04":1,"05":1,"06":1,"07":1,12:1,15:1,21:1,22:1,23:1,24:1,25:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1,62:1,65:1,71:1,72:1,73:1,74:1,75:1},x.prototype.u2e=function(){return[" "]},x.prototype.tCe=function(t){var e,r,n,e=this,r,n={lineBreakingChar:e.u2e()};return e.TextFormat&&e.TextFormat.lineBreakingStrategy?e.TextFormat.lineBreakingStrategy(t,n):P(t,n)},x.prototype.hse=function(t){var e;return this.TextFormat&&this.TextFormat.lineBreakingStrategy?(e={lineBreakingChar:this.TextFormat.lineBreakingChar,lineBreakingForbidEnd:this.TextFormat.lineBreakingForbidEnd,lineBreakingForbidStart:this.TextFormat.lineBreakingForbidStart},this.TextFormat.lineBreakingStrategy(t,e)):P(t,this.TextFormat||{lineBreakingChar:[" ","-"]})},x.prototype.qPt=function(){var t,e,e,r;return this.$Pt||(e=(e=[e=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),e+" h:mm",e+" h:mm:ss",e+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(m),1041===this.id&&(r=t.eraFormatter,e=(e=e.concat(this.QPt)).concat(r)),e=e.concat(t.preselectedFormatters),this.$Pt=e),this.$Pt},x.prototype.tGt=function(t){var e=this;return e.nGt||(e.nGt=k(e.DateTimeFormat.monthNames),e.eGt=k(e.DateTimeFormat.monthGenitiveNames)),$(t,e.nGt,e.eGt)},x.prototype.iGt=function(t){var e=this;return e.rGt||(e.rGt=k(e.DateTimeFormat.abbreviatedMonthNames),e.oGt=k(e.DateTimeFormat.abbreviatedMonthGenitiveNames)),$(t,e.rGt,e.oGt)},x.prototype.aGt=function(t){var e=this;return e.uGt||(e.uGt=k(e.DateTimeFormat.dayNames)),e.uGt.indexOf(N(t))},x.prototype.sGt=function(t){var e=this;return e.cGt||(e.cGt=k(e.DateTimeFormat.abbreviatedDayNames)),e.cGt.indexOf(N(t))},d=x,t.CultureInfo=d,C.fGt=function(t){return t>=C.lGt()&&t<=C.hGt()},C.dGt=function(){var t,e,r,t=d.eras;if(t===f)return this.vGt;for(e=[],r=0;r<t.length;r++)e[r]=new Date(t[r].startDate.replace(/-/g,"/"));return e},C.mGt=function(t){var e,r,n,i,o;switch(t){case"g":e="symbol",r=C.gGt;break;case"gg":e="abbreviation",r=C.pGt;break;case"ggg":e="name",r=C.DEt;break;default:return[]}if(i=[],(n=d.eras)===f)return r;for(o=0;o<n.length;o++)i[o]=n[o][e];return i},C.hGt=function(){var t,t,t=d.eras;return t!==f&&0<t.length?((t=new Date(t[t.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.bGt},C.lGt=function(){var t=d.eras;return t!==f&&0<t.length?new Date(t[0].startDate.replace(/-/g,"/")):this.yGt},C.wGt=function(){var t=d.eras;return t!==f?t.length:this.MGt},C.CGt=function(){var t,e,r,n,i,t=d.eras;if(t===f)return this.SGt;for(e=[],r=1;r<t.length;r++)n=new Date(t[r-1].startDate.replace(/-/g,"/")),i=new Date(t[r].startDate.replace(/-/g,"/")),e[r-1]=i.getFullYear()-n.getFullYear()+1;return e[r-1]=99,e},C.TGt=function(t){var e,r,n,e={AGt:-1,IGt:-1};if(!C.fGt(t)){if(!(t>C.hGt()))return e;t=C.hGt()}for(r=0;r<C.wGt();r++)if(t<(n=r+1!==C.wGt()?C.dGt()[r+1]:C.xGt(C.hGt(),1))){e.AGt=r,e.IGt=t.getFullYear()-C.dGt()[r].getFullYear()+1;break}return e},C.xGt=function(t,e){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+e),new Date(t.valueOf())},C.NGt=function(t,e){var r;return C.dGt()[t].getFullYear()+e-1},C.kGt=function(t,e){var r,n;for(e=e.toUpperCase(),r=C.mGt(t),n=0;n<r.length;n++)if(r[n]===e)return n;return-1},C.DGt=function(t,e,r){var n,e,i,n,n,i,n=C,e=n.TGt(e),i=e.AGt;if(0<=i&&0<(n=n.mGt(t)).length)return n[i];if(0<=(n=e.IGt)){if("1"===(i=n.toString())&&r)return i="\u5143";if("ee"===t)return i=1===i.length?"0"+i:i;if("e"===t)return i}return""},C.vGt=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],C.MGt=5,C.SGt=[45,15,64,31,99],C.bGt=new Date(2117,11,31,23,59,59),C.yGt=new Date(1868,8,8),C._Gt=["1,m","2,t","3,s","4,h","5,r"],C.EGt=[0,1,2,3,0,1,2,3],C.DEt=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210","\u4ee4\u548c"],C.gGt=["M","T","S","H","R"],C.pGt=["\u660e","\u5927","\u662d","\u5e73","\u4ee4"],C.jGt=99,C.eraExcelFormatter="[$-ja-JP-x-gannen]",C.eraInternalFormatter="[$-411]",t.XPt=C,r(B,_=d),e=B,r(L,w=d),n=L,r(A,D=d),A.prototype.u2e=function(){return[" ","\u3000"]},l=A,r(G,H=d),r=G,v={invariant:new d,"en-us":new e,"ja-jp":new n,"zh-cn":new l,"ko-kr":new r},g={},p=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],F=["wmk1","wmk2"],O.instance=function(){return this.OGt||(this.OGt=new this)},O.prototype.culture=function(t){if(0===arguments.length)return O.RGt;t&&O.RGt!==t&&(O.RGt=t.toLowerCase(),this.KPt++,z(O.RGt,O.OGt.getCultureInfo()))},O.prototype.addCultureInfo=function(t,e,r){var n,i,o,a,n;if(e&&e instanceof d){if(n=e.NumberFormat&&e.NumberFormat.numberDecimalSeparator,i=e.NumberFormat.arrayListSeparator,o=e.NumberFormat.arrayGroupSeparator,n===e.NumberFormat.listSeparator||o===i)throw(a=new u.ResourceManager(u.SR)).getResource().Exp_Separator;v[t.toLowerCase()]=e}r&&"object"==typeof r&&(n=t.toLowerCase(),g[n]=y(!0,{},r),this.KPt++)},O.prototype.getCultureInfoDict=function(){return v},O.prototype.getCultureInfo=function(t){var e,r,n;if(0===arguments.length)return v[O.RGt];for(n in"string"==typeof t&&(t=t.toLowerCase()),r=o,e=v)if(n===t||e[n].id!==f&&e[n].id===t){r=e[n];break}return r},O.prototype.getLanguage=function(t){var t;return"string"==typeof t?(t=t.toLowerCase(),g[t]):o},O.prototype.getResources=function(t){var e,e,e=this.culture().toLowerCase();return"string"==typeof(t=t!==o&&t!==f?t:e)&&(e=t.toLowerCase(),this.JPt[e])?this.BGt(this.JPt[e]):o},O.prototype.BGt=function(t){var e,r,n,i,o,t,e,e="PivotTables",r="Sheets",n="CalcEngine",i="Functions",o="TableFunctions",t=y(!0,{},t);return t[e]&&this.LGt(t[e],F),t[r]&&this.LGt(t[r],p),(e=t[n])&&(t[i]=e.wmt,t[o]=e.d2t,delete e.wmt,delete e.d2t),t},O.prototype.LGt=function(t,e){for(var r,n,i,r=0,n=e;r<n.length;r++)delete t[i=n[r]]},O.prototype.FGt=function(t,e,r){var n,i,o,n=g[t.toLowerCase()];for(i in e)a.Uf.OS(p,i)||null!==(o=this.PGt(n,i,r))&&"string"==typeof o&&"string"==typeof e[i]&&(e[i]=o);e.wmt&&n.Functions&&this.GGt(n.Functions,e.wmt),e.d2t&&n.TableFunctions&&y(!0,e.d2t,n.TableFunctions)},O.prototype.PGt=function(t,e,r){var n,i;if(t.hasOwnProperty(e))return t[e];if(r&&(n=t[r])&&"object"==typeof n&&n.hasOwnProperty(e))return n[e];for(i in t)if((n=t[i])&&"object"==typeof n&&n.hasOwnProperty(e))return n[e];return null},O.prototype.GGt=function(t,e){var r,n,i,o,a,u,s,f,r={};for(n in e)if(t.hasOwnProperty(n))for(s in i=e[n],o=t[n],a=i.parameters,u=o.parameters,i.description=o.description,a)u.hasOwnProperty(s)&&"string"==typeof(f=u[s])&&(a[s].name=f);return r},O.prototype.Fe=function(t){var t=this.getCultureInfo(t),t;return t=(t=t||v[O.RGt])||new d},O.prototype.xat=function(t,e){var r,t,n,r,t=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,n=t.filterDialogDateFormatter;return n=0<=e.indexOf("g")||0<=e.indexOf("e")?t.EraFilterDialogDateFormatter||n:n},O.RGt="en-us",t.CultureManager=O.instance()},"./src/common/util/arrayhelper.ts":function(t,e){var i,o,r;function a(t,e){var r,n;for(r in e)e.hasOwnProperty(r)&&(n=e[r],Array.isArray(n)?(t[r]=[],a(t[r],e[r])):n!==i&&"object"==typeof n?(t[r]={},a(t[r],e[r])):t[r]=e[r])}function n(){}Object.defineProperty(e,"__esModule",{value:!0}),e.Uf=void 0,i=null,o=void 0,n.Eit=function(t,e,r){t.splice(e,0,r)},n.ZP=function(t,e){t.push(e)},n.OS=function(t,e){return-1<t.indexOf(e)},n.VP=function(t,e){var e=t.indexOf(e);-1<e&&t.splice(e,1)},n.UGt=function(t,e){return t.slice(0,e).concat(t.slice(e+1))},n.hD=function(t,e,r){return t.indexOf(e,r)},n.d5=function(t,e,r){if(!(e<0))for(var n=0;n<r&&e+n<t.length;n++)t[e+n]=i},n.N2t=function(t,e){for(var r,n,n=r=(e=e<0?-1:e)+1;n<t.length;n++)if(t[n]!==o&&t[n]!==i)return n;return-1},n.tR=function(t){return t&&t.length},n.Gf=function(t){var e=[];return a(e,t),e},e.Uf=n},"./src/common/util/colorhelper.ts":function(t,e,i){var r,o,s,f,a,y,c,n,m,u;function M(t,e,r){return r<0&&(r+=240),240<r&&(r-=240),r<40?t+((e-t)*r+20)/40:r<120?e:r<160?t+((e-t)*(160-r)+20)/40:t}function h(t,e,r){var n,i,o,a,u;return 0===r?n=i=o=y(255*e/240+"",10):(u=a=void 0,n=d(a=2*e-(u=e<=120?y((e*(240+r)+120)/240+""):e+r-y((e*r+120)/240+"")),u,t+80),i=d(a,u,t),o=d(a,u,t-80)),{a:255,r:n,g:i,b:o}}function d(t,e,r){return s(y((255*M(t,e,r)+120)/240+""),255)}function l(t){var e,r,n,t,i,o,a,o,a,u,t,e=this,r=t.r,n=t.g,t=t.b,i=f(f(r,n),t),o=s(s(r,n),t),a=i+o;e.HGt=y((240*a+255)/510+"",10),0==(o=i-o)?(e.zGt=0,e.wv=160):(e.HGt<=120?e.zGt=y((240*o+a/2)/a+"",10):e.zGt=y((240*o+(510-a)/2)/(510-a)+"",10),a=(40*(i-r)+o/2)/o,u=(40*(i-n)+o/2)/o,t=(40*(i-t)+o/2)/o,e.wv=y(r===i?t-u+"":n===i?80+a-t+"":160+u-a+"",10),e.wv<0&&(e.wv+=240),240<e.wv&&(e.wv-=240))}function v(t){var e,r,n,i,e,o,a,u,e,n;return/^#[A-Fa-f0-9]+$/.test(t)?(e=t.replace(/^#/,""),i=n="",6===(r=e.length)||8===r?(n=e.substr(0,6),8===r&&(i=e.substr(6,2))):3!==r&&4!==r||(n=(e=e.split(3===r?/(.)/:/(..)/)).filter(Boolean).map(function(t){return parseInt(3===r?t+t:t,16)}).map(function(t){return t.toString(16).padStart(2,"0")}).join(""),4===r&&(i=e[3]+e[3])),[o=parseInt(n.slice(0,2),16),a=parseInt(n.slice(2,4),16),u=parseInt(n.slice(4,6),16),e=i?parseInt(i,16):255]):t.toLowerCase()in c?c[t.toLowerCase()]:null!==(n=m.exec(t))?(e=void 0===n[4]?255:255*+n[4],[n[1],n[2],n[3],e]):null}function g(){}Object.defineProperty(e,"__esModule",{value:!0}),e.ft=void 0,r=i("./src/common/util/numberhelper.ts"),o=r.st.VGt,s=Math.min,f=Math.max,a=Math.abs,y=parseInt,c={aliceblue:[240,248,255,255],antiquewhite:[250,235,215,255],aqua:[0,255,255,255],aquamarine:[127,255,212,255],azure:[240,255,255,255],beige:[245,245,220,255],bisque:[255,228,196,255],black:[0,0,0,255],blanchedalmond:[255,235,205,255],blue:[0,0,255,255],blueviolet:[138,43,226,255],brown:[165,42,42,255],burlywood:[222,184,135,255],cadetblue:[95,158,160,255],chartreuse:[127,255,0,255],chocolate:[210,105,30,255],coral:[255,127,80,255],cornflowerblue:[100,149,237,255],cornsilk:[255,248,220,255],crimson:[220,20,60,255],cyan:[0,255,255,255],darkblue:[0,0,139,255],darkcyan:[0,139,139,255],darkgoldenrod:[184,134,11,255],darkgray:[169,169,169,255],darkgreen:[0,100,0,255],darkgrey:[169,169,169,255],darkkhaki:[189,183,107,255],darkmagenta:[139,0,139,255],darkolivegreen:[85,107,47,255],darkorange:[255,140,0,255],darkorchid:[153,50,204,255],darkred:[139,0,0,255],darksalmon:[233,150,122,255],darkseagreen:[143,188,143,255],darkslateblue:[72,61,139,255],darkslategray:[47,79,79,255],darkslategrey:[47,79,79,255],darkturquoise:[0,206,209,255],darkviolet:[148,0,211,255],deeppink:[255,20,147,255],deepskyblue:[0,191,255,255],dimgray:[105,105,105,255],dimgrey:[105,105,105,255],dodgerblue:[30,144,255,255],firebrick:[178,34,34,255],floralwhite:[255,250,240,255],forestgreen:[34,139,34,255],fuchsia:[255,0,255,255],gainsboro:[220,220,220,255],ghostwhite:[248,248,255,255],gold:[255,215,0,255],goldenrod:[218,165,32,255],gray:[128,128,128,255],green:[0,128,0,255],greenyellow:[173,255,47,255],grey:[128,128,128,255],honeydew:[240,255,240,255],hotpink:[255,105,180,255],indianred:[205,92,92,255],indigo:[75,0,130,255],ivory:[255,255,240,255],khaki:[240,230,140,255],lavender:[230,230,250,255],lavenderblush:[255,240,245,255],lawngreen:[124,252,0,255],lemonchiffon:[255,250,205,255],lightblue:[173,216,230,255],lightcoral:[240,128,128,255],lightcyan:[224,255,255,255],lightgoldenrodyellow:[250,250,210,255],lightgray:[211,211,211,255],lightgreen:[144,238,144,255],lightgrey:[211,211,211,255],lightpink:[255,182,193,255],lightsalmon:[255,160,122,255],lightseagreen:[32,178,170,255],lightskyblue:[135,206,250,255],lightslategray:[119,136,153,255],lightslategrey:[119,136,153,255],lightsteelblue:[176,196,222,255],lightyellow:[255,255,224,255],lime:[0,255,0,255],limegreen:[50,205,50,255],linen:[250,240,230,255],magenta:[255,0,255,255],maroon:[128,0,0,255],mediumaquamarine:[102,205,170,255],mediumblue:[0,0,205,255],mediumorchid:[186,85,211,255],mediumpurple:[147,112,219,255],mediumseagreen:[60,179,113,255],mediumslateblue:[123,104,238,255],mediumspringgreen:[0,250,154,255],mediumturquoise:[72,209,204,255],mediumvioletred:[199,21,133,255],midnightblue:[25,25,112,255],mintcream:[245,255,250,255],mistyrose:[255,228,225,255],moccasin:[255,228,181,255],navajowhite:[255,222,173,255],navy:[0,0,128,255],oldlace:[253,245,230,255],olive:[128,128,0,255],olivedrab:[107,142,35,255],orange:[255,165,0,255],orangered:[255,69,0,255],orchid:[218,112,214,255],palegoldenrod:[238,232,170,255],palegreen:[152,251,152,255],paleturquoise:[175,238,238,255],palevioletred:[219,112,147,255],papayawhip:[255,239,213,255],peachpuff:[255,218,185,255],peru:[205,133,63,255],pink:[255,192,203,255],plum:[221,160,221,255],powderblue:[176,224,230,255],purple:[128,0,128,255],rebeccapurple:[102,51,153,255],red:[255,0,0,255],rosybrown:[188,143,143,255],royalblue:[65,105,225,255],saddlebrown:[139,69,19,255],salmon:[250,128,114,255],sandybrown:[244,164,96,255],seagreen:[46,139,87,255],seashell:[255,245,238,255],sienna:[160,82,45,255],silver:[192,192,192,255],skyblue:[135,206,235,255],slateblue:[106,90,205,255],slategray:[112,128,144,255],slategrey:[112,128,144,255],snow:[255,250,250,255],springgreen:[0,255,127,255],steelblue:[70,130,180,255],tan:[210,180,140,255],teal:[0,128,128,255],thistle:[216,191,216,255],tomato:[255,99,71,255],turquoise:[64,224,208,255],violet:[238,130,238,255],wheat:[245,222,179,255],white:[255,255,255,255],whitesmoke:[245,245,245,255],yellow:[255,255,0,255],yellowgreen:[154,205,50,255]},l.prototype.YGt=function(t){var e,r,n,e=this,r=e.HGt,n=e.ZGt(e.HGt,500,!0);return h(e.wv,r+(n-r)*t,e.zGt)},l.prototype.ZGt=function(t,e,r){if(0!==e){if(r)return 0<e?(t*(1e3-e)+241*e)/1e3:t*(e+1e3)/1e3;240<(t=(t+=240*e/1e3)<0?0:t)&&(t=240)}return t},n=l,m=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(?:,\s*(\.\d+|\d(?:\.\d+)?))?\)/,g.j=function(t){var e,r,n,i,e=t.a,r=t.r,n=t.g,i=t.b;return 3===arguments.length&&(e=255,r=t,n=arguments[1],i=arguments[2]),4===arguments.length&&(e=t,r=arguments[1],n=arguments[2],i=arguments[3]),255===e?"#"+o(r,!0,2)+o(n,!0,2)+o(i,!0,2):"rgba("+r+","+n+","+i+","+e+")"},g.Tv=function(t,e){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(e):t.a===e.a&&t.r===e.r&&t.g===e.g&&t.b===e.b},g.rp=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},g.Km=function(t,e){var r,n,i,t,o,r=255-a(t.r-e.r),n=255-a(t.g-e.g),i=255-a(t.b-e.b),t=a(t.a-e.a);return!!(.9<=(o=((r/=255)+(n/=255)+(i/=255))/3)&&t<=.05)},g.Uv=function(t){var e,r,n,e=255^t.r,r=255^t.g,n=255^t.b;return g.j(t.a,e,r,n)},g.WGt=function(t){var e,r,n,n;return"object"==typeof document&&((e=g.xf)||(r=document.createElement("canvas"))&&r.getContext&&(e=g.xf=r.getContext("2d",{willReadFrequently:!0})),e||((n=i("canvas"))&&n.createCanvas&&(r=n.createCanvas(2,2),e=g.xf=r.getContext("2d")),e))?(e.clearRect(1,1,1,1),e.fillStyle=t,e.fillRect(1,1,1,1),(n=e.getImageData(1,1,1,1))?n.data:null):v(t)},g._=function(t){var e,r,n,i,t;return t instanceof g||null!==t&&"object"==typeof t?t:(i=n=r=e=0,t&&(t=g.WGt(t))&&(r=t[0],n=t[1],i=t[2],e=t[3]),{a:e,r:r,g:n,b:i})},g.Cv=function(t,e){var t,e;return 0===e?t:(t=new n(t),e=y((0<e?(240-t.HGt)*e:t.HGt*e)+"",10),g.QGt(t.wv,t.HGt+e,t.zGt))},g.YGt=function(t,e){var t,r,t,t=g._(t),r,t=new n(t).YGt(e);return g.j(t)},g.Dz=M,g.QGt=h,e.ft=g},"./src/common/util/common.ts":function(t,e,r){var i,n,r,o,a;function u(t,e){this.res=t,this.KGt=e,this.JPt=i.CultureManager.JPt,this.cachedResource=this.JGt(t,!0),this.XGt(this.cachedResource,e),this.KPt=0}function s(t,e,r,n){var i,o,a,u,s;if(t&&0<=r&&r<e){for(i=[],a=o=void 0,a=r;a<e;a++)void 0!==t[a]&&i.push(a);for(o=i.length,a=0;a<o;a++)s=t[u=i[o-a-1]],t[u]=null,t[Math.floor(u)+n]=s}}function f(t,e,r,n){var i,o,a,u,s,f;if(t&&0<=r&&r<e){for(i=[],a=r+n,u=o=void 0,u=r;u<e;u++)void 0!==t[u]&&(r<=u&&u<a?t[u]=null:a<=u&&i.push(u));for(o=i.length,u=0;u<o;u++)f=t[s=i[u]],t[s]=null,t[Math.floor(s)-n]=f}}function y(t,e){return t.hasOwnProperty(e)}function c(t,e){return t instanceof e}Object.defineProperty(e,"__esModule",{value:!0}),e.ut=e.kh=e.X8=e.J8=e.ResourceManager=e.SR=void 0,i=r("./src/common/culture/cultureInfo.ts"),n=r("./src/common/util/util.res.en.ts"),r=r("./src/common/util/types.ts"),e.SR={en:n},o=r.lt.Dh,u.prototype.getResource=function(){var t=this.JGt(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.XGt(this.cachedResource,this.KGt),this.cachedResource},u.prototype.XGt=function(t,e){var r,n;e&&(n=(r=i.CultureManager.culture()).toLowerCase(),this.JPt[n]=this.JPt[n]||{},this.JPt[n][e]=t,i.CultureManager.JPt=this.JPt)},u.prototype.JGt=function(t,e){var r,n,e,n,r=i.CultureManager.culture();return t&&r?(n=i.CultureManager.KPt,this.KPt!==n||e?(this.KPt=n,i.CultureManager.getLanguage(r)?(e=o(!0,{},t.en),i.CultureManager.FGt(r,e,this.KGt),e):(n=r.substr(0,2).toLowerCase(),t.hasOwnProperty(n)?t[n]:t.en)):void 0):{}},e.ResourceManager=u,e.J8=s,e.X8=f,e.kh=y,e.ut=c},"./src/common/util/datetimehelper.ts":function(t,x,e){var r,k,M,C,e,a,A,$,S,P,n,T,O,e,o,i;function j(t,e){if(r.HandleExcelSpecialDate)return r.HandleExcelSpecialDate.apply(null,[t,e]);switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:return}}function E(t,e,r,n){var i,o,a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,b,F,_,w,D,H,N,k,$,i=r.DateTimeFormat,o=i.Calendar.convert;if(!e||!e.length)return r&&r.name.length?o?E(t,i.fullDateTimePattern,r):t.toLocaleString():t.toString();function S(){return y||c||(y=m.test(e),c=!0),y}function P(t,e){return d?d[e]:j(t,e)}for(a=i.eras,s="",m=/([^d]|^)(d|dd)([^d]|$)/g,M=0,h=B(),!(u="s"===e)&&o&&(d=o.fromGregorian(t)),v=l=-2,g={y4:""},p=0;F=h.lastIndex,b=h.exec(e),F=e.slice(F,b?b.index:e.length),g.y4="",M+=R(F,g),s+=g.y4,b;p++)if(M%2==1)s+=b[0];else switch(_=P(t,0),w=t.getDay(),D=t.getHours(),H=t.getMinutes(),N=t.getSeconds(),k=t.getMilliseconds(),$=t.getTimezoneOffset(),b[0]){case"dddd":s+=i.dayNames[w];break;case"ddd":s+=i.abbreviatedDayNames[w];break;case"dd":y=!0,s+=A(P(t,2),2);break;case"d":y=!0,s+=P(t,2);break;case"MMMM":s+=(i.monthGenitiveNames&&S()?i.monthGenitiveNames:i.monthNames)[P(t,1)];break;case"MMM":s+=(i.abbreviatedMonthGenitiveNames&&S()?i.abbreviatedMonthGenitiveNames:i.abbreviatedMonthNames)[P(t,1)];break;case"MM":s+=A(P(t,1)+1,2);break;case"M":s+=P(t,1)+1;break;case"yyyy":case"yyy":s+=0<=l?C.XPt.DGt("ee",t,n):A(d?d[0]:_,4);break;case"yy":s+=0<=l?C.XPt.DGt("ee",t,n):A((d?d[0]:_)%100,2);break;case"y":s+=0<=l?C.XPt.DGt("e",t,n):((d?d[0]:_)%100).toString();break;case"hh":s+=A(f=0===(f=D%12)?12:f,2);break;case"h":s+=f=0===(f=D%12)?12:f;break;case"HH":s+=A(D,2);break;case"H":s+=D.toString();break;case"mm":s+=A(H,2);break;case"m":s+=H.toString();break;case"ss":s+=A(N,2);break;case"s":s+=N.toString();break;case"tt":s+=D<12?i.amDesignator:i.pmDesignator;break;case"t":s+=(D<12?i.amDesignator:i.pmDesignator).charAt(0);break;case"f":case"0":s+=A(k,3).charAt(0);break;case"ff":case"00":s+=A(k,3).substr(0,2);break;case"fff":case"000":s+=A(k,3);break;case"z":s+=((f=$/60)<=0?"+":"-")+T(O(f));break;case"zz":s+=((f=$/60)<=0?"+":"-")+A(T(O(f)),2);break;case"zzz":s+=((f=$/60)<=0?"+":"-")+A(T(O(f)),2)+":"+A(O($%60),2);break;case"g":case"gg":case"ggg":a&&(l=(l===p-1||(s+=C.XPt.DGt(b[0],t,n)),p));break;case"e":case"ee":a?v=(v===p-1||(s+=C.XPt.DGt(b[0],t,n)),p):s+=A(d?d[0]:_,4);break;case"/":s+=i.dateSeparator;break;default:if(!/\[(H+|h+|m+|s+)\]/.test(b[0]))throw new Error((0,x.getSR)().Exp_InvalidDateFormat);s+=b[0]}return s.toString()}function R(t,e){for(var r,n,i,o,a,r=0,n=P,i=0,o=t.length;i<o;i++)switch(a=t.charAt(i)){case'"':n?e.y4+="'":r++,n=P;break;case"\\":n&&(e.y4+="\\"),n=!n;break;default:e.y4+=a,n=P}return r}function I(t,e){var r,n,r,r=new Date,n;return t.DateTimeFormat.eras&&e<100&&(e+=(r=C.XPt.TGt(r).IGt)-r%100)>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(e-=100),e}function B(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H+\]|\[h+\]|\[m+\]|\[s+\]/g}function L(t,e,r){var n,i,o,a,u,s,f,y,c,m,m;if(t.qGt){if(t.qGt[e])return t.qGt[e]}else t.qGt={};for(n=(n=(n=e).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),i="^",o={y4:""},a=[],s=u=0,f=B();(y=f.exec(n))!==$;)if(o.y4="",c=n.slice(u,y.index),u=f.lastIndex,s+=R(c,o),i+=o.y4,s%2==1)i+=y[0];else{switch(y[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":i+="(\\D+)";break;case"tt":case"t":i+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":i+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":i+=r?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":i+="(\\d{2}|\\d{4})";break;case"fff":case"000":i+="(\\d{3})";break;case"ff":case"00":i+="(\\d{2})";break;case"f":case"0":i+="(\\d)";break;case"zzz":i+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":i+="([+-]?\\d\\d?)";break;case"/":i+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw new Error((0,x.getSR)().Exp_InvalidDateFormat)}M.Uf.ZP(a,y[0])}return o.y4="",R(n.slice(u),o),m={$Gt:m=(i=i+o.y4+"$").toString().replace(/\s+/g,"\\s+"),QMt:a,tUt:new RegExp(m)},t.qGt[e]=m}function s(t){var t=t.getTimezoneOffset();return t=-402===(t=-507===(t=-321===(t=-485===t?-485-43/60:t)?-321-10/60:t)?-507-52/60:t)?-402-4/60:t}function f(){}Object.defineProperty(x,"__esModule",{value:!0}),x.ct=x.getSR=void 0,r=e("./src/common/util/common.ts"),k=e("./src/common/util/stringhelper.ts"),M=e("./src/common/util/arrayhelper.ts"),C=e("./src/common/culture/cultureInfo.ts"),e=e("./src/common/util/types.ts"),a=e.lt.ht,A=k.zf.B9t,$=null,S=parseInt,n=!(P=!1),T=Math.floor,O=Math.abs,e=new r.ResourceManager(r.SR,"Common"),x.getSR=e.getResource.bind(e),o={},f.L9t=function(t,e,r,n){return E(t,e,r=r||C.CultureManager.Fe(),n)},f.Pe=function(t,e,r){return E(t,e,r||C.CultureManager.Fe())},f.Mjt=function(t,e,r){var n,i,o,o,a,u=P,a=r;for(a.slice(1).forEach(function(t){t&&(u=!0)}),i=(a=u?a:a.concat(e.qPt())).length,n=1;n<i;n++)if((o=a[n])&&(u=!0,o=f.nUt(t,o,e)))return o;return $},f.yU=function(t,e,r){var n,i;return(e||r||void 0===(i=o[t]))&&(n=e?[t,e]:[t],i=f.Mjt(t,r||C.CultureManager.Fe(),n),e||r||(o[t]=i)),i&&new Date(i)},f.Z6t=function(t,e){return f.Mjt(t,C.CultureManager.Fe("invariant"),[t,e])},f.nUt=function(t,e,r){var n,i,e,o,a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,b,_,w,w,D,D,e,t,H,N,e;if(t=t.trim(),(o=(e=L(n=r.DateTimeFormat,e,i=1041===r.id)).tUt.exec(t))===$)return $;for(a=e.QMt,v=c=y=f=s=u=$,p=g=P,F=l=d=h=m=0,b=a.length;F<b;F++)if(_=o[F+1])switch(a[F]){case"dd":case"d":if((y=S(_,10))<1||31<y)return $;break;case"MMMM":if((f=r.tGt(_))<0||11<f)return $;break;case"MMM":if((f=r.iGt(_))<0||11<f)return $;break;case"M":case"MM":case"%M":if((f=S(_,10)-1)<0||11<f)return $;break;case"e":case"ee":if((s=i&&"\u5143"===_?1:I(r,S(_,10)))<0||9999<s)return $;break;case"y":case"yy":case"yyy":case"yyyy":if((s=S(_,10))<0||9999<s)return $;break;case"h":case"hh":case"H":case"HH":if((m=S(_,10))<0)return $;break;case"m":case"mm":if((h=S(_,10))<0||59<h)return $;break;case"s":case"ss":if((d=S(_,10))<0||59<d)return $;break;case"tt":case"t":if(g=(w=_.toUpperCase())===n.pmDesignator.toUpperCase(),p=w===n.amDesignator.toUpperCase(),g||p)break;return $;case"f":case"0":if((l=100*S(_,10))<0||999<l)return $;break;case"ff":case"00":if((l=10*S(_,10))<0||999<l)return $;break;case"fff":case"000":if((l=S(_,10))<0||999<l)return $;break;case"dddd":if((c=r.aGt(_))<0||6<c)return $;break;case"ddd":if((c=r.sGt(_))<0||6<c)return $;break;case"zzz":if(2!==(w=_.split(/:/)).length)return $;if((M=S(w[0],10))<-12||13<M)return $;if((D=S(w[1],10))<0||59<D)return $;v=60*M+(k.zf.fJ(_,"-")?-D:D);break;case"z":case"zz":if((M=S(_,10))<-12||13<M)return $;v=60*M;break;case"g":case"gg":case"ggg":if(!(D=_)||!n.eras)return $;if((u=C.XPt.kGt(a[F],D))<0)return $}if(t=(e=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(N=n.Calendar.convert)&&(H=N.fromGregorian(t)),N||(H=[t.getFullYear(),t.getMonth(),t.getDate()]),s===$?s=H[0]:s<100&&(n.eras&&u!==$?s=C.XPt.NGt(u||0,s):s+=30<=s?1900:2e3),f===$&&(f=H[1]),y===$&&(y=e?H[2]:1),N){if((t=N.toGregorian(s,f,y))===$)return $}else{if(t.setFullYear(s,f,y),t.getDate()!==y)return $;if(c!==$&&t.getDay()!==c)return $}return g&&m<12?m+=12:p&&12===m&&(m=0),t.setHours(m,h,d,l),v!==$&&(e=t.getMinutes()-(v+t.getTimezoneOffset()),t.setHours(t.getHours()+e/60,e%60)),t},f.Y0=function(t){var e,r,n,e,n,i,o,a,u,n,e=t-25569,r,n=0<=e?1:-1,e=s(new Date(864e5*e)),n=(864e5*t*1440+n-3181192704e6+864e5*e)/1440,i=new Date(n),o,a,u=s(new Date(n+36e5*(0<=e?1:-1)));return 60<=O(e-u)?new Date(n+60*(u-e)*1e3):(n=t+"",999===i.getMilliseconds()&&"33333333"===n.substr(n.length-8)?new Date(i.valueOf()+1):i)},f.dJ=function(t){var t;if("/OADate("===t.substr(0,8))return t=parseFloat(t.substr(8,t.length-10)),f.Y0(t)},f.Q0=function(t){return"/OADate("+f.o0(t)+")/"},f.o0=function(t){var e;return!a(t)&&(t="number"!=typeof t&&"string"!=typeof t?t:new Date(t))instanceof Date?(e=s(t),(1440*t.getTime()+3181192704e6-864e5*e)/124416e6):0},f._DT=function(t){var e,r,n,i,o,e=$,r=!0;if(a(t)?e=f.Y0(0):t instanceof Date?e=new Date(t.valueOf()):"string"==typeof t?((n=f.yU(t))||(isNaN(t)?!f.u6t(t)&&(n=new Date(t),isNaN(n.valueOf())&&(r=P),!(o=(i=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/).exec(t.replace(/ |\n/g,"").trim()))||4!==o.length||-1!==o.indexOf(n.getFullYear().toString())&&-1!==o.indexOf((n.getMonth()+1).toString())&&-1!==o.indexOf(n.getDate().toString()))||(r=P):(n=f.Y0(parseFloat(t)))||(r=P)),e=n):"number"==typeof t?e=f.Y0(t):r=P,r)return e;throw(0,x.getSR)().Exp_InvalidCast},f.u6t=function(t){var e,n,r,i,o,e=C.CultureManager.Fe().DateTimeFormat,n=f.eUt,r=function(e,t){var r=0;return t.forEach(function(t){t&&-1<e.indexOf(t)&&r++}),1<r},i=function(t,e){var t,r;return!!(t&&-1<t.indexOf(" "))&&2<=(r=(t=t.split(" ")).length)&&e.indexOf(t[r-2])<=-1&&!isNaN(t[r-1])},o=function(e){var r=!1;return n.forEach(function(t){-1<e.indexOf(t)&&(r=!0)}),r};return r(t,e.monthNames)||r(t,e.abbreviatedMonthNames)||r(t,e.dayNames)||r(t,e.abbreviatedDayNames)||i(t,e.monthNames.concat(e.abbreviatedMonthNames))||o(t)},f.W0=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},f.eUt=["@","#","!","`","^","$","*","(",")","&"],x.ct=f},"./src/common/util/functionhelper.ts":function(t,e,r){var z,K,J,V;function f(t){return t}function y(t,e,r,n,i,o,a,u,s,j,f){var y,c,m,M,h,d,l,v,g,p,F,b,_,w,D,H,N,k,$,E,R,I,B,S,P,x,C,A,L,G,T,O,N=r[J],k=r[V],$=e[J],E=e[V],R=n[J],I=n[V],B=1===k,S=1===E;if($===N&&E===k){for(l=N*k,y=A=C=x=P=0;y<N;y++)for(c=0;c<k;c++){if(M=o(r[y][c]),h=o(e[y][c]),t&&(K(M)||K(h)))return s;P+=M,x+=M*M,C+=h=j(h),A+=M*h}for(L=l*A-P*C,v=i?(C*x-P*A)/(l*x-P*P):0,(1<(G=(d=i?L/(l*x-P*P):A/x).toString()).indexOf("000000000000")||1<G.indexOf("999999999999"))&&(d=z.st.E8(d,12),v=z.st.E8(v,12)),g=[],y=0;y<R;y++)for(g[y]=[],c=0;c<I;c++){if(M=o(n[y][c]),t&&K(M))return s;g[y][c]=0==L?e[0][0]:f(z.st.tge(d*M,v))}return a?new a(g):g}if(S&&$===N||1===$&&E===k){for(M=[],h=[],D=k+1,H=k+2,y=0;y<N;y++){if(v=o(F=S?e[y][0]:e[0][y]),t&&K(v))return s;h[y]=B?j(v):v}for(y=0;y<N;y++)for(M[y]=[],c=0;c<k;c++){if(v=o(r[y][c]),t&&K(v))return s;M[y][c]=v}for(T=[],d=0;d<D;d++)for(T[d]=[],l=0;l<H;l++)T[d][l]=0;for(m=0;m<N;m++)for(T[0][D]+=h[m],y=0;y<k;y++)for(T[0][F=y+1]+=M[m][y],T[F][0]=T[0][F],T[F][D]+=M[m][y]*h[m],c=y;c<k;c++)T[_=c+1][F]+=M[m][y]*M[m][c],T[F][_]=T[_][F];for(T[0][0]=N,p=O=i?0:1;p<D;p++){if(t){if(0===T[p][p]){for(w=!1,c=p+1;!w&&c<D;c++)if(0!==T[c][p]){for(m=0;m<H;m++)_=T[p][m],T[p][m]=T[c][m],T[c][m]=_;w=!0}if(!w)return u}}else{for(y=p;y<D&&0===T[y][p];)y++;if(D<=y)return u;for(b=O;b<H;b++)F=T[p][b],T[p][b]=T[y][b],T[y][b]=F}for(F=1/T[p][p],b=O;b<H;b++)T[p][b]*=F;for(y=O;y<D;y++)if(y!==p)for(F=-T[y][p],b=0;b<H;b++)T[y][b]+=F*T[p][b];i||(T[0][D]=0)}for(g=[],S||(g[0]=[]),y=0;y<R;y++){for(S&&(g[y]=[]),F=T[0][D],c=0;c<k;c++){if(v=o(S?n[y][c]:n[c][y]),t&&K(v))return s;F+=T[c+1][D]*v}S?g[y][0]=f(F):g[0][y]=f(F)}return a?new a(g):g}return u}function n(t,e,r,n,i,o,a,u){return y(!0,t,e,r,n,i,o,u,a,f,f)}function i(t,e,r,n,i,o,a){for(var u,s,u=0;u<t[J];u++)for(s=0;s<t[V];s++)if(t[u][s]<=0)return o;return y(!1,t,e,r,n,f,i,a,null,Math.log,Math.exp)}Object.defineProperty(e,"__esModule",{value:!0}),e.iit=e.eit=void 0,z=r("./src/common/util/numberhelper.ts"),K=isNaN,J="rowCount",V="colCount",e.eit=n,e.iit=i},"./src/common/util/numberhelper.ts":function(j,t,e){var r,n,i,f,o,y,N,c,v,a,m,M,g,k,u,p,s,F,h,d,l,$,b,e,_,H,S,P,E,w,x,D;function R(t,e,r,n){return e&&0!==e.length&&"i"!==e?I(t,e,r.NumberFormat,n):r&&0<r.name.length?t.toLocaleString():t.toString()}function I(t,e,r,n){var i;return Z(t,G(e),r,n)}function B(t,e){for(var r,n,t,i,e,o,a,i,o,a,r=u(p(t)),n={iUt:1,rUt:0};10<=r;)r/=10,n.iUt++;return i=(t=t.toString()).search(/e/gi),e=t.indexOf(e),-1!==i?(a=$(t,0,i),i=$(t,i+1),o=0,-1!==e&&(o=$(a,e+1).length),a=M(i),n.rUt=o=(o=o-a)<0?0:o):(o=0,-1!==e&&(o=$(t,e+1).length),n.rUt=o),n}function L(t){for(var e,r,n,e={oUt:t.charAt(0),aUt:0,tUt:0},r="",n=1;n<t.length;n++)if("+"===(r=t.charAt(n)))e.aUt=1;else{if("-"!==r){if("0"!==r)throw new Error(_().Exp_InvalidExponentFormat);e.tUt=t.length-n;break}e.aUt=-1}return e}function G(t){for(var e,r,n,i,o,a,u,s,f,y,c,m,M,h,d,l,e={uUt:v,sUt:v,rCt:g,fxt:0,d0:0,cUt:0,fUt:v},r="",n=g,i=g,o=g,a=g,u=g,s=g,y=v,c=[],m=0;m<t.length;m++){if(f=t.charAt(m),n)r+=f,'"'===f&&(c.push(r),r="",n=g);else if(i){if("E"===y||"e"===y){if(!(0<=["+","-","0"].indexOf(f))){i=g,m--;continue}r+=f}else if("+"===y||"-"===y){if("0"!==f){i=g,m--;continue}r+=f}else if("0"===y){if("0"!==f){i=g,u||(u=k,e.fUt=L(r)),m--;continue}r+=f}}else if("*"!==y&&"_"!==y&&"\\"!==y||""===r)if("*"===f||"_"===f||"\\"===f)s=g,""!==r&&(c.push(r),r=""),r+=f;else if("'"===f)s=g,""!==r&&(c.push(r),r=""),c.push(f);else if('"'===f)s=g,n=k,""!==r&&(c.push(r),r=""),r+=f;else if(0<=w.indexOf(f))s=k,w.indexOf(y)<0&&""!==r&&(c.push(r),r=""),r+=f;else if("."!==f||o)if("%"===f)s=g,e.d0++,""!==r&&(c.push(r),r=""),c.push(f);else if("\u2030"===f)s=g,e.cUt++,""!==r&&(c.push(r),r=""),c.push(f);else if(","===f)if(s){for(M=void 0,""!==r&&(c.push(r),r=""),h=k,d="",l=m+1;l<t.length;l++)if(M=t.charAt(l),'"'===d)'"'===M&&(d="");else if("\\"===d||"_"===d)d="";else{if(0<=w.indexOf(M)){h=g;break}if("."===M||";"===M)break;d=M}h?e.fxt++:o||(M=t.charAt(m+1))&&0<=w.indexOf(M)&&(a=k)}else r+=f;else"E"===f||"e"===f?(s=g,i=k,""!==r&&(c.push(r),r="")):(s=g,0<=w.indexOf(y)&&""!==r&&(c.push(r),r="")),r+=f;else""!==r&&(c.push(r),r=""),e.uUt=c,c=[],o=k,s=g;else r+=f,c.push(r),r="";y=f}return""!==r&&(i&&!u&&(e.fUt=L(r)),c.push(r)),a&&(e.rCt=k),o?e.sUt=c:e.uUt=c,e}function z(t,e,r,n){for(var i,o,a,u,s,f,y,c,m,M,i=e[0],o=1,a=0,u=g,s=t.length,f=0;f<s;f++)if("number"===(y=t[f].type)){for(c="",M=(m=t[f].value).length-1;0<=M;){if(!(1<=i&&i<=9||0===i&&o===e.length))throw new Error(_().Exp_InvalidNumberGroupSize);/\d/gi.test(m[M])?(u&&(c&&t.push({type:"number",value:c}),t.push({type:"groupSeparator",value:r}),c="",u=g),a++):a=0,c=m[M]+c,a===i&&0<i&&(u=k,a=0,o<e.length)&&(i=e[o],o++),M--}c&&t.push({type:y,value:c})}else"fillingChar"===y&&(n.infillIndex=t.length-s),t.push({type:y,value:t[f].value});t.splice(0,s)}function K(t,e,r,n,i,o){var a,a,u,s,u,a=et(t,-e),a=(u=(a=(t=a=isFinite(a)?a:t).toString()).split(/e/i))[0],s=1<u.length?m(u[1],10):0;return a=(u=a.split("."))[0],u=1<u.length?u[1]:"",0<s?(a+=(u=c(u,s)).slice(0,s),u=$(u,s)):s<0&&(s=-s,u=(a=t<0?o+N(a.replace(o,""),1+s):N(a,1+s)).slice(-s,a.length)+u,a=a.slice(0,-s)),a+(u=0<e?i+(u=u.length>e?u.slice(0,e):c(u,e)):"")}function J(t,e,r,n){var t=t;return 0<e&&(t=O(t*s(100,e),15)),0<r&&(t=O(t*s(1e3,r),15)),t=0<n?O(t/s(1e3,n),15):t}function V(t){var e,r,n,e=v;if(t)for(e="",r=0;r<t.length;r++)n=t[r],/^(0|#|\?)+/g.test(n)&&(e+=n);return e}function C(t,e){return t===e||0!==t&&0!==e&&(p(t-e)<p(t)/D||(t=O(t,15),e=O(e,15),p(t-e)<p(t)/D))}function W(t,e){return C(t,-e)?0:t+e}function U(t,e,r){var n,i,o,a,r,u,t,n={value:t,exponentValue:0},i,o=B(t,".").iUt,a=p(t),r=r?r.length:1;if(1<=a)r<o?(n.value=t/s(10,o-=r),n.exponentValue=o):n.exponentValue=0,-1===e.aUt&&(e.aUt=0);else if(a<1&&0<a){for(e.aUt=-1,u=s(10,r);10*a<u&&!C(10*a,u);)a*=10,n.exponentValue++;t=s(10,n.exponentValue),n.value*=h<t?0:t}return n}function q(t,e,r,n,i,o,a,u){var s,f,y,c,m,M,u,h,d,l,v,g,p,F,b,_,w,D,H,s=u.numberGroupSizes,f=u.numberGroupSeparator,y=u.negativeSign,c=u.percentSymbol,m=u.perMilleSymbol,M=n.fUt,u=$(e,0,1);for(e=0===(h=1===(e=u===y?$(e,1):e).length&&"0"===e?0:e.length)?"":e,d=0,l="",v=t.length-1;0<=v;v--)if(g="",p=t[v],/^(0|#|\?)+/g.test(p)){if(l!==r){for(F=p.length,b=h-d-1;0<=b&&0<F;b--)g=(_=e.charAt(b))+g,F--,d++;for(w=F-1;0<=w;w--)d++,"0"===(D=p[w])?g=D+g:"?"===D&&(""!==g&&(o.push({type:"number",value:g}),g=""),o.push({type:"numberPlaceholder",value:D}));""!==(g=(l=p+l)===r&&d<h?e.substr(0,h-d)+g:g)&&o.push({type:"number",value:g})}}else n.fUt&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)?(a.replaceExponent=k,H="",H=(H=(H+=M.oUt)+P[M.aUt])+N(i.toString(),M.tUt),o.push({type:"exponent",value:H})):"_"===p[0]?o.push({type:"placeholder",value:p[1]}):"*"===p[0]?a.hasInfilling||(o.push({type:"fillingChar",value:p[1]}),a.hasInfilling=!0,a.infillIndex=o.length-1):"\\"===p[0]?2===p.length&&o.push({type:"text",value:p[1]}):'"'===p[0]&&'"'===p[p.length-1]?2<p.length&&o.push({type:"text",value:p.substr(1,p.length-2)}):p===c?o.push({type:"percent",value:p}):p===m?o.push({type:"permille",value:p}):x[p]?o.push({type:"currency",value:p}):o.push({type:"text",value:p});u===y&&r&&o.push({type:"text",value:u}),n.rCt===k&&z(o,s,f,a),o.reverse(),a.infillIndex=o.length-1-a.infillIndex}function Y(t,e,r,n,i,o,a,u,s){var f,y,c,s,m,M,h,d,l,v,g,p,F,b,_,w,D,f=s.numberDecimalSeparator,y=s.percentSymbol,c=s.perMilleSymbol,s=e.indexOf(f),m=i.fUt;for((0<s||n!==H||r!==S)&&a.push({type:"decimalSeparator",value:f}),M=-1!==s?e.substring(s+1):"",d="",l=h=0;l<t.length;l++)if(v=t[l],/^(0|#|\?)+/g.test(v)){if(g="",d!==r){for(p=v.length,F=0,b=h;0<p&&0<M.length-h;)g+=M.charAt(b),p--,h++,F++,b++;for(_=F;0<p;)w=v[_],_++,h++,p--,"0"===w?g+=w:"?"===w&&(""!==g&&(a.push({type:"number",value:g}),g=""),a.push({type:"numberPlaceholder",value:w}));""!==g&&a.push({type:"number",value:g}),d+=v}}else m&&!u.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(v)?(u.replaceExponent=k,D="",D=(D=(D+=m.oUt)+P[m.aUt])+N(o.toString(),m.tUt),a.push({type:"exponent",value:D})):"_"===v[0]?a.push({type:"placeholder",value:v[1]}):"*"===v[0]?(a.push({type:"fillingChar",value:v[1]}),u.hasInfilling&&a.splice(u.infillIndex,1),u.hasInfilling=!0,u.infillIndex=a.length-1):"\\"===v[0]?2===v.length&&a.push({type:"text",value:v[1]}):'"'===v[0]&&'"'===v[v.length-1]?2<v.length&&a.push({type:"text",value:v.substr(1,v.length-2)}):v===y?a.push({type:"percent",value:v}):v===c?a.push({type:"permille",value:v}):x[v]?a.push({type:"currency",value:v}):a.push({type:"text",value:v})}function X(t,e){var r,n,r=t,n;return r=-1!==t.indexOf(e)?t.replace(/0+$/,""):r}function Z(t,e,r,n){var i,o,a,u,s,f,f,y,c,m,M,h,d,t,y,c,l,i=[];return t=J(t,e.d0,e.cUt,e.fxt),o=e.uUt,a=e.sUt,(o||a)&&(u=V(o),s=(s=V(a))||"",e.fUt&&(t=(f=U(t,e.fUt,u)).value,f=f.exponentValue),y=B(t,"."),1<p(t)&&15<y.iUt+y.rUt&&(t=O(t,15)),c=r.numberGroupSizes,m=r.numberGroupSeparator,M=r.numberDecimalSeparator,h=r.negativeSign,t=K(t,d=F(y.rUt,s.length),c,m,M,h),""===(t=n?t:X(t,M))?i.push({type:"text",value:(o?o.join(""):"")+(a?a.join(""):"")}):(y={hasInfilling:g,infillIndex:-1,replaceExponent:g},"10"!==(c=t.split(M)[0])||isNaN(f)||(c="1",f+=(l=e&&e.fUt&&-1===e.fUt.aUt)?-1:1),o&&q(o,c,u,e,f,i,y,r),"0"!==c&&""===u&&a&&i.push({type:"number",value:c}),a&&Y(a,t,s,u,e,f,i,y,r))),i}function Q(t,e){var e,r,n,i,o,t,a,r,u,o,n,r,a,s,n,i,r;return(t=y(t)?"":f.zf.s6t(t,"")).match(/^[+-]?infinity$/i)?M(t):t.match(/^0x[a-f0-9]+$/i)?m(t,10):(i=(n=A(t,e=e.NumberFormat,r=e.numberNegativePattern))[0],o=n[1],""===i&&1!==r&&(i=(n=A(t,e,1))[0],o=n[1]),""===i&&(i="+"),t=(r=(r=(o=o[0]===e.currencySymbol?$(o,1):o).indexOf("e"))<0?o.indexOf("E"):r)<0?(a=o,v):(a=$(o,0,r),$(o,r+1)),o=(n=a.indexOf("."))<0?(u=a,v):(u=$(a,0,n),$(a,n+".".length)),u=u.split(",").join(""),a=i+(u=","!==(r=",".replace(/\u00A0/g," "))?u.split(r).join(""):u),o!==v&&(a+="."+o),(s=a[a.length-1])===e.percentSymbol&&(a=$(a,0,a.length-1),-1===(n=(a=f.zf.s6t(a,"")).indexOf("."))&&(n=a.length),i="",a=i=(i=(i=i+$(a,0,n-2)+".")+$(a,n-2,2))+$(a,n+1)),t!==v&&(""===(r=A(t,e,1))[0]&&(r[0]="+"),a+="e"+r[0]+r[1]),a.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?M(a):NaN)}function A(t,e,r){var n,e,n=e.negativeSign,e=e.positiveSign;if(4!==r&&2!==r||(n=" "+n,e=" "+e),4===r||3===r){if(f.zf.dT(t,n))return["-",$(t,0,t.length-n.length)];if(f.zf.dT(t,e))return["+",$(t,0,t.length-e.length)]}else if(2===r||1===r){if(f.zf.fJ(t,n))return["-",$(t,n.length)];if(f.zf.fJ(t,e))return["+",$(t,e.length)]}else{if(0!==r)throw new Error("");if(f.zf.fJ(t,"(")&&f.zf.dT(t,")"))return["-",$(t,1,t.length-2)]}return["",t]}function tt(t,e,r){if(0!==p(u(t)-t))throw new Error(_().Exp_BadFormatSpecifier);var t=(0<=t?t:E+t+1).toString(16),t=e?t.toLowerCase():t.toUpperCase();return!y(r)&&t.length<r?N(t,r):t}function et(t,e){var r,n;return t=+t,e=+e,isNaN(t)||e%1!=0?NaN:(t=(r=t<0)?-t:t,typeof e===a||0===e?(t=Math.round(t),r?-t:t):(n=t.toString().split("e"),t=Math.round(+(n[0]+"e"+(n[1]?+n[1]-e:-e))),+((n=(t=r?-t:t).toString().split("e"))[0]+"e"+(n[1]?+n[1]+e:e))))}function T(t){var e=o.CultureManager.Fe().NumberFormat;return e="string"==typeof t?o.CultureManager.Fe(t).NumberFormat:e}function rt(t){var e,r,n,i,e="";if(Array.isArray(t)&&0<t.length)for(r=0;r<t.length;r++)n=t[r].type,i=t[r].value,"placeholder"===n?e+=" ":"fillingChar"!==n&&(e+="numberPlaceholder"===n?" ":i);return e}function O(t,e){return t="number"==typeof t&&t.toString().length>=e?+t.toPrecision(e):t}Object.defineProperty(t,"__esModule",{value:!0}),t.st=void 0,r=e("./src/common/util/common.ts"),n=e("./src/common/util/types.ts"),i=e("./src/common/util/regexhelper.ts"),f=e("./src/common/util/stringhelper.ts"),o=e("./src/common/culture/cultureInfo.ts"),y=n.lt.ht,N=f.zf.B9t,c=f.zf.lUt,v=null,a=void 0,m=parseInt,M=parseFloat,k=!(g=!1),u=Math.floor,p=Math.abs,s=Math.pow,F=Math.min,h=Number.MAX_VALUE,d="#dot#",l="#group#",$=function(t,e,r){return t.substr(e,r)},b=function(t){return i.$T.qT(t)},e=new r.ResourceManager(r.SR),_=e.getResource.bind(e),H="##################0",S="################",P={1:"+",0:"","-1":"-"},E=4294967295,w=["0","#","?"],x={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"},D=Math.pow(2,48),t.st={yU:function(t){return Q(t,o.CultureManager.Fe())},Z6t:function(t){return Q(t,o.CultureManager.Fe("invariant"))},L9t:function(t,e,r,n){return R(t,e,r=r||o.CultureManager.Fe(),n)},Ge:function(t,e){var e,r,e;return t="string"==typeof t&&(r=(e=T(e)).numberDecimalSeparator,e=e.numberGroupSeparator,"."!==r&&(t=t.replace(b("[.]"),d)),","!==e&&(t=t.replace(b("[,]"),l)),"."!==r&&(t=t.replace(b(d),r)),","!==e)?t.replace(b(l),e):t},Jf:function(t,e){var e,r,e;return t="string"==typeof t&&(r=(e=T(e)).numberDecimalSeparator,e=e.numberGroupSeparator,"."!==r&&(t=t.replace(b("["+r+"]"),d)),","!==e&&(t=t.replace(b("["+e+"]"),l)),"."!==r&&(t=t.replace(b(d),".")),","!==e)?t.replace(b(l),","):t},hUt:function(t,e){var e,r,e;return!("string"==typeof t&&(r=(e=T(e)).numberDecimalSeparator,e=e.numberGroupSeparator,"."!==r&&"."!==e&&0<=t.indexOf(".")||","!==r&&","!==e&&0<=t.indexOf(",")))},dUt:function(t,e){return M(this.Jf(t,e))},VGt:tt,v0:G,vUt:Z,ukt:C,tge:W,mUt:rt,gUt:H,pUt:S,E8:O}},"./src/common/util/rbush.ts":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.rbush=void 0;var o=Math.max,a=Math.min,m=Number.POSITIVE_INFINITY;function r(t,e){this.bUt=o(4,t||9),this.yUt=o(2,Math.ceil(.4*this.bUt)),e&&this.wUt(e),this.clear()}function y(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function u(t,e){c(t,0,t.children.length,e,t)}function c(t,e,r,n,i){(i=i||F(null)).minX=m,i.minY=m,i.maxX=-m,i.maxY=-m;for(var o=e,a=void 0;o<r;o++)a=t.children[o],M(i,t.leaf?n(a):a);return i}function M(t,e){t.minX=a(t.minX,e.minX),t.minY=a(t.minY,e.minY),t.maxX=o(t.maxX,e.maxX),t.maxY=o(t.maxY,e.maxY)}function s(t,e){return t.minX-e.minX}function f(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function l(t,e){return(o(e.maxX,t.maxX)-a(e.minX,t.minX))*(o(e.maxY,t.maxY)-a(e.minY,t.minY))}function v(t,e){var r=o(t.minX,e.minX),n=o(t.minY,e.minY),i=a(t.maxX,e.maxX),t=a(t.maxY,e.maxY);return o(0,i-r)*o(0,t-n)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&(0<=e.maxX&&e.maxX<=t.maxX||t.minX<0)&&(0<=e.maxY&&e.maxY<=t.maxY||t.minY<0)}function p(t,e){return(-1===t.minY||-1===e.minY||t.minY<=e.maxY&&e.minY<=t.maxY)&&(-1===t.minX||-1===e.minX||t.minX<=e.maxX&&e.minX<=t.maxX)}function F(t){return{children:t,height:1,leaf:!0,minX:m,minY:m,maxX:-m,maxY:-m}}(e.rbush=r).prototype={all:function(){return this.QP(this.data,[])},search:function(t){var e,r,n,i,o,a,u,s,e=this.data,r=[],n=this.toBBox;if(p(t,e))for(i=[];e;){for(o=0,a=e.children.length;o<a;o++)u=e.children[o],p(t,s=e.leaf?n(u):u)&&(e.leaf?r.push(u):g(t,s)?this.QP(u,r):i.push(u));e=i.pop()}return r},collides:function(t){var e,r,n,i,o,a,u,e=this.data,r=this.toBBox;if(p(t,e))for(n=[];e;){for(i=0,o=e.children.length;i<o;i++)if(a=e.children[i],p(t,u=e.leaf?r(a):a)){if(e.leaf||g(t,u))return!0;n.push(a)}e=n.pop()}return!1},insert:function(t){return t&&this.Eit(t,this.data.height-1),this},clear:function(){return this.data=F([]),this},remove:function(t,e){if(t)for(var r=this.data,n=this.toBBox(t),i=[],o=[],a,u,s,f;r||i.length;){if(r||(r=i.pop(),u=i[i.length-1],a=o.pop(),f=!0),r.leaf&&-1!==(s=y(t,r.children,e)))return r.children.splice(s,1),i.push(r),this.MUt(i),this;f||r.leaf||!g(r,n)?u?(a++,r=u.children[a],f=!1):r=null:(i.push(r),o.push(a),r=(u=r).children[a=0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},QP:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},CUt:function(t,e,r,n){for(var i,o,a,u,s,f,y,c;n.push(e),!e.leaf&&n.length-1!==r;){for(y=c=m,i=0,o=e.children.length;i<o;i++)s=h(a=e.children[i]),(f=l(t,a)-s)<c?(c=f,y=s<y?s:y,u=a):f===c&&s<y&&(y=s,u=a);e=u||e.children[0]}return e},Eit:function(t,e,r){var n,r,i,n,n=this.toBBox,r=r?t:n(t),i=[],n=this.CUt(r,this.data,e,i);for(n.children.push(t),M(n,r);0<=e&&i[e].children.length>this.bUt;)this.SUt(i,e),e--;this.TUt(r,i,e)},SUt:function(t,e){var r,n,i,i,n,r=t[e],n=r.children.length,i=this.yUt;this.AUt(r,i,n),i=this.IUt(r,i,n),(n=F(r.children.splice(i,r.children.length-i))).height=r.height,n.leaf=r.leaf,u(r,this.toBBox),u(n,this.toBBox),e?t[e-1].children.push(n):this.xUt(r,n)},xUt:function(t,e){this.data=F([t,e]),this.data.height=t.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},IUt:function(t,e,r){for(var n,i,o,a,i,u,s,f,u=s=m,n=e;n<=r-e;n++)a=v(i=c(t,0,n,this.toBBox),o=c(t,n,r,this.toBBox)),i=h(i)+h(o),a<u?(u=a,f=n,s=i<s?i:s):a===u&&i<s&&(s=i,f=n);return f},AUt:function(t,e,r){var n=t.leaf?this.compareMinX:s,i=t.leaf?this.compareMinY:f,o,a;this.NUt(t,e,r,n)<this.NUt(t,e,r,i)&&t.children.sort(n)},NUt:function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=c(t,0,e,i),a=c(t,r-e,r,i),u=d(o)+d(a),s,f,s=e;s<r-e;s++)f=t.children[s],M(o,t.leaf?i(f):f),u+=d(o);for(s=r-e-1;e<=s;s--)f=t.children[s],M(a,t.leaf?i(f):f),u+=d(a);return u},TUt:function(t,e,r){for(var n=r;0<=n;n--)M(e[n],t)},MUt:function(t){for(var e=t.length-1,r=void 0;0<=e;e--)0===t[e].children.length?0<e?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():u(t[e],this.toBBox)},wUt:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},"./src/common/util/regexhelper.ts":function(t,e,r){var i,n,o,a;function f(){}Object.defineProperty(e,"__esModule",{value:!0}),e.$T=void 0,i=r("./src/common/util/stringhelper.ts"),n=!0,o="empty",f.bue=function(t,e){var r;if(e&&f.yue[e]&&f.yue[e][t])r=f.yue[e][t];else try{null==e?(r=new RegExp(t),e=o):r=new RegExp(t,e),f.yue[e]||(f.yue[e]={}),f.yue[e][t]=r}catch(t){return null}return r.lastIndex=0,r},f.qT=function(t){var e=f.kUt[t],e;return(e=e||(f.kUt[t]=new RegExp(t,"g"))).lastIndex=0,e},f.OJ=function(t){var e=f.DUt[t],e;return(e=e||(f.DUt[t]=new RegExp(t,"gi"))).lastIndex=0,e},f.jJ=function(t,e,r){var n,i,o,a,u,s;if(f._Ut[t])return f.EUt[t];if(f.qT(n="[~?*]+").test(t)){for(i=[],o=t.split(""),u={".":!(a=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0,"\\":!0},s=0;s<o.length;s++)"~"===(a=o[s])&&s<o.length-1?("*"===(a=o[++s])||"?"===a?i.push("\\"):e&&i.push("~"),i.push(a)):"?"===a?i.push("."):"*"===a?(i.push("[\\s\\S]"),i.push(r?"+":"*")):(u[a]&&i.push("\\"),i.push(a));return i.join("")}return null},f.tbt=function(t,e,r){var t=f.jJ(t,e,r),t;return t=t&&"^"+t+"$"},f.jUt=function(t,e){for(var r,n,r="#"+t+"0#",n=1;0<e.indexOf(r);)r=i.zf.qS(r,"#"+t+(n-1)+"#","#"+t+n+"#"),n++;return r},f.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},f.kUt={},f.DUt={},f.yue={},f._Ut={},f.EUt={},e.$T=f},"./src/common/util/stringhelper.ts":function(t,i,e){Object.defineProperty(i,"__esModule",{value:!0}),i.zf=void 0;var o=e("./src/common/util/regexhelper.ts");function a(t,e,r){return t.substr(e,r)}function u(t){return null==t}function n(t,e,r,n){var i,e;if(u(e))throw new Error;return""===e||!(e.length>t.length)&&(i=t,e=e,r&&(i=t.toLowerCase(),e=e.toLowerCase()),n(i,e))}i.zf={OS:function(t,e,r){return r&&(t=t.toLowerCase(),e=e.toLowerCase()),""===e||0<=t.indexOf(e)},hD:function(t,e,r){var r,n;return r?(r=t.toLowerCase(),n=e.toLowerCase(),r.indexOf(n)):t.indexOf(e)},cJ:function(t,e){if(!e)return t;for(var r=t;a(r,0,e.length)===e;)r=a(r,e.length);return r},s6t:function(t,e){if(!e)return t;for(var r=t;a(r,r.length-e.length,e.length)===e;)r=a(r,0,r.length-e.length);return r},Eit:function(t,e,r){var n,i;if(e<0||e>t.length||u(r))throw new Error;return(n=a(t,0,e))+r+(i=a(t,e,t.length-e))},VP:function(t,e,r){var n,i;if(u(r)&&(r=t.length-e),e<0||r<0||e+r>t.length)throw new Error;return(n=a(t,0,e))+(i=a(t,e+r,t.length-e-r))},fJ:function(t,e,r){return n(t,e,r=void 0===r?!1:r,function(t,e){return t.slice(0,e.length)===e})},dT:function(t,e,r){return n(t,e,r=void 0===r?!1:r,function(t,e){return t.slice(-e.length)===e})},Vi:function(t,e,r,n){if(e)return r=(""+r).replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"+(n?"i":"")),r);throw new Error},OUt:function(t,e,r,n){return e=o.$T.D9t(e),i.zf.Vi(t,e,r,n)},gmt:function(t,e){var e=t.indexOf(e);return e<0||e>=t.length?t:a(t,0,e)},DU:function(t,e){for(var r=0,n=t.indexOf(e);0<=n;)r+=1,n=t.indexOf(e,n+1);return r},qS:function(t,e,r){return t.split(e).join(r)},I5:function(t,e){for(var r,n,i,r=t,n=0;n<e.length;n++)i=new RegExp("\\{"+n+"\\}","g"),r=r.replace(i,e[n]);return r},RUt:function(t,e,r){for(var n,i,n=t.toString(),i=n.length;i<e;i++)n=r?"0"+n:n+"0";return n},B9t:function(t,e){return i.zf.RUt(t,e,!0)},lUt:function(t,e){return i.zf.RUt(t,e,!1)},Dbt:function(t,e){return t===e||!t&&!e||t&&e&&t.toLowerCase()===e.toLowerCase()},Gmt:function(t){return t.toUpperCase()},j0:function(t){var e,r,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=o.$T.qT("(?:&|<|>|\"|'|`)");return r.test(t)?t.replace(r,function(t){return e[t]}):t},dI:function(t){var e,r,e={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},r=o.$T.qT("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return r.test(t)?t.replace(r,function(t){return e[t]}):t},TY:function(t){for(var e,r,e=t,r=/javascript:/gi;e.match(r);)e=e.replace(r,"");return e}}},"./src/common/util/types.ts":function(t,c){var o,a;Object.defineProperty(c,"__esModule",{value:!0}),c.lt=void 0,o="undefined"!=typeof window?window.File:null,a="undefined"!=typeof window?window.Blob:null,c.lt={BUt:null,y0:function(t,e){var r,n,i,o;if(c.lt.Gh(t))for(n=0,i=t.length;n<i&&!1!==(r=e.call(t[n],n,t[n]));n++);else for(o in t)if(t.hasOwnProperty(o)&&!1===(r=e.call(t[o],o,t[o])))break;return t},_h:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Eh:function(t){return"function"===c.lt.Oh(t)},Nh:function(t){return Array.isArray?Array.isArray(t):"array"===c.lt.Oh(t)},jh:function(t){return c.lt.OMt(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},OMt:function(t){return"string"==typeof t},Oh:function(t){var e,r,n,i,o,a;if(null===t)return"null";if(!(e=c.lt.BUt))for(e=c.lt.BUt={},n=0,i=(r=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;n<i;n++)e["[object "+r[n]+"]"]=r[n].toLowerCase();return o=e.toString,"object"==(a=typeof t)||"function"==a?e[o.call(t)]||"object":a},Rh:function(t,e,r){var n,i;if(e){if(i=[].indexOf)return i.call(e,t,r);for(n=e.length,r=(r=c.lt.ht(r)?0:r)<0?Math.max(0,n+r):r;r<n;r++)if(r in e&&e[r]===t)return r}return-1},Bh:function(t,e){var r=e.length,n=t.length,i=0;if("number"==typeof r)for(;i<r;i++)t[n]=e[i],n++;else for(;void 0!==e[i];)t[n]=e[i],n++,i++;return t.length=n,t},Lh:function(t,e,r){var n,i,o,a,u,i=[];if(c.lt.Gh(t))for(o=0,a=t.length;o<a;o++)null!==(n=e(t[o],o,r))&&(i[i.length]=n);else for(u in u=void 0,t)t.hasOwnProperty(u)&&null!==(n=e(t[u],u,r))&&(i[i.length]=n);return i.concat([])},Dh:function(){for(var t,e,r,n,i,o,a,n,u,s,f,y,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(f=t.length,y=!(s=1),"boolean"==typeof(u=t[0]||{})&&(y=u,u=t[1]||{},s=2),"object"==typeof u||c.lt.Eh(u)||(u={}),f===s&&(u=this,--s);s<f;s++)if(!c.lt.ht(a=t[s]))for(o in a)r=u[o],u!==(i=a[o])&&(n=c.lt.Nh(i),y&&i&&(c.lt.Ph(i)||n)?(n=n?r&&c.lt.Nh(r)?r:[]:r&&c.lt.Ph(r)?r:{},u[o]=c.lt.Dh(y,n,i)):void 0!==i&&(u[o]=i));return u},Fh:function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},Uh:function(t){return null!==t&&t===t.window},Ph:function(t){var e,r;if(!t||"object"!==c.lt.Oh(t)||t.nodeType||c.lt.Uh(t))return!1;e={}.hasOwnProperty;try{if(t.constructor&&!e.call(t,"constructor")&&!e.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(r in t);return void 0===r||e.call(t,r)},Gh:function(t){var e,r;return!c.lt.ht(t)&&(e=t.length,r=c.lt.Oh(t),!c.lt.Uh(t))&&(!(1!==t.nodeType||!e)||"array"===r||"function"!==r&&(0===e||"number"==typeof e&&0<e&&e-1 in t))},Hh:function(t,e){var e=e||[];return null!==t&&(c.lt.Gh(Object(t))?c.lt.Bh(e,"string"==typeof t?[t]:t):[].push.call(e,t)),e},dt:null,ht:function(t){return null==t},q8:null,uJ:null,tv:function(t,e){if(void 0===e&&(e=!0),!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||c.lt.ht(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var r,n,i;if(o&&t instanceof o)return new o([t],t.name,{type:t.type,lastModified:t.lastModified});if(a&&t instanceof a)return new a([t],{type:t.type});for(n in r=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(n)&&(i=t[n],t.hasOwnProperty(n))&&r[n]!==i&&(r[n]="object"==typeof i?c.lt.tv(i):i);return e&&(r.toString=t.toString,r.valueOf=t.valueOf),r}}},"./src/common/util/util.res.en.ts":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_Separator=e.Exp_InvalidCast=e.Exp_InvalidNumberFormat=e.Exp_BadFormatSpecifier=e.Exp_InvalidNumberGroupSize=e.Exp_InvalidSemicolons=e.Exp_InvalidExponentFormat=e.Exp_InvalidDateFormat=void 0,e.Exp_InvalidDateFormat="Invalid date format pattern",e.Exp_InvalidExponentFormat="invalid exponent format",e.Exp_InvalidSemicolons="invalid format : too many semicolons",e.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",e.Exp_BadFormatSpecifier="Bad Format Specifier",e.Exp_InvalidNumberFormat="Invalid number format pattern",e.Exp_InvalidCast="InvalidCastException",e.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in culture info."},"./src/plugins/commands/commands.entry.ts":function(t,e,r){var n,i;Object.defineProperty(e,"__esModule",{value:!0}),e.UndoManager=e.CommandManager=e.Key=void 0,n=r("./src/plugins/commands/commands.ts"),Object.defineProperty(e,"Key",{enumerable:!0,get:function(){return n.Key}}),Object.defineProperty(e,"CommandManager",{enumerable:!0,get:function(){return n.CommandManager}}),i=r("./src/plugins/commands/undomanager.ts"),Object.defineProperty(e,"UndoManager",{enumerable:!0,get:function(){return i.UndoManager}})},"./src/plugins/commands/commands.ts":function(t,e){var a,s,r,n;function i(t,e,r){var n,i;this.jS=t,this.LUt=e,this.Zc=r,n=this,Object.defineProperty(n,"shortcutKey",{get:function(){return n.FUt},set:function(t){var e,e,r,e=n.FUt;e!==t&&((e=(i=n.jS.PUt)[e])&&0<=(r=e.indexOf(n))&&e.splice(r,1),n.FUt=t)&&((e=i[t])||(i[t]=e=[]),e.splice(0,0,n))}})}function o(t){this.DJ=t,this.aT={},this.GUt={},this.PUt={}}Object.defineProperty(e,"__esModule",{value:!0}),e.CommandManager=e.Key=void 0,(n=a=e.Key||(e.Key={}))[n.left=37]="left",n[n.right=39]="right",n[n.up=38]="up",n[n.down=40]="down",n[n.tab=9]="tab",n[n.enter=13]="enter",n[n.shift=16]="shift",n[n.ctrl=17]="ctrl",n[n.space=32]="space",n[n.altkey=18]="altkey",n[n.home=36]="home",n[n.end=35]="end",n[n.pup=33]="pup",n[n.pdn=34]="pdn",n[n.backspace=8]="backspace",n[n.del=46]="del",n[n.esc=27]="esc",n[n.a=65]="a",n[n.c=67]="c",n[n.v=86]="v",n[n.x=88]="x",n[n.z=90]="z",n[n.y=89]="y",i.prototype.canUndo=function(){var t;return this.LUt.canUndo},i.prototype.execute=function(t,e,r){var n,i,o,a,n=this,o=!0;n.LUt&&e&&n.LUt.canUndo&&n.jS.UUt({command:e,result:i,vM:r,actionType:r});try{o=!1!==(i=(a=n.LUt.execute||n.LUt)(t,e,1===r))}catch(t){o=!1}return e&&o&&n.jS.HUt({command:e,result:i,vM:r,actionType:r}),i},s=i,o.prototype.register=function(t,e,r,n,i,o,a){var u,e,u=this,e=new s(u,e,t);u[t]=e,r&&(e.shortcutKey=u.getShortcutKey(r,n,i,o,a))},o.prototype.getCommand=function(t){return this[t]},o.prototype.execute=function(t){var e=this[t.cmd];if(e)return e.execute(this.DJ,t,0)},o.prototype.setShortcutKey=function(t,e,r,n,i,o){var a,t,t,u,s,a=this;if(t)(t=a[t])&&(t.shortcutKey=a.getShortcutKey(e,r,n,i,o));else if(t=a.getShortcutKey(e,r,n,i,o),u=a.getCommands(t))for(s=u.length-1;0<=s;s--)u[s].shortcutKey=void 0},o.prototype.getShortcutKey=function(t,e,r,n,i){var o,o;if(t)return(o=(o="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):a[t])||t)+(e?"+ctrl":"")+(r?"+shift":"")+(n?"+alt":"")+(i?"+window":"")},o.prototype.getCommands=function(t){return this.PUt[t]},o.prototype.addListener=function(t,e){this.aT[t]=e},o.prototype.removeListener=function(t){delete this.aT[t]},o.prototype.HUt=function(t){var e,r,e=this.aT;for(r in e)e.hasOwnProperty(r)&&e[r](t)},o.prototype.cM=function(t,e){this.GUt[t]=e},o.prototype.zUt=function(t){delete this.GUt[t]},o.prototype.UUt=function(t){var e,r,e=this.GUt;for(r in e)e.hasOwnProperty(r)&&e[r](t)},o.prototype.L0=function(){this.DJ=null},e.CommandManager=o},"./src/plugins/commands/undomanager.ts":function(t,e){var r;function n(t,e,r){var n=this;n.DJ=t,n.VUt=e=e<0?2147483647:e,n.Hw=r,n.Nmt=[],n.kmt=[],n.YUt=!1}Object.defineProperty(e,"__esModule",{value:!0}),e.UndoManager=void 0,n.prototype.dM=function(t,e){var r,n,i,o,r=this;if(t){if(1===e)r.kmt.push(t);else{if(n=r.VUt,i=r.Nmt.length,0<n&&n<=i)for(o=0;o<i-n+1;o++)r.Nmt.shift();r.Nmt.push(t),0===e&&(r.kmt=[])}r.YUt=!0}},n.prototype.canUndo=function(){return 0<this.Nmt.length},n.prototype.undo=function(){var t,e,r,n,i,t=this,e=t.Nmt,r=!0;if(t.Hw&&t.canUndo()){n=e[e.length-1];try{(i=t.DJ.commandManager()[n.cmd])&&(n.hM=!0,r=i.execute(t.DJ,n,1))}catch(t){r=!1}delete n.hM,!1!==r&&(e.pop(),t.YUt=!0,t.kmt.push(n))}return r},n.prototype.canRedo=function(){return 0<this.kmt.length},n.prototype.redo=function(){var t,e,r,n,i,t=this,e=t.kmt,r=!0;if(t.Hw&&t.canRedo()){n=e[e.length-1];try{(i=t.DJ.commandManager()[n.cmd])&&(n.hM=!0,r=i.execute(t.DJ,n,2))}catch(t){r=!1}delete n.hM,!1!==r&&(e.pop(),t.YUt=!0,t.Nmt.push(n))}return r},n.prototype.getRedoStack=function(){return this.kmt.slice()},n.prototype.getUndoStack=function(){return this.Nmt.slice()},n.prototype.maxSize=function(t){var e=this;return arguments.length<1?e.VUt:(0<=t&&(e.VUt=t),e)},n.prototype.clear=function(){this.Nmt=[],this.kmt=[]},n.prototype.aL=function(t){this.Nmt=this.Nmt.filter(t),this.kmt=this.kmt.filter(t)},n.prototype.L0=function(){this.DJ=null},n.prototype.setNewChangeStatus=function(t){this.YUt=t},n.prototype.getNewChangeStatus=function(){return this.YUt},e.UndoManager=n},"./src/plugins/formatter/formatter.entry.ts":function(t,e,r){var n,i,n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&("get"in i?e.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){t[n=void 0===n?r:n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r("./src/plugins/formatter/formatter.ts"),e)},"./src/plugins/formatter/formatter.res.en.ts":function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidCast=e.Exp_ValueIllegal=e.Exp_TokenIllegal=e.Exp_DuplicatedDescriptor=e.Exp_ValueIsNull=e.Exp_FormatIllegal=e.Exp_InvalidBackslash=e.Exp_TokenIsNull=void 0,e.Exp_TokenIsNull="token is null",e.Exp_InvalidBackslash="the '\\' cannot be evaluated",e.Exp_FormatIllegal="format is illegal.",e.Exp_ValueIsNull="value is null",e.Exp_DuplicatedDescriptor="The type of descriptor was added.",e.Exp_TokenIllegal="token is illegal.",e.Exp_ValueIllegal="value is illegal.",e.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(l,t,e){var E,g,v,p,R,F,r,e,e,f,s,b,_,w,m,I,B,L,c,G,z,K,J,V,D,W,y,U,q,Y,X,M,H,N,u,k,h,Z,$,d,S,Q,tt,et,rt,r,nt,it,ot,at,ut,st,ft,yt,ct,mt,Mt,ht,dt;function n(t,e){var e,t,r,n;if(Pt.call(this,e),(e=this).Jq=t,r=T((t=e.Jq)[0],s,!1),n=t.indexOf("-"),!(r&&-1<n))throw new Error(f().Exp_TokenIllegal);e.ZUt=A(t,1,n-1),0<(t=g.zf.VP(t,0,n+1)).length&&(e.Iat=parseInt(t,16))}function i(t,e){this.formatCached=t,this.cultureName=e,this.typeName=""}function lt(t,e){var n,r,i,o,a,u,s,i;for(Pt.call(this,e),n=this,u=0,s=(a=["<=","<>",">=",">","<","="]).length;u<s;u++)if(g.zf.fJ(t,r=a[u],!0)){i=g.zf.VP(t,0,r.length),i=parseFloat(i),H(i)||(o=i);break}if(o===b&&o===_)throw new Error(f().Exp_TokenIllegal);n.value=o,n.WUt=r,n.isMeetCondition=function(t){var e=n.WUt,r=n.value;switch(e){case"<=":return t<=r;case"<>":return t!==r;case">=":return r<=t;case">":return r<t;case"<":return t<r;case"=":return t===r}}}function P(t,e){Pt.call(this,e);var e=this;if(e.token=t,e.type=parseInt(g.zf.VP(t,0,"dbnum".length),10),e.type<0||4<e.type)throw new Error(f().Exp_TokenIllegal)}function x(t,e,r,n,i,o){St.call(this,e,r,n,o);var e=this;e.pU=e.QUt(Nt(t)),e.KUt=i,e.JUt=2,e.Hc()}function vt(t,e){var e,t,r;if(Pt.call(this,e),e=this,"h"===(t=h(t)[0]))r=3600;else if("m"===t)r=60;else{if("s"!==t)throw new Error(f().Exp_TokenIllegal);r=1}e.XUt=function(t){var t=t/1e3/r;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}}function gt(t,e){var e,e;Pt.call(this,e),null!==(e=V.exec(t))&&(e=Number(e[1]),0<=--e)&&e<J.length&&(t=J[e]),this.foreColor=t}function C(t,e,r,n){var r,n,i,t,e,t;function o(t,e){var r,n,i,o,a,u,s,r=[],n='"';if(t!==b&&""!==t){for(i=!1,a=!(o=[]),u=0;u<t.length;u++)(s=t[u])!==n||i||(a=!a),i||a||s!==e?o.push(s):(r.push(o.join("")),o=[]),i="\\"===s&&!i;r.push(o.join(""))}return r}St.call(this,e,r,n),(r=this).qUt=!1,r.JUt=1,r.$Ut=_t(t),n=Nt(t),-1<(i=(n=_t(n=e?Dt(n,r.j9t.Nat,r.j9t.currencySymbol()):n)).indexOf("/"))&&(t=o(n,"/"))&&2===t.length&&(r.tHt=t[1],e=t[0])&&(-1<(t=e.lastIndexOf(" "))?(r.nHt=A(e,0,t),r.eHt=A(e,t+1,e.length-t-1)):r.eHt=e),r.iHt=n}function o(t,e,r,n){St.call(this,e,r,n),0<arguments.length?(o.rHt(t)||$(),this.$Ut=t):this.$Ut="General",this.JUt=0}function a(t,e,r,n){var i,r,i=this;St.call(i,e,r,n),r=Nt(t,!1),r=Ht(r=_t(r=e?Dt(r,i.j9t.Nat,i.j9t.currencySymbol()):r)),i.pU=r,i.JUt=3}function A(t,e,r){return t.substr(e,r)}function pt(t){return p.lt.ht(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:t.toString()}function Ft(t,e){if("\\"===t[e])throw new Error(f().Exp_InvalidBackslash);if(0<e-1&&e-1<t.length&&"\\"===t[e-1]){if(e-2<0)return 1;if(0<e-2&&e-2<t.length)return"\\"!==t[e-2]}}function bt(t){if(t)return"["+t+"]";throw new Error(f().Exp_TokenIsNull)}function _t(t){var e,r,n,i,o;if(t===_||t===b||""===t)return t;for(e="",n=!1,i=r=0;i<t.length;i++)'"'===(o=t[i])?(n=!n,e+=o):n?e+=o:"["===o?r++:"]"===o?--r<0&&(r=0):0===r&&(e+=o);return e.toString()}function wt(t){return t=Dt(t,"[",""),Dt(t,"]","")}function Dt(t,e,r){return!t||t===S.oHt||T(e,r,!0)?t:(e=e.replace(z,"\\$1"),t.replace(new RegExp(e,"g"),r))}function Ht(t){for(var e,r,n,i,o,e=t.length,r=!1,n="",i=0;i<e;i++)"\\"===(o=t.charAt(i))?(r=!r)&&"@"!==t.charAt(i+1)||(n+=o):(r=!1,n+=o);return n}function T(t,e,r){return r?h(t)===h(e):t===e}function Nt(t,e){var r,n,i,o;for(1===arguments.length&&(e=!0),r=!1,n="",i=0;i<t.length;i++){if('"'===(o=t[i]))r=!r;else if(!r&&!e&&"/"===o&&!Ft(t,i))continue;n+=o}return n}function kt(t){for(var e,r,n,i,o,e="",r=!1,n=0,i=t.length;n<i;n++)'"'===(o=t[n])&&(r=!r),"E"===o||r||(e+=h(o));return e}function $t(t,e){var r,n,i,o;if(t&&t!==S.oHt)for(n=kt(r=Nt(t)),i=0;i<e.length;i++)if(0===(o=n.indexOf(e[i]))||0<o&&"_"!==n[o-1]&&"*"!==n[o-1])return!0;return!1}function St(t,e,r,n){this.j9t=t,this.aHt=e,this.cultureName=r,this.O9t=n}function Pt(t){this.Nat=t}function xt(t){var e,t,r,t=wt(t);return t&&t!==S.oHt&&(r=t[0],-1<["<",">","="].indexOf(r)?(e=nt).Name="ConditionalFormatPart":g.zf.fJ(t,"DBNum",!0)?(e=it).Name="DBNumberFormatPart":T(t[0],s,!1)&&-1<t.indexOf("-")?(e=rt).Name="LocaleIDFormatPart":At(t)?(e=at).Name="ABSTimeFormatPart":t.indexOf(s)<0&&3<=t.length&&((e=ut).Name="ColorFormatPart")),e}function Ct(t,e){var r,t,r=!1,t=$t(t=t?t.toString():S.oHt,["general"])?ft:ot.a0(t)?ot:$t(t,["E+","E-","#",".",",","%","0","/","?"])||e?(r=!0,st):(r=!0,yt);return{uHt:r,uit:t}}function At(t){var e,r,n,e=h(t),r=e[0];if("h"===r||"m"===r||"s"===r){for(n=1;n<e.length;n++)if(r!==e[n])return;return 1}}function Tt(t,e,r){var t,r,t=t?t.cultureInfo():N(r);return(e<4||4===e&&("ko-kr"===r||"ko-kr"===t.name()))&&(r=t.NumberFormat.dbNumber)?r[e]:b}function Ot(t,e,r,n,i){var o,r,o=t;if(!M(n)&&e instanceof Date){if(!(r=Tt(r,n.type,i)))return t;o=n.sHt(o,r,!0),o=(o=(o=1===n.type?o.replace(new RegExp(B,"g"),L):o).replace("@"+m.cHt,v.ct.Pe(e,m.cHt))).replace("@"+m.fHt,v.ct.Pe(e,m.fHt)),o=n.sHt(o,r,!1)}return o}function jt(t,e,r,n,i){var o,a,u,s,f,y,c;if(!M(n)&&(o=Tt(r,n.type,i),!M(o)))for(a=!1,u=void 0,s=N(i),f=void 0,y=0,c=t.length;y<c;y++)"decimalSeparator"===t[y].type&&(a=!0,t[y].value=n.sHt(t[y].value,o,e),u=t[y].value),"number"===t[y].type&&(t[y].value=a?n.sHt(u+t[y].value,o,e).slice(1):n.sHt(t[y].value,o,e),"ja-JP"===s.name())&&1<t[y].value.length&&("\u4e00\u5343"!==(f=t[y].value.substr(0,2))&&"\u4e00\u767e"!==f&&"\u4e00\u5341"!==f||(t[y].value=t[y].value.substr(1)));return t}function O(t,e){var r=this;0===arguments.length?(r.formatCached="General",r.E9t=new ft):r.Hc(t,e)}function j(t,e){var r,n,r=dt.call(this,t,e)||this,n=r;return n.lHt=!0,n.PropertyChanged=[],S.Ji(t)&&(t="General"),n.formatCached=t,n.cultureName=e,n.init(),r}function Et(t){for(var e,r,n,i,o,e=[],r=0,n=0,i=t.length,o=0;o<i;o++)"_"===t[o]?r++:(";"!==t[o]||0!==r&&r%2!=0||(e.push(t.substring(n,o)),n=o+1),r=0);return n<=i&&e.push(t.substring(n,i)),e}function Rt(i){for(var o,t,e,r,a,u,n,s,f,o=[],t=!1,e=!1,r="",a=function(t,e){return{type:t,content:e}},u=function(t){return!M(t)&&-1!=="yYdDhHmMsSeE".indexOf(t)},n=function(t,e){if(u(t)){for(var r=t,n=i[e+1];u(n)&&n.toLowerCase()===t.toLowerCase()&&(r+=n,e<i.length-1);)n=i[++e+1];o.push(a("symbolic",r))}else"a"===t&&"aaa"===i.slice(e,e+3).toLowerCase()?(o.push(a("symbolic",i.slice(e,e+3))),e+=2):o.push(a("text",t));return e},s=0;s<i.length;s++)if(f=i[s],t)o.push(a("text","\\"+f)),t=!1;else if(e&&'"'!==f)r+=f;else switch(f){case"\\":t=!0;break;case'"':e&&(o.push(a("text",'"'+r+'"')),r=""),e=!e;break;default:s=n(f,s)}return o}E=this&&this.__extends||(ht=function(t,e){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}ht(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralFormatter=t.Hf=t.FormatterBase=void 0,g=e("./src/common/util/stringhelper.ts"),v=e("./src/common/util/datetimehelper.ts"),p=e("./src/common/util/types.ts"),R=e("./src/common/util/numberhelper.ts"),F=e("./src/common/culture/cultureInfo.ts"),r=e("./src/common/util/common.ts"),e=e("./src/plugins/formatter/formatter.res.en.ts"),p.lt.Dh(r.SR.en,e),e=new r.ResourceManager(r.SR),f=e.getResource.bind(e),s="$",p.lt.dt=function(t,e){if(p.lt.ht(t))return"null"===e;if(e){if(e instanceof Function&&t instanceof e)return!0;if(typeof t===e)return!0;if("function"===e&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e.toLowerCase())return!0;if("DateTime"===e)return t instanceof Date;var t;if("TimeSpan"===e)return t instanceof Date&&0<=(t=v.ct.o0(t))&&t<1;"string"==typeof e&&"undefined number boolean string".indexOf(e)}return!1},p.lt.q8=function(t,e){return!!R.st.hUt(t,e)&&("string"!=typeof t||-1===t.search(/[\r\n\t]/g))&&(t=R.st.Jf(t,e),p.lt.dt(t,"number")||p.lt.dt(t,"DateTime")||p.lt.dt(t,"TimeSpan")||t&&!p.lt.dt(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(2<=t.length&&"0"===t[0]&&"x"===t[1]))},p.lt.uJ=function(t){return p.lt.ht(t)||""===t?0:p.lt.dt(t,"number")?t:p.lt.dt(t,"string")&&!isNaN(t)?R.st.yU(t):p.lt.dt(t,"boolean")?t?1:0:p.lt.dt(t,"DateTime")?v.ct.o0(t):p.lt.dt(t,"TimeSpan")?Math.floor(v.ct.o0(t)):parseFloat(t)},b=null,_=void 0,w=Math.abs,m={fHt:"yy",hHt:"y",cHt:"yyyy",dHt:"m",vHt:"mm",mHt:"mmm",gHt:"mmmm",pHt:"mmmmm",bHt:"d",yHt:"dd",wHt:"aaa",MHt:"aaaa",CHt:"h",SHt:"hh",THt:"m",AHt:"mm",IHt:"s",xHt:"ss",IGt:"e",NHt:"AM/PM",kHt:"A/P",DHt:"@mmmmm",_Ht:new Date(1899,11,30,0,0,0,0)},I=[m.hHt,m.fHt,m.cHt,m.dHt,m.vHt,m.mHt,m.gHt,m.pHt,m.bHt,m.yHt,m.wHt,m.MHt,m.CHt,m.SHt,m.THt,m.AHt,m.IHt,m.xHt,"ggg","gg","g","ee","e"],B="\u4e00\u5341",L="\u5341",c={EHt:0,jHt:1,OHt:2,_text:3},G=[{EHt:0,jHt:0,OHt:0,_text:0},{EHt:0,jHt:1,OHt:0,_text:0},{EHt:0,jHt:1,OHt:2,_text:0},{EHt:0,jHt:1,OHt:2,_text:3}],z=new RegExp("([.+?*$^\\[\\](){}|/])","g"),K=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt","M/d/yyyy H:m:s","M-d-yyyy H:m:s","M/d/yyyy h:m:s tt","M-d-yyyy H:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],J=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"],V=new RegExp("color\\s*(\\d+)","i"),D=p.lt.dt,W=p.lt.Nh,y=R.st,U=y.gUt+"."+y.pUt,q=y.mUt,Y=y.L9t,X=y.E8,M=p.lt.ht,H=isNaN,N=function(t){return F.CultureManager.Fe(t)},u=function(t){return N(t).DateTimeFormat},k=function(t){return N(t).NumberFormat},h=function(t){return t&&t.toLowerCase()},Z=function(t){return t&&t.toUpperCase()},$=function(){throw new Error(f().Exp_FormatIllegal)},d=function(){return F.CultureManager.booleanMapping},S={oHt:"",I5:function(){for(var t,e,r,n,i,o,a,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(0===arguments.length)return b;for(i=r[0],o=1;o<arguments.length;o++)a=new RegExp("\\{"+(o-1)+"\\}","gm"),i=i.replace(a,arguments[o]);return i},Ji:function(t){return!t||t===S.oHt}},tt=function(t){var t=t.charCodeAt(0);return 48<=t&&t<=57},et=function(t){var t=t.charCodeAt(0);return 9<=t&&t<=13||32===t||133===t||160===t},n.prototype.cultureInfo=function(){var t=this;return t.RHt||(t.RHt=N(t.Iat)),t.RHt},n.prototype.currencySymbol=function(){return this.ZUt?g.zf.Vi(this.ZUt,"\\.",'"."'):S.oHt},n.prototype.allowScience=function(){if(this.RHt)return!this.RHt.isJCKCulture},n.prototype.toString=function(){return this.Jq?bt(this.Jq):S.oHt},n.Name="LocaleIDFormatPart",rt=n,i.prototype.format=function(t,e){return b},i.prototype.parse=function(t){return b},i.prototype.formatString=function(t){return this.formatCached},i.prototype.toJSON=function(){var t,e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},i.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==_&&(this[e]=t[e])},t.FormatterBase=r=i,lt.prototype.toString=function(){return bt(this.WUt+this.value.toString())},nt=lt,P.prototype.sHt=function(t,e,r){var n,i,o,a,u,s,f,y,c,m;if(!t||t===S.oHt)return t;for(u=!(a=o=-1),c=(i=n=t).length-1;0<=c;c--)m=i[c],!H(m)&&!T(m," ",!1)||T(m,".",!1)&&!u?(T(m,".",!1)&&(u=!0),-1===o&&(o=c),a=c):-1<a&&-1<o&&(s=A(i,a,o-a+1),f=parseFloat(s),H(f)||(y=P.numberString(s,e,r),n=g.zf.VP(n,a,o-a+1),n=g.zf.Eit(n,a,y)),u=!(a=o=-1));return-1<a&&-1<o&&(s=A(i,a,o-a+1),f=parseFloat(s),H(f)||(y=P.numberString(s,e,r),n=g.zf.VP(n,a,o-a+1),n=g.zf.Eit(n,a,y))),n},P.prototype.toString=function(){if(-1<this.type)return bt("DBNum"+this.type);throw new Error},P.numberString=function(t,e,r){var n,t,i,o,n=P.formatNumberString,t=t.split(".");if(t){if(1===t.length)return n(t[0],e.numbers,r?e.letters:b);if(2===t.length)return(i=n(t[0],e.numbers,r?e.letters:b))+"."+(o=n(t[1],e.numbers))}throw new Error(f().Exp_ValueIllegal)},P.formatNumberString=function(t,e,r){var n,i,o,a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,n=t,i=0,a=0;if(2===arguments.length){for(u="";i<n.length;i++)o=A(n,i,1),u+=e[a=parseInt(o,10)];return u}if(3===arguments.length){if(!r)return P.formatNumberString(t,e);for(s=0,f="",y=n.length,c=!1,m=[];i<y;i++)-1<(M=r.length-1-i)?m.push(r[M].toString()):m.push(S.oHt);for(h=[],d=m.length-1;0<=d;d--)h[m.length-d-1]=m[d];for(m=h,l=!1,d=0;d<y;d++)o=A(n,d,1),a=parseInt(o,10),v=void 0,g=S.oHt,0<y-d-16?(v=e[a],l=!(g="")):d!==y-1&&d!==y-5&&d!==y-9&&d!==y-13?"0"===o?(g=v="",s+=1):s=(g=(v="0"!==o&&0!==s?e[0]+e[a]:e[a],m[d]),0):"0"!==o&&0!==s?(v=e[0]+e[a],g=m[d],s=0):"0"!==o&&0===s||l?(v=e[a],g=m[d],s=0,l=!1):("0"===o&&3<=s?g=v="":11<=y?v="":(v="",g=m[d]),s+=1),(p=v+g===S.oHt)||(c=!1),d!==y-13||c||(g=m[d],c=!0),d!==y-9||c||(g=m[d],c=!0),d===y-1&&(g=m[d],c=!0),f=f+v+g;return 0===(F=parseInt(t,10))?e[0]:f}},it=P,x.prototype.Hc=function(){var t,e,r,n,i,o,a,t=this,e={y4:t.pU},r;if(x.a0(e.y4)){if(n=t.BHt(e),i=u(this.cultureName).amDesignator&&u(this.cultureName).pmDesignator,t.hasJD=t.Vi(e.y4,m.pHt,'"'+m.DHt+'"',!0,!1,e,!1),t.Vi(e.y4,m.gHt,"MMMM",!0,!1,e,!1),t.Vi(e.y4,m.mHt,"MMM",!0,!1,e,!1),t.LHt(e.y4,e),t.Vi(e.y4,m.wHt,"ddd",!0,!0,e,!0),t.Vi(e.y4,m.MHt,"dddd",!0,!0,e,!0),n&&i||(t.Vi(e.y4,m.CHt,"H",!0,!0,e,!1),t.Vi(e.y4,m.SHt,"HH",!0,!0,e,!1)),t.aHt&&(t.j9t||N(t.cultureName).NumberFormat.dbNumber)&&(t.FHt=t.FHt||t.Vi(e.y4,m.cHt,'"@'+m.cHt+'"',!0,!1,e,!0),t.FHt=t.FHt||t.Vi(e.y4,m.fHt,'"@'+m.fHt+'"',!0,!1,e,!0)),t.KUt)for(o=0;o<t.KUt.length;o++)a=t.KUt[o],t.Vi(e.y4,a.Nat,"@"+a.Nat,!0,!0,e,!0);t.PHt=e.y4}else $()},x.prototype.formatString=function(){return this.pU},x.prototype.format=function(e){var t,r,n,i,o,a,u,s,f,y,c,t=this,r=S.oHt,n=b;try{if((n=(n=v.ct._DT(e))&&H(n.valueOf())?b:n)?e=n:r=e.toString(),n&&(r=v.ct.L9t(n,t.PHt,t.j9t&&t.j9t.cultureInfo()||N(t.cultureName),t.O9t),t.hasJD&&(i=N(t.cultureName).DateTimeFormat.monthNames[n.getMonth()],r=g.zf.Vi(r,m.DHt,A(i,0,1))),t.KUt))for(o=24*(v.ct.o0(n)-v.ct.o0(m._Ht))*60*60*1e3,a=0;a<t.KUt.length;a++)s=(u=t.KUt[a]).XUt(o),M(s)||(f=u.Nat.replace("[","\\[").replace("]","\\]"),y=u.Nat.replace("[","").replace("]",""),c=g.zf.B9t(s+"",y.length),r=g.zf.Vi(r,"@"+f,c))}catch(t){r=pt(e)}return Ot(r,e,t.j9t,t.aHt,t.cultureName)},x.prototype.parse=function(e){var t,e,r,r,n;if(!e||e===S.oHt)return b;if(t=this,"true"===(r=h(e=e)))return!0;if("false"===r)return!1;if(t.PHt&&(r=v.ct.nUt(e,t.PHt,N(t.cultureName))))return r;try{return(n=v.ct._DT(e))&&!H(n)?n:(n=new Date(e),H(n.valueOf())?e:n)}catch(t){return e}},x.prototype.QUt=function(t){for(var e,r,n,i,o,a,e=t,r="",n=!1,i=0;i<e.length;i++)'"'===(o=e[i])?n=!n:n||"Y"!==o&&"D"!==o&&"S"!==o&&"E"!==o&&"G"!==o&&("M"!==o||T("A",a=e[i-1],!0)||T("P",a,!0))||(o=h(o)),r+=o;return r},x.prototype.BHt=function(t){var e,r,n,i,o,a,e=u(this.cultureName).amDesignator,r=u(this.cultureName).pmDesignator,n=[m.NHt];for(n.push(e&&r?e+"/"+r:m.NHt),n.push(m.kHt),i=["tt","tt","t"],o=t.y4,a=0;a<3;a++){if(g.zf.OS(o,i[a]))return!0;if(g.zf.OS(o,n[a],!0))return t.y4=g.zf.Vi(o,n[a],i[a],!0),!0}return!1},x.prototype.LHt=function(t,e){for(var r,n,i,o,a,r=Rt(t),n=-1,i=-1,o=0;o<r.length;o++)"symbolic"===(a=r[o]).type?"m"===a.content[0].toLowerCase()?0<=n?(a.content=a.content.toLowerCase(),n=-1):(a.content=a.content.toUpperCase(),i=o):"s"===a.content[0].toLowerCase()?0<=i&&(r[i].content=r[i].content.toLowerCase(),i=-1):i=("h"===a.content[0].toLowerCase()&&(n=o),-1):"0"===a.content&&"."===r[o-1].content&&0<=i&&o===i+2&&(r[i].content=r[i].content.toLowerCase());e.y4=r.map(function(t){return t.content}).join("")},x.prototype.Vi=function(t,e,r,n,i,o,a){var u,s,f,y,c,m,M,h,d,l,v;if(n||i){for(u=[],s=!0,!x.hasDate(t)&&x.hasTime(t)&&(s=!1),f=!1,y=0;y<t.length;y++){if(c=t[y],x.hasTime(c)&&!f?s=!1:x.hasDate(c)&&!f&&(s=!0),n&&T(c,e[0],a)&&s||i&&T(c,e[0],a)&&!s){for(m=!0,M=0;M<e.length;M++)if(M+y>=t.length||!T(e[M],t[M+y],a)){m=!1;break}if(h=y+e.length-1,m&&1+h<t.length){for(d=t[h],l=-1,l=1+h;l<t.length&&T(d,t[l],a);l++);1+h<l&&(y=l,m=!1)}m&&!f&&u.splice(0,0,y)}'"'===c&&(f=!f)}if(o.y4=t,0<u.length){for(y=0;y<u.length;y++)o.y4=g.zf.VP(o.y4,v=u[y],e.length),o.y4=g.zf.Eit(o.y4,v,r);return!0}}return!1},x.hasTime=function(t){return-1<g.zf.hD(t,m.CHt[0],!0)||-1<g.zf.hD(t,m.IHt[0],!0)},x.hasDate=function(t){return-1<g.zf.hD(t,m.fHt[0],!0)||-1<g.zf.hD(t,m.bHt[0],!0)},x.a0=function(t,e){return $t(t,e||I)},ot=x,t.Hf=ot,vt.Name="ABSTimeFormatPart",at=vt,gt.prototype.toString=function(){return bt(this.foreColor)},gt.Name="ColorFormatPart",ut=gt,C.prototype.formatString=function(){return this.$Ut},C.prototype.format=function(t){var e,r,t,n,i,o,a,u,s,f,y,c,m,m,m,M,h,h,d,l,l,h;return D(t,"boolean")?t.toString().toUpperCase():(e=this,r=p.lt.uJ(t),H(r)||!isFinite(r)||H(t)?"string"==typeof t?t:b:(t=N(e.cultureName),e.eHt&&e.tHt?(f={value:0},y={value:0},c={value:0},m=e.GHt(),C.getFraction(r,m,f,y,c)?(1<(m=C.getGCD(y.value,c.value))&&(y.value/=m,c.value/=m),e.nHt?(s="",1===c.value&&(f.value+=y.value,y.value=0,c.value=0),(m=q(Y(f.value,e.nHt,t)))&&"0"!==m&&(s=s+m+" "),0===f.value&&r<0&&(s+=t.NumberFormat.negativeSign),0===r&&(s+="0"),i=e.tHt,o=parseFloat(i),!H(o)&&0<o&&(0!==y.value&&0!==c.value&&(y.value*=o/c.value),c.value=o,i=i.replace(/^\d+/,C.toNumberPlaceholder(o)),u=(a=Math.ceil(y.value))-y.value,y.value=u<=.5&&0<=u?parseFloat(a.toString()):parseFloat((a-1).toString())),M=e.eHt,h=parseFloat(M),H(h)||0!==h||(h=M.length,(l=(d=y.value.toString()).length)<h?M=M.substr(0,h-(h-l)):h<l&&(d=d.substr(0,l-(l-h)),y.value=parseInt(d,10))),l=e.UHt(y.value,c.value,M,i,t),0===y.value&&(l=l.replace(/./g," "),""===m)?"0 "+l:""===(s+=l)?"0":s):(s="",h=f.value*c.value+y.value,i=e.tHt,0<(o=parseFloat(i))?(h*=o/c.value,c.value=o,s+=(h=(u=(a=Math.ceil(h))-h)<=.5&&0<=u?parseFloat(a.toString()):parseFloat((a-1).toString()))+"/"+c.value):s+=e.UHt(h,c.value,e.eHt,e.tHt,t),0===h?"0":s)):r.toString()):jt(n=Y(r,e.iHt,t),e.qUt,e.j9t,e.aHt,e.cultureName)))},C.prototype.parse=function(t){var e,r,r,n,i,o,i,n,i,n,a,u,i,n,o,s,e=this;if(t&&t!==S.oHt){if("TRUE"===(r=Z(t))||r===d()&&d().boolean_true)return!0;if("FALSE"===r||r===d()&&d().boolean_false)return!1;if((r="("===t.charAt(0)&&")"===t.charAt(t.length-1))&&(t=t.substring(1,t.length-1)),n=e.eHt&&e.tHt,i=e.zHt(e.iHt).HHt,(n||i)&&(o=0,n&&e.nHt&&0<(i=(t=t.trim()).lastIndexOf(" "))&&i<t.length-1&&(o=parseInt(t.substr(0,i),10),t=t.substr(i+1)),0<(n=t.indexOf("/")))&&n<t.length-1&&(i=t.substr(0,n),n=t.substr(n+1),!(H(i)||H(n)||(a=parseInt(i,10),u=parseInt(n,10),H(a))||H(u)||0===u)))return o+a/u;if(t=e.VHt(t),t=e.YHt(t),n=(i=e.zHt(t)).HHt,o=i.$6t,e.ZHt(o)&&(o=g.zf.OUt(o,k(e.cultureName).numberGroupSeparator,"",!1),s=y.dUt(o,e.cultureName),!H(s))&&isFinite(s)){if(n&&(s=X(s/100,15)),r){if("-"===o.charAt(0)||"+"===o.charAt(0))return b;s=-1*w(s)}return s}}return b},C.prototype.GHt=function(){var t,e,r,n,i,t,e=this.tHt,r=0;if(e)for(n=e.length,i=0;i<n&&e[i].match(/[#?\d]/);i++)r++;return r},C.prototype.ZHt=function(t){for(var e,r,n,i,o,a,u,e="",r=0,n=0,i=0,o=b,a=k(this.cultureName),u=t.length-1;-1<u;u--){if(t[u]===a.numberDecimalSeparator)r++,0<i&&(o=!1),e="";else if("e"===h(t[u])){if(n++,e="",u===t.length-1)return!1}else if(t[u]===a.numberGroupSeparator)o=3===e.length,i++,e="";else if("-"===t[u]||"+"===t[u]){if(0<u&&"e"!==h(t[u-1]))return!1}else{if(!tt(t[u]))return!1;if(e+=t[u],0===u&&0===parseInt(e,10)&&o)return!1}if(1<r||1<n||!1===o)return!1}return!0},C.prototype.VHt=function(t){for(var e,r,n,t,i,o,a,a,u,e=t,r=[],n=0;n<e.length;n++)tt(e[n])&&r.push(n);for(i=[(t=k(this.cultureName)).currencyDecimalSeparator,t.currencyGroupSeparator,t.currencySymbol,s,t.nanSymbol,t.negativeInfinitySymbol,t.negativeSign,t.numberDecimalSeparator,t.numberGroupSeparator,t.percentDecimalSeparator,t.percentGroupSeparator,t.percentSymbol,t.perMilleSymbol,t.positiveInfinitySymbol,t.positiveSign],o=e.length-1;-1<o;o--)if(a=e[o],et(a)&&i.indexOf(a.toString())<=-1)(o<r[0]||r[r.length-1]<o)&&(e=g.zf.VP(e,o,1));else if(("-"===a||"+"===a)&&(a=0<o?e[o-1].toString():b,(u=["e","E","(",k(this.cultureName).currencySymbol,s]).indexOf(a)<0))break;return e},C.prototype.YHt=function(t){var e,r;if(g.zf.fJ(t,s)){if((e=g.zf.VP(t,0,1)).indexOf(s)<0)return e}else if(r=k(this.cultureName).currencySymbol,s!==r&&g.zf.fJ(t,r)&&(e=g.zf.VP(t,0,r.length)).indexOf(r)<0)return e;return t},C.prototype.zHt=function(t){var e,r,n,e=k(this.cultureName).percentSymbol,r=!0,n=t;return g.zf.fJ(t,e)?n=g.zf.VP(t,0,e.length):g.zf.dT(t,e)?n=g.zf.VP(t,t.length-e.length,e.length):r=!1,{$6t:n,HHt:r=g.zf.OS(n,e)?!1:r}},C.prototype.UHt=function(t,e,r,n,i){var o,a,u,s,i,o,o=q(Y(t,r,i)),a,u,s=q(Y("0."+e,"#."+n,i,!0)),i=i&&i.NumberFormat&&i.NumberFormat.numberDecimalSeparator||".",o=o+"/"+s.substr(s.indexOf(i)+1);return""===r&&(o=t+o),""===n&&(o+=e),o},C.getGCD=function(t,e){var r,n,i;if(0===t)return w(e);if(0===e)return w(t);for(i=(r=Math.max(t,e))%(n=Math.min(t,e));0!==i;)i=(r=n)%(n=i);return w(n)},C.getFraction=function(t,e,r,n,i){var o,a,u,s,f,f,y,c,m,M,h,d,l,v,o=0,a=0,u=0,s=0,f=Math.ceil;for(0<t?o=1===(s=t-f(t)+1)?(s=0,t):f(t)-1:t<0&&(o=f(t),s=f(t)-t),f=Math.pow(10,e-1),(y=Math.pow(10,e)-1)<2&&(y=2),c=!1,m=0,M=f=f<2?2:f;M<=y&&(d=Math.round(h=M*s),v=w((l=d/M)-s),!((!c||v<w(m-s))&&(c=!0,m=l,a=d,u=M,v<1e-6)));M++);return r.value=o,n.value=a,i.value=u,c},C.toNumberPlaceholder=function(t){return t.toString().replace(/\d/g,"?")},st=C,o.rHt=function(t){for(var e,r,n,i,o,a,e="",r=!1,n=-1,i=t.length,o=0;o<i;o++)'"'===(a=t[o])?n=(r=!r)?o:-1:r||(e+=a);return 0<n&&(e+=t.substring(n,i)),!(0<=e.indexOf("0")||0<=e.indexOf("#")||0<=e.indexOf(".")||0<=e.indexOf("@"))},o.prototype.WHt=function(){var t,e,t=this;return t.QHt||(e=Dt(e=t.$Ut,"General",U),t.QHt=new st(e,t.j9t,t.aHt,t.cultureName),t.QHt.qUt=!0),t.QHt},o.prototype.KHt=function(){var t=this;return t.JHt||(t.JHt=new st("0.#####E+00",t.j9t,t.aHt,t.cultureName),t.JHt.qUt=!0),t.JHt},o.prototype.formatString=function(){return g.zf.Vi(this.$Ut,"@NumberFormat","General")},o.prototype.format=function(t){var e,r,n,i,e=this;if(p.lt.q8(t,e.cultureName)){if(r=!e.j9t||e.j9t.allowScience(),(n=p.lt.uJ(t))!==_&&n!==b)return(99999999999<w(n)&&r||w(n)<1e-11&&0!==n?e.KHt():e.WHt()).format(t)}else{if(D(t,"string"))return i=Ht(i=g.zf.Vi(e.formatString(),'"',"")),t;if(D(t,"boolean"))return t.toString().toUpperCase()}return""},o.prototype.parse=function(t){var e,r,n,n,i,o,a,u,i,s,f,o,e,y,c;if(S.Ji(t))return b;if("number"==typeof t)return t;if(e=!1,r=t.trim(),0<(n=g.zf.hD(r,"-",!1))&&!T(r.charAt(n-1),"E",!0)&&(e=!0),o=(i=(n=N(this.cultureName)).DateTimeFormat).dateSeparator,a=i.timeSeparator,u=i.monthNames,i=i.abbreviatedMonthNames,s=function(t,e){var r,n,i;if(!e||0===e.length)return!1;for(r=!1,n=0,i=e.length;n<i;n++)if(g.zf.OS(t,e[n],!0)){r=!0;break}return r},(e||g.zf.OS(r,o,!1)||g.zf.OS(r,a,!1)||g.zf.OS(r,"/",!1)||g.zf.OS(r,":",!1)||g.zf.OS(r,"-",!1)||g.zf.OS(r,"\u5e74",!1)||g.zf.OS(r,"\u6708",!1)||g.zf.OS(r,"\u65e5",!1)||s(r,u)||s(r,i)||"ja-JP"===n.name()&&0<=F.XPt.gGt.indexOf(r[0].toUpperCase())&&g.zf.OS(r,".",!1))&&(f=v.ct.yU(r)))return f;if((e="-"===r.charAt(0))||"+"===r.charAt(0)){if("("===(r=g.zf.VP(r,0,1)).charAt(0)&&")"===r.charAt(r.length-1))return t}else if("("===r.charAt(0)&&")"===r.charAt(r.length-1)&&(y=!0,"-"===(r=(r=r.substring(1,r.length-1)).trim()).charAt(0)||"+"===r.charAt(0)))return t;return(o=this.WHt().parse(r))===b||o===_||(c=y&&D(o,"boolean"))?t:(y||e)&&D(o,"number")?-1*w(o):o},ft=o,a.prototype.format=function(t,e){var r,n,i,o,r=this;try{return i=n=void 0,i=t instanceof Date?v.ct.o0(t).toString():pt(t),o=r.XHt(r.pU),n=r.qHt(i,o.formatTokens,t,o.hasAtPart,e)}catch(t){return""}},a.prototype.parse=function(t){return t||""},a.prototype.formatString=function(){return this.pU},a.prototype.XHt=function(t){for(var e,r,n,i,o,a,u,e=[],r=!1,n="",i=!1,a=b,u=0;u<t.length;u++)o=t.charAt(u),i?('"'!==o?n+=o:(e.push(n+=o),n="",i=!1),a=o):"*"!==a&&"_"!==a&&"\\"!==a||""===n?"*"===o||"_"===o||"\\"===o?(a=o,""!==n&&(e.push(n),n=""),n+=o):"@"===o?(a=o,""!==n&&(e.push(n),n=""),e.push(o),r=!0):'"'===o?(a=o,""!==n&&e.push(n),n=o,i=!0):(n+=o,a=o):(e.push(n+=o),n="");return""!==n&&e.push(n),{formatTokens:e,hasAtPart:r}},a.prototype.qHt=function(t,e,r,n,i){var o,a,u,s,o=[],a=!1;if("string"!=typeof r||n||i)for(u=e.length-1;0<=u;u--)"*"===(s=e[u])[0]?a||(a=!0,o.push({type:"fillingChar",value:s[1]})):"_"===s[0]?o.push({type:"placeholder",value:s[1]}):'"'===s[0]&&'"'===s[s.length-1]?2<=s.length&&o.push({type:"text",value:s.substr(1,s.length-2)}):"\\@"===s?o.push({type:"text",value:"@"}):"@"===s[0]?o.push({type:"text",value:t}):o.push({type:"text",value:s});else o.push({type:"text",value:r});return o.reverse()},yt=a,ct=function(){return{pattern:K,formatter:["d-mmm","mmm-yy",u().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",u().shortDatePattern+" h:mm",u().shortDatePattern+" h:mm:ss",u().shortDatePattern+" h:mm:ss.0"]}},O.prototype.Hc=function(t,e){var r,n,i,o,a,u,s,f,y,c,m,M,M,h,d,l,d;for(t!==b&&t!==_||$(),(n=this).formatCached=r=t,o=i="",s=u=a=!1,f=[],y=0;y<t.length;y++)'"'===(c=t[y])?(u=!u,o+=c):u?o+=c:"["===c?(a&&$(),o&&(i=i||"",i+=o),o=c.toString(),a=!0):"]"===c?(a||$(),o?(m=(o+=c).toString(),(M=xt(o.toString()))?"ABSTimeFormatPart"===M.Name?(f.push(new M(O.preProcessPart(m),m)),i+=o):m===F.XPt.eraExcelFormatter?(n.addPart(M,F.XPt.eraInternalFormatter),s=!0):n.addPart(M,m):(i+=M=O.partToNormalStr(m),r=Dt(t,m,M)),o=""):$(),a=!1):o+=c;o?a?$():i+=o:i=i||n.$Ht(),n.localeIDFormatPart&&(e=n.localeIDFormatPart.cultureInfo().name()),l=(d=Ct(i,h=n.conditionalFormatPart)).uit,d=d.uHt?r:i,l?n.E9t=new l(d,n.localeIDFormatPart,n.dbNumberFormatPart,e,0<f.length?f:b,s):$()},O.prototype.$Ht=function(){var e,t,r,e=this,t="";return t=e.dbNumberFormatPart&&!(r=O.proNames.some(function(t){return"dbNumberFormatPart"!==t&&e[t]}))?"General":t},O.prototype.formatString=function(){for(var t,e,r,n,i,t=this,e="",r=0,n=O.proNames.length;r<n;r++)t[i=O.proNames[r]]&&(e+=t[i].toString());return e+=t.E9t.formatString()},O.prototype.addPart=function(t,e){for(var r,n,i,o,a,u,r=this,n=O.proNames,i=O.preProcessPart(e),o=0,a=n.length;o<a;o++)if(T(u=n[o],t.Name,!0)){if(r[u])throw new Error(f().Exp_DuplicatedDescriptor);r[u]=new t(i,e)}},O.prototype.format=function(t,e){return this.E9t.format(t,e)},O.prototype.parse=function(t){return this.E9t.parse(t)},O.checkFormatter=function(t){if(!t||t===S.oHt)throw new Error(f().Exp_TokenIllegal)},O.preProcessPart=function(t){O.checkFormatter(t);var t=wt(t);return O.checkFormatter(t),t},O.partToNormalStr=function(t){var t=O.preProcessPart(t);return'"'+(t=t[0]===s?t.slice(1):t)+'"'},O.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],mt=O,E(j,dt=r),j.prototype.toJSON=function(){var t,e,t=this,e={formatCached:t.formatCached};return t.cultureName&&(e.customerCultureName=t.cultureName),"general"===h(t.formatCached)&&delete e.formatCached,e},j.prototype.hasFormattedColor=function(){var t,e,r,t=this;for(e in c)if(c.hasOwnProperty(e)&&(r=t.getFormatter(c[e]))&&r.colorFormatPart)return!0;return!1},j.prototype.formatString=function(t){var e,r,n,i,o,e=this;if(0===arguments.length){for(r=S.oHt,n=0,i=e.formatters.length;n<i;n++)r+=(o=e.formatters[n]).formatString(),n!==i-1&&(r+=";");return r}if(t)return e.formatters=b,e.formatCached=t,e.init(),e.tzt("formatString"),e;throw new Error(f().Exp_ValueIsNull)},j.prototype.getFormatter=function(t){var e=this;return e.formatters&&e.formatters[t]},j.prototype.getPreferredEditingFormatter=function(t){var e,r,n,i,e,r,r=u(this.cultureName),n=k(this.cultureName),i=j.defFormatter;return D(t,"TimeSpan")?i(r.longTimePattern):D(t,"DateTime")?(e=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",i(r.shortDatePattern+e)):p.lt.q8(t,this.cultureName)?1e21<=(r=p.lt.uJ(t))||r<=1e-17&&0<r||r<=-1e21||r<0&&-1e-17<=r?i(null!=(e=n.scientificNotation)?e:"0.##############E+00"):i(U):i("General")},j.prototype.getPreferredDisplayFormatter=function(t,e){var r,n,e,i,o,a,u,o,s,f,f,s,f,y,c,m,M,M,s,o,f,r,s,h,d,l,f,r=this,n=j.defFormatter;if((e=e||{value:b}).value=b,S.Ji(t))return new j;if(i=e.value=r.parse(e=t),D(i,"DateTime")||D(i,"TimeSpan")){for(a=(o=ct()).pattern,u=o.formatter,0<(f=(s=(o=N(r.cultureName)).DateTimeFormat).preselectedFormatters).length&&(a=a.concat([f]),u=u.concat([f[0]])),"ja-JP"===o.name()&&(a=a.concat([s.eraFormatter]),u=u.concat(["ge.M.d"]),f=o.QPt.filter(function(t){return"ggge"===t.substr(0,4)}),a=a.concat([f]),u=u.concat(['ggge"\u5e74"M"\u6708"d"\u65e5']),s=o.QPt.filter(function(t){return"gge"===t.substr(0,3)}),a=a.concat([s]),u=u.concat(['gge"\u5e74"M"\u6708"d"\u65e5']),f=o.QPt.filter(function(t){return"ge"===t.substr(0,2)}),a=a.concat([f]),u=u.concat(['ge"\u5e74"M"\u6708"d"\u65e5'])),y=0;y<a.length;y++)for(c=a[y],m=0;m<c.length;m++)if(M=c[m],(M=v.ct.yU(t,M))&&M-i==0)return new j(u[y])}else if(p.lt.q8(i,r.cultureName)){if(o=(s=k(r.cultureName)).currencySymbol,f=s.numberDecimalSeparator,r=s.percentSymbol,s=s.numberGroupSeparator,h="E",f=(l=(d=g.zf.OS)(e,f))?".00":"",e[0]===o)return n(S.I5("{0}#,##0{1};[Red]({0}#,##0{1})",o,f));if(d(e,h,!0))return n("0.00E+00");if(e[0].toString()===r||e[e.length-1].toString()===r)return n(S.I5("0{0}%",f));if(d(e,s))return n(S.I5("#,##0{0}",f))}return n("General")},j.prototype.format=function(e,t){var r,n,i,o,n,a,u;if(D(e,"boolean"))return(e=d()?e?d().boolean_true:d().boolean_false:e).toString().toUpperCase();if(i=0,o=(r=this).vn(e)){n=o.colorFormatPart,t&&n&&(t.conditionalForeColor=t.value=n.foreColor),(n=p.lt.q8(e,r.cultureName))&&(i=p.lt.uJ(e)),a=S.oHt;try{n&&o===r.getFormatter(c.jHt)&&0!==this.expressionNumber?(a=o.format(o.considerNegSymbol?i:w(i)))===b&&D(e,"string")&&(a=e):(a=o.value)===_&&(u=!r.lHt&&o===r.getFormatter(c._text),a=o.format(e,n||u)),t&&(t.content=W(a)?a:[{type:"text",value:a}]),W(a)&&(a=y.mUt(a))}catch(t){D(e,"string")&&(a=e.toString())}return a}return n&&i<0?"-".toString():!D(e,"string")&&(e===_||e===b)?S.oHt:e.toString()},j.prototype.parse=function(t){var e=this;return e.formatters&&0<e.formatters.length?e.formatters[0].parse(t):b},j.prototype.init=function(){var t,e,r,n,i,t=this,e=t.formatCached;for(S.Ji(e)&&$(),t.formatters=[],r=Et(e),t.lHt=1===r.length,(!r||r.length<1||4<r.length)&&$(),n=0;n<r.length;n++)-1!==r[n].indexOf("@")&&-1===r[n].indexOf("\\@")&&(n!==r.length-1?$():this.hasAt=!0),i=new mt(r[n],t.cultureName),t.formatters.push(i);t.getFormatter(c.EHt)||$(),this.nzt()},j.prototype.nzt=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var t=(0===this.expressionNumber?1:this.expressionNumber)-1;c=p.lt.Dh({},G[t]),this.hasAt&&0!==this.expressionNumber&&(c._text=this.formatters.length-1)},j.prototype.vn=function(t){var e,r,n,i,i,o,t,a,u,s,f,y,e=this;if(e.nzt(),n=(r=e.getFormatter(c.EHt))&&r.conditionalFormatPart,i=e.getFormatter(c._text),n&&(c.OHt=2,this.hasAt||(c._text=3)),"string"==typeof t&&H(t))return i||(n?t:r);if(p.lt.q8(t,e.cultureName)||D(t,"boolean")){if(i=e.getFormatter(c.jHt),o=e.getFormatter(c.OHt),t=p.lt.uJ(t),a=n&&r.conditionalFormatPart.isMeetCondition(t),s=(u=i&&i.conditionalFormatPart)&&i.conditionalFormatPart.isMeetCondition(t),f=void 0,e.lHt||(n?a:0<t||0===t&&!o))f=r;else if(u?s:t<0)f=i;else if(o)f=o;else if(i){if(n&&u)return{value:y=t+""};f=i}return f&&(!n||u||f!==i||o||(f.considerNegSymbol=!0),n&&u&&f===i&&i.conditionalFormatPart&&i.conditionalFormatPart.isMeetCondition(1e-10)&&(f.considerNegSymbol=!0),this.expressionNumber<=1)&&(f.considerNegSymbol=!0),f}return b},j.prototype.tzt=function(t){var e,r,n,e=this;if(e.PropertyChanged)for(r=0;r<e.PropertyChanged.length;r++)"function"==typeof(n=e.PropertyChanged[r])&&n(e,t)},j.defFormatter=function(t){var e=j[t];return e||(e=new j(t),j[t]=e),e},t.GeneralFormatter=j},"./src/plugins/slicer/slicer.entry.ts":function(t,e,r){var n,i,n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&("get"in i?e.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){t[n=void 0===n?r:n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r("./src/plugins/slicer/slicer.ts"),e)},"./src/plugins/slicer/slicer.ts":function(t,e,r){var r,$,S,a,i,o,n,u,s,P,f,r,r;function v(t){return"object"==typeof t&&t!==S&&t.text!==$}function y(){}function c(t,e){var r,n,t;if(t!==S&&t!==$){if(N(t)===a)e.value=t;else if(N(t)===o)e.value=t?1:0;else if(t instanceof Date)e.value=P.o0(t);else{if(N(t)!==i)return;if(0===x(t=t.trim()))return;if(r=!1,"%"===t.charAt(x(t)-1)&&(r=!0,t=t.substr(0,x(t)-1)),2<=x(t)&&"0"===t[0]&&"x"===t[1])return;if(n=Number(t).valueOf(),isNaN(n)||!isFinite(n)){if(t=new Date(t),isNaN(t))return;n=P.o0(t)}r&&(n/=100),e.value=n}return 1}}function g(t){var e,r,n,i,o,a,u,s,f,y,c,m,M,h,d,l,e=t.ezt;for(e||(t.izt=[],t.rzt=[]),r=e?t.ozt:t.izt,n=t.azt,i=t.uzt,o=e?t.szt:t.rzt,a=t.Mct,u=t.czt,s=t.fzt,f=x(t.data),c={},m=0;m<f;m++){for(M=!1,h=void 0,d=0;d<x(a)&&(h=a[d],e&&h===t.lzt||(i[h]?(H(c[l=t.columnNames[h]])&&(c[l]=t.getColumnIndex(l)),y=t.fue(c[l],m),M=!i[h][y]):n[h]&&(M=!n[h][m]),!M));d++);!M&&e&&(u?(H(c[l=t.columnNames[h]])&&(c[l]=t.getColumnIndex(l)),M=!u[y=t.fue(c[l],m)]):s&&(M=!s[m])),M||(r[m]=!0)}for(d=0;d<x(r);d++)r[d]&&o.push(d)}function h(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?P.o0(t):t}function m(t){var e,r,n,e=t.hzt={};for(t.dzt=[],t.vzt=[],t.mzt=[],t.gzt=[],r=t.columnNames,n=0;n<x(r);n++)e[(r[n]+"").toUpperCase()]=n}function p(t,e){var r,n,i,o,a,u,s,f,y,c,c,m,m,M,r=t.dzt,n=t.vzt,i=t.pzt,o=t.mzt,a=t.gzt,u=t.data,s=a[e]=[];for(t.bzt=[],r[e]=[],n[e]=[],i[e]={},o[e]=[],f={},y=0;y<x(u);y++)c=v(c=u[y][e])?c.text.trim():c,r[e].push(c),(m=f[h(c)])?(m.list.push(y),s[y]=m.index):(m=[y],n[e].push(c),o[e].push(m),M=x(o[e])-1,i[e][c]=M,s[y]=M,f[h(c)]={list:m,index:M})}function M(t,e,r){var n,i,o,a,u,s,f,y,c,c,m,M,h,d,l,n=t.yzt,i=t.getColumnIndex(e),o=[];if(i&&(a=t.ezt?t.wzt:t.Mzt[i],u=t.izt,a)){for(n[i]||t.Czt(i),s=[],f=n[i],y=0;y<x(f);y++)c=v(c=t.data[y][i])?c.value:c,s[f[y]]=c;for(m=t.Szt[i],y=0;y<x(a);y++){for(M=a[y],h=!1,l=(d=t.Tzt(s,M)).start;l<=d.end;l++)if(u[m[l]]){h=!0;break}h!==r&&o.push(M)}}return o}function d(t,e){var r,n,i,o,a,u,r=[],n=t.getColumnIndex(e);if(0<=n){for(i=x(t.getData(e)),o=t.ezt?t.ozt:t.izt,a=0;a<i;a++)o[a]||(u=t.fue(n,a),-1===r.indexOf(u)&&r.push(u));return r}}function l(t,e){var r,n,i,o,a,u,s,f,y,c,r=[],n={},i=t.getColumnIndex(e);if(0<=i)for(o=t.czt||t.fzt,a=t.uzt[i]||t.azt[i],u=t.ezt&&i===t.lzt?o:a,f=x((s=!!t.azt[i])?t.getData(e):t.getExclusiveData(e)),y=0;y<f;y++)!u||u[y]||n[c=s?t.fue(i,y):y]||(n[c]=!0,r.push(c));return r}function F(t,e){for(var r,n,i,o,a,u,s,f,y,c,m,M,r={},n=t.columnNames,o=x(n),i=0;i<o;i++)if(n[i]!==e)for(a=l(t,n[i]),u=0;u<x(a);u++)for(s=t.getRowIndexes(n[i],a[u]),f=0;f<x(s);f++)r[s[f]]||(r[s[f]]=!0);for(y={},o=x(t.data),i=0;i<o;i++)c=t.getExclusiveRowIndex(e,i),r[i]||(y[c]=!0);for(m=x(t.getExclusiveData(e)),M=[],i=0;i<m;i++)y[i]||M.push(i);return M}function b(t,e,r,n){var i,e,o,a,u,s,s,f,y,c,i=t.getColumnIndex(e),e=t.yzt;for(e[i]||t.Czt(i),o=[],a=e[i],u=0;u<x(a);u++)s=v(s=t.data[u][i])?s.value:s,o[a[u]]=s;for(f=[],u=0;u<x(r);u++)for(y=t.Tzt(o,r[u]),c=0;c<x(a);c++)a[c]>=y.start&&a[c]<=y.end&&(f[c]=!0);n?(t.fzt=f,t.wzt=r):(t.Mzt[i]=r,t.azt[i]=f,delete t.uzt[i],delete t.Azt[i]),g(t)}function _(t,e,r,n){for(var e,i,o,e=t.getColumnIndex(e),i=[],o=0;o<x(r);o++)i[r[o]]=!0;n?t.czt=i:(t.uzt[e]=i,t.Azt[e]=r,delete t.Mzt[e],delete t.azt[e]),g(t)}function w(t,e){t.ezt=!1,t.czt=[],t.szt=[],t.ozt=[],t.fzt=[],e&&t.onFiltered()}function D(t,e){var r,n,r=this;for(r.hzt={},r.dzt=[],r.vzt=[],r.pzt=[],r.mzt=[],r.gzt=[],r.uzt=[],r.Azt=[],r.azt=[],r.Mzt=[],r.izt=[],r.rzt=[],r.Mct=[],r.szt=[],r.ozt=[],r.ezt=!1,r.aT=[],r.Upt=0,r.bzt=[],r.Szt=[],r.yzt=[],r.lue=0,r.Izt(t,e),n=0;n<x(r.data);n++)r.izt[n]=!0,r.rzt.push(n)}function H(t){return t===$||t===S}function N(t){return typeof t}function x(t){return t?t.length:0}Object.defineProperty(e,"__esModule",{value:!0}),e.GeneralSlicerData=e.xzt=e.SlicerAggregateType=e.FilteredOutDataType=void 0,r=r("./src/common/util/datetimehelper.ts"),$=void 0,S=null,a="number",i="string",o="boolean",n=r.ct.o0,(r=u=e.FilteredOutDataType||(e.FilteredOutDataType={}))[r.all=0]="all",r[r.byCurrentColumn=1]="byCurrentColumn",r[r.byOtherColumns=2]="byOtherColumns",(r=s=e.SlicerAggregateType||(e.SlicerAggregateType={}))[r.average=1]="average",r[r.count=2]="count",r[r.counta=3]="counta",r[r.max=4]="max",r[r.min=5]="min",r[r.product=6]="product",r[r.stdev=7]="stdev",r[r.stdevp=8]="stdevp",r[r.sum=9]="sum",r[r.vars=10]="vars",r[r.varp=11]="varp",y.o0=function(t){return n(t)},y.quickSort=function(t){for(var e,r,n,e=x(t),r=[],n=0;n<e;n++)r[n]={index:n,value:t[n]};return y.quickSortImp(r)},y.quickSortImp=function(t){var e,r,n,i,o,a,u,s,f,e=t.length;if(e<=1)return t;for(r=y,i=t[n=Math.floor(e*Math.random())],o=[],a=[],u=[],s=0;s<e;s++)(n===s?u:(f=r.sortCompare(t[s].value,i.value))<0?o:0<f?a:u).push(t[s]);return r.quickSortImp(o).concat(u,r.quickSortImp(a))},y.isEquals=function(t,e){return!(!H(t)&&""!==t||!H(e)&&""!==e)||(t instanceof Date&&e instanceof Date?t.valueOf()===e.valueOf():N(t)===i&&N(e)===i?t.toLowerCase()===e.toLowerCase():t===e)},y.isGreaterThan=function(t,e){var r=N(t),n=N(e);return r===o?t=t?1:0:t instanceof Date&&(t=y.o0(t)),n===o?e=e?1:0:e instanceof Date&&(e=y.o0(e)),r===n||r!==a&&n!==a?r===i&&n===i?t.toLowerCase()>e.toLowerCase():e<t:n===a},y.sortCompare=function(t,e){var r,n,i,o,r=y,n=-1,i=H(t)||""===t||N(t)===a&&isNaN(t),o=H(e)||""===e||N(e)===a&&isNaN(e);return i&&o?n=0:i?n=1:o?n=-1:r.isEquals(t,e)?n=0:r.isGreaterThan(t,e)&&(n=1),n},P=y,e.xzt=P,D.prototype.inPreview=function(){return this.ezt},D.prototype.Izt=function(t,e){var r=this;r.data=t,r.columnNames=e,m(r)},D.prototype.vue=function(t){var e=this;e.mue&&0===e.lue&&(e.Nzt("onDataChanged",t),e.mue=!1)},D.prototype.gue=function(){this.lue++},D.prototype.pue=function(){var t=this;t.lue--,t.lue<=0&&(t.lue=0,t.vue())},D.prototype.onDataChanged=function(t){for(var e,r,n,i,o,a,u,s,f,y,c,f,c,y,m,M,h,d,e=this,r=new Array(x(e.columnNames)),n=e.Azt,i=e.vzt,o=e.uzt,a=e.dzt,s={},u=0;u<x(t);u++)y=(f=t[u]).data,c=f.columnName,f=f.row,H(s[c])&&(s[c]=e.getColumnIndex(c)),c=s[c],f>=e.data.length&&e.onRowsAdded(f,1,!1),y=v(e.data[f][c]=y)?y.text:y,a[c]&&(a[c][f]=y),r[c]=!0;for(m=0;m<x(r);m++)if(r[m]){for(M=n[m],n[m]=M?[]:void 0,o[m]=M?[]:void 0,h=[],u=0;M&&u<x(M);u++)h.push(i[m][M[u]]);for(p(e,m),u=0;u<x(h);u++)d=e.pzt[m][h[u]],n[m].push(d),o[m][d]=!0}g(e),e.mue=!0,e.vue(t)},D.prototype.Nzt=function(t){for(var e,r,n,i,o,e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(n=this.aT||[],i=0;i<x(n);i++)(o=n[i])[t]&&o[t].apply(o,e)},D.prototype.onColumnNameChanged=function(t,e){var r,n,i,r=this,n=r.hzt,i=r.getColumnIndex(t);i<0||(r.columnNames[i]=e,delete n[t.toUpperCase()],n[e.toUpperCase()]=i,r.Nzt("onColumnNameChanged",t,e))},D.prototype.onRowsAdded=function(t,e,r){var n,i,o,a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,b,_,w,D,H,N,k,n=this,i=x(n.columnNames),o=n.data,a=n.dzt,u=n.vzt,s=n.mzt,f=n.gzt,y=n.uzt,c=n.Azt,m=n.izt,M=n.rzt,h=n.Mct;for(n.bzt=[],d=0;d<e;d++)o.splice(t,0,new Array(i));for(l=0;l<i;l++){for(d=0;d<e;d++)a[l]&&a[l].splice(t,0,$);if(p=void 0,g=u[l]){for(F=S,b=0;b<x(g);b++){for(_=s[l][b],w=0;w<x(_);w++)_[w]>=t&&(_[w]+=e);P.isEquals(g[b],S)&&(F=_,p=b)}for(F||(F=[],g.push(S),p=x(g)-1,n.pzt[l][S]=p,s[l].push(F),y[l]&&-1===h.indexOf(l)&&(y[l][p]=!0,c[l].push(p))),D=t;D<t+e;D++)F.push(D);for(v=t;v<t+e;v++)f[l].splice(v,0,p)}}for(H=!0,d=0;d<x(h);d++)N=f[l=h[d]][t],!0!==y[l][N]&&(H=!1);for(d=0;d<x(M);d++)M[d]>=t&&(M[d]+=e);for(v=x(o)-1;t+e<=v;v--)m[v]=m[v-e];for(k=0<x(h),v=t;v<t+e;v++)H&&M.push(v),m[v]=!k;r||n.Nzt("onRowsChanged",t,e,!0)},D.prototype.onRowsRemoved=function(t,e){this.kzt(t,e,!0)},D.prototype.kzt=function(t,e,r){var n,i,o,a,u,s,f,y,c,m,M,h,d,l,v,n=this,i=n.Azt,o=n.vzt,a=n.uzt,u=n.data,s=x(n.columnNames),f=n.dzt;for(u.splice(t,e),c=0;c<s;c++){if(f[c]&&f[c].splice(t,e),M=[],(m=i[c])&&r){for(y=0;y<x(m);y++){for(h=n.getRowIndexes(n.columnNames[c],m[y]),d=!0,l=0;l<x(h);l++)if(h[l]<t||h[l]>=t+e){d=!1;break}d||M.push(o[c][m[y]])}i[c]=[],a[c]=[]}if(p(n,c),m&&r)for(y=0;y<x(M);y++)v=n.pzt[c][M[y]],i[c].push(v),a[c][v]=!0}r&&g(n),n.Nzt("onRowsChanged",t,e,!1)},D.prototype.onColumnsRemoved=function(t,e){for(var r,n,i,o,a,u,s,f,y,c,m,M,h,r=this,n=r.data,i=[],o=r.Mct,a=t+e,u=t;u<a;u++)(s=r.columnNames[u])&&(f=u,i.push(s),-1!==o.indexOf(f))&&r.doUnfilter(s);for(y=r.uzt||r.azt,c=r.Azt||r.Mzt,m=r.hzt,u=0;u<x(n);u++)n[u].splice(t,e);for(M in r.bzt=[],r.columnNames.splice(t,e),r.dzt.splice(t,e),r.vzt.splice(t,e),r.pzt.splice(t,e),r.mzt.splice(t,e),r.gzt.splice(t,e),y.splice(t,e),c.splice(t,e),m)m[M]>=t+e&&(m[M]-=e);for(u=0;u<x(i);u++)delete m[(s=i[u]).toUpperCase()],t=r.getColumnIndex(s),-1!==(h=o.indexOf(t))&&o.splice(h,1),r.Nzt("onColumnRemoved",i[u])},D.prototype.Dzt=function(){return this.bzt},D.prototype._zt=function(){return this.Szt},D.prototype.Czt=function(t){var e,r,n,i,o,a,a,u,s,f,y,c,m,e=this,r=e.data;for(e.dzt[t]||p(e,t),n=x(r),i=[],o=0;o<n;o++)a=v(a=r[o][t])?a.value:a,i.push(a);for(u=P.quickSort(i),s=e.bzt[t]=[],f=e.Szt[t]=[],y=e.yzt[t]=[],c=0;c<x(u);c++)m=u[c],s.push(m.value),f.push(m.index),y[m.index]=c},D.prototype.getColumnIndex=function(t){var t=this.hzt[null==t?void 0:t.toUpperCase()];return void 0===t?-1:t},D.prototype.getFilteredRowIndexes=function(){var t=this;return t.ezt?t.szt:t.rzt},D.prototype.getFilteredOutRowIndexes=function(){for(var t,e,r,n,i,t=this,e=x(t.data),r=t.ezt?t.ozt:t.izt,n=[],i=0;i<e;i++)r[i]||n.push(i);return n},D.prototype.getData=function(t,e){var r,n,i,o,t,t,e,a,u,s,r=this,n=r.dzt,i=r.getColumnIndex(t);if(0<=i){if(e){for(r.bzt[i]||r.Czt(i),o=n[i],t=r.bzt[i],e=(t=r.Tzt(t,e)).start,a=t.end,u=[],s=e;s<=a;s++)u.push(o[r.Szt[i][s]]);return u}return n[i]||p(r,i),n[i]}return[]},D.prototype.aggregateData=function(t,e,r){var n,t,i,r,t,o,r,o,n,t,i,n=this,t=n.getColumnIndex(t);return t<0?$:(n.bzt[t]||n.Czt(t),o=x(t=n.bzt[t]),i=(r=n.Tzt(t,r)).start,r=r.end,5===e?o<=i?$:t[i]:4===e?r<0?$:t[r]:3===e?r<i?0:r-i+1:(n=(o=n.Ezt(t,e,i,r)).data1,t=o.data2,i=o.data3,1===e?n/=t:7===e||10===e?(n=(i*t-n*n)/(i*(i-1)),n=7===e?Math.sqrt(n):n):8!==e&&11!==e||(n=(i*t-n*n)/(i*i),n=8===e?Math.sqrt(n):n),n))},D.prototype.Ezt=function(t,e,r,n){for(var i,o,a,u,s,f,i=6===e?1:0,o=0,a=0,u=r;u<=n;u++)(s=t[u])===S&&s===$||c(s,f={value:S})&&(s=f.value,1===e?(i+=s,o++):2===e?i++:9===e?i+=s:6===e?i*=s:7!==e&&8!==e&&10!==e&&11!==e||(i+=s,o+=s*s,a++));return{data1:i,data2:o,data3:a}},D.prototype.Tzt=function(t,e){var r=x(t),n,i,o,a;if(e){if(e.min===-1/0)n=0;else for(o=0;o<r;o++)if(a=t[o],P.isEquals(e.min,a)||P.isGreaterThan(a,e.min)){n=o;break}if(n===$&&(n=r),i===1/0)i=r-1;else{for(o=r-1;0<=o;o--)if(a=t[o],P.isEquals(a,e.max)||P.isGreaterThan(e.max,a)){i=o;break}i===$&&(i=-1)}}else n=0,i=r-1;return{start:n,end:i}},D.prototype.getExclusiveData=function(t){var e=this,r=e.vzt,t=e.getColumnIndex(t);return 0<=t?(r[t]||p(e,t),r[t]):[]},D.prototype.getRowIndexes=function(t,e){var r=this,t=r.getColumnIndex(t);return 0<=t?(r.gzt[t]||p(r,t),r.mzt[t][e]):[]},D.prototype.getExclusiveRowIndex=function(t,e){var r=this,t=r.getColumnIndex(t);return r.fue(t,e)},D.prototype.fue=function(t,e){var r=this,n=r.gzt;return 0<=t?(n[t]||p(r,t),n[t][e]):-1},D.prototype.getFilteredIndexes=function(t){var e=[],r;return this.jzt(t,e,{}),e},D.prototype.jzt=function(t,e,r){for(var n,i,o,a,u,u,n=this,i=n.ezt?n.szt:n.rzt,o=n.getColumnIndex(t),a=0;a<x(i);a++)u=i[a],H(u=n.fue(o,u))||(r[u]?r[u]++:(r[u]=1,e.push(u)))},D.prototype.getFilteredRanges=function(t){return M(this,t,!1)},D.prototype.getFilteredOutRanges=function(t){return M(this,t,!0)},D.prototype.getFilteredOutIndexes=function(t,e){var r=this;return(0===e?d:1===e?l:F)(r,t)},D.prototype.attachListener=function(t){-1===this.aT.indexOf(t)&&this.aT.push(t)},D.prototype.detachListener=function(t){for(var e,r,e=this.aT||[],r=0;r<x(e);r++)if(e[r]===t){e.splice(r,1);break}},D.prototype.suspendFilteredEvents=function(){this.Upt++},D.prototype.resumeFilteredEvents=function(){var t=this;t.Upt--,0===t.Upt&&t.onFiltered()},D.prototype.doFilter=function(t,e,r){this.Ozt(t,e,r),this.onFiltered()},D.prototype.Ozt=function(t,e,r){var n,i,o,n=this,i=n.Mct,o=n.getColumnIndex(t);o<0||(r?(n.ezt=!0,n.lzt=o):n.ezt&&w(n,!1),i.indexOf(o)<0&&i.push(o),e.ranges?b(n,t,e.ranges,r):_(n,t,e.exclusiveRowIndexes,r))},D.prototype.clearPreview=function(){w(this,!0)},D.prototype.doUnfilter=function(t){this.Rzt(t),this.onFiltered()},D.prototype.Rzt=function(t){var e,t,t,e=this;e.ezt&&w(e,!1),(t=e.getColumnIndex(t))<0||(delete e.Mzt[t],delete e.azt[t],delete e.uzt[t],delete e.Azt[t],g(e),0<=(t=e.Mct.indexOf(t))&&e.Mct.splice(t,1))},D.prototype.onFiltered=function(){var t=this;0===t.Upt&&t.Nzt("onFiltered",{rowIndexes:t.getFilteredRowIndexes(),isPreview:t.ezt})},D.prototype.getListener=function(){return this.aT},e.GeneralSlicerData=D},"./src/plugins/sparkline/sparkline.entry.ts":function(t,e,r){var n,i,n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);i&&("get"in i?e.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){t[n=void 0===n?r:n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r("./src/plugins/sparkline/sparkline.ts"),e)},"./src/plugins/sparkline/sparkline.ts":function(e,c,r){var n,i,m,M,nt,q,h,d,it,R,T,et,P,N,ot,at,rt,x,z,ut,K,j,st,ft,yt,ct,o,gt,mt,pt,Mt,k,V,J,Y,$,X,l,I,B,L,Z,Q,tt,C,Ft,bt,_t,wt,A,O,E,Dt,Ht,Nt,a,w,kt,$t,v,g,p,F,b,St,D,Pt,xt,Ct,At,Tt,Ot,jt,_,u,s,f;function Et(t){this.x=t.x,this.y=t.y}function Rt(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height}function H(t,e){return{x:t,y:e}}function It(t,e,r,n){return{x:t,y:e,width:r,height:n}}function Bt(t,e){for(var r,n,i,o,a,r=t[0],n=r&&r.value?r.value:r,o=1,a=t.length;o<a;o++)i=(r=t[o])&&r.value?r.value:r,(e&&i<n||!e&&n<i)&&(n=i);return n}function G(t,e,r,n,i,o,a){o&&(t.strokeStyle=o),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(e,r),t.lineTo(n,i),t.stroke()}function Lt(t,e,r,n,i,o,a){t.save(),o&&(t.strokeStyle=o),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(e,r),t.lineTo(n,i),t.closePath(),t.stroke(),t.restore()}function Gt(t,e,r,n,i,o,a,u){var s,f,y,c,m,M,h,d,l;if(t.save(),s=[o,a],t.setLineDash)t.beginPath(),t.strokeStyle=u,t.setLineDash(s),t.stroke(),t.moveTo(e,r),t.lineTo(n,i);else for(t.beginPath(),t.lineWidth=1,t.strokeStyle=u,c=(n-e)/(f=z(x(n-e,2)+x(i-r,2))),m=(i-r)/f,h=M=0;M<f;)M+=d=ot(s[h%2],f-M),(l=++h%2)&&t.moveTo(e,r),e+=d*c,r+=d*m,l&&t.lineTo(e,r);t.stroke(),t.restore()}function ht(t,e,r,n,i,o,a,u,s,f,y,c){e?G(t,r,n,i,o,y,c):G(t,a,u,s,f,y,c)}function S(t,e,r,n,i,o,a,u){t.save(),a&&(t.fillStyle=a),t.textBaseline=u||Q,t.beginPath(),t.font=i,t.textAlign=o,t.fillText(n="string"==typeof n?n:n+"",e,r),t.restore()}function W(t,e,r,n,i,o,a){e=Math.floor(e),r=Math.floor(r),n=Math.floor(n),i=Math.floor(i),a%2!=0&&(e===n?(e+=.5,n+=.5):r===i&&(r+=.5,i+=.5)),G(t,e,r,n,i,o,a)}function zt(t,e,r,n,i,o,a,u,s,f){var y,c,m,M;switch(o=Math.round(o),a=Math.round(a),s){case 0:a=Math.round(r+u),M=Math.round(a),m=Math.round(o+u),y=Math.round((o+m)/2),c=Math.round(a-Math.sin(et/3)*u);break;case 1:o=Math.round(e+n-u),m=Math.round(o),M=Math.round(a+u),y=Math.round(o+Math.sin(et/3)*u),c=Math.round((a+M)/2);break;case 2:a=Math.round(r+i-u),M=Math.round(a),m=Math.round(o+u),y=Math.round((o+m)/2),c=Math.round(a+Math.sin(et/3)*u);break;case 3:o=e+u,m=Math.round(o),M=Math.round(a+u),y=Math.round(o-Math.sin(et/3)*u),c=Math.round((a+M)/2)}t.beginPath(),t.moveTo(o,a),t.lineTo(y,c),t.lineTo(m,M),t.closePath(),t.fillStyle=f,t.fill()}function Kt(t,e,r,n,i){t.beginPath(),t.fillStyle=i,t.arc(e,r,n,0,2*Math.PI),t.fill()}function Jt(t,e,r,n,i,o){var e;e?Kt(t,r+(e=i/2),n+e,e,o):lt(t,r,n,i,i,o)}function Vt(t,e,r,n,i,o,a,u,s,f,y,c,m,M,h){var d,l,v,g,p,F;s?(d=Math.floor(e+.5*n),l=Math.floor(u?f-y:f),v=Math.floor(c),g=Math.floor(y),p=Math.floor(d-M/2),F=Math.floor(u?l-M/2:l+g+M/2),W(t,d,l,d,l+g,o,v)):(d=Math.floor(u?f:f-y),l=Math.floor(r+.5*i),v=Math.floor(y),g=Math.floor(c),p=Math.floor(u?d+v+M/2:d-M/2),F=Math.floor(l-M/2),W(t,d,l,d+v,l,o,g)),m?Wt(t,e,r,n,i,p,F,M,s,u,o):s?Jt(t,h,p,u?F:F-=M,M,a):Jt(t,h,u?p-=M:p,F,M,a)}function Wt(t,e,r,n,i,o,a,u,s,f,y){t.save(),zt(t,e,r,n,i,o,a,u,s?f?0:2:f?1:3,y),t.restore()}function Ut(t,e,r,n,i,o,a,u,s,f,y,c,m,M){var h,d,f,o,l,h=4,d=void 0;t.save(),t.beginPath(),t.rect(e,r,n,i),t.clip(),t.font=s+Ft,t.fillStyle=V,t.fillStyle="black",f?(t.textBaseline=Z,0<(d=s+(f=m<M?M:m)+o+4+M/2)?(t.textAlign=I,y?t.fillText(u,e+n/2+M/2,c-f/2):t.fillText(u,e+n/2+M/2,c+f/2)):(t.textAlign=L,y?t.fillText(u,e+n/2,c-f-M/2-s):t.fillText(u,e+n/2,c+f+M/2+4))):(t.textBaseline=tt,0<(d=(o=t.measureText(u).width)+m+a+4+M/2)?m+M/2<o?y?(t.textAlign=B,t.fillText(u,c-4,r+i/2)):(t.textAlign=I,t.fillText(u,c+M/2,r+i/2)):(t.textAlign=L,y?t.fillText(u,c+m/2,r+i/2+s):t.fillText(u,c-m/2,r+i/2+s)):y?(t.textAlign=I,t.fillText(u,l=c+m+M/2+4,r+i/2)):(t.textAlign=B,t.fillText(u,l=c-m-M/2-4,r+i/2))),t.restore()}function qt(t){return m.ft.rp(h(t))<127.5?k:V}function dt(t,e,r,n,i,o,a,u){var s,f,y,c,u,s=u;return nt(u)&&(s=i),u=a?(f=e+s+o,c=n-2*s,y=t+i,r-2*i):(f=t+s,c=r-2*s,y=e+i,n-2*i),{left:f,top:y,width:c,height:u}}function Yt(t,e){for(var r,n,i,r=0,n=0,i=t.length;n<i;n++)r+=e&&!e(t[n])?0:t[n];return r}function Xt(t){return t*et/180}function Zt(t,e,r,n){for(var i,o,a,u,s,i=[],a=0,u=0,s=t.length;a<s;a++)e?(e(t[a])?i[u]=r?r(t[a]):t[a]:i[u]=0,u++):(o=yt(t[a]),!ft(o)&&isFinite(o)&&(i[u]=o,u++));return n&&n(i),i}function lt(t,e,r,n,i,o){var a=rt(e+n),u=rt(r+i);e=rt(e),r=rt(r),n=rt(a-e),i=rt(u-r),t.beginPath(),t.fillStyle=o,t.fillRect(e,r,n,i),t.fill()}function Qt(t,e,r){return t=ot(t,e),t=at(t,r)}function vt(t,e,r,n,i){t.save(),t.rect(e,r,n,i),t.clip()}function te(t,e){var r,n,i,o;return t&&e&&(r=at(t.x+t.width,e.x+e.width),n=at(t.y+t.height,e.y+e.height),i=ot(t.x,e.x),o=ot(t.y,e.y),r-i<=t.width+e.width)&&n-o<=t.height+e.height}function ee(t,e,r,n,i,o){var a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,a=r+i/2,u=n+o/2,s=5,f=ot(i,o)/2-5,y=-.5*et,m=a+f*N(y),M=u+f*P(y),h=[],d=[];if(!(f<=0)){for(g=re(v=(l=Zt(e.values,function(t){return!nt(t)&&!ft(t)&&isFinite(t)},function(t){return ut(t)},function(t){1===t.length&&(t[1]=1-t[0])})).length,e.colors),p=Yt(l),t.save(),F=0;F<v;F++)c=y+l[F]/p*2*et,t.beginPath(),t.moveTo(a,u),t.lineTo(m,M),t.arc(a,u,f,y,c,!1),t.lineTo(a,u),t.fillStyle=g[F],t.fill(),h.push(m),d.push(M),m=a+f*N(y=c),M=u+f*P(y);for(F=0;F<v;F++)G(t,a,u,h[F],d[F],k);t.restore()}}function re(t,e){var r,n,i,o,a,u,s,f,r=[],n=e.length;if(t<=n)r=e.slice(0,t);else{for(0===n?(r.push("darkgray"),n=1):r=e.slice(0),i=[],a=t-n+1,u=o=void 0,u=0;u<n;u++)i[u]=h(r[u]);for(u=n;u<t;u++){for(s in o=i[u%n])o.hasOwnProperty(s)&&(f=o[s],o[s]=T(f-f/a*(u/n)));o.a=255,r[u]=m.ft.j(o)}}return r}function ne(t){var e=f.call(this,H(t.x,t.y))||this;return e.value=t.value,e}function ie(t,e,r){return{x:t,y:e,value:r}}function oe(t){return isNaN(t)||t===1/0?0:t}function ae(r,t,e,n,i,o){var a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,b,_,w,t,s,t,D,H,N,k,$,S,P,x,C,A,T;if(r.save(),a=t.points,u=t.mini,s=t.maxi,f=t.line1,y=t.line2,c=t.colorPositive,m=t.colorNegative,M=5,a=Zt(a,function(t){return!nt(t)&&!ft(t)&&isFinite(t)}),c=nt(c)?"#787878":c,m=nt(m)?mt:m,t=Bt(a,!1),s=nt(s)?t:s,d=at(s,t),s=Bt(a,!0),u=nt(u)?s:u,h=ot(u,s),l=(l=(d=d<0?0:d)<(l=0)?d:0)<(h=0<h?0:h)?h-1:l,v=a.length,t=dt(e,n,i,o,5),g=t.left,p=t.top,F=t.width,b=t.height,_=oe(F/(v-1)),D=[],w=oe((d-h)/b))for($=k=void 0,S=p+oe((d-l)/w),x=P=void 0,C=0;C<v;C++)k=a[C],P=g+_*C,x=p+oe((d-k)/w),0===C&&D.push(new xt(ie(P,S,l))),0<C&&k*a[C-1]<0&&(N=D[D.length-1])&&($=ue(N.x,N.y,P,x,S),D.push(new xt(ie($,S,l)))),D.push(new xt(ie(P,x,k))),C===v-1&&D.push(new xt(ie(P,S,l)));for(r.beginPath(),A=0,T=D.length;A<T;A++)(H=D[A])&&(0===A?r.moveTo(H.x,H.y):r.lineTo(H.x,H.y),N=D[A-1],H.value===l)&&N&&(r.fillStyle=N.value>l?c:m,r.fill(),A!==T-1)&&(r.beginPath(),r.moveTo(H.x,H.y));function O(t){var t,e,t;t===it&&typeof t!==j||(t=Qt(t,d,h),t=rt(p+(e=0!==w?(d-t)/w:b/2))-.5,G(r,g,t,g+F,t,J))}O(f),O(y),r.restore()}function ue(t,e,r,n,i){return((e-i)*r+(i-n)*t)/(e-n)}function se(i,t,e,j,E,R){var r,n,I,B,L,G,o,a,u,s,f,y,z,c,K,m,M,J,V,h,d,l,v,g,p,F,b,_,W,U,q,b,w,D,H,N,k,$,S,P,x,t,C,A,T,O,t,r,n,e,r=t.points1,n=t.points2,I=t.minX,B=t.maxX,L=t.minY,G=t.maxY,o=t.hLine,a=t.vLine,u=t.xMinZone,s=t.xMaxZone,f=t.yMinZone,y=t.yMaxZone,z=t.tags,c=t.drawSymbol,K=t.drawLines,m=t.color1,M=t.color2,J=t.dash,V=4,t=dt(e,j,E,R,5),C=t.left,A=t.top,T=t.width,O=t.height;if(r&&!(r.length<=0)&&!((h=me(r)).length<=0||n&&0<n.length&&(d=me(n)).length<=0)){for(vt(i,e,j,E,R),i.beginPath(),c=!!nt(c)||c,m=nt(m)?gt:m,M=nt(M)?mt:M,X(h,L,G,I,B),!nt(u)&&!nt(s)&&!nt(f)&&!nt(y)&&g<=u&&u<=p&&g<=s&&s<=p&&l<=f&&f<=v&&l<=y&&y<=v&&(t=at(g,u),r=ot(p,s),n=at(l,f),e=ot(v,y),lt(i,C+(t-g)*T/(p-g),A+(v-(e=e<=n?n+1:e))*O/(v-l),((r=r<=t?t+1:r)-t)*T/(p-g),(e-n)*O/(v-l),Mt)),$=k=-ct,P=S=ct,_=h.length,F=0;F<_-1;F++)Y(h,F,m,Q),z&&(0===F&&($<D&&(k=w,$=D),D<P)&&(S=w,P=D),$<N&&(k=H,$=N),N<P)&&(S=H,P=N);if(d&&0<d.length)for(X(d,l,v,g,p),_=d.length,F=0;F<_-1;F++)Y(d,F,M,tt);z&&(Z(k,$,mt),Z(S,P,"#0000FF")),!nt(o)&&l<=o&&o<=v&&(x=rt(A+(v-o)*O/(v-l))-.5,ce(i,C,x,C+T,x,mt)),!nt(a)&&g<=a&&a<=p&&(x=rt(C+(a-g)*T/(p-g))-.5,ce(i,x,A,x,A+O,mt)),i.restore()}function Y(t,e,r,n){b=t[e],W=b.x,U=b.y,b=t[e+1],q=b.x,b=b.y,w=C+(W-g)*T/(p-g),H=C+(q-g)*T/(p-g),D=A+(v-U)*O/(v-l),N=A+(v-b)*O/(v-l),K&&ce(i,w,D,H,N,r,J),c&&(0===e&&n(w,D),n(H,N))}function X(t,e,r,n,i){var o,t,o=fe(t,!0),t=fe(t,!1);l=nt(L)?o.y:e,v=nt(G)?t.y:r,g=nt(I)?o.x:n,p=(p=nt(B)?t.x:i)<=g?g+1:p,v=v<=l?l+1:v}function Z(t,e,r){i.beginPath(),i.arc(t-2,e-2,2,0,2*et,!1),i.fillStyle=r,i.fill()}function Q(t,e){i.beginPath(),i.strokeStyle=m,i.arc(t-2,e-2,2,0,2*et,!1),i.stroke()}function tt(t,e){i.beginPath(),i.strokeStyle=M,i.strokeRect(t-2,e-2,4,4)}}function fe(t,e){for(var r,n,i,o,a,u,r=e?1:-1,n=e?ot:at,i=new D(H(r*ct,r*ct)),o=t.length,u=0;u<o;u++)a=t[u],i.x=n(i.x,a.x),i.y=n(i.y,a.y);return i}function ye(t,e,r,n){return r/n*(e-t)+t}function ce(t,e,r,n,i,o,a){var u,s,f,y,c,m,M,h,d,l,v,g,p,F,b,_,w;if(a){for(u=z(x(n-e,2)+x(i-r,2)),f=6,y=2,c=4,l=d=h=M=void(s=0),l=e<=n?(h=n,d=M=e,r):(h=e,d=M=n,i),g=r-(v=(i-r)/(n-e))*e,(m=[]).push(new D(H(d,l))),p=[6,4,2,4];s<u;)for(F=0,b=p.length;F<b;F++)(s+=p[F])<=u&&(d=ye(M,h,s,u),m.push(new D(H(d,l=v*d+g))));for(_=0,w=m.length;_<w-1;_+=2)G(t,m[_].x,m[_].y,m[_+1].x,m[_+1].y,o)}else G(t,e,r,n,i,o)}function me(t){var e,r,n,i,o,e=[],r=t.length;if(0<r)if(r<(n=t[0].length)){if(2<=r)for(i=0;i<n;i++)e.push(new D(H(t[0][i],t[1][i])))}else if(2<=n)for(o=0;o<r;o++)e.push(new D(H(t[o][0],t[o][1])));return e}function Me(a,t,u,s,f,y){var e,r,n,i,o,c,m,M,h,d,l,v,g,p,F,b,_,t,l,w,D,H,w,N,k,g,$,S,n,p,i,M,P,x,C,e=t.measure,r=t.target,n=t.maxi,i=t.good,o=t.bad,c=t.forecast,m=t.tickUnit,M=t.colorScheme,h=t.vertical,d=5,l=t.measureColor,v=t.targetColor,g=t.maxiColor,p=t.goodColor,F=t.badColor,b=t.forecastColor,_=t.allowMeasureOverMaxi,t=t.barSize;if(!(nt(n)||n<0)&&(nt(t)||!(ft(t)||t<=0))){if(1<t&&(t=1),e=nt(e)||e<0?0:e,i=nt(i)||i<0?0:i,o=nt(o)||o<0?0:o,r=nt(r)?0:r,c=nt(c)?0:c,m=nt(m)?0:m,M=nt(M)?"#A0A0A0":M,l=nt(l)?"#252525":l,n<e&&!_&&(e=n,l=mt),n<i&&(i=n,l=mt),n<o&&(o=n,l=mt),n<r&&(r=0,l=mt),n<c&&(c=n,l=mt),w=dt(u,s,f,y,5,y-10,h),D=w.left,H=w.width,a.save(),w=nt(t)?.2:(1-t)/2,N=nt(t)?.6:t,k=_?at(n,e):n,A(nt(g)?q(M,1.66):g,n,k,w,N),A(nt(p)?q(M,1.33):p,i,k,w,N),A(nt(F)?M:F,o,k,w,N),g=.25*t/.6,A(l,e,k,$=nt(t)?.375:(1-g)/2,S=nt(t)?.25:g),0<c&&(n=D,H<(p=H*(c/k))&&(p=H),i=nt(t)?3:3*t/.6,ht(a,h,u+.5*f,n,u+.5*f,n-p,n,s+.5*y,n+p,s+.5*y,nt(b)?"#3690BF":b,i)),0<r&&(M=rt(D-(h?1:-1)*H*(r/k))-.5,ht(a,h,u+f*w,M,u+f*(1-w),M,M,s+y*w,M,s+y*(1-w),nt(v)?mt:v,1)),0<m)for(P=T(k/m),x=void 0,C=0;C<=P;C++)x=rt(D-H/k*m*(h?1:-1)*C)-.5,ht(a,h,u,x,u+.05*f,x,x,s+y,x,s+.95*y,pt,1);a.restore()}function A(t,e,r,n,i){var o,t,e;a.fillStyle=t,H<(t=H*(e/r))&&!_&&(t=H),e=new Pt(h?It(u+f*n,D-t,f*i,t):It(D,s+y*n,t,y*i)),a.fillRect(e.x,e.y,e.width,e.height)}}function he(t,e,r,n,i,o){var a,u,s,f,y,c,m,M,e,h,e,h,d,l,v,g,p,F,b,_,w,D,H,N,k,N,$,S,P,x,C,a=e.spreadData,u=e.showAverage,s=e.scaleStart,f=e.scaleEnd,y=e.style,c=e.colorScheme,m=e.vertical,M=5,e=a.length;if(!(e<=0)){for(h=a[0].key,e=a[e-1].key,s=nt(s)?h:s,f=nt(f)?e:f,y=nt(y)?4:y,c=nt(c)?pt:c,d=(h=dt(r,n,i,o,5,o-10,m)).left,l=h.width,v=h.top,g=h.height,vt(t,r,n,i,o),t.beginPath(),t.strokeStyle=c,t.fillStyle=c,b=Bt(a,!(t.lineWidth=2)),w=0,D=a.length;w<D;w++)if(N=(H=a[w]).key,k=H.value,p=d+(m?-1:1)*l*(N-s)/(f-s),p=m?(p=ot(p,d),at(p,d-l)):(p=at(p,d),ot(p,d+l)),p=rt(p),1===y)ht(t,m,N=v+g/2-(_=(_=k/2*g/b)<.5?.5:_),p,$=v+g/2+_,p,p,N,p,$);else if(4===y)ht(t,m,v,p,v+(_=(_=k*g/b)<1?1:_),p,p,v+g,p,v+g-_);else if(6===y)ht(t,m,v,p,v+g,p,p,v,p,v+g);else for(S=2,P=1;P<=k;P++){switch(y){case 2:F=v+g/2-5-(k/2-P)*g/b;break;case 3:F=v+g-5-(x=de(k,g,3,H.randomNumbers))[P-1];break;default:F=v+g-P*g/b}F=rt(F),t.beginPath(),t.fillRect(m?F:p,m?p:F,2,2)}u&&ht(t,m,v-5,p=d-(m?1:-1)*l*((C=le(a))-s)/(f-s),v+g+5,p,p,v-5,p,v+g+5,mt),t.restore()}}function de(t,e,r,n){for(var i,o,a,u,s,f,i=[],o=at(100,10*t),a=0,u=[],s=0;i.length<t;)f=T(n[s]*e),s++,(o<a||ve(f,u))&&(i.push(f),u.push([f-r,f+r])),a++;return i}function le(t){for(var e,r,n,i,o,e=0,r=0,n=0,i=t.length;n<i;n++)r+=(o=t[n]).value,e+=o.key*o.value;return 0===r?0:e/r}function ve(t,e){for(var r,n,i,r=0,n=e.length;r<n;r++)if((i=e[r])[0]<=t&&t<=i[1])return;return 1}function ge(i,t,e,r,n,o,a){var u,s,f,y,c,m,M,h,d,l,j,v,g,p,E,F,t,t,b,_,w,D,H,N,k,$,S,P,N,x,C,A,T,u=t.points,s=u&&u.length,f=t.colorRange,y=t.labelRange,c=t.maximum,m=t.targetRed,M=t.targetGreen,h=t.targetBlue,d=t.targetYellow,l=t.color,j=t.highlightPosition,v=t.vertical,g=t.textOrientation,p=t.textSize,E=5;if(!(nt(u)||s<=0)){if(l=nt(l)?pt:l,nt(f)||f.length!==s||pe(f))for(f=[],F=0;F<s;F++)f.push(q(l,1+F/s));for(t=Yt(u,function(t){return 0<t}),c=nt(c)||c<t?t:c,g=nt(g)?0:g,p=nt(p)||p<=0?10:p,p=ft(p)?p:p*a.zoomFactor,t=dt(e,r,n,o,5,o-10,v),b=t.left,_=t.width,w=t.top,D=t.height,i.save(),H=b,x=0,C=s;x<C;x++)(N=u[x])<=0||(N=N/c*_,P=v?(k=e+.15*n,S=.7*n,$=H-N,N):(k=H,S=N,$=r+.15*o,.7*o),A=x+1===j?mt:f[x],i.save(),i.fillStyle=A,i.fillRect(k,$,S,P),(T=y&&y[x])&&(i.save(),i.fillStyle=qt(A),i.textBaseline=tt,i.textAlign=L,i.font=p+Ft,i.rect(k,$,S,P),i.clip(),1===g?(i.translate(k+S/2,$),i.rotate(Math.PI/2),i.fillText(T,P/2,0)):i.fillText(T,k+S/2,$+P/2),i.restore()),H+=(v?-1:1)*N,i.restore());O(X,m,function(t){return 0<t}),O(Y,M),O(J,h),O("yellow",d),i.restore()}function O(t,e,r){var n,r;e!==it&&e!==R&&(e=c<e?c:e,!r||r(e))&&(r=(e=e<0?0:e)/c*_,v?(n=rt(b-r)-.5,G(i,w,n,w+D,n,t)):(n=rt(b+r)-.5,G(i,n,w,n,w+D,t)))}}function pe(t){for(var e=0,r=t.length;e<r;e++)if(nt(t[e]))return 1}function Fe(t,e,r,n,i,o){G(t,y(e),y(r),y(n),y(i),nt(o)?V:o,1)}function be(r,n,i,t,e){var t,o,a,u,s,f,t=.4*t;switch(n=y(n),i=y(i),r.beginPath(),r.moveTo(n,i),o=t/2,a=z(3)*t/2,u=t/z(3),e){case 0:s=[-o,0,o],f=[a,u,a];break;case 2:s=[-o,0,o],f=[-a,-u,-a];break;case 3:s=[a,u,a],f=[-o,0,o];break;case 1:s=[-a,-u,-a],f=[-o,0,o];break;default:s=[],f=[]}s.forEach(function(t,e){r.lineTo(y(n+t),y(i+f[e]))}),r.lineTo(n,i),r.closePath(),r.fillStyle=k,r.fill()}function _e(t,e,r,n,i,o,a){var u,s,f,y,r,c,m,M,h,d,l,v,g,p,u,y,F,r,g,r,r,t,b,u=r.value,s=r.colorScheme,f=r.axisVisible,y=r.barHeight,r=r.barWidth,c=5,m=5,M=!1,u=yt(u);if(!ft(u)){if(nt(y=0===t?y:r))F=.7;else{if(ft(y)||y<=0)return;F=Math.min(1,y)}1<u?(u=1,M=!0):u<-1&&(u=-1,M=!0),s=nt(s)?"grey":s,f=!!nt(f)||f,e.save(),0===t?(r=o-10,g=a*F,g=0<=u?(M&&(h=new D(H(n+5+r-5,i+a/2))),d=new Pt(It(n+5,i+a*(1-F)/2,r*u,g)),l=new D(H(n+5,i+1)),v=new D(H(n+5,i+a)),1):(r=ut(r*u),M&&(h=new D(H(n+5+5,i+a/2))),d=new Pt(It(n+o-5-r,i+a*(1-F)/2,r,g)),l=new D(H(n+o-5,i+1)),v=new D(H(n+o-5,i+a)),3),p=nt(y)?a:a*F):1===t&&(r=a-10,t=o*F,v=0<=u?(d=new Pt(It(n+(1-F)/2*o,i+a-5-(b=r*u),t,b)),M&&(h=new D(H(n+o/2,i+a-5-b+5)),g=0),l=new D(H(n+1,i+a-5)),new D(H(n+o,i+a-5))):(u=ut(u),d=new Pt(It(n+(1-F)/2*o,i+5,t,r*u)),M&&(h=new D(H(n+o/2,i+5+r-5)),g=2),l=new D(H(n+1,i+5)),new D(H(n+o,i+5))),p=nt(y)?o:o*F),e.beginPath(),d&&(lt(e,d.x,d.y,d.width,d.height,s),vt(e,d.x,d.y,d.width,d.height)),h&&be(e,h.x,h.y,p,g),e.restore(),f&&l&&Fe(e,l.x,l.y,v.x,v.y),e.restore()}}function y(t){return rt(t)-.5}function we(t,e,r,n,i,o){_e(0,t,e,r,n,i,o)}function De(t,e,r,n,i,o){_e(1,t,e,r,n,i,o)}function He(p,t,F,b,_,w,e){var r,n,i,o,a,u,D,s,f,H,N,y,c,m,k,$,r,j,E,S,R,M,h,P,e,t,d,d,d,t,x,C,c,c,l,v,g,s,r=t.variance,n=t.reference,i=t.mini,o=t.maxi,a=t.mark,u=t.tickUnit,D=t.legend,s=t.colorPositive,f=t.colorNegative,H=t.vertical,j=.5,E=.25,R=5,M=mt,h=gt,P=13*e.zoomFactor,e=yt(r);if(!(ft(e)||(f=nt(f)?X:f,s=nt(s)?Y:s,u=nt(u)?0:u,o=nt(o)?1:o,i=nt(i)?-1:i,(r=!nt(n))||(n=0),m=H?(N=b+w-5,y=w-10,c=_-20,-1):(N=F+5,y=_-10,c=w-20,1),D&&(t=yt(t.variance),ft(t)||(d=(d=t.toString()).substr(d.indexOf(".")+1).length,k=2<=d?(100*t).toFixed(d-2)+"%":(100*t).toFixed(0)+"%")),o<e&&(e=o,S=!0),e<i&&(e=i,S=!0),n=Qt(n,o,i),S&&($=Qt(c,60,15)),t=y/(d=ut(o-i)),x=N+m*ut(i-n)*t,(C=ut(e-n)*t)>ut(d)*t&&(C=ut(d+i)*t),c=N+m*y,H&&x<c)||!H&&c<x)){if(vt(p,F,b,_,w),n<e?A(s,0,5-y,y-5,0,1,b-x,Q,Z,x-F-_,I,B,-1,ut(o-e)*t):(C>ut(d)*t&&(C=ut(d+i)*t,x=N),A(f,1,-5,5,2,3,x-b-w,Z,Q,F-x,B,I,1,ut(i-e)*t)),r&&(c=N+m*(Math.abs(i-n)*t),O(F,c,F+_,c,c,b,c,b+w)),0<u)for(p.beginPath(),l=d/u,v=0;v<=l;v++)O(F,g=N+y/l*v*m,F+.1*_,g,g,b+.9*w,g,b+w,h,h);!nt(a)&&i<=a&&a<=o&&(p.beginPath(),s=N-(H?1:-1)*ut(i-a)*t,O(F,s,F+.33*_,s,s,b+.66*w,s,b+w,M,M),p.fill()),p.restore()}function A(t,e,r,n,i,o,a,u,s,f,y,c,m,M){var h,d,l,v,g,e;H?lt(p,h=F+.25*_,d=0===e?x-C:x,l=.5*_,v=C,t):lt(p,h=0===e?x:x-C,d=b+.25*w,l=C,v=.5*w,t),S&&(vt(p,h,d,l,v),H?be(p,F+_/2,N+r,$,i):be(p,N+n,b+w/2,$,o),p.restore()),D&&(g=void 0,e=0,S&&(e=.4*$*z(3)/2+5+2),p.save(),p.beginPath(),p.font=P+Ft,p.fillStyle=V,H?(p.textAlign=L,T(g=P+C+a,M,t,u,s,h,d,l,v,H),p.fillText(k,F+_/2,x+m*(C-e))):(p.textBaseline=tt,T(g=p.measureText(k).width+C+f,M,t,y,c,h,d,l,v,H),p.fillText(k,x+m*(e-C),b+w/2)),p.restore())}function T(t,e,r,n,i,o,a,u,s,f){f?p.textBaseline=n:p.textAlign=n,0<t&&e<C&&(p.rect(o,a,u,s),p.clip(),f?p.textBaseline=i:p.textAlign=i,p.fillStyle=qt(r))}function O(t,e,r,n,i,o,a,u,s,f){H?Fe(p,t,e,r,n,s):Fe(p,i,o,a,u,f)}}function Ne(t,e,r,n,i,o,j){var a,u,s,f,y,c,m,M,E,h,d,l,e,v,g,p,F,R,b,I,p,g,_,w,B,L,G,D,z,H,K,N,k,J,w,$,S,k,N,P,x,C,A,T,O,a=e.plannedValue,u=e.actualValue,s=e.index,f=e.absolute,y=e.reference,c=e.mini,m=e.maxi,M=e.tickUnit,E=e.legend,h=e.colorPositive,d=e.colorNegative,l=e.lollipopHeaderColor,e=e.vertical,I=[],w="",B=.9,L=10,G=13*j.zoomFactor,D=Mt,z=!1;if(!(0===a.length||0===u.length||s<0||s>=a.length||s>=u.length||m<=c||ft(u[s])||ft(a[s]))){if(d=nt(d)?X:d,h=nt(h)?Y:h,M=nt(M)?0:M,f=!nt(f)&&f,R=!nt(y),l=nt(l)?V:l,f){for(H=0;H<a.length&&H<u.length;H++)I.push(u[H]-a[H]);m=Bt(I,!1),c=Bt(I,!0),0<m&&0<c?c=0:m<0&&c<0&&(m=0),b=I[s],R=!(y=0)}else m=nt(m)?1:m,c=nt(c)?-1:c,b=(u[s]-a[s])/Math.abs(a[s]),((y=Qt(y,m,c))===m&&y<b||y===c&&b<y)&&(z=!0),nt(a[s])&&(z=!0);if(R||(y=0),p=e?(v=n+o-10,g=o-20,-1):(v=r+10,g=i-20,1),!f&&E?(0<(N=yt((K=b-y).toString()))&&(w="+"),!ft(N)&&isFinite(N)?F=w+(F=2<=(J=(k=N.toString()).substr(k.indexOf(".")+1).length)?(100*N).toFixed(2)+"%":100*N+"%"):isFinite(N)||(F=w+N)):F=(w=0<b?"+":w)+(F=2<=(J=(k=(N=yt(b)).toString()).substr(k.indexOf(".")+1).length)?N.toFixed(2):N),f?_=!1:(m<b&&(b=m,_=!0),b<c&&(b=c,_=!0)),$=g/(w=ut(m-c)),S=v+p*ut(c-y)*$,(k=ut(b-y)*$*.9)>ut(w)*$&&(k=ut(w+c)*$),N=v+p*g,!(e&&S<N||!e&&N<S))if(f||0!==a[s]&&!z){if(vt(t,r,n,i,o),P=ut(Math.ceil((m-y)/M)),x=ut(Math.floor((y-c)/M)),f){if(5/$<M)if(e){for(A=1;A<=P;A++)W(t,r,T=S+M*$*A*-1*.9,r+i,T,D,1);for(A=1;A<=x;A++)W(t,r,T=S+M*$*A*1*.9,r+i,T,D,1)}else{for(A=1;A<=P;A++)W(t,O=S+M*$*A*1*.9,n,O,n+o,D,1);for(A=1;A<=x;A++)W(t,O=S+M*$*A*-1*.9,n,O,n+o,D,1)}}else if(0<M&&M<=m&&5/$<M)if(t.beginPath(),e){for(C=10<.1*i?10:.1*i,A=1;A<=P;A++)W(t,r,T=S+M*$*A*-1*.9,r+C,T,D,1);for(A=1;A<=x;A++)W(t,r,T=S+M*$*A*1*.9,r+C,T,D,1)}else{for(C=10<.1*o?10:.1*o,A=1;A<=P;A++)W(t,O=S+M*$*A*1*.9,n+o-C,O,n+o,D,1);for(A=1;A<=x;A++)W(t,O=S+M*$*A*-1*.9,n+o-C,O,n+o,D,1)}p=Math.floor(12*j.zoomFactor),(g=Math.floor(4*j.zoomFactor))%2!=0&&(g+=1),p%2!=0&&(p+=1),y<b?Vt(t,r,n,i,o,h,l,!0,e,S,k,g,_,p,f):(k>ut(w)*$&&(k=ut(w+c)*$,S=v),Vt(t,r,n,i,o,d,l,!1,e,S,k,g,_,p,f)),E&&(y<b?Ut(t,r,n,i,o,n-S,S-r-i,F,G,e,!0,S,k,p):Ut(t,r,n,i,o,S-n-o,r-S,F,G,e,!1,S,k,p)),R&&(e?W(t,r,S,r+i,S,V,2):W(t,S,n,S,n+o,V,2)),t.restore()}else e?W(t,r,S,r+i,S,V,2):W(t,S,n,S,n+o,V,2)}}function ke(f,t,j,E,R,e){var r,n,I,i,o,a,u,s,y,c,B,m,M,h,d,i,o,a,u,l,v,g,p,F,L,j,E,R,e,G,b,_,w,z,K,J,V,D,H,N,k,$,S,P,W,U,x,C,x,C,x,q,i,o,u,Y,X,Z,A,i,o,T,O,Q,u,t,t,tt,r=t.points,n=t.boxPlotClass,I=t.showAverage,i=t.scaleStart,o=t.scaleEnd,a=t.acceptableStart,u=t.acceptableEnd,s=t.style,y=t.colorScheme,c=t.vertical,B=5,m=Bt(r,!1),M=Bt(r,!0);if(!(nt(r)||(r=Zt(r)).length<=0)){for((n=n===it||typeof n!==st?At:n.toLocaleLowerCase())!==At&&n!==Ct&&n!==Tt&&n!==Ot&&n!==jt&&(n=At),h=yt(i),h=ft(h)?M:h,d=yt(o),d=ft(d)?m:d,i=yt(a),o=yt(u),y!==it&&typeof y===st||(y="#D2D2D2"),(s===it||0!==s&&1!==s)&&(s=0),a=mt,M<h&&(y=a,h=M),d<m&&(y=a,d=m),vt(f,j,E,R,e),f.lineWidth=2,l=(u=dt(j,E,R,e,5,e-10,c)).left,v=u.width,g=u.top,p=u.height,F=c?-1:1,L=t.perc02,j=t.perc09,E=t.perc10,R=t.perc90,e=t.perc91,G=t.perc98,b=t.q1,z=M,K=m,V=J=1.5*(w=(_=t.q3)-b),D=t.stDev,H=Yt(r)/at(1,r.length),k=N=0,$=g+.1*p,S=.7*p,P=ut(d-h),W=0,U=r.length;W<U;W++)(x=r[W])<b&&b-1.5*w<=x&&x-(b-1.5*w)<J&&(J=x-(b-1.5*w),z=x),_<x&&x<=_+1.5*w&&_+1.5*w-x<V&&(V=_+1.5*w-x,K=x),C=!1,N=l+v*((x-h)/P)*F,n===Tt&&(x<=b-1.5*w||_+1.5*w<=x)&&(C=!0,k=x<=b-3*w||_+3*w<=x?0:1),n===Ct&&(x<=L||G<=x)&&(C=!0,k=1),n===jt&&(x<=H-2*D||H+2*D<=x)&&(C=!0,k=x<=H-3*D||H+3*D<=x?0:1),x=gt,C&&(1===s?1===k?rt(.2,.8,N,x):rt(.3,.7,N,x):((C=.1*p)<2&&(C=2),f.beginPath(),f.strokeStyle=x,x=g+.45*p,q=N,f.arc(c?x:q,c?q:x,C/2,0,2*Math.PI),f.stroke()));switch((i<h||d<o)&&(y="#C0FF00"),i=at(h,i),(o=ot(d,o))<i?y=a:i<o&&ht(f,c,u=g+.9*p,i=l+v*((i-h)/P)*F,u,o=l+v*((o-h)/P)*F,i,u,o,u,pt),X=ut(l+v*((_-h)/P)*F-(Y=l+v*((b-h)/P)*F)),A=l+v*(((Z=t.median)-h)/P)*F,n){case Ct:T=L,O=G;break;case Tt:T=z,O=K;break;case jt:X=ut(l+v*((H+D-h)/P)*F-(Y=l+v*((H-D-h)/P)*F)),A=l+v*((H-h)/P)*F,T=h<(Q=H-2*D)?Q:M,O=(Q=H+2*D)<d?Q:m,I=!1;break;default:T=M,O=m}i=l+v*((T-h)/P)*F,o=l+v*((O-h)/P)*F,u=gt,1===s?et("#F2F2F2",$,o,S,i-o,i,$,o-i,S):ht(f,c,t=g+.45*p,i,t,o,i,t,o,t,u),et(y,$,Y-X,S,X,Y,$,X,S),ht(f,c,$,A,$+S,A,A,$,A,$+S,u),0===s&&(ht(f,c,$+.3*S,o,$+.7*S,o,o,$+.3*S,o,$+.7*S,u),ht(f,c,$+.3*S,i,$+.7*S,i,i,$+.3*S,i,$+.7*S,u)),n!==Ct&&n!==Ot||(tt=t=void 0,O=n===Ct?(T=j,e):(T=E,R),t=l+v*((T-h)/P)*F,rt(.3,.7,tt=l+v*((O-h)/P)*F,u),rt(.3,.7,t,u)),I&&rt(.2,.8,N=l+v*((H-h)/P)*F,a),f.restore()}function et(t,e,r,n,i,o,a,u,s){c?lt(f,e,r,n,i,t):lt(f,o,a,u,s,t)}function rt(t,e,r,n){ht(f,c,$+S*t,r,$+S*e,r,r,$+S*t,r,$+S*e,n)}}function $e(t,e,r,n,i){e=rt(e),r=rt(r),e===(n=rt(n))&&(e=n-=.5),r===(i=rt(i))&&(r=i-=.5),t.moveTo(e,r),t.lineTo(n,i)}function U(t,e,r,n,i,o,a,u,s,f,y){t.beginPath(),t.strokeStyle=r,e?$e(t,n,i,o,a):$e(t,u,s,f,y),t.stroke()}function Se(t,e,r,n,i){t.rect(e,r,n,i),t.clip()}function Pe(t,e,r,n,i,o){var a,u,s,f,y,c,m,M,h,d,l,v,g,o,a=o.labelText,u=o.fontSize,s=o.startBox,f=o.endBox,y=o.boxColor,c=o.isInRightOrTopOfBox,m=o.fillStyle;t.save(),t.beginPath(),t.font=u+Ft,l=1,m=nt(m)?V:m,o.vertical?(v=L,c?0<(M=u+f-(s-r))&&s-f-r<f?(g=Z,m=qt(y),d=s-f+1,Se(t,e,s-f,n,f)):(g=Q,d=s-f-1):d=0<(M=u-(r+i-s))&&r+i-s<f?(Se(t,e,s-f,n,f),g=Q,m=qt(y),s-1):(g=Z,s+1),t.textAlign=v,t.textBaseline=g,t.fillStyle=m,t.fillText(a,e+n/2,d)):(g=tt,o=t.measureText(a),c?h=0<(M=o.width+f-(e+n-s))&&e+n-(s+f)<f?(Se(t,s,r,f,i),v=B,m=qt(y),s+f-1):(v=I,s+f+1):0<(M=o.width-(s-e))&&s-e<f?(Se(t,s,r,f,i),h=s+1,v=I,m=qt(y)):(v=B,h=s-1),t.textAlign=v,t.textBaseline=g,t.fillStyle=m,t.fillText(a,h,r+i/2)),t.restore()}function xe(t,e,r,n,i,o,j){var a,u,E,s,f,y,c,m,R,e,I,j,M,h,E,y,c,B,d,l,v,g,p,F,b,_,w,D,L,H,G,N,k,z,$,K,S,P,s,f,f,s,x,C,f,A,J,x,P,S,T,A,P,$,O,T,O,e,T,a=e.points,u=e.labels,E=e.pointIndex,s=e.minimum,f=e.maximum,y=e.colorPositive,c=e.colorNegative,m=e.vertical,R=e.itemTypeRange,e=e.colorTotal,I=5,j=13*j.zoomFactor;if(!nt(a)&&!((M=a.length)<=0||(h=parseInt(E,10),ft(h))||h<=0||M<h)){for(u=nt(u)?[]:u,c!==it&&typeof c===st||(c="#D6604D"),typeof e!==st&&(e=it),y=q(E=y=y!==it&&typeof y===st?y:"#8CBF64",1.3),B=q(c=c,1.3),d=1,F=[],D=_=b=p=g=v=l=0,L=M;D<L;D++)_=a[D],w=R[D],H=!1,G=1===d,(N=!nt(w))&&(w===_t?_=ut(_):w===bt?_=-ut(_):w===wt?(H=!0,G?l=_:_=l):N=!1),F[d]=[],k=F[d],ft(_)?(k[0]=0,k[1]=l,k[2]=0):(k[0]=ut(_),l=H?l:_+l,k[1]=0<_?v:l,k[2]=_),k[3]=d,g=ot(v,g),p=at(v,p),((z=d===M)&&!N||H)&&(b=g<0?-g:0,k[1]=0<_?0:_),N&&H&&!G||(v=_+v,z&&N&&(g=ot(v,g),p=at(v,p))),d++;$=!1,nt(w)||($=-1===(K=[bt,_t,wt]).indexOf(w)),(nt(w)||$)&&(l-=_),s=yt(s),ft(s)||0<s||g<s?s=S=g:b=-(S=s),f=yt(f),ft(f)||f<0||f<p?P=p:(P=f,b=-s),s=(f=dt(r,n,i,o,5,o-10,m)).left,x=f.width,C=f.top,f=f.height,A=m?-1:1,x=x/(J=P-S),vt(t,r,n,i,o),t.beginPath(),t.lineWidth=1,S=(P=F[h])[2],T=R[h-1],A=s+A*(P[1]+b)*x,P=P[0]*x,O=T===wt,T=(nt(T)||$)&&h===M||O,$=e&&T?e:1===h||T?0<=S?E:c:0<=S?y:B,m?lt(t,C,A-P,f,P,$):lt(t,A,C,P,f,$),m?(1!==h&&(h!==M?U(t,0<S,Mt,r,A,C+f,A,r,A-P,C+f,A-P):U(t,!0,Mt,r,O=s-(l+b)*x,C+f,O)),h!==M&&U(t,0<S,Mt,C,A-P,r+i,A-P,C,A,r+i,A)):(1!==h&&(h!==M?U(t,0<S,Mt,A,n,A,C+f,A+P,n,A+P,C+f):U(t,!0,Mt,e=s+(l+b)*x,n,e,C+f)),h!==M&&U(t,0<S,Mt,A+P,C,A+P,n+o,A,C,A,n+o)),T=u[h-1],0<u.length&&!nt(T)&&""!==T&&Pe(t,r,n,i,o,{labelText:T,vertical:m,isInRightOrTopOfBox:0<S,fontSize:j,startBox:A,endBox:P,boxColor:$}),U(t,m,V,r,s-b*x,r+i,s-b*x,s+b*x,n,s+b*x,n+o),t.restore()}}function Ce(r,t,n,i,o,a,e){var u,s,f,y,c,m,M,h,e,d,l,v,t,g,p,s,F,b,_,w,D,H,N,g,j,M,k,$,t,g,S,M,P,x,C,A,m,T,f,O,u=t.points,s=t.pointIndex,f=t.colorRange,y=t.target,c=t.target2,m=t.highlightPosition,M=t.label,h=t.vertical,e=13*e.zoomFactor,d=t.targetColor,l=t.target2Color,v=t.labelColor,t=t.barSize;if(!nt(u)&&(nt(t)||!(ft(t)||t<=0))&&(1<t&&(t=1),!((g=u.length)<=0||(p=parseInt(s,10),ft(p))||p<=0||g<p))){for(f=nt(f)?[]:f,s=parseInt(M,10),s=ft(s)?0:s,F=1,_=[],w=b=0,D=u.length;w<D;w++)H=u[w],_[F]=[],N=_[F],H<0||ft(H)||nt(H)?(N[0]=1===F?0:b,N[1]=0):(b+=H,N[0]=1===F?0:b-H,N[1]=H),F++;j=5,g=nt(t)?5:h?o*(1-t)/2:a*(1-t)/2,M=dt(n,i,o,a,g,a-10,h,5),k=M.left,$=M.width,t=M.top,g=M.height,S=h?-1:1,M=$/b,vt(r,n,i,o,a),r.beginPath(),r.lineWidth=1,x=(P=_[p])[1],C=k+S*P[0]*M,A=P[1]*M,m=p===m?mt:0===f.length||typeof f[p-1]!==st?gt:f[p-1],h?lt(r,t,C-A,g,A,m):lt(r,C,t,A,g,m),1===s?T=(P[0]+x)/b*1e3:2===s&&(T=x/b*1e3),f=rt(T)/10+"%",1!==s&&2!==s||!f||Pe(r,n,i,o,a,{labelText:f,vertical:h,isInRightOrTopOfBox:(P[0]+P[1])*M<$/2,fontSize:e,startBox:C,endBox:A,boxColor:m,fillStyle:v}),O=[nt(d)?"#8CBF64":d,nt(l)?"#EE5D5D":l],[y,c].forEach(function(t,e){var t,t,t=E(t),t=K(k+S*$*t);U(r,h,O[e],n,t,n+o,t,t,i,t,i+a)}),r.restore()}function E(t){var t=yt(t),t;return t=1<(t=(t=ft(t)?0:t)<0?0:t)?1:t}}function Ae(t,e){switch(e){case 2:var r;return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function Te(t,e,r){var e,r,n,i,o,e;return 1<(t=t<0?0:t)&&(t=1),e=h(e),r=h(r),n=e.a*(1-t)+r.a*t,i=e.r*(1-t)+r.r*t+"",o=e.g*(1-t)+r.g*t+"",e=e.b*(1-t)+r.b*t+"","rgba("+parseInt(i,10)+","+parseInt(o,10)+","+parseInt(e,10)+","+yt(n/255+"")+")"}function Oe(t,e,r){return t===e&&t===r?1:t<=e?0:r<=t?1:(t-e)/(r-e)}function je(t,e,r,n,i,o){var a=(o+i)/2;return i<=n&&n<=a?Te(Oe(n,i,a),t,e):Te(Oe(n,a,o),e,r)}function Ee(t){var e=ct,r=-ct;return t.forEach(function(t){t!==it&&t!==R&&(t<e&&(e=t),r<t)&&(r=t)}),{min:e,max:r}}function Re(t,r,n,i,o,a,u){var e,s,f;i?t.forEach(function(t,e){0!==t&&t!==it&&t!==R&&(r[n+e]=i[e]||r[n+e])}):(e=Ee(t),s=e.min,f=e.max,t.forEach(function(t,e){0!==t&&t!==it&&t!==R&&(r[n+e]=je(o,a,u,t,s,f))}))}function Ie(t,e,r,n,i,o){for(var a,u,s,f,y,c,m,M,h,d,l,v,g,p,F,b,_,w,D,a=e.year,u=e.month,s=e.values,f=e.emptyColor||"lightgray",y=e.startColor,c=e.middleColor,m=e.endColor,M="white",h=6,d=7,l=2,v=(i-14)/6,g=(o-16)/7,p=[],F=new Date(a,u-1,1).getDay(),b=0;b<42;b++)!(b<F)&&b<F+Ae(a,u)?p[b]=f:p[b]=M;for(Re(s,p,F,e.colors,y,c,m),t.save(),t.rect(r,n,i,o),t.clip(),t.beginPath(),w=_=0;w<6;w++)for(D=0;D<7;D++)t.fillStyle=p[_],_++,t.fillRect(r+w*v+2*(w+1),n+D*g+2*(D+1),v,g);t.restore()}function Be(t){for(var e,r,n,i,e=t.getFullYear(),r=t.getMonth(),n=t.getDate(),i=1;i<r+1;i++)n+=Ae(e,i);return n}function Le(t,e,r,n,i,o,a){for(var u,s,f,y,c,m,M,j,h,d,l,v,g,s,e,p,F,y,c,E,b,_,w,D,H,N,k,$,S,P,x,C,A,A,T,O,u=e.year,s=e.values,f=e.emptyColor||"lightgray",y=e.startColor,c=e.middleColor,m=e.endColor,M="white",j=7,h=parseInt(366/7+"",10)+2,d=[],l=new Date(u,0,1).getDay(),v=Be(new Date(u,11,31)),g=0;g<7*h;g++)d[g]=!(g<l)&&g<l+v?f:M;for(Re(s,d,l,e.colors,y,c,m),t.save(),t.rect(r,n,i,o),t.clip(),p=r+(e=15*(s=a.zoomFactor)),F=n,y=i-e,c=o,t.save(),t.translate(r+e/2,F+c),t.rotate(-Math.PI/2),t.font=13*s+Ft,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(u+"",c/2,0),t.restore(),b=(y-(E=2)*(h+1))/h,_=(c-16)/7,k=[],H=w=0;H<h;H++)for(D=0;D<7;D++)k[w]=N={x:p+H*b+2*(H+1),y:F+D*_+2*(D+1),w:b,h:_},t.fillStyle=d[w],w++,t.fillRect(N.x,N.y,N.w,N.h);for($=[],S={},P=0;P<12;P++)S[P]=Be(new Date(u,P,1))-1+l;for(x=S[11]+Ae(u,12)-1,H=w=0;H<h;H++)for(D=0;D<7;D++)l<=w&&w<l+v&&(A=(C=new Date(u,0,w-l+1)).getMonth(),N=k[w],(A=S[A])<=w&&w<7+A&&$.push({x1:N.x,y1:N.y-1,x2:N.x,y2:N.y+N.h+1}),w!==A&&0!==C.getDay()||$.push({x1:N.x-1,y1:N.y,x2:N.x+N.w+1+(w===A?2:0),y2:N.y}),x-7<w&&w<=x&&$.push({x1:N.x+N.w,y1:N.y-1,x2:N.x+N.w,y2:N.y+N.h+1}),w!==x&&6!==C.getDay()||$.push({x1:N.x-1-(w===x?2:0),y1:N.y+N.h,x2:N.x+N.w+1,y2:N.y+N.h})),w++;for(t.strokeStyle="black",t.lineWidth=2,T=0;T<$.length;T++)O=$[T],t.beginPath(),t.moveTo(O.x1,O.y1),t.lineTo(O.x2,O.y2),t.stroke();t.restore()}function Ge(t){var e,r,n,i,o,a,u,s,f,y,e=Xt(t.minAngle-90),r=Xt(t.maxAngle-90),n=t.minValueOption.value,i=t.maxValueOption.value,o=t.ranges,a=l,u=(r-e)/(i-n),s=[];return 0<o.length&&o.forEach(function(t){f=t.start,y=t.end,s.push({start:u*(f-n)+e,end:u*(y-n)+e,color:t.color})}),s.unshift({start:e,end:r,color:a}),{paintRanges:s,fillColor:a,targetValueRadian:u*(t.targetValueOption.value-n)+e,currentValueRadian:u*(t.currentValueOption.value-n)+e,minValueRadian:e,maxValueRadian:r}}function ze(t,e,r,n,i,o,a){var o,u,s,f,y,c,o,m,y,M,h,d,l,v,c,g,a,o=o.zoomFactor,u=t.currentValueOption.normalFontHeight*o,s=t.minValueOption.normalFontHeight*o,f=t.maxValueOption.normalFontHeight*o,y=t.minAngle,c=t.maxAngle,o=t.currentValueOption.normalFontWidth*o,m=90<ut(y)||90<ut(c),y=120<ut(y)||120<ut(c),c=b*ot(n,i);return a?(M=T(n/2*F),h=T(i*F),a=.03*(l=ot(M,d=m?h/2:h)),v={x:e+n/2,y:r+i/2+(m?0:l/2),outerRadius:l,innerRadius:l*t.radiusRatio,currentValuePoint:R,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:s<(g=(i-(m?2*l:l))/2),enoughShowMaxLabel:f<g,moreThanSemiCircle:m},m?y?2*u/3<g-a-at(f,s)&&o<n-2*c&&(v.currentValuePoint={x:v.x,y:v.y+l+a+u/2+at(f,s)},v.enoughShowCurrentLabel=!0):2*u/3<i/2-a&&o<n-2*c&&(v.currentValuePoint={x:v.x,y:v.y+2*a+u},v.enoughShowCurrentLabel=!0):u<g-a&&o<n-2*c&&(v.currentValuePoint={x:v.x,y:v.y+u},v.enoughShowCurrentLabel=!0)):(M=T(n/2*p),h=T(i*p),l=ot(M,d=m?h/2:h),v={x:e+n/2,y:r+i/2+(m?0:l/2),outerRadius:l,innerRadius:l*t.radiusRatio}),v}function Ke(t,e,r,n){return{x:t+N(r)*n,y:e+P(r)*n}}function Je(t,e){return ut(e.x-t.x)<.01?{x:e.x,y:e.y,textAlign:L}:e.x>t.x?{x:e.x+a,y:e.y,textAlign:I}:e.x<t.x?{x:e.x-a,y:e.y,textAlign:B}:{x:e.x,y:e.y,textAlign:I}}function Ve(e,t,r,n,i,o,a){var u,s,r,n,f,y,a,c,m,M,h,d,h,l,h,h,s,v,g,p,F,b,_,w,D,H,a,_,b,p,a,v,_,F,b,g,w,p,u=a.zoomFactor,s=!!nt(t.showLabel)||t.showLabel,r=ze(t,r,n,i,o,a,s);if(!(r.outerRadius<=0))return n={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},f=r.innerRadius,y=r.outerRadius,a=r.currentValuePoint,c=r.moreThanSemiCircle,m={x:r.x,y:r.y},h=(M=Ge(t)).paintRanges,d=M.fillColor,e.save(),h.forEach(function(t){e.beginPath(),e.strokeStyle=k,e.moveTo(m.x,m.y),e.fillStyle=t.color||d,e.arc(m.x,m.y,y,t.start,t.end,!1),e.lineTo(m.x,m.y),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.fillStyle=k,e.strokeStyle=k,e.moveTo(m.x,m.y),e.arc(m.x,m.y,f,t.start-St,t.end+St,!1),e.lineTo(m.x,m.y),e.closePath(),e.fill(),e.stroke()}),e.beginPath(),e.moveTo(m.x,m.y),e.fillStyle=V,e.arc(m.x,m.y,y*A,0,2*et,!1),e.fill(),h=Ke(m.x,m.y,M.targetValueRadian,f),l=Ke(m.x,m.y,M.targetValueRadian,y*E),Gt(e,h.x,h.y,l.x,l.y,Ht,Nt,$),h=Ke(m.x,m.y,M.currentValueRadian,y*E),G(e,m.x,m.y,h.x,h.y,V,O*y),s&&(e.save(),e.beginPath(),e.textAlign=C,e.fillStyle=$,h=t.minValueOption.normalFontHeight*u,s=t.maxValueOption.normalFontHeight*u,v=t.minValueOption.normalFontWidth*u,g=t.maxValueOption.normalFontWidth*u,p=M.minValueRadian,F=M.maxValueRadian,b=t.currentValueOption.normalFontHeight*u,_=t.currentValueOption.normalFontWidth*u,H=D=w=void 0,r.enoughShowCurrentLabel&&(S(e,a.x,a.y,t.currentValueOption.label,t.currentValueOption.fontAfterZoom,L),n.showCurrentLabel=!0,w={x:a.x-_/2,y:a.y-b,width:_,height:b}),r.enoughShowMinLabel&&ut(N(p)*y)+v<i/2-$t&&(a=Ke(m.x,m.y,M.minValueRadian,y),te(D={x:(_=Je(m,a)).x-v,y:_.y,width:v,height:h},w)||(S(e,_.x,_.y+T(h),t.minValueOption.label,t.minValueOption.fontAfterZoom,B),n.showMinLabel=!0)),r.enoughShowMaxLabel&&ut(N(F)*y)+g<i/2-$t&&(b=Ke(m.x,m.y,M.maxValueRadian,y),te(H={x:(p=Je(m,b)).x,y:p.y,width:g,height:s},w)||(S(e,p.x,p.y+T(s),t.maxValueOption.label,t.maxValueOption.fontAfterZoom,I),n.showMaxLabel=!0)),r.enoughShowTargetLabel&&(a=t.targetValueOption.normalFontWidth*u,v=t.targetValueOption.normalFontHeight*u,_=t.targetValueOption.label,l=Ke(m.x,m.y,M.targetValueRadian,F=y+3*v/2),b=Je(m,l),g=M.targetValueRadian,w=c?(o-2*F)/2+F:o-(o-y)/2,ut(N(g)*F)+a<i/2-$t)&&ut(P(g)*F)+v/2+$t/2<w&&(p=at(h,s)/2,S(e,b.x,b.y-(et<g?p:-p),_,t.targetValueOption.fontAfterZoom,b.textAlign),n.showTargetLabel=!0),e.restore()),e.restore(),n}function We(t,e,r,n,i,o){var o,a,u,s,f,y,c,m,M,t,h,d,o,e,o=o.zoomFactor,a=t.showLabel,u=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,f=t.targetValueOption.normalFontHeight*o,y=t.currentValueOption.normalFontHeight*o,c=t.minValueOption.normalFontWidth*o,m=t.maxValueOption.normalFontWidth*o,M=t.targetValueOption.normalFontWidth*o,t=t.currentValueOption.normalFontWidth*o,o=.05*n,h=T(i*v),d=T(n*g),e={x:e+n*(1-g)/2,y:r+i*(v+(1-v)/2),graphWidth:d,graphHeight:h,targetValuePoint:R,currentValuePoint:R,minValuePoint:R,maxValuePoint:R};return a&&(u<(i-h)/2&&c<(n-d)/2-o&&(e.minValuePoint={x:e.x-c,y:e.y+u/3},e.enoughShowMinLabel=!0),s<(i-h)/2&&m<(n-d)/2-o&&(e.maxValuePoint={x:e.x-m,y:e.y-h+s/3},e.enoughShowMaxLabel=!0),(f<(i-h)/2||f/2<h)&&M<(n-d)/2-o-at(c,m)&&(e.targetValuePoint={x:e.x-M-at(c,m),y:R},e.enoughShowTargetLabel=!0),y<(i-h)/2||y/2<h)&&t<(n-d)/2-o&&(e.currentValuePoint={x:e.x+d+o,y:R},e.enoughShowCurrentLabel=!0),e}function Ue(t,e){var r,n,i,o,a,u,s,f,r=t.minValueOption.value,n=t.maxValueOption.value,i=t.ranges,o=l,a=e.graphHeight/(n-r),u=[];return 0<i.length&&i.forEach(function(t){s=t.start,f=t.end,u.push({start:e.y-a*(s-r),height:a*(f-s),color:t.color})}),u.unshift({start:e.y,height:e.graphHeight,color:o}),{paintRanges:u,fillColor:o,targetValueY:e.y-a*(t.targetValueOption.value-r),currentValueY:e.y-a*(t.currentValueOption.value-r)}}function qe(e,t,r,n,i,o,a){var u,s,f,y,c,m,r,M,i,a,h,d,l,v,g,t,p,F,b,_,w,u=a.zoomFactor,s=t.showLabel,f=t.minValueOption,y=t.maxValueOption,c=t.currentValueOption,m=t.targetValueOption,r=We(t,r,n,i,o,a),M=r.graphWidth,i=r.graphHeight;if(!(M<=0||i<=0))return a={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},h=r.currentValuePoint,d=r.targetValuePoint,l=r.minValuePoint,v=r.maxValuePoint,g={x:r.x,y:r.y},p=(t=Ue(t,r)).paintRanges,F=c.normalFontHeight*u,b=m.normalFontHeight*u,_=t.targetValueY,w=t.currentValueY,e.save(),p.forEach(function(t){lt(e,g.x,t.start,M,-t.height,t.color)}),Gt(e,g.x-(E-1)*M,_,g.x+M,_,Ht,Nt,$),G(e,g.x,w,g.x+M*E,w,V,Dt*i),s&&(e.save(),e.beginPath(),r.enoughShowMinLabel&&(S(e,l.x,l.y,f.label,f.fontAfterZoom,I,$),a.showMinLabel=!0),r.enoughShowMaxLabel&&(S(e,v.x,v.y,y.label,y.fontAfterZoom,I,$),a.showMaxLabel=!0),r.enoughShowTargetLabel&&!(o<_-n+b/2||_-n-kt<0)&&(S(e,d.x,t.targetValueY+m.normalFontHeight*u/3,m.label,m.fontAfterZoom,I,$),a.showTargetLabel=!0),r.enoughShowCurrentLabel&&!(o<w-n+F/2||w-n-kt<0)&&(S(e,h.x,t.currentValueY+c.normalFontHeight*u/3,c.label,c.fontAfterZoom,I,$),a.showCurrentLabel=!0),e.restore()),e.restore(),a}function Ye(t,e,r,n,i,o){var o,a,u,s,f,y,c,m,M,t,h,d,o,e,o=o.zoomFactor,a=t.showLabel,u=t.minValueOption.normalFontHeight*o,s=t.maxValueOption.normalFontHeight*o,f=t.targetValueOption.normalFontHeight*o,y=t.currentValueOption.normalFontHeight*o,c=t.minValueOption.normalFontWidth*o,m=t.maxValueOption.normalFontWidth*o,M=t.currentValueOption.normalFontWidth*o,t=t.targetValueOption.normalFontWidth*o,o=.1*ot(n,i),h=T(i*g),d=T(n*v),e={x:e+n*(1-v)/2,y:r+i*(1-g)/2,graphWidth:d,graphHeight:h,targetValuePoint:R,currentValuePoint:R,minValuePoint:R,maxValuePoint:R};return a&&((M<3*(n-d)/4||M<d)&&y<(i-h)/2-$t&&(e.currentValuePoint={x:R,y:e.y-y/2},e.enoughShowCurrentLabel=!0),(t<3*(n-d)/4||t<d)&&f<(i-h)/2-at(u,s)&&(e.targetValuePoint={x:R,y:e.y+h+at(u,s)+f/4*3},e.enoughShowTargetLabel=!0),c<3*(n-d)/4&&u<(i-h)/2-o&&(e.minValuePoint={x:e.x-c/2,y:e.y+h+u},e.enoughShowMinLabel=!0),m<3*(n-d)/4)&&s<(i-h)/2-o&&(e.maxValuePoint={x:e.x+d-m/2,y:e.y+h+s},e.enoughShowMaxLabel=!0),e}function Xe(t,e){var r,n,i,o,a,u,s,f,r=t.minValueOption.value,n=t.maxValueOption.value,i=t.ranges,o=l,a=e.graphWidth/(n-r),u=[];return 0<i.length&&i.forEach(function(t){s=t.start,f=t.end,u.push({start:e.x+a*(s-r),width:a*(f-s),color:t.color||o})}),u.unshift({start:e.x,width:e.graphWidth,color:o}),{paintRanges:u,fillColor:o,targetValueX:e.x+a*(t.targetValueOption.value-r),currentValueX:e.x+a*(t.currentValueOption.value-r)}}function Ze(e,t,r,n,i,o,a){var u,s,f,y,c,m,n,o,M,a,h,d,l,v,g,t,p,F,b,_,t,u=a.zoomFactor,s=t.showLabel,f=t.minValueOption,y=t.maxValueOption,c=t.currentValueOption,m=t.targetValueOption,n=Ye(t,r,n,i,o,a),o=n.graphWidth,M=n.graphHeight;if(!(o<=0||M<=0))return a={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},h=n.currentValuePoint,d=n.targetValuePoint,l=n.minValuePoint,v=n.maxValuePoint,g={x:n.x,y:n.y},p=(t=Xe(t,n)).paintRanges,F=c.normalFontWidth*u,b=m.normalFontWidth*u,_=t.targetValueX,t=t.currentValueX,e.save(),p.forEach(function(t){lt(e,t.start,g.y,t.width,M,t.color)}),Gt(e,_,g.y,_,g.y+M*E,Ht,Nt,$),Lt(e,t,g.y+M-1,t,g.y-M*(E-1)-1,V,o*Dt),s&&(e.save(),n.enoughShowMinLabel&&(S(e,l.x,l.y,f.label,f.fontAfterZoom,I,$),a.showMinLabel=!0),n.enoughShowMaxLabel&&(S(e,v.x,v.y,y.label,y.fontAfterZoom,I,$),a.showMaxLabel=!0),n.enoughShowTargetLabel&&!(i<_-r+b/2+w||_-r-b/2-w<0)&&(S(e,_-m.normalFontWidth*u/2,d.y,m.label,m.fontAfterZoom,I,$),a.showTargetLabel=!0),n.enoughShowCurrentLabel&&!(i<t-r+F/2+w||t-r-F/2-w<0)&&(S(e,t-c.normalFontWidth*u/2,h.y,c.label,c.fontAfterZoom,I,$),a.showCurrentLabel=!0),e.restore()),e.restore(),a}function Qe(t,e,r,n,i,o,a){t.save(),t.rect(r,n,i,o),t.clip(),0===e.gaugeType?Ve(t,e,r,n,i,o,a):1===e.gaugeType?qe(t,e,r,n,i,o,a):2===e.gaugeType&&Ze(t,e,r,n,i,o,a),t.restore()}function tr(t,e,r,n,i,o,a,u){var s,f,y,a,c,m,M,h,d,l,s=[],f=t.length,y=0,a=a.fontPixelSize;if(o&&(y=a+3),0!==f){for(c=n/f,m=t[0].value,M=1;M<f;M++)m=Math.max(m,t[M].value);for(h=0;h<f;h++)l=t[h].value/m*(i-y),s.push({x:e+h*c+c*(1-u)/2,textX:e+h*c,y:(d=r+i-y)-(l=l<0?0:l),width:c*u,textWidth:c,height:l,axis:t[h].axis})}return s}function er(t,e,r,n){t.save(),t.fillStyle=r;for(var i=0;i<e.length;i++)t.fillRect(e[i].x,e[i].y,e[i].width,e[i].height);t.restore()}function rr(t,e,r,n){var i,o,a,u,s;for(t.save(),i=r.fontPixelSize,o=ar(r),t.textAlign="center",t.fillStyle=n,a=0;a<e.length;a++)s=u=void 0,u=e[a].x+e[a].width/2,s=e[a].y+e[a].height+5+i,t.save(),t.font=o,t.beginPath(),t.rect(e[a].textX,e[a].y+e[a].height+1,e[a].textWidth,i+3),t.clip(),t.textBaseline="bottom",t.fillText(e[a].axis,u,s),t.restore();t.restore()}function nr(t,e,r,n){var i,o,a,u,s,o;if("none"!==n){for(t.save(),t.lineWidth=1,t.strokeStyle=n,t.beginPath(),i=0;i<e.length;i++)a=(o=e[i]).x,u=o.y,s=o.width,0===(o=o.height)||0===s||(G(t,a,u,a+s,u),G(t,a,u+o,a+s,u+o),e[i-1]&&e[i-1].height>=o&&1===r||G(t,a,u,a,u+o),e[i+1]&&e[i+1].height>o&&1===r)||G(t,a+s,u,a+s,u+o);t.stroke(),t.closePath(),t.restore()}}function ir(t,e,r,n,i){var o,a,u,s,f,y,o=!1;for(t.save(),t.font=i,u=(r-6)/(a=e.length),s=0,f=e;s<f.length;s++)if(y=f[s],t.measureText(y.axis).width>u){o=!0;break}return t.restore(),o}function or(t,e,r,n,i,o,a){var u,s,f,y,c,m,M,e,h,r,n,u=e.barColor,s=e.values,f=e.paintLabel,y=e.barWidth,c=e.labelFontStyle,m=e.afterZoomFontStyle,M=e.edgeColor,e=e.labelColor;nt(c)||(o<3*(h=m.fontPixelSize)||ir(t,s,i,o,ar(m)))&&(f=!1),er(t,n=tr(s,r+3,n+3,i-6,o-6,f=f&&nt(c)&&(r=Math.floor(12<=o/3?12:Math.floor(o/3)),m.fontPixelSize=r,m.fontSize=r+"px",ir(t,s,i,o,ar(m)))?!1:f,m,y),u,M),nr(t,n,y,M),f&&rr(t,n,m,e)}function ar(t){return"".concat(t.fontStyle," ").concat(t.fontWeight," ").concat(t.fontSize," ").concat(t.fontFamily)}function ur(t,e,r,n,i,o,a){var r,n,i,o,u,s,f,y,e;t.save(),t.rect(r,n,i,o),t.clip(),r=e.clipX,n=e.clipY,i=e.clipWidth,o=e.clipHeight,u=e.paintX,s=e.paintY,f=e.paintWidth,y=e.paintHeight,e=e.img,0<i&&0<o&&0<f&&0<y&&t.drawImage(e,r,n,i,o,u,s,f,y),t.restore()}function sr(t,e,r,n){this.X=t,this.Y=e,this.Width=r,this.Height=n,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height}function t(){this.Bzt=2,this.Lzt=o,this.Fzt=o,this.Pzt=ct,this.Gzt=-ct}n=this&&this.__extends||(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Object.defineProperty(c,"__esModule",{value:!0}),c.SparklineExRenders=c.SparklineRender=c.Uzt=c.Hzt=c.zzt=c.oCt=void 0,i=r("./src/common/util/types.ts"),m=r("./src/common/util/colorhelper.ts"),M=r("./src/common/util/arrayhelper.ts"),nt=i.lt.ht,q=m.ft.YGt,h=m.ft._,d=M.Uf.hD,c.oCt={},it=null,R=void 0,T=Math.floor,et=Math.PI,P=Math.sin,N=Math.cos,ot=Math.min,at=Math.max,rt=Math.round,x=Math.pow,z=Math.sqrt,ut=Math.abs,K=Math.ceil,j="undefined",st="string",ft=isNaN,yt=parseFloat,ct=Number.MAX_VALUE,o=new Date(""),gt="#969696",mt="#CB0000",pt="#646464",Mt="#DCDCDC",k="white",V="black",J="blue",Y="green",$="grey",X="red",l="lightgrey",I="left",B="right",L="center",Z="top",Q="bottom",tt="middle",C="start",Ft="px Arial",bt="-",_t="+",wt="=",A=.05,O=.03,E=1.06,Dt=.02,Ht=4,a=Nt=5,w=3,kt=10,$t=8,v=.8,g=.25,p=.9,F=.7,b=.1,St=1/45*et,Pt=Rt,n(ne,f=D=Et),xt=ne,Ct="7ns",At="5ns",Tt="tukey",Ot="bowley",jt="sigma3",c.zzt=Ve,c.Hzt=qe,c.Uzt=Ze,_=sr,t.prototype.paint=function(t,e,r,n,i,o){var a,u,s,f,a=this;a.options=e,a.setting=e.settings,u=e.values,s=e.dateValues,f=e.zoomFactor,t.save(),t.rect(r,n,i,o),t.clip(),t.beginPath(),0===e.sparklineType&&a.c6(t,r,n,i,o,u,s,f),a.Vzt(t,r,n,i,o,u,s,f),a.Yzt(t,r,n,i,o,u,s,f),t.restore()},t.prototype.Zzt=function(t){return 0===this.options.sparklineType?3+this.Wzt(t)+1:3},t.prototype.Qzt=function(t,e){var r,n,i,o,a,a,u,s,f,y,r=this.Kzt;if(!r)if(r=this.Kzt=[],n=t.length,this.options.displayDateAxis){for(a=e.length,u=[],(u=0<(a=ot(n,a))?e.slice(0,a):u).sort(function(t,e){return t===e?0:(t=t===c.oCt?0:t)-(e=e===c.oCt?0:e)}),s=u.length,y=f=void 0,i=0;i<s;i++)if(typeof(f=u[i])!==j&&f!==it){for(y=d(e,f);M.Uf.OS(r,y);)y=d(e,f,y+1);isNaN(f)||(o=t[y])!==R&&o!==it&&isNaN(o)&&o!==c.oCt||r.push(y)}}else for(i=0;i<n;i++)typeof(o=t[i])!==j&&o!==it&&isNaN(o)&&o!==c.oCt||r.push(i);return r},t.prototype.Sl=function(t,e){var e=e[t];return typeof e===j||e===it?1===this.setting.options.displayEmptyCellsAs&&(e=0):e===c.oCt&&(e=0),e},t.prototype.c6=function(t,e,r,n,i,o,a,u){var s,f,y,c,m,M,h,d,l,v,g,l,p,F,b,_,w,D,s=this,f=s.Qzt(o,a),M=f.length-1;for(M<0&&(M=0),h=s.setting.options,d=s.linePos=[],F=h.displayEmptyCellsAs,y=0;y<M;y++)if(typeof(l=s.Sl(f[y],o))!==j&&l!==it){if(typeof(v=s.Sl(f[g=y+1],o))===j||v===it)if(1===F)v=0;else if(2===F)for(g=y+2;g<=M;g++)if(typeof(b=o[f[g]])!==j&&b!==it){v=b;break}typeof v!==j&&v!==it?(l=s.Jzt(f[y],{Width:n,Height:i},o,a,u),p=s.Jzt(f[g],{Width:n,Height:i},o,a,u),_=l.Width/2,c={X:l.X+_,Y:l.Y+_},m={X:p.X+_,Y:p.Y+_},d[y]={P1:c,P2:m}):y++}if(0<(w=d.length))for(t.strokeStyle=s.options.getColor(h.seriesColor),t.lineCap="round",t.lineWidth=s.Wzt(u),y=0;y<w;y++)(D=d[y])&&(t.beginPath(),c=D.P1,m=D.P2,t.moveTo(e+c.X,r+c.Y),t.lineTo(e+m.X,r+m.Y),t.stroke(),t.closePath())},t.prototype.Xzt=function(t,e,r){var n,i,o,a,u,r,s,f,y,c,e,n=this,i=n.options,o=n.setting.options,a=it,u=n.Sl(t,e),r=n.Qzt(e,r),s=r.length,f=i.getColor.bind(n);return typeof u!==j&&u!==it&&(n.Pzt!==ct&&n.Gzt!==-ct||n.qzt(e),u===n.Pzt&&o.showLow&&(a=f(o.lowMarkerColor)),typeof(a=u!==n.Gzt||!o.showHigh||typeof a!==j&&a!==it?a:f(o.highMarkerColor))!==j&&a!==it||(i.displayDateAxis?0===(y=d(r,t))&&o.showFirst&&(a=f(o.firstMarkerColor)):0===t&&o.showFirst&&(a=f(o.firstMarkerColor))),typeof a!==j&&a!==it||(i.displayDateAxis?(c=d(r,t))===s-1&&o.showLast&&(a=f(o.lastMarkerColor)):t===s-1&&o.showLast&&(a=f(o.lastMarkerColor))),typeof(a=u<0&&o.showNegative&&(typeof a===j||a===it)?f(o.negativeColor):a)!==j&&a!==it||(0===(e=i.sparklineType)?o.showMarkers&&(a=f(o.markersColor)):1!==e&&2!==e||(a=f(o.seriesColor)))),a===R||a===it?"Transparent":a},t.prototype.Vzt=function(t,e,r,n,i,o,a,u){for(var s,f,y,c,m,M,h,M,h,d,h,d,l,M,v,s=this,f={Width:n,Height:i},y=s.Qzt(o,a),c=y.length,m=s.options.sparklineType,v=0;v<c;v++)M=y[v],h=s.Xzt(M,o,a),M=s.Jzt(M,f,o,a,u),t.fillStyle!==h&&(t.fillStyle=h),0===m?(t.save(),h=e+M.X+M.Width/2,d=r+M.Y+M.Height/2,t.translate(h,d),t.rotate(45*et/180),t.fillRect(0-M.Width/2,0-M.Height/2,M.Width,M.Height),t.restore()):(h=e+M.X+M.Width/4,h=T(h),d=r+M.Y,l=M.Width/2,M=M.Height,t.fillRect(h,d,l,M))},t.prototype.Yzt=function(t,e,r,n,i,o,a,u){var s,f,a,n,i,a,o,s,f,s=this,f=s.setting&&s.setting.options;f&&f.displayXAxis&&s.$zt(o,a)&&(a={Width:n,Height:i},n=s.Zzt(u),i=a.Width-s.Zzt(u),o=a=T(s.tVt(a,o,u))+.5,s=s.options.getColor(f.axisColor),(f=u)<1&&(f=1),t.strokeStyle!==s&&(t.strokeStyle=s),t.lineWidth!==f&&(t.lineWidth=f),t.beginPath(),t.moveTo(e+n,r+a),t.lineTo(e+i,r+o),t.stroke())},t.prototype.nVt=function(t){var e,t,e=this.eVt(t);return e===-ct||(t=this.iVt(t))===ct||e===t||e*t<=0},t.prototype.$zt=function(t,e){var r,n,i,o,a,u,r=this.nVt(t);if(2===this.options.sparklineType&&(i=(n=this.Qzt(t,e)).length,!r)&&0<i)for(u=0;u<i;u++)if(typeof(a=t[o=n[u]])!==j&&a!==it)return!0;return r},t.prototype.rVt=function(t,e){var r=this.Lzt;return isNaN(r&&r.valueOf())&&this.oVt(t,e),this.Lzt},t.prototype.aVt=function(t,e){var r=this.Fzt;return isNaN(r&&r.valueOf())&&this.oVt(t,e),this.Fzt},t.prototype.oVt=function(t,e){for(var r,n,i,o,a,u,s,u,f,r=this,n=new Date(0,0,0),i=ct,o=r.Qzt(t,e),a=o.length,f=0;f<a;f++)s=e[u=o[f]],isNaN(s)||(u=r.Sl(u,t))!==it&&typeof u===j||isNaN(u)||typeof s!==j&&s!==it&&(n<s&&(n=s),s<i)&&(i=s);r.Fzt=n,r.Lzt=i},t.prototype.uVt=function(t,e,r,n){for(var i,o,a,u,s,f,y,c,m,M,h,d,l,e,i=this,o=i.rVt(e,r),a=i.aVt(e,r),u=[],c=i.Qzt(e,r),m=c.length,s=0;s<m;s++)(f=r[y=c[s]])&&!isNaN(f)&&u.push(f);if(u.sort(function(t,e){return t-e}),1<(M=u.length)&&o!==a){for(h=ct,l=void(d=0),s=1;s<M;s++)(f=(l=u[s])-u[s-1])<h&&0<f&&(h=f),d+=f;return e=(e=(t.Width-i.Zzt(n)-i.Zzt(n))*h/d/2)<2?2:e}return(t.Width-i.Zzt(n)-i.Zzt(n))/2},t.prototype.sVt=function(t,e,r,n){var i,e,i=this;return i.options.displayDateAxis?i.uVt(t,e,r,n):(e=i.Qzt(e,r).length,(t.Width-i.Zzt(n)-i.Zzt(n))/e)},t.prototype.cVt=function(t,e,r,n,i){var o,a,u,s,f,y,c,s,y,m,o=this,u=o.Zzt(i);return o.options.displayDateAxis?(a=o.sVt(t,r,n,i),(s=o.aVt(r,n))===(f=o.rVt(r,n))?u+a/2:(y=n[e])?(c=t.Width-u-o.Zzt(i),c-=a,s=s.valueOf()-f.valueOf(),u+T((y.valueOf()-f.valueOf())/s*c)):0):(a=o.sVt(t,r,n,i),y=d(o.Qzt(r,n),e),T(m=u+a*y))},t.prototype.fVt=function(t,e){var r,n,t,r=this,n=t.Width-r.Zzt(e)-r.Zzt(e);return n=at(n,0),t=t.Height-r.Zzt(e)-r.Zzt(e),{Width:n,Height:t=at(t,0)}},t.prototype.qzt=function(t){for(var e,r,n,i,e=this,r=t.length,i=0;i<r;i++)typeof(n=t[i])!==j&&n!==it&&((n="number"!=typeof n?0:n)<e.Pzt&&(e.Pzt=n),n>e.Gzt)&&(e.Gzt=n)},t.prototype.eVt=function(t){var e,t,r,e=this;return e.Gzt!==-ct&&e.Gzt||e.qzt(t),0===(r=(t=e.setting.options).maxAxisType)?e.Gzt:1===r?t.groupMaxValue:2===r?t.manualMax:e.Gzt},t.prototype.iVt=function(t){var e,t,r,e=this;return e.Pzt!==ct&&e.Pzt||e.qzt(t),0===(r=(t=e.setting.options).minAxisType)?e.Pzt:1===r?t.groupMinValue:2===r?t.manualMin:void 0},t.prototype.lVt=function(t,e,r,n){var t=this.fVt(t,n),n=this.eVt(r),i=this.iVt(r),o=n-i,a,u;if(n===i){if(0===n)return 0;o=ut(n)}return(a=(a=r[e])||0)*(u=t.Height/o)},t.prototype.hVt=function(t,e,r,n){var i,o,a,o,o,i=this,o=i.options.sparklineType;if(0===o)return i.lVt(t,e,r,n);if(1!==o)return 2===o?typeof(a=r[e])===j||a===it||0===a||isNaN(a)?0:(o=i.fVt(t,n),0<=a?o.Height/2:-o.Height/2):void 0;if(a=r[e],1===i.setting.options.displayEmptyCellsAs&&(typeof a===j||a===it))return 0;if((o=i.lVt(t,e,r,n))>-i.Bzt&&o<i.Bzt){if(0<a)return o+i.Bzt;if(a<0)return o-i.Bzt}return o},t.prototype.dVt=function(t,e,r){var n,i,o,e,a,e,n=this,i=n.fVt(t,r),o=n.eVt(e),e=n.iVt(e);if(o===-ct||e===ct)return t.Height/2;if(a=o-e,o===e){if(0===o)return t.Height/2;(a=o)<0&&(o=0)}return e=i.Height/a,n.Zzt(r)+o*e},t.prototype.tVt=function(t,e,r){return 2===this.options.sparklineType?t.Height/2:this.dVt(t,e,r)},t.prototype.vVt=function(t,e,r,n){var i,t,n,o,a,t,a,u,i=this,t=i.fVt(t,n),n=i.eVt(r),o=i.iVt(r),a=n-o;if(n===o){if(0===n)return 0;a=n}return t=t.Height/a,typeof(a=i.Sl(e,r))!==j&&a!==it||(a=0),n!==o&&0<n*o?(u=0)<=a?(a-o)*t:(a-n)*t:a*t},t.prototype.mVt=function(t,e,r,n){var i,o,a,u,s,i=this,o=i.options.sparklineType;return 0===o?i.vVt(t,e,r,n):1===o?(a=i.vVt(t,e,r,n),-(u=i.Bzt)<a&&a<u&&0!==(s=typeof(s=i.Sl(e,r))!==j&&s!==it?s:0)?0<s?a+u:a-u:a):2===o?i.hVt(t,e,r,n):void 0},t.prototype.gVt=function(t,e,r,n,i){var o,a,n,u,s,f,y,f,y,s,t,r,o=this,a=o.sVt(e,r,n,i),n=o.cVt(e,t,r,n,i);return(a=T(a=a<0?0:a))%2==1&&(a+=1),u=o.hVt(e,t,r,i),s=o.tVt(e,r,i),f=o.eVt(r),y=o.iVt(r),f=f<(f=0)&&y<0?at(o.Zzt(i),s):0<=u?s-u:s,y=o.mVt(e,t,r,i),s=new _(n,f,a,ut(y)),0!==u&&(t=o.Zzt(i),s.Y<t&&s.Bottom<t+1?s.Height=T(s.Height+1):(r=e.Height-o.Zzt(i),s.Bottom>r&&s.Y>r-1&&(s.Y=r-y,s.Height=y))),s},t.prototype.Wzt=function(t){var t=this.setting.options.lineWeight*t;return t=t<1?1:t},t.prototype.Jzt=function(t,e,r,n,i){var o,a,n,i,t,u,r,o=this,a=o.Wzt(i);return++a<2&&(a=2),n=o.gVt(t,e,r,n,i),0===o.options.sparklineType&&(n.X=n.X+(n.Width-a)/2,typeof(i=o.Sl(t,r))!==j&&i!==it?(0<=i?n.Y-=a/2:n.Y=n.Bottom-a/2,n.Width=a,n.Height=a):(n.Width=0,n.Height=0)),o.setting.options.rightToLeft&&(t=n.X,r=(u=e.Width-t)-n.Width,n=new _(r,n.Y,n.Width,n.Height)),n},c.SparklineRender=t,c.SparklineExRenders={PIESPARKLINE:ee,AREASPARKLINE:ae,SCATTERSPARKLINE:se,BULLETSPARKLINE:Me,SPREADSPARKLINE:he,STACKEDSPARKLINE:ge,HBARSPARKLINE:we,VBARSPARKLINE:De,VARISPARKLINE:He,LOLLIPOPVARISPARKLINE:Ne,BOXPLOTSPARKLINE:ke,CASCADESPARKLINE:xe,PARETOSPARKLINE:Ce,MONTHSPARKLINE:Ie,YEARSPARKLINE:Le,GAUGEKPISPARKLINE:Qe,HISTOGRAMSPARKLINE:or,IMAGESPARKLINE:ur}},canvas:function(t){t.exports=canvas}},n={},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),e=t={},Object.defineProperty(e,"__esModule",{value:!0}),e.Slicers=e.Sparklines=e.Formatter=e.Commands=e.Common=void 0,i=o("./src/common/common.entry.ts"),e.Common=i,i=o("./src/plugins/commands/commands.entry.ts"),e.Commands=i,i=o("./src/plugins/formatter/formatter.entry.ts"),e.Formatter=i,i=o("./src/plugins/sparkline/sparkline.entry.ts"),e.Sparklines=i,i=o("./src/plugins/slicer/slicer.entry.ts"),e.Slicers=i,(a={}).Spread=t}(),t.exports=a.Spread},"./node_modules_local/@spreadjs/js-sheets-common/index.js":(t,e,r)=>{t.exports=r("./node_modules_local/@spreadjs/js-sheets-common/dist/gc.spread.common.js")}},n={},t=i("./node_modules_local/@spreadjs/js-sheets-common/index.js"),(GC=void 0===GC?{}:GC).Spread=t})();
;var GC;(()=>{var n,r,e;function i(e){var t,t,t=r[e];return void 0!==t||(t=r[e]={exports:{}},n[e](t,t.exports,i)),t.exports}n={"./node_modules_local/@spreadjs/js-calc/dist/gc.spread.calcengine.js":(e,t,o)=>{var a;!function(){"use strict";var n,r,e;function i(e){var t,t,t=r[e];return void 0!==t||(t=r[e]={exports:{}},n[e].call(t.exports,t,t.exports,i)),t.exports}n={"./src/Parser.ts":function(m,C,e){var t,f,g,v,p,A,b,y,I,S,R,N,E,e,T,G,q,j,c,O,D,L,M,n,F,B,e,V,r,K,Y,X,W,Z,z,i,o;function _(){throw(0,g.sR)()[q]}function P(e,t,n){throw E.I5((0,g.sR)()[n||G],[e,t])}function J(e){return e<=255}function a(e){return e<=127}function w(e){return e===(0,g.getBoolean)().boolean_true||e===S}function x(e){return e===(0,g.getBoolean)().boolean_false||e===R}function U(e){return 48<=e&&e<=57}function Q(e){var e=e.charCodeAt(0);return!J(e)||(a(e)?96<=(e|=32)&&e<=122:0===n[e]||1===n[e])}function $(e){var e=e.charCodeAt(0);return!J(e)||(a(e)?e<=57?48<=e:96<=(e|=32)&&e<=122:0===n[e]||1===n[e])}function ee(e){var e=e.charCodeAt(0);return a(e)?48<=e&&e<=57:8===n[e]||10===n[e]}function k(e,t,n,r,i,o){for(var a,u,s,f,c,h,a=e.length,u=n===r?0:1,s=[],f=0,c=t+1;c<a;c++)if((h=e[c])===i&&(s.push(h),f++,h=e[++c]),h===n&&u++,h===r)if(u--,n===r&&c+2<a&&e[c+1]===n)s.push(n),c++,f++;else{if(0===u)return{result:s,endIndex:c,skipCount:f};s.push(h)}else s.push(h);o&&P(r,n,j)}function te(e,t,n){for(var r,i,o,a,u,s,f,r=e.length,i=r-t,o=(0,g.getErrorList)(),a=0;a<o.length;a++)if(t+(s=(u=o[a]).length)<=r&&(f=e.slice(t,t+s),s<=i)&&u===f.join("").toUpperCase())return{result:f,endIndex:t+s-1};n&&P([e[t],t])}function ne(e){return 0!==e.type&&(7!==e.type||"ANCHORARRAY"===e.functionName)&&e.type<9}function re(e,t,n){for(var r,i,o,a,u,r=e.length,i=0,o=[],a=t;a<r;a++)if(U((u=e[a]).charCodeAt(0)))0===i?i=2:3===i?i=4:1===i?i=2:5!==i&&6!==i||(i=7),o.push(u);else if(u===n){if(2===i)i=4;else{if(0!==i&&1!==i)return{};i=3}o.push(".")}else if("+"===u||"-"===u){if(0===i)i=1;else{if(5!==i)return{num:o,endIndex:a-1};i=6}o.push(u)}else if("E"===u||"e"===u){if(2!==i&&4!==i)return{};i=5,o.push(u)}else if(2===i||4===i||7===i)return{num:o,endIndex:a-1};return 2===i||4===i||7===i?{num:o,endIndex:r-1}:{}}function H(e,t){F.apply(e,t)}function u(e,t,n,r,i){var o,a,r;this.R1t=[],i=i||0,(o=this).y4=e,a=Array.isArray(e)?e.join(""):e,o.uit=t,o.lp=n,o.ywt=r||n+e.length-1,0===t&&0===i&&e&&(w(r=a.toUpperCase())||x(r))&&(i=5,a=r),o.Awt=a,o.Twt=i}function s(e){this.priority=e=void 0===e?5e3:e}function ie(e){for(var t,n,r,t=0,n=e;t<n.length;t++)if(0===(r=n[t]).type&&","!==r.value||r.arguments&&ie(r.arguments))return 1}function oe(e,t,n){e.lit=t,e.ywt=n}function ae(e){var t=e.value;t&&t[0]===v&&t[t.length-1]===p&&(e.value=t.substring(1,t.length-1),e.Bve=!0)}function h(){}function l(e,t,n,r){this.lyt=!1,this.Nme=!1,this.ignoreError=!1;var i=this;i.useR1C1=t,i.baseIdentity=n,i.option=r,i.source=e}function ue(e,t,n){var r,i,i,o;if(U(+e[0]))return 1;if(0<(i=(r=e).lastIndexOf("[")))return 1;if(0===i){if(!(0<(i=e.lastIndexOf("]"))))return 1;if(!se(o=e.slice(1,i)))return 1;r=e.slice(i+1)}return!fe(r,t,n)}function se(e){var t,n;if(e&&0!==e.length)for(n=0;n<e.length;n++)if(t=e[n],K[t]||C.operaterTypesMap[t])return;return 1}function fe(e,t,n){var r,i;if(e&&0!==e.length){if(!t){if(ee(e[0]))return!1;if(he(e))return!1;if(Y.test(e[0]))return!1}for(i=0;i<e.length;i++)if(r=e[i],t){if("*"===r||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return!1}else if(X[r]||C.operaterTypesMap[r]||"\u3000"===r&&(n||f.Common.CultureManager.Fe().isJCKCulture))return!1}return!0}function ce(e){var t,n,e,t=e.search(/[0-9]/),n=e.substr(0,t),e=parseInt(e.substr(t),10);return(t<=2||3===t&&n<="XFD")&&e<=g.MAX_ROW_COUNT}function he(e){var e=e.join("").toUpperCase();return!!("RC"===e||"C"===e||"R"===e||W.test(e)||Z.test(e)&&ce(e))}function le(e,t,n){if(!t||0===t.length)return[];var r=t,i;if(ue(t,!1,e.lyt)||n&&ue(n,!1,e.lyt)){for(r=["'"],i=0;i<t.length;i++)"'"===t[i]&&r.push("'"),r.push(t[i]);if(n)for(r.push(":"),i=0;i<n.length;i++)"'"===n[i]&&r.push("'"),r.push(n[i]);r.push("'")}else if(n)for(r.push(":"),i=0;i<n.length;i++)r.push(n[i]);return r}function d(){return null!==o&&o.apply(this,arguments)||this}t=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Object.defineProperty(C,"__esModule",{value:!0}),C.DefaultTokenResolver=C.Mge=C.Cmt=C.ParserContext=C.Parser=C.TokenResolver=C.FormulaToken=C.isNumber=C.Jkt=C.Swt=C.isDigit=C.isActualFalse=C.isActualTrue=C.operaterTypesMap=C.preOperaterTypesMap=C.Z9t=void 0,f=e("Common"),g=e("./src/calc.common.ts"),v="[",p="]",A=void 0,b=null,y="string",I="boolean",S="TRUE",R="FALSE",N="ARRAY",E=f.Common.zf,e=f.Common.lt,T=e.ht,G="Exp_FormulaInvalidChar",q="Exp_FormulaInvalid",j="Exp_NoSyntax",C.Z9t=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," ","."],C.preOperaterTypesMap={"+":0,"-":1},C.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},c={":":0," ":1,".":2,"^":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},O=".",L=";",M=D=",",n=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],C.isActualTrue=w,C.isActualFalse=x,C.isDigit=U,C.Swt=Q,C.Jkt=$,C.isNumber=ee,F=[].push,u.prototype.type=function(){return this.uit},u.prototype.subType=function(){return this.Twt},u.prototype.stringValue=function(){return this.Awt},B=u,C.FormulaToken=B,s.prototype.resolveToken=function(e,t,n,r,i){return 0},s.prototype.unparse=function(e,t,n,r){return!0},C.TokenResolver=e=s,h.prototype.setParserOption=function(e){var t,n;e!==A&&f.Common.CultureManager.Fe()?(n=("object"==typeof e&&e.NumberFormat?e:f.Common.CultureManager.Fe()).NumberFormat,t=e?n:{}):n=t={},D=h.listSeparator=t.listSeparator||",",O=t.numberDecimalSeparator||".",!e&&h.numberDecimalSeparator||(h.numberGroupSeparator=n.numberGroupSeparator||",",h.numberDecimalSeparator=n.numberDecimalSeparator||"."),L=h.arrayGroupSeparator=t.arrayGroupSeparator||";",M=h.arrayListSeparator=t.arrayListSeparator||","},h.prototype.parseDotOperator=function(e,t,n){var r,i,o,a,u,o,r=t[n];if(!(t[n-1]&&"#"===t[n-1].y4&&"."!==r.Awt[0]||t[n+1]&&":"===t[n+1].y4||0!==r.uit||0!==r.Twt||(0,g.W9t)(e.source,r.Awt)||!(0<=(i=r.Awt.lastIndexOf("."))))){if(0<=(o=r.Awt.substring(i+1)).indexOf("]"))return 0;if(a=new B(r.Awt.substring(0,i).split(""),0,r.lp,r.lp+i-1),u=new B(["."],5,r.lp+i,r.lp+i),(o=new B(o.split(""),0,r.lp+i+1,r.ywt)).Q9t=!0,i===r.Awt.length-1)return 0===i?t.splice(n,1,u):t.splice(n,1,a,u),1+this.parseDotOperator(e,t,n);if(0<i)return t.splice(n,1,a,u,o),2+this.parseDotOperator(e,t,n);if(0===i)return t.splice(n,1,u,o),1}return 0},h.prototype.parse=function(e,t){var t,n,r;if(t=(0,g.Fve)(t),this.setParserOption(e.culture),t=t.split(""),this.J9t=t,e.X9t=!1,n=this.parseToTokens(e,t,!e.ignoreError),e.source&&!e.source.skipDotOperator&&e.X9t)for(r=0;r<n.length;r++)r+=this.parseDotOperator(e,n,r);return this.buildExpressionTree(e,n,!e.ignoreError)},h.prototype.unparse=function(e,t,n){return void 0===n&&(n=[]),this.setParserOption(e.culture),this.q9t(e,t,n),n.join("")},h.prototype.q9t=function(e,t,n){var r,i;if(t)for(!t.$9t||e.lyt||e.Nme||n.push("@"),r=e.getResolvers(),i=0;i<r.length&&!r[i].unparse(e,this,t,n);i++);},h.prototype.parseToTokens=function(i,e,t){var n,r,o,a,u,s,f,c,h,l,d,m,v,p,b,T,y,g,y,A,E,_,w,x,I,I,S,S,R,R;for(void 0===t&&(t=!0),n=this,r=function(e,t,n,r){return 0<t.length&&(0<=t.indexOf(".")&&(i.X9t=!0),e.push(new B(t,0,n,r))),[]},o=e.length,a=[],u=[],s=-1,f=[],l=0;l<o&&" "===e[l];)l++;for("="===e[l]&&l++,v=h=l;v<o;v++)if(T=void 0,64===(b=(p=e[v]).charCodeAt(0)))f=r(a,f,h),a.push(new B(e[v],4,v,v)),h=v+1;else if(97<=b&&b<=122||65<=b&&b<=90)f.push(p);else if(34===b)0<f.length&&(f=r(a,f,h)),(T=k(e,v,'"','"',"",t))?(y=new B(T.result,0,v,T.endIndex,3),T.skipCount&&(y.Ewt=e.slice(v,T.endIndex+1).join(""),y.ywt+=T.skipCount),a.push(y),h=(v=T.endIndex)+1):(H(f,e.slice(v,o)),v=o-1);else if(39===b)if(T=k(e,v,"'","'","",t)){if(0<f.length&&(f=r(a,f,h),h=v),g=[],-1<(y=T.result.join("")).indexOf(":")&&-1===y.indexOf("["))for(E=(A=y.split(":")).length,_=0;_<E;_++)w="'"+A[_]+"'",x=h+A[_].length-1,0===_?x++:_===E-1&&(x=T.endIndex),f=r(g,w.split(""),h,x),h=x+1,_!==E-1&&(g.push(new B(":",5,h,h,11)),h++);g&&0<g.length?H(a,g):(f.push("'"),H(f,T.result),f.push("'")),v=T.endIndex}else f.push("'"),v=o-1;else if(91===b)(T=k(e,v,"[","]","'",t))?(f.push("["),H(f,T.result),f.push("]"),v=T.endIndex):n._isR1C1&&0===f.length&&("R"===f[0]||"r"===f[0]||"C"===f[0]||"c"===f[0])||(H(f,e.slice(v,o)),v=o-1);else if(13!==b&&10!==b)if(35===b)h=(I=te(e,v))?(a.push(new B(I.result,0,v,v+I.result.length-1,6)),(v=I.endIndex)+1):(f=r(a,f,h),a.push(new B(e[v],6,v,v)),v+1);else if(33===b)f.length,0<(I=a.length)&&0===a[I-1].uit?(S=a[I-1],F.apply(S.y4,f),a[I-1]=new B(S.y4,0,S.lp,v,12)):a.push(new B(f,0,h,v,12)),f=[],h=v+1;else if(43===b||45===b)S=0===a.length?null:a[a.length-1],h=(0!==f.length?(f=r(a,f,h),a.push(new B(p,5,v))):(S&&7===S.uit&&a.pop(),!S||2!==S.Twt&&6!==S.uit&&0!==S.uit?a.push(new B(p,4,v)):a.push(new B(p,5,v))),v+1);else if(p===O||U(b))!(0<f.length)&&(R=re(e,v,O)).num?(d=R.endIndex,R=R.num,h=d<=o-2&&"!"===e[d+1]?(H(f,R),d):(a.push(new B(R,0,v,d,4)),d+1),v=d):f.push(p);else if(123===b)0<f.length&&(t?P(p,v):f=r(a,f,h)),c=new B(N,1,v,v,1),a.push(c),u[++s]=c,h=v+1;else if(p===L&&0<=s&&u[s].value===N)f=r(a,f,h),s<0&&t&&P(p,v),a.push(new B(L,3,v,v)),h=v+1;else if(125===b)f=r(a,f,h),d<0&&t&&P(p,v),m=u[s],s--,m=new B(p,m.uit,v,v,2),a.push(m),h=v+1;else if(32===b)f=r(a,f,h),h=v+1;else if(p===D||p===M||p===L)f=r(a,f,h),s<0||1!==u[s].uit?a.push(new B(D,5,v,v,10)):a.push(new B(p,3,v,v)),h=v+1;else if(37===b)f=r(a,f,h),a.push(new B(e[v],6,v,v)),h=v+1;else if(v+2<=o&&C.operaterTypesMap[p+e[v+1]])f=r(a,f,h),a.push(new B(e.slice(v,v+2),5,v,v+1,5)),h=++v+1;else if(C.operaterTypesMap[p])f=r(a,f,h),a.push(new B(p,5,v,v)),h=v+1;else if("("===p)0<f.length?(c=new B(f,1,h,v,1),f=[]):c=new B(p,2,v,v,1),a.push(c),u[++s]=c,h=v+1;else if(")"===p)f=r(a,f,h),h=(s<0?(t&&P(p,v),r(a,p,v)):(m=u[s],s--,m=new B(p,m.uit,v,v,2),a.push(m)),v+1);else if(":"===p)f=r(a,f,h),a.push(new B(p,5,v,v,11)),h=v+1;else if("\r"!==p&&"\n"!==p){if("\\"===p){if(o<=++v){t&&P(p,v);continue}f.push(p),p=e[v]}f.push(p)}return r(a,f,h),a},h.prototype.buildExpressionTree=function(e,t,n){var r,t,r,t,i;return this.tDt(t),r=e.keepUnknownFormulas,e.nDt=!1,t=this.eDt(e,t,n),r&&(0===t.length||ie(t))?b:(r=this.iDt(e,t,n),n&&(r||_(),this.rDt(r,e)),e.nDt&&this.oDt(r,new g.LocalScopes,!1,!1,e,n),!(i=(t=e.source)&&t.G3)&&r&&(r.lMt=!0),r)},h.prototype.rDt=function(e,t){for(var n,r,i,o,a,u,s;10===e.type;)e=e.value;if(n=this,9===e.type)e.value||_(),n.rDt(e.value,t),e.value2?n.rDt(e.value2,t):3<e.operatorType&&_();else if(7===e.type)if(i=(r=e.arguments).length,o=e.function,(0,g.isExpression)(o))this.rDt(o,t);else for(a=!1!==t.Hve,o&&a&&o.aDt(o.minArgs,o.maxArgs,i,r),u=0;u<i;u++)s=r[u],o&&a?o.uDt(s,u):(0,g.sDt)(s,u),n.rDt(s,t);else 8!==e.type||!t.Mf||f.Common.$T.qT("^[A-Za-z_\\@\\\\\xa1\xa4\xa7\xa8\xaa\\u00AD\\u00AF-\\u00BA\\u00BC-\\uFFFF][A-Za-z0-9_\\.\\@\\\\\\?\\#\xa1\xa4\xa7\xa8\xaa\\u00AD\\u00AF-\\u00BA\\u00BC-\\uFFFF]*$").test(e.value)||"["===e.value[0]||_()},h.prototype.iDt=function(e,t,n){for(var r,i,o,a,u,s,f,r=this.cDt(e,t,n),u=3;u<r.length;)if(s=r[u],9!==(f=r[u-2]).type&&n&&_(),s&&9===s.type){for(;3<=u&&c[s.value]>=c[f.value];)o=r[u-3],a=r[u-1],i=(0,g.rbt)(f.operatorType,o,a),r.splice(u-3,3,i),3<=(u-=2)&&(f=r[u-2]);u+=2}else u++;if(1===r.length)return r[0];for(u=r.length-2;0<u;u-=2)o=r[u-1],a=r[u+1],9!==r[u].type&&n&&_(),i=(0,g.rbt)(r[u].operatorType,o,a),r.splice(u-1,3,i);return i},h.prototype.fDt=function(e,t,n){var r,i,o,a,u,s,f,c;if(!e||e.length<=0)return e;for(o=[],a=[],u=(r=e)[r.length-1],s=i=0;s<=r.length;s++)f=r[s],s===r.length||n(f)?(i===s?(c=(f||u).ywt,o.push((0,g.xde)(c,c))):o.push(this.iDt(t,a)),i=s+1,a=[]):a.push(f);return o},h.prototype.cDt=function(e,t,n){for(var r,i,o,a,u,s,f,c,h,l,d,m,v,r=[],i=(t=Array.isArray(t)?t:[t]).length,o=0;o<i;o++){if(10===(u=a=t[o]).type){if((s=0<r.length?r[r.length-1]:A)&&7===s.type){f=this.fDt(a.value,e,function(e){return e.value===D}),r[r.length-1]=(0,g.lDt)(s,f,s.lit,a.ywt);continue}a.value=this.iDt(e,a.value),u=a}else 7===a.type&&(a.arguments=this.fDt(a.arguments,e,c=function(e){return 0===e.type&&e.value===D}));r.push(u)}for(t=r,r=[],i=t.length,o=0;o<i;o++){if(9===(u=a=t[o]).type)if(0===a.operatorType||1===a.operatorType)if(o===i-1)n&&_();else{for(h=o;!T(t[h])&&9===t[h].type&&t[h].operatorType<=1;)h++;if(T(t[h])){if(!n)return;_()}for(l=t[h],d=h-1;o<=d;d--)l=u=(0,g.rbt)(t[d].operatorType,l);u=l,o=h}else if(2===a.operatorType){if(0!==o){u=(0,g.rbt)(a.operatorType,r[r.length-1]),r[r.length-1]=u;continue}n&&_()}else if("#"===a.value){if(0!==o){if(t[o+1]&&8===t[o+1].type&&8===r[r.length-1].type){r[r.length-1].value+="#"+t[o+1].value,o++;continue}m=e.getFunction("ANCHORARRAY"),u=(0,g.YJ)(m,[r[r.length-1]],a.lit),r[r.length-1]=u;continue}n&&_()}else if("@"===a.value){if(t[o+1]&&9!==t[o+1].type){m=e.getFunction("@"),u=(0,g.YJ)(m,[t[o+1]],a.lit),!1===(v=e.source&&e.source.Lbt&&e.source.Lbt.allowDynamicArray)&&(7===t[o+1].type?u=t[o+1]:u.function=A),r[r.length]=u,o++;continue}u.type=8}r.push(u)}return r},h.prototype.eDt=function(e,t,n){for(var r,i,o,r=[],i=0,o=t.length;i<o;)i=this.resolveToken(e,t,r,i,n);return r},h.prototype.addDynamicCell=function(e){var t,n,t=e.source&&e.source.getCalcService&&e.source.getCalcService();t&&(t.tMt||(t.tMt={}),n=e.source.id+","+e.row+","+e.column,t.tMt[n]={id:e.source.id,row:e.row,col:e.column})},h.prototype.resolveToken=function(e,t,n,r,i){for(var o,a,u,s,f,c,s,s,c,s,o=t[r],a=e.getResolvers(),u=0;u<a.length;u++)if(s=a[u].resolveToken(e,this,t,r,i)){c=r-1,(f=s.expr)&&s.index!==A?r=s.index-1:f=s,o.Q9t&&(f.hDt=o.Awt),(s=0<n.length?n[n.length-1]:b)&&ne(f)&&(ne(s)||"#"===s.value)&&(s=t[c].ywt)<o.lp-1&&(c=(0,g.rbt)(17," "),e.Jde&&oe(c,s+1,o.lp),n.push(c)),(15===f.operatorType||f.function&&f.function.haveDynamicListener)&&this.addDynamicCell(e),e.Jde&&(s=t[Math.min(r,t.length-1)],oe(f,o.lp,s.ywt+1)),n.push(f);break}return r+1},h.prototype.resolveSubTokens=function(e,t,n,r,i){for(var o=[];n<t.length&&2!==t[n].Twt;)if(n=this.resolveToken(e,t,o,n,r),i){n--;break}return{exprs:o,index:n+1}},h.prototype.tDt=function(e){e.forEach(function(e){1===e.uit&&e.Awt!==N&&(e.Awt=e.Awt.toUpperCase())})},h.prototype.dDt=function(e,t,n){9===e.type&&18===e.operatorType&&(e.value=n||this.unparse(t,e),e.type=8,delete e.operatorType)},h.prototype.oDt=function(e,t,n,r,i,o){var a,u,u,s,f,c,h;if(e)if(Array.isArray(e))for(a=0;a<e.length;a++)this.oDt(e[a],t,n,r,i,o);else if(9===e.type&&18===e.operatorType&&(u=this.unparse(i,e),t.hasVariable(u))&&this.dDt(e,i,u),8===e.type)t.hasVariable(e.value)&&(e.type=100,e.vDt=n,e.mDt=r,e.value=t.getVariable(e.value),o||(e.value=e.value.replace(/\./g,"_")));else if(7===e.type){if(u=e.functionName,s=e.function,f=e.arguments,"LET"===u){for(t.enterScope(),c=f.length-1,a=0;a<c;a+=2){if(h=f[a],this.dDt(h,i),8!==h.type)return;this.oDt(f[a+1],t,n,r,i,o),t.setVariable(h.value,h.value),this.oDt(h,t,n,r,i,o)}this.oDt(f[c],t,n,r,i,o),t.exitScope()}else if("LAMBDA"===u){for(t.enterScope(),c=f.length-1,a=0;a<c;a++){if(8!==(h=f[a]).type)return;ae(h),t.setVariable(h.value,h.value),this.oDt(h,t,n,r,i,o)}this.oDt(f[c],t,n,r,i,o),t.exitScope()}else for(a=0;a<f.length;a++)n=(0,g.getFunctionAcceptsArray)(s,a),r=(0,g.getFunctionAcceptsReference)(s,a),this.oDt(f[a],t,n,r,i,o);(0,g.isExpression)(s)&&this.oDt(s,t,n,r,i,o),u&&t.hasVariable(u)&&(e.isLocalFunctionName=!0,e.functionName=t.getVariable(u))}else 9===e.type&&(n=r=(0,g.gDt)(e.operatorType)),this.oDt(e.value,t,n,r,i,o),this.oDt(e.value2,t,n,r,i,o)},C.Parser=h,l.prototype.getExternalSource=function(e,t){for(var n,r,i,n,r=this.source.getCalcService().getAllSourceModels(),i=0;i<r.length;i++)if(E.Dbt(r[i].getSource().getName(),t))return r[i].getSource();return b},l.prototype.getExternalSourceToken=function(e){return e.getName()},l.prototype.setSource=function(e){this.source=e},l.prototype.getResolvers=function(){var e=(this.source||this.Mf).getCalcService();return e&&e.getResolvers()},l.prototype.addResolver=function(e){var t=(this.source||this.Mf).getCalcService();t&&t.addResolver(e)},l.prototype.getFunction=function(e){var t,n,r,t=e,n=(0,g.getMapping)()&&(0,g.getMapping)().builtInFunctionsMapping;if(!T(n))for(r in n)n[r].alias===e&&(t=r);return this.source&&this.source.getCustomFunction(t)||g.Functions.findGlobalFunction(e)},r=l,C.ParserContext=r,g.CalcSource.prototype.getParserContext=function(e,t,n){return new r(this,e,t,n)},K={"'":1,"[":1,"]":1,"?":1,"%":1," ":1},Y=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/,X={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0,",":!0,"`":!0,"+":!0,"~":!0,"\uff01":!0,"":!0,"\u3001":!0,"\uff5d":!0,"\uff5b":!0,"\u3010":!0,"\u3011":!0,"-":!0,"\uff1b":!0,"\uff1a":!0,"\u2018":!0,"\u201c":!0,"\u201d":!0,"\u2019":!0,"\uff0c":!0,"\u3002":!0,"=":!0},C.Cmt=fe,W=/^(R|C|RC)?(0*[1-9]\d*)/,Z=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,C.Mge=le,t(d,o=e),d.prototype.resolveToken=function(e,t,n,r,i){var o,a,u,s,f,c,h,l,d,m,v,m,p,b,T,y,m,m,m,o=n[r],a=o.Awt,u=o.y4,c=o.uit,h=null,m=o.Twt,v=e.source&&e.source.Lbt&&e.source.Lbt.allowDynamicArray;if(0===c&&12===m){if(m=void 0,r++,(m=a&&"'"===(m=a).charAt(0)?m.substring(1,m.length-1):m)&&(h=e.getExternalSource("",m)),!(o=n[r]))return(s=new g.Expression(8)).value=a,s;a=o.Awt,c=o.uit}if(0===c)0===o.Twt?w(l=a.toUpperCase())||x(l)?(o.Twt=5,o.Awt=l,(s=new g.Expression(4)).value=w(l)):(s=new g.Expression(8)).value=a:4===o.Twt?((s=new g.Expression(2)).value=parseFloat(a),s.originalValue=a):3===o.Twt?(s=new g.Expression(3)).value=a:5===o.Twt?(s=new g.Expression(4)).value=w(a):6===o.Twt?(s=new g.Expression(5)).value=g.CalcError.parse(a):7===o.Twt&&((s=new g.Expression(8)).value=a);else if(1===c){if(a===N){for(s=new g.Expression(6),r++,l=[[]],b=p=f=0;r<n.length&&2!==n[r].Twt;){if(o=n[r],r<n.length-1&&4===o.uit&&"-"===o.Awt&&4===n[r+1].Twt&&((o=n[++r]).y4.unshift("-"),o.Awt="-"+o.Awt),3===o.uit){if(o.Awt===L){if(p!==b)throw E.I5((0,g.sR)().Exp_InvalidArrayColumns,[o.lp]);l.push([]),f++,b=0}}else{if(0!==o.uit||4!==o.Twt&&3!==o.Twt&&5!==o.Twt&&6!==o.Twt)throw(0,g.sR)().Exp_InvalidArray;y=T=o.Awt,4===o.Twt?y=parseFloat(T):5===o.Twt?y="TRUE"===T.toUpperCase():6===o.Twt&&(y=g.CalcError.parse(T)),l[f].push(y),0===f&&p++,b++}r++}if(p!==b)throw E.I5((0,g.sR)().Exp_InvalidArrayColumns,[o.lp]);return r++,s.value=new g.CalcArray(l),{expr:s,index:r}}if(0<u.length)return"SINGLE"===a&&(m=e.source)&&m.G3&&(a="@"),"LET"!==((s=new g.Expression(7)).functionName=a)&&"LAMBDA"!==a||(e.nDt=!0),m=e.getFunction(s.functionName)||g.Functions.findGlobalFunction(s.functionName),!1===v&&m&&!0===m.isDynamicArrayFunction&&(m=A),s.function=m,h&&(s.source=h),(d=t.resolveSubTokens(e,n,r+1,void 0,"@"===u[0]&&v))?(s.arguments=d.exprs,{expr:s,index:d.index}):(s.arguments=[],s)}else if(4===c)s=(0,g.rbt)(C.preOperaterTypesMap[a],a);else if(6===c||5===c)m=C.operaterTypesMap[a],s=(0,g.rbt)(m="."===a?18:m,a);else if(2===c){if(s=new g.Expression(10),d=t.resolveSubTokens(e,n,r+1))return s.value=d.exprs,{expr:s,index:d.index};i&&_()}else 3===c&&((s=new g.Expression(0)).value=a);return h&&s&&(s.source=h,s={expr:s,index:r+1}),s},d.prototype.unparse=function(e,t,n,r){var i,o,a,u,s,f,c,h,l,d,o,m,m,m,i=this;if(3===n.type)r.push('"'),r.push(E.Vi(n.value,'"','""')),r.push('"');else if(2===n.type)o=n.originalValue||n.value.toString(),"."!==O&&(o=o.replace(".",O)),r.push(o);else if(4===n.type)r.push(n.value?(0,g.getBoolean)().boolean_true:(0,g.getBoolean)().boolean_false);else if(6===n.type){if(r.push("{"),(a=n.value).getRowCount()<=0)throw(0,g.sR)().Exp_InvalidArray;for(u=0,s=a.getRowCount();u<s;u++)for(1<=u&&r.push(L),f=0,c=a.getColumnCount();f<c;f++){if(0!==f&&r.push(M),(h=a.getValue(u,f))===A||h===b)throw(0,g.sR)().Exp_InvalidArray;(l=typeof h)==y?(r.push('"'),r.push(E.Vi(h,'"','""')),r.push('"')):l==I?r.push(h?(0,g.getBoolean)().boolean_true:(0,g.getBoolean)().boolean_false):"number"==l&&"."!==O?r.push(h.toString().replace(".",O)):r.push(h.toString())}r.push("}")}else if(5===n.type)r.push(n.value.toString());else if(9===n.type)i.bDt(e,t,n,r);else if(10===n.type)r.push("("),t.q9t(e,n.value,r),r.push(")");else if(7===n.type)n.source&&!(d=this.unparseSource(e,r,n.source,n.endSource))&&r.push("#","R","E","F","!"),"ANCHORARRAY"!==(o=(0,g.isFunction)(n.function)&&n.function.name||n.functionName)||e.lyt?"@"!==o||e.lyt?(!n.functionName&&(0,g.isExpression)(n.function)?i.unparse(e,t,n.function,r):("@"===(o=n.isLocalFunctionName&&e.lyt?g.XLPMPrefix+o:o)&&(o="SINGLE"),H(r,(o=(m=(m=(0,g.getMapping)()&&(0,g.getMapping)().builtInFunctionsMapping)&&m[o])&&m.alias?m.alias:o).split(""))),r.push("("),i.unparseArguments(e,t,n,r),r.push(")")):(e.Nme||r.push("@"),t.q9t(e,n.arguments[0],r)):(t.q9t(e,n.arguments[0],r),r.push("#"));else{if(1===n.type||8===n.type)return i.unparseRefenceExpressions(e,t,n,r),!0;if(100!==n.type)return!1;m=n.value,H(r,(m=e.lyt?(n.Bve?g.XLOPPrefix:g.XLPMPrefix)+m:n.Bve?v+m+p:m).split(""))}return!0},d.prototype.unparseArguments=function(e,t,n,r){for(var i=0;i<n.arguments.length;i++)0!==i&&r.push(D),t.q9t(e,n.arguments[i],r)},d.prototype.unparseSource=function(e,t,n,r){if(e.getExternalSourceToken){if(n){var n=le(e,e.getExternalSourceToken(n).split(""),r&&e.getExternalSourceToken(r).split(""));if(!(0<n.length))return!1;F.apply(t,n)}return t.push("!"),!0}return!1},d.prototype.unparseRefenceExpressions=function(e,t,n,r){var i;if(n.source&&!this.unparseSource(e,r,n.source,n.endSource))return void r.push("#","R","E","F","!");8===n.type&&r.push(n.value)},d.prototype.bDt=function(e,t,n,r){var i,o,i=n.operatorType;2===i?(t.q9t(e,n.value,r),r.push("%")):0===i||1===i?(r.push(C.Z9t[i]),t.q9t(e,n.value,r)):18===i?(t.q9t(e,n.value,r),r.push(C.Z9t[i]),n.value2&&n.value2.yDt?r.push(n.value2.value):t.q9t(e,n.value2,r)):(t.q9t(e,n.value,r),o=C.Z9t[i],16===i&&(o=D),r.push(o),t.q9t(e,n.value2,r))},C.DefaultTokenResolver=d},"./src/calc.common.ts":function(N,O,e){var P,U,g,t,k,H,A,G,E,q,j,V,K,Y,X,W,Z,z,J,Q,$,ee,te,ne,re,D,a,L,_,ie,oe,w,d,ae,M,e,ue,se,fe,x,p,s,ce,he,le,de,me,n,ve,m,u,F,pe,I,be,Te,ye,ge,Ae,Ee,_e,B,we,f,xe,e,Ie,Se,Re,Ce,Ne,Oe,De,Le,t,v,Me,Fe,Be,Pe,Ue,ke,He,Ge,S,qe,je,Ve,Ke,Ye,Xe,We,Ze,ze,Je,n,Qe,$e,et;function tt(e){return e&&e.toUpperCase()}function nt(e){var t,n;if(e){if(7===e.type&&("SUBTOTAL"===e.functionName||"AGGREGATE"===e.functionName))return!0;for(t=e.arguments&&e.arguments.length,n=0;n<t;n++)if(nt(e.arguments[n]))return!0;if(nt(e.value)||nt(e.value2))return!0}return!1}function rt(e,t){var n,e,n=e&&e.getCustomNameInfo&&e.getCustomNameInfo(t);return n=!n&&e?(e=e.op().getGlobalSourceModel())&&e.getSource().getCustomNameInfo(t):n}function it(e){return 15===e||16===e||17===e}function ot(e){return e=-1<(e=-1<e.indexOf(O.XLPMPrefix)?e.replace(/_xlpm\./g,""):e).indexOf(O.XLOPPrefix)?e.replace(/_xlop\.([a-zA-Z0-9_]+)/g,"[$1]"):e}function at(e){var e=String(e&&e.message),e;return"maximum call stack size exceeded"===(e=e.toLowerCase())||"too much recursion"===e||"out of stack space"===e}function r(e,t){if(D(t)){var n=r.CDt(e);if(!n)throw(0,O.sR)().Exp_NotSupported;this._error=n.error,this._code=n.code}else this._error=e,this._code=t}function ut(e){return isNaN(e)||!isFinite(e)}function b(e,t){var n,r,i,o,a,u,s,f,c,h,l,d,m,v,p,b,T,y;if(!e)return!(t.value=0);r=typeof e;try{if(r===A)n=e;else if(r===G){if(/[\f\n\r\t\v]/.test(e))return!1;if(0===(e=(i=e).trim()).length)return!(t.value=0);if(a=(o=g.Common.CultureManager.Fe().NumberFormat).numberDecimalSeparator,u=o.numberGroupSeparator,"."!==a&&"."!==u&&0<=e.indexOf(".")||","!==a&&","!==u&&0<=e.indexOf(","))return!1;if(f=s=!1,c=e[0],h=e[e.length-1],"("===e[0]&&")"===h){if(f=!0,"+"===(c=(e=e.substring(1,e.length-1).trim())[0])||"-"===c)return!1;h=e[e.length-1]}if("%"===c?(s=!0,e=e.substring(1)):"%"===h?(s=!0,e=e.substring(0,e.length-1)):"$"===c&&(e=e.substring(1)),""===e)return!1;if(0<=e.indexOf(u)&&(l=_.qT("^\\ *[\\+|\\-]?\\ *\\d+(\\"+u+"\\d{3,})+(\\"+a+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$"),d=_.qT("^0+\\"+u),l.test(e))&&!d.test(e)&&(e=e.replace(_.qT("[ \\"+u+"]"),"")),(m=_.qT("^\\d+(\\-\\d+)+$")).test(e)&&!(v=_.qT("^(((0?[1-9]|10|11|12)-(\\d{1,2}|[2-9]\\d{3}|19\\d{2}))|((0?[1-9]|10|11|12)-((0|1|2)?[\\d]|30|31)-(\\d{1,2}|[2-9]\\d{3}|19\\d{2}))|(([2-9]\\d{3}|19\\d{2})-(0?[1-9]|10|11|12)-((0|1|2)?[\\d]|30|31)))$")).test(e))return!1;if(" "===(e=e.trim())[1]&&("+"===e[0]?e=e.replace(/^\+ +/,"+"):"-"===e[0]&&(e=e.replace(/^\- +/,"-"))),(e="."!==a?e.replace(a,"."):e).indexOf(a)!==e.lastIndexOf(a))return!1;if(2<=e.length&&"0"===e[0]&&"x"===e[1])return!1;if(n=Number(e).valueOf(),s&&(n/=100),ut(n=f?-n:n)){if(!(97<=(p=(e=i.trim()).charCodeAt(0))&&p<=122||48<=p&&p<=57||65<=p&&p<=90))return!1;if(p|=32,4<e.length&&97<=p&&p<=122&&(b=(b=e[0]+e[1]+e[2]).toUpperCase(),!ge[b]))return!1;if(c=e[0],h=e[e.length-1],"/"===c||"-"===c||":"===c||"/"===h||"-"===h)return!1;if((l=_.qT("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,\\z\\Z]")).test(e))return!1;if((l=_.qT("(^[a-zA-Z]{1,2}(\\/|\\s|\\-))|(^\\d+\\s+\\d+$)")).test(e))return!1;if((y=(T=g.Common.CultureManager.getCultureInfo())&&T.DateTimeFormat&&T.DateTimeFormat.shortDatePattern)&&y.indexOf("d")<y.indexOf("M")?n=g.Common.ct.yU(e):ut((n=new Date(e+" 00:00:00")).valueOf())&&(n=new Date(e)),ut(n.valueOf()))return!1;n=w.o0(n)}}else if(r===E)n=e?1:0;else{if(!(e instanceof Date))return!1;n=w.o0(e)}}catch(e){return!1}return t.value=n,!0}function st(e){var t={value:0};if(b(e,t))return t.value;throw(0,O.sR)().Exp_InvalidCast}function ft(e,t){return t&&(e===x||e===p||typeof e===G&&""===e.trim())}function ct(e,t){try{if(e){if(typeof e!==E)if(e instanceof Date)e=0!==w.o0(e);else{if(!mt(e))return!1;e=0!==e}}else e=!1}catch(e){return!1}return t.value=e,!0}function ht(e,t,n,r,i){var o,a,u;if(!T(e)){if(o={value:x},a=ve,0!==t&&ft(e,r))return a;switch(t){case 1:case 5:if(n&&5!==t){if(typeof e===E&&i)return a;e=b(e,o)?o.value:a}else typeof e!==A&&(e=e instanceof Date?w.o0(e):a);break;case 11:e=b(e,o)?o.value:a;break;case 4:typeof e===G?e=(u=g.Common.ct.yU(e))!==p&&u!==x?w.o0(u):a:n?e=b(e,o)?o.value:a:typeof e===A||e instanceof Date||(e=a);break;case 3:n?e=b(e,o)?o.value:a:typeof e!==E&&(e=a);break;case 2:e=e===x||e===p?"":e.toString()}}return e}function lt(e,t){this.array=e,this.referenceInTwoDimension=t}function dt(){return null!==Le&&Le.apply(this,arguments)||this}function mt(e,t){var n=typeof e;return n===A||n===V&&e instanceof Date||!t&&(n===E||!isNaN(e)&&!isNaN(parseFloat(e))&&!ne.Nh(e))}function T(e){return e instanceof m}function vt(e){return e instanceof Ae}function pt(e){return e instanceof xe}function y(){}function bt(e){this.type=e}function c(e,t){var n=this;n.rT=e,t?(n.$gt=t,n.SDt=t.length):n.SDt=1}function i(e){this.id=i.sourceId,i.sourceId++,this.Lbt=e,this.Mbt=null}function Tt(e,t,n){var r=new f(5);return t&&(r.source=t),n&&(r.endSource=n),r.value=e,r}function yt(e,t,n,r){var i=new f(7);return i.arguments=t,e instanceof f?(i.function=e.function,i.functionName=e.functionName,i.source=e.source,(n=n===p?e.lit:n)===p&&(r=e.ywt)):(i.function=e.name&&e,i.functionName=e.name||e),Rt(i,n,r=t&&0<t.length&&r===p?t[t.length-1].ywt:r),i}function gt(e,t,n,r){var i=new f(7);return i.arguments=t,i.function=e,Rt(i,n,r),i}function At(e,t){var n=new f(12);return n.value=e,n.needExpendIndexs=t,n}function Et(e,t,n,r,i){var o=new f(9);return o.operatorType=e,o.value=t,18===e&&n&&n.hDt&&((n=xt(n.hDt,n.lit,n.ywt)).yDt=!0),o.value2=n,r===p&&Nn(t)&&(r=t.lit),i===p&&(Nn(n)?i=n.ywt:Nn(t)&&(i=t.ywt)),Rt(o,r,i),o}function _t(e){var t=new f(10);return t.value=e,t}function wt(e,t){var n=new f(11);return Rt(n,e,t),n}function xt(e,t,n){var r=new f(3);return r.value=e,Rt(r,t,n),r}function It(e){var t=new f(2);return t.value=e,t}function St(e){var t=new f(4);return t.value=e,t}function Rt(e,t,n){t!==p&&(e.lit=t),n!==p&&(e.ywt=n)}function Ct(){}function l(e,t){return e.charAt(t)}function Nt(e,t){for(var n=e.length,r=!1;t<n&&!isNaN(+l(e,t));)t++,r=!0;for(t<n&&"."===l(e,t)&&t++;t<n&&!isNaN(+l(e,t));)t++,r=!0;if(t<n&&("E"===l(e,t)||"e"===l(e,t)))for(r=!1,++t<n&&("+"===l(e,t)||"-"===l(e,t))&&t++;t<n&&!isNaN(+l(e,t));)t++,r=!0;return{TDt:r,lp:t}}function Ot(e){return"string"==typeof e}function Dt(e){this.ADt=e}function Lt(e,t){if(!e||8===e.type&&0<=e.value.indexOf("'"))throw(0,O.sR)().Exp_FormulaInvalid}function o(){this.context=[{}],this.closure={},this.backupClosure=[]}function h(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=0),this.name=e,this.minArgs=t,this.maxArgs=n;var e=this;e.IDt=r,e.typeName=""}function Mt(e,t,n,r){return Qe.call(this,e,t,n,r)||this}function Ft(e,t){for(var n,e,r,e,i,o,n=$e.call(this,"LAMBDA")||this,e=e.arguments,r=e.slice(0,e.length-1),e=e[e.length-1],i=r.length,o=0;o<r.length;o++)if(r[o].Bve){i=o;break}return n.minArgs=i,n.maxArgs=r.length,n.parameters=r,n.calculation=e,n.closure=t,n}function Bt(e,t){return t.name=tt(t.name),v.Tmt[tt(e)]=t}function Pt(e){var t,n,r;return e?(e=tt(e),t=v.Mmt,n=v.Tmt,r=(0,O.getMapping)()&&(0,O.getMapping)().builtInFunctionsMapping,t&&(Gt(r,e)||t[e])||n&&n[e]):Ht()}function Ut(){return Ht()}function kt(e){var t,n;e?(e=tt(e),t=v.Mmt,n=v.Tmt,t[e]?delete t[e]:n[e]&&delete n[e]):(v.Mmt={},v.Tmt={})}function Ht(){var e,t,n,r,i,e=v.Mmt,t=v.Tmt,n=[];for(r in e)n.push(e[r]);for(i in t)n.push(t[i]);return n}function Gt(e,t){var n,r,n=v.Mmt;if(!D(e))for(r in e)if(e[r].alias===t)return n[r];return p}function qt(e,t,n){this.okt=e,this.akt=t,this.mit=n||"i"}function jt(e){function t(e){var t,n,r,i,o,a,u,s,f,c,h,t=0,n=0,r=!1,u=0,s=0,f=0,c=e.length;if(!e)throw(0,O.sR)().Exp_ArgumentNull;if(0===c)throw Ue;if(f<c&&("+"===l(e,f)||"-"===l(e,f))&&f++,f=(h=Nt(e,f)).lp,i=h.TDt,f<c&&("+"===l(e,f)||"-"===l(e,f))?(u=f,f=(h=Nt(e,++f)).lp,o=h.TDt,f<c&&("i"===l(e,f)||"j"===l(e,f))&&(a=l(e,f),f++,r=!0),s=f-u):f<c&&("i"===l(e,f)||"j"===l(e,f))?(a=l(e,f),s=++f,o=i,i=!(r=!0)):u=f,f<c)throw Ue;if(0<u){if(!i)throw Ue;t=parseInt(e.substr(0,u),10)}if(0<s){if(!r)throw Ue;if(1===s||2===s&&"+"===l(e,u))n=1;else if(2===s&&"-"===l(e,u))n=-1;else{if(!o)throw Ue;n=parseInt(e.substr(u,s-1),10)}}return new ke(t,n,a)}try{return e?"number"==typeof e?new ke(e,0):"string"==typeof e?t(e):null:new ke(0,0)}catch(e){return null}}function Vt(e,t,i){var r,o,n;if(D(e))throw(0,O.sR)().Exp_InvalidFunctionName;if(e=e.toUpperCase(),v.Mmt[e])throw(0,O.sR)().Exp_InvalidOverrideFunction;if(r=v.Mmt[e]){if(!i||!i.override)throw(0,O.sR)().Exp_OverrideNotAllowed}else v.Mmt[e]=r=new Fe(e,0,255);return t&&"function"==typeof t&&(r.evaluate=t),"function"==typeof i.argsValidator&&(o=r.aDt,r.aDt=function(e,t,n,r){o(e,t,n,r),i.argsValidator(e,t,n,r)}),"function"==typeof i.subExpressionValidator&&(n=r.uDt,r.uDt=function(e,t){n(e,t),i.subExpressionValidator(e,t)}),ne.y0(i,function(e,t){var n;0<=a(e,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])?(n=new Se(t),r[e]=function(e){return n.xDt(e)}):0<=a(e,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])?(n=new Se(t),r[e]=function(){return n.NDt()}):i.hasOwnProperty(e)&&(r[e]=t)}),r}function Kt(e,t,n,r,i,o,a,u,s){return u=u||{},n!==p&&(u.minArgs=n),r!==p&&(u.maxArgs=r),o!==p&&(u.acceptsReference=o),a!==p&&(u.acceptsArray=a),i!==p&&(u.R9t=i),u.wkt!==p&&(u.acceptsMissingArgument=u.wkt),u.V9t!==p&&(u.isVolatile=u.V9t),u.r9t!==p&&(u.isContextSensitive=u.r9t),u.a9t!==p&&(u.haveDynamicListener=u.a9t),u.e9t!==p&&(u.skipPrecedent=u.e9t),u.o9t!==p&&(u.arrayArgumentEvaluateMode=u.o9t),u.f9t!==p&&(u.acceptsError=u.f9t),s!==p&&(u.isDynamicArrayFunction=s),Vt(e,t,u)}function Yt(e){return"boolean"==typeof e}function Xt(e){return"number"==typeof e}function Wt(e){return e%400==0||e%4==0&&e%100!=0||1900===e}function Zt(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return Ye(e.getFullYear())?366:365;case 3:return 365;default:return-1}}function zt(e,t){return e-t}function Jt(e,t){return 0<=a(t,[0,2,4,6,7,9,11])?31:0<=a(t,[3,5,8,10])?30:1===t?Ye(e)?29:28:void 0}function Qt(e,t,n,r){var i,o,n,a,u,r,e,s,i=n.getFullYear(),o=n.getMonth(),n=n.getDate(),a=r.getFullYear(),u=r.getMonth(),r=r.getDate();return e?(e=1===o&&Xe(i,o)===n,s=1===u&&Xe(a,u)===r,t?(e&&(n=30),s&&(r=30)):(e&&s&&(r=30),e&&(n=30)),31===r&&30<=n&&(r=30)):31===r&&(t?(r=1,u++):r=30),360*(a-i)+30*(u-o)+r-(n=31===n?30:n)}function $t(e,t,n){var r,i,o,r=1;return 0<e-t&&(o=e,e=t,t=o,r=-1),i=0<=a(n,[1,2,3])?r*Ge(d(t)-d(e)):0<=a(n,[4,5])?r*Qt(!1,5===n,e,t):r*Qt(!0,6===n,e,t)}function en(e){var t,t,n,t=0===e?0:3<=(n=.5*s(e))?1:n<1?((((((((.000124818987*(t=n*n)-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*n*2:(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524;return 0<e?.5*(t+1):.5*(1-t)}function tn(e,t,n,r,i){for(var o,a,u,s,f,c,h,l,d,m,v,p,b,T,y,g,A,E,_,w,x,I,S,R,C,N,o=n<100,a=2===n||102===n,u=a||3===n||103===n,s=5===n||105===n,f=4===n||104===n||s,c=9===n||109===n,h=1===n||101===n||c||r,l=6===n||106===n,d=l?1:0,m=!1,v=0,x=!1,p=0;p<L(e);p++){if(I=e[p],S=void 0,u){if(!a&&!(I instanceof Ee)&&I instanceof Ae){d+=I.getColumnCount()*I.getRowCount();continue}S=je(I,0,!1,!1,!1,a)}else R=1,O.ExcelCompatibleCalcMode&&!vt(I)&&!pt(I)||(R=5),S=je(I,R,!1,!1,!1,!0);if(S.isError)return S[0];if(S.isConvertError)return F;for(C=S.rangeCount,N=S.isReference,b=0;b<C;b++)for(T=1<C?S[b]:S,N&&(y=I.getRow(b),g=I.getColumn(b)),A=0;A<L(T);A++)if(2===t||!N||!I.isHiddenRow(b,A,o))for(_=T[A],E=0;E<L(_);E++)if(!(1!==t&&2!==t&&N&&I.isSubtotal(b,A+y,E+g)||null===(w=_[E])||w===ve)){if(w&&w._error&&!u)return i&&(i.sumx=0,i.sumx2=0,i.n=0),w;u&&!D(w)&&(!a||""!==w&&B.q8(w,!0))?d++:f&&(!m||s&&w<d||!s&&d<w)?d=w:h?r?(i.sumx=M.tge(i.sumx,w),i.sumx2+=w*w,i.n++,i.values.push(w),i.values[0]!==w&&(i.allSame=!1)):(d=M.tge(d,w),v++):l&&(d*=w,v++),m=!0}}return h?c?d:r?void 0:0===v?be:Ve(d/v):l?Ve(0<v?d:0):d}function nn(e,t,n){var r,i,r,o,a,u,s,r=n%100,i=7==r||8==r,r=7==r||10==r?1:0,o={sumx:0,sumx2:0,n:0,values:[],allSame:!1},a=tn(e,t,n,!0,o);if(a&&a._error)return a;if(o.n<=r)return be;if(o.allSame)a=0;else if(M.ukt(o.n*o.sumx2,o.sumx*o.sumx))for(u=o.sumx/o.n,s=a=0;s<o.n;s++)a+=le(o.values[s]-u,2);else a=o.sumx2-o.sumx*o.sumx/o.n;return a/=o.n-r,Ve(i?Math.sqrt(a):a)}function rn(e,t,d,a){var m,v,p,b,T,t,n,r,i,o,u,s,f,c,h,l,c,y,g,A;if(null===d)return F;if((d=parseInt(d,10))<=0||19<d)return F;function E(e){var t,n,r,i,o,a,u,s,f,c,h,l,t=[],n=je(e,T?0:5,!1,!1,!1,!1);if(n.isConvertError)return F;for(h=n.rangeCount,l=n.isReference,r=0;r<h;r++)for(i=1<h?n[r]:n,l&&(o=e.getRow(r),a=e.getColumn(r)),u=0;u<L(i);u++)if(!(l&&e.isHiddenRow(r,u,!1)&&m))for(f=i[u],s=0;s<L(f);s++)if(!(l&&v&&e.isSubtotal(r,u+o,s+a)||null===(c=f[s])||p&&Ke(c)||Ke(c)&&b)){if(!p&&Ke(c)&&3!==d)return c;typeof c===V&&0===Object.keys(c).length||t.push(c)}return t}function _(e){var t,n,r,i,o,t=e.getRow(0),n=e.getColumn(0),r=e.getRowCount(0),i=e.getColumnCount(0);if(1===r&&1===i)o=e.getValue(0,0,0);else if(1!==r&&1===i&&t<=a.row&&a.row<t+r)o=e.getValue(0,a.row-t,0);else{if(!(1===r&&1!==i&&n<=a.column&&a.column<n+i))return F;o=e.getValue(0,0,a.column-n)}return o===x||""===o?I:isNaN(parseInt(o,10))?F:parseFloat(o)}if(m=1===(t=t||0)||3===t||5===t||7===t,v=1===t||2===t||3===t||0===t,p=2===t||3===t||6===t||7===t,T=(b=2===d)||3===d,t=12===d,n=13===d,c=(r=14===d)||(i=15===d)||(o=16===d)||(u=17===d)||(s=18===d)||(f=19===d),h=[],l=L(e),c){if(2!==l)return F;if((h=E(e[0]))._error)return h;if(c=void 0,e[1]===x)return I;if(e[1]instanceof xe)c=_(e[1]);else if(e[1]instanceof Ae)c=e[1].array[0][0];else{if(isNaN(parseInt(e[1],10)))return F;c=S(e[1])}return c._error?c:gn([h,c=17!==d&&19!==d?c:Ge(c)],d)}for(y=0;y<l;y++)if(!(e[y]instanceof xe))return F;for(y=0;y<l;y++){if(!((g=E(e[y]))instanceof Array))return g;h.push.apply(h,g)}return t||n?gn([h],d):7===d||8===d||10===d||11===d?nn(h,A=v?1:0,d):tn(h,1,d)}function on(e){var e=e.charCodeAt(0);return 0<=e&&e<129||63728===e||65377<=e&&e<65440||63729<=e&&e<63732?"singleByte":55296<=e&&e<=57343?"fourByte":"doubleByte"}function an(e){for(var t,n,t=[],n=0;n<e.length;n++)D(e[n])?(t[n]=e[n+1],n++):t[n]=e[n];return t.length===e.length-1&&(t[t.length]=p),t}function un(e){for(var t,n,r,i,o,a,u,t=[],r=0,o=0,i=0;i<e.length;i++){if(n=e[i],"doubleByte"===(a=on(e[i]))||"fourByte"===a)if("fourByte"===a){if(r%2==0){r++;continue}o++,r++,n=e[i-1]+e[i]}else o++,n=e[i];t[i-(u=0<r?r/2:0)+o]=n}return an(t)}function sn(e,t){var n,r;for(void 0===t&&(t=!0),n=[],r=0;r<L(e);r++)cn(e[r],n,t);return n}function fn(e){e.sort(function(e,t){return e-t})}function cn(e,t,n){var r,i;for(void 0===n&&(n=!0),r=0;r<L(e);r++)(i=e[r])!==ve&&t.push(i);n&&fn(t)}function hn(e){for(var t,n,e,r,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e=sn(e),0===(r=L(e))?I:r%2==0?(S(e[r/2-1])+S(e[r/2]))/2:e[ie((r/2).toString())]}function ln(e){for(var t,n,r,i,o,a,u,s,f,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(r=x,i=0,o=sn(e,!1),a=L(o),u=0;u<a;u++){for(s=f=0;s<a;s++)s!==u&&o[s]===o[u]&&f++;i<f&&(i=f,r=o[u])}return 0===i?Te:r}function dn(e,t){return vn(!0,e,t)}function mn(e,t){return vn(!1,e,t)}function vn(e,t,n){var r,t,r=[];return cn(t,r),t=L(r),n<1||t<n?I:(n=(e?me:de)(n),e?r[t-n]:r[n-1])}function pn(e,t){var e,t,n;return e=je(e,1,!0,!0,!1,!0),t=S(t),e.isError?e[0]:e.isConvertError||oe(t)?F:(cn(e,e=[]),!L(e)||t<0||1<t?I:(n=(t=t*(L(e)-1))%1,t=ie(t.toString()),0==n?e[t]:S(e[t])+n*(S(e[t+1])-S(e[t]))))}function bn(e,t){var t=a(t,[0,1,2,3,4]);return t<0?I:pn(e,.25*t)}function Tn(e,t){for(var n,r,i,o,t,a,o,t,n=L(e),r=[],i=0;i<n;i++)qe(e[i],!0)&&r.push(e[i]);return!r.length||(o=r.length,fn(r),a=(t=t*(o+1)-1)%1,t<0)||o-1<t?I:(t=r[o=de(t)],0==a?t:t+a*(r[o+1]-t))}function yn(e,t){var t=a(t,[1,2,3]);return t<0?I:Tn(e,.25*(t+1))}function gn(e,t){var n,r,i,o,a,u,s,f,n,r=13===t,i=14===t,o=15===t,a=16===t,u=17===t,s=18===t,f=19===t;return 12===t?hn(e):r?ln(e):i?dn(e[0],e[1]):o?mn(e[0],e[1]):a?pn(e[0],e[1]):u?bn(e[0],e[1]):s?Tn(e[0],e[1]):f?yn(e[0],e[1]):ye}function An(e){for(var t=1,n,n=e;1<n;n--)t*=n;return t}function En(e,t,n){var r=e.getDate(),i=t.getDate(),o=e.getMonth(),a=t.getMonth(),e=e.getFullYear(),t=t.getFullYear(),r=31===r?30:r;return n?i=31===i?30:i:31===i&&(r<30?(i=1,12<++a&&(a=1,t++)):i=30),30*(12*(t-e)+a-o)+i-r}function _n(e,t,n){var r,i,o,o,r,a,u,s,f,c,r=$t(e,t,n);return r<0&&(r=-r,o=e,e=t,t=o),r/(i=1===n?(o=e.getFullYear(),r=t.getFullYear(),f=s=u=a=void 0,(a=new Date(e.valueOf())).setFullYear(a.getFullYear()+1),s=0<t-a?(f=r+1-o,a=new Date(o,0,1),u=new Date(r+1,0,1),Ge(d(u)-d(a))-365*(r+1-o)):(f=1,Ye(o)&&e.getMonth()<te||Ye(r)&&256*t.getMonth()+t.getDate()>=256*ee+29?1:0),365+(c=S(s)/S(f))):Zt(new Date,n))}function wn(e,t,n){return n<0||4<n?I:_n(e,t,n)}function xn(e,t,n,r){var i,o,a;if(this.criteria=e,"function"==typeof t&&(i=t,t=null),n&&(n.Zbt=!0),t=t||je(n,0,2,!1,!1),i){for(o=[],a=0;a<L(t);a++)o[a]=i(t[a]);t=o}(this.array=t).DDt&&e!==x&&"function"!=typeof e&&(this.useMap=!0),"function"!=typeof e&&(this.A9t=this.Pde)}function R(){this.referenceCache=(0,H.createMap)()}function C(){}function In(t,n,r){var i,e;try{i=(e=g.Common.CultureManager.getCultureInfo()).localeCompare?r?e.localeCompare(t,n):e.localeCompare(t.toLowerCase(),n.toLowerCase()):r?Ne(t,n):Ne(t.toLowerCase(),n.toLowerCase())}catch(e){i=r?Ne(t,n):Ne(t.toLowerCase(),n.toLowerCase())}return i}function Sn(e,t,n){var r,i,o,a,u,o,i,i,s,o;if(void 0===n&&(n=!0),T(e))return e;if(T(t))return t;if(o=typeof t===E,(i=typeof e===E)||o)r=i&&o?e===t?0:t<e?1:-1:i?1:-1;else{if(u=typeof t===G,i=(o=(a=typeof e===G)||u)?"":0,e=e===x||e===p?i:e,t=t===x||t===p?i:t,i=function(){return e===t?0:a&&u?In(e,t,n):a?1:u?-1:(e=M.E8(e,15),t=M.E8(t,15),e-t)},!o){if(o={value:0},!b(e,s={value:0})||!b(t,o))return F;e=s.value,t=o.value}r=i()}return r}function Rn(e){return e instanceof Ce.Function}function Cn(e){return e instanceof Ce.LambdaFunction}function Nn(e){return e instanceof f}function On(e,t){return!Rn(e)||e.acceptsArray(t)}function Dn(e,t){return!Rn(e)||e.acceptsReference(t)}function Ln(e){return e&&e.arrayArgumentEvaluateMode}function Mn(e){var t=et.call(this,x)||this;return t.oyt=e,t}function Fn(e,t){return{row:e,col:t}}P=this&&this.__extends||(De=function(e,t){return(De=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}De(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),U=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r=0,i=t.length,o;r<i;r++)!o&&r in t||((o=o||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},Object.defineProperty(O,"__esModule",{value:!0}),O.isExpression=O.isLambdaFunction=O.isFunction=O.$kt=O.Wkt=O.LocalScopes=O.sDt=O.charAtFunc=O.skt=O.addStartEndIndexToExpression=O.createBooleanExpression=O.createNumberExpression=O.createStringExpression=O.xde=O.Ayt=O.rbt=O.createExpandExpression=O.lDt=O.YJ=O.kyt=O.Syt=O.CalcSource=O.CalcReference=O.Expression=O.ExpressionType=O.Convert=O.TwoDimensionalCalcArray=O.CalcArray=O.CalcError=O.usedbcs=O.getErrorList=O.getBoolean=O.getMapping=O.sR=O.isStackOverflowError=O.Fve=O.gDt=O.W9t=O.MAX_COLUMN_COUNT=O.MAX_ROW_COUNT=O.BAND_INDEX_CONST=O.XLOPPrefix=O.XLPMPrefix=O.ErrorCodeList=O.SR=O.CALC_PROGRESS_EVENT=O.TimeoutPaintDelay=O.TimeoutTime=O.TimeoutNodes=O.ExcelCompatibleCalcMode=void 0,O._9t=O.missingArgument=O.Errors=O.Functions=O.ErrorSource=O.getFunctionArrayArgumentEvaluateMode=O.getFunctionAcceptsReference=O.getFunctionAcceptsArray=void 0,g=e("Common"),t=e("./src/calcEngine.res.en.ts"),k=e("./src/text_Filter/text_Filter.ts"),Object.defineProperty(O,"_9t",{enumerable:!0,get:function(){return k._9t}}),H=e("./src/map.ts"),O.ExcelCompatibleCalcMode=!1,O.TimeoutNodes=3,O.TimeoutTime=500,O.TimeoutPaintDelay=0,O.CALC_PROGRESS_EVENT="CalculationProgress",O.SR={en:t.resource},O.ErrorCodeList=[0,7,15,23,29,42,36,99,100],O.XLPMPrefix="_xlpm.",O.XLOPPrefix="_xlop.",A="number",G="string",E="boolean",q="TRUE",j="FALSE",V="object",K="#NULL!",Y="#DIV/0!",X="#VALUE!",W="#REF!",Z="#NAME?",z="#N/A",J="#NUM!",Q="#SPILL!",$="#CALC!",ee=1,te=2,O.BAND_INDEX_CONST=-2147483648,O.MAX_ROW_COUNT=1048576,O.MAX_COLUMN_COUNT=16384,ne=g.Common.lt,re=ne.Nh,D=ne.ht,a=ne.Rh,L=g.Common.Uf.tR,_=g.Common.$T,ie=parseInt,oe=isNaN,w=g.Common.ct,d=w.o0,ae=g.Common.zf,M=g.Common.st,O.W9t=rt,O.gDt=it,O.Fve=ot,O.isStackOverflowError=at,e=new g.Common.ResourceManager(O.SR,"CalcEngine"),O.sR=e.getResource.bind(e),O.getMapping=ue=function(){return Ce&&Ce.resourceMapping},O.getBoolean=se=function(){var e=(0,O.getMapping)()&&(0,O.getMapping)().booleanMapping;return{boolean_true:e&&e.boolean_true||q,boolean_false:e&&e.boolean_false||j}},O.getErrorList=fe=function(){var n,r,e,n=[],r=(0,O.getMapping)()&&(0,O.getMapping)().clacErrorMapping,e;return[K,Y,X,W,Z,z,J,Q,$].forEach(function(e){var t=r&&r[e];n.push(t||e)}),n},x=null,p=void 0,s=Math.abs,ce=Math.exp,he=Math.log,le=Math.pow,de=Math.floor,me=Math.ceil,O.missingArgument=n,ve={},r.prototype.toString=function(){var e,t,e=(0,O.getMapping)()&&(0,O.getMapping)().clacErrorMapping,t;return e&&e[this._error]||this._error},r.prototype.clone=function(){return new r(this._error)},r.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},r.parse=function(e){var e=r.CDt(e);return e?new r(e.error,e.code):p},r.ibt=function(e){for(var t=0;t<O.ErrorCodeList.length;t++)if(e===O.ErrorCodeList[t])return new r((0,O.getErrorList)()[t],e);return p},r.CDt=function(e){var t,n,r;if(e)for(t=(0,O.getErrorList)(),n=0;n<t.length;n++)if((r=t[n])===e||r===tt(e))return{error:r,code:O.ErrorCodeList[n]};return p},m=r,O.CalcError=m,u={Name:new m(Z),Null:new m(K),DivideByZero:new m(Y),NotAvailable:new m(z),Value:new m(X),Reference:new m(W),Number:new m(J),Spill:new m(Q),Calc:new m($)},O.Errors=u,F=u.Value,pe=u.Reference,I=u.Number,be=u.DivideByZero,Te=u.NotAvailable,ye=u.Null,ge={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},lt.prototype.getRowCount=function(){return this.array.length},lt.prototype.getColumnCount=function(){var e=this.array[0];return e&&e.length||0},lt.prototype.getValue=function(e,t){var n,r,i,n=this.array,r=e;return"number"!=typeof t&&(r=e.row,t=e.column),r<0||t<0||r>=n.length||t>=n[0].length?F:this.array[r][t]},lt.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),n=de(e/t),r;return this.getValue(n,e%t)},lt.prototype._Dt=function(){var e,t,n,r,i,o,e=this,t=0,n=0;if(t=e.getRowCount())for(n=e.getColumnCount(),r=0;r<t;r++)for(i=0;i<n;i++)pt(o=this.array[r][i])&&(this.array[r][i]=o.getValueByIndex(0))},lt.prototype.toArray=function(e,t,n,r,i,o,a){var u,s,f,c,h,l,d,m,v;if(void 0===t&&(t=!0),f=s=0,c=[],d=ve,s=(u=this).getRowCount())for(f=u.getColumnCount(),m=0;m<s;m++)for(t||c.push(l=[]),v=0;v<f;v++){if(h=u.getValue(m,v),u.referenceInTwoDimension&&pt(h)&&(h=h.getValueByIndex(0)),n&&T(h))return(c=[h]).isError=!0,c;if(h=ht(h,e,!1,o),r&&h===d)return(c=[h]).isConvertError=!0,c;(t?c:l).push(h)}return c.rowCount=s,c.colCount=f,c.rangeCount=1,c},lt.prototype.slice=function(e,t,n,r){var i,o,a,u,s,f,i=this,o=i.array,a=[];for(t=t<0?0:t,n=(e=e<0?0:e)+n>i.getRowCount()?i.getRowCount()-e:n,r=t+r>i.getColumnCount()?i.getColumnCount()-t:r,s=0;s<n;s++)for(a.push(u=[]),f=0;f<r;f++)u.push(o[s+e][f+t]);return new lt(a)},Ae=lt,O.CalcArray=Ae,P(dt,Le=Ae),dt.prototype.getCalculatedValue=function(){var e,t,e=this.array[0];return 1===e.length?e[0]:"number"!=typeof e[0]?U([],e,!0):(t=0,e.forEach(function(e){"number"==typeof e&&(t+=e)}),t)},dt.prototype.getActualValue=function(){return 1===this.array[0].length?this.array[0][0]:U([],this.array[0],!0)},O.TwoDimensionalCalcArray=Ee=dt,_e=["o","n","s","b","d"],y.Sft=function(e){return T(e)&&e._code===O.ErrorCodeList[5]},y.L6t=function(e){return isNaN(e)||!isFinite(e)?I:e},y.iV=function(e,t,n,r,i,o,a,u){var s,f,c;if(e&&e.length&&e.rowCount&&e.colCount)return e;if(vt(e))(s=e.toArray(t,n,r,i,o)).isArray=!0;else if(pt(e))(s=e.toArray(t,n,r,i,o,a,u)).isReference=!0;else{if(re(e)){if(s=[],0===e.length)return s;if(re(e[0]))return y.EDt(e,t,!0);for(f=0;f<e.length;f++)(c=ht(e[f],t,!1))===y.CalcConvertedError&&(s.isConvertError=!0),s.push(c);s.rowCount=1,s.colCount=e.length}else e=ht(e,t,!0,o),r&&y.BJ(e)?(s=[F]).isError=!0:e===y.CalcConvertedError?(s=[y.CalcConvertedError]).isConvertError=!0:(n?s=[]:(s=[[]])[0]).push(e),s.rowCount=1,s.colCount=1;s.rangeCount=1}return s},y.EDt=function(e,t,n){var r,i,o,a,u,s,f,c,h,l,d,m,v;if(!e||!e.length||!e[0].length)return(r=[]).isError=!0,[[F]];if(0===t)return e;if(o=e.length,a=e[0].length,l=h=!(c={value:x}),d=y.CalcConvertedError,!(r=e[i=_e[t]]))for(e[i]=r=[],m=0;m<o;m++)for(u=e[m],s=r[m]=[],v=0;v<a;v++){if(T(f=u[v])){h=h||(r.isError=!0)}else{switch(t){case 1:case 5:n&&5!==t?f=b(f,c)?c.value:(l||(r.isConvertError=l=!0),0):typeof f===A||f instanceof Date||(l||(r.isConvertError=l=!0),f=d);break;case 3:n?f=ct(f,c)?c.value:(l||(r.isConvertError=l=!0),!1):typeof f!==E&&(l||(r.isConvertError=l=!0),f=d);break;case 2:f=f===x||f===p?"":f.toString()}}s.push(f)}return r},y.z6t=function(e){var e=st(e);if(s(e)<1e21)return parseInt(e.toString(),10);throw(0,O.sR)().Exp_InvalidCast},y.t9t=function(e,t){var n;return""!==e&&!!b(e,t)&&s(t.value)<1e21&&(t.value=parseInt(t.value.toString(),10),!0)},y.U6t=function(e){if(!e)return!1;if(typeof e===E)return e;if(e instanceof Date)return 0!==w.o0(e);if(y.q8(e))return 0!==e;if(y.BJ(e))return!1;throw(0,O.sR)().Exp_InvalidCast},y.j=function(e){var t,n,r,i,o,a;try{if(e===p||e===x)return"";if(typeof e===E)return e?q:j;if(typeof e===G)return e;if(e instanceof Date)return w.o0(e).toString();if(vt(e))throw(0,O.sR)().Exp_InvalidCast;if(typeof e!==A)return e.toString();if(t="",e<0&&(t="-",e=-e),-1!==(i=(r=-1===(r=(n=M.E8(e,Ce.CALC_PRECISION||15)).toString()).indexOf("e")&&20<r.length?n.toExponential():r).indexOf("e-"))){if(o=+r.substring(i+2),(a=-1===r.indexOf(".")?1:i-1)+o<20)return t+e.toFixed(a+o-1);o<10&&(r=r.replace("e-","e-0"))}return t+r.toUpperCase()}catch(e){throw(0,O.sR)().Exp_InvalidCast}},y.r0=function(e){var t={value:x};if(y.kDt(e,t))return t.value;throw(0,O.sR)().Exp_InvalidCast},y.kDt=function(e,t){var n,r,i,o;if(e)if(!0===e)t.value=g.Common.ct.Y0(1);else if(e instanceof Date)t.value=new Date(e.valueOf());else if(typeof e===G){if(!(n=g.Common.ct.yU(e)))if(isNaN(e)){if(n=new Date(e),isNaN(n.valueOf()))return!1;try{if(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,i=ae.s6t(ae.cJ(e.replace(/ |\n/g,"")," ")," "),(o=r.exec(i))&&4===o.length&&(-1===o.indexOf(n.getFullYear().toString())||-1===o.indexOf(n.getMonth().toString())||-1===o.indexOf(n.getDate().toString())))return!1}catch(e){return!1}}else if(!(n=g.Common.ct.Y0(parseFloat(e))))return!1;t.value=n}else{if(typeof e!==A)return!1;t.value=g.Common.ct.Y0(e)}else t.value=g.Common.ct.Y0(0);return!0},y.CalcConvertedError=ve,y.Nh=vt,y.q8=mt,y.BJ=T,y.LE=pt,y.Nbt=ht,y.Ybt=ft,y.jDt=ut,y.uJ=st,y.sJ=b,y.YK=ct,B=y,O.Convert=B,(t=we=O.ExpressionType||(O.ExpressionType={}))[t.unknow=0]="unknow",t[t.reference=1]="reference",t[t.number=2]="number",t[t.string=3]="string",t[t.boolean=4]="boolean",t[t.error=5]="error",t[t.array=6]="array",t[t.function=7]="function",t[t.name=8]="name",t[t.operator=9]="operator",t[t.parentheses=10]="parentheses",t[t.missingArgument=11]="missingArgument",t[t.expand=12]="expand",t[t.structReference=13]="structReference",t[t.field=14]="field",t[t.fieldItem=15]="fieldItem",t[t.tableSheetReference=22]="tableSheetReference",t[t.nameIdentity=25]="nameIdentity",t[t.externalNameIdentity=26]="externalNameIdentity",t[t.LocalName=100]="LocalName",bt.prototype.hmt=function(){return x},bt.prototype.offset=function(e,t,n,r,i){return x},bt.prototype.offsetWhenCopy=function(e,t,n,r,i,o,a,u,s,f){return x},bt.prototype.getRange=function(e,t){for(var n,r,n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return x},bt.prototype.forEachNodes=function(t){t(this),this.value&&this.value.forEachNodes&&this.value.forEachNodes(t),this.value2&&this.value2.forEachNodes&&this.value2.forEachNodes(t),this.arguments&&this.arguments.forEach&&this.arguments.forEach(function(e){e&&e.forEachNodes&&e.forEachNodes(t)})},f=bt,O.Expression=f,c.prototype.getRangeCount=function(){return this.SDt},c.prototype.getSource=function(){return this.rT},c.prototype.create=function(e){return new c(this.rT,e)},c.prototype.getKey=function(){var t,n,t=[],n=this.rT;return this.$gt.forEach(function(e){t.push(n.getRangeKey(n,e))}),1===t.length?t[0]:0===t.length?x:t.join(",")},c.prototype.toArray=function(e,t,n,r,i,o,a){var u=this.rT,s=u.referenceToArray;return s&&s.call(u,this,e,t,n,r,i,o,a)},c.prototype.getRow=function(e){return this.$gt?this.$gt[e||0].row:0},c.prototype.getColumn=function(e){return this.$gt?this.$gt[e||0].col:0},c.prototype.getRowCount=function(e){return this.$gt?this.$gt[e||0].rowCount:this.rT.getRowCount()},c.prototype.getColumnCount=function(e){return this.$gt?this.$gt[e||0].colCount:this.rT.getColumnCount()},c.prototype.getValue=function(e,t,n){var r,i,n;if(typeof e===A?(r=arguments[1],i=n,t=e):(r=e.row,i=e.col),t=t||0,0<=r||0<=i){if(!(n=this.$gt))return this.rT.getValue(r,i);if(t<n.length)return this.rT.getValue(r+n[t].row,i+n[t].col)}return pe},c.prototype.getValueByIndex=function(e){var t=this.getColumnCount(),n=de(e/t),r;return this.getValue(0,n,e%t)},c.prototype.isHiddenRow=function(e,t,n){return this.rT.isHiddenRow(t+this.getRow(e),n)},c.prototype.isSubtotal=function(e,t,n){var r,i,r=this.rT;return 0===e&&t<r.getRowCount()&&n<r.getColumnCount()&&nt(i=r.getCalcSourceModel().ODt(t,n))},c.prototype.getSpillRef=function(){var e,t,n,e,r,i,o,o,a,a,e=this;if(1===e.getRowCount()&&1===e.getColumnCount()&&(i=new c(t=e.getSource(),[r=Fn(n=e.getRow(),e=e.getColumn())]),t)&&t.t8){if(o=t.t8.getAnchorCell(n,e))return o.isValid?(r.rowCount=o.rowCount,r.colCount=o.colCount,i):u.Spill;if(a=(o=t.getCalcSourceModel()).sT(n,e))return a.row===n&&a.col===e?(r.rowCount=a.rowCount,r.colCount=a.colCount,new c(t,[r])):void 0;if(!(a=o.pB(n,e))||33!==a.type)return a&&("@"===a.functionName||a)?(r.rowCount=1,r.colCount=1,new c(t,[r])):pe;i.isSpillError=!0,r.rowCount=1,r.colCount=1}return pe},xe=c,O.CalcReference=xe,i.prototype.getCalcService=function(){return this.Lbt},i.prototype.op=function(){return this.Lbt},i.prototype.setCalcService=function(e){this.Lbt=e},i.prototype.getCalcSourceModel=function(){return this.Mbt},i.prototype.setCalcSourceModel=function(e){this.Mbt=e},i.prototype.getValue=function(){for(var e,t,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return x},i.prototype.getName=function(e){return""},i.prototype.getField=function(e){return x},i.prototype.getFieldItem=function(e){return x},i.prototype.setValue=function(){for(var e,t,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},i.prototype.getReference=function(e){return new xe(this,e&&[e])},i.prototype.getSources=function(e){return[this]},i.prototype.referenceToArray=function(e,t,n,r,i,o,a,u){return e.toArray(t,n,r,i,o,a,u)},i.prototype.setFormula=function(){for(var e,t,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},i.prototype.setArrayFormula=function(){for(var e,t,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},i.prototype.getRowCount=function(){return 1e3},i.prototype.getColumnCount=function(){return 100},i.prototype.isHiddenRow=function(e,t){return!1},i.prototype.startCalculation=function(){},i.prototype.endCalculation=function(e,t){},i.prototype.getCustomFunction=function(e){return x},i.prototype.getCustomName=function(e){return x},i.prototype.getCustomNameInfo=function(e){return x},i.prototype.refresh=function(){},i.prototype.toJSON=function(e,t){for(var n,r,n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r]},i.prototype.wh=function(e,t){for(var n,r,n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r]},i.sourceId=1,e=i,O.CalcSource=e,O.Syt=Tt,O.kyt=Tt(pe),O.YJ=yt,O.lDt=gt,O.createExpandExpression=At,O.rbt=Et,O.Ayt=_t,O.xde=wt,O.createStringExpression=xt,O.createNumberExpression=It,O.createBooleanExpression=St,O.addStartEndIndexToExpression=Rt,Ct.getArrayValue=function(e,t,n){return e?t<e.getRowCount()&&n<e.getColumnCount()?e.getValue(t,n):n>=e.getColumnCount()&&1===e.getColumnCount()&&t<e.getRowCount()?e.getValue(t,0):t>=e.getRowCount()&&1===e.getColumnCount()&&n<e.getColumnCount()?e.getValue(0,n):F:F},Ct.tryExtractToSingleValue=function(e){var t,n,t=!0;return(pt(e)||vt(e))&&((n=B.iV(e,0,!1,!0)).isError?e=n[0]:1===n.rowCount&&1===n.colCount?e=n[0][0]:(e=n,t=!1)),{value:e,success:t}},O.skt=Ct,O.charAtFunc=l,Dt.prototype.xDt=function(e){var t,n,r,i,o,a,u,s,f,t=this.ADt;if(-1===(t=ne.Nh(t)?t:[t])[0])return!0;for(n=0;n<t.length;n++)if(o=i=void 0,Ot(r=t[n])){for(a=r.split(" && "),u=!0,s=0;s<a.length;s++)i=(f=a[s].split(" "))[0],o=ie(f[1]),"!="===i&&e!==o||">"===i&&o<e||">="===i&&o<=e||"%="===i&&e%2===o||(u=!1);if(u)return!0}else if(e===r)return!0;return!1},Dt.prototype.NDt=function(){return this.ADt},Se=Dt,O.sDt=Lt,o.prototype.getVariable=function(e){var t,n;for(e=tt(e),n=this.context.length-1;0<=n&&(t=this.context[n][e])===p;n--);return t=t===p&&this.closure?this.closure[e]:t},o.prototype.setVariable=function(e,t){e=tt(e),this.context[this.context.length-1][e]=t},o.prototype.hasVariable=function(e){return e=tt(e),this.getVariable(e)!==p},o.prototype.enterScope=function(){this.context.push({})},o.prototype.exitScope=function(){this.context.pop()},o.prototype.saveThenSwitchClosure=function(e){this.backupClosure.push(this.closure),this.closure=e},o.prototype.restoreClosure=function(){0<this.backupClosure.length?this.closure=this.backupClosure.pop():this.closure={}},o.prototype.createClosure=function(){var e,t,e={};for(this.copyTo(this.closure,e),t=0;t<this.context.length;t++)this.copyTo(this.context[t],e);return e},o.prototype.copyTo=function(e,t){for(var n,r,i,n=Object.keys(e),r=0;r<n.length;r++)t[i=n[r]]=e[i]},O.LocalScopes=o,v=Ce=Ce||{},(n=Me=v.ArrayArgumentEvaluateMode||(v.ArrayArgumentEvaluateMode={}))[n.normal=0]="normal",n[n.allwaysExpand=1]="allwaysExpand",n[n.neverExpand=2]="neverExpand",h.prototype.description=function(){var e=this,t=(0,O.sR)().wmt;return e.IDt||t&&t[e.name]},h.prototype.acceptsArray=function(e){return!1},h.prototype.acceptsReference=function(e){return!1},h.prototype.acceptsError=function(e){return!1},h.prototype.acceptsMissingArgument=function(e){return!1},h.prototype.isVolatile=function(){return!1},h.prototype.isContextSensitive=function(){return!1},h.prototype.acceptsExpressionArgument=function(e){return!1},h.prototype.isBranch=function(){return!1},h.prototype.findTestArgument=function(){return-1},h.prototype.findBranchArgument=function(e){return-1},h.prototype.expandRows=function(){return!0},h.prototype.expandColumns=function(){return!0},h.prototype.skipPrecedent=function(e){return!1},h.prototype.returnReference=function(){return!1},h.prototype.evaluate=function(){for(var e,t,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},h.prototype.evaluateWithContext=function(e,t){var n=this,t=t;return n.isContextSensitive()&&(t=[e].concat(t)),n.evaluate.apply(n,t)},h.prototype.toJSON=function(){var e,t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},h.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==p&&(this[t]=e[t])},h.prototype.aDt=function(e,t,n,r){if(n<e||t<n)throw(0,O.sR)().Exp_FormulaInvalid},h.prototype.uDt=function(e,t){Lt(e,t)},h.ZX=function(e,t,n){var r,i,r=new h(e,0,255);if(t&&"function"==typeof t&&(r.evaluate=t),n)for(i in n)n.hasOwnProperty(i)&&"override"!==i&&(r[i]=n[i]);return r},Fe=h,v.Function=Fe,P(Mt,Qe=Fe),Mt.prototype.isContextSensitive=function(){return!0},Mt.prototype.evaluate=function(e,t){return this.evaluateAsync.apply(this,arguments)},Mt.prototype.evaluateAsync=function(e,t){this.evaluate.apply(this,arguments)},Mt.prototype.defaultValue=function(){return 0},Mt.prototype.evaluateMode=function(){return 0},Mt.prototype.evaluateWhenArgumentsIsSame=function(){return!0},Mt.prototype.interval=function(){return 1e4},v.AsyncFunction=Mt,P(Ft,$e=Fe),Ft.prototype.acceptsArray=function(e){return!0},Ft.prototype.acceptsReference=function(e){return!0},Ft.prototype.acceptsError=function(e){return!0},v.LambdaFunction=Ft,v.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},v.Mmt={},v.Tmt={},v.defineGlobalCustomFunction=Bt,v.findGlobalFunction=Pt,v.findGlobalFunctions=Ut,v.removeGlobalFunction=kt,Ue=(0,O.sR)().Exp_Format,qt.prototype.ikt=function(){return this.okt},qt.prototype.rkt=function(){return this.akt},qt.prototype.hkt=function(){return this.mit},qt.prototype.j=function(e){e=e||"i";var t=this,n=t.okt,t=t.akt,r="",i=v.CALC_PRECISION;return i&&(n=M.E8(n,i),t=M.E8(t,i)),0===n&&0!==t||(r+=n.toString()),-1===t?r+="-":0!==n&&0<t&&(r+="+"),-1!==t&&0!==t&&1!==t&&(r+=t.toString()),0!==t&&(r+=e),r},ke=qt,v.q6t=ke,v.mkt=jt,He=B.sJ,Ge=B.z6t,S=B.uJ,qe=B.q8,je=B.iV,Ve=B.L6t,Ke=B.BJ,v.F6t=Kt,v.B6t=179769e303,v.G6t=Yt,v.OMt=Ot,v.q8=Xt,v.F9t=Wt,Ye=Wt,v.Fkt=Zt,v.Gkt=zt,v.Pkt=Jt,Xe=Jt,v.Ukt=$t,v.dkt=en,v.b9t=tn,v.y9t=nn,v.H9t=rn,v.P9t=on,v.U9t=an,v.G9t=un,v.w9t=gn,v.nkt=An,v.Mkt=En,v.Hkt=wn,xn.prototype.RDt=function(e){var t,n,r,i,t=this.criteria,n=this.array;if(!D(t))if(this.useMap){if(r=n.DDt.get(t))for(i=0;i<r.length;i++)if(e(r[i]))return}else if("function"==typeof t){for(i=0;i<L(n);i++)if(t(n[i])&&e(i))return}else for(i=0;i<L(n);i++)if(t===n[i]&&e(i))return},xn.prototype.A9t=function(e){return this.criteria&&this.criteria(this.array[e])},xn.prototype.Pde=function(e){return this.criteria===this.array[e]},xn.prototype.dispose=function(){delete this.criteria,delete this.array},We=xn,v.RangeCriteria=We,(n=Ze=Ze||{})[n.unCompatibleDoubleEqual=0]="unCompatibleDoubleEqual",n[n.compatibleDoubleEqual=1]="compatibleDoubleEqual",n[n.stringEqual=2]="stringEqual",R.prototype.dispose=function(){delete this.referenceCache},R.prototype.HJe=function(e){e?(this.WJe||(this.WJe=this.referenceCache),this.referenceCache=(0,H.createMap)()):(this.referenceCache=this.WJe,this.WJe=null)},R.prototype.p9t=function(e){var t,n,r;if(D(e))return[4,0];if(qe(e)||!Ot(e))return[4,e];switch((n=(t=D(e)?"":e.toUpperCase())[0])+(r=t[1])){case"<>":return[2,2===t.length?null:t.substring(2)];case"<=":return[0,2===t.length?null:t.substring(2)];case">=":return[1,2===t.length?null:t.substring(2)]}switch(n){case"=":return[4,1===t.length?null:t.substring(1)];case"<":return[3,1===t.length?null:t.substring(1)];case">":return[5,1===t.length?null:t.substring(1)]}return[4,e.toUpperCase()]},R.BDt=function(e){return 0===e.toString().trim().length},R.LDt=function(e){return Yt(e)||v.OMt(e)&&("TRUE"===e.toUpperCase()||"FALSE"===e.toUpperCase())},R.FDt=function(e){return Yt(e)?e:"TRUE"===e.toUpperCase()},R.getCompareFunction=function(e){return 0===e?function(e,t){return e<=t}:1===e?function(e,t){return t<=e}:2===e?function(e,t){return e!==t}:3===e?function(e,t){return e<t}:4===e?function(e,t){return e===t}:5===e?function(e,t){return t<e}:void 0},R.prototype.PDt=function(e,t,n,r){var i,o,a,u,s,f,i=null,a=_.tbt(t);return a&&(u=t.replace(/\*+/g,"*"))!==t&&(a=_.tbt(u)),i=4===n||2===n?a?"^[\\s\\S]*$"===a?O.ExcelCompatibleCalcMode?4===n?function(e){return v.OMt(e)}:function(e){return!v.OMt(e)}:4===n?function(e){return""!==e&&v.OMt(e)}:function(e){return!(T(e)||""!==e&&v.OMt(e))}:(s=_.OJ(a),4===n?function(e){return s.lastIndex=0,v.OMt(e)&&s.test(e)}:function(e){return!T(e)&&(s.lastIndex=0,!v.OMt(e)||!s.test(e))}):""===t?4===n?function(e){return""===e||D(e)}:function(e){return""!==e&&!D(e)}:4===n?(o=this.GDt(e,Ze.stringEqual,r,function(e){return e&&e.toUpperCase&&e.toUpperCase()}),t):O.ExcelCompatibleCalcMode?function(e){return t!==(e&&e.toUpperCase&&e.toUpperCase())}:function(e){return!T(e)&&t!==(e&&e.toUpperCase&&e.toUpperCase())}:(f=R.getCompareFunction(n),O.ExcelCompatibleCalcMode?function(e){return Ot(e)&&f(e.toUpperCase(),t)}:a?function(e){return!T(e)&&!Xt(e=D(e)?"":e)&&!w.W0(e)&&f(e.toString().toUpperCase(),t)}:function(e){return!T(e)&&(D(e)&&(e=""),f(e.toString().toUpperCase(),t))}),new We(i,o,e,r)},R.prototype.GDt=function(e,t,n,r){var t,i,o,a,u;if(pt(e)&&this.referenceCache){if(t=e.getKey()+","+t,!(i=this.referenceCache.get(t)))for(i=[],-1!==n&&this.referenceCache.set(t,i),o=e.toArray(0,2,!1,!1),a=0;a<L(o);a++)i[a]=r(o[a]);return 2===n?i.Kyn=t:1!==n||i.DDt||(i.DDt=u=(0,H.createMap)(),i.forEach(function(e,t){var n=u.get(e);n||u.set(e,n=[]),n.push(t)})),i}return r},R.prototype.T9t=function(e,t,n){var r,i,o,r,a,u,s,f,c,h,l,r=this.p9t(t),i=r[0],o=r[1],r=null,u={value:o},s={value:0},f=R.getCompareFunction(i);if(T(o=Ot(o)&&(c=m.parse(o))?c:o)&&(4===i||0===i||1===i?r=function(e){return o._code===(e&&e._code)}:2===i&&(r=function(e){return o._code!==(e&&e._code)})),O.ExcelCompatibleCalcMode){if(null===o)4===i?r=function(e){return D(e)}:2===i&&(r=function(e){return!D(e)});else if(R.LDt(o))h=R.FDt(o),r=4===i?h:2===i?function(e){return e!==h}:function(e){return Yt(e)&&f(e,h)};else if(!R.BDt(o)&&He(o,u))r=4===i?(a=this.GDt(e,Ze.compatibleDoubleEqual,n,function(e){return D(e)||R.BDt(e)||R.LDt(e)||!b(e,s)?p:s.value}),u.value):2===i?function(e){return!Xt(e=w.W0(e)?d(e):e)||e!==u.value}:function(e){return Xt(e=w.W0(e)?d(e):e)&&f(e,u.value)};else if(v.OMt(o))return this.PDt(e,o,i,n)}else if(null===o)r=4===i?function(e){return D(e)}:2===i?function(e){return!T(e)&&!D(e)&&!R.BDt(e)}:t;else if(!R.LDt(o)||4!==i&&2!==i){if(4===i&&g.Common.ut(o,Date))o=o.getTime(),r=function(e){if(e&&B.kDt(e,s))return s.value.getTime()===o};else if(!R.BDt(o)&&He(o,u))r=4===i?(a=this.GDt(e,Ze.unCompatibleDoubleEqual,n,function(e){return D(e)||R.BDt(e)||!b(e,s)?p:s.value}),u.value):2===i?function(e){return!(T(e)||(e=w.W0(e)?d(e):e,!D(e)&&!R.BDt(e)&&b(e,s)&&s.value===u.value))}:function(e){if(e=w.W0(e)?d(e):e,!D(e)&&!R.BDt(e)){if(b(e,s))return f(s.value,u.value);if(v.OMt(e))return f(e.toString().toUpperCase(),o.toString().toUpperCase())}return!1};else if(v.OMt(o))return this.PDt(e,o,i,n)}else l=o.toString().toUpperCase(),r=4===i?function(e){return R.LDt(e)&&e.toString().toUpperCase()===l}:2===i?function(e){return!(T(e)||R.LDt(e)&&e.toString().toUpperCase()===l)}:function(e){return Yt(e)&&f(e,l)};return new We(r,a,e,n)},R.prototype.I9t=function(e,t,n,r){var i;this.T9t(e,t,r).RDt(n)},R.prototype.Fde=function(e,n,t){for(var r,i,o,a,u,s,f,c,h,l,d,m,v,p,b,T,y,r=[],i=[],o="s",a=[],u=0;u<e.length;u+=2)"function"!=typeof(s=this.T9t(e[u],e[u+1],0<t?2:-1)).criteria?(r.push(s.array),i.push(s.criteria),o+=s.array.Kyn):a.push(s);if(1<=r.length){if(f=this.referenceCache&&this.referenceCache.get(o),c=r.length,l=h=void 0,!f){for(d=r[0].length,f=(0,H.createMap)(),this.referenceCache&&this.referenceCache.set(o,f),f.oAn=[],m=1;m<c;m++)f.oAn[m]=(0,H.createMap)();for(m=0;m<d;m++){for(l=r[0][m],h=1;h<c;h++)(v=f.oAn[h].get(r[h][m]))||(v=f.oAn[h].size+1,f.oAn[h].set(r[h][m],v)),l+=","+v;(p=f.get(l))||f.set(l,p=[]),p.push(m)}}for(l=i[0],h=1;h<c;h++){if(!(v=f.oAn[h].get(i[h])))return;l+=","+v}if(b=f.get(l))for(T=void 0,T=1<a.length?function(e){for(var t=0;t<a.length;t++)if(!a[t].A9t(e))return;return n(e)}:1===a.length?(y=a[0],function(e){if(y.A9t(e))return n(e)}):n,m=0;m<b.length;m++)if(T(b[m]))return}else a[0].RDt(function(e){for(var t=1;t<a.length;t++)if(!a[t].A9t(e))return;return n(e)})},v.RangeCriteriaManager=R,C.d9t=function(e){var t=de(e);return M.ukt(e,t+1)?t+1:t},C.x9t=function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return 308<e&&(e=308),D(t)?le(10,parseFloat(e)):t},C.z9t=function(e){var t=me(e);return M.ukt(e,t-1)?t-1:t},C.Lkt=function(e,t){for(var n,r,i,o,a,u,u,n=C.x9t(s(t)),r=me,i=de,o=t,a=o<0?e/n:e*n;2<s(o)&&a===1/0;)o=Math.round(o/2),n=C.x9t(s(o)),a=o<0?e/n:e*n;return u=(e=a).toExponential(),e=(e=(u=ie(u.split("e")[1])+1)<=15&&-85<=u?parseFloat(e.toFixed(15-u)):e)<0?r(e-.5):i(e+.5),Ve(e=t<0?e*n:e/n)},C.g9t=function(e,t){var n,r;if(e<0||t<0||e<t)return I;for(n=1,t=Math.min(e-t,t),r=1;r<=t;r++)n=n*(e-r+1)/r;return Ve(n)},C.N9t=function(e,t){if(e<0&&s(t)<1){var n=(1/t).toPrecision(15);if(parseFloat(n)===parseInt(n,10)&&parseInt(n,10)%2!=0)return-le(-e,t)}return le(e,t)},C.kkt=function(e,t){var t=.5<s(e)?le(1+e,t):ce(t*he(1+e));return isFinite(t)?oe(t)&&(t=5e-324):t===Number.POSITIVE_INFINITY?t=v.B6t:t===Number.NEGATIVE_INFINITY&&(t=-v.B6t),t},C.vkt=function(e,t){return(ce(e)+(t?-1:1)*ce(-e))/2},C.ckt=function(e,t){return oe(e)?e:oe(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?10===t?Math.log10(e):he(e)/he(t):NaN},v.MathHelper=C,O.Functions=Ce,Ne=function(e,t){var n=e.localeCompare(t);return 0===n&&e!==t?t<e?1:-1:n},O.Wkt=In,O.$kt=Sn,O.isFunction=Rn,O.isLambdaFunction=Cn,O.isExpression=Nn,O.getFunctionAcceptsArray=On,O.getFunctionAcceptsReference=Dn,O.getFunctionArrayArgumentEvaluateMode=Ln,P(Mn,et=e),Mn.prototype.startCalculation=function(){},Mn.prototype.endCalculation=function(e){},Mn.prototype.getValue=function(){return u.Reference},Mn.prototype.getReference=function(){var e=new xe(this,[Fn(0,0)]);return e.getValue=function(){return u.Reference},e},Mn.prototype.referenceToArray=function(){var e=[u.Reference];return e.isError=!0,e},Mn.prototype.getName=function(){return this.oyt},Mn.prototype.setValue=function(){},O.ErrorSource=Mn},"./src/calc.entry.ts":function(e,t,n){var r,i,o,a,r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){e[r=void 0===r?n:r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n("./src/Parser.ts"),t),i(n("./src/evaluator.ts"),t),i(n("./src/referenceExpression.ts"),t),i(n("./src/map.ts"),t),i(n("./src/set.ts"),t),o=n("./src/calc.ts"),Object.defineProperty(t,"supportRowColumnFormula",{set:function(e){o.supportRowColumnFormula=e},get:function(){return o.supportRowColumnFormula}}),Object.defineProperty(t,"approximatelyEqual",{set:function(e){o.approximatelyEqual=e},get:function(){return o.approximatelyEqual}}),i(n("./src/calc.ts"),t),a=n("./src/calc.common.ts"),Object.defineProperty(t,"ExcelCompatibleCalcMode",{set:function(e){a.ExcelCompatibleCalcMode=e},get:function(){return a.ExcelCompatibleCalcMode}}),Object.defineProperty(t,"TimeoutNodes",{set:function(e){a.TimeoutNodes=e},get:function(){return a.TimeoutNodes}}),Object.defineProperty(t,"TimeoutTime",{set:function(e){a.TimeoutTime=e},get:function(){return a.TimeoutTime}}),Object.defineProperty(t,"TimeoutPaintDelay",{set:function(e){a.TimeoutPaintDelay=e},get:function(){return a.TimeoutPaintDelay}}),Object.defineProperty(t,"usedbcs",{set:function(e){a.usedbcs=e},get:function(){return a.usedbcs}}),i(n("./src/calc.common.ts"),t)},"./src/calc.ts":function(_,v,e){var t,p,j,V,K,Y,b,w,i,I,S,R,y,X,W,C,te,N,Z,z,O,o,a,s,e,J,h,T,D,L,Q,ne,re,M,u,F,B,P,U,k,H,G,q,ie,oe,ae,ue,se,fe,ce,he,le,de;function me(e,t){var n,r,i,o,a,u,s,n=e.w3&&e.w3.getSource();n&&(r=e.row,i=e.column,o=n.getValue(r,i),(s=(u=n&&n.Mf)&&e.isDefault)&&(u.vle=e.isDefault()),n.setValue(r,i,t,o,W,!0),s)&&delete u.vle}function n(e){this.aT=[],this.w3=e}function r(e,t){var e=ue.call(this,e)||this;return e.name=t,e.delay=0,e}function f(e,t,n){var e=se.call(this,e)||this;return e.id=t,e.name=n,e.delay=0,e}function c(){this.calculationMode=0,this.rO={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.dynamicReferences=!0,this.HDt=0,this.zDt=0,this.VDt=[];var e=this;e.j3t=new K.Parser,e.MX=new Y.Evaluator(e),e.YDt=e.mwt&&e.mwt(),e.addResolver(new K.DefaultTokenResolver),e.ZDt={WDt:!0},e.PFe=0}function ve(){}function pe(e,t,n,r,i,o){be(e.QDt,e.qkt)&&(e.QDt&&(Te(n,e,e.QDt,!1),delete e.QDt),e.qkt)&&(Te(n,e,e.qkt,!0,o),e.QDt=e.qkt,delete e.qkt)}function be(e,t){return(!J(e)||!J(t))&&(J(e)||J(t)||Object.keys(e).join()!==Object.keys(t).join())}function Te(e,t,n,r,i){var o,a,u,s,u;for(o in n)n.hasOwnProperty(o)&&(a=n[o],u=e.rO[a.id])&&(Se(a)?(s=u.uT(!0)).JDt(a.rowUndefine?-1:a.row,a.colUndefine?-1:a.col,a.rowUndefine?-1:a.rowCount,a.colUndefine?-1:a.colCount,t,r,!0,i):((u=u.oT(a.row,a.col,!0))&&u.KDt(0,t,r),i&&u&&u.k1&&t.delay++))}function l(e,t){this.I8=0,this.x8=0,this.XDt=[],this.qDt=[],this.$Dt=[],this.dataTable={},this.dataTableByName={},this.AE=[],this.IE=[],this.t_t=0;var n=this;n.rT=t,n.Lbt=e}function d(e,t,n){var e=fe.call(this,e)||this;return e.row=t,e.column=n,e.delay=0,e}function ye(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function ge(e,t,n){var r,i,r=e[t];if(r)for(i=0;i<r.length;i++)if(r[i]===n)return void r.splice(i,1)}function m(e,t){var e=ce.call(this,e)||this;return e.row=t,e}function g(e,t){var e=he.call(this,e)||this;return e.column=t,e}function A(e,t){var e=le.call(this,e)||this;return e.name=t,e.GFe=(0,w.createSet)(),e}function Ae(e,t,n,r,i){var o,a,u,s,o=0;for(-1===r&&(t=0,r=e.rT.getRowCount()),-1===i&&(n=0,i=e.rT.getColumnCount()),a=0;a<r;a++)for(u=0;u<i;u++)(s=e.oT(a+t,u+n,!0))&&s.k1&&o++;return o}function Ee(e,t){var n,r,t,n=e.maxY-e.minY+1,r=e.maxX-e.minX+1,t=t[0];return(t="!"===t||"?"===t?t:"")+e.minY+","+e.minX+","+n+","+r}function E(e){return de.call(this,e)||this}function _e(e,t){var n,r,r;for(n in e)(r=e[n])&&(t?_e(r):(r=r.calc)&&r.CMt())}function we(e,t){var t;e.function||(t=t.getNameInfo(e.functionName))&&(e.functionName=t.Zc)}function xe(e,t,n,r,i,o,B){for(var a,u,s,f,c,h,l,d,m,v,p,b,T,y,g,A,E,P,U,k,_,w,x,I,S,R,C,N,O,D,S,R,C,E,L,b,M,M,F,H,a=e.row,u=e.column,s=[],f=0,h=c=0,m=r,v=i,p=l=!(s[f]={expr:t,acceptsArray:o||!1,acceptsRef:B||!1,index:-1});0<=f;){if(b=s[f],f--,T=b.acceptsArray,y=b.acceptsRef,t=b.expr,g=X,t)if(7===t.type){if(S=(I=t).arguments.length,!I.function){if(!e){g=(0,j.Syt)(te);continue}I.function=e.getFunction(I.functionName),we(I,e)}if(R=I.function,C=b.index,x=b.neeedExpendindexs,C<0?(b.arrayArgumentEvaluateMode=p,b.arrayFormulaCatchValue=n,(0,j.getFunctionArrayArgumentEvaluateMode)(R)&&(p=(0,j.getFunctionArrayArgumentEvaluateMode)(R)),b.args=[]):((0,j.getFunctionAcceptsArray)(R,C)?c--:l&&(x||(b.neeedExpendindexs=x=[]),I.arguments[C],x.push(C)),b.args.push(A)),C===S-1){if(p=b.arrayArgumentEvaluateMode,n=b.arrayFormulaCatchValue,O=!1,(N=b.args)&&0<N.length)for(D=0;D<N.length;D++)if(N[D]!==I.arguments[D]){O=!0;break}g=O?(0,j.YJ)(I,N):t,x&&0<x.length&&(g=(0,j.createExpandExpression)(g,x),l=!0)}else 0===C&&R&&3===(0,j.getFunctionArrayArgumentEvaluateMode)(R)&&3===p&&(p=0),l=!1,C++,b.index=C,(0,j.getFunctionAcceptsArray)(R,C)&&c++,s[++f]=b,s[++f]={expr:I.arguments[C],acceptsArray:(0,j.getFunctionAcceptsArray)(R,C),acceptsRef:(0,j.getFunctionAcceptsReference)(R,C),index:-1}}else if(1!==t.type||!t.hmt())if(1===t.type||13===t.type)S=13===t.type,R=t.source,C=t,y&&(T||!n&&1!==p&&3!==p)||a<0||u<0||4===p||C.source&&C.source.ayt||(0<c&&!n&&1!==p&&3!==p||0===c||2===p?(E=C.getRange(a,u),S?t.UFe=!0:g=n||(y||T)&&1===p?!C.isFullColumn&&1!==E.rowCount&&m>=E.rowCount||!C.isFullRow&&1!==E.colCount&&v>=E.colCount?(0,j.Syt)(z):(_=(C.isFullColumn?0:E.row)+(1===E.rowCount?0:m),w=(C.isFullRow?0:E.col)+(1===E.colCount?0:v),(0,V.knt)(R,t.endSource,_,w,!1,!1)):1<E.rowCount&&1<E.colCount||1<E.rowCount&&!C.isFullColumn&&(a<E.row||a>=E.row+E.rowCount)||1<E.colCount&&!C.isFullRow&&(u<E.col||u>=E.col+E.colCount)?(0,j.Syt)(Z):(_=C.isFullColumn||1<E.rowCount?a:E.row,w=C.isFullRow||1<E.colCount?u:E.col,(0,V.knt)(R,t.endSource,_,w,!1,!1))):l=!0);else if(9===t.type)E=(0,j.gDt)(t.operatorType),n&&J(t.value2)&&(E=!1),-1===b.index?(b.index=t.value2?0:1,s[++f]=b,s[++f]=$(t.value,E,E,-1)):0===b.index?(A!==t.value&&(g=(0,j.rbt)(t.operatorType,A,t.value2),b.expr=g),l&&((x=[]).push(0),b.neeedExpendindexs=x,l=!1),b.index=1,s[++f]=b,s[++f]=$(t.value2,E,E,-1)):(g=t.value2&&A!==t.value2?(0,j.rbt)(t.operatorType,t.value,A):J(t.value2)&&A!==t.value?(0,j.rbt)(t.operatorType,A,W):t,x=b.neeedExpendindexs,l&&(x?x.push(1):x=[t.value2&&t.value2===d?1:0]),x&&(g=(0,j.createExpandExpression)(g,x),l=!0));else if(10===t.type)-1===b.index?(b.index=0,s[++f]=b,s[++f]=$(t.value,T,y,-1)):t.value!==A&&(g=(0,j.Ayt)(A));else if(8===t.type)1===b.index?(h--,g=A,b.context&&(e=b.context)):(h++,s[++f]=$(t,T,y,1,e),b=e,M=L=void 0,t.source?(M=t.source,(b=new Y.EvaluateContext(M)).cloneFrom(e),L=M.getCustomName(t.value)):(L=e.getName(t.value,null,2<=h),(!e.source.getCustomName(t.value)||2<=h)&&(b=new Y.GloableEvaluateContext(e.source)).cloneFrom(e)),L=L||(0,j.Syt)(te),s[++f]=$(L,T,y,-1,e=b||e));else if(6===t.type)if(M=t,!T&&(0<c||n||1===p||3===p))l=!0,d=t;else if(!T&&0===c)if(m>=M.value.RowCount&&1<M.value.RowCount||v>=M.value.colCount&&1<M.value.colCount)g=(0,j.Syt)(z);else try{1===M.value.RowCount&&(m=0),1===M.value.colCount&&(v=0),g=typeof(F=M.value.getValue(m,v))===ne?(0,j.createStringExpression)(F):typeof F===Q?(0,j.createNumberExpression)(F):typeof F===re?(0,j.createBooleanExpression)(F):F._error?(0,j.Syt)(F):(H=new K.Parser).parse(e.source.getParserContext(e.useR1C1,ee(0,0)),F.toString())}catch(e){g=(0,j.Syt)(z)}A=g=g===X?t:g}return g}function Ie(e,t,n,r,B,P,i){for(var o,a,u,s,f,c,h,l,d,m,v,p,b,T,y,g,A,U,k,H,E,_,w,x,G,I,S,S,R,C,N,O,I,R,D,D,A,L,p,M,M,L,T,p,F,q,o=e.row,a=e.column,u=[],s=0,c=f=0,d=r,m=B,v=h=!(u[s]={expr:t,acceptsArray:P||!1,acceptsRef:i||!1,index:-1});0<=s;){if(p=u[s],s--,b=p.acceptsArray,T=p.acceptsRef,t=p.expr,y=X,t)if(7===t.type){if(I=(G=(x=t).arguments).length,!x.function){if(!e){y=(0,j.Syt)(te);continue}S=x.functionName,x.function=e.getFunction(S),we(x,e)}if(S=x.function,R=p.index,w=p.neeedExpendindexs,R<0?(p.arrayArgumentEvaluateMode=v,p.arrayFormulaCatchValue=n,(0,j.getFunctionArrayArgumentEvaluateMode)(S)&&(v=(0,j.getFunctionArrayArgumentEvaluateMode)(S)),p.args=[]):((0,j.getFunctionAcceptsArray)(S,R)?f--:h&&(w||(p.neeedExpendindexs=w=[]),x.arguments[R],w.push(R)),p.args.push(g)),R===I-1){if(v=p.arrayArgumentEvaluateMode,n=p.arrayFormulaCatchValue,N=!1,(C=p.args)&&0<C.length)for(O=0;O<C.length;O++)if(C[O]!==x.arguments[O]){N=!0;break}y=N?(0,j.YJ)(x,C):t,w&&0<w.length&&(y=(0,j.createExpandExpression)(y,w),h=!0)}else 0===R&&S&&3===(0,j.getFunctionArrayArgumentEvaluateMode)(S)&&3===v&&(v=0),h=!1,R++,p.index=R,(0,j.getFunctionAcceptsArray)(S,R)&&f++,u[++s]=p,u[++s]={expr:x.arguments[R],acceptsArray:(0,j.getFunctionAcceptsArray)(S,R),acceptsRef:(0,j.getFunctionAcceptsReference)(S,R),index:-1}}else if(1!==t.type||!t.hmt())if(1===t.type||13===t.type)I=13===t.type,R=t.source,D=t,i||T&&(b||!n&&1!==v&&3!==v)||o<0||a<0||(0<f&&!n&&1!==v&&3!==v||0===f||2===v?I?t.UFe=!0:(A=D.getRange(o,a),y=n||(T||b)&&1===v?!D.isFullColumn&&1!==A.rowCount&&d>=A.rowCount||!D.isFullRow&&1!==A.colCount&&m>=A.colCount?(0,j.Syt)(z):(E=(D.isFullColumn?0:A.row)+(1===A.rowCount?0:d),_=(D.isFullRow?0:A.col)+(1===A.colCount?0:m),(0,V.knt)(R,t.endSource,E,_,!1,!1)):1<A.rowCount&&1<A.colCount||1<A.rowCount&&!D.isFullColumn&&(o<A.row||o>=A.row+A.rowCount)||1<A.colCount&&!D.isFullRow&&(a<A.col||a>=A.col+A.colCount)?(0,j.Syt)(Z):(E=D.isFullColumn||1<A.rowCount?o:A.row,_=D.isFullRow||1<A.colCount?a:A.col,(0,V.knt)(R,t.endSource,E,_,!1,!1))):h=!0);else if(9===t.type)D=(0,j.gDt)(t.operatorType),A=T&&e.source&&e.source.Lbt&&e.source.Lbt.allowDynamicArray,-1===p.index?(n&&J(t.value2)&&(D=b=!1),p.index=t.value2?0:1,u[++s]=p,u[++s]=$(t.value,D||b,D||A,-1)):0===p.index?(g!==t.value&&(y=(0,j.rbt)(t.operatorType,g,t.value2),p.expr=y),h&&((w=[]).push(0),p.neeedExpendindexs=w,h=!1),p.index=1,u[++s]=p,u[++s]=$(t.value2,D||b,D||A,-1)):(y=t.value2&&g!==t.value2?(0,j.rbt)(t.operatorType,t.value,g):J(t.value2)&&g!==t.value?(0,j.rbt)(t.operatorType,g,W):t,w=p.neeedExpendindexs,h&&(w?w.push(1):w=[t.value2&&t.value2===l?1:0]),w&&(y=(0,j.createExpandExpression)(y,w),h=!0));else if(10===t.type)-1===p.index?(p.index=0,u[++s]=p,u[++s]=$(t.value,b,T,-1)):t.value!==g&&(y=(0,j.Ayt)(g));else if(8===t.type)1===p.index?(t.jwt=W,c--,y=g,p.context&&(e=p.context)):t.jwt||(t.jwt=!0,c++,u[++s]=$(t,b,T,1,e),p=e,M=L=void 0,t.source?(M=t.source,(p=new Y.EvaluateContext(M)).cloneFrom(e),L=M.getCustomName(t.value)):(L=e.getName(t.value,null,2<=c),(!e.source.getCustomName(t.value)||2<=c)&&(p=new Y.GloableEvaluateContext(e.source)).cloneFrom(e)),L=L||(0,j.Syt)(te),u[++s]=$(L,b,T,-1,e=p||e));else if(6===t.type)if(L=(M=t).value,!b&&(0<f||n||1===v||3===v))h=!0,l=t;else if(!b&&0===f)if(T=L.getRowCount(),p=L.getColumnCount(),T<=d&&1<T||p<=m&&1<p)y=(0,j.Syt)(z);else if(n||!(e.source&&e.source.Lbt&&e.source.Lbt.allowDynamicArray))try{1===T&&(d=0),1===p&&(m=0),y=typeof(F=M.value.getValue(d,m))===ne?(0,j.createStringExpression)(F):typeof F===Q?(0,j.createNumberExpression)(F):typeof F===re?(0,j.createBooleanExpression)(F):F._error?(0,j.Syt)(F):(q=new K.Parser).parse(e.source.getParserContext(e.useR1C1,ee(0,0)),F.toString())}catch(e){y=(0,j.Syt)(z)}g=y=y===X?t:y}return y}function $(e,t,n,r,i){return{expr:e,acceptsArray:t,acceptsRef:n,index:r,context:i}}function ee(e,t){return{row:e,col:t}}function x(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}}function Se(e){return-1===e.row||-1===e.col||e.rowUndefine||e.colUndefine||1<e.rowCount*e.colCount}function Re(e,t,n,r,i){r===i||!J(r)&&!J(i)||J(e)||(!J(r)&&J(i)&&e.removeRowAndColInfo(t,n),J(r)&&!J(i)&&e.addRowAndColInfo(t,n))}t=this&&this.__extends||(ae=function(e,t){return(ae=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ae(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Object.defineProperty(v,"__esModule",{value:!0}),v.Rwt=v.eV=v.h0t=v.Pyt=v.RangeCalc=v.NameCalc=v.ColumnCalc=v.RowCalc=v.CellCalc=v.CalcSourceModel=v.CalcArrayHelper=v.CalcService=v.PathCalc=v.NameIDCalc=v.BaseCalc=v.supportRowColumnFormula=v.approximatelyEqual=void 0,p=e("Common"),j=e("./src/calc.common.ts"),V=e("./src/referenceExpression.ts"),K=e("./src/Parser.ts"),Y=e("./src/evaluator.ts"),b=e("./src/map.ts"),w=e("./src/set.ts"),i=p.Common.ut,I=p.Common.J8,S=p.Common.X8,R=p.Common.zf,y=p.Common.ct,X=null,W=void 0,C=Math.abs,te=j.Errors.Name,N=j.Errors.Reference,Z=j.Errors.Value,z=j.Errors.NotAvailable,O=j.Errors.Calc,o=j.Convert.Nh,a=j.Convert.LE,s=R.Gmt,e=p.Common.lt,J=e.ht,h=Math.min,T={},D="rowSliceListeners",L="nameIDListeners",Q="number",ne="string",re="boolean",v.approximatelyEqual=M=function(e,t,n){var r;return!!((e=void 0===e?0:e)===(t=void 0===t?0:t)||i(e,j.CalcError)&&i(t,j.CalcError)&&e._code===t._code)||(r=1,i(e,Date)&&i(t,Date)?r=864e5:i(e,Date)?e=y.o0(e):i(t,Date)&&(t=y.o0(t)),C(t-e)/r<n)},v.supportRowColumnFormula=!1,n.prototype.getKey=function(){return""},n.prototype.hasListeners=function(){for(var e,t,n,r,i,o,e,t,n=0,r=this.aT;n<r.length;n++)if((o=this[i=r[n]])&&0<o.size)return!0;return!1},n.prototype.Iwt=function(e,t,n){var r,e,i,o;if(t.e_t)n||(delete t.e_t,this.Iwt(e,t,n),t.e_t=!0),this.i_t||(this.i_t=(0,b.createMap)()),r=this.i_t;else{if(!this[e]){if(!n)return;this.aT.push(e),this[e]=(0,b.createMap)()}r=this[e]}e=t.getKey(),t.ebt&&1<=t.ebt.length&&(t.e_t||(o=(i=t.ebt)[i.length-1]).push(this),e="?"+e),n?r.set(e,t):r.delete(e)},n.prototype.KDt=function(e,t,n){var r,i,r=this[e],i=t.getKey();i="!"+i,r||(this.aT.push(e),r=this[e]=(0,b.createMap)()),n?r.set(i,t):r.delete(i)},n.prototype.mB=function(){for(var e,t,n,r,i,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(n=this.aT,r=0;r<n.length;r++)(i=this[n[r]])&&i.forEach(function(e){e&&e.r_t()});this.i_t&&this.i_t.forEach(function(e){e&&e.r_t()})},n.prototype.o_t=function(){for(var e,t,n,r,i,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(n=this.aT,r=0;r<n.length;r++)(i=this[n[r]])&&i.forEach(function(e){e&&!e.k1&&e.vyt()})},n.prototype.CTe=function(){for(var e,t,n,r,i,e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i=!1,(e=(r=this)[0])&&e.forEach(function(e){e&&e.k1&&(i=!0)}),i||(null==(e=r.w3.uT())?void 0:e.CTe(r.row,r.column))},n.prototype.STe=function(e){var t,e,t=e?1:-1,e=this[0];e&&e.forEach(function(e){e&&(e.delay+=t)})},n.prototype.a_t=function(){for(var e,t,n,r,i,o,a,u,s,f,c,h,l,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(i=(r=this).aT,o=(n=e[0])?1:-1,a=e[1],u=0;u<i.length;u++)(s=this[i[u]])&&s.forEach(function(e,t){if("?"===t[0]){if(!n&&r.u_t)for(;0<=r.u_t.indexOf(e);)r.u_t.splice(r.u_t.indexOf(e),1),e.delay--}else e&&(e.delay+=o,n)&&e.s_t&&e.s_t()});if((f=a?a.$bt:r.node&&r.node.$bt)&&f.isDynamicArray)for(c=0;c<f.rowCount;c++)for(h=0;h<f.colCount;h++)0===c&&0===h||(l=r.w3.getNode(c+f.row,h+f.col))&&l.calc&&l.calc.a_t(n)},n.prototype.r_t=function(){},n.prototype.vyt=function(){},n.prototype.CMt=function(){},n.prototype.yB=function(){},n.prototype.c_t=function(){return this.w3.op()},v.BaseCalc=u=n,t(r,ue=u),r.prototype.getKey=function(){var e,t,n,e=this,t=e.w3,n;return(null===t?"":t.rT.id+",")+e.name},r.prototype.yB=function(){var e=this;e.w3.f_t(e.name,!0)},r.prototype.CMt=function(){var e=this;e.w3.f_t(e.name,!1)},r.prototype.r_t=function(){this.c_t().onAddAdjust(this,3)},r.prototype.vyt=function(){this.c_t().I3(this,3)},F=r,v.NameIDCalc=F,t(f,se=u),f.prototype.getKey=function(){var e=this;return e.w3.getName()+","+e.id+"#"+e.name},f.prototype.yB=function(){var e=this;e.w3.cyt(e.id,e.name,!0)},f.prototype.CMt=function(){var e=this;e.w3.cyt(e.id,e.name,!1)},f.prototype.c_t=function(){return this.w3.Lbt},f.prototype.r_t=function(){this.c_t().onAddAdjust(this,6)},f.prototype.vyt=function(){this.c_t().I3(this,6)},v.PathCalc=f,c.prototype.l_t=function(e,t,n){var r,i,o,r=this;if(r.h_t=r.h_t||{},i=r.h_t[t]=r.h_t[t]||[],n)i.push(e);else for(o=0;o<i.length;o++)i[o]===e&&(i.splice(o,1),o--)},c.prototype.AMt=function(e){var t,t,t=this,t=t.h_t&&t.h_t[e];t&&t.forEach(function(e){e.vyt()})},c.prototype.recalcAfterOperate=function(e){this.AMt(e),this.IsSuspended()||this.recalculateAll(!1)},c.prototype.getResolvers=function(){return this.VDt},c.prototype.addResolver=function(e){for(var t,n,t=this.VDt,n=0;;n++)if(!t[n]||e.priority>t[n].priority){t.splice(n,0,e);break}},c.prototype.dispose=function(){var e=this;e.rO={},e.d_t=X,delete e.calcListener},c.prototype.cloneFrom=function(e){var t=this;t.useR1C1=e.useR1C1,t.HDt=e.HDt,t.v_t=e.v_t,t.calcOnDemand=e.calcOnDemand,t.dynamicReferences=e.dynamicReferences,t.incrementalCalculation=e.incrementalCalculation},c.prototype.Hyt=function(){return this.YDt},c.prototype.getExternalSource=function(e,t){for(var n,r,i,o,n,r=this.getAllSourceModels(),i=0,o=r.length;i<o;i++)if(R.Dbt(r[i].getSource().getName(),t))return r[i].getSource();return X},c.prototype.getSourceModel=function(e){var t=this.rO[e.id];return t||(t=e.createSourceModel?e.createSourceModel(this):this.createSourceModel(this,e),this.rO[e.id]=t,e.setCalcSourceModel(t),e.setCalcService(this)),t},c.prototype.getGlobalSourceModel=function(e){return this.d_t||((e=e||new j.CalcSource).createSourceModel?this.d_t=e.createSourceModel(this):this.d_t=this.createSourceModel(this,e),e.setCalcSourceModel(this.d_t)),this.d_t},c.prototype.setSourceModel=function(e,t){(this.rO[e.id]=t).setCalcService(this)},c.prototype.getAllSourceModels=function(){var e,t,n,e=[],t=this.rO;for(n in t)e.push(t[n]);return e},c.prototype.removeSource=function(e){var t,n,r,i,o,e;for(i in this.suspend(),(t=this.rO[e.id])&&(""!==e.getName()&&this.onRemoveSource(e),delete this.rO[e.id]),this.clearDirties(),n=this.rO)(r=n[i]).Bde(!1);o=this.x3&&this.x3.Mf,e=e&&e.Mf,o&&e&&e===o&&(this.x3=null),this.resume(!1)},c.prototype.clearSource=function(){this.rO={},this.x3=null,this.clearDirties()},c.prototype.ignoreDirty=function(){return this.v_t},c.prototype.suspend=function(e){this.HDt++,this.v_t=!!e},c.prototype.resume=function(e,t,n,r){var i=this;i.HDt--,i.HDt<0&&(i.HDt=0),i.IsSuspended()||(i.m_t=X,i.v_t=!1,i.recalculateAll(e,t,r,n))},c.prototype.suspendAdjust=function(){this.zDt++},c.prototype.resumeAdjust=function(){var e=this;e.zDt--,e.zDt<0&&(e.zDt=0)},c.prototype.isAdjustSuspended=function(){return 0<this.zDt},c.prototype.clearDirties=function(e){var t,n,r,i,o,a,u,t=this,n=t.y3,r=t.Kyt;if(n){for(o in i=!1,n)if(n.hasOwnProperty(o))if(e&&e[o])i=!0;else{for(a=n[o];a;)u=a.C3,a.k1=!1,t.PFe--,a=u?(a.C3=u.DF=W,u):X;delete n[o],r&&!J(r[o])&&delete r[o]}i||(t.y3=t.Kyt=X)}},c.prototype.Zct=function(){this.ZDt.WDt=!1,this.ZDt={WDt:!0}},c.prototype.resumeWithoutCalc=function(){this.HDt--,this.HDt<0&&(this.HDt=0),this.clearDirties({3:!0,6:!0}),this.v_t=!1,this.AMt(1),this.y3&&this.recalculateAll(!1,!0),this.Zct()},c.prototype.IsSuspended=function(){return 0<this.HDt},c.prototype.Ude=function(e){var t,n,r,i,t=this;for(i in this.Zct(),t.S9t=new j.Functions.RangeCriteriaManager,t.MX.startCache(e),r=t.rO)(n=r[i]).getSource().startCalculation()},c.prototype.Hde=function(e){var t,n,r,i,t=this,r=t.rO;for(i in r)(n=r[i]).getSource().endCalculation(e);t.MX.endCache(),t.S9t&&t.S9t.dispose(),this.Zct()},c.prototype.HJe=function(e,t,n){var r,i,o,a,r=this,o=r.rO;for(a in o)(i=o[a].getSource()).HJe&&i.HJe(e,t,n);r.S9t&&r.S9t.HJe(e)},c.prototype.recalculateAll=function(e,t,n,r){var i,e,i=this;!r&&1===i.calculationMode||i.IsSuspended()||(e&&i.y3&&delete i.tMt,i.dCn&&(clearTimeout(i.dCn),i.dCn=0),i.incrementalCalculation?i.HFe(!1,e,t,n,r):(delete i.VFe,i.PE=!0,i.Ude(t),e=i.zde(e,t,r)||[],i.Vde(r),i.Hde(n),delete i.PE,i.p_t&&(i.p_t.forEach(function(e){e[0].gF(e[1].row,e[1].col,e[1].rowCount,e[1].colCount)}),i.Ude(!0),e=e.concat(i.zde(!1,!0,r)),i.Vde(r),i.Hde(n),delete i.p_t),e&&e.forEach(function(e){i.I3(e,0)})))},c.prototype.MTe=function(){var n,r,e,t,i,o,a,u,s,f,c,h,l,d,n=this;if(n.Zct(),r={},n.y3)for(e in n.y3)if(n.y3.hasOwnProperty(e))for(r[e]=[],t=n.y3[e];t;)r[e].push(t),t=t.C3;if(n.zde(!0,!1),!(i=n.y3))return[];for(e in i)i.hasOwnProperty(e)&&i[e].w3.initDelay(n,parseInt(e,10));for(o=i[0];o;o=o.C3)a=o.row,u=o.column,o.STe(!0),(s=o.w3.uT(!1))&&s.a_t(a,u,!0);do{if(c=!1,i[0])for(o=i[0];o;o=f)f=o.C3,o.delay<=0&&(a=o.row,u=o.column,n.b_t(o,0),o.STe(!1,null),(s=o.w3.uT(!1))&&s.a_t(a,u,!1),c=!0)}while(c);do{if(c=!1,i[0])for(o=i[0];o;o=f)f=o.C3,o.CTe()||(n.b_t(o,0),c=!0)}while(c);if(h=[],i[0])for(t=n.y3[0];t;)h.push({row:t.row,col:t.column,rowCount:1,colCount:1,sheetName:t.w3.getSource().getName()}),t=t.C3;if(r)for(d in l=function(e){var t;r[e]&&(t=parseInt(e,10),r[e].forEach(function(e){n.I3(e,t)}))},r)l(d);return n.Zct(),h},c.prototype.zde=function(e,t,n){var r,i,o,a,u,s,f,c,h,l,r=this;if(!1!==e||!t)for(o in i=r.rO)i[o].Bde(e,t);if(a=r.y3){if(r.calcOnDemand||!1!==e||r.w_t(),a[1]&&a[1].w3.addListenersToDirty(r,1),a[2]&&a[2].w3.addListenersToDirty(r,2),!1===e){for(u in a)a.hasOwnProperty(u)&&(s=a[u])&&(s.w3.addListenersToDirty(r,parseInt(u,10)),s.processed=!0);for(u in a)a.hasOwnProperty(u)&&((s=a[u]).processed?delete s.processed:s.w3.addListenersToDirty(r,parseInt(u,10)))}if(f=[],"function"==typeof n)for(c=a[0],h=void 0,f=[];c;)h=c.C3,n(c)||(f.push(c),r.b_t(c,0)),c=h;return r.calcListener&&a[0]&&(l=r.kle(a[0]),r.calcListener(l)),f}},c.prototype.processDynamicRef=function(){var t,e,n,r,i,o,a,u,s,f,t=this;if(t.tMt){if(n=null,e=t.y3)for(n=[],r=void 0,i=e[0];i;i=r)n.push(i),r=i.C3;for(a in o=t.rO)(u=o[a]).Bde(!0,!1);if(e=t.y3)for(r=void 0,i=e[0];i;i=r)r=i.C3,t.b_t(i,0);for(s in t.tMt)t.tMt.hasOwnProperty(s)&&(f=t.tMt[s],u=t.rO[f.id])&&u.processDynamicListenerForCell(f.row,f.col);delete t.tMt,n&&0<n.length&&n.forEach(function(e){t.I3(e,0)}),this.Zct()}},c.prototype.w_t=function(){for(var e,t,n,r,i,o,a,u,s,f,c,h,l,d,m,v,p,a,i,b,e=this,t,r=e.y3[0];r;r=n)n=r.C3,r.isVolatile&&(i=r.row,o=r.column,u=(a=r.w3).rT,f=!0,(s=a.M_t(i,o)||a.ODt(i,o))&&(c=ee(i,o),h=u.getValue(i,o),l=!1,p=v=m=d=W,(a=a.sT(i,o))&&!0!==a.isDynamicArray&&(l=!0,d=a.row,m=a.col,v=a.rowCount,p=a.colCount),i=e.evaluateParsedFormula(u,s,c,l,!0,a&&!0!==a.isDynamicArray&&x(d,m,v,p),e.allowDynamicArray),r.QDt||r.qkt||(h===i?f=!1:h instanceof Date?(i instanceof Date&&h.valueOf()===i.valueOf()||typeof i===Q&&(b=y.o0(h))===i)&&(f=!1):typeof h===Q&&typeof i===Q&&(f=h!==i))),s)&&!f&&e.b_t(r,0)},c.prototype.kle=function(e){for(var t=0;e;)t++,e=e.C3;return t},c.prototype.Vde=function(e){var t,n,r,i,o,t=this;if((!t.calcOnDemand||e)&&(n=t.y3)){for(r in n)n.hasOwnProperty(r)&&n[r].w3.initDelay(t,parseInt(r,10));for(r in n)n.hasOwnProperty(r)&&n[r].w3.adjustDelayOfListeners(t,parseInt(r,10),!0);do{for(r in i=!1,n)n.hasOwnProperty(r)&&(o=n[r].w3.calculateDirtyNodes(t,parseInt(r,10)))&&(i=!0)}while(i);for(r in n)n.hasOwnProperty(r)&&n[r].w3.calculateIterations(t,parseInt(r,10));t.clearDirties(),t.y3=t.Kyt=W}},c.prototype.HFe=function(e,t,n,r,i){var e,i,o,a,u,s,e,o=this,a=o.VFe,u=!1;!e&&(a=o.VFe={round:0,step:0},n)?o.dCn=setTimeout(function(){o.HFe(!0,t,n)},500):o.IsSuspended()||(a.start=performance.now(),a.count=0,o.dCn=W,0===a.round?(0===a.step&&o.Ude(n||e),o.zFe(i,t,n)):1===a.round&&(o.p_t||0<a.step?(0===a.step&&(o.Hde(r),o.Ude(!0)),o.zFe(i,!1,!0)):(a.round=2,u=!0)),(u=u||0!==o.YFe?u:!0)||1===a.step||(s=null==(i=null==(e=o.getGlobalSourceModel())?void 0:e.rT)?void 0:i.vpt,e={totalCells:o.YFe,pendingCells:o.PFe},3===a.step&&(e.iterate=(a.i||0)+1),s&&s.ki(j.CALC_PROGRESS_EVENT,e),s&&!s.repaintTimeout&&(s.repaintTimeout=setTimeout(function(){var e;null!=(e=s.getActiveSheet())&&e.repaint(),s.repaintTimeout=W},j.TimeoutPaintDelay))),!u&&a.round<=1?o.dCn=setTimeout(function(){o.HFe(!0)},0):o.Hde(r))},c.prototype.zFe=function(e,t,n){var r,i,o,a,u,s,r=this,i=r.VFe;if(0===i.step)r.p_t&&(r.p_t.forEach(function(e){e[0].gF(e[1].row,e[1].col,e[1].rowCount,e[1].colCount)}),delete r.p_t),r.zde(t,n,e),i.step++,r.YFe=r.PFe;else if(1===i.step&&(r.ZFe(),r.YFe=r.PFe),o=r.y3){if(1===i.step){for(a in o)o.hasOwnProperty(a)&&o[a].w3.initDelay(r,parseInt(a,10));for(a in o)o.hasOwnProperty(a)&&o[a].w3.adjustDelayOfListeners(r,parseInt(a,10),!0)}else if(2===i.step){u=void 0;do{for(a in u=!1,o)if(o.hasOwnProperty(a)){if((s=o[a].w3.calculateDirtyNodes(r,parseInt(a,10)))===i)return;s&&(u=!0)}}while(u);0===r.PFe&&i.step++}else if(3===i.step)for(a in o)if(o.hasOwnProperty(a)&&o[a].w3.calculateIterations(r,parseInt(a,10))===i)return;i.step++,4===i.step&&(i.round++,i.step=0,r.clearDirties(),r.y3=r.Kyt=W)}else i&&i.round++,r.YFe=0},c.prototype.initParserContext=function(e){var t;this.x3||(this.x3=e.getParserContext(this.useR1C1))},c.prototype.getParserContext=function(e){var t,n,t=this,n=t.x3;return n||(e?t.x3=n=e.getParserContext(t.useR1C1):n=new K.ParserContext(X,t.useR1C1)),n.setSource(e),n},c.prototype.parseWithContext=function(e,t){return this.j3t.parse(e,t)},c.prototype.unparseWithContext=function(e,t){return this.j3t.unparse(e,t)},c.prototype.I3=function(e,t){var n,r,i,o,o,a,n=this;isNaN(t)||!e||e.k1||(!n.Vct||0!==t||(o=n.h_t&&n.h_t[n.Vct])&&0<=o.indexOf(e))&&(o=n.y3,a=n.Kyt,o||(o=n.y3={},a=n.Kyt={}),r=o[t],i=a[t],e.k1=!0,r?i.C3=e:o[t]=e,n.PFe++,e.DF=i,e.C3=X,a[t]=e)},c.prototype.b_t=function(e,t){var n,r,i,o,a,n=this;!isNaN(t)&&e&&e.k1&&(e.k1=!1,r=n.y3,i=n.Kyt,o=e.DF,a=e.C3,o?o.C3=a:r&&(a?r[t]=a:delete r[t]),a?a.DF=o:i&&(o?i[t]=o:delete i[t]),n.PFe--,e.DF=X,e.C3=X)},c.prototype.ZFe=function(){for(var e,t,n,r,t=this,n=t.y3&&t.y3[0];n;)r=n.C3,null!=(e=null==n?void 0:n.node)&&e.WK||t.b_t(n,0),n=r},c.prototype.evaluateExpression=function(e,t,n,r,i){var o;return this.MX.evaluateExpression(t,e.getEvaluatorContext(n,!1,void 0,t),!1,r,i)},c.prototype.onClearExpr=function(e,t){this.MX&&this.MX.asyncManager.clearCell(e,t)},c.prototype.parse=function(e,t,n,r,i,o,a,u){var s,f,e,c,a,s=this,f=s.m_t,e=s.getParserContext(e);return e.useR1C1=!a&&s.useR1C1,e.ignoreError=o,e.keepUnknownFormulas=u,e.row=n,e.column=r,e.culture=i,f?(c=f[t])||(a=s.j3t.parse(e,t),f[t]=a):s.j3t.parse(e,t)},c.prototype.unparse=function(e,t,n,r,i,o,a){var e,n,e=this.getParserContext(e);return e.useR1C1=this.useR1C1,e.row=n,e.column=r,e.culture=i,e.addSheetName=a,o&&(e.lyt=!0,e.useR1C1=2===o),n=this.j3t.unparse(e,t),e.lyt=!1,n},c.prototype.recalculate=function(e,t,n,r){var e,i,r,e=this.getSourceModel(e),i=this;-1===n?e.gF(t,0,1,e.cC()):-1===t?e.gF(0,n,e.rC(),1):e.Gde(t,n),this.IsSuspended()||(this.recalculateAll(!1,r),r&&1===i.calculationMode&&!i.IsSuspended()&&(r=e.oT(t,n),e.recalculateCell)&&r instanceof u&&e.recalculateCell(r))},c.prototype.recalculateByName=function(e,t){var n,e;t&&(e=(n=this.getSourceModel(e)).C_t(s(t),!0),this.I3(e,3),this.IsSuspended()||this.recalculateAll(!1))},c.prototype.recalcRange=function(e,t,n,r,i){var e=this.getSourceModel(e);-1===n?e.gF(t,0,r,e.cC()):-1===t?e.gF(0,n,e.rC(),i):e.gF(t,n,r,i),this.IsSuspended()||this.recalculateAll(!1)},c.prototype.evaluate=function(e,t,n,r,i){var o,t,o=this,t=t instanceof j.Expression?t:o.parse(e,t,n,r);return o.MX.evaluateExpression(t,e.getEvaluatorContext(ee(n,r),!1,void 0,t),!1,i,i)},c.prototype.Abt=function(e,t,n,r,i){var o,a,u;if(!J(t)){if(o=this.MX,(a=i)||((a=e.getEvaluatorContext(n,!1,X,t)).S_t=r),o.asyncManager.startCalcCell(e,n),u=this.MX.evaluateExpression(t,a,r,!0,!0),o.asyncManager.endCalcCell(),!i)return new Promise(function(e,t){o.asyncManager.T_t(n.Tbt)?a.A_t=e:e(u)}).then(function(e){return o.asyncManager.I_t(n.Tbt),e});o.asyncManager.x_t(n.Tbt)&&a.A_t(u)}},c.prototype.evaluateParsedFormula=function(e,t,n,r,i,o,a,u,s,f){var c,h,l,d,e,o,n,s,u,m,v,p,e,n,t;if(!J(t)){if(c=n.row||0,h=n.col||0,l=o?o.row:c,d=o?o.col:h,(e=e.getEvaluatorContext(n,r,o,t,s)).N_t=u,n=4===arguments.length&&r||a,this.allowDynamicArray&&!r&&(e.k_t=!t.ensureSingle),(o=this.MX.evaluateExpression(t,e,i,n&&!t.ensureSingle,n&&!t.ensureSingle,f))&&o.pause)return o;if(r&&arguments.length<=5)return o;if(!r&&a&&(j.Convert.LE(o)||j.Convert.Nh(o)))return o;if(j.Convert.LE(o)){if(s=o.getRowCount(0),u=o.getColumnCount(0),1!==o.getRangeCount())return Z;try{if(m=r?c-l:c-o.getRow(0),v=r?h-d:h-o.getColumn(0),p=ee(0,0),1!==s||1!==u)if(1===s&&1<u&&0<=v&&v<u)p.col=v;else if(1<s&&1===u&&0<=m&&m<s)p.row=m;else{if(!(r&&m<s&&v<u))return r?z:Z;p.row=m,p.col=v}o=o.getValue(p,0)}catch(e){return Z}}else if(j.Convert.Nh(o))if(r){if(n=(e=o).getRowCount(),t=e.getColumnCount(),1!==n&&n<=c-l||1!==t&&t<=h-d)return z;o=o.getValue(1===n?0:c-l,1===t?0:h-d)}else o=o.getValueByIndex(0);return o!==W&&o!==X||!1===i?o:0}},c.prototype.onAddAdjust=function(e,t){this.YDt.Qyt(e,t)},c.prototype.onRemoveSource=function(e){this.YDt.nwt(e)},c.prototype.createSourceModel=function(e,t){return new k(e,t)},v.CalcService=c,ve.getLength=function(e,t){return o(e)?e.getRowCount()*e.getColumnCount():a(e)?e.getRowCount(t=t||0)*e.getColumnCount(t):void 0},ve.getRowCount=function(e,t){return o(e)?e.getRowCount():a(e)?e.getRowCount(t=t||0):void 0},ve.getColumnCount=function(e,t){return o(e)?e.getColumnCount():a(e)?e.getColumnCount(t=t||0):void 0},ve.getValueByIndex=function(e,t,n){var r;return o(e)?e.getValueByIndex(t):a(e)?(r=e.getColumnCount(n=n||0),e.getValue(n,parseInt((t/r).toString(),10),t%r)):void 0},ve.getValue=function(e,t,n,r){return o(e)?e.getValue(t,n):a(e)?e.getValue(r=r||0,t,n):void 0},v.CalcArrayHelper=ve,l.prototype.getNode=function(e,t,n){var r,i,o,r=this,i=X;return 0<=e&&0<=t?(o=r.dataTable[e],n&&!o&&(o=r.dataTable[e]={},e>r.I8)&&(r.I8=e),o&&(i=o[t],n)&&!i&&(i=o[t]={},t>r.x8)&&(r.x8=t)):-1===e&&0<=t?(i=r.IE[t],n&&!i&&(i=r.IE[t]={},t>r.x8)&&(r.x8=t)):0<=e&&-1===t?(i=r.AE[e],n&&!i&&(i=r.AE[e]={},t>r.x8)&&(r.x8=t)):-1===e&&-1===t&&(i=r.xE,n)&&!i&&(i=r.xE={}),i},l.prototype.getNodeByName=function(e,t){var n,r,n=this,r=n.dataTableByName[e];return r=t&&!r?n.dataTableByName[e]={}:r},l.prototype.pB=function(e,t){var e=this.getNode(e,t);return e&&e.WK},l.prototype.Fyt=function(e,t){var e=this.getNode(e,t);return e&&e.eyt},l.prototype.sT=function(e,t){return this.getWorkingNodeInfo(e,t,2)},l.prototype.M_t=function(e,t){return this.getWorkingNodeInfo(e,t,1)},l.prototype.ODt=function(e,t,n){return this.getWorkingNodeInfo(e,t,0,n)},l.prototype.D_t=function(e){var e=this.getNodeByName(e);return e&&e.eyt},l.prototype.$yt=function(e){var e=this.getNodeByName(e);return e&&e.WK},l.prototype.Ile=function(e,t){var e=this.getNode(e,t);return e&&e.xle},l.prototype.Nle=function(e,t,n,r){var i=this.oT(e,t,!!n);i&&(r&&r.push([e,t,i.isDefault()]),i.isDefault(!!n))},l.prototype.clearAll=function(){var e=this;e.clear(-1,-1,-1,-1),e.dataTable={},e.dataTableByName={},e.AE=[],e.IE=[],e.xE=X},l.prototype.clear=function(e,t,n,r,i,o){this.d5(e,t,n,r,i,o)},l.prototype._Mt=function(){var e=this;_e(e.AE),_e(e.IE),_e(e.dataTable,!0),_e(e.dataTableByName),e.DMt()},l.prototype.DMt=function(){var e=this;e.dataTable={},e.dataTableByName={},e.AE=[],e.IE=[],e.xE=X,e.XDt=[],e.qDt=[],e.__t=X,e.E_t=X},l.prototype.addRows=function(e,t){var n,r,i,n=this,r=n.rC();if(!(e<0||r<e||t<0)){for(I(n.dataTable,r,e,t),I(n.AE,r,e,t),i=0;i<t;i++)n.dataTable[e+i]&&(n.dataTable[e+i]={rs:"n"});n.I8>=e&&(n.I8+=t)}},l.prototype.deleteRows=function(e,t,n){var r,i,r=this,i=r.rC();n&&(i+=t),e<0||i<=e||t<=0||(S(r.dataTable,i,e,t=i<e+t?i-e:t),S(r.AE,i,e,t),r.I8>=e+t?r.I8-=t:r.I8>=e&&(r.I8=e-1))},l.prototype.rge=function(e,t){e<t&&this.d5(e,-1,t-e,-1)},l.prototype.addColumns=function(e,t){var n,r,i,o,a,n=this,r=n.rC(),i=n.cC();if(!(e<0||i<e||t<0)){for(o=0;o<r;o++)(a=n.dataTable[o])&&e<i&&I(a,i,e,t);I(this.IE,i,e,t),n.x8>=e&&(n.x8+=t)}},l.prototype.deleteColumns=function(e,t,n){var r,i,o,a,u,r=this,i=r.rC(),o=r.cC();if(n&&(o+=t),!(e<0||o<=e||t<0)){for(a=0;a<i;a++)(u=this.dataTable[a])&&S(u,o,e,t);S(this.IE,o,e,t),r.x8>=e+t?r.x8-=t:r.x8>=e&&(r.x8=e-1)}},l.prototype.oge=function(e,t){e<t&&this.d5(-1,e,-1,t-e)},l.prototype.j_t=function(e,t,n){var r,n,i,o,o,r=[this,e,t];return n&&(r.newValue=n),n=this.getSource(),(i=this.getNode(e,t))?((o=i.$bt)&&(o.row!==e||o.col!==t)||n.setFormula(e,t,this.getFormula(e,t),o,!0),o=i.calc&&i.calc.isDefault&&i.calc.isDefault(),r.push(i.WK,i.eyt,i.$bt,o)):n.setFormula(e,t,null,null,!0),r},l.prototype.Vyt=function(e,t,n,r){e&&e.push(this.j_t(t,n,r))},l.prototype.pj=function(){var e,e,e;return this.Lbt.KAe||(e=(e=(e=this.getSource())&&e.getSheet())&&e.Ut)&&e.pj()},l.prototype.kMt=function(e,t,n,r,i,o,a){var u,s,u=this;-1===t?u.iwt(n,r,i):-1===n?u.ewt(t,r,i):(s=u.rT.Mf,a&&s&&(s.vle=!0),u.Gyt(t,n,r,i,o),a&&s&&delete s.vle)},l.prototype.bB=function(e,t,n,r){var i=this.getNode(e,t,!!n);i&&(r&&r.push([e,t,i.WK]),i.WK=n)},l.prototype.O_t=function(e,t,n,r,i,o,a,u){var s=this.getNode(e,t,!!n);s&&(this.Vyt(a,e,t),s.WK=n,(s.eyt||r)&&(s.eyt=r),(s.$bt||i)&&(s.$bt=i),s.isVolatile&&!n?this.R_t(s):(o||s.isVolatile)&&(s.isVolatile=o),u)&&(s.xle=u)},l.prototype.zyt=function(e,t,n){this.O_t(e,t,W,W,W,!1,n)},l.prototype.Lyt=function(e,t,n,r,i,o){var t=this.getNode(t,n);t&&t.WK&&e.O_t(r,i,t.WK,t.eyt,t.$bt,t.isVolatile,o,t.calc&&t.calc.isDefault&&t.calc.isDefault())},l.prototype.B_t=function(e,t){var e=this.dataTable[e];return e&&e[t]},l.prototype.Yyt=function(e,t,n){var e=this.getNode(e,t,!!n);e&&(e.eyt=n)},l.prototype.Uyt=function(e,t,n){var e=this.getNode(e,t,!!n);e&&(e.$bt=n)},l.prototype.rwt=function(e,t){var e=this.getNode(e,t);return e&&e.calc},l.prototype.L_t=function(e,t,n){var e=this.getNode(e,t,!0);e&&(e.calc&&e.calc.isVolatile&&this.R_t(e),e.calc&&e.calc.isPivotData&&this.F_t(e),e.calc=n)&&(n.node=e)},l.prototype.owt=function(e,t,n){var e=this.getNode(e,t,!0);e&&e.calc&&(e.calc.isVolatile&&this.R_t(e),e.calc.isPivotData&&this.F_t(e),this.Lbt.b_t(e.calc,n),e.calc=W)},l.prototype.P_t=function(e,t,n,r,i){var o,a,u,s,o=this,a=o.usedRange;0<=n&&0<=r?(s=(u=(u=o.dataTable[n])||(o.dataTable[n]={}))[r],(u[r]=i)&&i.calc&&(i.calc.isDefault&&i.calc.isDefault()&&(i.xle=!0),delete i.calc),a&&Re(a,n,r,s,i)):0<=n&&-1===r&&0<=e&&-1===t?o.AE[n]=i:0<=r&&-1===n&&0<=t&&-1===e&&(o.IE[r]=i)},l.prototype.SE=function(e,t,n,r){var i,o,a,i=this,o=i.getNode(e,t),a=i.getNode(n,r);o&&o.WK?i.P_t(e,t,n,r,o):a&&a.WK&&i.P_t(e,t,n,r,X),a&&a.WK?i.P_t(n,r,e,t,a):o&&o.WK&&i.P_t(n,r,e,t,X)},l.prototype.G_t=function(e,t,n){e.rbe||(e.rbe={},this.$Dt.push(e),t)||me(e,n)},l.prototype.U_t=function(e){delete e.rbe},l.prototype.H_t=function(){for(var e,t,n,r,i,o,e=this,t=[],n={},r=e.$Dt,i=e.$Dt.length,o=0;o<i;o++)r[o].rbe&&r[o].rbe!==n&&(r[o].rbe=n,t.push(r[o]));return e.$Dt=t,e.$Dt},l.prototype.lwt=function(){return this.XDt},l.prototype.z_t=function(){return this.qDt},l.prototype.nbt=function(e){e.isVolatile||(e.isVolatile=!0,this.XDt.push(e))},l.prototype.V_t=function(e){e.isPivotData||(e.isPivotData=!0,this.qDt.push(e))},l.prototype.R_t=function(e){var e,t,n,r,i;if(e.isVolatile=W,(e=this).t_t++,100<e.t_t){for(e.t_t=0,t=[],n=e.XDt,r=e.XDt.length,i=0;i<r;i++)n[i].isVolatile&&t.push(n[i]);e.XDt=t}},l.prototype.F_t=function(e){var e,t,n,r,i;for(e.isPivotData=W,t=[],n=(e=this).qDt,r=e.qDt.length,i=0;i<r;i++)n[i].isPivotData&&t.push(n[i]);e.qDt=t},l.prototype.getCalcService=function(){return this.Lbt},l.prototype.setCalcService=function(e){this.Lbt=e},l.prototype.op=function(){return this.Lbt},l.prototype.getSource=function(){return this.rT},l.prototype.hasFormula=function(e,t,n){return e=e!==W?e:-1,t=t!==W?t:-1,!!this.ODt(e,t,n)},l.prototype.setFormula=function(e,t,n,r,i,o,a,u,s){var f,c,h,l,o,h,d,m,f=this;if(n&&0===n.length&&(n=X),c=s&&n&&!r,i||c||!f.EF(e,t,1,1)||f.Y_t(),h=f.getFormula(e,t,W,!0),l=f.sT(e,t),o||h!==n&&(""!==h||n)&&(h||""!==n)||h===n&&l){if(o=f.op(),h=X,o)try{d=0<=e?e:0,m=0<=t?t:0,h=r||(n?o.parse(f.rT,n,d,m,!1,i,W,s):X),f.SB(e,t,h,W,!1,a,u)}catch(e){if(!i&&!c)throw e}0<=e&&0<=t&&f.rT.setFormula(e,t,n,W)}},l.prototype.getFormula=function(e,t,n,r){var i,r,o,i=this.op();return i&&(r=this.ODt(e,t,r))?(e=(o=this.sT(e,t))&&!0!==o.isDynamicArray?o.row:e,t=o&&!0!==o.isDynamicArray?o.col:t,i.unparse(this.rT,r,e,t,n)):X},l.prototype.setFormulaByName=function(e,t,n,r,i){var o,a,a,u;if(e&&(e=s(e),t&&0===t.length&&(t=X),(a=(o=this).getFormulaByName(e))!==t)&&(""!==a||t)&&(a||""!==t)){if(a=o.op(),u=X,a)try{u=t?a.parse(o.rT,t,0,0,!1,n):X,o.twt(e,u,W,!1,r,i)}catch(e){if(!n)throw e}o.rT.setFormula({name:e},t)}},l.prototype.getFormulaByName=function(e){var t,e,t=this.op();return t&&e&&(e=this.$yt(s(e)))?t.unparse(this.rT,e,0,0):X},l.prototype.Y_t=function(){throw(0,j.sR)().Exp_ArrayFormulaPart},l.prototype.rC=function(){return h(this.rT.getRowCount())},l.prototype.cC=function(){return h(this.rT.getColumnCount())},l.prototype.setArrayFormula=function(t,n,r,i,e,o,a,u,s){var f,c,h,l,d,m,v,l,e,f=this;if(e&&0===e.length&&(e=X),!f.rT.G3&&f.EF(t,n,r,i)&&f.Y_t(),t=t<0?0:t,n=n<0?0:n,h=f.op()){if(h.suspend(),f.d5(t,n,r,i,a),e){try{h.forceR1C1Formula?(l=h.useR1C1,h.useR1C1=!0,c=e?h.parse(f.rT,e,t,n,!1,o,!1):X,h.useR1C1=l):c=e?h.parse(f.rT,e,t,n,!1,o,o):X}catch(e){if(o)return;throw e}for(d=t;d<t+r;d++)for(m=n;m<n+i;m++)f.SB(d,m,c,x(t,n,r,i),!1,a,u,s)}0<=t&&0<=n&&f.rT.setArrayFormula(t,n,r,i,h.unparse(f.rT,c,t,n)),(l=(v=f.rT).t8)&&l.Fgt(t,n,r,i),h.resume(!(e=function(e){return e.w3===f&&e.row>=t&&e.row<t+r&&e.column>=n&&e.column<n+i}),W,e,!1)}},l.prototype.getWorkingNodeInfo=function(e,t,n,r){var i,o,a,i=this,a=i.rT;return e>=a.getRowCount()||t>=a.getColumnCount()?o:(0<=e&&0<=t?(!(o=!(o=i.getNode(e,t))||0===n&&!o.WK||1===n&&!o.eyt||2===n&&!o.$bt?i.getNode(e,-1):o)||0===n&&!o.WK||1===n&&!o.eyt||2===n&&!o.$bt)&&(o=i.getNode(-1,t)):o=0<=e&&-1===t?i.getNode(e,-1):-1===e&&0<=t?i.getNode(-1,t):i.getNode(-1,-1),r&&o&&o.calc&&o.calc.isDefault&&o.calc.isDefault()?void 0:o&&(0===n&&o.WK||1===n&&o.eyt||2===n&&o.$bt))},l.prototype.SB=function(e,t,n,r,i,o,a,u,s){var f,c,r,h,l,d,f,m,c,v,m,p,c,b,m,h=this,l=h.op(),d=h.oT(e,t,!0);l.Z_t&&l.MX.asyncManager.endCalcCell(),m=(f=r!==W&&null!==r)?r.row:e,c=f?r.col:t,v=h.rT,m=new Y.EvaluateContext(v,ee(m,c),f,W,W,d),c=!J(n&&n.aMt),n&&!n.sMt&&(n.eyt&&c?p=n.eyt:(p=l.allowDynamicArray?Ie(m,n,f,f?e-r.row:0,f?t-r.col:0,!0,!0):xe(m,n,f,f?e-r.row:0,f?t-r.col:0))===n?(p=W,c&&(n.sMt=!0)):(p.ensureSingle=n.ensureSingle,c&&l.allowDynamicArray&&((n.eyt=p).aMt=n.aMt))),r!==W&&(b=r),0<=e&&0<=t?(i!==W&&!i||(m=n?l.unparse(v,n,e,t):W,v.setFormula(e,t,m,b),s)||null==(f=h.oT(e,t))||!f.isDefault()||null==(r=null==(c=v.Mf)?void 0:c.Ut)||r.setDefaultValue(e,t,m,X,"expr",X,!0),h.Gyt(e,t,n,p,b,o,a)):0<=e&&-1===t?h.ewt(e,n,p,o,a):-1===e&&0<=t&&h.iwt(t,n,p,o,a),l.IsSuspended()||(1===l.calculationMode?(h.recalculateCell(d),h.lge(d,h),h.Lbt.b_t(d,0)):(l.incrementalCalculation&&o&&h.recalculateCell(d),l.recalculateAll(!1,void 0,u)))},l.prototype.twt=function(e,t,n,r,i,o){var a,u,s,f,r,c,a=this,u=a.op(),s,f=Ie(new Y.EvaluateContext(a.rT,ee(0,0),!1),t,!1,0,0);f=f===t?W:f,r!==W&&!r||i||(r=a.getFormulaByName(e),c=t?u.unparse(a.rT,t,0,0):W,a.rT.setFormulaByName&&a.rT.setFormulaByName(e,c,r)),a.W_t(e,t,f,null,o),i||u.recalculateAll(!1)},l.prototype.getRowExpression=function(e){return this.pB(e,-1)},l.prototype.getColumnExpression=function(e){return this.pB(-1,e)},l.prototype.W_t=function(e,t,n,r,i){var o,a,u,o,a=this.C_t(e,!0);a&&(i||a.CMt(),(u=this.getNodeByName(e,!0)).WK=t,r&&(r[0].push("dataTable",e),r[1]=u.WK),n=t&&n?n:W,u.eyt=n,i||a.yB(),a.vyt())},l.prototype.Gyt=function(e,t,n,r,i,o,a){var u,s,f,o,u,u,s=this,f=s.oT(e,t,!0);f&&(s.Vyt(o,e,t),u=null==(u=(o=s.rT).Mf)?void 0:u.vle,f.isDefault(!!u),(u=s.Lbt).onClearExpr(o,ee(e,t)),Te(u,f,f.QDt,!1),delete f.QDt,delete f.qkt,f.CMt(),s.bB(e,t,n),n?((r||s.Fyt(e,t))&&s.Yyt(e,t,r),i&&!0===i.isDynamicArray||s.Uyt(e,t,i)):(s.Yyt(e,t,W),s.Uyt(e,t,W)),s.cMt||f.yB(),f.vyt())},l.prototype.ewt=function(e,t,n,r,i){var o,a,o=this,a=o.cwt(e,!0);a&&(o.Vyt(r,e,-1),i||a.CMt(),o.bB(e,-1,t),(n||o.Fyt(e,-1))&&o.Yyt(e,-1,n),i||a.yB(),a.vyt())},l.prototype.iwt=function(e,t,n,r,i){var o,a,o=this,a=o.uwt(e,!0);a&&(o.Vyt(r,-1,e),i||a.CMt(),o.bB(-1,e,t),(n||o.Fyt(-1,e))&&o.Yyt(-1,e,n),i||a.yB(),a.vyt())},l.prototype.d5=function(e,t,n,r,i,o){for(var a,u,s,f,c,h,l,d,m,d,v,p,b,T,a=this,u=e<0?0:e,s=t<0?0:t,f,c,h=u+(e<0?a.rC():n)-1,l=s+(t<0?a.cC():r)-1,v=function(e,t){var n,n;o&&(n=a.oT(e,t))&&n.isDefault()||(d=a.Fyt(e,t),m=a.pB(e,t),(d||m)&&(n=(d=a.sT(e,t))&&!0!==d.isDynamicArray?x(d.row,d.col,d.rowCount,d.colCount):W,a.SB(e,t,X,n,!0,i)))},p=a.usedRange,b=u;b<=h&&0<=b;b++)if(a.dataTable[b])for(t<0&&(v(b,-1),p)&&p.removeRowAndColInfo(b,-1),T=s;T<=l&&0<=T;T++)b===u&&e<0&&(v(-1,T),p)&&p.removeRowAndColInfo(-1,T),v(b,T),p&&p.removeRowAndColInfo(b,T);e<0&&t<0&&v(e,t)},l.prototype.EF=function(e,t,n,r){return this.mMt(e,t,n,r,!0,!0)},l.prototype.mMt=function(e,t,n,r,i,o){for(var a,u,s,f,c,h,l,d,m,v,p,b,T,y,g,A,E,_,w,a=this,u=e<0?0:e,s=t<0?0:t,f=e<0?a.rC():n,c=t<0?a.cC():r,h=u+(0===f?1:f)-1,l=s+(0===c?1:c)-1,d=!1,m=[],v=[],T=a.dataTable,y=u;y<=h&&0<=y&&!(y>a.I8);y++)if(b=T[y])for(g=s;g<=l&&0<=g&&!(g>a.x8);g++)if(p=b[g])if(E=void 0,(A=p.$bt)&&!A.isDynamicArray){if(A.row<u||A.row+A.rowCount-1>h||A.col<s||A.col+A.colCount-1>l){if(i)return _=A.row===e&&0===n,w=A.col===t&&0===r,!_&&!w;d=!0}y!==A.row&&y!==u||(m.push(x(A.row,A.col,A.rowCount,A.colCount)),E=p.WK,v.push(E),g=A.col+A.colCount-1)}else o||(E=p.WK)&&(m.push({row:y,col:g}),v.push(E));return!i&&{hasPart:d,ranges:m,formulas:v}},l.prototype.getCalcObj=function(){for(var e,t,n,r,i,o,a,u,s,f,c,h,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(r=e[1],i=this,o=(n=e[0]).row,a=n.column,u=null,isNaN(o)||isNaN(a))n.name&&(u=i.C_t(n.name,r));else if(0<=o&&0<=a)if(n.hmt())u=i.oT(o,a,r);else for(s=n.endRow,f=n.endColumn,u=[],c=o;c<=s;c++)for(h=a;h<=f;h++)u.push(i.oT(c,h,r));else 0<=o?u=i.cwt(o,r):0<=a&&(u=i.uwt(a,r));return u},l.prototype.C_t=function(e,t){var n,r,i,n=this,r=X,i=n.getNodeByName(e,t);return i&&!(r=i.calc)&&t&&(r=new F(n,e),(i.calc=r).node=i),r},l.prototype.MMt=function(e){var t,n,r,i,t=this.dataTable;for(n in t)for(r in t[n])(i=t[n][r])&&i.calc&&e(i.calc)},l.prototype.oT=function(e,t,n){var r,i,o,a,o,r=this,i=X;if(0<=e&&0<=t){if(!(a=(o=r.dataTable)[e])){if(!n)return i;a=o[e]={},e>r.I8&&(r.I8=e)}if(!(o=a[t]))return n&&(o=a[t]={},i=new H(r,e,t),(o.calc=i).node=o,t>r.x8)&&(r.x8=t),i;!(i=o.calc)&&n&&(i=new H(r,e,t),(o.calc=i).node=o,e>r.I8&&(r.I8=e),t>r.x8)&&(r.x8=t)}return i},l.prototype.cwt=function(e,t){var n,r,n=this,r=X;return 0<=e&&!(r=n.rwt(e,-1))&&t&&(r=new G(n,e),n.L_t(e,-1,r),e>n.I8)&&(n.I8=e),r},l.prototype.uwt=function(e,t){var n,r,n=this,r=X;return 0<=e&&!(r=n.rwt(-1,e))&&t&&(r=new q(n,e),n.L_t(-1,e,r),e>n.x8)&&(n.x8=e),r},l.prototype.uT=function(e){var t=this;return!t.__t&&e&&(t.__t=new oe(t)),t.__t},l.prototype.iFe=function(){var e=this;return e.rT.iFe&&e.rT.iFe()},l.prototype.vwt=function(e,t){var n,r,i,n=this,i=s(e);return n.E_t||(n.E_t={}),r=!(r=n.E_t[i])&&t?n.E_t[i]=new ie(n,e):r},l.prototype.dFe=function(e,t,n,r,i){var o,a,u,o=this,a=o.E_t&&o.E_t[s(e)],u=o.E_t&&o.E_t[s(t)];return r||u&&u.QFe(!1,i)?n||a&&a.QFe(!0)?2:3:(a&&(a.name=t,delete o.E_t[s(e)]),o.E_t&&(o.E_t[s(t)]=a),1)},l.prototype.updateNameCalc=function(e,t){var e=this.vwt(s(e));e&&(e.updateListening(!0,t),e.vyt())},l.prototype.Q_t=function(e,t){for(var n,r,i,o,n=this,r=h(n.x8,e+t-1),i=e;-1!==i&&i<=r;i++)n.isEmpty(-1,i)&&(o=n.uwt(i,!0),n.Lbt.I3(o,2))},l.prototype.K_t=function(e,t){for(var n,r,i,o,n=this,r=h(n.I8,e+t-1),i=e;-1!==i&&i<=r;i++)n.isEmpty(i,-1)&&(o=n.cwt(i,!0),n.Lbt.I3(o,1))},l.prototype.Gde=function(e,t){var n,r,r,r,n=this;n.B_t(e,t)?(r=n.oT(e,t,!0),n.Lbt.I3(r,0)):(r=n.uT(!1))&&r.o_t(e,t,1,1),n.K_t(e,1),n.Q_t(t,1),(r=n.iFe())&&r.o_t(e,t)},l.prototype.mHe=function(e,t){var n,r,i,o,a,u,s,f,c,n=this,r=null,i=1,o=1,a=h(n.I8,e+1-1),u=h(n.x8,t+1-1);for(-1!==e&&-1===t?(t=0,u=n.x8):-1===e&&-1!==t&&(e=0,a=n.I8),s=e;s<=a;s++)for(f=t;f<=u;f++)n.B_t(s,f)&&(r=n.oT(s,f,!0)).o_t(3);(c=n.uT(!1))&&c.o_t(e,t,1,1,3)},l.prototype.gF=function(e,t,n,r){for(var i,o,a,u,s,f,c,c,i=this,o=null,a=h(i.I8,e+n-1),u=h(i.x8,t+r-1),s=e;s<=a;s++)for(f=t;f<=u;f++)i.B_t(s,f)&&(o=i.oT(s,f,!0),i.Lbt.I3(o,0));i.K_t(e,n),i.Q_t(t,r),(c=i.uT(!1))&&c.o_t(e,t,n,r),(c=i.iFe())&&c.o_t(e,t,n,r)},l.prototype.p3=function(){var t,e,e,t=this;t.MMt(function(e){e.J_t(t)}),(e=t.uT(!1))&&e.J_t(t),(e=t.iFe())&&e.J_t(t)},l.prototype.Yde=function(){for(var e,t,n,n,r,i,n,e=this,t=e.lwt().concat(e.H_t()).concat(e.z_t()),r=0;r<t.length;r++)(i=t[r])&&(i.isVolatile||i.rbe||i.isPivotData)&&i instanceof H&&!i.k1&&(n=e.oT(i.row,i.column,!0),e.Lbt.I3(n,0),(n=e.cwt(i.row,!1))&&!e.$_t(n)&&e.K_t(i.row,1),n=e.uwt(i.column,!1))&&!e.$_t(n)&&e.Q_t(i.column,1)},l.prototype.$_t=function(e){return e.k1},l.prototype.isDirtyColumn=function(e){return e.k1},l.prototype.isEmpty=function(e,t){return!(!this.rwt(e,t)&&!this.pB(e,t))},l.prototype.processDynamicListenerForCell=function(e,t){var n,r,i,o,a,u,s,f,c,h,l,d,n=this,r=n.rT,i=n.M_t(e,t)||n.ODt(e,t);i&&(o=ee(e,t),a=!1,c=f=s=u=void 0,(h=n.sT(e,t))&&!0!==h.isDynamicArray&&(a=!0,u=h.row,s=h.col,f=h.rowCount,c=h.colCount),l=n.Lbt,d=n.rT.getCalcSourceModel().oT(e,t),l.evaluateParsedFormula(n.rT,i,o,a,!0,h&&!0!==h.isDynamicArray&&x(u,s,f,c),l.allowDynamicArray,!1,d),pe(d,r,l,e,t,!1))},l.prototype.recalculateCell=function(e,t){var n,r,i,o,a,u,s,f,c,h,l,d,m,v,p,b,T,c,d,m,t,l,m,a,d,l,b,n=this,r=n.rT,i=e.row,o=e.column,a=n.M_t(i,o)||n.ODt(i,o),u=r,s=u&&u.Mf,f={};if(a){if(J(a.ensureSingle)&&(a.ensureSingle=e.isDefault&&e.isDefault()),c=ee(i,o),h=r.getValue(i,o,W,!0),l=!1,p=v=m=d=void 0,(b=n.sT(i,o))&&!0!==b.isDynamicArray&&(l=!0,d=b.row,m=b.col,v=b.rowCount,p=b.colCount),b&&b.isDynamicArray&&(f.$bt=b),(T=n.Lbt).Z_t&&T.MX.asyncManager.startCalcCell(n.rT,c),c=T.evaluateParsedFormula(n.rT,a,c,l,!0,b&&!0!==b.isDynamicArray&&x(d,m,v,p),T.allowDynamicArray,t,e),t&&c&&c.pause)return c;if(pe(e,r,T,i,o,t),t&&0<e.delay)return{pause:"newDetectedRefs"};if(d=j.Convert.LE(c)||j.Convert.Nh(c),m=!1,t=void 0,l||!T.allowDynamicArray||a.ensureSingle||!a.t8t&&!d||(v=c.getRowCount?c.getRowCount():1,p=c.getColumnCount?c.getColumnCount():1,n.Uyt(i,o,t={row:i,col:o,rowCount:v,colCount:p,isDynamicArray:m=!0})),l=void 0,d&&((l=j.Convert.iV(c,0,!1,!1,!1)).isError||l.isConvertError?(c=Z,d=!1):(v=l.rowCount,p=l.colCount,0===v||0===p?(c=O,d=!1):1===v&&1===p?(c=l[0][0],J(c)&&(c=0),d=!1):m||(a.$9t=!0,c=j.Functions.findGlobalFunction("@").evaluate({row:i,column:o},c),d=!1))),d)t.nE=u.setArray(i,o,v,p,l),m=b&&b.rowCount||1,a=b&&b.colCount||1,t.nE&&(m<v||a<p)&&(T.p_t=T.p_t||[],T.p_t.push([n,t]));else if((d=u.updateItem&&u.updateItem(i,o,c))||h!==c){if(h instanceof Date){if(!d&&c instanceof Date&&h.valueOf()===c.valueOf())return f;if(typeof c===Q){if(l=y.o0(h),!d&&l===c)return f;c=y.Y0(c)}}(b=s&&e.isDefault)&&(s.vle=e.isDefault()),r.setValue(i,o,c,h,W,s&&s.vle),b&&delete s.vle}T.Z_t&&T.MX.asyncManager.endCalcCell(),u.Vbt&&u.Vbt(i,o)}return f},l.prototype.recalculateNameID=function(e){var t,n,r,i,t,t=this,n=t.rT,r=t.D_t(e)||t.$yt(e);!r||(i=n.getValueByName?n.getValueByName(e):n.getValue({name:e}))===(t=t.Lbt.evaluateParsedFormula(t.rT,r,{name:e},!1,!0))||i instanceof Date&&t instanceof Date&&i.valueOf()===t.valueOf()||(n.setValueByName?n.setValueByName(e,t):n.setValue({name:e},t))},l.prototype.Bde=function(e,t){var n,r,i,e,o,n=this;if(!1!==e){if(n.dataTableByName)for(r in n.dataTableByName)n.dataTableByName.hasOwnProperty(r)&&(i=n.dataTableByName[r]).calc&&i.calc.vyt();e=n.cC(),o=n.rC(),n.Q_t(0,e),n.K_t(0,o),n.gF(0,0,o,e)}else t||n.Yde()},l.prototype.Zde=function(e){for(var t,n,r,i;e.y3[1];){for(r=(n=(t=e.y3[1]).w3).cC(),i=0;i<r;i++)e.I3(n.oT(t.row,i,!0),0);e.b_t(t,1)}},l.prototype.Wde=function(e){for(var t,n,r,i;e.y3[2];){if(0<(r=(n=(t=e.y3[2]).w3).rC()))for(i=0;i<r;i++)e.I3(n.oT(i,t.column,!0),0);else t.o_t();e.b_t(t,2)}},l.prototype.n8t=function(e,t){for(var n,r,n=e.length,r=t;r;)e[n]=r,n++,r=r.C3},l.prototype.lge=function(e,t){var n,r,i,o,a,t,i,n=e.row,r=e.column,i=t.cwt(n,!1),o=t.uwt(r,!1),a=t.uT(!1),t=null==t?void 0:t.iFe();e.o_t(),i&&i.o_t(),o&&o.o_t(),a&&((i=e.node&&e.node.$bt)&&i.isDynamicArray?a.o_t(n,r,i.rowCount,i.colCount):a.o_t(n,r,1,1)),t&&t.o_t(n,r)},l.prototype.addListenersToDirty=function(e,t){var n,r,i,o,a,u,s,f,c;if(1===t)this.Zde(e);else if(2===t)this.Wde(e);else if(0===t)for(n=[],e.y3[2]&&this.n8t(n,e.y3[2]),r=e.y3[0];r;r=r.C3)for(i=r.w3,this.lge(r,i),this.Zde(e);e.y3[2];){for(o=e.y3[2],a=!1,u=0;u<n.length;u++)if(n[u]===o){a=!0;break}if(a);else{for(s=(i=(n[n.length]=o).w3).rC(),f=0;f<s;f++)e.I3(i.oT(f,o.column,!0),0)}e.b_t(o,2)}else if(3===t)for(c=e.y3[3];c;c=c.C3)c.o_t()},l.prototype.initDelay=function(e,t){var n,r,i,o,a,u,s;if(0===t)for(n=null,r=e.y3[0];r;r=n)r.QDt&&(Te(e,r,r.QDt,!1),delete r.QDt),n=r.C3,o=(i=r.w3).rC(),a=i.cC(),u=void 0,r.row<o&&r.column<a?(v.supportRowColumnFormula&&(u=i.uwt(r.column,!1))&&(u.delay=0),r.delay=0,delete r.u_t):e.b_t(r,0),u||r.node.WK||e.b_t(r,0);else if(3===t)for(s=e.y3[3];s;s=s.C3)s.delay=0},l.prototype.adjustDelayOfListeners=function(e,t,n){var r,i,o,a,u,s,f,i,c;if(0===t)for(r=e.y3[t];r;r=r.C3)i=r.w3,o=r.row,a=r.column,u=i.cwt(o,!1),s=i.uwt(a,!1),f=i.uT(!1),i=i.iFe(),r.a_t(n),u&&u.a_t(n),s&&s.a_t(n),f&&f.a_t(o,a,n),i&&i.a_t(o,a,n);else if(3===t)for(c=e.y3[3];c;c=c.C3)c.a_t(n)},l.prototype.calculateDirtyNodes=function(e,t,n){var r,i,o,a,u,s,f,c,f,h,l,d,m,v,p,b,l,d,T,r=!1,i=null,a=e.VFe;if(0===t){for(u=a&&a.c||e.y3[t],a&&(a.c=W),s=u;s;s=o)if(o=s.C3,f=!1,n&&s.i9t&&(f=!0,delete s.i9t),s.delay<=0||f){if(a&&++a.count>=j.TimeoutNodes&&(a.count=0,(c=performance.now())-a.start>j.TimeoutTime))return a.c=s,a;if(s.rbe&&this.U_t(s),i=s.w3,f=s.row,h=s.column,l=i.cwt(f,!1),!(d=i.uwt(h,!1))||!d.delay){if(m=i.uT(!1),(v=i.recalculateCell(s,!s.e8t||s.e8t<32))&&v.pause){if(s.e8t=s.e8t?s.e8t+1:1,v.branch)for(o=s,p=0;p<v.branch.length;p++)!v.branch[p].k1&&v.branch[p]!==s||(s.delay++,(b=v.branch[p]).u_t=b.u_t||[],b.u_t.push(s))}else delete s.e8t,e.b_t(s,0),s.a_t(!1,v),l&&l.a_t(!1),d&&d.a_t(!1),m&&m.a_t(f,h,!1),(l=i.iFe(s))&&l.a_t(f,h,!1),(d=s.node&&s.node.WK)&&d.lMt&&delete d.lMt;r=!0}}r||n||(r=this.calculateDirtyNodes(e,t,!0))}else if(3===t)for(T=e.y3[t];T;T=o)o=T.C3,0===T.delay&&(T.P6t?T.P6t():(i=T.w3).recalculateNameID(T.name),e.b_t(T,3),T.a_t(!1),r=!0);return r},l.prototype.calculateIterations=function(e,t){var n,r,i,o,a,u,s,f,c,h,l,d,m,h;if(0===t&&(n=e.VFe,r=e.y3[t]))if(o=!(i=null),e.iterativeCalculation){for(u in e.rO)e.rO.hasOwnProperty(u)&&((s=e.rO[u].getSource()).clearValueCache&&s.clearValueCache(),s.startIterativeCalc)&&s.startIterativeCalc();for(f=n&&n.i||0;o&&f<e.iterativeCalculationMaximumIterations;f++){if(o=!1,n&&(c=performance.now())-n.start>j.TimeoutTime)return n.i=f,n;for(i=r;i;i=i.C3)delete i.e8t,a=i.node&&i.node.WK&&i.node.WK.lMt,this.G_t(i,!a,X),a&&(i.node.WK.lMt=W),h=i.w3,l=i.row,d=i.column,m=h.getSource().getValue(l,d),h.recalculateCell(i),o||(h=h.getSource().getValue(l,d),(0,v.approximatelyEqual)(m,h,e.iterativeCalculationMaximumChange))||(o=!0)}for(u in e.rO)e.rO.hasOwnProperty(u)&&(s=e.rO[u].getSource()).endIterativeCalc&&s.endIterativeCalc()}else for(i=r;i;i=i.C3)a=i.node&&i.node.WK&&i.node.WK.lMt,this.G_t(i,!a,0),a&&(i.node.WK.lMt=W),delete i.e8t},l.prototype.cyt=function(e,t,n,r,i,o,a){var u,s,f,c,h,l,d,m,v,p,b,T,y,g,A,E,_,w,x,I,x,S,y,u,B,y,R,C,N,O,D,S,u,y,m,T,L,u,M,y,P,F,S,d,a,s=this;if(o&&s.U_t(e),r){for(;12===r.type;)r=r.value;for(;10===r.type;)r=r.value;for(;12===r.type;)r=r.value;if(i){for(;12===i.type;)i=i.value;for(;10===i.type;)i=i.value;for(;12===i.type;)i=i.value}if(i&&i!==r&&(8===i.type||7===i.type&&8===r.type)){if(i.source instanceof j.ErrorSource)return;if(c=(x=7===i.type)?i.functionName:i.value,i.value2&&c!==i.value2.name)return void(x?i.functionName=i.value2.name:i.value=i.value2.name);if(x=r.source||i.source||a||s.rT,(y=(S=s.Lbt.getGlobalSourceModel()||x.getCalcSourceModel()).getSource()).addUsedCustomName&&y.addUsedCustomName(c),!(I=x.getCalcSourceModel()))return;h=x.getCustomName(c),u=I.vwt(c,!0),l=S.vwt(c,!0),o&&(i.source||h)||(B=!o)&&i.value2===u?(i.value2=o?u:X,u&&u.Iwt(0,e,o),i.source||l.WFe(e,o)):(l.Iwt(0,e,o),(h=y.getCustomName(c))&&(i.value2=o?l:X),I=S),i=null,h&&s.cyt(e,t,n,h,X,o,I.getSource())}if(13===r.type){if(e.e_t&&o)return;if(null!=(u=r.abt)&&u.cyt)return void r.abt.cyt(e,r,o);if((y=r.getRange(t,n,!0))===X)return;r=1===y.rowCount&&1===y.colCount?(0,V.knt)(r.source,X,y.row,y.col,!1,!1):(0,V.lJ)(r.source,X,y.row,y.col,y.row+y.rowCount-1,y.col+y.colCount-1,!1,!1,!1,!1)}if(1===r.type&&r.endSource){if(C=(R=r).source.getSources(R.endSource))for(f=0;f<C.length;f++)(N=(0,V.lJ)(C[f],X,R.row,R.column,R.endRow,R.endColumn,R.rowRelative,R.columnRelative,R.endRowRelative,R.endColumnRelative,t,n)).isFullRow=R.isFullRow,N.isFullColumn=R.isFullColumn,s.cyt(e,t,n,N,X,o)}else if(1===r.type){if(O=s.rT,I=(x=r.source||O).getCalcSourceModel(),O&&O.G3&&x&&O.id!==x.id&&x.getSheet&&x.getSheet()&&O.addReferenceSheetName(x.getSheet().name()),!I&&x.ayt&&x.cyt&&x.cyt(e,o,r),I)if(D=r,S=e.row===W||e.column===W,u=D.Tyt(),m=(y=(0,V.getRangeForReference)(D,t,n)).row,p=y.col,v=m+(T=y.rowCount)-1,b=p+(y=y.colCount)-1,0===u){if(0<=t&&0<=n)J(D.endRow)?(g=I.oT(m,p,!0),S?g&&g.Iwt(3,e,o):g&&g.Iwt(0,e,o)):(d=I.uT(!0),S?d.i8t(m,p,T,y,e,o):d.JDt(m,p,T,y,e,o));else if(0<=t&&-1===n)for(_=m;_<=v;_++)for(w=p;w<=b;w++)D.columnRelative||D.endColumnRelative?(A=I.cwt(_,!0))&&A.r8t(e.row,-w,o):(g=I.oT(_,w,!0))&&g.Iwt(1,e,o);else if(0<=n&&-1===t)for(_=m;_<=v;_++)for(w=p;w<=b;w++)D.rowRelative||D.endRowRelative?(E=I.uwt(w,!0))&&E.o8t(e,-_,o):(g=I.oT(_,w,!0))&&g.Iwt(2,e,o)}else if(1===u){if(0<=t&&0<=n)d=I.uT(!0),S?d.i8t(m,p,T,y,e,o):d.JDt(m,p,T,y,e,o);else if(!(0<=t&&-1===n)&&-1===t&&0<=n&&!D.rowRelative&&!D.endRowRelative)for(m=D.row,v=D.endRow,_=m;_<=v;_++)(A=I.cwt(_,!0))&&A.Iwt(2,e,o)}else if(2===u){if(0<=t&&0<=n)d=I.uT(!0),S?d.i8t(m,p,T,y,e,o):d.JDt(m,p,T,y,e,o);else if(!(0<=t&&-1===n)&&-1===t&&0<=n)for(w=p;w<=b;w++)(E=I.uwt(w,!0))&&E.Iwt(2,e,o)}else 3===u&&(d=I.uT(!0),S?d.i8t(0,0,j.MAX_ROW_COUNT,j.MAX_COLUMN_COUNT,e,o):d.JDt(0,0,j.MAX_ROW_COUNT,j.MAX_COLUMN_COUNT,e,o))}else if(9===r.type)s.cyt(e,t,n,r.value,i&&9===i.type&&i.value,o),r.value2&&s.cyt(e,t,n,r.value2,i&&9===i.type&&i.value2,o);else if(8===r.type)!r.jwt&&(r.jwt=!0,x=r.source||a||s.rT,c=r.value,i?(h=x.getCustomName(c))?I=x.getCalcSourceModel():(h=(I=s.Lbt.getGlobalSourceModel()||x.getCalcSourceModel()).getSource().getCustomName(c))||(T=(m=x.getCalcSourceModel())&&m.vwt(c,!0))&&T.Iwt(0,e,o):h=(r.source?(I=x.getCalcSourceModel(),x):(I=s.Lbt.getGlobalSourceModel()||x.getCalcSourceModel()).getSource()).getCustomName(c),l=I.vwt(c,!0))&&(l.Iwt(0,e,o),h&&s.cyt(e,t,n,h,X,o,I.getSource()),r.jwt=W);else if(7===r.type){if(!r.jwt){if(r.jwt=!0,L=r.function)if((0,j.isExpression)(L))for(s.cyt(e,t,n,L,i&&7===i.type&&i.function instanceof j.Expression&&i.function,o),M=r.arguments.length,f=0;f<M;f++)s.cyt(e,t,n,r.arguments[f],i&&7===i.type&&i.arguments[f],o);else for(L&&((y=L.u9t)&&s.Lbt.l_t(e,y,o),L.isVolatile()&&(o?s.nbt(e):s.R_t(e)),"GETPIVOTDATA"===L.name&&(o?s.V_t(e):s.F_t(e)),L instanceof j.Functions.AsyncFunction)&&(s.Lbt.Z_t=!0),M=r.arguments.length,f=0;f<M;f++)L&&L.skipPrecedent(f)&&s.a8t(e,r,f,L,t,n)&&(e.e_t=!0),P=!1,this.Lbt.dynamicReferences&&L&&L.isBranch()&&L.findTestArgument()!==f&&e instanceof H&&(r.u8t=!0,F=e.getKey(),r.s8t=r.s8t||{},r.s8t[F]=r.s8t[F]||[],r.s8t[F][f]=[],P=!0,e.ebt=e.ebt||[],e.ebt.push(r.s8t[F][f])),s.cyt(e,t,n,r.arguments[f],i&&7===i.type&&i.arguments[f],o),P&&e.ebt.pop(),delete e.e_t;else for(!r.isLocalFunctionName&&r.functionName&&((u=new j.Expression(8)).value=r.functionName,s.cyt(e,t,n,u,r,o)),M=r.arguments.length,f=0;f<M;f++)s.cyt(e,t,n,r.arguments[f],i&&7===i.type&&i.arguments[f],o);r.jwt=W}}else 25===r.type||26===r.type?(d=(I=(x=(S=r).source||s.rT).getCalcSourceModel()).C_t(S.value,!0))&&d.Iwt(0,e,o):22!==r.type&&14!==r.type||(22===r.type&&(O=s.rT,x=r.source||O,O)&&O.G3&&x&&O.id!==x.id&&x.getSheet&&x.getSheet()&&O.addReferenceSheetName(x.getSheet().name()),(a=r).Iwt&&a.Iwt(e,o))}},l.prototype.a8t=function(e,t,n,r,i,o){var t,n,r,i,t=t.arguments[n];return!((t=12===t.type?t.value:t)&&t.function&&t.function.name||(r.i9t?!this.Lbt.dynamicReferences||!t||1!==t.type&&13!==t.type||(n=t.source||this.rT,this.Lbt.lb&&n&&n.getRangeKey&&((r=t.getRange(i,o)).rowUndefine&&(r.row=r.rowCount=-1),r.colUndefine&&(r.col=r.colCount=-1),r.id=n.id,i=n.getRangeKey(n,r),e.qkt||(e.qkt={}),e.qkt[i]=r,e.i9t=!0),0):!t||1!==t.type&&13!==t.type&&22!==t.type))},l.prototype.f_t=function(e,t){var n=this.getNodeByName(e);n&&(n.eyt||n.WK)&&this.cyt(this.C_t(e),0,0,n.eyt||n.WK,n.WK,t)},l.prototype.b_t=function(e,t,n,r){for(var i,o,a,u,s,f,c,h,l,i=this,o=e+n,a=t+r,c=e;c<o;c++)if(this.dataTable[c])for(h=t;h<a;h++)(s=i.pB(c,h))&&(l=i.oT(c,h),i.Lbt.b_t(l,0))},l.prototype.c8t=function(e,t,n,r,i,o,a){for(var u,s,f,c,h,l,d,m,v,u=this,s=e+n,f=t+r,d=e;d<s;d++)if(this.dataTable[d])for(m=t;m<f;m++)c=u.Fyt(d,m),h=u.pB(d,m),(c||h)&&(l=u.sT(d,m),a&&(!l||l.isDynamicArray)||(v=u.oT(d,m),o&&v.isDefault())||(l&&!0!==l.isDynamicArray?u.cyt(v,l.row,l.col,c||h,h,i):u.cyt(v,d,m,c||h,h,i),i&&v.qkt&&(Te(v.c_t(),v,v.qkt,!0,!1),v.QDt=v.qkt,delete v.qkt),i)||v.QDt&&Te(v.c_t(),v,v.QDt,!1,!1))},l.prototype.f8t=function(e,t,n){for(var r,i,o,r=e+t,i=e;-1!==i&&i<r;i++)(o=this.getColumnExpression(i))&&this.cyt(this.uwt(i,!1),-1,i,o,o,n)},l.prototype.l8t=function(e,t,n,r){this.c8t(e,t,n,r,!0)},l.prototype.mF=function(e,t,n,r,i,o){this.c8t(e,t,n,r,!1,i,o)},l.prototype.h8t=function(e,t){},l.prototype.hwt=function(e,t){},l.prototype.d8t=function(e,t){this.f8t(e,t,!0)},l.prototype.dwt=function(e,t){this.f8t(e,t,!1)},l.prototype.v8t=function(e,t,n,r,i,o,a){for(var u,s,f,c,h,l,u=e+n,s=t+r,f=this,c=e;c<u;c++)if(this.dataTable[c])for(h=t;h<s;h++)(l=this.oT(c,h,!1))&&(f.Vyt(a,c,h),i&&l.mB(),o)&&l.o_t()},l.prototype.m8t=function(e,t,n,r,i){var o,a,u,s,f,f,o=this,a=o.AE;if(-1!==e&&a)for(u=h(e+t,a.length),s=e;s<u;s++)(f=a[s])&&f.calc&&(o.Vyt(i,s,-1),f=f.calc,n&&f.mB(),r)&&f.o_t()},l.prototype.g8t=function(e,t,n,r,i){var o,a,u,s,f,f,o=this,a=o.IE;if(-1!==e&&a)for(u=h(e+t,a.length),s=e;s<u;s++)(f=a[s])&&f.calc&&(o.Vyt(i,-1,s),f=f.calc,n&&f.mB(),r)&&f.o_t()},l.prototype.Ryt=function(e,t,n,r,i,o,a){var u,s,a,f;(i||o)&&(u=this,s=void 0,a&&(s=2===a?[]:u.pj()),0<=e&&0<=t?(u.v8t(e,t,n,r,i,o,s),u.m8t(e,n,i,o,s),u.g8t(t,r,i,o,s),u.__t&&(i&&u.__t.mB(e,t,n,r),o)&&u.__t.o_t(e,t,n,r)):0<=e&&-1===t?(u.v8t(e,0,n,u.cC(),i,o,s),u.m8t(e,n,i,o,s),u.__t&&(i&&u.__t.mB(e,t,n,r),o)&&u.__t.o_t(e,t,n,r)):-1===e&&0<=t?(u.v8t(0,t,u.rC(),r,i,o,s),u.g8t(t,r,i,o,s),u.__t&&(i&&u.__t.mB(e,t,n,r),o)&&u.__t.o_t(e,t,n,r)):-1===e&&-1===t&&(a=u.rC(),f=u.cC(),u.v8t(0,0,a,f,i,o,s),u.m8t(0,a,i,o,s),u.g8t(0,f,i,o,s),u.__t)&&(i&&u.__t.mB(e,t,n,r),o)&&u.__t.o_t(e,t,n,r))},l.prototype.getAllNodes=function(){var e,t,n,r,i,o,a,u,s,e=[],t=this.dataTable,n=this.AE,r=this.IE,i=this.xE;for(a in i&&e.push(i),n)n.hasOwnProperty(a)&&(o=n[a])&&e.push(o);for(a in r)r.hasOwnProperty(a)&&(o=r[a])&&e.push(o);for(u in t)if(t.hasOwnProperty(u)&&(s=t[u]))for(a in s)s.hasOwnProperty(a)&&(o=s[a])&&e.push(o);return e},l.prototype.toJSON=function(e){v.supportRowColumnFormula?this.rT.toJSON(e,this.dataTable,this.I8,this.x8,this.IE):this.rT.toJSON(e,this.dataTable,this.I8,this.x8)},l.prototype.wh=function(e,t){v.supportRowColumnFormula?this.rT.wh(e,this.dataTable,this.I8,this.x8,this.IE,t):this.rT.wh(e,this.dataTable,this.I8,this.x8,void 0,t)},k=l,v.CalcSourceModel=k,t(d,fe=u),d.prototype.getKey=function(){var e=this;return e.Kyn||(e.Kyn=d.IDCount.toString(36),d.IDCount++),e.Kyn},d.prototype.yB=function(){var e=this;e.w3.l8t(e.row,e.column,1,1)},d.prototype.CMt=function(){var e=this;e.w3.mF(e.row,e.column,1,1)},d.prototype.r_t=function(){this.w3.op().onAddAdjust(this,0)},d.prototype.vyt=function(){this.w3.op().I3(this,0)},d.prototype.J_t=function(t){for(var e,n,r,i,e=this.w3.op(),n=this.aT,r=0;r<n.length;r++)(i=this[n[r]])&&i.forEach(function(e){e&&e.w3&&e.w3!==t&&(e.k1||e.vyt&&e.vyt())})},d.prototype.o_t=function(e){for(var t,n,r,i,o,a,u,s,t=this.w3.op(),n=this.aT,r=0;r<n.length;r++)(J(e)||r===e)&&(i=this[n[r]])&&i.forEach(function(e){e&&!e.k1&&e.vyt()});if((o=this.node&&this.node.$bt)&&o.isDynamicArray)for(a=0;a<o.rowCount;a++)for(u=0;u<o.colCount;u++)0===a&&0===u||(s=this.w3.getNode(a+o.row,u+o.col))&&s.calc&&s.calc.o_t()},d.prototype.s_t=function(){var e,t,n,r,i,r,t,o,r,n,t,e=this,t=e.w3,n=t.getCalcService();n&&n.Z_t&&(!(i=(r=e.Z_t)&&e.p8t)&&J(r)&&(r=t.getSource())&&(t=r.getName(),r=(o=n.MX.asyncManager).b8t[t])&&(n=r[e.row])&&(t=n[e.column])&&((i=t[0])?(e.Z_t=!0,(e.p8t=i).y8t=e):e.Z_t=!1),i)&&0===i.evaluateMode&&(i.yL=!1)},d.prototype.isDefault=function(e){if(J(e))return this.Hte;this.Hte=e},d.IDCount=0,H=d,v.CellCalc=H,t(m,ce=u),m.prototype.getKey=function(){var e,t,n,e=this,t=e.w3,n;return(null===t?"":t.rT.id+",")+e.row+",-1"},m.prototype.yB=function(){this.w3.h8t(this.row,1)},m.prototype.CMt=function(){this.w3.hwt(this.row,1)},m.prototype.r8t=function(e,t,n){(n?ye:ge)(this,D,{row:e,columnOffset:t,columnCount:1})},m.prototype.r_t=function(){this.w3.op().onAddAdjust(this,1)},m.prototype.vyt=function(){this.w3.op().I3(this,1)},G=m,v.RowCalc=G,t(g,he=u),g.prototype.getKey=function(){var e,t,n,e=this,t=e.w3,n;return(null===t?"":t.rT.id+",")+"-1,"+e.column},g.prototype.yB=function(){this.w3.d8t(this.column,1)},g.prototype.CMt=function(){this.w3.dwt(this.column,1)},g.prototype.o8t=function(e,t,n){this.Iwt(2,e,n)},g.prototype.r_t=function(){this.w3.op().onAddAdjust(this,2)},g.prototype.vyt=function(){this.w3.op().I3(this,2)},q=g,v.ColumnCalc=q,t(A,le=u),A.prototype.WFe=function(e,t){t?this.GFe.add(e):this.GFe.delete(e)},A.prototype.getKey=function(){var e,t,n,e=this,t=e.w3,n;return(null===t?"":t.rT.id+",")+e.name},A.prototype.updateListening=function(e,t){for(var i,i,o,a,u,s,n,r,o=this,a=o.aT,n=function(e){var e,t,n,r,e=o[a[e]];if(e)for(t=[],e.forEach(function(e){e&&t.push(e)}),n=t.length,r=0;r<n;r++)s=(u=t[r]).node,u.CMt(),s&&u.w3.SB(null!=(i=u.row)?i:-1,null!=(i=u.column)?i:-1,s.WK,s.$bt,!0)},r=0;r<a.length;r++)n(r)},A.prototype.updateListeningOnRemoved=function(){for(var n,e,r,i,o,a,u,s,t,f,n=this,e=n.aT,u=n.w3,s=u.op(),t=0;t<e.length;t++)(f=n[e[t]])&&f.forEach(function(e){var e,t;e&&(r=e.w3,i=e.row,o=e.col,i=i===W?-1:i,o=o===W?-1:o,a=r.pB(i,o),e=r.sT(i,o),a)&&(t=s.Hyt().adjustFormulaOnRemoveName(u,a,n.name))!==a&&r.SB(i,o,t,e,!0)})},A.prototype.vyt=function(){for(var e,t,n,e=this.aT,t=0;t<e.length;t++)(n=this[e[t]])&&n.forEach(function(e){e&&e.vyt()})},A.prototype.QFe=function(e,t){for(var n,r,i,e,n=this.aT,r=0;r<n.length;r++)if(0<(i=this[n[r]]).size)return!0;if(!e){if(!t)return 0<this.GFe.size;if(e=t.vwt(this.name))return e.QFe(!0)}return!1},ie=A,v.NameCalc=ie,t(E,de=u),E.prototype.processListener=function(e,t,n,r,i,o,a,u,s){var f,c,h,l,d,d,m,f,f=this,c=f[e],h=f[e+"c"],l=t+","+n+","+r+","+i;if(3!==e||o instanceof F)if(o.e_t)a||(delete o.e_t,f.processListener(e,t,n,r,i,o,a,u,s),o.e_t=!0),de.prototype.Iwt.call(this,e,o,a);else{if(o.ebt&&1<=o.ebt.length&&((m=(d=o.ebt)[d.length-1]).push(this),l="?"+l),u&&(l="!"+l),!c){if(!a)return;f.aT.push(e),f[e]=c=(0,b.createMap)(),f[e+"c"]=h=new p.Common.rbush(16)}if(!(d=c.get(l))){if(!a)return;c.set(l,d={}),d.content=(0,b.createMap)(),d.minY=t,d.minX=n,d.maxY=-1===t?-1:r+t-1,d.maxX=-1===n?-1:i+n-1,u&&s&&(d.content.delay=Ae(f.w3,t,n,r,i)),h.insert(d)}f=o.getKey(),a?d.content.has(f)||(d.content.set(f,o),u&&s&&d.content.delay&&0===e&&o.delay++):d.content.has(f)&&(d.content.delete(f),d.content.size<1)&&(delete d.content,c.delete(l),h.remove(d))}},E.prototype.cFe=function(f,c,h){for(var l,e,d,t,l=this.aT,e=function(e){var t,n,r,i,o,a,u,s,t;if(d[l[e]])for(n=d[l[e]+"c"],r=d[l[e]],i=d[l[e]]=(0,b.createMap)(),o=h?"minY":"minX",a=h?"maxY":"maxX",r.forEach(function(e,t){e[o]>=f&&(e[o]+=c),e[a]>=f&&(e[a]+=c),i.set(Ee(e,t),e)}),u=[n.data];0<u.length;)(s=u.pop())[o]>=f&&(s[o]+=c),s[a]>=f&&(s[a]+=c),s.leaf||(u=u.concat(s.children))},d=this,t=0;t<l.length;t++)e(t)},E.prototype.fFe=function(u,s,f){for(var c,e,h,t,c=this.aT,e=function(e){var t,r,n,i,o,a,t;h[c[e]]&&((r=h[c[e]+"c"]).clear(),n=h[c[e]],i=h[c[e]]=(0,b.createMap)(),o=f?"minY":"minX",a=f?"maxY":"maxX",n.forEach(function(e,t){var n;e[o]>=u+s?e[o]-=s:e[o]>=u&&(e[o]=u,n=1),e[a]>=u+s?e[a]-=s:e[a]>=u&&(e[a]=u-1,n=n&&2),2!==n&&(r.insert(e),i.set(Ee(e,t),e))}))},h=this,t=0;t<c.length;t++)e(t)},E.prototype.JDt=function(e,t,n,r,i,o,a,u){this.processListener(0,e,t,n,r,i,o,a,u)},E.prototype.i8t=function(e,t,n,r,i,o){this.processListener(3,e,t,n,r,i,o)},E.prototype.mB=function(e,t,n,r){this.visit(0,e,t,n,r)},E.prototype.visit=function(e,t,n,r,i,o){var a,u,s,f,c,h,l,d,m,a=this.aT,u=this.c_t();if(T.minX=n,T.minY=t,T.maxX=n+i-1,T.maxY=t+r-1,0===e){for(s=0;s<a.length;s++)if((J(o)||s===o)&&(f=this[a[s]]))for(h=(c=this[a[s]+"c"]).search(T),l=0;l<h.length;l++)(d=h[l].content).forEach(function(e){e.r_t()});this.i_t&&this.i_t.forEach(function(e){e&&e.r_t()})}else for(s=0;s<a.length;s++)if(f=this[a[s]])for(h=(c=this[a[s]+"c"]).search(T),l=0;l<h.length;l++)(m=h[l]).w8t&&m.w8t.WDt||(m.w8t=u.ZDt,(d=m.content).delay=0,d.forEach(function(e){e.vyt()}))},E.prototype.o_t=function(e,t,n,r,i){this.visit(1,e,t,n,r,i)},E.prototype.J_t=function(t){for(var e,n,r,e=this.aT,n=0;n<e.length;n++)(r=this[e[n]])&&r.forEach(function(e){e&&e.content.forEach(function(e){e&&e.w3&&e.w3!==t&&e.vyt&&e.vyt()})})},E.prototype.CTe=function(e,t){var n,t,r,i,o;if(T.minX=t,T.minY=e,T.maxX=t,T.maxY=e,n=!1,t=this["0c"])for(r=t.search(T),i=0;i<r.length;i++)if((o=r[i].content)&&o.forEach(function(e){e&&e.k1&&(n=!0)}),n)return!0;return n},E.prototype.a_t=function(e,t,n){var r,i,o,a,u,s,f,c,r=this.aT,i=n?1:-1;for(T.minX=t,T.minY=e,T.maxX=t,T.maxY=e,o=0;o<r.length;o++)if(a=this[r[o]])for(s=(u=this[r[o]+"c"]).search(T),f=0;f<s.length;f++)(c=s[f].content).delay=(c.delay||0)+i,n&&1===c.delay?c&&c.forEach(function(e){e.delay++,e.s_t&&e.s_t()}):n||0!==c.delay||c&&c.forEach(function(e){e.delay--})},E.prototype.yB=function(){},E.prototype.CMt=function(){},oe=E,v.RangeCalc=oe,v.Pyt=xe,v.h0t=Ie,v.eV=ee,v.Rwt=x},"./src/calcEngine.res.en.ts":function(e,t){var n,r,i,o,a,u,s,f,t;function c(e,t){return{description:e,parameters:t}}function h(e,t,n,r){return{name:e,repeatable:t,optional:n,enum:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.resource=void 0,t.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFormulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",Exp_DuplicatedChar:"Duplicated Character",Exp_ArgumentOutOfRangeException:"Argument Out Of Range Exception",Exp_ArgumentException:"Argument Exception",wmt:{ABS:c("This function calculates the absolute value of the specified value.",[h("number")]),ACCRINT:c("This function calculates the accrued interest for a security that pays periodic interest.",[h("issue"),h("first_interest"),h("settlement"),h("rate"),h("par"),h("frequency"),h("basis",!(t=[{value:"TRUE",description:"Approximate match"},{value:"FALSE",description:"Exact match"}]),!0)]),ACCRINTM:c("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[h("issue"),h("settlement"),h("rate"),h("par"),h("basis",!(f=[{value:"1",description:"Search first-to-last (default)"},{value:"-1",description:"Search last-to-first (reverse search)"},{value:"2",description:"Perform a binary search that relies on lookup_array being sorted in ascending order. If not sorted, invalid results will be returned. "},{value:"-2",description:"Perform a binary search that relies on lookup_array being sorted in descending order. If not sorted, invalid results will be returned."}]),!0)]),ACOS:c("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[h("number")]),ACOSH:c("This function calculates the inverse hyperbolic cosine of the specified value.",[h("number")]),ADDRESS:c("This function uses the row and column numbers to create a cell address in text.",[h("row_num"),h("column_num"),h("abs_num",!(s=[{value:"0",description:"Exact match (default)"},{value:"-1",description:"Exact match or next smallest item"},{value:"1",description:"Exact match or next largest item"},{value:"2",description:"A wildcard match where *, ?, and ~ have special meaning."}]),!0),h("a1style",!(u=[{value:"0",description:"Case sensitive"},{value:"1",description:"Case insensitive"}]),!0),h("sheet_text",!(a="pad_with"),!0)]),AGGREGATE:c("This function aggregate a list of numbers using a specified built-in function.",[h("function_num"),h("options"),h("ref1"),h("ref2",!0)]),AMORDEGRC:c("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[h("cost"),h("date_purchased"),h("first_period"),h("salvage"),h("period"),h("rate"),h("basis")]),AMORLINC:c("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[h("cost"),h("date_purchased"),h("first_period"),h("salvage"),h("period"),h("rate"),h("basis")]),AND:c("Check whether all arguments are True, and returns True if all arguments are True.",[h("logical1"),h("logical2")]),ASIN:c("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[h("number")]),ASINH:c("This function calculates the inverse hyperbolic sine of a number.",[h("number")]),ATAN:c("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[h("number")]),ATAN2:c("This function calculates the arctangent of the specified x- and y-coordinates.",[h("x_num"),h("y_num")]),ATANH:c("This function calculates the inverse hyperbolic tangent of a number.",[h("number")]),AVEDEV:c("This function calculates the average of the absolute deviations of the specified values from their mean.",[h("number1"),h("number2",!0)]),AVERAGE:c("This function calculates the average of the specified numeric values.",[h("number1"),h("number2",!0)]),AVERAGEA:c("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[h("value1"),h("value2",!0)]),AVERAGEIF:c("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[h("range"),h("criteria"),h("average_range",!(o="if_not_found"),!0)]),AVERAGEIFS:c("This function calculates the average of all cells that meet multiple specified criteria.",[h("average_range"),h("criteria_range1"),h("criteria1"),h("criteria_range2",!0),h("criteria2",!0)]),BESSELI:c("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[h("value"),h("order")]),BESSELJ:c("This function calculates the Bessel function of the first kind.",[h("value"),h("order")]),BESSELK:c("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[h("value"),h("order")]),BESSELY:c("This function calculates the Bessel function of the second kind.",[h("value"),h("order")]),BETADIST:c("This function calculates the cumulative beta distribution function.",[h("x"),h("alpha"),h("beta"),h("lower",!(i="match_mode"),!0),h("upper",!(r="significance"),!0)]),BETAINV:c("This function calculates the inverse of the cumulative beta distribution function.",[h("probability"),h("alpha"),h("beta"),h("lower",!(n="start_num"),!0),h("upper",!1,!0)]),BIN2DEC:c("This function converts a binary number to a decimal number",[h("number")]),BIN2HEX:c("This function converts a binary number to a hexadecimal number.",[h("number"),h("places")]),BIN2OCT:c("This function converts a binary number to an octal number.",[h("number"),h("places")]),BINOMDIST:c("This function calculates the individual term binomial distribution probability.",[h("number_s"),h("trials"),h("probability_s"),h("cumulative")]),CEILING:c("This function rounds a number up to the nearest multiple of a specified value.",[h("number"),h("significance")]),CHAR:c("This function returns the character specified by a number.",[h("number")]),CHIDIST:c("This function calculates the one-tailed probability of the chi-squared distribution.",[h("value"),h("deg_freedom")]),CHIINV:c("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[h("probability"),h("deg_freedom")]),CHITEST:c("This function calculates the test for independence from the chi-squared distribution.",[h("actual_range"),h("expected_range")]),CHOOSE:c("This function returns a value from a list of values.",[h("index_num"),h("value1"),h("value2",!0)]),CLEAN:c("This function removes all non-printable characters from text.",[h("text")]),CODE:c("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[h("text")]),COLUMN:c("This function returns the column number of a reference.",[h("reference")]),COLUMNS:c("This function returns the number of columns in an array.",[h("array")]),COMBIN:c("This function calculates the number of possible combinations for a specified number of items.",[h("number"),h("number_chosen")]),COMPLEX:c("This function converts real and imaginary coefficients into a complex number.",[h("real_num"),h("image_num"),h("suffix")]),CONCATENATE:c("This function combines multiple text strings or numbers into one text string.",[h("text1"),h("text2",!0)]),CONFIDENCE:c("This function returns confidence interval for a population mean.",[h("alpha"),h("standard_dev"),h("size")]),CONVERT:c("This function converts a number from one measurement system to its equivalent in another measurement system.",[h("number"),h("from_unit"),h("to_unit")]),CORREL:c("This function returns the correlation coefficient of the two sets of data.",[h("array1"),h("array2")]),COS:c("This function returns the cosine of the specified angle.",[h("number")]),COSH:c("This function returns the hyperbolic cosine of the specified value.",[h("number")]),COUNT:c("This function returns the number of cells that contain numbers.",[h("value1"),h("value2",!0)]),COUNTA:c("This function returns the number of cells that contain numbers, text, or logical values.",[h("value1"),h("value2",!0)]),COUNTBLANK:c("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[h("cellrange")]),COUNTIF:c("This function returns the number of cells that meet a certain condition",[h("cellrange"),h("criteria")]),COUNTIFS:c("This function returns the number of cells that meet multiple conditions.",[h("criteria_range1"),h("criteria1"),h("criteria_range2",!0),h("criteria2",!0)]),COUPDAYBS:c("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[h("settlement"),h("maturity"),h("frequency"),h("basis")]),COUPDAYS:c("This function returns the number of days in the coupon period that contains the settlement date.",[h("settlement"),h("maturity"),h("frequency"),h("basis")]),COUPDAYSNC:c("This function calculates the number of days from the settlement date to the next coupon date.",[h("settlement"),h("maturity"),h("frequency"),h("basis")]),COUPNCD:c("This function returns a date number of the next coupon date after the settlement date.",[h("settlement"),h("maturity"),h("frequency"),h("basis")]),COUPNUM:c("This function returns the number of coupons due between the settlement date and maturity date.",[h("settlement"),h("maturity"),h("frequency"),h("basis")]),COUPPCD:c("This function returns a date number of the previous coupon date before the settlement date.",[h("settlement"),h("maturity"),h("frequency"),h("basis")]),COVAR:c("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[h("array1"),h("array2")]),CRITBINOM:c("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[h("trials"),h("probability_s"),h("alpha")]),CUMIPMT:c("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[h("rate"),h("nper"),h("pval"),h("start_period"),h("end_period"),h("paytype")]),CUMPRINC:c("This function returns the cumulative principal paid on a loan between the start and end periods.",[h("rate"),h("nper"),h("pval"),h("start_period"),h("end_period"),h("paytype")]),DATE:c("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[h("year"),h("month"),h("day")]),DATEDIF:c("This function returns the number of days, months, or years between two dates.",[h("start_date"),h("end_date"),h("unit")]),DATEVALUE:c("This function returns a DateTime object of the specified date.",[h("date_text")]),DAVERAGE:c("This function calculates the average of values in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),DAY:c("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[h("date")]),DAYS360:c("This function returns the number of days between two dates based on a 360-day year.",[h("start_date"),h("end_date"),h("method",!1,!0)]),DB:c("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[h("cost"),h("salvage"),h("life"),h("period"),h("month")]),DCOUNT:c("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[h("database"),h("field"),h("criteria")]),DCOUNTA:c("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[h("database"),h("field"),h("criteria")]),DDB:c("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[h("cost"),h("salvage"),h("life"),h("period"),h("factor")]),DEC2BIN:c("This function converts a decimal number to a binary number.",[h("number"),h("places")]),DEC2HEX:c("This function converts a decimal number to a hexadecimal number",[h("number"),h("places")]),DEC2OCT:c("This function converts a decimal number to an octal number",[h("number"),h("places")]),DEGREES:c("This function converts the specified value from radians to degrees",[h("angle")]),DELTA:c("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[h("number1"),h("number2")]),DEVSQ:c("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[h("number1"),h("number2",!0)]),DGET:c("This function extracts a single value from a column of a list or database that matches the specified conditions.",[h("database"),h("field"),h("criteria")]),DISC:c("This function calculates the discount rate for a security.",[h("settlement"),h("maturity"),h("price"),h("redemption"),h("basis")]),DMAX:c("This function returns the largest number in a column of a list or database that matches the specified conditions.",[h("database"),h("field"),h("criteria")]),DMIN:c("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[h("database"),h("field"),h("criteria")]),DOLLAR:c("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[h("number"),h("decimals",!1,!0)]),DOLLARDE:c("This function converts a fraction dollar price to a decimal dollar price.",[h("fractional_dollar"),h("fraction")]),DOLLARFR:c("This function converts a decimal number dollar price to a fraction dollar price.",[h("decimal_dollar"),h("fraction")]),DPRODUCT:c("This function multiplies the values in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),DSTDEV:c("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),DSTDEVP:c("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),DSUM:c("This function adds the numbers in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),DURATION:c("This function returns the Macaulay duration for an assumed par value of $100.",[h("settlement"),h("maturity"),h("coupon"),h("yield"),h("frequency"),h("basis")]),DVAR:c("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),DVARP:c("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[h("database"),h("field"),h("criteria")]),EDATE:c("This function calculates the date that is the indicated number of months before or after a specified date.",[h("start_date"),h("months")]),EFFECT:c("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[h("nominal_rate"),h("npery")]),EOMONTH:c("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[h("start_date"),h("months")]),ERF:c("This function calculates the error function integrated between a lower and an upper limit.",[h("lower_limit"),h("upper_limit")]),ERFC:c("This function calculates the complementary error function integrated between a lower limit and infinity.",[h("lowerlimit")]),"ERROR.TYPE":c("This function returns a number corresponding to one of the error values.",[h("error_val")]),EURO:c("This function returns the equivalent of one Euro based on the ISO currency code.",[h("code")]),EUROCONVERT:c("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[h("number"),h("source"),h("target"),h("full_precision"),h("triangulation_precision")]),EVEN:c("This function rounds the specified value up to the nearest even integer.",[h("number")]),EXACT:c("This function returns true if two strings are the same; otherwise, false.",[h("text1"),h("text2")]),EXP:c("This function returns e raised to the power of the specified value.",[h("number")]),EXPONDIST:c("This function returns the exponential distribution or the probability density.",[h("value"),h("lambda"),h("cumulative")]),FACT:c("This function calculates the factorial of the specified number.",[h("number")]),FACTDOUBLE:c("This function calculates the double factorial of the specified number.",[h("number")]),FALSE:c("This function returns the value for logical FALSE.",[]),FDIST:c("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[h("value"),h("deg_freedom1"),h("deg_freedom2")]),FIND:c("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[h("find_text"),h("within_text"),h(n,!1,!0)]),FINV:c("This function returns the inverse of the F probability distribution.",[h("probability"),h("deg_freedom1"),h("deg_freedom2")]),FISHER:c("This function returns the Fisher transformation for a specified value.",[h("value")]),FISHERINV:c("This function returns the inverse of the Fisher transformation for a specified value.",[h("value")]),FIXED:c("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[h("number"),h("decimals",!1,!0),h("no_commas",!1,!0)]),FLOOR:c("This function rounds a number down to the nearest multiple of a specified value.",[h("number"),h("significance")]),FORECAST:c("This function calculates a future value using existing values.",[h("value"),h("Yarray"),h("Xarray")]),FREQUENCY:c("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[h("data_array"),h("bins_array")]),FTEST:c("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[h("array1"),h("array2")]),FV:c("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[h("rate"),h("numper"),h("paymt"),h("pval"),h("type")]),FVSCHEDULE:c("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[h("principal"),h("schedule")]),GAMMADIST:c("This function returns the gamma distribution.",[h("x"),h("alpha"),h("beta"),h("cumulative")]),GAMMAINV:c("This function returns the inverse of the gamma cumulative distribution.",[h("probability"),h("alpha"),h("beta")]),GAMMALN:c("This function returns the natural logarithm of the Gamma function, G(x).",[h("value")]),GCD:c("This function returns the greatest common divisor of two numbers.",[h("number1"),h("number2")]),GEOMEAN:c("This function returns the geometric mean of a set of positive data.",[h("number1"),h("number2",!0)]),GESTEP:c("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[h("number"),h("step")]),GROWTH:c("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[h("y"),h("x"),h("newx"),h("constant")]),HARMEAN:c("This function returns the harmonic mean of a data set.",[h("number1"),h("number2",!0)]),HEX2BIN:c("This function converts a hexadecimal number to a binary number.",[h("number"),h("places")]),HEX2DEC:c("This function converts a hexadecimal number to a decimal number.",[h("number")]),HEX2OCT:c("This function converts a hexadecimal number to an octal number.",[h("number"),h("places")]),HLOOKUP:c("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[h("lookup_value"),h("table_array"),h("row_index_num"),h("range_lookup",!1,!0,t)]),HOUR:c("This function returns the hour that corresponds to a specified time.",[h("time")]),HYPGEOMDIST:c("This function returns the hypergeometric distribution.",[h("sample_s"),h("number_sample"),h("population_s"),h("number_pop")]),IF:c("This function performs a comparison and returns one of two provided values based on that comparison.",[h("logical_test"),h("value_if_true"),h("value_if_false")]),IFERROR:c("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[h("value"),h("value_if_error")]),IMABS:c("This function returns the absolute value or modulus of a complex number.",[h("complexnum")]),IMAGINARY:c("This function returns the imaginary coefficient of a complex number.",[h("complexnum")]),IMARGUMENT:c("This function returns the argument theta, which is an angle expressed in radians.",[h("complexnum")]),IMCONJUGATE:c("This function returns the complex conjugate of a complex number.",[h("complexnum")]),IMCOS:c("This function returns the cosine of a complex number.",[h("complexnum")]),IMDIV:c("This function returns the quotient of two complex numbers.",[h("complexnum"),h("complexdenom")]),IMEXP:c("This function returns the exponential of a complex number.",[h("complexnum")]),IMLN:c("This function returns the natural logarithm of a complex number.",[h("complexnum")]),IMLOG2:c("This function returns the base-2 logarithm of a complex number.",[h("complexnum")]),IMLOG10:c("This function returns the common logarithm of a complex number.",[h("complexnum")]),IMPOWER:c("This function returns a complex number raised to a power.",[h("complexnum"),h("powernum")]),IMPRODUCT:c("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[h("complexnum1"),h("complexnum2",!0)]),IMREAL:c("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[h("complexnum")]),IMSIN:c("This function returns the sine of a complex number in the x+yi or x+yj text format.",[h("complexnum")]),IMSQRT:c("This function returns the square root of a complex number in the x+yi or x+yj text format.",[h("complexnum")]),IMSUB:c("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[h("complexnum1"),h("complexnum2")]),IMSUM:c("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[h("complexnum1"),h("complexnum2",!0)]),INDEX:c("This function returns a value or the reference to a value from within an array or range.",[h("array"),h("row_num"),h("column_num"),h("area_num")]),INDIRECT:c("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[h("ref_text"),h("a1_style",!1,!0)]),INT:c("This function rounds a specified number down to the nearest integer.",[h("number")]),INTERCEPT:c("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[h("dependent"),h("independent")]),INTRATE:c("This function calculates the interest rate for a fully invested security.",[h("settlement"),h("maturity"),h("investment"),h("redemption"),h("basis")]),IPMT:c("This function calculates the payment of interest on a loan.",[h("rate"),h("per"),h("nper"),h("pval"),h("fval"),h("type")]),IRR:c("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[h("arrayvals"),h("estimate")]),ISBLANK:c("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[h("cellreference")]),ISERR:c("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[h("cellreference")]),ISERROR:c("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[h("cellreference")]),ISEVEN:c("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[h("cellreference")]),ISLOGICAL:c("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[h("cellreference")]),ISNA:c("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[h("cellreference")]),ISNONTEXT:c("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[h("cellreference")]),ISNUMBER:c("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[h("cellreference")]),ISODD:c("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[h("cellreference")]),ISPMT:c("This function calculates the interest paid during a specific period of an investment.",[h("rate"),h("per"),h("nper"),h("pv")]),ISREF:c("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[h("cellreference")]),ISTEXT:c("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[h("cellreference")]),KURT:c("This function returns the kurtosis of a data set.",[h("number1"),h("number2"),h("number3"),h("number4",!0)]),LARGE:c("This function returns the nth largest value in a data set, where n is specified.",[h("array"),h("n")]),LCM:c("This function returns the least common multiple of two numbers.",[h("number1"),h("number2")]),LEFT:c("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[h("text"),h("num_chars")]),LEN:c("This function returns the length of the number of characters in a text string.",[h("text")]),LINEST:c("This function calculates the statistics for a line.",[h("y"),h("x"),h("constant"),h("stats")]),LN:c("This function returns the natural logarithm of the specified number.",[h("value")]),LOG:c("This function returns the logarithm base Y of a number X.",[h("number"),h("base")]),LOG10:c("This function returns the logarithm base 10 of the number given.",[h("number")]),LOGEST:c("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[h("y"),h("x"),h("constant"),h("stats")]),LOGINV:c("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[h("probability"),h("mean"),h("standard_dev")]),LOGNORMDIST:c("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[h("x"),h("mean"),h("standard_dev")]),LOOKUP:c("This function searches for a value and returns a value from the same location in a second area.",[h("lookup_value"),h("lookup_vector"),h("result_vector")]),LOWER:c("This function converts text to lower case letters.",[h("text")]),MATCH:c("This function returns the relative position of a specified item in a range.",[h("lookup_value"),h("lookup_array"),h("match_type")]),XMATCH:c("This function returns the relative position of an item in an array. By default, an exact match is required.",[h("lookup_value"),h("lookup_array"),h(i,!1,!0,s),h("search_mode",!1,!0,f)]),XLOOKUP:c("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[h("lookup_value"),h("lookup_array"),h("return_array"),h(o,!1,!0),h(i,!1,!0,s),h("search_mode",!1,!0,f)]),MAX:c("This function returns the maximum value, the greatest value, of all the values in the arguments.",[h("number1"),h("number2",!0)]),MAXA:c("This function returns the largest value in a list of arguments, including text and logical values.",[h("value1"),h("value2",!0)]),MDETERM:c("This function returns the matrix determinant of an array.",[h("array")]),MDURATION:c("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[h("settlement"),h("maturity"),h("coupon"),h("yield"),h("frequency"),h("basis")]),MEDIAN:c("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[h("number1"),h("number2",!0)]),MID:c("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[h("text"),h("start_num"),h("num_chars")]),MIN:c("This function returns the minimum value, the least value, of all the values in the arguments.",[h("number1"),h("number2",!0)]),MINA:c("This function returns the minimum value in a list of arguments, including text and logical values.",[h("value1"),h("value2",!0)]),MINUTE:c("This function returns the minute corresponding to a specified time.",[h("time")]),MINVERSE:c("This function returns the inverse matrix for the matrix stored in an array.",[h("array")]),MIRR:c("This function returns the modified internal rate of return for a series of periodic cash flows.",[h("values"),h("finance_rate"),h("reinvest_rate")]),MMULT:c("This function returns the matrix product for two arrays.",[h("array1"),h("array2")]),MOD:c("This function returns the remainder of a division operation.",[h("dividend"),h("divisor")]),MODE:c("This function returns the most frequently occurring value in a set of data.",[h("number1"),h("number2",!0)]),MONTH:c("This function returns the month corresponding to the specified date value.",[h("date")]),MROUND:c("This function returns a number rounded to the desired multiple.",[h("number"),h("multiple")]),MULTINOMIAL:c("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[h("number1"),h("number2",!0)]),MUNIT:c("The function returns the unit matrix for the specified dimension.",[h("dimension")]),N:c("This function returns a value converted to a number.",[h("value")]),NA:c("This function returns the error value #N/A that means not available.",[]),SHEET:c("Returns the sheet number of reference sheet.",[h("value",!1,!0)]),SHEETS:c("Returns the number of sheets in a reference.",[h("reference",!1,!0)]),NEGBINOMDIST:c("This function returns the negative binomial distribution.",[h("number_f"),h("number_s"),h("probability_s")]),NETWORKDAYS:c("This function returns the total number of complete working days between the start and end dates.",[h("start_date"),h("end_date"),h("holidays",!1,!0)]),NOMINAL:c("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[h("effect_rate"),h("npery")]),NORMDIST:c("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[h("x"),h("mean"),h("standard_dev"),h("cumulative")]),NORMINV:c("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[h("probability"),h("mean"),h("standard_dev")]),NORMSDIST:c("This function returns the standard normal cumulative distribution function.",[h("value")]),NORMSINV:c("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[h("probability")]),NOT:c("This function reverses the logical value of its argument.",[h("logical")]),NOW:c("This function returns the current date and time.",[]),NPER:c("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[h("rate"),h("paymt"),h("pval"),h("fval"),h("type")]),NPV:c("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[h("rate"),h("value1"),h("value2",!0)]),OBJECT:c("This function converts the property/expression sequence to an object.",[h("property1",!0),h("expression1",!0)]),OCT2BIN:c("This function converts an octal number to a binary number.",[h("number"),h("places")]),OCT2DEC:c("This function converts an octal number to a decimal number.",[h("number")]),OCT2HEX:c("This function converts an octal number to a hexadecimal number.",[h("number"),h("places")]),ODD:c("This function rounds the specified value up to the nearest odd integer.",[h("number")]),ODDFPRICE:c("This function calculates the price per $100 face value of a security with an odd first period.",[h("settlement"),h("maturity"),h("issue"),h("first_coupon"),h("rate"),h("yield"),h("redemption"),h("frequency"),h("basis")]),ODDFYIELD:c("This function calculates the yield of a security with an odd first period.",[h("settlement"),h("maturity"),h("issue"),h("first_coupon"),h("rate"),h("price"),h("redemption"),h("frequency"),h("basis")]),ODDLPRICE:c("This function calculates the price per $100 face value of a security with an odd last coupon period.",[h("settlement"),h("maturity"),h("last_interest"),h("rate"),h("yield"),h("redemption"),h("frequency"),h("basis")]),ODDLYIELD:c("This function calculates the yield of a security with an odd last period.",[h("settlement"),h("maturity"),h("last_interest"),h("rate"),h("price"),h("redemption"),h("frequency"),h("basis")]),OFFSET:c("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[h("reference"),h("rows"),h("cols"),h("height",!1,!0),h("width",!1,!0)]),OR:c("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[h("logical1"),h("logical2",!0)]),PEARSON:c("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[h("array_ind"),h("array_dep")]),PERCENTILE:c("This function returns the nth percentile of values in a range.",[h("array"),h("n")]),PERCENTRANK:c("This function returns the rank of a value in a data set as a percentage of the data set.",[h("array"),h("x"),h("significance")]),PERMUT:c("This function returns the number of possible permutations for a specified number of items.",[h("number"),h("number_chosen")]),PI:c("This function returns PI as 3.1415926536.",[]),PMT:c("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[h("rate"),h("nper"),h("pval"),h("fval"),h("type")]),POISSON:c("This function returns the Poisson distribution.",[h("nevents"),h("mean"),h("cumulative")]),POWER:c("This function raises the specified number to the specified power.",[h("number"),h("power")]),PPMT:c("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[h("rate"),h("per"),h("nper"),h("pval"),h("fval"),h("type")]),PRICE:c("This function calculates the price per $100 face value of a periodic interest security",[h("settlement"),h("maturity"),h("rate"),h("yield"),h("redemption"),h("frequency"),h("basis")]),PRICEDISC:c("This function returns the price per $100 face value of a discounted security.",[h("settlement"),h("maturity"),h("discount"),h("redemption"),h("basis")]),PRICEMAT:c("This function returns the price at maturity per $100 face value of a security that pays interest.",[h("settlement"),h("maturity"),h("issue"),h("rate"),h("yield"),h("basis")]),PROB:c("This function returns the probability that values in a range are between two limits.",[h("x_range"),h("prob_range"),h("lower_limit"),h("upper_limit")]),PRODUCT:c("This function multiplies all the arguments and returns the product.",[h("number1"),h("number2",!0)]),PROPER:c("This function capitalizes the first letter in each word of a text string.",[h("text")]),PROPERTY:c("This function returns the value of property path in object.",[h("data_expression"),h("property_path")]),PV:c("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[h("rate"),h("numper"),h("paymt"),h("fval"),h("type")]),QUARTILE:c("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[h("array"),h("quart")]),QUOTIENT:c("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[h("numerator"),h("denominator")]),RADIANS:c("This function converts the specified number from degrees to radians.",[h("angle")]),RAND:c("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:c("This function returns a random number between the numbers you specify.",[h("bottom"),h("top")]),RANGEBLOCKSPARKLINE:c("This function returns a rangetemplate.",[h("template_range"),h("data_expression")]),RANK:c("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[h("number"),h("ref"),h("order",!1,!0)]),RATE:c("This function returns the interest rate per period of an annuity.",[h("nper"),h("pmt"),h("pval"),h("fval"),h("type"),h("guess")]),RECEIVED:c("This function returns the amount received at maturity for a fully invested security.",[h("settlement"),h("maturity"),h("investment"),h("discount"),h("basis")]),REPLACE:c("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[h("old_text"),h("start_num"),h("num_chars"),h("new_text")]),REPT:c("This function repeats text a specified number of times.",[h("text"),h("number_times")]),RIGHT:c("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[h("text"),h("num_chars")]),ROMAN:c("This function converts an Arabic numeral to a Roman numeral text equivalent.",[h("number"),h("form")]),ROUND:c("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[h("number"),h("num_digits")]),ROUNDDOWN:c("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[h("number"),h("num_digits")]),ROUNDUP:c("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[h("number"),h("num_digits")]),ROW:c("This function returns the number of a row from a reference.",[h("reference")]),ROWS:c("This function returns the number of rows in an array.",[h("array")]),RSQ:c("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[h("array_dep"),h("array_ind")]),SEARCH:c("This function finds one text string in another text string and returns the index of the starting position of the found text.",[h("find_text"),h("within_text"),h(n,!1,!0)]),SECOND:c("This function returns the seconds (0 to 59) value for a specified time.",[h("time")]),SERIESSUM:c("This function returns the sum of a power series.",[h("x"),h("n"),h("m"),h("coefficients")]),SIGN:c("This function returns the sign of a number or expression.",[h("cellreference")]),SIN:c("This function returns the sine of the specified angle.",[h("angle")]),SINH:c("This function returns the hyperbolic sine of the specified number.",[h("number")]),SKEW:c("This function returns the skewness of a distribution.",[h("number1"),h("number2",!0)]),SLN:c("This function returns the straight-line depreciation of an asset for one period.",[h("cost"),h("salvage"),h("life")]),SLOPE:c("This function calculates the slope of a linear regression.",[h("array_dep"),h("array_ind")]),SMALL:c("This function returns the nth smallest value in a data set, where n is specified.",[h("array"),h("n")]),SQRT:c("This function returns the positive square root of the specified number.",[h("value")]),SQRTPI:c("This function returns the positive square root of a multiple of pi (p).",[h("multiple")]),STANDARDIZE:c("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[h("x"),h("mean"),h("standard_dev")]),STDEVA:c("This function returns the standard deviation for a set of numbers, text, or logical values.",[h("value1"),h("value2",!0)]),STDEVP:c("This function returns the standard deviation for an entire specified population (of numeric values).",[h("number1"),h("number2",!0)]),STDEVPA:c("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[h("value1"),h("value2",!0)]),STEYX:c("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[h("array_dep"),h("array_ind")]),SUBSTITUTE:c("This function substitutes a new string for specified characters in an existing string.",[h("text"),h("old_text"),h("new_text"),h("instance_num",!1,!0)]),SUBTOTAL:c("This function calculates a subtotal of a list of numbers using a specified built-in function.",[h("function_num"),h("ref1"),h("ref2",!0)]),SUM:c("This function returns the sum of cells or range of cells.",[h("number1"),h("number2",!0)]),SUMIF:c("This function adds the cells using a given criteria.",[h("range"),h("criteria"),h("sum_range")]),SUMIFS:c("This function adds the cells in a range using multiple criteria.",[h("sum_range"),h("criteria_range1"),h("criteria1"),h("criteria_range2",!0),h("criteria2",!0)]),SUMPRODUCT:c("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[h("array1"),h("array2",!0)]),SUMSQ:c("This function returns the sum of the squares of the arguments.",[h("number1"),h("number2",!0)]),SUMX2MY2:c("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[h("array_x"),h("array_y")]),SUMX2PY2:c("This function returns the sum of the sum of squares of corresponding values in two arrays.",[h("array_x"),h("array_y")]),SUMXMY2:c("This function returns the sum of the square of the differences of corresponding values in two arrays.",[h("array_x"),h("array_y")]),SYD:c("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[h("cost"),h("salvage"),h("life"),h("period")]),T:c("This function returns the text in a specified cell.",[h("value")]),TAN:c("This function returns the tangent of the specified angle.",[h("angle")]),TANH:c("This function returns the hyperbolic tangent of the specified number.",[h("number")]),TBILLEQ:c("This function returns the equivalent yield for a Treasury bill (or T-bill)",[h("settlement"),h("maturity"),h("discount")]),TBILLPRICE:c("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[h("settlement"),h("maturity"),h("discount")]),TBILLYIELD:c("This function returns the yield for a Treasury bill (or T-bill).",[h("settlement"),h("maturity"),h("priceper")]),TDIST:c("This function returns the probability for the t-distribution.",[h("x"),h("deg_freedom"),h("tails")]),TEXT:c("This function formats a number and converts it to text.",[h("value"),h("format_text")]),TIME:c("This function returns the TimeSpan object for a specified time.",[h("hour"),h("minute"),h("second")]),TIMEVALUE:c("This function returns the TimeSpan object of the time represented by a text string.",[h("time_text")]),TINV:c("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[h("probability"),h("deg_freedom")]),TODAY:c("This function returns the date and time of the current date.",[]),TRANSPOSE:c("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[h("array")]),TREND:c("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[h("y"),h("x"),h("newx"),h("constant")]),TRIM:c("This function removes extra spaces from a string and leaves single spaces between words.",[h("text")]),TRIMMEAN:c("This function returns the mean of a subset of data excluding the top and bottom data.",[h("array"),h("percent")]),TRUE:c("This function returns the value for logical TRUE.",[]),TRUNC:c("This function removes the specified fractional part of the specified number.",[h("number"),h("num_digits")]),TTEST:c("This function returns the probability associated with a t-test.",[h("array1"),h("array2"),h("tails"),h("type")]),TYPE:c("This function returns the type of value.",[h("value")]),UPPER:c("This function converts text to uppercase letters.",[h("text")]),VALUE:c("This function converts a text string that is a number to a numeric value.",[h("text")]),VAR:c("This function returns the variance based on a sample of a population, which uses only numeric values.",[h("number1"),h("number2",!0)]),VARA:c("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[h("value1"),h("value2",!0)]),VARP:c("This function returns variance based on the entire population, which uses only numeric values.",[h("number1"),h("number2",!0)]),VARPA:c("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[h("value1"),h("value2",!0)]),VDB:c("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[h("cost"),h("salvage"),h("life"),h("start_period"),h("end_period"),h("factor"),h("no_switch")]),VLOOKUP:c("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[h("lookup_value"),h("table_array"),h("col_index_num"),h("range_lookup",!1,!0,t)]),WEEKDAY:c("This function returns the number corresponding to the day of the week for a specified date.",[h("date"),h("type")]),WEEKNUM:c("This function returns a number that indicates the week of the year numerically.",[h("date"),h("weektype")]),DATEPART:c("This function formats a date and converts it to text.",[h("date"),h("format_text"),h("weektype",!1,!0)]),WEIBULL:c("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[h("x"),h("alpha"),h("beta"),h("cumulative")]),WORKDAY:c("This function returns the number of working days before or after the starting date.",[h("start_date"),h("days"),h("holidays",!1,!0)]),XIRR:c("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[h("values"),h("dates"),h("guess")]),XNPV:c("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[h("rate"),h("values"),h("dates")]),YEAR:c("This function returns the year as an integer for a specified date.",[h("date")]),YEARFRAC:c("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[h("start_date"),h("end_date"),h("basis")]),YIELD:c("This function calculates the yield on a security that pays periodic interest.",[h("settlement"),h("maturity"),h("rate"),h("price"),h("redemption"),h("frequency"),h("basis")]),YIELDDISC:c("This function calculates the annual yield for a discounted security.",[h("settlement"),h("maturity"),h("price"),h("redemption"),h("basis")]),YIELDMAT:c("This function calculates the annual yield of a security that pays interest at maturity.",[h("settlement"),h("maturity"),h("issue"),h("rate"),h("price"),h("basis")]),ZTEST:c("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[h("array"),h("x"),h("sigma",!1,!0)]),HBARSPARKLINE:c("This function returns a data set used for representing a Hbar sparkline",[h("value"),h("colorScheme"),h("axisVisible"),h("barHeight")]),VBARSPARKLINE:c("This function returns a data set used for representing a Vbar sparkline",[h("value"),h("colorScheme"),h("axisVisible"),h("barWidth")]),VARISPARKLINE:c("This function returns a data set used for representing a variance sparkline",[h("variance"),h("reference"),h("mini"),h("maxi"),h("mark"),h("tickunit"),h("legend"),h("colorPositive"),h("colorNegative"),h("vertical")]),LOLLIPOPVARISPARKLINE:c("This function returns a data set used for representing an absolute or relative lollipop variance sparkline",[h("plannedValue"),h("actualValue"),h("index"),h("absolute"),h("reference"),h("mini"),h("maxi"),h("tickunit"),h("legend"),h("colorPositive"),h("colorNegative"),h("lollipopHeaderColor"),h("vertical")]),PIESPARKLINE:c("This function returns a data set used for representing a pie sparkline",[h("range|percentage"),h("color",!0)]),AREASPARKLINE:c("This function returns a data set used for representing a area sparkline",[h("points"),h("mini"),h("maxi"),h("line1"),h("line2"),h("colorPositive"),h("colorNegative")]),SCATTERSPARKLINE:c("This function returns a data set used for representing a scatter sparkline",[h("points1"),h("points2"),h("minX"),h("maxX"),h("minY"),h("maxY"),h("hLine"),h("vLine"),h("xMinZone"),h("xMaxZone"),h("yMinZone"),h("yMaxZone"),h("tags"),h("drawSymbol"),h("drawLines"),h("color1"),h("color2"),h("dash")]),LINESPARKLINE:c("This function returns a data set used for representing a line sparkline",[h("data"),h("dataOrientation"),h("dateAxisData"),h("dateAxisOrientation"),h("setting")]),COLUMNSPARKLINE:c("This function returns a data set used for representing a column sparkline",[h("data"),h("dataOrientation"),h("dateAxisData"),h("dateAxisOrientation"),h("setting")]),WINLOSSSPARKLINE:c("This function returns a data set used for representing a win/loss sparkline",[h("data"),h("dataOrientation"),h("dateAxisData"),h("dateAxisOrientation"),h("setting")]),BULLETSPARKLINE:c("This function returns a data set used for representing a bullet sparkline",[h("measure"),h("target"),h("maxi"),h("good"),h("bad"),h("forecast"),h("tickunit"),h("colorScheme"),h("vertical"),h("measureColor"),h("targetColor"),h("maxiColor"),h("goodColor"),h("badColor"),h("forecastColor"),h("allowMeasureOverMaxi"),h("barSize")]),SPREADSPARKLINE:c("This function returns a data set used for representing a spread sparkline",[h("points"),h("showAverage"),h("scaleStart"),h("scaleEnd"),h("style"),h("colorScheme"),h("vertical")]),STACKEDSPARKLINE:c("This function returns a data set used for representing a stacked sparkline",[h("points"),h("colorRange"),h("labelRange"),h("maximum"),h("targetRed"),h("targetGreen"),h("targetBlue"),h("tragetYellow"),h("color"),h("highlightPosition"),h("vertical"),h("textOrientation"),h("textSize")]),BOXPLOTSPARKLINE:c("This function returns a data set used for representing a boxplot sparkline",[h("points"),h("boxPlotClass"),h("showAverage"),h("scaleStart"),h("scaleEnd"),h("acceptableStart"),h("acceptableEnd"),h("colorScheme"),h("style"),h("vertical")]),CASCADESPARKLINE:c("This function returns a data set used for representing a cascade sparkline",[h("pointsRange"),h("pointIndex"),h("labelsRange"),h("minimum"),h("maximum"),h("colorPositive"),h("colorNegative"),h("vertical"),h("itemTypeRange"),h("colorTotal")]),PARETOSPARKLINE:c("This function returns a data set used for representing a pareto sparkline",[h("points"),h("pointIndex"),h("colorRange"),h("target"),h("target2"),h("highlightPosition"),h("label"),h("vertical"),h("targetColor"),h("target2Color"),h("labelColor"),h("barSize")]),MONTHSPARKLINE:c("This function returns a data set used for representing a month sparkline",[h("year"),h("month"),h("dataRange"),h("emptyColor"),h("startColor"),h("middleColor"),h("endColor")]),YEARSPARKLINE:c("This function returns a data set used for representing a year sparkline",[h("year"),h("dataRange"),h("emptyColor"),h("startColor"),h("middleColor"),h("endColor")]),GAUGEKPISPARKLINE:c("This function returns a data set used for representing a gauge KPI sparkline",[h("targetValue"),h("currentValue"),h("minValue"),h("maxValue"),h("showLabel",!1,!0),h("targetValueLabel",!1,!0),h("currentValueLabel",!1,!0),h("minValueLabel",!1,!0),h("maxValueLabel",!1,!0),h("fontArray",!1,!0),h("minAngle",!1,!0),h("maxAngle",!1,!0),h("radiusRatio",!1,!0),h("gaugeType",!1,!0),h("colorRange",!0,!0)]),HISTOGRAMSPARKLINE:c("This function returns a data set used for representing a histogram sparkline",[h("dateRange"),h("continuous"),h("paintLabel"),h("scale"),h("barWidth"),h("barColor"),h("labelFontStyle"),h("labelColor"),h("edgeColor")]),"CEILING.PRECISE":c("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[h("number"),h(r,!1,!0)]),"COVARIANCE.S":c("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[h("array1"),h("array2")]),"FLOOR.PRECISE":c("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[h("number"),h(r,!1,!0)]),"PERCENTILE.EXC":c("This function returns the nth percentile of values in a range.",[h("array"),h("k")]),"QUARTILE.EXC":c("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[h("array"),h("quart")]),"RANK.AVG":c("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[h("number"),h("ref"),h("order",!1,!0)]),"MODE.MULT":c("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[h("number1"),h("number2",!0)]),"STDEV.P":c("This function returns the standard deviation for an entire specified population (of numeric values).",[h("number1"),h("number2",!0)]),"VAR.P":c("This function returns variance based on the entire population, which uses only numeric values.",[h("number1"),h("number2",!0)]),"COVARIANCE.P":c("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[h("array1"),h("array2")]),"MODE.SNGL":c("This function returns the most frequently occurring value in a set of data.",[h("number1"),h("number2",!0)]),"PERCENTILE.INC":c("This function returns the nth percentile of values in a range.",[h("array"),h("k")]),"QUARTILE.INC":c("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[h("array"),h("quart")]),"RANK.EQ":c("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[h("number"),h("ref"),h("order",!1,!0)]),STDEV:c("This function returns standard deviation is estimated based on a sample.",[h("number1"),h("number2",!0)]),"STDEV.S":c("This function returns standard deviation is estimated based on a sample.",[h("number1"),h("number2",!0)]),"VAR.S":c("This function returns the variance based on a sample of a population, which uses only numeric values.",[h("number1"),h("number2",!0)]),"BETA.INV":c("This function calculates the inverse of the cumulative beta distribution function.",[h("probability"),h("alpha"),h("beta"),h("lower",!1,!0),h("upper",!1,!0)]),"BINOM.DIST":c("This function calculates the individual term binomial distribution probability.",[h("number_s"),h("trials"),h("probability_s"),h("cumulative")]),"BINOM.INV":c("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[h("trials"),h("probability_s"),h("alpha")]),"CHISQ.DIST.RT":c("This function calculates the one-tailed probability of the chi-squared distribution.",[h("value"),h("deg_freedom")]),"CHISQ.INV.RT":c("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[h("probability"),h("deg_freedom")]),"CHISQ.TEST":c("This function calculates the test for independence from the chi-squared distribution.",[h("actual_range"),h("expected_range")]),"CONFIDENCE.NORM":c("This function returns confidence interval for a population mean.",[h("alpha"),h("standard_dev"),h("size")]),"EXPON.DIST":c("This function returns the exponential distribution or the probability density.",[h("value"),h("lambda"),h("cumulative")]),"F.DIST.RT":c("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[h("value"),h("deg_freedom1"),h("deg_freedom2")]),"F.INV.RT":c("This function returns the inverse of the F probability distribution.",[h("probability"),h("deg_freedom1"),h("deg_freedom2")]),"F.TEST":c("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[h("array1"),h("array2")]),"GAMMA.DIST":c("This function returns the gamma distribution.",[h("x"),h("alpha"),h("beta"),h("cumulative")]),"GAMMA.INV":c("This function returns the inverse of the gamma cumulative distribution.",[h("probability"),h("alpha"),h("beta")]),"LOGNORM.INV":c("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[h("probability"),h("mean"),h("standard_dev")]),"NORM.DIST":c("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[h("x"),h("mean"),h("standard_dev"),h("cumulative")]),"NORM.INV":c("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[h("probability"),h("mean"),h("standard_dev")]),"NORM.S.INV":c("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[h("probability")]),"PERCENTRANK.INC":c("This function returns the rank of a value in a data set as a percentage of the data set.",[h("array"),h("n"),h(r,!1,!0)]),"POISSON.DIST":c("This function returns the Poisson distribution.",[h("nevents"),h("mean"),h("cumulative")]),"T.INV.2T":c("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[h("probability"),h("deg_freedom")]),"T.TEST":c("This function returns the probability associated with a t-test.",[h("array1"),h("array2"),h("tails"),h("type")]),"WEIBULL.DIST":c("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[h("x"),h("alpha"),h("beta"),h("cumulative")]),"Z.TEST":c("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[h("array"),h("x"),h("sigma",!1,!0)]),"T.DIST.RT":c("This function returns the right-tailed t-distribution.",[h("x"),h("deg_freedom")]),"T.DIST.2T":c("This function returns the two-tailed t-distribution.",[h("x"),h("deg_freedom")]),"ISO.CEILING":c("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[h("number"),h(r,!1,!0)]),"BETA.DIST":c("This function returns the beta distribution.",[h("x"),h("alpha"),h("beta"),h("cumulative"),h("lower"),h("upper")]),"GAMMALN.PRECISE":c("This function returns the natural logarithm of the gamma function.",[h("value")]),"ERF.PRECISE":c("This function returns the error function.",[h("lowerlimit")]),"ERFC.PRECISE":c("This function returns the complementary ERF function.",[h("lowerlimit")]),"PERCENTRANK.EXC":c("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[h("array"),h("x"),h(r,!1,!0)]),"HYPGEOM.DIST":c("This function returns the hypergeometric distribution.",[h("sample_s"),h("number_sample"),h("population_s"),h("number_pop"),h("cumulative")]),"LOGNORM.DIST":c("This function returns the log normal distribution of x.",[h("x"),h("mean"),h("stdev"),h("cumulative")]),"NEGBINOM.DIST":c("This function returns the negative binomial distribution.",[h("number_f"),h("number_s"),h("probability_s"),h("cumulative")]),"NORM.S.DIST":c("This function returns the standard normal distribution.",[h("z"),h("cumulative")]),"T.DIST":c("This function returns the t-distribution.",[h("x"),h("deg_freedom"),h("cumulative")]),"F.DIST":c("This function returns the F probability distribution.",[h("x"),h("deg_freedom1"),h("deg_freedom2"),h("cumulative")]),"CHISQ.DIST":c("This function returns the chi-squared distribution.",[h("x"),h("deg_freedom"),h("cumulative")]),"F.INV":c("This function returns the inverse of the F probability distribution.",[h("probability"),h("deg_freedom1"),h("deg_freedom2")]),"T.INV":c("This function returns the left-tailed inverse of the t-distribution.",[h("probability"),h("deg_freedom")]),"CHISQ.INV":c("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[h("probability"),h("deg_freedom")]),"CONFIDENCE.T":c("This function returns the confidence interval for a Student's t distribution.",[h("alpha"),h("standard_dev"),h("size")]),"NETWORKDAYS.INTL":c("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[h("start_date"),h("end_date"),h("weekend",!1,!0),h("holidays",!1,!0)]),"WORKDAY.INTL":c("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[h("start_date"),h("days"),h("weekend",!1,!0),h("holidays",!1,!0)]),REFRESH:c("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[h("formula"),h("evaluateMode"),h("interval")]),DAYS:c("This function returns the number of days between two dates.",[h("end_date"),h("start_date")]),ISOWEEKNUM:c("This function returns the number of the ISO week number of the year for a given date.",[h("date")]),BITAND:c('This function returns a bitwise "AND" of two numbers.',[h("number1"),h("number2")]),BITLSHIFT:c('This function returns a bitwise "OR" of two numbers.',[h("number"),h("shift_amount")]),BITOR:c('This function returns a bitwise "OR" of two numbers.',[h("number1"),h("number2")]),BITRSHIFT:c('This function returns a bitwise "OR" of two numbers.',[h("number"),h("shift_amount")]),BITXOR:c('This function returns a bitwise "XOR" of two numbers.',[h("number1"),h("number2")]),IMCOSH:c("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[h("complexnum")]),IMCOT:c("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[h("complexnum")]),IMCSC:c("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[h("complexnum")]),IMCSCH:c("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[h("complexnum")]),IMSEC:c("This function returns the secant of a complex number in x+yi of x+yj text format.",[h("complexnum")]),IMSECH:c("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[h("complexnum")]),IMSINH:c("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[h("complexnum")]),IMTAN:c("This function returns the tangent of a complex number in x+yi or x+yj text format.",[h("complexnum")]),PDURATION:c("This function returns the number of periods required by an investment to reach a specified value.",[h("rate"),h("pval"),h("fval")]),RRI:c("This function returns an equivalent interest rate for the growth of an investment.",[h("nper"),h("pval"),h("fval")]),ISFORMULA:c("This function tests whether contains a formula of a referenced cell.",[h("cellreference")]),IFNA:c("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[h("value"),h("value_if_na")]),IFS:c("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[h("logical_test1"),h("value_if_true1"),h("logical_test2",!0),h("value_if_true2",!0)]),SWITCH:c("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[h("expression"),h("value1"),h("result1"),h("default_or_value2",!0,!0),h("result2",!0,!0)]),XOR:c("This function returns a logical exclusive or of all arguments.",[h("logical",!0)]),AREAS:c("This function returns the number of areas in a reference.",[h("reference")]),FORMULATEXT:c("This function returns a formula as a string.",[h("reference")]),HYPERLINK:c("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[h("link_location"),h("friendly_name")]),ACOT:c("This function calculates the inverse arccotangent of a number.",[h("number")]),ACOTH:c("This function calculates the inverse hyperbolic arccotangent of a number.",[h("number")]),ARABIC:c("This function converts a Roman numeral text to an Arabic numeral equivalent.",[h("text")]),BASE:c("This function converts a number into a text representation with the given radix (base).",[h("number"),h("radix"),h("min_length",!1,!0)]),"CEILING.MATH":c("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[h("number"),h(r,!1,!0),h("mode",!1,!0)]),COMBINA:c("This function calculates the number of possible combinations with repetitions for a specified number of items.",[h("number"),h("number_chosen")]),COT:c("This function returns the cotangent of the specified angle.",[h("angle")]),COTH:c("This function returns the hyperbolic cotangent of the specified number.",[h("value")]),CSC:c("This function returns the cosecant of the specified angle.",[h("angle")]),CSCH:c("This function returns the hyperbolic cosecant of the specified number.",[h("value")]),DECIMAL:c("This function converts a text representation of a number in a given base into a decimal number.",[h("text"),h("radix")]),"FLOOR.MATH":c("This function round a number down to the nearest integer or to the nearest multiple of significance.",[h("number"),h(r,!1,!0),h("mode",!1,!0)]),SEC:c("This function returns the secant of the specified angle.",[h("angle")]),SECH:c("This function returns the hyperbolic secant of the specified value.",[h("value")]),"BINOM.DIST.RANGE":c("This function calculates the probability of a trial result using a binomial distribution.",[h("trials"),h("probability_s"),h("number_s"),h("number_s2",!1,!0)]),GAMMA:c("This function returns the gamma function value.",[h("number")]),MAXIFS:c("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[h("max_range"),h("criteria_range1"),h("criteria1"),h("criteria_range2",!0),h("criteria2",!0)]),GAUSS:c("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[h("number")]),MINIFS:c("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[h("min_range"),h("criteria_range1"),h("criteria1"),h("criteria_range2",!0),h("criteria2",!0)]),PERMUTATIONA:c("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[h("number"),h("number_chosen")]),PHI:c("This function returns the value of the density function for a standard normal distribution.",[h("value")]),"SKEW.P":c("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[h("number1"),h("number2",!0)]),BAHTTEXT:c('This function converts a number to Thai text and adds a suffix of "Baht"',[h("number")]),CONCAT:c('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[h("text1"),h("text2",!0)]),FINDB:c("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[h("find_text"),h("within_text"),h(n,!1,!0)]),LEFTB:c("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[h("text"),h("num_bytes")]),LENB:c("This function returns the length of the number of bytes in a text string.",[h("text")]),MIDB:c("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[h("text"),h("start_num"),h("num_bytes")]),REPLACEB:c("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[h("old_text"),h("start_byte"),h("num_bytes"),h("new_text")]),RIGHTB:c("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[h("text"),h("num_bytes")]),SEARCHB:c("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[h("find_text"),h("within_text"),h(n,!1,!0)]),TEXTJOIN:c("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[h("delimiter"),h("ignore_empty"),h("text1"),h("text2",!0)]),UNICHAR:c("This function returns the Unicode character of a given numeric reference.",[h("number")]),UNICODE:c("This function returns the number corresponding to the first character of the text.",[h("text")]),ENCODEURL:c("This function returns a URL-encoded string.",[h("text")]),BC_QRCODE:c("This function returns a data set for representing a QRCode",[h("value"),h("color"),h("backgroundColor"),h("errorCorrectionLevel"),h("model"),h("version"),h("mask"),h("connection"),h("connectionNo"),h("charCode"),h("charset"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_EAN13:c("This function returns a data set for representing a EAN13.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("addOn"),h("addOnLabelPosition"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_EAN8:c("This function returns a data set for representing a EAN8.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_CODABAR:c("This function returns a data set for representing a CODABAR.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("checkDigit"),h("nwRatio"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_CODE39:c("This function returns a data set for representing a CODE39.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("labelWithStartAndStopCharacter"),h("checkDigit"),h("nwRatio"),h("fullASCII"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_CODE93:c("This function returns a data set for representing a CODE93.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("checkDigit"),h("fullASCII"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_CODE128:c("This function returns a data set for representing a CODE128.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("codeSet"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_GS1_128:c("This function returns a data set for representing a GS1_128.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_CODE49:c("This function returns a data set for representing a CODE49.",[h("value"),h("color"),h("backgroundColor"),h("showLabel"),h("labelPosition"),h("grouping"),h("groupNo"),h("fontFamily"),h("fontStyle"),h("fontWeight"),h("textDecoration"),h("textAlign"),h("fontSize"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_PDF417:c("This function returns a data set for representing a PDF417.",[h("value"),h("color"),h("backgroundColor"),h("errorCorrectionLevel"),h("rows"),h("columns"),h("compact"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),BC_DATAMATRIX:c("This function returns a data set for representing a DATAMATRIX.",[h("value"),h("color"),h("backgroundColor"),h("eccMode"),h("ecc200SymbolSize"),h("ecc200EncodingMode"),h("ecc00_140SymbolSize"),h("structuredAppend"),h("structureNumber"),h("fileIdentifier"),h("quietZoneLeft"),h("quietZoneRight"),h("quietZoneTop"),h("quietZoneBottom")]),FILTER:c("This function filter a range or array.",[h("array"),h("include"),h("if_empty",!1,!0)]),RANDARRAY:c("This function returns an array of random numbers.",[h("rows"),h("columns"),h("min"),h("max"),h("whole_number")]),SEQUENCE:c("This function returns a sequence of numbers.",[h("rows"),h("columns"),h("start"),h("step")]),SINGLE:c("This function returns a single value when given a value, range or array.",[h("value")]),SORT:c("This function sorts a range or array.",[h("array"),h("sort_index"),h("sort_order"),h("by_col")]),SORTBY:c("This function sorts a range or array based on the values in a corresponding range or array.",[h("array"),h("by_array1"),h("sort_order1"),h("by_array2",!0),h("sort_order2",!0)]),UNIQUE:c("This function returns the unique values from a range or array.",[h("array"),h("by_col",!1,!0),h("exactly_once",!1,!0)]),QUERY:c("This function returns data from data manager tables in a worksheet.",[h("tableAndRows"),h("columns"),h("returnObject")]),LET:c("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[h("name1"),h("name_value1"),h("name2",!0),h("name_value2",!0),h("calculation")]),IMAGE:c("This function input an URL or a base64 string to show an image in cell",[h("source"),h("[alt_text]"),h("[sizing]"),h("[height]"),h("[width]"),h("[clipY]"),h("[clipX]"),h("[clipHeight]"),h("[clipWidth]"),h("[vAlign]"),h("[hAlign]")]),GETPIVOTDATA:c("This function extracts data stored in a PivotTable",[h("data_field"),h("pivot_table"),h("field1, item1",!0,!0)]),WEBSERVICE:c("This function returns data from a web service",[h("url")]),FILTERJSON:c("This function parses json string to a scalar value, an object or an array of objects.",[h("json_string")]),ASC:c("The ASC function changes full-width(double-byte) characters to half-width(single-byte) characters, Use with double-byte character sets (DBCS).",[h("text")]),DBCS:c("The DBCS function converts half-width(single-byte) letters within a character string to full-width(double-byte) characters.",[h("text")]),LAMBDA:c("Creates a function value, which can be called within formulas.",[h("parameter_or_calculation"),h("parameter_or_calculation",!0,!0)]),MAP:c("Returns an array formed by mapping each value in the array(s) to a new value by applying a LAMBDA to create a new value.",[h("array"),h("lambda_or_array",!0)]),REDUCE:c("Reduces an array to an accumulated value by applying a LAMBDA to each value and returning the total value in the accumulator.",[h("init_value"),h("array"),h("function")]),SCAN:c("Scans an array by applying a LAMBDA to each value and returns an array that has each intermediate value.",[h("init_value",!1,!0),h("array"),h("function")]),MAKEARRAY:c("Returns a calculated array of a specified row and column size, by applying a LAMBDA.",[h("rows"),h("cols"),h("function")]),BYCOL:c("Applies a LAMBDA to each column and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 3 columns by 1 row.",[h("array"),h("function")]),BYROW:c("Applies a LAMBDA to each row and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 1 column by 2 rows.",[h("array"),h("function")]),ISOMITTED:c("Checks whether the value in a LAMBDA is missing and returns TRUE or FALSE.",[h("argument")]),TEXTBEFORE:c("Returns text that occurs before a given character or string.",[h("text"),h("delimiter"),h("instance_num",!1,!0),h(i,!1,!0,u),h("match_end",!1,!0),h(o,!1,!0)]),TEXTAFTER:c("Returns text that occurs after given character or string.",[h("text"),h("delimiter"),h("instance_num",!1,!0),h(i,!1,!0,u),h("match_end",!1,!0),h(o,!1,!0)]),TEXTSPLIT:c("Splits text strings by using column and row delimiters.",[h("text"),h("col_delimiter"),h("row_delimiter",!1,!0),h("ignore_empty",!1,!0),h(i,!1,!0,u),h(a,!1,!0)]),"SJS.REGEXEXTRACT":c("Extracts matching substrings according to a regular expression.",[h("text"),h("regular_expression"),h("modifiers",!1,!0)]),"SJS.REGEXMATCH":c("Whether a piece of text matches a regular expression.",[h("text"),h("regular_expression"),h("modifiers",!1,!0)]),"SJS.REGEXREPLACE":c("Replaces part of a text string with a different text string using regular expressions.",[h("text"),h("regular_expression"),h("replacement"),h("modifiers",!1,!0)]),VSTACK:c("Appends arrays vertically and in sequence to return a larger array.",[h("array1"),h("array2",!0,!0)]),HSTACK:c("Appends arrays horizontally and in sequence to return a larger array.",[h("array1"),h("array2",!0,!0)]),TOROW:c("Returns the array in a single row.",[h("array"),h("ignore",!1,!0),h("scan_by_column",!1,!0)]),TOCOL:c("Returns the array in a single column.",[h("array"),h("ignore",!1,!0),h("scan_by_column",!1,!0)]),WRAPROWS:c("Wraps the provided row or column of values by rows after a specified number of elements to form a new array.",[h("vector"),h("wrap_count"),h(a,!1,!0)]),WRAPCOLS:c("Wraps the provided row or column of values by columns after a specified number of elements to form a new array.",[h("vector"),h("wrap_count"),h(a,!1,!0)]),TAKE:c("Returns a specified number of contiguous rows or columns from the start or end of an array.",[h("array"),h("rows"),h("columns",!1,!0)]),DROP:c("Excludes a specified number of rows or columns from the start or end of an array.",[h("array"),h("rows"),h("columns",!1,!0)]),EXPAND:c("Expands or pads an array to specified row and column dimensions.",[h("array"),h("rows"),h("columns",!1,!0),h(a,!1,!0)]),CHOOSEROWS:c("Returns the specified rows from an array.",[h("array"),h("row_num1"),h("row_num2",!0,!0)]),CHOOSECOLS:c("Returns the specified columns from an array.",[h("array"),h("col_num1"),h("col_num2",!0,!0)]),"SJS.UUID":c("Returns the random UUID.",[h("number")]),"SJS.ENDWITH":c("Returns whether str1 ends with str2.",[h("within_text"),h("find_text"),h(i,!1,!0,u)]),"SJS.STARTWITH":c("Returns whether the string str1 starts with str2.",[h("within_text"),h("find_text"),h(i,!1,!0,u)]),"R.INDEX":c("(ReportSheet Specific) Returns the index of the specified cell in the parent measured extension.",[h("reference"),h("context_reference",!1,!0)]),"R.RANK":c("(ReportSheet Specific) Returns the rank of the specified cell in the parent node.",[h("reference"),h("context_reference",!1,!0),h("order",!1,!0),h("rank_mode",!1,!0)]),"SJS.FISCALYEAR":c("return fiscal year.",[h("date"),h("start_month",!1,!0)]),"R.R":c("(ReportSheet Specific) Relative offset according to the specified cell.",[h("reference"),h("offset")]),"R.A":c("(ReportSheet Specific) Absolute offset based on the specified cell.",[h("reference"),h("offset")]),"R.V":c("(ReportSheet Specific) Returns the data of the cell base on the specified offset or context.",[h("reference"),h('offset | context_reference | "CurrentPage"',!0,!0)]),"R.CURRENTPAGE":c("(ReportSheet Specific) Returns the current page number of the report.",[]),"R.PAGESCOUNT":c("(ReportSheet Specific) Returns the total number of current reports.",[]),"R.PROPORTION":c("(ReportSheet Specific) Returns the percentage of the specified cell in its parent node.",[h("value_reference"),h("context_reference1",!1,!0),h("context_reference2",!1,!0)]),"R.CUMULATIVE":c("(ReportSheet Specific) Returns the accumulated value of the current cell.",[h("value_reference"),h("context_reference1",!1,!0),h("context_reference2",!1,!0)]),"R.MOM":c("(ReportSheet Specific) Returns the ring data of the target cell.",[h("value_reference"),h("context_reference1",!1,!0),h("context_reference2",!1,!0)]),"R.YOY":c("(ReportSheet Specific) Returns the year-on-year data of the target cell.",[h("value_reference"),h("context_reference1"),h("context_reference2",!1,!0)])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",d2t:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(C,e,t){var n,L,M,o,r,F,B,h,l,u,a,s,P,U,T,_,x,k,f,c,N,I,d,m,O,D,b,H,G,q,j,V,K,i,Y;function X(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}}function W(e,t){var n,r,i,o,a,u;if(!t.ITe)for(n=e.getRangeCount(),r=e.rT,i=t.Xkt,o=0;o<n;o++)(a=e.$gt[o]).id=r.id,r.getRangeKey&&(u=r.getRangeKey(r,a),i)&&(i.qkt||(i.qkt={}),i.qkt[u]=a)}function Z(e){return e&&e.getRowCount&&(1<e.getRowCount()||1<e.getColumnCount())}function v(e,t,n,r,i,o){this.M8t=0,this.C8t=0,this.S8t=0,this.localScopes=new M.LocalScopes,this.lambdaFunctionCallDepth=0;var a=this;a.source=e,a.arrayFormulaMode=!!n,a.ECe=!(!e||!e.Qpe),a.identity=t||a.T8t(0,0),a.arrayIdentity=r,a.row=r?r.row:a.identity.row||0,a.column=r?r.col:a.identity.col||0,a.rowOffset=r?a.identity.row-r.row:a.row,a.columnOffset=r?a.identity.col-r.col:a.column,a.WK=i,a.Xkt=o}function p(e,t){this.id=e.M8t,e.M8t++,this.ctx=e,this.row=e.row+(e.arrayFormulaMode&&e.rowOffset||0),this.col=e.column+(e.arrayFormulaMode&&e.columnOffset||0),this.node=t}function y(e,t,n,r,i,o,a,u){var a,u,a=Y.call(this,e,isNaN(u)?F:{row:a,col:u},t,isNaN(o)?F:{row:n,col:r,rowCount:i,colCount:o})||this,u=e.op().getGlobalSourceModel(e);return a.A8t=u&&u.getSource(),a}function z(e,t){return e&&t?e.row===t.row&&e.col===t.col:e===t}function g(e){this.service=e,this.asyncManager=new H(this)}function J(e,t){this.id=e,this.Y6=B,this.yL=!1,this.R1t=[],this.I8t=!1,t!==B&&(this.evaluateMode=t)}function A(e){var t=this;t.x8t=[],t.N8t=-1,t.b8t={},t.MX=e,t.k8t=0}function Q(e){for(var t,n,n=0;n<e.R1t.length;n++)(t=e.R1t[n]).yL=!1,0<t.R1t.length&&Q(t)}function E(e){var t,n,e,t=!0,n=e;return e&&e.getValue&&((e=s(e,0,!1,!1)).isError?n=e[0]:1===e.rowCount&&1===e.colCount?n=e[0][0]:(n=e,t=!1)),{value:n,success:t}}function $(e,t,n){var r,i,o,r=k,i=1===e.rowCount,o=1===e.colCount;return i&&o?e[0][0]:(i&&n<e.colCount?r=e[0][n]:o&&t<e.rowCount?r=e[t][0]:t<e.rowCount&&n<e.colCount&&(r=e[t][n]),r)}function w(e,t,n,r){return a(t)?t:a(n)?n:(0,M.isLambdaFunction)(t)||(0,M.isLambdaFunction)(n)?_:e<=2?ee(e,t,n):e<=14?te(e,t,n,r):18===e?M.Functions.Mmt.PROPERTY.evaluate(t,n):ie(e,t,n)}function S(e,t,n){var r=e.row,e=e.column;return(n=n||t).$9t=!0,M.Functions.findGlobalFunction("@").evaluate({row:r,column:e},t)}function ee(e,t,n){var t,r,i,o,a,u,s,f;if(0===e)return t;if(""===t&&1===e)return _;if(!t)return 0;if((t=E(t)).success)return R(e,t.value);if(n){for(r=[],o=(i=t.value).rowCount,a=i.colCount,u=0;u<o;u++)for(s=r[u]=[],f=0;f<a;f++)s[f]=R(e,i[u][f]);return new M.CalcArray(r)}}function te(e,t,n,r){var i,o,a,u,s,f,c,h,l,d,m,v,p,b,T,i=e<=7?R:8===e?ne:re,o=E(t),a=E(n);if(o.success&&a.success)return i(e,o.value,a.value,r);for(t=o.value,n=a.value,u=o.success?1:t.rowCount,s=o.success?1:t.colCount,f=a.success?1:n.rowCount,c=a.success?1:n.colCount,h=Math.max(u,f),l=Math.max(s,c),d=[],m=0;m<h;m++){for(v=[],p=0;p<l;p++)b=o.success?t:$(t,m,p),T=a.success?n:$(n,m,p),v.push(b===k||T===k?k:i(e,b,T,r));d.push(v)}return new M.CalcArray(d)}function R(e,t,n,r){var i,t,o,n;function a(e){return"string"==typeof e&&0===e.trim().length}if(a(t)||a(n))return _;if(!u(t,i={value:0}))return t instanceof M.CalcError?t:_;if(t=i.value,n!==B){if(!u(n,i))return n instanceof M.CalcError?n:_;o=i.value}else o=0;return 1===e?-t:2===e?t/100:3===e?M.ExcelCompatibleCalcMode&&!r?t+o:L.Common.st.tge(t,o):4===e?M.ExcelCompatibleCalcMode&&!r?t-o:L.Common.st.tge(t,-o):5===e?t*o:6===e?o?t/o:f:7===e?!t&&o<0?f:0===t&&0===o||(n=M.Functions.MathHelper.N9t(t,o))===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY||isNaN(n)?c:n:void 0}function ne(e,t,n){if(8===e)return a(t)?t:("number"==typeof t&&(t=L.Common.st.E8(t,M.Functions.CALC_PRECISION||15)),a(n)?n:("number"==typeof n&&(n=L.Common.st.E8(n,M.Functions.CALC_PRECISION||15)),M.Convert.j(t)+M.Convert.j(n)))}function re(e,t,n){var t=(0,M.$kt)(t,n,!1);return a(t)?t:9===e&&0===t||10===e&&0!==t||11===e&&t<0||12===e&&t<=0||13===e&&0<t||14===e&&0<=t}function ie(e,t,n){var r,i,o,e,a,u,s,f,c,o,a,s,e;if(!t||!n||(1!==t.getRangeCount()||1!==n.getRangeCount())&&16!==e||t.endSource||n.endSource)return _;if(!(r=t.getSource())||r!==n.getSource())return _;if(16===e)i=t.$gt.concat(n.$gt);else{if(o=15===e?h:l,e=15===e?l:h,a=t.getRow(0),u=t.getColumn(0),s=n.getRow(0),f=n.getColumn(0),c=o(a,s),o=o(u,f),a=e(a+t.getRowCount(0),s+n.getRowCount(0))-c,s=e(u+t.getColumnCount(0),f+n.getColumnCount(0))-o,a<1||s<1)return M.Errors.Null;i=[X(c,o,a,s)]}return(e=new M.CalcReference(r,i)).V9t=!0,e}function oe(e,t){var n,r,i,o,n=!0;switch(t.J6t){case 0:r=G(e),i=!0;break;case 1:r=parseFloat(e),i=!0;break;case 2:r=q(e),i=!0;break;case 3:r=parseInt(e,10),i=!0;break;case 4:(r=s(e,t.X6t,t.Vkt||!1,t.Ykt||!1,t.M9t||!1,t.Zkt,t.s9t,t.C9t)).isError&&(r=r[0],n=!1),r.isConvertError&&(r=_,n=!1);break;case 5:r=j(e),t.iTe&&""===r&&(r=_,n=!1);break;case 6:V(e,o={value:F})?r=o.value:(r=_,n=!1);break;case 7:r=K(e);break;case 8:!(r=M.Functions.mkt(e))||t.gkt&&0===r.ikt()&&0===r.rkt()?(r=M.Errors.Number,n=!1):r={okt:r.ikt(),akt:r.rkt()};break;default:r=e}return i&&isNaN(r)&&(r=_,n=!1),{D8t:r,_8t:n}}function ae(e,t,n){var r,i,o,a,o;for(Array.isArray(t)||(t=[t]),r=e.D8t,i=0;i<t.length;i++)if(a=(o=t[i].split(" "))[0],o=parseInt(o[1],10),"<"===a&&r<o||">"===a&&o<r||"<="===a&&r<=o||">="===a&&o<=r||"="===a&&r===o||"!="===a&&r!==o||"checkLength"===a&&r.length>o)return e.D8t=n===B?M.Errors.Number:n,void(e._8t=!1)}function ue(e,t){var n,r,i,o,a,u,n=[];if(!t)return{ADt:e,_8t:!0};if(t.n9t)for(o=0;o<e.length;o++)n.push(t);else n=Array.isArray(t)?t:[t];for(i=0;i<n.length;i++){if((a=n[i]).K6t&&!e[i])throw(0,M.sR)().Exp_ArgumentNull;if(u=e[i]!==B){if(r=oe(e[i],a),a.pkt&&ae(r,a.pkt,a.zkt),!r._8t)break;e[i]=a.ykt?{ekt:u,y4:r.D8t}:r.D8t}else e[i]=a.ykt?{ekt:u,y4:a.bkt}:a.bkt}return r?{ADt:e,_8t:r._8t,Y6:r.D8t}:void 0}n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Object.defineProperty(e,"__esModule",{value:!0}),e.evaluateOperator=e.AsyncFunctionNode=e.Evaluator=e.GloableEvaluateContext=e.AsyncEvaluateContext=e.EvaluateContext=void 0,L=t("Common"),M=t("./src/calc.common.ts"),o=t("./src/calc.ts"),r=L.Common.lt.ht,F=null,B=void 0,h=Math.min,l=Math.max,u=M.Convert.sJ,a=M.Convert.BJ,s=M.Convert.iV,P=M.Convert.Nh,U=M.Convert.LE,T=M.Errors.Reference,_=M.Errors.Value,x=M.Errors.Name,k=M.Errors.NotAvailable,f=M.Errors.DivideByZero,c=M.Errors.Number,N=M.Errors.Calc,I="LAMBDA",v.prototype.T8t=function(e,t){return{row:e,col:t}},v.prototype.E8t=function(e){return e},v.prototype.getValue=function(e,t){return e?this.E8t(e).getValue(t):T},v.prototype.getReference=function(e,t){return e?this.E8t(e).getReference(t):T},v.prototype.getSheetRangeReference=function(e){return!e||!e.source||!e.endSource||e.source instanceof M.ErrorSource?T:this.E8t(e.source).getSheetRangeReference(e)},v.prototype.getFunction=function(e){var t=this;return t.source?t.source.getCustomFunction(e):F},v.prototype.getName=function(e,t,n){var r,i,t,n,r=this,i=F;return t?i=t.getCustomName(e):r.source&&!n&&(i=r.source.getCustomName(e)),i=!i&&r.source?(n=(t=r.source.op())&&t.getGlobalSourceModel())&&n.getSource().getCustomName(e):i},v.prototype.getNameInfo=function(e){return(0,M.W9t)(this.source,e)},v.prototype.getField=function(e){var t=this;return t.source?t.source.getField(e):F},v.prototype.getFieldItem=function(e){var t=this;return t.source?t.source.getFieldItem(e):F},v.prototype.j8t=function(){return 0<this.S8t},v.prototype.O8t=function(){this.S8t++},v.prototype.R8t=function(){this.S8t--},v.prototype.SetAsyncResult=function(e,t){this.source.op().MX.SetAsyncResult(e,t)},v.prototype.cloneFrom=function(e){var t=this;t.acceptsReference=e.acceptsReference,t.arrayFormulaMode=e.arrayFormulaMode},d=v,e.EvaluateContext=d,M.CalcSource.prototype.getEvaluatorContext=function(e,t,n,r,i){return new d(this,e,t,n,r,i)},p.prototype.setAsyncResult=function(e){var e,t;this.node.Y6=e,this.node.yL=!0,this.ctx.SetAsyncResult(this,e),(t=this.ctx.source).B8t||null!=(e=t.Lbt)&&e.incrementalCalculation||(t.B8t=!0,setTimeout(function(){t.refresh(),delete t.B8t},200))},p.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},p.prototype.L8t=function(){for(var e,t,n,e=this.node&&this.node.parent,t=e&&e.R1t||[],n=0;n<t.length;n++)if(!t[n].yL)return!1;return!0},p.prototype.MCe=function(){var e=this.node&&this.node.parent;e&&e.SCe&&(e.yL=!0)},m=p,e.AsyncEvaluateContext=m,n(y,Y=d),y.prototype.getName=function(e){var t=this;return t.A8t?t.A8t.getCustomName(e):F},e.GloableEvaluateContext=y,g.prototype.evaluateExpression=function(e,t,n,r,i,o){var e,e,n,r,e=void 0===e.type&&e.WK?e.WK:e,e=this.evaluate(e,t,!!r,!!i);return e&&e.pause?e:(0,M.isLambdaFunction)(e)?N:e===B||e===F?!1===n?e:0:((P(e)&&!r||U(e)&&!i)&&(e=this.getOneValue(t,e)),M.ExcelCompatibleCalcMode||o?e:(n=15,"number"==typeof e&&-10<e&&e<10&&(1<(r=e.toString()).indexOf("000000000000")||1<r.indexOf("999999999999"))&&(n=14),L.Common.st.E8(e,M.Functions.CALC_PRECISION||n)))},g.prototype.evaluate=function(e,t,n,r){var i,o,a,u;if(!e)throw(0,M.sR)().Exp_ExprIsNull;if(void 0===e.type){if(e._error)return e;e.WK&&(e=e.WK)}for(;10===e.type;)e=e.value;if(i=this,a=F,12===e.type?(a=e.needExpendIndexs,e=e.value):t.k_t&&(n=!0,a=[]),2<=(u=e.type)&&u<=6)o=i.evaluateConst(e,t,n);else if(1===u||13===u||22===u)o=i.evaluateReference(e,t,r,n);else if(8===u)o=i.evaluateName(e,t,n,r);else if(100===u)o=i.evaluateLocalName(e,t,n,r);else if(9!==u||e.value2){if(9===u)o=i.evaluateBinaryOperation(e,t,n,r,a);else if(7===u){if(e.u8t&&t.N_t&&(o=i.evaluateBranchFunction(e,t,n,r,a))&&o.pause)return o;o=i.evaluateFunction(e,t,n,r,a)}else if(11===u)o=B;else if(14===u)o=i.evaluateField(e,t);else if(15===u)o=i.evaluateFieldItem(e,t);else if(t.evaluate)return t.evaluate(e,n,r)}else o=i.evaluateUnaryOperation(e,t,n,r,a);return o},g.prototype.evaluateConst=function(e,t,n){var e=e.value;return!P(e)||n||t&&(t.arrayFormulaMode||t.j8t())?e:e.getValue(0,0)},g.prototype.evaluateReference=function(e,t,n,r){var i,o,a,u,s,f,c,h,l,d,s,m,v,p,b,s,m;if(!t)return _;if(i=e.source||t.source,o=isNaN(t.row)?0:t.row,a=isNaN(t.column)?0:t.column,u=e.getRange&&e.getRange(o,a),s=e.type,!u)return 13===s&&8!==e.hbt&&2!==e.hbt?_:T;if(e.UFe&&(r=n=!1),c=u.row<0?0:u.row,h=u.col<0?0:u.col,l=u.rowCount,d=u.colCount,i.evaluateReference)return i.evaluateReference(e,t,n);if(u.row<0&&(u.rowUndefine=!0),u.col<0&&(u.colUndefine=!0),r&&(s=i.getRowCount(),m=i.getColumnCount(),(-1===l||s<l)&&(l=s),-1===d||m<d)&&(d=m),n||t.arrayFormulaMode)return e.endSource?t.getSheetRangeReference({source:e.source,endSource:e.endSource,row:c,col:h,rowCount:l,colCount:d}):t.getReference(i,u);if(r&&(1<l||1<d)){for(v=[],p=0;p<l;p++)for(v[p]=[],b=0;b<d;b++)v[p][b]=i.getValue(p+c,b+h);return new M.CalcArray(v)}if(1<l||1<d)if(s=o>=u.row&&o<u.row+l,m=a>=u.col&&a<u.col+d,s&&m)c=o,h=a;else{if(!s&&!m)return _;if(s&&1===d)c=o;else{if(!m||1!==l)return _;h=a}}else if(-1===u.row&&-1===l){if(1!==d)return _;c=o}else if(-1===u.col&&-1===d){if(1!==l)return _;h=a}return(1<l||1<d||-1===l||-1===d)&&t.WK&&t.WK.ensureSingle&&!e.UFe&&(e.$9t=!0),i.getValue(c,h)},g.prototype.evaluateName=function(e,t,n,r){var i,e,e;return t&&(e=(t=e.source?(i=e.source).getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity):t).getName(e.value))?(e=(0,o.h0t)(t,e,!1,0,0,n,r),this.evaluate(e,t,n,r)):x},g.prototype.evaluateLocalName=function(e,t,n,r){var i,o,a,u,s,f;if(!e.value||!t||!t.localScopes.hasVariable(e.value))return x;if(i=t.localScopes.getVariable(e.value),(o=t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray)||(n=e.vDt,r=e.mDt),t.arrayFormulaMode&&t.j8t())return i;if(!P(i)||n){if(!U(i)||r)return i;if(a=i,n&&1===a.getRangeCount()){for(u=[],s=0;s<a.getRowCount(0);s++)for(u[s]=[],f=0;f<a.getColumnCount(0);f++)u[s][f]=a.getValue(0,s,f);return new M.CalcArray(u)}}return this.getOneValue(t,i)},g.prototype.evaluateUnaryOperation=function(t,n,r,e,i){var o,a,o,o=!1;return i&&0<i.length&&(o=r=!0),(a=n.k_t)&&(r=!0),(o=this.evaluate(t.value,n,r,o))&&o.pause||M.Convert.BJ(o)?o:o===M.missingArgument?k:this.evaluateWithArgs(t,function(e){var e=e[0];return e&&e.getRowCount&&r&&n.WK&&(n.WK.ensureSingle&&!r?e=S(n,e):n.WK.t8t=!0),w(t.operatorType,e,r)},n,i,[o],r,e)},g.prototype.evaluateBinaryOperation=function(n,r,i,e,t){var o,a,o,u,s,f,c,h,l,l,o=r.k_t,a=[i=o?!0:i,i],u=[o=(0,M.gDt)(n.operatorType),o];if(t&&0<t.length)for(s=0;s<t.length;s++)a[t[s]]=!0,u[t[s]]=!0;for(f=n===r.WK,c=[n.value,n.value2],h=[],s=0;s<2;s++){if((l=this.evaluate(c[s],r,a[s],u[s]))&&l.pause)return l;if(M.Convert.BJ(l=l))return l;if(l===M.missingArgument&&c[s].value&&!c[s].value.table)return k;h[s]=l}return this.evaluateWithArgs(n,function(e){var t=e[0],e=e[1];return n.operatorType<=14&&r.WK&&(Z(t)||Z(e))&&(r.WK&&r.WK.ensureSingle&&!i?(t=S(r,t,c[0]),e=S(r,e,c[1])):r.WK.t8t=!0),t&&t instanceof M.TwoDimensionalCalcArray&&(t=t.getCalculatedValue()),e&&e instanceof M.TwoDimensionalCalcArray&&(e=e.getCalculatedValue()),w(n.operatorType,t,e,f)},r,t,h,i,e)},g.prototype.evaluateField=function(e,t){var n,t;return t?(t=(t=e.source?(n=e.source).getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity):t).getField(e.value),r(t)&&e.value&&!e.value.table?k:t):x},g.prototype.evaluateFieldItem=function(e,t){var n,t;return t?(t=(t=e.source?(n=e.source).getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity):t).getFieldItem(e.value),r(t)?k:t):x},g.prototype.startCache=function(e){this.F8t={},!e&&this.service.Z_t&&this.asyncManager.startCalc()},g.prototype.endCache=function(){this.F8t=F},g.prototype.evaluateBranchFunction=function(e,t,n,r,i){var o,a,u,s,u,i,n,u,o=t.Xkt&&t.Xkt.getKey();if(!(e.P8t&&t.Xkt&&e.P8t[o]&&e.P8t[o].WDt)&&(0,M.isFunction)(e.function))return a=e.function,u=e.arguments.length,s=a.findTestArgument(),i=(u=this.preprocessFunction(t,a,u,i,n)).acceptsArrays,n=u.keepArrayValuesFlagSet,(u=this.testArgGetBranch(t,a,e,i[s],!1,s))&&u.pause?u:(n&&delete t.k_t,0<=u.branchArgument&&"number"==typeof u.branchArgument?(e.P8t=e.P8t||{},e.P8t[o]=t.source.getCalcService().ZDt,{pause:"Branch",branch:e.s8t[o][u.branchArgument]}):void(u.testArgValue._error||delete e.u8t))},g.prototype.evaluateLetFunction=function(e,t,n,r){var i,o,a,u,s,a,s,f,i=e.arguments.length,o=this;for(t.localScopes.enterScope(),this.service.Z_t&&this.asyncManager.startCalcFunction(e.function,e,t),u=1;u<i-1;u+=2){if(s=e.arguments[u-1],a=e.arguments[u],s=s.value,(a=o.evaluate(a,t,n,r))&&a.pause)return a;t.localScopes.setVariable(s,a)}return this.service.Z_t&&this.asyncManager.endCalcFunction(),(f=o.evaluate(e.arguments[i-1],t,n,r))&&f.pause||t.localScopes.exitScope(),f},g.prototype.evaluateLambdaFunction=function(e,t,n,r){return t.source&&t.source.Lbt&&t.source.Lbt.allowDynamicArray&&t.WK&&(t.WK.t8t=!0),new M.Functions.LambdaFunction(e,t.localScopes.createClosure())},g.prototype.evaluateISOMITTEDFunction=function(e,t,n,r){var e=e.arguments[0];return e&&100===e.type&&null===t.localScopes.getVariable(e.value)},g.prototype.preprocessFunction=function(e,t,n,r,i){var o,a,u,s,f,c,h,l,d,o=[],a=[],u=e.k_t,s=!1,f=F;for(!u&&(1===t.arrayArgumentEvaluateMode||4===t.arrayArgumentEvaluateMode&&i)&&(s=u=e.k_t=!0),c=0;c<n;c++)o[c]=t.acceptsArray(c),a[c]=t.acceptsReference(c),t.isBranch()&&e.WK&&e.WK.ensureSingle&&!i&&(a[c]=o[c]=!1);if(r&&0<r.length||u){for(f=[],c=0;c<n;c++)f[c]=!0;for(h=u?n:r.length,c=0;c<h;c++)a[l=u?c:r[c]]=o[l]=!0,(d=!(t.acceptsReference(l)&&!t.acceptsArray(l)))&&u&&t.acceptsReference(l)&&(d=!1),f[l]=d}return t.isBranch()&&(e.arrayFormulaMode||e.j8t())&&(o[t.findTestArgument()]=!0,a[t.findTestArgument()]=!0),{acceptsArrays:o,acceptsReferences:a,getReferenceValues:f,keepArrayValuesFlagSet:s}},g.prototype.testArgGetBranch=function(e,t,n,r,i,o){var a,r,u,s,u=-1,s=e.k_t;return e.arrayFormulaMode&&(e.k_t=!0),t.acceptsArray(o)&&e.O8t(),r=this.evaluate(n.arguments[o],e,r,i),null!=(a=null==e?void 0:e.source)&&a.updateBranchPrecedents&&e.source.updateBranchPrecedents(n,e,i),r&&r.pause?r:(t.acceptsArray(o)&&e.R8t(),e.k_t=s,{testArgValue:r,branchArgument:u=U(r)||P(r)?u:t.findBranchArgument(r)})},g.prototype.evaluateFunction=function(e,t,n,r,i){var o;try{o=!e.function||(0,M.isExpression)(e.function)?this.evaluateLambdaFunctionCall(e,t,n,r,i):this.evaluateBuildInFunction(e,t,n,r,i)}catch(e){if((0,M.isStackOverflowError)(e)){if(2<=t.lambdaFunctionCallDepth)throw e;o=c}else o=_}return o},g.prototype.evaluateBuildInFunction=function(e,u,t,s,n){var f,r,c,h;return e&&e.function&&(0,M.isFunction)(e.function)?(f=e.function,r=e.functionName,c=this,h=u.C8t,"LET"===r?c.evaluateLetFunction(e,u,t,s):r===I?c.evaluateLambdaFunction(e,u,t,s):"ISOMITTED"===r?c.evaluateISOMITTEDFunction(e,u,t,s):c.evaluateFunctionCore(e,function(e,t,n){var r,i,r,o,a,o,i=ue(e,f.R9t);return e=i.ADt,i._8t?f.isContextSensitive()?(u.acceptsReference=s||u.j8t(),f instanceof M.Functions.AsyncFunction?(c.G8t=c.G8t||{},f.evaluateWhenArgumentsIsSame()?c.evaluateAsyncFunction(u,t,f,h,e,n):c.evaluateWithCache(f,e,function(){return c.evaluateAsyncFunction(u,t,f,h,e,n)},c.G8t)):(u.Whe=t,f.evaluateWithContext(u,e))):((r=u.arrayFormulaMode)&&(f.k9t={row:u.rowOffset,col:u.columnOffset}),o=(0,M.getMapping)()&&(0,M.getMapping)().builtInFunctionsMapping,a=o&&o[f.name]&&o[f.name].specialFun,o=function(){return a&&a.apply(f,e)||f.evaluate.apply(f,e)},r=r&&!u.ECe?c.evaluateWithCache(f,e,o,c.F8t):o(),delete f.k9t,r):i.Y6},u,t,s,n)):x},g.prototype.tryGetLambdaFunction=function(e,t,n,r){var i,e;if((0,M.isExpression)(e.function))i=this.evaluate(e.function,t,n,r);else if(e.isLocalFunctionName?i=t.localScopes.getVariable(e.functionName):(e=t.getName(e.functionName,e.source))&&(i=this.evaluate(e,t,n,r)),!i)return x;return i&&i.pause||a(i)||(0,M.isLambdaFunction)(i)?i:_},g.prototype.evaluateLambdaFunctionCall=function(e,u,s,f,t){var c,n,h,n,c=this,n=this.tryGetLambdaFunction(e,u,s,f);return n&&n.pause||a(n)?n:((n=(0,M.YJ)(h=n,e.arguments)).WK=e,this.evaluateFunctionCore(n,function(e){var t,n,r,i,o,a,t=u.localScopes;try{if(u.lambdaFunctionCallDepth++,t.enterScope(),t.saveThenSwitchClosure(h.closure),(r=e.length)<h.minArgs||r>h.maxArgs)return _;for(i=h.parameters,o=0;o<i.length;o++)a=o<r?e[o]:null,u.localScopes.setVariable(i[o].value,a);n=c.evaluate(h.calculation,u,s,f)}finally{u.lambdaFunctionCallDepth--,t.exitScope(),t.restoreClosure()}return n},u,s,f,t))},g.prototype.evaluateFunctionCore=function(e,t,n,r,i,o){var a,u,s,f,c,h,l,l,d,m,v,p,b,T,y,g,g,A,E,_,w;if(!e||!e.function||!(0,M.isFunction)(e.function))return x;if(a=e.arguments.length,u=this,s=e.function,f=[],h=F,s instanceof M.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(s,e,n),0!==a){if(s.name===I&&this.service.Z_t&&this.asyncManager.startCalcFunction(s,e.WK,n),d=(l=u.preprocessFunction(n,s,a,o,r)).acceptsArrays,m=l.acceptsReferences,h=l.getReferenceValues,l=l.keepArrayValuesFlagSet,b=p=v=void 0,s.isBranch()){if(p=s.findTestArgument(),(T=u.testArgGetBranch(n,s,e,d[p],m[p],p))&&T.pause)return T;v=T.testArgValue,b=T.branchArgument}for(y=0;y<a;y++){if(p===y)c=v;else{if(0<=b&&y!==b){f[y]=null;continue}if(s.acceptsArray(y)&&n.O8t(),g=n.ITe,s.skipPrecedent(y)&&!s.i9t?n.ITe=!0:n.ITe=!1,c=s.acceptsExpressionArgument(y)?e.arguments[y]:u.evaluate(e.arguments[y],n,d[y],m[y]),n.ITe=g,c&&c.pause)return c;s.acceptsArray(y)&&n.R8t()}if(!s.acceptsArray(y)&&P(c)||!s.acceptsReference(y)&&U(c))if(g=P(c)?c:F,A=U(c)?c:F,g&&1===g.getRowCount()&&1===g.getColumnCount())c=g.getValue(0,0);else if(A&&1===A.getRowCount(0)&&1===A.getColumnCount(0))c=A.getValue(0,0,0);else{if(_=!(E=[]),o)for(w=0;w<o.length;w++)E.push(o[w]),o[w]===y&&(_=!0);_||(E.push(y),o=E),!s.acceptsReference(y)&&c.referenceInTwoDimension&&c._Dt()}if(M.Convert.BJ(c)&&!s.acceptsError(y))return s instanceof M.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),c;c!==M.missingArgument||s.acceptsMissingArgument(y)||(c=F),(f[y]=c)&&"INDIRECT"!==e.functionName&&c.V9t&&c.rT&&W(c,n)}s.name===I&&this.service.Z_t&&this.asyncManager.endCalcFunction()}return l&&delete n.k_t,u.evaluateWithArgs(e,t,n,o,f,r,i,h)},g.prototype.evaluateAsyncFunction=function(e,t,n,r,i,o){var a,u,e,a=this.asyncManager.getNode();if(a.yL&&("QUERY"!==n.name||e.Xkt))u=a.Y6;else if(a.canEvaluate()){if(e=new m(e,a),u=n.evaluateWithContext(e,i),e.notAsync)return u;u===B?u=a.Y6!==B?a.Y6:n.defaultValue():1===a.evaluateMode&&(a.yL=!0)}else u=a.Y6!==B?a.Y6:n.defaultValue();return a.Y6=u,o||this.asyncManager.endCalcFunction(),u},g.prototype.evaluateWithCache=function(e,t,n,r){var i,o,a,u,s,f,c,h,l,n,d,m;if(r)if(o=!1,i=r[e.name+t.length])for(a=0;a<i.length;a++){if(o=!1,(u=i[a]).args.length===t.length){for(o=!0,s=0;s<t.length;s++)if((f=u.args[s])!==(c=t[s])){if(!(f instanceof M.CalcReference&&c instanceof M.CalcReference)){o=!1;break}if(h=f.SDt,f.rT!==c.rT||h!==c.SDt){o=!1;break}for(l=0;l<h;l++)if(f.getRow(l)!==c.getRow(l)||f.getColumn(l)!==c.getColumn(l)||f.getRowCount(l)!==c.getRowCount(l)||f.getColumnCount(l)!==c.getColumnCount(l)){o=!1;break}}o&&!z(u.k9t,e.k9t)&&(o=!1)}if(o)return u.flag++,u.value}else i=r[e.name+t.length]=[];if(n=n(),r&&n!==B){if(100<=(d=i.length)){for(m=[],a=0;a<d;a++)0<i[a].flag&&m.push(i[a]);m.sort(function(e,t){return t.flag-e.flag}),d=Math.min(50,m.length),i=m.slice(0,d),r[e.name+t.length]=i}i.push({args:t,value:n,flag:0,k9t:e.k9t})}return n},g.prototype.SetAsyncResult=function(e){var t;e.L8t()&&(e.MCe(),(t=e.ctx).identity&&t.identity.Tbt?this.service.Abt(t.source,t.WK,t.identity,t.S_t,t):t.source.op().recalculate(t.source,e.row,e.col,!0))},g.prototype.evaluateWithArgs=function(e,t,n,r,i,o,a,u){var s,f,c,h,l,d,m,v,p,b,T,y,g,A,E,c=n.k_t;if(c&&!(r&&0<r.length)&&(r=[],s=7===e.type&&e.function)&&i.forEach(function(e,t){(!s.acceptsArray(t)&&P(e)||!s.acceptsReference(t)&&U(e))&&r.push(t)}),r&&0<r.length){if(!(h=this.U8t(n,e,i,r,u)))return k;for(l=[],d=h[0].length,m=h[0][0].length,v=0;v<d;v++)for(l[v]=[],p=0;p<m;p++)try{for(b=[],T=0;T<i.length;T++)b[T]=h[T][v][p];if(f=t(b,e,v+1!==d||p+1!==m),U(f)&&!c){if(7===e.type&&(s=e.function).returnReference&&s.returnReference())return f;f=this.getOneValue(n,f)}l[v][p]=f,n.WK&&(n.WK.t8t=!0)}catch(e){if((0,M.isStackOverflowError)(e))throw e;l[v][p]=_}return new M.CalcArray(l,c)}try{if(f=t(i,e),15===e.operatorType&&f&&f.V9t&&W(f,n),(n.arrayFormulaMode||n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray)&&n.j8t())return f;if(!P(f)||o){if(!U(f)||a)return f;if(y=f,o&&1===y.getRangeCount()){for(g=[],A=0;A<y.getRowCount(0);A++)for(g[A]=[],E=0;E<y.getColumnCount(0);E++)g[A][E]=y.getValue(0,A,E);return new M.CalcArray(g)}!o&&n.WK&&n.WK.ensureSingle&&(1<f.getColumnCount()||1<f.getRowCount())&&(e.$9t=!0)}return this.getOneValue(n,f)}catch(e){if((0,M.isStackOverflowError)(e))throw e;return _}},g.prototype.getOneValue=function(e,t){var n,r,i,o,a,o;return U(t)?(o=(i=t).getRowCount(0),a=i.getColumnCount(0),t=1<i.getRangeCount()||!e.arrayFormulaMode&&1<o&&1<a?_:(r=-1!==e.rowOffset||-1!==e.columnOffset?(n=1===o?0:e.arrayFormulaMode?e.rowOffset:e.rowOffset-i.getRow(0),1===a?0:e.arrayFormulaMode?e.columnOffset:e.columnOffset-i.getColumn(0)):(n=1===o?0:e.row-i.getRow(0),1===a?0:e.column-i.getColumn(0)),o<=n||a<=r?k:i.getValue(0,n,r))):P(t)&&(o=t,t=!e.arrayFormulaMode||-1===e.rowOffset&&-1===e.columnOffset?o instanceof M.TwoDimensionalCalcArray?o.getActualValue():o.getValue(0,0):(n=1===o.getRowCount()?0:e.rowOffset,r=1===o.getColumnCount()?0:e.columnOffset,n>=o.getRowCount()||r>=o.getColumnCount()?k:o.getValue(n,r))),U(t)||P(t)?this.getOneValue(e,t):t},g.prototype.U8t=function(e,t,n,r,i){var o,a,u,s,f,c,h,l,d,m,t,v,p,b,T,y,g,A,E,_,w,x,I,S,R,C,N,O,D,o=1,a=1,u=-1,s=!0,f=!0,l=1,d=1,m=7===t.type?t:F,t=m&&m.function,v=e.arrayFormulaMode||e.source&&e.source.Lbt&&e.source.Lbt.allowDynamicArray;if(t&&(0,M.isFunction)(t)&&!t.expandRows()&&(s=!1),t&&(0,M.isFunction)(t)&&!t.expandColumns()&&(f=!1),t&&(0,M.isFunction)(t)&&t.isBranch()&&(v||e.j8t())){if(u=t.findTestArgument(),b=!(p=[]),r)for(T=0;T<r.length;T++)p.push(r[T]),r[T]===u&&(b=!0);if(b||P(n[u])||U(n[u])){for(y=0;y<m.arguments.length;y++)y!==u&&L.Common.Uf.hD(p,y)<0&&(P(n[y])||U(n[y]))&&p.push(y);r=p}}for(g=[],E=r[A=0],_=n.length,I=[],w=0;w<_;w++)x=n[w],h=c=F,l=d=1,w===E?(c=P(x)?x:F,h=U(x)?x:F,(c||h)&&(l=c&&c.getRowCount()||(s&&h?h.getRowCount(0):1),d=c&&c.getColumnCount()||(f&&h?h.getColumnCount(0):1)),E=++A<r.length?r[A]:-1):i===B&&(c=P(x)?x:F,h=U(x)?x:F,c||h)&&(l=c&&c.getRowCount()||(s&&h?h.getRowCount(0):1),d=c&&c.getColumnCount()||(f&&h?h.getColumnCount(0):1)),I[w]=[c,h,x,l,d],o=o<l?l:o,a=a<d?d:a;for(w=0;w<_;w++){if(S=g[w]=[],c=(R=I[w])[0],h=R[1],x=R[2],l=R[3],d=R[4],(c||h)&&(1!==l&&l!==o||1!==d&&d!==a)&&(-1===u||w===u)&&!v)return;for(C=0;C<o;C++)for(N=S[C]=[],O=0;O<a;O++)1!==l&&l<=C||1!==d&&d<=O?N[O]=k:c?(D=c.getValue(1===l?0:C,1===d?0:O),P(D)&&(D=D.getValue(0,0)),N[O]=D):h?!i||i[w]?N[O]=h.getValue(0,1===l?0:C,1===d?0:O):N[O]=h.create([X(h.getRow(0)+(1===l?0:C),h.getColumn(0)+(1===d?0:O),1,1)]):N[O]=x}return g},e.Evaluator=g,J.prototype.canEvaluate=function(){for(var e,t,e=this.R1t,t=0;t<e.length;t++)if(!e[t].yL)return!1;return!0},b=J,e.AsyncFunctionNode=b,A.prototype.startCalc=function(){var e,t,n,r,i,o,a,u,s;if(this.k8t)for(t in this.b8t)if(n=this.b8t[t])for(r in n)if(i=n[r])for(o in i)if((a=i[o])&&(a.root.R1t=[],0<(e=a.length)))for(u=0;u<e;u++)0===(s=a[u]).evaluateMode&&(s.yL=!1)},A.prototype.startCalcCell=function(e,t){var n,r,i,o,a,e,u,e,t,n=this,r=e.getName(),i=t.row,o=t.col;n.source=e,t.Tbt?(a=(e=(e=n.b8t["-"])||(n.b8t["-"]={}))[t.Tbt])?a=a[0]:(u=new b(-1),e[t.Tbt]=[],(a=e[t.Tbt][0]=[]).root=u):(a=(t=(t=(e=(e=n.b8t[r])||(n.b8t[r]={}))[i])||(e[i]={}))[o])||(u=new b(-1),(a=t[o]=[]).root=u),n.k8t++,n.N8t=0,n.cellNodes=a,n.row=i,n.col=o,n.x8t[0]=a.root,n.evaluateMode=-1},A.prototype.x_t=function(e){for(var t,n,t=this.b8t["-"][e][0].root.R1t,n=0;n<t.length;n++)if(!t[n].yL)return!1;return!0},A.prototype.T_t=function(e){return 0<this.b8t["-"][e][0].length},A.prototype.I_t=function(e){delete this.b8t["-"][e]},A.prototype.startCalcFunction=function(e,t,n){var o,r,i,a,u,s,f,c,h,t,l,d,m,v,p,o=this,r=t.arguments,i=!1;if(0!==o.x8t.length&&o.cellNodes||(i=!0,o.startCalcCell(n.source,n.identity)),a=o.evaluateMode,e instanceof M.Functions.AsyncFunction?u=e.evaluateMode():s=!0,"REFRESH"===e.name?(u=r[1]?o.MX.evaluate(r[1],n,!1,!1):0,o.evaluateMode=u):-1!==a&&(u=a),c=n.identity?n.identity.Tbt||n.identity.row+"|"+n.identity.col:"0",t.H8t&&t.H8t[c]?(f=t.H8t[c]).I8t&&(f.I8t=!1,o.cellNodes.push(f)):(t.H8t=t.H8t||{},f=t.H8t[c]=new b(o.cellNodes.length,u),s&&(f.SCe=!0),o.cellNodes.push(f)),o.currentNode=f,o.x8t[o.N8t].R1t.indexOf(f)<0&&(o.x8t[o.N8t].R1t.push(f),f.parent=o.x8t[o.N8t],f.R1t=[]),o.x8t.push(f),o.N8t++,2===u&&-1===a){for(h=6e4,t=o.intervals,l=e.interval()||6e4,"REFRESH"===e.name&&(f.isRefresh=!0,l=r[2]?o.MX.evaluate(r[2],n,!1,!1):6e4),t||(o.intervals=t={}),(d=t[l])||"object"!=typeof window||((d=t[l]=[]).intervalObj=window.setInterval(function(){var r,i,e,r=o.MX.service;if(1!==r.calculationMode&&!r.IsSuspended())for(i=o.intervals[l],e=function(){var e,t,n,e=i[m],t=e.node;t.yL=!1,t.isRefresh&&Q(t),r.recalculate(e.source,e.row,e.col,!0),(n=o.source).B8t||r.incrementalCalculation||(n.B8t=!0,setTimeout(function(){n.refresh(),delete n.B8t},200))},m=0;m<i.length;m++)e()},l)),v=!1,m=0;m<d.length;m++)if((p=d[m]).source===o.source&&p.node===f&&p.row===o.row&&p.col===o.col){v=!0;break}v||d.push({source:o.source,node:f,row:o.row,col:o.col})}return i&&o.endCalcCell(),f},A.prototype.getNode=function(){return this.currentNode},A.prototype.endCalcFunction=function(){this.currentNode.SCe&&0===this.currentNode.R1t.length&&(this.currentNode.yL=!0),this.x8t.pop(),this.N8t--,this.currentNode=this.currentNode.parent},A.prototype.endCalcCell=function(){var e=this;e.N8t=-1,e.x8t=[]},A.prototype.clearCell=function(e,t){var n,r,i,o,r,r,i,a,a,u,s,f,c,h,l,n=this;if(n.k8t&&(r=e.getName(),i=t.row,o=t.col,n.source=e,(r=n.b8t[r])&&(r=r[i])&&(i=r[o])&&((a=(a=i[0])&&a.y8t)&&(delete a.Z_t,delete a.p8t),i.forEach(function(e){e.yL=!1,e.I8t=!0,delete e.Y6}),r[o]=B,n.k8t--),"object"==typeof window))for(s in u=n.intervals)if(f=u[s]){for(c=[],h=0;h<f.length;h++)(l=f[h]).source===e&&l.row===t.row&&l.col===t.col||c.push(l);c.length?c.length!==f.length&&(c.intervalObj=f.intervalObj,u[s]=c):(u[s]=B,window.clearInterval(f.intervalObj))}},A.prototype.setAsyncResult=function(e,t){e.Y6=t},A.prototype.addRows=function(e,t,n){this.z8t(e,t,n,!0)},A.prototype.deleteRows=function(e,t,n){this.z8t(e,t,n,!1)},A.prototype.z8t=function(e,t,n,r){var i,o,a,u,s,f,c,h,l,d,m,v,p,b,i=this;if(i.k8t){if(o=e.getName(),a=i.b8t[o]){for(s in u={},a)(f=a[s])&&(c=parseInt(s,10),r?u[h=t<=c?c+n:c]=f:c<t?u[c]=f:t+n<=c&&(u[c-n]=f));i.b8t[o]=u}for(d in l=i.intervals)if(m=l[d]){for(v=[],p=0;p<m.length;p++)(b=m[p]).source===e&&r&&b.row>=t?b.row+=n:b.source===e&&!r&&(b.row<t||b.row>=t+n)&&(b.row=b.row<t?b.row:b.row-n,v.push(b));r||v.length===m.length||(v.intervalObj=m.intervalObj,l[d]=v)}}},A.prototype.addColumns=function(e,t,n){this.V8t(e,t,n,!0)},A.prototype.deleteColumns=function(e,t,n){this.V8t(e,t,n,!1)},A.prototype.V8t=function(e,t,n,r){var i,o,a,u,s,f,c,h,l,d,m,v,p,b,T,y,i=this;if(i.k8t){if(o=e.getName(),a=i.b8t[o])for(u in a)if(s=a[u]){for(c in f={},s)(h=s[c])&&h.length&&(l=parseInt(c,10),r?f[d=t<=l?l+n:l]=h:l<t?f[l]=h:t+n<=l&&(f[l-n]=h));a[u]=f}for(v in m=i.intervals)if(p=m[v]){for(b=[],T=0;T<p.length;T++)(y=p[T]).source===e&&r&&y.col>=t?y.col+=n:y.source===e&&!r&&(y.col<t||y.col>=t+n)&&(y.col=y.col<t?y.col:y.col-n,b.push(y));r||b.length===p.length||(b.intervalObj=p.intervalObj,m[v]=b)}}},A.prototype.changeSourceName=function(e,t){var n,r,n=this;n.k8t&&(r=n.b8t[e])&&(n.b8t[t]=r,delete n.b8t[e])},A.prototype.clearNodesByName=function(e){var t=this;t.k8t&&t.b8t&&(t.b8t[e]=void 0)},H=A,e.evaluateOperator=w,G=M.Convert.uJ,q=M.Convert.z6t,j=M.Convert.j,V=M.Convert.kDt,K=M.Convert.U6t},"./src/map.ts":function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMap=void 0;var n=(r.prototype.has=function(e){return!!this.Y8t[this.Z8t(e)]},r.prototype.get=function(e){var e=this.Y8t[this.Z8t(e)];return e&&e.value},r.prototype.delete=function(e){var e,t,n,r,e=this.Z8t(e),t=this.Y8t[e];if(!t)return!1;if(this.size--,this.size){if(n=void 0,t!==this.W8t)for(n=this.W8t;n&&n.next!==t;)n=n.next;r=t.next,n?n.next=r:this.W8t=r,r&&(r.prev=n)}else this.W8t=null;return delete this.Y8t[e],delete this.Q8t[e],!0},r.prototype.set=function(e,t){var n,r,n,n=this.Y8t,r=this.Z8t(e);return n[r]?n[r].value=t:(this.size++,n=n[r]={key:e,keyStamp:r,value:t,next:this.W8t},this.W8t=n),this},r.prototype.clear=function(){var e,t,e=this.Y8t;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&delete e[t];this.Q8t={},this.W8t=null,this.size=0},r.prototype.forEach=function(e,t){for(var n=this.W8t;n;)for(e.call(t,n.value,n.key,this);(n=n.next)&&!this.Y8t[n.keyStamp];);},r.prototype.toString=function(){return"[object Map]"},r.prototype.Z8t=function(e){switch(typeof e){case"undefined":return"undefined";case"object":if(null===e)return"null";break;case"boolean":return"?"+e;case"number":return"+"+e;case"string":return","+e}return""},r);function r(e){if(this.Y8t=Object.create(null),this.Q8t={},this.W8t=null,this.size=0,e)for(var t=0,n=e.length;t<n;t++)this.set(e[t][0],e[t][1])}function i(){return new(Map&&-1!==Map.toString().indexOf("[native code]")&&new Map([[1,1]]).size?Map:n)}t.createMap=i},"./src/referenceExpression.ts":function(e,t,n){var r,i,b,o,n,T,s,y,g,a,u;function f(e){return u.call(this,e)||this}function c(e,t,n,r,i,o){var a=new g(1);return a.row=n,a.column=r,a.rowRelative=i,a.columnRelative=o,e&&(a.source=e),t&&(a.endSource=t),a}function h(e,t,n,r,i,o,a,u,s,f,c,h){var l,d,m,v,p,h,l=new g(1);return c=c||0,h=h||0,T(i)||(i=s?y(i+c,b.MAX_ROW_COUNT-1)-c:y(i,b.MAX_ROW_COUNT-1)),T(o)||(o=f?y(o+h,b.MAX_COLUMN_COUNT-1)-h:y(o,b.MAX_COLUMN_COUNT-1)),0===(u?r+h:r)&&(f?o+h:o)===b.MAX_COLUMN_COUNT-1&&(r=o=b.BAND_INDEX_CONST),l.isFullRow=r===b.BAND_INDEX_CONST,m=n-(a?0:c),v=r-(u?0:h),p=i-(s?0:c),h=o-(f?0:h),0===(a?n+c:n)&&(s?i+c:i)===b.MAX_ROW_COUNT-1&&(n=i=b.BAND_INDEX_CONST),l.isFullColumn=n===b.BAND_INDEX_CONST,p<m&&(d=n,n=i,i=d,d=a,a=s,s=d),h<v&&(d=r,r=o,o=d,d=u,u=f,f=d),l.row=n,l.column=r,l.endRow=i,l.endColumn=o,l.rowRelative=a,l.columnRelative=u,l.endRowRelative=s,l.endColumnRelative=f,l.isFullColumn&&l.isFullRow&&(l.rowRelative=!1,l.endRowRelative=!1),e&&(l.source=e),t&&(l.endSource=t),l}function l(e,t,n){var r={row:-1,col:-1,rowCount:-1,colCount:-1},i,o,a,u;return e.isFullRow?(r.col=-1,r.colCount=-1):(a=e.columnRelative?(a=e.column+n)>=b.MAX_COLUMN_COUNT?a%b.MAX_COLUMN_COUNT:a:e.column,e.hmt()?(r.col=a,r.colCount=1):(u=e.endColumnRelative?(u=e.endColumn+n)>=b.MAX_COLUMN_COUNT?u%b.MAX_COLUMN_COUNT:u:e.endColumn,r.col=a<=u?a:u,r.colCount=s(u-a)+1)),e.isFullColumn?(r.row=-1,r.rowCount=-1):(i=e.rowRelative?(i=e.row+t)>=b.MAX_ROW_COUNT?i%b.MAX_ROW_COUNT:i:e.row,e.hmt()?(r.row=i,r.rowCount=1):(o=e.endRowRelative?(o=e.endRow+t)>=b.MAX_ROW_COUNT?o%b.MAX_ROW_COUNT:o:e.endRow,r.row=i<=o?i:o,r.rowCount=s(o-i)+1)),r}r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeForReference=t.lJ=t.knt=t.ReferenceExpression=void 0,i=n("Common"),b=n("./src/calc.common.ts"),o=void 0,n=i.Common.lt,T=n.ht,s=Math.abs,y=Math.min,u=b.Expression,r(f,u),f.prototype.hmt=function(){var e=this;return e.endRow===o||e.endColumn===o},f.prototype.Tyt=function(){var e=this;return e.isFullRow&&e.isFullColumn?3:e.isFullRow?1:e.isFullColumn?2:0},f.prototype.getRange=function(e,t){return l(this,e,t)},f.prototype.offset=function(e,t,n,r,i){var o,a,u,a,o=this,a=o.source,u=o.endSource;return o.hmt()?c(a,u,o.row+(o.rowRelative||n?e:0),o.column+(o.columnRelative||n?t:0),o.rowRelative,o.columnRelative):((a=h(a,u,o.row+(o.rowRelative||n?e:0),o.column+(o.columnRelative||n?t:0),o.endRow+(o.isFullColumn||!o.endRowRelative&&!n?0:e),o.endColumn+(o.isFullRow||!o.endColumnRelative&&!n?0:t),o.rowRelative,o.columnRelative,o.endRowRelative,o.endColumnRelative,r,i)).isFullRow=o.isFullRow,a.isFullColumn=o.isFullColumn,a)},f.prototype.offset2=function(e,t,n,r,i,o){var a,u,s,a=this,u;return(a.endRowRelative?a.endRow+i:a.endRow)>=b.MAX_ROW_COUNT-1&&(n=0),(s=a.endColumnRelative?a.endColumn+o:a.endColumn)>=b.MAX_COLUMN_COUNT-1&&(r=0),h(a.source,a.endSource,a.row+(a.isFullColumn?0:e),a.column+(a.isFullRow?0:t),a.endRow+(a.isFullColumn?0:n),a.endColumn+(a.isFullRow?0:r),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,i,o)},g=f,t.ReferenceExpression=g,t.knt=c,t.lJ=h,t.getRangeForReference=l},"./src/set.ts":function(e,t){function n(){this.items=[]}function r(){return new(Set&&-1!==Set.toString().indexOf("[native code]")&&new Set([[1,1]]).size?Set:n)}Object.defineProperty(t,"__esModule",{value:!0}),t.createSet=void 0,n.prototype.add=function(e){this.has(e)||this.items.push(e)},n.prototype.delete=function(e){var e=this.items.indexOf(e);-1!==e&&this.items.splice(e,1)},n.prototype.has=function(e){return-1!==this.items.indexOf(e)},n.prototype.clear=function(){this.items=[]},n.prototype.size=function(){return this.items.length},n.prototype.values=function(){return this.items},t.createSet=r},"./src/text_Filter/charProcess.ts":function(e,t){var n,r,i;function o(){this.otherChar=0,this.control=1,this.numeric=2,this.mathSymbol=3,this.symbol=4,this.punctuation=5,this.space=6,this.upperCase=7,this.lowerCase=8,this.katakana=9,this.hiragana=10,this.farEastPunctuation=11,this.hangul=12,this.fullWidth=32768}function a(){this.minValue="\0",this.maxValue="\uffff",this.ANSI_START=0,this.ANSI_END=255,this.BOTH_WIDTH_START=65280,this.BOTH_WIDTH_END=65519,this.FULL_ALPHA_START=65281,this.FULL_UPPER_START=65313,this.FULL_UPPER_END=65338,this.FULL_ALPHA_END=65374,this.CJK_HALF_SYMBOL_START=65377,this.CJK_HALF_SYMBOL_END=65380,this.KANA_HALF_START=65381,this.KANA_HALF_END=65439,this.HANGUL_HALF_START=65440,this.HANGUL_HALF_END=65500,this.FULL_SYMBOL_START=65504,this.FULL_SYMBOL_END=65510,this.HALF_VARIANTS_START=65512,this.HALF_VARIANTS_END=65518,this.KATAKANA_VOICED="\uff9e",this.KATAKANA_SEMI_VOICED="\uff9f",this.tab="\t",this.space=" ",this.K8t=new Array("\0","\x80","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"),this.blocks=new Array("BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"),this.J8t=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"],this.X8t=new n,this.q8t=[this.X8t.symbol|this.X8t.fullWidth,this.X8t.numeric|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.upperCase|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.lowerCase|this.X8t.fullWidth,this.X8t.symbol|this.X8t.fullWidth,this.X8t.farEastPunctuation,this.X8t.katakana,this.X8t.hangul,this.X8t.symbol|this.X8t.fullWidth,this.X8t.symbol],this.$8t=new Array("\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"),this.tEt=new Array("\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"),this.nEt=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"],this.eEt=new Array(0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0),this.iEt=["\u2018","\u2019","\u201c","\u201d"],this.rEt=["\u30fc"],this.oEt=new Array("\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"),this.aEt=new Array(" ","\uff64","\uff61","\uff62","\uff63",'"','"',"'","'","\uff9e","\uff9f","\xa5")}function u(){this.charCategory=new r,this.charType=new n}Object.defineProperty(t,"__esModule",{value:!0}),t.uEt=t.sEt=t.CharType=void 0,n=o,t.CharType=n,r=a,t.sEt=r,u.prototype.isAlphabet=function(e){var t=this;return t.isUpper(e)||t.isLower(e)},u.prototype.isHiragana=function(e){var t=this;return(t.getCharType(e)&~t.charType.fullWidth)===t.charType.hiragana||t.charCategory.rEt[0]===e},u.prototype.getCharType=function(e){var t,n,r,t=this,n=t.charType.otherChar,r=t.belongTo(e);if("\x7f"===e||"\0"<=e&&e<="\x1f"||"\x80"<=e&&e<="\x9f")return t.charType.control;if("A"<=e&&e<="Z")return t.charType.upperCase;if("a"<=e&&e<="z")return t.charType.lowerCase;if("0"<=e&&e<="9")return t.charType.numeric;switch((t.isFullWidthSymbol(e)||t.isHalfWidthSymbol(e))&&(n=t.charType.symbol),8216!==e.charCodeAt(0)&&8217!==e.charCodeAt(0)&&8220!==e.charCodeAt(0)&&8221!==e.charCodeAt(0)||(n=t.charType.punctuation),12288===e.charCodeAt(0)&&(n=t.charType.space),t.charCategory.blocks[r]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return t.multiWidthDetails(e);case"KATAKANA":return t.charType.katakana|t.charType.fullWidth;case"HIRAGANA":return t.charType.hiragana|t.charType.fullWidth}return t.isFarEastBlock(r,e)&&(n|=t.charType.fullWidth),n},u.prototype.isLower=function(e){var t=this;return(t.getCharType(e)&~t.charType.fullWidth)===t.charType.lowerCase},u.prototype.isUpper=function(e){var t=this;return(t.getCharType(e)&~t.charType.fullWidth)===t.charType.upperCase},u.prototype.belongTo=function(e){for(var t,n,r,i,t=this,n=0,r=83,i=r>>1;1<r-n;)e>=t.charCategory.K8t[i]?n=i:r=i,i=r+n>>1;return i},u.prototype.isFullWidthSymbol=function(e){for(var t=0;t<u.fullWidthSymbolArray.length;t++)if(e===u.fullWidthSymbolArray[t])return!0;return!1},u.prototype.isHalfWidthSymbol=function(e){for(var t=0;t<u.halfWidthSymbolArray.length;t++)if(e===u.halfWidthSymbolArray[t])return!0;return!1},u.prototype.multiWidthDetails=function(e){for(var t,n,r,i,t=this,n=0,r=t.charCategory.J8t.length,i=r>>1;1<r-n;)e>=t.charCategory.J8t[i]?n=i:r=i,i=r+n>>1;return t.charCategory.q8t[i]},u.prototype.isFarEastBlock=function(e,t){var n,r,n=this;switch(n.charCategory.blocks[e]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(r=0;r<n.charCategory.iEt.length;r++)if(t===n.charCategory.iEt[r])return!0;if(255<t.charCodeAt(0))return!0;if(8216===t.charCodeAt(0)||8217===t.charCodeAt(0)||8220===t.charCodeAt(0)||8221===t.charCodeAt(0))return!0}return!1},u.prototype.isFullWidth=function(e){var t,n,r,t=this;return!!t.isFullWidthSymbol(e)||!t.isHalfWidthSymbol(e)&&(n=t.belongTo(e),r=t.isFarEastBlock(n,e),"HALFWIDTH_AND_FULLWIDTH_FORMS"===t.charCategory.blocks[n]?(t.multiWidthDetails(e)&t.charType.fullWidth)===t.charType.fullWidth:r)},u.prototype.toHalfWidth=function(e){return this.toHalfWidthEx(e)},u.prototype.toHalfWidthEx=function(e){var t,n,r,i,o,i,i,t=this,n=t.getCharType(e),r=t.isMultiWidth(e);if((n&t.charType.fullWidth)===t.charType.fullWidth)switch(n&~t.charType.fullWidth){case t.charType.punctuation:case t.charType.upperCase:case t.charType.lowerCase:case t.charType.symbol:case t.charType.numeric:case t.charType.mathSymbol:!1!==(i=t.getFullHalfWidthSpecialChar(e,!1))?e=i:r&&(o="!",e=String.fromCharCode(e.charCodeAt(0)-(t.charCategory.K8t[81].charCodeAt(0)+1)+"!".charCodeAt(0)));break;case t.charType.katakana:if((i=e.charCodeAt(0)-(t.charCategory.K8t[62].charCodeAt(0)+1))<0||91<i)return e;if(e=t.charCategory.tEt[i],0<(i=t.charCategory.eEt[i]))return e+=String.fromCharCode((1===i?t.charCategory.KATAKANA_VOICED:t.charCategory.KATAKANA_SEMI_VOICED).charCodeAt(0));break;case t.charType.space:e=" ";break;case t.charType.hangul:}return e},u.prototype.isMultiWidth=function(e){var t,n,t,t=this,n=t.belongTo(e),t=t.charCategory.blocks[n];return"KATAKANA"===t||"CJK_SYMBOLS_AND_PUNCTUATION"===t||"HALFWIDTH_AND_FULLWIDTH_FORMS"===t||"BASIC_LATIN"===t&&" "<=e},u.prototype.getFullHalfWidthSpecialChar=function(e,t){for(var n,t,r,i,o,r=this,t=!0===t?(n=r.charCategory.aEt,r.charCategory.oEt):(n=r.charCategory.oEt,r.charCategory.aEt),i=-1,o=0;o<n.length;){if(n[o]===e){i=o;break}o++}return-1!==i&&o<t.length&&t[o]},u.prototype.toFullWidth=function(e){var t,n,r,i,o,o,e,t={},n=this;if(t.text=e,t.processedAll=!1,0!==e.length){if(r=e.substring(0,1),n.isMultiWidth(r)){if(r<n.charCategory.K8t[1])return" "===r?t.text="\u3000":(i="!",t.text=String.fromCharCode(r.charCodeAt(0)-"!".charCodeAt(0)+(n.charCategory.K8t[81].charCodeAt(0)+1))),t;if((n.multiWidthDetails(r)&n.charType.katakana)===n.charType.katakana){if(r.charCodeAt(0)<n.charCategory.KANA_HALF_START)return o=n.getFullHalfWidthSpecialChar(r,!0),t.text=!1!==o?o:r,t;if(r=n.charCategory.$8t[r.charCodeAt(0)-n.charCategory.KANA_HALF_START],e.length<2)return t.text=r,t;1!=(o=e.charCodeAt(1)-(n.charCategory.KATAKANA_VOICED.charCodeAt(0)-1))&&2!=o||(t.processedAll=!0,0!==(e=n.charCategory.eEt[r.charCodeAt(0)-(n.charCategory.K8t[62].charCodeAt(0)+1)])&&((2&Math.abs(e))==o&&(r=String.fromCharCode(r.charCodeAt(0)+1)),r=String.fromCharCode(r.charCodeAt(0)+1))),1==o&&"\u30a6"===r&&(r="\u30f4")}}t.text=r}return t},u.prototype.isUpperKana=function(e){return!this.isLowerKana(e)},u.prototype.isLowerKana=function(e){return-1!==u.lowerKana.search(e)},u.prototype.hasLowerKana=function(e){return-1!==u.upperKana.search(e)||this.isLowerKana(e)},u.prototype.toUpperKana=function(e){var t=u.lowerKana.search(e);return-1===t?e:u.upperKana.substr(t,1)},u.prototype.toLowerKana=function(e){var t=u.upperKana.search(e);return t>=u.upperKana.length-4&&t<u.upperKana.length||-1===t?e:u.lowerKana.substr(t,1)},u.prototype.toKatakana=function(e){var t,n,t=this;return t.isCharOfType(e,t.charType.hiragana|t.charType.fullWidth)?!1!==(n=t.getFullHalfWidthSpecialChar(e,!1))?n:String.fromCharCode(e.charCodeAt(0)-t.charCategory.K8t[61].charCodeAt(0)+t.charCategory.K8t[62].charCodeAt(0)):e},u.prototype.isCharOfType=function(e,t){return this.getCharType(e)===t},u.prototype.isKatakana=function(e){var t=this;return(t.getCharType(e)&~t.charType.fullWidth)===t.charType.katakana},u.prototype.toHiragana=function(e){var t=this;return!t.isKatakana(e)||(t.isFullWidth(e)||(e=t.toFullWidth(e).text),!t.isCharOfType(e,t.charType.katakana|t.charType.fullWidth))||"\u30f7"<=e&&e<="\u30ff"?e:"\u30f5"===e?"\u304b":"\u30f6"===e?"\u3051":String.fromCharCode(e.charCodeAt(0)+t.charCategory.K8t[61].charCodeAt(0)-t.charCategory.K8t[62].charCodeAt(0))},u.prototype.isDigit=function(e){var t=this;return(t.getCharType(e)&~t.charType.fullWidth)===t.charType.numeric},u.prototype.isSurrogate=function(e){return null!==e&&e.charCodeAt(0)>="\ud800".charCodeAt(0)&&e.charCodeAt(0)<="\udfff".charCodeAt(0)},u.lowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30f5\u30f6\u3095\u3096",u.upperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30ab\u30b1\u304b\u3051",u.fullWidthSymbolArray=new Array("\u3001","\u3002","\uff0c","\uff0e","\u30fb","\uff1a","\uff1b","\uff1f","\uff01","\u309b","\u309c","\xb4","\uff40","\xa8","\uff3e","\uffe3","\uff3f","\u30fd","\u30fe","\u309d","\u309e","\u3003","\u4edd","\u3005","\u3006","\u3007","\u30fc","\u2014","\u2010","\uff0f","\u301c","\u2016","\uff5c","\u2026","\u2025","\u2018","\u2019","\u201c","\u201d","\uff08","\uff09","\u3014","\u3015","\uff3b","\uff3d","\uff5b","\uff5d","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff0b","\u2212","\xb1","\xd7","\xf7","\uff1d","\u2260","\uff1c","\uff1e","\u2266","\u2267","\u221e","\u2234","\u2642","\u2640","\xb0","\u2032","\u2033","\u2103","\uffe5","\uff04","\xa2","\xa3","\uff05","\uff03","\uff06","\uff0a","\uff20","\xa7","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u203b","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uff07","\uff02","\uff0d","\u3033","\u3034","\u3035","\u303b","\u303c","\u30ff","\u309f","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2284","\u2285","\u228a","\u228b","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\xac","\u21d2","\u21d4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212b","\u2030","\u266f","\u266d","\u266a","\u2020","\u2021","\xb6","\u266e","\u266b","\u266c","\u2669","\u25ef","\uff3c","\uff5e","\uffe0","\uffe1","\uffe2","\u2015"),u.halfWidthSymbolArray=new Array("\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","\uff61","\uff62","\uff63","\uff64","\uff65","\xa1","\xa4","\xa5"),t.uEt=u},"./src/text_Filter/emoji_helper.ts":function(e,t,n){var r,i;function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.cEt=void 0,r=n("./src/calc.common.ts"),o.isEmoji=function(e,t,n){n.emojiCharLength=0;try{if(o.isEmojiEnclosedAlphanumericSymbol(e,t))return n.emojiCharLength=2,!0;if(o.isEmojiInSpecificRange(e,t)||o.isEmojiInUnicodeStandardSymbol(e,t))return o.isHighSurrogate(e,t)?n.emojiCharLength=2:n.emojiCharLength=1,!0}catch(e){}return!1},o.isEmojiEnclosedAlphanumericSymbol=function(e,t){return!(t>=e.length-1||o.isHighSurrogate(e,t)||!o.contains(o.fEt,o.convertToUtf32(e,t))||o.lEt!==o.convertToUtf32(e,t+1))},o.isEmojiInSpecificRange=function(e,t){for(var n,r,i,n=o.convertToUtf32(e,t),r=Math.floor(o.hEt.length/2),i=0;i<r;i++)if(o.hEt[2*i]<=n&&n<=o.hEt[2*i+1])return!0;return!1},o.isEmojiInUnicodeStandardSymbol=function(e,t){var e=o.convertToUtf32(e,t);return o.contains(o.dEt,e)},o.contains=function(e,t){for(var n,r,i,n=0,r=e.length-1;n<=r;){if(e[i=Math.floor((n+r)/2)]===t)return!0;e[i]>t?r=i-1:n=i+1}return!1},o.convertFromUtf32=function(e){if(e<0||1114111<e||55296<=e&&e<=57343)throw new Error((0,r.sR)().Exp_ArgumentOutOfRangeException);return e<65536?String.fromCharCode(e):(e-=65536,String.fromCharCode(Math.floor(e/1024)+55296,e%1024+56320))},o.convertToUtf32=function(e,t){var n,e;if(t<0||t>=e.length)throw new Error((0,r.sR)().Exp_ArgumentOutOfRangeException);if((n=e.charCodeAt(t)-55296)<0||2047<n)return e.charCodeAt(t);if(1023<n)throw new Error((0,r.sR)().Exp_ArgumentException);if(t>=e.length-1)throw new Error((0,r.sR)().Exp_ArgumentException);if((e=e.charCodeAt(t+1)-56320)<0||1023<e)throw new Error((0,r.sR)().Exp_ArgumentException);return 1024*n+e+65536},o.isHighSurrogate=function(e,t){var e=e.charCodeAt(t);return 55296<=e&&e<=56319},o.isLowSurrogate=function(e,t){var e=e.charCodeAt(t);return 56320<=e&&e<=57343},o.lEt=8419,o.fEt=[35,48,49,50,51,52,53,54,55,56,57],o.hEt=[9728,9983,9984,10175,10240,10495,11008,11263,19904,19967,65936,65999,118784,119039,119040,119295,119296,119375,119552,119647,126976,127023,127024,127135,127136,127231,127232,127487,127488,127743,127744,128511,128512,128591,128640,128767,128768,128895],o.dEt=[169,174,8194,8195,8197,8252,8265,8482,8505,8596,8597,8598,8599,8600,8601,8617,8618,8986,8987,9193,9194,9195,9196,9200,9203,9410,9642,9643,9654,9664,9723,9724,9725,9726,10548,10549,12336,12349,12951,12953],t.cEt=o},"./src/text_Filter/text_Filter.ts":function(e,t,n){var i,o,a,u,s,r,n;function f(e,t,n){void 0===n&&(n=!0);var r=this;r.format=t,r.includeFormat="",r.excludeFormat="",r.includeNormalChar="",r.excludeNormalChar="",r.allowTypes=u.All,r.excludeTypes=u.All,r.include=!0,r.autoConvert=e,r.charExInstance=new i.uEt,r.keepInvalidChar=n,r.parseFormat(r.format)}Object.defineProperty(t,"__esModule",{value:!0}),t._9t=t.CharacterType=void 0,i=n("./src/text_Filter/charProcess.ts"),o=n("./src/text_Filter/emoji_helper.ts"),a=n("./src/calc.common.ts"),(n=u=t.CharacterType||(t.CharacterType={}))[n.DBCS_UpperAlphabet=2147483650]="DBCS_UpperAlphabet",n[n.SBCS_UpperAlphabet=1073741825]="SBCS_UpperAlphabet",n[n.DBCS_LowerAlphabet=2147483656]="DBCS_LowerAlphabet",n[n.SBCS_LowerAlphabet=1073741828]="SBCS_LowerAlphabet",n[n.DBCS_Number=2147483680]="DBCS_Number",n[n.SBCS_Number=1073741840]="SBCS_Number",n[n.DBCS_Binary=2147483776]="DBCS_Binary",n[n.SBCS_Binary=1073741888]="SBCS_Binary",n[n.DBCS_Hexadecimal=2147484160]="DBCS_Hexadecimal",n[n.SBCS_Hexadecimal=1073742080]="SBCS_Hexadecimal",n[n.DBCS_Symbol=2147485696]="DBCS_Symbol",n[n.SBCS_Symbol=1073742848]="SBCS_Symbol",n[n.DBCS_NumberSymbol=2147491840]="DBCS_NumberSymbol",n[n.SBCS_NumberSymbol=1073745920]="SBCS_NumberSymbol",n[n.DBCS_Katakana=2147516416]="DBCS_Katakana",n[n.SBCS_Katakana=1073758208]="SBCS_Katakana",n[n.DBCS_Space=2147614720]="DBCS_Space",n[n.SBCS_Space=1073807360]="SBCS_Space",n[n.TwoBytes=2148007936]="TwoBytes",n[n.FourBytes=2147745792]="FourBytes",n[n.DBCS_ShiftJIS=2148532224]="DBCS_ShiftJIS",n[n.DBCS_JISX0208=2149580800]="DBCS_JISX0208",n[n.Emoji=4194304]="Emoji",n[n.IVS=8388608]="IVS",n[n.DBCS_Hiragana=2164260864]="DBCS_Hiragana",n[n.Upper_SBCS_Katakana=1207959552]="Upper_SBCS_Katakana",n[n.Upper_DBCS_Katakana=2415919104]="Upper_DBCS_Katakana",n[n.Upper_DBCS_Hiragana=2684354560]="Upper_DBCS_Hiragana",n[n.All=3321888768]="All",n[n.DBCS_All=2214592512]="DBCS_All",n[n.SBCS_All=1107296256]="SBCS_All",n[n.DBCS=2147483648]="DBCS",n[n.SBCS=1073741824]="SBCS",s={"\uff21":u.DBCS_UpperAlphabet,A:u.SBCS_UpperAlphabet,"\uff41":u.DBCS_LowerAlphabet,a:u.SBCS_LowerAlphabet,"\uff2b":u.DBCS_Katakana,K:u.SBCS_Katakana,"\uff19":u.DBCS_Number,9:u.SBCS_Number,"\uff03":u.DBCS_NumberSymbol,"#":u.SBCS_NumberSymbol,"\uff20":u.DBCS_Symbol,"@":u.SBCS_Symbol,"\uff22":u.DBCS_Binary,B:u.SBCS_Binary,"\uff38":u.DBCS_Hexadecimal,X:u.SBCS_Hexadecimal,"\uff2a":u.DBCS_Hiragana,"\uff3a":u.DBCS_All,"\uff2d":u.DBCS_ShiftJIS,"\uff29":u.DBCS_JISX0208,H:u.SBCS_All,N:u.Upper_SBCS_Katakana,"\uff2e":u.Upper_DBCS_Katakana,"\uff27":u.Upper_DBCS_Hiragana,"\uff33":u.DBCS_Space,S:u.SBCS_Space,"\uff34":u.FourBytes,"\uff24":u.TwoBytes,"\uff25":u.IVS},f.prototype.parseFormat=function(e){var t=this;t.includeFormat=t.getIncludeFormat(e),t.excludeFormat=t.getExcludeFormat(e),t.parseIncludeFormat(t.includeFormat),t.parseExcludeFormat(t.excludeFormat)},f.prototype.getIncludeFormat=function(e){var t,n,r;if(null===e||0===e.length)return"";for(t="",n=0;n<e.length;n++)if("\\"===(r=e.substring(n,n+1))){if(n===e.length-1)throw(0,a.sR)().Exp_FormulaInvalid;t=t+r+e.substring(n+1,n+2),n++}else{if("^"===r)return t;t+=r}return t},f.prototype.getExcludeFormat=function(e){var t,n,r,i;if(null===e||0===e.length)return"";for(n="",r=t=0;r<e.length;r++)if("\\"===(i=e.substring(r,r+1))){if(r===e.length-1)throw(0,a.sR)().Exp_FormulaInvalid;0!==t&&(n=n+i+e.substring(r+1,r+2)),r++}else if("^"===i){if(1<++t)throw(0,a.sR)().Exp_DuplicatedChar}else 0!==t&&(n+=i);return n=1===t?"^"+n:n},f.prototype.parseIncludeFormat=function(e){var t,n,r,r,t=this;if(null===e||0===e.length)t.allowTypes=u.All,t.includeNormalChar="",t.includeFormat="";else for(t.allowTypes=0,t.includeNormalChar="",n=0;n<e.length;n++)switch(e.charCodeAt(n)){case 94:break;case 92:if(n===e.length-1)throw(0,a.sR)().Exp_FormulaInvalid;t.includeNormalChar=t.includeNormalChar+e.substring(n+1,n+2),n++;break;default:r=e[n],(r=s[r])?t.allowTypes|=r:t.includeNormalChar=t.includeNormalChar+e.substring(n,n+1)}},f.prototype.parseExcludeFormat=function(e){var t,n,r,r,t=this;if(null===e||0===e.length)t.excludeTypes=u.All,t.excludeNormalChar="",t.excludeFormat="";else if("^"===e)t.excludeTypes=u.All,t.excludeNormalChar="",t.excludeFormat="^";else for(t.excludeTypes=0,t.excludeNormalChar="",n=0;n<e.length;n++)switch(e.charCodeAt(n)){case 94:0===n&&(t.include=!1);break;case 92:if(n===e.length-1)throw(0,a.sR)().Exp_FormulaInvalid;t.excludeNormalChar=t.excludeNormalChar+e.substring(n+1,n+2),n++;break;default:r=e[n],(r=s[r])?t.excludeTypes|=r:t.excludeNormalChar=t.excludeNormalChar+e.substring(n,n+1)}},f.prototype.checkText=function(e){for(var t,n,r,i,o,a,t=this,n=e.length,r={IsInputValid:!0,CheckedText:""},i=0;i<n;)"\t"!==(o=e.substring(i,i+1))&&"\r"!==o&&"\n"!==o?(a=t.check(e,i),t.isNullOrUndefined(a.index)?(o=a,i++):(i=a.index,o=a.strValue),""===o&&(r.IsInputValid=!1)):i++,r.CheckedText+=o;return r},f.prototype.check=function(e,t){var n,r,i,n=this,r=null!==t?e.substring(t,t+1):e,i;return n.IsValid(r)?r:n.autoConvert?null!==t?n.Convert(e,t):n.Convert(r):""},f.prototype.IsValid=function(e){var t=this;return(""===t.excludeFormat||!t.IsValidProcess(e,t.excludeTypes,t.excludeNormalChar))&&(""===t.includeFormat||t.IsIncludeValid(e))},f.prototype.Convert=function(e,t){var n,r,i,o,a,u,s,s,f,f,c,n=this,r=null===t?e:e.substring(t,t+1),i=!1;if(n.charExInstance.isAlphabet(r))return o=n.charExInstance.isLower(r)?r.toUpperCase():r.toLowerCase(),(i=n.IsValid(o))?o:(r=n.charExInstance.isFullWidth(r)?n.charExInstance.toHalfWidth(r):n.charExInstance.toFullWidth(r).text,(i=n.IsValid(r))?r:(o=n.charExInstance.isFullWidth(o)?n.charExInstance.toHalfWidth(o):n.charExInstance.toFullWidth(o).text,(i=n.IsValid(o))?o:n.keepInvalidChar?r:""));if(n.charExInstance.isHiragana(r)){if(n.charExInstance.isLowerKana(r)){if(a=n.charExInstance.toUpperKana(r),i=n.IsValid(a))return a}else if(n.charExInstance.hasLowerKana(r)&&(u=n.charExInstance.toLowerKana(r),i=n.IsValid(u)))return u;if(o=n.charExInstance.toKatakana(r),i=n.IsValid(o))return o;if(n.charExInstance.isLowerKana(o)){if(a=n.charExInstance.toUpperKana(o),i=n.IsValid(a))return a}else if(n.charExInstance.hasLowerKana(o)&&(u=n.charExInstance.toLowerKana(o),i=n.IsValid(u)))return u;if(s=n.charExInstance.toHalfWidthEx(o),i=n.IsValid(s))return s;if(n.charExInstance.isLowerKana(s)){if(s=n.charExInstance.toUpperKana(s),i=n.IsValid(s))return s}else if(n.charExInstance.hasLowerKana(s)&&(s=n.charExInstance.toLowerKana(s),i=n.IsValid(s)))return s;return n.keepInvalidChar?r:""}if(n.charExInstance.isKatakana(r)){if(n.charExInstance.isLowerKana(r)){if(a=n.charExInstance.toUpperKana(r),i=n.IsValid(a))return a}else if(n.charExInstance.hasLowerKana(r)&&(u=n.charExInstance.toLowerKana(r),i=n.IsValid(u)))return u;if(s=!1,o=r,n.charExInstance.isFullWidth(r)){if(0<(f=n.charExInstance.toHalfWidthEx(r)).length&&(i=n.IsValid(f)))return f;if(n.charExInstance.isLowerKana(f)){if(f=n.charExInstance.toUpperKana(f),i=n.IsValid(f))return f}else if(n.charExInstance.hasLowerKana(f)&&(f=n.charExInstance.toLowerKana(f),i=n.IsValid(f)))return f}else{if(null===t){if(o=n.charExInstance.toFullWidth(r).text,!n.charExInstance.isKatakana(o))return n.keepInvalidChar?r:"";if(i=n.IsValid(o))return o}else{if(t+1<e.length?(o=(f=n.charExInstance.toFullWidth(e.substring(t,t+2))).text,s=f.processedAll):o=n.charExInstance.toFullWidth(r).text,!n.charExInstance.isKatakana(o))return n.keepInvalidChar?r:"";if(i=n.IsValid(o))return t++,s&&t++,(c={}).index=t,c.strValue=o,c}if(n.charExInstance.isLowerKana(o)){if(a=n.charExInstance.toUpperKana(o),i=n.IsValid(a))return a}else if(n.charExInstance.hasLowerKana(o)&&(u=n.charExInstance.toLowerKana(o),i=n.IsValid(u)))return u}if(o=n.charExInstance.toHiragana(o),i=n.IsValid(o))return null!==t?(t++,s&&t++,(c={}).index=t,"\u3094"===(c.strValue=o)&&(c.strValue=s?"\u3046\u309b":""),c):"\u3094"===o?n.keepInvalidChar?r:"":o;if(n.charExInstance.isLowerKana(o)){if(a=n.charExInstance.toUpperKana(o),i=n.IsValid(a))return a}else if(n.charExInstance.hasLowerKana(o)&&(u=n.charExInstance.toLowerKana(o),i=n.IsValid(u)))return u}return r=n.charExInstance.isFullWidth(r)?n.charExInstance.toHalfWidth(r):n.charExInstance.toFullWidth(r).text,(i=n.IsValid(r))||n.keepInvalidChar?r:""},f.prototype.IsIncludeValid=function(e){var t=this;return t.IsValidProcess(e,t.allowTypes,t.includeNormalChar)},f.prototype.IsValidProcess=function(e,t,n){var r,n,i,r=this;if(-1!==n.indexOf(e))return!0;if("\t"===e||"\r"===e||"\n"===e)return!0;if(0===t)return!1;if(n=!1,t===u.All||(t&u.Emoji)==(0|u.Emoji)&&o.cEt.isEmoji(e,0,{})||(t&u.FourBytes)==(0|u.FourBytes)&&r.IsFourBytes(e))return!0;if(1===e.length&&1<e.length)return!1;if(r.charExInstance.isFullWidth(e)){if((t&u.DBCS)!=(0|u.DBCS))return!1;(t&u.DBCS_All)==(0|u.DBCS_All)&&"\u3000"!==e||(t&u.DBCS_LowerAlphabet)==(0|u.DBCS_LowerAlphabet)&&r.IsLower(e)||(t&u.DBCS_UpperAlphabet)==(0|u.DBCS_UpperAlphabet)&&r.IsUpper(e)||(t&u.DBCS_Number)==(0|u.DBCS_Number)&&r.IsNumber(e)||(t&u.DBCS_Binary)==(0|u.DBCS_Binary)&&r.IsBinary(e)||(t&u.DBCS_Hexadecimal)==(0|u.DBCS_Hexadecimal)&&r.IsHex(e)||(t&u.DBCS_Symbol)==(0|u.DBCS_Symbol)&&r.IsSymbol(e)||(t&u.DBCS_NumberSymbol)==(0|u.DBCS_NumberSymbol)&&r.IsNumberSymbol(e)||(t&u.Upper_DBCS_Katakana)==(0|u.Upper_DBCS_Katakana)&&r.IsKatakana(e)&&r.IsUpperKana(e)||(t&u.Upper_DBCS_Hiragana)==(0|u.Upper_DBCS_Hiragana)&&r.IsHiragana(e)&&r.IsUpperKana(e)||(t&u.DBCS_Space)==(0|u.DBCS_Space)&&r.IsFormatSpace(e)||(t&u.FourBytes)==(0|u.FourBytes)&&r.IsFourBytes(e)||(t&u.TwoBytes)==(0|u.TwoBytes)&&!r.IsFourBytes(e)&&"\u3000"!==e?n=!0:(t&u.DBCS_Katakana)==(0|u.DBCS_Katakana)&&r.IsKatakana(e)?n=!(i=r.IsHiragana(e))||!!r.include||(t&u.DBCS_Hiragana)==(0|u.DBCS_Hiragana):(t&u.DBCS_Hiragana)==(0|u.DBCS_Hiragana)&&r.IsHiragana(e)&&(n=!(i=r.IsKatakana(e))||!!r.include||(t&u.DBCS_Katakana)==(0|u.DBCS_Katakana))}else{if((t&u.SBCS)!==u.SBCS)return!1;((t&u.SBCS_All)===u.SBCS_All&&" "!==e||(t&u.SBCS_LowerAlphabet)===u.SBCS_LowerAlphabet&&r.IsLower(e)||(t&u.SBCS_UpperAlphabet)===u.SBCS_UpperAlphabet&&r.IsUpper(e)||(t&u.SBCS_Number)===u.SBCS_Number&&r.IsNumber(e)||(t&u.SBCS_Binary)===u.SBCS_Binary&&r.IsBinary(e)||(t&u.SBCS_Hexadecimal)===u.SBCS_Hexadecimal&&r.IsHex(e)||(t&u.SBCS_Symbol)===u.SBCS_Symbol&&r.IsSymbol(e)||(t&u.SBCS_NumberSymbol)===u.SBCS_NumberSymbol&&r.IsNumberSymbol(e)||(t&u.SBCS_Katakana)===u.SBCS_Katakana&&r.IsKatakana(e)||(t&u.Upper_SBCS_Katakana)===u.Upper_SBCS_Katakana&&r.IsKatakana(e)&&r.IsUpperKana(e)||(t&u.SBCS_Space)===u.SBCS_Space&&r.IsFormatSpace(e))&&(n=!0)}return n},f.prototype.IsUpper=function(e){return this.charExInstance.isUpper(e)},f.prototype.IsLower=function(e){return this.charExInstance.isLower(e)},f.prototype.IsNumber=function(e){return this.charExInstance.isDigit(e)},f.prototype.IsBinary=function(e){return"0"===(e=this.IsFullWidth(e)?this.ToHalfWidth(e):e)||"1"===e},f.prototype.IsHex=function(e){var t=this;return"A"===(e=t.IsFullWidth(e)?t.ToHalfWidth(e):e)||"B"===e||"C"===e||"D"===e||"E"===e||"F"===e||"a"===e||"b"===e||"c"===e||"d"===e||"e"===e||"f"===e||t.IsDigit(e)},f.prototype.IsNumberSymbol=function(e){var t=this;return e=t.IsFullWidth(e)?t.ToHalfWidth(e):e,t.IsDigit(e)||"+"===e||"-"===e||"$"===e||"%"===e||"\\"===e||","===e||"."===e},f.prototype.IsKatakana=function(e){return this.charExInstance.isKatakana(e)},f.prototype.IsHiragana=function(e){return this.charExInstance.isHiragana(e)},f.prototype.IsFullWidth=function(e){return this.charExInstance.isFullWidth(e)},f.prototype.ToHalfWidth=function(e){return this.charExInstance.toHalfWidth(e)},f.prototype.IsDigit=function(e){return this.charExInstance.isDigit(e)},f.prototype.IsFourBytes=function(e){var t,n,r,t=this.charExInstance,n=e.substring(0,1);if(2===n.length)for(r=0;r<n.length;r++)if(t.isSurrogate(n[r]))return!0;return!1},f.prototype.IsFormatSpace=function(e){return" "===e||"\u3000"===e},f.prototype.IsSymbol=function(e){var t=this;return t.charExInstance.isHalfWidthSymbol(e)||t.charExInstance.isFullWidthSymbol(e)},f.prototype.IsUpperKana=function(e){return this.charExInstance.isUpperKana(e)},f.prototype.isNullOrUndefined=function(e){return null==e},t._9t=f},Common:function(e){e.exports=o("@spreadjs/js-sheets-common")}},r={},e=i("./src/calc.entry.ts"),((a={}).Spread=a.Spread||{}).CalcEngine=e}(),e.exports=a.Spread.CalcEngine},"./node_modules_local/@spreadjs/js-calc/index.js":(e,t,n)=>{e.exports=n("./node_modules_local/@spreadjs/js-calc/dist/gc.spread.calcengine.js")},"@spreadjs/js-sheets-common":e=>{"use strict";e.exports=GC.Spread}},r={},e=i("./node_modules_local/@spreadjs/js-calc/index.js"),((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).CalcEngine=e})();
;var GC;!function(){var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t](n,n.exports,e)),n.exports}i={"./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js":function(t,n,i){var r,e,o,u;function s(t){var n,n,n=o[t];return void 0!==n||(n=o[t]={exports:{}},e[t].call(n.exports,n,n.exports,s)),n.exports}e={"./dist/src/calculation/calcSource.js":function(t,n,i){"use strict";var r,f,a,e,o,u,s;function c(){this.row=[],this.field=[]}function h(t,n){var t=s.call(this,t)||this;return t.nM=n,t.MEt={},t}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerCalcSource=n.DataManagerReference=void 0,f=i("CalcEngine"),a=i("./dist/src/dataSource/utils.js"),c.prototype.parseRowIndex=function(t,n,i){var r=n.num;return n.relative||(-1===n.num?r=t-1:r--),i*n.relative+r},c.prototype.getValueImp=function(t){var n,i,r,e,o,u,s,c,n=this.table.length();if(this.field.vEt&&this.field.vEt[this.rowString])return this.field.vEt[this.rowString];if(i=[],0===this.row.length)for(r=0;r<n;r++)i.push(this.field.getValue(r));for(e=0;e<this.row.length;e++)if(2===(o=this.row[e]).length)for(u=this.parseRowIndex(n,o[0],t),s=this.parseRowIndex(n,o[1],t),c=u;c<=s;c++)i.push(this.field.getValue(c));else if(o.type)if("key"===o.type)r=this.table.mEt(o.value),i=i.concat(this.field.getValues(r));else for(c="odd"===o.type?1:0;c<n;c+=2)i.push(this.field.getValue(c));else r=this.parseRowIndex(n,o,t),i.push(this.field.getValue(r));if(1===i.length)i=i[0];else if(0===i.length)return null;return(0,a.isArray)(i)&&(i=(0,a.isArray)(i[0])?new f.CalcArray(i):new f.CalcArray([i])),this.gEt||(this.field.vEt=this.field.vEt||{},this.field.vEt[this.rowString]=i),i},c.prototype.getValuesImp=function(t,n,i,r,e,o){var t=this.field.getValues(t,n,i,r,e,o);return(0,a.isArray)(t[0])?new f.CalcArray(t):new f.CalcArray([t])},c.prototype.getValue=function(t,n,i,r,e,o){return this.pEt(),(0,a.isArray)(t)?this.getValuesImp(t,n,i,r,e,o):this.getValueImp(t)},c.prototype.pEt=function(){this.field=this.table.rRt(this.Pq)},n.DataManagerReference=c,s=f.CalcSource,r(h,s),h.prototype.yEt=function(){return this._allFieldNames},h.prototype.wEt=function(t,n){2===arguments.length?this.MEt[t]=n:1===arguments.length&&delete this.MEt[t]},h.prototype.pe=function(t,n,i,r,e,o,u){this.DJ=t,this.ak=n,this.pwn=i,this.GOt=r,this.obe=e,this.abe=o,this.R6t=u},h.prototype.getField=function(t){var n=this.DJ,i=this.ak,r=this.pwn,e=this.obe,o=this.abe,u=this.R6t;return t.getValue(n,i,r,e,o,u)},h.prototype.getValue=function(){var t=this.GOt;return t&&"number"==typeof this.DJ?this.nM._getValueByField(t,this.DJ):null},n.DataManagerCalcSource=h},"./dist/src/calculation/functions/functions.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,a,h,l;function d(){(0,r.addScopeCustomFunctions)(),(0,e.addParentCustomFunctions)(),(0,o.addChildrenCustomFunctions)(),(0,u.addOnlyChildrenCustomFunctions)(),(0,s.addLevelCustomFunctions)(),(0,c.addLevelRowNumberCustomFunctions)(),(0,f.addQueryFunction)(),(0,a.addWindowOverFunctions)(),(0,h.addWindowFunctions)(),(0,l.addTriggerFieldValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addCustomFunctions=void 0,r=i("./dist/src/calculation/functions/scope.js"),e=i("./dist/src/calculation/functions/hierarchyParent.js"),o=i("./dist/src/calculation/functions/hierarchyChildren.js"),u=i("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),s=i("./dist/src/calculation/functions/hierarchyLevel.js"),c=i("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),f=i("./dist/src/calculation/functions/query.js"),a=i("./dist/src/calculation/functions/windowOvers/windowOvers.entry.js"),h=i("./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js"),l=i("./dist/src/calculation/functions/triggerFieldValue.js"),n.addCustomFunctions=d},"./dist/src/calculation/functions/hierarchyChildren.js":function(t,n,i){"use strict";var s,c,r,e;function o(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new r.CalcFunction(e,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,i,r){var e,o,n,u,e=[],o=t.source.nM,n=t.source.DJ;return o.CEt()&&(u=o.SEt(n),!(0,c.isNullOrUndefined)(u))&&0<i&&!(0,c.isNullOrEmpty)(r)&&((0,c.traversalTree)(u,{invoking:function(t){var n,n,n;return 0===--i?(n=t.lp,n=o._dataSource.TEt(n),n=o._getValueByField(r,n),e.push(n),{cancelDeepRecursion:!0}):0===t.children.length?{cancelDeepRecursion:!0}:void 0},invoked:function(){i++}}),t.source.DJ=n),new s.CalcArray([e])},s.Functions.defineGlobalCustomFunction(e,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addChildrenCustomFunctions=void 0,s=i("CalcEngine"),c=i("./dist/src/dataSource/utils.js"),r=i("./dist/src/calculation/functions/utils.js"),e="CHILDREN",n.addChildrenCustomFunctions=o},"./dist/src/calculation/functions/hierarchyLevel.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}(t.prototype=new o.CalcFunction(u)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,e.isNullOrUndefined)(n)))return n.level},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="LEVEL",n.addLevelCustomFunctions=s},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(t,n,i){"use strict";var r,e,o,u;function s(){function t(){}(t.prototype=new o.CalcFunction(u)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){var n,t,n,n=t.source.nM,t=t.source.DJ;if(n.CEt()&&(n=n.SEt(t),!(0,e.isNullOrUndefined)(n)))return n.getCurrentIndex()+1},r.Functions.defineGlobalCustomFunction(u,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addLevelRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="LEVELROWNUMBER",n.addLevelRowNumberCustomFunctions=s},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(t,n,i){"use strict";var u,s,r,e;function o(){function t(){this.R9t=[{J6t:5}]}(t.prototype=new r.CalcFunction(e,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n){var i,r,e,o,i=[],r=t.source.nM,e=t.source.DJ;return r.CEt()&&(o=r.SEt(e),(0,s.isNullOrUndefined)(o)||(0,s.isNullOrEmpty)(n)||((0,s.traversalTree)(o,function(t){var t,t,t;0===t.children.length&&(t=t.lp,t=r._dataSource.TEt(t),t=r._getValueByField(n,t),i.push(t))}),t.source.DJ=e)),new u.CalcArray([i])},u.Functions.defineGlobalCustomFunction(e,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addOnlyChildrenCustomFunctions=void 0,u=i("CalcEngine"),s=i("./dist/src/dataSource/utils.js"),r=i("./dist/src/calculation/functions/utils.js"),e="ONLYCHILDREN",n.addOnlyChildrenCustomFunctions=o},"./dist/src/calculation/functions/hierarchyParent.js":function(t,n,i){"use strict";var r,u,e,o;function s(){function t(){this.R9t=[{J6t:3,pkt:["< 1","> 999"]},{J6t:5}]}(t.prototype=new e.CalcFunction(o,2,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var r,e,o,o,n,o,n,r=t.source.nM,e=t.source.DJ;if(r.CEt()&&(o=r.SEt(e),!(0,u.isNullOrUndefined)(o))&&0<n&&!(0,u.isNullOrEmpty)(i)&&!(o=c(o,n)).isRoot)return n=o.lp,o=r._dataSource.TEt(n),n=r._getValueByField(i,o),t.source.DJ=e,n},r.Functions.defineGlobalCustomFunction(o,new t)}function c(t,n){return 0===n||t.isRoot?t:c(t.parent,n-1)}Object.defineProperty(n,"__esModule",{value:!0}),n.addParentCustomFunctions=void 0,r=i("CalcEngine"),u=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/utils.js"),o="PARENT",n.addParentCustomFunctions=s},"./dist/src/calculation/functions/query.js":function(t,n,i){"use strict";var f,a,r;function e(){var t;f.Functions.findGlobalFunction(r)||((t=new f.Functions.AsyncFunction(r,1,3)).isContextSensitive=function(){return!0},t.evaluateAsync=function(r,e,o,u){var t,s,n,t;function c(){var t,t,t,t,t,t=s.xEt(e,o,u);t&&(t.QJe=void 0),null!=(t=null==(t=null==(t=r.ctx)?void 0:t.Xkt)?void 0:t.node)&&t.WK?(t=s.IEt(e,o,u))&&(u?r.setAsyncResult(t[0]):r.setAsyncResult(new f.CalcArray(t))):s.IEt(e,o,u,c,!0)}function i(t){var n,i,n=s.IEt(e,o,u,c);if(n){if(u){if(i=n[0],t)return i}else if(i=new f.CalcArray(n),t)return i;r.setAsyncResult(i)}}if(t=r.ctx.source,t=(n=(s=t instanceof a.DataManagerCalcSource?t.nM.QOt:r.ctx.source.Mf.parent.dataManager()).xEt(e,o,u)).table){if(t.length())return i(!0);t.NEt().then(function(){i()})}},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},f.Functions.defineGlobalCustomFunction(r,t))}Object.defineProperty(n,"__esModule",{value:!0}),n.addQueryFunction=void 0,f=i("CalcEngine"),a=i("./dist/src/calculation/calcSource.js"),r="QUERY",n.addQueryFunction=e},"./dist/src/calculation/functions/scope.js":function(t,n,i){"use strict";var r,e,o,u,s;function c(){function t(){}function n(){}(t.prototype=new o.CalcFunction(u,2,2)).isContextSensitive=function(){return!0},t.prototype.isReverseArgs=function(){return!0},t.prototype.evaluate=function(t,n,i){return t.source.ak=n.start,t.source.DJ=n.context,i},r.Functions.defineGlobalCustomFunction(u,new t),(n.prototype=new o.CalcFunction(s,0,255)).isContextSensitive=function(){return!0},n.prototype.evaluate=function(t){for(var n,i,r,e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return r={start:t.source.ak,context:t.source.DJ},e=t.source.MEt,t.source.ak=0,t.source.DJ=f(e.groupContext,n),r},r.Functions.defineGlobalCustomFunction(s,new n)}function f(t,n){var n=a(t.groupOptions.slice(0,t.path.length),n);return h(t.path,n)?t.entireScope:l(t.path,n)}function a(t,n){var i,r;if(n&&0<n.length){for(i=-1,t.reverse(),r=0;r<t.length;r++)if(t[r].field!==n[r]){(0,e.isNullOrUndefined)(n[r])&&n.length<=r&&(i=t.length-r-1);break}return i}return-1}function h(t,n){return-1===n||t.length-1<=n}function l(t,n){var i,r=[];return d(t[n],r),r}function d(t,n){var i,r,e,o,u,s,c,f,i=n.length,r=t.recordRowNumbers;if(r)for(e=0,o=r.length;e<o;e++)n[i+e]=r[e];else for(s=0,c=u=t.children;s<c.length;s++)d(f=c[s],n)}Object.defineProperty(n,"__esModule",{value:!0}),n.addScopeCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),u="CALCULATE",s="REMOVEFILTERS",n.addScopeCustomFunctions=c},"./dist/src/calculation/functions/triggerFieldValue.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}(t.prototype=new o.CalcFunction(n.TRIGGERFIELDVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,n,i){var t=t.source.nM._dataSource,r=t.getFieldValue(n,0);return(0,e.isUndefined)(r)&&i?t.getFieldOriginalValue(n,0):r},r.Functions.defineGlobalCustomFunction(n.TRIGGERFIELDVALUE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addTriggerFieldValueCustomFunctions=n.TRIGGERFIELDVALUE=void 0,r=i("CalcEngine"),e=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/calculation/functions/utils.js"),n.TRIGGERFIELDVALUE="TRIGGERFIELDVALUE",n.addTriggerFieldValueCustomFunctions=u},"./dist/src/calculation/functions/utils.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CalcFunction=void 0;var i=i("./dist/src/dataManager.common.js");n.CalcFunction=i.CalcFunction},"./dist/src/calculation/functions/windowFunctions/cumeDist.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.CUMEDIST)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,_,O,S,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.orders,u=t.isOrderValid,s=t.reader,c=r-i,f=u&&1===o.length,a=u&&o[0].field,h=function(t){return s(a,n[t])},l=function(t,n){return s(o[n].field,t)},d=function(t){return n[t]},v=i;v<r;v++)if(u){if(p=n[v],w=void 0,m=n[b=v+1],f)(w=s(a,p))===s(a,m)&&(b=(-1!==(j=C(h,w,b,r-1))?j:b)+1);else{for(w=[],g=!(y=void 0),_=0;_<o.length;_++){if(a=o[_].field,(y=s(a,p))!==s(a,m)){g=!1;break}w.push(y)}g&&(b=(-1!==(j=R(d,l,w,b,r-1))?j:b)+1)}for(O=(b-i)/c,S=b-v;0<S;)S--,e.push(O);v=b-1}else e.push(1)})},r.Functions.defineGlobalCustomFunction(e.CUMEDIST,new t)}function C(t,n,i,r){for(var e,o,u,s,c,e=i,o=r,u=-1;e<=o;)n===(c=t(s=Math.floor((e+o)/2)))?(e=s+1,u=s):o=s-1;return u}function R(t,n,i,r,e){for(var o,u,s,c,f,a,h,l,o=r,u=e,s=-1,c=i.length-1;o<=u;){for(a=t(f=Math.floor((o+u)/2)),h=!0,l=c;0<=l;l--)if(n(a,l)!==i[l]){h=!1;break}h?(o=f+1,s=f):u=f-1}return s}Object.defineProperty(n,"__esModule",{value:!0}),n.addCumeDistCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addCumeDistCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/denseRank.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.DENSERANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.orders,u=t.reader,s=t.isOrderValid,c=0,h=!1;for(s&&((l=1===o.length)?d=o[0].field:f=[]),v=i;v<r;v++){if(s)if(p=n[v],l)(a=u(d,p))===f&&v!==i||(c+=1,f=a);else{for(a=[],w=o.length-1;0<=w;w--)b=u(o[w].field,p),a.unshift(b),b!==f[w]&&(h=!0);!h&&v!==i||(h=!1,c+=1,f=a)}else c=1;e.push(c)}})},r.Functions.defineGlobalCustomFunction(e.DENSERANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addDenseRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addDenseRankCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js":function(t,n,i){"use strict";var r,w,e,b,i;function o(){function t(){}(t.prototype=new e.CalcFunction(e.FIRSTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return c(t,n,b.first,1)},r.Functions.defineGlobalCustomFunction(e.FIRSTVALUE,new t)}function u(){function t(){}(t.prototype=new e.CalcFunction(e.LASTVALUE,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n){return c(t,n,b.last,1)},r.Functions.defineGlobalCustomFunction(e.LASTVALUE,new t)}function s(){function t(){}(t.prototype=new e.CalcFunction(e.NTHVALUE,1,2)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i){return c(t,n,b.nth,i)},r.Functions.defineGlobalCustomFunction(e.NTHVALUE,new t)}function c(t,n,d,v){var i,p=t.source.nM.Cve(n);return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,t,s,c,f,a,h,l,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.frame,u=t.evaluateWindowIndexes,t=t.buildFrameGroups;if((0,w.isNumber)(v)&&0<v)for(v=Math.floor(v),s={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},c=t(n,i),f=i;f<r;f++)u(o,i,f,n,s,c),-1===s.startIndex&&-1===s.endIndex?e.push(null):d===b.first?e.push(p(n[s.startIndex])):d===b.last?e.push(p(n[s.endIndex])):!((a=s.startIndex+v-1)<=s.endIndex)||void 0!==s.gapStartIndex&&void 0!==s.gapEndIndex&&(h=s.gapStartIndex-s.startIndex)<v&&(a=void 0!==s.currentIndex?1==(l=v-h)?s.currentIndex:l-1+s.gapEndIndex:v-h+s.gapEndIndex,s.endIndex<a)?e.push(null):e.push(p(n[a]))})}Object.defineProperty(n,"__esModule",{value:!0}),n.addNthValueCustomFunctions=n.addLastValueCustomFunctions=n.addFirstValueCustomFunctions=void 0,r=i("CalcEngine"),w=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),(i=b=b||{})[i.first=0]="first",i[i.last=1]="last",i[i.nth=2]="nth",n.addFirstValueCustomFunctions=o,n.addLastValueCustomFunctions=u,n.addNthValueCustomFunctions=s},"./dist/src/calculation/functions/windowFunctions/leadLag.js":function(t,n,i){"use strict";var r,l,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.LEAD,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return s(t,n,i,r)},r.Functions.defineGlobalCustomFunction(e.LEAD,new t)}function u(){function t(){}(t.prototype=new e.CalcFunction(e.LAG,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 0===t},t.prototype.evaluate=function(t,n,i,r){return s(t,n,i,r,!0)},r.Functions.defineGlobalCustomFunction(e.LAG,new t)}function s(t,n,c,f,a){var i,h=t.source.nM.Cve(n);return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,s,n=t.indexes,i=t.begin,r=t.length,e=t.result;if(c=(0,l.isNullOrUndefined)(c)?1:c,(0,l.isNumber)(c)&&0<=c)for(c=Math.floor(c),f=(0,l.isNullOrUndefined)(f)?null:f,o=i;o<r;o++)s=u=void 0,(s=a?i<=(u=o-c):(u=o+c)<r)?e.push(h(n[u])):e.push(f)})}Object.defineProperty(n,"__esModule",{value:!0}),n.addLagCustomFunctions=n.addLeadCustomFunctions=void 0,r=i("CalcEngine"),l=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addLeadCustomFunctions=o,n.addLagCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/nTile.js":function(t,n,i){"use strict";var r,a,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.NTILE,1,1)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t,f){return(0,e.expandContext)(t,function(t){var n,i,r,t,e,o,u,s,c,n=t.begin,i=t.length,r=t.result;if((0,a.isNumber)(f)&&0<f&&f<i)for(t=i-n,u=(e=Math.floor(t/f))+(0<(o=t%f)?1:0),o--,s=n,c=1;s<i;s++)r.push(c),0===--u&&(u=e+(0<o?1:0),o--,c++);else for(s=n;s<i;s++)r.push(s-n+1)})},r.Functions.defineGlobalCustomFunction(e.NTILE,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addNTileCustomFunctions=void 0,r=i("CalcEngine"),a=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addNTileCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/percentRank.js":function(t,n,i){"use strict";var r,e,o;function u(){function t(){}(t.prototype=new o.CalcFunction(o.WPERCENTRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.evaluateRank)(t,function(t,n){return 1===n?0:(t-1)/(n-1)})},r.Functions.defineGlobalCustomFunction(o.WPERCENTRANK,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWPercentRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),o=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWPercentRankCustomFunctions=u},"./dist/src/calculation/functions/windowFunctions/rank.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.WRANK)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return u(t)},r.Functions.defineGlobalCustomFunction(e.WRANK,new t)}function u(t,j){return(0,e.expandContext)(t,function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,n=t.indexes,i=t.begin,r=t.length,e=t.result,o=t.orders,u=t.isOrderValid,s=t.reader,c=1,h=!1,l=r-i,d=!1;for(u&&((d=1===o.length)?v=o[0].field:f=[]),p=i;p<r;p++){if(u)if(w=n[p],d)(a=s(v,w))===f&&p!==i||(c=p-i+1,j&&(c=j(c,l)),f=a);else{for(a=[],b=o.length-1;0<=b;b--)m=s(o[b].field,w),a.unshift(m),m!==f[b]&&(h=!0);!h&&p!==i||(h=!1,c=p-i+1,j&&(c=j(c,l)),f=a)}e.push(c)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateRank=n.addWRankCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addWRankCustomFunctions=o,n.evaluateRank=u},"./dist/src/calculation/functions/windowFunctions/rowNumber.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.ROWNUMBER)).isContextSensitive=function(){return!0},t.prototype.evaluate=function(t){return(0,e.expandContext)(t,function(t){for(var n,i,r,e,n=t.begin,i=t.length,r=t.result,e=n;e<i;e++)r.push(e-n+1)})},r.Functions.defineGlobalCustomFunction(e.ROWNUMBER,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addRowNumberCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),n.addRowNumberCustomFunctions=o},"./dist/src/calculation/functions/windowFunctions/util.js":function(t,n,i){"use strict";var v,i;function e(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function r(t,n,i){return t.map(function(t){return n(t.field,i)})}function o(t,n){if(t!==n){if((0,v.isNullOrUndefined)(t)||(0,v.isNullOrUndefined)(n)||t.length!==n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!1}return!0}function u(t,n,i){var r,i,r=t.DJ;return t.DJ=i,i=e(t,n),t.DJ=r,i}function s(t,n){var i,t,r,e,o,u,s,c,f,a,h,l,d;if(!(0,v.isNullOrUndefined)(t.source.MEt)&&!(0,v.isNullOrUndefined)(t.source.MEt.extendContext))return i=t.source.DJ,r=(t=t.source.MEt.extendContext).begin,e=t.evaluator,o=i.length,u=!1,c=e.options.windowFrame,f=e.options.orders,a=!(s=void 0,v.isNullOrUndefined)(f)&&0<f.length,h=function(t,n){return e.Qhe(t).getValue(n)},l=e.Khe.bind(e),d=e.ube.bind(e),s=(0,v.isNullOrUndefined)(t.valueCache)?t.valueCache=[]:(u=!0,t.valueCache),u||n({indexes:i,begin:r,length:o,result:s,frame:c,orders:f,isOrderValid:a,reader:h,evaluateWindowIndexes:l,buildFrameGroups:d}),s[0]}Object.defineProperty(n,"__esModule",{value:!0}),n.expandContext=n.evaluateExpressionValue=n.isEqualValues=n.getOrderByValues=n.evaluateExpression=n.CUMEDIST=n.DENSERANK=n.NTHVALUE=n.LASTVALUE=n.FIRSTVALUE=n.LAG=n.LEAD=n.NTILE=n.WPERCENTRANK=n.WRANK=n.ROWNUMBER=n.CalcFunction=void 0,v=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=i.CalcFunction,n.ROWNUMBER="ROWNUMBER",n.WRANK="W_RANK",n.WPERCENTRANK="W_PERCENTRANK",n.NTILE="NTILE",n.LEAD="LEAD",n.LAG="LAG",n.FIRSTVALUE="FIRSTVALUE",n.LASTVALUE="LASTVALUE",n.NTHVALUE="NTHVALUE",n.DENSERANK="DENSERANK",n.CUMEDIST="CUMEDIST",n.evaluateExpression=e,n.getOrderByValues=r,n.isEqualValues=o,n.evaluateExpressionValue=u,n.expandContext=s},"./dist/src/calculation/functions/windowFunctions/windowFunctions.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,a;function h(){(0,r.addRowNumberCustomFunctions)(),(0,e.addWRankCustomFunctions)(),(0,o.addDenseRankCustomFunctions)(),(0,u.addWPercentRankCustomFunctions)(),(0,s.addCumeDistCustomFunctions)(),(0,f.addNTileCustomFunctions)(),(0,c.addLeadCustomFunctions)(),(0,c.addLagCustomFunctions)(),(0,a.addFirstValueCustomFunctions)(),(0,a.addLastValueCustomFunctions)(),(0,a.addNthValueCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowFunctions=void 0,r=i("./dist/src/calculation/functions/windowFunctions/rowNumber.js"),e=i("./dist/src/calculation/functions/windowFunctions/rank.js"),o=i("./dist/src/calculation/functions/windowFunctions/denseRank.js"),u=i("./dist/src/calculation/functions/windowFunctions/percentRank.js"),s=i("./dist/src/calculation/functions/windowFunctions/cumeDist.js"),c=i("./dist/src/calculation/functions/windowFunctions/leadLag.js"),f=i("./dist/src/calculation/functions/windowFunctions/nTile.js"),a=i("./dist/src/calculation/functions/windowFunctions/firstLastNthValue.js"),n.addWindowFunctions=h},"./dist/src/calculation/functions/windowOvers/ascDesc.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.ORDERASC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!0)},r.Functions.defineGlobalCustomFunction(e.ORDERASC,new t)}function u(){function t(){}(t.prototype=new e.CalcFunction(e.ORDERDESC,1,1)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){var t,n;return s(arguments[0].source,arguments[1],!1)},r.Functions.defineGlobalCustomFunction(e.ORDERDESC,new t)}function s(t,n,i){return{field:(0,e.getFieldOption)(t,n),ascending:i}}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderDescCustomFunctions=n.addOrderAscCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderAscCustomFunctions=o,n.addOrderDescCustomFunctions=u},"./dist/src/calculation/functions/windowOvers/orderBy.js":function(t,n,i){"use strict";var r,s;function e(){function t(){}(t.prototype=new s.CalcFunction(s.ORDERBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,i,r,e,o,u,t,n=arguments[0].source,i=[],r=1,e=arguments.length;r<e;r++)u=void 0,u=c(o=arguments[r])?(0,s.evaluateExpression)(n,o):{field:(0,s.getFieldOption)(n,o),ascending:!0},i.push(u);return i},r.Functions.defineGlobalCustomFunction(s.ORDERBY,new t)}function c(t){var t=(0,s.getExprFunctionName)(t);return t===s.ORDERASC||t===s.ORDERDESC}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrderByCustomFunctions=void 0,r=i("CalcEngine"),s=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addOrderByCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/partitionBy.js":function(t,n,i){"use strict";var r,u;function e(){function t(){}(t.prototype=new u.CalcFunction(u.PARTITIONBY,1,255)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(){for(var t,n,i,r,e,o,t,n=arguments[0].source,i=[],r=1,e=arguments.length;r<e;r++)i.push({field:(0,u.getFieldOption)(n,o=arguments[r]),ascending:!0});return i},r.Functions.defineGlobalCustomFunction(u.PARTITIONBY,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addPartitionByCustomFunctions=void 0,r=i("CalcEngine"),u=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addPartitionByCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js":function(t,n,i){"use strict";var r,s,c,f,u,i;function e(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMERANGE,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,o;return h({type:s.WindowOverFrameType.RANGE},t,n,i,e,s.WindowOverFrameType.RANGE,r)},r.Functions.defineGlobalCustomFunction(f.FRAMERANGE,new t)}function o(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMEROWS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,o;return h({type:s.WindowOverFrameType.ROWS},t,n,i,e,s.WindowOverFrameType.ROWS,r)},r.Functions.defineGlobalCustomFunction(f.FRAMEROWS,new t)}function a(){function t(){}(t.prototype=new f.CalcFunction(f.FRAMEGROUPS,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return 2!==t},t.prototype.evaluate=function(t,n,i,r){var t=t.source,e=t.MEt.windowFrameOrder,o;return h({type:s.WindowOverFrameType.GROUPS},t,n,i,e,s.WindowOverFrameType.GROUPS,r)},r.Functions.defineGlobalCustomFunction(f.FRAMEGROUPS,new t)}function h(t,n,i,r,e,o,u){var i,i,i=(0,f.unparseExpression)(n,i);return t.begin=l(i,s.WindowOverFramePreceding.CurrentRow,s.WindowOverFramePreceding.UnBounded,o,e),v(r)?t.exclude=p(r):((0,c.isNullOrUndefined)(r)||(i=(0,f.unparseExpression)(n,r),t.end=l(i,s.WindowOverFrameFollowing.CurrentRow,s.WindowOverFrameFollowing.UnBounded,o,e)),v(u)&&(t.exclude=p(u))),d(t,e,o),t}function l(t,n,i,r,e){var i,t,i,o;return"[@]"===t?{type:u.current,option:{type:n}}:"-1"===t?{type:u.unbounded,option:{type:i}}:(i=/^\[@([-\+])(\d+(\.\d+)?)\]$/.exec(t))&&(t=i[1],i=Number(i[2]),o=void 0,"-"===t?o=s.WindowOverFramePreceding.NPreceding:"+"===t&&(o=s.WindowOverFrameFollowing.NFollowing),r===s.WindowOverFrameType.ROWS||r===s.WindowOverFrameType.GROUPS?i=Math.floor(i):e&&("-"===t?o=s.WindowOverFrameFollowing.NFollowing:"+"===t&&(o=s.WindowOverFramePreceding.NPreceding)),0!==i)?{type:u.range,value:Number(t+i),option:{type:o,offset:i}}:{type:u.current,option:{type:n}}}function d(t,n,i){var r=t.begin,e=t.end,o=!1;e?(n&&i===s.WindowOverFrameType.RANGE?(r.type===u.unbounded||r.type===u.current&&(e.type===u.unbounded||e.type===u.current||e.type===u.range&&e.value<=0)||r.type===u.range&&(e.type===u.unbounded||0<=r.value&&e.type===u.current||e.type===u.range&&r.value>=e.value))&&(o=!0):(r.type===u.unbounded||r.type===u.current&&(e.type===u.unbounded||e.type===u.current||e.type===u.range&&0<=e.value)||r.type===u.range&&(e.type===u.unbounded||r.value<=0&&e.type===u.current||e.type===u.range&&r.value<=e.value))&&(o=!0),t.begin=t.begin.option,t.end=t.end.option,o||(t.begin.offset=-1,t.end.offset=-1)):t.begin=t.begin.option}function v(t){return("number"==typeof t||t&&2===t.type&&"number"==typeof t.value)&&((t=t.value?t.value:t)===s.WindowOverFrameExcludeMode.current||t===s.WindowOverFrameExcludeMode.group||t===s.WindowOverFrameExcludeMode.none||t===s.WindowOverFrameExcludeMode.ties)}function p(t){return"number"==typeof t?t:t.value}Object.defineProperty(n,"__esModule",{value:!0}),n.addFrameGroupsCustomFunctions=n.addFrameRowsCustomFunctions=n.addFrameRangeCustomFunctions=void 0,r=i("CalcEngine"),s=i("./dist/src/dataSource/dataSource.interface.js"),c=i("./dist/src/dataSource/utils.js"),f=i("./dist/src/calculation/functions/windowOvers/util.js"),(i=u=u||{})[i.unbounded=-1]="unbounded",i[i.current=0]="current",i[i.range=1]="range",n.addFrameRangeCustomFunctions=e,n.addFrameRowsCustomFunctions=o,n.addFrameGroupsCustomFunctions=a},"./dist/src/calculation/functions/windowOvers/util.js":function(t,n,i){"use strict";var r,i;function e(t,n){return t.getCalcService().unparse(t,n,0,0)}function o(t,n){return t.getCalcService().evaluateExpression(t,n,{row:0,col:0})}function u(t,n){try{return t.getCalcService().parse(t,n,0,0)}catch(t){return null}}function s(t,n,i){t.wEt("windowFrameOrder",!1===(i&&0<i.length&&i[0].ascending));var i=t.getCalcService().evaluateExpression(t,n,{row:0,col:0});return t.wEt("windowFrameOrder"),i}function c(t,n){var i,n,i=e(t,n);return 14===n.type?(i=i.replace(/[\[\]]/g,""),(n=t.nM.awe(i))&&(i=n)):i="=".concat(i),i}function f(t){return(0,r.isNullOrUndefined)(t)?null:t.functionName||t.function&&t.function.name}function a(t){return f(t)===n.PARTITIONBY}function h(t){return f(t)===n.ORDERBY}function l(t){var t=f(t);return t===n.FRAMERANGE||t===n.FRAMEROWS||t===n.FRAMEGROUPS}function d(t){return f(t)===n.WINDOWDEF}function v(t,n,i,r){var e,o,u;return a(n)?(e=p(t,n),h(i)?(o=p(t,i),l(r)&&(u=w(t,r,o))):l(i)?u=w(t,i):b(i)&&l(r)&&(u=w(t,r,o))):h(n)?(o=p(t,n),l(i)&&(u=w(t,i,o))):l(n)?u=w(t,n):b(n)&&(h(i)?(o=p(t,i),l(r)&&(u=w(t,r,o))):l(i)&&(u=w(t,i))),{partitions:e,orders:o,windowFrame:u}}function p(t,n){var i=o(t,n);return i.formula=e(t,n),i}function w(t,n,i){var i=s(t,n,i);return i.formula=e(t,n),i}function b(t){return t&&3===t.type}Object.defineProperty(n,"__esModule",{value:!0}),n.isStringExpression=n.getOverOptions=n.isWindowDef=n.isWindowFrame=n.isOrderBy=n.isPartitionBy=n.getExprFunctionName=n.getFieldOption=n.evaluateFrameExpression=n.parseFormula=n.evaluateExpression=n.unparseExpression=n.WINDOWDEF=n.WINDOWOVERDECONSTRUCT=n.FRAMEGROUPS=n.FRAMEROWS=n.FRAMERANGE=n.ORDERDESC=n.ORDERASC=n.ORDERBY=n.PARTITIONBY=n.WINDOWOVER=n.CalcFunction=void 0,r=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/calculation/functions/utils.js"),n.CalcFunction=i.CalcFunction,n.WINDOWOVER="WINDOW",n.PARTITIONBY="PARTITIONBY",n.ORDERBY="ORDERBY",n.ORDERASC="ORDERASC",n.ORDERDESC="ORDERDESC",n.FRAMERANGE="FRAMERANGE",n.FRAMEROWS="FRAMEROWS",n.FRAMEGROUPS="FRAMEGROUPS",n.WINDOWOVERDECONSTRUCT="WINDOWOVERDECONSTRUCT",n.WINDOWDEF="WINDOWDEF",n.unparseExpression=e,n.evaluateExpression=o,n.parseFormula=u,n.evaluateFrameExpression=s,n.getFieldOption=c,n.getExprFunctionName=f,n.isPartitionBy=a,n.isOrderBy=h,n.isWindowFrame=l,n.isWindowDef=d,n.getOverOptions=v,n.isStringExpression=b},"./dist/src/calculation/functions/windowOvers/windowOver.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.WINDOWOVER,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var o=t.Whe.D5;return o||(t.Whe.D5=o=u(t.source,t.Whe)),t.source.nM._getValueByField(o,t.source.DJ)},r.Functions.defineGlobalCustomFunction(e.WINDOWOVER,new t)}function u(t,n){var t=(0,e.unparseExpression)(t,n);return"="===t[0]?t:"="+t}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js":function(t,n,i){"use strict";var r,a;function e(){function t(){}(t.prototype=new r.Functions.Function(a.WINDOWOVERDECONSTRUCT,1,4)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r,e){var t,o,u,s,c,u,i,r,f,e,t=t.source,o=(0,a.unparseExpression)(t,n),u=(0,a.getOverOptions)(t,i,r,e),s=u.partitions,c=u.orders,u=u.windowFrame,i=h(i,t)||h(r,t)||h(e,t)||{},r={windowExpression:n,windowFormula:o,partitions:s||i.partitions,orders:c||i.orders,windowFrame:u||i.windowFrame,formulaFromWindowChaining:void 0,windowDefineName:i.windowDefineName},f;return 0<Object.keys(i).length&&(e="=".concat(a.WINDOWOVER,"(").concat(o),r.partitions&&(e+=",".concat(r.partitions.formula)),r.orders&&(e+=",".concat(r.orders.formula)),r.windowFrame&&(e+=",".concat(r.windowFrame.formula)),r.formulaFromWindowChaining=e+=")"),r},r.Functions.defineGlobalCustomFunction(a.WINDOWOVERDECONSTRUCT,new t)}function h(t,n){var i,i,i,t,i,i,i,r,e,i,n;if((0,a.isStringExpression)(t))return t=t.value,(i=null==(i=null==(i=null==(i=n.nM._dataSource)?void 0:i.options)?void 0:i.schema)?void 0:i.window)&&i[t]&&(i=i[t])&&(i=(0,a.parseFormula)(n,i),(0,a.isWindowDef)(i))?(r=i.arguments[0],e=i.arguments[1],i=i.arguments[2],(n=(0,a.getOverOptions)(n,r,e,i)).windowDefineName=t,n):{windowDefineName:t}}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDeconstructCustomFunctions=void 0,r=i("CalcEngine"),a=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDeconstructCustomFunctions=e},"./dist/src/calculation/functions/windowOvers/windowOverDefine.js":function(t,n,i){"use strict";var r,e;function o(){function t(){}(t.prototype=new e.CalcFunction(e.WINDOWDEF,1,3)).isContextSensitive=function(){return!0},t.prototype.acceptsExpressionArgument=function(t){return!0},t.prototype.evaluate=function(t,n,i,r){return(0,e.getOverOptions)(t.source,n,i,r)},r.Functions.defineGlobalCustomFunction(e.WINDOWDEF,new t)}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverDefineCustomFunctions=void 0,r=i("CalcEngine"),e=i("./dist/src/calculation/functions/windowOvers/util.js"),n.addWindowOverDefineCustomFunctions=o},"./dist/src/calculation/functions/windowOvers/windowOvers.entry.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f;function a(){(0,r.addWindowOverCustomFunctions)(),(0,f.addWindowOverDefineCustomFunctions)(),(0,c.addWindowOverDeconstructCustomFunctions)(),(0,e.addPartitionByCustomFunctions)(),(0,o.addOrderByCustomFunctions)(),(0,u.addFrameRangeCustomFunctions)(),(0,u.addFrameRowsCustomFunctions)(),(0,u.addFrameGroupsCustomFunctions)(),(0,s.addOrderAscCustomFunctions)(),(0,s.addOrderDescCustomFunctions)()}Object.defineProperty(n,"__esModule",{value:!0}),n.addWindowOverFunctions=void 0,r=i("./dist/src/calculation/functions/windowOvers/windowOver.js"),e=i("./dist/src/calculation/functions/windowOvers/partitionBy.js"),o=i("./dist/src/calculation/functions/windowOvers/orderBy.js"),u=i("./dist/src/calculation/functions/windowOvers/rangeRowsGroups.js"),s=i("./dist/src/calculation/functions/windowOvers/ascDesc.js"),c=i("./dist/src/calculation/functions/windowOvers/windowOverDeconstruct.js"),f=i("./dist/src/calculation/functions/windowOvers/windowOverDefine.js"),n.addWindowOverFunctions=a},"./dist/src/calculation/queryFunctionResolver.js":function(t,n,i){"use strict";var i,h,l,r;function d(i,r,e){return function(t){var n=[];return n.push(t.kEt(t.mEt(i),r||t._dataSource.DEt,e)),n}}function e(){}Object.defineProperty(n,"__esModule",{value:!0}),n.QueryFunctionSolver=void 0,i=i("Common"),h=null,l=i.Common.zf.fJ,e.parseParam=function(o,u,s,c){for(var f,a,t,n,f=Object.keys(c.tables),a=new e,t=function(t){var t,n,i,r,e,t=f[t];o===t?(a.getValue=function(t){var t;return a.QJe||(t=t.ASt(h,h,u,s),a.QJe=t)},a.table=c.tables[t]):l(o,t)&&(a.table=c.tables[t],n=o[t.length],i=o.substr(t.length+1),"#"===n?(r=parseInt(i,10),a.getValue=function(t){var n;return a.QJe||((n=[]).push(t.kEt(r,u||t._dataSource.DEt,s)),a.QJe=n)}):"/"===n?a.getValue=function(t){var t;return a.QJe||(t=d(i,u,s)(t),a.QJe=t)}:"?"===n?1===(e=i.split("=",2)).length?a.getValue=function(t){var t;return a.QJe||(t=d(i,u,s)(t),a.QJe=t)}:a.getValue=function(t){var t;return a.QJe||(t=t.ASt(e[1],e[0],u,s),a.QJe=t)}:delete a.table)},n=0;n<f.length;n++)t(n);return a},n.QueryFunctionSolver=e},"./dist/src/calculation/tokenResolver.js":function(t,n,i){"use strict";var r,e,c,h,f,o,u,s,a;function l(t){var n=s.call(this,14)||this;return n.value=t,n}function d(t){return a.call(this,t)||this}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerTokenResolver=void 0,e=i("CalcEngine"),c=i("./dist/src/calculation/calcSource.js"),h=i("./dist/src/dataSource/utils.js"),s=e.Expression,r(l,s),l.prototype.Iwt=function(t,n){var i;this.value instanceof c.DataManagerReference&&this.value.table._Et(t,this.value.Pq[0],n)},f=l,a=e.TokenResolver,r(d,a),d.prototype.resolveToken=function(t,n,i,r,e){var i,o,t,t,i,u,s,i=i[r],o=i.Awt,t=t.source,t=t&&t.nM;if(t&&0===i.uit&&"["===o[0]&&"]"===o[o.length-1]&&(i=new c.DataManagerReference,-1!==(u=this.EEt(i,o,1)))&&(i.rowString=o.substring(1,u),-1!==(u=this.jEt(i,o,u))))return i.table=t,i.Pq=i.field,i.field=t.bEt(i.field),{expr:s=new f(i),index:r+1}},d.prototype.EEt=function(t,e,n){var o,i,r,u,s;function c(t,n){for(var i=n?t+1:t;"0"<=e[i]&&e[i]<="9";)i++;for(;" "===e[i];)i++;return{value:parseInt(e.substring(t,i),10),end:i}}function f(t){for(var n=t;n<e.length&&"["!==e[n]&&"]"!==e[n]&&","!==e[n];)n++;return{type:"key",value:e.substring(t,n).trim(),end:n}}function a(t){var n,i,r,i,n=e[t],i=e[t+1];return"@"===n?(o=!0,"+"===i||"-"===i?(r=c(t+1,!0)).end<=t+1?-1:{num:r.value,end:r.end,relative:!0}:{num:0,end:t+1,relative:!0}):"#"===n?(r=c(t+1)).end>t+1?{num:r.value,end:r.end,relative:!1}:"last"===e.substr(t+1,4)?{num:-1,end:t+5,relative:!1}:"odd"===e.substr(t+1,3)?{type:"odd",end:t+4}:"even"===e.substr(t+1,4)?{type:"even",end:t+5}:-1:"$"!==n||(i=f(t+1)).end>=e.length?-1:i}for(o=!1,i=null;n<e.length&&"["!==(r=e[n])&&"]"!==r;)if(i||"@"!==r&&"#"!==r&&"$"!==r){if(","===r&&i)i=!1;else if(" "!==r)break;n++}else{if(-1===(u=a(n)))return-1;if(":"!==e[u.end]||(0,h.isNullOrUndefined)(u.num))t.row.push(u),n=u.end;else{for(n=u.end+1;" "===e[n];)n++;if(-1===(s=a(n))||(0,h.isNullOrUndefined)(s.num))return-1;t.row.push([u,s]),n=s.end}i=!0}return t.gEt=o,!1===i?-1:n},d.prototype.jEt=function(t,i,n){var r,e,o;function u(t){for(var n=t;"]"!==i[n];)n++;return{str:i.substring(t,n),end:n}}function s(t){for(var n=t;"."!==i[n]&&"]"!==i[n];)n++;return{str:i.substring(t,n),end:n}}for(r=null;n<i.length;)if("["!==(e=i[n])||r){if("]"===e)break;if(" "===e)n++;else if("."===e&&r)n++,r=!1;else{if("."===e||r)return-1;o=s(n),t.field.push(o.str),n=o.end,r=!0}}else{if((o=u(n+1)).end<=n+1)return-1;t.field.push(o.str),n=o.end+1,r=!0}return n===i.length-1?n:-1},d.prototype.unparse=function(t,n,i,r){var e,o,u,s,c,f;if(14!==i.type)return!1;if(r.push("["),0<(e=i.value.rowString).length&&r.push(e),0<(o=i.value.Pq).length)for(u="@"===e||""===e,s=0,c=o.length;s<c;s++)f=o[s],!u||-1<f.indexOf(" ")?r.push("[".concat(f,"]")):r.push(f),s<c-1&&r.push(".");return r.push("]"),!0},n.DataManagerTokenResolver=d},"./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js":function(t,n,i){"use strict";var r,e,o,u,s;function c(t){this.QSt={},this.N3=t}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerProxy=void 0,r=i("CalcEngine"),e=i("./dist/src/dataManager.entry.js"),o=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),u=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),c.prototype.getTable=function(t){var n,i;if(!(0,e.isNullOrUndefined)(t)){if(this.QSt[t])return this.QSt[t];if((n=this.N3.tables)[t])return this.QSt[t]=new u.ReportTable({dataManagerTable:n[t]}),this.QSt[t];for(i in t=t.toUpperCase(),n)if(n.hasOwnProperty(i)&&i.toUpperCase()===t)return this.QSt[t]=new u.ReportTable({dataManagerTable:n[i]}),this.QSt[t];return(0,o.isFormulaInWhitelist)(t)?(this.QSt[t]=this.generateFormulaTableByFormula(t),this.QSt[t]):void 0}},c.prototype.getCalcService=function(){var t=this.N3.Lp;return t.allowDynamicArray=!0,t},c.prototype.getTables=function(){return this.QSt},c.prototype.getRelationshipsByTable=function(t){var n,i,n=this.N3.relationships;return t&&(i=t.table(),n=n.filter(function(t){return t.sourceTable===i||t.targetTable===i})),n},c.prototype.generateFormulaTableByFormula=function(t){var n,i,n,n=this.getCalcService(),i=new r.CalcSource(n),n=(0,o.getFormulaResult)(n,i,t.replace(/__\d+__\d+/g,""));return new u.ReportTable({formulaTable:{name:t,formulaResult:n}})},c.prototype.clearTableDataCache=function(){var t,n,t=this.QSt;for(n in t)t.hasOwnProperty(n)&&t[n].clearTableDataCache()},n.DataManagerProxy=c},"./dist/src/data-manager-report/data-manager-proxy/report-table.js":function(t,n,i){"use strict";var s,r;function e(t){var i,n,t,i=this,n=t.dataManagerTable,t=t.formulaTable;n?(this._le=n,this.sbe={}):this.jle=t,this.jle&&(this.Ele=this.jle.formulaResult.map(function(t){var n={};return n[i.jle.name]=t,n}))}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTable=void 0,s=i("./dist/src/dataManager.entry.js"),Object.defineProperty(e.prototype,"name",{get:function(){return(this._le||this.jle).name},enumerable:!1,configurable:!0}),e.prototype.table=function(){return this._le},e.prototype.getFields=function(){return this._le.ltt()},e.prototype.getData=function(t){var n,i,r,e;if(this.jle)if(t)for(n=[],i=0,r=t;i<r.length;i++)e=r[i],n.push(this.Ele[e]);else n=this.Ele;else n=this._le.getDataSync(t);return n},e.prototype.length=function(){return this.jle?this.Ele.length:this._le.length()},e.prototype.getValueByField=function(t,n,i){var r,e,o,u;return this.jle?(0,s.formatCalcError)(this.jle.formulaResult[n]):(r=void 0,(e=this.sbe[t])&&e.hasOwnProperty(n)?r=e[n]:((o=this._le.columns)[u=t]&&"string"==typeof o[t].value&&(u=o[t].value),r=this._le._getValueByField(u,n),(e=e||(this.sbe[t]={}))[n]=r),t.startsWith("=")&&!i?(0,s.formatCalcError)(r):r)},e.prototype.hasField=function(n){return this.jle?n===this.jle.name:(n=n.toUpperCase(),0<Object.keys(this._le.columns).filter(function(t){return t.toUpperCase()===n}).length)},e.prototype.getFieldByNameIgnoreCase=function(t){return this.jle?{fieldName:this.name}:this._le.Ole(t)},e.prototype.reset=function(){this.jle||(this._le.XOt={})},e.prototype.clearTableDataCache=function(){this.sbe={}},n.ReportTable=e},"./dist/src/data-manager-report/data-manager-report.js":function(t,n,i){"use strict";var n,r,e,o;Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/dataManager.js"),e=i("./dist/src/data-manager-report/tree-data-generator/index.js"),(o=n.Common.lt.Dh)(r.DataManager.prototype,{generateTreeData:function(t){var n;new e.TreeDataGenerator(this,t).generateTreeData()}})},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js":function(t,n,i){"use strict";var x,T,D,r;function e(t,n,i,r,e){this.N3=t,this.DJ=n,this.Rle=i,this.Lle=r,this.Ble=e}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportCrossHelper=void 0,x=i("./dist/src/dataManager.entry.js"),T=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),D=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),e.prototype.processCrossCells=function(t){var u=this;try{t.forEach(function(t){var n,o,i,n=t.leftParent.data.groups,o=t.upParent.data.groups,i=u.Fle(t);i?i.data.groups.forEach(function(i){var r,e,r=[],e=[];n.forEach(function(t){t===i&&r.push(t);for(var n=t.leftParent||t.upParent;n;){if(n===i)return void r.push(t);if(n.cellNode===i.cellNode)return;n=n.leftParent||n.upParent}}),o.forEach(function(t){t===i&&e.push(t);for(var n=t.upParent||t.leftParent;n;){if(n===i)return void e.push(t);if(n.cellNode===i.cellNode)return;n=n.upParent||n.leftParent}}),u.Ple(t,r,e)}):u.Ple(t,n,o)})}catch(t){}},e.prototype.Fle=function(t){for(var n,i,n=t.leftParent;n;){for(i=t.upParent;i;){if(i===n)return n;i=i.upParent||i.leftParent}n=n.leftParent||n.upParent}return null},e.prototype.Ple=function(i,t,n){var o,u,s,c,f,r,e,a,h,l,d,v,p,w,l,l,o=this,u=i.indexOfLeftParentChildren,s=i.indexOfUpParentChildren,c={},f=[],r,e=this.Rle.getRelationshipsMap()[i.relationshipMapKey];for(t.forEach(function(i,r){var t,e;i.crossChildren[u]||(i.crossChildren[u]=[]),t=i.valuePath,c[t]||(c[t]={}),e=c[t],n.forEach(function(t,n){t.crossChildren[s]||(t.crossChildren[s]=[]);var n={vg:i,hg:t,vIndex:r,hIndex:n,crossChildren:[],crossRecordRowNumbers:[]};e[t.valuePath]=n,f.push(n)})}),e&&e.forEach(function(t,r){var n,e,n=o.Lle.generateParentPaths(i.leftParent,t),e=o.Lle.generateParentPaths(i.upParent,t);n.forEach(function(i){e.forEach(function(t){var n=c[i],n=null==n?void 0:n[t];n&&n.crossRecordRowNumbers.push(r)})})}),a=0,h=f;a<h.length;a++)d=(l=h[a]).vg,v=l.hg,p=l.vIndex,w=l.hIndex,l=l.crossRecordRowNumbers,l=this.Ule(d,v,l,i),d.crossChildren[u][w]=l,v.crossChildren[s][p]=l},e.prototype.Ule=function(t,n,i,r,e){var o,u,s,s,c,f,o,o=this.N3;return t&&n||(s=(s=(u=t||n)&&u.cellNode)&&s.relationshipMapKey,c=r.relationshipMapKey,void 0!==s&&c!==s&&i&&i.length&&(f=(0,T.getTableNameByCellNode)(r),o=o.getTable(f))&&e&&(i=this.Lle.zle(r,i,o,e,c,s,u))),"No"===r.templateCell.expansionDirection?this.Vle(t,n,i,r):this.Yle(t,n,i,r)},e.prototype.Vle=function(t,n,i,r){var e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,b;if(r.templateCell.dataColumn?(u=r.templateCell.dataColumn.tableName,s=r.templateCell.dataColumn.columnName):r.templateCell.formula&&"No"!==r.templateCell.expansionDirection&&(0,T.isFormulaInWhitelist)(r.templateCell.formula)&&(u=(0,T.getTableNameByCellNode)(r),s=r.templateCell.formula),c=[],f={},(0,x.isNullOrUndefined)(u))e=r.templateCell.value;else{if(!(o=this.N3.getTable(u)))return[];D.DataManagerReportSortHelper.parseSortOptionsToSorts(r.templateCell),a=(this.Rle.getTableNameCacheFromParent(r)||u).toUpperCase(),h=this.Rle.getRelationshipsMap()[r.relationshipMapKey],i.forEach(function(t){var t=h[t]&&h[t][a];void 0===t||f[t]||(c.push(t),f[t]=!0)}),l=c.map(function(t){return o.getValueByField(s,t)}),e=this.Zle(l,r)}for(d={value:e,leftParent:t,upParent:n,childrenArray:[],crossChildren:[],recordRowNumbers:i,cellNode:r,state:"normal",Qle:f},0!==c.length||(0,x.isNullOrUndefined)(u)||(d.defaultFormula=(0,T.generateDefaultFormulaByTemplateCell)(r.templateCell),d.state="new"),v=0,p=r.children;v<p.length;v++)m=b=void 0,(w=p[v]).leftParent===r?b=d:w.upParent===r&&(m=d),b=this.Ule(b,m,i,w,o),d.childrenArray.push(b);return r.data.groups.push(d),[d]},e.prototype.Yle=function(h,l,d,v){var u,t,n,t,p,w,s,n,b,t,m,i,r,e,o,c,f,a,j,y,g,_,t,n,t,O,S,C,R,F,I,N,M,E,M,u=this,p=[],w=v.templateCell,s=w.dataSetting,n=s.type;if(w.dataColumn?(t=w.dataColumn.tableName,m=w.dataColumn.columnName):w.formula&&"No"!==w.expansionDirection&&(0,T.isFormulaInWhitelist)(w.formula)&&(t=(0,T.getTableNameByCellNode)(v),m=w.formula),(0,x.isNullOrUndefined)(t))p.push({value:w.value,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:v,state:"normal",sortValues:[v.templateCell.value],Qle:{}});else{if(!(b=this.N3.getTable(t)))return[];if(D.DataManagerReportSortHelper.parseSortOptionsToSorts(w),i=(this.Rle.getTableNameCacheFromParent(v)||t).toUpperCase(),r=this.Rle.getRelationshipsMap()[v.relationshipMapKey],e=[],o=[],c={},f=[],!d){for(a=r.length,j=[],y=0;y<a;)j.push(y++);d=j}d.forEach(function(t){var n,n,n=null==(n=r[t])?void 0:n[i];void 0!==n&&(e.push(n),c[n]||(o.push(n),c[n]=!0),f[n]||(f[n]=[]),f[n].push(t))}),0===d.length?p.push({value:void 0,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[],cellNode:v,state:"new",sortValues:[],Qle:{},defaultFormula:(0,T.generateDefaultFormulaByTemplateCell)(w)}):"Group"===n?(e.forEach(function(c,f){for(var t,a,n,n,i,r,e,o,n=b.getValueByField(m,c),n=[{value:n,advancedGroupSortName:n}],i=function(n){var t,i,t,r,e,o,u,s,i=n.advancedGroupSortName+"",t=p.find(function(t){return t.value===n.value});if(t)t.recordRowNumbers.push(d[f]),t.Qle[c]||(t.Qle[c]=!0);else{if(r=[],null!=(a=w.Kle)&&a.length)for(e=0,o=w.Kle;e<o.length;e++)u=o[e],(s=void 0,x.isNullOrUndefined)(u.column)||(s=b.getValueByField(u.column,c)),r.push(s);p.push({value:n.value,Jle:i,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:[d[f]],cellNode:v,state:"normal",sortValues:r,Qle:((t={})[c]=!0,t)})}},r=0,e=n=null!=(t=s.bins)&&t.length?u.Lle.getAdvancedGroupValue(b,c,s):n;r<e.length;r++)i(o=e[r])}),null!=(t=s.bins)&&t.length&&(g={},_={},p.forEach(function(t){_[t.Jle]=!0}),s.bins.forEach(function(t,n){var n,i;g[t.caption]=n,n=t.caption,_[t.caption]||!0!==t.alwaysVisible||p.push(i={value:n,Jle:n,recordRowNumbers:[],childrenArray:[],leftParent:h,upParent:l,crossChildren:[],state:"new",cellNode:v,sortValues:[],Qle:{}})}),p.sort(function(t,n){var i,r;return g[t.Jle+""]-g[n.Jle+""]}))):"List"===n?o.forEach(function(t,n){var i,i,r,e,o,u,s,c,r=b.getValueByField(m,t),e=[];if(null!=(i=w.Kle)&&i.length)for(o=0,u=w.Kle;o<u.length;o++)s=u[o],(c=void 0,x.isNullOrUndefined)(s.column)||(c=b.getValueByField(s.column,t)),e.push(c);p.push({value:r,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:f[t],cellNode:v,state:"normal",sortValues:e,Qle:((i={})[t]=!0,i)})}):(t=o.map(function(t){return b.getValueByField(m,t)}),n=w.dataSetting,t=(0,T.calc)(t,n.aggregation),p.push({value:t,leftParent:h,upParent:l,childrenArray:[],crossChildren:[],recordRowNumbers:d,cellNode:v,state:"normal",sortValues:[t],Qle:c}))}for(O=0,S=p;O<S.length;O++)for(R=(C=S[O]).recordRowNumbers,F=0,I=v.children;F<I.length;F++)E=M=void 0,(N=I[F]).leftParent===v?M=C:N.upParent===v&&(E=C),M=this.Ule(M,E,R,N,b),C.childrenArray.push(M);return null!=(n=this.Ble)&&n.sortGroupsBySortCondition(p,v,null==(t=this.DJ)?void 0:t.cellNodeGetter),p.forEach(function(t){v.data.groups.push(t)}),p},e.prototype.Zle=function(t,n){var n,i,n=n.templateCell.dataSetting;return n&&"Group"===n.type?(i=[],t.forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),1<i.length?i:i[0]):"List"===n.type?t.map(function(t){return t}):(0,T.calc)(t,n&&n.aggregation||"Sum")},n.DataManagerReportCrossHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js":function(t,n,i){"use strict";var l,M,A,_,r;function e(t,n,i,r){this.N3=t,this.DJ=n,this.Xle=new l.CalcSource(t.getCalcService()),this.$le={},this.XVe={},this.Ble=r,this.Rle=i}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportGroupHelper=void 0,l=i("CalcEngine"),M=i("./dist/src/dataManager.entry.js"),A=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),_=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),e.prototype.generateCellNodeTreeData=function(n,t,i,r,e,o,u){var s,c,f,a,h,f,l,c,c,d,v,p,w,b,m,j,y,g,s,g,f=this.N3,h=(0,A.getTableByCellNode)(f,n),f=[],l={};if(n.templateCell.dataColumn?a=n.templateCell.dataColumn.columnName:n.templateCell.formula&&(0,A.isFormulaInWhitelist)(n.templateCell.formula)?a=n.templateCell.formula:(c=this.the(t,i),c={value:n.templateCell.value,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:t,upParent:i,crossChildren:[],state:"normal",cellNode:n,sortValues:[],valuePath:c+"/"+n.templateCell.value},f.push(c)),!h&&0===f.length)return[];for(_.DataManagerReportSortHelper.parseSortOptionsToSorts(n.templateCell),d=this.Rle&&this.Rle.generateRelationshipMapKeyByCellNode(n),p=f=(v=0)===f.length?this.Qqn(l,n,h,a,d,t,i,r,e,o,u):f;v<p.length;v++)for(b=(w=p[v]).recordRowNumbers,m=0,j=n.children;m<j.length;m++)(y=j[m]).leftParent&&y.upParent?w.childrenArray.push([]):(s=g=void 0,y.leftParent?g=w:y.upParent&&(s=w),g=this.generateCellNodeTreeData(y,g,s,b,h,d,u),w.childrenArray.push(g),null!=(s=y.slices)&&s.forEach(function(t){delete t.groupMapCache,delete t.groupsCache}));return null!=(c=this.Ble)&&c.sortGroupsBySortCondition(f,n,this.DJ&&this.DJ.cellNodeGetter),f.forEach(function(t){return n.data.groups.push(t)}),f},e.prototype.clearCache=function(t){t&&(this.Xle=null,this.$le=void 0,this.XVe=void 0)},e.prototype.Qqn=function(t,r,n,i,e,o,u,s,c,f,a){var h,l,d,v,h,p,w,l,b,m,j,l,y,g,b,_,O,S,d=[],v={},h=null==(h=this.Rle)?void 0:h.getRelationshipsMap(),p=r.templateCell,w=p.dataSetting;if(e&&h&&h[e]||s)if(l=0===(null==(l=null==h?void 0:h[e])?void 0:l.length),b=!c&&s&&0===s.length,l||b?s=void 0:void 0!==f&&e!==f&&s&&s.length&&(s=this.zle(r,s,n,c,e,f,o||u)),m=s?s.length:e?h[e].length:0,j=this.the(o,u),w&&"Summary"===w.type)d=this.nhe(r,n,i,s,e,o,u,j);else{if(0===m)l={value:void 0,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:o,upParent:u,crossChildren:[],state:"new",cellNode:r,sortValues:[],valuePath:j+"/",defaultFormula:(0,A.generateDefaultFormulaByTemplateCell)(p)},d.push(l);else{for(y=0;y<m;y++)g=s?s[y]:y,this.ehe(d,t,v,r,n,i,g,e,o,u,j,a);"No"===p.expansionDirection&&(_=(b=d[0])&&Array.isArray(b.value))&&(b.Jle=b.Jle.toString(),b.valuePath+=b.value.toString())}w&&"Group"===w.type&&w.bins&&w.bins.length&&(O={},S={},d.forEach(function(t){S[t.Jle]=!0}),w.bins.forEach(function(t,n){var n,i;O[t.caption]=n,n=t.caption,S[t.caption]||!0!==t.alwaysVisible||d.push(i={value:n,Jle:n,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:o,upParent:u,crossChildren:[],state:"new",cellNode:r,sortValues:[],valuePath:j+"/"+n})}),d.sort(function(t,n){var i,r;return O[t.Jle+""]-O[n.Jle+""]}))}return d},e.prototype.ehe=function(c,f,a,h,t,n,l,i,d,v,p,w){var b,r,e,r,n,m,o,r,e,j,e,y,i,g,u,s,_,O,S,C,e,R,F,I,N,b=this,o,r=(null==(r=this.Rle)?void 0:r.getTableNameCacheFromParent(h))||(null==t?void 0:t.name),e=null==(e=this.Rle)?void 0:e.getRelationshipsMap(),j=e?e[i][l][r.toUpperCase()]:l;if(void 0!==j){if(e=t.getValueByField(n,j),y=[{value:e,advancedGroupSortName:e}],i=h.templateCell.dataSetting,g=[],null!=(r=h.templateCell.Kle)&&r.length)for(u=0,s=h.templateCell.Kle;u<s.length;u++)S=(_=s[u]).column,C=_.formula,(O=void 0,M.isNullOrUndefined)(S)?(0,M.isNullOrUndefined)(C)||(O=t.getValueByField(C,j)):O=t.getValueByField(_.column,j),g.push(O);for(i&&"Group"===i.type&&(null!=(n=i.bins)&&n.length||i.formula)&&(y=this.getAdvancedGroupValue(t,j,i),e=(e=h.templateCell.Hle)||(h.templateCell.Hle=[]),R=(R=e[j])||(e[j]=[]),y.forEach(function(t){var t=t.value+"";-1===R.indexOf(t)&&R.push(t)})),F=i&&"List"===i.type,I=function(t){var t,n,i,u,r,e,o,s,t=y[t],n=t.value,i=t.advancedGroupSortName,u=f[n];u&&!F||(r=!0,F&&(u=a[j])&&(r=!1),"No"===h.templateCell.expansionDirection&&(u=c[0])&&(r=!1,e=u.value,o=u.Jle,Array.isArray(e)||(e=[u.value]),Array.isArray(o)||(o=[u.Jle]),u.Qle[j]||(e.push(t.value),o.push(t.advancedGroupSortName)),u.value=e,u.Jle=o,u.valuePath=p+"/",f[n]=u),r&&(u={value:t.value,Jle:i,recordRowNumbers:[],Qle:{},childrenArray:[],leftParent:d,upParent:v,crossChildren:[],state:"normal",cellNode:h,valuePath:p+"/"+t.value+(F?"/"+j:""),sortValues:g,slices:[]},c.push(u),f[n]=u,F)&&(a[j]=u)),null!=(m=h.slices)&&m.length&&(s=u.value,h.slices.forEach(function(t,n){var i,r,e,i,r,o,i=t.groupsCache,r=t.groupMapCache,e=(e=(i=i||(t.groupsCache={}))[s+""])||(i[s+""]=[]),i=(i=(r=r||(t.groupMapCache={}))[s+""])||(r[s+""]={}),r=t.templateCell.dataColumn.tableName,o=t.templateCell.dataColumn.columnName;b.ehe(e,i,a,t,b.N3.getTable(r),o,j,void 0,void 0,void 0,""),void 0===u.slices[n]&&(u.slices[n]={childrenArray:[e]})})),u.recordRowNumbers.push(l),null!=w&&w.ignoreMultipleTableJoinCache||u.Qle[j]||(u.Qle[j]=!0)},N=0;N<y.length;N++)I(N)}},e.prototype.the=function(t,n){var i,r,t,i="";return t?(r=(0,M.isNullOrUndefined)(t.value)?"":t.value,i=void 0!==t.valuePath?t.valuePath:r.toString()):n&&(t=(0,M.isNullOrUndefined)(n.value)?"":n.value,i=void 0!==n.valuePath?n.valuePath:t.toString()),i},e.prototype.nhe=function(t,n,i,r,e,o,u,s){for(var c,c,f,a,h,l,d,v,p,w,b,m,j,c,c,y,f=t.templateCell.dataSetting,a=null==(c=this.Rle)?void 0:c.getRelationshipsMap(),h=(r||a[e]).length,l=[],d=[],v={},p,w=((null==(c=this.Rle)?void 0:c.getTableNameCacheFromParent(t))||(null==n?void 0:n.name)).toUpperCase(),b=0;b<h;b++)m=r?r[b]:b,j=a?a[e][m][w]:m,l.push(m),v[j]||(d.push(j),v[j]=!0);return c=d.map(function(t){return n.getValueByField(i,t)}),c=(0,A.calc)(c,(null==f?void 0:f.aggregation)||"Sum"),[y={value:c=(0,M.isNullOrUndefined)(c)?0:c,Jle:"",recordRowNumbers:l,Qle:v,childrenArray:[],leftParent:o,upParent:u,crossChildren:[],state:"normal",cellNode:t,valuePath:s+"/"+c,sortValues:[],slices:[]}]},e.prototype.zle=function(t,i,n,r,e,o,u){var s,s,c,f,a,o,h,s,l,t,d,t,v,p,v,w,b,m,j,y,g,_,O,S,C,R,F,I,I,N,M,E,x,T,D,s=this.Rle.getRelationshipsMap(),c=s[e],f=s[o],a=r.name,o=null==(s=t.templateCell.ihe)?void 0:s.condition,h=[],s=u.cellNode,l=u.valuePath,t="".concat(e,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col),d=this.$le[t];if(d=d||(this.$le[t]=[]),t=null==c?void 0:c[0],v=n.name.toUpperCase(),p=a.toUpperCase(),v=(null==t?void 0:t.hasOwnProperty(v))&&t.hasOwnProperty(p),o){if(v){if((w=this.rhe(e,a=p))&&f){for(b=[],m=[],j=[],y=0,g=i;y<g.length;y++)if(!j[O=f[_=g[y]][a]]&&(S=w[O]))for(j[O]=!0,C=0,R=S;C<R.length;C++)m[F=R[C]]||(null!=(I=d[F])&&I[l]?b.push(F):(void 0===(I=h[F])&&(I=this.ohe(c[F],u),h[F]=I),I&&(b.push(F),m[F]=!0,d[F]||(d[F]={}),d[F][l]=!0)));return b}}else if(n===r){if(N=[],c)return M=this.Rle.getTableNameCacheFromParent(s),E=(0,A.toUpperCase)(M||r.name),c.forEach(function(t,n){-1!==i.indexOf(t[E])&&N.push(n)}),N}else if(n!==r)return null}else if(n===r){if(b=[],f){for(M=this.Rle.getTableNameCacheFromParent(s),x=(0,A.toUpperCase)(M||r.name),T=0,D=i;T<D.length;T++)_=D[T],b.push(f[_][x]);return b}}else if(n!==r)return null;return i},e.prototype.rhe=function(t,n){var i,r,e,o,u,s,c,f,a,i=n+"__TO__"+t;if(this.XVe[i])return this.XVe[i];if(e=(r=this.Rle.getRelationshipsMap())[t]){for(o=[],c=s=u=void 0,n=n.toUpperCase(),f=0,a=e.length;f<a;f++)(c=o[s=(u=e[f])[n]])||(o[s]=c=[]),c.push(f);return this.XVe[i]=o}},e.prototype.getAdvancedGroupValue=function(t,n,i){var r,e,o,i,o,u,s,c,f,a,h,h,h,r=this.N3,e=[],o=i.formula,i=i.bins;if(o)(o=o.trim()).startsWith("=")||(o="="+o),o=t.getValueByField(o,n),e.push({value:o,advancedGroupSortName:o});else if(i)for(u=0,s=i;u<s.length;u++)if(f=(c=s[u]).caption,a=c.groupBy){if("string"==typeof a)if((h=r.getCalcService().parse(this.Xle,a,0,0)).type===l.ExpressionType.name){if(h=(0,A.fieldExpressionToField)(h.value),e.push({value:t.getValueByField(h,n),advancedGroupSortName:f}),!1!==c.stopIfTrue)break}else if((h=t.getValueByField(a,n,!0))&&!(h instanceof l.CalcError)&&(e.push({value:f,advancedGroupSortName:f}),!1!==c.stopIfTrue))break}else if(0===e.length&&(e.push({value:c.caption,advancedGroupSortName:c.caption}),!1!==c.stopIfTrue))break;return e},e.prototype.ohe=function(t,n,i){var r,e,o,u,s,c,r,r,i,f,o,e=n.cellNode,o=this.Rle.getTableNameCacheFromParent(e)||(0,A.getTableNameByCellNode)(e,!0)||e.templateCell.value+"";return o=o.toUpperCase(),u=this.N3.getTable(o),s=t[o],c=!1,r=null==(r=this.Rle)?void 0:r.getRelationshipsMap(),null!=i&&i.relationshipMapKey&&r[i.relationshipMapKey]&&(r=r[i.relationshipMapKey][0])&&(i=(this.Rle.getTableNameCacheFromParent(i)||(0,A.getTableNameByCellNode)(i,!0)||i.templateCell.value+"").toUpperCase(),c=!(r.hasOwnProperty(o)&&r.hasOwnProperty(i))),void 0===s&&u?c:!(!(f=n.Qle)[s]&&u)&&(!(o=n.leftParent||n.upParent)||this.ohe(t,o,e))},e.prototype.generateParentPaths=function(i,t){var r,n,e,o,n,u,e,s,c,f,a,h,s,s,l,d,v,r=[],n=i.templateCell,e=n.dataColumn,o=n.dataSetting,n=n.expansionDirection,u=this.Rle.getTableNameCacheFromParent(i)||(null==e?void 0:e.tableName),e=null==e?void 0:e.columnName,s=null==u;return s&&(e=i.templateCell.formula||i.templateCell.value+"",u=(0,A.getTableNameByCellNode)(i,!0)||i.templateCell.value+""),u=null==u?void 0:u.toUpperCase(),c=t[u],(0,M.isNullOrUndefined)(c)?r=s?["/"+i.templateCell.value]:(s=i.data.groups.map(function(t){return"/"+t.value}),s=o&&"List"===o.type?s.map(function(t,n){return"".concat(t,"/").concat(i.data.groups[n].recordRowNumbers[0])}):s):(f=void 0,(f=i.templateCell.Hle?i.templateCell.Hle[c]||[]:(a=void 0,[a="No"===n?null==(s=(h=i.data.groups).filter(function(t){return t.Qle[c]})[0])?void 0:s.value.toString():this.N3.getTable(u).getValueByField(e,c)])).forEach(function(t){r.push("/"+t)}),o&&"List"===o.type&&r.forEach(function(t,n){r[n]+="/".concat(c)})),i.leftParent?(l=this.generateParentPaths(i.leftParent,t),d=[],l.forEach(function(n){r.forEach(function(t){d.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),d):i.upParent?(l=this.generateParentPaths(i.upParent,t),v=[],l.forEach(function(n){r.forEach(function(t){v.push(void 0===t||void 0===n?void 0:"".concat(n).concat(t))})}),v):r},n.DataManagerReportGroupHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js":function(t,n,i){"use strict";var H,S,F,o,u,s,r;function e(t,n){var i,r,e;if(this.hhe={},this.tTe=[],this.N3=t,this.DJ=n,this.Xle=new o.CalcSource(t.getCalcService()),this.vhe={},this.mhe=[],this.ghe={},null!=n&&n.parameter){for(e in i={},r=n.parameter)r.hasOwnProperty(e)&&(i[e.toUpperCase()]=r[e]);this.ghe=i}}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportJoinHelper=void 0,H=i("./dist/src/dataManager.entry.js"),S=i("./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js"),F=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),o=i("CalcEngine"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),s=/\[@([^\]]+\.[^\]]+)\]/i,e.prototype.generateJoinRelationIndexMap=function(t){var t,t,t,t=this.phe(t),t=this.bhe(t),t=this.yhe(t);this.whe(t)},e.prototype.clearCache=function(t){this.vhe={},t&&(this.Xle=null,this.hhe={},this.tTe=[])},e.prototype.setNodeTableCache=function(t,n,i){void 0===this.mhe[t]&&(this.mhe[t]=[]),this.mhe[t][n]=i},e.prototype.Mhe=function(t,n){return this.mhe[t]&&this.mhe[t][n]},e.prototype.getTableNameCacheFromParent=function(t){var n,i,r,e,n=t.relationshipMapKey,i=this.Mhe(t.templateCell.row,t.templateCell.col);if(i)return i;for(r=t.leftParent&&t.upParent,e=t.leftParent||t.upParent;!r&&e&&e.relationshipMapKey===n;){if(i=this.Mhe(e.templateCell.row,e.templateCell.col))return i;r=t.leftParent&&t.upParent,e=e.leftParent||e.upParent}},e.prototype.getRelationshipsMap=function(){return this.hhe},e.prototype.relationshipGraphs=function(t){if(!t)return this.tTe;this.tTe=t},e.prototype.getRelationshipGraphTableIndex=function(t){var n,i,r,n=this.relationshipGraphs(),i=t&&t.name;if(n&&void 0!==i)for(i=i.toUpperCase(),r=0;r<n.length;r++)if(n[r].tables.find(function(t){return t.name.toUpperCase()===i}))return r;return-1},e.prototype.generateRelationshipMapKeyByCellNode=function(t){var n,i,r,e,o,u,o,n,s,c,i,f,a,h,a,h,l,i,f,f,h;if(t)return t.relationshipMapKey||(e=t.leftParent||t.upParent,o=t.leftParent&&t.upParent,u=(0,F.getTableNameByCellNode)(t,!(r=""))||t.templateCell.value+"",r=o?(o=u,this.Che(t),s=void 0,(n=(null==(n=t.templateCell.filter)?void 0:n.condition)||t.templateCell.ihe)&&(c=t.templateCell.ihe.condition,s=this.She(c),o=this.The(s,o,t)),i=this.Ahe(t.leftParent),f=this.Ahe(t.upParent),i||f?i&&f?(a=this.generateRelationshipMapKeyByCellNode(t.leftParent),h=this.generateRelationshipMapKeyByCellNode(t.upParent),"".concat(a,"__CROSS__").concat(o,"__CROSS__").concat(h)):(a=void 0,h=this.generateRelationshipMapKeyByCellNode(t.leftParent),l=this.generateRelationshipMapKeyByCellNode(t.upParent),f=f?l:h,a=-1<(i=i?h:l).indexOf(u)?i:-1<f.indexOf(u)?f:h||l||u,n?this.The(s,a,t):a):o):(this.Che(t),(null!=(i=t.templateCell.filter)&&i.condition||t.templateCell.ihe)&&(e&&!(r=e.relationshipMapKey)&&(e.relationshipMapKey=r=this.generateRelationshipMapKeyByCellNode(e)),c=t.templateCell.ihe.condition,f=this.She(c),r=this.The(f,r=r||u,t)),r||(this.Ahe(e)?-1<(h=this.generateRelationshipMapKeyByCellNode(e)).indexOf(u)?h:"".concat(h,"__AND__").concat(u):u)),t.relationshipMapKey=r)},e.prototype.The=function(t,i,r){var n,e,o,t,n=this,e=t.rules,o=t.relation,t=t.conditions;return e.forEach(function(t){var n,n,n;i=(0,H.isNullOrUndefined)(t.formula)?"Cell"===t.value.type||"DataColumn"===t.value.type?"object"==typeof t.value.data&&t.value.data.tableName?(0,F.toUpperCase)(i+"__"+o+"__"+(0,H.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.tableName,t.value.data.columnName)):"object"==typeof t.value.data&&t.value.data.formulaTableName?(0,F.toUpperCase)(i+"__"+o+"__"+(0,H.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data.formulaTableName)):(0,F.toUpperCase)(i+"__"+o+"__"+(0,H.combineName)(null!=(n=t.tableName)?n:r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,F.toUpperCase)(i+"__"+o+"__"+(0,H.combineName)(r.templateCell.dataColumn.tableName,t.column,t.operator,t.value.data)):(0,F.toUpperCase)(i+"__"+o+"__"+t.formula)}),t&&t.forEach(function(t){i=n.The(t,i,r)}),i},e.prototype.phe=function(t){var n=[];return(0,F.traverse)(t,n),n},e.prototype.bhe=function(t){var o,n,o=this,n=[];return t.forEach(function(t){var e=[];t.forEach(function(t){var n,i,r,i=t.templateCell;o.Che(t),null!=(n=i.ihe)&&n.condition&&(r=o.She(i.ihe.condition)),e.push({reportDataTableRelation:r,currentNode:t})}),n.push(e)}),n},e.prototype.parseFilterOptionToFilterConditionTree=function(t){var n,i,r,e,o,u,s,c,f,a,h,n="And",i=[],r=[];if((0,F.hasOrCondition)(t))for(n="Or",o=0,u=e=t.or;o<u.length;o++)s=u[o],(0,F.isSimpleFilterCondition)(s)?i.push(this.Ihe(s)):r.push(this.parseFilterOptionToFilterConditionTree(s));else if((0,F.hasAndCondition)(t))for(f=0,a=c=t.and;f<a.length;f++)h=a[f],(0,F.isSimpleFilterCondition)(h)?i.push(this.Ihe(h)):r.push(this.parseFilterOptionToFilterConditionTree(h));else i.push(this.Ihe(t));return{rules:i,conditions:r,relation:n}},e.prototype.Ihe=function(t){var n,i,i;return t.operator||void 0===t.formula?((0,H.isNullOrUndefined)(t.value)||(i=t.value,n={type:(0,F.getValueType)(i),data:i}),(0,H.isNullOrUndefined)(t.cell)||(n={type:"Cell",data:i="string"==typeof(i=t.cell)&&i.startsWith("=")?i.substring(1):i}),(0,H.isNullOrUndefined)(t.dataColumn)||(n={type:"DataColumn",data:i=t.dataColumn}),(0,H.isNullOrUndefined)(t.parameter)||(n={type:"Parameter",data:i=t.parameter}),(0,H.isNullOrUndefined)(t.formula)||(n={type:"Formula",data:i=void 0===(i=t.formula)||(i=i.trim()).startsWith("=")?i:"="+i}),{tableName:t.tableName,column:t.column,operator:t.operator,value:n}):{formula:i=void 0===(i=t.formula)||(i=i.trim()).startsWith("=")?i:"="+i}},e.prototype.She=function(t){var n,i,r,e,o,n=this.xhe(t.rules),i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)o=e[r],i.push(this.She(o));return{rules:n,conditions:i,relation:t.relation}},e.prototype.xhe=function(t){var o,u,s,o=this,u=[],s=this.N3;return t.forEach(function(t){var n,i,n,r,e,e;(0,H.isNullOrUndefined)(t.formula)?("Cell"===(i={tableName:t.tableName,column:t.column,operator:t.operator,value:{type:t.value.type,data:t.value.data}}).value.type&&"string"==typeof i.value.data&&F.cellNameReg.test(i.value.data)&&o.DJ.cellNodeGetter&&((r=(n=o.DJ.cellNodeGetter(i.value.data))&&n.templateCell)?r.formula&&"No"!==r.expansionDirection&&(0,F.isFormulaInWhitelist)(r.formula)?(e=(0,F.getFormulaResult)(s.getCalcService(),o.Xle,r.formula),i.value.data={formulaResult:e,formulaString:r.formula,formulaTableName:(0,F.getTableNameByCellNode)(n)}):r.dataColumn?i.value.data=r.dataColumn:i.value.data=r.value:i.value.data=""),"Parameter"===i.value.type&&"string"==typeof i.value.data&&o.ghe&&(e=o.ghe[i.value.data.toUpperCase()],i.value.type=(0,F.getValueType)(e),i.value.data=e),"Formula"===i.value.type&&"string"==typeof i.value.data&&(i.value.data=(0,F.lbe)(o.N3.getCalcService(),o.Xle,i.value.data,o.ghe)),u.push(i)):((n=t.formula.trim()).startsWith("=")||(n="="+n),u.push({formula:n}))}),u},e.prototype.yhe=function(t){var e,n,e=this,n=[];return t.forEach(function(t){var r=[];t.forEach(function(t){var n,i,n,n=t.reportDataTableRelation;n&&(i=e.Nhe(n,t.currentNode)),n={currentNode:t.currentNode,relations:i},r.push(n),e.hbe(t.currentNode)}),n.push(r)}),n},e.prototype.hbe=function(t){var n,i,t,r,e,n=this,t=t.templateCell;"Group"===(null==(i=null==t?void 0:t.dataSetting)?void 0:i.type)&&void 0!==(r=t.dataSetting.formula)&&(t.dataSetting.formula=(0,F.lbe)(this.N3.getCalcService(),this.Xle,t.dataSetting.formula,this.ghe)),u.DataManagerReportSortHelper.parseSortOptionsToSorts(t),null!=t&&t.Kle&&(e=t.Kle).forEach(function(t){void 0!==t.formula&&(t.formula=(0,F.lbe)(n.N3.getCalcService(),n.Xle,t.formula,n.ghe))})},e.prototype.Nhe=function(t,n){var i,r,e,o,i=[];if(t.conditions)for(r=0,e=t.conditions;r<e.length;r++)o=e[r],i.push(this.Nhe(o,n));return{rules:this.khe(t.rules,n),relation:t.relation,conditions:i}},e.prototype.khe=function(t,n){var r,e,o,r=this,e=[],o=(0,F.getTableNameByCellNode)(n);return t.forEach(function(t){var n,i,n,t,n,t,i=t.formula;t.column&&-1!==t.column.indexOf("[@")&&!t.column.startsWith("=")&&(t.column="="+t.column),(0,H.isNullOrUndefined)(i)?"Cell"!==t.value.type&&"DataColumn"!==t.value.type||"object"!=typeof t.value.data||(0,H.isNullOrUndefined)(t.value.data)?e.push({type:"Static",field:t.column,operator:t.operator,value:t.value.data,valueType:t.value.type}):t.value.data.tableName?e.push({type:"Join",relationHostTable:null!=(n=t.tableName)?n:o,relationHostColumn:t.column,relationTargetTable:t.value.data.tableName,relationTargetColumn:t.value.data.columnName,relationCondition:t.operator}):t.value.data.formulaString&&e.push({type:"Join",relationHostTable:o,relationHostColumn:t.column,relationTargetTable:t.value.data.formulaTableName,relationTargetColumn:t.value.data.formulaString,relationCondition:t.operator}):(i.startsWith("=")||(i="="+i),(n=(i=(0,F.lbe)(r.N3.getCalcService(),r.Xle,i,r.ghe)).match(s))?(n=(t=n[1].split("."))[0],t=t[1],e.push({type:"Join",formula:i,relationHostTable:o,relationTargetTable:n,relationTargetColumn:t})):e.push({type:"Static",formula:i}))}),e},e.prototype.whe=function(t){var s,c,s=this,c=this.N3;t.forEach(function(t){t.forEach(function(t){var n,i,r,e,o,u,n=t.currentNode,i=(0,F.getTableByCellNode)(c,n),r=t.relations&&(t.relations.rules.length||t.relations.conditions.length),e=n.leftParent&&n.upParent&&"V"===s.currentTreeDirection,o=(0,F.isCellInCrossCell)(n)&&"V"===s.currentTreeDirection;r?(u=s.generateRelationshipMapKeyByCellNode(n),s.hhe[u]&&0!==s.hhe[u].length&&!o||(s.hhe[u]=s.Dhe(t.relations,n))):e?(u=s.generateRelationshipMapKeyByCellNode(n),s.hhe[u]&&0!==s.hhe[u].length||(s.hhe[u]=s.dbe(n))):i&&s._he(i,n)})})},e.prototype.Dhe=function(t,n){var i,r,t,e,o,u,s,c,f,a,h,l,d,v,p,a,l,h,w,b,m,j,j,y,g,_,O,S,C,R,j,i=t.rules,r=t.relation,t=t.conditions;if((0,F.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection)return[];for(e=this.N3,o=[],u=[],s=0,c=i;s<c.length;s++)"Join"===(f=c[s]).type?(a=f.relationHostTable,h=f.relationHostColumn,l=f.relationTargetTable,d=f.relationTargetColumn,v=f.relationCondition,p=f.formula,a=e.getTable(a),l=e.getTable(l),a&&l&&(h=this.buildTableRelationshipMap(a,h,p||v,l,d),o.push({sourceTable:a,targetTable:l,sourceFieldIndexMap:h.sourceFieldIndexMap,targetFieldIndexMap:h.targetFieldIndexMap}))):u.push(f);if(b=!1,n.leftParent&&n.upParent&&"V"===this.currentTreeDirection?o.length?b=!0:w=this.dbe(n):(m=(0,F.getTableByCellNode)(e,n))&&(j="H"===this.currentTreeDirection?n.upParent:n.leftParent,w=(j=this.hhe[j&&j.relationshipMapKey])&&j[0]&&j[0].hasOwnProperty(m.name.toUpperCase())?j:this._he(m,n,!0)),o.length?("And"!==r&&void 0!==r||(o=this.Ehe(o)),y=this.Ohe(o,n,r,i.filter(function(t){return"Join"===t.type})),b&&(w=[].concat(y))):y=w,u.length&&(y=this.Rhe(y,u,n,r,!!o.length,w)),_=i.length?[y]:[],null!=t&&t.length)for(O=void 0,S=0,C=t;S<C.length;S++)R=C[S],O=this.Dhe(R,n),_.push(O);return"And"===r||void 0===r?(j=(0,F.getTableNameByCellNode)(n),g=this.Lhe(_,j)):"Or"===r&&(g=this.Bhe(_,n)),g},e.prototype.dbe=function(t){var n,i,r,i,n,r;return(!t.leftParent||!t.upParent||"H"!==this.currentTreeDirection)&&(t.templateCell.dataColumn||!(0,H.isNullOrUndefined)(t.templateCell.formula)&&(0,F.isFormulaInWhitelist)(t.templateCell.formula))&&(n=this.getRelationshipsMap(),i=t.leftParent.relationshipMapKey,r=t.upParent.relationshipMapKey,i=n&&n[i]||[],n=n&&n[r]||[],i[0])&&n[0]?(r=(0,F.getTableNameByCellNode)(t),this.vbe(i,n,r)):[]},e.prototype.vbe=function(t,n,i){var r,e,o,o,u,s,e,c,r=Object.keys(t[0]),e=Object.keys(n[0]);return-1===r.indexOf(i)&&-1===e.indexOf(i)?(o=this.N3.getTable(i))?this.gbe(o):[]:(u=(o=r.length>e.length?t:n)===t?n:t,(c=1===(e=(s=r.length>e.length?r:e)===r?e:r).length&&-1<s.indexOf(e[0]))?this.Lhe([t,n],i):this.mbe(o,u,i))},e.prototype.mbe=function(r,u,t){var s,n,i,c,e,o,f,a,h,n,s=[],n=Object.keys(r[0]),i=Object.keys(u[0]),c=(0,F.getArraySameItems)(n,i);if(c.length)for(h in e=c[0],o={},f={},r.forEach(function(t,n){var t=t[e];o[t]||(o[t]=[]),o[t].push(n)}),u.forEach(function(t,n){var t=t[e];f[t]||(f[t]=[]),f[t].push(n)}),a=function(t){var n,i;o.hasOwnProperty(t)&&f[t]&&(n=o[t],i=f[t],n.forEach(function(t){var o=r[t];i.forEach(function(t){for(var n,i,r,e,t,t,n=u[t],i=!0,r=1;r<c.length;r++)if(e=c[r],o[e]!==n[e]){i=!1;break}i&&(t=Object.assign({},o),t=Object.assign(t,n),s.push(t))})}))},o)a(h);else(n=this.N3.getTable(t))&&(s=this.gbe(n));return s},e.prototype.Rhe=function(i,t,n,r,p,w){var e,o,b,m,j,y,u,s,c,f,a,h,l,d,v,g,_,O,e=n.templateCell.dataColumn.tableName.toUpperCase(),o=this.N3;if(i=[].concat(i),b=o.getTable(e),m=this.getTableNameCacheFromParent(n)||e,j=[],y=[],t.forEach(function(e){var o,t,u,n,s,c,f,a,h,l,n,d,v,o=e.field,t=e.operator,u=e.value,n=e.formula,s=e.valueType,f=!1,l=!1;(0,H.isNullOrUndefined)(t)?(0,H.isNullOrUndefined)(n)||(o=n,l=!0):"object"!=typeof u?c=S.ValueComparatorFactory.createComparator(t):(u instanceof Date||"Date"===s)&&(c=S.ValueComparatorFactory.createDateComparator(t),u=new Date(u),a=u.setHours(0,0,0,0),h=u.setHours(23,59,59,59),u=u.getTime(),f=!0),void 0!==o&&!b.hasField(o)&&-1<o.indexOf("@")&&!o.startsWith("=")&&(o="="+o),(c||l)&&(n=void 0,"And"===r||void 0===r?n=j[j.length-1]||i:"Or"===r&&(n=(n=y[y.length-1])||(p?w:i)),d=[],v=[],n.forEach(function(t){var n,i,r,n=!1,i=null==t?void 0:t[m];null!=i&&(r=null!=(r=b.getValueByField(o,i))?r:"",n=l?r:f?(r=new Date(r).getTime(),c(r,u,a,h)):("Formula"===s&&(u=b.getValueByField(e.value,i)),c(r,u))),(n?d:v).push(t)}),j.push(d),y.push(v))}),"And"===r||void 0===r)return j[j.length-1];if("Or"===r){for(u=[],s=0,c=j;s<c.length;s++)f=c[s],u=u.concat(f);if(p){for(a={},h=0,l=i;h<l.length;h++)v=(d=l[h])[e],(0,H.isNullOrUndefined)(v)||(a[v]=!0);for(g=0,_=u;g<_.length;g++)v=(O=_[g])[e],(0,H.isNullOrUndefined)(v)||a[v]||i.push(O);return i}return u}},e.prototype.Ehe=function(t){for(var n,i,r,e,o,u,s,n=[],i=[],r=[];t.length;){for(o=[e=t[0]],r=[0],u=1,s=t.length;u<s;u++)e.targetTable===t[u].targetTable&&(o.push(t[u]),r.push(u));for(n.push(e),1<o.length&&i.push(o),u=r.length-1;-1<u;u--)t.splice(r[u],1)}return this.Fhe(i),n},e.prototype.Fhe=function(t){for(var n,i,r,e,o,u,s,c,f,n=0,i=t;n<i.length;n++){for(o=(e=(r=i[n])[0]).sourceFieldIndexMap,u=e.targetFieldIndexMap,s=1,c=r.length;s<c;s++){for(f in o)o.hasOwnProperty(f)&&(o[f]=(0,F.getArraySameItems)(o[f],r[s].sourceFieldIndexMap[f]));for(f in u)u.hasOwnProperty(f)&&(u[f]=(0,F.getArraySameItems)(u[f],r[s].targetFieldIndexMap[f]))}e.sourceFieldIndexMap=o,e.targetFieldIndexMap=u}},e.prototype.buildTableRelationshipMap=function(i,t,r,e,o){var n,u,n,s,c,f,a,h,u,u,l,d,v,p,w,b,m,j,y,u,g,_,u,n=(0,H.isNullOrUndefined)(t)?t:i.getFieldByNameIgnoreCase(t),u=(0,H.isNullOrUndefined)(o)?o:e.getFieldByNameIgnoreCase(o);if(n&&(t=n.fieldName),u&&(o=u.fieldName),n=(0,F.toUpperCase)("".concat(i.name,"__").concat(t,"__").concat(r,"__").concat(e.name,"__").concat(o)),this.vhe[n])return this.vhe[n];function O(t,n,i){t[n]?t[n].push(i):t[n]=[i]}if(s=[],c=[],f=[],a=i.length(),h=e.length(),r.startsWith("=")){for(u="".concat(e.name,".").concat(o),u="\\[@".concat(u,"\\]"),l=new RegExp(u,"i"),d=function(t,n){var t=r.replace(l,'"'.concat(t,'"'));return i.getValueByField(t,n)},(v=e.hasField(o))||o.startsWith("=")||(o="="+o),p=0;p<h;p++)w=e.getValueByField(o,p),(0,H.isNullOrUndefined)(w)||O(f,w,p);for(b=Object.keys(f),m=function(n){var i=[];b.forEach(function(t){d(t,n)&&f[t].forEach(function(t){return i.push(t)})}),(s[n]=i).forEach(function(t){O(c,t,n)})},j=0;j<a;j++)m(j)}else{for(y=S.ValueComparatorFactory.createComparator(r),u=i.hasField(t),v=e.hasField(o),u||t.startsWith("=")||(t="="+t),v||o.startsWith("=")||(o="="+o),j=0;j<a;j++)w=i.getValueByField(t,j),(0,H.isNullOrUndefined)(w)||O(f,w,j);for(g=Object.keys(f),m=void 0,m="Equal"===r?function(n){var t,i,t,t=e.getValueByField(o,n);(0,H.isNullOrUndefined)(t)||(i=[],(t=f[t])&&t.forEach(function(t){return i.push(t)}),(c[n]=i).forEach(function(t){O(s,t,n)}))}:function(n){var i,r,i=e.getValueByField(o,n);(0,H.isNullOrUndefined)(i)||(r=[],g.forEach(function(t){y(t,i)&&f[t].forEach(function(t){return r.push(t)})}),(c[n]=r).forEach(function(t){O(s,t,n)}))},_=0;_<h;_++)m(_)}return u={sourceTable:i,targetTable:e,sourceFieldIndexMap:s,targetFieldIndexMap:c},this.vhe[n]=u},e.prototype.Ohe=function(t,P,k,n){var L,V,G,i,q,r,e,o,o,e,u,s,c,f,a,r,h,c,f,a,B,U,l,d,v,p,w,b,m,f,o,j,y,g,L=this,V=[],G=P.upParent&&P.leftParent,i=P.upParent||P.leftParent,q="";if(i&&(q=this.generateRelationshipMapKeyByCellNode(i),G))if(e=P.upParent,o=P.leftParent,o=this.generateRelationshipMapKeyByCellNode(o),e=this.generateRelationshipMapKeyByCellNode(e),u=this.hhe[o],s=this.hhe[e],u&&s&&u[0]&&s[0])c=Object.keys(u[0]),f=Object.keys(s[0]),a=c.length,r=f.length,h=[],t.forEach(function(t){var n=t.sourceTable.name.toUpperCase(),t=t.targetTable.name.toUpperCase();-1===h.indexOf(n)&&h.push(n),-1===h.indexOf(t)&&h.push(t)}),c=(0,F.getArraySameItems)(c,h).length,f=(0,F.getArraySameItems)(f,h).length,q=(a=a<r&&c||0===f)?o:e,r=(q=a&&0===c?void 0:q)===e?u:s;else{if(s&&s[0])return[];i=P.leftParent,q=this.generateRelationshipMapKeyByCellNode(i)}for(B=[],U=[],l=function(t,n){var i,r,e,o,u,s,c,r,o,f,a,h,l,d,v,p,w,b,m,j,y,g,_,O,S,C,R,F,I,N,M,E,x,T,D,A,r=t.sourceTable,e=t.sourceFieldIndexMap,o=t.targetTable,u=t.targetFieldIndexMap,s=r.name.toUpperCase(),c=o.name.toUpperCase();if(V=U[U.length-1]||V,e&&u){if(r=L.hhe[q],q&&r||U.length){if(f=c,a=u,h=s,(V=(o=V).length&&"And"===k?V:r)[0]&&void 0===V[0][f]&&(a=e,h=c,void 0===V[0][f=s]))return V=o,n||B.push(t),!1;for(d=[],v=0,p=(l=[].concat(V)).length;v<p;v++)d[w=l[v][f]]||(d[w]=[]),d[w].push(v);if(b=[],m=P.templateCell.row,j=P.templateCell.col,h=h.toUpperCase(),y=(0,H.combineName)(h,m,j),g=a.length,_=L.pbe(l,f,h,a)){for(O=0;O<g;O++)if(void 0!==(S=a[O])&&void 0!==(C=d[O]))for(I=F=R=0,N=S.length;I<N;I++)for(R=S[I],M=0,E=C.length;M<E;M++)F=C[M],void 0===(x=Object.assign({},l[F]))[h]?x[h]=R:(x[y]=R,L.setNodeTableCache(m,j,y)),b.push(x);V=b}}else{if(q&&!r&&G)return!0;for(O in V=[],u)if(u.hasOwnProperty(O))for(T=0,D=u[O];T<D.length;T++)A=D[T],V.push(((i={})[c]=+O,i[s]=A,i))}U.push(V)}},d=0,v=t;d<v.length&&!l(p=v[d]);d++);for(w=0,b=B;w<b.length&&!l(m=b[w],!0);w++);return"And"===k||void 0===k?V=this.Phe(U[U.length-1],n,P,"And"):"Or"===k&&(V=this.Phe(this.Bhe(U,P),n,P,"Or")),G&&V&&r&&V[0]&&r[0]&&(f=Object.keys(V[0]),o=Object.keys(r[0]),j=(0,F.getArraySameItems)(f,o),y=[],V.forEach(function(n,t){for(var i,r,e,o,u,i=j.map(function(t){return n[t]}),r=y,e=0,o=i;e<o.length;e++)r[u=o[e]]||(r[u]=[]),r=r[u];r.push(t),j.forEach(function(t){delete n[t]})}),g=[],r.forEach(function(e){for(var t,n,i,r,o,t=j.map(function(t){return e[t]}),n=y,i=0,r=t;i<r.length;i++)o=r[i],n=n&&n[o];n&&n.forEach(function(t){var n,i,r,n=V[t],i=Object.assign({},e);for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);g.push(i)})}),V=g,"And"===k||void 0===k?V=this.Phe(g,n,P,"And"):"Or"===k&&(V=this.Phe(g,n,P,"Or"))),V},e.prototype.pbe=function(t,n,i,r){for(var e,o,u,s,c,f,a,h,l,d,e={},o=0,u=t;o<u.length;o++)c=(s=u[o])[n],f=s[i],void 0!==c&&void 0!==f&&(e[c]||(e[c]={}),e[c][f]=!0);for(c in r)if(r.hasOwnProperty(c))for(a=r[c],h=e[c],l=0,d=a;l<d.length;l++)if(f=d[l],void 0===h||!h[f])return!0;return!1},e.prototype.Phe=function(t,n,i,r){var a,h,e,a=this;return t&&(h=this.getTableNameCacheFromParent(i),e=n.map(function(t){var n,i,r,e,o,t,u,s,c,f,n=t.relationHostColumn,i=t.relationTargetColumn,r=t.relationCondition,e=t.relationHostTable,o=t.relationTargetTable,t=t.formula;return(0,H.isNullOrUndefined)(t)?(u=S.ValueComparatorFactory.createComparator(r),e=e.toUpperCase(),o=o.toUpperCase(),s=a.N3.getTable(e),c=a.N3.getTable(o),f=(h||e).toUpperCase(),function(t){return u(s.getValueByField(n,t[f]),c.getValueByField(i,t[o]))}):null}),"And"===r?t=t.filter(function(t){for(var n,i,r,n=0,i=e;n<i.length;n++)if((r=i[n])&&!r(t))return!1;return!0}):"Or"===r&&(t=t.filter(function(t){for(var n,i,r,n=0,i=e;n<i.length;n++)if(!(r=i[n])||r(t))return!0;return!1}))),t},e.prototype.Lhe=function(r,e){var t,o,n,i,u,s,c,f,a,h,l,d,v,p;if(r.some(function(t){return t&&0===t.length}))return[];if(r.length<=1)return r[0]||[];if(void 0===e)return[];for(r.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),t=r[0],o=[],e=this.bbe(r,e),n=function(t,n){var i={};r[t].forEach(function(t){var t=t[e];void 0!==t&&(i[t]=!0)}),o.push(i)},i=0,u=r.length;i<u;i++)n(i,u);for(s=o[0],i=1,u=o.length;i<u;i++)for(f in c=o[i],s)s.hasOwnProperty(f)&&s[f]&&(c[f]||(s[f]=!1));for(a=[],h=new RegExp("^".concat(e,"(__\\d+__\\d+)?$")),l=function(n){var t=Object.keys(n),i=!0;t.forEach(function(t){var t;h.test(t)&&(t=n[t],i=i&&!(0,H.isNullOrUndefined)(t)&&s[t])}),i&&a.push(n)},d=0,v=t;d<v.length;d++)l(p=v[d]);return a},e.prototype.Bhe=function(t,n){var i,r,e,o,u,s,c,f,a,h;if((t=t.filter(function(t){return t.length})).length<=1)return t[0]||[];if(void 0===(i=(0,F.getTableNameByCellNode)(n)))return[];for(t.sort(function(t,n){return Object.keys(n[0]).length-Object.keys(t[0]).length}),r=t[0],e={},o=0,u=r;o<u.length;o++)c=(s=u[o])[i],(0,H.isNullOrUndefined)(c)||(e[c]=!0);for(f=1,a=t.length;f<a;f++)(h=t[f]).forEach(function(t){var n=t[i];(0,H.isNullOrUndefined)(n)||e[n]||(e[n]=!0,r.push(t))});return r},e.prototype.bbe=function(t,n){var t,t,t=t.map(function(t){return Object.keys(t[0])}),t=t.reduce(function(t,n){return(0,F.getArraySameItems)(t,n)},t[0]);return-1<t.indexOf(n)?n:t[0]},e.prototype._he=function(t,n,i){var r=this.generateRelationshipMapKeyByCellNode(n);return(0,F.isCellInCrossCell)(n)&&"H"===this.currentTreeDirection?[]:(this.hhe[r]&&!i||(this.hhe[r]=this.gbe(t)),this.hhe[r])},e.prototype.gbe=function(t){for(var n,i,r,e,o,n=[],i=t.name.toUpperCase(),r=0,e=t.length();r<e;r++)(o={})[i]=r,n.push(o);return n},e.prototype.Ahe=function(t){return!!t&&(this.Che(t),!!t.templateCell.ihe||this.Ahe(t.leftParent)||this.Ahe(t.upParent))},e.prototype.Che=function(t){var n,i,t,r,i,t,n=t.templateCell,i=n.filter&&n.filter.condition;n.ihe||(t=this.nTe(t),i&&t.push(i),t.length&&(i=(0,F.deepCloneFilterCondition)(r={and:t}),t=this.parseFilterOptionToFilterConditionTree(i),n.ihe={condition:t}))},e.prototype.nTe=function(t){var n,i,r,e,i,o,u,s,c,f,a,n,h,r=[],e=[],i=this.N3,o=(0,F.getTableByCellNode)(i,t),u=null==o?void 0:o.table();return t.leftParent&&(c=null==(s=(0,F.getTableByCellNode)(i,t.leftParent))?void 0:s.table())!==u&&(f=this.getRelationshipGraphTableIndex(o),a=this.getRelationshipGraphTableIndex(s),n=null==(n=this.relationshipGraphs()[a])?void 0:n.tableToTableRelationPath,f===a)&&n&&(h=n[u.name.toUpperCase()][c.name.toUpperCase()])&&h.forEach(function(t){var n;-1===e.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},r.push(n),e.push(t))}),t.upParent&&(c=null==(s=(0,F.getTableByCellNode)(i,t.upParent))?void 0:s.table())!==u&&(f=this.getRelationshipGraphTableIndex(o),a=this.getRelationshipGraphTableIndex(s),n=null==(i=this.relationshipGraphs()[a])?void 0:i.tableToTableRelationPath,f===a)&&n&&(h=n[u.name.toUpperCase()][c.name.toUpperCase()])&&h.forEach(function(t){var n;-1===e.indexOf(t)&&(n={tableName:t.sourceTable.name,column:t.sourceFieldName,operator:"Equal",dataColumn:{tableName:t.targetTable.name,columnName:t.targetFieldName}},r.push(n),e.push(t))}),r},n.DataManagerReportJoinHelper=e},"./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js":function(t,n,i){"use strict";var r,l,d,c,v,e;function o(t){this.N3=t,this.Xle=new r.CalcSource(t.getCalcService())}Object.defineProperty(n,"__esModule",{value:!0}),n.DataManagerReportSortHelper=void 0,r=i("CalcEngine"),l=i("./dist/src/dataManager.entry.js"),d=i("./dist/src/data-manager-report/tree-data-generator/utils/utils.js"),c=void 0,v="number",o.prototype.sortGroupsBySortCondition=function(f,a,h){var n,s,i,t,r,n=a.templateCell.Kle,s=[];if(n){for(n.forEach(function(t,n){var i,r,e,o,u,s,c,u;if(!(0,l.isNullOrUndefined)(t.cell)&&d.cellNameReg.test(t.cell)&&(i=h(t.cell)))if((r=(0,d.wbe)(i,a))||i===a)for(e=0,o=f;e<o.length;e++)s=(s=(u=o[e]).sortValues)||(u.sortValues=[]),c=void 0,i===a?c=u.value:(u=(0,d.ybe)(u,i))&&(c=u[0].value),s[n]=c;else t.order=void 0}),t=function(u){var r,t,o,r=n[u];r&&r.order&&(r.list&&r.list.length?(t=r.list,o={},t.forEach(function(t,n){return o[t]=n}),i=function(t,n){var e,i,t,e=!1,i,t=function(t,n){var i,r,t,n,i=t.sortValues[u],r=n.sortValues[u];return s[u+1]&&i===r?(e=!0,s[u+1](t,n)):(t=o[i+""],n=o[r+""],t!==c&&n!==c?t-n:t!==c?-1:n!==c?1:i===r?0:r<i?1:-1)}(t,n);return!e&&"desc"===r.order?-t:t},s[u]=i):(0,l.isNullOrUndefined)(r.cell)&&(0,l.isNullOrUndefined)(r.column)&&(0,l.isNullOrUndefined)(r.formula)||(i=function(t,n){var e,o,i,t,e=!1,o="desc"===r.order,i,t=function(t,n){var i,r,t,n,i=t.sortValues[u],r=n.sortValues[u];return s[u+1]&&i===r?(e=!0,s[u+1](t,n)):(t=(0,l.isNullOrUndefined)(i)||""===i||typeof i==v&&isNaN(i),n=(0,l.isNullOrUndefined)(r)||""===r||typeof r==v&&isNaN(r),t||n?t&&n?0:t&&!n?o?-1:1:!t&&n?o?1:-1:void 0:i===r?0:(0,d.isGreaterThan)(r,i)?-1:1)}(t,n);return!e&&o?-t:t},s[u]=i))},r=n.length-1;-1<r;r--)t(r);i&&(f.sort(i),this.Mbe(f,a))}},o.parseSortOptionsToSorts=function(t){var n;null!=(n=t.sorts)&&n.length&&!t.Kle&&(t.Kle=t.sorts.map(function(t){var n,i,n,t,n=(0,l.isNullOrUndefined)(t.desc),i=n?t.asc:t.desc,n={order:n?"asc":"desc",list:t.list};return(i=(i=(0,l.isNullOrUndefined)(i)?"":i).trim()).startsWith("=")?(t=i.substring(1),d.cellNameReg.test(t)?n.cell=t:n.formula=i):n.column=i,n}))},o.prototype.Mbe=function(r,e){var o=this;e.children.forEach(function(t){var n,n,i,n=null==(n=t.data)?void 0:n.groups;null!=n&&n.length&&(i=t.leftParent===e,n.sort(function(t,n){var t,n,t=i?t.leftParent:t.upParent,n=i?n.leftParent:n.upParent;return r.indexOf(t)-r.indexOf(n)})),o.Mbe(n,t)})},n.DataManagerReportSortHelper=o},"./dist/src/data-manager-report/tree-data-generator/index.js":function(t,n,i){"use strict";var r,e,o,u,s,f,c;function a(t,n){var i=this;this.generateTreeDataInternal=function(t){var t,n,t=t.root;try{i.Rle.generateJoinRelationIndexMap(t),n=i.Lle.generateCellNodeTreeData(t)}catch(t){n=[]}finally{t.data.groups=n}},this.Uhe=new s.DataManagerProxy(t),this.DJ=n,this.Rle=new e.DataManagerReportJoinHelper(this.Uhe,n),this.Ble=new o.DataManagerReportSortHelper(this.Uhe),this.Lle=new u.DataManagerReportGroupHelper(this.Uhe,n,this.Rle,this.Ble),this.Hhe=new r.DataManagerReportCrossHelper(this.Uhe,n,this.Rle,this.Lle,this.Ble)}function h(t,n){var i,i;t.templateCell.dataColumn&&void 0!==t.templateCell.dataColumn.tableName&&(n[t.templateCell.dataColumn.tableName.toUpperCase()]=!0),(i=t.templateCell.filter)&&i.condition&&l(i.condition,n),null!=(i=t.children)&&i.forEach(function(t){h(t,n)})}function l(t,n){var i,r,e,o,u,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)l(e=r[i],n);if(t.or)for(o=0,u=t.or;o<u.length;o++)l(s=u[o],n)}}function d(t,n){n=n.toUpperCase();for(var i=0;i<t.length;i++)if(t[i].tables.find(function(t){return t.name.toUpperCase()===n}))return i;return-1}function v(t){var n,r,u,i,e,o,s,c,n=t.tables,r=t.relationships;if(n.length&&r.length){for(i in u={},n.forEach(function(t){var i,e,o,n,i=t.table(),e=i.name.toUpperCase();u[e]||(u[e]={}),o=u[e],(n=r.filter(function(t){return t.targetTable===i||t.sourceTable===i}).map(function(t){var n=t.sourceTable===i?t.targetTable:t.sourceTable;return{table:n,relationship:t,tableName:n.name.toUpperCase()}})).forEach(function(t){var n,i,r;if(t.tableName!==e){for(n in u)u.hasOwnProperty(n)&&n!==e&&n!==t.tableName&&(i=u[n])[e]&&((r=[].concat(i[e])).push(t.relationship),!i[t.tableName]||i[t.tableName].length>r.length)&&(i[t.tableName]=r);o[t.tableName]||(o[t.tableName]=[t.relationship])}})}),u)if(u.hasOwnProperty(i))for(o in e=u[i])if(e.hasOwnProperty(o)&&u[o])for(s in u[o])u[o].hasOwnProperty(s)&&s!==i&&(c=e[o].concat(u[o][s]),!u[i][s]||u[i][s].length>c.length)&&(u[i][s]=c);Object.values(u).forEach(function(t){Object.values(t).forEach(function(t){t.reverse()})}),t.tableToTableRelationPath=u}}Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0,r=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-cross-helper.js"),e=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-join-helper.js"),o=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),f=i("./dist/src/data-manager-report/data-manager-proxy/report-table.js"),a.prototype.generateTreeData=function(){var t,n,i,t,t,t=this.DJ,n=t.crossCells,i=t.verticalExpansionTrees,t=t.horizontalExpansionTrees;this.zhe();try{this.eTe()}catch(t){}this.Rle.currentTreeDirection="H",t.forEach(this.generateTreeDataInternal),this.Rle.currentTreeDirection="V",i.forEach(this.generateTreeDataInternal),(t=n.filter(function(t){return!n.includes(t.leftParent)&&!n.includes(t.upParent)})).length&&this.Hhe&&this.Hhe.processCrossCells(t),this.Rle.clearCache(!0),this.Lle.clearCache(!0),this.Uhe.clearTableDataCache(),this.Sbe()},a.prototype.zhe=function(){this.Rle.clearCache(),this.Lle.clearCache()},a.prototype.getUsedTableRelationshipGraphsForUT=function(){return this.eTe(),this.Rle.relationshipGraphs()},a.prototype.eTe=function(){for(var t,s,c,n,i,t,t=this.Uhe,s=[].concat(t.getRelationshipsByTable()),c=[],n=this.Tbe(),i=function(){var t,n,i,r,e,n,i,r,e,o,u,n,t=s.shift(),n=t.sourceTable,i=t.targetTable,r=n.name.toUpperCase(),e=i.name.toUpperCase(),n=new f.ReportTable({dataManagerTable:n}),i=new f.ReportTable({dataManagerTable:i}),r=d(c,r),e=d(c,e);-1===r&&-1===e?c.push(o={relationships:[t],tables:[n,i]}):-1===r&&-1!==e?(c[e].relationships.push(t),c[e].tables.push(n)):-1!==r&&-1===e?(c[r].relationships.push(t),c[r].tables.push(i)):(r===e&&-1===c[r].relationships.indexOf(t)?c[r]:(u=c[e],(n=c.splice(r,1))[0].relationships.forEach(function(t){u.relationships.push(t)}),n[0].tables.forEach(function(t){u.tables.push(t)}),u)).relationships.push(t)};s.length;)i();(t=c.filter(function(t){return t.tables.map(function(t){return t.name.toUpperCase()}).some(function(t){return n[t]})})).forEach(function(t){v(t)}),this.Rle.relationshipGraphs(t)},a.prototype.Tbe=function(){var t,n,n={};return this.DJ&&(this.DJ.horizontalExpansionTrees.forEach(function(t){h(t.root,n)}),this.DJ.verticalExpansionTrees.forEach(function(t){h(t.root,n)}),null!=(t=this.DJ.crossCells))&&t.forEach(function(t){h(t,n)}),n},a.prototype.Sbe=function(){var n,t,i,r,t,n=this,t=this.DJ,i=t.verticalExpansionTrees,r=t.horizontalExpansionTrees,t=t.crossCells;r.forEach(function(t){n.Abe(t.root)}),i.forEach(function(t){n.Abe(t.root)}),t&&t.forEach(function(t){n.Abe(t)})},a.prototype.Abe=function(t){var n,i,n=this;t&&(t.nM=void 0,(i=t.templateCell)&&(i.ihe=void 0,i.Kle=void 0,i.Hle=void 0,this.cCe(t)),t.children.forEach(function(t){n.Abe(t)}))},a.prototype.cCe=function(t){var t=t.data.groups;t&&t.length&&t.forEach(function(t){t.Qle=void 0,t.Jle=void 0,t.sortValues=void 0})},n.TreeDataGenerator=a},"./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},"./dist/src/data-manager-report/tree-data-generator/utils/utils.js":function(A,t,n){"use strict";var e,o,n,u,s,c,f,a,i;function h(t,n,i){var r=e(e([],i=void 0===i?[]:i,!0),[t],!1);0<t.children.length?t.children.forEach(function(t){h(t,n,r)}):n.push(r)}function r(t,n){var i,n,r,i=0;switch(n){case"Avg":i=t.length?t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)/t.length:0;break;case"Count":i=t.length;break;case"Max":i=Math.max.apply(Math,t);break;case"Min":i=Math.min.apply(Math,t);break;case"None":i=0;break;case"Sum":i=t.reduce(function(t,n){var t=+t,n=+n;return(isNaN(t)?0:t)+(isNaN(n)?0:n)},0)}return n=15,"number"==typeof i&&-10<i&&i<10&&(1<(r=i.toString()).indexOf("000000000000")||1<r.indexOf("999999999999"))&&(n=14),u(i,o.Functions.CALC_PRECISION||n)}function l(t,n){return t&&t.length&&n&&n.length?t.filter(function(t){return-1<n.indexOf(t)}):[]}function d(t,n){var i;return t&&0!==t.length?n&&0!==n.length?(i=[].concat(t),n.forEach(function(t){-1===i.indexOf(t)&&i.push(t)}),i):t:n||[]}function v(t){return t.toUpperCase()}function p(t){return!(!(t=t.replace(/__\d+__\d+/g,"").slice(t.indexOf("=")+1,t.length).trim()).startsWith("{")||!t.endsWith("}"))}function w(t,n,i){var n,t,r,i,e,o,u,s,c,f,t=t.parse(n,i,0,0),r=[],i=null==(n=null==t?void 0:t.value)?void 0:n.array;if(i)for(e=0,o=i;e<o.length;e++)for(s=0,c=u=o[e];s<c.length;s++)f=c[s],r.push(f);return r}function b(t,n){var i=n.nM;return i||(n.templateCell.dataColumn?i=t.getTable(n.templateCell.dataColumn.tableName):n.templateCell.formula&&p(n.templateCell.formula)&&(i=t.getTable("".concat(n.templateCell.formula,"__").concat(n.templateCell.row,"__").concat(n.templateCell.col))),n.nM=i),i}function m(t,n){var i="";return t.templateCell.dataColumn?i=t.templateCell.dataColumn.tableName:t.templateCell.formula&&(n||p(t.templateCell.formula))&&(i="".concat(t.templateCell.formula,"__").concat(t.templateCell.row,"__").concat(t.templateCell.col)),i.toUpperCase()}function j(t){var t=t.match(i);return t&&t[1]}function y(t){return t&&t.and}function g(t){return t&&t.or}function _(t){return t&&!t.or&&!t.and}function O(t){var n;switch(typeof t){case"string":return"String";case"boolean":return"Boolean";case"number":return"Number"}if(isNaN(t)&&!isNaN(Date.parse(t)))return"Date"}function S(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return i+(t+1)}function C(t){var n,i,n=Array.isArray(t)?[]:{};for(i in t)t.hasOwnProperty(i)&&(n[i]="and"===i||"or"===i?C(t[i]):t[i]);return n}function R(t){return!!t&&(!(!t.leftParent||!t.upParent)||R(t.leftParent||t.upParent))}function F(t,n){return!(!t||!n)&&(t===n||F(t.leftParent,n)||F(t.upParent,n))}function I(t,n){var i,r,e,o;if(t&&t.childrenArray&&t.childrenArray.length&&n)for(i=void 0,r=0,e=t.childrenArray;r<e.length;r++)if(i=(o=e[r])&&o[0]&&o[0].cellNode===n?o:I(o[0],n))return i}function N(t,n){var i,r,e,o,u;return t instanceof Date&&(t=s(t)),n instanceof Date&&(n=s(n)),e=(i=typeof t)===c,o=(r=typeof n)===c,u=r===f,i==r||i!==f&&!u?i===a&&o||(!e||r!==a)&&(e&&o?t.toLowerCase()>n.toLowerCase():n<t):u}function M(t,n,i,r){var r;return r&&(E(r,r=x(t,n,i)),void 0===(i=T(t,n,r))||i.startsWith("=")||(i="="+i)),i}function E(t,n){var i,r,e,o,u;if(8===n.type)void 0!==(i=t[n.value.toUpperCase()])&&("string"==(r=typeof i)?n.type=3:"boolean"==r?n.type=4:"number"==r?n.type=2:i instanceof Date&&(i=i.toString(),n.type=3),n.value=i);else{if(n.arguments)for(e=0,o=n.arguments;e<o.length;e++)E(t,u=o[e]);n.value&&E(t,n.value),n.value2&&E(t,n.value2)}}function x(t,n,i){return t.parse(n,i,0,0)}function T(t,n,i){return t.unparse(n,i,0,0)}function D(t){var t=t.newRecordDefaultValueGenerator?t.newRecordDefaultValueGenerator():void 0,n;return n=t&&void 0!==t.formula?t.formula:n}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.generateDefaultFormulaByTemplateCell=t.expressionToFormula=t.formulaToExpression=t.xbe=t.lbe=t.isGreaterThan=t.ybe=t.wbe=t.isCellInCrossCell=t.deepCloneFilterCondition=t.rowColToCellName=t.getValueType=t.isSimpleFilterCondition=t.hasOrCondition=t.hasAndCondition=t.fieldExpressionToField=t.getTableNameByCellNode=t.getTableByCellNode=t.getFormulaResult=t.isFormulaInWhitelist=t.toUpperCase=t.getArrayUnionItems=t.getArraySameItems=t.calc=t.traverse=t.cellNameReg=t.formulaWhitelist=void 0,o=n("CalcEngine"),n=n("Common"),u=n.Common.st.E8,s=n.Common.ct.o0,c="string",f="number",a="boolean",t.formulaWhitelist=[],t.cellNameReg=/^([A-Z]+)(\d+)$/,t.traverse=h,t.calc=r,t.getArraySameItems=l,t.getArrayUnionItems=d,t.toUpperCase=v,t.isFormulaInWhitelist=p,t.getFormulaResult=w,t.getTableByCellNode=b,t.getTableNameByCellNode=m,i=/\[@(.*?)\]/,t.fieldExpressionToField=j,t.hasAndCondition=y,t.hasOrCondition=g,t.isSimpleFilterCondition=_,t.getValueType=O,t.rowColToCellName=S,t.deepCloneFilterCondition=C,t.isCellInCrossCell=R,t.wbe=F,t.ybe=I,t.isGreaterThan=N,t.lbe=M,t.xbe=E,t.formulaToExpression=x,t.expressionToFormula=T,t.generateDefaultFormulaByTemplateCell=D},"./dist/src/data-manager-report/tree-data-generator/utils/value-comparator-factory.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.ValueComparatorFactory=void 0,r.createComparator=function(t){switch(t){case"Equal":return function(t,n){return t+""==n+""};case"NotEqual":return function(t,n){return t+""!=n+""};case"GreaterThanOrEqual":return function(t,n){var t=r.parseValue(t,n);return t.recordValue>=t.ruleValue};case"GreaterThan":return function(t,n){var t=r.parseValue(t,n);return t.recordValue>t.ruleValue};case"LessThanOrEqual":return function(t,n){var t=r.parseValue(t,n);return t.recordValue<=t.ruleValue};case"LessThan":return function(t,n){var t=r.parseValue(t,n);return t.recordValue<t.ruleValue};case"StartWith":return function(t,n){return(t+"").startsWith(n+"")};case"NotStartWith":return function(t,n){return!(t+"").startsWith(n+"")};case"EndWith":return function(t,n){return(t+"").endsWith(n+"")};case"NotEndWith":return function(t,n){return!(t+"").endsWith(n+"")};case"Contains":return function(t,n){return-1<(t+"").indexOf(n+"")};case"NotContains":return function(t,n){return-1===(t+"").indexOf(n+"")};case"In":return function(t,n){return-1<(n+"").indexOf(t+"")};case"NotIn":return function(t,n){return-1===(n+"").indexOf(t+"")};default:return function(){return!0}}},r.parseValue=function(t,n){return"number"==typeof t?isNaN(n)?{recordValue:t+"",ruleValue:n+""}:{recordValue:t,ruleValue:+n}:isNaN(t)?{recordValue:t+"",ruleValue:n+""}:"number"==typeof n?{recordValue:+t,ruleValue:n}:{recordValue:t,ruleValue:n}},r.createDateComparator=function(t){switch(t){case"Equal":case"Contains":case"In":return function(t,n,i,r){return i<=t&&t<=r};case"NotEqual":case"NotContains":case"NotIn":return function(t,n,i,r){return r<t||t<i};case"GreaterThanOrEqual":case"StartWith":case"NotEndWith":return function(t,n,i,r){return i<=t};case"GreaterThan":return function(t,n,i,r){return r<t};case"LessThanOrEqual":case"NotStartWith":case"EndWith":return function(t,n,i,r){return t<=r};case"LessThan":return function(t,n,i,r){return t<i};default:return function(){return!0}}},n.ValueComparatorFactory=r},"./dist/src/dataManager.common.js":function(t,i,n){"use strict";var r,e,o,n,n,u,s,c;function f(){return null!==c&&c.apply(this,arguments)||this}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(i,"__esModule",{value:!0}),i.CalcFunction=i.sR=i.SR=void 0,e=n("CalcEngine"),o=n("Common"),n=n("./dist/src/res.en.js"),i.SR={en:n.resource},n=new o.Common.ResourceManager(i.SR,"DataManager"),i.sR=n.getResource.bind(n),c=e.Functions.Function,r(f,c),f.prototype.description=function(){var t=this,n=(0,i.sR)().zve;return t.IDt||(n?n[t.name]:c.prototype.description.call(this))},i.CalcFunction=f},"./dist/src/dataManager.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/dataSource/dataSource.entry.js"),n),e(i("./dist/src/table/table.entry.js"),n),e(i("./dist/src/viewField/viewField.entry.js"),n),e(i("./dist/src/view/view.entry.js"),n),e(i("./dist/src/interfaces/interface.js"),n),e(i("./dist/src/interfaces/styleOptions.js"),n),e(i("./dist/src/interfaces/validatorOptions.js"),n),e(i("./dist/src/interfaces/conditionalFormatOptions.js"),n),e(i("./dist/src/dataManager.js"),n),e(i("./dist/src/dataManager.common.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/interfaces/data-manager-report.interface.js"),n),e(i("./dist/src/data-manager-report/data-manager-report.js"),n),e(i("./dist/src/data-manager-report/tree-data-generator/index.js"),n),e(i("./dist/src/query.js"),n)},"./dist/src/dataManager.js":function(t,n,i){"use strict";var r,e,o,y,u,s,c,f,a,h,l,d;function g(t){var t=t.split(/\s*=\s*/);return 2===t.length?[t[0].split("."),t[1].split(".")]:[]}function v(t,n){this.rV={},this.tables={},this.relationships=[],this.OEt={},n=n||new r.CalcService,this.updateCalcService(n),(0,s.addCustomFunctions)(),t&&this.Ibe(t)}function p(t){return t instanceof o.View}Object.defineProperty(n,"__esModule",{value:!0}),n.isView=n.DataManager=void 0,r=i("CalcEngine"),e=i("./dist/src/table/table.js"),o=i("./dist/src/view/view.js"),y=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/dataSource/dataSource.js"),s=i("./dist/src/calculation/functions/functions.entry.js"),c=i("./dist/src/calculation/tokenResolver.js"),f=i("./dist/src/calculation/queryFunctionResolver.js"),a=i("./dist/src/relationship.js"),h=null,l=r.Convert.LE,v.prototype.Ibe=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,h,l,d,v,p,w,b,m,j,n,i=0,r=(0,y.keys)(t.tables);i<r.length;i++){if(e=r[i],u={},s=(o=t.tables[e]).fields)for(c in s)s.hasOwnProperty(c)&&(f=s[c],u[c]={name:f.name,dataType:f.dataType,spread:f.spread});if(a={schema:{columns:u}},(h=o.dimensions)&&(a.schema.dimensions=h),o.measures&&0<Object.keys(o.measures).length&&(a.schema.measures=(0,y.clone)(o.measures,!0)),o.source)a.remote={read:{url:o.source}};else{if(!o.localSource)continue;a.data=o.localSource}if(h=this.addTable(e,a),o.primaryKey&&h.primaryKey(o.primaryKey),l=o.relationships)for(d in l)if(l.hasOwnProperty(d)){if(m=b=w=p=void 0,(v=l[d]).on){if(0===(j=g(v.on)).length)continue;p=j[0][0],b=j[0][1],w=j[1][0],m=j[1][1]}else{if(!(v.with&&v.source&&o.primaryKey))continue;p=e,b=o.primaryKey,w=v.source,m=v.with}this.addRelationship(this.tables[p],b,d,this.tables[w],m,w+"_"+m)}}this.queries=t.queries},v.prototype.addTable=function(t,n){this.RTe(t);var n=new e.Table(t,n);return(this.tables[t]=n).REt(this),n},v.prototype.removeTable=function(t){for(var n,i,r,n=this.tables[t],i=this.relationships,r=i.length-1;0<=r;r--)i[r].sourceTable!==n&&i[r].targetTable!==n||(i[r].VP(),i.splice(r,1));n.REt(h),delete this.tables[t],this.RTe(t)},v.prototype.addRelationship=function(t,n,i,r,e,o){var t=new a.Relationship(t,n,i,r,e,o);return this.relationships.push(t),t},v.prototype.removeRelationship=function(t){for(var n,i,n=this.relationships,i=0;i<n.length;i++)if(n[i].sourceRelationshipName===t){n[i].VP(),n.splice(i,1);break}},v.prototype.updateCalcService=function(t){for(var n,i,r,e,o,n,i=!0,r=0,e=t.getResolvers();r<e.length;r++)if((o=e[r])instanceof c.DataManagerTokenResolver){i=!1;break}i&&t.addResolver(new c.DataManagerTokenResolver(8e3)),this.Lp=t},v.prototype.xEt=function(t,n,i){var r,e,o;return l(t)?t=t.getValueByIndex(0):(0,y.isString)(t)||(t=""+t),(0,y.isString)(n)?n=[n]:l(n)?n=n.toArray(0,!0):n&&n.array&&(n=n.array[0]),r=1<(null==n?void 0:n.length)?n.join(","):null==n?void 0:n[0],o=(o=(e=(e=this.OEt[t])||(this.OEt[t]={}))[r])||(e[r]=f.QueryFunctionSolver.parseParam(t,n,i,this))},v.prototype.IEt=function(t,n,i,r,e){var t,n,t=this.xEt(t,n,i);return e?t.table._dataSource.unbind(u.ONCHANGE,r):r&&t.table&&t.table._dataSource.bind(u.ONCHANGE,r),n=0===(n=t.getValue?t.getValue(t.table):[[]]).length?[[]]:n},v.prototype.RTe=function(t){var n=this.OEt;n&&delete n[t]},v.prototype.toJSON=function(){var t,n,i,r,t=this.tables,n=[];for(i in t)t.hasOwnProperty(i)&&n.push(t[i].toJSON());return{tables:n,relationships:r=this.relationships.map(function(t){return{sourceTableName:t.sourceTable.name,sourceFieldName:t.sourceFieldName,sourceRelationshipName:t.sourceRelationshipName,targetTableName:t.targetTable.name,targetFieldName:t.targetFieldName,targetRelationshipName:t.targetRelationshipName}}),queries:this.queries}},v.prototype.fromJSON=function(t){var o,n,i,i,r,e,u,s,c,f,o=this,n=this.tables={},i=t.tables,i=Promise.all(i.map(function(t){var n,i,r,e,n,n=t.dataSourceOption.schema,i=n&&n.columns;if(i)for(r in i)i.hasOwnProperty(r)&&(e=i[r])&&"date"===e.dataType&&Array.isArray(e.lookup)&&(e.lookup=e.lookup.map(function(t){return new Date(t)}));return(n=o.addTable(t.name,t.dataSourceOption)).BEt=!0,n.fromJSON(t)}));for(this.relationships=[],e=0,u=r=t.relationships;e<u.length;e++)c=n[(s=u[e]).sourceTableName],f=n[s.targetTableName],this.addRelationship(c,s.sourceFieldName,s.sourceRelationshipName,f,s.targetFieldName,s.targetRelationshipName);return t.queries&&(this.queries=t.queries),i},n.DataManager=v,n.isView=p},"./dist/src/dataSource/dataReader/basicReader.js":function(t,n,i){"use strict";var e,o,r;function u(t){var n,i,r,t,n=this;n.LEt=t,(0,e.isNullOrUndefined)(t)||(n.Pq=t.Pq,i=t.dataPath,r=t.countPath,t=t.parse,(0,e.isFunction)(i)?n.FEt=i:n.FEt=function(t){return(0,e.isString)(i)&&i?(0,e.q$)(t,i):t},(0,e.isFunction)(r)?n.PEt=r:n.PEt=function(t){return(0,e.isString)(r)&&r?parseInt((0,e.q$)(t,r),10):o},(0,e.isFunction)(t)&&(n.parse=t))}Object.defineProperty(n,"__esModule",{value:!0}),n.BasicReader=void 0,e=i("./dist/src/dataSource/utils.js"),o=void 0,u.prototype.parse=function(t){return this.GEt=t,Promise.resolve(t)},u.prototype.read=function(t){return Promise.resolve(this.FEt(t))},u.prototype.readSync=function(t){return this.FEt(t)},u.prototype.total=function(t){return this.PEt(t)},n.BasicReader=u},"./dist/src/dataSource/dataReader/columnJsonReader.js":function(t,n,i){"use strict";var r,e,h,o,u,s;function c(t){var n,f,a,n=s.call(this,t)||this,f=n,a=t.dataPath;return(0,h.isFunction)(a)?f.FEt=a:f.FEt=function(t){var n,i,r,e,o,u,s,c;for(t=(0,h.isString)(a)?(0,h.q$)(t,a):t,n=f.Pq=f.Pq||(0,h.keys)(t),i=f.GEt=[],r=t[n[0]].length,e=0;e<r;e++){for(o={},u=0,s=n;u<s.length;u++)o[c=s[u]]=t[c][e];i.push(o)}return i},n}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnJsonReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),h=i("./dist/src/dataSource/utils.js"),s=e.BasicReader,r(c,s),c.prototype.parse=function(e){var o=this;return new Promise(function(t,n){var i,r;(0,h.isNullOrUndefined)(e)&&n("value cannot be null or empty"),i=o.Pq=o.Pq||(0,h.keys)(e),(r=(0,h.reduce)(i,function(t,n){return t&&(0,h.isArray)(e[n])},!0))||n("The value of each property in column JSON should be an array"),t(e)})},n.ColumnJsonReader=c},"./dist/src/dataSource/dataReader/csvReader.js":function(t,n,i){"use strict";var r,e,l,o,u,s;function c(t){var n=s.call(this,t)||this;return n.UEt=t.delimiter||['"'],n.HEt=t.separator||",",n}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CsvReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),l=i("./dist/src/dataSource/utils.js"),s=e.BasicReader,r(c,s),c.prototype.parse=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,n=this,i=n.UEt,r=n.HEt,e=t.split(""),o=0,u=e.length,s=[];o<u;){for(a=[];o<u&&"\r"!==e[o]&&"\n"!==e[o];){if(c=f=o,-1<(0,l.indexOf)(i,e[o])){for(c=f=++o;o<u;){if(-1<(0,l.indexOf)(i,e[o])){if(-1===(0,l.indexOf)(i,e[o+1]))break;e[++o]=""}f=++o}for(-1<(0,l.indexOf)(i,e[o])&&++o;o<u&&"\r"!==e[o]&&"\n"!==e[o]&&r!==e[o];)++o}else for(;o<u&&"\r"!==e[o]&&"\n"!==e[o]&&r!==e[o];)f=++o;a.push(e.slice(c,f).join("")),r===e[o]&&++o}"\r"!==e[o]&&"\n"!==e[o]||++o,0<a.length&&s.push(a)}return h=s.shift(),n.GEt=(0,l.isNullOrUndefined)(n.Pq)?(0,l.map)(s,function(t){return(0,l.zipObject)(h,t)}):(0,l.map)(s,function(t){return(0,l.pick)((0,l.zipObject)(h,t),n.Pq)}),n.Pq=n.Pq||h,Promise.resolve(n.GEt)},n.CsvReader=c},"./dist/src/dataSource/dataReader/jsonReader.js":function(t,n,i){"use strict";var r,i,e,o,u;function s(t){return u.call(this,t)||this}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.JsonReader=void 0,i=i("./dist/src/dataSource/dataReader/basicReader.js"),u=i.BasicReader,r(s,u),n.JsonReader=s},"./dist/src/dataSource/dataReader/xmlReader.js":function(t,n,i){"use strict";var r,e,o,u,s,c;function f(t){var i,r,e,i=c.call(this,t)||this,r=i,e=t.dataPath;return(0,o.isFunction)(e)?r.FEt=e:r.FEt=function(t){var n;return t=(0,o.isString)(e)?(0,o.q$)(t,e):t,(0,o.isNullOrUndefined)(t)||((n=r.Pq)?t=t.map(function(t){return(0,o.pick)(t,n)}):i.Pq=(0,o.keys)(t[0])),t},i}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.XmlReader=void 0,e=i("./dist/src/dataSource/dataReader/basicReader.js"),o=i("./dist/src/dataSource/utils.js"),c=e.BasicReader,r(f,c),f.prototype.parse=function(t){var n,t,t,n,t=(new DOMParser).parseFromString(t.trim(),"text/xml"),t=this.documentToJSObject(t);return Promise.resolve(t)},f.prototype.documentToJSObject=function(t){for(var n,i,r,e,n={},i=t.children,r=0,e=i.length;r<e;r++)this.elementToJSObject(i[r],n);return n},f.prototype.elementToJSObject=function(t,n){var i,r,e,o,u,s,c,f,i=t.children,r=i.length,e=t.nodeName;if(0===r)n[e]=t.textContent;else{for(o={},void 0!==(u=n[e])?Array.isArray(u)?n[e].push(o):n[e]=[u,o]:n[e]=o,s=t.attributes,c=0;c<s.length;c++)o[(f=s[c]).nodeName]=f.nodeValue;for(c=0;c<r;c++)this.elementToJSObject(i[c],o)}},n.XmlReader=f},"./dist/src/dataSource/dataSource.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/dataSource/dataSource.js"),n),e(i("./dist/src/dataSource/dataSource.interface.js"),n),e(i("./dist/src/dataSource/utils.js"),n)},"./dist/src/dataSource/dataSource.interface.js":function(t,n){"use strict";var i,r,e,o,u,s,s,s,s,s;Object.defineProperty(n,"__esModule",{value:!0}),n.TriggerWhenType=n.FrameExcludeTies=n.FrameExcludeGroup=n.FrameExcludeCurrentRow=n.FrameExcludeNoOthers=n.OrderDesc=n.OrderAsc=n.WindowOverFrameExcludeMode=n.WindowOverFrameType=n.WindowOverFrameFollowing=n.WindowOverFramePreceding=void 0,(s=i=n.WindowOverFramePreceding||(n.WindowOverFramePreceding={}))[s.UnBounded=-2]="UnBounded",s[s.NPreceding=-1]="NPreceding",s[s.CurrentRow=0]="CurrentRow",(s=r=n.WindowOverFrameFollowing||(n.WindowOverFrameFollowing={}))[s.UnBounded=2]="UnBounded",s[s.NFollowing=1]="NFollowing",s[s.CurrentRow=0]="CurrentRow",(s=e=n.WindowOverFrameType||(n.WindowOverFrameType={}))[s.ROWS=0]="ROWS",s[s.RANGE=1]="RANGE",s[s.GROUPS=2]="GROUPS",(s=o=n.WindowOverFrameExcludeMode||(n.WindowOverFrameExcludeMode={}))[s.none=0]="none",s[s.current=1]="current",s[s.group=2]="group",s[s.ties=3]="ties",n.OrderAsc="ASC",n.OrderDesc="DESC",n.FrameExcludeNoOthers="none",n.FrameExcludeCurrentRow="current",n.FrameExcludeGroup="group",n.FrameExcludeTies="ties",(s=u=n.TriggerWhenType||(n.TriggerWhenType={})).onNew="onNew",s.onNewAndUpdate="onNewAndUpdate"},"./dist/src/dataSource/dataSource.js":function(P,y,t){"use strict";var n,g,h,i,r,e,f,o,u,s,c,_,a,m,j,l,O,S,d,C,v,p,k,R,L,w,V;function F(t){return"".concat(p).concat(t)}function b(t){return"string"==typeof t&&-1<t.indexOf(p)}function I(t){return b(t)?j:t}function G(t,n){var i=n;return"odata"!==t&&"odata4"!==t||!n.value?"graphql"!==t&&"rest"!==t||!n.data||(i=n.data):i=n.value,i}function N(t,n){var i,r,e,i={};for(r in t)t.hasOwnProperty(r)&&(e=n[r],i[r]=(0,_.isNullOrUndefined)(e)?t[r]:e);return i}function M(t,n,i,r,e){var o,u,s,c,f,a,h;for("string"==typeof i?o=u=i:(o=i.childrenField1||"children",u=i.childrenField2||"children"),s=t[o]||[],c=n[u]||[],f=0;f<s.length;f++)a=s[f],h=c[f],r&&r(a,h,t,n),M(a,h,i,r,e),e&&e(a,h,t,n)}function E(t,n){var i,r,e,o,u;if((0,_.isNullOrUndefined)(t)||(0,_.isNullOrUndefined)(n))return t===n;if(i=(0,_.keys)(t),r=(0,_.keys)(n),i.length===r.length){for(e=0,o=i;e<o.length;e++)if(t[u=o[e]]!==n[u])return;return 1}}function x(t,n){var t;return g(g({},t),{value:null!=(t=t.value)?t:n})}function q(t,n){for(var i,r,e,o,i=[],r=0;r<n;r++){for(o in e={},t)t.hasOwnProperty(o)&&(e[o]=t[o].data[r]);i[r]=e}return i}function T(t){return"xml"===t?"xml":"csv"===t?"text":"json"}function B(t){var n,n,t,i,i,i,i,i,n=null==(n=t.schema)?void 0:n.type,t=t.remote;n&&t&&((i=t.read)&&"object"==typeof i&&(i.dataType=T(n)),(i=t.update)&&"object"==typeof i&&(i.dataType=T(n)),(i=t.delete)&&"object"==typeof i&&(i.dataType=T(n)),(i=t.create)&&"object"==typeof i&&(i.dataType=T(n)),i=t.batch)&&"object"==typeof i&&(i.dataType=T(n))}function U(){}function D(t){var n,i,n=V.call(this)||this;return n.R1t=[],(i=n)._data=t.data,i.zEt=t.isRoot,i.VEt=t.getData,i.YEt=t.getFieldData,i.ZEt=t.idField,i.WEt=!(0,_.isNullOrUndefined)(t.idField),i.QEt=t.sequenceField,i.KEt=!(0,_.isNullOrUndefined)(t.sequenceField),Object.defineProperty(i,"data",{get:function(){return i.VEt(i.lp)}}),Object.defineProperty(i,"isRoot",{get:function(){return i.zEt}}),Object.defineProperty(i,"id",{get:function(){var t;return i.WEt?(t=i.YEt(i.ZEt,i.lp),(0,_.isNullOrUndefined)(t)?t=i._id:i._id!==t&&(i._id=t),t):i._id},set:function(t){i._id=t,(0,_.isNullOrUndefined)(i.JEt)&&(i.JEt=t)}}),Object.defineProperty(i,"parentId",{get:function(){return(0,_.isNullOrUndefined)(i.parent)?j:i.parent.id}}),Object.defineProperty(i,"parent",{get:function(){return i.sft},set:function(t){i.setParent(t),(0,_.isNullOrUndefined)(i.XEt)&&!(0,_.isNullOrUndefined)(t)&&(i.XEt=t.id)}}),Object.defineProperty(i,"level",{get:function(){return i.YAt},set:function(t){i.YAt=t}}),Object.defineProperty(i,"children",{get:function(){return i.R1t},set:function(t){i.R1t=t}}),Object.defineProperty(i,"sequence",{get:function(){return i.KEt?i.YEt(i.QEt,i.lp):i.qEt},set:function(t){i.qEt=t,(0,_.isNullOrUndefined)(i.$Et)&&(i.$Et=t)}}),n}function A(t){this.JFe=[],this.tjt={},this.njt=[],this.ejt=!0,this.Mue=!1,this.Kyn=0;var n=this;Object.defineProperty(this,"options",{get:function(){return n.LEt},set:function(t){n.setDataSourceOptions(t)}}),n._events={},n.options=g({data:m,batch:!1},t),this.ijt(t.remote,t.data),n.bind([l,S,d,y.ONCHANGE,O],t),this.rjt(t.schema),n.ajt()}n=this&&this.__extends||(w=function(t,n){return(w=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}w(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),g=this&&this.__assign||function(){return(g=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},h=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(y,"__esModule",{value:!0}),y.DataSource=y.HierarchyNode=y.ONCHANGE=y.REMOVE_COLUMN=y.UPDATE_COLUMN=y.ADD_COLUMN=y.GET_COLUMNS=y.RECOVER_DELETE=y.DELETE=y.UPDATE=y.INSERT=y.CREATE=void 0,i=t("./dist/src/dataSource/dataSource.interface.js"),r=t("./dist/src/dataSource/dataTransport/localDataTransport.js"),e=t("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),f=t("./dist/src/dataSource/event.js"),o=t("./dist/src/dataSource/dataReader/jsonReader.js"),u=t("./dist/src/dataSource/dataReader/columnJsonReader.js"),s=t("./dist/src/dataSource/dataReader/csvReader.js"),c=t("./dist/src/dataSource/dataReader/xmlReader.js"),_=t("./dist/src/dataSource/utils.js"),a=t("Common"),m=null,j=void 0,y.CREATE="create",y.INSERT="insert",y.UPDATE="update",y.DELETE="delete",y.RECOVER_DELETE="recover_delete",y.GET_COLUMNS="getColumns",y.ADD_COLUMN="addColumn",y.UPDATE_COLUMN="updateColumn",y.REMOVE_COLUMN="removeColumn",l="onBeforeSend",O="onFailed",S="onBeforeEnd",d="onReady",C="user cancel the request at step ",y.ONCHANGE="onChange",v=Number.NaN,p="__HIERARCHY__",n(D,V=U),D.prototype.sjt=function(){return this.qEt},D.prototype.setParent=function(t,n){var i=!(0,_.isNullOrUndefined)(this.parent);i&&this.parent.cjt(this),this.sft=t,(0,_.isNullOrUndefined)(t)?i&&(this.level=v):(this.level=t.level+1,(0,_.isNullOrUndefined)(n)?t.fjt(this):t.ljt(this,n))},D.prototype.updateChildrenLevel=function(){var n=this.level;this.children.forEach(function(t){t.level=n+1,t.updateChildrenLevel()})},D.prototype.promote=function(t){this.setParent(t,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},D.prototype.demote=function(n,t){this.parent=n,(t=!1!==t)?this.updateChildrenLevel():this.children.forEach(function(t){t.parent=n})},D.prototype.getCurrentIndex=function(){return this.parent&&this.parent.children.indexOf(this)},D.prototype.getPrevSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()-1]},D.prototype.getNextSibling=function(){return this.parent&&this.parent.children[this.getCurrentIndex()+1]},D.prototype.ljt=function(t,n){this.children.splice(n,0,t)},D.prototype.fjt=function(t){this.children.push(t)},D.prototype.cjt=function(t){var t=this.children.indexOf(t);this.children.splice(t,1)},D.prototype.getChildrenIndexes=function(t){var n=[];return(0,_.traversalTree)(this,{invoked:function(t){n.push(t.lp)}},t?function(t){return-t.sequence}:j),n},D.prototype.getChildrenCount=function(){var t=0;return(0,_.traversalTree)(this,{invoked:function(){t++}}),t},D.prototype.getFieldValue=function(t){return this.YEt(t,this.lp)},R=D,y.HierarchyNode=R,A.prototype.setDataSourceOptions=function(t,n){var i,r,e,o,u,r,s,r,c,f,i=this;B(t),r=i.LEt,i.LEt=t,u=(e=r&&r.remote&&r.remote.read&&r.remote.read.url)!==(o=t&&t.remote&&t.remote.read&&t.remote.read.url),i.ijt(t.remote,t.data),r=r&&r.schema,s=t&&t.schema,(r=r&&s&&(r.type!==s.type||r.dataPath!==s.dataPath||r.countPath!==s.countPath))&&i.rjt(t.schema),(c=i.ojt)&&(u||r)&&(i.ajt(f={isDataSourceChanged:u}),i.load().then(function(){n&&n(f)}).catch(function(){n&&n(f)}))},A.prototype.ijt=function(t,n){this.hjt=t?new e.RemoteDataTransport(t):new r.LocalDataTransport({data:n||[]})},A.prototype.rjt=function(t){var n,i;"json"===(i=(t=t||{}).type||"json")?n=new o.JsonReader(t):"columnJson"===i?n=new u.ColumnJsonReader(t):"csv"===i?n=new s.CsvReader(t):"xml"===i&&(n=new c.XmlReader(t)),this.djt=n},A.prototype.ajt=function(t){this._data={},this.vjt=0,this.DEt=[],t&&t.isDataSourceChanged&&(delete this.LEt.schema.columns,this.JFe=[],delete this._Be)},A.prototype.mjt=function(t,n,i){var r,e,o,u,s,r=this,e={};for(o in r._data)r._data.hasOwnProperty(o)&&(u=r._data[o],0!==n?(s=u.data.splice(t,n),e[o]={data:s}):t>=u.data.length?u.data[t]=i[o]:u.data.splice(t,0,i[o]));return r.vjt=r.vjt-n,i&&r.vjt++,q(e,n)},A.prototype.gjt=function(t,n){var i,r,e,o,i=this,r={};for(e in i._data)i._data.hasOwnProperty(e)&&(o=i._data[e],r[e]={data:o.data.slice(t,n)});return q(r,n-t)},A.prototype.pjt=function(t,n,i){var r,e;if(!(0,_.isNullOrUndefined)(n))if(r=this,i)for(e in n)Object.prototype.hasOwnProperty.call(r._data,e)&&(r._data[e].data[t]=n[e]);else for(e in r._data)r._data.hasOwnProperty(e)&&(r._data[e].data[t]=n[e])},A.prototype.bjt=function(t){var n,i,r,n=this,i={};for(r in n._data)n._data.hasOwnProperty(r)&&(i[r]=n._data[r].data[t]);return i},A.prototype.KFe=function(t){return this._data[t].data},A.prototype.XFe=function(t,n){this._data[t]&&(this._data[t].data=n)},A.prototype.yjt=function(t){var t,n,i;return!(!t||!t.reload)||(n=(t=this).wjt,0===(i=t.vjt))||((0,_.isNullOrUndefined)(n),!1)},A.prototype.Mjt=function(t,n){var i,r,i=this.tjt;return i[t]||(r=void 0,n?r=a.Common.ct.yU(t,n):(r=a.Common.ct.dJ(t),(0,_.isNullOrUndefined)(r)&&(r=new Date(t)),isNaN(r)&&(r=new Date(t.replace(" ","T")))),i[t]=r),i[t]},A.prototype.Cjt=function(t,n){return n?0===n.split("|").indexOf(t):!!t},A.prototype.Sjt=function(t,n){return+(t=(t=n?t.replace(n,"."):t).replace(/,/g,""))||0},A.prototype.Nbe=function(t){return t.toString()},A.prototype.Tjt=function(t,n,i,r){var e=t;return"rowOrder"===n?t:(r&&n&&"boolean"!==n&&(e+=""),"date"===n?"NULL"===e||""===e?null:this.Mjt(e,i):"boolean"===n?this.Cjt(e,i):"number"===n?this.Sjt(e,i):"string"===n?this.Nbe(e):t)},A.prototype.Ajt=function(t,n){var i="number"==typeof t;return(0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(t)||"string"!=typeof t&&!i?t:this.Tjt(t,n.dataType,n.dataPattern,i)},A.prototype.Ijt=function(t,n){var i,r,e,o;for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&(o="number"==typeof(e=n[i]),(0,_.isNullOrUndefined)(e)||"string"!=typeof e&&!o||(n[i]=this.Tjt(e,r.dataType,r.dataPattern,o)))},A.prototype.xjt=function(t,n,i){for(var r,e,o,u,r=this._data[t].data,e=0;e<r.length;e++)u="number"==typeof(o=r[e]),(0,_.isNullOrUndefined)(o)||"string"!=typeof o&&!u||(r[e]=this.Tjt(o,n,i,u));this.isHierarchy()&&"rowOrder"===n&&(this.ejt=!0)},A.prototype.Njt=function(t,n){var i,r;t===n||(0,_.isNullOrEmpty)(n)||((i=this).qFe(t,n),r=i.kjt(t),i.Djt(t,(0,_.isNullOrEmpty)(r)?t:r,n))},A.prototype.qFe=function(n,t){var i,r,i=this,r=i.DEt.findIndex(function(t){return t===n});-1<r&&i.DEt.splice(r,1,t),i._data[t]=i._data[n],delete i._data[n]},A.prototype.kbe=function(){var t,n,i,r,n=this,i=null==(t=n.LEt.schema)?void 0:t.columns;if(i)for(r in i)if(n._be(i[r].trigger))return!0;return!1},A.prototype._be=function(t){var n=this;return t&&t.formula&&(0,_.isFormula)(t.formula)&&(t.when===i.TriggerWhenType.onNew||t.when===i.TriggerWhenType.onNewAndUpdate&&!(0,_.isNullOrEmpty)(t.fields)&&(-1<t.fields.indexOf("*")||t.fields.split(",").map(function(t){return t.trim()}).every(function(t){return-1<n.DEt.indexOf(t)})))},A.prototype.Dbe=function(t){var n,n,i,t,i=this,t=null==(n=null==(n=i.LEt.schema)?void 0:n.columns[t])?void 0:n.trigger;if(i._be(t))return t},A.prototype.jbe=function(t,n){var i,r,e,o,u,s,r=this,o=null==(i=r.LEt.schema)?void 0:i.columns;if(!(0,_.isNullOrUndefined)(o))for(u in o)!o.hasOwnProperty(u)||!(s=r.Dbe(u))||t&&t!==s.when||((e=e===j?{}:e)[u]=n?s.formula:s);return e},A.prototype.gCe=function(t){var n,n,n,i,i;return"formula"===(null==(n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t])?void 0:n.dataType)},A.prototype.Obe=function(){var t,n,i,r,e,o,t,n=this.LEt.schema,r={};if(!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.columns))for(e in i=n.columns)i.hasOwnProperty(e)&&"formula"===(o=i[e]).dataType&&(r[e]=o.value);return r},A.prototype.Ebe=function(t){var n,n,n,n=null==(n=null==(n=this.LEt.schema)?void 0:n.columns)?void 0:n[t];return"formula"===(null==n?void 0:n.dataType)&&(null==n?void 0:n.value)},A.prototype.$Fe=function(){var r,e,r={},e={};return this.njt.concat([this.zjt]).forEach(function(t){var n,i,i,n,i="".concat(t.id),n="".concat(t.parentId);r[i]=n,e[i]=null==(i=null!=(n=t.children)?n:[])?void 0:i.map(function(t){return"".concat(t.id)})}),{orderCache:e,relationShipCache:r}},A.prototype.tBe=function(t){var r,e,o,u,r=t.orderCache,e=t.relationShipCache,o={},u=this;u.njt.concat([this.zjt]).forEach(function(t){var n="".concat(t.id);o[n]=t}),u.njt.forEach(function(t){var n,i,n,i,n="".concat(t.id),i="".concat(t.parentId),n=e[n];(n&&n!==i||!t.parent)&&((i=o[n])||n!==u.zjt.id||(i=u.zjt),t.setParent(i))}),u.njt.concat([this.zjt]).forEach(function(t){var n,n,i,n="".concat(t.id),i=r[n];(null!=(n=t.children)?n:[]).sort(function(t,n){return i.indexOf("".concat(t.id))-i.indexOf("".concat(n.id))})}),u.zjt.updateChildrenLevel(),"Custom"===u.Fjt()&&u.g7t()},A.prototype.kjt=function(t){var n,i=this.LEt.schema,r,i,e;if(!((0,_.isNullOrUndefined)(i)||(0,_.isNullOrUndefined)(i.columns)||(i=(r=i.columns)[t],(0,_.isNullOrUndefined)(i))||(e=i.dataName,(0,_.isNullOrEmpty)(e))))return e},A.prototype.Djt=function(t,n,i){var r=this,e=r.LEt.schema,r,e;(0,_.isNullOrUndefined)(e)&&(r.LEt.schema=e={}),r=e.columns,(0,_.isNullOrUndefined)(r)&&(e.columns=r={}),e=r[t],(0,_.isNullOrUndefined)(e)&&(r[t]=e={}),(0,_.isNullOrEmpty)(e.dataName)&&(e.dataName=n),(0,_.isNullOrEmpty)(i)||(r[i]=r[t],delete r[t])},A.prototype.Rbe=function(t){var n,i,r,e,o,n=this,i,r=n.Bjt()[1];for(e in t)o=t[e],t[e]=n.Ajt(o,r[e])},A.prototype._jt=function(t){var n=this;return t=n.Ejt(t,{isServerToClient:!0}),n.Rbe(t),t},A.prototype.jjt=function(t){var n=this;return t=(0,_.clone)(t,!0),n.Ojt(t),t=n.Ejt(t)},A.prototype.Ejt=function(t,n){var i,r,e,n,o,u,s,r=(i=this).LEt.schema,e=(n=n||{}).isServerToClient,n=n.isClone;if(!(0,_.isNullOrUndefined)(t)&&!(0,_.isNullOrUndefined)(r)&&!(0,_.isNullOrUndefined)(r.columns)){for(s in o=r.columns,u=[],o)(0,_.isNullOrUndefined)(o[s].dataName)||o[s].dataName===s||u.push(e?[o[s].dataName,s]:[s,o[s].dataName]);0<u.length&&(t=n?(0,_.clone)(t,!0):t,(0,_.isArray)(t)?t.forEach(function(t){i.Rjt(u,t)}):(0,_.isObject)(t)&&i.Rjt(u,t))}return t},A.prototype.Rjt=function(t,i){t.forEach(function(t){var n=t[0],t=t[1];i[t]=i[n],delete i[n]})},A.prototype.Bjt=function(){var t,n,i,r,e,o,t,n=this.LEt.schema;if((0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(n.columns))return[{},{}];for(o in r={},e={},i=n.columns)i.hasOwnProperty(o)&&((0,_.isNullOrUndefined)(i[o].dataName)||(r[i[o].dataName]=o),i[o].dataType||i[o].dataPattern)&&(e[o]={dataType:i[o].dataType,dataPattern:i[o].dataPattern});return[r,e]},A.prototype.nBe=function(i){var a,h,r,t,n,a=this;if(a.JFe=[],a.eBe(),0<(i=i.slice()).length)for(n in r=a.LEt.schema.columns,h={},t=function(n){var t;r.hasOwnProperty(n)&&(t=r[n],h[n]=t,(0,_.isNullOrUndefined)(t.value)&&(t.value=n),(0,_.isNullOrUndefined)(t.name)&&(t.name=n),(0,_.isNullOrEmpty)(t.dataName)||(h[t.dataName]=t),"formula"===t.dataType?(t.name=n,i.push(n)):i.some(function(t){return(t.field||t)===n})||(t.iBe=!0))},r)t(n);i.forEach(function(t){var n,i,r,e,o,u,s,c,f,n=t.field||t,i=t.dataType,r=a.rBe(),e="object"==typeof t,o=e?Object.keys(t):[];if(t=e&&0<o.length?t:{},h[n]){for(u=0,s=o;u<s.length;u++)f=t[c=s[u]],h[n][c]===f||(0,_.isNullOrEmpty)(f)||(h[n][c]=f);h[n].Kyn=r}else a.LEt.schema.columns[n]=g(g({},t),{Kyn:r,name:n,value:n,dataType:i});a.JFe.push({key:r})}),a.Lbe()},A.prototype.rBe=function(){return this.Kyn++},A.prototype.oBe=function(){var t=this,n=t.LEt;return!t.MOt()&&n.remote.getColumns&&("function"==typeof n.remote.getColumns||!(0,_.isNullOrEmpty)(n.remote.getColumns.url))},A.prototype.aBe=function(){var t;return this.oBe()},A.prototype.eBe=function(){var t=this,n=t.LEt.schema;(0,_.isNullOrUndefined)(n)&&(n=t.LEt.schema={}),(0,_.isNullOrUndefined)(n.columns)&&(n.columns={})},A.prototype.iCe=function(t){var n=this;return n.eBe(),!n.gCe(t)},A.prototype.uBe=function(t){var n,i,t,r,e,t,n=this,i=t.source,t=t.name;i&&(r=n.LEt.schema.columns,delete n.LEt.schema.columns[t],delete n._data[t],n.DEt.splice(n.DEt.indexOf(t),1),n.X7t()?(e=i.columnStatus.key,-1<(t=n.JFe.findIndex(function(t){return t.key===e}))&&n.JFe.splice(t,1),n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})):i.postData&&n.sBe()?n.rOt({body:i.postData},y.REMOVE_COLUMN).then(function(){n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)})}):n.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},r)}))},A.prototype.cBe=function(i,r,e,t){var o=this;o.eBe(),i=g(g({},i),{Kyn:o.rBe()}),r=r||[],o.fBe(i,r,function(t){var n;t.source=t.source||{},o.lBe(i),o.iCe(i.name)&&(o.Lbe(),0<r.length)&&(n=o._data[i.name])&&(n.data=r),o.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:i}),e&&e(t)},t)},A.prototype.lBe=function(t){var n,i;this.LEt.schema.columns[t.name]=g({},t)},A.prototype.hBe=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,v,p,w;if((0,_.isNullOrUndefined)(n)||0===n.length)return[];for(o={},u=0,s=e=(r=this).Ljt();u<s.length;u++)c=s[u],(f=r._data[c])&&f.data&&0<f.data.length&&(o[c]=f.data);for(a=Object.keys(o),h=[],l=0;l<n.length;l++){for((i={})[t.name]=n[l],d=i,v=0,p=a;v<p.length;v++)d[w=p[v]]=o[w][l];h.push(d)}return h},A.prototype.fBe=function(t,n,i,r){var e,o,u,e=this,o=!(0,_.isNamedFormulaColumn)(t);e.X7t()?(e.JFe.push({key:t.Kyn,status:1,column:g({},t),originalColumnData:n.slice()}),u={columnStatus:g({},e.JFe[e.JFe.length-1])},i&&i({type:y.ADD_COLUMN,success:!0,source:u})):o&&e.sBe()?(u={postData:{column:g(g({},t),{field:t.dataName||t.value})}},i&&i({type:y.ADD_COLUMN,success:!0,source:u}),e.dBe(t,e.hBe(t,n),m,r)):i&&i({type:y.ADD_COLUMN,success:!0})},A.prototype.dBe=function(t,n,i,r){var e;this.rOt({body:{column:g(g({},t),{field:t.dataName||t.value}),data:n}},y.ADD_COLUMN).then(function(){i&&i({type:y.ADD_COLUMN,success:!0})}).catch(function(t){r&&r({type:y.ADD_COLUMN,success:!1,reason:t})})},A.prototype.vBe=function(t){var n,i,t,r,e,t,n=this,i=t.source,t=t.name;i&&(i.column&&(n.LEt.schema.columns[t]=i.column),i.data&&(n._data[t]=i.data),i.name&&n.DEt.splice(i.nameIndex,0,i.name),r=i.column,n.X7t()?(e=r.Kyn,-1<(t=n.JFe.findIndex(function(t){return t.key===e}))?n.JFe[t]=i.columnStatus:n.JFe.push(i.columnStatus),n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})):i.postData&&n.sBe()?n.dBe(r,function(){n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)})}):n.ki(y.ONCHANGE,{action:y.ADD_COLUMN,column:g({},r)}))},A.prototype.gBe=function(r,e,t){var n,n,o,u,o=this;o.eBe(),u=null==(n=null==(n=o.LEt.schema)?void 0:n.columns)?void 0:n[r],o.mBe(r,function(t){var n,i,n=t.source=t.source||{};n.column=g({},o.LEt.schema.columns[r]),o.pBe(r),o.iCe(r)&&(n.data=o._data[r],delete o._data[r],i=o.DEt.findIndex(function(t){return t===r}),n.name=o.DEt[i],n.nameIndex=i,o.DEt.splice(i,1)),o.ki(y.ONCHANGE,{action:y.REMOVE_COLUMN,column:g({},u)}),e&&e(t)},t)},A.prototype.pBe=function(t){var n,i;delete this.LEt.schema.columns[t]},A.prototype.mBe=function(t,n,i){var r,e,o,o,u,s,c,t,r=this,e=r.LEt.schema.columns[t],o=!e.iBe,o=!r.gCe(t)&&o;e.isPrimaryKey&&i&&i({type:y.REMOVE_COLUMN,success:!1}),r.X7t()?(u=e.Kyn,c=void 0,-1<(s=r.JFe.findIndex(function(t){return t.key===u}))&&(c={columnStatus:g({},r.JFe[s])},1===r.JFe[s].status?r.JFe.splice(s,1):(2!==r.JFe[s].status&&(r.JFe[s].originalColumn=g({},e),o)&&(r.JFe[s].originalColumnData=r._data[t].data.slice()),r.JFe[s].status=3)),n&&n({type:y.REMOVE_COLUMN,success:!0,source:c})):o&&r.sBe()?(c={postData:t={column:{field:e.dataName||e.value}}},n&&n({type:y.REMOVE_COLUMN,success:!0,source:c}),r.rOt({body:t},y.REMOVE_COLUMN).catch(function(t){i&&i({type:y.REMOVE_COLUMN,success:!1,reason:t})})):n&&n({type:y.REMOVE_COLUMN,success:!0})},A.prototype.bBe=function(t){var n,t,i,r,e,o,n=this,t=t.source;t&&(i=t.originalColumn,r=t.column,t.originalColumn&&n.wBe(r.value,i,!0),t.shouldUpdateLocalField&&n.qFe(r.value,i.value),t.shouldUpdateDataType&&(n._data[i.value].data=t.data),n.X7t()?(e=i.Kyn,-1<(o=n.JFe.findIndex(function(t){return t.key===e}))&&(n.JFe[o]=t.columnStatus),n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})):t.postData&&n.sBe()?n.rOt({body:{column:t.postData.originalColumn,originalColumn:t.postData.column}},y.UPDATE_COLUMN).then(function(){n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)})}):n.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:g({},i),originalColumn:g({},r)}))},A.prototype.yBe=function(i,r,e,t){var n,n,o,u,o=this;return o.eBe(),u=null==(n=null==(n=o.LEt.schema)?void 0:n.columns)?void 0:n[i],o.CBe(i,r,function(t){var n=t.source=t.source||{};n.originalColumn=x(u,i),n.column=x(r,i),o.iCe(i)&&o.MBe(i,r,n),o.wBe(i,r),o.ki(y.ONCHANGE,{action:y.UPDATE_COLUMN,column:r,originalColumn:u}),e&&e(t)},t)},A.prototype.wBe=function(t,n,i){var r,e,t,r,e=this.LEt.schema,t=e.columns[t];(0,_.isNullOrUndefined)(t)||(t.name!==n.name&&delete e.columns[t.name],e.columns[n.name]=i||n.type!==t.type?g({},n):g(g({},t),n))},A.prototype.CBe=function(t,n,i,r){var e,o,u,s,u,c,f,a,h,l,d,v,p,w,b,m,j,h,a,e=this,o=x(e.LEt.schema.columns[t],t);if(n=n.type!==o.type?x(g({},n),t):x(g(g({},o),n),t),u=!o.iBe,u=!(s=e.gCe(t))&&u,c=o.dataName,f=n.dataName,a=!(0,_.isNullOrEmpty)(c),h=!(0,_.isNullOrEmpty)(f),d=o.value!==n.value,v=o.dataType!==n.dataType,p=o.isPrimaryKey!==n.isPrimaryKey,w=o.dataPattern!==n.dataPattern,b=!((l=!1)||v||p||(0,_.isEqual)(o,n,!0,!0)),a&&h?c!==f&&(l=!0):h?o.value!==f&&(l=!0,c=o.value):a?c!==n.value&&(l=!0,f=n.value):d&&(l=!0,c=o.value,f=n.value),e.X7t())m=void 0,j=o.Kyn,-1<(h=e.JFe.findIndex(function(t){return t.key===j}))&&(m={columnStatus:g({},e.JFe[h])},1!==e.JFe[h].status&&(e.JFe[h].status=2,(0,_.isNullOrUndefined)(e.JFe[h].originalColumn))&&(u&&(v||w)&&(e.JFe[h].originalColumnData=e._data[t].data.slice()),e.JFe[h].originalColumn=g({},o)),e.JFe[h].column=g(g({},n),{Kyn:j})),i&&i({type:y.UPDATE_COLUMN,success:!0,source:m});else{if(u&&(l||v||p||b)&&e.sBe())return a={column:g(g({},n),{field:t}),originalColumn:g(g({},o),{field:c||t})},l&&(a.column.field=f),m={postData:a},i&&i({type:y.UPDATE_COLUMN,success:!0,source:m}),e.rOt({body:a},y.UPDATE_COLUMN).catch(function(t){r&&r({type:y.UPDATE_COLUMN,success:!1,reason:t})});i&&i({type:y.UPDATE_COLUMN,success:!0})}},A.prototype.MBe=function(t,n,i){var r,e,o,u,s,r=this,e=x(r.LEt.schema.columns[t],t);n=n.type!==e.type?x(g({},n),t):x(g(g({},e),n),t),o=e.value!==n.value,u=e.dataType!==n.dataType,s=e.dataPattern!==n.dataPattern,o&&(i.shouldUpdateLocalField=!0,r.qFe(e.value,n.value)),(u||s)&&(i.shouldUpdateDataType=!0,i.data=r.SBe(t).slice(),r.xjt(n.value,n.dataType,n.dataPattern))},A.prototype.Ljt=function(){var t,n,i,r,e,o,t,n=this.LEt.schema,i=[];if(!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.columns))for(e in r=n.columns)r.hasOwnProperty(e)&&(o=r[e]).isPrimaryKey&&i.push(e);return i},A.prototype.Ojt=function(t){var n,i,n,r,n=this;!(0,_.isNullOrUndefined)(t)&&n.isHierarchy()&&"Level"===n.Fjt()&&(i=n.Pjt(),(0,_.isNumber)(i))&&(r=t[n=n.Gjt()],t[n]=r-i)},A.prototype.Ujt=function(i){var t,n;return this.njt.map(function(t,n){t.lp=n,i||(t.sequence=n+1);var n=t._data;return t._data=j,n})},A.prototype.Hjt=function(t){var n=this,i=n.zjt,r=n.njt=[];return(0,_.traversalTree)(i,function(t){t.level=t.parent.level+1,r.push(t)},t?{isOrderChildren:!0,getValue:function(t){return t.qEt}}:j),n.Ujt(t)},A.prototype.Vjt=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,d,v,p,w,o=this,u=!(0,_.isNullOrEmpty)(r),s=n,c=r;for(n=o.Yjt(n),i=o.Yjt(i),r=o.Yjt(r),f={},a=0;a<t.length;a++)h=t[a],l=new R(o.Zjt({data:h,idField:s,sequenceField:c})),d=h[n],f[l.id=d]=l,u&&(l.sequence=h[r]);for((v=new R({isRoot:!0})).level=e-1,a=0;a<t.length;a++)d=t[a][n],p=t[a][i],l=f[d],(0,_.isNullOrUndefined)(w=f[p])?(v.id=p,l.parent=v):l.parent=w;return o.zjt=v,o.Hjt(u)},A.prototype.Wjt=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,d,v,p,w,b,o=this,u=!(0,_.isNullOrEmpty)(r),s=n,c=r;for(n=o.Yjt(n),i=o.Yjt(i),r=o.Yjt(r),f=j,a=0;a<t.length;a++)((h=t[a][i])<f||f===j)&&(f=h);for(f===j&&(f=0),(l=o.zjt=new R({isRoot:!0})).level=f+e-1,d=[l],a=0;a<t.length;a++){for(v=t[a],p=new R(o.Zjt({data:v,idField:s,sequenceField:c})),w=(0,_.isNullOrEmpty)(n)?F(a):v[n],h=v[i]+e,p.id=w,u&&(p.sequence=v[r]),b=d[d.length-1];b.level>=h;)b=d.pop().parent;p.parent=b,d.push(p)}return o.Hjt(u)},A.prototype.Qjt=function(t,i,n,r,e){var e,o,u,s,c,f,a,h,o=this,u=o.njt=[],s=!(0,_.isNullOrEmpty)(r),c=i,f=r;return i=o.Yjt(i),n=o.Yjt(n),r=o.Yjt(r),(a=o.zjt=new R({isRoot:!0})).level=e-1,h=[a],(0,_.traversalTree)(((e={})[n]=t,e),{invoking:function(t){var n=new R(o.Zjt({data:t,idField:c,sequenceField:f}));n.id=(0,_.isNullOrEmpty)(i)?F(u.length):t[i],s&&(n.sequence=t[r]),n.parent=h[h.length-1],u.push(n),h.push(n)},invoked:function(){h.pop()}},s?r:j,n),o.Ujt(s)},A.prototype.Kjt=function(t,n,i,r,e,o){var u,s,c,f,a,h,l,d,v,p,w,b,b,u=this,s=!(0,_.isNullOrEmpty)(e),c=n,f=e;for(n=u.Yjt(n),i=u.Yjt(i),e=u.Yjt(e),a={},h=0;h<t.length;h++)l=t[h],d=new R(u.Zjt({data:l,idField:c,sequenceField:f})),v=l[i],d.id=(0,_.isNullOrEmpty)(n)?F(h):l[n],a[v]=d,s&&(d.sequence=l[e]);for(p=u.Bjt(),(w=new R({isRoot:!0})).level=o-1,h=0;h<t.length;h++)d=a[v=t[h][i]],b=r(u.Jjt(t[h],p,h)),(0,_.isNullOrUndefined)(b=a[b])?d.parent=w:d.parent=b;return u.zjt=w,u.Hjt(s)},A.prototype.Jjt=function(u,i,t){var s=this,t={index:t};return Object.defineProperty(t,"data",{get:function(){var r,e,o,t,n,r=i[0],e=i[1],o={},t=function(t){var n,i;u.hasOwnProperty(t)&&(n=u[t],i=r[t]||t,Object.defineProperty(o,i,{get:function(){return s.Ajt(n,e[i])}}))};for(n in u)t(n);return o}}),t},A.prototype.Zjt=function(t){var n=this;return{data:t.data,idField:t.idField,sequenceField:t.sequenceField,getData:n.bjt.bind(n),getFieldData:n.Xjt.bind(n)}},A.prototype.ABe=function(t,n){var i,r,i,e,i,o,u,s,c,f,a,h,r=this,i=r.LEt.schema;if(r.isHierarchy()){if(e=i.hierarchy.type.trim(),i=null==(i=i.hierarchy.column)?void 0:i.trim(),o=r.$jt(),u=r.Ljt(),"Parent"===e){if(t===(s=u[0])||t===i||t===o)return!0}else if("Level"===e){if(t===(s=u[0])||t===i||t===o)return!0}else if("ChildrenPath"===e){if(t===(s=u[0])||t===i||t===o)return!0}else if("Custom"===e&&(t===(s=u[0])||t===i||t===o))return!0;if(!n&&r.l7t(t))return!0}return!1},A.prototype.qjt=function(t){var n,i,r,e,n,o,u,s,c,f,a,h,l,e,i=this,r=i.LEt.schema;return i.isHierarchy()&&(e=r.hierarchy.type.trim(),n=null==(n=r.hierarchy.column)?void 0:n.trim(),o=r.hierarchy.levelOffset||0,u=i.Ljt(),s=i.$jt(t),"Parent"===e?(c=u[0],t=i.Vjt(t,c,n,s,o)):"Level"===e?(c=u[0],t=i.Wjt(t,c,n,s,o)):"ChildrenPath"===e?(c=u[0],t=i.Qjt(t,c,n,s,o)):"Custom"===e&&(c=u[0],e=r.hierarchy.parse,t=i.Kjt(t,c,n,e,s,o)),i.t7t(),i.ejt=!1),t},A.prototype.t7t=function(){var t,n,i,r,e,t=this,n=t.$jt(),i=t.njt.slice();for((0,_.isNullOrEmpty)(n)||i.sort(function(t,n){return t.sjt()-n.sjt()}),r=0;r<i.length;r++)(e=i[r]).prev=i[r-1],e.next=i[r+1]},A.prototype.$jt=function(t){var n,i,r,e,o,n=this,i=n.LEt.schema;if(!(0,_.isNullOrUndefined)(i)&&!(0,_.isNullOrUndefined)(i.columns))for(e in r=i.columns)if(Object.prototype.hasOwnProperty.call(r,e)&&"rowOrder"===(o=r[e]).dataType&&(o.n7t||n.e7t(e,t)))return o.n7t=!0,e},A.prototype.e7t=function(t,n){var i,r,e;if(!(0,_.isNullOrUndefined)(t)&&(0,_.isArray)(n)){if(0===n.length)return!0;for(t=(i=this).Yjt(t),r=0;r<n.length;r++)if(e=n[r][t],!(0,_.isNullOrUndefined)(e))return(0,_.isNumber)(e)}},A.prototype.qX=function(){var t=this;return!(!t.isHierarchy()||"Parent"===t.Fjt()&&(0,_.isNullOrUndefined)(t.$jt()))},A.prototype.i7t=function(){return this.options.schema.hierarchy.summaryFields},A.prototype.Pjt=function(){return this.options.schema.hierarchy.levelOffset},A.prototype.r7t=function(){return this.options.schema.hierarchy.unparse},A.prototype.Gjt=function(){return this.options.schema.hierarchy.column},A.prototype.Fjt=function(){return this.options.schema.hierarchy.type},A.prototype.o7t=function(){var t,n;return this.Ljt()[0]},A.prototype.isHierarchy=function(){var t,t,n,n=this.options.schema;return!(0,_.isNullOrUndefined)(n)&&!(0,_.isNullOrUndefined)(n.hierarchy)&&!(0,_.isNullOrUndefined)(null==(t=n.hierarchy.type)?void 0:t.trim())&&!(0,_.isNullOrUndefined)(null==(t=n.hierarchy.column)?void 0:t.trim())&&("Custom"!==n.hierarchy.type||(0,_.isFunction)(n.hierarchy.parse)&&(0,_.isFunction)(n.hierarchy.unparse))},A.prototype.a7t=function(){return this.ejt},A.prototype.u7t=function(){this.ejt=!0},A.prototype.SEt=function(t){var n=this;return t=n.s7t(t),n.c7t(t)},A.prototype.c7t=function(t){var n,i;return this.njt[t]},A.prototype.f7t=function(){return this.zjt},A.prototype.l7t=function(t){var n,i=this.i7t();if(!(0,_.isNullOrUndefined)(i))return i[t]},A.prototype.h7t=function(t,n){var i,t,i,i=this,t=i.l7t(t);if(!(0,_.isNullOrEmpty)(t)&&(i=i.SEt(n),!(0,_.isNullOrUndefined)(i))&&0<i.children.length)return t},A.prototype.Yjt=function(t){var n,i,r,e,n,i=this.LEt.schema;if(!(0,_.isNullOrUndefined)(i)&&!(0,_.isNullOrUndefined)(i.columns))for(e in r=i.columns)if(e===t)return r[e].dataName||t;return t},A.prototype.d7t=function(t,n,i){var r=this;return r.v7t(i,(0,_.isNumber)(t)?r.s7t(t):t,r.s7t(n))},A.prototype.v7t=function(t,n,i){var r=this,e=r.njt,o=r.$jt(),u,s=function(t){return r.isHierarchy()?r.njt[t].sequence:r._data[o].data[t]};return t?(n=e[i].next&&e[i].next.lp,(0,_.isNullOrUndefined)(n)?(u=s(i),Math.floor(u)===u?u+=.5:u=(u+Math.ceil(u))/2):u=(s(i)+s(n))/2):(n=e[i].prev&&e[i].prev.lp,u=(0,_.isNullOrUndefined)(n)?(u=s(i))<=1?u/2:u-.5:(s(n)+s(i))/2),u},A.prototype.Cue=function(){return this.Mue},A.prototype.Sue=function(t){this.Mue=t},A.prototype.m7t=function(t,n,i,r){var e,o,u,s,c,f,n,a,h,f,l,d,f,e,o,d,l,u=this,s=u.$jt(),c=u.isHierarchy();if((0,_.isNullOrUndefined)(s)&&!c||n===i||(0,_.isNullOrUndefined)(n)||(0,_.isNullOrUndefined)(i))return!1;if(i=u.s7t(i),r=(0,_.isNumber)(r)?u.s7t(r):r,n=u.s7t(n),h=(a=u.njt)[n],f=a[i],c){if(f.parent!==h.parent)return!1;e=0,(t=(d=(l=h.parent.children).indexOf(h))<(f=l.indexOf(f)))?(e=null==(o=h.getNextSibling())?void 0:o.lp,l.splice(f+1,0,h),l.splice(d,1)):(e=n,l.splice(d,1),l.splice(f,0,h)),"Custom"===u.Fjt()&&u.g7t(e),!(0,_.isNullOrUndefined)(r)&&(o=a[r],d=h.parent===o,l=h.parent.parent===o.parent,d||l)&&(r=j)}return f=u.v7t(t,r,i),c&&(0,_.isNullOrUndefined)(s)&&(h.sequence=f),u.p7t(t,i,n),(0,_.isNullOrUndefined)(s)||u.b7t(n,((e={})[s]=f,e)),!0},A.prototype.p7t=function(t,n,i){var r,e,i,r,r=this,e;r.isHierarchy()&&(i=r.c7t((0,_.isNumber)(i)?i:r.njt.length-1),r=r.c7t(n),(0,_.isNullOrUndefined)(i.prev)||(i.prev.next=i.next),(0,_.isNullOrUndefined)(i.next)||(i.next.prev=i.prev),t?(i.prev=r,i.next=r.next,(0,_.isNullOrUndefined)(r.next)||(r.next.prev=i),r.next=i):(i.next=r,i.prev=r.prev,(0,_.isNullOrUndefined)(r.prev)||(r.prev.next=i),r.prev=i))},A.prototype.y7t=function(t,n){var i,r,e,i=this,r;if(i.isHierarchy())for(n=n||1,e=0;e<n;e++)i.w7t(e+t)},A.prototype.w7t=function(t){var n,t=this.c7t(t);(0,_.isNullOrUndefined)(t.prev)||(t.prev.next=t.next),(0,_.isNullOrUndefined)(t.next)||(t.next.prev=t.prev)},A.prototype.M7t=function(t){var n,i,i,r,e,o,u,s,e,n,c,f,a,h;if(this.isHierarchy()&&(e=(r=this).njt,o=r.Gjt(),!(u=e[t=r.s7t(t)]).parent.isRoot)){for(s=r.Fjt(),e=u.parent.children.slice(u.getCurrentIndex()+1),n=u.parent.parent,u.promote(n),"Parent"===s?r.b7t(t,((n={})[o]=I(u.parentId),n)):"Level"===s&&r.C7t(t),c=0,f=e;c<f.length;c++)(a=f[c]).parent=u,h=a.lp,"Parent"===s?r.b7t(h,((i={})[o]=u.id,i)):"Level"===s&&r.b7t(h,((i={})[o]=a.level,i));"Custom"===s&&r.g7t(t)}},A.prototype.S7t=function(t,n){this.T7t(t,n)},A.prototype.T7t=function(t,n,i){var n,n,n,r,e,o,u,i,s,i;this.isHierarchy()&&(n=!1!==n,e=(r=this).njt,o=r.Gjt(),t=i?t:r.s7t(t),i=(u=e[t]).getPrevSibling(),(0,_.isNullOrUndefined)(i)||(s=u.children.slice(),u.demote(i,n),i=r.Fjt(),n?"Parent"===i?r.b7t(t,((n={})[o]=I(u.parentId),n)):"Level"===i?r.C7t(t):"Custom"===i&&r.g7t(t):"Parent"===i?(r.b7t(t,((n={})[o]=I(u.parentId),n)),s.forEach(function(t){var t;r.b7t(t.lp,((t={})[o]=I(u.parentId),t))})):"Level"===i?r.b7t(t,((n={})[o]=e[t].level,n)):"Custom"===i&&r.g7t(t)))},A.prototype.b7t=function(t,n,i,r){this.A7t(t,n,i,r)},A.prototype.A7t=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n,x7t:!0,N7t:!0}),i&&i({type:y.UPDATE,success:!0})},A.prototype.C7t=function(t,n,i){for(var r,e,o,u,s,c,f,e=this,o=e.njt,u=e.Gjt(),s=o[t].getChildrenIndexes().concat(t),c=0;c<s.length;c++)f=s[c],e.b7t(f,((r={})[u]=o[f].level,r),n,i)},A.prototype.g7t=function(r,e,o){var u=this,s=!!(0,_.isNullOrUndefined)(r),c=u.Gjt();(0,_.traversalTree)(u.zjt,function(t){var n,i,n,t;(s=!1===s&&r===t.lp?!0:s)&&(n=t.lp,t=u.k7t(t),(0,_.isNullOrUndefined)(t)||u.b7t(n,((n={})[c]=t,n),e,o))})},A.prototype.k7t=function(t){var n,i,r,e,i,r,n=this,i=n.Gjt(),r=n.r7t(),e,i=t.data[i],r=null==r?void 0:r(n.D7t(t));if(i!==r)return r},A.prototype.D7t=function(t){var n={};return Object.defineProperty(n,"data",{get:function(){return t.data}}),Object.defineProperty(n,"index",{get:function(){return t.getCurrentIndex()}}),Object.defineProperty(n,"parentData",{get:function(){return t.parent.isRoot?m:t.parent.data}}),n},A.prototype._7t=function(t,n,i,r){var e=this,t=e.c7t(t);return e.E7t(t.parent,n?t.getCurrentIndex():t.getCurrentIndex()+1,i,r)},A.prototype.j7t=function(t){var n=this,t=n.c7t(t),i=t.getPrevSibling(),n,n=(0,_.isNullOrUndefined)(i)?n.v7t(!1,j,t.lp):n.v7t(!1,i.lp,t.lp);return{sequence:n,offset:0}},A.prototype.O7t=function(t,n,i){var r,e,n,r=this;return t=r.s7t(t),e=r.j7t(t).sequence,(n=r._7t(t,!0,n,i)).sequence=e,r.p7t(!1,t),n},A.prototype.R7t=function(t){var n=this,t=n.c7t(t),i=t.getNextSibling(),i,i=(0,_.isNullOrUndefined)(i)?n.v7t(!0,j,t.lp):n.v7t(!0,i.lp,t.lp);return{sequence:i,offset:n.B7t(t)}},A.prototype.L7t=function(t,n,i){var r,e,n,r=this;return t=r.s7t(t),e=r.R7t(t).sequence,(n=r._7t(t,!1,n,i)).sequence=e,r.p7t(!0,t),n},A.prototype.F7t=function(t,n){var i,r,n,i=this;return t=i.s7t(t),r=i.j7t(t).sequence,(n=i._7t(t,!0,n)).sequence=r,i.T7t(t,!0,!0),i.p7t(!1,t),n},A.prototype.P7t=function(t){var n,t,i,r,i,i,n=this,t=n.c7t(t),i=t.children,i=0<i.length?(i=i[i.length-1],r=n.v7t(!0,j,i.lp),n.B7t(t)):(r=n.v7t(!0,j,t.lp),1);return{sequence:r,offset:i}},A.prototype.G7t=function(t,n){var i,r,n,i=this;return t=i.s7t(t),r=i.P7t(t).sequence,(n=i._7t(t,!1,n)).sequence=r,i.U7t(i.njt.length-1),i.p7t(!0,t),n},A.prototype.U7t=function(t){var n,t,i,n,t=this.c7t(t),i=t.getPrevSibling();(0,_.isNullOrUndefined)(i)||t.demote(i)},A.prototype.E7t=function(t,n,i,r){var e,o,u,s,s,e,e=this,o=e.njt,u=e.o7t(),s=e.$jt(),s=new R(e.Zjt({idField:u,sequenceField:s})),e=e.vjt+1;return(0,_.isNullOrUndefined)(null==r?void 0:r.id)?(0,_.isNullOrUndefined)(i)||(0,_.isNullOrUndefined)(i[u])?s.id=F(e):s.id=i[u]:s.id=r.id,s.lp=e-1,s.setParent(t,n),o.push(s),s},A.prototype.Xme=function(t,n){var i,r,i,i=this,r=this.f7t(),i=i.E7t(r,void 0,t,n);return i.sequence=1,i},A.prototype.H7t=function(t){var n,i,r,e,o,u,r,n,i,e=this,o=e.$jt(),u=e.Gjt(),r=e.Fjt();return"Parent"===r?((n={})[u]=I(t.parentId),n=n):"Level"===r?((i={})[u]=t.level,n=i):"Custom"===r&&(i=e.k7t(t),(0,_.isNullOrUndefined)(i)||((r={})[u]=i,n=r)),(0,_.isNullOrEmpty)(o)||((n=n||{})[o]=t.sjt()),n},A.prototype.z7t=function(t,n,i){var r,t,e,n,r=this,t=r.SEt(t);return n?(n=t.getNextSibling(),(0,_.isNullOrUndefined)(n)||(e=!1===i?n:t)):e=!1===i?t:t.getPrevSibling(),r.B7t(e)},A.prototype.B7t=function(t){var n,i,r,n=1,i=function(t){return t.children.reduce(function(t,n){return t+i(n)},t.children.length)};return(0,_.isNullOrUndefined)(t)?0:(r=i(t))+1},A.prototype.V7t=function(t){var n=this,t=n.SEt(t);return n.B7t(t)},A.prototype.Y7t=function(t){var n,i,i,n=this;n.isHierarchy()&&(i=n.o7t(),!(0,_.isNullOrUndefined)(i)&&b(t[i])&&(t[i]=j),"Parent"===n.Fjt())&&b(t[i=n.Gjt()])&&(t[i]=j)},A.prototype.Z7t=function(t,n){var i,r,i,e,o,u,s,r=this;r.isHierarchy()&&"Parent"===r.Fjt()&&(i=r.o7t(),(0,_.isNullOrUndefined)(i)||(o=(e=r.c7t(t)).children,u=e.id=e.JEt=r.Xjt(i,t),s=r.Gjt(),o.forEach(function(t){var t;t.XEt=u,r.b7t(t.lp,((t={})[s]=u,t))}),n&&(0,_.isNullOrEmpty)(n[s])&&!e.parent.isRoot&&!b(e.parentId)&&r.b7t(t,((i={})[s]=e.parentId,i))))},A.prototype.Tue=function(t){for(var n,i,r,e,o,n=[],i,r=0,e=(0,_.keys)(t);r<e.length;r++)t[o=e[r]].spread&&n.push(o);return n},A.prototype.Aue=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,r=(0,_.keys)(t);if(0===r.length)return t;for(e={},o=0,u=r;o<u.length;o++)if(c=t[s=u[o]],0<=n.indexOf(s))for(f={},i&&(i[s]=f),l=a=(h=0,_.keys)(c);h<l.length;h++)d=l[h],0<=r.indexOf(d)?(e[s+"_"+d]=c[d],i&&(f[s+"_"+d]=d)):(e[d]=c[d],i&&(f[d]=d));else e[s]=c,i&&(i[s]=s);return e},A.prototype.Iue=function(t,i){var r,n,n,e,r=this,n=r.LEt,n=n&&n.schema&&n.schema.columns;return t=n&&0<(e=r.Tue(n)).length?t.map(function(t,n){return r.Aue(t,e,0===n?i:j)}):t},A.prototype.xue=function(t){var n,i,i,i,n=this,i=n.LEt,i=i&&i.schema&&i.schema.columns;return t=i&&0<(i=n.Tue(i)).length?n.Aue(t,i):t},A.prototype.Nue=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,i=(0,_.keys)(n);if(0===i.length)return t;for(r={},e=0,o=i;e<o.length;e++)if("object"==typeof(s=n[u=o[e]]))for(r[u]=c={},h=f=(a=0,_.keys)(s);a<h.length;a++)c[s[l=h[a]]]=t[l];else"string"==typeof s&&(r[u]=t[s]);return r},A.prototype.kue=function(t){var n,i,n=this,i=n.Due;return t=i?t&&n.Nue(t,i):t},A.prototype.xBe=function(t){var n,i,i,i,r,e,o,n=this,i=n.LEt,i=i&&i.schema&&i.schema.columns;if(i&&0<(i=n.Tue(i)).length&&n.Due)for(r=0,e=i;r<e.length;r++)if(o=e[r],n.Due[o][t])return!0},A.prototype.load=function(f){var a,n,t,h,a=this,n=a.options.remote;return n&&n.read&&!(0,_.isFunction)(n.read)&&(0,_.isNullOrEmpty)(n.read.url)?(a.ki(d,{type:"read",success:!(t="InvalidRemoteOption"),reason:t}),Promise.resolve([])):(h=a.W7t(f),a.yjt(h)?(a.ojt=!0,a.Q7t(h).then(function(t){var t={type:"read",data:n&&n.read&&!(0,_.isFunction)(n.read)?G(n.read.adapter,t):t};return a.ki(S,t)?Promise.reject({cancel:!0,type:"read",step:l}):a.djt.parse(t.data)}).then(function(t){return a.wjt=a.djt.total(t),a.djt.read(t)}).then(function(t){var n,i,r,e,o,u,s,c;if(a._data=(!f||!f.reload)&&a._data||{},a.vjt=a.vjt||0,a.DEt=(!f||!f.reload)&&a.DEt||[],t){for(t=(0,_.isArray)(t)?t:[t],t=a.qjt(t),a.Due={},t=a.Iue(t,a.Due),n=0,r=(i=a.Bjt())[0],e=i[1],o=0,u=t.length;o<u;o++)for(s in t[o])c=t[o][s],s=r[s]||s,a._data[s]||(a._data[s]={data:[]},a.DEt.push(s)),a._data[s].data[0+o]=a.Ajt(c,e[s]);a.nBe(a.DEt),a.vjt=0+t.length,t=a.K7t(h).data,a.ki(y.ONCHANGE,{action:y.INSERT,index:0,items:t})}return a.wjt=a.vjt,a.ki(d,{type:"read",success:!0,items:t}),t}).then(function(n){return a.aBe()?a.Q7t(h,y.GET_COLUMNS).then(function(t){return(0,_.isArray)(t)&&a.nBe(t),n}):n}).catch(function(t){var t=t&&!0===t.cancel?C+t.step:a.J7t(t);return a.ki(d,{type:"read",success:!1,reason:t}),Promise.reject(t)})):Promise.resolve(a.K7t(h).data))},A.prototype.Lbe=function(t){var t,n,i,r,e,o,u,s,n=this,i=function(t){n._data[t]||(n._data[t]={data:[]},n.DEt.push(t))};if(t)for(r=0,e=t;r<e.length;r++)i(o=e[r]);else if(u=null==(t=n.options.schema)?void 0:t.columns)for(s in u)u[s].spread||"formula"===u[s].dataType||i(s)},A.prototype.$ue=function(t,n){for(var i,r,e,o,u,s,c,f,a,i=[],r=0,e=n.fields;r<e.length;r++)for(s=0,c=u=t[o=e[r]].data;s<c.length;s++)f=c[s],(a={})[n.as]=o,a[n.valueAs]=f,i.push(a);return i},A.prototype.AP=function(t){for(var n,i,r,e,o,u,s,n=[],i,r=0,e=Object.keys(t);r<e.length;r++)for(u=t[o=e[r]].data,s=0;s<u.length;s++)n[s]||(n[s]={}),n[s][o]=u[s];return n},A.prototype.loadSync=function(t,n){var i,r,n,e,n,o,u,s,c,f,a,i=this;if(i.ojt=!0,r=(0,_.isNullOrUndefined)(t)?n?i.AP(i._data):(n=i.hjt.getDataSync(),i.wjt=i.djt.total(n),i.djt.readSync(n)):i.$ue(i._data,t),i._data={},i.vjt=0,i.DEt=[],r){for(r=(0,_.isArray)(r)?r:[r],e=0,o=(n=i.Bjt())[0],u=n[1],s=0,c=r.length;s<c;s++)for(f in r[s])a=r[s][f],f=o[f]||f,i._data[f]||(i._data[f]={data:[]},i.DEt.push(f)),i._data[f].data[0+s]=i.Ajt(a,u[f]);return i.nBe(i.DEt),i.vjt=0+r.length,r=i.K7t().data,i.wjt=i.vjt,r}return[]},A.prototype.length=function(){return"number"==typeof this.wjt?this.wjt:this.vjt},A.prototype.setLength=function(t){var n=this,i=n._data,n=n.wjt;(0,_.isNullOrUndefined)(n)?i&&(this.vjt=t):this.wjt=t},A.prototype.K7t=function(t){var n,i,r,e,o,u,s,n=this,i=n.X7t(),r=0,e=n.vjt,o=i?n.s7t(0):0,u=n.q7t||[];for(i||(u=[]),s=[];0<e&&o<n.vjt;)u[o]||(s.push(n.bjt(o)),e--),o++;return{data:s}},A.prototype.$7t=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,i=this,r=i.X7t(),e=0,o=i.vjt,u=r?i.s7t(0):0,s=i.q7t||[];if(0===(s=r?s:[]).length){for(c=[],f=0;f<t.length;f++)c[a=t[f]]=i.bjt(a);return{data:c}}for(h=[],l=0;0<o&&u<i.vjt;)s[u]||(-1<t.indexOf(l)&&(h[l]=i.bjt(u)),l++,o--),u++;return{data:h}},A.prototype.tOt=function(t){return(t?this.$7t(t):this.K7t()).data},A.prototype.nOt=function(t,n){var i,r,i,r,i,e,o,u,s,c,r=this,i=r.Fjt(),e=[];if(!(0,_.isNullOrUndefined)(n)&&t.length===n.length)if("Level"===i)for(o=0;o<t.length;o++)u=t[o],e.push(N(u,n[o]));else"ChildrenPath"===i&&(s=r.Yjt(r.Gjt()),c=[((i={})[s]=e,i)],M(((r={})[s]=t,r),((i={})[s]=n,i),s,function(t,n){var t,n,t=N(t,n);delete t[s],n=c[c.length-1],(0,_.isArray)(n[s])||(n[s]=[]),n[s].push(t),c.push(t)},function(){c.pop()}));return e},A.prototype.eOt=function(t){var n,i,r,e,r,o,u,n,s,c,f,a,h,i,l,d,i,e=this,r=e.Fjt();if(!(0,_.isNullOrUndefined)(t)){if(o=e.f7t(),s=e.Gjt(),"Level"===r){for(u="children",f=e.Yjt(s),(n={})[u]=[],n.data={},a=[n=n],h=0;h<t.length;h++){for(l=(i=t[h])[f],d=a[a.length-1];d.data.level>=l;)a.pop(),d=a[a.length-1];(i={data:i})[u]=[],i=i,d[u].push(i),a.push(i)}c=function(t){return t.data}}else"ChildrenPath"===r&&((r={})[u=s]=t,n=r,c=function(t){return t});M(o,n,{childrenField2:u},function(t,n){e._jt(c(n)),e.pjt(t.lp,c(n))})}},A.prototype.iOt=function(i,r,e,n){var o=this;return o.rOt({body:i},r).then(function(t){var n,t,t,n="batch"===r,t={type:r,batch:n,data:o.nOt(i,t)};return o.ki(S,t)?Promise.reject({cancel:!0,type:r,batch:n,step:S}):(i=t.data,o.eOt(i),t={type:r,success:!0,batch:n,items:(0,_.isArray)(i)?i:[i]},delete o.oOt,delete o.q7t,delete o.aOt,delete o.uOt,e&&e(t),o.ki(d,t),n?Promise.resolve(o.K7t()):j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?C+t.step:o.J7t(t),t={type:r,success:!1,reason:t};o.ki(O,{type:t}),n&&n(t)})},A.prototype.sOt=function(){var t,t,t=this;if(t.isHierarchy())return"Level"===(t=t.Fjt())||"ChildrenPath"===t},A.prototype.cOt=function(i,r,t,n){var e,o,e,u,s,c,f,a,h,o=this,e=o.Fjt();return r=r||o.q7t||[],"Level"===e?(u=o.f7t(),s=[],(0,_.traversalTree)(u,function(t){var t,n,t=t.lp;r[t]||(n=o.bjt(t),("create"===i||"batch"===i&&o.isInserted(t,!0))&&o.Y7t(n),n=o.jjt(n),s.push(n))}),o.iOt(s,i,t,n)):"ChildrenPath"===e?(u=o.f7t(),c=o.Gjt(),f=o.Yjt(c),h=[((e={})[f]=a=[],e)],(0,_.traversalTree)(u,{invoking:function(t){var t,n,t,t=t.lp;r[t]||(n=o.bjt(t),("create"===i||"batch"===i&&o.isInserted(t,!0))&&o.Y7t(n),delete n[c],n=o.jjt(n),0<h.length&&(t=h[h.length-1],(0,_.isArray)(t[f])||(t[f]=[]),t[f].push(n)),h.push(n))},invoked:function(t){r[t.lp]||h.pop()}}),o.iOt(a,i,t,n)):Promise.resolve(void 0)},A.prototype.fOt=function(){var t,n,i,r,e,o,u,t,s,c,f,a,r,n=this;if(n.isHierarchy()){for(i=n.njt,r=n.f7t(),e=i.reduce(function(t,n){return(t[n.JEt]=n).id=n.JEt,n.sequence=n.$Et,n.parent=m,t},((t={})[r.JEt]=r,t)),o=0;o<i.length;o++)n.isInserted(o,!0)||((u=i[o]).parent=e[u.XEt]);if(t=n.options.schema.hierarchy.levelOffset||0,r.level=t-1,"Level"===n.Fjt()){for(s=n.Gjt(),c=j,o=0;o<i.length&&!n.isInserted(o,!0);o++)a=void 0,((a=(f=n.lOt(o))?f[s]:n.Xjt(s,o))<c||c===j)&&(c=a);r.level=c+t-1}n.njt=[],r=!(0,_.isNullOrEmpty)(n.$jt()),n.Hjt(r)}},A.prototype.TBe=function(t){var n,i,t,n=this,i=t.column;return delete n.LEt.schema.columns[i.name],(0,_.isNamedFormulaColumn)(i)?-1:(delete n._data[i.name],-1<(t=n.DEt.findIndex(function(t){return t===i.name}))&&n.DEt.splice(t,1),t)},A.prototype.IBe=function(t,n){var i=this,r=t.originalColumn||t.column,t=t.originalColumnData;i.LEt.schema.columns[r.name]=(0,_.clone)(r,!0),(0,_.isNamedFormulaColumn)(r)||(i._data[r.name]={data:t.slice()},-1===i.DEt.findIndex(function(t){return t===r.name})&&((0,_.isNumber)(n)?i.DEt.splice(n,0,r.name):i.DEt.push(r.name)))},A.prototype.kBe=function(t){var n,i,n=this,i=n.TBe(t);n.IBe(t,i)},A.prototype.NBe=function(t){var n=this;switch(t.status){case 1:n.TBe(t);break;case 2:n.kBe(t);break;case 3:n.IBe(t)}},A.prototype.cancelChanges=function(){var i,t,n,r,e,o,u,s,c,i=this;if(i.hasColumnChanges())for(t=0,n=i.JFe;t<n.length;t++)r=n[t],i.NBe(r);(e=i.getHeldActions())&&0!==e.length&&(i.fOt(),i.t7t(),o=i.aOt,u=i.q7t||[],s=i.oOt||[],c=[],(0,_.forEach)(e,function(t){var n=t.sourceIndex,t=t.type;t===y.UPDATE?(i.pjt(n,o[n]),s[n]=[!!s[n]&&s[n][0],!1]):t===y.DELETE?(u[n]=j,s[n]&&s[n][0]?c.push(n):s[n]&&s[n][1]&&(i.pjt(n,o[n]),s[n]=[!1,!1]),(0,_.isNullOrUndefined)(i.wjt)||(i.wjt+=1)):t===y.INSERT&&c.push(n)}),(0,_.forEachRight)(c,function(t){i.mjt(t,1),s.splice(t,1),(0,_.isNullOrUndefined)(i.wjt)||--i.wjt}),i.clearBatchCache_())},A.prototype.getChanges=function(){var t=this.getColumnChanges(),n=this.hOt(!1);return t&&0<t.length?t.concat(n):n},A.prototype.isDataLengthChanged=function(){return this.getChanges().some(function(t){return"delete"===t.type||"insert"===t.type})},A.prototype.jBe=function(){for(var t,n,i,r,t=this,n=0;n<t.JFe.length;n++)(r=(i=t.JFe[n]).originalColumn||i.column)&&("formula"===r.dataType||r.iBe)&&(t.JFe[n]={key:i.key})},A.prototype.submitChanges=function(s,c){var f,n,a,h,l,d,v,p,w,b,t,f=this;return f.hasCachedActions()||f.hasColumnChanges(!0)?f.sOt()?(n=(f.q7t||[]).slice(),f.cOt("batch",j,function(){for(var t=f.vjt-1;0<=t;t--)!0===n[t]&&(f.mjt(t,1),f.njt[t].parent=m,f.njt.splice(t,1));f.njt.forEach(function(t,n){t.lp=n})})):(a=f.aOt,h=f.q7t||[],l=f.oOt||[],d=f.getHeldActions(),v=[],p=y.UPDATE,(0,_.isNullOrUndefined)(d)||d.forEach(function(t){t.dataItem=f.kue(f.jjt(t.dataItem)),t.oldDataItem=f.kue(f.jjt(t.oldDataItem))}),d=d||[],w=f.getColumnChanges(!0),t=(b=w&&0<w.length)?w.concat(d):d,f.rOt({body:t},"batch").then(function(t){var n,n,i,r,e,o,u,n=b&&t,n={type:p,batch:!0,data:n?t.slice(w.length):t,columns:n?t.slice(0,w.length):j};return f.ki(S,n)?Promise.reject({cancel:!0,type:p,batch:!0,step:S}):(((i=n.data)||[]).forEach(function(t){t.succeed&&t.data&&(f._jt(t.data),t.data=f.xue(t.data))}),i.length,d.length,r=[],(0,_.forEach)(d,function(t,n){var n=i[n];n.succeed?t.type===y.UPDATE?(a&&(a[t.sourceIndex]=j),l[t.sourceIndex][1]=j):t.type===y.INSERT?(n.data&&(f.pjt(t.sourceIndex,n.data),f.Z7t(t.sourceIndex,n.data)),l[t.sourceIndex]=[],a[t.sourceIndex]=j):t.type===y.DELETE&&v.push(t.sourceIndex):r.push({localAction:t,response:n})}),(0,_.forEachRight)(v,function(t){h.splice(t,1),f.mjt(t,1),a&&a.splice(t,1),l.splice(t,1),f.isHierarchy()&&(f.njt[t].parent=m,f.njt.splice(t,1))}),f.isHierarchy()&&f.njt.forEach(function(t,n){t.lp=n}),0<r.length?(e={type:p,errorData:r},f.ki(O,{type:e})||(f.uOt=[],(0,_.forEach)(r,function(t,n){var i=t.response,t=t.localAction,r=t.sourceIndex;t.type===y.DELETE&&(h[r]=j),f.dOt(r,{type:t.type,success:!1,reason:i.reason}),s(r,i.reason,t.type)}))):delete f.uOt,f.jBe(),o=[],u=n.columns,(0,_.forEach)(w,function(n,t){var t,i,t=u[t];t.succeed?-1<(i=f.JFe.findIndex(function(t){return t.key===n.column.Kyn}))&&(n.type===y.REMOVE_COLUMN?f.JFe.splice(i,1):f.JFe[i]={key:f.JFe[i].key}):o.push({change:n,response:t})}),0<o.length?(e={type:p,errorColumns:o},f.ki(O,{type:e})||(f._Be={},(0,_.forEach)(o,function(t){var n,i,t,r,n=t.response,i=t.change,t=i.name;i.type===y.REMOVE_COLUMN&&-1<(r=f.JFe.findIndex(function(t){return t.key===i.column.Kyn}))&&(f.IBe(f.JFe[r]),f.JFe[r]={key:f.JFe[r].key}),f.DBe(t,{type:i.type,success:!1,reason:n.reason}),c(t,n.reason,i.type)}))):delete f._Be,Promise.resolve(f.K7t()))}).catch(function(t){var t,n,t=t&&!0===t.cancel?C+t.step:f.J7t(t),n;f.ki(O,{type:{type:p,reason:t}})})):(f.jBe(),Promise.resolve(void 0))},A.prototype.getColumnChanges=function(n){var i,r,e,t,i=this;return i.hasColumnChanges(n)?(r=function(t){return n?g(g({},t.column),{Kyn:t.key,field:t.column.dataName||t.column.value}):g({},t.column)},e=function(t){return n?g(g({},t.originalColumn),{Kyn:t.key,field:t.originalColumn.dataName||t.originalColumn.value}):g({},t.originalColumn)},t=i.JFe,(t=n?i.JFe.filter(function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.iBe}):t).reduce(function(t,n){switch(n.status){case 1:t.push({type:y.ADD_COLUMN,column:r(n),data:i.hBe(n.column,n.originalColumnData)});break;case 2:t.push({type:y.UPDATE_COLUMN,column:r(n),originalColumn:e(n)});break;case 3:t.push({type:y.REMOVE_COLUMN,column:e(n)})}return t},[])):m},A.prototype.getHeldActions=function(){var t=this;return t.hasCachedActions()?t.hOt(!0):m},A.prototype.hOt=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,u,u,n=this,i=[],r=n.oOt||[],e=n.q7t||[],o=n.aOt,c=n.isHierarchy(),f=0;f<n.vjt;f++){if(u=r[f],!(s=null)===e[f])s={type:y.DELETE,dataItem:n.bjt(f)};else if(u&&u[0])s={type:y.INSERT,dataItem:n.bjt(f)},t&&c&&n.Y7t(s.dataItem);else if(u&&u[1]){if(a=o[f],h=n.bjt(f),!t)for(l in a=g({},a))a.hasOwnProperty(l)&&a[l]===h[l]&&(delete a[l],delete h[l]);s={type:y.UPDATE,dataItem:h,oldDataItem:a}}s&&(c&&s.type===y.INSERT&&b((u=n.c7t(f).parent).id)&&(u=u.isRoot?j:u.lp,t?s.sourceParentIndex=u:s.parentIndex=(0,_.isNumber)(u)?n.TEt(u):j),t?s.sourceIndex=f:s.index=this.TEt(f),i.push(s))}return i},A.prototype.clearBatchCache_=function(){var i,t,i=this,t=this;delete t.q7t,delete t.aOt,delete t.uOt,t.JFe=t.JFe.reduce(function(t,n){return 1!==n.status&&t.push({key:i.rBe()}),t},[])},A.prototype.hasColumnChanges=function(t){var n=this;return!!n.X7t()&&(t?n.JFe.some(function(t){var n=t.originalColumn||t.column;return t.status&&"formula"!==n.dataType&&!n.iBe}):n.JFe.some(function(t){return t.status}))},A.prototype.hasCachedActions=function(){var t,n,t,i,r,e,o,u,s,t=this;if(t.X7t()&&(n=t.oOt,t=t.q7t,n||t)){if(t)for(i=0,r=t;i<r.length;i++)if(e=r[i])return!0;if(n)for(o=0,u=n;o<u.length;o++)if((s=u[o])&&(!0===s[0]||!0===s[1]))return!0}return!1},A.prototype.bind=function(t,n){var i,r,e,o,u,s,c,i=this;if(n)for(o=r=(e=0,_.isArray)(t)?t:[t];e<o.length;e++)u=o[e],(s=(0,_.isFunction)(n)?n:n[u])&&(c=i._events[u]=i._events[u]||new f.Event).addHandler(s,i)},A.prototype.unbind=function(t,n){var i,t,i=this;(0,_.isNullOrUndefined)(t)?((0,_.forEach)(i._events,function(t){t.removeAllHandlers()}),i._events={}):(t=i._events[t])&&(n?t.removeHandler(n,i):t.removeAllHandlers())},A.prototype.ki=function(t,n){var i,r,i=this,r=i._events[t];return!!r&&((n=n||{}).cancel=!1,n.eventName=t,r.raise(i,n),n.cancel)},A.prototype.vOt=function(t){var n=this;return n._events.hasOwnProperty(t)&&n._events[t].hasHandlers},A.prototype.W7t=function(t){return t=g({},t)},A.prototype.mOt=function(t){return t},A.prototype.getDirtyIndexes=function(){var t,n=this.oOt||[];return(0,_.keys)(n).map(function(t){return parseInt(t,10)})},A.prototype.gOt=function(t,n){var i=this,r;return(i.oOt||[])[t=n?t:i.s7t(t)]||[]},A.prototype.isInserted=function(t,n){return this.gOt(t,n)[0]},A.prototype.isUpdated=function(t){return this.gOt(t)[1]},A.prototype.getErrorInfo=function(t){var n=this,i=n.uOt;if(!(0,_.isNullOrUndefined)(i))return i[t=n.s7t(t)]},A.prototype.dOt=function(t,n){var i=this,r;(i.uOt=i.uOt||[])[t]=n},A.prototype.DBe=function(t,n){var i=this,r;(i._Be=i._Be||{})[t]=n},A.prototype.pOt=function(){this.oOt=j,this.q7t=j,this.aOt=j,this.uOt=j},A.prototype.lOt=function(t){var n=this,i;return(n.aOt=n.aOt||[])[t]},A.prototype.insertItem=function(t,n,i,r){var e,t,e=this,t=e.s7t(t);e.I7t({action:y.INSERT,index:t,item:n,N7t:!0}),e.isHierarchy()&&"Custom"===e.Fjt()&&e.g7t(t),i&&i({type:y.CREATE,success:!0})},A.prototype.recoverItemAtBatch=function(t,n,i,r){var e=this;e.X7t()&&this.OBe(t)?(e.I7t({action:y.RECOVER_DELETE,index:t,item:n,N7t:!0}),i&&i({type:y.CREATE,success:!0})):this.insertItem(t,n,i,r)},A.prototype.OBe=function(t){var n;return!(null==(n=this.q7t)||!n[t])},A.prototype.updateItem=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n}),i&&i({type:y.UPDATE,success:!0})},A.prototype.updateItemValues=function(t,n,i,r){var e;this.I7t({action:y.UPDATE,index:t,item:n,x7t:!0}),i&&i({type:y.UPDATE,success:!0})},A.prototype.resetItem=function(t,n,i){var r,e,o,r=this,e,o=(r.aOt=r.aOt||[])[t=r.s7t(t)];r.isHierarchy()&&(o=r.bOt(t,o)),r.pjt(t,o),r.clearChangedStatus(t),r.dOt(t),n&&n({type:y.UPDATE,success:!0})},A.prototype.bOt=function(t,n){var i,r,t,e,o,i,u,i=this,r;return i.isHierarchy()?(t=i.bjt(t),e=i.Fjt(),o=i.Gjt(),i=i.$jt(),u=g({},n),"Parent"!==e&&"Level"!==e&&"Custom"!==e||(u[o]=t[o]),(0,_.isNullOrEmpty)(i)||(u[i]=t[i]),u):n},A.prototype.saveItem=function(t,n,i){var r,e,o,u,s,c,o,f,r=this;t=r.s7t(t),u=(o=(e=r.oOt||[])[t]||[])[0],s=o[1],0<o.length&&(u||s)&&(r.isHierarchy()&&(f=!(o=(c=r.njt)[t].parent).isRoot&&e[o.lp]&&e[o.lp][0])?i&&i({type:y.CREATE,success:!1}):r.yOt(t,r.bjt(t),u?y.INSERT:y.UPDATE,n,i))},A.prototype.yOt=function(n,i,t,r,e){var o=this,t=t===y.INSERT,u=t?y.CREATE:y.UPDATE,s=o.X7t(),c=o.wOt(u),f=o.MOt();s||!c||f?f&&(o.oOt[n]=[],o.aOt[n]=j,r)&&r({type:u,success:!0}):o.sOt()?o.cOt(t?y.CREATE:y.UPDATE,j,r,e):(t&&o.Y7t(i),i=o.jjt(i),i=o.kue(i),o.rOt({body:i},t?y.CREATE:y.UPDATE).then(function(t){var t,t,t={type:u,data:N(i,t)};return o.ki(S,t)?Promise.reject({cancel:!0,type:u,step:S}):(o._jt(t.data),t.data=o.xue(t.data),o.pjt(n,t.data),o.oOt[n]=[],o.aOt[n]=j,o.dOt(n),t={type:u,success:!0,items:[t.data]},u===y.CREATE&&o.Z7t(n),r&&r(t),o.ki(d,t),j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?C+t.step:o.J7t(t),t={type:u,success:!1,reason:t};o.dOt(n,t),o.ki(O,{type:t}),e(t)}))},A.prototype.I7t=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,l,i,n=this,i=n.X7t(),r=n.aOt=n.aOt||[];i&&(e=n.q7t=n.q7t||[]),o=t.action,u=t.index,s=t.item,c=t.x7t,u=(f=t.N7t)?u:n.s7t(u),a=this.TEt(u),n.oOt=n.oOt||[],h=n.oOt,o===y.INSERT?(0===n.vjt&&0===n.DEt.length&&n.COt(),n.vjt<u&&(n.vjt=u),(0,_.isNullOrUndefined)(l=u)&&(l=n.vjt),n.mjt(l,0,s),r.length>=u?r.splice(u,0,g({},s)):r[u]=g({},s),i&&(e.length>=u?e.splice(u,0,j):e[u]=j),h.length>=u?h.splice(u,0,[!0]):h[u]=[!0],(0,_.isNullOrUndefined)(n.wjt)||(n.wjt+=1),n.ki(y.ONCHANGE,{action:o,index:u,items:[t.item],modelIndex:a})):o===y.UPDATE?(l=n.bjt(u),r[u]||(r[u]=g({},l)),n.pjt(u,s,c),n.oOt[u]?n.oOt[u]=[n.oOt[u][0],!0]:n.oOt[u]=[!1,!0],E(g(g({},l),s),r[u])&&n.clearChangedStatus(u),n.ki(y.ONCHANGE,{action:o,index:u,items:[t.item],oldItems:[l],modelIndex:a})):o===y.RECOVER_DELETE&&e&&(i=!!e[u],delete e[u],i)&&this.setLength(this.length()+1)},A.prototype.clearChangedStatus=function(t){var n=this;!(n.oOt[t][1]=!1)!==n.oOt[t][0]&&(n.aOt[t]=j)},A.prototype.get=function(t){var n,i,r,e,o,u,n=this,i=n._data;if(t=n.s7t(t),i&&t<n.vjt){for(r={},e=0,o=n.DEt;e<o.length;e++)r[u=o[e]]=i[u].data[t];return r}return j},A.prototype.Xjt=function(t,n){var i=this,r=i._data;return r&&r[t]&&n<i.vjt?r[t].data[n]:j},A.prototype.SBe=function(t){var n,i=this._data;return i&&i[t]?i[t].data:[]},A.prototype.getFieldValue=function(t,n){var i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?r[t].data[n]:j},A.prototype.getFieldOriginalValue=function(t,n){var i,r,i,i=this,r=i._data;return n=i.s7t(n),r&&r[t]&&n<i.vjt?(i=i.lOt(n),(0,_.isNullOrUndefined)(i)?r[t].data[n]:i[t]):j},A.prototype.EBe=function(t){for(var n,i,r,e,o,n=this,i=n.length(),r=n.SBe(t),e=0;e<i;e++)if(o=r[e],!(0,_.isNullOrUndefined)(o))return o},A.prototype.RBe=function(t){var t,n,t=this.EBe(t),n=typeof t;return"object"==n&&t instanceof Date?"date":n},A.prototype.Fbe=function(t){var n,i,r,e,o,u,s,n=this,i=n.s7t(t),r=n.lOt(i),e=n._data,u={};for(s in e)e.hasOwnProperty(s)&&(u[s]=o=e[s].data[i],(0,_.isUndefined)(o))&&(u[s]=r[s]);return u},A.prototype.SOt=function(t,n,i){var o,r,e,u,s,c,f,a,s,o=this,r;o.X7t()||!o.wOt(y.DELETE)||o.MOt()||o.isInserted(t)||!o.sOt()?o.isHierarchy()&&(t=o.s7t(t),e=o.c7t(t),f=e.getChildrenIndexes(!0).concat(t),a=h([],f,!0),s=f.map(function(r,e){return function(t,n){for(var i=e;i<f.length;i++)f[i]>r&&f[i]--;o.TOt(f[e],1,t,n)}}),(0,_.promiseSerialExecute)(s).then(function(t){o.X7t()||(a.sort(function(t,n){return n-t}),a.forEach(function(t){o.tX(t,1,!1)}),o.njt.forEach(function(t,n){t.lp=n})),"Custom"===o.Fjt()&&o.g7t();var t=t[t.length-1];t.removedCount=a.length,n&&n(t)}).catch(function(t){i&&i(t)})):(t=o.s7t(t),e=o.c7t(t),s=(u=e.getChildrenIndexes(!0).concat(t)).reduce(function(t,n){return t[n]=!0,t},[]),o.bind(S,c=function(){u.forEach(function(t){o.tX(t,1,!1)}),o.njt.forEach(function(t,n){t.lp=n})}),o.cOt(y.DELETE,s,function(t){o.unbind(S,c),t.removedCount=u.length,n&&n(t)},function(t){o.unbind(S,c),i&&i(t)}))},A.prototype.remove=function(t,n,i,r){var e=this;e.isHierarchy()?e.SOt(t,i,r):e.TOt(t,n,i,r)},A.prototype.TOt=function(i,r,e,n){var o,u,s,t,c,o=this,u=o.X7t();i<0||i>=(u?o.vjt:o.length())||(s=y.DELETE,u||!o.wOt(y.DELETE)||o.MOt()||o.isInserted(i)?(!u&&o.isHierarchy()||o.tX(i,r),e&&e(t={type:s,success:!0})):(c=o.gjt(i,i+r),o.Ejt(c),c=c.map(function(t){return o.kue(t)}),o.rOt({body:c},y.DELETE).then(function(t){var n;return o.ki(S,{type:s,data:c})?Promise.reject({cancel:!0,type:s,step:S}):(c&&c[0]&&!u&&(i=o.Bbe(i,c[0])),o.isHierarchy()||o.tX(i,r),o.Ejt(c,{isServerToClient:!0}),c=c.map(function(t){return o.xue(t)}),o.dOt(i),n={type:s,success:!0,items:[c]},e&&e(n),o.ki(d,n),j)}).catch(function(t){var t,t,t=t&&!0===t.cancel?C+t.step:o.J7t(t),t={type:s,success:!1,reason:t};o.dOt(i,t),o.ki(O,{type:t}),n(t)})))},A.prototype.tX=function(i,r,e){var o,t,n,u,s,c,f,a,h,l,d,v,p,t,o=this,t=o.X7t(),u=o.oOt||[],s=o.aOt||[],c=i,f=i,a={};if(t){for(h=o.q7t=o.q7t||[],l=r,d=[],n=[],o.isHierarchy()?(f=this.TEt(c),v=o.njt,a.id=v[c].id,v[c].parent=m,o.y7t(i,r)):c=o.s7t(i),p=c;p<o.vjt&&(!0!==h[p]&&n.length<r&&(n.push(o.bjt(p)),d.push(p),h[p]=!0,--l),0!==l);p++);(0,_.forEachRight)(d,function(t){var n;u[t]&&u[t][0]&&(n=o.njt,h.splice(t,1),u.splice(t,1),s.splice(t,1),o.mjt(t,1),n.splice(i,r),!1!==e)&&n.forEach(function(t,n){t.lp=n})})}else v=o.njt,o.isHierarchy()&&(a.id=v[i].id),n=o.mjt(i,r),u.splice(i,r),s.splice(i,r),o.isHierarchy()&&(v[i].parent=m,o.y7t(i,r),v.splice(i,r),!1!==e)&&v.forEach(function(t,n){t.lp=n});t=n.length,(0,_.isNullOrUndefined)(o.wjt)||(o.wjt-=t,o.wjt=Math.max(o.wjt,0)),o.ki(y.ONCHANGE,{action:y.DELETE,items:n,index:null!=c?c:i,modelIndex:f,hierarchyNodeInfo:a})},A.prototype.COt=function(){var t,n,i,r,n=this,i=null==(t=n.options.schema)?void 0:t.columns;if(i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n._data[r]={data:[]},n.DEt.push(r))},A.prototype.MOt=function(){return(0,_.isNullOrUndefined)(this.options.remote)},A.prototype.X7t=function(){var t;return!!this.options.batch&&!this.MOt()},A.prototype.sBe=function(){return this.options.autoSync&&!this.MOt()},A.prototype.wOt=function(t){var n,i,n,n=this,i=n.options,n=n.hjt;return!!i.autoSync&&!(0,_.isNullOrUndefined)(n.LEt[t])},A.prototype.rOt=function(t,n){var i,r,i=this,r=n||y.UPDATE;return!(t=i.hjt.setupRequestOptions(t,n||y.UPDATE))||i.ki(l,{type:r,requestParams:t})?Promise.reject({cancel:!0,type:r,step:l}):i.hjt.postData(t)},A.prototype.Q7t=function(t,n){var i=this;return t=i.mOt(t),!(t=i.hjt.setupRequestOptions(t,n=n||"read"))||i.ki(l,{type:n,requestParams:t})?Promise.reject({cancel:!0,type:n,step:l}):i.hjt.getData(t)},A.prototype.J7t=function(t){return(0,_.isString)(t)?t:t instanceof Error?t.message:"some error happened"},A.prototype.mTe=function(){var t=this.q7t;return!((0,_.isNullOrUndefined)(t)||0===t.length)},A.prototype.s7t=function(t){var n,i,r,e,o,n=this.q7t;if((0,_.isNullOrUndefined)(n)||0===n.length)return t;for(e=r=i=0,o=n.length;e<=o;e++)if(n[e])r+=1;else{if(i===t)break;i+=1}return t+r},A.prototype.TEt=function(t){var n,i,r,n=this.q7t;if(!(0,_.isNullOrUndefined)(n)&&0!==n.length)for(i=0,r=Math.min(n.length,t);i<=r;i++)n[i]&&--t;return t},A.prototype.Bbe=function(t,n){var i,r,e,o,u,i=this.gjt(t,t+1);if(!i||!E(i[0],n))for(r=this.length(),o=t+1,u=t-1;0<=u||o<r;){if(o<r){if(e=o,(i=this.gjt(e,e+1))&&E(i[0],n))return e;o++,o=Math.min(r,o)}if(0<=u){if(e=u,(i=this.gjt(e,e+1))&&E(i[0],n))return e;u--,u=Math.max(-1,u)}}return t},y.DataSource=A},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(t,n){"use strict";var i,r;function e(t){t&&(this._data=t.data,this.LEt=i({},t))}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.LocalDataTransport=void 0,e.prototype.getData=function(t){var n;return Promise.resolve(this._data)},e.prototype.getDataSync=function(){return this._data},e.prototype.postData=function(t){var n;return Promise.resolve(this._data)},e.prototype.setupRequestOptions=function(t,n){return{}},n.LocalDataTransport=e},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(t,n,i){"use strict";var c,u,s,r,f,a,h,l,d,v,p,e;function o(t){var n;this.LEt=c({},t)}c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.RemoteDataTransport=void 0,i("./node_modules/whatwg-fetch/fetch.js"),u=i("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),s=i("./dist/src/dataSource/utils.js"),r=null,f=void 0,a="jsonp",h="read",l="create",d="update",v="delete",p="Content-Type",o.prototype.getData=function(t){var n,i,r,e,o,n=this,i,r=this.LEt[t.requestType],e=t.dataType,o=e===a?u:fetch;return t.requestData=f,(t.requestType=f,s.isFunction)(r)?r(t):o(t.url,t).then(function(t){if(t.ok)return n.AOt(e)?t.json():t.text();throw t})},o.prototype.postData=function(t){var n,i,r,e,o,n=this,i,r=this.LEt[t.requestType],e=t.dataType,o=t.requestData;return t.requestData=f,(t.requestType=f,s.isFunction)(r)?r(o,t):fetch(t.url,t).then(function(t){if(t.ok)return n.AOt(e)?t.json():t.text();throw t})},o.prototype.AOt=function(t){return void 0===t||"json"===t||t===a},o.prototype.setupRequestOptions=function(t,n){var i,r,e,o,u,s,i,e;if(t=t||{},r=(i=this).LEt[n])return e=r.body,(o=t.body)?(t.headers=t.headers||{},i.LEt.dataConverter?(t.body=o=i.LEt.dataConverter(o,n||h),t.headers[p]="application/plain;"):(t.body="string"==typeof o?o:JSON.stringify(o),t.headers[p]="application/json; charset=utf-8")):e&&(t.body="string"==typeof e?e:JSON.stringify(e),t.headers={},t.headers[p]="application/json; charset=utf-8"),i=r.method,n===h?(r.dataType===a&&(u={mode:"no-cors"}),s={method:i||"GET"}):n===l||n===d||"batch"===n?s={method:i||"POST"}:n===v&&(s={method:i||"DELETE"}),(e=r.options)&&e.mode&&(u={mode:e.mode}),c(c(c(c(c({},r),s),u),t),{requestType:n,requestData:o})},n.RemoteDataTransport=o},"./dist/src/dataSource/event.js":function(t,n){"use strict";var e,c,i;function r(t,n,i){var r=this;r.handler=t,r.owner=n,r.priority=i}function o(){this.IOt=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.Event=n.EventHandler=void 0,e=r,n.EventHandler=e,c=null,Object.defineProperty(o.prototype,"hasHandlers",{get:function(){return 0<this.IOt.length},enumerable:!1,configurable:!0}),o.prototype.addHandler=function(t,n,i){var r=this,t=new e(t,n,i=void 0===i?1:i);r.IOt.push(t),r.sortHandlers()},o.prototype.removeHandler=function(t,n){for(var i,r,e,o,u,i=this,r=i.IOt,e=r.length,o=0;o<e;o++)if((u=r[o]).handler===t&&u.owner===n){i.IOt.splice(o,1);break}},o.prototype.sortHandlers=function(){this.IOt.sort(function(t,n){var t=t.priority,n=n.priority;return t<n?1:n<t?-1:0})},o.prototype.removeHandlersByPriority=function(t){for(var n,i,r,e,o,u,s,n=this,i=n.IOt,r=i.length,e=c,o=c,u=0;u<r;u++)if((s=i[u]).priority===t)e===c&&(e=u),o=u;else if(e!==c)break;e!==c&&o!==c&&n.IOt.splice(e,o-e+1)},o.prototype.removeAllHandlers=function(){this.IOt.length=0},o.prototype.raise=function(t,n){var i,r,r,e,o,u,s,i=!1,r=function(){i=!0};for(n===c?n={stopPropagation:r}:n.stopPropagation=r,e=(r=this).IOt.length,o=r.IOt.slice(0,e),u=0;u<e&&!i;u++)(s=o[u]).handler.call(s.owner,t,n)},n.Event=o},"./dist/src/dataSource/utils.js":function(P,a,t){"use strict";var e,u,s,c,f,h;function n(t){return t&&!(0,a.isArray)(t)&&"object"==typeof t}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"boolean"==typeof t}function l(t,n){var i,r,e,o,u;if((0,a.isArray)(t))for(i=0;i<t.length;i++)n(t[i],i,t);else if(!F(t))for(e=0,o=r=Object.keys(t);e<o.length;e++)n(t[u=o[e]],u,t)}function d(t,n){var i,r,e,o,u;if((0,a.isArray)(t))for(i=t.length-1;0<=i;i--)n(t[i],i,t);else for((r=Object.keys(t)).reverse(),e=0,o=r;e<o.length;e++)n(t[u=o[e]],u,t)}function v(t){return Object.keys(t)}function p(t,n,i){if((0,a.isArray)(t))return t.reduce(n,i);throw new Error("NOT SUPPORT")}function w(t,n,i){return t.indexOf(n,i=void 0===i?0:i)}function b(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function m(t,n){var i,r,e,o,u,s,c;if(void 0===n&&(n=!1),!F(t)&&"object"==typeof t){if(t&&(0,a.isArray)(t))return t.map(function(t){return m(t,n)});if(t&&"object"==typeof t){for(i={},e=0,o=r=v(t);e<o.length;e++)s=t[u=o[e]],n?(c=E(s),i[u]="object"===c||"array"===c?m(s,n):s):i[u]=s;return i}}return t}function j(t,n,i,r){var e,o,u,s,c,f;if(void 0===i&&(i=!1),void 0===r&&(r=!1),!F(t)&&!F(n)){if(t instanceof Blob||n instanceof Blob)return t===n;if(t instanceof Date&&n instanceof Date)return t.valueOf()===n.valueOf();if(i)if((0,a.isArray)(t)&&(0,a.isArray)(n)){if(t.length===n.length){for(e=0;e<t.length;e++)if(!j(t[e],n[e],i,r))return!1;return!0}}else if("object"==typeof t&&"object"==typeof n&&(o=Object.keys(t).filter(function(t){return!r||"_"!==t[0]}),u=Object.keys(n).filter(function(t){return!r||"_"!==t[0]}),o.length===u.length)){for(s=0,c=o;s<c.length;s++)if(f=c[s],!n.hasOwnProperty(f)||!j(t[f],n[f],r))return!1;return!0}}return t===n}function y(t,n){return!j(t,n,!0)}function g(t,n){var i,r,e;for(void 0===t&&(t=[]),void 0===n&&(n=[]),i={},r=Math.min(t.length,n.length),e=0;e<r;e++)i[t[e]]=n[e];return i}function _(t){return"string"==typeof t}function O(t,n){var i,r,e,o;if(_(n))return t[n];for(i={},r=0,e=n;r<e.length;r++)i[o=e[r]]=t[o];return i}function S(t,n){if((0,a.isArray)(t))return t.map(n);throw new Error("NOT SUPPORT")}function C(t){return void 0===t}function R(t){return null===t}function F(t){return C(t)||R(t)}function I(t){return""===t||F(t)}function N(t){return t&&"="===t[0]}function M(t){return!_(t)&&_(t.name)&&!N(t.name)&&"formula"===t.dataType}function k(t){return t&&-1<t.indexOf(".")&&!N(t)}function E(t){var n;return Object.prototype.toString.call(t).match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}function L(t,n,i,r){n<0||n>t.length||i<0||i>t.length||n===i||r<=0||t.splice.apply(t,e([i-(n<i?r-1:0),0],t.splice(n,r),!1))}function x(t,n){var t=t.parent;t&&(n(t),x(t,n))}function T(t,n,i,r){var e,o,u,s,c,f,a,h,l,d,v,e=t[r||"children"]||[];for(I(i)?o=e.slice():(f=c=void 0,"string"==typeof i?u=i:"function"==typeof i?s=i:"object"==typeof i&&(u=i.field,s=i.getValue,c=i.compareFn,f=i.isOrderChildren),o=f?e:e.slice(),u?o.sort(function(t,n){return t[u]-n[u]}):s?o.sort(function(t,n){return s(t)-s(n)}):c&&o.sort(c)),"object"==typeof(a=n)&&(a=n.invoking,h=n.invoked),d=0;d<o.length;d++){if(v=o[d],a&&(l=a(v,t))&&l.cancel)return l;if((l=l&&l.cancelDeepRecursion?l:T(v,n,i,r))&&l.cancel)return l;if(h&&(l=h(v,t))&&l.cancel)return l}}function V(t){return t}function G(i){return void 0===i&&(i=0),new Promise(function(t,n){setTimeout(function(){t("timeout")},i)})}function D(t){var n=t.callback,i=t.timeout,i=void 0===i?5e3:i,t=t.retryCount,r=void 0===t?1:t;return Promise.race([n(),G(i)]).then(function(t){if("timeout"!==t)return Promise.resolve(t);if(0<r)return D({callback:n,retryCount:--r});throw"timeout"})}function q(t,n){return A(t.map(function(t){return function(){return new Promise(t)}}),n)}function A(t,i){var r=[];return t.reduce(function(t,n){return t.then(function(t){return r.push(Promise.resolve(t)),i?D({callback:n,timeout:i.timeout,retryCount:i.retryCount}):n()})},Promise.resolve({})).then(function(t){return r.shift(),r.push(Promise.resolve(t)),Promise.all(r)})}function B(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))}function U(t){return!F(t._error||t._code)}function H(t){var n;return F(t)||F(n=t._error||t._code)?t:n}function W(n,t){var i,i,r,e,o;if(F(n)||""===n)return"";if(i=B(t),!t||"General"===t||i)return"boolean"==typeof n||n instanceof Boolean?(n=s?n?s.getBoolean().boolean_true:s.getBoolean().boolean_false:n).toString().toUpperCase():n instanceof Date?(r=(i=c.Fe(c.culture()).DateTimeFormat).shortDatePattern,0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()||(r=i.defaultDatePattern),h.Pe(n,r)):(n="number"==typeof n?f.Ge(n.toString()):n).toString();try{return(e=u.Formatter&&u.Formatter.GeneralFormatter)?(o=null,(o="string"==typeof t?new e(t):t).format(n,{})):n.toString()}catch(t){return n.toString()}}function K(t,n){var i,r;if(!F(t)&&!F(n))for(i=n.split(".");0<i.length;)t=t[r=i.shift()];return t}function J(t){var n,i,r,e,o;if(t&&0<t.length){for(n={},i=[],r=0,e=t;r<e.length;r++)n[o=e[r]]||(n[o]=!0,i.push(o));return i}return t}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(a,"__esModule",{value:!0}),a.getUniqueArray=a.q$=a.format=a.formatCalcError=a.isCalcError=a.promiseAllSerial=a.promiseSerialExecute=a.traversalTree=a.bubbleTree=a.swapArrayItems=a.getActualType=a.isRelation=a.isNamedFormulaColumn=a.isFormula=a.isNullOrEmpty=a.isNullOrUndefined=a.isNull=a.isUndefined=a.map=a.pick=a.isString=a.zipObject=a.isNotDeepEqual=a.isEqual=a.clone=a.findIndex=a.indexOf=a.reduce=a.keys=a.forEachRight=a.forEach=a.isBoolean=a.isNumber=a.isFunction=a.isObject=a.isArray=void 0,u=t("Common"),s=t("CalcEngine"),c=u.Common.CultureManager,f=u.Common.st,h=u.Common.ct,a.isArray=u.Common.lt.Nh,a.isObject=n,a.isFunction=i,a.isNumber=r,a.isBoolean=o,a.forEach=l,a.forEachRight=d,a.keys=v,a.reduce=p,a.indexOf=w,a.findIndex=b,a.clone=m,a.isEqual=j,a.isNotDeepEqual=y,a.zipObject=g,a.isString=_,a.pick=O,a.map=S,a.isUndefined=C,a.isNull=R,a.isNullOrUndefined=F,a.isNullOrEmpty=I,a.isFormula=N,a.isNamedFormulaColumn=M,a.isRelation=k,a.getActualType=E,a.swapArrayItems=L,a.bubbleTree=x,a.traversalTree=T,a.promiseSerialExecute=q,a.promiseAllSerial=A,a.isCalcError=U,a.formatCalcError=H,a.format=W,a.q$=K,a.getUniqueArray=J},"./dist/src/interfaces/conditionalFormatOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.c=void 0,n.c=0},"./dist/src/interfaces/interface.js":function(t,n){"use strict";var i,r,e,o,u,u,u,u;Object.defineProperty(n,"__esModule",{value:!0}),n.RelationshipMap=n.RowColumnStates=n.StateRuleDirection=n.ViewArea=n.DEFAULT_VIEW_NAME=void 0,n.DEFAULT_VIEW_NAME="defaultView",(u=i=n.ViewArea||(n.ViewArea={}))[u.colHeader=1]="colHeader",u[u.viewport=3]="viewport",(u=r=n.StateRuleDirection||(n.StateRuleDirection={}))[u.none=0]="none",u[u.row=1]="row",u[u.column=2]="column",u[u.both=3]="both",(u=e=n.RowColumnStates||(n.RowColumnStates={}))[u.hover=1]="hover",u[u.readonly=4]="readonly",u[u.active=16]="active",u[u.selected=32]="selected",u[u.dirty=64]="dirty",u[u.inserted=128]="inserted",u[u.updated=256]="updated",u[u.pin=1024]="pin",u[u.primaryKey=2048]="primaryKey",u[u.required=4096]="required",(u=o=n.RelationshipMap||(n.RelationshipMap={}))[u.OneToOne=0]="OneToOne",u[u.OneToMany=1]="OneToMany"},"./dist/src/interfaces/styleOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.s=void 0,n.s=0},"./dist/src/interfaces/validatorOptions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.v=void 0,n.v=0},"./dist/src/query.js":function(e,t,n){"use strict";var r,t,ot,P,ut,s,h,i,o,st,c;function f(t){return"string"==typeof t}function k(t,o){var u,n,i,r,e,u=[],n=function(t){var n,i,r,e,i;for(n in t)t.hasOwnProperty(n)&&(e=r=void 0,f(i=t[n])?r=i:(r=i.order,e=i.list),i={field:n,ascending:"DESC"!==r,list:e,_f:n},null!=o&&o(i),u.push(i))};if((0,ot.isArray)(t))for(i=0,r=t;i<r.length;i++)n(e=r[i]);else n(t);return u}function ct(t){return t&&0<t.length&&t.some(function(t){return 0<t.length})}function L(t,n,i){var r,r;return(0,ot.isNullOrEmpty)(t)||-1===t.indexOf(n)?t:(r=(r=(r=t).replace(new RegExp("\\[@\\["+n+"\\]\\]","g"),"[@[".concat(i,"]]"))).replace(new RegExp("\\[@"+n+"\\]","g"),"[@".concat(i,"]"))).replace(new RegExp("\\["+n+"\\]","g"),"[".concat(i,"]"))}function V(t,n,i){var r,e,o,u,s,r,c,f,a,h;if(n&&0<(r=(0,ot.keys)(n)).length)for(e=0,o=r;e<o.length;e++)s=n[u=o[e]],(0,ot.isFormula)(s)&&(t=t.replace(new RegExp("\\[@"+u+"\\]","g"),s.substring(1)));if(i&&0<(r=(0,ot.keys)(i)).length)for(c=0,f=r;c<f.length;c++)h=i[a=f[c]],(0,ot.isFormula)(h)&&(t=t.replace(new RegExp("\\[@"+a+"\\]","g"),h.substring(1)));return t}function G(t,n,i){var r,e,o,u,s,r,c,f,a,h;if(n&&0<(r=(0,ot.keys)(n)).length)for(e=0,o=r;e<o.length;e++)s=n[u=o[e]],(0,ot.isFormula)(s)&&t===u&&(t=s);if(i&&0<(r=(0,ot.keys)(i)).length)for(c=0,f=r;c<f.length;c++)h=i[a=f[c]],(0,ot.isFormula)(h)&&t===a&&(t=h);return t}function q(t,n){return t&&t[n]||n}function ft(t){for(var n,i,n=[],i=0;i<t.length;i++)n[t[i]]=i;return n}function at(t,n){for(var i,r,e,o,u,s,c,f,a,h,l,d,i=[t],r=0;r<n;){for(e=0,o=i.length;e<o;e++)if((u=i.shift()).childrenArray&&u.childrenArray[0])for(c=u.childrenArray[s=0];s<c.length;s++)f=c[s],i.push(f);r++}for(a=[],h=0,l=i;h<l.length;h++)a.push((d=l[h]).recordRowNumbers[0]);return{indexMap:a,queue:i}}function m(t,n){return(0,ot.isNullOrUndefined)(t)&&(0,ot.isNullOrUndefined)(n)?0:(0,ot.isNullOrUndefined)(t)?-1:(0,ot.isNullOrUndefined)(n)?1:"number"==typeof t||t instanceof Date?t-n:n<t?1:t<n?-1:0}function j(t,n,i){var r=i[t],i=i[n];return r!==st&&i!==st?r-i:r!==st?-1:i!==st?1:m(t,n)}function u(t,n,i,r){var a,h,l,d,e,o,v,u,s,c,f,p,w,b,a=[],h=[],l=ct(i),d=r&&0<r.length,e=function(t){var n,i,r;return(0,ot.isNullOrUndefined)(t)?function(){return 0}:(n=t.ascending,i=t._f||t.field,(0,ot.isArray)(t.list)&&0<t.list.length?(r=t.list.reduce(function(t,n,i){return t[n]=i,t},{}),n?function(t,n){return j(t[i],n[i],r)}:function(t,n){return j(n[i],t[i],r)}):n?function(t,n){return m(t[i],n[i])}:function(t,n){return m(n[i],t[i])})};for(l?a=i.map(function(t){return t.map(e)}):d&&(h=r.filter(function(t){return!(0,ot.isNullOrUndefined)(t)}).map(e),d=0<h.length),o=[t],v=0;v<n.length;){for(u=0,s=o.length;u<s;u++)if((c=o.shift()).sort(function(t,n){var i,r,e,o,u,s,c,f,i=0;if(l)for(e=0,o=r=a[v];e<o.length&&0===(i=(u=o[e])(t,n));e++);else if(d)for(s=0,c=h;s<c.length;s++)if(0===(i=(f=c[s])(t,n)))return i;return i}),v<n.length-1)for(f=n[v+1].field,p=0,w=c;p<w.length;p++)b=w[p],o.push(b[f]);v++}}function _(t,n,i,r){for(var e,o,u,s,c,f,e,o={},u=0,s=(0,ot.keys)(t);u<s.length;u++)c=s[u],-1!==i.indexOf(c)?(f=r(c))!==c&&(t[f]=t[c],delete t[c]):-1===n.indexOf(c)&&(o[c]=t[c],delete t[c]);return o}function S(t,n,i,r){for(var e,o,e=r;0<=e;e--)if(t[o=i[e].caption||i[e].field]!==n[o])return;return 1}function l(y,g){var t,n,i,r,e,o,u,s,c,f;if(2<=g.length){for(t=function(i){for(var t,n,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,t=i===g.length-1?"$rows":g[i+1].field,n=[],r=g[i-1].caption||g[i-1].field,e=g[i].caption||g[i].field,o=g[i].summaryFields,u=o.map(function(t){return t.caption}),s=o.reduce(function(t,n){return n.FBe&&t.push({caption:n.caption,summaryField:n.BBe}),t},[]),c=o.map(function(t){var n=(0,ut.tse)(i);return t.caption+"_"+t.slice+n}),f=function(t){var n=(0,ut.tse)(i);return n?t.substring(0,t.lastIndexOf(n)):t},a=0,h=y;a<h.length;a++)if(d=(l=h[a])[r],0!==n.length&&S(n[n.length-1],l,g,i-1)){for(_(l,u.concat(e,t),c,f),m=0,j=s;m<j.length;m++)l[(b=j[m]).summaryField]=l[b.caption],delete l[b.caption];n[n.length-1][e].push(l)}else{for(v=_(l,u.concat(e,t),c,f),p=0,w=s;p<w.length;p++)l[(b=w[p]).summaryField]=l[b.caption],delete l[b.caption];v[r]=d,v[e]=[l],n.push(v)}y=n},n=g.length-1;0<n;n--)t(n);for(r=(i=g[0].summaryFields).reduce(function(t,n){return n.FBe&&t.push({caption:n.caption,summaryField:n.BBe}),t},[]),e=0,o=y;e<o.length;e++)for(u=o[e],s=0,c=r;s<c.length;s++)u[(f=c[s]).summaryField]=u[f.caption],delete u[f.caption]}return y}function ht(t,n,i,r,e){var r,o;n=l(n,i),(ct(r)||e&&0<e.length)&&u(n,i,r,e),n&&0<n.length&&(t[o=(r=i[0]).caption||r.field]=n)}function yt(O,t,n,S){var i,i,r,e,o,u,i,s,c,f,a,h,C,l,d,v,p,w,R,b,m,j,y,g,s,F,I,_,N,M,E,x,n,i,s,T,D,A,r={},e=[],i=O.select;if(i&&(s=i.fields,o=i.limit,u=i.skip,s))for(c=0,f=s;c<f.length;c++)a=f[c],(0<=t.indexOf(a)||0<=a.indexOf("."))&&e.push({value:a}),r[a]=!0;if(h=[],C=O.calculate)for(v=l=(d=0,ot.keys)(C);d<v.length;d++)p=v[d],w=C[p],w=S.Pbe(w)?(0,P.parseWindowOverByOption)(w):w,h.push({caption:p,value:w}),r[p]&&(delete r[p],r[w]=!0);if(R=null==(i=n.schema)?void 0:i.dimensions)for(j=b=(m=0,ot.keys)(R);m<j.length;m++)y=j[m],g=R[y],h.push({caption:y,value:g}),r[y]&&(delete r[y],r[g]=!0);if(s=O.groupBy,F=[],s)for(I=null==(i=n.schema)?void 0:i.measures,_=function(u){for(var d,v,p,w,b,m,j,t,n,i,r,e,o,s,c,f,a,h,l,y,g,_,d=[],v=[],p=[],w=void 0,b=void 0,m=[],j={},t,n=function(t){for(var l,n,i,r,e,o,l=u[t],n=[t],i=function(t){var f,t,n,i,r,e,o,u,s,s,s,s,s,c,a,h,s,f=t,t={field:t=G(t,C,R),summaryFields:[],caption:l.caption||f};if(l.summarize&&(t.summaryFields=l.summarize.map(function(t){for(var n,i,r,e,o,u,s,c,n,u=0,s=(0,ot.keys)(t);u<s.length;u++)"having"===(c=s[u])?o=V(t[c],C):"pivot"===c?r=t[c]:(i=V(q(I,t[c]),C,R),j[e=c]=!0);return{formula:i,filter:o,slice:r,caption:e,BBe:e,LBe:l.caption||f}})),n=l.calculate)for(e=i=(r=0,ot.keys)(n);r<e.length;r++)u=n[o=e[r]],u=V(u=S.Pbe(u)?(0,P.parseWindowOverByOption)(u):u,C),m.push({caption:o,value:u});if((s=l.where)?(s=V(s,C),v.push(s)):v.push(st),(s=l.orderBy)?(s=k(s,function(t){for(var n,i,r,e,n=t.field,i=0,r=m;i<r.length;i++)if(n===(e=r[i]).caption&&S.Pbe(e.value)){n=(0,P.parseWindowOverByOption)(e.value);break}t.field=n}),p.push(s)):p.push([]),w=l.includeDetailRows,b=!!O.nest,s=l.attributes)for(c=0,a=s;c<a.length;c++)h=a[c],j[h]=!0;d.push(t),s=l.caption||f,j[s]=!0},r=0,e=n="="!==t[0]&&0<=t.indexOf(",")?t.split(","):n;r<e.length;r++)i(o=e[r])},i=0,r=(0,ot.keys)(u);i<r.length;i++)n(e=r[i]);for(o=0;o<d.length;o++)for(c=0,f=(s=d[o]).summaryFields;c<f.length;c++){for(a=f[c],h=o+1;h<d.length;h++){for(y=0,g=(l=d[h]).summaryFields;y<g.length;y++)if(_=g[y],a.caption===_.caption){a.FBe=!0;break}if(a.FBe)break}a.FBe&&(a.caption="".concat(a.BBe,"__").concat(a.LBe),j[a.caption]=!0,v[o]=L(v[o],a.BBe,a.caption))}v=v.filter(function(t){return!(0,ot.isNullOrEmpty)(t)}),F.push({groupByInfos:d,groupFilterInfos:v,groupSortInfos:p,includeDetailRows:w,includeDetailRowsForNest:b,groupCalculateInfos:m,groupSelectFields:j})},N=0,M=s;N<M.length;N++)_(E=M[N]);if((n=O.where)&&(x=V(n,C,R)),i=[],(s=O.orderBy)&&(i=k(s,function(t){for(var n,i,r,e,n=t.field,i=0,r=h;i<r.length;i++)if(n===(e=r[i]).caption&&S.Pbe(e.value)){n=(0,P.parseWindowOverByOption)(e.value);break}t.field=n})),T={},D=O.window)for(A in D)D.hasOwnProperty(A)&&(T[A]=(0,P.parseWindowOverByOption)(D[A],!0));return{selectFields:r,relatedColumns:e,calculateColumns:h,windows:T,limit:o,skip:u,filterExpression:x,groupInfos:F,sortInfos:i}}function lt(t,n,i,r,e,o,u,s,c,f){var a,h,l,d,v;if(void 0===s&&(s=0),a=[],h=f.length,0<=(u=void 0===u?0:u))for(l=s,d=0===u?h:Math.min(s+u,h);l<d;l++)a.push((0,ut.nse)(t,n,i,r,e,f[l],o,!0,!0,c));else for(l=h-1-s,v=Math.max(0,h+u-s);v<=l;l--)a.push((0,ut.nse)(t,n,i,r,e,f[l],o,!0,!0,c));return a}function dt(t){for(var n,i,n=[],i=0;i<t;i++)n[i]=i;return n}function gt(t){var n,i,r,e,e;if(0===t.length)return"";if(1===t.length)return t[0];for(n=[],i=0,r=t;i<r.length;i++)e="="===(e=r[i])[0]?e.slice(1):e,n.push(e);return"=AND("+n.join(",")+")"}function vt(t,n,i){return(0,ot.isNullOrEmpty)(n)?i.slice():"string"==typeof n?a(t,t.Ywt(n,0,0),i):[]}function a(t,n,i,r){for(var e,o,u,s,e=[],o=0,u=r||0;u<i.length;u++)s=i[u],!0===t.nMt(n,s,0)&&(e[o]=s,o++);return e}function pt(i,t,n,r,e,o,u){var s,c,f,a,s=(0,h.ese)(i,t,n,e,r);if(u=u||e.length,0===(o=o||0)&&u>=e.length)e.sort(function(t,n){return s(i,r,t,n)});else for((c=e.slice(o,u)).sort(function(t,n){return s(i,r,t,n)}),f=0,a=c.length;f<a;f++)e[f+o]=c[f]}function d(t,n){var t=new i.FieldManager(st,t);return n=t.prepareFields(n),{fieldMgr:t,columnInfos:n}}function v(r,t,e){var n=r.POt;return new o.GroupManager(t,n.wEt.bind(n),r.QOt,function(t,n,i){pt(r,e,st,n,t,i)},function(t,n,i){return a(r,t,n,i)})}function wt(t,n,i,r){var r,e,r,t,o,i,u,i,r=d(t,r),e=r.fieldMgr,r=r.columnInfos,t=v(t,n,r),o=e.buildGroupFields(n,i),i=t.groupBy(o,i),u=i.rootNode,i=i.indexMap;return e.transposeSliceFields(o),{rootNode:u,newIndexMap:i,fieldMgr:e,groupMgr:t,columnInfos:r=(0,s.ise)(r,e,n)}}function p(t){for(var n,i,r,e,n={},i=0,r=t;i<r.length;i++)n[(e=r[i]).name]=!0;return n}function O(t,n){for(var i,r,e,o,u,i=[],r,e=0,o=(0,ot.keys)(t);e<o.length;e++)"="!==(u=o[e])[0]&&0<=u.indexOf(",")?i.push.apply(i,u.split(",")):i.push(n&&t[u].caption||u);return i}function w(t,n){var i,r,e,o,i=[];if(Array.isArray(t))for(r=0,e=t;r<e.length;r++)o=e[r],i.push.apply(i,o[n]);else i.push.apply(i,t[n]);return i}function C(t,n){var i,r,e;if(!(n.length<=0)){for(i=[],r=t,e=0;e<n.length;e++)r=w(r,n[e]);return i=r}}function b(t,n,i){for(var r,e,o,u,s,c,f,a,r=n(),e=[],o=0;o<t.length;o++)if(0<(s=i(u=t[o])).length)for(c=0;c<s.length;c++)!1!==(a=r[f=s[c]]).nde&&e.push(a.options);return[e,[]]}function y(t){var n,i,n,i;return g(t[0]).windowOverInfos}function g(t){for(var n,i,r,e,o,u,s,s,c,f,f,a,h,l,n={},i=[],o=0;o<t.length;o++)r=(u=t[o]).partitionKey,e=u.orderKey,(0,ot.isNullOrUndefined)(n[u.partitionKey])&&(s={partitions:u.partitions,orderedFunctions:[]},n[u.partitionKey]={index:i.length,orderMap:{},windowOverInfo:s},i.push(s)),c=(s=n[u.partitionKey]).orderMap,(0,ot.isNullOrUndefined)(c[u.orderKey])&&(f={orders:u.orders,functions:[]},c[u.orderKey]={index:s.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:f},s.windowOverInfo.orderedFunctions.push(f)),f=u.frameKey+"__"+u.windowFormula,(0,ot.isNullOrUndefined)(c[u.orderKey].functionMap[f])&&(c[u.orderKey].functionMap[f]=!0,c[u.orderKey].orderFunctions.functions.push({orders:c[u.orderKey].orderFunctions.orders,windowOverFormula:u.windowOverFormula,windowFormula:u.windowFormula,windowFrame:u.windowFrame}));return a=function(t){var n,t,t,i,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[e];1<n.length&&(i=n[t=t.index],n.splice(t,1),n.push(i))},1<i.length?(l=i[o=(h=n[r]).index],i.splice(o,1),i.push(l),a(h)):1===i.length&&a(n[r]),{windowOverInfoMap:n,windowOverInfos:i}}function R(t,n){for(var i,r,i=0;i<n.length;i++)r=n[i],t.Xhe(r)}function F(t,n,i,r,e,o){for(var u,s,c,f,a,h,u,s=0,c=y(b(t,e,o));s<c.length;s++)I(a=(f=c[s]).partitions,h=f.orderedFunctions,n,i,r)}function bt(t,i,n,r){return R(i,t),F(t,function(t){r=wt(i,t,r,n).newIndexMap},function(t){pt(i,n,st,t,r)},function(t,n){return n(i.XOt[t],r)},function(){return i.XOt},function(t){return i.Gbe(t)}),r}function I(t,n,i,r,e){var o,u,s,c,f;if((0,ot.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,i(t);else for(o=0;o<n.length;o++)for(s=(u=n[o]).orders,(0,ot.isArray)(s)&&0<s.length&&r(s),c=u.functions,f=0;f<c.length;f++)e(c[f].windowOverFormula,function(t,n){return t.evaluateWindowFunction(n)})}function N(t){for(var i,n,r,e,o,u,i=(0,ut.ose)(t),n,r=function(n){n.sourceTable.name===t.name?(0,ut.ose)(n.targetTable).forEach(function(t){var t=n.sourceRelationshipName+"."+t.value;i.push({name:t,value:t})}):n.targetTable.name===t.name&&(0,ut.ose)(n.sourceTable).forEach(function(t){var t=n.targetRelationshipName+"."+t.value;i.push({name:t,value:t})})},e=0,o=t.QOt.relationships;e<o.length;e++)r(u=o[e]);return i}function M(t){for(var n,i,r,e,o,u,n,i={},r=0,e=(0,ot.keys)(t);r<e.length;r++)i[u=0<=(u=o=e[r]).indexOf(".")?o.replace(".","_"):u]=t[o];return i}function E(t){for(var n,i,r,e,o,u,s,c,n=0,i=t.groupBy;n<i.length;n++)for(r=i[n],o=0,u=e=Object.keys(r);o<u.length;o++)0<=(s=u[o]).indexOf(".")&&(r[c=s.replace(".","_")]=r[s],r[c].caption||(r[c].caption=s),delete r[s])}function _t(t,n){var t=t._dataSource.options;n?(t.schema||(t.schema={}),t.schema.window=n):t.schema&&(delete t.schema.window,0===Object.keys(t.schema).length)&&delete t.schema}function mt(t,n){var t=t._dataSource.options,i=n;return t.schema?t.schema.window?(i=r(r({},t.schema.window),n),t.schema.window=i):t.schema.window=n:t.schema={window:n},i}function jt(t,n,i,r,e,o){var r,u,r=r||lt(i,e,st,st,st,st,0,0,!1,o),u=i.name+c+Math.floor(1e3*Math.random());return t.push(u),(i=n.addTable(u,{data:r})).fetchSync(),o=dt(i.length()),{table:i,viewColumnInfos:e=(0,ut.ose)(i),viewIndexMap:o}}function Ot(t,n){for(var i,r,e,i=0,r=n;i<r.length;i++)-1<(e=r[i]).indexOf(c)&&t.removeTable(e)}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t=n("./dist/src/dataManager.js"),ot=n("./dist/src/dataSource/utils.js"),P=n("./dist/src/table/windowOverField.js"),ut=n("./dist/src/view/view.js"),s=n("./dist/src/view/view-group.js"),h=n("./dist/src/view/view-sort.js"),i=n("./dist/src/viewField/fieldManager.js"),o=n("./dist/src/viewField/groupManager.js"),st=void 0,t.DataManager.prototype.query=function(t){var n,t,i,r,e,o,i;return"string"==typeof t?n=this.queries[t]:(n=t).name&&(this.queries[t.name]=t),t=this.Ube(n),n.nest&&(e=p(r=N(i=this.tables[n.from])),o=dt(i.length()),i=lt(i,r,st,st,st,e,0,0,!1,o),this.Hbe(n.groupBy,n.nest,t,i,1)),t},t.DataManager.prototype.Hbe=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,o=1,u="nested_"+e+"_";if(t&&0<t.length&&n)for(s=0,c=t;s<c.length;s++)for(a=O(f=c[s],!1),h=O(f,!0),l=f[a[a.length-1]].includeDetailRows,v=0,p=d=C(i,h);v<p.length;v++)b=(w=p[v]).$rows.map(function(t){return M(r[t])}),m=u+o++,(j=this.addTable(m,{data:b})).fetchSync(),(y=(0,ot.clone)(n)).from=m,E(y),g=this.Ube(y),this.removeTable(m),this.Hbe(y.groupBy,y.nest,g,b,e+1),l||delete w.$rows,Object.assign(w,g)},t.DataManager.prototype.Ube=function(t){var n,i,r,e,o,u,P,t,s,c,f,a,k,L,h,l,d,v,p,V,w,G,q,b,B,t,m,j,c,f,a,t,y,h,U,H,W,g,_,O,K,J,S,C,$,_,R,F,I,Y,N,X,M,I,R,z,E,F,I,x,N,T,D,Q,Z,tt,A,nt,it,rt,et,n=this,i=n.tables[t.from];if(i){if(e=!(r=[]),t.unpivot&&(e=!0,i._dataSource.rse=i._dataSource._data,i.fetchSync(t.unpivot)),o=dt(i.length()),u=(0,ut.ose)(i),s=(t=yt(t,P=n.relationships.filter(function(t){return t.sourceTable.name===i.name}).map(function(t){return t.sourceRelationshipName}),i.options,i)).selectFields,c=t.relatedColumns,f=t.calculateColumns,a=t.windows,k=t.limit,L=t.skip,h=t.filterExpression,l=t.groupInfos,d=t.sortInfos,0<c.length)for(v=0,p=c;v<p.length;v++)V=p[v],u.push(V);if(0<f.length)for(w=0,G=f;w<G.length;w++)q=G[w],u.push(q);if((b=a)&&0<Object.keys(a).length&&(B=(t=i._dataSource.options.schema)&&t.window,b=mt(i,b)),h&&(o=vt(i,h,o)),m=Object.keys(s).filter(function(t){return i.Pbe(t)}),j=function(o,t,u){t.forEach(function(t){var t,n,i,r,e;if(t)for(t=t.field,i=0,r=n=u.Gbe(t);i<r.length;i++)e=r[i],o.push(e)})},d&&0<d.length&&l.length<=0&&j(m,d,i),0<m.length&&(h&&(f=(c=u.reduce(function(t,n){return t[i.Pbe(n.value)?0:1].push(n),t},[[],[]]))[0],a=c[1],mt((t=jt(r,n,i,null,u=a,o)).table,b),i=t.table,o=t.viewIndexMap,u=t.viewColumnInfos.concat(f)),o=bt(m,i,u,o)),d&&0<d.length&&l.length<=0&&pt(i,u,st,d,o),y={},0<(0,ot.keys)(s).length&&(h=lt(i,u,st,st,st,s,k,L,!1,o))&&0<h.length&&(y.$r=h),0<l.length)for(U=ft(o),H=o.slice(0),W=u.slice(0),g=0;g<l.length;g++){if(O=(_=l[g]).groupByInfos,K=_.groupSelectFields,J=_.groupCalculateInfos,S=_.groupFilterInfos,C=_.groupSortInfos,$=_.includeDetailRows,_=_.includeDetailRowsForNest,F=(R=wt(i,O,o,u)).rootNode,I=R.newIndexMap,Y=R.fieldMgr,N=R.groupMgr,o=I,u=X=R.columnInfos,0<(M=void 0,ot.keys)(K).length){if(R=(I=at(F,O.length)).indexMap,z=I.queue,M=lt(i,u,N,Y,O,K,0,0,!0,o=R),$&&y.$r||_)for(E=0;E<M.length;E++)M[E].$rows=z[E].recordRowNumbers.map(function(t){return U[t]});if(F=ct(C)||d&&0<d.length,0<J.length||0<S.length||F){for(x=(I=jt(r,n,i,M)).table,N=I.viewIndexMap,T=I.viewColumnInfos,mt(x,b),m=[],D=0,Q=J;D<Q.length;D++)for(Z=Q[D],T.push(Z),A=0,nt=tt=x.Gbe(Z.value);A<nt.length;A++)it=nt[A],m.push(it);0<S.length&&(N=vt(x,rt=gt(S),N)),ct(C)?j(m,C.reduce(function(t,n){return t.concat(n)},[]),x):d&&0<d.length&&j(m,d,x),N=bt(m,x,T,N),ht(y,et=lt(x,T,st,st,st,st,0,0,!1,N),O,C,d)}else ht(y,M,O)}o=H,u=W}return _t(i,B),e&&(i._dataSource._data=i._dataSource.rse,i.fetchSync(st,!0)),Ot(n,r),y}},c="_VirtualTable_"},"./dist/src/relationship.js":function(t,n,i){"use strict";var r,a,e,o;function u(t,n,i,r,e,o){this.sourceTable=t,this.sourceFieldName=n,this.sourceRelationshipName=i,this.targetTable=r,this.targetFieldName=e,this.targetRelationshipName=o,i&&(this.sourceField=t.xOt(n,i,r,e,this)),o&&(this.targetField=r.xOt(e,o,t,n,this))}Object.defineProperty(n,"__esModule",{value:!0}),n.Relationship=void 0,r=i("./dist/src/interfaces/interface.js"),a=i("./dist/src/dataSource/utils.js"),e=void 0,u.prototype.Gf=function(t,n,i,r,e,o){return new u(t||this.sourceTable,n||this.sourceFieldName,i||this.sourceRelationshipName,r||this.targetTable,e||this.targetFieldName,o||this.targetRelationshipName)},u.prototype.NOt=function(t){return t===this.targetRelationshipName},u.prototype.VP=function(){this.sourceTable&&this.sourceTable.kOt(this),this.targetTable&&this.targetTable.kOt(this)},u.prototype.DOt=function(t){return this.relationshipMap===r.RelationshipMap.OneToMany&&t===this.sourceRelationshipName?r.RelationshipMap.OneToOne:this.relationshipMap},u.prototype._Ot=function(){var t,n,t=this.sourceTable,n=this.sourceFieldName;if(t.EOt())return t.jOt(n)&&!t.OOt()?r.RelationshipMap.OneToOne:r.RelationshipMap.OneToMany},u.prototype.ROt=function(t){var n=this.relationshipMap;return(0,a.isNullOrUndefined)(n)&&(n=this.relationshipMap=this._Ot()),(0,a.isNullOrUndefined)(n)?t:n===r.RelationshipMap.OneToOne?{uit:"object"}:{uit:"array"}},u.prototype.BOt=function(){var i,r,e,t,o,n,u,s,c;function f(t,n,i){t[n]?(t[n].push(i),t.uit="array"):t[n]=[i]}for(i=this.sourceField.LOt={uit:"object"},r=this.targetField.LOt=this.ROt({}),e=this.ROt({uit:"object"}),t=this.sourceTable.getDataSync(),o=this.targetTable.getDataSync(),n=0;n<t.length;n++)u=t[n][this.sourceFieldName],(0,a.isNullOrUndefined)(u)||f(e,u,n);for(s=function(n){var t=o[n][c.targetFieldName];(0,a.isNullOrUndefined)(t)||e[t]&&(r[n]=e[t],e[t].forEach(function(t){f(i,t,n)}))},c=this,n=0;n<o.length;n++)s(n);this.targetField.type=e.uit,this.sourceField.type=i.uit},u.prototype.dl=function(t){this.sourceField.LOt=e,this.targetField.LOt=e,this.targetTable.FOt(t?this.targetTable===t:e),this.sourceTable.FOt(t?this.sourceTable===t:e)},n.Relationship=u},"./dist/src/res.en.js":function(t,n){"use strict";var i,r,n;function e(t,n){return{description:t,parameters:n}}function o(t,n,i,r){return{name:t,optional:n,repeatable:i,enum:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.resource=void 0,n.resource={zve:{WINDOW:e("(TableSheet Specific) Determines the rows as the window by partitioning and ordering to apply the window function.",[o("window_function"),o("partition_by",!0),o("order_by",!0),o("frame_rows\\range\\groups",!0)]),WINDOWDEF:e("(TableSheet Specific) Define a shorthand that allow to be reused by the WINDOW function.",[o("partition_by",!0),o("order_by",!0),o("frame_rows\\range\\groups",!0)]),PARTITIONBY:e("(TableSheet Specific) Divides the rows into partitions.",[o("field_function",!(n=[{value:"0",description:"This is the default case, no rows are excluded."},{value:"1",description:"The current row is excluded, the other peers of the current row remain."},{value:"2",description:"The current row and the peers are all excluded."},{value:"3",description:"The current row remain, the other peers are excluded."}]),!0)]),ORDERBY:e("(TableSheet Specific) Defines the logical order in each partition.",[o("field_function",!(r=[{value:"-1",description:"Indicates the lower following of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@+n]",description:"Indicates the n following of the current, if the order is ascending."},{value:"[@-n]",description:"Indicates the n following of the current, if the order is descending."}]),!0)]),ORDERASC:e("(TableSheet Specific) Specifies ascending order for the specified field.",[o("field_function")]),ORDERDESC:e("(TableSheet Specific) Specifies descending order for the specified field.",[o("field_function")]),FRAMEROWS:e("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending rows against the current row.",[o("beginning_function",!(i=[{value:"-1",description:"Indicates the upper boundary of the partition."},{value:"[@]",description:"Indicates the current row or value."},{value:"[@-n]",description:"Indicates the n preceding of the current, if the order is ascending."},{value:"[@+n]",description:"Indicates the n preceding of the current, if the order is descending."}]),!1,i),o("ending_function",!0,!1,r),o("exclude_mode",!0,!1,n)]),FRAMERANGE:e("(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the value in the current row.",[o("beginning_function",!1,!1,i),o("ending_function",!0,!1,r),o("exclude_mode",!0,!1,n)]),FRAMEGROUPS:e('(TableSheet Specific) Limit the row set of the window by specified the beginning or ending range with respect to the counting "groups" relative to the current group.',[o("beginning_function",!1,!1,i),o("ending_function",!0,!1,r),o("exclude_mode",!0,!1,n)]),CUMEDIST:e("(TableSheet Specific) The cumulative distribution of a value within a group of values.",[]),W_PERCENTRANK:e("(TableSheet Specific) Calculates the percentage of the relative rank of a row within a partition of rows.",[]),ROWNUMBER:e("(TableSheet Specific) Returns the number of the current row within its partition.",[]),W_RANK:e("(TableSheet Specific) Returns the rank of each row within the partition of a result set.",[]),DENSERANK:e("(TableSheet Specific) Returns the rank of the current row within its partition, without gaps.",[]),LEAD:e("(TableSheet Specific) Provides access to the value from a row at a given physical offset that follows the current row.",[o("value_function"),o("offset",!0),o("default_value",!0)]),LAG:e("(TableSheet Specific) Provides access to the value from a row at a given physical offset that before the current row.",[o("value_function"),o("offset",!0),o("default_value",!0)]),NTILE:e("(TableSheet Specific) Divides a partition into N buckets, assigns each row its bucket number.",[o("n")]),FIRSTVALUE:e("(TableSheet Specific) Access to the value from the first row within the window frame.",[o("value_function")]),LASTVALUE:e("(TableSheet Specific) Access to the value from the last row within the window frame.",[o("value_function")]),NTHVALUE:e("(TableSheet Specific) Access to the value from the n-th row within the window frame.",[o("value_function"),o("n")]),CALCULATE:e("(TableSheet Grouping Specific) Expand the group context for the formula.",[o("formula"),o("remove_filters_function")]),REMOVEFILTERS:e("(TableSheet Grouping Specific) Select the context of the upper group level.",[o("group_field_function",!0,!0)]),CHILDREN:e("(TableSheet Hierarchy Specific) Retrieves the value of the children that be a certain offset from the parent.",[o("level_offset"),o("field_function")]),ONLYCHILDREN:e("(TableSheet Hierarchy Specific) Retrieves the value of the children that be not parent.",[o("field_function")]),PARENT:e("(TableSheet Hierarchy Specific) Retrieves the value of the parent that be a certain offset from the current.",[o("level_offset"),o("field_function")]),LEVEL:e("(TableSheet Hierarchy Specific) Retrieves the level of the current.",[]),LEVELROWNUMBER:e("(TableSheet Hierarchy Specific) Retrieves the row number of the current under its parent.",[])}}},"./dist/src/table/calcField.js":function(t,n,i){"use strict";var r,e,l,d,o,u,s;function c(t,n,i,r){var e,n,o,e=s.call(this)||this;if(e.eCe=0,e.calcSource=n.POt,e.calcService=e.calcSource.getCalcService(),e.GOt=t,(n=e.calcSource).Vbe=n.Vbe||[],n.Vbe.indexOf(t)<0){n.Vbe.push(t);try{o=e.expression=i||e.calcService.parse(e.calcSource,t,0,0),e.calcService&&o&&(e.w3=e.calcService.getGlobalSourceModel(),e.w3.cyt(e,0,0,o,o,!0))}catch(t){}n.Vbe.pop()}return e.Tl=[],e.zbe=(0,l.isNullOrUndefined)(r)?0:r,e}r=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CalcField=void 0,e=i("CalcEngine"),l=i("./dist/src/dataSource/utils.js"),d=void 0,s=e.BaseCalc,r(c,s),c.prototype.getKey=function(){var t=this;return"T:"+t.calcSource.nM.name+":"+t.GOt},c.prototype.vyt=function(){this.c_t().I3(this,3)},c.prototype.c_t=function(){return this.calcService},c.prototype.P6t=function(){this.C8()},c.prototype.C8=function(){this.Tl=[],this._me=d,this.eCe=0},c.prototype.getValue=function(t){var n,i,r;if(!this.expression)return"Invalid Formula";for((n=this.calcService).Ybe=n.Ybe||[],n.Zbe=n.Zbe||[],i=0;i<n.Ybe.length;i++)if(n.Ybe[i]===this&&n.Zbe[i]===t)return n.Wbe=!0,this.zbe;if(0!==n.Ybe.length||(r=this.Tl[t],(0,l.isUndefined)(r)&&!(0,l.isUndefined)(t))){this.calcSource.pe(t),n.Ybe.push(this),n.Zbe.push(t);try{r=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:t,col:0},1<n.Ybe.length)}catch(t){}n.Wbe?r=e.Errors.Calc:1===n.Ybe.length&&(this.Tl[t]=r),n.Ybe.pop(),n.Zbe.pop(),0===n.Ybe.length&&delete n.Wbe}return r},c.prototype.getValues=function(t,n,i,r,e,o){var u,s,c,f,a,h;if(n=(0,l.isNumber)(n)?n:0,i=(0,l.isNumber)(i)?i:t.length-1,u=[],this._me!==t||this.eCe!==t.length)for(s=t.length,this._me=t,this.eCe=s,c=0;c<s;c++)u.push(this.getValue(t[c]));if(0===u.length)if(r!==d&&e!==d){for(f=n;f<r;f++)u.push(this.Tl[t[f]]);for(o!==d&&u.push(this.Tl[t[o]]),f=e+1,a=i+1;f<a;f++)u.push(this.Tl[t[f]])}else for(f=n,h=i+1;f<h;f++)u.push(this.Tl[t[f]]);else u=u.slice(n,i+1),r!==d&&e!==d&&(o!==d?u.splice(r-n,e-r+1,u[o-n]):u.splice(r-n,e-r+1));return u},c.prototype.getValueWithContext=function(t){var n,t,n=this.calcSource.DJ,t=this.getValue(t);return this.calcSource.DJ=n,t},c.prototype.insertItem=function(t,n){},c.prototype.getOriginalValue=function(t){},c.prototype.getRelatedTable=function(){},c.prototype.getRelationMaps=function(){},c.prototype.getHostTableIndexes=function(t){},n.CalcField=c},"./dist/src/table/hierarchyField.js":function(t,n,i){"use strict";var r,e,o,u;function s(t,n){this.GOt=t,this.nM=n,this.UOt=new e.CalcField(this.l7t(),n),this.HOt=new o.TableField(t,n)}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchyField=void 0,r=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/table/calcField.js"),o=i("./dist/src/table/tableField.js"),s.prototype.getKey=function(){return this.UOt.getKey()},s.prototype.vyt=function(){this.UOt.vyt()},s.prototype.c_t=function(){return this.UOt.c_t()},s.prototype.P6t=function(){this.C8()},s.prototype.l7t=function(){return this.nM.isHierarchy()?this.nM._dataSource.l7t(this.GOt):void 0},s.prototype.C8=function(){var t=this.l7t();(0,r.isNullOrEmpty)(t)?this.UOt=null:(0,r.isNullOrUndefined)(this.UOt)||t!==this.UOt.GOt?this.UOt=new e.CalcField(t,this.nM):this.UOt.C8(),this.HOt=new o.TableField(this.GOt,this.nM)},s.prototype.zOt=function(t){var n,n,n=this.nM;if(n.isHierarchy())return n=n.SEt(t),!(0,r.isNullOrUndefined)(n)&&0<n.children.length},s.prototype.getValue=function(t){return(!(0,r.isNullOrUndefined)(this.UOt)&&this.zOt(t)?this.UOt:this.HOt).getValue(t)},s.prototype.getValues=function(t,n){for(var i,r,e,i=[],r=n=n||0,e=t.length;r<e;r++)i.push(this.getValue(t[r]));return i},s.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},s.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},s.prototype.hasItem=function(t){this.HOt.hasItem(t)},s.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},s.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},s.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},s.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},s.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.HierarchyField=s},"./dist/src/table/table.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/table/tableEvents.js"),n),e(i("./dist/src/table/table.js"),n)},"./dist/src/table/table.js":function(t,n,i){"use strict";var r,l,s,e,h,b,u,o,c,d,v,p,f,j,a,w,m,i,y,g,_;function O(t,n,i){var r={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,onSucceeded:t,onFailed:n,onEnd:i,invoke:function t(){0===r.asyncCount&&r.syncDone&&(r.failedArgs?r.onFailed&&r.onFailed(r.failedArgs):r.onSucceeded&&r.onSucceeded(r.succeededArgs),r.onEnd)&&r.onEnd(r.succeededArgs||r.failedArgs)},execute:function t(n){n&&(r.onEnd=n),r.syncDone=!0,r.invoke()},suspend:function t(){return r.asyncCount++,{succeed:function t(n){r.succeededArgs=n,r.resume()},fail:function t(n){r.failedArgs=n,r.resume()}}},resume:function t(){r.asyncCount--,r.invoke()}};return r}function S(t,n){var i,r,e,o;for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i],n)if(n.hasOwnProperty(e)&&r===(o=n[e])&&0<r.rb)return!0}function C(t,n){return S(n.views,t.VOt)}function R(t,n){return-1<t.indexOf("[".concat(n,"]"))||-1<t.indexOf("[@".concat(n))||-1<t.indexOf("[@[".concat(n))}function F(t,n,i,r){var e,o,u,t,s,c,f,a;if(0!==n){for(e=t&&"="===t[0]?function(t){return(0,b.formatCalcError)(r(t))}:r,t=i&&i.dataType,s=i&&i.dataMap,c=!!t,f=0;f<n;f++)a=e(f),s&&!(0,b.isNullOrUndefined)(s[a])&&(a=s[a]),c||(0,b.isNullOrUndefined)(a)||(u=a,c=!0),(o=o||{})[a=a instanceof Date?new Date(a.getFullYear(),a.getMonth(),a.getDate()).toISOString():a]||(o[a]=[]),o[a]&&o[a].push(f);return o.K$=t||(c?typeof u:"object"),o}}function I(t,n,i,r){var e,o,u,u,s;for(e in t)t.hasOwnProperty(e)&&(o=t[e],u=(u=r&&r[e])&&u.dataMap,o)&&(s=i[e],o[s=(s=u&&!(0,b.isNullOrUndefined)(u[s])?u[s]:s)instanceof Date?s.toISOString():s]?o[s].push(n):o[s]=[n])}function N(t,n,i,r,e,o){var t,i,o,t=t[i],i=o&&o.dataMap;t&&e!==r&&(i&&((0,b.isNullOrUndefined)(i[r])||(r=i[r]),(0,b.isNullOrUndefined)(i[e])||(e=i[e])),r instanceof Date&&(r=r.toISOString()),e instanceof Date&&(e=e.toISOString()),o=t[r])&&(1<o.length?o.splice(o.indexOf(n),1):delete t[r],t[e]?t[e].push(n):t[e]=[n])}function M(t,n,i){var r,e,o,u,s;for(r in t)if(t.hasOwnProperty(r)&&(e=t[r]))for(o in e)if(e.hasOwnProperty(o)&&(0,b.isArray)(e[o])&&(u=e[o],(0,b.isArray)(u))){for(s=0;s<u.length;s++)u[s]>=n+i?u[s]-=i:u[s]>=n&&u[s]<n+i&&(u.splice(s,1),s--);0===u.length&&delete e[o]}}function E(t,n){var t;this.Qbe=void 0,this.YOt={},this.ZOt={},this.WOt=0,Object.defineProperty(this,"name",{get:function(){return this.Zc},set:function(t){var n,i,r,e,i,n=this.Zc;if(this.Zc=t,i=this.QOt){for(r in this.VOt)this.VOt.hasOwnProperty(r)&&(e=this.VOt[r]).KOt(n,t);delete(i=i.tables)[n],i[t]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(t){var n,n,i,n,r,i=this;i.JOt=!0,n=i.options,r=i.length(),i._dataSource.setDataSourceOptions(t,function(t){var t=t&&t.isDataSourceChanged;i.ase(r,t?m:i.columns,t)}),i.pCe((null==(n=n.schema)?void 0:n.window)||{},(null==(n=t.schema)?void 0:n.window)||{})}}),this.name=t,t=n instanceof s.DataSource?n:new s.DataSource(n),this._dataSource=t,this.views={},this.VOt={},this.Pq=[],this.XOt={},this.qOt=w,this.JOt=!0,this.aT={}}function x(t){var n,t,i,r,n={data:t.data,remote:t.remote,autoSync:t.autoSync,batch:t.batch,schema:t.schema},t=t.remote;return t&&(i=n.remote={},(r=t.read)&&!(0,b.isFunction)(r)&&(i.read=r),(r=t.create)&&!(0,b.isFunction)(r)&&(i.create=r),(r=t.update)&&!(0,b.isFunction)(r)&&(i.update=r),(r=t.delete)&&!(0,b.isFunction)(r)&&(i.delete=r),(r=t.getColumns)&&!(0,b.isFunction)(r)&&(i.getColumns=r),(r=t.addColumn)&&!(0,b.isFunction)(r)&&(i.addColumn=r),(r=t.updateColumn)&&!(0,b.isFunction)(r)&&(i.updateColumn=r),(r=t.removeColumn)&&!(0,b.isFunction)(r)&&(i.removeColumn=r),r=t.batch)&&!(0,b.isFunction)(r)&&(i.batch=r),n}function T(){return null!==_&&_.apply(this,arguments)||this}r=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Table=n.updateFilterIndexesCacheOnRemove=n.updateFilterIndexesCacheOnUpdate=n.updateFilterIndexesCacheOnInsert=n.generateFilterIndexCache=n.isInCalcField=void 0,s=i("./dist/src/dataSource/dataSource.js"),e=i("./dist/src/calculation/calcSource.js"),h=i("CalcEngine"),b=i("./dist/src/dataSource/utils.js"),u=i("./dist/src/dataSource/dataSource.interface.js"),o=i("./dist/src/view/view.js"),c=i("./dist/src/interfaces/interface.js"),d=i("./dist/src/table/tableEvents.js"),v=i("./dist/src/table/calcField.js"),p=i("./dist/src/table/tableField.js"),f=i("./dist/src/table/hierarchyField.js"),j=i("./dist/src/table/windowOverField.js"),a=i("./dist/src/table/triggerCalcField.js"),w=null,m=void 0,n.isInCalcField=R,n.generateFilterIndexCache=F,n.updateFilterIndexesCacheOnInsert=I,n.updateFilterIndexesCacheOnUpdate=N,n.updateFilterIndexesCacheOnRemove=M,E.prototype._Et=function(t,n,i){var r,e,n;"="===(n=!(0,b.isNullOrUndefined)(n)&&""!==n?n:"*")[0]?(r=this.bEt(n)).Iwt(0,t,i):(e=(e=this.aT[n])||(this.aT[n]={}),n=t.getKey(),i?e[n]=t:delete e[n])},E.prototype.o_t=function(t,n){var i,r,i=function(t,n){for(var i in t)n&&i.startsWith("T:")||t[i].vyt()};if((0,b.isNullOrUndefined)(t))for(r in this.aT)this.aT[r]&&i(this.aT[r],n);else-1<t.indexOf(".")&&(t=t.split(".")[0]),i(this.aT[t]),i(this.aT["*"])},E.prototype.REt=function(t){var n,i;if(t)this.QOt=t,this.POt=new e.DataManagerCalcSource(t.Lp,this);else{for(n in this.POt=w,this.views)this.views.hasOwnProperty(n)&&this.removeView(n);for(n in this.VOt)this.VOt.hasOwnProperty(n)&&((i=this.VOt[n]).$Ot(this),delete this.VOt[n]);this.QOt=t}},E.prototype.Ywt=function(t,n,i){var r=this.POt;return r.getCalcService().parse(r,t,n||0,i||0)},E.prototype.wde=function(t){var n=this.POt;return n.getCalcService().unparse(n,t,0,0)},E.prototype.nMt=function(t,n,i){var r=this.POt;return(0,b.isNumber)(n)&&r.pe(n),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:i||0})},E.prototype._fe=function(t,n,i){var r=this.POt;return r.pe(n,m,m,i),r.getCalcService().evaluateExpression(r,t,{row:n||0,col:0})},E.prototype.getDataSync=function(t){return this._dataSource.tOt(t)},E.prototype.NEt=function(t,n){var i,r,e,o,u,s,i=this;if(t){if(0<=t.indexOf(i))return w}else{if(i.tRt)return i.tRt;r=!0,t=[],n=[]}for(t.push(i),n.push(new Promise(function(t){if(i.JOt)return i.fetch().finally(t);t(null)})),e=i.Pq,o=0;o<e.length;o++)(s=(u=e[o]).targetTable)&&s.NEt(t,n);if(r)return i.tRt=Promise.all(n),i.tRt},E.prototype.fetch=function(n,i){var r,e,o,r=this;return!0!==n&&void 0!==r.Qbe?r.Qbe:(r.BEt&&(e=r.columns),o=r.length(),r.Qbe=r._dataSource.load({reload:n}),r.Qbe.then(function(t){return i&&!n&&r.isFetched()||r.ase(o,e,n),Promise.resolve(t)}).finally(function(){r.Qbe=void 0}))},E.prototype.isFetched=function(){return!this.JOt},E.prototype.cPt=function(t){var n,i,r,e,o,u,s,c,n=this,i={};if(t&&(r=n.columns))for(u=e=(o=0,b.keys)(r);o<u.length;o++)(c=r[s=u[o]]).value&&"="===c.value[0]&&(i[s]=c),"workTime"===c.value&&(i[s]=c),"TaskResources"===c.dataType&&(i[s]=c);return i},E.prototype.Kbe=function(i){var r,t,n,e,o,t,u,s,r=this,t=r._dataSource.options.schema,n=r.get(0),e=t&&t.columns;if(e)for(o in(0,b.isNullOrUndefined)(n)&&(n={}),e)n.hasOwnProperty(o)||e[o].spread||(n[o]=e[o]);n&&(t=(0,b.keys)(n),u=r.columns=r.cPt(!0),s=r.Pq=r.Pq.filter(function(t){return t.sourceField||t.targetField}),t.forEach(function(t){var n=i&&i[t];u[t]=r.nRt(t,n,e&&e[t]),s.push({name:t})}))},E.prototype.ase=function(t,n,i){var r,e,o,u,s,c,f,r=this,e=r._dataSource.options.schema;if((r.JOt||i)&&(r.Kbe(n),r.JOt=!1),i&&r.ARt(),e&&e.columns){for(s in u=[],o=e.columns)o[s]&&o[s].indexed&&u.push(s);r.eRt(u)}if(i&&r.clearIndexes(),r.createIndexes(r.qOt||[]),r.BEt=!1,r.dl(),i)for(f in r._dataSource.pOt(),c=r.views)c.hasOwnProperty(f)&&c[f].iM(t!==r.length(),!0);r.Jbe=m},E.prototype.fetchSync=function(t,n,i){var r,e,n,o,t,r=this,e=r.length(),n=r._dataSource.loadSync(t,n),o=m,t=(0,b.isNullOrUndefined)(t);return i&&(o=r.columns,t)&&r.Kbe(o),r.ase(e,o,!t),n},E.prototype.nRt=function(t,n,i){var o,r,e,u,s,s,o=this,r={jOt:!1};if((0,b.isNullOrUndefined)(n))i&&(i.dataType&&(e=i.dataType),i.isPrimaryKey)&&(r.jOt=i.isPrimaryKey);else{for(u in n)n.hasOwnProperty(u)&&!(0,b.isNullOrUndefined)(n[u])&&(r[u]=n[u]);e=n.W5||n.dataType||i&&i.dataType,(s=n.jOt||n.isPrimaryKey||i&&i.isPrimaryKey)&&(r.jOt=s)}return this.qOt&&0<this.qOt.length&&-1<this.qOt.indexOf(t)&&(r.jOt=!0),r.value=t,r.name=t,i&&!(0,b.isNullOrUndefined)(i.caption)&&(r.caption=i.caption),(i&&"formula"===i.dataType||"formula"===r.dataType)&&(s=(null==i?void 0:i.value)||n.value,r.value="="===s[0]?s:"="+s,r.readonly=!0,r.caption=t),Object.defineProperty(r,"dataType",{get:function(){return e},set:function(t){var t;e!==t&&("rowOrder"!==e&&"rowOrder"!==t||!o.isHierarchy()||o.setHierarchyOptionChanged(),"formula"!==(e=t)&&o._dataSource.xjt(this.name,this.dataType,this.dataPattern),t=this.value,o.dl(t),o.rRt(t))}}),Object.defineProperty(r,"isPrimaryKey",{get:function(){return this.jOt},set:function(t){this.jOt!==t&&(this.jOt=t,o.qOt||(o.qOt=[]),o.qOt.slice().sort().join(",")!==o.Ljt(!0).slice().sort().join(","))&&o.createIndexes(o.qOt)}}),Object.defineProperty(r,"mappedName",{get:function(){return this.value},set:function(n){var i;this.value===n||(0,b.isNullOrEmpty)(n)||(i=this.value,o._dataSource.Njt(i,n),o.dl(i),o.rRt(n),o.oRt(i,n),o.aRt(i,n),o.Pq.forEach(function(t){t.name===i&&(t.name=n)}),o.qOt=(o.qOt||[]).map(function(t){return t===i?n:t}),o.columns[n]=o.columns[i],delete o.columns[i],this.name=this.value=n)}}),Object.defineProperty(r,"relationship",{get:function(){for(var t,n,i,r,t,n=0,i=o.QOt.relationships;n<i.length;n++){if((r=i[n]).sourceTable===o&&r.sourceFieldName===this.value)return{table:r.targetTable,field:r.targetFieldName,sourceName:r.sourceRelationshipName,targetName:r.targetRelationshipName};if(r.targetTable===o&&r.targetFieldName===this.value)return{table:r.sourceTable,field:r.sourceFieldName,sourceName:r.sourceRelationshipName,targetName:r.targetRelationshipName}}},set:function(t){for(var n,i,r,e,n,i=0,r=o.QOt.relationships;i<r.length;i++)if((e=r[i]).sourceRelationshipName===t.sourceName){o.QOt.removeRelationship(e.sourceRelationshipName);break}t.table&&t.field&&o.QOt.addRelationship(o,this.value,t.sourceName,t.table,t.field,t.targetName)}}),r},E.prototype.isDataColumn=function(t){var n=(0,b.isString)(t)?t:t.value;return!((0,b.isFormula)(n)||(0,b.isNamedFormulaColumn)(t)||(0,b.isRelation)(n)||(0,b.isFunction)(n))&&this._dataSource.iCe(n)},E.prototype.canAddedColumn=function(t){return(0,b.isNamedFormulaColumn)(t)&&(0,b.isNullOrUndefined)(this.columns[t.name])||this.isDataColumn(t)},E.prototype.hasExistedColumn=function(t){var t=(0,b.isString)(t)?t:t.name;return!(0,b.isNullOrUndefined)(this.columns[t])},E.prototype.PBe=function(t){(0,b.isNamedFormulaColumn)(t)||(t.name=t.value)},E.prototype.uBe=function(t){this._dataSource.uBe(t);var n=t.name;this.GBe(n),delete this.columns[n],this.Pq.splice(this.Pq.findIndex(function(t){return t.name===n}),1)},E.prototype.addColumn=function(t,n,i){var r,e,r=this;this.PBe(t),this.hasExistedColumn(t)||!this.canAddedColumn(t)?i({type:s.ADD_COLUMN,success:!1}):(this.UBe(t),e=this.HBe(t),this._dataSource.cBe(t,e,function(t){r.dl(),r.Jhe(),n&&n(t)},i))},E.prototype.UBe=function(t,n){var i=t.name,r={name:i};this.columns[i]=this.nRt(i,t),this.rRt(i),(0,b.isNumber)(n)?this.Pq.splice(n,0,r):this.Pq.push(r)},E.prototype.HBe=function(t){var n,i,r,e;if(t&&!(0,b.isUndefined)(t.defaultValue)&&this.isDataColumn(t)){if(n=this.length(),i=[],"object"!=typeof t.defaultValue||t.defaultValue instanceof Date)if((0,b.isFormula)(t.defaultValue))try{for(e=this.Ywt(t.defaultValue),r=0;r<n;r++)i.push(this.nMt(e,r))}catch(t){}else for(r=0;r<n;r++)i.push(t.defaultValue);else if((0,b.isArray)(t.defaultValue))for(r=0;r<n;r++)i.push(t.defaultValue.slice());else for(r=0;r<n;r++)i.push(l({},t.defaultValue));return i}},E.prototype.vBe=function(t){this._dataSource.vBe(t);var n=t.table,t=t.name;n&&(n.column&&(this.columns[t]=n.column),n.field&&this.Pq.splice(n.fieldIndex,0,n.field),this.dl(),this.Jhe())},E.prototype.removeColumn=function(t,n,i){var r,e,r=this;!this.hasExistedColumn(t)||this.ABe(t)||this.xBe(t)?i({type:s.REMOVE_COLUMN,success:!1}):(this.VBe(t,e={}),this._dataSource.gBe(t,function(t){t.table=e,r.dl(),r.Jhe(),n&&n(t)},i))},E.prototype.VBe=function(t,n){var i,r,e,i=!!n;for((n=n||{}).column=this.columns[t],n.name=t,delete this.columns[t],i||(this.dl(),this.Jhe()),this.XOt[t]=m,r=0;r<this.Pq.length;r++)if((e=this.Pq[r]).name===t){this.Pq.splice(r,1),n.field=e,n.fieldIndex=r;break}return r},E.prototype.GBe=function(t){this.dl(t,!0),this.Jhe(),this.ARt(t),this.zBe(t)},E.prototype.bBe=function(t){var n,i,r;if(this._dataSource.bBe(t),n=t.table){if(this.GBe(n.newName),(0,b.isNullOrUndefined)(n.primaryKey)||(this.qOt=""===n.primaryKey?[]:n.primaryKey.split(",")),n.column&&(delete this.columns[n.newName],this.columns[n.name]=n.column),n.field)for(i=0;i<this.Pq.length;i++)(r=this.Pq[i]).name===n.newName&&(r.name=n.name);this.dl(),this.Jhe()}},E.prototype.updateColumn=function(t,n,i,r){var e,o,e=this;!this.hasExistedColumn(t)||this.ABe(t)||this.xBe(t)?r({type:s.UPDATE_COLUMN,success:!1}):((0,b.isNullOrUndefined)(n.value)&&(n.value=t),o={},this.PBe(n),this.YBe(t,n,o),this._dataSource.yBe(t,n,function(t){t.table=o,e.dl(),e.Jhe(),i&&i(t)},r))},E.prototype.YBe=function(n,t,i){var r,e,o,u,s,e,c,f,a,h,r=(0,b.isNamedFormulaColumn)(t),e=this.columns[n].dataType,o=t.dataType,u=!1;for(((u=e===o||(0,b.isNullOrEmpty)(o)||(0,b.isNullOrEmpty)(e)&&(s=this._dataSource.RBe(n))===o?u:!0)||r&&this.columns[n].value!==t.value)&&this.GBe(n),e=this.columns[n],c=t.name,(i=i||{}).column=e,i.name=n,i.newName=c,delete this.columns[n],f=0;f<this.Pq.length;f++)(a=this.Pq[f]).name===n&&(a.name=c);h=t.type!==e.type?l({},t):l(l({},e),t),Object.keys(h).forEach(function(t){"_"===t[0]&&delete h[t]}),this.columns[c]=this.nRt(c,h),e.isPrimaryKey!==t.isPrimaryKey&&(i.primaryKey=this.primaryKey(),t.isPrimaryKey?this.qOt=(this.qOt||[]).concat(c):this.qOt=i.primaryKey.split(",").filter(function(t){return t!==n}))},E.prototype.TBe=function(t){return this.VBe(t.column.name)},E.prototype.IBe=function(t,n){this.UBe(t.originalColumn,n)},E.prototype.kBe=function(t){var n;this.YBe(t.column.name,t.originalColumn)},E.prototype.xBe=function(t){return this._dataSource.xBe(t)},E.prototype.length=function(){return this._dataSource.length()},E.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},E.prototype.isInserted=function(t){return this._dataSource.isInserted(t)},E.prototype.isUpdated=function(t,n){return this._dataSource.isUpdated(t)||(n?this.uRt(t):m)},E.prototype.getErrorInfo=function(t){return this._dataSource.getErrorInfo(t)},E.prototype.uRt=function(t){var n,i,r,e,o,e,u,s,c,n=this,i=n.Pq;for(n.WOt++,r=0;r<i.length;r++)if(o=(e=i[r]).targetTable,e=e.LOt,o&&C(o,n)&&e&&e[t]&&!o.WOt)for(u=0,s=e[t];u<s.length;u++)if(c=s[u],o.isUpdated(c))return n.WOt--,!0;n.WOt--},E.prototype.Xbe=function(){this.Pq.reduce(function(t,n){var n=n.CRt;return n&&t.push(n),t},[]).forEach(function(t){t.VP()})},E.prototype.qbe=function(t){for(var n,i,r,n=t.ltt(),i=0;i<n.length;i++)(r=n[i].CRt)&&(r.sourceTable===t?r.Gf(this):r.Gf(m,m,m,this))},E.prototype.kbe=function(){return this._dataSource.kbe()},E.prototype.$be=function(){var t,n,i,r,e,o,u,s,c,t=this.Jbe;if((0,b.isNullOrUndefined)(t)){for(n=this.name+"__TriggerFormula__"+Math.floor(1e3*Math.random()),(t=this.Jbe=new y(n,{data:[]})).REt(this.QOt),t.fetchSync(),t._dataSource.Lbe(this._dataSource.DEt),i=this._dataSource.jbe(),e=0,o=r=this._dataSource.DEt;e<o.length;e++)u=o[e],t.twe(u,i[u]);for(u in this.columns)this.columns.hasOwnProperty(u)&&(s=this.columns[u].value,(0,b.isFormula)(s))&&t.nwe(u,s);for(u in c=this._dataSource.Obe())c.hasOwnProperty(u)&&t.nwe(u,c[u]);t.dl()}return t},E.prototype.ewe=function(t,n,i){var r,e;if(!(0,b.isNullOrUndefined)(t)&&0<Object.keys(t).length){for(e in r=this.$be(),i?(r._dataSource.insertItem(0,i),r._dataSource.updateItem(0,n)):r._dataSource.insertItem(0,n),r.qbe(this),t)t.hasOwnProperty(e)&&(n[e]=r._getValueByField(e,0));r._dataSource.remove(0,1),r.dl(),r.Xbe()}},E.prototype.iwe=function(t){this.ewe(this._dataSource.jbe(),t)},E.prototype.rwe=function(t,n){var n,r,e,i,o,n=this.vRt(n),r=this._dataSource.jbe(u.TriggerWhenType.onNewAndUpdate),e=Object.keys(t),i=function(t){var i;r.hasOwnProperty(t)&&-1===(i=(0,a.getWatchedFields)(r[t])).indexOf("*")&&!e.some(function(n){return i.some(function(t){return t===n})})&&delete r[t]};for(o in r)i(o);this.ewe(r,t,n)},E.prototype.insertItem=function(n,i,r,t){var e,o,u,e=this;for(o in this.iwe(i),i)i.hasOwnProperty(o)&&this.o_t(o);this.ki(d.Events.ItemInserting,u={index:n,data:i}),this._dataSource.insertItem(n,i,function(t){e.sRt(n,i),e.cRt(n,i),e.dl(),e.Jhe(),e.ki(d.Events.ItemInserted,u),r&&r(t)},t)},E.prototype.recoverItemAtBatch=function(n,i,r,t){var e,o,u,e=this;for(o in this.iwe(i),i)i.hasOwnProperty(o)&&this.o_t(o);this.ki(d.Events.ItemInserting,u={index:n,data:i}),this._dataSource.recoverItemAtBatch(n,i,function(t){e.sRt(n,i),e.cRt(n,i),e.dl(),e.Jhe(),e.ki(d.Events.ItemInserted,u),r&&r(t)},t)},E.prototype.updateItem=function(t,n,i,r){var e,o,u,s,c,f,a,h;for(c in this.rwe(n,t),e=[],o={},u={},s=[],n)n.hasOwnProperty(c)&&(f=n[c],a=this._getValueByField(c,t),(0,b.isNotDeepEqual)(f,a))&&(e=e.concat(this.sge(t,c)),u[c]=a,o[c]=f,s.push(c),this.o_t(c));this.ki(d.Events.ItemUpdating,h={index:t,data:o,originalData:u,changingFields:s}),this._dataSource.updateItemValues(t,o,this.owe(t,o,u,h,e,i),r)},E.prototype.owe=function(e,o,u,s,c,f){var a=this;return function(t){var n,i,r;for(n in o)o.hasOwnProperty(n)&&(i=u[n],r=o[n],a.lRt(e,i,r),a.hRt(e,n,i,r));a.dl(),a.Jhe(),a.uge(e,c),a.ki(d.Events.ItemUpdated,s),f&&f(t)}},E.prototype.fRt=function(n,i,r,e,o,u,s){var c=this;return function(t){c.lRt(n,i,r),c.hRt(n,e,i,r),c.dl(),c.Jhe(),c.uge(n,u),c.ki(d.Events.ItemUpdated,o),s&&s(t)}},E.prototype.dRt=function(t,n,i,r,e,o){var u,s,c,u=this.sge(t,i),s=n[i],c={index:t,data:n,field:i,originalValue:r,newValue:s};this.ki(d.Events.ItemUpdating,c),this._dataSource.updateItem(t,n,this.fRt(t,r,s,i,c,u,e),o)},E.prototype.updateItemValue=function(t,n,i,r,e){var o,u,s,c,c,u=this.sge(t,n),s=this._getValueByField(n,t),c=this.vRt(t);c[n]=i,this.ki(d.Events.ItemUpdating,c={index:t,data:c,field:n,originalValue:s,newValue:i}),this._dataSource.updateItemValues(t,((o={})[n]=i,o),this.fRt(t,s,i,n,c,u,r),e)},E.prototype.resetItem=function(n,t,i){var r,t,i,e,i,o,u,s,r=this,t=O(t,i);this.mRt(n,t.suspend),this._dataSource.isUpdated(n)&&(this.o_t(m,!0),i=t.suspend(),e=i.succeed,i=i.fail,o=this.vRt(n),u=this.gRt(n),s=this.sge(n),this.ki(d.Events.ItemResetting,{index:n}),this._dataSource.resetItem(n,function(t){r.pRt(n,o,u),r.dl(),r.Jhe(),r.uge(n,s),r.ki(d.Events.ItemReset,{index:n,originalData:o,dataBeforeChanged:u}),e(t)},i)),t.execute()},E.prototype.pRt=function(t,n,i){var r,e,o,u,u,r=this,e=r.columns;if(!(0,b.isNullOrUndefined)(n)&&!(0,b.isNullOrUndefined)(i))for(o in e)e.hasOwnProperty(o)&&(u=(u=e[o]).value instanceof Function?u.value.name:u.value,r.hRt(t,u,n[u],i[u]))},E.prototype.mRt=function(c,f){var a,h,t,n,a=this,h=a.Pq;for(a.WOt++,t=function(t){var t,r,t,n,i,e,o,u,s,u,t=h[t],r=t.targetTable,t=t.LOt;if(r&&C(r,a)&&t&&t[c]&&!r.WOt){for(n=[],i=0,e=t[c];i<e.length;i++)o=e[i],r.isInserted(o)?n.push(o):r.isUpdated(o)&&(s=(u=f()).succeed,u=u.fail,r.resetItem(o,s,u));0<n.length&&(n.sort(function(t,n){return n-t}),n.forEach(function(t){var n=f(),i=n.succeed,n=n.fail;r.qCt(t,1,i,n)}))}},n=0;n<h.length;n++)t(n);a.WOt--},E.prototype.saveItem=function(n,t,i){var r,t,i,e,i,e,o,i,r=this,t=O(t,i),i=t.suspend(),e=i.succeed,i=i.fail;this.bRt(n,e,i),(this._dataSource.isUpdated(n)||this._dataSource.isInserted(n))&&(e=t.suspend(),o=e.succeed,i=e.fail,this.ki(d.Events.ItemSaving,{index:n}),this._dataSource.saveItem(n,function(t){r.dl(),r.Jhe(),r.ki(d.Events.ItemSaved,{index:n}),o(t)},i)),t.execute()},E.prototype.bRt=function(t,n,i){var n,r,e,o,u,s,c,s,f,a,h,l,d,l,n=O(n,i),r=n.suspend,e=this,o=e.Pq;for(e.WOt++,u=0;u<o.length;u++)if(c=(s=o[u]).targetTable,s=s.LOt,c&&C(c,e)&&s&&s[t]&&!c.WOt)for(f=0,a=s[t];f<a.length;f++)h=a[f],(c.isUpdated(h)||c.isInserted(h))&&(d=(l=r()).succeed,l=l.fail,c.saveItem(h,d,l));n.execute(function(){return e.WOt--})},E.prototype.get=function(t){return this._dataSource.get(t)},E.prototype.nv=function(t){return this._dataSource.s7t(t)},E.prototype.mTe=function(){return this._dataSource.mTe()},E.prototype.remove=function(t,n,i,r){var e,o,u,s,u,e=this;void 0===n&&(n=1),s=(u=(o=O(function(){e.qCt(t,n,i,r)},r)).suspend()).succeed,u=u.fail,this.yRt(t,n,s,u),o.execute()},E.prototype.qCt=function(n,i,r,t){var e,o,u,e=this;this.o_t(m,!0),o=this.Zc,u={index:n,count:i,tableName:o},this.ki(d.Events.ItemRemoving,u),this._dataSource.remove(n,i,function(t){"number"==typeof t.removedCount&&(u.count=t.removedCount),e.dl(),e.Jhe(),e.wRt(),e.MRt(n,i),e.ki(d.Events.ItemRemoved,u),r&&r(t)},t)},E.prototype.yRt=function(c,f,t,n){var t,a,i,h,r,l,e,t=O(t,n),a=t.suspend,i=this,h=i.Pq;for(i.WOt++,r=function(t){var t,r,n,i,n,t,n,e,o,u,s,t=h[t],r=t.targetTable,n=t.CRt,i=t.LOt;if(r&&n.NOt(t.name)&&i&&l.uCe(c,f,i)&&!r.WOt){for(t=(n=a()).succeed,n=n.fail,e=[],o=void 0,u=function(t){var n=i[c+t];n&&(e=e.concat(Object.keys(n).map(function(t){return n[t]})))},s=0;s<f;s++)u(s);if(0===e.length)return"continue";e.sort(function(t,n){return n-t}),o=e.map(function(i){return function(t,n){r.remove(i,1,t,n)}}),(0,b.promiseSerialExecute)(o).then(t).catch(n)}},l=this,e=0;e<h.length;e++)r(e);t.execute(function(){return i.WOt--})},E.prototype.uCe=function(t,n,i){for(var r=0;r<n;r++)if(i[t+r])return!0;return!1},E.prototype.getChanges=function(){return this._dataSource.getChanges()},E.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},E.prototype.submitChanges=function(t,r,e,o){var u=this;return new Promise(function(n,i){u.SRt(t,r,function(t){n(t),e&&e(t)},function(t){i(t),o&&o(t)})})},E.prototype.SRt=function(r,e,n,i){var o,t,u,s,u,o=this,t=O(function(){o.wRt(),o.ki(d.Events.ChangesSubmitting,m),o._dataSource.submitChanges(function(t,n,i){r?r(t,n,i):o.ki(d.Events.ChangesSubmittedRowFailed,{index:t,reason:n,type:i})},function(t,n,i){e?e(t,n,i):o.ki(d.Events.ChangesSubmittedColumnFailed,{name:t,reason:n,type:i})}).then(function(t){o.ki(d.Events.ChangesSubmitted,t),n(t)}).catch(function(t){i(t)})}),u=t.suspend(),s=u.succeed,u=u.fail;this.TRt(s,u),t.execute()},E.prototype.TRt=function(t,n){var t,i,r,e,o,u,s,u,u,c,u,t=O(t,n),i=t.suspend,r=this,e=r.Pq;for(r.WOt++,o=0;o<e.length;o++)s=(u=e[o]).targetTable,u=u.LOt,s&&u&&!s.WOt&&(c=(u=i()).succeed,u=u.fail,s.submitChanges(m,c,u));t.execute(function(){return r.WOt--})},E.prototype.ZBe=function(){return this._dataSource.getColumnChanges()},E.prototype.QBe=function(){var t=this;t.WBe(this.ZBe(),t.TBe.bind(t),t.kBe.bind(t),t.IBe.bind(t))},E.prototype.WBe=function(t,n,i,r){var e,o,u;if((0,b.isArray)(t))for(e=0,o=t;e<o.length;e++)switch((u=o[e]).type){case s.ADD_COLUMN:n(u);break;case s.UPDATE_COLUMN:i(u);break;case s.REMOVE_COLUMN:r(u)}},E.prototype.cancelChanges=function(n,t){var i,r,e,i=this,r=(this.ZBe()||[]).some(function(t){return"addColumn"===t.type||"removeColumn"===t.type}),e=O(function(){var t={isDataLengthChanged:i.isDataLengthChanged(),isColumnCountChanged:r};i.ki(d.Events.ChangesCancelling,m),i.QBe(),i._dataSource.cancelChanges(),i.dl(),i.Jhe(),i.wRt(),i.ARt(),i.ki(d.Events.ChangesCancelled,t),n&&n(m)});this.IRt(e.suspend),e.execute()},E.prototype.IRt=function(t){var n,i,r,e,o,e,e,u,e,n=this,i=n.Pq;for(n.WOt++,r=0;r<i.length;r++)o=(e=i[r]).targetTable,e=e.LOt,o&&e&&!o.WOt&&(u=(e=t()).succeed,e=e.fail,o.cancelChanges(u,e));n.WOt--},E.prototype.xRt=function(t,n){var i=t instanceof v.CalcField;return(i=i&&this._dataSource.gCe(n)?!1:i)||t instanceof f.HierarchyField||t instanceof a.TriggerCalcField},E.prototype.NRt=function(){var t,i,n,r,e,o,t=this.options.schema.hierarchy.column,i=[new RegExp("(\\[@)(".concat(t,")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)"))];for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(r=this.XOt[n])instanceof f.HierarchyField&&(r.C8(),i.push(new RegExp("(\\[@)(".concat(r.GOt,")\\]"))));for(n in e=function(t){var n;Object.prototype.hasOwnProperty.call(o.XOt,t)&&(n=o.XOt[t])instanceof v.CalcField&&i.some(function(t){return t.test(n.GOt)})&&n.C8()},(o=this).XOt)e(n)},E.prototype.FOt=function(t){var n,i;for(n in this.XOt)Object.prototype.hasOwnProperty.call(this.XOt,n)&&(i=this.XOt[n],this.xRt(i)?i.C8(t):this.XOt[n]=m)},E.prototype.removeCalcCache=function(t){this.XOt[t]=m},E.prototype.dl=function(t,n){var i,r,e;if(t){for(i=this.XOt[t],this.xRt(i,t)?i.C8():this.XOt[t]=m,r=0;r<this.Pq.length;r++)if(t===(e=this.Pq[r]).name||t===e.sourceField||n&&t===e.targetField)return void(e.LOt&&e.CRt.dl(this))}else for(this.FOt(),r=0;r<this.Pq.length;r++)(e=this.Pq[r]).CRt&&e.CRt.dl(this)},E.prototype.primaryKey=function(t){var t,n,i,r,e,o,u,s,c,f;if(0===arguments.length)return this.qOt||(this.Ljt(),this.createIndexes(this.qOt)),this.qOt.join(",");if(!(0,b.isNullOrUndefined)(t)&&(this.qOt=(this.qOt||[]).concat(t.split(",")),t=this._dataSource.options.schema,!(0,b.isNullOrUndefined)(t))){for(r in i=[],n=t.columns=t.columns||{})Object.prototype.hasOwnProperty.call(n,r)&&(e=n[r]).isPrimaryKey&&i.push(r);if(0===i.length)this.qOt.forEach(function(t){""===t||(0,b.isNullOrUndefined)(t)||(n[t]=n[t]||{},n[t].isPrimaryKey=!0)});else{for(o=0;o<i.length;o++)u=i[o],this.columns&&this.columns[u]&&(this.columns[u].isPrimaryKey=!0);for(s=this.qOt.slice().sort(),i.sort(),c=i,f=0;f<s.length||f<c.length;f++)if(s[f]!==c[f])return void(this.qOt=c)}}},E.prototype.getIndexes=function(){return(0,b.keys)(this.YOt)},E.prototype.kRt=function(){return(0,b.keys)(this.ZOt)},E.prototype.createIndexes=function(t){for(var n,i,r,e,n=this.YOt,i=0,r=t;i<r.length;i++)n[e=r[i]]||(n[e]=this.DRt(e))},E.prototype.eRt=function(t,n){for(var i,r,e,o,i=this.ZOt,r=0,e=t;r<e.length;r++)i[o=e[r]]&&!n||(i[o]=this._Rt(o))},E.prototype.dropIndexes=function(t){for(var n,i,r,e,n=this.YOt,i=0,r=t;i<r.length;i++)n[e=r[i]]&&delete n[e]},E.prototype.clearIndexes=function(){this.YOt={}},E.prototype.oRt=function(t,n){var i=this.YOt;(0,b.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},E.prototype.zBe=function(t){this.ORt(t)&&this.dropIndexes([t])},E.prototype.ARt=function(t){t?delete this.ZOt[t]:this.ZOt={}},E.prototype.aRt=function(t,n){var i=this.ZOt;(0,b.isNullOrUndefined)(i[t])||(i[n]=i[t],delete i[t])},E.prototype.wRt=function(){var t=this.getIndexes();this.clearIndexes(),this.createIndexes(t)},E.prototype.ERt=function(){var t=this.kRt();this.ARt(),this.eRt(t)},E.prototype.DRt=function(t){for(var n,i,r,e,o,i=this.length(),r=0;r<i;r++)(n=n||{})[o="string"!=typeof(o=(e=this.get(r))[t])?String(o):o]||(n[o]=[]),n[o]&&n[o].push(r);return n},E.prototype._Rt=function(n){var i=this;return F(n,this.length(),this.jRt(n),function(t){return i._getValueByField(n,t)})},E.prototype.ORt=function(t){return!!this.YOt[t]},E.prototype.search=function(t,n){if(!(0,b.isNullOrUndefined)(t)&&!(0,b.isNullOrUndefined)(n))return(0,b.isString)(t)||(t=String(t)),this.ORt(n)?this.RRt(t,n):this.BRt(t,n)},E.prototype.mEt=function(t){var i,n,r,e,o,u,i=this.primaryKey().split(",");if(0===i.length||!this.YOt[i[0]])return[];if(1===i.length)return this.YOt[i[0]][t];if((t=t.split("|")).length!==i.length)return[];for(n=0;n<t.length;n++)t[n]=t[n].trim();for(r={},e={},this.YOt[i[0]][t[0]].forEach(function(t){r[t]=1}),o=function(n){u.YOt[i[n]]&&u.YOt[i[n]][t[n]].forEach(function(t){r[t]===n&&(e[t]=n)}),r=e,e={}},u=this,n=1;n<t.length;n++)o(n);return Object.keys(r)},E.prototype.kEt=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,v,p,w;if(i){for(r={},e=0;e<n.length;e++)o=n[e],u=this._dataSource._data[o],r[o]=u&&u.data[t];for(c=0,f=s=this.QOt.relationships;c<f.length;c++)if((a=f[c]).sourceTable===this&&a.targetTable!==this){for(h={},l=a.sourceRelationshipName+".",p=d=(v=0,b.keys)(a.targetTable.columns);v<p.length;v++)h[w=p[v]]=a.sourceTable._getValueByField(l+w,t);r[a.sourceRelationshipName]=h}}else for(r=[],e=0;e<n.length;e++)r.push(this.rRt(n[e]).getValue(t));return r},E.prototype.ASt=function(t,n,i,r){for(var e,o,u,s,e=[],o=this.length(),u=0;u<o;u++)s=n&&this.rRt(n).getValue(u),n!==w&&s!==t&&String(s)!==t||e.push(this.kEt(u,i||this._dataSource.DEt,r));return e},E.prototype.BRt=function(t,n){for(var i,r,e,o,u,i=[],r=this.length(),e=0;e<r;e++)(u=(o=this.get(e))[n])!==t&&String(u)!==t||i.push(o);return i},E.prototype.RRt=function(t,n){var i,r,n,e,o,u,s,i,r,n=this.YOt[n][t],e=[];if(n)for(o=0,u=n;o<u.length;o++)s=u[o],e.push(this.get(s));return e},E.prototype.sRt=function(t,n){var i,r,e,o,i=this.YOt;for(r in i)i.hasOwnProperty(r)&&(e=i[r])&&(e[o=n[r]]?e[o].push(t):e[o]=[t])},E.prototype.cRt=function(t,n){var i=this._dataSource.options.schema;I(this.ZOt,t,n,i&&i.columns)},E.prototype.lRt=function(t,n,i){var r,e,o,u,r=this.YOt;for(e in r)r.hasOwnProperty(e)&&(o=r[e])&&i!==n&&((u=o[n])&&1<u.length?u.splice(u.indexOf(t),1):delete o[n],o[i]?o[i].push(t):o[i]=[t])},E.prototype.hRt=function(t,n,i,r){N(this.ZOt,t,n,i,r,this.jRt(n))},E.prototype.cge=function(){var t,n,i,t=[];if(this.ZOt)for(i in n=this.ZOt)this.Pbe(i)&&t.push(i);return t},E.prototype.bCe=function(){var t=this.cge();t&&0<t.length&&this.eRt(t,!0)},E.prototype.wCe=function(t){var n,n;return!!(0,b.isFormula)(t)||"formula"===(null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.dataType)||this._dataSource.gCe(t)},E.prototype.EJe=function(t,n){return this.wHe(this.awe(t),function(t){return t===n})},E.prototype.sge=function(t,n){var i,r,e,i=[];if(this.ZOt)for(e in r=this.ZOt)this.wCe(e)&&(n===m||this.EJe(e,n)&&!this.Pbe(e))&&i.push({field:e,originValue:this._getValueByField(e,t)});return i},E.prototype.uge=function(t,n){var i,r,e;if(n&&0<n.length)for(i=0;i<n.length;i++)r=n[i].field,e=n[i].originValue,this.hRt(t,r,e,this._getValueByField(r,t))},E.prototype.MRt=function(t,n){M(this.ZOt,t,n)},E.prototype.LRt=function(t,n){var i,r,e,o,i=this.ZOt,r=i&&i[t];if(r)for(e in r)if(r.hasOwnProperty(e)&&(o=r[e],(0,b.isArray)(o))&&o.some(function(t){return t===n}))return e},E.prototype.jOt=function(t){return 0<=this.Ljt().indexOf(t)},E.prototype.OOt=function(){return 1<this.Ljt().length},E.prototype.EOt=function(){return 0<this.Ljt().length},E.prototype.Ljt=function(t){var t,n,i,r,e,o,u,s;if(!this.qOt||t)if(t=this._dataSource.options.schema,(0,b.isNullOrUndefined)(t)||(0,b.isNullOrUndefined)(t.columns)||0===Object.keys(t.columns).length)for(n in this.qOt=[],this.columns)this.columns[n].isPrimaryKey&&this.qOt.push(n);else{for(n in r=[],i=t.columns=t.columns||{})i.hasOwnProperty(n)&&(e=i[n]).isPrimaryKey&&r.push(n);for(this.qOt||(this.qOt=[]),o=this.qOt.slice().sort(),r.sort(),u=r,s=0;s<o.length||s<u.length;s++)if(o[s]!==u[s]){this.qOt=u;break}}return this.qOt},E.prototype.defaultView=function(){var r=this;return r.FRt?Promise.resolve(r.FRt):new Promise(function(i,t){r.fetch().then(function(t){var n,n,n,n=r.get(0),n=(0,b.keys)(n),n=r.addView(c.DEFAULT_VIEW_NAME,n);r.FRt=n,i(n)})})},E.prototype.addView=function(t,n,i,r){var n=new o.View(t,n,i,r);return(this.views[t]=n).PRt(this),n},E.prototype.GRt=function(t,n){var n=new o.View(t,n);return n.PRt(this),this.QOt.rV[t]=n},E.prototype.removeView=function(t){var n=this.views;n[t].PRt(w),delete n[t],this.URt(t)},E.prototype.URt=function(t){var n,i,r,n=this.QOt.tables;for(i in n)n.hasOwnProperty(i)&&(r=n[i]).VOt[t]&&(r.VOt[t].$Ot(r),delete r.VOt[t])},E.prototype.HRt=function(t){return this.views[t]},E.prototype.zRt=function(t){for(var n,i,r,n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name===t)return r;return null},E.prototype.Ole=function(t){for(var n,i,r,n=0,i=this.Pq;n<i.length;n++)if((r=i[n]).name.toUpperCase()===t.toUpperCase())return{field:r,fieldName:r.name};return null},E.prototype.VRt=function(t){var n,i,r,n=this.getDataSync(t),i=[];if(t)for(r=0;r<t.length;r++)i.push(n[t[r]]);else for(r=0;r<n.length;r++)i.push(n[r]);return i},E.prototype.vRt=function(t){return this.VRt([t])[0]},E.prototype.gRt=function(t){return this._dataSource.lOt(t)},E.prototype.YRt=function(t,n){for(var i,r,i=[],r=0;r<n.length;r++)i.push(this._getValueByField(t,n[r]));return i},E.prototype.twe=function(t,n){var i=this.XOt[t];return i&&i instanceof a.TriggerCalcField||(this.XOt[t]=i=new a.TriggerCalcField(t,n,this)),i},E.prototype.bEt=function(t){var n;return this.XOt[t]||!this.CEt()||(0,b.isNullOrEmpty)(this._dataSource.l7t(t))||(this.XOt[t]=new f.HierarchyField(t,this)),this.XOt[t]||"="!==t[0]||this.Xhe(t),this.XOt[t]||("="===(null==(n=this.awe(t))?void 0:n[0])?(this.Xhe(n),this.XOt[t]=new v.CalcField(n,this)):"="===t[0]?this.XOt[t]=new v.CalcField(t,this):this.XOt[t]=new p.TableField(t,this)),this.XOt[t]},E.prototype.Gbe=function(t){return(0,b.isNullOrEmpty)(t)||!(0,b.isString)(t)?[]:(0,j.addWindowOverFormulas)(this.POt,this.awe(t))},E.prototype.awe=function(t){var n,n,n,n;return(0,b.isFormula)(t)?t:(n=null==(n=null==(n=this.columns)?void 0:n[t])?void 0:n.value,(0,b.isFormula)(n)?n:(n=this._dataSource.Ebe(t))&&!(0,b.isFormula)(n)?"="+n:n)},E.prototype.wHe=function(t,n){var i,r,t;return!((0,b.isNullOrEmpty)(t)||!(0,b.isString)(t))&&((i=this.POt.getCalcService()).dCe=i.dCe||{},i.dCe.hasOwnProperty(t)?!(i.Wbe=!0):(i.dCe[t]=!0,r=this.Ywt(t),delete i.dCe[t],t=i.Wbe,0===Object.keys(i.dCe).length&&(delete i.dCe,delete i.Wbe),!t&&this.yHe(r,n)))},E.prototype.yHe=function(t,n){var i,r,e,o,u,u,s,c,f,a;if(!(0,b.isNullOrUndefined)(t))if(t.function){for(r=0,e=t.arguments;r<e.length;r++)if(o=e[r],i=this.yHe(o,n))return!0}else if(14===t.type){if(t.value&&!t.value.field.inCircular)return!!(i=n(u=t.value.field.GOt||t.value.Pq.join(".")))||!(!(u=this.awe(u))||(t.value.field.inCircular=!0,i=this.wHe(u,n),delete t.value.field.inCircular,!i))||void 0}else for(s=0,c=Object.keys(t);s<c.length;s++)if((a=t[f=c[s]])instanceof h.Expression&&(i=this.yHe(t[f],n)))return!0},E.prototype.Pbe=function(t){return!(0,b.isNullOrEmpty)(t)&&("object"==typeof t&&"string"==typeof t.aggregate||0<this.Gbe(t).length)},E.prototype.nwe=function(t,n){var i=this.XOt[t];return i&&i instanceof v.CalcField||(this.XOt[t]=i=new v.CalcField(n||t,this)),i},E.prototype.Cve=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,n=this.XOt;if(t.D5?i=t.D5:(i="="!==(i=this.wde(t))[0]?"="+i:i,t.D5=i),o=(e=i).indexOf("=[@"),u=i.lastIndexOf("]"),s=0===o&&u===i.length-1){for(h=a=!1,l=c=o+3,d=f=u-1;l<d&&("["!==i[l]&&c===o+3&&(a=!0,o=l),"]"!==i[d]&&f==u-1&&(h=!0,u=d),!a||!h);l++,d--);e=i.slice(o,u+1)}return r=n[e],(0,b.isNullOrUndefined)(r)&&(r=n[e]=s?new p.TableField(e,this):new v.CalcField(e,this,t)),s?function(t){return r.getValue(t)}:function(t){return r.getValueWithContext(t)}},E.prototype.MHe=function(t,n){var i,r;return(0,j.isWindowOverFormula)(t)&&(t=(i=(0,j.deconstructWindowOverFunction)(this,t)).formulaFromWindowChaining||i.windowOverFormula),r={},(n=n||[]).forEach(function(t){r[t]=!0}),this.wHe(t,function(t){(0,b.isString)(t)&&(0,b.isRelation)(t)&&!r[t]&&(n.push(t),r[t]=!0)}),n},E.prototype.uwe=function(t,n){var i,r,e,o,o,i=this;if(!(0,b.isNullOrEmpty)(t)&&!(0,b.isNullOrUndefined)(n)&&0!==n.length)for(r=1===n.length&&(0,j.isWindowOverFormula)(t),e=0;e<n.length;e++)o=n[e],o=(0,j.deconstructWindowOverFunction)(i,o),r&&(o.originalWindowOverFormula=t),i.qhe(o.windowOverFormula,o)},E.prototype.Xhe=function(t){var n,i,n=this;return!this.XOt[t]&&0<(i=n.Gbe(t)).length&&(n.uwe(n.awe(t),i),!0)},E.prototype.qhe=function(t,n){var i,r,e,o,u,s,c;if(!(this.XOt[t]&&this.XOt[t]instanceof j.WindowOverCalcField)){if(i=n.partitions,r=n.orders,(0,b.isArray)(i))for(e=0;e<i.length;e++)o=i[e],this.columns[o.field]||this.rRt(o.field);if((0,b.isArray)(r))for(e=0;e<r.length;e++)u=r[e],this.columns[u.field]||this.rRt(u.field);s=n.formulaFromWindowChaining||t,c=this.XOt[s],(0,b.isNullOrUndefined)(c)&&(c=new j.WindowOverCalcField(s,this,n)),this.XOt[s]=c,this.XOt[t]=c,(0,b.isNullOrUndefined)(n.originalWindowOverFormula)||(this.XOt[n.originalWindowOverFormula]=c)}return this.XOt[t]},E.prototype.pCe=function(t,n){for(var i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,i=Object.keys(t),r=Object.keys(n),e=[],o=0,u=i.concat(r);o<u.length;o++)if(s=u[o],!n.hasOwnProperty(s)||t[s]!==n[s])for(f=0,a=c=Object.keys(this.XOt);f<a.length;f++)if(h=a[f],(l=this.XOt[h])instanceof j.WindowOverCalcField&&l.options.windowDefineName===s&&-1<h.indexOf('"'.concat(s,'"'))){for(delete this.XOt[h],d=0,v=Object.keys(this.XOt);d<v.length;d++)p=v[d],this.XOt[p]===l&&delete this.XOt[p];e.push(h)}for(w=0,b=e;w<b.length;w++)this.Xhe(m=b[w])},E.prototype.Jhe=function(){this.$he(!0)&&this.bCe()},E.prototype.$he=function(t){},E.prototype.fme=function(){return 1===Object.keys(this.views).length},E.prototype.ZRt=function(t){try{this.rRt(t)}catch(t){}var t=this.XOt[t];return t&&t.setValue},E.prototype.WRt=function(t,n,i){this.rRt(t);var r=this.XOt[t];return this.o_t(t),r&&r.setValue&&r.setValue(n,i)},E.prototype.QRt=function(t,n,i,r,e){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.setItemValue&&o.setItemValue(n,i,r,e)},E.prototype.KRt=function(t,n){this.rRt(t);var t=this.XOt[t];return t&&t.hasItem&&t.hasItem(n)},E.prototype.JRt=function(t,n,i,r,e){this.rRt(t);var o=this.XOt[t];return this.o_t(t),o&&o.insertItem&&o.insertItem(n,i,r,e)},E.prototype._getValueByField=function(t,n,i){return this.rRt(t),this.XOt[t].getValue(n,i)},E.prototype.XRt=function(t,n){return this.rRt(t),this.XOt[t].getOriginalValue(n)},E.prototype.swe=function(t,n){return this.rRt(t),this.XOt[t].getRelatedModelIndex(n)},E.prototype.qRt=function(t){return this.rRt(t),this.XOt[t].getRelatedTable()},E.prototype.$Rt=function(t){return this.rRt(t),this.XOt[t].getRelationMaps()},E.prototype.tBt=function(t){for(var n,i,r,e,o,u,n=this,i,r,e=0,o=n.QOt.relationships;e<o.length;e++){if((u=o[e]).sourceTable===n&&u.sourceFieldName===t)return u.targetTable;if(u.targetTable===n&&u.targetFieldName===t)return u.sourceTable}},E.prototype.nBt=function(t,n){return this.rRt(t),this.XOt[t].getHostTableIndexes(n)},E.prototype.rRt=function(t){return this.XOt[t]||this.bEt(t),this.XOt[t]},E.prototype.xOt=function(t,n,i,r,e){var n={name:n,sourceField:t,targetTable:i,targetField:r,CRt:e};return this.Pq.push(n),n},E.prototype.kOt=function(t){for(var n=this.Pq.length-1;0<=n;n--)this.Pq[n].CRt===t&&this.Pq.splice(n,1)},E.prototype.eBt=function(t){for(var n,i,r,e,n=[this],i=this.Pq,r=0;r<i.length;r++)(e=i[r].targetTable)&&-1===n.indexOf(e)&&n.push(e);return t?n.slice(1):n},E.prototype.JBe=function(){for(var t,n,i,r,e,t=[],n=[],i=this.Pq,r=0;r<i.length;r++)(e=i[r].targetTable)&&-1===n.indexOf(e)?(n.push(e),(0,b.isNullOrUndefined)(i[r].type)&&this.rRt(i[r].name),t.push({field:i[r].name,tableName:e.name,isMany:"array"===i[r].type,isTable:!0})):t.push({field:i[r].name});return t},E.prototype.KBe=function(t,n){var t,i,i=this;return t?(null==(t=i.qRt(t))?void 0:t.KBe(w,!0))||[]:i.JBe().filter(function(t){return n||t.isTable}).map(function(t){return{table:t.field,tableName:t.tableName,isTable:t.isTable,isMany:t.isMany}})},E.prototype.XBe=function(t){var n,t,n,t,n=this,t=(0,b.isString)(t)?t:t.value;return n.isDataColumn(t)?n.rBt(t):(0,b.isRelation)(t)&&(n=n.qRt(t),t=t.split(".").pop(),n)&&n.columns&&n.columns[t]?n.rBt(t):void 0},E.prototype.iBt=function(n){var i,t,r,i=this,t=i.Pq,r={};return t.forEach(function(t){var t=t.name;r[t]=i._getValueByField(t,n)}),r},E.prototype.ltt=function(){return this.Pq},E.prototype.rBt=function(t){var t=this.jRt(t);return t&&t.dataType},E.prototype.jRt=function(t){var n,i,r,n=this,i=n._dataSource.options.schema;return i&&i.columns&&i.columns[t]?r=i.columns[t]:(0,b.isNullOrUndefined)(n.columns)||(r=n.columns[t]),r},E.prototype.oBt=function(t){var n,i,t;return 0===t.length?[]:((t=(i=(n=this).zRt(t[0]))&&i.targetTable?i.targetTable.oBt(t.slice(1)):[]).unshift(i),t.filter(function(t){return!(0,b.isNullOrUndefined)(t)}))},E.prototype.Ix=function(){var t,n,i,r,t=[],n={},i=this.name;return n[i]||(t.push(i),n[i]=!0),(r=this.QOt)&&this.qBe(r,i,t,n),t},E.prototype.qBe=function(t,n,i,r){for(var e,o,u,s,c,s,e,o=0,u=t.relationships;o<u.length;o++)c=(s=u[o]).sourceTable.name,s=s.targetTable.name,c===n&&s!==n?r[s]||(i.push(s),r[s]=!0,this.qBe(t,s,i,r)):s!==n||c===n||r[c]||(i.push(c),r[c]=!0,this.qBe(t,c,i,r))},E.prototype.toJSON=function(){var t,n,i,t=this.views,n=[];for(i in t)t.hasOwnProperty(i)&&n.push(t[i].toJSON());return{name:this.name,dataSourceOption:x(this._dataSource.options),primaryKey:this.primaryKey(),views:n,columns:this.aBt(this.columns),notFetchAfterLoad:this.Nx}},E.prototype.fromJSON=function(t){for(var i,t,n,r,e,o,u,i=this,n,r=0,e=t.views;r<e.length;r++)o=e[r],(u=this.addView(o.name,o.columns,!1,o.options)).fromJSON(o);return this.columns=t.columns,this.columns&&Object.keys(this.columns).forEach(function(t){var n;"="===t[0]&&i.columns[t]&&i.columns[t].value===t&&i.columns[t].caption&&"="!==i.columns[t].caption[0]&&(n=i.columns[t].caption,i.columns[n]=i.columns[t],delete i.columns[t])}),this.primaryKey(t.primaryKey),t.notFetchAfterLoad||null!=(t=this.options)&&t.remote&&!this.options.remote.read?Promise.resolve(null):this.fetch()},E.prototype.bind=function(t,n){this._dataSource.bind(t,n)},E.prototype.unbind=function(t,n){this._dataSource.unbind(t,n)},E.prototype.ki=function(t,n){return this._dataSource.ki(t,n)},E.prototype.vOt=function(t){return this._dataSource.vOt(t)},E.prototype.aBt=function(t){var n,i;for(n in t)t.hasOwnProperty(n)&&!(0,b.isNullOrUndefined)(t[n])&&((i=t[n]).W5=i.dataType);return t},E.prototype.z7t=function(t,n,i){return this._dataSource.z7t(t,n,i)},E.prototype.V7t=function(t){return this._dataSource.V7t(t)},E.prototype.d7t=function(t,n,i){return this._dataSource.d7t(t,n,i)},E.prototype.uBt=function(){return this._dataSource.$jt()},E.prototype.qX=function(){return this._dataSource.qX()},E.prototype.m7t=function(t,n,i,r){return this.CEt()&&this.NRt(),this._dataSource.m7t(t,n,i,r)},E.prototype.ABe=function(t,n){return this._dataSource.ABe(t,n)},E.prototype.CEt=function(){return this._dataSource.isHierarchy()},E.prototype.isHierarchy=function(){return this.CEt()},E.prototype.getHierarchyType=function(){return this._dataSource.Fjt()},E.prototype.isHierarchyOptionChanged=function(){return this._dataSource.a7t()},E.prototype.setHierarchyOptionChanged=function(){this._dataSource.u7t()},E.prototype.rebuildHierarchyStructure=function(){return this._dataSource.load({reload:!0})},E.prototype.SEt=function(t){return this._dataSource.SEt(t)},E.prototype.f7t=function(){return this._dataSource.f7t()},E.prototype.getHierarchyRootNode=function(){return this.f7t()},E.prototype.M7t=function(t){this._dataSource.M7t(t),this.NRt()},E.prototype.S7t=function(t,n){this._dataSource.S7t(t,n),this.NRt()},E.prototype.O7t=function(t,n,i){return this._dataSource.O7t(t,n,i)},E.prototype.L7t=function(t,n,i){return this._dataSource.L7t(t,n,i)},E.prototype.F7t=function(t,n){return this._dataSource.F7t(t,n)},E.prototype.G7t=function(t,n){return this._dataSource.G7t(t,n)},E.prototype.Xme=function(t,n){return this._dataSource.Xme(t,n)},E.prototype.H7t=function(t){return this._dataSource.H7t(t)},E.prototype.h7t=function(t,n){return this._dataSource.h7t(t,n)},E.prototype.OBe=function(t){return this._dataSource.OBe(t)},E.prototype.tBe=function(t){this._dataSource.tBe(t)},E.prototype.$Fe=function(){return this._dataSource.$Fe()},E.prototype.I7t=function(t){this._dataSource.I7t(t)},E.prototype.X7t=function(){return this._dataSource.X7t()},E.prototype.KFe=function(t){return this._dataSource.KFe(t)},E.prototype.XFe=function(t,n){this._dataSource.XFe(t,n)},E.prototype.isColumnSpreadChanged=function(){return this._dataSource.Cue()},E.prototype.setColumnSpreadChanged=function(t){this._dataSource.Sue(t)},n.Table=i=E,r(T,_=i),T.prototype.getDataSync=function(t){var n,i,r,e,n=[];if(t)for(i=0;i<t.length;i++)n.push(this._dataSource.Fbe(t[i]));else for(r=0,e=this._dataSource.length();r<e;r++)n.push(this._dataSource.Fbe(r));return n},y=T},"./dist/src/table/tableEvents.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.Events=void 0,r.ItemInserting="ItemInserting",r.ItemInserted="ItemInserted",r.ItemUpdating="ItemUpdating",r.ItemUpdated="ItemUpdated",r.ItemResetting="ItemResetting",r.ItemReset="ItemReset",r.ItemSaving="ItemSaving",r.ItemSaved="ItemSaved",r.ItemRemoving="ItemRemoving",r.ItemRemoved="ItemRemoved",r.ChangesSubmitting="ChangesSubmitting",r.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",r.ChangesSubmittedColumnFailed="ChangesSubmittedColumnFailed",r.ChangesSubmitted="ChangesSubmitted",r.ChangesCancelling="ChangesCancelling",r.ChangesCancelled="ChangesCancelled",n.Events=r},"./dist/src/table/tableField.js":function(t,n,i){"use strict";var f,c,a,r;function h(u,s,c){return function(t,n,i,r){var e=u.map[t],o=e;return(0,f.isNullOrUndefined)(o)&&(e=u.map[t]=[]),n[s.targetField]=c._getValueByField(s.sourceField,t),u.relatedTable.JRt(u.subField,void 0,n,function(t){e.push(t.index),t.index=e.length-1,i&&i(t)},r)}}function e(t,u){var e,s,o,t,t,e=this;this.Oit=[],s="string"==typeof t?t.split("."):t,!(o=s[0]&&u.zRt(s[0]))&&s[0]&&(t=u.Ole(s[0]))&&(o=t.field,s[0]=t.fieldName),o&&o.targetTable?(this.relatedTable=o.targetTable,this.map=o.LOt,this.setValue=null,this.map||(o.CRt.BOt(),this.map=o.LOt),this.getRelationMaps=function(){var t=[{name:o.name,relationshipMap:o.CRt.DOt(o.name)}];if(this.relatedTable)return this.subField?t.concat(this.relatedTable.$Rt(this.subField)):t},this.getHostTableIndexes=function(t){var n,i,t,i,r,n=[t];return this.relatedTable?(this.subField&&(n=this.relatedTable.nBt(this.subField,t)),t=void 0,t=(i=o.CRt).targetTable===this.relatedTable?i.targetRelationshipName:i.sourceRelationshipName,i=this.relatedTable.zRt(t),r=i.LOt,n.reduce(function(t,n){return t.concat(r[n])},[])):n},this.getRelatedModelIndex=function(t){var t=this.map[t];if(!(0,f.isNullOrUndefined)(t))return this.relatedTable.swe(this.subField,t[0])},"object"===o.type?1===s.length?(this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.vRt(t[0])},this.setValue=function(t){var n=t[s[0]];return t[o.sourceField]=n?n[o.targetField]:null,t}):(this.subField=s.slice(1).join("."),this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable._getValueByField(e.subField,t[0],!0)},this.getOriginalValue=function(t){var t=this.map[t];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t[0])},this.setItemValue=function(t,n,i,r){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.QRt(e.subField,t[0],n,i,r)},this.hasItem=function(t){var t=e.map[t];return!(0,f.isNullOrUndefined)(t)&&e.relatedTable.KRt(e.subField,t[0])},this.insertItem=h(this,o,u)):1===s.length?this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?[]:e.relatedTable.VRt(t)}:(t=s[1]-1,isNaN(t)?(this.subField=s.slice(1).join("."),this.getValue=function(t){var t=e.map[t];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.YRt(e.subField,t)},this.getOriginalValue=function(t){var t=this.map[t];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t)},this.hasItem=function(t){var t=e.map[t];return t&&0<t.length},this.insertItem=h(this,o,u)):2===s.length?(this.arrayFieldIndex=s[1]-1,this.getValue=function(t){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable.vRt(t)}):(this.arrayFieldIndex=t,this.subField=s.slice(2).join("."),this.getValue=function(t){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:e.relatedTable._getValueByField(e.subField,t)},this.getOriginalValue=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];return(0,f.isNullOrUndefined)(t)?c:this.relatedTable.XRt(this.subField,t)},this.setItemValue=function(t,n,i,r){var t,t,t=e.map[t],t=t&&t[e.arrayFieldIndex];if(!(0,f.isNullOrUndefined)(t))return e.relatedTable.QRt(e.subField,t,n,i,r)},this.getRelatedModelIndex=function(t){var t,t,t=this.map[t],t=t&&t[this.arrayFieldIndex];if(!(0,f.isNullOrUndefined)(t))return this.relatedTable.swe(this.subField,t)}))):(0===s.length?this.getValue=function(t){return u._dataSource.get(t)}:1===s.length?(this.getValue=function(t){return u._dataSource.getFieldValue(s[0],t)},this.getOriginalValue=function(t){return u._dataSource.getFieldOriginalValue(s[0],t)},this.getRelatedTable=function(){return u},this.setItemValue=function(t,n,i,r){return u.updateItemValue(t,s[0],n,i,r)},this.hasItem=function(t){return u._dataSource.length()>t},this.insertItem=function(t,n,i,r){var e=(0,f.isNullOrUndefined)(t)?u.length():t;return u.insertItem(e,n,function(t){t.index=e,i&&i(t)},r)},this.setFieldValue=function(t,n,i){var t;u._dataSource.updateItemValues(t,((t={})[n]=i,t))}):(this.getValue=function(t){for(var n,i,n=u._dataSource.getFieldValue(s[0],t),i=1;n&&i<s.length;i++)n=(0,f.isArray)(n)?n[s[i]-1]:n[s[i]];return n},this.setItemValue=function(t,n,i,r){var e,o,o,o=u._getValueByField(s[0],t);if(!(0,f.isNullOrUndefined)(o))return o=(0,f.clone)(o,!0),this.setValue(((e={})[s[0]]=o,e),n),u.updateItemValue(t,s[0],o,i,r)}),this.setValue=function(t,n){for(var i,r,e,o,i=t,r=t,e=s.length,o=0;r&&o<e;o++)i=(0,f.isArray)(r)?r[s[o]-1]:r[s[o]],o!==e-1&&(r=i);return r!==i&&(i!==n||(0,f.isNullOrUndefined)(i)&&(0,f.isNullOrUndefined)(n))&&(r[s[e-1]]=n),t})}Object.defineProperty(n,"__esModule",{value:!0}),n.TableField=void 0,f=i("./dist/src/dataSource/utils.js"),c=null,a=void 0,e.prototype.getValue=function(t){return null},e.prototype.getValues=function(t,n,i,r,e,o){var u,s,i;if(n=(0,f.isNumber)(n)?n:0,i=(0,f.isNumber)(i)?i:t.length-1,(u=this.Oit).length!==t.length||this._me!==t)for(this._me=t,this.Oit=u=[],s=u.length;s<t.length;s++)u.push(this.getValue(t[s]));return i=u.slice(n,i+1),r!==a&&e!==a&&(o!==a?i.splice(r-n,e-r+1,i[o-n]):i.splice(r-n,e-r+1)),i},e.prototype.setValue=function(t,n){return null},e.prototype.setItemValue=function(t,n,i,r){},e.prototype.setFieldValue=function(t,n,i){},e.prototype.hasItem=function(t){},e.prototype.insertItem=function(t,n){},e.prototype.getOriginalValue=function(t){return null},e.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.qRt(this.subField):this.relatedTable},e.prototype.getRelationMaps=function(){return[]},e.prototype.getHostTableIndexes=function(t){return[t]},e.prototype.getRelatedModelIndex=function(t){return t},n.TableField=e},"./dist/src/table/triggerCalcField.js":function(t,n,i){"use strict";var e,o,u,s,c,f,r;function a(t,n,i){var r,n,t;this.GOt=t,this.nM=i,this.HOt=new f.TableField(t,i),r="=[@".concat(t,"]"),n?(this.MU=n,this.cwe=n.when===u.TriggerWhenType.onNewAndUpdate,this.cwe&&(this.fwe=l(n),this.lwe=-1<n.fields.indexOf("*"),this.hwe=this.lwe||-1<this.fwe.indexOf(t)),r=n.formula,n=["[@".concat(t,"]"),"[@[".concat(t,"]]")],(-1<r.indexOf(n[0])||-1<r.indexOf(n[1]))&&(this.dwe=!0),this.dwe&&(t="".concat(o.TRIGGERFIELDVALUE,'("').concat(t,'", ').concat(this.hwe?0:1,")"),this.vwe=h(h(r,n[0],t),n[1],t),this.mwe=new c.CalcField(this.vwe,this.nM,void 0,e.Errors.Calc))):this.gwe=!0,this.UOt=new c.CalcField(r,i,void 0,e.Errors.Calc)}function h(t,n,i){return t.split(n).join(i)}function l(t){return t.fields.split(",").reduce(function(t,n){return n=n.trim(),(0,s.isNullOrEmpty)(n)||t.push(n),t},[])}Object.defineProperty(n,"__esModule",{value:!0}),n.getWatchedFields=n.TriggerCalcField=void 0,e=i("CalcEngine"),o=i("./dist/src/calculation/functions/triggerFieldValue.js"),u=i("./dist/src/dataSource/dataSource.interface.js"),s=i("./dist/src/dataSource/utils.js"),c=i("./dist/src/table/calcField.js"),f=i("./dist/src/table/tableField.js"),a.prototype.getKey=function(){return this.UOt.getKey()},a.prototype.vyt=function(){this.UOt.vyt()},a.prototype.c_t=function(){return this.UOt.c_t()},a.prototype.P6t=function(){this.C8()},a.prototype.C8=function(){this.UOt.C8(),this.mwe&&this.mwe.C8(),this.HOt=new f.TableField(this.GOt,this.nM),this.pwe=!1},a.prototype.getValue=function(t){var n,i,r,n=this,i=this.HOt.getValue(t),r=(0,s.isUndefined)(i);return r?i=!this.gwe&&(r=!this.cwe||this.lwe?r:this.fwe.some(function(t){return!(0,s.isUndefined)(n.nM._dataSource.getFieldValue(t,0))}))?this.dwe?(this.hwe&&!this.pwe&&(this.pwe=!0),this.evaluateSelfTrigger(t)):this.evaluateTrigger(t):this.nM.XRt(this.GOt,0):!this.hwe||this.pwe||e.Convert.BJ(i)||(this.pwe=!0,i=this.dwe?this.evaluateSelfTrigger(t):this.evaluateTrigger(t)),i},a.prototype.evaluateTrigger=function(t){var t=this.UOt.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},a.prototype.evaluateSelfTrigger=function(t){var t=this.mwe.getValue(t);return this.HOt.setFieldValue(0,this.GOt,t),t},a.prototype.getValues=function(t,n){for(var i,r,e,i=[],r=n=n||0,e=t.length;r<e;r++)i.push(this.getValue(t[r]));return i},a.prototype.setValue=function(t,n){return this.HOt.setValue(t,n)},a.prototype.setItemValue=function(t,n,i,r){this.HOt.setItemValue(t,n,i,r)},a.prototype.hasItem=function(t){this.HOt.hasItem(t)},a.prototype.insertItem=function(t,n){this.HOt.insertItem(t,n)},a.prototype.getOriginalValue=function(t){return this.HOt.getOriginalValue(t)},a.prototype.getRelatedTable=function(){return this.HOt.getRelatedTable()},a.prototype.getRelationMaps=function(){return this.HOt.getRelationMaps()},a.prototype.getHostTableIndexes=function(t){return this.HOt.getHostTableIndexes(t)},n.TriggerCalcField=a,n.getWatchedFields=l},"./dist/src/table/windowOverField.js":function(t,n,i){"use strict";var r,u,l,e,d,x,T,a,h,D,o,s,c;function f(t,n,i){var r=c.call(this,i.windowFormula,n)||this;return r.GOt=t,r.options=i,r.Qhe=function(t){return n.rRt(t)},r.tde={evaluator:r},r.nde=!0,r.Sve(),r.Tve(),r.CHe(n,t),r}function A(t,n,i,r,e){var o,u,s,c,f;for(void 0===e&&(e=!1),o=i,u=r,s=D;o<=u;)n<=(f=t(c=Math.floor((o+u)/2)))?(e?o=c+1:u=c-1,s=c):e?u=c-1:o=c+1;return s}function P(t,n,i,r,e){var o,u,s,c,f;for(void 0===e&&(e=!1),o=i,u=r,s=D;o<=u;)(f=t(c=Math.floor((o+u)/2)))<=n?(e?u=c-1:o=c+1,s=c):e?o=c+1:u=c-1;return s}function y(t,n,i,r,e){for(var o,u,s,c,f,a,h,l,o=r,u=e,s=D,c=i.length-1;o<=u;){for(a=!0,h=t(f=Math.floor((o+u)/2)),l=c;0<=l;l--)if(i[l]!==n(h,l)){a=!1;break}a?(u=f-1,s=f):o=f+1}return s}function k(t,n,i,r,e){for(var o,u,s,c,f,a,h,l,o=r,u=e,s=D,c=i.length-1;o<=u;){for(a=!0,h=t(f=Math.floor((o+u)/2)),l=c;0<=l;l--)if(i[l]!==n(h,l)){a=!1;break}a?(o=f+1,s=f):u=f-1}return s}function L(t,n,i,r){for(var e,o,u,s,e=i,o=r,u=D;e<=o;)t(s=Math.floor((e+o)/2))===n?(e=s+1,u=s):o=s-1;return u}function V(t,n,i,r){var e,o,u,s,c;for(void 0===r&&(r=!1),e=n,o=i,u=D;e<=o;)c=t(s=Math.floor((e+o)/2)),(0,T.isNullOrUndefined)(c)?(r?o=s-1:e=s+1,u=s):r?e=s+1:o=s-1;return u}function G(t){return(0,T.isNumber)(t)&&-1<t?t:0}function v(t,n,i){var r,e,n;return(0,T.isNullOrEmpty)(n)||!(0,T.isString)(n)?[]:(i=i||[],(r=t.getCalcService()).dCe=r.dCe||{},r.dCe.hasOwnProperty(n)?(r.Wbe=!0,[]):(r.dCe[n]=!0,e=(0,d.parseFormula)(t,n),delete r.dCe[n],n=r.Wbe,0===Object.keys(r.dCe).length&&(delete r.dCe,delete r.Wbe),n?[]:(p(t,e,i),i)))}function p(t,n,i){var r,e,o,u,s,c,f;if(!(0,T.isNullOrUndefined)(n))if(n.function)if((0,d.getExprFunctionName)(n)===d.WINDOWOVER)i.push("="+(0,d.unparseExpression)(t,n));else for(r=0,e=n.arguments;r<e.length;r++)p(t,o=e[r],i);else if(14===n.type)n.value&&n.value.field instanceof a.CalcField&&!n.value.field.inCircular&&(n.value.field.inCircular=!0,v(t,n.value.field.GOt,i),delete n.value.field.inCircular);else for(u=0,s=Object.keys(n);u<s.length;u++)(f=n[c=s[u]])instanceof h.Expression&&p(t,n[c],i)}function w(t){var n;return!(0,T.isNullOrEmpty)(t)&&("string"==(n=typeof t)&&-1<t.indexOf(d.WINDOWOVER)||"object"==n&&"string"==typeof t.aggregate)}function b(t){var n=t.indexOf(d.WINDOWOVER);return(0,T.isFormula)(t)?1===n:0===n}function m(t,n){var i,r,e,o,u,s,c,f,a,i=[],r=d.WINDOWOVER.length,e=r+2,o=0,u=0;do{if(-1===(o=t.indexOf(d.WINDOWOVER,o)))break;for(u=o+r,s=0,c="=".concat(d.WINDOWOVER),f=0;u<t.length;u++)if((" "!==(a=t[u])||" "===a&&(!1===n||0<f))&&(c+=a),"("===a)s++;else if(")"===a){if(0===--s)break}else"["===a?f++:"]"===a&&f--}while(u!==t.length&&(i.push(c),o=u,t.length-o>=e));return i}function j(t,n){var t,i,r,e,o,t=t.nMt(t.Ywt(n.replace(d.WINDOWOVER,d.WINDOWOVERDECONSTRUCT))),i=(t.partitions||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field)},"p"),r=(t.orders||[]).reduce(function(t,n){return"".concat(t,"__").concat(n.field,"_").concat(n.ascending)},"o"),e="f",o=t.windowFrame;return o&&(e+="__".concat(o.type),o.begin&&(e+="__p__".concat(o.begin.type,"__").concat(o.begin.offset)),o.end)&&(e+="__f__".concat(o.end.type,"__").concat(o.end.offset)),u({partitionKey:i,orderKey:r,frameKey:e,windowOverFormula:n},t)}function g(t){return"["===t[0]&&"]"===t[t.length-1]}function _(t){return(0,T.isFormula)(t)?t.slice(1):g(t)?t:"[".concat(t,"]")}function O(t,n){var i;return(0,T.isNumber)(t)?i=0===t?"[@]":"[@".concat(t,"]"):"current"===t?i="[@]":"unbounded"===t&&(i="-1"),i||(n?"-1":"")}function S(t,n){var i,r,i=[];if(i.push(O(n.from,!0)),r=O(n.to,!1),(0,T.isNullOrEmpty)(r)||i.push(r),!(0,T.isNullOrEmpty)(n.exclude))switch(n.exclude){case l.FrameExcludeNoOthers:i.push(0);break;case l.FrameExcludeCurrentRow:i.push(1);break;case l.FrameExcludeGroup:i.push(2);break;case l.FrameExcludeTies:i.push(3)}return"".concat(t,"(").concat(i.join(),")")}function C(t,n){var n,i,f,i,r,e,o,t,e,u,s,c,a,h,e,o,r;if("string"==typeof t||(0,T.isNullOrUndefined)(t))return t;if(n=!n,i=t.aggregate,!(0,T.isNullOrEmpty)(i)||!n){if(f=[],n&&(0,T.isFormula)(i)&&(i=i.slice(1)),n&&f.push(i),i=t.window,e=t.partitionBy,o=t.orderBy,t=t.frame,(r=!1,T.isArray)(e)?(e=e.filter(function(t){return!(0,T.isNullOrEmpty)(t)}).map(_).join(),f.push("".concat(d.PARTITIONBY,"(").concat(e,")"))):n&&!(0,T.isNullOrEmpty)(i)&&(r=!0,f.push('"'.concat(i,'"'))),!(0,T.isNullOrUndefined)(o)&&((0,T.isArray)(o)?0<o.length:0<Object.keys(o).length))for(s=function(t){var n,i,r,e,o,u,s,c,s,s,n=Object.keys(t);if(0<n.length){for(i=[],r=function(t){return"string"==typeof t||(0,T.isNullOrUndefined)(t)},e=function(t,n){t===l.OrderAsc?i.push("".concat(d.ORDERASC,"(").concat(n,")")):t===l.OrderDesc?i.push("".concat(d.ORDERDESC,"(").concat(n,")")):i.push(n)},o=0,u=n;o<u.length;o++)c=_(s=u[o]),r(s=t[s])?e(s,c):r(s=s.order)&&e(s,c);f.push("".concat(d.ORDERBY,"(").concat(i.join(),")"))}},a=u=(c=0,T.isArray)(o)?o:[o];c<a.length;c++)s(h=a[c]);else!n||r||(0,T.isNullOrEmpty)(i)||(r=!0,f.push('"'.concat(i,'"')));return(0,T.isNullOrUndefined)(t)?!n||r||(0,T.isNullOrEmpty)(i)||f.push('"'.concat(i,'"')):(e=t.rows,o=t.range,r=t.groups,e?f.push(S(d.FRAMEROWS,e)):o?f.push(S(d.FRAMERANGE,o)):r&&f.push(S(d.FRAMEROWS,r))),"=".concat(n?d.WINDOWOVER:d.WINDOWDEF,"(").concat(f.join(),")")}}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.parseWindowOverByOption=n.deconstructWindowOverFunction=n.getWindowOverFormulas=n.isWindowOverFormula=n.hasWindowOverFormulas=n.processWindowOverFormula=n.addWindowOverFormulas=n.WindowOverCalcField=void 0,l=i("./dist/src/dataSource/dataSource.interface.js"),e=i("./dist/src/calculation/functions/windowFunctions/util.js"),d=i("./dist/src/calculation/functions/windowOvers/util.js"),x=i("./dist/src/dataSource/dataSource.interface.js"),T=i("./dist/src/dataSource/utils.js"),a=i("./dist/src/table/calcField.js"),h=i("CalcEngine"),D=-1,c=a.CalcField,r(f,c),f.prototype.P6t=function(){},f.prototype.C8=function(t){!1===t&&!this.SHe||(this.Tl=[],this.nde=!0,this.Sve())},f.prototype.getValue=function(t){return this.Tl[t]},f.prototype.XBt=function(t,n,i,r){var e,o,u,s,e=this;if(e.Tl||(e.Tl=[]),i=(0,T.isNumber)(i)?i:0,r=(0,T.isNumber)(r)?r:t.length-1,(0,T.isArray)(n))for(u=i,s=0;u<=r;u++,s++)o=t[u],e.Tl[o]=n[s];else for(u=i;u<=r;u++)o=t[u],e.Tl[o]=n;return e.Tl},f.prototype.CHe=function(t,n){var i=this.options.partitions&&this.options.partitions.some(function(t){return(0,T.isRelation)(t.field)}),i;i=(i=i||this.options.orders&&this.options.orders.some(function(t){return(0,T.isRelation)(t.field)}))||t.wHe(n,function(t){return(0,T.isString)(t)&&(0,T.isRelation)(t)}),this.SHe=i},f.prototype.Sve=function(){var t,n,i,r,t=this,n=t.options,i=t.Ave={};if((0,T.isArray)(n.orders))for(r=0;r<n.orders.length;r++)i[n.orders[r].field]={}},f.prototype.Tve=function(){var t=this,n=t.options.windowFormula,i=[e.ROWNUMBER,e.WRANK,e.DENSERANK,e.WPERCENTRANK,e.CUMEDIST,e.LEAD,e.LAG,e.NTILE,e.FIRSTVALUE,e.LASTVALUE,e.NTHVALUE];t.Ive=!i.some(function(t){return-1<n.indexOf(t)})},f.prototype.nMt=function(t,n,i,r,e,o,u){var s,t,n,s=this;return s.calcSource.pe(t,n,i,void 0,r,e,o),(t=7===arguments.length)&&s.calcSource.wEt("extendContext",u),n=s.calcService.evaluateExpression(s.calcSource,s.expression,{row:0,col:0}),t&&s.calcSource.wEt("extendContext"),n},f.prototype.ede=function(t,n,i,r,e,o,u,s){var c=this,f=c.tde.valueCache,a,o;!(0,T.isNullOrUndefined)(f)||-1===n&&-1===i||(c.tde.begin=(0,T.isNumber)(e)?e:n,o=c.nMt(t,n,i,o,u,s,c.tde),(0,T.isNumber)(r)&&(n=i=r),f=c.tde.valueCache,(0,T.isNullOrUndefined)(f)||(o=f,n=e,i=void 0),c.XBt(t,o,n,i))},f.prototype.xve=function(t){return this.Ave[t]},f.prototype.Nve=function(t,n,i){var r=n[i];return r=void 0===r?n[i]=this.calcSource.nM._getValueByField(t,i):r},f.prototype.evaluateWindowFunction=function(t,n){var i=this;i.ide(t,n||0),i.rde(),i.nde=!1},f.prototype.rde=function(){this.tde.begin=void 0,this.tde.valueCache=void 0},f.prototype.ide=function(t,n){var i=this,r=i.options.windowFrame;r&&r.begin&&-1===r.begin.offset&&r.end&&-1===r.end.offset||(i.Ive?i.ode(i.options.windowFrame,t,n):i.ede(t,n,void 0,void 0,n))},f.prototype.ode=function(t,n,i){for(var r,e,o,u,s,r=this,e={startIndex:i,endIndex:i,lastStartIndex:i,lastEndIndex:i},o=r.ube(n,i),u=i,s=n.length;u<s;u++)r.Khe(t,i,u,n,e,o),r.ede(n,e.startIndex,e.endIndex,u,i,e.gapStartIndex,e.gapEndIndex,e.currentIndex)},f.prototype.Khe=function(t,n,i,r,e,o){var u,s,c,f,a,h,l,d,t,d,t,u=this,l=x.WindowOverFrameExcludeMode.none;(e.gapStartIndex=e.gapEndIndex=e.currentIndex=void 0,T.isNullOrUndefined)(t)?a=(0,T.isNullOrUndefined)(u.options.orders)||0===u.options.orders.length?(s=x.WindowOverFrameType.ROWS,c=x.WindowOverFramePreceding.UnBounded,x.WindowOverFrameFollowing.UnBounded):(s=x.WindowOverFrameType.RANGE,c=x.WindowOverFramePreceding.UnBounded,x.WindowOverFrameFollowing.CurrentRow):(s=t.type,l=t.exclude||l,d=t.begin,t=t.end,d?(c=d.type,f=d.offset):c=x.WindowOverFramePreceding.UnBounded,t?(a=t.type,h=t.offset):a=x.WindowOverFrameFollowing.CurrentRow,s!==x.WindowOverFrameType.RANGE&&s!==x.WindowOverFrameType.GROUPS||!(0,T.isNullOrUndefined)(u.options.orders)&&0!==u.options.orders.length||(s=x.WindowOverFrameType.ROWS,c=x.WindowOverFramePreceding.UnBounded,a=x.WindowOverFrameFollowing.UnBounded)),d=r.length-1,s===x.WindowOverFrameType.RANGE?(e.startIndex=e.lastStartIndex,e.endIndex=e.lastEndIndex,c===x.WindowOverFrameFollowing.NFollowing?e.startIndex=u.ude(c,f,n,d,i,r,-1===e.startIndex?i+1:e.startIndex,!0):e.startIndex=u.ade(c,f,n,i,r,-1===e.startIndex?n:e.startIndex),a===x.WindowOverFramePreceding.NPreceding?e.endIndex=u.ade(a,h,n,i,r,-1===e.endIndex?n:e.endIndex,!0):e.endIndex=u.ude(a,h,n,d,i,r,-1===e.endIndex?i+1:e.endIndex),e.startIndex>e.endIndex?(e.startIndex=-1,e.endIndex=-1):(u.Dme(c,a,n,d,e),e.lastStartIndex=e.startIndex,e.lastEndIndex=e.endIndex,u.bwe(r,e,i,l))):s===x.WindowOverFrameType.GROUPS?(t=u.wwe(o,i),c===x.WindowOverFrameFollowing.NFollowing?e.startIndex=u.ywe(c,f,d,i,o,t,!0):e.startIndex=u.Mwe(c,f,n,i,o,t),a===x.WindowOverFramePreceding.NPreceding?e.endIndex=u.Mwe(a,h,n,i,o,t,!0):e.endIndex=u.ywe(a,h,d,i,o,t),u.Dme(c,a,n,d,e),u.Cwe(e,i,l,o&&o[t])):s===x.WindowOverFrameType.ROWS&&(c===x.WindowOverFrameFollowing.NFollowing?e.startIndex=u.cde(c,f,d,i):e.startIndex=u.sde(c,f,n,i),a===x.WindowOverFramePreceding.NPreceding?e.endIndex=u.sde(a,h,n,i):e.endIndex=u.cde(a,h,d,i),u.Dme(c,a,n,d,e),u.Swe(r,e,i,l))},f.prototype.Twe=function(t,n){t.startIndex<=n&&n<=t.endIndex&&(t.startIndex===n&&t.endIndex===n?(t.startIndex=-1,t.endIndex=-1):t.startIndex===n?t.startIndex=n+1:t.endIndex===n?t.endIndex=n-1:(t.gapStartIndex=n,t.gapEndIndex=n))},f.prototype.bwe=function(e,t,n,i){var o,r,u,s,c,f,a,h,l,d,v,p,w,b,m,j,o=this;if(i===x.WindowOverFrameExcludeMode.current)o.Twe(t,n);else if(i!==x.WindowOverFrameExcludeMode.none){if(a=f=c=void 0,u=(r=o.options.orders)&&0<r.length){for(s=[],h=[],l=[],v=d=void 0,p=e[n],w=r.length-1,b=0;b<=w;b++)d=r[b].field,v=o.xve(d),h.push(d),l.push(v),s.push(o.Nve(d,v,p));c=function(t){return e[t]},f=function(t,n){return o.Nve(h[n],l[n],t)},a=function(t){var n,i,r,n=e[t],i=!(0,T.isNumber)(n);if(!i)for(r=w;0<=r;r--)if(s[r]!==o.Nve(h[r],l[r],n)){i=!0;break}return!i}}i===x.WindowOverFrameExcludeMode.group?u&&t.startIndex<=n&&n<=t.endIndex&&(a((m=n)-1)&&(m=y(c,f,s,t.startIndex,n-1))===D&&(m=n),a((j=n)+1)&&(j=k(c,f,s,n+1,t.endIndex))===D&&(j=n),t.gapStartIndex=m,t.gapEndIndex=j,m===t.startIndex&&(t.startIndex=j+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),j===t.endIndex&&(t.endIndex=m-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),t.startIndex>t.endIndex)&&(t.startIndex=-1,t.endIndex=-1):i===x.WindowOverFrameExcludeMode.ties&&u&&t.startIndex<=n&&n<=t.endIndex&&(m=D,a(n-1)&&(m=y(c,f,s,t.startIndex,n-1)),j=D,a(n+1)&&(j=k(c,f,s,n+1,t.endIndex)),t.gapStartIndex=m,t.gapEndIndex=j,m===D&&j===D?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):m===D?t.gapStartIndex=n+1:j===D?t.gapEndIndex=n-1:t.currentIndex=n)}},f.prototype.Cwe=function(t,n,i,r){var e,o,u,e=this;(0,T.isNullOrUndefined)(r)||(i===x.WindowOverFrameExcludeMode.current?e.Twe(t,n):i===x.WindowOverFrameExcludeMode.group?(o=r.begin,u=r.end,t.startIndex<o&&u<t.endIndex?(t.gapStartIndex=o,t.gapEndIndex=u):t.startIndex===o&&t.endIndex===u?(t.startIndex=-1,t.endIndex=-1):t.startIndex<=u&&t.startIndex>=o?t.startIndex=u+1:t.endIndex<=u&&t.endIndex>=o&&(t.endIndex=o-1)):i===x.WindowOverFrameExcludeMode.ties&&(o=r.begin,u=r.end,t.startIndex===o&&t.endIndex===u?(t.startIndex=n,t.endIndex=n):t.startIndex<=o&&u<=t.endIndex?(t.gapStartIndex=o,t.gapEndIndex=u,t.currentIndex=n):t.startIndex<=u&&t.startIndex>=o?n<t.startIndex?t.startIndex=u+1:(t.gapStartIndex=t.startIndex,t.gapEndIndex=u,t.currentIndex=n):t.endIndex<=u&&t.endIndex>=o&&(n>t.startIndex?t.endIndex=o-1:(t.gapStartIndex=o,t.gapEndIndex=t.endIndex,t.currentIndex=n))))},f.prototype.Swe=function(e,t,n,i){var o,r,u,s,c,f,a,h,l,d,v,p,w,b,m,j,o=this;if(i===x.WindowOverFrameExcludeMode.current)o.Twe(t,n);else if(i!==x.WindowOverFrameExcludeMode.none){if(a=f=c=void 0,u=(r=o.options.orders)&&0<r.length){for(s=[],h=[],l=[],v=d=void 0,p=e[n],w=r.length-1,b=0;b<=w;b++)d=r[b].field,v=o.xve(d),h.push(d),l.push(v),s.push(o.Nve(d,v,p));c=function(t){return e[t]},f=function(t,n){return o.Nve(h[n],l[n],t)},a=function(t){var n,i,r,n=e[t],i=!(0,T.isNumber)(n);if(!i)for(r=w;0<=r;r--)if(s[r]!==o.Nve(h[r],l[r],n)){i=!0;break}return!i}}i===x.WindowOverFrameExcludeMode.group?(!u||(t.startIndex<n&&n<t.endIndex?(a((m=n)-1)&&(m=y(c,f,s,t.startIndex,n-1))===D&&(m=n),a((j=n)+1)&&(j=k(c,f,s,n+1,t.endIndex))===D&&(j=n),t.gapStartIndex=m,t.gapEndIndex=j,m===t.startIndex&&(t.startIndex=j+1,t.gapStartIndex=void 0,t.gapEndIndex=void 0),j===t.endIndex&&(t.endIndex=m-1,t.gapStartIndex=void 0,t.gapEndIndex=void 0)):n<=t.startIndex?a(t.startIndex)&&(j=k(c,f,s,t.startIndex,t.endIndex))!==D&&(t.startIndex=j+1):n>=t.endIndex&&a(t.endIndex)&&(m=y(c,f,s,t.startIndex,t.endIndex))!==D&&(t.endIndex=m-1),t.startIndex>t.endIndex))&&(t.startIndex=-1,t.endIndex=-1):i===x.WindowOverFrameExcludeMode.ties&&(u?(t.startIndex<=n&&n<=t.endIndex?(m=D,a(n-1)&&(m=y(c,f,s,t.startIndex,n-1)),j=D,a(n+1)&&(j=k(c,f,s,n+1,t.endIndex)),t.gapStartIndex=m,t.gapEndIndex=j,m===D&&j===D?(t.gapStartIndex=void 0,t.gapEndIndex=void 0):m===D?t.gapStartIndex=n+1:j===D?t.gapEndIndex=n-1:t.currentIndex=n):n<t.startIndex?a(t.startIndex)&&(j=k(c,f,s,t.startIndex,t.endIndex))!==D&&(t.startIndex=j+1):n>t.endIndex&&a(t.endIndex)&&(m=y(c,f,s,t.startIndex,t.endIndex))!==D&&(t.endIndex=m-1),t.startIndex>t.endIndex&&(t.startIndex=-1,t.endIndex=-1)):(t.startIndex=n,t.endIndex=n))}},f.prototype.Dme=function(t,n,i,r,e){t===x.WindowOverFramePreceding.UnBounded?n===x.WindowOverFramePreceding.NPreceding?-1!==e.startIndex&&-1===e.endIndex&&(e.startIndex=-1):n===x.WindowOverFrameFollowing.NFollowing&&-1!==e.startIndex&&-1===e.endIndex&&(e.endIndex=r):t===x.WindowOverFramePreceding.NPreceding?n===x.WindowOverFramePreceding.NPreceding||n===x.WindowOverFramePreceding.CurrentRow?-1===e.startIndex&&-1!==e.endIndex&&(e.startIndex=i):n!==x.WindowOverFrameFollowing.NFollowing&&n!==x.WindowOverFrameFollowing.UnBounded||(-1===e.startIndex&&(e.startIndex=i),-1===e.endIndex&&(e.endIndex=r)):t===x.WindowOverFramePreceding.CurrentRow?n===x.WindowOverFrameFollowing.NFollowing&&-1===e.endIndex&&(e.endIndex=r):t===x.WindowOverFrameFollowing.NFollowing&&(n===x.WindowOverFrameFollowing.NFollowing?-1!==e.startIndex&&-1===e.endIndex?e.endIndex=r:-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1):n===x.WindowOverFrameFollowing.UnBounded&&-1===e.startIndex&&-1!==e.endIndex&&(e.endIndex=-1))},f.prototype.sde=function(t,n,i,r){var e;switch(t){case x.WindowOverFramePreceding.UnBounded:e=i;break;case x.WindowOverFramePreceding.NPreceding:e=i<=(e=r-G(n))?e:-1;break;default:x.WindowOverFramePreceding.CurrentRow;e=r}return e},f.prototype.cde=function(t,n,i,r){var e;switch(t){case x.WindowOverFrameFollowing.UnBounded:e=i;break;case x.WindowOverFrameFollowing.NFollowing:e=(e=r+G(n))<=i?e:-1;break;default:x.WindowOverFrameFollowing.CurrentRow;e=r}return e},f.prototype.Mwe=function(t,n,i,r,e,o,u){var s,c,c;switch(t){case x.WindowOverFramePreceding.UnBounded:s=i;break;case x.WindowOverFramePreceding.NPreceding:s=i,(0,T.isNullOrUndefined)(e)||(c=e[o-G(n)],s=(0,T.isNullOrUndefined)(c)?-1:u?c.end:c.begin);break;case x.WindowOverFramePreceding.CurrentRow:s=r,(0,T.isNullOrUndefined)(e)||(c=e[o],s=u?c.end:c.begin);break;default:s=r}return s},f.prototype.ywe=function(t,n,i,r,e,o,u){var s,c,c;switch(t){case x.WindowOverFrameFollowing.UnBounded:s=i;break;case x.WindowOverFrameFollowing.NFollowing:s=i,(0,T.isNullOrUndefined)(e)||(c=e[o+G(n)],s=(0,T.isNullOrUndefined)(c)?-1:u?c.begin:c.end);break;case x.WindowOverFrameFollowing.CurrentRow:s=r,(0,T.isNullOrUndefined)(e)||(c=e[o],s=u?c.begin:c.end);break;default:s=r}return s},f.prototype.ade=function(t,n,i,r,e,o,u){var s,c,f,a,h,l,d,v,p,d,w,b,m,j,y,g,_,O,S,C,R,F,I,m,N,s=this,f=s.options.orders;switch(t){case x.WindowOverFramePreceding.NPreceding:if(n=G(n),c=i,1===f.length&&i<=(c=r))if(a=f[0].field,h=f[0].ascending,l=s.xve(a),d=s.Nve(a,l,e[r]),(0,T.isNullOrUndefined)(d)){if(v=e[r-1],d!==(p=s.Nve(a,l,v)))return c;c=o}else(0,T.isNumber)(d)&&(d=!1===h?d+n:d-n,w=function(t){return s.Nve(a,l,e[t])},m=e[b=r-1],c=(y=(j=!(0,T.isNumber)(m)||r===i)||(!1===h?d<s.Nve(a,l,m):d>s.Nve(a,l,m)))?u?j?-1:b:r:u?!1===h?A(w,d,o,b,!0):P(w,d,o,b):!1===h?P(w,d,o,b,!0):A(w,d,o,b));break;case x.WindowOverFramePreceding.UnBounded:c=i;break;default:x.WindowOverFramePreceding.CurrentRow;if(i<(c=r)){if(1===f.length){if(g=f[0].field,_=s.xve(g),O=s.Nve(g,_,e[r]),v=e[r-1],O!==(S=s.Nve(g,_,v)))return c}else{for(O=[],C=[],R=[],_=g=void 0,F=e[r],I=0;I<f.length;I++)g=f[I].field,_=s.xve(g),C.push(g),R.push(_),O.push(s.Nve(g,_,F));for(v=void 0,m=O.length-1,v=e[r-1],N=m;0<=N;N--)if(O[N]!==s.Nve(C[N],R[N],v))return c}c=o}}return c},f.prototype.ude=function(t,n,i,r,e,o,u,s){var c,f,a,h,l,d,v,p,w,b,m,j,v,y,g,_,O,g,S,C,R,F,I,N,M,y,E,c=this,a=c.options.orders;switch(t){case x.WindowOverFrameFollowing.NFollowing:n=G(n),f=r,1===a.length&&(h=a[0].field,l=a[0].ascending,d=c.xve(h),v=c.Nve(h,d,o[e]),p=function(t){return c.Nve(h,d,o[t])},(0,T.isNullOrUndefined)(v)?(w=!0,e!==i&&(b=o[e-1],w=!(0,T.isNumber)(b)||v!==c.Nve(h,d,b)),f=u,w&&(m=o[e+1],f=(j=!(0,T.isNumber)(m)||v!==c.Nve(h,d,m))?e:V(p,u,r,!1===l))):(0,T.isNumber)(v)&&(v=!1===l?v-n:v+n,m=o[y=e+1],f=(j=(g=!(0,T.isNumber)(m)||e===r)||(!1===l?v>c.Nve(h,d,m):v<c.Nve(h,d,m)))?s?g?-1:y:e:s?!1===l?P(p,v,u,r,!0):A(p,v,u,r):!1===l?A(p,v,u,r,!0):P(p,v,u,r)));break;case x.WindowOverFrameFollowing.UnBounded:f=r;break;default:x.WindowOverFrameFollowing.CurrentRow;if(1===a.length)_=a[0].field,O=c.xve(_),g=c.Nve(_,O,o[e]),p=function(t){return c.Nve(_,O,o[t])},w=!0,e!==i&&(b=o[e-1],w=!(0,T.isNumber)(b)||g!==c.Nve(_,O,b)),f=u,w&&(m=o[e+1],f=(j=!(0,T.isNumber)(m)||g!==c.Nve(_,O,m))?e:L(p,g,u,r));else{for(S=[],C=[],R=[],I=F=void 0,N=o[e],M=0;M<a.length;M++)F=a[M].field,I=c.xve(F),C.push(F),R.push(I),S.push(c.Nve(F,I,N));y=function(t){var n,i,r,n=o[t],i=!(0,T.isNumber)(n);if(!i)for(r=a.length-1;0<=r;r--)if(S[r]!==c.Nve(C[r],R[r],n)){i=!0;break}return i},f=u,w=!0,(w=e!==i?y(e-1):w)&&((j=y(e+1))||(f=k(E=function(t){return o[t]},p=function(t,n){return c.Nve(C[n],R[n],t)},S,u+1,r))===D)&&(f=e)}}return f},f.prototype.ube=function(t,n){var i,r,e,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,i=this,r=i.options.orders,e=i.options.windowFrame&&i.options.windowFrame.type;if(r&&0<r.length&&e===x.WindowOverFrameType.GROUPS){if(e=t[n],o=[{begin:n,end:n}],1<t.length-n){for(u=[],s=[],c=[],a=f=void 0,h=e,l=r.length-1,d=0;d<=l;d++)f=r[d].field,a=i.xve(f),s.push(f),c.push(a),u.push(i.Nve(f,a,h));for(d=n+1,v=t.length;d<v;d++){for(p=t[d],w=[],b=!0,m=0;m<=l;m++)j=i.Nve(s[m],c[m],p),w.push(j),u[m]!==j&&(b=!1);b?o[o.length-1].end=d:(u=w,o[o.length]={begin:d,end:d})}}return o}},f.prototype.wwe=function(t,n){var i,r,e;if(!(0,T.isNullOrUndefined)(t))for(i=0,r=t.length;i<r;i++)if((e=t[i]).begin<=n&&n<=e.end)return i},n.WindowOverCalcField=f,n.addWindowOverFormulas=v,n.processWindowOverFormula=p,n.hasWindowOverFormulas=w,n.isWindowOverFormula=b,n.getWindowOverFormulas=m,n.deconstructWindowOverFunction=j,n.parseWindowOverByOption=C},"./dist/src/undo/changesHelper.js":function(t,n,i){"use strict";var r,c,e;function o(t){this.zQt=t,this.P8=0,this.G8=[]}r=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ChangesHelper=void 0,c=i("./dist/src/undo/interface.js"),o.prototype.$Be=function(){return{inTransaction:this.P8,changes:r([],this.G8,!0)}},o.prototype.tGe=function(t){var n=t.inTransaction,t=t.changes;this.P8=n,this.G8=t},o.prototype.VAe=function(){this.P8++},o.prototype.zAe=function(){this.P8=Math.max(this.P8-1,0)},o.prototype.lM=function(){return 0<this.P8},o.prototype.nGe=function(t){if(this.lM())return this.G8.push(t),this.G8},o.prototype.eGe=function(){return r([],this.G8,!0)},o.prototype.iGe=function(){this.G8=[]},o.prototype.Mtt=function(t){var n,i,r,e,o,u,o,i=t.type;if(i===c.ViewChangeType.Update||i===c.ViewChangeType.Insert)return this.rGe(t);if(i===c.ViewChangeType.DefineColumnRemoveColumn||i===c.ViewChangeType.DefineColumnModifyColumn||i===c.ViewChangeType.DefineColumnAddColumn||i===c.ViewChangeType.UpdateColumn||i===c.ViewChangeType.UpdateColumnName||i===c.ViewChangeType.DeleteColumn||i===c.ViewChangeType.AddColumn||i===c.ViewChangeType.MoveColumnOptions||i===c.ViewChangeType.MoveColumnInfos||i===c.ViewChangeType.RemoveCrossFields||i===c.ViewChangeType.RemoveColumnInfoOptions||i===c.ViewChangeType.UpdateCrossColumnIndex)this.oGe(t);else if(i===c.ViewChangeType.SortUpdate)this.zQt.aGe(t.oldData.sortInfo,t.oldData.indexMap);else if(i===c.ViewChangeType.DetailColumnsVisible)this.zQt.detailColumnsVisible(t.oldData);else if(i===c.ViewChangeType.PinnedRows||i===c.ViewChangeType.PinnedColumns)this.uGe(t);else if(i===c.ViewChangeType.StyleRuleChanges)for(e in this.zQt.clearStyleRules(),r=null!=(n=t.oldData)?n:{})r.hasOwnProperty(e)&&(u=(o=r[e]).style,o=o.rule,this.zQt.addStyleRule(e,u,o));else i===c.ViewChangeType.TableSheetColumnDataTypeChanged||i===c.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged?this.sGe(t):i!==c.ViewChangeType.HierarchyLevelChanged&&i!==c.ViewChangeType.RowDataChanged&&i!==c.ViewChangeType.MovedUpdateOrDown||this.cGe(t)},o.prototype.cGe=function(t){var n,n,t,n=t.type;n===c.ViewChangeType.HierarchyLevelChanged?this.zQt.fGe(t.oldData):n===c.ViewChangeType.RowDataChanged?this.zQt.lGe(t.oldData):n===c.ViewChangeType.MovedUpdateOrDown&&(n=t.moveIndex,t=t.destIndex,this.zQt.m7t(n,t))},o.prototype.sGe=function(t){var n=t.type,t=t.oldData;n===c.ViewChangeType.TableSheetColumnDataTypeChanged?(this.zQt.hGe(t.columnValue,t.oldData),this.zQt.updateColumnDataType(t.columnValue,t.oldDataType)):n===c.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged&&this.zQt.updateColumnIsPrimaryKeyType(t.columnValue,t.oldIsPrimaryKey)},o.prototype.rGe=function(t){var n=t.type;if(n===c.ViewChangeType.Update)this.zQt.updateItem(t.modelIndex,t.oldData,null,null,{isModelIndex:!0});else if(n===c.ViewChangeType.Insert)return this.zQt.removeItems([t.index])},o.prototype.oGe=function(t){var n,i,r,e,o,u,s,i,e,r,u,n=t.type;n===c.ViewChangeType.UpdateColumn?this.zQt.yBe(t.oldData,t.isInfo):n===c.ViewChangeType.UpdateColumnName?this.zQt.dGe(t.newName,t.oldName):n===c.ViewChangeType.DeleteColumn?this.zQt.vGe(t.index,t.oldData,t.isInfo,t.isField):n===c.ViewChangeType.AddColumn?this.zQt.removeColumn(t.newData.value):n===c.ViewChangeType.DefineColumnRemoveColumn?this.zQt.vBe(t):n===c.ViewChangeType.DefineColumnModifyColumn?this.zQt.bBe(t):n===c.ViewChangeType.DefineColumnAddColumn?this.zQt.uBe(t):n===c.ViewChangeType.MoveColumnOptions?this.zQt.DPt(t.to,t.from):n===c.ViewChangeType.MoveColumnInfos?(i=t.to,r=t.from,e=t.count,s=u=void 0,s=(o=i<r)?(u=i,r+e-1):(u=i-e+1,r),this.zQt.OPt(u,s,t.count)):n===c.ViewChangeType.RemoveCrossFields?this.zQt.gGe(t.oldData):n===c.ViewChangeType.UpdateCrossColumnIndex?(i=t.data.map(function(t){var n=t.oldIndex,i;return{oldIndex:t.newIndex,newIndex:n}}),this.zQt.wLt(i)):n===c.ViewChangeType.RemoveColumnInfoOptions&&(r=(e=t.oldData).columnInfoOptions,u=e.options,this.zQt.mGe(r,u))},o.prototype.uGe=function(t){var n=t.oldData,t=t.type;t===c.ViewChangeType.PinnedRows?(this.zQt.pGe(),this.zQt.togglePinnedRows(this.bGe(n.pinnedRows))):t===c.ViewChangeType.PinnedColumns&&(this.zQt.wGe(),this.zQt.togglePinnedColumns(n.pinnedColumns))},o.prototype.bGe=function(t){var n,i=this.zQt.iRt;return t.map(function(t){return i.indexOf(t)})},n.ChangesHelper=o},"./dist/src/undo/interface.js":function(t,n){"use strict";var i,n;Object.defineProperty(n,"__esModule",{value:!0}),n.ViewChangeType=void 0,(n=i=n.ViewChangeType||(n.ViewChangeType={})).Update="update",n.Insert="insert",n.UpdateColumn="updateColumn",n.UpdateColumnName="updateColumnName",n.DeleteColumn="deleteColumn",n.AddColumn="addColumn",n.DefineColumnAddColumn="createColumn",n.DefineColumnRemoveColumn="removeColumn",n.DefineColumnModifyColumn="modifyColumn",n.MoveColumnOptions="moveColumnOptions",n.MoveColumnInfos="moveColumnInfos",n.SortUpdate="sortUpdate",n.DetailColumnsVisible="detailColumnsVisible",n.PinnedRows="pinnedRows",n.PinnedColumns="pinnedColumns",n.StyleRuleChanges="styleRuleChanged",n.TableSheetColumnDataTypeChanged="tableSheetColumnDataTypeChanged",n.TableSheetColumnIsPrimaryKeyChanged="tableSheetColumnIsPrimaryKeyChanged",n.RemoveCrossFields="removeCrossFields",n.RemoveColumnInfoOptions="removeColumnInfoOptions",n.UpdateCrossColumnIndex="updateCrossColumnIndex",n.HierarchyLevelChanged="hierarchyLevelChanged",n.RowDataChanged="rowDataChanged",n.MovedUpdateOrDown="movedUpdateOrDown"},"./dist/src/viewField/fieldManager.js":function(R,t,n){"use strict";var u,a,E,s,x,j,c,F;function f(r,e,o,u){return function(t,n){var n,i,n=r.getField(n),i=o&&!(0,c.isGroupSlice)(n.name)&&n.extra&&n.extra.caption||n.name;return u&&n instanceof j.ColumnDataReaderField||(t[i]=n.getValue(e)),t}}function i(t,n){this._id=0,this.Pq=[],this.Z={},this.groupFieldKeys=[],this.sBt=t,this.cBt={},this.nM=n}function h(t,n){var i,r,e,o,o,u,s,c,f,f,i=[];if(t.function)for(r=0,e=t.arguments;r<e.length;r++)if(14===(o=e[r]).type){if(!n){i.push(o.value.Pq[0]);break}i.push(o.value.Pq[0])}else(o=h(o))&&(i=i.concat(o));else for(u=0,s=Object.getOwnPropertyNames(t);u<s.length;u++)if((f=t[c=s[u]])instanceof a.Expression)if(14===f.type){if(!n){i.push(f.value.Pq[0]);break}i.push(f.value.Pq[0])}else(f=h(f))&&(i=i.concat(f));return i}function r(t,n){for(var n,i,r,e,o,u,s,c,n=n.valueRelation,i=n.split("."),r=t(n),e="",o=!1,u=!1,s=0;s<i.length;s++)c=r[s],(0,E.isNullOrEmpty)(i[s])||(e+=".".concat(i[s])),!u&&c&&"array"===c.type&&c.name===i[s]&&(o=u=!0,e+=".".concat(x.RelationTemplateToken));return{isOneToMany:o,relationTemplate:e.slice(1)}}function l(t,n,i,r){var e,o,e=A(t),o;return{valueRelation:t,valueCaption:n||e,valueIndex:i,valueCrossKey:r}}function T(t){for(var n,i,r,e,o,n=t.columns,i=t.crossKeys,r=t.initialOptionIndex,e=[],o=0;o<n.length;o++)e.push(l(n[o].value,n[o].caption,r+o,i[o]));return e}function D(t,n){return e(t,n,"")}function e(t,n,i){return!(0,E.isNullOrEmpty)(n)&&0<=t.indexOf(n)?e(t=t.replace(n,i),n,i):t}function y(t){var t=t.value;return"string"==typeof t?t:"function"==typeof t?t.name:void 0}function d(t){var t,t="string"==typeof t||(0,E.isNullOrUndefined)(t)?t:"function"==typeof t?t.name:t.value;return(t||"").split(".")}function A(t){var t=d(t);return t[t.length-1]}function P(t){if(!(0,E.isNullOrEmpty)(t.formatter))return t.formatter}function k(t){var t=d(t);return t[t.length-2]}function L(t,n){var t=d(t);return n&&t.splice(t.length-1,0,""),t.slice(0,t.length-1).join(".")}function V(t){return"string"==typeof t?[t]:t||[]}function g(t){for(var n,i,r,e,o,n=0,i={},r=0;r<t.length;r++)e=t[r].caption,(0,E.isArray)(e)?(t[r].caption=e.map(function(t){return null==t?void 0:t.toString()}),i[r]=e.length,n<i[r]&&(n=i[r])):t[r].caption=null==e?void 0:e.toString();for(r in i)if(i[r]<n)for(o=n-i[r],e=t[r].caption;0<o;)e.unshift(),o--;for(r=0;r<t.length;r++)e=t[r].caption,(0,E.isArray)(e)&&1===e.length&&(t[r].caption=e[0])}function v(t,n){var t,t,t,i,t=t.qRt(n);if(!((0,E.isNullOrUndefined)(t)||(t=t._dataSource.options.schema,(0,E.isNullOrUndefined)(t))||(t=t.columns,(0,E.isNullOrUndefined)(t))||(i=t[A(n)],(0,E.isNullOrUndefined)(i))))return i.lookup}function o(t,n){return p(t,n)||w(t,n)}function p(t,n){return(0,E.isArray)(v(t,n))}function w(t,n){var i,r,e,o,n,i=v(t,n);if((0,E.isObject)(i)&&(i=i.name),(0,E.isString)(i))return r=t.qRt(n),e=A(n),o=A(i),n=t.QOt.relationships.find(function(t){return t.sourceTable===r&&t.sourceFieldName===e&&t.sourceRelationshipName===o}),!(0,E.isNullOrUndefined)(n)}function b(t,n,i){var r=A(i),i=S(t,function(t){return t.sourceFieldName===r&&t.sourceTable===n});return i?{relationTable:i.targetTable,relationPrimaryKey:i.targetFieldName,relationTableName:i.sourceRelationshipName}:{}}function m(t,n,i){var r,n,e,o,n,o,n,e,o,r,r=n.over,n=n.attributes;return!((0,E.isNullOrEmpty)(r)||(0,E.isNullOrEmpty)(i)||i===r||_(t,i)||(e=d(i),n=!(o=p(t,r))&&w(t,r)&&n&&0<n.length,!o&&!n)||(o=b(t,O(t,r),r),-1<e.indexOf(o.relationTableName)))&&(n=t.$Rt(r),e=t.$Rt(i),!(!n.every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne})||!e.every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne}))||(o=(0,E.findIndex)(n,function(t){return t.relationshipMap===s.RelationshipMap.OneToMany}),r=(0,E.findIndex)(e,function(t){return t.relationshipMap===s.RelationshipMap.OneToMany}),-1<o&&o===r&&n[o].name===e[r].name?n.slice(o+1).every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne})&&e.slice(o+1).every(function(t){return t.relationshipMap===s.RelationshipMap.OneToOne}):void 0))}function _(t,n){var i=O(t,n),r=A(n);return i.jOt(r)||S(t,function(t){return t.sourceTable===i&&t.sourceFieldName===r||t.targetTable===i&&t.targetFieldName===r})}function O(t,n){return t.qRt(n)}function S(t,n){return t.QOt.relationships.find(n)}function C(t){var r=t.ascending,i=t.compare;return i?function(t,n){return i(t.extra.caption,n.extra.caption,r)}:function(t,n){var t=t.extra.caption,n=n.extra.caption,i=r?t:n,n=r?n:t;return n<i?1:i<n?-1:0}}u=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.isValidCross=t.isLookupRelationField=t.isLookupListField=t.isLookupField=t.getLookupBy=t.getFieldNamesFrom=t.FieldManager=void 0,a=n("CalcEngine"),E=n("./dist/src/dataSource/utils.js"),s=n("./dist/src/interfaces/interface.js"),x=n("./dist/src/viewField/utils.js"),j=n("./dist/src/viewField/fields.js"),c=n("./dist/src/viewField/groupManager.js"),i.prototype.hde=function(){return this.nM.length()},i.prototype.fBt=function(t,n){return this.nM._getValueByField(t,n)},i.prototype.lBt=function(t,n){return this.nM.XRt(t,n)},i.prototype.hBt=function(t){return this.nM.iBt(t)},i.prototype.dBt=function(t){return S(this.nM,t)},i.prototype.vBt=function(t){return O(this.nM,t)},i.prototype.mBt=function(t){return this.nM._dataSource._data[t].data},i.prototype.gBt=function(t){return!(0,E.isNullOrUndefined)(this.nM._dataSource._data[t])&&!this.nM._dataSource.X7t()},i.prototype.oBt=function(t){return this.nM.oBt(t.split("."))},i.prototype.pBt=function(){return this.nM.POt},i.prototype.bBt=function(t){return v(this.nM,t)},i.prototype.yBt=function(t){return o(this.nM,t)},i.prototype.wBt=function(t){return p(this.nM,t)},i.prototype.MBt=function(t){return w(this.nM,t)},i.prototype.getTable=function(){return this.nM},i.prototype.getField=function(n){return this.Z[n]||this.Pq.find(function(t){return t.key===n})},i.prototype.getFieldByColumn=function(t){return this.getField(t.Kyn)},i.prototype.getFieldByName=function(t){return this.Z[t]},i.prototype.getFields=function(t){return this.Pq.filter(t)},i.prototype.kve=function(t,n,i,r,e){var o=this;f(o,i,r,e)(t,o.getFieldByColumn(n).key)},i.prototype.getFieldValues=function(t,n,i){for(var r,e,o,u,s,c,r=this,e=f(r,t,n,i),o={},u=0,s=r.Pq;u<s.length;u++)e(o,(c=s[u]).key);return o},i.prototype.CBt=function(t){for(var n,i,r,e,o,u,n=this,i=f(n,t),r={},e=0,o=n.Pq;e<o.length;e++)(u=o[e]).isGroup&&i(r,u.key);return r},i.prototype.moveFields=function(t,n,i){(0,E.swapArrayItems)(this.Pq,t,n,i)},i.prototype.moveFieldsByIndexes=function(t){var n=this;t.forEach(function(t){t.field=n.Pq[t.oldIndex]}),t.forEach(function(t){n.Pq[t.newIndex]=t.field})},i.prototype.removeFields=function(t,n,i){var r;i&&i({fields:u([],this.Pq,!0)})},i.prototype.yGe=function(t){var t=t.fields;this.Pq=t},i.prototype.reset=function(){var n=this;n.Pq=n.Pq.filter(function(t){return t.isBasic}),n.Z={},n.groupFieldKeys=[],n.Pq.forEach(function(t){n.Z[t.name]=t,n.Z[t.key]=t})},i.prototype.bMt=function(t){return this.cBt[t]||this.Awe(t)},i.prototype.Awe=function(t,n){var i=this,r=i.cBt,e=r[t],n=n||i.pBt(),o=n.getCalcService(),e;return e=e||(r[t]=i.fixExpression(o.parse(n,t,0,0)))},i.prototype.SBt=function(t){var n=this,e=n.Awe(t),o=n.pBt(),u=o.getCalcService();return function(t,n,i,r){var t,n;return o.pe(t,n,i),(t=4===arguments.length)&&o.wEt("extendContext",r),n=u.evaluateExpression(o,e,{row:0,col:0}),t&&o.wEt("extendContext"),n}},i.prototype.TBt=function(t,n){var i=this,e=i.Awe(t,n),o=n||i.pBt(),u=o.getCalcService();return function(t,n,i,r){var t,n;return o.pe(t,n,i),(t=4===arguments.length)&&o.wEt("extendContext",r),n=u.MX.evaluateExpression(e,o.getEvaluatorContext({row:0,col:0},!1),!1,!0),t&&o.wEt("extendContext"),(0,E.isNullOrUndefined)(n.toArray)?[]:n.toArray()}},i.prototype.fixExpression=function(t){var n,i,r,e,o,u,s,n=this;if(t.function)for(t.function.isReverseArgs&&t.function.isReverseArgs()&&t.arguments.reverse(),i=0,r=t.arguments;i<r.length;i++)e=r[i],n.fixExpression(e);else for(o=0,u=Object.getOwnPropertyNames(t);o<u.length;o++)t[s=u[o]]instanceof a.Expression&&n.fixExpression(t[s]);return t},i.prototype.ABt=function(t){var n=this;return t.key=n._id++,n.Pq.push(t),n.Z[t.name]=t,n.Z[t.key]=t},i.prototype.removeField=function(t){var n=this,i;return((i=(0,E.isString)(t)?n.getFieldByName(t):i)instanceof j.ColumnDataField||i instanceof j.ColumnDataReaderField)&&(n.Pq.splice(n.Pq.indexOf(i),1),delete n.Z[i.name],delete n.Z[i.key],!0)},i.prototype.addBaseField=function(t){var n=this,i=y(t),r=t.value;n.gBt(i)?n.addDataBaseField(i,n.mBt(i),t):n.addReaderBaseField(i,r,t)},i.prototype.renameBaseField=function(t,n){var i=this,r;return((r=(0,E.isString)(t)?i.getFieldByName(t):r)instanceof j.ColumnDataField||r instanceof j.ColumnDataReaderField)&&(i.Z[n]=i.Z[r.name],delete i.Z[r.name],r.name=n,!0)},i.prototype.addDataBaseField=function(t,n,i){var r=this,t=r.addColumnDataField(t,n,i);return i.Kyn=t.key,r.CGe(t)},i.prototype.addReaderBaseField=function(t,n,i){var r,t,r=this,t=r.addColumnDataReaderField(t,"function"==typeof n?n:function(t){return r.fBt(n,t)},i,r.hde.bind(r));return i.Kyn=t.key,r.CGe(t)},i.prototype.CGe=function(t){return t.isBasic=!0,t},i.prototype.addColumnDataField=function(t,n,i){return this.ABt(new j.ColumnDataField(t,n,i))},i.prototype.addColumnDataReaderField=function(t,n,i,r){return this.ABt(new j.ColumnDataReaderField(t,n,i,r))},i.prototype.addDataField=function(t,n){return this.ABt(new j.DataField(t,n))},i.prototype.addFormulaField=function(t,n){return this.ABt(this.xBt(t,n))},i.prototype.xBt=function(t,n){return new j.FormulaField(t,n,this.SBt(n))},i.prototype.addCategoryFormulaField=function(t,n,i){return this.ABt(this.NBt(t,n,i))},i.prototype.NBt=function(t,n,i){return new j.CategoryFormulaField(t,n,this.SBt(n),i,i?this.Awe(i):null)},i.prototype.addCategoryField=function(t,n){return this.ABt(this.kBt(t,n))},i.prototype.kBt=function(t,n){return new j.CategoryField(t,n)},i.prototype.addSliceCategoryField=function(t){return this.ABt(new j.SliceCategoryField(t))},i.prototype.DBt=function(t,n,i,r,e){for(var o,u,s,c,f,a,h,a,l,d,v,c,o=this,u=t.fieldExtra,s=t.field,l=0,d=i.length;l<d;l++)f=(a=i[l]).result,h=a.key,(0,E.isUndefined)(h)&&(v=a.value,t.field.addKey(v,a.recordRowNumbers[0]),c=t.field.getMap(),h=a.key=c[v]),a=t.sliceFields[h],(0,E.isUndefined)(a)&&(c=s.getValueByKey(h),(a=o.addSliceCategoryField((0,x.combineName)((0,E.isNullOrEmpty)(c)?" ":c,"s",n.name))).isGroup=!0,a.setFieldExtra(u),a.setFieldManager(o),t.sliceFields[h]=a,t.sliceKeys.push(a.key)),a.setData(f,r,e)},i.prototype._Bt=function(n,t,i,r){var e=this;return(0,x.isField)(n)?e.getFieldByName(n):(0,E.isFormula)(n)?e.EBt((0,x.combineName)(n,"".concat(r,"_formula_source")),t,n,i):(0,E.isRelation)(n)?new j.ColumnDataReaderField((0,x.combineName)(n,"".concat(r,"_related_source")),function(t){return e.fBt(n,t)},{value:n},e.hde.bind(e)):e.getFieldByName(n)},i.prototype.EBt=function(t,n,i,r){var e,t=this.xBt((0,x.combineName)(t,n),i);return t.evaluateFormulaBy(r),t},i.prototype.MGe=function(t){var n,i,t,n,i,t=h(this.bMt(t),!0);return t&&0<t.length?t[0]:null},i.prototype.buildGroupFields=function(t,c){var f=this,i,a,h=[];return t.forEach(function(t,n){var s,n,n;(0,E.isNullOrEmpty)(t.field)||(a=(0,E.isNullOrUndefined)(a)?i={}:a.group={},s=(0,x.combineName)(t.field,n),n=f._Bt(t.field,s,c,"group_field"),(n=f.addCategoryField(s,n)).setFieldExtra(t),n.setFieldManager(f),n.isGroup=!0,h.push(n.key),a.field=n,"boolean"==typeof t.ascending&&(a.sort=t.ascending?"asc":"desc"),(0,E.isNullOrUndefined)(t.summaryFields)||t.summaryFields.forEach(function(t,n){var n,i,r,r,i,e,o,u,o;(0,E.isNullOrEmpty)(t.formula)||(n=(0,x.combineName)(t.formula,n,s),(i=f.addCategoryFormulaField(n,t.formula,t.filter)).setFieldExtra(t),i.setFieldManager(f),(0,E.isNullOrEmpty)(t.position)||(i.extra.position=t.position),(0,E.isNullOrEmpty)(t.relateTo)?(r=f.MGe(t.formula),(0,E.isNullOrUndefined)(r)||(i.extra.relateTo=r)):i.extra.relateTo=t.relateTo,(0,E.isNullOrUndefined)(a.formulas)&&(a.formulas=[]),r=a.formulas.push(i)-1,i.isGroup=!0,h.push(i.key),(0,E.isNullOrUndefined)(t.slice))||(i=t.slice,o=(e=(0,E.isString)(i))?i:i.field,u=f._Bt(o,n,c,"slice"),(u=f.kBt((0,x.combineName)(o,"slice_category",n),u)).setFieldManager(f),(0,E.isNullOrUndefined)(a.slices)&&(a.slices=[]),o=f.NBt((0,x.combineName)(o,"slice_formula_result",n),t.formula),a.slices.push({field:u,formula:o,formulaIndex:r,sliceKeys:[],fieldExtra:e?{}:i,sliceFields:{},addSliceField:f.DBt.bind(f)}))}),(0,E.isNullOrUndefined)(t.windowOrderedFunctions))||(a.windowFunctionOptions=t.windowOrderedFunctions.map(function(t){return{orders:t.orders,fields:t.functions.map(function(t){return f.nM.XOt[t.windowOverFormula]})}}))}),f.groupFieldKeys=h,i},i.prototype.transposeSliceFields=function(i){var r=this,e,o;i.slices&&i.slices.forEach(function(t){var n,n,n=i.formulas[t.formulaIndex];e=r.groupFieldKeys.indexOf(n.key),o=t.sliceKeys,(0,E.isNullOrUndefined)(t.fieldExtra.sort)||(o=o.map(function(t){return r.getField(t)}).sort(C(t.fieldExtra.sort)).map(function(t){return t.key})),(n=r.groupFieldKeys).splice.apply(n,u([e+1,0],o,!1))}),i.group&&r.transposeSliceFields(i.group)},i.prototype.prepareFields=function(u){for(var s,c,f,t,n,i,r,e,o,a,o,h,l,d,v,p,w,b,m,s=this,c=[],f=0,t=0;f<u.length;f++,t++)if(i=y(n=u[f]),r=n.value,e=n.cross){if(a=(o=s.jBt(u,f)).crossColumnOptions,o=o.endColIndex,h=a.columns.length,0!==(l=s.OBt(a))){for(d=s.Pq.length-l,v=function(t,n){var i,r,i,e,o,i=d+t,r=f+n,i=s.Pq[i];i.setFieldExtra(u[r]),i.setFieldManager(s),e={value:i.name,name:i.name,Kyn:i.key,isCross:!0,RBt:r},i.isReadonly()&&(e.readonly=!0),(o=i.extra)&&(0,j.setFieldExtraProperties)(function(t){o[t]&&(e[t]=o[t])}),c.push(e),p=++t,w=n=h<=++n?0:n},m=b=0;b<l;)v(b,m),b=p,m=w;f=o,t+=l-1}}else s.gBt(i)?s.addDataBaseField(i,s.mBt(i),n):s.addReaderBaseField(i,r,n),c.push(u[f]);return g(c),c},i.prototype.jBt=function(t,n){var i,r,e,o,e,u,s,i=this,r=n,e=t[n],o=e.cross,e=i.BBt(o,[e],r);if("string"==typeof o){for(s=u=n;n<t.length&&!(++s<t.length&&o!==t[s].cross);)n++;e=i.BBt(o,t.slice(u,s),r)}return{crossColumnOptions:e,endColIndex:n}},i.prototype.BBt=function(t,n,i){var t="string"==typeof t?this.sBt.cross[t]:t;return{initialOptionIndex:i,crossKeys:n.map(function(t){return t.LBt}),cross:t,columns:n,lookup:this.FBt(t,n)}},i.prototype.FBt=function(n,t){var i=this;return t.every(function(t){return i.isValidCross(n,t.value)})&&this.bBt(n.over)},i.prototype.isValidCross=function(t,n){return m(this.nM,t,n)},i.prototype.OBt=function(t){var n=this,i=t.lookup,r=0;return(0,E.isArray)(i)?r=n.PBt(t):((0,E.isString)(i)||(0,E.isObject)(i))&&(r=n.GBt(t)),r},i.prototype.GBt=function(t){var n,i,r,e,o,u,s,c,f,a,h,t,l,d,v,p,w,l,b,i,m,j,y,g,_,O,S,C,R,F,I,N,M,F,N,n=this,i=t.cross,r=n.sBt.showCrossValueHeader,e=V(i.caption),o=0,u=T(t),s=i.over,c=A(s),f=s,a=i.attributes||[],h=a.length,t=L(a[0],!0),l=n.UBt(n.vBt(f),f),d=l.relationTableName||k(a[0]),v=l.relationTable||n.HBt(d),p=v.length(),w=l.relationPrimaryKey||n.zBt(d,c),l=i.filter?n.TBt(D(i.filter,t),v.POt):null;for((0,E.isNullOrUndefined)(l)||0<(i=l(null)).length&&(b=i.reduce(function(t,n){var i;return t["object"==typeof n?n[w]:n]=!0,t},{})),m=[],j=0;j<h;j++)y=A(a[j]),g=P(a[j]),m.push({fieldName:y,formatter:g});for(_=0;_<p;_++)if(O=v._getValueByField(w,_),(0,E.isNullOrUndefined)(b)||b[O]){for(S=e.slice(),j=0;j<h;j++)y=m[j].fieldName,C=v._getValueByField(y,_),g=m[j].formatter,(0,E.isNullOrUndefined)(g)||(C=(0,E.format)(C,g)),S.push(C);for(R=0;R<u.length;R++)I=(F=u[R]).valueRelation,N=F.valueCaption,M=F.valueIndex,F=F.valueCrossKey,N=r?S.concat(N):S,n.VBt({path:N,value:(0,x.combineName)(I,O,s,F),valueRelation:I,dimRelationPath:f,dimRelationKey:c,dimTableName:d,dimTableKeyFieldValue:O,initialOptionIndex:M}),o++}return o},i.prototype.PBt=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,w,m,n=this,i=t.cross,r=t.lookup,e=n.sBt.showCrossValueHeader,o=V(i.caption),u=0,s=T(t),c=i.over,f=A(c),a=c,h=r.length,l=0;l<h;l++)for(d=o.slice(),v=r[l],d.push(v),p=0;p<s.length;p++)b=(w=s[p]).valueRelation,m=w.valueCaption,j=w.valueIndex,w=w.valueCrossKey,m=e?d.concat(m):d,n.VBt({path:m,value:(0,x.combineName)(b,v,c,w),valueRelation:b,dimRelationPath:a,dimRelationKey:f,dimTableKeyFieldValue:v,initialOptionIndex:j}),u++;return u},i.prototype.setCrossFieldValues=function(t){var n,i,r,e,o,u,s,c,f,n=this,i=n.Pq,r=t.length,e=i.filter(function(t){return t instanceof j.CrossField});if(0<e.length)for(o=0;o<r;o++)for(u=t[o],s={},c=0;c<e.length;c++)f=e[c],n.YBt(f,u,s)},i.prototype.YBt=function(t,n,i){var r,e,o,u,r=this,e=t.dimRelationPath,o=i[e];if((0,E.isNullOrUndefined)(o)&&t.isOneToMany&&(o=i[e]=r.fBt(e,n)),(0,E.isArray)(o))for(u=0;u<o.length;u++)if(t.ZBt(o[u],t.dimTableKeyFieldValue)&&(0,E.isNullOrUndefined)(t.getValueIndex(n))){t.setValueIndex(n,u);break}},i.prototype.zBt=function(n,i){var t=this,r=t.dBt(function(t){return t.sourceFieldName===i&&t.sourceRelationshipName===n});return r?r.targetFieldName:(r=t.dBt(function(t){return t.targetFieldName===i&&t.targetRelationshipName===n}))?r.sourceFieldName:void 0},i.prototype.HBt=function(n){var t,i=this.dBt(function(t){return t.sourceRelationshipName===n||t.targetRelationshipName===n})||{},i=i.sourceRelationshipName===n?i.sourceField:i.targetField;return i?i.targetTable:{length:function(){return 0}}},i.prototype.UBt=function(t,n){return b(this.nM,t,n)},i.prototype.WBt=function(t){var n=this,t=new j.CrossField(t,n.fBt.bind(n),n.lBt.bind(n),n.hBt.bind(n));return n.ABt(t),n.CGe(t),t},i.prototype.VBt=function(t){var n,t,n,i,n,n=this,t=n.WBt(t);t.isReadonly()||(i=(n=r(n.oBt.bind(n),t)).isOneToMany,n=n.relationTemplate,i&&(t.isOneToMany=i,t.valueArrayRelation=n))},i.prototype.isCrossField=function(t){return t instanceof j.CrossField},i.prototype.clearCrossFieldData=function(){for(var t,n,i,r,t,n=this.Pq,i=0;i<n.length;i++)(r=n[i])instanceof j.CrossField&&r.clearData()},i.prototype.resetCrossFieldRowValues=function(t){for(var n,i,r,e,o,n=this,i=n.Pq,r={},e=0;e<i.length;e++)(o=i[e])instanceof j.CrossField&&(o.clearValue(t),n.YBt(o,t,r))},i.prototype.removeCrossFieldValues=function(t,n){for(var i,r,e,o,i,r=this.Pq,e=0;e<r.length;e++)(o=r[e])instanceof j.CrossField&&o.removeData(t,n)},i.prototype.setCrossFieldInsertedIndex=function(t,n,i){for(var r,e,o,u,s,r,e=this.Pq,o=L(t.valueRelation,!0),u=0;u<e.length;u++)(s=e[u])instanceof j.CrossField&&s.isOneToMany&&t.dimTableKeyFieldValue===s.dimTableKeyFieldValue&&(0,E.isNullOrUndefined)(s.getValueIndex(n))&&o===L(s.valueRelation,!0)&&s.setValueIndex(n,i)},t.FieldManager=i,t.getFieldNamesFrom=h,t.getLookupBy=v,t.isLookupField=o,t.isLookupListField=p,t.isLookupRelationField=w,t.isValidCross=m},"./dist/src/viewField/fields.js":function(t,n,i){"use strict";var r,c,s,i,e,o,u,f,e,a,h,l,d,v,p,w,b,m,j,y,g;function _(t){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit"].forEach(t)}function O(t){var n=(this.name=t).indexOf(s.FieldNameDelimiter);-1<n&&(t=t.slice(0,n)),this.fieldValue=t}function S(t,n){var t=v.call(this,t)||this;return t.data=n||[],t}function C(t,n,i){var t=p.call(this,t,n)||this;return t.column=i,t}function R(t,n,i,r){var t=w.call(this,t)||this;return t.column=i,t.setFieldExtra(i),t.getValue=n,t.getLength=r,t}function F(t,n,i){var t=b.call(this,t)||this;return t.setFieldExtra({value:n}),t.formula=n,t.P6t=i,t}function I(t,n){return t._error||t._code?"Calc Error ".concat(n,":").concat(t._error,",").concat(t._code):t}function N(t,n){var t=m.call(this,t)||this;return t.QBt=n,t.KBt={},t.Oit=[],t}function M(t,n,i,r,e){var t=j.call(this,t)||this;return t.P6t=i,t.formula=n,t.filter=r,t.filterExpression=e,t}function E(t){return y.call(this,t)||this}function x(t,n,i,r){var e=g.call(this,t.value)||this;return e.path=t.path,e.valueRelation=t.valueRelation,e.valueField=-1<t.valueRelation.indexOf(".")?t.valueRelation.split(".").pop():t.valueRelation,e.dimRelationPath=t.dimRelationPath,e.dimRelationKey=t.dimRelationKey,e.dimTableName=t.dimTableName,e.isDateDimValue=t.dimTableKeyFieldValue instanceof Date,e.dimTableKeyFieldValue=e.isDateDimValue?t.dimTableKeyFieldValue.getTime():t.dimTableKeyFieldValue,e.initialOptionIndex=t.initialOptionIndex,e.getValueByField=T(t,r,n),e.getOriginalValueByField=T(t,r,i),e.data=[],e}function T(t,i,r){return(0,c.isFunction)(t.valueRelation)?function(t,n){return(0,c.isFunction)(t)?t(i(n)):r(t,n)}:r}r=this&&this.__extends||(d=function(t,n){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.CrossField=n.SliceCategoryField=n.CategoryFormulaField=n.CategoryField=n.FormulaField=n.ColumnDataReaderField=n.ColumnDataField=n.DataField=n.Field=n.setFieldExtraProperties=void 0,c=i("./dist/src/dataSource/utils.js"),s=i("./dist/src/viewField/utils.js"),n.setFieldExtraProperties=_,O.prototype.setFieldExtra=function(n){var i,t,i=this;(0,c.isUndefined)(i.extra)&&(i.extra={}),(0,c.isNullOrUndefined)(n)||(n.field&&(i.fieldValue=n.field),_(function(t){i.JBt(t,n)}),(0,c.isNullOrUndefined)(n.caption)&&0<=(t=i.name.indexOf(s.FieldNameDelimiter))&&(i.extra.caption=i.name.substring(0,t)),(0,c.isNullOrUndefined)(n.spacing))||(i.extra.spacing=n.spacing)},O.prototype.JBt=function(t,n){var i=this,n=n[t];(0,c.isNullOrUndefined)(n)||(i.extra[t]=n)},O.prototype.setFieldManager=function(t){this.fieldManager=t},O.prototype.getFieldManager=function(){return this.fieldManager},O.prototype.getValue=function(t){return this.data[t]},O.prototype.getOriginalValue=function(t){return this.getValue(t)},O.prototype.getLength=function(){return this.data.length},O.prototype.XBt=function(t,n,i,r){var e,o,u,s,e=this;if(e.data||(e.data=[]),i=(0,c.isNumber)(i)?i:0,r=(0,c.isNumber)(r)?r:t.length-1,(0,c.isArray)(n))for(u=0,s=n.length;i<=r&&u<s;u++)o=t[i=u+i],e.data[o]=n[u];else for(u=i;u<=r;u++)o=t[u],e.data[o]=n;return e.data},O.prototype.qBt=function(t,n){var i,r,e,o,i=this;for(i.data||(i.data=[]),e=0,o=t.length;e<o;e++)r=t[e],i.data[r]=n(r);return i.data},n.Field=i=O,r(S,v=i),n.DataField=e=S,r(C,p=e),n.ColumnDataField=C,r(R,w=i),n.ColumnDataReaderField=R,r(F,b=e),F.prototype.evaluateFormulaBy=function(t){var n=this,i=n.formula,r=n.P6t;return n.qBt(t,function(t){return I(r(t),i)})[t[0]]},n.FormulaField=F,r(N,m=i),N.prototype.getKey=function(t){return this.KBt[t]},N.prototype.getMap=function(){return this.KBt},N.prototype.getValueByKey=function(t){return this.Oit[t]},N.prototype.$Bt=function(t,n){this.KBt[n]=t,this.Oit[t]=n},N.prototype.getValue=function(t){var n=this;return n.data&&0<n.data.length?n.Sl(t):n.QBt?n.QBt.getValue(t):void 0},N.prototype.Sl=function(t){var n=this;return n.Oit[n.data[t]]},N.prototype.addKey=function(t,n){var i=this,r=i.getKey(t);return(0,c.isUndefined)(r)&&i.$Bt(r=n,t),r},N.prototype.getSourceField=function(){return this.QBt},n.CategoryField=e=N,r(M,j=e),M.prototype.evaluateFormulaBy=function(t,n,i){var r,e,i,r=this,e=0;return(0,c.isNullOrUndefined)(i)&&(i=t,e=n||0),i=r.P6t(i,e),r.XBt(t,r.addKey(i,t[n]),n),i},n.CategoryFormulaField=M,r(E,y=e),E.prototype.setData=function(t,n,i){var r=this,t=r.addKey(t,n[i]);r.XBt(n,t,i)},n.SliceCategoryField=E,r(x,g=i),x.prototype.setFieldExtra=function(t){g.prototype.setFieldExtra.call(this,t),this.extra.caption=this.path},x.prototype.ZBt=function(t,n){var i,r;return this.isDateDimValue&&t instanceof Date?t.getTime()===n:t===n},x.prototype.tLt=function(t,n){var i=this,r=i.isOneToMany,e=i.dimRelationPath,o=i.dimTableKeyFieldValue;return!r&&i.ZBt(n(e,t),o)?t:this.data[t]},x.prototype.getDimValue=function(){var t=this,n=t.isDateDimValue,t=t.dimTableKeyFieldValue;return n?new Date(t):t},x.prototype.getValueIndex=function(t){return this.tLt(t,this.getValueByField)},x.prototype.setValueIndex=function(t,n){this.data[t]=n},x.prototype.clearData=function(){this.data=[]},x.prototype.clearValue=function(t){this.data[t]=void 0},x.prototype.removeData=function(t,n){this.data.splice(t,n)},x.prototype.isReadonly=function(){return(0,c.isFormula)(this.valueRelation)||(0,c.isFunction)(this.valueRelation)},x.prototype.Sl=function(t,n){var i,r,e,o,i,u,i=this,r=i.isOneToMany,e=i.valueArrayRelation,o=i.valueRelation,i=i.tLt(t,n);if((0,c.isNumber)(i))return u=void 0,n(u=r?e.replace(s.RelationTemplateToken,i+1):o,t)},x.prototype.getValue=function(t){return this.Sl(t,this.getValueByField)},x.prototype.getOriginalValue=function(t){return this.Sl(t,this.getOriginalValueByField)},x.prototype.getRelationField=function(t){var n=this,i=n.isOneToMany,r=n.valueArrayRelation,e=n.valueRelation,n=n.getValueIndex(t);return i?(0,c.isNumber)(n)?r.replace(s.RelationTemplateToken,n+1):void 0:e},n.CrossField=x},"./dist/src/viewField/groupManager.js":function(t,n,i){"use strict";var e,l,o,u,s,c,r;function f(t,n){var i,r,e,o,u;if((0,l.isNullOrUndefined)(t)||(0,l.isNullOrUndefined)(n))return t===n;if(i=Object.keys(t),r=Object.keys(n),i.length!==r.length)return!1;for(e=0,o=i;e<o.length;e++)if(t[u=o[e]]!==n[u])return!1;return!0}function a(t){for(var n,i,r,n=[],i=t.split(o.FieldNameDelimiter).reverse(),r=0;r<i.length;r+=2)n.push(i[r]);return n}function h(t){return 1===a(t).length}function d(t){return 2===a(t).length}function v(t){return 3===a(t).length}function p(t){return 2===t.split(o.FieldNameDelimiter).length}function w(t){var t=t.split(o.FieldNameDelimiter);return t[t.length-2]}function b(t,n,i,r,e){this.LEt=t,this.wEt=n,this.wwn=r||function(){},this.xwe=e||function(){return[]};var t=this.fCe=new s.DataManagerProxy(i);this.Vhe=new u.DataManagerReportGroupHelper(t,void 0,void 0,new c.DataManagerReportSortHelper(t))}e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.GroupManager=n.getGroupFieldName=n.isGroupField=n.isGroupSlice=n.isGroupSummary=n.isGroupCategory=n.getGroupOptionIndexesFrom=void 0,l=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/viewField/utils.js"),u=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-group-helper.js"),s=i("./dist/src/data-manager-report/data-manager-proxy/data-manager-proxy.js"),c=i("./dist/src/data-manager-report/tree-data-generator/helpers/data-manager-report-sort-helper.js"),n.getGroupOptionIndexesFrom=a,n.isGroupCategory=h,n.isGroupSummary=d,n.isGroupSlice=v,n.isGroupField=p,n.getGroupFieldName=w,b.prototype.dl=function(){this.fCe.clearTableDataCache()},b.prototype.isGrouped=function(t){return f(t,this.LEt)},b.prototype.groupBy=function(t,n){var i,r,e,o,i=this,r=i.Yhe(t),e,o={childrenArray:[this.Vhe.generateCellNodeTreeData(r,void 0,void 0,n,void 0,void 0,{ignoreMultipleTableJoinCache:!0})]};return{rootNode:o,indexMap:i.eLt(n,function(){return i.iLt(t,o)})}},b.prototype.Yhe=function(t){var n,i,r,e,i=this,r,e=(t.field.getSourceField()||t.field).fieldValue;return{templateCell:{sorts:t.sort?[((n={})[t.sort]=e,n)]:void 0,dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:e}},data:{groups:[]},field:t.field,group:t.group,children:t.group?[this.Yhe(t.group)]:[],slices:t.slices&&t.slices.length?t.slices.map(function(t){return i.Zhe(t)}):[],formulas:t.formulas}},b.prototype.Zhe=function(t){var n,i,r,n=e({},t),i,r=(n.field.getSourceField()||n.field).fieldValue;return n.templateCell={dataColumn:{tableName:t.field.fieldManager.getTable().name,columnName:r}},n.children=[],n.data={groups:[]},n},b.prototype.eLt=function(t,n){var i,r,r,i=this,r=i.LEt;return i.DJ={path:[],groupOptions:r,entireScope:t},i.wEt("groupContext",i.DJ),r=n(),i.DJ=null,i.wEt("groupContext"),r},b.prototype.iLt=function(t,n){for(var i,r,e,o,u,s,i=this,r,e=[],o=0,u=n.childrenArray&&n.childrenArray[0];o<u.length;o++)s=u[o],i.aLt(s,t,e);return e},b.prototype.aLt=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,r=this,e=i.length,o=t.recordRowNumbers;if(r.uLt(t),t.childrenArray&&t.childrenArray[0]&&0!==t.childrenArray[0].length)for(a=c=t.childrenArray[f=0];f<a.length;f++)h=a[f],r.aLt(h,n.group,i);else{for(u=0,s=o.length;u<s;u++)i[e+u]=o[u];t.key=n.field.addKey(t.value,i[e])}if(r.SGe(t,r.sLt(n.formulas,i,e)),r.dde(n.windowFunctionOptions,i,e),t.slices)for(u=0,d=(l=t.slices).length;u<d;u++){for(v=l[u],w=(p=n.slices[u]).formula,b=0,m=c=v.childrenArray&&v.childrenArray[0];b<m.length;b++)(h=m[b]).result=r.cLt(w,h.recordRowNumbers);p.addSliceField(p,n.formulas[p.formulaIndex],c,i,e)}r.fLt()},b.prototype.SGe=function(t,n){n&&(t.summaryResults=n)},b.prototype.Iwe=function(t,n,i){var r=t.filter;if(!(0,l.isNullOrEmpty)(r))return this.xwe(t.filterExpression,n,i)},b.prototype.Nwe=function(t,n,i){for(var r,e,o,u,s,c,f,r=[],u=0,s=t.length;u<s;u++)f=(c=t[u]).filter,(0,l.isNullOrEmpty)(f)||(e!==f?(e=f,o=r[u]=this.xwe(c.filterExpression,n,i)):r[u]=o);return r},b.prototype.sLt=function(t,n,i){var r,e,o,u,s,c,f,e,r,a,h,h;if(t)for(o={},u=this.Nwe(t,n,i),s=0,c=t.length;s<c;s++)e=(f=t[s]).extra&&f.extra.position,r=f.formula,a=f.extra&&f.extra.relateTo,o[r]?(h=o[r][e],(0,l.isNullOrUndefined)(h)&&(o[r][e]=h={}),(0,l.isNullOrUndefined)(h[a])&&(h[a]=f.extra)):(h=f.evaluateFormulaBy(n,i,u[s]),o[r]=((r={value:h})[e]=((e={})[a]=f.extra,e),r));return o},b.prototype.cLt=function(t,n){var i;if(t)return i=this.Iwe(t,n),t.evaluateFormulaBy(n,void 0,i)},b.prototype.dde=function(t,n,i){var r,e,o,u,s,c,f,a,h;if(t)for(r=this,e=0,o=t.length;e<o;e++)for(s=(u=t[e]).orders,c=u.fields,(0,l.isArray)(s)&&0<s.length&&r.wwn(n,s,i),f=0,a=c.length;f<a;f++)(h=c[f]).evaluateWindowFunction(n,i)},b.prototype.uLt=function(t){this.DJ.path.push(t)},b.prototype.fLt=function(){this.DJ.path.pop()},n.GroupManager=b},"./dist/src/viewField/utils.js":function(t,i){"use strict";function n(){for(var t,n,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.join(i.FieldNameDelimiter)}function r(t){return-1<t.indexOf(i.FieldNameDelimiter)}Object.defineProperty(i,"__esModule",{value:!0}),i.isField=i.combineName=i.RelationTemplateToken=i.CaptionDelimiter=i.FieldNameDelimiter=void 0,i.FieldNameDelimiter="__",i.CaptionDelimiter="\\",i.RelationTemplateToken="{{}}",i.combineName=n,i.isField=r},"./dist/src/viewField/viewField.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/viewField/groupManager.js"),n),e(i("./dist/src/viewField/fieldManager.js"),n),e(i("./dist/src/viewField/fields.js"),n),e(i("./dist/src/viewField/utils.js"),n)},"./dist/src/view/view-cross.js":function(t,n,i){"use strict";var n,r,u,e,w,i,s;Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/view/view.js"),u=i("./dist/src/dataSource/utils.js"),e=i("./dist/src/viewField/fieldManager.js"),w=i("./dist/src/undo/interface.js"),i=n.Common.lt.Dh,s=void 0,i(r.View.prototype,{YBt:function(){var t=this;t.lLt.setCrossFieldValues(t.iRt)},hLt:function(){var t=this;t.lLt&&(t.lLt.clearCrossFieldData(),t.YBt())},dLt:function(t,n){var i=this;i.lLt&&i.lLt.removeCrossFieldValues(t,n)},vLt:function(t){var n=this;n.lLt&&n.lLt.resetCrossFieldRowValues(t)},mLt:function(t,n){var i,r;return"string"==typeof t&&(i=!0,r=t,i=!(!(0,u.isNullOrUndefined)(this.LEt.cross)&&(t=this.LEt.cross[r],!(0,u.isNullOrUndefined)(t)))&&i)&&(t={over:r,attributes:[""]}),(0,e.isValidCross)(this.gLt,t,n)},pLt:function(){return this.bLt()&&(0,u.isNullOrUndefined)(this.lLt)},bLt:function(){return this.yLt.some(function(t){return t.cross})},wLt:function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,v,p;for(void 0===n&&(n=!0),i=this,r=[],e=function(n,t){r.push({newIndex:t,columnInfos:i.yLt.filter(function(t){return t.RBt===n}),fields:i.lLt?i.lLt.getFields(function(t){return t.initialOptionIndex===n}):[]})},o=0,u=t;o<u.length;o++)e(c=(s=u[o]).oldIndex,f=s.newIndex);for(a=function(t,n,i){t.forEach(function(t){return t.RBt=i}),n.forEach(function(t){return t.initialOptionIndex=i})},h=0,l=r;h<l.length;h++)a(v=(d=l[h]).columnInfos,p=d.fields,f=d.newIndex);n&&this.AGe.nGe({type:w.ViewChangeType.UpdateCrossColumnIndex,data:t})},MLt:function(){var n=this,t;return n.CLt.map(function(t){return n.SLt(t)})},TLt:function(t,n){var i,r,e,e,o,u,o,u,s,o,i=this,r=i.MLt(),e=i.ALt(r);if(0<e.length&&(t=e[t],n=e[n]),(e=i.ILt[t])&&"string"==typeof e.cross){if(o=i.ILt[t-1]||{},u=i.ILt[t+1]||{},o.cross===e.cross||u.cross===e.cross)return!0;if(o=i.ILt[n],u=i.ILt[t<n?n+1:n-1]||{},o.cross===e.cross||u.cross===e.cross)return!0}return s=function(t,n){return-1<r.indexOf(t)?s(t+n,n):t},(o=function(t,n){var t=i.ILt[s(t,-1)]||{},n=i.ILt[s(n,1)]||{};if("string"==typeof t.cross&&t.cross===n.cross)return!0})(t-1,t+1)||(t<n?o(n,n+1):o(n-1,n))},xLt:function(t){for(var i,r,n,e,o,i=this,r=0,n=function(t){return t&&0===t.length?s:t},e={lastFilterInfo:(0,u.clone)(i.NLt),lastSortInfo:(0,u.clone)(i.kLt),lastSortInfoBeforeGroup:(0,u.clone)(i.DLt),lastSortInfoAfterGroup:(0,u.clone)(i._Lt),columnInfos:(0,u.clone)(i.yLt)},o=function(){var n=i.yLt[r];n.RBt===t?(i.NLt=i.NLt&&i.NLt.filter(function(t){return t.field!==n.value}),i.kLt=i.kLt&&i.kLt.filter(function(t){return t.field!==n.value}),i.DLt=i.DLt&&i.DLt.filter(function(t){return t.field!==n.value}),i._Lt=i._Lt&&i._Lt.filter(function(t){return t.field!==n.value}),i.yLt.splice(r,1),i.lLt&&i.lLt.removeFields(r,1,function(t){var n;e.fields=null!=(n=e.fields)?n:t})):r++};r<i.yLt.length;)o();i.NLt=n(i.NLt),i.kLt=n(i.kLt),i.DLt=n(i.DLt),i._Lt=n(i._Lt),this.AGe.nGe({type:w.ViewChangeType.RemoveCrossFields,oldData:e})},gGe:function(t){var n,i,r,e,o,u,t,n=this,i=t.lastFilterInfo,r=t.lastSortInfo,e=t.lastSortInfoAfterGroup,o=t.lastSortInfoBeforeGroup,u=t.fields,t=t.columnInfos;n.NLt=i,n.kLt=r,n._Lt=e,n.DLt=o,n.yLt=t,u&&n.lLt.yGe(u)},ELt:function(){var i=this;i.ILt.forEach(function(t,n){(0,u.isNullOrUndefined)(t.cross)||((0,u.isNullOrUndefined)(t.LBt)&&(t.LBt=n),i.yLt[n].LBt=t.LBt)})}})},"./dist/src/view/view-event.js":function(t,n,i){"use strict";var n,O,w,i,n,r,b;function a(n){var t,i,r,e,o,u,s,t=[],i=[],r=Object.keys(w.Events);if((0,O.isArray)(n))for(e=function(n){(r.some(function(t){return t===n})?t:i).push(n)},o=0,u=n;o<u.length;o++)e(s=u[o]);else(r.some(function(t){return t===n})?t:i).push(n);return[t,i]}Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),O=i("./dist/src/dataSource/utils.js"),w=i("./dist/src/table/tableEvents.js"),i=i("./dist/src/view/view.js"),n=n.Common.lt.Dh,r=null,b=void 0,n(i.View.prototype,{bind:function(t,n){var i=this,t=a(t),r=t[0],t=t[1];0<t.length&&(i.jLt(t,n),this.gLt.bind(t,n)),0<r.length&&this.D3(r,this.OLt(n),n)},D3:function(t,n,i){var r,n,r=this,n=r.RLt(n);r.jLt(t,n,null,i),r.gLt.bind(t,n)},unbind:function(t,n){var i,r,e,o,u,s,c,f,i=this,r=a(t),e=r[0],o=r[1];if(0<o.length)for(i.nge(o,n),u=0;u<o.length;u++)s=o[u],this.gLt.unbind(s,n);if(0<e.length&&(c=this.nge(e,null,null,n),i.gLt))for(f=0;f<c.length;f++)i.gLt.unbind(t,c[f])},ki:function(t,n){return this.gLt.ki(t,n)},vOt:function(t){return this.gLt.vOt(t)},Dge:function(t){for(var n,i,t,r,e,o,u,s,n=this,i=n.gLt.name,t=(0,O.isArray)(t)?t:[t],r=n.BLt[i]=n.BLt[i]||{},e=[],o=0,u=t;o<u.length;o++)s=u[o],e=e.concat(r[s]||[]);return e},jLt:function(t,n,i,r){var e,o,u,s,c,f,a,h,h,f,e=this;if(n)for(o=(i||e.gLt).name,c=u=(s=0,O.isArray)(t)?t:[t];s<c.length;s++)f=c[s],(a=(0,O.isFunction)(n)?n:n[f])&&(h=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[],(0,O.isNullOrUndefined)(r)||(f=(0,O.isFunction)(r)?r:r[f],a.ege=f),h.push(a))},nge:function(t,n,i,r){var e,o,i,u,s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,_,e=this,o=(i||e.gLt).name,i=(0,O.isArray)(t)?t:[t],u=[];if((0,O.isNullOrUndefined)(r))if(n)for(s=0,c=i;s<c.length;s++)f=c[s],(a=(0,O.isFunction)(n)?n:n[f])&&-1<(d=(l=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[]).indexOf(a))&&(u=u.concat(l.splice(d,1)));else for(v=0,p=i;v<p.length;v++)for(f=p[v],l=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[],h[f]=[],w=0;w<l.length;w++)b=l[w],u.push(b);else for(m=0,j=i;m<j.length;m++){for(f=j[m],l=(h=e.BLt[o]=e.BLt[o]||{})[f]=h[f]||[],y=[],g=(0,O.isFunction)(r)?r:r[f],w=0;w<l.length;w++)(b=l[w]).ege===g&&y.push(w);for(_=y.length-1;0<=_;_--)u=u.concat(l.splice(d=y[_],1))}return u},OLt:function(o){var u=this;return function(t,n){var i,r,e;if(u.LLt(n),(0,O.isArray)(o))for(i=0,r=o;i<r.length;i++)(e=r[i]).call(u,t,n);else o&&o.call(u,t,n)}},LLt:function(t){var n=this;t.hasOwnProperty("row")||Object.defineProperty(t,"row",{get:function(){return(0,O.isNumber)(t.Ky)||(t.Ky=n.FLt(t.index)),t.Ky}})},RLt:function(i){var r=this;return function(t,n){r.PLt()&&i.call(r,t,n)}},PLt:function(t){return!0===t?this.rb--:!1===t&&this.rb++,this.rb=Math.max(this.rb,0),this.rb<1},GLt:function(n,i){var r=this;return r.PLt(!1),{success:function(t){r.PLt(!0),n&&n(t)},fail:function(t){r.PLt(!1),i&&i(t)}}},v7:function(){var e=this;e.D3(w.Events.ItemInserting,function(t,n){var i=n.index,n=n.data;e.ULt(n),i===e.length()&&e.Dit()&&e.HLt(n,i)}),e.D3(w.Events.ItemInserted,function(t,n){var i=n.index,n=n.data;e.zLt(i,n)}),e.D3(w.Events.ItemUpdating,function(t,n){var i=n.data,r=n.index,n=n.originalData;e.kwe(i,n,r)}),e.D3(w.Events.ItemUpdated,function(t,n){var i=n.data,r=n.index,n=n.originalData;e.YLt(i,n,r)}),e.D3(w.Events.ItemReset,function(t,n){var i=n.index,r=n.originalData,n=n.dataBeforeChanged;e.ZLt(i,r,n)}),e.D3(w.Events.ItemRemoved,function(t,n){var i=n.index,n=n.count;e.WLt(i,n)}),e.D3(w.Events.ChangesSubmitted,function(t,n){e.QLt()}),e.D3(w.Events.ChangesCancelled,function(t,n){e.KLt(n.isDataLengthChanged)})},wpt:function(){var t,n,i,r,e,o,u,s,c,f,t=this,n=t.BLt;for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])if(r.hasOwnProperty(e))for(u=0,s=o=r[e];u<s.length;u++)c=s[u],(f=t.gLt.QOt.tables[i])&&f.unbind(e,c);t.BLt={}},$Ot:function(t){var n,i,r,e,o,u,s,c,f,n,i=this.BLt,r=t.name,e=i[r];for(o in e)if(e.hasOwnProperty(o))for(s=0,c=u=e[o];s<c.length;s++)f=c[s],t&&t.unbind(o,f);i[r]=b},KOt:function(t,n){var i,r,e,i,r=this.BLt,e=r[t];delete r[t],r[n]=e},jge:function(t,n){for(var i,r,e,o,u,i=this,r,e=0,o=i.Dge(n.eventName);e<o.length;e++)u=o[e],(0,O.isNullOrUndefined)(u.ege)||u.call(i,t,n)},JLt:function(){var t,n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w;if(this.XLt()){for(i=(n=t=this).name,r=t.yLt,e=t.gLt,o=[],u=0,s=r;u<s.length;u++)if(c=s[u],(0,O.isFunction)(c.value)||(0,O.isFormula)(c.value)||!(0,O.isRelation)(c.value)){if(0<(f=this.gLt.Gbe(c.value)).length)for(a=0,h=f;a<h.length;a++)l=h[a],this.gLt.MHe(l,o)}else o.push(c.value);for(d=0,v=o;d<v.length;d++)w=e.qRt(p=v[d]),!(0,O.isNullOrUndefined)(w)&&(0,O.isNullOrUndefined)(w.VOt[i])&&(w.VOt[i]=n,t.qLt(w))}},qLt:function(i){var v,p,t,l,d,t,o,v=this,p=v.gLt,t=p.QOt.relationships.reduce(function(t,n){return n.sourceTable===p&&n.targetTable===i?{relationshipName:n.sourceRelationshipName,relationFieldName:n.sourceFieldName}:n.sourceTable===i&&n.targetTable===p?{relationshipName:n.targetRelationshipName,relationFieldName:n.targetFieldName}:t},{}),l=t.relationshipName,d=t.relationFieldName,t=function(t,h){var n=v.RLt(function(o,u){var i,t,n,s,n,r,e,c,f,a,n,i=function(t,n){var t=t.value.split(".");return t[t.length-1-n]},t=v.ILt.filter(function(t){return(0,O.isRelation)(t.value)&&i(t,1)===l}),n=t;if(u.eventName!==w.Events.ItemUpdating&&u.eventName!==w.Events.ItemUpdated||(n=n.filter(function(n){return u.changingFields.some(function(t){return i(n,0)===t})})),s=[b],n.forEach(function(n){var t,i,r,e,t=!(0,O.isNullOrUndefined)(n.cross);t?(r=("string"==typeof n.cross?v.LEt.cross[n.cross]:n.cross).over,(0,O.isNullOrUndefined)(v.NLt)||-1<(e=(0,O.findIndex)(v.NLt,function(t){return-1<t.field.indexOf(n.value)&&-1<t.field.indexOf(r)}))&&(i=v.NLt[e].field)):v.$Lt(n.value)&&s.push(n.value),h.call(v,n.value,t,i)(o,u)}),u.eventName===w.Events.ItemInserted||u.eventName===w.Events.ItemRemoved||u.eventName===w.Events.ItemUpdated){if(u.eventName===w.Events.ItemUpdated&&(n=u.changingFields.some(function(t){return d===t}),r=t.some(function(t){if(!(0,O.isNullOrUndefined)(t.cross)){var n=("string"==typeof t.cross?v.LEt.cross[t.cross]:t.cross).over.split(".").pop();if(u.changingFields.some(function(t){return n===t}))return!0}return!1}),n||r))for(f=e=p.nBt(t[c=0].value,u.index);c<f.length;c++)a=f[c],v.vLt(a);(0<(n=v.Cde(!0))[0].length||0<n[1].length)&&v.pme(),v.tFt(b,!0,s,b)}v.jge(o,u)});v.jLt(t,n,i),i.bind(t,n)},o=function(t,n,i,r){var e,e,e,o,u,s,c,f,a,h,a,l,d;if(v.Dit())for(u=0,s=o=r.relatedViewIndexes||p.nBt(t,r.index);u<s.length;u++)c=s[u],h=a=f=void 0,h=n?(v.vLt(c),f=p.LRt(i,c),(e={})[i]=f,a=e,v.nFt(c,((e={})[i]=!0,e))[i]):(f=p.LRt(t,c),(e={})[t]=f,a=e,p._getValueByField(t,c)),a=v._we(c,a),v.iFt(a,f,t,c),v.hRt(c,t,f,h),p.hRt(c,t,f,h);else if(n)for(l=0,d=o=r.relatedViewIndexes||p.nBt(t,r.index);l<d.length;l++)c=d[l],v.vLt(c)};t(w.Events.ItemRemoving,function(i,r){return function(t,n){r&&(n.relatedViewIndexes=p.nBt(i,n.index))}}),t(w.Events.ItemRemoved,function(i,r,e){return function(t,n){o(i,r,e,n)}}),t(w.Events.ItemInserted,function(i,r,e){return function(t,n){o(i,r,e,n)}}),t(w.Events.ItemUpdating,function(f,a,h){return function(t,n){var i,i,r,e,o,u,s,c,c;if(v.Dit())for(r=n.relatedViewIndexes=p.nBt(f,n.index),n.relatedViewValues=[],e=0,o=r;e<o.length;e++)u=o[e],c=s=void 0,a?s=(c=v.nFt(u,((i={})[h]=!0,i)))[h]:(s=p._getValueByField(f,u),(i={})[f]=s,c=i),c=v._we(u,c),n.relatedViewValues[u]=s,v.iFt(c,s,f,u)}}),t(w.Events.ItemUpdated,function(f,a,h){return function(t,n){var i,r,e,o,u,s,c;if(v.Dit())for(e=0,o=r=n.relatedViewIndexes||p.nBt(f,n.index);e<o.length;e++)u=o[e],s=n.relatedViewValues[u],c=void 0,a?(c=v.nFt(u,((i={})[h]=!0,i))[h],f=h):c=p._getValueByField(f,u),v.hRt(u,f,s,c),p.hRt(u,f,s,c)}})}})},"./dist/src/view/view-filter.js":function(t,n,i){"use strict";var m,o,v,n,d,r;function p(t){return e(t[0])}function e(t){return t&&void 0!==t.Vce}function u(t,n){for(var i,r,e,o,u,s,c,i=["field","value","operator","relation"],r=t[0],e=[],o=0;o<i.length;o++)r.hasOwnProperty(u=i[o])&&e.push(u);for(s=0,c=t.length;s<c;s++)if(!f(t[s],n[s],e))return;return 1}function f(t,n,i){var r,e;for(i=i||["field","value","operator","relation"],r=0;r<i.length;r++)if(t[e=i[r]]!==n[e])return;return t.ort===n.ort}function w(t,n){for(var i,r,e,o,u,i={},r=0;r<t.length;r++)if(!i[e=t[r].field]){for(o=i[e]=[],u=r;u<t.length;u++)t[u].field===e&&o.push(t[u]);n(e,o)}}Object.defineProperty(n,"__esModule",{value:!0}),m=i("./dist/src/dataSource/utils.js"),o=i("./dist/src/table/table.js"),v=i("./dist/src/view/view-util.js"),n=i("Common"),d=i("./dist/src/view/view.js"),(r=n.Common.lt.Dh)(d.View.prototype,{buildInFilter:function(s){var c,f,a,h,t,l,n,i,r,e,i,o,u,c=this.gLt,f={};if(1<s.length){for(a=[],h=[],t=function(r){var t,n,i,e,t,o,u,t=s[r],n=t.field,i=t.operator,e=t.value,t=t.relation,o=f[n];o=o||(f[n]=c.jRt(n)),h.push(t),u=(0,d.rFt)(l.gLt,l.yLt,l.lLt,n,s[r]),u=(0,v.mapGetValueFunc)(o,u),u=(0,v.oFt)(l,i,e,u),a.push(function(t,n,i){return u(t,i,n[r])})},l=this,n=0;n<s.length;n++)t(n);return(0,v.aFt)(a,h)}return r=(i=s[0]).field,e=i.operator,i=i.value,o=c.jRt(r),u=(0,d.rFt)(this.gLt,this.yLt,this.lLt,r,s[0]),u=(0,v.mapGetValueFunc)(o,u),u=(0,v.oFt)(this,e,i,u,r),function(t,n,i){return u(t,i,n[0])}},uFt:function(t){var n=this,i=n.ZOt,r;return n.gLt.ZOt[t]||i[t]},eRt:function(t,n){var i=this,r=i.gLt,e=i.yLt,o,u=[],s=[];t.forEach(function(n){(o=e.filter(function(t){return t.value===n})[0])&&((0,v.isViewColumn)(o)?u:s).push(n)}),r.eRt(s,n),i.sFt(u)},sFt:function(t){for(var n,i,r,e,o,n,i=this.ZOt,r=0,e=t;r<e.length;r++)i[o=e[r]]||(i[o]=this._Rt(o))},cFt:function(t){var n=this;t?(delete n.ZOt[t],n.gLt.ARt(t)):n.ZOt={}},_Rt:function(t){var n=this.lLt.getFieldByName(t);return(0,o.generateFilterIndexCache)(t,(0,m.isNullOrUndefined)(n)?0:this.length(),this.jRt(t),function(t){return n.getValue(t)})},cRt:function(t,n){var i=this,r,e=i.gLt._dataSource.options.schema;i.Yce(t),(0,o.updateFilterIndexesCacheOnInsert)(this.ZOt,t,n,e&&e.columns)},hRt:function(t,n,i,r){var e=this;e.Yce(t,!1,n),e.fge(n),(0,o.updateFilterIndexesCacheOnUpdate)(e.ZOt,t,n,i,r,e.jRt(n))},pRt:function(t,n,i){var r,e,o,u,s,s,r=this,e=r.yLt;if(!(0,m.isNullOrUndefined)(n)&&!(0,m.isNullOrUndefined)(i))for(o=0,u=e;o<u.length;o++)s=(s=u[o]).value instanceof Function?s.value.name:s.value,r.hRt(t,s,n[s],i[s])},MRt:function(t,n){var i=this;i.Zce(t,n),(0,o.updateFilterIndexesCacheOnRemove)(i.ZOt,t,n)},fFt:function(t){var i,r,e,n,o,u,s,c,f,a,h,l,d;if(t){if(r=(i=this).iRt,e=[],o=(n=i.lFt).length,n&&0<o&&(e=r.slice(0,o)),u=o,"string"==typeof t)for(s=i.Ywt(t,0,0),c=o;c<r.length;c++)f=r[c],!0===i.nMt(s,f,0)&&(e[u]=f,u++);else if("function"==typeof t)for(c=o;c<r.length;c++)f=r[c],t(i.getRowData(f,!0))&&(e[u]=f,u++);else{if(r.length!==i.length())return i.Wce(),void i.Qce(t,e,r);for(d in(0,m.isArray)(t)||(t=[t]),(0,m.isNullOrUndefined)(i.Jce)&&(i.Jce={}),a=i.isHierarchy(),i.qce(t,function(t,n){i.Qce(n,e,r.slice()),a&&p(n)&&i.afe(n),i.tfe(t,n)}),h=[],l=function(n){t.some(function(t){return t.field===n})?a&&p(i.Jce[n].options)||h.push(n):delete i.Jce[n]},i.Jce)l(d);e=i.nfe(h)}i.iRt=e}},Qce:function(t,r,n){var e,i,o,u,s,c,f,a,h,l,d,e=this,i=(e.lFt||[]).length,o=i;for((0,m.isArray)(t)||(t=[t]),s=[],c=[],f=0;f<t.length;f++)a=t[f],((0,v.isFieldListFilterInfo)(a)?s:c).push(a);if(h=r,l=n,0<s.length&&(h=r.slice(),w(t=s,function(t,n){var t=t,i=e.uFt(t);i||(e.eRt([t]),i=e.uFt(t)),(0,v.hFt)(h,o,i,n,l),l=h,h=r.slice()}),h=l),0<c.length)for(h=r.slice(),t=c,u=this.buildInFilter(t),f=i;f<l.length;f++){d=l[f];try{u(e.gLt,t,d)&&(h[o]=d,o++)}catch(t){}}e.iRt=h},tfe:function(t,n){var i,r,e,o,i=this;if(!(0,m.isNullOrUndefined)(t))for(r=i.lFt||[],e=i.Jce[t]={options:n,count:i.iRt.length-r.length},o=r.length;o<i.iRt.length;o++)e[i.iRt[o]]=!0},afe:function(i){for(var r,e,t,n,o,u,s,c,f,a,h,l,d,v,p,w,b,r=this,e=[],t=function(t){var n=i[t];e.push(r.yLt.find(function(t){return t.value===n.field}))},n=0;n<i.length;n++)t(n);for(o=r.lFt||[],u=r.iRt.slice(0,o.length),n=o.length;n<r.iRt.length;n++)if(s=r.iRt[n],0===(c=r.getHierarchyNode(s,!0)).children.length)for(f=function(t,n){return(0,m.formatCalcError)(r.ufe(t,n))},a=r.ufe.bind(r),h=0;h<i.length;h++){for(d="="===(l=i[h]).field[0]?f:a,v=c,p=0;p<l.Vce.length&&(w=l.Vce[p],(b=d(e[h],v.modalIndex))===w);p++)v=v.parent;if(p===l.Vce.length){u.push(s);break}}r.iRt=u},Wce:function(){this.Jce=null},Yce:function(t,n,i){var r,e,o,u,s,c,f,a,h,r=this,e=r.Jce;if(e&&!(-1<(o=r.lFt||[]).indexOf(t))){for(s in u=r.iRt,e)((0,m.isNullOrUndefined)(i)||s===i||!1===n&&r.EJe(s,i)&&!r.gLt.Pbe(s))&&(f=(c=e[s]).options,a=u.slice(0,o.length),h=u.slice(0,o.length).concat(t),r.Qce(f,a,h),-1<r.iRt.indexOf(t)?c[t]||(c[t]=!0,c.count+=1):c[t]&&(delete c[t],--c.count));r.iRt=u}},fge:function(t){var n,i,r,e,o,u,s,c,f,n=this,i=n.Jce;if(i&&!n.mme()){for(o in r=n.lFt||[],e=n.iRt,i)(0,m.isFormula)(o)&&((0,m.isNullOrUndefined)(t)||n.EJe(o,t))&&n.gLt.Pbe(o)&&(s=(u=i[o]).options,c=e.slice(0,r.length),f=e.slice(),n.Qce(s,c,f),(u=n.iRt).count=n.iRt.length,u.options=s);n.iRt=e}},Zce:function(t,n){var i,r,e,o,u,s,c,f,a,i=this,r=i.Jce;if(r&&!(-1<(e=i.lFt||[]).indexOf(t)))for(o in r)if(r.hasOwnProperty(o)){for(s=(u=r[o]).options,delete u.options,delete u.count,c=Object.keys(u),f=0;f<c.length;f++)t+n<=(a=+c[f])?c[f]=a-n:t<=a&&a<t+n&&(c.splice(f,1),f--);(u=c.reduce(function(t,n){return t[n]=!0,t},{})).options=s,u.count=c.length,r[o]=u}},nfe:function(t){var n,i,r,e,o,u,s,c,n=this;if(0<t.length){if(i=n.lFt||[],r=n.iRt,e=n.Jce,1===t.length&&r.length-i.length===e[t[0]].count)return r;for(o=r.slice(0,i.length),u=i.length;u<r.length;u++){for(s=r[u],c=0;c<t.length&&e[t[c]][s];c++);c===t.length&&o.push(s)}return o}return n.iRt},dFt:function(){var t,n,i,r,e,o,u,s,t=this.iRt;for(t||(this.gFt(),t=this.iRt),r=(i=this.lFt).length,i&&0<r&&(n=t.slice(0,r)),e=[],o=this.length(),s=u=0;s<o;s++)(!n||n.indexOf(s)<0)&&(e[u]=s,u++);n&&0<n.length?this.iRt=n.concat(e):this.iRt=e,this.cFt()},HLt:function(t,n){var i=this,r=i.NLt;i.Dit()&&i.autoFilter&&(0,v.addFilterInfoForFieldValue)(r,t,i,void 0,void 0,n)},iFt:function(t,n,i,r){var e=this,o=e.NLt;e.Dit()&&e.autoFilter&&(0,v.addFilterInfoForFieldValue)(o,t,e,n,i,r)},vFt:function(t){var n=this;n.mFt(t)&&n.filter(n.NLt)},mFt:function(t){return(t||this.autoFilter)&&this.NLt},Dit:function(){var t,n=this.NLt;return(0,m.isArray)(n)&&0<n.length},xGe:function(t){var n,i,r,t,n=this;if(n.Dit())return i=n.NLt,r=n.ife(t),t=!1,n.NLt=i.filter(function(t){return t.field!==r}),0===n.NLt.length&&(t=!(n.NLt=null)),n.cFt(r),t},TGe:function(t,n){var i,r,e,o,u,s,c,f,i=this;if(i.Dit()){if(r=i.NLt,e=i.ife(t),o=i.ife(n),t.type!==n.type||t.dataType!==n.dataType)return i.xGe(n),!0;if(e!==o){for(u=!1,s=0,c=r;s<c.length;s++)(f=c[s]).field===o&&(f.field=e,u=!0);u&&i.cFt(o)}}},filter:function(t){var n=this;return n.iRt||n.gFt(),t&&(!(0,m.isArray)(t)||0<t.length)?(n.isHierarchy()&&n.$ce(),n.fFt(t),n.isHierarchy()&&n.yFt(!0)):n.isHierarchy()?n.gFt():(this.dFt(),n.bde()),this.NLt=(0,m.isArray)(t)&&0<t.length?t:null,this.iRt.length},$ce:function(){var i=this;i.bFt().forEach(function(t){var n;i.getHierarchyNode(t,!0).modalIndex=t})},yFt:function(t){var n,i,r,e,o,u,s,c,f,t,a,n=this,i=n.iRt;if(!(0,m.isNullOrUndefined)(i)&&0!==i.length){for(t||n.$ce(),r=[],e=1,o=0;o<i.length;o++)u=i[o],(s=n.getHierarchyNode(u,!0)).visit=e,(0,m.bubbleTree)(s,function(t){t.isRoot||(t.visit=e)}),(0,m.traversalTree)(s,function(t){t.visit=e});for(f in n.Jce)if(p(n.Jce[f].options)){c=n.Jce[f];break}if(!(0,m.isNullOrUndefined)(c)){for(u in e=2,t=c.options,a=c.count,delete c.options,delete c.count,c)c.hasOwnProperty(u)&&(s=n.getHierarchyNode(+u,!0),(0,m.isNumber)(s.visit))&&(s.visit=e,(0,m.bubbleTree)(s,function(t){t.isRoot||(t.visit=e)}));c.options=t,c.count=a}(0,m.traversalTree)(n.getHierarchyRootNode(),function(t){t.visit===e&&(r.push(t.modalIndex),delete t.visit,delete t.modalIndex)}),n.iRt=r}},bFt:function(){var t=this,n=t.iRt,i,r=t.isHierarchy(),i=t.wFt;return r&&!(0,m.isNullOrUndefined)(i)||(t.gFt(),t.sort(t.kLt),i=t.iRt,t.iRt=n,r&&(t.wFt=i)),i},qce:function(t,e){var o=this;(0,m.isNullOrUndefined)(o.Jce)&&(o.Jce={}),w(t,function(t,n){var i=o.Jce[t],r;!(0,m.isNullOrUndefined)(i)&&i.options.length===n.length&&u(i.options,n)||e(t,n)})}})},"./dist/src/view/view-group.js":function(t,n,i){"use strict";var r,e,b,m,j,y,g,o,i,u,p;function c(c,f,a){for(var h,l,d,v,p,t,n,w,i,r,e,h=[],l=-1,d=-1,v=g.GROUP_COLUMN_WIDTH,p={},t=function(t){for(var n,i,r,e,n=c[t],i=0,r=a.length;i<r;i++)e=a[i],n.value===e.field&&(n.GFt=!0,n.OFt=i,p[(0,y.combineName)(n.value,(0,b.findIndex)(a,function(t){return t.field===n.value}))]={colInfo:n,index:t})},n=0;n<c.length;n++)t(n);for(i=function(t,n){var i,r,e,o,u,s,i=f.getField(w[t]),r=i.name,e,o={caption:i.extra.caption,value:r,name:r,Kyn:i.key,isGroup:!0};-1<(d=(0,b.findIndex)(a,function(t,n){return(0,y.combineName)(t.field,n)===r}))&&(v=(0,g.getGroupColumnWidth)(a[d].field,c),l=d,o.DFt=!0,u=p[r],(0,b.isNullOrUndefined)(u)||(u.colInfo._Ft=t,o._Ft=u.index+n)),o.RJe=!o.DFt&&(0,m.isGroupSummary)(o.value),o.LJe=!o.RJe&&(0,m.isGroupSlice)(o.value),o.OFt=l,o.width=v,(s=i.extra)&&(0,j.setFieldExtraProperties)(function(t){s[t]&&(o[t]=s[t])}),h.push(o)},r=0,e=(w=f.groupFieldKeys).length;r<e;r++)i(r,e);return h}function w(t,n,i){for(var i,r,e,o,u,s,c,f,i=i?i.length:0,r={},e=i;e<t.length;e++)r[t[e]]=!0;for(o=0,u=i,s=n.length,c=t.length;o<s&&u<c;o++)r[f=n[o]]&&(t[u]=f,u++)}function _(t,n){var i,r,e,o,u;if(t&&0<t.length){for(i=[],r=n.length,0<(e=t.length)&&(i=t.slice(0)),o=e,u=0;u<r;u++)-1===t.indexOf(n[u])&&(i[o]=n[u],o++);return i}return n}Object.defineProperty(n,"__esModule",{value:!0}),n.ise=void 0,r=i("Common"),e=i("./dist/src/view/view.js"),b=i("./dist/src/dataSource/utils.js"),m=i("./dist/src/viewField/groupManager.js"),j=i("./dist/src/viewField/fields.js"),y=i("./dist/src/viewField/utils.js"),g=i("./dist/src/view/view-util.js"),o=i("./dist/src/undo/interface.js"),i=r.Common.lt.Dh,u=null,p=void 0,n.ise=c,i(e.View.prototype,{groupBy:function(t){var n,i,n=this;return 0===arguments.length||!(0,b.isArray)(t)||n.hasHierarchyColumn()||0===(t=0<(i=n.yLt.filter(function(t){return t.isCross})).length?t.filter(function(n){return!i.some(function(t){return t.value===n.field})}):t).length?n.MFt:(n.iRt||n.gFt(),n.CFt(t),void(this.MFt=t))},windowOver:function(t,n,i){var r,e,o,u,s,c,f,a,h,l,d,v,p,r=this,e=!1,u=function(){return o=!r.iRt||(e=r.iRt.length!==r.length())?r.qFt():r.iRt.slice()},s=r.gLt.fme(),c=!1,f=!1,o=!s||(c=r.vde(),f=r.Dit(),i)||c||f?u():(r.iRt||r.gFt(),r.iRt);if((0,b.isArray)(t)&&0<t.length)t[t.length-1].windowOrderedFunctions=n,o=r.mde(t,o).indexMap;else for(a=0;a<n.length;a++)for(l=(h=n[a]).orders,(0,b.isArray)(l)&&0<l.length&&r.gde(o,l),d=h.functions,v=0;v<d.length;v++)(p=r.gLt.XOt[d[v].windowOverFormula]).evaluateWindowFunction(o);!s||c&&!e||(f?i||w(r.iRt,o,r.lFt):r.iRt=_(r.lFt,o))},removeGroupBy:function(){var t=this;t.isHierarchy()||(t.AFt(),t.IFt(),t.SFt(),t.MFt=u,t.xFt(),t.NFt())},AFt:function(){var t;this.kFt()},IFt:function(){var t,n,i,r,e,o,u,s,c,f,t=this,n=t.gLt,i=t.NLt,r=t.ZOt,e=t.getColumnInfos();if(i){for(f=i.length-1;0<=f;f--)o=i[f],(u=e.filter(function(t){return t.name===o.field})[0]).DFt?(s=(0,g.getColumnName)(e[u._Ft]),(c=r[o.field])&&(n.ZOt[s]=r[o.field],delete r[o.field]),o.field=s):u.isGroup&&(i.splice(f,1),delete r[o.field]);t.NLt=0===i.length?p:i}},xFt:function(){var t,n,i,r,e,t=this;if(t.kLt){for(n=[],i=0,r=t.kLt;i<r.length;i++)delete(e=r[i]).EFt,e.jFt?(0,m.isGroupField)(e.field)&&(delete e.jFt,delete e.OFt,e.field=(0,m.getGroupFieldName)(e.field),n.push(e)):n.push(e);t.kLt=0===n.length?p:n}t._Lt=p,t.DLt=t.kLt},uii:function(t){var n,i,r,t,n=this;if(n.IGe())return i=n.MFt,r=n.ife(t),t=!1,n.MFt=i.filter(function(t){return t.field!==r}),0===n.MFt.length?t=!(n.MFt=u):i.forEach(function(t){t.summaryFields&&0<t.summaryFields.length&&t.summaryFields.forEach(function(t){var n,n;t.slice&&(n=(n=void 0,b.isString)(t.slice)?t.slice:t.slice.field)===r&&delete t.slice})}),t},kGe:function(t,n){var i,r,e,t,o,u,s,c,i=this;if(i.IGe())if(r=i.ife(t),e=i.ife(n),t=t.type!==n.type||t.dataType!==n.dataType,r===e||t){if(t)return!0}else for(u=0,s=o=i.MFt;u<s.length;u++)(c=s[u]).field===e&&(c.field=r),c.summaryFields&&c.summaryFields.forEach(function(t){t.slice&&(t.slice===e?t.slice=r:t.slice.field===e&&(t.slice.field=r))})},CFt:function(t){var n,i,r,i,r,e,o,u,s,c,f,a,h,l,d,v;if(t){if((n=this).kFt(),r=(i=n.mde(t)).rootNode,i=i.indexMap,n.FFt=r,n.iRt=i,r=n.yLt.slice(),e=n.yLt.filter(function(t){return t.isGroup}),n.SFt(),n.TFt(t),o=!1,0<(u=n.yLt.filter(function(t){return t.isGroup})).length)for(s=function(n){u.some(function(t){return t.value===n.value})||(n.FJe=!0,o=!0)},c=0,f=e;c<f.length;c++)s(a=f[c]);if(h=!1,0<e.length)for(l=function(n){e.some(function(t){return t.value===n.value})||(n.nme=!0,h=!0)},d=0,v=u;d<v.length;d++)l(a=v[d]);o||h?(n.BJe=r,n.PJe||(n.PJe=r)):n.BJe=p,(0===e.length&&0<u.length||0<e.length&&0===u.length)&&(n.BJe=p,n.PJe=p)}},mde:function(t,n){var i,n,r,e,o,i,t,i=this,n=n||i.iRt,r=i.lLt||i.RFt(),e=i.BFt||i.LFt(t),o=n;return i.length()>n.length?((0,b.isNullOrUndefined)(i.Efe)&&(i.Efe=i.qFt()),o=i.Efe):i.Efe=p,i=r.buildGroupFields(t,o),t=e.groupBy(i,n),r.transposeSliceFields(i),t},kFt:function(){var t,n,n=this;(n.BFt=null)!=(t=n.lLt)&&t.reset(),n.FFt=null},pde:function(t,n){var i=this,n=(n||this.autoGroup)&&this.MFt;return n&&((0,b.isString)(t)?i.$Lt(t):!((0,b.isArray)(t)&&0<t.length)||t.some(function(t){return i.$Lt(t)}))},PFt:function(t,n){var i=this;i.pde(t,n)&&i.CFt(i.MFt)},IGe:function(){var t,n=this.MFt;return(0,b.isArray)(n)&&0<n.length},$Lt:function(n,i){var r,e,r=this,e=function(t){return i?!(0,b.isFormula)(t)&&t===n:r.EJe(t,n)};return r.MFt&&r.MFt.some(function(t){return e(t.field)||t.summaryFields&&t.summaryFields.some(function(t){return!i&&t.formula&&r.EJe(t.formula,n)||t.slice&&("string"==typeof t.slice?e(t.slice):t.slice.field&&e(t.slice.field))})})},LFt:function(t){var n=this,i=n.gLt,r=i.POt;return n.BFt=new m.GroupManager(t,r.wEt.bind(r),i.QOt,n.gde.bind(n)),n.BFt},SFt:function(t){for(var n,i,r,e,n=this,i=n.getColumnInfos(),r=i.length-1;0<=r;r--)(e=i[r]).isGroup&&i.splice(r,1),e.GFt&&(!1!==t&&(e.GFt=p),e._Ft=p);n.setColumnInfos(i)},TFt:function(t){for(var n,i,r,e,o,u,s,n=this,i=c(n.yLt,n.lLt,t),r=n.UFt,e,o=0,u=n.getColumnInfos();o<u.length;o++)s=u[o],r||(s.visible=!1),i.push(s);n.setColumnInfos(i)},HFt:function(t){var i,n,r,e,o,u,s,c,f,a;if(t){for(n=(i=this).FFt,r=[],e=i.yLt,o=Array.isArray(t)?t:[t],u=[],s=[],c=function(t){var n,t,n=o[t],t=e.filter(function(t){return t.value===n.field})[0];(t&&(0,b.isNumber)(t.OFt)?(n.jFt=!0,n.EFt=i.zFt([n]),n.OFt=t.OFt,u):s).push(n)},f=0;f<o.length;f++)c(f);a=i.zFt(s),s.forEach(function(t){return t.EFt=a}),i.VFt(n,r,0,u,s),i.iRt=r}},VFt:function(t,n,i,r,e){var o,t,u,s,c,f,a,h,l,d,v,p,w,o=this,t=t.childrenArray&&t.childrenArray[0];if(t)for(1<t.length&&0<r.length&&0<(c=r.filter(function(t){return t.OFt===i})).length&&(f=c[0].EFt,t.sort(function(t,n){return f(o.gLt,c,t.recordRowNumbers&&t.recordRowNumbers[0],n.recordRowNumbers&&n.recordRowNumbers[0])})),a=0,h=t;a<h.length;a++)if(v=!(d=(l=h[a]).childrenArray)||!d[0]||0===d[0].length)for(1<(s=l.recordRowNumbers).length&&0<e.length&&(f=(c=e)[0].EFt,s.sort(function(t,n){return f(o.gLt,c,t,n)})),u=n.length,p=0,w=s.length;p<w;p++)n[u+p]=s[p];else o.VFt(l,n,i+1,r,e)},setGroupSliceColumnSettings:function(t,n){var i=this,r=t[n];t.isGroup&&i.isGroupSliceColumn(t)&&i.getGroupSliceColumns(t).forEach(function(t){return t[n]=r})},isGroupSliceColumn:function(t){return t.isGroup&&(0,m.isGroupSlice)(t.value)},getGroupSliceColumns:function(t){var n,i,r,e,o,u,n,i=[],r=t.OFt,e=this.yLt;if(t.isGroup)for(o=0;o<e.length;o++)(u=e[o]).OFt===r&&(0,m.isGroupSlice)(u.value)&&i.push(u);return i},updateColumnSettingToGroupOptions:function(t,r){var n,i,e,o,u,n,i=this.MFt;if(i&&t.isGroup)switch(o=function(n,i){(0,j.setFieldExtraProperties)(function(t){!(0,b.isNullOrUndefined)(r)&&r!==t||(n[t]=i[t])})},(e=(0,m.getGroupOptionIndexesFrom)(t.value)).length){case 1:o(i[e[0]],t);break;case 2:o(i[e[0]].summaryFields[e[1]],t);break;case 3:o(u="string"==typeof(u=i[e[0]].summaryFields[e[1]].slice)?i[e[0]].summaryFields[e[1]].slice={field:u}:u,t)}},detailColumnsVisible:function(t){var n,i,r,e,n=this;if(0===arguments.length)return n.UFt;if(n.UFt!==t){if(i=n.UFt,n.UFt=t,n.BFt)for(r=n.getColumnInfos(),e=0;e<r.length;e++)r[e].isGroup||(r[e].visible=t);this.AGe.nGe({type:o.ViewChangeType.DetailColumnsVisible,oldData:i})}}})},"./dist/src/view/view-sort.js":function(t,n,i){"use strict";var e,r,p,w,b,o,i,u;function s(r){return r.iRt.reduce(function(t,n){var i=r.getHierarchyNode(n,!0);return(0,p.isNullOrUndefined)(i)||(t[i.id]=n),t},{})}function c(n,i){return function(t){(0,p.isNullOrUndefined)(n[t.id])||i.push(n[t.id])}}function m(t,n,i,r,e){for(var o,u,s,c,o={},u=(0,w.rFt)(t,n,i,e,o,!1),s=0;s<r.length;s++)if(c=u(o,s,o),!(0,p.isNullOrUndefined)(c)&&!(0,p.isCalcError)(c))return c;return null}function j(t,n,i,r,e,o){var u,s,c,f,a,h,l,d,v;if(1===e.length)return o=o||0,u=e[0],s=(0,w.rFt)(t,n,i,u.field,u),c=void 0,c=u.compare?function(t,n,i,r){var i,t,i=s(t,i,n[o]),t=s(t,r,n[o]);return n[o].compare(i,t,n[o].ascending)}:null===(f=m(t,n,i,r,u.field))?function(){return 0}:(a=u.ascending,h=u.list,(0,p.isArray)(h)&&0<h.length?(l=h.reduce(function(t,n,i){return t[n]=i,t},{}),function(t,n,i,r){var i,t,i=s(t,i,n[o]),t=s(t,r,n[o]);return(0,b.compareListValue)(a,f,i,t,l)}):function(t,n,i,r){var i,t,i=s(t,i,n[o]),t=s(t,r,n[o]);return(0,b.compareValue)(a,f,i,t)});for(d=0;d<e.length;d++)u=e[d],(v=(0,w.ZFt)(t,n,u.field)).isGroup&&(0,p.isNullOrUndefined)(u.ascending)&&(u.compare=function(t,n){return t===n?0:1}),u.WFt=j(t,n,i,r,[u],d);return b.multiSort}function f(t){return!t.gLt.fme()||t.Dit()}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ese=void 0,r=i("Common"),p=i("./dist/src/dataSource/utils.js"),w=i("./dist/src/view/view.js"),b=i("./dist/src/view/view-util.js"),o=i("./dist/src/undo/interface.js"),i=r.Common.lt.Dh,u=void 0,n.ese=j,i(w.View.prototype,{zFt:function(t,n){return j(this.gLt,this.yLt,this.lLt,this.iRt,t,n)},QFt:function(t){var n;t&&((n=this).isHierarchy()?(n.wFt=null,n.DLt=(0,b.getSortInfos)(t),n.KFt(t)):n.MFt?(n._Lt=(0,b.getSortInfos)(t),n.HFt(t)):(n.DLt=(0,b.getSortInfos)(t),n.JFt(t)))},JFt:function(t){var n,i,r,e,o,u,u,o,o;t&&(r=(i=(n=this).lFt).length,u=void 0===(u=(o=(e=Array.isArray(t)?t:[t])[0]).startRow)?0:u,o=void 0===(o=o.endRow)?n.length():o,n.gde(n.iRt,t,r+u,o))},gde:function(t,n,i,r){var e,o,u,s,c,f;if(n&&(e=this,0!==(o=Array.isArray(n)?n:[n]).length))if(u=e.zFt(o),r=r||t.length,0===(i=i||0)&&r>=t.length)t.sort(function(t,n){return u(e.gLt,o,t,n)});else for((s=t.slice(i,r)).sort(function(t,n){return u(e.gLt,o,t,n)}),c=0,f=s.length;c<f;c++)t[c+i]=s[c]},XFt:function(){var t,n,i,t=this,n=t.gLt.uBt();return!(0,p.isNullOrUndefined)(n)&&(0,p.isNullOrUndefined)(t.kLt)?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&(i={field:n,ascending:!0},t.isHierarchy()?t.KFt(i):t.JFt(i)),!0):(0,p.isNullOrUndefined)(n)&&(0,p.isNullOrUndefined)(t.kLt)&&t.isHierarchy()?((!t.iRt||t.iRt.length<t.length())&&(t.iRt=t.qFt()),t.iRt&&0<t.iRt.length&&t.$Ft(),!0):void 0},KFt:function(i){var r,t,n,e,o,u;i&&(t=(r=this).getHierarchyRootNode(),n=[],e=Array.isArray(i)?i:[i],o=s(r),u=r.zFt(e),e.forEach(function(t){return t.EFt=u}),(0,p.traversalTree)(t,c(o,n),{isOrderChildren:r.tOi,compareFn:function(t,n){return u=(i=e)[0].EFt,(0,p.isNullOrUndefined)(o[t.id])||(0,p.isNullOrUndefined)(o[n.id])?0:u(r.gLt,i,o[t.id],o[n.id])}}),r.iRt=n)},$Ft:function(){var t,n,i,r,t=this,n=t.getHierarchyRootNode(),i=[],r=s(t);(0,p.traversalTree)(n,c(r,i),{field:"sequence",isOrderChildren:!1}),t.iRt=i},NFt:function(t){var n=this;n.tPt(t)&&n.sort(n.kLt)},tPt:function(t){return(t||this.autoSort)&&this.kLt},Pct:function(){var t,n=this.kLt;return(0,p.isArray)(n)&&0<n.length},NGe:function(t){var n,i,r,t,n=this;if(n.Pct())return i=n.kLt,r=n.ife(t),t=!1,n.kLt=i.filter(function(t){return t.field!==r}),0===n.kLt.length&&(n.kLt=void 0),n.DLt&&(n.DLt=n.DLt.filter(function(t){return t.field!==r}),0===n.DLt.length)&&(n.DLt=void 0),n._Lt&&(n._Lt=n._Lt.filter(function(t){return t.field!==r}),0===n._Lt.length)&&(n._Lt=void 0),t=n.kLt||n.DLt||n._Lt?t:!0},jGe:function(t,n){var i,r,e,t,n,t,i,o,u,s,c,f,a,h,l,d,i=this;if(i.Pct())if(r=i.ife(t),e=i.ife(n),t=t.type!==n.type||t.dataType!==n.dataType,r===e||t){if(t)return!0}else{if(n=i.kLt,t=i.DLt,i=i._Lt,n)for(o=0,u=n;o<u.length;o++)(s=u[o]).field===e&&(s.field=r);if(t)for(c=0,f=t;c<f.length;c++)(a=f[c]).field===e&&(a.field=r);if(i)for(h=0,l=i;h<l.length;h++)(d=l[h]).field===e&&(d.field=r)}},sort:function(t){var n,i,r,n=this;n.iRt||n.gFt(),i=this.kLt,r=e([],this.iRt,!0),n.QFt(t),this.kLt=t,this.AGe.nGe({type:o.ViewChangeType.SortUpdate,oldData:{sortInfo:i,indexMap:r}})},aGe:function(t,n){t?this.sort(t):(this.kLt=void 0,this.DLt=void 0,this._Lt=void 0,this.iRt=n,this.CFt(this.MFt))},_Ge:function(t){this.iRt=t},vde:function(t){var n=this;return n.tPt()||n.pde(t)},bde:function(t,n){var i,r,e,o,u,u,s,u,i=this;if(!i.vde(t)&&(n||f(i))&&i.tme()){for(r=i.getColumnInfos(),e=[],o=r.length-1;0<=o;o--)if(u=r[o],0<(u=i.Gbe(u)).length){u=(s=i.gLt.XOt[u[u.length-1]]).options,(0,p.isArray)(u.partitions)&&0<u.partitions.length&&u.partitions.forEach(function(t){return e.push({field:t.field,ascending:t.ascending})}),(0,p.isArray)(u.orders)&&0<u.orders.length&&u.orders.forEach(function(t){return e.push({field:t.field,ascending:t.ascending})});break}0<e.length&&i.JFt(e)}},DGe:function(){var t,t,n,t=this.OGe(),t=t.sortBefore||t.sortInfo,n=e([],this.iRt,!0);this.AGe.nGe({type:o.ViewChangeType.SortUpdate,oldData:{sortInfo:t,indexMap:n}})},EGe:function(t){var n=this,t=t||n.autoSort,i=n.DLt&&0<n.DLt.length;t&&i&&(n.isHierarchy()?n.KFt(n.DLt):n.JFt(n.DLt))},RGe:function(t){var n=this,t=t||n.autoSort,i=n._Lt&&0<n._Lt.length;t&&i&&n.HFt(n._Lt)},nPt:function(t,n){var i=this;i.bde(t),i.FGe(n)},FGe:function(t,n){var i,r,t,n,i=this;i.EGe(n),i.PFt(t,n),i.RGe(n),i.BJe&&(r=i.BJe.filter(function(t){return t.FJe}),t=0,n=!1,this.NLt&&(t=this.NLt.length,this.NLt=this.NLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.NLt.length!==t)&&(n=!0),this.kLt&&(t=this.kLt.length,this.kLt=this.kLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.kLt.length!==t)&&(n=!0),this._Lt&&(t=this._Lt.length,this._Lt=this._Lt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this._Lt.length!==t)&&(n=!0),n=!(!this.DLt||(t=this.DLt.length,this.DLt=this.DLt.filter(function(n){return!r.some(function(t){return t.value===n.field})}),this.DLt.length===t))||n)&&i.tFt(u,!0,u,!0)}})},"./dist/src/view/view-status.js":function(t,n,i){"use strict";var o,n,u,i,n,r,o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),u=i("./dist/src/dataSource/utils.js"),i=i("./dist/src/view/view.js"),n=n.Common.lt.Dh,r=null,n(i.View.prototype,{BGe:function(t,n){var i,t,n,n,i,i=this;return!(0,u.isNullOrUndefined)(i.LGe)&&(t=i.RJ(t),n=(n=i.Dve(n))&&n.name,!(0,u.isNullOrUndefined)(n))&&(0,u.isNumber)(t)&&(i=i.LGe[n])?i[t]:r},PGe:function(t,n,i){var r,e,t,e,n,e,r,e=this;(0,u.isNullOrUndefined)(e.LGe)||(t=e.RJ(t),n=(e=e.Dve(n))&&e.name,!(0,u.isNullOrUndefined)(n)&&(0,u.isNumber)(t)&&((e=this.LGe[n])?(r=e[t],i?e[t]=o(o({},r),i):r&&delete e[t]):this.LGe[n]=((r={})[t]=o({},i),r)))},GGe:function(t,n){var i,r,t,e,i,i=this,r,t=i.UGe(t).name;n&&(i=(e=i.UGe(n)).name,this.LGe[i]=this.LGe[t]),delete this.LGe[t]},HGe:function(t,n){var i,r,e,o,u,s,c,i,r=this.LGe;if(r)for(e in r)if(r.hasOwnProperty(e))for(o=r[e],u=Object.keys(o),s=0;s<u.length;s++)t+n<=(c=+u[s])?(o[c-n]=o[c],delete o[c]):t<=c&&c<t+n&&delete o[c]},VGe:function(t){var n,i,r,e,o,u,s,n,i=this.LGe;if(i)for(r in i)if(i.hasOwnProperty(r))for(e=i[r],u=(o=Object.keys(e)).length-1;0<=u;u--)t<=(s=+o[u])&&(e[1+s]=e[s],delete e[s])}})},"./dist/src/view/view-style.js":function(t,n,i){"use strict";var e,n,r,o,u,e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),r=i("./dist/src/view/view.js"),o=i("./dist/src/undo/interface.js"),(u=n.Common.lt.Dh)(r.View.prototype,{getStyleRules:function(){return this.LEt.styleRules},getStyleRule:function(t){var t,n,n=this.getStyleRules();return e({},t?null!=(t=n[t])?t:{}:null!=n?n:{})},addStyleRule:function(t,n,i){var n,r,i,n;t&&(r={},n&&(r.style=n),i&&(r.rule=i),i=null!=(n=this.getStyleRules())?n:{},n=e({},i),i[t]=r,this.AGe.nGe({type:o.ViewChangeType.StyleRuleChanges,oldData:n}))},removeStyleRule:function(t){var n,i,n=this.getStyleRules(),i=e({},n);delete n[t],this.AGe.nGe({type:o.ViewChangeType.StyleRuleChanges,oldData:i})},clearStyleRules:function(){var t,t,t=e({},null!=(t=this.LEt.styleRules)?t:{});this.LEt.styleRules={},this.AGe.nGe({type:o.ViewChangeType.StyleRuleChanges,oldData:t})}})},"./dist/src/view/view-util.js":function(P,e,t){"use strict";var j,f,R,s,c,a,y,F;function u(t,n,i,r){var e,t,e=t?i:r,t=t?r:i;return(0,R.isNullOrUndefined)(e)&&(0,R.isNullOrUndefined)(t)?0:(0,R.isNullOrUndefined)(e)?-1:(0,R.isNullOrUndefined)(t)?1:"number"==typeof n||n instanceof Date?e-t:t<e?1:e<t?-1:0}function n(t,n,i,r,e){var o,e,o=t?e[i]:e[r],e=t?e[r]:e[i];return o!==F&&e!==F?o-e:o!==F?-1:e!==F?1:u(t,n,i,r)}function i(t,n,i,r,e){var o,u;if(i instanceof Date)if(-1<s.indexOf(n))i=i.getTime(),o=r,r=function(t,n,i){return o(t,n,i)&&o(t,n,i).getTime()};else{if(-1<c.indexOf(n))return function(){return!1};if(-1<a.indexOf(n))return function(){return!0}}return u=h(t,n,i,e),function(t,n,i){return u(r(t,n,i))}}function h(t,n,i,r){var e,o,u,s,c,c,c,e=i+"",o=e&&e.length;switch((0,R.isString)(i)&&(u=f.Common.$T.jJ(i)),s=t.gLt,n){case"eq":return c=function(t){return t===i},(0,R.isNullOrUndefined)(i)&&(c=function(t){return t===y||t===F}),u?function(t){return new RegExp("^"+u+"$").test(t)}:c;case"neq":return c=function(t){return t!==i},(0,R.isNullOrUndefined)(i)&&(c=function(t){return t!==y&&t!==F}),u?function(t){return!new RegExp("^"+u+"$").test(t)}:c;case"lt":return function(t){return null!==t&&t<i};case"lte":return function(t){return null!==t&&t<=i};case"gt":return function(t){return i<t};case"gte":return function(t){return i<=t};case"startswith":return u?function(t){return new RegExp("^"+u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)===i};case"doesnotstartwith":return u?function(t){return!new RegExp("^"+u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").substr(0,o)!==i};case"endswith":return u?function(t){return new RegExp(u+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1!==(t+"").indexOf(i,(t+"").length-o)};case"doesnotendwith":return u?function(t){return!new RegExp(u+"$").test(t)}:function(t){return"string"==typeof(t+"")&&-1===(t+"").indexOf(i,(t+"").length-o)};case"contains":return u?function(t){return new RegExp(u).test(t)}:function(t){return"string"==typeof(t+"")&&0<=(t+"").indexOf(i)};case"doesnotcontain":return u?function(t){return!new RegExp(u).test(t)}:function(t){return"string"==typeof(t+"")&&(t+"").indexOf(i)<0};case"top":case"bottom":return(c=t.uFt(r))||(t.eRt([r]),c=t.uFt(r)),i=l(Object.keys(c),n,i),function(t){return-1<i.indexOf(t)};case"above":return i=d(s._dataSource._data[r].data,s.jRt(r)),function(t){return i<t};case"below":return i=d(s._dataSource._data[r].data,s.jRt(r)),function(t){return t<i};case"quarter":return function(t){return v(i,t)};case"month":return function(t){return(t&&t.getMonth())===i};default:return function(){return!1}}}function l(t,n,i){for(var r,e,o,u,r=[],e=0,o=t;e<o.length;e++)u=o[e],isNaN(u)||r.push(parseFloat(u));return i>=r.length||("top"===n?r=w(r,i):"bottom"===n&&(r=g(r,i))),r}function d(t,n){var i,r,e,o,u,i=0;if(!t||0===t.length)return i;for(r=n&&n.dataMap,e=0,o=t;e<o.length;e++)u=o[e],"number"==typeof(u=r&&"number"==typeof r[u]?r[u]:u)&&(i+=u);return i/t.length}function v(t,n){var i=n&&n.getMonth();switch(t){case 0:return i<=2;case 1:return 3<=i&&i<=5;case 2:return 6<=i&&i<=8;case 3:return 9<=i;default:return!1}}function r(t,n,i,r){for(var e,o,u,s,e=0,o=0,u=n.length;o<u&&0===(e=(s=n[o]).WFt(t,n,i,r));o++);return e}function o(t){return Array.isArray(t)?t:[t]}function p(t,n){var i,r;if(0===t.length)return[];for(i=t.slice(0),r=0;r<n;r++)-1===t.indexOf(r)&&i.push(r);return i}function w(t,n){for(var i,r,e,i=b(t.slice(0,n)),r=n;r<t.length;r++)t[r]>i[0]&&(e=i[0],i[0]=t[r],t[r]=e,b(i));return i}function b(t){for(var n,i,n=t.length,i=Math.floor(n/2);0<=i;i--)m(t,i,n);return t}function m(t,n,i){var r,e,o,r,r=2*n+1,e=2*n+2,o=n;r<i&&t[r]<t[o]&&(o=r),n!==(o=e<i&&t[e]<t[o]?e:o)&&(r=t[n],t[n]=t[o],t[o]=r,m(t,o,i))}function g(t,n){for(var i,r,e,i=_(t.slice(0,n)),r=n;r<t.length;r++)t[r]<i[0]&&(e=i[0],i[0]=t[r],t[r]=e,_(i));return i}function _(t){for(var n,i,n=t.length,i=Math.floor(n/2);0<=i;i--)O(t,i,n);return t}function O(t,n,i){var r,e,o,r,r=2*n+1,e=2*n+2,o=n;r<i&&t[r]>t[o]&&(o=r),n!==(o=e<i&&t[e]>t[o]?e:o)&&(r=t[n],t[n]=t[o],t[o]=r,O(t,o,i))}function S(t,n){for(var i,r,e,o,i=0,r=t;i<r.length;i++)if(o=n(e=r[i]))return o}function C(n){var t,i,r,e,t=n.style,i=(i=(t=t||(n.style={})).cellButtons)||(t.cellButtons=[]),r=(r=t.dropDowns)||(t.dropDowns=[]);(e=S(i,function(t){return"openDateTimePicker"===t.command}))?i.forEach(function(t){t.enabled=!n.readonly}):i.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent",enabled:!n.readonly}),(e=S(r,function(t){return"dateTimePicker"===t.type}))||r.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}function I(n,t){var i,r,i=(0,R.findIndex)(t,function(t){return N(t)===n});return-1<i&&(r=t[i]).width||e.GROUP_COLUMN_WIDTH}function N(t){var t;return(0,R.isString)(t)||"string"==typeof(t=t.value)?t:"function"==typeof t?t.name:void 0}function M(t){return!t.JOt}function E(t){var n,i,r,e,o,n=M(t);if(n){for(t.WOt++,r=0,e=i=t.eBt();r<e.length&&(!(o=e[r])||o.WOt||(n=E(o)));r++);t.WOt--}return n}function x(t){return t.isGroup||t.isCross}function T(t){return D(t[0])}function D(t){return t.operator===F}function A(t){return t[0].operator!==F&&t[0].ort}function k(h,l,d,v,p,w){for(var b,m,t,n,i,r,b=d.isHierarchy(),m={},t=function(n){var t,i,r,e,o,u,s,c,f,a;if(n&&!m[n.field]&&((0,R.isNullOrUndefined)(p)||n.field===p)){if(m[n.field]=!0,(t=d.uFt(n.field))||(d.eRt([n.field]),t=d.uFt(n.field)),i=t&&Object.keys(t),e=void 0,(r=l[n.field])instanceof Date){for((o=new Date(r)).setHours(0,0,0,0),u=o.toISOString().slice(0,10),e=!0,s=0,c=i;s<c.length;s++)if((f=c[s]).startsWith(u)){e=!1;break}}else e=(0,R.isNullOrUndefined)(r)?-1===i.indexOf("null")&&-1===i.indexOf("undefined"):-1===i.indexOf(r+"");if(!h.some(function(t){return t.field===n.field&&t.value===r})&&e&&(T(h)?(h.push(j(j({},n),{value:r,isAdded:!0})),b&&L(d,h[h.length-1],p,r,w)):(A(h)||r===v&&void 0===v)&&h.push(j(j({},n),{value:r,operator:"eq",relation:"or",isAdded:!0}))),-1<i.indexOf(v+"")&&1===t[v].length&&v!==r)for(a=0;a<h.length;a++)if(h[a].value===v&&h[a].isAdded){h.splice(a,1);break}}},n=0,i=h;n<i.length;n++)t(r=i[n])}function L(t,n,i,r,e){var i,o,u,s;if(n.field===i||(0,R.isNullOrUndefined)(i)){if(i=void 0,n.Vce)(i=n.Vce.slice())[0]=r;else{for(u=(o=t.getHierarchyNode(e,!0)).parent,s=[r];!u.isRoot;)s.push(u.getFieldValue(n.field)),u=u.parent;i=s}n.Vce=i}}function V(t){var n,i,r,e,e;if((0,R.isNullOrUndefined)(t))return t;for(n=[],i=0,r=t;i<r.length;i++)e=r[i],(e=j({},e)).getValue&&delete e.getValue,n.push(e);return n}function G(r,e){var t,o,u,t,o=function(n,i,r,t){return t.every(function(t){return t(n,i,r)})},u=function(){for(var t,n,i,t=[],n=[r[0]],i=1;i<r.length;i++)"or"===e[i]?(t.push(n),n=[r[i]]):n.push(r[i]);return 0<n.length&&t.push(n),t}();return function(n,i,r){return u.some(function(t){return o(n,i,r,t)})}}function q(t,r){var e;return t&&t.dataMap?(e=JSON.parse(JSON.stringify(t.dataMap)),function(t,n,i){var t=r(t,n,i);return void 0!==e[t]?e[t]:t}):r}function B(t,n,i,r,e){var o,u,s,r,c,f,a,h,l,d,v,p,w,b,m,j,o=[],u=!1,s=!1,r=r.map(function(t){var n=t.value;return n===y&&(u=!0),n===F&&(s=!0),t.value});for(u&&!s&&r.push(F),s&&!u&&r.push(y),c=0,f=r;c<f.length;c++)for(a=f[c],l=0,d=h=i&&i[a]||[];l<d.length;l++)o[v=d[l]]=!0;for(p=n,w=t.reduce(function(t,n){return t[n]=!0,t},{}),b=0,m=e;b<m.length;b++)!o[j=m[b]]||0<n&&w[j]||(t[p]=j,p++)}function U(t,n,i,r,e,o,u){var s,c,f,a,h,l,d,v,p,w,b,m,j,y,g,_,O,S,C,s=[],c=r.map(function(t,n){return n}),f=[];if(e&&e.length&&(a=!(c=[]),r.forEach(function(t,n){-1<o.indexOf(n)?(s.push(n),c.push(F)):(s.push(F),c.push(n)),t.isCross&&(a=!0)}),t=e[t],n=e[n],a)){for(h=[],l=[],d=0;d<r.length;d++)(r[d].isCross?(h[r[d].RBt]||(h[r[d].RBt]=[],f.push(h[r[d].RBt])),v=h[r[d].RBt]):f).push(d),t===d&&(t=f.length-1),n===d&&(n=f.length-1);for(p=0,w=o;p<w.length;p++)b=w[p],l.push(f.indexOf(b));s=[],c=[],f.forEach(function(t,n){-1<l.indexOf(n)?(s.push(n),c.push(F)):(s.push(F),c.push(n))}),i=1}if((0,R.swapArrayItems)(c,t,n,i),c=c.filter(function(t){return!(0,R.isNullOrUndefined)(t)}),e&&e.length){for(d=0;d<s.length;d++)void 0===s[d]&&(s[d]=c.shift());if(f&&f.length){for(m=[],j=0;j<s.length;j++)if(y=s[j],Array.isArray(f[y]))if("string"==typeof(g=u[j].cross)){for(_=[s[j]];j+1<u.length&&g===u[j+1].cross;)_=_.concat(s[j+1]),j++;for(O=f[_[0]].length,S=[],C=0;C<O;C++)for(d=0;d<_.length;d++)S.push(f[_[d]][C]);m=m.concat(S)}else m=m.concat(f[y]);else m.push(f[y]);s=m}}else s=c;return s}j=this&&this.__assign||function(){return(j=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(e,"__esModule",{value:!0}),e.ePt=e.hFt=e.mapGetValueFunc=e.aFt=e.removeExtraInfos=e.addFilterInfoForFieldValue=e.isFieldListFilterInfo=e.isFieldListFilter=e.isViewColumn=e.isTableDataReady=e.getColumnName=e.getGroupColumnWidth=e.applyDateTimePicker=e.array_find=e.generatePinnedColumnIndexMap=e.getSortInfos=e.multiSort=e.oFt=e.compareListValue=e.compareValue=e.GROUP_COLUMN_WIDTH=void 0,f=t("Common"),R=t("./dist/src/dataSource/utils.js"),s=["eq","neq","lt","lte","gt","gte"],c=["startswith","doesnotstartwith","endswith","contains"],a=["doesnotendwith","doesnotcontain"],y=null,F=void 0,e.GROUP_COLUMN_WIDTH=100,e.compareValue=u,e.compareListValue=n,e.oFt=i,e.multiSort=r,e.getSortInfos=o,e.generatePinnedColumnIndexMap=p,e.array_find=S,e.applyDateTimePicker=C,e.getGroupColumnWidth=I,e.getColumnName=N,e.isTableDataReady=E,e.isViewColumn=x,e.isFieldListFilter=T,e.isFieldListFilterInfo=D,e.addFilterInfoForFieldValue=k,e.removeExtraInfos=V,e.aFt=G,e.mapGetValueFunc=q,e.hFt=B,e.ePt=U},"./dist/src/view/view.entry.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/src/view/view.js"),n),e(i("./dist/src/view/view-status.js"),n),e(i("./dist/src/view/view-style.js"),n),e(i("./dist/src/view/view-event.js"),n),e(i("./dist/src/view/view-group.js"),n),e(i("./dist/src/view/view-sort.js"),n),e(i("./dist/src/view/view-filter.js"),n),e(i("./dist/src/view/view-cross.js"),n)},"./dist/src/view/view.js":function(P,t,n){"use strict";var f,y,S,u,p,r,m,i,g,o,_,s,a,O,e,k;function c(t){return{rule:{area:u.ViewArea.colHeader,direction:u.StateRuleDirection.column,state:t},style:{decoration:{icons:[{src:""}]}}}}function h(t){(0,S.isNullOrUndefined)(t.styleRules)&&(t.styleRules=(0,S.clone)(e,!0))}function l(t){return t instanceof Date&&!isNaN(t.valueOf())}function d(t){return i.Common.ct.Q0(t)}function v(t){var n=i.Common.ct.dJ(t);return n&&!l(n)&&(n=i.Common.ct._DT(t)),l(n)?n:null}function w(t){var n,i,r,e,n=[],i=t.columns;if(i)for(r in i)i.hasOwnProperty(r)&&("="===(e=(0,S.clone)(i[r])).value[0]&&e.name&&(e.value=e.name),n.push(e));return n}function j(t){return 0===t?"":"_"+t}function b(t,n,i,r){var e,o,r,r;return(0,S.isNullOrUndefined)(i)||(o=i.value,i.isCross||i.isGroup?r&&(r=r.getFieldByName(o))&&(e=r.getValue(n)):o&&("string"==(r=typeof o)?e=R(t,i,n):"function"==r&&(e=i.value(t.iBt(n))))),e}function C(e,a,t,o,i,u,s,c,f,n){var h,l,r,d,v,p,w,b,h={},l=[],r=!!i;if(a.forEach(function(t,n){var i,r,i=t.value;s&&!s[i]||(t.isCross?o&&(h[t.value]=o.getFieldByColumn(t).getValue(u)):t.isGroup?o&&o.kve(h,t,u,c,f):i&&("string"==typeof i?(r=c&&t.caption||i,h[r]=R(e,t,u)):"function"==typeof i&&l.push({name:i.name,caption:t.caption,value:i})))}),0<l.length&&(d=e.iBt(u),l.forEach(function(t){h[t.name]=t.value(d)})),r&&o&&i&&n){for(p in v=o.getFieldValues(u,c,f))!v.hasOwnProperty(p)||f&&s&&!s[p]||(h[p]=v[p]);for(w=function(c){for(var f,t,n,f=i[c].summaryFields,t=function(i){var t,n,t,r,e,o,u,s,t=f[i];if(t&&t.slice){for(n=j(c),t=t.caption+"_"+t.slice+n,r={},o=0,u=e=a.filter(function(t){var n=(0,m.getGroupOptionIndexesFrom)(t.value);return t.isGroup&&3===n.length&&+n[0]===c&&+n[1]===i});o<u.length;o++)r[(s=u[o]).caption]=v[s.value];h[t]=r}},n=0;n<f.length;n++)t(n)},b=0;b<i.length;b++)w(b)}return h}function R(t,n,i){return F(t._getValueByField(n.value,i),n)}function F(t,n){var n=n&&n.dataMap;return t=n?n[t]||t:t}function I(t,n){var i,r,e,o,i=t.value,r=t.dataMap,e=n[i];if(r)for(o in r)if(e===r[o]){n[i]=e=isNaN(o)?o:+o;break}}function N(t,n){var i,r,i=[];for(r in t)t[r]!==n[r]&&i.push(r);return i}function M(t,n){var i,r,i={};for(r in t)n.hasOwnProperty(r)||(i[r]=t[r]);return i}function E(t,n){var i,r,i={};for(r in n)t.hasOwnProperty(r)&&n.hasOwnProperty(r)&&(i[r]=t[r]);return i}function x(t,n,i){for(var r,e,r=0;r<n.length;r++)if((e=n[r]).value===i||e.caption===i)return!t.columns[e.value]||(0,S.isFormula)(t.columns[e.value].value)||(0,S.isFormula)(e.value)?(0,p.isViewColumn)(e)?{value:e.value,isGroup:e.isGroup,isCross:e.isCross}:{value:e.value}:e.value;return i===t.uBt()||t.columns[i]?i:t.XOt[i]?{value:i}:a}function T(r,t,n){return!1!==n&&"="===t[0]?function(t,n,i){return(0,S.formatCalcError)(r(t,n,i))}:r}function L(n,t,i,r,e,o){var u,s,c,f,a,h,l,d,u=x(n,t,r);return e?(0,p.isViewColumn)(u)?(e.getValue=i.getFieldByName(u.value),T(function(t,n,i){return i.getValue.getValue(n)},u.value,o)):u.value?(e.getValue=n.XOt[u.value],(0,S.isNullOrUndefined)(e.getValue)&&(e.getValue={getValue:function(t){return n._getValueByField(u.value,t)}}),T(function(t,n,i){return i.getValue.getValue(n)},u.value,o)):(e.getValue=n._dataSource._data[u].data,n.mTe()?(s={},c=n.nv.bind(n),function(t,n,i){var r=s[n];return r===O&&(s[n]=r=c(n)),i.getValue[r]}):function(t,n,i){return i.getValue[n]}):(f=String(u.value),a=String(u),u.value?T(function(t,n){return t._getValueByField(f,n)},f,o):n.mTe()?(h={},l=n.nv.bind(n),d=n._dataSource._data[a].data,function(t,n){var i=h[n];return i===O&&(h[n]=i=l(n)),d[i]}):function(t,n){return t._dataSource._data[a].data[n]})}function D(t){var n=(0,p.getColumnName)(t);return(0,S.isFormula)(n)&&!(0,S.isNamedFormulaColumn)(t)||(0,S.isRelation)(n)||(0,S.isFunction)(n)}function A(t,n,i,r){void 0===i&&(i=!0),void 0===r&&(r={}),this.rPt=10,this.lFt=[],this.CLt=[],this.oPt=[],this.ZOt={},this.LGe={},this.dme=0,this.rb=0,this.BLt={};var e=this;e.name=t,Object.defineProperty(e,"tableName",{get:function(){var t;return null==(t=e.gLt)?void 0:t.name}}),e.ILt=(0,S.clone)(n=n||[]).map(function(t){return"string"==typeof t?{value:t}:t}),e.yLt=n.map(function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),t}),e.aPt=i,e.autoSort=!0,e.autoFilter=!1,e.autoGroup=!0,e.UFt=!0,e.yde=!1,h(r),(e.LEt=r).styleRules||e.clearStyleRules(),this.AGe=new o.ChangesHelper(e)}f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},y=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(t,"__esModule",{value:!0}),t.View=t.rFt=t.ZFt=t.nse=t.tse=t.ose=void 0,S=n("./dist/src/dataSource/utils.js"),u=n("./dist/src/interfaces/interface.js"),p=n("./dist/src/view/view-util.js"),r=n("./dist/src/viewField/fieldManager.js"),m=n("./dist/src/viewField/groupManager.js"),i=n("Common"),g=n("./dist/src/table/windowOverField.js"),o=n("./dist/src/undo/changesHelper.js"),_=n("./dist/src/undo/interface.js"),s=n("./dist/src/dataSource/dataSource.js"),a=null,O=void 0,e={pin:c(u.RowColumnStates.pin),primaryKey:c(u.RowColumnStates.primaryKey),readonly:c(u.RowColumnStates.readonly),required:c(u.RowColumnStates.required)},t.ose=w,t.tse=j,t.nse=C,t.ZFt=x,t.rFt=L,A.prototype.XLt=function(){var t,n=this.gLt;return(0,p.isTableDataReady)(n)},A.prototype.Ywt=function(t,n,i){var r=this.gLt;return r&&r.Ywt(t,n,i)},A.prototype.wde=function(t){var n,i=this.gLt.POt;return i.getCalcService().unparse(i,t,0,0)},A.prototype.nMt=function(t,n,i){var n=this.RJ(n),i=this.uPt(i);return this.sPt(t,n,i)},A.prototype.sPt=function(t,n,i){return this.jfe(t,n,(0,S.isNumber)(i)?(0,p.getColumnName)(this.yLt[i]):O)},A.prototype.jfe=function(t,n,i){var r,e,t,r=this.gLt;if(r)return!(e=!1,S.isNullOrEmpty)(i)&&(0,S.isNullOrUndefined)(r.XOt[i])&&(e=!0,r.XOt[i]=this.lLt.getFieldByName(i)),t=r._fe(t,n,i),e&&delete r.XOt[i],t},A.prototype.cPt=function(){var t=this,n=t.gLt;n&&(t.aPt&&t.yLt.length<=0&&(t.yLt=w(n),t.ILt=(0,S.clone)(t.yLt)),t.fPt(),t.lPt())},A.prototype.getTable=function(){return this.gLt},A.prototype.PRt=function(t){var n=this;t?(n.gLt=t,n.JLt(),n.bLt()?n.XLt()&&(n.RFt(),n.cPt()):n.cPt(),t.$he=n.$he.bind(n),n.XLt()&&(n.hPt(),n.dPt=!0,n.yde||(n.yde=!0,n.Mde(),n.$he(),n.gLt.fme())||n.tFt()),n.v7()):(n.wpt(),n.gLt=t)},A.prototype.fPt=function(){var t,t,n,t,i,r,e,o,u,s,c,f,a,h,n=null==(t=null==(t=this.gLt._dataSource.options)?void 0:t.schema)?void 0:t.columns;if(n)for(t=this.yLt,r=(i=this.isHierarchy())&&this.gLt._dataSource.options.schema.hierarchy.column,e=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],o=0,u=t;o<u.length;o++)if("string"==typeof(s=u[o]).value&&(c=n[s.value])){for(f=0,a=e;f<a.length;f++)(0,S.isNullOrUndefined)(s[h=a[f]])&&(s[h]=c[h]);s.dataType=c.dataType,"date"===c.dataType&&(0,p.applyDateTimePicker)(s),"formula"===c.dataType&&(s.readonly=!0),!i||s.value!==r&&"rowOrder"!==c.dataType||(s.readonly=!0),c.n7t&&"rowOrder"!==c.dataType&&(s.readonly=!1,delete c.n7t)}},A.prototype.lPt=function(){for(var t,n,i,r,e,t=this.LEt.defaultColumnWidth||60,n,i=0,r=this.yLt;i<r.length;i++)e=r[i],(0,S.isNullOrUndefined)(e.width)&&(e.width=t)},A.prototype.tme=function(){var n=this,t;return n.yLt.some(function(t){return n.Pbe(t)})},A.prototype.vme=function(){var t=this;return!t.mme()&&t.tme()&&t.gLt.fme()},A.prototype.Pbe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.Pbe(t.value)},A.prototype.Gbe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.Gbe(t.value)},A.prototype.Xhe=function(t){return!(0,p.isViewColumn)(t)&&this.gLt.Xhe(t.value)},A.prototype.Cde=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j,n=this,i=n.gLt,r=i.XOt,e=[];if(t){if(u=[],o=i.fme())for(s=n.getColumnInfos(O,O,O,!0),c=0;c<s.length;c++)f=s[c],a=n.Gbe(f),u=u.concat(a);for(h in r)if(r.hasOwnProperty(h)&&(l=r[h])instanceof g.WindowOverCalcField&&!1!==l.nde&&!l.options.nme&&(e.push(l.options),l.options.nme=!0,o))for(d=l.options.windowOverFormula.slice(1),v=0;v<u.length;v++)if(-1<(p=u[v]).indexOf(d)){l.options.Sde=!0;break}if(o){for(w=[],b=[],v=0;v<e.length;v++)delete(m=e[v]).nme,(m.Sde?(delete m.Sde,w):b).push(m);return[w,b]}for(v=0;v<e.length;v++)delete(m=e[v]).nme}else for(s=n.getColumnInfos(),c=0;c<s.length;c++)if(f=s[c],0<(j=n.Gbe(f)).length)for(v=0;v<j.length;v++)!1!==(l=r[d=j[v]]).nde&&e.push(l.options);return[e,[]]},A.prototype.Tde=function(t){for(var n,i,r,t,e,i,o,u,s,c,f,a,n=this,i=t[0],r=t[1],t=n.Ade(i),e=t.windowOverInfoMap,i=t.windowOverInfos,o=[],u=0;u<r.length;u++)s=r[u],(0,S.isNullOrUndefined)(e[s.partitionKey])||(0,S.isNullOrUndefined)(e[s.partitionKey].orderMap[s.orderKey])?o.push(s):(c=e[s.partitionKey].orderMap[s.orderKey],f=s.frameKey+"__"+s.windowFormula,(0,S.isNullOrUndefined)(c.functionMap[f])&&(c.functionMap[f]=!0,c.orderFunctions.functions.push({orders:s.orders,windowOverFormula:s.windowOverFormula,windowFormula:s.windowFormula,windowFrame:s.windowFrame})));return[a=n.Ade(o).windowOverInfos,i]},A.prototype.Ade=function(t){for(var n,i,r,e,o,u,s,c,c,f,a,a,n,h,l,d,v,i={},r=[],u=0;u<t.length;u++)e=(s=t[u]).partitionKey,o=s.orderKey,(0,S.isNullOrUndefined)(i[s.partitionKey])&&(c={partitions:s.partitions,orderedFunctions:[]},i[s.partitionKey]={index:r.length,orderMap:{},windowOverInfo:c},r.push(c)),f=(c=i[s.partitionKey]).orderMap,(0,S.isNullOrUndefined)(f[s.orderKey])&&(a={orders:s.orders,functions:[]},f[s.orderKey]={index:c.windowOverInfo.orderedFunctions.length,functionMap:{},orderFunctions:a},c.windowOverInfo.orderedFunctions.push(a)),a=s.frameKey+"__"+s.windowFormula,n=f[s.orderKey].functionMap[a],h=s.windowFrame&&s.windowFrame.exclude,((0,S.isNullOrUndefined)(n)||(0,S.isNullOrUndefined)(n[h]))&&(f[s.orderKey].functionMap[a]=((n={})[h]=!0,n),f[s.orderKey].orderFunctions.functions.push({orders:f[s.orderKey].orderFunctions.orders,windowOverFormula:s.windowOverFormula,windowFormula:s.windowFormula,windowFrame:s.windowFrame}));return l=function(t){var n,t,t,i,n=t.windowOverInfo.orderedFunctions,t=t.orderMap[o];1<n.length&&(i=n[t=t.index],n.splice(t,1),n.push(i))},1<r.length?(v=r[u=(d=i[e]).index],r.splice(u,1),r.push(v),l(d)):1===r.length&&l(i[e]),{windowOverInfoMap:i,windowOverInfos:r}},A.prototype.Mde=function(){for(var t,n,i,r,t=this,n=t.getColumnInfos(),i=0;i<n.length;i++)r=n[i],t.Xhe(r)},A.prototype.$he=function(t){var n,i,n,r,n,e,o,u,s,c,f,a,i=this;if(0===i.dme){for(t&&null!=(n=i.BFt)&&n.dl(),r=(n=i.Tde(i.Cde(t)))[0],n=n[1],e=0,o=r;e<o.length;e++)s=(u=o[e]).partitions,c=u.orderedFunctions,i.windowOver(s,c,!0);for(f=0,a=n;f<a.length;f++)s=(u=a[f]).partitions,c=u.orderedFunctions,i.windowOver(s,c,t);return!0}},A.prototype.gme=function(){this.dme++},A.prototype.pme=function(){0<this.dme&&this.dme--,this.dme<=0&&(this.dme=0,this.$he(!0),this.fge(),this.gLt.bCe())},A.prototype.mme=function(){return 0!==this.dme},A.prototype.gFt=function(t){this.XFt()||(this.iRt=this.qFt(t))},A.prototype.qFt=function(t){var n,i,r,t,e,o,n=[],i=t||this.length(),r=this.lFt,t=r.length;for(0<t&&(n=r.slice(0)),e=t,o=0;o<i;o++)-1===r.indexOf(o)&&(n[e]=o,e++);return n},A.prototype.jRt=function(t){return O},A.prototype.RFt=function(t){var n=this,i=n.gLt;return n.iRt||n.gFt(),n.lLt=new r.FieldManager(n.LEt,i),n.ELt(),n.yLt=n.lLt.prepareFields(t||n.yLt),n.YBt(),n.lLt},A.prototype.getLookup=function(t){return(0,r.getLookupBy)(this.gLt,t)},A.prototype.isLookupField=function(t){return(0,r.isLookupField)(this.gLt,t)},A.prototype.isLookupListField=function(t){return(0,r.isLookupListField)(this.gLt,t)},A.prototype.isLookupRelationField=function(t){return(0,r.isLookupRelationField)(this.gLt,t)},A.prototype.RJ=function(t){return this.iRt||this.gFt(),this.iRt[t]},A.prototype.FLt=function(t){return this.iRt||this.gFt(),this.iRt.indexOf(t)},A.prototype.length=function(){return this.gLt.length()},A.prototype.visibleLength=function(){return this.iRt||this.gFt(),this.iRt.length},A.prototype.getDirtyIndexes=function(){var n=this;return n.gLt.getDirtyIndexes().map(function(t){return n.FLt(t)})},A.prototype.isInserted=function(t){var n=this,t=n.RJ(t);return n.vPt(t)},A.prototype.vPt=function(t){return this.gLt.isInserted(t)},A.prototype.isUpdated=function(t){var n,t,t,n=this,t=n.RJ(t);return n.PLt(!1),t=n.gLt.isUpdated(t,n.bLt()),n.PLt(!0),t},A.prototype.getErrorInfo=function(t){var n,t=this.RJ(t);return this.gLt.getErrorInfo(t)},A.prototype.kbe=function(){return this.gLt.kbe()},A.prototype.insertItem=function(t,n,i,r,e,o,u,s){var c,f,c=this;return c.isHierarchy()?0===(f=c.visibleLength())?void this.addHierarchyFirstItem(n,i,r,e,o):void(t<f?c.addHierarchyItemBefore(t,n,i,r,e,o):c.addHierarchyItemAfter(f-1,n,i,r,e,o)):c.mPt(t,n,i,r,o,u,s)},A.prototype.insertItems=function(t,n,i){var s,c,n,r,e,f,a,i,s=this,c=this,n=c.GLt(n,i),r=n.success,e=n.fail,f=0,a=0,i=t.map(function(u){return function(t,n){var i,r,e,o,i=u.row,r=u.isAfter,e=u.data;f<i&&(f=i),a++,0===(o=c.visibleLength())?s.addHierarchyFirstItem(e,t,n):r?c.addHierarchyItemAfter(i,e,t,n):c.addHierarchyItemBefore(i,e,t,n)}});return(0,S.promiseSerialExecute)(i).then(function(t){t.row=f,t.addedCount=a,r&&r(t)}).catch(function(t){e&&e(t)})},A.prototype.mPt=function(n,t,i,r,e,o,u){var s,i,c,r,i,f,e,t,a,h,l,o,d,v;return void 0===e&&(e=!0),i=(s=this).GLt(i,r),c=i.success,r=i.fail,i=s.visibleLength(),n=i<n?i:n,o=null!=o?o:s.RJ(n),f=e?s.gPt(t):t,s.ULt(f),this.AGe.nGe({type:_.ViewChangeType.Insert,index:n}),(0,S.isNullOrUndefined)(o)&&(s.Dit()?(o=s.length(),s.HLt(f,o)):o=n),e=s.gLt.uBt(),t=!(0,S.isNullOrUndefined)(e),a=s.isHierarchy(),h=o,l=n<i,t&&!a&&(d=o=void 0,v=!1,l?(o=s.RJ(n-1),d=h):(d=s.RJ(n-1),v=!0),f[e]=s.gLt.d7t(o,d,v)),(t||a)&&(h=s.Dit()?s.length():i),s.gLt.insertItem(h,f,function(t){s.zLt(h,f,l,n,u),c&&c(t)},r)},A.prototype.zGe=function(n,t,i,r){var e,i,o,r,u,s,e=this,i=e.GLt(i,r),o=i.success,r=i.fail,u=n,s=e.gPt(t);return e.gLt.recoverItemAtBatch(u,s,function(t){e.zLt(u,s,!0,n,!0),o&&o(t)},r)},A.prototype.zLt=function(t,n,i,r,e){var o,u,s,c,f,s,e;void 0===e&&(e=!1),u=!((o=this).vme()&&!o.Dit()),i?(s=o.length()-1,o.cRt(s,n),o.VGe(s),c=o.autoFilter,(f=!(0,S.isNullOrUndefined)(o.NLt))&&(o.autoFilter=!0),u&&((0,S.isNumber)(r)&&!o.tPt()&&o.isHierarchy()?o.iRt.splice(r,0,s):o.iRt.push(s)),o.tFt(O,!f&&!e),f&&(o.autoFilter=c)):(o.cRt(t,n),s=o.length(),e=!o.autoFilter&&!!o.iRt,(e=(0,S.isNullOrUndefined)(i)&&(0,S.isNullOrUndefined)(r)&&o.isHierarchy()?!1:e)&&u&&o.iRt.push(s-1),o.tFt(s,e))},A.prototype.gPt=function(t){var n,i,r,e,o,u,s,u,n={};if(this.isHierarchy())for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(e=0,o=r=this.yLt;e<o.length;e++)s=t[i=(u=o[e]).value instanceof Function?u.value.name:u.value],(0,S.isUndefined)(s)||("string"==typeof(u=u.value)?n[u]=s:u(n,s));return n},A.prototype.Dwe=function(t,n,i,r){var e=this;e.ULt(t),e.iFt(t,n,i,r)},A.prototype.jwe=function(u,s,t,r){var n,c,e,o,f,a,h,l,d,i,v,p,w,b,m,j,y,g,_,O,n=this,c=n.gLt,e=n.lLt,o=Object.keys(u),f=this.yLt;if(n.vPt(s)&&o.some(function(n){return f.some(function(t){return t.isCross&&t.value===n})}))return!1;for(a={},h=[],l=function(t,n,i,r){var e,o,e,e=c.qRt(n);e.name!==c.name?(o=a[e.name],(0,S.isNullOrUndefined)(o)&&(a[e.name]=o={}),e=c.swe(r?r.getRelationField(s):n,s),(0,S.isNullOrUndefined)(o[e])&&(o[e]={}),o[e][i]=t):u[n]=t},d=function(t,n,i){var r;h.push({data:((r={})[t.valueField]=u[n],r[t.dimRelationKey]=t.getDimValue(),r),valueRelation:t.valueRelation,onSucceeded:i})},i=function(t){var t,n,i,t,t=f[t],n=t.value;t.isCross&&-1<o.indexOf(n)&&(i=e.getFieldByColumn(t),t=c.KRt(i.valueRelation,s),i.isOneToMany?(t=t&&(0,S.isNumber)(i.getValueIndex(s)))?l(u[n],i.valueRelation,i.valueField,i):d(i,n,function(t){e.setCrossFieldInsertedIndex(i,s,t.index)}):t?(l(u[n],i.valueRelation,i.valueField),l(i.getDimValue(),i.dimRelationPath,i.dimRelationKey)):d(i,n),r[n]=u[n])},v=0;v<f.length;v++)i(v);if(0<(p=Object.keys(a)).length)for(w=0;w<p.length;w++)for(y in b=p[w],m=this.gLt.QOt.tables[b],j=a[b])j.hasOwnProperty(y)&&m.updateItem(Number(y),j[y]);if(0<h.length)for(g=0,_=h;g<_.length;g++)O=_[g],c.JRt(O.valueRelation,s,O.data,O.onSucceeded);return Object.keys(u).length===Object.keys(r).length?(n.VLt(u,t,s),n.YLt(u,t,s),!0):void 0},A.prototype.VLt=function(t,n,i){var r=this;r.Owe(i,t,n),r.kwe(t,n,i)},A.prototype.kwe=function(t,n,i){var r,e,o,r=this;for(e in t)(0,S.isNotDeepEqual)(t[e],n[e])&&(o=n[e],r.Dwe(t,o,e,i))},A.prototype.YLt=function(t,n,i){var r,e,o,u,r=this,e=[];for(o in t)(0,S.isNotDeepEqual)(t[o],n[o])&&(u=n[o],e.push(o),r.hRt(i,o,u,t[o]));r.tFt(O,!0,e,O)},A.prototype.updateItem=function(t,n,i,r,e){var e,o,u,e,e,s,i,c,r,f,a,i,o,u,e=null!=e?e:{},o=e.hasAddNewRowData,u=e.currentModelIndex,e=e.isModelIndex,e=void 0!==e&&e,s=this,i=s.GLt(i,r),c=i.success,r=i.fail,f=o?u:e?t:s.RJ(t),a=this.getRowData(f,!0),i={},o=s.jwe(n,f,a,i),u={type:_.ViewChangeType.Update,modelIndex:f,oldData:E(a,n)};if(this.AGe.nGe(u),!(0,S.isBoolean)(o))return s.VLt(n,a,f),s.gLt.updateItem(f,M(n,i),function(t){s.YLt(n,a,f),c(t)},r);o?c({index:f,data:n,originalData:a,changingFields:N(n,a)}):r()},A.prototype.Owe=function(t,n,i){var r,e,o,u,s,c,f,a,h;for(i=i||this.getRowData(t,!0),r=(0,S.clone)(i,!0),e=Object.keys(n),u=0,s=o=this.yLt;u<s.length;u++)(f=(c=s[u]).value)instanceof Function&&!(0,S.isUndefined)(n[f.name])&&-1<e.indexOf(f.name)&&f(r,n[f.name]);for(a in r)r.hasOwnProperty(a)&&(h=r[a],(0,S.isNotDeepEqual)(h,i[a]))&&(n[a]=h)},A.prototype._we=function(t,r){var n,e,i,o,n=this,e=this.yLt,i=function(n){var t,i;r.hasOwnProperty(n)&&(t=r[n],(0,S.isUndefined)(t)||I(i=e.find(function(t){return t.value===n}),r))};for(o in r)i(o);return n.Owe(t,r),r},A.prototype.resetItem=function(t,n,i){var r=this,n=r.GLt(n,i),e=n.success,i=n.fail,o=r.RJ(t),u=this.getRowData(o,!0),s=r.bPt(o);if(!(0,S.isNullOrUndefined)(t)&&!(0,S.isNullOrUndefined)(o))return this.AGe.nGe({type:_.ViewChangeType.Update,modelIndex:o,oldData:u}),r.kwe(s,u,o),r.gLt.resetItem(o,function(t){r.ZLt(o,u,s),e(t)},i);i()},A.prototype.ZLt=function(t,n,i){var r=this;r.vLt(t),r.pRt(t,n,i),r.tFt(O,!0,O,O)},A.prototype.saveItem=function(t,n,i){var r=this,n=r.GLt(n,i),e=n.success,i=n.fail,n=r.RJ(t);return r.gLt.saveItem(n,function(t){e(t)},i)},A.prototype.getRowData=function(t,n,i,r,e,o){var u,n,u=this,n=n?t:u.RJ(t);return u.nFt(n,i,r,e,o)},A.prototype._ve=function(t,n){var i=this;return b(i.gLt,i.RJ(t),n,i.lLt)},A.prototype.yPt=function(t){return this.isHierarchy()&&this.wPt(t)},A.prototype.wPt=function(t,n){var i=this,r=i.gLt.uBt(),e,r=i.isHierarchy()||!(0,S.isNullOrUndefined)(r),o=(0,S.isNullOrUndefined)(i.MFt),t=!(0<i.lFt.length)||i.lFt.length<t&&(!(0,S.isNumber)(n)||i.lFt.length<n);return r&&o&&t},A.prototype.MPt=function(){var t=this;return!!(0,S.isNullOrUndefined)(t.kLt)||!!t.kLt[0].ascending},A.prototype.CPt=function(t,n){var i,r,e,o,i=this,e=i.getHierarchyNode(t).parent;if(n){for(o=t+1;o<i.visibleLength();o++)if(i.getHierarchyNode(o).parent===e){r=o;break}}else for(o=t-1;0<=o;o--)if(i.getHierarchyNode(o).parent===e){r=o;break}return r},A.prototype.m7t=function(t,n){var i,r,e,o,o,u,s,c,f,a,h,r,r,i=this;if(t!==n&&i.wPt(t,n)){if(o=(e=t<n)?n+1:n-1,(r=i.isHierarchy())&&1===Math.abs(t-n)&&(n=i.CPt(t,e)),o=i.gLt.m7t(e,i.RJ(t),i.RJ(n),i.RJ(o))){if(u=i.iRt,c=1,f=[s=i.RJ(t)],r)for(f=[],h=(a=t)+(c=i.gLt.V7t(s));a<h;a++)f.push(i.RJ(a));e?(r=i.gLt.V7t(i.RJ(n)),u.splice.apply(u,y([n+r,0],f,!1)),u.splice(t,c)):(u.splice(t,c),u.splice.apply(u,y([n,0],f,!1))),i.wFt=O,r=u.indexOf(s),this.AGe.nGe({type:_.ViewChangeType.MovedUpdateOrDown,moveIndex:r,destIndex:r+(e?-1:1)})}return o}},A.prototype.moveUp=function(t){var n,i=1;0<t&&this.m7t(t,t-1)},A.prototype.moveDown=function(t){var n=this,i=1;t<n.visibleLength()-1&&n.m7t(t,t+1)},A.prototype.SPt=function(){for(var t,n,i,r,e,o,u,t=this,n=t.gLt._dataSource.options.schema.hierarchy.outlineColumn,i=t.yLt,r=-1,e=-1,o=0;o<i.length;o++){if(u=i[o],!(0,S.isNullOrEmpty)(u.outlineColumn)){r=o;break}-1!==e||u.value!==n&&((0,S.isNullOrUndefined)(n)||u.value!==n.value)||(e=o)}return-1!==r?{index:r,options:i[r].outlineColumn}:{index:e,options:n}},A.prototype.getHierarchyColumnOptions=function(){return this.SPt().options},A.prototype.getHierarchyColumnIndex=function(){return this.SPt().index},A.prototype.hasHierarchyColumn=function(t){var n=this,i=n.isHierarchy(),n=i&&n.getHierarchyColumnIndex();return(0,S.isNumber)(t)?i&&n===t:!(!i||-1===n)},A.prototype.ABe=function(t,n){return this.gLt.ABe(this.ife(t),n)},A.prototype.isHierarchy=function(){return this.gLt.CEt()},A.prototype.getHierarchyNode=function(t,n){var i,n,i=this;if(i.isHierarchy())return n=n?t:i.RJ(t),i.gLt.SEt(n)},A.prototype.getHierarchyRootNode=function(){var t=this;if(t.isHierarchy())return t.gLt.f7t()},A.prototype.promoteHierarchyLevel=function(t){var n,i,r,t,n;this.isHierarchy()&&(i=this.$Fe(),r=this.YGe(),this.gLt.M7t(this.RJ(t)),t=r(),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:i}),this.AGe.nGe({type:_.ViewChangeType.RowDataChanged,oldData:t}))},A.prototype.$Fe=function(){return this.gLt.$Fe()},A.prototype.YGe=function(){var a,h,r,l,e,o,t,n,a=this,h=[],r={},l=y([],this.iRt,!0),e=function(t,n,i){var r,e,o,u,s,n,c,f,r=n.action,e=n.index,o=n.oldItems,u=n.items,s=n.modelIndex,n=n.hierarchyNodeInfo,c,f=a.gLt.name===i?l.indexOf(s):s;h.push({rowIndex:f,oldItems:o,items:u,action:r,livingIndex:e,hierarchyNodeInfo:n,tableName:i,modelIndex:s})},o=this.gLt.QOt.tables,t=function(t){var i;o.hasOwnProperty(t)&&(i=o[t],r[i.name]=function(t,n){e(t,n,i.name)},i.bind(s.ONCHANGE,r[i.name]))};for(n in o)t(n);return function(){var t,n;for(t in o)o.hasOwnProperty(t)&&(n=o[t])&&r[n.name]&&n.unbind(s.ONCHANGE,r[n.name]);return h}},A.prototype.fGe=function(t){this.gLt.tBe(t),this.tFt(void 0,!1)},A.prototype.lGe=function(t){var h,l,d,h=this,l=[],d={};y([],t,!0).reverse().forEach(function(i){var r,n,t,e,o,u,s,c,f,a,r=i.rowIndex,n=i.action,t=i.oldItems,e=i.items,o=i.livingIndex,u=i.hierarchyNodeInfo,s=i.tableName,c=h.gLt.QOt.tables[s];"update"===n?(f=h.iRt[r],t.forEach(function(t){c.I7t({action:n,index:f,item:t,x7t:!0,N7t:!1})})):"delete"===n&&(a=c===h.gLt,e.forEach(function(t,n){a?h.ZGe(t,r+n,o+n,u,i.modelIndex):h.QGe(t,r+n,o+n,u,c)}),d[s]||(l.push(c),d[s]=!0))}),this.WGe(l)},A.prototype.WGe=function(t){0<t.length&&(t.forEach(function(t){t.dl()}),this.hLt())},A.prototype.QGe=function(t,n,i,r,e){var o,u,o,u;e.X7t()&&e.OBe(i)?e.recoverItemAtBatch(i,t):e.insertItem(n,t,null,null)},A.prototype.ZGe=function(t,n,i,r,e){var o,u,o,u;this.gLt.X7t()&&this.gLt.OBe(i)?this.zGe(i,t,null,null):this.insertItem(n,t,null,null,r,!1,e,!0)},A.prototype.demoteHierarchyLevel=function(t,n){var i,r,e,i,i=this;i.isHierarchy()&&(r=this.$Fe(),e=this.YGe(),i.gLt.S7t(i.RJ(t),n),i=e(),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:r}),this.AGe.nGe({type:_.ViewChangeType.RowDataChanged,oldData:i}))},A.prototype.hasRowOrder=function(){var t;return!(0,S.isNullOrUndefined)(this.gLt.uBt())},A.prototype.hasHierarchyRowOrder=function(){return this.gLt.qX()},A.prototype.addHierarchyItemBefore=function(t,n,i,r,e,o){var u,s,e,u=this;u.yPt(t)&&(s=this.$Fe(),e=u.gLt.O7t(u.RJ(t),n,e),u.APt(n,e),u.mPt(t,n,i,r,o),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:s}))},A.prototype.addHierarchyItemAfter=function(t,n,i,r,e,o){var u,s,c,e,u=this;if(u.yPt(t))return s=this.$Fe(),c=u.gLt.V7t(u.RJ(t)),e=u.gLt.L7t(u.RJ(t),n,e),u.APt(n,e),u.mPt(t+c,n,i,r,o),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:s}),c},A.prototype.addHierarchyItemAbove=function(t,n,i,r){var e,o,u,e=this;e.yPt(t)&&(o=this.$Fe(),u=e.gLt.F7t(e.RJ(t),n),e.APt(n,u),e.mPt(t,n,i,r),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:o}))},A.prototype.addHierarchyItemBelow=function(t,n,i,r){var e,o,u,s,e=this;if(e.yPt(t))return o=this.$Fe(),u=e.gLt.V7t(e.RJ(t)),s=e.gLt.G7t(e.RJ(t),n),e.APt(n,s),e.mPt(t+u,n,i,r),this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:o}),u},A.prototype.addHierarchyFirstItem=function(t,n,i,r,e){var o,r,o=this,r=o.gLt.Xme(t,r);o.APt(t,r),o.mPt(0,t,n,i,e)},A.prototype.APt=function(t,n){var i,r,e,i,r=this.gLt.H7t(n);if(!(0,S.isNullOrUndefined)(r))for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e])},A.prototype.h7t=function(t,n){if(this.isHierarchy())return this.gLt.h7t(t,n)},A.prototype.fetch=function(i){var r,n,t,t,r=this,n=r.gLt.QOt.tables,t=r.gLt.Ix();if(0<t.length)return t=t.map(function(t){var t=n[t];return t&&t.fetch(i,!0)}),Promise.all(t).then(function(t){r.yde||r.JLt(),r.pLt()&&(r.RFt(),r.cPt()),!i&&r.yde||(r.yde||r.Mde(),r.$he(),r.gLt.fme())||r.tFt(),r.dPt||r.hPt();var n=r;return(n.dp||n.vp)&&(n.dp&&n.dp(),n.vp)&&n.vp(),r.yde=!0,t})},A.prototype.iM=function(t,n){var i=this;i.Wce(),i.cFt(),t&&i.gFt(),i.hLt(),i.lLt&&n&&i.RFt(i.ILt.map(function(t){return f({},t)})),i.tFt(O,!0)},A.prototype.hPt=function(){for(var t,n,i,r,e,o,t,n=0,i=this.yLt;n<i.length;n++)(r=i[n]).cross||(e=r.lookup,(0,S.isArray)(e)?"string"==typeof r.value&&-1===r.value.indexOf(".")&&0<(e=(0,S.getUniqueArray)(e)).length&&((o=(o=r.style)||(r.style={})).cellType||(o.cellType={type:"combobox",items:e})):(0,S.isString)(e)&&e?this.IPt(r,e):(0,S.isObject)(e)&&this.IPt(r,e.name,e.columns))},A.prototype.IPt=function(t,n,i){var r,t,e,r,o,r,o,n,r,r=t.style,t=(t=(r=r||(t.style={})).cellButtons)||(r.cellButtons=[]),e=(e=r.dropDowns)||(r.dropDowns=[]),r=(0,p.array_find)(t,function(t){return"openMultiColumn"===t.command}),o=(0,p.array_find)(e,function(t){return"multiColumn"===t.type});r||o||(o=(r=this.xPt(n)).table,n=r.field,o&&n&&o!==this.gLt&&(r=o.columns)&&(t.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),e.push({type:"multiColumn",option:{dataSource:o.views[u.DEFAULT_VIEW_NAME]||o.addView(u.DEFAULT_VIEW_NAME),bindingInfos:this.NPt(r,i),valuePath:n}})))},A.prototype.xPt=function(t){for(var n,i,r,e,o,u,r,e=0,o=this.gLt.QOt.relationships;e<o.length;e++)if((u=o[e]).sourceRelationshipName===t){n=u.targetTable,i=u.targetFieldName;break}return{table:n,field:i}},A.prototype.NPt=function(n,t){return t?t.map(function(t){return(0,S.isString)(t)?{name:t,width:"*"}:{name:t.value,width:(0,S.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}}):(0,S.keys)(n).map(function(t){var t=n[t];return{name:t.value,width:(0,S.isNullOrUndefined)(t.width)?"*":t.width,displayName:t.caption,visible:t.visible}})},A.prototype.oV=function(){for(var t,n,i,r,t=this,n=t.gLt.length(),i=[],r=0;r<n;r++)i.push(t.nFt(r));return i},A.prototype.ULt=function(t){for(var n,i,r,e,o,e,n,i=0,r=this.yLt;i<r.length;i++)"string"==typeof(o=(e=r[i]).value)&&(I(e,t),t.hasOwnProperty(o))&&(e=this.gLt.bEt(o))&&e.relatedTable&&e.setValue&&e.setValue(t)},A.prototype.kPt=function(t,n){var i,r,e,i=this.lFt;if(i&&0<i.length){for(r=0;r<n;r++)-1<(e=i.indexOf(t+r))&&i.splice(e,1);for(r=0;r<i.length;r++)i[r]>t&&(i[r]-=n)}},A.prototype.removeRowData=function(i,r,t,n){var e,t,o,n,t,u,s,c,f,a,h,e=this,t=e.GLt(t,n),o=t.success,n=t.fail,t=e.gLt,u=e.RJ(i),s=e.isHierarchy(),a=[];(0,S.isNullOrUndefined)(i)||(0,S.isNullOrUndefined)(u)||(0,S.isNullOrUndefined)(r)?n():(s&&(c=this.$Fe()),f=this.YGe(),h=y([],this.lFt,!0),t.remove(u,r,function(t){var n;e.WLt(u,t.removedCount||r,i),f&&f().forEach(function(t,n){a[n]=t}),o(t)},n),s&&this.AGe.nGe({type:_.ViewChangeType.HierarchyLevelChanged,oldData:c}),s||this.AGe.nGe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:h}}),this.AGe.nGe({type:_.ViewChangeType.RowDataChanged,oldData:a}))},A.prototype.removeItems=function(t,n,i){var u,s,n,r,e,c,f,a,i,u=this,s=this,n=s.GLt(n,i),r=n.success,e=n.fail,c=s.gLt,f=[],a=0,i=t.map(function(o){return function(i,t){var n,r,e,n=1;u.isHierarchy()&&(n+=(r=u.getHierarchyNode(o)).getChildrenCount()),e=s.RJ(o),c.remove(e,n,function(t){var n=t.removedCount||1;s.WLt(e,t.removedCount||1,o),f.push({index:e,count:n}),a+=n,s.rebuildFieldGetter(),i()},t)}});return(0,S.promiseSerialExecute)(i).then(function(t){t.removedItems=f,t.totalRemovedCount=a,r&&r(t)}).catch(function(t){e&&e(t)})},A.prototype.WLt=function(t,n,i){var e,o,r,u,s,e=this;if(e.kPt(t,n),(0,S.isNumber)(i)||(i=e.FLt(t)),!e.mFt()&&(!e.vme()||e.Dit())){for(o=e.iRt.slice(i,i+n),r=function(t,n){var i,r,i=e.iRt[t],r=o.reduce(function(t,n){return n<i?t+1:t},0);0<r&&(e.iRt[t]-=r)},u=0,s=e.iRt.length;u<s;u++)r(u,s);e.iRt.splice(i,n)}e.dLt(t,n),e.MRt(t,n),e.HGe(t,n),e.tFt(void 0,!0)},A.prototype.getChanges=function(){for(var t,n,i,r,e,t,n=this.gLt.getChanges(),i=0,r=n;i<r.length;i++)e=r[i],(0,S.isNullOrUndefined)(e.index)||(e.index=this.FLt(e.index));return n},A.prototype.isDataLengthChanged=function(){return this.gLt.isDataLengthChanged()},A.prototype.submitChanges=function(r,e){var o=this,t=o.GLt(),n=t.success,t=t.fail,i;return o.gLt.submitChanges(function(t,n,i){var t;r&&(t=o.FLt(t),r(t,n,i))},function(t,n,i){e&&e(t,n,i)}).then(function(t){return o.QLt(),n(),t}).catch(t)},A.prototype.QLt=function(){},A.prototype.cancelChanges=function(){var t,n,i,n,r,e,t=this,n=t.GLt(),i=n.success,n=n.fail,r=t.isDataLengthChanged(),e=t.gLt.ZBe();t.gLt.cancelChanges(function(){t.QBe(e),t.KLt(r),i()},n)},A.prototype.KLt=function(t){this.iM(t)},A.prototype.ZBe=function(){return this.gLt.ZBe()},A.prototype.QBe=function(t){var n=this;this.gLt.WBe(t,function(t){n.removeColumn(t.column.name||t.column.value)},function(t){n.YBe(t.column.name||t.column.value,t.originalColumn)},function(t){n.addColumn(t.originalColumn)})},A.prototype.DPt=function(t,n){var i,r,e,t,o,i=this,r=i.TLt(t,n);if(this.AGe.nGe({type:_.ViewChangeType.MoveColumnOptions,from:t,to:n}),e=i.ILt.map(function(t,n){return{index:n,option:t}}),t=i._Pt(t,n),e=t.map(function(t){return e[t]}),i.ILt=e.map(function(t){return t.option}),r)return!0;o=[],e.forEach(function(t,n){(0,S.isNullOrUndefined)(t.option.cross)||t.index===n||o.push({oldIndex:t.index,newIndex:n})}),i.wLt(o,!1)},A.prototype.EPt=function(){var i,t,r,i=this,t=i.CLt;return t&&0<t.length?(r=[],t.forEach(function(t,n){r.push(i.yLt[t].value)}),r):[]},A.prototype.jPt=function(t){var n,i=this.yLt;return(0,S.isNullOrUndefined)(t)?[]:t.map(function(n){return(0,S.findIndex)(i,function(t){return t.value===n})})},A.prototype.OPt=function(t,n,i){var r,e,t,n,o,u,s,c,f,a,a,h,l,r=this;if(r.yLt.forEach(function(t,n){t.RPt=n}),e=r.oPt,this.AGe.nGe({type:_.ViewChangeType.MoveColumnInfos,from:t,to:n,count:i}),t=(0,p.ePt)(t,n,i,r.yLt,r.oPt,r.CLt,r.ILt),n=r.CLt.map(function(t){return r.yLt[t]}),r.yLt=t.map(function(t){return r.yLt[t]}),n&&n.length){for(o=[],u=r.yLt.length,s=-1,c=0,f=n;c<f.length;c++)a=f[c],a=r.yLt.indexOf(a),s=Math.max(a,s),o.push(a);for(h=0;h<u;h++)-1===o.indexOf(h)&&o.push(h);r.oPt=o,r.CLt=o.slice(0,n.length)}return l=r.yLt.reduce(function(t,n,i){return n.RPt!==i&&t.push({oldIndex:n.RPt,newIndex:i}),delete n.RPt,t},[]),r.yLt.forEach(function(t){for(var n,i,r,e,r,n=0,i=l;n<i.length;n++)if(e=(r=i[n]).oldIndex,r=r.newIndex,t._Ft===e){t._Ft=r;break}}),r.lLt&&r.lLt.moveFieldsByIndexes(l),l.map(function(t){return t.oldIndex=r.BPt(t.oldIndex,e),t.newIndex=r.BPt(t.newIndex),t})},A.prototype.SLt=function(t){var n,i,n,r,n=this,i=n.yLt,n=n.ILt,r=i[t];return r.isCross?r.RBt:(0,S.findIndex)(n,function(t){return t.value===r.value})},A.prototype.ALt=function(t){var n=this,i=n.CLt,r=n.ILt;return t=t||i.map(function(t){return n.SLt(t)}),(0,p.generatePinnedColumnIndexMap)(t,r.length)},A.prototype._Pt=function(t,n){var i,r,e,o,r,r,u;if(t!==n)return r=(i=this).CLt,e=i.ILt.map(function(t,n){return{index:n}}),o=r.map(function(t){return i.SLt(t)}),0<(r=(0,p.generatePinnedColumnIndexMap)(o,e.length)).length&&(t=r[t],n=r[n]),r=o.map(function(t){var t=e[t];return t.LPt=!0,t}),(0,S.swapArrayItems)(e,t,n,1),u=e.filter(function(t){return!t.LPt}),r.forEach(function(t,n){u.splice(o[n],0,t)}),u.map(function(t){return t.index})},A.prototype.getColumnInfos=function(i,r,e,o){for(var u,s,c,f,t,a,n,u=[],s=this.yLt,c=this.oPt,f=this.gLt,t=function(t){var t,n,t,t=!(0<c.length)||e||(0,S.isNullOrUndefined)(c[t])?t:c[t],n=s[t];if(!o&&f.jOt(n.value)&&(n.isPrimaryKey=!0),!i||!n.isGroup){if(r&&n.isCross&&(t=n.RBt,(n=a.ILt[t]).RBt=t,u.some(function(t){return t===n})))return"continue";u.push(n)}},a=this,n=0;n<s.length;n++)t(n);return u},A.prototype.JGe=function(t,n){var t=(0,S.isFormula)(t)?this.Ywt(t):t;return t?(0,r.getFieldNamesFrom)(t,n):[]},A.prototype.EJe=function(t,n){var i,r,i=(0,S.isFormula)(t)?t:this.gLt.wCe(t)?this.gLt.awe(t):a;return(0,S.isString)(n)?r=function(t){return t===n}:(0,S.isFunction)(n)&&(r=n),i?this.gLt.wHe(i,r):r(t)},A.prototype.ife=function(t){var n=this;return(0,p.getColumnName)((0,S.isNumber)(t)?n.getColumn(t):t)},A.prototype.FPt=function(t,n){var i=this.gLt.qRt(t);return!((0,S.isNullOrUndefined)(i)||(!n||!(0,S.isRelation)(t))&&i===this.gLt)},A.prototype.setColumnInfos=function(t,n){for(var i,r,e,o,u,i={},r=0;r<this.yLt.length;r++)"string"==typeof(e=this.yLt[r]).value&&e.value===e.name&&(i[e.value]=!0);for(o=0;o<t.length;o++)"string"!=typeof(u=t[o]).value||i[u.value]||this.Xhe(u);this.yde&&(this.yLt=t,this.$he()),this.yLt=t,this.PPt(),this.Gfe(),n&&this.cPt()},A.prototype.Gfe=function(){for(var t,n,i,r,e,o,u,t=this.ILt,n=0;n<t.length;n++)if(!(i=t[n]).cross)for(r=this.yLt,e=0;e<r.length;e++)if(o=r[e],i.value===o.value){for(u in o)o.hasOwnProperty(u)&&"_"!==u.charAt(0)&&(i[u]=o[u]);break}},A.prototype.PPt=function(){for(var t,n,i,r,e,o,u,s,t=this.ILt,n=t.length-1;0<=n;n--)"string"==typeof(i=t[n].value)&&"="===i[0]&&t.splice(n,1);for(r=this.yLt,e=n=0;n<r.length;)o=r[n],u=t[e],o.isGroup||o.isCross?n++:u&&u.cross?e++:(s=o.value)===(i=u&&u.value)?(n++,e++):"string"!=typeof s||"="!==s[0]&&"formula"!==o.dataType?n++:(s!==o.name&&this.dGe(o.name,s),t.splice(e,0,o),n++,e++)},A.prototype.GPt=function(t){var n;return!!this.gLt.ZRt(t)},A.prototype.Xfe=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,i=this,r=i.NLt;if(i.mFt())i.Wce(),i.filter();else{for(u in e=i.iRt,o=i.Jce)if(o.hasOwnProperty(u)){for(c=(s=o[u]).options,f=s.count,delete s.options,delete s.count,a=0;a<t.length;a++)h=t[a],(0,S.isNullOrUndefined)(s[h])||(delete s[h],f--);if(0<n.length)for(i.iRt=n,i.filter(c),l=0;l<i.iRt.length;l++)s[d=i.iRt[l]]=!0,f++;s.options=c,s.count=f}i.Jce=o,i.iRt=e}i.NLt=r},A.prototype.togglePinnedRows=function(t){var n,i,r,e,o,u,s,c,f,a,h,l,d,v,p,w,b,m,j;if((0,S.isNullOrUndefined)(t)||this.hasHierarchyColumn())return this.lFt&&this.lFt.length;for(n=y([],this.lFt,!0),i=this.lFt,r=this.iRt,e=t.length,o=[],u=[],s=[],c=i.length,f=0;f<e;f++)-1<(a=r[t[f]])&&(-1<(h=i.indexOf(a))?(u.push(h),s):o).push(a);if(i.length-(d=u.length)+(l=o.length)>this.rPt)return-1;if(0<d)for(u.sort(),f=d-1;0<=f;f--)i.splice(u[f],1);for(f=0;f<l;f++)i.push(o[f]);if(0<d||0<l){for(v=[],p=r.length,0<(w=i.length)&&(v=i.slice(0)),a=w,f=0;f<p;f++)-1===i.indexOf(r[f])&&(v[a]=r[f],a++);if(!this.mFt()&&!this.tPt())for(f=0;f<d;f++)b=r[u[f]],m=v.indexOf(b),j=this.UPt(b,c,v),v.splice(m,1),v.splice(j=m<j?j-1:j,0,b),w<c&&c--;this.iRt=v,this.Xfe(o,s),this.vFt(),this.bde(O,0<d),this.NFt()}return this.AGe.nGe({type:_.ViewChangeType.PinnedRows,oldData:{pinnedRows:n}}),i.length},A.prototype.pGe=function(){for(var t,n,i,t=this.lFt.length,n=[],i=0;i<t;i++)n.push(i);this.togglePinnedRows(n)},A.prototype.togglePinnedColumns=function(t,n){var i,t,i=y([],this.CLt,!0),t=this.KGe(t,n);return this.AGe.nGe({type:_.ViewChangeType.PinnedColumns,oldData:{pinnedColumns:i}}),t},A.prototype.KGe=function(t,n){var i,r,e,o,u,s,c,f,a,h,l,d,v,i=this;if((0,S.isNullOrUndefined)(t))return this.CLt&&this.CLt.length;for(r=this.oPt,e=0<r.length,t=t.filter(function(t){var t=e?r[t]:t;return!i.yLt[t].isCross}),o=this.CLt,u=t.length,s=[],c=[],f=0;f<u;f++)-1<(a=e?r[t[f]]:t[f])&&(-1<(h=o.indexOf(a))?c.push(h):s.push(a));if(o.length-(d=c.length)+(l=s.length)>this.rPt)return-1;if(v=[],0<d)for(c.sort(),f=d-1;0<=f;f--)v.push(o.splice(c[f],1));for(f=0;f<l;f++)o.push(s[f]);return n&&(o=o.map(function(t){for(var n,i,r,n=0,i=v;n<i.length;n++)(r=i[n])<t&&--t;return t})),(0<l||0<d)&&(this.oPt=(0,p.generatePinnedColumnIndexMap)(o,this.yLt.length-(n?d:0))),o.length},A.prototype.wGe=function(){for(var t,n,i,t=this.CLt.length,n=[],i=0;i<t;i++)n.push(i);this.togglePinnedColumns(n)},A.prototype.uPt=function(t){var n,i=this.oPt;return i&&0<i.length?i[t]:t},A.prototype.BPt=function(t,n){var i;return(n=n||this.oPt)&&0<n.length?n.indexOf(+t):+t},A.prototype.getRowDataAsync=function(i){var r=this;return r.fetch().then(function(t){var n=r.RJ(i);return r.nFt(n)})},A.prototype.UPt=function(t,n,i){for(var r=n;r<i.length;r++)if(i[r]>t)return r;return i.length},A.prototype.nFt=function(t,n,i,r,e){var o=this;return C(o.gLt,o.yLt,o.BFt,o.lLt,o.MFt,t,n,i,r,e)},A.prototype.rebuildFieldGetter=function(){var i,t,i=this.gLt;i&&(t=this.yLt).forEach(function(t,n){var t=t.value;"string"==typeof t&&i.rRt(t)})},A.prototype.ufe=function(t,n){return R(this.gLt,t,n)},A.prototype.XGe=function(t){var n,n;return null==(n=null==(n=this.gLt)?void 0:n.columns)?void 0:n[t]},A.prototype.updateColumnDataType=function(t,n){var i,i,i,r,i,i,e,r=this.XGe(t);r&&((i=null==(i=null==(i=null==(i=this.gLt)?void 0:i.options)?void 0:i.schema)?void 0:i.columns)&&(i[t]?i[t].dataType=n:i[t]={dataType:n}),i=r.dataType,e=(0,S.clone)(this.gLt.KFe(r.name)),this.AGe.nGe({type:_.ViewChangeType.TableSheetColumnDataTypeChanged,oldData:{columnValue:t,oldDataType:i,oldData:e}}),r.dataType=n)},A.prototype.hGe=function(t,n){var t=this.XGe(t);t&&this.gLt.XFe(t.name,n)},A.prototype.updateColumnIsPrimaryKeyType=function(t,n){var i,i,i,r,i,r=this.XGe(t);r&&((i=null==(i=null==(i=null==(i=this.gLt)?void 0:i.options)?void 0:i.schema)?void 0:i.columns)&&(i[t]?i[t].isPrimaryKey=n:i[t]={isPrimaryKey:n}),this.AGe.nGe({type:_.ViewChangeType.TableSheetColumnIsPrimaryKeyChanged,oldData:{columnValue:t,oldIsPrimaryKey:r.isPrimaryKey}}),r.isPrimaryKey=n)},A.prototype.bPt=function(s){var c,t,f,a,h,l,n,i,r,c=this,t=c.yLt,f={},a=[],h=!!c.MFt,l=c.gLt;if(t.forEach(function(t,n){var i,r,e,o,u,i=t.value;t.isCross?f[t.value]=c.lLt.getFieldByColumn(t).getOriginalValue(s):i&&!t.isGroup&&("string"==typeof i?(r=0<=i.indexOf("."),e="="===i[0],o=l.XOt&&(0,S.isNullOrUndefined)(l.XOt[i]),(!h||r||e||o)&&(f[i]=F(e?l._getValueByField(i,s):l.XRt(i,s),t))):"function"==typeof i&&a.push({name:i.name,caption:t.caption,value:i}))}),0<a.length&&(n=l.iBt(s),a.forEach(function(t){f[t.name]=t.value(n)})),h)for(r in i=this.lLt.CBt(s))i.hasOwnProperty(r)&&(f[r]=i[r]);return f},A.prototype.JBe=function(){return this.gLt.JBe()},A.prototype.KBe=function(t){return this.gLt.KBe(t)},A.prototype.XBe=function(t){return this.gLt.XBe(t)},A.prototype.addColumn=function(t){this.cBe(t,!0)},A.prototype.cBe=function(t,n,i){var r,n,r,e;t=this.qGe(t),r=(0,S.isNamedFormulaColumn)(t),(n||r)&&(t=f({},t)),r?(t.value=t.name,delete t.dataType):t.name=(0,p.getColumnName)(t),n=this.$Ge(t),(r=this.tUe(i))?r.isCross?(e=this.nUe(i,r),this.yLt.splice(e,0,t),this.ILt.splice(r.RBt,0,t)):(i=this.uPt(i),this.yLt.splice(i,0,t),this.ILt.splice(i,0,t)):(this.yLt.push(t),this.ILt.push(t)),this.eUe(t),this.AGe.nGe({type:_.ViewChangeType.AddColumn,newData:f({},t)}),n||(this.lLt&&this.lLt.addBaseField(t),this.Xhe(t)&&this.yde&&this.$he(),this.PPt(),this.Gfe())},A.prototype.tUe=function(t){var n,t,n=(0,S.isNumber)(t)&&0<=t&&t<this.yLt.length,t=(n=n&&(!(0<this.CLt.length)||t>=this.CLt.length))&&this.Dve(t);if(n&&!t.isGroup)return t},A.prototype.nUe=function(t,n){var i,r;if(n=n||this.tUe(t)){if(n.isCross)for(i=t-1;0<=i;i--)if(!(r=this.Dve(i)).isCross||r.RBt!==n.RBt)return i+1;return t}return this.yLt.length},A.prototype.iUe=function(t,n,i){this.rUe(a,t,a,n,i)},A.prototype.rUe=function(n,i,r,t,e){var o,t,u,e,t,t,o=this,t=o.GLt(t,e),u=t.success,e=t.fail;if(i=f({},o.qGe(i)),t=o.gLt.hasExistedColumn(i),D(i)||t)return t?(t=o.UGe(o.ife(i),!0,!0),o.cBe(t,!1,n),void o.pUe(t,i,r,u,e)):(r&&r(a),o.cBe(i,!1,n),void u({success:!0,column:f({},i)}));o.gLt.addColumn(i,function(t){r&&r(t),o.cBe(i,!1,n),t.column=f({},i),(t.table||t.source)&&o.AGe.nGe({type:_.ViewChangeType.DefineColumnAddColumn,name:(0,p.getColumnName)(i),table:t.table,source:t.source}),u(t)},e)},A.prototype.$Ge=function(n){var t=this,i=t.ILt.some(function(t){return t.value===n.value&&(0,S.isNullOrUndefined)(n.cross)}),t=!i&&t.yLt.some(function(t){return t.value===n.value});return i||t},A.prototype.qGe=function(t){return"string"==typeof t?t={name:t,value:t}:t.name||"string"!=typeof t.value||(t.name=t.value),t.value&&"="===t.value[0]&&(t.readonly=!0),"date"===t.dataType&&(0,p.applyDateTimePicker)(t),t},A.prototype.vGe=function(t,n,i,r){i?(this.yLt.splice(t,0,n),r&&this.lLt&&this.lLt.addBaseField(n),this.eUe(n),this.Xhe(n)&&this.yde&&this.$he(),this.PPt(),this.Gfe()):this.ILt.splice(t,0,n)},A.prototype.vBe=function(t){this.gLt.vBe(t)},A.prototype.bBe=function(t){this.gLt.bBe(t)},A.prototype.uBe=function(t){this.gLt.uBe(t)},A.prototype.getColumn=function(t){var n=this;return(0,S.isNullOrUndefined)(t)?n.getColumnInfos():n.Dve(t)},A.prototype.Dve=function(t,n,i){var r=this;if(!(t<0||t>=r.yLt.length))return r.oUe(r.uPt(t),n,i)},A.prototype.oUe=function(t,n,i){var t,n;if(t!==O)return t=this.yLt[t],n&&(n=this.hHe(t))?f(f({},t),n):(this.gLt.jOt(t.value)&&(t.isPrimaryKey=!0),i?t:f({},t))},A.prototype.hHe=function(t){var t,n,t=(0,p.getColumnName)(t),n=this.gLt.jRt(t);if(n)return(0,S.isNullOrUndefined)(n.value)&&(n.value=n.name=t),n},A.prototype.dHe=function(t){var n=t.value;return!(0,S.isNullOrUndefined)(this.UGe((0,S.isNullOrUndefined)(n)?t:n,!0))},A.prototype.updateColumn=function(t){this.yBe(t)},A.prototype.yBe=function(t,n){var i,r,i=this,r;!!t.cross||!1===n?i.aUe(t):(i.uUe(t),i.PPt(),i.Gfe())},A.prototype.dGe=function(n,t){var i,r,e,i,r,e=this,i=null==(i=this.yLt.filter(function(t){return t.name===n}))?void 0:i[0],r=null==(r=this.ILt.filter(function(t){return t.name===n}))?void 0:r[0];(i||r)&&(i&&(i.name=t),r&&(r.name=t),e.lLt&&e.lLt.renameBaseField(n,t),e.AGe.nGe({type:_.ViewChangeType.UpdateColumnName,oldName:n,newName:t}))},A.prototype.aUe=function(n){var t,i,r,t=this,i=t.ILt.findIndex(function(t){return t.name===n.name});i<0||(r=t.ILt[i]?f({},t.ILt[i]):null,t.ILt[i]=n,t.AGe.nGe({type:_.ViewChangeType.UpdateColumn,oldData:r}))},A.prototype.uUe=function(n){var t,i,r,t=this,i=this.yLt.findIndex(function(t){return t.name===n.name});i<0||(r=t.yLt[i]?f({},t.yLt[i]):null,t.yLt[i]=n,this.AGe.nGe({type:_.ViewChangeType.UpdateColumn,oldData:r}))},A.prototype.sUe=function(t){var n,i,r,e,i=this;i.cUe(t),null!=(n=i.xLt)&&n.call(i,t),r=[],(e=i.ILt.map(function(t,n){return{index:n,option:t}})).forEach(function(t,n){(0,S.isNullOrUndefined)(t.option.cross)||r.push({oldIndex:t.index,newIndex:n})}),i.wLt(r)},A.prototype.cUe=function(t){var n,i,r,e,t,r,o,u,s,c,n=this,i={columnInfoOptions:(0,S.clone)(n.ILt),options:(0,S.clone)(n.LEt),columnInfos:(0,S.clone)(n.yLt)},r=n.ILt.map(function(t,n){return{index:n,option:t}}),e=(r.splice(t,1)[0]||{}).option,t=r.map(function(t){return t.option}),r=n.LEt;if(e&&"string"==typeof e.cross){for(o=!1,u=0,s=t;u<s.length;u++)if((c=s[u])&&c.cross===e.cross){o=!0;break}!o&&r.cross&&delete r.cross[e.cross]}this.AGe.nGe({type:_.ViewChangeType.RemoveColumnInfoOptions,oldData:i}),n.ILt=t,n.LEt=r},A.prototype.mGe=function(t,n){var i=this;i.ILt=t,i.LEt=n},A.prototype.UGe=function(n,t,i){var r,e;if((0,S.isNumber)(n))return this.Dve(n,!1,t);if((0,S.isString)(n)){if(r=void 0,-1<(e=this.yLt.findIndex(function(t){return(0,p.getColumnName)(t)===n})))r=this.oUe(e,!1,t);else if(i&&(r=this.hHe(n)))return f({},r);return r}return n},A.prototype.xRe=function(n){var i,r,t,i=this,r=i.UGe(n),t=function(){var t=i.getHierarchyColumnIndex();return t===n||i.yLt[t].value===r.value};return!(!r||!(r.isGroup||r.isCross||i.isHierarchy()&&t()||i.ABe(r,!0)||i.xBe(r)))},A.prototype.aHe=function(t,n){var i,t,r,i=this,t=i.UGe(t),r=function(t,n){var t,n,t=(0,S.isFormula)(t.value)||(0,S.isRelation)(t.value)||i.FPt(t.value,!0)||(0,S.isNamedFormulaColumn)(t),n=i.gLt.isDataColumn(n);return t&&n};return!(r(t,n)||r(n,t))},A.prototype.xBe=function(t){return this.gLt.xBe(this.ife(t))},A.prototype.removeColumn=function(t){this.VBe(t)},A.prototype.VBe=function(t,e){var o,n,u,o=this,n=this.UGe(t);this.xRe(n)||(this.fUe(n),this.GGe(n),u=this.lLt&&this.lLt.removeField(t),this.lUe(t,function(t,n,i,r){var i=e?e(n,i):i.splice(n,1)[0];o.AGe.nGe({type:_.ViewChangeType.DeleteColumn,index:n,oldData:i,isInfo:r,isField:!!r&&u})}))},A.prototype.hUe=function(t,n,i){this.dUe(t,a,n,i)},A.prototype.dUe=function(t,n,i,r){var e,i,o,r,u,e=this,i=e.GLt(i,r),o=i.success,r=i.fail,u=e.ife(t);D(u)?(n&&n(a),e.removeColumn(u),o({success:!0})):e.gLt.removeColumn(u,function(t){n&&n(t),e.removeColumn(u),e.AGe.nGe({type:_.ViewChangeType.DefineColumnRemoveColumn,name:u,table:t.table,source:t.source}),o(t)},r)},A.prototype.fUe=function(i){var r,e,o,u,t,n,s,r=this,e=r.CLt;if(e&&0<e.length)for(o=r.yLt,u=o.length,t=function(n){var t=o[n];if(i===t)return r.CLt=e=e.map(function(t){return n<t&&--t,t}),r.oPt=(0,p.generatePinnedColumnIndexMap)(e,u-1),"break"},n=0;n<u&&"break"!==(s=t(n));n++);},A.prototype.eUe=function(i){var r,e,o,u,t,n,s,r=this,e=r.CLt;if(e&&0<e.length)for(o=r.yLt,u=o.length,t=function(n){var t=o[n];if(i===t)return r.CLt=e=e.map(function(t){return n<=t&&(t+=1),t}),r.oPt=(0,p.generatePinnedColumnIndexMap)(e,u),"break"},n=0;n<u&&"break"!==(s=t(n));n++);},A.prototype.OGe=function(){var t=this;return{sortBefore:(0,p.removeExtraInfos)(t.DLt),sortAfter:(0,p.removeExtraInfos)(t._Lt),sortInfo:(0,p.removeExtraInfos)(t.kLt)}},A.prototype.YBe=function(t,n,i,r){var e,o,u,e=this,o=this.qGe(n);return i&&(o=f({},o)),(0,S.isNamedFormulaColumn)(o)?(o.value=o.name,delete o.name,delete o.dataType):o.name=(0,p.getColumnName)(o),e.vUe(t,o,r),u=o,e.lUe(t,function(t,n,i,r){u=e.gUe(o,t),i.splice(n,1,u),e.AGe.nGe({type:_.ViewChangeType.UpdateColumn,index:n,oldData:f({},t),isInfo:r})}),r&&r.isNameUpdated&&e.dGe(t,(0,p.getColumnName)(u)),u},A.prototype.mUe=function(t,n,i,r){this.pUe(t,n,a,i,r)},A.prototype.pUe=function(t,n,i,r,e){var o,r,u,e,s,c,r,o=this,r=o.GLt(r,e),u=r.success,e=r.fail;n=o.qGe(n),t=o.UGe(t),s=n.type!==t.type?f({},n):f(f({},t),n),o.aHe(t,s)?(c=(0,S.isNamedFormulaColumn)(t)?t.name:o.ife(t),(0,S.isFormula)(c)&&(0,S.isFormula)(s.value)&&!(0,S.isNamedFormulaColumn)(s)||(0,S.isRelation)(c)&&(0,S.isRelation)(s.value)||(0,S.isFormula)(c)&&(0,S.isRelation)(s.value)||(0,S.isRelation)(c)&&(0,S.isFormula)(s.value)?(r=i?{onSucceededBefore:i}:a,n=o.YBe(c,s,!1,r),u(f({success:!0,column:f({},n)},r))):(0,S.isFormula)(c)&&(0,S.isNamedFormulaColumn)(s)?o.iUe(s,function(t){o.VBe(c,function(t,n){return n.splice(t,1,n.pop())[0]}),u(t)},e):o.gLt.updateColumn(c,n,function(t){t.onSucceededBefore=function(t){t.isNameUpdated&&o.lLt&&o.lLt.renameBaseField(c,(0,p.getColumnName)(n)),i&&i(t)},n=o.YBe(c,s,!1,t),t.column=f({},n),o.AGe.nGe({type:_.ViewChangeType.DefineColumnModifyColumn,table:t.table,source:t.source}),u(t)},e)):e()},A.prototype.vUe=function(t,n,i){var r,e,o,u,s,t,r=this,e=r.UGe(t),o=r.TGe(n,e),u=r.jGe(n,e),s=r.kGe(n,e),t=t!==r.ife(n);t&&r.GGe(e,n),i?(i.isNameUpdated=t,i.isFilterUpdated=o,i.isSortUpdated=u,i.isGroupUpdated=s,i.onSucceededBefore(i)):o?r.tFt(a,a,a,!0):s?r.nPt(a,!0):u&&r.NFt(!0)},A.prototype.lUe=function(t,n){for(var i,r,e,o,u,i=this.ILt,r=0;r<i.length;r++)if(e=i[r],this.bUe(e,t)){n(e,r,i,!1);break}for(o=this.yLt,r=0;r<o.length;r++)if(u=o[r],this.bUe(u,t)){n(u,r,o,!0);break}this.PPt(),this.Gfe()},A.prototype.bUe=function(t,n){return t.value===n||t.name===n},A.prototype.gUe=function(t,n){return t.type!==n.type?f({},t):f(f({},n),t)},A.prototype.tFt=function(t,n,i,r){n||this.gFt(t);var n=this.mFt(r);n&&this.dFt(),this.vFt(r),this.nPt(n?O:i,r),this.wFt=O,this.Efe=O},A.prototype.VAe=function(){this.AGe.VAe()},A.prototype.zAe=function(){this.AGe.zAe()},A.prototype.eGe=function(){return this.AGe.eGe()},A.prototype.$Be=function(){return this.AGe.$Be()},A.prototype.tGe=function(t){this.AGe.tGe(t)},A.prototype.iGe=function(){this.AGe.iGe()},A.prototype.Mtt=function(t){return this.AGe.Mtt(t)},A.prototype.excludeInsertedPinnedRows=function(){for(var t,n,i,r,t=this,n=t.lFt,i=[],r=0;r<n.length;r++)t.isInserted(r)||i.push(n[r]);return i},A.prototype.toJSON=function(){var i,t,r,n,e,i=this,t={};if(i._Lt&&(t={sortBefore:(0,p.removeExtraInfos)(i.DLt),sortAfter:(0,p.removeExtraInfos)(i._Lt)}),0===(r=i.ILt).length)0===i.yLt.length&&i.cPt(),r=i.ILt=i.yLt;else for(n=function(n){var t,t,t,t=r[n].cross;(0,S.isNullOrUndefined)(t)&&(t=i.yLt.filter(function(t){return t.value===r[n].value})[0])&&(r[n]=t),(t=r[n].validator)&&"date"===t.type&&(l(t.value1)&&(t.value1=d(t.value1)),l(t.value2))&&(t.value2=d(t.value2))},e=0;e<r.length;e++)n(e);return f(f({},t),{name:i.name,options:i.LEt,columns:i.ILt,indexMap:i.iRt,columnIndexMap:i.oPt,autoSort:i.autoSort,sortInfo:(0,p.removeExtraInfos)(i.kLt),autoFilter:i.autoFilter,filterInfo:(0,p.removeExtraInfos)(i.NLt),autoGroup:i.autoGroup,groupInfo:i.MFt,detailColumnsVisible:i.UFt,pinnedRows:i.excludeInsertedPinnedRows(),pinnedColumns:i.CLt})},A.prototype.fromJSON=function(t){var n,i,r,e,o,u,n=this;if(n.iRt=t.indexMap,i=t.columnIndexMap,r=n.yLt,i&&r&&0<i.length&&i.length<r.length)for(e=i.length;e<r.length;e++)i[e]=e;for(e=0;e<r.length;e++)(o=r[e].validator)&&"date"===o.type&&("string"==typeof o.value1&&(u=v(o.value1))&&(o.value1=u),"string"==typeof o.value2)&&(u=v(o.value2))&&(o.value2=u);n.oPt=i,n.autoSort=t.autoSort,n.kLt=t.sortInfo,n.DLt=t.sortInfo,t.sortAfter&&(n.DLt=t.sortBefore,n._Lt=t.sortAfter),n.autoFilter=t.autoFilter,n.NLt=t.filterInfo,n.autoGroup=t.autoGroup,n.MFt=t.groupInfo,n.UFt=t.detailColumnsVisible,n.lFt=t.pinnedRows,n.CLt=t.pinnedColumns},t.View=A},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(t,n){var i,r,n,e,o,u;e=this,void 0!==(n="function"==typeof(i=o=function(t,n){"use strict";var i,r=5e3,e="callback",o=null;function h(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function l(n){try{delete window[n]}catch(t){window[n]=void 0}}function d(t){var t=document.getElementById(t);t&&document.getElementsByTagName("head")[0].removeChild(t)}function u(o){var u,s,c,f,a,u=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=o,c=u.timeout||r,f=u.jsonpCallback||e,a=void 0;return new Promise(function(t,n){var i,r,e,i=u.jsonpCallbackFunction||h(),r=f+"_"+i;window[i]=function(n){t({ok:!0,json:function t(){return Promise.resolve(n)}}),a&&clearTimeout(a),d(r),l(i)},s+=-1===s.indexOf("?")?"?":"&",(e=document.createElement("script")).setAttribute("src",""+s+f+"="+i),u.charset&&e.setAttribute("charset",u.charset),e.id=r,document.getElementsByTagName("head")[0].appendChild(e),a=setTimeout(function(){n(new Error("JSONP request to "+o+" timed out")),l(i),d(r),window[i]=function(){l(i)}},c),e.onerror=function(){n(new Error("JSONP request to "+o+" failed")),l(i),d(r),a&&clearTimeout(a)}})}n.exports=u})?i.apply(n,r=[n,t]):i)&&(t.exports=n)},"./node_modules/whatwg-fetch/fetch.js":function(t,n,i){"use strict";var s,r,e,o,u,c;function f(t){return t&&DataView.prototype.isPrototypeOf(t)}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return t="string"!=typeof t?String(t):t}function l(n){var t={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return s.iterable&&(t[Symbol.iterator]=function(){return t}),t}function d(n){this.map={},n instanceof d?n.forEach(function(t,n){this.append(n,t)},this):Array.isArray(n)?n.forEach(function(t){this.append(t[0],t[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(t){this.append(t,n[t])},this)}function v(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(i){return new Promise(function(t,n){i.onload=function(){t(i.result)},i.onerror=function(){n(i.error)}})}function w(t){var n,i,n=new FileReader,i=p(n);return n.readAsArrayBuffer(t),i}function b(t){var n,i,n=new FileReader,i=p(n);return n.readAsText(t),i}function m(t){for(var n,i,r,n=new Uint8Array(t),i=new Array(n.length),r=0;r<n.length;r++)i[r]=String.fromCharCode(n[r]);return i.join("")}function j(t){var n;return t.slice?t.slice(0):((n=new Uint8Array(t.byteLength)).set(new Uint8Array(t)),n.buffer)}function y(){return this.bodyUsed=!1,this.HPt=function(t){(this.zPt=t)?"string"==typeof t?this.VPt=t:s.blob&&Blob.prototype.isPrototypeOf(t)?this.YPt=t:s.formData&&FormData.prototype.isPrototypeOf(t)?this.ZPt=t:s.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this.VPt=t.toString():s.arrayBuffer&&s.blob&&f(t)?(this.WPt=j(t.buffer),this.zPt=new Blob([this.WPt])):s.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||e(t))?this.WPt=j(t):this.VPt=t=Object.prototype.toString.call(t):this.VPt="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this.YPt&&this.YPt.type?this.headers.set("content-type",this.YPt.type):s.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s.blob&&(this.blob=function(){var t=v(this);if(t)return t;if(this.YPt)return Promise.resolve(this.YPt);if(this.WPt)return Promise.resolve(new Blob([this.WPt]));if(this.ZPt)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.VPt]))},this.arrayBuffer=function(){return this.WPt?v(this)||Promise.resolve(this.WPt):this.blob().then(w)}),this.text=function(){var t=v(this);if(t)return t;if(this.YPt)return b(this.YPt);if(this.WPt)return Promise.resolve(m(this.WPt));if(this.ZPt)throw new Error("could not read FormData body as text");return Promise.resolve(this.VPt)},s.formData&&(this.formData=function(){return this.text().then(O)}),this.json=function(){return this.text().then(JSON.parse)},this}function g(t){var n=t.toUpperCase();return-1<o.indexOf(n)?n:t}function _(t,n){var i=(n=n||{}).body;if(t instanceof _){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t.zPt||(i=t.zPt,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",!n.headers&&this.headers||(this.headers=new d(n.headers)),this.method=g(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this.HPt(i)}function O(t){var i=new FormData;return t.trim().split("&").forEach(function(t){var t,n,t;t&&(n=(t=t.split("=")).shift().replace(/\+/g," "),t=t.join("=").replace(/\+/g," "),i.append(decodeURIComponent(n),decodeURIComponent(t)))}),i}function S(t){var i,n,i=new d,n;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var t,n,t,t=t.split(":"),n=t.shift().trim();n&&(t=t.join(":").trim(),i.append(n,t))}),i}function C(t,n){n=n||{},this.type="default",this.status=void 0===n.status?200:n.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new d(n.headers),this.url=n.url||"",this.HPt(t)}i.r(n),i.d(n,{DOMException:function(){return c},Headers:function(){return d},Request:function(){return _},Response:function(){return C},fetch:function(){return R}}),(s={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self}).arrayBuffer&&(r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],e=ArrayBuffer.isView||function(t){return t&&-1<r.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,n){t=a(t),n=h(n);var i=this.map[t];this.map[t]=i?i+", "+n:n},d.prototype.delete=function(t){delete this.map[a(t)]},d.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},d.prototype.set=function(t,n){this.map[a(t)]=h(n)},d.prototype.forEach=function(t,n){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(n,this.map[i],i,this)},d.prototype.keys=function(){var i=[];return this.forEach(function(t,n){i.push(n)}),l(i)},d.prototype.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),l(n)},d.prototype.entries=function(){var i=[];return this.forEach(function(t,n){i.push([n,t])}),l(i)},s.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries),o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],_.prototype.clone=function(){return new _(this,{body:this.zPt})},y.call(_.prototype),y.call(C.prototype),C.prototype.clone=function(){return new C(this.zPt,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},C.error=function(){var t=new C(null,{status:0,statusText:""});return t.type="error",t},u=[301,302,303,307,308],C.redirect=function(t,n){if(-1===u.indexOf(n))throw new RangeError("Invalid status code");return new C(null,{status:n,headers:{location:t}})},c=self.DOMException;try{new c}catch(t){(c=function(t,n){this.message=t,this.name=n;var n=Error(t);this.stack=n.stack}).prototype=Object.create(Error.prototype),c.prototype.constructor=c}function R(o,u){return new Promise(function(i,t){var n,r,n=new _(o,u);if(n.signal&&n.signal.aborted)return t(new c("Aborted","AbortError"));function e(){r.abort()}(r=new XMLHttpRequest).onload=function(){var t,n,t={status:r.status,statusText:r.statusText,headers:S(r.getAllResponseHeaders()||"")};t.url="responseURL"in r?r.responseURL:t.headers.get("X-Request-URL"),n="response"in r?r.response:r.responseText,i(new C(n,t))},r.onerror=function(){t(new TypeError("Network request failed"))},r.ontimeout=function(){t(new TypeError("Network request failed"))},r.onabort=function(){t(new c("Aborted","AbortError"))},r.open(n.method,n.url,!0),"include"===n.credentials?r.withCredentials=!0:"omit"===n.credentials&&(r.withCredentials=!1),"responseType"in r&&s.blob&&(r.responseType="blob"),n.headers.forEach(function(t,n){r.setRequestHeader(n,t)}),n.signal&&(n.signal.addEventListener("abort",e),r.onreadystatechange=function(){4===r.readyState&&n.signal.removeEventListener("abort",e)}),r.send(void 0===n.zPt?null:n.zPt)})}R.polyfill=!0,self.fetch||(self.fetch=R,self.Headers=d,self.Request=_,self.Response=C)},CalcEngine:function(t){"use strict";t.exports=i("@spreadjs/js-calc")},Common:function(t){"use strict";t.exports=i("@spreadjs/js-sheets-common")}},o={},s.d=function(t,n){for(var i in n)s.o(n,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},s.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u=s("./dist/src/dataManager.entry.js"),(r={}).Data=u,t.exports=r.Data},"./node_modules_local/@spreadjs/js-data-manager/index.js":function(t,n,i){t.exports=i("./node_modules_local/@spreadjs/js-data-manager/dist/gc.data.js")},"@spreadjs/js-sheets-common":function(t){"use strict";t.exports=GC.Spread},"@spreadjs/js-calc":function(t){"use strict";t.exports=GC.Spread.CalcEngine}},r={},t=e("./node_modules_local/@spreadjs/js-data-manager/index.js"),(GC=void 0===GC?{}:GC).Data=t}();
;var GC;(()=>{var t,e,r;function i(r){var n,n,n=e[r];return void 0!==n||(n=e[r]={exports:{}},t[r](n,n.exports,i)),n.exports}t={"./node_modules_local/@spreadjs/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":(r,n,o)=>{var f;!function(){"use strict";var t,e,r,n,i;function u(r){var n,n,n=e[r];return void 0!==n||(n=e[r]={exports:{}},t[r](n,n.exports,u)),n.exports}t={"./src/functions-basic.ts":function(k,r,j){var a,N,c,q,o,B,F,s,Q,Y,G,m,r,x,T,l,O,P,H,_,X,v,W,J,K,R,$,z,Z,rr,nr,tr,er,w,I,ir,ur,p,A,y,D,h,b,L,or,g,fr,ar,cr,V,U,sr,_r,lr,vr,u,gr,Er,pr,dr,Tr,Ar,yr,Cr,Mr,f,Sr,E,r,mr,Or,Nr,Rr,wr,Ir,Dr,hr,br,Lr,Vr,Ur,n,kr,t,jr,qr,Br,Fr,e,Qr,i,Yr,Gr,d,C,xr,Pr,Hr,Xr,Wr,Jr,Kr,$r,zr,Zr;function rn(r,n){for(;0!==n;){var t=r%n;r=n,n=t}return r}function nn(r,n,t,e){return 0===n||0===r?0:0!==t&&r<0?!0===e?E(r/Math.abs(n))*Math.abs(n):Sr(r/Math.abs(n))*Math.abs(n):!0===e?Sr(r/Math.abs(n))*Math.abs(n):E(r/Math.abs(n))*Math.abs(n)}function tn(t,r,n){var e,i,u,o,f,a,c,s,_,l,v,g,E,p,d,T,A,y,C;function M(r){return r.getRowCount?r.getRowCount()!==t[1].getRowCount()||r.getColumnCount()!==t[1].getColumnCount():r.rowCount!==f||r.colCount!==a}function S(n){var t=n.getSource();return function(r){return{id:t.id,source:t,row:n.getRow(0)+R(r/a),col:n.getColumn(0)+r%a,rowCount:1,colCount:1}}}if(i=(e=t[0]).source&&e.source.Lbt,t[1].Zbt=!0,o=i.calcOnDemand?(u={rowCount:t[1].getRowCount(),colCount:t[1].getColumnCount()},function(r){return N.Convert.Nbt(t[1].getValueByIndex(r),1,!N.ExcelCompatibleCalcMode,!0)}):(u=V(t[1],1,2,!1,!1,!0),function(r){return u[r]}),f=u.rowCount,a=u.colCount,c=[],l=i.dynamicReferences,(v=l&&e.Xkt)&&b(t[1])&&!n&&(u.getRef=S(t[1])),E=0,p=r?(s=[],n?function(r){_=o(r),s.push(_)}:function(r){(_=o(r))!==D&&s.push(_)}):function(r){if((_=o(r))!==D){if(h(_))return E=_,!0;E+=_}},d=u.getRef?function(r){return $n(v,u.getRef(r)),p(r)}:p,T=i.S9t||new N.Functions.RangeCriteriaManager,M(t[2]))return I;if(t.length<=3)g=d;else{for(A=4;A<m(t);A+=2)if(M(t[A]))return I;if(!v){for(y=[],A=2;A<m(t);A+=2)y.push(t[A],t[A+1]);return T.Fde(y,d,1),r?r(s):E}for(A=4;A<m(t);A+=2)v&&b(t[A])&&(t[A].getRef=S(t[A])),C=v&&(v.delay||b(t[A])),c.push(T.T9t(t[A],t[A+1],C?-1:0));g=function(r){for(var n=0;n<c.length;n++)if(t[2*n+4].getRef&&$n(v,t[2*n+4].getRef(r)),!c[n].A9t(r))return;return d(r)}}return T.I9t(t[2],t[3],g,v&&v.delay?-1:1),r?r(s):E}function en(r,n){return n=n<0?R(n):Math.ceil(n),(r&&n%2==0||!r&&n%2!=0)&&(n+=n<0?-1:1),n}function un(r,n,t){return 0<n&&t<0?y:n<0&&0<t?(t=-t,r?E(n/t)*t:Sr(n/t)*t):r?Sr(n/t)*t:E(n/t)*t}function on(r,n,t){var e,i,u,r,e=f.x9t(v(t)),i=Sr(n=t<0?n/e:n*e),u=E(n);return r&&(r=i,i=u,u=r),n=n<0?i:u,U(n=t<0?n*e:n/e)}function fn(r,n,t,e){var i=n?-1:1,u=0,o,f,a;if(m(t)!==m(e))return A;for(a=0;a<m(t);a++)o=t[a],f=e[a],o!==D&&f!==D&&(u+=r?(o-f)*(o-f):o*o+i*f*f);return U(u)}function an(r){return U(v(r))}function cn(r){return r=fr(r),isNaN(r)?I:E(r)}function sn(r,n){var t=1,e;if(r<n)return y;for(n=K(r-n,n),e=1;e<=n;e++)t=t*(r-e+1)/e;return U(t)}function _n(r,n){for(var t=1,e,e=1;e<=n;e++)t*=r+e-1;for(e=2;e<=n;e++)t/=e;return U(t)}function ln(r,n){var t,e,i,u,o,f,f;if(!r||255<r.length)return 0;if(0===(t=r.length))return 0;if("-"===r[0])return y;for(e=0;e<t&&" "===r[e];)e++;if(i=0,e===t)return 0;for(o=t-(u=1);e<=o;o--){if((f=0<=(f=r.charCodeAt(o)|" ".charCodeAt(0))-"a".charCodeAt(0)?f-87:f-48)<0||n<=f)return y;i+=f*u,u*=n}return i}function vn(r){return 180*r/Z}function gn(r){return en(!0,r)}function En(r){return en(!1,r)}function pn(r){return Ar(r)}function dn(r){for(var n=1,t,t=r;1<t;t-=2)n*=t;return n}function Tn(r){return U(z(r))}function An(r,n){return r-n*R(r/n)}function yn(){return Z}function Cn(r,n){var r;return 0===r&&n<0?w:0===r&&0===n||(r=N.Functions.MathHelper.N9t(r,n))===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY||isNaN(r)?y:r}function Mn(){for(var r,n,t,e,i,u,r=arguments,n=0,t=0;t<m(r);t++){if(u=i=void 0,h(e=r[t]))return e;if(b(e)||L(e)){if((i=V(e,1,!0,!0,!1)).isError)return i[0]}else i=V(e,1,!0,!0,!0);for(u=0;u<m(i);u++)i[u]!==D&&(n+=i[u])}return n}function Sn(){var r,n,t,e,i,u;if(!N.ExcelCompatibleCalcMode)return Mn.apply(null,arguments);for(r=arguments,t=n=0;t<m(r);t++){if(u=i=void 0,h(e=r[t]))return e;if(b(e)||L(e)){if((i=V(e,5,!0,!0,!1,!0)).isError)return i[0]}else i=V(e,1,!0,!0,!1,!0);for(u=0;u<m(i);u++)i[u]!==D&&(n+=i[u])}return n}function mn(r){return 0===r?0:-1}function On(){for(var r,n,t,e,i,u,r=arguments,n=0,t=0;t<m(r);t++)for(i=r[t],e=0;e<m(i);e++){if((u=i[e])===D)return I;if(u<0)return y;n=rn(n,g(u))}return n}function Nn(){for(var r,n,t,e,i,u,o,r=arguments,n=1,t=[],e=0;e<m(r);e++)for(u=r[e],i=0;i<m(u);i++)if((o=u[i])!==D){if((o=g(o))<0)return y;if(0===o)return 0;t.push(o)}for(i=0;i<m(t);i++)n=n/rn(n,o=t[i])*o;return n}function Rn(){return yr(arguments,2,6)}function wn(r){return W(r)}function In(r,n){return _((r/n).toString())}function Dn(r){for(var n,t,e,n=arguments,t=[],e=1;e<m(n);e++)t[e-1]=n[e];return bn(r,0,t)}function hn(r){for(var n,t,e,n=arguments,t=[],e=1;e<m(n);e++)t[e-1]=n[e];return bn(r,1,t)}function bn(r,n,t){var e=I;return 0<=x(r,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])?e=yr(t,n,r):0<=x(r,[7,107,8,108,10,110,11,111])&&(e=Mr(t,n,r)),e}function Ln(r,n,t){for(var e,i,u,e=arguments,i=[],u=3;u<m(e);u++)i[u-3]=e[u];return Cr(i,t,n,r)}function Vn(r,n){return un(!0,r,n)}function Un(r,n){return un(!1,r,n)}function kn(r,n,t){return nn(r,n,t,!0)}function jn(r,n,t){return nn(r,n,t,!1)}function qn(r,n,t){var r=""+r.toString(n);return t&&r.length<t?Array.apply(null,{length:t-r.length+1}).join(0)+r:r}function Bn(r,n){return r<0&&0<n||n<0&&0<r?y:E(r/n+.5)*n}function Fn(r,n){return f.Lkt(r,n)}function Qn(r,n){return on(!1,r,n)}function Yn(r,n){return on(!0,r,n)}function Gn(r){return U($(r))}function xn(r,n){return Sr(r/v(n))*v(n)}function Pn(r,n){return E(r/v(n))*v(n)}function Hn(r,n){return 1===n?w:U(f.ckt(r,n))}function Xn(r){return U(f.ckt(r,10))}function Wn(r,n,t,e,i){var u,o,f,a,c,s,_,l,v,g,E,_,s,p,d,T,A,y,C,M,S,u=r.source&&r.source.Lbt,o=u&&u.dynamicReferences,f=e!==O&&b(e);return e=e!==O?e:n,c=a=0,s=L(n),_=L(e),(s?1:n.getRangeCount())!==(_?1:e.getRangeCount())?I:((l=e)===n||_||(g=s?n.getRowCount():n.getRowCount(0),E=s?n.getColumnCount():n.getColumnCount(0),g===e.getRowCount(0)&&E===e.getColumnCount(0))||(_=e.getRow(0),s=e.getColumn(0),l=e.create([{row:_,col:s,rowCount:g,colCount:E}]),v=!0),l.Zbt=!0,d=l.toArray(p=i?5:1,2,!1),f&&(T=l.getRow(0),A=l.getColumn(0),y=r.Xkt,C=e.getSource(),f=y&&C.getRangeKey,v)&&!o&&f&&$n(y,{id:C.id,source:C,row:T,col:A,rowCount:g,colCount:E}),(M=u.S9t||new N.Functions.RangeCriteriaManager).I9t(n,t,function(r){var n=d[r];if(o&&f&&$n(y,{id:C.id,source:C,row:T+R(r/E),col:A+r%E,rowCount:1,colCount:1}),h(n))return S=n,!0;n!==D&&(a+=n,c++)},y&&y.delay?-1:1),S||(i?0===c?w:U(a/c):U(a)))}function Jn(r,n,t,e){return Wn(r,n,t,e)}function Kn(r,n,t,e){return Wn(r,n,t,e,!0)}function $n(r,n){var t,t,t=n&&n.source;t&&t.getRangeKey&&(t=t.getRangeKey(t,n),r.qkt||(r.qkt={}),r.qkt[t]=n)}function zn(){return tn(arguments)}function Zn(){return tn(arguments,function(r){var n=null;return n=0<r.length?Math.max.apply(null,r):n})}function rt(){return tn(arguments,function(r){var n=null;return n=0<r.length?Math.min.apply(null,r):n})}function nt(){for(var r,n,t,e,r=arguments,n=m(r),t=[r[0],r[1]],e=1;e<n;e++)t[e+1]=r[e];return tn(t,function(r){return r.length},!0)}function tt(r){return tn(arguments,function(r){for(var n,t,e,i,n=0,t=0,e=0;e<r.length;e++){if(i=r[e],h(i))return i;n+=i,t++}return 0===t?w:U(n/t)})}function et(r){for(var n,t,e,n=[],t=0,e=[];t<r;t++)e[t]=0;for(t=0;t<r;t++)n[t]=e.slice(0),n[t][t]=1;return new N.CalcArray(n)}function it(){for(var r,n,t,e,i,u,o,f,a,c,s,r=arguments,n=0,e=[],s=0,t=0;t<m(r);t++){if((o=V(r[t],1,!0,!0,!1,!0)).isError)return o[0];if(o.isConvertError)return I;if(0===t)i=o.rowCount,u=o.colCount,s=m(o);else if(o.rowCount!==i||o.colCount!==u)return I;e.push(o)}for(t=0;t<s;t++){for(f=1,a=0;a<m(r);a++){if((c=e[a][t])===D){if(1===s)return I;f=0;break}f*=c}n+=f}return U(n)}function ut(){for(var r,n,t,e,i,u,r=arguments,u=0,t=0;t<m(r);t++)for(i=r[t],e=0;e<m(i);e++)(n=i[e])!==D&&(u+=n*n);return U(u)}function ot(r,n){return fn(!1,!0,r,n)}function ft(r,n){return fn(!1,!1,r,n)}function at(r,n){return fn(!0,!1,r,n)}function ct(r,n,t,e){for(var i,u,o=0,i=0;i<m(e);i++){if(u=fr(e[i]),P(u))return I;o+=u*nr(r,n+i*t)}return U(o)}function st(r){return U(W(r*Z))}function _t(r){return Z*r/180}function lt(r){return U(Math.sin(r))}function vt(r){var r=lt(r);return 0===r?w:1/r}function gt(r){return U(Math.cos(r))}function Et(r){var r=gt(r);return 0===r?w:1/r}function pt(r){return U(Math.tan(r))}function dt(r){return 0===r?w:U(1/Math.tan(r))}function Tt(r){return U(Math.asin(r))}function At(r){return U(Math.acos(r))}function yt(r){return U(f.vkt(r,!0))}function Ct(r){var r;return 709<r||r<-709?0:0===(r=yt(r))?w:1/r}function Mt(r){return U(f.vkt(r,!1))}function St(r){var r;return 709<r||r<-709?0:0===(r=Mt(r))?w:1/r}function mt(r){return U(z(r+W(r*r+1)))}function Ot(r){return U(z(r+W(r*r-1)))}function Nt(r){return U(Math.atan(r))}function Rt(r){return U(r<0?Math.PI+Math.atan(1/r):Math.atan(1/r))}function wt(r,n){return 0===r&&0===n?w:U(Math.atan2(n,r))}function It(r){var n=$(r),r=$(-r);return U(n-r)/(n+r)}function Dt(r){var n;return 0===r?w:10<r?1:r<-10?-1:1/It(r)}function ht(r){return U(z((1+r)/(1-r))/2)}function bt(r){return ht(1/r)}function Lt(r){var n=r.rowCount,t=1,e,i,u,o,f,a,c,s;if(1<r.rangeCount||n!==r.colCount)return I;for(e=0;e<n-1;e++){if(0===r[e][e]){for(a=!1,i=e+1;!a&&i<n;i++)if(0!==r[i][e]){for(o=e;o<n;o++)c=r[e][o],r[e][o]=r[i][o],r[i][o]=c;t*=-1,a=!0}if(!a)return 0}for(u=e+1;u<n;u++)if(0!==r[u][e])for(s=r[u][e]/r[e][e],f=e;f<n;f++)r[u][f]-=s*r[e][f]}for(e=0;e<n;e++)t*=r[e][e];return t}function Vt(r){var n,t,e,i,u,o,f,a,c,s,_,l,v,g,E,p,d,T,A,n=r.rowCount,t=[];if(1<r.rangeCount||n!==r.colCount)return I;for(A=[],e=0;e<n;e++)for(t[e]=[n],A[e]=[],o=0;o<n;o++)t[e][o]=e===o?1:0,A[e][o]=r[e][o];for(i=0;i<n;i++){if(0===A[i][i]){for(T=!1,f=i+1;!T&&f<n;f++)if(0!==A[f][i]){for(c=i;c<n;c++)p=A[i][c],A[i][c]=A[f][c],A[f][c]=p;for(s=1;s<n;s++)d=t[i][s],t[i][s]=t[f][s],t[f][s]=d;T=!0}if(!T)return y}for(a=0;a<n;a++)if(a!==i&&0!==A[a][i]){for(g=A[a][i]/A[i][i],_=i;_<n;_++)A[a][_]-=g*A[i][_];for(l=0;l<n;l++)t[a][l]-=g*t[i][l]}}for(u=0;u<n;u++)for(E=A[u][u],v=0;v<n;v++)t[u][v]/=E;return new N.CalcArray(t)}function Ut(r,n){var t,e,i,u,o,f,a,c,s,_,l,t=r.rowCount,e=r.colCount,i=n.rowCount,u=n.colCount,o=[];if(e!==i)return I;for(c=0;c<t;c++)for(o[c]=f=[],a=r[c],s=0;s<u;s++){for(_=l=0;_<i;_++)l+=a[_]*n[_][s];f[s]=l}return new N.CalcArray(o)}function kt(){for(var r,n,t,e,i,u,o,r=arguments,n=0,t=1,i=0;i<m(r);i++)for(e=r[i],u=0;u<m(e);u++){if((o=g(e[u]))<0||170<o)return y;n+=o,t*=Ar(o)}return n<0||170<n?y:Ar(n)/t}function jt(){return v(2*rr()-1)}function qt(r,n){var r,n;return n<r?y:(r=tr(r),n=R(n)+1,R(Math.random()*(n-r))+r)}function Bt(r,n){var t,e,i,u,o,f,a,c,s,_,l,v,t=["M","D","C","L","X","V","I"],e=[1e3,500,100,50,10,5,1],u=7,o=[],i=_r(n)?n?0:4:n;if(4<i||i<0)return I;for(f=0;f<7;f+=2){if(2<=f&&e[f-2]-e[f]<=r){for(c=(a=f)-2,s=void 0,s=0;s<i&&a+1<7&&e[c]-e[a+1]<=r;s++)a++;o.push(t[a]),o.push(t[c]),r=r+e[a]-e[c]}if(1<=f&&e[f-1]<=r&&(o.push(t[f-1]),r-=e[f-1]),1<=f&&e[f-1]-e[f]<=r){for(l=(_=f)-1,v=void 0,v=0;v<i&&_+1<7&&e[l]-e[_+1]<=r;v++)_++;o.push(t[_]),o.push(t[l]),r=r+e[_]-e[l]}for(;e[f]<=r;)o.push(t[f]),r-=e[f]}return o.join("")}function Ft(r){var n,t,e,i,u,o,f,a,c,s;if(!r.length)return 0;if(255<r.length)return I;for(t=(r=r.toLowerCase()).length-1,i=n=0,f=-1;0<=t&&" "===r[t];)t--;for(a=0;a<=t&&" "===r[a];)a++;c=!1,a<=t&&"-"===r[a]&&(c=!0,a++);do{for(s=r[e=t],--t;a<=t&&(r[t].charCodeAt(0)|" ".charCodeAt(0))===s.charCodeAt(0);)--t;switch(s){case"i":u=e-t,o=1;break;case"v":u=5*(e-t),o=5;break;case"x":u=10*(e-t),o=10;break;case"l":u=50*(e-t),o=50;break;case"c":u=100*(e-t),o=100;break;case"d":u=500*(e-t),o=500;break;case"m":u=1e3*(e-t),o=1e3;break;default:return I}}while(f<=o?(n+=u-i,f=o,i=0):i+=u,a<=t);return 0!==i&&(n-=i),n=c?-n:n}function Qt(r,n,t,e){var i,t,u,o,f,a,c;if(void 0===n&&(n=1),void 0===e&&(e=1),0===(r=void 0===r?1:r)||0===n)return p;if(r<0||n<0)return I;if("string"==typeof(i=t=void 0===t?1:t)||t instanceof Date){if(!N.Convert.sJ(t,t={}))return I;i=t.value}for(u=[],o=0,f=i;o<r;o++)for(u.push(a=[]),c=0;c<n;c++)a.push(f),f+=e;return new N.CalcArray(u)}function Yt(r,n,t,e,i){var u,o,f,a,c,s;if(void 0===n&&(n=1),0===(r=void 0===r?1:r)||0===n)return p;if(r<0||n<0)return I;if((e=void 0===e?1:e)<(t=void 0===t?0:t))return I;if((i=void 0===i?!1:i)&&(t!==R(t)||e!==R(e)))return I;for(u=e-t,i&&u++,o=[],f=0;f<r;f++)for(o.push(a=[]),c=0;c<n;c++)s=t+rr()*u,i&&(s=_(s)),a.push(s);return new N.CalcArray(o)}function Gt(r,n){for(var t,e,i,u,o,u=!0,t=0;t<m(n);t++)for(i=n[t],e=0;e<m(i);e++){if(N.ExcelCompatibleCalcMode){if("string"==typeof i[e]||T(i[e]))continue;u=!1}if(o={value:l},i[e]=mr(i[e],o)?o.value:D,r){if(!i[e])return!1}else if(i[e]&&i[e]!==D)return!0}return N.ExcelCompatibleCalcMode&&u?I:!!r}function xt(){return Gt(!0,arguments)}function Pt(){return Gt(!1,arguments)}function Ht(r){var r,n;return(!N.ExcelCompatibleCalcMode||"string"!=typeof r)&&(n=N.Convert.YK(r,r={}))?!r.value:I}function Xt(r,n,t){var e,n,i,r,t,e,n=n,i=sr(r);return!h(r)&&(r=t!==O?t:2!==m(arguments)&&null,or(i.value,t={}),t.value)?n:r}function Wt(r,n){return h(r)?n:r}function Jt(r,n){var t,e,i,i;if(!h(r)&&b(r)){if(1<r.getRangeCount())return I;if(e=t=0,i=this.k9t)if(t=i.row,e=i.col,(i=r.$gt&&r.$gt[0])&&1===i.rowCount&&1===i.colCount)e=t=0;else if(i&&(t+1>i.rowCount||e+1>i.colCount))return n;r=r.getValue(0,t,e)}return Wt(r,n)}function Kt(){return!0}function $t(){return!1}function zt(r,n){return Nr(r)?n:r}function Zt(){for(var r,n,t,r=0,n=arguments.length;r<n;r+=2){if(t={value:!1},h(arguments[r]))return arguments[r];if(!or(arguments[r],t))return I;if(t.value)return arguments[r+1]}return A}function re(){var r,n,t,e,i,r=arguments;if(r.length<3)return I;if(h(n=r[0]))return n;for(n===l&&(n=0),e=r.length-(t=1);t<e;t++){if(i=r[t],t++,h(i))return i;if(i===l&&(i=0),u(n)&&u(i)){if(n.toUpperCase()===i.toUpperCase())return r[t]}else if(n===i)return r[t]}return r.length%2==0?r[r.length-1]:A}function ne(){for(var r,n,t,e=0,r=0;r<m(arguments);r++)for(t=arguments[r],n=0;n<m(t);n++)t[n]&&e++;return!!(e%2)}function te(r,n,t){var e,i,u,o,f,e=r.source&&r.source.Lbt&&r.source.Lbt.MX;if(!e)return p;i=r.localScopes;try{if(r.lambdaFunctionCallDepth++,i.enterScope(),i.saveThenSwitchClosure(n.closure),(o=n.parameters).length!==t.length)return I;for(f=0;f<o.length;f++)r.localScopes.setVariable(o[f].value,t[f]);u=e.evaluate(n.calculation,r,!1,!1)}finally{r.lambdaFunctionCallDepth--,i.exitScope(),i.restoreClosure()}return u}function ee(r){return!L(r)||1===r.getColumnCount()&&1===r.getRowCount()}function ie(r){return L(r)?r instanceof N.TwoDimensionalCalcArray?r.getCalculatedValue():r.getValue(0,0):r}function ue(r,n,t){return r[n*r.colCount+t]}function oe(){var r,n,t,e,i,u,o,f,a,c,s,_,l,v,g,E,r=arguments,n=m(r),t=r[0],e=r[n-1];if(!(0,N.isLambdaFunction)(e))return I;for(i=[],o=u=0,f=1;f<n-1;f++){if(a=_u(r[f],0),h(a))return a;u=Math.max(u,a.rowCount),o=Math.max(o,a.colCount),i.push(a)}if(e.parameters.length!==i.length)return I;for(c=[],s=0;s<u;s++){for(_=[],l=0;l<o;l++){for(g=!(v=[]),f=0;f<i.length;f++){if(!(s<i[f].rowCount&&l<i[f].colCount)){g=!0;break}v.push(ue(i[f],s,l))}if(g)_.push(A);else{if((E=te(t,e,v))&&E.pause)return E;if(!ee(E))return p;E=ie(E),_.push(E)}}c.push(_)}return new N.CalcArray(c)}function fe(r,n,t,e){var i,u,o,f,a,c;if(t=_u(t,0,!1),h(t))return t;if(!(0,N.isLambdaFunction)(e)||2!==e.parameters.length)return I;for(i=t.rowCount,u=t.colCount,o=n,f=0;f<i;f++)for(a=0;a<u;a++)if(c=ue(t,f,a),(o=n===l&&0===f&&0===a?c:te(r,e,[o,c]))&&o.pause)return o;return o}function ae(r,n,t,e){var i,u,o,f,a,c,s,_;if(t=_u(t,0,!1),h(t))return t;if(!(0,N.isLambdaFunction)(e)||2!==e.parameters.length)return I;for(i=t.rowCount,u=t.colCount,o=[],f=n,a=0;a<i;a++){for(c=[],s=0;s<u;s++){if(_=ue(t,a,s),(f=n===l&&0===a&&0===s?_:te(r,e,[f,_]))&&f.pause)return f;if(!ee(f))return p;f=ie(f),c.push(f)}o.push(c)}return new N.CalcArray(o)}function ce(r,n,t,e){var i,u,o,f,a;if(!(0,N.isLambdaFunction)(e)||2!==e.parameters.length)return I;if(n<=0||t<=0)return I;for(i=[],u=0;u<n;u++){for(o=[],f=0;f<t;f++){if((a=te(r,e,[u+1,f+1]))&&a.pause)return a;if(!ee(a))return p;a=ie(a),o.push(a)}i.push(o)}return new N.CalcArray(i)}function se(r,n,t){var e,i,u,o,f,a,c;if(!(0,N.isLambdaFunction)(t)||1!==t.parameters.length)return 2===arguments.length?A:I;if(n=_u(n,0,!1),h(n))return n;for(e=n.rowCount,i=n.colCount,u=[],o=0;o<e;o++){for(f=[],a=0;a<i;a++)f.push(ue(n,o,a));if((c=te(r,t,[new N.CalcArray([f])]))&&c.pause)return c;if(!ee(c))return p;c=ie(c),u.push([c])}return new N.CalcArray(u)}function _e(r,n,t){var e,i,u,o,f,a,c;if(!(0,N.isLambdaFunction)(t)||1!==t.parameters.length)return 2===arguments.length?A:I;if(n=_u(n,0,!1),h(n))return n;for(e=n.rowCount,i=n.colCount,u=[],o=0;o<i;o++){for(f=[],a=0;a<e;a++)f.push(ue(n,a,o));if((c=te(r,t,[new N.CalcArray([f])]))&&c.pause)return c;if(!ee(c))return p;c=ie(c),u.push(c)}return new N.CalcArray([u])}function le(r){for(var n,t,e,i,u,n=r.getFullYear(),t=r.getMonth(),e,i=r.getDate(),u=0;u<t;u++)i+=Tr(n,u);return i}function ve(r){if(u(r)){if(7!==m(r)||P(_(r)))return I}else if(!P(r)){if(R(r)<1||17<R(r))return y;r=r.toString()}var n=["1","2","3","4","5","6","7"],t=[0,0,0,0,0,0,0],e;switch(m(r)){case 1:if(0<=x(r,n)){t[((e=_(r))+4)%7]=1,t[(e+5)%7]=1;break}return y;case 2:if("1"===r[0]&&0<=x(r[1],n)){t[((e=_(r[1]))+5)%7]=1;break}return y;case 7:for(e=0;e<7;e++)t[e]=_(r[e]);break;default:return I}return t}function ge(r,n,t,e,i){var u,o,u=S(n,3);if(h(u))return u;for(o=g(u),e=e.map(function(r){return vr(r)?s(r):r});t<0;++t)n.setDate(n.getDate()-1),o=0===o?6:o-1,(r&&(5===o||6===o)||!r&&i[o]||0<=e.indexOf(s(n)))&&t--;for(;0<t;--t)n.setDate(n.getDate()+1),o=6===o?0:o+1,(r&&(5===o||6===o)||!r&&i[o]||0<=e.indexOf(s(n)))&&t++;return s(n)}function Ee(r,n,t,e,i,u){var o,f,a,c,s,_,l,v,l;if(u&&(f=ve(r=r!==O?r:"0000011"),h(f)))return f;if(o=n!==O?V(n,4,!0,!0,!1):o){if(o.isError)return o[0];for(a=m(o),c=[],s=0;s<a;s++)_=o[s],v=(l=Q(_)).getDay(),l=m(f)?f[S(l,3)]:6===v||0===v,-1===c.indexOf(_)&&!l&&t<=_&&_<=e&&c.push(_);i-=m(c)}return i}function pe(r,n,t,e,i,u){var o,f,a,c,c,c,o=g(s(n)),f=g(s(t)),a=!1;if(f<o&&(c=n,n=t,t=c,c=o,o=f,f=c,a=!0),c=u(n,t,c=f-o+1,e),!r||!h(c)){if(c<=0)return 0;c=Ee(e,i,o,f,c,r),c=a?-c:c}return c}function de(r,n,t){var e,t;return n=N.Convert.r0(n),(e=new Date(n.getFullYear(),n.getMonth(),1)).setMonth(e.getMonth()+t),t=Tr(e.getFullYear(),e.getMonth()),e.setDate(r?t:K(n.getDate(),t)),e}function Te(r,n,t){r<=1899&&(r+=1900);var r=new Date(r,n-1,t);return r<new Date(1899,11,30)?y:r}function Ae(r,n,t){var e=Q(0);return e.setHours(r),e.setMinutes(n),e.setSeconds(t),e.setMilliseconds(0),e.getHours()<0&&e.getMinutes()<0&&e.getSeconds()<0?y:e}function ye(r){var n,t,e,i;if(!(n=!u(r)||(n=Y(r))||(n=new Date(r))&&!P(n.valueOf())?n:null))return I;if(e=n.getFullYear(),i=le(n),e<1900)return I;for(t=1900;t<e;t++)i+=365,gr(t)&&i++;return i}function Ce(r){var n;return(n=u(r)?(n=Y(r))||o.Z6t(r):n)?(60*(60*n.getHours()+n.getMinutes())+n.getSeconds())/86400:I}function Me(){return new Date}function Se(){var r=new Date;return r.setHours(0,0,0,0),r}function M(r){if(N.ExcelCompatibleCalcMode){var n=r.getMilliseconds();if(500<n)return new Date(r.getTime()+1e3-n)}return r}function me(r){return(r=M(r)).getHours()}function Oe(r){return(r=M(r)).getMinutes()}function Ne(r){return(r=M(r)).getSeconds()}function Re(r){return(r=M(r)).getDate()}function we(r){return(r=M(r)).getMonth()+1}function Ie(r){return(r=M(r)).getFullYear()}function De(r,n){var t,e,t;return r=M(r),1===n||17===n||T(n)||2===n||11===n||12===n||13===n||14===n||15===n||16===n?(t=le(r),e=new Date(r.getFullYear(),0,1).getDay(),2===n?--e:11===n||12===n||13===n||14===n||15===n?e=e-n+10:16===n&&(e+=1),(t=t-1-(6-(e=e<0?7+e:e)))<0&&(t=0),7===e&&16===n?g(t/7)+(t%7!=0?1:0):1+g(t/7)+(t%7!=0?1:0)):21===n?Fe(r):y}function S(r,n){var t,e,t=(r=M(r)).getDay();switch(n){case 1:case 17:return t+1;case 2:case 11:return 0===t?7:t;case 3:return 0===t?6:t-1;case 12:case 13:case 14:case 15:case 16:return 0==(e=(t+18-n)%7)?7:e;default:return y}}function he(r,n){return de(!1,r,n)}function be(r,n){return de(!0,r,n)}function Le(r,n,t){return ge(!0,r,n,t)}function Ve(r,n,t,e){var t=ve(t=T(t)&&0===n?1:t);return h(t)?t:"1111111"===t.join("")?I:ge(!1,r,n,e,t)}function Ue(r,n,t){function e(r,n,t){var e,r,i,r,e=g(s(n))-g(s(r)),r=r.getDay(),i=0;return e+=r,0<r&&(i=1),6!==(r=n.getDay())&&i++,t-(e+=7-r)/7*2+i}return pe(!1,r,n,O,t,e)}function ke(r,n,t,e){var i,u,o,f,a,c,s,i=ve(e=e!==O?e:"0000011"),o=u=0;if(h(i))return i;for(f=0;f<m(i);f++)1===i[f]&&u++;if(t<30){for(f=0;f<t;f++)i[(g(S(r,3))+f)%7]&&o++;return t-=o}for(a=t,f=s=c=0;f<a&&g(S(r,3)+f)%7!=0;f++)c++;for(f=0;f<c;f++)i[(g(S(r,3))+f)%7]&&o++;for(f=0;f<a&&(g(S(n,3))+7-f)%7!=6;f++)s++;for(f=0;f<s;f++)i[(g(S(n,3))+7-f)%7]&&o++;return t=t-g((a=a-c-s)/7)*u-o}function je(r,n,t,e){return pe(!0,r,n,t,e,ke)}function qe(r,n,t){var e,t,i;function u(){var r=[];return r[0]=function(r,n){return n.getFullYear()-r.getFullYear()+(n.getMonth()<r.getMonth()||n.getMonth()===r.getMonth()&&n.getDate()<r.getDate()?-1:0)},r[1]=function(r,n){return 12*(n.getFullYear()-r.getFullYear())+(n.getMonth()-r.getMonth())+(n.getDate()<r.getDate()?-1:0)},r[2]=function(r,n){return(n.getTime()-r.getTime())/864e5},r[3]=function(r,n){var r=new Date(n.getFullYear(),n.getMonth()+(n.getDate()<r.getDate()?-1:0),r.getDate());return(n.getTime()-r.getTime())/864e5},r[4]=function(r,n){return n.getMonth()-r.getMonth()+(n.getMonth()<r.getMonth()||n.getMonth()===r.getMonth()&&n.getDate()<r.getDate()?12:0)+(n.getDate()<r.getDate()?-1:0)},r[5]=function(r,n){var t,e,i,r,u,t=n.getFullYear()+(n.getMonth()<r.getMonth()||n.getMonth()===r.getMonth()&&n.getDate()<r.getDate()?-1:0),e=r.getMonth(),i=r.getDate(),r=gr(r.getFullYear());return 1!==e||29!==i||gr(t)||i--,!r&&1===e&&28===i&&gr(t)&&i++,(n-(u=new Date(t,e,i)))/864e5},r}if(r.setHours(0,0,0,0),n.setHours(0,0,0,0),N.ExcelCompatibleCalcMode&&(r<Vr||Ur<n))return y;if(t=t.toLocaleUpperCase(),e=u(),t=x(t,["Y","M","D","MD","YM","YD"]),n<r)return y;if(t<0)throw(0,N.sR)().Exp_NotSupported;return(i=e[t])(r,n)}function Be(r,n){var t,r,e,t={value:0};return mr(r,t)&&mr(n,r={value:0})?(e=2958465,i(t.value)&&i(r.value)?R(t.value)-R(r.value):y):I;function i(r){return 0<=r&&r<1+e}}function Fe(r){var n,n,t,n,e;return isNaN(r)?y:(n=new Date(1900,1,28),r.getTime()<=n.getTime()&&r.setDate(r.getDate()-1),1900===(n=r.getFullYear())?n+=400:9999===n&&(n-=400),r.setYear(n),r.getTime()<new Date(n,11,29).getTime()&&n--,t=i(n+1),r.getTime()<t.getTime()&&(t=i(n)),n=60*r.getTimezoneOffset()*1e3,e=60*t.getTimezoneOffset()*1e3,_(((r.getTime()-n-t.getTime()+e)/864e5/7).toString())+1);function i(r){var r,n,r=new Date(r,0,4),n=r.getDay();return 0===n&&(n=7),r.setDate(r.getDate()+1-n),r}}function Qe(r){var n,t,e,i,r,u,n=r.toString(),t="",i=[];if(r<0&&(n=n.substr(1),t="-"),r=n.split("."),(u=m(r))<1||2<u)return I;for(2===u&&(i.push(r[1]),i.push(".")),n=r[0],e=m(n)-3;0<=e;e-=3)i.push(n.substr(e,3)),0<e&&i.push(",");return i.push(n.substring(0,e+3)),i.reverse(),t+i.join("")}function Ye(r,n){for(var t,e,i,u,o,f,t=[],u=m(r),e=0;e<u;e++){if(o=r[e],0===(f=m(o))&&"concat"===n)return er;for(i=0;i<f;i++)T(o[i])||t.push(ar(o[i]))}return t.join("")}function Ge(r,n,t){for(var e,i,u,o,e=[],i=0,u=0;u<n.length;u++)"fourByte"===(o=Er(n[u]))?0===i?i++:(i=0,e.push(n[u-1]+n[u])):e.push(n[u]);return e.length<=t?n:e.splice(r?0:e.length-t,t).join("")}function xe(r){for(var n=[],t,e,t=0;t<m(r);t++)0<=(e=r.charCodeAt(t))&&e<=31||127===e||128<=e&&e<=159||n.push(r[t]);return n.join("")}function Pe(r){var n,t,e,i,u;for(r=r.trim(),n=[],t=!0,e=0;e<m(r);e++)(u=" "===(i=r.charAt(e))||"\t"===i||"\n"===i)&&!t||n.push(i),t=!u;return n.join("")}function He(r,n){function t(r){var n=Qe(r),t=[];return r<0&&(n=n.substr(1)),t.push("$"),t.push(n),r<0&&(t.push(")"),t.unshift("(")),t.join("")}return t(r=fr(Fn(r,n)))}function Xe(r,n,t){var e,i,e,u,o,f,e=0;if(n<0&&(r/=e=g(nr(10,v(n)))),r=fr(Fn(r,J(0,n))),n<0&&(r*=e),i=t?r.toString():Qe(r),0<n)if(-1===(e=i.indexOf(".")))for(i+=".",u=0;u<n;u++)i+="0";else for(f=o=i.length-(e+1);f<n;f++)i+="0";return i}function We(r,n){var t,e;if(""===n)return ar(r);"string"==typeof(r=T(r)?0:r)&&(r=r.trim());try{return(t=a.Formatter&&a.Formatter.GeneralFormatter)?(e=new t(n)).format(r):r.toString()}catch(r){return I}}function Je(r){var n,r;return r?"boolean"==typeof r?I:"string"!=typeof(r=r instanceof Date?o.o0(r).toString():r)?r:(n=Y(r),T(n)?Ke(r):(r=s(n),h(r)?Ce(n):r)):0}function Ke(r){var n,t,t,e,i,u,o,f,n=a.Common.CultureManager.Fe().NumberFormat;if(r=r.trim(),t="$"===n.currencySymbol?"\\$":"[$".concat(n.currencySymbol,"]"),r=(r=c.qT("^(".concat(t,"|[+-]\\s*").concat(t,")")).test(r)?r.replace(c.bue(t),""):r).replace(/^[+-]\s+/,function(r){return r[0]}),t=H(r),P(t))return I;for(e=(r="."===(r="-"===r[0]&&"."===r[1]?r.replace(r[1],"0."):r)[0]?"0"+r:r).length,f=o=i=0;i<e;i++){for(u=r[i];i<e&&(0,N.isDigit)(u.charCodeAt(0));)u=r[++i];if(i===e){if(o&&i-o<=3)return I;break}if(u===n.numberGroupSeparator){if(f||o&&i-o<=3)return I;o=i}else if(u===n.numberDecimalSeparator){if(f||o&&i-o<=3)return I;f=i}}return fr(r)}function $e(r){return r.toLowerCase()}function ze(r){return r.toUpperCase()}function Ze(r){var n,t,e,i,u,n=m(r),t=[];if(0<n)for(e=r.toUpperCase(),i=r.toLowerCase(),u=1,t[0]=e[0];u<n;)t[u]=((0,N.Swt)(r[u-1])?i:e)[u],u++;return t.join("")}function ri(r){return String.fromCharCode(r)}function ni(r){return r[0].charCodeAt(0)}function ti(r,n,t,e){var i,i,r,i=m(r);return n=K(n,i+1),t=K(t||0,i-n+1),i=r.substring(0,n-1),r=r.substr(n-1+t),i.concat(e).concat(r)}function ei(r,n,t,e){var i,u,o,f,a,c,c,s;if(Ai()||N.usedbcs){for(i=[],u=void 0,f=o=0;f<r.length;f++)u=r[f],"doubleByte"===(a=Er(r[f]))&&(o++,u=r[f]),i[f+o]=u;return n=K(n,(c=i.length)+1),t=K(t||0,c-n+1),T(i[n-1])?(i[n-1]=" ",i[n]=" "):T(i[n-2])&&2<=n&&(i[n-2]=" ",i[n-1]=" "),c=i.slice(0,n-1).join(""),s=i.slice(n-1+t).join(""),c.concat(e).concat(s)}return ti(r,n,t,e)}function ii(r,n,t,e){var i,u,o,f,a,e,i;if(""===n)return r;if(u=m(n),3<m(arguments)){if(a=void(f=0),(o=g(e))<1)return I;for(a=0;a<o;a++){if(-1===(f=r.indexOf(n,f)))return r;f+=u}e=r.substring(0,f-u),i=r.substr(f),i=e.concat(t).concat(i)}else i=q.qS(r,n,t);return i}function ui(){return Ye(arguments,"concatenate")}function oi(){return Ye(arguments,"concat")}function fi(r,n){var r,t,e,i,n,u,o;if(r.isReference&&0===r.length)return er;if(r={value:!1},t=!!T(n[0])||n[0],!Or(t,r))return I;for(t=r.value,i=[],n=[],u=m(e=arguments),o=2;o<u;o++)ai(i,e[o],t);return ai(n,e[0],!1),ci(i,n)}function ai(r,n,t){var e,i,e=m(n);if(0!==e)for(i=0;i<e;i++)T(n[i])||""===n[i]?t||r.push(""):r.push(ar(n[i]))}function ci(r,n){if(0===r.length)return"";if(1===n.length)return r.join(n[0]);for(var t=r[0],e=1,i=0;e<r.length;e++,i++)t+=n[i=i===n.length?0:i]+r[e];return t}function si(r,n){return Ge(!0,r,n)}function _i(r,n){return Ge(!1,r,n)}function li(r,n,t){var e,i,u,o,f,a,c,s,_;if(Ai()||N.usedbcs){for(e=[],i=void 0,o=void(u=0),o=f=0;o<n.length;o++)i=n[o],"fourByte"===(a=Er(n[o]))?u%2==0?u++:(u++,i=n[o-1]+n[o],e[e.length]=i):("doubleByte"===a&&(f++,i=n[o]),e[o-(c=0<u?u/2:0)+f]=i);return(s=(e=r?e:dr(e)).length)<=t?n:(_=void 0,r?0<(_=e.slice(0,t-1<0?0:t)).length&&T(_[_.length-1])&&(_[_.length-1]="\u200b"):0<(_=e.slice(s-t)).length&&T(_[0])&&(_[0]="\u200b"),_.join(""))}return Ge(r,n,t)}function vi(r,n){return li(!0,r,n)}function gi(r,n){return li(!1,r,n)}function Ei(r,n,t){n--;var e=m(r);return e<=n?"":e<n+t?r.substr(n):r.substr(n,t)}function pi(r,n,t){var e,i,i;return Ai()||N.usedbcs?(i=(e=pr(r)).length,--n<0?I:i<=n?"":(i<n+t?e.slice(n):(i=e.slice(n,n+t),"singleByte"!==Er(i[i.length-1])&&(i[i.length-1]="\u200b",T(i[0]))&&(i[i.length]="\u200b"),i)).join("")):Ei(r,n,t)}function di(r,n){var t=[],e;if(n<0||32767<n*m(r))return I;for(e=0;e<n;e++)t.push(r);return t.join("")}function Ti(r){return r?r.length:0}function Ai(){var r;return!!a.Common.CultureManager.Fe().isJCKCulture}function yi(r){var n,t,e,i;if(!r)return 0;if(Ai()||N.usedbcs){for(t=n=0;t<r.length;t++)8203!==r[t].charCodeAt(0)&&(e=Er(r[t]),i=a.Common.CultureManager.Fe(),"doubleByte"===e)&&9390!==r[t].charCodeAt(0)&&("ja-jp"!==(i&&i.name().toLocaleLowerCase())||711!==r[t].charCodeAt(0)&&9356!==r[t].charCodeAt(0)&&8212!==r[t].charCodeAt(0))&&n++;return r.length+n}return r.length}function Ci(r,n,t){var n;return t<1||m(n)<t||-1===(n=n.indexOf(r,t-1))?I:n+1}function Mi(r,n,t){var e,i,u,u,e,i;return Ai()||N.usedbcs?(e=pr(n),i=pr(r),u=e.length,t<1||u<t||(u=mi(e),e=mi(i),-1===(i=u.indexOf(e,t-1)))?I:i+1):Ci(r,n,t)}function Si(r,n,t){var e=-1,i,i,i=c.jJ(r),e;return-1===(e=i?(i=c.OJ(i).exec(n),T(i)?-1:i.index):n.toLowerCase().indexOf(r.toLowerCase(),t-1))?I:e+1}function mi(r){for(var n=0;n<r.length;n++)T(r[n])&&r[n-1]&&2!==r[n-1].length&&(r[n]="\u200b");return r.join("")}function Oi(r){for(var n=0;n<r.length;n++)T(r[n])&&(r[n]="\u200b")}function Ni(r,n,t){var e,i,u,u;return Ai()||N.usedbcs?(e=pr(n),i=pr(r),u=e.length,t<1||u<t||(u=Si(mi(i),mi(e),t))===I?I:u):Si(r,n,t)}function Ri(r,n){return r===n}function wi(r){return u(r)?r:""}function Ii(r){var r;return!r||(r=r)<=0||1114111<r?I:55296<=r&&r<=57343?A:r<1048576?String.fromCharCode(r):(r-=1048576,String.fromCharCode(55296+(r>>10),56320+(1023&r)))}function Di(r){var r,n,r,r=ar(r);return""===r||null===r?I:55296<=(n=r.charCodeAt(0))&&n<=56319?1===r.length?I:56320<=(r=r.charCodeAt(1))&&r<=57343?n|r<<8:1:56320<=n&&n<=57343?n-53248+53248:n}function hi(r){var n,t;function e(r){for(var n,t,e,i,u,o,f,a,c,s,n=["\u0e25\u0e49\u0e32\u0e19","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19",""],t=["\u0e28\u0e39\u0e19\u0e22\u0e4c","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],e=["\u0e25\u0e1a","\u0e1a\u0e32\u0e17","\u0e16\u0e49\u0e27\u0e19","\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c","\u0e22\u0e35\u0e48","\u0e40\u0e2d\u0e47\u0e14",","," ","\u0e3f"],i="",u=r+"",o=u.length,f=o;0<f;--f){if(c=t[a=_(u[o-f])],1==(s=1<f?(f-1)%6:6)&&2===a&&(c=e[4]),1===a)switch(s){case 0:case 6:i+=f<o?e[5]:c;break;case 1:break;default:i+=c}else{if(0===a){0==s&&(i+=n[s]);continue}i+=c}i+=n[s]}return i}return r?(n=Math.abs(_(r)),t=parseFloat((Math.abs(r)-n).toFixed(2)),0!==n?0===t?(r<0?"\u0e25\u0e1a":"")+e(n)+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":(r<0?"\u0e25\u0e1a":"")+e(n)+"\u0e1a\u0e32\u0e17"+e(100*t)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":0!==t?(r<0?"\u0e25\u0e1a":"")+e(100*t)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":"\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19"):I}function bi(o,f,r,n,t){var e,i,e=function(r,n){for(var t,e,i,u,t=-1,e=-1,i=0;i<f.length;i++)-1===(u=r?o.indexOf(f[i],n):o.lastIndexOf(f[i],n))||-1!==t&&!(r?u<t:t<u)||(t=u,e=i);return{index:t,delimiterIndex:e}};if(1===n&&(o=o.toLocaleLowerCase(),f=f.map(function(r){return r.toLocaleLowerCase()})),0<r){for(i=e(!0),r--;-1!==i.index&&0<r;)i=e(!0,i.index+1),r--;if(1===t&&-1===i.index&&0===r)return{index:o.length,delimiterIndex:-1,isMatchEnd:!0}}else{for(i=e(!1),r++;-1!==i.index&&r<0;)i=e(!1,i.index-1),r++;if(1===t&&-1===i.index&&0===r)return{index:-1,delimiterIndex:-1,isMatchEnd:!0}}return{isMatchEnd:!1,index:i.index,delimiterIndex:i.delimiterIndex}}function Li(r,n,t,e,i,u){var o,t,e,i,f,o=r.length;return T(n)||0===n.length||n.some(function(r){return r.length>o})?A:n.some(function(r){return 0===r.length})?0<t?r:"":o<t?I:(e=(t=bi(r,n,t,e,i)).index,i=t.delimiterIndex,(f=t.isMatchEnd)?-1===e?r:"":-1!==e?r.substring(e+n[i].length):T(u)?A:u)}function Vi(r,n,t,e,i,u){var o,n,t,f,o=r.length;return T(n)||0===n.length||n.some(function(r){return r.length>o})?A:n.some(function(r){return 0===r.length})?0<t?"":r:o<t?I:(t=(n=bi(r,n,t,e,i)).index,(f=n.isMatchEnd)?-1===t?"":r:-1!==t?r.substring(0,t):T(u)?A:u)}function Ui(r,n,t){return"function"==typeof r.replaceAll?r.replaceAll(n,t):r.replace(new RegExp(c.D9t(n),"g"),t)}function ki(r,n,t){var e,i,u;if(T(n))return[r];if(e=n[0],1<n.length)for(i=1;i<n.length;i++)r=Ui(r,n[i],e);return u=r.split(e),u=t?u.filter(function(r){return 0<r.length}):u}function ji(r,n,t,e,i,u){var o,i,f;return 0===r.length||T(n)&&T(t)||n&&(0===n.length||n.some(function(r){return 0===r.length}))||t&&(0===t.length||t.some(function(r){return 0===r.length}))?I:(1===i&&(r=r.toLowerCase(),t=t&&t.map(function(r){return r.toLowerCase()}),n=n&&n.map(function(r){return r.toLowerCase()})),i=(i=(o=ki(r,t,e)).map(function(r){return ki(r,n,e)})).filter(function(r){return 0<r.length}),f=J.apply(null,i.map(function(r){return r.length})),u=T(u)?A:u,i.forEach(function(r){for(var n=f-r.length;0<n;)r.push(u),n--}),new N.CalcArray(i))}function qi(r){return h(r)}function Bi(r){return!!h(r)&&r._code!==A._code}function Fi(r){return!!h(r)&&r._code===A._code}function Qi(r){if(!T(r)&&h(r)){var r=x(r._code,[er._code,w._code,I._code,ir._code,ur._code,y._code,A._code]);if(0<=r)return r+1}return A}function Yi(r){return cr(r,N.ExcelCompatibleCalcMode)}function Gi(r){return E(v(r))%2==0}function xi(r){return E(v(r))%2!=0}function Pi(r){return lr(r)||vr(r)?fr(r):_r(r)?r?1:0:h(r)?r:0}function Hi(r){return T(r)}function Xi(r){return _r(r)}function Wi(r){return u(r)}function Ji(r){return!u(r)}function Ki(r){return b(r)}function $i(r){return _r(r)?4:lr(r)||vr(r)?1:u(r)?2:h(r)?16:L(r)?64:(0,N.isLambdaFunction)(r)?128:I}function zi(){return A}function Zi(r,n){var t,e,i,r,t=0,e=r.source.Mf;if(!L(n)){if(n instanceof N.CalcReference||T(n))return r=n&&(n.rT||n.references[0].rT)||r.source,e.parent.getSheetIndex(r.Mf.name())+1;if(cr(n)||u(n))for(;t<e.parent.sheets.length;t++)if(n.toUpperCase()===e.parent.sheets[t].name().toUpperCase())return t+1}return A}function ru(r,n){var t,e,i,i,t=r.source.Mf;return T(n)?t.parent.sheets.length:L(n)||cr(n)?A:u(n)?I:n instanceof N.CalcReference?(i=n.references)?i.length:(i=n.rT||r.source,t.parent.getSheetIndex(i.Mf.name())+1):A}function nu(){var r=new N.Functions.AsyncFunction("REFRESH",1,3);r.evaluate=tu,N.Functions.Mmt.REFRESH=r}function tu(r,n){return n}function eu(r){return 55296<=r&&r<=57343}function iu(r,n){return!(r<55296||56319<r)&&56320<=n&&n<=57343}function uu(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==j.g)return j.g;try{return new Function("return this")}catch(r){}}function ou(r){var n,t,e,i,u,o,f,n=uu();if(n&&n.encodeURIComponent)return encodeURIComponent(r).replace(/[!~'()*]/g,function(r){return"%"+r.charCodeAt(0).toString(16).toUpperCase()});if(t="",(e=r.length-1)<0)return"";for(i=0;i<=e;i++)if((u=r.charCodeAt(i))>="A".charCodeAt(0)&&u<="Z".charCodeAt(0)||u>="0".charCodeAt(0)&&u<="9".charCodeAt(0)||u>="a".charCodeAt(0)&&u<="z".charCodeAt(0)||u==="-".charCodeAt(0)||u==="_".charCodeAt(0)||u===".".charCodeAt(0))t+=r[i];else{if(o=void 0,eu(u)){if(e===i||!iu(u,r.charCodeAt(i+1)))return null;o=[u,r.charCodeAt(i+1)],i++}else o=[u];for(f=0;f<o.length;f++)t=(t+="%")+o[f].toString(16).toUpperCase()}return t}function fu(r){for(var n,t,n=r,t=0;t<n.length;t++)if(!T(n[t])&&"string"!=typeof n[t])return;return 1}function au(r,n,t){var n,t,r;return fu(arguments)?Mu(n)?A:(n=c.bue(n,t))?(t=r.match(n))?1===(r=t.length)?t[0]:1<r?t[0]===t.input?new N.CalcArray([t.slice(1)]):new N.CalcArray([t]):void 0:A:I:I}function cu(r,n,t){var n;return fu(arguments)?Mu(n)?A:(n=c.bue(n,t))?n.test(r):I:I}function su(r,n,t,e){var n;return fu(arguments)?Mu(n)||Mu(t)?A:(n=c.bue(n,e))?r.replace(n,t):I:I}function _u(r,n,t){var e;return void 0===t&&(t=!0),r!==l||t?h(r)?A:L(r)?V(r,n,!0,!0,!1):V(r,n,!0,!0,!0):I}function lu(r){for(var n,t,e,i,u,o,r,r,f,a,c,a,n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(e=n[0],u=[],o=[],r=(r=(i=n[1])&&i.getSource()&&i.getSource().getSheet()||r.source&&r.source.Mf)&&r.pivotTables&&i&&r.pivotTables.findPivotTable(i.getRow(),i.getColumn()),T(r))return ir;for(f=2;f<n.length;f+=2)c=n[f+1],a={fieldName:a=b(a=n[f])?a.getValueByIndex(0):a,itemName:c},(b(c)||L(c)?o:u).push(a);return b(e)&&(e=e.getValueByIndex(0)),0<o.length?vu(e,r,u,o):r.evaluateGetPivotDataFunction(e,u)}function vu(r,n,t,e){for(var i,u,o,f,a,c,s,_,l,v,g,v,l,E,p,d,T,A,y,C,M,S,m,O,i=1,u=1,o=[],f=[],a=[],c=0,s=e;c<s.length;c++){if(l=(_=s[c]).fieldName,v=_.itemName,h(v))return v;if((b(v)||L(v))&&(_.itemName=V(v,0,!1,!1,!1),_.itemName.isError))return _.itemName[0];v=(g=n.getField(l)).pivotArea,i=(l=_.itemName.rowCount)<i?i:l,u=(E=_.itemName.colCount)<u?u:E,E<l||l===E&&1===v?o.push(_):(l<E||l===E&&2===v)&&f.push(_)}for(p=0;p<i;p++){for(d=[],T=0;T<u;T++){for(A=[],y=0,C=o;y<C.length;y++)1<(M=C[y]).itemName.colCount?1<M.itemName.rowCount?A.push({fieldName:M.fieldName,itemName:M.itemName[p]&&M.itemName[p][T]}):A.push({fieldName:M.fieldName,itemName:M.itemName[0]&&M.itemName[0][T]}):1<M.itemName.rowCount?A.push({fieldName:M.fieldName,itemName:M.itemName[p]&&M.itemName[p][0]}):A.push({fieldName:M.fieldName,itemName:M.itemName[0]&&M.itemName[0][0]});for(S=0,m=f;S<m.length;S++)1<(O=m[S]).itemName.rowCount?1<O.itemName.colCount?A.push({fieldName:O.fieldName,itemName:O.itemName[p]&&O.itemName[p][T]}):A.push({fieldName:O.fieldName,itemName:O.itemName[p]&&O.itemName[p][0]}):1<O.itemName.colCount?A.push({fieldName:O.fieldName,itemName:O.itemName[0]&&O.itemName[0][T]}):A.push({fieldName:O.fieldName,itemName:O.itemName[0]&&O.itemName[0][0]});d.push(n.evaluateGetPivotDataFunction(r,t.concat(A)))}a.push(d)}return new N.CalcArray(a)}function gu(){var r,n,t,e,i,u,o,f,a,c,f,s,_,l,v,g,E,p,d,r=arguments,n=m(r);if(n<2||n%2!=0)return A;for(e=0;e<n;e+=2){if(f=r[e+1],a=_u(o=r[e],2),c=_u(f,0),h(a))return a;if(h(c))return c;if(a.isError||c.isError)return A;if(f=a.length,s=c.length,T(u))u=s;else if(u!==s)return A;if(s<f)return A;if(f<s){if(!1===i||1<f)return A;for(T(t)&&(t=[]),_=c.rowCount,l=c.colCount,v=a[0],g=0;g<_;g++){for(E=t[g],T(E)&&(E=t[g]=[]),p=0;p<l;p++)T(E[p])&&(E[p]={}),E[p][v]=c[p+g*l];t[g]=E}i=!0}else{if(!0===i)return A;for(T(t)&&(t={}),d=0;d<s;d++)t[a[d]]=c[d];i=!1}}return i?new N.CalcArray(t):t}function Eu(){var r,n,e,r;function t(r){for(var n,t,n=e.length,t=0;t<n;t++)if(r=r[e[t]],T(r))return A;return r}return n=(r=arguments)[0],e=r[1].split("."),T(r=n)||"object"!=typeof n?A:(L(n)?r.array=r.array.map(function(r){return Array.isArray(r)?r.map(t):t(r)}):r=t(r),r)}function pu(r){var n,t,e,i,u;try{if(n=r&&JSON.parse(r),Array.isArray(n)&&0<n.length){for(t=!0,e=0;e<n.length;e++)if(!Array.isArray(n[e])){t=!1;break}if(t)n=new N.CalcArray(n);else{for(i=[],u=0;u<n.length;u++)i.push([n[u]]);n=new N.CalcArray(i)}}return n}catch(r){return I}}function du(r){return Au(r,"AaK9#@BXHN\uff27S")}function Tu(r){return Au(r,"\uff21\uff41\uff2b\uff19\uff03\uff20\uff22\uff38\uff3a\uff2e\uff33")}function Au(r,n){var t,e,i,u,t="";if("number"===(e=r?typeof r:e)||"boolean"===e)t=r+"";else if(r instanceof Date)t=o.o0(r).toString();else{if("object"===e)return I;"string"===e&&(t=r)}return(u=(i=new N._9t(!0,n)).checkText(t)).CheckedText}function yu(){var r=new N.Functions.AsyncFunction("WEBSERVICE",1,1);r.defaultValue=function(){return""},r.evaluate=Cu,N.Functions.Mmt.WEBSERVICE=r}function Cu(n,r){var r,e,i,u,r=r;if(!r||r.length>Rr)return I;if(e=null,XMLHttpRequest&&(e=new XMLHttpRequest),i=function(r){n.setAsyncResult(r)},u=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===e)return I;try{e.open("GET",r,!0),e.onreadystatechange=function(){var r,n,t;4===e.readyState&&(200!==e.status||!(n=(r=e.response)&&r.type)||-1===n.indexOf("text")&&-1===u.indexOf(n)?i(I):((t=new FileReader).onloadend=function(){i(t.result)},t.onerror=function(){i(I)},t.readAsText(r)))},e.onerror=function(){i(I)},e.timeout=wr,e.ontimeout=function(){i(I)},e.responseType="blob",e.send(null)}catch(r){return I}}function Mu(r){return""===r||T(r)}function Su(r){return Ir.a0(r)||Ir.a0(r,br)}function mu(r){for(var n,t,e,i,u,n="",t=!1,e=0,i=r.length;e<i;e++)'"'===(u=r[e])?t=!t:t||"Y"!==u||(u=hr),n+=u;return n}function Ou(r){return r.split(hr).join("y")}function Nu(r){return r.formatters[0].E9t}function Ru(r){return r.j9t&&r.j9t.cultureInfo()||B.Fe(r.cultureName)||B.Fe()}function wu(r,n,t,e){return Uu(r,n,t,Ru(e=Nu(e)),e.O9t)}function Iu(){return/qqqq|qqq|qq|q|QQQQ|QQQ|QQ|Q|yyyy|yyy|yy|y|ww|w/g}function Du(r,n,t){var e,i,r;return r?(r=(e=r.index)+r[0].length,t<e?[n.slice(t,e),r]:t===e?["",r]:["",t]):[n.slice(t),t]}function hu(r){return Yn(we(r)/3,0)}function bu(r,n){return De(r,T(n)?n:g(n))}function Lu(r){var r=new Date(r.getTime()),n=(r.getDay()+6)%7,n=r.getDate()-n,t;return r.setDate(3+n),r.getFullYear()}function Vu(r,n,t,e){var i=Lu(n),u=n.getFullYear();return G(i===u?n:new Date(i,0,1),r,e,t)}function Uu(r,n,t,e,i){for(var u,o,f,a,c,s,_,l,u="",o=0,f=e.DateTimeFormat.eras,a=Iu(),_=0;u+=(s=Du(c=a.exec(n),n,o))[0],o=s[1],c;_++)switch(c[0]){case"QQQQ":case"qqqq":u+=Lr[hu(r)];break;case"QQQ":case"qqq":u+="Q".concat(hu(r));break;case"QQ":case"qq":u+=F(hu(r),2);break;case"Q":case"q":u+=hu(r);break;case"yyyy":case"yyy":u+=f?Vu("ee",r,i,e):F(Lu(r),4);break;case"yy":u+=f?Vu("ee",r,i,e):F(Lu(r)%100,2);break;case"y":u+=f?Vu("e",r,i,e):(Lu(r)%100).toString();break;case"ww":l=bu(r,t),h(l)?u+=l:u+=F(l,2);break;case"w":u+=bu(r,t)}return u.toString()}function ku(){function r(){this.R9t=[{J6t:6},{J6t:5},{J6t:2}],this.Ul={}}(r.prototype=new N.Functions.Function("DATEPART",2,3)).evaluate=function(r,n,t){var e,i,u,u,e;return Mu(n)||!Su(n)?"":((e=this.Ul)[n=(i=21===t&&/Y/g.test(n)&&/w/g.test(n))?mu(n):n]||(u=a.Formatter&&a.Formatter.GeneralFormatter,e[n]=u?new u(n):l),e=(u=e[n]).format(r),i&&(e=Ou(e)),/q|Q|w|y/g.test(e)?wu(r,e,t,u):e)},N.Functions.Mmt.DATEPART=new r}function ju(r,n){if(!r||8!==r.type)throw(0,N.sR)().Exp_FormulaInvalid;if(-1!==n.indexOf(r.value))throw(0,N.sR)().Exp_FormulaInvalid;if(-1<r.value.indexOf("."))throw(0,N.sR)().Exp_FormulaInvalid}function qu(r){var n=crypto&&crypto.randomUUID&&crypto.randomUUID();return T(n)&&(n="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(r){return(r^crypto.getRandomValues(new Uint8Array(1))[0]&15>>r/4).toString(16)})),n=32===r?n.split("-").join(""):n}function Bu(r,n,t){var e=r.length,i=n.length;return 0===e||0===i||e<i?A:((t=void 0===t?0:t)&&(r=r.toUpperCase(),n=n.toUpperCase()),r.lastIndexOf(n)===e-i)}function Fu(r,n,t){var e=r.length,i=n.length;return 0===e||0===i||e<i?A:((t=void 0===t?0:t)&&(r=r.toUpperCase(),n=n.toUpperCase()),0===r.indexOf(n))}function Qu(r,n){return void 0===n&&(n=4),(r=r instanceof Date?r:new Date(r)).getMonth()<n-1?r.getFullYear()-1:r.getFullYear()}Object.defineProperty(r,"__esModule",{value:!0}),a=j("Common"),N=j("CalcEngine"),c=a.Common.$T,q=a.Common.zf,o=a.Common.ct,B=a.Common.CultureManager,F=a.Common.zf.B9t,s=o.o0,Q=o.Y0,Y=o.yU,G=o.L9t,m=a.Common.Uf.tR,r=a.Common.lt,x=r.Rh,T=r.ht,l=null,O=void 0,P=isNaN,H=parseFloat,_=parseInt,X=Math.round,v=Math.abs,W=Math.sqrt,J=Math.max,K=Math.min,R=Math.floor,$=Math.exp,z=Math.log,Z=Math.PI,rr=Math.random,nr=Math.pow,tr=Math.ceil,er=N.Errors.Null,w=N.Errors.DivideByZero,I=N.Errors.Value,ir=N.Errors.Reference,ur=N.Errors.Name,p=N.Errors.Calc,A=N.Errors.NotAvailable,y=N.Errors.Number,D=N.Convert.CalcConvertedError,h=N.Convert.BJ,b=N.Convert.LE,L=N.Convert.Nh,or=N.Convert.YK,g=N.Convert.z6t,fr=N.Convert.uJ,ar=N.Convert.j,cr=N.Convert.q8,V=N.Convert.iV,U=N.Convert.L6t,sr=N.skt.tryExtractToSingleValue,_r=N.Functions.G6t,lr=N.Functions.q8,vr=o.W0,u=N.Functions.OMt,gr=N.Functions.F9t,Er=N.Functions.P9t,pr=N.Functions.G9t,dr=N.Functions.U9t,Tr=N.Functions.Pkt,Ar=N.Functions.nkt,yr=N.Functions.b9t,Cr=N.Functions.H9t,Mr=N.Functions.y9t,f=N.Functions.MathHelper,Sr=f.z9t,E=f.d9t,r=N.Functions.F6t,mr=N.Convert.sJ,Or=N.Convert.YK,Nr=N.Convert.Sft,Rr=2048,wr=1e4,Ir=a.Formatter.Hf,Dr=21,hr="(&}",br=["qqqq","qqq","qq","q","QQQQ","QQQ","QQ","Q","YYYY","YYY","YY","Y","ww","w"],Lr={1:"1st quarter",2:"2nd quarter",3:"3rd quarter",4:"4th quarter"},Vr=new Date(1899,11,30),Ur=new Date(9999,11,31),kr={J6t:0,pkt:"= 0",zkt:w},t={J6t:0,pkt:"= 0",zkt:0},jr={bkt:1,J6t:0,pkt:"= 0",zkt:0},qr={J6t:2,pkt:"< 0"},Br={J6t:0,pkt:["> 134217728","< -134217728"]},Fr={J6t:1},e={J6t:2},Qr={bkt:1,J6t:2},i={bkt:1,J6t:2,pkt:"< 0",zkt:I},Yr={bkt:1,J6t:2,pkt:["= 0"],zkt:I},Gr={bkt:0,J6t:2,pkt:["< 0","> 1"],zkt:I},d={J6t:5},C={J6t:6},xr={J6t:2,pkt:"< 0",zkt:I},Hr={bkt:!(Pr={J6t:5,zkt:I}),J6t:7},Xr={bkt:[],J6t:4,X6t:4,Vkt:!0,Ykt:!0,M9t:!0},Wr={J6t:4,X6t:1,Ykt:!0,M9t:!0},Jr={J6t:4,X6t:1,Vkt:!0,Ykt:!0,n9t:!0},Kr={J6t:4,X6t:3,Vkt:!0,Ykt:!0,n9t:!0},$r={J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},zr={J6t:4,X6t:2,Vkt:!0,Ykt:!0,n9t:!0},Zr=[0,"%= 1 && >= 3"],r("ABS",an,1,1,n={J6t:0}),r("ACOS",At,1,1,{J6t:0,pkt:["> 1","< -1"]}),r("ACOT",Rt,1,1,n),r("ASIN",Tt,1,1,{J6t:0,pkt:["> 1","< -1"]}),r("ATAN",Nt,1,1,n),r("ATAN2",wt,2,2,[n,n]),r("COS",gt,1,1,n),r("SEC",Et,1,1,Br),r("CEILING",Vn,2,2,[t,t]),r("ODD",gn,1,1,Fr),r("EVEN",En,1,1,Fr),r("FLOOR",Un,2,2,[t,t]),r("LN",Tn,1,1,{J6t:1,pkt:"<= 0"}),r("SQRT",wn,1,1,{J6t:0,pkt:"< 0"}),r("SIN",lt,1,1,n),r("CSC",vt,1,1,Br),r("TAN",pt,1,1,n),r("COT",dt,1,1,Br),r("SIGN",mn,1,1,{J6t:1,pkt:"> 0",zkt:1}),r("GCD",On,1,O,Jr,-1,-1),r("LCM",Nn,1,O,Jr,-1,-1),r("PRODUCT",Rn,1,O,O,-1,-1),r("POWER",Cn,2,2,[n,n]),r("MOD",An,2,2,[n,{J6t:0,pkt:"= 0",zkt:w}]),r("QUOTIENT",In,2,2,[n,kr],O,O),r("SUBTOTAL",Dn,2,O,e,"!= 0",O,{u9t:4}),r("_SUBTOTALFORSTATUSBAR",hn,2,5e3,e,"!= 0",O,{u9t:4}),r("INT",cn,1,1,O,O,O),r("MROUND",Bn,2,2,[t,t]),r("ROUND",Fn,2,2,[n,e]),r("ROUNDDOWN",Qn,2,2,[n,e]),r("ROUNDUP",Yn,2,2,[n,e]),r("TRUNC",Qn,1,2,[n,{bkt:0,J6t:2}],O,O,{wkt:1}),r("EXP",Gn,1,1,n),r("LOG",Hn,1,2,[{J6t:0,pkt:"<= 0"},{bkt:10,J6t:0,pkt:"<= 0"}],O,O,{wkt:1}),r("LOG10",Xn,1,1,{J6t:0,pkt:"<= 0"}),r("SUM",Sn,1,O,O,-1,-1),r("SUMIF",Jn,2,3,O,[0,2],O,{wkt:2,e9t:[2],i9t:!0,o9t:4,f9t:1,r9t:!0}),r("AVERAGEIF",Kn,2,3,O,[0,2],O,{wkt:2,e9t:[2],i9t:!0,f9t:1,r9t:!0}),r("SUMIFS",zn,3,O,O,[0,"%= 1"],O,{e9t:Zr,i9t:!0,o9t:4,f9t:"%= 0",r9t:!0}),r("SUMPRODUCT",it,1,O,O,-1,-1,{o9t:1}),r("SUMSQ",ut,1,O,Jr,-1,-1),r("SUMX2MY2",ot,2,2,Jr,-1,-1),r("SUMX2PY2",ft,2,2,Jr,-1,-1),r("SUMXMY2",at,2,2,Jr,-1,-1),r("SERIESSUM",ct,4,4,[n,e,e,{J6t:4,X6t:1,Vkt:!0,Ykt:!0,M9t:!0}],3,3),r("PI",yn,0,0),r("SQRTPI",st,1,1,{J6t:0,pkt:"< 0"}),r("DEGREES",vn,1,1,Fr),r("RADIANS",_t,1,1,n),r("COSH",Mt,1,1,n),r("SECH",St,1,1,n),r("ACOSH",Ot,1,1,{J6t:0,pkt:"< 1"}),r("SINH",yt,1,1,n),r("CSCH",Ct,1,1,n),r("ASINH",mt,1,1,n),r("TANH",It,1,1,n),r("COTH",Dt,1,1,{J6t:0}),r("ATANH",ht,1,1,{J6t:0,pkt:["<= -1",">= 1"]}),r("ACOTH",bt,1,1,{J6t:0}),r("MDETERM",Lt,1,1,Wr,-1,-1),r("MINVERSE",Vt,1,1,Wr,-1,-1),r("MMULT",Ut,2,2,[Wr,Wr],-1,-1),r("FACT",pn,1,1,{J6t:3,pkt:["< 0","> 170"]}),r("FACTDOUBLE",dn,1,1,{J6t:3,pkt:["< 0","> 300"]}),r("MULTINOMIAL",kt,1,O,{J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),r("RAND",jt,0,0,O,O,O,{V9t:!0}),r("RANDBETWEEN",qt,2,2,[n,n],O,O,{V9t:!0}),r("COMBIN",sn,2,2,[qr,qr]),r("COMBINA",_n,2,2,[qr,qr]),r("DECIMAL",ln,2,2,[{bkt:"0",J6t:5},{J6t:0,pkt:["> 36","< 2"]}]),r("CEILING.MATH",kn,1,3,[n,{J6t:0,bkt:1},{J6t:0,bkt:0}]),r("FLOOR.MATH",jn,1,3,[n,{J6t:0,bkt:1},{J6t:0,bkt:0}]),r("BASE",qn,2,3,[{J6t:0,pkt:["< 0",">= 9007199254740992"]},{J6t:3,pkt:["> 36","< 2"]},{J6t:3,bkt:0,pkt:["< 0",">= 256"]}]),r("ROMAN",Bt,1,2,[{J6t:2,pkt:["< 0","> 3999"],zkt:I},{bkt:0}],O,O,{wkt:1}),r("ARABIC",Ft,1,1,d),r("CEILING.PRECISE",xn,1,2,[t,jr]),r("ISO.CEILING",xn,1,2,[t,jr]),r("FLOOR.PRECISE",Pn,1,2,[t,jr]),r("MAXIFS",Zn,3,O,O,[0,"%= 1"],[0,"%= 1"],{e9t:Zr,i9t:!0,f9t:"%= 0",r9t:!0}),r("MINIFS",rt,3,O,O,[0,"%= 1"],[0,"%= 1"],{e9t:Zr,i9t:!0,f9t:"%= 0",r9t:!0}),r("AVERAGEIFS",tt,3,O,O,[0,"%= 1"],[0,"%= 1"],{e9t:Zr,i9t:!0,f9t:"%= 0",r9t:!0}),r("COUNTIFS",nt,2,O,O,"%= 0","%= 0",{e9t:["%= 0 && >= 2"],i9t:!0,f9t:"%= 1",r9t:!0}),r("MUNIT",et,1,1,{J6t:2,pkt:"<= 0",zkt:I}),r("SEQUENCE",Qt,1,4,[e,e,n,n],O,O,{wkt:[0,1,2,3]},!0),r("RANDARRAY",Yt,0,5,[e,e,n,n],O,O,{V9t:!0,wkt:[0,1,2,3,4]},!0),r("AGGREGATE",Ln,3,O,O,"> 1","> 1",{o9t:1,r9t:!0,u9t:4}),r("AND",xt,1,O,$r,-1,-1),r("OR",Pt,1,O,$r,-1,-1),r("NOT",Ht,1,1),r("IF",Xt,2,3,O,[1,2],[1,2],{f9t:[1,2],wkt:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(r){var r;return N.Convert.BJ(r)?-1:(or(r,r={value:!1}),r.value?1:2)}}),r("IFERROR",Jt,2,2,O,O,O,{f9t:-1}),r("TRUE",Kt,0,0),r("FALSE",$t,0,0),r("IFNA",zt,2,2,O,O,O,{f9t:-1}),r("IFS",Zt,2,254,O,O,O,{f9t:-1}),r("SWITCH",re,3,253,O,O,O,{f9t:-1}),r("XOR",ne,1,O,Kr,-1,-1),r("LET",O,3,253,O,O,O,{argsValidator:function(r,n,t,e){var i,u;if(t%2==0)throw(0,N.sR)().Exp_FormulaInvalid;for(i=[],u=0;u<e.length-1;u+=2)ju(e[u],i),i.push(e[u].value)}}),r("LAMBDA",O,1,253,O,O,O,{argsValidator:function(r,n,t,e){for(var i,u,i=[],u=0;u<e.length-1;u++)ju(e[u],i),i.push(e[u].value)}}),r("MAP",oe,2,O,O,-1,-1,{isContextSensitive:!0},!0),r("REDUCE",fe,3,3,O,-1,-1,{isContextSensitive:!0},!0),r("SCAN",ae,3,3,O,-1,-1,{isContextSensitive:!0},!0),r("BYROW",se,1,2,O,-1,-1,{isContextSensitive:!0},!0),r("BYCOL",_e,1,2,O,-1,-1,{isContextSensitive:!0},!0),r("MAKEARRAY",ce,3,3,[i,i],O,O,{isContextSensitive:!0},!0),r("DATE",Te,3,3,[{J6t:2,pkt:["< 0","> 9999"]},e,e]),r("TIME",Ae,3,3,[e,e,e]),r("DATEVALUE",ye,1,1,{iTe:!0}),r("TIMEVALUE",Ce,1,1,{iTe:!0}),r("NOW",Me,0,0,O,O,O,{V9t:!0}),r("TODAY",Se,0,0,O,O,O,{V9t:!0}),r("HOUR",me,1,1,C),r("MINUTE",Oe,1,1,C),r("SECOND",Ne,1,1,C),r("DAY",Re,1,1,C),r("MONTH",we,1,1,C),r("YEAR",Ie,1,1,C),r("WEEKNUM",De,1,2,[C,Qr],O,O,{wkt:1}),r("WEEKDAY",S,1,2,[C,Qr],O,O,{wkt:1}),r("EDATE",he,2,2,[C,e]),r("EOMONTH",be,2,2,[C,e]),r("WORKDAY",Le,2,3,[C,e,Xr],2,2,{wkt:2}),r("WORKDAY.INTL",Ve,2,4,[C,e,{bkt:"0000011"},Xr],[3],[2,3],{wkt:[2,3]}),r("DAYS360",N.Functions.Mkt,2,3,[C,C,{bkt:!1,J6t:7}],O,O,{wkt:2}),r("NETWORKDAYS",Ue,2,3,[C,C],2,2,{wkt:2}),r("NETWORKDAYS.INTL",je,2,4,[C,C],[2,3],[2,3],{wkt:[2,3]}),r("YEARFRAC",N.Functions.Hkt,2,3,[C,C,{bkt:0,J6t:2}],O,O,{wkt:2}),r("DATEDIF",qe,3,3,[C,C,d]),r("DAYS",Be,2,2),r("ISOWEEKNUM",Fe,1,1,C),r("CLEAN",xe,1,1,d),r("TRIM",Pe,1,1,d),r("DOLLAR",He,1,2,[n,{bkt:2,J6t:2,pkt:"> 99",zkt:I}],O,O,{wkt:1}),r("FIXED",Xe,1,3,[n,{bkt:2,J6t:2},{bkt:!1,J6t:7}],O,O,{wkt:[1,2]}),r("TEXT",We,2,2,[{},d]),r("VALUE",Je,1,1,O,O,O),r("LOWER",$e,1,1,d),r("UPPER",ze,1,1,d),r("PROPER",Ze,1,1,d),r("CHAR",ri,1,1,{J6t:2,pkt:["> 255","< 1"],zkt:I}),r("CODE",ni,1,1,{J6t:5,iTe:!0}),r("REPLACE",ti,4,4,[d,{J6t:2,pkt:"< 1",zkt:I},xr,d],O,O,{wkt:2}),r("SUBSTITUTE",ii,3,4,[d,{J6t:5},d],O,O,{wkt:3}),r("CONCATENATE",ui,1,O,{J6t:4,X6t:0,Vkt:!0,n9t:!0},O,-1),r("LEFT",si,1,2,[d,i],O,O,{wkt:1}),r("MID",Ei,3,3,[d,{J6t:2,pkt:"<= 0",zkt:I},xr]),r("RIGHT",_i,1,2,[d,i],O,O,{wkt:1}),r("REPT",di,2,2,[d,e]),r("LEN",Ti,1,1,d),r("FIND",Ci,2,3,[d,d,Qr],O,O,{wkt:2}),r("SEARCH",Si,2,3,[d,d,i],O,O,{wkt:2}),r("EXACT",Ri,2,2,[d,d]),r("T",wi,1,1),r("UNICHAR",Ii,1,1,[{J6t:2,zkt:I}]),r("UNICODE",Di,1,1),r("BAHTTEXT",hi,1,1,[{J6t:0,zkt:I}]),r("CONCAT",oi,1,O,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),r("TEXTJOIN",fi,3,O,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),r("FINDB",Mi,2,3,[d,d,Qr],O,O,{wkt:2}),r("LEFTB",vi,1,2,[d,i],O,O,{wkt:1}),r("RIGHTB",gi,1,2,[d,i],O,O,{wkt:1}),r("MIDB",pi,3,3,[d,xr,xr]),r("LENB",yi,1,1,d),r("REPLACEB",ei,4,4,[d,{J6t:2,pkt:"< 1",zkt:I},xr,d],O,O,{wkt:2}),r("SEARCHB",Ni,2,3,[d,d,i],O,O,{wkt:2}),r("TEXTAFTER",Li,2,6,[d,zr,Yr,Gr,Gr,d],[1],[1],{wkt:[2,3,4,5]}),r("TEXTBEFORE",Vi,2,6,[d,zr,Yr,Gr,Gr,d],[1],[1],{wkt:[2,3,4,5]}),r("TEXTSPLIT",ji,2,6,[d,zr,zr,Hr,Gr,d],[1,2],[1,2],{wkt:[1,2,3,4,5]},!0),r("ENCODEURL",ou,0,1,d),r("ISERROR",qi,1,1,O,O,O,{f9t:-1}),r("ISERR",Bi,1,1,O,O,O,{f9t:-1}),r("ISNA",Fi,1,1,O,O,O,{f9t:-1}),r("ERROR.TYPE",Qi,1,1,O,O,O,{f9t:-1}),r("ISNUMBER",Yi,1,1,O,O,O,{f9t:-1}),r("ISEVEN",Gi,1,1,n,O,O),r("ISODD",xi,1,1,n,O,O),r("N",Pi,1,1,O,O,O),r("ISBLANK",Hi,1,1,O,O,O,{f9t:-1}),r("ISLOGICAL",Xi,1,1,O,O,O,{f9t:-1}),r("ISTEXT",Wi,1,1,O,O,O,{f9t:-1}),r("ISNONTEXT",Ji,1,1,O,O,O,{f9t:-1}),r("ISREF",Ki,1,1,O,-1,O,{f9t:-1}),r("TYPE",$i,1,1,O,O,-1,{f9t:-1}),r("NA",zi,0,0),r("SHEET",Zi,0,1,O,-1,O,{r9t:!0}),r("SHEETS",ru,0,1,O,-1,O,{r9t:!0}),r("GETPIVOTDATA",lu,2,253,O,-1,-1,{r9t:!0}),r("OBJECT",gu,2,O,O,-1,-1),r("PROPERTY",Eu,2,2,O),r("FILTERJSON",pu,1,1,O),r("ASC",du,1,1),r("DBCS",Tu,1,1),r("ISOMITTED",O,1,1,O,-1,-1),r("GC.REGEXEXTRACT",au,2,3),r("GC.REGEXMATCH",cu,2,3,O),r("GC.REGEXREPLACE",su,3,4,O),r("SJS.REGEXEXTRACT",au,2,3),r("SJS.REGEXMATCH",cu,2,3,O),r("SJS.REGEXREPLACE",su,3,4,O),ku(),yu(),nu(),r("SJS.UUID",qu,0,1,O),r("SJS.ENDWITH",Bu,2,3,[{J6t:5},{J6t:5},{J6t:2}]),r("SJS.STARTWITH",Fu,2,3,[{J6t:5},{J6t:5},{J6t:2}]),r("SJS.FISCALYEAR",Qu,1,2)},CalcEngine:function(r){r.exports=o("@spreadjs/js-calc")},Common:function(r){r.exports=o("@spreadjs/js-sheets-common")}},e={},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),n=r={},Object.defineProperty(n,"__esModule",{value:!0}),n.Functions=void 0,i=u("CalcEngine"),Object.defineProperty(n,"Functions",{enumerable:!0,get:function(){return i.Functions}}),u("./src/functions-basic.ts"),(((f={}).Spread=f.Spread||{}).CalcEngine=f.Spread.CalcEngine||{}).BasicFunctions=r}(),r.exports=f.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@spreadjs/js-calc-basicfunctions/index.js":(r,n,t)=>{r.exports=t("./node_modules_local/@spreadjs/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"@spreadjs/js-sheets-common":r=>{"use strict";r.exports=GC.Spread},"@spreadjs/js-calc":r=>{"use strict";r.exports=GC.Spread.CalcEngine}},e={},r=i("./node_modules_local/@spreadjs/js-calc-basicfunctions/index.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).CalcEngine=GC.Spread.CalcEngine||{}).BasicFunctions=r})();
;var GC;(()=>{var e,t,r;function u(r){var n,n,n=t[r];return void 0!==n||(n=t[r]={exports:{}},e[r](n,n.exports,u)),n.exports}e={"./node_modules_local/@spreadjs/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":(r,n,f)=>{var o;!function(){"use strict";var e,t,r,n,u;function i(r){var n,n,n=t[r];return void 0!==n||(n=t[r]={exports:{}},e[r].call(n.exports,n,n.exports,i)),n.exports}e={"./src/functions-db.ts":function(x,r,n){var f,a,M,o,g,l,p,T,E,A,r,C,m,n,d,u,c,O,e,n,t,n;function i(r,n,e){this.N6t=r,this.k6t=n,this.D6t=e}function s(r,n){return[r,n].join(",")}function _(r,n,e){var t=this;if(t.Ky=0,t._6t=r,t.E6t=e,t.j6t={},3===arguments.length){if(t.yft=t.mvt(r,n),r.rowCount<2||r.colCount<1||e.rowCount<2||e.colCount<1||t.yft<0||t._6t.colCount<=t.yft)throw u}else if(2===arguments.length&&(t.yft=-1,r.rowCount<2||r.colCount<1||e.rowCount<2||e.colCount<1))throw u}function v(r,n,e,t){for(var u,i,f,u=0,i=new O(r,n,e);i.O6t();)f=i.R6t(),(f=t?l(f):f)&&u++;return T(u)}function I(r,n,e,t,u,i,f){for(var o,a,c,s,_,v,r,n,o=f?1:0,a=0,c=0,s=new O(r,n,e);s.O6t();)if(_=s.R6t(),l(_)){if(v=g(_),m(v))return A;o=f?o*v:o+v,a+=v*v,c++}else if(p(_))return _;return i||f?T(o):(r=Math.max(0,(c*a-o*o)/(c*(c-u))),n=t?Math.sqrt(r):r,c<=1?E:T(n))}function N(r,n,e){for(var t,u,i,f,f,t=0,u=0,i=new O(r,n,e);i.O6t();){if(f=i.R6t(),p(f))return f;if(l(f)){if(!a.Convert.sJ(f,f={value:0}))return A;t+=f.value,u++}}return 0===u?E:T(t/u)}function y(r,n,e){return v(r,n,e,!0)}function h(r,n,e){return v(r,n,e,!1)}function S(r,n,e){var n,r=new O(r,n,e);return r.O6t()?(n=r.R6t(),r.O6t()?a.Errors.Number:n):A}function R(r,n,e){for(var t,u,i,f,f,t=!1,u=-a.Functions.B6t,i=new O(r,n,e);i.O6t();){if(f=i.R6t(),p(f))return f;if(l(f)){if(f=g(f),m(f))return A;(!t||u<f)&&(u=f),t=!0}}return t?T(u):0}function D(r,n,e){for(var t,u,i,f,o,t=!1,u=a.Functions.B6t,i=new O(r,n,e);i.O6t();){if(f=i.R6t(),p(f))return f;if(l(f)){if(o=g(f),m(o))return A;(!t||f<u)&&(u=f),t=!0}}return t?T(u):0}function P(r,n,e){return I(r,n,e,!1,0,!1,!0)}function w(r,n,e){return I(r,n,e,!0,1)}function b(r,n,e){return I(r,n,e,!0,0)}function V(r,n,e){return I(r,n,e,!1,0,!0)}function L(r,n,e){return I(r,n,e,!1,1)}function k(r,n,e){return I(r,n,e,!1,0)}Object.defineProperty(r,"__esModule",{value:!0}),f=n("Common"),a=n("CalcEngine"),M=f.Common.$T,o=null,g=a.Convert.uJ,l=a.Convert.q8,p=a.Convert.BJ,T=a.Convert.L6t,E=a.Errors.DivideByZero,A=a.Errors.Value,r=a.Functions.F6t,C=a.Functions.OMt,m=isNaN,n=f.Common.zf,d=n.fJ,u=(0,a.sR)().Exp_InvalidCast,i.prototype.P6t=function(r){var n,r,n,r=(0,a.evaluateOperator)({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.N6t],r,this.k6t);return!!a.Functions.G6t(r)&&a.Convert.U6t(r)},c=i,_.prototype.mvt=function(r,n){var e,t;if(C(n)){for(e=0;e<r.colCount;e++)if((t=a.Convert.j(r[0][e]))&&this.H6t(t,n))return e;return-1}return a.Convert.z6t(n)-1},_.prototype.R6t=function(){var r=this;if(r.Ky<=0||r._6t.rowCount<=r.Ky)throw(0,a.sR)().Exp_InvalidOperation;return r._6t[r.Ky][r.yft]},_.prototype.O6t=function(){for(var r=this,n=!1,e=r._6t.rowCount;!n&&r.Ky<e;)r.Ky++,r.Ky<e&&(n=r.V6t());return n},_.prototype.Y6t=function(r){var n,e,t,u,i;if(C(r)){for(n=["=","<>","<=",">=","<",">"],e=a.Convert.j(r),u=t=void 0,t=0;t<n.length;t++)if(f.Common.zf.fJ(e,n[t]))return e=e.substring(n[t].length),i=f.Common.st.Z6t(e),m(i)?this.H6t("true",e)?r=!0:this.H6t("false",e)?r=!1:(r=e,u=0===t):r=i,new c(n[t],r,u);return new c("=",r)}return r?new c("=",r):o},_.prototype.W6t=function(r,n){var e,t,u,i,f,e=this,t=e.j6t,u=s(r,n),i=t[u];return i||t[f="_"+u]||(i=t[u]=e.Y6t(e.E6t[r][n]),t[f]=!0),i},_.prototype.V6t=function(){var r,n,e,t,u,i,f,o,a,c,s,_,v,g,l,p,T,r=this,n=!1,e=r.E6t,t=r.Ky,o=e.rowCount,a=e.colCount,c=r._6t,s=r.Q6t;if(!s){for(_=e[0],s=[],i=0;i<a;i++){if((f=r.mvt(c,_[i]))<0)return!1;s[i]=f}r.Q6t=s}for(u=1;!n&&u<o;u++)for(n=!0,i=0;n&&i<a;i++)(v=r.W6t(u,i))&&(g=c[t][s[i]],n="="===v.N6t&&(l=v.k6t,C(l))&&C(g)?(p=M.jJ(l,!0),T=v.D6t,p?M.OJ("^"+p+(T?"$":"")).test(g):T?g.toLowerCase()===l.toLowerCase():d(g,l,!0)):v.P6t(g));return n},_.prototype.H6t=function(r,n){return r.toLowerCase()===n.toLowerCase()},O=_,r("DAVERAGE",N,3,3,n=[n={K6t:!0,J6t:4,X6t:0},t={K6t:!0},n],e="!= 1",e),r("DCOUNT",y,3,3,n,e,e),r("DCOUNTA",h,3,3,n,e,e),r("DGET",S,3,3,n,e,e),r("DMAX",R,3,3,n,e,e),r("DMIN",D,3,3,n,e,e),r("DPRODUCT",P,3,3,n,e,e),r("DSTDEV",w,3,3,n,e,e),r("DSTDEVP",b,3,3,n,e,e),r("DSUM",V,3,3,n,e,e),r("DVAR",L,3,3,n,e,e),r("DVARP",k,3,3,n,e,e)},"./src/functions-eng.ts":function(D,r,n){var P,g,v,r,A,V,L,x,k,l,w,b,u,U,G,F,p,H,n,j,B,X,Y,e,T,K,W,t,i,Q,f,f,z,f,Z,i,f,o,q,J,$,rr,nr,f,er,o,i,f,i,a,tr,ur,o,ir,f,fr,o,i,f,c,i,or,ar,o,i,cr,f,c,i,f,c,i,f,c,i,sr,_r,vr,f,c,i,gr,lr,o,c,f,i,pr,Tr,s,_,Mr,M,E,Er,C,Ar,Cr,m,o,mr,dr,i,c,f,i,Or,Ir,d;function O(r,n){return new g.Functions.q6t(r,n)}function Nr(r,n){return{$6t:r,_c:n}}function I(r,n){for(var e=[],t,t=0;t<v(r);t++)e.push(Nr(r[t],n[t]));return e.push(Nr(null,0)),e}function yr(r,n,e){var t,u,i,f,o,a,c,s,_,v,t=100,u=.5*r,i=u*u;for(u=l(u,U(n)),f=g.Functions.nkt(n),o=1,a=0,c=U(n),_=.9*(s=u/f),v=!1;s!==_&&0!==t;)u*=i,f*=++a,o*=++c,_=s,s=e||v?s+u/f/o:s-u/f/o,t--,v=!v;return s}function hr(r,n){var e=l(n,10),r=parseInt(r,n);return G(r)?p:e/2<=r?r-e:r}function Sr(r,n,e){r<0&&(r+=l(n,10));for(var t=r.toString(n),u=e-v(t),i,i=0;i<u;i++)t="0"+t;return t.toUpperCase()}function Rr(r,n){var r;return r<0||(r=hr(r,n),X(r))?p:r}function Dr(r,n,e){var r=Sr(r,e,n.y4);return 0<=r&&n.y4<v(r)&&n.ekt?p:r}function N(r,n,e,t,u){var r,e;return r<0||(r=hr(r,e),X(r))||u&&(r<-u||u-1<r)||(e=Sr(r,t,n.y4),0<=r&&n.y4<v(e)&&n.ekt)?p:e}function y(r,n){var e=Number.POSITIVE_INFINITY,t=r.ikt(),u=r.rkt();return G(t)||t===e||G(u)||u===e?p:r.j(n)}function Pr(r,n,e,t){var u=r,i=n,f=e.ikt(),e=e.rkt();return{okt:r=t?u*f-i*e:u+f,akt:n=t?u*e+i*f:i+e}}function wr(r,n){for(var e,t,u,i,f,o,a,c,s,_,e=n?1:0,t=0,i=0;i<v(r);i++)if(g.Convert.Nh(r[i]))for(s=r[i],f=0;f<s.rowCount;f++)for(o=0;o<s.columnCount;o++){if(!(u=T(s.getValue(f,o))))return p;e=(c=Pr(e,t,u,n)).okt,t=c.akt}else if(g.Convert.LE(r[i]))for(_=r[i],a=0;a<_.getRangeCount();a++)for(f=0;f<_.getRowCount(a);f++)for(o=0;o<_.getColumnCount(a);o++){if(!(u=T(_.getValue(a,f,o))))return p;e=(c=Pr(e,t,u,n)).okt,t=c.akt}else{if(!(u=T(r[i])))return p;e=(c=Pr(e,t,u,n)).okt,t=c.akt}return y(O(e,t))}function br(r,n){return B(yr(r,n,!0))}function Vr(r,n){return B(yr(r,n,!1))}function Lr(r,n){var e,t,u,i,f,o,a,c,s,_,v,g,l,p,T,M,E,e=17976931348623157e292,t=.5772156649015329,u=0,i=.25*r*r,f=1,o=0,a=1,c=2/r;if(0<n){for(o=-t,g=1;g<n;g++)o+=1/g,f*=g+1;if(a=c,1===n)u=1/r;else{for(s=l=f/n,g=T=p=1;g<n;g++){if(s+=_=(l/=n-g)*(T*=-i)/(p*=g),e-A(_)<A(s)||1<c&&e/c<a)return e;a*=c}if(_=A(s*=.5),1<a&&e/a<_||1<_&&e/_<a)return e;u=s*a}}for(E=-t,_=0===n?(o=E,1):(o+=1/n,1/f),s=(E+o-(M=2*k(r/2)))*_,v=1;s+=((E+=1/v)+(o+=1/(v+n))-M)*(_*=i/(v*(v+n))),v++,11102230246251565e-32<A(_/s););return s=.5*s/a,B(u+=s=0!=(1&n)?-s:s)}function xr(r,n){var g,l,p,T,M,E,A,C,m,d,O,I,N,y,h,S,R,D,P;function w(r,n,e,t){var u=0,i=U(n[u]),f=e;for(u++,t&&(i+=r,f--);i=i*r+U(n[u]),u++,0!==--f;);return i}function b(r,n){var e,t,u,i,f,o,a,c,s,_,v,o,e,e=n?g:l,t=n?p:T,u=n?M:E,i=n?A:C,f,o=n?h:S,a,c;return r<=5?(_=r*r,n&&r<1e-5?1-_/4:(v=(_-(n?5.783185962946784:14.681970642123893))*(_-(n?30.471262343662087:49.2184563216946)),v*=s=w(_,n?N:y,3)/w(_,o,8,!0),n?v:v*r)):(s=5/r,v=w(_=n?25/(r*r):s*s,e,6)/w(_,t,6),o=w(_,u,7)/w(_,i,7,!0),(v=v*L(e=r-(n?P:D))-s*o*V(e))*R/x(r))}function o(r,n){var e,t,u,i,f,o,a,c,s,_,v,c,v,u,u=n?g:l,i=n?p:T,f=n?M:E,o=n?A:C,a,c=n?O:I,s,_,v=n?7:8;return r<=5?(e=(n?1:r)*w(t=r*r,n?m:d,n?7:5)/w(t,c,v,!0),e+.6366197723675814*(n?k(r)*b(r,!0):b(r,!1)*k(r)-1/r)):(e=5/r,c=w(t=n?25/(r*r):e*e,u,6)/w(t,i,6),v=w(t,f,7)/w(t,o,7,!0),(c=c*V(u=r-(n?P:D))+e*v*L(u))*R/x(r))}function e(r,n){var e=o(r,!0),t=o(r,!1),u=1,i=2*u,f;if(0===n)return e;if(1===n)return t;for(;f=i*t/r-e,e=t,t=f,i+=2,++u<n;);return f}return g=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],l=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],p=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],T=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],M=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],E=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],A=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],C=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],m=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],d=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],O=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],I=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],N=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],y=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],h=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],S=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],R=.7978845608028654,D=2.356194490192345,P=.7853981633974483,B(e(r,n))}function kr(r){return Rr(r,2)}function Ur(r){return Rr(r,16)}function Br(r){return Rr(r,8)}function Gr(r,n){return N(r,n,2,16)}function Fr(r,n){return N(r,n,2,8)}function Hr(r,n){return Dr(r,n,2)}function jr(r,n){return Dr(r,n,16)}function Xr(r,n){return Dr(r,n,8)}function Yr(r,n){return N(r,n,16,2,512)}function Kr(r,n){return N(r,n,8,2,512)}function Wr(r,n){return N(r,n,16,8,536870912)}function Qr(r,n){return N(r,n,8,16,549755813888)}function zr(r,n){var r,e,t,r=j(r*x(2)),e=2*r-1;return e=n.ekt?(t=2*(r=j(n.y4*x(2)))-1)-e:e}function Zr(r){return zr(r,{ekt:!1})}function qr(r){return 1-zr(r,{ekt:!1})}function Jr(r,n){return r===n||P.Common.st.ukt(r,n)?1:0}function $r(r,n){return n<=r?1:0}function rn(r,n,e){return"i"!==e&&"j"!==e?g.Errors.Value:y(O(r,n),e)}function nn(r){return B(x(r.okt*r.okt+r.akt*r.akt))}function en(r){return B(r.akt)}function tn(r){return 0===r.okt&&0===r.akt?g.Errors.DivideByZero:B(u(r.akt,r.okt))}function un(r){return y(O(r.okt,-r.akt))}function fn(r){return y(O(L(r.okt)*e(r.akt,!1),-V(r.okt)*e(r.akt,!0)))}function on(r,n){var e,r,t,n,e=r.okt,r=r.akt,t=n.okt,n=n.akt;return y(O((e*t+r*n)/(t*t+n*n),(r*t-e*n)/(t*t+n*n)))}function an(r){return y(O(w(r.okt)*L(r.akt),w(r.okt)*V(r.akt)))}function cn(r){var n,r,n=r.okt,r=r.akt;return y(O(k(x(n*n+r*r)),u(r,n)))}function sn(r){var n,r,e,n=r.okt,r=r.akt,e=Y.ckt(b,10);return y(O(e*k(x(n*n+r*r)),e*u(r,n)))}function _n(r){var n,r,e,n=r.okt,r=r.akt,e=Y.ckt(b,2);return y(O(e*k(x(n*n+r*r)),e*u(r,n)))}function vn(r,n){var e,r,t,r,e=r.okt,r=r.akt;return 0===e&&0===r?0<n?"0":p:(t=x(e*e+r*r),r=u(r,e),y(O(l(t,n)*L(n*r),l(t,n)*V(n*r))))}function gn(r){return B(r.okt)}function ln(r){return y(O(V(r.okt)*e(r.akt,!1),L(r.okt)*e(r.akt,!0)))}function pn(r){var n,r,e,r,n=r.okt,r=r.akt;return 0===n&&0===r?"0":(e=x(n*n+r*r),r=u(r,n),y(O(x(e)*L(r/2),x(e)*V(r/2))))}function Tn(r,n){return y(O(r.okt-n.okt,r.akt-n.akt))}function Mn(){return wr(arguments,!0)}function En(){return wr(arguments,!1)}function An(r){for(var n,e,n=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"],e=0;n[e];e++)if(0===r.localeCompare(n[e]))return;return 1}function Cn(r,n,e){for(var t,u,i,f,o,a,c,s,u=0,i=1,t=0;r[t].$6t;t++)if(0===e.localeCompare(r[t].$6t))return{fkt:!0,vit:i,lkt:u=r[t]._c};if(n)for(t=0;n[t].$6t;t++)(f=e.substr(0,1))===(o=n[t].$6t.substr(0,1))&&An(e)&&(i=n[t]._c);for(t=0;r[t].$6t;t++)if(a=v(r[t].$6t),(c=e.substr(1,a))===(s=r[t].$6t.substr(0,a))&&An(e))return{fkt:!0,vit:i,lkt:u=r[t]._c};return{fkt:!1,vit:i,lkt:u}}function mn(r,n,e){var t,u,i,f,o,a,c,s,f,_,o;if(h(n).unit&&h(e).unit)return Sn(r,n,e);if(1!==(t=Nn(n,e))){if(2===t)return yn(r,n,e);if(On(n)&&On(e))return In(r,n,e);if(!dn(n)&&!dn(e))for(u=[Z,er,ur,ir,or,fr,ar,_r,ar,vr,pr],i=0;i<v(u);i++)if(a=(o=Cn(f=u[i],C,n)).fkt,c=o.lkt,s=o.vit,f=(o=Cn(f,C,e)).fkt,_=o.vit,o=o.lkt,a&&f&&0!==c&&0!==_)return r*s/c*o/_}return F}function dn(r){var r,n,e;if(!(0<=Cr.indexOf(r)))return e=(r=[r.slice(0,1),r.slice(1)])[1],0<=Er.indexOf(r[0])&&0<=Cr.indexOf(e)}function On(r){for(var n=0;n<a.length;n++)if(r===a[n].$6t)return 1;return"sec"===r.slice(1)||"s"===r.slice(1)}function In(r,n,e){var n,e,n=Cn(a,C,n),e=Cn(a,C,e);return r*n.vit/n.lkt*e.lkt/e.vit}function Nn(r,n){var r,n,r=-1<r.indexOf("bit")||-1<r.indexOf("byte"),n=-1<n.indexOf("bit")||-1<n.indexOf("byte");return r&&n?2:n||r?1:0}function yn(r,n,e){var n,e,n=hn(n),e=hn(e);return r*n.vit/n.lkt*e.lkt/e.vit}function hn(r){var n,r,e,t,n,u,i;if(-1<r.indexOf(s.bit)?(e=(n=[r.slice(0,-3),r.slice(-3)])[0],n=n[1]):-1<r.indexOf(s.byte)&&(e=(r=[r.slice(0,-4),r.slice(-4)])[0],n=r[1]),e)for(i=0;Ar[i].$6t;i++)e===Ar[i].$6t&&(t=Ar[i]._c);else t=1;return n===s.bit?u=Tr[0]._c:n===s.byte&&(u=Tr[1]._c),{vit:t,lkt:u}}function Sn(r,n,e){var t,u,u=h(n);switch(u.unit){case _.Rank:t=wn(r,e);break;case _.Reau:t=bn(r,e);break;case _.C:case _.cel:t=Rn(r,e);break;case _.F:case _.fah:t=Dn(r,e);break;case _.K:case _.kel:t=Pn(r*u.prefixNumber,e)}return t}function Rn(r,n){var e,t,t=h(n);switch(t.unit){case _.Rank:return 9*r/5+32+E;case _.Reau:return.8*r;case _.cel:case _.C:return r;case _.F:case _.fah:return 9*r/5+32;case _.K:case _.kel:return e=t.prefixNumber,(r+M)/e}}function Dn(r,n){var e,t,t=h(n);switch(t.unit){case _.Rank:return r+E;case _.Reau:return 4*(r-32)/9;case _.F:case _.fah:return r;case _.C:case _.cel:return 5*(r-32)/9;case _.K:case _.kel:return e=t.prefixNumber,(5*(r-32)/9+M)/e}}function Pn(r,n){var e,t,t=h(n);switch(t.unit){case _.Rank:return 9*r/5;case _.Reau:return.8*(r-M);case _.C:case _.cel:return r-M;case _.F:case _.fah:return 9*(r-M)/5+32;case _.K:case _.kel:return r/(e=t.prefixNumber)}}function wn(r,n){var e,t,t=h(n);switch(t.unit){case _.Rank:return r;case _.Reau:return.8*(r-E-32)*5/9;case _.C:case _.cel:return 5*(r-E-32)/9;case _.F:case _.fah:return r-E;case _.K:case _.kel:return e=t.prefixNumber,(M+5*(r-E-32)/9)/e}}function bn(r,n){var e,t,t=h(n);switch(t.unit){case _.Rank:return 1.25*r*9/5+32+E;case _.Reau:return r;case _.C:case _.cel:return 1.25*r;case _.F:case _.fah:return 1.25*r*9/5+32;case _.K:case _.kel:return e=t.prefixNumber,(1.25*r+M)/e}}function h(r){var n,e,t,n=1;if(!_[r]){if("K"!==_[r.slice(1)]&&"kel"!==_[r.slice(1)])return{unit:void 0,prefixNumber:n};for(e=r.slice(0,1),r=r.slice(1),t=0;C[t].$6t;t++)e===C[t].$6t&&(n=C[t]._c)}return{unit:r,prefixNumber:n}}function Vn(r,n,e,t){var u,i;if(""===r&&""===n)return H;if(i={value:0},!0!==W(r,u={value:0})||!0!==W(n,i))return H;if(n=i.value,(r=u.value)<0||K<r||r%1!=0)return p;if("bitOperator"===e){if(n<0||K<n||n%1!=0)return p}else if("shiftOperator"===e&&0===r)return 0;return t(r,n)}function Ln(r,n){return Vn(r,n,"bitOperator",function(r,n){return r&n})}function xn(r,n){return Vn(r,n,"bitOperator",function(r,n){return r|n})}function kn(r,n){return Vn(r,n,"bitOperator",function(r,n){return r^n})}function Un(r,n){return Vn(r,n,"shiftOperator",function(r,n){var r;return 48<=n?p:n<0&&r<1<<-n?0:K<(r=r<<n)?p:r})}function Bn(e,t){return Vn(e,t,"shiftOperator",function(r,n){return 53<n?p:0<=t?e>>t:e<<-t})}function S(r,n){var r;return""===r?p:!0===r||!1===r?H:(r=T(r))?n(r):p}function Gn(r){return S(r,function(r){return y(qn(r),r.hkt())})}function Fn(r){return S(r,function(r){return t1(Qn(r),O(0,0))?p:y(R(zn(r),Qn(r)),r.hkt())})}function Hn(r){return S(r,function(r){return t1(r,O(0,0))?p:y($n(r),r.hkt())})}function jn(r){return S(r,function(r){return t1(Zn(r),O(0,0))?p:y(r1(r),r.hkt())})}function Xn(r){return S(r,function(r){return t1(zn(r),O(0,0))?p:y(n1(r),r.hkt())})}function Yn(r){return S(r,function(r){return t1(qn(r),O(0,0))?p:y(e1(r),r.hkt())})}function Kn(r){return S(r,function(r){return y(Zn(r),r.hkt())})}function Wn(r){return S(r,function(r){return y(Jn(r),r.hkt())})}function Qn(r){var n,r,n=r.ikt(),r=r.rkt();return O(V(n)*e(r,!1),L(n)*e(r,!0))}function zn(r){var n,r,n=r.ikt(),r=r.rkt();return O(L(n)*e(r,!1),-(V(n)*e(r,!0)))}function Zn(r){var n,r,n=r.ikt(),r=r.rkt();return O(e(n,!0)*L(r),e(n,!1)*V(r))}function qn(r){var n,r,n=r.ikt(),r=r.rkt();return O(e(n,!1)*L(r),e(n,!0)*V(r))}function Jn(r){return R(Qn(r),zn(r))}function $n(r){return R(t,Qn(r))}function r1(r){return R(t,Zn(r))}function n1(r){return R(t,zn(r))}function e1(r){return R(t,qn(r))}function R(r,n){var e,r,t,n,u,u,e=r.ikt(),r=r.rkt(),t=n.ikt(),n=n.rkt();return Math.abs(n)<Math.abs(t)?O((e+r*(u=n/t))/(t+n*u),(r-e*u)/(t+n*u)):O((r+e*(u=t/n))/(n+t*u),(r*u-e)/(n+t*u))}function t1(r,n){return r.ikt()===n.ikt()&&r.rkt()===n.rkt()}Object.defineProperty(r,"__esModule",{value:!0}),P=n("Common"),g=n("CalcEngine"),v=P.Common.Uf.tR,r=void 0,A=Math.abs,V=Math.sin,L=Math.cos,x=Math.sqrt,k=Math.log,l=Math.pow,w=Math.exp,b=Math.E,u=Math.atan2,U=parseFloat,G=isNaN,F=g.Errors.NotAvailable,p=g.Errors.Number,H=g.Errors.Value,n=g.Functions.F6t,j=g.Functions.dkt,B=g.Convert.L6t,X=g.Convert.BJ,Y=g.Functions.MathHelper,e=Y.vkt,T=g.Functions.mkt,K=0xffffffffffff,W=g.Convert.sJ,t=O(1,0),Z=I(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,i=.00220462262184878,602214179421676e9,.0352739619495804,Q=7e3*i,f=i/100,f,f=i/112,f,f,z=i/14,110231131092439e-20,f=i/2240,f,f]),er=I(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,q=(o=(f=(i=1e4/254)/12)/3)/1760,1/1852,i,f,o,1e10,2834.64566929134,J=i/45,nr=105700083402462e-30,f=324077928966473e-31,$=6*i,rr=.00062136994949495,f,2834.64566929134]),a=I(["yr","day","hr","mn","sec","d","min","s"],[1,o=365.25,i=8766,f=60*i,i=60*f,o,f,i]),ur=I(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,tr=.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),ir=I(["N","dyn","lbf","dy","pond"],[1,o=1e5,.22480894309971,o,101.971621297793]),fr=I(["HP","W","h","w","PS"],[1,f=745.69987158227,1,f,1.013869665424]),or=I(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,i=.239005736137667,i,o=624150964712042e4,i=1/(3600*f),f=1/3600,.737562149277265,c=.000947817120313317,o,i,f,c]),ar=I(["T","ga"],[1,1e4]),_r=I(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,o=.00492892159375,.00867368942321863,1/96,o,i=1e27*o,i,1/32256,cr=.000139870932189991,f=.00017406322338,f,c=.30078125,c,i=82073596535e-54,i,f=492892159375e-17,f,c=118251117638e-26,c,i=64467860511e-16,i,f=775941468987e-27,f,c=112266,c,c,c,i=1740632233796e-18,i,sr=4351580584491e-18,o]),vr=I(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),pr=I(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,f=10.7639104167097,f,c=144*f,c,i=f/9,i,gr=.000247105381467165,lr=.000247104393046628,1e20,1e20,.01,1e-4,4e-4,o=i/3097600,o,c=2.91553349598123e-7,c,f=8035216.07043214,f,f,f,i=111725076312873e-46,i]),Tr=I(["bit","byte"],[1,.125]),s={bit:"bit",byte:"byte"},_={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},Mr={day:"day",d:"d",yr:"yr",hr:"hr",mn:"mn",min:"min",sec:"sec",s:"s"},M=273.15,E=459.67,C=I(Er=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Ar=I(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Cr=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],o={J6t:5},c={J6t:8},f={J6t:8,gkt:!0},Or=[{J6t:0,pkt:"<= 0"},i={J6t:2,pkt:"< 0"}],Ir=[m={J6t:0},{J6t:0,bkt:0}],d=[mr={J6t:5,pkt:["checkLength 10"]},dr={ykt:!0,J6t:2,bkt:1,pkt:["< 1","> 10"]}],n("BESSELI",br,2,2,i=[m,i]),n("BESSELJ",Vr,2,2,i),n("BESSELK",Lr,2,2,Or),n("BESSELY",xr,2,2,Or),n("BIN2DEC",kr,1,1,mr),n("BIN2HEX",Gr,1,2,d,r,r,{wkt:1}),n("BIN2OCT",Fr,1,2,d,r,r,{wkt:1}),n("DEC2BIN",Hr,1,2,[{J6t:0,pkt:["< -512","> 511"]},dr],r,r,{wkt:1}),n("DEC2HEX",jr,1,2,[{J6t:0,pkt:["< -549755813888","> 549755813887"]},dr],r,r,{wkt:1}),n("DEC2OCT",Xr,1,2,[{J6t:0,pkt:["< -536870912","> 536870911"]},dr],r,r,{wkt:1}),n("HEX2BIN",Yr,1,2,d,r,r,{wkt:1}),n("HEX2DEC",Ur,1,1,mr),n("HEX2OCT",Wr,1,2,d,r,r,{wkt:1}),n("OCT2BIN",Kr,1,2,d,r,r,{wkt:1}),n("OCT2DEC",Br,1,1,mr),n("OCT2HEX",Qr,1,2,d,r,r,{wkt:1}),n("ERF",zr,1,2,[m,{ykt:!0,J6t:0}],r,r,{wkt:1}),n("ERF.PRECISE",Zr,1,1,m),n("ERFC",qr,1,1,m),n("ERFC.PRECISE",qr,1,1,m),n("DELTA",Jr,1,2,Ir,r,r,{wkt:1}),n("GESTEP",$r,1,2,Ir,r,r,{wkt:1}),n("COMPLEX",rn,2,3,[m,m,{J6t:5,bkt:"i"}],r,r,{wkt:2}),n("IMABS",nn,1,1,c),n("IMAGINARY",en,1,1,c),n("IMARGUMENT",tn,1,1,c),n("IMCONJUGATE",un,1,1,c),n("IMCOS",fn,1,1,c),n("IMDIV",on,2,2,[c,f]),n("IMEXP",an,1,1,c),n("IMLN",cn,1,1,f),n("IMLOG10",sn,1,1,f),n("IMLOG2",_n,1,1,f),n("IMREAL",gn,1,1,c),n("IMSIN",ln,1,1,c),n("IMSQRT",pn,1,1,c),n("IMSUB",Tn,2,2,[c,c]),n("IMPOWER",vn,2,2,[c,{J6t:2}]),n("IMPRODUCT",Mn,1,255,r,-1,-1),n("IMSUM",En,1,255,r,-1,-1),n("CONVERT",mn,3,3,[{J6t:1},o,o]),n("BITAND",Ln,0,2),n("BITLSHIFT",Un,0,2),n("BITOR",xn,0,2),n("BITRSHIFT",Bn,0,2),n("BITXOR",kn,0,2),n("IMCOSH",Gn,1,1),n("IMCOT",Fn,1,1),n("IMCSC",Hn,1,1),n("IMCSCH",jn,1,1),n("IMSEC",Xn,1,1),n("IMSECH",Yn,1,1),n("IMSINH",Kn,1,1),n("IMTAN",Wn,1,1)},"./src/functions-fin.ts":function(x,r,n){var k,g,U,B,G,r,y,N,F,l,H,v,f,j,X,p,I,E,C,h,m,Y,K,W,Q,z,T,Z,S,n,q,J,$,o,M,R,d,rr,nr,er,tr,e,t,u,r,i,ur,ir,fr,a,or,ar,c,cr,sr,_r,s,vr,gr,lr,pr,Tr,Mr,Er,Ar,Cr,mr,dr,Or,Ir,Nr,yr,hr,Sr;function O(r){return r.getMonth()}function D(r){return r.getDate()}function P(r){return r.getFullYear()}function Rr(r,n){var e,e,e,e=P(r),e=new Date(e,n,1),e=M(P(e),O(e));D(r)>e&&r.setDate(e),r.setMonth(n)}function w(r){return r instanceof Date?k.Common.ct.o0(r):r}function _(r,n,e){var t,t,u,i,t=P(n)-P(r),t=O(n)-O(r)+12*t,u=D(n)-D(r),i=-1;return 0===e?i=g.Functions.Mkt(r,n):0<=y(e,[1,2,3])?i=w(n)-w(r):4===e&&(i=30*t+u),i}function Dr(r,n,e,t,u){var i,f,n,i=C(1+r,n),f=B(i)?i:S;return 0===r?n:!v(f)&&(n=B(i=(i-1)/r)?i:S,!v(n))&&B(i=(-e*f-t)/((1+r*u)*n))?i:S}function A(r,n,e,t){var u,i,f,o,a,c,s,_,u=P(n),i=O(n),f=D(n),o=new Date(1,0,1),a=0,c=f===M(u,i),s=12/e,_=u-P(r);for(o.setFullYear(1),0<_&&(_=(_-1)*e);Rr(o=new Date(u,i,f),i-++_*s),c&&(a=M(P(o),O(o)),o=new Date(P(o),O(o),a)),R(r,o)<0;);return t&&(Rr(o=new Date(u,i,f),i- --_*s),c)&&(a=M(P(o),O(o)),o=new Date(P(o),O(o),a)),o}function Pr(r,n,e,t){return d(A(r,n,e,!1),r,t)}function b(r,n,e,t){var t,t=0<=y(t,[0,2,4,5])?360/e:3===t?365/e:d(A(r,n,e,!1),A(r,n,e,!0),1);return t}function wr(r,n,e,t){return d(r,A(r,n,e,!0),t)}function br(r,n,e){var t,u,n,i,f,t=P(n),u=O(n),n=D(n),i=new Date(t,u,n),f=u-O(r)+12*(t-P(r));if(Rr(i,O(i)-f),n===M(t,u))for(;D(i)!==M(P(i),O(i));)i.setDate(D(i)+1);return D(r)>=D(i)&&f--,G((1+f/(12/e)).toString())}function V(r,n,e){return 0<n?(e.Ckt?e.Skt?h(r-e.Tkt)<h(e.Akt-e.Tkt)&&(e.Akt=r,e.Ikt=n):n<e.Ikt&&(e.Akt=r,e.Ikt=n):(e.Akt=r,e.Ikt=n,e.Ckt=!0),[!1,e]):n<0?(e.Skt?e.Ckt?h(r-e.Akt)<h(e.Akt-e.Tkt)&&(e.Tkt=r,e.xkt=n):-n<-e.xkt&&(e.Tkt=r,e.xkt=n):(e.Tkt=r,e.xkt=n,e.Skt=!0),[!1,e]):isNaN(n)?[!1,e]:(e.Nkt=r,[!0,e])}function Vr(r,n,e,t,u){var i,f,o,i=A(r,e,t,!0),f=A(r,e,t,!1);if(0<=R(i,n))return d(r,n,u)/b(f,i,t,u);for(o=d(r,i,u)/b(f,i,t,u);;){if(f=new Date(P(i),O(i),D(i)),Rr(i,O(i)+12/t),0<=R(i,n))return o+=d(f,n,u)/b(f,i,t,u);o+=1}}function Lr(r,n,e,t,u,i,f){for(var o,a,f,c,s,_,v,g,l,p,T,o=Pr(r,n,i,f),a=wr(r,n,i,f),f=b(r,n,i,f),c=G(br(r,n,i).toString()),s=0,_=100*e/i,v=1+t/i,g=a/f,l=0;l<c;l++)s+=_/C(v,g+l);return(p=u/C(v,c-1+a/f))+s-(T=o/f*_)}function xr(r,n,e,t,u,i,f,o,a){var c,s,_,v,g,e,t,l,p,T,M,E,A,c=d(o,r,f),s=d(r,a,f),_=d(o,a,f),v=b(r,n,i,f),g=G(br(r,n,i).toString()),e=100*e/i,t=1+t/i;if(v<s)switch(f){case 0:case 4:l=d(a,n,f),g=1+G(m(l/v).toString());break;default:for(p=new Date(P(a),O(a),D(a)),g=0;g<32767;g++)if(T=new Date(P(p),O(p),D(p)),Rr(p,O(p)+12/i),0<=R(p,n)){g+=G((m(d(T,n,f))/b(T,p,i,f)).toString())+1;break}c=v*Vr(o,r,a,i,f),s=v*Vr(r,a,a,i,f),_=v*Vr(o,a,a,i,f)}return(M=u/C(t,g-1+s/v))+e*((E=_/v/C(t,s/v))+(A=C(t,-s/v)*(C(t,-g)-1/t)/(1/t-1))-c/v)}function kr(r,n){var r,e,r=r.substr(0,3),e={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return e[r]?J(e[r],n):-1}function Ur(r,n,e,t,u){var i,f=C(1+r,n);return 0===r?i=(e+t)/n:(i=t*r/(f-1)+e*r/(1-1/f),0<u&&(i/=1+r)),-i}function Br(r,n,e,t,u){var i=C(1+r,n),f;return-(0===r?t+e*n:t*i+e*(0<u?1+r:1)*(i-1)/r)}function Gr(r,n,e,t,u,i,f){if(i<u||e<i||0!==f&&1!==f)return S;var o=Ur(n,e,t,0,f),a=0,c,s;for(1===u&&(r&&(a=o),f<=0&&(a+=r?t*n:-t),u++),c=u;c<=i;c++)s=0<f?Br(n,c-2,o,t,1)-o:Br(n,c-1,o,t,0),a+=r?o-s*n:s;return r?a:a*n}function Fr(r,n,e,t){var t,r,t=C(1+e,t),r=-(r*t*e+n*(t-1));return B(r)?r:S}function Hr(r,n,e,t,u){return y(t,[1,2,4])<0||0<=R(n,e)?S:r(n,e,t,u)}function jr(r,n,e,t,u,i){function f(r,n,e,t){var u=0,i,f=0,o=100;for(r*=o/X(e),n/=e,n++,i=1;i<t;i++)u+=i*r/C(n,i);for(u+=t*(r+o)/C(n,t),i=1;i<t;i++)f+=r/C(n,i);return u=(u/=f+=(r+o)/C(n,t))/X(e)}var t;return y(i,[1,2,4])<0||0<R(n,e)?S:(t=f(t,u,i,br(n,e,i)),r?t/(1+u/i):t)}function Xr(r,n,e,t,u,i,f,o,a){var c,s,t,n;if(y(f,[1,2,4])<0||0<R(n,e)||0<R(t,n))return S;for(c=new Date(P(t),O(t),D(t));Rr(c,O(c)+12/f),R(c,e)<0;);return s=Vr(t,n,c,f,o),t=Vr(t,e,c,f,o),n=Vr(n,e,c,f,o),r?(i*f+100*u*(t-s*(1+a*n/f)))/(a*n+f):(f*(i-a)+100*u*(t-s))/(n*a+100*u*s*n/f)}function Yr(r,n,e){var t,u,n,i;return 0===e?T:(t=(n<0?m:W)(n),u=C(10,m(q.ckt(e,10))),n=n-t,f(t+(i=r?n*u/e:n*e/u)))}function Kr(r,n,e,t){var u,i,f,o,a,c,u=l(n),i=0,o=1+r,a=.75<=o&&o<=1.25&&12<u&&t?2.5:0;if(e)for(f=0;f<u;f++){if(c=-(f-a)*n[f]*Math.pow(o,-(f-a)-1),isNaN(c))return i;i+=c}else for(f=0;f<u;f++){if(c=n[f]*Math.pow(o,-(f-a)),isNaN(c))return i;i+=c}return i}function L(r,n,e,t){var u,i,f,o,u=0,i=l(n);for(r<=-1&&(r=1e-10-1),f=0;f<i;f++){if((o=w(t[f])-w(t[0]))<0)return[!1,e];u+=n[f]/q.kkt(r,o/365)}return B(u)?e=isNaN(u)?5e-324:u:u===Number.POSITIVE_INFINITY?e=$:u===Number.NEGATIVE_INFINITY&&(e=-$),[!0,e]}function Wr(r,n,e,t){var u,i,f;return-1<r&&0!==r?(i=C(1+r,(u=e).Dkt-(t?1:0)),f=(C(1+r,u.Dkt)-1)/r,[!0,n=t?-u._kt*f/r+i*u.Dkt*(u._pv+u._kt*(u.uit+1/r)):u._pv*i+u._kt*(1+r*u.uit)*f+u._fv,e]):[!1,n,e]}function Qr(r,n,e,t,u,i,f,o,a,c,s,_,v,g,l){var p,T,M,u,E,A,e,C,m,p=0,T=0,M=e-u,u=e+u,E=2===r;if((M=M<i.Okt?e:M)===(u=u>i.Rkt?e:u))return E?[!1,t,i,f]:[!1,t,i];if(e=0===r?(A=n(f,o,a,M,s,_,v,g,l)-c,n(f,o,a,u,s,_,v,g,l)-c):1===r?(A=n(M,f,p,o),n(u,f,T,o)):(A=Wr(M,p,f),Wr(u,T,f)),N(A)){if(m=A[2],p=A[1],!(C=A[0]))return E?[C,t,i,m]:[C,t,i]}else p=A;if(N(e)){if(m=e[2],T=e[1],!(C=e[0]))return E?[C,t,i,m]:[C,t,i]}else T=e;return t=(T-p)/(u-M),E?[!0,t,i,m]:[!0,t,i]}function zr(r,n,e,t,u,i,f,o,a,c,s,_,v){var g,r;return t<e.Okt||t>e.Rkt?[!1,e]:(e=(r=V(t,g=r?Kr(t,u):n(u,i,f,t,a,c,s,_,v)-o,e))[1],[!!r[0],e])}function Zr(r,n,e,t,u){if(!(n>r.Rkt)){var t=L(n,t,e,u);if(e=t[1],!t[0])return t[0];r=(t=V(n,e,r))[1],t[0]}}function qr(r,n,e){var t,u,n,t=0;return n<r.Okt||n>r.Rkt?[!1,r,e]:(e=(u=Wr(n,0,e))[2],t=u[1],u[0]?(r=(n=V(n,t,r))[1],[!!n[0],r,e]):[u[0],r,e])}function Jr(r,n,e,t,u,i,f,o,a,c){var s,_,v,g,l,p,T,M,_=0,v=r?15:2;if(e.Ckt&&e.Skt)for(g=h(e.Akt-e.Tkt)/(h(e.Akt)+h(e.Tkt)),s=0;s<100+4*v;s++)if(T=void(p=l=0),T=s%4==0?1:s%4==2?2:3,M=void 0,e=(M=r?fn(e,t,g,_,0,T):n?on(!0,e,_,0,0,T,L,g,u,t,Qr):on(!1,e,_,0,0,T,Lr,g,i,f,o,t,u,a,c))[1],r&&(t=M[2]),_=r?M[3]:M[2],M[0])return r?[!0,e,t]:[!0,e];return r?[!1,e,t]:[!1,e]}function $r(r,n,e,t,u,i,f,o,a,c,s){var _,v,g,l,p,T,M,M,M,g=0,l=r?15:2;if(n.Ckt&&n.Skt)for(v=h(n.Akt-n.Tkt)/(h(n.Akt)+h(n.Tkt)),_=0;_<100+4*l;_++)if(M=void(T=p=0),M=_%4==0?1:_%4==2?2:3,n=(M=r?on(!0,n,g,p,T,M,Kr,v,E,e,Qr):on(!1,n,g,p,T,M,xr,v,f,o,a,e,t,c,s,u,i))[1],g=M[2],p=M[3],!(r&&M[0]===I||!r&&F(M[0]))){if(M[0])return[!0,n];if(n=(M=V(p,T=r?Kr(p,e):xr(e,t,f,p,a,c,s,u,i)-o,n))[1],M[0])return[!0,n];if((v=h(n.Akt-n.Tkt)/(h(n.Akt)+h(n.Tkt)))<n.Bkt)return n.xkt<T&&(T=n.xkt,p=n.Tkt),n.Ikt<T&&(p=n.Akt),n.Nkt=p,[!0,n]}return[!1,n]}function rn(r,n,e,t,u,i,f,o,a,c,s,_,v){for(var g,l,p,T,M,E,A,A,C,C,m,C,A,m,A,d,g,O,I,d,T=e.Bkt/2,E=!1,l=0;l<20;l++){if(t<e.Okt||t>e.Rkt){if(!r||e.Skt&&e.Ckt||!(t<=-1))return[!1,e];t=-1,E=!0}if(A=r?L(t,u,0,i):n(u,i,f,t,a,c,s,_,v)-o,N(A)){if(M=A[1],!(p=A[0]))return[p,e]}else M=A;if(e=(A=V(t,M,e))[1],A[0])return[!0,e];if(E)return[!1,e];if(C=e.Skt&&e.Ckt?h(e.Akt-e.Tkt):e.Rkt-e.Okt,C=(h(t)<1e-10?C:h(t))/1e6,m=0,e=(A=r?Qr(1,L,t,0,C,e,u,i):Qr(0,n,t,0,C,e,u,i,f,o,a,c,s,_,v))[2],m=A[1]<0?A[1]:-A[1],!(p=A[0]))return[p,e];if(0===m)return[!1,e];if((C=t-1.000001*M/m)===t)return e.Nkt=t,[!0,e];if(r&&e.Skt&&e.Ckt&&C<(m=(A=[e.Akt,e.Tkt])[0])==C<(A=A[1])&&(d=!0,A<m&&(m=(g=[A,m])[0],A=g[1],d=!1),O=(g=[e.Ikt,e.xkt])[0],I=g[1],C=m+h((d?O:I)/(I-O))*(A-m)),d=h(C-t)/(h(t)+h(C)),t=C,d<T)return e.Nkt=t,[!0,e]}return[!1,e]}function nn(r,n,e){for(var t,u,i,e,f,o,a,c,s,t=r.Bkt/2,u=0;0===n[u];)u++;for(i=n.slice(u),f=[!1,null],o=[e],.1!==e&&o.push(.1),o.push(-.1,.99*r.Rkt,r.Okt+.01),a=0;!f[0]&&a<o.length;a++)en(f=tn(U(r),i,o[a],t),i);if(!f[0]){for(c=0,a=1,s=i.length;a<s;a++)c+=i[a];e=-c/i[0]-1,f=tn(U(r),i,e,t)}return f}function en(r,n){var e,t,u,u;r[0]&&(t=15,"number"==typeof(e=r[1].Nkt)&&-10<e&&e<10&&(1<(u=e.toString()).indexOf("000000000000")||1<u.indexOf("999999999999"))&&(t=14),.001<(u=sn(e=k.Common.st.E8(e,t),n))||u<-.001)&&(r[0]=!1)}function tn(r,n,e,t){for(var u,i,f,f,i,f,u=0;u<32;u++){if(e<r.Okt||e>r.Rkt)return[!1,r];if(r=(f=V(e,i=Kr(e,n,!1,!0),r))[1],f[0])return[!0,r];if(0===(f=Kr(e,n,!0,!0)))return[!1,r];if((i=e-1.0000001*i/f)===e)return r.Nkt=e,[!0,r];if(f=h(i-e)/(h(e)+h(i)),e=i,f<t)return r.Nkt=e,[!0,r]}return[!1,r]}function un(r,n,e){for(var t,u,i,f,o,a,c,s,_,u=r.Bkt/2,t=0;t<100;t++){if(o=f=i=void 0,e<r.Okt||e>r.Rkt)return[!1,r,n];if(n=(s=Wr(e,c=a=0,n))[2],a=s[1],!(o=s[0]))return[o,r,n];if(r=(_=V(e,a,r))[1],_[0])return[!0,r,n];if(n=(s=Wr(e,0,n,!0))[2],c=s[1],!(o=s[0]))return[o,r,n];if(0===c)return[!1,r,n];if((i=e-1.000001*a/c)===e)return r.Nkt=e,[!0,r,n];if(f=h(i-e)/(h(e)+h(i)),e=i,f<u)return r.Nkt=e,[!0,r,n]}return[!1,r,n]}function fn(r,n,e,t,u,i){var f,o,a,c,s,_,v,g,e,u;if(1===i){if(a=void 0,n=(c=Wr(f=(r.Akt+r.Tkt)/2,u,n))[2],u=c[1],!(o=c[0]))return[I,r,n,t];if(0===u)return[!0,r=V(f,u,r)[1],n,t];if(0===(a=K(u*u-r.Ikt*r.xkt)))return[I,r,n,t]}else if(2===i){if(_=s=void 0,g=v=0,.1<e)return fn(r,n,e,t,u,i=3);if(e=t%4,t++,0==e)s=r.Akt,v=r.Ikt;else if(2==e)s=r.Tkt,v=r.xkt;else if(n=(c=Wr(s=(r.Akt+r.Tkt)/2,v,n))[2],v=c[1],!(o=c[0]))return[I,r,n,t];if(n=(u=Qr(2,void 0,s,0,_=h(r.Akt-r.Tkt)/1e6,r,n))[3],r=u[2],g=u[1],!(o=u[0])||0===g)return[I,r,n,t];if((f=s-1.01*v/g)<r.Akt&&f<r.Tkt||f>r.Akt&&f>r.Tkt)return[I,r,n,t]}return[!1,r,n,t]}function on(r,n,e,t,u,i,f,o,a,c,s,_,v,g,l,p,T){var M,E,E,A,C,m,d,d,O;switch(i){case 0:t=n.Akt-n.Ikt*((n.Tkt-n.Akt)/(n.xkt-n.Ikt));break;case 1:if(t=(n.Akt+n.Tkt)/2,M=r?f(t,c,u,a):f(_,v,a,t,s,g,l,p,T)-c,N(M)){if(u=M[1],!M[0])return[I,n,e,t,u,i]}else u=M;if(0===u)return[!0,n=V(t,u,n)[1],e,t,u,i];if(0===(E=K(u*u-n.Ikt*n.xkt)))return[I,n,e,t,u,i];t+=(t-n.Akt)*u/E;break;case 3:t=(n.Akt+n.Tkt)/2;break;case 2:if(E=void 0,C=void(A=0),m=0,.1<o)return on(r,n,e,t,u,i=3,f,o,a,c,s,_,v,g,l);if(d=e%4,e++,0==d)E=n.Akt,A=n.Ikt;else if(2==d)E=n.Tkt,A=n.xkt;else if(E=(n.Akt+n.Tkt)/2,M=r?f(E,c,A,a):f(_,v,a,E,s,g,l,p,T)-c,N(M)){if(A=M[1],!M[0])return[I,n,e,t,u,i]}else A=M;if(C=h(n.Akt-n.Tkt)/1e6,n=(d=r?s(1,f,E,0,C,n,c,a):Qr(0,f,E,0,C,n,_,v,a,c,s,g,l,p,T))[2],m=d[1],!d[0]||0===m)return[I,n,e,t,u,i];if((t=E-1.01*A/m)<n.Akt&&t<n.Tkt||t>n.Akt&&t>n.Tkt)return[I,n,e,t,u,i]}return M=r?f(t,c,u,a):f(_,v,a,t,s,g,l,p,T)-c,N(M)&&(u=M[1],!M[0])?[I,n,e,t,u,i]:(O=V(t,u,n))[0]?[!0,n,e,t,u,i]:(o=h(n.Akt-n.Tkt)/(h(n.Akt)+h(n.Tkt)))<n.Bkt?(n.xkt<u&&(u=n.xkt,t=n.Tkt),n.Ikt<u&&(u=n.Ikt,t=n.Akt),n.Nkt=t,[!0,n,e,t,u,i]):[!1,n,e,t,u,i]}function an(r,n,e,t,u){u=u?1:0;var i=C(1+r,n),i;return f(-(i=0===r?e*n+t:t*i+e*(1+r*u)*(i-1)/r))}function cn(r,n){for(var e=0;e<l(n);e++)n[e]!==p&&(r*=1+n[e]);return r}function sn(r,n){for(var e,t,u,i,f,o,e=arguments,t=0,u=1,f=1;f<l(e);f++){if((o=j(e[f],1,!0,!0,!1,!0)).isError)return o[0];for(i=0;i<l(o);i++)o[i]!==p&&(t+=o[i]/C(1+r,u),u++)}return t}function _n(r,n,e,t,u){var n;return u=u?1:0,0===r?f(-(e*n+t)):(n=C(1+r,n),-1===r?T:f(-(t+e*(1+r*u)*(n-1)/r)/n))}function vn(r,n,e,t,u){var n,r,u;return 0<=R(r,n)||(n=_(r,n,u),r=o(r,u),n<=0)||r<=0||(u=1-t*n/r)<=0?S:e/u}function gn(r,n,e){var t=l(n),u,i=0,f;if(t!==l(e))return S;if(n.some(function(r){return r===p}))return Z;for(f=0;f<t;f++)i+=n[f]/C(1+r,(e[f]-e[0])/365);return i}function ln(r,n,e,t,u,i){return Gr(!1,r,n,e,t,u,i)}function pn(r,n,e,t,u,i){return Gr(!0,r,n,e,t,u,i)}function Tn(r,n,e,t,u,i){var f;return e+1<=n||0!==i&&1!==i?S:Fr(t,Dr(r,e,t,u,i),r,n-1)}function Mn(r,n,e,t){return f(t*r*(n/e-1))}function En(r,n,e,t,u){u=u?1:0;var i=C(1+r,n),i;return f(-(i=0===r?(e+t)/n:(e*i+t)/((1+r*u)*(i-1)/r)))}function An(r,n,e,t,u,i){var e,u;return i=i?1:0,e+1<=n||(e=Dr(r,e,t,u,i),v(e))||(u=Fr(t,e,r,n-1),v(u))?S:e-u}function Cn(r,n,e,t){return Hr(Pr,r,n,e,t)}function mn(r,n,e,t){return Hr(b,r,n,e,t)}function dn(r,n,e,t){return Hr(wr,r,n,e,t)}function On(r,n,e){return w(A(r,n,e,!0))}function In(r,n,e){return Hr(On,r,n,e)}function Nn(r,n,e){return Hr(br,r,n,e)}function yn(r,n,e){return w(A(r,n,e,!1))}function hn(r,n,e){return Hr(yn,r,n,e)}function Sn(r){var n;return M(r.getFullYear(),r.getMonth())===r.getDate()}function Rn(r,n,e,t,u,i){var f,o,n,a,c,s,_,v,g,l,p,T;if(y(u,[1,2,4])<0||0<R(r,n))return S;for(f=br(r,n,u),o=b(r,n,u,i),n=A(r,n,u,!1),a=d(n,r,i),0===i&&31===r.getDate()&&1===n.getMonth()&&Sn(n)&&a++,g=(v=100/(_=C(1+t/u,f-1+(s=(c=o-a)/o))))*(f-1+s),l=0;l<f;l++)v+=T=100*e/(u*C(1+t/u,p=l+s)),g+=T*p;return g/v/u}function Dn(r,n,e,t,u){return t<0||e<0?S:jr(!0,r,n,e,t,u)}function Pn(r,n,e,t,u){return u=u?1:0,0===r?0===n?T:f(-(e+t)/n):f(Y((n*(1+r*u)-t*r)/(e*r+n*(1+r*u)))/Y(1+r))}function wn(r,n,e,t,u,i,f){var o,a,c,s,_,v,g,s,l,p,a;if(y(i,[1,2,4])<0||0<R(r,n))return S;if((o=br(r,n,i))<=1)return a=Pr(r,n,i,f),c=wr(r,n,i,f),(v=u/100+e/i-(t/100+a/(s=b(r,n,i,f))*e/i))/(g=t/100+a/s*e/i)*(_=i*s/c);if(p=(a=rn(!(p={Okt:0,Rkt:1e3,Bkt:1e-10,Ckt:!(l=.1),Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0}),Lr,p,l,r,n,e,t,u,i,f))[1],!(s=a[0])){for(l=1e-10;l<p.Rkt;l*=2)p=zr(!1,Lr,p,l,r,n,e,t,u,i,f)[1];p=(a=Jr(!1,!1,p,r,n,e,t,u,i,f))[1],s=a[0]}return s?p.Nkt:S}function bn(r,n,e,t,u){return 0<=R(r,n)?S:(t/e-1)/rr(r,n,u)}function Vn(r,n,e,t,u,i){var f,o,a,c;return 0<=R(r,n)?S:(c=1+(f=rr(e,n,i))*t,c/=u/100+(o=rr(e,r,i))*t,c--,c/rr(r,n,i))}function Ln(r,n,e,t,u,i,f){function o(r,n,e,t,u,i,f){var o,a,c,s,a,a,_,a=1/i,a=a<3?1:a<5?1.5:a<=6?2:2.5;if(i*=a,a=rr(n,e,f),v(a))return 0;for(s=(r-=c=W(a*i*r+.5))-t,o=0;o<u;o++){if((s-=c=W(i*r+.5))<0)return 0==(_=u-o)||1==_?W(.5*r+.5):0;r-=c}return c}var a=1/i;return 0<a&&a<1||1<a&&a<2||2<a&&a<3||4<a&&a<5||0<R(n,e)?S:o(r,n,e,t,u,i,f)}function xn(r,n,e,t,u,i,f){function o(r,n,e,t,u,i,f){var o,a,n,e,f,t,c,o=r*i,a=r-t,n=rr(n,e,f);return v(n)?0:(t=H(f=(r-t-(e=n*i*r))/o),0===u?e:u<=t?o*(f<1?f:1):u===t+1?a-o*t-e:0)}return 0<R(n,e)?S:o(r,n,e,t,u,i,f)}function kn(r,n,e,t,u,i,f,o,a){var c,s,_,v,c=.1;if(y(o,[1,2,4])<0||0<R(e,r)||0<R(r,t)||0<R(t,n))return S;if(s=(_=rn(!(s={Okt:0,Rkt:1e3,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0}),xr,s,c,r,n,u,i,f,o,a,e,t))[1],v=_[0]){for(c=1e-10;c<s.Rkt;c*=2)s=zr(!1,xr,s,c,r,n,u,i,f,o,a,e,t)[1];s=(_=$r(!1,s,r,n,e,t,u,i,f,o,a))[1],v=_[0]}return v?s.Nkt:S}function Un(r,n,e,t,u,i,f,o){return Xr(!1,r,n,e,t,i,f,o,u)}function Bn(r,n,e,t,u,i,f,o){return Xr(!0,r,n,e,t,i,f,o,u)}function Gn(r,n,e){var t,u,r,t=w(n)-w(r);return 0<=R(r,n)||365<t?S:0==(r=360-e*t)?T:r<0?S:f((u=365*e)/r)}function Fn(r,n,e){var t=w(n)-w(r);return 0<=R(r,n)||365<t?S:(100-e)/e*(360/t)}function Hn(r,n){var e,t,u,i,f,o,a,c,s,n,e=l(r),t=[],u=!1,i=!1,f={Okt:-1,Rkt:9999999,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0};for(1<h(n)&&(n=.1),o=-1,c=a=0;c<e;c++)(s=r[c])!==p&&(0!==s&&(a=t.length+1,-1===o)&&(o=t.length),t.push(s),0<s&&(u=!0),s<0)&&(i=!0);return t=t.slice(o,a+1),u&&i&&!(l(t)<2)&&(f=(n=nn(f,t,n))[1],n[0])?f.Nkt:S}function jn(r,n,e){var t,u,i,f,o,a,c,s,_,v,g,t=0,u=0,i=0,f=0,o=0,a=[],c=l(r);if(c<2)return T;for(s=0;s<c;s++)(_=r[s])!==p&&(a.push(_),i++,0!==_)&&(0<_?t++:u++);if(u<1||t<1)return T;for(v=0;v<i;v++)0!==(g=a[v])&&(0<g?f+=g/C(1+e,v):o+=g/C(1+n,v));return 0===o||0===f||e<=-1?T:C(-f*C(1+e,i)/(o*(1+e)),1/(i-1))-1}function Xn(r,n,e,t){for(var u,i,f,o,a,u=.5,i=e-.5,f=e+.5,o=0,a=0;0<L(i,r,0,n)[1]*L(f,r,0,n)[1]&&o<t;)o++,i-=.5,f+=.5;return t<=o?[0,0]:[i,f]}function Yn(r,n,e,t){for(var u,i,t,f,o,a,c,s,_,v,u=100,i=t.Bkt,t=t.Skt&&t.Ckt?[t.Akt,t.Tkt]:Xn(r,n,e,u),f=t[0],o=t[1],a=L(f,r,0,n)[1],c=L(o,r,0,n)[1],s=0,_=0;_<u&&!(0<a*c);_++)if((v=L(s=(f+o)/2,r,0,n)[1])*a<0?(o=s,c=v):(f=s,a=v),h(f-o)<i)return[!0,s];return[!1,s]}function Kn(r,n,e){var t,u,i,f,o,a,c,s,_,v,v,v,t=l(r),u;if(t!==l(n))return S;if(1===t)return g.Errors.NotAvailable;for(o=t-1;0<=o;o--)i=0<r[o]||i,f=r[o]<0||f,n[o]===p&&(0!==r[o]?n[o]=0:(r.splice(o,1),n.splice(o,1)));if(!i||!f)return S;for(a=!0,c=r[0],t=l(r),o=1;o<t;o++)a=a&&n[o-1]===n[o],c+=r[1];return 0===c?er:a?S:0===(s=r[0])?0===e?tr:er:(_=(v=rn(!0,Qr,_={Okt:-1,Rkt:1e10,Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0},e,r,n))[1],v[0]?(v=_.Nkt,Math.abs(v)<_.Bkt?er:v):(v=Yn(r,n,e,_))[0]?v[1]:S)}function Wn(r,n,e,t,u,i){var f,o,a,c,f,s;if(u=u?1:0,f=C(17976931348623157e282,1/r),a=(c=un(o={Bkt:1e-10,Ckt:!1,Akt:0,Ikt:0,Skt:!1,Tkt:0,xkt:0,Nkt:0,Okt:Q(-1e10,1-f),Rkt:z(1e10,f-1)},a={Dkt:r,_kt:n,_pv:e,_fv:t,uit:u},i))[2],o=c[1],!(f=c[0])){for(s=2;(!o.Skt||!o.Ckt)&&s<100;s*=2)a=(c=qr(o,i*s,a))[2],a=(c=qr(o=c[1],i/s,a))[2],o=c[1];o=(c=Jr(!0,!1,o,a))[1],f=c[0]}return f?o.Nkt:S}function Qn(r,n,e,t,u){var u,e,r,u=u/e,e=1<=u?(u=1)===t?r:0:r*C(1-u,t-1),r=r*C(1-u,t),u=e-(r<n?n:r);return u<0?0:u}function zn(r,n,e,t,u,i){for(var f,o,a,c,s,_,v,g,l,f=0,o=0,a=m(u),c=a,s=r-n,_=!1,l=1;l<=c;l++)_?g=o:(v=Qn(r,n,e,l,i))<(o=s/(t-(l-1)))?(g=o,_=!0):s-=g=v,l===c&&(g*=u+1-a),f+=g;return f}function Zn(r,n,e,t,u,i,f){var o,a,c,s,_,v,g,f,l,o=W(t),a=o,c=m(u),s=c,_=0;if(f)for(v=a+1;v<=s;v++)g=Qn(r,n,e,v,i),v===a+1?g*=z(u,o+1)-t:v===s&&(g*=u+1-c),_+=g;else f=e,l=void 0,t!==W(t)&&1<i&&e/2<=t&&(l=t-e/2,t=e/2,u-=l,f+=1),r-=zn(r,n,e,f,t,i),_=zn(r,n,e,e-t,u-t,i);return _}function qn(r,n,e,t,u,i,f){return u<t||e<t||e<u?S:r<n&&0===t&&1===u?r-n:Zn(r,n,e,t,u,i,f)}function Jn(r,n,e,t,u,i,f){var o,a,c,s,_,v,g,l,p,T,M,E,A,C,m,d,O,I,N;if(y(i,[1,2,4])<0||0<=R(r,e))return S;if(1===i||0===f||4===f)return $n(r,n,e,t,u,i,f);for(o=r.getFullYear(),a=r.getMonth(),c=r.getDate(),s=e.getFullYear(),_=e.getMonth(),v=e.getDate(),g=n.getMonth(),l=n.getDate(),p=[],T=[],M=[],E=[31,28,31,30,31,30,31,31,30,31,30,31],A=0;A<i;A++)p[A]=(g+12*A/i)%12,T[A]=l<=E[p[A]]?l:E[p[A]],2===f?M[A]=360/i:3===f&&(M[A]=365/i);for(A=0;A<i;A++)m=p[A]<p[C=A===i-1?0:A+1]?2001:2002,M[A]=w(new Date(m,p[C],T[C]))-w(new Date(2001,p[A],T[A]));for(d=0,O=w(e);o<s||o===s&&a<_||o===s&&a===_&&c<v;){for(A=0;A<i&&(a<p[A]||a===p[A]&&c<T[A])&&(0===A||p[A-1]<p[A]);)A++;for(;A<i&&(p[A]<a||a===p[A]&&T[A]<=c)&&(a!==p[++A-1]||c!==T[A-1]););C=--A===i-1?0:A+1,m=12<=a+12/i?o+1:o,I=w(new Date(o,a,c)),d+=u*t/i*((N=Math.min(w(new Date(m,p[C],T[C])),O))-I)/M[A],o=m,a=p[C],c=T[C]}return d}function $n(r,n,e,t,u,i,f){var e=_(r,e,f),r=o(r,f);return e<0||r<=0?S:u*t*(e/r)}function r1(r,n,e,t,u){var n,r;return 0<R(r,n)||(n=_(r,n,u),r=o(r,u),n<0)||r<=0?S:t*e*n/r}function n1(r,n,e,t,u){var i,r;return 0<=R(r,n)||(i=o(r,u),(r=_(r,n,u))<=0)||i<=0?S:(t-e)/t*(i/r)}function e1(r,n){return C(1+r/n,n)-1}function t1(r,n,e,t,u){var n,r;return 0<=R(r,n)||(n=_(r,n,u),r=o(r,u),n<=0)||r<=0?S:(t-e)/e*(r/n)}function u1(r,n){return n*(C(1+r,1/n)-1)}function i1(r,n,e,t,u){var i,f,o,a,c,i;if(e+(u<12?1:0)<t)return S;if(0===r)return 0;for(f=J(1-C(n/r,1/e),3),a=o=0,c=1;c<=t;c++)o+=a=1===c?r*f*u/12:c===e+1?(r-o)*f*(12-u)/12:(r-o)*f;return a}function f1(r,n,e,t,u){var i,f,o,i=0,f=0;if(e<t)return S;if(r<=n)return 0;for(o=1;o<=t;o++)i+=f=z(f=u/e*(r-i),r-i-n);return f}function o1(r,n,e){return(r-n)/e}function a1(r,n,e,t){return e<t?S:(r-n)*(e-t+1)*2/(e*(e+1))}function c1(r,n){return n<1?T:Yr(!0,r,n)}function s1(r,n){return 0===n?T:Yr(!1,r,n)}function _1(r,n,e,t,u,i,f){return y(i,[1,2,4])<0||0<R(r,n)?S:Lr(r,n,e,t,u,i,f)}function v1(r,n,e,t,u){var n,r;return 0<=R(r,n)||(n=_(r,n,u),r=o(r,u),n<=0)||r<=0?S:t-e*t*n/r}function g1(r,n,e,t,u,i){var f,n,e,r,i;return 0<=R(r,n)||(f=_(r,n,i),n=_(e,n,i),e=_(e,r,i),r=o(r,i),e<=0)||r<=0||f<=0||n<=0||0==(i=1+f/r*u)?S:(100+n/r*t*100)/i-e/r*t*100}function l1(r,n,e,t,u,i,f,o,a){return y(o,[1,2,4])<0||0<R(e,r)||0<R(r,t)||0<R(t,n)?S:xr(r,n,u,i,f,o,a,e,t)}function p1(r,n,e){var t=w(n)-w(r);return 0<=R(r,n)||365<t?S:100*(1-e*t/360)}function T1(r){var r=kr(r,2);return 0<=r?r:S}function M1(r,n,e,t,u){var i,u,n,e;function f(r){var r,n,r=r.substr(0,3),n;return 0<=y(r,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])?0:2}function o(r){var r,n,r=r.substr(0,3),n;return 0<=y(r,["BEF","LUF","ESP","ITL","LUX"])?0:2}return i=0,t||(i=o(e)),u.ekt||(u.y4=f(n)),n=kr(n,u.y4),e=kr(e,u.y4),0<=n&&0<=e?(u=r*e/n,t?u:J(u,i)):Z}function E1(r,n,e,t){var u,i,f;return(""!==r||""!==n||""!==e)&&(r=nr(r,u={value:0}),n=nr(n,i={value:0}),e=nr(e,f={value:0}),!0===r)&&!0===n&&!0===e?t(u,i,f):Z}function A1(r,n,e){return E1(r,n,e,function(r,n,e){var e,n;return 0<n.value&&0<r.value&&0<e.value?(e=(Math.log(e.value)-Math.log(n.value))/Math.log(1+r.value),(n=Math.abs(e))<=179769e303?22250738585072014e-324<=n?e:0:T):S})}function C1(t,r,n){return E1(t,r,n,function(r,n,e){if(0<n.value&&0<r.value&&0<=e.value){t=Math.pow(e.value/n.value,1/r.value)-1;var e=Math.abs(t);if(e<=179769e303)return 22250738585072014e-324<=e?t:0}return S})}Object.defineProperty(r,"__esModule",{value:!0}),k=n("Common"),g=n("CalcEngine"),U=k.Common.lt.tv,B=isFinite,G=parseInt,r=k.Common.lt,y=r.Rh,N=r.Nh,F=r.ht,l=k.Common.Uf.tR,H=g.Convert.z6t,v=g.Convert.BJ,f=g.Convert.L6t,j=g.Convert.iV,X=g.Convert.uJ,p=g.Convert.CalcConvertedError,I=null,E=void 0,C=Math.pow,h=Math.abs,m=Math.ceil,Y=Math.log,K=Math.sqrt,W=Math.floor,Q=Math.max,z=Math.min,T=g.Errors.DivideByZero,Z=g.Errors.Value,S=g.Errors.Number,n=g.Functions.F6t,q=g.Functions.MathHelper,J=q.Lkt,$=g.Functions.B6t,o=g.Functions.Fkt,M=g.Functions.Pkt,R=g.Functions.Gkt,d=g.Functions.Ukt,rr=g.Functions.Hkt,nr=g.Convert.sJ,er=2.98023223876953e-9,tr=4.88281e-9,r={J6t:0,pkt:"< 1"},i={J6t:0,pkt:"< 0"},ur={bkt:.1,J6t:0},ir={bkt:2,J6t:0},fr={bkt:1e3,J6t:0,pkt:"<= 0"},ar={bkt:!(or={J6t:5}),J6t:7},_r={bkt:0,J6t:2},gr={J6t:2,pkt:"= 0",zkt:T},pr={J6t:4,X6t:1,Vkt:!0,Ykt:!0},Tr={J6t:4,X6t:1,Vkt:!0,Zkt:!0,Ykt:!0},Mr={J6t:4,X6t:4,Vkt:!0,Ykt:!0,Zkt:!0,breakOnConvertError:!0},Er={J6t:4,X6t:1,Vkt:!0,Ykt:!0,breakOnConvertError:!0},Ar={J6t:4,X6t:11,Vkt:!0,Ykt:!0,breakOnConvertError:!0},Cr=[a={J6t:6},a,c={J6t:2},s={bkt:0,J6t:2,pkt:["< 0","> 4"]}],mr=[a,a,e={J6t:0},e,c,s],dr=[a,a,u={J6t:0,pkt:"<= 0"}],Or=[e,a,a,e,c,u,vr={bkt:0,J6t:2,pkt:["< 0","> 4","= 2"]}],Nr=[a,a,u,u,s],yr=[u,cr={J6t:2,pkt:"<= 0"},u,sr={J6t:2,pkt:"< 1"},c,c],hr=[u,sr],Sr=[e,lr={J6t:2,pkt:"< 0"}],n("FV",an,3,5,Ir=[e,e,e,t={bkt:0,J6t:0},t],E,E,{wkt:[3,4]}),n("FVSCHEDULE",cn,2,2,[e,pr],1,1),n("NPV",sn,2,E,e,"> 0","> 0"),n("PV",_n,3,5,Ir,E,E,{wkt:[3,4]}),n("RECEIVED",vn,4,5,Nr,E,E,{wkt:3}),n("XNPV",gn,3,3,[e,Er,Er],"!= 0","!= 0"),n("CUMIPMT",ln,6,6,yr),n("CUMPRINC",pn,6,6,yr),n("IPMT",Tn,4,6,[e,r,r,e,t,_r],E,E,{wkt:[4,5]}),n("ISPMT",Mn,4,4,[e,c,gr,e]),n("PMT",En,3,5,[e,{J6t:0,pkt:"= 0",zkt:T},e,t,t],E,E,{wkt:[3,4]}),n("PPMT",An,4,6,[e,r,e,e,t,t],E,E,{wkt:[4,5]}),n("COUPDAYBS",Cn,3,4,Cr,E,E,{wkt:3}),n("COUPDAYS",mn,3,4,Cr,E,E,{wkt:3}),n("COUPDAYSNC",dn,3,4,Cr,E,E,{wkt:3}),n("COUPNCD",In,3,4,Cr,E,E,{wkt:3}),n("COUPNUM",Nn,3,4,Cr,E,E,{wkt:3}),n("COUPPCD",hn,3,4,Cr,E,E,{wkt:3}),n("DURATION",Rn,5,6,mr,E,E,{wkt:5}),n("MDURATION",Dn,5,6,mr,E,E,{wkt:5}),n("NPER",Pn,3,5,[{J6t:0,pkt:"<= -1"},e,e,t,t],E,E,{wkt:[3,4]}),n("YIELD",wn,6,7,[a,a,i,u,u,c,s],E,E,{wkt:6}),n("YIELDDISC",bn,4,5,[a,a,u,u,s],E,E,{wkt:3}),n("YIELDMAT",Vn,5,6,[a,a,a,i,u,s],E,E,{wkt:5}),n("AMORDEGRC",Ln,6,7,Or,E,E,{wkt:6}),n("AMORLINC",xn,6,7,Or,E,E,{wkt:6}),n("ODDFYIELD",kn,8,9,[a,a,a,a,i,u,u,c,s],E,E,{wkt:8}),n("ODDLYIELD",Un,7,8,[a,a,a,i,u,u,e,s],E,E,{wkt:7}),n("ODDLPRICE",Bn,7,8,[a,a,a,i,i,u,c,s],E,E,{wkt:7}),n("TBILLEQ",Gn,3,3,dr),n("TBILLYIELD",Fn,3,3,dr),n("IRR",Hn,1,2,[Tr,ur],0,0,{wkt:1}),n("MIRR",jn,3,3,[Tr,e,e],0,0),n("XIRR",Kn,2,3,[Ar,Mr,ur],"!= 2","!= 2",{wkt:2}),n("RATE",Wn,3,6,[u,e,e,t,{bkt:0,J6t:2,pkt:"< 0",zkt:Z},ur],E,E,{wkt:[3,4,5]}),n("VDB",qn,5,7,[i,i,lr,i,i,ir,ar],E,E,{wkt:[5,6]}),n("ACCRINT",Jn,6,8,[a,a,a,u,fr,c,s],E,E,{wkt:[4,6,7]}),n("ACCRINTM",r1,3,5,[a,a,u,fr,s],E,E,{wkt:[3,4]}),n("DISC",n1,4,5,[a,a,u,u,s],E,E,{wkt:3}),n("EFFECT",e1,2,2,hr),n("INTRATE",t1,4,5,Nr,E,E,{wkt:3}),n("NOMINAL",u1,2,2,hr),n("DB",i1,4,5,[i,e,sr,sr,{bkt:12,J6t:2,pkt:["< 1","> 12"]}],E,E,{wkt:3}),n("DDB",f1,4,5,[i,e,cr,cr,{bkt:2,J6t:0,pkt:"<= 0"}],E,E,{wkt:3}),n("SLN",o1,3,3,[e,e,gr]),n("SYD",a1,4,4,[e,i,sr,cr]),n("DOLLARDE",c1,2,2,Sr),n("DOLLARFR",s1,2,2,Sr),n("PRICE",_1,6,7,[a,a,i,i,u,c,s],E,E,{wkt:6}),n("PRICEDISC",v1,4,5,Nr,E,E,{wkt:3}),n("PRICEMAT",g1,5,6,[a,a,a,i,i,s],E,E,{wkt:5}),n("ODDFPRICE",l1,8,9,[a,a,a,a,i,i,u,c,s],E,E,{wkt:8}),n("TBILLPRICE",p1,3,3,[a,a,u]),n("EURO",T1,1,1,or),n("EUROCONVERT",M1,3,5,[e,or,or,ar,{ykt:!0,J6t:2,bkt:3,pkt:"< 3",zkt:Z}],E,E,{wkt:[3,4]}),n("PDURATION",A1,3,3),n("RRI",C1,3,3)},"./src/functions-lookup.ts":function(E,r,n){var e,u,y,A,C,m,k,r,g,U,d,B,O,G,l,h,I,N,i,F,S,R,H,D,P,j,M,X,Y,o,n,f,w,K,W,Q,z,a,Z,c,q,J,$,rr,nr,r,t,e,er,s,tr,ur,ir,_,v,fr,or,ar;function cr(r,n,e){return r&&1===n&&1===e&&null===r[0][0]}function sr(r){return S(r)||R(r)||Array.isArray(r)}function _r(r,n,e,t){return{row:r,col:n,rowCount:e,colCount:t}}function b(r,n,e){var t,u;return d(r)?A:r.isArray||r.isReference?((t=r.colCount)<n&&(u=n,n=e,e=u),r[e*t+n]):r[0]}function V(r,n,e,t){return e&&(null===r||null===n)||!d(n)&&((d(r)||i(r,!0))&&i(n,!0)||f(r)&&f(n)||t&&(w(r)&&i(n)||w(n)&&i(r))||w(r)&&w(n))}function vr(r,n,e,t,u){if(r<0||n<0||n<r||e<r||n<e)return-1;if(u)Q=r,z=n,Z=a=e,q=c=t;else if(c){if(z<++a){if(c!==q)return-1;a=Z-1,c=!1}}else if(--a<Q){if(c!==q)return-1;a=Z+1,c=!0}return a}function gr(r,n,e){var r=U(r),e=e;return r===n?e=0:n<r?e=1:r<n&&(e=2),e}function L(r,n,e){var e,e,r;return r===n?0:w(r)?n||0!==O(r)?i(n)&&!i(r)?1:f(n)?2:w(n)?((e=(0,y.Wkt)(r,n,e))<0?e=2:0<e&&(e=1),e):n instanceof Date?gr(r,n,1):-1:0:w(n)?r||0!==O(n)?i(r)?2:f(r)?1:r instanceof Date?gr(r,n,2):-1:0:f(r)&&i(n)?1:f(n)&&i(r)?2:(e=F(r),r=F(n),(e=g(e,15))===(r=g(r,15))?0:e<r?2:1)}function p(r,n,e){var r=b(r,n,e);return d(r)?0:r}function T(r,n,e,t){var u,i,f,o,a,c,s,_,v,u=-1,f=0,o=-1,a=-1,i=t?n.rowCount:n.colCount;if(--i<f)return-1;for(;f<=i;){for(c=A,s=void 0,_=r[0],1<=e!=(2===u)&&(o=a),s=a=vr(f,i,a=I((f+i)/2),0<=e,!0);!V(_,c)&&-1!==a&&!V(_,c=t?b(n,0,a):b(n,a,0));)a=vr(0,0,0,!1,!1),0<=e&&a<s?i=a:e<0&&s<a&&(f=a);if(-1===a&&1<=e!=(2===u))return o;if(-1===a)return-1;if(u=L(_,c,!1),1<=e&&1===u)f=a+1;else if(1<=e&&2===u)i=a-1;else if(e<=-1&&1===u)i=a-1;else if(e<=-1&&2===u)f=a+1;else if(0===u){for(;e<=-1&&f<a||0<=e&&a<i;){if(v=(v=0)<=e?a+1:a-1,null===(c=t?p(n,0,v):p(n,v,0)))return-1;if(!V(_,c))break;if(0!==(u=L(_,c,!1)))break;a=v}return a}}return 1<=e!=(2===u)?a:o}function lr(r,n,e){var t,u,n,r,i,f,o,a,r,c,s,_,v,t=n,u=r[0],n=w(u);if(u===A&&(u=0),i=t["_mc"+(r=e?n?"0":"1":n?"2":"3")]=t["_mc"+r]||(0,y.createMap)(),n&&(u=u.toLowerCase()),f=i.get(u),d(f)){if(f=-1,o=e?t.rowCount:t.colCount,a=e?t.colCount:1,r=m.tbt(u)){for(c=m.OJ(r),s=0;s<o;s++)if(c.lastIndex=0,c.test(t[s*a])){f=s;break}}else if(n)if(0===i.size){for(s=0;s<o;s++)if((_=t[s*a])===u||_&&_.toLowerCase&&_.toLowerCase()===u){f=s;break}}else{for(s=i.lp||0;s<o;s++){if((_=(_=t[s*a])&&_.toLowerCase&&_.toLowerCase())===u){f=s;break}i.has(_)||i.set(_,s)}i.lp=s}else for(u instanceof Date&&(u=l(u)),v=g(u,15),s=0;s<o;s++)if((_=(_=t[s*a])instanceof Date?l(_):_)===u||g(_,15)===v){f=s;break}i.set(u,f)}return f}function pr(r,n,e,t,u,i,f,o){var a,c,s,_,v,g,l,p,T,M,E,c,a=A,v=-1,p=r[0],T=w(p),M=!o&&m.tbt(p),s=t?n.rowCount:n.colCount;for(T&&M&&(g=m.OJ(M)),_=0;_<s;_++)if(E=u?s-1-_:_,V(p,l=t?b(n,0,E):b(n,E,0),i,f))if(c=w(l),c=T&&c&&M?(g.lastIndex=0,g.test(l)?0:1):L(p,l,!1),1<=e&&1===c)c=-1,0<=v&&(c=L(l,a,!1)),(v<0||0<=v&&1===c)&&(v=E,a=l);else if(e<=-1&&2===c)c=-1,0<=v&&(c=L(l,a,!1)),(v<0||0<=v&&2===c)&&(v=E,a=l);else if(0===c)return E;return v}function Tr(r,n){var e,t,u,i,f;if(!n)for(e=O(r),t=void 0,t=1;t<e;t++)if(2===(f=L(u=r[t-1],i=r[t],!1)))return;return 1}function Mr(r,n,e,t,u,i){var r,f,r=or.call(this,r,[_r(n,e,t,u)])||this;return r.getValue=function(r,n,e){var t=this,u=t.uit,u,u=0===u?t.getRow(0)+1+n:1===u?t.getColumn(0)+1+e:J.getValue.call(t,r,n,e);return u},(f=r).Ky=n,f.yft=e,f.Sx=t,f.Cyt=u,f.uit=i,r}function Er(r){var n=ar.call(this,C)||this;return n.Kkt=r,n}function Ar(r,n,e){var t,u,i,f,o,a,c,s,_;if(!r)return D;if(t=n!==C,u=r.row+(r.arrayFormulaMode&&r.arrayIdentity&&r.rowOffset||0),i=r.column+(r.arrayFormulaMode&&r.arrayIdentity&&r.columnOffset||0),r.source.getBaseRowCol&&(f=r.source.getBaseRowCol())&&(u=f.row,i=f.col),!(n=t?n:r.getReference(r.source,_r(u,i,r.rowCount,r.columnCount)))||1!==n.getRangeCount())return D;if(c=[],e){if(s=n.getRow(0)+1,1<(a=n.getRowCount(0))){for(o=0;o<a;o++)c.push([s+o]);return new y.CalcArray(c)}return s}if(_=n.getColumn(0)+1,1<(a=n.getColumnCount(0))){for(o=0;o<a;o++)c.push(_+o);return new y.CalcArray([c])}return _}function Cr(r,n,e,t,u,i){var f,o,a,f,c,a,o,u;return r&&e instanceof y.CalcReference?(c=r.source&&r.source.Lbt.dynamicReferences,a=e.getRowCount(0),f=e.getColumnCount(0),o=e.create([{row:e.getRow(0),col:e.getColumn(0),rowCount:i?a:1,colCount:i?1:f}]),c&&Ur(r,e,o.getRow(0),o.getColumn(0),o.getRowCount(0),o.getColumnCount(0),i&&e.$gt[0].rowUndefine,!i&&e.$gt[0].colUndefine)):(e instanceof y.CalcArray?(a=e.getRowCount(),f=e.getColumnCount()):Array.isArray(e)&&(a=e.rowCount,f=e.colCount),o=e),i&&f<t||!i&&a<t||(o.Zbt=!0,(f=y.Convert.iV(o,0,!0,!1,!1)).isError)||f.isConvertError?P:0<=(a=u||u===C?T(n,f,1,i):lr(n,f,i))?r&&e instanceof y.CalcReference?(o=i?a:t-1,u=i?t-1:a,c&&Ur(r,e,e.getRow(0)+o,e.getColumn(0)+u,1,1),e.getValue(0,o,u)):i?p(f,t-1,a):p(f,a,t-1):M}function mr(r,n){return Ar(r,n,!0)}function dr(r,n){return Ar(r,n,!1)}function Or(r){return sr(r)?y.CalcArrayHelper.getRowCount(r):1}function Ir(r){return sr(r)?y.CalcArrayHelper.getColumnCount(r):1}function Nr(r){return R(r)||S(r)?new rr(r):r}function yr(r,n,e,t,u){return Cr(r,n,e,t,u,!1)}function hr(r,n,e,t,u){return Cr(r,n,e,t,u,!0)}function Sr(r,n,e,t,u,i){var f,o,a,c,s,_,v,g,l,p,T,o,f,r,n,u,i,f=n.rowCount,o=n.colCount,a=1===f&&1===o,c=e.getRowCount(),s=e.getColumnCount(),_=1===f&&1<=o,v=1===c&&1<=s;if(a){if(1<c&&1<s)return D}else if(_&&o!==s||!_&&f!==c)return D;if((g=wr(r,n,u,i))===M)return null!=t?t:M;if(g===D)return D;if(0<g){if(a)return e;if(g-=1,l=[],y.Convert.Nh(e)){if(_)for(p=0;p<c;p++)T=e.getValue(0,g),l.push([T]);else o=v?[e.getValue(0,g)]:[e.getValue(g,0)],l.push(o);return new y.CalcArray(l)}return e instanceof y.CalcReference?(r=(f=e).getRow(),n=f.getColumn(),u=c,i=s,_?(n=f.getColumn()+g,i=1):(r=f.getRow()+g,u=1),f.create([{row:r,col:n,rowCount:u,colCount:i}])):void 0}}function Rr(r,n,e){var t,u,i,f,o,a,r,f,t=[];if(n)for(u=0;u<n.length;u++)t.push(n[u]);if(n.colCount<=n.rowCount?(t.colCount=n.colCount,t.rowCount=Math.ceil(t.length/t.colCount)):(t.rowCount=n.rowCount,t.colCount=Math.ceil(t.length/t.rowCount)),d(n.isReference)||(t.isReference=n.isReference),d(n.isArray)||(t.isArray=n.isArray),t.rangeCount=n.rangeCount,i=-1,o=t.colCount,a=t.rowCount,r=r,e===C)return f=a<o?yr(C,r,t,a,!0):hr(C,r,t,o,!0),h(f)?M:f;if(f=y.Convert.iV(e,0,!0,!1,!1)){if(1<f.colCount&&1<f.rowCount)return M}else f=t;return 0<=(i=T(r,t,1,o<=a))?(o=f.colCount,(a=f.rowCount)<o?p(f,i,a-1):p(f,o-1,i)):M}function Dr(r){var n=arguments;return r<1||O(n)<=r?D:d(n[r])?0:n[r]}function Pr(r,n,e){var r,n,t,u,i,r=r,n=n;return!n.isArray&&!n.isReference||(t=n.colCount,u=n.rowCount,i=-1,1<t&&1<u)||1===e&&!Tr(n,!0)||-1===e&&!Tr(n,!1)||(e===C?e=1:e===A&&(e=0),1===e?i=T(r,n,1,1<u):0===e?i=lr(r,n,1<u):-1===e&&(i=T(r,n,-1,1<u)),-1===i)?M:i+1}function wr(r,n,e,t){var n,u,i,f,o,f,o,r,a,c,s,a,u,n=n,u=n.colCount,i=n.rowCount;if(1<u&&1<i)return D;if(2===e&&(2===t||-2===t))return D;if(f=2===t&&!Tr(n,!0),o=-2===t&&!Tr(n,!1),f||o)return M;if(o=(f=r)&&r[0],r=-1,d(e)&&(e=0),-1===(t=!d(t)&&0!==t?t:1)&&(a=!0),0!==e&&2!==e||(c=0),1===t||-1===t){if(1===e)c=-1;else if(-1===e){if(m.jJ(o))return M;c=1}r=pr(f,n,c,1<i,a,!0,!0,0===e)}else if(2===t||-2===t){if(1===u&&1===i){if(!V(o,a=n[s=0]))return M;if(0===(u=L(o,a,!1)))return 1;if(0===e)return 0===u?1:M;if(1===e)return 2===u?1:M;if(-1===e)return 1===u?1:M}r=T(f,n,c=2===t?1:-1,1<i)}return-1!==r&&(0!==e||$r(o,n[r]))?!$r(o,n[r])&&(2===t&&1===e||-2===t&&-1===e)?r+2:r+1:M}function br(r,n,e,t){return r+=n,t?0!==e&&(r=(r+="[")+e.toString()+"]"):r+=e,r}function Vr(r,n,e){return e||(r+="$"),r+=n}function Lr(r,n,e){e||(r+="$");for(var t=r.length;.1<n;n=parseInt(((n-1)/26).toString(),10))r=u.Common.zf.Eit(r,t,String.fromCharCode("A".charCodeAt(0)+(n-1)%26));return r}function xr(r,n){if(n&&0<O(n)){for(var e=void 0,t=!(0,y.Swt)(n[0])&&"_"!==n[0],e=1;!t&&e<O(n);e++)t=!(0,y.Jkt)(n[e])&&"_"!==n[e];t?r=(r+="'")+n.replace("'","''")+"'":r+=n,r+="!"}return r}function kr(r,n,e,t,u){var i,f,o,i=3===e||4===e||7===e||8===e,f=2===e||4===e||6===e||8===e,o="";return r<1&&(t||!i)||K<r||n<1&&(t||!f)||W<n||e<1||8<e?D:(o=xr(o,u),t?Vr(o=Lr(o,n,f),r,i):(o=br(o,"R",r,i),br(o,"C",n,f)))}function Ur(r,n,e,t,u,i,f,o){var r,n,a,c,s,_,a;r&&r.identity&&!r.ITe&&(r=r.Xkt,n=n.getSource(),r)&&n.getRangeKey&&(a=e,c=t,s=u,_=i,f&&(a=s=-1),o&&(c=_=-1),a=n.getRangeKey(n,{id:n.id,row:a,col:c,rowCount:s,colCount:_}),r.qkt||(r.qkt={}),r.qkt[a]={id:n.id,row:e,col:t,rowCount:u,colCount:i,rowUndefine:f,colUndefine:o})}function Br(r,n,e,t,u){var i,f,o,a,c,s,_,v,g,l,p,T,M,c,o;function E(r){return!d(r)&&!r._error}if(o=(f=r)!==(i=A)&&f.acceptsReference,a=f!==A&&f.arrayFormulaMode,!sr(n))return e=e!==C?I(e):0,t=t!==C?I(t):0,e<0||t<0?D:1<e||1<t?P:n;if(n instanceof y.CalcReference){if(c={value:-1},s=n,(u=E(u=u===C?1:u)&&N(u,c)?c.value-1:i)>=s.getRangeCount())return P;if(u===i||u<0)return D;if(_=s.getRowCount(u),v=s.getColumnCount(u),g=s.getRow(u),l=s.getColumn(u),T=p=void 0,3===O(arguments)){if(1!==_&&1!==v)return P;1!==v?(t=e,e=1):1!==_&&(t=1)}if(-1===(e=E(e=d(e)?0:e)&&N(e,c)?c.value-1:i)){if(1!==_&&!o&&!a&&(g>f.row||f.row>=g+_))return D}else{if(e<-1||e===i)return D;if(_<=e&&!n.$gt[0].rowUndefine)return P;p=e+g}if(-1===(t=E(t=d(t)?0:t)&&N(t,c)?c.value-1:i)){if(1!==v&&!o&&!a&&(l>f.column||f.column>=l+v))return D}else{if(t<-1||t===i)return D;if(v<=t&&!n.$gt[0].colUndefine)return P;T=t+l}return-1===e&&-1===t?(p=g,T=l):-1===e?(p=g,v=1):_=-1===t?(T=l,1):v=1,(M=r.source&&r.source.Lbt.dynamicReferences)&&Ur(r,s,p,T,_,v,-1===e&&n.$gt[0].rowUndefine,-1===t&&n.$gt[0].colUndefine),(c=r.WK)&&c.Gue&&c.Gue(p,T,s.rT),s.create([_r(p,T,_,v)])}return y.Convert.Nh(n)?(_=(o=n).getRowCount(),e=e!==C?I(e):-1,t=t!==C?I(t):-1,1!==(u=u!==C?I(u)-1:1)?P:(-1===e&&-1===t?e=t=0:-1===t&&1===_&&(t=e,e=1),e=-1===e?0:e,t=-1===t?0:t,_=o.getRowCount(),v=o.getColumnCount(),e<0||t<0||u<0?D:(_<e&&1===_&&t===C&&(t=e,e=0),_<e||v<t?P:0===e&&0===t?o.slice(0,0,_,v):0===e?o.slice(0,t-1,_,1):0===t?o.slice(e-1,0,1,v):o.getValue(e-1,t-1)))):void 0}function Gr(r,n,e,t,u,i){var f,o,e,t,u;return r?n&&n instanceof y.CalcReference&&1===n.getRangeCount()?(f=u!==C?I(u):n.getRowCount(0),o=i!==C?I(i):n.getColumnCount(0),e=n.getRow(0)+e,t=n.getColumn(0)+t,f<0&&(e+=f+1,f=Math.abs(f)),o<0&&(t+=o+1,o=Math.abs(o)),Ur(r,n,e,t,f,o,d(u)&&n.$gt[0].rowUndefine,d(i)&&n.$gt[0].colUndefine),0===f||0===o||e<0||t<0?P:((u=r.WK)&&u.Gue&&u.Gue(e,t,n.rT),n.create([{row:e,col:t,rowCount:f,colCount:o}]))):D:M}function Fr(r,n,e){var t,u,i,f,o,a,c,s,i,e,o,f,a;return r?!n||"!"===n[0]||(i={row:t=r.row,col:u=r.column},f=(f=r.parser)||(r.parser=new y.Parser),(a=(o=r.source).parserContext)?(a.useR1C1=!e,a.row=i.row||0,a.column=i.col||0,a.baseIdentity=i,a.source=r.source):(o.parserContext=a=r.source?r.source.getParserContext(!e,i):new y.ParserContext(r.source,!e,i),a.onlyValidateSourceNameWithSpecial=!0),e?c=f.parse(a,n):(c=(i=(i=o.expressions)||(o.expressions={}))[n])||(c=f.parse(a,n),i[n]=c),!c)||(e=!1,7===c.type&&"ANCHORARRAY"===c.functionName&&(c=c.arguments[0],e=!0),!(c=8===c.type?c.source?(s=c.source).getCustomName(c.value):r.getName(c.value):c))||k.Rh(c.type,[1,13])<0||c.source instanceof y.ErrorSource?P:(s=c.source||r.source,25===c.type||26===c.type?s.getValueByName(c.nameIdentity):(o=c.getRange(t,u),f=null,f=(s=13===c.type?c.source:s).getReference(o),Ur(r,f=e?f.getSpillRef():f,f.getRow(0),f.getColumn(0),f.getRowCount(0),f.getColumnCount(0),f.$gt[0].rowUndefine,f.$gt[0].colUndefine),(a=r.WK)&&a.Gue&&a.Gue(c),f)):M}function Hr(r,n){var n,e="__hyperlink__",n=2===arguments.length?new String(H(n)):new String(H(r));return n[e]=H(r),n}function jr(){for(var r,n=0,r=0;r<O(arguments);r++){if(0===arguments[r].length)return X;arguments[r].isReference&&(n+=arguments[r].rangeCount)}return n}function Xr(r,n){var e,t,n,u,i,e=n.getRow(0),t=n.getColumn(0),n=n.getSource();return n.isFormulaHidden?(u=n.getCalcSourceModel().getFormula(e,t))&&!(i=n.isFormulaHidden(e,t))?"="+u:M:(u=n.getCalcSourceModel().getFormula(e,t))?"="+u:M}function Yr(r,n){var e,t,n,e=n.getRow(0),t=n.getColumn(0),n=n.getSource().getCalcSourceModel();return!(!n.ODt||!n.ODt(e,t))}function x(r,n){var e;return void 0===n&&(n=!1),(e=S(r)||R(r)?r.toArray(0,!1):r.length&&r[0].length?r:[[r]])?Kr(e,n):h(r)?r:D}function Kr(r,n){var n,e,t,u,i,f,o,e=r.rowCount,t=r.colCount;if(e||t||(e=r.length,t=r[0].length),u=r,n=void 0===n?!1:n){for(u=[],i=0;i<t;i++)for(u.push(f=[]),o=0;o<e;o++)f.push(r[o][i]);e=(n=[t,e])[0],t=n[1]}return u.rowCount=e,u.colCount=t,u}function Wr(r){return 1===r||-1===r}function Qr(r,i){var f=i.length;r.sort(function(r,n){for(var e,t,u,u,e=0;e<f;e++)if(u=(t=i[e])[0],0!==(u=(0,y.$kt)(r[u],n[u])))return t[1]?u:-u;return 0})}function zr(r,e,n){var t;n?r.forEach(function(r,n){r.push(e[n][0])}):(t=e[0],r.forEach(function(r,n){r.push(t[n])}))}function Zr(r){if(r&&r.length&&0<=r.length){for(var n=0;n<r.length;n++)if("number"!=typeof r[n])return;return 1}}function qr(r,n,e,t){var u,i,f,o,a,c,s,_,v,g,l,p,T,M,E,A,C,m,d,O,d;if(void 0===n&&(n=1),void 0===e&&(e=1),u=[].concat(x(r,t=void 0===t?!1:t)),h(u))return u;if(i=u,f=[],S(n)||R(n)){if(_=(s=n.toArray(0,!1)).rowCount,v=s.colCount,g=0,S(e)||R(e)){if(g=(a=e.toArray(0,!1)).rowCount,1!==v){if(v<1||1!==a.colCount&&a.colCount!==v||1!==_||!Zr(s[0]))return D;if((l=[]).push(r),t)for(i=Kr(i,t),p=0;p<v;p++){for(T=[],M=0;M<i[0].length;M++)T.push(i[s[0][p]-1][M]);l.push(new y.CalcArray([T])),l.push((1===g?a[0]:a[p])[0])}else for(p=0;p<v;p++){for(T=[],M=0;M<i.length;M++)T.push([i[M][s[0][p]-1]]);l.push(new y.CalcArray(T)),l.push((1===g?a[0]:a[p])[0])}return Jr.apply(Jr,l)}if(1!==a.colCount||1!==g&&g!==_)return D;1===g&&(c=a[g=0][0])}else c=e;for(o=0;o<_;o++)f.push([s[o][0],o<g?a[o][0]:c])}else if(S(e)||R(e)){if(1!==(a=e.toArray(0,!1)).colCount||1!==a.rowCount)return D;f.push([n,a[0][0]])}else f.push([n,e]);for(E=i.colCount,A=[],C=0,m=f;C<m.length;C++){if(O=(d=m[C])[0],d=d[1],O<1||E<O||!Wr(d))return D;A.push([O-1,1===d])}return Qr(i,A),new y.CalcArray(t?Kr(i,t):i)}function Jr(r,n,e){var t,u,i,f,o,a,c,e,s,_,v,g,l,p,T,M,E,A,C,m,d,O,O,d,I,N,C;for(void 0===e&&(e=1),t=[],u=3;u<arguments.length;u++)t[u-3]=arguments[u];if(a=o=0,c=D,R(r)?i=r:S(r)&&(o=(f=r).getRow(),a=f.getColumn()),e=i||f){if(s=e.getColumnCount(),_=e.getRowCount(),h(r))return c;for(v=[],g=void 0,M=T=void(p=l=0),E=1,A=arguments.length;E<A;E+=2){if(m=[].concat(x(C=arguments[E])),h(m))return c;if(d=C.getRowCount(),O=C.getColumnCount(),l||(l=(g=1===O)?2:1,M=[].concat(x(r,!g))),!(!g&&1===d&&O===s||g&&1===O&&d===_))return c;if(O=R(C),S(C)&&(d=void 0,g?0<=(d=a-(I=C.getColumn()))&&d<s?T=d:O=!0:0<=(d=o-(N=C.getRow()))&&d<_?T=d:O=!0),O&&(p+=1,g?(T=s,s++):(T=_,_++),zr(M,m,g)),!Wr(C=arguments[E+1]||1))return c;v.push([T,1===C])}return Qr(M,v),p&&M.forEach(function(r){r.length-=p}),new y.CalcArray(g?M:Kr(M,!0))}return c}function $r(r,n){return!!(r===n||G(r)&&G(n)&&l(r)===l(n)||h(r)&&h(n)&&r._code===n._code)}function rn(r,n){for(var e,t,u,i,e=0,t=r.length;e<t;e++)if(!$r(u=r[e],i=n[e]))return;return 1}function nn(r,n,i){var r,f,o,a;return void 0===i&&(i=!1),r=x(r,n=void 0===n?!1:n),h(r)?r:(o=[],a=(f=r).rowCount,f.forEach(function(r,n){var e,t,u;if(!r.duplicated){for(e=0,t=n+1;t<a;t++)rn(r,u=f[t])&&(u.duplicated=!0,e++);i&&0!==e||o.push(r)}}),new y.CalcArray(n?Kr(o,n):o))}function en(r,n,e){var r,t,u,i,f,r=x(r);if(h(r))return r;if(t=r,u=[].concat(x(n)),i=[],1===u.length&&u[0].length===t[0].length){for(f=0;f<u[0].length;f++)if(h(u[0][f]))return u[f][0];t.forEach(function(r,n){var e=[];r.forEach(function(r,n){u[0][n]&&e.push(r)}),i.push(e)})}else{if(t.length!==u.length)return D;for(f=0;f<u.length;f++){if(h(u[f][0]))return u[f][0];u[f][0]&&i.push(t[f])}}return 0===i.length?d(e)?Y:e:new y.CalcArray(i)}function tn(r,n){var e,t,u,i,f,o,a,c,s,_,v,r;if(R(n))return n.getValue(0,0);if(S(n)){if(t=(e=n).getColumn(),u=e.getRow(),i=e.getColumnCount(),f=e.getRowCount(),c=(o=r.row)-u,s=(a=r.column)-t,v=_=void 0,r=r.source===e.getSource(),1===f&&(!r||u!==o)&&0<=s&&s<i)v=a,_=u;else if(1===i&&(!r||t!==a)&&0<=c&&c<f)v=t,_=o;else{if(1!==f||1!==i)return D;v=t,_=u}return e.create([{row:_,col:v,rowCount:1,colCount:1}])}return n}function un(r,n){return n instanceof y.CalcReference?n.getSpillRef():P}function fn(r,n,e){var t,u,t;return n instanceof y.CalcReference&&(!e||e instanceof y.CalcReference)?(u=(t=n.rT||r.source).hierarchicalCellIndexingHelper||t.Mf.getHierarchicalCellIndexingHelper&&t.Mf.getHierarchicalCellIndexingHelper())?(t=t.getBaseRowCol&&t.getBaseRowCol()||r.identity,u.getIndex(t,n,e)):o:P}function on(r,n,e,t,u){var i,f,i;return n instanceof y.CalcReference&&(!e||e instanceof y.CalcReference)?(f=(i=n.rT||r.source).hierarchicalCellIndexingHelper||i.Mf.getHierarchicalCellIndexingHelper&&i.Mf.getHierarchicalCellIndexingHelper())?(i=i.getBaseRowCol&&i.getBaseRowCol()||r.identity,f.getRank(i,n,e,1!==t,u)):o:P}function an(r,n,e){var t,r;return n instanceof y.CalcReference?(r=(t=n.rT||r.source).hierarchicalCellIndexingHelper)?r.coordinateOffset(n,e,!1):o:P}function cn(r,n,e){var t,r;return n instanceof y.CalcReference?(r=(t=n.rT||r.source).hierarchicalCellIndexingHelper)?r.coordinateOffset(n,e,!0):o:P}function sn(r,n,e,t){var r,u,r;return n instanceof y.CalcReference?(u=(r=n.rT||r.source).hierarchicalCellIndexingHelper)?(r=r.getBaseRowCol&&r.getBaseRowCol(),u.coordinateExecute(r,n,e,t)):o:P}function _n(r){var r,n,r,r=r.source,n=r.Mf;return n&&n.getPageIndexByCell?(r=r.getBaseRowCol&&r.getBaseRowCol(),n.getPageIndexByCell(r.row,r.col)+1):o}function vn(r){var n,r,n,r=r.source.Mf;return r&&r.getPagesCount?r.getPagesCount():o}function gn(r,n,e,t){var r,u,r;return n instanceof y.CalcReference?(u=(r=n.rT||r.source).hierarchicalCellIndexingHelper)?(r=r.getBaseRowCol&&r.getBaseRowCol(),u.getProportion(r,n,e,t)):o:P}function ln(r,n,e,t){var r,u,r;return n instanceof y.CalcReference?(u=(r=n.rT||r.source).hierarchicalCellIndexingHelper)?(r=r.getBaseRowCol&&r.getBaseRowCol(),u.getCumulative(r,n,e,t)):o:P}function pn(r,n,e,t){var r,u,r;return n instanceof y.CalcReference&&(e||t)?(u=(r=n.rT||r.source).hierarchicalCellIndexingHelper)?(r=r.getBaseRowCol&&r.getBaseRowCol(),u.getYearOverYear(r,n,e,t)):o:P}function Tn(r,n,e,t){var r,u,r;return n instanceof y.CalcReference?(u=(r=n.rT||r.source).hierarchicalCellIndexingHelper)?(r=r.getBaseRowCol&&r.getBaseRowCol(),u.getMonthOverMonth(r,n,e,t)):o:P}function Mn(){var r,n,e,t,u,i,f,o,a,c,r=arguments,n=r.length;if(1===n)return new y.CalcArray(r[0]);for(t=e=0;t<n;t++)e=Math.max(e,r[t].colCount);for(u=[],i=0;i<n;i++)for(f=r[i],o=0;o<f.rowCount;o++){for(a=[],c=f.colCount,t=0;t<c;t++)a.push(f[o][t]);for(t=c;t<e;t++)a.push(M);u.push(a)}return new y.CalcArray(u)}function En(){var r,n,e,t,u,i,f,o,a,c,r=arguments,n=r.length;if(1===n)return new y.CalcArray(r[0]);for(t=e=0;t<n;t++)e=Math.max(e,r[t].rowCount);for(u=[],i=0;i<e;i++){for(f=[],o=0;o<n;o++)for(c=i<(a=r[o]).rowCount,t=0;t<a.colCount;t++)f.push(c?a[i][t]:M);u.push(f)}return new y.CalcArray(u)}function An(r,n,e,t){var u,i,f,o,a,c,s,u=r.rowCount,i=r.colCount,f=1===e||3===e,o=2===e||3===e,a=function(r){f&&r===A||o&&h(r)||t(r)};if(n)for(c=0;c<i;c++)for(s=0;s<u;s++)a(r[s][c]);else for(s=0;s<u;s++)for(c=0;c<i;c++)a(r[s][c])}function Cn(r){for(var n,e,n=new Array(r),e=0;e<r;e++)n[e]=[];return n}function mn(r,n,e){var t=[];return An(r,e,n,function(r){t.push(r===A?0:r)}),new y.CalcArray([t])}function dn(r,n,e){var t=[];return An(r,e,n,function(r){t.push([r===A?0:r])}),new y.CalcArray(t)}function On(r,n,e){var t,u,i,f,o,a,t=r.rowCount,u=r.colCount;if(1!==t&&1!==u)return D;if(d(n)||n<=0)return j;if((i=Math.max(t,u))<=n)return new y.CalcArray(r);if(f=[],An(r,!(o=[]),0,function(r){o.push(r),o.length===n&&(f.push(o),o=[])}),0<o.length){for(e=d(e)?M:e,a=o.length;a<n;a++)o.push(e);f.push(o)}return new y.CalcArray(f)}function In(r,n,e){var t,u,i,f,o,a,t=r.rowCount,u=r.colCount;if(1!==t&&1!==u)return D;if(d(n)||n<=0)return j;if((i=Math.max(t,u))<=n)return new y.CalcArray(r);if(f=Cn(n),An(r,!1,o=0,function(r){f[o].push(r),++o===n&&(o=0)}),0<o)for(e=d(e)?M:e,a=o;a<n;a++)f[a].push(e);return new y.CalcArray(f)}function Nn(r,n,e,t,u){var i,f,o,a,c,i=0===n&&e===r.rowCount,f=0===t&&u===r.colCount;if(i&&f)return new y.CalcArray(r);for(o=[],a=n;a<e;a++)c=r[a],o[a-n]=f?c:c.slice(t,u);return new y.CalcArray(o)}function yn(r,n,e){var t,u,i,f,o,a,t=r.rowCount,u=r.colCount;return cr(r,t,u)?D:Nn(r,i=0<(n=t<(n=d(n)?t:n)||n<-t?t:n)?0:t+n,f=0<n?n:t,o=0<(e=u<(e=d(e)?u:e)||e<-u?u:e)?0:u+e,a=0<e?e:u)}function hn(r,n,e){var t,u,i,f,o,a,t=r.rowCount,u=r.colCount;return n=d(n)?0:n,e=d(e)?0:e,t<=n||n<=-t||u<=e||e<=-u?Y:Nn(r,i=0<=n?n:0,f=0<=n?t:t+n,o=0<=e?e:0,a=0<=e?u:u+e)}function Sn(r,n){var e,t,e=new Array(n);if("function"==typeof e.fill)e.fill(r,0,n);else for(t=0;t<n;t++)e[t]=r;return e}function Rn(r,n,e,t){var u,i,f,o,a,c,s,u=r.rowCount,i=r.colCount;if(n=d(n)?u:n,e=d(e)?i:e,cr(r,u,i)||n<u||e<i)return D;if(o=i<e,!(f=u<n)&&!o)return new y.CalcArray(r);for(a=Sn(t=d(t)?M:t,e-i),c=[],s=0;s<u;s++)c.push(o?r[s].concat(a):r[s]);for(s=u;s<n;s++)c.push(Sn(t,e));return new y.CalcArray(c)}function Dn(r){var n,e,n,t,u,e,e;if(h(r))return r;if(R(r)||S(r)){if(e=r.getRowCount(),n=r.getColumnCount(),1!==e&&1!==n)return D;if((e=y.Convert.iV(r,u=(t=1===e&&1===n)?1:5,!0,!0,!0)).isConvertError)return D;if(e.isError)return e[0];if(e.some(function(r){return r===y.Convert.CalcConvertedError}))return D;n=e}else{if(!N(r,e={}))return D;n=[e.value]}return n}function Pn(r,n){for(var e,t,u,i,f,o,a,e=[],t=y.Convert.iV(r[0],0,!1,!1,!1,!1),u=n?t.rowCount:t.colCount,i=1;i<r.length;i++){if(f=Dn(r[i]),h(f))return f;for(o=0;o<f.length;o++){if(0===(a=f[o])||u<a||a<-u)return D;e.push(a)}}return 0===e.length?D:{array:t,indexNumbers:e}}function wn(){var r,n,e,t,u,i,f,r=Pn(arguments,!0);if(h(r))return r;for(n=r.array,e=r.indexNumbers,t=n.rowCount,u=[],i=0;i<e.length;i++)f=e[i],u.push(n[f=0<f?f-1:t+f]);return new y.CalcArray(u)}function bn(){var r,n,e,t,u,i,f,o,a,r=Pn(arguments,!1);if(h(r))return r;for(n=r.array,e=r.indexNumbers,t=n.rowCount,u=n.colCount,i=Cn(t),f=0;f<e.length;f++)for(o=0<(o=e[f])?o-1:u+o,a=0;a<t;a++)i[a].push(n[a][o]);return new y.CalcArray(i)}e=this&&this.__extends||(fr=function(r,n){return(fr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(r,n){r.__proto__=n}:function(r,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e])}))(r,n)},function(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=r}fr(r,n),r.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(r,"__esModule",{value:!0}),u=n("Common"),y=n("CalcEngine"),A=null,C=void 0,m=u.Common.$T,k=u.Common.lt,r=u.Common.ct,g=u.Common.st.E8,U=r.Z6t,d=k.ht,B=k.Fh,O=u.Common.Uf.tR,G=r.W0,l=r.o0,h=y.Convert.BJ,I=y.Convert.z6t,N=y.Convert.t9t,i=y.Convert.q8,F=y.Convert.uJ,S=y.Convert.LE,R=y.Convert.Nh,H=y.Convert.j,D=y.Errors.Value,P=y.Errors.Reference,j=y.Errors.Number,M=y.Errors.NotAvailable,X=y.Errors.Null,Y=y.Errors.Calc,o=y.Errors.Name,n=y.Functions.F6t,f=y.Functions.G6t,w=y.Functions.OMt,K=1048576,W=16384,J=y.CalcReference.prototype,or=y.CalcReference,e(Mr,or),Mr.prototype.type=function(){return this.uit},Mr.prototype.toArray=function(r,n){for(var e=this,t=[],u=e.Ky,i=e.yft,f=e.uit,o=e.getRangeCount(),a=e.Sx,c=e.Cyt,s,_,v,g,l,p,s=0;s<o;s++)for(n||t.push(v=[]),l=0;l<a;l++)for(n||v.push(g=[]),p=0;p<c;p++)_=0===f?u+1+l:1===f?i+1+p:J.getValue.call(e,s,u+l,i+p),(n?t:g).push(_);return(t=n||1!==o?t:t[0]).rowCount=a,t.colCount=c,t.rangeCount=o,t},$=Mr,ar=y.CalcArray,e(Er,ar),Er.prototype.getRowCount=function(){return y.CalcArrayHelper.getColumnCount(this.Kkt)},Er.prototype.getColumnCount=function(){return y.CalcArrayHelper.getRowCount(this.Kkt)},Er.prototype.getValue=function(r,n){return y.CalcArrayHelper.getValue(this.Kkt,n,r)},rr=Er,r={J6t:7},e={J6t:2},s={J6t:2,pkt:"<= 0",zkt:D},tr={J6t:2,pkt:["< 0","> 3"],zkt:D},ur={J6t:2,pkt:["= 0"],zkt:Y},ir={bkt:0,J6t:2},_={J6t:4,X6t:0,Vkt:!0},v={J6t:4,X6t:0,n9t:!0},n("ADDRESS",kr,2,5,[t={J6t:2},t,er={bkt:1,J6t:2},nr={bkt:!0,J6t:7},{bkt:"",J6t:5}],C,C,{wkt:[2,3,4]}),n("INDEX",Br,2,4,C,0,0,{wkt:[1,2,3],e9t:[0],i9t:!0,r9t:!0,o9t:3}),n("OFFSET",Gr,3,5,[{},t,t],0,0,{wkt:[3,4],e9t:[0],a9t:!0,r9t:!0,o9t:2,returnReference:!0}),n("ROW",mr,0,1,C,-1,C,{r9t:!0,e9t:-1,expandColumns:!1}),n("COLUMN",dr,0,1,C,-1,C,{wkt:0,r9t:!0,e9t:-1,expandRows:!1}),n("ROWS",Or,1,1,C,-1,-1,{e9t:-1,expandColumns:!1,u9t:2}),n("COLUMNS",Ir,1,1,C,-1,-1,{e9t:-1,expandRows:!1,u9t:3}),n("TRANSPOSE",Nr,1,1,C,-1,-1),n("LOOKUP",Rr,2,3,[_,{J6t:4,X6t:0,Vkt:!0,s9t:!0}],"!= 0","!= 0",{f9t:1}),n("HLOOKUP",yr,3,4,[_,{},s,r],1,1,{r9t:!0,i9t:!0,e9t:[1]}),n("VLOOKUP",hr,3,4,[_,{},s,r],1,1,{r9t:!0,i9t:!0,e9t:[1]}),n("XLOOKUP",Sr,3,6,[_,_,{},{},{J6t:2,bkt:0},{J6t:2,bkt:1}],[1,2,3],[1,2,3],{wkt:[3,4,5]}),n("VSTACK",Mn,1,255,v,-1,-1,C,!0),n("HSTACK",En,1,255,v,-1,-1,C,!0),n("TOROW",mn,1,3,[v,tr,r],0,0,{wkt:[1,2]},!0),n("TOCOL",dn,1,3,[v,tr,r],0,0,{wkt:[1,2]},!0),n("WRAPROWS",On,2,3,[v,t],0,0,{wkt:[2],f9t:-1},!0),n("WRAPCOLS",In,2,3,[v,t],0,0,{wkt:[2],f9t:-1},!0),n("TAKE",yn,2,3,[v,ur,ur],0,0,{wkt:[1,2]},!0),n("DROP",hn,2,3,[v,ir,ir],0,0,{wkt:[1,2]},!0),n("EXPAND",Rn,2,4,[v,s,s],0,0,{wkt:[1,2,3]},!0),n("CHOOSEROWS",wn,2,255,C,-1,-1,C,!0),n("CHOOSECOLS",bn,2,255,C,-1,-1,C,!0),n("CHOOSE",Dr,2,255,t,">= 1",">= 1",{f9t:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(r){var n={value:-1};return h(r)?-1:(N(r,n),n.value)}}),n("MATCH",Pr,2,3,[_,{J6t:4,X6t:0,Vkt:!0,Zbt:!0},e],1,1,{}),n("XMATCH",wr,2,4,[_,_,e,e],1,1,{}),n("INDIRECT",Fr,1,2,[{J6t:5},nr],C,C,{wkt:2,a9t:!0,r9t:!0}),n("HYPERLINK",Hr,1,2,C,C,C,{u9t:1}),n("AREAS",jr,1,C,{J6t:4,Vkt:!0,Ykt:!0,n9t:!0},-1,-1),n("FORMULATEXT",Xr,1,1,C,-1,C,{r9t:!0}),n("ISFORMULA",Yr,1,1,C,-1,C,{r9t:!0}),n("SORT",qr,1,4,C,[0,1,2],[0,1,2],{wkt:[1,2,3]},!0),n("SORTBY",Jr,2,C,C,[0,"%= 1"],[0,"%= 1"],C,!0),n("UNIQUE",nn,1,3,C,[0],[0],{wkt:[1,2]},!0),n("FILTER",en,2,3,C,[0,1,2],[0,1,2],C,!0),n("@",tn,1,1,C,[0],[0],{r9t:!0},!0),n("ANCHORARRAY",un,1,1,C,[0],[0],{r9t:!0},!0),n("R.INDEX",fn,1,2,C,-1,-1,{r9t:!0}),n("R.RANK",on,1,4,C,-1,-1,{r9t:!0}),n("R.R",an,2,2,C,-1,-1,{r9t:!0}),n("R.A",cn,2,2,C,-1,-1,{r9t:!0}),n("R.V",sn,1,255,C,-1,-1,{r9t:!0}),n("R.CURRENTPAGE",_n,0,0,C,-1,-1,{r9t:!0},!1),n("R.PAGESCOUNT",vn,0,0,C,-1,-1,{r9t:!0}),n("R.PROPORTION",gn,1,3,C,-1,-1,{r9t:!0}),n("R.CUMULATIVE",ln,1,3,C,-1,-1,{r9t:!0}),n("R.MOM",Tn,1,3,C,-1,-1,{r9t:!0}),n("R.YOY",pn,2,3,C,-1,-1,{r9t:!0})},"./src/functions-stat.ts":function(l,r,p){var T,U,m,j,B,h,S,C,ir,b,R,I,N,D,v,P,fr,or,ar,cr,w,y,M,G,F,L,V,H,d,sr,x,k,E,_r,X,Y,e,g,K,W,Q,vr,A,r,z,Z,n,q,J,$,t,rr,u,p,nr,i,er,tr,f,o,ur,a,c,gr,s,lr,pr,Tr,Mr,Er,Ar,Cr,mr,dr,Or,Ir,Nr,yr,hr,Sr,Rr,Dr,Pr,wr,br,a,Vr,Lr,xr,kr,Ur,Mr,Br,Gr,Fr,Hr,jr,Xr,Yr,Kr;function Wr(r){for(var n,e,n=0,e=0;e<r.length;e++)r[e]!==A&&n++;return n}function Qr(r){var n,e,t,e,n=6,e=0===r?0:3<=(t=.5*Math.abs(r))?1:t<1?((((((((.000124818987*(e=t*t)-.001075204047)*e+.005198775019)*e-.019198292004)*e+.059054035642)*e-.151968751364)*e+.319152932694)*e-.5319230073)*e+.797884560593)*t*2:(((((((((((((-45255659e-12*(t-=2)+.00015252929)*t-19538132e-12)*t-.000676904986)*t+.001390604284)*t-.00079462082)*t-.002034254874)*t+.006549791214)*t-.010557625006)*t+.011630447319)*t-.009279453341)*t+.005353579108)*t-.002141268741)*t+.000535310849)*t+.999936657524;return 0<r?.5*(e+1):.5*(1-e)}function zr(r,n,e){var t,u,i,f,o,u,t=m(r);if(n!==r[0]){for(o=r[f=0],i=1;i<t&&r[i]<n;i++)r[i]!==o&&(o=r[f=i]);r[i]!==o&&(f=i),u=n===r[i]?e?f/(t-1):(i+1)/(t+1):0===f?0:(u=(n-r[f-1])/(r[f]-r[f-1]),e?(f-1+u)/(t-1):(f+u)/(t+1))}else u=e?0:1/(t+1);return u}function Zr(r,n,e,t){var u,r,r,u=[];return ln(r,u),0===(r=m(u))||n<u[0]||u[r-1]<n?G:0!==(r=1===r?1:zr(u,n,t))?w(r*ir(10,e))/ir(10,e):r}function qr(r,n,e){for(var t,u,i,f,o,a,c,s,_,v,g,l,g,t=300,u=1e-50,i=1e-20,f=r+n,o=r+1,a=r-1,c=1,s=1-f*e/o,_=s=1/(s=or(s)<u?u:s),v=1;v<=t&&(_=(_*=(s=1/(s=or(s=1+(l=(n-v)*v*e/((a+(g=v+v))*(r+g)))*s)<u?u:s))*(c=or(c=1+l/c)<u?u:c))*(g=(s=1/(s=or(s=1+(l=0-(r+v)*(f+v)*e/((r+g)*(o+g)))*s)<u?u:s))*(c=or(c=1+l/c)<u?u:c)),!(or(g-1)<i));v++);return _}function O(r){var n;return[22250738585072014e-324,17976931348623157e292,ir(2,-53),ir(2,-52),x.ckt(2,10)][r-1]||0}function Jr(r,n,e){var t,u,i,t=0,u=0;if(n<1)return 0;for(i=1;i<=n;i++)if(e<(u+=or(sr(r[t=n-i]))))return t;return t}function $r(r,n,e){var t,u,i,f,o;if(e<1||1e3<e||r<-1.1||1.1<r)return NaN;for(t=2*r,f=i=u=0,o=1;o<=e;o++)i=u,f=t*(u=f)-i+sr(n[e-o]);return.5*(f-i)}function rn(r){var n,e,t,u,u,n=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],e=Jr(n,15,O(3)),t=1/ar(O(3)),u=fr(R(cr(O(2)/12),-cr(12*O(1))));return r<10?NaN:u<=r?4930380657631324e-47:r<t?$r((u=10/r)*u*2-1,n,e)/r:1/(12*r)}function nn(r){var n,e,n=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],e=Jr(n,43,.1*O(3));return r<=-1?NaN:or(r)<=.375?r*(1-r*$r(r/.375,n,e)):cr(r+1)}function en(r){var n,e,t,u,i,f,o,a,u=1,i=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(171<r)return 1e308;if(r===d(r))if(0<r)for(n=1,f=2;f<r;f++)n*=f;else n=1e308;else{if(1<or(r)){for(t=or(r),o=d(t),e=1;e<=o;e++)u*=t-e;t-=o}else t=r;for(a=i[24],e=23;0<=e;e--)a=a*t+i[e];n=1/(a*t),1<or(r)&&(n*=u,r<0)&&(n=-v/(r*n*N(v*r)))}return n}function tn(r){var n,e,t,u,i,f,o,a,e=0,t=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],u=r;if(r<=0)return 1e308;if(1===r||2===r)return 0;for(i=1/((u=r<=7?r+(e=d(7-r)):u)*u),f=2*v,o=t[9],n=8;0<=n;n--)o=o*i+t[n];if(a=o/u+.5*cr(f)+(u-.5)*cr(u)-u,r<=7)for(n=1;n<=e;n++)a-=cr(u-1),--u;return a}function un(r,n){var e,t,r,n,t=r=r;return r<n&&(r=n),(t=n<t?n:t)<0?NaN:0===t?vr:10<=t?(e=rn(t)+rn(r)-rn(t+r),-.5*cr(r)+.9189385332046728+e+(t-.5)*cr(t/(t+r))+r*nn(-t/(t+r))):10<=r?(e=rn(r)-rn(t+r),n=f0(t),_r(n)?NaN:sr(n)+e+t-t*cr(t+r)+(r-.5)*nn(-t/(t+r))):cr(en(t)*(en(r)/en(t+r)))}function fn(r,n,e){var t,u,i,f,o,a,c,s,_,v,g,l,p,T,M,E,A,C,a=O(3),c=cr(a),s=O(1),_=cr(s),v=r,g=n,l=e;if(g/(g+l)<r&&(v=1-v,g=e,l=n),(g+l)*v/(g+1)<a)t=0,_<(i=g*cr(b(v,s))-cr(g)-un(g,l))&&0!==v&&(t=fr(i)),v===r&&g===n||(t=1-t);else{if(0===(p=l-I(l))&&(p=1),t=0,_<=(i=g*cr(v)-un(p,g)-cr(g))&&(u=(t=fr(i))*g,1!==p))for(o=d(b(c/cr(v),4)),T=1;T<=o;T++)t+=(u=u*((f=T)-p)*v/f)/(g+f);if(1<l){for(i=g*cr(v)+l*cr(1-v)-un(g,l)-cr(l),M=d(b(i/_,0)),u=fr(i-M*_),A=l*(E=1/(1-v))/(g+l-1),C=0,l===(o=d(l))&&(o-=1),T=1;T<=o&&!(A<=1&&u/a<=C);T++)1<(u=(l-(f=T)+1)*E*u/(g+l-f))&&(M-=1,u*=s),0===M&&(C+=u);t+=C}t=b(R(t=v===r&&g===n?t:1-t,1),0)}return t}function on(r){var r,r;return r=sr(r=.7071067811865475*-r),h(r)?M:(r=g(r*ar(2)),_r(r)?NaN:.5*(2-2*r))}function an(r,n,e,t){var u,i,f,o,a,c,s,_,v,g,l,p,T,M;function E(r,n){return r<0&&0<n||0<r&&n<0}for(u=1e-307,i=222045e-21,f=r.Sl(n),o=r.Sl(e),c=0;c<1e3&&!E(f,o);c++)or(f)<=or(o)?((n+=2*((a=n)-e))<0&&(n=0),e=a,o=f,f=r.Sl(n)):(e+=2*((a=e)-n),n=a,f=o,o=r.Sl(e));if(0===f)return n;if(0===o)return e;if(!E(f,o))return t.l9t=!0,0;for(g=o,p=_=f,T=.5*((l=s=n)+(v=e)),M=!0,c=0;c<500&&or(p)>u&&e-n>b(or(n),or(e))*i;)(M=M&&_!==g&&g!==p&&p!==_&&n<(T=s*p*g/(p-_)/(g-_)+l*g*_/(g-p)/(_-p)+v*_*p/(_-g)/(p-g))&&T<e)||(T=.5*(n+e),v=e,g=o,M=!0),s=v,v=l,l=T,_=g,g=p,E(f,p=r.Sl(T))?(e=l,o=p):(n=l,f=p),M=M&&2*or(p)<=or(g),++c;return l}function cn(r,n){for(var e,t,u,i,f,e=m(n),t=0;t<e;t++)f=(i=(u=sr(n[t]))-r.M)/(r.N+1),r.M+=f,r.Q+=r.N*i*f,r.N++,r.h9t+=u}function sn(r){var n,e,t,u,i,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],e=1.000000000190015,u=r,i=r+5.5;for(i-=(r+.5)*cr(i),t=0;t<=5;t++)e+=n[t]/++u;return-i+cr(2.5066282746310007*e/r)}function _n(r,n,e){var t,u,i,f,o,a,c,s,_,v,g,l,p,T,T,T,t=0===e||1===e?0:fr(sn(r+n)-sn(r)-sn(n)+r*cr(e)+n*cr(1-e)),u=(r+1)/(r+n+2)<=e;for(u&&(i=r,r=n,n=i,e=1-e),f=4450147717014403e-323,o=100,s=r-1,g=v=(_=1)/(v=or(v=1-(a=r+n)*e/(c=r+1))<f?f:v),l=1,p=2;l<=o;l++,p+=2)if(g=(g*=(v=1/(v=or(v=1+(T=l*(n-l)*e/((s+p)*(r+p)))*v)<f?f:v))*(_=or(_=1+T/_)<f?f:_))*(T=(v=1/(v=or(v=1+(T=-(r+l)*(a+l)*e/((r+p)*(c+p)))*v)<f?f:v))*(_=or(_=1+T/_)<f?f:_)),or(sr(T-1))<5e-324)return T=t*g/r,u?1-T:T;return F}function vn(r,n){for(var e,t,u,i,f,e=m(n),t=0;t<e;t++)(u=n[t])!==A&&(f=(i=u-r.M)/(r.N+1),r.M+=f,r.Q+=r.N*i*f,r.N++,r.h9t+=u)}function gn(r){r.sort(function(r,n){return r-n})}function ln(r,n){for(var e,t,e=0;e<m(r);e++)(t=r[e])!==A&&n.push(t);gn(n)}function pn(r){for(var n,e,n=[],e=0;e<m(r);e++)ln(r[e],n);return n}function Tn(r,n,e){var t,u,e,t,u,i,f,o,a,c,s,_,v,t=Math.expm1||function(r){return fr(r)-1},u=Math.log1p||function(r){return cr(1+r)};return r<=0?0:1<=r?1:1===e?ir(r,n):1===n?-t(e*u(-r)):(t=.5-r+.5,u=u(-r),f=cr(i=r),(c=(o=n)/(n+(a=e))<r)&&(o=e,a=n,i=t,f=u,u=cr(t=r)),e=Mn(i,o,a),e=(e/=o)*(v=1<o&&1<a&&(s=o/(o+a))<.97&&(_=a/(o+a))<.97?En(i,o,a)*i*t:fr(o*f+a*u-An(!1,o,a))),(e=1<(e=c?.5-e+.5:e)?1:e)<0?0:e)}function Mn(r,n,e){for(var t,u,i,f,o,a,c,s,_,v,g,l,p,l,o=222045e-21,a=1,c=1,s=1-(n+e)/(n+1)*r,f=0===s?(t=0,u=1):(t=1)*(u=1/s),i=1,_=1,v=5e4,g=!1;t=(a=(t+(p=_*(e-_)*r/(((l=n+2*_)-1)*l))*a)*u)+(l=-(n+_)*(n+e+_)*r/(l*(l+1)))*t*u,0!==(s=(c=(s+p*c)*u)+l*s*u)&&(g=or(f-(i=t*(u=1/s)))<or(f)*o),f=i,(_+=1)<v&&!g;);return f}function En(r,n,e){var t,u,i,f,o,i,a;return 1===n?1===e?1:2===e?-2*r+2:r<=.01?e+e*fr((e-1)*cr(1-r))-1:e*ir(.5-r+.5,e-1):1===e?2===n?n*r:n*ir(r,n-1):r<=0&&!(n<1&&0===r)||1<=r&&!(e<1&&1===r)?0:(t=cr(O(2)),u=cr(O(1)),i=cr(r<.1?1+r:1-r),o=(n-1)*(f=cr(r)),i=(e-1)*i,a=An(!1,n,e),o<t&&u<o&&i<t&&u<i&&a<t&&u<a&&o+i<t&&u<o+i?ir(r,n-1)*ir(.5-r+.5,e-1)/An(!0,n,e):fr(o+i-a))}function An(r,n,e){var t,u,i,e,f,n,e,o,e,a,o,t,t=e,u=n,i;return e<n&&(e=t,t=u,u=e),r&&t+u<171.624376956302?Cn(t)/Cn(t+u)*Cn(u):(n=(f=6.02468004077673)-.5,e=dn(t),e=(e/=dn(t+u))*dn(u),o=t+u+n,e=r?e*ar(o/(t+n)/(u+n)):cr(e)+.5*(cr(o)-cr(t+n)-cr(u+n)),o=t/(u+n),t=-t*cr(1+(a=u/(t+n)))-u*cr(1+o)-n,r?fr(t)*e:t+e)}function _(r){var n,e,t,u,n=dn(r),e,t=r+6.02468004077673-.5,u=ir(t,r/2-.25);return n=(n*=u)/fr(t)*u,n=r<=20&&r===x.d9t(r)?w(n):n}function Cn(r){var n,e,t,u,i,n=cr(v),e=cr(O(2)),t;return 171.624376956302<r?F:1<=r?_(r):.5<=r?_(r+1)/r:-.5<=r?e<=(u=_(r+2)-cr(r+1)-cr(or(r)))?F:_(r+2)/(r+1)/r:e<=(i=_(1-r)+cr(or(N(v*r))))-n?0:i<0&&e<n-i?F:fr(n-i)*(N(v*r)<0?-1:1)}function mn(r){var n;return 171.624376956302<=r?_(r):1<=r?cr(_(r)):.5<=r?cr(_(r+1)/r):_(r+2)-cr(r+1)-cr(r)}function dn(r){var n,e,t,u,i,f,n=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],e=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(r<=1)for(t=n[12],u=e[12],i=11;0<=i;--i)t=t*r+n[i],u=u*r+e[i];else for(f=1/r,t=n[0],u=e[0],i=1;i<=12;++i)t=t*f+n[i],u=u*f+e[i];return t/u}function On(r,n){return r<=0?0:In(n/2,r/2)}function In(r,n){var e,e,e=r*cr(n)-n-mn(r),e=fr(e);return r+1<n?1-e*yn(r,n):e*Nn(r,n)}function Nn(r,n){for(var e,t,u,i,f,e=.5*O(3),t=r,u=1/r,i=u,f=1;i+=u=u*n/(t+=1),f+=1,e<u/i&&f<=1e4;);return 1e4<f?M:i}function yn(r,n){for(var e,t,u,i,f,o,a,c,s,_,f,v,g,l,p,T,e=O(3),t=.5*e,u=1/e,i=0,o=1-r,a=n+2-r,s=n+1,_=1,v=a*n,g=n,l=s/v,p=!1;c=s*(a+=2)-_*(f=(o+=1)*(i+=1)),0!=(f=v*a-g*f)&&(p=or((l-(T=c/f))/T)<=t,l=T),_=s,g=v,v=f,or(s=c)>u&&(_*=e,s*=e,g*=e,v*=e),!p&&i<1e4;);return p?l:M}function hn(r,n){var e,t;if(r<=0)return 0;if(1391e3<n*r)e=fr((.5*n-1)*cr(.5*r)-.5*r-cr(2)-mn(.5*n));else{for(t=n%2<.5?(e=.5,2):(e=1/ar(2*r*v),1);t<n;)e*=r/t,t+=2;e=1425<=r?fr(cr(e)-r/2):e*fr(-r/2)}return e}function Sn(r,n,e,t){var u,i,e,r,u=k(e,r);return _r(u)||(i=sr(u),u=k(t-e,n-r),_r(u))||(e=sr(u),u=k(t,n),_r(u))?u:(r=sr(u),V(i*e/r))}function Rn(r,n,e){var t,u,i,t=Tn(n/(n+r*r),n/2,.5);switch(e){case 1:return.5*t;case 2:return t;case 3:return ir(1+r*r/n,-(n+1)/2)/(ar(n)*An(!0,.5,n/2));case 4:return i=.5*Tn(u=n/(r*r+n),.5*n,.5),r<0?i:1-i}return M}function Dn(n,e,t){return{Sl:function(r){return n-Rn(r,e,t)}}}function Pn(r,n,e){var t,u,r,t={l9t:!1},u,r=an(Dn(r,n,e),.5*n,n,t);return t.l9t?G:r}function wn(r,n){for(var e=!1,t=0,u,i,f,o,a,i=0;i<m(n);i++)for(a=n[i],f=0;f<m(a);f++)if(o=a[f],E(o)||K(o)||W(o))u=W(o)?0:sr(o),(!e||r&&t<u||!r&&u<t)&&(t=u),e=!0;else if(_r(o))return o;return t}function bn(r,n,e,t){for(var u,i,f,o,a,t,u=0,i=0,f=0,o=0;o<m(n);o++)(a=n[o])!==A&&(a<e?u++:e<a?f++:i++);return 0===i?G:(t=(0===t?f:u)+1,r?t:t+(i-1)/2)}function Vn(r,n,e){for(var t,u,i,f,o,a,c,s,i=0;i<m(r);i++)for(a=!!(o=r[i]).isArray,c=!!o.isReference,f=0;f<m(o);f++)if((u=o[f])!==j)if(W(u)){if(U.ExcelCompatibleCalcMode){if(a)continue;if(c){n.n++;continue}}if(U.Convert.sJ(u,s={value:0}))n.v9t+=t=s.value,n.m9t+=t*t;else if(!o.isArray&&!o.isReference)return M;n.n++}else{if(_r(u))return u;!E(u)||e&&"boolean"==typeof u&&o.isArray||(t=sr(u),n.v9t+=t,n.m9t+=t*t,n.n++)}}function Ln(r,n,e,t){var u,r,t,u={v9t:0,m9t:0,n:0},r=Vn(r,u,t);return _r(r)?r:u.n<=n?y:(t=b(0,(u.n*u.m9t-u.v9t*u.v9t)/(u.n*(u.n-n))),t=e?ar(t):t,V(t))}function xn(r,n,e){var t,u,i,f,o,a,c,s,_,v,i=0,f=0,o=0,a=0,s=m(n);if(s!==m(e))return G;for(c=0;c<s;c++)t=n[c],u=e[c],t!==A&&u!==A&&(i+=t,f+=u,a++);if(a<=1)return y;for(_=i/a,v=f/a,c=0;c<s;c++)t=n[c],u=e[c],t!==A&&u!==A&&(o+=(t-_)*(u-v));return V(r?o/a:o/(a-1))}function kn(r,n){for(var e,t,u,i,f,o,e=r?1:0,t=0,f=0;f<m(n);f++)for(u=n[f],o=0;o<m(u);o++)if((i=u[o])!==A){if(i<=0)return F;e=r?e*i:e+1/i,t++}return r?t<=0?y:V(ir(e,1/t)):0===e?y:V(t/e)}function Un(r,n,e,t,u){var i,f,o,a,c,s,_,v,g,l,p,T,M,E,A,C,m,d,x,O,I,N,y,h,o,S,k,R,o,D,P,w,b,V,L,R,S,i=n.rowCount,f=n.colCount,s=(e=r?e!==B?H(e,1,!1,!0,!0):n:(o=e!==B?e:function(r,n){var e=[];for(a=0;a<r;a++)for(e[a]=[],c=0;c<n;c++)e[a][c]=a*n+c+1;return new U.CalcArray(e)}(i,f),H(o,1,!1,!0,!0))).rowCount,_=e.colCount;if(i===s&&f===_&&(t||!u)){for(l=r?s*_:sr(s*_),o=void(h=y=N=I=O=0),a=0;a<s;a++)for(c=0;c<_;c++)p=e[a][c],T=n[a][c],O+=p,I+=p*p,N+=T=r?cr(T):T,y+=T*T,h+=p*T;return m=l*I-O*O,g=t?(l*h-O*N)/m:h/I,o=t?(N*I-O*h)/m:0,r&&(g=fr(g),o=fr(o)),A=[[g,o]],u&&(A[1]=[],A[2]=[],A[3]=[],A[4]=[],o=y-o*N-g*h,D=(R=l*h-O*N)*R/((S=l*I-O*O)*(k=l*y-N*N)),l<3?(A[1][0]=F,A[1][1]=F,A[2][1]=F,A[3][0]=F):(A[1][0]=ar(o*l/(S*(l-2))),A[1][1]=ar(o*I/(S*(l-2))),A[2][1]=ar((k-R*R/S)/(l*(l-2))),A[3][0]=1==D?F:D*(l-2)/(1-D)),A[2][0]=D,A[3][1]=l-2,A[4][0]=k/l-o,A[4][1]=o),new U.CalcArray(A)}if(1===f&&i===s||1===i&&f===_){if(T=[],p=[],l=s,g=_,1===f){for(a=0;a<l;a++)T[a]=n[a][0],r&&(T[a]=cr(T[a]));p=e}else{for(a=0;a<g;a++)T[a]=n[0][a],r&&(T[a]=cr(T[a]));for(a=0;a<g;a++)for(p[a]=[],c=0;c<l;c++)p[a][c]=e[c][a]}for(P=[],v=0;v<g+1;v++)P[v]=[];for(M=0;M<g+1;M++)for(E=0;E<g+2;E++)P[M][E]=0;for(w=[],M=0;M<g+2;M++)w[M]=0;for(b=u?[]:j,v=0;v<l;v++)for(w[g+1]+=T[v]*T[v],P[0][g+1]+=T[v],w[0]=P[0][g+1],a=0;a<g;a++)for(P[0][a+1]+=p[v][a],P[a+1][0]=P[0][a+1],P[a+1][g+1]+=p[v][a]*T[v],w[a+1]=P[a+1][g+1],c=a;c<g;c++)P[c+1][a+1]+=p[v][a]*p[v][c],P[a+1][c+1]=P[c+1][a+1];if(P[0][0]=l,u){for(M=0;M<g+1;M++)for(b[M]=[],E=0;E<g+1;E++)b[M][E]=0;for(a=0;a<g+1;a++)b[a][a]=1}for(a=V=t?0:1;a<g+1;a++){if(0===P[a][a]){for(C=!1,c=a+1;!C&&c<g+1;c++)if(0!==P[c][a]){for(v=0;v<g+2;v++)m=P[a][v],P[a][v]=P[c][v],P[c][v]=m;if(u)for(v=0;v<g+1;v++)m=b[a][v],b[a][v]=b[c][v],b[c][v]=m;C=!0}if(!C)return F}for(d=1/P[a][a],v=V;v<g+2;v++)P[a][v]*=d;if(u)for(v=V;v<g+1;v++)b[a][v]*=d;for(c=V;c<g+1;c++)if(c!==a){for(d=-P[c][a],v=V;v<g+2;v++)P[c][v]+=d*P[a][v];if(u)for(v=V;v<g+1;v++)b[c][v]+=d*b[a][v]}t||(P[0][g+1]=0)}for(A=r?[[],g+1]:[[]],a=0;a<g+1;a++)A[0][a]=r?fr(P[g-a][g+1]):P[g-a][g+1];if(u){if(r)A[1]=[],A[2]=[],A[3]=[],A[4]=[];else for(M=1;M<5;M++)for(A[M]=[],E=0;E<g+1;E++)A[M][E]=0;for(S=R=L=void 0,R=w[g+1]-w[0]*w[0]/l,L=w[g+1],a=0;a<g+1;a++)L-=P[a][g+1]*w[a];if(S=R-L,A[2][0]=0==R?F:S/R,A[4][0]=S,A[4][1]=L,0===(m=t?l-g-1:l-g)){for(a=0;a<g+1;a++)A[1][a]=F;A[2][1]=F}else{for(x=L/sr(m),t||(A[1][g]=G),a=V;a<g+1;a++)A[1][g-a]=ar(x*b[a][a]);A[2][1]=ar(x)}for(A[3][0]=0===L?F:sr(m)*S/(L*sr(g)),A[3][1]=sr(m),a=2;a<5;a++)for(c=2;c<g+1;c++)A[a][c]=G}return new U.CalcArray(A)}return F}function Bn(r,n){for(var e,t,u,i,f,o,a,c,s,u=0,i=0,f=0,s=[],o=0;o<m(n);o++)for(c=n[o],s.push(c),a=0;a<m(c);a++)(e=c[a])!==A&&(u+=e,f++);for(t=u/f,o=0;o<m(n);o++)for(c=s[o],a=0;a<m(c);a++)(e=c[a])!==A&&(i+=r?(e-t)*(e-t):or(e-t));return r?V(i):0===f?y:V(i/f)}function Gn(r,n,e,t){var u,i;for(n=n!==B?H(n,0,!1,!0,!1):r,e=e!==B?H(e,0,!1,!0,!1):n,u=0;u<r.rowCount;u++)for(i=0;i<r.colCount;i++)if(!E(r[u][i]))return M;for(u=0;u<n.rowCount;u++)for(i=0;i<n.colCount;i++)if(!E(n[u][i]))return M;for(u=0;u<e.rowCount;u++)for(i=0;i<e.colCount;i++)if(!E(e[u][i]))return M;return T.Common.eit(r,n,e,t,sr,U.CalcArray,M,G)}function Fn(r,n,e,t){return n=n!==B?H(n,1,!1,!0,!0):r,e=e!==B?H(e,1,!1,!0,!0):n,T.Common.iit(r,n,e,t,U.CalcArray,F,G)}function Hn(r,n,e){var t,u,i,f,o,a,c,s,_,v,g,t=0,u=0,i=0,f=0,o=m(n),a=0;if(o!==m(e))return G;for(c=0;c<o;c++)s=n[c],_=e[c],s!==A&&_!==A&&(t+=s,u+=_,i+=_*_,f+=_*s,a++);return 0===a||a*i-u*u==0?y:V((g=t/a-u/a*(v=(a*f-u*t)/(a*i-u*u)))+v*r)}function jn(){return X(arguments,2,1)}function Xn(){return Y(arguments,2,7)}function Yn(r,n){return e([r,n],16)}function Kn(){return X(arguments,2,4)}function Wn(){return wn(!0,arguments)}function Qn(){return X(arguments,2,5)}function zn(){return wn(!1,arguments)}function Zn(r,n){return e([r,n],14)}function qn(r,n){return e([r,n],15)}function Jn(){for(var r,n,e,t,u,i,f,r=arguments,n=0,e=0,t=0;t<m(r);t++)for(f=r[t],u=0;u<m(f);u++)i=f[u],E(i,!0)||K(i)?(n+=sr(i),e++):i!==j&&!W(i)||e++;return 0===e?y:V(n/e)}function $n(){return e(arguments,12)}function r1(){return e(arguments,13)}function n1(){return kn(!0,arguments)}function e1(){return kn(!1,arguments)}function t1(r,n){var e,t,u,i,f,e=0,t=[];for(ln(r,t),u=Wr(t),f=i=C((u*n/2).toString());f<u-i;f++)e+=sr(t[f]);return e/(u-2*i)}function u1(r,n){for(var e,t,u,i,f,o,a,c,s,_,v,g,l,p,T,e=0,f=n.rowCount,o=n.colCount,t=0;t<f;t++)for(u=0;u<o;u++)n[t][u]!==A&&e++;for(a=r.rowCount,c=r.colCount,s=[],_=[],v=e+1,t=e=0;t<f;t++)for(u=0;u<o;u++)(i=n[t][u])!==A&&(s[e]=sr(i),e++);for(g=s.slice(0),gn(s),t=0;t<v;t++)_[t]=[0];for(t=0;t<a;t++)for(u=0;u<c;u++)if(i=r[t][u],E(i)){for(l=sr(i),p=!1,T=0;!p&&T<e;T++)l<=s[T]&&(_[g.indexOf(s[T])][0]++,p=!0);p||_[e][0]++}return new U.CalcArray(_)}function i1(r,n,e){return bn(!0,n,r,e)}function f1(){var r,n,e,t,u,i,f,o,a,c,s,_,v,r=arguments,e=0,t=0,u=0,i=0,f=m(r),v=[];if(0<f){for(v.push(_=r[0]),c=0;c<m(_);c++)(n=_[c])!==A&&(e+=n,t+=n*n,i++);if(i<=3)return y;if(o=e/i,0===(a=ar((i*t-e*e)/(i*(i-1)))))return y;for(s=0;s<f;s++)for(_=v[s],c=0;c<m(_);c++)(n=_[c])!==A&&(u+=ir((n-o)/a,4));return V(i*(i+1)*u/((i-1)*(i-2)*(i-3))-3*(i-1)*(i-1)/((i-2)*(i-3)))}}function o1(r,n,e){return Zr(r,n,e,!0)}function a1(r,n,e){return Zr(r,n,e,!1)}function c1(r,n){return e([r,n],17)}function s1(){return X(arguments,2,2)}function _1(){return X(arguments,2,3)}function v1(r){for(var n,e,n=0,e=0;e<m(r);e++)r[e]!==j&&""!==r[e]||n++;return n}function g1(r,n,e){var t,u,t,r,t=r.source&&r.source.Lbt,u=0,t=t.S9t||new U.Functions.RangeCriteriaManager,r=r.Xkt;return t.T9t(n,e[0],r&&r.delay?-1:1).RDt(function(){u++}),u}function l1(){return Bn(!1,arguments)}function p1(){return Ln(arguments,1,!0,!0)}function T1(){return Y(arguments,2,8)}function M1(){return Ln(arguments,0,!0,!1)}function E1(){return Y(arguments,2,10)}function A1(){return Ln(arguments,1,!1,!1)}function C1(){return Y(arguments,2,11)}function m1(){return Ln(arguments,0,!1,!1)}function d1(r,n){return xn(!0,r,n)}function O1(){return Bn(!0,arguments)}function I1(r,n,e){var r=l0(r/2);return _r(r)?r:-sr(r)*(n/ar(e))}function N1(r,n,e){return 1===e?y:n*Pn(r,e-1,2)/ar(e)}function y1(r,n){var e,t,u,i,f,o,a,c,s,_,u=0,i=0,f=0,o=0,s=0,_=m(r);if(_!==m(n))return G;for(c=0;c<_;c++)e=r[c],(t=n[c])!==A&&e!==A&&(u+=e,i+=t,f+=t*t,o+=t*e,s++);return 0===s||s*f-i*i==0?y:V(u/s-i/s*(a=(s*o-i*u)/(s*f-i*i)))}function h1(r,n,e,t){return Un(!1,r,n,e,t)}function S1(r,n){var e,t,u,i,f,o,a,c,s,c,s,e=0,t=0,u=0,i=0,f=0,o=m(n);if(o!==m(r))return G;for(a=0;a<o;a++)c=r[a],(s=n[a])===A||c===A||_r(s)||_r(c)||(e+=c=sr(c),t+=s=sr(s),u+=s*s,i+=s*c,f++);return f*u-t*t==0?y:V((f*i-t*e)/(f*u-t*t))}function R1(r,n,e,t){return Un(!0,r,n,e,t)}function D1(r,n){var e,t,u,i,f,o,a,c,s,_,v,g,u=0,i=0,f=0,o=0,a=0,c=0,s=m(r);if(s!==m(n))return G;for(_=0;_<s;_++)v=r[_],g=n[_],v!==A&&g!==A&&(u+=v,i+=v*v,f+=g,o+=g*g,a+=g*v,c++);return c*(c-2)==0||c*o-f*f==0?y:ar((c*i-u*u-(c*a-f*u)*(c*a-f*u)/(c*o-f*f))/(c*(c-2)))}function P1(r){var n,e,t,e=r,t=e+5.5;return t-=(e+.5)*cr(t),n=1.000000000190015+76.18009172947146/(r+1),cr(2.506628274631001*(n=(n=(n-=86.50532032941678/(r+2))+24.01409824083091/(r+3)-1.231739572450155/(r+4))+.001208650973866179/(r+5)-5395239384953e-18/(r+6))/e)-t}function w1(r,n,e,t,u){var r,u,t,i,f,o,u,t;return r<t||u<r||t===u?F:(r=(r-t)/(u-t),u=P1(n+e),t=P1(n),i=P1(e),f=cr(r),o=cr(1-r),u=fr(u-t-i+n*f+e*o),t=r<(n+1)/(n+e+2)?u*qr(n,e,r)/n:1-u*qr(e,n,1-r)/e,V(t))}function b1(r,n,e,t,u,i){var r;return r<u||i<r||u===i?F:(r=(r-u)/(i-u),t?Tn(r,n,e):En(r,n,e)/(i-u))}function V1(r,n,e,t,u){var i,f,o,a,c,s,_,v,g,l,p,T,M,E,A,C,m,d,e,O,I,N,y,r,h,S,n,R,D,P,w,i=2.30753,f=.27061,o=.99229,a=.04481,c=3e-308,s=1e-300,_=c,v=1-222e-18,g=5,l=6,p=2,m=un(n,e),T=r<=.5?(A=r,O=n,N=e,0):(A=1-r,O=e,N=n,1),y=ar(-cr(A*A)),R=y-(i+f*y)/(1+(o+a*y)*y),w=1<O&&1<N?(n=R*ar((e=2/((r=1/(O+O-1))+(h=1/(N+N-1))))+(y=(R*R-3)/6))/e-(h-r)*(y+5/6-2/(3*e)),O/(O+N*fr(n+n))):(h=(y=N+N)*ir(1-(h=1/(9*N))+R*ar(h),3))<=0?1-fr((cr((1-A)*N)+m)/N):(h=(4*O+y-2)/h)<=1?fr((cr(A*O)+m)/O):1-2/(h+1);for(y=1-O,h=1-N,D=0,C=1,w<_?w=_:v<w&&(w=v),P=b(s,ir(10,-13-2.5/(O*O)-.5/(A*A))),M=S=I=0;M<1e3;M++){for((R=((R=fn(w,O,N))-A)*fr(m+y*cr(w)+h*cr(1-w)))*D<=0&&(I=b(or(C),c)),d=1,E=0;E<1e3;E++){if(or(C=d*R)<I&&0<=(S=w-C)&&S<=1){if(I<=P)return V((u-t)*(w=0!==T?1-w:w)+t);if(or(R)<=P)return V((u-t)*(w=0!==T?1-w:w)+t);if(0!==S&&1!==S)break}d/=3}if(S===w)return V((u-t)*(w=0!==T?1-w:w)+t);w=S,D=R}return V((u-t)*(w=0!==T?1-w:w)+t)}function L1(r,n,e){var t,u,i,f;if(n<2*r)return L1(n-r,n,1-e);for(i=u=t=0,f=1;t<r||u<r||i<n-r;)t<r&&f<1?f*=(n-r+ ++t)/t:u<r?(u++,f*=e):(i++,f*=1-e);return f}function x1(r,n,e,t){return t*(n-r)/(r+1)*e/(1-e)}function k1(r,n,e,t){return t*r/(n-r+1)*(1-e)/e}function U1(r,n,e,t){var u,i,u,u,f,o,a,c;if(0===e&&t===r)return 1;if(0===n)return 0===e?1:0;if(1===n)return t===r?1:0;if(e===t)return L1(e,r,n);if(0===(u=e<=(u=Math.floor(r*n))&&u<=t?L1(i=u,r,n):(u=L1(e,r,n),(f=L1(t,r,n))<u?(i=e,u):(i=t,f))))return 0;for(a=o=u,c=i;c<t&&0!==(a=x1(c,r,n,a));c++)o+=a;for(a=u,c=i;e<c&&0!==(a=k1(c,r,n,a));c--)o+=a;return o}function B1(r,n,e,t){return n<r?F:t?U1(n,e,0,r):L1(r,n,e)}function G1(r,n,e){var t;return r+n-1<=0?F:(t=k(r+n-1,n-1),_r(t)?t:V(sr(t)*ir(e,n)*ir(1-e,r)))}function F1(r,n,e,t){if(r+n-1<=0)return F;if(t)return 1-Tn(1-e,r+1,n);for(var u=ir(e,n),i,i=0;i<r;i++)u*=(i+n)/(i+1)*(1-e);return u}function H1(r,n,e){for(var t,u,i,f,t=0,u=r;t+1<u;)e<=(f=U1(r,n,0,i=I((t+u)/2)))?u=i:t=i;return u}function j1(r,n){var e,t,u,i,f,o,a,c,s,r,_,_,e=cr(ar(v)),t=1/ar(v),a=0,c=r,s=.5*c,r=n%2==0;if(1<n&&(a=fr(-s)),_=g(-ar(c)),_r(_))return _;if(_=sr(_),i=r?a:2*_,2<n){if(c=.5*(n-1),f=r?1:.5,20<s){for(u=r?0:e,o=cr(s);f<=c;)u=cr(f)+u,i+=fr(o*f-s-u),f+=1;return i}for(u=r?1:t/ar(s),o=0;f<=c;)o+=u*=s/f,f+=1;return o*a+i}return i}function X1(r,n,e){return(e?On:hn)(r,n)}function Y1(r,n){var r=i0(1-r,.5*n,2);return sr(r)}function K1(n,e){return{Sl:function(r){return n-On(r,e)}}}function W1(r,n){var e,t,r,e,t={l9t:!1},r=an(K1(r,n),.5*n,n,t);return t.l9t?G:r}function Q1(r,n){var e,t,u,i,f,o,a,e=0,u=r.rowCount,i=r.colCount;if(u!==n.rowCount||i!==n.colCount)return G;if(1<u&&1<i)t=(u-1)*(i-1);else if(1<u&&1===i)t=u-1;else{if(!(1===u&&1<i))return G;t=i-1}for(f=0;f<m(r);f++)if(o=r[f],a=n[f],o!==A&&a!==A){if(0===a)return y;e+=(o-a)*(o-a)/a}return e<0?F:j1(e,t)}function z1(r,n){var e,t,u,i,f,o,a,c,s,_,r,n,v,g,l,p,T,e=U.ExcelCompatibleCalcMode?5:1,t=H(r,e,!0,!1,!1,!0),u=H(n,e,!0,!1,!1,!0),i=0,f=0,o=0,a=0,c=0,v=m(u);if(v!==m(t))return G;for(l=g=0;l<v;l++){if(p=t[l],T=u[l],_r(p))return p;if(_r(T))return T;p!==A&&T!==A&&(i+=p,f+=T,o+=p*p,a+=T*T,g++)}if(g<=1)return y;if(s=i/g,_=f/g,r=ar((g*o-i*i)/(g*(g-1))),n=ar((g*a-f*f)/(g*(g-1))),0===r||0===n)return y;for(l=0;l<v;l++)p=t[l],T=u[l],p!==A&&T!==A&&(c+=(p-s)*(T-_));return V(c/sr((g-1)*r*n))}function Z1(r,n,e){var r=fr(-n*r);return V(e?1-r:n*r)}function q1(r,n,e){var t,u,i,r,t,u,i,r=w1(n*r/(n*r+e),.5*n,.5*e,0,1);return _r(r)?r:1-sr(r)}function J1(r,n,e,t){var u;return t?1-Tn(e/(e+n*r),e/2,n/2):ir(n/e,n/2)*ir(r,n/2-1)/(ir(1+r*n/e,(n+e)/2)*An(!0,n/2,e/2))}function $1(r,n,e){var t,r,t,r=V1(1-(1-r),e/2,n/2,0,1);return _r(r)?r:(1/sr(r)-1)*(e/n)}function r0(r,n,e){var t,r,t,r=V1(1-r,e/2,n/2,0,1);return _r(r)?r:(1/sr(r)-1)*(e/n)}function n0(r){return cr((1+r)/(1-r))/2}function e0(r){var n,r,n=fr(2*r)-1,r=fr(2*r)+1;return!S(n)&&0<n&&!S(r)&&0<r?1:n/r}function t0(r,n){var e,t,e,e,r,n,t,e={N:0,M:0,Q:0,h9t:0};return vn(e,r),r=e.N-1,1===e.N||0==(t=e.Q/(e.N-1))||(e.N=0,e.M=0,e.Q=0,e.h9t=0,vn(e,n),n=e.N-1,1===e.N)||0==(e=e.Q/(e.N-1))?y:(t=q1(t/e,r,n),_r(t)?t:1<(e=2*(1-sr(t)))?2-e:e)}function u0(r,n,e,t){var t,u,i,f,o,a,c,s,_,v,g,l,p,T,M,E,g,A,C,m,d,O,I,N;if(!1===t)return t=ir(e,n),h(t)||!S(t)?y:(u=1/(t*en(n)))*(o=(i=ir(r,n-1))*(f=fr(-r/e)));if(m=1/3,d=1e8,O=1e37,N=-88,(r/=e)<=0)return F;if((I=1e3)<n)return C=v0(a=3*ar(n)*(ir(r/n,1/3)+1/(9*n)-1),0,1,!0),_r(C)?C:sr(C);if(1e8<r)return 1;if(r<=1||r<n){if(C=f0(n+1),_r(C))return C;for(l=n*cr(r)-r-sr(C),A=p=1,M=n;A+=p=p*r/(M+=1),2220446049250313e-31<p;);l+=cr(A),A=0,-88<=l&&(A=fr(l))}else{if(C=f0(n),_r(C))return C;for(l=n*cr(r)-r-sr(C),p=0,A=(s=(c=r)+(a=1))/(_=r*(E=(M=1-n)+r+1));;){if(v=(E+=2)*s-(g=(M+=1)*(p+=1))*a,0<or(g=E*_-g*c)){if(or(A-(T=v/g))<=R(2220446049250313e-31,2220446049250313e-31*T))break;A=T}a=s,c=_,_=g,or(s=v)>=O&&(a/=O,c/=O,s/=O,_/=O)}l+=cr(A),A=1,-88<=l&&(A=1-fr(l))}return A}function i0(r,n,e){var t,u,i,f,L,x,k,U,B,G,F,o,H,j,a,X,Y,K,W,Q,z,Z,q,J,$,rr,c,s,_,v,g,l,p,nr,T,er,tr,ur,M,E,A,C,m,d,O,I,N,y,h,S,R,D,P,w,p,b,V,t=4.67,u=6.66,i=6.73,f=13.32,L=60,x=70,k=84,U=105,B=120,G=127,F=140,o=1175,H=210,j=252,a=2264,X=294,Y=346,K=420,W=462,Q=606,z=672,Z=707,q=735,J=889,$=932,rr=966,c=1141,s=1182,_=1278,v=1740,g=2520,l=5040,p=5e-7,nr=.01,T=5e-7,er=20,tr,ur;if(r<2e-6)return 0;if(.999998<r)return vr;if(O=2*n,A=n-1,V=f0(n),_r(V))return V;if(m=sr(V),O<-1.24*cr(r)){if((C=ir(r*n*fr(m+.6931471805599453*n),1/n))<p)return NaN}else if(.32<O){if(V=g0(r,0,1),_r(V))return V;p=sr(V),2.2*O+6<(C=O*ir(p*ar(d=.222222/O)+1-d,3))&&(C=-2*(cr(1-r)-A*cr(.5*C)+m))}else for(C=.4,M=cr(1-r)+m+.6931471805599453*A;w=(t+2*(N=C))/(d=1+C*(t+C))-.5-(i+C*(f+3*C))/(I=C*(i+C*(u+C))),C-=(1-fr(M+.5*C)*I/d)/w,.01<or(N/C-1););for(b=1;b<=20;b++){if(V=u0(d=.5*(N=C),n,1,!0),_r(V))return V;if(w=(I=r-sr(V))*fr(.6931471805599453*n+m+d-A*cr(C)),or(N/(C+=w*(1+.5*w*(y=(210+(M=.5*w-(E=w/C)*A)*(140+M*(105+M*(84+M*(70+60*M)))))/420)-E*A*(y-E*((h=(420+M*(735+M*(966+M*(c+_*M))))/g)-E*((S=(210+M*(462+M*(707+932*M)))/g)-E*((R=(252+M*(672+s*M)+A*(294+M*(889+v*M)))/l)-E*((D=(84+a*M+A*(o+606*M))/g)-E*(P=(120+A*(346+127*A))/l))))))))-1)>T)return.5*e*C}return.5*e*C}function f0(r){return tn(r)}function o0(r,n,e,t){return r>R(n,e)||r<b(0,n-t+e)||t<n||t<e?F:Sn(r,n,e,t)}function a0(r,n,e,t,u){var i,f;if(r>R(n,e)||r<b(0,n-t+e)||t<n||t<e)return F;if(u){for(f=i=0;f<=r;f++)i+=Sn(f,n,e,t);return i}return Sn(r,n,e,t)}function c0(r,n,e){return g((cr(r)-n)/e)}function s0(r,n,e,t){var t;return t?g((cr(r)-n)/e):(t=(cr(r)-n)/e,.3989422804014327*fr(-t*t/2)/e/r)}function _0(r,n,e){var r,r,r=l0(r);return _r(r)?r:(r=sr(r),V(fr(n+e*r)))}function v0(r,n,e,t){return t?g((r-n)/e):V(fr(-(r-n)*(r-n)/(2*e*e))/(ar(2*v)*e))}function g0(r,n,e){var t,u,i,t,i,t,i=r-.5;if(or(i)<=.42)u=i*(((-25.44106049637*(t=i*i)+41.39119773534)*t-18.61500062529)*t+2.50662823884)/((((3.13082909833*t-21.06224101826)*t+23.08336743743)*t-8.4735109309)*t+1);else{if(t=r,!(2220446049250313e-31<(t=0<i?1-r:t)))return 1e-300<t?(u=-2*cr(r),t=cr(6.283185307179586*u),u=ar(u*(1-(t=t/u+(2-t)/(u*u)+(6*t-14-t*t)/(2*u*u*u)))),i<0?-u:u):i<0?-vr:vr;u=(((2.32121276858*(t=ar(-cr(t)))+4.85014127135)*t-2.29796479134)*t-2.78718931138)/((1.63706781897*t+3.54388924762)*t+1),i<0&&(u=-u)}return i=.3989422804014327*fr(-.5*(t=+u)*t),t=v0(u,0,1,!0),_r(t)?t:n+e*(u-=(t-r)/i)}function l0(r){return g0(r,0,1)}function p0(r,n){return n?on(r):fr(-ir(r,2)/2)/ar(2*v)}function T0(r,n){var e,t,u,i,f,o,a,c,s,_,e=0,t=0,u=0,i=0,f=0,o=m(r);if(o!==m(n))return G;for(c=a=0;c<o;c++)s=r[c],_=n[c],Q(s)&&Q(_)&&(e+=s,t+=_,u+=s*s,i+=_*_,f+=s*_,a++);return a*u-e*e==0||a*i-t*t==0?y:(a*f-e*t)/ar((a*u-e*e)*(a*i-t*t))}function M0(r,n){var e,t,u,i,f,o,a,c,s,_,v,v,e=0,t=0,u=0,i=0,f=0,o=0,a=m(n);if(a!==m(r))return G;for(c=0;c<a;c++)s=n[c],_=r[c],Q(s)&&Q(_)&&(e+=s,t+=_,u+=s*s,i+=_*_,f+=s*_,o++);return 0===(v=ar((o*u-e*e)*(o*i-t*t)))?y:V((v=(o*f-e*t)/v)*v)}function E0(r,n,e){var t,u,t=0;if(e)for(u=0;u<=r;u++)t+=fr(-n)*ir(n,u)/U.Functions.nkt(u);else t=fr(-n)*ir(n,r)/U.Functions.nkt(r);return V(t)}function A0(r,n,e,t){var u,i,f,o,a,c,s,u=e;if(t!==B&&(u=sr(t),h(u)))return M;if(f=i=0,(o=m(r))!==m(n))return G;for(a=0;a<o;a++)if(c=r[a],s=n[a],c!==A&&s!==A){if(s<=0||1<s)return F;e<=c&&c<=u&&(i+=s),f+=s}return 1!==f?F:i}function C0(){for(var r,n,e,t,u,i,f,o,a,c,s,_,r=arguments,n=0,e=0,t=0,f=0,s=[],o=0;o<m(r);o++)for(s.push(_=r[o]),a=0;a<m(_);a++)(c=_[a])!==A&&(n+=c,e+=c*c,f++);if(f<=2)return y;if(u=n/f,0===(i=ar((f*e-n*n)/(f*(f-1)))))return y;for(o=0;o<m(s);o++)for(_=s[o],a=0;a<m(_);a++)(c=_[a])!==A&&(t+=ir((c-u)/i,3));return V(f*t/((f-1)*(f-2)))}function m0(){for(var r,n,e,t,u,i,f,o,a,c,s,_,v,g,r=arguments,n=0,u=0,c=[],i=0;i<m(r);i++){if(a=r[i],1===m(r)&&0===m(a))return L;for(f=0;f<m(a);f++)s={value:0},(o=a[f])!==A&&"boolean"!=typeof o&&z(o,s)&&(n+=s.value,u++,c.push(s.value))}if(u<=2)return y;for(e=n/u,i=g=v=_=0;i<c.length;i++)v+=ir(g=c[i]-e,2),_+=ir(g,3);return 0===(t=ar(v/u))?y:V(_/u/t/t/t)}function d0(r,n,e){return(r-n)/e}function O0(r,n,e){var t,u,i,f,r,o,a,c,s,_;if(1!==e&&2!==e)return F;if(u=r/ar(t=n),i=t/(t+r*r),f=t-2,r=t%2,t=a=o=1,s=c=2+r,2<=f)for(_=d(c);_<=f&&(o+=a=a*i*(s-1)/s)!==t;_+=2)t=o,s+=2;return 1!=r?e*(1-(.5+.5*u*ar(i)*o)):e*(1-(.5+.3183098862*(u*i*(o=1===n?0:o)+P(u))))}function I0(r,n,e){return Rn(r,n,e?4:3)}function N0(r,n){return O0(r,n,1)}function y0(r,n){return O0(r,n,2)}function h0(r,n){var e,t,e,u,i,f,r,o,r,a,c,r,t,r,e=1e-12,r=r/2,t=r;if(1e20<n)return l0(r);if(r=t<.5?(c=0,2*t):2*((c=1)-t),or(n-2)<e)o=0<r?ar(2/(r*(2-r))-2):vr;else if(sr(n)<1+e)o=0<r?-D(f=1.5707963267948966*(r+1)):vr;else{if(i=((94.5/((e=48/((t=1/(n-.5))*t))+(u=((20700*t/e-98)*t-16)*t+96.36))-3)/e+1)*ar(1.5707963267948966*t)*n,.05+t<(a=ir(i*r,2/n))){if(r=l0(.5*r),_r(r))return r;r=sr(r),n<5&&(u+=.3*(n-4.5)*(r+.6)),a=(((((.4*(a=r*r)+6.3)*a+36)*a+94.5)/(u=(((.05*i*r-5)*r-7)*r-2)*r+e+u)-a-3)/e+1)*r,a=.002<(a*=t*a)?fr(a)-1:.5*a*a+a}else a=((1/(((n+6)/(n*a)-.089*i-.822)*(n+2)*3)+.5/(n+4))*a-1)*(n+1)/(n+2)+1/a;o=ar(n*a)}return V(o=0!==c?-o:o)}function S0(r,n){return r<.5?-Pn(1-r,n,4):Pn(r,n,4)}function R0(r,n,e,t){var u,i,f,f,o,a,c,s,_,s,v,g,l,p,T,M,E,A,C,t,t,s={N:0,M:0,Q:0,h9t:0};if(1!==e&&2!==e)return F;if(1===t){if(E=M=T=p=l=g=v=void 0,m(r)!==m(n))return G;for(A=m(r),E=0;E<A;E++)r[E]=r[E]-n[E];for(E=p=T=M=v=0;E<A;E++)p+=l=(g=(C=r[E])-p)/(M+1),T+=M*g*l,M++,v+=C;if(M-1==0||0===M)return y;if(f=ar(T/(M-1)),h(f)||!S(f))return F;f=(u=v/M)/(f/ar(M)),c=M-1}else s.N=0,s.M=0,s.Q=0,s.h9t=0,cn(s,r),o=s.Q/(s.N-1),u=s.h9t/s.N,_=s.N,s.N=0,s.M=0,s.Q=0,s.h9t=0,cn(s,n),a=s.Q/(s.N-1),i=s.h9t/s.N,s=s.N,c=2!==t?1/((t=o/_/(o/_+a/s))*t/sr(_-1)+(1-t)*(1-t)/sr(s-1)):sr(_+s-2),f=(u-i)/ar(o/sr(_)+a/sr(s));return t=_n(.5*c,.5,c/(c+(f=or(f))*f)),_r(t)?t:.5*e*sr(t)}function D0(r,n,e,t){var u=fr(-ir(r/e,n));return V(t?1-u:n/ir(e,n)*ir(r,n-1)*u)}function P0(r,n,e){var t,u,i,f,e,o,a,c,a,t,t=0,u=0,i=0,o=0;if(e!==B&&(t=sr(e),h(t)))return M;for(c=0;c<m(r);c++)(a=r[c])!==A&&(u+=a=sr(a),i+=a*a,o++);return 0===o?G:1===o||(f=u/o,0===(e=e!==B?t:ar((o*i-u*u)/(o*(o-1)))))?y:(t=g((f-n)/(e/ar(o))),_r(t)?t:V(1-sr(t)))}function w0(r,n){r=sr(d(r)),n=sr(d(n));var e=1,t;if(r<0||n<0||r<n)return F;for(t=r-n+1;t<=r;t++)e*=t;return V(e)}function b0(r,n){return xn(!1,r,n)}function V0(){for(var r,n,e,t,u,i,f,r=0,n=[],e=pn(arguments),t=m(e),u=0;u<t;u++){for(i=0,f=u+1;f<t;f++)e[u]===e[f]&&i++;r<i?(r=i,(n=[]).push([e[u]])):i===r&&n.push([e[u]])}return 0===r?G:new U.CalcArray(n)}function L0(r,n){return e([r,n],18)}function x0(r,n){return e([r,n],19)}function k0(r,n,e){return bn(!1,n,r,e)}function U0(r,n){var n,n,n=n;return 0<=r&&r<2147483647&&0<=n&&n<2147483647&&(r=Math.pow(C(r),C(n)),(n=Math.abs(r))<=179769e303)?22250738585072014e-324<=n?r:0:F}function B0(r){var n,n;return""!==r&&!0===z(r,n={value:0})?(r=.3989422804014327*Math.exp(-n.value*n.value*.5),(n=Math.abs(r))<=179769e303?22250738585072014e-324<=n?r:0:F):M}function G0(r,n,e,t){var u,i,f,o,u={value:0};return r=Z(r,u),n=z(n,i={value:0}),e=Z(e,f={value:0}),4===arguments.length&&t?t=Z(t,o={value:0}):(t=e,o=f),!0===r&&!0===n&&!0===e&&!0===t?(n=i.value,e=f.value,t=o.value,0<=(r=u.value)&&r<=2147483646&&0<=n&&n<=1&&0<=e&&e<=r&&e<=t&&t<=r?U1(r,n,e,t):F):M}function F0(r){var n,e,n;if(0<r)r=Math.exp(tn(r));else{if(0===(e=r+(n=Math.abs(C(r)))))return F;r=Math.pow(-1,n-1)*Math.exp(tn(-e))*Math.exp(tn(1+e))/Math.exp(tn(n+1-e))}return(n=Math.abs(r))<=179769e303?22250738585072014e-324<=n?r:0:F}function H0(r){r=Qr(r)-.5;var n=Math.abs(r);return n<=179769e303?22250738585072014e-324<=n?r:0:F}Object.defineProperty(r,"__esModule",{value:!0}),T=p("Common"),U=p("CalcEngine"),m=T.Common.Uf.tR,j=null,B=void 0,h=isNaN,S=isFinite,C=parseInt,ir=Math.pow,b=Math.max,R=Math.min,I=Math.floor,N=Math.sin,D=Math.tan,v=Math.PI,P=Math.atan,fr=Math.exp,or=Math.abs,ar=Math.sqrt,cr=Math.log,w=Math.round,y=U.Errors.DivideByZero,M=U.Errors.Value,G=U.Errors.NotAvailable,F=U.Errors.Number,L=U.Errors.Null,V=U.Convert.L6t,H=U.Convert.iV,d=U.Convert.z6t,sr=U.Convert.uJ,x=U.Functions.MathHelper,k=x.g9t,E=U.Convert.q8,_r=U.Convert.BJ,X=U.Functions.b9t,Y=U.Functions.y9t,e=U.Functions.w9t,g=U.Functions.dkt,K=U.Functions.G6t,W=U.Functions.OMt,Q=U.Functions.q8,vr=U.Functions.B6t,A=U.Convert.CalcConvertedError,r=U.Functions.F6t,z=U.Convert.sJ,Z=U.Convert.t9t,p={J6t:0,pkt:["< 0",">= 1"]},s={J6t:4,X6t:1,Vkt:!0,Ykt:!0,Zkt:!0,n9t:!0},lr={J6t:4,X6t:1,Vkt:!0,Ykt:!0,n9t:!0},pr={J6t:4,X6t:1,Ykt:!0,Zkt:!0},Tr={J6t:4,X6t:0,Vkt:!0},Ar={J6t:4,X6t:0,Vkt:!0,Ykt:!0,n9t:!0},Cr={J6t:4,X6t:0,Vkt:!0,Ykt:!0,Zkt:!0,n9t:!0},Or=[c={J6t:4,X6t:1,Vkt:!0,Ykt:!0,Zkt:!0},{J6t:2}],Ir=[c,u={J6t:0},{bkt:3,J6t:2,pkt:"< 1"}],Nr=[nr={J6t:0,pkt:["<= 0",">= 1"]},i={J6t:0,pkt:"<= 0"},$={J6t:2,pkt:"< 1"}],yr=[nr,i,i,er={bkt:0,J6t:0},tr={bkt:1,J6t:0}],hr=[t={J6t:2,pkt:"< 0"},t,f={J6t:0,pkt:["< 0","> 1"]},n={J6t:7}],Sr=[t,f,nr],Rr=[o={J6t:0,pkt:"< 0"},ur={J6t:0,pkt:["< 1","> 10000000000"]}],Dr=[f,rr={J6t:2,pkt:["< 1","> 10000000000"]}],Pr=[gr={J6t:4,X6t:1,Vkt:!0,Ykt:!0},gr],wr=[o,i,n],br=[o,a={J6t:0,pkt:["< 1",">= 10000000000"]},a],a=[f,a,a],Vr=[c,c],Lr=[o,i,i,n],xr=[f,i,i],kr=[f,u,i],Ur=[u,u,i,n],Mr=[Mr={J6t:4,X6t:1,Vkt:!0},Mr],Br=[t,o,n],Gr=[o,$],Fr=[Er={J6t:4,X6t:1,Vkt:!0,Ykt:!0,M9t:!0},Er,J={J6t:2},{J6t:2,pkt:["< 1","> 3"]}],Hr=[o,i,i,n],Xr=[mr={J6t:4,X6t:1,Ykt:!0,M9t:!0},{},q={bkt:!0,J6t:7},{bkt:!(jr=[c,u]),J6t:7}],Yr=[u,c,er],Kr=[dr={J6t:4,X6t:1,Vkt:!0,Ykt:!0,C9t:!0,Zkt:!0},u],r("TREND",Gn,1,4,[{J6t:4,X6t:0,Ykt:!0},{},{},q],[0,1,2],[0,1,2],{wkt:[1,2,3]}),r("GROWTH",Fn,1,4,[mr,{},{},q],"!= 3","!= 3",{wkt:[1,2,3]}),r("FORECAST",Hn,3,3,[u,c,c],"> 0","> 0"),r("AVERAGE",jn,1,B,B,-1,-1),r("STDEV",Xn,1,B,B,-1,-1),r("STDEV.S",Xn,1,B,B,-1,-1),r("PERCENTILE",Yn,2,2,B,0,0),r("PERCENTILE.INC",Yn,2,2,B,0,0),r("MAX",Kn,1,B,B,-1,-1),r("MAXA",Wn,1,B,Ar,-1,-1),r("MIN",Qn,1,B,B,-1,-1),r("MINA",zn,1,B,Ar,-1,-1),r("LARGE",Zn,2,2,Kr,0,0),r("SMALL",qn,2,2,Kr,0,0),r("AVERAGEA",Jn,1,B,Cr,-1,-1),r("MEDIAN",$n,1,B,s,-1,-1),r("MODE",r1,1,B,s,-1,-1),r("MODE.SNGL",r1,1,B,s,-1,-1),r("GEOMEAN",n1,1,B,lr,-1,-1),r("HARMEAN",e1,1,B,s,-1,-1),r("TRIMMEAN",t1,2,2,[c,p],0,0),r("FREQUENCY",u1,2,2,[pr,pr],-1,-1),r("RANK",i1,2,3,Yr,[1],[1],{wkt:2}),r("RANK.EQ",i1,2,3,Yr,[1],1,{wkt:2}),r("KURT",f1,1,B,s,-1,-1),r("PERCENTRANK",o1,2,3,Ir,0,0,{wkt:2}),r("PERCENTRANK.INC",o1,2,3,Ir,0,0,{wkt:2}),r("PERCENTRANK.EXC",a1,2,3,Ir,0,0,{wkt:2}),r("QUARTILE",c1,2,2,Or,0,0),r("QUARTILE.INC",c1,2,2,Or,0,0),r("COUNT",s1,1,B,B,-1,-1,{f9t:-1}),r("COUNTA",_1,1,B,B,-1,-1,{f9t:-1}),r("COUNTBLANK",v1,1,1,Tr,-1,-1),r("COUNTIF",g1,2,2,[Tr,Tr],[0],[0],{f9t:[1],r9t:!0}),r("AVEDEV",l1,1,B,s,-1,-1),r("STDEVA",p1,1,B,Cr,-1,-1),r("STDEVP",T1,1,B,B,-1,-1),r("STDEV.P",T1,1,B,B,-1,-1),r("STDEVPA",M1,1,B,Cr,-1,-1),r("VAR",E1,1,B,B,-1,-1),r("VAR.S",E1,1,B,B,-1,-1),r("VARA",A1,1,B,Cr,-1,-1),r("VARP",C1,1,B,B,-1,-1),r("VAR.P",C1,1,B,B,-1,-1),r("VARPA",m1,1,B,Cr,-1,-1),r("COVAR",d1,2,2,Pr,-1,-1),r("COVARIANCE.P",d1,2,2,Pr,-1,-1),r("DEVSQ",O1,1,B,s,-1,-1),r("CONFIDENCE",I1,3,3,Nr),r("CONFIDENCE.NORM",I1,3,3,Nr),r("CONFIDENCE.T",N1,3,3,Nr),r("INTERCEPT",y1,2,2,[s,s],-1,-1),r("LINEST",h1,1,4,Xr,[0,1],[0,1],{wkt:[1,2,3],o9t:1}),r("SLOPE",S1,2,2,[s,s],-1,-1,{o9t:1}),r("LOGEST",R1,1,4,Xr,[0,1],[0,1],{wkt:[1,2,3]}),r("STEYX",D1,2,2,Pr,-1,-1),r("BETADIST",w1,3,5,[u,i,i,er,tr],B,B,{wkt:[3,4]}),r("BETA.DIST",b1,4,6,[u,i,i,n,er,tr],B,B,{wkt:[5,6]}),r("BETAINV",V1,3,5,yr,B,B,{wkt:[3,4]}),r("BETA.INV",V1,3,5,yr,B,B,{wkt:[3,4]}),r("BINOMDIST",B1,4,4,hr),r("BINOM.DIST",B1,4,4,hr),r("NEGBINOMDIST",G1,3,3,[J,J,p]),r("NEGBINOM.DIST",F1,4,4,[t,$,p,n]),r("CRITBINOM",H1,3,3,Sr),r("BINOM.INV",H1,3,3,Sr),r("CHIDIST",j1,2,2,Rr),r("CHISQ.DIST.RT",j1,2,2,Rr),r("CHISQ.DIST",X1,3,3,[o,rr,n]),r("CHIINV",Y1,2,2,Dr),r("CHISQ.INV.RT",Y1,2,2,[f,$]),r("CHISQ.INV",W1,2,2,Dr),r("CHITEST",Q1,2,2,Pr,-1,-1),r("CHISQ.TEST",Q1,2,2,Pr,-1,-1),r("CORREL",z1,2,2,B,-1,-1,{o9t:1}),r("EXPONDIST",Z1,3,3,wr),r("EXPON.DIST",Z1,3,3,wr),r("FDIST",q1,3,3,br),r("F.DIST",J1,4,4,[o,ur,ur,n]),r("F.DIST.RT",q1,3,3,br),r("FINV",$1,3,3,a),r("F.INV.RT",$1,3,3,a),r("F.INV",r0,3,3,[f,rr,rr]),r("FISHER",n0,1,1,{J6t:0,pkt:["<= -1",">= 1"]}),r("FISHERINV",e0,1,1,u),r("FTEST",t0,2,2,Vr,-1,-1),r("F.TEST",t0,2,2,Vr,-1,-1),r("GAMMADIST",u0,4,4,Lr),r("GAMMA.DIST",u0,4,4,Lr),r("GAMMAINV",i0,3,3,xr),r("GAMMA.INV",i0,3,3,xr),r("GAMMALN",f0,1,1,i),r("GAMMALN.PRECISE",f0,1,1,i),r("HYPGEOMDIST",o0,4,4,[t,t,t,t]),r("HYPGEOM.DIST",a0,5,5,[t,t,t,t,n]),r("LOGNORMDIST",c0,3,3,[i,u,i]),r("LOGNORM.DIST",s0,4,4,[i,u,i,n]),r("LOGINV",_0,3,3,kr),r("LOGNORM.INV",_0,3,3,kr),r("NORMDIST",v0,4,4,Ur),r("NORM.DIST",v0,4,4,Ur),r("NORMINV",g0,3,3,kr),r("NORM.INV",g0,3,3,kr),r("NORMSDIST",g,1,1,u,B,B),r("NORMSINV",l0,1,1,f),r("NORM.S.INV",l0,1,1,f),r("NORM.S.DIST",p0,2,2,[u,n]),r("PEARSON",T0,2,2,Mr,-1,-1),r("RSQ",M0,2,2,Mr,[0,1],[0,1]),r("POISSON",E0,3,3,Br),r("POISSON.DIST",E0,3,3,Br),r("PROB",A0,3,4,[Er,gr,u],[0,1],[0,1],{wkt:3}),r("SKEW",C0,1,B,s,-1,-1),r("STANDARDIZE",d0,3,3,[u,u,i]),r("TDIST",O0,3,3,[o,$,J]),r("T.DIST",I0,3,3,[u,$,n]),r("T.DIST.RT",N0,2,2,Gr),r("T.DIST.2T",y0,2,2,Gr),r("TINV",h0,2,2,Dr),r("T.INV.2T",h0,2,2,Dr),r("T.INV",S0,2,2,[{J6t:0,pkt:["<= 0","> 1"]},rr]),r("TTEST",R0,4,4,Fr,[0,1],[0,1]),r("T.TEST",R0,4,4,Fr,[0,1],[0,1]),r("WEIBULL",D0,4,4,Hr),r("WEIBULL.DIST",D0,4,4,Hr),r("ZTEST",P0,2,3,jr,0,0,{wkt:2}),r("Z.TEST",P0,2,3,jr,0,0,{wkt:2}),r("PERMUT",w0,2,2),r("COVARIANCE.S",b0,2,2,Pr,-1,-1),r("MODE.MULT",V0,1,B,lr,-1,-1),r("PERCENTILE.EXC",L0,2,2,[c,nr],0,0),r("QUARTILE.EXC",x0,2,2,[Ar,J],0,0),r("RANK.AVG",k0,2,3,Yr,1,1,{wkt:2}),r("PERMUTATIONA",U0,2,2,[u,u]),r("PHI",B0,1,1),r("BINOM.DIST.RANGE",G0,3,4,[{bkt:0},{bkt:0},{bkt:0}]),r("GAMMA",F0,1,1,i),r("GAUSS",H0,1,1,u),r("SKEW.P",m0,1,B,Cr,-1,-1)},CalcEngine:function(r){r.exports=f("@spreadjs/js-calc")},Common:function(r){r.exports=f("@spreadjs/js-sheets-common")}},t={},n=r={},Object.defineProperty(n,"__esModule",{value:!0}),n.Functions=void 0,u=i("CalcEngine"),Object.defineProperty(n,"Functions",{enumerable:!0,get:function(){return u.Functions}}),i("./src/functions-db.ts"),i("./src/functions-eng.ts"),i("./src/functions-fin.ts"),i("./src/functions-lookup.ts"),i("./src/functions-stat.ts"),(((o={}).Spread=o.Spread||{}).CalcEngine=o.Spread.CalcEngine||{}).AdvancedFunctions=r}(),r.exports=o.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@spreadjs/js-calc-advancedfunctions/index.js":(r,n,e)=>{r.exports=e("./node_modules_local/@spreadjs/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"@spreadjs/js-sheets-common":r=>{"use strict";r.exports=GC.Spread},"@spreadjs/js-calc":r=>{"use strict";r.exports=GC.Spread.CalcEngine}},t={},r=u("./node_modules_local/@spreadjs/js-calc-advancedfunctions/index.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).CalcEngine=GC.Spread.CalcEngine||{}).AdvancedFunctions=r})();
;var GC;(function(n){var t;(function(){var n=window,i,t;try{for(i=[n.jQuery,n.Forguncy],t=0;t<i.length;t++)if(!i[t]){n.GC=null;break}n.GC&&$("#pageCover").length!==1&&(n.GC=null)}catch(r){n.GC=null}})(t=n.Spread||(n.Spread={}))})(GC||(GC={}))
;var GC;!function(){var n,i,t;function r(t){var e,e,e=i[t];return void 0!==e||(e=i[t]={exports:{}},n[t].call(e.exports,e,e.exports,r)),e.exports}n={"./dist/core/celltype/basecelltype.js":function(e,s,t){"use strict";var c,v,ht,dt,g,z,n,l,h,d,p,t,W,o,J,Ct,Z,vt,b,C,Q,U,nt,y,F,M,T,X,q,$,P,tt,S,N,x,gt,B,mt,pt,yt,St,i,u,wt,Mt,k,R,I,E,r,H,_,A,G,L,a,D;function et(t){var e=t.isPrinting,t=t.printZoomFactor;return e&&typeof t===S&&1!==t}function j(t){var e;return!(t instanceof CanvasRenderingContext2D)&&!y(t._ae)}function O(t,e){var n,i,r,n=0,i=t.font+e,r=!j(t);return r&&R[i]?n=R[i]:(n=Q(t,t.font,e),r&&(R[i]=n)),n}function w(){}function V(t,e){var n;return e/2-t/2+(8<t?gt((t-8)/5+2):1)-1}function Y(t,e,n){return W(t.x)||(t.x+=e.width),t.width=t.width-e.width-n.width,t}function it(t,e,n,i,r){var o,a,o=n+" - "+e+" - "+t;return s.wordWrapInfoCache||(s.wordWrapInfoCache={}),a=2e3,y(s.clearCacheTimer)&&(s.clearCacheTimer=setTimeout(function(){s.wordWrapInfoCache=null,s.clearCacheTimer=null},a)),s.wordWrapInfoCache[o]||(s.wordWrapInfoCache[o]=ht.q.un(t,e,n,!1,r)),s.wordWrapInfoCache[o]}function rt(t,e){return dt.W.gfe(t,z.IconPosition.left)&&(e+=1),dt.W.gfe(t,z.IconPosition.right)&&(e+=2),e}function ot(t,e){return dt.W.gfe(t,z.IconPosition.left)&&--e,dt.W.gfe(t,z.IconPosition.right)&&(e-=2),e}function kt(t,e,n,i,r,o){var e=new ht.Rect(t?t.x:e+1,t?t.y:n+1,t?t.width:i-2,t?t.height:r-2);return e=o?e.getIntersectRect(o):e}function K(t,e,n){var t=t.text;return(t=n?(0,ht.r2e)(t):t)===e}function at(t){return t&&(ht.util.Yf(t)||ht.util.eHe(t))}function st(t,e){var n="inherit";return n=t===z.TextDirectionType.rightToLeft||t===z.TextDirectionType.context&&at(e)?"rtl":n}function f(){this.allowOverflow=!1,this.typeName="0"}function ut(t,e,n,i){var r,o,r=t.conditionalFormats;return r&&(o=t.getValue(e,n,i),r.O(e,n,i))&&r.U(t,e,n,o,i).iconSet}function ct(t,e,n){for(var i,r,o,i=0,r=0;r<t.length;r++)o=void 0,o=t[r].style&&t[r].style.font?t[r].style.font:e,i=Math.max(J(o,x,Z(t[r].text))/n,i),(t[r].style&&1===t[r].style.vertAlign||2===t[r].style.vertAlign)&&(i=Math.max(J(o,x,Z(t[r].text))/n+2*dt.W.V(o,k).fontSize*.218,i));return i}function ft(t,e,n,i,r){var o,a,s,u,c,f,o=ht.q.J();if(!o)return 0;for(s=a=0;s<t.length;s++)u=void 0,u=t[s].style&&t[s].style.font?t[s].style.font:e,t[s].style&&t[s].style.vertAlign&&(u=dt.W.V(u,k).font),vt(o,u),c="",c=s===t.length-1&&r?ht.q.tt(t[s].text):t[s].text,f=0,i?f=J(u)*c.length/n:W(t[s].text)||(f=Q(o,u,t[s].text)/n),a+=f;return a}function lt(t,e,n,i,r){var o,a,s,o;if(!ht.q.J())return 0;for(s=a=0;s<t.length;s++)a+=ft(t[s],e,n,i,r);return a}function Tt(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,v,g,m,p,S,u,a,g,m,w,b,C,y,M,k,p,S,c=a.backColor,f=a.backgroundImage,l=a.textOrientation,h=a.isVerticalText,d=a.textIndent&&0!==a.textIndent,v=a.backgroundImageLayout,g=u.row,m=u.col,p=u.sheet,S=p.Jt,u=u.sheet&&u.sheet.getSpan(g,m,u.sheetArea),a=a&&(a.borderLeft||a.borderTop||a.borderRight||a.borderBottom),w=0,b=e;t.save(),m+1<p.getColumnCount()&&(M=S.qt(g,m+1)),0<=m-1&&(k=S.qt(g,m-1)),p=function(t){return t!==x&&t&&-90<=t&&t<=90},S=function(){t.fillRect(e,n,i,r)},l&&0!==l&&a&&s&&!u&&!h&&!d&&(g=St(l*Math.PI/180),m=yt(g),w=gt(r/m),-90<l&&l<0&&(M&&!p(M.textOrientation)&&(y=M.backColor),b=e-w),0<l&&l<90&&(k&&!p(k.textOrientation)&&(y=k.backColor),b=e+w),C=function(){t.beginPath(),t.moveTo(b,n),t.lineTo(b+i,n),t.lineTo(e+i,n+r),t.lineTo(e,n+r),t.fill()}),(c||f)&&(y&&dt.W.setFillStyle(t,y,e,n,i,r,S),C?dt.W.setFillStyle(t,c,Math.min(b,e),n,i+w,r,C):c&&dt.W.setFillStyle(t,c,e,n,i,r,S),G.nt(t,e,n,i,r,f,v,o)),t.restore()}function xt(t,e,n,i,r,o,a){var t;(0===t||5===t||a)&&ut(e,n,i,r)&&(t=Gt(e),o.x+=t,o.width-=t)}function Gt(t){return parseInt(P*t.zoom(),10)}function bt(t,e,n,i){var r=t.cellPadding,o=0,t=t.labelOptions;return(r=n?t?t.margin:"0":r)&&(o=typeof(o=parseInt(Ht(r)[e],10))===S&&0<o?o:0),i===x?o:o*i}function Bt(t){var e={context:t,value:0};return a.et(t.sheet,"getOutlineColumnOffset",e),e.value}function It(t,e){var e={context:t,value:0,cellStyle:e};return a.et(t.sheet,"getCellButtonAutoWidth",e),e.value}function Pt(t,e){var e={context:t,value:0,cellStyle:e};return de(e),a.et(t.sheet,"getSpecialIconsAutoWidth",e),e.value}function Rt(t,e){var e={context:t,value:0,cellStyle:e};return a.et(t.sheet,"getCellButtonAutoHeight",e),e.value}function Nt(t,e){var e={context:t,value:0,cellStyle:e};return ve(e),a.et(t.sheet,"getSpecialIconsAutoHeight",e),e.value}function Et(t,e,n,i){var r,i,r,e,o,r=i&&i.sheet;r&&n&&(i=i.canvasOffset||r.rt.it(),r=r.ot(),(e=(e=e.backColor||"white").stops?(o=e.stops)[0]&&o[0].color:e).backgroundColor&&(e=e.backgroundColor),(0,v.GC$)(t).width(n.width).height(n.height).css({top:i.top+r.y+n.y-2,left:i.left+r.x+n.x-2,"background-color":e}))}function Ht(t){var e,t,n,i,r,e=["0","0","0","0"];return typeof t===tt&&(r=i=void 0,1===(n=(t=t.split(" ",4)).length)?e=[i=t[0],i,i,i]:2===n?e=[i=t[0],r=t[1],i,r]:3===n?(r=t[1],e=[t[0],r,t[2],r]):4===n&&(e=[t[0],t[1],t[2],t[3]])),e}function Ut(t,e){var n,i,r,o,a,n=bt(t,0),i=bt(t,2),r=bt(t,0,!0),o=bt(t,2,!0);if(!(bt(t,3,!0)+bt(t,1,!0)>=e.width))if(0===(a=(a=t.labelOptions.alignment)===x?t.labelOptions.alignment=0:a)||1===a||2===a){if(0<n&&r+o<n)return 1}else if((3===a||4===a||5===a)&&n<e.height&&0<i&&r+o<i)return 1}function Ft(t,e){var n,i,r,o,a,n=bt(e,0),i=bt(e,3,!0),r=bt(e,2,!0),o=t.clone(),a=e.labelOptions.alignment;return 0===a||1===a||2===a?n<t.height&&(o.height=n-r+1):3!==a&&4!==a&&5!==a||(o.height=t.height-r),o.x+=i,o.width-=i+bt(e,1,!0),o}function _t(t){var e="left";return 1===t||4===t?e="center":2!==t&&5!==t||(e="right"),e}function At(t,e,n,i){var r,n,o,a,s,u,c,t,f,l,h,i,d,v,r=new ht.Point(t.x,t.y),n=parseInt(n.fontSize,10),o=bt(e,0),a=bt(e,2),s=bt(e,3,!0),u=bt(e,1,!0),c=t.width,t=t.height,f,l,h=8<n?1:2,i=i-(i/2-n/2+(8<n?Math.floor((n-8)/5+2):1)-1)+bt(e,0,!0),d=i+1,v=t<o+a?o+i:t-a+i-1;switch(e.labelOptions.alignment){case 0:r.x+=s+h+1,r.y+=d;break;case 1:r.x+=s+(c-s-u)/2,r.y+=d;break;case 2:r.x+=c-u-2,r.y+=d;break;case 3:r.x+=s+h+1,r.y+=v;break;case 4:r.x+=s+(c-s-u)/2,r.y+=v;break;case 5:r.x+=c-u-2,r.y+=v}return r}function Lt(t,e){var n,i,r,o,a,s,n=bt(e,3,!0),i=bt(e,1,!0),r=bt(e,0,!0),o=bt(e,2,!0),a=t.clone(),s=e.labelOptions.alignment;return a.x=n+1,a.width-=n+i,0===s||1===s||2===s?(a.y=r,a.height=bt(e,0)-r-o):3!==s&&4!==s&&5!==s||(a.y=t.height-bt(e,2)+r,a.height=bt(e,2)-r-o),2!==s&&5!==s||(a.width-=2),a}function Dt(t,e,n){var i,r;if(o(e,tt))return O(t,e);if(n&&e&&e[0]&&e[0].value)return e[0].value.length*J(t.font);for(r=i=0;r<e.length;r++)"fillingChar"!==e[r].type&&(i+=O(t,e[r].value));return i}function jt(t){for(var e,n,i,r,o,e=t[0].type,n=0,i=[t[0]],r=1;r<t.length;r++)o=t[r],e===u&&o.type===u?i[n].value+=o.value:(i.push(o),e=o.type,n++);return i}function Ot(t,e,n,i,r){var i,i=i?Math.floor(e/r):Math.floor(e/Q(t,t.font,n));return new Array(i+1).join(n)}function Vt(t){var t=t.clone();return t.width--,t.height--,t}function Yt(t,e,n,i){for(var r,o,a,r=0;r<t.length;r++)o=void 0,t[r].style=t[r].style||{},(a=t[r].style).font?(o=dt.W.V(a.font,n).font,W(i)||(o=dt.W.V(o,i).font)):o="object"==typeof e?e.font:e,a.font=o}function Kt(t,e,n,i,r){var o=n*pt(-i)+r*mt(-i),n=n*pt(-i)+r*mt(-i),a,s;return new ht.Rect(t-o/2,e-n/2,o,n)}function zt(t){return"string"==typeof t.src&&0<t.src.length&&-1===t.src.indexOf("<script")}function Wt(t,e,n,i){var r,r,r,o;y(n)||(a.et(i.sheet,"beforePaintDecoration",o={context:i,style:n}),null!=(r=n.decoration)&&r.cornerFold&&Jt(t,e,n.decoration.cornerFold,i),0<(null==(r=null==(r=n.decoration)?void 0:r.icons)?void 0:r.length)&&Zt(t,e,n.decoration.icons.filter(zt),n.vAlign,i))}function Jt(t,e,n,i){var r,o,n,a,s,u,e,c,r,i,n,f,l,h,d,r=n.size,o=n.position,n=n.color;y(r)&&(r=6),y(o)&&(o=g.CornerPosition.leftTop),a=e.x,s=e.y,u=e.height,e=e.width,r=r*(c=i.sheet).zoom(),t&&0<e&&0<u&&(t.save(),t.rect(a,s,e,u),t.clip(),t.fillStyle=n||"#FF3D00",t.beginPath(),t.fillStyle=n,d=h=l=f=n=i=void 0,o&g.CornerPosition.leftTop&&(f=i=a,l=(n=s)+r,h=i+r,d=n,t.moveTo(i,n),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&g.CornerPosition.rightBottom&&(l=(n=s+u)-r,h=(f=i=a+e)-r,d=n,t.moveTo(i,n),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&g.CornerPosition.leftBottom&&(f=i=a,l=(n=s+u)-r,h=i+r,d=n,t.moveTo(i,n),t.lineTo(f,l),t.lineTo(h,d),t.fill()),o&g.CornerPosition.rightTop&&(l=(n=s)+r,h=(f=i=a+e)-r,d=n,t.moveTo(i,n),t.lineTo(f,l),t.lineTo(h,d),t.fill()),t.closePath(),t.restore())}function Zt(t,e,n,i,r){var o,n,a,a,s,u,c;!r.cellOverflowLayout&&0<n.length&&(o=n.filter(function(t){return y(t.position)||t.position===z.IconPosition.left}),n=n.filter(function(t){return t.position===z.IconPosition.right}),0<(a=o.concat(n)).length)&&(le(a,r),t)&&(a=he(e.clone(),r),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),u=s=a.x,c=a.x+a.width,0<o.length&&(u=s=ee(t,o,a,i,r)),0<n.length&&(c=s=$t(t,n,a,i,r)),t.restore(),e.width=e.x+e.width-(a.x+a.width-c)-u,e.x=u)}function Qt(t,e,n,i,r){var o,n,a,s;t&&0<n.length&&(o=n.filter(function(t){return t.position===z.IconPosition.outsideLeft&&zt(t)}),n=n.filter(function(t){return t.position===z.IconPosition.outsideRight&&zt(t)}),a=3,s=e.x,0<o.length||0<n.length)&&(le(o,r),le(n,r),2===r.columnHeaderFitMode&&r.cornerX&&((e=e.clone()).height=e.height-(r.cornerY-e.y)-1,e.y=r.cornerY-1),0<o.length&&(e.x=s-3,Xt(t,o,e,i,r)),0<n.length)&&(e.x=s+3,qt(t,n,e,i,r))}function Xt(t,e,n,i,r){te(t,e,n.x,n,i,r)}function qt(t,e,n,i,r){ne(t,e,n.x+n.width,n,i,r)}function $t(t,e,n,i,r){return te(t,e,n.x+n.width,n,i,r)}function te(t,e,n,i,r,o){var a,s,u,c,a,s;for(n-=ce(o),u=e.length-1;0<=u;u--)n-=c=m(o,e[u],"width"),re(t,e[u],n,i.y,c,i.height,o,i,r);return n}function ee(t,e,n,i,r){return ne(t,e,n.x,n,i,r)}function ne(t,e,n,i,r,o){var a,s,u,c,a,s;for(n+=ce(o),u=0;u<e.length;u++)c=m(o,e[u],"width"),re(t,e[u],n,i.y,c,i.height,o,i,r),n+=c;return n}function ie(t,e){var n,i,r,o,e,a,t,s,s,e,n=e.ctx,i=e.style,r=e.context,o=e.textRect,e=e.availRect;!y(i.decoration)&&n&&(a="beforeFillTextArea"===t?z.IconPosition.leftOfText:z.IconPosition.rightOfText,t=i.decoration.icons&&i.decoration.icons.filter(function(t){return t.position===a&&zt(t)}))&&0<t.length&&(le(t,r),2===r.columnHeaderFitMode&&r.cornerX&&(s=r.cellRect.x+r.cellRect.width-(e.x+e.width),(e=e.clone()).width=r.cornerX-e.x-s,e.height=e.height-(r.cornerY-e.y)-1,e.y=r.cornerY-1),s=void 0,e=se(e,o,a),n.save(),n.rect(e.x,e.y,e.width,e.height),n.clip(),n.beginPath(),a===z.IconPosition.leftOfText?(s=$t(n,t,e,i.vAlign,r),o.x=s):(s=ee(n,t,e,i.vAlign,r),o.width=s-o.x),n.restore())}function re(t,e,n,i,r,o,a,s,u){var c,f,l,n,r,o,h,u,e,a,e,h,i,d;t.save(),t.beginPath(),t.rect(n,i,r,o),t.clip(),c=0,f=fe(a),l=e.src,f.getState(l)?f.qh(l)&&(n=new ht.Rect(n,i,r,o),r=m(a,e,"width"),o=m(a,e,"height"),u=ue(n,h=new ht.Rect(0,0,r,o),u,ce(a)),e.position!==z.IconPosition.leftOfText&&e.position!==z.IconPosition.rightOfText||((e=a.textRect)&&(u.y=wt(e.y-e.height/2-h.height/2,i+4)),u.y+u.height>n.y+n.height&&(u.y=wt(u.y-(u.y+u.height-n.y-n.height),n.y))),e=(a=f.getImage(l)).width,h=a.height,ht.mt.Tt.msie&&(E[l]||(a.style.position="absolute",a.style.left="-10000px",a.style.top="-100000px",document.body.appendChild(a),E[l]={width:a.width,height:a.height},document.body.removeChild(a)),e=E[l].width,h=E[l].height),s&&ht.mt.Tt.msie&&u.x+u.width>s.x+s.width?0<(i=c=s.x+s.width-u.x)&&t.drawImage(a,0,0,i*(d=e/r),h,B(u.x),B(u.y),i,o):(c=r,t.drawImage(a,0,0,e,h,B(u.x),B(u.y),c,o))):f.addImage(l,"anonymous"),t.restore()}function oe(t){var e=t.context,n=t.style,t=t.externals;dt.W.Xue(n)&&(t.left=t.left.concat(ae(e,n,z.IconPosition.leftOfText)),t.right=t.right.concat(ae(e,n,z.IconPosition.rightOfText)))}function ae(e,t,n){for(var i,r,o,a,i=!1,r=0,o=t.decoration.icons;r<o.length;r++)if((a=o[r]).v_i){i=!0;break}return t.decoration.icons.filter(function(t){return t.position===n&&(!e.cellOverflowLayout||i)}).map(function(t){return{width:m(e,t,"width"),height:m(e,t,"height"),isStick:t.v_i}})}function se(t,e,n){switch(n){case z.IconPosition.leftOfText:return new ht.Rect(t.x,t.y,e.x-t.x,t.height);case z.IconPosition.rightOfText:return new ht.Rect(e.x+e.width,t.y,t.x+t.width-e.x-e.width,t.height)}}function ue(t,e,n,i){var r,o=2*i;switch(n){case z.VerticalAlign.top:r=0+o;break;case z.VerticalAlign.bottom:r=Math.max(0,t.height-e.height)-o;break;default:r=Math.max(0,(t.height-e.height)/2)}return new ht.Rect(t.x,t.y+r,Math.min(e.width,t.width),Math.min(e.height,t.height))}function ce(t){return et(t)?t.printZoomFactor:t.sheet.zoom()}function m(t,e,n){var e=e[n],n=ce(t);return(e=y(e)||isNaN(e)||e<=0?12:e)*n}function fe(t){var e=t.sheet,n;return e.MC||t.imageLoader||e.BO()}function le(t,e){for(var n,i,r,n=fe(e),i=0;i<t.length;i++)(r=t[i].src)&&n.addImage(r,"anonymous")}function he(t,e){return 2===e.columnHeaderFitMode&&e.cornerX&&(t.width=e.cornerX-t.x,t.height=t.height-(e.cornerY-t.y)-1,t.y=e.cornerY-1),t}function de(t){ge(t,"width")}function ve(t){ge(t,"height")}function ge(t,e){var n,i,r,o,a,n=t.cellStyle;if(n.decoration&&n.decoration.icons&&0!==n.decoration.icons.length){for(i=n.decoration.icons,o=r=0;o<i.length;o++)a=i[o],dt.W.Kue(a)&&(r+=m(t.context,a,e));t.value=r}}function me(t,e,n){var e,i,t,r,o,n,i,e=(t.length-1)*e,i=t[0],t=t[t.length-1],r,o=document.createElement("canvas").getContext("2d");return o.font=n.font,n=o.measureText(i),i=o.measureText(t),{height:e=n.actualBoundingBoxAscent+i.actualBoundingBoxDescent+e,descenderHeight:i.actualBoundingBoxDescent}}function pe(t,e,n,i,r,o,a,s){var u,c,f,l,h,u=n.content;if(u&&0<u.length)for(l=0<(l=o-a-(f=Dt(t,u,!0))-2)?l:0,h=void 0,c=0;c<u.length;c++)"fillingChar"===u[c].type||"numberPlaceholder"===u[c].type?r+=l:"placeholder"===u[c].type?r+=u[c].value?u[c].value.length*s:0:r+=h=u[c].value?u[c].value.length*s:0;else if(e)for(c=0;c<e.length;c++)r=Se(t,e[c],i,r).y;return r}function Se(t,e,n,i){var t,r,o,a;if(e&&0<e.length)for(t=t.font,r=J(t,x,Z(e)),o=V(dt.W.V(t,1).fontSize,r),a=0;a<e.length;a++)i=i+r-o,i+=o;return{x:n,y:i}}Object.defineProperty(s,"__esModule",{value:!0}),s.Context=s.Base=s.paintStyleDecorationOutSideIcons=s.paintDecoration=s.cellTypeContext_paintBackground=s.clearCacheTimer=s.wordWrapInfoCache=s.isPrintZoomFactorExist=void 0,c=t("Common"),v=t("./dist/core/util/domUtil.js"),ht=t("./dist/core/util/common.js"),dt=t("./dist/core/worksheet/stylehelper.js"),g=t("./dist/core/core.interface.js"),z=t("./dist/core/core.enum.js"),n=t("./dist/core/celltype/celltype.ns.js"),l=t("CalcEngine"),h=c.Common.CultureManager,d=c.Common.st,p=c.Common.ct,t=c.Common.lt,W=t.ht,o=t.dt,J=ht.mt.vt,Ct=ht.mt.gt,Z=ht.mt.pt,vt=ht.mt.bt,b=ht.mt.yt,C=ht.mt.wt,Q=ht.mt.Mt,U=ht.mt.Ct,nt=ht.mt.St,y=c.Common.lt.ht,F=v.GC$.extend,M=ht.mt.Tt,T="left",X="right",q="center",$="alphabetic",P=16,tt="string",S="number",N=null,x=void 0,gt=Math.floor,B=Math.ceil,mt=Math.sin,pt=Math.cos,yt=Math.tan,St=Math.abs,i="General",u="text",wt=Math.max,Mt=Math.min,k=.7,R={},I="...",E={},H=" ",_=new RegExp(r="\xa0","g"),D=A={top:0,0:"top",right:1,1:"right",bottom:2,2:"bottom",left:3,3:"left"},s.isPrintZoomFactorExist=et,w.At=function(t){var t,e,n,t=t.split("e")[1];if(t&&0<t.length&&("+"===t[0]?e=!0:"-"===t[0]&&(e=!1),n=t.slice(1)),void 0!==e)return{isAdd:e,length:n}},w.It=function(t,e,n){var i,r,i=w.xt,r=i[e+n];return r||(r=Q(t,e,n),i[e+n]=r),r},w.Nt=function(t,e,n,i,r){var o,r,a,a,r,a,s,u,u,c,s,f,a,l,h,o,d,v,g,m,p,o=i.font;if(n=n-1-ot(i,3)*r,r=i.textIndent&&0!==i.textIndent,a=i.isVerticalText,typeof e!==S||!0===i.shrinkToFit||a||r)return i._autoFormatter;if(a=e<0,e=St(e),r=a?w.It(t,o,"-"):0,a=e.toString(),(s=w.At(a))&&!1===s.isAdd&&(u=ht.mt.toPlainString(e)).split(".")[1].length<10&&(a=u,s=x),u=void 0,c=w.Dt(i._autoFormatter,e),s)return u=s.length.toString().length,u=wt(u,2),w._t(t,n,i,u,r,s.isAdd,c);if(s=r,f=w.It(t,o,"0"),a=a.split("."),s+=h=f*(l=Math.round(e).toString().length),o=w.It(t,o,"."),d=void 0,h<=n){if(!a[1]||0===a[1].length)return i._autoFormatter;if((s=s+a[1].length*f+o)<=n)return i._autoFormatter;if(e<.001)return u=a[1].length.toString().length,u=wt(u,2),w._t(t,n,i,u,r,!1,c);for(g=Math.floor((v=n-r-h-o)/f),d="0",0<(g=Math.min(g,a[1].length))&&(d+="."),m=0;m<g;m++)d+="0";return d}return u=(p=Math.round(e)).toString().length.toString().length,u=wt(u,2),w._t(t,n,i,u,r,!0,c)},w._t=function(t,e,n,i,r,o,a){var n,s,u,c,f,l,h,e,r,d,v,g,n=n.font,s=w.It(t,n,"0"),u=w.It(t,n,"E"),c=w.It(t,n,"+"),f=w.It(t,n,"-"),l,h,e=e-r-i*s-u-(o?c:f)-s,r=e-w.It(t,n,".");if(r<=s)return o?"0E+00":0<e?"0E-00":"0";for(d=Math.floor(r/s),d=Math.min(d,a),v="0",g=0;g<d;g++)0===g&&(v+="."),v+="0";return v+=o?"E+00":"E-00"},w.Et=function(t,e,n,i,r){var o,r,a,s,u,i,c,f,l,o=i.font;if(n=n-1-ot(i,3)*r,r=i.textIndent||0,s=n,(s=1!==(a=i.hAlign)&&0<r?n-8*r:n)<(u=Q(t,o,e))){for(i=w.It(t,o,"#"),c=Math.floor(n/i),f="",l=0;l<c;l++)f+="#";return f}return e},w.nt=function(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v,g,m,p,S,w;if(o&&"none"!==o&&s)try{s.getState(o)?(u=s.getImage(o),c=void 0,M.msie&&((c=document.createElement("div")).appendChild(u),document.body.appendChild(c)),f=u.width,l=u.height,M.msie&&(c.removeChild(u),document.body.removeChild(c)),d=h=0,v=f,g=l,m=i,p=r,S=e,w=n,1===a?(v=f<=i?f:i,g=l<=r?l:r,S=f<i&&0<f?B(e+i/2-f/2):e,w=l<r&&0<l?B(n+r/2-l/2):n,m=v,p=g):2===a?0<r&&0<l&&f/l<i/r?S=e+i/2-(m=f/l*r)/2:0<i&&0<f&&l/f<r/i&&(w=n+r/2-(p=l/f*i)/2):3===a&&(m=v=f<=i?f:i,p=g=l<=r?l:r),t.drawImage(u,0,0,v,g,S,w,m,p)):s.addImage(o)}catch(t){}},w.Bt=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,S,b,C,y,M,y,k,T,x,M,t,y,G,B,I,t,o=0,a=r&&r.sheet,s=r.sheetArea,u=r.row,c=r.col,f=n.textIndent,l=n.hAlign,h=n.isVerticalText,d,v=1===s&&1===a.Lt(c)?-90:n.textOrientation,g=n.borderTop||n.borderBottom||n.borderLeft||n.borderRight,w=n.font;if(v&&-90<=v&&v<=90&&(S=St(v*Math.PI/180),p=mt(S),S=pt(S)),a&&typeof e===tt&&e)if(b=[],C=void 0,t&&t.richText)if(t={text:(t=t.converted?t:ht.util.g0(t)).text,richText:t.converted},y=n.formatter||n._autoFormatter,y=(M=a.getCellType(u,c,s)).Ft(y,t.text),Yt(C=F(!0,[],M.Pt(t,e,y,w,n.foreColor)),w,i),h)if(n.wordWrap||5===l){if(k=a.Gt(u,s),(T=a.getSpan(u,c,s))&&T.row>=u&&T.col>=c&&1<T.rowCount)for(x=u+1;x<u+T.rowCount;x++)k+=a.Gt(x,s);for((M=0)<f&&(M=8*f*i),0<(t=bt(n,0))&&(k-=t),0<(y=bt(n,2))&&(k-=y),k++,b=ht.q.Ht((0,ht.r2e)(e),k-ot(n,3)-M,w,C,h),m=0;m<b.length;m++)o+=ct(b[m].textInfos,w,i)}else o=ct(C,w,i);else{if(n.wordWrap||5===l){for(G=(0,ht.r2e)(e).split(/\r\n|\r|\n/),m=0;m<G.length;m++)b.push((0,ht.zt)(G[m]));for(b=ht.q.Vt(b,ht.q.Yt(C)),m=0;m<b.length;m++)o=Math.max(o,lt(b[m],w,i,h,!0))}else o=ft(C,w,i);0<f&&4!==l&&(o+=1===l||5===l?8*f*2:8*f),ut(a,u,c,r.sheetArea)&&(o+=Gt(a))}else if(b=(0,ht.r2e)(e).split(/\r\n|\r|\n/),I=J(B=w)/i,h)if(n.wordWrap||5===l)for(m=0;m<b.length;m++)o+=I;else o=I;else{if(n.wordWrap||5===l){if(v)return t=a.Gt(u,s),ht.q.Zt(u,c,p,S,e,B,t);for(m=0;m<b.length;m++)o=Math.max(o,ht.q.Wt(b[m],B,!0)/i)}else o=v?g?(4+I)/p:S*(a.Qt(e,B)/i)+I*p:4===n.hAlign?a.Jt.Kt(c,s):a.Qt(e,B)/i;0<f&&4!==l&&(o+=1===l||5===l?8*f*2:8*f),ut(a,u,c,r.sheetArea)&&(o+=P)}return o},w.Xt=function(t,e,n,i){for(var r,o,a,s,r=t.Jt.Kt(n,i),o=n+1;o<t.getColumnCount(i)&&(a=t.Jt.qt(e,o,i),s=t.Jt.$t(e,o,i,1,{style:a}),y(s))&&!a.watermark&&!(a.cellType&&"1"!==a.cellType.typeName||a.cellButtons&&0<a.cellButtons.length||dt.W.Jue(a))&&4===a.hAlign;o++)r+=t.Jt.Kt(o,i);return r},w.tn=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,h,x,G,B,h,I,h,T,P,T,R,P,N,E,l,H,f,o=0,s=r&&r.sheet,u=n.font,c=n.isVerticalText,f=n.textIndent,l=n.vAlign,h=n.hAlign,d=n.textOrientation,v=r.row,g=r.col,m=r.sheetArea,B=0<f?8*f*i:0;if(1!==h&&5!==h||(B*=2),d&&-90<=d&&d<=90&&(h=St(d*Math.PI/180),x=mt(h),G=pt(h)),s&&typeof e===tt&&e)if(I=[],h=void 0,t&&t.richText)if(t={text:(t=t.converted?t:ht.util.g0(t)).text,richText:t.converted},T=n.formatter||n._autoFormatter,T=(P=s.getCellType(v,g,m)).Ft(T,t.text),Yt(h=F(!0,[],P.Pt(t,e,T,u,n.foreColor)),u,i),c){if(n.wordWrap||5===n.hAlign){for(R=(0,ht.r2e)(e).split(/\r\n|\r|\n/),a=0;a<R.length;a++)I.push((0,ht.zt)(R[a]));for(I=ht.q.Vt(I,ht.q.Yt(h)),a=0;a<I.length;a++)o=Math.max(o,lt(I[a],u,i,c,!0))}else o=ft(h,u,i,c);0<f&&(o+=1===l?8*f*2:8*f)}else if(n.wordWrap||5===n.hAlign){if(p=s.nn(g,m),(b=s.getSpan(v,g,m))&&b.row>=v&&b.col>=g&&1<b.colCount)for(C=g+1;C<g+b.colCount;C++)p+=s.nn(C,m);for(M=bt(n,1),0<(k=bt(n,3))&&(p-=k),0<M&&(p-=M),p++,I=ht.q.Ht((0,ht.r2e)(e),p-ot(n,3)-B,u,h),a=0;a<I.length;a++)o+=ct(I[a].textInfos,u,i)}else o=ct(h,u,i);else if(P=n.font,N=J(P)/i,c){if(n.wordWrap||5===n.hAlign)for(I=(0,ht.r2e)(e).split(/\r\n|\r|\n/),a=0;a<I.length;a++)E=I[a].length*N,o=Math.max(o,E);else o=e.length*N;0<f&&(o+=1===l?8*f*2:8*f)}else if(n.wordWrap||5===n.hAlign){if(m=r.sheetArea,p=4===n.hAlign?this.Xt(r.sheet,v,g,m):s.nn(g,m),S=s.Gt(v,m),(b=s.getSpan(v,g,m))&&b.row>=v&&b.col>=g&&1<b.colCount){for(C=g+1;C<g+b.colCount;C++)p+=s.nn(C,m);for(y=v+1;y<v+b.colCount;y++)S+=s.Gt(y,m)}if(M=bt(n,1),0<(k=bt(n,3))&&(p-=k),0<M&&(p-=M),0<(T=bt(n,0))&&(S-=T),0<(h=bt(n,2))&&(S-=h),n.cellButtons&&0<n.cellButtons.length&&(p-=It(r,n)),dt.W.Jue(n)&&(p-=Pt(r,n)),n.cellType&&n.cellType.Tfe&&(p-=n.cellType.Tfe(i)),1===m&&(H=!!((l=s.rowFilter&&s.rowFilter())&&l.rn(v,g,m)&&l.filterButtonVisible(g)))&&(p-=s.an(new ht.Rect(0,0,p,S),m).width),d)return f=(S-N*G)/x,I=ht.q.un((0,ht.r2e)(e),f,P),o=x*(w=s.Qt(I[0],P)/i)+N*G;o=(I=U(t)?[e]:ht.q.un((0,ht.r2e)(e),p-ot(n,3)-B,P)).length*N}else o=d?x*(w=s.Qt(e,P)/i)+N*G:N;return o},w.cn=function(t,e,n,i,r,o,a,s,u,c,f,l){var h;1===u?(t.beginPath(),(h=t.createLinearGradient(e,n+1,e,n+r-2)).addColorStop(0,s.borderLeftColor),h.addColorStop(1,s.borderRightColor),t.strokeStyle!==h&&(t.strokeStyle=h),o.borderLeft||(t.moveTo(e+.5,n),t.lineTo(e+.5,n+r)),o.borderRight||(t.moveTo(e+i-.5,n),t.lineTo(e+i-.5,n+r)),c&&!o.borderTop&&(t.moveTo(e,n+.5),t.lineTo(e+i,n+.5)),t.stroke(),s.borderBottomWidth&&!o.borderBottom&&(t.beginPath(),t.strokeStyle!==s.borderBottomColor&&(t.strokeStyle=s.borderBottomColor),t.moveTo(e+1,n+r-.5),t.lineTo(e+i,n+r-.5),t.stroke())):(t.beginPath(),(h=t.createLinearGradient(e,n,e+i-2,n)).addColorStop(0,s.borderTopColor),h.addColorStop(1,s.borderBottomColor),t.strokeStyle!==h&&(t.strokeStyle=h),o.borderTop||(t.moveTo(e,n+.5),t.lineTo(e+i,n+.5)),o.borderBottom||(t.moveTo(e,n+r-.5),t.lineTo(e+i,n+r-.5)),f&&!o.borderLeft&&(t.moveTo(e+.5,n),t.lineTo(e+.5,n+r)),t.stroke(),!s.borderRightWidth||o.borderRight||l||(t.beginPath(),t.strokeStyle!==s.borderRightColor&&(t.strokeStyle=s.borderRightColor),t.moveTo(e+i-.5,n+1),t.lineTo(e+i-.5,n+r),t.stroke()))},w.hn=function(t,e){var e,e=2===e?"active":4===e?"inactive":0===e?"disabled":"auto";(0,v.GC$)(t).css("ime-mode",e)},w.dn=function(t,e,n,i,r,o,a){var s,u,u,c,f;return!!(e&&"SparklineExValue"===e.typeName&&(u=(s=a.sheet)&&s.parent)&&(u=u.getSparklineEx(e.name)))&&(f={zoomFactor:c=et(a)?a.printZoomFactor:s.zoom(),sheet:s,rowIndex:a.row,columnIndex:a.col,isPrinting:a.isPrinting},2===a.columnHeaderFitMode&&(r=s.getColumnWidth(a.col,a.sheetArea)+1),u.paint(t,e.value,n,i,r,o,f),!0)},w.xt={},w.Dt=function(t,e){var n,t,e,e,t,t;return t&&t.vn&&(t=(n=t.vn(e)).format(e))&&t[1]&&"decimalSeparator"===t[1].type?(e=t[2])&&e.type===S?(e=e.value,t=(t=t[3])&&"exponent"===t.type&&t.value&&-1<t.value.indexOf("E"),!W(e)&&t?e.length:5):0:5},w.gn=bt,G=w,s.Context=G,L={"\u2329":1,"\u232a":1,"\u27e8":1,"\u27e9":1,"\u276c":1,"\u276d":1,"\u2770":1,"\u2771":1,"\u3008":1,"\u3009":1,"\u23a1":1,"\u23a6":1,"\u300c":1,"\u300d":1,"\uff62":1,"\uff63":1,"(":1,")":1,"[":1,"]":1,"\uff3b":1,"\uff3d":1,"{":1,"}":1,"\u2774":1,"\u2775":1,"\ufe5b":1,"\ufe5c":1,"\uff5b":1,"\uff5d":1,"\u3016":1,"\u3017":1,"\u2772":1,"\u2773":1,"\u3014":1,"\u3015":1,"\ufe5d":1,"\ufe5e":1,"\u3010":1,"\u3011":1,"\u27ea":1,"\u27eb":1,"\u300a":1,"\u300b":1,"\u300e":1,"\u300f":1},f.prototype.Rge=function(t,e){var n;f.et(t.sheet,"beforePaintCellContent",{context:t,style:e})},f.prototype.pn=function(t,e,n,i){var t={ctx:t,options:{rect:e,context:n,value:i}};return f.et(n.sheet,"paintCellPadding",t),t.options.rect},f.prototype.bn=function(t,e,n){var e={context:t,options:{dom:e,cellRect:n,contentRect:n.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)}};return f.et(t.sheet,"onCreateCellEditor",e),e.options.dom},f.prototype.yn=function(t,e,n){var e={ctx:null,options:{rect:e.clone(),context:t,value:null,style:n}};return f.et(t.sheet,"getCellButtonRect",e),e.options.rect},f.prototype.wn=function(t,e,n,i){var e={context:t,options:{dom:e,cellRect:n,cellStyle:i,contentRect:n.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)}};return f.et(t.sheet,"onActivateCellEditor",e),e},f.prototype.Mn=function(t,e,n,i){var e={context:t,contentContainer:e,editorBounds:n,cellStyle:i,contentRect:n.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)};return f.et(t.sheet,"onUpdateContainer",e),e},f.prototype.Cn=function(t,e,n){var e={context:t,options:{dom:e,cellRect:n,contentRect:n.clone(),leftExternalRect:new ht.Rect(0,0,0,0),rightExternalRect:new ht.Rect(0,0,0,0)}};return f.et(t.sheet,"onDeactivateCellEditor",e),e.options.dom},f.prototype.Sn=function(t,e,n){var i=this;i.deactivateEditor(t,e),i.Cn(e,t,n)},f.prototype.Tn=function(t,e,n,i){var r,o,a,s,i,s,o,i,o,s,u,r=n.labelOptions;r&&(o=i.sheet,a=n.watermark)&&(s=r.visibility,i=o.getText(i.row,i.col,i.sheetArea),1!==s)&&(2!==s&&s!==x||""!==i)&&(s=o.zoom(),i=void 0,i=(o=r.font)?dt.W.V(o,s):dt.W.Lge(n,1),o=J(i.font),s=Ft(e,n),u=void 0,u=Ut(n,e)?At(e,n,i,o):u)&&(t.save(),t.textAlign=_t(r.alignment),t.textBaseline="alphabetic",vt(t,i.font),t.fillStyle=r.foreColor||n.foreColor||"grey",t.rect(s.x,s.y,s.width,s.height),t.clip(),t.beginPath(),t.fillText(a,u.x,u.y),t.restore())},f.prototype.An=function(t,e,n){var i,r,o,a,e,i=t.clone(),r=bt(e,0,!1,n),o=bt(e,1,!1,n),a=bt(e,2,!1,n),e=bt(e,3,!1,n);return 0<r&&(i.y+=r,i.height-=r),0<a&&(i.height-=a),0<e&&(i.x+=e,i.width-=e),0<o&&(i.width-=o),o+e>=t.width&&(i.width=0),r+a>=t.height&&(i.height=0),i},f.prototype.In=function(t,e,n,i){var r,o,r,r=this,o=et(i)?i.printZoomFactor:i.sheet.zoom();return e=r.An(e,n,o),f.et(i.sheet,"getCellPaddingRect",r={ctx:t,options:{rect:e,context:i}}),r.options.rect},f.prototype.xn=function(t,e,n,i){var r,o,i,a,s,u,c,o,f,l,e,a,h,d,r=n.labelOptions;r&&(i=(o=i.sheet).getText(i.row,i.col,i.sheetArea),a=n.watermark,1!==(s=r.visibility))&&a&&(u=r.font||n.font||o.Dn.Nn(),1!==(c=o.zoom())&&(u=o.Dn._n(u)),o=J(u),f=Ut(n,e)?Lt(e,n):f)&&((l=(0,v.GC$)(ht.mt.En("span"))).text(a),e=(2===s||s===x)&&""===i,a=f.height-o,h=f.y+(e&&0<a?a:0),l.css({display:"block",position:"absolute",left:f.x,top:h,width:f.width,height:f.height,font:b(u),color:r.foreColor||n.foreColor||"grey",textAlign:_t(r.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),(0,v.GC$)(t).append(l),e)&&(d=setInterval(function(){h--,l.css("top",h),h<=f.y&&clearInterval(d)},20))},f.prototype.jn=function(t){var e,n,i,r,i,e=this,n=ht.mt.En("div");return n.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(i=ht.mt.En("div")).style.cssText="position: absolute; outline: none; border: none;",(0,v.GC$)(n).append((0,v.GC$)(i)),(r=e.createEditorElement(t,n))&&(0,v.GC$)(i).append((0,v.GC$)(r)),i=t.sheetArea,e.bn(t,n,t.sheet.getCellRect(t.row,t.col,1===i?-1:x,2===i?-1:x)),n},f.prototype.On=function(t,e,n,i){var r,n,n,o,a,s,n,u,o,c,f;t&&t.firstChild&&(r=this,Et(t,e,n=Vt(n),i),o=(n=r.wn(i,t,n,e)).options.contentRect,a=n.options.cellRect,s=n.options.leftExternalRect,n=n.options.rightExternalRect,r.xn&&r.xn(t,o,e,i),u=i.sheet.zoom(),o=Y(o=r.An?r.An(o,e,u):o,s,n),c=t.firstChild,f=st(e.textDirection,e.textDirection===z.TextDirectionType.context?i.sheet.getValue(i.row,i.col):N),(0,v.GC$)(c).css({left:(+(0,v.GC$)(c).css("left").replace("px","")||0)+bt(e,3,!1,u),top:(+(0,v.GC$)(c).css("top").replace("px","")||0)+bt(e,0,!1,u),direction:f}),r.activateEditor(t.firstChild.firstChild,e,o,i,a,s,n))},f.prototype.updateEditorContainer=function(t,e,n,i,r,o,a){var e,t,e,s,u,t;t&&e&&(t=(e=t.parentNode)?e.parentNode:x)&&r&&(e=(0,v.GC$)(t),s=r.width,u=r.height,0<s&&(e.width(s),t=t.lastChild,n)&&"gcEditorLabel"===t.getAttribute("gcUIElement")&&(0,v.GC$)(t).width(s-bt(n,3,!0)-bt(n,1,!0)-2),0<u&&e.height(u),W(r.x)||e.css("left",r.x+"px"),W(r.y)||e.css("top",r.y+"px"))},f.prototype.Rn=function(t,e,n,i){var r,o,n,t,n,a,s,t,o,a,a,s,t,u,c,n,r=this,o=t.firstChild,n=Vt(n);Et(t,e,n,i),n=(t=r.Mn(i,o,n,e)).editorBounds,a=t.contentRect,s=t.leftExternalRect,t=t.rightExternalRect,o=o.firstChild,a=Y(a=r.An?r.An(a,e,i.sheet.zoom()):a,s,t),a=r.updateEditor(o,e,a,i,n,s,t),s={width:s.width,height:s.height},t={width:t.width,height:t.height},c=!isNaN(a&&a.width)&&a.width+s.width+t.width>n.width?a.width+s.width+t.width:n.width,n=!isNaN(a&&a.height)&&a.height+s.height+t.height>n.height?a.height+s.height+t.height:n.height,r.updateEditorContainer(o,a,e,i,u={width:c,height:n},s,t)},f.prototype.Bn=function(t,e,n,i,r){return this.getCellAndPaddingHitInfo(t,e,n,i,r)},f.prototype.Ln=function(t,e,n,i,r){var o,t,o=It(r,n)+Bt(r)+Pt(r,n),t=this.getAutoFitWidth(t,e,n,i,r);return 0<t&&(o+=t+bt(n,3,!1)+bt(n,1,!1)),o},f.prototype.Fn=function(t,e,n,i,r){var o,t,o=0,t=this.getAutoFitHeight(t,e,n,i,r);return 0<t&&(o+=t+bt(n,0,!1)+bt(n,2,!1)),o=Math.max(Nt(r,n),o),Math.max(Rt(r,n),o)},f.prototype.paintValue=function(t,e,n,i,r,o,a,s){var u,c,f,l,l,u=this,c={};s.quotePrefix=a.quotePrefix,(f=this.format(C(e),a.formatter||a._autoFormatter,c,s))&&(l=new ht.Rect(n,i,r,o),this.adjustRectForIconSet(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,l,c.content&&this.hasInfilling(c.content)),n=l.x,r=l.width,l=u.Pn(t,f,a,s,n,i,r,o),this.paintText(t,e,n,i,r,o,a,s,f,c,x,l.externals))},f.prototype.Gn=function(t,e,n,i){var t=0<t?8*t*i:0;return t=e&&e.Un(n)?0:t},f.prototype.Ft=function(t,e){return!!(!t||o(t,tt)&&t===i||t&&t.formatString&&t.formatString()===i)||!(e&&(!isNaN(e)||"TRUE"===e.toUpperCase()||"FALSE"===e.toUpperCase())&&"@"!==t)},f.prototype.Hn=function(t){for(var e,n,e=0,n=0;n<t.length;n++)e+=t[n].width;return e},f.prototype.Fge=function(t){for(var e,t,n,i,r,o,a,e=t.left,t=t.right,n=0,i=e;n<i.length;n++)if((r=i[n]).isStick)return!0;for(o=0,a=t;o<a.length;o++)if((r=a[o]).isStick)return!0;return!1},f.prototype.zn=function(t){for(var e,n,e=0,n=0;n<t.length;n++)e+=t[n].height;return e},f.prototype.Vn=function(t,e,n,i,r){var o;f.et(e.sheet,"beforePaintLabel",{ctx:t,options:{rect:n,context:e,value:i,style:r}})},f.prototype.Pn=function(t,e,n,i,r,o,a,s){var t={ctx:t,text:e,rect:new ht.Rect(r,o,a,s),style:n,context:i,externals:{left:[],right:[]}};return f.et(i.sheet,"beforePaintText",t),oe(t),t},f.prototype.Yn=function(t,e,n,i,r,o,a,s,u){var t={ctx:t,style:e,context:n,textRect:new ht.Rect(i,r,o,a),availRect:s};return f.et(n.sheet,u,t),ie(u,t),t},f.prototype.Zn=function(t,e,n,i,r,o,a,s){return this.Yn(t,e,n,i,r,o,a,s,"beforeFillTextArea")},f.prototype.Wn=function(t,e,n,i,r,o,a,s){return this.Yn(t,e,n,i,r,o,a,s,"afterFillTextArea")},f.prototype.paintText=function(t,e,n,i,r,o,a,s,u,c,f,l){var h,d,v,g,m,p,S,w,b,C,w,b,p,h=this;t.save(),t.beginPath(),d=a.textOrientation,v=a.textIndent&&0!==a.textIndent,g=a.hAlign,m=a.isVerticalText&&4!==g,4===g&&(d=0,v=!1),p=s.sheet,S=s.sheetArea,w=p.rowFilter&&p.rowFilter(),b=s.columnHeaderFitMode,!(C=!!(w&&w.rn(s.row,s.col,S)&&w.filterButtonVisible(s.col)))||b!==z.ColumnHeaderFitMode.normal&&b!==z.ColumnHeaderFitMode.vertical||(y(s.cornerX)||(r=s.cornerX-n),r-=p.an(new ht.Rect(n,i,r,o),S).width),w=a.wordWrap,b=a.shrinkToFit,p=a.showEllipsis,5===g&&(s.sheet.options.showFormulas&&s.isFormula?(a.hAlign=1,a.wordWrap=!1):a.wordWrap=!0,a.shrinkToFit=!1,a.showEllipsis=!1),e&&e.richText&&0<e.richText.length&&K(e,u,a.wordWrap)||m?h.Qn(t,e,n,i,r,o,a,s,u,c,f,l):0!==d&&!W(d)&&-90<=d&&d<=90&&!v&&!m?h.Kn(t,e,n,i,r,o,a,s,u,c,f,l):h.Jn(t,e,n,i,r,o,a,s,u,c,f,l),5===g&&(a.hAlign=5,a.wordWrap=w,a.shrinkToFit=b,a.showEllipsis=p),t.restore()},f.prototype.Xn=function(t,e,n,i,r,o,a,s,u,c){for(var f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,f=e.sheet,l=e.row,h=e.col,d=r.vAlign,v=e.sheetArea,g=0;g<n.length;g++)if(m=n[g].text,p=i[g].lineHeight,S=1===d?0:s,w=this.qn(t,"0"),b="",(C=o)-1-2-S<m.length*p){if(C<3*w)c.push(0),b=I;else if(y=gt((C-1-2-3*w-(1===d?0:s))/p),(M=0)===d){for(k=0;k<y;k++)b+=m[k];T=b.length,3*w+((b+=I).length-3)*p+s>C-1-2?(b=b.substring(0,b.length-4)+I,c.push(b.split(I)[0].length)):c.push(T)}else if(1===d){for(x=0;x<B(y/2);x++)b+=G=m.charAt(x),M=x;for(T=b.length,b+=I,x=B(m.length-y/2);x<m.length;x++)b+=G=m.charAt(x);3*w+(b.length-3)*p+s>C-1-2?(b=b.replace(m[M],""),c.push(b.split(I)[0].length)):c.push(T),u[g].y=a+(o-(3*w+(b.length-3)*p))/2}else{for(c.push(0),k=m.length-1;k>=m.length-y;k--)b=m[k]+b;3*w+((b=I+b).length-3)*p+s>C-1-2&&(b=b.replace(m[m.length-y],"")),u[g].y=a+o-s-(3*w+(b.length-3)*p)-2}n[g].textInfos[0].text=b,f.Ut.$n(l,h,m,v)}else f.Ut.$n(l,h,null,v)},f.prototype.Qn=function(t,e,n,i,r,o,a,s,u,c,f,l){var h,d,v,g,m,h,p,S,w,b,C,y,M,b,k,m,h,d,l,m,T,x,S,M,G,B,I,k,f,P,R;if(e&&e.richText&&(e={text:(e=e.converted?e:ht.util.g0(e)).text,richText:e.converted}),v=this,g=new ht.Rect(n,i,r,o),m=s.sheet?s.sheet.zoom():1,h=s.printZoomFactor,h=et(s)?h:N,p=v.Gn(a.textIndent,s.sheet.outlineColumn,s.col,h?h*m:m),S=s.cellOverflowLayout&&s.cellOverflowLayout.expandedWidth,w=a.hAlign,b=a.formatter||a._autoFormatter,3===w&&(w=Ct(w,e,b)),y=!!(C=a.isVerticalText&&4!==w)&&Z(u),M=a.font,b=v.Ft(b,e&&e.text),k=F(!0,[],v.Pt(e,u,b,M,a.foreColor)),(0,ht.resetFillStyle)(t,s.sheet,a,f),e&&e.richText&&0<e.richText.length&&v.te(k,M,m,h),h=m=0,l&&(m=v.Hn(l.left),h=v.Hn(l.right),d=v.Fge(l)),l=m+h,m={left:m,right:h,isStick:d},!a.wordWrap&&a.shrinkToFit&&(4===a.hAlign?v.ne(k,S-l,o,a,M,1,C):v.ne(k,r-l,o,a,M,1,C)),T=v.ee(t,u,a.font,C?o:r-l,p,C?a.vAlign:a.hAlign,a.wordWrap,C,k),x=v.re(T,a,w,f),S=v.oe(t,a,n,i,r,o,a.wordWrap,s.cellOverflowLayout,w,p,C,(null==(h=T[0])?void 0:h.textLength)||0,(null==(d=x[0])?void 0:d.lineHeight)||0,s.clipRect),M=!1,a.showEllipsis&&C&&e&&!e.richText&&(M=!0),G=[],G=4===w?v.ae(n,i,s.cellOverflowLayout.expandedWidth,o,w,a.vAlign,p,C,y,T,x,m,M,a):v.ae(n,i,r,o,w,a.vAlign,p,C,y,T,x,m,M,a),B=T.length,I=[],M&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===T.length&&T[0].text)&&this.Xn(t,s,T,x,a,o,i,p,G,I),1===B&&c&&!b)v.ue(t,s.sheet,u,c,G[0].x,G[0].y,r,o,w,a,S.width,S.height,p,C,T[0].textLength,s,m,g);else{for(k=v.se(T),f=G[0].x,t.textAlign===q?f-=k/2:t.textAlign===X&&(f-=k),v.Zn(t,a,s,G[0].x,G[0].y,k,0,g),P=r-l-4-2*p,R=0;R<B;R++)v.ce(t,s.sheet,G[R].x,G[R].y,x[R],w,T[R],I[R],P);v.Zn(t,a,s,f,G[0].x,k,0,g)}},f.prototype.se=function(t){var e,n;if(!t||0===t.length)return 0;for(e=t[0].textLength,n=0;n<t.length;n++)e=wt(e,t[n].textLength);return e},f.prototype.qn=O,f.prototype.fe=function(t,e,n,i,r,o,a){var s,u,n,c,f,t,l,h,r,d,v,g,m,p,S,w,b,C,y,M,y,u=t.sheetArea,s=n,n=this.qn(i,s),c=t.sheet,f=t.row,t=t.col,l=r,h=0,r=this.qn(i,"0"),d;if(h=this.qn(i,I),l-1-2-(v=1===o?0:a)<n){if(g="",2===o)for(m=s.length-1;0<=m;m--){if(l-1-2-a<h){p=g.length,g=I+g.substring(1,p);break}g=(S=s.charAt(m))+g,h+=w=this.qn(i,S)}else if(1===o){for(b=B((l-h)/r),m=0;m<b/2;m++)g+=S=s.charAt(m);for(g+=I,m=gt(s.length-b/2);m<s.length;m++)g+=S=s.charAt(m);for(C=this.qn(i,g);l-1-2<C&&g!==I;)M=(y=g.split(I))[0],y=y[1],g=M.length>y.length?M.substring(0,M.length-1)+I+y:M+I+y.substring(1,y.length),C=this.qn(i,g)}else for(m=0;m<s.length;m++){if(l-1-2-a<h){p=g.length,g=g.substring(0,p-1)+I;break}g+=S=s.charAt(m),h+=w=this.qn(i,S)}e.content=[{value:g,type:"text"}],c.Ut.$n(f,t,s,u)}},f.prototype.Jn=function(t,e,n,i,r,o,a,s,u,c,f,l){var h,d,v,g,m,p,S,F,w,b,C,y,_,M,k,T,x,A,L,G,B,f,v,f,I,P,D,l,j,O,V,R,Y,P,T,S,K,I,w,S,p,I,v,S,N,p,E,g,H,U,U,H,o,f,e,P,U,H,g,h=this,d=0,v=a.textIndent,g=a.wordWrap,m=a.hAlign,p=a.vAlign,S=a.shrinkToFit,F=a.textDecoration,w="left",b=2,C=2,y=a.font,_=0,M=[],k=0,T=s.sheet,x=new ht.Rect(n,i,r,o),A=s.cellOverflowLayout&&s.cellOverflowLayout.expandedWidth,L=s.offsetX;if(L=L||0,4===m&&(v=0),W(s.fontInfo)&&(s.fontInfo=dt.W.Lge(a,T.zoom()),et(s))&&(s.fontInfo=dt.W.V(s.fontInfo.font,s.printZoomFactor)),G=parseInt(s.fontInfo.fontSize,10),W(s.lineHeight)&&(s.lineHeight=J(dt.W.Lge(a,T.zoom()).font,!1,Z(u))),B=s.lineHeight,(0,ht.resetFillStyle)(t,T,a,f),f=T.zoom()||1,et(s)&&(f*=s.printZoomFactor),0<v&&(d=8*v*f),T.outlineColumn&&T.outlineColumn.Un(s.col)&&(d=0),3===m&&(m=Ct(m,e,a.formatter||a._autoFormatter)),v=1,vt(t,y),I=f=0,l&&(f=h.Hn(l.left),I=h.Hn(l.right),P=h.Fge(l)),D=f+I,l={left:f,right:I,isStick:P},!g&&S){for(O={value:!1},V=void(j=0),R=0;R<3&&!1===O.value&&(Y=t.measureText(u).width,j=wt(0,r-4-(1===m?0:d)-D),(j=4===m?wt(0,A-4-d-D):j)<Y);R++)y=(V=dt.W.V(y,j/Y,O,!0)).font,vt(t,y);V&&(v=G/V.fontSize,G=V.fontSize)}if(P=(P=T.parent&&T.parent.options.numbersFitMode===z.NumbersFitMode.overflow||!1)||(c&&c.content?!(!c.content||1!==c.content.length||"text"!==c.content[0].type):"string"==typeof e&&e===u),!g&&!S&&a.showEllipsis&&P&&this.fe(s,c,u,t,r,m,d),b+=d+f,1===m||4===m||5===m?(b=(r+f-I)/2,w=q):2===m&&(b=r-I-1-2,w=X,b=rt(a,b-=d)),t.textAlign!==w&&(t.textAlign=w),T=0,g&&(T=r-D-(S=ot(a,3))-(1===m||5===m?2*d:d),4===m&&(T=A-D-S-d),--T,1<(k=(M=s.isPrinting?ht.q.un(u,T,y,!1,t):it(u,T,y,!1,t)).length))&&0!==p&&(_=(k-1)*B),C=(C+(B-(I=B/2-G/2+(K=8<G?gt((G-8)/5+2):1)-1)))/v,1===p?C=(o-_)/2+B/2-I:2===p&&(C=o-(_+2+I)/v),t.textBaseline!==$&&(t.textBaseline=$),p=kt(S=(w=s.cellOverflowLayout)&&w.layout,n,i,r,o,s.clipRect))if(w&&4===m&&(b+=(w.expandedWidth-r)/2),b+=L,I=S&&S.width>r||4===m,v=p.x,S=p.y,N=p.width,p=p.height,g)if(t.rect(v,S,N,p),t.clip(),t.beginPath(),E=i+C,1<k||5===m)if(g=n+b,t.textAlign===q?g-=T/2:t.textAlign===X&&(g-=T),U=E,(H=me(M,B,a)).descenderHeight&&(U+=H.descenderHeight),s.textRect=new ht.Rect(g,Mt(U+(M.length-1)*B,i+o),T,Mt(H.height,o)),5===m)U=b,H=2+d+f+L,!P&&!nt(a.formatter)&&typeof a.formatter===tt&&"object"!=typeof e||P&&1===k&&!h.Bge(M[0])?h.he(t,u,c,n+U,i+C,1,N,d,F,K,G,s,a,l,x,I):(h.Zn(t,a,s,g,E,T,B*k,x),h.Pge(t,M,n,E,T,U,H,B,a,G,K),h.Wn(t,a,s,g,E,T,B*k,x));else{for(h.Zn(t,a,s,g,E,T,B*k,x),R=0;R<k;R++)t.direction=st(a.textDirection,M[R]),t.fillText(M[R],n+b,E),F&&(Y=t.measureText(M[R]).width,h.le(t,F,n+b,E,Y,G,K)),E+=B;h.Wn(t,a,s,g,E,T,B*k,x)}else h.he(t,u,c,n+b,i+C,m,N,d,F,K,G,s,a,l,x,I);else f=N-(n+1-v)<(o=s.Ui=Q(t,t.font,u)+D)||p<B||0!==L,4===m&&(f=!0),e=bt(a,0),P=bt(a,1),U=bt(a,2),H=bt(a,3),f||(1===m||4===m?w&&((g=o/2)>w.backgroundLeftWidth||g>w.backgroundRightWidth)&&(f=!0):(N<o+d+e+U||p<_+H+P)&&(f=!0)),f&&(t.rect(v,S,N,p),t.clip(),t.beginPath()),h.he(t,u,c,n+b,i+C,m,N,d,F,K,G,s,a,l,x,I)},f.prototype.Bge=function(t){var t=ht.q.Gge(t);return 1<t.length||1===t.length&&0<t[0].prefixSpaceCount},f.prototype.Pge=function(t,e,n,i,r,o,a,s,u,c,f){for(var l,h,d,v,g,m,p,S,w,b,w,C,y,M,k,k,l=e.length,h=i,d=u.textDecoration,v=this,g=r,m=0;m<l;m++){if(p=e[m]){if(1===(S=ht.q.Gge(p)).length)t.textAlign=q,t.fillText(p,n+o,h),d&&(w=t.measureText(p).width,v.le(t,d,n+o,h,w,c,f));else for(t.textAlign=T,b=t.measureText(" ").width,w=t.measureText(p).width,C=n+a,(y=0)<S[0].prefixSpaceCount?C+=y=(g-w)/S.length:y=(g-w)/(S.length-1),M=0;M<S.length;M++)C+=(k=S[M]).prefixSpaceCount*b,t.fillText(k.word,C,h),k=t.measureText(k.word).width,d&&v.le(t,d,C,h,k,c,f),C+=k+y}h+=s}},f.prototype.Kn=function(t,F,_,e,n,i,r,o,A,a,L,D){var j,s,u,c,O,V,Y,f,l,h,K,d,v,g,z,m,p,S,W,w,w,b,C,J,y,Z,M,k,T,x,w,Q,X,G,w,B,I,q,$,P,R,N,tt,et,E,nt,it,rt,ot,at,H,U,st,ut,ct,ft,lt,a,L,F,D,V,Z,O,u,s=this,u=r.wordWrap,c=r.hAlign,O=r.vAlign,V=r.shrinkToFit,Y=r.textDecoration,f=2,l=2,h=r.font,K=[],d=0,m=parseInt(o.fontInfo.fontSize,10),p=o.sheet,W=new ht.Rect(_,e,n,i),w=o.cellOverflowLayout,w=w&&w.layout,b=r&&(r.borderLeft||r.borderTop||r.borderRight||r.borderBottom)&&!p.getSpan(o.row,o.col,o.sheetArea),C=p.options.rightToLeft&&St(r.textOrientation)<90?-r.textOrientation:r.textOrientation,J=C*Math.PI/180,y=St(J),Z=pt(y),M=mt(y),k=yt(y),T=o.lineHeight,x=90===C||-90===C;if(b&&(-90<C&&C<0&&(S=!1),0<C)&&C<90&&(S=!0),w=kt(w,_,e,n,i,o.clipRect)){if(Q=w.x,X=w.y,G=w.width,w=w.height,B=T/2*mt(y),I=T/2*pt(y),$=T/2-m/2+(q=8<m?gt((m-8)/5+2):1)-1,a&&a.content&&0<a.content.length&&!V&&(A=s.de(t,a.content,i-4,h)),P=p.Qt(A,h),(0,ht.resetFillStyle)(t,p,r,L),3===c&&(c=Ct(c,F,r.formatter||r._autoFormatter,C)),vt(t,h),N=R=0,D&&(R=s.Hn(D.left),N=s.Hn(D.right)),!u&&V)for(et={value:!1},E=tt=0;E<3&&!1===et.value&&(tt=wt(0,(i-4-2*I)/M))<P;E++)h=dt.W.V(h,tt/P,et,!0).font,vt(t,h),m=null!=(j=r._fontSizeDigit)?j:parseInt(o.fontInfo.fontSize,10),P=p.Qt(A,h),B=(T=ht.mt.vt(h))/2*mt(y),I=T/2*pt(y);if(it=nt=0,u)for(d=(K=ht.q.un(A,it=(i-4-2*I)/M,h,!1,t)).length,P=p.Qt(K[0],h),rt=0;rt<d;rt++)nt<(ot=p.Qt(K[rt],h))&&(nt=ot);switch(v=P/2*Z,g=(u?nt:P)/2*M,5===c&&(C<0&&(c=2,x)&&1===d&&(N=(G-T)/2),0<C&&(c=0,x)&&1===d&&(R=(G-T)/2),x)&&1<d&&(T=(G-T)/(d-1))<o.lineHeight&&(T=o.lineHeight),at=""+c+(O=i<=(z=(u?nt:P)*M+2*I)?2:O)){case"00":f+=v+B+R,l+=g,x||(l+=I),b&&(f=(i-l)/k*(S?1:-1)+(T/2+2)/M+R);break;case"01":f+=v+B+R,l=i/2,b&&(f=(i-l)/k*(S?1:-1)+(T/2+2)/M+R);break;case"02":f+=v+B+R,l+=g,x||(l+=I),b&&(f=l/k*(S?1:-1)+(T/2+2)/M+R),l=i-l;break;case"10":f=(n+R-N)/2,l+=g,x||(l+=I),b&&(f+=(S?1:-1)*(i-l)/k);break;case"11":f=(n+R-N)/2,l=i/2,b&&(f+=(S?1:-1)*(i-l)/k);break;case"12":f=(n+R-N)/2,l+=g,x||(l+=I),b&&(f+=(S?1:-1)*l/k),l=i-l;break;case"20":f=n-2-v-B-N,l+=g,x||(l+=I),b&&(f=n+(i-l)/k*(S?1:-1)-(T/2+2)/M-N);break;case"21":f=n-2-v-B-N,l=i/2,b&&(f=n+(i-l)/k*(S?1:-1)-(T/2+2)/M-N);break;case"22":f=n-2-v-B-N,l+=g,x||(l+=I),b&&(f=n+l/k*(S?1:-1)-(T/2+2)/M-N),l=i-l}if(u)if(H=_+f,U=T/M,st=void 0,90===Math.abs(C)&&(ft=G<P*d+(ut=bt(r,1))+(ct=bt(r,3)))&&(t.rect(Q,X,G,w),t.clip()),1<d){for(1===c&&(H-=(lt=d%2!=0)?U*(d-1)/2:d/2*U-.5*U),L=(a=Kt(H,e+l,P,J,T)).width+U*(d-1),F=a.height,D=a.y,V=a.x-U*(d-1),o.textRect=new ht.Rect(V,Mt(e+2*l,W.y+W.height),L,2*l-T/2),s.Zn(t,r,o,V,D,L,F,W),E=0;E<d;E++)st=E,(0<r.textOrientation&&2===c||r.textOrientation<0&&(0===c||1===c))&&(st=d-E-1),s.ve(t,J,K[st],H,e+l,Y,m,q,$),H=2===c?H-U:H+U;s.Zn(t,r,o,V,D,L,F,W)}else s.me(t,A,_,e,f,l,o,r,P,J,Y,m,q,T,$,W);else Z=P*M+m*M+2,O=bt(r,0),u=bt(r,2),(ft=w-(e+1-X)<Z||w<T||w<Z+O+u)&&(t.rect(Q,X,G,w),t.clip()),s.me(t,A,_,e,f,l,o,r,P,J,Y,m,q,T,$,W)}},f.prototype.me=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g){var m,p,S,w,b,p,C,m=this,p=Kt(n,i,u,c,d),S=p.width,w=p.height,b=p.x,p=p.y;(dt.W.Hge(s)||dt.W.Vge(s))&&(C=St(c),b=n+r-(S=u*pt(C)+d*mt(C))/2,p=i+o-(w=u*mt(C)+d*pt(C))/2),a.textRect=new ht.Rect(b,Mt(p+w,g.height+g.y),S,w),m.Zn(t,s,a,b,p,S,w,g),m.ve(t,c,e,n+r,i+o,f,l,h,v),m.Wn(t,s,a,b,p,S,w,g)},f.prototype.te=function(t,e,n,i){Yt(t,e,n,i)},f.prototype.ne=function(t,e,n,i,r,o,a){for(var s,u,c,f,l,s=0,u={value:!1},c=0;c<3&&!1===u.value&&(f=ft(t,r,o,a),s=wt(0,(a?n:e)-4),(s=(a?i.vAlign:1!==i.hAlign&&i.textIndent)?wt(0,s-8*i.textIndent*o):s)<f);c++)for(l=0;l<t.length;l++)t[l].style.font=dt.W.V(t[l].style.font,s/f,u,!0).font},f.prototype.Pt=function(t,e,n,i,r){var t=t&&t.richText;return t=!W(t)&&n?t:[{style:{font:i,foreColor:r},text:e}]},f.prototype.oe=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d){var v,r,o,d,g,m,p,v,r=kt(s&&s.layout,n,i,r,o,d);if(r)return o=r.x,d=r.y,g=r.width,m=r.height,(a||(p=this.ge(e,u,e.vAlign,n,i,m,g,o,d,l,h,c,f,s)))&&(t.rect(o,d,g,m),t.clip(),t.beginPath()),r},f.prototype.ge=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d){var v,g,m,p,t,h,g=bt(t,0),m=bt(t,1),p=bt(t,2),t=bt(t,3);return h?(!(v=o-(r+1-u)<c||a<f)&&1!==n&&o<c+l+g+p||a<f+t+m)&&(v=!0):(v=a-(i+1-s)<c||o<f)||(1===e?d&&((h=c/2)>d.backgroundLeftWidth||h>d.backgroundRightWidth)&&(v=!0):(a<c+l+t+m||o<f+g+p)&&(v=!0)),v},f.prototype.ee=function(t,e,n,i,r,o,a,s,u){var c,f,l,h,h;if(i=1===o||5===o?i-3-2*r:i-3-r,a&&e)return ht.q.Ht(e,i,n,u,s,t);for(f=c=0;f<u.length;f++)l=u[f].text,s?c+=J(u[f].style.font)*(l?l.length:0):(h=dt.W.V(u[f].style.font,1),h=u[f].style.vertAlign?h.fontSize*k+"px "+h.fontFamily:u[f].style.font,c+=Q(t,h,l));return[{textLength:c,text:e,textInfos:u}]},f.prototype.ue=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p){var S,w,b,S=dt.W.Lge(c,1).fontSize,w=8<S?gt((S-8)/5+2):1;this.pe(t,e,c),d?this.be(t,n,i,c,r,o,l,h,l,g,m,p):this.he(t,n,i,r,o,u,f,h,c.textDecoration,w,S,g,c,m,p,b=a<f,v)},f.prototype.be=function(t,e,n,i,r,o,a,s,u,c,f,l){var h,d,v,g,m,p,S,w,h=this,d=n.content,g=o;if(c.textRect=new ht.Rect(r,g,u,pe(t,e,n,r,o,a,s,u)-g),h.Zn(t,i,c,r,g,u,u*e.length,l),d&&0<d.length)for(p=0<(p=a-s-(m=Dt(t,d,!0))-2)?p:0,S=void 0,v=0;v<d.length;v++)"fillingChar"===d[v].type?(w=Ot(t,p,d[v].value,!0),this.ye(t,w,r,o),o+=p):"placeholder"===d[v].type?o+=d[v].value?d[v].value.length*u:0:"numberPlaceholder"===d[v].type?o+=u:(this.ye(t,d[v].value,r,o),o+=S=d[v].value?d[v].value.length*u:0);else if(e)for(v=0;v<e.length;v++)o=this.ye(t,e[v],r,o,u).y;h.Wn(t,i,c,r,g,u,o-g,l)},f.prototype.we=function(t){var e=T;return 1===t?e=q:2===t&&(e=X),e},f.prototype.ce=function(t,e,n,i,r,o,a,s,u){for(var c,f,l,h,d,c=[],f=a.textInfos,l=0;l<f.length;l++)c.push(F(!0,{},r,f[l].style));for(h=0,!r.isVerticalText&&5===o&&1<a.textInfos.length&&a.text.includes(" ")&&u&&(h=(u-a.textLength)/(a.textInfos.length-1))<0&&(h=0),l=0;l<f.length;l++)n=(d=this.Me(t,e,n,i,c[l],f[l].text,s)).x+h,i=d.y},f.prototype.re=function(t,e,n,i){for(var r,o,a,s,r=[],o=t.length,a=0;a<o;a++)s=this.Ce(e,n,i,t[a].textInfos),r.push(s);return r},f.prototype.Ce=function(t,e,n,i){var r,o,a,s,u,c,f,r=this,o=0,a=0;if(i)for(s=0;s<i.length;s++)u=void 0,u=(i[s].style&&i[s].style.font&&i[s].text?i[s].style:t).font,o=Math.max(J(u,x,Z(i[s].text)),o),a=Math.max(dt.W.V(u,1).fontSize,a),(i[s].style&&1===i[s].style.vertAlign||2===i[s].style.vertAlign)&&(o=Math.max(J(u,x,Z(i[s].text))+2*dt.W.V(u,k).fontSize*.218,o));return{lineHeight:o,fontSize:a,baselineOffset:c=8<a?gt((a-8)/5+2):1,lineOffset:f=o/2-a/2+c-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:r.we(e),textBaseline:$,opacity:n}},f.prototype.Se=function(t,e,n){for(var i=0,r=0,o,o=0;o<t.length;o++)r+=e[o].lineHeight,i=Math.max(t[o].textLength,i);return{width:n?r:i,height:n?i:r}},f.prototype.ae=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d){var v,g,m,p,S,w,b,v,v=this.Se(c,f,s),g=v.height,m=v.width,p=[];if(s)for(b=0,5===(w=r)&&(1===c.length?w=1:(w=0,m<(v=n-4-l.left-l.right)&&(b=(v-m)/(c.length-1)))),S=0;S<c.length;S++)p.push(this.Te(t,e,n,i,w,o,a,m,c[S].textLength,f[S].lineHeight,f[S].lineOffset,u,l,c[S],h,d)),u?t-=f[S].lineHeight+b:t+=f[S].lineHeight+b;else for(S=0;S<c.length;S++)5===(w=r)&&(w=c[S].text.includes(" ")?0:1),p.push(this.Ae(t,e,n,i,w,o,a,c[S].textLength,g,f[S].lineHeight,f[S].lineOffset,l,d)),e+=f[S].lineHeight;return p},f.prototype.Ae=function(t,e,n,i,r,o,a,s,u,c,f,l,h){var d,v,g,l,d=0,v=0,g=l.left,l=l.right;return v=1===o?(i-u)/2+c-f:2===o?i-u-2+c-f:2+c-f,1===r||4===r?d=(n-s+g-l)/2:2===r?(d=rt(h,d=n-1-2-s-l),d-=a):d=2+a+g,{x:t+d,y:e+v}},f.prototype.Te=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g){var m,p,S,h,m=0,p=0,S=h.left,h=h.right;return l?0===r?m=2+s+h-c/2:1===r?m=(n-S+h+s)/2-c/2:2===r&&(m=rt(g,m=n-S-1-2-c/2)):1===r?m=(n-s+S-h)/2+c/2:2===r?m=rt(g,m=n-1-2-h-s+c/2):0===r&&(m=2+S+c/2),{x:t+m,y:e+(p=1===o?(i-u)/2:2===o?i-a-u-2:2+a)}},f.prototype.Me=function(t,e,n,i,r,o,a){var e,a;return t.save(),this.pe(t,e,r),e=r.vertAlign,a=r.isVerticalText?this.ye(t,o,n,i,r.textDecoration,r.baselineOffset,a):this.Ie(t,n,i,r,o,e),t.restore(),a},f.prototype.pe=function(t,e,n){(0,ht.resetFillStyle)(t,e,n);var e=n.vertAlign?this.xe(n.font):n.font;W(n.textBaseline)||t.textBaseline===n.textBaseline?W(t.textBaseline)&&t.textBaseline!==$&&(t.textBaseline=$):t.textBaseline=n.textBaseline,n.isVerticalText?t.textAlign!==q&&(t.textAlign=q):t.textAlign!==T&&(t.textAlign=T),vt(t,e)},f.prototype.xe=function(t){var t,e,t=dt.W.Ne(t),e=parseFloat(t.fontSize)*k;return t.fontSize=e+"px",this.ke(t)},f.prototype.ke=function(t){var e,n,i,r,o,a,t,e="",n="normal",i,r=t.fontStyle,o=t.fontSize,a=t.fontWeight,t=t.fontFamily;return e=void 0!==r?r:n,e=(e=(e+=void 0!==a?(e?" ":"")+a:(e?" ":"")+n)+((e?" ":"")+o))+(void 0!==t?(e?" ":"")+t:(e?" ":"")+"Calibri")},f.prototype.OCe=function(t,e,n,i,r,o){e.save(),e.translate(n+o-r/2,i+o-r/2),e.rotate(Math.PI/2),e.fillText(t,0,0),e.restore()},f.prototype.ye=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,g;if(e&&0<e.length)for(s=this,u=t.font,c=J(u,x,Z(e)),f=V(dt.W.V(u,1).fontSize,c),h=(l=s.qn(t,"0"))/2,d=0;d<e.length;d++)v=e[d],i=i+(m=(g=void 0!==a&&a<=d&&d<=a+2&&(a+3===e.length||0===a&&a+3<e.length||0!==a&&a+3<e.length))?l:c)-(g=g?h:f),L[v]?s.OCe(v,t,n,i,c,f):t.fillText(v,n,i),this.De(t,r,n,i,Q(t,t.font,v),dt.W.V(t.font,1).fontSize,o),i+=g;return{x:n,y:i}},f.prototype.De=function(t,e,n,i,r,o,a){var s,u,c,f,u;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),u=s=0,c=.5,u=gt(((f=o<=12?12:o)-12)/21+1),t.lineWidth!==u&&(t.lineWidth=u),0==(1&u)&&(c=0),(u=t.textAlign)===q?n-=r/2:u===X&&(n-=r),t.beginPath(),2==(2&e)&&(s=B(i+a-o/2)-c,t.moveTo(n,s),t.lineTo(n+r,s)),t.stroke()},f.prototype.Ie=function(t,e,n,i,r,o){var a,s,u,o,r;return W(r)?{x:e,y:n}:(s=8<(a=dt.W.V(t.font,1).fontSize)?gt((a-8)/5+2):1,u=0,o?t.fillText(r,e,n-(u=1===o?.74*a:.28*-a)):t.fillText(r,e,n),o=Q(t,t.font,r),r=i.textDecoration,this.le(t,r,e,n,o,a,s-u),{x:e+o,y:n})},f.prototype._e=function(t,e,n,i,r,o,a,s){var u={row:s.row,col:s.col,sheet:s.sheet,sheetArea:s.sheetArea,style:a,underline:a.textDecoration,foreColor:a.foreColor};f.et(s.sheet,"applyHyperlinkStyle",u),this.paint(t,e,n,i,r,o,a,s)},f.prototype.paint=function(t,e,n,i,r,o,a,s){var u,u,c,f,c,f,c;t&&(u=a.backColor,s.parentBackColor!==u&&Tt(t,n,i,r,o,s.imageLoader,a,e,s),2!==(u=s.sheetArea)&&1!==u||(c=s.visualState||0,f="columnHeader",c=this.getThemeStyle(s.visualState,"gc-"+(f=2===u?"rowHeader":f)+"-"+ht.I.Ee(c)),G.cn(t,n,i,r,o,a,f,c,u)),f=this,c=new ht.Rect(n,i,r,o),s.cellRect=c.clone(),f.Vn(t,s,c,e,a),Wt(t,c,a,s),f.Tn&&(f.Tn(t,c,a,s),c=f.An(c,a,et(s)?s.printZoomFactor:s.sheet.zoom())),s.cellOverflowLayout||f.pn(t,c,s,C(e)),0<c.width)&&0<c.height&&(a&&a.showEllipsis&&s.sheet.Ut.$n(s.row,s.col,null,s.sheetArea),f.paintContent(t,e,c.x,c.y,c.width,c.height,a,s))},f.prototype.paintContent=function(t,e,n,i,r,o,a,s){var u,c,c,c,u,c=s.conditionalFormats;c&&(u=c._e(t,C(e),n,i,r,o,a,s)),s.showBarIconOnly=u,(c=s.sparkline)&&c.paintSparkline(t,n,i,r,o),c=G.dn(t,C(e),n,i,r,o,s),s.cellOverflowLayout||u||c||(u=new ht.Rect(n,i,r,o),this.Rge(s,a),this.paintValue(t,e,u.x,u.y,u.width,u.height,a,s))},f.prototype.adjustRectForIconSet=function(t,e,n,i,r,o,a){xt(t,e,n,i,r,o,a)},f.prototype.hasInfilling=function(t){for(var e=0;e<t.length;e++)if("fillingChar"===t[e].type)return!0;return!1},f.prototype.createEditorElement=function(t,e){return N},f.prototype.getEditorValue=function(t,e){return N},f.prototype.je=function(t,e,n,i){return n},f.prototype.setEditorValue=function(t,e,n){},f.prototype.getEditingElement=function(){return N},f.prototype.parse=function(t,e,n){var i,r,o,a,i=W(e),r=W(t);try{if(o=c.Formatter&&c.Formatter.GeneralFormatter,!i&&!r&&o)return(a=typeof e===tt?new o(e):e).parse(t)}catch(t){}return r?"":t.toString()},f.prototype.format=function(e,t,n,i){var r,o,a,a,i,s,u,r=nt(t);if(i&&r&&(a=(o=i.sheet).Oe(i.row,i.col,i.sheetArea,t),W(a)||(e=a)),W(e)||""===e)return"";if(i&&i.quotePrefix&&typeof e===tt)return e.toString();if(!r&&typeof t===tt&&"object"!=typeof e)return ht.Be.Re(e,t,n);if(!t||"General"===t||r)return"boolean"==typeof e||e instanceof Boolean?(e=l?e?l.getBoolean().boolean_true:l.getBoolean().boolean_false:e).toString().toUpperCase():e instanceof Date?(i=(a=h.Fe(h.culture()).DateTimeFormat).shortDatePattern,0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()||(i=a.defaultDatePattern),p.Pe(e,i)):(e=typeof e===S?d.Ge(e.toString()):e).toString();try{return(s=c.Formatter&&c.Formatter.GeneralFormatter)?(u=void 0,(u=typeof t===tt?ht.Be.Ue(t):t).format(e,n)):e.toString()}catch(t){return e.toString()}},f.prototype.focus=function(t,e){t&&t.focus&&t.focus()},f.prototype.getThemeStyle=function(t,e){return ht.I.He(t,e)},f.prototype.activateEditor=function(t,e,n,i,r,o,a){},f.prototype.deactivateEditor=function(t,e){},f.prototype.selectAll=function(t,e){t&&t.select&&t.select()},f.prototype.updateEditor=function(t,e,n,i,r,o,a){},f.prototype.setImeMode=function(t,e,n){this.isImeAware(n)?this.updateImeMode(t,e,n):t&&G.hn(t,0)},f.prototype.updateImeMode=function(t,e,n){t&&G.hn(t,e)},f.prototype.getHitInfo=function(t,e,n,i,r){return N},f.prototype.getCellAndPaddingHitInfo=function(t,e,n,i,r){var o,a,s,o=this;if(r){if(a={x:t,y:e,context:r,cellStyle:n,cellRect:i,paddingHitInfo:null},f.et(r.sheet,"getCellButtonHitInfo",a,function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo}),s=a.paddingHitInfo,a.paddingHitInfo&&!W(a.paddingHitInfo.cellButtonHitInfo)&&!W(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=o.An?o.An(a.cellRect,n,r.sheet.zoom()):a.cellRect,f.et(r.sheet,"getCellTextHitInfo",a,function(){return!W(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation}),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===r.sheetArea)return f.et(r.sheet,"getCellPaddingHitInfo",a,function(){return!W(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation}),a.paddingHitInfo||s||this.getHitInfo(t,e,n,i,r)}return this.getHitInfo(t,e,n,i,r)},f.prototype.processCellAndPaddingMouseDown=function(t){return f.et(t.sheet,"processMouseDownOnCellPadding",t),this.processMouseDown(t)},f.prototype.processMouseDown=function(t){return!1},f.prototype.ze=function(t){return f.et(t.sheet,"processMouseMoveOnCellPadding",t),this.processMouseMove(t)},f.prototype.processMouseMove=function(t){return!1},f.prototype.Ve=function(t){return f.et(t.sheet,"processMouseUpOnCellPadding",t),this.processMouseUp(t)},f.prototype.processMouseUp=function(t){return!1},f.prototype.processMouseEnter=function(t){return!1},f.prototype.Ye=function(t){return f.et(t.sheet,"processMouseLeaveOnCellPadding",t),this.processMouseLeave(t)},f.prototype.processMouseLeave=function(t){return!1},f.prototype.isReservedKey=function(t,e){return!1},f.prototype.isEditingValueChanged=function(t,e,n){var i,r,o,n,i,i=n.sheet,r=n.row,o=n.col,n=n.sheetArea||z.SheetArea.viewport,i=i&&i.getValue(r,o,n,z.ValueType.richText);return i&&i.richText&&(t=t.replace(/\r\n?/g,"\n").replace(_,H),e)&&e.replace&&(e=e.replace(/\r\n?/g,"\n").replace(_,H)),"string"==typeof t&&t&&"string"==typeof e&&e&&(t=t.replace(/\t/g,""),e=e.replace(/\t/g,"")),(t=t===N?x:t)!==(e=e===N?x:e)},f.prototype.processCompositionStart=function(t,e){return!1},f.prototype.processKeyDown=function(t,e){return!1},f.prototype.processKeyUp=function(t,e){return!1},f.prototype.getAutoFitWidth=function(t,e,n,i,r){return G.Bt(t,e,n,i,r)},f.prototype.getAutoFitHeight=function(t,e,n,i,r){return G.tn(t,e,n,i,r)},f.prototype.xTe=function(t,e,n,i){return t&&t.content&&0<t.content.length&&(e||!n||4===i)},f.prototype.NTe=function(t){t=jt(JSON.parse(JSON.stringify(t)));var e="";return t.forEach(function(t){if(t)switch(t.type){case"fillingChar":break;case"numberPlaceholder":e+="0";break;default:t.value&&(e+=t.value)}}),e},f.prototype.he=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p){var S,w,p,g,n,a,o,S=this,w=d.isStick;S.xTe(n,p,g,o)?this.Ze(t,n.content,i,r,o,a,s,u,c,f,l,h,d,v,m):(m=m||Q(t,t.font,e),p=i,g=void 0,t.textAlign===q?(p-=m/2,0<d.left&&v.width<m+d.left&&(i=m/2+d.left+v.x)):t.textAlign===X&&(p-=m,0<d.left)&&v.width<m+d.left&&(g={x:v.x+d.left,y:v.y,width:v.width-d.left,height:v.height}),n=p,0<d.left&&p-v.x<d.left&&w&&(n=v.x+d.left),o=r,(a=me([e],l.lineHeight,h)).descenderHeight&&(o+=a.descenderHeight),l.textRect=new ht.Rect(p,o,m,a.height),S.Zn(t,h,l,n,r,m,l.lineHeight,v),g&&w?(t.save(),t.beginPath(),t.rect(g.x,g.y,g.width,g.height),t.clip(),t.fillText(e,i,r),t.restore()):(t.direction=st(h.textDirection,e),t.fillText(e,i,r)),u&&this.le(t,u,i,r,m,f,c),S.Wn(t,h,l,p,r,m,l.lineHeight,v))},f.prototype.ve=function(t,e,n,i,r,o,a,s,u){var i;t.save(),t.textAlign="center",t.textBaseline="middle",t.translate(i,r),t.rotate(-e),t.fillText(n,0,0),o&&(i=t.measureText(n).width,this.le(t,o,0,u,i,a,s)),t.restore()},f.prototype.de=function(t,e,n,i){var r,o,a,s;for(t.font||vt(t,i),o=0<(o=n-(r=Dt(t,e)))?o:0,a=[],s=0;s<e.length;s++)"fillingChar"===e[s].type?a.push(Ot(t,o,e[s].value)):"placeholder"!==e[s].type&&"numberPlaceholder"!==e[s].type&&a.push(e[s].value);return a.join("")},f.prototype.Ze=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v){var g,m,p,S,h,w,b,o,C,y,M,a,h;t.save(),t.textAlign!==T&&(t.textAlign=T),g=this,m=Dt(t,e=jt(JSON.parse(JSON.stringify(e)))),p=h.isStick,b=0<(b=o-a-m-(w=(S=h?h.left:0)+(h=h?h.right:0))-2)?b:0,W(v)?this.hasInfilling(e)?1===r||4===r?n=n-(o+S-h)/2+(a+S):2===r&&(n=n-o+h+2,n+=a+S):W(m)||(1===r||4===r?n-=m/2:2===r&&(n-=m)):this.hasInfilling(e)?1===r?(n=n+(v||m)/2-(o+S-h)/2,n+=a+S):2===r&&(n=n+(v||m)-o+h+2,n+=a+S):W(m)||(1===r?n=n+v/2-m/2:2===r&&(n=n+v-m)),o=n,0<S&&S>n-d.x&&p&&(o=d.x+S+1,C=d.width-S-1),M="",e.forEach(function(t){return M+=t.value}),h=i,(a=me([M],f.lineHeight,l)).descenderHeight&&(h+=a.descenderHeight),f.textRect=new ht.Rect(n,h,n,a.height),g.Zn(t,l,f,o,i,m,f.lineHeight,d),C?(t.save(),t.beginPath(),t.rect(o,d.y,C,d.height),t.clip(),y=this.We(t,e,n,i,b,s,u,c,l.textDirection),t.restore()):y=this.We(t,e,n,i,b,s,u,c,l.textDirection),g.Wn(t,l,f,n,i,y-n,f.lineHeight,d),t.restore()},f.prototype.We=function(t,e,n,i,r,o,a,s,u){for(var c,f,l,l,c=this.qn(t,"0"),f=0;f<e.length;f++)"fillingChar"===e[f].type?(t.direction=st(u,e[f].value),t.fillText(Ot(t,r,e[f].value),n,i),o&&this.le(t,o,n,i,r,s,a),n+=r):"placeholder"===e[f].type?n+=Q(t,t.font,e[f].value):"numberPlaceholder"===e[f].type?n+=c:((l=e[f].value)!==N&&(t.direction=st(u,l),t.fillText(l,n,i)),l=Q(t,t.font,l),o&&this.le(t,o,n,i,l,s,a),n+=l);return n},f.prototype.le=function(t,e,n,i,r,o,a){var s,u,c,f,l;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=t.textAlign,c=u=0,f=.5,c=gt(((l=o<=12?12:o)-12)/21+1),t.lineWidth!==c&&(t.lineWidth=c),0==(1&c)&&(f=0),s===q?n-=r/2:s===X&&(n-=r),t.beginPath(),4==(4&e)&&(u=B(i+a-o-1)-f,t.moveTo(n,u),t.lineTo(n+r,u)),2==(2&e)&&(u=B(i+a-o/2)-f,t.moveTo(n,u),t.lineTo(n+r,u)),1==(1&e)&&(u=B(i+a-1)-f,t.moveTo(n,u),t.lineTo(n+r,u)),8==(8&e)&&(u=B(i+a-1)-f,t.moveTo(n,u-c),t.lineTo(n+r,u-c),t.moveTo(n,u+c),t.lineTo(n+r,u+c)),t.stroke()},f.prototype.Qe=function(t,e){var n=4==(4&e)?"overline":"";2==(2&e)&&(n+=" line-through"),1==(1&e)&&(n+=" underline"),t.css("text-decoration",n)},f.prototype.Ke=function(){return N},f.prototype.isImeAware=function(t){return!1},f.prototype.isEditing=function(){return!1},f.prototype.Je=function(t){},f.prototype.Xe=function(t,e,n,i,r){},f.prototype.qe=function(t,e,n,i,r){},f.prototype.lfe=function(t,e){return t},f.prototype.toJSON=function(){var t,e,n,t={},e=this;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},f.prototype.fromJSON=function(t){if(t)for(var e in t)W(t[e])||(this[e]=t[e])},a=f,s.Base=a,(0,ht.$e)(a),n.ti[0]=a,s.cellTypeContext_paintBackground=Tt,s.paintDecoration=Wt,s.paintStyleDecorationOutSideIcons=Qt},"./dist/core/celltype/cellType.entry.js":function(t,e,n){"use strict";var i,r,o,a,i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&("get"in r?e.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/celltype/headercelltype.js"),a=n("./dist/core/celltype/textcelltype.js"),Object.defineProperty(e,"Corner",{set:function(t){t!==o.Corner&&(o.Corner=t)},get:function(){return o.Corner}}),Object.defineProperty(e,"ColumnHeader",{set:function(t){t!==o.ColumnHeader&&(o.ColumnHeader=t)},get:function(){return o.ColumnHeader}}),Object.defineProperty(e,"RowHeader",{set:function(t){t!==o.RowHeader&&(o.RowHeader=t)},get:function(){return o.RowHeader}}),Object.defineProperty(e,"Text",{set:function(t){t!==a.Text&&(a.Text=t)},get:function(){return a.Text}}),r(n("./dist/core/celltype/celltype.ns.js"),e),r(n("./dist/core/celltype/basecelltype.js"),e),r(n("./dist/core/celltype/textcelltype.js"),e),r(n("./dist/core/celltype/headercelltype.js"),e)},"./dist/core/celltype/celltype.ns.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ti=void 0,e.ti={}},"./dist/core/celltype/headercelltype.js":function(p,t,e){"use strict";var n,i,r,R,F,o,M,_,w,A,k,N,L,D,E,H,T,U,j,O,e,i,r,a,s,u,c;function g(t,e){return w.He(t=t||0,"gc-"+e+"-"+w.Ee(t))}function x(t,e,n,i,r,o){var a,o,a=new Image,o=o;o=(o=o.replace('url("',"")).replace('")',""),a.src=o,t.drawImage(a,e,n,i,r)}function m(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,v,g,m,p,S,w,b,C;function y(){t.fillRect(e+1,n+1,i-1,r-1)}if(!D(s)){if(t.save(),t.beginPath(),c=o.backColor,0===s&&c)F.W.setFillStyle(t,c,e,n,i,r,y);else try{if(c=u&&u.backgroundColor,f=u&&u.backgroundImage,l=a.sheet,h=a.row,d=a.col,v=a.sheetArea,g=void 0,m=!1,l.cellStates&&s===_.VisualState.hover&&(g=l.cellStates.getStyle(h,d,v))&&g.backColor&&(c=g.backColor,m=!0),!m&&f&&-1!==f.indexOf("linear-gradient")){for(p=k(f),S={degree:90,stops:[]},w=0,b=p.length;w<b;w++)C=p[w],S.stops.push({position:C.point,color:C.color});F.W.setFillStyleGradient(t,S,e,n,i,r,y)}else c?(t.fillStyle=c,y()):f&&f!==T&&x(t,e+1,n+1,i-1,r-1,f)}catch(t){}2===a.columnHeaderFitMode&&(i=a.sheet.getColumnWidth(a.col)+1),M.Context.nt(t,e,n,i,r,o.backgroundImage,o.backgroundImageLayout,a.imageLoader),t.restore()}}function f(t,e,n,i,r,o,a,s,u,c,f,l){var h,h,d,v,c,h,f;e&&(m(e,i,r,o,a,s,u,h=u.visualState||0,h=g(h,c)),v=(d="number"==typeof u.rowSpacingIndex)&&!u.RHe,M.Context.cn(e,i,r,o,a,s,c,h,f,u.needTopGridline,u.needLeftGridline,v),c=new R.Rect(i,r,o,a),u.cellRect=c.clone(),t.Vn(e,u,c,n,s),(0,M.paintDecoration)(e,c,s,u),t.Tn&&(t.Tn(e,c,s,u),h=u.printZoomFactor,f=u.isPrinting&&"number"==typeof h&&1!==h?h:u.sheet.zoom(),c=t.An(c,s,f)),0<c.width)&&0<c.height&&t.paintContent(e,n,c.x,c.y,c.width,c.height,s,u,l)}function V(t,e,n,i,r,o){var e,n,o,a,e={font:e,fillStyle:n},n=i.sheet;return 0!==i.visualState&&2007<parseInt(o.zIndex,10)&&n.ni(i.row,i.col,r)&&(o=void 0,a=r===_.SheetArea.rowHeader?"gc-rowHeader":"gc-columnHeader",o=n.ei(i.row,i.col,r)?t(i.visualState,a+"-selected"):t(i.visualState,a+"-highlight"),e.fillStyle=o.color,e.font=F.W.ii(e.font,"bold")),e}function l(t,e,n,i,r,o,a,s,u,c,f,l){var h,d,v,v,g,m,p,g,l,g,l,g,d,h={},d=u.sheet,v={sheet:d,row:u.row,col:u.col,sheetArea:c,quotePrefix:s.quotePrefix},v=t.format(E(n),s.formatter,h,v);v&&(e.save(),e.beginPath(),g=d.rowFilter&&d.rowFilter(),m=u.columnHeaderFitMode,!(p=!!(g&&g.rn(u.row,u.col,c)&&g.filterButtonVisible(u.col)))&&!l||m!==_.ColumnHeaderFitMode.normal&&m!==_.ColumnHeaderFitMode.vertical||(D(u.cornerX)||(o=u.cornerX-i),o-=d.an(new R.Rect(i,r,o,a),c).width),(g=(g=s.foreColor)||f.color)&&e.fillStyle!==g&&(e.fillStyle=g),l=s.textOrientation,g=s.isVerticalText,l=0===m&&d.NMi&&0!==l&&!D(l)&&-90<=l&&l<=90&&!g,n&&n.richText&&0<n.richText.length||g?S(t,d,e,n,i,r,o,a,s,v,h,u,c,f):1===m||l?(g=V(t.getThemeStyle,s.font||e.font,e.fillStyle,u,c,f),s.foreColor=g.fillStyle,s.font=R.util.yt(g.font),1===m&&(s.textOrientation=-90),d=t.Pn(e,v,s,u,i,r,o,a),t.Kn(e,n,i,r,o,a,s,u,v,h,U,d.externals)):b(t,e,n,i,r,o,a,s,v,h,u,c,f),e.restore())}function S(t,e,n,i,r,o,a,s,u,c,f,l,h,d){var v,h,v,h,i,g,h,d,m,p,S,w,v,b,v,b,v,C,b,y,M,w,r,k,T,x,G,B,I,P;if(i&&i.richText&&(i={text:(i=i.converted?i:R.mt.g0(i)).text,richText:i.converted}),g=new O(r,o,a,s),h=V(t.getThemeStyle,u.font||n.font,n.fillStyle,l,h,d),d=u.isVerticalText,m=u.hAlign,p=K(u),S=t.Ft(u.formatter||u._autoFormatter,i&&i.text),w=H(!0,[],t.Pt(i,c,S,h.font,h.fillStyle)),i&&i.richText&&0<i.richText.length&&(v=l.sheet?l.sheet.zoom():1,b=l.printZoomFactor,b=l.isPrinting&&"number"==typeof b&&1!==b?b:U,t.te(w,h,v,b)),v=t.Pn(n,E(i),u,l,r,o,a,s),C=(b=t.Hn(v.externals.left))+(v=t.Hn(v.externals.right)),b={left:b,right:v},!u.wordWrap&&u.shrinkToFit&&t.ne(w,a-C,s,u,h,1,d),y=t.ee(n,c,u.font,d?s:a-C,p,d?u.vAlign:u.hAlign,u.wordWrap,d,w),M=t.re(y,u,m),Y(n,u,r,o,a,s,p,(null==(v=y[0])?void 0:v.textLength)||0,(null==(h=M[0])?void 0:h.lineHeight)||0),w=d?N(c):U,r=!1,!u.wordWrap&&!u.shrinkToFit&&u.showEllipsis&&d&&i&&!i.richText&&(r=!0),k=t.ae(g.x,g.y,g.width,g.height,m,u.vAlign,p,d,w,y,M,b,r),T=[],r&&f&&(f.content&&1===f.content.length&&"text"===(null==(v=f.content[0])?void 0:v.type)||!f.content&&1===y.length&&null!=(h=y[0])&&h.text)&&t.Xn(n,l,y,M,u,s,o,p,k,T),1===(x=y.length)&&f.content&&!S)t.ue(n,e,c,f,k[0].x,k[0].y,a,s,m,u,g.width,g.height,p,d,null==(i=y[0])?void 0:i.textLength,l,b,g);else for(G=0;G<x;G++)B=t.se(y),I=k[0].x,"center"===n.textAlign?I-=B/2:"right"===n.textAlign&&(I-=B),t.Zn(n,u,l,I,k[0].y,B,0,g),t.ce(n,e,k[G].x,k[G].y,M[G],m,y[G],T[G],P=a-C-3-2*p),t.Zn(n,u,l,I,k[0].x,B,0,g)}function b(t,e,n,i,r,o,a,s,u,c,f,l,h){var d,v,l,g,h,m,p,h,S,w,b,C,b,y,M,v,v,C,b,S,n,v,C,b,k,T,x,G,B,I,P,R,b,N,y,E,l,C,h,a,H,U,d=new O(i,r,o,a),v=f.columnHeaderFitMode,l=V(t.getThemeStyle,s.font||e.font,e.fillStyle,f,l,h);if(L(e,l.font),e.fillStyle=l.fillStyle,(g=0)<(h=s.textIndent)&&(g=8*h),m=parseInt(f.fontInfo.fontSize,10),p=s.hAlign,h=s.vAlign,S="left",w=2,b=t.Pn(e,u,s,f,i,r,o,a),y=(C=t.Hn(b.externals.left))+(b=t.Hn(b.externals.right)),M={left:C,right:b},w+=g+C,1===(p=v!==_.ColumnHeaderFitMode.stack||D(f.cornerX)||(a=f.cornerY-r,(v=f.colStyle)&&!D(v.hAlign))?p:0))w=(o+C-b)/2,S="center";else if(2===p)w=o-b-1,w-=g,S="right";else if(5===p)return v=s.wordWrap,C=s.shrinkToFit,b=s.showEllipsis,f.sheet.options.showFormulas&&f.isFormula?(s.hAlign=1,s.wordWrap=!1):s.wordWrap=!0,s.shrinkToFit=!1,s.showEllipsis=!1,t.Jn(e,n,i,r,o,a,s,f,u,c,null,M),s.hAlign=5,s.wordWrap=v,s.shrinkToFit=C,void(s.showEllipsis=b);if(e.textAlign!==S&&(e.textAlign=S),n="alphabetic",v=2,C=s.wordWrap,b=s.shrinkToFit,k=s.font,T=f.lineHeight,x=[],G=S=0,!C&&b)for(I={value:!1},P=B=0;P<3&&!1===I.value&&(R=e.measureText(u).width,(B=Math.max(0,o-4-(1===p?0:g)))<R);P++)k=F.W.V(k,B/R,I,!0).font,L(e,k);if(b=0,C&&(b=o-y-3-g,1<(G=(x=A.un(u,--b,l.font)).length))&&0!==h&&(S=(G-1)*T),y=T/2-m/2+(N=8<m?j((m-8)/5+2):1)-1,!C&&s.showEllipsis&&t.fe(f,c,u,e,o,p,g),v+=T-y,1===h?v=(a-S)/2+T/2-y:2===h&&(v=a-S-2-y),e.textBaseline!==n&&(e.textBaseline=n),E=s.textDecoration,l=d.x,C=d.y,h=d.width,a=d.height,s.wordWrap)if(e.rect(l,C,h,a),e.clip(),e.beginPath(),H=r+v,1<G){for(t.Zn(e,s,f,i+w,H,b,T*G,d),P=0;P<G;P++)e.fillText(x[P],i+w,H),E&&(R=e.measureText(x[P]).width,t.le(e,E,i+w,H,R,m,N)),H+=T;t.Zn(e,s,f,i+w,H,b,T*G,d)}else t.he(e,u,c,i+w,r+v,p,h,g,E,N,m,f,s,M,d);else(h<(U=e.measureText(u).width)||a<T)&&(e.rect(l,C,h,a),e.clip(),e.beginPath()),t.he(e,u,c,i+w,r+v,p,h,g,E,N,m,f,s,M,d,void 0,void 0,s.showEllipsis)}function Y(t,e,n,i,r,o,a,s,u){var c=!1,c;(c=!!e.wordWrap||(e.isVerticalText?o<s+a||r<u:r<s+a||o<u))&&(t.rect(n,i,r,o),t.clip(),t.beginPath())}function K(t){var e=0,t=t.textIndent;return e=0<t?8*t:e}function h(){var t=s.call(this)||this;return t.typeName="2",t.qu="columnHeader",t}function d(){var t=u.call(this)||this;return t.typeName="3",t.qu="rowHeader",t}function v(){var t=c.call(this)||this;return t.typeName="4",t}n=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RowHeader=t.ColumnHeader=t.Corner=void 0,i=e("Common"),r=e("./dist/core/util/domUtil.js"),R=e("./dist/core/util/common.js"),F=e("./dist/core/worksheet/stylehelper.js"),o=e("./dist/core/celltype/celltype.ns.js"),M=e("./dist/core/celltype/basecelltype.js"),_=e("./dist/core/core.enum.js"),w=R.I,A=R.q,k=R.mt.ri,N=R.mt.pt,L=R.mt.bt,D=i.Common.lt.ht,E=R.mt.wt,H=r.GC$.extend,T="none",U=void 0,j=Math.floor,O=R.Rect,s=M.Base,n(h,s),h.prototype.paint=function(t,e,n,i,r,o,a,s,u){f(this,t,e,n,i,r,o,a,s,this.qu,1,u)},h.prototype.paintContent=function(t,e,n,i,r,o,a,s,u){var c,f,c;M.Context.dn(t,E(e),n,i,r,o,s)||l(this,t,e,n,i,r,o,a,s,1,f=g(s.visualState,this.qu),u)},t.ColumnHeader=e=h,o.ti[2]=e,u=M.Base,n(d,u),d.prototype.paint=function(t,e,n,i,r,o,a,s){f(this,t,e,n,i,r,o,a,s,this.qu,2)},d.prototype.paintContent=function(t,e,n,i,r,o,a,s){var u,c,u;M.Context.dn(t,E(e),n,i,r,o,s)||l(this,t,e,n,i,r,o,a,s,2,c=g(s.visualState,this.qu))},t.RowHeader=i=d,o.ti[3]=i,c=M.Base,n(v,c),v.prototype.paint=function(t,e,n,i,r,o,a,s){var u,c,f,l,h,f,l,h,d,v,g,m,p,u,c,S,l;if(t){t.save(),t.rect(n,i,r,o),t.clip(),t.beginPath(),u=this,c=s.visualState||0;try{l=(f=u.getThemeStyle(s.visualState,"gc-corner-"+w.Ee(c)))&&f.backgroundColor,h=f&&f.backgroundImage,l?(t.fillStyle=l,t.fillRect(n,i,r,o)):h&&h!==T&&x(t,n,i,r,o,h)}catch(t){}if(l=(f=u.getThemeStyle(4,"gc-corner-triangle-"+w.Ee(c)))&&f.backgroundImage,h=f&&f.backgroundColor,d=t.createLinearGradient(n+r/2,i,n+r/2,i+o),l&&-1!==l.indexOf("linear-gradient")){for(g=0,m=(v=k(l)).length;g<m;g++)p=v[g],d.addColorStop(p.point,p.color);t.fillStyle=d}else h&&(d.addColorStop(.125,"#f6fafb"),d.addColorStop(1,h),t.fillStyle=d);(u=t.createLinearGradient(n+r,i+1,n+r,i+o-2)).addColorStop(0,f.borderLeftColor),u.addColorStop(1,f.borderRightColor),t.beginPath(),t.strokeStyle=u,t.moveTo(n+r-.5,i),t.lineTo(n+r-.5,i+o),t.stroke(),s.needLeftGridline&&(t.beginPath(),t.strokeStyle=f.borderLeftColor,t.moveTo(n+.5,i),t.lineTo(n+.5,i+o),t.stroke()),(c=t.createLinearGradient(n,i,n+r-2,i)).addColorStop(0,f.borderTopColor),c.addColorStop(1,f.borderBottomColor),t.beginPath(),t.strokeStyle=c,t.moveTo(n,i+o-.5),t.lineTo(n+r,i+o-.5),t.stroke(),s.needTopGridline&&(t.beginPath(),t.strokeStyle=f.borderTopColor,t.moveTo(n,i+.5),t.lineTo(n+r,i+.5),t.stroke()),t.beginPath(),S=3,r<(l=o)&&(l=r),s.sheet.options.rightToLeft?(t.moveTo(n+3,i+o-3),t.lineTo(n+3,i+o-l+3),t.lineTo(n+l+3,i+o-3)):(t.moveTo(n+r-l+3,i+o-3),t.lineTo(n+r-3,i+o-3),t.lineTo(n+r-3,i+o-l+3)),t.fill(),t.restore()}},t.Corner=r=v,o.ti[4]=r},"./dist/core/celltype/textcelltype.js":function(a,t,e){"use strict";var s,n,h,H,i,l,U,T,F,e,P,_,X,d,v,r,u,R,g,c,A,N,q,b,$,m,p,f,tt,S,w,E,et,nt,it,L,rt,ot,at,C,D,y,M,j,O,st,V,Y,K,ut,z,ct,ft,lt,ht,dt,k,x,vt,gt,mt,G,B,pt,W,St,wt,bt,Ct,J,yt,Mt,kt,Tt,xt,Gt,Bt,It,n,Pt,e,Rt;function Nt(t){return mt||0===t}function Et(t){return Nt(t)?(0,H.GC$)(g("textarea")):(0,H.GC$)(g("div"))}function Z(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function Q(t){return Z(t)?A&&parseFloat(c.version)<10?r.oi(t):t.innerText:t.value}function I(t,e){Z(t)?t.innerText=_(e)?"":e:t.value=e}function Ht(t){var e;Z(t)?((e=k.getSelection()).selectAllChildren(t),0<e.rangeCount&&e.collapseToEnd()):t.selectionStart=t.selectionEnd=t.value.length}function Ut(t){var e,n;return Z(t)?0<(e=k.getSelection()).rangeCount?(n=e.getRangeAt(0)).startOffset:0:t.selectionStart}function Ft(t){var e,n;return Z(t)?0<(e=k.getSelection()).rangeCount?(n=e.getRangeAt(0)).endOffset:0:t.selectionEnd}function _t(t){var e,t,n,i,r,o,e=t.keyCode,t=t.shiftKey,n={106:42,107:43,109:45,110:46,111:47,173:45},i={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},r={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},o=e;return 96<=e&&e<=105?o=e-48:n[e]?o=n[e]:t&&r[e]?o=r[e]:!t&&i[e]?o=i[e]:!t&&65<=e&&e<=90&&(o=e+32),o}function At(t){return t&&"BR"===t.tagName}function Lt(t){return t&&"SPAN"===t.tagName}function Dt(t){return t&&"DIV"===t.tagName}function jt(t){return t instanceof Text}function Ot(t){return t===Mt}function Vt(t,e,n,i){var r,o,r,o;return t.substr(0,e)+i+t.substr(n,t.length-n)}function Yt(t,e,n,i,r,o){for(var a,s,u,c,f,l,h,d,a="",s=t.childNodes,u=s.length,c=0;c<u;c++)Lt(f=s[c])?a+=Yt(f,e,n,i,r,o):jt(f)?(l=e&&e.startContainer,h=e&&e.endContainer,d=f.textContent,f===l||f===h?l!==h?o=f===l?(a+=Vt(d,n,d.length,r),!0):(a+=Vt(d,0,i,""),!1):a+=Vt(d,n,i,r):o||(a+=d)):At(f)&&!o&&(a+="\n");return a}function Kt(t,e,n,i,r){var r,o,a,r=String.fromCharCode(_t(r));return Z(t)?0<(o=k.getSelection()).rangeCount&&jt((a=o.getRangeAt(0)).startContainer)?Yt(t,a,n,i,r):a&&a.startOffset===a.endOffset?e+r:r:Vt(e,n,i,r)}function zt(t){var t=Qt(t);return t=t&&0<=t.indexOf(" ")?E(t," ",yt):t}function Wt(t,e,n,i,r,o){var a,s,u,n,c,f,l,f,c,l,n,f,a=t.srcElement||t.target;a&&a.getAttribute(C)===M&&13===t.keyCode&&(t.ctrlKey||t.altKey)&&((s=v.ai())instanceof h.Worksheet&&(u=s.getCellType(s.ui,s.ci))&&(Z(a)?(n&&(a.blur(),a.focus()),0<(n=k.getSelection()).rangeCount&&(c=n.getRangeAt(0),f=x.createElement("br"),l=x.createTextNode(Mt),c.insertNode(l),c.insertNode(f),Jt(c),(f=x.createRange()).setStartAfter(l),f.setEndAfter(l),f.collapse(!1),n.removeAllRanges(),n.addRange(f))):(c=a.selectionStart,n=(l=a.value).substr(0,c),f=l.substr(c,l.length-c),a.value=n+"\n"+f,a.selectionStart=c+1,a.selectionEnd=c+1),u.fi(s.li,G,G,t,e,!0)),b(t))}function Jt(t){var t,e,n,t=t.endContainer,e=t.lastChild;jt(e)&&0===e.textContent.length&&t.removeChild(e),n=(e=t.lastChild).previousSibling,Ot(e.textContent)&&!At(n)&&0===n.textContent.length&&t.removeChild(n)}function Zt(t){var e,t,e=t;return e&&(e.indexOf(Mt)<0&&e.indexOf("\n")<0?e:((t=t.split("\n")).forEach(function(t,e,n){Ot(t[0])&&(n[e]=t.substr(1))}),t.join("\n")))}function Qt(t){var t,e,t=t;return t=t&&0<(e=t.length)?t.replace(/\n/g,"\n"+Mt):t}function Xt(t){var e,n,i,r,o,e,a,s,u,e,c,f,l,h,d,e=k.getSelection(),n=!1,i=0,r=0,o="";if(0<e.rangeCount){if(e=e.getRangeAt(0),a=Ut(t),s=Ft(t),u=e.startContainer,e=e.endContainer,Dt(u))n=!0,i=a;else if(l=void 0,0<(f=(c=u.childNodes).length))for(l=0;l<f;l++){if(!(h=c[l]).tagName||"br"!==h.tagName.toLocaleLowerCase()){u=h;break}o+="\n"}return o+(d=qt(t,a,s,u,e,n,i,r=Dt(e)?s:r)).content}}function qt(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v;if(i===r&&!o)return{content:Zt(i.textContent.slice(e,n))};for(u="",c=a,h=t.childNodes,d=s||h.length;c<d;c++)if(Lt(v=h[c])){if(u+=(f=qt(v,e,n,i,r,o,0,0)).content,f.startFlag&&(o=!0),f.endFlag){l=!0;break}}else if(jt(v)&&v===i)u+=v.textContent.slice(e,v.textContent.length),o=!0;else{if(jt(v)&&v===r){u+=v.textContent.slice(0,n),l=!0;break}o&&(At(v)?u+="\n":u+=v.innerText||v.textContent)}return{content:Zt(u),startFlag:o,endFlag:l}}function $t(t,e){for(var n,i,r,n=t.length,i=[],r=0;r<n;r++)i.push(S(t[r],e));return i}function te(t){for(var e,n,i,e=t.length,n=0,i=0;i<e;i++)n+=t[i];return n}function ee(t,e,n,i){for(var r,o,a,s,r=0,o=n,a=0;a<t.length;a++)q&&(o=i[a]),t[a]>e?r+=o*(s=pt(t[a]/e)):r+=o;return r}function ne(t,e,n){var t=Q(t);return t&&"="===t[0]||""===t&&"="===e[0]||0===n&&"="===e[0]}function ie(t){var t=t&&t.tagName;return"TEXTAREA"===t||"INPUT"===t}function re(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?xt:Tt)}function oe(t){return(t.ctrlKey||t.metaKey)&&t.keyCode===(t.shiftKey?Tt:xt)}function ae(t){var e,n,i;if(t&&t.content)for(e=t.content.length-1;0<=e&&((n=t.content[e])&&n.value&&n.value.endsWith(kt));e--){for(i=n.value.length-1;0<=i&&n.value[i]===kt;i--);if(-1!==i){n.value=n.value.substring(0,i+1);break}t.content.pop()}}function se(t,e){t.ki(d,{sheet:t,sheetName:t.name(),row:t.ui,col:t.ci,editingText:e})}function ue(t,e,n,i,r,o,a){var s,u,c,f,l,t,i,h,i,d,v,t,r,i,g,m,s=t,u=a.sheet,c=u.zoom?u.zoom():1,l=i,t=o.textOrientation,i=o.textIndent&&0!==o.textIndent,h=o.isVerticalText;if(t&&-90<=t&&t<=90&&!i&&!h&&(i=bt(t*Math.PI/180),l=(r-a.lineHeight*wt(i))/St(i)),v={},r=(t=o.formatter)&&"General"!==t,i=R(t),g=o._autoFormatter&&o._autoFormatter.formatCached&&"General"!==o._autoFormatter.formatCached,(r="string"==typeof t?r&&!i:r)?d=o.formatter:g?d=o._autoFormatter:u.parent&&u.parent.options.numbersFitMode===T.NumbersFitMode.mask?d=U.Context.Nt(e,n,l,o,c):u.parent&&u.parent.options.numbersFitMode===T.NumbersFitMode.overflow&&(d=o._autoFormatter),!(f=i&&(n instanceof Date||"boolean"==typeof n||n instanceof Boolean||"number"==typeof n)?s.format(n,t,{}):s.format(nt(n),d,v,a))||!f.endsWith(kt)||!0!==o.wordWrap&&(5!==o.hAlign||a.sheet.options.showFormulas&&a.isFormula)||(f=(0,F.r2e)(f),ae(v)),!0!==o.shrinkToFit&&!h&&it(n)&&u.parent){switch(m=f,u.parent.options.numbersFitMode){case T.NumbersFitMode.mask:m=s.wi(e,f,l,o,c,a,v,u);break;case T.NumbersFitMode.overflow:m=s.overflow(e,a,n,o,u,f,v)}f=m}return f}function o(t){var e=Rt.call(this)||this;return e.allowOverflow=!0,e.typeName="1",e.editorType=_(t)?1:t,e}function ce(t){var e,t,n,i,r,e=["0","0","0","0"];return typeof t===Gt&&(r=i=void 0,1===(n=(t=t.split(" ",4)).length)?e=[i=t[0],i,i,i]:2===n?e=[i=t[0],r=t[1],i,r]:3===n?(r=t[1],e=[t[0],r,t[2],r]):4===n&&(e=[t[0],t[1],t[2],t[3]])),e}s=this&&this.__extends||(Pt=function(t,e){return(Pt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Pt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Text=t.TextCellType=t.EditorType=t.xHe=void 0,n=e("Common"),h=e("./dist/core/worksheet/worksheet.js"),H=e("./dist/core/util/domUtil.js"),i=e("./dist/core/util/common.js"),l=e("./dist/core/celltype/celltype.ns.js"),U=e("./dist/core/celltype/basecelltype.js"),T=e("./dist/core/core.enum.js"),F=e("./dist/core/util/common.js"),e=e("CalcEngine"),P=!!e,_=n.Common.lt.ht,X=i.q,d=i.Events.EditChange,v=i.hi,r=i.mt,u=i.di,R=r.St,g=r.En,c=r.Tt,A=c.msie,N=c.edge,q=c.chrome,b=r.vi,$=r.gt,m=r.mi,p=r.gi,f=r.pi(),tt=r.vt,S=r.bi,w=r.Mt,E=r.yi,et=r.yt,nt=r.wt,it=r.Ct,L="left",rt="right",ot="center",at="top",C="gcUIElement",D="none",y=".gcEditingInput",M="gcEditingInput",j="width",O="height",st="text-align",V="hidden",Y="word-wrap",K="overflow",ut="vertical-align",z="normal",ct="break-word",ft="overflow-y",lt="scroll",ht="word-break",dt="float",k=window,x=document,vt=.337,gt=f.ipad,mt=f.iphone||gt||f.android,G=null,B=void 0,pt=Math.ceil,W=Math.min,St=Math.sin,wt=Math.cos,bt=Math.abs,Ct=Math.max,J=parseInt,yt="\xa0",Mt="\u200b",kt=" ",Tt=90,xt=89,Gt="string",Bt="number",t.xHe=ue,(e=It=t.EditorType||(t.EditorType={}))[e.textarea=0]="textarea",e[e.editableDiv=1]="editableDiv",Rt=U.Base,s(o,Rt),o.prototype.getText=function(t,e){return t},o.prototype.paintValue=function(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v,g,m,p,S,w,p,m,b,p,C,y,C,M,y,k,p,v,C,u=this,c=s.sheet,f=c.zoom?c.zoom():1;if(e=u.getText(e,s),l={},s.quotePrefix=a.quotePrefix,v=(d=a.formatter)&&"General"!==d,g=R(d),"string"==typeof d&&(v=v&&!g),m=a.textOrientation,p=a.textIndent&&0!==a.textIndent,S=a.isVerticalText,w=r,m&&-90<=m&&m<=90&&!p&&!S&&(p=bt(m*Math.PI/180),w=(o-s.lineHeight*wt(p))/St(p)),m=(b=u.Pn(t,h,a,s,n,i,r,o)).externals,p=u.Hn(m.left),C=u.Hn(m.right),2===(y=3===(y=a.hAlign)?$(y,e,a.formatter||a._autoFormatter):y)?w-=C:0===y&&(w-=p),C=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,v?M=a.formatter:C?M=a._autoFormatter:c.parent&&c.parent.options.numbersFitMode===T.NumbersFitMode.mask?M=U.Context.Nt(t,e,w,a,f):c.parent&&c.parent.options.numbersFitMode===T.NumbersFitMode.overflow&&(M=a._autoFormatter),!(h=g&&(e instanceof Date||"boolean"==typeof e||e instanceof Boolean||"number"==typeof e)?u.format(e,d,{}):u.format(nt(e),M,l,s))||!h.endsWith(kt)||!0!==a.wordWrap&&(5!==a.hAlign||s.sheet.options.showFormulas&&s.isFormula)||(h=(0,F.r2e)(h),ae(l)),y=new F.Rect(n,i,r,o),this.adjustRectForIconSet(a.hAlign,s.sheet,s.row,s.col,s.sheetArea,y,l.content&&this.hasInfilling(l.content)),n=y.x,r=y.width,!0!==a.shrinkToFit&&!S)if(it(e)){if(c.parent){switch(k=h,c.parent.options.numbersFitMode){case T.NumbersFitMode.mask:k=this.wi(t,h,w,a,f,s,l,c);break;case T.NumbersFitMode.overflow:k=this.overflow(t,s,e,a,c,h,l)}h=k}}else void 0===c.Ut.Ci(s.row,s.col,s.sheetArea)||a.showEllipsis||c.Ut.$n(s.row,s.col,void 0,s.sheetArea);p=a.labelOptions,v=a.watermark,C=!p||0!==p.visibility,v&&!h&&C?u.paintText(t,v,n,i,r,o,a,s,v,l,vt):(h||l.content&&l.content.length||a.cellButtons&&a.cellButtons.length)&&u.paintText(t,e,n,i,r,o,a,s,h,l,B,m)},o.prototype.wi=function(t,e,n,i,r,o,a,s){var u,t,n,u,u=o.cellOverflowLayout&&o.cellOverflowLayout.expandedWidth,t=U.Context.Et(t,e,_(u)?n:u,i,r),n=o.row,u=o.col;return e!==t?(delete a.content,i.textIndent=0,s.Ut.$n(n,u,s.getText(n,u,o.sheetArea),o.sheetArea)):s.Ut.$n(n,u,void 0,o.sheetArea),t},o.prototype.overflow=function(t,e,n,i,r,o,a){var s,u,t,c,f,l,h,s=e.row,u=e.col;if(i.wordWrap&&(i.wordWrap=!1),t=w(t,i.font,o),c=r.Jt.Kt(u),l=void 0,!(f=e.cellOverflowLayout)&&c<t)l=r.getText(s,u,e.sheetArea);else if(f&&c<t&&this.Si(f.backgroundWidth)&&this.Si(f.valueWidth)){if(!this.Si(i.hAlign))return;h=void 0,l=(h=1!==i.hAlign?f.valueWidth>f.backgroundWidth:f.valueWidth/2>f.backgroundLeftWidth||f.valueWidth/2>f.backgroundRightWidth)?r.getText(s,u,e.sheetArea):void 0}return r.Ut.$n(s,u,l,e.sheetArea),o},o.prototype.Si=function(t){return null!=t},o.prototype.createEditorElement=function(t,e){var t,t,e,n,t=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,t=p(t)+1e3;return(0,H.GC$)(e).css("z-index",t),e=Et(this.editorType),(0,H.GC$)(e).css({font:"normal 11pt calibri",outline:D,resize:D,border:D,"vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(Y,z).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(K,V).attr(C,M),c.safari&&(0,H.GC$)(e).css("-webkit-user-select","auto"),(n=Z((0,H.GC$)(e)[0]))&&((0,H.GC$)(e).css("display","table-cell"),(0,H.GC$)(e).css(ht,z)),(0,H.GC$)(e)[0]},o.prototype.getEditorValue=function(t,e){var n,i,e,t;return t&&(n=Q(t),i=!_(n)&&0<n.length,U.Base.et(e&&e.sheet,"getEditorValue",e={editor:t,ns:y,editorValue:n}),i)?(t=(t=Zt(n=e.editorValue)).replace(/\r\n?/g,"\n")).indexOf(yt)<0?t:E(t,yt," "):G},o.prototype.setEditorValue=function(t,e,n,i,r){var o,a,e,a,r;t&&(a=o=void 0,n&&n.sheet&&(o=n.sheet.Ai,a=n.sheet.getValue(n.row,n.col)),e=zt(e),U.Base.et(n&&n.sheet,"setEditorValue",a={editor:t,ns:y,editorValue:e,originValue:a,startEditByKeydown:o,addPercent:i||r,cancel:!1}),!0===a.cancel?(I(t,a.editorValue),this.qmt(t,a.caret),n&&n.sheet&&(r=n.sheet).ki(F.Events.FormulaTextBoxTextChanged,{sheet:r,sheetName:r.name(),text:a.editorValue})):A?o&&n.isImeInput||I(t,e=_(e)?i?"%":"":e):I(t,e=o?i?"%":"":e))},o.prototype.selectAll=function(t,e){var n;t&&t.select?t.select():k.getSelection().selectAllChildren(t)},o.prototype.focus=function(t,e){var n,i,t,e,n=this;n.isImeAware()&&t?Ht(i=t):i=t.parentNode.parentNode,i.focus(),t=n.Xmt(i),U.Base.et(e&&e.sheet,"afterSetEditorFocus",e={editor:i,caret:t,cancel:!1}),!0===e.cancel&&e.caret&&n.qmt(i,e.caret)},o.prototype.je=function(t,e,n,i){var r,o,e,r=t&&i&&i.sheet,o={},e=m(e,n,r,i,o);return t.Ii=o.formatter||B,e},o.prototype.Xmt=function(t){var e,n,i,r,o,r;return t&&(e=x.activeElement===t)?(i=n=-1,o=r=void 0,ie(t)?(n=t.selectionStart,i=t.selectionEnd):Z(t)&&0<(r=k.getSelection()).rangeCount&&((r=(o=r.getRangeAt(0)).cloneRange()).selectNodeContents(t),r.setEnd(o.endContainer,o.endOffset),i=r.toString().length,(r=o.cloneRange()).selectNodeContents(t),r.setEnd(o.startContainer,o.startOffset),n=r.toString().length,r.detach()),{start:n,end:i,length:i-n}):null},o.prototype.qmt=function(t,e){var n,i,r,o,a,s,u,n=e.start,i=e.end,r=document.createRange(),o=window.getSelection();if(t.childNodes[0]){if((a=t.childNodes[0].textContent.length)<n){for(s=0;t.childNodes[s]&&0<=n;)n-=t.childNodes[s].textContent.length,s++;r.setStart(t.childNodes[s-1],n+t.childNodes[s-1].textContent.length)}else r.setStart(t.childNodes[0],n);if(a<(i=i>e.start?i-1:i)){for(s=0;t.childNodes[s]&&0<=i;)i-=t.childNodes[s].textContent.length,s++;r.setEnd(t.childNodes[s-1],i+t.childNodes[s-1].textContent.length)}else r.setEnd(t.childNodes[0],i);r.collapse(!0),o.removeAllRanges(),o.addRange(r)}else t.value&&(a=(u=t.value).length,n=W(n,a),i=i>e.start?i-1:i,i=W(i,a),t.setSelectionRange(n,i))},o.prototype.activateEditor=function(e,l,h,d,v,g,m){var p,S,w,e,o,e,t,n,i,r,a,s,n,p=d&&d.sheet;if(p&&(S=this,w=e)){if(e=(0,H.GC$)(w),o=Z(w),S._editingElement=w,e.attr(C)||e.attr(C,M),f.android&&e.bind("input"+y,function(t){try{S.fi(w,l,h,t,d,!1,v,g,m)}catch(t){}}),e.bind("keydown"+y,function(t){var e,n,i;try{e=t.keyCode,n={event:t,editor:w,value:Q(w),caret:S.Xmt(w),cancel:!1},8===e?(U.Base.et(p,"editorBackspace",n),!0===n.cancel?(b(t),I(w,n.value),S.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})):o&&u.processBackspaceAndLeftArrowKeyEvent(t,!0)):46===e?(U.Base.et(p,"editorDelete",n),!0===n.cancel?(b(t),I(w,n.value),S.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})):o&&u.processDeleteAndRightArrowKeyEvent(t,!0)):37===e&&o?u.processBackspaceAndLeftArrowKeyEvent(t,!1):39===e&&o&&u.processDeleteAndRightArrowKeyEvent(t,!1),re(t)&&o?(U.Base.et(p,"editorUndo",n),!0===n.cancel&&(b(t),I(w,n.value),S.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value}))):oe(t)&&o&&(U.Base.et(p,"editorRedo",n),!0===n.cancel)&&(b(t),I(w,n.value),S.qmt(w,n.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:n.value})),((i=229===e||0===e)||S.Ni)&&!f.android||S.fi(w,l,h,t,d,!0,v,g,m),Wt(t,d,S.Ni,v,g,m)}catch(t){}}),e.bind("keyup"+y,function(t){var e,n,i,r,e=t.keyCode,n=t.ctrlKey,i=t.altKey,r;(!(229===e||0===e)&&!S.Ni||f.android)&&(46!==e&&8!==e&&(90!==e&&89!==e||!n||i)||(o&&"\n"===w.innerText&&(0,H.GC$)(w).empty(),S.fi(w,l,h,t,d,!1,v,g,m)),13!==e&&9!==e&&27!==e&&16!==e||n||i)&&se(p,S.getEditorValue(w,d))}),e.bind("mousedown"+y,function(){1===p.Di&&(p.Di=2,p._i(1,2))}),e.bind("textInput"+y,function(t){var e,e,n,n;if(c.safari){if(t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key)return;e=t.key||t.data,e={editor:w,value:e,caret:S.Xmt(w),cancel:!1},U.Base.et(p,"editorInput",e),!0===e.cancel&&(b(t),I(w,e.value),n=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&n&&n.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),S.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value}))}t.data&&(S.probabilityAddPercentSpec||S.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)&&((n=document.createElement("span")).innerText="%",n.id="updateEditorImpAddPercent",("#text"===w.firstChild.nodeName?w:w.firstChild).appendChild(n),delete S.probabilityAddPercentSpec,delete S.probabilityAddPercent)}),e.bind("compositionstart"+y,function(){S.Ni=!0,S.Ei=Q(w)}),e.bind("compositionupdate"+y,function(t){S.fi(w,l,h,t||G,d,!0,v,g,m)}),e.bind("compositionend"+y,function(t){var e,e,n,n,e,t,i,e=t.data,e={editor:w,value:e,caret:S.Xmt(w),isImeInputting:!0,cancel:!1};U.Base.et(p,"editorInput",e),!0===e.cancel&&(b(t),I(w,e.value),n=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&n&&n.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),S.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})),S.fi(w,l,h,t||G,d,!1,v,g,m),S.Ni=!1,n=t.keyCode,e=t.ctrlKey,t=t.altKey,i=S.getEditorValue(w,d)||"",S.Ei!==i&&(n===B||13!==n&&9!==n||e||t)&&se(p,i)}),o&&(e.bind("copy"+y,function(t){var e=k.clipboardData,n=t.clipboardData,i=Xt(t.currentTarget);_(i)||(e&&e.setData?(e.setData("text",i),b(t)):n&&n.setData&&(n.setData("text/plain",i),b(t)))}),e.bind("cut"+y,function(t){var e,e,n,i,r,r,e=Xt(t.currentTarget),n="editorCut";!_(e)&&w.Rse&&(k.clipboardData&&k.clipboardData.setData?(i="text",r=k.clipboardData):t.clipboardData&&t.clipboardData.setData&&(i="text/plain",r=t.clipboardData),e={editor:w,clipboardData:r,dataName:i,caret:S.Xmt(w)},U.Base.et(p,n,e),b(t),I(w,e.value),r=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&r&&r.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),S.qmt(w,e.caret)),S.ji=k.setTimeout(function(){se(p,S.getEditorValue(w,d)),S.ji&&(clearTimeout(S.ji),delete S.ji)},10)}),e.bind("paste"+y,function(t){var e,n,i,r,o,a,s,u,c,f,e=!1;try{n=void 0,A&&!N&&k.clipboardData&&k.clipboardData.getData?n=k.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(n=t.clipboardData.getData("text/plain")),n=zt(n=n.replace(/\r\n?/g,"\n")),i={editor:w,pasteValue:n,caret:S.Xmt(w),cancel:!1},U.Base.et(p,"editorPaste",i),!0===i.cancel?(e=!0,I(w,i.pasteValue),S.qmt(w,i.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:i.pasteValue})):0<(r=k.getSelection()).rangeCount&&((a=(o=r.getRangeAt(0)).startOffset)!==(s=o.endOffset)&&o.deleteContents(),ne(w,n,a)||(u=x.createElement("span"),"\n"===(n=8203===n[(c=n.length)-1].charCodeAt(0)&&"\n"===n[c-2]?n.replace(/\u200B/g,""):n)[(c=n.length)-1]&&(n="\r"===n[c-2]?n.substr(0,c-2):n.substr(0,c-1)),u.innerText=n,o.insertNode(u),(f=document.createRange()).setStartAfter(u),f.setEndAfter(u),f.collapse(!1),r.removeAllRanges(),r.addRange(f),e=!0))}catch(t){}if(S.ji=k.setTimeout(function(){S.fi(w,l,h,t,d,!1,v,g,m),p.parent&&p.parent.ki(F.Events.FormulaTextBoxUpdatePosition,void 0),se(p,S.getEditorValue(w,d)),S.ji&&(clearTimeout(S.ji),delete S.ji)},10),e)return!1}),e.bind("keypress"+y,function(t){var e,e,t;t.metaKey||t.altKey||t.ctrlKey||"Enter"===t.key||(e=t.key||t.data,e={editor:w,value:e,caret:S.Xmt(w),cancel:!1},U.Base.et(p,"editorInput",e),!0===e.cancel&&(b(t),I(w,e.value),t=p.getCellType(d.row,d.col),w.parentNode&&w.parentNode.parentNode&&t&&t.Rn(w.parentNode.parentNode,l,p.getCellRect(d.row,d.col),d),S.qmt(w,e.caret),p.ki(F.Events.FormulaTextBoxTextChanged,{sheet:p,sheetName:p.name(),text:e.value})))})),t=e=void 0,(e=!d||(t=P&&p.getFormula(d.row,d.col))?e:l.mask)&&e.pattern&&"="===e.pattern[0]){n=p.Lp,i=p.Uw(3),r=0<=d.row?d.row:0,a=0<=d.col?d.col:0;try{s=n.evaluate(i,e.pattern,r,a),e.pattern="object"==typeof s?"":""+s}catch(t){e.pattern=""}}n={editor:w,ns:y,mask:e,text:Q(w)},U.Base.et(p,"activateEditor",n)}},o.prototype.deactivateEditor=function(t,e){var n,i,r,o,a,s,u,c,f,l,n=this;if(U.Base.et(e&&e.sheet,"deactivateEditor",{editor:t}),t&&e&&e.sheet){if(i=e.sheet,n.Ni&&gt&&i.Oi)try{(0,H.GC$)(t).trigger("compositionend"+y)}catch(t){}if(r=i.getActualStyle(e.row,e.col,e.sheetArea).cellPadding)for(o=[L,at],a=[3,0],s=0;s<o.length;s++)u=parseInt(ce(r)[a[s]],10),n.shiftPadding(t,o[s],u=typeof u==Bt&&0<u?u:0);(0,H.GC$)(t).unbind(y),c=i.getActiveRowIndex(),f=i.getActiveColumnIndex(),l=i.getActualStyle(c,f),i.Ri(n,t,c,f,l,B,B,B,B,e.sheetArea)}n._editingElement=G},o.prototype.shiftPadding=function(t,e,n){var t=(0,H.GC$)(t).parent();t&&(e===L?t.css({left:(+(0,H.GC$)(t).css(L).replace("px","")||0)-n}):e===at&&t.css({top:(+(0,H.GC$)(t).css(at).replace("px","")||0)-n}))},o.prototype.getEditingElement=function(){return this._editingElement},o.prototype.Bi=function(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,v,r,g,m,p,S,w,b,C,y,M,k,T,b,T,t,x,a,x,l,t,n,G,v,n,B,I,P,R,v,G,N,E,n,a,x,g,f,i,c=r&&r.sheet,f=this,l=c.options.sheetAreaOffset,h=t;if(h&&c&&(d=(0,H.GC$)(h),v=c.Dn,r=r.preventOverflow,g=Q(h),c.isEditing())){if(m=Z(h),S=L,w=p=void 0,b=U.Context.gn,k=M=y=C=0,e&&(C=b(e,0,!1,T=c.zoom()),y=b(e,1,!1,T),M=b(e,2,!1,T),k=b(e,3,!1,T),1===(p=$(e.hAlign,t.Li))||5===p?S=ot:2===p&&(S=rt),d.css(st,S),e.foreColor&&d.css("color",e.foreColor),(w=e.font||v.Nn())&&(1<c.zoom()&&(w=v._n(w)),d.css("font",et(w))),e.textDecoration)&&f.Qe(d,e.textDecoration),b=(J(d.css("padding-left"),10)||0)+(J(d.css("padding-right"),10)||0),T=(J(d.css("padding-top"),10)||0)+(J(d.css("padding-bottom"),10)||0),n||(b+=2*Number(d.parent().css("left").replace("px","")),T+=2*Number(d.parent().css("top").replace("px",""))),(a=_(a)?n:a)&&(t=c.Fi(),x=n.width,a.x+a.width-l.left>t.width&&(x=n.width=t.width-n.x,a.width=t.width-a.x),d.css(j,x-b).css(O,n.height-T),c.options.rightToLeft?h.maxWidth=l.left+t.BA-n.x-b-y:h.maxWidth=l.left+t.width-n.x-b-y,d.css("max-width",h.maxWidth+"px"),h.maxHeight=l.top+t.height-n.y-T-M,h.minWidth=J(h.style.width,10),h.minHeight=J(h.style.height,10)),a=Ut(h),x=Ft(h),l=(o=(o=o&&i&&i.keyCode&&c.rt.Pi(i)&&0===a&&x===g.length)||c.Ai)&&!e.mask?"":g,w=(w=h.style.font)||v._n(v.Nn()),t=tt(w),i&&f.probabilityAddPercent&&(n=i.key)&&-1!==F.NUMBER_ARRAY.indexOf(n)&&(c.parent.options.enableFormulaTextbox?(v=h.innerText,/[a-z]/i.test(v)?f.probabilityAddPercent=!1:((G=document.createElement("span")).innerText="%",G.id="updateEditorImpAddPercent",h.appendChild(G),delete f.probabilityAddPercent)):((G=document.createElement("span")).innerText="%",G.id="updateEditorImpAddPercent",h.firstChild.appendChild(G),delete f.probabilityAddPercent)),!o&&i&&(n=c.parent,c.rt.Pi(i)&&8!==i.keyCode&&_(n.contextMenu.menuView.getHost())&&(l=Kt(h,l,a,x,i)),f.Ni)&&(l=A?g:f.Ei+i.data),B=[],P=I=void 0,R=(B=e&&(e.wordWrap||5===p)?X.un(l,J(h.style.width)-b,w):l.split(/\r\n|\r|\n/)).length,h.minWidth=W(h.minWidth,h.maxWidth),h.minHeight=W(h.minHeight,h.maxHeight),e&&(e.wordWrap||5===p)||0<R){if(G=v=void 0,v=q?te(G=$t(B,w)):R*t,e&&(e.wordWrap||5===p))d.css(Y,ct).css(K,V).css("max-width",h.style.width);else{for(E=[],I=N=0;I<R;I++)P=pt(c.Gi(B[I],w)),E.push(P),N=Ct(N,P);n=d.css(Y),a=J(h.style.width),e||n!==ct?N<=h.minWidth?(d.css(j,h.minWidth).css(Y,z).css(K,V),m&&d.css(ht,z)):N>h.minWidth&&N<=h.maxWidth&&!r?(d.css(j,N).css(Y,z).css(K,V),m&&d.css(ht,z)):N>h.maxWidth&&!r&&(d.css(j,h.maxWidth-2).css(Y,ct).css(K,V),v=ee(E,h.maxWidth,t,G)):a<N&&!r&&(v=ee(E,a,t,G))}v<=h.minHeight?d.css(O,h.minHeight).css(dt,D):v>h.minHeight&&v<=h.maxHeight?d.css(O,v).css(dt,D):v>h.maxHeight&&d.css(O,h.maxHeight-1).css(ft,lt).css(dt,L)}return S=d.css(st),x=d.width()-h.minWidth,_(S)||S===L||(S===ot?d.css(L,h.originalLeft-x/2):S===rt&&d.css(L,h.originalLeft-x)),e&&m&&(1===(g=e.vAlign)?d.css(ut,"middle"):2===g&&d.css(ut,"bottom")),f=J(h.style.height)+T+C+M,i=b+k+y,d.css(ft)===lt?{width:h.offsetWidth+i,height:o?0:f}:{width:J(h.style.width)+i,height:f}}},o.prototype.updateEditor=function(t,e,n,i,r,o,a){var e,i,s;return n=this.Bi(t,e,n,G,i,!1,r,o,a),A&&t&&(i=(e=(0,H.GC$)(t))[0].style.width,e.width(i+1).width(i)),s=!_(n)&&t?new F.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,n.width,n.height):s},o.prototype.fi=function(t,e,n,i,r,o,a,s,u){var i,o;n=this.Bi(t,e,n,i,r,o,a,s,u),A&&t&&(o=(i=(0,H.GC$)(t))[0].style.width,i.width(o+1).width(o)),!_(n)&&t&&(_(a)?a=n:(a.x=B,a.y=B),this.updateEditorContainer(t,n,e,r,a,s,u))},o.prototype.updateEditorContainer=function(t,e,n,i,r,o,a){var s,s,u;i&&i.preventOverflow?(Rt.prototype.updateEditorContainer.call(this,t,e,n,i,r,o,a),(s=t.parentNode)&&e&&(s=(0,H.GC$)(s),0<(u=e.width))&&s.width(u)):(e&&e.width&&r&&r.width&&(r.width=e.width),e&&e.height&&r&&r.height&&(r.height=e.height),Rt.prototype.updateEditorContainer.call(this,t,e,n,i,r,o,a))},o.prototype.updateImeMode=function(t,e,n){this.isImeAware()&&t&&U.Context.hn(t,e)},o.prototype.isReservedKey=function(t,e){var n=t.srcElement||t.target,i=t.keyCode,r=t.ctrlKey,o=t.altKey,a=t.metaKey;return!!(n&&e&&e.isEditing&&n.getAttribute(C)===M)&&(13===i&&(r&&!t.shiftKey||o)||90===i&&r&&!o||89===i&&r&&!o||67===i&&(r||a)&&!o||88===i&&(r||a)&&!o)},o.prototype.isImeAware=function(t){return!0},o.prototype.toJSON=function(){var t,e,n,t={},e=this;for(n in e)e.hasOwnProperty(n)&&"_editingElement"!==n&&(t[n]=e[n]);return t},o.prototype.lfe=function(t,e){var e={eventName:e,eventArg:t};return U.Base.et(t.sheet,"onCreateEventArg",e),e.eventArg},t.TextCellType=n=o,t.Text=n,l.ti[1]=n},"./dist/core/core.definition.js":function(){},"./dist/core/core.entry.js":function(t,e,n){"use strict";var i,r,o,a,s,u,c,u,f,r,l,h;function d(t,e){return a._Ae(t,e)}i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&("get"in r?e.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)},Object.defineProperty(e,"__esModule",{value:!0}),e.Aoe=e._Ae=e.CellTypes=e.xHe=e.isPrintZoomFactorExist=e.paintDecoration=e.cellTypeContext_paintBackground=void 0,n("./dist/core/core.res.en.js"),o=n("./dist/core/util/common.js"),Object.defineProperty(e,"getTypeFromString",{set:function(t){o.getTypeFromString=t},get:function(){return o.getTypeFromString}}),r(n("./dist/core/core.ns.js"),e),r(n("./dist/core/core.interface.js"),e),r(n("./dist/core/core.enum.js"),e),r(n("./dist/core/util/common.js"),e),r(n("./dist/core/excel-io-util/common.js"),e),r(n("./dist/core/excel-io-util/excel-types.js"),e),r(n("./dist/core/excel-io-util/range-parser.js"),e),r(n("./dist/core/excel-io-util/excel-helper.js"),e),r(n("./dist/core/excel-io-util/excel-style.js"),e),r(n("./dist/core/util/domUtil.js"),e),n("./dist/core/core.definition.js"),u=-1,1===(s=(a=n("./dist/core/lc/debugLc.js"))._pt)&&(u=Math.floor(5*Math.random()),e["G".concat("C","$")]["s".concat("d")]=u),r(n("./dist/core/util/theme.js"),e),r(n("./dist/core/util/basedialog.js"),e),r(n("./dist/core/util/imageLoader.js"),e),r(n("./dist/core/util/tasks.js"),e),r(n("./dist/core/util/crypto.js"),e),r(n("./dist/core/util/dataManager.js"),e),r(n("./dist/core/util/custom-list.js"),e),0===u&&n("./dist/core/lc/debugLc.js"),r(n("./dist/core/worksheet/stylehelper.js"),e),1===u&&n("./dist/core/lc/debugLc.js"),r(n("./dist/core/worksheet/style.js"),e),2===u&&n("./dist/core/lc/debugLc.js"),r(n("./dist/core/worksheet/clipboardhelper.js"),e),3===u&&n("./dist/core/lc/debugLc.js"),r(n("./dist/core/worksheet/worksheet-model.js"),e),4===u&&n("./dist/core/lc/debugLc.js"),r(n("./dist/core/worksheet/worksheet.js"),e),r(n("./dist/core/worksheet/worksheet-formatter.js"),e),r(n("./dist/core/worksheet/worksheet-actions.js"),e),r(n("./dist/core/worksheet/worksheet-border.js"),e),n("./dist/core/worksheet/worksheet-edit.js"),r(n("./dist/core/worksheet/worksheet-event.js"),e),n("./dist/core/worksheet/worksheet-json.js"),r(n("./dist/core/worksheet/worksheet-render.js"),e),n("./dist/core/worksheet/worksheet-selection.js"),n("./dist/core/worksheet/worksheet-sort.js"),r(n("./dist/core/worksheet/worksheet-ui.js"),e),r(n("./dist/core/worksheet/worksheet-static.js"),e),r(n("./dist/core/worksheet/worksheet-clipboard.js"),e),(0,(c=n("./dist/core/worksheet/feature-registers/index.js")).registerWorkbookFeatures)(),r(n("./dist/core/workbook/workbook.js"),e),r(n("./dist/core/workbook/workbook-json.js"),e),r(n("./dist/core/workbook/sheettabbase.js"),e),r(n("./dist/core/workbook/sheettab.js"),e),r(n("./dist/core/workbook/sheettab2007.js"),e),r(n("./dist/core/workbook/workbookpanelex.js"),e),r(n("./dist/core/workbook/customThemeManager.js"),e),r(n("./dist/core/worksheet/attachmentManager/index.js"),e),r(n("./dist/core/util/styleManager.js"),e),u=n("./dist/core/celltype/cellType.entry.js"),e.CellTypes=u,f=n("./dist/core/celltype/basecelltype.js"),Object.defineProperty(e,"cellTypeContext_paintBackground",{enumerable:!0,get:function(){return f.cellTypeContext_paintBackground}}),Object.defineProperty(e,"paintDecoration",{enumerable:!0,get:function(){return f.paintDecoration}}),Object.defineProperty(e,"isPrintZoomFactorExist",{enumerable:!0,get:function(){return f.isPrintZoomFactorExist}}),r=n("./dist/core/celltype/headercelltype.js"),l=n("./dist/core/celltype/textcelltype.js"),h=n("./dist/core/celltype/textcelltype.js"),Object.defineProperty(e,"xHe",{enumerable:!0,get:function(){return h.xHe}}),u.Hi=r,u.zi=l,1!==s&&2!==s||a.Vi(e),e._Ae=d,e.Aoe=a.Aoe},"./dist/core/core.enum.js":function(F,t){"use strict";var e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,E,_,A,L,D,j,O,V,Y,K,z,W,J,H,Z,Q,X,q,$,tt,et,nt,it,rt,ot,at,st,ut,ct,ft,lt,ht,dt,vt,gt,mt,pt,St,wt,bt,Ct,yt,Mt,kt,Tt,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,U,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U,H,U;Object.defineProperty(t,"__esModule",{value:!0}),t.CaptionAlignment=t.IconPosition=t.ButtonPosition=t.DropDownType=t.ButtonImageType=t.ButtonVisibility=t.RowColumnStates=t.CellStatesType=t.SortState=t.SheetArea=t.VerticalPosition=t.HorizontalPosition=t.Yi=t.ImageLayout=t.ValueType=t.RangeChangedAction=t.HeaderAutoText=t.StorageType=t.SelectionUnit=t.SelectionPolicy=t.ImeMode=t.EditorStatus=t.VisualState=t.Zi=t.VertAlign=t.VerticalAlign=t.HorizontalAlign=t.TextDirectionType=t.TextDecorationType=t.LabelVisibility=t.LabelAlignment=t.PasteOperationOptions=t.CopyToOptions=t.ClipboardPasteOptions=t.AutoFitType=t.InvalidOperationType=t.ResizeZeroIndicator=t.HeaderOptions=t.CalculationType=t.CalculationMode=t.CopyPasteHeaderOptions=t.ResizeMode=t.InsertShiftCell=t.ShowScrollTip=t.ScrollbarAppearance=t.ShowResizeTip=t.WorksheetType=t.ScrollbarState=t.AxisInfoChangeType=t.ScrollType=void 0,t.AllowDragHeaderToMove=t.ListType=t.SheetTabState=t.DefaultChangeValueType=t.ClipboardActionType=t.OpenMode=t.OpenSaveFileType=t.FileType=t.TableStyleElement=t.SortBy=t.UsedRangeType=t.ColumnHeaderFitMode=t.AllSheetsListVisibility=t.SheetTabVisible=t.SheetType=t.HyperlinkTargetType=t.TabStripPosition=t.NumbersFitMode=t.PatternType=t.DropDownAlignment=t.DropDownDirection=t.DropdownListValue=t.GroupSort=t.CalendarStartDay=t.CalendarPage=t.LayoutDisplayAs=t.LayoutDirection=void 0,(H=e=t.ScrollType||(t.ScrollType={}))[H.pixels=0]="pixels",H[H.continuous=1]="continuous",(H=n=t.AxisInfoChangeType||(t.AxisInfoChangeType={}))[H.setRowCount=0]="setRowCount",H[H.setColumnCount=1]="setColumnCount",H[H.addRows=2]="addRows",H[H.deleteRows=3]="deleteRows",H[H.addColumns=4]="addColumns",H[H.deleteColumns=5]="deleteColumns",H[H.setRowHeight=6]="setRowHeight",H[H.setColumnWidth=7]="setColumnWidth",H[H.setRowVisible=8]="setRowVisible",H[H.setColumnVisible=9]="setColumnVisible",H[H.filterRows=10]="filterRows",H[H.outlineExpandRows=11]="outlineExpandRows",H[H.outlineExpandColumns=12]="outlineExpandColumns",(H=i=t.ScrollbarState||(t.ScrollbarState={}))[H.hide=0]="hide",H[H.show=1]="show",H[H.active=2]="active",H[H.inactive=3]="inactive",(H=r=t.WorksheetType||(t.WorksheetType={}))[H.worksheet=0]="worksheet",H[H.reportTemplateSheet=1]="reportTemplateSheet",(H=o=t.ShowResizeTip||(t.ShowResizeTip={}))[H.none=0]="none",H[H.column=1]="column",H[H.row=2]="row",H[H.both=3]="both",(H=a=t.ScrollbarAppearance||(t.ScrollbarAppearance={}))[H.skin=0]="skin",H[H.mobile=1]="mobile",(H=s=t.ShowScrollTip||(t.ShowScrollTip={}))[H.none=0]="none",H[H.horizontal=1]="horizontal",H[H.vertical=2]="vertical",H[H.both=3]="both",(H=u=t.InsertShiftCell||(t.InsertShiftCell={}))[H.right=0]="right",H[H.down=1]="down",(H=c=t.ResizeMode||(t.ResizeMode={}))[H.normal=0]="normal",H[H.split=1]="split",(H=f=t.CopyPasteHeaderOptions||(t.CopyPasteHeaderOptions={}))[H.noHeaders=0]="noHeaders",H[H.rowHeaders=1]="rowHeaders",H[H.columnHeaders=2]="columnHeaders",H[H.allHeaders=3]="allHeaders",(H=l=t.CalculationMode||(t.CalculationMode={}))[H.auto=0]="auto",H[H.manual=1]="manual",(H=h=t.CalculationType||(t.CalculationType={}))[H.all=0]="all",H[H.rebuild=1]="rebuild",H[H.minimal=2]="minimal",H[H.regular=3]="regular",(H=d=t.HeaderOptions||(t.HeaderOptions={}))[H.noHeaders=0]="noHeaders",H[H.rowHeaders=1]="rowHeaders",H[H.columnHeaders=2]="columnHeaders",H[H.allHeaders=3]="allHeaders",(H=v=t.ResizeZeroIndicator||(t.ResizeZeroIndicator={}))[H.default=0]="default",H[H.enhanced=1]="enhanced",(H=g=t.InvalidOperationType||(t.InvalidOperationType={}))[H.setFormula=0]="setFormula",H[H.copyPaste=1]="copyPaste",H[H.dragFill=2]="dragFill",H[H.dragDrop=3]="dragDrop",H[H.changePartOfArrayFormula=4]="changePartOfArrayFormula",H[H.changeSheetName=5]="changeSheetName",H[H.table=6]="table",H[H.filter=7]="filter",H[H.hideSheet=8]="hideSheet",H[H.sort=9]="sort",H[H.pivotTable=10]="pivotTable",H[H.ptOverlapValue=11]="ptOverlapValue",H[H.groupProtected=12]="groupProtected",H[H.editProtected=13]="editProtected",H[H.cutProtected=14]="cutProtected",H[H.customName=15]="customName",H[H.dataObjectCellTypeInsertData=16]="dataObjectCellTypeInsertData",H[H.reportSheet=17]="reportSheet",H[H.sizeLimitExceeded=18]="sizeLimitExceeded",(H=m=t.AutoFitType||(t.AutoFitType={}))[H.cell=0]="cell",H[H.cellWithHeader=1]="cellWithHeader",(H=p=t.ClipboardPasteOptions||(t.ClipboardPasteOptions={}))[H.all=0]="all",H[H.values=1]="values",H[H.formatting=2]="formatting",H[H.formulas=3]="formulas",H[H.valuesAndFormatting=4]="valuesAndFormatting",H[H.formulasAndFormatting=5]="formulasAndFormatting",H[H.comments=6]="comments",H[H.validation=7]="validation",H[H.usingSourceTheme=8]="usingSourceTheme",H[H.noBorder=9]="noBorder",H[H.columnWidths=10]="columnWidths",H[H.formulasAndNumberFormatting=11]="formulasAndNumberFormatting",H[H.valuesAndNumberFormatting=12]="valuesAndNumberFormatting",H[H.valuesAndSourceFormatting=13]="valuesAndSourceFormatting",H[H.allAndColumnWidth=14]="allAndColumnWidth",(H=S=t.CopyToOptions||(t.CopyToOptions={}))[H.value=1]="value",H[H.formula=2]="formula",H[H.comment=4]="comment",H[H.outline=8]="outline",H[H.sparkline=16]="sparkline",H[H.span=32]="span",H[H.style=64]="style",H[H.tag=128]="tag",H[H.bindingPath=256]="bindingPath",H[H.conditionalFormat=512]="conditionalFormat",H[H.hyperlink=1024]="hyperlink",H[H.defaultValue=2048]="defaultValue",H[H.altText=4096]="altText",H[H.all=8191]="all",(H=w=t.PasteOperationOptions||(t.PasteOperationOptions={}))[H.none=0]="none",H[H.add=1]="add",H[H.subtract=2]="subtract",H[H.multiply=3]="multiply",H[H.divide=4]="divide",(H=b=t.LabelAlignment||(t.LabelAlignment={}))[H.topLeft=0]="topLeft",H[H.topCenter=1]="topCenter",H[H.topRight=2]="topRight",H[H.bottomLeft=3]="bottomLeft",H[H.bottomCenter=4]="bottomCenter",H[H.bottomRight=5]="bottomRight",(H=C=t.LabelVisibility||(t.LabelVisibility={}))[H.visible=0]="visible",H[H.hidden=1]="hidden",H[H.auto=2]="auto",(H=y=t.TextDecorationType||(t.TextDecorationType={}))[H.underline=1]="underline",H[H.lineThrough=2]="lineThrough",H[H.overline=4]="overline",H[H.doubleUnderline=8]="doubleUnderline",H[H.none=0]="none",(H=M=t.TextDirectionType||(t.TextDirectionType={}))[H.context=0]="context",H[H.leftToRight=1]="leftToRight",H[H.rightToLeft=2]="rightToLeft",(H=k=t.HorizontalAlign||(t.HorizontalAlign={}))[H.left=0]="left",H[H.center=1]="center",H[H.right=2]="right",H[H.general=3]="general",H[H.centerContinuous=4]="centerContinuous",H[H.distributed=5]="distributed",(H=T=t.VerticalAlign||(t.VerticalAlign={}))[H.top=0]="top",H[H.center=1]="center",H[H.bottom=2]="bottom",(H=x=t.VertAlign||(t.VertAlign={}))[H.normal=0]="normal",H[H.superscript=1]="superscript",H[H.subscript=2]="subscript",(H=G=t.Zi||(t.Zi={}))[H.smallDecrement=0]="smallDecrement",H[H.smallIncrement=1]="smallIncrement",H[H.largeDecrement=2]="largeDecrement",H[H.largeIncrement=3]="largeIncrement",H[H.thumbPosition=4]="thumbPosition",H[H.thumbTrack=5]="thumbTrack",H[H.endScroll=6]="endScroll",(H=B=t.VisualState||(t.VisualState={}))[H.normal=0]="normal",H[H.highlight=1]="highlight",H[H.selected=2]="selected",H[H.active=3]="active",H[H.hover=4]="hover",H[H.activeNotSelected=5]="activeNotSelected",(H=I=t.EditorStatus||(t.EditorStatus={}))[H.ready=0]="ready",H[H.enter=1]="enter",H[H.edit=2]="edit",(H=P=t.ImeMode||(t.ImeMode={}))[H.auto=1]="auto",H[H.active=2]="active",H[H.inactive=4]="inactive",H[H.disabled=0]="disabled",(H=R=t.SelectionPolicy||(t.SelectionPolicy={}))[H.single=0]="single",H[H.range=1]="range",H[H.multiRange=2]="multiRange",(H=N=t.SelectionUnit||(t.SelectionUnit={}))[H.cell=0]="cell",H[H.row=1]="row",H[H.column=2]="column",(H=E=t.StorageType||(t.StorageType={}))[H.data=1]="data",H[H.style=2]="style",H[H.comment=4]="comment",H[H.tag=8]="tag",H[H.sparkline=16]="sparkline",H[H.axis=32]="axis",H[H.bindingPath=64]="bindingPath",H[H.hyperlink=256]="hyperlink",H[H.altText=512]="altText",(H=_=t.HeaderAutoText||(t.HeaderAutoText={}))[H.blank=0]="blank",H[H.numbers=1]="numbers",H[H.letters=2]="letters",(H=A=t.RangeChangedAction||(t.RangeChangedAction={}))[H.dragDrop=0]="dragDrop",H[H.dragFill=1]="dragFill",H[H.clear=2]="clear",H[H.paste=3]="paste",H[H.sort=4]="sort",H[H.setArrayFormula=5]="setArrayFormula",H[H.evaluateFormula=6]="evaluateFormula",(H=L=t.ValueType||(t.ValueType={}))[H.normal=0]="normal",H[H.richText=1]="richText",(H=D=t.ImageLayout||(t.ImageLayout={}))[H.stretch=0]="stretch",H[H.center=1]="center",H[H.zoom=2]="zoom",H[H.none=3]="none",(H=j=t.Yi||(t.Yi={})).ThumbButton="thumbButton",H.TrackButton="trackButton",H.LeftButton="leftButton",H.RightButton="rightButton",H.UpButton="upButton",H.DownButton="downButton",(H=O=t.HorizontalPosition||(t.HorizontalPosition={}))[H.left=0]="left",H[H.center=1]="center",H[H.right=2]="right",H[H.nearest=3]="nearest",(H=V=t.VerticalPosition||(t.VerticalPosition={}))[H.top=0]="top",H[H.center=1]="center",H[H.bottom=2]="bottom",H[H.nearest=3]="nearest",(H=Y=t.SheetArea||(t.SheetArea={}))[H.corner=0]="corner",H[H.colHeader=1]="colHeader",H[H.rowHeader=2]="rowHeader",H[H.viewport=3]="viewport",(H=K=t.SortState||(t.SortState={}))[H.none=0]="none",H[H.ascending=1]="ascending",H[H.descending=2]="descending",(H=z=t.CellStatesType||(t.CellStatesType={}))[H.hover=1]="hover",H[H.invalid=2]="invalid",H[H.readonly=4]="readonly",H[H.edit=8]="edit",H[H.active=16]="active",H[H.selected=32]="selected",H[H.dirty=64]="dirty",H[H.invalidFormula=128]="invalidFormula",(H=W=t.RowColumnStates||(t.RowColumnStates={}))[H.hover=1]="hover",H[H.invalid=2]="invalid",H[H.edit=8]="edit",H[H.active=16]="active",H[H.selected=32]="selected",H[H.dirty=64]="dirty",H[H.inserted=128]="inserted",H[H.invalidFormula=512]="invalidFormula",(H=J=t.ButtonVisibility||(t.ButtonVisibility={}))[H.always=0]="always",H[H.onSelected=1]="onSelected",H[H.onEditing=2]="onEditing",(U=H=t.ButtonImageType||(t.ButtonImageType={}))[U.none=0]="none",U[U.custom=1]="custom",U[U.clear=2]="clear",U[U.cancel=3]="cancel",U[U.ok=4]="ok",U[U.dropdown=5]="dropdown",U[U.ellipsis=6]="ellipsis",U[U.left=7]="left",U[U.right=8]="right",U[U.plus=9]="plus",U[U.minus=10]="minus",U[U.undo=11]="undo",U[U.redo=12]="redo",U[U.search=13]="search",U[U.separator=14]="separator",U[U.spinLeft=15]="spinLeft",U[U.spinRight=16]="spinRight",U[U.collapse=17]="collapse",U[U.expand=18]="expand",H.calcel=H.cancel,(U=Z=t.DropDownType||(t.DropDownType={}))[U.colorPicker=0]="colorPicker",U[U.dateTimePicker=1]="dateTimePicker",U[U.timePicker=2]="timePicker",U[U.monthPicker=3]="monthPicker",U[U.list=4]="list",U[U.slider=5]="slider",U[U.calculator=6]="calculator",U[U.workflowList=7]="workflowList",U[U.multiColumn=8]="multiColumn",(H=Q=t.ButtonPosition||(t.ButtonPosition={}))[H.left=0]="left",H[H.right=1]="right",H[H.leftOfText=2]="leftOfText",H[H.rightOfText=3]="rightOfText",(U=X=t.IconPosition||(t.IconPosition={}))[U.left=0]="left",U[U.right=1]="right",U[U.leftOfText=2]="leftOfText",U[U.rightOfText=3]="rightOfText",U[U.outsideLeft=4]="outsideLeft",U[U.outsideRight=5]="outsideRight",(H=q=t.CaptionAlignment||(t.CaptionAlignment={}))[H.left=0]="left",H[H.right=1]="right",(U=$=t.LayoutDirection||(t.LayoutDirection={}))[U.horizontal=0]="horizontal",U[U.vertical=1]="vertical",(H=tt=t.LayoutDisplayAs||(t.LayoutDisplayAs={}))[H.inline=0]="inline",H[H.popup=1]="popup",H[H.tree=2]="tree",(U=et=t.CalendarPage||(t.CalendarPage={}))[U.year=1]="year",U[U.month=2]="month",U[U.day=3]="day",(H=nt=t.CalendarStartDay||(t.CalendarStartDay={}))[H.monday=1]="monday",H[H.tuesday=2]="tuesday",H[H.wednesday=3]="wednesday",H[H.thursday=4]="thursday",H[H.friday=5]="friday",H[H.saturday=6]="saturday",H[H.sunday=7]="sunday",(U=it=t.GroupSort||(t.GroupSort={}))[U.none=0]="none",U[U.group=1]="group",U[U.child=2]="child",U[U.full=3]="full",(H=rt=t.DropdownListValue||(t.DropdownListValue={}))[H.string=0]="string",H[H.array=1]="array",(U=ot=t.DropDownDirection||(t.DropDownDirection={}))[U.Down=0]="Down",U[U.Up=1]="Up",U[U.Left=2]="Left",U[U.Right=3]="Right",(H=at=t.DropDownAlignment||(t.DropDownAlignment={}))[H.Near=0]="Near",H[H.Center=1]="Center",H[H.Far=2]="Far",(U=st=t.PatternType||(t.PatternType={}))[U.solid=1]="solid",U[U.darkGray=2]="darkGray",U[U.mediumGray=3]="mediumGray",U[U.lightGray=4]="lightGray",U[U.gray125=5]="gray125",U[U.gray0625=6]="gray0625",U[U.darkHorizontal=7]="darkHorizontal",U[U.darkVertical=8]="darkVertical",U[U.darkDown=9]="darkDown",U[U.darkUp=10]="darkUp",U[U.darkGrid=11]="darkGrid",U[U.darkTrellis=12]="darkTrellis",U[U.lightHorizontal=13]="lightHorizontal",U[U.lightVertical=14]="lightVertical",U[U.lightDown=15]="lightDown",U[U.lightUp=16]="lightUp",U[U.lightGrid=17]="lightGrid",U[U.lightTrellis=18]="lightTrellis",(H=ut=t.NumbersFitMode||(t.NumbersFitMode={}))[H.mask=0]="mask",H[H.overflow=1]="overflow",(U=ct=t.TabStripPosition||(t.TabStripPosition={}))[U.bottom=0]="bottom",U[U.top=1]="top",U[U.left=2]="left",U[U.right=3]="right",(H=ft=t.HyperlinkTargetType||(t.HyperlinkTargetType={}))[H.blank=0]="blank",H[H.self=1]="self",H[H.parent=2]="parent",H[H.top=3]="top",(U=lt=t.SheetType||(t.SheetType={}))[U.tableSheet=0]="tableSheet",U[U.ganttSheet=1]="ganttSheet",U[U.customSheetTab=2]="customSheetTab",U[U.reportSheet=3]="reportSheet",U[U.printSheet=9007199254740991]="printSheet",(H=ht=t.SheetTabVisible||(t.SheetTabVisible={}))[H.hidden=0]="hidden",H[H.visible=1]="visible",H[H.veryHidden=2]="veryHidden",(U=dt=t.AllSheetsListVisibility||(t.AllSheetsListVisibility={}))[U.hide=0]="hide",U[U.show=1]="show",U[U.auto=2]="auto",(H=vt=t.ColumnHeaderFitMode||(t.ColumnHeaderFitMode={}))[H.normal=0]="normal",H[H.vertical=1]="vertical",H[H.stack=2]="stack",(U=gt=t.UsedRangeType||(t.UsedRangeType={}))[U.all=262143]="all",U[U.axis=1]="axis",U[U.style=2]="style",U[U.rowStyle=4]="rowStyle",U[U.colStyle=8]="colStyle",U[U.data=16]="data",U[U.formula=32]="formula",U[U.span=64]="span",U[U.shape=128]="shape",U[U.table=256]="table",U[U.sparkLine=512]="sparkLine",U[U.comment=1024]="comment",U[U.slicer=2048]="slicer",U[U.pivottable=4096]="pivottable",U[U.filter=8192]="filter",U[U.dataValidation=16384]="dataValidation",U[U.conditionFormat=32768]="conditionFormat",U[U.chart=65536]="chart",U[U.picture=131072]="picture",(H=mt=t.SortBy||(t.SortBy={})).cellColor="cellColor",H.fontColor="fontColor",H.icon="icon",H.value="value",(U=pt=t.TableStyleElement||(t.TableStyleElement={})).wholeTable="wholeTable",U.firstColumnStripe="firstColumnStripe",U.secondColumnStripe="secondColumnStripe",U.firstRowStripe="firstRowStripe",U.secondRowStripe="secondRowStripe",U.lastColumn="lastColumn",U.firstColumn="firstColumn",U.headerRow="headerRow",U.totalRow="totalRow",U.firstHeaderCell="firstHeaderCell",U.lastHeaderCell="lastHeaderCell",U.firstTotalCell="firstTotalCell",U.lastTotalCell="lastTotalCell",(H=St=t.FileType||(t.FileType={}))[H.excel=0]="excel",H[H.ssjson=1]="ssjson",H[H.csv=2]="csv",(U=wt=t.OpenSaveFileType||(t.OpenSaveFileType={}))[U.excel=0]="excel",U[U.sjs=1]="sjs",(H=bt=t.OpenMode||(t.OpenMode={}))[H.normal=0]="normal",H[H.lazy=1]="lazy",H[H.incremental=2]="incremental",(U=Ct=t.ClipboardActionType||(t.ClipboardActionType={}))[U.copy=1]="copy",U[U.cut=2]="cut",U[U.reset=3]="reset",(H=yt=t.DefaultChangeValueType||(t.DefaultChangeValueType={})).Expression="expr",H.Value="value",(U=Mt=t.SheetTabState||(t.SheetTabState={}))[U.hover=1]="hover",U[U.selected=2]="selected",U[U.active=4]="active",U[U.protected=8]="protected",U[U.normal=16]="normal",(H=kt=t.ListType||(t.ListType={}))[H.disc=0]="disc",H[H.circle=1]="circle",H[H.square=2]="square",H[H.decimal=3]="decimal",H[H.lowerAlpha=4]="lowerAlpha",H[H.upperAlpha=5]="upperAlpha",H[H.lowerRoman=6]="lowerRoman",H[H.upperRoman=7]="upperRoman",H[H.lowerGreek=8]="lowerGreek",(U=Tt=t.AllowDragHeaderToMove||(t.AllowDragHeaderToMove={}))[U.none=0]="none",U[U.column=1]="column",U[U.row=2]="row",U[U.both=3]="both"},"./dist/core/core.interface.js":function(t,e){"use strict";var n,e;Object.defineProperty(e,"__esModule",{value:!0}),e.CornerPosition=void 0,(e=n=e.CornerPosition||(e.CornerPosition={}))[e.leftTop=1]="leftTop",e[e.rightTop=2]="rightTop",e[e.leftBottom=4]="leftBottom",e[e.rightBottom=8]="rightBottom"},"./dist/core/core.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SR=void 0;var n=n("./dist/core/core.res.en.js");e.SR={en:n}},"./dist/core/core.res.en.js":function(t,e,n){"use strict";var i,r;for(r in Object.defineProperty(e,"__esModule",{value:!0}),e.ARIA_Cell=e.ARIA_Scrollbar_TRACK_Button=e.ARIA_Scrollbar_Bottom_Button=e.ARIA_Scrollbar_Right_Button=e.ARIA_Scrollbar_Thumb_Button=e.ARIA_Scrollbar_Top_Button=e.ARIA_Scrollbar_Left_Button=e.ARIA_Blank=e.ARIA_NewSheet=e.ARIA_SheetTab=e.ARIA_NextButton=e.ARIA_PreviousButton=e.ARIA_Last=e.ARIA_NextArrow=e.ARIA_PreviousArrow=e.ARIA_First=e.ARIA_Resize=e.NeedCanvasSupport=e.Exp_OverlappingSpans=e.Exp_SheetIsNull=e.Exp_DestSheetIsNull=e.Exp_ArrayFormulaSpan=e.Exp_SheetNameConflict=e.Exp_SheetNameInvalid=e.Exp_EmptyNamedStyle=e.NewTab=e.Tip_Width=e.Tip_Height=e.Tip_Column_Offset=e.Tip_Column=e.Tip_Row=e.Exp_PasteChangeMergeCell=e.Exp_PasteDestinationCellsLocked=e.Exp_InvalidCopyPasteSize=e.Exp_PasteSourceCellsLocked=e.Exp_ArgumentOutOfRange=e.Exp_NotAFunction=e.Exp_InvalidRange=e.Exp_IndexOutOfRange=e.Exp_CustomNameBothInUse=e.Exp_InvalidCustomName=e.Exp_InvalidCustomFunction=e.Exp_DestIsNull=e.Exp_SrcIsNull=e.Exp_InvalidAndSpace=e.Exp_ChangePartOfArray=e.Exp_MultipleSelections=e.Exp_InvalidPastedArea=e.Exp_PasteExtentIsNull=e.Exp_NotSupported=void 0,e.cancel=e.ok=e.pasteSpecialOptionDialog=e.STEP=e.Exp_InvalidOperationSizeLimitExceeded=e.EXP_UNSUPPORT_CRYPTO_ALGORITHM=e.GENERAL=e.NORMAL=e.EXP_INVALID_PASSWORD=e.EXP_NO_PASSWORD=e.EXP_FILE_FORMAT=e.EXP_IO=e.Exp_InvalidOperationInProtect=e.Exp_InvalidSortPartTableOrMultiTableInRange=e.Exp_InvalidSortSpanInRange=e.Exp_InvalidSortArrayFormulaInRange=e.Exp_InsertCopiedCutCellsAffectTable=e.Exp_InsertCopiedCutCellsOverlap=e.Exp_InsertCopiedCutCellsNoRange=e.Exp_InsertCopiedCutCellsOnSpanTable=e.Exp_InsertCopiedCutCells=e.REPORT_SUMMARY=e.SHEET_NAME=e.ARIA_ColumnHeader=e.ARIA_RowHeader=e.ARIA_HasComment=e.ARIA_HasHyperlink=e.ARIA_HasButton=e.ARIA_HasCheckbox=e.ARIA_HasFormula=e.ARIA_HasValue=void 0,e.Exp_NotSupported="Not supported exception",e.Exp_PasteExtentIsNull="pasteExtent is null",e.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",e.Exp_MultipleSelections="This action won't work on multiple selections.",e.Exp_ChangePartOfArray="Cannot change part of an array.",e.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",e.Exp_SrcIsNull="The argument 'src' is null",e.Exp_DestIsNull="The argument 'dest' is null",e.Exp_InvalidCustomFunction="invalid custom function",e.Exp_InvalidCustomName="invalid custom name",e.Exp_CustomNameBothInUse="Both the current name and new name are referenced in cell formulas",e.Exp_IndexOutOfRange="Index is out of range!",e.Exp_InvalidRange="Invalid range",e.Exp_NotAFunction="Not A Function",e.Exp_ArgumentOutOfRange="ArgumentOutOfRange",e.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",e.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",e.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",e.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",e.Tip_Row="Row: ",e.Tip_Column="Column: ",e.Tip_Column_Offset="Offset: ",e.Tip_Height="Height: {0} pixels",e.Tip_Width="Width: {0} pixels",e.NewTab="New...",e.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",e.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",e.Exp_SheetNameConflict="That name is already taken. Try a different one.",e.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",e.Exp_DestSheetIsNull="destSheet is null",e.Exp_SheetIsNull="sheet is null.",e.Exp_OverlappingSpans="This operation will cause overlapping spans.",e.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",e.ARIA_Resize="resize",e.ARIA_First="first",e.ARIA_PreviousArrow="previous arrow",e.ARIA_NextArrow="next arrow",e.ARIA_Last="last",e.ARIA_PreviousButton="previous button",e.ARIA_NextButton="next button",e.ARIA_SheetTab="sheet tab",e.ARIA_NewSheet="new sheet",e.ARIA_Blank="blank",e.ARIA_Scrollbar_Left_Button="scrollbar left button",e.ARIA_Scrollbar_Top_Button="scrollbar top button",e.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",e.ARIA_Scrollbar_Right_Button="scrollbar right button",e.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",e.ARIA_Scrollbar_TRACK_Button="scrollbar track button",e.ARIA_Cell="cell",e.ARIA_HasValue="has value {0}",e.ARIA_HasFormula="has formula {0}",e.ARIA_HasCheckbox="has checkbox {0}",e.ARIA_HasButton="has button {0}",e.ARIA_HasHyperlink="has hyperlink {0}",e.ARIA_HasComment="has comment {0}",e.ARIA_RowHeader="row header",e.ARIA_ColumnHeader="column header",e.SHEET_NAME="Sheet",e.REPORT_SUMMARY="Sum",i=n("./dist/core/lc/lr.en.js"))i.hasOwnProperty(r)&&(e[r]=i[r]);e.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",e.Exp_InsertCopiedCutCellsOnSpanTable="This won\u2019t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",e.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",e.Exp_InsertCopiedCutCellsOverlap="This selection isn't valid. Make sure the copy and paste areas don't overlap unless they are the same size and shape.",e.Exp_InsertCopiedCutCellsAffectTable="You can't rearrange cells within a table this way, because it might affect other table cells in an unexpected way.",e.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",e.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",e.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist.",e.Exp_InvalidOperationInProtect="The cell or chart you're trying to change is on a protected sheet. To make a change, unprotect the sheet.",e.EXP_IO="File read and write exception.",e.EXP_FILE_FORMAT="Incorrect file format.",e.EXP_NO_PASSWORD="The Excel file cannot be opened because the workbook/worksheet is password protected.",e.EXP_INVALID_PASSWORD="The specified password is incorrect.",e.NORMAL="Normal",e.GENERAL="General",e.EXP_UNSUPPORT_CRYPTO_ALGORITHM="Unsupported cryptographic algorithms",e.Exp_InvalidOperationSizeLimitExceeded="File size exceeds set limit the max size.",e.STEP={start:"start load {0}",loadFileData:"load {0}'s data to spread",loadSheetData:"load {0}'s data",startCalc:"start reCalc",loadSheetFormula:"load {0}'s formula",parseFile:"parse {0} content"},e.pasteSpecialOptionDialog={title:"Paste Special",paste:"Paste",pasteOptions:{all:"All",formulas:"Formulas",values:"Values",formats:"Formats",comments:"Comments",validation:"Validation",usingSourceTheme:"All using Source theme",noBorders:"All except borders",columnWidth:"Column widths",formulasAndNumberFormats:"Formulas and number formats",valueAndNumberFormats:"Value and number formats"},operation:"Operation",operationOptions:{none:"None",add:"Add",subtract:"Subtract",multiply:"Multiply",divide:"Divide"},skipBlanks:"Skip blanks",transpose:"Transpose",pasteLink:"Paste Link"},e.ok="OK",e.cancel="Cancel"},"./dist/core/excel-io-util/common.js":function(t,e,n){"use strict";var i,r,s,v,g,u,c,f,l,o,a,h,d,m,n,p,S,w,b,C,y;function M(){}function k(){}function T(){}function x(t,e){var e,e,n,e=e.toUpperCase(),e=p[e];return e?(n=m,(n=e.reg?e.prefix:m)+t):t}function G(e,t,n){var i,r,n,t,i,r=function(t){return e.getColumnWidth(t)},n=B(n,function(t){return e.getRowHeight(t)},e.getRowCount(),e.defaults.rowHeight),t=B(t,r,e.getColumnCount(),e.defaults.colWidth);return{rowIndex:n.index,rowOffset:n.offset,colIndex:t.index,colOffset:t.offset}}function B(t,e,n,i){for(var r,o,a,s,u,c,r=-1,o=-1,a=0,s=0;s<n;s++)if(t<(a+=u=e(s))){r=s,o=t-(a-u);break}return-1===r&&a<t&&(r=n+(c=i?Math.floor((t-a)/i):0),o=t-(a+c*i)),{index:r,offset:o}}function I(t,e){for(var n=e;n<t.length;n++)if("'"===t[n]||'"'===t[n])return n;return n}function P(t,e){var n,i,r;if(t&&"string"==typeof t){for(n=[],i=0;i<t.length&&(r=I(t,i),n.push(e(t.substring(i,r))),r<t.length);i++){if(-1===(i=t.indexOf(t[r],r+1))){n.push(t.substring(r));break}n.push(t.substring(r,i+1))}return n.join("")}return t}function R(){}function N(){}Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedNumberFormatHelper=e.excelSupportProtectionOptions=e.protectionOptionsMap=e.SJSStylePropsToStyleProps=e.Util=e.NodeHelper=e.IndexHelper=e.StringEx=e.STEP_RATE=void 0,i=n("Common"),r=n("./dist/core/core.enum.js"),s=n("./dist/core/util/domUtil.js"),v=n("./dist/core/util/common.js"),g=n("./dist/core/excel-io-util/excel-types.js"),u=n("./dist/core/excel-io-util/excel-helper.js"),c=/_x00[0-1][0-9A-Fa-f]_/,f=i.Common.lt.ht,l=null,o=g.XFileConstants.Wi,a=g.XFileConstants.Qi,h=g.XFileConstants.Ki,d=/([A-Z][A-Z.]+)\(/gi,m="_xlfn.",p={AVERAGEIF:/\bAVERAGEIF\b\(/gi,AVERAGEIFS:/\bAVERAGEIFS\b\(/gi,CUBEKPIMEMBER:/\bCUBEKPIMEMBER\b\(/gi,CUBEMEMBER:/\bCUBEMEMBER\b\(/gi,CUBEMEMBERPROPERTY:/\bCUBEMEMBERPROPERTY\b\(/gi,CUBERANKEDMEMBER:/\bCUBERANKEDMEMBER\b\(/gi,CUBESET:/\bCUBESET\b\(/gi,CUBESETCOUNT:/\bCUBESETCOUNT\b\(/gi,CUBEVALUE:/\bCUBEVALUE\b\(/gi,COUNTIFS:/\bCOUNTIFS\b\(/gi,IFERROR:/\bIFERROR\b\(/gi,SUMIFS:/\bSUMIFS\b\(/gi,ACOT:/\bACOT\b\(/gi,ACOTH:/\bACOTH\b\(/gi,AGGREGATE:/\bAGGREGATE\b\(/gi,ARABIC:/\bARABIC\b\(/gi,BASE:/\bBASE\b\(/gi,"BETA.DIST":/\bBETA\.DIST\b\(/gi,"BETA.INV":/\bBETA\.INV\b\(/gi,"BINOM.DIST":/\bBINOM\.DIST\b\(/gi,"BINOM.DIST.RANGE":/\bBINOM\.DIST\.RANGE\b\(/gi,"BINOM.INV":/\bBINOM\.INV\b\(/gi,BITAND:/\bBITAND\b\(/gi,BITLSHIFT:/\bBITLSHIFT\b\(/gi,BITOR:/\bBITOR\b\(/gi,BITRSHIFT:/\bBITRSHIFT\b\(/gi,BITXOR:/\bBITXOR\b\(/gi,"CEILING.MATH":/\bCEILING\.MATH\b\(/gi,"CEILING.PRECISE":/\bCEILING\.PRECISE\b\(/gi,"CHISQ.DIST":/\bCHISQ\.DIST\b\(/gi,"CHISQ.DIST.RT":/\bCHISQ\.DIST\.RT\b\(/gi,"CHISQ.INV":/\bCHISQ\.INV\b\(/gi,"CHISQ.INV.RT":/\bCHISQ\.INV\.RT\b\(/gi,"CHISQ.TEST":/\bCHISQ\.TEST\b\(/gi,COMBINA:/\bCOMBINA\b\(/gi,CONCAT:/\bCONCAT\b\(/gi,"CONFIDENCE.T":/\bCONFIDENCE\.T\b\(/gi,"CONFIDENCE.NORM":/\bCONFIDENCE\.NORM\b\(/gi,COT:/\bCOT\b\(/gi,"COVARIANCE.P":/\bCOVARIANCE\.P\b\(/gi,"COVARIANCE.S":/\bCOVARIANCE\.S\b\(/gi,CSC:/\bCSC\b\(/gi,CSCH:/\bCSCH\b\(/gi,DAYS:/\bDAYS\b\(/gi,DECIMAL:/\bDECIMAL\b\(/gi,ENCODEURL:/\bENCODEURL\b\(/gi,"ERF.PRECISE":/\bERF\.PRECISE\b\(/gi,"ERFC.PRECISE":/\bERFC\.PRECISE\b\(/gi,"EXPON.DIST":/\bEXPON\.DIST\b\(/gi,"F.DIST":/\bF\.DIST\b\(/gi,"F.DIST.RT":/\bF\.DIST\.RT\b\(/gi,"F.INV":/\bF\.INV\b\(/gi,"F.INV.RT":/\bF\.INV\.RT\b\(/gi,FILTERXML:/\bFILTERXML\b\(/gi,"FLOOR.MATH":/\bFLOOR\.MATH\b\(/gi,"FLOOR.PRECISE":/\bFLOOR\.PRECISE\b\(/gi,FORMULATEXT:/\bFORMULATEXT\b\(/gi,GAMMA:/\bGAMMA\b\(/gi,"GAMMA.DIST":/\bGAMMA\.DIST\b\(/gi,"GAMMA.INV":/\bGAMMA\.INV\b\(/gi,"GAMMALN.PRECISE":/\bGAMMALN\.PRECISE\b\(/gi,"HYPGEOM.DIST":/\bHYPGEOM\.DIST\b\(/gi,IFNA:/\bIFNA\b\(/gi,IFS:/\bIFS\b\(/gi,IMCOSH:/\bIMCOSH\b\(/gi,IMCOT:/\bIMCOT\b\(/gi,IMCSCH:/\bIMCSCH\b\(/gi,IMSEC:/\bIMSEC\b\(/gi,IMSECH:/\bIMSECH\b\(/gi,IMSINH:/\bIMSINH\b\(/gi,IMTAN:/\bIMTAN\b\(/gi,ISFORMULA:/\bISFORMULA\b\(/gi,ISOWEEKNUM:/\bISOWEEKNUM\b\(/gi,"LOGNORM.DIST":/\bLOGNORM\.DIST\b\(/gi,"LOGNORM.INV":/\bLOGNORM\.INV\b\(/gi,MAXIFS:/\bMAXIFS\b\(/gi,MINIFS:/\bMINIFS\b\(/gi,"MODE.MULT":/\bMODE\.MULT\b\(/gi,"MODE.SNGL":/\bMODE\.SNGL\b\(/gi,MUNIT:/\bMUNIT\b\(/gi,"NEGBINOM.DIST":/\bNEGBINOM\.DIST\b\(/gi,"NORM.DIST":/\bNORM\.DIST\b\(/gi,"NORM.INV":/\bNORM\.INV\b\(/gi,"NORM.S.DIST":/\bNORM\.S\.DIST\b\(/gi,"NORM.S.INV":/\bNORM\.S\.INV\b\(/gi,NUMBERVALUE:/\bNUMBERVALUE\b\(/gi,PDURATION:/\bPDURATION\b\(/gi,"PERCENTILE.EXC":/\bPERCENTILE\.EXC\b\(/gi,"PERCENTILE.INC":/\bPERCENTILE\.INC\b\(/gi,"PERCENTRANK.EXC":/\bPERCENTRANK\.EXC\b\(/gi,"PERCENTRANK.INC":/\bPERCENTRANK\.INC\b\(/gi,PERMUTATIONA:/\bPERMUTATIONA\b\(/gi,PHI:/\bPHI\b\(/gi,"POISSON.DIST":/\bPOISSON\.DIST\b\(/gi,"QUARTILE.EXC":/\bQUARTILE\.EXC\b\(/gi,"QUARTILE.INC":/\bQUARTILE\.INC\b\(/gi,"RANK.AVG":/\bRANK\.AVG\b\(/gi,"RANK.EQ":/\bRANK\.EQ\b\(/gi,RRI:/\bRRI\b\(/gi,SECH:/\bSECH\b\(/gi,SHEET:/\bSHEET\b\(/gi,SHEETS:/\bSHEETS\b\(/gi,"STDEV.P":/\bSTDEV\.P\b\(/gi,"STDEV.S":/\bSTDEV\.S\b\(/gi,SWITCH:/\bSWITCH\b\(/gi,"T.DIST":/\bT\.DIST\b\(/gi,"T.DIST.2T":/\bT\.DIST\.2T\b\(/gi,"T.DIST.RT":/\bT\.DIST\.RT\b\(/gi,"T.INV":/\bT\.INV\b\(/gi,"T.INV.2T":/\bT\.INV\.2T\b\(/gi,TEXTJOIN:/\bTEXTJOIN\b\(/gi,UNICHAR:/\bUNICHAR\b\(/gi,UNICODE:/\bUNICODE\b\(/gi,"VAR.P":/\bVAR\.P\b\(/gi,"VAR.S":/\bVAR\.S\b\(/gi,WEBSERVICE:/\bWEBSERVICE\b\(/gi,"WEIBULL.DIST":/\bWEIBULL\.DIST\b\(/gi,XOR:/\bXOR\b\(/gi,"Z.TEST":/\bZ\.TEST\b\(/gi,XMATCH:/\bXLOOKUP\b\(/gi,XLOOKUP:/\bXLOOKUP\b\(/gi,RANDARRAY:/RANDARRAY\(/gi,SEQUENCE:/SEQUENCE\(/gi,IMAGE:/IMAGE\(/gi,SORTBY:/SORTBY\(/gi,UNIQUE:/UNIQUE\(/gi,ANCHORARRAY:/ANCHORARRAY\(/gi,SINGLE:/SINGLE\(/gi,LET:/\bLET\b\(/gi,LAMBDA:/\bLAMBDA\b\(/gi,MAP:/\bMAP\b\(/gi,REDUCE:/\bREDUCE\b\(/gi,SCAN:/\bSCAN\b\(/gi,MAKEARRAY:/\bMAKEARRAY\b\(/gi,BYCOL:/\bBYCOL\b\(/gi,BYROW:/\bBYROW\b\(/gi,ISOMITTED:/\bISOMITTED\b\(/gi,FILTER:{reg:/FILTER\(/gi,prefix:n="_xlfn._xlws."},SORT:{reg:/SORT\(/gi,prefix:n},TEXTBEFORE:/\bTEXTBEFORE\b\(/gi,TEXTAFTER:/\bTEXTAFTER\b\(/gi,TEXTSPLIT:/\bTEXTSPLIT\b\(/gi,VSTACK:/\bVSTACK\b\(/gi,HSTACK:/\bHSTACK\b\(/gi,TOROW:/\bTOROW\b\(/gi,TOCOL:/\bTOCOL\b\(/gi,WRAPROWS:/\bWRAPROWS\b\(/gi,WRAPCOLS:/\bWRAPCOLS\b\(/gi,TAKE:/\bTAKE\b\(/gi,DROP:/\bDROP\b\(/gi,EXPAND:/\bEXPAND\b\(/gi,CHOOSEROWS:/\bCHOOSEROWS\b\(/gi,CHOOSECOLS:/\bCHOOSECOLS\b\(/gi},e.STEP_RATE={start:0,loadFileData:.1,loadSheetData:.4,loadSheetDataWithCalc:.3,startCalc:.2,loadSheetFormula:.4,loadSheetFormulaWithCalc:.3,parseFile:.1,end:1},M.Ji=function(t){return!t||""===t},M.Xi=function(t){return!t||" "===t},S=M,e.StringEx=S,k.qi=function(t){if(S.Ji(t))return 0;for(var e=0,n=0;n<t.length&&isNaN(parseInt(t[n],10));)n++;return(e=n<t.length?parseInt(t.substring(n),10):e)-1},k.$i=function(t){for(var e,n,i,r,o,a,e=0,n=t.length,i=0;i<n&&!(25<(a=(o=(r=t[i]).charCodeAt())-97))&&!((a=a<0?o-65:a)<0);i++)e=26*e+a+1;return--e},k.nr=function(t){var e,n,i,r,o,a;if(t<0)return"";if(!(e=k.er[t])){for(n=t,r=(i="").length,t+=1;0<t;t=Math.floor((t-1)/26))o=i.substring(0,r),a=i.substring(r),i=o+String.fromCharCode(65+(t-1)%26)+a;e=i.toString(),k.er[n]=e}return e},k.er=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],w=k,e.IndexHelper=w,T.ar=function(t,e){if(!f(t)){var t=parseFloat(t);if(!isNaN(t))return t}return e},T.ur=function(t,e){return"1"===t||"true"===t||"0"!==t&&"false"!==t&&e},T.sr=function(t,e){if(!isNaN(t)){var t=parseInt(t,10);if(!isNaN(t))return t}return e},T.cr=function(t){return t=Array.isArray(t)?t:t?[t]:[]},T.lr=function(t,e){var n,i,r;if(t){for(n=e.split("."),i=t;n.length;){if(r=n.shift(),f(i[r]))return;i=i[r]}return i}},T.dr=function(t,e){return f(t)?e:t?"1":"0"},e.NodeHelper=T,R.vr=function(t){return t.split("/").pop().slice(0,-4)},R.mr=function(t){return P(t,function(t){return 0<=t.toLowerCase().indexOf("_xl")?t.replace(/_xlfn\.|_xlws\.|_xll\./gi,""):t})},R.gr=function(t,e,n){return t.split(e).join(n)},R.pr=function(t,e){var n,i,r,o,a,s;if(f(t)||""===t)return t;for(t.match(c)!==l&&(t=t.replace(n=/(_x00[0-1][0-9A-Fa-f]_)/g,function(t){return"_x005F"+t})),i=["_x0000_","_x0001_","_x0002_","_x0003_","_x0004_","_x0005_","_x0006_","_x0007_","_x0008_","_x0009_","_x000A_","_x000B_","_x000C_","_x000D_","_x000E_","_x000F_","_x0010_","_x0011_","_x0012_","_x0013_","_x0014_","_x0015_","_x0016_","_x0017_","_x0018_","_x0019_","_x001A_","_x001B_","_x001C_","_x001D_","_x001E_","_x001F_"],r=[],o=0;o<t.length;o++)a=t.charCodeAt(o),s=t[o],r.push(31<a||(10===a||13===a)&&e?s:i[a]);return r.join("")},R.addXLFNPrefix=function(t){return P(t,function(t){return t.replace(d,x)})},R.wr=function(t){return t.c_||(t.c_=[]),t.c_.length+1},R.Mr=function(t){return t+"."+g.XFileConstants.Cr},R.Sr=function(t,e){for(var n,i,r,n=0,i=t;n<i.length;n++)if((r=i[n]).Id===e)return r},R.Tr=function(t,e,n){var t,e,t,t=t&&R.Sr(t.c_,e);if(t)return e=R.vr(t.Target),(t=n.drawings)&&t[e]},R.Ir=function(t,e){var n=v.util.xr(t,o);if(n)return R.Tr(t.rels,n[h],e)},R.Nr=function(t){t.rels||(t.rels={n_:g.XFileConstants.Dr,xmlns:g.RelationshipConstants._r,c_:[]})},R.Er=function(t,e){var n,e,n,e,n=v.util.xr(e,o),e=n&&R.Sr(e.rels.c_,n[h]),n=e&&R.vr(e.Target);if(n)return t.drawings||(t.drawings={}),(e=t.drawings)[n]||(e[n]={n_:"wsDr",r_:[5,4],c_:[],rels:{n_:g.XFileConstants.Dr,xmlns:g.RelationshipConstants._r,c_:[]}}),e[n]},R.jr=function(t,e){var n,i,i,e,n=t.rels;v.util.xr(t,o)||(e.drawing++,i=R.wr(n),i=g.XFileConstants.Rr+i,e=g.XFileConstants.Wi+e.drawing,n.c_.push({n_:g.XFileConstants.Lr,Id:i,Type:g.RelationshipConstants.Fr,Target:"../drawings/"+e+"."+g.XFileConstants.Cr}),t.c_||(t.c_=[]),t.c_.push({n_:o,"r:id":i}),v.util.Pr(t,g.WorkSheetNodeOrder))},R.Gr=function(t,e,n){return R.Tr(t,e,n)},R.Ur=function(t,e,n){var n,e,n,e,i,n=v.util.xr(e,n||a),e=n&&R.Sr(e.rels.c_,n[h]),n=e&&R.vr(e.Target);if(n)return t.drawings||(t.drawings={}),(e=t.drawings)[n]||(e[n]={n_:"xml",r_:[10,11,12],c_:[i={n_:"shapelayout","v:ext":"edit",c_:[{n_:"idmap","v:ext":"edit",data:"1"}]}]}),e[n]},R.Hr=function(t,e,n){var i,e,r,r,e,i=t.rels;v.util.xr(t,n=n||a)||(e.vmlDrawing++,e=e.vmlDrawing,r=R.wr(i),r=g.XFileConstants.Rr+r,e=g.XFileConstants.zr+e,i.c_.push({n_:g.XFileConstants.Lr,Id:r,Type:g.RelationshipConstants.Vr,Target:"../drawings/"+e+"."+g.XFileConstants.Yr}),t.c_||(t.c_=[]),t.c_.push({n_:n,"r:id":r}))},R.Zr=function(t,e,n){var e,t,i,e,e,e=R.Sr(e.c_,t),t=e&&e.Target;if(t)return-1!==(e=(t=-1!==(e=t.lastIndexOf("/"))?t.substring(e+1):t).lastIndexOf("."))&&(i=t.substring(e+1)),{blob:e=(e=n.media[t])&&i?R.Wr(e,i):e,type:i}},R.Wr=function(t,e){var e=e;return"data:image/".concat(e="svg"===e?"svg+xml":e,";base64,").concat(t)},R.Qr=function(t){var e,n,i,e=t.indexOf(";base64,");if(-1!==e)return n=t.substring(e+8),{type:i=t.substring(11,e),base64Content:n}},R.Kr=function(t,e,n){var i,t,r,o,a,s,t,i=R.Qr(t);if(i){for(n.media||(n.media={}),"svg+xml"===(t=i.type)?t="svg":"x-icon"===t&&(t="png"),r="",o=Object.keys(n.media),a=0;a<o.length;a++)s=o[a],n.media[s]===i.base64Content&&(r=s);return r||(r=g.XFileConstants.Jr+Object.keys(n.media).length+"."+t,n.media[r]=i.base64Content),f(e)?r:(t=g.XFileConstants.Rr+R.wr(e),e.c_.push({n_:g.XFileConstants.Lr,Id:t,Type:g.RelationshipConstants.Xr,Target:"../media/"+r}),t)}},R.qr=function(t,e){var t=1024*(t+1)+1;return e&&(t+=e.c_.filter(function(t){return t.n_===g.XFileConstants.$r}).length),t},R.StringToByteArray=function(t){var e,n,i,e=[];if(t&&!(t instanceof Array))for(n=t.length,i=0;i<n;i+=2)e[i/2]=parseInt(t.substr(i,2),16);return e},R.no=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n;return("x"===t?e:3&e|8).toString(16)})},R.eo=function(t,e){var n,i,r,n=t.split("/"),i=e.split("/");for(n.pop();0<i.length;)if(".."===(r=i[0]))i.shift(),n.pop();else{if("."!==r)break;i.shift()}return n.concat(i).join("/")},R.io=function(t){var e;return f(t)||t.match(c)===l?t:t.replace(/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,function(t,e,n){var i=0;return n&&(i=parseInt(n,16)),e?"_x00"+n+"_":String.fromCharCode(i)}).replace(/(\r)+\n/g,"\r\n")},R.ro=function(){var t,e,n,i;try{e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},n="object"===("undefined"==typeof global?"undefined":e(global))&&global&&global.Object===Object&&global,i="object"===("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,t=n||i||Function("return this")()}catch(t){}return t},R.oo=function(){var t=R.ro();return t&&t.gcCultureInfo},R.ao=function(){var t=R.ro();return t&&t.gcCultureObj},R.uo=function(t){var e,n,n,e=!0,n=R.ro(),n=n&&n.GC&&n.GC.Spread&&n.GC.Spread.Formatter&&n.GC.Spread.Formatter.GeneralFormatter;if(t&&"="!==t[0]&&!f(n))try{new n(t)}catch(t){e=!1}return e},R.so=function(t,o){var a;return s.GC$.each(t,function(t,e){var n,i,r,n=e.rels&&e.rels.c_;if(n&&n.length)for(i=0;i<n.length;i++)if((r=R.vr(n[i].Target))===o)return a=t,!1}),a},R.co=function(t,e){var n,i,r,o,a,s,u,c;if(e&&e.rels&&e.c_&&e.c_.length){for(n=e.rels.c_,i={},r=0;r<n.length;r++)(o=n[r]).Type===g.RelationshipConstants.fo&&(i[o.Id]=R.vr(o.Target));for(r=0;r<e.c_.length;r++)if("sheets"===(a=e.c_[r]).n_)for(s=a.c_,u=0;u<s.length;u++)if(i[(c=s[u])[g.XFileConstants.Ki]]===t)return c.name}},R.ho=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d;for(e=v.util.vo(e),i=t.workbook,o=-1,s=0,u=r=v.util.xr(i,g.XFileConstants.mo).c_;s<u.length;s++)if(e===(c=u[s]).name){o=c[g.XFileConstants.Ki];break}if(-1!==o){for(l=0,h=f=v.util.go(i.rels,g.XFileConstants.Lr);l<h.length;l++)if(o===(d=h[l]).Id){a=R.vr(d.Target);break}a&&(n=t.sheets[a])}return n},R.po=function(t,e){var t=R.ho(t,e);return t&&v.util.xr(t,g.XFileConstants.bo)},R.yo=function(t,e,n,i,r){var o,a;f(i)||t&&((a=(a=(o=(o=t[e])||(t[e]={}))[n])||(o[n]={})).v=r.getTextIndex(i))},R.wo=function(t,e){return t&&t.openMode&r.OpenMode.lazy&&!f(e)},R.Mo=function(t){return t&&t.openMode&r.OpenMode.incremental},R.Co=function(t){return t&&t.fileType===r.OpenSaveFileType.excel},R.So=function(t,e,n,i){var r,o,a,s,r=t.getRowCount(),o=t.getColumnCount(),s=i&&i.dataEffectByInflate&&i.dataEffectByInflate[t.name()];r<e&&(a=new v.Range(r,-1,e-r,-1),t.setRowCount(e),s)&&Object.keys(s).forEach(function(t){s[t](a)}),o<n&&(a=new v.Range(-1,o,-1,n-o),t.setColumnCount(n),s)&&Object.keys(s).forEach(function(t){s[t](a)})},R.cme=function(t,e,n,i,r,o){i!==l&&e.setSize(n,i),r&&t.setColumnVisible(n,!1),o!==l&&t.setStyle(-1,n,o)},R.To=function(t,e,n,i){var r,o,a,s,e,a,o,s,e;void 0===n&&(n=2),o=e.from,a=e.to,s=e.pos,e=e.ext,a?R.Ege(t,a,n,i):e&&(o||s)&&(a={x:0,y:0},o?(R.Ege(t,o,n,i),a=R.Gce(t,o)):(a.x=u.ExcelHelper.emuToPixles(parseInt(s.x,10)),a.y=u.ExcelHelper.emuToPixles(parseInt(s.y,10))),a.x+=u.ExcelHelper.emuToPixles(parseInt(e.cx,10)),a.y+=u.ExcelHelper.emuToPixles(parseInt(e.cy,10)),s=(o=G(t,a.x,a.y)).rowIndex,e=o.colIndex,R.So(t,s+n,e+n,i))},R.Ege=function(t,e,n,i){var e=R.Uce(e),r=e.row,e=e.col;R.So(t,r+n,e+n,i)},R.Ao=function(n,t,i,r){t&&t.forEach(function(t){var e,t,e=t.row+(0<t.rowCount?t.rowCount:1),t=t.col+(0<t.colCount?t.colCount:1);i&&(e>=g.XmlConstants.Io||t>=g.XmlConstants.xo)||R.So(n,e,t,r)})},R.Uce=function(t){var e,n,i,r;function o(t,e){var t=parseInt(t.v_||0,10);return e?u.ExcelHelper.emuToPixles(t):t}return{row:e=o(t.row),col:n=o(t.col),rowOff:i=o(t.rowOff,!0),colOff:r=o(t.colOff,!0)}},R.Gce=function(t,e){var e,n,i,e=R.Uce(e),n,i;return{x:v.util.w0(t,0,e.col,!1)+e.colOff,y:v.util.w0(t,0,e.row,!0)+e.rowOff}},R.No=function(t){return t=Math.min(t,g.XmlConstants.xo-1),w.nr(t)},R.ko=function(t){return!t||f(t.fileType)||t.fileType===r.OpenSaveFileType.sjs},R.encodeNameFormula=function(t){if(t)return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},R.Oge=function(t,e){var e,n,i,r,o,a,t,e={n_:"definedName",c_:[R.addXLFNPrefix(R.encodeNameFormula(e))]},n=t.name,i=t.localSheetId,r=t.e,o=t.comment,a=t.isReadOnly,t=t.hidden;return f(n)||(e.name=v.util.vo(n)),f(i)||(e.localSheetId=i),f(r)||(e.e=r),f(o)||(e.comment=v.util.vo(o)),f(a)||(e.isReadOnly=a),f(t)||(e.hidden=t),e},C=R,e.Util=C,e.SJSStylePropsToStyleProps={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow",wholeTableStyle:"wholeTable",headerRowStyle:"headerRow",footerRowStyle:"totalRow",highlightFirstColumnStyle:"firstColumn",highlightLastColumnStyle:"lastColumn",firstRowStripStyle:"firstRowStripe",secondRowStripStyle:"secondRowStripe",firstColumnStripStyle:"firstColumnStripe",secondColumnStripStyle:"secondColumnStripe",firstHeaderCellStyle:"firstHeaderCell",lastHeaderCellStyle:"lastHeaderCell",firstFooterCellStyle:"firstTotalCell",lastFooterCellStyle:"lastTotalCell",reportFilterLabelsStyle:"pageFieldLabels",reportFilterValuesStyle:"pageFieldValues",firstRowStripeStyle:"firstRowStripe",secondRowStripeStyle:"secondRowStripe",firstColumnStripeStyle:"firstColumnStripe",secondColumnStripeStyle:"secondColumnStripe",subtotalColumn1Style:"firstSubtotalColumn",subtotalColumn2Style:"secondSubtotalColumn",subtotalColumn3Style:"thirdSubtotalColumn",subtotalRow1Style:"firstSubtotalRow",subtotalRow2Style:"secondSubtotalRow",subtotalRow3Style:"thirdSubtotalRow",columnSubheading1Style:"firstColumnSubheading",columnSubheading2Style:"secondColumnSubheading",columnSubheading3Style:"thirdColumnSubheading",rowSubheading1Style:"firstRowSubheading",rowSubheading2Style:"secondRowSubheading",rowSubheading3Style:"thirdRowSubheading",blankRowStyle:"blankRow",grandTotalColumnStyle:"lastColumn",grandTotalRowStyle:"totalRow",firstHeaderCellStyleL:"firstHeaderCell",firstColumnStyle:"firstColumn"},e.protectionOptionsMap={allowSelectLockedCells:"selectLockedCells",allowSelectUnlockedCells:"selectUnlockedCells",allowFilter:"autoFilter",allowSort:"sort",allowInsertColumns:"insertColumns",allowInsertRows:"insertRows",allowDeleteColumns:"deleteColumns",allowDeleteRows:"deleteRows",allowEditObjects:"objects"},e.excelSupportProtectionOptions={objects:!0,formatCells:!0,formatColumns:!0,formatRows:!0,insertColumns:!0,insertRows:!0,insertHyperlinks:!0,deleteColumns:!0,deleteRows:!0,selectLockedCells:!0,selectUnlockedCells:!0,sort:!0,autoFilter:!0,pivotTables:!0},N.builtInNumberFormat=function(){return 0===(N.Md=N.Md?N.Md:{count:0}).count&&N.initBuiltNumberFormat(),N.Md},N.languageIndepedentNumberFormat=function(){return 0===(N.Ch=N.Ch?N.Ch:{count:0}).count&&N.initLanguageIndepedentNumberFormat(),N.Ch},N.formatCodeTable=function(){return N.Sh=N.Sh?N.Sh:[]},N.customNumberFormat=function(){return N.Th=N.Th?N.Th:{count:0}},N.getCultureInfo=function(){var t,e,t=C.ro(),e;return t&&t.GC&&t.GC.Spread&&t.GC.Spread.Common&&C.ro().GC.Spread.Common.CultureManager.getCultureInfo()||C.ao()},N.initBuiltNumberFormat=function(){var t,e,e,n,i,r,o,a,t=N.Md;if(t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yyyy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yyyy h:mm",t[37]="#,##0_);(#,##0)",t[38]="#,##0_);[Red](#,##0)",t[39]="#,##0.00_);(#,##0.00)",t[40]="#,##0.00_);[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mm:ss.0",t[48]="##0.0E+0",t[49]="@",t.count=49,C.oo())if("zh-cn"===(e=C.oo()))t[14]="yyyy/m/d",t[17]="mmm-yy",t[22]="yyyy/m/d h:mm",t[27]='yyyy"\u5e74"m"\u6708"',t[28]='m"\u6708"d"\u65e5"',t[29]='m"\u6708"d"\u65e5"',t[30]="m-d-yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u65f6"mm"\u5206"',t[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',t[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[36]='yyyy"\u5e74"m"\u6708"',t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]='yyyy"\u5e74"m"\u6708"',t[51]='m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='m"\u6708"d"\u65e5"',t[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',t[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',t[57]='yyyy"\u5e74"m"\u6708"',t[58]='m"\u6708"d"\u65e5"',t.count=58;else if("ja-jp"===e)t[14]="yyyy/m/d",t[15]="dd-mmm-yy",t[16]="dd-mmm",t[17]="mmm-yy",t[22]="yyyy/mm/dd h:mm",t[27]="[$-411]ge.m.d",t[28]='[$-411]ggge"\u5e74"m"\u6708"d"',t[29]='[$-411]ggge"\u5e74"m"\u6708"d"',t[30]="m/d/yy",t[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',t[32]='h"\u6642"mm"\u5206"',t[33]='h"\u6642"mm"\u5206"ss"\u79d2"',t[34]='yyyy"\u5e74"m"\u6708"',t[35]='m"\u6708"d"\u65e5"',t[36]="[$-411]ge.m.d",t[38]="#,##0;[Red]-#,##0",t[39]="#,##0.00;-#,##0.00",t[40]="#,##0.00;[Red]-#,##0.00",t[50]="[$-411]ge.m.d",t[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[52]='yyyy"\u5e74"m"\u6708"',t[53]='m"\u6708"d"\u65e5"',t[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t[55]='yyyy"\u5e74"m"\u6708"',t[56]='m"\u6708"d"\u65e5"',t[57]="[$-411]ge.m.d",t[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',t.count=58;else if(n=(e=N.getCultureInfo())&&e.LocalNumberFormat,!f(n)&&!Array.isArray(n)&&"object"==typeof n){for(i in n)isNaN(Number(i))||(r=n[i],C.uo(r)&&(t[i]=n[i]));for(i in o=0,t)isNaN(Number(i))||o<(a=Number(i))&&(o=a);t.count=o}},N.initLanguageIndepedentNumberFormat=function(){var t=N.Ch;t[27]="m/d/yyyy",t[28]="m/d/yyyy",t[29]="m/d/yyyy",t[30]="m/d/yyyy",t[31]="m/d/yyyy",t[32]="h:mm:ss",t[33]="h:mm:ss",t[34]="m/d/yyyy",t[35]="m/d/yyyy",t[36]="m/d/yyyy",t[50]="m/d/yyyy",t[51]="m/d/yyyy",t[52]="m/d/yyyy",t[53]="m/d/yyyy",t[54]="m/d/yyyy",t[55]="m/d/yyyy",t[56]="m/d/yyyy",t[57]="m/d/yyyy",t[58]="m/d/yyyy"},N.getFormatCode=function(t){var e,n,i,r,t,o,t,e=N.builtInNumberFormat(),n=N.customNumberFormat(),i=N.languageIndepedentNumberFormat(),r=t.numberFormatIndex;return t.numberFormat?(o=(t=t.numberFormat).numberFormatId,t=t.numberFormatCode,e[o]&&e[o]!==t?e[o]=t:(n[t]||(n[t]=o,n.count++),t)):e[r]||i[r]||"General"},N.getFormatId=function(t){var e,n,i,r,o,a,s,u,e=N.Ah();if(e[t])return e[t];if(i=N.builtInNumberFormat())for(r in i)if(i[r]===t)return n={isBuiltIn:!0,id:parseInt(r,10)},e[t]=n;if((o=N.customNumberFormat())&&o[t])return n={isBuiltIn:!1,id:o[t]},e[t]=n;if((a=0)<o.count){for(u in s=0,o)o[u]>s&&(s=o[u]);a=s}return N.Ih++,a=Math.max(N.Ih,a)+1,n={isBuiltIn:!1,id:o[t]=a}},N.Ah=function(){return N.xh=N.xh?N.xh:{}},N.resetBuiltInNumberFormat=function(){N.Md={count:0},N.Ch={count:0}},N.Sh=null,N.xh=null,N.Md={count:0},N.Ch={count:0},N.Th={count:0},N.Ih=170,e.ExtendedNumberFormatHelper=N},"./dist/core/excel-io-util/excel-helper.js":function(t,e){"use strict";function n(t,e){var e=Math.pow(10,e);return Math.round(t*e)/e}var i;function r(){}Object.defineProperty(e,"__esModule",{value:!0}),e.ExcelHelper=void 0,r.pointToPixel=function(t){return n(96*t/72,2)},r.pixelToPoint=function(t){return 72*t/96},r.emuToPixles=function(t,e){return n(96*t/914400,e||2)},r.pixelToEMU=function(t){return Math.round(914400*t/96)},r.getActualColumnWidth=function(t,e,n){for(var i,r,i=0,r=e;r<n;r++)t.getColumnVisible(r)&&(i+=t.Do(r,3));return i},r.getActualRowHeight=function(t,e,n){for(var i,r,i=0,r=e;r<n;r++)t.getRowVisible(r)&&(i+=t._o(r,3));return i},r.getImageContent=function(t,e){var n,i,i,n="png",i=t.lastIndexOf(".");return"svg"===(n=-1!==i?t.substr(i+1):n)&&(n="svg+xml"),(i=e(t,!0))?"data:image/"+n+";base64,"+i:null},e.ExcelHelper=r},"./dist/core/excel-io-util/excel-style.js":function(t,e){"use strict";var n,e;Object.defineProperty(e,"__esModule",{value:!0}),e.ExcelBorderStyle=void 0,(e=n=e.ExcelBorderStyle||(e.ExcelBorderStyle={}))[e.none=0]="none",e[e.thin=1]="thin",e[e.medium=2]="medium",e[e.dashed=3]="dashed",e[e.dotted=4]="dotted",e[e.thick=5]="thick",e[e.double=6]="double",e[e.hair=7]="hair",e[e.mediumDashed=8]="mediumDashed",e[e.dashDot=9]="dashDot",e[e.mediumDashDot=10]="mediumDashDot",e[e.dashDotDot=11]="dashDotDot",e[e.mediumDashDotDot=12]="mediumDashDotDot",e[e.slantDashDot=13]="slantDashDot"},"./dist/core/excel-io-util/excel-types.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorkSheetNodeOrder=e.WorkbookNodeOrder=e.RelationshipConstants=e.XFileConstants=e.XmlConstants=void 0,e.XmlConstants={xo:16384,Io:1048576},e.XFileConstants={Eo:"_rels",jo:"/xl",Oo:"[Content_Types].xml",Rr:"rId",Ki:"r:id",Dr:"Relationships",Lr:"Relationship",Qi:"legacyDrawing",Ro:"legacyDrawingHF",Bo:"AlternateContent",Lo:"Choice",Fo:"controls",Po:"control",$r:"shape",Go:"bin",Uo:"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings",Ho:"rels",zo:"application/vnd.openxmlformats-package.relationships+xml",Vo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",Yo:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",Zo:"application/vnd.openxmlformats-officedocument.theme+xml",Wo:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",Qo:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",Ko:"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml",Jo:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",Xo:"application/vnd.openxmlformats-officedocument.drawing+xml",qo:"application/vnd.openxmlformats-officedocument.drawingml.chart+xml",$o:"application/vnd.ms-office.chartex+xml",ta:"application/vnd.ms-office.chartstyle+xml",na:"application/vnd.ms-office.chartcolorstyle+xml",ia:"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml",ra:"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml",oa:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",aa:"application/vnd.ms-office.drawingml.diagramDrawing+xml",ua:"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml",sa:"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml",ca:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",fa:"application/vnd.ms-excel.threadedcomments+xml",la:"application/vnd.ms-excel.person+xml",ha:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml",da:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml",va:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml",ma:"application/vnd.ms-excel.slicer+xml",ga:"application/vnd.ms-excel.slicerCache+xml",pa:"application/vnd.ms-excel.timeline+xml",ba:"application/vnd.ms-excel.timelineCache+xml",ya:"application/vnd.ms-office.vbaProject",wa:"application/vnd.openxmlformats-officedocument.vmlDrawing",Ma:"application/vnd.ms-excel.controlproperties+xml",SrV:"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml",zge:"application/vnd.ms-excel.rdrichvaluetypes+xml",Yge:"application/vnd.ms-excel.rdrichvaluestructure+xml",Zge:"application/vnd.ms-excel.rdrichvalue+xml",Wge:"application/vnd.ms-excel.rdrichvaluewebimage+xml",gee:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Cr:"xml",Yr:"vml",Ca:"application/xml",Sa:"jpg",Ta:"image/jpg",Aa:"tiff",Ia:"image/tiff",xa:"jpeg",Na:"image/jpeg",ka:"svg",Da:"image/svg+xml",_a:"png",Ea:"image/png",ja:"bmp",Oa:"image/bmp",Ra:"gif",Ba:"image/gif",La:"emf",Fa:"image/x-emf",Pa:"wmf",Ga:"image/x-wmf",Ua:"drawings",zr:"vmlDrawing",Ha:"/xl/charts",za:"/xl/drawings",Va:"/xl/persons",Ya:"/xl/media",Za:"/xl/threadedComments",Wa:"/xl/worksheets",Qa:"/xl/tables",Ka:"/xl/slicers",Ja:"/xl/slicerCaches",Xa:"/xl/timelines",qa:"/xl/timelineCaches",$a:"/xl/ctrlProps",tu:"externalLink",nu:"/xl/externalLinks",eu:"/xl/pivotCache",iu:"/xl/pivotTables",Qge:"/xl/richData",Kge:"rdRichValueTypes.xml",Jge:"rdRichValueWebImage.xml",Xge:"rdrichvalue.xml",qge:"rdrichvaluestructure.xml",mo:"sheets",ru:"sheet",ou:"comments",au:"chart",uu:"chartEx",su:"style",cu:"person",fu:"colors",Wi:"drawing",lu:"ctrlProp",hu:"threadedComment",Jr:"image",du:"table",vu:"slicer",mu:"slicerCache",gu:"timeline",pu:"timelineCache",bu:"pivotCacheDefinition",yu:"pivotCache",wu:"pivotCacheRecords",Mu:"pivotTable",Cu:"External",Su:"sheetPr",Tu:"dimension",Au:"extLst",Iu:"mergeCells",xu:"mergeCell",Nu:"hyperlinks",ku:"hyperlink",Du:"sheetViews",_u:"sheetFormatPr",Eu:"cols",bo:"sheetData",fQt:"sortState",ju:"conditionalFormatting",Ou:"dataValidations",Ru:"dataValidation",Bu:"tableParts",Lu:"/xl/sharedStrings.xml",Fu:"/xl/theme/theme1.xml",Pu:"/xl/worksheets",Gu:"/xl/workbook.xml",Uu:"/docProps/core.xml",Hu:"/docProps/app.xml",zu:"/docProps/custom.xml",Vu:"/xl/styles.xml",Yu:"/xl/theme/theme1.xml",Zu:"metadata.xml",$ge:"calcChain.xml",Wu:"/xl/_rels/workbook.xml.rels",Qu:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",Ju:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",Xu:"http://schemas.openxmlformats.org/drawingml/2006/main",_ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",$u:"x14ac",ts:"x14ac xr xr2 xr3",ns:"xr",_xr:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",as:"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2",us:"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",fs:"http://schemas.openxmlformats.org/package/2006/content-types",_r:"http://schemas.openxmlformats.org/package/2006/relationships",ls:"http://schemas.openxmlformats.org/drawingml/2006/main",hs:"http://schemas.microsoft.com/office/drawing/2010/main",vs:"http://schemas.microsoft.com/office/drawing/2016/SVG/main",ms:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ps:"http://schemas.microsoft.com/office/excel/2006/main",bs:"http://schemas.openxmlformats.org/markup-compatibility/2006",ys:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",ws:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",Ms:"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",Cs:"http://schemas.microsoft.com/office/spreadsheetml/2018/calcfeatures",Ss:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",Ts:"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray",As:"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata",Is:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",xs:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",ks:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ds:"http://purl.org/dc/elements/1.1/",_s:"http://purl.org/dc/terms/",Es:"http://purl.org/dc/dcmitype/",js:"http://www.w3.org/2001/XMLSchema-instance",Os:"application/vnd.openxmlformats-package.core-properties+xml",Ls:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Fs:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Ps:"application/vnd.openxmlformats-officedocument.extended-properties+xml",Gs:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Us:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Hs:"application/vnd.openxmlformats-officedocument.custom-properties+xml"},e.RelationshipConstants={zs:"rId",_r:"http://schemas.openxmlformats.org/package/2006/relationships",Vs:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Ys:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Zs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",Ws:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",Ks:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Js:"http://purl.oclc.org/ooxml/officeDocument/relationships/styles",fo:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Xs:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",qs:"http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings",$s:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",tc:"http://purl.oclc.org/ooxml/officeDocument/relationships/theme",ec:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition",ic:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords",oc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable",uc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",fc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",lc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",hc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",Vr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",dc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ctrlProp",vc:"http://purl.oclc.org/ooxml/officeDocument/relationships/extendedProperties",Fr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",gc:"http://purl.oclc.org/ooxml/officeDocument/relationships/drawing",pc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Xr:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",bc:"http://purl.oclc.org/ooxml/officeDocument/relationships/image",yc:"http://schemas.microsoft.com/office/2007/relationships/slicer",wc:"http://schemas.microsoft.com/office/2007/relationships/slicerCache",Mc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",Cc:"http://schemas.microsoft.com/office/2014/relationships/chartEx",Sc:"http://purl.oclc.org/ooxml/officeDocument/relationships/chart",Tc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes",Ac:"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",Ic:"http://schemas.microsoft.com/office/2011/relationships/chartStyle",xc:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",zge:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValueTypes",Yge:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValueStructure",n2e:"http://schemas.microsoft.com/office/2017/06/relationships/rdRichValue",Wge:"http://schemas.microsoft.com/office/2020/07/relationships/rdRichValueWebImage",SrV:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",Nc:"http://schemas.microsoft.com/office/2011/relationships/timeline",kc:"http://schemas.microsoft.com/office/2011/relationships/timelineCache"},e.WorkbookNodeOrder=["bookViews",e.XFileConstants.mo,"externalReferences","definedNames","calcPr","pivotCaches","extLst"],e.WorkSheetNodeOrder=[e.XFileConstants.Su,e.XFileConstants.Tu,e.XFileConstants.Du,e.XFileConstants._u,e.XFileConstants.Eu,e.XFileConstants.bo,"sheetProtection","autoFilter",e.XFileConstants.fQt,e.XFileConstants.Iu,e.XFileConstants.ju,e.XFileConstants.Ou,e.XFileConstants.Nu,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing",e.XFileConstants.Qi,e.XFileConstants.Ro,e.XFileConstants.Po,e.XFileConstants.Bo,e.XFileConstants.Bu,e.XFileConstants.Au]},"./dist/core/excel-io-util/range-parser.js":function(t,e,n){"use strict";var i,r,c,s,f,l,o,a;function h(t){return-1===t.col||-1===t.colCount}function d(t){return-1===t.row||-1===t.rowCount}function u(){}Object.defineProperty(e,"__esModule",{value:!0}),e.range_parser=void 0,i=n("Common"),r=n("./dist/core/excel-io-util/excel-types.js"),c=n("./dist/core/excel-io-util/common.js"),s=n("./dist/core/util/common.js"),f=r.XmlConstants.Io,l=r.XmlConstants.xo,o=i.Common.lt.ht,u.Dc=function(t,e){var n,i,n=[];return o(t)||(i=t.replace(/('.+')/g,"").split(" ")).forEach(function(t){var t=u._c(t,e);!t||t.row>f||t.col>l||t.rowCount>f||t.col>l||n.push(t)}),n},u._c=function(t,e){var n,i,i,r,o,i,a,a,t,n=(0,s.Ec)(0,0,0,0),i=t.indexOf("!");if(1===(i=(i=(t=-1<i?t.substr(i+1):t).split("$").join("")).split(":")).length){if(a=i[0],r=c.IndexHelper.qi(a),o=c.IndexHelper.$i(a),-1===r&&-1===o)return null;n.row=r,n.col=o,n.rowCount=1,n.colCount=1}else 2===i.length&&(a=i[0],t=i[1],r=c.IndexHelper.qi(a),o=c.IndexHelper.$i(a),i=c.IndexHelper.qi(t),a=c.IndexHelper.$i(t),n.row=r,n.col=o,n.rowCount=i-r+1,n.colCount=a-o+1,e||0!==r||n.rowCount!==f||(n.row=-1,n.rowCount=-1),e||0!==o||n.colCount!==l||(n.col=-1,n.colCount=-1));return n},u.jc=function(t,e){var e,n,i,r,t,o;if(t)return e=e?"$":"",n=t.row,i=t.col,r=t.rowCount,t=t.colCount,o=c.IndexHelper.nr(i),1===r&&1===t?e+o+e+(n+1):-1===n||-1===r?e+o+e+"1:"+e+c.IndexHelper.nr(i+t-1)+e+f:-1===i||-1===t?e+"A"+e+(n+1)+":"+e+c.IndexHelper.nr(l)+e+(n+r):0===r&&0===t?e+o+e+(n+1):e+o+e+(n+1)+":"+e+c.IndexHelper.nr(i+t-1)+e+(n+r)},u.Oc=function(t,e){var n,i,r,o;if(t){for(n=[],i=0,r=t;i<r.length;i++)o=r[i],n.push(u.jc(o,e));return n.join(" ")}},u.getRangeString=function(t){for(var e,n,i,r,o,a,s,u,s,e=[],n=0,i=t;n<i.length;n++)h(r=i[n])&&(r.col=0,r.colCount=l),d(r)&&(r.row=0,r.rowCount=f),o=r.row,a=r.row+r.rowCount-1,s=r.col,u=r.col+r.colCount-1,s=c.IndexHelper.nr(s)+(o+1),(1<r.rowCount||1<r.colCount)&&(s+=":"+c.IndexHelper.nr(u)+(1+a)),e.push(s);return e.join(" ")},e.range_parser=u},"./dist/core/lc/debugLc.js":function(t,e,n){"use strict";var n,i;function r(){}function o(t,e){return t}Object.defineProperty(e,"__esModule",{value:!0}),e._pt=e._Ae=e.Rc=void 0,i=(n=n("./dist/core/util/domUtil.js")).GC$.sd,n.GC$[i]=function(t){},e.Rc=r,e._Ae=o,e._pt=0},"./dist/core/lc/lr.en.js":function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ls11=e.ls10=e.ls9=e.ls8=e.ls7=e.ls6=e.ls5=e.ls4=e.ls3=e.ls2=e.ls1=e.lsde=e.lsru=void 0,e.lsru=["","6465706c6f796d656e74"],e.lsde=["","64657369676e6572"],e.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],e.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],e.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],e.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],e.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],e.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls9=["","4164642d6f6e7320456e61626c65643a207b307d"],e.ls10=["","4164642d6f6e73204e6f7420456e61626c65643a207b307d"],e.ls11=["","2c20"]},"./dist/core/util/basedialog.js":function(t,e,n){"use strict";var i,r,n,l,a,s,u,h,c,o,f,d,v,g,r,m,p,n,S;function w(t,e,n,i){this.Bc="gc-popup",this.Lc="gc-overlay",this.Fc=null;var r=this;r.Ti=t,r.Pc=n,r.os=i,r.Gc={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:e=e||0,backgroundColor:"rgba(0,0,0,0)"},r.Uc={position:"absolute",padding:0,margin:0,height:"auto",zIndex:e+1,outline:"none"},r.Hc()}function b(t,e,n){var o=S.call(this,t,e,n)||this;return o.Mse=!1,o.Cse={mouseOriginalX:0,mouseOriginalY:0,domOriginalX:0,domOriginalY:0,domWidth:0,domHeight:0,parentRect:null,screenWidth:0,screenHeight:0},o.Sse=function(t){var e,n,t,n,i,t,r,i,t,e=o;e.Mse&&e.mouseInScreen(t.pageX-window.scrollX,t.pageY-window.scrollY)&&(n=t.pageX,t=t.pageY,i=n-(n=e.Cse).mouseOriginalX,t=t-n.mouseOriginalY,n.parentRect)&&(r=e.Wc[0],i=Math.max(0,n.domOriginalX+Math.min(i,n.screenWidth-n.domOriginalX-n.domWidth+(e.Pc?0:window.scrollX))),t=Math.max(0,n.domOriginalY+Math.min(t,n.screenHeight-n.domOriginalY-n.domHeight+(e.Pc?0:window.scrollY))),r.style.left="".concat(i,"px"),r.style.top="".concat(t,"px"))},o.Ise=function(){window.removeEventListener("mousemove",o.Sse),o.Mse=!1},o}i=this&&this.__extends||(p=function(t,e){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Object.defineProperty(e,"__esModule",{value:!0}),e.Ase=e.zc=e.DialogFeatureType=void 0,r=n("./dist/core/util/common.js"),n=n("./dist/core/util/domUtil.js"),l=n.GC$,a=r.util.En,s=r.util.Tt,u=r.util.vi,h=document,c=window,o=c.gcGlobal,f="touchstart",d="MSPointerDown",v="pointerdown",(n=g=e.DialogFeatureType||(e.DialogFeatureType={})).contextMenu="context-menu",n.filter="filter",n.touch="touch",n.fill="fill",n.sheetList="sheet-list",w.prototype.Hc=function(){var t=this;t.Yc(t.Zc)?t.Wc=l("#"+t.Zc):(t.Zc=t.Qc(),t.Kc=t.Lc+"-"+t.Zc,t.Jc=t.Bc+"-"+t.Zc,t.Wc=l(a("div")).addClass(t.Jc+" ui-widget").attr({id:t.Zc,tabIndex:-1}).css(t.Uc))},w.prototype.Qc=function(){for(var t,e,t=0,e="gc-dialog";this.Yc(e+t.toString());)t++;return e+t.toString()},w.prototype.Xc=function(){if(this.Wc)return this.Wc},w.prototype.qc=function(){return this.Ti||h.body},w.prototype.$c=function(t){var e=this,n=e.Wc;e.os||e.tf()||e.nf(),e.os||o.ef(),e.Yc(e.Zc)||(l(e.qc()).append(n),e.if(),n.css("display","none")),e.jTe&&e.Wc.attr("sjs-dialog",e.jTe),n.show(t)},w.prototype.rf=function(){return"block"===this.Wc.css("display")},w.prototype.close=function(){var t=this;t.af(),t.Yc(t.Zc)&&t.Wc.remove(),l("."+t.Jc).isVisible()||t.uf(),t.os||o.cf()},w.prototype.uf=function(){l("."+this.Kc).remove(),this.Fc=null},w.prototype.af=function(){var e=this.Zc;[f,d,v].forEach(function(t){l(h).unbind(t+"."+e)})},w.prototype.if=function(){var t,e,e,n,i,r,o,a,s,u,c,u,f,t=this.Wc,e=this.qc();0===t.length||(e=l(e).offset(),n=parseInt(t.css("left"),10)+e.left,i=parseInt(t.css("top"),10)+e.top,r=t.width(),o=t.height(),isNaN(n))||isNaN(i)||isNaN(r)||isNaN(o)||(c=(u=h.documentElement).clientWidth,u=u.clientHeight,(f=t[s=a=0].getBoundingClientRect()).left+r>c&&(s=f.left+r-c),f.top+o>u&&(a=f.top+o-u),(n<0||i<0||0<a||0<s)&&t.css({left:(n=(n-=s)<0?0:n)-e.left+"px",top:(i=(i-=a)<0?0:i)-e.top+"px"}))},w.prototype.Yc=function(t){return 0<l("#"+t).length},w.prototype.nf=function(){var n,e,t,i,r,o,n=this,e=n.Zc,t=l(a("div")).addClass(n.Kc),i=n.Wc;(n.Fc=t).css(n.Gc),l(n.qc()).append(t),(r=s&&s.mozilla)&&(o=(new Date).valueOf()),t.bind("mousedown",function(t){if(!n.Pc){var e;if(r)if((new Date).valueOf()-o<100)return;n.close(),r&&n.ff&&clearTimeout(n.ff)}u(t)}),t.bind("contextmenu",function(t){n.Pc&&u(t)}),i.bind("contextmenu",function(t){u(t)}),[f,d,v].forEach(function(t){l(h).bind(t+"."+e,function(t){var e=t.target;n.Fc&&!n.lf(e)&&(n.Pc||(r?n.ff=c.setTimeout(function(){n.close()},100):n.close()),u(t))})})},w.prototype.hf=function(t,e){for(var n=t;e&&e!==document.body;){if(e===n)return!0;e=e.parentNode}return!1},w.prototype.lf=function(t){return!!this.Wc&&this.hf(this.Wc.get(0),t)},w.prototype.tf=function(){return 0<l("."+this.Kc).length},e.zc=r=w,i(b,S=r),b.prototype.bindMoveEvent=function(t){var i,e,i=this,e=function(t){var e,n,t,t,e=i.Wc[0],n=i.Cse;n.mouseOriginalX=t.pageX,n.mouseOriginalY=t.pageY,t=e.getBoundingClientRect(),n.domOriginalX=t.left+(i.Pc?0:window.scrollX),n.domOriginalY=t.top+(i.Pc?0:window.scrollY),n.domWidth=t.width,n.domHeight=t.height,(t=e.offsetParent)?n.parentRect=t.getBoundingClientRect():"fixed"===e.style.position&&(n.parentRect=e.getBoundingClientRect()),n.screenWidth=window.innerWidth,n.screenHeight=window.innerHeight,i.Mse=!0,window.addEventListener("mousemove",i.Sse)};return t.addEventListener("mousedown",e),document.addEventListener("mouseup",i.Ise),function(){t.removeEventListener("mousedown",e),document.removeEventListener("mouseup",i.Ise)}},b.prototype.mouseInScreen=function(t,e){return 0<=t&&t<=this.Cse.screenWidth&&0<=e&&e<=this.Cse.screenHeight},e.Ase=b},"./dist/core/util/common.js":function(F,f,s){"use strict";var _,h,t,A,w,e,L,D,j,y,O,V,Y,K,d,z,S,W,J,Z,t,Q,X,l,v,q,$,tt,b,m,et,C,p,g,M,k,nt,it,rt,ot,at,st,ut,ct,ft,lt,T,ht,x,dt,vt,gt,mt,pt,St,wt,bt,Ct,yt,Mt,kt,Tt,G,B,xt,Gt,u,Bt,It,Pt,Rt,Nt,Et,Ht,Ut,A,Ft,_t,At,Lt,Dt,jt,Ot,Vt,Yt,Kt,zt,Wt,Jt,Zt,A,t,e,Qt,Xt;function qt(t){return t!==b}function $t(t){return v.createElement(t)}function te(t){var t=(t||v).activeElement;return t&&t.shadowRoot?te(t.shadowRoot):t}function ee(t){v.body&&v.body.insertBefore(t,m)}function ne(t,n,i){Object.defineProperty(t,n,{get:function(){return this._ps[n]},set:function(t){var e=this._ps[n];e!==t&&(this._ps[n]=t,i)&&i(n,t,e)},enumerable:!0})}function ie(t,e){var t;return t.style&&t.style.vertAlign?(t=j.W.V(e,1)).fontSize*ft+"px "+t.fontFamily:e}function re(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function oe(t){var e,n,i,e=!1;if(t)for(n=0;n<t.length;n++)if(11904<=(i=t.charCodeAt(n))&&i<12032||12288<=i&&i<40960||43360<=i&&i<43392||63744<=i&&i<64256){e=!0;break}return e}function ae(t){return Math.random().toString(16).slice(-t)}function se(n){return function(t,e){return String.fromCharCode(parseInt(e,n))}}function ue(t,e,n){var i,r,o,a,i=0,o=t.split(" ");if(3<=o.length&&(i=parseFloat(o[2]),isNaN(i)||(i/=100)),"Background 1"===t.substring(0,12)&&(r=e?243:0),"Text 1"===t.substring(0,6)&&(r=e?241:1),"Background 2"===t.substring(0,12)&&(r=e?244:2),"Text 2"===t.substring(0,6)&&(r=e?242:3),"Accent 1"===t.substring(0,8)&&(r=4),"Accent 2"===t.substring(0,8)&&(r=5),"Accent 3"===t.substring(0,8)&&(r=6),"Accent 4"===t.substring(0,8)&&(r=7),"Accent 5"===t.substring(0,8)&&(r=8),"Accent 6"===t.substring(0,8)&&(r=9),"hyperlink"===t.substring(0,8)&&(r=10),(r="followedHyperlink"===t.substring(0,8)?11:r)!==b)return{n_:a=n||"color",theme:r,tint:i}}function ce(t,e){var n=t.tint?M(100*t.tint):0,t=+t.theme;return 0==t||243==t?"Background 1 "+n:1==t||241==t?"Text 1 "+n:2==t||244==t?"Background 2 "+n:3==t||242==t?"Text 2 "+n:4==t?"Accent 1 "+n:5==t?"Accent 2 "+n:6==t?"Accent 3 "+n:7==t?"Accent 4 "+n:8==t?"Accent 5 "+n:9==t?"Accent 6 "+n:10==t?"hyperlink":11==t?"followedHyperlink":void 0}function c(){}function fe(t){return Mt.getIndexedColor(+t.indexed)}function le(t,e){var t,n,t=Mt.convertColorToHex(t);if(t)return{n_:n=e||"color",rgb:t}}function he(t,e){var n,i,r,o,a,o,n=0,i,r=document.createElement("canvas").getContext("2d");return r||(o=s("canvas"))&&o.createCanvas&&(r=(a=o.createCanvas(2,2)).getContext("2d")),r&&(r.font=t,n=(o=r.measureText(e)).emHeightAscent+o.emHeightDescent),n}function de(t){return t!==w.ListType.circle&&t!==w.ListType.square&&t!==w.ListType.disc}function ve(t,e){var n,i,r;if((t+=1)<1||3999<t)return"i";for(n=[{value:1e3,numeral:e?"m":"M"},{value:900,numeral:e?"cm":"CM"},{value:500,numeral:e?"d":"D"},{value:400,numeral:e?"cd":"CD"},{value:100,numeral:e?"c":"C"},{value:90,numeral:e?"xc":"XC"},{value:50,numeral:e?"l":"L"},{value:40,numeral:e?"xl":"XL"},{value:10,numeral:e?"x":"X"},{value:9,numeral:e?"ix":"IX"},{value:5,numeral:e?"v":"V"},{value:4,numeral:e?"iv":"IV"},{value:1,numeral:e?"i":"I"}],i="",r=0;r<n.length;r++)for(;t>=n[r].value;)i+=n[r].numeral,t-=n[r].value;return i}function ge(t,e){var n="",i=e?97:65;if(0===t)return String.fromCharCode(i);for(;0<t;)n+=String.fromCharCode(t%26+i),t=Math.floor(t/26);return n}function me(t){var e,n;if(0===t)return"\u03b1";for(e=["\u03b1","\u03b2","\u03b3","\u03b4","\u03b5","\u03b6","\u03b7","\u03b8","\u03b9","\u03ba","\u03bb","\u03bc","\u03bd","\u03be","\u03bf","\u03c0","\u03c1","\u03c3","\u03c4","\u03c5","\u03c6","\u03c7","\u03c8","\u03c9"],n="";0<t;)n+=e[t%24],t=Math.floor(t/24);return n}function pe(t,e){switch(t){case w.ListType.lowerRoman:return ve(e,!0)+". ";case w.ListType.lowerAlpha:return ge(e,!0)+". ";case w.ListType.upperRoman:return ve(e)+". ";case w.ListType.upperAlpha:return ge(e)+". ";case w.ListType.decimal:return e+1+". ";case w.ListType.lowerGreek:return me(e)+". "}}function Se(t){switch(t){case w.ListType.lowerGreek:return f.GREEK_LETTER_FONT_FAMILY+", "+f.FallbackFontFamily;case w.ListType.disc:case w.ListType.circle:case w.ListType.square:return f.SYMBOL_FONT_FAMILY+", "+f.FallbackFontFamily;default:return f.NORMAL_RADIO_LIST_FONT+", "+f.FallbackFontFamily}}function we(t){switch(t){case w.ListType.disc:return"\u25cf ";case w.ListType.circle:return"\u25cb ";case w.ListType.square:return"\u25a0 "}}function be(t){for(var e,n,i,r,o,e=[],n=[],i=0,r=t.length;i<r;i++)((o=t[i]).richText?(0<n.length&&(e.push(n),n=[]),e):n).push(o);return 0<n.length&&e.push(n),e}function Ce(t){for(var e,n,i,r,o,a,s,u,c,f,c,c,e=be(t),i={},r={},o=[],a=0,s=e.length;a<s;a++)(u=e[a]).richText?(c=u.level||0,f=void 0,f=de(u.type)?(u.type===r[c]&&c<=n?i[c]++:i[c]=0,pe(u.type,i[c])):we(u.type),r[n=c]=u.type,(c=new Array(4*(c+1))).fill(" "),c={text:c.join("")+f},S(u.type)||(c.style={font:"11pt ".concat(Se(u.type))}),o=_(_(_([],o,!0),[c],!1),u.richText,!0)):(o=_(_([],o,!0),u,!0),r={},n=b,i={}),a!==s-1&&o.push({text:"\r\n"});return o}function ye(t){for(var e,n,i,r,e=0,n=t.richText.length;e<n;e++)if(t.richText[e].richText)return{richText:i=Ce(t.richText),text:b};return t}function I(){}function Me(t){t=t.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:t[1]||"",version:t[2]||"0"}}function ke(){var e,n,e=m,n=!1;try{new ActiveXObject("")}catch(t){e=t.name}try{n=!!new ActiveXObject("htmlfile")}catch(t){n=!1}return!(n="ReferenceError"===e||!1!==n)}function Te(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,s,d,s,s,v,g,o,a,r,c,e,n,s=t.Dn,u=t.zoom(),c="number"==typeof o,f=t.o2e(e,n,i,b,{rowSpacingIndex:o,isAfterRowSpacing:a}),l=0,h=f.cellType||t.$f(i);return h&&(d=f.font||s.Nn(),f.font=s._n(d),s=t.rowFilter&&t.rowFilter(),(d=!c&&!(!s||!s.rn(e,n,i)))||3!==i||(s=t.tables?t.tables.find(e,n):m)&&s.showHeader()&&s.headerIndex()===e&&s.rowFilter()&&s.filterButtonVisible(n-s.range().col)&&(d=!0),s=f.formatter||f._autoFormatter,v={sheet:t,row:e,col:n,sheetArea:i,quotePrefix:f.quotePrefix,rowSpacingIndex:o,isAfterRowSpacing:a},g={},o=t.$t(e,n,i,w.ValueType.richText,{rowSpacingIndex:o,isAfterRowSpacing:a}),a=c?"":t.t0(e,n,r),r="",c||(o&&o.richText?r=t.getText(e,n,i):S(a)?(r=h.format(o,s,g,v),h.xTe&&h.xTe(g,f.showEllipsis,b,f.hAlign)&&h.NTe&&(r=h.NTe(g.content))):r=a),l=h.Ln(o,r,f,u,v),d)&&(c=p(u,1),e=st((t.defaults.rowHeight*c).toString(),10),(n=3===(n=f.hAlign)?G.gt(n,o,f.formatter||f._autoFormatter,f.textOrientation):n)===w.HorizontalAlign.center?l+=2*e:n===w.HorizontalAlign.left&&(l+=e)),l}function xe(){}function Ge(t,e){var n=$t("span");return n.className=t,e&&(n.id=e),n.style.display="none",ee(n),n}function Be(t,e,n,i){t.addEventListener(e,n,i)}function Ie(t){var e,n,e=t.currentStyle,n=v.defaultView;return e=n&&n.getComputedStyle?n.getComputedStyle(t,""):e}function Pe(t){var e,e,n,i,n,e,r,o,e=l.gcGlobal;0<e.vf||(16!==t.keyCode&&(e.mf=!0),(n=(e=xt.ai())&&e.gf)&&(i=y(n)).isVisible())||e&&e.rt&&e.rt.pf&&(e.rt.pf(t),e.isEditing()||(n=t.keyCode,e=t.ctrlKey,r=t.altKey,o=t.shiftKey,90!==n&&89!==n||!e||r?86!==n||!e||r||o||t.stopPropagation&&t.stopPropagation():re(t)))}function Re(t){var e,e,e=l.gcGlobal;0<e.vf||(e.mf=!1,(e=xt.ai())&&e.rt&&e.rt.bf&&e.rt.bf(t))}function Ne(t){var e,n,e;0<l.gcGlobal.vf||(n=xt.ai())&&n.rt&&n.rt.yf&&n.rt.yf(t)}function Ee(t){var e,e,e=l.gcGlobal;0<e.vf||!0!==e.mf&&(e=xt.ai())&&e.rt&&e.rt.yf&&e.rt.yf(t)}function He(t){return v.all===b&&xt.ai()&&re(t),!1}function n(){this.vf=0,this.wf=[],this.mf=!1,this.Hc()}function r(){}function Ue(t,e){this.x=t,this.y=e}function P(t,e,n,i){var r=this;r.x=t,r.y=e,r.width=n,r.height=i}function R(t,e,n,i){var r=this;r.row=t,r.rowCount=n,r.col=e,r.colCount=i}function Fe(t,e,n,i){return new Rt(t,e,n,i)}function _e(t,e){var n,i,r,t;if(t&&e){if(n=p(t.row,e.row),i=p(t.col,e.col),r=g(t.row+t.rowCount-1,e.row+e.rowCount-1),t=g(t.col+t.colCount-1,e.col+e.colCount-1),0<=n&&0<=i)return new Rt(n,i,r-n+1,t-i+1);if(0<=n)return new Rt(n,-1,r-n+1,-1);if(0<=i)return new Rt(-1,i,-1,t-i+1)}return new Rt(-1,-1,-1,-1)}function Ae(){}function i(){}function o(t){this.Mf=t}function N(){}function Le(t){var e=t.Cf||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.Cf=e}function De(){}function je(t,e){t&&(t.Sf=e)}function Oe(t,e){t&&(t.Tf=e)}function Ve(t,e){t.Af=e}function Ye(t,e){t.If=e}function E(){}function Ke(){var t,t;return At.xf||(At.xf=$t("canvas").getContext("2d")),At.xf||(t=s("canvas"))&&t.createCanvas&&(t=t.createCanvas(2,2),At.xf=t.getContext("2d")),At.xf}function ze(t){return h.Common.CultureManager.Fe().hse(t)}function We(t){for(var e=t.length-1;" "===t.charAt(e);)e--;return t=e!==t.length-1?t.substring(0,e+1):t}function Je(t){var e,n,e=t instanceof Array?[]:{};for(n in t)t.hasOwnProperty(n)&&(e[n]="object"==typeof t[n]&&t[n]!==m?Je(t[n]):t[n]);return e}function Ze(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,h,o=[],a=r||Ke();if(a){for(u=n?(c=t.length*i,C(e/i)):(s=(c=B(a,a.font,t))/t.length,C(e/s));e<c&&t;)for(f=!1,l=u;;){if(t.length<l){o.push(t),t="";break}if(h=t.substring(0,l),d=n?l*i:B(a,a.font,h),(d="-"===h.charAt(h.length-1)?n?l*i:B(a,a.font,h)-B(a,a.font,"-"):d)===e||f&&d<e){o.push(h),t=t.substring(l),c-=d;break}if(e<d){if(1===h.length){(v=t.substring(h.length)).trim()?(o.push(h),t=t.substring(l),c-=d):(o.push(t),t="");break}--l,f=!0}else l+=h=1<=(h=n?(e-d)/i:(e-d)/s)?h:1}t&&-1===t.search(/^[ ]*$/)&&o.push(t)}return o}function Qe(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,v,g,m,p,a=o||Ke();if(!a)return[t];for(s=[],c=e,f=[],l=u=0;l<t.length;l++)if(h=t[l].style&&t[l].style.font||r,d=G.vt(h),h=ie(t[l],h),t[l].text&&0<t[l].text.length?u+=i?d*t[l].text.length:B(a,h,t[l].text):u=0,u<c)f.push(t[l]);else for(u-=i?d*t[l].text.length:B(a,h,t[l].text),v=0,g=t[l].text.length;v<g;v++){if(n<(m=i?d:B(a,h,t[l].text.charAt(v)))&&0===v){0<f.length&&(s.push(f),f=[]),f.push({style:t[l].style,text:t[l].text.substring(0,1)}),s.push(f),f=[],(p=t[l].text.substring(1,t[l].text.length)).length&&t.splice(l+1,0,{style:t[l].style,text:p}),u=0,c=n;break}if(c<(u+=m)){f.push({style:t[l].style,text:t[l].text.substring(0,v)}),s.push(f),f=[],(p=t[l].text.substring(v,t[l].text.length)).length&&t.splice(l+1,0,{style:t[l].style,text:p}),u=0,c=n;break}v===g-1&&(f.push({style:t[l].style,text:t[l].text}),s.push(f),f=[],u=0,c=n)}return 0<f.length&&s.push(f),s}function Xe(t,e,n,i,r){var o,a,s,r,r,u,c,f,l,h,d,v,g,g,m,p,S,o=[],a=ze(t),s=r||Ke();if(s){for(r=B(s,s.font,t),r=n?i:r/t.length,u=st(e/r+"",10),h=l=f=c=0,v=!(d=[]);h<a.length;){if(!1===v){if(g=a[h],d.push(g),(f+=g.length)<u&&h<a.length-1){h++;continue}l=f,f=0}if(e<(g=n?d.join("").length*i:At.Wt(d.join(""),s.font,!0,s)))if(m=d.pop(),0===d.length){for(p=Ze(m,e,n,i,s),S=0;S<p.length-1;S++)o[c]=p[S],c++;1===p.length&&(o[c]=p[0],c++),2<=p.length?a[h]=p[p.length-1]:h++,v=!1}else v=!0,h--;else g<e&&!0===v||g===e?(v=!1,o[c]=We(d.join("")),c++,d=[],h++):g<e&&(h++,f=l)}0!==d.length&&(o[c]=We(d.join("")))}return o}function qe(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,o=[],a=r||Ke();if(a)if(0===t.length)o.push({textLength:0,text:"",textInfos:[{style:{font:n},text:""}]});else{for(u=[],c=s=0;c<t.length;c++){for(f=t[c],d=h=l=0;d<f.length;d++)v=void 0,v=f[d].style&&f[d].style.font?f[d].style.font:n,i?l+=(h=G.vt(v))*f[d].text.length:S(f[d].text)||(v=ie(f[d],v),l+=B(a,v,f[d].text));if(e<l){for(0<u.length&&(o.push({textLength:s,text:We(tn(u)),textInfos:Je(u)}),u=[],s=0),g=Qe(f,e-s,e,i,n,a),u=u.concat(g[0]),S(g[0])||o.push({textLength:s+$e(g[0],n,i,a),text:We(tn(u)),textInfos:Je(u)}),u=[],s=0,m=1;m<g.length-1;m++)S(g[m])||o.push({textLength:$e(g[m],n,i,a),text:We(tn(g[m])),textInfos:Je(g[m])});1<g.length&&(p=g[g.length-1],u=u.concat(p),S(p)||(s+=$e(p,n,i,a)))}else e<s+l?(o.push({textLength:s,text:We(tn(u)),textInfos:Je(u)}),u=(u=[]).concat(f),s=l):(u=u.concat(f),s+=l)}0<u.length&&o.push({textLength:s,text:We(tn(u)),textInfos:Je(u)})}return o}function $e(t,e,n,i){for(var r,o,a,s,u,r=0,o=i||Ke(),a=0;a<t.length;a++)s=t[a].style&&t[a].style.font||e,u=ie(t[a],s),r+=n?G.vt(s)*t[a].text.length:B(o,u,t[a].text);return r}function tn(t){for(var e,n,e="",n=0;n<t.length;n++)e+=t[n].text;return e}function en(t,e,n,i){for(var r,o,a,s,u,c,c,r=-1,o=!0,a=0;a<e.length;a++)if(!S(e[a].text))for(s=0;s<e[a].text.length;s++)u=e[a].text.charAt(s),c=e[a].style?e[a].style.font:n,G.bt(t,c),c=G.vt(c),u===T||o?u!==T&&o&&(r=i?c:B(t,n,u),o=!1):r=p(r,i?c:B(t,n,u));return r}function H(){}function nn(){this.Nf={}}function rn(){}function on(t){var e,n,e,i,n,e,n,n,e=t.getRangeAt(0),n=e.startContainer,e=e.startOffset,i;sn(n)&&(n=mn(n,e))&&n.zeroWidthCharNode&&(e=n.zeroWidthCharNode,(n=t.getRangeAt(0)).setStart(e,1),n.deleteContents(),(n=v.createRange()).setStart(e,1),n.setEnd(e,1),t.removeAllRanges(),t.addRange(n),re(event))}function an(t){return t.textContent&&1===t.textContent.length&&t.textContent.split("")[0]===St}function sn(t){return t.textContent&&t.textContent.split("")[0]===St}function un(t,e,n){if(1===e&&cn(n.firstChild)&&cn(n.firstChild.firstChild)){var e=n.firstChild.firstChild.lastChild,i=void 0;if(t===n)return 1===(i=e.textContent).length&&i[0]!==St&&fn(e.previousSibling);if(e===t||fn(e)&&t===e.previousSibling)return 1===(i=t.textContent).length&&i[0]!==St&&fn(t.previousSibling)}}function cn(t){return t&&"SPAN"===t.tagName}function fn(t){return t&&"BR"===t.tagName}function ln(t){return t&&"DIV"===t.tagName}function hn(t){return t instanceof Text}function dn(t){var e;return!!t&&(e=t.childNodes,cn(t))&&2===e.length&&fn(e[0])&&gn(e[1])}function vn(t,e){var n;if(t)return n=t.childNodes,cn(t)&&fn(n[e-2])&&gn(n[e-1])}function gn(t){if(t&&hn(t)){var t=t.textContent;if(1===t.length&&bn(t[0]))return!0}return!1}function mn(t,e){var n,i,r,o,i,n,e,n=t.childNodes.length,o;if(!bn((t.innerText||t.textContent)[0])||0!==e&&1!==e)if(0===e)i=(i=Cn(r=(r=t)===t.parentNode.firstChild?t.parentNode:r,dn))&&i.lastChild;else{if(ln(t))return 1===n&&1===e?i=t.firstChild.firstChild.lastChild:1<n&&e===n&&(i=t.lastChild),gn(i)?{zeroWidthCharNode:i,previousTextNode:i.previousSibling.previousSibling}:dn(i)?{zeroWidthCharNode:i,previousTextNode:Cn(r,hn)}:m;!cn(t)||e!==n&&e!==n-1||(dn(t)?i=t:dn(t.lastChild)?i=t.lastChild:vn(t,e)&&(i=t.childNodes[e-1]))}else i=t;return i?(cn(i)?r=i:hn(i)&&(r=(n=i.previousSibling)===(e=i.parentNode).firstChild?e:n),{zeroWidthCharNode:i,previousTextNode:Cn(r,hn)}):m}function pn(t){var e,t,n,i,r,t,e=t.anchorNode,t=t.anchorOffset,n=e.textContent,i;if(t!==n.length)return 0===t&&bn(n[0])?{node:e,offset:0}:m;if(t=void 0,!(r=yn(e)))return m;if(cn(r)&&bn(r.textContent[0])){for(;cn(r.firstChild);)r=r.firstChild;t=r.childNodes[1]}else fn(r)&&bn(r.nextSibling.textContent[0])&&(t=r.nextSibling);return{node:t,offset:1}}function Sn(t,e,n,i,r,o){for(var a,s,u,c,f,l,h,d,a="",s=t.childNodes,u=s.length,c=0;c<u;c++)cn(f=s[c])?a+=Sn(f,e,n,i,r,o):hn(f)?(l=e&&e.startContainer,h=e&&e.endContainer,d=f.textContent,f===l||f===h?l!==h?o=f===l?(a+=wn(d,n,d.length,r),!0):(a+=wn(d,0,i,""),!1):a+=wn(d,n,i,r):o||(a+=d)):fn(f)&&!o&&(a+="\n");return a}function wn(t,e,n,i){var r,o,r,o;return t.substr(0,e)+i+t.substr(n,t.length-n)}function bn(t){return t===St}function Cn(t,e){for(var n=t&&t.previousSibling;n;){if(e(n))return n;n=n.lastChild}return m}function yn(t){for(var e,n,e=t;e;){if(e!==(n=e.parentNode).lastChild)return e.nextSibling;e=n}return m}function Mn(t){var e,t;return e=t&&!(e=t.getActiveSheet())&&(t=t.getActiveSheetTab())?t.Mf:e}function kn(t,e){var n,i;t&&((n=t._f(e))?t.setActiveSheet(e):(i=t.Ofe(e))&&t.setActiveSheetTab(e))}function Tn(t,e){var n,t,n=t._f(e);return n||(t=t.Ofe(e))&&(n=t.Mf),n}function xn(t){var e,n,i,r,e=[].concat(t.parent.sheets);for(t&&t.NMi&&e.push(t),n=t.parent.getSheetTabCount(),i=0;i<n;i++)(r=t.parent.getSheetTab(i))&&r.Mf&&e.push(r.Mf);return e}function Gn(t){return"="===t||"+"===t||"-"===t}function Bn(t){var t;return 1<t.length&&Gn(t[0])&&Gn(t[1])||!0===(t=G.Xf(void 0,t,!0))||!1===t?NaN:t}function In(t){return t&&0<t.length&&Gn(t[0])&&!Gn(t)&&isNaN(Bn(t))}function Pn(){}function Rn(){var t=this;t.rowInfo=[],t.colInfo=[],t.wholeCols={},t.wholeRows={}}function Nn(){this.reset()}function En(t,e){var e=k(10,e);return M(t*e)/e}function U(){}function Hn(t,e){this.numberFormatId=t,this.numberFormatCode=e}function Un(t){return!1===t}function Fn(t){var e,n,i,r,o,a;t&&(e=t.applyFont,n=t.applyFill,i=t.applyBorder,r=t.applyAlignment,o=t.applyNumberFormat,a=t.applyProtection,!1===e&&(delete t.foreColor,delete t.textDecoration,delete t.themeFont,delete t.font),!1===n&&delete t.backColor,!1===i&&(delete t.borderLeft,delete t.borderTop,delete t.borderRight,delete t.borderBottom,delete t.diagonalDown,delete t.diagonalUp),!1===r&&(delete t.textIndent,delete t.wordWrap,delete t.hAlign,delete t.vAlign,delete t.isVerticalText,delete t.shrinkToFit,delete t.textOrientation),!1===o&&delete t.formatter,!1===a)&&(delete t.locked,delete t.hidden)}function _n(t,e,n,i){var r,e;n&&(r=n.foreColor,r=Bt.m(e,r),i=S(n.opacity)?i:n.opacity,S(i)||((e=V._(r)).a=i,r=V.j(e)),t.fillStyle!==r)&&(t.fillStyle=r||"#000000")}function An(t){return L.Cmt(t.split(""),!1)?t:"'"+t.replace(/'/g,"''")+"'"}function Ln(t,e,n,i,r){if(Jt=Jt||s("SheetsCalc"))return Jt.rangeToFormula(t,e,n,i,r)}function Dn(t,e){var n,i,r,o,n=Array.isArray(t),i="[object Object]"===Object.prototype.toString.call(t);if(n){for(r=[],o=0;o<t.length;o++)r[o]=Dn(t[o],e);return r}if(i){for(o in r=void 0,t)S(t[o])&&!e||((r=void 0===r?{}:r)[o]=Dn(t[o],e));return r}return t}function a(){}function jn(t){t&&t.length&&t.forEach(function(t){var e=t.sheet,n=t.table,i=t.oldRange,t=t.newRange;e.S4t(n,i,t)})}_=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(f,"__esModule",{value:!0}),f.i2e=f.resetFillStyle=f.AL=f.ExcelNumerFormat=f.SJSColumnWidthHelper=f.unknownFontMaxDigitWidthMap=f.SharedStrings=f.NUMBER_ARRAY=f.BaseUsedRange=f.UsedRangeUtil=f.kf=f.Df=f.hCe=f._f=f.Ef=f.jf=f.Of=f.di=f.Rf=f.$e=f.q=f.r2e=f.zt=f.Bf=f.Lf=f.Be=f.Ff=f.Events=f.Pf=f.getUnionRange=f.Ec=f.Range=f.Rect=f.Point=f.I=f.hi=f.mt=f.util=f.getFontHeightWithCanvas=f.ColorHelper=f.findControl=f.getTypeFromString=f.CursorResource=f.productInfo=f.isDefined=f.FormulaPrefix=f.NORMAL_RADIO_LIST_FONT=f.SYMBOL_FONT_FAMILY=f.GREEK_LETTER_FONT_FAMILY=f.FallbackFontFamily=void 0,f.handleRestoredTableResizedArgs=f.oCe=f.RF=f.rangeToFormula=void 0,h=s("Common"),t=s("./dist/core/util/domUtil.js"),A=s("./dist/core/core.ns.js"),w=s("./dist/core/core.enum.js"),e=s("./dist/core/excel-io-util/common.js"),L=s("CalcEngine"),D=s("./dist/core/util/imageLoader.js"),j=s("./dist/core/worksheet/stylehelper.js"),y=t.GC$,O=y.extend,V=h.Common.ft,Y=h.Common.st,K=h.Common.Uf.Gf,d=h.Formatter&&h.Formatter.GeneralFormatter,z=h.Formatter&&h.Formatter.Hf,S=h.Common.lt.ht,W=h.Common.lt.q8,J=e.StringEx.Xi,Z=h.Common.zf,t=new h.Common.ResourceManager(A.SR),Q=t.getResource.bind(t),f.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',X=e.Util.addXLFNPrefix,f.GREEK_LETTER_FONT_FAMILY="SJSRadioListGreekLetterFont",f.SYMBOL_FONT_FAMILY="SJSRadioListSymbolFont",f.NORMAL_RADIO_LIST_FONT="SJSRadioListFont",l=window,v=document,q="boolean",$="date",tt="function",b=void 0,m=null,et=Math.floor,C=Math.ceil,p=Math.min,g=Math.max,M=Math.round,k=Math.pow,nt=Math.sqrt,it=Math.atan2,rt=Math.cos,ot=Math.abs,at=Math.sin,st=parseInt,ut=parseFloat,ct=isNaN,ft=.7,lt="px",T=" ",ht=".",x="string",dt="number",vt="touch",gt="MSPOINTER_TYPE_TOUCH",mt=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),pt=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),St="\u200b",f.FormulaPrefix=["=","+","-"],f.isDefined=qt,f.productInfo={productVersion:"17.1.3"},f.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize",DragHeaderGrab:"grab",DragHeaderGrabbing:"grabbing"},f.getTypeFromString=wt=function(t){var e,n,i,r,o,e=!1,n=l;if(typeof t===x){for(r=0,o=(i=t.split(ht)).length;r<o&&n;r++)n=n[i[r]];n&&r===o&&0<o&&(e=!0)}return e?n:b},f.findControl=bt=function(t){return typeof t===x&&(t=v.getElementById(t)),y(t).data("workbook")},Ct=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080,4294967295],yt={aliceblue:4293982463,antiquewhite:4294634455,aqua:4278255615,aquamarine:4286578644,azure:4293984255,beige:4294309340,bisque:4294960324,black:4278190080,blanchedalmond:4294962125,blue:4278190335,blueviolet:4287245282,brown:4289014314,burlywood:4292786311,cadetblue:4284456608,chartreuse:4286578432,chocolate:4291979550,coral:4294934352,cornflowerblue:4284782061,cornsilk:4294965468,crimson:4292613180,cyan:4278255615,darkblue:4278190219,darkcyan:4278225803,darkgoldenrod:4290283019,darkgray:4289309097,darkgreen:4278215680,darkkhaki:4290623339,darkmagenta:4287299723,darkolivegreen:4283788079,darkorange:4294937600,darkorchid:4288230092,darkred:4287299584,darksalmon:4293498490,darkseagreen:4287609999,darkslateblue:4282924427,darkslategray:4281290575,darkturquoise:4278243025,darkviolet:4287889619,deeppink:4294907027,deepskyblue:4278239231,dimgray:4285098345,dodgerblue:4280193279,feldspar:4291924597,firebrick:4289864226,floralwhite:4294966e3,forestgreen:4280453922,fuchsia:4294902015,gainsboro:4292664540,ghostwhite:4294506751,gold:4294956800,goldenrod:4292519200,gray:4286611584,green:4278222848,greenyellow:4289593135,honeydew:4293984240,hotpink:4294928820,"indianred ":4291648604,"indigo ":4283105410,ivory:4294967280,khaki:4293977740,lavender:4293322490,lavenderblush:4294963445,lawngreen:4286381056,lemonchiffon:4294965965,lightblue:4289583334,lightcoral:4293951616,lightcyan:4292935679,lightgoldenrodyellow:4294638290,lightgrey:4292072403,lightgreen:4287688336,lightpink:4294948545,lightsalmon:4294942842,lightseagreen:4280332970,lightskyblue:4287090426,lightslateblue:4286869759,lightslategray:4286023833,lightsteelblue:4289774814,lightyellow:4294967264,lime:4278255360,limegreen:4281519410,linen:4294635750,magenta:4294902015,maroon:4286578688,mediumaquamarine:4284927402,mediumblue:4278190285,mediumorchid:4290401747,mediumpurple:4287852760,mediumseagreen:4282168177,mediumslateblue:4286277870,mediumspringgreen:4278254234,mediumturquoise:4282962380,mediumvioletred:4291237253,midnightblue:4279834992,mintcream:4294311930,mistyrose:4294960353,moccasin:4294960309,navajowhite:4294958765,navy:4278190208,oldlace:4294833638,olive:4286611456,olivedrab:4285238819,orange:4294944e3,orangered:4294919424,orchid:4292505814,palegoldenrod:4293847210,palegreen:4288215960,paleturquoise:4289720046,palevioletred:4292374675,papayawhip:4294963157,peachpuff:4294957753,peru:4291659071,pink:4294951115,plum:4292714717,powderblue:4289781990,purple:4286578816,red:4294901760,rosybrown:4290547599,royalblue:4282477025,saddlebrown:4287317267,salmon:4294606962,sandybrown:4294222944,seagreen:4281240407,seashell:4294964718,sienna:4288696877,silver:4290822336,skyblue:4287090411,slateblue:4285160141,slategray:4285563024,snow:4294966010,springgreen:4278255487,steelblue:4282811060,tan:4291998860,teal:4278222976,thistle:4292394968,tomato:4294927175,turquoise:4282441936,violet:4293821166,violetred:4291829904,wheat:4294303411,white:4294967295,whitesmoke:4294309365,yellow:4294967040,yellowgreen:4288335154,transparent:16777215},c.hexToARGB=function(t){return{r:(t="string"==typeof t?parseInt(t,16):t)>>16&255,g:t>>8&255,b:255&t,a:t>>24&255}},c.convertRgbToXyz=function(t){var e,n,i,t,n,i,e,r,o,a,e=function(t){return t=.04045<(t/=255)?k((t+.055)/1.055,2.4):t/12.92,t*=100},n=t.r,i=t.g,t=t.b,n=e(n),i=e(i),e=e(t),r,o,a;return{x:.4124564*n+.3575761*i+.1804375*e,y:.2126729*n+.7151522*i+.072175*e,z:.0193339*n+.119192*i+.9503041*e}},c.convertXyzToLab=function(t){var e,n,i,t,r,o,a,e=function(t){return.008856<t?k(t,1/3):7.787*t+16/116},n=t.x,i=t.y,t=t.z;return i/=100,t/=107.304,n=e(n/=94.811),{lightness:r=116*(i=e(i))-16,redGreen:o=500*(n-i),blueYellow:a=200*(i-(t=e(t)))}},c.calculateDeltaE2000=function(t,e){var n,i,t,r,o,e,a,s,u,c,f,l,l,i,o,l,h,d,t,i,a,e,o,i,t,r,n,l,h,v,u,g,m,p,n=t.lightness,i=t.redGreen,t=t.blueYellow,r=e.lightness,o=e.redGreen,e=e.blueYellow,a=function(t){return 360*t/(2*Math.PI)},s=function(t){return 2*Math.PI*t/360},u=(n+r)/2,c,f,l=(nt(k(i,2)+k(t,2))+nt(k(o,2)+k(e,2)))/2,l=(1-nt(k(l,7)/(k(l,7)+k(25,7))))/2,i=i*(1+l),o=o*(1+l),l=nt(k(i,2)+k(t,2)),h=nt(k(o,2)+k(e,2)),d=(l+h)/2,t=a(it(t,i));return t<0&&(t+=360),(i=a(it(e,o)))<0&&(i+=360),a=180<ot(t-i)?(t+i+360)/2:(t+i)/2,e=1-.17*rt(s(a-30))+.24*rt(s(2*a))+.32*rt(s(3*a+6))-.2*rt(s(4*a-63)),180<ot(o=i-t)&&(i<=t?o+=360:o-=360),i=r-n,t=h-l,o=2*nt(l*h)*at(s(o)/2),r=1+.015*k(u-50,2)/nt(20+k(u-50,2)),n=1+.045*d,l=1+.015*d*e,h=30*Math.exp(-k((a-275)/25,2)),u=-(v=2*nt(k(d,7)/(k(d,7)+k(25,7))))*at(2*s(h)),p=m=g=1,nt(k(i/r,2)+k(t/n,2)+k(o/l,2)+t/n*u*(o/l))},c.getClosestColorIndex=function(t,e){var n,i,r,o,a,a;for(e===b&&(e=64),n=-1,i=Number.MAX_VALUE,r=c.convertXyzToLab(c.convertRgbToXyz(t)),o=Math.min(c.paletteInLab.length-1,e);0<=o;o--)a=c.paletteInLab[o],(a=c.calculateDeltaE2000(a,r))<i&&(i=a,n=o);return n},c.getHexNumString=function(t){var e,e,e=+t;return isNaN(e)?t+"":(e=(t=e).toString(16),t<16?"0"+e:e)},c.convertColorToHex=function(t){var t,e,n,i,r,o;if(t)return"string"!=typeof t?t:("#"===(t=t.toLowerCase()).substring(0,1)?7===t.length?e="FF"+t.substring(1).toUpperCase():4===t.length&&(e="FF"+(n=t[1]+t[1]+t[2]+t[2]+t[3]+t[3]).toUpperCase()):"rgb("===t.substring(0,4)?(r=t.indexOf("("),o=t.indexOf(")"),i=t.substring(r+1,o).split(","),e="FF"+(n=c.getHexNumString(i[0])+c.getHexNumString(i[1])+c.getHexNumString(i[2])).toUpperCase()):"rgba("===t.substring(0,5)?(r=t.indexOf("("),o=t.indexOf(")"),i=t.substring(r+1,o).split(","),e=(n=c.getHexNumString(i[3])+c.getHexNumString(i[0])+c.getHexNumString(i[1])+c.getHexNumString(i[2])).toUpperCase()):yt[t]&&(e=yt[t].toString(16).toUpperCase()),e)},c.convertHexColorToArgb=function(t){return c.hexToARGB(c.convertColorToHex(t))},c.getIndexedColor=function(t){var t,e,n,i;return 32767===t||t<0||Ct.length<=t?"#000000":Ct[t]!==b?"rgb("+(e=(t=Ct[t])>>16&255)+","+(n=t>>8&255)+","+(i=255&t)+")":void 0},c.palette=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080],c.paletteInLab=[{lightness:0,redGreen:0,blueYellow:0},{lightness:100.00000386666655,redGreen:.41450003183252093,blueYellow:-.9762337974368318},{lightness:53.24079414130722,redGreen:80.40628534603033,blueYellow:66.9485076645686},{lightness:87.73472235279792,redGreen:-85.88347705836918,blueYellow:82.71231806483974},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:0,redGreen:0,blueYellow:0},{lightness:100.00000386666655,redGreen:.41450003183252093,blueYellow:-.9762337974368318},{lightness:53.24079414130722,redGreen:80.40628534603033,blueYellow:66.9485076645686},{lightness:87.73472235279792,redGreen:-85.88347705836918,blueYellow:82.71231806483974},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:25.53553096346318,redGreen:48.23338316760745,blueYellow:37.96950789833623},{lightness:46.22743146876261,redGreen:-51.51899057263506,blueYellow:49.61670487243066},{lightness:12.9719668574308,redGreen:47.64519130280251,blueYellow:-65.26181066276018},{lightness:51.86894337734398,redGreen:-12.69765903738712,blueYellow:56.380043157800905},{lightness:29.784666617920195,redGreen:59.1403568405364,blueYellow:-37.05049551887899},{lightness:48.2540934618616,redGreen:-28.64061189579556,blueYellow:-9.059017225814237},{lightness:77.7043667134314,redGreen:.3348315663007084,blueYellow:-.7885979888260453},{lightness:53.585015771669404,redGreen:.2486464680258038,blueYellow:-.5856141545440119},{lightness:67.10642818332406,redGreen:24.661563327250835,blueYellow:-51.70481284997233},{lightness:38.02326868659504,redGreen:47.530276772876526,blueYellow:-7.41000863702892},{lightness:98.88366982816507,redGreen:-7.647377025903346,blueYellow:23.604961406243042},{lightness:96.64610006552223,redGreen:-15.626896975835969,blueYellow:-6.286449794841897},{lightness:22.946593663526578,redGreen:50.30757275587142,blueYellow:-31.51689638909162},{lightness:68.21369400049187,redGreen:48.529707503769,blueYellow:22.097909906924063},{lightness:44.03181574544729,redGreen:15.497390355584283,blueYellow:-60.313393374835414},{lightness:83.56960561788927,redGreen:10.660290354444879,blueYellow:-25.869538462689157},{lightness:12.9719668574308,redGreen:47.64519130280251,blueYellow:-65.26181066276018},{lightness:60.32421212836874,redGreen:98.58848986524677,blueYellow:-61.76412516100469},{lightness:97.13926722430631,redGreen:-21.167322894165398,blueYellow:93.98697624453854},{lightness:91.11321981275862,redGreen:-47.74463372340881,blueYellow:-15.101613782352352},{lightness:29.784666617920195,redGreen:59.1403568405364,blueYellow:-37.05049551887899},{lightness:25.53553096346318,redGreen:48.23338316760745,blueYellow:37.96950789833623},{lightness:48.2540934618616,redGreen:-28.64061189579556,blueYellow:-9.059017225814237},{lightness:32.297010932850725,redGreen:79.42575443955474,blueYellow:-108.79311020157895},{lightness:76.31433784805343,redGreen:-24.045184322556313,blueYellow:-37.63232479221295},{lightness:96.64610006552223,redGreen:-15.626896975835969,blueYellow:-6.286449794841897},{lightness:95.46123799053612,redGreen:-25.20013221308681,blueYellow:18.33180794427749},{lightness:98.0661672083006,redGreen:-13.832882960730986,blueYellow:47.940897645383274},{lightness:80.27790732349922,redGreen:-3.692924875082826,blueYellow:-31.192993832087378},{lightness:75.08051024268852,redGreen:44.9470828980269,blueYellow:-10.53443113754624},{lightness:71.44638619892534,redGreen:38.40169770146873,blueYellow:-44.58196770374543},{lightness:85.37715784474301,redGreen:11.871131967975845,blueYellow:31.5700614950422},{lightness:48.789468602187014,redGreen:37.72886428748323,blueYellow:-81.46151935827358},{lightness:74.97920661167659,redGreen:-37.437024973414836,blueYellow:-12.053212107002897},{lightness:76.04314994204388,redGreen:-38.98270545611504,blueYellow:75.18013610138723},{lightness:84.19958734726818,redGreen:4.040877427542666,blueYellow:84.79018925434798},{lightness:72.2607240884026,redGreen:30.50579205114734,blueYellow:76.85864017596677},{lightness:62.312481453511026,redGreen:55.3256388060856,blueYellow:71.01583749339153},{lightness:45.11897896728884,redGreen:12.741665540704494,blueYellow:-28.39942907333195},{lightness:62.082179778109094,redGreen:.2790091803857031,blueYellow:-.6571246580693746},{lightness:21.3066228635372,redGreen:6.957317762469661,blueYellow:-34.694697216998314},{lightness:56.52959107095738,redGreen:-41.28375003303447,blueYellow:17.929912574393892},{lightness:17.308442495122094,redGreen:-27.576541316135987,blueYellow:24.11521195522933},{lightness:20.328171424265783,redGreen:-6.796668862699029,blueYellow:28.392687041649655},{lightness:36.25649980036505,redGreen:41.047060654411325,blueYellow:47.86323594949912},{lightness:38.02326868659504,redGreen:47.530276772876526,blueYellow:-7.41000863702892},{lightness:27.765685279866425,redGreen:33.339639613412324,blueYellow:-56.37161392120451},{lightness:21.24673253653905,redGreen:.13309285609849897,blueYellow:-.31346136150179893},{lightness:0,redGreen:0,blueYellow:0}],Mt=c,f.ColorHelper=Mt,f.getFontHeightWithCanvas=he,kt=/&#(\d+);/g,Tt=/&#x([0-9A-F]+);/gi,I.Vf=function(t){for(var e,n,e="";0<t;t=parseInt((t-1)/26+"",10))e=String.fromCharCode(65+(n=(t-1)%26))+e;return e},I.gt=function(t,e,n,i){var r;return 3===t&&(r=y.getType(e),t=!n||"@"!==n&&"@"!==n.formatCached?r===q?1:r===dt||r===$||r===x&&(I.Yf(e)||I.eHe(e))?2:0:0,i)&&0!==i&&(0<i?t=0:i<0&&(t=2),-90===i?t=0:90===i&&(t=2)),t},I.Yf=function(t){return I.Zf.test(t)},I.eHe=function(t){return I.iHe.test(t)},I.j=function(t){var e,e,e=y.getType(t);return t=t===m||t===b?"":e===q?t.toString().toUpperCase():e===$?(e=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds(),h.Common.ct.Pe(t,e?"M/d/yyyy":"M/d/yyyy h:mm:ss")):t.richText?I.wt(t):t.toString()},I.Wf=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,s=y(t),u=e,c=n,f="background-position",l="background-size",h="auto",d="0%",v="50%",g="100%";switch(o){case 0:a?s.css(f,a.position).css(l,a.size):s.css(f,d+T+d).css(l,g+T+g);break;case 1:p=m=v,s.css(f,(m=u<i?d:v)+T+(p=c<r?d:v)).css(l,h+T+h);break;case 2:b=u,(w=S=0)<(C=c)&&0<r&&i/r<u/c?S=S+u/2-(b=i/r*c)/2:0<u&&0<i&&r/i<c/u&&(w=w+c/2-(C=r/i*u)/2),s.css(f,S+lt+T+w+lt).css(l,b+lt+T+C+lt);break;case 3:s.css(f,d+T+d).css(l,h+T+h)}},I.device=function(){var t,e,n,i,r,o,t=navigator.userAgent,e=t.match(/iPad/i);if(e)(n=e[0])&&(i="ipad"===n.toLowerCase());else if((e=t.match(/Macintosh/i))&&(n=e[0]))try{document.createEvent("TouchEvent"),i="macintosh"===n.toLowerCase()}catch(t){}return{ipad:i,iphone:r=(e=t.match(/iPhone/i))&&(n=e[0])?"iphone"===n.toLowerCase():r,android:o=(e=t.match(/android/i))&&(n=e[0])?"android"===n.toLowerCase():o}},I.Qf=function(){var t=navigator.platform;return t&&-1<t.indexOf("Mac")},I.Kf=function(t){var t,t;return t!==b&&t!==m&&(t=t.toString(),t=Y.Jf(t),!ct(Number(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t))},I.Xf=function(t,e,n,i,r){var o,a,s,s,u,t,o,a,o=m,a=!1;if(t&&((s=t.formatter)?(r?o=r:I.St(s)||(o=s,a=!0),typeof o===x&&d&&(o=new d(o))):o=t._autoFormatter),o&&!o.isAuto){s=m;try{if(s=o.parse(e),typeof(s=a&&s instanceof Date&&(u=(new d).getPreferredDisplayFormatter(e,r))?u.parse(e):s)==dt)return s}catch(t){}return s===b||s===m?e:s}if(n){if(t=void 0,t={},o=void 0,a=m,d)try{a=(new d).getPreferredDisplayFormatter(e,t)}catch(t){}return typeof(o=t.value)==dt?e=o:I.Kf(e)&&(o=t.value=e),i&&(i.value=a),o!==b&&o!==m?o:e}return e},I.gi=function(t){for(var e,n,t,i,e=v.body,n=t;n&&n.parentElement&&n.parentElement!==e;)n=n.parentElement;return t=1e3,n&&n.parentElement===e&&(i=st(y(n).css("z-index")),ct(i)||(t+=i)),t},I.ri=function(t){var e,n,i,r,o,a,s,u,c,f,l,h,d,v,d;if(!t)return[];if(e=t.indexOf("("),n=t.lastIndexOf(")"),!(i=t.substring(e+1,n)))return[];for(r=[],a="",u=s=o=0;u<i.length;)s=i.indexOf("rgb",o),-1===(u=i.indexOf("rgb",o+1))&&(u=i.length),a=i.substring(s,u),r.push(a),o=u;for(c=[],f=0,l=r.length;f<l;f++)d=(h=r[f]).indexOf(")"),v=h.substring(0,d+1),d=ut(h.substring(d+1,h.length)),ct(d)&&(f===l-1?d=100:f<=1&&(d=0)),!v&&0===f||c.push({color:v,point:d/=100});return c},I.qf=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,h,m,p,S,o=0,a=[n];for(i===w.AutoFitType.cellWithHeader&&(n===w.SheetArea.viewport?a.push(1):n===w.SheetArea.rowHeader&&a.push(0)),s=e.FCn,u=0;u<a.length;u++)for(c=0,f=a[u],l=r||e.getRowCount(f);0<=c&&c<l;)if((h=e.Ut.findSpan(c,t,f))&&(h.col<t||1<h.colCount||h.row<c))c=h.row+h.rowCount;else{if(s&&e.FCn(c,!1,n))for(d=e.C9e(c,!1,n),v=0;v<d;v++)e.NFe(c,v,!1,n)&&o<(g=Te(e,c,t,f,n,v))&&(o=g);if(o<(h=Te(e,c,t,f,n))&&(o=h),s&&e.FCn(c,!0,n))for(m=e.C9e(c,!0,n),p=0;p<m;p++)e.NFe(c,p,!0,n)&&o<(S=Te(e,c,t,f,n,p,!0))&&(o=S);f===w.SheetArea.viewport?c=I.n0(c,t,e,f):c++}return 0===o?o=e.defaults.colWidth:o+=C(3),C(o)},I.n0=function(t,e,n,i){for(var r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,r=-1,o=n.getRowCount(i),a=n.FCn,s=t+1;s<o;s++){if(u=n.$t(s,e,i)){r=s;break}if((c=n.getActualStyle(s,e,i))&&(c.cellType||c.cellButtons&&0<c.cellButtons.length||j.W.Jue(c))){r=s;break}if(a){if(0<(l=n.C9e(s,f=!1,i))){for(h=0;h<l;h++){if(d=n.$t(s,e,i,b,{rowSpacingIndex:h})){r=s,f=!0;break}if((v=n.getActualStyle(s,e,i,b,{rowSpacingIndex:h}))&&(v.cellType||v.cellButtons&&0<v.cellButtons.length||j.W.Jue(v))){r=s,f=!0;break}}if(f)break}if(0<(g=n.C9e(s,!0,i))){for(m=0;m<g;m++){if(p=n.$t(s,e,i,b,{rowSpacingIndex:m,isAfterRowSpacing:!0})){r=s,f=!0;break}if((S=n.getActualStyle(s,e,i,b,{rowSpacingIndex:m,isAfterRowSpacing:!0}))&&(S.cellType||S.cellButtons&&0<S.cellButtons.length||j.W.Jue(S))){r=s,f=!0;break}}if(f)break}}}return r},I.e0=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,v,g,g,u,m,p,S,r=e.Dn,o=0,a=[n],s=e.zoom();for(1===i&&(3===n?a.push(2):1===n&&a.push(0)),f=!1,l=c=0;l<a.length;l++)for(h=0,d=e.getColumnCount(n=a[l]);0<=h&&h<d;)(v=e.Ut.findSpan(t,h,n))&&(v.row<t||1<v.rowCount||v.col<h)?h=v.col+v.colCount:(0<e.getColumnWidth(h,n)&&(g=(v=e.o2e(t,h,n)).font||r.Nn(),v.font=r._n(g),g=0,(u=e.getCellType(t,h,n))&&(m=e.getText(t,h,n),p=e.$t(t,h,n,w.ValueType.richText),g=u.Fn(p,m,v,s,S={sheet:e,row:t,col:h,sheetArea:n})),2===(u=e.Lt(h))?c=c+g+C(3):(c&&(g+=c,c=0),1===u&&(f=!0)),o<(g=c?c:g))&&(o=g),3===n?h=I.i0(t,h,e,n):h++);return 0===(o=f&&o<60?60:o)?o=e.defaults.rowHeight:o+=C(3),C(o)},I.i0=function(t,e,n,i){for(var r,o,a,s,u,r=-1,o=n.getColumnCount(i),a=e+1;a<o;a++){if(s=n.$t(t,a,i)){r=a;break}if((u=n.getActualStyle(t,a,i))&&u.cellType){r=a;break}}return r},I.Eve=function(t){var e,n,i,r;if(t instanceof Date)return t;if("string"!=typeof t)return"number"==typeof t&&!isNaN(t)&&(e=h.Common.ct.Y0(t))||m;if(!(e=h.Common.ct.yU(t)))if(isNaN(t)){if(h.Common.ct.u6t(t))return m;if(e=new Date(t),isNaN(e.valueOf()))return m;try{if(n=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,i=Z.s6t(Z.cJ(t.replace(/[ \n]/g,"")," ")," "),(r=n.exec(i))&&4===r.length&&(-1===r.indexOf(e.getFullYear().toString())||-1===r.indexOf(e.getMonth().toString())||-1===r.indexOf(e.getDate().toString())))return m}catch(t){return m}}else if(!(e=h.Common.ct.Y0(parseFloat(t))))return m;return e},I.mi=function(t,e,n,i,r){var o,a,i,t,r,s,u,c,f,l;if(n&&(o=i.row,a=i.col,i=i.sheetArea,t=t.formatter||t._autoFormatter,r=r||{},d)&&e!==m&&e!==b)if(s=void 0,t&&t.isAuto)s=typeof e==dt,u=I.Kf(e),!s&&u&&(e=Y.Jf(e)),e=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(e).format(e):e;else if(t=typeof t!==x||I.St(t)?t:new d(t))try{e instanceof Date?((c=L&&L.Convert.r0(e))&&(e=c),f=h.Common.CultureManager.Fe().DateTimeFormat,l=h.Common.ct.o0(e),t=!z.a0(t.formatString(),["d","y"])&&0<=l&&l<1?new d(f.longTimePattern):0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?new d(f.shortDatePattern):new d(f.shortDatePattern+T+f.longTimePattern),n.u0=!0,e=t.format(e),r.formatter=t):typeof e==dt&&(e=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(e).format(e):Y.Ge(e.toString()))}catch(t){e=n.getText(o,a,i)}else e=0===e?"0":n.getText(o,a,i);return e=e!==m&&e!==b?I.j(e):e},I.s0=function(t,e,n,i){var n,i,r,o,a,s;if(n&&(n=i||{},d)&&e!==m&&e!==b)if(i=void 0,t&&t.isAuto)i=typeof e==dt,r=I.Kf(e),!i&&r&&(e=Y.Jf(e)),e=t.getPreferredEditingFormatter?t.getPreferredEditingFormatter(e).format(e):e;else if(t)try{e instanceof Date?(typeof t!==x||I.St(t)||(t=new d(t)),(o=L&&L.Convert.r0(e))&&(e=o),a=h.Common.CultureManager.Fe().DateTimeFormat,s=h.Common.ct.o0(e),e=(t=!z.a0(t.formatString(),["d","y"])&&0<=s&&s<1?new d(a.longTimePattern):0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?new d(a.shortDatePattern):new d(a.shortDatePattern+T+a.longTimePattern)).format(e),n.formatter=t):typeof e==dt&&(e=Y.Ge(e.toString()))}catch(t){}return e=e!==m&&e!==b?I.j(e):e},I.c0=function(t,e,n,i){return!S(t)&&"string"==typeof t&&!!(e||-1===f.FormulaPrefix.indexOf(t)&&0<t.length&&-1!==f.FormulaPrefix.indexOf(t[0])&&n&&!i)},I.f0=function(t,e,n){var i,r,r,i="";if(t)if((r=t.getFormulaInformation(e,n,3))&&r.hasFormula&&!I.df(e,n,t)){if(i="="+r.formulaWithCulture,r.isDynamicArray)return""}else{if(r=t.getValue(e,n),S(r))return r;i=I.s0(t.getFormatter(e,n)||t.l0(e,n,"_autoFormatter"),r,t)||""}return i},I.h0=function(t,e){var n,e,i,r,n=t,e=h.Common.CultureManager.Fe(e).NumberFormat,i;return!!(e&&e.percentSymbol&&t)&&"object"!=typeof(n="object"==typeof t&&t.formatCached?t.formatCached:n)&&"string"==typeof n&&0<(r=Y.v0(n)).d0},I.m0=function(t){var e,n,t,e=I.Tt.msie||I.Tt.edge,n=e&&l.MSPointerEvent&&1<(navigator.msMaxTouchPoints||0);return t?n:(t=e&&l.PointerEvent&&1<(navigator.maxTouchPoints||0),n||t)},I.wt=function(t){return t&&t.richText&&0<t.richText.length?(t=t.text?t:I.g0(t)).text:t},I.g0=function(t){var e,n,i,r;if(t&&(e=t.richText)&&0<e.length){for(n=ye(t),t.converted=e=n.richText,i=[],r=0;r<e.length;r++)i.push(e[r].text||"");t.text=i.join("")}return t},I.St=function(t){return"string"==typeof t&&("="===t.charAt(0)||0<=t.indexOf("{{")&&0<=t.indexOf("}}"))},I.df=function(t,e,n,i){var r=n.isActualProtected();return i===b&&(i=3),!!r&&!!n.l0(t,e,"hidden",i)},I.p0=function(t,e,o,a){var s,u,t,s=t,u=e,t=function(t,e){var n,i,r,n=this;return n.hasOwnProperty("_ps")||(n._ps={}),i=n._ps,0===arguments.length?i[s]!==b?i[s]:u:(!1!==e&&a&&!a.call(n,t)||(r=i[s]!==b?i[s]:u)!==t&&(i[s]=t,!1!==e)&&o&&o.call(n,t,r),n)};return t.isDefault=function(t){return t===u},t},I.b0=function(t,e){var n={_ps:{}};return h.Common.lt.y0(t,function(t){ne(n,t,e)}),n},I.w0=function(t,e,n,i,r,o,a){for(var s,u,c,f,s=p(e,n),u=g(e,n),c=0,f=s;f<u&&(c+=i?o?t.getRowHeight(f,3):t.Gt(f,3,a):o?t.getColumnWidth(f,3):t.nn(f,3,a),!(r&&r<c));f++);return c},I.M0=function(t,e,n,i,r){for(var o,a,s,u,c,o=p(e,n),a=g(e,n),s=0,u=o;u<a&&(i?(c=t.C0(u),t.getViewportTopRow(c)<=u&&t.getViewportBottomRow(c)>=u&&(s+=t.Gt(u,3))):(c=t.S0(u),t.getViewportLeftColumn(c)<=u&&t.getViewportRightColumn(c)>=u&&(s+=t.nn(u,3))),!(r&&r<s));u++);return s},I.T0=function(t,e){var n,i,t,e,n=0,i=0;return t!==e&&(t=y(t).offset(),e=y(e).offset(),n=t.left-e.left,i=t.top-e.top),{A0:i,I0:n}},I.x0=function(t,e,n,i){var r,o,a,s,u,r=i||{};if(!t||"string"!=typeof t)return r.message=Q().Exp_SheetNameInvalid,!1;for(a=0;a<t.length;a++)if("*"===(o=t.charAt(a))||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return r.message=Q().Exp_SheetNameInvalid,!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return r.message=Q().Exp_SheetNameInvalid,!1;if(e)for(s=e.length,a=0;a<s;a++)if(n!==(u=e[a])&&t.toUpperCase()===u.name().toUpperCase())return r.message=Q().Exp_SheetNameConflict,!1;return!0},I.yi=function(t,e,n){var i,r,o;if(!t)return t;for(i=0,r=t.length,o=[];i<r;)t[i]===e?o[i]=n:o[i]=t[i],i++;return o.join("")},I.N0=function(){var t,e,n,i,t=I;return t.k0||(i="-10000px",(n=(e=$t("span")).style).visibility="hidden",n.top=i,n.left=i,n.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),v.body.insertBefore(e,m),t.k0=e),t.k0},I.vt=function(t,e,n){var i,r,o,o,i,i=I,r=i.D0;if(!e)if(r){if(o=(r=n?r.CJKFontCache:r)[t])return o}else r=i.D0={CJKFontCache:{}},n&&(r=r.CJKFontCache);return(o=i.N0()).style.font=I.yt(t),I.Tt&&I.Tt.safari&&(o.style.lineHeight="normal"),o.innerHTML=n?String.fromCharCode(20013):"H",i=(i=o.offsetHeight)||he(t,o.innerHTML),e||(r[t]=i),i},I._0=function(t){var e,n,i,e,e=I,n=e.E0;if(n){if(n[t])return n[t]}else n=e.E0={};return(e=e.N0()).style.font=t,e.innerHTML="H",(i={}).fontFamily=e.style.fontFamily,i.fontSize=e.style.fontSize,i.fontStyle=e.style.fontStyle,i.fontWeight=e.style.fontWeight,n[t]=i},I.bi=function(t,e){var n,i,n=I.N0();return n.style.font=I.yt(e),I.Tt&&I.Tt.safari&&(n.style.lineHeight="normal"),n.innerHTML=Z.j0(t||"H"),i=(i=n.offsetHeight)||he(e,n.innerHTML)},I.sHe=function(t,e){var n=I.N0();return n.style.font=I.yt(e),I.Tt&&I.Tt.safari&&(n.style.lineHeight="normal"),n.style.whiteSpace="pre",n.innerHTML=Z.j0(t),n.getBoundingClientRect().width},I.O0=function(t){var e,n,e,e=I;return 0<=t.indexOf(f.FallbackFontFamily)?t:(t=t.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(e=(n=e.N0()).style).font=t,e.fontFamily=[].concat(e.fontFamily.split(","),f.FallbackFontFamily.split(",")).join(","),e.font)},I.yt=function(t){var e,n,i,e=I;return t&&e.R0?(i=(n=(n=e.B0)||(e.B0={}))[t])||(n[t]=e.O0(t)):t},I.bt=function(t,e,n){void 0===n&&(n=!1),e&&(e=I.yt(e),t.font===e&&!0!==n||(t.font=e))},I.Mt=function(t,e,n){return!e||S(n)?0:(I.bt(t,e),t.measureText(n).width)},I.L0=function(){var t,e,t=I,e=t.k0;e&&(y(e).remove(),t.k0=b),t.D0=b,t.E0=b,I.F0&&(I.F0=b),t.B0=b},I.oi=function(t){var e,t,e=I.F0;return e=e||(I.F0=$t("div")),t=t.innerHTML,e.innerHTML=t,e.innerText},I.P0=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)},I.G0=function(t){t&&(t.U0(!0),t.initExpression(),t.H0())},I.z0=function(t){var e,n,i,r,o,e=0,n=0,i=t.length;for(0<i&&(e=t[0].row,n=t[0].col),r=1;r<i;r++)e>(o=t[r]).row&&(e=o.row),n>o.col&&(n=o.col);return{r:e=e<0?0:e,c:n=n<0?0:n}},I.V0=function(t){var t,t=typeof t===x&&"/"===t.charAt(0)?I.a2e(t):t;return t},I.a2e=function(t){var e,e,e=pt.test(t)?(e=t.match(pt),h.Common.ct.Y0(ut(e[1]))):mt.test(t)?(e=t.match(mt),new Date(ut(e[1]))):t;return e},I.Z0=function(t){var t,t=!S(t)&&h.Common.ct.W0(t)?h.Common.ct.Q0(t):t;return t},I.K0=function(t,e){for(var n,i,r,o,n=t.getImageData(e.x,e.y,e.width,e.height),i=n.data,r=0;r<i.length-4;r+=4)o=et((30*i[r]+59*i[r+1]+11*i[r+2]+50)/100),i[r]=o,i[r+1]=o,i[r+2]=o;t.putImageData(n,e.x,e.y)},I.J0=function(t,e,n){t.rowCount>e&&(t.rowCount=e),t.colCount>n&&(t.colCount=n)},I.X0=function(t,e,n,i){for(var r=n;r<n+i;r++)if(!S(t.getValue(e,r)))return!0;return!1},I.q0=function(t,e,n,i){for(var r=e;r<e+i;r++)if(!S(t.getValue(r,n)))return!0},I.$0=function(t){return!t||""===t},I.qi=function(t){if(I.$0(t))return 0;for(var e=0,n=0;n<t.length&&isNaN(parseInt(t[n],10));)n++;return(e=n<t.length?parseInt(t.substring(n),10):e)-1},I.$i=function(t){for(var e,n,i,r,o,e=0,n=t.length,i=0;i<n&&!(25<(o=(r=t[i].charCodeAt())-97))&&!((o=o<0?r-65:o)<0);i++)e=26*e+o+1;return--e},I.t1=function(t){var t=""+t;return"="===t.charAt(0)?t.substr(1):t},I.getFormulaString=function(t){return"string"==typeof t?(t="="===t[0]?t.substr(1):t,X(t)):t},I.vo=function(t,e){return!S(t)&&(e=e||/(&)|(<)|(>)|(")|(')/g).test(t)?typeof t===x?t.replace(e,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):""+t:t},I.Nfe=function(t,e){return(e=void 0!==e&&e)?t&&t.replace(/\%/g,"%25").replace(/\ /g,"%20").replace(/\#/g,"%23").replace(/\[/g,"%5b").replace(/\]/g,"%5d").replace(/\^/g,"%5e").replace(/\`/g,"%60").replace(/\{/g,"%7b").replace(/\}/g,"%7d").replace(/\&/g,"&amp;").replace(/\"/g,"&quot;"):t&&t.replace(/\&/g,"&amp;").replace(/\"/g,"&quot;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;")},I.kfe=function(t,e){return(e=void 0!==e&&e)?t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/%20/g," ").replace(/%23/g,"#").replace(/%5[bB]/g,"[").replace(/%5[cC]/g,"\\").replace(/%5[dD]/g,"]").replace(/%5[eE]/g,"^").replace(/%60/g,"`").replace(/%7[bB]/g,"{").replace(/%7[dD]/g,"}").replace(/%25/g,"%"):t&&t.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<")},I.n1=function(t){var e,n;return S(t)?t:!(e=typeof t===x)||-1===t.indexOf("&")?""+t:(n=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,(t=-1!==t.indexOf("&#")?t.replace(kt,se(10)).replace(Tt,se(16)):t).replace(n,function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))},I.e1=function(t,e,n){var i,r;if(t&&typeof t===x)for(i=0;i<n.length;i++)if((r=n[i])!==e&&(-1<t.indexOf(r+"!")||-1<t.indexOf("'"+r+"'!")))return!0;return!1},I.i1=function(t){var e,n,e;return"string"==typeof t&&(e=t.indexOf("/OADate(")+1,n=t.indexOf(")"),0!==e)&&e<n&&(e=parseFloat(t.substring(e+7,n)),isNaN(e)||(t=""+e)),t},I.r1=function(t){var e,n,i;if(!t)return null;if(e=-1!==(e=t).indexOf(n=",")?e.split(",")[0]:e){for(i=e.length-1;0<=i&&"/"!==e[i];)i--;'"'===(e=(e=0<=i?e.substring(i):e)&&"/#"===e.substring(0,2)?e.substring(2):e)[0]&&'"'===e[e.length-1]&&(e=e.substring(1,e.length-1))}return e},I.o1=function(t,e){for(var n,i,r,o,a,o,n=e.split("&"),i=0,r=n.length;i<r;i++){if(a=(o=n[i].split("."))[0],o=o[1],!t)return;t=I.xr(t,a,o)}return t},I.Hue=function(t,e){var n,i,r;if(t&&t.c_){for(i=t.c_,r=0;r<i.length&&!(n=I.xr(i[r],e));r++);return n}},I.xr=function(t,e,n){var i,r,o,a;if(!t||!t.c_)return b;for(n=n?+n:0,r=0,o=(i=t.c_).length;r<o;r++)if((a=i[r])&&a.n_===e){if(0===n)return a;n--}},I.u1=function(t,e){var n,i;if(t)for(n=t.c_||[],i=0;i<n.length;i++)if(n[i][e])return n[i][e]},I.s1=function(t,e){var n,i,r,o,o;if(!t||!t.c_)return b;for(i=0,r=(n=t.c_).length;i<r;i++){if((o=n[i])&&o.n_===e)return o;if(o=I.s1(o,e),!S(o))return o}},I.c1=function(t){return t&&t.c_?t.c_[0]:b},I.go=function(t,e){var n,i,r,o,a;if(!t||!t.c_)return b;for(i=[],r=0,o=(n=t.c_).length;r<o;r++)(a=n[r])&&a.n_===e&&i.push(a);return i},I.Pr=function(t,e){var n,i,r,o,o;if(t&&t.c_){for(n=[],i=0,r=e.length;i<r;i++)o=e[i],(o=I.go(t,o))&&0<o.length&&(n=n.concat(o));t.c_=n}},I.f1=function(t,e,n){var i,r,o;if(t&&e)for(n=n||e.name,i=0,r=t.length;i<r;i++)(o=t[i])&&o.n_===n&&(t[i]=e)},I.l1=function(){var t;return("{"+ae(8)+"-"+ae(4)+"-"+ae(4)+"-"+ae(4)+"-"+ae(12)+"}").toUpperCase()},I.isThemeColor=function(t){if(!t||"string"!=typeof t)return!1;var e;switch((t=t.toLowerCase())[0]){case"b":return 0===t.indexOf("background ");case"t":return 0===t.indexOf("text ");case"a":return 0===t.indexOf("accent ");case"h":return 0===t.indexOf("hyperlink");case"f":return 0===t.indexOf("followedhyperlink");default:return!1}},I.h1=function(t,e,n){if(t)return I.isThemeColor(t)?ue(t,e,n):le(t,n)},I.d1=function(t,e){var e;if(t)return"1"===t.auto?"#000000":t.theme!==b?ce(t,e):t.rgb?"#"+(e="number"==typeof(e=t.rgb)?e.toString(16):e).substring(2,e.length):t.indexed!==b?fe(t):void 0},I.hueToRGB=function(t,e,n){return n<0&&(n+=255),255<n&&(n-=255),n<42?t+((e-t)*n+21)/42:n<127?e:n<170?t+((e-t)*(170-n)+21)/42:t},I.v1=function(t,e,n){var i,r,o,a,e,i=0,r=0,o=0;return o=0===n?r=i=255*e/255|0:(a=void 0,e=2*e-(a=e<=127?(e*(255+n)+127)/255:e+n-(e*n+127)/255),i=parseInt(((255*I.hueToRGB(e,a,t+85)+127)/255).toString(),10),r=parseInt(((255*I.hueToRGB(e,a,t)+127)/255).toString(),10),parseInt(((255*I.hueToRGB(e,a,t-85)+127)/255).toString(),10)),{r:i=(i=0<i?i:0)<255?i:255,g:r=(r=0<r?r:0)<255?r:255,b:o=255<(o=0<o?o:0)?o:255,a:0}},I.m1=function(t){var t=yt[t];if(t!==b)return Mt.hexToARGB(t)},I.g1=function(t){if(!J(t))return"="===t[0]?t:"="+t},I.p1=function(t){return J(t)||t.length<=2?t:t.substr(1,t.length-2)},I.b1=function(t){if(!S(t))return"="===t[0]?t.substring(1,t.length):t},I.w1=function(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},I.C1=function(t){var e,n,i,r;if("string"==typeof t){if(e=/\[[^\]]+\]|@/,(n=t.split(/\'|\"/g))&&0<n.length)for(i=0;i<n.length;i++)if(r=n[i],i%2==0&&r.match(e))return!0;return!1}},I.S1=function(t,e){var n,i,r,e,o,t,n=e.row,i=e.col,r=e.rowCount,e=e.colCount,o=t.getRowCount(),t=t.getColumnCount();return-1===n&&(n=0,r=o),-1===i&&(i=0,e=t),Fe(n,i,r=o<n+r?o-n:r,e=t<i+e?t-i:e)},I.isInfinityNumberString=function(t){return"string"==typeof t&&(parseFloat(t)===Number.POSITIVE_INFINITY||parseFloat(t)===Number.NEGATIVE_INFINITY)},I.repeatString=function(t,e){var n="";if(!(!t||e<1||e>Number.POSITIVE_INFINITY))for(;e%2&&(n+=t),(e=Math.floor(e/2))&&(t+=t),e;);return n},I.toPlainString=function(t){var e,n;return(""+t).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(t,e,n,i,r){return+r<0?e+"0."+I.repeatString("0",1-+r-n.length-1)+n+i:e+n+i+I.repeatString("0",+r-i.length)})},I.jse=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},I.rfe=function(t,e){var n,i,r,o;if(t===m||e===m||"object"!=typeof t||"object"!=typeof e)return t===e;if(n=Object.keys(t),i=Object.keys(e),n.length!==i.length)return!1;for(r=0;r<n.length;r++)if(o=n[r],!I.rfe(t[o],e[o]))return!1;return!0},I.bme=function(t,e){for(var n,i,r,o,a,s,n=e.row,i=e.col,r=e.rowCount,o=e.colCount,a=n;a<n+r;a++)for(s=i;s<i+o;s++)if(t.getCell(a,s).locked())return!0;return!1},I.wme=function(t){for(var e,n,i,r,o,a,i,s,e=t.getSelections(),n=0;n<e.length;n++)if(r=-1===(i=e[n]).col?0:i.col,o=-1===i.row?0:i.row,a=-1===i.col?t.getColumnCount():i.colCount,i=-1===i.row?t.getRowCount():i.rowCount,s=I.bme(t,{col:r,row:o,colCount:a,rowCount:i}))return!0;return!1},I.ige=function(t){return 4<t?t=4:t<.25&&(t=.25),this.mge(t)},I.mge=function(t,e){return void 0===e&&(e=12),+parseFloat(t.toPrecision(e))},I.isEnablePasteSpecial=function(t){return!!t&&!t.NMi&&!(!t.ST()._S||t.ST().ES||t.isPasteShapes&&t.isPasteShapes()||t.isPasteFloatingObject&&t.isPasteFloatingObject())},I.pv=function(t,e){if(t||e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1}return!0},I.sTe=function(t){var e=[];return t.shapeLayers&&t.shapeLayers[0]&&t.shapeLayers[0].shapes.forEach(function(t){t.isSelected&&e.push(t.JVV.name())}),e},I.cTe=function(t){var e=[];return t.WL&&t.WL.QP().forEach(function(t){t.isSelected()&&e.push(t.name())}),e},I.Kg=function(t,e){for(var n,i,n=!1,i=t;i;){if("gcSpread"===y(i).attr("gcUIElement")){n=e.qc()!==i;break}i=i.parentElement}return n},I.setFillStyle=function(t,e,n,i,r,o,a){j.W.setFillStyle(t,e,n,i,r,o,a)},I.Zf=/[\u0600-\u06FF\u0750-\u077F]/,I.iHe=/[\u0590-\u05FF]|[\uFB1D-\uFB4F]/,I.vi=re,I.pi=I.device,I.Tt=(t=Me(A=navigator.userAgent),e={version:b,chrome:b,webkit:b,safari:b,mozilla:b,msie:b,metroMode:b,edge:b},t.browser&&(e[t.browser]=!0,e.version=t.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),(Qt=0<=A.indexOf("PhantomJS"))&&(e.safari=!1,e.chrome=!0),(Xt=(t=A.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(t)!==m)&&(e.mozilla=b,e.msie=!0),(t=/Edge\/\d+/.exec(A))!==m&&0<t.length&&(e.webkit=b,e.chrome=b,e.msie=!0,e.edge=!0,e.version=t[0].substr(t[0].indexOf("/")+1)),e.msie&&ke()&&(e.metroMode=!0),e),I.browser=I.Tt,I.En=$t,I.ai=te,I.T1=qt,I.pt=oe,I.R0=I.Qf(),I.Ct=function(t){return!S(t)&&(typeof t==dt||typeof t==q||t instanceof Date||L&&t instanceof L.CalcError)},G=I,f.util=G,f.mt=G,B=G.Mt,xe.A1=function(t){return!(xe.ai()!==t||!t.rt||!t.rt.I1)},xe.ai=function(){return l&&l.gcGlobal&&l.gcGlobal.activeElement},xe.N1=function(i){var r,o,a,t,e,t,n,s,u,c,f;function l(t){for(var e,n,e=0;e<=2;e++)(n=t.call(r,e))&&0!==n.width&&0!==n.height&&(i.k1=!0,o.D1(a,n))}if(i&&!xe.A1(i)&&i.parent&&i.parent.options.hideSelection)if(r=i.Fi(),o=i.Dn,a=o.J(),e=(t=i._1)&&t.isEnable(w.RowColumnStates.selected,!0),t=t&&t.isEnable(w.RowColumnStates.selected,!1),n=i.getSelections(),u=s=void 0,e||t){for(c=void 0,s=0;s<n.length;s++)f=n[s],c=c?c.union(f):f;c&&o.E1(c)}else{for(s=0;s<n.length;s++)f=n[s],0<=(u=i.j1(f)).width&&0<=u.height&&(u.x-=9,u.y-=9,u.width+=18,u.height+=30,o.O1(u));u=r.R1(),i.k1=!0,o.D1(a,u),l(r.B1),l(r.L1)}},xe.F1=function(t,e){var n=xe.ai();(l.gcGlobal.activeElement=t)===n||e||(n&&(n.endEdit(),xe.N1(n),n.G1)&&n.G1(),t&&t.Dn.E1())},xt=xe,f.hi=xt,n.prototype.U1=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",e="span."+t.split(T).join(ht);return u.H1?y(v).find(e).length<=0&&ee(u.H1):u.H1=Ge(t),u.H1},n.prototype.z1=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",e="span."+t.split(T).join(ht);return u.V1?y(v).find(e).length<=0&&ee(u.V1):u.V1=Ge(t),u.V1},n.prototype.Y1=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",e="span."+t.split(T).join(ht);return u.Z1?y(v).find(e).length<=0&&ee(u.Z1):u.Z1=Ge(t),u.Z1},n.prototype.W1=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",e="span."+t.split(T).join(ht);return u.K1?y(v).find(e).length<=0&&ee(u.K1):u.K1=Ge(t),u.K1},n.prototype.J1=function(){var t="gc-theme-version",e="gcDummyElement";return u.X1?y(v).find("#"+e).length<=0&&ee(u.X1):u.X1=Ge(t,e),u.X1},n.prototype.nl=function(){u.U1(),u.z1(),u.Y1(),u.W1()},n.prototype.Hc=function(){var r,t,o;function n(t){var e,n,i,i,e=xt.ai();if(e&&(n=u.el(t.target),i=e.il&&e.il.rl,r.wf.forEach(function(t){t&&t(e,n)}),!n||G.Kg(n,e)))if(e.ol(b,b,i))o&&(i=e.rt)&&i.al&&i.al(),xt.F1(m);else if(t.cancelable)return!1}function e(t){var e=t.pointerType;e!==t[gt]&&e!==vt||n(t)}(r=this).vf=0,Be(l,"keydown",Pe,!0),Be(l,"keyup",Re,!0),Be(l,"compositionstart",Ne,!0),Be(l,"selectstart",He,!0),t=G.pi(),o=t.ipad||t.iphone,G.browser.safari&&!o&&Be(l,"textInput",Ee,!0),G.m0()?(y(v).bind("MSPointerDown",e),y(v).bind("pointerdown",e)):y(v).bind("touchstart",n),Be(v,"mousedown",function(t){var e;!1===n(t)&&re(t)},!0),y(v).bind("DOMContentLoaded",function(){u.nl()})},n.prototype.el=function(t){for(var e,n,e=t;e&&"BODY"!==e.tagName&&typeof e.getAttribute==tt;){if(n=(n=e.getAttribute("gcUIElement"))||e.gcUIElement)return e;e=e.parentNode}return m},n.prototype.ul=function(t,e){var n,t,i,r,o,a,t,n=u.U1();return t===w.VisualState.highlight||t===w.VisualState.selected?n=u.W1():t===w.VisualState.hover&&(n=u.Y1()),t=n.className,y(n).removeClass(t).addClass(e),o=(i=Ie(n)).backgroundColor,a=i.backgroundImage,y(n).addClass(t),(t={backgroundColor:(i=Ie(n)).backgroundColor,backgroundImage:i.backgroundImage,color:i.color,zIndex:i.zIndex}).borderLeftColor=i.borderLeftColor,t.borderRightColor=i.borderRightColor,t.borderBottomColor=i.borderBottomColor,t.borderBottomWidth=i.borderBottomWidth,t.borderTopColor=i.borderTopColor,t.borderRightWidth=i.borderRightWidth,t.backgroundImage===a&&t.backgroundColor!==o&&(t.backgroundImage=b),y(n).removeClass(e),t},n.prototype.sl=function(t){var e,t,e=u.J1();return y(e).removeClass(e.className).addClass("gc-theme-version "+t),t=Ie(e),O({},t)},n.prototype.cl=function(t){var e,t,e=u.z1();return y(e).removeClass(e.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),t=Ie(e),O({},t)},n.prototype.ef=function(){var t;l.gcGlobal.vf++},n.prototype.cf=function(){var t=l.gcGlobal;t.vf--,t.vf<0&&(t.vf=0)},u=n.prototype,l.gcGlobal||(l.gcGlobal=new n),r.Ee=function(t){var e;return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},r.He=function(t,e){var n=r.Ee(t)+e,i=r.styleCache;return i[n]||(i[n]=u.ul(t,e)),i[n]},r.fl=function(t){var e=t,n=r.styleCache;return n[e]||(n[e]=u.sl(t)),n[e]},r.ll=function(t){var e="content"+t,n=r.styleCache;return n[e]||(n[e]=u.cl(t)),n[e]},r.m=function(t,e){var t=t.hl;return e=t&&t.getColor?t.getColor(e):e},r.dl=function(){r.styleCache={}},r.styleCache={},Bt=r,f.I=Bt,Ue.prototype.clone=function(){return new Ue(this.x,this.y)},f.Point=Ue,P.prototype.intersect=function(t,e,n,i){var r=this;return t<r.x+r.width&&r.x<t+n&&e<r.y+r.height&&r.y<e+i},P.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},P.prototype.contains=function(t,e,n){var i=this;return n?i.x<=t&&t<=i.x+i.width&&i.y<=e&&e<=i.y+i.height:i.x<t&&t<i.x+i.width&&i.y<e&&e<i.y+i.height},P.prototype.containsRect=function(t,e){return this.contains(t.x,t.y,e)&&this.contains(t.x+t.width,t.y+t.height,e)},P.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},P.prototype.getIntersect=function(t,e,n,i){var r=this,o=r.x,a=r.y,s=r.x+r.width,r=r.y+r.height,u,c=e,n=t+n,e=e+i,i=g(o,t),o=g(a,c),f,l,h,d,t=p(s,n)-i,a=p(r,e)-o;return 0<t&&0<a?new P(i,o,t,a):m},P.prototype.round=function(){var t=this;t.x=et(t.x),t.y=et(t.y),t.width=C(t.width),t.height=C(t.height)},P.prototype.clone=function(){var t=this;return new P(t.x,t.y,t.width,t.height)},f.Rect=P,R.prototype.intersect=function(t,e,n,i){var r=this;return(-1===t||-1===r.row||r.row<t+n&&t<r.row+r.rowCount)&&(-1===e||-1===r.col||r.col<e+i&&e<r.col+r.colCount)},R.prototype.getIntersect=function(t,e,n){var i,r,n,o,e,a,r,n,i,s,u,i=this;return t&&i.intersect(t.row,t.col,t.rowCount,t.colCount)?(r=-1===i.col?n-1:i.col+i.colCount-1,n=-1===t.col?n-1:t.col+t.colCount-1,o=-1===i.row?e-1:i.row+i.rowCount-1,e=-1===t.row?e-1:t.row+t.rowCount-1,a=g(i.col,t.col),r=p(r,n),n=g(i.row,t.row),i=p(o,e),new R(n,a,s=-1===n?-1:i-n+1,u=-1===a?-1:r-a+1)):m},R.prototype.contains=function(t,e,n,i){var r=this,o=arguments.length,a=!1;return 2!==o&&4!==o||(2===o&&(i=n=1),a=(-1===r.row||r.row<=t&&t+n<=r.row+r.rowCount)&&(-1===r.col||r.col<=e&&e+i<=r.col+r.colCount)),a},R.prototype.isInner=function(t,e,n,i){var r=this,o=arguments.length,a=!1;return 2!==o&&4!==o||(2===o&&(i=n=1),a=(-1===t||t<=r.row&&r.row+r.rowCount<=t+n)&&(-1===e||e<=r.col&&r.col+r.colCount<=e+i)),a},R.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},R.prototype.offset=function(t,e){var n,i,r,n=this,i=n.col,r=n.row;return-1!==i&&(i+=t),-1!==r&&(r+=e),new R(r,i,n.rowCount,n.colCount)},R.prototype.union=function(t){return _e(this,t)},R.prototype.equals=function(t){var e=this;return t instanceof R&&e.row===t.row&&e.col===t.col&&e.rowCount===t.rowCount&&e.colCount===t.colCount},R.prototype.toJSON=function(){var t=this;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}},R.prototype.fromJSON=function(t){var e=this;t&&(e.row=t.row,e.col=t.col,e.rowCount=t.rowCount,e.colCount=t.colCount)},Rt=R,f.Range=Rt,f.Ec=Fe,f.getUnionRange=_e,Ae.vl=function(t,e){if(t&&e){var t=t.currentTheme();if(t)return t.getColor(e)}return e},Ae.ml=function(t,e){var t;return t&&e?(t=t.currentTheme())?t.getFont(e):e:m},f.Pf=Ae,i.ValidationError="ValidationError",i.CellClick="CellClick",i.CellDoubleClick="CellDoubleClick",i.ColumnChanging="ColumnChanging",i.RowChanging="RowChanging",i.EnterCell="EnterCell",i.LeaveCell="LeaveCell",i.ValueChanged="ValueChanged",i.TopRowChanged="TopRowChanged",i.SheetChanging="SheetChanging",i.SheetChanged="SheetChanged",i.PivotTableChanged="PivotTableChanged",i.LeftColumnChanged="LeftColumnChanged",i.InvalidOperation="InvalidOperation",i.RangeFiltering="RangeFiltering",i.RangeFiltered="RangeFiltered",i.RangeFilterClearing="RangeFilterClearing",i.TableFilterClearing="TableFilterClearing",i.RangeFilterCleared="RangeFilterCleared",i.TableFilterCleared="TableFilterCleared",i.TableFiltering="TableFiltering",i.TableFiltered="TableFiltered",i.RangeSorting="RangeSorting",i.RangeSorted="RangeSorted",i.ClipboardChanging="ClipboardChanging",i.ClipboardChanged="ClipboardChanged",i.ClipboardPasting="ClipboardPasting",i.ClipboardPasted="ClipboardPasted",i.ColumnWidthChanging="ColumnWidthChanging",i.ColumnWidthChanged="ColumnWidthChanged",i.RowHeightChanging="RowHeightChanging",i.RowHeightChanged="RowHeightChanged",i.DragDropBlock="DragDropBlock",i.DragDropBlockCompleted="DragDropBlockCompleted",i.DragFillBlock="DragFillBlock",i.DragFillBlockCompleted="DragFillBlockCompleted",i.EditStarting="EditStarting",i.EditStarted="EditStarted",i.EditChange="EditChange",i.EditEnding="EditEnding",i.EditEnd="EditEnd",i.EditEnded="EditEnded",i.RangeGroupStateChanging="RangeGroupStateChanging",i.RangeGroupStateChanged="RangeGroupStateChanged",i.InternalSelectionChanging="InternalSelectionChanging",i.SelectionChanging="SelectionChanging",i.SelectionChanged="SelectionChanged",i.SheetTabClick="SheetTabClick",i.SheetTabDoubleClick="SheetTabDoubleClick",i.SheetNameChanging="SheetNameChanging",i.SheetNameChanged="SheetNameChanged",i.ViewZooming="ViewZooming",i.ViewZoomed="ViewZoomed",i.UserZooming="UserZooming",i.UserFormulaEntered="UserFormulaEntered",i.CellChanged="CellChanged",i.ColumnChanged="ColumnChanged",i.RowChanged="RowChanged",i.ActiveSheetChanging="ActiveSheetChanging",i.ActiveSheetChanged="ActiveSheetChanged",i.CalculationProgress=L&&L.CALC_PROGRESS_EVENT,i.SparklineChanged="SparklineChanged",i.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",i.RangeChanged="RangeChanged",i.ButtonClicked="ButtonClicked",i.EditorStatusChanged="EditorStatusChanged",i.FloatingObjectChanged="FloatingObjectChanged",i.DrawingElementZIndexChanged="DrawingElementZIndexChanged",i.ProgressChanged="ProgressChanged",i.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",i.ShapeChanged="ShapeChanged",i.ShapeSelectionChanged="ShapeSelectionChanged",i.FormControlButtonClicked="FormControlButtonClicked",i.FormControlValueChanged="FormControlValueChanged",i.PictureChanged="PictureChanged",i.FloatingObjectRemoving="FloatingObjectRemoving",i.ShapeRemoving="ShapeRemoving",i.FloatingObjectRemoved="FloatingObjectRemoved",i.ShapeRemoved="ShapeRemoved",i.PictureSelectionChanged="PictureSelectionChanged",i.FloatingObjectLoaded="FloatingObjectLoaded",i.TouchToolStripOpening="TouchToolStripOpening",i.CommentChanged="CommentChanged",i.CommentRemoving="CommentRemoving",i.CommentRemoved="CommentRemoved",i.SlicerChanged="SlicerChanged",i.BeforeDragDrop="BeforeDragDrop",i.ActiveSheetChangingInternal="ActiveSheetChangingInternal",i.ActiveSheetChangedInternal="ActiveSheetChangedInternal",i.EnterCellInternal="EnterCellInternal",i.SheetOptionsChangedInternal="SheetOptionsChangedInternal",i.WorkbookOptionsChangedInternal="WorkbookOptionsChangedInternal",i.RangeChangedInternal="RangeChangedInternal",i.CustomNameChangedInternal="CustomNameChangedInternal",i.FormulaTextboxEditStarted="FormulaTextboxEditStarted",i.FormulaTextboxEditEnded="FormulaTextboxEditEnded",i.SheetMoving="SheetMoving",i.SheetMoved="SheetMoved",i.DragMerging="DragMerging",i.DragMerged="DragMerged",i.ChartClicked="ChartClicked",i.FloatingElementSelected="FloatingElementSelected",i.BeforePrint="BeforePrint",i.TableResizing="TableResizing",i.TableResized="TableResized",i.TableRowsChanged="TableRowsChanged",i.TableColumnsChanged="TableColumnsChanged",i.DropdownSpreadMouseClick="DropdownSpreadMouseClick",i.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",i.PasteEnd="PasteEnd",i.WorkbookUndo="WorkbookUndo",i.WorkbookRedo="WorkbookRedo",i.TableSheetColHeaderRowCountChanged="TableSheetColHeaderRowCountChanged",i.TableSheetGroupFieldSetting="TableSheetGroupFieldSetting",i.SheetTabAllSheetsListContextMenuOpening="SheetTabAllSheetsListContextMenuOpening",i.SheetTabAllSheetsListContextMenuOpened="SheetTabAllSheetsListContextMenuOpened",i.ReportSheetDataChanging="ReportSheetDataChanging",i.ReportSheetDataChanged="ReportSheetDataChanged",i.ReportSheetRecordsSubmitting="ReportSheetRecordsSubmitting",i.ReportSheetRecordsSubmitted="ReportSheetRecordsSubmitted",i.ActiveCellChanged="ActiveCellChanged",i.WorksheetDataChanged="WorksheetDataChanged",i.ReportSheetModeChanged="ReportSheetModeChanged",i.ReportPaginationSettingChanged="ReportPaginationSettingChanged",i.ReportPaginationPageChanged="ReportPaginationPageChanged",i.DataFetchCompleted="DataFetchCompleted",f.Events=i,o.prototype.L0=function(){this.Mf=m},o.prototype.gl=function(t,e,n){var i,t,e,i=this.pl,t=t<<4+e;return i?((e=i[t])||(e=n(),i[t]=e),e):n()},o.prototype.yl=function(t,e){var n,n,n=this.wl;return n&&(n=n[t])?n[e]:m},o.prototype.Ml=function(t,e,n,i){var r,o,r=this.wl;r&&(r[t]||(r[t]={}),(o=r[t])[e]={d:n,i:i})},o.prototype.$t=function(t,e,n,i,r){var o,a,s,u,u,a=(o=this).Mf;if(n===b&&(n=3),!(s=W((r=void 0===r?{}:r).rowSpacingIndex))){if(u=a.t0(t,e,n),a.options.showFormulas&&G.df(t,e,a,n))return"";if(!S(u))return u;if(u=r.style,!S(u)&&G.St(u.formatter))return Ut.Cl(a,u,o.Sl(t,e,n,0),{},{row:t,col:e,sheet:a})}return o.Sl(t,e,n,i,r)},o.prototype.Sl=function(t,e,n,i,r){var o,a,o,s,o,s;return void 0===r&&(r={}),a=(o=this).Mf,o=o.Tl,n===b&&(n=3),o?((s=o[n])||(o[n]=s={}),(o=s[t])||(s[t]=o={}),(s=o[e])===b&&(s=a.$t(t,e,n,i),o[e]=s),s):a.$t(t,e,n,i,r)},o.prototype.JVe=function(n,i){var t,r,t,e,o,t,t=this,r=t.Mf,t=t.KVe;return i===b&&(i=3),e=function(){var t,e,t=r.getColumnVisible(n,i),e;return 0<r.getColumnWidth(n,i)&&t},t?((o=t[i])||(t[i]=o={}),(t=o[n])||(t=e(),o[n]=t),t):e()},o.prototype.qt=function(t,e,n,i,r){var o,a,o,s,o,s;return void 0===r&&(r={}),a=(o=this).Mf,o=o.Al,n===b&&(n=3),o?((s=o[n])||(o[n]=s={}),(o=s[t])||(s[t]=o={}),(s=o[e])||(r.notClone=!0,s=a.Il(t,e,n,!1,r),o[e]=s),s.clone(!0)):(r.notClone=!1,a.Il(t,e,n,!1,r))},o.prototype.o2e=function(t,e,n){var i,r,i,o,i,o,i=this,r=i.Mf,i=i.Al;return n===b&&(n=3),i?((o=i[n])||(i[n]=o={}),(i=o[t])||(o[t]=i={}),(o=i[e])||(o=r.o2e(t,e,n,!1,{notClone:!0}),i[e]=o),o.clone(!0)):r.o2e(t,e,n,!1,{notClone:!1})},o.prototype.Gt=function(t,e){var n,i,n,r,n;return void 0===e&&(e=w.SheetArea.viewport),i=(n=this).Mf,(n=n.xl)?(n=(r=(r=n[e])===b?n[e]={}:r)[t])===b?r[t]=i.Gt(t,e):n:i.Gt(t,e)},o.prototype.Kt=function(t,e){var n,i,n,r,n;return void 0===e&&(e=w.SheetArea.viewport),i=(n=this).Mf,(n=n.Nl)?(n=(r=(r=n[e])===b?n[e]={}:r)[t])===b?r[t]=i.nn(t,e):n:i.nn(t,e)},o.prototype.kl=function(t){var e=this;return e.Tl?(e.Dl||(e.Dl=t()),e.Dl):t()},o.prototype._l=function(t){var e=this;return e.Tl?(e.El||(e.El=t()),e.El):t()},o.prototype.jl=function(){var t=this;t.Ol=!0,t.pl={},t.wl={},t.Tl={},t.Al={},t.KVe={},t.xl={},t.Nl={}},o.prototype.Rl=function(){this.Ol=!1},o.prototype.Bl=function(){var t=this;t.Ol=!1,t.pl=m,t.wl=m,t.Tl=m,t.Al=m,t.KVe=m,t.Nl=m,t.xl=m,t.Dl=m,t.El=m},f.Ff=o,N.Ll=function(t,e,n,i,r){var o,a,s,u;if(N.Fl=!0,(o=t.tables)&&o.Pl(e,n,i-e+1,r-n+1))for(a=-1,s=N.Gl=[],u=0;u<=i;u++)t.getRowVisible(u)?s[u]=++a:s[u]=-1},N.dl=function(){N.Gl=m,N.Fl=!1},N.Ue=function(t){var e=N.Ul;return e[t]||(e[t]=d?new d(t):m),e[t]},N.Re=function(t,e,n){var i,r,i,o,o,a,o,e,i,i=N.Hl,r=t+"_"+typeof t;return d?(i[e]||(i[e]={}),(o=(i=i[e])[r])?(n&&(n.conditionalForeColor=n.value=o.color,n.content=K(o.content)),o.text):((o=N.Ul)[e]||(o[e]=new d(e)),e=(a=o[e]).format(t,o={}),(i=i[r]={}).text=e,i.color=o.conditionalForeColor,i.content=o.content,n&&(n.conditionalForeColor=n.value=o.conditionalForeColor,n.content=K(o.content)),e)):t.toString()},N.Cl=function(t,e,n,i,r){var t,e;return n&&"SparklineExValue"===n.typeName?"":(t=e.cellType||t.$f(),e=e.formatter||e._autoFormatter,t.format(n,e,i,r))},N.zl=function(){N.Ul={},N.Hl={}},N.Fl=!1,N.Ul={},N.Hl={},N.Gl=[],Ut=N,f.Be=Ut,De.Vl=function(t,e,n){var i=Le(t);i.scaleX=e,i.scaleY=n,i.translateX=i.orgTranslateX*e,i.translateY=i.orgTranslateY*n,t.setTransform(i.scaleX,i.skewX,i.skewY,i.scaleY,i.translateX,i.translateY)},De.Yl=function(t,e,n){var i=Le(t);i.orgTranslateX+=e,i.orgTranslateY+=n,i.translateX=i.orgTranslateX*i.scaleX,i.translateY=i.orgTranslateY*i.scaleY,t.setTransform(i.scaleX,i.skewX,i.skewY,i.scaleY,i.translateX,i.translateY)},De.d5=function(t){var e=null==t?void 0:t.getContext("2d");e&&(e.clearRect(0,0,t.width,t.height),t.width=1,t.height=1)},f.Lf=A=De,Ft=A,E.Zl=function(){var t,e,e,t,n,t=l.screen,e=t.deviceXDPI,e=l.devicePixelRatio||(e?e/t.logicalXDPI:1),t=20*e,n=M(t);return.82<n-t?n/20:M(100*e)/100},E.Wl=function(t,e,n){var i,r,o,a,s,u,c,f,l,i=E;if(je(t,1),Oe(t,1),(1!==(r=E.Zl())||1!==i.dpr)&&(i.dpr=r,o=e||n&&n.parent)){for(a=i.Ql,s=void 0,u=0;u<a.length;u++)if(o===a[u].workbook){s=a[u];break}if(s||a.push(s={workbook:o,sheets:[],canvases:[]}),e)s.canvases.push(t);else{for(c=void 0,f=s.sheets,l=0;l<f.length;l++)if(f[l].sheet===n){c=f[l];break}c||f.push(c={sheet:n,canvases:[]}),c.canvases.push(t)}}},E.Kl=function(t){return t&&t.Sf||1},E.Jl=function(t){return t&&t.Tf||1},E.Xl=function(t){return t.Af},E.ql=function(t){return t.If},E.$l=function(t,e,n){var i,r,o,i,a,r,e,i=E,r=i.dpr,o=i.Kl(t),i=i.Jl(t);Ve(t,e),Ye(t,n),1===r&&1===o&&1===i?(t.width=e,t.height=n):(a=t.getContext("2d"),Ft.Vl(a,1,1),G.Tt.mozilla?(t.width=C(e*r),t.height=C(n*r)):(t.width=M(e*r),t.height=M(n*r)),t.style.width=e+lt,t.style.height=n+lt,r=t.width/e,e=t.height/n,r===o&&e===i||(je(t,r),Oe(t,e)),Ft.Vl(a,r,e))},E.th=function(t,e){for(var n,i,r,o,a,s,u,n=E.Ql,i=t.parent,a=0;a<n.length;a++)if(!i||n[a].workbook===i)for(r=n[a].sheets,s=0;s<r.length;s++)if(r[s].sheet===t){for(o=r[s].canvases,u=0;u<o.length;u++)if(o[u]===e){o.splice(u,1);break}break}},E.nh=function(t,e){for(var n,i,r,o,n=E.Ql,r=0;r<n.length;r++)if(n[r].workbook===t)for(i=n[r].canvases,o=0;o<i.length;o++)if(i[o]===e){i.splice(o,1);break}},E.eh=function(t){for(var e,n,i,r,o,e=E.Ql,n=t.parent,r=0;r<e.length;r++)if(!n||e[r].workbook===n){for(i=e[r].sheets,o=0;o<i.length;o++)i[o].sheet===t&&i.splice(o,1);return}},E.ih=function(t){for(var e,n,e=E.Ql,n=0;n<e.length;n++)if(e[n].workbook===t)return void e.splice(n,1)},E.rh=function(){var t,e,n,i,r,o,a,s,u,c,t=E,e=t.Zl();if(t.dpr!==e)for(n=t.Ql,a=o=r=i=void 0,t.dpr=e,s=0;s<n.length;s++){for(o=(r=n[s]).canvases,i=r.sheets,u=0;u<i.length;u++)o=o.concat(i[u].canvases);for(c=0;c<o.length;c++)a=o[c],t.$l(a,t.Xl(a),t.ql(a))}},E.dpr=1,E.Ql=[],f.Bf=E,f.zt=ze,f.r2e=We,H.un=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,o=[];if(t&&0!==t.length&&!isNaN(e)&&(a=r||Ke())){if(G.bt(a,n),s=G.vt(n),e<=0){for(u=-1,c=!0,f=0;f<t.length;f++)(l=t.charAt(f))===T||c?l!==T&&c&&(u=i?s:B(a,a.font,l),c=!1):u=p(u,i?s:B(a,a.font,l));if((e=u)<=0)return[t]}for(h=t.split(/\r\n|\r|\n/),d=0;d<h.length;d++)if(v=Xe(h[d],e,i,s,a))if(0===v.length)o.push("");else for(g=0;g<v.length;g++)o.push(v[g])}return o},H.oh=function(t,e,n,i,r){var o,a,s,u,c,o=[];if(0!==e.length)if(i)o=H.un(e,r,n,!0);else for(a=e.split(/\r\n|\r|\n/),s=0;s<a.length;s++){for(u=[],c=0;c<a[s].length;c++)u.push(a[s][c]);o.push(u)}return o},H.Ht=function(t,e,n,i,r,o){var a,s,u,c,o,f,l,h,a=[];if(0!==t.length&&(s=o||Ke())){if(e<=0&&(e=en(s,i,n,r))<=0){for(c=[],u=0;u<i.length;u++)S(i[u].text)||c.push({textLength:H.ah([i[u]],n,1,r,!1,s),text:i[u].text,textInfos:[i[u]]});return c}for(o=H.uh(t),f=H.Vt(o,H.Yt(i)),u=0;u<f.length;u++)if(l=qe(f[u],e,n,r,s))if(0===l.length)a.push("");else for(h=0;h<l.length;h++)a.push(l[h])}return a},H.uh=function(t){for(var e,n,i,e=[],n=t.split(/\r\n|\r|\n/),i=0;i<n.length;i++)e.push(ze(n[i]));return e},H.Vt=function(t,e){for(var n,i,r,o,a,s,u,c,f,n=[],i=0,r=0,o=0;o<t.length;o++){for(a=[],s=0;s<t[o].length&&i<e.length;s++)if((u=t[o][s]).length<=e[i].text.length-r)a.push([{style:e[i].style,text:u}]),r+=u.length;else{for((c=[]).push({style:e[i].style,text:e[i].text.substring(r)}),f=u.length-(e[i].text.length-r),i++;i<e.length;i++){if(f<e[i].text.length){c.push({style:e[i].style,text:u.substring(u.length-f)}),r=f;break}if(f===e[i].text.length){c.push({style:e[i].style,text:u.substring(u.length-f)}),i++,r=0;break}c.push({style:e[i].style,text:e[i].text}),f-=e[i].text.length}a.push(c)}n.push(a)}return n},H.Wt=function(t,e,n,i){var i,e,i=i||Ke();return i?(e&&G.bt(i,e),e=n?We(t):t,B(i,i.font,e)):0},H.Yt=function(t){for(var e,n,e=[],n=0;n<t.length;n++)S(t[n].text)||e.push({style:t[n].style,text:t[n].text&&t[n].text.replace(/\r\n|\r|\n/g,"")});return e},H.ah=function(t,e,n,i,r,o){var a,s,u,c,f,l,a=o||Ke();if(!a)return 0;for(u=s=0;u<t.length;u++)c=void 0,c=t[u].style&&t[u].style.font?t[u].style.font:e,G.bt(a,c),f="",f=u===t.length-1&&r?We(t[u].text):t[u].text,l=0,i?l=G.vt(c)*f.length/n:S(t[u].text)||(l=B(a,a.font,t[u].text)/n),t[u].style&&t[u].style.vertAlign&&(l*=ft),s+=l;return s},H.Zt=function(t,e,n,i,r,o,a,s){var u,c,f,r,a,l,h,u=0,c=G.vt(o),f,r=H.un(r,(a-4-c*i)/n,o),a=r.length,l,h=c*n;return u=(a-1)*(c/n),u=(u+=H.Wt(r[0],o)/2*i+h)+(H.Wt(r[a-1],o)/2*i+h)},H.tt=We,H.J=Ke,H.Gge=function(t){for(var e,n,i,r,o,a,s,e=[],n,i,r=0,o=0,a=h.Common.CultureManager.Fe().tCe(t);o<a.length;o++)" "===(s=a[o])?r++:(e.push({word:s,prefixSpaceCount:r}),r=0);return e},At=H,f.q=At,f.$e=Lt=function(f,l){(l=void 0===l?!1:l)&&(f.s2e=function(t){var e;f.c2e=null!=(e=f.registerCallBack)?e:[],f.c2e.push(t)},f.f2e=function(t){var e,e;f.c2e=null!=(e=f.registerCallBack)?e:[],-1!==(e=f.c2e.indexOf(t))&&f.c2e.splice(e,1)}),f.ch=function(t,e){var t,n,i;for(f.fh||(f.fh=[]),f.lh={},n=f.fh,e.name=t,e.priority=e.priority||5e3,i=0;;i++)if(i>=n.length||e.priority>n[i].priority){n.splice(i,0,e);break}l&&(null!=(t=f.c2e)?t:[]).forEach(function(t){t()})},f.et=function(t,e,n,i){var r,r,o,a,s,u,c,o=f.fh;if(o){if(t&&!t.lh&&(t.lh={}),!(a=l&&t?null==(r=t.lh)?void 0:r[e]:null==(r=f.lh)?void 0:r[e]))for(a=l&&t?t.lh[e]=[]:f.lh[e]=[],s=0;s<o.length;s++)(u=o[s])[e]&&(c=!u.isValid||u.isValid.call(t,e))&&a.push(u[e]);for(s=0;s<a.length&&(a[s].call(t,n),!i||!i());s++);}}},nn.prototype.get=function(t,e){var t=this.Nf[t];return t?t[e]:b},nn.prototype.set=function(t,e,n){var i,i;(i=(i=this.Nf[t])||(this.Nf[t]={}))[e]=n},f.Rf=nn,rn.processBackspaceAndLeftArrowKeyEvent=function(t,e){var n,i,r,o,a,s,s,o,u,c,s,f,o,u,c,s,i,n=l.getSelection();if(!(n.rangeCount<=0))if(i=n.anchorNode,r=n.anchorOffset,o=t.target,G.browser.msie&&!G.browser.edge&&e&&un(i,r,o))s=(a=parseFloat(G.browser.version)<10?Sn(o):o.innerText).slice(0,-1),o.innerHTML=s.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),n.selectAllChildren(o),0<n.rangeCount&&n.collapseToEnd(),re(t);else if(o=(s=n.getRangeAt(0)).startContainer,u=s.endContainer,c=s.startOffset,s=s.endOffset,f=o===u&&c===s){if((o=mn(i,r))&&o.zeroWidthCharNode){if(u=o.zeroWidthCharNode,c=o.previousTextNode,e)if(cn(u))u.parentNode.removeChild(u);else{if(u.parentNode.removeChild(u.previousSibling),fn(c))return void re(t);(s=n.getRangeAt(0)).setStart(u,0),s.setEnd(u,1),s.deleteContents()}i=v.createRange(),an(c)?(i.setStart(c,1),i.setEnd(c,1)):(i.setStartAfter(c),i.setEndAfter(c)),i.collapse(!1),n.removeAllRanges(),n.addRange(i),re(t)}}else e&&on(n)},rn.processDeleteAndRightArrowKeyEvent=function(t,e){var n,i,r,o,a,i,s,r,o,a,i,r,i,u,n=l.getSelection();n.rangeCount<=0||(r=(i=n.getRangeAt(0)).startContainer,o=i.endContainer,a=i.startOffset,i=i.endOffset,(s=r===o&&a===i)?(r=pn(n))&&r.node&&(i=mn(o=r.node,a=r.offset),e?(r=n.getRangeAt(0),1===a?(r.setStart(o,0),r.setEnd(o,1),o.parentNode.removeChild(o.previousSibling),r.deleteContents(),i&&i.previousTextNode&&(i=i.previousTextNode,u=v.createRange(),an(i)?(u.setStart(i,1),u.setEnd(i,1)):(u.setStartAfter(i),u.setEndAfter(i)),u.collapse(!1),n.removeAllRanges(),n.addRange(u))):0===a&&(r.setStart(o,1),r.setEnd(o,2),r.deleteContents())):((u=v.createRange()).setStart(o,a),u.setEnd(o,a),u.collapse(!1),n.removeAllRanges(),n.addRange(u)),re(t)):e&&on(n))},f.di=rn,f.Of={touch:!1},f.jf=Mn,f.Ef=kn,f._f=Tn,f.hCe=xn,f.Df=Gn,f.kf=In,Pn.hh=function(t){var e,n,i;if(!S(t))return n=t.row+t.rowCount-1,i=t.col+t.colCount-1,(e={}).minRow=t.row,e.minCol=t.col,e.maxRow=n,e.maxCol=i,e},Pn.vh=function(t,e){if(S(e)||S(e.minRow))return t;t.minRow=S(t.minRow)?e.minRow:p(t.minRow,e.minRow),t.minCol=S(t.minCol)?e.minCol:p(t.minCol,e.minCol),t.maxRow=S(t.maxRow)?e.maxRow:g(t.maxRow,e.maxRow),t.maxCol=S(t.maxCol)?e.maxCol:g(t.maxCol,e.maxCol)},Pn.updateUsedRangeByData=function(t,e,n,i,r){i===r||!S(i)&&!S(r)||S(t)||(!S(i)&&S(r)&&t.removeRowAndColInfo(e,n),S(i)&&!S(r)&&t.addRowAndColInfo(e,n))},f.UsedRangeUtil=Pn,Rn.prototype.getRowUsedRange=function(){var t,e,e,n,i,r,o,t,e=this.wholeRows,e=Object.keys(e);return 0<e.length&&(n=+e[0],r=+e[e.length-1],o=1/(i=0)),{minRow:n,minCol:i,maxRow:r,maxCol:o}},Rn.prototype.getColUsedRange=function(){var t,e,e,n,i,r,o,t,e=this.wholeCols,e=Object.keys(e);return 0<e.length&&(i=+e[0],o=+e[e.length-1],r=1/(n=0)),{minRow:n,minCol:i,maxRow:r,maxCol:o}},Rn.prototype.getUsedRange=function(){for(var t,e,n,i,r,o,a,s,u,c,f,l,h,t=this,e=t.rowInfo,n=t.colInfo,s=e.length-1,u=n.length-1,c=0;c<=s;c++)if(e[c]){i=c;break}for(f=s;0<=f;f--)if(e[f]){o=f;break}for(l=0;l<=u;l++)if(n[l]){r=l;break}for(h=u;0<=h;h--)if(n[h]){a=h;break}return{minRow:i,minCol:r,maxRow:o,maxCol:a}},Rn.prototype.addRowAndColInfo=function(t,e){var n=this,i=n.rowInfo,r=n.colInfo;S(t)||S(e)||-1===t&&-1===e||(-1===t?n.wholeCols[e]=!0:-1===e?n.wholeRows[t]=!0:(S(i[t])?i[t]=1:i[t]++,S(r[e])?r[e]=1:r[e]++))},Rn.prototype.removeRowAndColInfo=function(t,e){var n=this,i=n.rowInfo,r=n.colInfo;-1===t&&-1===e||(-1===t?delete n.wholeCols[e]:-1===e?delete n.wholeRows[t]:i[t]&&r[e]&&(i[t]--,r[e]--))},Rn.prototype.addHeadInfo=function(t,e,n){var i,r,o,e,t,i=this,r=n?i.rowInfo:i.colInfo,o=[];o.length=e,e=r.slice(0,t),t=r.slice(t),r=e.concat(o).concat(t),n?i.rowInfo=r:i.colInfo=r},Rn.prototype.removeHeadInfo=function(t,e,n){var i=this,r;(n?i.rowInfo:i.colInfo).splice(t,e)},Rn.prototype.dispose=function(){var t=this;t.rowInfo=b,t.colInfo=b,t.wholeCols=b,t.wholeRows=b},f.BaseUsedRange=Rn,f.NUMBER_ARRAY=["0","1","2","3","4","5","6","7","8","9"],Nn.prototype.getTextIndex=function(t){var e,n,i,r,o,a,e=this;if(t.richText)if((i=t.text)===b&&(i=t.text=G.g0(t).text),(n=e.mh[i])===b||e.gh[i]===b)n=e.ph.push(t)-1,e.mh[i]=n,e.gh[i]=[],e.gh[i].push({i:n,v:t});else{for(r=void 0,o=0,a=e.gh[i].length;o<a;o++)if(e.gh[i][o]&&e.gh[i][o].v===t){r=o;break}0<=r?n=e.gh[i][r].i:(n=e.ph.push(t)-1,e.gh[i].push({i:n,v:t}))}else(n=e.mh[t])!==b&&!e.gh[t]||(n=e.ph.push(t)-1,e.mh[t]=n);return n},Nn.prototype.getText=function(t){var e=this.ph[t];return S(e)?t:e},Nn.prototype.getCount=function(){return this.bh},Nn.prototype.reset=function(){var t=this;t.ph=[],t.mh={},t.gh={},t.bh=0},Nn.prototype.rebuildSSTDict=function(){var i=this;i.ph.forEach(function(t,e){var n;t.richText?((n=t.text)===b&&(n=t.text=G.g0(t).text),i.mh[n]=e):i.mh[t]=e})},Nn.prototype.yh=function(t){var e;t&&0<t.length&&((e=this).reset(),e.ph=t)},Nn.prototype.wh=function(){return this.ph},f.SharedStrings=Nn,Kt={8:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":6,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:4,"Arabic Typesetting":4,Arial:6,"Arial Black":7,"Arial Narrow":5,"Arial Nova":6,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":6,"Arial Rounded MT Bold":7,"Baskerville Old Face":5,Batang:6,BatangChe:6,"Bauhaus 93":6,"Bell MT":6,Bembo:5,"Berlin Sans FB":7,"Berlin Sans FB Demi":7,"Bernard MT Condensed":5,"Blackadder ITC":4,"Bodoni MT":5,"Bodoni MT Black":7,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":8,"Bradley Hand ITC":7,"Britannic Bold":7,Broadway:7,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":5,"Calisto MT":6,Cambria:6,"Cambria Math":6,Candara:6,Castellar:8,Centaur:5,Century:6,"Century Gothic":6,"Century Schoolbook":6,Chiller:5,"Colonna MT":6,"Comic Sans MS":7,Consolas:6,Constantia:6,"Cooper Black":7,"Copperplate Gothic Bold":8,"Copperplate Gothic Light":8,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:3,DokChampa:6,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":5,Elephant:8,"Engravers MT":7,"Eras Bold ITC":7,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":6,EucrosiaUPC:4,Euphemia:6,"Expo M":10,FangSong:6,"Felix Titling":6,"Footlight MT Light":6,Forte:6,"Franklin Gothic Book":6,"Franklin Gothic Demi":6,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":6,"Franklin Gothic Medium":6,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":4,"French Script MT":4,Gabriola:4,Gadugi:6,Garamond:5,Gautami:7,Georgia:8,"Georgia Pro":6,"Georgia Pro Black":8,"Georgia Pro Cond":6,"Georgia Pro Cond Black":7,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":6,"Georgia Pro Light":6,"Georgia Pro Semibold":7,Gigi:5,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":3,"Gill Sans Nova Cond Ultra Bold":6,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":9,"Gill Sans Ultra Bold":9,"Gill Sans Ultra Bold Condensed":6,Gisha:6,"Gloucester MT Extra Condensed":4,"Goudy Old Style":6,"Goudy Stout":9,Grotesque:5,"Grotesque Light":5,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":6,Haettenschweiler:5,"Harlow Solid Italic":5,Harrington:6,"Headline R":8,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:8,HGMinchoB:7,HGMinchoE:7,HGPGothicE:7,HGPGothicM:7,HGPGyoshotai:6,HGPKyokashotai:6,HGPMinchoB:6,HGPMinchoE:7,HGPSoeiKakugothicUB:8,HGPSoeiKakupoptai:8,HGPSoeiPresenceEB:7,HGSeikaishotaiPRO:7,HGSGothicE:6,HGSGothicM:6,HGSGyoshotai:5,HGSKyokashotai:5,HGSMinchoB:6,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:7,HGSSoeiKakupoptai:7,HGSSoeiPresenceEB:6,"High Tower Text":5,"HYGothic-Extra":7,"HYGothic-Medium":6,"HYGraphic-Medium":6,"HYGungSo-Bold":6,"HYHeadLine-Medium":6,"HYMyeongJo-Extra":7,"HYPMokGak-Bold":8,"HYPost-Light":7,"HYPost-Medium":8,"HYShortSamul-Medium":4,"HYSinMyeongJo-Medium":7,Impact:6,"Imprint MT Shadow":6,"Informal Roman":6,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":6,Jokerman:8,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":6,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":7,"Lucida Console":8,"Lucida Fax":7,"Lucida Handwriting":8,"Lucida Sans":7,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":8,"Magic R":7,Magneto:8,"Maiandra GD":7,"Malgun Gothic":6,"Malgun Gothic Semilight":7,Mangal:7,Marlett:12,"Matura MT Script Capitals":8,Meiryo:7,"Meiryo UI":7,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":7,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":7,"Microsoft New Tai Lue":6,"Microsoft PhagsPa":6,"Microsoft Sans Serif":7,"Microsoft Tai Le":6,"Microsoft Uighur":4,"Microsoft YaHei Light":7,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":7,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":7,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":6,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":8,"MS Reference Specialty":14,"MS UI Gothic":7,"MT Extra":12,"MV Boli":9,"Myanmar Text":6,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":7,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":6,"Nirmala UI Semilight":7,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":4,"Palatino Linotype":6,Papyrus:7,Parchment:3,Perpetua:5,"Perpetua Titling MT":7,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:6,"PMingLiU-ExtB":6,"Poor Richard":7,Pristina:6,"Pyunji R":6,Raavi:7,"Rage Italic":7,Ravie:11,Rockwell:6,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":4,"Segoe Print":8,"Segoe Script":8,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":6,"Segoe UI Semilight":6,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":6,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":6,"Sitka Small":8,"Sitka Subheading":6,"Sitka Text":7,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:6,Sylfaen:6,Symbol:6,Tahoma:6,"Tempus Sans ITC":7,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":6,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":5,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:7,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":7,Vivaldi:5,"Vladimir Script":5,Vrinda:6,Webdings:11,"Wide Latin":14,Wingdings:15,"Wingdings 2":12,"Wingdings 3":10,"Yet R":6,"Yu Gothic":6,"Yu Gothic Light":6,"Yu Gothic Medium":6,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":6,"Yu Gothic UI Semilight":6,"Yu Mincho":6,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":5,"\u534e\u6587\u5b8b\u4f53":5,"\u534e\u6587\u5f69\u4e91":6,"\u534e\u6587\u65b0\u9b4f":6,"\u534e\u6587\u6977\u4f53":5,"\u534e\u6587\u7425\u73c0":6,"\u534e\u6587\u7ec6\u9ed1":6,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":6,"\u5fae\u8f6f\u96c5\u9ed1 Light":6,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":6,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":6,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},9:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":8,"Arial Narrow":5,"Arial Nova":7,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":7,"Arial Rounded MT Bold":7,"Baskerville Old Face":6,Batang:6,BatangChe:6,"Bauhaus 93":7,"Bell MT":6,Bembo:6,"Berlin Sans FB":7,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":8,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":9,"Bradley Hand ITC":8,"Britannic Bold":7,Broadway:8,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":7,"Calisto MT":6,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":6,"Comic Sans MS":7,Consolas:7,Constantia:7,"Cooper Black":7,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":6,Elephant:9,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:7,"Expo M":10,FangSong:6,"Felix Titling":7,"Footlight MT Light":7,Forte:6,"Franklin Gothic Book":7,"Franklin Gothic Demi":7,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":7,"Franklin Gothic Medium":7,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":5,"French Script MT":4,Gabriola:5,Gadugi:6,Garamond:6,Gautami:7,Georgia:8,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":6,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":7,Gigi:7,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":7,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":10,"Gill Sans Ultra Bold":10,"Gill Sans Ultra Bold Condensed":7,Gisha:6,"Gloucester MT Extra Condensed":5,"Goudy Old Style":6,"Goudy Stout":10,Grotesque:6,"Grotesque Light":6,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":7,Haettenschweiler:5,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:9,HGMinchoB:7,HGMinchoE:7,HGPGothicE:8,HGPGothicM:8,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:7,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:7,HGSGothicE:7,HGSGothicM:7,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":7,"HYGraphic-Medium":7,"HYGungSo-Bold":7,"HYHeadLine-Medium":7,"HYMyeongJo-Extra":8,"HYPMokGak-Bold":9,"HYPost-Light":8,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":6,"Informal Roman":7,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":7,Jokerman:9,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":7,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":9,"Lucida Console":8,"Lucida Fax":8,"Lucida Handwriting":9,"Lucida Sans":8,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":9,"Magic R":8,Magneto:9,"Maiandra GD":8,"Malgun Gothic":7,"Malgun Gothic Semilight":8,Mangal:7,Marlett:13,"Matura MT Script Capitals":9,Meiryo:8,"Meiryo UI":8,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":8,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":6,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":9,"MS Reference Specialty":15,"MS UI Gothic":7,"MT Extra":13,"MV Boli":9,"Myanmar Text":7,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":8,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":5,"Palatino Linotype":6,Papyrus:8,Parchment:4,Perpetua:6,"Perpetua Titling MT":8,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:6,"Pyunji R":7,Raavi:7,"Rage Italic":7,Ravie:12,Rockwell:7,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":5,"Segoe Print":9,"Segoe Script":9,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":8,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":7,"Sitka Small":8,"Sitka Subheading":7,"Sitka Text":8,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:7,Sylfaen:6,Symbol:6,Tahoma:7,"Tempus Sans ITC":8,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":7,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:8,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":8,Vivaldi:5,"Vladimir Script":6,Vrinda:6,Webdings:12,"Wide Latin":15,Wingdings:16,"Wingdings 2":14,"Wingdings 3":11,"Yet R":6,"Yu Gothic":7,"Yu Gothic Light":6,"Yu Gothic Medium":7,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":7,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":7,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},10:{"Gill Sans MT":7,Abadi:8,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:8,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":9,"Arial Narrow":6,"Arial Nova":7,"Arial Nova Cond":7,"Arial Nova Cond Light":6,"Arial Nova Light":7,"Arial Rounded MT Bold":8,"Baskerville Old Face":6,Batang:7,BatangChe:7,"Bauhaus 93":7,"Bell MT":7,Bembo:6,"Berlin Sans FB":8,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":9,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":5,"Book Antiqua":7,"Bookman Old Style":8,"Bookshelf Symbol 7":10,"Bradley Hand ITC":8,"Britannic Bold":8,Broadway:8,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":7,Calibri:7,"Calibri Light":7,"Californian FB":7,"Calisto MT":7,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":7,"Comic Sans MS":8,Consolas:7,Constantia:7,"Cooper Black":8,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:7,"Cordia New":5,CordiaUPC:5,"Courier New":8,"Curlz MT":7,Dante:6,DaunPenh:4,David:6,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:7,Dubai:7,"Dubai Light":7,"Dubai Medium":7,Ebrima:7,"Edwardian Script ITC":6,Elephant:10,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":8,"Eras Light ITC":7,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:8,"Expo M":11,FangSong:7,"Felix Titling":8,"Footlight MT Light":7,Forte:7,"Franklin Gothic Book":8,"Franklin Gothic Demi":8,"Franklin Gothic Demi Cond":7,"Franklin Gothic Heavy":8,"Franklin Gothic Medium":8,"Franklin Gothic Medium Cond":7,FrankRuehl:5,FreesiaUPC:6,"Freestyle Script":5,"French Script MT":5,Gabriola:5,Gadugi:7,Garamond:6,Gautami:8,Georgia:9,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":7,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":7,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":8,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":7,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":8,"Gill Sans Nova Cond XBd":7,"Gill Sans Nova Light":7,"Gill Sans Nova Ultra Bold":11,"Gill Sans Ultra Bold":11,"Gill Sans Ultra Bold Condensed":8,Gisha:7,"Gloucester MT Extra Condensed":5,"Goudy Old Style":7,"Goudy Stout":11,Grotesque:6,"Grotesque Light":6,Gulim:7,GulimChe:7,Gungsuh:6,GungsuhChe:7,"Hadassah Friedlaender":7,Haettenschweiler:6,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:7,HGGothicM:7,HGGyoshotai:7,HGKyokashotai:7,HGMaruGothicMPRO:10,HGMinchoB:8,HGMinchoE:8,HGPGothicE:8,HGPGothicM:9,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:8,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:8,HGSGothicE:7,HGSGothicM:8,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:8,HGSoeiKakugothicUB:8,HGSoeiKakupoptai:8,HGSoeiPresenceEB:8,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":8,"HYGraphic-Medium":8,"HYGungSo-Bold":8,"HYHeadLine-Medium":8,"HYMyeongJo-Extra":9,"HYPMokGak-Bold":9,"HYPost-Light":9,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":7,"Informal Roman":7,"Ink Free":7,IrisUPC:7,"Iskoola Pota":7,JasmineUPC:7,"Javanese Text":8,Jokerman:9,"Juice ITC":5,KaiTi:7,Kalinga:7,Kartika:7,"Khmer UI":7,KodchiangUPC:4,Kokila:7,"Kristen ITC":8,"Kunstler Script":5,"Lao UI":7,Latha:7,Leelawadee:7,"Leelawadee UI":7,"Leelawadee UI Semilight":7,"Levenim MT":7,LilyUPC:7,"Lucida Bright":8,"Lucida Calligraphy":10,"Lucida Console":9,"Lucida Fax":9,"Lucida Handwriting":10,"Lucida Sans":9,"Lucida Sans Typewriter":8,"Lucida Sans Unicode":9,"Magic R":8,Magneto:10,"Maiandra GD":9,"Malgun Gothic":8,"Malgun Gothic Semilight":8,Mangal:8,Marlett:14,"Matura MT Script Capitals":10,Meiryo:9,"Meiryo UI":9,"Microsoft GothicNeo":8,"Microsoft Himalaya":5,"Microsoft JhengHei":8,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":8,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":8,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":8,MingLiU:8,MingLiU_HKSCS:8,"MingLiU_HKSCS-ExtB":8,"MingLiU-ExtB":8,Miriam:8,"Miriam Fixed":8,Mistral:7,"Modern No. 20":7,"MoeumT R":8,"Mongolian Baiti":8,"Monotype Corsiva":7,MoolBoran:8,"MS Gothic":7,"MS Mincho":8,"MS Outlook":8,"MS PGothic":8,"MS PMincho":8,"MS Reference Sans Serif":9,"MS Reference Specialty":17,"MS UI Gothic":8,"MT Extra":14,"MV Boli":10,"Myanmar Text":7,Narkisim:8,"Neue Haas Grotesk Text Pro":8,"New Gulim":8,"News Gothic MT":8,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:8,"OCR A Extended":9,OCRB:9,"Old English Text MT":8,Onyx:6,"Palace Script MT":5,"Palatino Linotype":7,Papyrus:9,Parchment:4,Perpetua:6,"Perpetua Titling MT":9,"Plantagenet Cherokee":8,Playbill:6,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:8,"Pyunji R":7,Raavi:8,"Rage Italic":8,Ravie:13,Rockwell:7,"Rockwell Condensed":6,"Rockwell Extra Bold":9,"Rockwell Light":8,"Rockwell Nova":8,"Rockwell Nova Cond":8,"Rockwell Nova Cond Light":8,"Rockwell Nova Extra Bold":8,"Rockwell Nova Light":8,Rod:8,"Sakkal Majalla":8,"Sanskrit Text":8,"Script MT Bold":7,"Segoe MDL2 Assets":5,"Segoe Print":10,"Segoe Script":10,"Segoe UI":7,"Segoe UI Black":8,"Segoe UI Emoji":7,"Segoe UI Historic":7,"Segoe UI Light":7,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":7,Selawik:7,"Selawik Light":7,"Selawik Semibold":7,"Shonar Bangla":7,"Showcard Gothic":8,Shruti:7,"Simplified Arabic":7,"Simplified Arabic Fixed":7,"SimSun-ExtB":7,"Sitka Banner":7,"Sitka Display":7,"Sitka Heading":7,"Sitka Small":9,"Sitka Subheading":8,"Sitka Text":8,"Snap ITC":11,"Source Sans Pro":7,"Source Sans Pro Black":7,"Source Sans Pro ExtraLight":7,"Source Sans Pro Light":7,"Source Sans Pro SemiBold":7,Stencil:7,Sylfaen:7,Symbol:7,Tahoma:7,"Tempus Sans ITC":9,"TH SarabunPSK":7,"Times New Roman":6,"Traditional Arabic":7,"Trebuchet MS":7,Tunga:7,"Tw Cen MT":7,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":7,"UD Digi Kyokasho NK-B":7,"UD Digi Kyokasho NK-R":7,"UD Digi Kyokasho NP-B":7,"UD Digi Kyokasho NP-R":7,"UD Digi Kyokasho N-R":7,Univers:7,"Univers Condensed":7,"Univers Condensed Light":7,"Univers Light":7,"Urdu Typesetting":7,Utsaah:7,Vani:7,Verdana:8,"Verdana Pro":8,"Verdana Pro Black":7,"Verdana Pro Cond":7,"Verdana Pro Cond Black":7,"Verdana Pro Cond Light":7,"Verdana Pro Cond SemiBold":7,"Verdana Pro Light":7,"Verdana Pro SemiBold":7,Vijaya:7,"Viner Hand ITC":9,Vivaldi:6,"Vladimir Script":6,Vrinda:7,Webdings:13,"Wide Latin":16,Wingdings:17,"Wingdings 2":15,"Wingdings 3":12,"Yet R":7,"Yu Gothic":7,"Yu Gothic Light":7,"Yu Gothic Medium":7,"Yu Gothic UI":7,"Yu Gothic UI Light":7,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":7,"Yu Mincho Light":7,"\u4eff\u5b8b":7,"\u534e\u6587\u4e2d\u5b8b":8,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":8,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":7,"\u534e\u6587\u96b6\u4e66":6,"\u5b8b\u4f53":7,"\u5e7c\u5706":7,"\u5fae\u8f6f\u96c5\u9ed1":8,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":7,"\u65b9\u6b63\u59da\u4f53":7,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":7,"\u7b49\u7ebf":7,"\u7b49\u7ebf Light":7,"\u96b6\u4e66":7,"\u9ed1\u4f53":7,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":7,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':7,"\u30e1\u30a4\u30ea\u30aa":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":7,"HG\u660e\u671dB":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":7},11:{"Gill Sans MT":8,Abadi:9,"Abadi Extra Light":8,"Agency FB":6,Aharoni:6,Aldhabi:5,Algerian:9,"Ami R":6,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:8,"Arial Black":10,"Arial Narrow":7,"Arial Nova":8,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":8,"Arial Rounded MT Bold":9,"Baskerville Old Face":7,Batang:8,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:7,"Berlin Sans FB":9,"Berlin Sans FB Demi":9,"Bernard MT Condensed":7,"Blackadder ITC":6,"Bodoni MT":7,"Bodoni MT Black":10,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":5,"Book Antiqua":8,"Bookman Old Style":9,"Bookshelf Symbol 7":11,"Bradley Hand ITC":10,"Britannic Bold":9,Broadway:10,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":8,Calibri:7,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:8,"Cambria Math":8,Candara:8,Castellar:11,Centaur:7,Century:8,"Century Gothic":8,"Century Schoolbook":8,Chiller:7,"Colonna MT":8,"Comic Sans MS":9,Consolas:8,Constantia:8,"Cooper Black":9,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":11,Corbel:8,"Cordia New":5,CordiaUPC:5,"Courier New":9,"Curlz MT":8,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:8,Dotum:9,DotumChe:8,Dubai:8,"Dubai Light":8,"Dubai Medium":8,Ebrima:8,"Edwardian Script ITC":7,Elephant:11,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":9,"Eras Light ITC":8,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":13,FangSong:8,"Felix Titling":9,"Footlight MT Light":8,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:6,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":5,Gabriola:6,Gadugi:8,Garamond:7,Gautami:9,Georgia:9,"Georgia Pro":8,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":8,"Georgia Pro Light":8,"Georgia Pro Semibold":9,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":5,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":13,"Gill Sans Ultra Bold":13,"Gill Sans Ultra Bold Condensed":9,Gisha:8,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":12,Grotesque:7,"Grotesque Light":7,Gulim:8,GulimChe:8,Gungsuh:7,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:8,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:11,HGMinchoB:9,HGMinchoE:9,HGPGothicE:9,HGPGothicM:10,HGPGyoshotai:8,HGPKyokashotai:8,HGPMinchoB:8,HGPMinchoE:9,HGPSoeiKakugothicUB:10,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:9,HGSeikaishotaiPRO:9,HGSGothicE:8,HGSGothicM:9,HGSGyoshotai:7,HGSKyokashotai:7,HGSMinchoB:8,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:9,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:8,"High Tower Text":7,"HYGothic-Extra":9,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":10,"HYPMokGak-Bold":11,"HYPost-Light":10,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":9,Impact:8,"Imprint MT Shadow":8,"Informal Roman":8,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:8,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":9,"Kunstler Script":5,"Lao UI":8,Latha:8,Leelawadee:8,"Leelawadee UI":8,"Leelawadee UI Semilight":8,"Levenim MT":9,LilyUPC:8,"Lucida Bright":9,"Lucida Calligraphy":11,"Lucida Console":10,"Lucida Fax":10,"Lucida Handwriting":11,"Lucida Sans":10,"Lucida Sans Typewriter":9,"Lucida Sans Unicode":10,"Magic R":9,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":9,Mangal:9,Marlett:16,"Matura MT Script Capitals":11,Meiryo:9,"Meiryo UI":10,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":9,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":9,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":9,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":9,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":10,Mistral:8,"Modern No. 20":8,"MoeumT R":9,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:9,"MS Gothic":8,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":19,"MS UI Gothic":9,"MT Extra":16,"MV Boli":12,"Myanmar Text":9,Narkisim:7,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":5,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":9,Nyala:9,"OCR A Extended":10,OCRB:10,"Old English Text MT":9,Onyx:6,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":10,"Plantagenet Cherokee":9,Playbill:6,PMingLiU:8,"PMingLiU-ExtB":8,"Poor Richard":9,Pristina:9,"Pyunji R":8,Raavi:9,"Rage Italic":9,Ravie:15,Rockwell:8,"Rockwell Condensed":6,"Rockwell Extra Bold":10,"Rockwell Light":9,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":6,"Segoe Print":11,"Segoe Script":11,"Segoe UI":8,"Segoe UI Black":9,"Segoe UI Emoji":8,"Segoe UI Historic":8,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":8,"Segoe UI Symbol":8,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":8,"Sitka Small":10,"Sitka Subheading":9,"Sitka Text":9,"Snap ITC":13,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:8,"Tempus Sans ITC":10,"TH SarabunPSK":8,"Times New Roman":7,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":8,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":7,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:8,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":10,Vivaldi:6,"Vladimir Script":7,Vrinda:9,Webdings:15,"Wide Latin":19,Wingdings:20,"Wingdings 2":17,"Wingdings 3":13,"Yet R":8,"Yu Gothic":8,"Yu Gothic Light":8,"Yu Gothic Medium":8,"Yu Gothic UI":8,"Yu Gothic UI Light":8,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":8,"Yu Mincho":8,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":9,"\u534e\u6587\u4eff\u5b8b":7,"\u534e\u6587\u5b8b\u4f53":7,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":7,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":8,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":8,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":8,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":9,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},12:{"Gill Sans MT":8,Abadi:10,"Abadi Extra Light":9,"Agency FB":6,Aharoni:7,Aldhabi:5,Algerian:10,"Ami R":7,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:9,"Arial Black":11,"Arial Narrow":7,"Arial Nova":9,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":9,"Arial Rounded MT Bold":10,"Baskerville Old Face":8,Batang:9,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:8,"Berlin Sans FB":10,"Berlin Sans FB Demi":10,"Bernard MT Condensed":8,"Blackadder ITC":6,"Bodoni MT":8,"Bodoni MT Black":11,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":6,"Book Antiqua":8,"Bookman Old Style":10,"Bookshelf Symbol 7":12,"Bradley Hand ITC":10,"Britannic Bold":10,Broadway:10,"Browallia New":6,BrowalliaUPC:6,"Brush Script MT":8,Calibri:8,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:9,"Cambria Math":9,Candara:9,Castellar:12,Centaur:8,Century:9,"Century Gothic":9,"Century Schoolbook":9,Chiller:8,"Colonna MT":8,"Comic Sans MS":10,Consolas:9,Constantia:9,"Cooper Black":10,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":12,Corbel:8,"Cordia New":6,CordiaUPC:6,"Courier New":10,"Curlz MT":9,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:9,Dotum:8,DotumChe:8,Dubai:9,"Dubai Light":9,"Dubai Medium":9,Ebrima:9,"Edwardian Script ITC":8,Elephant:12,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":10,"Eras Light ITC":9,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":14,FangSong:8,"Felix Titling":9,"Footlight MT Light":9,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:7,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":6,Gabriola:6,Gadugi:9,Garamond:8,Gautami:10,Georgia:10,"Georgia Pro":9,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":9,"Georgia Pro Light":9,"Georgia Pro Semibold":10,Gigi:7,"Gill Sans MT Condensed":6,"Gill Sans MT Ext Condensed Bold":6,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":14,"Gill Sans Ultra Bold":14,"Gill Sans Ultra Bold Condensed":9,Gisha:9,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":13,Grotesque:8,"Grotesque Light":8,Gulim:9,GulimChe:8,Gungsuh:9,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:9,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:12,HGMinchoB:9,HGMinchoE:9,HGPGothicE:10,HGPGothicM:10,HGPGyoshotai:9,HGPKyokashotai:8,HGPMinchoB:9,HGPMinchoE:9,HGPSoeiKakugothicUB:11,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:10,HGSeikaishotaiPRO:10,HGSGothicE:9,HGSGothicM:9,HGSGyoshotai:8,HGSKyokashotai:7,HGSMinchoB:9,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:10,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:9,"High Tower Text":8,"HYGothic-Extra":10,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":11,"HYPMokGak-Bold":11,"HYPost-Light":11,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":10,Impact:9,"Imprint MT Shadow":8,"Informal Roman":9,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:9,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":10,"Kunstler Script":6,"Lao UI":8,Latha:8,Leelawadee:9,"Leelawadee UI":9,"Leelawadee UI Semilight":9,"Levenim MT":9,LilyUPC:7,"Lucida Bright":10,"Lucida Calligraphy":12,"Lucida Console":11,"Lucida Fax":11,"Lucida Handwriting":12,"Lucida Sans":11,"Lucida Sans Typewriter":10,"Lucida Sans Unicode":11,"Magic R":10,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":10,Mangal:9,Marlett:17,"Matura MT Script Capitals":12,Meiryo:11,"Meiryo UI":11,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":10,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":10,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":10,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":10,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":11,Mistral:8,"Modern No. 20":8,"MoeumT R":10,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:7,"MS Gothic":8,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":20,"MS UI Gothic":9,"MT Extra":17,"MV Boli":12,"Myanmar Text":9,Narkisim:8,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":6,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":10,Nyala:9,"OCR A Extended":11,OCRB:11,"Old English Text MT":9,Onyx:7,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":11,"Plantagenet Cherokee":9,Playbill:7,PMingLiU:9,"PMingLiU-ExtB":9,"Poor Richard":10,Pristina:9,"Pyunji R":9,Raavi:8,"Rage Italic":9,Ravie:16,Rockwell:9,"Rockwell Condensed":7,"Rockwell Extra Bold":11,"Rockwell Light":10,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":7,"Segoe Print":12,"Segoe Script":12,"Segoe UI":9,"Segoe UI Black":10,"Segoe UI Emoji":9,"Segoe UI Historic":9,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":9,"Segoe UI Symbol":9,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":9,"Sitka Small":11,"Sitka Subheading":9,"Sitka Text":10,"Snap ITC":14,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:9,"Tempus Sans ITC":11,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":9,"Tw Cen MT Condensed":6,"Tw Cen MT Condensed Extra Bold":8,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:6,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":11,Vivaldi:7,"Vladimir Script":7,Vrinda:9,Webdings:16,"Wide Latin":20,Wingdings:22,"Wingdings 2":18,"Wingdings 3":14,"Yet R":9,"Yu Gothic":9,"Yu Gothic Light":9,"Yu Gothic Medium":9,"Yu Gothic UI":9,"Yu Gothic UI Light":9,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":9,"Yu Mincho":9,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":10,"\u534e\u6587\u4eff\u5b8b":8,"\u534e\u6587\u5b8b\u4f53":8,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":8,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":9,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":9,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":9,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},14:{"Gill Sans MT":10,Abadi:11,"Abadi Extra Light":11,"Agency FB":8,Aharoni:8,Aldhabi:6,Algerian:11,"Ami R":8,"Angsana New":6,AngsanaUPC:6,Aparajita:8,"Arabic Typesetting":6,Arial:11,"Arial Black":13,"Arial Narrow":9,"Arial Nova":11,"Arial Nova Cond":10,"Arial Nova Cond Light":9,"Arial Nova Light":11,"Arial Rounded MT Bold":11,"Baskerville Old Face":9,Batang:10,BatangChe:10,"Bauhaus 93":11,"Bell MT":10,Bembo:9,"Berlin Sans FB":11,"Berlin Sans FB Demi":12,"Bernard MT Condensed":9,"Blackadder ITC":8,"Bodoni MT":9,"Bodoni MT Black":12,"Bodoni MT Condensed":6,"Bodoni MT Poster Compressed":6,"Book Antiqua":10,"Bookman Old Style":12,"Bookshelf Symbol 7":14,"Bradley Hand ITC":12,"Britannic Bold":12,Broadway:12,"Browallia New":7,BrowalliaUPC:7,"Brush Script MT":10,Calibri:10,"Calibri Light":10,"Californian FB":11,"Calisto MT":10,Cambria:11,"Cambria Math":11,Candara:10,Castellar:14,Centaur:9,Century:11,"Century Gothic":11,"Century Schoolbook":11,Chiller:9,"Colonna MT":10,"Comic Sans MS":12,Consolas:10,Constantia:10,"Cooper Black":11,"Copperplate Gothic Bold":14,"Copperplate Gothic Light":14,Corbel:10,"Cordia New":7,CordiaUPC:7,"Courier New":11,"Curlz MT":10,Dante:9,DaunPenh:6,David:8,DilleniaUPC:6,DokChampa:11,Dotum:10,DotumChe:10,Dubai:10,"Dubai Light":10,"Dubai Medium":10,Ebrima:10,"Edwardian Script ITC":9,Elephant:14,"Engravers MT":12,"Eras Bold ITC":12,"Eras Demi ITC":12,"Eras Light ITC":10,"Eras Medium ITC":11,EucrosiaUPC:8,Euphemia:11,"Expo M":16,FangSong:10,"Felix Titling":11,"Footlight MT Light":11,Forte:10,"Franklin Gothic Book":11,"Franklin Gothic Demi":11,"Franklin Gothic Demi Cond":10,"Franklin Gothic Heavy":11,"Franklin Gothic Medium":11,"Franklin Gothic Medium Cond":10,FrankRuehl:8,FreesiaUPC:8,"Freestyle Script":7,"French Script MT":7,Gabriola:8,Gadugi:10,Garamond:9,Gautami:11,Georgia:12,"Georgia Pro":11,"Georgia Pro Black":13,"Georgia Pro Cond":10,"Georgia Pro Cond Black":12,"Georgia Pro Cond Light":10,"Georgia Pro Cond Semibold":11,"Georgia Pro Light":10,"Georgia Pro Semibold":12,Gigi:10,"Gill Sans MT Condensed":7,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":10,"Gill Sans Nova Cond":6,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":11,"Gill Sans Nova Cond XBd":10,"Gill Sans Nova Light":10,"Gill Sans Nova Ultra Bold":16,"Gill Sans Ultra Bold":16,"Gill Sans Ultra Bold Condensed":11,Gisha:10,"Gloucester MT Extra Condensed":7,"Goudy Old Style":10,"Goudy Stout":16,Grotesque:9,"Grotesque Light":9,Gulim:10,GulimChe:10,Gungsuh:10,GungsuhChe:10,"Hadassah Friedlaender":11,Haettenschweiler:8,"Harlow Solid Italic":9,Harrington:11,"Headline R":14,HGGothicE:10,HGGothicM:10,HGGyoshotai:10,HGKyokashotai:10,HGMaruGothicMPRO:14,HGMinchoB:11,HGMinchoE:11,HGPGothicE:11,HGPGothicM:12,HGPGyoshotai:10,HGPKyokashotai:10,HGPMinchoB:10,HGPMinchoE:11,HGPSoeiKakugothicUB:13,HGPSoeiKakupoptai:13,HGPSoeiPresenceEB:12,HGSeikaishotaiPRO:11,HGSGothicE:10,HGSGothicM:11,HGSGyoshotai:9,HGSKyokashotai:9,HGSMinchoB:10,HGSMinchoE:11,HGSoeiKakugothicUB:11,HGSoeiKakupoptai:11,HGSoeiPresenceEB:11,HGSSoeiKakugothicUB:12,HGSSoeiKakupoptai:12,HGSSoeiPresenceEB:11,"High Tower Text":9,"HYGothic-Extra":12,"HYGothic-Medium":11,"HYGraphic-Medium":11,"HYGungSo-Bold":11,"HYHeadLine-Medium":11,"HYMyeongJo-Extra":13,"HYPMokGak-Bold":13,"HYPost-Light":13,"HYPost-Medium":13,"HYShortSamul-Medium":7,"HYSinMyeongJo-Medium":12,Impact:10,"Imprint MT Shadow":10,"Informal Roman":10,"Ink Free":10,IrisUPC:10,"Iskoola Pota":10,JasmineUPC:10,"Javanese Text":11,Jokerman:14,"Juice ITC":7,KaiTi:10,Kalinga:11,Kartika:11,"Khmer UI":10,KodchiangUPC:7,Kokila:10,"Kristen ITC":11,"Kunstler Script":7,"Lao UI":10,Latha:10,Leelawadee:10,"Leelawadee UI":10,"Leelawadee UI Semilight":10,"Levenim MT":11,LilyUPC:8,"Lucida Bright":12,"Lucida Calligraphy":14,"Lucida Console":12,"Lucida Fax":13,"Lucida Handwriting":14,"Lucida Sans":13,"Lucida Sans Typewriter":11,"Lucida Sans Unicode":13,"Magic R":12,Magneto:15,"Maiandra GD":12,"Malgun Gothic":11,"Malgun Gothic Semilight":12,Mangal:11,Marlett:20,"Matura MT Script Capitals":13,Meiryo:13,"Meiryo UI":13,"Microsoft GothicNeo":11,"Microsoft Himalaya":7,"Microsoft JhengHei":11,"Microsoft JhengHei Light":12,"Microsoft JhengHei UI":11,"Microsoft JhengHei UI Light":12,"Microsoft New Tai Lue":11,"Microsoft PhagsPa":11,"Microsoft Sans Serif":11,"Microsoft Tai Le":11,"Microsoft Uighur":7,"Microsoft YaHei Light":12,"Microsoft YaHei UI":12,"Microsoft YaHei UI Light":12,"Microsoft Yi Baiti":11,MingLiU:11,MingLiU_HKSCS:11,"MingLiU_HKSCS-ExtB":11,"MingLiU-ExtB":11,Miriam:10,"Miriam Fixed":12,Mistral:10,"Modern No. 20":10,"MoeumT R":11,"Mongolian Baiti":11,"Monotype Corsiva":9,MoolBoran:8,"MS Gothic":10,"MS Mincho":11,"MS Outlook":11,"MS PGothic":11,"MS PMincho":11,"MS Reference Sans Serif":13,"MS Reference Specialty":24,"MS UI Gothic":11,"MT Extra":20,"MV Boli":14,"Myanmar Text":11,Narkisim:9,"Neue Haas Grotesk Text Pro":11,"New Gulim":12,"News Gothic MT":12,"Niagara Engraved":7,"Niagara Solid":7,"Nirmala UI":11,"Nirmala UI Semilight":11,Nyala:11,"OCR A Extended":12,OCRB:12,"Old English Text MT":11,Onyx:7,"Palace Script MT":7,"Palatino Linotype":10,Papyrus:12,Parchment:5,Perpetua:9,"Perpetua Titling MT":13,"Plantagenet Cherokee":11,Playbill:8,PMingLiU:10,"PMingLiU-ExtB":10,"Poor Richard":11,Pristina:10,"Pyunji R":10,Raavi:10,"Rage Italic":11,Ravie:19,Rockwell:10,"Rockwell Condensed":8,"Rockwell Extra Bold":13,"Rockwell Light":11,"Rockwell Nova":11,"Rockwell Nova Cond":11,"Rockwell Nova Cond Light":11,"Rockwell Nova Extra Bold":11,"Rockwell Nova Light":11,Rod:11,"Sakkal Majalla":11,"Sanskrit Text":12,"Script MT Bold":10,"Segoe MDL2 Assets":8,"Segoe Print":14,"Segoe Script":14,"Segoe UI":10,"Segoe UI Black":12,"Segoe UI Emoji":10,"Segoe UI Historic":10,"Segoe UI Light":10,"Segoe UI Semibold":11,"Segoe UI Semilight":10,"Segoe UI Symbol":10,Selawik:10,"Selawik Light":10,"Selawik Semibold":10,"Shonar Bangla":10,"Showcard Gothic":11,Shruti:11,"Simplified Arabic":10,"Simplified Arabic Fixed":11,"SimSun-ExtB":10,"Sitka Banner":10,"Sitka Display":10,"Sitka Heading":11,"Sitka Small":13,"Sitka Subheading":11,"Sitka Text":12,"Snap ITC":16,"Source Sans Pro":9,"Source Sans Pro Black":10,"Source Sans Pro ExtraLight":9,"Source Sans Pro Light":10,"Source Sans Pro SemiBold":10,Stencil:11,Sylfaen:10,Symbol:10,Tahoma:10,"Tempus Sans ITC":13,"TH SarabunPSK":7,"Times New Roman":10,"Traditional Arabic":10,"Trebuchet MS":10,Tunga:10,"Tw Cen MT":10,"Tw Cen MT Condensed":7,"Tw Cen MT Condensed Extra Bold":9,"UD Digi Kyokasho N-B":10,"UD Digi Kyokasho NK-B":10,"UD Digi Kyokasho NK-R":10,"UD Digi Kyokasho NP-B":10,"UD Digi Kyokasho NP-R":10,"UD Digi Kyokasho N-R":10,Univers:10,"Univers Condensed":10,"Univers Condensed Light":8,"Univers Light":10,"Urdu Typesetting":10,Utsaah:8,Vani:11,Verdana:12,"Verdana Pro":12,"Verdana Pro Black":10,"Verdana Pro Cond":10,"Verdana Pro Cond Black":10,"Verdana Pro Cond Light":10,"Verdana Pro Cond SemiBold":10,"Verdana Pro Light":10,"Verdana Pro SemiBold":10,Vijaya:10,"Viner Hand ITC":13,Vivaldi:8,"Vladimir Script":9,Vrinda:11,Webdings:19,"Wide Latin":24,Wingdings:26,"Wingdings 2":22,"Wingdings 3":17,"Yet R":10,"Yu Gothic":11,"Yu Gothic Light":10,"Yu Gothic Medium":11,"Yu Gothic UI":10,"Yu Gothic UI Light":10,"Yu Gothic UI Semibold":11,"Yu Gothic UI Semilight":10,"Yu Mincho":10,"Yu Mincho Demibold":10,"Yu Mincho Light":10,"\u4eff\u5b8b":10,"\u534e\u6587\u4e2d\u5b8b":12,"\u534e\u6587\u4eff\u5b8b":9,"\u534e\u6587\u5b8b\u4f53":9,"\u534e\u6587\u5f69\u4e91":11,"\u534e\u6587\u65b0\u9b4f":11,"\u534e\u6587\u6977\u4f53":9,"\u534e\u6587\u7425\u73c0":11,"\u534e\u6587\u7ec6\u9ed1":11,"\u534e\u6587\u884c\u6977":10,"\u534e\u6587\u96b6\u4e66":8,"\u5b8b\u4f53":10,"\u5e7c\u5706":10,"\u5fae\u8f6f\u96c5\u9ed1":11,"\u5fae\u8f6f\u96c5\u9ed1 Light":11,"\u65b0\u5b8b\u4f53":10,"\u65b9\u6b63\u59da\u4f53":10,"\u65b9\u6b63\u8212\u4f53":10,"\u6977\u4f53":10,"\u7b49\u7ebf":10,"\u7b49\u7ebf Light":10,"\u96b6\u4e66":10,"\u9ed1\u4f53":10,"\u6e38\u30b4\u30b7\u30c3\u30af":11,"\uff2d\uff33 \uff30\u660e\u671d":10,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':10,"\u30e1\u30a4\u30ea\u30aa":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":10,"HG\u660e\u671dB":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":10},16:{"Gill Sans MT":11,Abadi:13,"Abadi Extra Light":12,"Agency FB":9,Aharoni:9,Aldhabi:7,Algerian:13,"Ami R":9,"Angsana New":7,AngsanaUPC:7,Aparajita:8,"Arabic Typesetting":7,Arial:12,"Arial Black":14,"Arial Narrow":10,"Arial Nova":12,"Arial Nova Cond":11,"Arial Nova Cond Light":9,"Arial Nova Light":12,"Arial Rounded MT Bold":12,"Baskerville Old Face":10,Batang:10,BatangChe:11,"Bauhaus 93":12,"Bell MT":11,Bembo:10,"Berlin Sans FB":13,"Berlin Sans FB Demi":13,"Bernard MT Condensed":10,"Blackadder ITC":8,"Bodoni MT":10,"Bodoni MT Black":14,"Bodoni MT Condensed":7,"Bodoni MT Poster Compressed":7,"Book Antiqua":11,"Bookman Old Style":13,"Bookshelf Symbol 7":16,"Bradley Hand ITC":14,"Britannic Bold":13,Broadway:14,"Browallia New":8,BrowalliaUPC:8,"Brush Script MT":11,Calibri:11,"Calibri Light":11,"Californian FB":12,"Calisto MT":11,Cambria:12,"Cambria Math":12,Candara:12,Castellar:15,Centaur:10,Century:12,"Century Gothic":12,"Century Schoolbook":12,Chiller:10,"Colonna MT":11,"Comic Sans MS":13,Consolas:12,Constantia:11,"Cooper Black":13,"Copperplate Gothic Bold":15,"Copperplate Gothic Light":15,Corbel:11,"Cordia New":8,CordiaUPC:8,"Courier New":13,"Curlz MT":11,Dante:9,DaunPenh:7,David:9,DilleniaUPC:7,DokChampa:12,Dotum:11,DotumChe:11,Dubai:11,"Dubai Light":11,"Dubai Medium":11,Ebrima:11,"Edwardian Script ITC":10,Elephant:16,"Engravers MT":14,"Eras Bold ITC":14,"Eras Demi ITC":13,"Eras Light ITC":11,"Eras Medium ITC":12,EucrosiaUPC:9,Euphemia:12,"Expo M":18,FangSong:11,"Felix Titling":12,"Footlight MT Light":12,Forte:11,"Franklin Gothic Book":12,"Franklin Gothic Demi":12,"Franklin Gothic Demi Cond":11,"Franklin Gothic Heavy":12,"Franklin Gothic Medium":12,"Franklin Gothic Medium Cond":11,FrankRuehl:9,FreesiaUPC:9,"Freestyle Script":8,"French Script MT":8,Gabriola:8,Gadugi:11,Garamond:10,Gautami:13,Georgia:13,"Georgia Pro":12,"Georgia Pro Black":15,"Georgia Pro Cond":11,"Georgia Pro Cond Black":13,"Georgia Pro Cond Light":11,"Georgia Pro Cond Semibold":12,"Georgia Pro Light":12,"Georgia Pro Semibold":13,Gigi:12,"Gill Sans MT Condensed":8,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":11,"Gill Sans Nova Cond":7,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":12,"Gill Sans Nova Cond XBd":11,"Gill Sans Nova Light":11,"Gill Sans Nova Ultra Bold":18,"Gill Sans Ultra Bold":18,"Gill Sans Ultra Bold Condensed":12,Gisha:11,"Gloucester MT Extra Condensed":8,"Goudy Old Style":11,"Goudy Stout":17,Grotesque:10,"Grotesque Light":10,Gulim:11,GulimChe:11,Gungsuh:11,GungsuhChe:11,"Hadassah Friedlaender":12,Haettenschweiler:9,"Harlow Solid Italic":10,Harrington:12,"Headline R":15,HGGothicE:11,HGGothicM:11,HGGyoshotai:11,HGKyokashotai:11,HGMaruGothicMPRO:16,HGMinchoB:12,HGMinchoE:12,HGPGothicE:12,HGPGothicM:13,HGPGyoshotai:11,HGPKyokashotai:11,HGPMinchoB:11,HGPMinchoE:12,HGPSoeiKakugothicUB:14,HGPSoeiKakupoptai:15,HGPSoeiPresenceEB:13,HGSeikaishotaiPRO:12,HGSGothicE:11,HGSGothicM:12,HGSGyoshotai:10,HGSKyokashotai:10,HGSMinchoB:11,HGSMinchoE:12,HGSoeiKakugothicUB:12,HGSoeiKakupoptai:12,HGSoeiPresenceEB:12,HGSSoeiKakugothicUB:13,HGSSoeiKakupoptai:14,HGSSoeiPresenceEB:12,"High Tower Text":10,"HYGothic-Extra":13,"HYGothic-Medium":12,"HYGraphic-Medium":12,"HYGungSo-Bold":12,"HYHeadLine-Medium":12,"HYMyeongJo-Extra":14,"HYPMokGak-Bold":15,"HYPost-Light":14,"HYPost-Medium":15,"HYShortSamul-Medium":8,"HYSinMyeongJo-Medium":13,Impact:11,"Imprint MT Shadow":11,"Informal Roman":11,"Ink Free":11,IrisUPC:11,"Iskoola Pota":11,JasmineUPC:10,"Javanese Text":12,Jokerman:15,"Juice ITC":8,KaiTi:11,Kalinga:12,Kartika:12,"Khmer UI":11,KodchiangUPC:7,Kokila:8,"Kristen ITC":13,"Kunstler Script":7,"Lao UI":11,Latha:11,Leelawadee:11,"Leelawadee UI":11,"Leelawadee UI Semilight":12,"Levenim MT":12,LilyUPC:9,"Lucida Bright":13,"Lucida Calligraphy":15,"Lucida Console":14,"Lucida Fax":14,"Lucida Handwriting":15,"Lucida Sans":14,"Lucida Sans Typewriter":13,"Lucida Sans Unicode":14,"Magic R":13,Magneto:16,"Maiandra GD":13,"Malgun Gothic":12,"Malgun Gothic Semilight":13,Mangal:12,Marlett:22,"Matura MT Script Capitals":15,Meiryo:14,"Meiryo UI":14,"Microsoft GothicNeo":12,"Microsoft Himalaya":8,"Microsoft JhengHei":13,"Microsoft JhengHei Light":13,"Microsoft JhengHei UI":13,"Microsoft JhengHei UI Light":13,"Microsoft New Tai Lue":12,"Microsoft PhagsPa":12,"Microsoft Sans Serif":13,"Microsoft Tai Le":12,"Microsoft Uighur":8,"Microsoft YaHei Light":13,"Microsoft YaHei UI":13,"Microsoft YaHei UI Light":13,"Microsoft Yi Baiti":12,MingLiU:12,MingLiU_HKSCS:12,"MingLiU_HKSCS-ExtB":12,"MingLiU-ExtB":12,Miriam:11,"Miriam Fixed":14,Mistral:10,"Modern No. 20":11,"MoeumT R":13,"Mongolian Baiti":12,"Monotype Corsiva":10,MoolBoran:8,"MS Gothic":11,"MS Mincho":12,"MS Outlook":12,"MS PGothic":12,"MS PMincho":12,"MS Reference Sans Serif":14,"MS Reference Specialty":26,"MS UI Gothic":12,"MT Extra":22,"MV Boli":16,"Myanmar Text":12,Narkisim:10,"Neue Haas Grotesk Text Pro":12,"New Gulim":13,"News Gothic MT":14,"Niagara Engraved":8,"Niagara Solid":8,"Nirmala UI":12,"Nirmala UI Semilight":13,Nyala:12,"OCR A Extended":14,OCRB:14,"Old English Text MT":12,Onyx:8,"Palace Script MT":8,"Palatino Linotype":11,Papyrus:14,Parchment:5,Perpetua:10,"Perpetua Titling MT":14,"Plantagenet Cherokee":12,Playbill:8,PMingLiU:11,"PMingLiU-ExtB":11,"Poor Richard":13,Pristina:11,"Pyunji R":11,Raavi:11,"Rage Italic":12,Ravie:21,Rockwell:11,"Rockwell Condensed":9,"Rockwell Extra Bold":14,"Rockwell Light":12,"Rockwell Nova":12,"Rockwell Nova Cond":12,"Rockwell Nova Cond Light":12,"Rockwell Nova Extra Bold":12,"Rockwell Nova Light":12,Rod:12,"Sakkal Majalla":12,"Sanskrit Text":13,"Script MT Bold":11,"Segoe MDL2 Assets":8,"Segoe Print":15,"Segoe Script":15,"Segoe UI":11,"Segoe UI Black":13,"Segoe UI Emoji":11,"Segoe UI Historic":11,"Segoe UI Light":11,"Segoe UI Semibold":12,"Segoe UI Semilight":11,"Segoe UI Symbol":11,Selawik:11,"Selawik Light":11,"Selawik Semibold":12,"Shonar Bangla":11,"Showcard Gothic":12,Shruti:13,"Simplified Arabic":11,"Simplified Arabic Fixed":13,"SimSun-ExtB":11,"Sitka Banner":11,"Sitka Display":11,"Sitka Heading":12,"Sitka Small":14,"Sitka Subheading":12,"Sitka Text":13,"Snap ITC":18,"Source Sans Pro":10,"Source Sans Pro Black":11,"Source Sans Pro ExtraLight":10,"Source Sans Pro Light":11,"Source Sans Pro SemiBold":11,Stencil:12,Sylfaen:11,Symbol:11,Tahoma:11,"Tempus Sans ITC":14,"TH SarabunPSK":8,"Times New Roman":11,"Traditional Arabic":10,"Trebuchet MS":11,Tunga:11,"Tw Cen MT":12,"Tw Cen MT Condensed":8,"Tw Cen MT Condensed Extra Bold":10,"UD Digi Kyokasho N-B":11,"UD Digi Kyokasho NK-B":11,"UD Digi Kyokasho NK-R":11,"UD Digi Kyokasho NP-B":11,"UD Digi Kyokasho NP-R":11,"UD Digi Kyokasho N-R":11,Univers:11,"Univers Condensed":11,"Univers Condensed Light":9,"Univers Light":11,"Urdu Typesetting":11,Utsaah:8,Vani:13,Verdana:13,"Verdana Pro":13,"Verdana Pro Black":11,"Verdana Pro Cond":11,"Verdana Pro Cond Black":11,"Verdana Pro Cond Light":11,"Verdana Pro Cond SemiBold":11,"Verdana Pro Light":11,"Verdana Pro SemiBold":11,Vijaya:11,"Viner Hand ITC":14,Vivaldi:9,"Vladimir Script":10,Vrinda:12,Webdings:21,"Wide Latin":26,Wingdings:28,"Wingdings 2":24,"Wingdings 3":19,"Yet R":11,"Yu Gothic":12,"Yu Gothic Light":11,"Yu Gothic Medium":12,"Yu Gothic UI":11,"Yu Gothic UI Light":11,"Yu Gothic UI Semibold":12,"Yu Gothic UI Semilight":12,"Yu Mincho":11,"Yu Mincho Demibold":11,"Yu Mincho Light":11,"\u4eff\u5b8b":11,"\u534e\u6587\u4e2d\u5b8b":13,"\u534e\u6587\u4eff\u5b8b":10,"\u534e\u6587\u5b8b\u4f53":10,"\u534e\u6587\u5f69\u4e91":12,"\u534e\u6587\u65b0\u9b4f":12,"\u534e\u6587\u6977\u4f53":10,"\u534e\u6587\u7425\u73c0":12,"\u534e\u6587\u7ec6\u9ed1":12,"\u534e\u6587\u884c\u6977":11,"\u534e\u6587\u96b6\u4e66":9,"\u5b8b\u4f53":11,"\u5e7c\u5706":11,"\u5fae\u8f6f\u96c5\u9ed1":12,"\u5fae\u8f6f\u96c5\u9ed1 Light":12,"\u65b0\u5b8b\u4f53":11,"\u65b9\u6b63\u59da\u4f53":11,"\u65b9\u6b63\u8212\u4f53":11,"\u6977\u4f53":11,"\u7b49\u7ebf":11,"\u7b49\u7ebf Light":11,"\u96b6\u4e66":11,"\u9ed1\u4f53":11,"\u6e38\u30b4\u30b7\u30c3\u30af":12,"\uff2d\uff33 \uff30\u660e\u671d":11,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':11,"\u30e1\u30a4\u30ea\u30aa":13,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":11,"HG\u660e\u671dB":11,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":11},18:{"Gill Sans MT":12,Abadi:15,"Abadi Extra Light":13,"Agency FB":10,Aharoni:10,Aldhabi:8,Algerian:14,"Ami R":10,"Angsana New":8,AngsanaUPC:8,Aparajita:10,"Arabic Typesetting":8,Arial:13,"Arial Black":16,"Arial Narrow":11,"Arial Nova":13,"Arial Nova Cond":12,"Arial Nova Cond Light":11,"Arial Nova Light":13,"Arial Rounded MT Bold":14,"Baskerville Old Face":12,Batang:12,BatangChe:12,"Bauhaus 93":14,"Bell MT":12,Bembo:12,"Berlin Sans FB":14,"Berlin Sans FB Demi":15,"Bernard MT Condensed":12,"Blackadder ITC":9,"Bodoni MT":12,"Bodoni MT Black":16,"Bodoni MT Condensed":8,"Bodoni MT Poster Compressed":8,"Book Antiqua":12,"Bookman Old Style":15,"Bookshelf Symbol 7":18,"Bradley Hand ITC":15,"Britannic Bold":15,Broadway:16,"Browallia New":9,BrowalliaUPC:9,"Brush Script MT":12,Calibri:12,"Calibri Light":12,"Californian FB":13,"Calisto MT":12,Cambria:13,"Cambria Math":13,Candara:13,Castellar:17,Centaur:12,Century:13,"Century Gothic":13,"Century Schoolbook":13,Chiller:11,"Colonna MT":12,"Comic Sans MS":15,Consolas:13,Constantia:13,"Cooper Black":14,"Copperplate Gothic Bold":17,"Copperplate Gothic Light":17,Corbel:13,"Cordia New":9,CordiaUPC:9,"Courier New":14,"Curlz MT":13,Dante:11,DaunPenh:8,David:11,DilleniaUPC:7,DokChampa:13,Dotum:13,DotumChe:12,Dubai:13,"Dubai Light":13,"Dubai Medium":13,Ebrima:13,"Edwardian Script ITC":11,Elephant:18,"Engravers MT":16,"Eras Bold ITC":16,"Eras Demi ITC":15,"Eras Light ITC":13,"Eras Medium ITC":14,EucrosiaUPC:10,Euphemia:14,"Expo M":21,FangSong:12,"Felix Titling":14,"Footlight MT Light":13,Forte:13,"Franklin Gothic Book":14,"Franklin Gothic Demi":14,"Franklin Gothic Demi Cond":12,"Franklin Gothic Heavy":14,"Franklin Gothic Medium":14,"Franklin Gothic Medium Cond":12,FrankRuehl:10,FreesiaUPC:11,"Freestyle Script":9,"French Script MT":9,Gabriola:10,Gadugi:13,Garamond:11,Gautami:14,Georgia:15,"Georgia Pro":14,"Georgia Pro Black":17,"Georgia Pro Cond":13,"Georgia Pro Cond Black":15,"Georgia Pro Cond Light":12,"Georgia Pro Cond Semibold":13,"Georgia Pro Light":13,"Georgia Pro Semibold":15,Gigi:12,"Gill Sans MT Condensed":9,"Gill Sans MT Ext Condensed Bold":8,"Gill Sans Nova":12,"Gill Sans Nova Cond":8,"Gill Sans Nova Cond Lt":7,"Gill Sans Nova Cond Ultra Bold":14,"Gill Sans Nova Cond XBd":13,"Gill Sans Nova Light":12,"Gill Sans Nova Ultra Bold":20,"Gill Sans Ultra Bold":21,"Gill Sans Ultra Bold Condensed":14,Gisha:13,"Gloucester MT Extra Condensed":9,"Goudy Old Style":12,"Goudy Stout":20,Grotesque:12,"Grotesque Light":12,Gulim:13,GulimChe:12,Gungsuh:13,GungsuhChe:12,"Hadassah Friedlaender":14,Haettenschweiler:11,"Harlow Solid Italic":11,Harrington:13,"Headline R":17,HGGothicE:12,HGGothicM:12,HGGyoshotai:12,HGKyokashotai:12,HGMaruGothicMPRO:18,HGMinchoB:13,HGMinchoE:13,HGPGothicE:14,HGPGothicM:15,HGPGyoshotai:12,HGPKyokashotai:12,HGPMinchoB:12,HGPMinchoE:13,HGPSoeiKakugothicUB:16,HGPSoeiKakupoptai:17,HGPSoeiPresenceEB:14,HGSeikaishotaiPRO:14,HGSGothicE:13,HGSGothicM:14,HGSGyoshotai:11,HGSKyokashotai:11,HGSMinchoB:12,HGSMinchoE:13,HGSoeiKakugothicUB:13,HGSoeiKakupoptai:13,HGSoeiPresenceEB:13,HGSSoeiKakugothicUB:15,HGSSoeiKakupoptai:16,HGSSoeiPresenceEB:13,"High Tower Text":12,"HYGothic-Extra":15,"HYGothic-Medium":14,"HYGraphic-Medium":14,"HYGungSo-Bold":14,"HYHeadLine-Medium":14,"HYMyeongJo-Extra":16,"HYPMokGak-Bold":17,"HYPost-Light":16,"HYPost-Medium":17,"HYShortSamul-Medium":9,"HYSinMyeongJo-Medium":15,Impact:13,"Imprint MT Shadow":12,"Informal Roman":13,"Ink Free":12,IrisUPC:12,"Iskoola Pota":12,JasmineUPC:11,"Javanese Text":14,Jokerman:17,"Juice ITC":8,KaiTi:12,Kalinga:13,Kartika:14,"Khmer UI":13,KodchiangUPC:8,Kokila:9,"Kristen ITC":14,"Kunstler Script":8,"Lao UI":13,Latha:12,Leelawadee:13,"Leelawadee UI":13,"Leelawadee UI Semilight":13,"Levenim MT":14,LilyUPC:11,"Lucida Bright":15,"Lucida Calligraphy":17,"Lucida Console":15,"Lucida Fax":16,"Lucida Handwriting":17,"Lucida Sans":16,"Lucida Sans Typewriter":14,"Lucida Sans Unicode":16,"Magic R":14,Magneto:19,"Maiandra GD":15,"Malgun Gothic":14,"Malgun Gothic Semilight":14,Mangal:14,Marlett:25,"Matura MT Script Capitals":17,Meiryo:16,"Meiryo UI":16,"Microsoft GothicNeo":13,"Microsoft Himalaya":9,"Microsoft JhengHei":14,"Microsoft JhengHei Light":15,"Microsoft JhengHei UI":14,"Microsoft JhengHei UI Light":15,"Microsoft New Tai Lue":14,"Microsoft PhagsPa":14,"Microsoft Sans Serif":14,"Microsoft Tai Le":14,"Microsoft Uighur":9,"Microsoft YaHei Light":15,"Microsoft YaHei UI":15,"Microsoft YaHei UI Light":15,"Microsoft Yi Baiti":13,MingLiU:13,MingLiU_HKSCS:13,"MingLiU_HKSCS-ExtB":13,"MingLiU-ExtB":13,Miriam:12,"Miriam Fixed":15,Mistral:12,"Modern No. 20":12,"MoeumT R":14,"Mongolian Baiti":13,"Monotype Corsiva":12,MoolBoran:9,"MS Gothic":12,"MS Mincho":13,"MS Outlook":13,"MS PGothic":13,"MS PMincho":13,"MS Reference Sans Serif":16,"MS Reference Specialty":30,"MS UI Gothic":13,"MT Extra":25,"MV Boli":18,"Myanmar Text":14,Narkisim:11,"Neue Haas Grotesk Text Pro":13,"New Gulim":15,"News Gothic MT":16,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":14,"Nirmala UI Semilight":14,Nyala:13,"OCR A Extended":15,OCRB:15,"Old English Text MT":13,Onyx:9,"Palace Script MT":9,"Palatino Linotype":12,Papyrus:15,Parchment:6,Perpetua:11,"Perpetua Titling MT":16,"Plantagenet Cherokee":13,Playbill:10,PMingLiU:12,"PMingLiU-ExtB":12,"Poor Richard":14,Pristina:13,"Pyunji R":13,Raavi:12,"Rage Italic":13,Ravie:24,Rockwell:13,"Rockwell Condensed":10,"Rockwell Extra Bold":17,"Rockwell Light":14,"Rockwell Nova":13,"Rockwell Nova Cond":13,"Rockwell Nova Cond Light":13,"Rockwell Nova Extra Bold":13,"Rockwell Nova Light":13,Rod:15,"Sakkal Majalla":10,"Sanskrit Text":15,"Script MT Bold":13,"Segoe MDL2 Assets":10,"Segoe Print":18,"Segoe Script":18,"Segoe UI":13,"Segoe UI Black":15,"Segoe UI Emoji":13,"Segoe UI Historic":13,"Segoe UI Light":12,"Segoe UI Semibold":14,"Segoe UI Semilight":13,"Segoe UI Symbol":13,Selawik:12,"Selawik Light":13,"Selawik Semibold":14,"Shonar Bangla":12,"Showcard Gothic":14,Shruti:14,"Simplified Arabic":13,"Simplified Arabic Fixed":14,"SimSun-ExtB":12,"Sitka Banner":12,"Sitka Display":13,"Sitka Heading":13,"Sitka Small":16,"Sitka Subheading":14,"Sitka Text":15,"Snap ITC":21,"Source Sans Pro":12,"Source Sans Pro Black":12,"Source Sans Pro ExtraLight":11,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":12,Stencil:14,Sylfaen:12,Symbol:12,Tahoma:13,"Tempus Sans ITC":16,"TH SarabunPSK":9,"Times New Roman":12,"Traditional Arabic":12,"Trebuchet MS":13,Tunga:13,"Tw Cen MT":13,"Tw Cen MT Condensed":9,"Tw Cen MT Condensed Extra Bold":12,"UD Digi Kyokasho N-B":12,"UD Digi Kyokasho NK-B":12,"UD Digi Kyokasho NK-R":12,"UD Digi Kyokasho NP-B":17,"UD Digi Kyokasho NP-R":12,"UD Digi Kyokasho N-R":12,Univers:12,"Univers Condensed":12,"Univers Condensed Light":11,"Univers Light":12,"Urdu Typesetting":12,Utsaah:10,Vani:15,Verdana:15,"Verdana Pro":15,"Verdana Pro Black":12,"Verdana Pro Cond":12,"Verdana Pro Cond Black":12,"Verdana Pro Cond Light":12,"Verdana Pro Cond SemiBold":12,"Verdana Pro Light":12,"Verdana Pro SemiBold":12,Vijaya:12,"Viner Hand ITC":16,Vivaldi:10,"Vladimir Script":11,Vrinda:14,Webdings:24,"Wide Latin":30,Wingdings:32,"Wingdings 2":27,"Wingdings 3":21,"Yet R":13,"Yu Gothic":13,"Yu Gothic Light":13,"Yu Gothic Medium":13,"Yu Gothic UI":13,"Yu Gothic UI Light":13,"Yu Gothic UI Semibold":14,"Yu Gothic UI Semilight":13,"Yu Mincho":13,"Yu Mincho Demibold":13,"Yu Mincho Light":12,"\u4eff\u5b8b":12,"\u534e\u6587\u4e2d\u5b8b":15,"\u534e\u6587\u4eff\u5b8b":11,"\u534e\u6587\u5b8b\u4f53":11,"\u534e\u6587\u5f69\u4e91":14,"\u534e\u6587\u65b0\u9b4f":14,"\u534e\u6587\u6977\u4f53":11,"\u534e\u6587\u7425\u73c0":14,"\u534e\u6587\u7ec6\u9ed1":13,"\u534e\u6587\u884c\u6977":12,"\u534e\u6587\u96b6\u4e66":11,"\u5b8b\u4f53":12,"\u5e7c\u5706":12,"\u5fae\u8f6f\u96c5\u9ed1":14,"\u5fae\u8f6f\u96c5\u9ed1 Light":14,"\u65b0\u5b8b\u4f53":12,"\u65b9\u6b63\u59da\u4f53":12,"\u65b9\u6b63\u8212\u4f53":13,"\u6977\u4f53":12,"\u7b49\u7ebf":13,"\u7b49\u7ebf Light":12,"\u96b6\u4e66":12,"\u9ed1\u4f53":12,"\u6e38\u30b4\u30b7\u30c3\u30af":13,"\uff2d\uff33 \uff30\u660e\u671d":12,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':12,"\u30e1\u30a4\u30ea\u30aa":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":12,"HG\u660e\u671dB":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":12},20:{"Gill Sans MT":14,Abadi:16,"Abadi Extra Light":15,"Agency FB":11,Aharoni:11,Aldhabi:9,Algerian:16,"Ami R":11,"Angsana New":9,AngsanaUPC:9,Aparajita:11,"Arabic Typesetting":9,Arial:15,"Arial Black":18,"Arial Narrow":12,"Arial Nova":15,"Arial Nova Cond":14,"Arial Nova Cond Light":12,"Arial Nova Light":15,"Arial Rounded MT Bold":16,"Baskerville Old Face":13,Batang:16,BatangChe:14,"Bauhaus 93":15,"Bell MT":14,Bembo:13,"Berlin Sans FB":16,"Berlin Sans FB Demi":17,"Bernard MT Condensed":13,"Blackadder ITC":11,"Bodoni MT":13,"Bodoni MT Black":18,"Bodoni MT Condensed":9,"Bodoni MT Poster Compressed":8,"Book Antiqua":14,"Bookman Old Style":17,"Bookshelf Symbol 7":20,"Bradley Hand ITC":17,"Britannic Bold":17,Broadway:17,"Browallia New":10,BrowalliaUPC:10,"Brush Script MT":14,Calibri:14,"Calibri Light":14,"Californian FB":14,"Calisto MT":14,Cambria:15,"Cambria Math":15,Candara:15,Castellar:19,Centaur:13,Century:15,"Century Gothic":15,"Century Schoolbook":15,Chiller:13,"Colonna MT":14,"Comic Sans MS":16,Consolas:15,Constantia:15,"Cooper Black":16,"Copperplate Gothic Bold":19,"Copperplate Gothic Light":19,Corbel:14,"Cordia New":10,CordiaUPC:10,"Courier New":16,"Curlz MT":15,Dante:12,DaunPenh:9,David:12,DilleniaUPC:8,DokChampa:15,Dotum:16,DotumChe:14,Dubai:15,"Dubai Light":15,"Dubai Medium":15,Ebrima:15,"Edwardian Script ITC":13,Elephant:20,"Engravers MT":17,"Eras Bold ITC":18,"Eras Demi ITC":16,"Eras Light ITC":14,"Eras Medium ITC":15,EucrosiaUPC:11,Euphemia:16,"Expo M":23,FangSong:14,"Felix Titling":16,"Footlight MT Light":15,Forte:14,"Franklin Gothic Book":16,"Franklin Gothic Demi":16,"Franklin Gothic Demi Cond":14,"Franklin Gothic Heavy":16,"Franklin Gothic Medium":16,"Franklin Gothic Medium Cond":14,FrankRuehl:11,FreesiaUPC:12,"Freestyle Script":10,"French Script MT":10,Gabriola:11,Gadugi:15,Garamond:13,Gautami:16,Georgia:17,"Georgia Pro":15,"Georgia Pro Black":19,"Georgia Pro Cond":14,"Georgia Pro Cond Black":17,"Georgia Pro Cond Light":14,"Georgia Pro Cond Semibold":15,"Georgia Pro Light":15,"Georgia Pro Semibold":17,Gigi:14,"Gill Sans MT Condensed":10,"Gill Sans MT Ext Condensed Bold":9,"Gill Sans Nova":14,"Gill Sans Nova Cond":9,"Gill Sans Nova Cond Lt":8,"Gill Sans Nova Cond Ultra Bold":16,"Gill Sans Nova Cond XBd":14,"Gill Sans Nova Light":14,"Gill Sans Nova Ultra Bold":23,"Gill Sans Ultra Bold":23,"Gill Sans Ultra Bold Condensed":16,Gisha:15,"Gloucester MT Extra Condensed":10,"Goudy Old Style":14,"Goudy Stout":22,Grotesque:13,"Grotesque Light":13,Gulim:16,GulimChe:14,Gungsuh:16,GungsuhChe:14,"Hadassah Friedlaender":15,Haettenschweiler:12,"Harlow Solid Italic":13,Harrington:15,"Headline R":19,HGGothicE:14,HGGothicM:14,HGGyoshotai:14,HGKyokashotai:14,HGMaruGothicMPRO:20,HGMinchoB:15,HGMinchoE:15,HGPGothicE:16,HGPGothicM:17,HGPGyoshotai:14,HGPKyokashotai:14,HGPMinchoB:14,HGPMinchoE:15,HGPSoeiKakugothicUB:18,HGPSoeiKakupoptai:19,HGPSoeiPresenceEB:16,HGSeikaishotaiPRO:16,HGSGothicE:15,HGSGothicM:16,HGSGyoshotai:13,HGSKyokashotai:13,HGSMinchoB:14,HGSMinchoE:15,HGSoeiKakugothicUB:15,HGSoeiKakupoptai:15,HGSoeiPresenceEB:15,HGSSoeiKakugothicUB:17,HGSSoeiKakupoptai:18,HGSSoeiPresenceEB:15,"High Tower Text":13,"HYGothic-Extra":17,"HYGothic-Medium":16,"HYGraphic-Medium":16,"HYGungSo-Bold":16,"HYHeadLine-Medium":16,"HYMyeongJo-Extra":18,"HYPMokGak-Bold":19,"HYPost-Light":18,"HYPost-Medium":19,"HYShortSamul-Medium":10,"HYSinMyeongJo-Medium":17,Impact:15,"Imprint MT Shadow":14,"Informal Roman":15,"Ink Free":14,IrisUPC:14,"Iskoola Pota":14,JasmineUPC:12,"Javanese Text":16,Jokerman:19,"Juice ITC":10,KaiTi:14,Kalinga:15,Kartika:16,"Khmer UI":15,KodchiangUPC:9,Kokila:10,"Kristen ITC":16,"Kunstler Script":10,"Lao UI":15,Latha:14,Leelawadee:15,"Leelawadee UI":15,"Leelawadee UI Semilight":15,"Levenim MT":15,LilyUPC:12,"Lucida Bright":16,"Lucida Calligraphy":19,"Lucida Console":17,"Lucida Fax":18,"Lucida Handwriting":19,"Lucida Sans":18,"Lucida Sans Typewriter":16,"Lucida Sans Unicode":18,"Magic R":16,Magneto:21,"Maiandra GD":17,"Malgun Gothic":16,"Malgun Gothic Semilight":16,Mangal:16,Marlett:28,"Matura MT Script Capitals":19,Meiryo:18,"Meiryo UI":18,"Microsoft GothicNeo":15,"Microsoft Himalaya":10,"Microsoft JhengHei":16,"Microsoft JhengHei Light":17,"Microsoft JhengHei UI":16,"Microsoft JhengHei UI Light":17,"Microsoft New Tai Lue":16,"Microsoft PhagsPa":16,"Microsoft Sans Serif":16,"Microsoft Tai Le":16,"Microsoft Uighur":10,"Microsoft YaHei Light":16,"Microsoft YaHei UI":17,"Microsoft YaHei UI Light":16,"Microsoft Yi Baiti":15,MingLiU:15,MingLiU_HKSCS:15,"MingLiU_HKSCS-ExtB":15,"MingLiU-ExtB":15,Miriam:14,"Miriam Fixed":17,Mistral:13,"Modern No. 20":13,"MoeumT R":16,"Mongolian Baiti":15,"Monotype Corsiva":13,MoolBoran:10,"MS Gothic":14,"MS Mincho":15,"MS Outlook":15,"MS PGothic":15,"MS PMincho":15,"MS Reference Sans Serif":18,"MS Reference Specialty":33,"MS UI Gothic":15,"MT Extra":29,"MV Boli":20,"Myanmar Text":16,Narkisim:12,"Neue Haas Grotesk Text Pro":15,"New Gulim":17,"News Gothic MT":18,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":16,"Nirmala UI Semilight":16,Nyala:15,"OCR A Extended":17,OCRB:17,"Old English Text MT":15,Onyx:9,"Palace Script MT":9,"Palatino Linotype":14,Papyrus:16,Parchment:7,Perpetua:12,"Perpetua Titling MT":18,"Plantagenet Cherokee":15,Playbill:11,PMingLiU:14,"PMingLiU-ExtB":14,"Poor Richard":16,Pristina:14,"Pyunji R":14,Raavi:14,"Rage Italic":15,Ravie:27,Rockwell:15,"Rockwell Condensed":12,"Rockwell Extra Bold":19,"Rockwell Light":15,"Rockwell Nova":15,"Rockwell Nova Cond":15,"Rockwell Nova Cond Light":15,"Rockwell Nova Extra Bold":15,"Rockwell Nova Light":15,Rod:17,"Sakkal Majalla":11,"Sanskrit Text":17,"Script MT Bold":14,"Segoe MDL2 Assets":11,"Segoe Print":20,"Segoe Script":20,"Segoe UI":15,"Segoe UI Black":17,"Segoe UI Emoji":15,"Segoe UI Historic":15,"Segoe UI Light":14,"Segoe UI Semibold":15,"Segoe UI Semilight":15,"Segoe UI Symbol":15,Selawik:14,"Selawik Light":14,"Selawik Semibold":15,"Shonar Bangla":14,"Showcard Gothic":16,Shruti:16,"Simplified Arabic":14,"Simplified Arabic Fixed":16,"SimSun-ExtB":14,"Sitka Banner":14,"Sitka Display":14,"Sitka Heading":15,"Sitka Small":18,"Sitka Subheading":16,"Sitka Text":17,"Snap ITC":23,"Source Sans Pro":13,"Source Sans Pro Black":14,"Source Sans Pro ExtraLight":12,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":14,Stencil:16,Sylfaen:14,Symbol:14,Tahoma:15,"Tempus Sans ITC":18,"TH SarabunPSK":10,"Times New Roman":14,"Traditional Arabic":13,"Trebuchet MS":14,Tunga:14,"Tw Cen MT":15,"Tw Cen MT Condensed":10,"Tw Cen MT Condensed Extra Bold":13,"UD Digi Kyokasho N-B":14,"UD Digi Kyokasho NK-B":14,"UD Digi Kyokasho NK-R":14,"UD Digi Kyokasho NP-B":19,"UD Digi Kyokasho NP-R":14,"UD Digi Kyokasho N-R":14,Univers:14,"Univers Condensed":14,"Univers Condensed Light":12,"Univers Light":14,"Urdu Typesetting":14,Utsaah:11,Vani:17,Verdana:17,"Verdana Pro":17,"Verdana Pro Black":14,"Verdana Pro Cond":14,"Verdana Pro Cond Black":14,"Verdana Pro Cond Light":14,"Verdana Pro Cond SemiBold":14,"Verdana Pro Light":14,"Verdana Pro SemiBold":14,Vijaya:14,"Viner Hand ITC":18,Vivaldi:12,"Vladimir Script":13,Vrinda:16,Webdings:27,"Wide Latin":33,Wingdings:36,"Wingdings 2":31,"Wingdings 3":24,"Yet R":14,"Yu Gothic":15,"Yu Gothic Light":14,"Yu Gothic Medium":15,"Yu Gothic UI":15,"Yu Gothic UI Light":14,"Yu Gothic UI Semibold":16,"Yu Gothic UI Semilight":15,"Yu Mincho":15,"Yu Mincho Demibold":14,"Yu Mincho Light":14,"\u4eff\u5b8b":14,"\u534e\u6587\u4e2d\u5b8b":17,"\u534e\u6587\u4eff\u5b8b":13,"\u534e\u6587\u5b8b\u4f53":13,"\u534e\u6587\u5f69\u4e91":15,"\u534e\u6587\u65b0\u9b4f":16,"\u534e\u6587\u6977\u4f53":13,"\u534e\u6587\u7425\u73c0":15,"\u534e\u6587\u7ec6\u9ed1":15,"\u534e\u6587\u884c\u6977":14,"\u534e\u6587\u96b6\u4e66":12,"\u5b8b\u4f53":14,"\u5e7c\u5706":14,"\u5fae\u8f6f\u96c5\u9ed1":16,"\u5fae\u8f6f\u96c5\u9ed1 Light":15,"\u65b0\u5b8b\u4f53":14,"\u65b9\u6b63\u59da\u4f53":14,"\u65b9\u6b63\u8212\u4f53":15,"\u6977\u4f53":14,"\u7b49\u7ebf":14,"\u7b49\u7ebf Light":14,"\u96b6\u4e66":14,"\u9ed1\u4f53":14,"\u6e38\u30b4\u30b7\u30c3\u30af":15,"\uff2d\uff33 \uff30\u660e\u671d":14,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':14,"\u30e1\u30a4\u30ea\u30aa":17,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":14,"HG\u660e\u671dB":14,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":14},22:{"Gill Sans MT":15,Abadi:18,"Abadi Extra Light":16,"Agency FB":11,Aharoni:12,Aldhabi:9,Algerian:17,"Ami R":12,"Angsana New":10,AngsanaUPC:10,Aparajita:12,"Arabic Typesetting":10,Arial:16,"Arial Black":19,"Arial Narrow":13,"Arial Nova":16,"Arial Nova Cond":15,"Arial Nova Cond Light":13,"Arial Nova Light":16,"Arial Rounded MT Bold":17,"Baskerville Old Face":14,Batang:17,BatangChe:15,"Bauhaus 93":16,"Bell MT":15,Bembo:14,"Berlin Sans FB":17,"Berlin Sans FB Demi":18,"Bernard MT Condensed":14,"Blackadder ITC":11,"Bodoni MT":14,"Bodoni MT Black":19,"Bodoni MT Condensed":10,"Bodoni MT Poster Compressed":9,"Book Antiqua":15,"Bookman Old Style":18,"Bookshelf Symbol 7":21,"Bradley Hand ITC":19,"Britannic Bold":18,Broadway:19,"Browallia New":11,BrowalliaUPC:11,"Brush Script MT":15,Calibri:15,"Calibri Light":15,"Californian FB":15,"Calisto MT":15,Cambria:16,"Cambria Math":16,Candara:16,Castellar:21,Centaur:14,Century:16,"Century Gothic":16,"Century Schoolbook":16,Chiller:14,"Colonna MT":15,"Comic Sans MS":18,Consolas:16,Constantia:16,"Cooper Black":17,"Copperplate Gothic Bold":21,"Copperplate Gothic Light":21,Corbel:15,"Cordia New":11,CordiaUPC:11,"Courier New":17,"Curlz MT":16,Dante:13,DaunPenh:10,David:13,DilleniaUPC:9,DokChampa:16,Dotum:17,DotumChe:15,Dubai:16,"Dubai Light":16,"Dubai Medium":16,Ebrima:16,"Edwardian Script ITC":14,Elephant:22,"Engravers MT":19,"Eras Bold ITC":19,"Eras Demi ITC":18,"Eras Light ITC":16,"Eras Medium ITC":17,EucrosiaUPC:12,Euphemia:17,"Expo M":25,FangSong:15,"Felix Titling":17,"Footlight MT Light":16,Forte:15,"Franklin Gothic Book":17,"Franklin Gothic Demi":17,"Franklin Gothic Demi Cond":15,"Franklin Gothic Heavy":17,"Franklin Gothic Medium":17,"Franklin Gothic Medium Cond":15,FrankRuehl:12,FreesiaUPC:13,"Freestyle Script":10,"French Script MT":11,Gabriola:12,Gadugi:16,Garamond:14,Gautami:17,Georgia:18,"Georgia Pro":16,"Georgia Pro Black":21,"Georgia Pro Cond":15,"Georgia Pro Cond Black":18,"Georgia Pro Cond Light":15,"Georgia Pro Cond Semibold":16,"Georgia Pro Light":16,"Georgia Pro Semibold":18,Gigi:14,"Gill Sans MT Condensed":11,"Gill Sans MT Ext Condensed Bold":10,"Gill Sans Nova":15,"Gill Sans Nova Cond":10,"Gill Sans Nova Cond Lt":9,"Gill Sans Nova Cond Ultra Bold":17,"Gill Sans Nova Cond XBd":15,"Gill Sans Nova Light":15,"Gill Sans Nova Ultra Bold":25,"Gill Sans Ultra Bold":25,"Gill Sans Ultra Bold Condensed":17,Gisha:16,"Gloucester MT Extra Condensed":11,"Goudy Old Style":15,"Goudy Stout":24,Grotesque:14,"Grotesque Light":14,Gulim:17,GulimChe:15,Gungsuh:17,GungsuhChe:15,"Hadassah Friedlaender":17,Haettenschweiler:13,"Harlow Solid Italic":14,Harrington:16,"Headline R":21,HGGothicE:15,HGGothicM:15,HGGyoshotai:15,HGKyokashotai:15,HGMaruGothicMPRO:22,HGMinchoB:16,HGMinchoE:16,HGPGothicE:17,HGPGothicM:18,HGPGyoshotai:15,HGPKyokashotai:14,HGPMinchoB:15,HGPMinchoE:16,HGPSoeiKakugothicUB:19,HGPSoeiKakupoptai:20,HGPSoeiPresenceEB:17,HGSeikaishotaiPRO:17,HGSGothicE:16,HGSGothicM:17,HGSGyoshotai:14,HGSKyokashotai:13,HGSMinchoB:15,HGSMinchoE:16,HGSoeiKakugothicUB:16,HGSoeiKakupoptai:16,HGSoeiPresenceEB:16,HGSSoeiKakugothicUB:18,HGSSoeiKakupoptai:19,HGSSoeiPresenceEB:16,"High Tower Text":14,"HYGothic-Extra":18,"HYGothic-Medium":17,"HYGraphic-Medium":17,"HYGungSo-Bold":17,"HYHeadLine-Medium":17,"HYMyeongJo-Extra":19,"HYPMokGak-Bold":21,"HYPost-Light":19,"HYPost-Medium":21,"HYShortSamul-Medium":11,"HYSinMyeongJo-Medium":18,Impact:16,"Imprint MT Shadow":15,"Informal Roman":16,"Ink Free":15,IrisUPC:15,"Iskoola Pota":15,JasmineUPC:13,"Javanese Text":17,Jokerman:21,"Juice ITC":11,KaiTi:15,Kalinga:16,Kartika:17,"Khmer UI":16,KodchiangUPC:10,Kokila:11,"Kristen ITC":17,"Kunstler Script":10,"Lao UI":16,Latha:15,Leelawadee:16,"Leelawadee UI":16,"Leelawadee UI Semilight":16,"Levenim MT":17,LilyUPC:13,"Lucida Bright":18,"Lucida Calligraphy":20,"Lucida Console":18,"Lucida Fax":19,"Lucida Handwriting":21,"Lucida Sans":19,"Lucida Sans Typewriter":17,"Lucida Sans Unicode":19,"Magic R":17,Magneto:22,"Maiandra GD":18,"Malgun Gothic":17,"Malgun Gothic Semilight":17,Mangal:17,Marlett:30,"Matura MT Script Capitals":20,Meiryo:20,"Meiryo UI":20,"Microsoft GothicNeo":16,"Microsoft Himalaya":11,"Microsoft JhengHei":17,"Microsoft JhengHei Light":18,"Microsoft JhengHei UI":17,"Microsoft JhengHei UI Light":18,"Microsoft New Tai Lue":17,"Microsoft PhagsPa":17,"Microsoft Sans Serif":17,"Microsoft Tai Le":17,"Microsoft Uighur":11,"Microsoft YaHei Light":18,"Microsoft YaHei UI":18,"Microsoft YaHei UI Light":18,"Microsoft Yi Baiti":16,MingLiU:16,MingLiU_HKSCS:16,"MingLiU_HKSCS-ExtB":16,"MingLiU-ExtB":16,Miriam:15,"Miriam Fixed":18,Mistral:14,"Modern No. 20":14,"MoeumT R":17,"Mongolian Baiti":16,"Monotype Corsiva":14,MoolBoran:11,"MS Gothic":15,"MS Mincho":16,"MS Outlook":16,"MS PGothic":16,"MS PMincho":16,"MS Reference Sans Serif":19,"MS Reference Specialty":36,"MS UI Gothic":16,"MT Extra":31,"MV Boli":21,"Myanmar Text":17,Narkisim:13,"Neue Haas Grotesk Text Pro":16,"New Gulim":18,"News Gothic MT":19,"Niagara Engraved":10,"Niagara Solid":10,"Nirmala UI":17,"Nirmala UI Semilight":17,Nyala:16,"OCR A Extended":19,OCRB:18,"Old English Text MT":16,Onyx:10,"Palace Script MT":10,"Palatino Linotype":15,Papyrus:18,Parchment:7,Perpetua:13,"Perpetua Titling MT":20,"Plantagenet Cherokee":16,Playbill:11,PMingLiU:15,"PMingLiU-ExtB":15,"Poor Richard":17,Pristina:15,"Pyunji R":15,Raavi:15,"Rage Italic":16,Ravie:29,Rockwell:16,"Rockwell Condensed":12,"Rockwell Extra Bold":20,"Rockwell Light":16,"Rockwell Nova":16,"Rockwell Nova Cond":16,"Rockwell Nova Cond Light":16,"Rockwell Nova Extra Bold":16,"Rockwell Nova Light":16,Rod:18,"Sakkal Majalla":12,"Sanskrit Text":18,"Script MT Bold":15,"Segoe MDL2 Assets":12,"Segoe Print":21,"Segoe Script":21,"Segoe UI":16,"Segoe UI Black":18,"Segoe UI Emoji":16,"Segoe UI Historic":16,"Segoe UI Light":15,"Segoe UI Semibold":17,"Segoe UI Semilight":16,"Segoe UI Symbol":16,Selawik:15,"Selawik Light":15,"Selawik Semibold":16,"Shonar Bangla":15,"Showcard Gothic":17,Shruti:17,"Simplified Arabic":15,"Simplified Arabic Fixed":17,"SimSun-ExtB":15,"Sitka Banner":15,"Sitka Display":15,"Sitka Heading":16,"Sitka Small":20,"Sitka Subheading":17,"Sitka Text":18,"Snap ITC":25,"Source Sans Pro":14,"Source Sans Pro Black":15,"Source Sans Pro ExtraLight":13,"Source Sans Pro Light":13,"Source Sans Pro SemiBold":14,Stencil:17,Sylfaen:15,Symbol:15,Tahoma:16,"Tempus Sans ITC":19,"TH SarabunPSK":11,"Times New Roman":15,"Traditional Arabic":14,"Trebuchet MS":15,Tunga:15,"Tw Cen MT":16,"Tw Cen MT Condensed":11,"Tw Cen MT Condensed Extra Bold":14,"UD Digi Kyokasho N-B":15,"UD Digi Kyokasho NK-B":15,"UD Digi Kyokasho NK-R":15,"UD Digi Kyokasho NP-B":21,"UD Digi Kyokasho NP-R":15,"UD Digi Kyokasho N-R":15,Univers:15,"Univers Condensed":15,"Univers Condensed Light":13,"Univers Light":15,"Urdu Typesetting":15,Utsaah:12,Vani:18,Verdana:18,"Verdana Pro":18,"Verdana Pro Black":15,"Verdana Pro Cond":15,"Verdana Pro Cond Black":15,"Verdana Pro Cond Light":15,"Verdana Pro Cond SemiBold":15,"Verdana Pro Light":15,"Verdana Pro SemiBold":15,Vijaya:12,"Viner Hand ITC":20,Vivaldi:12,"Vladimir Script":13,Vrinda:17,Webdings:29,"Wide Latin":36,Wingdings:39,"Wingdings 2":33,"Wingdings 3":26,"Yet R":16,"Yu Gothic":16,"Yu Gothic Light":16,"Yu Gothic Medium":16,"Yu Gothic UI":16,"Yu Gothic UI Light":15,"Yu Gothic UI Semibold":17,"Yu Gothic UI Semilight":16,"Yu Mincho":16,"Yu Mincho Demibold":15,"Yu Mincho Light":15,"\u4eff\u5b8b":15,"\u534e\u6587\u4e2d\u5b8b":18,"\u534e\u6587\u4eff\u5b8b":14,"\u534e\u6587\u5b8b\u4f53":14,"\u534e\u6587\u5f69\u4e91":16,"\u534e\u6587\u65b0\u9b4f":17,"\u534e\u6587\u6977\u4f53":14,"\u534e\u6587\u7425\u73c0":16,"\u534e\u6587\u7ec6\u9ed1":16,"\u534e\u6587\u884c\u6977":15,"\u534e\u6587\u96b6\u4e66":13,"\u5b8b\u4f53":15,"\u5e7c\u5706":15,"\u5fae\u8f6f\u96c5\u9ed1":17,"\u5fae\u8f6f\u96c5\u9ed1 Light":17,"\u65b0\u5b8b\u4f53":15,"\u65b9\u6b63\u59da\u4f53":15,"\u65b9\u6b63\u8212\u4f53":16,"\u6977\u4f53":15,"\u7b49\u7ebf":15,"\u7b49\u7ebf Light":15,"\u96b6\u4e66":15,"\u9ed1\u4f53":15,"\u6e38\u30b4\u30b7\u30c3\u30af":16,"\uff2d\uff33 \uff30\u660e\u671d":15,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':15,"\u30e1\u30a4\u30ea\u30aa":18,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":15,"HG\u660e\u671dB":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":15},24:{"Gill Sans MT":16,Abadi:19,"Abadi Extra Light":18,"Agency FB":14,Aharoni:13,Aldhabi:10,Algerian:19,"Ami R":13,"Angsana New":11,AngsanaUPC:11,Aparajita:13,"Arabic Typesetting":11,Arial:18,"Arial Black":21,"Arial Narrow":15,"Arial Nova":18,"Arial Nova Cond":16,"Arial Nova Cond Light":14,"Arial Nova Light":18,"Arial Rounded MT Bold":19,"Baskerville Old Face":16,Batang:19,BatangChe:16,"Bauhaus 93":18,"Bell MT":16,Bembo:16,"Berlin Sans FB":19,"Berlin Sans FB Demi":20,"Bernard MT Condensed":16,"Blackadder ITC":13,"Bodoni MT":16,"Bodoni MT Black":21,"Bodoni MT Condensed":11,"Bodoni MT Poster Compressed":9,"Book Antiqua":16,"Bookman Old Style":20,"Bookshelf Symbol 7":24,"Bradley Hand ITC":21,"Britannic Bold":20,Broadway:21,"Browallia New":12,BrowalliaUPC:12,"Brush Script MT":16,Calibri:16,"Calibri Light":16,"Californian FB":17,"Calisto MT":16,Cambria:18,"Cambria Math":18,Candara:18,Castellar:23,Centaur:16,Century:18,"Century Gothic":18,"Century Schoolbook":18,Chiller:15,"Colonna MT":16,"Comic Sans MS":20,Consolas:18,Constantia:17,"Cooper Black":19,"Copperplate Gothic Bold":23,"Copperplate Gothic Light":23,Corbel:17,"Cordia New":12,CordiaUPC:12,"Courier New":19,"Curlz MT":17,Dante:14,DaunPenh:11,David:14,DilleniaUPC:10,DokChampa:18,Dotum:19,DotumChe:16,Dubai:17,"Dubai Light":17,"Dubai Medium":17,Ebrima:17,"Edwardian Script ITC":15,Elephant:24,"Engravers MT":21,"Eras Bold ITC":21,"Eras Demi ITC":20,"Eras Light ITC":17,"Eras Medium ITC":18,EucrosiaUPC:13,Euphemia:19,"Expo M":28,FangSong:16,"Felix Titling":19,"Footlight MT Light":18,Forte:17,"Franklin Gothic Book":19,"Franklin Gothic Demi":19,"Franklin Gothic Demi Cond":16,"Franklin Gothic Heavy":19,"Franklin Gothic Medium":19,"Franklin Gothic Medium Cond":16,FrankRuehl:13,FreesiaUPC:14,"Freestyle Script":12,"French Script MT":12,Gabriola:13,Gadugi:17,Garamond:15,Gautami:19,Georgia:20,"Georgia Pro":18,"Georgia Pro Black":23,"Georgia Pro Cond":17,"Georgia Pro Cond Black":20,"Georgia Pro Cond Light":16,"Georgia Pro Cond Semibold":18,"Georgia Pro Light":18,"Georgia Pro Semibold":20,Gigi:17,"Gill Sans MT Condensed":12,"Gill Sans MT Ext Condensed Bold":11,"Gill Sans Nova":16,"Gill Sans Nova Cond":11,"Gill Sans Nova Cond Lt":10,"Gill Sans Nova Cond Ultra Bold":19,"Gill Sans Nova Cond XBd":17,"Gill Sans Nova Light":16,"Gill Sans Nova Ultra Bold":27,"Gill Sans Ultra Bold":27,"Gill Sans Ultra Bold Condensed":19,Gisha:17,"Gloucester MT Extra Condensed":12,"Goudy Old Style":16,"Goudy Stout":26,Grotesque:15,"Grotesque Light":15,Gulim:18,GulimChe:16,Gungsuh:19,GungsuhChe:16,"Hadassah Friedlaender":18,Haettenschweiler:14,"Harlow Solid Italic":15,Harrington:18,"Headline R":23,HGGothicE:16,HGGothicM:16,HGGyoshotai:16,HGKyokashotai:16,HGMaruGothicMPRO:24,HGMinchoB:17,HGMinchoE:17,HGPGothicE:18,HGPGothicM:20,HGPGyoshotai:16,HGPKyokashotai:16,HGPMinchoB:16,HGPMinchoE:18,HGPSoeiKakugothicUB:21,HGPSoeiKakupoptai:22,HGPSoeiPresenceEB:19,HGSeikaishotaiPRO:19,HGSGothicE:17,HGSGothicM:19,HGSGyoshotai:15,HGSKyokashotai:15,HGSMinchoB:16,HGSMinchoE:18,HGSoeiKakugothicUB:17,HGSoeiKakupoptai:17,HGSoeiPresenceEB:17,HGSSoeiKakugothicUB:20,HGSSoeiKakupoptai:21,HGSSoeiPresenceEB:18,"High Tower Text":15,"HYGothic-Extra":20,"HYGothic-Medium":19,"HYGraphic-Medium":19,"HYGungSo-Bold":19,"HYHeadLine-Medium":19,"HYMyeongJo-Extra":21,"HYPMokGak-Bold":23,"HYPost-Light":21,"HYPost-Medium":23,"HYShortSamul-Medium":12,"HYSinMyeongJo-Medium":20,Impact:17,"Imprint MT Shadow":16,"Informal Roman":17,"Ink Free":16,IrisUPC:16,"Iskoola Pota":16,JasmineUPC:15,"Javanese Text":19,Jokerman:23,"Juice ITC":11,KaiTi:16,Kalinga:18,Kartika:18,"Khmer UI":17,KodchiangUPC:11,Kokila:12,"Kristen ITC":19,"Kunstler Script":11,"Lao UI":17,Latha:16,Leelawadee:17,"Leelawadee UI":17,"Leelawadee UI Semilight":18,"Levenim MT":18,LilyUPC:14,"Lucida Bright":19,"Lucida Calligraphy":22,"Lucida Console":20,"Lucida Fax":21,"Lucida Handwriting":23,"Lucida Sans":21,"Lucida Sans Typewriter":19,"Lucida Sans Unicode":21,"Magic R":19,Magneto:25,"Maiandra GD":20,"Malgun Gothic":19,"Malgun Gothic Semilight":19,Mangal:18,Marlett:33,"Matura MT Script Capitals":22,Meiryo:22,"Meiryo UI":22,"Microsoft GothicNeo":17,"Microsoft Himalaya":12,"Microsoft JhengHei":19,"Microsoft JhengHei Light":19,"Microsoft JhengHei UI":19,"Microsoft JhengHei UI Light":19,"Microsoft New Tai Lue":18,"Microsoft PhagsPa":18,"Microsoft Sans Serif":19,"Microsoft Tai Le":18,"Microsoft Uighur":12,"Microsoft YaHei Light":19,"Microsoft YaHei UI":20,"Microsoft YaHei UI Light":19,"Microsoft Yi Baiti":17,MingLiU:17,MingLiU_HKSCS:17,"MingLiU_HKSCS-ExtB":17,"MingLiU-ExtB":17,Miriam:16,"Miriam Fixed":20,Mistral:15,"Modern No. 20":16,"MoeumT R":19,"Mongolian Baiti":17,"Monotype Corsiva":15,MoolBoran:12,"MS Gothic":16,"MS Mincho":17,"MS Outlook":17,"MS PGothic":17,"MS PMincho":17,"MS Reference Sans Serif":21,"MS Reference Specialty":39,"MS UI Gothic":17,"MT Extra":34,"MV Boli":23,"Myanmar Text":18,Narkisim:14,"Neue Haas Grotesk Text Pro":17,"New Gulim":19,"News Gothic MT":21,"Niagara Engraved":11,"Niagara Solid":11,"Nirmala UI":18,"Nirmala UI Semilight":19,Nyala:17,"OCR A Extended":20,OCRB:20,"Old English Text MT":17,Onyx:10,"Palace Script MT":11,"Palatino Linotype":16,Papyrus:20,Parchment:8,Perpetua:15,"Perpetua Titling MT":22,"Plantagenet Cherokee":18,Playbill:12,PMingLiU:16,"PMingLiU-ExtB":16,"Poor Richard":19,Pristina:16,"Pyunji R":17,Raavi:16,"Rage Italic":18,Ravie:31,Rockwell:17,"Rockwell Condensed":14,"Rockwell Extra Bold":22,"Rockwell Light":18,"Rockwell Nova":17,"Rockwell Nova Cond":17,"Rockwell Nova Cond Light":17,"Rockwell Nova Extra Bold":17,"Rockwell Nova Light":17,Rod:20,"Sakkal Majalla":13,"Sanskrit Text":19,"Script MT Bold":17,"Segoe MDL2 Assets":13,"Segoe Print":23,"Segoe Script":23,"Segoe UI":17,"Segoe UI Black":20,"Segoe UI Emoji":17,"Segoe UI Historic":17,"Segoe UI Light":16,"Segoe UI Semibold":18,"Segoe UI Semilight":17,"Segoe UI Symbol":17,Selawik:17,"Selawik Light":17,"Selawik Semibold":18,"Shonar Bangla":13,"Showcard Gothic":19,Shruti:19,"Simplified Arabic":17,"Simplified Arabic Fixed":19,"SimSun-ExtB":16,"Sitka Banner":16,"Sitka Display":17,"Sitka Heading":18,"Sitka Small":22,"Sitka Subheading":19,"Sitka Text":20,"Snap ITC":28,"Source Sans Pro":15,"Source Sans Pro Black":17,"Source Sans Pro ExtraLight":15,"Source Sans Pro Light":15,"Source Sans Pro SemiBold":16,Stencil:18,Sylfaen:16,Symbol:16,Tahoma:17,"Tempus Sans ITC":21,"TH SarabunPSK":12,"Times New Roman":16,"Traditional Arabic":16,"Trebuchet MS":17,Tunga:17,"Tw Cen MT":18,"Tw Cen MT Condensed":12,"Tw Cen MT Condensed Extra Bold":16,"UD Digi Kyokasho N-B":16,"UD Digi Kyokasho NK-B":16,"UD Digi Kyokasho NK-R":16,"UD Digi Kyokasho NP-B":23,"UD Digi Kyokasho NP-R":16,"UD Digi Kyokasho N-R":16,Univers:16,"Univers Condensed":16,"Univers Condensed Light":14,"Univers Light":16,"Urdu Typesetting":16,Utsaah:13,Vani:20,Verdana:20,"Verdana Pro":20,"Verdana Pro Black":16,"Verdana Pro Cond":16,"Verdana Pro Cond Black":16,"Verdana Pro Cond Light":16,"Verdana Pro Cond SemiBold":16,"Verdana Pro Light":16,"Verdana Pro SemiBold":16,Vijaya:13,"Viner Hand ITC":22,Vivaldi:14,"Vladimir Script":15,Vrinda:18,Webdings:32,"Wide Latin":40,Wingdings:43,"Wingdings 2":36,"Wingdings 3":29,"Yet R":17,"Yu Gothic":18,"Yu Gothic Light":17,"Yu Gothic Medium":18,"Yu Gothic UI":17,"Yu Gothic UI Light":17,"Yu Gothic UI Semibold":18,"Yu Gothic UI Semilight":18,"Yu Mincho":17,"Yu Mincho Demibold":17,"Yu Mincho Light":16,"\u4eff\u5b8b":16,"\u534e\u6587\u4e2d\u5b8b":20,"\u534e\u6587\u4eff\u5b8b":15,"\u534e\u6587\u5b8b\u4f53":15,"\u534e\u6587\u5f69\u4e91":18,"\u534e\u6587\u65b0\u9b4f":19,"\u534e\u6587\u6977\u4f53":15,"\u534e\u6587\u7425\u73c0":18,"\u534e\u6587\u7ec6\u9ed1":18,"\u534e\u6587\u884c\u6977":16,"\u534e\u6587\u96b6\u4e66":14,"\u5b8b\u4f53":16,"\u5e7c\u5706":16,"\u5fae\u8f6f\u96c5\u9ed1":19,"\u5fae\u8f6f\u96c5\u9ed1 Light":18,"\u65b0\u5b8b\u4f53":16,"\u65b9\u6b63\u59da\u4f53":16,"\u65b9\u6b63\u8212\u4f53":18,"\u6977\u4f53":16,"\u7b49\u7ebf":17,"\u7b49\u7ebf Light":16,"\u96b6\u4e66":16,"\u9ed1\u4f53":16,"\u6e38\u30b4\u30b7\u30c3\u30af":18,"\uff2d\uff33 \uff30\u660e\u671d":16,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':16,"\u30e1\u30a4\u30ea\u30aa":20,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":16,"HG\u660e\u671dB":16,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":16}},f.unknownFontMaxDigitWidthMap={},U.pixelToPoint=function(t){return 72*t/96},U.pointToPixel=function(t,e){return En(96*t/72,e=void 0===e?2:e)},U.setMaxDigitWidth=function(t){var e,n,i,r,o,a,s,u,c,e=0;try{if((n=$t("span")).style.font=t,i=n.style.fontSize,r=void 0,-1!==i.indexOf("px")?r=M(U.pixelToPoint(parseFloat(i))):-1!==i.indexOf("pt")&&(r=M(parseFloat(i))),!isNaN(r)&&r||(r=-1!==t.indexOf("pt")?Math.round(parseFloat(t.match(/(\d|\.)+/)+"")):M(U.pixelToPoint(parseFloat(t.match(/(\d|\.)+/)+"")))),(o=n.style.fontFamily)||t.split(" ").forEach(function(t){"normal"!==t&&"italic"!==t&&"bold"!==t&&-1===t.indexOf("px")&&-1===t.indexOf("pt")&&isNaN(+t)&&(o=t)}),!o||'"'!==o[0]&&"'"!==o[0]||(o=o.slice(1,o.length-1)),f.unknownFontMaxDigitWidthMap[r]&&f.unknownFontMaxDigitWidthMap[r][o]?e=f.unknownFontMaxDigitWidthMap[r][o]:Kt[r]&&Kt[r][o]&&(e=Kt[r][o]),0<e)return void(U.maxDigitWidth=M(e))}catch(t){}for(a="0123456789",s=0,(u=Ke()).font=t,c=0;c<a.length;c++)e<(s=u.measureText(a.charAt(c)).width)&&(e=s);return U.maxDigitWidth=0<e?M(e):U.maxDigitWidth},U.defaultColumnWidthToPixel=function(t){var e,t,e=2*Math.ceil(U.maxDigitWidth/4)+1,t=U.columnWidthToPixel(t)+e;return 8*Math.ceil(t/8)},U.columnWidthToPixel=function(t){return 0===t?0:Math.floor(Math.floor(256*t)/256*U.maxDigitWidth+.5)},U.pixelToColumnWidth=function(t){var e,t;return 0===t?0:(e=U.maxDigitWidth,t=Math.floor((t-5)/e*100+.5)/100,Math.floor((t*e+5)/e*256)/256)},U.maxDigitWidth=7,f.SJSColumnWidthHelper=U,Hn.prototype.equals=function(t){var e=this;return e===t||!!t&&e.numberFormatId===t.numberFormatId&&e.numberFormatCode===t.numberFormatCode},Hn.prototype.compose=function(t){var e=this;e.numberFormatId===b&&(e.numberFormatId=t.numberFormatId),e.numberFormatCode===b&&(e.numberFormatCode=t.numberFormatCode)},Hn.prototype.clone=function(){var t=this;return new Hn(t.numberFormatId,t.numberFormatCode)},f.ExcelNumerFormat=Hn,f.AL=Fn,f.resetFillStyle=_n,f.i2e=An,f.rangeToFormula=Ln,f.RF=Dn,a.isBase64ImageStr=function(t){return"string"==typeof t&&a.BASE64_IMAGE_REGULAR.test(t)},a.isSVGBase64ImageStr=function(t){return"string"==typeof t&&0===t.indexOf(a.SVG_IMAGE_DATA_URL_PREFIX)},a.isVectorBase64ImageStr=function(t){return a.isSVGBase64ImageStr(t)},a.loadImageElement=function(e,n,i){var r=new D.Wh(function(){var t;r.qh(e)&&(t=r.getImage(e))?n(t):i&&i(),r.L0(),r=b});r.addImage(e,"anonymous")},a.loadBase64ImageByUrl=function(t,i,r){a.loadImageElement(t,function(t){var e,n,e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0);try{n=e.toDataURL(),i(n)}catch(t){r&&r()}},r)},a.BASE64_IMAGE_REGULAR=/^data:image\/(.*);base64,(.*)$/,a.SVG_IMAGE_DATA_URL_PREFIX="data:image/svg+xml;base64,",f.oCe=a,f.handleRestoredTableResizedArgs=jn},"./dist/core/util/crypto.js":function(t,e){"use strict";var n,u,c,p,i,f,r,et,l,o,a,h,s,d,v,g;function m(t,e){this.bits=t,this.init(e)}function S(t,e,n){var i,r,o,a,s,i=this;for(128<t.length&&(t=new l(e,!0).update(t).digest()),r=[],o=[],a=0;a<128;++a)s=t[a]||0,r[a]=92^s,o[a]=54^s;return(i=g.call(this,e,n)||this).update(o),i.oKeyPad=r,i.inner=!0,i.sharedMemory=n,i}for(n=this&&this.__extends||(v=function(t,e){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Object.defineProperty(e,"__esModule",{value:!0}),e.e1e=e.i1e=e.Qoe=void 0,u="input is invalid type",c="finalize already called",p="0123456789abcdef".split(""),i=[],f=[24,16,8,0],r=[-2147483648,8388608,32768,128],et=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],m.prototype.init=function(t){t?(i[0]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=i[16]=i[17]=i[18]=i[19]=i[20]=i[21]=i[22]=i[23]=i[24]=i[25]=i[26]=i[27]=i[28]=i[29]=i[30]=i[31]=i[32]=0,this.blocks=i):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var t=this.bits;384===t?(this.h0h=3418070365,this.h0l=3238371032,this.h1h=1654270250,this.h1l=914150663,this.h2h=2438529370,this.h2l=812702999,this.h3h=355462360,this.h3l=4144912697,this.h4h=1731405415,this.h4l=4290775857,this.h5h=2394180231,this.h5l=1750603025,this.h6h=3675008525,this.h6l=1694076839,this.h7h=1203062813,this.h7l=3204075428):256===t?(this.h0h=573645204,this.h0l=4230739756,this.h1h=2673172387,this.h1l=3360449730,this.h2h=596883563,this.h2l=1867755857,this.h3h=2520282905,this.h3l=1497426621,this.h4h=2519219938,this.h4l=2827943907,this.h5h=3193839141,this.h5l=1401305490,this.h6h=721525244,this.h6l=746961066,this.h7h=246885852,this.h7l=2177182882):224===t?(this.h0h=2352822216,this.h0l=424955298,this.h1h=1944164710,this.h1l=2312950998,this.h2h=502970286,this.h2l=855612546,this.h3h=1738396948,this.h3l=1479516111,this.h4h=258812777,this.h4l=2077511080,this.h5h=2011393907,this.h5l=79989058,this.h6h=1067287976,this.h6l=1780299464,this.h7h=286451373,this.h7l=2446758561):(this.h0h=1779033703,this.h0l=4089235720,this.h1h=3144134277,this.h1l=2227873595,this.h2h=1013904242,this.h2l=4271175723,this.h3h=2773480762,this.h3l=1595750129,this.h4h=1359893119,this.h4l=2917565137,this.h5h=2600822924,this.h5l=725511199,this.h6h=528734635,this.h6l=4215389547,this.h7h=1541459225,this.h7l=327033209),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1},m.prototype.update=function(t){var e,n,i,r,o,a,s;if(this.finalized)throw new Error(c);if("string"!=(n=typeof t)){if("object"!=n)throw new Error(u);if(null===t)throw new Error(u);if(!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error(u);e=!0}for(r=0,a=t.length,s=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=s[16]=s[17]=s[18]=s[19]=s[20]=s[21]=s[22]=s[23]=s[24]=s[25]=s[26]=s[27]=s[28]=s[29]=s[30]=s[31]=s[32]=0),e)for(o=this.start;r<a&&o<128;++r)s[o>>2]|=t[r]<<f[3&o++];else for(o=this.start;r<a&&o<128;++r)(i=t.charCodeAt(r))<128?s[o>>2]|=i<<f[3&o++]:(i<2048?s[o>>2]|=(192|i>>6)<<f[3&o++]:(i<55296||57344<=i?s[o>>2]|=(224|i>>12)<<f[3&o++]:(i=65536+((1023&i)<<10|1023&t.charCodeAt(++r)),s[o>>2]|=(240|i>>18)<<f[3&o++],s[o>>2]|=(128|i>>12&63)<<f[3&o++]),s[o>>2]|=(128|i>>6&63)<<f[3&o++]),s[o>>2]|=(128|63&i)<<f[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,128<=o?(this.block=s[32],this.start=o-128,this.hash(),this.hashed=!0):this.start=o}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this},m.prototype.finalize=function(){var t,e;this.finalized||(this.finalized=!0,t=this.blocks,e=this.lastByteIndex,t[32]=this.block,t[e>>2]|=r[3&e],this.block=t[32],112<=e&&(this.hashed||this.hash(),t[0]=this.block,t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=t[16]=t[17]=t[18]=t[19]=t[20]=t[21]=t[22]=t[23]=t[24]=t[25]=t[26]=t[27]=t[28]=t[29]=t[30]=t[31]=t[32]=0),t[30]=this.hBytes<<3|this.bytes>>>29,t[31]=this.bytes<<3,this.hash())},m.prototype.hash=function(){for(var F,_,A,L,D,j,O,V,Y,K,z,W,J,Z,Q,X,t,e,n,i,r,o,a,s,u,c,f,l,q,f,l,q,$,tt,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,E,H,U,F=this.h0h,_=this.h0l,A=this.h1h,L=this.h1l,D=this.h2h,j=this.h2l,O=this.h3h,V=this.h3l,Y=this.h4h,K=this.h4l,z=this.h5h,W=this.h5l,J=this.h6h,Z=this.h6l,Q=this.h7h,X=this.h7l,t=this.blocks,e=32;e<160;e+=2)n=((v=t[e-30])>>>1|(g=t[e-29])<<31)^(v>>>8|g<<24)^v>>>7,i=(g>>>1|v<<31)^(g>>>8|v<<24)^(g>>>7|v<<25),r=((v=t[e-4])>>>19|(g=t[e-3])<<13)^(g>>>29|v<<3)^v>>>6,o=(g>>>19|v<<13)^(v>>>29|g<<3)^(g>>>6|v<<26),v=t[e-32],g=t[e-31],m=t[e-14],p=t[e-13],t[e]=(c=(m>>>16)+(v>>>16)+(n>>>16)+(r>>>16)+((u=(65535&m)+(65535&v)+(65535&n)+(65535&r)+((s=(p>>>16)+(g>>>16)+(i>>>16)+(o>>>16)+((a=(65535&p)+(65535&g)+(65535&i)+(65535&o))>>>16))>>>16))>>>16))<<16|65535&u,t[e+1]=s<<16|65535&a;for(b=F,C=_,x=O,G=V,B=Y,I=K,P=z,R=W,N=J,E=Z,H=Q,U=X,$=(y=A)&(k=D),tt=(M=L)&(T=j),e=0;e<160;e+=8)v=t[e],g=t[e+1],v=(c=((m=et[e])>>>16)+(v>>>16)+((S=B&P^~B&N)>>>16)+((r=(B>>>14|I<<18)^(B>>>18|I<<14)^(I>>>9|B<<23))>>>16)+(H>>>16)+((u=(65535&m)+(65535&v)+(65535&S)+(65535&r)+(65535&H)+((s=((p=et[e+1])>>>16)+(g>>>16)+((w=I&R^~I&E)>>>16)+((o=(I>>>14|B<<18)^(I>>>18|B<<14)^(B>>>9|I<<23))>>>16)+(U>>>16)+((a=(65535&p)+(65535&g)+(65535&w)+(65535&o)+(65535&U))>>>16))>>>16))>>>16))<<16|65535&u,g=s<<16|65535&a,m=(c=((h=(f=b&y)^b&k^$)>>>16)+((n=(b>>>28|C<<4)^(C>>>2|b<<30)^(C>>>7|b<<25))>>>16)+((u=(65535&h)+(65535&n)+((s=((d=(l=C&M)^C&T^tt)>>>16)+((i=(C>>>28|b<<4)^(b>>>2|C<<30)^(b>>>7|C<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&u,p=s<<16|65535&a,H=(c=(x>>>16)+(v>>>16)+((u=(65535&x)+(65535&v)+((s=(G>>>16)+(g>>>16)+((a=(65535&G)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,U=s<<16|65535&a,x=(c=(m>>>16)+(v>>>16)+((u=(65535&m)+(65535&v)+((s=(p>>>16)+(g>>>16)+((a=(65535&p)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,G=s<<16|65535&a,v=t[e+2],g=t[e+3],v=(c=((m=et[e+2])>>>16)+(v>>>16)+((S=H&B^~H&P)>>>16)+((r=(H>>>14|U<<18)^(H>>>18|U<<14)^(U>>>9|H<<23))>>>16)+(N>>>16)+((u=(65535&m)+(65535&v)+(65535&S)+(65535&r)+(65535&N)+((s=((p=et[e+3])>>>16)+(g>>>16)+((w=U&I^~U&R)>>>16)+((o=(U>>>14|H<<18)^(U>>>18|H<<14)^(H>>>9|U<<23))>>>16)+(E>>>16)+((a=(65535&p)+(65535&g)+(65535&w)+(65535&o)+(65535&E))>>>16))>>>16))>>>16))<<16|65535&u,g=s<<16|65535&a,m=(c=((h=(q=x&b)^x&y^f)>>>16)+((n=(x>>>28|G<<4)^(G>>>2|x<<30)^(G>>>7|x<<25))>>>16)+((u=(65535&h)+(65535&n)+((s=((d=(f=G&C)^G&M^l)>>>16)+((i=(G>>>28|x<<4)^(x>>>2|G<<30)^(x>>>7|G<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&u,p=s<<16|65535&a,N=(c=(k>>>16)+(v>>>16)+((u=(65535&k)+(65535&v)+((s=(T>>>16)+(g>>>16)+((a=(65535&T)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,E=s<<16|65535&a,k=(c=(m>>>16)+(v>>>16)+((u=(65535&m)+(65535&v)+((s=(p>>>16)+(g>>>16)+((a=(65535&p)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,T=s<<16|65535&a,v=t[e+4],g=t[e+5],v=(c=((m=et[e+4])>>>16)+(v>>>16)+((S=N&H^~N&B)>>>16)+((r=(N>>>14|E<<18)^(N>>>18|E<<14)^(E>>>9|N<<23))>>>16)+(P>>>16)+((u=(65535&m)+(65535&v)+(65535&S)+(65535&r)+(65535&P)+((s=((p=et[e+5])>>>16)+(g>>>16)+((w=E&U^~E&I)>>>16)+((o=(E>>>14|N<<18)^(E>>>18|N<<14)^(N>>>9|E<<23))>>>16)+(R>>>16)+((a=(65535&p)+(65535&g)+(65535&w)+(65535&o)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&u,g=s<<16|65535&a,m=(c=((h=(l=k&x)^k&b^q)>>>16)+((n=(k>>>28|T<<4)^(T>>>2|k<<30)^(T>>>7|k<<25))>>>16)+((u=(65535&h)+(65535&n)+((s=((d=(q=T&G)^T&C^f)>>>16)+((i=(T>>>28|k<<4)^(k>>>2|T<<30)^(k>>>7|T<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&u,p=s<<16|65535&a,P=(c=(y>>>16)+(v>>>16)+((u=(65535&y)+(65535&v)+((s=(M>>>16)+(g>>>16)+((a=(65535&M)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,R=s<<16|65535&a,y=(c=(m>>>16)+(v>>>16)+((u=(65535&m)+(65535&v)+((s=(p>>>16)+(g>>>16)+((a=(65535&p)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,M=s<<16|65535&a,v=t[e+6],g=t[e+7],v=(c=((m=et[e+6])>>>16)+(v>>>16)+((S=P&N^~P&H)>>>16)+((r=(P>>>14|R<<18)^(P>>>18|R<<14)^(R>>>9|P<<23))>>>16)+(B>>>16)+((u=(65535&m)+(65535&v)+(65535&S)+(65535&r)+(65535&B)+((s=((p=et[e+7])>>>16)+(g>>>16)+((w=R&E^~R&U)>>>16)+((o=(R>>>14|P<<18)^(R>>>18|P<<14)^(P>>>9|R<<23))>>>16)+(I>>>16)+((a=(65535&p)+(65535&g)+(65535&w)+(65535&o)+(65535&I))>>>16))>>>16))>>>16))<<16|65535&u,g=s<<16|65535&a,m=(c=((h=($=y&k)^y&x^l)>>>16)+((n=(y>>>28|M<<4)^(M>>>2|y<<30)^(M>>>7|y<<25))>>>16)+((u=(65535&h)+(65535&n)+((s=((d=(tt=M&T)^M&G^q)>>>16)+((i=(M>>>28|y<<4)^(y>>>2|M<<30)^(y>>>7|M<<25))>>>16)+((a=(65535&d)+(65535&i))>>>16))>>>16))>>>16))<<16|65535&u,p=s<<16|65535&a,B=(c=(b>>>16)+(v>>>16)+((u=(65535&b)+(65535&v)+((s=(C>>>16)+(g>>>16)+((a=(65535&C)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,I=s<<16|65535&a,b=(c=(m>>>16)+(v>>>16)+((u=(65535&m)+(65535&v)+((s=(p>>>16)+(g>>>16)+((a=(65535&p)+(65535&g))>>>16))>>>16))>>>16))<<16|65535&u,C=s<<16|65535&a;this.h0h=(c=(F>>>16)+(b>>>16)+((u=(65535&F)+(65535&b)+((s=(_>>>16)+(C>>>16)+((a=(65535&_)+(65535&C))>>>16))>>>16))>>>16))<<16|65535&u,this.h0l=s<<16|65535&a,this.h1h=(c=(A>>>16)+(y>>>16)+((u=(65535&A)+(65535&y)+((s=(L>>>16)+(M>>>16)+((a=(65535&L)+(65535&M))>>>16))>>>16))>>>16))<<16|65535&u,this.h1l=s<<16|65535&a,this.h2h=(c=(D>>>16)+(k>>>16)+((u=(65535&D)+(65535&k)+((s=(j>>>16)+(T>>>16)+((a=(65535&j)+(65535&T))>>>16))>>>16))>>>16))<<16|65535&u,this.h2l=s<<16|65535&a,this.h3h=(c=(O>>>16)+(x>>>16)+((u=(65535&O)+(65535&x)+((s=(V>>>16)+(G>>>16)+((a=(65535&V)+(65535&G))>>>16))>>>16))>>>16))<<16|65535&u,this.h3l=s<<16|65535&a,this.h4h=(c=(Y>>>16)+(B>>>16)+((u=(65535&Y)+(65535&B)+((s=(K>>>16)+(I>>>16)+((a=(65535&K)+(65535&I))>>>16))>>>16))>>>16))<<16|65535&u,this.h4l=s<<16|65535&a,this.h5h=(c=(z>>>16)+(P>>>16)+((u=(65535&z)+(65535&P)+((s=(W>>>16)+(R>>>16)+((a=(65535&W)+(65535&R))>>>16))>>>16))>>>16))<<16|65535&u,this.h5l=s<<16|65535&a,this.h6h=(c=(J>>>16)+(N>>>16)+((u=(65535&J)+(65535&N)+((s=(Z>>>16)+(E>>>16)+((a=(65535&Z)+(65535&E))>>>16))>>>16))>>>16))<<16|65535&u,this.h6l=s<<16|65535&a,this.h7h=(c=(Q>>>16)+(H>>>16)+((u=(65535&Q)+(65535&H)+((s=(X>>>16)+(U>>>16)+((a=(65535&X)+(65535&U))>>>16))>>>16))>>>16))<<16|65535&u,this.h7l=s<<16|65535&a},m.prototype.hex=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,t;return this.finalize(),t=this.h0h,e=this.h0l,n=this.h1h,i=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,s=this.h3l,u=this.h4h,c=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,v=this.h7h,g=this.h7l,m=this.bits,t=p[t>>28&15]+p[t>>24&15]+p[t>>20&15]+p[t>>16&15]+p[t>>12&15]+p[t>>8&15]+p[t>>4&15]+p[15&t]+p[e>>28&15]+p[e>>24&15]+p[e>>20&15]+p[e>>16&15]+p[e>>12&15]+p[e>>8&15]+p[e>>4&15]+p[15&e]+p[n>>28&15]+p[n>>24&15]+p[n>>20&15]+p[n>>16&15]+p[n>>12&15]+p[n>>8&15]+p[n>>4&15]+p[15&n]+p[i>>28&15]+p[i>>24&15]+p[i>>20&15]+p[i>>16&15]+p[i>>12&15]+p[i>>8&15]+p[i>>4&15]+p[15&i]+p[r>>28&15]+p[r>>24&15]+p[r>>20&15]+p[r>>16&15]+p[r>>12&15]+p[r>>8&15]+p[r>>4&15]+p[15&r]+p[o>>28&15]+p[o>>24&15]+p[o>>20&15]+p[o>>16&15]+p[o>>12&15]+p[o>>8&15]+p[o>>4&15]+p[15&o]+p[a>>28&15]+p[a>>24&15]+p[a>>20&15]+p[a>>16&15]+p[a>>12&15]+p[a>>8&15]+p[a>>4&15]+p[15&a],256<=m&&(t+=p[s>>28&15]+p[s>>24&15]+p[s>>20&15]+p[s>>16&15]+p[s>>12&15]+p[s>>8&15]+p[s>>4&15]+p[15&s]),384<=m&&(t+=p[u>>28&15]+p[u>>24&15]+p[u>>20&15]+p[u>>16&15]+p[u>>12&15]+p[u>>8&15]+p[u>>4&15]+p[15&u]+p[c>>28&15]+p[c>>24&15]+p[c>>20&15]+p[c>>16&15]+p[c>>12&15]+p[c>>8&15]+p[c>>4&15]+p[15&c]+p[f>>28&15]+p[f>>24&15]+p[f>>20&15]+p[f>>16&15]+p[f>>12&15]+p[f>>8&15]+p[f>>4&15]+p[15&f]+p[l>>28&15]+p[l>>24&15]+p[l>>20&15]+p[l>>16&15]+p[l>>12&15]+p[l>>8&15]+p[l>>4&15]+p[15&l]),512===m&&(t+=p[h>>28&15]+p[h>>24&15]+p[h>>20&15]+p[h>>16&15]+p[h>>12&15]+p[h>>8&15]+p[h>>4&15]+p[15&h]+p[d>>28&15]+p[d>>24&15]+p[d>>20&15]+p[d>>16&15]+p[d>>12&15]+p[d>>8&15]+p[d>>4&15]+p[15&d]+p[v>>28&15]+p[v>>24&15]+p[v>>20&15]+p[v>>16&15]+p[v>>12&15]+p[v>>8&15]+p[v>>4&15]+p[15&v]+p[g>>28&15]+p[g>>24&15]+p[g>>20&15]+p[g>>16&15]+p[g>>12&15]+p[g>>8&15]+p[g>>4&15]+p[15&g]),t},m.prototype.digest=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,e,t;return this.finalize(),t=this.h0h,e=this.h0l,n=this.h1h,i=this.h1l,r=this.h2h,o=this.h2l,a=this.h3h,s=this.h3l,u=this.h4h,c=this.h4l,f=this.h5h,l=this.h5l,h=this.h6h,d=this.h6l,v=this.h7h,g=this.h7l,t=[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a],256<=(e=this.bits)&&t.push(s>>24&255,s>>16&255,s>>8&255,255&s),384<=e&&t.push(u>>24&255,u>>16&255,u>>8&255,255&u,c>>24&255,c>>16&255,c>>8&255,255&c,f>>24&255,f>>16&255,f>>8&255,255&f,l>>24&255,l>>16&255,l>>8&255,255&l),512===e&&t.push(h>>24&255,h>>16&255,h>>8&255,255&h,d>>24&255,d>>16&255,d>>8&255,255&d,v>>24&255,v>>16&255,v>>8&255,255&v,g>>24&255,g>>16&255,g>>8&255,255&g),t},m.prototype.arrayBuffer=function(){var t,e,n;return this.finalize(),t=this.bits,e=new ArrayBuffer(t/8),(n=new DataView(e)).setUint32(0,this.h0h),n.setUint32(4,this.h0l),n.setUint32(8,this.h1h),n.setUint32(12,this.h1l),n.setUint32(16,this.h2h),n.setUint32(20,this.h2l),n.setUint32(24,this.h3h),256<=t&&n.setUint32(28,this.h3l),384<=t&&(n.setUint32(32,this.h4h),n.setUint32(36,this.h4l),n.setUint32(40,this.h5h),n.setUint32(44,this.h5l)),512===t&&(n.setUint32(48,this.h6h),n.setUint32(52,this.h6l),n.setUint32(56,this.h7h),n.setUint32(60,this.h7l)),e},m.prototype.clone=function(){var t=new m(this.bits,!1);return this.copyTo(t),t},m.prototype.copyTo=function(t){for(var e,n=["h0h","h0l","h1h","h1l","h2h","h2l","h3h","h3l","h4h","h4l","h5h","h5l","h6h","h6l","h7h","h7l","start","bytes","hBytes","finalized","hashed","lastByteIndex"],e=0;e<n.length;++e)t[n[e]]=this[n[e]];for(e=0;e<this.blocks.length;++e)t.blocks[e]=this.blocks[e]},l=m,e.i1e=l,n(S,g=l),S.prototype.finalize=function(){var t;g.prototype.finalize.call(this),this.inner&&(this.inner=!1,t=this.digest(),this.init(this.sharedMemory),this.update(this.oKeyPad),this.update(t),g.prototype.finalize.call(this))},e.e1e=S,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=new Uint8Array(255),s=0;s<a.length;s++)h[a.charCodeAt(s)]=s;function w(){}w.r1e=function(t){var e=new Uint8Array(4);return e[0]=255&t,e[1]=(65280&t)>>8,e[2]=(16711680&t)>>16,e[3]=(4278190080&t)>>24,e},w.Joe=function(t){var e,n,i,r,o,a,s,u,e,c,e=.75*t.length,n=t.length,r=0;for("="===t[t.length-1]&&(e--,"="===t[t.length-2])&&e--,e=new ArrayBuffer(e),c=new Uint8Array(e),i=0;i<n;i+=4)o=h[t.charCodeAt(i)],a=h[t.charCodeAt(i+1)],s=h[t.charCodeAt(i+2)],u=h[t.charCodeAt(i+3)],c[r++]=o<<2|a>>4,c[r++]=(15&a)<<4|s>>2,c[r++]=(3&s)<<6|63&u;return new Uint8Array(e)},w.Xoe=function(t){for(var e,n=t.length,i="",e=0;e<n;e+=3)i=(i=(i=(i+=a[t[e]>>2])+a[(3&t[e])<<4|t[e+1]>>4])+a[(15&t[e+1])<<2|t[e+2]>>6])+a[63&t[e+2]];return n%3==2?i=i.substring(0,i.length-1)+"=":n%3==1&&(i=i.substring(0,i.length-2)+"=="),i},w.qoe=function(t){for(var e,n,e=new DataView(new ArrayBuffer(2*t.length)),n=0;n<t.length;n++)e.setUint16(2*n,t.charCodeAt(n),!0);return new Uint8Array(e.buffer)},w.$oe=function(t,e){var n,i,n=t.length,i=new Uint8Array(n+e.length);return i.set(t,0),i.set(e,n),i},w.tue=function(t,e,n,i){for(var r,o,a,r,o=i(w.$oe(w.Joe(e),w.qoe(t))),a=0;a<n;a++)o=i(w.$oe(new Uint8Array(o),w.r1e(a)));return o},w.nue=function(t,e,n,i){return w.Xoe(new Uint8Array(w.tue(t,e,n,i)))},w.eue=function(t){var e;return new l(512,!0).update(t).arrayBuffer()},w.o1e=function(t){for(var e,n,e=new Uint8Array(256),n=0;n<=255;n++)e[n]=Date.now()*Math.random()+Date.now()&255;return new Uint8Array(w.eue(e)).slice(0,t)},w.iue=function(){for(var t,e,t=new Uint8Array(256),e=0;e<=255;e++)t[e]=Date.now()*Math.random()+Date.now()&255;return w.Xoe(w.o1e(16))},w.rue=function(t,e,n,i,r){var o;return w.nue(t,n,i,r)===e},w.a1e=function(t,e,n){for(var i,r,i=0,r=n;r<e+n;r++)i+=t[r]*(1<<8*(r-n));return i},w.ETe=function(t){for(var e,n,e=0,n=t.length-1;0<=n;n--)e=e>>14&1|e<<1&32767,e^=t.charCodeAt(n);return(e=(e=e>>14&1|e<<1&32767)^t.length^52811).toString(16).toUpperCase()},e.Qoe=w},"./dist/core/util/custom-list.js":function(t,e){"use strict";var o,n;function i(t,e){this.wY=t,this.kb=e}o=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(e,"__esModule",{value:!0}),e.CustomList=void 0,Object.defineProperty(i.prototype,"length",{get:function(){return this.wY.length},enumerable:!1,configurable:!0}),i.prototype.get=function(t){return this.wY[t]},i.prototype.indexOf=function(t){return this.wY.indexOf(t)},i.prototype.findIndex=function(t,e){return this.wY.findIndex(t,e)},i.prototype.some=function(t,e){return this.wY.some(t,e)},i.prototype.set=function(t,e){this.wY[t]=e},i.prototype.push=function(t){var e=this;return this.xx(function(){return e.wY.push(t)})},i.prototype.update=function(t){var e=this;this.xx(function(){e.wY=t})},i.prototype.splice=function(e,n){for(var i,r,t,i=this,r=[],t=2;t<arguments.length;t++)r[t-2]=arguments[t];return this.xx(function(){var t;return(t=i.wY).splice.apply(t,o([e,n],r,!1))})},i.prototype.slice=function(t,e){var n=this;return this.xx(function(){return n.wY.slice(t,e)})},i.prototype.concat=function(t){var e=this;return this.xx(function(){return e.wY.concat(t)})},i.prototype.QP=function(){return o([],this.wY,!0)},i.prototype.L0=function(){this.wY=[],this.kb=function(){}},i.prototype.xx=function(t){var e,n,t,n=this.length,t=t();return null!=(e=this.kb)&&e.call(this,n,this.length),t},e.CustomList=i},"./dist/core/util/dataManager.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.l2e=e.h2e=e.d2e=e.v2e=void 0;var v=n("./dist/core/core.enum.js");function i(t,e){var e,e,n,e=e.workbook.lossless,e=e&&e.dataManager;if(e)return t.N3=null,(n=t.dataManager()).fromJSON(e)}function r(t,e){var e,n,e=e.dataManager;if(e)return t.N3=null,(n=t.dataManager()).fromJSON(e)}function o(t,n){for(var e,i,r,o,a,a,s,u,c,f,l,h,d,e=Object.keys(n),i=0,r=t;i<r.length;i++)if((o=r[i])._gi===v.SheetType.tableSheet||o._gi===v.SheetType.ganttSheet){if(a=o.getDataView())for(a=a.gLt.name,s=n[a].Ix(),u=0,c=e;u<c.length;u++)f=c[u],s.indexOf(f)<0&&(n[f].Nx=!0)}else if(o._gi===v.SheetType.reportSheet)for(s=o.getTemplate().D_i(),l=function(e){s.find(function(t){return e.toUpperCase()===t})||(n[e].Nx=!0)},h=0,d=e;h<d.length;h++)l(f=d[h])}function a(t,e){var n=t.N3;n&&(o(t.mp,n.tables),e.dataManager=n.toJSON())}function s(t,e){var n=t.N3;n&&(o(t.mp,n.tables),e.workbook.lossless.dataManager=n.toJSON())}e.v2e=i,e.d2e=r,e.h2e=a,e.l2e=s},"./dist/core/util/domUtil.js":function(r,t,e){"use strict";var n,_,e,g,h,m,u,f,a,d,c,s,l,v,p,S,w,b,C,y,i,M,k,T,x,A,o,G,B,L,D,I,n,j,P,O;function V(t,e){var n,i;for(Array.call(this),"string"==typeof t?n=(e||f).querySelectorAll(t):t&&(n=I.isArray(t)||t instanceof HTMLCollection?t:[t]),i=0;n&&i<n.length;i++)this.push(n[i])}function Y(t){for(var e,n,e=K(t);t.parentElement;)e<(n=K(t=t.parentElement))&&(e=n);return e}function K(t){var t=getComputedStyle(t).zIndex;return"auto"===t||""===t?0:Number(t)}function z(t){return I.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function W(t,e){var t=t.nodeName;return t&&t.toLowerCase()===e.toLowerCase()}function J(t,e){return 0<="top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)&&isFinite(e)?(e=0<="width height".split(" ").indexOf(t)&&e<0?0:e)+"px":e}function Z(t,e,n){var i,r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return(o=1!==a)&&(r=A[e=x[e]||e]),U(n)?r&&c in r&&(i=r.get(t,e))!==m?i:t[e]:r&&s in r&&!U(i=r.set(t,n,e))?i:t[e]=n}function Q(t){var e,n,e,e,e=t.nodeType;return!(e&&1!==e&&9!==e||(e=(e=t.nodeName)&&(n={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0})[e.toLowerCase()])&&(!0===e||t.getAttribute("classid")!==e))}function R(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()})}function N(t,e,n,i){if(Q(t)){var t,r,o=B,a=E(e),s=t.nodeType,u=s?G:t,c=s?t[o]:t[o]&&o;if(c&&u[c]&&(i||u[c].data)||!a||!U(n))return c||(s?(t[o]=c=L,L++):c=o),u[c]||(u[c]={},s)||(u[c].toJSON=function(){}),!H(e)&&"function"!=typeof e||(i?u[c]=I.extend(u[c],e):u[c].data=I.extend(u[c].data,e)),t=u[c],i||(t.data||(t.data={}),t=t.data),U(n)||(t[R(e)]=n),a?(r=t[e])!==m&&r!==h||(r=t[R(e)]):r=t,r}}function X(t){var e;for(e in t)if(("data"!==e||!I.isEmptyObject(t[e]))&&"toJSON"!==e)return;return 1}function q(t,e,n){if(Q(t)){var i,r,o,a=t.nodeType,s=a?G:t,u=a?t[B]:B;if(s[u]){if(e&&(o=n?s[u]:s[u].data)){r=(e=I.isArray(e)?e.concat(I.map(e,R)):e in o||(e=R(e))in o?[e]:e.split(" ")).length;for(i=0;i<r;i++)delete o[e[i]];if(!(n?X:I.isEmptyObject)(o))return}(n||(delete s[u].data,X(s[u])))&&(a?$([t],!0):s!==s.window?delete s[u]:s[u]=m)}}}function $(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,d,v,o=0,a=B,s=G,n=t[o];n!==m&&void 0!==n;){if((e||Q(n))&&(r=(i=n[a])&&s[i])){if(u=r.events)for(c in u)if(g(u,c)&&(f=u[c]))for(l in f)if(g(f,l)&&(h=f[l]))for(d=0,v=h.length;d<v;d++)F(n,c,h[d]);s[i]&&(delete s[i],delete n[a])}n=t[++o]}}function E(t){return"string"==typeof t}function H(t){return"object"==typeof t}function U(t){return typeof t==typeof h}function tt(t){var s=t;return function(t){var e,n,i,r,o,a,e=this,n="border-box"===e.css("box-sizing"),r=s?l:v,o=s?p:w,a=s?S:b;return 0===arguments.length?(i=Math.round(u(e.css(r)))||0,n&&(i-=u(e.css("padding-"+o))+u(e.css("padding-"+a))+u(e.css("border-"+o+"-"+l))+u(e.css("border-"+a+"-"+l))),i):(e.css(r,t),e)}}function et(t){var i=t;return function(){var t,e,n,t=this,e=i?p:w,n=i?S:b;return i?t.width():t.height()+u(t.css("padding-"+e))+u(t.css("padding-"+n))}}function nt(t){var o=t;return function(t){var e,n,i,r,e=o?p:w,n=o?S:b,i=this,r=o?i.innerWidth():i.innerHeight();return r+=u(i.css("border-"+e+"-"+l))+u(i.css("border-"+n+"-"+l)),t&&(r+=u(i.css("margin-"+e))+u(i.css("margin-"+n))),r}}function it(t){var n=t;return function(e){return this.forEach(function(t){t.style[T]=n?y:i,e&&e.apply(t)}),this}}function rt(t){var u=t;return function(t){var e,n,i,r,o,a,s,e="scrollLeft",n="scrollTop",i=u?e:n,r=u?"pageXOffset":"pageYOffset",o=this,a=o[0],s=a&&z(a);return U(t)?s?r in s?s[r]:f.documentElement[i]:a&&a[i]:(s?s.scrollTo(u?t:I(s)[e](),u?I(s)[n]():t):a&&(a[i]=t),o)}}function F(t,e,n){t.removeEventListener(e,n)}function ot(i,r,t){var o,a,s,u,c,f,l,e,h,n,l=0,e=!1,h=!1,n=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function d(t){var e,n,e=o,n=a;return o=a=void 0,l=t,u=i.apply(n,e)}function v(t,e){return setTimeout(t,e)}function g(t){clearTimeout(t)}function m(t){return l=t,c=v(w,r),e?d(t):u}function p(t){var e,n,t,e,n=t-l,t=r-(t-f);return h?Math.min(t,s-n):t}function S(t){var e,n,e=t-f,n;return void 0===f||r<=e||e<0||h&&s<=t-l}function w(){var t=Date.now();if(S(t))return b(t);c=v(w,p(t))}function b(t){return c=void 0,n&&o?d(t):(o=a=void 0,u)}function C(){void 0!==c&&g(c),o=f=a=c=void(l=0)}function y(){return void 0===c?u:b(Date.now())}function M(){return void 0!==c}function k(){for(var t,e,n,i,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(i=S(n=Date.now()),o=t,a=this,f=n,i){if(void 0===c)return m(f);if(h)return c=v(w,r),d(f)}return void 0===c&&(c=v(w,r)),u}return r=+r||0,H(t)&&(e=!!t.leading,h="maxWait"in t,s=h?Math.max(+t.maxWait||0,r):s,n="trailing"in t?!!t.trailing:n),k.cancel=C,k.flush=y,k.pending=M,k}function at(t,e,n){var i,r,i=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return H(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),ot(t,e,{leading:i,trailing:r,maxWait:e})}function st(t,e,n){var i,r,o;if(t){if(i=t,!e||0===e.length)return i=!(i=t[a])&&n?t[a]={}:i;for(r=e.length-1;0<=r;r--){if(!i[o=e[r]]){if(!n)return;i[o]={}}i=i[o]}return i}}function ut(t,e){var n,i,r,o;for(n in t)if(g(t,n)&&(i=t[n]))if(I.isArray(i))for(r=i.length,o=0;o<r;o++)F(e,n,i[o]);else ut(i,e)}function ct(t,e,n,i,r){var o,a,s,u,c;if(!(!t||2<r||t instanceof Function))for(o in r+=1,t)if(g(t,o)&&(a=t[o])){if((s=a[n])&&I.isArray(s))for(u=0,c=s.length;u<c;u++)s[u].apply(e,[{type:n},i]);ct(a,e,n,i,r)}}function ft(t,e,n){this.zue=t.clientHeight,this.Vue=t.clientWidth,this.sse=_.mt.Tt.safari,this.cse(t,e,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.Ose=t.GC$=t.getHostMaxZIndex=void 0,n=e("Common"),_=e("./dist/core/util/common.js"),e=n.Common.lt,g=n.Common.kh,h=void 0,m=null,u=parseFloat,f=document,a="_nonamespace",d="events",c="get",s="set",l="width",v="height",p="left",S="right",w="top",b="bottom",C="hidden",y="block",i="none",M="position",k="visibility",T="display",x={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},A={tabIndex:{get:function(t){var e,n,i,r,e=t.getAttributeNode("tabindex"),n=/^(?:input|select|textarea|button|object)$/i,i=/^(?:a|area)$/i,r=t.nodeName;return e&&e.specified?parseInt(e.value,10):n.test(r)||i.test(r)&&t.href?0:h}}},o={option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,e,n=t.options,i=t.selectedIndex,r="select-one"===t.type||i<0,o=r?m:[],a=r?i+1:n.length,s=r?i:0;for(i<0&&(s=a);s<a;s++)if(((e=n[s]).selected||s===i)&&!e.disabled&&(!e.parentNode.disabled||!W(e.parentNode,"optgroup"))){if(e=I(e).val(),r)return e;o.push(e)}return o},set:function(t,e){var n,i,n=I.makeArray(e),i;return I(t).find("option").getAll().forEach(function(t){t.selected=0<=I.inArray(I(t).val(),n)}),n.length||(t.selectedIndex=-1),n}}},G={},B="$"+(""+Math.random()).replace(/\D/g,""),L=1,D={},[v,l].forEach(function(c){D[c]={get:function(t){var e,n,i,r,o,a,e,s,u,e=getComputedStyle(t),n=t.style,i=n[M],r=n[k],o=n[T],a=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(e[T]);if(a&&(n[M]="absolute",n[k]=C,n[T]=y),e=e&&e[c],a&&(n[M]=i,n[k]=r,n[T]=o),""===e){for(s=t.parentElement,u=f.body;s&&s!==u;)s=s.parentElement;s!==u&&(e=n[c])}return e}}}),I=function(t,e){return t instanceof V?t:new V(t,e)},t.GC$=I,n={get:function(t){return this[t]},getAll:function(){return this},bind:function(a,s,u){var t=this;return U(u)&&(u=s,s=h),t.forEach(function(n){var t,e,i,r,t,e,o,t=N(n,d,h,!0);t||N(n,d,t={},!0),i=(e=a.split("."))[0],t=st(t,r=e.slice(1),!0),(e=function(t){U(s)||(t.data=s);var e=u.apply(n,arguments);!1===(t.result=e)&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))}).original=u,(o=(o=t[i])||(t[i]=[])).push(e),n.addEventListener(i,e)}),t},unbind:function(f,l){var t=this;return t.forEach(function(t){var e,n,i,r,o,a,s,n,u,c,e=N(t,d,h,!0),n=f.split("."),i=n[0],r=n.slice(1),n=st(e,r);if(n)if(l){if(i&&(o=n[i])&&I.isArray(o))for(s=o.length,a=0;a<s;a++)if(o[a].original===l){F(t,i,o[a]),o.splice(a,1);break}}else if(i){if((o=n[i])&&I.isArray(o))for(s=o.length,a=0;a<s;a++)F(t,i,o[a]);n[i]=h}else{for(ut(n,t),u=e,c=r.length-1;0<c&&(u=u[r[c]]);c--);u&&(u[r[0]]=h)}}),t},trigger:function(t,e){var n,i,r,o,a,s,u,n=this;if(t)for(i=0,r=n.length;i<r;i++)(a=N(o=n[i],d,h,!0))&&ct(a,o,u=(s=t.split("."))[0],e,0);return n},css:function(n,i){var t,r,e,o,a,a;function s(e,n){r.forEach(function(t){t.style[e]=J(e,n)})}if(r=t=this,1===(e=arguments.length)){if(!H(n))return o=t[0],(a=D[n])&&c in a?o?a.get(o):m:(a=o&&getComputedStyle(o))&&a[n];r.forEach(function(t){for(var e in n)g(n,e)&&(t.style[e]=J(e,n[e]))})}else 2===e&&(I.isArray(n)&&I.isArray(i)&&n.length===i.length?n.forEach(function(t,e){s(t,i[e])}):s(n,i));return t},width:tt(!0),height:tt(),innerWidth:et(!0),innerHeight:et(),outerWidth:nt(!0),outerHeight:nt(),append:function(t){var e,t,n,e=[t];return t instanceof I&&(e=t.getAll()),(n=(t=this)[0])&&e.forEach(function(t){t&&n.appendChild(t)}),t},appendTo:function(t){var e,n,e=t,n=this;return(e=t instanceof I?t[0]:e)&&n.forEach(function(t){e.appendChild(t)}),n},prepend:function(t){var e=this,n=e[0];return n&&n.insertBefore(t,n.firstChild),e},insertBefore:function(e){var t=this,n=e.parentElement;return t.forEach(function(t){n.insertBefore(t,e)}),t},addClass:function(t){for(var e,n,i,r,o,a=0,s=this,u=s.length,c,f=/[\t\r\n]/g,e=(t||"").match(/\S+/g)||[];a<u;a++)if(i=1===(n=s[a]).nodeType&&(n.className?(" "+n.className+" ").replace(f," "):" ")){for(r=e[o=0];r;)i.indexOf(" "+r+" ")<0&&(i+=r+" "),r=e[++o];n.className=I.trim(i)}return this},removeClass:function(t){for(var e,n,i,r,o,a=0,s=this,u=s.length,c,f=/[\t\r\n]/g,e=(t||"").match(/\S+/g)||[];a<u;a++)if(i=1===(n=s[a]).nodeType&&(n.className?(" "+n.className+" ").replace(f," "):"")){for(r=e[o=0];r;){for(;0<=i.indexOf(" "+r+" ");)i=i.replace(" "+r+" "," ");r=e[++o]}n.className=t?I.trim(i):""}return this},hasClass:function(t){var e,n,i,r,o,e=0,n=this,i=n.length,r=/[\t\r\n]/g;for(t=" "+t+" ";e<i;e++)if(1===(o=n[e]).nodeType&&0<=(" "+o.className+" ").replace(r," ").indexOf(t))return!0;return!1},toggle:function(){var t,e,t=this,e=t[0];return e&&e.style[T]===i?t.show():t.hide(),t},show:it(!0),hide:it(),attr:function(n,e){var t,i,r,o,i=this,r=i,o=arguments.length;if(1===o){if(!H(n))return null==(t=i[0])?void 0:t.getAttribute(n);r.forEach(function(t){for(var e in n)g(n,e)&&t.setAttribute(e,n[e])})}else 2===o&&r.forEach(function(t){t.setAttribute(n,e)});return i},removeAttr:function(e){return this.forEach(function(t){t.removeAttribute(e)}),this},prop:function(n,e){var t=this,i=t,r=arguments.length;if(1===r){if(!H(n))return t[0]&&Z(t[0],n);i.forEach(function(t){for(var e in n)g(n,e)&&Z(t,e,n[e])})}else 2===r&&i.forEach(function(t){Z(t,n,e)});return t},removeProp:function(e){e=x[e]||e;var t=this,n;return t.forEach(function(t){try{t[e]=h,delete t[e]}catch(t){}}),t},text:function(e){var t,n,i,n=this,i=n;return 0===arguments.length?null==(t=n[0])?void 0:t.textContent:(i.forEach(function(t){t.textContent=e}),n)},val:function(n){var t,i,t,e,r,t=this;return arguments.length?(r=I.isFunction(n),t.forEach(function(t,e){var e;1!==t.nodeType||((e=r?n.call(t,e,I(t).val()):n)===m||e===h?e="":"number"==typeof e?e+="":I.isArray(e)&&(e=I.map(e,function(t){return t===m||t===h?"":t+""})),(i=o[t.type]||o[t.nodeName.toLowerCase()])&&s in i&&!U(i.set(t,e,"value")))||(t.value=e)}),t):(e=void 0,(t=t[0])?(i=o[t.type]||o[t.nodeName.toLowerCase()])&&c in i&&!U(e=i.get(t,"value"))?e:E(e=t.value)?e.replace(/\r/g,""):e===m||e===h?"":e:void 0)},position:function(){var t,e,n,i,r,t=this[0];if(t){if(e={top:0,left:0},n={top:0,left:0},"fixed"===I(t).css(M))try{e=t.getBoundingClientRect()}catch(t){}else i=this.offsetParent(),e=this.offset(),(r=i[0])&&(W(r,"html")||((n=i.offset()).left-=r.scrollLeft,n.top-=r.scrollTop),n.top+=u(I(r).css("borderTopWidth")),n.left+=u(I(r).css("borderLeftWidth")));return{top:e.top-n.top-u(I(t).css("marginTop")),left:e.left-n.left-u(I(t).css("marginLeft"))}}},offsetParent:function(){var t=I.map(this,function(t){for(var e,n,e=f.documentElement,n=t.offsetParent||e;n&&!W(n,"html")&&"static"===I(n).css(M);)n=n.offsetParent;return n||e});return I(t)},offset:function(){var t,e,n={top:0,left:0},e=this[0],i=e&&e.ownerDocument;if(i){if(t=i.documentElement,!U(e.getBoundingClientRect))try{n=e.getBoundingClientRect()}catch(t){}return e=z(i),{top:n.top+(e.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(e.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:rt(!0),scrollTop:rt(),html:function(e){var t,n,i,n=this,i=n;return 0===arguments.length?null==(t=n[0])?void 0:t.innerHTML:(i.forEach(function(t){t.innerHTML=e}),n)},remove:function(){var t;this.forEach(function(t){var e=t.parentElement;e&&(e.removeChild(t),$([t]))})},empty:function(){return this.forEach(function(t){I(t.children).remove()}),this},find:function(e){var n=[];return E(e)&&this.forEach(function(t){var t=t.querySelectorAll(e);I.merge(n,t)}),I(n)},parent:function(){var e=[];return this.forEach(function(t){var t=t.parentElement;t&&e.push(t)}),I(e)},index:function(t){var e=this[0];return t?E(t)?e&&I.inArray(e,I(t).getAll()):I.inArray(t,this):e&&e.parentElement?I.inArray(e,e.parentElement.children):-1},focus:function(){var t=this,e=t[0];return e&&e!==f.activeElement&&e.focus&&e.focus(),t},isVisible:function(){var e=0;return this.forEach(function(t){var t=getComputedStyle(t);t[k]!==C&&t[T]!==i&&e++}),0<e},data:function(n,i){var r,o,r=this,o=U(i);return o&&(r=void 0),I.each(this,function(t,e){var e=N(e,n,i);if(o)return r=e,!1}),r},removeData:function(n){return I.each(this,function(t,e){q(e,n)}),this}},j=V.prototype=[],e.Dh(j,n),I.prototype=j,I.each=e.y0,I.isEmptyObject=e._h,I.isFunction=e.Eh,I.isArray=e.Nh,I.isNumeric=e.jh,I.getType=e.Oh,I.inArray=e.Rh,I.merge=e.Bh,I.map=e.Lh,I.extend=e.Dh,I.inherit=e.Fh,I.isPlainObject=e.Ph,I.isArraylike=e.Gh,I.isWindow=e.Uh,I.makeArray=e.Hh,I.trim=function(t){var e;return t.trim?t.trim():t===m||t===h?"":(t+"").replace(/(^[\s\uFEFF\xA0]+)|([\s\uFEFF\xA0]+$)/g,"")},I.En=function(t,e,n,i,r){var t=I(f.createElement(t));return e&&n&&t.css(e,n),i&&t.addClass(i),r&&(r instanceof I?r:I(r)).append(t),t},t.getHostMaxZIndex=Y,P="px",ft.prototype.cse=function(r,o,t){var a=this;this.sse?this.fse=setInterval(function(){var t;r.style.width===a.Vue+P&&r.style.height===a.zue+P||o()},100):(this.Yue=new MutationObserver(at(function(t){for(var e,n,i,e=0;e<t.length;e++)if("attributes"===(n=t[e]).type&&(i=r.style.width!==a.Vue+P||r.style.height!==a.zue+P))return void o()},t)),this.Yue.observe(r,{attributes:!0}))},ft.prototype.disconnect=function(){this.sse?clearInterval(this.fse):(this.Yue.disconnect(),this.Yue=null)},t.Ose=ft},"./dist/core/util/imageLoader.js":function(t,e,n){"use strict";var n,u,c,i;function r(t){var e;this.zh=0,this.Vh=0,this.Yh={},this.Dx=[],this.Zh=t}Object.defineProperty(e,"__esModule",{value:!0}),e.Wh=void 0,n=n("./dist/core/util/domUtil.js"),u=n.GC$,c=".gcSheet",r.prototype.addImage=function(t,e){var n,i,r,o;function a(){n.Qh(t,!0)}function s(){n.Qh(t,!1)}(r=(i=(n=this).Yh)[t])||(o=u(document.createElement("img")),e&&o.attr("crossOrigin",e),o.bind("load"+c,a),o.bind("error"+c,s),o.bind("abort"+c,s),n.zh++,i[t]={Kh:!1,Jh:o[0],Xh:!1},o[0].src=t)},r.prototype.getState=function(t){var t=this.Yh[t];return!!t&&t.Kh},r.prototype.qh=function(t){var t=this.Yh[t];return!!t&&t.Xh},r.prototype.getImage=function(t){var t=this.Yh[t];return t?t.Jh:null},r.prototype.Qh=function(t,e){var n=this;n.Vh++,n.Yh[t].Kh=!0,n.Yh[t].Xh=e,n.$h()&&n.Zh&&Promise.all(this.Dx).then(function(){n.Zh()})},r.prototype.$h=function(){return this.Vh>=this.zh},r.prototype.addLoadingPromises=function(t){var e;t&&0<t.length&&(e=this.Dx).push.apply(e,t)},r.prototype.L0=function(){var t,e,n,t=this.Yh;if(t)for(e in t)t[e]&&(n=u(t[e].Jh)).unbind(c);this.Zh=null},e.Wh=r},"./dist/core/util/styleManager.js":function(F,t,e){"use strict";var n,_,o,f,u,a,A,s,c,l,h,d,v,r,g,L,D,m,p,j,S,w,b,C,O,V,i,e;function y(t,e){var n=this;this.td=[],this.Lh={},t&&(e?t.forEach(function(t,e){n.Lh[t]=""+e,n.td[e]=t}):t.forEach(function(t,e){n.getTextIndex(t)}))}function M(){this.td=[]}function k(t){return t?1:0}function T(t,e){var n,i;return null===t?'{"s":0}':(n="{",l(t.style)||"object"!=typeof(i="string"==typeof(i=t.style)?'"'+A.ExcelBorderStyle[i]+'"':i)&&(n+='"s":'+i+","),l(t.color)||(n+='"c":'+e.getTextIndex(t.color)+","),n.substring(0,n.length-1)+"}")}function Y(t,e,n){var i,t;if(t)return i=new f.LineBorder,t=JSON.parse(t),n||0!==t.s?(l(t.s)||(i.style=+t.s),l(t.c)||(i.color=e.getText(+t.c)),i):d}function x(t,e){var n=this;n.nd=[],n.ed=new p(e),n.rd=t}function G(t,e){var n=this;n.od=[],n.ad=new p,n.ud=new p,n.m2e=new p,n.g2e=new p,n.p2e=new p,n.Pre=new p,n.rd=t,n.cd=e}function B(t){return null!==t&&(t===h||t.color===h&&t.level===h&&t.style===h)}function I(t){var e=this;e.fd=[],e.ld=[],e.hd=new p,e.dd=new p,e.rd=t,e.hd.getTextIndex('{"s":0}'),e.dd.getTextIndex("l:0,r:0,t:0,b:0")}function P(t,e){var n,i,r,n=this;n.vd=[],n.md=new p,n.pd=new p,n.bd={},n.cd=t,n.yd=e,n.wd={},a.ExtendedNumberFormatHelper.resetBuiltInNumberFormat(),i=a.ExtendedNumberFormatHelper.builtInNumberFormat(),Object.keys(i).forEach(function(t){"count"!==t&&(P.Cd[i[t]]=t)}),r=a.ExtendedNumberFormatHelper.languageIndepedentNumberFormat(),Object.keys(r).forEach(function(t){"count"!==t&&(P.Cd[r[t]]=t)})}function R(){var t=this;t.Td=[],t.Ad=new p}function N(){var t=this;t.xd=[],t.Nd=new p}function E(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function K(t,e){var n,t,i,e,n,n=_.ti,t=t.getObject(+e);return t&&(e=t.typeName,n=n[t.type]||n[e]||o.getTypeFromString(e))&&(i=new n).fromJSON(t,!0),i}function H(t,e,n){var i=this;i.kd=new p,i.Dd=new C(e,n),i._d=new w(t,e),i.Lfe=new w(t,e),i.Ed=new S(t),i.jd=new b(t),i.Vve=new O,i.Yve=new V,i.yd=n}function U(){var t=this;t.Od=new p,t.cd=new p,t.yd=new j,t.Dd=new C(t.cd,t.yd),t._d=new w(t.Od,t.cd),t.Ed=new S(t.Od,['{"t":0}','{"t":5}']),t.jd=new b(t.Od),t.Rd=new p,t.Bd=new p,t.Ld=new p,t.kd=new i(t.Od,t.cd,t.yd),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.zd=[],t.Vd={},t.Yd={},t.Zd={},t.originCellXfs=new p,t.originNamedStylesXfs=new p,t.Wd={},t.Qd={},t.Kd={},t.Jd="__builtInStyle",t.Xd="__builtInTableStyle",t.qd=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,t.$d=0}Object.defineProperty(t,"__esModule",{value:!0}),t.StyleManager=t.SharedDxfs=t.SimpleSharedStrings=void 0,n=e("./dist/core/util/common.js"),_=e("./dist/core/celltype/celltype.ns.js"),o=e("./dist/core/util/common.js"),f=e("./dist/core/worksheet/style.js"),u=e("./dist/core/util/common.js"),a=e("./dist/core/excel-io-util/common.js"),A=e("./dist/core/excel-io-util/excel-style.js"),s=e("Common"),c=e("./dist/core/util/domUtil.js"),l=s.Common.lt.ht,h=void 0,d=null,v=a.NodeHelper.ur,r=c.GC$.each,g=s.Common.lt.tv,L=a.Util.ro,D=a.Util.ao,m=n.mt.St,y.prototype.dispose=function(){this.td=h,this.Lh=h},y.prototype.setTextValue=function(t){var e;this.Lh[t]===h&&(e=this.td.push(t)-1,this.Lh[t]=e)},y.prototype.getTextIndex=function(t){return this.setTextValue(t),this.Lh[t]},y.prototype.getText=function(t){return this.td[t]},y.prototype.setTextIndex=function(t,e){this.td[e]=t,this.Lh[t]=e},y.prototype.replaceText=function(t,e){this.td[t]=e},y.prototype.getCount=function(){return this.td.length},y.prototype.yh=function(t){var e,n,i,r,e=this,n=e.Lh;if(t)for(i=0,r=(e.td=t).length;i<r;i++)n[t[i]]=""+i},y.prototype.wh=function(){return this.td},p=y,t.SimpleSharedStrings=p,M.prototype.dispose=function(){this.td=h},M.prototype.getObjectIndex=function(t){var e,n=this.td,i=0,r=n.length,o;if(t.toJSON?o=t.toJSON():!l(t)&&t instanceof Object&&(o=JSON.stringify(t)),o){for(;i<r;i++)if(n[i]===o)return i;return n[i]=o,i}},M.prototype.getObject=function(t){return this.td[t]},M.prototype.yh=function(t){this.td=t},M.prototype.wh=function(){return this.td},j=M,x.prototype.dispose=function(){var t=this;t.ed&&(t.ed.dispose(),t.ed=h),t.nd=h,t.rd=h},x.prototype.nv=function(t){var e,n,i,t,r,o,a,s,e=this,n=e.rd;return t.backColor===d?e.ed.getTextIndex('{"t":0}'):t.backColor!==h?("object"==typeof(a=o=r=t=t.backColor)?(i="{",o.stops?(i+='"s":[',(s=o.stops).forEach(function(t){i+='{"p":'+t.position+',"c":'+n.getTextIndex(t.color)+"},"}),i=i.substring(0,i.length-1),i+="],","path"===a.type?(i+='"t":"p"',(0,u.isDefined)(a.left)&&(i+=',"l":'+a.left),(0,u.isDefined)(a.right)&&(i+=',"r":'+a.right),(0,u.isDefined)(a.top)&&(i+=',"a":'+a.top),(0,u.isDefined)(a.bottom)&&(i+=',"c":'+a.bottom)):i+='"d":'+(o.degree||0)):r.type!==h&&(i+='"t":'+r.type,(0,u.isDefined)(r.patternColor)&&""!==r.patternColor&&(i+=',"p":'+n.getTextIndex(r.patternColor)),(0,u.isDefined)(r.backgroundColor))&&""!==r.backgroundColor&&(i+=',"b":'+n.getTextIndex(r.backgroundColor)),i+="}"):i=""===t?'{"t":0}':n.getTextIndex(t),e.ed.getTextIndex(i)):void 0},x.prototype.ev=function(t,e){var n,i,r,o,n,a,s,u,s,n=this,i=n.rd,r=n.nd;return r[t]||("string"==typeof(n=n.ed.getText(+t))&&"{"===n[0]?(s=(a=JSON.parse(n)).s,o={},0===a.t?d:(s&&0<s.length?(u=o.stops=[],s.forEach(function(t){var e={};l(t.p)||(e.position=t.p),l(t.c)||(e.color=i.getText(t.c)),u.push(e)}),"p"===a.t?(o.type="path",l(a.l)||(o.left=a.l),l(a.r)||(o.right=a.r),l(a.a)||(o.top=a.a),l(a.c)||(o.bottom=a.c)):l(a.d)||(o.degree=a.d)):l(a.t)?l(a.b)||(o=i.getText(a.b)):1===(s=a.t)?e||l(a.p)?l(a.b)||(o=i.getText(a.b)):o=i.getText(a.p):(o.type=s,l(a.p)||(o.patternColor=i.getText(a.p)),l(a.b)||(o.backgroundColor=i.getText(a.b))),o=c.GC$.isEmptyObject(o)?h:o,r[t]=o)):(o=i.getText(n),o=c.GC$.isEmptyObject(o)?h:o,r[t]=o))},x.prototype.iv=function(t){t.fills=this.ed.wh()},x.prototype.rv=function(t){this.ed.yh(t.fills)},S=x,G.prototype.dispose=function(){var t=this;t.ad&&(t.ad.dispose(),t.ad=h),t.ud&&(t.ud.dispose(),t.ud=h),t.m2e&&(t.m2e.dispose(),t.m2e=h),t.g2e&&(t.g2e.dispose(),t.g2e=h),t.p2e&&(t.p2e.dispose(),t.p2e=h),t.Pre&&(t.Pre.dispose(),t.Pre=h),t.od=h,t.rd=h,t.cd=h},G.prototype.nv=function(t){var e,n,e=this;if(!(l(t.font)&&l(t.vertAlign)&&l(t.textDecoration)&&t.foreColor===h&&l(t.themeFont)))return n="",l(t.font)||(n+="f:"+e.ud.getTextIndex(t.font)+","),t.fontStyle!==h&&(n+="i:"+e.m2e.getTextIndex(t.fontStyle)+","),t.fontWeight!==h&&(n+="b:"+e.g2e.getTextIndex(t.fontWeight)+","),l(t.fontSize)||(n+="s:"+e.p2e.getTextIndex(t.fontSize)+","),l(t.fontFamily)||(n+="n:"+e.Pre.getTextIndex(t.fontFamily)+","),l(t._fontVariant)||(n+="a:"+e.cd.getTextIndex(t._fontVariant)+","),l(t._lineHeight)||(n+="l:"+e.cd.getTextIndex(t._lineHeight)+","),l(t._fontStretch)||(n+="r:"+e.cd.getTextIndex(t._fontStretch)+","),l(t.vertAlign)||(n+="v:"+t.vertAlign+","),l(t.textDecoration)||(n+="d:"+t.textDecoration+","),t.foreColor!==h&&(n+="c:"+e.rd.getTextIndex(t.foreColor)+","),l(t.themeFont)||(n+="t:"+e.cd.getTextIndex(t.themeFont)+","),e.ad.getTextIndex(n.substring(0,n.length-1))},G.prototype.ev=function(t){var i,r,e,n,o,i=this,r=i.rd,e=i.od;return e[t]||((n=i.ad.getText(+t))?(o={},n.split(",").forEach(function(t){var t=t.split(":"),e=t[0],n=t[1];switch(e){case"f":o.font=i.ud.getText(+n);break;case"v":o.vertAlign=+n;break;case"d":o.textDecoration=+n;break;case"c":o.foreColor=r.getText(+n);break;case"t":o.themeFont=i.cd.getText(+n);break;case"i":o.fontStyle=i.m2e.getText(+n);break;case"b":o.fontWeight=i.g2e.getText(+n);break;case"s":o.fontSize=i.p2e.getText(+n);break;case"n":o.fontFamily=i.Pre.getText(+n);break;case"a":o._fontVariant=i.cd.getText(+n);break;case"l":o._lineHeight=i.cd.getText(+n);break;case"r":o._fontStretch=i.cd.getText(+n)}}),e[t]=o):void 0)},G.prototype.iv=function(t){var e=this;t.fonts=e.ad.wh(),t.htmlFonts=e.ud.wh(),t.fontStyles=e.m2e.wh(),t.fontWeights=e.g2e.wh(),t.fontSizes=e.p2e.wh(),t.fontFamilies=e.Pre.wh()},G.prototype.rv=function(t,e){var n=this;e?(n.ad.yh(t.partFonts),n.ud.yh(t.partHtmlFonts)):(n.ad.yh(t.fonts),n.ud.yh(t.htmlFonts),n.m2e.yh(t.fontStyles),n.g2e.yh(t.fontWeights),n.p2e.yh(t.fontSizes),n.Pre.yh(t.fontFamilies))},w=G,I.prototype.dispose=function(){var t=this;t.hd&&(t.hd.dispose(),t.hd=h),t.dd&&(t.dd.dispose(),t.dd=h),t.fd=h,t.ld=h,t.rd=h},I.prototype.nv=function(t){var e,n,i,e=this,n=e.rd,i="";if(B(t.borderLeft)||(i+="l:"+e.hd.getTextIndex(T(t.borderLeft,n))+","),B(t.borderRight)||(i+="r:"+e.hd.getTextIndex(T(t.borderRight,n))+","),B(t.borderTop)||(i+="t:"+e.hd.getTextIndex(T(t.borderTop,n))+","),B(t.borderBottom)||(i+="b:"+e.hd.getTextIndex(T(t.borderBottom,n))+","),B(t.borderVertical)||(i+="v:"+e.hd.getTextIndex(T(t.borderVertical,n))+","),B(t.borderHorizontal)||(i+="h:"+e.hd.getTextIndex(T(t.borderHorizontal,n))+","),B(t.diagonalUp)||(i+="u:"+e.hd.getTextIndex(T(t.diagonalUp,n))+","),B(t.diagonalDown)||(i+="d:"+e.hd.getTextIndex(T(t.diagonalDown,n))+","),""!==i)return e.dd.getTextIndex(i.substring(0,i.length-1))},I.prototype.ov=function(t,e){var n,i,r,n,o,r,n=this,i=n.ld;return i[t]||(r=n.hd,n=n.rd,r=Y(o=r.getText(+t),n,e),i[t]=r)},I.prototype.ev=function(t,i){var r,e,n,o,r=this,e=r.fd;return e[t]||(n=r.dd.getText(t),o={},n?(n.split(",").forEach(function(t){var t=t.split(":"),e=t[0],n=t[1];switch(e){case"l":o.borderLeft=r.ov(n,i);break;case"r":o.borderRight=r.ov(n,i);break;case"t":o.borderTop=r.ov(n,i);break;case"b":o.borderBottom=r.ov(n,i);break;case"v":o.borderVertical=r.ov(n,i);break;case"h":o.borderHorizontal=r.ov(n,i);break;case"u":o.diagonalUp=r.ov(n,i);break;case"d":o.diagonalDown=r.ov(n,i)}}),e[t]=o):void 0)},I.prototype.iv=function(t){var e=this;t.borderItems=e.hd.wh(),t.borders=e.dd.wh()},I.prototype.rv=function(t){var e=this;e.dd.yh(t.borders),e.hd.yh(t.borderItems)},b=I,P.prototype.dispose=function(){var t=this;t.md&&(t.md.dispose(),t.md=h),t.pd&&(t.pd.dispose(),t.pd=h),t.vd=h,t.bd=h},P.prototype.nv=function(t){var e,n,i,t,r,o,a,e=this,n="",i=t._autoFormatter,t=t.formatter;if(!l(i)){if(r=(o=e.av(i))&&"a"+o.c,!o)return;e.bd[r]!==h?n+="a:"+e.bd[r]+",":(a=e.pd.getTextIndex(JSON.stringify(o)),n+="a:"+(e.bd[r]=a)+",")}if(t!==h&&!m(t)){if(r=(o=e.av(t))&&"f"+o.c,!o)return;e.bd[r]!==h?n+="f:"+e.bd[r]+",":(a=e.pd.getTextIndex(JSON.stringify(o)),n+="f:"+(e.bd[r]=a)+",")}if(n)return e.md.getTextIndex(n.substring(0,n.length-1))},P.prototype.ev=function(t){var r,e,n,o,r=this,e=r.vd;return e[t]||(n=r.md.getText(t),o={},n.split(",").forEach(function(t){var t,e,t,n,i,i,t=t.split(":"),e=t[0],t=t[1];"a"===e?(n=r.fromSJSFormatString(r.pd.getText(+t)),(i=(i=s.Formatter)&&i.GeneralFormatter)&&(o._autoFormatter=new i(n.formatCached,n.customerCultureName),o._autoFormatter.isAuto=!0)):"f"===e&&(o.formatter=r.fromSJSFormatString(r.pd.getText(+t)))}),e[t]=o)},P.prototype.uv=function(t){var e=this,n=e.wd;return n[t]||e.sv(t)},P.prototype.sv=function(t){var e,e;if(t!==h)return(e=a.ExtendedNumberFormatHelper.builtInNumberFormat())[t]!==h?e[t]:(e=a.ExtendedNumberFormatHelper.languageIndepedentNumberFormat())[t]!==h?e[t]:void 0},P.prototype.fromSJSFormatString=function(t){var e,n,t,i,r,t,t,e=this,n=e.wd,t=JSON.parse(t),i=t.n,r=t.c;return l(t.json)||(r=JSON.parse(e.yd.getObject(t.json))),-1===i?null:"string"==typeof r?n[i]=r:r&&!l(r.typeName)&&(t=o.getTypeFromString(r.typeName))?((t=new t).fromJSON(r),n[i]=t):(l(i)||r&&r.formatCached||(r=e.sv(i)),n[i]=r)},P.prototype.av=function(t){var e,t,n,i,e=this,t=t;return t===d?{n:-1,c:null}:("object"==typeof t&&(t.toJSON&&(n=t.toJSON()),t.formatCached?t=t.formatCached:n&&(t=JSON.stringify(n))),t?{n:i=(i=P.Cd[t])===h&&this.bd[t]===h?++a.ExtendedNumberFormatHelper.Ih:i,c:t,json:n&&e.yd.getObjectIndex(n)}:void 0)},P.prototype.iv=function(t){var e=this;t.numFmts=e.md.wh(),t.formatStrings=e.pd.wh()},P.prototype.rv=function(t){var e,n,i,e=this;if(e.md.yh(t.numFmts),e.pd.yh(t.formatStrings),t.numFmts&&0<t.numFmts.length)for(n=0,i=t.numFmts.length;n<i;n++)e.ev(n)},P.Cd={},C=P,R.prototype.dispose=function(){var t=this;t.Ad&&(t.Ad.dispose(),t.Ad=h),t.Td=h},R.prototype.nv=function(t,e){var n,i,i,n="",i=t.hAlign;if(l(i)||(3===e||!e)&&3===i||2===e&&1===i||1===e&&1===i||(n+="h:"+i+","),i=t.vAlign,l(i)||(3===e||!e)&&2===i||2===e&&1===i||1===e&&1===i||(n+="v:"+i+","),l(t.textOrientation)||(n+="x:"+t.textOrientation+","),l(t.textIndent)||(n+="i:"+t.textIndent+","),l(t.shrinkToFit)||(n+="s:"+k(t.shrinkToFit)+","),l(t.wordWrap)||(n+="w:"+k(t.wordWrap)+","),n)return this.Ad.getTextIndex(n.substring(0,n.length-1))},R.prototype.ev=function(t){var e,n,n,i,e=this,n=e.Td;return n[t]||(n=e.Ad.getText(t),i=new f.Style,n.split(",").forEach(function(t){var t=t.split(":"),e=t[0],n=t[1];switch(e){case"h":i.hAlign=+n;break;case"v":i.vAlign=+n;break;case"x":i.textOrientation=+n;break;case"i":i.textIndent=+n;break;case"s":i.shrinkToFit=v(n);break;case"w":i.wordWrap=v(n);break;case"td":i.textDirection=+n}}),i)},R.prototype.iv=function(t){t.alignments=this.Ad.wh()},R.prototype.rv=function(t){this.Ad.yh(t.alignments)},O=R,N.prototype.dispose=function(){var t=this;t.Nd&&(t.Nd.dispose(),t.Nd=h),t.xd=h},N.prototype.nv=function(t){var e="";if(l(t.locked)||(e+="l:"+k(t.locked)+","),l(t.hidden)||(e+="hi:"+k(t.hidden)+","),e)return this.Nd.getTextIndex(e.substring(0,e.length-1))},N.prototype.ev=function(t){var e,n,n,i,e=this,n=e.xd;return n[t]||(n=e.Nd.getText(t),i=new f.Style,n.split(",").forEach(function(t){var t=t.split(":"),e=t[0],t=t[1];"l"===e?i.locked=v(t):"hi"===e&&(i.hidden=v(t))}),i)},N.prototype.iv=function(t){t.protections=this.Nd.wh()},N.prototype.rv=function(t){this.Nd.yh(t.protections)},V=N,H.prototype.dispose=function(){var t=this;t.kd&&(t.kd.dispose(),t.kd=h),t.Dd&&(t.Dd.dispose(),t.Dd=h),t._d&&(t._d.dispose(),t._d=h),t.Ed&&(t.Ed.dispose(),t.Ed=h),t.jd&&(t.jd.dispose(),t.jd=h),t.Vve&&(t.Vve.dispose(),t.Vve=h),t.Yve&&(t.Yve.dispose(),t.Yve=h)},H.prototype.cv=function(t,e){var n,i,r,r,r,r,r,r,e,r,r,r,n=this,i="";if(t&&((r=n.Vve.nv(t))!==h&&e&&(i+="a:"+r+","),(r=n.Ed.nv(t))!==h&&(i+="c:"+r+","),(r=n._d.nv(t))!==h&&(i+="f:"+r+","),(r=n.jd.nv(t))!==h&&(i+="b:"+r+","),(r=n.Dd.nv(t))!==h&&(i+="j:"+r+","),(r=n.Yve.nv(t))!==h&&e&&(i+="pr:"+r+","),e=n.yd,l(t.cellType)||(r=e.getObjectIndex(t.cellType),l(r))||(i+="ct:"+r+","),l(t.cellButtons)||(r=e.getObjectIndex(t.cellButtons),l(r))||(i+="cb:"+r+","),l(t.dropDowns)||(r=e.getObjectIndex(t.dropDowns),l(r))||(i+="dd:"+r+","),""!==(i=i.substring(0,i.length-1))))return n.kd.getTextIndex(i)},H.prototype.fv=function(t,o,a,s){var u,t,c,u=this,t=u.kd.getText(t);if(t)return o=o||new f.Style,c=u.yd,t.split(",").forEach(function(t){var t,e,n,i,i,r,i,r,i,r,t=t.split(":"),e=t[0],n=t[1];switch(e){case"a":s&&(i=u.Vve.ev(+n),E(o,i));break;case"c":i=u.Ed.ev(+n,a),o.backColor=i;break;case"f":r=u._d.ev(+n),E(o,r);break;case"pf":r=u.Lfe.ev(+n),E(o,r);break;case"b":i=u.jd.ev(+n),E(o,i);break;case"j":r=u.Dd.ev(+n),E(o,r);break;case"pr":s&&(i=u.Yve.ev(+n),E(o,i));break;case"ct":(r=K(c,n))&&(o.cellType=r);break;case"cb":o.cellButtons=JSON.parse(c.getObject(+n));break;case"dd":o.dropDowns=JSON.parse(c.getObject(+n))}}),o},H.prototype.iv=function(){var t=this,e={};return e.cellXfs=t.kd.wh(),t.Dd.iv(e),t._d.iv(e),t.Ed.iv(e),t.jd.iv(e),t.Vve.iv(e),t.Yve.iv(e),e},H.prototype.rv=function(t){var e;t&&(e=this,t)&&(e.kd.yh(t.cellXfs),e.Dd.rv(t),e._d.rv(t),e.Lfe.rv(t,!0),e.Ed.rv(t),e.jd.rv(t),e.Vve.rv(t),e.Yve.rv(t))},i=H,t.SharedDxfs=i,U.prototype.dispose=function(){var t=this;t.Od&&(t.Od.dispose(),t.Od=h),t.cd&&(t.cd.dispose(),t.cd=h),t.yd&&(t.yd.dispose(),t.yd=h),t.Dd&&(t.Dd.dispose(),t.Dd=h),t._d&&(t._d.dispose(),t._d=h),t.Ed&&(t.Ed.dispose(),t.Ed=h),t.jd&&(t.jd.dispose(),t.jd=h),t.Rd&&(t.Rd.dispose(),t.Rd=h),t.Bd&&(t.Bd.dispose(),t.Bd=h),t.Ld&&(t.Ld.dispose(),t.Ld=h),t.kd&&(t.kd.dispose(),t.kd=h),t.Fd={},t.Pd={},t.Gd={},t.Ud={},t.Hd={},t.Vd={},t.zd.length=0,t.Yd={},t.Zd={},t.originCellXfs&&(t.originCellXfs.dispose(),t.originCellXfs=h),t.originNamedStylesXfs&&(t.originNamedStylesXfs.dispose(),t.originNamedStylesXfs=h),t.Wd={},t.Qd={},t.Kd={}},U.prototype.lv=function(t,e,n,i){var r,o,a,s,n,n,n,n,e,i,n,e,i,n,e,u,i,r=this,o=r.cd,a=r.yd,s="";return n!==h&&(s+="t:"+n+","),(n=r.Ed.nv(t))!==h&&(s+="c:"+n+","),(n=r._d.nv(t))!==h&&(s+="f:"+n+","),n=t.hAlign,l(n)||!i&&((3===e||!e)&&3===n||2===e&&1===n||1===e&&1===n)||(s+="h:"+n+","),n=t.vAlign,2===e&&1===n||1===e&&1===n||(l(n)?i||(s+="v:0,"):s+="v:"+n+","),(e=r.jd.nv(t))!==h&&(s+="b:"+e+","),l(t.locked)||(s+="l:"+k(t.locked)+","),l(t.hidden)||(s+="hi:"+k(t.hidden)+","),l(t.wordWrap)||(s+="w:"+k(t.wordWrap)+","),l(t.showEllipsis)||(s+="se:"+k(t.showEllipsis)+","),l(t._showTip)||(s+="st:"+k(t._showTip)+","),l(t.shrinkToFit)||(s+="s:"+k(t.shrinkToFit)+","),l(t.tabStop)||(s+="ts:"+k(t.tabStop)+","),l(t.quotePrefix)||(s+="q:"+k(t.quotePrefix)+","),l(t.isVerticalText)||(s+="va:"+k(t.isVerticalText)+","),l(t.applyFont)||(s+="y:"+k(t.applyFont)+","),l(t.applyFill)||(s+="z:"+k(t.applyFill)+","),l(t.applyAlignment)||(s+="r:"+k(t.applyAlignment)+","),l(t.applyBorder)||(s+="e:"+k(t.applyBorder)+","),l(t.applyProtection)||(s+="u:"+k(t.applyProtection)+","),l(t.applyNumberFormat)||(s+="g:"+k(t.applyNumberFormat)+","),l(t.textIndent)||(s+="i:"+t.textIndent+","),i=t.imeMode,l(i)||1===i||(s+="im:"+i+","),l(t.opacity)||(s+="o:"+t.opacity+","),l(t.backgroundImageLayout)||(s+="bl:"+t.backgroundImageLayout+","),l(t.textOrientation)||(s+="x:"+t.textOrientation+","),l(t.backgroundImage)||(s+="bi:"+o.getTextIndex(t.backgroundImage)+","),l(t.watermark)||(s+="k:"+o.getTextIndex(t.watermark)+","),l(t.cellPadding)||(s+="p:"+o.getTextIndex(t.cellPadding)+","),l(t.textBaseline)||(s+="tb:"+o.getTextIndex(t.textBaseline)+","),l(t.labelOptions)||(s+="lo:"+o.getTextIndex(JSON.stringify(t.labelOptions))+","),l(t.cellType)||(n=a.getObjectIndex(t.cellType),l(n))||(s+="ct:"+n+","),l(t.cellButtons)||(e=a.getObjectIndex(t.cellButtons),l(e))||(s+="cb:"+e+","),l(t.dropDowns)||(i=a.getObjectIndex(t.dropDowns),l(i))||(s+="dd:"+i+","),l(t.decoration)||(n=a.getObjectIndex(t.decoration),l(n))||(s+="dc:"+n+","),l(t.mask)||(e=a.getObjectIndex(t.mask),l(e))||(s+="ma:"+e+","),!l(t.formatter)&&m(t.formatter)&&(s+="fs:"+(u=o.getTextIndex(t.formatter))+","),(i=r.Dd.nv(t))!==h&&(s+="j:"+i+","),l(t.textDirection)||(s+="td:"+t.textDirection+","),s.substring(0,s.length-1)},U.prototype.vv=function(t,r){var o,a,s,u,c;if(t)return o=new f.Style,s=(a=this).cd,u=a.yd,c=a.Hd,t.split(",").forEach(function(t){var t,e,n,i,i,i,i,i,t=t.split(":"),e=t[0],n=t[1];switch(e){case"t":o.sheetId=+n;break;case"c":i=a.Ed.ev(+n),o.backColor=i;break;case"f":i=a._d.ev(+n),E(o,i);break;case"h":o.hAlign=+n;break;case"v":o.vAlign=+n;break;case"b":i=a.jd.ev(+n,r),E(o,i);break;case"l":o.locked=v(n);break;case"hi":o.hidden=v(n);break;case"w":o.wordWrap=v(n);break;case"se":o.showEllipsis=v(n);break;case"st":o._showTip=v(n);break;case"s":o.shrinkToFit=v(n);break;case"ts":o.tabStop=v(n);break;case"q":o.quotePrefix=v(n);break;case"va":o.isVerticalText=v(n);break;case"y":o.applyFont=v(n);break;case"z":o.applyFill=v(n);break;case"r":o.applyAlignment=v(n);break;case"e":o.applyBorder=v(n);break;case"u":o.applyProtection=v(n);break;case"g":o.applyNumberFormat=v(n);break;case"i":o.textIndent=+n;break;case"im":o.imeMode=+n;break;case"o":o.opacity=+n;break;case"bl":o.backgroundImageLayout=+n;break;case"x":o.textOrientation=+n;break;case"bi":o.backgroundImage=s.getText(+n);break;case"n":o.parentName=l(n)||!r&&0==+n?h:c[n];break;case"k":o.watermark=s.getText(+n);break;case"p":o.cellPadding=s.getText(+n);break;case"tb":o.textBaseline=s.getText(+n);break;case"lo":o.labelOptions=JSON.parse(s.getText(+n));break;case"ct":(i=K(u,n))&&(o.cellType=i);break;case"cb":o.cellButtons=JSON.parse(u.getObject(+n));break;case"dd":o.dropDowns=JSON.parse(u.getObject(+n));break;case"dc":o.decoration=JSON.parse(u.getObject(+n));break;case"ma":o.mask=JSON.parse(u.getObject(+n));break;case"fs":o.formatter=s.getText(+n);break;case"j":i=a.Dd.ev(+n),E(o,i);break;case"td":o.textDirection=+n}}),o},U.prototype.mv=function(t,e){var n=this;if(!l(t))return t=e&&n.gv&&n.gv[t]&&n.gv[t][e]?n.gv[t][e]:t},U.prototype.getNamedStyle=function(t,e,n){var i,r,o,o,i=this,r,o=i.Rd.getText(t);if(o!==h)return(o=o?i.vv(o,n):new f.Style).name=e,i.Hd[t]=e,o},U.prototype.getNamedStyleIndex=function(t,e,n,i,r){var o,a,s,u,c,f,l,n;if(t)return a=(o=this).Rd,s=o.Pd,u=o.qd,f=o.Kd,l=t.name,l=o.mv(l,n),n=o.lv(t,e,i,!0),r&&(!l||u.test(l))||(c=a.getTextIndex(n),f[s[l]=c]={parentName:t.parentName,name:l}),c},U.prototype.updateNamedStylesParentName=function(){var t=this,i=t.Rd,r=t.Pd,o=t.Kd;Object.keys(o).forEach(function(t){var e,n,e,t,t,e=o[t],n=e.parentName,e=e.name;l(n)||l(r[n])||(t=i.getText(+t),t=i.getTextIndex(t+(0<t.length?",n:":"n")+r[n]),r[e]=+t)})},U.prototype.addStyleParent=function(t,e,n){var n,i,r,o,a,s;if(e)for(r=(i=this).originNamedStylesXfs,o=n?t:null==(n=e.u8(t))?void 0:n.parentName;o&&a!==o;)r.setTextValue(o),o=null==(s=e.u8(o))?void 0:s.parentName,a=null==s?void 0:s.name},U.prototype.getStyle=function(t){var e,n,i,i,r,o,o,e=this,n,i=e.Yd[t];return i!==h?i:(r=(i=e.Ud)[t])!==h?r:(o=(o=e.Bd)&&o.getText(t))!==h?(r=e.vv(o,!1),i[t]=r):void 0},U.prototype.getStyleIndex=function(t,e,n){var i,r,o,a,s,u,c,f,a,f,l;if(t)return o=(i=this).Pd,a=i.Rd,s=i.Bd,u=i.qd,"string"==typeof t?(f=o[t=i.mv(t,n)],(c=a.getText(f))?(c.length&&","!==c[c.length-1]&&(c+=","),+s.getTextIndex(c+="d:"+f)):void 0):(a=t._id,f=i.Fd,a!==h&&(r=f[a])!==h?r:((l=t.name)!==h&&!u.test(l)||(l=t.parentName),l=i.mv(l,n),(c=i.lv(t,e))?(c.length&&","!==c[c.length-1]&&(c+=","),l!==h&&o[l]!==h?c+="n:"+o[l]:c+="n:0",r=s.getTextIndex(c),f[a]=r):void 0))},U.prototype.getOriginNamedStyleIndex=function(t,e){var n=this,i=n.originNamedStylesXfs;return n.addStyleParent(t,e),+i.getTextIndex(t)},U.prototype.getOriginStyleIndex=function(t,e,n){var i,r,o,r,a,a,r,n,i=this,r=i.Wd,o=i.originCellXfs;return t?(a=t._id)!==h&&(r=r[a])!==h?r:(a=i.Pd,r=i.lv(t,n,void 0,!0),t.name&&!l(a[t.name])&&(r.length&&","!==r[r.length-1]&&(r+=","),r+="d:"+a[t.name]),(n=t.parentName)&&!l(a[n])&&(i.addStyleParent(n,e,!0),r.length&&","!==r[r.length-1]&&(r+=","),r+="n:"+a[n]),+o.getTextIndex(r)):+o.getTextIndex(d)},U.prototype.getOriginStyle=function(t){var e,n,i,n,e,e=this,n=e.originCellXfs,i=e.Qd;return i[t]!==h?i[t]:(n=n.getText(t))?(e=e.vv(n,!0),i[t]=e):d},U.prototype.getOriginNamedStyle=function(t){var e,n;return this.originNamedStylesXfs.getText(t)},U.prototype.getDxf=function(t,e,n,i){var r,o;return this.kd.fv(t,e,n,i)},U.prototype.getDxfIndex=function(t,e){var n,i=this.kd;return t?i.cv(t,e):h},U.prototype.addTableStyle=function(e){0<this.zd.filter(function(t){return t.name===e.name}).length||this.zd.push(e)},U.prototype.addDefaultStyleName=function(t,e){this.Vd[t]=e},U.prototype.getDefaultStyleName=function(t){return this.Vd[t]},U.prototype.getFormatCodeByNumFmtId=function(t){return this.Dd.uv(t)},U.prototype.buildDummyNamedStyles=function(t){var e,n,i,r,o,a,s,u,c,f,l,h,e=this,n=e.Bd,i=e.Jd,r=n.td.length,o=e.Yd,a=0,s=e.Hd,u=e.Xd,c=e.$d;if(s&&(Object.keys(s).forEach(function(t){var t,e,n,e,t=s[t],e=t&&t.indexOf(i);0<=e&&(n=parseInt(t.substring(e+14),10),a<n)&&(a=n),0<=(e=t&&t.indexOf(u))&&(n=parseInt(t.substring(e+19),10),c<n)&&(c=n)}),e.$d=c),0<r)for(f=0;f<r;f++)l=e.getStyle(f),h=i+(f+a),l.name=h,t.addNamedStyle(l),o[f]=h},U.prototype.yh=function(n,t){var i=this;n&&(n.sharedColors&&i.Od.yh(n.sharedColors),n.commonSharedStrings&&i.cd.yh(n.commonSharedStrings),n.cellXfs&&i.Bd.yh(n.cellXfs),n.cellStyleXfs&&i.Rd.yh(n.cellStyleXfs),n.sharedObjects&&i.yd.yh(n.sharedObjects),n.originCellXfs&&i.originCellXfs.yh(n.originCellXfs),n.originNamedStylesXfs&&i.originNamedStylesXfs.yh(n.originNamedStylesXfs),i.Ed.rv(n),i.Dd.rv(n),i._d.rv(n),i.jd.rv(n),i.kd.rv(n.dxfs),i.Vd=g(n.defaultStyleNames)||{},U.fh)&&r(U.fh,function(t,e){e.yh&&e.yh.call(i,n)})},U.prototype.wh=function(t){var n=this,i={sharedColors:n.Od.wh(),commonSharedStrings:n.cd.wh(),cellXfs:n.Bd.wh(),cellStyleXfs:n.Rd.wh(),sharedObjects:n.yd.wh(),namedStylesMap:n.Pd,defaultStyleNames:g(n.Vd),originCellXfs:n.originCellXfs.wh(),originNamedStylesXfs:n.originNamedStylesXfs.wh()};return n.Dd.iv(i),n._d.iv(i),n.Ed.iv(i),n.jd.iv(i),i.dxfs=n.kd.iv(),(0<n.zd.length||0<Object.keys(n.Vd).length)&&(i.tableStyles={n_:"tableStyles",c_:[].concat(n.zd),defaultPivotStyle:n.getDefaultStyleName("defaultPivotStyle")||"PivotStyleLight16",defaultTableStyle:n.getDefaultStyleName("defaultTableStyle")||"TableStyleMedium2",count:n.zd.length}),U.fh&&r(U.fh,function(t,e){e.wh&&e.wh.call(n,i)}),i},U.prototype.bv=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},t.StyleManager=e=U,(0,u.$e)(e)},"./dist/core/util/tasks.js":function(t,e){"use strict";var n,i,r,o,a,s,u,c,f,l;function h(t,e){this.fn=t,this.args=e}function d(t,e){var n=this;n.tasks=[],n.nextTaskFunc=t.bind(n),n.isBusyFunc=e.bind(n)}function v(t,e,n,i,r){var t=f.call(this,t,e)||this;return t.description=n,t.progress=i,t.sheetName=r,t}function g(t,e,n){void 0===n&&(n=function(t){});var t=l.call(this,t,e)||this;return t.progress=n,t}n=this&&this.__extends||(c=function(t,e){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Object.defineProperty(e,"__esModule",{value:!0}),e.LoadTasks=e.LoadTask=e.Tasks=e.Task=void 0,i=100,r=10,h.prototype.dispose=function(){this.fn=void 0,this.args=void 0},h.prototype.run=function(){this.fn.apply(null,this.args)},o=h,e.Task=o,d.prototype.addTask=function(t,e,n){this.tasks.splice(0,0,new o(t,e))},d.prototype.pushTask=function(t,e,n){this.tasks.push(new o(t,e))},d.prototype.runNextTask=function(){var t,e,n,t=this,e=t.tasks;t.isTerminated||(e.length<1?t.endingCallback&&t.endingCallback():t.isBusyFunc()?setTimeout(function(){t.runNextTask()},100):((n=t.nextTaskFunc()).run(),setTimeout(function(){t.runNextTask()},10)))},d.prototype.start=function(){var t;this.runNextTask()},d.prototype.terminate=function(){var t=this;t.tasks&&(t.tasks.forEach(function(t){t.dispose()}),t.tasks=[]),t.endingCallback=void 0,t.isTerminated=!0},e.Tasks=a=d,n(v,f=o),v.prototype.dispose=function(){this.description=void 0,this.progress=void 0,this.sheetName=void 0,f.prototype.dispose.call(this)},s=v,e.LoadTask=s,n(g,l=a),g.prototype.runNextTask=function(){var t,e,n,e,t=this,e=t.tasks,n=t.progress;t.isTerminated||(e.length<1?t.endingCallback&&t.endingCallback():t.isBusyFunc()?setTimeout(function(){t.runNextTask()},100):((e=t.nextTaskFunc()).description&&n({progress:e.progress&&e.progress(),step:e.description,sheetName:e.sheetName}),e.run(),e.dispose(),setTimeout(function(){t.runNextTask()},0)))},g.prototype.addTask=function(t,e,n,i,r){this.tasks.splice(0,0,new s(t,e,n,i,r))},g.prototype.pushTask=function(t,e,n,i,r){this.tasks.push(new s(t,e,n,i,r))},g.prototype.terminate=function(){this.progress=void 0,l.prototype.terminate.call(this)},e.LoadTasks=g},"./dist/core/util/theme.js":function(F,t,e){"use strict";var n,i,a,p,o,v,s,u,r,c,e,n,i,f,l,h,d,g,_,A,L,D,j,O,V,m,S,w,b,C,y,M,M,y,k,C;function T(e){var n=e;return function(t){return 0===arguments.length?this.yv[n]:(this.yv[e]=v(t),this)}}function x(t){return t<=0?0:t<=.0031308?255*t*12.92+.5:t<1?255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5:255}function Y(t){var e,n,i,i,r,i,r,o,i,r,o,e=t.n_.split(":").pop(),n=t.val;return"sysClr"===e?void 0!==(i=m[n.toUpperCase()])?a.ColorHelper.hexToARGB(i):(i=t.lastClr)?(r=4278190080+(16777215&parseInt(i,16)),a.ColorHelper.hexToARGB(r)):void 0:"srgbClr"===e&&n?(r=4278190080+(16777215&parseInt(n,16)),a.ColorHelper.hexToARGB(r)):"scrgbClr"===e?(i=parseFloat(t._r),r=parseFloat(t.g),o=parseFloat(t.b),{a:255,r:x(i),g:x(r),b:x(o)}):"hslClr"===e?(i=parseFloat(t.wv),r=parseFloat(t.sat),o=parseFloat(t.lum),a.util.v1(i,o,r)):"prstClr"===e&&n?a.util.m1(n):void 0}function G(t){var t=t.toString(16).toUpperCase();return t=1===t.length?"0"+t:t}function B(t,e){return{n_:t,c_:[{n_:"srgbClr",val:G(e.r)+G(e.g)+G(e.b)}]}}function I(t,e,n,i,r,o,a,s,u,c,f,l,h){this.background1=T(0),this.background2=T(1),this.textColor1=T(2),this.textColor2=T(3),this.accent1=T(4),this.accent2=T(5),this.accent3=T(6),this.accent4=T(7),this.accent5=T(8),this.accent6=T(9),this.hyperlink=T(10),this.followedHyperlink=T(11),this.Zc=t,this.yv=[];for(var d=1;d<13;d++)this.yv.push(v(arguments[d]))}function P(t){return t=t&&"'"===t[0]?t.slice(1,t.length-1):t}function R(t,e,n){this.Zc=t,this.Ide=e,this.See=n}function N(t,e,n,i){var r,o,r=this;this.name=u("name"),this.colors=u("colors"),this.fmtTheme=u("fmtTheme",void 0,function(){r.Mv={}}),(o=this).name(t),o.colors(e||new w(t)),"string"!=typeof n&&n instanceof b?this.font(n):this._font=new b(void 0,n,i)}function E(){}function H(){}function U(){}Object.defineProperty(t,"__esModule",{value:!0}),t.Themes=t.ThemeFonts=t.ThemeColors=t.Theme=t.ThemeFont=t.ColorScheme=void 0,n=e("Common"),i=e("./dist/core/util/common.js"),a=e("./dist/core/util/common.js"),p=n.Common.lt.ht,o=n.Common.ft,v=o._,s=parseInt,u=i.util.p0,r=a.util.xr,c=a.util.o1,e="Gill Sans MT",n="Franklin Gothic Book",i="Trebuchet MS",l=1,h=2,d=3,g=4,_=5,A=6,L=7,D=8,j=9,O=10,V=11,m={"3DDKSHADOW":4288716960,"3DLIGHT":4293125091,ACTIVEBORDER:4290032820,ACTIVECAPTION:4288263377,APPWORKSPACE:4289440683,BACKGROUND:1044480,BTNFACE:4293980400,BTNHIGHLIGHT:4294967295,BTNSHADOW:4288716960,BTNTEXT:1044480,CAPTIONTEXT:1044480,GRAYTEXT:4285361517,HIGHLIGHT:4281571839,HIGHLIGHTTEXT:4294967295,INACTIVEBORDER:4294244348,INACTIVECAPTION:4290760155,INACTIVECAPTIONTEXT:4282601044,INFOBK:4294967265,INFOTEXT:1044480,MENU:4293980400,GRADIENTACTIVECAPTION:4290367978,HOTLIGHT:267413196,GRADIENTINACTIVECAPTION:4292338930,MENUBAR:4293980400,MENUHIGHLIGHT:4281571839,MENUTEXT:1044480,SCROLLBAR:4291348680,WINDOW:4294967295,WINDOWFRAME:4284769380,WINDOWTEXT:4278190080},(C=S=S||{})[C.lt1=f=0]="lt1",C[C.lt2=1]="lt2",C[C.dk1=2]="dk1",C[C.dk2=3]="dk2",C[C.accent1=4]="accent1",C[C.accent2=5]="accent2",C[C.accent3=6]="accent3",C[C.accent4=7]="accent4",C[C.accent5=8]="accent5",C[C.accent6=9]="accent6",C[C.hlink=10]="hlink",C[C.folHlink=11]="folHlink",I.prototype.name=function(t){return 0===arguments.length?this.Zc:(this.Zc=t,this)},I.prototype.getColor=function(t){var e,n,i,r,n;if(t&&"string"==typeof t&&(n=void 0,e=t.split(" "))){if(i=-1,1<(r=e.length)){if(!e[0])return t;"background"===(n=e[0].toLowerCase())?i=s(e[1],10)-1:"text"===n?i=s(e[1],10)+1:"accent"===n&&(i=s(e[1],10)+3)}else 1===r&&("hyperlink"===(n=e[0].toLowerCase())?i=10:"followedhyperlink"===n&&(i=11));if(0<=i&&i<=11)return 2<r?(n=s(e[2],10)/100,o.j(o.Cv(this.yv[i],n))):o.j(this.yv[i])}return t},I.prototype.toJSON=function(){var t=this,e=t.yv;return{name:t.Zc,background1:e[0],background2:e[1],text1:e[2],text2:e[3],accent1:e[4],accent2:e[5],accent3:e[6],accent4:e[7],accent5:e[8],accent6:e[9],hyperlink:e[10],followedHyperlink:e[11]}},I.prototype.fromJSON=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,i,e,e;function m(t,e){p(e)||(n.yv[t]={a:e.a,r:e.r,g:e.g,b:e.b})}t&&(n=this,i="_colorList",i=e?(e=t.name||t[r="_name"],p(e)||(n.Zc=e),o=(e=t.colorList||t[i])[0],a=e[1],s=e[2],u=e[3],c=e[4],f=e[5],l=e[6],h=e[7],d=e[8],v=e[9],g=e[10],e[11]):(p(t.name)||(n.Zc=t.name),o=t.background1,a=t.background2,s=t.text1,u=t.text2,c=t.accent1,f=t.accent2,l=t.accent3,h=t.accent4,d=t.accent5,v=t.accent6,g=t.hyperlink,t.followedHyperlink),m(0,o),m(1,a),m(2,s),m(3,u),m(4,c),m(5,f),m(6,l),m(7,h),m(8,d),m(9,v),m(10,g),m(11,i))},I.prototype.yh=function(t){var e,n,i,r,o,a,o;if(t)for(n=t.c_,(e=this).Zc=t.name,i=0,r=n.length;i<r;i++)(o=n[i])&&(a=o.n_.split(":").pop(),o=o.c_[0],e.yv[S[a]]=Y(o))},I.prototype.wh=function(){for(var t,e,n,i,r,o,a,t=this,e={n_:"clrScheme",name:t.name()},n=[],i=t.yv,r=0,o=i.length;r<o;r++)a=i[r],2===r?n[0]=a.r+a.g+a.b===0?{n_:"dk1",c_:[{n_:"sysClr",val:"windowText",lastClr:G(a.r)+G(a.g)+G(a.b)}]}:B("dk1",a):0===r?n[1]=a.r+a.g+a.b===765?{n_:"lt1",c_:[{n_:"sysClr",val:"window",lastClr:G(a.r)+G(a.g)+G(a.b)}]}:B("lt1",a):3===r?n[2]=B("dk2",a):1===r?n[3]=B("lt2",a):n.push(B(""+S[r],a));return e.c_=n,e},I.prototype.Sv=function(t){var e,n,i,r;if(this.name()!==t.name())return!1;for(n=0,i=(e=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;n<i;n++)if(!o.Tv(this[r=e[n]](),t[r]()))return!1;return!0},w=I,t.ColorScheme=w,Object.defineProperty(R.prototype,"name",{get:function(){return this.Zc},set:function(t){this.Zc=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"headerFont",{get:function(){return this.Ide},set:function(t){this.Ide=t},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"bodyFont",{get:function(){return this.See},set:function(t){this.See=t},enumerable:!1,configurable:!0}),R.prototype.toJSON=function(){return{name:this.Zc,headerFont:this.Ide,bodyFont:this.See}},R.prototype.fromJSON=function(t){this.Zc=t.name,this.Ide=t.headerFont,this.See=t.bodyFont},b=R,t.ThemeFont=b,N.prototype.headerFont=function(t){if(0===arguments.length)return this._font.headerFont;this._font.headerFont=t},N.prototype.bodyFont=function(t){if(0===arguments.length)return this._font.bodyFont;this._font.bodyFont=t},N.prototype.font=function(t){if(0===arguments.length)return this._font;this._font=new b,this._font.fromJSON(t.toJSON())},N.prototype.getColor=function(t){return this.colors().getColor(t)},N.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headerFont():t},N.prototype.toJSON=function(){var t=this,e=t.name();return N.Av(t)?e:{name:e,themeColor:t.colors()?t.colors().toJSON():void 0,headingFont:t.headerFont(),bodyFont:t.bodyFont(),font:t._font.toJSON()}},N.prototype.fromJSON=function(t){var e;"string"==typeof t?(e=k[t],this.name(e.name()),this.colors(e.colors()),this.headerFont(e.headerFont()),this.bodyFont(e.bodyFont()),this.font(e.font())):(this.name(t.name),this.bodyFont(t.bodyFont),this.headerFont(t.headingFont),this.colors().fromJSON(t.themeColor),t.font&&this._font.fromJSON(t.font))},N.prototype.wh=function(t){var e,n,i,r,t,e=this,n=e.name();return!1!==t&&N.Av(e)?n:(t={n_:"themeElements",c_:[]},(r=(i=e.colors())?i.wh():r)&&t.c_.push(r),t.c_.push({n_:"fontScheme",c_:[{n_:"majorFont",c_:[{n_:"latin",typeface:P(e.headerFont())}]},{n_:"minorFont",c_:[{n_:"latin",typeface:P(e.bodyFont())}]}],name:e._font.name}),{n_:"theme",name:n,c_:[t]})},N.prototype.yh=function(t){var e,t,n,i,n,i,e=this;"string"==typeof t?e.Iv(t):(e.Iv(t.name),t=r(t,"themeElements"),n=r(t,"clrScheme"),(i=new w("")).yh(n),e.colors(i),(n=r(t,"fontScheme"))&&(e.headerFont(c(n,"majorFont&latin").typeface),e.bodyFont(c(n,"minorFont&latin").typeface),n.name)&&(e._font.name=n.name),(i=r(t,"fmtScheme"))&&e.fmtTheme(i))},N.prototype.Iv=function(t){var e,t,e=this;t&&"OFFICE"===t.toUpperCase().trim()&&(t="Office"),e.name(t),(t=k[t])&&(e.colors(t.colors()),e.font(t.font()))},N.Av=function(t){var e,e,e=t.name();return!!k[e]&&(e=k[e],t.bodyFont()===e.bodyFont())&&t.headerFont()===e.headerFont()&&t.font().name===e.font().name&&t.colors().Sv(e.colors())},C=N,t.Theme=C,E.Default=new w("Default",M="#FFFFFF","#EEECE1",y="#000000","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),E.Office2007=new w("Office2007",M,"#EEECE1",y,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),E.Office=new w("Office",M,"#E7E6E6",y,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),E.Apex=new w("Apex",M,"#C9C2D1",y,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),E.Aspect=new w("Aspect",M,"#E3DED1",y,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),E.Concourse=new w("Concourse",M,"#DEF5FA",y,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),E.Civic=new w("Civic",M,"#C5D1D7",y,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),E.Oriel=new w("Oriel",M,"#FFF39D",y,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),E.Origin=new w("Origin",M,"#DDE9EC",y,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),E.Paper=new w("Paper",M,"#FEFAC9",y,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),E.Solstice=new w("Solstice",M,"#E7DEC9",y,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),E.Technic=new w("Technic",M,"#D4D2D0",y,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),E.Trek=new w("Trek",M,"#FBEEC9",y,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),E.Urban=new w("Urban",M,"#DEDEDE",y,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),E.Verve=new w("Verve",M,"#D2D2D2",y,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),E.Equity=new w("Equity",M,"#E9E5DC",y,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),E.Flow=new w("Flow",M,"#DBF5F9",y,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),E.Foundry=new w("Foundry",M,"#EAEBDE",y,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),E.Median=new w("Median",M,"#EBDDC3",y,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),E.Metro=new w("Metro",M,"#D6ECFF",y,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),E.Module=new w("Module",M,"#D4D4D6",y,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),E.Opulent=new w("Opulent",M,"#F4E7ED",y,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),t.ThemeColors=M=E,H.Office=new b("Office","Calibri Light","Calibri"),H.Office2007=new b("Office2007","Cambria","Calibri"),H.LucidaBook=new b("LucidaBook","Lucida Sans","Book Antiqua"),H.Verdana=new b("Verdana","Verdana","Verdana"),H.LucidaSansUnicode=new b("LucidaSansUnicode","Lucida Sans Unicode","Lucida Sans Unicode"),H.Georgia=new b("Georgia","Georgia","Georgia"),H.CenturySchoolbook=new b("CenturySchoolbook","Century Schoolbook","Century Schoolbook"),H.BookmanGillSansMT=new b("BookmanGillSansMT","Bookman Old Style",e),H.Constantia=new b("Constantia","Constantia","Constantia"),H.GillSansMT=new b("GillSansMT",e,e),H.FranklinGothicArial=new b("FranklinGothicArial",n,"Arial"),H.FranklinGothic=new b("FranklinGothic","Franklin Gothic Medium",n),H.TrebuchetGeorgia=new b("TrebuchetGeorgia",i,"Georgia"),H.CenturyGothic=new b("CenturyGothic","Century Gothic","Century Gothic"),H.FranklinGothicPerpetua=new b("FranklinGothicPerpetua",n,"Perpetua"),H.CalibriConstantia=new b("CalibriConstantia","Calibri","Constantia"),H.Rockwell=new b("Rockwell","Rockwell","Rockwell"),H.TwCenMT=new b("TwCenMT","Tw Cen MT","Tw Cen MT"),H.ConsolasCorbel=new b("ConsolasCorbel","Consolas","Corbel"),H.Corbel=new b("Corbel","Corbel","Corbel"),H.TrebuchetMS=new b("TrebuchetMS",i,i),t.ThemeFonts=y=H,U.Default=new C("Default",M.Default,"Cambria","Calibri"),U.Office=new C("Office",M.Office,y.Office),U.Office2007=new C("Office2007",M.Office2007,y.Office2007),U.Apex=new C("Apex",M.Apex,y.LucidaBook),U.Aspect=new C("Aspect",M.Aspect,y.Verdana),U.Concourse=new C("Concourse",M.Concourse,y.LucidaSansUnicode),U.Civic=new C("Civic",M.Civic,y.Georgia),U.Oriel=new C("Oriel",M.Oriel,y.CenturySchoolbook),U.Origin=new C("Origin",M.Origin,y.BookmanGillSansMT),U.Paper=new C("Paper",M.Paper,y.Constantia),U.Solstice=new C("Solstice",M.Solstice,y.GillSansMT),U.Technic=new C("Technic",M.Technic,y.FranklinGothicArial),U.Trek=new C("Trek",M.Trek,y.FranklinGothic),U.Urban=new C("Urban",M.Urban,y.TrebuchetGeorgia),U.Verve=new C("Verve",M.Verve,y.CenturyGothic),U.Equity=new C("Equity",M.Equity,y.FranklinGothicPerpetua),U.Flow=new C("Flow",M.Flow,y.CalibriConstantia),U.Foundry=new C("Foundry",M.Foundry,y.Rockwell),U.Median=new C("Median",M.Median,y.TwCenMT),U.Metro=new C("Metro",M.Metro,y.ConsolasCorbel),U.Module=new C("Module",M.Module,y.Corbel),U.Opulent=new C("Opulent",M.Opulent,y.TrebuchetMS),k=U,t.Themes=k},"./dist/core/workbook/customDocPropsManager.js":function(t,e,n){"use strict";var i,r,n,o,a,u,c,s,f,l,h,d,i;function v(t){this.FN={},this.Vv=t}Object.defineProperty(e,"__esModule",{value:!0}),e.CustomDocPropsManager=void 0,i=n("Common"),r=n("CalcEngine"),n=n("./dist/core/worksheet/worksheet-model.js"),o=i.Common.lt.ht,a=i.Common.zf.j0,u=i.Common.zf.dI,(i=c=c||{}).text="lpwstr",i.int="i4",i.float="r8",i.boolean="bool",i.date="filetime",s="{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",f={i4:"number",lpwstr:"string",r8:"number",bool:"boolean",filetime:"object"},l=2147483647,h=4294967295,v.prototype.all=function(t){var e,n,e,e,n=this.Vv,e=null==(e=n.Dp)?void 0:e.docPropsCustom;if(t||e)return t&&(n.Dp||(n.Dp={docPropsCustom:[]}),n.Dp.docPropsCustom||(n.Dp.docPropsCustom=[]),e=this.BN(t),n.Dp.docPropsCustom=e,this.rL()),this.glt(n.Dp.docPropsCustom)},v.prototype.getAllDocPropsProps=function(){var t,e,n,e=this.Vv,n;if(null==(t=e.Dp)?void 0:t.docPropsCustom)return this.glt(e.Dp.docPropsCustom,!0)},v.prototype.get=function(e){var t,n,t,t,n,t=null==(t=this.Vv.Dp)?void 0:t.docPropsCustom;if(t)return(t=t.find(function(t){return t.name===e}))&&this.Dht(t)},v.prototype.add=function(e,t,n){var i,r,o,a,o,s,u,c,f,l,r,i;if(null!=e&&""!==e&&null!=t){if(s=null==(o=null==(o=(a=this.Vv).Dp)?void 0:o.docPropsCustom)?void 0:o.find(function(t){return t.name===e})){if(n){if(!(u=this.wdt(a,t)))return;c=u.nameInfo,f=u.linkTarget,r="number"==typeof(l=this.Mdt(u.nameInfo))?this.HVe(l):l,s.linkTarget=f,s.propertyItemChildElement=((i={})[this.Bdt(l)]=r+"",i),this.FN["".concat(c.getRow(),",").concat(c.getColumn())]=f}else s.propertyItemChildElement=((r={})[this.Bdt(t)]=t+"",r);this.remove(e)}else if(i=o?o.reduce(function(t,e){return Math.max(t,parseInt(e.pid,10))},0):1,n){if(!(u=this.wdt(a,t)))return;c=u.nameInfo,f=u.linkTarget,l=this.Mdt(c),s=this.Wgt({name:e,value:l,linkTarget:f},i+1),this.FN["".concat(c.getRow(),",").concat(c.getColumn())]=s.linkTarget}else s=this.Wgt({name:e,value:t},i+1);a.Dp||(a.Dp={docPropsCustom:[]}),a.Dp.docPropsCustom||(a.Dp.docPropsCustom=[]),a.Dp.docPropsCustom.push(s)}},v.prototype.remove=function(e){var t,n,i,t,r,n;this.get(e)&&(t=null==(t=(i=this.Vv).Dp)?void 0:t.docPropsCustom)&&0<=(r=t.findIndex(function(t){return t.name===e}))&&t.splice(r,1)},v.prototype.clear=function(){var t,e,e;null!=(t=this.Vv.Dp)&&delete t.docPropsCustom},v.prototype.Bdt=function(t){var e="";switch(typeof t){case"string":e=c.text;break;case"number":e=Number.isInteger(t)&&0<=t&&t<=h?c.int:c.float;break;case"boolean":e=c.boolean;break;case"object":e=t instanceof Date?c.date:c.text;break;default:e=c.text}return"vt:".concat(e)},v.prototype.BN=function(t,n){var i,r,i=this;return void 0===n&&(n=2),t?(r=[],t.forEach(function(t,e){r.push(i.Wgt(t,n+e))}),r):[]},v.prototype.Wgt=function(t,e){var t,e,n,i,t,e={fmtid:s,pid:e+"",name:a(t.name),propertyItemChildElement:{}};return t.linkTarget&&(e.linkTarget=t.linkTarget),n=this.Bdt(t.value),i=a(t.value?t.value+"":""),n.split(":")[1]===c.date?((t=t.value.toISOString().split("."))[t.length-1].endsWith("Z")&&(t[t.length-1]="Z"),i=t.join("")):n.split(":")[1]===c.int&&(i=this.YVe(parseInt(i,10))+""),e.propertyItemChildElement=((t={})[n]=i,t),e},v.prototype.glt=function(t,e){var n,i,n=this;return t?(i=[],t.forEach(function(t){i.push(n.Dht(t,e))}),i):[]},v.prototype.Dht=function(t,e){var n,i,r,o,a,s,i,i,i,i,r={name:u(t.name)};if(t.linkTarget)r.linkTarget=t.linkTarget,o=Object.keys(t.propertyItemChildElement).find(function(t){return t.startsWith("vt:")}),s=t.propertyItemChildElement[o],i=this.Vv,(i=this.wdt(i,t.linkTarget))?(r.value=this.Mdt(i.nameInfo),s!==(i="number"==typeof r.value?this.HVe(r.value):r.value)&&((i=i)instanceof Date&&(i=i.toISOString()),t.propertyItemChildElement=((n={})[this.Bdt(r.value)]=i+"",n))):r.value=s;else switch(o=(i=Object.entries(t.propertyItemChildElement)[0])[0],a=i[1],o.split(":")[1]){case c.int:r.value=this.HVe(parseInt(a,10));break;case c.float:r.value=parseFloat(a);break;case c.boolean:r.value=Boolean(a);break;case c.date:r.value=new Date(a);break;default:c.text;r.value=u(a)}return e&&(r.type=o&&f[o.split(":")[1]],r.type||(r.type="string")),r},v.prototype.Mdt=function(t){var t,t,e,e,n,i,t,t=t.getExpression(),e=this.Vv;return t.type===r.ExpressionType.error?"":(e=t.value||(t.source?e.getCalcService().evaluateExpression(t.source,t,{}):e.getCalcService().evaluateExpression(e.getCalcService().getGlobalSourceModel().getSource(),t,{})),o(e)&&(n=t.row,i=t.column,e=(t=null==(t=t.source)?void 0:t.Mf)&&t.getValue(n,i)),e)},v.prototype.wdt=function(t,e){var n,i,r,o,a,s,u,c,f,r,n=t.getCustomName(e),i=e;if(!n)if(1===(r=e.split("!")).length){for(a=0,s=o=t.sheets;a<s.length;a++)if(c=(u=s[a]).getCustomName(e)){n=c,i=u.name()+"!"+e;break}if(!n)return}else{if(f=r.slice(0,r.length-1).join("!"),r=r[r.length-1],!(u=t.getSheetFromName(f)))return;if(!(n=u.getCustomName(r)))return}return{nameInfo:n,linkTarget:i}},v.prototype.rL=function(){var t,e,n,t,i,r,o,e,a,e,n=this.Vv,t=null==(t=n.Dp)?void 0:t.docPropsCustom;if(t)for(this.FN={},i=0,r=t;i<r.length;i++)(o=r[i]).linkTarget&&(e=null==(e=this.wdt(n,o.linkTarget))?void 0:e.nameInfo)&&(a=e.getExpression().row,e=e.getExpression().column,this.FN["".concat(a,",").concat(e)]=o.linkTarget)},v.prototype.vIt=function(t,e,i){var r,o,n,a,r=this;this.FN.hasOwnProperty("".concat(t,",").concat(e))&&(o=this.FN["".concat(t,",").concat(e)],(a=(n=this.Vv).Dp.docPropsCustom).forEach(function(t){var t,e,n;t.linkTarget===o&&(e=r.Bdt(i),n=("number"===f[e.split(":")[1]]?r.YVe(i):i)+"",t.propertyItemChildElement=((t={})[e]=n,t))}))},v.prototype.YVe=function(t){return l<t&&t<=h?t>>0:t},v.prototype.HVe=function(t){return t<0?t>>>0:t},e.CustomDocPropsManager=v,n.Y8.ch("customDocProps",{setValue:function(t){var e,n,i,t,r,n=t.row,i=t.col,t=t.value,r=this.Mf.getParent();null!=(e=null==r?void 0:r.docProps)&&e.customDocPropsManager&&r.docProps.customDocPropsManager.vIt(n,i,t)}})},"./dist/core/workbook/customThemeManager.js":function(t,e){"use strict";var n,i;function r(t,e){this.Vv=t,this.tkt=[],this.jkt=e.create,this.Ekt=e.buildIn,this.OHe=e.prefixName}n=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(e,"__esModule",{value:!0}),e.CustomThemeManagerBase=void 0,Object.defineProperty(r.prototype,"iPt",{get:function(){return this.tkt.reduce(function(t,e,n){return e.name()||e.name("theme-".concat(Math.floor(1e8*Math.random()))),t[e.name().toLowerCase()]=n,t},{})},enumerable:!1,configurable:!0}),r.prototype.lan=function(t){return this.iPt.hasOwnProperty(t.toLowerCase())},r.prototype.Oan=function(t){return this.iPt[t.toLowerCase()]},r.prototype.THe=function(t,e){return t&&e&&t.toUpperCase()===e.toUpperCase()},r.prototype.kHe=function(t,e){},r.prototype.EHe=function(e){var n=this;return!!e&&!this.tkt.some(function(t){return n.THe(e,t.name())})&&!this.LHe(e)},r.prototype.add=function(t){var e,e;if("string"==typeof t){if(this.EHe(t))return(e=this.jkt()).name(t),this.tkt.push(e),e}else if("function"!=typeof t.builtInName||!t.builtInName())return e=t.name(),this.EHe(e)?(this.tkt.push(t),t):void 0},r.prototype.get=function(t){if(t&&this.lan(t)){var t=this.Oan(t);if(void 0!==t)return this.tkt[t]}},r.prototype.remove=function(t){var t;t&&this.lan(t)&&void 0!==(t=this.Oan(t))&&this.tkt.splice(t,1)},r.prototype.all=function(){return n([],this.tkt,!0)},r.prototype.update=function(t,e){var n,i;e.name()||e.name(t),(n=t&&this.lan(t)&&e&&!this.LHe(e.name())&&(this.lan(e.name())&&t===e.name()||!this.lan(e.name())))&&void 0!==(i=this.Oan(t))&&(this.tkt[i]=e,this.kHe(t,e))},r.prototype.isBuildInStyle=function(e){var n=this;return!this.tkt.some(function(t){return n.THe(e,t.name())})&&Object.keys(this.Ekt).some(function(t){return n.THe(t,e)})},r.prototype.LHe=function(e){var n=this;return Object.keys(this.Ekt).some(function(t){return n.THe(n.OHe+t,e)})},r.prototype.L0=function(){this.Vv=null,this.tkt=null,this.jkt=null,this.Ekt=null},e.CustomThemeManagerBase=r},"./dist/core/workbook/sheettab.js":function(t,e,n){"use strict";var i,b,r,m,p,S,o,a,s,M,l,u,c,f,h,d;function v(t){var t,e,t=d.call(this,t)||this;return t.xv=4,t.Nv="white",(e=t).kv=13,e.Dv=12,e._v=0,e.Ev=30,e.jv=28,e.Ov=28,e.Rv=p.NEW_TAB_SIZE_ASIDE,e.Bv=15,e.Lv=28,e.Fv=0,e._font="10pt Segoe UI",t}i=this&&this.__extends||(h=function(t,e){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(e,"__esModule",{value:!0}),e.Gv=void 0,r=n("Common"),m=n("./dist/core/util/common.js"),p=n("./dist/core/workbook/sheettabbase.js"),S=n("./dist/core/core.enum.js"),o=r.Common.ft,a=o.Uv,s=o._,M=m.mt.Tt,l=null,u="blank",c="nextButton",d=p.Hv,i(v,d),v.prototype.zv=function(){var t=this.Vv,t=t&&t.options;return t&&t.tabNavigationVisible?this.jv*(t.useTouchLayout?1.5:1):0},v.prototype.Wsn=function(){return 2*this.zv()},v.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Zv():0},v.prototype.Wv=function(){return this.Ov},v.prototype.Qv=function(){return this.Ov},v.prototype.Jv=function(){return this.Vv.options.newTabVisible?this.Rv:0},v.prototype.Wfn=function(){return Math.max(this.rm(),this.Ig().newTabStartPosition-this.Jv()-this.Qv())},v.prototype.Xv=function(){var t,e,n,i,r,o,a,t,s,u,c,f,e=this,n=e.Vv.qv(),i=e.$v,r=e.M2e,o=e.tm();if(e.nm()&&(o-=e.em()),a=e.im(),t=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft,s=e.ot(),u=a?t?s.x+s.width-2*e.zv()-e.em()-e.Wv():s.x+s.width-e.rm()-e.Jv()-e.Qv():s.y+s.height-e.Yv(),a&&t)o=u;else for(c=e.om,f=n.length;c<f;c++)if(n[c].visible()===S.SheetTabVisible.visible&&(o+=(a?i:r)[c]),u<o){o=u;break}return o},v.prototype.tm=function(){var t,e,n,i,n,t,i,n,e=this,n=e.Vv.options,i=e.im(),n=n.tabNavigationVisible,t=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft;return i?(i=2*e.em(),n&&(i-=e.em()),t?e.rm()+e.Jv()+e.Qv():2*e.zv()+e.Wv()+e.um()+i):(n=e.cm(),e.nm()&&(n=0),Math.max(e.Jv(),n))},v.prototype.um=function(){var t=this,e=t.Vv;return e&&e.options.tabNavigationVisible?t.rm()/2:0},v.prototype.getResizeBarBounds=function(){var t,e,n,i,e=this,n=e.ot(),i;return{x:(null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft)?n.x:n.x+n.width-e.rm(),y:l,width:e.rm(),height:l}},v.prototype.getNavButtonBounds=function(){var t,e,n,i,r,o,t,a,s,u,c,t,n,e=this,n=e.im(),u=e.ot(),c=e.zv(),t=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft,t=n?(i=t?u.x+u.width-2*c+e.rm()/2:e.rm()/2,o=c,r=l):(n=e.Yv(),i=u.width/2-c,r=u.height-n,o=c,n),a=1,s=3;return{x:i,y:r,width:o,height:t,startIndex:1,endIndex:3}},v.prototype.getSheetTabBounds=function(){var t,e,n,i,r,t,e=this,n=e.ot(),i=e.Qv(),r=e.tm(),t=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft;return!t&&e.nm()&&(r-=e.em()),{x:r,y:l,height:l,secondMoreTabWidth:e.Qv(),moreTabPos:t?Math.max(0,r-i):n.x+n.width-e.rm()-e.Jv()-i}},v.prototype.getPreMoreTabBounds=function(){var t,e,n,i,r,e=this,n=e.tm();return e.nm()&&(n-=e.em()),i=e.Xv(),{x:(r=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft)?i:n-e.Wv(),width:e.Wv()}},v.prototype.getPreMoreTabWidth=function(){return this.Wv()},v.prototype.getAllSheetsBounds=function(){var t,e,n,i,r,o,a,s,u,c,f,l,r,o,t,n,t,s,e=this,n=e.im(),i=e.Vv.options.newTabVisible,r=e.Vv.options.tabNavigationVisible,o=e.Vv.options.useTouchLayout,a=e.ot(),s=e.getNavButtonBounds(),u=e.em(),c=e.cm(),t=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft,o=(r=n?(f=t?a.x+a.width-2*s.width-u:s.x+2*s.width,f+=e.em()-e.rm()/2,0===e.rm()&&r&&(f-=e.em()),l=a.y,u):o?(n=a.x,t=a.width,i&&(n=a.x+a.width/2,t=a.width/2),f=n,l=a.y,t):(s=i?0:e.Bv/-2,f=(a.x+a.width)/2+s,l=5,u+4),c);return{x:f,y:l,width:r,height:o}},v.prototype.fm=function(){var t,e,t=this,e;return t.im()?t.lm+t.$v[t.hm]>t.dm():t.lm+2*t.M2e[t.hm]>t.dm()},v.prototype.dm=function(){var t,e,n,t,e=this,n=e.im(),t=null==(t=(0,m.jf)(e.Vv))?void 0:t.options.rightToLeft;return n?t?e.ot().width-e.Wsn()-e.em()-e.Qv():e.ot().width-e.rm()-e.Jv()-e.Qv():e.ot().height-e.Yv()},v.prototype.vm=function(){return 6},v.prototype.mm=function(){return[u,c]},v.prototype.gm=function(){return this.tm()},v.prototype.pm=function(t,e){var n,i,n=this;t.save(),t.beginPath(),i=m.I.He(0,"gc-tabStripBackground").backgroundColor,n.bm=s(i),t.fillStyle=i,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},v.prototype.ym=function(t,e){var n,i,i,r,o,a,s,u,n,i=this.Vv,i=i&&i.options.tabStripPosition,r=m.I.He(0,"gc-tabStripBackground").borderTopColor;t.save(),t.beginPath(),t.strokeStyle=r,i===S.TabStripPosition.bottom?(o=e.x,a=e.y,s=e.x+e.width,u=e.y+.5):i===S.TabStripPosition.top?(o=e.x,a=e.height-.5,s=e.x+e.width,u=e.y+e.height-.5):i===S.TabStripPosition.left?(o=e.x+e.width-.5,a=e.y,s=e.x+e.width-.5,u=e.y+e.height):i===S.TabStripPosition.right&&(o=e.x+.5,a=e.y,s=e.x+.5,u=e.y+e.height),t.moveTo(o,a),t.lineTo(s,u),t.stroke(),t.restore()},v.prototype.wm=function(t,e){var n=this;n.pm(t,e),n.ym(t,e)},v.prototype.Mm=function(t,e,n){var i,r,o,a,s,i,u,c,f,n,l,h,d,s,i,d,i,c,r=this,o,a=r.Vv.options.newTabVisible,s=r.im(),i=null==(i=(0,m.jf)(r.Vv))?void 0:i.options.rightToLeft,u=r.tm(),c=r.Xv(),f=r.jv,n=n,l=0,h=f;s?(s=r.Qv(),i?((n-=s)<(i=e.x+r.rm()+r.Jv())&&(c<(d=n=i)&&(n=(d=c)-f),r.Cm(t,d,0,s,e.height)),n-=r.Jv()):(n+=s,r.nm()&&(u-=r.em()),(i=e.x+e.width-r.rm()-r.Jv())<n&&((d=(n=i)-s)<u&&(n=(d=u)+f),r.Cm(t,d,0,s,e.height))),d=e.height):(c=r.em(),r.nm()&&(c=0),n=(e.width-u)/2-c,h=d=u),a&&r.Sm(t,n,0,h,d,-2===r.Tm)},v.prototype.Am=function(t,e,n,i,r){var o,a,o,a=this.Wv(),o=null==(o=(0,m.jf)(this.Vv))?void 0:o.options.rightToLeft;this.Cm(t,o?r:i-a,0,a,e.height)},v.prototype.Im=function(t,e){var n,i,r,o,a,s,u,n,c,f,i=this,r=i.im(),o=i.xm,a=i.zv(),s=i.Yv(),u=i.Nm,n=null==(n=(0,m.jf)(i.Vv))?void 0:n.options.rightToLeft;r?(c=n?e.x+e.width-2*a+i.rm()/2:i.rm()/2+a/2,i.km(t,c,f=s/2,c+o,f+o,c+o,f-o,p.NavButtonDirection.left,l,1===u),i.km(t,c+=a,f,c-o,f+o,c-o,f-o,p.NavButtonDirection.right,l,2===u)):(c=(e.width-a)/2,f=e.height-s/2,i.km(t,c,f,c+o,f+o,c-o,f+o,p.NavButtonDirection.top,l,1===u),i.km(t,c+=a,f,c-o,f+o,c-o,f-o,p.NavButtonDirection.bottom,l,2===u))},v.prototype.Dm=function(t,e){var n,i,r,o,a,r,s,u,c,f,l,n,s,i=this,r=i.Vv.options,o=r.allSheetsListVisible,a=r.newTabVisible,r=r.tabNavigationVisible,s=i.im(),u=i.tm();i.nm()&&(u-=i.em()),c=0,f=10,l=i.ot(),n=null==(n=(0,m.jf)(i.Vv))?void 0:n.options.rightToLeft,s?(c=n?l.x+l.width-2*i.zv()-i.em():2*i.zv()+i.em(),0===i.rm()&&r&&(c-=i.em())):(s=a?i.em():i.em()/2,c=(e.width-u)/2+s),o!==S.AllSheetsListVisibility.hide&&i._m(t,c,10,-3===i.Tm)},v.prototype.Em=function(t,e){var n,i,i,n,r,o,n,i=this,r=i.rm(),o=m.I.He(0,"gc-tabStripResizeBarInner"),n=null==(n=(0,m.jf)(i.Vv))?void 0:n.options.rightToLeft;i.Vv.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(n?e.x:e.x+e.width-r,0,r,e.height),t.clip(),i=n?e.x+r/2:e.x+e.width-r/2,n=e.y+e.height/2,t.fillStyle=o.color,t.fillRect(i,n,2,2),t.fillRect(i,n-4,2,2),t.fillRect(i,n+4,2,2))},v.prototype.jm=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,s,u,a,v,g,s=this,u=s.Vv,c=u.options.tabStripPosition,f=s.Om,l=s.Nv,h=s.xv,d=s.Rm,s=s.im(),u=u.sheetTabStyles.C2e(a),a=u&S.SheetTabState.active,v=u&S.SheetTabState.selected;t.save(),a&&v&&(t.fillStyle=l,c===S.TabStripPosition.bottom?t.fillRect(e,n,i,r-h):c===S.TabStripPosition.top?t.fillRect(e,n+h,i,r):c===S.TabStripPosition.left?t.fillRect(e+f,n,i-f,r):t.fillRect(e,n,i-f,r)),u&S.SheetTabState.selected?(t.fillStyle=l,c===S.TabStripPosition.bottom?t.fillRect(e,n+1,i,r-h):c===S.TabStripPosition.top?t.fillRect(e,n+h-1,i,r):u&S.SheetTabState.active?c===S.TabStripPosition.left?t.fillRect(e+f,n,i-f,r+1):t.fillRect(e,n,i-f,r+1):t.fillRect(e+f,n,i-2*f,r+1)):u&S.SheetTabState.active&&(t.fillStyle=l,c===S.TabStripPosition.bottom?t.fillRect(e,n,i,1):c===S.TabStripPosition.top?t.fillRect(e,n+r,i,1):c===S.TabStripPosition.left?t.fillRect(e+f,n,i-f,r+1):t.fillRect(e,n,i-f,r+1)),t.fillStyle=o,s?c===S.TabStripPosition.bottom?t.fillRect(e+d,n+(g=a?d-1:d),i-2*d+1,r-2*d):t.fillRect(e+d,n+(g=a?d+1:d),i-2*d+1,r-2*d):u&S.SheetTabState.active?c===S.TabStripPosition.left?t.fillRect(e+f,n,i-f,r+1):t.fillRect(e,n,i-f,r+1):t.fillRect(e+f,n,i-2*f,r+1),t.restore()},v.prototype.Bm=function(t,e,n,i,r,o,a){var a,s,u,c,f,l,h,u,s,s=this,u=s.Vv,c=u.options.tabStripPosition,f=s.xv,l=s.Om,h=s.im(),u=u.sheetTabStyles.C2e(a),s=null==(a=(0,m.jf)(s.Vv))?void 0:a.options.rightToLeft;t.save(),h?(t.beginPath(),t.lineWidth=1,t.strokeStyle=o,u&S.SheetTabState.active?c===S.TabStripPosition.bottom?(t.moveTo(e+.5,n),t.lineTo(e+.5,n+r-f),t.moveTo(e+i+(s?-.5:.5),n),t.lineTo(e+i+(s?-.5:.5),n+r-f)):c===S.TabStripPosition.top&&(t.moveTo(e+.5,n+f),t.lineTo(e+.5,n+r),t.moveTo(e+i+(s?-.5:.5),n+f),t.lineTo(e+i+(s?-.5:.5),n+r)):(t.moveTo(e+.5,n+f),t.lineTo(e+.5,n+r-f),t.moveTo(e+i+.5,n+f),t.lineTo(e+i+.5,n+r-f))):(t.beginPath(),t.lineWidth=1,t.strokeStyle=o,u&S.SheetTabState.active?c===S.TabStripPosition.left?(t.moveTo(e+l,n+.5),t.lineTo(e+l+i,n+.5),t.moveTo(e+l,n+r+.5),t.lineTo(e+l+i,n+r+.5)):(t.moveTo(e,n+.5),t.lineTo(e+i-l,n+.5),t.moveTo(e,n+r+.5),t.lineTo(e+i-l,n+r+.5)):(t.moveTo(e+l,n+.5),t.lineTo(e-l+i,n+.5),t.moveTo(e+l,n+r+.5),t.lineTo(e-l+i,n+r+.5))),t.stroke(),t.restore()},v.prototype.Lm=function(t,e,n,i,r,o,a){var s,u,c,f,s,l,s=this,u=s.Vv,c=u.options.tabStripPosition,f=s.xv,s=s.Om,l;u.sheetTabStyles.C2e(a)&S.SheetTabState.selected&&(t.save(),t.beginPath(),t.strokeStyle=o,t.lineWidth=2,c===S.TabStripPosition.bottom?(t.moveTo(e,n+r-f),t.lineTo(e+i+1,n+r-f)):c===S.TabStripPosition.top?(t.moveTo(e,n+f),t.lineTo(e+i+1,n+f)):c===S.TabStripPosition.left?(t.moveTo(e+s,n),t.lineTo(e+s,n+r+1)):(t.moveTo(i-s,n),t.lineTo(i-s,n+r+1)),t.stroke(),t.restore())},v.prototype.S2e=function(t,e,s,n){var i,u,c,f,r,l,o,e,r,n,h,a,d,v,n,g,m,p,S,w,w,i=this;if(i.im())return{text:s,leftIcons:null==n?void 0:n.leftIcons,rightIcons:null==n?void 0:n.rightIcons};if(u=0,c={text:s},f={text:""},r=i.Rm+i.Om,l=e-2*r-2-1,o=n.font,e=n.leftIcons,r=n.rightIcons,n=i.T2e,h=n.iconSpace,a=n.iconTextSpace,d=n.defaultSize,v=i.Mt(t,i.A2e,o),n=function(t,e){for(var n,i,r,o,a,n,n,i=[],r=0;r<t.length;r++){if(n=(null!=(n=(o=t[r]).width)?n:d)+((a=0===r)?0:h),l<(n=u+n))return 0!==r||e||(f.hasEllipsis=!0),!0;i.push(o),n+v<=l?(f.hasEllipsis||(f.hasEllipsis=!0),e?(f.rightIcons=b([],i,!0),f.text=s):(f.leftIcons=b([],i,!0),f.text="")):e||0!==r||(f.hasEllipsis=!0),u=n}return e?c.rightIcons=i:c.leftIcons=i,!1},e&&0<e.length){if(g=n(e))return f;u+=a}else f.text=i.A2e;for(m="",p=0;p<s.length;p++){if(S=s[p],w=i.Mt(t,S,o),l<(w=u+w))return f;m+=S,w+v<=l&&(f.text=m+i.A2e,f.hasEllipsis)&&(f.hasEllipsis=!1),u=w}return r&&0<r.length&&(u+=a,g=n(r,!0))?f:c},v.prototype.x2e=function(t){var e,n,i,e=this,n=0;return e.im()?(i=e.Vv.options.tabStripPosition)===S.TabStripPosition.bottom?n-=t?2:1:n+=t?-1:1:n+=2,n},v.prototype.I2e=function(h,d,v,g,t,m){var p,S,w,t,b,C,y,p=this,S=t,w=p.BO(),t=p.T2e,b=t.defaultSize,C=t.iconSpace,y=p.im();return m.forEach(function(t,e){var n,t,i,r,o,a,s,n,t,u,c,f,l;w.getState(t.src)&&w.qh(t.src)&&(i=w.getImage(t.src),o=r=0,a=d,s=v,n=null!=(n=t.width)?n:b,t=null!=(t=t.height)?t:b,u=(g-t)/2+(y?p.x2e(!0):0),c=void 0,M.msie&&((c=document.createElement("div")).appendChild(i),document.body.appendChild(c)),f=i.width,l=i.height,M.msie&&(c.removeChild(i),document.body.removeChild(c)),h.drawImage(i,0,0,f,l,a+S,s+u,n,t),S=S+n+(e===m.length-1?0:C))}),S},v.prototype.N2e=function(t,e,n,i,r,o,a){var s,o,u,c,f,o,l,a,h,d,v,g,i,v,d,s=this,o=s.S2e(t,i,o,a),u=o.leftIcons,c=o.rightIcons,f=o.text,o=o.hasEllipsis,l=a.font,a=a.foreColor,h=s.T2e.iconTextSpace,d=s.im(),v=d?s.kv:s.Rm+s.Om,g,i=i-v-(d?s.Dv:s.Rm+s.Om)-(d?0:3),v=v+(d?0:2),d=r/2+s.x2e();t.save(),t.beginPath(),t.rect(e+v,n,i,r),t.clip(),u&&(v=s.I2e(t,e,n,r,v,u)),t.font=null!=l?l:t.font,t.fillStyle=a,t.textBaseline="middle",0<f.length&&(u&&0<u.length&&(v+=h),t.fillText(f,e+v,n+d),v+=t.measureText(f).width),c&&(0<f.length&&(v+=h),v=s.I2e(t,e,n,r,v,c)),o&&t.fillText(s.A2e,e+v,n+d),t.restore()},v.prototype.Hm=function(t,e,n,i,r,o,a){var s,u,c,a,s=this,u=a.composedStyle,c=a.borderLeftColor,a=a.borderBottomColor;s.jm(t,e,n,i,r,u.backColor,o),s.Bm(t,e,n,i,r,c,o),s.Lm(t,e,n,i,r,a,o),s.N2e(t,e,n,i,r,o,u)},v.prototype.km=function(t,e,n,i,r,o,a,s,u,c){var f,l,f,h,d,v,g,c,f;t.save(),f=null==(f=(0,m.jf)((l=this).Vv))?void 0:f.options.rightToLeft,h=s===p.NavButtonDirection.left||s===p.NavButtonDirection.top,d=S.VisualState.highlight,c&&(d=S.VisualState.hover),h?(s===p.NavButtonDirection.left?e-=2:n-=2,-1===(v=f?l.Ym(l.Zm()):l.Vm(l.om))&&(d=S.VisualState.normal)):(s===p.NavButtonDirection.right?e+=2:n+=2,-1===(g=f?l.Vm(l.om):l.Ym(l.Zm()))&&(d=S.VisualState.normal)),c=m.I.He(d,"gc-navButton-"+m.I.Ee(d)),t.strokeStyle=this.Wm(c.borderTopColor),t.beginPath(),f=h?1:-1,s===p.NavButtonDirection.left||s===p.NavButtonDirection.right?(t.moveTo(e-.5,n),t.lineTo(e-.5,n+1),t.moveTo(e+f-.5,n-1),t.lineTo(e+f-.5,n+2),t.moveTo(e+2*f-.5,n-2),t.lineTo(e+2*f-.5,n+3),t.moveTo(e+3*f-.5,n-3),t.lineTo(e+3*f-.5,n+4)):s!==p.NavButtonDirection.top&&s!==p.NavButtonDirection.bottom||(t.moveTo(e,n-.5),t.lineTo(e+1,n-.5),t.moveTo(e-1,n+f-.5),t.lineTo(e+2,n+f-.5),t.moveTo(e-2,n+2*f-.5),t.lineTo(e+3,n+2*f-.5),t.moveTo(e-3,n+3*f-.5),t.lineTo(e+4,n+3*f-.5)),t.stroke(),t.restore()},v.prototype.Sm=function(t,e,n,i,r,o){var a,s,u,o,a=this;t.save(),t.beginPath(),s=(r-2*a.Qm)/2,u=S.VisualState.highlight,o&&(u=S.VisualState.hover),o=m.I.He(u,"gc-tabStripNewTab-"+m.I.Ee(u)),t.lineWidth=1.5,t.strokeStyle=a.Wm(o.borderTopColor),t.arc(e+i/2,n+r/2,s,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+i/2-4,n+r/2),t.lineTo(e+i/2+4,n+r/2),t.moveTo(e+i/2,n+r/2-4),t.lineTo(e+i/2,n+r/2+4),t.stroke(),t.restore()},v.prototype._m=function(t,e,n,i){var r,o,a,s,i,r=this,o=15,a=5;r.nm()&&(o=0),t.save(),t.beginPath(),s=S.VisualState.highlight,i&&(s=S.VisualState.hover),i=m.I.He(s,"gc-tab-strip-all-sheets-"+m.I.Ee(s)),t.strokeStyle=r.Wm(i.borderTopColor),t.lineWidth=2,t.moveTo(e,n),t.lineTo(e+o,n),t.moveTo(e,n+5),t.lineTo(e+o,n+5),t.moveTo(e,n+10),t.lineTo(e+o,n+10),t.stroke(),t.restore()},v.prototype.Cm=function(t,e,n,i,r){var o,a,a;t.save(),t.beginPath(),o=S.VisualState.highlight,5!==(a=this.Nm)&&6!==a||(o=S.VisualState.hover),a=m.I.He(o,"gc-navMoreButton-"+m.I.Ee(o)),t.fillStyle=this.Wm(a.borderTopColor),t.fillRect(e+i/2,n+r/2,2,2),t.fillRect(e+i/2-4,n+r/2,2,2),t.fillRect(e+i/2+4,n+r/2,2,2),t.restore()},v.prototype.Wm=function(t){var e=s(t),n=this.bm;return e.a<=.01?a(n):o.Km(n,e)?a(e):t},e.Gv=v},"./dist/core/workbook/sheettab2007.js":function(t,e,n){"use strict";var i,b,r,o,M,k,C,u,T,y,x,G,B,v,a,I,n,d,s,c,f;function l(t){var t,e,t=f.call(this,t)||this,e=t;return e.kv=12,e.Dv=8,e._v=3,e.Ev=12,e.Rv=48,e.Bv=15,e.Lv=28,e.Fv=5,e._font="10pt Arial",t}i=this&&this.__extends||(c=function(t,e){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),b=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(e,"__esModule",{value:!0}),e.Jm=void 0,r=n("./dist/core/core.ns.js"),o=n("Common"),M=n("./dist/core/util/common.js"),k=n("./dist/core/workbook/sheettabbase.js"),C=n("./dist/core/core.enum.js"),u=n("./dist/core/worksheet/stylehelper.js"),T=M.mt.ri,y=M.mt.Tt,x=null,G=Math.min,B=Math.max,v="#92A5C7",a="newSheet",I="linear-gradient",n=new o.Common.ResourceManager(r.SR,"Sheets"),d=n.getResource.bind(n),f=k.Hv,i(l,f),l.prototype.zv=function(){var t,e,n,t=this.Vv,e=t&&t.options,n=0;return n=e&&e.tabNavigationVisible?t.Xm()*(e.useTouchLayout?2:1):n},l.prototype.Wsn=function(){return 4*this.zv()},l.prototype.Yv=function(){var t=this.Vv;return t&&t.options.tabNavigationVisible?t.Xm():0},l.prototype.tm=function(){var t,e,n,t,n,e=this,n=e.im(),t=null==(t=(0,M.jf)(e.Vv))?void 0:t.options.rightToLeft;return n?t?e.rm():4*e.zv()+e.qm()+e.em():(n=e.cm(),e.nm()&&(n=0),Math.max(e.Jv(),n))},l.prototype.qm=function(){var t,e=this.Vv;return e&&e.options.tabNavigationVisible?2:0},l.prototype.getResizeBarBounds=function(){var t,e,n,i,e=this,n=e.ot(),i;return{x:(null==(t=(0,M.jf)(e.Vv))?void 0:t.options.rightToLeft)?n.x:n.x+n.width-e.rm(),y:x,width:e.rm(),height:x}},l.prototype.getNavButtonBounds=function(){var t,e,n,i,r,o,t,a,s,u,c,t,n,e=this,n=e.im(),u=e.ot(),c=e.zv(),t=null==(t=(0,M.jf)(e.Vv))?void 0:t.options.rightToLeft,t=n?(i=t?u.x+u.width-4*c:0,o=c,r=x):(n=e.Yv(),i=u.width/2-2*c,r=u.height-n,o=c,n),a=0,s=4;return{x:i,y:r,width:o,height:t,startIndex:0,endIndex:4}},l.prototype.getSheetTabBounds=function(){var t,e,t=this,e=t.tm();return t.nm()&&(e-=t.em()),{x:e,y:x,height:x,secondMoreTabWidth:0,moreTabPos:0}},l.prototype.getPreMoreTabBounds=function(){var t,e,n,i,r,e=this,n=e.tm();return e.nm()&&(n-=e.em()),i=e.Xv(),{x:(r=null==(t=(0,M.jf)(e.Vv))?void 0:t.options.rightToLeft)?i:n,width:e.getPreMoreTabWidth()}},l.prototype.getPreMoreTabWidth=function(){var t=this;return t._v+t.Fv+t.ot().height},l.prototype.getAllSheetsBounds=function(){var t,e,n,i,r,o,a,s,u,c,f,l,r,o,t,n,t,s,e=this,n=e.im(),i=e.Vv.options.newTabVisible,r=e.Vv.options.tabNavigationVisible,o=e.Vv.options.useTouchLayout,a=e.ot(),s=e.getNavButtonBounds(),u=e.em(),c=e.cm(),t=null==(t=(0,M.jf)(e.Vv))?void 0:t.options.rightToLeft,o=(r=n?(f=t?a.x+a.width-4*s.width-u:s.x+4*s.width,f+=e.em()/2-e.rm()/2,0===e.rm()&&r&&(f-=e.em()/2),l=a.y,u):o?(n=a.x,t=a.width,i&&(n=a.x+a.width/2,t=a.width/2),f=n,l=a.y,t):(s=i?0:e.Bv/-2,f=(a.x+a.width)/2+s,l=5,u+4),c);return{x:f,y:l,width:r,height:o}},l.prototype.fm=function(){var t,e,t=this,e;return t.im()?t.lm+t.$v[t.hm]+t.Jv()>t.dm():t.lm+2*t.M2e[t.hm]>t.dm()},l.prototype.dm=function(){var t,e,n,t,e=this,n=e.im(),t=null==(t=(0,M.jf)(e.Vv))?void 0:t.options.rightToLeft;return n?t?e.ot().width-e.Wsn()-e.em():e.ot().width-e.rm():e.ot().height-e.Yv()},l.prototype.vm=function(){var t;return this.im()?1:4},l.prototype.mm=function(){return[a]},l.prototype.gm=function(){var t,e,n,t=this,e=t.im(),n=t.tm();return n=e&&(n+=t.ot().height,t.Vv.options.newTabVisible)?(n+=t.Jv())+t._v:n},l.prototype.wm=function(t,e){var n,i,r,i,o,a,s,u;if(t.save(),t.beginPath(),n=t.createLinearGradient(e.x,e.y,e.width,e.height),r=(i=M.I.He(0,"gc-tabStripBackground"))&&i.backgroundImage,i=i&&i.backgroundColor,r&&-1!==r.indexOf(I))for(a=0,s=(o=T(r)).length;a<s;a++)u=o[a],n.addColorStop(u.point,u.color);else i&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,i));t.fillStyle=n,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},l.prototype.k2e=function(t,e,n,i){var r,o,r,a,o,t,s,u,c,f,r=this,o=r.im(),r=r.ot(),a=o?t.createLinearGradient(r.x+.7*r.height,r.y+0,.7*r.height,r.height):t.createLinearGradient(r.x+.7*n,e,.7*n,e+n),o=i.backgroundImage,t=i.backgroundColor;if(o&&-1!==o.indexOf("linear-gradient"))for(u=0,c=(s=T(o)).length;u<c;u++)f=s[u],a.addColorStop(f.point,f.color);else t&&a.addColorStop(0,t);return a},l.prototype._2e=function(t,e,n){var i,r,o,o,a,t,e,s,i=this,r=-2===i.Tm,o=r?C.VisualState.hover:C.VisualState.normal,o=M.I.He(o,"gc-tab-"+M.I.Ee(o)),a=M.I.He(C.VisualState.normal,"gc-tab-"+M.I.Ee(C.VisualState.normal)),t=i.k2e(t,e,n,o),e=i._font;return{composedStyle:{backColor:t,font:e=r?u.W.ii(e,"bold"):e,foreColor:s=i.Um(o.color)},borderLeftColor:null==a?void 0:a.borderLeftColor,borderBottomColor:null==a?void 0:a.borderBottomColor}},l.prototype.Mm=function(t,e,n){var i,r,o,a,s,i,u,o,c,f,l,h,s,a,n,r=this,o=r.Vv,a=d().NewTab,s=r.im(),i=null==(i=(0,M.jf)(r.Vv))?void 0:i.options.rightToLeft,u;o.options.newTabVisible&&(l=f=void(c=o=0),h=-2===r.Tm,s?(t.font=r._font,r.Rv=t.measureText(a).width+r.kv,o=n,f=r.Jv(),i&&(o-=f),l=e.height,s=r._2e(t,0,l),r.Hm(t,o,0,f,l,void 0,s)):(a=r.em(),r.nm()&&(a=0),n=k.NEW_TAB_SIZE_ASIDE,r.Rv=n,o=(e.width-n)/2-a,r.$m(t,o,0,f=n,l=n,h)))},l.prototype.$m=function(t,e,n,i,r,o){var a,a,s,s,o,u,c,f,l,h,a=this;if(t.save(),t.beginPath(),a=(r-2*a.Qm)/2,s=C.VisualState.normal,o&&(s=C.VisualState.hover),s=M.I.He(s,"gc-tab-"+M.I.Ee(s)),(o=o?s.backgroundColor:s.backgroundImage)&&-1!==o.indexOf(I))for(u=t.createLinearGradient(e+.7*r,n+0,.7*r,r),f=0,l=(c=T(o)).length;f<l;f++)h=c[f],u.addColorStop(h.point,h.color);else u=o;t.lineWidth=1.5,t.strokeStyle=u,t.arc(e+i/2,n+r/2,a,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+i/2-4,n+r/2),t.lineTo(e+i/2+4,n+r/2),t.moveTo(e+i/2,n+r/2-4),t.lineTo(e+i/2,n+r/2+4),t.stroke(),t.restore()},l.prototype.Am=function(t,e,n,i,r){var o,o,a,a,o,o,s,a,n,u,c,n,o,a,a,n,s=this,a=s.Vv,n=n-1,u="",c=s.D2e(t,0,"",n),n=s.Vv.e2(n);n&&(o=null==(o=null==(o=a.sheetTabStyles.all()[n.name()])?void 0:o[C.SheetTabState.normal])?void 0:o.backColor,a=null==(a=null==(a=a.options.defaultSheetTabStyles)?void 0:a[C.SheetTabState.normal])?void 0:a.backColor,a=n?M.Pf.vl(n,null!=(o=null!=o?o:a)?o:n.R2e()):void 0)&&(c.composedStyle.backColor=a),n=null==(o=(0,M.jf)(s.Vv))?void 0:o.options.rightToLeft,s.Hm(t,n?r:i,0,s.Fv,e.height,"",c)},l.prototype.Im=function(t,e){var n,i,r,o,a,s,u,c,n,f,l,i=this,r=i.im(),o=i.tm(),a=i.xm,s=i.zv(),u=i.Yv(),c=i.Nm,n=null==(n=(0,M.jf)(i.Vv))?void 0:n.options.rightToLeft;t.fillStyle=v,r?t.fillRect(e.x,e.y,o-i.em()-2,e.height):t.fillRect(e.x,e.height-u,e.width,u),r?(f=n?e.x+e.width-4*s+s/2:s/2,i.km(t,f,l=u/2,f+a,l+a,f+a,l-a,k.NavButtonDirection.left,f-a,0===c),i.km(t,f+=s,l,f+a,l+a,f+a,l-a,k.NavButtonDirection.left,x,1===c),i.km(t,f+=s,l,f-a,l+a,f-a,l-a,k.NavButtonDirection.right,x,2===c),i.km(t,f+=s,l,f-a,l+a,f-a,l-a,k.NavButtonDirection.right,f+4,3===c)):(f=e.width/2-1.5*s,l=e.height-u/2,i.km(t,f,l,f+a,l+a,f-a,l+a,k.NavButtonDirection.top,l-a,0===c),i.km(t,f+=s,l,f+a,l+a,f-a,l+a,k.NavButtonDirection.top,x,1===c),i.km(t,f+=s,l,f+a,l-a,f-a,l-a,k.NavButtonDirection.bottom,x,2===c),i.km(t,f+=s,l,f+a,l-a,f-a,l-a,k.NavButtonDirection.bottom,l+a,3===c))},l.prototype.Dm=function(t,e){var n,i,r,o,r,a,s,u,c,f,n,a,i=this,r=i.Vv.options,o=r.allSheetsListVisible,r=r.newTabVisible,a=i.im(),s=i.tm();i.nm()&&(s-=i.em()),c=u=0,f=i.ot(),n=null==(n=(0,M.jf)(i.Vv))?void 0:n.options.rightToLeft,c=a?(u=n?f.x+f.width-4*i.zv()-i.em():4*i.zv()+1,5):(a=r?i.em():i.em()/2,u=(e.width-s)/2+a,10),o!==C.AllSheetsListVisibility.hide&&i._m(t,u,c,-3===i.Tm)},l.prototype._m=function(t,e,n,i){var r,o,a,s,u,c,u,f,l,h,d,v,g,m,l,f,s,a,p,S,w,c;if(t.save(),t.beginPath(),o=(r=this).im(),a=r.ot(),s=r.em(),c=(u=M.I.He)(4,"gc-all-sheets-button-hover"),f=(u=u(0,"gc-all-sheets-button-normal"))&&u.backgroundColor,(l=u&&u.backgroundImage)&&-1!==l.indexOf(I))for(h=t.createLinearGradient(a.x+.7*a.height,a.y+0,.7*a.height,a.height),v=0,g=(d=T(l)).length;v<g;v++)m=d[v],h.addColorStop(m.point,m.color);if(o&&(i?(t.fillStyle=c.backgroundColor,t.fillRect(e+2,a.y+2,s-4,a.height-4)):(h?t.fillStyle=h:f&&(t.fillStyle=f),t.fillRect(e-s/2,a.y+1,r.cm(),a.height-2))),o)t.strokeStyle=(i?c:u).color;else{if(l=C.VisualState.normal,i&&(l=C.VisualState.hover),m=void 0,f=M.I.He(l,"gc-all-sheets-button-"+M.I.Ee(l)),(s=i?f.backgroundColor:f.backgroundImage)&&-1!==s.indexOf(I))for(a=r.em(),m=t.createLinearGradient(e+.7*a,n+0,.7*a,a),v=0,g=(d=T(s)).length;v<g;v++)p=d[v],m.addColorStop(p.point,p.color);else m=s;t.strokeStyle=m}c=o?(S=3,w=12,4):(S=0,w=15,5),r.nm()&&(S=c=w=0),t.stroke(),t.lineWidth=1,t.moveTo(e+S,n),t.lineTo(e+w,n),t.moveTo(e+S,n+c),t.lineTo(e+w,n+c),t.moveTo(e+S,n+2*c),t.lineTo(e+w,n+2*c),t.stroke(),t.fill(),t.restore()},l.prototype.Em=function(t,e){var n,n,i,i,r,o,a,o,n,n=this,i=n.Vv,r=n.rm(),o=M.I.He,a=o(4,"gc-tabStripResizeBarInner"),o=o(0,"gc-tabStripResizeBarOuter"),n=null==(n=(0,M.jf)(n.Vv))?void 0:n.options.rightToLeft;i.options.showHorizontalScrollbar&&(i=n?e.x:e.x+e.width-r,t.fillStyle=o.backgroundColor,t.fillRect(i,e.y,r,e.height),t.fillStyle=a.backgroundColor,t.fillRect(i+1,e.y+1,r-2,e.height-2),t.fillStyle=a.color,t.fillRect(i+r/2-1,e.y+4,2,e.height-8))},l.prototype.S2e=function(t,e,s,n){var i,u,c,f,r,r,l,o,e,r,n,h,a,d,v,n,g,m,p,S,w,w,i=this;if(i.im())return{text:s,leftIcons:null==n?void 0:n.leftIcons,rightIcons:null==n?void 0:n.rightIcons};if(u=0,c={text:s},f={text:""},r=i.Om*(i.Vv.options.tabStripPosition===C.TabStripPosition.right?1:2),r=i.Rm+r,l=e-2*r,o=n.font,e=n.leftIcons,r=n.rightIcons,n=i.T2e,h=n.iconSpace,a=n.iconTextSpace,d=n.defaultSize,v=i.Mt(t,i.A2e,o),n=function(t,e){for(var n,i,r,o,a,n,n,i=[],r=0;r<t.length;r++){if(n=(null!=(n=(o=t[r]).width)?n:d)+((a=0===r)?0:h),l<(n=u+n))return 0!==r||e||(f.hasEllipsis=!0),!0;i.push(o),n+v<=l?(f.hasEllipsis||(f.hasEllipsis=!0),e?(f.rightIcons=b([],i,!0),f.text=s):(f.leftIcons=b([],i,!0),f.text="")):e||0!==r||(f.hasEllipsis=!0),u=n}return e?c.rightIcons=i:c.leftIcons=i,!1},e&&0<e.length){if(g=n(e))return f;u+=a}for(m="",p=0;p<s.length;p++){if(S=s[p],w=i.Mt(t,S,o),l<(w=u+w))return f;m+=S,w+v<=l&&(f.text=m+i.A2e,f.hasEllipsis)&&(f.hasEllipsis=!1),u=w}return r&&0<r.length&&(u+=a,g=n(r,!0))?f:c},l.prototype.j2e=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,u,a,l,d,s,s=this,u=s.Vv,c=u.sheetTabStyles.C2e(a),f=u.options.tabStripPosition,l=u.sheets,h,u=u.getSheetPosition(a)===l.length-1,a=s.eg,l=s.Om,d=s.xm,s=s.im();t.save(),t.beginPath(),s?f===C.TabStripPosition.bottom?(t.moveTo(e,n),t.lineTo(e,n+r-a),t.arcTo(e,n+r,e+i,n+r,a),t.lineTo(e+i,n+r),t.lineTo(e+i+r,n),c&C.SheetTabState.active||t.lineTo(e,n)):(t.moveTo(e,n+r),t.lineTo(e,n-a),t.arcTo(e,n,e+i,n,a),t.lineTo(e+i,n),t.lineTo(e+i+r,n+r),c&C.SheetTabState.active||t.lineTo(e,n+r)):f===C.TabStripPosition.left?(t.moveTo((e+=l)+(i-=l),n),t.lineTo(e+a,n),t.arcTo(e,n,e,n+a,a),t.lineTo(e,n+r-a),t.arcTo(e,n+r,e+a,n+r,a),u?t.lineTo(e+i,n+r):(t.lineTo(e+i-d,n+r),t.lineTo(e+i,n+r+d)),c&C.SheetTabState.active||t.lineTo(e+i,n)):(i-=l,t.moveTo(e,n),t.lineTo(e+i-a,n),t.arcTo(e+i,n,e+i,n+a,a),t.lineTo(e+i,n+r-a),t.arcTo(e+i,n+r,e+i-a,n+r,a),u?t.lineTo(e,n+r):(t.lineTo(e+d,n+r),t.lineTo(e,n+r+d)),c&C.SheetTabState.active||t.lineTo(e,n)),t.fillStyle=o,t.fill(),t.strokeStyle=v,t.stroke(),t.restore()},l.prototype.I2e=function(h,d,v,g,t,m){var e,p,S,t,w,b,e=this,p=t,S=e.BO(),t=e.T2e,w=t.defaultSize,b=t.iconSpace;return m.forEach(function(t,e){var n,t,i,r,o,a,s,n,t,u,c,f,l;S.getState(t.src)&&S.qh(t.src)&&(i=S.getImage(t.src),a=d,s=v,n=null!=(n=t.width)?n:w,t=null!=(t=t.height)?t:w,u=(g-t)/2,c=void(o=r=0),y.msie&&((c=document.createElement("div")).appendChild(i),document.body.appendChild(c)),f=i.width,l=i.height,y.msie&&(c.removeChild(i),document.body.removeChild(c)),h.drawImage(i,0,0,f,l,a+p,s+u,n,t),p=p+n+(e===m.length-1?0:b))}),p},l.prototype.N2e=function(t,e,n,i,r,o,a,s){var u,o,c,f,l,o,h,a,d,v,g,g,m,i,s,m,u=this,o=u.S2e(t,i,o,a),c=o.leftIcons,f=o.rightIcons,l=o.text,o=o.hasEllipsis,h=a.font,a=a.foreColor,d=u.T2e.iconTextSpace,v=u.im(),g=u.Om*(u.Vv.options.tabStripPosition===C.TabStripPosition.right?1:2),g=v?u.kv:u.Rm+g,m=v?u.Dv:u.Rm+u.Om,i=i-g-(s?0:m),s=g,m=r/2+(v?0:2);t.save(),t.beginPath(),t.rect(e+s,n,i,r),t.clip(),c&&(s=u.I2e(t,e,n,r,s,c)),t.font=null!=h?h:t.font,t.fillStyle=a,t.textBaseline="middle",0<l.length&&(c&&0<c.length&&(s+=d),t.fillText(l,e+s,n+m),s+=t.measureText(l).width),f&&(0<l.length&&(s+=d),s=u.I2e(t,e,n,r,s,f)),o&&t.fillText(u.A2e,e+s,n+m),t.restore()},l.prototype.Hm=function(t,e,n,i,r,o,a){var s,u,c,u=this,c=null!=o?o:d().NewTab;u.j2e(t,e,n,i,r,null==(s=null==a?void 0:a.composedStyle)?void 0:s.backColor,c),u.N2e(t,e,n,i,r,c,null==a?void 0:a.composedStyle,!o)},l.prototype.km=function(t,e,n,i,r,o,a,s,u,c){var f,l,h,d,f,v,g,v,m,p,S,w,b,C,y;if(t.save(),l=(f=this).im(),h=s===k.NavButtonDirection.left||s===k.NavButtonDirection.top,d=f.ot(),f=f.zv(),g=(v=M.I.He)(4,"gc-navButton-hover"),m=(v=v(0,"gc-navButton-normal"))&&v.backgroundColor,(p=v&&v.backgroundImage)&&-1!==p.indexOf(I))for(S=t.createLinearGradient(d.x+.7*d.height,d.y+0,.7*d.height,d.height),b=0,C=(w=T(p)).length;b<C;b++)y=w[b],S.addColorStop(y.point,y.color);l&&(c?(t.fillStyle=g.backgroundColor,t.fillRect(e-f/2+2,d.y+2,f-4,d.height-4)):(S?t.fillStyle=S:m&&(t.fillStyle=m),t.fillRect(e-f/2,d.y+1,f,d.height-2))),t.fillStyle=l?(c?g:v).color:!c&&S||m,void 0!==u&&u!==x&&(s===k.NavButtonDirection.left||s===k.NavButtonDirection.right?t.fillRect(u,G(r,a),1,B(r,a)-G(r,a)):t.fillRect(G(i,o),u,B(i,o)-G(i,o),1)),h?s===k.NavButtonDirection.left?(e-=2,i-=2,o-=2):(n-=2,r-=2,a-=2):s===k.NavButtonDirection.right?(e+=2,i+=2,o+=2):(n+=2,r+=2,a+=2),t.beginPath(),t.moveTo(e,n),t.lineTo(i,r),t.lineTo(o,a),t.lineTo(e,n),t.fill(),t.restore()},e.Jm=l},"./dist/core/workbook/sheettabStyleManager.js":function(t,e,n){"use strict";var u,c,i,f,l,r,o;function a(t){this.Vv=t,this.O2e={}}u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},c=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(e,"__esModule",{value:!0}),e.SheetTabStyleManager=void 0,i=n("Common"),f=n("./dist/core/core.enum.js"),l=n("./dist/core/worksheet/stylehelper.js"),r=i.Common.lt.ht,a.prototype.C2e=function(t){var e,n,t,i,e,e=this.Vv,n=e.getSheetPosition(t),t=e.Gm(t),i=f.SheetTabState.normal;return!r(t)&&(t.b2()&&(i|=f.SheetTabState.selected),e.w2.Tm===n&&(i|=f.SheetTabState.hover),e.ep()===n&&(i|=f.SheetTabState.active),e=t._gi,r(e)&&t.options.isProtected||e===f.SheetType.reportSheet&&t.Y3i())&&(i|=f.SheetTabState.protected),i},a.prototype.E2e=function(t){var e,n,n,n,e,n,e,n,e,n,e,n,i,r,o,n,i,a,e,s,t,r={},o,n=this.Vv.Gm(t);return n._gi!==f.SheetType.customSheetTab&&(i=this.C2e(t),a=null!=(e=this.Vv.options.defaultSheetTabStyles)?e:{},e=n.R2e(),s=null!=(n=this.O2e[t])?n:a,t=function(t){var e,e,n,i,t,n=r.icons,i,t=(null==(e=s[t])?void 0:e.icons)&&0<s[t].icons.length?s[t].icons:null==(e=a[t])?void 0:e.icons;return t&&0<t.length?c(c([],null!=n?n:[],!0),t,!0):n},i&f.SheetTabState.normal&&(r=u(u(u({},null!=(n=a[f.SheetTabState.normal])?n:{}),s[f.SheetTabState.normal]),{icons:t(f.SheetTabState.normal)}),e)&&!r.backColor&&(r.backColor=e),i&f.SheetTabState.protected&&(r=u(u(u(u({},r),null!=(n=a[f.SheetTabState.protected])?n:{}),s[f.SheetTabState.protected]),{icons:t(f.SheetTabState.protected)})),i&f.SheetTabState.selected&&(null!=(e=a[f.SheetTabState.selected])&&e.font||null!=(n=s[f.SheetTabState.selected])&&n.font||!r.font||(r.font=l.W.ii(r.font,"bold")),r=u(u(u(u({},r),null!=(e=a[f.SheetTabState.selected])?e:{}),s[f.SheetTabState.selected]),{icons:t(f.SheetTabState.selected)})),i&f.SheetTabState.active&&(null!=(n=a[f.SheetTabState.active])&&n.font||null!=(e=s[f.SheetTabState.active])&&e.font||!r.font||(r.font=l.W.ii(r.font,"bold")),r=u(u(u(u({},r),null!=(n=a[f.SheetTabState.active])?n:{}),s[f.SheetTabState.active]),{icons:t(f.SheetTabState.active)})),i&f.SheetTabState.hover)&&(null!=(e=a[f.SheetTabState.hover])&&e.font||null!=(n=s[f.SheetTabState.hover])&&n.font||!r.font||(r.font=l.W.ii(r.font,"bold")),r=u(u(u(u({},r),null!=(i=a[f.SheetTabState.hover])?i:{}),s[f.SheetTabState.hover]),{icons:t(f.SheetTabState.hover)})),r},a.prototype.L2e=function(t){delete this.O2e[t],this.F2e()},a.prototype.all=function(t){var e,n,e=this;return t&&0!==t.length&&0!==Object.keys(this.O2e).length?(n={},t.forEach(function(t){n[t]=e.O2e[t]}),n):this.O2e},a.prototype.B2e=function(t){var e=t;return e=t&&0!==t.length?e:this.Vv.qv().map(function(t){return t.name()})},a.prototype.add=function(e,n,t){var i,r,i=this,r;this.B2e(t).forEach(function(t){i.O2e[t]||(i.O2e[t]={}),i.O2e[t][e]=n}),this.F2e()},a.prototype.remove=function(n,t){var i,e,i=this,e;this.B2e(t).forEach(function(t){var e,e,e,e;null!=(e=null==(e=i.O2e)?void 0:e[t])&&delete e[n],0===Object.keys(null!=(e=null==(e=i.O2e)?void 0:e[t])?e:{}).length&&delete i.O2e[t]}),this.F2e()},a.prototype.clear=function(t){var e,n,e=this,n;this.B2e(t).forEach(function(t){delete e.O2e[t]}),this.F2e()},a.prototype.F2e=function(){this.Vv.w2.Cg()},a.prototype.L0=function(){this.Vv=null,this.O2e=null},e.SheetTabStyleManager=a},"./dist/core/workbook/sheettabbase.js":function(h,t,e){"use strict";var g,n,i,k,T,d,m,x,r,v,C,p,G,y,j,O,S,a,B,w,b,f,I,P,e,o,s,u,c,M,V,e,Y,K,e,z,W,J,Z,R,N,E,H,U,F,_,Q,A,X,q,L,D,e,$,tt,n,i;function et(t,e,n){t.ki(T.Events.SheetTabClick,{sheet:e,sheetName:e?e.name():B,sheetTabIndex:p(n)?-1:n})}function l(t){this.Zc=t,this.Fv=0,this._v=0,this.Om=6,this.ig=3,this.eg=5,this.xm=5,this.Rm=3,this.Qm=7,this.A2e="...",this.buffer=null,this.T2e={defaultSize:16,iconSpace:2,iconTextSpace:4},this.nCe={};var t=this;t.Vv=B,t.hm=0,t.om=0,t.lm=70,t.Nm=-1,t.Tm=-1,t._font="",t.$v=[],t.M2e=[],t.rg=-1,t.og=-1,t.ag=B,t.ug=B,t.sg=0,t.cg(new T.Rect(0,0,200,28))}g=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(t,"__esModule",{value:!0}),t.Hv=t.NavButtonDirection=t.NEW_TAB_SIZE_ASIDE=void 0,n=e("./dist/core/core.ns.js"),i=e("Common"),k=e("./dist/core/util/domUtil.js"),T=e("./dist/core/util/common.js"),d=e("./dist/core/util/imageLoader.js"),m=e("./dist/core/worksheet/stylehelper.js"),x=e("./dist/core/core.enum.js"),r=i.Common.ft,v=T.mt.ri,C=T.mt.x0,p=i.Common.lt.ht,G=T.mt.En,y=T.mt.vt,j=T.mt.bi,O=parseInt,S=window,a=document,B=null,w=Math.max,b=Math.min,f=Math.pow,I="px",P="none",o="mousedown"+(e=".gcTab"),s="mousemove"+e,u="mouseup"+e,c="mouseout"+e,M="dblclick"+e,V="mousewheel"+e,Y="mousemove"+(e=".spliter"),K="mouseup"+e,z="keydown"+(e=".tabNameEditor"),W="focus"+e,J="blur"+e,Z="canvas",R="2d",N="resize",E="tab",H="newSheet",U="blank",F="allSheets",_=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],Q="black",A="white",X=7,q=10,L="navButton",D="sheetTab",t.NEW_TAB_SIZE_ASIDE=28,e=new i.Common.ResourceManager(n.SR,"Sheets"),$=e.getResource.bind(e),(i=tt=t.NavButtonDirection||(t.NavButtonDirection={}))[i.left=0]="left",i[i.right=1]="right",i[i.top=2]="top",i[i.bottom=3]="bottom",l.prototype.getNewTabBounds=function(){var t,e,n,i,r,o,a,s,t,e,e,t=this,e=t.Vv.options.useTouchLayout,n=t.ot(),i=t.Jv(),r=(i-2*t.Qm)/2,t=e?(e=n.width,t.nm()||(e/=2),o=n.x,a=n.y,s=e,i):(e=(n.x+n.width-2*r)/2,t.nm()||(e-=t.em()),o=e,a=(n.y+i-2*r)/2,s=2*r);return{x:o,y:a,width:s,height:t}},l.prototype.getCanvas=function(){return this.fg},l.prototype.im=function(){var t,e,t,e,t=null==(t=this.Vv)?void 0:t.options.tabStripPosition;return t===x.TabStripPosition.bottom||t===x.TabStripPosition.top},l.prototype.hg=function(t){var e,n,i;t&&((n=(e=this).fg)&&e.L0(!0),i=G(Z),T.Bf.Wl(i,e.Vv),i.setAttribute("id",e.Zc),e.dg=e.vg(),e.mg(),t.appendChild(e.dg[0]),t.appendChild(i),e.fg=i,(0,k.GC$)(i).bind(o,function(t){return e.gg(t)}).bind(s,function(t){return e.pg(t)}).bind(u,function(t){return e.bg(t)}).bind(c,function(t){return e.yg(t)}).bind(M,function(t){return e.wg(t)}).bind(V,function(t){return e.Mg(t)}),e.Cg(),l.et(e,"setHost"))},l.prototype.Sg=function(t){var e,t,e=this;(e.Vv=t)&&((t=t.options.font)&&0<t.length&&(e._font=t),e.mg())},l.prototype.Tg=function(t){var e=this.Vv;e.suspendPaint(),this.Ag(t),e.resumePaint()},l.prototype.Ag=function(t){var e,e,e,n,i,r,o,n=this,i=-1,r=n.Zm();if(!(r.length<=0))for(;;){if(i===(null==(e=(o=n.Ig().tabsInfo)[0])?void 0:e.index))return;if(i=null==(e=o[0])?void 0:e.index,(null==(e=o[0])?void 0:e.index)>t)n.xg(r);else{if(!o[o.length-1]||!(o[o.length-1].index<t||o[o.length-1].index===t&&1<o.length))return;n.Ng(r)}}},l.prototype.ot=function(){var t=this.kg;return new T.Rect(t.x,t.y,t.width,t.height)},l.prototype.cg=function(t){var e=this.kg=new T.Rect(0,0,0,0);e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},l.prototype.Jv=function(){var t,e,t,e;return this.Vv.options.newTabVisible?this.Rv:0},l.prototype.Wfn=function(){return Math.max(this.rm(),this.Ig().newTabStartPosition-this.Jv())},l.prototype.em=function(){var t,e,n,t,e,n;return this.Vv.options.allSheetsListVisible!==x.AllSheetsListVisibility.hide?this.Bv:0},l.prototype.cm=function(){var t,e,n,t,e,n;return this.Vv.options.allSheetsListVisible!==x.AllSheetsListVisibility.hide?this.Lv:0},l.prototype.Xv=function(){var t,e,n,i,t,e=this,n=e.ot(),i=e.im(),t=null==(t=(0,T.jf)(e.Vv))?void 0:t.options.rightToLeft;return i?t?n.x+n.width-e.Wsn()-e.em()-e.getPreMoreTabWidth():n.x+n.width-e.rm():n.y+n.height-e.Yv()},l.prototype.tm=function(){return 0},l.prototype.rm=function(){var t,e,n,t=this,e=x.TabStripPosition.bottom,n=t.Vv;return(e=n?n.options.tabStripPosition:e)===x.TabStripPosition.bottom?t.Ev:0},l.prototype.Cg=function(){var t,e,n,i,n,r,t=this,e=t.Dg();e&&e.parentNode&&0!==(n=(0,k.GC$)(e.parentNode)).width()&&0!==n.height()&&(i=w(n.width(),0),n=w(n.height(),0),e.style.display=P,e.width=i,e.height=n,e.style.display="",e.style.width=i+I,e.style.height=n+I,i=e.clientWidth||e.width,n=e.clientHeight||e.height,r=t.ot(),t.cg(new T.Rect(r.x,r.y,i,n)),T.Bf.$l(e,i,n),t.repaint())},l.prototype.fm=function(){return!1},l.prototype.zv=function(){return 0},l.prototype.Wsn=function(){return 0},l.prototype.Yv=function(){return 0},l.prototype.dm=function(){return 0},l.prototype.vm=function(){return 0},l.prototype.mm=function(){return[]},l.prototype.gm=function(){return 0},l.prototype.vg=function(){return this.dg||(0,k.GC$)(G("div"))},l.prototype.mg=function(){var t,e,t,t,n,t=this,e=t.dg;e&&(n=void 0,(t=(t=t.Vv)?t.options.tabStripPosition:x.TabStripPosition.bottom)===x.TabStripPosition.bottom?n="gc-tab-indicator-bottom":t===x.TabStripPosition.top?n="gc-tab-indicator-top":t===x.TabStripPosition.left?n="gc-tab-indicator-left":t===x.TabStripPosition.right&&(n="gc-tab-indicator-right"),e.removeClass(),e.addClass(n))},l.prototype.L0=function(t){var e,n,i,e=this,n=e.fg;n&&(i=n.parentNode,(0,k.GC$)(n).unbind(o).unbind(s).unbind(u).unbind(M).unbind(c).unbind(V),i)&&i.removeChild(n),e.TCe(),(0,k.GC$)(e.dg).remove(),l.et(e,"dispose"),t||(e.Vv=B),e.MC&&(e.MC.L0(),e.MC=B)},l.prototype._g=function(t,e){var n,i,r,o,a,a,s,u,o,c,f,l,h,a,o,n,o,a,d,v,g,m,p,S,o,w,b,C,y,M,k,a,n,i=this,r=i.Vv,o=r.options.scrollbarAppearance===x.ScrollbarAppearance.mobile,a=r.options.showHorizontalScrollbar;if(a&&!o&&(a=i.getResizeBarBounds(),r.options.showHorizontalScrollbar)&&t>a.x&&t<a.x+a.width)return{type:"resize",element:N};for(u=-1,o=(s=i.getNavButtonBounds()).startIndex,c=s.x,f=s.endIndex,h=o;h<f;h++){if(c<t&&t<c+s.width){l=_[u=h];break}c+=s.width}if(-1!==u)return{type:L,element:l,index:h};if(c=(a=i.getAllSheetsBounds()).x,o=r.options.allSheetsListVisible,n=!0,i.nm()&&(n=!1),o!==x.AllSheetsListVisibility.hide&&c<=t&&t<c+a.width&&n)return{type:D,element:F,position:c,index:-1};if(c=(o=i.getPreMoreTabBounds()).x,a=0,-1!==(d=i.Vm(i.om))){if(c<=t&&t<c+o.width)return{type:L,element:_[5],index:5,position:c};a=i.Fv}if(v=i.getSheetTabBounds(),g=r.qv(),m=i.$v,p=i._v,c=v.x+a,o=null==(n=(S=0,T.jf)(i.Vv))?void 0:n.options.rightToLeft,-1<i.om)if(o){for(b=0,C=w=this.Ig().tabsInfo;b<C.length;b++)if((y=C[b]).position<=t&&t<=y.position+y.width&&(0<v.moreTabPos&&t>v.moreTabPos+v.secondMoreTabWidth||0===v.moreTabPos))return{type:D,element:E,index:y.index,position:y.position}}else for(h=i.om;h<g.length&&h<m.length;h++)if(g[h].visible()===x.SheetTabVisible.visible){if(S=m[h],c<t&&t<c+S+p&&(0<v.moreTabPos&&t<v.moreTabPos||0===v.moreTabPos))return{type:D,element:E,index:h,position:c};c+=S+p}if(o&&(M=i.Wfn(),k=i.Jv(),r.options.newTabVisible)&&M<t&&t<M+k)return{type:D,element:H,position:t,index:-1};if(a=c=c>v.moreTabPos&&0<v.moreTabPos?v.moreTabPos:c,n=v.secondMoreTabWidth,o&&(a=v.x-v.secondMoreTabWidth),-1!==i.Ym(i.Zm())){if(a<t&&t<a+n)return{type:L,element:_[6],index:6,position:c}}else if(c<t&&t<c+v.secondMoreTabWidth)return{element:U,position:c};return!o&&(M=c+=v.secondMoreTabWidth,k=i.Jv(),r.options.newTabVisible)&&M<t&&t<M+k?{type:D,element:H,position:c,index:-1}:{element:U}},l.prototype.Eg=function(t,e){for(var n,i,r,o,a,s,u,c,f,l,c,h,d,v,g,m,c,d,n=this,i=n.Vv,o=n.getNavButtonBounds(),a=-1,s=o.x,u=o.y,c=o.startIndex,f=o.endIndex,r=c;r<f;r++){if(s<t&&t<s+o.width&&u<e&&e<u+o.height){l=_[a=r];break}s+=o.width}if(-1!==a)return{type:L,element:l,index:r};if(c=n.Jv(),h=i.options.allSheetsListVisible,d=n.cm(),v=!0,n.nm()&&(d=0,v=!1),u=w(c,d),g=i.qv(),m=n.M2e,-1<n.om)for(r=n.om;r<g.length&&r<m.length;r++)if(g[r].visible()===x.SheetTabVisible.visible){if(u<e&&e<u+m[r])return{type:D,element:E,index:r,position:u};u+=m[r]}return c=n.getNewTabBounds(),i.options.newTabVisible&&c.x<t&&t<c.x+c.width&&c.y<e&&e<c.y+c.height?{type:D,element:H,position:u,index:-1}:(d=n.getAllSheetsBounds(),h!==x.AllSheetsListVisibility.hide&&d.x<t&&t<d.x+d.width&&d.y<e&&e<d.y+d.height&&v?{type:D,element:F,position:u,index:-1}:u<e&&e<u+o.y?-1!==n.Ym(n.Zm())?{type:L,element:_[6],index:6,position:u}:{element:U,position:u}:{element:U})},l.prototype.hitTest=function(t,e){var n,i,n,n=this,i,n=n.im()?n._g(t,e):n.Eg(t,e);return n},l.prototype.gg=function(t){var e,n,n,i,r,i,o,o,r,e=this,n={e:t,r:B};return l.et(e,"preProcessMouseDown",n),p(n=n.r)?(i=(0,k.GC$)(e.Dg()).offset(),r=t.pageX-i.left,i=t.pageY-i.top,o=e.Vv.jg(),e.Og&&e.Rg(o,!1),r=(o=e.hitTest(r,i)).element,0===t.button&&(r===N?(e.Bg=!0,e.Lg=t.pageX,e.Fg()):0<=_.indexOf(r)?e.Pg(o.index,void 0,"prevButton"===r||"nextButton"===r):r===E?(e.Gg(o.index,o.position,t),e.Ug(t,o)):r===H?e.Hg(o.position):r===F&&e.zg(t),e.Vg()),!(e.Yg=!0)):n},l.prototype.Vg=function(){var t,e,t,e=this.Vv.jg();e&&!e.isEditing()&&e.Zg()},l.prototype.zg=function(t){var e,n,e,n;return this.Vv.commandManager().execute({cmd:"showAllSheetsDialog",mouseEvent:t})},l.prototype.pg=function(t){var e,n,i,r,o,o,o,a,s,u,e,r,r,e,c,e,c,e,r,i,t,c,n=this,i=n.Vv,r=(0,T.jf)(i),o={e:t,r:B};if(l.et(n,"preProcessMouseMove",o),!p(o=o.r))return o;if(o=n.fg.style,a="default",s="w-resize",n.Wg&&!n.Qg&&10<(u=Math.sqrt(f(n.Wg.x-t.pageX,2)+f(n.Wg.y-t.pageY,2)))&&(n.Qg=!0),n.Bg)o.cursor=s,e=t.pageX-n.Lg,r=r.getHDockScrollbarWidth(),r=n.Vv._vp.clientWidth-r,i.options.tabStripRatio=i.Jg()+e/r,c=(e=null==(e=(0,T.jf)(n.Vv))?void 0:e.options.rightToLeft)?0:n.rm()/r,e=e?1-n.rm()/r:1,i.Jg()<c?(i.options.tabStripRatio=c,n.Lg=n.rm()):i.Jg()>=e?(i.options.tabStripRatio=e,n.Lg=r):n.Lg=t.pageX,i.Xg();else if(n.Qg)n.qg(t.pageX,t.pageY),n.$g(t);else{if(n.Nm=-1,n.Tm=-1,c=(0,k.GC$)(n.Dg()).offset(),e=t.pageX-c.left,r=t.pageY-c.top,t=(i=n.hitTest(e,r)).element,n.Vv&&n.Vv.options.enableAccessibility&&(c=n.t2(i),n.Vv.n2(c)),""===t)return o.cursor=a,n.repaint(),!1;t===N?o.cursor=s:(o.cursor=a,0<=_.indexOf(t)?n.Nm=i.index:t===E?n.Tm=i.index:t===H?n.Tm=-2:t===F&&(n.Tm=-3)),n.repaint()}return!1},l.prototype.t2=function(t){var e,n,i,r,t,e=$(),n="",i=t.element;return i===N?n=e.ARIA_Resize:0<=_.indexOf(i)?n=(r={first:e.ARIA_First,prevArrow:e.ARIA_PreviousArrow,nextArrow:e.ARIA_NextArrow,last:e.ARIA_Last,prevButton:e.ARIA_PreviousButton,nextButton:e.ARIA_NextButton})[i]||"":i===E?(t=this.Vv.e2(t.index).name(),n=e.ARIA_SheetTab+" "+t.replace(/([0-9]+)/," $1 ")):i===H?n=e.ARIA_NewSheet:i===U&&(n=e.ARIA_Blank),n},l.prototype.bg=function(t){var e,t,t,e=this,t={e:t,r:B};return l.et(e,"preProcessMouseUp",t),p(t=t.r)?(e.Bg&&(e.Bg=!1,e.Vv.Xg()),e.i2(),e.Qg&&(e.Qg=!1,e.r2.remove(),e.o2(),e.dg.hide()),e.Wg=B,e.a2(),e.u2(),!e.Yg||(e.Yg=!1)):t},l.prototype.yg=function(t){var e,t,t,n,i,e=this,t={e:t,r:B};return l.et(e,"preProcessMouseOut",t),p(t=t.r)?(e.a2(),n=e.Nm,e.Nm=-1,i=e.Tm,e.Tm=-1,e.Nm===n&&e.Tm===i||e.repaint(),!1):t},l.prototype.Fg=function(){var e=this;e.s2||((0,k.GC$)(a).bind(Y,function(t){e.pg(t)}).bind(K,function(t){e.bg(t)}),e.c2(!0),e.s2=!0)},l.prototype.c2=function(t){var e,n,e,n=this.Vv.getActiveSheet();n&&(n.f2=t)},l.prototype.u2=function(){var t;this.s2&&((this.s2=!1,k.GC$)(a).unbind(Y).unbind(K),t=this.Vv.getActiveSheet())&&delete t.f2},l.prototype.Pg=function(t,e,n){var i,r,i,o,a,r=this,i=null==(i=(0,T.jf)(r.Vv))?void 0:i.options.rightToLeft;r.a2(),(o=r.Zm()).length<=0||(a=200,0===(t%=4)?i?r.d2(o):r.l2(o):1===t?(e||(r.h2=S.setTimeout(function(){r.Pg(1)},200)),i&&!n?r.Ng(o):r.xg(o)):2===t?(e||(r.h2=S.setTimeout(function(){r.Pg(2)},200)),i&&!n?r.xg(o):r.Ng(o)):3===t&&(i?r.l2(o):r.d2(o)))},l.prototype.Gg=function(t,e,n){var i,r,o,r,o,i=this,r=i.Vv,o=r.v2,r=r.e2(t),o=o&&o.sheetsState;o&&0===o[r.name()]?(i.ug!==B&&clearTimeout(i.ug),i.ug=window.setTimeout(function(){i.m2(t,e,n),i.c2(!0),i.ug=B,i.Vg()})):i.m2(t,e,n)},l.prototype.m2=function(t,e,n){var i,r,e,o,e,i=this,r=i.Vv;i.hm=t,i.lm=e,r.suspendPaint(),e=r.getActiveSheet(),(o=r.e2(t))&&o.isEditing()&&o!==e&&(e=e&&e.il&&e.il.rl,!o.ol(void 0,void 0,e,void 0,!1))||(et(r,o,t),i.g2(t,n),r.resumePaint(),i.repaint())},l.prototype.p2=function(t,e,n,i,r,o){var n={oldValue:n,newValue:i,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:o,sheetPosition:t.getSheetPosition(r)};t.ki(T.Events.SheetChanging,n),n.cancel||(e.b2(i),t&&t.w2&&t.w2.repaint(),delete n.cancel,t.ki(T.Events.SheetChanged,n))},l.prototype.Hg=function(t){var e,n,i,r,r,o,a,r,s,e=this,n=e.Vv,i=e.im(),r=n.getActiveSheet();if((!e.C2||e.C2(r))&&(et(n,B,B),r=n.qv(),o=n.getSheetCount(),a=n.S2(n.T2(o)),r.forEach(function(t){t.b2(!1,!0)}),s={sheetName:r=a.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:o,sheetPosition:n.getSheetPosition(r)},e.p2(n,a,!1,!0,r,o),n.ki(T.Events.SheetChanging,s),!s.cancel)){for(n.A2(o,1,a),n.ki(T.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:o,sheetPosition:n.getSheetPosition(a.name())}),e.hm=o,e.lm=t,n.I2(n.qv().length-1,1,!1,!0);e.hm>e.om&&(e.fm()||e.om<e.N2(-1));)e.k2(e.om)&&(e.lm-=(i?e.$v:e.M2e)[e.om]),e.om++;e.repaint()}},l.prototype.g2=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,e,c,d,a,e,c,n=this,i=n.Vv,r=i.qv(),o=n.im(),a=i.getActiveSheet();n.D2&&!n.D2(a)||(s=!1,a&&a.il&&a.il.rl&&(s=!0),(u=!!e)&&(c=(l=T.mt.Qf())?e.metaKey:e.ctrlKey,f=e.shiftKey),t!==i.ep()?(c?(h=r[t]).b2()?h.b2(!1,!0):(h.b2(!0,!0),a&&!a.b2()&&a.b2(!0,!0)):f?(c=(e=i.jg())?i.getSheetPosition(e.name()):-1,d=r.slice(b(c,t),w(c,t)+1),r.forEach(function(t){t.visible()===x.SheetTabVisible.visible&&(-1!==d.indexOf(t)?t.b2()||t.b2(!0,!0):t.b2()&&t.b2(!1,!0))})):(a=r.every(function(t){return t.visible()!==x.SheetTabVisible.visible||t.b2()}),r[t].b2()&&!a||r.forEach(function(t){t.b2(!1,!0)}),(h=r[t]).b2()||h.b2(!0,!0),i.I2(t,1,s,!0)),e=n.N2(n.om),c=!1,c=o?n.lm+n.$v[n.hm]>n.dm():n.lm+n.M2e[n.hm]>=n.dm(),n.hm>n.om&&c&&-1!==e&&(n.om=e)):f&&r.forEach(function(t){var e,n,e=t.name(),n;i.getSheetPosition(e)!==i.ep()&&t.b2()&&t.visible()===x.SheetTabVisible.visible&&t.b2(!1,!0)}),n.hm<n.om&&(n.om=n.Vm(n.om)))},l.prototype.E2=function(t,e){var i,n,r,o,a,t,e,s,t,e,t,n,u,c,f,l,h,d,v,g,m,p,S,m,w,b,C,y,M,S,r,w,g,i=this,n=i.Vv,r=i.im(),o=n.options.tabStripPosition,a=O(T.I.fl("").zIndex),t=i.hitTest(t,e);if(t.element===E){if(e=i.hm,s=n.e2(e),t.index!==e)return;if(n.ki(T.Events.SheetTabDoubleClick,{sheet:s,sheetName:s.name(),sheetTabIndex:e}),!n.options.tabEditable)return!1;if((t=T.hi.ai())&&t.endEdit&&!t.endEdit())return;T.hi.F1(B),e=(0,k.GC$)(i.Dg()).offset(),t=n.j2(),n=(0,k.GC$)(t).offset(),u=(0,k.GC$)(t).width(),f=(c=G("input")).style,c.type="text",c.value=s.name(),c.setAttribute("contentEditable","true"),c.setAttribute("autocomplete","off"),f.position="absolute",f.margin="0px",f.padding="0px",v=d=h=l=void 0,g=s.name(),p=(m=i.nCe[g].composedStyle).font,S=m.leftIcons,m=m.foreColor,w=i.Mt(this.Dg().getContext(R),g,p),(C=b=0)<S.length&&(b=(y=S.reduce(function(t,e){var n,n,n,n=null!=(n=e.height)?n:i.T2e.defaultSize;return C<n&&(C=n),t+(null!=(n=e.width)?n:i.T2e.defaultSize)},0)+(S.length-1)*i.T2e.iconSpace)+i.T2e.iconTextSpace),(M=0)<S.length&&(b=(y=S.reduce(function(t,e){var n,n,n,n=null!=(n=e.height)?n:i.T2e.defaultSize;return M<n&&(M=n),t+(null!=(n=e.width)?n:i.T2e.defaultSize)},0)+(S.length-1)*i.T2e.iconSpace)+i.T2e.iconTextSpace),r?(v=w+2,d=e.top-n.top+i.vm()-i.ig-1,l=e.left-n.left+i.lm+i.kv+b,f.height="20px"):(S=i.ot(),v=w+2,r=j(g,p),g=((w=Math.max(C,M,r))-r)/2,d=e.top-n.top+i.lm+i.vm()+g-i.ig-1,l=e.left-n.left+S.x+i.Om+i.Rm+b,o===x.TabStripPosition.left&&2007===a&&(l+=i.Om),o===x.TabStripPosition.right&&u<l+v&&(h=e.left+S.width-u+i.Om+i.Rm),f.height=w+I),h?f.right=h+I:l&&(f.left=l+I),f.top=d+I,f.width=v+I,f.backgroundColor=A,f.borderWidth="0px",f.outline=P,f.zIndex="1",f.font=p,f.color=m,(0,k.GC$)(c).appendTo(t),i.Og=c,(0,k.GC$)(c).addClass("gc-sheetTabEditor").bind(z,function(t){return 13===t.keyCode?(i.Rg(s,!1),!1):27===t.keyCode?(i.Rg(s,!0),!1):void 0}).bind(W,function(){c.selectionStart=0,c.selectionEnd=c.value.length}).bind(J,function(){i.Rg(s,!1)}),c.focus()}return!1},l.prototype.wg=function(t){var e,n,n,i,r,t,e=this,n={e:t,r:B};return l.et(e,"preProcessMouseDbClick",n),p(n=n.r)?(i=(0,k.GC$)(e.Dg()).offset(),r=t.pageX-i.left,t=t.pageY-i.top,e.E2(r,t)):n},l.prototype.Mg=function(t){var e,n,i,n,i,e=this,n=e.im(),i=!p(e.Og);return n||i||(p(t.wheelDelta)&&p(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),n=t.detail||t.wheelDelta,i=e.Zm(),0<n?e.xg(i):e.Ng(i)),!1},l.prototype.Rg=function(t,e){var n,i,r,e,o,n=this,i=n.Og;i&&((0,k.GC$)(i).unbind(z).unbind(W).unbind(J),r=i.value,!1===e&&r!==(e=t.name())&&(o={message:""},C(r,n.Vv.qv(),t,o)&&!p(r)&&""!==r?t.getParent().commandManager().execute({cmd:"renameSheet",sheetName:e,name:r}):t.ki(T.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:o.message})),i.parentNode.removeChild(i),delete n.Og)},l.prototype.O2=function(){return this.Vv.options.allowSheetReorder},l.prototype.Ug=function(t,e){var n=this;n.O2()?(n.og=e.index,n.r2=n.R2(n.og),n.Wg=new T.Point(t.pageX,t.pageY),n.Fg()):n.Qg=!1},l.prototype.R2=function(t){var e,n,n,e,e=this.Vv.qv(),n=e.length;if(!(n<=t||t<0))return n=(n=e[t].name())||"sheet",(e=(0,k.GC$)(G("span")).text(n).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),e},l.prototype.a2=function(){var t=this.h2;t&&(clearTimeout(t),this.h2=B)},l.prototype.qg=function(t,e){var n,i,r,o,n,i=this.r2;i&&0===(0,k.GC$)(".gc-tab-tip-span").length&&(i.appendTo(a.body),i.hide()),r=i.width(),o=i.height(),i.css({left:t-r/2,top:e-o/2}),i.show()},l.prototype.$g=function(t){var e,n,i,r,i,o,t,i,a,s,u,c,f,l,n,h,d,o,t,v,g,n,t,o,e=this,n=e.Vv,i=(0,k.GC$)(e.Dg()),r=i.position(),i=i.offset(),o=t.pageX-i.left,t=t.pageY-i.top,i=e.hitTest(o,t),a=i.element,s=e.ot(),u=e.tm(),c=e.Vv.qv().length,f=100,l=n.options.tabStripPosition,n=e.im(),h=e.Jv(),d=e.dg,o=n?o:t,t=n?s.x+e.dm():s.y+e.dm()+h;t<o?e.ag===B&&e.rg<c&&(e.ag=S.setInterval(function(){e.Ng(e.Zm()),e.rg===c?(e.i2(),l===x.TabStripPosition.bottom?(v=r.left+e.B2()-3.5,g=r.top-3.5):l===x.TabStripPosition.top?(v=r.left+e.B2()-3.5,g=r.top+s.height):l===x.TabStripPosition.left?(v=r.left+s.width,g=r.top+e.B2()-3.5):l===x.TabStripPosition.right&&(v=r.left-3.5,g=r.top+e.B2()-3.5),d.show()):(e.rg++,d.hide()),d.css({left:v,top:g})},100)):o<u?e.ag===B&&0<e.rg&&(e.ag=S.setInterval(function(){e.xg(e.Zm()),0===e.rg?(e.i2(),l===x.TabStripPosition.bottom?(v=r.left+u-3.5,g=r.top-3.5):l===x.TabStripPosition.top?(v=r.left+u-3.5,g=r.top+s.height):l===x.TabStripPosition.left?(v=r.left+s.width,g=r.top+h-3.5):l===x.TabStripPosition.right&&(v=r.left-7,g=r.top+h-3.5),d.show()):(e.rg--,d.hide()),d.css({left:v,top:g})},100)):(e.i2(),a!==E&&-1===e.mm().indexOf(a)||(n=i.index,a===U&&(n=e.rg),t=n=a===E&&!p(n)?n:c,o=i.position,e.rg=t,l===x.TabStripPosition.bottom?(v=r.left+o-3.5,g=r.top-7):l===x.TabStripPosition.top?(v=r.left+o-3.5,g=r.top+s.height):l===x.TabStripPosition.left?(v=r.left+s.width,g=r.top+o-3.5):l===x.TabStripPosition.right&&(v=r.left-7,g=r.top+o-3.5),d.css({left:v,top:g}),d.show()))},l.prototype.B2=function(){for(var t,e,n,i,r,o,a,s,u,c,t=this,e=t.im(),n=t.$v,i=t.Zm(),r=t.L2(t.om,i),o=0,a=t.tm(),s=t.M2e,u=e?a+t.Fv:a,c=r;c<i.length;c++)o=i[c],e?u=(u+=n[o])+t._v:u+=s[o];return u},l.prototype.i2=function(){var t=this.ag;t&&(clearInterval(t),this.ag=B)},l.prototype.o2=function(){var t,e,n,i,r,o,a,s,u,t,e=this,n=e.Vv,i=e.rg,r=e.og,o=n.qv();if(n.suspendPaint(),this.F2(o)){for(a=[],s=0;s<o.length;s++)o[s].b2()&&(o[s].b2(!1),a.push(o[s]));for(s=a.length-1;0<=s&&!(n.getSheetPosition(a[s].name())<=i);s--)n.commandManager().execute({cmd:"moveSheet",sheetName:a[s].name(),targetIndex:i});for(i-=1,s=0;s<a.length&&!(n.getSheetPosition(a[s].name())>i);s++)n.commandManager().execute({cmd:"moveSheet",sheetName:a[s].name(),targetIndex:i})}else t=null==(t=(u=n.e2(r)).options)?void 0:t.rightToLeft,-1!==i&&-1!==r&&r!==i&&(r!==i-1&&!t||t)&&e.dg.isVisible()&&(r<i-1&&(i-=1),n.commandManager().execute({cmd:"moveSheet",sheetName:u.name(),targetIndex:i}));n.resumePaint()},l.prototype.F2=function(t){for(var e,n,e=[],n=0;n<t.length;n++)if(t[n].b2()&&(e.push(t[n]),1<e.length))return!0;return!1},l.prototype.scrollTabToActive=function(t,e){var n,i,r,o,a,n=this,i=n.Vv,r=n.Zm(),o;e===i.getSheetCount()+i.getSheetTabCount()-1?(n.d2(r),n.Cg()):0===e?(n.l2(r),n.Cg()):(a=n.U2(t,e))&&(t<e&&e++,n.Tg(e))},l.prototype.U2=function(t,e){for(var n,i,r,o,a,n=this,i=n.Ig().tabsInfo,r=!1,o=!1,a=0;a<i.length-2;a++)if(t===i[a].index&&(r=!0),e===i[a].index&&(o=!0),r&&o)return n.Cg(),!1;return!0},l.prototype.Zm=function(){for(var t,e,n,t=[],n=this.Vv.qv(),e=0;e<n.length;e++)this.k2(e)&&t.push(e);return t},l.prototype.l2=function(t){0<t.length&&this.om!==t[0]&&this.Vv.startSheetIndex(t[0])},l.prototype.xg=function(t){var e,t;0<t.length&&(e=this).om>t[0]&&-1!==(t=e.Vm(e.om))&&e.Vv.startSheetIndex(t)},l.prototype.Ng=function(t){var e,n;0<t.length&&(e=this).om<t[t.length-1]&&-1!==(n=e.Ym(t))&&e.Vv.startSheetIndex(e.N2(e.om))},l.prototype.d2=function(t){var t;0<t.length&&this.om<t[t.length-1]&&-1!==(t=this.Ym(t))&&this.Vv.startSheetIndex(t)},l.prototype.Ym=function(t){var e,n,i,r,o,a,s,u,c,f,l,h,h;if(0<t.length)for(n=(e=this).im(),i=e.M2e,r=e.dm(),a=e.$v,u=s=void(o=0),c=e.gm(),-1===(f=e.L2(e.om,t))&&(f=0),s=t.length-1;f<=s;s--)if(o+=l=(n?a:i)[u=t[s]],s!==t.length-1&&(o+=n?e._v:0),h=c+o,0!==s&&(h+=n?e.Fv:i[u]),r<h)return h=void 0,h=s+1<t.length?t[s+1]:t[t.length-1],e.om<h?h:-1;return-1},l.prototype.Vm=function(t){for(var e,e=t-1;0<=e;e--)if(this.k2(e))return e;return-1},l.prototype.N2=function(t){for(var e,n,i,n=null==(e=this.Vv)?void 0:e.qv().length,i=t+1;i<n;i++)if(this.k2(i))return i;return-1},l.prototype.L2=function(t,e){for(var n,n=0;n<=e.length-1;n++)if(t===e[n])return n;return-1},l.prototype.k2=function(t){var t=this.Vv.e2(t);return!(!t||t.visible()!==x.SheetTabVisible.visible)},l.prototype.H2=function(){var n,t,e,i,r,o,a,n=this,t=n.Vm(n.om),e=n.Zm().reduce(function(t,e){return t+n.M2e[e]},0),i=n.Lv,r=n.Yv()/2,o,a;return n.ot().height<e+i+r||-1!==t},l.prototype.z2=function(){var t,e,t,t=this,e=t.Vm(t.om),t=t.Ym(t.Zm());return-1!==e||-1!==t},l.prototype.nm=function(){var t,e,n,i,t=this,e,n=t.Vv.options.allSheetsListVisible,i;if(t.im()){if(!t.z2()&&n===x.AllSheetsListVisibility.auto)return!0}else if(!t.H2()&&n===x.AllSheetsListVisibility.auto)return!0},l.prototype.V2=function(){this.sg++},l.prototype.Y2=function(){var t=this;t.sg--,t.sg<=0&&(t.sg=0,t.repaint())},l.prototype.repaint=function(t){var e=this.Dg();e&&e.getContext&&this._e(e.getContext(R),t)},l.prototype._e=function(t,e){var n,i,r,o,o,a,s,u,c,f,l,h,d,v,n=this;if(!(0<n.sg)){if(i=n.ot(),r=n.fg,e){if(e.x>=i.x+i.width)return;if(e.y>=i.y+i.height)return;if(e.x+e.width>i.width&&(e.width=i.width-e.x,e.width<=0))return;if(e.y+e.height>i.height&&(e.height=i.height-e.y,e.height<=0))return;if(e.width<=0||e.height<=0)return}if((o=n.buffer)&&o.width===r.width&&o.height===r.height&&(o||o.width===i.width&&o.height===i.height)||(o&&(T.Bf.nh(n.Vv,o),n.TCe()),n.buffer=o=G(Z),T.Bf.Wl(o,n.Vv),T.Bf.$l(o,i.width,i.height)),!(i.width<=0||i.height<=0||e&&(e.width<=0||e.height<=0))){(o=n.buffer.getContext(R)).clearRect(0,0,i.width,i.height),T.Lf.Yl(o,-i.x,-i.y),n.Z2(o,e),T.Lf.Yl(o,i.x,i.y),u=a=0<=i.x?0:-i.x,c=s=0<=i.y?0:-i.y,e&&(u=i.x+e.x,c=i.y+e.y,i=new T.Rect(u,c,e.width,e.height)),a=0<=i.x?i.x:0,s=0<=i.y?i.y:0,h=B,d=T.Bf.Kl(r),v=T.Bf.Jl(r),r&&1!==d&&(u*=d,c*=v,i.x*=d,i.y*=v,i.width*=d,i.height*=v);try{l=r?e?(f=w(i.width-u,0),w(i.height-c,0)):(f=b(i.width-u,w(r.width-i.x,3)),b(i.height-c,w(r.height-i.y,3))):(u=e.x,c=e.y,f=e.width,e.height),r?(T.Lf.Vl(t,1,1),t.clearRect(a,s,f,l),t.drawImage(n.buffer,u,c,f,l,a,s,f,l),T.Lf.Vl(t,d,v)):h=(o=n.buffer.getContext(R)).getImageData(u,c,f,l)}catch(t){return}!r&&h&&0<i.width&&0<i.height&&t.putImageData(h,a,s)}}},l.prototype.TCe=function(){T.Lf.d5(this.buffer),this.buffer=null},l.prototype.W2=function(t,e){var n,i,n,i=this.ot();e?t.rect(e.x,e.y,e.width,e.height):t.rect(i.x,i.y,i.width,i.height),t.clip()},l.prototype.P2e=function(t){var e,n,e,n=this.BO();t&&t.forEach(function(t){var t=t.src;t&&!n.getImage(t)&&n.addImage(t,"anonymous")})},l.prototype.G2e=function(s,u){var c,t,f,e,l,h,d,v,n,c=this,t=c.Vv,f=c.im(),e=c.T2e,l=e.iconSpace,h=e.iconTextSpace,d=e.defaultSize;s.save(),c.$v=[],c.M2e=[],v=s.font,(n=t.qv()).forEach(function(t){var e,n,i,e,t,e,n,i,e,r,n,o,i,e,o,a,n,e=null==(e=u[t.name()])?void 0:e.composedStyle,n=null!=(n=null==e?void 0:e.font)?n:v,i=null!=(i=null==e?void 0:e.leftIcons)?i:[],e=null!=(e=null==e?void 0:e.rightIcons)?e:[],r=g(g([],i,!0),e,!0);s.font=m.W.ii(n,"bold"),n=c.Dv+c.kv,(o=0)<r.length&&(c.P2e(r),o=r.reduce(function(t,e){var t;return t+(null!=(t=e.width)?t:d)},0),n=(n=(n+=l*(r.length-1))+(0<i.length?h:0))+(0<e.length?h:0)),i=Math.round(s.measureText(t.name()).width)+o+n,c.$v.push(i),f||(e=y(s.font),o=null!=(t=null==r?void 0:r.reduce(function(t,e){var t;return Math.max(t,null!=(t=e.height)?t:d)},0))?t:0,n=(a=Math.max(e,o))+2*c.ig,c.M2e.push(n))}),s.restore()},l.prototype.Ig=function(t,e){var n,i,r,n,o,a,s,u,r,r,c,f,l,r,h,d,i=this,r=i.Vv,n=null==(n=(0,T.jf)(i.Vv))?void 0:n.options.rightToLeft,o=r.qv(),a=i.im(),s=i.ot(),u=[];if(e&&a&&!n&&(r=i.aTe().width,s.width=r),r=e?0:i.tm(),!e&&i.nm()&&a&&(r-=i.em()),c=r,r=e?i.N2(-1):i.om,a&&0<r&&0<=i.Vm(r)&&(c+=i.Fv),r<0&&(r=i.om=0),n&&a)for(c=s.x+s.width-i.Wsn()-i.em()-i.getPreMoreTabWidth(),h=r;h<o.length&&(d=o[h].visible(),f=i.$v[h],l=i.M2e[h],!(c<i.tm()));h++)u.push({index:h,position:c-f-i._v,width:f,height:l,text:o[h].name(),visible:d,style:t&&t[o[h].name()]}),d===x.SheetTabVisible.visible&&(c-=f+i._v);else for(h=r;h<o.length;h++){if(d=o[h].visible(),f=i.$v[h],l=i.M2e[h],a){if(c>s.x+s.width)break}else if(c>s.y+s.height)break;u.push({index:h,position:c,width:f,height:l,text:o[h].name(),visible:d,style:t&&t[o[h].name()]}),d===x.SheetTabVisible.visible&&(c+=a?f+i._v:l)}return{tabsInfo:u,newTabStartPosition:c}},l.prototype.U2e=function(t){var e,n,i,e,n=x.VisualState.normal,i;return 2007<this.Vv.SC?(t&x.SheetTabState.hover&&(n=x.VisualState.hover),t&x.SheetTabState.selected&&(n=x.VisualState.selected),t&x.SheetTabState.active&&(n=x.VisualState.active),t&x.SheetTabState.active&&!(t&x.SheetTabState.selected)&&(n=x.VisualState.activeNotSelected)):(t&x.SheetTabState.selected||t&x.SheetTabState.hover)&&(n=x.VisualState.hover),n},l.prototype.H2e=function(e,n){var i;return e&&0!==Object.keys(e).length?(i={},Object.keys(n.composedStyle).forEach(function(t){void 0===e[t]||0===e[t].length?i[t]=n.composedStyle[t]:i[t]=e[t]}),{composedStyle:i,borderLeftColor:n.borderLeftColor,borderBottomColor:n.borderBottomColor}):n},l.prototype.D2e=function(t,e,n,i){var r,o,o,o,a,i,s,u,c,r=this,o=this.Vv.sheetTabStyles.C2e(n),o=r.U2e(o),o=T.I.He(o,"gc-tab-"+T.I.Ee(o)),a=T.I.He(x.VisualState.normal,"gc-tab-"+T.I.Ee(x.VisualState.normal)),i=r.V2e(t,i,2007<this.Vv.SC?a:o,e),s,u,c;return{composedStyle:{backColor:i,foreColor:r.Um(o.color,"string"==typeof i?i:void 0),font:r.z2e(t,n),leftIcons:[],rightIcons:[]},borderLeftColor:null==a?void 0:a.borderLeftColor,borderBottomColor:o.borderBottomColor}},l.prototype.Y2e=function(t,e,n,i,r){var o,o,a,s,u,c,c,c,o,t;if(r&&0!==Object.keys(r).length)return s={},u=(a=this).Vv.e2(i),c=this.Vv.sheetTabStyles.C2e(n),c=a.U2e(c),c=T.I.He(c,"gc-tab-"+T.I.Ee(c)),r.icons&&(s.leftIcons=null==(o=null==r?void 0:r.icons)?void 0:o.filter(function(t){return!t.position}),s.rightIcons=null==(o=null==r?void 0:r.icons)?void 0:o.filter(function(t){return t.position===x.IconPosition.right})),r.backColor&&(o=T.Pf.vl(u,r.backColor),s.backColor=a.zm(t,n,i,e,o)),r.foreColor?s.foreColor=T.Pf.vl(u,r.foreColor):r.backColor&&(t="string"==typeof s.backColor?T.Pf.vl(u,s.backColor):void 0,s.foreColor=a.Um(c.color,t)),r.font&&(s.font=r.font),s},l.prototype.Z2e=function(i,r){var o,a,t,s,o=this,a=o.Vv,t=a.qv(),s={};return t.forEach(function(t){var t,e,n,n,e,n,t=t.name(),e=a.getSheetPosition(t),n=a.sheetTabStyles.E2e(t),n=o.Y2e(i,r,t,e,n),e=o.D2e(i,r,t,e),n=o.H2e(n,e);s[t]=n}),s},l.prototype.W2e=function(o,a,s){var u,t,c,f,e,l,h,u=this,c=this,f=c.Vv,e=f.qv(),l=c.im(),h=null!=(t=f.SC)?t:0;return e.forEach(function(t,e){var e,e,n,i,t,t,t,r,e,r,t,i,n=t.name(),i=f.getSheetPosition(n),t=u.Vv.sheetTabStyles.C2e(t.name()),t=c.U2e(t),t=T.I.He(t,"gc-tab-"+T.I.Ee(t)),r=T.I.He(x.VisualState.normal,"gc-tab-"+T.I.Ee(x.VisualState.normal)),e=!l&&null!=(e=null==(e=s[e])?void 0:e.position)?e:0,r=c.V2e(o,i,2007<h?r:t,e),t=c.Vv.sheetTabStyles.E2e(n),i=c.zm(o,n,i,e,null==t?void 0:t.backColor);a[n].composedStyle.backColor=null!=i?i:r}),a},l.prototype.aTe=function(){var t,e,n,i,r,o,a,s,u,c,f,t=this,e,n=t.Vv.qv(),i=t.im(),r=0,o=0,a=t.N2(-1);for(a<0&&(t.om=0),i&&0<a&&0<=t.Vm(a)&&(r+=t.Fv),s=a;s<n.length;s++)u=n[s].visible(),c=t.$v[s],f=t.M2e[s],u===x.SheetTabVisible.visible&&(i?r+=c+t._v:o+=f);return{width:r,height:o}},l.prototype.Z2=function(t,e,n){var i,r,o,a,s,r,u,e,i=this,r=i.Vv,o=r.options.scrollbarAppearance===x.ScrollbarAppearance.mobile,a=r.options.tabStripPosition,s=r.options.showHorizontalScrollbar;t&&r&&(r=i.ot(),u=i.Z2e(t,r.y),t.save(),n||i.W2(t,e),t.beginPath(),i.G2e(t,u),e=i.Ig(void 0,n),u=i.W2e(t,u,e.tabsInfo),i.wm(t,r),n||(i.Mm(t,r,e.newTabStartPosition,u),i.Dm(t,r)),e=i.Ig(u,n),i.nCe=u,i.J2(t,r,e.tabsInfo,n),n||(i.Vv&&i.Vv.options.tabNavigationVisible&&i.Im(t,r),s&&!o&&a===x.TabStripPosition.bottom&&i.Em(t,r)),t.beginPath(),t.restore())},l.prototype.wm=function(t,e){},l.prototype.Mm=function(t,e,n,i){},l.prototype.X2=function(t,e){var n,i,r,i,i,n=this,i=n.im(),r=n.tm();n.nm()&&(r-=n.em()),i?(i=e.x+n.dm(),t.rect(r,0,i-r,e.height)):(i=n.Yv(),t.rect(0,r,e.width,e.height-r-i)),t.clip()},l.prototype.np=function(t,e){var n,i,r,o,a,n=this,i=n.om,r=n.im(),o=n.tm(),a=n.Xv();0<i&&0<=n.Vm(i)&&r&&n.Am(t,e,i,o,a)},l.prototype.Q2e=function(t,e,n){var i,r,i=this,r;i.im()?i.Hm(t,n.position,0,n.width,e.height,n.text,n.style):i.Hm(t,0,n.position,e.width,n.height,n.text,n.style)},l.prototype.J2=function(t,e,n,i){var r,o,a,s,u,r=this,o=r.Vv;if(r.hm=o.ep(),0<n.length){for(t.save(),t.beginPath(),i||r.X2(t,e),a=void 0,s=n.length-1;-1<s;s--)(u=n[s]).index===r.hm?a=u:u.visible===x.SheetTabVisible.visible&&r.Q2e(t,e,u);a&&a.visible===x.SheetTabVisible.visible&&r.Q2e(t,e,a),t.restore(),t.save(),t.beginPath(),i||r.np(t,e),t.restore()}},l.prototype.Am=function(t,e,n,i,r){},l.prototype.Im=function(t,e){},l.prototype.Dm=function(t,e){},l.prototype.Em=function(t,e){},l.prototype.km=function(t,e,n,i,r,o,a,s,u,c){},l.prototype.Hm=function(t,e,n,i,r,o,a){},l.prototype.Dg=function(){return this.fg},l.prototype.ip=function(t,e){var n,t,e,t,i,r,o,a,n=t.createLinearGradient(e.x,e.y,e.width,e.height),t=T.I.He(x.VisualState.normal,"gc-tabStripBackground"),e=t&&t.backgroundImage,t=t&&t.backgroundColor;if(e&&-1!==e.indexOf("linear-gradient"))for(r=0,o=(i=v(e)).length;r<o;r++)a=i[r],n.addColorStop(a.point,a.color);else t&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,t));return n},l.prototype.K2e=function(t){var e,n,e=this,n=e.Vv.Gm(t);return n=""===t&&0<e.om?e.Vv.e2(e.om-1):n},l.prototype.zm=function(t,e,n,i,r){var i,o,a,s,u,e,c,f,e,n,u,l,h,i,a;if(r)return a=(o=this).ot(),s=o.K2e(e),u=o.im(),c=(e=o.Vv.sheetTabStyles.C2e(e))&x.SheetTabState.active,f=e&x.SheetTabState.selected,e=e&x.SheetTabState.hover,n=u?t.createLinearGradient(a.x+.7*a.height,a.y+0,.7*a.height,a.height):(u=a.y,(l=0)<=i&&(u=i,l=null!=(i=o.M2e[n])?i:0),t.createLinearGradient(a.x+.7*l,u,.7*l,u+l)),t.fillStyle=h="rgba(0, 0, 0, 0)",i=t.fillStyle,t.fillStyle=T.Pf.vl(s,r),(a=t.fillStyle)!==i&&((2007<o.Vv.SC?c:f||e)?(n.addColorStop(0,A),n.addColorStop(.45,"#F1F6FD"),n.addColorStop(.9,a),n.addColorStop(1,A)):n=a),n},l.prototype.V2e=function(t,e,n,i){var i,r,o,a,s,u,c,r,e,f,l,h,d,r=this,o=r.ot(),a,s=r.im()?t.createLinearGradient(o.x+.7*o.height,o.y+0,.7*o.height,o.height):(u=o.y,(c=0)<=i&&(u=i,c=null!=(i=r.M2e[e])?i:0),t.createLinearGradient(o.x+.7*c,u,.7*c,u+c));if(n)if(r=n.backgroundImage,e=n.backgroundColor,r&&-1!==r.indexOf("linear-gradient"))for(l=0,h=(f=v(r)).length;l<h;l++)d=f[l],s.addColorStop(d.point,d.color);else e&&s.addColorStop(0,e);return s},l.prototype.Um=function(t,e){var e=e?r._(e):null;return e&&r.rp(e)<127.5?A:t||Q},l.prototype.z2e=function(t,e){var n,n,i,e,n,n=this,i,e=n.Vv.sheetTabStyles.C2e(e),n=null!=(n=n._font)?n:t.font;return n=e&x.SheetTabState.selected||e&x.SheetTabState.hover||e&x.SheetTabState.active?m.W.ii(n,"bold"):n},l.prototype.BO=function(){var t=this;return t.MC||(t.MC=new d.Wh(function(){t.MC&&t.repaint()})),t.MC},l.prototype.Mt=function(t,e,n){var i,n,i=t.font;return t.font=null!=n?n:t.font,t.textBaseline="middle",n=t.measureText(e).width,t.font=i,n},t.Hv=n=l,(0,T.$e)(n)},"./dist/core/workbook/workbook-json.js":function(a,t,e){"use strict";var r,s,tt,_,J,wt,et,Z,n,nt,Q,bt,Ct,X,u,q,it,rt,L,A,ot,$,yt,c,at,Mt,l,h,st,ut,kt,Tt,xt,Gt,f,v,Bt,ct,ft,d,It,Pt,lt,i,o,ht,e,dt,g,vt,gt,m;function D(t,e){return t.hasOwnProperty(e)}function j(t){var t,e,n,e;if(t&&"string"==typeof t){if(3<(e=(t=t.split(".")).length))return 3;if(n=m(t[0]),e<=2)return isNaN(n)?1:n;if(e=m(t[1]),10<=n)return n;if(3<=n){if(20143<=e)return 3;if(20142<=e)return 2}}return 1}function Rt(t){var e,n,i,t,r,o,a,s,u,e=this,n=t&&t.frozenColumnsAsRowHeaders,i=t&&t.frozenRowsAsColumnHeaders;if(n||i)for(rt&&(t=e.op()).isAdjustSuspended()&&t.resumeAdjust(),o=(r=e.sheets).length,a=0;a<o;a++)u=(s=r[a]).Ut,i&&gt(u.ap)&&(s.cp=!0,s.deleteRows(0,u.ap)),n&&gt(u.fp)&&s.deleteColumns(0,u.fp)}function O(t,e){var n,i,r,o,a,s,u,c,a,n=this,i=e&&e.frozenColumnsAsRowHeaders,r=e&&e.frozenRowsAsColumnHeaders,o=0,s=t.sheets;if(r||i)for(u in s)"string"==typeof u&&(c=s[u],a=gt(c.index)?c.index:c.lp,a=n.sheets[gt(a)?a:o],r&&gt(c.frozenRowCount)&&(a.cp=!0,a.deleteRows(0,c.frozenRowCount)),i&&gt(c.frozenColCount)&&a.deleteColumns(0,c.frozenColCount),o++)}function V(t,e){t.hp(e,0)}function p(p,S,w){return function(){for(var n,n,m,t,e,i,r,m=S.dataManager(),t=function(t){var e,d,v,g;if(null==(n=t[0])||!n.getParent())return"continue";e=null==(n=t[1])?void 0:n.dataView,(d=m.tables[e&&e.tableName])&&(v=d.views[e.name])&&((g=v).dp=function(){w(t),delete g.dp},v.vp=function(){for(var t,e,n,i,r,o,a,s,u,c,f,l,h,h,t=function(t){if(!t[0].getParent()||!t[1])return"continue";var e=t[1].dataView;(d=m.tables[e&&e.tableName])&&(v=d.views[e.name])&&g!==v&&v.fetch().then(function(){w(t)})},e=0,n=p;e<n.length;e++)t(i=n[e]);for(o in r=m.tables)if(r.hasOwnProperty(o))for(u in s=(a=r[o]).views)s.hasOwnProperty(u)&&delete(c=s[u]).vp;for(f=0,l=p;f<l.length;f++)if((i=l[f])[0].getParent()&&i[1]&&(h=i[1].dataView,d=m.tables[h&&h.tableName])&&(v=d.views[h.name],g===v)){h=i[0],S.suspendPaint(),h.Mf.recalcAll(!0),S.resumePaint();break}})},e=0,i=p;e<i.length;e++)t(r=i[e])}}function Nt(o,a,s,i){var u,t,c,e,f,l,h;if(0<o.length){for(u=a.dataManager(),t=void 0,e=0;e<o.length;e++)if(t=o[e][1]&&o[e][1].dataView){c=e;break}(f=u.tables[t&&t.tableName])&&(l=f.views[t.name])&&(h=function(t){var e=t[0],n=t[1],t=t[2];e.getParent()&&(e.ANi(n,i),t)&&w(a,t,e)},l.fetch().then(function(){var n,t,e,i,r;if(o[c][0].getParent()){for(h(o[c]),n=[],t=function(t){var e=t[1]&&t[1].dataView;e&&(f=u.tables[e.tableName])&&(l=f.views[e.name])&&n.push(l.fetch().then(function(){h(t)}))},e=0,i=o.slice(1);e<i.length;e++)t(r=i[e]);Promise.all(n).then(function(){a.suspendPaint(),s&&a.calculate(1),a.resumePaint()})}}).catch(p(o,a,h)))}}function S(t,e,n){var i,n,n,i=null==e?void 0:e.dataView;return i&&(n=n.tables[i&&i.tableName])&&(n=n.views[i.name])?n.fetch().then(function(){t.ANi(e,!0)}):void 0}function Y(t,e,n,i){for(var r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,r=0,o=e.sheetTabs,a=[],s=i&&i.gp,u=t.mp,c=[],f=e.sheetCount,l=0,h=Object.keys(o);l<h.length;l++)(v=o[d=h[l]])&&(g=v.index-f,c.splice(g,0,v));if(u&&u.length&&c){for(m=0,p=c;m<p.length;m++)if("string"==typeof(S=(v=p[m]).name)&&(w=t.mp[r])){if(w.fromJSON(v,!1,n,i,!0),lt(v.order)||(w.E0i=v.order),!s&&(w._gi===X.SheetType.tableSheet||w._gi===X.SheetType.ganttSheet||w._gi===ht)){for(b=e.formatStringNames,C=[],y=0;b&&y<b.length;y++)(M=b[y]).sheetTabName===w.name()&&C.push(M);a.push([w,v.addition,C])}r++}Nt(a,t,!(i&&i.doNotRecalculateAfterLoad),!0)}}function w(t,e,n){var i,r;if(e)for(i=0;i<e.length;i++)r=e[i],t.pp(t.bp,r.name,r.formula,r.row,r.col,!0,r.comment,n)}function K(t,e){var n,e,n=t.getActiveSheetTab(),e=e.activeSheetTabIndex;gt(e)?(t.yp(e,0),t.u3(n)):(t.f3(),n&&n.b2(!1,!1))}function Et(t,e,n,i,r){var o;return n===ht&&i===ht&&t===ht&&e===ht?ht:(o="",n!==ht&&(o+="$"+c(n)),t!==ht&&(o+="$"+(t+1)),o+=":",i!==ht&&(o+="$"+c(i)),e!==ht&&(o+="$"+(e+1)),r?(0,nt.i2e)(r)+"!"+o:o)}function b(t){var t;if(t instanceof Date)return(t=t.toISOString().split("."))[t.length-1].endsWith("Z")&&(t[t.length-1]="Z"),t.join("")}function Ht(t){var e,n,n,e;t.Dp||(t.Dp={}),t.docProps.appDocProps&&(t.Dp.docPropsApp||(t.Dp.docPropsApp={}),(e=t.docProps.appDocProps).company&&(t.Dp.docPropsApp.Company=i(e.company)),e.manager&&(t.Dp.docPropsApp.Manager=i(e.manager)),e.hyperlinkBase&&(t.Dp.docPropsApp.HyperlinkBase=i(e.hyperlinkBase)),e.template&&(t.Dp.docPropsApp.Template=i(e.template)),e.totalTime)&&("number"!=typeof e.totalTime&&(n=parseInt(e.totalTime,10),e.totalTime=isNaN(n)?0:n),t.Dp.docPropsApp.TotalTime=i(e.totalTime+"")),t.docProps.coreDocProps&&(t.Dp.docPropsCore||(t.Dp.docPropsCore={}),(n=t.docProps.coreDocProps).category&&(t.Dp.docPropsCore.category=i(n.category)),n.contentStatus&&(t.Dp.docPropsCore.contentStatus=i(n.contentStatus)),n.creator&&(t.Dp.docPropsCore.creator=i(n.creator)),n.description&&(t.Dp.docPropsCore.description=i(n.description)),n.keywords&&(t.Dp.docPropsCore.keywords=i(n.keywords)),n.subject&&(t.Dp.docPropsCore.subject=i(n.subject)),n.title&&(t.Dp.docPropsCore.title=i(n.title)),n.created&&(t.Dp.docPropsCore.created=b(n.created)),n.modified&&(t.Dp.docPropsCore.modified=b(n.modified)),n.lastModifiedBy&&(t.Dp.docPropsCore.lastModifiedBy=i(n.lastModifiedBy)),n.lastPrinted&&(t.Dp.docPropsCore.lastPrinted=b(n.lastPrinted)),n.revision)&&("number"!=typeof n.revision&&(e=parseInt(n.revision,10),n.revision=isNaN(e)?1:e),t.Dp.docPropsCore.revision=i(n.revision+""))}function Ut(t,e){var n,i,i,i,n,n;t.Dp=e?$(e):{},e?(e.docPropsApp&&(n={},(i=e.docPropsApp).Company&&(n.company=o(i.Company)),i.Manager&&(n.manager=o(i.Manager)),i.HyperlinkBase&&(n.hyperlinkBase=o(i.HyperlinkBase)),i.Template&&(n.template=o(i.Template)),i.TotalTime&&(i=parseInt(o(i.TotalTime),10),n.totalTime=isNaN(i)?0:i),t.docProps.appDocProps=n),e.docPropsCore&&(i={},(n=e.docPropsCore).created&&(i.created=new Date(n.created)),n.lastModifiedBy&&(i.lastModifiedBy=o(n.lastModifiedBy)),n.modified&&(i.modified=new Date(n.modified)),n.lastPrinted&&(i.lastPrinted=new Date(n.lastPrinted)),n.category&&(i.category=o(n.category)),n.contentStatus&&(i.contentStatus=o(n.contentStatus)),n.creator&&(i.creator=o(n.creator)),n.description&&(i.description=o(n.description)),n.keywords&&(i.keywords=o(n.keywords)),n.subject&&(i.subject=o(n.subject)),n.title&&(i.title=o(n.title)),n.revision&&(n=parseInt(o(n.revision),10),i.revision=isNaN(n)?1:n),t.docProps.coreDocProps=i),e.docPropsCustom&&(t.Dp.docPropsCustom=e.docPropsCustom.map(function(t){var e,n,n=Object.keys(t.propertyItemChildElement)[0];return n&&!n.startsWith("vt:")?r(r({},t),{propertyItemChildElement:((e={})["vt:".concat(n)]=t.propertyItemChildElement[n],e)}):t}))):(delete t.docProps.appDocProps,delete t.docProps.coreDocProps)}function z(n,i,r){tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){var e=e[i];e&&e.call.apply(e,s([n],r,!1))})}function Ft(t,e){for(var n,i,r,o,a,s,u,c,f,f,f,f,c,n=mt(t),i=[],r=0,o=0,a=0,s=0,u=0;u<n;u++)(c=pt(t,u))&&(c.wp=u+1,(f=c.tables)&&0<f.all().length&&f.all().forEach(function(t){++r,t._id=r+""}),(f=c.charts)&&0<f.all().length&&f.all().forEach(function(t){++o,t.wp=o}),(f=c.pictures)&&0<f.all().length&&f.all().forEach(function(t){++a,t.wp=a}),(f=c.pivotTables)&&0<f.all().length&&f.all().forEach(function(t){++s,t.Mp=s}),c=l(e),i.push(c),e.c_.push({n_:d,Id:ft+c,Type:Z.RelationshipConstants.fo,Target:h("worksheets/"+Bt+c)}));return C(e),t.Cp={slicer:0,timeline:0,drawing:0,vmlDrawing:0},i}function C(t){var e=ft+l(t);t.c_.push({n_:d,Id:e,Type:Z.RelationshipConstants.Xs,Target:h("sharedStrings")}),e=ft+l(t),t.c_.push({n_:d,Id:e,Type:Z.RelationshipConstants.Ks,Target:h("styles")}),e=ft+l(t),t.c_.push({n_:d,Id:e,Type:Z.RelationshipConstants.$s,Target:h("theme/theme1")})}function mt(t){return t.getSheetCount()+t.getSheetTabCount()}function pt(t,e){var t=t.e2(e);return t instanceof q.Worksheet?t:t&&t.Mf}function _t(t,e){for(var n,i,r,o,n=0,i=t.getSheetCount();n<i;n++)if(r=t.getSheet(n),e===(o=t.getSheetPosition(r.name())))return null;for(n=0,i=t.getSheetTabCount();n<i;n++)if(r=t.getSheetTab(n),e===(o=t.getSheetPosition(r.name())))return r}function At(t){return t.substring(0,19)===v}function Lt(t){return t.substring(0,23)===f}function Dt(t,e){var n=t;return 255<n.length?n=n.slice(-240):250<(n=e+" "+n).length&&(n=t+" "+Math.random().toString(36).slice(-6)),n}function y(t){for(var e,n,i,e=mt(t),n=0;n<e;n++)if(i=pt(t,n).hl)return i}function jt(t,e,n,i){var r,o,a,s,n,a=t.themeFont;return"Body"===a?o=n||(s=y(e))&&s.bodyFont():"Headings"===a&&(o=i||(s=y(e))&&s.headerFont()),r=o&&t.font?(n=nt.util._0(t.font)).fontWeight+" "+n.fontStyle+" "+n.fontSize+" "+o:t.font||g}function Ot(){return{fileVer:"1.0",proName:"sjs",proVer:nt.productInfo.productVersion}}function Vt(){var t=new _.Style;return t.font="14.67px Calibri",t.foreColor="Text 1",t.borderLeft=new _.LineBorder,t.borderRight=new _.LineBorder,t.borderTop=new _.LineBorder,t.borderBottom=new _.LineBorder,t.name="Normal",t.backColor=null,t}function Yt(t,e){var n,i,n,r,o,a,n=e&&e.rowHeadersAsFrozenColumns,i=e&&e.columnHeadersAsFrozenRows;if(n||i)return 1;if((n=t.mp)&&n.length&&(e&&e.fileType)===X.OpenSaveFileType.excel)for(r=0,o=n;r<o.length;r++)if((a=o[r])._gi!==X.SheetType.reportSheet)return 1}function Kt(t,e){e&&(t.options.colHeaderAutoText=X.HeaderAutoText.numbers)}function zt(t,e){var e=e.state;"hidden"===e?t.visible(X.SheetTabVisible.hidden,!1):"veryHidden"===e&&t.visible(X.SheetTabVisible.veryHidden,!1)}function Wt(t,e,n,i,r,o,a){var s,u,t,n,n,s=pt(t,n),u=r.loadStatus,t=_t(t,n);(s||t)&&(s.loading=!0,n=(n=at(e,"sheetData"))&&n.rowCount||200,u.total+=n,t?(t.yh(e,i,r),lt(e.order)||(t.E0i=e.order)):(s.rv(e,i,r,o,a),lt(e.order)||(s.E0i=e.order)))}function St(t){var e,t,e=t.getActiveSheet();return e||(t=t.getActiveSheetTab())&&(e=t.Mf),e}function Jt(t){for(var e,n,i,e=0,n=mt(t);e<n;e++)delete(i=pt(t,e)).loading,q.Worksheet.et(i,"onSheetLoaded")}function Zt(t,e,n,i){var t=t;ot.culture(e),t.Bp=!1,n&&i&&i.Zg(),t.resumeEvent(),t.Cg(),t.resumePaint()}function Qt(t){for(var e,n,i,r,o,a,e={},n=[],i=0,r=t;i<r.length;i++)a=(o=r[i]).f,e.hasOwnProperty(a)||n.push(e[a]=o);return n}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},s=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(t,"__esModule",{value:!0}),t.Sp=t.Tp=t.Ap=t.getAbsoluteRangeText=t.Ip=void 0,tt=e("./dist/core/workbook/workbook.js"),_=e("./dist/core/worksheet/style.js"),J=e("./dist/core/util/domUtil.js"),wt=e("./dist/core/util/tasks.js"),et=e("./dist/core/excel-io-util/common.js"),Z=e("./dist/core/excel-io-util/excel-types.js"),n=e("Common"),nt=e("./dist/core/util/common.js"),Q=e("CalcEngine"),bt=e("./dist/core/util/styleManager.js"),Ct=e("./dist/core/util/theme.js"),X=e("./dist/core/core.enum.js"),u=e("./dist/core/core.ns.js"),q=e("./dist/core/worksheet/worksheet.js"),it=e("./dist/core/util/dataManager.js"),rt=!!Q,L=_.Style.xp,A=n.Commands.UndoManager,ot=n.Common.CultureManager,$=n.Common.lt.tv,yt=et.Util.Kr,c=et.IndexHelper.nr,at=nt.util.xr,Mt=nt.util.o1,l=et.Util.wr,h=et.Util.Mr,st=et.Util.Sr,ut=et.Util.Oge,kt=nt.util.Pr,Tt=nt.mt.n1,xt=nt.mt.vo,Gt=et.Util.io,f="__builtInValidatorStyle",v="__builtInTableStyle",Bt=Z.XFileConstants.ru,ct=Z.XFileConstants.mo,ft=Z.XFileConstants.Rr,d=Z.XFileConstants.Lr,It=Z.XFileConstants.Ki,Pt=Z.XFileConstants.ou,lt=n.Common.lt.ht,i=n.Common.zf.j0,o=n.Common.zf.dI,ht=void 0,e=new n.Common.ResourceManager(u.SR,"Sheets"),dt=e.getResource.bind(e),g="normal normal normal 11pt/normal Calibri",vt=J.GC$.each,gt=nt.mt.T1,m=parseFloat,t.Ip=S,t.getAbsoluteRangeText=Et,tt.Workbook.prototype.toJSON=function(t){return this.Np(t)},tt.Workbook.prototype.Np=function(i,t){var r,n,e,o,a,s,u,c,f,l,h,d,v,g,m,p,l,f,l,S,w,b,b,C,y,M,k,T,x,G,B,I,P,R,f,l,r=this,n={version:nt.productInfo.productVersion,name:r.name},a=i&&i.rowHeadersAsFrozenColumns,s=i&&i.columnHeadersAsFrozenRows,u=a||s;if(u&&(i.kp=!0),Ht(r),n.docProps=$(r.Dp),rt&&(e=Q.Functions.setLanguagepackage)&&(o=e(),e("en")),this._p&&this._p.Ep(this),c=r.getSheetCount(),n.sheetCount=c,u)for(f=new tt.Workbook,l=i&&i.includeAutoMergedCells,f.fromJSON(r.toJSON({includeBindingSource:!0,includeAutoMergedCells:l,cb:i.cb,convertReportSheetToWorksheet:i&&i.convertReportSheetToWorksheet}),{gp:!0}),r=f,h=0;h<c;h++)v=(d=r.getSheet(h)).getRowCount(1),g=d.getColumnCount(2),p=s&&0<v,(m=a&&0<g)&&d.addColumns(0,g),p&&d.ffe(0,v,3,{rowExpand:p}),m&&d.jp(g,p?v:0),p&&d.Op(v,m?g:0);for(r.Bp=!0,r.suspendPaint(),r.suspendEvent(),rt&&((l=r.Lp).calcOnDemand&&(l.calcOnDemand=!1,r.Fp(),l.suspend(!0),l.resume(!0),l.calcOnDemand=!0),null!=i&&i.saveR1C1Formula&&(n.frc=1,l.forceR1C1Formula=!0),l.suspend(!0)),(f=r.startSheetIndex())&&(n.startSheetIndex=f),vt(r.options,function(t,e){"_ps"!==t&&tt.Workbook.Pp[t]!==e&&(n[t]=e)}),(l=r.getActiveSheetIndex())!==tt.Workbook.Gp&&(n.activeSheetIndex=l),S={},w=0;w<c;w++)d=r.getSheet(w),b=i,lt(t)||w===t||(b={}),(b=d.toJSON(b)).index=w,b.order=d.E0i,S[d.name()]=b;for(J.GC$.isEmptyObject(S)||(n.sheets=S),C={},y=r.getSheetTabCount(),M=r.getActiveSheetTabIndex(),G=function(n){var t,e,t=r.Ofe(n),e=t.toJSON(i);Array.isArray(e)?(e.forEach(function(t,e){t.index=c+n+e-k+1,C[t.sheet.name]=t,T++}),x=e.length-1):e?(e.sheetType=e.sheetType||t._gi,e.index=c+n+x-k,e.order=t.E0i,C[t.name()]=e,T++):(k++,n<=M&&M--)},B=x=T=k=0;B<y;B++)G(B);if(n.sheetTabCount=T,-1!==M&&(n.activeSheetTabIndex=M),J.GC$.isEmptyObject(C)||(n.sheetTabs=C),I=[],P=r.Hp){for(R in P)D(P,R)&&I.push(P[R]);0<I.length&&(n.namedStyles=I)}return(f=r.sheetTabStyles)&&(l=f.all(),J.GC$.isEmptyObject(l)||(n.sheetTabStylesMap=l)),tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){e.toJson&&e.toJson.call(r,n,i)}),(0,it.h2e)(r,n),rt&&e&&e(o),r.Bp=!1,rt&&(delete r.Lp.forceR1C1Formula,r.Lp.resume(!1)),r.resumeEvent(),r.resumePaint(),u&&delete i.kp,n},tt.Workbook.prototype.fromJSON=function(i,r){var t,e,n,o,t,a,s,t,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,E,H,U,F,n=[],o=this;if(o.zp(),!i)return Promise.resolve([]);if(null!=(t=o.Lp)&&t.dCn&&(clearTimeout(o.Lp.dCn),o.Lp.dCn=0),o.Vp&&o.Vp.terminate(),r&&r.incrementalLoading)return!0===r.incrementalLoading&&(r.incrementalLoading={}),o.Yp(i,r);t=j(i.version),s={noSchema:a=t<3,version:t},t=nt.hi.ai(),o.Bp=!0,o.suspendPaint(),o.suspendEvent(),u=ot.culture(),ot.culture("");try{for(g in o.Zp(),o.Wp=new A(o,-1,o.options.allowUndo),rt&&(o.Qp(!0),o.Lp.suspendAdjust(),i.frc)&&(o.Lp.forceR1C1Formula=!0),o.Kp=-1,o.clearSheets(),o.clearSheetTabs(),c=i.name,gt(c)&&(o.name=c),f=o.options,l=i.canUserEditFormula,gt(l)&&(f.allowUserEditFormula=l),h=i.allowDragDrop,gt(h)&&(f.allowUserDragDrop=h),d=i.allowDragHeaderToMove,gt(d)&&(f.allowDragHeaderToMove=d),v=i.allowDragFill,gt(v)&&(f.allowUserDragFill=v),f)D(f,g)&&(m=i[g],gt(m))&&(f[g]=m);if(Ut(o,i.docProps),z(o,"preFromJson",[i,a,r]),n.push((0,it.d2e)(o,i)),p=i.sheetCount,gt(p)||(p=tt.Workbook.Jp),o.Xp(i.sheets||p,0),o.Hp={},o.qp={},S=i.namedStyles)for(w=0,b=S;w<b.length;w++)C=b[w],y=new _.Style,L(C,o),y.fromJSON(C,a,o),o.$p(y);if(tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){var n=e.fromJson;n&&"table"===e.name&&n.call(o,i,a,r)}),k=void(M=0),T=i.sheets,G=x=void 0,I=!(B=!1),T)for(P in T)"string"==typeof P&&(R=T[P],N=gt(R.index)?R.index:R.lp,k=o.sheets[gt(N)?N:M])&&(R.isApplyRefilter=r&&r.isApplyRefilter,k.vCn(R,!1,s,r,!0,n),lt(R.order)||(k.E0i=R.order),M++,G=R.allowUndo,B?I=I&&G===x:(x=G,B=!0));gt(x)&&I&&(f.allowUndo=x),V(o,i),0<o.mp.length?(Y(o,i,s,r),K(o,i)):0<=i.activeSheetTabIndex&&(i.activeSheetIndex=0),E=i.activeSheetIndex,gt(E)||(E=tt.Workbook.Gp),o.tb(E,0,ht,ht,!0),(H=o.sheets[E])&&H.b2(!0,!1),o.dse=o.vse(o.sheets,o.mp),U=i.startSheetIndex,gt(U)&&o.startSheetIndex(U),F=i.backgroundImage,gt(F)&&o.nb(),o.sheetTabStyles.O2e=null!=(e=i.sheetTabStylesMap)?e:{},tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){var e=e.fromJson;e&&e.call(o,i,a,r)}),rt&&o.Lp.resumeAdjust(),O.call(o,i,r),tt.Workbook.et(o,"initCustomName"),o.docProps.customDocPropsManager.rL()}finally{rt&&(o.Lp.resumeAdjust(),delete o.Lp.forceR1C1Formula),ot.culture(u),o.Bp=!1,H=o.getActiveSheet(),t&&H&&H.Zg(),o.resumeEvent(),o.Cg(),o.resumePaint(),H&&o.ki(nt.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:H}),rt&&o.Lp.processDynamicRef()}return Promise.all(n)},tt.Workbook.prototype.Yp=function(n,i){var t,o,e,a,r,e,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,E,H,t=[],o=this;o.Vp=new wt.Tasks(function(){var t,e,n,n,t=o.getActiveSheet();if(t&&!t.loaded)for(e=this.tasks.length-1;0<=e;e--)if((n=this.tasks[e].args[0])&&n.Ut&&n.name&&n.name()===t.name())return n=this.tasks[e],this.tasks.splice(e,1),n;return this.tasks.pop()},function(){var t=o.getActiveSheet();return t&&(o.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)}),e=j(n.version),r={noSchema:a=e<3,version:e},e=nt.hi.ai(),o.Bp=!0,o.suspendPaint(),o.suspendEvent(),s=ot.culture(),ot.culture("");try{for(v in o.Zp(),o.Wp=new A(o,-1,o.options.allowUndo),rt&&(o.Qp(!0),o.Lp.suspendAdjust()),o.Kp=-1,o.clearSheets(),o.clearSheetTabs(),u=n.name,gt(u)&&(o.name=u),c=o.options,f=n.canUserEditFormula,gt(f)&&(c.allowUserEditFormula=f),l=n.allowDragDrop,gt(l)&&(c.allowUserDragDrop=l),h=n.allowDragHeaderToMove,gt(h)&&(c.allowDragHeaderToMove=h),d=n.allowDragFill,gt(d)&&(c.allowUserDragFill=d),c)D(c,v)&&(g=n[v],gt(g))&&(c[v]=g);if(Ut(o,n.docProps),z(o,"preFromJson",[n,a,i]),t.push((0,it.d2e)(o,n)),m=n.sheetCount,gt(m)||(m=tt.Workbook.Jp),o.Xp(n.sheets||m,0),o.Hp={},p=n.namedStyles)for(S=0;S<p.length;S++)w=p[S],b=new _.Style,L(w,o),b.fromJSON(w,a,o),o.$p(b);if(C=0,M=n.sheets,T=k=void 0,G=!(x=!1),M)for(I in B={total:0,valuesLoad:0,formulaLoad:0},i.incrementLoadTask=o.Vp,i.incrementalLoading.loadStatus=B,M)"string"==typeof I&&(P=M[I],R=gt(P.index)?P.index:P.lp,(y=o.sheets[gt(R)?R:C]).loading=!0,y.ub(P.name+"",!0),y.b2(P.isSelected),y.setRowCount(P.rowCount),y.setColumnCount(P.columnCount),gt(P.visible)&&y.visible(P.visible),B.total+=y.getRowCount(),o.Vp.addTask(function(t,e){e.isApplyRefilter=i&&i.isApplyRefilter,t.Yp(e,!1,r,i,!0),lt(e.order)||(t.E0i=e.order)},[y,P]),C++,T=P.allowUndo,x?G=G&&T===k:(k=T,x=!0));gt(k)&&G&&(c.allowUndo=k),V(o,n),0<o.mp.length?(Y(o,n,r,i),K(o,n)):0<=n.activeSheetTabIndex&&(n.activeSheetIndex=0),N=n.activeSheetIndex,gt(N)||(N=tt.Workbook.Gp),o.tb(N,0,ht,ht,!0),(E=o.sheets[N])&&E.b2(!0,!1),H=n.startSheetIndex,gt(H)&&o.startSheetIndex(H),o.Vp.endingCallback=function(){tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,r){r.Yp?o.Vp.addTask(function(t,e,n,i){r.Yp.call(t,e,n,i)},[o,n,a,i]):r.fromJson&&r.fromJson.call(o,n,a,i)}),o.Vp.endingCallback=function(){var t,e,e;for(o.dse=o.vse(o.sheets,o.mp),rt&&o.Lp.resumeAdjust(),O.call(o,n,i),tt.Workbook.et(o,"initCustomName"),rt&&o.Lp.processDynamicRef(),o.docProps.customDocPropsManager.rL(),t=0;t<o.sheets.length;t++)delete o.sheets[t].loading;(y=o.getActiveSheet())&&o.ki(nt.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:y}),i&&i.incrementalLoading&&(e=i.incrementalLoading,o.ki(nt.Events.ProgressChanged,{loadStatus:e.loadStatus,progress:1,sheet:y}),e.loading)&&e.loading(1,{sheet:y}),(e=i&&i.incrementalLoading&&i.incrementalLoading.loaded)&&e(),y&&y.repaint(),o.w2.repaint(),o.Vp.endingCallback=void 0},o.Vp.start()},o.Vp.start()}finally{ot.culture(s),o.Bp=!1,E=o.getActiveSheet(),e&&E&&E.Zg(),o.resumeEvent(),o.Cg(),o.resumePaint()}return Promise.all(t)},tt.Workbook.prototype.getSheetRelsName=function(t){var t,e,t=t.split("/").pop(),e=t.lastIndexOf(".xml");return t.substring(0,e)},tt.Workbook.prototype.getSheetRelsDir=function(t){var t,t,t=t.split("/"),t=t[t.length-2];return"worksheets"!==t?t:"sheets"},t.Ap=mt,t.Tp=pt,tt.Workbook.prototype.wh=function(n){var i,t,e,r,r,o,F,e,a,s,u,c,f,s,l,_,h,A,d,v,s,g,m,p,S,w,L,D,b,C,y,j,e,O,V,a,Y,K,z,M,k,T,x,T,G,B,I,P,R,N,E,H,U,R,I,P,N,E,H,R,U,I,W,e,a,i=this;if(i._p&&i._p.Ep(i),t=!n||!1!==n.includeStyles,Yt(this,n)&&(e=new tt.Workbook,r=n&&n.includeAutoMergedCells,e.fromJSON(i.toJSON({includeBindingSource:!0,includeAutoMergedCells:r,cb:n.fileType,convertReportSheetToWorksheet:n&&n.fileType===X.OpenSaveFileType.excel}),{sb:!0,cb:n&&n.fileType}),i=e),r=i.options,(F=(o={}).workbook={n_:"workbook",c_:[],lossless:{version:Ot(),renamedStylesMap:{},richValueDataArray:[],customData:n&&n.customData},rels:{}}).c_.push(e={n_:"bookViews",c_:[]}),!(a={n_:"workbookView"})===r.showHorizontalScrollbar&&(a.showHorizontalScroll="0"),!1===r.showVerticalScrollbar&&(a.showVerticalScroll="0"),!1===r.tabStripVisible&&(a.showSheetTabs="0"),(s=i.startSheetIndex())&&(a.firstSheet=s),-1!==(u=i.ep()))for(c=u;0<=c;c--)2===(f=i.e2(c))._gi&&u--;for(u!==tt.Workbook.Gp&&(a.activeTab=u),"number"==typeof(s=r.tabStripRatio)&&.6!==s&&(a.tabRatio=1e3*s),e.c_.push(a),Ht(i),o.docProps=$(i.Dp),vt(i.options,function(t,e){"_ps"!==t&&tt.Workbook.Pp[t]!==e&&(F.lossless[t]=e)}),rt&&(l=Q.Functions.setLanguagepackage)&&(_=l(),l("en")),h={},A=mt(i),d=i.getNamedStyles(),v=new bt.StyleManager,s=new nt.SharedStrings,m=!(g={styleManager:v,sharedStrings:s}),p=[{style:null}],S={},w={},L=F.lossless.renamedStylesMap,Object.keys(d).forEach(function(t){var e=d[t].name;e!==dt().NORMAL?p.push({style:d[t]}):(p[0].style=d[t],m=!0),S[e]=1}),D=function(r){var o,t,a,o=pt(i,r);if(!o)return"continue";t={sheet:o},q.Worksheet.et(o,"getActualToSJSFormatSheet",t),a=(o=t.sheet).getNamedStyles(),Object.keys(a).forEach(function(t){var e,n,i,e=a[t].name;if(!Lt(e)&&!At(e)){for(n=e,i=$(a[t]);S[n]||255<n.length;)n=Dt(n,o.name());i.name=n,m||i.name!==dt().NORMAL?p.push({sheetId:r,style:i}):(p[0]={sheetId:r,style:a[t]},m=!0),S[n]=1,e!==n&&(w[e]=w[e]||{},w[e][o.name()]=n,L[n]=e)}})},c=0;c<A;c++)D(c);for(v.gv=w,(b=et.Util.ko(n))||t&&p[0]&&p[0].style?!b||p[0]&&p[0].style||p.shift():(y=pt(i,0),C=t&&y&&!y.NMi?y.getDefaultStyle():{},j=Vt(),Object.keys(C).forEach(function(t){"_id"!==t&&"name"!==t&&(j[t]=C[t])}),p[0]={style:j},m=!0),p.forEach(function(t){v.getNamedStyleIndex(t.style,3,ht,t.sheetId,!b)}),b||(e=p[0].style.clone(!0),(0,nt.AL)(e),v.getStyleIndex(e)),v.updateNamedStylesParentName(),C=m?p[0]&&p[0].style:(y=pt(i,0),t&&y&&!y.NMi?y.getDefaultStyle():Vt()),g.defaultStyle=C,nt.SJSColumnWidthHelper.setMaxDigitWidth(jt(C,i)),tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){e.preToSJSFormat&&e.preToSJSFormat.call(i,o,g,n)}),V={n_:ct,c_:[]},a={n_:Z.XFileConstants.Dr,xmlns:Z.RelationshipConstants._r},Y=Ft(i,a),K=0,o.workbook.rels=a,M=z=0;M<A;M++)if(y=pt(i,M)){if(k=Y[K],f=_t(i,M),K++,T=Bt+k,(x=(f||y).wh(o,g,n)).order=(f||y).E0i-z,h[T]=x,T=y.name(),t&&y.hl&&!O&&(o.theme=O=x&&x.lossless&&x.lossless.theme),(G=x.lossless.definedNames||[])&&G.length)for(c=0;c<G.length;c++)B=G[c],G[c]=ut({name:B.name,localSheetId:M,e:B.e,comment:B.comment,isReadOnly:B.isReadOnly},B.formula);x.richValueDataArray&&0<x.richValueDataArray.length&&(x.richValueDataArray.forEach(function(t){t.imgFileName=yt(t.imageBase64Data,ht,o)}),o.workbook.lossless.richValueDataArray=o.workbook.lossless.richValueDataArray.concat(x.richValueDataArray),delete x.richValueDataArray),I=y.getCalcService(),P=y.Uw(),I&&P&&(R=y.getCustomName("Print_Area"))&&(N=R.getExpression(),E=R.getRow(),H=R.getColumn(),U=R.getComment(),R=R.isReadOnly(),I=I.unparse(P,N,E,H,!1,!0,1),G.push(ut({name:"_xlnm.Print_Area",localSheetId:M,comment:U,isReadOnly:R},I))),(P=x.printInfo)&&(N=Et(P.repeatRowStart,P.repeatRowEnd,ht,ht,T),E=Et(ht,ht,P.repeatColumnStart,P.repeatColumnEnd,T),H=void 0,N&&E?H=E+","+N:N?H=N:E&&(H=E),H&&G.push(ut({name:"_xlnm.Print_Titles",localSheetId:M},H)),delete x.printInfo),x.lossless.definedNames=G,U=void 0,(R=y.visible())===X.SheetTabVisible.hidden?U="hidden":R===X.SheetTabVisible.veryHidden&&(U="veryHidden"),I={n_:Bt,"r:id":ft+k,name:xt(T),sheetId:k,state:U,lossless:{tabSelected:y.b2()?"1":ht}},V.c_.push(I)}else z++;return o.workbook.c_.push(V),o.workbook.lossless.richValueDataArray=Qt(o.workbook.lossless.richValueDataArray),J.GC$.isEmptyObject(h)||(o.sheets=h),o.styles={},tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){e.wh&&e.wh.call(i,o,g,n)}),(0,it.l2e)(i,o),o.styles=v.bv(o.styles,v.wh(n)),o.sharedStrings=s.wh(),v.dispose(),(W=i.sheetTabStyles)&&(e=i.sheetTabStyles.all(),J.GC$.isEmptyObject(e)||(o.workbook.lossless.sheetTabStylesMap=e)),1!==r.referenceStyle&&lt(r.iterativeCalculation)&&lt(r.iterativeCalculationMaximumIterations)&&lt(r.iterativeCalculationMaximumChange)||(a={n_:"calcPr",calcId:0},1===r.referenceStyle&&(a.refMode="R1C1"),r.calculationMode===X.CalculationMode.manual&&(a.calcMode="manual"),!0===r.iterativeCalculation&&(a.iterate=1),lt(r.iterativeCalculationMaximumIterations)||(a.iterateCount=r.iterativeCalculationMaximumIterations),lt(r.iterativeCalculationMaximumChange)||(a.iterateDelta=r.iterativeCalculationMaximumChange),o.workbook.c_.push(a)),kt(o.workbook,Z.WorkbookNodeOrder),rt&&l&&l(_),o},tt.Workbook.prototype.fb=function(t,e){var n,t,n=this;ot.culture(""),n.Zp(),e&&e.calcOnDemand&&(n.options.calcOnDemand=!0),e&&e.incrementalCalculation&&(n.options.incrementalCalculation=!0),e&&!1===e.dynamicReferences&&(n.options.dynamicReferences=!1),!0===t&&(n.options.allowDynamicArray=!0),n.Wp=new A(n,-1,n.options.allowUndo),rt&&(n.Qp(!0),(t=n.Lp).suspendAdjust(),t.suspend(),t.lb=e&&!e.fullRecalc),n.Kp=-1,n.clearSheets(),n.clearSheetTabs()},tt.Workbook.prototype.hb=function(t){var e,n,i,e,e,e,e,r,o,e,e,e=this,n=e.options,i=t.workbook.lossless;if(i)for(r in e.Lp.forceR1C1Formula=i.frc,e=i.canUserEditFormula,gt(e)&&(n.allowUserEditFormula=e),e=i.allowDragDrop,gt(e)&&(n.allowUserDragDrop=e),e=i.allowDragHeaderToMove,gt(e)&&(n.allowDragHeaderToMove=e),e=i.allowDragFill,gt(e)&&(n.allowUserDragFill=e),n)D(n,r)&&(o=i[r],gt(o))&&(n[r]=o);(e=at(t.workbook,"extLst"))&&e.c_&&e.c_[0]&&e.c_[0]["xmlns:xcalcf"]===Z.XFileConstants.Cs&&(n.allowDynamicArray=!0),(e=at(t.workbook,"calcPr"))&&("R1C1"===e.refMode&&(n.referenceStyle=1),"manual"===e.calcMode&&(n.calculationMode=X.CalculationMode.manual),n.iterativeCalculation=1===parseInt(e.iterate,10),n.iterativeCalculationMaximumIterations=lt(e.iterateCount)?100:parseInt(e.iterateCount,10),n.iterativeCalculationMaximumChange=lt(e.iterateDelta)?.001:parseFloat(e.iterateDelta))},tt.Workbook.prototype.db=function(t){var e,e,n,i,r,r,o,a,s,u,c,f,l,l,l,h,h,h,i,d,v,r,i,g,n=this,i=n.options,r=at(t.workbook,"bookViews"),r=at(r,"workbookView");if(r){if(r.showHorizontalScroll&&(i.showHorizontalScrollbar="0"!==r.showHorizontalScroll),r.showVerticalScroll&&(i.showVerticalScrollbar="0"!==r.showVerticalScroll),r.showSheetTabs&&(i.tabStripVisible="0"!==r.showSheetTabs),i.tabStripRatio=lt(r.tabRatio)?.6:r.tabRatio/1e3,r.firstSheet&&n.startSheetIndex(+r.firstSheet),o=0,r.activeTab!==ht)o=+r.activeTab;else if(t.sheets){if(a=at(t.workbook,ct).c_,s=t.workbook.rels&&t.workbook.rels.c_,a&&s){for(u=[],c=0;c<a.length;c++)l=(f=a[c])[It],(l=(l=st(s,l))&&l.Target)&&u.push(n.getSheetRelsName(l));for(c=0;c<u.length;c++)if((h=t.sheets[u[c]])&&(h=at(h,"sheetViews"))&&(h=at(h,"sheetView"))&&"1"===h.tabSelected){o=c;break}}}else if((d=null==(i=at(t.workbook,"sheets"))?void 0:i.c_)&&0<d.length)for(v=0;v<d.length;v++)if("1"===(null==(e=null==(e=null==d?void 0:d[v])?void 0:e.lossless)?void 0:e.tabSelected)){o=v;break}i=(r=n.getActiveSheetOrSheetTab())&&r.b2(),n.I2(o,2),null!=(g=n.getActiveSheet())&&g.b2(!0,!1),r&&i&&n.getActiveSheetOrSheetTab()!==r&&r.b2(!0,!1)}},tt.Workbook.prototype.mb=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,S,w,p,S,p,b,S,p,p,s=this,u=r.sheetNamedStyles;for(d in o=o||{},c=!(s.Hp={})!==a.includeUnusedStyles,f=e.styles&&e.styles.namedStylesMap,l=et.Util.ko(a),h=!0,f)f.hasOwnProperty(d)&&(v=h&&(d===dt().NORMAL||!l&&0===f[d]),l&&!c&&!v&&lt(t.originNamedStylesXfs.Lh[d])||(g=t.getNamedStyle(f[d],d,l),lt(g)&&(g={foreColor:"Text 1 0",themeFont:"Body",font:"normal normal 14.7px Calibri",locked:!0,hidden:!1,textIndent:0,wordWrap:!1,vAlign:2,hAlign:3}),l||g.formatter!==dt().GENERAL||delete g.formatter,v&&(h=!1,g.name="Normal",g.font=jt(g,s,i,n),nt.SJSColumnWidthHelper.setMaxDigitWidth(g.font),delete(m=g.clone()).name,r.defaultStyle=m),g.name=o[g.name]||g.name,g.sheetId!==ht?(u[g.sheetId]||(u[g.sheetId]=[]),u[g.sheetId].push(g)):s.$p(g)));!1!==h&&(p=at(e.workbook,ct).c_,S=e.workbook.rels&&e.workbook.rels.c_,p=(w=p[0])[It],m=b=void 0,m=(m=(b=(p=(S=st(S,p))&&S.Target)?(S=s.getSheetRelsName(p),e[p=s.getSheetRelsDir(p)]&&e[p][S]):e.sheets.sheet1)?b.lossless&&b.lossless.defaultStyle:m)||{hAlign:3,imeMode:1,themeFont:"Body",vAlign:0},(p=new _.Style).fromJSON(m,ht,ht),p.font=jt(p,s,i,n),nt.SJSColumnWidthHelper.setMaxDigitWidth(p.font),r.defaultStyle=p),a&&a.fileType===X.OpenSaveFileType.excel&&t.buildDummyNamedStyles(s)},t.Sp=St,tt.Workbook.prototype.yh=function(r,o,n){var F,_,A,L,D,j,O,V,t,a,s,i,u,c,e,f,Y,l,h,d,v,g,K,m,p,S,w,b,C,y,M,z,k,W,J,Z,T,Q,X,x,G,B,I,P,R,N,E,H,q,U,$,t=[],a=this;if(a.zp(),r){n=n||function(){},s=et.Util.Mo(o),(o=o||{}).progress||(o.progress=function(t){}),o.loadStatus={total:0,valuesLoad:0,formulaLoad:0},i=function(t){a.pb(nt.Events.ProgressChanged,{loadStatus:o.loadStatus,progress:t.progress,sheetName:t.sheetName}),o.progress({step:t.step,sheetName:t.sheetName,progress:t.progress})},a.Vp&&a.Vp.terminate(),a.Vp=new wt.LoadTasks(function(){var t,e,n,n,t=St(a);if(t&&!t.loaded)for(e=this.tasks.length-1;0<=e;e--)if((n=this.tasks[e].args[0])&&n.Ut&&n.name&&n.name()===t.name())return n=this.tasks[e],this.tasks.splice(e,1),n;return this.tasks.pop()},function(){var t=St(a);return s&&t&&(a.ib.eb||t.isEditing()||t.rt.rb||t.rt.ob||t.rt.ab)},i),a.suspendPaint(),a.suspendEvent(),u=nt.hi.ai(),a.Bp=!0,c=ot.culture(),e=!1;try{if(a.fb(r.workbook.lossless&&r.workbook.lossless.allowDynamicArray,o),a.hb(r),Ut(a,r.docProps),(f=new bt.StyleManager).yh(r.styles),(Y=new nt.SharedStrings).yh(r.sharedStrings),l={},Object.keys(r).forEach(function(t){-1<t.indexOf(Pt)&&(l[t]=r[t])}),h=void 0,h=(r.sheets&&r.sheets.sheet1&&r.sheets.sheet1.lossless&&r.sheets.sheet1.lossless.theme?r.sheets.sheet1.lossless:r).theme,v=d=void 0,h&&"string"!=typeof h?h&&(K=at(h,"themeElements"),m=at(K,"fontScheme"),d=Mt(m,"majorFont&latin").typeface,v=Mt(m,"minorFont&latin").typeface):((g=new Ct.Theme(ht)).yh("string"==typeof h?h:"Office"),d=g.headerFont(),v=g.bodyFont()),p={drawings:r.drawings,tables:r.tables,charts:r.charts,media:r.media,ctrlProps:r.ctrlProps,comments:l,pivotTables:r.pivotTables,slicers:r.slicers,slicerCaches:r.slicerCaches,timelineCaches:r.timelineCaches,timelines:r.timelines,styleManager:f,sharedStrings:Y,theme:r.theme,sheetNamedStyles:{},dataEffectByInflate:{},attachments:r.attachments},a.mb(f,r,d,v,p,r.workbook.lossless&&r.workbook.lossless.renamedStylesMap,o),tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){var e=e.preFromSJSFormat;e&&e.call(a,r,p,o)}),t.push((0,it.v2e)(a,r)),S=at(r.workbook,"definedNames"),p.workbookNames=S&&S.c_,b=(w=at(r.workbook,ct).c_||[]).length,gt(b)||(b=tt.Workbook.Jp),C=r.workbook.rels&&r.workbook.rels.c_,o&&(o.incrementLoadTask=a.Vp),C){for(y=[],M=[],z=1===a.options.referenceStyle,k=0;k<b;k++){if(J=(W=w[k])[It],T=(Z=st(C,J))&&Z.Target||"",Q=a.getSheetRelsName(T),X=a.getSheetRelsDir(T),x=null==(F=null==r?void 0:r[X])?void 0:F[Q],G=Gt(Tt(W.name)),B=!0,I=null==(_=null==x?void 0:x.lossless)?void 0:_.addition,P=(null==x?void 0:x.sheetType)||(null==(A=null==x?void 0:x.lossless)?void 0:A.sheetType),I||P)if(R=a.bb(G,P||0)){for(a.yb(k-a.sheets.length,0,R),N=r.workbook.lossless.formatStringNames,E=[],H=0;N&&H<N.length;H++)(q=N[H]).sheetTabName===R.name()&&E.push(q);y.push([R,I,E])}else B=!1;else U=a.S2(G),a.A2(k,0,U);B&&(M[k]=x)}for(k=0;k<b;k++)(x=M[k])&&Wt(a,x,k,p,o,!et.Util.wo(o,a.v2),t),(U=pt(a,k))&&(zt(U,w[k]),Kt(U,z));Nt(y,a,o&&o.fullRecalc,!0)}a.db(r),$={},null!=(D=null==(L=r.workbook)?void 0:L.lossless)&&D.customData&&($.customData=r.workbook.lossless.customData),a.sheetTabStyles.O2e=null!=(V=null==(O=null==(j=r.workbook)?void 0:j.lossless)?void 0:O.sheetTabStylesMap)?V:{},a.Vp.endingCallback=function(){a.UCe(),tt.Workbook.fh&&vt(tt.Workbook.fh,function(t,e){var i=s&&e.Mb||e.yh;i&&a.Vp.addTask(function(t,e,n){i.call(a,r,p,o)},[a,r,o])}),a.Vp.endingCallback=function(){var t,e,e;f.dispose(),et.Util.wo(o,a.v2)||Rt.call(a,o),t=!1,rt&&((e=a.Lp).resumeAdjust(),delete a.Lp.forceR1C1Formula,o.fullRecalc?(Jt(a),e.resume(!(t=!0),!1,!e.calcOnDemand)):(e.resumeWithoutCalc(),delete e.lb,a.Lp.processDynamicRef())),tt.Workbook.et(a,"initCustomName"),a.docProps.customDocPropsManager.rL(),t||Jt(a),a.options.backgroundImage&&a.nb(),e=St(a),i({progress:1,step:"whole workbook loaded.",sheetName:e&&e.name()}),s?e&&e.repaint():Zt(a,c,u,e),e&&a.ki(nt.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:e}),n($)},a.Vp.start()},a.Vp.start(),Promise.all(t).then(function(){a.ki(nt.Events.DataFetchCompleted,{spread:a})})}catch(t){throw e=!0,t}finally{(s||e)&&Zt(a,c,u,St(a))}}}},"./dist/core/workbook/workbook.js":function(P,R,t){"use strict";var u,e,o,b,F,N,E,H,U,O,V,v,Y,K,C,z,W,J,Z,Q,X,q,$,y,_,c,t,tt,et,nt,it,w,A,f,L,rt,D,ot,j,at,st,ut,ct,a,s,ft,lt,ht,g,dt,n,l,vt,d,gt,h,m,p,mt,pt,St,wt,S,bt,Ct,yt,M,Mt,k,kt,T,x,Tt,xt,Gt,Bt,It,Pt,e,G,Rt,Nt,Et,r,Ht,e;function Ut(t,e){return F.Bf.Zl()%1!=0||t.zoom()%1!=0||t.parent&&t.parent.options.scrollByPixel&&e&&t.Cb&&t.Cb.Sb((0,F.Ec)(t.Tb,t.Ab,1,1))}function Ft(e,n){return A.setTimeout(function(){e.invalidateLayout(),e.repaint(),n.Ib=L;var t=e.ot();n.xb(e,t.x,t.width),n.Nb(e,t.y,t.height)},200)}function _t(t,e,n){t.ki(F.Events.ActiveSheetChanged,{oldSheet:e,newSheet:n})}function At(t,e){t.ki(F.Events.ActiveSheetChanging,e)}function Lt(t,e){t.ki(F.Events.ActiveSheetChangingInternal,e)}function Dt(t,e,n){t.ki(F.Events.ActiveSheetChangedInternal,{oldSheet:e,newSheet:n})}function i(t){this._wb=t}function jt(t,e,n,i){var r,o,e,a,e,r=F.I.fl("gc-vertical-scrollbar"+wt),a=2007<w(r.zIndex)?1:0,e=e-n,e=e%2==0?(o=e/2)-a:o=(e-a)/2;i?(0,b.GC$)(t).css({"box-sizing":pt,border:p,"border-color":p,"border-right-style":St,"border-right-width":a+d,"border-right-color":r.borderLeftColor,"background-color":r.backgroundColor,width:n,padding:"0px "+o+"px 0px "+e+d,margin:0}):(0,b.GC$)(t).css({"box-sizing":pt,border:p,"border-color":p,"border-left-style":St,"border-left-width":a+d,"border-left-color":r.borderLeftColor,"background-color":r.backgroundColor,width:n,padding:"0px "+o+"px 0px "+e+d,margin:0})}function Ot(t,e,n){var i,r,e,o,e,i=F.I.fl("gc-horizontal-scrollbar"+wt),o=2007<w(i.zIndex)?1:0,e=e-n,e=e%2==0?(r=e/2)-o:r=(e-o)/2;(0,b.GC$)(t).css({"box-sizing":pt,border:p,"border-color":p,"border-top-style":St,"border-top-width":o+d,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:n,padding:e+"px 0px "+r+"px 0px",margin:0})}function Vt(t){var e=F.I.fl("gc-footer-corner"+wt);(0,b.GC$)(t).css({border:p,padding:0,margin:0,"background-color":e.backgroundColor})}function Yt(t,e,n,i,r){var o,a,e,o=t._b(),a=e.left-n.left,e=e.top-n.top;if(a<i&&i<o.width+a&&e<r&&r<o.height+e)return{horizontalScrollBarHitInfo:{element:t.hitTest(i-a,r-e).element},x:i,y:r}}function Kt(t,e,n,i,r){var o,a,e,o=t._b(),a=e.left-n.left,e=e.top-n.top;if(a<i&&i<o.width+a&&e<r&&r<o.height+e)return{verticalScrollBarHitInfo:{element:t.hitTest(i-a,r-e).element},x:i,y:r}}function zt(t){var t=(0,b.GC$)(t);return{top:Wt(t,"borderTopWidth"),right:Wt(t,"borderRightWidth"),bottom:Wt(t,"borderBottomWidth"),left:Wt(t,"borderLeftWidth")}}function Wt(t,e){var n=t.css(e);switch(n){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(n)}}function Jt(t){var t=(0,b.GC$)(t);return{top:parseFloat(t.css("paddingTop")),right:parseFloat(t.css("paddingRight")),bottom:parseFloat(t.css("paddingBottom")),left:parseFloat(t.css("paddingLeft"))}}function Zt(t){var e,n,i,n,t,r,o,e=t.getBoundingClientRect().width,n=zt(t),i=n.left,n=n.right,t=Jt(t),r,o;return e-i-n-t.left-t.right}function Qt(t){return C.SheetType[t]}function Xt(t){var e,n,i,r,o,e=t.getSheetCount(),n=t.getSheetTabCount();if(0!==e&&0!==n)for(i=t.qv(),r=0;r<i.length;r++)if(o=i[r],r<e&&o.NMi||e<=r&&!o.NMi)return;return 1}function qt(t){var e={calcSources:[]};return v.Worksheet.et(t,"getRelatedCalcSources",e),e.calcSources}function B(t){var t=(0,F.jf)(t);return!!t&&t.options.rightToLeft}function I(t,e){var i,n,e,i=this;i.name="",i.sheetTabStyles=new W.SheetTabStyleManager(i),i.docProps={customDocPropsManager:new J.CustomDocPropsManager(i)},i.Eb=!1,i.Kp=-1,i._2=0,i.jb=-1,i.Bp=!1,i.options=tt(Ht,function(t,e,n){i.Ob(t,e,n)}),i.Zp(e),e&&"white"===e.backColor?i.Rb=!0:i.Rb=!1,i.ZVe=!1,n=1,e&&typeof(e=e.sheetCount)==at&&(n=e),"string"==typeof t&&(t=f.getElementById(t)),i.Ti=t,i.Hc(n,t)}Object.defineProperty(R,"__esModule",{value:!0}),R.Workbook=void 0,u=t("./dist/core/workbook/workbookpanelex.js"),e=t("./dist/core/core.ns.js"),o=t("Common"),b=t("./dist/core/util/domUtil.js"),F=t("./dist/core/util/common.js"),N=t("./dist/core/util/imageLoader.js"),E=t("./dist/core/worksheet/worksheet-actions.js"),H=t("./dist/core/workbook/sheettab.js"),U=t("./dist/core/workbook/sheettab2007.js"),O=t("./dist/core/worksheet/stylehelper.js"),V=t("./dist/core/worksheet/clipboardhelper.js"),v=t("./dist/core/worksheet/worksheet.js"),Y=t("CalcEngine"),K=!!Y,C=t("./dist/core/core.enum.js"),z=t("DataManager"),W=t("./dist/core/workbook/sheettabStyleManager.js"),J=t("./dist/core/workbook/customDocPropsManager.js"),Z=o.Common.zf,Q=o.Commands.UndoManager,X=o.Commands.CommandManager,q=b.GC$.each,$=b.GC$.extend,y=K,_=o.Common.lt.ht,c=F.mt.En,t=F.mt.p0,tt=F.mt.b0,et=F.mt.yt,nt=F.mt.T1,it=o.Common.CultureManager,w=parseInt,A=window,f=document,L=null,rt=Math.round,D=Math.min,ot=Math.floor,j=Math.abs,at="number",st="mousedown",ut="mousemove",ct="mouseup",a="mouseenter",s="mouseleave",ft="scroll",lt="resize",ht="focus",g=".gcSpread",dt=".gcSpreadInternal",n=".gcScrollbar",l="div",vt="table",d="px",gt="100%",h="gc-scroll-handle",m="gc-scroll-bar",p="none",mt="absolute",pt="content-box",St="solid",wt=" ui-widget-header ui-state-default btn btn-default",S="gc-scroll-mobile-container",bt="gc-scroll-mobile-container-horizontal",Ct="gc-scroll-mobile-container-vertical",yt="gc-scroll-mobile-spread-hovering",M="gc-scroll-mobile-state-hide",Mt="gc-scroll-mobile-state-hover",k=A.jQuery,kt="cultureChanged",T="workbook",x="gcUIElement",Tt="gc-no-user-select",xt="visible",Gt="overflow",Bt="en-US",It=80,Pt=1,e=new o.Common.ResourceManager(e.SR,"Sheets"),G=e.getResource.bind(e),Rt=100,Nt=30,Et=40,i.Bb=function(t,e){var t,n,n,t=t.data,n=t.ib;n.Lb&&(A.clearTimeout(n.Lb),n.Lb=L),(n=t.jg())&&e&&n.Fb(t,e)},i.Pb=function(t){var t,e,t=t.data,e=t.jg();e&&e.Gb(t)},i.Ub=function(t,e){var n,i,r,r,i,r,i,n=t.data;n&&((i=n.getActiveSheet())?((r=n.zb.Hb)&&r.Vb&&(i.Oi=!0),i.Zg()):(r=n.getActiveSheetTab())&&r.Zg(),1===(i=n.options.showScrollTip)||3===i)&&(i=(r=(0,b.GC$)(t.srcElement||t.target)).parent(),r&&(r.hasClass(h)||r.hasClass(m))||i&&(i.hasClass(h)||i.hasClass(m)))&&n.ib.Yb(!1,t,e)},i.Zb=function(t,e){var t,n,n,t=t.data,n=t.ib;n.Lb&&(A.clearTimeout(n.Lb),n.Lb=L),(n=t.jg())&&e&&n.Wb(t,e)},i.Qb=function(t){var t,e,t=t.data,e=t.jg();e&&e.Kb(t)},i.Jb=function(t){var e,n,i,i,n,i,n,e=t.data;e&&((n=e.getActiveSheet())?((i=e.Xb.Hb)&&i.Vb&&(n.Oi=!0),n.Zg()):(i=e.getActiveSheetTab())&&i.Zg(),2!==(n=e.options.showScrollTip)&&3!==n||(i=(0,b.GC$)(t.srcElement||t.target))&&(n=i.parent(),i.hasClass(h)||n&&n.hasClass(h)||i.hasClass(m)||n&&n.hasClass(m))&&e.ib.Yb(!0,t))},i.qb=function(t,e){var t,n,n,n,e,t=t.data,n=t.ib;n.Lb&&(A.clearTimeout(n.Lb),n.Lb=L),(n=t.jg())&&e&&(n.onHorizontalDockScroll(t,e),1!==(n=t.options.showScrollTip)&&3!==n||(e=t.ib.$b(!1,!0),t.ny(e)))},i.ey=function(t){var t=t.data;t&&t.iy()},i.ry=function(t){var e,n,i,r,i,o,t,e=G(),n=t.data,i=t.scrollbar;n.options.enableAccessibility&&(r=(0,b.GC$)(i.oy()).offset(),i=i.hitTest(t.x-r.left,t.y-r.top),t=(o={thumbButton:e.ARIA_Scrollbar_Thumb_Button,trackButton:e.ARIA_Scrollbar_TRACK_Button,leftButton:e.ARIA_Scrollbar_Left_Button,rightButton:e.ARIA_Scrollbar_Right_Button,upButton:e.ARIA_Scrollbar_Top_Button,downButton:e.ARIA_Scrollbar_Bottom_Button})[i.element],n.n2(t))},i.prototype.L0=function(){this._wb=L},i.prototype.ay=function(t,e,n,i){var r=this;t&&(r.eb=!0,r.uy=i?t.Tb:e,r.fy=i?t.ly:n,r.hy=i?e:t.Ab,r.vy=i?n:t.my,A.setTimeout(function(){r.gy(t)},0))},i.prototype.gy=function(t){var e=this;t&&e.eb&&(e.eb=!1,e.py(t))},i.prototype.py=function(t){var e,n,i,r,o,a,s,e=this;e.by||(e.by=!0,n=e._wb,t&&(i=n.options.showScrollTip,r=e.uy,o=e.fy,a=e.hy,s=e.vy,r!==t.Tb||o!==t.ly?(e.yy(t,r,o),2!==i&&3!==i||n.ny(e.$b(!0))):a===t.Ab&&s===t.my||(e.wy(t,a,s),1!==i&&3!==i)||n.ny(e.$b(!1))),e.by=!1)},i.prototype.yy=function(t,e,n,i){var r,o,a,s,u,c,c,i,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,B,N,E,l,i,B,S,i,H,h,p,r=this;if(r.Ib&&(A.clearTimeout(r.Ib),r.Ib=L),t&&(o=t.Tb,a=t.ly,s=t.zoom(),u=t.parent.options.scrollByPixel,(c=!_(i))||e!==o||n!==a))if(c&&(o=i),t.Tb=e,t.ly=n,0<t.My)(o!==e||u&&a!==n)&&t.ki(F.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:o,newTopRow:e,oldOffset:j(a/s),newOffset:j(n/s)});else{if(c=!1,l=(f=(i=t.options).sheetAreaOffset.top)+2,h=t.kg,v=(d=t.Fi()).Cy,g=t.Sy(d),m=d.Ty,p=d.Ay,S=d.Iy,w=d.width+i.sheetAreaOffset.left+(t.options.rightToLeft&&t.gj?t.gj().width:0),y=C=b=void 0,k=(M=t.Dn).J(),T=t.Ny,x=t.FCn,t.tables&&0===t.frozenRowCount()&&(G=t.tables.Dy())&&(G.x=G.x-2,G.width=G.width+4,G.y=f,G.height=v,t.k1=!0,M.D1(k,G)),o<e||e===o&&j(n)>j(a)){if(I=B=void 0,B=(P=t._y(1))&&0<P.length?P.findRow(e):B){for(I=P[R=P.length-1];I&&I.y+I.height>v+g;)I=P[R-=1];I&&I.row>e&&(c=!0,C=(h||d).x,y=B.y+j(n),x&&t.FCn(B.row)&&(y-=t.PCn(B.row)),b=I.y+I.height-y-l,M.Ey(C,y,w,b,C,v),i.colHeaderVisible||(t.invalidateLayout(),M.D1(k,new F.Rect(C,0,w,f+1))),t.invalidateLayout(),G=new F.Rect(C,v+b,w,(B=T?g:g+S+m)-b),M.D1(k,G,void 0,r.cAn(t,G)),M.Ey(d.Py,d.Cy,d.hL,d.A6,d.Py,d.Cy,!0),M.jy(k,new F.Rect(C,v-2,w,2+(B-=T?0:m))),this.xb(t,C,w))}}else{for(N=0,E=e;E<o&&N<g;E++)N+=t.Gt(E),x&&(t.FCn(E)&&(N+=t.PCn(E)),t.FCn(E,!0))&&(N+=t.PCn(E,!0));(N+=j(a)-j(n))<g&&(c=!0,C=(h||d).x,y=v,b=g-N,0<t.frozenTrailingRowCount()&&--b,l=0,!T&&0<m&&(l=S+((i=d.qAe())?i.height:0),B=D(h.height-l-1,p-1+N),M.Ey(C,p-1,w,l+1,C,B)),S=T?0:D(N,m)-1,M.Ey(C,y,w,b+S,C,y+N),t.invalidateLayout(),i=t.rowOutlines&&!t.rowOutlines.Oy()?t.rowOutlines.Ry()+f+1:0,G=new F.Rect(C,y-f,w,N+f+i+5),M.D1(k,G,void 0,r.cAn(t,G)),M.Ey(d.Py,d.Cy,d.hL,d.A6,d.Py,d.Cy,!0),M.jy(k,new F.Rect(C,y-2,w,H=g+S+l+2)),this.xb(t,C,w))}c||(t.invalidateLayout(),t.repaint()),(o!==e||u&&a!==n)&&t.ki(F.Events.TopRowChanged,{sheet:t,sheetName:t.name(),oldTopRow:o,newTopRow:e,oldOffset:j(a/s),newOffset:j(n/s)}),(h=t.rt)&&h.By(),p=o===t.Tb&&a!==t.ly,c&&Ut(t,p)&&(r.Ib=Ft(t,r))}},i.prototype.xb=function(t,e,n){var i=t.Dn,r=i.J();this.Ly(t).concat(this.Fy(t)).forEach(function(t){var t=t.layout,t=new F.Rect(e,t.y,n,t.height);i.O1(t),i.jy(r,t)})},i.prototype.Ly=function(t){var e,n,e,i,r,o,n,a,n,e=this,n=t.getSelections();return!(1===n.length&&0<t.frozenRowCount())||(e=e._wb.options.scrollByPixel,i=t.Tb,r=t.ly,o=n[0].row,n=n[0].row+n[0].rowCount-1,e&&n==i-1)?[]:(a=[],(o===i+1||o<i&&i<=n||n==i-1||e&&o===i&&0!==r)&&(n=t._y(0))&&0<n.length&&a.push({layout:n[n.length-1]}),a)},i.prototype.Fy=function(t){var e,n,e,i,r,n,o,a,s,a,t,u,t,u,e=this,n=t.getSelections();return 1===n.length&&0<t.frozenTrailingRowCount()?(e=e._wb.options.scrollByPixel,i=t.getViewportBottomRow(1),r=n[0].row,n=n[0].row+n[0].rowCount-1,o=[],a=(s=(a=t._y(2))&&0<a.length)?a[0]:L,t=(u=(t=t._y(1))&&0<t.length)?t.findRow(i):L,u=s&&u&&a.y!==t.y+t.height,(n==i-1||r<=i&&i<n||r===i+1||e&&n===i&&u)&&s&&o.push({layout:a}),o):[]},i.prototype.wy=function(t,e,n,i){var r,o,a,s,u,c,u,i,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,G,N,E,H,h,i,G,i,G,d,U,i,x,r=this;if(r.Ib&&(A.clearTimeout(r.Ib),r.Ib=L),t&&(o=t.Ab,a=t.my,s=t.zoom(),(u=!_(i))||e!==o||n!==a))if(c=t.parent.options.scrollByPixel,u&&(o=i),t.Ab=e,t.my=n,0<t.My)(o!==e||c&&n!==a)&&t.ki(F.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:e,oldOffset:j(a/s),newOffset:j(n/s)});else{if(u=!1,f=(i=t.options).sheetAreaOffset.left,l=i.rightToLeft,h=f+2,d=t.kg,g=(v=t.Fi()).Py,m=t.Gy(v),p=v.Uy,S=v.Hy,w=v.zy,b=v.height+i.sheetAreaOffset.top,M=y=C=void 0,T=(k=t.Dn).J(),x=t.Vy,o<e||e===o&&j(n)>j(a)){if(B=G=void 0,G=(I=t.Yy(1))&&0<I.length?I.findCol(e):G){for(B=I[P=I.length-1];B&&(l?B.x<S+w:B.x+B.width>g+m);)B=I[P-=1];B&&B.col>e&&(u=!0,y=(d||v).y,l?(C=B.x,M=G.x+G.width-j(n)-C,R=0<t.frozenColumnCount()?1:0,k.Ey(C,y,M-R,b,v.b6-M,y)):(C=G.x+j(n),M=B.x+B.width-C-h,k.Ey(C,y,M,b,g,y)),i.rowHeaderVisible||(t.invalidateLayout(),k.D1(T,new F.Rect(0,y,f+1,b))),t.invalidateLayout(),G=x?m:m+w+p,l?k.D1(T,new F.Rect(v.b6-G,y,G-M+.5,b)):(N=new F.Rect(g+M,y,G-M,b),k.D1(T,N,void 0,r.cAn(t,N)),k.Ey(v.Py,v.Cy,v.hL,v.A6,v.Py,v.Cy,!0)),k.jy(T,new F.Rect(g-2,y,2+(G-=x?0:p),b)),this.Nb(t,y,b))}}else{for(E=0,H=e;H<o&&E<m;H++)E+=t.nn(H);(E+=j(a)-j(n))<m&&(u=!0,y=(d||v).y,M=(C=l?v.b6:g,m-E),l||0<t.frozenTrailingColumnCount()&&--M,h=0,!x&&0<p&&(h=w+((i=v.XAe())?i.width:0),l?(G=Math.max(d.x,S-E),k.Ey(S,y,h,b,G,y)):(i=D(d.width-h-1,S-1+E),k.Ey(S-1,y,h+1,b,i,y))),G=x?0:D(E,p)-1,l?(R=0<t.frozenColumnCount()?1:0,k.Ey(C-M,y,M-R,b,C-M-E,y)):k.Ey(C,y,M+G,b,C+E,y),t.invalidateLayout(),d=t.columnOutlines&&!t.columnOutlines.Oy()?t.columnOutlines.Ry()+f+1:0,l?k.D1(T,new F.Rect(C-f-E,y,E+f+d+5,b)):(N=new F.Rect(C-f,y,E+f+d+5,b),k.D1(T,N,void 0,r.cAn(t,N)),k.Ey(v.Py,v.Cy,v.hL,v.A6,v.Py,v.Cy,!0)),k.jy(T,new F.Rect(g-2,y,U=m+G+h+2,b)),this.Nb(t,y,b))}u||(t.invalidateLayout(),t.repaint()),(o!==e||c&&a!==n)&&t.ki(F.Events.LeftColumnChanged,{sheet:t,sheetName:t.name(),oldLeftCol:o,newLeftCol:e,oldOffset:j(a/s),newOffset:j(n/s)}),(i=t.rt)&&i.By(),x=o===t.Ab&&a!==t.my,u&&Ut(t,x)&&(r.Ib=Ft(t,r))}},i.prototype.Nb=function(t,e,n){var i=t.Dn,r=i.J();this.Zy(t).concat(this.Wy(t)).forEach(function(t){var t=t.layout,t=new F.Rect(t.x,e,t.width,n);i.O1(t),i.jy(r,t)})},i.prototype.Zy=function(t){var e,n,e,i,r,o,n,a,n,e=this,n=t.getSelections();return!(1===n.length&&0<t.frozenColumnCount())||(e=e._wb.options.scrollByPixel,i=t.Ab,r=t.my,o=n[0].col,n=n[0].col+n[0].colCount-1,e&&n==i-1)?[]:(a=[],(o===i+1||o<i&&i<=n||n==i-1||e&&o===i&&0!==r)&&(n=t.Yy(0))&&0<n.length&&a.push({layout:n[n.length-1]}),a)},i.prototype.Wy=function(t){var e,n,e,i,r,n,o,a,s,a,t,u,t,u,e=this,n=t.getSelections();return 1===n.length&&0<t.frozenTrailingColumnCount()?(e=e._wb.options.scrollByPixel,i=t.getViewportRightColumn(1),r=n[0].col,n=n[0].col+n[0].colCount-1,o=[],a=(s=(a=t.Yy(2))&&0<a.length)?a[0]:L,t=(u=(t=t.Yy(1))&&0<t.length)?t.findCol(i):L,u=s&&u&&a.x!==t.x+t.width,(n==i-1||r<=i&&i<n||r===i+1||e&&n===i&&u)&&s&&o.push({layout:a}),o):[]},i.prototype.Mg=function(t,e,n,i){var r,o,a,s,u,c,f,l,o,h,h,l,o,h,l,n,l,o,h,s,n,l,s,o,h,f,u,r=this,o=r._wb,a=!1,s=o.Xb,u=o.zb,c=o.options.scrollbarShowMax,f=o.options.scrollbarAppearance===C.ScrollbarAppearance.mobile;if(t){if(l=t.name(),e.ctrlKey){if(!o.options.allowUserZoom)return!0;if(o=t.zoom(),h=F.mt.ige(o-.05*n),t.isEditing()&&!t.endEdit())return;if(h={sheet:t,sheetName:t.name(),oldZoomFactor:o,newZoomFactor:h,cancel:!1},t.ki(F.Events.ViewZooming,h),!0===h.cancel)return!1;l={cmd:"zoom",sheetName:l,oldZoomFactor:o,zoomFactor:h.newZoomFactor},t.Qy().execute(l)}else i=i||0,o=t.Tb,h=t.ly,n=(l=r.Jy(t,n)).Ky,l=l.Xy,o!==n||h!==l?(f&&(s.qy(C.ScrollbarState.show),r.$y(!0)),r.yy(t,n,l),t.tw(),c||t.ew()):a=!0,o=t.Ab,h=t.my,n=(s=r.rw(t,i)).iw,l=s.Xy,o===n&&h===l||(f&&(u.qy(C.ScrollbarState.show),r.$y(!1)),r.wy(t,n,l),t.ow(),c)||t.aw();(s=t.rt).ab&&s.rb||(o=t.uw(),h=t.hitTest(e.pageX-o.left,e.pageY-o.top),(u=(f=t.sw)&&f.cellTypeHitInfo)&&(u.cellRect=t.getCellRect(f.row,f.col)),s.cw(h),s.fw(h))}return a&&0===i},i.prototype.hw=function(t,e){var n,i,r,o,a,s,u,c,e,o,f,e,o,r,l,o,r,n=t.Tb,i=t.ly,r=t.parent,o=t.zoom(),a=rt(e*r.options.scrollPixel*o),s=0,e=t.Fi().Cy,o=t.dw(1).findRow(n),f=t.FCn;if(o)if(a<0){for(u=t.vw(-1),s=-(e-o.y),f&&t.FCn(n)&&(s-=t.PCn(n));u<n&&a<=s;)s-=t.Gt(--n),f&&(t.FCn(n)&&(s-=t.PCn(n)),t.FCn(n,!0))&&(s-=t.PCn(n,!0));i=s-a,n===u&&0<i&&(i=0)}else if(0<a){for(c=t.mw().Ky,s=o.y+o.height-e,f&&t.FCn(o.row,!0)&&(s+=t.PCn(o.row,!0));n<c&&s<=a;)s+=t.Gt(++n),f&&(t.FCn(n)&&(s+=t.PCn(n)),t.FCn(n,!0))&&(s+=t.PCn(n,!0));e=t.Gt(n),f&&(t.FCn(n)&&(e+=t.PCn(n)),t.FCn(n,!0))&&(e+=t.PCn(n,!0)),i=s-a-e,r.options.scrollbarMaxAlign?(o=t.Fi(),r=t.frozenRowCount(),l=t.getRowCount()-t.frozenTrailingRowCount()-1,c=(o=t.gw(t.Sy(o),r,l)).Ky,r=o.Xy,c<n?(n=c,i=r):n===c&&j(i)>j(r)&&(i=r)):n<c&&s-a==0?(n++,i=0):n===c&&s-a<0&&(i=-e)}return{Ky:n,Xy:i}},i.prototype.Jy=function(t,e){var n,i,r,r,o,o,e,n=t.Tb,i=t.ly,r=t.parent;return r&&r.options.scrollByPixel?r.ib.hw(t,e):(0<(r=t.frozenRowCount())&&(0===n&&0<e?n=r:e<0&&n===r-e&&(n=0)),-1!==(o=t.vw(n+e,e<0))?n=o:n+=e,o=t.pw(),e=t.mw().Ky,t.getRowCount()-r-t.frozenTrailingRowCount()<=0||o===L?n=t.Tb:(n<o?n=o:e<n&&(n=e),n===L&&(n=-1)),{Ky:n,Xy:i})},i.prototype.bw=function(t,e){var n,i,r,o,a,s,u,c,e,o,o,e,r,f,e,r,n=t.Ab,i=t.my,r=t.parent,o=t.zoom(),a=rt(e*r.options.scrollPixel*o),s=0,e=t.Fi().Py,o=t.yw(1).findCol(n);if(o)if(a<0){for(u=t.ww(-1),s=-(e-o.x);u<n&&a<=s;)s-=t.nn(--n);i=s-a,n===u&&0<i&&(i=0)}else if(0<a){for(c=t.Mw().iw,s=o.x+o.width-e;n<c&&s<=a;)s+=t.nn(++n);i=s-a-(o=t.nn(n)),r.options.scrollbarMaxAlign?(e=t.Fi(),r=t.frozenColumnCount(),f=t.getColumnCount()-t.frozenTrailingColumnCount()-1,c=(e=t.Cw(t.Gy(e),r,f)).iw,r=e.Xy,c<n?(n=c,i=r):n===c&&j(i)>j(r)&&(i=r)):n<c&&s-a==0?(n++,i=0):n===c&&s-a<0&&(i=-o)}return{iw:n,Xy:i}},i.prototype.rw=function(t,e){var n,i,r,r,o,o,e,n=t.Ab,i=t.my,r=t.parent;return r&&r.options.scrollByPixel?r.ib.bw(t,e):(0<(r=t.frozenColumnCount())&&(0===n&&0<e?n=r:e<0&&n===r-e&&(n=0)),-1!==(o=t.ww(n+e,e<0))?n=o:n+=e,o=t.Sw(),e=t.Mw().iw,t.getColumnCount()-r-t.frozenTrailingColumnCount()<=0||o===L?n=t.Ab:(n<o?n=o:e<n&&(n=e),n===L&&(n=-1)),{iw:n,Xy:i})},i.prototype.Yb=function(t,e,n){var i,r,o,n,a,i,i=this,r=i._wb,a;(0,F.jf)(r)&&(i=i.$b(t,n),n=t?(o=e.pageY,e.pageX-100):(o=e.pageY-40,e.pageX-30),r.Tw(Z.j0(i),n,o,!0))},i.prototype.$b=function(t,e){var n,i,n=(0,F.jf)(this._wb);return i=n?n.getScrollTooltipContent(t,e):i},i.prototype.Aw=function(t){(0,b.GC$)(t).addClass(M)},i.prototype.Iw=function(t){(0,b.GC$)(t).removeClass(M)},i.prototype.xw=function(t){(0,b.GC$)(t).addClass(Mt)},i.prototype.Nw=function(t){(0,b.GC$)(t).removeClass(Mt)},i.prototype.$y=function(t,e){var n,i,r,o,a;void 0===e&&(e=1e3),i=(n=this)._wb,r=t?i.kw:i.Dw,a=function(){n.Nw(r),n.Aw(r)},(o=i.options.scrollbarAppearance=C.ScrollbarAppearance.mobile)&&(n._w(t),t?n.Ew=setTimeout(a,e):n.jw=setTimeout(a,e))},i.prototype._w=function(t){var e=this;t&&e.Ew?(clearTimeout(e.Ew),e.Ew=null):!t&&e.jw&&(clearTimeout(e.jw),e.jw=null)},i.prototype.cAn=function(t,e){var t=t.ot();return new F.Rect(Math.max(e.x-2,0),Math.max(e.y-2,0),Math.min(e.width+4,t.width),Math.min(e.height+4,t.height))},r=i,Ht={allowDragHeaderToMove:C.AllowDragHeaderToMove.none,allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:C.TabStripPosition.bottom,tabStripWidth:80,tabEditable:!0,newTabVisible:!0,allSheetsListVisible:C.AllSheetsListVisibility.auto,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:L,backgroundImageLayout:0,showResizeTip:C.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:C.ShowScrollTip.none,grayAreaBackColor:L,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:C.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,pivotAreaReference:1,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,incrementalCalculation:!1,dynamicReferences:!0,autoFitType:C.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:C.CopyPasteHeaderOptions.allHeaders,calculationMode:C.CalculationMode.auto,allowUserDragMerge:!1,rowResizeMode:C.ResizeMode.normal,columnResizeMode:C.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:C.ScrollbarAppearance.skin,font:L,customList:[],numbersFitMode:C.NumbersFitMode.mask,pasteSkipInvisibleRange:!1,allowAutoExtendFilterRange:!1,allowInvalidFormula:!1,formulaFormatHint:!0,defaultSheetTabStyles:{},builtInFileIcons:{},dragHeaderMaskBackColor:L,dragHeaderIndicatorColor:L},I.prototype.commandManager=function(){return this.Qy},I.prototype.undoManager=function(){return this.Wp},I.prototype.Ow=function(){var t=this.Rw(),e=this.Bw;return e instanceof Array?e.concat(t):t},I.prototype.Rw=function(){var t=it.culture(),e=[],n=[],i=it.Fe(Bt).DateTimeFormat,r=it.Fe(t).DateTimeFormat,e=this.Lw(i);return t!==Bt&&(n=this.Lw(r)),e.concat(n)},I.prototype.Lw=function(e){var n=[],i,r;return this.Fw=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Fw.forEach(function(t){(i=e[t])instanceof Array&&0<i.length&&(r=-1<t.indexOf("month")||-1<t.indexOf("Month"),i=r?i.slice(0,12):i,n.push(i))}),n},I.prototype.Fp=function(){var t,e,t,e=y&&this.op();e&&e.clearDirties(),this.sheets.forEach(function(t){var e;t.Uw().Gw()})},I.prototype.Ob=function(t,e,n){var i,r,o,a,i=this,r=(0,F.jf)(i),o=i.w2,a=y&&i.op();switch(t){case"allowUndo":i.Wp&&(i.Wp.Hw=e);break;case"backColor":i.Rb=!0,r&&r.zw();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":case"builtInFileIcons":r&&r.zw();break;case"backgroundImage":case"backgroundImageLayout":i.nb(),r&&r.zw();break;case"newTabVisible":case"allSheetsListVisible":case"tabNavigationVisible":case"tabStripPosition":e!==n&&i.Vw(e);break;case"tabStripWidth":e!==n&&i.Yw(e);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":i.Cg();break;case"tabStripRatio":i.Xg();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":r&&(r.Zw=!0,r.Ww=!0,r.zw());break;case"scrollByPixel":r&&(r.Zw=!0,r.Ww=!0,r.ly=0,r.my=0,r.zw());break;case"scrollPixel":e<=0&&(i.options.scrollPixel=n);break;case"scrollbarAppearance":i.ib&&e!==n&&i.Qw(e);break;case"calcOnDemand":a&&(!e&&a.calcOnDemand&&i.Fp(),a[t]=e);break;case"incrementalCalculation":case"dynamicReferences":a&&(a[t]=e);break;case"customList":i.Bw=e;break;case"referenceStyle":case"allowDynamicArray":case"calculationMode":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":i.Kw(t,e),r&&r.zw();break;case"defaultSheetTabStyles":o&&o.repaint()}i.ki(F.Events.WorkbookOptionsChangedInternal,{propertyName:t,value:e})},I.prototype.Qw=function(t){var e,n,n=(t=_(t)?C.ScrollbarAppearance.skin:t)===C.ScrollbarAppearance.mobile;(e=this).Xb.Jw(t),e.zb.Jw(t),e.Xw.Jw(t),e.qw(),n?e.$w():e.tM(),e.refresh()},I.prototype.Vw=function(t){var e=this;_(t)&&(t=C.TabStripPosition.bottom,e.options.tabStripPosition=t),e.nM&&(e.eM(),e.iM(),e.Cg())},I.prototype.Yw=function(t){var e=this;_(t)?e.options.tabStripWidth=t=80:t<80&&(e.options.tabStripWidth=80),e.nM&&(e.iM(),e.Cg())},I.prototype.Kw=function(t,e){var n,i,n,i=y&&this.op();if(i)switch(t){case"referenceStyle":i.useR1C1=1===e;break;case"allowDynamicArray":case"calculationMode":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":i[t]=e}},I.prototype.Hc=function(t,e){var r,n,i,o,n,r=this;for(y&&r.Qp(),r.rM=[],r.oM=c("input"),r.vf=0,r.sg=0,r.aM={fromSheet:L,isCutting:!1},r.uM={fromSheet:L,isCutting:!1},r.sM=L,r.sheets=[],r.mp=[],r.dse=[],r.Hp={},r.Bw=r.options.customList,r.Wp=new Q(r,-1,r.options.allowUndo),(n=r.Qy=new X(r)).cM("beforeWorkbookExecute",function(t){r.fM(t)}),n.addListener("workbookUndo",function(t){var e,n,i,i,e=t.command,n=E.Commands.lM(e),i=r.Qy[e.cmd];i&&i.canUndo()&&!n&&!e.hM&&((i=r.getSheetFromName(e.sheetName))&&(e.sheetId=i._id),r.undoManager().dM(e,t.vM)),1!==t.vM&&2!==t.vM||r.mM(t)}),E.Commands.gM(n),I.et(r,"init"),i=0;i<t;i++)o=r.S2(r.T2(i)),r.sheets.push(o),r.dse.push(o),o.E0i=i,o.pM(r);(n=r.sheets[r._2])&&n.isSelected(!0),r.suspendPaint(),e&&r.hg(e),r.bM=new V.yM(r),r.resumePaint()},I.prototype.hitTest=function(t,e,n){var i,r,o,a,s,u,c,u,f,l,c,h,c,c,d,v,c,d,r,v,c,g,m,p,n,S,w,d,r,o,v,c,n,d,r,a,o,v,c,n,i=this,r=i.jg(),o=i.w2,a=i.zb,s=i.Xb,u=(0,b.GC$)(i.getHost()).width(),c=(0,b.GC$)(i.getHost()).height();if(t<0||u<t||e<0||c<e)return L;if(u=i.wM(),f=i.options.scrollbarAppearance===C.ScrollbarAppearance.mobile){if(c=Yt(a,l=(0,b.GC$)(i.Dw).offset(),u,t,e))return c;if(c=Kt(s,h=(0,b.GC$)(i.kw).offset(),u,t,e))return c}if(r&&(c=r.uw(),d=r.ot(),v=c.left-u.left,c=c.top-u.top,v<t)&&t<d.width+v&&c<e&&e<d.height+c)return{worksheetHitInfo:r.hitTest(t-v,e-c,!1,n),x:t,y:e};if(d=(0,b.GC$)(o.Dg()).offset(),r=o.ot(),v=d.left-u.left,c=d.top-u.top,v<t&&t<r.width+v&&c<e&&e<r.height+c){switch(m={},p=(g=o.hitTest(t-v,e-c)).index,S=(n=i.e2(p))&&n.name(),w=L,n&&Qt(n._gi)&&(w=n._gi),g.type){case"navButton":m={navButton:g.element};break;case"sheetTab":m={sheetTab:{sheetName:S||g.element,sheetIndex:p}},w!==L&&(m.sheetTab.sheetType=w);break;case"resize":m={resize:!0};break;default:m={blank:!0}}return{tabStripHitInfo:m,x:t,y:e}}return d=(0,b.GC$)(a.oy()).offset(),r=a._b(),o=d.left-u.left,v=d.top-u.top,o<t&&t<r.width+o&&v<e&&e<r.height+v?{horizontalScrollBarHitInfo:{element:a.hitTest(t-o,e-v).element},x:t,y:e}:(c=(0,b.GC$)(s.oy()).offset(),n=s._b(),d=c.left-u.left,r=c.top-u.top,d<t&&t<n.width+d&&r<e&&e<n.height+r?{verticalScrollBarHitInfo:{element:s.hitTest(t-d,e-r).element},x:t,y:e}:(a=(0,b.GC$)(i.MM).offset(),o=parseInt(i.MM.style.width.substr(0,i.MM.style.width.indexOf("px")),10),v=parseInt(i.MM.style.height.substr(0,i.MM.style.height.indexOf("px")),10),c=a.left-u.left,n=a.top-u.top,c<t&&t<o+c&&n<e&&e<v+n?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:e}:void 0))},I.prototype.wM=function(){var t=this,t,t=(k||b.GC$)(t.Ti).offset();return t?(t.top+=f.body.clientTop||0,t.left+=f.body.clientLeft||0):t={top:0,left:0},t},I.prototype.Zp=function(t){var n,t,n=this.options,t=t||{};t=$(!0,{},Ht,t),q(t,function(t,e){n.hasOwnProperty(t)&&(n[t]=e)})},I.prototype.j2=function(){var t=this;return!t.sM&&t.Ti&&(t.sM=c(l),(0,b.GC$)(t.sM).css({position:"relative",left:0,top:0,height:0}).attr(x,"gcLayerContainer"),(0,b.GC$)(t.Ti).prepend(t.sM)),t.sM},I.prototype.T2=function(t){var e,n,i,r,o,a,s,u,e=this,n=e.getSheetCount();e.Kp<n?e.Kp=n:e.Kp++,(_(t)||t<e.Kp)&&(t=e.Kp),i=!1,o=e.qv();do{for(r=(G().SHEET_NAME||"Sheet")+(t+1),a=o.length,s=0;s<a;s++)if(u=o[s]){if(u.name().toUpperCase()===r.toUpperCase()){t++,i=!0;break}i=i&&!1}}while(i);return r},I.prototype.S2=function(t,e){var n={name:t,type:e,sheet:null};return I.et(this,"createSheet",n,function(){return n.sheet!==L}),n.sheet||new v.Worksheet(t)},I.prototype.setHost=function(t){this.hg(t)},I.prototype.hg=function(t){var e=this;t&&(e.Ti=t,e.CM(),e.nl(),e.SM(),e.TM(),e.AM(),e.IM(),e.xM(),e.NM(),e.kM(),e.DM(),e._M(),e.$w(),e.EM(),e.jM(),e.OM(),e.BM(),e.iM(),e.Cg(),e.LM(t),I.et(e,"setHost",t))},I.prototype.CM=function(){var t,e,t=this,e=t.Ti;k&&k(e).data(T,t),(0,b.GC$)(e).data(T,t).attr(x,"gcSpread").addClass(Tt).css(Gt,xt)},I.prototype.nl=function(){A.gcGlobal.nl()},I.prototype.SM=function(){var t=this;t.cultureChangedHandler=function(){t.FM()},f.addEventListener(kt,t.cultureChangedHandler)},I.prototype.TM=function(){var t=this;t.PM(),t.GM(),t.HM()},I.prototype.GM=function(){var t,e,n,i,r,o,a,s,u,t=this,e=t.Ti,n=c(vt),i=n.style;for(n.cellSpacing="0px",n.cellPadding="0px",n.border="0",i.width=gt,i.height=gt,i.border="0",i.margin="0",i.borderCollapse="collapse",i.float="left",r=0;r<3;r++){for(o=c("tr"),a=0;a<2;a++)(u=(s=c("td")).style).padding="0",u.border="0",o.appendChild(s);n.appendChild(o)}e.appendChild(n),t.nM=n},I.prototype.PM=function(){var t,e,n,i,t=this,e=t.Ti,n=c(l),i=n.style;i.width="0",i.height="0",i.float="left",e.appendChild(n),t.zM=n},I.prototype.HM=function(){var t,e,n,i,t=this,e=t.Ti,n=c(l),i=n.style;i.width="0",i.height="0",i.float="left",e.appendChild(n),t.VM=n},I.prototype.AM=function(){var t,e,n,i,r,t=this,e=t.Ti,n,i=t.nM.rows[1].cells[0],r=c(l);r.id=e.id+"vp",(0,b.GC$)(i).append(r),t._vp=r},I.prototype.IM=function(){var t,e,n,i,r,i,r,r,i,o,t=this,e,n=t.nM.rows[1].cells[1],i=t.options,r=i.scrollByPixel,i=i.scrollbarAppearance,r=r?C.ScrollType.pixels:C.ScrollType.continuous,r=new u.YM(!1,L,L,L,L,L,r,i,function(){t.ZM(!0)}),i=c(l),o=r.oy();(0,b.GC$)(i).append(o),t.Xb=r,t.kw=i,t.WM=n},I.prototype.QM=function(){var i,t,i=this,t=i.Xb.oy();(0,b.GC$)(t).bind(ft+n,function(t,e){var n=e.scrollEventType;t.data=i,e.scrollOrientation===u.ScrollOrientation.verticalScroll&&(n===C.Zi.smallDecrement||n===C.Zi.smallIncrement||n===C.Zi.largeDecrement||n===C.Zi.largeIncrement||n===C.Zi.thumbTrack?r.Zb(t,e):n===C.Zi.thumbPosition&&r.Qb(t))}).bind(st+n,function(t){t.data=i,r.Jb(t)}).bind(ct+n,function(t){t.data=i,r.ey(t)}).bind(ut+n,function(t){t.data=i,t.scrollbar=i.Xb,r.ry(t)})},I.prototype.xM=function(){var t,e,n,i,r,o,a,s,u,t=this,e,n=t.nM.rows[2].cells[0],i=c(vt),r=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",r.border="0",r.margin="0",(0,b.GC$)(i).css("user-select",p),o=c("tr"),a=0;a<2;a++)(u=(s=c("td")).style).padding="0",u.border="0",o.appendChild(s);i.appendChild(o),(0,b.GC$)(n).append(i),t.JM=i},I.prototype.NM=function(){var t,e,n,i,r,t,o,e=this,n=e.Ti,i=c(l),r=i.style,t=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft,o=e.Jg();r.width=(o=t?1-o:o)*(0,b.GC$)(n).width()+d,r.height=e.Zv()+d,r.fontSize="10pt",r.fontFamily="Arial",e.XM=i},I.prototype.kM=function(){var t,e,n,i,r,o,r,o,t,o,a,s,a,o,e=this,n,i=e.JM.rows[0].cells[1],r=e.options,o=r.scrollByPixel,r=r.scrollbarAppearance,o=o?C.ScrollType.pixels:C.ScrollType.continuous,t=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft,o=new u.YM(!0,L,L,L,L,L,o,r,function(){e.ZM(!1)},t),a=o.oy(),s=c(l);(0,b.GC$)(s).append(a),e.zb=o,o=(a=new u.YM(!0,L,L,L,L,L,C.ScrollType.pixels,r,function(){e.ZM(!1)},t)).oy(),(0,b.GC$)(s).append(o),e.Xw=a,e.Dw=s,e.qM=i},I.prototype.$M=function(){var i,t,i=this,t=i.zb.oy();(0,b.GC$)(t).bind(ft+n,function(t,e){var n=e.scrollEventType;t.data=i,e.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(n===C.Zi.smallDecrement||n===C.Zi.smallIncrement||n===C.Zi.largeDecrement||n===C.Zi.largeIncrement||n===C.Zi.thumbTrack?r.Bb(t,e):n===C.Zi.thumbPosition&&i.iy())}).bind(st+n,function(t){t.data=i,r.Ub(t)}).bind(ct+n,function(t){t.data=i,r.ey(t)}).bind(ut+n,function(t){t.data=i,t.scrollbar=i.zb,r.ry(t)})},I.prototype.tC=function(){var i,t,i=this,t=i.Xw.oy();(0,b.GC$)(t).bind(ft+n,function(t,e){var n=e.scrollEventType;t.data=i,e.scrollOrientation===u.ScrollOrientation.horizontalScroll&&(n===C.Zi.smallDecrement||n===C.Zi.smallIncrement||n===C.Zi.largeDecrement||n===C.Zi.largeIncrement||n===C.Zi.thumbTrack?r.qb(t,e):n===C.Zi.thumbPosition&&r.Pb(t))}).bind(st+n,function(t){t.data=i,r.Ub(t,!0)}).bind(ct+n,function(t){t.data=i,r.ey(t)}).bind(ut+n,function(t){t.data=i,t.scrollbar=i.Xw,r.ry(t)})},I.prototype.DM=function(){var t=this;t.nC(),t.eC()},I.prototype.nC=function(){var t,e,n,i,t=this,e,n=t.nM.rows[0].cells[1],i=c(l);(0,b.GC$)(n).append(i),t.iC=i},I.prototype.eC=function(){var t,e,n,i,t=this,e,n=t.nM.rows[2].cells[1],i=c(l);(0,b.GC$)(n).append(i),t.MM=i},I.prototype.EM=function(){var t=this;t.ib=new r(t)},I.prototype._M=function(){var t=this;t.QM(),t.$M(),t.tC()},I.prototype.$w=function(){var t,e,n,i,r,o,t=this,e,n;t.options.scrollbarAppearance===C.ScrollbarAppearance.mobile&&(i=t.Ti,r=t.kw,o=t.Dw,(0,b.GC$)(r).bind(a,function(){t.Xb.qy(C.ScrollbarState.active)}).bind(s,function(){t.Xb.qy(C.ScrollbarState.inactive)}),(0,b.GC$)(o).bind(a,function(){t.zb.qy(C.ScrollbarState.active),t.Xw.qy(C.ScrollbarState.active)}).bind(s,function(){t.zb.qy(C.ScrollbarState.inactive),t.Xw.qy(C.ScrollbarState.inactive)}),(0,b.GC$)(i).bind(a,t.oC).bind(s,t.aC))},I.prototype.tM=function(){var t,e,n,t=this,e=t.kw,n=t.Dw;e&&((0,b.GC$)(e).unbind(a).unbind(s),t.ib._w(!0)),n&&((0,b.GC$)(n).unbind(a).unbind(s),t.ib._w(!1)),(0,b.GC$)(t.Ti).unbind(a,t.oC).bind(s,t.aC)},I.prototype.oC=function(){(0,b.GC$)(this).find("."+S).addClass(yt)},I.prototype.aC=function(){(0,b.GC$)(this).find("."+S).removeClass(yt)},I.prototype.jM=function(){var t=this;t.eM(),t.qw(),t.ZVe&&(t.fAn(),t.PC())},I.prototype.uC=function(){var t,e,n,i,r,o,a,a,t=this,e=t.w2,n=t.options.tabStripPosition,i=t.options.tabStripVisible,r=0,o=0,a=(0,F.jf)(t);return a&&a.options.rightToLeft&&t.options.showVerticalScrollbar&&(r=t.NC()),e&&i&&(a=e.ot(),n===C.TabStripPosition.top?o=a.height:n===C.TabStripPosition.left&&(r+=a.width)),{left:r,top:o}},I.prototype.$Ve=function(){var t,e,n,i,t,i,t=this,e=t.w2,n=t.options.tabStripPosition,i=t.options.tabStripVisible,t=(0,b.GC$)(t.Ti).width();return e&&i&&(i=e.ot(),n!==C.TabStripPosition.left&&n!==C.TabStripPosition.right||(t-=i.width)),t},I.prototype.sC=function(){var t,e,n,t,t=this,e=t.j2(),n=t.uC(),t=t.$Ve();(0,b.GC$)(e).css({width:t,left:n.left,top:n.top})},I.prototype.qw=function(){var t,e,n,i,r,o,t,r,t,o,a,i,e=this,n=e.Ti;e.ib&&(i=e.options.scrollbarAppearance===C.ScrollbarAppearance.mobile,r=e.JM,o=e.nM,t=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft,e.qM=t?r.rows[0].cells[0]:r.rows[0].cells[1],e.WM=t?o.rows[1].cells[0]:o.rows[1].cells[1],r=e.WM,t=e.qM,o=e.kw,a=e.Dw,(0,b.GC$)(o).removeAttr("style"),(0,b.GC$)(a).removeAttr("style"),(0,b.GC$)(a).addClass("gc-clear-float"),i?(i=e.j2(),o.style.position="absolute",o.style.top="0px",o.style.left="0px",(0,b.GC$)(o).addClass(S+" "+Ct),(0,b.GC$)(i).append(o),a.style.position="absolute",a.style.top="0px",a.style.left="0px",(0,b.GC$)(a).addClass(S+" "+bt),(0,b.GC$)(i).append(a)):((0,b.GC$)(r).append(o),(0,b.GC$)(t).append(a),(0,b.GC$)(o).removeClass(S+" "+M+" "+Ct+" "+Mt),(0,b.GC$)(a).removeClass(S+" "+M+" "+bt+" "+Mt),(0,b.GC$)(n).css("position","auto")))},I.prototype.fAn=function(){var t,e,n,i,t,e=this,n=e.nM;n&&(t=(i=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft)?n.rows[1].cells[1]:n.rows[1].cells[0],(0,b.GC$)(t).append(e._vp))},I.prototype.eM=function(){var t,e,n,i,r,o,a,s,u,t,c,o,e=this,n=e.nM,i=e.zM,r=e.VM,o=e.JM;o&&(a=e.XM,s=e.options.tabStripPosition,u=e.options.tabStripVisible,t=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft,s===C.TabStripPosition.bottom?c=t?o.rows[0].cells[1]:o.rows[0].cells[0]:s===C.TabStripPosition.top?c=t?n.rows[0].cells[1]:n.rows[0].cells[0]:s===C.TabStripPosition.left?c=i:s===C.TabStripPosition.right&&(c=r),s!==C.TabStripPosition.bottom&&s!==C.TabStripPosition.top&&u?n.style.tableLayout="fixed":n.style.tableLayout="",s===C.TabStripPosition.top&&e.ZVe&&(o=t?n.rows[0].cells[0]:n.rows[0].cells[1],(0,b.GC$)(o).append(e.iC)),(0,b.GC$)(c).append(a))},I.prototype.LM=function(t){var e,n,i,r,e=this,n="tabindex",i=w((0,b.GC$)(t).attr(n),10)||0,r=c(l);(0,b.GC$)(r).css({position:mt,overflow:"hidden"}).attr(x,"gcSheetFocusElementForTab").attr(n,i).bind(ht,function(){e.fC||(0,F.jf)(e).Zg(),e.fC=!1}),t.insertBefore(r,L),e.lC=r},I.prototype.OM=function(){var t,e,t=this,e=function(){t.hC()};(0,b.GC$)(A).bind(lt+g,e),t.dC=e},I.prototype.BM=function(){var t,e,t=this,e=(0,F.jf)(t);e&&e.hg(t._vp)},I.prototype.vC=function(){var t=this,e=t.lC;e&&(t.fC=!0,e.focus())},I.prototype.mC=function(){var t,e,n,i,r,o,t=this.getActiveSheet();if(t)if(F.hi.A1(t)){if(n=this.Ti)for(i=document.activeElement,r=document.body,o=i;o;){if(o===n){e=i;break}if(o===r)break;o=o.parentElement}}else t.fg&&(e=t.fg);return e},I.prototype.n2=function(r){var o=this;o.Q1e(),o.gC=A.setTimeout(function(){var t,e,n,i,t=o.mC();t&&(e=t.getAttribute(x),_(r)||"gcWorksheetCanvas"===e||"gcSheetClipboard"===e||t.setAttribute("aria-label",r),n=(0,F.jf)(o),i=!(n&&n.rt&&n.rt.w_(n)),F.mt.Qf())&&i&&(n&&!n.isEditing()&&(t.textContent=""),o.vC(),setTimeout(function(){n=(0,F.jf)(o),(i=!(n&&n.rt&&n.rt.w_(n)))&&t.focus()},50)),A.clearTimeout(o.gC),o.gC=L},50)},I.prototype.Q1e=function(){var t=this;t.gC&&(A.clearTimeout(t.gC),t.gC=L)},I.prototype.L0=function(){var t,e,n,t,i,r,o,a,s,n,n,u,t,i,e=this,n=e.zb,t=e.Xb,i=e.Xw,o=e.sheets,a=e.options.scrollbarAppearance===C.ScrollbarAppearance.mobile;for(e.zp(),F.Bf.ih(e),F.mt.L0(),e.dC&&(0,b.GC$)(A).unbind(lt+g,e.dC),e.dC=L,e.pC&&clearTimeout(e.pC),n&&n.dispose(),t&&t.dispose(),i&&i.dispose(),e.bC(),e.iy(),F.hi.ai()===e.getActiveSheet()&&F.hi.F1(L),r=0;r<o.length;r++)o[r].L0(!0);for(o.splice(0,o.length),s=e.mp,r=0;r<s.length;r++)s[r].L0(!0);s.splice(0,s.length),e.dse.splice(0,e.dse.length),(n=e.bM)&&(n.L0(),e.bM=L),t="class",i="unselectable",(n=e.Ti)&&(u=(0,b.GC$)(n),f.removeEventListener(kt,e.cultureChangedHandler),u.html("").removeAttr(x).removeClass(Tt),u.attr(t)||u.removeAttr(t),u.attr(i)||u.removeAttr(i),u.data(T)&&u.data(T,L),k)&&k(n).data(T)&&k(n).data(T,L),a&&e.tM(),e.Dw=L,e.kw=L,e.Wp&&(e.Wp.L0(),e.Wp=L),e.sheetTabStyles&&(e.sheetTabStyles.L0(),e.sheetTabStyles=L),e.w2&&(e.w2.L0(),e.w2=L),e.Dp=L,e.docProps&&(delete e.docProps.appDocProps,delete e.docProps.coreDocProps,null!=(t=e.docProps.customDocPropsManager))&&t.clear(),I.et(e,"dispose"),e.lC&&((0,b.GC$)(e.lC).unbind(ht),e.lC=L),e.Lp&&(e.Lp.dispose(),e.Lp=L,e.yC=L,e.wC=L),e.MC&&(e.MC.L0(),e.MC=L),O.W.L0(),e.Qy&&(e.Qy.L0(),e.Qy=L),e.ib&&(e.ib.L0(),e.ib=L),e.v2&&(e.v2.dispose(),e.v2=L)},I.prototype.bC=function(){var t,e,n,i,r,o,a,s,t=this,e=t.sheets;for((0,b.GC$)(t.oM).unbind(g),n=0;n<e.length;n++)(i=e[n]).bC();for(o=0,a=r=t.mp;o<a.length;o++)(s=a[o]).bC();t.rM&&(t.rM.length=0)},I.prototype.zp=function(){var t,e,n,i,r,t=this,e=t.CC;if(e)for(n=0,i=e;n<i.length;n++)(r=i[n]).close&&r.close();t.CC=[]},I.prototype._An=function(t){var e,e;null!=(e=this.zb)&&e._An(t),null!=(e=this.Xw)&&e._An(t)},I.prototype.iM=function(){var t,e,n,t=this,e=w(F.I.fl("").zIndex),n=e!==t.SC;n&&t.TC(e),t.AC(n),t.IC(),t.xC()},I.prototype.TC=function(t){this.SC=t},I.prototype.AC=function(t){var e,n,i,n,r,e=this,n=e.Ti;n&&(i=e.SC,n=n.getAttribute("id")+"_tabStrip",e.ZVe&&e.Xg(),(r=e.w2)&&!t?(r.mg(),r.repaint()):(r&&r.L0(),r=new(2007<i?H.Gv:U.Jm)(n),(e.w2=r).Sg(e),r.hg(e.XM)))},I.prototype.IC=function(){var t,e,n,i,r,o,t,e=this,n=e.options.scrollbarAppearance===C.ScrollbarAppearance.mobile,i=e.Zv(),r=e.Xm(),o=e.NC(),t=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft;n?e.kC():(jt(e.kw,o,r,t),Ot(e.Dw,i,r))},I.prototype.xC=function(){var t=this;Vt(t.MM),Vt(t.iC)},I.prototype.hC=function(){var t=this,e=t.pC;e&&clearTimeout(e),t.pC=A.setTimeout(function(){F.Bf.rh(),t.Cg(),t.pC=L},100)},I.prototype.Cg=function(){var t=this;t.Eb||(t.Eb=!0,t.DC(),t.Eb=!1)},I.prototype.DC=function(){var t,e,t=this,e;t.Ti&&(t._C(),t.EC(),t.jC(),t.OC(),t.RC(),t.BC(),t.LC(),t.PC(),t.GC(),t.UC(),t.HC(),t.sC(),t.zC())},I.prototype._C=function(){var t,e,e,n,i,r,i,n,t,o,n,t=this,e=t.zM;e&&(e=e.style,i=(n=t.options).tabStripVisible,r=n.tabStripPosition,i=i?n.tabStripWidth:0,n=t.Ti,t=(0,b.GC$)(n).height(),n=r===C.TabStripPosition.left?(o=i,t):o=0,e.width=o+d,e.height=n+d)},I.prototype.EC=function(){var t,e,e,n,i,r,n,o,i,a,t=this,e=t.nM;e&&(e=e.style,i=(n=t.options).tabStripVisible,r=n.tabStripPosition,n=n.tabStripWidth,o=(0,b.GC$)(t.Ti).width(),i=!i||r!==C.TabStripPosition.left&&r!==C.TabStripPosition.right?o+d:(a=ot(Zt(t.Ti)))-n+d,e.width=i)},I.prototype.OC=function(){var t,e,e,n,i,r,i,n,t,o,n,t=this,e=t.VM;e&&(e=e.style,i=(n=t.options).tabStripVisible,r=n.tabStripPosition,i=i?n.tabStripWidth:0,n=t.Ti,t=(0,b.GC$)(n).height(),n=r===C.TabStripPosition.right?(o=i,t):o=0,e.width=o+d,e.height=n+d)},I.prototype.jC=function(){var t,e,n,i,i,r,n,o,a,t,s,u,c,f,l,t,c,h,e,r,t=this,e=t.Ti,n=(0,b.GC$)(e),i=t._vp;i&&(i=i.style,r=n.width(),n=n.height(),o=t.NC(),a=t.Zv(),s=(t=t.options).showVerticalScrollbar,u=t.showHorizontalScrollbar,c=t.scrollbarAppearance,f=t.tabStripVisible,l=t.tabStripPosition,t=f?t.tabStripWidth:0,c=c===C.ScrollbarAppearance.mobile,e=(h=l===C.TabStripPosition.left||l===C.TabStripPosition.right)?ot(Zt(e)):r,s&&!c&&(e-=o),h&&(e-=t),r=n,l===C.TabStripPosition.top?(u&&!c&&(r-=a),f&&(r-=a)):(u&&!c||f&&l===C.TabStripPosition.bottom)&&(r-=a),r<2&&(r=2),i.width=e+d,i.height=r+d)},I.prototype.RC=function(t){var e,n,n,i,n,i,r,o,a,s,u,c,f,l,a,c,h,d,v,g,g,m,e,n,o,e=this,n=e.Ti,n=(0,b.GC$)(n),i=e._vp;i&&(_(t)&&(t=n.width()),n=(0,b.GC$)(i).height(),i=e.zb,r=e.Xw,o=e.Xb,s=(a=e.options).showVerticalScrollbar,u=a.showHorizontalScrollbar,c=a.scrollbarAppearance,f=a.tabStripVisible,l=a.tabStripPosition,a=f?a.tabStripWidth:0,c=c===C.ScrollbarAppearance.mobile,h=e.Xm(),d=e.NC(),v=e.VC(),g=(g=(0,F.jf)(e))?g.getHDockScrollbarWidth():0,s?((0,b.GC$)(e.kw).show(),(0,b.GC$)(o.oy()).show()):((0,b.GC$)(e.kw).hide(),(0,b.GC$)(o.oy()).hide()),u?((0,b.GC$)(e.Dw).show(),(0,b.GC$)(i.oy()).show(),(0,b.GC$)(r.oy()).show()):((0,b.GC$)(e.Dw).hide(),(0,b.GC$)(i.oy()).hide(),(0,b.GC$)(r.oy()).hide()),0===g?(0,b.GC$)(r.oy()).hide():(0,b.GC$)(r.oy()).show(),e=n,o.YC(h),o.ZC(e),n=t-g,l!==C.TabStripPosition.left&&l!==C.TabStripPosition.right||(n-=a),f&&!c&&l===C.TabStripPosition.bottom&&(n-=v),s&&!c&&(n-=d),o=h,u||f||l!==C.TabStripPosition.bottom||(o=0),i.YC(n=n<=0?1:n),i.ZC(o),r.YC(g),r.ZC(o))},I.prototype.VC=function(){var t,e,n,i,r,o,i,a,t,e,t,s,u,e=this,n=e._vp,i=e.options,r=i.tabStripPosition,o=i.tabStripWidth,i=i.scrollbarAppearance,a=(0,F.jf)(e),t=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft,e=e.Jg();return t&&r===C.TabStripPosition.bottom&&(e=1-e),t=(0,b.GC$)(n).width(),r===C.TabStripPosition.bottom||r===C.TabStripPosition.top?(a&&r===C.TabStripPosition.bottom&&i===C.ScrollbarAppearance.skin&&(t-=u=a.getHDockScrollbarWidth()),s=rt(e*t),r===C.TabStripPosition.bottom&&s===t&&(s=t-1)):s=o,s},I.prototype.BC=function(){var t,e,e,n,n,i,r,i,o,t,i,t=this,e=t.Ti,e=(0,b.GC$)(e).height(),n=t.XM;n&&(n=n.style,r=(i=t.options).tabStripVisible,i=i.tabStripPosition,o=t.Zv(),t=t.VC(),i=i===C.TabStripPosition.bottom||i===C.TabStripPosition.top?o:e,r||(i=0),n.width=t+d,n.height=i+d)},I.prototype.LC=function(){var t,e,n,i,r,o,a,s,i,u,t,c,f,c,l,t=this,e=t.iC,n=t.MM,i=t.options,r=i.showVerticalScrollbar,o=i.showHorizontalScrollbar,a=i.tabStripVisible,s=i.tabStripPosition,i=i.scrollbarAppearance===C.ScrollbarAppearance.mobile,u=t.NC(),t=t.Zv(),f=s===C.TabStripPosition.top?(c=r&&!i?u:0,a?t:0):c=0;(0,b.GC$)(e).css("width",c+d),(0,b.GC$)(e).css("height",f+d),c=r&&!i?u:0,(o||a&&s===C.TabStripPosition.bottom)&&(l=t,!i||a&&s===C.TabStripPosition.bottom)||(l=0),(0,b.GC$)(n).css("width",c+d),(0,b.GC$)(n).css("height",l+d)},I.prototype.PC=function(){var t,e,n,i,n,r,i,n,o,a,s,t=this;t._vp&&(e=t.nM,i=(n=t.options).scrollbarAppearance===C.ScrollbarAppearance.mobile,n=n.showVerticalScrollbar,r=[(0,b.GC$)(t._vp).width(),t.NC()],!i&&n||(r[1]=0),(n=null==(i=(0,F.jf)(t))?void 0:i.options.rightToLeft)&&r.reverse(),e.rows[0].cells[0].style.width=r[0]+d,e.rows[0].cells[1].style.width=r[1]+d,o=i&&i instanceof v.Worksheet)&&((a=n?e.rows[2].cells[1]:e.rows[2].cells[0]).appendChild(t.JM),(s=n?e.rows[2].cells[0]:e.rows[2].cells[1]).appendChild(t.MM))},I.prototype.UC=function(){var t,e,n,t=this,e,n=t.options.scrollbarAppearance===C.ScrollbarAppearance.mobile;n&&t.kC(),t.WC(),t.QC(),n&&(t.Xb.qy(C.ScrollbarState.hide),t.zb.qy(C.ScrollbarState.hide))},I.prototype.HC=function(){var t,e,n,t=this,e,n;t.options.tabStripVisible?(0,b.GC$)(t.XM).show():(0,b.GC$)(t.XM).hide(),t.w2&&t.w2.Cg()},I.prototype.GC=function(t){var e,n,t;void 0===t&&(t=!0),(n=(0,F.jf)(e=this))?(0===n.Tb&&(n.Tb=n.pw()),0===n.Ab&&(n.Ab=n.Sw()),t&&n.Cg()):(t=e.getActiveSheetTab())&&t.Cg()},I.prototype.zC=function(){var t,e,n,t=this,e=(0,F.jf)(t);e&&(e.invalidateLayout(),e.repaint()),(n=t.KC())&&!t.JC&&(t.JC=!0,setTimeout(function(){delete t.JC,t.DC()},1))},I.prototype.KC=function(){var t,e,n,i,e,n,r,o,a,s,o,a,s,s,o,a,e,u,c,t=this,e=(0,b.GC$)(t.Ti),n=e.width(),i=2,e=e.width(),n=n!==e&&2<j(n-e),r=!1,o=t.zM,a=t.VM,s=t.nM;return o&&a&&s&&(o=(0,b.GC$)(o).width(),a=(0,b.GC$)(a).width(),s=(0,b.GC$)(s).width(),r=2<j(o+s+a-e)),o=t.Xw,a=(s=!1,F.jf)(t),o&&a&&(e=a.getDockScrollbarAttachedIndex(),_(e)||(u=o.YC())!==(c=a.getHDockScrollbarWidth())&&(s=!0)),n||r||s},I.prototype.kC=function(){var t,e,n,i,r,o,a,e,s,u,c,f,l,u,c,n,h,o,f,e,c,o,d,v,g,a,l,u,h,m,p,S,t=this;!_(t.Ti)&&(e=(0,b.GC$)(t.Ti),n=(0,F.jf)(t))&&(i=(0,b.GC$)(t.kw),r=(0,b.GC$)(t.Dw),o=n.Fi(),a=e.width(),e=e.height(),s=2,c=(u=t.options).tabStripVisible,f=u.showVerticalScrollbar,l=u.tabStripPosition,u=c?u.tabStripWidth:0,c=c?t.Zv():0,n=n.getHDockScrollbarWidth(),h=o.x+o.XC,o=o.y+o.qC,f=f?i.width():0,e=e-o,l!==C.TabStripPosition.bottom&&l!==C.TabStripPosition.top||(e-=c),c=0,l!==C.TabStripPosition.right&&l!==C.TabStripPosition.left||(c+=u),o=o,g=e-(d=w(i.css("padding-top")))-(v=w(i.css("padding-bottom"))),a=a-h,0===n&&(a-=f),l!==C.TabStripPosition.left&&l!==C.TabStripPosition.right||(a-=u),l=r.height(),u=-(e+o),h=h,S=a-(m=w(r.css("padding-left")))-(p=w(r.css("padding-right")))-n,0===n?S-=2:n-=f+p+2,t.Xb.YC(f),t.Xb.ZC(g),t.zb.YC(S),t.zb.ZC(l),t.Xw.YC(n),t.Xw.ZC(l),i.css(["height","left","right","top"],[e,"auto",c,o]),r.css(["width","top","bottom","left"],[a,"auto",u,h]))},I.prototype.WC=function(){var t=this,e=t.jg(),n=t.options;e?(e.WC(n.scrollbarMaxAlign,n.scrollbarShowMax,t.zb),e.$C(t.Xw)):t.zb&&t.zb.w4()},I.prototype.QC=function(){var t=this,e=t.jg(),n=t.options;e&&e.QC(n.scrollbarMaxAlign,n.scrollbarShowMax,t.Xb)},I.prototype.Xg=function(){var t,e,n,t=this,e;t.Ti&&(n=t.t3(),t.BC(),t.RC(n),t.GC(!1),t.UC(),t.HC())},I.prototype.t3=function(){var t,e,n,i,t=this.Ti,e=t.parentNode;return n=e&&"flex"===(i=e.style.display||getComputedStyle(e).display)?(0,b.GC$)(t).width():n},I.prototype.suspendPaint=function(){var t,e,n,i,r,o,a,s,u,c,t=this,e=t.w2,n=t.sheets,i=t.mp;for(t.sg++,r=0,o=n;r<o.length;r++)(a=o[r]).suspendPaint();for(s=0,u=i;s<u.length;s++)(c=u[s]).suspendPaint();e&&e.V2()},I.prototype.resumePaint=function(){var t,e,n,i,r,o,a,s,u,c,t=this,e=t.w2,n=t.sheets,i=t.mp;for(t.sg-=0<t.sg?1:0,r=0,o=n;r<o.length;r++)(a=o[r]).resumePaint();for(s=0,u=i;s<u.length;s++)(c=u[s]).resumePaint();e&&e.Y2()},I.prototype.UCe=function(){var t=this,e=t.getActiveSheet();try{e&&(e.My--,e.n3(),e.repaint(),e.My++),t.w2&&(t.w2.sg--,t.w2.repaint(),t.w2.sg++)}catch(t){}},I.prototype.isPaintSuspended=function(){return 0<this.sg},I.prototype.nb=function(){var t,e,n,i,r,o,a,s,u,c,t=this,e=t.options.backgroundImage,n=t.options.backgroundImageLayout,i=(0,F.jf)(t);if(i&&e&&((r=(o=void 0,b.GC$)(i.Dg())).css({"background-image":"url('"+e+"')","background-repeat":"no-repeat"}),!_(n))){o=(o=t.MC)||(t.MC=new N.Wh(function(){t.MC&&t.nb()}));try{o.getState(e)?(a=o.getImage(e),u=(s=i.ot()).width,c=s.height,F.mt.Wf(i.Dg(),u,c,a.width,a.height,n)):o.addImage(e)}catch(t){}}},I.prototype.e3=function(t){var e,t,t,e=this,t=t.name(),t=e.getSheetPosition(t);e.w2.g2(t)},I.prototype.startSheetIndex=function(t){var e=this,n=e.w2;return 0===arguments.length?n?n.om:0:(n&&(n.k2(t)||-1===(t=n.N2(t))&&(t=n.Vm(t)),n.om=t),e.Xg(),e)},I.prototype.Jg=function(){var t,e,n,i,t,i,n,t,r,o,e,o,e=this,n=e.options,i=e.options.scrollbarAppearance===C.ScrollbarAppearance.mobile,t=n.tabStripPosition;return n.showHorizontalScrollbar&&!i&&t===C.TabStripPosition.bottom?(i=n.tabStripRatio,isNaN(i)?.5:(n=null==(t=(0,F.jf)(e))?void 0:t.options.rightToLeft,t=0,r=1,o=e._vp,e=e.w2,o&&e&&(o=(0,b.GC$)(o).width(),t=n?0:e.rm()/o,r=n?1-e.rm()/o:1),i<t?i=t:r<i&&(i=r),i)):1},I.prototype.destroy=function(){this.dC&&(0,b.GC$)(A).unbind(lt+g,this.dC),this.L0()},I.prototype.repaint=function(){var t,e,e,t=this,e=t.w2;e&&e.repaint(),(e=(0,F.jf)(t))&&e.repaint()},I.prototype.refresh=function(){var t=this;t.Ti&&(F.I.dl(),t.r3(),t.iM(),t.Cg(),t.repaint())},I.prototype.getHost=function(){return this.Ti},I.prototype.invalidateLayout=function(){var t=(0,F.jf)(this);t&&t.invalidateLayout()},I.prototype.addNamedStyle=function(t){this.$p(t);var t=(0,F.jf)(this);t&&t.zw()},I.prototype.$p=function(t){if(t){if(!t.name)throw new Error(G().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Hp[e]=t,this.r3()}},I.prototype.getNamedStyle=function(t){return this.i3(t,!0)},I.prototype.i3=function(t,e){var n,n,n=this.Hp;return n&&t?((n=n[t=t.toUpperCase()])&&e&&this.r3(),n):L},I.prototype.r3=function(){for(var t,e,n,i,t,e=0,n=this.sheets;e<n.length;e++)(i=n[e]).r3()},I.prototype.removeNamedStyle=function(t){var e,n,n,e=this.Hp;e&&t&&(t=t.toUpperCase(),e.hasOwnProperty(t))&&((n=e[t].formatter)&&"string"==typeof n&&this.bp[n]&&this.o3(n),delete e[t],this.r3(),n=(0,F.jf)(this))&&n.zw()},I.prototype.getNamedStyles=function(){var n=[],t=this.Hp;return t&&q(t,function(t,e){n.push(e)}),n},I.prototype.getActiveSheet=function(){return this.sheets&&0<this.sheets.length?this.sheets[this._2]:L},I.prototype.getActiveSheetTab=function(){return this.mp&&0<this.mp.length?this.mp[this.jb]:L},I.prototype.setActiveSheet=function(t){var e,n,e=this.getActiveSheet(),n=this.getActiveSheetTab();this.vb(t,2),this.a3(e),this.u3(n)},I.prototype.setActiveSheetTab=function(t){var e,n,e=this.getActiveSheet(),n=this.getActiveSheetTab();"number"==typeof t?this.yp(t,2):"string"==typeof t&&this.s3(t,2),this.a3(e),this.u3(n)},I.prototype.vb=function(t,e,n,i){for(var r,o,r=this.sheets,o=0;o<r.length;o++)if(r[o].name()===t){this.tb(o,e,n,i);break}},I.prototype.s3=function(t,e,n,i){for(var r,o,r=this.mp,o=0;o<r.length;o++)if(r[o].name()===t){this.yp(o,e,n,i);break}},I.prototype.getActiveSheetIndex=function(){return this._2},I.prototype.getActiveSheetTabIndex=function(){return this.jb},I.prototype.setActiveSheetIndex=function(t){var e,n,n,i,e=this,n=e.getSheetCount();(t=n<=t?n-1:t)<0&&(t=0),n=e.getActiveSheet(),i=e.getActiveSheetTab(),e.tb(t,2),e.a3(n),e.u3(i)},I.prototype.tb=function(t,e,n,i,r){var o,a,r,s,s,u,c,c,f,c,i;typeof t==at&&t!==(o=this)._2&&((a=o.sheets[t])&&a.visible()===C.SheetTabVisible.visible||r)&&!(((r=F.mt.pi()).ipad||r.iphone)&&(s=o.c3)&&(new Date).valueOf()-s<300)&&(u=(u=s=o.getActiveSheet())||(c=o.getActiveSheetTab())&&c.Mf,Lt(o,c={oldSheet:u,newSheet:a,needTriggerSheetChange:!0}),f={oldSheet:u,newSheet:a,cancel:!1},(c=c.needTriggerSheetChange&&i)&&At(o,f),!1===f.cancel&&(i=B(o),o._2=t,o.f3(),a!==s&&(s&&(s.L0(!1),s.charts)&&s.charts.all().forEach(function(t){t.clearflexDVs()}),a)&&(o.ZVe=B(o)!==i,o.l3(a,e,!1,c,n)),o.Cg(),Dt(o,u,a),c)&&_t(o,u,a),r.ipad||r.iphone)&&(o.c3=(new Date).valueOf())},I.prototype.yp=function(t,e,n,i){var r,o,a,s,u,u,c,f,l,f,i;typeof t==at&&t!==(r=this).jb&&(o=r.mp[t])&&o.visible()===C.SheetTabVisible.visible&&(a=o.Mf,((s=F.mt.pi()).ipad||s.iphone)&&(u=r.c3)&&(new Date).valueOf()-u<300||(c=(u=r.getActiveSheetTab())?u.Mf:r.getActiveSheet(),Lt(r,f={oldSheet:c,newSheet:a,needTriggerSheetChange:!0}),l={oldSheet:c,newSheet:a,cancel:!1},(f=f.needTriggerSheetChange&&i)&&At(r,l),!1===l.cancel&&(i=B(r),r.f3(),r.jb=t,r.h3(),o!==u&&(u&&u.L0(!1),r.ZVe=B(r)!==i,r.d3(o,e,!1,f,n),o.b2(!0)),r.Cg(),Dt(r,c,a),f)&&_t(r,c,a),(s.ipad||s.iphone)&&(r.c3=(new Date).valueOf())))},I.prototype.l3=function(t,e,n,i,r){var n,n,n;n||t.hg(this._vp),n=(n=F.hi.ai())&&n.parent===this,n=2===e?n:1===e,F.hi.F1(L),!this.Bp&&n&&t.Zg(r),t.aw(),t.tw()},I.prototype.d3=function(t,e,n,i,r){var n,n,n;n||t.hg(this._vp),n=(n=F.hi.ai())&&n.parent===this,n=2===e?n:1===e,F.hi.F1(L),!this.Bp&&n&&t.Zg(r),t.aw(),t.tw()},I.prototype.a3=function(t){var e=this.getActiveSheet();t&&t.b2(!1,!1),e&&e.b2(!0,!1)},I.prototype.u3=function(t){var e=this.getActiveSheetTab();t&&t.b2(!1,!1),e&&e.b2(!0,!1)},I.prototype.addSheet=function(t,e){var n,i,n=this.getActiveSheet(),i=this.getActiveSheetTab();this.A2(t,2,e),this.a3(n),this.u3(i)},I.prototype.addSheetTab=function(t,e,n){var i,r,e,i=this.getActiveSheet(),r=this.getActiveSheetTab(),e=this.bb(e,n);if(e)return this.suspendPaint(),this.yb(t,2,e),this.a3(i),this.u3(r),this.resumePaint(),e},I.prototype.J2e=function(t,e){var n,i,n=this.getActiveSheet(),i=this.getActiveSheetTab();if(e)return this.suspendPaint(),this.yb(t,2,e),this.a3(n),this.u3(i),this.resumePaint(),e},I.prototype.gse=function(t,e,n){for(var i,r,o,i=t.length,r=[],o=0;o<n&&0<i;o++)r.push(t.pop());for(t.push(e);0<r.length;)t.push(r.pop())},I.prototype.pse=function(t,e,n){for(var i,r,o,a,s,u,i=t.length,r=[],o=0,a=e instanceof v.Worksheet;o<n&&0<i;)s=t[t.length-1]instanceof v.Worksheet,(a&&s||!a&&!s)&&o++,r.push(t.pop());for(t.push(e),e.E0i=t.length-1;0<r.length;)u=r.pop(),t.push(u),u.E0i=t.length-1},I.prototype.bse=function(t,e){for(var n,i,r,n=0;n<t.length;n++)if(t[n].name()===e){for(i=n;i<t.length-1;i++)(r=t[i+1]).E0i--,t[i]=r;t.length=t.length-1;break}},I.prototype.A2=function(t,e,n,i){var r,o,i,a,s,u,c,t,i,r=this;if(n=n||r.S2(r.T2(t),i),a=(i=r.sheets).length,n.name()){for(s=r.qv(),o=0;o<s.length;o++)if(s[o].name()===n.name())throw G().Exp_NotSupported}else n.ub(r.T2(t));r.v3(n),u=r.getActiveSheet(),c=r._2,r.gse(i,n,a-t),n.pM(r),r.pse(r.dse,n,a-t),r.f3(),t=B(r),1===(a=i.length)?(r._vp&&n.hg(r._vp),r._2=0):(c<0&&r.w2&&(c=r.w2.N2(c)),r._2=c),(i=r.getActiveSheet())!==u&&(u&&u.L0(!1),i&&(r.ZVe=B(r)!==t,r.l3(i,e,1===a,!0)),r.Cg()),r.w2&&(r.w2.om<0&&(r.w2.om=r._2),r.w2.repaint())},I.prototype.yb=function(t,e,n){var i,r,o,a,s,u,c,f,o;if(n){for(a=(o=(i=this).mp).length,s=i.qv(),r=0;r<s.length;r++)if(s[r].name()===n.name())throw G().Exp_NotSupported;i.v3(n),u=i.getActiveSheetTab(),c=i.jb,i.gse(o,n,a-t),i.pse(i.dse,n,a-t),n.pM(i),f=B(i),1===(a=o.length)?(i._vp&&n.hg(i._vp),i.jb=0):(c<0&&i.w2&&(c=i.w2.N2(c)),i.jb=t<=c?c+1:c),i.h3(),(o=i.getActiveSheetTab())!==u&&(u&&u.L0(!1),o&&(i.ZVe=B(i)!==f,i.d3(o,e,1===a,!0)),i.Cg()),i.w2&&(i.w2.om<0&&(i.w2.om=i.jb),i.w2.repaint())}},I.prototype.removeSheet=function(t){var e,t,e=this.getActiveSheet();this.m3(t,2),(t=this.getActiveSheet())&&t!==e&&t.b2(!0,!1)},I.prototype.removeSheetTab=function(t){var e,t;"string"==typeof t&&(t=this.getSheetTabIndex(t)),e=this.getActiveSheetTab(),this.g3(t,2),(t=this.getActiveSheet())&&t!==e&&t.b2(!0,!1)},I.prototype.m3=function(t,e){var n,i,r,o,a,s,u,c,n,f,l,h,n,c,d,v,g,m,p,S,w,u,e,f,t,i=this,r=i.sheets,o=i.Lp,a=i.w2,s=r.length;if(isNaN(t)||t<0||s<=t)throw new Error(G().Exp_IndexOutOfRange);if(u=B(i),c=i._2,n=t<=i._2||t===s-1,f=i.getActiveSheet(),t<i._2&&i._2--,(l=r[t]).bC(),r.splice(t,1),i.bse(i.dse,l.name()),0===(s=r.length))i._2=-1;else if(i._2>=s&&a)i._2=a.Vm(s);else{for(h=void 0,h=Math.max(0,i._2);h<s;h++)if(r[h].visible()===C.SheetTabVisible.visible){i._2=h;break}s<=h&&a&&(i._2=a.Vm(s))}if(i.f3(),(n||c!==i._2)&&f!==(n=r[i._2])&&(f&&f.L0(!1),n)&&(Lt(i,f),i.ZVe=B(i)!==u,i.l3(n,e,!1,!0),Dt(i,f,n)),o){if(o.suspend(),l.b3().p3(),d=(c=qt(l)).map(function(t){return t.id}),v={},g=o.y3)for(p in m=l.b3().getSource().id,g)if(g.hasOwnProperty(p))for(v[p]=[],S=g[p];S;)m!==(w=S.w3&&S.w3.getSource().id)&&-1===d.indexOf(w)&&v[p].push(S),S=S.C3;for(p in(u=l.Uw()).S3=t,o.removeSource(u),e=l.T3,o.removeSource(e),f=l.A3,o.removeSource(f),c.forEach(function(t){o.removeSource(t)}),v)if(v.hasOwnProperty(p))for(S=v[p],h=0;h<S.length;h++)o.I3(S[h],parseInt(p,10));o.resume(!1)}null!=(n=i.sheetTabStyles)&&n.O2e[l.name()]&&i.sheetTabStyles.L2e(l.name()),l.L0(!0,-1!==i._2),y&&!o.x3&&i.sheets&&0<i.sheets.length&&(t=i.sheets[0],o.initParserContext(t.Uw())),a&&(a.om>=s?i.startSheetIndex(a.Vm(s)):a.om<0?i.startSheetIndex(a.N2(-1)):i.Cg())},I.prototype.g3=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,c,u,f,n=this,i=n.mp,r=n.Lp,o=n.w2,a=i.length;if(isNaN(t)||t<0||a<=t)throw new Error(G().Exp_IndexOutOfRange);if(s=B(n),u=n.jb,c=t<=n.jb||t===a-1,f=n.getActiveSheetTab(),t<n.jb&&n.jb--,(l=i[t]).bC(),i.splice(t,1),n.bse(n.dse,l.name()),0===(a=i.length))n.jb=-1;else if(n.jb>=a)n.jb=o.Vm(a);else{for(h=void 0,h=Math.max(0,n.jb);h<a;h++)if(i[h].visible()===C.SheetTabVisible.visible){n.jb=h;break}a<=h&&(n.jb=o.Vm(a))}n.h3(),(c||u!==n.jb)&&f!==(c=i[n.jb])&&(f&&f.L0(!1),c)&&(n.ZVe=B(n)!==s,n.d3(c,e,!1,!0)),r&&(r.suspend(),(f=(u=l.Mf).Uw())&&(f.S3=t),[f,u.T3,u.A3,u.Dnn].forEach(function(t){t&&r.removeSource(t)}),r.resume(!1)),n.sheetTabStyles&&n.sheetTabStyles[l.name()]&&n.sheetTabStyles.L2e(l.name()),l.L0(!0,-1!==n.jb),o&&(o.om>=a?n.startSheetIndex(o.Vm(a)):o.om<0?n.startSheetIndex(o.N2(-1)):n.Cg())},I.prototype.clearSheets=function(){for(var t,e,n,i,r,o,a,t=this,e=t.sheets,n=t.Lp,i=t.w2,r=0,o=e;r<o.length;r++)(a=o[r]).bC(),a.L0(!0);e.splice(0,e.length),t.dse=t.yse(t.mp),n&&n.clearSource(),t._2=-1,i&&(i.om=-1,i.repaint())},I.prototype.clearSheetTabs=function(){for(var t,e,n,i,r,o,t=this,e=t.mp,n=t.w2,i=0,r=e;i<r.length;i++)(o=r[i]).bC(),o.L0(!0);e.splice(0,e.length),t.dse=t.yse(t.sheets),t.jb=-1,n&&(n.om=-1,n.repaint())},I.prototype.getSheet=function(t){var e=this.sheets;return 0<=t&&t<e.length?e[t]:L},I.prototype.getSheetTab=function(t){return this.Ofe(t)},I.prototype.Ofe=function(t){var e,n,i,r,e=this.mp;if("number"==typeof t)return 0<=t&&t<e.length?e[t]:L;if("string"==typeof t)for(n=0,i=e;n<i.length;n++)if((r=i[n]).name()===t)return r;return L},I.prototype.getSheetFromName=function(t){return this._f(t)},I.prototype._f=function(t){for(var e,n,i,r,e,n=0,i=this.sheets;n<i.length;n++)if((r=i[n]).name()===t)return r;return L},I.prototype.getSheetIndex=function(t){for(var e,n,e=this.sheets,n=0;n<e.length;n++)if(e[n].name()===t)return n;return L},I.prototype.getSheetTabIndex=function(t){for(var e,n,e=this.mp,n=0;n<e.length;n++)if(e[n].name()===t)return n;return L},I.prototype.getSheetPosition=function(t){for(var e,n,e=this.dse,n=0;n<e.length;n++)if(e[n].name()===t)return n;return-1},I.prototype.getSheetCount=function(){return this.sheets.length},I.prototype.getSheetTabCount=function(){return this.mp.length},I.prototype.setSheetCount=function(t){var e,n,i,e=this,n=e.getActiveSheet(),i=e.getActiveSheetTab();e.Xp(t,2),e.a3(n),e.u3(i)},I.prototype.Xp=function(t,e){var n,i,r,o,a,s,u,n=this,i="object"==typeof t,r=i?Object.keys(t).length:t,o=i?Object.keys(t):null;if(r<0)throw G().Exp_ArgumentOutOfRange;if(0===r&&n.clearSheets(),r<(a=n.sheets.length))for(s=a-1;r<=s;s--)n.m3(s,e);else if(a<r)for(s=a;s<r;s++)u=i?t[o[s]].type:L,n.A2(s,e,null,u)},I.prototype.hp=function(t,e){var n,i,r,o,t,a,s,u,c,f,l,h,d,v,g,m,n=this,i=t.sheetTabCount;if(nt(i)){if(i<0)throw G().Exp_ArgumentOutOfRange;if(0===i)n.clearSheetTabs();else{for(r=t.sheetTabs,o=t.sheetCount,t=n.mp.length,a=[],s=0,u=Object.keys(r);s<u.length;s++)(f=r[c=u[s]])&&(l=f.index-o,a.splice(l,0,f));if(i<t)for(h=t-1;i<=h;h--)n.g3(h,e);for(h=0;h<a.length;h++)d=n.mp[h],v="number"==typeof(f=a[h]).sheetType?f.sheetType:C.SheetType.tableSheet,g=o+h,d?(m=d._gi)!==v&&(n.g3(g,e),d=n.bb(L,v),n.yb(g,e,d)):(d=n.bb(L,v),n.yb(g,e,d))}}},I.prototype.bb=function(t,e){var n={name:t,type:e,sheetTab:L};return I.et(this,"createSheetTab",n,function(){return n.sheetTab!==L}),n.sheetTab},I.prototype.dataManager=function(){var t=this,e=t.N3;return e=!e&&z.DataManager?t.N3=new z.DataManager(L,t.Lp):e},I.prototype.setDataManager=function(t){this.N3=t},I.prototype.bind=function(t,e,n){var i,r,o,a,s,u,c,f,l,i=this,r=i.sheets;for(i.rM&&i.rM.push({type:t,data:e,fn:n}),(0,b.GC$)(i.oM).bind(t+g,e,n),o=0,a=r;o<a.length;o++)(s=a[o]).bind(t,e,n);for(c=0,f=u=i.mp;c<f.length;c++)(l=f[c]).bind(t,e,n)},I.prototype.unbind=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,n=this,i=n.sheets,r=n.rM;if(r)for(o=r.length-1;0<=o;o--)(a=r[o]).type!==t&&!n.k3(a.type,t)||r.splice(o,1);for((0,b.GC$)(n.oM).unbind(t+g,e),s=0,u=i;s<u.length;s++)(c=u[s]).unbind(t,e);for(l=0,h=f=n.mp;l<h.length;l++)(d=h[l]).unbind(t,e)},I.prototype.k3=function(t,e){return 0===e.indexOf(".")&&t.substring(t.length-e.length)===e},I.prototype.unbindAll=function(){var t,e,n,i,r,o,a,s,u,t=this,e=t.sheets;for((t.rM.length=0,b.GC$)(t.oM).unbind(g),n=0,i=e;n<i.length;n++)(r=i[n]).unbindAll();for(a=0,s=o=t.mp;a<s.length;a++)(u=s[a]).unbindAll()},I.prototype.D3=function(t,e,n){var i,r,o,a,s,u,c,f,l,i=this,r=i.sheets;for(i.rM.push({type:t,data:e,fn:n}),(0,b.GC$)(i.oM).bind(t+dt,e,n),o=0,a=r;o<a.length;o++)(s=a[o]).D3(t,e,n);for(c=0,f=u=i.mp;c<f.length;c++)(l=f[c]).D3(t,e,n)},I.prototype._3=function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,d,n=this,i=n.sheets,r=n.rM,o=0;o<r.length;o++)(a=r[o]).type!==t&&!n.k3(a.type,t)||r.splice(o,1);for((0,b.GC$)(n.oM).unbind(t+dt,e),s=0,u=i;s<u.length;s++)(c=u[s])._3(t,e);for(l=0,h=f=n.mp;l<h.length;l++)(d=h[l])._3(t,e)},I.prototype.E3=function(){var t,e,n,i,r,o,a,s,u,t=this,e=t.sheets;for((t.rM.length=0,b.GC$)(t.oM).unbind(dt),n=0,i=e;n<i.length;n++)(r=i[n]).E3();for(a=0,s=o=t.mp;a<s.length;a++)(u=s[a]).E3()},I.prototype.ki=function(t,e){0===this.vf&&(0,b.GC$)(this.oM).trigger(t,e)},I.prototype.pb=function(t,e){(0,b.GC$)(this.oM).trigger(t,e)},I.prototype.j3=function(t,e,n,i){this.ki(F.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:e,col:n,sheetArea:i})},I.prototype.v3=function(t){for(var e,n,i,r,e,n=0,i=this.rM;n<i.length;n++)r=i[n],t.bind(r.type,r.data,r.fn)},I.prototype.suspendEvent=function(){var t,e,n,i,r,o,a,s,u,t=this,e=t.sheets;for(t.vf++,n=0,i=e;n<i.length;n++)(r=i[n]).suspendEvent();for(a=0,s=o=t.mp;a<s.length;a++)(u=s[a]).suspendEvent()},I.prototype.resumeEvent=function(){var t,e,n,i,r,o,a,s,u,t=this,e=t.sheets;for(t.vf--,t.vf<0&&(t.vf=0),n=0,i=e;n<i.length;n++)(r=i[n]).resumeEvent();for(a=0,s=o=t.mp;a<s.length;a++)(u=s[a]).resumeEvent()},I.prototype.focus=function(t){var t,t;!1===t?F.hi.F1(L):(t=this.getActiveSheet())?t.Zg():(t=this.getActiveSheetTab())&&t.Zg()},I.prototype.Xm=function(){return 2007<this.SC?15:18},I.prototype.NC=function(){return 2007<this.SC?22:this.Xm()},I.prototype.ZM=function(t){var e,n,i,r,o,a,e=this,n=t?e.kw:e.Dw,i=t?e.Xb:e.zb,r=e.options.scrollbarAppearance===C.ScrollbarAppearance.mobile;if(n&&i&&r)switch(o=e.ib,a=i.O3){case C.ScrollbarState.hide:o.$y(t);break;case C.ScrollbarState.show:o.Iw(n),o._w(t);break;case C.ScrollbarState.active:o.Iw(n),o._w(t),o.xw(n);break;case C.ScrollbarState.inactive:o.Nw(n),o.$y(t)}},I.prototype.Zv=function(){return 2007<this.SC?28:this.Xm()},I.prototype.Tw=function(t,e,n,i,r){var o,a,s,u,o="auto",a=this;a.R3||(s=(0,b.getHostMaxZIndex)(a.Ti)+1,u=c(l),r?(0,b.GC$)(u).addClass(r):(0,b.GC$)(u).addClass("gc-spread-toolTip"),(0,b.GC$)(u).addClass("ui-state-default ui-widget-content btn-default").css({position:mt,padding:"0px 3px 0px 3px",font:et("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":s,top:0}).width(o).height(o).appendTo(f.body),a.R3=u),a.ny(t,e,n,i)},I.prototype.ny=function(t,e,n,i){var r,o,r,r,t,i,o,i,r=this,o=r.jg();o&&(r=r.R3)&&(r=(0,b.GC$)(r),t?(r.html(t),r.show()):r.hide(),t=o.uw(),i&&(n-=t.top,e-=t.left),o=(i=o.ot()).x+i.width-r.outerWidth(),i=i.y+i.height-r.outerHeight(),o<0?e=0:i<0?n=0:(n=D(n,i),e=D(e,o)),_(n)||r.css("top",n+t.top),_(e)||r.css("left",e+t.left))},I.prototype.iy=function(){var t=this,e=t.R3;e&&((0,b.GC$)(e).remove(),t.R3=L)},I.prototype.FM=function(){var t,e,n,i,r,t=this,e=t.qv();for(F.Be.zl(),t.invalidateLayout(),n=0,i=e.length;n<i;n++)(r=e[n]).FM();G(),o.Common.B3(),K&&Y.sR(),t.repaint(),I.et(t,"onCultureChanged")},I.prototype.getTab=function(){return this.w2},I.prototype.changeSheetIndex=function(t,e){var n,i,r,o,o,t,n=this,i=n.getSheetPosition(t),r=n.getTab(),o=n.getSheetCount()+n.getSheetTabCount();return!("number"!=typeof e||-1===i||i===e||e<0||o<=e||e%1!=0||n.L3(t)||((o=n.jg().name())!==t?(n.suspendPaint(),n.setActiveSheetOrSheetTabIndex(i,2),n.o2(i,e),t=n.getSheetPosition(o),n.setActiveSheetOrSheetTabIndex(t,2),n.resumePaint()):(n.o2(i,e),r.scrollTabToActive(i,e)),0))},I.prototype.changeSheetPosition=function(t,e){var n,i,r,o,o,t,n=this,i=n.getSheetPosition(t),r=n.getTab(),o=n.getSheetCount()+n.getSheetTabCount();return!("number"!=typeof e||-1===i||i===e||e<0||o<=e||e%1!=0||n.L3(t)||((o=n.jg().name())!==t?(n.suspendPaint(),n.setActiveSheetOrSheetTabIndex(i,2),n._se(i,e),t=n.getSheetPosition(o),n.setActiveSheetOrSheetTabIndex(t,2),n.resumePaint()):(n._se(i,e),r.scrollTabToActive(i,e)),0))},I.prototype.L3=function(t){for(var e,n,i,r,o,a,s,u,c,e=this,n,i=0,r=e.sheets;i<r.length;i++)if((o=r[i]).name()===t)return!1;for(s=0,u=a=e.mp;s<u.length;s++)if((c=u[s]).name()===t)return!1;return!0},I.prototype.o2=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,n=this,i=-1,r=n.qv(),a=r[t],s=n.sheets.length;if(Xt(n)){if(e<t)if(s<=t&&e<s)r.splice(t,1),r.splice(s,0,a),i=s;else{for(o=t;e<o;o--)r[o]=r[o-1];r[e]=a,i=e}else if(t<e)if(t<s&&s<=e)r.splice(s,0,a),r.splice(t,1),i=s-1;else{for(o=t;o<e;o++)r[o]=r[o+1];r[e]=a,i=e}}else if(u=n.getSheetTabCount(),l=void(f=c=0),h=_(a._gi),0<=t&&t<s&&0<=e&&e<s||s<=t&&t<s+u&&s<=e&&e<s+u){for(o=0;o<r.length;o++)if(d=r[o],_(d._gi)?c++:f++,h&&c-1===e||!h&&f-1===e){l=o;break}if(l<t){for(o=t;l<o;o--)r[o]=r[o-1];r[l]=a,i=l}else if(t<l){for(o=t;o<l;o++)r[o]=r[o+1];r[l]=a,i=l}}n.P3(r),n.setActiveSheetOrSheetTabIndex(i,2)},I.prototype._se=function(t,e){var n,i,r,o,a,n=this,i=-1,r=n.qv(),a=r[t];if(e<t){for(o=t;e<o;o--)r[o]=r[o-1];r[e]=a,i=e}else if(t<e){for(o=t;o<e;o++)r[o]=r[o+1];r[e]=a,i=e}n.P3(r),n.setActiveSheetOrSheetTabIndex(i,2)},I.prototype.F3=function(t,e){t?this.setActiveSheetTab(e):this.setActiveSheet(e)},I.prototype.setActiveSheetOrSheetTab=function(t){var e=this.getSheetIndex(t),n=!1;_(e)&&(e=this.getSheetTabIndex(t),n=!0),_(e)||this.F3(n,t)},I.prototype.isFocus=function(){var t=F.hi.ai();return t&&t.getParent&&t.getParent()===this},I.prototype.clone=function(t,e,n,i){var r,t,o,a,s,u,c,f,l,h,d,r=this,t=r.Gm(t);if(_(i)&&(i=!0),!(_(t)||_(n)||r.Gm(n))&&(o=t instanceof v.Worksheet,r.suspendPaint(),r.suspendCalcService(),t.canClone)){if(a=JSON.stringify(t.toJSON({newWorkSheetName:n})),e<0&&(e=0),o?((s=r.S2(n)).Uw().G3=!0,r.addSheet(e,s)):((s=r.bb(n,t._gi)).Mf&&(s.Mf.Uw().G3=!0),r.yb(e,2,s)),r.getSheetPosition(n)!==e&&r.changeSheetPosition(n,e),s.fromJSON(JSON.parse(a)),r.setActiveSheetOrSheetTab(s.name()),o){for(c=t.tables.U3,f=s.tables.U3,l=void 0,h=0;h<c.length;h++)c.get(h).H3&&i&&(u=c.get(h).z3(),f.get(h).V3(u)),l=f.get(h).range(),s.Q1i&&s.Q1i(l.row,l.col,l.rowCount,l.colCount,C.SheetArea.viewport);(u=t.H3._dataSource)&&i&&(d=s.H3).bind(u)}else(u=t.Mf&&t.Mf.H3._dataSource)&&i&&(d=s.Mf.H3).bind(u);return r.resumeCalcService(!1),r.resumePaint(),s}},I.prototype.fM=function(t){var e,n,t,e,i,t,e=this,n=t.command;0!==t.vM&&n.hM||(t=n.sheetName?(0,F._f)(e,n.sheetName):(0,F.jf)(e))&&(e=t.getActiveRowIndex(),i=t.getActiveColumnIndex(),t=t.getSelections(),n._oldPosition={_selections:t,_activeCell:{row:e,col:i}})},I.prototype.mM=function(t){var e,t,n,i,r,t,o,a,n,s,u,c,f,l,h,e=this,t=t.command,n=t._oldPosition,i=(0,F.jf)(e),r;if((i&&i.name())!==t.sheetName&&((0,F.Ef)(e,t.sheetName),i=(0,F.jf)(e)),!_(n)&&i){if(i.suspendPaint(),t=n._activeCell,o=n._selections,a=n.J3,n=n.X3,_(t)||i.t4(t.row,t.col),!_(o))if(1===(s=o.length))i.setSelection(o[0].row,o[0].col,o[0].rowCount,o[0].colCount);else for(u=0;u<s;u++)c=o[u].row,f=o[u].col,l=o[u].rowCount,h=o[u].colCount,i.n4(c,f,l,h);if(I.et(e,"onCommandExecuting",i),!_(a)){for(u=0;u<a.length;u++)a[u].isSelected&&a[u].isSelected(!0);n||i.e4()}i.showCell(t.row,t.col,3,3),i.resumePaint()}},I.prototype.changeSelectionInCommandExecuting=function(t,e,n,i,r){var t,o;t&&t._oldPosition&&(o=(t=t._oldPosition)._activeCell,_(o)||(_(e)||(o.row=e),_(n))||(o.col=n),_(i)||(t._selections=i),_(r)||(t.J3=r))},I.prototype.h3=function(){var t=this.getActiveSheet();t&&(t.L0(!1),t.b2(!1,!1)),this._2=-1},I.prototype.f3=function(){var t=this.getActiveSheetTab();t&&(t.L0(!1),t.b2(!1,!1)),this.jb=-1},I.prototype.yse=function(t){for(var e,n,i,e=[],n=0;n<t.length;n++)e[(i=t[n]).E0i=n]=i;return e},I.prototype.vse=function(t,e){for(var n,i,n=[],i=0;i<t.length;i++)n.push(t[i]);for(i=0;i<e.length;i++)n.push(e[i]);for(n.sort(function(t,e){return t.E0i-e.E0i}),i=0;i<n.length;i++)n[i].E0i=i;return n},I.prototype.qv=function(){var t=this;return t.sheets.length+t.mp.length!==t.dse.length&&(t.dse=[].concat(t.sheets).concat(t.mp)),t.dse},I.prototype.P3=function(t){var e,n,i,r,o,a,s,u,c,e=this,r=e.getActiveSheet(),o=e.getActiveSheetTab();for(r?n=r.name():o&&(i=o.name()),e.sheets.length=0,e.mp.length=0,a=e.sheets,s=e.mp,u=0;u<t.length;u++)(c=t[u]).E0i=u,(c instanceof v.Worksheet?a:s).push(c);n?e._2=e.getSheetIndex(n):i&&(e.jb=e.getSheetTabIndex(i)),e.dse=t},I.prototype.Gm=function(t){return this._f(t)||this.Ofe(t)},I.prototype.e2=function(t){return this.qv()[t]},I.prototype.getActiveSheetOrSheetTab=function(){return this.jg()},I.prototype.jg=function(){return this.getActiveSheet()||this.getActiveSheetTab()},I.prototype.I2=function(t,e,n,i){var t=this.e2(t);t&&(t instanceof v.Worksheet?this.vb(t.name(),e,n,i):this.s3(t.name(),e,n,i))},I.prototype.setActiveSheetOrSheetTabIndex=function(t,e,n,i){var r,o,r=this.getActiveSheet(),o=this.getActiveSheetTab();this.I2(t,_(e)?2:e,n,i),this.a3(r),this.u3(o)},I.prototype.getActiveSheetOrSheetTabIndex=function(){return this.ep()},I.prototype.ep=function(){var t=this.jg();return t?t.E0i:-1},I.prototype.i4=function(){var e=[].concat(this.sheets);return this.mp.forEach(function(t){t.Mf&&e.push(t.Mf)}),e},I.prototype.r4=function(){for(var t,e,n,i,r,o,t,e=this.sheets,n=e.length,i=[],r=0;r<n;r++)(o=e[r])&&i.push(o.name());return i},I.prototype.Ese=function(t){var e=this.getSheetIndex(t);return e=_(e)?this.getSheetTabIndex(t):e},I.Pp=Ht,I.Jp=1,I.Gp=0,R.Workbook=e=I,(0,F.$e)(e),e.prototype.nextControl=t("nextControl",L),e.prototype.previousControl=t("previousControl",L)},"./dist/core/workbook/workbookpanelex.js":function(g,t,e){"use strict";var E,n,i,H,e,f,p,w,m,q,i,a,b,U,C,$,tt,et,nt,it,rt,ot,at,st,ut,ct,y,ft,lt,ht,F,_,u,dt,A,L,D,vt,gt,j,O,V,Y,mt,K,pt,z,St,W,J,Z,wt,r,M,o,k,T,x,s,Q,X,G,S,B,l,I,c,P,n,c;function h(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function d(t,e,n,i,r,o,a,s,u,c){this.updateStateFn=u;var u=this;u.o4=s,u.a4=!1,u.u4=!1,u.s4=p,u.c4=p,u.f4=300,u.l4=70,u.h4=t,u.Gxn=c,u.qy(H.ScrollbarState.show),u.YC("number"==typeof e?e:0),u.ZC("number"==typeof n?n:0),u.d4("number"==typeof i?i:0),u.v4("number"==typeof r?r:0),u.m4("number"==typeof o?o:0),u.g4="number"==typeof a?a:1,u.p4=!1,u.b4=0,u.y4=u.m4(),u.w4()}function bt(t,e){var t=t.get(0);t&&(t.style[e]="")}function v(t,e){var n=this;n.S4=!0,n.T4=18,n.A4=t&&(0,E.GC$)(t),n.I4=e&&(0,E.GC$)(e),n.w4(!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.x4=t.YM=t.ScrollOrientation=void 0,E=e("./dist/core/util/domUtil.js"),n=e("./dist/core/util/common.js"),i=e("Common"),H=e("./dist/core/core.enum.js"),e=e("./dist/core/workbook/sheettabbase.js"),f=i.Common.lt.ht,p=null,w=n.mt.Tt,m=n.mt.vi,q=n.mt.En,i=n.mt.p0,a=document,b=window,U=Math.round,C=Math.ceil,$="gc-scroll-container",tt="gc-scroll-corner-all",et="gc-scroll-arrow",nt="gc-scrollbar-wrapper",it="gc-scroll-bar",rt="gc-scroll-arrowUp",ot="gc-scroll-arrowDown",at="gc-scroll-arrowLeft",st="gc-scroll-arrowRight",ut="gc-scroll-mobile-track",ct="gc-scroll-mobile-thumb",y="gc-scroll-mobile-state-active",ft="gc-scrollbar-vertical",lt="gc-scrollbar-horizontal",ht="gc-no-user-select",F="width",_="height",u="gc-scrollbar-stateActive ui-state-active",dt="float",A="left",L="right",D="top",vt="bottom",gt="margin-left",j="position",O="border",V="padding",Y="margin",mt="overflow",K="display",pt="outline",z="100%",St="borderWidth",W="boxSizing",J="absolute",Z="relative",wt="margin-top",M="mousedown"+(r=".gcScrollbar"),o="mouseup"+r,k="mousemove"+r,T="mouseover"+r,x="mouseout"+r,s="mousewheel",Q="inline-block",X="content-box",G="DOMMouseScroll",S="scroll"+r,B="scrollbar",(c=l=t.ScrollOrientation||(t.ScrollOrientation={}))[c.horizontalScroll=0]="horizontalScroll",c[c.verticalScroll=1]="verticalScroll",d.prototype._An=function(t){var e=this;e.Gxn!==t&&(e.Gxn=t,e.h4)&&(e.O4.css(e.Gxn?L:A,U(e.b4)),e.O4.css(e.Gxn?A:L,"auto"))},d.prototype.oy=function(){return this.N4},d.prototype.qy=function(t){t===H.ScrollbarState.inactive&&this.a4||(this.O3=t,this.updateStateFn&&this.updateStateFn())},d.prototype.value=function(t){var e,t,e=this;return 0===arguments.length?e.y4:("number"==typeof t&&t<=e.v4()&&t>=e.m4()&&(t=((e.y4=t)-e.m4())*e.k4,e.scrollTo(t,!0)),e)},d.prototype.w4=function(){var e,t,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G;function B(){e.N4=q("div"),e.D4=(0,E.GC$)(e.N4),e.D4.css([j,A,D,mt,pt,V,Y],[Z,0,0,"hidden","none",0,0]).addClass($+" "+tt+" "+s+" "),e.h4&&e.D4.css(dt,A)}function I(t){e._4=E.GC$.En("div",[j,K,St,V,Y,W],[J,Q,"1px",0,0,X],et+" "+w,t),e.E4=E.GC$.En("span",[K,O,V,Y],["block","none",0,0],g+" "+b,e._4)}function P(t){e.j4=E.GC$.En("div",[j,K,W,O,V,Y],[J,Q,X,"none",0,0],nt+" "+nt,t)}function R(t){e.O4=E.GC$.En("div",[],[],ht+" "+C+" "+it,t),e.R4=E.GC$.En("span",[K,O,V,Y],["block","none",0,0],p+" "+y,e.O4)}function N(t){e.B4=E.GC$.En("div",[j,K,St,V,Y,W],[J,Q,"1px",0,0,X],et+" "+M,t),e.L4=E.GC$.En("span",[K,O,V,Y],["block","none",0,0],m+" "+k,e.B4)}n=t=0,i=!1,a=(o=(r=(e=this).o4)===H.ScrollbarAppearance.mobile)?0:2,s="ui-widget ui-corner-all",u=e.ZC(),c=e.YC(),h=f=o?0:u,d=A,v=L,g=at,m=st,p=lt,S=gt,w="ui-button ui-state-default ui-corner-bl btn btn-default",b="ui-icon ui-icon-triangle-1-w",C="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",y="ui-icon ui-icon-grip-solid-vertical",M="ui-button ui-state-default ui-corner-br btn btn-default",k="ui-icon ui-icon-triangle-1-e",e.F4=l=c-2*f,e.h4||(l=f=o?0:c,d=D,v=vt,g=rt,m=ot,p=ft,S=wt,w="ui-button ui-state-default ui-corner-tr btn btn-default",b="ui-icon ui-icon-triangle-1-n",C="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",y="ui-icon ui-icon-grip-solid-horizontal",M="ui-button ui-state-default ui-corner-br btn btn-default",k="ui-icon ui-icon-triangle-1-s",e.F4=h=u-2*f),T=e.F4,x=e.v4()-e.m4(),e.P4=e.d4()*T/(x+e.d4()),e.P4>T&&(e.P4=T),e.P4<10&&(e.P4=10),G=e.P4,e.k4=0==x?1:(T-G)/x,n=e.h4?(t=G,f):(t=f,G),e.D4||(i=!0,B()),o?e.D4.addClass(ut):e.D4.removeClass(ut),e._4||I(e.D4),e.j4||P(e.D4),e.O4?e.O4.removeAttr("style"):R(e.j4),o?e.O4.css(j,J).addClass(ct):e.O4.css([j,St,V,Y,W],[J,"1px",0,0,X]).removeClass(ct),e.B4||N(e.D4),o?(bt(e.D4,O),bt(e.D4,Y),e.h4?(e.D4.css([F,_],[c,z]),e.j4.css([d,F,_],[f,z,z]),e.O4.css([d,F,_],[e.b4,U(t-a),z])):(e.D4.css([F,_,Y],[z,z,0]),e.j4.css([d,F,_],[f,z,z]),e.O4.css([d,F,_],[e.b4,z,U(n-a)])),e.R4.remove(),e._4.remove(),e.B4.remove()):(e.D4.css([F,_,O],[c,u,"none"]),e.j4.css([d,F,_],[f,l,h]),e.O4.css([d,F,_],[e.b4,U(t-a),U(n-a)]),e._4.css([d,F,_],[0,f-a,f-a]),e.E4.css([F,_],[z,z]),e.B4.css([v,F,_],[0,f-a,f-a]),e.L4.css([F,_],[z,z]),e.R4.css([F,_,S],[f-a,f-a,Math.floor((e.P4-f)/2)]),e.O4.append(e.R4),e.D4.append(e._4),e.D4.append(e.B4)),i&&e.G4()},d.prototype.G4=function(){var r=this;function t(t,e){t.bind(M,function(t){r.U4(t,e)}).bind(o,function(t){r.H4(t,e)}).bind(T,function(t){r.z4(t,e)}).bind(x,function(t){r.V4(t,e)})}t(r._4,!0),t(r.B4,!1),r.O4.bind(M,function(t){r.Y4(t)}).bind(k,function(t){r.Z4(t)}).bind(o,function(t){r.W4(t)}).bind(T,function(t){r.K4(t)}).bind(x,function(t){r.J4(t)}),r.j4.bind(M,function(t){var e,n,i,e;w&&w.mozilla&&(n=(new Date).valueOf(),i=r.X4,r.X4=n,i)&&n-i<100||r.q4(t)}).bind(o,function(t){r.tS(t)}),r.nS=function(t){r.eS(t)},r.D4.bind(s,r.nS),r.D4.bind(G,r.nS),d.et(r,"initEvents",r.N4)},d.prototype.Jw=function(t){this.o4=t},d.prototype.dispose=function(){var t=this;function e(t){t&&t.unbind(r)}e(t.B4),e(t.O4),e(t._4),e(t.j4),t.D4&&(t.nS&&(t.D4.unbind(s,t.nS),t.D4.unbind(G,t.nS)),d.et(t,"dispose",t.N4),t.D4.unbind(r).remove())},d.prototype.Fg=function(){var e=this;e.p4||((0,E.GC$)(a).bind(k,function(t){e.Z4(t)}).bind(o,function(t){e.W4(t)}),e.p4=!0)},d.prototype.u2=function(){this.p4&&(this.p4=!1,E.GC$)(a).unbind(k).unbind(o)},d.prototype.U4=function(t,e){var n,i,r,o,a,n=0,i=this,r=!0,o=i.Gxn;i.u4=!0,null===i.s4&&(e?(i._4.addClass(u),n=o?i.iS():0-i.iS(),i.rS=o?H.Zi.smallIncrement:H.Zi.smallDecrement):(i.B4.addClass(u),n=o?0-i.iS():i.iS(),i.rS=o?H.Zi.smallDecrement:H.Zi.smallIncrement),(a=function(){i.scrollTo(i.b4+n*i.k4,!1),i.s4=b.setTimeout(a,r?i.f4:i.l4),r=!1})(),h(t))},d.prototype.H4=function(t,e){var n,i,n=this,i;(e?n._4:n.B4).removeClass(u),n.oS(),h(t)},d.prototype.z4=function(t,e){var n,i,n=this,i;(e?n._4:n.B4).addClass("gc-scroll-arrow-hover ui-state-hover"),h(t)},d.prototype.V4=function(t,e){var n,i,n=this,i;(e?n._4:n.B4).removeClass("gc-scroll-arrow-hover ui-state-hover "+u),n.oS(),h(t)},d.prototype.Y4=function(t){var e,n,i,r,o,a,s,e=this;0===t.button&&(e.a4=!0,e._oldPosition={x:t.pageX,y:t.pageY},e.qy(H.ScrollbarState.show),e.Fg(),e.D4.addClass(y),e.O4.addClass(u),n=e.O4.offset(),i=e.O4.outerWidth(!0),r=e.O4.outerHeight(!0),o=e.j4.offset(),a=e.j4.outerWidth(!0),s=e.j4.outerHeight(!0),e.aS={isBeyondEdge:!1,startEdgePosition:{x:o.left+t.pageX-n.left,y:o.top+t.pageY-n.top},endEdgePosition:{x:o.left+a-(i-t.pageX+n.left),y:o.top+s-(r-t.pageY+n.top)}}),h(t)},d.prototype.Z4=function(t){var e=this;e.a4&&(e.qy(H.ScrollbarState.active),e.uS={x:t.pageX,y:t.pageY},e.sS(),e._oldPosition=e.uS,(0,E.GC$)(a.body).attr("unselectable","on").addClass(ht)),h(t)},d.prototype.W4=function(t){var e,n,i,r,o,o,e=this;e.a4=!1,e.rS=H.Zi.thumbPosition,e.aS=null,e.D4.trigger(S,{newValue:e.y4,oldValue:e.y4,scrollOrientation:e.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:e.rS}),i=((n=e.y4)-e.m4())*e.k4,r=e.Gxn?L:A,o=(o=t.target.classList)&&o.contains(ct),e.h4||(r=D),o?e.qy(H.ScrollbarState.hide):e.qy(H.ScrollbarState.inactive),e.b4=i,e.O4.css(r,U(i)),e.h4&&e.O4.css(e.Gxn?A:L,"auto"),e.u2(),(0,E.GC$)(a.body).removeClass(ht),(0,E.GC$)(a.body).attr("unselectable")&&(0,E.GC$)(a.body).removeAttr("unselectable"),e.O4.removeClass(u),e.D4.removeClass(y),e.rS=6,e.D4.trigger(S,{newValue:e.y4,oldValue:e.y4,scrollOrientation:e.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:e.rS}),h(t)},d.prototype.K4=function(t){this.O4.addClass("gc-scrollbar-stateHover ui-state-hover"),h(t)},d.prototype.J4=function(t){this.O4.removeClass("gc-scrollbar-stateHover ui-state-hover"),h(t)},d.prototype.eS=function(t){var e,n,i,n,i,e=this,n=e.Gxn;f(t.wheelDelta)&&f(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=t.detail||t.wheelDelta/-40,n&&(i*=-1),n=i/3*e.iS()*e.k4,e.rS=0<=n?1:0,e.scrollTo(e.b4+n,!1),e.rS=6,i={newValue:e.y4,oldValue:e.y4,scrollOrientation:e.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:e.rS},e.D4.trigger(S,i),h(t)},d.prototype.q4=function(t){var n,i,r,o,a,s,u,c,f,n=this,i=!0,r=t.pageX,o=t.pageY,a=0,s=n.j4.offset(),u=n.cS(),c=n.Gxn;null===n.c4&&(a=n.h4?r-s.left-(c?n.F4-n.b4-n.P4:n.b4):o-s.top-n.b4,(f=function(){var t=0,e=c?n.F4-n.b4-n.P4:n.b4,t;if((t=n.h4?r-s.left-e:o-s.top-e)*a<0||0<=t&&t<n.P4)n.fS();else{if(a<0)n.rS=c?H.Zi.largeIncrement:H.Zi.largeDecrement,n.scrollTo(c?n.b4+u*n.k4:n.b4-u*n.k4,!1);else{if(!(0<a))return void n.fS();n.rS=c?H.Zi.largeDecrement:H.Zi.largeIncrement,n.scrollTo(c?n.b4-u*n.k4:n.b4+u*n.k4,!1)}n.c4=b.setTimeout(f,i?n.f4:n.l4),i=!1}})(),h(t))},d.prototype.tS=function(t){this.fS(),h(t)},d.prototype.fS=function(){var t,e,t=this;t.c4&&clearTimeout(t.c4),t.c4=p,t.rS=H.Zi.endScroll,e={newValue:t.y4,oldValue:t.y4,scrollOrientation:t.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:t.rS},t.D4.trigger(S,e)},d.prototype.oS=function(){var t,e,t=this;t.u4&&(t.u4=!1,t.s4&&clearTimeout(t.s4),t.s4=p,t.rS=6,e={newValue:t.y4,oldValue:t.y4,scrollOrientation:t.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:t.rS},t.D4.trigger(S,e))},d.prototype.sS=function(){var n,t,e,i,r,o,e,a,s,i,s,u,i;function c(t){return n.h4?t.x:t.y}function f(t,e){n.h4?t.x=e:t.y=e}if(t=(n=this).b4,e=n.uS,i=n.aS,e=c(e),a=c(n._oldPosition),i&&i.isBeyondEdge){if(s=c(i.startEdgePosition),i=c(i.endEdgePosition),(r=e<s)||(o=i<e))return;a<s&&f(n._oldPosition,s),i<a&&f(n._oldPosition,i)}s=e-a,(u=n.Gxn)&&(s*=-1),(i=t+s)!==t&&(n.rS=5,n.scrollTo(i,!1))},d.prototype.scrollTo=function(t,e){var n,i,r,o,a,s,r,s,u,c,e,n=this,i=D,r=n.F4-n.P4;n.h4&&(i=n.Gxn?L:A),s=a=o=!1,r<t&&(t=r,a=s=!0),t<0&&(o=s=!(t=0)),n.aS&&(n.aS.isBeyondEdge=s),r=n.g4===H.ScrollType.continuous?U(t/n.k4)+n.m4():t/n.k4+n.m4(),s=n.y4,u=!1,e||(e={newValue:r,oldValue:s,scrollOrientation:n.h4?l.horizontalScroll:l.verticalScroll,scrollEventType:n.rS,isBeyondMaxEdge:a,isBeyondMinEdge:o},n.D4.trigger(S,e),u=e.ignoreUpdatePosition,e.newValue>n.v4()&&(e.newValue=n.v4()),r=e.newValue,c=e.newValueWithOffset),f(c)&&(c=r),n.y4=r,5!==n.rS&&(t=(c-n.m4())*n.k4),n.b4=t,u||(n.O4.css(i,U(t)),n.h4&&n.O4.css(n.Gxn?A:L,"auto"))},d.prototype.hitTest=function(t,e){var n,i,r,o,a,s,u,c,f,s,o,f,a,n=this,i=0,r=0,o=n.O4.outerWidth(),a=n._4.outerWidth(),s=n.j4.outerWidth(),u=n.O4.offset(),c=(0,E.GC$)(n.oy()).offset(),f=u.left-c.left-18;return n.h4?t<0+s+a&&0+a<t?t<f+o+a&&f<t?{element:H.Yi.ThumbButton,x:t,y:e}:{element:H.Yi.TrackButton}:t<=0+a&&0<t?{element:H.Yi.LeftButton,x:t,y:e}:{element:H.Yi.RightButton,x:t,y:e}:(s=n.O4.outerHeight(),o=n._4.outerHeight(),f=n.j4.outerHeight(),a=u.top-c.top-18,e<0+f+o&&0+o<e?e<a+s+o&&a<e?{element:H.Yi.ThumbButton,x:t,y:e}:{element:H.Yi.TrackButton}:e<=0+o&&0<e?{element:H.Yi.UpButton,x:t,y:e}:{element:H.Yi.DownButton,x:t,y:e})},d.prototype._b=function(){var t=this;return{x:0,y:0,width:t.YC(),height:t.ZC()}},d.prototype.show=function(){this.j4.show()},d.prototype.hide=function(){this.j4.hide()},d.prototype.lS=function(t){var e,e,e=this,e=e.D4.parent()&&e.D4.parent().parent();return e?t?e.height():e.width():p},I=d,t.YM=I,(0,n.$e)(I),(c=I.prototype).iS=i("smallChange",1),c.cS=i("largeChange",10),c.d4=i("pageValue",10,function(t){t<=0&&this.d4(1)}),c.v4=i("maximum",100,function(t){t<=0&&this.v4(0)}),c.m4=i("minimum",0,function(t){t<=0&&this.m4(0)}),c.YC=i("width",0),c.ZC=i("height",0),v.prototype.w4=function(t){var a,e,n,i,r,o,s,u,c,t,r,o,f,l;function h(t){return t===J?E.GC$.En("div",[j,A,D,O,V,Y],[J,0,0,"none",0,0]):t===Z?E.GC$.En("div",[j,A,D,O,V,Y],[Z,0,0,"none",0,0]):p}function d(t,e){var n,n,i,e,n=e?a.hS:a.dS;return n||(n=new I(e),i=E.GC$.En("div"),e?(a.vS=i,a.hS=n,i.css([j,A,vt,O,V,Y],[J,0,0,"none",0,0])):(a.mS=i,a.dS=n,i.css([j,L,D,O,V,Y],[J,0,0,"none",0,0])),e=(e?a.hS:a.dS).oy(),i.append(e),t.append(i),n)}function v(t,e,n,i,r,o){o?(a.vS.css([F,_],[e,i]),t.YC(e),t.ZC(i)):(a.mS.css([F,_],[i,e]),t.YC(i),t.ZC(e)),t.m4(0),t.v4(r-e),t.d4(e),t.iS(o?a.gS():a.pS()),t.cS(e),t.w4(),(0,E.GC$)(t.oy()).bind(S,function(t,e){n.css(o?A:D,0-e.newValue)}),(o?a.vS:a.mS).show()}function g(t){a.bS||(a.bS=h(Z),a.bS.css([mt,K,F],["hidden",Q,z]),t.append(a.bS))}function m(t){a.yS||(a.yS=E.GC$.En("div",j,Z,p,t))}(a=this).A4&&a.I4&&(e=a.T4,n=a.I4.width(),i=a.I4.height(),s=(r=a.A4.width())-e,u=(o=a.A4.height())-e,c=!1,a.wS||(a.wS=h(Z),a.wS.css([j,mt],[Z,"hidden"]),c=!0),a.wS.css(_,o),g(a.wS),m(a.bS),t&&a.yS.append(a.I4).css([D,A],[0,0]),w.chrome&&(n=U(n),i=U(i),r=C(r),o=C(o)),r=(t=a.CS(n,i,r,o)).MS,(o=t.SS)?(r||(s+=e),v(f=d(a.wS,!0),s,a.yS,e,n,!0)):a.vS&&a.vS.hide(),r?(o||(u+=e),v(l=d(a.wS,!1),u,a.yS,e,i,!1)):a.mS&&a.mS.hide(),o||r||(s+=e,u+=e),a.S4=r,a.TS=s,a.AS=u,a.bS.css(_,u),c)&&(a.A4.append(a.wS),a.IS())},v.prototype.xS=function(t){var e,t,n,t,e=this,t=e.NS(t),n=t.I0,t=t.A0;!f(n)&&e.hS&&e.wy(n),!f(t)&&e.dS&&e.yy(t)},v.prototype.wy=function(t){var e,n,i,e=this;e.hS.value(t),n=e.TS,i=e.I4.width(),0<=t&&t<=i-n&&e.yS.css(A,0-t)},v.prototype.yy=function(t){var e,n,i,e=this;e.dS.value(t),n=e.AS,i=e.I4.height(),0<=t&&t<=i-n&&e.yS.css(D,0-t)},v.prototype.CS=function(t,e,n,i){var r,o=n,a=i-this.T4,s={SS:!1,MS:!1};return n<t&&(s.SS=!0,s.MS=a<e),i<e&&(s.MS=!0,s.SS=o<t),s},v.prototype.NS=function(t){var e=(0,E.GC$)(t),n=this.bS,i=this.yS,t,i,r,e,o,e,o,a={I0:p,A0:p};return t&&(t=e.offset(),i=i.offset(),r=n.offset(),t.leftWidth=t.left+e.outerWidth(),t.topHeight=t.top+e.outerHeight(),r.leftWidth=r.left+n.outerWidth(),r.topHeight=r.top+n.outerHeight(),e=t.left-i.left,t.left<r.left?a.I0=e:t.leftWidth>r.leftWidth&&(o=t.leftWidth-i.left-n.innerWidth(),a.I0=e<o?e:o),e=t.top-i.top,t.top<r.top?a.A0=e:t.topHeight>r.topHeight&&(o=t.topHeight-i.top-n.innerHeight(),a.A0=e<o?e:o)),a},v.prototype.IS=function(){var e=this;this.yS&&(e.nS=function(t){e.kS(t)},e.yS.bind(s,e.nS),e.yS.bind(G,e.nS))},v.prototype.kS=function(t){var e,n,i,r,o,a,s,i,e=this;f(t.wheelDelta)&&f(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),i=n=t.detail||t.wheelDelta/-40,r=e.dS,o=parseInt(e.yS.css(D),10),a=e.AS,(s=e.I4.height())<a&&(s=a),(i=(i=0<=(i=(o=isNaN(o)?0:o)-i*e.pS())?0:i)<0&&s-a<0-i?0-(s-a):i)!==o&&(e.yS.css(D,i),e.S4)&&r.value(0-i),m(t)},v.prototype.dispose=function(){var t=this;t.wS&&(t.hS&&t.hS.dispose(),t.dS&&t.dS.dispose(),t.yS&&t.nS&&(t.yS.unbind(s,t.nS),t.yS.unbind(G,t.nS)),(0,E.GC$)(t.wS).remove())},(n=(t.x4=P=v).prototype).gS=i("horizontalSmallChange",10),n.pS=i("verticalSmallChange",10),e.Hv.ch(B,{preProcessMouseMove:function(t){var e=this.Vv,n;(e.Xb.a4||e.zb.a4)&&(t.r=!0)}})},"./dist/core/worksheet/actionbase.js":function(t,e){"use strict";function i(t,e){t.suspendPaint(),t.zHe&&t.zHe(),e||t.suspendEvent()}function r(t,e){e||t.resumeEvent(),t.ZHe&&t.ZHe(),t.resumePaint()}var n;function o(t,e){this.X5=i,this.q5=r;var n=this;n.Mf=t,n.tT=e}Object.defineProperty(e,"__esModule",{value:!0}),e.ActionBase=void 0,o.prototype.execute=function(){},o.prototype.canExecute=function(){return!0},o.prototype.canUndo=function(){return!0},o.prototype.undo=function(){return!0},e.ActionBase=o},"./dist/core/worksheet/attachmentManager/attachmentsManager.js":function(t,e,n){"use strict";var i,s,a,r;function o(){this.Uxn={},this.JHe={},this.Hxn={}}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Object.defineProperty(e,"__esModule",{value:!0}),e.AttachmentsManager=void 0,s=n("./dist/core/worksheet/attachmentManager/utils.js"),a=n("./dist/core/worksheet/attachmentManager/fileWrapper.js"),o.prototype.Wxn=function(t,e){if(void 0===e&&(e=!1),void 0!==t)return this.Uxn[t]||e&&this.JHe[t]},o.prototype.FHe=function(t){return!!this.Uxn[t]||!!this.Hxn[t]},o.prototype.oZn=function(t){var e,n,i,r,o,t,e,a,i,e=t.id,n=t.name,i=t.dataUrl,r=t.blob,o=t.type,t=t.postCreateFile,e=e||(0,s.Hne)();return i?(i=this.KHe(e,i,o,n),t&&t(i),this.JHe[e]=i,a=Promise.resolve(i)):r instanceof Blob&&(a=this.d1e(e,r,n,t)),a},o.prototype.VHe=function(t,e){e&&(e.id=t),this.Uxn[t]=e},o.prototype.BHe=function(t,e){if(t)return this.Uxn[e]=i(i({},t),{id:e}),this.Uxn[e]},o.prototype.EAe=function(t,e,n,i){var t,e,i,i=new a.FileWrapper(i);return i.name=t,i.blob=e,i.dataUrl=n,i.type=null!=(t=e.type)?t:"",""===i.type&&n&&(i.type=null==(e=n.split(":")[1])?void 0:e.split(";")[0]),i.loaded=!0,this.Uxn[i.id]=i},o.prototype.RAe=function(){return Object.values(this.Hxn)},o.prototype.FAe=function(t){var e=this;t.forEach(function(t){e.LAe(t)})},o.prototype.d5=function(){this.Uxn={},this.Hxn={},this.JHe={}},o.prototype.L0=function(){this.Uxn=null,this.Hxn=null,this.JHe=null},o.prototype.Np=function(t){var e,n,i,r,o,a,s,e,n=this.Uxn,i=(null==t?void 0:t.usedAttachmentFileGUIDs)||[];if(n&&0<Object.keys(n).length){for(o in r={},n)n.hasOwnProperty(o)&&(0<=i.indexOf(o)?(a=n[o])&&(s=a.id,e={name:a.name,dataUrl:null==(e=a.dataUrl)?void 0:e.toString(),type:a.type},r[s]=e):this.LAe(o));return t&&delete t.usedAttachmentFileGUIDs,r}},o.prototype.wh=function(t){var e,n,i,r,o,a,s,u,e=this.Uxn,n=(null==t?void 0:t.usedAttachmentFileGUIDs)||[];if(e&&0<Object.keys(e).length){for(o in i={},r={},e)e.hasOwnProperty(o)&&(0<=n.indexOf(o)?(a=e[o])&&(s=a.id,u={name:a.name,type:a.type},r[s]=u,i[s.split("/").pop()]={dataUrl:a.dataUrl}):this.LAe(o));return t&&delete t.usedAttachmentFileGUIDs,{attachmentsJSON:i,attachmentsInfos:r}}},o.prototype.Zme=function(t){var n,i,n=this,i=null!=t?t:{};Object.keys(i).forEach(function(t){var e=i[t];n.Uxn[t]=n.KHe(t,e.dataUrl,e.type,e.name)})},o.prototype.yh=function(i,r){var o=this;Object.keys(r).forEach(function(t){var e,n,e,e=i[t.split("/").pop()],n=r[t],e="data:"+n.type+";base64,"+btoa(e);o.Uxn[t]=o.KHe(t,e,n.type,n.name)})},o.prototype.KHe=function(t,e,n,i){var r,t,r=this,t=new a.FileWrapper(t);return t.name=i,t.dataUrl=e,t.blob=(0,s.HAe)(e,n),t.type=n||t.blob.type,(r.Uxn[t.id]=t).loaded=!0,t},o.prototype.d1e=function(i,t,e,n){var e,r,o,e,r=this,o=new a.FileWrapper(i);return o.name=null!=e?e:t.name,o.type=null!=(e=t.type)?e:"",o.blob=t,n&&n(o),this.JHe[i]=o,e=new Promise(function(e){var n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var t,t;o.loaded=!0,t=n.result,o.dataUrl=t,""===o.type&&t&&(o.type=null==(t=t.split(":")[1])?void 0:t.split(";")[0]),r.Uxn[o.id]=o,delete r.Hxn[i],delete r.JHe[i],e(o)},n.onerror=function(){delete r.Hxn[i],delete r.JHe[i],e(void 0)}}),this.Hxn[i]=e},o.prototype.LAe=function(t){this.Uxn[t]&&delete this.Uxn[t]},e.AttachmentsManager=o},"./dist/core/worksheet/attachmentManager/feature-register.js":function(t,e,n){"use strict";var e,i,f,d;Object.defineProperty(e,"__esModule",{value:!0}),e=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/worksheet/worksheet-model.js"),f=n("./dist/core/worksheet/attachmentManager/utils.js"),d=Math.min,i.Y8.ch("attachmentsManager",{preClear:function(t){var e,n,i,r,o,a,s,u,t,u,t,c,f,l,h,e=this,n=e.Mf,i=n.VTe(),r=t.row,o=t.col,a=t.rowCount,s=t.colCount,u=t.type,t=t.sheetArea;if(!((1&u)<=0||void 0!==t&&3!==t)){if(u=n.getRowCount(),t=n.getColumnCount(),c=[],0<=r&&0<=o){if(a=d(a,u-r),s=d(s,t-o),0<a&&0<s)for(h=r;h<r+a;h++)for(l=o;l<o+s;l++)(f=e.getFileGUID(h,l))&&c.push(f)}else if(0<=r&&-1===o){if(0<(a=d(a,u-r)))for(h=r;h<r+a;h++)(f=e.getFileGUID(h,-1))&&c.push(f)}else if(-1===r&&0<=o){if(0<(s=d(s,t-o)))for(l=o;l<o+s;l++)(f=e.getFileGUID(-1,l))&&c.push(f)}else-1===r&&-1===o&&(f=e.getFileGUID(-1,-1))&&c.push(f);c.forEach(function(t){var t=i.Wxn(t);t&&e.GHe(t)})}}}),e.Worksheet.ch("attachmentsManager",{afterCopyMoveStyle:function(t){var e,n,t,i,r,e,o,a,n,s,u,s,c,a,e=t.source,n=t.target,t=t.isMove,i=e.sheet,r=e.row,e=e.col,o=n.sheet,a=n.row,n=n.col,s=i.Ut.getFileGUID(r,e),u,s=i.VTe().Wxn(s);s&&(c=(0,f.Hne)(),o.Ut.setFileGUID(a,n,c),(a=o.VTe().BHe(s,c))&&o.Ut.UHe(a),t)&&(i.Ut.setFileGUID(r,e,null),i.Ut.GHe(s))}})},"./dist/core/worksheet/attachmentManager/fileWrapper.js":function(t,e){"use strict";var n;function i(t){this.id=t,this.loaded=!1}Object.defineProperty(e,"__esModule",{value:!0}),e.FileWrapper=void 0,e.FileWrapper=i},"./dist/core/worksheet/attachmentManager/index.js":function(t,e,n){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&("get"in r?e.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(n("./dist/core/worksheet/attachmentManager/attachmentsManager.js"),e),r(n("./dist/core/worksheet/attachmentManager/fileWrapper.js"),e),r(n("./dist/core/worksheet/attachmentManager/feature-register.js"),e)},"./dist/core/worksheet/attachmentManager/utils.js":function(t,e,n){"use strict";var n,i,r,o,a;function s(t){var e="";try{e=atob(t)}catch(t){}return e}Object.defineProperty(e,"__esModule",{value:!0}),e.Hne=e.HAe=e.n1e=void 0,n=n("Common"),i=n.Common.lt.ht,e.n1e=r=function(t){return t.startsWith("data:")&&1<t.split("base64,").length},e.HAe=o=function(t,e){for(var n,t,n,t,i,r,o,n=(t=null!=(n=null==t?void 0:t.toString())?n:"").split(","),t=null==(t=t.split(":")[1])?void 0:t.split(";")[0],r=(i=s(n[2===n.length?1:0])).length,o=new Uint8Array(r);r--;)o[r]=i.charCodeAt(r);return new Blob([o],{type:e||t})},e.Hne=a=function(t){var e=crypto&&crypto.randomUUID&&crypto.randomUUID();return i(e)&&(e="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),e=32===t?e.split("-").join(""):e}},"./dist/core/worksheet/clipboardhelper.js":function(t,e,n){"use strict";var A,i,h,d,x,L,c,D,v,j,O,r,G,o;function a(t){return t&&t.options.allowCopyPasteExcelStyle}function g(t,e){var n,i;if(D.msie){for(n=[],i=0;i<t.length;i++)e&&""===t[i].trim()||n.push(t[i]);return n.join("")}return t.join("")}function s(t){for(var e,n,i,e="picture",n=1,i=e+n.toString();t.get(i);)i=e+(++n).toString();return i}function B(t,e,n,i){for(var r,o,a,r=[],o=0,a=n;o<a;o++)r[e+o]=t.getRowHeight(e+o,i);return r}function I(t,e,n,i){for(var r,o,a,r=[],o=0,a=n;o<a;o++)r[e+o]=t.getColumnWidth(e+o,i);return r}function b(t,e,n){var i,r;if(e=e||"\x3c!--",n=n||"--\x3e",t)for(;;){if((i=t.indexOf(e))<0)break;if((r=t.indexOf(n))<0)break;t=t.substring(0,i)+t.substring(r+n.length)}return t}function C(t){for(var e,n,i,r,o,e="",n=t.split("\n"),i=0;i<n.length;i++)r=n[i],o=n[i-1],0<i&&"<br>"===o.substring(o.length-4)?e+="\n"+r:e+=r;return e}function f(t,e,n){var i,r,i=-1;if(n)for(r=i=0;r<e;r++)i+=n[t+r]||0;return i}function l(t,e,n){var i,r,i=-1;if(n)for(r=i=0;r<e;r++)i+=n[t+r]||0;return i}function m(t){for(var e,n,n=0;n<t.length&&(0!==t[n].type.indexOf("image")||!(e=t[n].getAsFile()));n++);return e}function p(t){var e,n,i,r,o,a,n,t,s,e,n={Standard:"#,##0.00",Fixed:"0.00",Scientific:"0.00E+00",Percent:"0.00%",'"Short Date"':"m/d/yyyy",'"Medium Date"':"d-mmm-yy",'"General Date"':"m/d/yyyy hh:mm",'"Short Time"':"hh:mm",'"Medium Time"':"h:mm AM/PM",'"Long Time"':"h:mm:ss AM/PM"}[t];if(n)return n;for(i=[],r=0,o=t=t.replace(/\\0022/g,'"');r<o.length;r++)"\\"!==(a=o[r])&&'"'!==a&&i.push(a);return n=0<=(s=(n=i.join("")).indexOf(t="[ENG]"))?n.substr(s+t.length):n}function S(t){for(var e,n,i,r,o,a,e=[],n="",i="",r=0,o=t;r<o.length;r++)(a=o[r]).match(/[^a-z0-9\+\-\%]/i)?(e.push("\\"),e.push(a),i=n='"'):e.push(a);return n+e.join("")+i}function u(t){this.Nf=[],this.Zc=t}function w(t){this.Nf={},this.Doe=t,this.joe=t.map(function(t){return new r(t)}),this.Lre=1}function V(t){var e=this;e.DS=O,e._S=O,e.ES=!1,e.jS=t,e.En()}Object.defineProperty(e,"__esModule",{value:!0}),e.yM=e.Ooe=e.Boe=void 0,A=n("./dist/core/util/common.js"),i=n("Common"),h=n("./dist/core/worksheet/stylehelper.js"),d=n("./dist/core/worksheet/style.js"),x=n("./dist/core/core.enum.js"),L=i.Common.zf,c=/<img[^>]+>/g,D=A.mt.Tt,v=i.Common.lt.ht,j=i.Common.Uf.OS,O=null,u.prototype.add=function(t){var e=this.Nf,n=e.indexOf(t);return-1===n&&(e.push(t),n=e.length-1),n},u.prototype.toString=function(t){var t=this.Nf[t];return v(t)?"":this.Zc+":"+t},r=u,e.Boe=r,w.prototype.Loe=function(n){var i=this.joe;return this.Doe.map(function(t,e){return i[e].add(n[t])}).join("_")},w.prototype.add=function(t){var e=this.Nf,t=this.Loe(t);return e[t]||(e[t]="sjs"+this.Lre,this.Lre++),e[t]},w.prototype.toString=function(){var t,e,n,i,r,o,a,s,u,t=this.joe,e=[],n=this.Nf;for(i in n)if(n.hasOwnProperty(i)){for(r=i.split("_"),o=[],a=0;a<this.Doe.length;a++)(s=t[a].toString(+r[a]))&&o.push(s);u="."+n[i]+"{\r\n"+o.join(";\r\n")+"\r\n}\r\n",e.push(u)}return e.join("")},G=w,e.Ooe=G,V.prototype.En=function(){var u,t,e,n,i,u=this,t=document.createElement("div");t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.width="0px",t.style.height="0px",t.style.overflow="hidden",(e=document.createElement("div")).setAttribute("contenteditable","true"),e.setAttribute("gcUIElement","gcSheetClipboard"),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",t.appendChild(e),u.RS=e,(n=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),u.jS&&u.jS.options.enableAccessibility&&(n.setAttribute("aria-hidden","true"),n.setAttribute("role","none"),n.setAttribute("title","")),n.setAttribute("tabindex","-1"),n.style.position="absolute",n.style.overflow="hidden",n.style.background="white",n.style.webkitUserSelect="text",t.appendChild(n),u.BS=n,(i=u.jS.getHost())&&i.appendChild(t),D.msie||D.edge||(u.qfe=function(t){var e,n,i,r,o,o,e=t.clipboardData;e&&(0<(i=(n=u.DS)?A.mt.sTe(n):[]).length||0<(r=n?A.mt.cTe(n):[]).length?e.setData("text/plain",""):(o=n?n.bT(u._S):"",e.setData("text/plain",o),o=n?n.MT(u._S):"",e.setData("text/html",o)),t.preventDefault())},u.FS=function(t){var n,e,i,r,o,r,e,e,r,a,s,a,n=(0,A.jf)(u.jS),e=t.clipboardData;e&&(i=(i=e.getData("text/html")).replace(c,""),(r=u.PS()).innerHTML=i,o=i?u.GS(r,!1):V.formatClipboardData(e.getData("text/plain")),r.innerHTML="",(r=!o&&!i&&m(e.items))?((e=new FileReader).onload=function(t){var e=new Image;e.src=t.target.result,e.onload=function(){n.US(o,i,e.src)}},e.readAsDataURL(r),u.oA=!0):(e=u.jS.commandManager(),r=o||i&&0<=i.indexOf("<table"),a=u._S,s=n.wT(a),a=!n._T(u.DS,n.yT(a),n,o,s.rows,s.cols,!1),r&&a?n.US(o,i):n.isPasteShapes&&n.isPasteShapes()?(e.execute({cmd:"pasteShapes",sheetName:n.name()}),u.oA=!0):n.isPasteFloatingObject&&n.isPasteFloatingObject()?(e.execute({cmd:"pasteFloatingObjects",sheetName:n.name()}),u.oA=!0):r&&n.US(o,i))),t.preventDefault()},e.addEventListener("cut",u.qfe),e.addEventListener("copy",u.qfe),e.addEventListener("paste",u.FS),u.HS=function(t){var e,n,i,n,r,n,r,o,a,o,e=(0,A.jf)(u.jS),n=t.clipboardData;n&&((i=V.formatClipboardData(n.getData("text/plain")))||(n=n.getData("text/html"))&&((r=u.PS()).innerHTML=n,i=u.GS(r,!1),r.innerHTML=""),n=u.jS.commandManager(),r=i,o=u._S,a=e.wT(o),o=!e._T(u.DS,e.yT(o),e,i,a.rows,a.cols,!1),r&&o?e.US(i,""):e.isPasteShapes&&e.isPasteShapes()?(n.execute({cmd:"pasteShapes",sheetName:e.name()}),u.oA=!0):e.isPasteFloatingObject&&e.isPasteFloatingObject()?(n.execute({cmd:"pasteFloatingObjects",sheetName:e.name()}),u.oA=!0):r&&e.US(i,"")),t.preventDefault()},n.addEventListener("paste",u.HS))},V.prototype.L0=function(){var t,e,e,n,n,e,e,n,t=this,e=t.RS;e&&(D.msie||D.edge||(e.removeEventListener("cut",t.qfe),e.removeEventListener("copy",t.qfe),e.removeEventListener("paste",t.FS),t.BS.removeEventListener("paste",t.HS)),(e=e.parentElement)&&(n=e.parentElement)&&n.removeChild(e),t.RS=O,t.BS=O),(n=t.zS)&&((e=n.parentElement)&&e.removeChild(n),t.zS=O),(e=t.VS)&&((n=e.parentElement)&&n.removeChild(e),t.VS=O),t.jS=O},V.prototype.YS=function(t){a(this.jS)?this.RS.innerHTML=t:this.BS.value=t},V.prototype.ZS=function(){(a(this.jS)?this.RS:this.BS).focus({preventScroll:!0})},V.prototype.WS=function(){a(this.jS)?document.execCommand("selectAll"):this.BS.select()},V.prototype.QS=function(){var t,e,n,i,r,r,t="",e="",n="";return e=a(this.jS)?((i=this.RS)&&(0<(r=i.getElementsByTagName("table")).length?t=r[0].outerHTML:0<(r=i.getElementsByTagName("img")).length&&(n=r[0].src)),this.GS(this.RS,!0)):V.formatClipboardData(this.BS.value),{html:t,text:e,image:n}},V.KS=function(t,e,n,i,r,o,a,s,u,c,f,l,h,d){var v,g,m,p,S,e,f,w,b,C,y,y,M,k,T,e,S,S;return!d&&(D.chrome||D.edge||D.mozilla)&&(V.Foe=new G(["background-color","color","font","white-space","vertical-align","text-align","border-left","border-right","border-top","border-bottom","mso-number-format"])),v=t.JS((0,A.Ec)(n,r,i,o),a),g=new RegExp(String.fromCharCode(32),"g"),S=p=!(m="&nbsp;"),a===x.SheetArea.viewport&&(n<0&&2==(2&e)&&(p=!0),r<0)&&1==(1&e)&&(S=!0),n=v.row,r=v.col,i=v.rowCount,o=v.colCount,e=f?t.options.gridline:O,f=f?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:O,w=h?B(t,n,i,a):O,b=h?I(t,r,o,a):O,C=!d&&4e3<i*o&&(D.safari||D.mozilla||A.mt.Qf()&&D.chrome),a===x.SheetArea.viewport?(M=y=void 0,T=k=O,e=V.XS(t,n,i,r,o,3,u,c,s,v,g,m,e,l,w,b,d),S&&(y=h?I(t,r,o,2):O,S=t.getColumnCount(2),k=V.XS(t,n,i,0,S,2,u,[],s,v,g,m,f,l,w,y,d)),p&&(M=h?B(t,n,i,1):O,S=t.getRowCount(1),T=V.XS(t,0,S,r,o,1,[],c,s,v,g,m,f,l,M,b,d)),y=V.qS(e,k,T,d,C)):a===x.SheetArea.rowHeader?(k=V.XS(t,n,i,r,o,2,u,c,s,v,g,m,f,l,w,b,d),y=V.qS(k,O,O,d,C)):a===x.SheetArea.colHeader&&(T=V.XS(t,n,i,r,o,1,u,c,s,v,g,m,f,l,w,b,d),y=V.qS(T,O,O,d,C)),V.Foe&&(V.Foe=O),y},V.qS=function(t,e,n,i,r){var o,a,s,e,u,o=t,a=0,s=function(t,e){for(var n,i,r,n=[],i=t.length,r=0;r<i;r++)n.push(t[r].concat(e[r]));return n};return e&&(a=e[0].length,o=s(e,t)),n&&(e=n.length,o=(n=a?s(u=V.XS(O,0,e,0,a,O,[],[],!1,O,O,O,O,!1,[],[],i),n):n).concat(o)),r&&V.$S(o),V.t5(o,i)},V.$S=function(t){for(var e,n,e=t.length,n=t.length-1;0<=n&&-1===t[n].join("").search(/>\S+</);n--)e=n;t.length=e},V.t5=function(t,e){var n,i,r,o,a,n="",i=!!V.Foe;for(i&&(n=(n+="<html>\r\n<head>\r\n<style>\r\n")+V.Foe.toString()+"</style>\r\n</head>\r\n<body>\r\n"),r=t.length,n+=e?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true" style="min-width:1px;min-height:1px;">',o=0;o<r;o++){for(n+="<tr>",a=0;a<t[o].length;a++)n+=t[o][a];n+="</tr>"}return n+="</table>",i&&(n+="\r\n</body>\r\n</html>"),n},V.n5=function(t){return t&&0<=t.indexOf('gc-sjs-clipboard="true"')},V.vI=function(t,e,n,i,r,o,a){var s,u,c,i,r,f,l,l,l,o,l,s,o,u,e,l,s,s,s,s,c,s,s=V.convertVAlign,u=V.convertHAlign,c=V.convertLineBorder,i=i,r=r,f={},l=t.backColor;return l&&(f["background-color"]=l,r=i=!1),(l=t.foreColor)&&(f.color=l),(l=t.font)&&(o&&(l=l+", "+A.FallbackFontFamily),f.font=l.replace(/"/g,"'").replace(/([\.\d]+px)/,function(t){return(3*parseFloat(t.substring(0,t.length-2))/4).toFixed(2)+"pt"})),t.wordWrap?a?(f["word-wrap"]=["break-word"],f["white-space"]=["break-spaces"]):f["white-space"]="normal":f["white-space"]="nowrap",o=t.vAlign,v(o)||(f["vertical-align"]=s(o)),l=t.hAlign,v(l)||(s=u(l=a?A.mt.gt(l,e):l))&&(f["text-align"]=s),o="border-left",u="border-right",e="border-top",l="border-bottom",(s=t.borderLeft)&&(f[o]=c(s),r=!1),(s=t.borderRight)&&(f[u]=c(s),r=!1),(s=t.borderTop)&&(f[e]=c(s),i=!1),(s=t.borderBottom)&&(f[l]=c(s),i=!1),c="1px solid "+n,i&&(f[e]=c,f[l]=c),r&&(f[o]=c,f[u]=c),s=t.formatter,!a&&s&&(f["mso-number-format"]=S(s)),f},V.dge=function(t,e,n,i,r){var o,a,s,u,c,o=t.row===e&&t.col===n;if(i&&r){for(s=t.row;s<t.row+t.rowCount;s++)if(0<i[s]){a=s;break}for(u=void 0,c=t.col;c<t.col+t.colCount;c++)if(0<r[c]){u=c;break}o=a===e&&u===n}return o},V.hge=function(t,e,n){var i,r,i=e;if(n)for(r=t;r<t+e;r++)n[r]<=0&&i--;return i},V.XS=function(t,e,n,i,r,o,a,s,u,c,f,l,h,F,d,v,g){var m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,N,E,H,_,U,B,x,I,P,R;for(h&&(m=h.color,p=h.showHorizontalGridline,S=h.showVerticalGridline),w=[],b=0;b<n;b++)if(!(j(a,C=e+b)||g&&d&&d[C]<=0)){for(y=[],M=0;M<r;M++)if(!(j(s,k=i+M)||g&&v&&v[k]<=0)){if(T="",G=x=void 0,R=P=I=B=1,u&&t&&(x=(x=t.getSpan(C,k,o))&&V.isPartSpan(x,c,a,s)?O:x)){if(x.row!==C||x.col!==k){if(!V.dge(x,C,k,d,v))continue;C=x.row,k=x.col}G=t.getActualStyle(C,k,o),N=t.getActualStyle(x.row+x.rowCount-1,x.col+x.colCount-1,o),!G.borderRight&&N.borderRight&&(G.borderRight=N.borderRight),!G.borderBottom&&N.borderBottom&&(G.borderBottom=N.borderBottom)}if(T+="<td",N=t&&t.getValue(C,k,o),u&&t){if(x&&(B=V.hge(x.row,x.rowCount,d),P=x.rowCount,1<B&&(T+=" rowSpan="+B),I=V.hge(x.col,x.colCount,v),R=x.colCount,1<I)&&(T+=" colSpan="+I),G=G||t.getActualStyle(C,k,o),E=g?"padding: 0; ":"",H=V.vI(G,N,m,p,S,F,g),V.Foe)T+=' class="'+(_=V.Foe.add(H))+'"';else for(U in H)H.hasOwnProperty(U)&&(E+=U+": "+H[U]+"; ");B=H.font?A.mt.vt(H.font):0,(E+=V.e5(C,k,P,R,d,v,B))&&(T+=' style="'+E+'"')}T+=">",I=x=void 0,u&&t&&((x=2==(2&(P=G.textDecoration)))&&(T+="<s>"),I=(I=1==(1&P))||8==(8&P))&&(T+="<u>"),(R=t?t.getText(C,k,o):"")?(" "!==R[0]&&" "!==R[R.length-1]||"number"!=typeof N||(R=R.trim()),"number"!=typeof N&&(R=L.j0(R).replace(f,l))):D.chrome?R="":D.safari&&(R="&nbsp;"),T+=R=g?R:R.replace(/\n/g,'<br style="mso-data-placement:same-cell;"/>'),u&&(I&&(T+="</u>"),x)&&(T+="</s>"),y.push(T+="</td>")}w.push(y)}return w},V.e5=function(t,e,n,i,r,o,a){var s,t,n,u,s="",t=f(t,n,r);return 0<t&&(t-=1),0<(n=l(e,i,o))&&(n-=1),s=0<=t&&0<=n?"overflow: hidden;height: "+t+"px;line-height: "+(u=Math.min(a,t))+"px; width: "+n+"px;max-width: "+n+"px;min-width: "+n+"px;":s},V.prototype.PS=function(){var t,e,n,t=this;return t.zS||((e=document.createElement("div")).style.display="none",(n=t.jS.getHost())&&n.appendChild(e),t.zS=e),t.zS},V.prototype.i5=function(){var t,e,n,t=this;return t.VS||((e=document.createElement("div")).style.display="none",(n=t.jS.getHost())&&n.appendChild(e),t.VS=e),t.VS},V.prototype.r5=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,d,g,r=this.PS();if(r.innerHTML=t,o=r.getElementsByTagName("table"),a=e.o5(),0<o.length)for(s=this.a5(o[0],!0,t),c=n+(u=0);u<s.length;u++,c++){if(f=s[u],a)for(;0===e.getRowHeight(c);)c++;for(h=i+(l=0);l<f.length;l++,h++)if(d=f[l]){if(a)for(;0===e.getColumnWidth(h);)h++;e.u5(c,h,d.style),v=d.rowSpan,d=d.colSpan,(1<v||1<d)&&((g=e.getSpan(c,h))?(g.row=c,g.col=h,g.rowCount=v,g.colCount=d):e.addSpan(c,h,v,d))}}r.innerHTML=""},V.prototype.s5=function(t,e,n,i){var r,r,e,r;e.shapes?((r=e.shapes.addPictureShape("",t,0,0)).startRow(n),r.startColumn(i)):e.pictures&&(e=s(r=e.pictures),(r=r.add(e,t,0,0)).startRow(n),r.startColumn(i))},V.prototype.a5=function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,g,m,g,p,S,w,i=this.i5(),r=[],o=/ +/g,a=/\n /g,s=0;s<t.rows.length;s++)for(u=t.rows[s],r[s]||(r[s]=[]),c=r[s],l=f=0;f<u.cells.length;f++){for(h=u.cells[f];c[l];)l++;for(d=c[l]={},v=void 0,e&&(v=V.getStyleFromDOM(h,n),d.style=v),g=(g=(g=(g=C(g=b(g=h.innerHTML,"\x3c!--[if","[endif]--\x3e"))).replace(o," ")).replace(a,"\n")).replace(/(<br[^<]*>)/g,function(t,e,n,i){return"\n"!==i[n+t.length]?e+"\n":e}),i.innerHTML=g,m=i.innerText,0<=g.indexOf("<table")&&(m=m.trim()),d.text=m,d.rowSpan=h.rowSpan,(g=h.getAttribute("style"))&&0<=g.search(/mso-ignore:\s*colspan/)?d.colSpan=1:d.colSpan=h.colSpan,p=0;p<h.rowSpan;p++)for(S=0;S<h.colSpan;S++)0===p&&0===S||(r[s+p]||(r[s+p]=[]),(w=r[s+p])[l+S]={style:v,text:"",rowSpan:1,colSpan:1});l+=h.colSpan}return i.innerHTML="",r},V.prototype.GS=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,n=[];if(t)if(0<(i=t.getElementsByTagName("table")).length)for(r=this.a5(i[0],!1),o=new RegExp(String.fromCharCode(160),"g"),a=String.fromCharCode(32),s=0,u=r.length;s<u;s++){for(f=0,l=(c=r[s]).length;f<l;f++)d=!1,0<=(h=c[f]?c[f].text:"").indexOf('"')&&(h='"'+h.replace(/"/g,'""')+'"',d=!0),0<=h.indexOf("\n")&&(e?(0<=h.indexOf("\r\n")&&(h=g(h.split("\r\n"),!0)),h=g(h.split("\n"),!0)):d||(h='"'+h+'"')),0<=h.indexOf("\t")&&(h=g(h.split("\t"),!0)),n.push(h.replace(o,a)),f<l-1&&n.push("\t");s<u-1&&n.push("\r\n")}else n.push(b(t.innerText||t.innerHTML).trim());return n.join("")},V.prototype.c5=function(t){var e,n,e=this,n=e.QS();e.DS&&e.DS.ki(A.Events.ClipboardChanging,{sheet:e.DS,sheetName:e.DS.name(),copyData:{text:n.text,html:n.html},ranges:e._S,cancel:!1,action:x.ClipboardActionType.reset},!0),e.DS=O,e._S=O,e.ES=!1,e.TT=!1,e.jS.ki("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},V.isPartSpan=function(t,e,n,i){var r,o,a,s,u,c;if(!e.containsRange(t))return!0;for(r=0,o=n;r<o.length;r++)if(a=o[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(s=0,u=i;s<u.length;s++)if(c=u[s],t.col<=c&&c<t.col+t.colCount)return!0;return!1},V.formatClipboardData=function(t){var e,n,i,r,o,a,e=[];if(t){for(i=!(n='"'),r=0;r<t.length;r++)o=0<r?t[r-1]:"",'"'===(a=t[r])?(i=!i,e.push('"')):e.push(i||"\n"!==a||"\r"===o?a:"\r\n");return e.join("")}return""},V.convertHAlign=function(t){var e;return{0:"left",1:"center",2:"right"}[t]},V.convertVAlign=function(t){var e;return{0:"top",1:"middle",2:"bottom"}[t]},V.convertLineBorder=function(t){var e,n,e,n;return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[t.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[t.style]+" "+t.color},V.convertToHAlign=function(t){var e;return{left:0,center:1,right:2}[t]},V.convertToVAlign=function(t){var e;return{top:0,middle:1,bottom:2}[t]},V.convertToLineBorder=function(t,e,n){var i={none:0,solid:1,dashed:3,dotted:4,double:6};return(D.msie||D.edge)&&"2px"===n?i.solid=5:(n=Math.round(10*parseFloat(n)*3/4)/10)<=.8?i.solid=1:n<=1?(i.solid=2,i.dashed=8):n<=1.5&&(i.solid=5),new d.LineBorder(t,i[e])},V.convertToTextDecoration=function(t){var e;return{underline:1,"line-through":2,"underline line-through":3,none:0}[t]},V.isTransparent=function(t){return 0===i.Common.ft._(t).a},V.isBlack=function(t){var t=i.Common.ft._(t);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b},V.getStyleFromDOM=function(t,e){var n,i,r,o,a,a,a,s,n,u,a,c,f,n,r,n,a,r,n,a,r,c,n,l,i,f,n=t.getElementsByTagName("font")[0],i=getComputedStyle(t),r=t.style,o=new d.Style,a=i.backgroundColor;return a&&!V.isTransparent(a)&&(o.backColor=a),a=i.color,(a=n?n.color:a)&&!V.isBlack(a)&&(o.foreColor=a),n?o.font=h.W.f5(getComputedStyle(n)):(a=h.W.f5(i))&&(a=a.replace(/\/.+?\s/gi," "),o.font=a),"normal"===(s=i.whiteSpace)&&(o.wordWrap=!0),n=i.verticalAlign,a=V.convertToHAlign,c=V.convertToLineBorder,f=V.convertToTextDecoration,n&&(o.vAlign=(u=V.convertToVAlign)(n)),n=r.textAlign,r=i.textAlign,D.msie||D.edge?o.hAlign=a(""!==n?n:"general"):r&&(o.hAlign=a(r)),"none"!==(n=i.borderLeftStyle)&&(o.borderLeft=c(i.borderLeftColor,n,i.borderLeftWidth)),"none"!==(a=i.borderRightStyle)&&(o.borderRight=c(i.borderRightColor,a,i.borderRightWidth)),"none"!==(r=i.borderTopStyle)&&(o.borderTop=c(i.borderTopColor,r,i.borderTopWidth)),"none"!==(n=i.borderBottomStyle)&&(o.borderBottom=c(i.borderBottomColor,n,i.borderBottomWidth)),a=f(i.textDecorationLine||i.textDecoration),0<t.getElementsByTagName("u").length&&(a|=f("underline")),0<t.getElementsByTagName("s").length&&(a|=f("line-through")),0!==a&&(o.textDecoration=a),(r=t.classList[0])&&e&&(c=e.indexOf("."+r),n=e.indexOf("}",c),f=(i=(l=e.substring(c,n+1)).match(new RegExp("\\."+r+"[\\s\\S]*?{[\\s\\S]*?mso-number-format:(.*)[\\s\\S]*?}")))&&i[1])&&(";"===f[f.length-1]&&(f=f.substring(0,f.length-1)),o.formatter=p(f)),o},e.yM=V},"./dist/core/worksheet/feature-registers/index.js":function(t,e,n){"use strict";var i,r,i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&("get"in r?e.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){t[i=void 0===i?n:i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(n("./dist/core/worksheet/feature-registers/workbook-feature-register.js"),e)},"./dist/core/worksheet/feature-registers/workbook-feature-register.js":function(t,e,n){"use strict";var i,r,o;function a(){r.Workbook.ch("worksheet",{preSave:function(t){var e=t.saveOptions,n=t.workingPromiseArray;(null==e?void 0:e.fileType)===i.OpenSaveFileType.excel&&this.sheets.forEach(function(t){(new o.SetBase64Helper).generate(t,n)})}})}Object.defineProperty(e,"__esModule",{value:!0}),e.registerWorkbookFeatures=void 0,i=n("./dist/core/core.enum.js"),r=n("./dist/core/workbook/workbook.js"),o=n("./dist/core/worksheet/helpers/set-base64-helper.js"),e.registerWorkbookFeatures=a},"./dist/core/worksheet/helpers/set-base64-helper.js":function(t,e,n){"use strict";var f,i;function r(){this.cfr={}}Object.defineProperty(e,"__esModule",{value:!0}),e.SetBase64Helper=void 0,f=n("./dist/core/core.enum.js"),r.prototype.generate=function(t,e){try{this.cfr={},this.XHe(t,e)}catch(t){}},r.prototype.XHe=function(t,e){var n,i,r,o,a,s,u,u,c,n=[],i=t.getUsedRange(f.UsedRangeType.formula);if(i){for(r=i.row+i.rowCount-1,o=i.col+i.colCount-1,a=0;a<=r;a++)for(s=0;s<=o;s++)(u=t.getFormula(a,s))&&u.toUpperCase().replace("=","").startsWith("IMAGE")&&(u=t.getValue(a,s))&&u.value&&u.value.url&&!u.value.imageBase64Data&&((c=this.cfr[u.url])?u.imageBase64Data=c:n.push(this.qHe(u.value)));0<n.length&&e.push(Promise.all(n))}},r.prototype.qHe=function(n){var i=this;return new Promise(function(t){var e=document.createElement("img");e.crossOrigin="anonymous",e.onload=function(){n.imageBase64Data=i.afr(e),i.cfr[n.url]=n.imageBase64Data,t(!0)},e.onerror=function(){t(!0)},e.onabort=function(){t(!0)},e.src=n.url})},r.prototype.afr=function(t){var e=document.createElement("canvas");e.width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0);try{return e.toDataURL()}catch(t){return""}},e.SetBase64Helper=r},"./dist/core/worksheet/helpers/visible-row-col-cache.js":function(t,e){"use strict";var n;function i(t){this.rTe=!1,this.Mf=t,this.Hc()}Object.defineProperty(e,"__esModule",{value:!0}),e.VisibleRowColCache=void 0,i.prototype.Hc=function(){this.lTe={},this.hTe={}},i.prototype.oTe=function(t){this.rTe=t},i.prototype.sD=function(t,e){var n,i;return this.rTe||void 0===e?t+1:(void 0===(i=(n=this.dTe(e))[t])&&(i=this.QCe(t,e),n[t]=i),i)},i.prototype.QCe=function(t,e){for(var n,i,r,n=this.Mf.getRowCount(e),i=this.Mf,r=t+1;r<n;r++)if(i.getRowVisible(r,e))return r;return n},i.prototype.dTe=function(t){var e=this.lTe[t];return e||(this.lTe[t]={},this.lTe[t])},i.prototype.KCe=function(t,e){var n,i;return this.rTe||void 0===e?t+1:(void 0===(i=(n=this.vTe(e))[t])&&(i=this.YCe(t,e),n[t]=i),i)},i.prototype.YCe=function(t,e){for(var n,i,r,n=this.Mf.getColumnCount(e),i=this.Mf,r=t+1;r<n;r++)if(i.getColumnVisible(r,e))return r;return n},i.prototype.vTe=function(t){var e=this.hTe[t];return e||(this.hTe[t]={},this.hTe[t])},e.VisibleRowColCache=i},"./dist/core/worksheet/paste-special-dialog.js":function(t,e,i){"use strict";var n,r,o,a,s,u,s,c,f,l,h,d,v,g,m,p,S,w,b;function C(e,i,r){for(var o,t,n,o="",t=function(n){var t=e.slice(n,n+i);o+='<div class="gc-sjs-vertical-container gc-sjs-column-container">',t.forEach(function(t,e){o+=h(t,r,r+(e+n))}),o+="</div>"},n=0;n<e.length;n+=i)t(n);return o}function y(t,e,n){var t,e,t=b.call(this,t,e,n)||this;return t.data={pasteOptions:a.ClipboardPasteOptions.all,operationOptions:a.PasteOperationOptions.none,skipBlanks:!1,transpose:!1,pasteLink:!1},t.X2e=!1,e=i("SheetsCalc"),t.X2e=!!e,t}n=this&&this.__extends||(w=function(t,e){return(w=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Object.defineProperty(e,"__esModule",{value:!0}),e.PasteSpecialDialog=void 0,o=i("./dist/core/util/basedialog.js"),a=i("./dist/core/core.enum.js"),s=i("Common"),u=i("./dist/core/core.ns.js"),s=new s.Common.ResourceManager(u.SR,"Sheets"),c=s.getResource.bind(s),f=function(){return[{value:a.ClipboardPasteOptions.all,text:c().pasteSpecialOptionDialog.pasteOptions.all},{value:a.ClipboardPasteOptions.formulas,text:c().pasteSpecialOptionDialog.pasteOptions.formulas},{value:a.ClipboardPasteOptions.values,text:c().pasteSpecialOptionDialog.pasteOptions.values},{value:a.ClipboardPasteOptions.formatting,text:c().pasteSpecialOptionDialog.pasteOptions.formats},{value:a.ClipboardPasteOptions.comments,text:c().pasteSpecialOptionDialog.pasteOptions.comments},{value:a.ClipboardPasteOptions.validation,text:c().pasteSpecialOptionDialog.pasteOptions.validation},{value:a.ClipboardPasteOptions.usingSourceTheme,text:c().pasteSpecialOptionDialog.pasteOptions.usingSourceTheme},{value:a.ClipboardPasteOptions.noBorder,text:c().pasteSpecialOptionDialog.pasteOptions.noBorders},{value:a.ClipboardPasteOptions.columnWidths,text:c().pasteSpecialOptionDialog.pasteOptions.columnWidth},{value:a.ClipboardPasteOptions.formulasAndNumberFormatting,text:c().pasteSpecialOptionDialog.pasteOptions.formulasAndNumberFormats},{value:a.ClipboardPasteOptions.valuesAndNumberFormatting,text:c().pasteSpecialOptionDialog.pasteOptions.valueAndNumberFormats}]},l=function(){return[{value:a.PasteOperationOptions.none,text:c().pasteSpecialOptionDialog.operationOptions.none},{value:a.PasteOperationOptions.add,text:c().pasteSpecialOptionDialog.operationOptions.add},{value:a.PasteOperationOptions.subtract,text:c().pasteSpecialOptionDialog.operationOptions.subtract},{value:a.PasteOperationOptions.multiply,text:c().pasteSpecialOptionDialog.operationOptions.multiply},{value:a.PasteOperationOptions.divide,text:c().pasteSpecialOptionDialog.operationOptions.divide}]},h=function(t,e,n){return'<div><input type="radio" value="'.concat(t.value,'" name="').concat(e,'" id="').concat(n,'"/><label for="').concat(n,'">').concat(t.text,"</label></div>")},d="pasteOptions",v="operationOptions",g="skipBlanks",m="transpose",p="pasteLink",b=o.Ase,n(y,b),y.prototype.$c=function(t){this.Dn(),b.prototype.$c.call(this,t),this.q2e(),this.$2e()},y.prototype.rQ=function(t){this.submitCallback=t,this.$c()},y.prototype.npe=function(t,e){return this.Wc[0].querySelector('input[name="'.concat(t,'"][value="').concat(e,'"]'))},y.prototype.Dn=function(){this.Wc.html(this.ipe),this.npe(d,this.data.pasteOptions).checked=!0,this.X2e&&(this.npe(v,this.data.operationOptions).checked=!0)},y.prototype.$2e=function(){var t=this.Wc.width(),e=this.Wc.height(),n=this.Fc.width(),i=this.Fc.height();this.Wc.css(["position","left","top"],["absolute",(n-t)/2+"px",(i-e)/2+"px"])},Object.defineProperty(y.prototype,"ipe",{get:function(){return'\n<div class="gc-sjs-paste-special-dialog-container">\n    <div class="gc-sjs-paste-special-dialog-title gc-sjs-horzation-container">\n        <span class="gc-sjs-paste-special-dialog-title-text">'.concat(c().pasteSpecialOptionDialog.title,'</span>\n        <span class="cancel-icon" data-cmd="close">\xd7</span>\n    </div>\n    <div class="gc-sjs-paste-special-dialog-content">\n        <div class="gc-sjs-horzation-container">\n            <span>').concat(c().pasteSpecialOptionDialog.paste,'</span>\n            <div class="gc-sjs-separator"></div>\n        </div>\n        <div class="gc-sjs-paste-special-dialog-paste-options gc-sjs-horzation-container">\n            ').concat(C(f(),6,d),"\n        </div>\n        ").concat(this.X2e?'\n            <div class="gc-sjs-horzation-container">\n                <span>'.concat(c().pasteSpecialOptionDialog.operation,'</span>\n                <div class="gc-sjs-separator"></div>\n            </div>\n            <div class="gc-sjs-paste-special-dialog-operation-options gc-sjs-horzation-container">\n                ').concat(C(l(),3,v),"\n            </div>\n         "):"",'\n        <div class="gc-sjs-separator"></div>\n        <div class="gc-sjs-horzation-container">\n            <div class="gc-sjs-column-container">\n                <input type="checkbox" id="').concat(g,'"/><label for="').concat(g,'">').concat(c().pasteSpecialOptionDialog.skipBlanks,'</label>\n            </div>\n            <div class="gc-sjs-column-container">\n                <input type="checkbox" id="').concat(m,'"/><label for="').concat(m,'">').concat(c().pasteSpecialOptionDialog.transpose,'</label>\n            </div>\n        </div>\n    </div>\n    <div class="gc-sjs-paste-special-dialog-footer gc-sjs-horzation-container">\n        ').concat(this.X2e?'<span class="gc-sjs-dialog-button" data-cmd="'.concat(p,'">').concat(c().pasteSpecialOptionDialog.pasteLink,"</span>"):"<span></span>",'\n        <div>\n            <span class="gc-sjs-dialog-button" data-cmd="submit">').concat(c().ok,'</span>\n            <span class="gc-sjs-dialog-button" data-cmd="close">').concat(c().cancel,"</span>\n        </div>\n    </div>\n</div>\n        ")},enumerable:!1,configurable:!0}),y.prototype.submit=function(t){var t=t||this.data;this.submitCallback&&this.submitCallback(t),this.close()},y.prototype.rpe=function(t){var e,t,e,t=t.target.dataset.cmd;if(t)switch(t){case"close":this.close();break;case"submit":this.submit();break;case p:this.submit(r(r({},this.data),{pasteLink:!0}))}},y.prototype.ope=function(t){var t=t.target;t.name?(t.name===d&&t.checked&&(this.data.pasteOptions=+t.value),t.name===v&&t.checked&&(this.data.operationOptions=+t.value)):(t.id===g&&(this.data.skipBlanks=t.checked),t.id===m&&(this.data.transpose=t.checked)),this.ape()},y.prototype.q2e=function(){var e,t,n,i,r,e=this,t=function(t){e.rpe(t)},n=function(t){e.ope(t)},i=function(t){"Escape"!==t.key&&27!==t.keyCode||e.close(),"Enter"!==t.key&&13!==t.keyCode||e.submit()};this.Wc.bind("click",t),this.Wc.bind("change",n),document.addEventListener("keyup",i),r=this.bindMoveEvent(this.Wc[0].querySelector(".gc-sjs-paste-special-dialog-title")),this.wpt=function(){e.Wc.unbind("click",t),e.Wc.unbind("change",n),document.removeEventListener("keyup",i),r()}},y.prototype.close=function(){this.wpt&&this.wpt(),b.prototype.close.call(this)},y.prototype.ape=function(){var t,e,t,n,e;this.X2e&&(e=[(t=a.ClipboardPasteOptions).formatting,t.comments,t.validation],t=[t.all,t.noBorder],n=this.Wc[0].querySelectorAll("[name=".concat(v,"]")),e.includes(this.data.pasteOptions)?n.forEach(function(t){return t.disabled=!0}):n.forEach(function(t){return t.disabled=!1}),e=this.Wc[0].querySelector('[data-cmd="'.concat(p,'"]')),!t.includes(this.data.pasteOptions)||this.data.operationOptions!==a.PasteOperationOptions.none||this.data.skipBlanks||this.data.transpose?e.classList.add("disable"):e.classList.remove("disable"))},e.PasteSpecialDialog=y},"./dist/core/worksheet/style.js":function(F,t,e){"use strict";var a,o,s,u,S,c,r,i,e,f,w,l,b,C,h,d,e,v,g,m,p,y,M,k,n,_,A,L,D,j,O,V,Y,T,x,G,B,I,I,I;function K(t){var e,n,e={};return t&&t.option&&t.option.dataSource?(n=t.option.dataSource,t.option.dataSource=C,(e=w(t)).option.dataSource=n,t.option.dataSource=n):e=w(t),e}function P(t,e,n){this.color=t||"black",this.style=e||0,this.level=n}function z(t){return!(!t||"object"!=typeof t||t.patternColor||t.stops)}function W(t){return(!t||!t.stops)&&t&&t.type?{type:H(r.PatternType,t.type,C),patternColor:t.patternColor,backgroundColor:t.backgroundColor}:t}function R(t){return t?new T(t.color,H(V,t.style,C)):C}function J(t){var e,n,n,n;if(t){if(!(n=(e={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12",fileUpload:"19"})[t.type]))return ot(t,!0,void 0);if(n=c.ti[n])return(n=new n).Je(t),n}return t}function Z(t){return t?{alignment:H(r.LabelAlignment,t.alignment,C),visibility:H(r.LabelVisibility,t.visibility,C),font:t.font,foreColor:t.foreColor,margin:t.margin}:C}function Q(t){return t?{cornerFold:t.cornerFold,icons:t.icons&&0<t.icons.length?t.icons.map(function(t){return{src:t.src,width:t.width,height:t.height,position:H(r.IconPosition,t.position,C)}}):C}:C}function X(t){return t?t.map(function(t){return{position:H(r.ButtonPosition,t.position,C),useButtonStyle:t.useButtonStyle,enabled:t.enabled,width:t.width,caption:t.caption,imageSrc:t.imageSrc,imageSize:t.imageSize,captionAlign:H(r.CaptionAlignment,t.captionAlign,C),command:t.command,imageType:H(r.ButtonImageType,t.imageType,C),visibility:H(r.ButtonVisibility,t.visibility,C),hoverBackColor:t.hoverBackColor,buttonBackColor:t.buttonBackColor}}):C}function q(t){var e,n,n,n,i,i,n,i;if(t)return e=s.GC$.extend(!0,{},t),n=t.calendarPage,l(n)||(e.calendarPage=H(r.CalendarPage,n)),n=t.startDay,l(n)||(e.startDay=r.CalendarStartDay[n]),(n=t.layout)&&(i=n.direction,l(i)||(e.layout.direction=r.LayoutDirection[i]),i=n.displayAs,l(i)||(e.layout.displayAs=r.LayoutDisplayAs[i])),n=t.valueType,l(n)||(e.valueType=r.DropdownListValue[n]),i=t.direction,l(i)||(e.direction=r.LayoutDirection[i]),e}function $(t){return t?t.map(function(t){return{type:H(r.DropDownType,t.type,C),option:q(t.option),submitCommand:t.submitCommand}}):C}function tt(t){var t,t="lineThroughUnderline"===t?r.TextDecorationType.lineThrough|r.TextDecorationType.underline:"lineThroughDoubleUnderline"===t?r.TextDecorationType.lineThrough|r.TextDecorationType.doubleUnderline:H(r.TextDecorationType,t,r.TextDecorationType.none);return t}function et(t){var e,n,i,r,e=w(t.decoration);if(!l(e)&&!l(e.icons))for(e.icons=[],n=t.decoration.icons,i=0;i<n.length;i++)r=n[i],e.icons.push(w(r));return e}function nt(t,e){var n,i,r,o;for(l(t.decoration)&&(t.decoration={}),l(t.decoration.icons)&&(t.decoration.icons=[]),n=t.decoration.icons,i=e.decoration.icons,r=0;r<i.length;r++)o=i[r],n.push(w(o))}function N(n){var i;return n&&n instanceof Object?(i={},Object.keys(n).forEach(function(t){var e=n[t];l(e)||(e instanceof Array?i[t]=JSON.parse(JSON.stringify(e)):e instanceof Object?i[t]=N(e):i[t]=e)}),i):n}function E(){for(var t,e,n,i,r,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if((n=this)._id=E.l5,E.l5++,0!==t.length)if(i=t[0],1===t.length&&z(i))n.Je(i);else for(r=0;r<x.length&&r<t.length;r++)n[x[r]]=t[r]}function it(t,e){l(t.applyFill)||(e.applyFill=t.applyFill),l(t.applyFont)||(e.applyFont=t.applyFont),l(t.applyAlignment)||(e.applyAlignment=t.applyAlignment),l(t.applyBorder)||(e.applyBorder=t.applyBorder),l(t.applyProtection)||(e.applyProtection=t.applyProtection),l(t.applyNumberFormat)||(e.applyNumberFormat=t.applyNumberFormat)}function H(t,e,n){var i;if(n=n||C,!l(e)){if(!isNaN(e))return parseInt(e,10);i=t[e]}return l(i)?n:i}function rt(t,e,n,i){var e=ot(e,n,i);t.cellType=e}function ot(t,e,n){var i,r,e,o,e,i=t;if(e&&t){if(r=t.Ke&&t.Ke())return i;t.toJSON&&(t=t.toJSON()),e=c.ti,o=t.typeName,(e=e[t.type]||e[o]||u.getTypeFromString(o))?(i=new e).fromJSON(t,n):i=C}return i}function at(t,e,n,i){var r,o;if(e===h&&(t.cellButtons=e),e){if(r=e,n)for(r=[],o=0;o<e.length;o++)r.push(w(e[o]));t.cellButtons=r}}function st(t,e,n,i){var r;e===h&&(t.decoration=e),e&&(r=e,n&&(r=w(e),e.icons)&&0<e.icons.length&&(r.icons=e.icons.map(function(t){return w(t)})),t.decoration=r)}function ut(t,e,n,i){var r,o;if(e===h&&(t.dropDowns=e),e){if(r=a([],e,!0),n)for(r=[],o=0;o<e.length;o++)r.push(w(e[o]));t.dropDowns=r}}function ct(t,e,n){var i,n,n,r,r,i=e;n&&e&&"object"==typeof e&&(e.toJSON&&(e=e.toJSON()),n=(n=o.Formatter)&&n.GeneralFormatter)&&((r=e.typeName)?(r=u.getTypeFromString(r))&&(i=new r).fromJSON(e):i=new n(e.formatCached,e.customerCultureName)),t.formatter=i}function ft(t,e,n){var i,n,n,i=e;n&&e&&(e.toJSON&&(e=e.toJSON()),n=(n=o.Formatter)&&n.GeneralFormatter)&&((i=new n(e.formatCached,e.customerCultureName)).isAuto=!0),t._autoFormatter=i}function U(t,e,n){(e=e&&t.getColor(e))&&n(e)}function lt(t,e,n){return t===g?2===n||1===n?1===e:3===e:t===m?2===n||1===n?1===e:0===e:t===p?1===e:t===d&&e===C}function ht(t,e,n,i,r,o){for(var a,s,u,a=t.parentName;a&&a!==s&&(u=n.u8(a));)e.h5(u,i,r,o),a=u.parentName,s=u.name}a=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(t,"__esModule",{value:!0}),t.composeParentStyle=t.Style=t.LineBorder=t.LineBorderComposeLevel=t.LineStyle=void 0,o=e("Common"),s=e("./dist/core/util/domUtil.js"),u=e("./dist/core/util/common.js"),S=e("./dist/core/worksheet/stylehelper.js"),c=e("./dist/core/celltype/celltype.ns.js"),r=e("./dist/core/core.enum.js"),i=s.GC$.each,e=u.mt,f=e.T1,w=o.Common.lt.tv,l=o.Common.lt.ht,b=S.W.upe,d="autoFormatter",e="formatter",v="cellType",g="hAlign",m="vAlign",p="imeMode",y="labelOptions",M="cellButtons",k="dropDowns",n="applyFont",_="applyFill",A="applyAlignment",L="applyBorder",D="applyNumberFormat",j="applyProtection",O={borderLeft:!(h=null),borderRight:!(C=void 0),borderTop:!0,borderBottom:!0,borderHorizontal:!0,borderVertical:!0,diagonalDown:!0,diagonalUp:!0},(I=V=t.LineStyle||(t.LineStyle={}))[I.empty=0]="empty",I[I.thin=1]="thin",I[I.medium=2]="medium",I[I.dashed=3]="dashed",I[I.dotted=4]="dotted",I[I.thick=5]="thick",I[I.double=6]="double",I[I.hair=7]="hair",I[I.mediumDashed=8]="mediumDashed",I[I.dashDot=9]="dashDot",I[I.mediumDashDot=10]="mediumDashDot",I[I.dashDotDot=11]="dashDotDot",I[I.mediumDashDotDot=12]="mediumDashDotDot",I[I.slantedDashDot=13]="slantedDashDot",(I=Y=t.LineBorderComposeLevel||(t.LineBorderComposeLevel={}))[I.conditionalFormat=1]="conditionalFormat",I[I.cell=10]="cell",I[I.table=20]="table",I[I.row=30]="row",I[I.column=40]="column",I[I.sheet=50]="sheet",P.prototype.Gf=function(){return new P(this.color,this.style,this.level)},P.prototype.toJSON=function(){var t,e,n,e,t={},e=this,n=e.color,e=e.style;return"black"!==n&&(t.color=n),t.style=e,t},P.prototype.fromJSON=function(t,e){var n,i,t;t&&(n=this,i=t.color,t=t.style,f(i)&&(n.color=i),f(t))&&(n.style=t)},P.YC=function(t){var e,n,e,n;return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[t&&t.style]||0},T=P,t.LineBorder=T,x=["backColor","foreColor",g,m,"font","themeFont",e,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage",v,"backgroundImageLayout","tabStop","textDecoration",p,"name","parentName","watermark","cellPadding",y,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",M,k,"textOrientation","decoration","mask","fontStyle","fontWeight","fontSize","fontFamily","hidden","textDirection"],G=["_showTip","_fontVariant","_fontStretch","_lineHeight"],B=[n,_,A,L,D,j],E.xp=function(t,e){var n=t.parentName;n&&!e.getNamedStyle(n)&&delete t.parentName},E.prototype.compose=function(t,e,n,i,r){this.h5(t,e,n,i,r)},E.prototype.h5=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,e,o=this,v=t.labelOptions,g=t.cellButtons;if(t.cellButtons&&0<t.cellButtons.length)for(g=[],m=0;m<t.cellButtons.length;m++)g.push(w(t.cellButtons[m]));if(p=t.dropDowns,t.dropDowns&&0<t.dropDowns.length)for(p=[],m=0;m<t.dropDowns.length;m++)p.push(K(t.dropDowns[m]));e?(o._autoFormatter=t._autoFormatter,o.backgroundImage=t.backgroundImage,o.backgroundImageLayout=t.backgroundImageLayout,o.backColor=N(t.backColor),o.foreColor=t.foreColor,o.hAlign=t.hAlign,o.vAlign=t.vAlign,o._fontStyle=t._fontStyle,o._fontWeight=t._fontWeight,o._fontSize=t._fontSize,o._fontSizeDigit=t._fontSizeDigit,o._fontSizeUnit=t._fontSizeUnit,o._fontFamily=t._fontFamily,o._fontVariant=t._fontVariant,o._fontStretch=t._fontStretch,o._lineHeight=t._lineHeight,o._font=b(o._fontStyle,o._fontWeight,o._fontSize,o._fontFamily,o._fontVariant,o._fontStretch,o._lineHeight),o.themeFont=t.themeFont,o.formatter=t.formatter,o.mask=N(t.mask),o.showEllipsis=t.showEllipsis,o._showTip=t._showTip,a=t.borderLeft,o.borderLeft=a&&a.Gf&&a.Gf()||a,o.borderLeft&&n&&(o.borderLeft.level=n),s=t.borderTop,o.borderTop=s&&s.Gf&&s.Gf()||s,o.borderTop&&n&&(o.borderTop.level=n),u=t.borderRight,o.borderRight=u&&u.Gf&&u.Gf()||u,o.borderRight&&n&&(o.borderRight.level=n),c=t.borderBottom,o.borderBottom=c&&c.Gf&&c.Gf()||c,o.borderBottom&&n&&(o.borderBottom.level=n),h=t.borderHorizontal,o.borderHorizontal=h&&h.Gf&&h.Gf()||h,o.borderHorizontal&&n&&(o.borderHorizontal.level=n),d=t.borderVertical,o.borderVertical=d&&d.Gf&&d.Gf()||d,o.borderVertical&&n&&(o.borderVertical.level=n),f=t.diagonalDown,o.diagonalDown=f&&f.Gf&&f.Gf()||f,o.diagonalDown&&n&&(o.diagonalDown.level=n),l=t.diagonalUp,o.diagonalUp=l&&l.Gf&&l.Gf()||l,o.diagonalUp&&n&&(o.diagonalUp.level=n),o.locked=t.locked,o.hidden=t.hidden,o.textIndent=t.textIndent,o.wordWrap=t.wordWrap,o.shrinkToFit=t.shrinkToFit,o.cellType=t.cellType,o.name=t.name,o.parentName=t.parentName,o.tabStop=t.tabStop,o.textDecoration=t.textDecoration,o.imeMode=t.imeMode,o.watermark=t.watermark,o.cellPadding=t.cellPadding,o.isVerticalText=t.isVerticalText,o.textOrientation=t.textOrientation,v&&(o.labelOptions={alignment:v.alignment,font:v.font,foreColor:v.foreColor,visibility:v.visibility,margin:v.margin}),o.quotePrefix=t.quotePrefix,o.cellButtons=g,o.dropDowns=p,o.decoration=et(t),o.textDirection=t.textDirection):(o.backgroundImage===C&&(o.backgroundImage=t.backgroundImage),o.backgroundImageLayout===C&&(o.backgroundImageLayout=t.backgroundImageLayout),o.backColor===C&&(o.backColor=N(t.backColor)),o.foreColor===C&&(o.foreColor=t.foreColor),o.hAlign===C&&(o.hAlign=t.hAlign),o.vAlign===C&&(o.vAlign=t.vAlign),o.themeFont===C&&o.font===C&&(o.themeFont=t.themeFont),o._fontStyle===C&&(o._fontStyle=t._fontStyle),o._fontWeight===C&&(o._fontWeight=t._fontWeight),o._fontSize===C&&(o._fontSize=t._fontSize,o._fontSizeDigit=t._fontSizeDigit,o._fontSizeUnit=t._fontSizeUnit),o._fontFamily===C&&(o._fontFamily=t._fontFamily),o._fontVariant===C&&(o._fontVariant=t._fontVariant),o._fontStretch===C&&(o._fontStretch=t._fontStretch),o._lineHeight===C&&(o._lineHeight=t._lineHeight),o._font=b(o._fontStyle,o._fontWeight,o._fontSize,o._fontFamily,o._fontVariant,o._fontStretch,o._lineHeight),o.formatter===C&&(o.formatter=t.formatter),o.showEllipsis===C&&(o.showEllipsis=t.showEllipsis),o._showTip===C&&(o._showTip=t._showTip),o._autoFormatter===C&&(o._autoFormatter=t._autoFormatter),o.mask===C&&(o.mask=N(t.mask)),o.borderLeft===C&&(a=t.borderLeft,o.borderLeft=a&&a.Gf&&a.Gf()||a,o.borderLeft)&&n&&(o.borderLeft.level=n),o.borderTop===C&&(s=t.borderTop,o.borderTop=s&&s.Gf&&s.Gf()||s,o.borderTop)&&n&&(o.borderTop.level=n),o.borderRight===C&&(u=t.borderRight,o.borderRight=u&&u.Gf&&u.Gf()||u,o.borderRight)&&n&&(o.borderRight.level=n),o.borderBottom===C&&(c=t.borderBottom,o.borderBottom=c&&c.Gf&&c.Gf()||c,o.borderBottom)&&n&&(o.borderBottom.level=n),o.borderHorizontal===C&&(h=t.borderHorizontal,o.borderHorizontal=h&&h.Gf&&h.Gf()||h,o.borderHorizontal)&&n&&(o.borderHorizontal.level=n),o.borderVertical===C&&(d=t.borderVertical,o.borderVertical=d&&d.Gf&&d.Gf()||d,o.borderVertical)&&n&&(o.borderVertical.level=n),o.diagonalDown===C&&(f=t.diagonalDown,o.diagonalDown=f&&f.Gf&&f.Gf()||f,o.diagonalDown)&&n&&(o.diagonalDown.level=n),o.diagonalUp===C&&(l=t.diagonalUp,o.diagonalUp=l&&l.Gf&&l.Gf()||l,o.diagonalUp)&&n&&(o.diagonalUp.level=n),o.locked===C&&(o.locked=t.locked),o.hidden===C&&(o.hidden=t.hidden),o.textIndent===C&&(o.textIndent=t.textIndent),o.wordWrap===C&&(o.wordWrap=t.wordWrap),o.shrinkToFit===C&&(o.shrinkToFit=t.shrinkToFit),o.cellType===C&&(o.cellType=t.cellType),o.tabStop===C&&(o.tabStop=t.tabStop),o.textDecoration===C&&(o.textDecoration=t.textDecoration),o.imeMode===C&&(o.imeMode=t.imeMode),o.name===C&&(o.name=t.name),o.parentName===C&&(o.parentName=t.parentName),o.watermark===C&&(o.watermark=t.watermark),o.cellPadding===C&&(o.cellPadding=t.cellPadding),!o.labelOptions&&v&&(o.labelOptions={}),(e=o.labelOptions)&&v&&(e.alignment===C&&(e.alignment=v.alignment),e.font===C&&(e.font=v.font),e.foreColor===C&&(e.foreColor=v.foreColor),e.visibility===C&&(e.visibility=v.visibility),e.margin===C)&&(e.margin=v.margin),i||o.quotePrefix!==C||(o.quotePrefix=t.quotePrefix),o.isVerticalText===C&&(o.isVerticalText=t.isVerticalText),o.textOrientation===C&&(o.textOrientation=t.textOrientation),o.cellButtons===C&&(o.cellButtons=g),o.dropDowns===C&&(o.dropDowns=p),o.decoration===C?o.decoration=et(t):r&&S.W.Xue(t)&&nt(o,t),o.textDirection===C&&(o.textDirection=t.textDirection))},E.prototype.d5=function(t){var n=this;0===arguments.length?(i(x,function(t,e){n[e]=C}),i(G,function(t,e){n[e]=C}),i(B,function(t,e){f(n[e])&&(n[e]=C)})):n[t]=C},E.prototype.clone=function(t){var e,n,i,r,o,a,s,u,c,f,e=this,n=e.borderLeft,i=e.borderTop,r=e.borderRight,o=e.borderBottom,a=e.diagonalDown,s=e.diagonalUp,u=e.borderHorizontal,c=e.borderVertical,f=new E;return f.backColor=N(e.backColor),f.foreColor=e.foreColor,f.hAlign=e.hAlign,f.vAlign=e.vAlign,f._fontStyle=e._fontStyle,f._fontWeight=e._fontWeight,f._fontSize=e._fontSize,f._fontSizeDigit=e._fontSizeDigit,f._fontSizeUnit=e._fontSizeUnit,f._fontFamily=e._fontFamily,f._fontVariant=e._fontVariant,f._fontStretch=e._fontStretch,f._lineHeight=e._lineHeight,f._font=b(f._fontStyle,f._fontWeight,f._fontSize,f._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight),f.themeFont=e.themeFont,f.formatter=C,f.mask=N(e.mask),f.borderLeft=n&&!t&&n.Gf&&n.Gf()||n,f.borderTop=i&&!t&&i.Gf&&i.Gf()||i,f.borderRight=r&&!t&&r.Gf&&r.Gf()||r,f.borderBottom=o&&!t&&o.Gf&&o.Gf()||o,f.borderHorizontal=u&&!t&&u.Gf&&u.Gf()||u,f.borderVertical=c&&!t&&c.Gf&&c.Gf()||c,f.locked=e.locked,f.hidden=e.hidden,f.textIndent=e.textIndent,f.wordWrap=e.wordWrap,f.shrinkToFit=e.shrinkToFit,f.backgroundImage=e.backgroundImage,f.cellType=C,f.backgroundImageLayout=e.backgroundImageLayout,f.tabStop=e.tabStop,f.textDecoration=e.textDecoration,f.imeMode=e.imeMode,f.name=e.name,f.parentName=e.parentName,f.watermark=e.watermark,f.cellPadding=e.cellPadding,f.labelOptions=e.labelOptions,f.quotePrefix=e.quotePrefix,f.diagonalDown=a&&!t&&a.Gf()||a,f.diagonalUp=s&&!t&&s.Gf()||s,f.isVerticalText=e.isVerticalText,f.showEllipsis=e.showEllipsis,f._showTip=e._showTip,f.textOrientation=e.textOrientation,st(f,e.decoration,!t,!0),it(e,f),ct(f,e.formatter,!t),ft(f,e._autoFormatter,!t),rt(f,e.cellType,!t,!0),at(f,e.cellButtons,!t,!0),ut(f,e.dropDowns,!t,!0),f.textDirection=e.textDirection,f},E.prototype.v5=function(i){var e,n,t,r,o,a,s,u,c,e=this;if(i&&i.getColor){if(U(i,e.foreColor,function(t){e.foreColor=t}),"string"==typeof(n=e.backColor))U(i,n,function(t){e.backColor=t});else if(n&&(n.backgroundColor&&U(i,n.backgroundColor,function(t){n.backgroundColor=t}),n.patternColor&&U(i,n.patternColor,function(t){n.patternColor=t}),n.stops))for(t=function(e){U(i,n.stops[e].color,function(t){n.stops[e].color=t})},r=0;r<n.stops.length;r++)t(r);for(a=function(t,e){var n=o[t];n&&n.color&&U(i,n.color,function(t){n.color=t})},r=0,s=(o=[e.borderLeft,e.borderTop,e.borderRight,e.borderBottom,e.borderHorizontal,e.borderVertical,e.diagonalDown,e.diagonalUp]).length;r<s;r++)a(r,s)}if(u=e.themeFont,i&&i.getFont){if(c=void 0,!(c=u?i.getFont(u):e._fontFamily||i.bodyFont()))return e;e._fontFamily=c,e._fontSize||(e._fontSize=S.hpe),e._font=b(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight)}return e},E.prototype.g5=function(t){var e,n,n,e=this,n=e._autoFormatter;n&&t!==h&&((n=n.getPreferredEditingFormatter(t)).isAuto=!0,e._autoFormatter=n)},E.prototype.toJSON=function(t,e){var n,i,r,o,a,n=this,i={},r=n._autoFormatter;for(!f(r)||e&&lt(d,r,t)||(r.toJSON&&(r=r.toJSON()),s.GC$.isEmptyObject(r))||(i[d]=r),o=0;o<x.length;o++)r=n[a=x[o]],a!==y||s.GC$.isEmptyObject(r)?a!==k&&a!==M||s.GC$.isEmptyObject(r)?!f(r)||e&&lt(a,r,t)||(i[a]=r&&r.toJSON?r.toJSON():r):i[a]=r:i[y]=r;for(o=0;o<G.length;o++)r=n[a=B[o]],f(r)&&(i[a]=r);for(o=0;o<B.length;o++)r=n[a=B[o]],f(r)&&(i[a]=r);return s.GC$.isEmptyObject(i)?C:i},E.prototype.fromJSON=function(t,e,n){var i,r,o,a,a;if(t)for(r in i=this,t)t.hasOwnProperty(r)&&(o=t[r],f(o))&&((a={p:r,v:o,r:!1}).noSchema=e,a.context=n,E.et(i,"fromJson",a),a.r||("formatter"===r?ct(i,o,!0):"autoFormatter"===r?ft(i,o,!0):r===v?rt(i,o,!0,e):O[r]?o===h?i[r]=null:((a=new T).fromJSON(o,e),i[r]=a):i[r]=o))},E.prototype.Je=function(t){var e=this;e.backColor=W(t.backColor),e.foreColor=t.foreColor,e.hAlign=H(r.HorizontalAlign,t.hAlign,C),e.vAlign=H(r.VerticalAlign,t.vAlign,C),t.font?e.font=t.font:(e._fontStyle=t.fontStyle,e._fontWeight=t.fontWeight,e._fontSize=t.fontSize,e._fontFamily=t.fontFamily,e._fontVariant=t.fontVariant,e._fontStretch=t.fontStretch,e._lineHeight=t.lineHeight,e._font=b(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight)),e.themeFont=t.themeFont,e.formatter=t.formatter,e.borderLeft=R(t.borderLeft),e.borderTop=R(t.borderTop),e.borderRight=R(t.borderRight),e.borderBottom=R(t.borderBottom),e.borderHorizontal=R(t.borderHorizontal),e.borderVertical=R(t.borderVertical),e.diagonalDown=R(t.diagonalDown),e.diagonalUp=R(t.diagonalUp),e.locked=t.locked,e.hidden=t.hidden,e.textIndent=t.textIndent,e.wordWrap=t.wordWrap,e.shrinkToFit=t.shrinkToFit,e._showTip=t._showTip,e.backgroundImage=t.backgroundImage,e.cellType=J(t.cellType),e.backgroundImageLayout=H(r.ImageLayout,t.backgroundImageLayout,C),e.tabStop=t.tabStop,e.textDecoration=tt(t.textDecoration),e.imeMode=H(r.ImeMode,t.imeMode,C),e.name=t.name,e.parentName=t.parentName,e.watermark=t.watermark,e.cellPadding=t.cellPadding,e.labelOptions=Z(t.labelOptions),e.isVerticalText=t.isVerticalText,e.textOrientation=t.textOrientation,e.showEllipsis=t.showEllipsis,e.cellButtons=X(t.cellButtons),e.dropDowns=$(t.dropDowns),e.decoration=Q(t.decoration),e.mask=N(t.mask),e.textDirection=t.textDirection,it(t,e)},Object.defineProperty(E.prototype,"font",{get:function(){return this._font},set:function(t){S.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){S.W.dpe(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){var e=this,n;e._fontStyle!==t&&(e._fontStyle=t,e._font=b(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight))},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){var e=this,n;e._fontWeight!==t&&(e._fontWeight=t,e._font=b(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight))},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){var e=this,n;e._fontFamily!==t&&(e._fontFamily=t,e._font=b(e._fontStyle,e._fontWeight,e._fontSize,e._fontFamily,e._fontVariant,e._fontStretch,e._lineHeight))},enumerable:!1,configurable:!0}),I=E,t.Style=I,t.composeParentStyle=ht,u.$e(I),I.l5=0},"./dist/core/worksheet/stylehelper.js":function(t,o,e){"use strict";var a,h,i,d,v,n,b,C,g,m,y,r,p,S,w,M,k,T,x,G,s;function u(t){return t=v(t=t||0,0),t=n(t,1)}function B(t){var e,n;return t===b?b:null!==t&&(t=(n=(e=t.split(" ")).filter(function(t){return t&&t!==y})).join(" "))||y}function I(){}Object.defineProperty(o,"__esModule",{value:!0}),o.W=o.hpe=o.p5=void 0,a=e("./dist/core/util/domUtil.js"),h=e("./dist/core/util/common.js"),i=e("./dist/core/core.enum.js"),d=document,v=Math.max,n=Math.min,b=void 0,C=null,g="#FFFFFF",m="#000000",y="normal",r=" ",p=Math.abs,S=Math.PI,w=Math.cos,M=Math.sin,k=Math.atan,T=Math.tan,x=/^(small-caps|all-small-caps|all-petite-caps|petite-caps|unicase|titling-caps|historical-forms|common-ligatures|no-common-ligatures|discretionary-ligatures|no-discretionary-ligatures|historical-ligatures|no-historical-ligatures|contextual|no-contextual|lining-nums|oldstyle-nums|proportional-nums|tabular-nums|diagonal-fractions|stacked-fractions|jis78|jis83|jis90|jis04|simplified|traditional|full-width|proportional-width|stylistic\([\d\.]+\)|styleset\([\d\.]+\)|character-variant\([\d\.]+\)|swash\([\d\.]+\)|ornaments\([\d\.]+\)|annotation\([\d\.]+\)|ruby|sub|super|text|emoji|unicode|ordinal|slashed-zero)$/i,o.p5="11pt",o.hpe="14.6667px",G={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},I.vpe=function(t){var e,e,i,r,o,a,s,u,c,f,l,h,d,v,n,g,m,p,S,w,e;if(I.mpe[t])return I.mpe[t];if((e=I.y5()).style.font=t,e=e.style,d=h=l=f=c=u=s=a=o=r=i=b,""===e.fontStyle||""===e.fontWeight||e.fontStyle===y||e.fontWeight===y){for(v=0,g=(t=t.replace(/"/g,"'")).length,m=!(n=[]),p="",S=0;S<g;S++)"'"===(w=t[S])?(p+=w,!1===(m=!m)&&(n.push(p),p="")):!m&&" "===w?(n.push(p),p=""):p+=w;0!==p.length&&n.push(p),n.forEach(function(t,e){var n;/^(italic|oblique)$/i.test(t)?(i=t,f=e):/^[\d\.]+deg$/i.test(t)&&"oblique"===i?(i+=" "+t,f=e):x.test(t)?u===b?u=t:u+=" "+t:/(condensed|expanded)$/i.test(t)||/^[\d\.]+%$/i.test(t)?c=t:/^(bold|bolder|lighter|[1-9]00)$/i.test(t)?(r=t,l=e):/^[\d\.]+(px|em|rem|%|pt)\/([\d\.]+(px|em|rem|%|pt)|normal)$/.test(t)?(n=t.split("/"),o=n[0],s=n[1],h=e):/^[\d\.]+(px|em|rem|%|pt)$/.test(t)?(o=t,h=e):t===y?v++:t&&(a===b?a=t:a+=" "+t,d=e)}),i!==b&&(h<=f||d<=f)&&(i=b),r!==b&&(h<=l||d<=l)&&(r=b),1<=v&&(i===b&&(i=C),r===b)&&(r=C)}else i=e.fontStyle,r=e.fontWeight;return e={fontStyle:i,fontWeight:r,fontSize:e.fontSize||o,fontFamily:e.fontFamily?e.fontFamily.replace(/"/g,"'"):a,lineHeight:(e.lineHeight===y?b:e.lineHeight)||s,fontVariant:(B(e.fontVariant)===y?b:e.fontVariant)||B(u),fontStretch:(e.fontStretch===y?b:e.fontStretch)||c},I.mpe[t]=e},I.gpe=function(t){var e,n,e;return t&&(I.aCe[t]||(e=t.split(","),n=[],e.forEach(function(t){t&&("'"!==(t=t.trim())[0]&&'"'!==t[0]&&0<t.indexOf(" ")?n.push("'"+t+"'"):n.push(t))}),e=n.join(", "),I.aCe[t]=e))},I.upe=function(t,e,n,i,r,o,a){var s,u,t,s=t+","+r+","+e+","+o+","+n+","+a+","+i;return I.ppe[s]||(u="",t===b&&e===b&&n===b&&i===b?I.ppe[s]=b:t===C&&e===C&&n===C&&i===C?I.ppe[s]=C:(t===C?u+=y:t!==b&&(u+=t),t=u[u.length-1]&&" "!==u[u.length-1]?" ":"",r!==b&&(u+=t+r),t=u[u.length-1]&&" "!==u[u.length-1]?" ":"",e===C?u+=t+y:e!==b&&(u+=t+e),t=u[u.length-1]&&" "!==u[u.length-1]?" ":"",o!==b&&(u+=t+o),t=u[u.length-1]&&" "!==u[u.length-1]?" ":"",n!==b&&(u+=t+n),t=u[u.length-1]&&" "!==u[u.length-1]?" ":"",a!==b&&(u+=t+"/"+t+a),t=u[u.length-1]&&" "!==u[u.length-1]?" ":"",i!==b&&(u+=t+(i=I.gpe(i))),I.ppe[s]=u))},I.oce=function(t,e){var t,n,i,r,t=t,n;t._font!==e&&(e?(i=I.vpe(e),t._fontStyle=i.fontStyle===y?C:i.fontStyle,t._fontWeight=i.fontWeight===y?C:i.fontWeight,t._fontSize=i.fontSize,i.fontSize?(r=i.fontSize.match(/^([\d\.]+)(px|em|rem|%|pt)$/),t._fontSizeDigit=r&&+r[1],t._fontSizeUnit=r&&r[2]):(t._fontSizeDigit=b,t._fontSizeUnit=b),t._fontFamily=i.fontFamily,t._fontVariant=i.fontVariant,t._fontStretch=i.fontStretch,t._lineHeight=i.lineHeight,t._font=I.upe(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight)):(t._fontStyle=e,t._fontWeight=e,t._fontSize=e,t._fontSizeDigit=b,t._fontSizeUnit=b,t._fontFamily=e,t._fontVariant=b,t._fontStretch=b,t._lineHeight=b,t._font=e))},I.dpe=function(t,e){var t,n,i,t=t,n;t._fontSize!==e&&(i=void 0,(i=e?e.match(/^([\d\.]+)(px|em|rem|%|pt)$/):i)?(t._fontSizeDigit=+i[1],t._fontSizeUnit=i[2]):(t._fontSizeDigit=b,t._fontSizeUnit=b),t._fontSize=e,t._font=I.upe(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight))},I.NHe=function(t){var t=I.vpe(t).fontStyle;return"italic"===t||"oblique"===t},I.m5=function(t,e){return e?I.b5(t,e):t},I.Ne=function(t){var e,e;return t?((e=I.y5()).style.font=t,e=e.style,"object"==typeof global&&(0<=t.indexOf("italic")&&(e.fontStyle="italic"),""===e.fontStyle&&(e.fontStyle=y),""===e.fontWeight)&&(e.fontWeight=y),{fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight}):{}},I.f5=function(t){var e,n,i,r,o,a,s,u,c,t;return h.mt.Tt.safari?t.font:(e="",n="400",i="11pt",r="Calibri",o=t.fontStyle,a=B(t.fontVariant),s=t.fontWeight,u=t.lineHeight,c=t.fontSize,t=t.fontFamily,o&&o!==y&&(e=o),a&&a!==y&&(e+=(e?" ":"")+a),s&&s!==y&&s!==n&&(e+=(e?" ":"")+s),e+=(e?" ":"")+(c=c||i),u&&u!==y&&(e+="/"+u),e+(" "+(t=t||r)))},I.b5=function(t,e){var n,i,r,t,e;if(!t&&!e)return t;if(t){if(r=I.w5[i=e?t+"+"+e:t])return r;n=I.y5(),(0,a.GC$)(n).css("font",t)}else{if(r=I.w5[i=e])return r;n=I.y5(),(0,a.GC$)(n).css("fontSize",o.p5)}return e&&(0,a.GC$)(n).css("fontFamily",e),t=n.currentStyle,(e=d.defaultView)&&e.getComputedStyle&&(t=e.getComputedStyle(n,"")),r=I.f5(t),I.w5[i]=r,I.w5[r]=r},I.V=function(t,e,n,i){var r,o,a,s,u,u,c,f,n,l,r=I.C5[e];if(!i)if(r){if(o=r[t])return o}else r=I.C5[e]={};return(a=I.y5()).style.font=t,s=a.currentStyle,-1!==(u=(s=(u=d.defaultView)&&u.getComputedStyle?u.getComputedStyle(a,""):s).fontSize||a.style.fontSize).indexOf(c="px")?(f=v(1,parseFloat(u.replace(c,""))*e),n&&1===f&&(n.value=!0),u=f+c):-1!==u.indexOf("pt")&&(f=h.SJSColumnWidthHelper.pointToPixel(v(1,parseFloat(u.replace("pt",""))*e),4),n&&1===f&&(n.value=!0),u=f+c),-1!==(n=s.lineHeight).indexOf(c)&&(n=(l=v(1,parseFloat(n.replace(c,""))*e))+c),o=1===e?{font:t,fontFamily:a.style.fontFamily,fontSize:f}:(a.style.fontSize=u,a.style.lineHeight=n,{font:a.style.font,fontFamily:a.style.fontFamily,fontSize:f}),i||(r[t]=o),o},I.mpe={},I.ppe={},I.aCe={},I.Lge=function(t,e,n,i){var r,o,a,s,u,s;if(t){if(r=I.C5[e],a=t.font,!i)if(r){if(o=r[a])return o}else r=I.C5[e]={};return s=t._fontSizeDigit,u=t._fontSizeUnit,o=s&&u&&!u.includes("em")&&!u.includes("rem")?(s=v(1,s*e),n&&1===s&&(n.value=!0),"pt"===t._fontSizeUnit&&(s=h.SJSColumnWidthHelper.pointToPixel(s,4),u="px"),{font:I.upe(t.fontStyle,t.fontWeight,s+u,t.fontFamily,t._fontVariant,t._fontStretch,t._lineHeight),fontFamily:t.fontFamily,fontSize:s}):I.V(a,e,n,!0),i||(r[a]=o),o}},I.y5=function(){var t,e,n;if(I.S5)I.S5.style.cssText=I.T5;else{if(t="-10000px",(n=(e=h.mt.En("span")).style).visibility="hidden",n.top=t,n.left=t,n.lineHeight=y,n.position="absolute",n.fontWeight=y,n.fontStretch=y,n.fontVariant=y,n.fontStyle=y,!d.body)return e;d.body.insertBefore(e,null),I.S5=e,I.T5=n.cssText}return I.S5},I.L0=function(){var t=I.S5;t&&((0,a.GC$)(t).remove(),I.S5=b,I.T5=b)},I.stringFontCatch={},I.ii=function(t,e){var n,i,r,o,n=t+","+e,i=I.stringFontCatch,r=i[n];return r||((o=I.y5()).style.font=t,e&&(o.style.fontWeight=e),r=i[n]=o.style.font),r},I.w5={},I.C5={},I.A5=function(t){var e;return t<=0?"none":(e="",(1|t)===t&&(e+="underline "),(2|t)===t&&(e+="line-through "),(4|t)===t&&(e+="overline "),e.trim())},I.setFillStyle=function(t,e,n,i,r,o,a){"string"==typeof e?(t.fillStyle!==e&&(t.fillStyle=e),a()):"path"===e.type?I.setFillStylePath(t,e,n,i,r,o,a):e.stops?I.setFillStyleGradient(t,e,n,i,r,o,a):e.type&&I.setFillStylepatternFill(t,e,n,i,r,o,a)},I.setFillStylepatternFill=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,e,s=G[e.type],u=s.length,c=s[0].length,f=document.createElement("canvas");for(f.width=c,f.height=u,(l=f.getContext("2d")).fillStyle=e.backgroundColor||g,l.fillRect(0,0,c,u),l.fillStyle=e.patternColor||m,h=0;h<u;h++)for(d=0;d<c;d++)(v=s[h][d])&&l.fillRect(d,h,1,1);t.createPattern(f,"repeat"),e=t.createPattern(f,"repeat"),t.fillStyle=e,a()},I.processStops=function(t){var e,n;if(t.stops||"path"===t.type){if(e=t.stops)if(0===e.length)e=[{position:0,color:m},{position:1,color:m}];else{for((e=e.filter(function(t,e,n){return t.position<=1&&0<=t.position})).sort(function(t,e){return t.position-e.position}),n=0;n<e.length;n++)e[n].color=e[n].color||m;0!==e[0].position&&e.splice(0,0,{position:0,color:m}),1!==e[e.length-1].position&&e.push({position:1,color:m})}else e=[{position:0,color:g},{position:1,color:g}];t.stops=e}"path"===t.type?(t.left=u(t.left),t.right=u(t.right),t.top=u(t.top),t.bottom=u(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},I.setFillStyleGradient=function(t,e,n,i,r,o,a){var s,u,c,f,s,l,h,d,s=e.degree||0;for(s%90==0?(c=s/180*S,f=p(s%180/180*S)-k(o/r)):(c=k(r/o*T(s/180*S)),f=p(c)-k(o/r),c=Math.round(s/180)*S+c),s=Math.sqrt(r*r+o*o)/2,u=t.createLinearGradient(n+r/2-s*w(f)*w(c),i+o/2-s*w(f)*M(c),n+r/2+s*w(f)*w(c),i+o/2+s*w(f)*M(c)),h=0,d=(l=e.stops).length;h<d;h++)u.addColorStop(l[h].position,l[h].color||g);t.fillStyle=u,a()},I.setFillStylePath=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,s=e.left||0,u=e.right||0,c=e.top||0,f=e.bottom||0,l=e.stops;if(u<s&&(u=s),f<c&&(f=c),0<s){for(t.save(),t.beginPath(),h=t.createLinearGradient(n+r*s,0,n,0),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||g);t.fillStyle=h,t.moveTo(n,i-1),t.lineTo(n+r*s+1,i+o*c),t.lineTo(n+r*s+1,i+o*f),t.lineTo(n,i+o+1),t.clip(),a(),t.restore()}if(u<1){for(t.save(),t.beginPath(),h=t.createLinearGradient(n+r*u,0,n+r,0),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||g);t.fillStyle=h,t.moveTo(n+r,i-1),t.lineTo(n+r,i+o+1),t.lineTo(n+r*u-1,i+o*f),t.lineTo(n+r*u-1,i+o*c),t.clip(),a(),t.restore()}if(0<c){for(t.save(),t.beginPath(),h=t.createLinearGradient(0,i+o*c,0,i),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||g);t.fillStyle=h,t.moveTo(n,i),t.lineTo(n+r,i),t.lineTo(n+r*u,i+o*c+1),t.lineTo(n+r*s,i+o*c+1),t.clip(),a(),t.restore()}if(f<1){for(t.save(),t.beginPath(),h=t.createLinearGradient(0,i+o*f,0,i+o),d=0,v=l.length;d<v;d++)h.addColorStop(l[d].position,l[d].color||g);t.fillStyle=h,t.moveTo(n+r,i+o),t.lineTo(n,i+o),t.lineTo(n+r*s,i+o*f-1),t.lineTo(n+r*u,i+o*f-1),t.clip(),a(),t.restore()}s<u&&c<f&&(t.save(),t.beginPath(),t.fillStyle=l[0].color,t.rect(n+r*s,i+o*c,r*(u-s),o*(f-c)),t.clip(),a(),t.restore())},I.Xue=function(t){var e;return(null==(e=null==t?void 0:t.decoration)?void 0:e.icons)&&0<t.decoration.icons.length},I.bpe=function(t){return(null==t?void 0:t.cellButtons)&&0<t.cellButtons.length},I.Hge=function(t){return I.gfe(t,i.IconPosition.leftOfText)||I.gfe(t,i.IconPosition.rightOfText)},I.gfe=function(t,e){var n=e===i.IconPosition.left;return I.Xue(t)&&t.decoration.icons.some(function(t){return n?t.position===i.IconPosition.left||t.position===C||t.position===b:t.position===e})},I.Vge=function(t){return I.wpe(t,i.IconPosition.leftOfText)||I.wpe(t,i.IconPosition.rightOfText)},I.wpe=function(t,e){var n=e===i.ButtonPosition.left;return I.bpe(t)&&t.cellButtons.some(function(t){return n?t.position===i.ButtonPosition.left||t.position===C||t.position===b:t.position===e})},I.Jue=function(t){return I.Xue(t)&&t.decoration.icons.some(function(t){return I.Kue(t)})},I.Kue=function(t){return t.position===C||t.position===b||t.position===i.IconPosition.left||t.position===i.IconPosition.leftOfText||t.position===i.IconPosition.right||t.position===i.IconPosition.rightOfText},o.W=I},"./dist/core/worksheet/worksheet-actions.js":function(p,t,e){"use strict";var n,S,i,d,A,b,k,r,T,L,D,u,j,O,r,x,G,V,Y,K,z,w,C,y,M,B,W,e,I,P,J,Z,Q,X,i,q,R,$,tt,et,nt,it,rt,ot,at,st,ut,ct,ft,lt,ht,dt,vt,gt,mt,pt,St,wt,bt,Ct,yt,Mt,kt,Tt,xt,Gt,Bt,It,Pt,Rt,Nt,Et,Ht,Ut,Ft,_t,At,Lt,Dt,jt,Ot,Vt,Yt,Kt,zt,Wt,Jt,Zt,Qt,Xt,qt,$t,te,ee,ne,ie,re,oe,ae,se,ue,s,ce,fe,le,he,de,ve,ge,me,i,pe,Se,we,be,Ce,ye,Me,ke,Te,xe,Ge,Be,Ie,Pe,Re,Ne,Ee,He,Ue,Fe;function N(t,e){return t.getRowCount(e)}function E(t,e){return t.getColumnCount(e)}function H(t){return t.rowCount}function U(t){return t.colCount}function _e(t){var t=t.parent;return t&&t.options.allowCopyPasteExcelStyle}function Ae(t){var t=t.parent;return t&&t.options.copyPasteHeaderOptions}function Le(t,e,n,i){throw new Error(Y.I5(q().Exp_InvalidAndSpace,[t,e,n,i]))}function De(t){t.suspendPaint()}function F(t){t.resumePaint()}function je(t){t.suspendEvent()}function _(t){t.resumeEvent()}function Oe(t,e){t&&x&&t.suspendCalcService(e)}function Ve(t,e){t&&x&&t.resumeCalcService(e)}function Ye(t,e,n,i,r){var i=t.getSpan(e,n,i);return!(!(i&&r&&t.getRowVisible(i.row)&&t.getColumnVisible(i.col))||i.row===e&&i.col===n)}function Ke(t){var e=this;e.x5=1==(1&t),e.N5=2==(2&t),e.k5=8==(8&t),e.D5=x&&16==(16&t),e._5=!0,e.E5=!0}function ze(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,r,r;if(G(t)||""===t)return I;for(!G(e)&&""!==e||(e="\r\n"),a="\n",!G(n)&&""!==n||(n="\t"),!G(i)&&""!==i||(i='"'),K(t,e)||(t+=e),s=!r,u=[],f="",h=!(c=[]),d=i.length,v=e.length,g=a.length,m=n.length,p=t.length,S=0;S<p;S++)l=(f+=t[S]).length,s&&(l===d&&i===f||d<l&&i===f.substr(l-d,d))?h&&S+1+d<=p&&i===t.substr(S+1,d)?S+=d:h?(f=f.substr(0,l-d),h=!1):0===f.indexOf(i)&&(f=f.substr(0,l-d),h=!0):!h&&(l===m&&n===f||m<l&&n===f.substr(l-m,m))?(f=f.substr(0,l-m),c.push(f),f=""):!h&&(l===v&&e===f||v<l&&e===f.substr(l-v,v))?(f=f.substr(0,l-v),c.push(f),u.push(c),c=[],f=""):!h&&(l===g&&a===f||g<l&&a===f.substr(l-g,g))?(f=f.substr(0,l-g),c.push(f),u.push(c),c=[],f=""):h&&S+1+m<=p&&n===t.substr(S+1,m)&&","!==n&&(S+=d);if(h){if(0<c.length){for(b=void 0,b=0;b<u.length&&u[b]!==c;b++);u.length<=b&&u.push(c)}(r=f.toString())&&(r=r.replace(new RegExp(n,"g"),""),K(r,e)&&(r=r.substr(0,r.length-v)),0===u.length)&&u.push([r])}return 0===u.length&&(K(r=t,e)&&(r=r.substr(0,r.length-v)),u.push([r])),o&&We(u)&&/^(\s)*$/.test(t)&&t.substr(t.length-g,g)===a&&u.push([""]),u}function We(t){var e,n;if(t){for(e=0;e<t.length&&((n=t[e])&&1===n.length);e++);if(e===t.length)return 1}}function Je(t,e,n,i,r){var o,a,s,u,c,r,f,l,h,d,v,o=i.length,a=Xe(i);if(0!==o&&0!==a)for(s=new Ke(r),t&&(E(t,2)<=0&&(s.x5=!1),N(t,1)<=0)&&(s.N5=!1),(a-=u=s.x5?E(t,2):0)<=(r=0)&&(a=0),(o=(o-=c=s.N5?N(t,1):0)-(r=o<=0?0:r))<=0&&(o=0),s._5&&e+o>N(t)&&t.setRowCount(e+o),s.E5&&n+a>E(t)&&t.setColumnCount(n+a),f={},h=l=0;l<i.length;l++,h++)d=i[l],v=t.o5(),d.length<=0||(0<c&&l<c?Ze(t,d,h,n,a,1,s,f):0<o&&h<N(t)&&(Ze(t,d,h=l===c?e:h,0,u,2,s,f),d.splice(0,u),v&&(h=t.j5(h-1,3)),Ze(t,d,h,n,a,3,s,f,v)))}function Ze(t,e,n,i,r,o,a,s,u){for(var c,f,l,c=E(t,o),f=0,l=i;f<e.length;f++,l++)0<r&&l<c&&(u&&(l=t.O5(l-1,3)),Qe(t,o,n,l,e[f],a,s))}function Qe(e,n,i,r,o,t,a){var s,u,c,f,l,l,a,f,t,h,c,s=o,u=I;if(!1===t.k5&&(c={value:I},l=a[f=o.toString()],!G(o)&&l?(s=l.setValue,u=l.formatter):o&&!isNaN(o)&&0<=o.indexOf("\t")?s=o:(s=k.mt.Xf(I,o,!t.k5,c),u=c.value,G(o)||(a[f]={setValue:s,formatter:u}))),G(s))e.setValue(i,r,s,n);else if(""!==o)if(t.D5&&"="===o[0]&&1<o.length)try{e.setFormula(i,r,o.substr(1))}catch(t){e.setText(i,r,o,n)}else l=e.l0(i,r,"formatter",n),!1===t.k5&&u?l?(c=(l="string"==typeof l&&d.Formatter?new d.Formatter.GeneralFormatter(l):l).parse&&l.parse(o),s=G(c)?s:c):(u.isAuto=!0,e.getCell(i,r,n).R5("_autoFormatter",u),a=void 0,f=e.getCellType(i,r,n),t=u.formatString(),f&&"7"===f.typeName&&(a=f.parse(o,t,h={sheet:e,row:i,col:r,sheetArea:n}),s=G(a)?o:a)):l&&e.getCell(i,r,n).formatter(I),e.setValue(i,r,s,n);else e.setValue(i,r,I,n)}function Xe(t){for(var e,n,i,e=0,n=0;n<(t&&t.length);n++)i=t[n],e=J(i.length,e);return e}function qe(t,e,n,i,r,o,a,s,u,c){if(!t)throw new Error(q().Exp_SheetIsNull);var i;(e<-1||e>=N(t))&&Le("row",e,"-1",N(t)-1),(n<-1||n>=E(t))&&Le("column",n,"-1",E(t)-1),G(i)||""===i||(-1===e&&(e=0),-1===n&&(n=0),(i=ze(i,r,o,a,u,c))&&0<i.length&&Je(t,e,n,i,s))}function $e(t,e,n,i,r,o,a,s,u,c,f,l,h,d){var v,g,v,g,m,p,S,w,b,C,p,e,y;if(t)return v=N(t),g=E(t),(e<-1||v<=e)&&Le("row",e,"-1",v-1),(n<-1||v<e+n)&&Le("rowCount",n,"-1",v-e),(i<-1||g<=i)&&Le("column",i,"-1",g-1),(r<-1||g<i+r)&&Le("columnCount",r,"-1",g-i),p=m=!(g=v=-1),g=-1===e&&-1===i&&-1===n&&-1===r?(i=e=0,v=(n=N(t))-1,(r=E(t))-1):(-1===e&&(e=0,2==(2&Ae(t)))&&(m=!0),-1===i&&(i=0,1==(1&Ae(t)))&&(p=!0),v=e+(n=-1===n?N(t)-e:n)-1,i+(r=-1===r?E(t)-i:r)-1),b=w=null,C=rn(t,e,v,i,g,3,c,f,o=!G(o)&&""!==o?o:"\r\n",a=!G(a)&&""!==a?a:"\t",s=!G(s)&&""!==s?s:'"',S=new RegExp(s,"g"),u,l,h,d),p&&(p=t.getColumnCount(2),w=rn(t,e,v,0,p-1,2,c,f,o,a,s,S,u,l,h,d)),m&&(e=t.getRowCount(1),b=rn(t,0,e-1,i,g,1,c,f,o,a,s,S,u,l,h,d)),tn(C,w,b,o,a,y=l&&4e3<n*r&&(B.safari||B.mozilla||k.mt.Qf()&&B.chrome));throw new Error(q().Exp_SheetIsNull)}function tn(t,e,n,i,r,o){var a,s,u,e,c,a=t,s=0,u=function(t,e){for(var n,i,r,n=[],i=t.length,r=0;r<i;r++)n.push(t[r].concat(e[r]));return n};return e&&(s=e[0].length,a=u(e,t)),n&&(e=n.length,c=null,a=(n=s?u(c=rn(null,0,e-1,0,s-1,null,[],[],i,r,null,null,null,!1,!1),n):n).concat(a)),o&&en(a),nn(a,i,r)}function en(t){for(var e,n,e=t.length,n=t.length-1;0<=n&&-1===t[n].join("").search(/\S+/);n--)e=n;t.length=e}function nn(t,e,n){for(var i,r,o,a,s,o="",a=t.length,s=k.mt.Qf(),i=0;i<a;i++){for(r=0;r<t[i].length;r++)0!==r&&(o+=n),o+=t[i][r];(!s||i<a-1)&&(o+=e)}return o}function rn(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g){for(var m,p,S,w,b,C,m=[],w=t&&_e(t),p=e;p<=n;p++)if(!a||!V(a,p)){for(b=[],S=i;S<=r;S++)s&&V(s,S)||(C="",t&&!Ye(t,p,S,o,d)&&(C=t.getText(p,S,o),g)&&w&&C&&(" "!==C[0]&&" "!==C[C.length-1]||"number"!=typeof t.getValue(p,S,o)||(C=C.trim())),C=on(C,d,w,l,f,v,h,c,u),b.push(C));m.push(b)}return m}function on(t,e,n,i,r,o,a,s,u){var c="";return G(t)||(c=(c=t).replace(i,r+r)),o&&!c&&(c=" "),c=!a&&-1===c.indexOf(r)&&-1===c.indexOf(s)&&-1===c.indexOf(u)&&-1===c.indexOf("\n")?c:r+c+r}function c(t,e){if(t.sheets){var e=(0,k._f)(t,e.sheetName);if(e)return e}return t}function o(t,e,n,i){var t,e,t=c(t,n),e=new e(t,n,i);return i?e.undo(t):e.execute(t)}function an(t){var n=t;return function(t,e){var t=c(t,e);return R.B5(t,n)}}function a(t,e){var n,i,n=t,i=e;return function(t,e){var t=c(t,e);return R.L5(t,n,i)}}function sn(t,e){var t,n,i,r,e,t=t.parent;t&&(n=t.getSheetCount(),r=i=void 0,i=r=t.getActiveSheetIndex(),e?r<n-1&&r++:0<r&&r--,i!==r)&&(e=t.getActiveSheet(),t.tb(r,1),t.a3(e),t.repaint())}function un(t,e,n,i){t.F5=!0,cn(t)?t.P5(e):t.G5(e,n,void 0,void 0,i),t.F5=!1}function cn(t){var e,n,e=t.Ut.getSelections().length;return 1<e||!(!((n=t.U5())&&0<e)||t.ui===n.row&&t.ci===n.col&&t.H5>=H(n)&&t.z5>=U(n))}function fn(t,e){var n,n,t,e;return!!t.endEdit()&&((n=t.rt).V5(),n.Y5(),k.hi.F1(I),n=!1,(t=t.parent)&&((e=e.call(t))&&e.focus?(e.focus(),n=!0):t.vC()),{ignoreCancelDefault:!n})}function f(t,e,n){var i=this;i.Mf=t,i.Z5=e,i.W5=n,i.Q5=[],i.K5=[],i.J5()}function ln(e,t){var n,i,n=[];return"string"==typeof t?(i=(0,k._f)(e,t))&&n.push(i):Array.isArray(t)&&t.forEach(function(t){var t=(0,k._f)(e,t);t&&n.push(t)}),n}function hn(t){return t instanceof b.Worksheet?t:t.Mf instanceof b.Worksheet?t.Mf:void 0}function dn(t,e){G(t.Tb)&&(t.Tb=e.Tb,t.Ab=e.Ab)}function vn(t,e){var e=t.vw(e);-1!==e&&e<t.Tb&&(t.Tb=e,t.invalidateLayout())}function gn(t,e){var e=t.ww(e);-1!==e&&e<t.Ab&&(t.Ab=e,t.invalidateLayout())}function mn(t,e){var n=ke.call(this,t,e)||this;return dn(e,t),n}function pn(t,e){var n=Te.call(this,t,e)||this;return dn(e,t),n}function Sn(t,e){var n,i,n=xe.call(this)||this,i=n;return i.Mf=t,i.tT=e,n}function wn(t,e){var n,i,n=Ge.call(this)||this,i=n;return i.Mf=t,i.tT=e,n}function l(t,e){var n,i,t,n=Be.call(this,t,e)||this,i=n,t=t.parent;return i.nT=e.rowHeader?2:3,W(e.autoFitType)||(e.autoFitType=t?t.options.autoFitType:0),n}function h(t,e){var n,i,t,n=Ie.call(this,t,e)||this,i=n,t=t.parent;return i.nT=e.columnHeader?1:3,W(e.autoFitType)||(e.autoFitType=t?t.options.autoFitType:0),n}function bn(t,e){"value"===e.propertyName&&t.eT(e.row,e.col,e.oldValue,e.newValue)}function v(){return null!==Pe&&Pe.apply(this,arguments)||this}function g(t,e){var n,i,t,n=Re.call(this,t,e)||this;return x&&e.ranges&&1===e.endEditType&&(i=t.JS(e.ranges[0]),1===H(e.ranges[0]=i))&&1===U(i)&&(t=t.iT(i.row,i.col,1,1))&&t.ranges&&0<t.ranges.length&&(e.ranges=[t.ranges[0]]),n}function Cn(){return null!==Ne&&Ne.apply(this,arguments)||this}function yn(t){var t=t.parent,t=t&&t.w2;t&&t.repaint()}function Mn(t,i){t&&t.forEach(function(t){var e,n,e=t.w3.getFormula(t.row,t.column),n=t.w3.sT(t.row,t.column);t.w3.rT.setFormula(t.row,t.column,e,n,i)})}function kn(t,e){return Ee.call(this,t,e)||this}function Tn(t,e){return He.call(this,t,e)||this}function xn(t,e){return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),t.zoom(e),t.resumePaint(),0))}function m(t,e){return Ue.call(this,t,e)||this}function Gn(t,e,n){var i,r,o,i=Fe.call(this,t,e)||this;if(!n&&(e.cachedActions=[],r=e.ranges)&&0<r.length)for(o=0;o<r.length;o++)e.cachedActions[o]=new Ce(t,{clearRange:r[o]});return i}n=this&&this.__extends||(Me=function(t,e){return(Me=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Me(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),S=this&&this.__assign||function(){return(S=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.ChangedCells=t.Commands=t.getRangeText=t.getMaxLength=t.parseText=void 0,i=e("./dist/core/core.ns.js"),d=e("Common"),A=e("./dist/core/worksheet/style.js"),b=e("./dist/core/worksheet/worksheet.js"),k=e("./dist/core/util/common.js"),r=e("./dist/core/util/domUtil.js"),T=e("./dist/core/core.enum.js"),L=r.GC$,D=e("CalcEngine"),u=e("./dist/core/util/crypto.js"),j=e("./dist/core/worksheet/worksheet-formatter.js"),O=e("./dist/core/worksheet/worksheet-clipboard.js"),r=e("./dist/core/worksheet/actionbase.js"),x=!!D,G=d.Common.lt.ht,V=d.Common.Uf.OS,Y=d.Common.zf,K=Y.dT,z=k.Events.CellChanged,w=k.Events.ColumnWidthChanging,C=k.Events.ColumnWidthChanged,y=k.Events.RowHeightChanging,M=k.Events.RowHeightChanged,B=k.mt.Tt,W=k.mt.T1,e=L.extend,I=null,P=void 0,J=Math.max,Z=Math.ceil,Q=1e5,X="SHA-512",i=new d.Common.ResourceManager(i.SR,"Sheets"),q=i.getResource.bind(i),t.parseText=ze,t.getMaxLength=Xe,t.getRangeText=$e,e(b.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<E(this)&&this.Qy().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<N(this)&&this.Qy().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,e,n,i,r,o,a,s){var u=this;De(u),je(u),Oe(u),qe(u,t,e,n,i,r,'"',o,a,s),Ve(u,!1),_(u),F(u)},setDataToCell:function(t,e,n,i){Je(t,e,n,i,0)},getCsv:function(t,e,n,i,r,o){return $e(this,t,n,e,i,r,o,'"',!0)},getRangeTextHasIgnore:function(t,e,n,i,r,o){return $e(this,t,n,e,i,"\r\n","\t",'"',!0,r,o)},findSpecialNonNullCellInRange:function(t,e){for(var n,t,i,r,o,a,s,u,n=this.Ut.sheetModels[3],t=k.mt.S1(this,t),i=t.row,r=t.row+t.rowCount,o=t.col,a=t.col+t.colCount,s=n.gT(i-1);-1!==s&&s<=r;){for(u=n.pT(s,o-1);-1!==u&&u<=a;){if(e(this,s,u))return{row:s,col:u};u=n.pT(s,u)}s=n.gT(s)}return P},nA:function(t){var e,n,i,r,o,a,s,e=this,n=t.length;if(e.isActualProtected())for(i=0;i<n;i++)for(o=(r=t[i]).row;o<r.row+r.rowCount;o++)for(a=r.col;a<r.col+r.colCount;a++)if(!1!==(s=e.getActualStyle(o,a)).locked)return!0;return!1},ET:function(t){for(var e=0;e<t.length;e++)if(this.dA(t[e],P,T.SheetArea.viewport))return!0;return!1},G5:function(t,e,n,i,r){var o,a,a,a,s,o=this,a=o.vA&&1===o.vA.sheetArea;o.endEdit&&!o.endEdit()||a||(a={sheet:o,sheetName:o.name(),row:o.ui,col:o.ci,cancel:!1},o.ki(k.Events.LeaveCell,a),!0!==a.cancel&&(a=o.ui,s=o.ci,G(n)&&(n=o.ui),G(i)&&(i=o.ci),3===t?o.mA(n,i,e):4===t?o.gA(n,i,e):1===t?o.pA(n,i,e,r):2===t?o.bA(n,i,e):5===t?o.yA():6===t&&o.wA(),o.MA(t,a,s,!1)))},P5:function(t){var e,n,n,i,e=this;e.endEdit()&&(n={sheet:e,sheetName:e.name(),row:e.ui,col:e.ci,cancel:!1},e.ki(k.Events.LeaveCell,n),!0!==n.cancel)&&(n=e.ui,i=e.ci,3===t?e.CA(e.ui,e.ci):4===t?e.SA(e.ui,e.ci):1===t?e.TA(e.ui,e.ci):2===t&&e.AA(e.ui,e.ci),e.MA(t,n,i,!0))},MA:function(t,e,n,i){var r,o,a,s,u,u,c,f,f,l,h,l,h,f,l,h,s,l,d,v,d,s,l,g,m,h,v,d,s,l,r=this,o=r.rt,a=r.Ut.getSelections(),s=!1;if(i||(u=r.JS(r.U5()),!(s=1<a.length||1<H(u)||1<U(u)?!0:s)&&r.Cb&&r.Cb.Sb(u)&&(s=!0),r.IA()),u=r.ui,c=r.ci,f=r.Ut.getSpan(u,c),r.H5=H(f),r.z5=U(f),i||(f=r.xA(u,c),l=r.selectionPolicy(),h=r.selectionUnit(),0!==l&&1!==l||r.Ut.do("clearSelection"),1===h?(f.col=-1,f.colCount=-1):2===h&&(f.row=-1,f.rowCount=-1),r.kA(f.row,f.col,H(f),U(f),!1),l=r.Ut.getSelections(),o._A(a,l)&&(r.EA(a,l),r.jA(a))),r.OA(u,c),e!==u&&(h=r.H3)&&h.RA(),f=r.Dn,s){if(l=r.options.rightToLeft,h=r.Fi(),s=l?h.x:h.BA,l=h.LA,d=h.width-s,v=h.height-l,f.FA(s,l,d,v),f.repaint(new k.Rect(s,l,d,h.qC)),f.repaint(new k.Rect(s,l,h.XC,v)),s=(d=r._1)&&d.isEnable(T.RowColumnStates.selected,!0),l=d&&d.isEnable(T.RowColumnStates.selected,!1),s||l){for(g=a[0],m=1;m<a.length;m++)g=g.union(a[m]);g&&(h=new k.Range(u,c,r.H5,r.z5),f.E1(h.union(g),null,null,null,null,i))}f.jy(f.J())}else d=H(v=r.Ut.getSpan(e,n)),s=U(v),f.E1(new k.Range(u,c,r.H5,r.z5).union(new k.Range(e,n,d,s)),null,null,null,null,i);l={sheet:r,sheetName:r.name(),row:u,col:c},r.ki(k.Events.EnterCell,l),r.ki(k.Events.EnterCellInternal,l),o.PA&&o.PA(u,c)},GA:function(t,e,n){var i,r,t,i=this,r=i.getDataValidator&&i.getDataValidator(t,e),t={sheet:i,sheetName:i.name(),row:t,col:e,editingValue:n,validator:r,validationResult:0};return i.ki(k.Events.ValidationError,t),t.validationResult},protect:function(t){this.aue(t)},aue:function(t){var e,n,n,i,t,e=this,n="string"==typeof t;!0!==e.options.isProtected&&(G(t)||n&&0===t.length?e.options.isProtected=!0:n&&(n=u.Qoe.iue(),t=u.Qoe.nue(t,n,i=1e5,u.Qoe.eue),e.oue={algorithmName:X,hashValue:t,saltValue:n,spinCount:1e5},e.options.isProtected=!0))},unprotect:function(t){return this.uue(t)},uue:function(t){var e,n,n,i,r,o,a,n,s,e=this,n=e.sue();if(e.options.isProtected){if(!n)return!(e.options.isProtected=!1);if(G(t)||"string"!=typeof t||0===t.length)return!1;if(i=(n=e.oue).hashValue,r=n.saltValue,o=n.spinCount,a=n.algorithmName,n=n.legacyPassword,s=!1,[i,r,o,a].some(G)){if(G(n))return!1;s=u.Qoe.ETe(t)===n}else{if(a!==X)throw new Error(q().EXP_UNSUPPORT_CRYPTO_ALGORITHM);s=u.Qoe.rue(t,i,r,o,u.Qoe.eue)}if(!s)return!1;e.options.isProtected=!1,e.oue=P}return!0},hasPassword:function(){return this.sue()},sue:function(){return!G(this.oue)}}),R={},(t.Commands=R).B5=function(t,e){return!!t&&2!==t.Di&&(t.options.rightToLeft&&(3===e?e=4:4===e&&(e=3)),t.G5(e,!1),!0)},R.UA=function(t,e,n,i){return!!t&&2!==t.Di&&(t.options.rightToLeft&&(3===e?e=4:4===e&&(e=3)),t.G5(e,!1,n,i),!0)},R.L5=function(t,e,n){return!!t&&2!==t.Di&&!(t.endEdit&&!t.endEdit()||(t.options.rightToLeft&&(37===e?e=39:39===e&&(e=37)),t.HA(e,n),0))},$="navigationLeft",tt="navigationRight",et="navigationUp",nt="navigationDown",it="navigationHome2",rt="navigationEnd2",ot="navigationTop",at="navigationBottom",st="navigationHome",ut="navigationFirst",ct="navigationEnd",ft="navigationLast",lt="moveToNextCell",ht="moveToPreviousCell",dt="navigationPageUp",vt="navigationPageDown",gt="navigationPreviousSheet",mt="navigationNextSheet",pt="clear",St="clearAndEditing",wt="commitInputNavigationDown",bt="commitInputNavigationUp",Ct="cancelInput",yt="commitArrayFormula",Mt="selectionLeft",kt="selectionRight",Tt="selectionUp",xt="selectionDown",Gt="selectionHome",Bt="selectionEnd",It="selectionPageUp",Pt="selectionPageDown",Rt="selectionTop",Nt="selectionBottom",Et="selectionFirst",Ht="selectionLast",Ut="copy",Ft="superCopy",_t="cut",At="superCut",Lt="paste",Dt="undo",jt="redo",Ot="resizeColumn",Vt="resizeRow",Yt="splitResizeRow",Kt="splitResizeColumn",zt="autoFitColumn",Wt="autoFitRow",Jt="editCell",Zt="setCellDefaultValue",Qt="renameSheet",Xt="zoom",qt="clearValues",$t="clipboardPaste",te="selectNextControl",ee="selectPreviousControl",ne="moveToNextCellThenControl",ie="moveToPreviousCellThenControl",re="changeFormulaReference",oe="moveSheet",ae="copySheet",se="showAllSheetsDialog",ue="openPasteSpecialDialog",R.Tp=c,R.zA=o,R.gM=function(t){var e=k.mt.Qf(),n=!e,i=e;t.register($,R[$],37,!1,!1,!1,!1),t.register(tt,R[tt],39,!1,!1,!1,!1),t.register(et,R[et],38,!1,!1,!1,!1),t.register(nt,R[nt],40,!1,!1,!1,!1),t.register(it,R[it],37,n,!1,!1,i),t.register(rt,R[rt],39,n,!1,!1,i),t.register(ot,R[ot],38,n,!1,!1,i),t.register(at,R[at],40,n,!1,!1,i),t.register(st,R[st],36,!1,!1,!1,!1),t.register(ut,R[ut],36,!0,!1,!1,!1),t.register(ct,R[ct],35,!1,!1,!1,!1),t.register(ft,R[ft],35,!0,!1,!1,!1),t.register(lt,R[lt],9,!1,!1,!1,!1),t.register(ht,R[ht],9,!1,!0,!1,!1),t.register(dt,R[dt],33,!1,!1,!1,!1),t.register(vt,R[vt],34,!1,!1,!1,!1),t.register(gt,R[gt],33,n,!1,!1,i),t.register(mt,R[mt],34,n,!1,!1,i),t.register(pt,R[pt],46,!1,!1,!1,!1),t.register(St,R[St],8,!1,!1,!1,!1),t.register(wt,R[wt],13,!1,!1,!1,!1),t.register(bt,R[bt],13,!1,!0,!1,!1),t.register(Ct,R[Ct],27,!1,!1,!1,!1),t.register(yt,R[yt],13,!0,!0,!1,!1),t.register(Mt,R[Mt],37,!1,!0,!1,!1),t.register(kt,R[kt],39,!1,!0,!1,!1),t.register(Tt,R[Tt],38,!1,!0,!1,!1),t.register(xt,R[xt],40,!1,!0,!1,!1),t.register(Gt,R[Gt],36,!1,!0,!1,!1),t.register(Bt,R[Bt],35,!1,!0,!1,!1),t.register(It,R[It],33,!1,!0,!1,!1),t.register(Pt,R[Pt],34,!1,!0,!1,!1),t.register(Gt,R[Gt],37,n,!0,!1,i),t.register(Bt,R[Bt],39,n,!0,!1,i),t.register(Rt,R[Rt],38,n,!0,!1,i),t.register(Nt,R[Nt],40,n,!0,!1,i),t.register(Et,R[Et],36,!0,!0,!1,!1),t.register(Ht,R[Ht],35,!0,!0,!1,!1),B.msie||B.edge?t.register(Ut,R.copy,67,n,!1,!1,i):(t.register(Ut,R.copy),t.register(Ft,R[Ft],67,n,!1,!1,i)),B.msie||B.edge?t.register(_t,R.cut,88,n,!1,!1,i):(t.register(_t,R.cut),t.register(At,R[At],88,n,!1,!1,i)),t.register(Lt,R[Lt],86,n,!1,!1,i),t.register(Dt,R.undo,90,n,!1,!1,i),t.register(jt,R.redo,89,n,!1,!1,i),e&&t.register(jt,R.redo,90,n,!0,!1,i),t.register(te,R[te]),t.register(ee,R[ee]),t.register(ne,R[ne]),t.register(ie,R[ie]),t.register(re,R[re]),t.register(Ot,R[Ot]),t.register(Vt,R[Vt]),t.register(Kt,R[Kt]),t.register(Yt,R[Yt]),t.register(zt,R[zt]),t.register(Wt,R[Wt]),t.register(Jt,R[Jt]),t.register(Zt,R[Zt]),t.register(Qt,R[Qt]),t.register(Xt,R.zoom),t.register(qt,R[qt]),t.register($t,R[$t]),t.register(oe,R[oe]),t.register(ae,R[ae]),t.register(se,R[se]),t.register(ue,R[ue],86,!0,!1,!0,!1)},s={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",2048:"defaultValue",4096:"altText",1:"value"},R[$]={canUndo:!(ce=".cellEditAction"),execute:an(3)},R[tt]={canUndo:!1,execute:an(4)},R[et]={canUndo:!1,execute:an(1)},R[nt]={canUndo:!1,execute:an(2)},R[yt]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e),e=R.VA;return(t=e?e.YA(t):t).YA&&t.YA(),!0}},R[wt]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e),e=R.VA;return un(t=e?e.ZA(t):t,2,!1),!0}},R[bt]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e),e=R.VA;return un(t=e?e.WA(t):t,1,!1,!0),!0}},R[st]={canUndo:!1,execute:function(t,e){var t=c(t,e);return R.UA(t,4,I,t.frozenColumnCount()-1)}},R[it]={canUndo:!1,execute:function(t,e){var t,n,t=c(t,e);return!!(t&&0<(n=t.getSelections()).length)&&R.UA(t,4,I,-1)}},R[ct]={canUndo:!1,execute:function(t,e){var t=c(t,e);return R.UA(t,3,I,E(t)-t.frozenTrailingColumnCount())}},R[rt]={canUndo:!1,execute:function(t,e){var t,n,t=c(t,e);return!!(t&&0<(n=t.getSelections()).length)&&R.UA(t,3,I,E(t))}},R[ot]={canUndo:!1,execute:function(t,e){var t=c(t,e);return R.UA(t,2,-1,I)}},R[at]={canUndo:!1,execute:function(t,e){var t=c(t,e);return R.UA(t,1,N(t),I)}},R[dt]={canUndo:!1,execute:function(t,e){var t,e,n,n,i,i,t=c(t,e);if(!t||2===t.Di)return!1;if((e=t.QA())!==I&&e!==t.Tb){if(n=t._y(1,3),(n=t.j5(t.ui-n.length))<e&&(n=e),i=R.VA){if((i=i.KA(t,n,e)).r)return!0;t=i.sheet}if(!t.endEdit())return!1;t.JA(n,t.getActiveColumnIndex())&&(t.XA(n,I),t.qA=n,t.G5()),t.$A(e,0)}return!0}},R[vt]={canUndo:!1,execute:function(t,e){var t,e,n,n,i,i,t=c(t,e);if(!t||2===t.Di)return!1;if((e=t.tI())!==I&&e!==t.Tb){if(n=t._y(1,3),(n=t.nI(t.ui+n.length))<e&&(n=e),i=R.VA){if((i=i.eI(t,n,e)).r)return!0;t=i.sheet}if(!t.endEdit())return!1;t.JA(n,t.getActiveColumnIndex())&&(t.XA(n,I),t.qA=n,t.G5()),t.$A(e,0)}return!0}},R[mt]={canUndo:!1,execute:function(t,e){var n;sn(c(t,e),!0)}},R[gt]={canUndo:!1,execute:function(t,e){var n;sn(c(t,e),!1)}},R[ut]={canUndo:!1,execute:function(t,e){var t,e,e,t=c(t,e);if(!t||2===t.Di)return!1;if(e=R.VA){if((e=e.iI(t)).r)return!0;t=e.sheet}return t.G5(5,!1,t.ui,t.ci),!0}},R[ft]={canUndo:!1,execute:function(t,e){var t,e,e,t=c(t,e);if(!t||2===t.Di)return!1;if(e=R.VA){if((e=e.rI(t)).r)return!0;t=e.sheet}return t.G5(6,!1,t.ui,t.ci),!0}},R[te]={canUndo:!1,execute:function(t,e){var t=c(t,e);return!!t.parent&&fn(t,t.parent.nextControl)}},R[ee]={canUndo:!1,execute:function(t,e){var t=c(t,e);return!!t.parent&&fn(t,t.parent.previousControl)}},R[lt]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e),e=R.VA;return un(t=e?e.oI(t):t,4,!0),!0}},R[ht]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e),e=R.VA;return un(t=e?e.aI(t):t,3,!0),!0}},R[ne]={canUndo:!1,execute:function(t,e){var n,i,r,o,a,n=c(t,e),i=n.qA,r=n.getActiveColumnIndex();return n.F5=!0,o=n.uI(n.getActiveRowIndex(),r,!0,i),n.F5=!1,((a=!o||o.leadingCellRow<i||o.leadingCellRow===i&&r>o.col)?R[te]:R[lt]).execute(t,e)}},R[ie]={canUndo:!1,execute:function(t,e){var n,i,r,o,a,n=c(t,e),i=n.qA,r=n.getActiveColumnIndex();return n.F5=!0,o=n.sI(n.getActiveRowIndex(),r,!0,i),n.F5=!1,((a=!o||o.leadingCellRow>i||o.leadingCellRow===i&&r<o.col)?R[ee]:R[ht]).execute(t,e)}},R[Ct]={canUndo:!1,execute:function(t,e){var t,e,n,e,t=c(t,e),e=R.VA;return e&&(n=e.cI(t)),t.isEditing()?!!t.endEdit(!0):G(n)?(R.fI(t.parent),t.bM=I,t.parent.bM.c5(),k.hi.A1(t)&&t.fTe(),(e=t).AT&&e.AT(),void(e.ieV&&e.ieV())):n}},R.fI=function(t){var e,t,n,i,r,o;if(t&&(e=t.sheets,t=t.mp.map(function(t){return t.Mf}),n=e.concat(t)))for(i=0,r=n.length;i<r;i++)(o=n[i])&&o.lA&&o.lA.lI()},R[pt]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e);return!t.isEditing()&&(e=t.getSelections(),t.Qy().execute({cmd:qt,sheetName:t.name(),ranges:e}))}},R[St]={canUndo:!1,execute:function(t,e){var n=c(t,e);return!n.isEditing()&&(k.mt.Qf()?R[pt].execute(t,e):(n.Ai=!0,n.startEdit(!0,""),n.Ai=!1),!0)}},R.copy={canUndo:!1,execute:function(t,e){var n,t,n,t,t=c(t,e),n=!e.vge&&(null==(n=e.ignoreClipboard)||n),t=e.copyData=t.eA(n);return e.callback&&e.callback(),!t||P}},R[Ft]={canUndo:!1,execute:function(t,e){var n,t,n,i,r,t=c(t,e),n=null==(n=t.parent)?void 0:n.commandManager(),i;return 0<k.mt.sTe(t).length?(t.fTe(),n.execute({cmd:"copyShapes",sheetName:t.name()})):0<(r=k.mt.cTe(t)).length?(t.fTe(),n.execute({cmd:"copyFloatingObjects",sheetName:t.name()})):n.execute(S({cmd:Ut},e))}},R.cut={canUndo:!1,execute:function(t,e){var n,t,n,t,t=c(t,e),n=!e.vge&&(null==(n=e.ignoreClipboard)||n),t=e.cutData=t.tA(n);return e.callback&&e.callback(),!t||P}},R[At]={canUndo:!1,execute:function(t,e){var n,t,n,i,r,t=c(t,e),n=null==(n=t.parent)?void 0:n.commandManager(),i;return 0<k.mt.sTe(t).length?(t.fTe(),n.execute({cmd:"cutShapes",sheetName:t.name()})):0<(r=k.mt.cTe(t)).length?(t.fTe(),n.execute({cmd:"cutFloatingObjects",sheetName:t.name()})):n.execute(S({cmd:_t},e))}},R[Lt]={canUndo:!1,execute:function(t,e){var n,n,i,n=null!=(n=e.vge)&&n,i;c(t,e).rA(e,n)}},R[Mt]={canUndo:!1,execute:a(37)},R[kt]={canUndo:!1,execute:a(39)},R[Tt]={canUndo:!1,execute:a(38)},R[xt]={canUndo:!1,execute:a(40)},R[Gt]={canUndo:!1,execute:a(37,!0)},R[Bt]={canUndo:!1,execute:a(39,!0)},R[It]={canUndo:!1,execute:a(33)},R[Pt]={canUndo:!1,execute:a(34)},R[Rt]={canUndo:!1,execute:a(38,!0)},R[Nt]={canUndo:!1,execute:a(40,!0)},R[Et]={canUndo:!1,execute:a(36,!0)},R[Ht]={canUndo:!1,execute:a(35,!0)},R[re]={canUndo:!1,execute:function(t,e){var t,e,t=c(t,e),e=t&&t.rt;if(e){De(t);try{e.hI&&e.hI()}finally{F(t)}}}},R.undo={canUndo:!1,execute:function(t){var t,e,t=t;return t&&(e=t.undoManager())&&e.canUndo()&&(e.undo(),t.ki(k.Events.WorkbookUndo,{spread:t})),!0}},R.redo={canUndo:!1,execute:function(t){var t,e,t=t;return t&&(e=t.undoManager())&&e.canRedo()&&(e.redo(),t.ki(k.Events.WorkbookRedo,{spread:t})),!0}},R[Ot]={canUndo:!0,execute:function(t,e,n){return o(t,le,e,n)}},R[Vt]={canUndo:!0,execute:function(t,e,n){return o(t,he,e,n)}},R[Kt]={canUndo:!0,execute:function(t,e,n){return o(t,de,e,n)}},R[Yt]={canUndo:!0,execute:function(t,e,n){return o(t,ve,e,n)}},R[zt]={canUndo:!0,execute:function(t,e,n){return o(t,ge,e,n)}},R[Wt]={canUndo:!0,execute:function(t,e,n){return o(t,me,e,n)}},R[Jt]={canUndo:!0,execute:function(t,e,n){return o(t,pe,e,n)}},R[Zt]={canUndo:!1,execute:function(t,e,n){return o(t,Se,e,n)}},R[Qt]={canUndo:!0,execute:function(t,e,n){return o(t,we,e,n)}},R.zoom={canUndo:!0,execute:function(t,e,n){return o(t,be,e,n)}},R[qt]={canUndo:!0,execute:function(t,e,n){var i,r,i=c(t,e),r=i.getSelections();return i.isActualProtected()&&i.ET(r)?(i.jT(13,i.FT()),!1):o(t,ye,e,n)}},R[$t]={canUndo:!0,execute:function(t,e,n){return o(t,O.ClipboardPasteUndoAction,e,n)}},R[oe]={canUndo:!1,execute:function(t,e){var n,e,i,r,i,o,a,a,n=e.sheetName,e=e.targetIndex,i=t.getSheetPosition(n),r=t.jg(),i=i,o=e,a={sheet:r,sheetName:r.name(),oldIndex:i,newIndex:o,cancel:!1};return t.ki(k.Events.SheetMoving,a),!a.cancel&&(a=t.changeSheetPosition(n,e),t.ki(k.Events.SheetMoved,{sheet:r,sheetName:r?r.name():I,oldIndex:i,newIndex:o}),a)}},R[ae]={canUndo:!1,execute:function(t,e){var n,i,r,n,e,o,a,i=e.sheetName,r=e.targetIndex,n=e.newName,e=e.includeBindingSource,o=t.Gm(i);return t.ki(k.Events.SheetChanging,{sheetName:n,propertyName:"insertSheet",cancel:!1,sheetIndex:r,sheetPosition:t.getSheetPosition(n)}),t.ki(k.Events.ActiveSheetChanging,{oldSheet:o,newSheet:a,cancel:!1}),a=t.clone(i,r,n,e),!G(a)&&(t.ki(k.Events.SheetChanged,{sheetName:a.name(),propertyName:"insertSheet",sheetIndex:r,sheetPosition:t.getSheetPosition(a.name())}),t.ki(k.Events.ActiveSheetChanged,{oldSheet:o,newSheet:a}),t.sheetTabStyles.all()[i]&&(t.sheetTabStyles.O2e[a.name()]=t.sheetTabStyles.all()[i],null!=(n=t.w2))&&n.Cg(),!0)}},R[se]={canUndo:!1,execute:function(t,e){for(var t,n,i,r,o,a,s,u,c,c,f,l,h,t=t,n="gc.spread.",i="gc.spread.contextMenu.allSheets",r="sheetTab",o=[],a=t.qv(),u=0;u<a.length;u++)a[u].visible()===T.SheetTabVisible.visible&&(c=21<a[u].name().length?a[u].name().substr(0,18)+"...":a[u].name(),c={text:c=Y.dI(c),name:n+a[u].name(),command:i,workArea:r,itemClass:"",title:a[u].name()},a[u].b2()&&(s=u,c.itemClass="gc-ui-contextmenu-menuitem-all-sheets-select-sheets-background-color"),o.push(c));return f=(0,k.jf)(t),t.ki(k.Events.ActiveSheetChangingInternal,l={oldSheet:f,newSheet:f,needTriggerSheetChange:!0}),h={items:o,mouseEvent:e.mouseEvent,cancel:!1},t.ki(k.Events.SheetTabAllSheetsListContextMenuOpening,h),!h.cancel&&(t.contextMenu.openAllSheetsListContextMenu(o,t,e.mouseEvent,s),t.ki(k.Events.SheetTabAllSheetsListContextMenuOpened,h),t.ki(k.Events.ActiveSheetChangedInternal,{oldSheet:void 0,newSheet:f}),!0)}},R[ue]={canUndo:!1,execute:function(t,e,n){return o(t,O.OpenPasteSpecialDialogActive,e,n)}},f.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf.name(),range:t.Z5,dataType:t.W5,cellsData:t.Q5}},f.prototype.fromJSON=function(t,e){var n,i,n=t.sheetName,i=e;"Workbook"===e.constructor.name&&(i=e.getSheetFromName(n)),this.Mf=i,this.Z5=t.range,this.W5=t.dataType,this.Q5=t.cellsData},f.prototype.J5=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,h,k,k,T,T,t=this,e=t.Z5,n=t.Mf;if(n&&e){if(i=t.W5,r=e.row,o=e.col,a=H(e),s=U(e),u=t.Q5,c=!1,-1===r&&(c=!0,r=0,a=N(n)),-1===o&&(c=!0,o=0,s=E(n)),l=[],0<(64&i))for(d=0;d<s;d++)l[d]=n.vI(-1,d)||I;for(v=0;v<a;v++)for(g=r+v,0<(64&i)&&(f=n.vI(g,-1)||I),m=0;m<s;m++){if(p=void 0,S=o+m,x&&0<(2&i)&&n.getFormulaInformation&&(p=n.getFormulaInformation(g,S,3)).hasFormula)if(p.isArrayFormula){if((w=p.baseRange).row===g&&w.col===S)for(b=w.row,C=w.row+H(w);b<C;b++)for(y=w.col,M=w.col+U(w);y<M;y++)t.mI(u,b-r,y-o,p,2)}else t.mI(u,v,m,p.formula,2);!(0<(1&i))||p&&p.hasFormula||t.mI(u,v,m,n.getValue(g,S,3),1),0<(16&i)&&n.getSparkline&&(h=n.getSparkline(g,S),k=I,h&&(G(h.data())&&h.data(h.gI),k=h.data()),h)&&k&&t.mI(u,v,m,h,16),0<(64&i)&&(k=void 0,k=c?n.getActualStyle(g,S,3):(h=n.vI(g,S)||I,n.getCompositeStyle(g,S,3,h,f,l[m])),T=P,k&&k.toJSON&&(T=JSON.stringify(k.toJSON(3,!0))),t.mI(u,v,m,T,64)),T=n.Ut.pI,0<(4&i)&&T&&t.mI(u,v,m,T.get(g,S),4),0<(128&i)&&t.mI(u,v,m,n.getTag(g,S,3),128),0<(256&i)&&t.mI(u,v,m,n.getBindingPath&&n.getBindingPath(g,S,3),256),0<(1024&i)&&t.mI(u,v,m,n.getHyperlink&&n.getHyperlink(v,m,3),1024),0<(2048&i)&&t.mI(u,v,m,n.getDefaultValue(g,S,3),2048),0<(4096&i)&&t.mI(u,v,m,n.getAltText(v,m,3),4096)}}},f.prototype.bI=function(){return this.Q5},f.prototype.mI=function(t,e,n,i,r){!G(i)&&t&&(t[e]===P&&(t[e]=[]),t[e][n]===P&&(t[e][n]={}),t[e][n][s[r]]=i)},f.prototype.yI=function(t){var e,n,i,r,o,a,s,u,c;if(t)for(n=(e=this).Q5,i=0,r=t.length;i<r;i++)if(o=t[i])for(a=0,s=o.length;a<s;a++)(u=o[a])&&(n[i]||(n[i]=[]),(c=n[i][a])?e.wI(u,c)&&(n[i][a]=P):n[i][a]=u)},f.prototype.wI=function(t,e){var n,i,r,o,a,n=this.W5,i=[];for(256&n&&i.push(s[256]),4&n&&i.push(s[4]),2&n&&i.push(s[2]),16&n&&i.push(s[16]),64&n&&i.push(s[64]),128&n&&i.push(s[128]),1024&n&&i.push(s[1024]),2048&n&&i.push(s[2048]),4096&n&&i.push(s[4096]),1&n&&i.push(s[1]),r=0,o=i.length;r<o;r++)if(t[a=i[r]]!==e[a])return!1;return!0},f.prototype.MI=function(){var t,e,n,i,r,o,a,s,u,c,t=this,e=t.Z5.row,n=t.Z5.col,i=t.Q5,r=t.K5;if(!(r&&0<r.length)){for(r=[],e=-1===e?0:e,n=-1===n?0:n,o=0,a=i.length;o<a;o++)if(s=i[o])for(u=0,c=s.length;u<c;u++)s[u]&&r.push({row:o+e,col:u+n});t.K5=r}return r},fe=f,t.ChangedCells=fe,R.CI=fe,R.SI=function(t,e,n,i,r,o,a,s,u,c){t&&(e<0&&(e=0,i=N(t)),n<0&&(n=0,r=E(t)),t.SI(e,n,i,r,o,a,P,P,s,u,c))},R.TI=function(t){return"changes"+t},R.AI=function(t){return t&&(0!==t.length||!L.isEmptyObject(t))},R.lM=function(e){var t,n,n=e.sheetName;return"string"==typeof n?t=[n]:Array.isArray(n)&&(t=n),!!t&&t.every(function(t){var t,t,t=R.TI(t),t=e[t];return t&&0===t.length&&L.isEmptyObject(t)})},R.startTransaction=function(t,e){ln(t,e.sheetName).forEach(function(t){t.VAe()})},R.endTransaction=function(t,n){ln(t,n.sheetName).forEach(function(t){var e=R.TI(t.name());n[e]=t.zAe()})},R.undoTransaction=function(t,n){ln(t,n.sheetNames||n.sheetName).forEach(function(t){var e=R.TI(t.name());t.Mtt(n[e]),t.zw()})},R.II=function(t){t.forEach(function(t){var t=hn(t);t&&t.VAe()})},R.startTransactionAll=function(t){R.II(t)},R.xI=function(t,i){var r=[];t.forEach(function(t){var t,e,n,t,t=hn(t);t&&!t.xT&&(e=t.name(),n=R.TI(e),t=t.zAe())&&(i[n]=t,r.push(e))}),i.sheetNames=r},R.endTransactionAll=function(t,e){R.xI(t,e)},R.NI=function(t,n){t.forEach(function(t){var t,e,t=hn(t);t&&(t.Nj=!0,e=R.TI(t.name()),t.Mtt(n[e]),t.Nj=!1)})},R.ActionBase=r.ActionBase,ke=r.ActionBase,n(mn,ke),mn.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,t=this,e=!1;if(t.canExecute()&&(n=t.tT,i=t.Mf,r=n.columns,o=n.rowHeader,a=r&&r.length,i)&&0<a){if(s=t.kI(r),u={sheet:i,sheetName:i.name(),colList:s,header:o,cancel:!1},i.ki(w,u),!0===u.cancel)return e;n.DI=!0,i.VAe(),t.X5(i);try{for(c=2,f=3,l=E(i,o?2:3),i.Ab=n.Ab,h=n.size,d=0;d<a;d++)for(g=(v=r[d]).firstCol,m=v.lastCol,p=g;p<=m;p++)0<=p&&p<l&&(o&&i.getColumnResizable(p,2)&&h!==i.Do(p,2)?(i.setColumnWidth(p,h,2),e=!0):!o&&i.getColumnResizable(p,3)&&h!==i.Do(p,3)&&(i.setColumnWidth(p,h,3),e=!0))}finally{_(i),i.ki(C,{sheet:i,sheetName:i.name(),colList:s,header:n.rowHeader}),gn(i,r[0].firstCol),i.ow(),F(i),n[S=R.TI(i.name())]=i.zAe()}}return e},mn.prototype.undo=function(){var t,e,n,i,r,o,a,a,r,s,t=this,e=!1;if(t.canUndo()&&(n=t.tT,i=t.Mf,r=n.columns,o=n.rowHeader,a=r&&r.length,i)&&0<a){if(a=t.kI(r),r={sheet:i,sheetName:i.name(),colList:a,header:o,cancel:!1},i.ki(w,r),!0===r.cancel)return e;t.X5(i);try{s=R.TI(i.name()),i.Mtt(n[s]),i.Zw=!0,i.showCell(i.getActiveRowIndex(),i.getActiveColumnIndex(),1,1),i.Ab=n.Ab,e=!0}finally{_(i),i.ki(C,{sheet:i,sheetName:i.name(),colList:a,header:n.rowHeader}),F(i)}}return e},mn.prototype.kI=function(t){for(var e,n,i,r,o,a,s,e=[],n=0,i=t.length;n<i;n++)for(o=(r=t[n]).firstCol,a=r.lastCol,s=o;s<=a;s++)e.push(s);return e},mn.prototype.canUndo=function(){return this.tT.DI},le=mn,Te=r.ActionBase,n(pn,Te),pn.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,t=this,e=!1;if(t.canExecute()&&(n=t.Mf,o=(r=(i=t.tT).rows)&&r.length,n)&&0<o){if(a=t._I(r),s={sheet:n,sheetName:n.name(),rowList:a,header:i.columnHeader,cancel:!1},n.ki(y,s),!0===s.cancel)return e;i.DI=!0,n.VAe(),t.X5(n);try{for(u=3,c=1,l=N(n,(f=i.columnHeader)?1:3),n.Tb=i.Tb,h=i.size,d=0;d<o;d++)for(g=(v=r[d]).firstRow,m=v.lastRow,p=g;p<=m;p++)0<=p&&p<l&&(f&&n.getRowResizable(p,1)&&h!==n._o(p,1)?(n.setRowHeight(p,h,1),e=!0):!f&&n.getRowResizable(p,3)&&h!==n._o(p,3)&&(n.setRowHeight(p,h,3),e=!0))}finally{_(n),n.ki(M,{sheet:n,sheetName:n.name(),rowList:a,header:i.columnHeader}),vn(n,r[0].firstRow),n.tw(),F(n),i[S=R.TI(n.name())]=n.zAe()}}return e},pn.prototype.undo=function(){var t,e,n,i,r,o,o,r,a,t=this,e=!1;if(t.canUndo()&&(n=t.Mf,o=(r=(i=t.tT).rows)&&r.length,n)&&0<o){if(o=t._I(r),r={sheet:n,sheetName:n.name(),rowList:o,header:i.columnHeader,cancel:!1},n.ki(y,r),!0===r.cancel)return e;t.X5(n);try{a=R.TI(n.name()),n.Mtt(i[a]),n.Ww=!0,n.showCell(n.getActiveRowIndex(),n.getActiveColumnIndex(),1,1),n.Tb=i.Tb,e=!0}finally{_(n),n.ki(M,{sheet:n,sheetName:n.name(),rowList:o,header:i.columnHeader}),F(n)}}return e},pn.prototype._I=function(t){for(var e,n,i,r,o,a,s,e=[],n=0,i=t.length;n<i;n++)for(o=(r=t[n]).firstRow,a=r.lastRow,s=o;s<=a;s++)e.push(s);return e},pn.prototype.canUndo=function(){return this.tT.DI},he=pn,xe=r.ActionBase,n(Sn,xe),Sn.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,t=this,e=!1,n=t.tT,i=t.Mf,r=n.columns,o=n.rowHeader,a=t.kI(r);if(i&&r&&0<r.length){if(s={sheet:i,sheetName:i.Zc,colList:a,header:o,cancel:!1},i.ki(w,s),!0===s.cancel)return e;i.VAe(),t.X5(i);try{u=Z(n.size),c=o?2:3,f=r[0].firstCol,d=h=l=void 0,u!==(l=i.Do(f,c))&&(h=u-l,d=i.O5(f,c),i.setColumnWidth(f,u,c),i.setColumnWidth(d,i.Do(d,c)-h,c)),e=!0}finally{_(i),i.ki(C,{sheet:i,sheetName:i.Zc,colList:a,header:n.rowHeader}),F(i),n[v=R.TI(i.name())]=i.zAe()}}return e},Sn.prototype.undo=function(){var t,e,n,i,r,e,r,o,t=this.Mf,e=this.tT.columns,n=!1,i=this.tT,r=this.tT.rowHeader,e=this.kI(e),r={sheet:t,sheetName:t.Zc,colList:e,header:r,cancel:!1};if(t.ki(w,r),!0!==r.cancel){this.X5(t);try{o=R.TI(t.name()),t.Mtt(i[o]),n=!0}finally{_(t),t.ki(C,{sheet:t,sheetName:t.Zc,colList:e,header:i.rowHeader}),F(t)}}return n},Sn.prototype.kI=function(t){for(var e,n,i,r,o,a,s,e=[],n=0,i=t.length;n<i;n++)for(o=(r=t[n]).firstCol,a=r.lastCol,s=o;s<=a;s++)e.push(s);return e},de=Sn,Ge=r.ActionBase,n(wn,Ge),wn.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,t=this,e=!1,n=t.tT,i=t.Mf,r=n.rows,o=n.columnHeader,a=t._I(r);if(i&&r&&0<r.length){if(s={sheet:i,sheetName:i.Zc,rowList:a,header:o,cancel:!1},i.ki(y,s),!0===s.cancel)return e;i.VAe(),t.X5(i);try{u=Z(n.size),c=o?1:3,f=r[0].firstRow,d=h=l=void 0,u!==(l=i._o(f,c))&&(h=u-l,d=i.j5(f,c),i.setRowHeight(f,u,c),i.setRowHeight(d,i._o(d,c)-h,c)),e=!0}finally{_(i),i.ki(M,{sheet:i,sheetName:i.Zc,rowList:a,header:n.columnHeader}),F(i),n[v=R.TI(i.name())]=i.zAe()}}return e},wn.prototype.undo=function(){var t,e,n,i,r,e,r,o,t=this.Mf,e=this.tT.rows,n=!1,i=this.tT,r=this.tT.columnHeader,e=this._I(e),r={sheet:t,sheetName:t.Zc,rowList:e,header:r,cancel:!1};if(t.ki(y,r),!0!==r.cancel){this.X5(t);try{o=R.TI(t.name()),t.Mtt(i[o]),n=!0}finally{_(t),t.ki(M,{sheet:t,sheetName:t.Zc,rowList:e,header:i.columnHeader}),F(t)}}return n},wn.prototype._I=function(t){for(var e,n,i,r,o,a,s,e=[],n=0,i=t.length;n<i;n++)for(o=(r=t[n]).firstRow,a=r.lastRow,s=o;s<=a;s++)e.push(s);return e},ve=wn,Be=r.ActionBase,n(l,Be),l.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.columns&&0<t.columns.length},l.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,t=this,e=!1;if(t.canExecute()){if(n=t.tT,i=t.Mf,r=t.nT,o=t.kI(n.columns),a=2===r,s={sheet:i,sheetName:i.name(),colList:o,header:a,cancel:!1},i.ki(w,s),!0===s.cancel)return e;for(n.DI=!0,c=(u=E(i,r))-1,l=void(f=0),h=0,d=n.columns.length;h<d;h++)c=(l=n.columns[h].col)<c?l:c,f=f<l?l:f;k.Be.Ll(i,0,c,N(i)-1,f),i.VAe(),t.X5(i);try{for(v=void 0,h=0,d=n.columns.length;h<d;h++)0<=(g=n.columns[h].col)&&g<u&&i.getColumnResizable(g,r)&&((v=t.qf(g))===i.getColumnWidth(g,r)&&G(i.getColumnWidth(g,r,!0))||(i.setColumnWidth(g,v,r),e=!0))}finally{k.Be.dl(),_(i),i.ki(C,{sheet:i,sheetName:i.name(),colList:o,header:a}),F(i),n[m=R.TI(i.name())]=i.zAe()}}return e},l.prototype.undo=function(){var t,e,n,i,r,o,r,a,s,t=this,e=!1;if(t.canUndo()){if(n=t.tT,i=t.Mf,r=t.nT,o=t.kI(n.columns),r=2===r,a={sheet:i,sheetName:i.name(),colList:o,header:r,cancel:!1},i.ki(w,a),!0===a.cancel)return e;t.X5(i);try{s=R.TI(i.name()),i.Mtt(n[s]),e=!0}finally{_(i),i.ki(C,{sheet:i,sheetName:i.name(),colList:o,header:r}),F(i)}}return e},l.prototype.kI=function(t){for(var e,n,i,e=[],n=0;n<t.length;n++)i=t[n],e.push(i.col);return e},l.prototype.qf=function(t){return k.mt.qf(t,this.Mf,this.nT,this.tT.autoFitType)},l.prototype.canUndo=function(){return this.tT.DI},ge=l,Ie=r.ActionBase,n(h,Ie),h.prototype.canExecute=function(){var t=this.tT;return this.Mf&&t.rows&&0<t.rows.length},h.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,t=this,e=!1;if(t.canExecute()){if(n=t.tT,i=t.Mf,r=t._I(n.rows),o=t.nT,a=1===t.nT,s={sheet:i,sheetName:i.name(),rowList:r,header:a,cancel:!1},i.ki(y,s),!0===s.cancel)return e;n.DI=!0,i.VAe(),t.X5(i);try{for(u=N(i,o),c=void 0,f=0,l=n.rows.length;f<l;f++)0<=(h=n.rows[f].row)&&h<u&&i.getRowResizable(h,o)&&((c=t.e0(h))===i.getRowHeight(h,o)&&G(i.getRowHeight(h,o,!0))||(i.setRowHeight(h,c,o),e=!0))}finally{_(i),i.ki(M,{sheet:i,sheetName:i.name(),rowList:r,header:a}),F(i),n[d=R.TI(i.name())]=i.zAe()}}return e},h.prototype.undo=function(){var t,e,n,i,r,o,a,s,t=this,e=!1;if(t.canUndo()){if(n=t.tT,i=t.Mf,r=t._I(n.rows),o=1===t.nT,a={sheet:i,sheetName:i.name(),rowList:r,header:o,cancel:!1},i.ki(y,a),!0===a.cancel)return e;t.X5(i);try{s=R.TI(i.name()),i.Mtt(n[s]),e=!0}finally{_(i),i.ki(M,{sheet:i,sheetName:i.name(),rowList:r,header:o}),F(i)}}return e},h.prototype._I=function(t){for(var e,n,i,r,e=[],n=0,i=t.length;n<i;n++)r=t[n],e.push(r.row);return e},h.prototype.e0=function(t){return k.mt.e0(t,this.Mf,this.nT,this.tT.autoFitType)},h.prototype.canUndo=function(){return this.tT.DI},me=h,Pe=r.ActionBase,n(v,Pe),v.prototype.canExecute=function(){var t,e,n,i,r,o,a,s,u,t=this,e=t.Mf,n=t.tT,i=n.ranges,r=n.row,o=n.col,a={lockErrorMsg:t.kTe(),sheetArea:n.sheetArea,invalidType:13};if(i){for(s=0;s<i.length;s++)if(u=i[s],!e.PT(u.row,u.col,H(u),U(u),a))return!1}else if(!e.PT(r,o,1,1,a))return!1;return!0},v.prototype.kTe=function(){return I},v.prototype.EI=function(t){var e,n,i,r,o,a,s,e,n=this.tT,i=n.ranges;if(i)for(r=0;r<i.length;r++)for(a=(o=i[r]).row;a<o.row+H(o);a++)for(s=o.col;s<o.col+U(o);s++)t(a,s);else t(n.row,n.col)},v.prototype.execute=function(){var t,e,n,i,t=this,e=!1;if(t.canExecute()){n=t.Mf,t.X5(n,!0),i=void 0;try{i=t._Te(),t.tT.applyResult=t.jI(),e=!0}catch(t){e=!1}finally{t.DTe(i),t.q5(n,!0)}}return e},v.prototype._Te=function(){return[]},v.prototype.DTe=function(t){},v.prototype.jI=function(){return 0},v.prototype.LI=function(t,e,n,i,r){var o,a,o,s,a,t,e,s,n,o=this,a=o.Mf,o=o.tT,s=o.ignoreFormatting,a=a.getActualStyle(t,e),t={},e="string"!=typeof n||s?n:n&&"'"===n[0]?n.substring(1):k.mt.Xf(a,n,i,t,o.editingFormatter);return r.quotePrefix?(r._autoFormatter=P,r.GI=!0):(s=t.value,i&&s&&((e===(n=I)||"General"===s.formatString())&&a._autoFormatter||(s.isAuto=!0,n=s),n)&&(r.GI=!0,r._autoFormatter=n)),e},v.prototype.HI=function(t,e,n,i){var r,o,t,e,a,r,o,t=this.Mf.vI(t,e),e="string"==typeof t;t&&!e||(a=new A.Style,e&&(a.parentName=t),t=a),t.quotePrefix!==n&&(i.UI=!0,i.quotePrefix=n)},n(g,Re=i=v),g.prototype.kTe=function(){return this.Mf.FT()},g.prototype.undo=function(){var t,n,e,i,t=this;if(t.canUndo()){n=t.Mf,e=t.tT,t.X5(n,!0);try{n.D3(z+ce,function(t,e){bn(n,e)}),i=R.TI(n.name()),n.Mtt(e[i])}catch(t){return!1}finally{n._3(z+ce),t.q5(n,!0)}return!0}return!1},g.prototype._Te=function(){var n,t,n=this.Mf,t=n.parent.i4();return R.II(t),n.D3(z+ce,function(t,e){bn(n,e)}),t},g.prototype.DTe=function(t){var e=this,n;e.Mf._3(z+ce),R.xI(t,e.tT)},g.prototype.RI=function(n){var i,r,o,t,a,s,e,u,c,f,t,e,l,t,i=this,r=0,o=i.Mf,t=i.tT,a=t.row,s=t.col,e=t.sheetArea,u=t.newValue,c=!t.hasOwnProperty("autoFormat")||t.autoFormat,f=function(){var t,e,t=i.LI(a,s,u,c,n),e;o.isValid&&!o.isValid(a,s,t,!1)&&(r=o.GA(a,s,t),o.rt.FI=!0)};if(x&&!0!==t.ignoreFormula&&(0,k.kf)(u)){if(o.getDataValidator&&o.getDataValidator(a,s,e)&&""!==(t="="===u[0]?u.substring(1):u)&&t!==o.getFormula(a,s,e)&&(e=o.op())){l=void 0;try{l=e.parse(o.Uw(),t,0<=a?a:0,0<=s?s:0,!0)}catch(t){o.parent.options.allowInvalidFormula&&f()}l&&(t=e.evaluateParsedFormula(o.Uw(),l,{row:a,col:s}),o.isValid)&&!o.isValid(a,s,t,!1)&&(r=o.GA(a,s,t))}}else f();return r},g.prototype.jI=function(){var t,i,e,r,o,n,a,s,u,n,c,f,l,h,d,v,g,m,l,p,S,w,w,l,S,e,d,t=this,i=t.Mf,e=t.tT,r=e.sheetArea,o=e.newValue,n=e.ignoreValidate,a={GI:!1,UI:!1,_autoFormatter:P,quotePrefix:P},s=0;if(!0===n||1!==(s=t.RI(a))&&2!==s){if(n=!e.hasOwnProperty("autoFormat")||e.autoFormat,c=0<=(c=e.row)?c:0,f=0<=(f=e.col)?f:0,l=x&&D&&D.Parser,g=i.parent,!(m=i.NMi&&3===r)&&l)if(v=i.op(),l=g&&g.options.allowUserEditFormula,S=!1,"@"!==(p=i.getFormatter(c,f,r))&&l&&v&&!0!==e.ignoreFormula&&(0,k.kf)(o)){"="===o[0]&&(o=o.substring(1),S=!0);try{if(w={row:c,col:f,sheetArea:r,text:o,isAllow:!0},b.Worksheet.et(i,"applyEditingSetFormula",w),w.isAllow){if(e.ranges&&1===e.endEditType)return d=e.ranges[0],i.setArrayFormula(d.row,d.col,H(d),U(d),o,r),s;h=v.parse(i.Uw(),o,c,f,!0)}}catch(t){if(!g||!g.options.allowInvalidFormula)throw i.jT(0,"string"==typeof t?t:t.message),t;o=S?"="+o:o}}else e.ranges&&1===e.endEditType&&(d=e.ranges[0],i.getRange(d.row,d.col,H(d),U(d),r).clear(1));h||(o&&"'"===o[0]?t.HI(c,f,!0,a):t.HI(c,f,P,a),u=t.LI(c,f,o,n,a)),t.EI(function(e,n){if(h)try{var t=v.unparse(i.Uw(r),h,e,n);i.zI(e,n,t,h,P,r),i.ki(k.Events.UserFormulaEntered,{sheet:i,sheetName:i.name(),row:e,col:n,isCircularReference:i.VI(e,n),formula:t}),g&&g.options.formulaFormatHint&&(0,j.Fue)(i,g,h,c,f)}catch(t){throw i.jT(0,"string"==typeof t?t:t.message),t}else{try{i.hasFormula&&i.hasFormula(e,n,r)&&i.setFormula(e,n,I,r)}catch(t){throw i.jT(0,"string"==typeof t?t:t.message),t}try{i.YI(e,n,u,r),"string"!=typeof u&&null!==u||b.Worksheet.et(i,"setHyperlinkWhenEditing",{url:u,row:e,col:n,sheetArea:r})}catch(t){i.setValue(e,n,o,r)}}}),l=a.UI,((w=a.GI)||l)&&(e="string"==typeof(S=i.vI(c,f,r)),S&&!e||(d=new A.Style,e&&(d.parentName=S),S=d),w&&!m&&(S._autoFormatter=a._autoFormatter),l&&(S.quotePrefix=a.quotePrefix),i.setStyle(c,f,S,r))}return s},g.prototype.canUndo=function(){return 0===this.tT.applyResult},pe=g,n(Cn,Ne=i),Cn.prototype.jI=function(){var t,i,e,r,o,n,a,s,u,c,f,l,h,d,v,l,g,m,p,S,w,b,C,y,M,e,l,v,m,u,t=this,i=t.Mf,e=t.tT,r=e.sheetArea,o=e.newValue,n={GI:!1,UI:!1,_autoFormatter:P,quotePrefix:P},a=0,u=!e.hasOwnProperty("autoFormat")||e.autoFormat,c=e.row;if(c=0<=c?c:0,f=0<=(f=e.col)?f:0,l=x&&D&&D.Parser,v=i.parent,l&&(d=i.op(),l=v&&v.options.allowUserEditFormula,m=!1,"@"!==(g=i.getFormatter(c,f,r)))&&l&&d&&!0!==e.ignoreFormula&&(0,k.kf)(o)){"="===o[0]&&(o=o.substring(1),m=!0);try{S=c,w=f,b=r,C=o,(y=!0)&&(h=d.parse(i.Uw(),o,c,f,!0))}catch(t){v&&v.options.allowInvalidFormula&&(o=m?"="+o:o)}}return h||(o&&"'"===o[0]?t.HI(c,f,!0,n):t.HI(c,f,P,n),s=t.LI(c,f,o,u,n)),M=i.Ut,t.EI(function(e,n){if(h)try{var t=d.unparse(i.Uw(r),h,e,n);M.setDefaultValue(e,n,t,r,T.DefaultChangeValueType.Expression)}catch(t){}else try{M.setDefaultValue(e,n,s,r,T.DefaultChangeValueType.Value)}catch(t){M.setDefaultValue(e,n,o,r,T.DefaultChangeValueType.Value)}}),l=n.UI,((e=n.GI)||l)&&(m="string"==typeof(v=i.vI(c,f,r)),v&&!m||(u=new A.Style,m&&(u.parentName=v),v=u),e&&(v._autoFormatter=n._autoFormatter),l&&(v.quotePrefix=n.quotePrefix),i.setStyle(c,f,v,r)),0},Se=Cn,Ee=r.ActionBase,n(kn,Ee),kn.prototype.canUndo=function(){return!!this.tT.oldName},kn.prototype.canExecute=function(){var t,e,t=this,e=t.tT;return t.Mf&&e.name&&e.name!==e.oldName},kn.prototype.execute=function(){var t,e,n,i,r,o,a,s,s,u,c,t=this,e=t.Mf,n=t.tT,i=n.name,r=!1;return t.canExecute()&&(o=e.name(),e.ki(k.Events.SheetNameChanging,s={sheet:e,oldValue:o,newValue:a=i,cancel:!1}),!1===s.cancel)&&(s=e.parent.i4(),R.II(s),u=null,e.parent.options&&e.parent.options.saveChangesForSheet&&Mn(u=e.getCrossSheetReferences(),!0),n.oldName=o,t.X5(e,!0),Oe(e),e.ub(i),yn(e),u&&Mn(u,!1),R.xI(s,n),r=!0,n.sheetName=i,Ve(e,!1),t.q5(e,!0),e.ki(k.Events.SheetNameChanged,c={sheet:e,oldValue:o,newValue:a})),r},kn.prototype.undo=function(){var t,e,n,i,r,o,o,a,t=this;return!(!t.canUndo()||(e=t.Mf,i=(n=t.tT).name,r=n.oldName,e.ki(k.Events.SheetNameChanging,o={sheet:e,oldValue:i,newValue:r,cancel:!1}),!1!==o.cancel)||(t.X5(e,!0),Oe(e),o=R.TI(e.name()),e.Mtt(n[o]),yn(e),n.sheetName=n.oldName,Ve(e,!1),t.q5(e,!0),e.ki(k.Events.SheetNameChanged,a={sheet:e,oldValue:i,newValue:r}),0))},we=kn,He=r.ActionBase,n(Tn,He),Tn.prototype.canExecute=function(){var t,e,t=this,e=k.mt.ige(t.tT.zoomFactor);return t.Mf&&t.Mf.parent.options.allowUserZoom&&t.Mf.zoom()!==e},Tn.prototype.execute=function(){var t,e,n,t,i,r,o,a,t=this,e=t.tT,n=!1;return t.canExecute()&&(i=(t=t.Mf).Ut,r=e.zoomFactor,o=e.oldZoomFactor,t.VAe(),n=xn(t,r),t.Oj(r,o),i.ZI(["zoomChanged",o,r]),e[a=R.TI(t.name())]=t.zAe()),n},Tn.prototype.undo=function(){var t,e,t=this.Mf;if(this.canUndo())return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),e=R.TI(t.name()),t.Mtt(this.tT[e]),t.resumePaint(),0))},be=Tn,Ue=r.ActionBase,n(m,Ue),m.prototype.execute=function(){var t,e,n,i,r,o,o,n,a,s,o,u,r,r,t=this,e=t.Mf;t.canExecute()&&e&&(n=t.tT.clearRange,i=e.tables&&e.tables.WI&&e.tables.WI(n.row,n.col,n.rowCount,n.colCount),r=!!e.isReportTemplateSheet,e.isDirtySuspended()||(o=1027|(r?256:0),t.tT.K5=new fe(e,e.JS(n),o)),i&&0<i.length&&(t.tT.tableNames=i),n=(o=e.JS(n)).row,a=o.col,s=H(o),0<(o=U(o)))&&0<s&&(u=e.parent.i4(),R.II(u),t.X5(e),e.QI=!0,r=T.StorageType.data|T.StorageType.hyperlink|(r?T.StorageType.bindingPath:0),e.KI(n,a,s,o,3,r,!0),t.q5(e),e.QI=!1,R.xI(u,t.tT),r=t.tT.K5,R.SI(e,n,a,s,o,r?r.MI():[],2,i))},m.prototype.canExecute=function(){var t=this.tT.clearRange;return this.Mf&&this.Mf.PT(t.row,t.col,H(t),U(t),{sheetArea:T.SheetArea.viewport})},m.prototype.canUndo=function(){var t,t;if(this.Mf)return t=R.TI(this.Mf.name()),t=this.tT[t],R.AI(t)},m.prototype.undo=function(){var t,e,n,i,i,t=this,e=t.Mf;if(t.canUndo()&&e&&0<U(n=e.JS(t.tT.clearRange))&&0<H(n)){t.X5(e),e.QI=!0;try{i=R.TI(e.name()),e.Mtt(t.tT[i])}finally{t.q5(e),e.QI=!1}return i=t.tT.K5,R.SI(e,n.row,n.col,H(n),U(n),i?i.MI():[],2,t.tT.tableNames,!0),!0}return!1},m.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},m.prototype.fromJSON=function(t){var e,n,i,e=this,n=t.sheetName;e.Mf&&!G(n)&&(i=e.Mf.parent,e.Mf=i.getSheetFromName(n)),e.tT=t.command},Ce=m,R.ClearRangeValueUndoAction=Ce,Fe=r.ActionBase,n(Gn,Fe),Gn.prototype.canExecute=function(){var t,e,n,t=this.tT.cachedActions;if(t){for(e=0;e<t.length;e++)if(!(n=t[e]).canExecute())return!1;return!0}return!1},Gn.prototype.execute=function(){var t,e,n,i,r,t=this;if(t.canExecute()&&(e=t.tT.cachedActions,n=t.Mf,e)){for(t.X5(n,!0),i=0;i<e.length;i++)(r=e[i]).execute();return t.q5(n,!0),!0}return!1},Gn.prototype.canUndo=function(){var t,e,n,t=this.tT.cachedActions;if(t){for(e=0;e<t.length;e++)if(!(n=t[e]).canUndo())return!1;return!0}return!1},Gn.prototype.undo=function(){var t,e,n,i,r,r,t=this,e=t.tT.cachedActions;if(t.canUndo()){for(n=t.Mf,i=e.length-1;0<=i;i--)if(r=e[i],t.X5(n,!0),r=r.undo(),t.q5(n,!0),!r)return!1;return!0}return!1},ye=Gn,R.JI=ye},"./dist/core/worksheet/worksheet-border.js":function(d,t,e){"use strict";var n,G,i,Y,B,I,K,z,P,v,R,W,J,Z,Q,E,o,X,H,w,b,C,y,U,g,m,p,S,M,k,T,_,e,l,f,A,h,L,F,D,j,O,V,q,$,tt;function r(t){this.needRightToLeft=t=void 0===t?!1:t}function et(t,e,n,i,r,o,a,s,u){var u,o,c,f,u=O.call(this,u)||this,o=X(s)||1===s?o:Z(o*s),c;return o%2||(t!==n?(e-=.5,i-=.5):(t-=.5,n-=.5)),(f=u)._x1=t,f._y1=e,f._x2=n,f._y2=i,f._x=r,f.Ex=o,f.jx=a,f._zoomFactor=s,u}function a(t,e,n,i,r,o,a,s,u,c){var c,o,f,l,c=V.call(this,c)||this,o=X(u)||1===u?o:Z(o*u),f;return o%2||(t!==n?(e-=.5,i-=.5):(t-=.5,n-=.5)),(l=c)._x1=t,l._y1=e,l._x2=n,l._y2=i,l._x=r,l.Ex=o,l.Ox=a,l.jx=s,l._zoomFactor=u,c}function nt(t,e,n,i,r,o,a,s,u,c){var c,f,c=q.call(this,c)||this;return o?(--t,--n):(--e,--i),(f=c)._x1=t,f._y1=e,f._x2=n,f._y2=i,f._x=r,f.Rx=o,f.Ex=1,f.Bx=a,f.Lx=s,f.jx=u,c}function s(t,e,n,i,r,o,a){var s,u,s=$.call(this)||this,u=s;return u._x1=t,u._y1=e,u._x2=n,u._y2=i,u._x=r,u.Fx=o,u.jx=a,u.Px=new l(u._x1,u._y1,u._x2,u._y2,r,1,a),u.Gx=null,s}function u(t,e,n,i,r,o,a){var s,u,c,f;return(s=tt.call(this,a=void 0===a?!1:a)||this).needRightToLeft=a,u=s,f=c=0,t===n&&(c=1),e===i&&(f=1),t!==n&&e!==i?o?(u.Px=new l(t-(c=2),e,n-c,i,r,1,o),u.Gx=new l(t+c,e,n+c,i,r,1,o)):(f=c=2,n<t?(u.Px=new h(t-c,e,n,i-f,r,!1,o),u.Gx=new h(t,e+f,n+c,i,r,!1,o)):(u.Px=new h(t,e+f,n-c,i,r,!0,o),u.Gx=new h(t+c,e,n,i-f,r,!0,o))):(u.Px=new l(t-c,e-f,n-c,i-f,r,1,o,void 0,a),u.Gx=new l(t+c,e+f,n+c,i+f,r,1,o,void 0,a),s.gHe()),u.jx=o,u._x=r,u.Ex=1,s}function N(t,e,n,i,r,o,a,s,u,c){switch(void 0===s&&(s=1),u&&(u.x>t&&(t=u.x),u.y>e)&&(e=u.y),o=o!==K&&o!==z?o:1){case 1:return new l(t,e,n,i,r,1,a,void 0,c);case 2:return new l(t,e,n,i,r,2,a,s,c);case 5:return new l(t,e,n,i,r,3,a,s,c);case 3:return new f(t,e,n,i,r,1,[3,1],a,void 0,c);case 9:return new f(t,e,n,i,r,1,[8,2,2,2],a,void 0,c);case 4:return new f(t,e,n,i,r,1,[2,2],a,void 0,c);case 11:return new f(t,e,n,i,r,1,[9,3,3,3,3,3],a,void 0,c);case 13:return new A(t,e,n,i,r,t!==n,[11,1,5,1],[10,2,4,2],a,c);case 10:return new f(t,e,n,i,r,2,[9,3,3,3],a,s,c);case 12:return new f(t,e,n,i,r,2,[9,3,3,3,3,3],a,s,c);case 8:return new f(t,e,n,i,r,2,[9,3],a,s,c);case 7:return new f(t,e,n,i,r,1,[1],a,void 0,c);case 6:return new L(t,e,n,i,r,a,c)}return z}function x(){}function c(t,e,n,i,r){var o=this;o.Ux=!1,o.Hx=!1,o.Mf=t,o.nT=i,o.zx=e,o.Vx=n,o.JCe=new I.VisibleRowColCache(t),o.YAe=r}n=this&&this.__extends||(j=function(t,e){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Yx=t.Zx=void 0,G=e("./dist/core/worksheet/style.js"),i=e("./dist/core/util/domUtil.js"),Y=e("./dist/core/core.enum.js"),B=e("Common"),I=e("./dist/core/worksheet/helpers/visible-row-col-cache.js"),K=void 0,z=null,P=Math.sqrt,v=Math.pow,R=Math.min,W=Math.abs,J=Math.tan,Z=Math.ceil,Q=Math.PI,E=i.GC$.inherit,o=i.GC$.isEmptyObject,X=B.Common.lt.ht,g=w=0,m=b=1,p=C=2,S=y=3,M=4,k=5,T=6,_=7,r.prototype.Wx=function(t){var e=this;0===t._orientation?this.needRightToLeft?(t.Kx&&(e._x1-=t.Kx),t.Jx&&(e._x2-=t.Jx)):(t.Kx&&(e._x2+=t.Kx),t.Jx&&(e._x1+=t.Jx)):(t.Kx&&(e._y2+=t.Kx),t.Jx&&(e._y1+=t.Jx))},r.prototype._e=function(t){var e=this._x||"#9eb6ce",n=this.Ex,i=t.lineWidth,r=t.strokeStyle;i===n&&r===e||(i!==n&&(t.lineWidth=n),r!==e&&(t.strokeStyle=e)),this.Xx(t)},r.prototype.Xx=function(t){var e,n,i,n,i,e=this,n=e._x1===e._x2,i=e._y1===e._y2;n&&i||(n||i?(t.beginPath(),e.qx(t),t.stroke()):(t.save(),n=Math.min(e._x1,e._x2),i=Math.min(e._y1,e._y2),t.rect(n,i,Math.abs(e._x2-e._x1),Math.abs(e._y2-e._y1)),t.clip(),t.beginPath(),e.qx(t),t.stroke(),t.beginPath(),t.restore()))},r.prototype.qx=function(t){var e=this;t.moveTo(e._x1,e._y1),t.lineTo(e._x2,e._y2)},n(et,O=e=r),l=et,n(a,V=e),a.prototype.qx=function(t){var e=this;a.Dn(t,e._x1,e._y1,e._x2,e._y2,e.Ox)},a.Dn=function(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,a=P(v(i-e,2)+v(r-n,2)),u=(i-e)/a,c=(r-n)/a,f=0,l=0;for(o=o&&o.length?o:[4,4];f<a;)f+=h=R(o[l%o.length],a-f),(d=++l%2)&&t.moveTo(e,n),e+=h*u,n+=h*c,d&&t.lineTo(e,n)},f=a,n(nt,q=e),nt.prototype.qx=function(t){var e,n,i,e=this,n=e.Rx?0:1,i=e.Rx?1:0;f.Dn(t,e._x1-n,e._y1-i,e._x2-n,e._y2-i,e.Bx),f.Dn(t,e._x1,e._y1,e._x2,e._y2,e.Lx)},A=nt,n(s,$=e),s.prototype.Xx=function(t){this.Px&&this.Px.Xx(t),this.Gx&&this.Gx.Xx(t)},s.prototype.Wx=function(t){var e=this;e.Gx?(t.Jx&&e.Px&&e.Px.Wx(t),t.Kx&&e.Gx.Wx(t)):e.Px&&e.Px.Wx(t)},s.prototype.$x=function(t){var e,n,t,i,r,o,a,s,u,e=this;t&&t.severX&&t.severY?(n=t.severX||0,t=t.severY||0,n=e.Fx?n:-n,s=(i=parseInt(e._x1+(e._x2-e._x1)/2,10))+n,u=(r=parseInt(e._y1+(e._y2-e._y1)/2,10))+t,e.Px=new l(e._x1,e._y1,o=i-n,a=r-t,e._x,1,e.jx),e.Gx=new l(s,u,e._x2,e._y2,e._x,1,e.jx)):(e.Px=new l(e._x1,e._y1,e._x2,e._y2,e._x,1,e.jx),e.Gx=null)},h=s,n(u,tt=e),u.prototype.gHe=function(){var t,e,t;this.YQn&&this.needRightToLeft&&(e=(t=this).Px,t=t.Gx,this.Gx=e,this.Px=t)},Object.defineProperty(u.prototype,"YQn",{get:function(){return this.Px._x1===this.Px._x2},enumerable:!1,configurable:!0}),u.prototype.Xx=function(t){this.Px.Xx(t),this.Gx.Xx(t)},u.prototype.Wx=function(t){var e=this;t.tN?1===t.tN?e.Px.Wx(t):2===t.tN&&e.Gx.Wx(t):(e.Px.Wx(t),e.Gx.Wx(t))},u.prototype.$x=function(){var t,e,n,t,t=this,e={severX:1,severY:1},n=t.Px,t=t.Gx;n.$x(e),t.$x(e)},L=u,t.Zx=N,x.nN=function(t,e,n){var i,i;return t?e?0!=(i=(i=x.eN)[t.style]-i[e.style])||n?i:(e.level||0)-(t.level||0):1:e?-1:0},x.iN=function(t){var t,e,t;if(t){if(t.isGridLine)return 1;if(t.style)return e=G.LineBorder.YC(t.style),t=null==(t=t.line)?void 0:t._zoomFactor,X(t)?e:Z(e*t)}return 0},x.rN=function(t){return t&&6===t.style},x.oN=function(t){return t&&13===t.style},x.aN=function(t,e){return t&&(!e||0<=x.nN(t.style,e.style))?t:e},x.uN=function(t,e){t&&t.line?t.line.Wx(e):t.Wx&&t.Wx(e)},x.sN=function(t,e,n){return t===e?0:t?e?t.isGridLine?e.isGridLine?0:-1:e.isGridLine?1:x.nN(t.style,e.style,n):1:-1},x.cN=function(t){return t&&t.style&&6===t.style.style},x.fN=function(t,e,n,i){var t;return!(!t.style||6!==t.style.style)||(t=0,(t=(t=(t+=e&&e.style&&6===e.style.style?1:0)+(n&&n.style&&6===n.style.style?1:0))+(i&&i.style&&6===i.style.style?1:0))<2)},x.lN=function(t,e,n,i,r,o){var o,n,i,o={_orientation:o?1:0,Jx:0,Kx:0},n=this.sN(t,n),i=this.sN(t,i);0<=n&&0<=i?0===n&&0===i?-1!==r&&1===r&&(o.Kx-=r):-1===r?o.Jx-=r:1===r&&(o.Kx-=2*r):0<=i?(o.tN=2,o.Jx+=r):0<=n&&(o.tN=1,o.Jx+=r),this.uN(t,o)},x.hN=function(t,e,n,i,r,o,a,s,u){var c,s,u,f,l,h,d,d,h,v,o,d,h,i,c={_orientation:s?1:0,tN:u?2:1,Jx:0,Kx:0},s={_orientation:s?1:0,tN:u?1:2,Jx:0,Kx:0},u=1===o?i:r,f=1===a?n:e,l;this.cN(f)?0===(h=this.sN(t,u))?0===(d=this.sN(t,f))?1===a&&(s.Kx-=a):0<d&&(-1===a?s.Jx-=2*a:1===a&&(s.Kx-=2*a)):0<h?0===(d=this.sN(t,f))?1===a&&(s.Kx-=a):0<d&&(-1===a?s.Jx-=2*a:1===a&&(s.Kx-=2*a)):0===(h=this.sN(t,f))?-1===a?c.Jx+=2*a:1===a&&(c.Kx+=2*a):0<h&&(-1===a?c.Jx-=3*a:1===a&&(c.Kx-=3*a)):0<=this.sN(t,u)?-1===a?s.Jx-=2*a:1===a&&(s.Kx-=2*a):-1===a?c.Jx+=2*a:1===a&&(c.Kx+=2*a),d=!1,h=0,this.cN(o=1==(v=1===o?2:1)?i:r)&&0<this.sN(o,t)&&(d=!0,i=x.iN(o),0<this.sN(o,u)?0<i&&(h=1===a&&this.cN(n)?2<=i?2:1:-1===a&&this.cN(e)?3<=i?2:1:3===i?3:2):h=3===i?3:2),d||this.cN(f)||!(f&&!f.isGridLine||o&&!o.isGridLine)||(d=!0,h=-1===a?2:1),d&&(-1===a?(c.Jx+=a*h,s.Jx+=a*h):1===a&&(c.Kx+=a*h,s.Kx+=a*h)),(c.Jx||c.Kx)&&this.uN(t,c),(s.Jx||s.Kx)&&this.uN(t,s)},x.dN=function(t,e,n,i,r,o){var n;0<=this.sN(t,n)&&0<=this.sN(t,i)&&(n={_orientation:o?1:0,Jx:0,Kx:0},-1===r?(n.Jx-=2*r,this.cN(t)&&0<this.sN(e,t)&&--n.Jx):1===r&&(n.Kx-=2*r,this.cN(t))&&0<this.sN(e,t)&&(n.Kx+=1),this.uN(t,n))},x.vN=function(t,e,n,i,r,o){var n,i,n;this.cN(t)&&(n=this.aN(n,i))&&!n.isGridLine&&0<(i=x.iN(n))&&(n={_orientation:o?1:0,Jx:0,Kx:0},-1===r?n.Jx+=i*r:n.Kx+=i*r,n.Jx||n.Kx)&&this.uN(t,n)},x.mN=function(t,e,n,i,r,o,a){var s,u,c,f,n,c=x;(e||n||i)&&(f=c.aN(n,i),c.fN(t,e,n,i)?0<(u=c.sN(f,t,!0))?(s=c.iN(f),c.cN(t)&&(c.cN(n)||c.cN(i)||c.cN(e))||3===s&&c.uN(t,{_orientation:0,Jx:1})):f&&u<0?0<(u=c.sN(t,e,!0))?3===(s=c.iN(f))||2===s?c.uN(t,{_orientation:0,Jx:-2}):1===s&&c.uN(t,{_orientation:0,Jx:-1}):0!==u&&0<c.sN(e,f,!0)&&3===(s=c.iN(f))&&c.uN(t,{_orientation:0,Jx:1}):0===u&&(!e||0<c.sN(t,e,!0))&&(3===(s=c.iN(f))||2===s?c.uN(t,{_orientation:0,Jx:-2}):1===s&&c.uN(t,{_orientation:0,Jx:-1})):c.uN(t,{_orientation:0,Jx:1})),(r||o||a)&&(n=c.aN(o,a),c.fN(t,r,o,a)?0<(u=c.sN(n,t,!0))?(s=c.iN(n),c.cN(t)&&(c.cN(o)||c.cN(a)||c.cN(r))||(3===s?c.uN(t,{_orientation:0,Kx:-2}):2!==s&&1!==s||c.uN(t,{_orientation:0,Kx:-1}))):u<=0&&(0<(u=c.sN(t,r,!0))?3===(s=c.iN(n))&&c.uN(t,{_orientation:0,Kx:1}):0!==u&&c.uN(t,{_orientation:0,Kx:-1})):c.uN(t,{_orientation:0,Kx:-2}))},x.gN=function(t,e,n,i,r,o,a){var s,u,c,f,n,c=x;(e||n||i)&&(f=c.aN(n,i),u=c.sN(f,t,!0),c.fN(t,e,n,i)?0<u?(s=c.iN(f),c.cN(t)&&(c.cN(n)||c.cN(i)||c.cN(e))||3===s&&c.uN(t,{_orientation:1,Jx:1})):u<0?0<(u=c.sN(t,e,!0))?3===(s=c.iN(f))||2===s?c.uN(t,{_orientation:1,Jx:-2}):1===s&&c.uN(t,{_orientation:1,Jx:-1}):0!==u&&0<c.sN(e,f,!0)&&3===(s=c.iN(f))&&c.uN(t,{_orientation:1,Jx:1}):0===u&&0<c.sN(t,e,!0)&&(3===(s=c.iN(f))||2===s?c.uN(t,{_orientation:1,Jx:-2}):1===s&&c.uN(t,{_orientation:1,Jx:-1})):c.uN(t,{_orientation:1,Jx:1})),(r||o||a)&&(n=c.aN(o,a),u=c.sN(t,n,!0),c.fN(t,r,o,a)?u<0?(s=c.iN(n),c.cN(t)&&(c.cN(o)||c.cN(a)||c.cN(r))||(3===s||2===s?c.uN(t,{_orientation:1,Kx:-2}):1===s&&c.uN(t,{_orientation:1,Kx:-1}))):n!==z&&0<=u&&(0<(u=c.sN(t,r,!0))?3===(s=c.iN(n))&&c.uN(t,{_orientation:1,Kx:1}):0!==u&&c.uN(t,{_orientation:1,Kx:-1})):c.uN(t,{_orientation:1,Kx:-2}))},x.pN=function(t,e,n,i,r,o,a,s){var u,c,f,l,l,u=x;s?this.gN(t,e,n,i,r,o,a):this.mN(t,e,n,i,r,o,a),c=u.cN(n),f=u.cN(i),l=u.cN(e),c&&f&&l?u.lN(t,e,n,i,-1,s):c&&!f?u.hN(t,e,r,n,i,1,-1,s,!0):!c&&f?u.hN(t,e,r,n,i,2,-1,s,!1):c&&f&&!l?u.dN(t,e,n,i,-1,s):l&&u.vN(t,e,n,i,-1,s),c=u.cN(o),f=u.cN(a),l=u.cN(r),c&&f&&l?u.lN(t,r,o,a,1,s):c&&!f?u.hN(t,e,r,o,a,1,1,s,!0):!c&&f?u.hN(t,e,r,o,a,2,1,s,!1):c&&f&&!l?u.dN(t,r,o,a,1,s):l&&u.vN(t,r,o,a,1,s)},x.eN=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],x.bN=function(t,e){return!(!t||!e||t.color!==e.color||t.level!==e.level||t.style!==e.style)},F=x,c.prototype.yN=function(){var t,e,n,i,r,o,a,s,u,c,f,t=this;if(t.wN=[],t.MN=[],t.CN=[],t.SN=[],t.TN=[],t.AN={},t.IN={},t.xN={},t.NN={},t.kN={},t.DN={},t._N={},!t.YAe&&(t.JCe.Hc(),e=t.zx,n=t.Vx,e)&&0<e.length&&n&&0<n.length){for(i=t.MN,r=e.length,o=void 0,a=0;a<r;a++)0<(o=e[a]).height&&i.push(o.row);for(i.push(i[i.length-1]+1),s=t.CN,u=n.length,c=void 0,f=0;f<u;f++)0<(c=n[f]).width&&s.push(c.col);s.push(s[s.length-1]+1)}t.Ux=!0},c.prototype.EN=function(t,e,n,i,r,o,a,s){var t;n&&(t={Ky:t,iw:e,jN:n.startColumn,ON:n.endColumn,RN:i,_x:r,_y:o,YC:a,ZC:s},this.SN.push(t))},c.prototype.PN=function(t,e,n,i,r,o,a,s,u,c,f){var l,h,s,d,v,g,m,p,S,w,b,C,l=this,h=l.YAe;l.Ux||l.yN(),s?l.wN.push(s):(C=b=w=S=p=m=g=v=d=s=void 0,a&&(s=a.borderLeft,d=a.borderTop,v=a.borderRight,g=a.borderBottom,C=a.backColor,f&&2===f.columnHeaderFitMode||(m=a.diagonalDown,p=a.diagonalUp),f&&f.sheetArea!==K&&3!==f.sheetArea||(S=a.textOrientation),w=a.isVerticalText,b=a.textIndent),h||!C||s||v||d||g||l.TN.push({r:t,c:e,rc:1,cc:1}),l.GN(t,e,n,i,r,o,s,d,v,g,m,p,C,!1,!1,u,c,S,w,b&&0!==b,f))},c.prototype.GN=function(t,e,n,i,r,o,a,s,u,c,f,l,h,F,_,A,L,d,v,g,m){var p,S,w,b,C,y,D,j,M,k,T,x,G,f,B,I,P,G,R,N,E,H,v,g,O,U,T,v,d,P,E,M,B,I,H,U,l,R,N,f,G,H,B,V,E,p=this,S=p.Mf,w=S.Jt,b=m&&p.YAe,C=!1,y=!1,D=!1,j=!1,M=function(t){return t!==K&&t&&-90<=t&&t<=90},k=M(d),T=a||s||u||c,P=0,G=0,R=n,N=r;e+1<S.getColumnCount()&&(E=w.qt(t,e+1)),0<=e-1&&(H=w.qt(t,e-1)),v=k&&!v&&!g&&m&&m.data,g=X(m&&m.printZoomFactor)?1:m.printZoomFactor,U=!(O=T&&v&&d%90!=0),!b&&T&&(v&&(B=W(d*Q/180),I=J(B),P=Math.floor(o/I),-90<d&&d<0&&(R=n-P),0<d)&&d<90&&(R=n+P),k||(E&&M(E.textOrientation)&&(B=W(E.textOrientation*Q/180),I=J(B),G=Math.floor(o/I),0<E.textOrientation&&E.textOrientation<90&&(N=r+G),E.textOrientation<0)&&-90<E.textOrientation&&(N=r-G),H&&M(H.textOrientation)&&(B=W(H.textOrientation*Q/180),I=J(B),G=Math.floor(o/I),-90<H.textOrientation&&H.textOrientation<0&&(N+=G,R=n-G),0<H.textOrientation)&&H.textOrientation<90&&(N-=G,R=n+G))),T=m?m.rowSpacingIndex:K,v=m?m.isAfterRowSpacing:K,P=(d=this.Mf.options.rightToLeft)?Z(-1*g):0,E=R+N-.5,M=n+r-.5,B=R-.5,I=n-.5,f&&U&&p.UN(t,e,n-1,i-1,n+r,i+o,f,p.kN,z,{printZoomFactor:g,rowSpacingIndex:T,isAfterRowSpacing:v}),l&&U&&p.UN(t,e,n+r,i-1,n-1,i+o,l,p.DN,z,{printZoomFactor:g,rowSpacingIndex:T,isAfterRowSpacing:v}),s&&0<o&&(C=p.UN(t,e,R+P,i-.5,R+N+P,i-.5,s,p.xN,k,{printZoomFactor:g,rowSpacingIndex:T,isAfterRowSpacing:v})),a&&0<N&&(y=p.UN(t,e,d?E:B,i,d?M:I,i+o,a,p.NN,k,{printZoomFactor:g,rowSpacingIndex:T,isAfterRowSpacing:v})),u&&0<N&&(H=p.JCe.KCe(e,null==m?void 0:m.sheetArea),j=m&&m.columnHeaderFitMode===Y.ColumnHeaderFitMode.stack&&!X(m.cornerX)?(x=m.cornerX,G=m.cornerY,p.UN(t,H,R+N-.5,i,n+r-.5,i+(f=G-i),u,p.NN,k,{isMultiLine:!0,multiLinePart:"topVertical",printZoomFactor:g}),p.UN(t,H,x,i+f-.5,n+r-.5,i+f-.5,u,p.xN,k,{isMultiLine:!0,multiLinePart:"horizontal",printZoomFactor:g}),p.UN(t,H,x-.5,G,x-.5,i+o,u,p.NN,k,{isMultiLine:!0,multiLinePart:"bottomVertical",printZoomFactor:g})):p.UN(t,H,d?B:E,i,d?I:M,i+o,u,p.NN,k,{printZoomFactor:g,rowSpacingIndex:T,isAfterRowSpacing:v})),c&&0<o&&(U=p.JCe.sD(t,null==m?void 0:m.sheetArea),D=m&&m.columnHeaderFitMode===Y.ColumnHeaderFitMode.stack&&!X(m.cornerX)?(x=m.cornerX,p.UN(U,e,n+P,i+o-.5,x+P,i+o-.5,c,p.xN,k,{printZoomFactor:g})):p.UN(U,e,n+P,i+o-.5,n+r+P,i+o-.5,c,p.xN,k,{printZoomFactor:g,rowSpacingIndex:T,isAfterRowSpacing:v})),l=b&&S.ZAe?S.ZAe(t,m.rowSpacingIndex,m.isAfterRowSpacing):S.Jt.Gt(t),h&&0!==l&&0!==S.Jt.Kt(e)||(R=S.iVe&&S.iVe(t,e),N=!D&&!F&&(!R||R.bottom),f=!j&&!_&&(!R||R.right),G=!C&&!F&&(!R||R.top),H=!y&&!_&&(!R||R.left),(N||f||G||H)&&(B={},b&&(B.rowSpacingIndex=T,B.isAfterRowSpacing=v,f=!1,S.QAe&&!S.QAe(t,T,v)&&(N=!1),E=w.qt(V=v?t+1:t,e,m.sheetArea,K))&&E.borderTop&&(N=!1),p.HN(t,e,n,i,r,o,N,f,A,L,m&&m.clipRect,B))),!C&&!h||k||p.zN(t-1,e,p.AN),(y||h)&&p.zN(t,e-1,p.IN),!h||a||u||s||c||(p.VN(t-1,e-1,p.IN,!1),p.VN(t-1,e-1,p.AN,!0))},c.prototype.UN=function(t,e,n,i,r,o,a,s,u,c){var f,l,h,d,c,v,g,m,m;return!!a&&(h=l=f=void 0,c&&(f=c.isMultiLine,l=c.multiLinePart,h=c.printZoomFactor),d=c.rowSpacingIndex,c=c.isAfterRowSpacing,v=this.YN(t,e,s,{noCreate:!0,rowSpacingIndex:d,isAfterRowSpacing:c}),g=this.Mf.options.rightToLeft,v?f?((m=N(n,i,r,o,a.color,a.style,u,h,void 0,g)).multiLinePart=l,v.splitLines||(v.splitLines=[]),"horizontal"===l&&(v.line=m),v.splitLines.push(m)):u||6!==v.style.style&&(6===a.style||0<F.nN(a,v.style))?(v.line=N(n,i,r,o,a.color,a.style,u,h,void 0,g),v.style=a):v.line&&!v.splitLines&&o-i!=v.line._y2-v.line._y1&&(v.line._y2=o,v.line._y1=i):(m=N(n,i,r,o,a.color,a.style,u,h,void 0,g))&&((v=this.YN(t,e,s,{rowSpacingIndex:d,isAfterRowSpacing:c})).line=m,v.style=a,f)&&(v.line.multiLinePart=l,v.splitLines=[v.line]),v)&&v.line!==z},c.prototype.HN=function(t,e,n,i,r,o,a,s,u,c,f,l){var h,d,v,g,d,a,a,u,a,v,m,r;void 0===l&&(l={}),d=3===(h=this).nT,v=h.Mf.options.gridline,g=h.Mf.options.rightToLeft,d&&v&&(d=v.color,v.showHorizontalGridline&&(a&&((a=h.YN(t,e,h.AN,l)).isGridLine=!0,a.line=N(n,i+o-.5,n+r,i+o-.5,d,K,K,K,f,g)),u)&&((a=h.YN(-1,e,h.AN,{noCreate:!1,isTopLeftGridline:!0,rowSpacingIndex:l.rowSpacingIndex,isAfterRowSpacing:l.isAfterRowSpacing})).isGridLine=!0,a.line=N(n,i-.5,n+r,i-.5,d,K,K,K,f,g)),v.showVerticalGridline)&&(u=n+r-.5,a=n-.5,s&&((v=h.YN(t,e,h.IN,l)).isGridLine=!0,v.line=N(m=g?a:u,i,m,i+o,d,K,K,K,f,g)),c)&&(m=g?u:a,(r=h.YN(t,-1,h.IN,{noCreate:!1,isTopLeftGridline:!0,rowSpacingIndex:l.rowSpacingIndex,isAfterRowSpacing:l.isAfterRowSpacing})).isGridLine=!0,r.line=N(m,i,m,i+o,d,K,K,K,f,g))},c.prototype.VN=function(t,e,n,i){var t,r,t=this.YN(t,e,n,{noCreate:!0});t&&t.line&&t.line.Wx({_orientation:i?0:1,Kx:-1})},c.prototype.zN=function(t,e,n){var n,i;(0<=t&&0<=e||0===t&&-1===e||-1===t&&0===e)&&(n=n[t])&&(i=n[e])&&delete n[e]},c.prototype.YN=function(t,e,n,i){var r,o,r,i,r=(i=void 0===i?{}:i).isTopLeftGridline,o=i.noCreate;if(!r&&(-1===t||-1===e))return z;if(this.YAe&&this.WAe)return this.WAe(t,e,n,i);if(!(r=n[t])){if(o)return z;n[t]=r={}}if(!(i=r[e])){if(o)return z;r[e]=i={}}return i},c.prototype.ZN=function(){for(var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,u,p,S,w,h,b,C,y,b,f,M,k,T,x,G,B,I,P,R,t=this,e=t.SN,n=e.length,i=t.NN,r=t.xN,o=t.IN,a=t.AN,s=0;s<n;s++)if(c=(u=e[s]).Ky,f=u.iw,l=u.jN,h=u.RN,d=u.ON,g=u._x,m=u.YC,u=u.ZC,p=g,S=v=void 0,w=h.textOrientation,h=h.borderTop,!(b=e[s-1])||b.Ky!==c||b.jN!==l||b.ON!==d){for(C=l;C<d;C++)(v=t.YN(c,C+1,i,{noCreate:!0}))&&!w?t.zN(c,C+1,i):(y=C,(v=t.YN(c,y,o,{noCreate:!0}))&&t.zN(c,y,o));if(b=t.YN(c,f,r,{noCreate:!0}),w&&h&&!b)for(f=void 0,f=u/Math.tan(Math.abs(w*Math.PI/180)),-90<w&&w<0&&(p=g-f),S=(p=0<w&&w<90?g+f:p)+m,M=l;M<d+1;M++)if(T=(k=t.YN(c-1,M,a,{noCreate:!0}))&&k.line)for(k.splitLines||(k.splitLines=[],k.splitLines.push(T)),x=0;x<k.splitLines.length;x++)if(B=(G=k.splitLines[x])._x1,I=G._x2,P=G._y1,R=G._y2,B<p&&I<S&&p<I)G._x2=p;else if(p<B&&I<S)t.zN(c-1,M,t.AN);else if(p<B&&S<I&&B<S)G._x1=S;else if(B<p&&S<I){k.splitLines.splice(x,1,N(B,P,p,P,G.color),N(S,R,I,R,G.color));break}}},c.prototype.WN=function(t,e){var n,i,r,o,n=this.wN,i=n.length;if(0<i)for(o=0;o<i;o++)r=n[o],this.QN(r,t,e)},c.prototype.KN=function(){var t,e,n,i,r,o,a,s;if(this._N={},0<(e=(t=this.wN).length))for(i=0;i<e;i++)for(n=t[i],r=0;r<n.rowCount;r++)for(o=r+n.row,this._N[o]=this._N[o]||{},a=0;a<n.colCount;a++)s=a+n.col,this._N[o][s]=n},c.prototype.QN=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,d,s,N,E,H,d,H,E,d,s,U,i=this,r=t.row,o=t.col,a=t.x,s=t.y,u=t.spanSizeInfo,d=u.styleList[0][0],v=d?d.backColor:z,T=a,x=s,G=null,B=!0,I=null,P=!0,d=i.Mf,s=d.N9(3),N=d.k9(3),E=d.Fi(),H=d.options.sheetAreaOffset,d=d.gj&&d.gj()||{x:H.left,y:H.top,width:0,height:0},H=0===E.qC&&0===d.height,E=0===E.XC&&0===d.width,d=r===s&&H||n&&0===t.vIndex,s=o===N&&E||n&&0===t.hIndex;if(1===t.rowCount)for(m=r,S=u.rowSizes[0],g=0;g<t.colCount;g++)b=0===g,y=g===t.colCount-1,p=o+g,w=u.colSizes[g],k=u.styleList[0][g],m===t.row&&p===t.col&&(G=(R=k)&&R.diagonalDown,I=R&&R.diagonalUp),k?(c=k.borderLeft,f=k.borderTop,l=k.borderRight,h=k.borderBottom,B=B&&F.bN(G,k.diagonalDown),P=P&&F.bN(I,k.diagonalUp)):c=f=l=h=z,b?i.GN(m,p,T,x,w,S,c,f,z,h,z,z,v,!1,!0,z,z,z,z,z,{printZoomFactor:e}):y?i.GN(m,p,T,x,w,S,z,f,l,h,z,z,v,!1,!1,z,z,z,z,z,{printZoomFactor:e}):i.GN(m,p,T,x,w,S,z,f,z,h,z,z,v,!1,!0,z,z,z,z,z,{printZoomFactor:e}),T+=w;else if(1===t.colCount)for(p=o,w=u.colSizes[0],g=0;g<t.rowCount;g++)C=0===g,M=g===t.rowCount-1,S=u.rowSizes[g],k=u.styleList[g][0],(m=r+g)===t.row&&p===t.col&&(G=(R=k)&&R.diagonalDown,I=R&&R.diagonalUp),k?(c=k.borderLeft,f=k.borderTop,l=k.borderRight,h=k.borderBottom,B=B&&F.bN(G,k.diagonalDown),P=P&&F.bN(I,k.diagonalUp)):c=f=l=h=z,C?i.GN(m,p,T,x,w,S,c,f,l,z,z,z,v,!0,!1,z,z,z,z,z,{printZoomFactor:e}):M?i.GN(m,p,T,x,w,S,c,z,l,h,z,z,v,!1,!1,z,z,z,z,z,{printZoomFactor:e}):i.GN(m,p,T,x,w,S,c,z,l,z,z,z,v,!0,!1,z,z,z,z,z,{printZoomFactor:e}),x+=S;else for(g=0;g<t.rowCount;g++){for(m=r+g,C=0===g,M=g===t.rowCount-1,S=u.rowSizes[g],U=0;U<t.colCount;U++)p=o+U,b=0===U,y=U===t.colCount-1,w=u.colSizes[U],k=u.styleList[g][U],m===t.row&&p===t.col&&(G=(R=k)&&R.diagonalDown,I=R&&R.diagonalUp),k?(c=k.borderLeft,f=k.borderTop,l=k.borderRight,h=k.borderBottom,B=B&&F.bN(G,k.diagonalDown),P=P&&F.bN(I,k.diagonalUp)):c=f=l=h=z,C?b?i.GN(m,p,T,x,w,S,c,f,z,z,z,z,v,!0,!0,z,z,z,z,z,{printZoomFactor:e}):y?i.GN(m,p,T,x,w,S,z,f,l,z,z,z,v,!0,!1,z,z,z,z,z,{printZoomFactor:e}):i.GN(m,p,T,x,w,S,z,f,z,z,z,z,v,!0,!0,z,z,z,z,z,{printZoomFactor:e}):M?b?i.GN(m,p,T,x,w,S,c,z,z,h,z,z,v,!1,!0,z,z,z,z,z,{printZoomFactor:e}):y?i.GN(m,p,T,x,w,S,z,z,l,h,z,z,v,!1,!1,z,z,z,z,z,{printZoomFactor:e}):i.GN(m,p,T,x,w,S,z,z,z,h,z,z,v,!1,!0,z,z,z,z,z,{printZoomFactor:e}):b?i.GN(m,p,T,x,w,S,c,z,z,z,z,z,v,!0,!0,z,z,z,z,z,{printZoomFactor:e}):y&&i.GN(m,p,T,x,w,S,z,z,l,z,z,z,v,!0,!1,z,z,z,z,z,{printZoomFactor:e}),T+=w;T=a,x+=S}i.GN(t.row,t.col,t.x,t.y,t.width,t.height,z,z,z,z,G=B?G:null,I=P?I:null,v,!d,!s,d,s,z,z,z,{printZoomFactor:e}),!v||c||l||f||h||i.TN.push({r:r,c:o,rc:t.rowCount,cc:t.colCount})},c.prototype.Wx=function(){var t,e,n,i,r,t=this,e=!1,n=!1,i=!1,r=!1;o(t.NN)||(e=!0),o(t.xN)||(n=!0),(e||n)&&(t.JN(),t.XN()),o(t.kN)||(i=!0),o(t.DN)||(r=!0),(i||r)&&t.qN(),0<t.TN.length&&t.$N()},c.prototype.t6=function(t,e,n,i,r){var o,a,o=this,a=this._N[t]?this._N[t][e]:null;if(a)switch(r){case g:return o.n6(t,e,n,i);case m:case p:return o.n6(t,e+a.colCount-1,n,i);case S:case M:return o.n6(t+a.rowCount-1,e+a.colCount-1,n,i);case k:case T:return o.n6(t+a.rowCount-1,e,n,i);case _:return o.n6(t,e,n,i)}return o.n6(t,e,n,i)},c.prototype.qN=function(){for(var t,e,n,i,r,o,a,s,u,c,c,c,c,f,l,c,c,c,c,h,d,v,t=this,e=t.MN,n=t.CN,i=e.length,r=n.length,f={},l={},o=0;o<i;o++)for(s=e[o],a=0;a<r;a++)u=n[a],h=t.YN(s,u,t.kN,{noCreate:!1}),d=t.YN(s,u,t.DN,{noCreate:!1}),(h||d)&&(F.cN(h)&&F.cN(d)&&(h.line.$x(),d.line.$x()),(c=t.t6(s,u,!(v=[]),f,g))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,h,!0,1),(c=t.t6(s,u,!1,f,m))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,d,!0,1),(c=t.t6(s,u,!0,l,_))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,h,!0,0),(c=t.t6(s,u,!0,l,T))&&c.line&&!c.isGridLine&&t.e6(v=[1,1,2],c,d,!1,0),(c=t.t6(s+1,u,!1,f,k))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,d,!1,1),(c=t.t6(s+1,u,!1,f,M))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,h,!1,1),(c=t.t6(s,u+1,!0,l,p))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,d,!0,0),c=t.t6(s,u+1,!0,l,S))&&c.line&&!c.isGridLine&&t.e6(v=[-1,-2,-2],c,h,!1,0)},c.prototype.e6=function(t,e,n,i,r){var o,a,e,o,t,o=F.cN(e),a=F.oN(e),e=e.line.Ex;o&&(e=3),o=t[(e=a?2:e)-1],n&&n.line&&(t={_orientation:r},i?t.Jx=o:t.Kx=o,n.line.Wx(t))},c.prototype.$N=function(){for(var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,t=this,e=t.TN,n=e.length,i=0;i<n;i++){for(u=(s=o=(r=e[i]).r)-1,c=(a=r.c)-1,f=a,1<r.rc&&(s+=r.rc-1),1<r.cc&&(f+=r.cc-1),h=l=!1,d=i+1;d<n&&((v=e[d]).c===f+1&&v.r===o&&(h=!0),!(l=v.r===s+1&&v.c===a?!0:l)||!h)&&!(v.r>o+1&&v.c>a+1);d++);l||t.VN(s,c,t.AN,!0),h||t.VN(u,f,t.IN,!1)}},c.prototype.JN=function(){for(var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,b,t=this,e=t.Mf,n=e.Ut,i=t.MN,r=t.CN,o=i.length,a=r.length,l={},h={},s=0;s<o;s++)for(c=i[s],u=0;u<a;u++){if(f=r[u],T=t.YN(c,f,t.NN,{noCreate:!(k=M=0)})){if(T.line&&T.line.jx)continue;M++}else T=t.YN(c,f-1,t.IN,{noCreate:!0});if((x=t.YN(c,f,t.xN,{noCreate:!0}))?k++:x=t.YN(c-1,f,t.AN,{noCreate:!0}),T||x){if((d=0===s?z:t.n6(i[s-1],f,!0,h))&&d.line&&!d.isGridLine&&(M++,k++),(v=0===u?z:t.n6(c,r[u-1],!1,l))&&v.line&&!v.isGridLine&&(M++,k++),T)for(G=[T],T.splitLines&&0<T.splitLines.length&&(G=T.splitLines),B=0;B<G.length;B++)(I=G[B]).style=T.style,(g=t.n6(c,f,!1,l))&&g.line&&!g.isGridLine&&M++,s!==o-1&&(p=t.n6(i[s+1],f,!0,h))&&p.line&&!p.isGridLine&&M++,0!==u&&s!==o-1&&(S=t.n6(i[s+1],r[u-1],!1,l))&&S.line&&!S.isGridLine&&M++,s!==o-1&&(w=t.n6(i[s+1],f,!1,l))&&w.line&&!w.isGridLine&&M++,0<M&&("topVertical"===I.multiLinePart?(P=n.i6(f,0),R=e.r6(P),2===e.Lt(R)&&(P=e.O5(P)),N=e.O5(f),g=t.n6(c,P,!1,l),p=t.n6(c,N,!0,h),S=I,w=z):"bottomVertical"===I.multiLinePart&&(g=I,p=v=d=z,S=t.n6(i[s+1],r[u-1],!1,l),w=t.n6(i[s+1],r[u],!1,l)),F.rN(T.style)?F.pN(I,d,v,g,p,S,w,!0):F.oN(T.style)||F.gN(I,d,v,g,p,S,w));x&&((m=t.n6(c,f,!0,h))&&m.line&&!m.isGridLine&&k++,u!==a-1&&(b=r[u+1],2===e.Lt(b)&&(b=n.i6(b,0),b=e.O5(b)),b=t.n6(c,b,!1,l))&&b.line&&!b.isGridLine&&k++,0!==s&&u!==a-1&&(C=t.n6(i[s-1],r[u+1],!0,h))&&C.line&&!C.isGridLine&&k++,u!==a-1&&(y=t.n6(c,r[u+1],!0,h))&&y.line&&!y.isGridLine&&k++,0<k)&&(x.line&&"horizontal"===x.line.multiLinePart&&(P=n.i6(f,0),R=e.r6(P),2===e.Lt(R)&&(P=e.O5(P)),b=d=v=z,C=m=x,y=t.n6(c,P,!0,h)),F.rN(x.style)?F.pN(x,v,d,m,b,C,y,!1):F.oN(x.style)||F.mN(x,v,d,m,b,C,y))}}},c.prototype.o6=function(t,e,n,i){var r,o,n,r=this,o=this._N[t]?this._N[t][e]:null,n=n?r.DN:r.kN;return o?t===o.row&&e===o.col&&i===w||t===o.row&&e===o.col+o.colCount-1&&i===b||t===o.row+o.rowCount-1&&e===o.col+o.colCount-1&&i===C||t===o.row+o.rowCount-1&&e===o.col&&i===y?r.YN(o.row,o.col,n,{noCreate:!1}):void 0:r.YN(t,e,n,{noCreate:!1})},c.prototype.XN=function(){for(var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,S,t=this,e=t.MN,n=t.CN,i=e.length,r=n.length,o=0;o<i;o++)for(s=e[o],a=0;a<r;a++)u=n[a],(S=t.YN(s,u,t.NN,{noCreate:!0}))&&S.line&&S.line._noNeedAdjust||(S&&S.line&&F.cN(S)&&(c=t.o6(s,u,!1,w),f=t.o6(s,u,!0,y),l=F.cN(c),h=F.cN(f),d=t.o6(s,u-1,!1,C),v=t.o6(s,u-1,!0,b),g=F.cN(d),m=F.cN(v),c&&l&&S.line.Wx(p={tN:2,_orientation:1,Jx:2}),f&&h&&S.line.Wx(p={tN:2,_orientation:1,Kx:-2}),d&&g&&S.line.Wx(p={tN:1,_orientation:1,Kx:-2}),v)&&m&&S.line.Wx(p={tN:1,_orientation:1,Jx:2}),(S=t.YN(s,u,t.xN,{noCreate:!0}))&&S.line&&F.cN(S)&&(c=t.o6(s,u,!1,w),f=t.o6(s,u,!0,b),l=F.cN(c),h=F.cN(f),d=t.o6(s-1,u,!1,C),v=t.o6(s-1,u,!0,y),g=F.cN(d),m=F.cN(v),c&&l&&S.line.Wx(p={tN:2,_orientation:0,Jx:2}),f&&h&&S.line.Wx(p={tN:2,_orientation:0,Kx:-2}),d&&g&&S.line.Wx(p={tN:1,_orientation:0,Kx:-2}),v)&&m&&S.line.Wx(p={tN:1,_orientation:0,Jx:2}))},c.prototype.n6=function(t,e,n,i){var r,i,r=i[t];return i=(i=(r=r||(i[t]={}))[e])===K?r[e]=this.a6(t,e,n):i},c.prototype.a6=function(t,e,n){var i,r,o;if(t===K||t<0||e===K||e<0)return z;if(i=this,r=n?i.NN:i.xN,o=i.YN(t,e,r,{noCreate:!0}))return o;if(r=n?i.IN:i.AN,n){if(--e<0)return z}else if(--t<0)return z;return(o=i.YN(t,e,r,{noCreate:!0}))||z},c.prototype.paint=function(t,e,n){var i,r,i=this;i.Ux&&(r=i.YAe,i.Hx||(r||(i.KN(),i.WN(e,n)),i.ZN(),i.Wx(),i.Hx=!0),t.save(),i._e(t),t.restore())},c.prototype._e=function(t){this.u6(t),this.s6(t)},c.prototype.u6=function(t){var e=this;e.c6(t,e.AN),e.c6(t,e.IN)},c.prototype.s6=function(t){var e=this;e.c6(t,e.xN),e.c6(t,e.NN),e.c6(t,e.kN),e.c6(t,e.DN)},c.prototype.c6=function(t,e){var n,i,r,o,a,s;if(this.YAe&&this.JAe)this.JAe(t,e);else for(n in a=o=r=i=n=void 0,e)if(e[n])for(i in r=e[n])if(r[i])if(o=r[i].line,(a=r[i].splitLines)&&0<a.length)for(s=0;s<a.length;s++)a[s]&&a[s]._e(t);else o&&o._e(t)},t.Yx=c},"./dist/core/worksheet/worksheet-clipboard.js":function(a,t,e){"use strict";var n,s,et,nt,q,u,f,S,G,m,l,i,r,h,b,$,it,d,U,c,F,C,e,rt,ot,w,M,B,v,g,i,k,T,x,R,N;function y(t){var t=t.parent;return t&&t.options.allowCopyPasteExcelStyle}function at(t){var t=t.parent;return t&&t.options.allowExtendPasteRange}function I(t){var t=t.parent;return t&&t.options.copyPasteHeaderOptions}function E(t,e,n,i,r,o){var a,s,u,c,f,l,h,a=$,s=(0,q.parseText)(t,e,n,i,r,o);if(s){for(u=s.length,c=(0,q.getMaxLength)(s),f=[],l=0;l<u;l++)for(f[l]=[],h=0;h<c;h++)h<s[l].length?f[l][h]=s[l][h]:f[l][h]=$;a=f}return a}function st(t,e){return t.tables&&t.tables.Uue(e)}function K(t,e){for(var n,i,n=e.row;n<e.row+e.rowCount;n++)for(i=e.col;i<e.col+e.colCount;i++)if(!ot(t.getValue(n,i)))return;return 1}function ut(t,e){return-1!==t.col&&-1!==t.colCount&&t.colCount!==e}function ct(t,e){return-1===t.row||-1===t.rowCount||t.rowCount===e}function p(t,e,n,i,r){if(!(t<=r.row&&e<=r.col&&t+n>=r.row+r.rowCount&&e+i>=r.col+r.colCount||r.col>e+i||r.col+r.colCount-1<e||r.col>e+i-1||r.col+r.colCount-1<e||r.row+r.rowCount-1<t||e===r.col&&i===r.colCount&&t>r.row))return!0}function ft(t,e){return t.tables&&t.tables.Uue(e)}function dt(t,e,n,i,r){return t.tables&&t.tables.oSt(e,n,i,r)}function lt(t,e,n,i,r){var o,e,a,o=e.rowCount,e=e.colCount,a=!1;return r===et.InsertShiftCell.right?(e=1,i===t.col&&(a=!0)):(o=1,n===t.row&&(a=!0)),(-1===t.row||-1===t.col)&&t.intersect(n,i,o,e)&&!t.equals(new nt.Range(n,i,o,e))&&!a}function P(t){return(t&et.CopyToOptions.style)<=0}function H(t,e){var n,i,r,t,o,a,s,e,u,n,o,i,a,n=t.row,i=t.col,r=t.row+t.rowCount,t=t.col+t.colCount,o=e.row,a=e.col,s=e.row+e.rowCount,e=e.col+e.colCount,u;return U(n,o)<=c(r,s)&&U(i,a)<=c(t,e)&&(n=U(n,o),o=U(i,a),i=c(r,s)-n,a=c(t,e)-o,new nt.Range(n,o,i,a))}function A(e,t){var n=[];return t.forEach(function(t){var t=H(e,t);t&&n.push(t)}),n}function L(t,e){t&&b&&t.suspendCalcService(e)}function D(t,e){t&&b&&t.resumeCalcService(e)}function _(t,e){return e===et.ClipboardPasteOptions.formatting&&t.options.protectionOptions.formatCells}function Y(t,e,n,i,r){t.ki("shiftCellsDown",{row:i,col:r,changedRowCount:i-e,changedColCount:r-n,srcRow:e,srcColumn:n},!0)}function tt(t,e,n,i){var t,n,i,r,o,a,s;e&&n&&i!==it&&(n=e.Ky,i=e.iw,r=e.Sx,o=e.Tx,a={showHeader:e.showHeader(),showFooter:e.showFooter(),useFooterDropDownList:e.useFooterDropDownList(),showResizeHandle:e.showResizeHandle()},s=e.style(),t.tables._Qt(e.name(),n,i,r,o,null!=(t=s.name())?t:s,a,!0),e.L0())}function vt(t,e,n,i,r,o){for(var a,s,u,c,f,l,h,d,v,d,g,a=t.Ut.getSpans(),s=t.tables&&t.tables.U3,u=t.pivotTables&&t.pivotTables.all(),c=0;c<a.length;c++)if(!(e<=(f=a[c]).row&&n<=f.col&&e+i>=f.row+f.rowCount&&n+r>=f.col+f.colCount||f.row>e+i||f.row+f.rowCount-1<e||f.row>e+i-1||f.row+f.rowCount-1<e||f.col+f.colCount-1<n))return 1;if(s)for(c=0;c<s.length;c++)if(l=s.get(c),(ot(o)||l.name()!==o)&&!(e<=l.Ky&&n<=l.iw&&e+i>=l.Ky+l.Sx&&n+r>=l.iw+l.Tx||l.Ky>e+i||l.Ky+l.Sx-1<e||l.Ky>e+i-1||l.Ky+l.Sx-1<e||l.iw+l.Tx-1<n))return 1;if(u)for(c=0;c<u.length;c++)if(v=(d=(h=u[c]).getRange()).content,d=d.page,g=void 0,g=!(g=v?p(e,n,i,r,v):g)&&d?p(e,n,i,r,d):g)return 1}function j(t,e){var n,t,i,e,r,o,a;return!t||(n=t.row,t=t.col,i=e.row,e=e.col,-1!==n&&-1!==t)||(r=-1===n&&-1!==t)&&i<=0||(o=-1===t&&-1!==n)&&e<=0||(a=-1===n&&-1===t)&&i<=0&&e<=0}function gt(t,e,n,i,r,o){for(var a,s,u,c,f,l,h,d,v,d,g,a=t.Ut.getSpans(),s=t.tables&&t.tables.U3,u=t.pivotTables&&t.pivotTables.all(),c=0;c<a.length;c++)if(!(e<=(f=a[c]).row&&n<=f.col&&e+i>=f.row+f.rowCount&&n+r>=f.col+f.colCount||f.col>n+r||f.col+f.colCount-1<n||f.col>n+r-1||f.col+f.colCount-1<n||f.row+f.rowCount-1<e))return 1;if(s)for(c=0;c<s.length;c++)if(l=s.get(c),(ot(o)||l.name()!==o)&&!(e<=l.Ky&&n<=l.iw&&e+i>=l.Ky+l.Sx&&n+r>=l.iw+l.Tx||l.iw>n+r||l.iw+l.Tx-1<n||l.iw>n+r-1||l.iw+l.Tx-1<n||l.Ky+l.Sx-1<e||n===l.iw&&r===l.Tx&&e>l.Ky))return 1;if(u)for(c=0;c<u.length;c++)if(v=(d=(h=u[c]).getRange()).content,d=d.page,g=void 0,g=!(g=v?p(e,n,i,r,v):g)&&d?p(e,n,i,r,d):g)return 1}function mt(t,e,n,i,r){for(var o,a,s,u,c,f,l,h,d,o=t.Ut.getSpans(),a=t.tables.U3,s=e;s<e+i;s++)for(u=n;u<n+r;u++){if(c=t.getCell(s,u),!ot(c.value())||c.backColor()||c.comment()||c.tag())return!0;for(f=0;f<o.length;f++)if(s>=(l=o[f]).row&&s<=l.row+l.rowCount-1&&u>=l.col&&u<=l.col+l.colCount-1)return!0;for(h=0;h<a.length;h++)if(s>=(d=a.get(h)).Ky&&s<=d.Ky+d.Sx-1&&u>=d.iw&&u<=d.iw+d.Tx-1)return!0}return!1}function O(t,e){var t;return null!=(t=t.getSpan(e.row,e.col))&&t.equals(e)}function V(t,e){var n,i,r,o,a,s,u;if(t&&1<(n=t.length)){for(i=void 0,i=0;i<n;i++)for(r=t[i],o=i+1;o<n;o++)if(a=t[o],r.intersect(a.row,a.col,a.rowCount,a.colCount))return;for(s=t[0],u=void 0,i=1;i<n&&(u=t[i],s.row===u.row&&s.rowCount===u.rowCount);i++);if(n<=i)return e&&(e.inSameRow=!0),1;for(i=1;i<n&&(u=t[i],s.col===u.col&&s.colCount===u.colCount);i++);if(n<=i)return e&&(e.inSameCol=!0),1}}function ht(t,e){return x.call(this,t,e)||this}function o(t,e,n){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,n,p,r,S,w,b,C,y,M,k,T,M,x,G,i=this;if(i=R.call(this,t,e)||this,!n){if(a=e.fromSheet,!(o=t))throw new Error(rt().Exp_DestSheetIsNull);if(u=(s=e).pastedRanges,c=o.o5(),u&&!(u.length<=0))if(e.cachedActions=[],l=(f=s.fromRanges||[s.fromRange]).length,h=s.isCutting,d=s.clipboardText,v=s.clipboardHtml,g=s.clipboardImage,m=s.pasteOption,n={},p=u[0],r=null==(r=s.pasteSpecialOptions)?void 0:r.transpose,!h&&a&&V(f,n)&&p.equals(a.fT(f,p,r))){for(S=n.inSameRow,w=n.inSameCol,r&&(S=(n=[w,S])[0],w=n[1]),S?f.sort(function(t,e){return t.col-e.col}):w&&f.sort(function(t,e){return t.row-e.row}),b=p.row,C=p.col,y=0;y<l;y++)k=(M=f[y]).rowCount,T=M.colCount,c&&(k+=t.lT(b,k,!0),T+=t.lT(C,T)),M={sourceRange:M,targetRange:(0,nt.Ec)(b,C,k,T),isCutting:h,clipboardText:d,clipboardHtml:v,clipboardImage:g,includeFilteredOutRow:!0,pasteSpecialOptions:s.pasteSpecialOptions},e.cachedActions[y]=new B(t,{fromSheet:a,toSheet:o,pasteExtent:M,pasteOption:m}),S?C+=T:w&&(b+=k);e.hT=!0}else for(x=0;x<u.length;x++)G={sourceRange:f[0],targetRange:u[x],isCutting:h,clipboardText:d,clipboardHtml:v,clipboardImage:g,pasteSpecialOptions:s.pasteSpecialOptions},e.cachedActions[x]=new B(t,{fromSheet:a,toSheet:o,pasteExtent:G,pasteOption:m})}return i}function z(t,e){return N.call(this,t,e)||this}function W(t,e,n,i,r,o,a){var s,u,c,f,e,l,h,d,n,v,g,i,s=e.row,u=e.col,c=e.rowCount,f=e.colCount,e=0===n||2===n||4===n||5===n;if(r&&e)for(d=(h=(l=t.Ut).getSpans((0,nt.Ec)(s,u,c,f))).length-1;0<=d;d--)l.do("removeSpan",h[d]);if(b&&0<(1&i)&&t.clearFormula(s,u,c,f,function(t,e){return!t.XT||!t.XT(e)}),n=t.ST(),r&&""!==r||a&&""!==a)t.parent&&t.parent.options.allowAutoCreateHyperlink&&1===c&&1===f&&(m.Common.$T.qT(w).test(r)||m.Common.$T.qT(M).test(r))&&t.setHyperlink&&t.setHyperlink(s,u,{url:r,tooltip:r}),n&&e&&a&&n.r5(a,t,s,u),0<(i&et.CopyToOptions.value)&&(i=t.parent&&t.parent.options.allowUserEditFormula?16:0,t.OTe=!0,t.setCsv(s,u,r,"\r\n","\t",i,!1,S.yM.n5(a)),delete t.OTe);else if(n&&e&&o)n.s5(o,t,s,u);else for(v=0;v<c;v++)for(g=0;g<f;g++)t.setValue(s+v,u+g,$)}function J(t,n,i,e,r,o,a){var s,u,r,c,f,l,h,d,v,s,g,m,p,S,w,b,C,y,M,k,T,x,u=B.WT(r),r=e.row<0?n.getRowCount():e.rowCount,c=e.col<0?n.getColumnCount():e.colCount,f=i.row<0?t.getRowCount():i.rowCount,l=i.col<0?t.getColumnCount():i.colCount,h=e.row,d=e.col;for(e.row<0&&f<n.getRowCount()&&(h=0),e.col<0&&l<n.getColumnCount()&&(d=0),(v=(null==(s=t.getSpan(i.row,i.col))?void 0:s.equals(i))&&1===e.rowCount&&1===e.colCount)&&(r=(s=t.getSpan(i.row,i.col)).rowCount,c=s.colCount),g=F(r/f),m=F(c/l),p=0;p<g&&g&&m;p++)for(S=0;S<m;S++)G.staticMembers.copyTo(t,i.row,i.col,n,h+f*p,d+l*S,f,l,u,o,I(t),it,P(u),a);for(k=-33&u,w=h+f*g,b=d,C=r-f*g,y=l,M=A(new nt.Range(i.row,i.col,C,y),t.getSpans(i)),T=function(e){M.forEach(function(t){n.addSpan(w+t.row-i.row,b+l*e+t.col-i.col,t.rowCount,t.colCount)}),G.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,n,w,b+l*e,C,y,k,o,I(t),it,P(k),a)},S=0;S<m&&C&&y;S++)T(S);for(w=h,b=d+l*m,C=f,y=c-l*m,M=A(new nt.Range(i.row,i.col,C,y),t.getSpans(i)),x=function(e){M.forEach(function(t){n.addSpan(w+f*e+t.row-i.row,b+t.col-i.col,t.rowCount,t.colCount)}),G.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,n,w+f*e,b,C,y,k,o,I(t),it,P(k),a)},p=0;p<g&&C&&y;p++)x(p);w=h+f*g,b=d+l*m,C=r-f*g,y=c-l*m,M=A(new nt.Range(i.row,i.col,C,y),t.getSpans(i)),C&&y&&(M.forEach(function(t){n.addSpan(w+t.row-i.row,b+t.col-i.col,t.rowCount,t.colCount)}),G.staticMembers.copyTo(t,i.row<0?0:i.row,i.col<0?0:i.col,n,w,b,C,y,k,o,I(t),it,P(k),a))}function Z(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,u=i.row<0?n.getRowCount():i.rowCount,c=i.col<0?n.getColumnCount():i.colCount,f=e.row<0?t.getRowCount():e.rowCount,l=e.col<0?t.getColumnCount():e.colCount,h=n.o5();if(h&&(u=(u-=n.ix(i.row,U(u,f),!0))<1?1:u,c=(c-=n.ix(i.col,U(c,l)))<1?1:c),f<u||l<c)for(d=i.row,v=i.col,i.row<0&&f<n.getRowCount()&&(d=0),i.col<0&&l<n.getColumnCount()&&(v=0),u%f==0&&1===c?c=l:1===u&&c%l==0?u=f:u%f==0&&c%l==0||(u=f,c=l),g=F(u/f),m=F(c/l),p=f,S=l,y=C=b=w=void 0,M=0;M<g;M++){for(w=ot(C)?d<0?-1:d+M*f:C,k=0;k<m;k++)b=ot(y)?v<0?-1:v+k*l:y,f=d<0?-1:p,l=v<0?-1:S,h&&(f=d<0?-1:f+n.lT(w,p,!0),l=v<0?-1:l+n.lT(b,S)),G.staticMembers.copyTo(t,e.row,e.col,n,w,b,p,S,r,o,I(t),a,P(r),s,it,!0),y=b+(l<0?0:l);C=w+(f<0?0:f),y=null}else G.staticMembers.copyTo(t,e.row,e.col,n,i.row,i.col,e.rowCount,e.colCount,r,o,I(t),a,P(r),s,it,!0)}function pt(t,e,n,i,r){var o,a,s,u,c,f,l,o=r.isCutting,a=r.clipboardPasteOptions,s=r.ignoreFilteredOutRow,u=r.ignorePasteSkipInvisibleRange,c=r.pasteSpecialOptions;if(t&&n.name()===t.name()&&n.parent&&!t.NMi&&!d(n.parent.sheets,t)&&n.parent!==t.parent)t.YT();else{f=B.WT(a),L(t),L(n);try{if(t&&e){if(0!=(2&f)&&o&&b&&t.KT(e.row,e.col,e.rowCount,e.colCount||n.KT(i.row,i.col,i.rowCount,i.colCount)))throw rt().Exp_ChangePartOfArray;l=a===et.ClipboardPasteOptions.formatting,o?(G.staticMembers.moveTo(t,e.row,e.col,n,i.row,i.col,e.rowCount,e.colCount,f,t.JT,u),t.YT()):l?J(t,n,e,i,a,s,c):Z(t,e,n,i,f,s,u,c)}else W(n,i,a,f,r.clipboardText,r.clipboardImage,r.clipboardHtml)}finally{D(t,!1),D(n,!1)}}}n=this&&this.__extends||(T=function(t,e){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}T(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.OpenPasteSpecialDialogActive=t.ClipboardPasteUndoAction=t.ClipboardPasteRangeUndoAction=void 0,et=e("./dist/core/core.enum.js"),nt=e("./dist/core/util/common.js"),q=e("./dist/core/worksheet/worksheet-actions.js"),u=e("./dist/core/worksheet/worksheet.js"),f=e("./dist/core/util/domUtil.js"),S=e("./dist/core/worksheet/clipboardhelper.js"),G=e("./dist/core/worksheet/worksheet-static.js"),m=e("Common"),l=e("./dist/core/core.ns.js"),i=e("CalcEngine"),r=e("./dist/core/worksheet/actionbase.js"),h=e("./dist/core/worksheet/paste-special-dialog.js"),b=!!i,$=null,it=void 0,d=m.Common.Uf.OS,U=Math.max,c=Math.min,F=Math.floor,C=nt.mt.Tt,e=new m.Common.ResourceManager(l.SR,"Sheets"),rt=e.getResource.bind(e),ot=m.Common.lt.ht,w="^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$",M="^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$",x=r.ActionBase,n(ht,x),ht.WT=function(t){var e,n,e=0,n=[et.ClipboardPasteOptions.all,et.ClipboardPasteOptions.usingSourceTheme,et.ClipboardPasteOptions.noBorder,et.ClipboardPasteOptions.allAndColumnWidth].includes(t);return!n&&1!==t&&t!==et.ClipboardPasteOptions.valuesAndNumberFormatting&&t!==et.ClipboardPasteOptions.valuesAndSourceFormatting||(e|=1),!n&&2!==t&&t!==et.ClipboardPasteOptions.valuesAndSourceFormatting||(e|=608),!n&&3!==t&&t!==et.ClipboardPasteOptions.formulasAndNumberFormatting||(e|=2),!n&&4!==t||(e|=609),!n&&5!==t||(e|=610),n&&(e|=8116),t===et.ClipboardPasteOptions.comments&&(e|=et.CopyToOptions.comment),e},ht.prototype.canExecute=function(){var t,e,n,i,r,i,n,t=this,e=t.tT,n=e.pasteExtent,i=n.targetRange,r=n.sourceRange,i=e.toSheet.PT(i.row,i.col,i.rowCount,i.colCount,{sheetArea:et.SheetArea.viewport})||_(e.toSheet,t.tT.pasteOption),n=!n.isCutting||e.fromSheet.PT(r.row,r.col,r.rowCount,r.colCount,{sheetArea:et.SheetArea.viewport})||_(e.fromSheet,t.tT.pasteOption);return i&&n},ht.prototype.XI=function(){var t,e,n,i,r,o,e,a,t,t=this,e=t.tT.pasteExtent,n=t.tT.Kh={},i=e.isCutting,r=ht.WT(t.tT.pasteOption),o=e.sourceRange,e=e.targetRange,a=t.tT.fromSheet,t=t.tT.toSheet;a&&o&&i&&!a.isDirtySuspended()&&(n.qI=new q.ChangedCells(a,o,r)),t.isDirtySuspended()||(n.$I=new q.ChangedCells(t,e,r))},ht.prototype.nx=function(){return this.tT.pasteExtent.targetRange},ht.prototype.ex=function(t,e,n,i,r,o){var F,a,s,u,c,o,_,A,L,D,j,O,f,l,h,d,v,g,m,p,V,Y,K,z,W,S,w,b,C,y,M,k,T,x,J,Z,G,B,I,P,R,Q,X,N,q,E,$,tt,H,R,C,U,C,S,w,H,S,h,v,R,w,C,k,S,F=!1,a=e.row,s=e.col,u=e.rowCount,c=e.colCount,o=r!==o,_=!1,A=!1,L=!1,D=!1,j=at(r),O=!1,f=r.o5(),g=r.getRowCount(),m=r.getColumnCount(),p=u,V=c,Y=0,K=0,z=0,W=0;if(f&&(p-=r.ix(a,p,!0),V-=r.ix(s,V)),S=r.tables&&r.tables.AB(a,s,u,c),b=ut(n,m),C=ct(n,g),T=this.bx,x=this.kse,J=i===et.InsertShiftCell.right,Z=i===et.InsertShiftCell.down,R=w=!1,-1===(G=n.row)&&(R=!(G=0)),-1===(B=n.col)&&(B=0),-1===(I=n.rowCount)&&(I=g),-1===(P=n.colCount)&&(P=m),Q=!1,-1===s&&(Q=!(s=0)),-1===a&&(Q=!(a=0)),x){if(1<S.length)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(1===S.length){if(y=S[0])if(M=y.Tx,k=y.Sx,J){if(!o&&(k+y.Ky!==I&&(s!==y.iw||I<y.Ky+k)&&!(I<=y.Ky||!t&&s===y.iw&&p%I==0)||!T&&t&&st(r,n)))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};s===y.iw&&p%I==0||(w=!0),s===y.iw&&(y=it)}else if(Z){if(!o&&b&&a<=G&&P>y.iw&&P<y.iw+y.Tx&&(t||V%P!=0))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};P===M&&0===y.iw&&a!==y.Ky&&(w=!0),a===y.Ky&&(y=it)}}else if(t&&(!b||C)&&r.tables&&r.tables.Uue(n))return r.jT(1,rt().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0}}if(x&&y&&(X=y.name()),w||t||y&&!b||!(J&&p%I==0||Z&&V%P==0)){if(J){if(S=void 0,l=a,d=C=I,w=!y||!x||T||!ct(e,g),H=y&&I<=y.Ky,N=w||H,f&&(C+=S=r.lT(a,C),d+=S),S=!1,!o){if(v=(h=G)+I,N&&a!==h&&(0!==G||-1!==a||!R)&&n.intersect(a,s,C,r.getColumnCount()-s))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!y&&x&&lt(n,e,a,s,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(B<s&&s<=B+P-1&&h<a&&a<=v-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(vt(r,a,s,C,r.getColumnCount()-s,X)||!N&&y&&s<B&&h>=y.Ky&&h<y.Ky+k&&v>y.Ky+k)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!T&&t&&B<s&&!ft(r,n)&&dt(r,G,B+P,I,s-B-P+(y?y.Tx-(s-y.iw):0)))return r.jT(1,rt().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};if(!w&&y)if(H)$=I;else{if(0!==y.Ky&&s!==y.iw)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};s===y.iw&&(S=!0),s<B&&h>=y.Ky&&v<=y.Ky+k&&I===y.Sx&&(E=P),$=S?I:y.Sx}}if(o||(a!==G&&-1!==a||!(s<=B)||y&&!S&&!H)&&ot(E)||(f?(n.col+=n.colCount,n.col=r.O5(n.col-1),K=r.lT(n.col,n.colCount),n.colCount+=K):n.col=n.col+(ot(E)?n.colCount:E),_=!0),h=r.getColumnCount()-n.colCount,v=n.colCount,f&&(W=r.lT(s,n.colCount),h=m-(v=(R=n.colCount+W)+r.ox(m-1,R)),_)&&(n.col+=W),(O=mt(r,l,h,d,v))&&!j&&(!t||o||!x||-1!==n.row))return r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(Z){if(C=void 0,h=s,v=w=P,N=!y||!x||T||ut(e,m)||P<=y.iw,f&&(w+=C=r.lT(s,w),v+=C),!N&&y&&b&&(P<M||P<y.iw+M||(!y.showHeader||y.Ky!==a)&&P!==y.iw+M))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!o){if(y&&b&&y.iw<w&&y.iw+y.Tx!==w&&n.intersect(a,s,r.getRowCount()-a,w))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(!y&&x&&lt(n,e,a,s,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(b&&N&&s!==B&&n.intersect(a,s,r.getRowCount()-a,w))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(b&&s!==B&&n.intersect(a,s,r.getRowCount()-a,n.colCount))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(G<a&&a<=G+I-1&&B<s&&s<=B+w-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(gt(r,a,s,r.getRowCount()-a,w,X))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!T&&t&&G<a&&!ft(r,n)&&dt(r,G+I,B,a-G-I+(y?y.Sx-(a-y.Ky):0),w))return r.jT(1,rt().Exp_InsertCopiedCutCellsAffectTable),{returnFunc:!0};!N&&y&&(k=I,t&&(!b&&n.intersect(y.Ky,0,y.Sx,y.endColumn()+1)||new nt.Range(y.Ky,0,y.Sx,y.endColumn()+1).containsRange(n))&&(k=G+I-1-y.endRow()),r.getColumnCount()%w==0)&&(0<k?!b&&a<G?q=k:w===M&&(tt=M):t&&k<0&&(s===B||-1===s)&&a<=G&&(q=I))}if(o||ot(q)&&(s!==B&&-1!==s||!(a<=G)||y&&!b)||(f?(n.row=n.row+n.rowCount,n.row=r.j5(n.row-1),Y=r.lT(n.row,n.rowCount,!0),n.rowCount+=Y):n.row=n.row+(ot(q)?n.rowCount:q),A=!0),l=g-n.rowCount,d=n.rowCount,f&&(z=r.lT(a,n.rowCount,!0),l=g-(d=(S=n.rowCount+z)+r.ox(g-1,S,!0)),A)&&(n.row+=z),(O=mt(r,l,h,d,v))&&!j&&(!t||o||!x||-1!==n.col))return r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}}else if(p%I==(R=H=0)&&V%P!=0?(c=e.colCount=P,f&&(H=r.lT(s,c),e.colCount=c+=H)):p%I!=0&&V%P==0&&(u=e.rowCount=I,f)&&(R=r.lT(a,u,!0),e.rowCount=u+=R),F=!0,C={row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount},J){if(U=!1,N=!y||!x||T||!ct(e,g),!o){if((a<=n.row&&a+u>=n.row+n.rowCount||Q&&-1===n.row)&&(U=!0),!y&&x&&lt(n,e,a,s,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(B<s&&s<=B+P-1&&G<a&&a<=G+I-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!U&&n.intersect(a,s,u,m-s))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(vt(r,a,s,u,m-s,X))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(!N&&y&&I===y.Sx){if(0!==y.Ky)return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};s<B&&(E=c),$=y.Sx}(U&&s<=B&&(!y||b)||!ot(E))&&(f?(n.col+=c,n.col=r.O5(n.col-1),K=r.lT(n.col,c),n.colCount+=K):n.col+=ot(E)?c:E,L=!0)}if(l=a,d=u,h=m-c,v=c,f&&(h=m-(v=c+(W=r.ox(m-1,c))+H)),(O=mt(r,l,h,d,v))&&!j)return L&&(n.col=C.col,n.colCount=C.colCount),r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}else if(Z){if(U=!1,N=!y||!x||T||ut(e,m),!o){if(s<=B&&B+P<=s+c&&(U=!0),!y&&x&&lt(n,e,a,s,i))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};if(G<a&&a<=G+I-1&&B<s&&s<=B+P-1)return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(!U&&n.intersect(a,s,r.getRowCount()-a,c))return r.jT(1,rt().Exp_InsertCopiedCutCells),{returnFunc:!0};if(gt(r,a,s,r.getRowCount()-a,c,X))return r.jT(1,rt().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:!0};if(G<a&&a<G+I||ut(e,m)&&y&&P>y.iw&&y.iw+M>P&&n.intersect(a,s,r.getRowCount()-a,c))return r.jT(1,rt().Exp_InsertCopiedCutCellsOverlap),{returnFunc:!0};!N&&y&&0<u&&r.getColumnCount()%P==0&&P===M&&0===y.iw&&(tt=M),(!y||b)&&U&&a<=G&&(f?(n.row+=u,n.row=r.j5(n.row-1),Y=r.lT(n.row,u,!0),n.rowCount+=Y):n.row+=u,D=!0)}if(l=r.getRowCount()-u,d=u,h=s,v=c,f&&(l=g-(d=u+(z=r.ox(g-1,u,!0))+R)),(O=mt(r,l,h,d,v))&&!j)return D&&(n.row=C.row,n.rowCount=C.rowCount),r.jT(1,rt().Exp_InsertCopiedCutCellsNoRange),{returnFunc:!0}}return{changePasteDataRangeCol:_,changePasteDataRangeRow:A,changePasteDataRangeCols:L,changePasteDataRangeRows:D,moveRangeHaveValue:O,returnFunc:!1,selectRange:F,adjustedTableRowCount:$,adjustedTableColCount:tt,changePasteDataRangeRowInvisibleCount:Y,changePasteDataRangeColInvisibleCount:K,invisibleRowCountInAcRange:z,invisibleColCountInAcRange:W}},ht.prototype.fx=function(F,t,e,n,_,i,r,o,a,s,u,c){var f,l,h,d,v,g,m,p,t,S,A,w,e,b,C,L,y,M,k,T,x,G,B,I,D,j,P,R,N,E,O,H,V,U,f=!1,l=!1,h=this.kse,d=n.o5(),v=n.getColumnCount(),g=-1!==i.col&&i.colCount!==v,m=!1,p=t===et.InsertShiftCell.right,t=t===et.InsertShiftCell.down,S=st(n,new nt.Range(r,o,t?1:a,p?1:s)),A=0,w=!1,e=n!==e;if(h&&S&&(-1===r&&(r=0),-1===o)&&(o=0),S&&(p&&o===S.iw||t&&r===S.Ky)&&(S=it),F){if(p)if(n.mT(r,o+s,a,n.getColumnCount()-o-s,!0))if(b=S&&i.rowCount>S.Ky&&S.showHeader(),o+s<n.getColumnCount()){if(C=S&&o===S.iw,d)if(L=a,y=s+n.ox(n.getColumnCount()-1,s),-1===r)-1!==i.row||e?n.moveTo(r,o,r,o+s,a,n.getColumnCount()-o-s,et.CopyToOptions.all,!0):(n.addColumns(o,s),n.deleteColumns(n.getColumnCount()-s,s));else for(M=r;M<r+L&&M<n.getRowCount();M++)0!==n.getRowHeight(M)&&n.moveTo(M,o,M,o+s,1,n.getColumnCount()-o-y,et.CopyToOptions.all,!0);else h&&S&&!C&&(S.showFooter()||b)?(k=S.endRow(),S.showFooter()&&(A=k),i.rowCount>k+1&&n.moveTo(k+1,o,k+1,o+i.colCount,i.rowCount-k-1,n.getColumnCount()-o-i.colCount,et.CopyToOptions.all,!0)):-1!==r||-1!==i.row||e?n.moveTo(r,o,r,o+s,a,n.getColumnCount()-o-s,et.CopyToOptions.all,!0):(n.addColumns(o,s),n.deleteColumns(n.getColumnCount()-s,s));Y(n,r,o,r,o+s),(x=(T=n.rowFilter())&&T.range)&&-1===r&&1<x.colCount&&o>x.col&&o<=x.col+x.colCount-1&&(x.colCount=x.colCount+i.colCount),h&&S&&(C||i.rowCount!==S.Sx&&!ct(i,n.getRowCount())||(S.showFooter()||b?(S.insertColumns(o-S.iw,i.colCount),m=!0):S.K5t(new nt.Range(S.Ky,S.iw,S.Sx,S.Tx+s))))}else o+s>n.getColumnCount()&&(l=f=!0);else l=f=!0;else if(t)if(n.mT(r+a,o,n.getRowCount()-r-a,s,!0))if(r+a<n.getRowCount()){if(G=0,h&&S&&(I=(B=S.dataRange()).col+B.colCount,(D=r===S.Ky)||(G=a,0<(G=c&&i.row>=S.startRow()&&i.row<=S.endRow()?i.row+i.rowCount-1-S.endRow():G)&&(u=S.footerIndex())),!c&&g&&v%i.colCount==0||!g&&!K(n,{row:i.row,col:I,rowCount:i.rowCount,colCount:i.colCount-I})||(m=!0)),d)if(j=s,P=a+n.ox(n.getRowCount()-1,a,!0),-1===o)-1!==i.col||e?n.moveTo(r,o,r+a,o,n.getRowCount()-r-P,i.colCount,et.CopyToOptions.all,!0):(n.addRows(r,a),n.deleteRows(n.getRowCount()-a,a));else for(R=o;R<o+j&&R<n.getColumnCount();R++)0!==n.getColumnWidth(R)&&n.moveTo(r,R,r+a,R,n.getRowCount()-r-P,1,et.CopyToOptions.all,!0);else N=0<G,ot(u)||-1===u?(N&&S.K5t(new nt.Range(S.Ky,S.iw,S.Sx+G,S.Tx)),-1!==o||-1!==i.col||e?n.moveTo(r,o,r+a,o,n.getRowCount()-r-a,s,et.CopyToOptions.all,!0):(n.addRows(r,a),n.deleteRows(n.getRowCount()-a,a))):(n.moveTo(u+1,o,u+1+a,o,n.getRowCount()-u-1-a,s,et.CopyToOptions.all,!0),N&&S.K5t(new nt.Range(S.Ky,S.iw,S.Sx+G,S.Tx)),0<(E=u+G-r-a)&&n.moveTo(r,o,r+a,o,E,s,et.CopyToOptions.all,!0));Y(n,r,o,r+a,o)}else r+a>n.getRowCount()&&(l=f=!0);else l=f=!0}else if(p)if(n.mT(r,o+i.colCount,i.rowCount,n.getColumnCount()-o-i.colCount,!0))if(o+i.colCount-(c&&!e&&this.kse&&-1===i.row?i.colCount:0)<n.getColumnCount()){if(C=S&&o===S.iw,b=S&&i.rowCount>S.Ky&&S.showHeader(),d)if(O=i.rowCount,y=(H=i.colCount+n.lT(o,i.colCount))+n.ox(n.getColumnCount()-1,H),-1===r)-1!==i.row||e?n.moveTo(r,o,r,o+H,i.rowCount,n.getColumnCount()-o-y,et.CopyToOptions.all,!0):(n.addColumns(o,i.colCount),w=!0);else for(M=r;M<r+O&&M<n.getRowCount();M++)0===n.getRowHeight(M)?O++:n.moveTo(M,o,M,o+H,1,n.getColumnCount()-o-y,et.CopyToOptions.all,!0);else h&&!c&&S&&!C&&(S.showFooter()||b)?(k=S.endRow(),S.showFooter()&&(A=k),i.rowCount>k+1&&n.moveTo(k+1,o,k+1,o+i.colCount,i.rowCount-k-1,n.getColumnCount()-o-i.colCount,et.CopyToOptions.all,!0)):-1!==r||-1!==i.row||e?n.moveTo(r,o,r,o+i.colCount,i.rowCount,n.getColumnCount()-o-i.colCount,et.CopyToOptions.all,!0):(n.addColumns(o,i.colCount),w=!0);Y(n,r,o,r,o+i.colCount),(x=(T=n.rowFilter())&&T.range)&&-1===r&&1<x.colCount&&o>x.col&&o<=x.col+x.colCount-1&&(x.colCount=x.colCount+i.colCount),h&&S&&i.rowCount>S.Ky&&(C||i.rowCount!==S.Sx&&!ct(i,n.getRowCount())||(c||!S.showFooter()&&!b?S.K5t(new nt.Range(S.Ky,S.iw,S.Sx,S.Tx+i.colCount)):(S.insertColumns(o-S.iw,i.colCount),m=!0)))}else o+i.colCount>n.getColumnCount()&&(l=f=!0);else l=f=!0;else if(t)if(n.mT(r+i.rowCount,o,n.getRowCount()-r-i.rowCount,i.colCount,!0))if(r+i.rowCount-(c&&!e&&this.kse&&-1===i.col?i.rowCount:0)<n.getRowCount()){if(G=0,h&&S&&i.colCount>S.iw&&(I=(B=S.dataRange()).col+B.colCount,(D=r===S.Ky)||(G=i.rowCount,0<(G=c&&(!g&&i.intersect(S.Ky,0,S.Sx,S.endColumn()+1)||new nt.Range(S.Ky,0,S.Sx,S.endColumn()+1).containsRange(i))?i.row+i.rowCount-1-S.endRow():G)&&(u=S.footerIndex())),!c&&g&&v%i.colCount==0||!g&&!K(n,{row:i.row,col:I,rowCount:i.rowCount,colCount:i.colCount-I})||(m=!0)),d)if(V=i.colCount,P=(U=i.rowCount+n.lT(r,i.rowCount,!0))+n.ox(n.getRowCount()-1,U,!0),-1===o)-1!==i.col||e?n.moveTo(r,o,r+U,o,n.getRowCount()-r-P,i.colCount,et.CopyToOptions.all,!0):(n.addRows(r,i.rowCount),w=!0);else for(R=o;R<o+V&&R<n.getColumnCount();R++)0===n.getColumnWidth(R)?V++:n.moveTo(r,R,r+U,R,n.getRowCount()-r-P,1,et.CopyToOptions.all,!0);else N=0<G,ot(u)||-1===u?(N&&S.K5t(new nt.Range(S.Ky,S.iw,S.Sx+G,S.Tx)),-1!==o||-1!==i.col||e?n.moveTo(r,o,r+i.rowCount,o,n.getRowCount()-r-i.rowCount,i.colCount,et.CopyToOptions.all,!0):(n.addRows(r,i.rowCount),w=!0)):(n.moveTo(u+1,o,u+1+i.rowCount,o,n.getRowCount()-u-1-i.rowCount,i.colCount,et.CopyToOptions.all,!0),N&&S.K5t(new nt.Range(S.Ky,S.iw,S.Sx+G,S.Tx)),0<(E=u+G-r-i.rowCount)&&n.moveTo(r,o,r+i.rowCount,o,E,i.colCount,et.CopyToOptions.all,!0));Y(n,r,o,r+i.rowCount,o)}else r+i.rowCount>n.getRowCount()&&(l=f=!0);else l=f=!0;return{ignoreTableExpand:m,ignoreTableFooterIndex:A,raiseInvalidOperation:f,returnFunc:l,isInsert:w}},ht.prototype.hx=function(t,e,n,i,r,o,a,s){var u,c,f,l,h,u=s.changePasteDataRangeRowInvisibleCount,c=s.changePasteDataRangeColInvisibleCount,f=s.invisibleRowCountInAcRange,l=s.invisibleColCountInAcRange,h=this.tT.pasteExtent.targetRange;t&&(e.colCount-=c,e.col-=e.colCount,e.col-=l,h.colCount-=c),n&&(e.rowCount-=u,e.row-=e.rowCount,e.row-=f,h.rowCount-=u),i&&(e.colCount-=c,e.col-=o,e.col-=l,h.colCount-=c),r&&(e.rowCount-=u,e.row-=a,e.row-=f,h.rowCount-=u),s.changePasteDataRangeRowInvisibleCount=0,s.changePasteDataRangeColInvisibleCount=0,s.invisibleRowCountInAcRange=0,s.invisibleColCountInAcRange=0},ht.prototype.vx=function(t,e){var n=[].concat(e.parent.sheets);return t&&(t.NMi||t.isReportTemplateSheet)&&n.push(t),e&&e!==t&&(e.NMi||e.isReportTemplateSheet)&&n.push(e),n},ht.prototype.execute=function(){var t,t,e,n,i,r,o,a,s,u,c,f,F,l,l,t,h,d,h,d,h,v,g,m,p,S,d,t,w,_,A,L,D,h,b,C,y,j,O,M,M,k,M,k,M,T,x,V,G,B,I,Y,K,z,P,W,R,J,Z,N,E,H,U,Q,X,h,b,G,S,l,v,g,I,P,e=this;if(e.canExecute()&&(n=e.tT.fromSheet,i=e.tT.toSheet,r=e.tT.pasteExtent,o=e.tT.pasteOption,a=r.sourceRange,s=r.targetRange,u=r.isCutting,!n||!a||n.zT(a.row,a.col,a.rowCount,a.colCount,n.getRowCount(),n.getColumnCount()))&&i&&s&&i.HT(s.row,s.col,s.rowCount,s.colCount,!0)&&!(i.tables&&i.tables.mx(n,a,i,s,u)||i.pivotTables&&i.pivotTables.KYt(a,s,i))){if(n&&(F=n.ST(),c=e._shiftCells,f=e.fA)&&(l=f.row,t=f.col,h=f.rowCount,d=f.colCount,l=new nt.Range(l,t,h,d),null!=(t=r.pasteSpecialOptions)&&t.transpose&&(h=f.row<0?0:f.row,d=f.col<0?0:f.col,f=new nt.Range(h,d,f.colCount,f.rowCount)),null!=(t=r.pasteSpecialOptions))&&t.pasteLink&&(f=new nt.Range(f.row,f.col,s.rowCount,s.colCount),h=n.getSpan(f.row,f.col))&&h.rowCount===a.rowCount&&h.colCount===a.colCount&&(f=new nt.Range(f.row,f.col,1,1)),e.cA&&(v=e.cA.row,g=e.cA.col,m=e.cA.rowCount,p=e.cA.colCount),d=e.kse,t=i===n,h=at(i),b=D=L=A=_=!1,O=j=y=C=0,c!==it&&f){if(t&&u&&c===et.InsertShiftCell.right&&ct(f,i.getRowCount())&&(w=st(i,f))&&(M=st(i,new nt.Range(v,g,m,p)))&&M.name()===w.name()&&(e.tT.Hfe=w,i.tables.remove(w,1)),(M=this.ex(u,e.cA,f,c,i,n)).returnFunc)return void tt(i,w,u,c);_=M.changePasteDataRangeCol,A=M.changePasteDataRangeRow,C=M.changePasteDataRangeRowInvisibleCount,y=M.changePasteDataRangeColInvisibleCount,j=M.invisibleRowCountInAcRange,O=M.invisibleColCountInAcRange,L=M.changePasteDataRangeCols,D=M.changePasteDataRangeRows,b=M.moveRangeHaveValue,S=M.selectRange,m=e.cA.rowCount,p=e.cA.colCount,s.rowCount+=C,s.colCount+=y,k=M.adjustedTableRowCount,M=M.adjustedTableColCount,ot(k)||(s.row=0,s.rowCount=k),ot(M)||(s.col=0,s.colCount=M)}e.XI(),k=e.vx(n,i),q.Commands.II(k),i.suspendPaint(),i.suspendEvent(),M=!(i.QI=!0),n&&(n.suspendEvent(),n.QI=!0);try{if(h&&!(V=this.ype(n,i,a,s,v,g,c,b,l,w,u)))M=!0,T=1,x=rt().Exp_InvalidCopyPasteSize,G=i.U5(),s.colCount=G.colCount,s.rowCount=G.rowCount;else if((M=(B=c!==it&&this.fx(S,c,n,i,e.cA,l,v,g,m,p,e.px,u)).raiseInvalidOperation)&&(T=1,x=rt().Exp_InsertCopiedCutCellsNoRange),B.returnFunc)tt(i,w,u,c);else{if(a&&nt.Be.Ll(n,a.row,a.col,a.row+a.rowCount-1,a.col+a.colCount-1),I=!a||-1!==a.col&&-1!==a.row,Y=c!==it?!B.ignoreTableExpand:I)try{K={shiftCells:e.bx&&c===et.InsertShiftCell.down,isCopy:!u,isFirst:!1,isHeaderPaste:e.kse},z=[],P=ot(B.ignoreTableFooterIndex)?0:B.ignoreTableFooterIndex,W=new nt.Range(s.row,s.col,s.rowCount-P,s.colCount),i.tables&&i.tables.yx(n,W,a,$,$,$,{shiftInfo:K,backupTableResizedArgs:z}),this.tT.Kh.lCe=z}catch(t){return M=!0,T=6,x=t.message,void tt(i,w,u,c)}R=f||a,J=u&&c!==it&&(c===et.InsertShiftCell.right&&(-1===R.row||R.row===s.row)||c===et.InsertShiftCell.down&&(-1===R.col||R.col===s.col)),pt(n,f||a,i,s,Z={isCutting:u,clipboardText:r.clipboardText,clipboardHtml:r.clipboardHtml,clipboardImage:r.clipboardImage,clipboardPasteOptions:o,ignoreFilteredOutRow:!r.includeFilteredOutRow,ignorePasteSkipInvisibleRange:!0===J,pasteSpecialOptions:r.pasteSpecialOptions}),u&&c!==it&&(N=R.row,E=R.col,H=R.rowCount,U=R.colCount,Q=s.row,X=s.col,c!==et.InsertShiftCell.right||-1!==R.row&&R.row!==s.row||(t&&d&&E<X&&ft(i,s)&&(s.col-=U),-1===N&&B.isInsert&&t?n.deleteColumns(E,U):n.moveTo(N,E+U,Q,E,H,i.getColumnCount()-E-U,et.CopyToOptions.all,!0)),c!==et.InsertShiftCell.down||-1!==R.col&&R.col!==s.col||(t&&d&&N<Q&&ft(i,s)&&(s.row-=H),-1===E&&B.isInsert&&t?n.deleteRows(N,H):n.moveTo(N+H,E,N,X,i.getRowCount()-N-H,U,et.CopyToOptions.all,!0)))}}finally{tt(i,w,u,c),a&&nt.Be.dl(),i.resumeEvent(),i.QI=!1,n&&(n.resumeEvent(),n.QI=!1),i.resumePaint(),q.Commands.xI(k,e.tT),h=e.tT.Kh,b=ht.WT(o),r.isCutting&&n&&(G=[],n.isDirtySuspended()||((S=new q.ChangedCells(n,a,b)).yI(h.qI.bI()),G=(h.wx=S).MI()),q.Commands.SI(n,a.row,a.col,a.rowCount,a.colCount,G,3,it,it,c)),i&&(l=[],i.isDirtySuspended()||((v=new q.ChangedCells(i,s,b)).yI(h.$I.bI()),l=(h.Mx=v).MI()),g=i.tables&&i.tables.WI&&i.tables.WI(s.row,s.col,s.rowCount,s.colCount),I=s.rowCount,P=s.colCount,q.Commands.SI(i,s.row,s.col,I,P,l,3,g,it,c),e.tableNamesObj={r:s.row,c:s.col,rc:I,cc:P,tableNames:g}),e.Cx={changePasteDataRangeCol:_,changePasteDataRangeRow:A,changePasteDataRangeCols:L,changePasteDataRangeRows:D,acColCount:p,acRowCount:m,changePasteDataRangeRowInvisibleCount:C,changePasteDataRangeColInvisibleCount:y,invisibleRowCountInAcRange:j,invisibleColCountInAcRange:O},F&&delete F.TT,M&&i.jT(T,x)}}},ht.prototype.ype=function(t,e,n,i,r,o,a,s,u,c,f){var l,h,d,v,g,m,l,m,l=-1,h=-1;if(-1!==i.row?l=i.row+i.rowCount:-1===n.row&&(l=t.getRowCount()),d=e.getRowCount(),v=t!==e,g=l-d,(m=d<l)&&j(n,i))a===et.InsertShiftCell.down&&s?e.addRows(d,l-r-(f&&!v&&this.kse&&-1===u.col?u.rowCount:0)):e.addRows(d,g);else if(s||r+i.rowCount!==d||a!==et.InsertShiftCell.down){if(s&&a===et.InsertShiftCell.down)e.addRows(d,d-r+g-(f&&!v&&this.kse&&-1===u.col?u.rowCount:0));else if(m)return tt(e,c,f,a),!1}else e.addRows(d,d-r+g-u.rowCount);if(-1!==i.col?h=i.col+i.colCount:-1===n.col&&(h=t.getColumnCount()),(m=(l=e.getColumnCount())<h)&&j(n,i))a===et.InsertShiftCell.right&&s?e.setColumnCount(h+l-o-(f&&!v&&this.kse&&-1===u.row?u.colCount:0)):e.setColumnCount(h);else if(s||o+i.colCount!==l||a!==et.InsertShiftCell.right){if(s&&a===et.InsertShiftCell.right)e.setColumnCount(h+l-o-(f&&!v&&this.kse&&-1===u.row?u.colCount:0));else if(m)return tt(e,c,f,a),!1}else e.setColumnCount(h+l-o-u.colCount);return!0},ht.prototype.undo=function(){var t,e,n,i,r,o,a,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,t=this;if(t.canUndo()){if(e=t.tT.fromSheet,n=t.tT.toSheet,r=(i=t.tT.pasteExtent).sourceRange,o=i.targetRange,!n||!o)return!1;if(t.Cx&&(a=t.Cx,this.hx(a.changePasteDataRangeCol,r,a.changePasteDataRangeRow,a.changePasteDataRangeCols,a.changePasteDataRangeRows,a.acColCount,a.acRowCount,a)),!at(n)&&!n.zT(o.row,o.col,o.rowCount,o.colCount,n.getRowCount(),n.getColumnCount()))return!1;if(e&&r){if(!e.zT(r.row,r.col,r.rowCount,r.colCount,e.getRowCount(),e.getColumnCount()))return!1;if(e.name()===n.name()&&n.parent&&!e.NMi&&n.parent!==e.parent)return!1}a=t.tT.Kh,n.suspendPaint();try{s=o.row<0?0:o.row,u=o.col<0?0:o.col,c=o.row<0?n.getRowCount():o.rowCount,f=o.col<0?n.getColumnCount():o.colCount,l=t.vx(e,n),q.Commands.NI(l,t.tT),(d=(h=n.rowFilter())&&h.range)&&-1===o.row&&d.col<o.col&&d.col+d.colCount>=o.col+o.colCount&&(d.colCount=d.colCount-o.colCount),p=m=g=v=0,e&&r&&(v=r.row<0?0:r.row,g=r.col<0?0:r.col,m=r.row<0?e.getRowCount():r.rowCount,p=r.col<0?e.getColumnCount():r.colCount),S=[],w=[],(b=t.tableNamesObj)&&(n&&b.r===s&&b.c===u&&b.rc===c&&b.cc===f&&(w=b.tableNames),e)&&b.r===v&&b.c===g&&b.rc===m&&b.cc===p&&(S=b.tableNames),C=t._shiftCells,n&&(y=a.Mx,q.Commands.SI(n,s,u,c,f,y?y.MI():[],3,S,!0,C)),i.isCutting&&e&&(M=a.wx,q.Commands.SI(e,v,g,m,p,M?M.MI():[],3,w,!0,C)),(k=t.tT.Hfe)&&tt(n,k,i.isCutting,C),(0,nt.handleRestoredTableResizedArgs)(a.lCe)}finally{n.resumePaint()}}return!0},ht.prototype.toJSON=function(){var t=this;return{sheetName:t.Mf?t.Mf.name():"",command:t.tT}},B=ht,t.ClipboardPasteRangeUndoAction=B,R=r.ActionBase,n(o,R),o.prototype.execute=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,t=this,e=t.tT,n=e.cachedActions,i=!1;if(t.canExecute()&&n){o=(r=t.Mf).parent.jg(),t.X5(o,!0),a=r.parent.i4(),q.Commands.II(a);try{for(s=!1,u=e.fA&&(Array.isArray(e.fA)?e.fA:[e.fA]),c=0;c<n.length;c++)(f=n[c])._shiftCells=e._shiftCells,f.kse=e.kse,f.cA=e.cA,f.fA=u&&(e.hT?u[c]:u[0]),f.bx=e.bx,f.px=e.px,r?(l=f.tT.pasteExtent,d=(h=t.tT).fromSheet,v=h.fromRanges&&h.fromRanges[c],g=l.clipboardText,(m=l.clipboardHtml)&&(p="<html>\r\n<body>\r\n\x3c!--StartFragment--\x3e",S="\x3c!--EndFragment--\x3e\r\n</body>\r\n</html>",m.substr(0,p.length)===p&&m.substr(m.length-S.length,S.length)===S&&(m=m.substring(p.length,m.length-S.length)),nt.mt.Qf())&&(w="<meta charset='utf-8'>",m.substr(0,w.length)===w)&&(m=m.substring(w.length,m.length)),!g&&d&&v&&(g=d.bT([v])),!m&&d&&v&&y(r)&&(m=d.MT([v])),b={sheet:r,sheetName:r.name(),cellRange:f.nx(),pasteOption:f.tT.pasteOption,pasteData:{text:g,html:m},shiftCells:e._shiftCells,fromSheet:d,fromRange:v,isCutting:!!h.isCutting,cancel:!1,action:h.isCutting?et.ClipboardActionType.cut:et.ClipboardActionType.copy},(C=l.clipboardImage)&&(b.pasteData.image=C),r.ki(nt.Events.ClipboardPasting,b),b.cancel||(i=f.execute(),delete b.cancel,s=!0,r.ki(nt.Events.ClipboardPasted,b))):i=f.execute();s&&t.Ax()}finally{q.Commands.xI(a,t.tT),t.q5(o,!0)}}return i},o.prototype.Ax=function(){var t,e,n,i,t,r,o,a,s,u,c,a,t=this,e=t.tT,n=e.cachedActions,i=t.Mf;if(i&&n){if(t=i.getSelections(),r=[],o=i.parent,i.IA(),e.hT)a=e.pastedRanges[0],i.n4(a.row,a.col,a.rowCount,a.colCount);else if(1<n.length)for(s=0;s<n.length;s++)c=(u=n[s]).nx(),i.n4(c.row,c.col,c.rowCount,c.colCount);else 0<n.length&&(a=n[0].nx(),i.n4(a.row,a.col,a.rowCount,a.colCount),a.contains(i.ui,i.ci)||i.XA(a.row,a.col));r=i.getSelections(),i.EA(t,r)&&i.jA(t),o&&e._oldPosition&&o.changeSelectionInCommandExecuting(e,null,null,r)}},o.prototype.canExecute=function(){var t,e,n,t=this.tT.cachedActions;if(t){for(e=0;e<t.length;e++)if(!(n=t[e]).canExecute())return!1;return!0}return!1},o.prototype.canUndo=function(){var t,e,n,t=this.tT.cachedActions;if(t){for(e=0;e<t.length;e++)if(!(n=t[e]).canUndo())return!1;return!0}return!1},o.prototype.undo=function(){var t,e,n,i,r,o,a,t=this,e=t.tT.cachedActions;if(t.canUndo()&&e){n=!0,i=t.Mf.parent.jg(),t.X5(i,!0);try{for(r=e.length-1;0<=r;r--)o=e[r],n=n&&o.undo();a=t.Mf.parent.i4(),q.Commands.NI(a,t.tT)}finally{t.q5(i,!0)}return n}return!1},t.ClipboardPasteUndoAction=o,N=r.ActionBase,n(z,N),z.prototype.canExecute=function(){return nt.mt.isEnablePasteSpecial(this.Mf)},z.prototype.execute=function(){var e,n,t,e=this;return!!this.canExecute()&&(n=this.Mf.parent,(t=new h.PasteSpecialDialog(document.body,2e3,!0)).rQ(function(t){n.commandManager().execute({cmd:"paste",sheetName:e.tT.sheetName,pasteOption:t.pasteOptions,pasteSpecialOptions:t})}),!0)},t.OpenPasteSpecialDialogActive=z,i=f.GC$,k=function(t,e){var t=s({},t);return[et.ClipboardPasteOptions.formatting,et.ClipboardPasteOptions.comments,et.ClipboardPasteOptions.validation,et.ClipboardPasteOptions.columnWidths].includes(e)&&(t.operationOptions=et.PasteOperationOptions.none),(e!==et.ClipboardPasteOptions.all&&e!==et.ClipboardPasteOptions.noBorder||t.operationOptions)&&(t.pasteLink=!1),t.advancedPasteOptions={},e===et.ClipboardPasteOptions.validation?t.advancedPasteOptions.validator=!0:e===et.ClipboardPasteOptions.usingSourceTheme||e===et.ClipboardPasteOptions.valuesAndSourceFormatting?t.advancedPasteOptions.usingSourceTheme=!0:e===et.ClipboardPasteOptions.noBorder?t.advancedPasteOptions.noBorder=!0:e===et.ClipboardPasteOptions.columnWidths||e===et.ClipboardPasteOptions.allAndColumnWidth?t.advancedPasteOptions.columnWidth=!0:e!==et.ClipboardPasteOptions.valuesAndNumberFormatting&&e!==et.ClipboardPasteOptions.formulasAndNumberFormatting||(t.advancedPasteOptions.numberFormats=!0),t},i.extend(u.Worksheet.prototype,{copyTo:function(t,e,n,i,r,o,a){this.vT(t,e,n,i,r,o,a)},vT:function(t,e,n,i,r,o,a,s,u,c,f){var l=this;l.suspendPaint(),l.suspendEvent(),G.staticMembers.copyTo(l,t,e,c||l,n,i,r,o,a,s,0,u,void 0,void 0,f),l.resumeEvent(),l.resumePaint()},moveTo:function(t,e,n,i,r,o,a,s,u){var c=this;if(!(b&&a&et.CopyToOptions.formula)||c.mT(t,e,r,o,!0)&&c.mT(n,i,r,o,!0))try{c.suspendPaint(),c.suspendEvent(),c.Lp.KAe=c.Ut.pj(),G.staticMembers.moveTo(c,t,e,c,n,i,r,o,a,s,it,it,u),delete c.Lp.KAe}finally{c.resumeEvent(),c.resumePaint()}},bT:function(t){var e,n,i,r,o,t,e=this,n=e.yT(t);if(n)return i="\t",r="\r\n",o='"',t=e.wT(t),(0,q.getRangeText)(e,n.row,n.rowCount,n.col,n.colCount,r,i,'"',!1,t.rows,t.cols,!0)},MT:function(t){var e,n,t,i,e=this,n=e.yT(t);if(n)return t=e.wT(t),i=I(e),S.yM.KS(e,i,n.row,n.rowCount,n.col,n.colCount,et.SheetArea.viewport,y(e),t.rows,t.cols,!1,!1,!1,!1)},CT:function(t,e,n){var i,r,o,a,s,u,c,i=this,r=i.rt,o=i.bT(t);if(o){(a=i.ST()).DS=i,a._S=t,e&&i.NMi&&1===t.length&&-1===t[0].row&&-1===t[0].col&&(e=!1),a.ES=e,(s=i.ST()).TT=!0,u=i.MT(t),i.AT&&i.AT(),i.ieV&&i.ieV();try{if(c={sheet:i,sheetName:i.name(),copyData:{text:o,html:u},ranges:t,isCutting:e,cancel:!1,action:e?et.ClipboardActionType.cut:et.ClipboardActionType.copy},i.ki(nt.Events.ClipboardChanging,c),!1===c.cancel)return r&&!n&&r.IT(y(i)?u:o),i.ki(nt.Events.ClipboardChanged,{sheet:i,sheetName:i.name(),copyData:{text:o,html:u}}),setTimeout(function(){!r||n||i.xT||r.NT()},100),{copyText:o,copyHtml:u};a.c5()}catch(t){}}},kT:function(t,e,n,i,r,o,a,s,u,c,f,l,h){var d,v,g,m,p,h,p,d=rt().Exp_PasteSourceCellsLocked;if(a.pastedInternal=!1,a.pastedRange=$,v=!o&&!u&&!h,!t&&v)return!1;if(p=(m=g=this).wT(e),!h&&g._T(t,g.yT(e),m,o,p.rows,p.cols,c)||v){if(a.pastedInternal=!0,r&&t.isActualProtected()&&t.ET(e)&&!_(t,i))return g.jT(1,d),!1;a.pastedRange=g.OT(t,e,m,n,i,r,s,l)}else h=g.RT(m,n,o,S.yM.n5(u)),p=g.BT(m,n,u),a.pastedRange=h.union(p);return g.LT(t,e,n,i,r,a,s,f,l)},LT:function(t,e,n,i,r,o,a,s,u){var c,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,c,h,T,x,v,G,B,I,P,R,N,E,H,f=this,l=rt().Exp_InvalidCopyPasteSize,h=f.FT(),d=rt().Exp_PasteChangeMergeCell,v=rt().Exp_ChangePartOfArray,g=f,m=o.pastedRange,p=g.o5(),S=null==u?void 0:u.pasteLink;if(!m)return f.jT(1,l),!1;if(!_(g,i)&&!g.PT(m.row,m.col,m.rowCount,m.colCount,{lockErrorMsg:h,arrayFormulaErrorMsg:v,shiftCells:a,sheetArea:et.SheetArea.viewport}))return!1;if(o.pastedInternal){if(1===(w=e.length)){if(b=e[0],C=m.rowCount,y=m.colCount,M=b.rowCount,k=b.colCount,null!=u&&u.transpose&&(C=(c=[y,C])[0],y=c[1],M=(c=[k,M])[0],k=c[1]),r&&!t.PT(b.row,b.col,b.rowCount,b.colCount,{lockErrorMsg:h,arrayFormulaErrorMsg:v,sheetArea:et.SheetArea.viewport}))return!1;if(!S&&t.GT(b.row,b.col,M,k))return f.jT(1,d),!1;if(c=m.row<0?g.getRowCount():m.rowCount,h=m.col<0?g.getColumnCount():m.colCount,T=b.row<0?t.getRowCount():b.rowCount,x=b.col<0?t.getColumnCount():b.colCount,p&&(c=(c-=g.ix(n.row,U(c,T),!0))<1?1:c,h=(h-=g.ix(n.col,U(h,x)))<1?1:h),v=2===i||(null==u?void 0:u.pasteLink),(T<c||x<h)&&!v){if(G=n.row,B=n.col,n.row<0&&T<g.getRowCount()&&(G=0),n.col<0&&x<g.getColumnCount()&&(B=0),c%T==0&&1===h?(h=x,p||(m=o.pastedRange=new nt.Range(G,B,c,h))):1===c&&h%x==0?(c=T,p||(m=o.pastedRange=new nt.Range(G,B,c,h))):c%T==0&&h%x==0||(m=o.pastedRange=new nt.Range(G,B,c=T,h=x)),I=F(c/T),P=F(h/x),a===it||r&&(!s||!st(g,new nt.Range(G,B,c,h))))for(R=0;R<I;R++)for(N=0;N<P;N++)if(!f.UT(b,m)&&g.GT(G<0?-1:G+R*T,B<0?-1:B+N*x,G<0?-1:T,B<0?-1:x))return f.jT(1,d),!1}else if(a===it&&!f.UT(b,m)&&g.GT(m.row,m.col,C,y))return f.jT(1,d),!1}else if(1<w){for(E=0;E<w;E++)if(H=e[E],t.GT(H.row,H.col,H.rowCount,H.colCount))return f.jT(1,d),!1;if(g.GT(m.row,m.col,m.rowCount,m.colCount))return f.jT(1,d),!1}}else{if(g.GT(m.row,m.col,m.rowCount,m.colCount))return f.jT(1,d),!1;if(!g.HT(m.row,m.col,m.rowCount,m.colCount))return f.jT(1,l),!1}return!0},UT:function(t,e){if(t&&1===t.rowCount&&1===t.colCount){var t=this.getSpan(e.row,e.col);if(t&&t.equals(e))return!0}return!1},_T:function(t,e,n,i,r,o,a){var s,u,c,f;if(t&&e&&n)try{return(u=(u=(s=(0,q.getRangeText)(t,e.row,e.rowCount,e.col,e.colCount,"\r\n","\t",'"',!1,r,o,!0,C.safari,!0))===i)||((u=!(u=s===i+"\r\n")&&C.chrome?s===i+"\t\r\n":u)||!(C.safari||C.mozilla||a)&&y(n)?u:s.replace(/\s/g,"")===i.replace(/\s/g,"")))||(c=new RegExp(String.fromCharCode(160),"g"),f=String.fromCharCode(32),u=(s=s.replace(c,f)).replace(/\s+$/,"")===i.replace(/\s+$/,"")),u}catch(t){}return!1},OT:function(t,e,n,i,r,o,a,s){var u,u,c,f,l,c,e,h,d,v,g,m,p,S,w,b,r,s,c,r,u=this,c=null==e?void 0:e.length,f=n.o5(),l=null==s?void 0:s.transpose;if(1!==c)return 1<c?u.fT(e,i,l):$;if(e=(c=e[0]).row<0?0:c.row,h=c.col<0?0:c.col,d=c.row<0?t.getRowCount():c.rowCount,v=c.col<0?t.getColumnCount():c.colCount,g=i.row<0?0:i.row,m=i.col<0?0:i.col,p=i.row<0?n.getRowCount():i.rowCount,S=i.col<0?n.getColumnCount():i.colCount,b=w=void 0,f&&(p=(p-=w=n.ix(g,U(p,d),!0))<1?1:p,S=(S-=b=n.ix(m,U(S,v)))<1?1:S),r=2===r||(null==s?void 0:s.pasteLink),o||1===p&&1===S&&!O(u,c))p=d,S=v;else if(!r&&(p%d==0&&1===S?S=v:1===p&&S%v==0?p=d:p%d==0&&S%v==0||(p=d,S=v),!u.zT(e,h,d,v,t.getRowCount(),t.getColumnCount())))return $;if(!o&&t.name()===n.name()&&ot(a))if(s=new nt.Range(g,m,p,S),c=d,r=v,l&&(c=(u=[r,c])[0],r=u[1]),s.contains(e,h,c,r)){if((e-g)%c!=0||(h-m)%r!=0)return $}else if(s.intersect(e,h,c,r)&&(c<p||r<S))return $;return f&&(p+=n.lT(g,p,!0),S+=n.lT(m,S)),n.HT(g,m,p,S)?(-1===i.row&&(p=g=-1),-1===i.col&&(S=m=-1),new nt.Range(g,m,p,S)):$},fT:function(t,e,n){var i,r,o,e,a,s,u,c,f,a,l,s,h,u,i=this,r=i.o5();if(1<t.length){if(o=-1===e.row?0:e.row,e=e.col<0?0:e.col,a=t[0],s=t[1],u=a.rowCount,c=a.colCount,f=a.row===s.row&&u===s.rowCount,a=a.col===s.col&&c===s.colCount,f&&!n||a&&n)return l=0,s=u,t.forEach(function(t){l+=t.colCount}),r&&(s+=i.lT(o,s,!0),l+=i.lT(e,l)),(0,nt.Ec)(o,e,s,l);if(a&&!n||f&&n)return h=0,u=c,t.forEach(function(t){h+=t.rowCount}),r&&(h+=i.lT(o,h,!0),u+=i.lT(e,u)),(0,nt.Ec)(o,e,h,u)}return $},RT:function(t,e,n,i){var r,e,o,n,i,n,r=e.row<0?0:e.row,e=e.col<0?0:e.col,o=new nt.Range(r,e,1,1),n=E(n,"\r\n","\t",'"',!1,i);return n&&(i=n.length,n=(0,q.getMaxLength)(n),0<i)&&0<n&&(t.o5()&&(i+=t.lT(r,i,!0),n+=t.lT(e,n)),o=new nt.Range(r,e,i,n)),o},BT:function(t,e,n){var i,e,r,o,a,a,n,a,n,a,i=e.row<0?0:e.row,e=e.col<0?0:e.col,r=1,o=1,a=t.ST();return a&&((a=a.i5()).innerHTML=n,a=(n=a.getElementsByTagName("table"))&&n[0])&&((n=a.rows)&&(r=n.length,a=n[0]&&n[0].cells)&&(o=a.length),0<r)&&0<o&&t.o5()&&(r+=t.lT(i,r,!0),o+=t.lT(e,o)),new nt.Range(i,e,r,o)},YT:function(){var t=this.ST();t&&t.c5()},fTe:function(){var t=this,e=t.rt;e.IT(C.safari?"test":""),document.execCommand("copy"),setTimeout(function(){e&&!t.xT&&e.NT()},100)},tA:function(t){if(!this.isEditing()){var e=this.getSelections();if(e&&1===e.length)return this.isActualProtected()&&this.ET(e)?(this.jT(14,this.FT()),$):this.CT(e,!0,t)}return $},yT:function(t){var e,n,i,r,o;if(t){if(1===(e=t.length))return t[0];if(1<e){if(n=t[0],i=t[e-1],o=r=void 0,n.row===i.row&&n.rowCount===i.rowCount){for(r=0;r<e;r++)(o=t[r]).col<n.col&&(n=o),o.col>i.col&&(i=o);return(0,nt.Ec)(n.row,n.col,n.rowCount,i.col+i.colCount-n.col)}if(n.col===i.col&&n.colCount===i.colCount){for(r=0;r<e;r++)(o=t[r]).row<n.row&&(n=o),o.row>i.row&&(i=o);return(0,nt.Ec)(n.row,n.col,i.row+i.rowCount-n.row,n.colCount)}}}return $},wT:function(t){var e,n,i,r,o,a,r,s,u,c,u,f,l,h,e=[],n=[];if(t&&1<(i=t.length)&&(r=t[0],o=t[i-1],a=r.row===o.row&&r.rowCount===o.rowCount,r=r.col===o.col&&r.colCount===o.colCount,a||r))for(t.sort(a?function(t,e){return t.col-e.col}:function(t,e){return t.row-e.row}),s=1;s<i;s++)for(u=t[s-1],c=t[s],u=a?u.col+u.colCount:u.row+u.rowCount,f=a?c.col:c.row,l=a?n:e,h=u;h<f;h++)l.push(h);return{rows:e,cols:n}},eA:function(t){var e,n,i,r,o,a,s,u,c,e=this;if(!e.isEditing()){if((n=e.getSelections())&&1===n.length){if((i=e.ST()).TT=!0,r=n[0],e.iA&&e.iA()){for(o=[],s=(a=-1)===r.row?1:0,u=0;u<r.rowCount;u++)c=r.row+s+u,e.XT(c)?-1!==a&&(o.push((0,nt.Ec)(a,r.col,c-a,r.colCount)),a=-1):-1===a&&(a=c);-1!==a&&o.push((0,nt.Ec)(a,r.col,r.row+s+r.rowCount-a,r.colCount)),n=o}return e.CT(n,!1,t)}if(V(n))return e.CT(n,!1,t);e.jT(1,rt().Exp_MultipleSelections)}return $},rA:function(u,c){var f,l,h,d,v,g,m,p,S,w,f=this,l=f.rt;f.isEditing()||(u&&(h=u.pasteText,d=u.pasteHtml,v=void 0===u.pasteOption?f.options.clipBoardOptions:u.pasteOption,g=u.shiftCells,S=u.isHeaderPaste,p=u.isFromDesigner,m=f.getSelections()[0],!b)&&u.pasteSpecialOptions&&(u.pasteSpecialOptions.operationOptions=0,u.pasteSpecialOptions.pasteLink=!1),l&&!h&&c&&l.IT(""),(w=f.ST())&&(w.oA=!1),setTimeout(function(){var t,e,n,i,i,r,o,a,s;if(!f.xT){if(t=h||"",e=d||"",l&&!h){if(w&&(i=w.QS(),r=w.DS,t=i.text,e=i.html,i=i.image,n=w._S,r)&&n)for(o=0,a=n;o<a.length;o++)s=a[o],nt.mt.J0(s,r.getRowCount(),r.getColumnCount());c&&l.NT()}(C.msie||C.edge||h||!t&&!e&&!w.oA)&&f.US(t,e,i,v,g,m,n,p,S,null==u?void 0:u.pasteSpecialOptions),f.rt.aA(),f.ki(nt.Events.PasteEnd)}},100))},US:function(t,e,n,i,r,o,a,s,u,c){var f,l,l,f=this,l=f.ST();if(l&&(l.oA=!0),!(l=f.uA(t,i,r,e,s,u,c,n))){if(!n)return;l={pasteOption:void 0===i?f.options.clipBoardOptions:i,pastedRanges:[(0,nt.Ec)(f.getActiveRowIndex(),f.getActiveColumnIndex(),1,1)],clipboardText:""}}r!==it&&(l._shiftCells=r),ot(u)||(l.kse=u),o&&(l.cA=o),a&&(l.fA=a),l.cmd="clipboardPaste",l.sheetName=f.name(),l.pasteSpecialOptions=k(c,l.pasteOption),y(f)&&(l.clipboardHtml=e,l.clipboardImage=n),f.Qy().execute(l)},uA:function(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,n,n,T,u=this,c=rt().Exp_InvalidPastedArea,f=u.ST(),l=f.DS,h=f._S,d=f.ES;if(f._S&&null!=a&&a.transpose){for(h=[],v=0;v<f._S.length;v++)m=(g=f._S[v]).row<0?0:g.row,p=g.col<0?0:g.col,S=g.row<0?l.getRowCount():g.rowCount,w=g.col<0?l.getColumnCount():g.colCount,h.push(new nt.Range(m,p,S,w));for(v=0;v<h.length;v++)h[v]=new nt.Range(h[v].row,h[v].col,h[v].colCount,h[v].rowCount)}if(d&&l&&h&&l.isActualProtected()&&l.ET(h)&&(d=!1),b={pastedRange:$,pastedInternal:!1},C=[],1<(y=u.getSelections()).length)for(k=2===e,v=0;v<y.length;v++){if(M=y[v],!u.kT(l,h,M,e,d,t,b,it,i,r,o,a,s))return;if(M.containsRange(b.pastedRange)&&!M.equals(b.pastedRange)&&!k)return void u.jT(1,c);C.push(b.pastedRange)}else{if(M=0<y.length?y[0]:u.Ut.getSpan(u.ui,u.ci),!u.kT(l,h,M,e,d,t,b,n,i,r,o,a,s))return;C.push(b.pastedRange)}if((n=u.lA)&&n._T(b.pastedInternal),b.pastedInternal||(h=l=$,d=!1),n=void 0===e?u.options.clipBoardOptions:e,d&&(n=u.hA),h&&1===h.length)for(T=0;T<C.length;T++)u.UT(h[0],g=C[T])&&(g.rowCount=1,g.colCount=1);if(!((!h||1<h.length)&&1<C.length))return{fromSheet:l,fromRanges:h,isCutting:d,pasteOption:n,pastedRanges:C,clipboardText:t};u.jT(1,rt().Exp_MultipleSelections)},HT:function(t,e,n,i,r){var o,a,s,o=this,a=o.getRowCount(),s=o.getColumnCount();return at(o)?-1<=t&&(r||t<a)&&-1<=e&&(r||e<s):o.zT(t,e,n,i,a,s)}})},"./dist/core/worksheet/worksheet-edit.js":function(t,e,n){"use strict";var G,B,e,M,e,I,n,P,R,N,E,H,U,k,i,g,r;Object.defineProperty(e,"__esModule",{value:!0}),G=n("./dist/core/worksheet/worksheet.js"),B=n("./dist/core/util/common.js"),e=n("./dist/core/util/domUtil.js"),M=e.GC$,e=n("Common"),I=n("./dist/core/core.enum.js"),n=n("CalcEngine"),P=!!n,R=B.mt.Tt,N=B.mt.pi(),E=e.Common.lt.ht,H=e.Common.CultureManager,U=null,k=void 0,i="string",g=B.mt.wt,M.extend(G.Worksheet.prototype,r={startEdit:function(t,e){var n=this;n.f6(n.Dg(),n.ui,n.ci,U,U,t,e)},editorStatus:function(){return this.Di||0},isEditing:function(){var t=this.Di;return 1===t||2===t},endEdit:function(t,e){return this.ol(t,void 0,void 0,void 0,e)},ol:function(t,e,n,i,r){var o,a,s,u,c,o=this;if(!o.isEditing())return!0;o.suspendPaint();try{return a=o.ui,s=o.ci,u=I.SheetArea.viewport,(c=o.vA)&&(a=c.row,s=c.col,u=c.sheetArea,o.vA=k),o.l6(a,s,u,t,e,n,i,r)}finally{o.resumePaint()}},l6:function(t,e,n,i,r,o,a,s){var u,c,f,l,t,e,h,d,v,g,m,m,m,p,S,m,w,p,b,S,m,C,y,r,p,S;if(void 0===n&&(n=I.SheetArea.viewport),c=(u=this).rt,f=u.li,l=u.name(),(v=u.getCellType(t=t,e=e,n)).isImeAware(g={sheet:u,row:t,col:e,sheetArea:n})||c.aA(),f&&f.parentNode){if(d=v.getEditorValue(f,g),u.ki(B.Events.EditEnd,m={sheet:u,sheetName:l,row:t,col:e,editor:f,editingText:d,cancel:!1,committed:!i}),m.cancel&&!a)return;if(u.ki(B.Events.EditEnding,m),m.cancel&&!a)return;if(m=(m=u.parent)&&m.h6,document.activeElement===(m&&m.Ti)&&c.aA(),0<=t&&0<=e&&(p=f.d6,S=u.getFormulaInformation&&u.getFormulaInformation(t,e,3),v.isEditingValueChanged(p,d,g)||1===r||S&&S.isArrayFormula&&1!==r))if(i)v.setEditorValue(f,p,g),v.selectAll(f,g);else if(m=v.v6,E(m)&&(m=!0),p={cmd:"editCell",sheetName:l,row:t,col:e,sheetArea:n,newValue:d=(w=u.getActualStyle(t,e)).mask&&S&&!S.hasFormula&&d&&-1<B.FormulaPrefix.indexOf(d[0])?"'"+d:d,autoFormat:m,editingFormatter:f.Ii},1===r&&(p.ranges=[u.U5()],p.endEditType=r),null!==d&&(b=u.tables&&u.tables.find&&(u.tables.find(t-1,e)||u.tables.find(t,e-1)))&&u.tables.yx(U,new B.Range(t,e,1,1),null,d,!0),u.Qy().execute(p),2===(h=p.applyResult)&&(v.focus(f,g),!a))return!1;if(u.k1=!0,S=n===I.SheetArea.colHeader?-1:k,m=n===I.SheetArea.rowHeader?-1:k,v.Sn(f,g,u.getCellRect(t,e,S,m)),v.isImeAware(g))R.msie&&9===parseFloat(R.version)?c.aA():M(f.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(C=u.qc(),y=f;y;)y.parentNode===C?C.removeChild(y):y=y.parentNode}return u.u0=!1,p=M.extend({},r={sheet:u,sheetName:l,row:t,col:e,editingText:d,ignoreValueChange:i,sheetArea:n,committed:!i}),!1!==s&&u.ki(B.Events.EditEnded,r),u.ki(B.Events.FormulaTextboxEditEnded,p),!(!0!==o&&p.ignore&&!a)&&(0!==u.Di&&(S=u.Di,u.Di=0,u._i(S,0)),u.Ut.setCellState(t,e,I.CellStatesType.edit,!1,n),G.Worksheet.et(u,"endEdit"),u.li=U,1!==h)},m6:function(t,e,n){var i,r,o,a,s,t,s,r,u,e,i=this,r=i.hitTest(e,n);!r||r.cellTypeHitInfo&&(r.cellTypeHitInfo.outlineColumnHitInfo||r.cellTypeHitInfo.cellButtonHitInfo)||(o=r.row,a=r.col,0<=o&&0<=a&&0<=r.rowViewportIndex&&0<=r.colViewportIndex&&!r.resizeInfo&&!r.dragInfo&&o===i.ui&&a===i.ci&&(s=i.isEditing(),i.f6(t,o,a),!s)&&i.isEditing()&&(t=r.hitTestType,(s=i.getCellType(o,a)).j3)&&(r=i.getCellRect(o,a,1===t?-1:k,2===t?-1:k),u=i.getActualStyle(o,a,t),e=s.Bn(e,n,u,r,{sheet:i,row:o,col:a,sheetArea:t}))&&e.isReservedLocation&&s.j3(i,o,a,3))},inputFormulaAndSelectFormulaRange:function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,c,r=this,o=r.options,a=r.getCellRect(t,e),s=r.getActualStyle(t,e),u=r.getCellType(t,e),c=r.rt;c.Zg(),f={sheet:r,row:t,col:e,sheetArea:3},(h=(l=c.g6)&&l.firstChild?l.firstChild.firstChild:h)&&(r.li=h,d=r.Fi(),u.isImeAware(f)&&c.p6(),u.On(l,s,a,f),r.Ri(u,h,t,e,s,k,k,k,k,3),u.Rn(l,s,a,f),o.allowCellOverflow&&((c=a.clone()).y-=2,c.height+=4,c.x=o.rightToLeft?d.x:d.b6,c.width=r.Gy(d),r.repaint(c)),G.Worksheet.et(r,"startEdit",{element:u.getEditingElement(),row:t,col:e,sheetArea:3}),r.Di=2,r.il.text(i),r.il.caret(i.length-1),n&&r.il.y6(3,4),r.il.w6(),B.hi.F1(r))},f6:function(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,v,g,m,p,p,S,w,b,C,y,M,k,C,k,C,k,k,u,k,C,u,k,C,u,i,T,x,r,p;e<0||n<0||(f=(c=this).name(),l=c.options,c.isEditing())||(h=c.C6(i,r),E(h)&&(h=3),(d=c.Ut).setCellState(e,n,I.CellStatesType.edit,!0,h),v=c.getActualStyle(e,n,h),c.isActualProtected()&&!1!==v.locked?(d.setCellState(e,n,I.CellStatesType.edit,!1,h),c.jT(13,c.FT())):(g=c.getCellType(e,n,h))&&(G.Worksheet.et(c,"allowStartEdit",p={row:e,col:n,sheetArea:h,isAllow:m=!0}),p.isAllow)&&((p=c.rt).Zg(),b=(w=g.isImeAware(S={sheet:c,row:e,col:n,sheetArea:h})?p.g6:g.jn(S))&&w.firstChild?w.firstChild.firstChild:b)?(C=v,y=!1,k=H.culture(),(C.formatter&&B.util.h0(C.formatter,k)||!C.formatter&&C._autoFormatter&&C._autoFormatter.formatCached&&B.util.h0(C._autoFormatter,k))&&(u&&u.key&&(C=u.key,k=u.code,C&&-1!==B.NUMBER_ARRAY.indexOf(C)&&(y=!0),"+"!==C&&"-"!==C||(g.probabilityAddPercent=!0),"process"===C.toLowerCase())&&(!u.shiftKey&&0<k.length-k.replace(/[0-9]/,"").length&&(y=!0),!u.shiftKey&&(0<k.length-k.replace("Minus","").length||0<k.length-k.replace("Subtract","").length||0<k.length-k.replace("Add","").length)&&(g.probabilityAddPercentSpec=!0),u.shiftKey)&&0<k.length-k.replace("Equal","").length&&(g.probabilityAddPercentSpec=!0),C=w.innerText,R.msie&&(C=C.replace("\r\n","")),k=H.Fe(H.culture()).NumberFormat.numberDecimalSeparator,k=new RegExp("^[-]?[0-9]+(\\"+k+"[0-9]+)?$"),!u)&&C&&k.test(C)&&(M=!0),c.li=b,c.ki(B.Events.EditStarting,u={sheet:c,sheetName:f,row:e,col:n,cancel:!1}),u.cancel?(N.ipad&&p.aA(),d.setCellState(e,n,I.CellStatesType.edit,!1,h)):(c.vA={row:e,col:n,sheetArea:h},3===h&&c.showCell(e,n,3,3),c.S6=!0,k=c.getValue(e,n,h),C=P&&c.getFormula(e,n,h),u=c.Di,c.Ai||E(k)&&E(C)?c.Di=1:c.Di=2,c._i(u,c.Di),c.isPaintSuspended()&&c.n3(),k=c.Fi(),!(C=c.getCellRect(e,n,i,r))||E(C.width)||E(C.height)||E(C.x)||E(C.y)||C.width<=0||C.height<=0||(g.isImeAware(S)&&p.p6(),g.On(w,v,C,S),c.Ri(g,b,e,n,v,a,s,y,M,h),u=c.qc(),g.isImeAware(S)||u.insertBefore(w,U),delete c.S6,g.Rn(w,v,C,S),g.isImeAware(S)&&o||g.focus(b,S),l.allowCellOverflow&&((i=C.clone()).y-=2,i.height+=4,c._1&&c._1.isEnable(I.RowColumnStates.edit,!1)&&(i.y=k.T6,i.height=k.A6),i.x=l.rightToLeft?k.x:k.b6,i.width=c.Gy(k),c.repaint(i)),B.util.df(e,n,c)&&g.setEditorValue(b,"",S),G.Worksheet.et(c,"startEdit",{element:g.getEditingElement(),row:e,col:n,sheetArea:h,preventFormulaTextBox:!!v.mask}),y||!o||v.mask||g.selectAll(b,S),y&&(T=window.getSelection(),(x=document.createRange()).setStart(b,0),T.removeAllRanges(),T.addRange(x)),M&&(T=window.getSelection(),(r=document.createElement("span")).innerText="%",x=document.createRange(),c.parent.options.enableFormulaTextbox&&c.parent.options.allowUserEditFormula&&!v.mask?(b.firstChild.appendChild(r),x.setStart(b.firstChild,1),c.il&&c.il.I6()):(b.appendChild(r),x.setStart(b,1)),T.removeAllRanges(),T.addRange(x)),B.hi.F1(c),c.ki(B.Events.EditStarted,p={sheet:c,sheetName:f,row:e,col:n,sheetArea:h}),c.ki(B.Events.FormulaTextboxEditStarted,p)))):d.setCellState(e,n,I.CellStatesType.edit,!1,h))},Ri:function(t,e,n,i,r,o,a,s,u,c){var f,l,h,a,d,v,d,f=this,l=P&&f.getFormula(n,i,c,!0),a={sheet:f,row:n,col:i,sheetArea:c,isImeInput:a,cellStyle:r};(h=l=l&&"="+l)&&0!==l.length||((l=f.getValue(n,i,c,1))&&l.richText&&(l=g(l)),d=f.parent,v=P&&d&&d.options.allowUserEditFormula,d=P&&d&&d.options.allowInvalidFormula,B.util.c0(l,r.quotePrefix,v,d)?h=l="'"+l:(h=l,l=t.je(e,r,l,a))),e.d6=l,E(o)||(l=o),u&&(l=l&&this.x6(l,r)),r.mask&&r.mask.pattern&&"'"!==r.mask.pattern[0]&&l&&"'"===l[0]&&-1<B.FormulaPrefix.indexOf(l[1])&&(l=l.substring(1,l.length)),t.setEditorValue(e,l,a,s,u),f.parent&&f.parent.options.enableAccessibility&&(f.parent.Q1e(),f.K1e(e,l,n,i,c)),e.Li=h},K1e:function(t,e,n,i,r){var o,a,s,a,e,n,o=this,a=e&&"="===e[0],s=o.getText(n,i,r),a=a?e:o.getFormula(n,i,r),e=3===r&&o.comments&&o.comments.get(n,i),n=o.N6(n,i,r,s,a,e&&e.text());t.setAttribute("aria-label",n),o.setAccessibilityPrefixSuffixContent&&o.setAccessibilityPrefixSuffixContent()},k6:function(t){var e="",t=t&&(t.formatter||t._autoFormatter);return e=t?typeof t==i?t:t.formatCached:e},x6:function(t,e){var n,i,n,e,r,o,e,r,e,r,e,e,a,s,n=H.Fe(H.culture()).NumberFormat,i=n.negativeSign,n=n.numberDecimalSeparator,e=this.k6(e),r="%"===e[0],e=e.split(";");if(r?o=e[0].split("%")[1].split(".")[1]:-1<e[0].indexOf("%")&&(o="00"),void 0===o&&(o=""),1<t.split("e").length)return r=t.split("e")[0],e=t.split("e")[1],r+"e+"+(parseInt(e.split("+")[1],10)+2);if(1<t.split(n).length){for(r=!1,t.charAt(0)===i&&(t=t.substr(1,t.length-1),r=!0),e=(t+=o).indexOf(n),a=(e=(t=(t=t.split(n).join("")).substr(0,e+2)+n+t.substr(e+2,t.length-1)).split(n))[0],s=e[1];a&&"0"===a.charAt(0);)a=a.substr(1,a.length-1);for(;s&&"0"===s.charAt(s.length-1);)s=s.substr(0,s.length-1);return(a=r?a&&i+a:a)&&s?a+n+s:!a&&s?(r?i+"0"+n:"0"+n)+s:a&&!s?a:"0"}return"0"===t?t:t+o}})},"./dist/core/worksheet/worksheet-event.js":function(r,o,t){"use strict";var a,S,y,u,d,w,p,t,v,O,c,g,m,V,Y,K,f,z,b,W,e,J,Z,Q,X,q,$,tt,et,M,C,k,nt,T,s,x,G,it,rt,ot,at,st,ut,ct,ft,lt,ht,dt,vt,gt,mt,pt,St,wt,B,I,P,bt,Ct,yt,e,Mt,kt,Tt,xt;function Gt(t,e){var n,e,n=[e,e];return n=t<3*e?2===t?[1,0]:1===t?[0,0]:[e=s(t/3),e]:n}function Bt(t,e){var n=3;return U(e)<0&&(n=1),!(3===(n=F(e)<0?2:n)||!t.ni(e.row,e.col,n,!0))}function It(t,e,n){var i,r,o,a,s,u,s,u,c,f,u,c,i=!1,r=t.Fi();return e&&(o=U(e),s=(a=F(e))<0&&e.col>=t.getFreeAreaColumnCount(p.SheetArea.rowHeader),u=o<0&&e.row>=t.getFreeAreaRowCount(p.SheetArea.colHeader),s||u)&&((s=t.getCellRect(e.row,e.col,o,a,{needAutoMerge:!0}))&&0<s.width&&0<s.height?(u=r.x,c=r.y,(s.x<r.XC+u||s.y<r.qC+c||s.y>=r.height-r.D6)&&(f=new w.Rect(s.x-2,s.y-2,s.width+4,s.height+4),u=void 0,u=o<0&&a<0?r.R1():o<0?r.L1(a):r.B1(o),f=f.getIntersectRect(u),n._6(f.x,f.y,f.width,f.height),i=Bt(t,e))):e.cellTypeHitInfo&&e.cellTypeHitInfo.addRowColumnButtonHitInfo&&(f=void 0,1===(c=e.cellTypeHitInfo.addRowColumnButtonHitInfo).addRowColumnButtonType?f=r.XAe():2===c.addRowColumnButtonType&&(f=r.qAe()),n._6(f.x,f.y,f.width,f.height))),i}function R(t){return t.isEditing()}function N(t){return t.endEdit()}function Pt(t){return t.frozenRowCount()}function Rt(t){return t.frozenColumnCount()}function E(t,e){return t.getRowCount(e)}function H(t,e){return t.getColumnCount(e)}function U(t){return t.rowViewportIndex}function F(t){return t.colViewportIndex}function _(t){return t.hitTestType}function Nt(t){return t.getActiveRowIndex()}function Et(t){return t.getActiveColumnIndex()}function l(t){return t.keyCode}function h(t){return t.ctrlKey}function A(t){return t.shiftKey}function Ht(t){return t.altKey}function Ut(t){return t.metaKey}function L(t){return t.colCount}function Ft(t){return t.rowCount}function D(t,e,n){return{action:t,index:e,sheetArea:n}}function _t(t,e,n){return M===e.O5(t,n,!0)}function At(t,e,n){return M===e.j5(t,n,!0)}function Lt(t,e){return e?t.E6?t.startY-t.movingY:t.movingY-t.startY:t.j6||t.Gxn?t.startX-t.movingX:t.movingX-t.startX}function j(t,e,n,i,r,o,a){var e,r,e={sheet:t,sheetName:e,sheetArea:r,row:n,col:i},r=t.getCellType(n,i);return r&&(e=r.lfe(e,a)),o&&(e.cancel=!1),e}function Dt(t,e,n,i,r,o){var a,s,a=t.Mf,s=j(a,a.name(),a.ui,a.ci,C,!0);if(a.ki(w.Events.LeaveCell,s),s&&!0===s.cancel)return!0;a.O6(e,n,i,r,o),a.ki(w.Events.EnterCell,j(a,a.name(),e,n)),a.ki(w.Events.EnterCellInternal,j(a,a.name(),e,n,C,C,w.Events.EnterCellInternal)),t.PA&&t.PA(e,n)}function jt(t,e,n,i,r,o,a){var s,e,u,s=t.Mf,e=e.call(s,o.sheetArea);return(a&&!s.getRowVisible(o.index,o.sheetArea)||!a&&!s.getColumnVisible(o.index,o.sheetArea))&&(o.index=n.call(t,o.index,o.sheetArea)),u=(u=i.call(e,o.index))||i.call(e,r)}function Ot(t,e,n,i,r){var o,a,s,e,n,o=i?"movingY":"movingX",a=i?"startY":"startX";t[o]=e,(s=t.j6||t.Gxn||t.E6?t[o]>t[a]:t[o]<t[a])&&(t[o]=t[a]),e=i?n.y+n.height:n.x+n.width,n=i?t.R6:t.B6,t[o]>e&&!n&&(t[o]=e),r!==M&&t[o]>t[a]+r&&(t[o]=t[a]+r)}function Vt(t,e){var n,n,n=t.Fi();return 0<Pt(t)&&e<n.T6+n.L6?0:0<t.frozenTrailingRowCount()&&e>n.Ay?2:t.FCn&&(n=t.dw(3))&&n.findY(e)?3:1}function Yt(t,e){var n=t.Fi();return 0<Rt(t)&&n.b6<e&&e<n.b6+n.F6?0:0<t.frozenTrailingColumnCount()&&e>n.Hy&&e<n.Hy+n.zy?2:1}function Kt(t,e,n){var e=t._y(e);return e?e.findNearY(n,t.options.rightToLeft):M}function zt(t,e){var n=t._y(-1,p.SheetArea.colHeader);return n?n.findNearY(e,t.options.rightToLeft):M}function Wt(t,e,n){var e=t.Yy(e);return e?e.findNearX(n,t.options.rightToLeft):M}function Jt(t,e){var n=t.Yy(-1,p.SheetArea.rowHeader);return n?n.findNearX(e,t.options.rightToLeft):M}function Zt(t){return!t.isActualProtected()||t.options.protectionOptions.allowResizeRows}function Qt(t){return!t.isActualProtected()||t.options.protectionOptions.allowResizeColumns}function Xt(t,e){var n,i,r,e,o,t,n=e.row,i=e.rowCount,r=e.col,e=e.colCount,o=t.getColumnCount(),t=t.getRowCount();return{row:n,col:r,rowCount:i=t<i+n?t-n:i,colCount:e=o<e+r?o-r:e}}function qt(t,e){var n,i,n=t.getViewportBottomRow(t.C0(e));if(e<(n=-1===n?t.P6():n))for(i=n;e<i;i--)if(0!==t.getRowHeight(i))return;return 1}function $t(r){var t,o,a,t=r.Ut.getSelections();if(0<t.length)return o=0,a=r.getRowCount(),t.every(function(t){var t,e,n,i,t=Xt(r,t),e=!1;return 1===t.rowCount&&(e=(o+=1)<=1),n=t.row<a,(i=-1!==t.col)||e&&n})}function te(t,e,n){var i,r,i,r=t.parent.options.rowResizeMode;return n&&0===r&&(r=1),e.action!==B&&1===r&&!qt(t,e.index)&&!(!t.getRowResizable(e.index,e.sheetArea)||!t.getRowResizable(e.index+1,e.sheetArea))&&$t(t)}function ee(t,e,n,i){return te(t,e,i)&&1===n.length&&n[0].firstRow===n[0].lastRow}function ne(t,e){var n,i,n=t.getViewportRightColumn(t.S0(e));if(e<(n=-1===n?t.G6():n))for(i=n;e<i;i--)if(0!==t.getColumnWidth(i))return;return 1}function ie(r){var t,o,a,t=r.Ut.getSelections();if(0<t.length)return o=0,a=r.getColumnCount(),t.every(function(t){var t,e,n,i,t=Xt(r,t),e=!1;return 1===t.colCount&&(e=(o+=1)<=1),n=t.col<a,(i=-1!==t.row)||e&&n})}function re(t,e,n){var i,r,i,r=t.parent.options.columnResizeMode;return n&&0===r&&(r=1),e.action!==bt&&1===r&&!ne(t,e.index)&&!(!t.getColumnResizable(e.index,e.sheetArea)||!t.getColumnResizable(e.index+1,e.sheetArea))&&ie(t)}function oe(t,e,n,i){return re(t,e,i)&&1===n.length&&n[0].firstColumn===n[0].lastColumn}function ae(t,e,n,i,r){var o,a,r,s,o=e.index,a=t.Fi();te(t,e,r)?(r=t.j5(o,n),Ot(e,i,a,!0,s=t.Gt(o,n)+t.Gt(r,n))):Ot(e,i,a,!0)}function se(t,e,n,i,r){var o,a,r,s,o=e.index,a=t.Fi();re(t,e,r)?(r=t.O5(o,n),Ot(e,i,a,!1,s=t.nn(o,n)+t.nn(r,n))):Ot(e,i,a,!1)}function ue(t,e,n){var i,r,o,a,s,u,c,f,i=n?t.frozenRowCount():t.frozenColumnCount(),r=n?t.Tb:t.Ab,o=!1,s=r-1;if(0<i&&i<r)for(u=r-1;i<=u;){if(a=n?t.getRowVisible(u):t.getColumnVisible(u)){if(c=n?t.getRowHeight(u):t.getColumnWidth(u),u===s&&0===c)break;if(0<c){o=!0;break}}else s--;u--}for(f=o?i:e,f--;0<=f;){if(a=n?t.getRowVisible(f):t.getColumnVisible(f))return f;f--}return-1}function ce(t){var t=t.il;return t&&t.U6}function fe(t){for(;t!==O.body;){var e;if(getComputedStyle(t).transform.match(/matrix\([^\)]+\)/))return 1;if(!t.parentNode)break;t=t.parentNode}}function le(t,e,n){var i;return i=e.addRowColumnButtonHitInfo?t.$Ae(_(n)):i}function he(t,e,n){var i=le(t,e,n);return b(i)&&(i=t.getCellType(e.row,e.col,_(n),{rowSpacingIndex:n.rowSpacingIndex,isAfterRowSpacing:n.isAfterRowSpacing})),e.sheet||(e.sheet=t),i}function n(t,e){var n=this;n.Ti=t,n.H6=M,n.z6=M,n.V6=M,n.Y6=M,n.Z6=!1,n.W6=!1,n.h4=e}function i(t){this.Q6=0;var e=this;e.K6=0,e.J6=!1,e.X6=!1,e.q6={},e.Mf=t,e.tk="gcEvent"+t._id}Object.defineProperty(o,"__esModule",{value:!0}),o.nk=void 0,a=t("./dist/core/core.ns.js"),S=t("./dist/core/worksheet/worksheet.js"),y=t("Common"),u=t("./dist/core/worksheet/worksheet-model.js"),d=t("./dist/core/util/domUtil.js"),w=t("./dist/core/util/common.js"),p=t("./dist/core/core.enum.js"),t=t("./dist/core/workbook/sheettabbase.js"),v=window,O=document,c=d.GC$.each,g=w.mt.Tt,m=w.mt.pi(),V=w.mt.vi,Y=w.mt.En,K=y.Common.zf,f=y.Common.zf.I5,z=w.Ec,b=y.Common.lt.ht,J="mousedown"+(e=".handler"),Z="mouseup"+e,Q="mousemove"+e,X="mousewheel"+e,q="DOMMouseScroll"+e,$="wheel"+e,tt="mouseout"+e,et="dblclick"+e,M=null,C=void 0,k=isNaN,nt=parseInt,T=Math.max,s=Math.floor,x=Math.min,G=Math.abs,it=Math.ceil,rt="function",ot="position",at="absolute",st="border",ut="overflow",ct="top",ft="left",lt="width",ht="height",dt="resize",vt="hidden",gt="visible",mt="none",pt="tabindex",St="gcUIElement",wt="corner",B="sizeHiddenRow",I="sizeRow",P="sizeCol",bt="sizeHiddenCol",Ct="default",yt=m.iphone||m.ipad||m.android,e=new y.Common.ResourceManager(a.SR,"Sheets"),Mt=e.getResource.bind(e),kt=30,n.prototype.ek=function(t){typeof t==rt&&(this.z6=t)},n.prototype.ik=function(t){var e,n,e=this;k(t)||0===t?e.rk():(e.W6=e.Ti.W6(t,e.h4),t=G(t),(n=e.H6)!==(e.H6=t)&&e.ak())},n.prototype.ak=function(){var t=this;t.d5(),k(t.H6)||(t.V6=v.setInterval(function(){t.uk()},t.H6))},n.prototype.uk=function(){var t=this,e=t.z6;t.Z6=!0,typeof e==rt&&(t.Y6=e.call(t.Ti,t.W6))},n.prototype.rk=function(){var t=this;t.d5(),t.H6=M,t.V6=M,t.Y6=M,t.Z6=!1},n.prototype.d5=function(){var t=this.V6;t&&clearInterval(t)},n.prototype.L0=function(){this.rk()},Tt=n,i.prototype.L0=function(){var t=this;t.sk&&t.sk.L0(),t.ck&&t.ck.L0(),t.fk=M},i.prototype.lk=function(){var t=this;return t.sk||(t.sk=new Tt(t,!0)),t.sk},i.prototype.hk=function(){var t=this;return t.ck||(t.ck=new Tt(t,!1)),t.ck},i.prototype.uw=function(){return this.Mf.uw()},i.prototype.it=function(){var t,t;return t=(t=(0,d.GC$)(this.Mf.Dg()).position())||{top:0,left:0}},i.prototype.gg=function(t){var e,n,e,n,e,i,r,o,a,a,i,r,o,e=w.mt.Qf(),n=h(t),e=e&&!0===n&&0===t.button;return!(2!==t.button&&!e&&(e=(n=this).Mf,n.Fg(),g&&g.msie&&t.offsetX!==C&&t.offsetY!==C&&(r=i=0,o=e.fg,t.target!==o&&(i=(a=w.mt.T0(t.target,o)).I0,r=a.A0),o)&&(a=t.pageX-(t.offsetX+i),i=t.pageY-(t.offsetY+r),o.canvasOffset={top:i,left:a}),r=e.uw(),o=n.dk(t,t.pageX-r.left,t.pageY-r.top),R(e)||o||n.Zg(),e.vk=!0))},i.prototype.Fg=function(){var e=this;e.p4||((0,d.GC$)(O).bind("mousemove.gcSheet."+e.tk,function(t){e.pg(t)}).bind("mouseup.gcSheet."+e.tk,function(t){e.bg(t)}),e.p4=!0)},i.prototype.u2=function(){this.p4&&(this.p4=!1,d.GC$)(O).unbind("mousemove.gcSheet."+this.tk).unbind("mouseup.gcSheet."+this.tk)},i.prototype.dk=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,e,n,e,h,u,c,l,d,v,g,m,p,i=this,r=i.Mf,o=r.hitTest(e,n),a=o.row,s=o.col,u=o.dragInfo,c=o.formulaRangeHitInfo,f=o.cellTypeHitInfo,l=o.resizeTableHitInfo,h={hitInfo:o,e:t,r:M};if(S.Worksheet.et(r,"processMouseDown",h),e>=(e=r.Fi()).x&&n>=e.y&&(r.sw=o,!h.r))if(i.ab=!0,o.tableSelectInfo&&!r.Nde)i.mk(o,r);else if(o.resizeInfo)(ce(r)||N(r))&&i.gk(o);else if(o.dragHeaderToMoveInfo)(ce(r)||N(r))&&i.FTe&&i.FTe(o);else if(o.dragMergeInfo)N(r)&&i.pk&&i.pk(o);else if(u&&u.side&&u.side!==wt)N(r)&&(i.bk&&i.bk(o),i.yk(t));else if(u&&u.side===wt)N(r)&&i.wk&&i.wk(o);else if(o.filterButtonHitInfo)N(r);else{if(c)return c.inBorder?(i.Mk(o),!0):c.inTopLeft||c.inTopRight||c.inBottomLeft||c.inBottomRight?(i.Ck(o),!0):void 0;if(l)i.Sk&&i.Sk(o);else if(r.JA(U(o)<0?-1:a,F(o)<0?-1:s)){if(n=r.Nde,o.tableSelectInfo&&n?(e=this.Tk(o,r),o.tableSelectInfo.tableSelection=e,n.Ak(e)):n&&n.Hce(),i.Ik&&i.Ik(r,o))return!0;if(h=Nt(r),u=Et(r),f){if(c=he(r,f,o),i.xk(c,f)&&(l=f.sheetArea,b(l)||3===l)&&(a!==h||s!==u)){r.suspendPaint();try{if(!N(r))return;if(d=j(r,r.name(),h,u,C,!0),r.ki(w.Events.LeaveCell,d),d&&!0===d.cancel)return;(v="number"==typeof(null==o?void 0:o.rowSpacingIndex))||(g=r.Ut.getSelections(),m=r.Ut.getSpan(a,s),p=[new w.Range(m.row,m.col,m.rowCount,m.colCount)],r.ki(w.Events.FloatingElementSelected,{type:"worksheet"}),r.EA(g,p),r.t4(a,s,C,C,1),r.ki(w.Events.EnterCell,j(r,r.name(),a,s)),r.ki(w.Events.EnterCellInternal,j(r,r.name(),a,s)),r.jA(g),r.Nk=!0,i.PA&&i.PA(a,s))}finally{r.resumePaint()}}c.processCellAndPaddingMouseDown(f)}if(f&&f.isReservedLocation)return!0;i.yk(t),i.kk(r,o,a,s)}}},i.prototype.kk=function(t,e,n,i){var r,n,i,r=this;try{if(r.Dk=e,R(t)&&!N(t))return}finally{r.Dk=M}b(n)||b(i)||(3===_(e)&&r.PA&&r.PA(n,i),t.ki(w.Events.FloatingElementSelected,{type:"worksheet"}),n=t.Ut.getSelections(),r._k(e,n),i=t.Ut.getSelections(),t.EA(n,i))},i.prototype.xk=function(t,e){return t&&e&&e.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},i.prototype.Ek=function(t){var e,n,e=this.Mf;return!e||(n=e.Fi(),b(t.x))||b(t.y)||b(t.width)||b(t.height)||t.x+t.width>n.Py+e.Gy(n)+n.zy||t.y+t.height>n.Cy+e.Sy(n)+n.Iy},i.prototype.jk=function(t,e,n,i,r){for(var o,a,s,u,c,f,r,r,l,o=this.Mf,s=0,u=t.options,c=u.length;s<c;s++)if((f=u[s]).selected){a=i[s].value;break}r={cmd:"editCell",sheetName:o.name(),row:e,col:n,newValue:a,autoFormat:!0,ignoreFormatting:r,ignoreFormula:!0},r=o.Qy().execute(r),!b(a)&&r&&(l=o.tables&&o.tables.find&&(o.tables.find(e-1,n)||o.tables.find(e,n-1)))&&o.tables.yx(M,new w.Range(e,n,1,1),null,a,!0),(0,d.GC$)(t).hide()},i.prototype.Ok=function(){var t,e,t=this;t.Rk&&(3!==(e=t.Rk.Bk)&&2!==e||t.hk().ek(t.Lk),3!==e&&1!==e||t.lk().ek(t.Fk))},i.prototype.Pk=function(){var t=this;t.ob&&t.Gk(),t.Uk&&t.Hk&&t.Hk(),t.zk&&t.Vk&&t.Vk(),t.Yk&&t.Zk&&t.Zk(),t.Wk&&t.Qk(),t.Kk&&t.Jk(),t.Xk&&t.qk(),t.$k&&t.t9&&t.t9(),t.BTe&&t.LTe&&t.LTe()},i.prototype.Lk=function(t){var e,n,i,r,i,o,a,s,u,t,a,i,e=this,n;e.n9()||(i=e.Rk,r=e.Mf,i=i.e9,o=r.getViewportTopRow(i),a=r.getViewportBottomRow(i),u=(s=r.pge())===o?o:r.j5(o),t?(a<E(r)-r.frozenTrailingRowCount()-1||(t=r._y(i))&&0<t.length&&(a=r.Fi(),(i=t[t.length-1]).y+i.height>=a.Cy+r.Sy(a)))&&r.$A(u):o>Pt(r)&&r.$A(r.nI(o))),e.Pk()},i.prototype.Fk=function(t){var e,n,i,r,o,a,s,u,c,t,s,o,e=this,n;e.i9()||(i=e.Mf,o=(r=e.Rk).r9,a=i.getViewportLeftColumn(o),s=i.getViewportRightColumn(o),c=(u=i.bge())===a?a:i.O5(a),t?(s<H(i)-i.frozenTrailingColumnCount()-1||(t=i.Yy(o))&&0<t.length&&(s=i.Fi(),(o=t[t.length-1]).x+o.width>=s.Py+i.Gy(s)))&&i.o9(c):a>Rt(i)&&i.o9(i.r6(a))),e.Pk()},i.prototype.n9=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,t=this.Mf,e=t.Fi(),n=Pt(t),i=t.frozenTrailingRowCount(),r=this.fk,o=this.Rk,a=o.e9;if(0===a){if(r.y>e.Cy)return t.$A(t.pw()),o.e9=1,!0}else if(1===a){if((s=t._y(1))&&0<s.length){if(u=s[0],0<n&&r.y<e.Cy&&u.row<=t.pw())return!(o.e9=0);if(u=s[s.length-1],0<i&&r.y>e.Ay&&u.row>=t.P6()&&u.y+u.height<=e.Ay)return o.e9=2,!0}}else if(2===a&&(s=t._y(1))&&0<s.length&&r.y<e.Ay){if((u=s[s.length-1]).y+u.height>e.Ay){for(c=t.Sy(e),l=0,h=f=E(t)-i-1;n<=h;h--)if(c<(l+=t.Gt(h))){f=x(h+1,f);break}t.$A(t.j5(f-1))}return o.e9=1,!0}return!1},i.prototype.i9=function(){var t,e,n,i,r,o,a,s,u,c,f,l,h,t=this.Mf,e=t.frozenTrailingColumnCount(),n=Rt(t),i=t.Fi(),r=this.fk,o=this.Rk,a=o.r9;if(0===a){if(r.x>i.Py)return t.o9(t.Sw()),o.r9=1,!0}else if(1===a){if((s=t.Yy(1))&&0<s.length){if(u=s[0],0<n&&r.x<i.Py&&u.col<=t.Sw())return!(o.r9=0);if(u=s[s.length-1],0<e&&r.x>i.Hy&&u.col>=t.G6()&&u.x+u.width<=i.Hy)return o.r9=2,!0}}else if(2===a&&(s=t.Yy(1))&&0<s.length&&r.x<i.Hy){if((u=s[s.length-1]).x+u.width>i.Hy){for(c=t.Gy(i),l=0,h=f=H(t)-e-1;n<=h;h--)if(c<(l+=t.nn(h))){f=x(h+1,f);break}t.o9(t.O5(f-1))}return o.r9=1,!0}return!1},i.prototype.a9=function(){var t,e,n,i,r,i,o,a,s,s,r,n,i,e,u,t=this;(t.rb||t.u9||t.s9)&&(n=(e=t.Mf).Fi(),i=t.Rk,b(i)||(r=i.e9,i=i.r9,o=t.fk,a=M,0<=r&&0<=i?(a=n.c9(r,i),0===r&&e.Tb===e.frozenRowCount()&&(s=n.c9(1,i),a.height+=s.height),0===i&&e.Ab===e.frozenColumnCount()&&(s=n.c9(r,1),a.width+=s.width)):0<=r?a=n.B1(r):0<=i&&(a=n.L1(i)),a&&(r=(s=e.parent)&&s.options.scrollbarAppearance===p.ScrollbarAppearance.mobile,i=n=0,u=e=!1,o.x<=a.x?(n=o.x-a.x,r&&(u=!0)):o.x>=a.x+a.width?(0===(n=o.x-(a.x+a.width))&&(n=50),r&&(u=!0)):r&&o.x===a.x+a.width-1&&(n=50,u=!0),o.y<=a.y?(i=o.y-a.y,r&&(e=!0)):o.y>=a.y+a.height&&(i=o.y-(a.y+a.height),r)&&(e=!0),s&&r&&(e&&(s.Xb.qy(p.ScrollbarState.show),s.ib.$y(!0)),u)&&(s.zb.qy(p.ScrollbarState.show),s.ib.$y(!1)),t.lk().ik(t.f9(n)),t.hk().ik(t.f9(i)))))},i.prototype.l9=function(){this.lk().rk(),this.hk().rk()},i.prototype.gk=function(t){var e,n,i,r,o,o,n,o,i,t,e=this,n=u.h9.prototype,i=e.Mf,r=t.resizeInfo;r.action===I||r.action===B?(o=jt(e,i.d9,e.v9,n.findRow,t.row,r,!0),r.startY=o.y+(r.E6?o.height:0)):(o=jt(e,i.m9,e.g9,n.findCol,t.col,r,!1),r.startX=o.x+(r.j6||r.Gxn?o.width:0)),n=i.parent,o=t.x,i=t.y,!n||(1!==(t=n.options.showResizeTip)||r.action!==P&&r.action!==bt)&&(2!==t||r.action!==I&&r.action!==B)&&3!==t||(i-30<0?i+=15:i-=30,n.Tw(K.j0(e.p9()),o,i)),e.isResizing=!0,e.rb=!0,e.ctrl&&(e.b9=!0)},i.prototype.y9=function(){var t,e,n,i,r,o,r,a,s,u,n,r,u,t=this,e=t.Mf,n=e.sw,i=n.resizeInfo,r=t.fk,o=r.x,r=r.y,a=e.Fi(),s=e.parent,u=i.sheetArea;i&&t.rb&&t.isResizing&&(n.x===o&&n.y===r||(i.action===I||i.action===B?ae(e,i,u,r,t.b9):se(e,i,u,o,t.b9),r=(n=e.Dn).J(),n.FA(a.x,a.y,a.width,a.height),n.jy(r),!s)||(1!==(u=s.options.showResizeTip)||i.action!==P&&i.action!==bt)&&(2!==u||i.action!==I&&i.action!==B)&&3!==u||s.ny(t.w9(i)))},i.prototype.C9=function(){var t,e,n,i,r,o,a,i,s,u,i,s,i,t=this;t.isResizing=!1,e=!(t.rb=!1),i=(n=t.Mf).sw,(r=i.resizeInfo)&&(t.iy(),r.action===I||r.action===B?b(r.movingY)?e=!1:(o=T(0,Lt(r,!0)/n.zoom()),a=[],i="resizeRow",n.S9(r.index)?d.GC$.each(n.Ut.getSelections(),function(t,e){var e;-1===e.col&&(1===r.sheetArea?a.push({firstRow:r.index,lastRow:r.index}):(e=n.JS(e),a.push({firstRow:e.row,lastRow:e.row+Ft(e)-1})))}):a.push({firstRow:r.index,lastRow:r.index}),ee(n,r,a,t.b9)&&(i="splitResizeRow"),s=1===r.sheetArea,n.Qy().execute({cmd:i,sheetName:n.name(),rows:a,size:o,columnHeader:s})):b(r.movingX)?e=!1:(o=T(0,Lt(r)/n.zoom()),u=[],i="resizeColumn",n.T9(r.index)?d.GC$.each(n.Ut.getSelections(),function(t,e){var e;-1===e.row&&(e=n.JS(e),2===r.sheetArea?u.push({firstCol:r.index,lastCol:r.index}):u.push({firstCol:e.col,lastCol:e.col+L(e)-1}))}):u.push({firstCol:r.index,lastCol:r.index}),oe(n,r,u,t.b9)&&(i="splitResizeColumn"),s=2===r.sheetArea,n.Qy().execute({cmd:i,sheetName:n.name(),columns:u,size:o,rowHeader:s})),(i=n.hitTest(t.fk.x,t.fk.y))&&t.cw(i),e||n.repaint(),t.b9=!1)},i.prototype.A9=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,d,c,n=0,i=0,r=0,o=0,a=this,s=a.Mf,u=s.H3,c=Pt(s),f=Rt(s),h=_(t),d=1===h&&s.NMi&&s.NMi.options.isDesignMode&&t.row<s.Ut.getFreeAreaRowCount(h);if(a.I9=a.x9=s.Ut.getSelections(h),s.isCtrlPressed(h)||a.shift||(d?s.IA(h):s.IA()),0===h)!a.shift&&(l=Dt(a,v=c?s.N9():s.Tb,p=f?s.k9():s.Ab,1,1,e))||(s.isCtrlPressed(h)||s.IA(),a.wse(s)?(s.IA(),s.D9(0,0,1,1,!0)):s.D9(-1,-1,E(s),H(s),!0));else if(1===h)d?(S=s.Ut.getSpan(t.row,t.col,1),s.Ut._9(S.row,S.col,S.rowCount,S.colCount),s.D9(S.row,S.col,S.rowCount,S.colCount,!0,1),a.E9=!0):!a.shift&&(v=c?s.N9():s.Tb,g=a.j9(v,t.col,!1),l=Dt(a,g.row,g.col,1,F(t),e))||(a.shift||s.O9?(n=x(s.ci,t.col),o=G(s.ci-t.col)+1,s.kA(-1,n,E(s),o,!0)):s.D9(-1,s.ci,E(s),1,!0));else if(2===h){if(!a.shift){if(d=f?s.k9():s.Ab,g=a.j9(t.row,d,!0),m=s.ui!==g.row,l=Dt(a,g.row,g.col,U(t),1,e))return;m&&u&&u.RA()}a.shift||s.O9?(i=x(s.ui,t.row),r=G(s.ui-t.row)+1,s.kA(i,-1,r,H(s),!0)):s.D9(s.ui,-1,1,H(s),!0)}else if(3===h)if(k(t.row)||k(t.col))R(s)&&(c=s.getCellRect(s.ui,s.ci,s.R9,s.B9),s.Dn._6(c.x,c.y,c.width,c.height));else{if(!a.shift&&(s.ui!==t.row||s.ci!==t.col)){if(m=s.ui!==t.row,l=Dt(a,t.row,t.col,U(t),F(t),e))return;m&&u&&u.RA()}a.shift?s.L9(t.row,t.col,!0):(S=s.Ut.getSpan(t.row,t.col),s.O9||s.D9(S.row,S.col,Ft(S),L(S),!0))}},i.prototype.wse=function(t){for(var e,n,i,r,o,a,e,n=0,i=t.getSelections();n<i.length;n++)if(r=i[n],o=E(t),a=H(t),-1===r.row&&-1===r.col&&r.colCount===a&&r.rowCount===o)return!0;return!1},i.prototype.F9=function(t){var e;!t||3===_(t)&&(k(t.row)||k(t.col))||((e=this).rb=!0,e.ob=!0,e.Rk={e9:U(t),r9:F(t),Bk:_(t)},e.Ok())},i.prototype.P9=function(t,e){var n,i,r,o,t,e,a,s,i,u,n,i=this.Mf,o=i.getSpan(t,e),t=t,e=e,a=1,s=1,i=i.selectionUnit(),u=!1;return 1===i?(s=e=-1,t=o?o.row:t,a=o?o.rowCount:a):2===i?(a=t=-1,e=o?o.col:e,s=o?o.colCount:s):u=!0,r=o&&u?o:new w.Range(t,e,a,s)},i.prototype._k=function(t,e){var n=this,i=n.Mf,r=t.row,o=t.col;i.O9=n.G9(r,o,e,_(t))&&i.parent.options.allowUserDeselect,i.O9&&(i.U9=i.ui,i.H9=i.ci,i.z9=n.P9(r,o)),n.A9(t),n.F9(t)},i.prototype.G9=function(t,e,n,i){var r,o,a,r=this,o=r.Mf,a;return r.V9(t,e,n,i)&&2===o.selectionPolicy()},i.prototype.V9=function(t,e,n,i){var r,o,a,s,u,c,r=this.Mf,o=r.getRowCount(),a=r.getColumnCount();if(!r.isCtrlPressed(i))return!1;for(s=!1,u=n.length,c=0;c<u;c++)if(3===i){if(n[c].contains(t,e,1,1)){s=!0;break}}else if(2===i){if(n[c].contains(t,-1,1,a)||n[c].contains(t,0,1,a)){s=!0;break}}else if(1===i&&(n[c].contains(-1,e,o,1)||n[c].contains(0,e,o,1))){s=!0;break}return s},i.prototype.Gk=function(){var t,e,t=this;t.Rk&&t.rb&&!0!==t.FI&&(3===(e=t.Rk.Bk)?t.Y9():2===e?t.Z9():1===e&&t.W9())},i.prototype.Y9=function(){var t,e,n,i,t,r,o,o,t=this,e=t.Mf,n=t.Q9(),i=t.K9();0<=n&&0<=i&&e.JA(n,i)&&(t.a9(),t=e.Ut.getSelections(),r=e.xA(n,i,e.ui,e.ci),1===t.length&&(o=t[0],!e.O9)&&r.equals(o)||(e.L9(n,i,!0),o=e.Ut.getSelections(),e.O9?e.ki(w.Events.InternalSelectionChanging,{sheet:this,sheetName:e.name(),oldSelections:t,newSelections:r}):e.EA(t,o)))},i.prototype.Z9=function(){var t,e,n,i,n,r,o,a,s,u,i,n,t=this,e=t.Mf,n=t.Q9(!0);if(0<=n&&e.JA(n,-1)){if(i=x(e.ui,n),n=T(e.ui,n)-i+1,r=-1,o=H(e),0===(a=e.selectionPolicy()))return;2===(s=e.selectionUnit())&&(n=i=-1),u=e.Ut.getSelections(),e.kA(i,-1,n,o,!0),i=e.Ut.getSelections(),e.EA(u,i)}n=t.fk.x,t.fk.x=e.sw.x,t.a9(),t.fk.x=n},i.prototype.W9=function(){var t,e,n,i,r,n,i,n,i,o,r,a,s,u,n,r,t=this,e=t.Mf,n=t.Rk.Bk,i=t.Q9(!0,n),r=t.K9(!0,n);if(t.E9&&i<e.Ut.getFreeAreaRowCount(n))n=e.Ut.J9(),i=e.xA(i,r,n.row,n.col,C,1),e.D9(i.row,i.col,i.rowCount,i.colCount,!0,1);else if(t.E9=!1,0<=r&&e.JA(-1,r)){if(n=x(e.ci,r),i=T(e.ci,r)-n+1,o=-1,r=E(e),0===(a=e.selectionPolicy()))return;1===(s=e.selectionUnit())&&(i=n=-1),u=e.Ut.getSelections(),e.kA(-1,n,r,i,!0),n=e.Ut.getSelections(),e.EA(u,n)}r=t.fk.y,t.fk.y=e.sw.y,t.a9(),t.fk.y=r},i.prototype.X9=function(){var t,e,n,n,i,t=this;t.Rk=M,t.l9(),t.FI=M,t.rb=!1,t.ob=!1,t.q9=t.E9,t.E9=!1,0!==(e=t.Mf).Ut.getSelections().length&&(e.O9&&(e.O9=!1,n=e.z9,e.z9=null,e.tD(e.Ut.getSelections(),n),delete e.U9,delete e.H9),e.Nk?delete e.Nk:((n=!t.x9)||(i=e.Ut.getSelections(),n=t._A(t.x9,i)),n&&e.jA(t.I9,t.shift)),t.x9=e.Ut.getSelections())},i.prototype.nD=function(){var t,e,n,i,t=this.Mf,e=Vt(t,this.fk.y),n=this.Rk.e9,i=t._y(1);return e=0===e&&0<n&&0<i.length&&i[0].row>t.pw()||2===e&&n<2&&0<i.length&&i[i.length-1].row<t.P6()?1:e},i.prototype.eD=function(){var t,e,n,i,t=this.Mf,e=Yt(t,this.fk.x),n=this.Rk.r9,i=t.Yy(1);return e=0===e&&0<n&&0<i.length&&i[0].col>t.Sw()||2===e&&n<2&&0<i.length&&i[i.length-1].col<t.G6()?1:e},i.prototype.Q9=function(t,e,n){var i,r,o,a,r,e,n,r,a;if(void 0===e&&(e=p.SheetArea.viewport),r=(i=this.Mf).Ut,o=this.fk.y,e===p.SheetArea.colHeader){if(a=zt(i,o))return r=r.getFreeAreaRowCount(e),n&&0<r&&a.row>=r?r-1:a.row}else if(a=Kt(i,e=this.nD(),o)){if(n=i.Fi(),r=a.row,1===e&&o<n.Cy){if((a=i.pw())<r)return i.j5(r-1)||r;if(r===a&&t)return 0}else if(0===e&&o<n.T6&&t)return 0;return 1===e&&o>n.Ay&&r>i.getLastFullyVisibleRow()?i.nI(r)||r:r}return-1},i.prototype.K9=function(t,e,n){var i,r,o,a,s,r,e,n,r,s;if(void 0===e&&(e=p.SheetArea.viewport),r=(i=this.Mf).Ut,o=i.options.rightToLeft,a=this.fk.x,e===p.SheetArea.rowHeader){if(s=Jt(i,a))return r=r.getFreeAreaColumnCount(e),n&&0<r&&s.col>=r?r-1:s.col}else if(s=Wt(i,e=this.eD(),a)){if(n=i.Fi(),r=s.col,1===e&&a<n.Py){if((s=i.Sw())<r)return i.O5(r-1)||r;if(r===s&&t)return 0}else if(0===e&&(o?a>n.BA:a<n.b6)&&t)return 0;return 1===e&&a>n.Hy&&r>i.getLastFullyVisibleColumn()?i.r6(r)||r:r}return-1},i.prototype.f9=function(t){var e,n,e=0;return k(t)||0===t||(n=t<0,e=it(500/G(t)),200<(e=T(20,10*e))&&(e=200),n&&(e=-e)),e},i.prototype.v9=function(t,e){var n,e=this.Mf.nI(t,e);return e!==M?e:t},i.prototype.g9=function(t,e){var n,e=this.Mf.r6(t,e);return e!==M?e:t},i.prototype.oD=function(t,e,n){for(var i=this.Mf;e<t;)if(i.getRowVisible(--t,n))return t;return t},i.prototype.aD=function(t,e,n){for(var i=this.Mf;e<t;)if(i.getColumnVisible(--t,n))return t;return t},i.prototype.uD=function(t,e,n){for(var i=this.Mf;t<e;)if(i.getColumnVisible(++t,n))return t;return t},i.prototype.sD=function(t,e,n){for(var i=this.Mf;t<e;)if(i.getRowVisible(++t,n))return t;return t},i.prototype.cD=function(t,e,n,i,r){var o,a,s,u,c,f,s,u,l,h,d,v,d,g,g,m,m,d,g,c,m,p,S,o=M;if(Zt(t)){if(a=this,s=t.options.reversalTrailingResizeOrder,u=t.Ny,c=2===U(e),s=s&&(f=c&&u),u=c&&!u||s,!(l=t._y(U(e),i))||k(e.row)||k(e.col)){if(k(e.row)&&1===U(e))for(p=3,S=0;S<3&&(o=a.fD(t,S,n,i,r))===M;S++);}else t.getRowVisible(e.row,i)||(e.row=this.v9(e.row,i)),(h=l.findRow(e.row))&&(v=(d=Gt(h.height,n))[0],d=d[1],g=!(s&&l[l.length-1].row===h.row),h.y+h.height-d<=r&&r<=h.y+h.height+d&&g?(o=D(I,e.row,i),0<=(g=l[l.length-1].row)&&(m=t.P6(i),o.index===m)&&o.index!==g&&h.y+h.height-d/2<=r&&(o=D(a.lD(t,g,i),g,i)),c&&At(o.index,t,i)&&(o.R6=!0),s&&(m=a.sD(o.index,l[l.length-1].row,i),(o=D(a.lD(t,m,i),m,i)).E6=s)):h.y-v<=r&&r<h.y+v&&(0<y.Common.Uf.hD(l,h)||u)&&(d=a.oD(e.row,0,i),o=D(a.lD(t,d,i),d,i),s)&&(o=D(I,e.row,i),(o=0<=(g=l[0].row)&&(c=t.j5(g-1,i,!0),o.index===c)&&o.index!==g&&r<h.y+v/2?D(a.lD(t,g,i),g,i):o).E6=s)),!o&&1===U(e)&&0<l.length&&(h=l[0],T(0,h.y-n)<=r)&&r<=h.y+n&&0<=(m=ue(t,e.row,!0))&&(o=D(a.lD(t,m,i),m,i));o&&!t.getRowResizable(o.index,i)&&(o=M)}return o},i.prototype.fD=function(t,e,n,i,r){var o=this,a=M,s=2===e,e=t._y(e,i),e=e[s?0:e.length-1],u,e;return b(e)||0!==e.height||(u=s?e.y:e.y+e.height,e=e.row,T(0,u-n)<=r&&r<=u+n&&(a=D(o.lD(t,e,i),e,i),s)&&(a.E6=!0)),a},i.prototype.lD=function(t,e,n){var i=t.parent;return i&&1===i.options.resizeZeroIndicator&&t.getRowVisible(e)&&0===t._o(e,n)?B:I},i.prototype.dD=function(t,e,n,i,r){var o,a,s,u,c,f,s,u,l,h,d,v,g,v,m,p,S,w,p,S,S,m,v,p,b,C,o=M;if(Qt(t)){if(a=this,s=t.options.reversalTrailingResizeOrder,u=t.Vy,c=2===F(e),s=s&&(f=c&&u),u=c&&!u||s,l=t.options.rightToLeft,!(h=t.Yy(F(e),i))||k(e.col)||k(e.row)){if(k(e.col)&&1===F(e))for(b=3,C=0;C<3&&(o=a.vD(t,C,n,i,r))===M;C++);}else t.getColumnVisible(e.col,i)||(e.col=this.g9(e.col,i)),(d=h.findCol(e.col))&&(g=(v=Gt(d.width,n))[0],v=v[1],m=t.getColumnWidth(e.col,i),p=t.zoom(),S=!(s&&h[h.length-1].col===d.col),d.x+(m*=p)-v<=r&&r<=d.x+m+v&&S&&(!l||0!==y.Common.Uf.hD(h,d))?(w=l?a.aD(e.col,0,i):e.col,o=D(P,w,i),0<=(p=h[h.length-1].col)&&(S=t.G6(i),o.index===S)&&o.index!==p&&d.x+m-v/2<=r&&(o=D(a.mD(t,p,i),p,i)),c&&_t(o.index,t,i)&&(o.B6=!0),s&&(S=a.uD(o.index,h[h.length-1].col,i),(o=D(a.mD(t,S,i),S,i)).j6=s)):d.x-g<=r&&r<d.x+g&&(0<y.Common.Uf.hD(h,d)||l&&0===y.Common.Uf.hD(h,d)||u)&&(w=l?e.col:a.aD(e.col,0,i),o=D(a.mD(t,w,i),w,i),s)&&(o=D(P,e.col,i),(o=0<=(m=h[0].col)&&(v=t.O5(m-1,i,!0),o.index===v)&&o.index!==m&&r<d.x+g/2?D(a.mD(t,m,i),m,i):o).j6=s)),!o&&1===F(e)&&0<h.length&&(d=h[0],T(0,d.x-n)<=r)&&r<=d.x+n&&0<=(p=l?e.col:ue(t,e.col,!1))&&(o=D(a.mD(t,p,i),p,i));(o=(o=o&&t.gD&&t.pD(e,o.index)?M:o)&&!t.getColumnResizable(o.index,i)?M:o)&&l&&(o.Gxn=!0)}return o},i.prototype.vD=function(t,e,n,i,r){var o=this,a=M,s=2===e,e=t.Yy(e,i),e=e[s?0:e.length-1],u,e;return b(e)||0!==e.width||(u=s?e.x:e.x+e.width,e=e.col,T(0,u-n)<=r&&r<=u+n&&(a=D(o.mD(t,e,i),e,i),s&&(a.j6=!0),t.options.rightToLeft)&&(a.Gxn=!0)),a},i.prototype.mD=function(t,e,n){var i=t.parent;return i&&1===i.options.resizeZeroIndicator&&t.getColumnVisible(e)&&0===t.Do(e,n)?bt:P},i.prototype.bD=function(t,e,n,i){var r,o,a,s,u,s,c,f,l,a,h,h,h,t,r=this,o=r.Mf,a=o.parent,s=o.options,u=s.colHeaderVisible,s=s.rowHeaderVisible,c=M;return a&&!a.options.allowUserResize||(a=o.Fi(),U(t)<0&&0<=F(t)&&u&&t.row>=o.getFreeAreaRowCount(p.SheetArea.colHeader)?c=(c=r.dD(o,t,i,1,e))||r.cD(o,t,i,1,n):0<=U(t)&&F(t)<0&&s&&t.col>=o.getFreeAreaRowCount(p.SheetArea.rowHeader)?c=(c=r.cD(o,t,i,2,n))||r.dD(o,t,i,2,e):U(t)<0&&F(t)<0?o.P6(2)===M&&G(n-a.qC)<=i?(h=o._y(1))&&0<h.length&&0<=(f=h[h.length-1].row)&&o.getRowResizable(f,2)&&(c=D(r.lD(o,f,2),f,2)):o.G6(1)===M&&G(e-a.XC)<=i&&(h=o.Yy(1))&&0<h.length&&0<=(l=h[h.length-1].col)&&o.getColumnResizable(l,1)&&(c=D(r.mD(o,l,1),l,1)):0<=U(t)&&0<=F(t)&&(f=E(o,1)-1,l=H(o,2)-1,h=o.options.sheetAreaOffset.top,t=o.options.sheetAreaOffset.left,0<=f&&0===a.qC&&h<=n&&n<=i+h&&u?c=D(r.lD(o,f,1),f,1):0<=l&&0===a.XC&&t<=e&&e<=i+t&&s&&(c=D(r.mD(o,l,2),l,2)))),c},i.prototype.yD=function(t,e,n,i){var r,o,a,s,e,e,s,e,r=this.Mf,o,a=r.Fi().c9(1,1),s=r.options.rightToLeft;if(1===e)if((e=r.Yy(e))&&0<e.length){if(e=e[e.length-1],!s&&e.x+e.width<=n&&n<a.x+a.width||s&&n<e.x&&n>=a.x)return!0}else if(a.contains(n,i))return!0;if(1===t)if((s=r._y(t))&&0<s.length){if((e=s[s.length-1]).y+e.height<=i&&i<a.y+a.height)return!0}else if(a.contains(n,i))return!0;return!1},i.prototype.pg=function(t){var e=this.uw();this.wD(t,t.pageX-e.left,t.pageY-e.top)},i.prototype.yg=function(){var t,e,n,i,n,n,e,n,t=this.Mf,e=t.sw;e&&(n=e.cellTypeHitInfo)&&(i=he(t,n,e)).Ye(n),this.rb||(t.Nk=C,n={x:-1e4,y:-1e4,rowViewportIndex:M,colViewportIndex:M,row:-1,col:-1,resizeInfo:M,hitTestType:M},this.fw(n),e&&(n=e.row,e=e.col,n=t.getActualStyle(n,e),t.MD&&(clearTimeout(t.MD),delete t.MD),t.Mpe&&(clearTimeout(t.Mpe),delete t.Mpe),t.parent)&&n&&n.showEllipsis&&t.parent.iy())},i.prototype.wD=function(t,e,n){var i,t,e,r,n,o,a,s,u,c,f,l,h,d,v,f,l,g,m,l,i=this;i.fk={e:t,x:e,y:n},t=i.Mf,i.ab&&!w.hi.A1(t)&&w.hi.F1(t),i.ab&&i.rb?i.isResizing?i.y9():i.BTe?i.LTe&&i.LTe():i.Uk?i.Hk&&i.Hk():i.zk?i.Vk&&i.Vk():i.Yk?i.Zk&&i.Zk():i.Wk?i.Qk():i.Kk?i.Jk():i.Xk?i.qk():i.$k?i.t9&&i.t9():i.ob&&i.Gk():(e=t.hitTest(e,n,C,C,!0),i.CD(t,e,i),e&&(0===i.Q6&&e.tableSelectInfo&&i.ab&&i.SD(t,i,e),r=t.parent,n=e.row,o=e.col,a=t.C6(e.rowViewportIndex,e.colViewportIndex),c=e.pivotTableInfo,f=!b(c)&&c.options.showToolTip,l=t.isReportTemplateSheet&&t.showToolTip(),r?(u=t.getActualStyle(n,o,a),h=t.getCellRect(n,o,e.rowViewportIndex,e.colViewportIndex),!f||t.isEditing&&t.isEditing()?!l||t.isEditing&&t.isEditing()?(clearTimeout(t.MD),delete t.MD,f=void 0,e.cellTypeHitInfo&&e.cellTypeHitInfo.addRowColumnButtonHitInfo&&(1===(l=e.cellTypeHitInfo.addRowColumnButtonHitInfo).addRowColumnButtonType?(s=t.options.addColumnButtonOption.tooltip)&&(h=t.Fi().XAe(),u=t.PTe(p.SheetArea.colHeader),a=p.SheetArea.colHeader,f=!0):2===l.addRowColumnButtonType&&(s=t.options.addRowButtonOption.tooltip)&&(h=t.Fi().qAe(),u=t.PTe(p.SheetArea.rowHeader),a=p.SheetArea.rowHeader,f=!0)),(s=f?s:t.Ci(n,o,a))&&!1!==u._showTip&&a?r.Tw(K.j0(s),h.x+h.width+5,h.y+h.height+5,!1):(g=r.options.showScrollTip&&(r.Xb.a4||r.zb.a4||r.Xw.a4))||r.iy()):(s=t.getCellTipContent(n,o),v="gc-spread-template-sheet-toolTip",clearTimeout(t.Mpe),delete t.Mpe,r.iy(),s&&!1!==u._showTip&&(t.Mpe=setTimeout(function(t,e){r.Tw(s,t,e+15,!1,v)}.bind(void 0,e.x,e.y),300))):(s=c.sJt(n,o),d="gc-spread-pivot-toolTip",clearTimeout(t.MD),delete t.MD,r.iy(),s&&!1!==u._showTip&&(t.MD=setTimeout(function(t,e){r.Tw(s,t,e+15,!1,d)}.bind(void 0,e.x,e.y),700)))):(clearTimeout(t.MD),delete t.MD),i.cw(e),m=i.fw(e))&&r&&r.options.enableAccessibility&&(l=t.t2(e),r.n2(l)))},i.prototype.CD=function(t,e,n){var i,r,o,a,o;1===n.Q6?(i=n.TD.row,r=n.TD.col,o=e.col,a=t.getSelections()[0],t.kA(i,o<r?o:r,a.rowCount,0<r-o?r-o+1:o-r+1,!0)):2===n.Q6&&(i=n.TD.row,r=n.TD.col,o=e.row,a=t.getSelections()[0],t.kA(o<i?o:i,r,0<i-o?i-o+1:o-i+1,a.colCount,!0))},i.prototype.SD=function(t,e,n){var i,t,i,i=t.getActiveRowIndex(),t=t.getActiveColumnIndex();e.TD={row:i,col:t},"tableColSelect"===(i=n.tableSelectInfo.action)?e.Q6=1:"tableRowSelect"===i&&(e.Q6=2)},i.prototype.cw=function(t){var e,n,i,r,o,a,s,r,s,u,c,f,l,h,d,v,d,r,v,s,e=this,n=e.Mf,i=n.Dg();i&&(a=!(r=n.sw)||t.row!==r.row||t.col!==r.col||_(t)!==_(r)||t.resizeInfo&&!r.resizeInfo||!t.resizeInfo&&r.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==r.resizeInfo.action||t.dragInfo&&!r.dragInfo||!t.dragInfo&&r.dragInfo||t.dragInfo&&t.dragInfo.action!==r.dragInfo.action||t.resizeTableHitInfo&&!r.resizeTableHitInfo||t.dragHeaderToMoveInfo&&!r.dragHeaderToMoveInfo||!t.dragHeaderToMoveInfo&&r.dragHeaderToMoveInfo||!t.cellTypeHitInfo&&r.cellTypeHitInfo,r&&a&&(s=r.cellTypeHitInfo)&&(o=he(n,s,r)).Ye(s),r=t.resizeInfo,s=t.dragMergeInfo,u=t.dragInfo,c=t.formulaRangeHitInfo,f=t.cellTypeHitInfo,l=n.Dn,h=t.resizeTableHitInfo,d=t.tableSelectInfo,v=t.dragHeaderToMoveInfo,d?"tableRowSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTURRVFpSbFpBQUFBUzBsRVFWUUkxMlhOc1ExQVVBQkYwZU9qVWxFYXdTNFM0Mmh0d0JCS0kyQXVJcUhReUhmcW0vZDQKNVZxbGo5eGlWSkRwSlFnYW5jdVF1RC9kYVE0aXFjTm10YXRWSnYxdlZIejdBRU5GRE9OV3daY3lBQUFBSlhSRldIUmtZWFJsT21OeQpaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalE0T2pVeUt6QXdPakF3VkVsRUpBQUFBQ1YwUlZoMFpHRjBaVHB0YjJScFpua0FNakF5Ck1pMHdNeTB5T1ZRd05qbzBPRG8xTWlzd01Eb3dNQ1VVL0pnQUFBQUFTVVZPUks1Q1lJST0iIC8+Cjwvc3ZnPgo=) 8 4,auto":"tableColSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTlRobnBLRTNBQUFBVGtsRVFWUUkxMlhJTVFwQVVBQUEwUGQ5UlprZHdlNFFWanVUZ3pBN25LTllETCtVb3V5ODhRR1QKMjIyQ0hBUVJBVElmdjRocXZVNkxRMm5QSkkwQmpCb0pDb3ZUYVZZUThkaFVOcXVMRjkwZUQzQ2dxdzV5QUFBQUpYUkZXSFJrWVhSbApPbU55WldGMFpRQXlNREl5TFRBekxUSTVWREEyT2pVek9qVTJLekF3T2pBd21XaEVBQUFBQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBCk1qQXlNaTB3TXkweU9WUXdOam8xTXpvMU5pc3dNRG93TU9nMS9Md0FBQUFBU1VWT1JLNUNZSUk9IiAvPgo8L3N2Zz4K) 8 4,auto":"tableCornerSelect"===d.action?i.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxMHB4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxMCAxMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAgMTAiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgeD0iMCIgeT0iMCIKICAgIGhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQW9BQUFBS0NBUUFBQUFuT3djMkFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOCkFBQjZKZ0FBZ0lRQUFQb0FBQUNBNkFBQWRUQUFBT3BnQUFBNm1BQUFGM0NjdWxFOEFBQUFBbUpMUjBRQS80ZVB6TDhBQUFBSGRFbE4KUlFmbUF4MEdOd1BrbVNxUkFBQUFZRWxFUVZRSTExM01zUTJETUJRRTBDZTZVRUxDQnBHeUhOUFEyeVVNeFFRWkFjVXhCV0FCZDkzVAovMGVsTitsYzB2djZDNW96anBJc2lZVnJYc0tGbndab3hKMkR0eWh0RHdjdlpvdDhMTGVDbjd5MzVHTytZeXZlTHg4R3FWQmVBYnlQCk1QNG1OSW4zQUFBQUpYUkZXSFJrWVhSbE9tTnlaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalUxT2pBekt6QXdPakF3anE0VmhBQUEKQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBTWpBeU1pMHdNeTB5T1ZRd05qbzFOVG93TXlzd01Eb3dNUC96clRnQUFBQUFTVVZPUks1QwpZSUk9IiAvPgo8L3N2Zz4K) 10 5,auto":"tableSelect"===d.action?i.style.cursor="move":"default"===d.action&&(i.style.cursor=""):r?r.action===P?i.style.cursor=w.CursorResource.ResizeCol:r.action===I?i.style.cursor=w.CursorResource.ResizeRow:r.action===bt?i.style.cursor=w.CursorResource.ResizeHiddenCol:r.action===B?i.style.cursor=w.CursorResource.ResizeHiddenRow:i.style.cursor=Ct:v?i.style.cursor=e.BTe?w.CursorResource.DragHeaderGrabbing:w.CursorResource.DragHeaderGrab:s?s.left||s.right?i.style.cursor="w-resize":(s.top||s.bottom)&&(i.style.cursor="n-resize"):u&&"drag"===u.action?u.side===wt?i.style.cursor="crosshair":u.side?i.style.cursor="move":i.style.cursor=Ct:c?(c.inBorder?i.style.cursor="move":c.inTopLeft?i.style.cursor="nw-resize":c.inTopRight?i.style.cursor="ne-resize":c.inBottomLeft?i.style.cursor="sw-resize":c.inBottomRight&&(i.style.cursor="se-resize"),d=e.isFormulaRangeHovering,v=(r=e.AD)&&r.paramRange,s=c.paramRange,e.isFormulaRangeHovering=!0,e.AD={paramRange:s},d&&s.index===v.index||l.kde()):h?i.style.cursor=n.options.rightToLeft?"sw-resize":"se-resize":(f&&(o=he(n,f,t),a&&o.processMouseEnter(f),o.ze(f)),!a&&f&&f.isReservedLocation||(i.style.cursor=Ct),e.isFormulaRangeHovering&&(e.isFormulaRangeHovering=!1,e.AD=M,l.kde())))},i.prototype.bg=function(t){var e,n,e=this,n=e.Mf;return e.u2(),!n.vk||(n.vk=!1,e.xD(t),!1)},i.prototype.xD=function(t){var e,n,i,i,r,o,a,e=this,n=e.Mf,i=w.hi.ai();e.ab=!1,e.Q6=0,i&&i!==n&&i.endEdit&&(i.il&&i.il.rl||(i.endEdit(),i.repaint())),w.hi.F1(n),e.isResizing?e.C9():e.BTe?e.GTe&&e.GTe():e.Uk?e.ND&&e.ND():e.zk?e.kD&&e.kD(t):e.Yk?e.DD&&e.DD():e.Wk?e._D():e.Kk?e.ED():e.Xk?e.jD():e.$k?e.OD&&e.OD():n.sw&&(r=(i=n.sw).cellTypeHitInfo,!i.filterButtonHitInfo&&!i.resizeInfo&&0<=i.row&&0<=i.col?(r&&(o=n.getCellType(r.row,r.col,_(i)),r.sheet||(r.sheet=n),o.Ve(r)),r&&r.isReservedLocation||n.ki(w.Events.CellClick,j(n,n.name(),i.row,i.col,_(i))),e.X9(),n.RD&&n.BD&&n.BD()):i.cellTypeHitInfo&&i.cellTypeHitInfo.addRowColumnButtonHitInfo&&(a=he(n,r,i)).Ve(r)),e.LD=!1,e.yk(t)},i.prototype.FD=function(t,e,n){var i,r,i=this.Mf;!i.isEditing||i!==w.hi.ai()||(r=i.Dg(),A(t))||h(t)||i.m6(r,e,n)},i.prototype.pf=function(t){var e,n,i,r,o,a,i,r,o,s,i,u,a,e=this,n=e.Mf;if(n){if(i=Nt(n),r=Et(n),o=n.getCellType(i,r),a={isEditing:R(n),sheet:n,row:i,col:r,sheetArea:3},i={sheet:n,row:i,col:r,sheetArea:3},o&&o.isReservedKey(t,a))return void(R(n)||o.processKeyDown(t,i));if(r={e:t,r:M,c:a},S.Worksheet.et(n,"preProcessKeyDown",r),r.r)return}o=!(R(n)||h(t)||Ut(t)||34!==l(t)&&33!==l(t)&&37!==l(t)&&39!==l(t)&&9!==l(t)&&13!==l(t)&&38!==l(t)&&40!==l(t)),n.Oi&&(n.Oi=!1,n.Dn.PD()),a=27===(i=l(t)),n.RD&&n.GD&&((u=13===i)||a)?n.GD(a):s=o?e.UD?e.HD:e.HD=e.zD(t):e.zD(t),o&&s&&w.hi.A1(n)&&(e.VD=new Date,e.UD?(e.YD<25&&e.YD++,V(t)):(e.UD=!0,e.YD=1,e.ZD(t,!0)))},i.prototype.p9=function(){var t,e,n,i,i,t=this.Mf,e,n=t.sw.resizeInfo;return n.action===I||n.action===B?(i=t.getRowHeight(n.index),f(Mt().Tip_Height,[i])):(i=t.getColumnWidth(n.index),f(Mt().Tip_Width,[i]))},i.prototype.w9=function(t){var e,t,e=this.Mf;return t.action===I||t.action===B?f(Mt().Tip_Height,[T(0,s((t.movingY-t.startY)/e.zoom()))]):(t=T(0,s((t.Gxn?t.startX-t.movingX:t.movingX-t.startX)/e.zoom())),f(Mt().Tip_Width,[t]))},i.prototype.ZD=function(t,e){var n=this;n.UD&&(new Date-n.VD>(1<n.YD?100:600)?n.V5():(e||(n.HD=n.zD(t)),n.UD&&(n.K6=v.setTimeout(function(){n.ZD(t)},e?500:20))))},i.prototype.WD=function(t,e){var n,i,r,o,i,n=this.Mf,i=n.Dg();if(i){n.Ai=!0;try{r=R(n),n.f6&&n.f6(i,n.ui,n.ci,M,M,!0,M,e,t),!r&&R(n)&&(!(o=n.getCellType(n.ui,n.ci)).j3||32!==l(t)||h(t)||A(t)||Ht(t)||o.j3(n,n.ui,n.ci,3),o.QD)&&o.QD(t)}finally{n.Ai=!1,(i=n.ST()).TT&&delete i.TT}}},i.prototype.zD=function(t){var e,n,i,i,r,r,o,a,s,u,i,r,c,i,f,e=this,n=e.Mf;if(e.yk(t),R(n)||27!==l(t)||Ht(t)||h(t)||A(t)||!n.KD||((0,d.GC$)(n.KD).remove(),n.KD=M),i=n.ST(),R(n)||27!==l(t)||Ht(t)||h(t)||A(t)||!i.TT||delete i.TT,R(n)||34!==l(t)&&33!==l(t)&&35!==l(t)&&36!==l(t)&&38!==l(t)&&40!==l(t)||V(t),R(n)||37!==l(t)&&39!==l(t)||V(t),R(n)&&h(t)&&(89===l(t)||90===l(t)))V(t);else{if(i=n.Qy(),r=l(t),r=i.getShortcutKey(r,h(t),A(t),Ht(t),Ut(t)),o=i.getCommands(r))for(a=0;a<o.length;a++)if(s={sheetName:n.name(),vge:!0},(u=o[a].execute(n.parent,s))||s.JD)return u.ignoreCancelDefault||V(t),!0;if(i={e:t,r:M},S.Worksheet.et(n,"processKeyDown",i),i.r)return!0;e.Pi(t)&&((r=n.il)&&r.XD&&r.qD(),(c=R(n))||(f=(i=v.gcGlobal.el(t.target))&&"gcAttachedFormulaTextBox"===i.getAttribute(St))||e.WD(t))}return!1},i.prototype.V5=function(){var t=this;t.UD=!1,t.HD=C,(t.YD=0)<t.K6&&(clearTimeout(t.K6),t.K6=0)},i.prototype.bf=function(t){var e,n,i,r,o,a,i,r,a,o,e=this;if(e.V5(),n=e.Mf){if(i=Nt(n),r=Et(n),o=n.getCellType(i,r),a={isEditing:R(n),sheet:n,row:i,col:r,sheetArea:3},i={sheet:n,row:i,col:r,sheetArea:3},o&&o.isReservedKey(t,a))return void(R(n)||o.processKeyUp(t,i));if((r=n.il)&&r.$D(t))return;if((a=n.parent&&n.parent.h6)&&a.$D(t))return;n.parent&&n.parent.options.enableAccessibility&&w.mt.Qf()&&(34!==(o=l(t))&&33!==o&&35!==o&&36!==o&&37!==o&&39!==o&&9!==o&&13!==o&&38!==o&&40!==o||n.parent.n2(C))}e.yk(t)},i.prototype.yf=function(t){var e,n,i,e,n=this.Mf,i={e:t,r:M};S.Worksheet.et(n,"processCompositionStart",i),i.r||this.WD(t,!0)},i.prototype.Pi=function(t){return!(h(t)||Ht(t)||Ut(t))&&(65<=l(t)&&l(t)<=90||48<=l(t)&&l(t)<=59||96<=l(t)&&l(t)<=105||186<=l(t)&&l(t)<=192||220<=l(t)&&l(t)<=222||219===l(t)||106<=l(t)&&l(t)<=111||32===l(t)||61===l(t)||173===l(t)||229===l(t)||0===l(t)||8===l(t))},i.prototype.yk=function(t){var e,n,i,r,o,e=this,n=e.Mf,i,r=(w.mt.Qf()?Ut:h)(t);e.ctrl=r&&!A(t),e.shift=A(t)&&!r,e.isPressShiftKey=A(t),!0===e.zk&&(e.t_=r,o=A(t),e.e_&&(o=!A(t)),e.i_=o,n.Dn.o_)&&n.Dn.o_(),e.a_=r},i.prototype.Y5=function(){var t=this;t.shift=!1,t.ctrl=!1,t.zk=!1,t.i_=!1,t.t_=!1,t.a_=!1},i.prototype.By=function(t){var e,n,i,r,o,a,s,t,u,u,c,f,a,s,n,l,h,l;t&&t.sheet?(e=t.sheet,n=t.editor,i=t.canvasOffset):n=(e=this.Mf).li,R(e)&&(t=p.SheetArea.viewport,(u=e.vA)?(r=u.row,o=u.col,b(u.sheetArea)||(t=u.sheetArea)):(r=e.ui,o=e.ci),t===p.SheetArea.rowHeader?s=-1:t===p.SheetArea.colHeader&&(a=-1),u=e.getCellType(r,o,t),c=e.Fi(),f=e.getActualStyle(r,o,t),a=e.getCellRect(r,o,a,s),n&&n.parentNode&&(s=n.parentNode.parentNode,n=!1,l=e.options.rightToLeft,t===p.SheetArea.rowHeader?n=a.x>=c.x&&a.y>=c.y+c.qC&&a.x+a.width<=c.Py&&a.y+a.height<=c.Ay+c.Iy:t===p.SheetArea.colHeader?n=a.x>=c.x+c.XC&&a.y>=c.y&&a.x+a.width<=c.Hy+c.zy&&a.y+a.height<=c.Cy:t===p.SheetArea.viewport&&(n=l?a.x>=c.x&&a.y>=c.T6&&a.x+a.width<=c.BA&&a.y+a.height<=c.Ay+c.Iy:a.x>=c.b6&&a.y>=c.T6&&a.x+a.width<=c.Hy+c.zy&&a.y+a.height<=c.Ay+c.Iy),a&&0<a.width&&0<a.height&&n?u.Rn(s,f,a,h={sheet:e,row:r,col:o,sheetArea:t,canvasOffset:i}):(0,d.GC$)(s).css({top:-1e4,left:-1e4})),l=e.il)&&l.u_()},i.prototype.s_=function(t,e){var n,i;if(t)for(n=t.firstChild;n;){if(n.id===e||n.name===e)return n;if(i=this.s_(n,e))return i;n=n.nextSibling}return M},i.prototype._A=function(t,e){var n,i,r,o,n=!0;if(t.length===e.length)for(i=0;i<t.length;i++){if(r=t[i],o=e[i],r.row!==o.row||r.col!==o.col||Ft(r)!==Ft(o)||L(r)!==L(o)){n=!0;break}n=!1}return n},i.prototype.f_=function(t,e,n,i){var r,o,a,s,u,c,f,i,i,l,l,t,i,a,r=this,o=r.Mf,a={sheet:o,row:e,col:n,sheetArea:3},s=o.qc(),u=t.isImeAware(a),f=yt?at:"fixed";return i&&!o.isEditing()&&r.l_(),u&&!r.g6&&(i=(c=t.jn(a)).style,r.h_||(r.h_={overflow:gt,border:mt,position:at}),r.h_.overflow=i.overflow,r.h_.border=i.border,r.h_.position=i.position,(0,d.GC$)(c).css([ot,ut,ct,ft,lt,ht,st],[f,vt,"0px","0px","0px","0px",mt]),o.Ri&&c.firstChild&&(i=c.firstChild.firstChild,o.Ri(t,i,e,n,o.getActualStyle(e,n),C,C,C,C,3),l=t.getEditorValue(i,a),g.safari)&&(""===l||b(l))&&t.setEditorValue(i," ",a),s&&s.insertBefore(c,M),r.g6=c),r.d_||(c=Y("div"),(0,d.GC$)(c).css([ot,ut,ct,ft,lt,ht],[f,vt,"0px","0px","0px","0px"]),r.d_=c,l=Y("textarea"),(0,d.GC$)(l).attr(St,"gcSheetFocusInput").attr(pt,-1).css([ot,ut,st,dt],[at,vt,mt,mt]),l.value=" ",c.insertBefore(l,M),r.I1=l,t=Y("div"),(0,d.GC$)(t).css(ot,at).css(ut,vt).attr(St,"gcSheetFocusInput").attr("aria-hidden","true").attr("title","").attr(pt,-1),c.insertBefore(t,M),r.m_=t,s&&s.insertBefore(c,M)),!u&&o.parent&&o.parent.options.enableAccessibility&&(o.parent.Q1e(),o.K1e(r.I1,"",e,n,3)),i=v.location!==v.parent.location,a=0<v.scrollX||0<v.scrollY,(yt||(g.mozilla||g.chrome||g.safari)&&i||a)&&(r.g6&&r.g_(o,r.g6),r.g_(o,r.d_)),u?r.g6:r.I1},i.prototype.ATe=function(t,e,n,i){var r,o,r,r,r=this,o=r.Mf,r=r.g6;o.Ri&&r&&r.firstChild&&(r=r.firstChild.firstChild,o.Ri(t,r,e,n,o.getActualStyle(e,n),i,C,C,C,3))},i.prototype.p6=function(){var t=this;t.g6&&t.h_&&(0,d.GC$)(t.g6).css(ut,t.h_.overflow).css(st,t.h_.border).css(ot,t.h_.position)},i.prototype.l_=function(){var t=this;t.g6&&(t.g6.parentElement&&t.g6.parentElement.removeChild(t.g6),t.g6.comboBox&&(t.g6.comboBox=M),t.g6=M)},i.prototype.Zg=function(t){w.hi.A1(this.Mf)||this.p_(!0,!0,t)},i.prototype.al=function(){var t=this.m_;t&&t.focus()},i.prototype.aA=function(){this.p_(!0,!0)},i.prototype.b_=function(){this.y_&&(clearTimeout(this.y_),this.y_=M)},i.prototype.p_=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,d,t;0===arguments.length&&(t=!0),(i=this).X6||(i.J6=!1,i.b_(),r=i.Mf,o=Nt(r),a=Et(r),s=r.getCellType(o,a),i.f_(s,o,a,e),u={sheet:r,row:o,col:a,sheetArea:3},c=s.isImeAware(u)&&i.g6.firstChild?i.g6.firstChild.firstChild:i.I1,f=c,e&&!g.msie&&s.setImeMode(f,r.getActualStyle(o,a).imeMode,u),O.body.focus(),l=function(){var t=function(){try{s.isImeAware(u)?(s.focus(f,u),r.isEditing()||s.selectAll(f,u)):(c.focus(),r.isEditing()||c.select())}catch(t){}};e&&g.msie&&s.setImeMode(f,r.getActualStyle(o,a).imeMode,u),t()},d=g.metroMode||m.ipad||m.iphone||m.android,!r.Oi&&!d||!t&&s.isImeAware(u)?!1===r._enhanceIme||n||i.w_(r)||l():!R(r)&&d?e&&(t=i.g6&&i.g6.firstChild&&i.g6.firstChild.firstChild,s.setImeMode(t,r.getActualStyle(o,a).imeMode,u)):i.y_=v.setTimeout(function(){i.w_(r)||(i.b_(),R(r))||!1===r._enhanceIme||n||l()},200),w.hi.A1(r)||i.w_(r)||w.hi.F1(r),i.M_(r))||i.PA&&i.PA(r.ui,r.ci)},i.prototype.g_=function(t,e){var t,n,n,i,r,o,n,i,r,o,t,i,a,t,s,u,c,s,i,c,u,n=Nt(t),i=Et(t),r=t.R9,o=t.B9,n=t.getCellRect(n,i,r,o),i=this,r=t.uw(),o=i.it(),t=i.g6,i=0,a=0;t&&(t=(0,d.GC$)(t),i=parseInt(t.css(ht),10),a=parseInt(t.css(lt),10)),t=n.y+o.top-2,n=n.x+o.left-2,s=v.pageYOffset,u=v.pageXOffset,(c="fixed"===e.style.position&&!fe(e))&&(t-=s,n-=u),s=c?0:s-r.top+o.top,i=v.innerHeight+s-i,c=c?0:u-r.left+o.left,u=v.innerWidth+c-a,(k(t)||t<s||i<t)&&(t=s),(k(n)||n<c||u<n)&&(n=c),(0,d.GC$)(e).css(ct,t).css(ft,n)},i.prototype.C_=function(t){var e,n,i,t,n,e=this;e.b_(),R(e.Mf)||e.J6&&O.activeElement===e.m_||(n=e.Mf,t=t?(i=t.row,t.col):(i=n.ui,n.ci),n=n.getCellType(i,t),e.f_(n,i,t,!1),e.m_.focus(),e.J6=!0)},i.prototype.S_=function(t,e){var n=this;n.J6&&(n.J6=!1,e||n.p_(t))},i.prototype.IT=function(t){var e,n,e,n=this.Mf.ST();n&&(n.YS(t),n.ZS(),this.X6=!0,t)&&n.WS()},i.prototype.NT=function(){var t,e,t=this,e=t.Mf.ST();e&&e.YS(""),t.X6=!1,t.p_(!0,!1)},i.prototype.T_=function(){var t,e,t=this;t.b_(),(e=t.g6)&&((0,d.GC$)(e).remove(),t.g6=C),(e=t.d_)&&((0,d.GC$)(e).remove(),t.I1=C,t.d_=M,t.m_=M)},i.prototype.Tw=function(t,e,n,i){var r=this.Mf.parent;r&&r.Tw(K.j0(t),e,n,i)},i.prototype.ny=function(t,e,n,i){var r=this.Mf.parent;r&&r.ny(t,e,n,i)},i.prototype.iy=function(){var t=this.Mf.parent;t&&t.iy()},i.prototype.fw=function(t){var e,n,i,r,o,a,s,u,s,c,i,r,i,u;function f(t,e){var n=!1;return t||e?t&&e&&(n=t.action===e.action&&t.index===e.index&&t.sheetArea===e.sheetArea):n=!0,n}function l(t,e){var n=!b(t.cellTypeHitInfo),t=n&&!b(t.cellTypeHitInfo.addRowColumnButtonHitInfo),i=!b(e.cellTypeHitInfo),r,o,a;return!(i&&!b(e.cellTypeHitInfo.addRowColumnButtonHitInfo)&&!n)&&!(t&&!i)}return i=(n=(e=this).Mf).A_,r=n.I_,a=(a=(a=(o=n.sw)?!1:!0)||t?a:!0)||t.col!==o.col||t.row!==o.row||F(t)!==F(o)||U(t)!==U(o)||_(t)!==_(o)||!f(t.resizeInfo,o.resizeInfo)||!l(t,o),n.sw=t,a&&(u=(s=n._1)&&s.isEnable(p.RowColumnStates.hover,!0),s=s&&s.isEnable(p.RowColumnStates.hover,!1),c=t.hitTestType,o&&!b(o.hitTestType)&&(n.A_=null,n.I_=null,n.Ut.setCellState(i,r,p.CellStatesType.hover,!1,o.hitTestType),u&&n.x_(i,o.rowViewportIndex,o.colViewportIndex),s&&n.N_(r,o.rowViewportIndex,o.colViewportIndex),u||s||n.k_&&n.k_(p.CellStatesType.hover,i,r,o.hitTestType,o.rowViewportIndex,o.colViewportIndex)),t&&!b(c)&&(i=void 0!==t.row&&void 0!==t.col&&c===p.SheetArea.viewport,n.A_=t.row,n.I_=t.col,t.resizeInfo||(n.Ut.setCellState(t.row,t.col,p.CellStatesType.hover,!0,c),u&&i&&n.x_(t.row,t.rowViewportIndex,t.colViewportIndex),s&&i&&n.N_(t.col,t.rowViewportIndex,t.colViewportIndex),u)||s||n.k_&&n.k_(p.CellStatesType.hover,t.row,t.col,c,t.rowViewportIndex,t.colViewportIndex)),n.D_=!0,i=It(n,o,r=n.Dn),u=It(n,t,r),i=i||u,n.D_=!1,(i||n.gD)&&r.E1(),n.NMi)&&n.NMi.options.isDesignMode&&1===c&&r.E1(C,C,C,C,1),a},i.prototype.j9=function(t,e,n){var t=this.__(t,e,n);return this.E_(t)},i.prototype.__=function(t,e,n){var i,r,o,i=this.Mf.Ut.getSpan(t,e),r=Ft(i),o=L(i);return 1===r&&1===o||n&&1===r||!n&&1===o?i:(n?e++:t++,this.__(t,e,n))},i.prototype.E_=function(t){for(var e,n,i,r,o,a,e=this.Mf,n=t.row,r=E(e),i=n;i<r&&!0!==e.getRowVisible(i);i++);for(i<r&&(n=i),o=t.col,a=H(e),i=o;i<a&&!0!==e.getColumnVisible(i);i++);return z(n,o=i<a?i:o,Ft(t),L(t))},i.prototype.M_=function(t){var e,n,i,r,e=t.floatingObjects&&t.floatingObjects.all(),n=t.shapes&&t.shapes.all();if(!b(e))for(i=0;i<e.length;i++)if(e[i].isSelected())return!0;if(!b(n))for(r=0;r<n.length;r++)if(n[r].isSelected())return!0},i.prototype.w_=function(t){return"function"==typeof t.isShapeTextEditorOpened&&t.isShapeTextEditorOpened()},i.prototype.j_=function(t){var r,e,n,o,a,n,e,i,s,s,i,r=this.Mf,e=t.resizeInfo;return e?(n=r.Ut.getSelections(),e.action===I||e.action===B?(o=[],r.S9(e.index)?c(n,function(t,e){var n,i;if(-1===e.col)for(n=r.JS(e),i=0;i<Ft(n);i++)o.push({row:n.row+i})}):o.push({row:e.index}),r.Qy().execute({cmd:"autoFitRow",sheetName:r.name(),rows:o,columnHeader:1===e.sheetArea})):(a=[],r.T9(e.index)?c(n,function(t,e){var n,i;if(-1===e.row)for(n=r.JS(e),i=0;i<L(n);i++)a.push({col:n.col+i})}):a.push({col:e.index}),r.Qy().execute({cmd:"autoFitColumn",sheetName:r.name(),columns:a,rowHeader:2===e.sheetArea})),!0):(t.cellTypeHitInfo&&t.cellTypeHitInfo.addRowColumnButtonHitInfo||(n=t.row,e=t.col,i=t.hitTestType,(s=r.O_(t.rowViewportIndex,t.colViewportIndex,t.hitTestType,t.row,t.col))&&(n=s.row,e=s.col),s=void 0,i=r.getFormula&&r.getFormula(n,e,i,!0),r.f6(r.fg,n,e,t.rowViewportIndex,t.colViewportIndex,!1,s=i?"="+i:s,!1)),!1)},i.prototype.W6=function(t,e){return e&&this.Mf.options.rightToLeft?t<=0:0<t},xt=i,o.nk=xt,S.Worksheet.ch("eventHandler",{beforeSetHost:function(){var t=this;t.rt=new xt(t)},dispose:function(t){var e,n,i,r,r,i,e=this,n=e.rt;n&&(n.u2(),i=n.tk,(0,d.GC$)(e.Dg()).unbind(J+"."+i).unbind(Z+"."+i).unbind(Q+"."+i).unbind(X+"."+i).unbind(tt+"."+i).unbind(et+"."+i),g.mozilla&&(r="onwheel"in document?$:q,(0,d.GC$)(e.Dg()).unbind(r+"."+i)),n.L0(),n.T_()),(r=e.li)&&(0,d.GC$)(r).remove(),(i=e.R_)&&(i.close(),e.R_=null),!1!==t.clearCache&&(e.B_=M,e.L_=M,e.F_=M,e.P_=M,e.G_=M,e.U_=M,e.rt=M)},setHost:function(t){var f,i,e,n;function r(t,e){var n,i,n,r,o,n=f.uw(),i=e.pageX-n.left,n=e.pageY-n.top,r=f.hitTest(i,n),o=r.dragInfo;r.tableSelectInfo||(o&&t.H_&&"corner"===o.side?t.H_():t.FD(e,i,n))}t&&(i=(f=this).rt,f.B_=function(t){var e={e:t,r:M};if(S.Worksheet.et(f,"preProcessMouseDown",e),!e.r)return i.gg(t)},f.L_=function(t){var e={e:t,r:M};S.Worksheet.et(f,"preProcessMouseMove",e),e.r||i.p4||i.pg(t)},f.F_=function(t){var e={e:t,r:M};return S.Worksheet.et(f,"preProcessMouseUp",e),e.r||f.f2||i.p4?void 0:i.bg(t)},f.wge=function(t,e,n){var i,r,o,a,i=(new Date).valueOf(),a=!f.z_||200<i-f.z_;return b(t)||(a?(r=(0<=(r=t/n)?1:-1)*s(G(r)),f.V_=0):(f.V_+=r=t/n,r=(0<=r?1:-1)*s(G(f.V_)),f.V_-=r)),b(e)||(a?(o=(0<=(o=e/n)?1:-1)*s(G(o)),f.Y_=0):(f.Y_+=o=e/n,o=(0<=o?1:-1)*s(G(f.Y_)),f.Y_-=o)),f.z_=i,{detailY:r,detailX:o}},f.P_=function(t){var e,e,n,i,r,o,a,s,u,a,c,n,e={e:t=t||v.event,r:M};if(S.Worksheet.et(f,"preProcessMouseWheel",e),!e.r)return n=(e=f.parent)&&e.options.scrollByPixel,i=t.detail||t.wheelDelta/-40,r=0,"wheel"===t.type?(o=17,a=t.wheelDeltaY&&Math.abs(t.wheelDeltaY- -3*t.deltaY)<1,s=g.mozilla&&88<=+g.version&&!a?17:1,i=t.deltaY/s,r=t.deltaX/s,n||(G(i)>=G(r)?r=0:i=0),a&&(i=(u=f.wge(i,r,1)).detailY,r=u.detailX)):(a=t.wheelDeltaY,c=t.wheelDeltaX,n||(G(a)>=G(c)?c=0:a=0),(g.safari||g.chrome)&&(s=g.safari?-4:-40,i=(u=f.wge(a,c,s)).detailY,r=u.detailX)),(0!==i||0!==r)&&(n=f.parent.ib.Mg(f,t,nt(i,10)||0,nt(r,10)||0),e.iy(),!!n)&&void 0},f.G_=function(t){var e={e:t,r:M};if(S.Worksheet.et(f,"preProcessMouseOut",e),!e.r)return i.yg(t)},f.U_=function(t){var e,n,n,e=f.sw,n={e:t,r:M,target:e};S.Worksheet.et(f,"preProcessMouseDbClick",n),n.r||e&&(n=!1,3===_(e)?r(i,t):n=i.j_(e),n||f.ki(w.Events.CellDoubleClick,j(f,f.name(),e.row,e.col,_(e))))},e=i.tk,t.bind(J+"."+e,function(t){return f.B_(t)}).bind(Z+"."+e,function(t){return f.F_(t)}).bind(Q+"."+e,function(t){return f.L_(t)}).bind(X+"."+e,function(t){return f.P_(t)}).bind(tt+"."+e,function(t){return f.G_(t)}).bind(et+"."+e,function(t){return f.U_(t)}),g.mozilla)&&(n="onwheel"in document?$:q,t.bind(n+"."+e,function(t){return f.P_(t)}))}}),t.Hv.ch("worksheet-event",{preProcessMouseMove:function(t){var e,e,e=this.Vv.getActiveSheet();e&&(e=e.rt)&&e.ab&&e.rb&&e.isResizing&&(e.pg(t.e),t.r=!1)}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,e,s){"use strict";var n,i,r,o,a,l,u,h,c,d,v,g;function f(t,e,n,i,r){var o,e,a,o=e.getRange(n,i);if(e.source&&(t=e.source.Mf),e=o.row,a=o.col,r)if(1===o.rowCount)a=i;else{if(1!==o.colCount)return d;e=n}return m(t,e,a)}function m(t,e,n){var i,r,o,r,t,r;return t&&t.getFormatter?(i=t.getFormatter(e,n))&&"General"!==i?b(i,function(t,e){return a.Be.Re(t,e)}):(r=t.getStyle(e,n),(o=r&&r._autoFormatter)?b(o.formatCached,function(t,e){return o.format(t)}):(t=(r=t.pivotTables)&&r.findPivotTable(e,n))&&(i=(r=t.hqt(e,n))&&r.formatter)?b(i,function(t,e){return a.Be.Re(t,e)}):d):d}function p(t,e){var e=u(t,"E")&&e(1,t);return e&&u(e,"E")}function S(t,e){var e=e(123,t);return u(e,"123")&&0<(e=e.replace(/[1230. ]+/g,"")).length}function w(t,e){var e;if(t=t.replace("DBNum",""),n.Common.$T.qT("[mMdDyYhHseg]").test(t))return e=e(123,t),!u(e,"123")}function b(t,e){var n,i,r,o;if("string"!=typeof t||"="===t[0])return d;if(n={f:t},w(t,e)){if(i=e(44955,t),r=e(44955.11,t),o=e(45323,t),i!==r)return n.t=i===o?6:8,n;if(i!==o)return n.t=7,n}if(u(t,"%"))n.t=0;else if(u(t,"/"))n.t=4;else if(p(t,e))n.t=3;else if(S(t,e))n.t=5;else if(u(t,"0")||u(t,"DBNum",!0))n.t=2;else if(u(t,"GENERAL",!0))n.t=1;else{if(!u(t,"@"))return d;n.t=9}return n}function C(t,e,n,i,r){var n,t,n=n.value;if(n&&2===n.type)return{f:"0.00%",t:0};if(n&&9===n.type)if(0===n.operatorType||1===n.operatorType){if(n.value&&2===n.value.type)return{f:"0.00%",t:0}}else if(2===n.operatorType)return(t=C(t,e,n,i,r))&&0===t.t&&(t.f=t.f.replace("%","00%")),t;return d}function y(t,e,n,i,r){var o,t,o=T(t,e,n.value,i,r),t=T(t,e,n.value2,i,r);if(7===o.t||8===o.t){if(7===t.t||8===t.t)return d;if(6===t.t)return 8===o.t?o:{f:o.f+" "+t.f,t:8}}else if(6===o.t){if(8===t.t)return t;if(7===t.t)return{f:t.f+" "+o.f,t:8}}return 0===o.t&&0===t.t?{f:(t.f.length>o.f.length?t:o).f,t:0}:1!==o.t?o:t}function M(t,e,n,i,r){var o,t,o=T(t,e,n.value,i,r),t=T(t,e,n.value2,i,r);return 9===o.t?o:9===t.t?t:5<=o.t?5<=t.t?d:o:5<=t.t?t:3===o.t?o:3===t.t?t:4===o.t?o:4===t.t?t:2!==o.t&&1!==o.t&&2!==t.t&&1!==t.t&&0===o.t&&0===t.t?{f:(t.f.length>o.f.length?t:o).f,t:0}:d}function k(t,e,n,i,r){var o,a,s,u,c,f,o=n.functionName&&n.functionName.toUpperCase(),a=g[o];if(l(v[o]))return"number"==typeof a?T(t,e,f=n.arguments[a],i,r):a?a(t,e,n,i,r):d;switch(v[o]){case 6:s="H:mm:ss";break;case 7:s=h.Fe().DateTimeFormat.shortDatePattern||"M/d/yyyy";break;case 8:s=h.Fe().DateTimeFormat.defaultDatePattern||"M/d/yyyy H:mm:ss";break;case 0:s="0.00%";break;case 5:u=h.Fe().NumberFormat.currencySymbol||"$",s=(c=h.Fe().predefinedFormats.Currency)&&c[c.length-1]||"".concat(u,"#,##0.00_);[Red](").concat(u,"#,##0.00)")}return{f:s,t:v[o]}}function T(t,e,n,i,r){if(n)if(9===n.type){if(2===n.operatorType)return C(t,e,n,i,r);if(3===n.operatorType||4===n.operatorType)return y(t,e,n,i,r);if(5===n.operatorType||6===n.operatorType||7===n.operatorType)return M(t,e,n,i,r);if(0===n.operatorType||1===n.operatorType)return T(t,e,n.value,i,r)}else{if(1===n.type||13===n.type||22===n.type)return f(t,n,i,r);if(7===n.type)return k(t,e,n,i,r);if(10===n.type)return T(t,e,n.value,i,r)}return d}function x(t,e,n,i,r){var o=t.getFormatter(i,r);(!o||o.toUpperCase&&"GENERAL"===o.toUpperCase())&&(n=t.oMt.Fyt(i,r)||n,G(t,i,r,T(t,e,n,i,r)))}function G(t,e,n,i){var r=t.Z_(e,n)||new o.Style;(i="string"==typeof i?b(i,function(t,e){return a.Be.Re(t,e)}):i)&&1!==i.t?r._autoFormatter=new c(i.f):delete r._autoFormatter,delete r.formatter,t.setStyle(e,n,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.Ffe=e.Fue=e.Pue=void 0,n=s("Common"),i=s("./dist/core/util/domUtil.js"),r=s("./dist/core/worksheet/worksheet.js"),o=s("./dist/core/worksheet/style.js"),a=s("./dist/core/util/common.js"),l=n.Common.lt.ht,u=n.Common.zf.OS,h=n.Common.CultureManager,c=n.Formatter&&n.Formatter.GeneralFormatter,d={t:1},i.GC$.extend(r.Worksheet.prototype,{getFormatter:function(t,e,n){return this.l0(t,e,"formatter",n)},setFormatter:function(t,e,n,i){var r=this.Z_(t,e,i),r;(r=r||new o.Style).formatter=n,this.setStyle(t,e,r,i)}}),r.Worksheet.ch("formatter",{settingText:function(t){var e,e,e=a.util.Kf(t.value);c&&e&&(e={},(new c).getPreferredDisplayFormatter(t.value,e),"number"==typeof e.value)&&(t.value=e.value)}}),v={NOW:8,TODAY:7,TIME:6,DATE:7,IRR:0,XIRR:0,MIRR:0,RATE:0,YIELD:0,INTRATE:0,NPV:5,XNPV:5},(g={SUM:0,MAX:0,MIN:0,AVEDEV:0,FLOOR:0,ROUND:0,ROUNDUP:0,ROUNDDOWN:0,INT:0,TRUNC:0}).SINGLE=g["@"]=function(t,e,n,i,r){var n=n.arguments[0];return!n||1!==n.type&&13!==n.type?d:f(t,n,i,r,!0)},g.INDIRECT=g.OFFSET=g.INDEX=function(i,t,e,r,o){var n,a,n=s("SheetsCalc"),a=d;return n&&(e.Gue=function(t,e,n){a=l(e)?f(i,t,r,o):m(n&&n.Mf||i,t,e)},n.evaluateExpression(i,e,r,o)),a},e.Pue=T,e.Fue=x,e.Ffe=G},"./dist/core/worksheet/worksheet-json.js":function(i,t,e){"use strict";var t,z,W,J,ut,Z,ct,b,ft,r,lt,n,ht,p,e,dt,e,s,y,o,yt,a,Q,X,vt,q,gt,M,$,mt,Mt,l,h,u,d,kt,w,P,R,c,v,Tt,B,N,pt,g,C,k,I,f,xt,Gt,Bt,m,S,It,Pt,Rt,T,rt,tt,et,St,wt,x,G,E,bt,e;function Ct(t,e){return mt(t)?e:mt(e)?t:Math.max(t,e)}function H(t,e,n,i){var t,t;t.dataTable&&(e.dataTable||(e.dataTable={}),t=t.dataTable[n])&&(e.dataTable[n]||(e.dataTable[n]={}),t=t[i])&&(e.dataTable[n][i]||(e.dataTable[n][i]={}),t.formula)&&(e.dataTable[n][i].formula=t.formula)}function ot(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,o=t.Ut,a=o.W_(),s=o.W_(ft.SheetArea.colHeader),u=o.Q_(!0),c=o.Q_(!0,ft.SheetArea.colHeader),f=o.K_(),l=o.K_(ft.SheetArea.colHeader),h=a.getColumnCount();for(!r&&mt(e.colHeaderData)?e.colHeaderData={}:o.ap=n,s.setRowCount(n),d=0;d<n;d++)for(s.setNode(d,-1,a.J_(d,-1)),c.X_(d,u.q_(d)),v=i;v<h;v++)s.setNode(d,v,a.J_(d,v)),r||H(e.data,e.colHeaderData,d,v);(g=f.getSpans((0,ut.Ec)(0,0,n,h))).forEach(function(t){l.add(t)}),t.frozenRowCount(0)}function at(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,o=t.Ut,a=o.W_(),s=o.W_(ft.SheetArea.rowHeader),u=o.Q_(!1),c=o.Q_(!1,ft.SheetArea.rowHeader),f=o.K_(),l=o.K_(ft.SheetArea.rowHeader),h=a.getRowCount();for(!r&&mt(e.rowHeaderData)?e.rowHeaderData={}:o.fp=n,s.setColumnCount(n),d=0;d<n;d++)for(s.setNode(-1,d,a.J_(-1,d)),c.X_(d,u.q_(d)),v=i;v<h;v++)s.setNode(v,d,a.J_(v,d)),r||H(e.data,e.rowHeaderData,v,d);(g=f.getSpans((0,ut.Ec)(0,0,h,n))).forEach(function(t){l.add(t)}),t.frozenColumnCount(0)}function U(t,e){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":case"frozenTopRow":case"frozenLeftCol":return 0===e;case"rowCount":return 200===e;case"columnCount":return 20===e;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===e;case"visible":case"frozenTrailingRowStickToEdge":case"frozenTrailingColumnStickToEdge":return!0===e}}function nt(t,e){return q(t)?t:e}function it(t,e,n,i){q(n)&&e.call(t,n,!!q(i)&&i)}function st(n,i,r,o,a,s){vt&&gt(vt,function(t,e){var e=e.fromJson;e&&e.call(n,i,r,o,!q(a)||a,s)})}function F(t,i){var t=t.Uw&&t.Uw(3).t8.jme(-1,-1,-1,-1);t&&t.forEach(function(t){var e,n;t.isValid||(e=i[t.minX]&&i[t.minX][t.minY])&&(n={row:t.minX,rowCount:t.maxX-t.minX+1,col:t.minY,colCount:t.maxY-t.minY+1,isDynamicArray:!0},t.isValid||(n.isInvalid=!0),e.arrayInfo=n)})}function _(t,e){var e=P(e,xt+"&tabColor");e&&(t.sheetTabColor=v(e))}function A(t,e,n){_t(t,e,n),lt.Util.wo(n,t.parent&&t.parent.v2)&&L(t,n)}function L(t,e){Q&&t.Lp.resumeAdjust(),Ot(t,e)}function D(t,e,n){t.showCell(e,n,ft.VerticalPosition.top,ft.HorizontalPosition.left)}function j(t){var t,e,n,t,t=w(t,Gt);return t&&t.ref&&(t=B(t.ref,!0))&&(e=t.row+t.rowCount,n=t.col+t.colCount),{rowCount:e=mt(e)||e<-1?z.Worksheet.n8:e,colCount:n=mt(n)||n<-1?z.Worksheet.e8:n}}function O(t,e){var t,e,n,t=t.defaults,e=w(e,Pt);e&&(n=e.defaultColWidth,isNaN(n)?(t.colWidth=ut.SJSColumnWidthHelper.defaultColumnWidthToPixel(8),t._isExcelDefaultColumnWidth=!0):t.colWidth=ut.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(n)),t.rowHeight=ut.SJSColumnWidthHelper.pointToPixel(e.defaultRowHeight))}function V(r,o,a,t){var e,s,n,u,c,f,l,h,d,i,v,g,m,p,S,w,b,b,C,C,y,b,M,k,T,x,G,n,C,e=P(o,"sheetViews&sheetView"),s=r.Ut,n=r.options,i=!a||!1!==a.includeStyles,v=lt.Util.Co(a),g=r.getRowCount(),m=r.getColumnCount(),p=o.lossless,S=0,w=0;if(e){if((b=e.topLeftCell)&&(l=B(b),S=l?l.row:0,w=l?l.col:0),e.zoomScale&&r.zoom(e.zoomScale/100),b=n.gridline,(C=o.lossless&&o.lossless.gridline)?(b.showHorizontalGridline=!!mt(C.showHorizontalGridline)||C.showHorizontalGridline,b.showVerticalGridline=!!mt(C.showVerticalGridline)||C.showVerticalGridline):"0"===e.showGridLines&&(b.showHorizontalGridline=!1,b.showVerticalGridline=!1),C&&!mt(C.color)?b.color=C.color:e.colorId&&64!=+e.colorId&&(b.color=ut.ColorHelper.getIndexedColor(e.colorId)),"1"===e.rightToLeft&&(n.rightToLeft=!0),I(e.showRowColHeaders,!0)||(n.rowHeaderVisible=!1,n.colHeaderVisible=!1),I(e.showFormulas)&&(n.showFormulas=!0),n.showZeros=I(e.showZeros,!0),I(e.tabSelected)&&r.b2(!0,!1),C=R(e,"pane"),y=3,i&&C&&0<C.length&&C.forEach(function(t){var e,e,t,n,i,e=t.state;"frozen"!==e&&"frozenSplit"!==e||(t.topLeftCell&&(f=t.topLeftCell),e=t.xSplit,t=t.ySplit,n=S,i=w,t&&g<=(h=+t+n)&&(g=Ct(g,h)),e&&m<=(d=+e+i)&&(m=Ct(m,d)),Ut(r,o,a,h,d,S,w),t&&e?(l=B(f),S=l.row||0,w=l.col||0):t&&!e?(l=B(f),S=l.row||0,w=i):!t&&e&&(l=B(f),S=n,w=l.col),g<S&&(g=S+1),m<w&&(m=w+1))}),i&&Ft(r,o),i&&(p&&p.defaultStyle?((b=new W.Style).fromJSON(p.defaultStyle,St,r),r.setDefaultStyle(b)):t.defaultStyle&&r.setDefaultStyle(t.defaultStyle)),M=R(e,"selection"),k=null==M?void 0:M.length,M&&0<k)for(T=(null==p?void 0:p.selectRanges)||[],x=function(t){var e,n,n,n,e,i,e=M[t],n=e.activeCell;n&&(n=B(n),u=n.row,c=n.col,g=Ct(g,n.row+1),m=Ct(m,n.col+1)),n=e.panel,!(e=e.sqref)||n&&3!==n||(k-1===t&&T&&T.length?(i=s.selectionModel.selections=[],T.forEach(function(t){i.push(new ut.Range(t.row,t.col,t.rowCount,t.colCount))})):(i=N(e),s.selectionModel.selections=i),v&&i&&i.forEach(function(t){var e=t.row+(0<t.rowCount?t.rowCount:1),t=t.col+(0<t.colCount?t.colCount:1);g=Ct(g,e),m=Ct(m,t)}))},G=0;G<k;G++)x(G);v&&lt.Util.So(r,g,m,t)}return n=p?nt(p.rowHeaderColCount,z.Worksheet.r8):z.Worksheet.r8,C=p?nt(p.colHeaderRowCount,z.Worksheet.o8):z.Worksheet.o8,r.setColumnCount(n,ft.SheetArea.rowHeader),r.setRowCount(C,ft.SheetArea.colHeader),r.O6(u||0,c||0,St,St,!0),{showCellRow:S,showCellCol:w}}function Y(u,t,f,c,e,n){var l,i,h,r,o,d,v,g,m,p,S,r,l=!e||!1!==e.includeStyles,i=u.Ut,h=i.Q_(!1,3),r=w(t,Rt),o=r&&r.c_,d=i.W_(3),v=d.a8,g=k(e);o&&0<o.length&&(m=u.getColumnCount(),p=!1,S=function(t,e){var n,i,r,o,a,a,s,u,c,n=t.width,i=I(t.hidden,!1),r=t.outlineLevel,a=d.J_(-1,e,!0),a=a&&a.style,s=+t.min,u=+t.max,c=wt;return mt(n)||(c=ut.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(n)),i&&0===c&&(c=St)),i=i&&mt(r)?i:wt,g?t.t!==St?o=f.getOriginNamedStyle(t.t):t.e!==St&&(o=E(f.getOriginStyle(t.e))):o=f.getStyle(t.style),v&&y(v.style,-1,e,a,o),{minCol:s,maxCol:u,columnSize:c,hidden:i,colStyle:o=l&&o?o:wt}},o.forEach(function(t,e){var e,n,i,r,o,a,e,t,s,e=S(t,e),n=e.minCol,i=e.maxCol,r=e.columnSize,o=e.hidden,a=e.colStyle;for(m<i&&(p=!0),e=i===z.MAX_COLUMN_COUNT,t=+t.max,i=e?Ct(n,c):t,s=n;s<=i;s++)lt.Util.cme(u,h,s-1,r,o,a)}),p)&&(n.dataEffectByInflate[u.name()]||(n.dataEffectByInflate[u.name()]={}),n.dataEffectByInflate[u.name()].setColumnInfo=function(t){K(u,t,o,h,S)}),(r=t.lossless&&t.lossless.colInfos)&&r.forEach(function(t,e){mt(t)||(mt(t.colTag)||(u.setTag(-1,e,t.colTag),delete t.colTag),h.X_(e,t))})}function K(t,e,a,n,i){var r,o,s,u,c;if(!(e.col<0||e.colCount<=0))for(r=function(t){for(var e,n,i,r,o,i=0,r=a.length;i<r;i++)if(t>=+(o=a[i]).min&&t<=+o.max){e=o,n=i;break}return{colItem:e,colItemIndex:n}},o=function(t){var t=r(t),e=t.colItem,t=t.colItemIndex;if(e)return i(e,t)},u=e.col,c=e.col+e.colCount;u<c;u++)(s=!s||u+1<s.minCol||u+1>s.maxCol?o(u+1):s)&&lt.Util.cme(t,n,u,s.columnSize,s.hidden,s.colStyle)}function Nt(t,e){var e,n,i,e=w(e,m);e&&(n=t.spanModels[3],(i=e.c_).forEach(function(t){var t=B(t.ref);n.find(t.row,t.col)||n.add(t)}))}function Et(t,o,a){var e,s;if(0<t.length)return e={n_:S},s=[],t.forEach(function(t){var e,n,n,n,i,r,r,i,r,e={n_:ht.XFileConstants.ku,lossless:{}},n=o[t.row+","+t.col],n=pt(n||(0,ut.Ec)(t.row,t.col,1,1));e.ref=n,(i=(n=t.hyperlink).url)&&(i.substring(0,(r="sjs://").length)===r?e.location=c(i.replace(r,"")):(r=ht.XFileConstants.Rr+lt.Util.wr(a),a.c_.push({n_:ht.XFileConstants.Lr,Id:r,Target:c(i),Type:ht.RelationshipConstants.pc,TargetMode:ht.XFileConstants.Cu}),e[f]=r),"string"==typeof(i=t.value))&&(e.display=c(i)),n.tooltip&&(e.tooltip=c(n.tooltip)),r=e.lossless,mt(n.drawUnderline)||(r.drawUnderline=n.drawUnderline),mt(n.command)||(r.command=n.command),mt(n.target)||(r.target=n.target),n.visitedLinkColor!==St&&(r.visitedLinkColor=n.visitedLinkColor),n.linkColor!==St&&(r.linkColor=n.linkColor),s.push(e)}),e.c_=s,e}function Ht(a,t){var e,e,s,e=w(t,S);e&&(e=e.c_)&&(s=t.rels&&t.rels.c_||[],e.forEach(function(t){var e,n,e,i,r,r,o,o,e=t.ref.split(":"),n=h(e[0]),e=l(e[0]),i=u(t.tooltip);t[f]&&(r=d(s,t[f]),r=u(r&&r.Target)),(o=u(t.location))&&(r=r?r+"#"+o:"sjs://"+(o="#"===o[0]?o.substr(1):o)),o=t.lossless||{},a.setHyperlink(n,e,{url:r,tooltip:i,linkColor:o.linkColor,visitedLinkColor:o.visitedLinkColor,drawUnderline:!!mt(o.drawUnderline)||o.drawUnderline,command:o.command,target:o.target||0},3)}))}function Ut(t,e,n,i,r,o,a){t.ome(i,o,!0),t.ame(r,a,!0)}function Ft(t,e){var e=e.lossless;e&&(it(t,t.frozenTrailingRowCount,e.frozenTrailingRowCount),it(t,t.frozenTrailingColumnCount,e.frozenTrailingColCount),t.Ny=!q(e.frozenTrailingRowStickToEdge)||e.frozenTrailingRowStickToEdge,t.Vy=!q(e.frozenTrailingColumnStickToEdge)||e.frozenTrailingColumnStickToEdge,mt(e.frozenlineColor)||(t.options.frozenlineColor=e.frozenlineColor))}function _t(t,e,n){var i=n&&n.frozenColumnsAsRowHeaders,n=n&&n.frozenRowsAsColumnHeaders,r=t.frozenRowCount(),o=t.frozenColumnCount();0<r&&n&&ot(t,St,r,o,!0),0<o&&i&&at(t,St,o,r,!0)}function At(t,e,n){var i,r,o,a,s,u,i=t.options,r=w(e,"sheetProtection"),o=i.protectionOptions;if(r)for(a in r.algorithmName&&r.hashValue&&r.saltValue&&r.spinCount?t.oue={algorithmName:r.algorithmName,hashValue:r.hashValue,saltValue:r.saltValue,spinCount:+r.spinCount}:r.password&&(t.oue={legacyPassword:r.password}),delete r.algorithmName,delete r.hashValue,delete r.saltValue,delete r.spinCount,delete r.password,r)if(r.hasOwnProperty(a))switch(u="0"===(s=r[a]),a){case ht.XFileConstants.ru:i.isProtected="1"===s;break;case"selectLockedCells":o.allowSelectLockedCells=u;break;case"selectUnlockedCells":o.allowSelectUnlockedCells=u;break;case"autoFilter":o.allowFilter=u;break;case"sort":o.allowSort=u;break;case"insertColumns":o.allowInsertColumns=u;break;case"insertRows":o.allowInsertRows=u;break;case"deleteColumns":o.allowDeleteColumns=u;break;case"deleteRows":o.allowDeleteRows=u;break;case"objects":o.allowEditObjects=u;break;default:"1"===r[a]||"0"===r[a]?o[a]="0"===r[a]:"n_"!==a&&"c_"!==a&&(o[a]=r[a])}t.isActualProtected()&&!0!==o.allowEditObjects&&r.objects===St&&(o.allowEditObjects=!0),"formatColumns"in o&&!0===o.formatColumns&&(o.allowOutlineColumns=!0,n)&&(o.allowResizeColumns=!0),"formatRows"in o&&!0===o.formatRows&&(o.allowOutlineRows=!0,n)&&(o.allowResizeRows=!0)}function Lt(i,e,r){var n={addRowButtonOption:function(t){var e,e,n;t?(e=i.addRowButtonOption,e={visible:t.visible||e.visible,command:t.command||e.command,tooltip:t.tooltip||e.tooltip,height:t.height||e.height,style:e.style},t.style&&((n=new W.Style).fromJSON(t.style,St,r),e.style=n),i.addRowButtonOption=e):i.addRowButtonOption=t},addColumnButtonOption:function(t){var e,e,n;t?(e=i.addColumnButtonOption,e={visible:t.visible||e.visible,command:t.command||e.command,tooltip:t.tooltip||e.tooltip,width:t.width||e.width,style:e.style},t.style&&((n=new W.Style).fromJSON(t.style,St,r),e.style=n),i.addColumnButtonOption=e):i.addColumnButtonOption=t},sheetAreaOffset:function(t){mt(t.left)||(i.sheetAreaOffset.left=t.left),mt(t.top)||(i.sheetAreaOffset.top=t.top)}};e&&e.sheetOptions&&Object.keys(e.sheetOptions).forEach(function(t){mt(e.sheetOptions[t])||(n[t]&&"function"==typeof n[t]?n[t](e.sheetOptions[t]):i[t]=e.sheetOptions[t])})}function Dt(t,e){t&&e&&(t.ghe=e.parameter)}function jt(t,e,n){var i,r,o,r,o,i={rowHeaderAutoText:t.rowHeaderAutoText,colHeaderAutoText:t.colHeaderAutoText,rowHeaderAutoTextIndex:t.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:t.colHeaderAutoTextIndex,allowCellOverflow:t.allowCellOverflow,clipBoardOptions:t.clipBoardOptions,selectionBackColor:t.selectionBackColor,selectionBorderColor:t.selectionBorderColor,sheetAreaOffset:{left:t.sheetAreaOffset.left,top:t.sheetAreaOffset.top}};return t.addRowButtonOption&&(r=i.addRowButtonOption={},(o=t.addRowButtonOption).visible&&(r.visible=o.visible),"number"==typeof o.height&&(r.height=o.height),n&&!n.UTe(o.command)&&(r.command=o.command),o.style&&(r.style=o.style.toJSON()),o.tooltip)&&(r.tooltip=o.tooltip),t.addColumnButtonOption&&(r=i.addColumnButtonOption={},(o=t.addColumnButtonOption).visible&&(r.visible=o.visible),"number"==typeof o.width&&(r.width=o.width),n&&!n.HTe(o.command)&&(r.command=o.command),o.style&&(r.style=o.style.toJSON()),o.tooltip)&&(r.tooltip=o.tooltip),e&&(i.rowHeaderVisible=t.rowHeaderVisible,i.colHeaderVisible=t.colHeaderVisible),i}function Ot(t,e){var n,e,i,n=e&&e.frozenColumnsAsRowHeaders,e=e&&e.frozenRowsAsColumnHeaders;(n||e)&&(i=t.Ut,e&&q(i.ap)&&(t.cp=!0,t.deleteRows(0,i.ap)),n)&&q(i.fp)&&t.deleteColumns(0,i.fp)}function Vt(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,h;if(t){if(n.col=Math.max(t.getActiveColumnIndex(),0),n.row=Math.max(t.getActiveRowIndex(),0),s=0<r,u=0<o,0===i){if(!s||!u)return}else if(1===i){if(!u)return;s&&(n.col=o,n.row=0)}else if(2===i){if(!s)return;u&&(n.col=0,n.row=r)}if(n.col=Math.min(ht.XmlConstants.xo,n.col),n.row=Math.min(ht.XmlConstants.Io,n.row),e)if(c=void 0,f=t.getSelections())for(l=0;l<f.length;l++)"object"==typeof(h=f[l])&&(d=h.row,v=h.col,g=0<h.rowCount?h.rowCount:ht.XmlConstants.Io,h=0<h.colCount?h.colCount:ht.XmlConstants.xo,c=new ut.Range(0<d?d:0,0<v?v:0,g,h),e.push(c),null!=a)&&a.push({row:d,col:v,rowCount:g,colCount:h});else e.push(new ut.Range(n.row,n.col,1,1));return 1}}function Yt(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,d,g,m,p,S,S,p,w,b,r=t.getSelections();if(r&&0!==r.length)for(o=n?t.frozenRowCount():0,a=n?t.frozenColumnCount():0,s=[],u=new ut.Range(0,0,1,1),c=0,l=-(f=1),h=3;0<=h;h--)if(d=void(s.length=0),Vt(t,s,u,h,o,a,d=i&&3===h?i:d)){for(f=s.length,c=0;c<f;c++)-1!==(v=-1!==(v=s[c]).col&&-1!==v.colCount?v:new ut.Range(v.row,0,v.rowCount,ht.XmlConstants.xo)).row&&-1!==v.rowCount||(v=new ut.Range(0,v.col,ht.XmlConstants.Io,v.colCount)),u.col>=v.col&&u.col<=v.col+v.colCount-1&&u.row>=v.row&&u.row<=v.row+v.rowCount-1&&(l=c);if(l<0&&0<f&&(u.row=s[0].row,u.col=s[0].col),d=""+C(u.col)+(u.row+1),g="",0<a&&0<o&&(1===h||2===h))g=d;else{for(c=0;c<f;c++)m=s[c],p=Math.min(ht.XmlConstants.Io,m.row+1),S=Math.min(m.col,ht.XmlConstants.xo),g+=""+C(S)+p,(1<m.colCount||1<m.rowCount)&&(S=Math.min(S+m.colCount-1,ht.XmlConstants.xo),p=Math.min(p+m.rowCount-1,ht.XmlConstants.Io),g+=":"+(w=""+C(S)+p)),g+=" ";g=g.trim()}lt.StringEx.Xi(g)||3===h&&(0<a||0<o||3!==h)||(b={n_:"selection"},3!==h&&(b.pane=bt[h]),b.activeCell=d,0!==l&&0===h&&(b.activeCellId=l.toString()),b.sqref=g,e.c_.push(b))}}function Kt(t,e,n,i){var e,i,e=(e&&e.theme?e:i).theme,i=new Z.Theme(void 0);n&&e?e&&i.yh(e):i.yh("Office"),t.currentTheme(i)}function zt(t,e){t&&(t[e]=2)}function Wt(t,e){var n,i,r,o,a,s,u,c,n,i=t.options.protectionOptions,r,o={n_:"sheetProtection"};for(s in t.isActualProtected()&&(o.sheet="1"),a=function(t){return t?"0":"1"},i)if(i.hasOwnProperty(s)&&(u=i[s],!(c=["allowSelectLockedCells","allowSelectUnlockedCells"].includes(s)&&u))){if(n=null!=(n=lt.protectionOptionsMap[s])?n:s,!e){if(!lt.excelSupportProtectionOptions[n])continue;if("allowEditObjects"===s&&!t.isActualProtected())continue}o[n]=a(u)}if(t.oue&&(ut.util.w1(o,t.oue),mt(o.spinCount)||(o.spinCount=""+o.spinCount),o.legacyPassword)&&(o.password=o.legacyPassword,delete o.legacyPassword),1<Object.keys(o).length)return o}function Jt(t,e){var t,n,n=function(t){var t=t.range();return e.intersect(t.row,t.col,t.rowCount,t.colCount)};return null==(t=t.tables)?void 0:t.all().some(n)}function Zt(t,e,n){for(var i,r,o,a,s,u,c,i=[],r=t.getSpans(),o={},a=0;a<r.length;a++)s=r[a],u=!e&&Jt(t,s),s&&!u&&(i.push({n_:ht.XFileConstants.xu,ref:pt(s)}),o[s.row+","+s.col]=s);return{spanRowColInfos:o,sjsMergeCells:c=n&&0<i.length?{n_:m,c_:i}:c}}function Qt(t){var e,n,n,i,e=t.name(),n=t.getParent();return n&&(n=n.getSheetPosition(t.name())+1,e=(i=ht.XFileConstants.ru)+n),e}Object.defineProperty(t,"__esModule",{value:!0}),t=e("Common"),z=e("./dist/core/worksheet/worksheet.js"),W=e("./dist/core/worksheet/style.js"),J=W.Style.xp,ut=e("./dist/core/util/common.js"),Z=e("./dist/core/util/theme.js"),ct=e("./dist/core/util/domUtil.js"),b=e("./dist/core/worksheet/stylehelper.js"),ft=e("./dist/core/core.enum.js"),r=e("CalcEngine"),lt=e("./dist/core/excel-io-util/common.js"),n=e("./dist/core/excel-io-util/range-parser.js"),ht=e("./dist/core/excel-io-util/excel-types.js"),p=e("./dist/core/worksheet/worksheet-model.js"),e=e("./dist/core/core.ns.js"),dt=void 0,e=new t.Common.ResourceManager(e.SR,"Sheets"),s=e.getResource.bind(e),y=ut.UsedRangeUtil.updateUsedRangeByData,yt=16384,a=1048576,Q=!!r,X=t.Common.CultureManager,vt=z.Worksheet.fh,q=ut.util.T1,gt=ct.GC$.each,M=ct.GC$.isEmptyObject,$=t.Common.kh,mt=t.Common.lt.ht,Mt=lt.IndexHelper.nr,l=lt.IndexHelper.$i,h=lt.IndexHelper.qi,u=ut.util.n1,d=lt.Util.Sr,kt=ut.util.Pr,w=ut.util.xr,P=ut.util.o1,R=ut.util.go,c=ut.util.vo,v=ut.util.d1,Tt=ut.util.h1,B=n.range_parser._c,N=n.range_parser.Dc,pt=n.range_parser.jc,g=t.Common.zf,C=lt.Util.No,k=lt.Util.ko,I=lt.NodeHelper.ur,f=ht.XFileConstants.Ki,xt=ht.XFileConstants.Su,Gt=ht.XFileConstants.Tu,Bt=ht.XFileConstants.Au,m=ht.XFileConstants.Iu,S=ht.XFileConstants.Nu,It=ht.XFileConstants.Du,Pt=ht.XFileConstants._u,Rt=ht.XFileConstants.Eu,T=ht.XFileConstants.bo,rt="string",tt=parseInt,et=isNaN,St=void 0,wt=null,x="1",G="0",E=t.Common.lt.tv,(e=bt=bt||{})[e.bottomRight=0]="bottomRight",e[e.topRight=1]="topRight",e[e.bottomLeft=2]="bottomLeft",e[e.topLeft=3]="topLeft",ct.GC$.extend(z.Worksheet.prototype,{s8:function(t,e,n,i,r,o){var t,e;t[e]||(t[e]={}),(t=t[e])[n]||(t[n]={}),e=t[n],r&&!mt(e.value)||(e.value=i),mt(o)||(e.style?o.formatter&&(e.style.formatter=o.formatter):e.style=o)},c8:function(t,e,n,i,r,o){var t,a,s,u,c,f,c,t=w(t,T),a=t[e],s=(s=(a=a||(t[e]={}))[n])||(a[n]={});switch(u=typeof i){case"boolean":s.b=i?1:0;break;case"string":f=(c=(0,p.getOADateNumber)(i,r)).OADateNumber,c=c.valueIndex,s.o=f,s.v=c;break;case"object":i&&i.richText?s.v=r.getTextIndex(i):s.v=i;break;default:s.n=i}mt(o)||(s.s=o)},Op:function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,m,n=this,i=n.Ut,r=i.W_(),o=i.W_(ft.SheetArea.colHeader),a=i.Q_(!0),s=i.Q_(!0,ft.SheetArea.colHeader),u=i.K_(),c=i.K_(ft.SheetArea.colHeader),f=n.rowFilter(),l=r.getColumnCount(),h=0;h<t;h++)for(r.setNode(h,-1,o.J_(h,-1)),d=s.q_(h),n.NMi&&(v=n.defaults.colHeaderRowHeight)!==p.DEFAULT_COL_HEADER_ROW_HEIGHT&&(d?mt(d.size)&&(d.size=v):d={size:v}),a.X_(h,d),g=e;g<l;g++)(m=(m=o.J_(h,g))||{}).style=n.getActualStyle(h,g,ft.SheetArea.colHeader),r.setNode(h,g,m),(m=n.getFormula(h,g,ft.SheetArea.colHeader))&&n.setFormula(h,g,m,ft.SheetArea.viewport);c.getSpans().forEach(function(t){u.add(t)}),f&&f.range&&-1===f.range.row&&(f.f8=!0),n.frozenRowCount(t),i.l8(z.Worksheet.o8,l,ft.SheetArea.colHeader),i.h8(!1,ft.SheetArea.colHeader),i.d8(ft.SheetArea.colHeader),n.b3(ft.SheetArea.colHeader).clearAll()},jp:function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,d,d,n=this,i=n.Ut,r=i.W_(),o=i.W_(ft.SheetArea.rowHeader),a=i.Q_(!1),s=i.Q_(!1,ft.SheetArea.rowHeader),u=i.K_(),c=i.K_(ft.SheetArea.rowHeader),f=r.getRowCount(),l=0;l<t;l++)for(r.setNode(-1,l,o.J_(-1,l)),a.X_(l,s.q_(l)),h=e;h<f;h++)(d=(d=o.J_(h,l))||{}).style=n.getActualStyle(h,l,ft.SheetArea.rowHeader),r.setNode(h,l,d),(d=n.getFormula(h,l,ft.SheetArea.rowHeader))&&n.setFormula(h,l,d,ft.SheetArea.viewport);c.getSpans().forEach(function(t){u.add(t)}),n.frozenColumnCount(t),i.l8(f,z.Worksheet.r8,ft.SheetArea.rowHeader),i.h8(!1,ft.SheetArea.rowHeader),i.d8(ft.SheetArea.rowHeader),n.b3(ft.SheetArea.rowHeader).clearAll()},toJSON:function(n){var a,t,e,i,r,o,r,s,s,e,r,i,u,s,c,f,l,e,h,d,v,g,m,p,S,w,S,a=this,t=n&&n.ignoreStyle;for(l in!n||n.kp||a.NMi||(e=a.getRowCount(ft.SheetArea.colHeader),i=a.getColumnCount(ft.SheetArea.rowHeader),r=n.rowHeadersAsFrozenColumns,s=(o=n.columnHeadersAsFrozenRows)&&0<e,(r=r&&0<i)&&a.addColumns(0,i),s&&a.ffe(0,e,3,{rowExpand:s}),r&&a.jp(i,s?e:0),s&&a.Op(e,r?i:0)),s=a.getRowCount(),e=a.getColumnCount(),r=a.getRowCount(ft.SheetArea.colHeader),i=a.getColumnCount(ft.SheetArea.rowHeader),u={name:n&&n.newWorkSheetName||a.name(),isSelected:a.b2(),rowCount:s,columnCount:e,activeRow:a.ui,activeCol:a.ci,zoomFactor:a.zoom(),rowHeaderColCount:i,colHeaderRowCount:r,visible:a.visible(),parameter:a.ghe},s=a.getDockScrollbarAttachedIndex(),mt(s)||(u.dockScrollbarAttachedIndex=s),t||(u.frozenRowCount=a.frozenRowCount(),u.frozenColCount=a.frozenColumnCount(),u.frozenTopRow=a.bve,u.frozenLeftCol=a.yve,u.frozenTrailingRowCount=a.frozenTrailingRowCount(),u.frozenTrailingColCount=a.frozenTrailingColumnCount(),u.frozenTrailingRowStickToEdge=a.Ny,u.frozenTrailingColumnStickToEdge=a.Vy,u.theme=a.hl.toJSON()),f=(c=a.Ut).toJSON(n))u[l]=f[l];for(d in vt&&gt(vt,function(t,e){e.toJson&&e.toJson.call(a,u,n)}),(e=a.VTe())&&(u.attachments=e.Np(f.data)),h={},u)!$(u,d)||mt(v=u[d])||U(d,v)||(h[d]=v);if(F(a,u.data.dataTable),gt(a.options,function(t,e){var n,i,r,o,n=e;"gridline"===t&&(n={},i=e.color,r=e.showHorizontalGridline,o=e.showVerticalGridline,i&&i!==ut.I.fl("gc-gridlineColor").borderTopColor&&(n.color=i),!1===r&&(n.showHorizontalGridline=r),!1===o)&&(n.showVerticalGridline=o),"sheetAreaOffset"===t&&(n={},e.left&&(n.left=e.left),e.top)&&(n.top=e.top),"protectionOptions"===t&&a.oue&&ut.util.w1(n,a.oue),"addRowButtonOption"===t&&e&&(n={},e.visible&&(n.visible=e.visible),"number"==typeof e.height&&(n.height=e.height),a.UTe(e.command)||(n.command=e.command),e.style&&(n.style=e.style.toJSON()),e.tooltip)&&(n.tooltip=e.tooltip),"addColumnButtonOption"===t&&e&&(n={},e.visible&&(n.visible=e.visible),"number"==typeof e.width&&(n.width=e.width),a.HTe(e.command)||(n.command=e.command),e.style&&(n.style=e.style.toJSON()),e.tooltip)&&(n.tooltip=e.tooltip),"_ps"===t||mt(n)||z.Worksheet.Pp[t]===n||"object"==typeof n&&M(n)||(h[t]=n)}),g=[],m=a.Hp){for(p in m)$(m,p)&&(S=m[p])&&(w=S.toJSON(),S=S.font,M(w)||(S&&(w.font=b.W.b5(S)),g.push(w)));0<g.length&&(h.namedStyles=g)}return h},vCn:function(t,F,e,n,i,_){var r,o,a,s,e,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,A,L,B,D,I,j,P,O,V,R,Y,N,K,E,H,U;if(e&&(o=e.noSchema,a=e.version),t){e=(s=this).Ut,u=n&&n.ignoreStyle,s.Zp(),(c=s.Uw&&s.Uw())&&!c.G3&&(f=c.G3=!0),z.Worksheet.et(s,"preFromJson"),s.suspendPaint(),e.v8(),e.m8(),l=X.culture(),X.culture(""),h=nt(t.rowCount,z.Worksheet.n8),d=nt(t.columnCount,z.Worksheet.e8);try{if(s.ub(t.name+"",!0),s.b2(t.isSelected),s.setRowCount(h),s.setColumnCount(d),s.ghe=t.parameter,s.Hp={},v=t.namedStyles)for(g=0;g<v.length;g++)m=v[g],p=new W.Style,J(m,s),p.fromJSON(m,o,s),s.$p(p);for(w in S=s.options)if($(S,w)&&(b=t[w],"protectionOptions"===w?(b=b||t.protectionOption)&&(b.algorithmName&&b.hashValue&&b.saltValue&&b.spinCount&&(s.oue={algorithmName:b.algorithmName,hashValue:b.hashValue,saltValue:b.saltValue,spinCount:b.spinCount}),delete b.algorithmName,delete b.hashValue,delete b.saltValue,delete b.spinCount):"allowCellOverflow"===w?b=q(t[w])?t[w]:!a||11<=a:("addRowButtonOption"===w||"addColumnButtonOption"===w)&&b&&b.style&&((p=new W.Style).fromJSON(b.style,o,s),b.style=p),q(b)))if("object"==typeof b)for(C in b)$(b,C)&&(S[w][C]=b[C]);else"borderWidth"===w?(S.sheetAreaOffset.left=b,S.sheetAreaOffset.top=b):S[w]=b;if(y=nt(t.activeRow,s.ui),M=nt(t.activeCol,s.ci),s.O6(y,M,St,St,!0),u||(it(s,s.frozenRowCount,t.frozenRowCount,t.frozenTopRow||0),it(s,s.frozenColumnCount,t.frozenColCount,t.frozenLeftCol||0),it(s,s.frozenTrailingRowCount,t.frozenTrailingRowCount),it(s,s.frozenTrailingColumnCount,t.frozenTrailingColCount),s.Ny=!q(t.frozenTrailingRowStickToEdge)||t.frozenTrailingRowStickToEdge,s.Vy=!q(t.frozenTrailingColumnStickToEdge)||t.frozenTrailingColumnStickToEdge),!u){if(k=t.colStyles)for(T in k)et(T)||s.setStyle(-1,tt(T,10),k[T],ft.SheetArea.viewport);if(x=t.rowStyles)for(G in x)et(G)||s.setStyle(tt(G,10),-1,x[G],ft.SheetArea.viewport)}A=nt(t.rowHeaderColCount,z.Worksheet.r8),L=nt(t.colHeaderRowCount,z.Worksheet.o8),s.setColumnCount(A,ft.SheetArea.rowHeader),s.setRowCount(L,ft.SheetArea.colHeader),s.g8(nt(t._zoomFactor||t.zoomFactor,s.zoom())),!1===t.visible?t.visible=ft.SheetTabVisible.hidden:!0===t.visible&&(t.visible=ft.SheetTabVisible.visible),it(s,s.visible,t.visible),B=s.b8,D={sheet:s,setValidator:function(t,e,n){B&&B.y8(t,e,n)},ignoreStyle:u},s.w8(t),e.fromJSON(t,o,D,s.Lp&&s.Lp.allowDynamicArray),s.defaults=e.defaults,B&&B.C8(!0),I=t.dockScrollbarAttachedIndex,mt(I)||s.setDockScrollbarAttachedIndex(I),(j=t.theme)&&!u&&(typeof(P=j)!=rt&&q(P)&&(O="_themeColor",V="_name",R=P.themeColor||P[O],(Y=new Z.ColorScheme(R.name||R[V])).fromJSON(R,o),P=new Z.Theme(P.name||P.Zc,Y,P.headingFont||P.Aee,P.bodyFont||P.See)),s.currentTheme(P)),ct.GC$.isEmptyObject(t.attachments)||null!=(r=s.VTe())&&r.Zme(t.attachments),st(s,t,o,n,F,i),N=n&&n.frozenColumnsAsRowHeaders&&!s.NMi,E=(K=n&&n.frozenRowsAsColumnHeaders&&!s.NMi)&&t.frozenRowCount||0,H=N&&t.frozenColCount||0,K&&0<E&&ot(s,t,E,H),N&&0<H&&at(s,t,H,E),Q&&(U=s.Uw(),0<E&&(U.S8=E),0<H)&&(U.T8=H),i||(0<E&&s.deleteRows(0,E),0<H&&s.deleteColumns(0,H)),s.clearPendingChanges()}finally{f&&delete c.G3,X.culture(l),e.A8(),s.resumePaint()}}},fromJSON:function(t,e,n,i,r){this.vCn(t,e,n,i,r)},Yp:function(a,s,t,u,c){var f,e,l,h,d,v,n,i,r,o,g,m,p,S,t,w,b,C,y,M,t,w,k,t;if(t&&(f=t.noSchema,e=t.version),a){if(h=(l=this).Ut,d=u.ignoreStyle,l.Zp(),z.Worksheet.et(l,"preFromJson"),h.v8(),h.m8(),v=X.culture(),X.culture(""),l.Hp={},n=a.namedStyles)for(i=0;i<n.length;i++)r=n[i],o=new W.Style,J(r,l),o.fromJSON(r,f,l),l.$p(o);for(m in g=l.options)if($(g,m)&&(p=a[m],"protectionOptions"===m?p=p||a.protectionOption:"allowCellOverflow"===m?p=q(a[m])?a[m]:!e||11<=e:("addRowButtonOption"===m||"addColumnButtonOption"===m)&&p&&p.style&&((o=new W.Style).fromJSON(p.style,f,l),p.style=o),q(p)))if("object"==typeof p)for(S in p)$(p,S)&&(g[m][S]=p[S]);else"borderWidth"===m?(g.sheetAreaOffset.left=p,g.sheetAreaOffset.top=p):g[m]=p;if(t=nt(a.activeRow,l.ui),w=nt(a.activeCol,l.ci),l.O6(t,w,St,St,!0),d||(it(l,l.frozenRowCount,a.frozenRowCount),it(l,l.frozenColumnCount,a.frozenColCount),it(l,l.frozenTrailingRowCount,a.frozenTrailingRowCount),it(l,l.frozenTrailingColumnCount,a.frozenTrailingColCount),l.Ny=!q(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,l.Vy=!q(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!d){if(b=a.colStyles)for(C in b)et(C)||l.setStyle(-1,tt(C,10),b[C],ft.SheetArea.viewport);if(y=a.rowStyles)for(M in y)et(M)||l.setStyle(tt(M,10),-1,y[M],ft.SheetArea.viewport)}t=nt(a.rowHeaderColCount,z.Worksheet.r8),w=nt(a.colHeaderRowCount,z.Worksheet.o8),l.setColumnCount(t,ft.SheetArea.rowHeader),l.setRowCount(w,ft.SheetArea.colHeader),l.g8(nt(a._zoomFactor||a.zoomFactor,l.zoom())),!1===a.visible?a.visible=ft.SheetTabVisible.hidden:!0===a.visible&&(a.visible=ft.SheetTabVisible.visible),k=l.b8,t={sheet:l,setValidator:function(t,e,n){k&&k.y8(t,e,n)},ignoreStyle:d,incrementalLoading:u.incrementalLoading,incrementLoadTask:u.incrementLoadTask},l.w8(a),h.fromJSON(a,f,t,l.Lp&&l.Lp.allowDynamicArray,function(){var t,t,e,n,i,r,i,r,t,o,r;l.defaults=h.defaults,k&&k.C8(!0),(t=a.theme)&&!d&&(typeof(t=t)!=rt&&q(t)&&(i=t.themeColor||t[e="_themeColor"],(r=new Z.ColorScheme(i.name||i[n="_name"])).fromJSON(i,f),t=new Z.Theme(t.name||t.Zc,r,t.headingFont||t.Aee,t.bodyFont||t.See)),l.currentTheme(t)),st(l,a,f,u,s,c),i=u&&u.frozenColumnsAsRowHeaders&&!l.NMi,t=(r=u&&u.frozenRowsAsColumnHeaders&&!l.NMi)&&a.frozenRowCount||0,o=i&&a.frozenColCount||0,r&&0<t&&ot(l,a,t,o),i&&0<o&&at(l,a,o,t),Q&&(r=l.Uw(),0<t&&(r.S8=t),0<o)&&(r.T8=o),c||(0<t&&l.deleteRows(0,t),0<o&&l.deleteColumns(0,o)),l.clearPendingChanges(),X.culture(v),h.A8(),l.loaded=!0})}},wh:function(F,_,n){var i,t,e,r,A,o,a,s,u,c,s,c,u,c,s,f,l,h,d,v,g,m,p,u,u,m,s,S,w,b,v,g,C,l,d,f,y,h,m,s,b,w,S,v,l,M,L,k,D,f,T,j,O,m,s,b,w,S,x,v,V,k,o,a,p,c,Y,K,l,M,G,z,W,J,B,I,I,P,Z,R,Q,X,q,$,tt,et,L,T,t,D,f,nt,g,s,b,w,S,it,rt,N,ot,E,at,H,st,U,i=this,t=i.options,e=lt.Util.ko(n),r=!n||!1!==n.includeStyles;for(t.sheetTabColor&&(A={n_:xt,c_:[Tt(t.sheetTabColor,St,"tabColor")]}),o=i.getRowCount(ft.SheetArea.colHeader)||1,a=i.getColumnCount(ft.SheetArea.rowHeader)||1,s=i.NMi&&(n&&n.fileType)===ft.OpenSaveFileType.excel,u=n&&n.rowHeadersAsFrozenColumns,c=n&&n.columnHeadersAsFrozenRows,(u||c||s)&&(c=(c||s)&&0<o,(s=u&&0<a)&&i.addColumns(0,a),c&&i.ffe(0,o,3,{rowExpand:c}),s&&i.jp(a,c?o:0),c)&&i.Op(o,s?a:0),u=t.gridline,c=t.frozenlineColor,s=i.zoom(),f=i.frozenRowCount(),l=i.frozenColumnCount(),h=i.bve||0,d=i.yve||0,v=i.getViewportLeftColumn(1),g=i.getViewportTopRow(1),i.NMi?m="A1":h||d?m=pt((0,ut.Ec)(h,d,1,1)):v!==St&&g!==St&&(f||l?l&&!f?m="A"+(g+1):!l&&f&&(m=pt((0,ut.Ec)(0,v,1,1))):m=pt((0,ut.Ec)(g,v,1,1))),u=(u=(p=u?{color:u.color,showVerticalGridline:u.showVerticalGridline,showHorizontalGridline:u.showHorizontalGridline}:p)&&p.color&&p.color!==ut.I.fl("gc-gridlineColor").borderTopColor?p&&p.color:St)&&ut.ColorHelper.getClosestColorIndex(ut.ColorHelper.convertHexColorToArgb(u)),u={n_:"sheetView",showGridLines:!p||!1!==p.showVerticalGridline&&!1!==p.showHorizontalGridline?St:"0",rightToLeft:!0===t.rightToLeft?"1":St,showRowColHeaders:!1===t.rowHeaderVisible&&!1===t.colHeaderVisible?"0":St,defaultGridColor:u?0:St,colorId:u,showFormulas:t.showFormulas?"1":St,showZeros:t.showZeros?St:"0",topLeftCell:m||St,zoomScale:1===s?St:Math.round(100*s),workbookViewId:0,tabSelected:i.b2()?"1":St,c_:[]},s=m=0,S=3,w="1",b="A",r&&(0<l||0<f)&&(0<l&&(m=l,b=Mt(v)),0<f&&(s=f,w=g+1+""),0<l&&0===f?S=1:0===l&&0<f?S=2:0<l&&0<f&&(S=0),v={n_:"pane",xSplit:0<l?l-d:St,ySplit:0<f?f-h:St,topLeftCell:b+w==="A1"?pt((0,ut.Ec)(m,s,1,1)):b+w,activePane:bt[S],state:"frozen"},u.c_.push(v)),Yt(i,u,r,g=e?[]:wt),C=_.styleManager,l=_.sharedStrings,y=(f=(d=i.Ut).wh(C,l,n)).sheetData,h=f.hyperlinks,m=f.rowHeaderData,s=f.colHeaderData,b=f.rowHeaderColInfos,w=f.colHeaderRowInfos,S=f.rowHeaderSpan,v=f.colHeaderSpan,l=f.defaults,M=f.selectionPolicy,L=f.selectionUnit,k=f.rowInfos,D=f.defaultData,f=f.tag,T=!i.NMi&&i.getDefaultStyle(),m={rowHeaderData:m,colHeaderData:s,rowHeaderColInfos:b,colHeaderRowInfos:w,rowHeaderSpan:S,colHeaderSpan:v,rowInfos:k,colHeaderRowCount:o,rowHeaderColCount:a,gridline:p,frozenlineColor:c,defaults:l,selectionPolicy:M,selectionUnit:L,defaultStyle:j=r&&T&&T.toJSON(),sheetOptions:O=jt(t,e,i),defaultData:D,tag:f,parameter:i.ghe,selectRanges:g},r&&(S=w=b=s=void 0,s=i.frozenTrailingRowCount(),b=i.frozenTrailingColumnCount(),w=i.Ny,S=i.Vy,0!==s&&(m.frozenTrailingRowCount=s),0!==b&&(m.frozenTrailingColCount=b),!0!==w&&(m.frozenTrailingRowStickToEdge=w),!0!==S)&&(m.frozenTrailingColumnStickToEdge=S),r&&(m.theme=i.hl.wh(e)),x=d.Q_(!1,3).wh(n),V=(v=d.defaults).colWidth,k=v.rowHeight,o={n_:Pt,defaultRowHeight:ut.SJSColumnWidthHelper.pixelToPoint(k),defaultColWidth:ut.SJSColumnWidthHelper.pixelToColumnWidth(V),customHeight:2<=Math.abs(76-k)?"1":St},a=n&&!1===n.includeEmptyRegionCells,c=p=0,Y=i.getRowCount(),K=i.getColumnCount(),a&&(l=ft.UsedRangeType.all-ft.UsedRangeType.colStyle-ft.UsedRangeType.rowStyle-ft.UsedRangeType.style-ft.UsedRangeType.axis,M=i.getUsedRange(l))&&(p=M.row,c=M.col,Y=M.row+M.rowCount,K=M.col+M.colCount),G=[],z=x.length-1,W=m.colInfos=[],J=d.W_(3),B=c;B<Ct(K,1+z);B++)I=(I=J.J_(-1,B))&&I.style,P=x[B],Z=i.getTag(-1,B),!P&&!I&&mt(Z)||(R=P&&P.size,Q=P&&P.visible,$=q=X=void 0,r&&I&&(e?"string"==typeof I?X=C.getOriginNamedStyleIndex(I,i):I!==St&&(q=C.getOriginStyleIndex(I,i)):("string"==typeof I&&0===I.indexOf(C.Jd)&&(tt=I,I=(I=i.i3(tt,!1))||(et=i.parent)&&et.i3(tt,!1)),$=C.getStyleIndex(I))),(!mt(R)&&R!==V||!1===Q||I||X!==St||q!==St)&&(G[B]={width:mt(R)?ut.SJSColumnWidthHelper.pixelToColumnWidth(V):ut.SJSColumnWidthHelper.pixelToColumnWidth(R),hidden:!1===Q?"1":St,customWidth:mt(R)||R===V?St:1,style:$,t:X,e:q}),mt(Z)||(x[B]=x[B]||{},x[B].colTag=Z),W[B]=x[B]);for(T=(L=Zt(i,e,r)).spanRowColInfos,t=L.sjsMergeCells,f=Et(h,T,D={n_:ht.XFileConstants.Dr,xmlns:ht.RelationshipConstants._r,c_:[]}),B=p;B<Y;B++)nt=i.getTag(B,-1),!y[B]&&mt(nt)&&!1!==i.getRowVisible(B)||(y[B]||(y[B]={r:B+1}),!1===i.getRowVisible(B)&&(y[B].v="1"),mt(nt))||(y[B].lossless={tag:nt});for(g=Wt(i,e),!(s=i.VTe().wh(y))||ct.GC$.isEmptyObject(s.attachmentsJSON)||ct.GC$.isEmptyObject(s.attachmentsInfos)||(F.attachments||(F.attachments={}),F.attachments[Qt(this)]=s.attachmentsJSON,m.attachments=s.attachmentsInfos),b=i.getRowCount()||1,w=i.getColumnCount()||1,S={n_:Gt,ref:pt((0,ut.Ec)(0,0,b,w))},N={n_:"worksheet",c_:[A,S,it={n_:It,c_:[u]},o,y,g,t,f,rt={n_:Bt,c_:[]}],rels:D,tempCols:G,lossless:m},vt&&gt(vt,function(t,e){e.wh&&e.wh.call(i,N,_,n)}),ot=[],B=0;B<G.length;B++)if(E=G[B]){if(yt<=(at=B))break;for(H=B+1,st=at;H<G.length&&(U=G[H])&&H===st+1&&H<yt&&U.style===E.style&&U.hidden===E.hidden&&U.outlineLevel===E.outlineLevel&&U.collapsed===E.collapsed&&Math.abs(U.width-E.width)<=1e-4&&U.t===E.t&&U.e===E.e;)B=st=H,H++;P={n_:"col",min:at+1+"",max:st+1+""},E.style!==dt&&(P.style=E.style+""),E.t!==dt&&(P.t=E.t+""),E.e!==dt&&(P.e=E.e+""),isNaN(E.width)||E.width===dt||(P.width=E.width+""),P.hidden=E.hidden,E.collapsed&&(P.collapsed="1"),!isNaN(E.width)&&1e-4<Math.abs(E.width-i.defaults.colWidth)&&(P.customWidth="1"),"number"==typeof E.outlineLevel&&0!==E.outlineLevel&&(P.outlineLevel=E.outlineLevel+""),ot.push(P)}return 0<ot.length&&N.c_.push({n_:Rt,c_:ot}),delete N.tempCols,kt(N,ht.WorkSheetNodeOrder),N},zTe:function(n,i,r,o,t){var e,a,s,u,c,f,a,l,a,h,l,e,d,e,v,g,m,l,l,u,s=this,u=s.options,c=w(n,T),f=n.lossless;_(u,n),l=(a=j(n)).rowCount,a=a.colCount,c&&(r.fileType===ft.OpenSaveFileType.excel?(mt(c.rowCount)||(l=Math.max(c.rowCount,l||0)),mt(c.colCount)||(a=Math.max(c.colCount,a||0))):(mt(c.rowCount)||(l=c.rowCount),mt(c.colCount)||(a=c.colCount))),s.setRowCount(l),s.setColumnCount(a),l=(h=s.parent)&&h.getSheetPosition(s.name()),(e=i.sheetNamedStyles)[l]&&e[l].forEach(function(t){delete t.sheetId,s.addNamedStyle(t)}),O(d=s.Ut,n),e=V(s,n,r,i),v=e.showCellRow,g=e.showCellCol,m=!r||!1!==r.includeStyles,Kt(s,f,m,i),l=i.styleManager,Y(s,n,l,a,r,i),Lt(u,f,s),Dt(s,f),d.yh(c,i,r,f,function(){m&&Nt(d,n),Ht(s,n),At(s,n,r.fileType===ft.OpenSaveFileType.excel),vt&&gt(vt,function(t,e){e.yh&&e.yh.call(s,n,i,r,o)});var t=h&&h.v2,t=t&&t.sheetsState;o?(zt(t,s.name()),A(s,n,r),D(s,v,g)):r.incrementLoadTask.addTask(function(t,e,n,i){zt(i,t.name()),A(t,e,n),D(s,v,g)},[s,n,r,t])},o,s.Lp&&s.Lp.allowDynamicArray),l=null==(e=i.attachments)?void 0:e[Qt(s)],u=null==(a=null==n?void 0:n.lossless)?void 0:a.attachments,ct.GC$.isEmptyObject(l)||ct.GC$.isEmptyObject(u)||s.VTe().yh(l,u)},rv:function(t,e,n,i,r){var o,a,i,o=this;i?o.zTe(t,e,n,i,r):((n=n||{}).progress||(n.progress=function(t){}),n.loadStatus||(n.loadStatus={total:0,valuesLoad:0,formulaLoad:0}),a=lt.Util.wo(n,o.parent&&o.parent.v2),i=n.incrementLoadTask&&n.incrementLoadTask.tasks&&0===n.incrementLoadTask.tasks.length,n.incrementLoadTask.addTask(function(t,e,n){o.zTe(t,e,n,r)},[t,e,n],g.I5(s().STEP.loadSheetData,[o.name()]),function(){var t=n.loadStatus.valuesLoad/n.loadStatus.total;return a?.2:n.fullRecalc?t*lt.STEP_RATE.loadSheetDataWithCalc+ +lt.STEP_RATE.parseFile+lt.STEP_RATE.loadFileData:t*lt.STEP_RATE.loadSheetData+lt.STEP_RATE.parseFile+lt.STEP_RATE.loadFileData},o.name()),i&&n.incrementLoadTask.start())},yh:function(t,e,n,i){this.rv(t,e,n,i)}})},"./dist/core/worksheet/worksheet-model.js":function(s,g,h){"use strict";var c,l,v,P,E,nt,M,H,U,F,it,t,rt,_,A,ft,L,R,D,ot,j,O,at,st,m,k,V,p,x,Y,K,z,S,w,W,u,b,ut,J,Z,Q,lt,X,ct,q,$,tt,et,ht,d,dt,N,C,y,vt,gt,mt,pt,t,St,wt,L,bt,Ct,yt,Mt,kt,Tt,xt,f,Gt,Bt,It,Pt,Rt,Nt,Et,Ht,Ut,Ft,_t;function At(t,e){return ut(t)?e:t}function I(t,e){return t.hasOwnProperty(e)}function Lt(t){return"number"==typeof t}function G(t){return t.rowCount}function B(t){return t.colCount}function Dt(t,n,e,i){var r=e;Object.defineProperty(t,n,{get:function(){return r},set:function(t){var e=r;i(this,r=t,n,e)}})}function jt(e,t){e.cache={},t&&t.forEach(function(t){Ot(e,t)})}function Ot(t,e){var n,i;if(t.I8=p(t.I8,e.row+G(e)-1),t.x8=p(t.x8,e.col+B(e)-1),!t.suspendUpdatingCache)for(n=0;n<e.rowCount;n++)for(i=0;i<e.colCount;i++)t.cache[e.row+n+"_"+(e.col+i)]=e}function Vt(t,e){var n,i;if(!t.suspendUpdatingCache)for(n=0;n<e.rowCount;n++)for(i=0;i<e.colCount;i++)t.cache[e.row+n+"_"+(e.col+i)]=st}function Yt(t,e){var n,i,n,n=t.indexOf("/OADate(")+1,i=t.indexOf(")");return 0!==n&&n<i&&(n=parseFloat(t.substring(n+7,i)),!isNaN(n))?{OADateNumber:n,valueIndex:st}:{OADateNumber:st,valueIndex:e.getTextIndex(t)}}function e(){Dt(this,"spans",[],jt),this.x8=-1,this.I8=-1,this.cache={},this.suspendUpdatingCache=!1}function Kt(){Array.apply(this,arguments)}function zt(){var t=Ft.call(this)||this;return t.headingOverflowLayouts=at,t.trailingOverflowLayouts=at,t}function Wt(t,e,n,i,r,o,a,s,u){var c=this;c.column=t,c.startColumn=e,c.endColumn=n,c.valueWidth=i,c.columnWidth=r,c.backgroundWidth=o,c.backgroundLeftWidth=a,c.backgroundRightWidth=s,c.expandedWidth=u}function Jt(t,e,n){var i,r,o,a,s,i=(0,it.Ec)(-1,-1,-1,-1);return t&&(r=t.col,o=t.row,s=-1===r,i.row=(a=-1===o)?0:o,i.rowCount=a?e:G(t),i.col=s?0:r,i.colCount=s?n:B(t)),i}function n(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}function Zt(t,e,n,i,r,o){for(var a,s,u,c,f,a=t.length,u=!1,c=[],f=0;f<a;f++)if(s=t[f],u=ut(e)||ut(n)?ut(e)?ut(n)?ut(i)?s.containsY(r):s.containsX(i):s.col===n:s.row===e:s.contains(e,n)){if(!o)return s;c.push(s)}return o&&0<c.length?c:at}function Qt(t,e,n,i){var r=at,o=t.length,a=!ut(e);return r=0<o?(r=a?t.findX(e):t.findY(n))||(i&&a?e<t[o-1].x?t[o-1]:t[0]:a&&e<t[0].x||!a&&n<t[0].y?t[0]:t[o-1]):r}function i(){return _t.call(this)||this}function Xt(t,e,n,i,r,o,a,s,u,c){var f=this;f.rowCount=a,f.colCount=s,f.row=t,f.col=e,f.x=n,f.y=i,f.width=r,f.height=o,f.isAutoMerge=u,f.offsetX=c}function qt(t,e){var t=t.valuesLoad/t.total;return e?.4*t+.1:.3*t+.1}function $t(t,e,n,i,r,o,a,s,u,c,f){var l,h,d,v,g,m,p,S,w,b,C,y,l,a,l=r&&r.incrementLoadTask;if(l&&!l.isTerminated){for(h=l.isBusyFunc,d=a=a||0,v=!1,g=30,m=new Date;d<n;){if(p=e[d])for(S=0;S<i;S++)(w=p[S])&&ue(w,t.J_(d,S,v=!0),o,d,S,r,u,c,f);if(d++,h&&h())break;if(30<(b=new Date)-m)break}if(v){if(C=r&&r.sheet,0!==a&&C.parent.getActiveSheet()===C)for(y=a;y<d;y++)if(C.N8.viewport[1].findRow(y)){C.repaint();break}(l=r&&r.incrementalLoading)&&(l.loadStatus.valuesLoad+=d-a,a=qt(l.loadStatus,r.doNotRecalculateAfterLoad),C.parent&&C.parent.ki(it.Events.ProgressChanged,{loadStatus:l.loadStatus,progress:a,sheet:C}),l.loading)&&l.loading(a,{sheet:C})}d<n?r.incrementLoadTask.pushTask($t,[t,e,n,i,r,o,d,s,u]):s&&r.incrementLoadTask.pushTask(s,[])}}function te(t,e,n,i,r,o,a,s,u){for(var c,f,l,h,c=0;c<n;c++)if(f=e[c])for(l=0;l<i;l++)(h=f[l])&&ue(h,t.J_(c,l,!0),o,c,l,r,a,s,u)}function ee(a,t,e,s,n,i,r,o,u,c,f){var l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,x,P,i,i,l=A.Util.Mo(n);if(e){for(h=a.a8,d=n&&!1===n.includeStyles,v=X(n),g=s.styleManager,p=(m=n&&n.incrementLoadTask).isBusyFunc,S=!1,w=30,l&&(b=new Date),C=i=i||0,y=e.rowCount,M=e.colCount;C<y;)if(k=e[C]){for(x=(T=a.J_(C,-1,!0))&&T.style,G=void 0,T&&!d&&(v?k.t!==st?G=g.getOriginNamedStyle(k.t):k.e!==st&&(G=ct(g.getOriginStyle(k.e))):G=g.getStyle(k.s),T.style=G),T&&k.lossless&&!ut(k.lossless.tag)&&(T.tag=k.lossless.tag),h&&N(h.style,C,-1,x,T&&T.style),B=function(t){var e,n,i,r,e,e,o,e=k[t];if(e===st)return"continue";S=!0,n=a.J_(C,t,!0),r=void 0,i=(r=e).v!==st?"number"==typeof(e=r.v)?s.sharedStrings.getText(e):e&&(e._calcError||e._error&&!ut(e._code)||e.error&&!ut(e.code))?R&&U.CalcError.parse(e._calcError||e._error||e.error):e:r.b!==st?!!r.b:r.o!==st?"/OADate("+r.o+")/":r.n,ut(r.f)&&h&&N(h.data,C,t,n.value,i),ut(r.d)||(n.fileGUID=r.d),ut(i)||("object"==typeof i&&0<Object.keys(i).length&&("SparklineExValue"===i.typeName&&"IMAGE"===i.name?i.toString=function(){return i.value.altText+""}:i=Ee(i=i.richText?Q(i):i)),n.value=i),e=n.style,v||(ut(r.s)&&(G||f[t])?r.s=0:0!==r.s||G||f[t]||(r.s=st)),d||(o=void 0,v?r.t!==st?o=g.getOriginNamedStyle(r.t):r.e!==st&&(o=ct(g.getOriginStyle(r.e))):o=g.getStyle(r.s),n.style=o),h&&N(h.style,C,t,e,n.style),r.lossless&&(ut(r.lossless.bindingPath)||(N(h.data,C,t,n.bindingPath,r.lossless.bindingPath),n.bindingPath=r.lossless.bindingPath),ut(r.lossless.tag)||(n.tag=r.lossless.tag),ut(r.lossless.altText)||(n.altText=r.lossless.altText)),-1<C&&Me(n,i,!!r.f||!!r.g||!!r.si,n.style,u,st,c)},I=0;I<M;I++)B(I);if(C++,!o&&p&&p())break;if(l&&(x=new Date,!o)&&30<x-b)break}else C++;if(S){if(0!==i&&t.parent.getActiveSheet()===t)for(P=i;P<C;P++)if(t.N8.viewport[1].findRow(P)){t.repaint();break}n.loadStatus.valuesLoad+=C-i,!o&&l&&(i=n.loadStatus.valuesLoad/n.loadStatus.total,i=+(n.fullRecalc?.3*i+.2:.4*i+.2).toFixed(5),n.incrementLoadTask.progress)&&n.incrementLoadTask.progress({progress:i,sheetName:t.name(),step:J.I5(St().STEP.loadSheetData,[t.name()])})}C<y?n.incrementLoadTask.pushTask(ee,[a,t,e,s,n,C,r,st,u,c,f]):o?r():r&&n.incrementLoadTask.pushTask(r,[])}else r&&setTimeout(r,0)}function ne(t,e,n,i,r){var i,o,i,n;0<=t&&0<=e&&(i[t]||(i[t]={}),o=(i=i[t])[e],i=null==(i[e]=n)?void 0:n.value,n=null==n?void 0:n.expr,r)&&(N(r,t,e,o&&o.value,i),N(r,t,e,o&&o.expr,n))}function ie(t,e,n,i,r,o,a,s,u){var o,c,o;0<=n&&0<=i?(o[n]||(o[n]={}),c=(o=o[n])[i],o=(o[i]=r)&&r.value,u.a8&&(o&&"SparklineExValue"===o.typeName&&(o=at),N(u.a8.data,n,i,c&&c.value,o),N(u.a8.style,n,i,c&&c.style,r&&r.style))):0<=n&&-1===i&&0<=t&&-1===e?a[n]=r:0<=i&&-1===n&&0<=e&&-1===t&&(s[i]=r)}function re(t,e,n,i,r,o,a){var o;0<=n&&0<=i&&(o[n]||(o[n]={}),o[n].rs="e",(o=o[n]).originalItem=a,o[i]=r)}function oe(t,e,n){var i,r,o,a,s,u,i={};for(r in t)t[r]&&(o=V(r),!isNaN(o))&&e<=o&&(a=t[o],s=t[o+n],u=i[o],s&&(i[o+n]=s),u?t[o+n]=u:(delete t[o],t[o+n]=a))}function ae(t,e,n){var i,r,o;for(i in t)t[i]&&(r=Math.floor(i),!isNaN(r))&&e<=r&&(o=t[r],delete t[r],e+n<=r)&&(t[r-n]=o)}function se(t,e,n,i,r){var o=t.op(),t=t.Uw(),a=e.Uw(),s;o&&t&&a&&r&&(s=o.unparse(a,r,n,i)),e.Ut.setDefaultValue(n,i,s,at,rt.DefaultChangeValueType.Expression,at,!0)}function r(t,e,n){var i=this;i.Mf=t,i.Sx=e,i.Tx=n,i.defaultCellData={},i.Gve=new it.BaseUsedRange,i.I8=-1,i.x8=-1}function o(t,e,n,i){var r=this;r.Sx=t,r.Tx=e,ut(n)||(r.j8=n),ut(i)||(r.O8=i),r.Hc()}function a(){this.infos=[],this.R8=[]}function ue(t,e,n,i,r,o,a,s,u){var c,f,l,l,h,d,v,h,n,v,o,d,h,a,n;t&&(c=t.value,f=t.formula,c!==st&&(c!==at&&(c._calcError||c._error&&!ut(c._code))&&(l=R&&U.CalcError.parse(c._calcError||c._error))!==st&&(c=l=Q(l)),ut(f)&&a&&N(a.data,i,r,e.value,c),!ut(c)&&"object"==typeof c&&0<Object.keys(c).length&&(c=Ee(c=c.richText&&c.converted?Q(c):c)),e.value=c),l=t.style,h=o&&o.sheet,l!==st&&o&&!o.ignoreStyle&&(d=at,v=e.style,typeof l===m?(e.style=l,d=h&&(h.i3(l,!1)||h.parent&&h.parent.i3(l,!1))):l&&((d=new nt.Style).fromJSON(l,n),d.name=st,e.style=d),a&&N(a.style,i,r,v,e.style),d)&&d.validator&&o.setValidator&&o.setValidator(i,r,d.validator),(h=t.visualState)!==st&&(e.visualState=h),(n=t.bindingPath)!==st&&(N(a.data,i,r,e.bindingPath,n),e.bindingPath=n),(v=t.tag)!==st&&v!==at&&(typeof(o=v.typeName)===m&&(d=F.getTypeFromString(o))&&(v=new d).fromJSON&&v.fromJSON(t.tag),e.tag=v),(h=t.altText)!==st&&h!==at&&(e.altText=h),(a=t.hyperlink)!==st&&(e.hyperlink=ct(a)),-1<i&&-1<r&&Me(e,c,!!f,l,s,st,u),(n=t.fileGUID)!==st)&&(e.fileGUID=n)}function ce(t,e,n){var i=0<t.P8?[["selectionModel"],st]:st;t.selectionModel.setProperty(e,n,i),i&&t.G8.push(i)}function fe(t){return t[0].slice(0,3)}function le(t){return t[0].slice(3).filter(function(t){return"style"!==t}).join("-")}function he(t,n){return t.find(function(t){if(t.path.length!==n.length)return!1;for(var e=0;e<=n.length;e++)if(t.path[e]!==n[e])return!1;return!0})}function de(t,e,n){var i;if(t)return(i=t.caches)||(t.caches=i=H.createMap(),t.forEach(function(t){void 0===t[3]&&i.set(t[1]+","+t[2],1)})),i.has(e+","+n)}function ve(t,e,n,i){var r=t[e];r&&delete r[n],i&&ot(r)&&delete t[e]}function ge(t){return t&&t.filter(function(t){return!t.isAutoMerge})}function T(t,e,n,i,r,o){var a,s,s,s,u,s;function c(t,e,n,i){0<a.P8&&a.G8.push([["defaults",n],i,e]),a.Mf.zw()}this.lh={},(a=this).Cpe=this.Spe.bind(this),T.s2e(a.Cpe),a.Mf=t,s=new xt(e,n,e,n),a.sheetModels=[st,new xt(i,n,0,0),new xt(e,r,0,0),s],s.z8(),(s=a.rowInfos=[])[0]=s[1]=new f,s[2]=s[3]=new f,(s=a.colInfos=[])[0]=s[2]=new f,s[1]=s[3]=new f,a.spanModels=[st,new wt,new wt,new wt],a.defaultValueModels=[st,new Tt(t,i,n),new Tt(t,e,r),new Tt(t,e,n)],a.selectionModel=new yt,(u=a.colHeaderSelectionModel=new yt).selectionPolicy=1,a.name=o||"",a.isSelected=!1,a.zoomFactor=1,Dt(s=a.defaults={},"rowHeight",20,c),Dt(s,"colWidth",62,c),Dt(s,"rowHeaderColWidth",40,c),Dt(s,"colHeaderRowHeight",g.DEFAULT_COL_HEADER_ROW_HEIGHT,c),Dt(s,"_isExcelDefaultColumnWidth",!1,c),a.P8=0,T.et(this,"init"),a.V8(e,n),a.F8={}}function me(e,t,n){var i,r,o,a,s,u,i,c,f,l,f,h,r,d,v,g,g,d,r,v,t,g;if(t[0]===gt)pe(t,function(t){me(e,t,n)});else if("selectionModel"!==(o=(r=-1!==(i=t.indexOf("style"))&&!Array.isArray(t[0]))?t.slice(0,i+1):t[0])[0]){for(a=e,s=0;s<o.length-1;s++)u=o[s],a=u===Y?a.B8:(a[u]||(a[u]={}),a[u]);c=o[(i=o.length)-1],f=e.sheetModels[3],l=e.defaultValueModels[3],f=f.a8,h=a[o[s]],r?Se(t,a,n):(r=o[0],d=t[1],v=null,2<t.length&&(v=t[2]),v=n?v:d,r===C||"colInfos"===r||"rowInfos"===r||r===y?n&&v!==a[o[s]]?a[o[s]]=v:n||("bindingPath"===o[s]&&e.Mf.setTemplateCell?(g={row:o[s-2],col:o[s-1],value:d},Rt.et(e,"undoBindingPath",g)):a[o[s]]=d):"spanModels"===r?(a.cache={},a.spans=[],v.forEach(function(t){a.add((0,it.Ec)(t.row,t.col,t.rowCount,t.colCount))})):(a[o[s]]=t[1],g=void 0,d=o[i-2],r=o[1],"size"===c?g=o[0]===S?rt.AxisInfoChangeType.setRowHeight:rt.AxisInfoChangeType.setColumnWidth:"visible"===c&&(g=o[0]===S?rt.AxisInfoChangeType.setRowVisible:rt.AxisInfoChangeType.setColumnVisible),ut(g)||e.L8({type:g,index:d,sheetArea:r}))),"style"===c?((v=f&&f.style)&&N(v,o[i-3],o[i-2],h,a[o[s]]),a&&(h&&h.quotePrefix||a.style&&a.style.quotePrefix)&&(h&&h.quotePrefix)!==(a.style&&a.style.quotePrefix)&&Me(a,a.value,!!a.formula,a.style,e.F8)):"value"===c?((t=f&&f.data)&&N(t,o[i-3],o[i-2],h,a[o[s]]),a&&h!==a.value&&Me(a,a.value,!!a.formula,a.style,e.F8)):c===vt&&(g=l.Gve)&&N(g,o[i-3],o[i-2],h,a[o[s]])}}function pe(t,n){var e,i,r,a,e;t[0]===gt&&(i=t[1],r=t[2],a=function(t,e){"number"==typeof e?t.push(r[e]):(t.push(e.old),t.push(e.new)),n(t)},i.forEach(function(t){var r,o,e,r=t.path,o=t.change,e;Object.keys(o).forEach(function(t){var e,n,i,e=P(P(P([],r,!0),t.split("-").map(function(t){return+t}),!0),["style"],!1),n=o[t];if(Array.isArray(n))for(i=n.length-1;0<=i;i--)a(P([],e,!0),n[i]);else a(e,n)})}))}function Se(t,e,n){var i,r,t,o,i=t.indexOf("style");t.length-i==3?e.style=n?t[i+2]:t[i+1]:(r=t[i+1],t=Object.keys(r),(o=e.style)&&t.forEach(function(t){var e=n?r[t].new:r[t].old;o[t]!==e&&(o[t]=e)}))}function we(t,e){return!e&&!ut(t)&&"string"==typeof t}function be(t,e,n,i){var e;return(!e||!e.quotePrefix)&&(n&&n[t]||(-1!==Nt.indexOf(t[0])&&1<t.length&&(Rt.et(st,"isInvalidFormula",e={value:t,isInvalid:!1,allowDynamicArray:i}),e.isInvalid)?(n&&(n[t]=!0),1):void 0))}function Ce(t){ut(t.cellState)||(t.cellState&=~rt.CellStatesType.invalidFormula)}function ye(t){ut(t.cellState)&&(t.cellState=0),t.cellState|=rt.CellStatesType.invalidFormula}function Me(t,e,n,i,r,o,a){ut(t)||(we(e,n)&&be(e,i=o&&i&&"string"==typeof i?Te(i,o):i,r,a=o&&ut(a)?o.options.allowDynamicArray:a)?ye:Ce)(t)}function ke(t,e,n){return!(ut(t)&&ut(e)||("string"==typeof t&&(t=Te(t,n)),"string"==typeof e&&(e=Te(e,n)),(t&&t.quotePrefix)===(e&&e.quotePrefix)))}function Te(t,e){var n,i,r,o,a;if(e){if(n=e.getNamedStyle(t))return n;for(i=0,r=e.sheets;i<r.length;i++)if(a=(o=r[i]).getNamedStyle(t))return a;return at}}function xe(t,e){var n,i,t;if("string"==typeof t&&"/OADate"===t.substring(0,7)&&!e.formatter){if((e=ut(e)?new nt.Style:e)._autoFormatter)return e.formatter=e._autoFormatter.formatCached,e;n=t.indexOf("("),i=t.indexOf(")"),-1!==n&&-1!==i&&((t=parseInt(t.substring(n+1,i),10))<1?e.formatter="h:mm:ss":1<t&&(e.formatter="M/d/yyyy"))}return e}function Ge(t,e){return e=t.renamedStyles&&t.renamedStyles[e]?t.renamedStyles[e]:e}function Be(t,e){var n,i,r;return"object"==typeof e?e:"string"==typeof e?(Et.test(n=e)&&(i=e.indexOf(Ht),n=Ge(t,e.substring(i))),(r=t.u8(n))||new nt.Style):void 0}function Ie(t,e,n){n&&Pe(e,n=Be(t,n))}function Pe(t,e){t.backColor===st&&e.backColor!==st&&!1!==e.applyFill&&(t.backColor=e.backColor),!1!==e.applyFont&&(t.foreColor===st&&e.foreColor!==st&&(t.foreColor=e.foreColor),t.themeFont===st&&t.font===st&&(t.themeFont=e.themeFont),t._fontStyle===st&&(t._fontStyle=e._fontStyle),t._fontWeight===st&&(t._fontWeight=e._fontWeight),t._fontSize===st&&(t._fontSize=e._fontSize),t._fontFamily===st&&(t._fontFamily=e._fontFamily),t._fontVariant===st&&(t._fontVariant=e._fontVariant),t._fontStretch===st&&(t._fontStretch=e._fontStretch),t._lineHeight===st&&(t._lineHeight=e._lineHeight),t._font=ht(t._fontStyle,t._fontWeight,t._fontSize,t._fontFamily,t._fontVariant,t._fontStretch,t._lineHeight),t.textDecoration===st)&&e.textDecoration!==st&&(t.textDecoration=e.textDecoration),!1!==e.applyAlignment&&(t.hAlign===st&&e.hAlign!==st&&(t.hAlign=e.hAlign),t.vAlign===st&&e.vAlign!==st&&(t.vAlign=e.vAlign),t.textIndent===st&&e.textIndent!==st&&(t.textIndent=e.textIndent),t.wordWrap===st&&e.wordWrap!==st&&(t.wordWrap=e.wordWrap),t.isVerticalText===st&&e.isVerticalText!==st&&(t.isVerticalText=e.isVerticalText),t.shrinkToFit===st&&e.shrinkToFit!==st&&(t.shrinkToFit=e.shrinkToFit),t.textOrientation===st&&e.textOrientation!==st&&(t.textOrientation=e.textOrientation),t.textDirection===st)&&e.textDirection!==st&&(t.textDirection=e.textDirection),t.formatter===st&&e.formatter!==st&&!1!==e.applyNumberFormat&&(t.formatter=e.formatter),!1!==e.applyBorder&&(t.borderLeft===st&&e.borderLeft!==st&&(t.borderLeft=Re(e.borderLeft)),t.borderTop===st&&e.borderTop!==st&&(t.borderTop=Re(e.borderTop)),t.borderRight===st&&e.borderRight!==st&&(t.borderRight=Re(e.borderRight)),t.borderBottom===st&&e.borderBottom!==st&&(t.borderBottom=Re(e.borderBottom)),t.diagonalUp===st&&e.diagonalUp!==st&&(t.diagonalUp=Re(e.diagonalUp)),t.diagonalDown===st)&&e.diagonalDown!==st&&(t.diagonalDown=Re(e.diagonalDown)),t.locked===st&&!1!==e.applyProtection&&(t.locked=e.locked),t.hidden===st&&!1!==e.applyProtection&&(t.hidden=e.hidden),t.quotePrefix===st&&e.quotePrefix!==st&&(t.quotePrefix=e.quotePrefix)}function Re(t){var e;return t&&(e={},ut(t.color)||(e.color=t.color),ut(t.style)||(e.style=t.style),ut(t.level)||(e.level=t.level),e)}function Ne(t){var e,n,i,e=ct(t);for(n in e)e.hasOwnProperty(n)&&(i=e[n],!ut(i)&&"object"==typeof i&&0<Object.keys(i).length?Ne(i):M.Common.ct.W0(i)&&(e[n]=M.Common.ct.Q0(i)));return e}function Ee(t){var e,n,i,e=ct(t);for(n in e)e.hasOwnProperty(n)&&(i=e[n],!ut(i)&&"object"==typeof i&&0<Object.keys(i).length?Ee(i):typeof i===m&&"/"===i.charAt(0)&&(e[n]=it.util.a2e(i)));return e}c=this&&this.__extends||(Ut=function(t,e){return(Ut=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ut(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},v=this&&this.__rest||function(t,e){var n,i,r,n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n},P=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(g,"__esModule",{value:!0}),g.Y8=g.DEFAULT_COL_HEADER_ROW_HEIGHT=g.YTe=g.ZTe=g.copyDefaultFormula=g.W8=g.h9=g.Q8=g.K8=g.getOADateNumber=void 0,E=h("./dist/core/core.ns.js"),nt=h("./dist/core/worksheet/style.js"),M=h("Common"),H=h("CalcEngine"),U=h("CalcEngine"),F=h("./dist/core/util/common.js"),it=h("./dist/core/util/common.js"),t=h("./dist/core/util/domUtil.js"),rt=h("./dist/core/core.enum.js"),_=h("./dist/core/celltype/celltype.ns.js"),A=h("./dist/core/excel-io-util/common.js"),ft=h("./dist/core/excel-io-util/excel-types.js"),L=h("./dist/core/worksheet/stylehelper.js"),R=!!H,D=t.GC$.each,ot=t.GC$.isEmptyObject,j=t.GC$.extend,O=new RegExp("^\\d*(\\.\\d+)?\\*$"),at=null,st=void 0,m="string",k=Math.min,V=Math.floor,p=Math.max,x=Math.ceil,Y="dirtyNodes",K="vc",z="undo",S="rowInfos",w="colInfos",W="default_size",u=M.Common.J8,b=M.Common.X8,ut=M.Common.lt.ht,J=M.Common.zf,Z=it.util.wt,Q=it.util.g0,lt=it.util.St,X=A.Util.ko,ct=M.Common.lt.tv,q=M.Common.lt.q8,$=200,tt=20,et="bindingPath",ht=L.W.upe,d=it.UsedRangeUtil.vh,dt=it.UsedRangeUtil.hh,N=it.UsedRangeUtil.updateUsedRangeByData,C="sheetModels",y="defaultValueModels",vt="defaultCellData",gt="style-changes",mt=["borderLeft","borderTop","borderRight","borderBottom","borderHorizontal","borderVertical","diagonalDown","diagonalUp"],pt=["cellButtons","dropDowns"],t=new M.Common.ResourceManager(E.SR,"Sheets"),St=t.getResource.bind(t),g.getOADateNumber=Yt,e.prototype.find=function(t,e){return this.cache[t+"_"+e]||at},e.prototype.get=function(t,e){return this.find(t,e)||(0,it.Ec)(t,e,1,1)},e.prototype.remove=function(t,e){var t=this.spans.indexOf(t);0<=t?(e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),this.removeSpan(t,1),e&&(e[2]=[].concat(this.spans))):e&&(e.length=0)},e.prototype.removeSpan=function(t,e){for(var n=0;n<e;n++)Vt(this,this.spans[t+n]);this.spans.splice(t,e)},e.prototype.update=function(t,e){var n=this;Vt(n,n.spans[t]),n.spans[t]=e,Ot(n,e)},e.prototype.add=function(t,e){e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),Ot(this,t),this.spans.push(t),e&&(e[2]=[].concat(this.spans))},e.prototype.tE=function(t,e,n,i,r,o,a,s){var u,u,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,c=this,f=!1;for(a&&(l=[].concat(c.spans)),h=c.spans.length,v=[],d=0;d<h;d++)m=(g=c.spans[d]).col,S=(p=g.row)-t,w=m-e,b=G(g),C=B(g),y=r,M=o,s&&(b=(u=[C,b])[0],C=u[1],S=(u=[w,S])[0],w=u[1],y=(u=[o,r])[0],M=u[1]),(-1===t||t<=p&&p<t+y)&&(-1===e||e<=m&&m<e+M)?(v.push((0,it.Ec)(k=-1===t?p:n+S,T=-1===e?m:i+w,b,C)),f=!0):(-1===t||n<=p&&p<n+r)&&(-1===e||i<=m&&m<i+o)&&(c.removeSpan(d,1),d--,h--,f=!0);for(d=0;d<v.length;d++){if(!c.nE(c.spans,0,c.spans.length,g=v[d]))throw new Error(St().Exp_OverlappingSpans);c.add(g)}a&&(f?(a[0].push("spans"),a[1]=l,a[2]=[].concat(c.spans)):a.length=0)},e.prototype.nE=function(t,e,n,i){for(var r=e;r<n&&r<t.length;r++)if(t[r].intersect(i.row,i.col,G(i),B(i)))return!1;return!0},e.prototype.getSpans=function(t){var e,n,i,r,e=this.spans;if(!t)return[].concat(e);for(n=[],i=0;i<e.length;i++)(r=e[i]).intersect(t.row,t.col,G(t),B(t))&&n.push(r);return n},e.prototype.GT=function(t,e,n,i){for(var r,o,a,r=this.spans,o=0;o<r.length;o++)if((a=r[o]).intersect(t,e,n,i)&&(-1!==t&&(a.row<t||a.row+G(a)>t+n)||-1!==e&&(a.col<e||a.col+B(a)>e+i)))return!0;return!1},e.prototype.eE=function(t,e,n,i){for(var r,o,a,s,r=!1,o=this.spans,a=0,s=o.length;a<s;a++){if(0<=t||0<=e)for(;a<s&&!o[a].intersect(t,e,n,i);)a++;if(a<s){r=!0;break}}return r},e.prototype.d5=function(t,e,n,i,r){var o,a,s,u,c,f,c,o=this.spans,a=!1;for(r&&(s=[].concat(o)),u=0;u<o.length;u++)f=(c=o[u]).row,c=c.col,(-1===t||t<=f&&f<t+n)&&(-1===e||e<=c&&c<e+i)&&(this.removeSpan(u,1),u--,a=!0);r&&(a?(r[0].push("spans"),r[1]=s,r[2]=[].concat(this.spans)):r.length=0)},e.prototype.iE=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,s=this,u=!1;for(a&&(c=[].concat(s.spans)),f=[],l=[],h=s.spans.length,m=0;m<h;m++)v=(d=s.spans[m]).row,g=d.col,(-1===t||t<=v&&v<t+r)&&(-1===e||e<=g&&g<e+o)?(p=(0,it.Ec)(-1===t?v:n+v-t,-1===e?g:i+g-e,G(d),B(d)),l.push(p),u=!0):(-1===t||n<=v&&v<n+r)&&(-1===e||i<=g&&g<i+o)?u=!0:f.push(d);if(u){if(0<l.length)for(m=0;m<l.length;m++){if(!s.nE(f,0,f.length,p=l[m]))throw new Error(St().Exp_OverlappingSpans);f.push(p)}for(s.spans.length=0,s.cache={},m=0;m<f.length;m++)s.add(f[m]);a&&(a[0].push("spans"),a[1]=c,a[2]=[].concat(s.spans))}else a&&(a.length=0)},e.prototype.rE=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,c,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(n&&(a=[].concat(r)),s=r.length,u=0;u<s;u++)f=(c=r[u]).row,l=c.col,h=G(c),c=B(c),t<=f?(i.update(u,(0,it.Ec)(f+e,l,h,c)),o=!0):t<f+h&&(i.update(u,(0,it.Ec)(f,l,h+e,c)),o=!0);i.suspendUpdatingCache=!1,o&&jt(i,r),n&&(o?(n[0].push("spans"),n[1]=a,n[2]=[].concat(i.spans)):n.length=0)},e.prototype.oE=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,c,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(n&&(a=[].concat(r)),s=r.length,u=0;u<s;u++)f=(c=r[u]).row,l=c.col,h=G(c),c=B(c),t<=l?(i.update(u,(0,it.Ec)(f,l+e,h,c)),o=!0):t<l+c&&(i.update(u,(0,it.Ec)(f,l,h,c+e)),o=!0);i.suspendUpdatingCache=!1,o&&jt(i,r),n&&(o?(n[0].push("spans"),n[1]=a,n[2]=[].concat(i.spans)):n.length=0)},e.prototype.aE=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,d,f,h,v,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(n&&(a=[].concat(r)),s=[],u=r.length,c=0;c<u;c++)l=(f=r[c]).row,h=f.col,d=G(f),f=B(f),t<=l?o=(l<t+e?l+d<=t+e?s.push(c):i.update(c,(0,it.Ec)(t,h,l+d-(t+e),f)):i.update(c,(0,it.Ec)(l-e,h,d,f)),!0):t<l+d&&(h=(0,it.Ec)(l,h,d-k(l+d-t,e),f),i.update(c,h),1===h.rowCount&&1===h.colCount&&s.push(c),o=!0);for(c=s.length-1;0<=c;c--)i.removeSpan(v=s[c],1);i.suspendUpdatingCache=!1,o&&jt(i,r),n&&(o?(n[0].push("spans"),n[1]=a,n[2]=[].concat(i.spans)):n.length=0)},e.prototype.uE=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,d,f,l,v,i=this,r=i.spans,o=!(i.suspendUpdatingCache=!0);for(n&&(a=[].concat(r)),s=[],u=r.length,c=0;c<u;c++)l=(f=r[c]).row,h=f.col,d=G(f),f=B(f),t<=h?o=(h<t+e?h+f<=t+e?s.push(c):i.update(c,(0,it.Ec)(l,t,d,h+f-(t+e))):i.update(c,(0,it.Ec)(l,h-e,d,f)),!0):t<h+f&&(l=(0,it.Ec)(l,h,d,f-k(h+f-t,e)),i.update(c,l),1===l.rowCount&&1===l.colCount&&s.push(c),o=!0);for(c=s.length-1;0<=c;c--)i.removeSpan(v=s[c],1);i.suspendUpdatingCache=!1,o&&jt(i,r),n&&(o?(n[0].push("spans"),n[1]=a,n[2]=[].concat(i.spans)):n.length=0)},e.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?st:t},e.prototype.fromJSON=function(t,e,n){var i,r,o,a,s,a,s;if(t)for(this.spans=[],i=t,r=0;r<i.length;r++)a=G(o=i[r]),s=B(o),a=ut(e)?a:k(a,e),s=ut(n)?s:k(s,n),this.add((0,it.Ec)(o.row,o.col,a,s))},wt=e,Kt.prototype.pop=function(){return at},Kt.prototype.push=function(t){return 0},Kt.prototype.splice=function(t,e){for(var n,i,n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return at},Kt.prototype.slice=function(t,e){return null},(L=Kt).prototype=[],c(zt,Ft=L),zt.prototype.find=function(t){for(var e,n,i,r,o,e=this,n=e.length,r=[],o=0;o<n;o++)(i=e[o]).contains(t)&&r.push(i);return r},g.K8=zt,Wt.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},g.Q8=Wt,n.prototype.getProperty=function(t){return this[t]},n.prototype.setProperty=function(t,e,n){n&&(n[0].push(t),n[1]=this[t],n[2]=e),this[t]=e},n.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},n.prototype.add=function(t,e,n,i,r,o){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var r=this,a=r.selectionPolicy,s=r.selectionUnit;0===a?(n=k(n,1),i=k(i,1),r.clear()):1===a&&r.clear(),1===s?i=e=-1:2===s&&(n=t=-1),r.selections.push((0,it.Ec)(t,e,n,i)),!1!==o&&(r.activeSelectedRangeIndex=r.selections.length-1)},n.prototype.get=function(){return[].concat(this.selections)},n.prototype.set=function(t,e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},n.prototype.toJSON=function(){var t,e,n,i,r,o,a,t=this,e={},n=t.selectionPolicy,i=t.selectionUnit,r=t.activeSelectedRangeIndex,o=t.selections.length;for(2!==n&&(e.selectionPolicy=n),0!==i&&(e.selectionUnit=i),0!==r&&(e.activeSelectedRangeIndex=r),e.length=o,a=0;a<o;a++)e[a]=t.selections[a];return ot(e)?st:e},n.prototype.fromJSON=function(t,e,n){var i,r,o,a,s,e,n,u,c,f,i=e||200,r=n||20;if(t){for((s=this).clear(),e=t.selectionPolicy,n=t.selectionUnit,u=t.length,ut(u)&&(u=1),c=0;c<u;c++)f=t[c],o=k(f?G(f):1,i),a=k(f?B(f):1,r),s.selections.push((0,it.Ec)(f?f.row:0,f?f.col:0,o,a));s.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,ut(e)||(s.selectionPolicy=e),ut(n)||(s.selectionUnit=n)}},n.prototype.T9=function(t){for(var e,n,i,r,e=this.selections,n=0;n<e.length;n++)if(r=-1===(i=e[n]).col?0:i.col,-1===i.row&&r<=t&&t<r+B(i))return!0;return!1},n.prototype.S9=function(t){for(var e,n,i,r,e=this.selections,n=0;n<e.length;n++)if(r=-1===(i=e[n]).row?0:i.row,-1===i.col&&r<=t&&t<r+G(i))return!0;return!1},n.prototype.ni=function(t,e,n,i,r,o){for(var a,s,u,c,f,l,h,d,v,d,v,a=!1,s=this.selections,u=o?1:0,c=0,f=s.length;c<f&&(d=(h=Jt(l=s[c],i,r)).row,v=h.col,d=d-u<=t&&t<d+G(h)+u,v=v-u<=e&&e<v+B(h)+u,3===n||ut(n)?a=d&&v:2===n?a=d:1===n?a=v:0===n&&(a=-1===l.row&&-1===l.col),!a);c++);return a},n.prototype.ei=function(t,e,n,i,r){for(var o,a,s,u,c,f,l,u,h,d,c,c,o=this.selections,a=!1,s=0;s<o.length&&(c=(u=o[s]).row,f=u.col,l=G(u),u=B(u),h=-1===f,d=-1===c,ut(n)||3===n||(2===n?(c=d?0:c,a=h&&c<=t&&t<c+l):1===n?(c=h?0:f,a=d&&c<=e&&e<c+u):0===n&&(a=d&&h&&l===i&&u===r),!a));s++);return a},yt=n,c(i,_t=L),i.prototype.findCell=function(t,e){for(var n,i,r,n=this.length,r=0;r<n;r++)if((i=this[r]).contains(t,e))return i;return at},i.prototype.sE=function(){this.cE={}},i.prototype.fE=function(t,e){this.cE[t]=e},i.prototype.findRow=function(t){var e,n,i,r,e=this.cE;if(e)return e[t];for(n=this.length,r=0;r<n;r++)if((i=this[r]).row===t)return i;return at},i.prototype.findRowSpacing=function(t,e,n){for(var i,r,o,i=this.length,o=0;o<i;o++)if((r=this[o]).row===t&&r.spacingIndex===e&&!!r.isAfterSpacing==!!n)return r;return at},i.prototype.findCol=function(t){for(var e,n,i,e=this.length,i=0;i<e;i++)if((n=this[i]).col===t)return n;return at},i.prototype.findLargestRow=function(t){var e,n,i,r,o,e=this.length;if(0===e)return at;for(r=n=0;r<e;r++)(o=this[r]).row===t&&o.height>n&&(n=o.height,i=r);return q(i)&&this[i]},i.prototype.findLargestCol=function(t){var e,n,i,r,o,e=this.length;if(0===e)return at;for(r=n=0;r<e;r++)(o=this[r]).col===t&&o.width>n&&(n=o.width,i=r);return q(i)&&this[i]},i.prototype.findLargestRange=function(t,e){var n,i,r,o,a,s,u,c,f,l,n=this.length;if(0===n)return at;for(i=t.row,r=t.col,o=t.rowCount,a=t.colCount,c=u=0;c<n;c++)if(e)for(f=t.row;f<i+o;f++)(l=this[c]).row===f&&l.height>u&&(u=l.height,s=c);else for(f=t.col;f<r+a;f++)(l=this[c]).col===f&&l.width>u&&(u=l.width,s=c);return q(s)&&this[s]},i.prototype.findX=function(t,e){return Zt(this,st,st,t,st,e)},i.prototype.findY=function(t){return Zt(this,st,st,st,t)},i.prototype.findNearX=function(t,e){return Qt(this,t,st,e)},i.prototype.findNearY=function(t,e){return Qt(this,st,t,e)},i.prototype.findXByExactY=function(t,e,n){var i,t,r,o,a,s,i=this.findX(t,!0);if(!Array.isArray(i))return i;for(t=i.length,r=n.y,o=n.height,a=t-1;0<=a;a--)if(e>r+(s=i[a]).y*o)return s},g.h9=i,Xt.prototype.contains=function(t,e){var n=this;return t<n.row+G(n)&&n.row<=t&&e<n.col+B(n)&&n.col<=e},Xt.prototype.intersect=function(t){var e=this;return(e.x<0||t.x<e.x+e.width&&e.x<t.x+t.width)&&(e.y<0||t.y<e.y+e.height&&e.y<t.y+t.height)},Xt.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},Xt.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},g.W8=Xt,g.copyDefaultFormula=se,r.prototype.dispose=function(){this.Mf=at,this.defaultCellData=at},r.prototype.getRowCount=function(){return this.Sx},r.prototype.setRowCount=function(t){this.Sx=t},r.prototype.getColumnCount=function(){return this.Tx},r.prototype.setColumnCount=function(t){this.Tx=t},r.prototype.X1e=function(t,e,n,i,r,o){var a;e&&(a=void 0,t&&(a=o===rt.DefaultChangeValueType.Expression?t.expr:t.value),e[0].push(vt,n,i,o),e[1]=ut(a)?at:a,e[2]=r)},r.prototype.Uve=function(t,e){var n=this;n.x8<e&&(n.x8=e),n.I8<t&&(n.I8=t)},r.prototype.q1e=function(t,e){var n,t=this.defaultCellData[t],i;return i=ut(t)?i:t[e]},r.prototype.getValue=function(t,e){var n=this,i;return t<n.Sx&&e<n.Tx&&(i=0<=t&&0<=e?n.q1e(t,e):i)&&!ut(i.value)?i.value:at},r.prototype.setValue=function(t,e,n,i,r){var o,a,o,s,r,a=this;t<a.Sx&&e<a.Tx&&0<=t&&0<=e&&(s=(o=a.defaultCellData)[t],ut(s)&&(s=o[t]={}),n=it.util.Z0(n),a.X1e(s[e],r,t,e,n,rt.DefaultChangeValueType.Value),i?(s[e]||(s[e]={}),s[e].value=n):(r=null==(o=s[e])?void 0:o.value,s[e]&&s[e].expr&&a.$1e(t,e,at),s[e]={value:n},a.Uve(t,e),a.Gve&&N(a.Gve,t,e,r,n)))},r.prototype.getFormulaFromExpression=function(t,e,n){var t,i,r,o,i,i=this;if(t)return o=void 0,(r=h("SheetsCalc"))&&((i=i.Mf).vle=!0,o=r.expressionToFormula(i,t,e,n,(null==(t=i.parent)?void 0:t.options.referenceStyle)===r.ReferenceStyle.r1c1),delete i.vle),it.util.g1(o)},r.prototype.getFormula=function(t,e){var n,i,i,n=this;return t<n.Sx&&e<n.Tx&&(i=0<=t&&0<=e?n.q1e(t,e):i)&&i.expr?(i=i.expr,n.getFormulaFromExpression(i,t,e)):at},r.prototype.getExpression=function(t,e){var n=this,i;return t<n.Sx&&e<n.Tx?(i=0<=t&&0<=e?n.q1e(t,e):i)&&i.expr:at},r.prototype.$1e=function(t,e,n,i,r,o){var a,s,u,a,c,a=this,s,u=a.defaultCellData[t];if(u&&u[e]&&u[e].expr&&(c=(a=a.Mf).op()))try{a.vle=!0,o&&(u[e].value=at,i=u[e].expr),a.zI(t,e,n,i,!1,r,!0,!0)}finally{delete a.vle}},r.prototype.setFormula=function(t,e,n,i,r,o){var a,s,u,c,f,u,l,a,u,s=this;t<s.Sx&&e<s.Tx&&0<=t&&0<=e&&(c=(u=s.defaultCellData)[t],f=void 0,(c=ut(c)?u[t]={}:c)[e]||(c[e]={}),n&&((u=h("SheetsCalc"))&&(a=(null==(a=(l=s.Mf).parent)?void 0:a.options.referenceStyle)===u.ReferenceStyle.r1c1,f=u.formulaToExpression(l,n,t,e,a,!0),n=u.expressionToFormula(l,f,t,e,a)),n=it.util.g1(n)),s.X1e(c[e],o,t,e,f,rt.DefaultChangeValueType.Expression),u=c[e].expr,c[e].expr=f,s.Uve(t,e),s.Gve&&N(s.Gve,t,e,u,f),R?r||s.$1e(t,e,n,f,i):(s.X1e(c[e],o,t,e,n,rt.DefaultChangeValueType.Value),c[e].value=n))},r.prototype.resetFormulaToCalc=function(t,e,n,i,r){var o=this,a=o.Sx,s=o.Tx,u,c;if(0<=t&&0<=e&&(n=k(n,a-t),i=k(i,s-e),0<n)&&0<i)for(c=t;c<t+n;c++)for(u=e;u<e+i;u++)o.$1e(c,u,at,at,r,!0)},r.prototype.gle=function(){return this.defaultCellData},r.prototype.ble=function(t){var e,n,i,r;if(t)for(e in t)if(t.hasOwnProperty(e)&&(n=t[e]))for(i in n)n.hasOwnProperty(i)&&(r=n[i])&&r.expr&&(r.oldRow=e,r.oldCol=i)},r.prototype.hE=function(t){var e,n=this.Gve,i={};if(!ut(n))return t&rt.UsedRangeType.data&&d(i,n.getUsedRange()),i},r.prototype.rE=function(t,e){var n,i,r,n=this,i=n.Sx;0<=t&&t<=i&&0<=e&&(r=n.defaultCellData,n.ble(r),u(r,i,t,e),n.Sx+=e,n.Gve)&&this.Gve.addHeadInfo(t,e,!0)},r.prototype.yE=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,i=this,r=i.Sx;if(0<=t&&t<r&&0<e){if(r<t+e&&(e=r-t),o=i.defaultCellData,n)for(a=0;a<e;a++)n.push([[vt,s=t+a],o[s]]);if(i.Gve){for(c=(u=t)+e,f=i.defaultCellData,l=void 0;u<c;u++)if(f[u])for(h=0;h<i.Tx;h++)!(l=f[u]&&f[u][h])||ut(l.value)&&!l.expr||i.Gve.removeRowAndColInfo(u,h);i.Gve.removeHeadInfo(t,e,!0)}i.ble(o),b(o,r,t,e),i.Sx-=e}},r.prototype.oE=function(t,e){var n,i,r,o,a,n=this,i=n.Tx;if(0<=t&&t<=i&&0<=e){for(r=n.defaultCellData,n.ble(r),o=0;o<n.Sx;o++)(a=r[o])&&t<i&&u(a,i,t,e);n.Tx+=e,n.Gve&&n.Gve.addHeadInfo(t,e,!1)}},r.prototype.wE=function(t,e,n){var i,r,o,a,s,u,c,f,i=this,r=i.Tx;if(0<=t&&t<r&&0<e){for(o=i.defaultCellData,a=void 0,i.ble(o),s=0;s<i.Sx;s++)if(u=o[s]){if(n)for(c=0;c<e;c++)a=u[f=t+c],n.push([[vt,s,f],a]),a&&i.Gve&&(ut(a.value)&&!a.expr||i.Gve.removeRowAndColInfo(s,f));b(u,r,t,e)}i.Tx-=e=r<t+e?r-t:e,i.Gve&&i.Gve.removeHeadInfo(t,e,!1)}},r.prototype.SE=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,r;r&&(o=[[y,3],st],a=[[y,3],st],s=[[y,3],st],u=[[y,3],st],r.push(o,a,s,u)),f=(c=this).defaultCellData,l=c.q1e(t,e),h=c.q1e(n,i),r&&(c.X1e(l,o,t,e,h.value,rt.DefaultChangeValueType.Value),c.X1e(h,a,n,i,l.value,rt.DefaultChangeValueType.Value),c.X1e(l,s,t,e,h.expr,rt.DefaultChangeValueType.Expression),c.X1e(h,u,n,i,l.expr,rt.DefaultChangeValueType.Expression)),r=c.Gve,l?ne(n,i,l,f,r):h&&ne(n,i,at,f,r),h?ne(t,e,h,f,r):l&&ne(t,e,at,f,r)},r.prototype.fromJSON=function(t){var o,a,s,e,n;if(t)for(a in(o=this).defaultCellData={},t)if(t.hasOwnProperty(a)&&(s=t[a]))for(n in e=function(t){var e,n,i,r;if(!s.hasOwnProperty(t)||!s[t])return"continue";try{e=s[t],n=+a,i=+t,e.f&&o.setFormula(n,i,it.util.n1(e.f),st,!0),r=e.v,ut(r)||(r.error&&!ut(r.code)||r._calcError&&!ut(r._code)?r=R&&U.CalcError.parse(r.error||r._calcError):"SparklineExValue"===r.typeName?r.toString=function(){return r.value&&!ut(r.value.altText)?r.value.altText+"":""}:r.richText&&Q(r),o.setValue(n,i,r,!!e.f))}catch(t){}},s)e(n)},r.prototype.toJSON=function(t){var e,n,i,r,o,a,s,u,c,u,c,e=this,n=e.defaultCellData,i={};if(n)for(r in n)if(n.hasOwnProperty(r)&&(o=n[r]))for(a in i[r]||(i[r]={}),o)o.hasOwnProperty(a)&&(s=o[a])&&(ut(s.value)||(c=u=s.value,t&&(u&&u instanceof Date?c=u.toISOString():ut(u._error)&&ut(u._code)?u&&u.richText&&(u.converted=st):c={error:u._error,code:u._code}),i[r][a]={v:c}),u=s.expr)&&(i[r][a]||(i[r][a]={}),c=e.getFormulaFromExpression(u,+r,+a),i[r][a].f=it.util.vo(c));return i},r.prototype.yh=function(t){this.fromJSON(t)},r.prototype.wh=function(t){var e;if(X(t))return this.toJSON(!0)},Tt=r,o.prototype.Hc=function(){var t=this;t.dataTable={},t.rowDataArray=[],t.columnDataArray=[],t.defaultDataNode=at,t.B8={},t.lE=0,t.x8=-1,t.I8=-1},o.prototype.z8=function(){var t;this.a8={data:new it.BaseUsedRange,style:new it.BaseUsedRange}},o.prototype.hE=function(t){var e,n=this.a8,i={};if(!ut(n))return t&rt.UsedRangeType.data&&d(i,n.data.getUsedRange()),t&rt.UsedRangeType.style&&d(i,n.style.getUsedRange()),t&rt.UsedRangeType.rowStyle&&d(i,n.style.getRowUsedRange()),t&rt.UsedRangeType.colStyle&&d(i,n.style.getColUsedRange()),i},o.prototype.getRowCount=function(){return this.Sx},o.prototype.getColumnCount=function(){return this.Tx},o.prototype.setRowCount=function(t){this.Sx=t},o.prototype.setColumnCount=function(t){this.Tx=t},o.prototype.getFreeAreaRowCount=function(){return this.j8},o.prototype.getFreeAreaColumnCount=function(){return this.O8},o.prototype.setFreeAreaRowCount=function(t){this.j8=t},o.prototype.setFreeAreaColumnCount=function(t){this.O8=t},o.prototype.dE=function(t,e,n,i,r){var o,a,s,o,s,o,a,t,o=this,a=o.B8;if(!(0<o.lE)){if(o=t+"_"+e,(s=this.B8.vE)&&s[o]){if(s[o].oldCalcValue===n.mE)return;delete s[o]}0<=t&&0<=e&&(i&&(i.type="updateDirty",i.row=t,i.col=e,i.skipUndo=r,a[t]?a[t][e]||(i.isEmptyCol=!0):i.isEmptyRow=!0),a[t]||(a[t]={}),(s=a[t])[e]||(s[e]={}),o=s[e],"n"!==s.rs&&(s.rs="e"),a=n.gE,t=n.d6,ut(a)||(i&&(i.originalItem=s.originalItem),s.originalItem=a),ut(t)||(i&&(i.oldValue=o.oldValue,r)&&(i.oldCalcValue=t),o.oldValue=t))}},o.prototype.pE=function(t){var e,n,i,e=this.B8,n=t.row,i=t.col;t.skipUndo&&(this.B8.vE=this.B8.vE||{},this.B8.vE[n+"_"+i]=t),t.isEmptyRow&&e?delete e[n]:t.isEmptyCol&&e[n]?delete e[n][i]:(t.hasOwnProperty("originalItem")&&(ut(t.originalItem)&&!ut(e[n].originalItem)?delete e[n].originalItem:e[n].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&e[n]&&(ut(t.oldValue)&&!ut(e[n][i].oldValue)?delete e[n][i].oldValue:e[n][i].oldValue=t.oldValue))},o.prototype.getValue=function(t,e,n){var t=this.J_(t,e);return t&&!ut(t.value)?1!==n?Z(t.value):ut(t.value.richText)?t.value:j(!0,{},t.value):at},o.prototype.setValue=function(t,e,n,i,r,o){var a,s,a=this.J_(t,e,!0,i?i[0]:st);!a||ut(a.value)&&ut(n)||a.value===n?i&&(i.length=0):(s=a.value,a.value=n,this.dE(t,e,{d6:s,mE:n},r,o),i&&(i[0].push("value"),i[1]=s,i[2]=n),this.a8&&(n&&"SparklineExValue"===n.typeName&&("IMAGE"===n.name&&(a.altText=n.value&&n.value.altText),n=at),N(this.a8.data,t,e,s,n)))},o.prototype.getStyle=function(t,e,n){var t,e,t=this.J_(t,e),e=t&&t.style;return e=e&&n&&e.clone?e.clone(!0):e},o.prototype.setStyle=function(t,e,n,i,r,o){var a,s,a,r,a=this.J_(t,e,!0,i?i[0]:st);a&&a.style!==n?(s=a.style,a.style=n,i&&(i[0].push("style"),a=function(){i.push(s),i.push(n)},r&&o&&s&&n&&"object"==typeof s&&"object"==typeof n&&this.HCe(s)&&this.HCe(n)&&-1!==(r=this.LCe(i,s,n,r,o))?i.push(r):a()),this.a8&&N(this.a8.style,t,e,s,n)):i&&(i.length=0)},o.prototype.getFileGUID=function(t,e){var t=this.J_(t,e);return t&&!ut(t.fileGUID)?t.fileGUID:at},o.prototype.setFileGUID=function(t,e,n,i,r){var o,a,o=this.J_(t,e,!0,i?i[0]:st);!o||ut(o.fileGUID)&&ut(n)||o.fileGUID===n?i&&(i.length=0):(a=o.fileGUID,o.fileGUID=n,this.dE(t,e,{d6:a,mE:n},r),i&&(i[0].push("fileGUID"),i[1]=a,i[2]=n))},o.prototype.HCe=function(t){return!(t.cellButtons&&t.cellButtons.some(function(t){return t.command&&"function"==typeof t.command})||t.dropDowns&&t.dropDowns.some(function(t){return t.submitCommand&&"function"==typeof t.submitCommand}))},o.prototype.FCe=function(t,e){var n,e,t,n,e=he(e,fe(t)),t=le(t);return e&&e.change[t]!==st?e.change[t]:null},o.prototype.LCe=function(t,e,n,i,r){var t,o,a,i,s,u,i,t=this.FCe(t,i);return t!==at&&"number"!=typeof t?-1:(o=function(t,e,n){var i,r;return mt.includes(n)&&t&&e?t.color===e.color&&t.style===e.style&&t.level===e.level:pt.includes(n)&&t&&e?JSON.stringify(t)===JSON.stringify(e):t===e},a=Object.keys(e),i=Object.keys(n).filter(function(t){return!a.includes(t)}),s={},a.forEach(function(t){"_id"===t||o(e[t],n[t],t)||(s[t]={old:e[t],new:n[t]})}),i.forEach(function(t){s[t]={old:void 0,new:n[t]}}),t!==at&&"number"==typeof t&&r[t]&&this.BCe(r[t],s),u=Object.keys(s),-1!==(i=r.findIndex(function(e){return u.length===Object.keys(e).length&&u.every(function(t){return e[t]&&o(e[t].old,s[t].old,t)&&o(e[t].new,s[t].new,t)})}))?i:(r.push(s),r.length-1))},o.prototype.BCe=function(e,n){var t;Object.keys(e).forEach(function(t){n[t]?n[t].old=e[t].old:n[t]=e[t]})},o.prototype.getCellState=function(t,e){var t=this.J_(t,e);return t?t.cellState:at},o.prototype.setCellState=function(t,e,n,i){var i,r,o=this.getCellState(t,e)||0,i=i?o|n:o&~n;0!==i?(r=this.J_(t,e,!0,st,!0))&&(r.cellState=i):((r=this.J_(t,e))&&delete r.cellState,ot(r)&&(ve(this.dataTable,t,e),ot(this.dataTable[t]))&&delete this.dataTable[t])},o.prototype.getValueForKey=function(t,e,n){var t=this.J_(t,e);return t&&t[n]},o.prototype.setValueForKey=function(t,e,n,i,r){var o,a,o=this.J_(t,e,!0,r?r[0]:st);o&&o[n]!==i?(a=o[n],o[n]=i,r&&(r[0].push(n),r[1]=a,r[2]=i),this.bE(t,e,n,a,i)):r&&(r.length=0)},o.prototype.bE=function(t,e,n,i,r){var o,a=this.a8;n===et&&a&&N(a.data,t,e,i,r)},o.prototype.rE=function(t,e,n){var i,r,o,a,s,i=this,r=i.Sx,o=i.dataTable,a=i.B8;if(0<=t&&t<=r&&0<=e){if(u(o,r,t,e),u(i.rowDataArray,r,t,e),u(a,r,t,e),i.Sx+=e,!n)for(s=0;s<e;s++)o[t+s]={rs:"n"},a[t+s]={rs:"n"};this.a8&&(this.a8.data.addHeadInfo(t,e,!0),this.a8.style.addHeadInfo(t,e,!0))}},o.prototype.yE=function(t,e,n){var i,r,o,a,s,u,c,f,l,i=this,r=i.Sx;if(0<=t&&t<r&&0<e){if(r<t+e&&(e=r-t),n)for(o=0;o<e;o++)n.push([["dataTable",a=t+o],i.dataTable[a]]),n.push([["rowDataArray",a],i.rowDataArray[a]]),n.push([[Y,a],i.B8[a]]);if(this.a8){for(u=(s=t)+e,c=i.dataTable,f=void 0;s<u;s++)if(c[s])for(l=0;l<i.Tx;l++)(f=c[s]&&c[s][l])&&(ut(f.value)&&ut(f.bindingPath)||this.a8.data.removeRowAndColInfo(s,l),f.style)&&this.a8.style.removeRowAndColInfo(s,l);this.a8.data.removeHeadInfo(t,e,!0),this.a8.style.removeHeadInfo(t,e,!0)}b(i.dataTable,r,t,e),b(i.rowDataArray,r,t,e),b(i.B8,r,t,e),i.Sx-=e}},o.prototype.oE=function(t,e){var n,i,r,o,a,a,n=this,i=n.Tx,r=n.B8;if(0<=t&&t<=i&&0<=e){for(o=0;o<n.Sx;o++)(a=n.dataTable[o])&&t<i&&(u(a,i,t,e),a=r[o])&&oe(a,t,e);u(n.columnDataArray,i,t,e),n.Tx+=e,this.a8&&(this.a8.data.addHeadInfo(t,e,!1),this.a8.style.addHeadInfo(t,e,!1))}},o.prototype.wE=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,d,v,i=this,r=i.Tx,o=i.B8,a=i.dataTable;if(0<=t&&t<r&&0<e){for(u=0;u<i.Sx;u++)if(c=i.dataTable[u]){if(n)for(f=0;f<e;f++)n.push([["dataTable",u,l=t+f],c[l]]),i.B8[u]&&n.push([[Y,u,l],i.B8[u][l]]),(s=a[u]&&a[u][l])&&this.a8&&(ut(s.value)&&ut(s.bindingPath)||this.a8.data.removeRowAndColInfo(u,l),s.style)&&this.a8.style.removeRowAndColInfo(u,l);b(c,r,t,e),ae(h=o[u],t,e)}if(n)for(d=0;d<e;d++)n.push([["columnDataArray",v=t+d],i.columnDataArray[v]]);b(i.columnDataArray,r,t,e),i.Tx-=e=r<t+e?r-t:e,this.a8&&(this.a8.data.removeHeadInfo(t,e,!1),this.a8.style.removeHeadInfo(t,e,!1))}},o.prototype.ME=function(t,e,n,i){var r=this,o=t[e];return n&&(o=o||(t[e]={}),!i)&&e>r.I8&&(r.I8=e),o},o.prototype.CE=function(t,e,n,i){var r,o;if(t)return r=this,o=t[e],n&&(o=o||(t[e]={}),!i)&&r.x8<e&&(r.x8=e),o},o.prototype.J_=function(t,e,n,i,r){var o,a,s,u,c,a,o=this,a=o.dataTable,s=o.columnDataArray,u=o.rowDataArray,c=at;return t<o.Sx&&e<o.Tx&&(0<=t&&0<=e?(a=o.ME(a,t,n,r),c=o.CE(a,e,n,r),i&&i.push("dataTable",t,e)):-1===t&&0<=e?(c=s[e],n&&(c=c||(s[e]={}),!r)&&o.x8<e&&(o.x8=e),i&&i.push("columnDataArray",e)):0<=t&&-1===e?(c=u[t],n&&(c=c||(u[t]={}),!r)&&o.I8<t&&(o.I8=t),i&&i.push("rowDataArray",t)):-1===t&&-1===e&&(c=o.defaultDataNode,n&&!c&&(c=o.defaultDataNode={}),i)&&i.push("defaultDataNode")),c},o.prototype.setNode=function(t,e,n){var i,r,o,a,s,i=this,r=i.dataTable,o=i.columnDataArray,a=i.rowDataArray;t<i.Sx&&e<i.Tx&&(0<=t&&0<=e?(s=(s=r[t])||(r[t]={}))[e]=n:-1===t&&0<=e?o[e]=n:-1===e&&0<=t&&(a[t]=n))},o.prototype.SE=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p;r&&(o=[],a=[]),u=(s=this).dataTable,c=s.rowDataArray,f=s.columnDataArray,l=s.B8,h=s.J_(t,e,st,o),d=l[t]&&l[t][e],v=l[t]&&l[t].originalItem,g=s.J_(n,i,st,a),m=l[n]&&l[n][i],p=l[n]&&l[n].originalItem,r&&(r.push([o,h]),r.push([a,g])),h?ie(t,e,n,i,h,u,c,f,s):g&&ie(t,e,n,i,at,u,c,f,s),g?ie(n,i,t,e,g,u,c,f,s):h&&ie(n,i,t,e,at,u,c,f,s),d?re(t,e,n,i,d,l,v):m&&re(t,e,n,i,at,l,v),m?re(n,i,t,e,m,l,p):d&&re(n,i,t,e,at,l,p)},o.prototype.gT=function(t){t++;for(var e=this.Sx,n=this.dataTable;0<=t&&t<e&&!n[t];)t++;return t<e?t:-1},o.prototype.pT=function(t,e){var n,i,r,n=this,i=at,r=n.Tx;if(i=0<=t&&t<n.Sx?n.dataTable[t]:i){for(e++;0<=e&&e<r&&!i[e];)e++;if(e<r)return e}return-1},o.prototype.TE=function(t,e,n){var n=n&&n.getFormatter(t,e);return!!lt(n)&&n},o.prototype.clear=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,s=this,u=s.Sx,c=s.Tx,f=[],l=[],g=!!a,m=[];if(0<=t&&0<=e){if(n=k(n,u-t),i=k(i,c-e),0<n&&0<i)for(v=t;v<t+n;v++)if(!o||M.Common.Uf.hD(o,v)<0)for(d=e;d<e+i;d++)g&&(p=[]),(h=s.J_(v,d,st,p))&&(f.push(h),l.push({r:v,c:d}),g&&m.push(p),0<(1&r))&&!ut(h.value)&&(S=g?{}:void 0,s.dE(v,d,{d6:h.value},S),S)&&a.push(S)}else if(0<=t&&-1===e){if(0<(n=k(n,u-t)))for(v=t;v<t+n;v++)g&&(p=[]),(h=s.J_(v,-1,st,p))&&(f.push(h),l.push({r:v,c:d}),g)&&m.push(p)}else if(-1===t&&0<=e){if(0<(i=k(i,c-e)))for(d=e;d<e+i;d++)g&&(p=[]),(h=s.J_(-1,d,st,p))&&(f.push(h),l.push({r:v,c:d}),g)&&m.push(p)}else-1===t&&-1===e&&(g&&(p=[]),h=s.J_(-1,-1,st,p))&&(f.push(h),l.push({r:v,c:d}),g)&&m.push(p);for(s.a8&&(w=s.a8.style,b=s.a8.data),C=function(n){var t;(h=f[n])&&(t=g?[]:st,0<(8&r)&&(t&&t.push(["tag",h.tag]),h.tag=at),0<(2&r)&&(t&&t.push(["style",h.style]),w&&N(w,l[n].r,l[n].c,h.style,at),h.style=at),0<(1&r)&&(t&&(t.push(["value",h.value]),t.push(["fileGUID",h.fileGUID])),b&&N(b,l[n].r,l[n].c,h.value,at),h.value=at,h.fileGUID=at),0<(16&r)&&(t&&t.push(["sparkline",h.sparkline]),h.sparkline=at),0<(64&r)&&(t&&t.push(["bindingPath",h.bindingPath]),b&&N(b,l[n].r,l[n].c,h.bindingPath,at),h.bindingPath=at),0<(256&r)&&(t&&t.push(["hyperlink",h.hyperlink]),h.hyperlink=at),0<(4&r)&&(t&&t.push(["comment",h.comment]),h.comment=at),0<(512&r)&&(t&&t.push(["altText",h.altText]),h.altText=at),g)&&t.forEach(function(t){var e=[].concat(m[n]);e.push(t[0]),t[0]=e,a.push(t)})},y=0;y<f.length;y++)C(y)},o.prototype.toJSON=function(t,l,h){var d,v,e,n,i,r,o,a,s,u,c,f,g,m,p,S,w,b,C,y,M,k,T,x,G,t;function B(t,e,n,i,r,o){var a,s,u,c,u,o,t,f,e,u,o,t,i,r;return n&&(u=n.value,c=s=!(a={}),ut(u)||(u.richText&&(u.converted=st),n.fileGUID&&(a.fileGUID=n.fileGUID,v.push(n.fileGUID)),a.value=u,s=!0),l&&l.saveAsView&&(u=void 0,o?u=o:d&&(u=h&&h.getFormatter(t,e)),u)&&lt(u)&&(c=!0,o=h.Oe(t,e,i,u),ut(o)||(a.value=o,s=!0)),!ut(t=a.value)&&"object"==typeof t&&0<Object.keys(t).length&&(a.value=Ne(t)),(f=l&&l.ignoreStyle)||(e=n.style)&&!ot(e)&&("string"==typeof e?(a.style=e,s=!0):(u=e.toJSON(i,r))&&(c&&(u.formatter=void 0),u.name=st,u.fontForColumnWidth=e.fontForColumnWidth,a.style=u,s=!0)),o=n.bindingPath,ut(o)||(a.bindingPath=o,s=!0),t=n.tag,ut(t)||(a.tag=t,s=!0),i=n.altText,ut(i)||(a.altText=i,s=!0),r=n.hyperlink,ut(r)||(a.hyperlink=ct(r),delete a.hyperlink.isVisited,s=!0),!0===s)?a:at}if(d=h&&h.parent&&!ot(h.parent.bp),v=[],n={},i={},r=(e=this).Sx,o=e.Tx,a=e.dataTable,s=e.rowDataArray,u=e.columnDataArray,l&&l.saveAsView)for(g=0,m=3===t&&d;g<r;){if((p=a[g])||m){for(w=!(S={}),b=0;b<o;)C=void 0,p&&p[b]?C=B(g,b,p[b]):m&&(y=this.TE(g,b,h))&&(p=p||e.ME(a,g,!0),C=B(g,b,e.CE(p,b,!0),3,!1,y)),ut(C)||(S[b]=C,w=!0),b++;w&&(i[g]=S)}g++}else for(c=e.gT(-1);0<=c;){for(w=!(S={}),f=e.pT(c,-1);0<=f;)(M=e.J_(c,f))&&(C=B(c,f,M),ot(C)||(S[f]=C,w=!0)),f=e.pT(c,f);w&&(i[c]=S),c=e.gT(c)}for(ot(i)||(n.dataTable=i),k=[],c=0;c<r;c++)I(s,c)&&s[c]&&(T=B(c,-1,s[c]),ot(T)||(k[c]=T));for(0<k.length&&(n.rowDataArray=k),x=[],f=0;f<o;f++)I(u,f)&&u[f]&&(G=B(-1,f,u[f]),ot(G)||(x[f]=G));return 0<x.length&&(n.columnDataArray=x),t=B(-1,-1,e.defaultDataNode,t,!0),ot(t)||(n.defaultDataNode=t),v.length&&(n.usedAttachmentFileGUIDs=v),n},o.prototype.fromJSON=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,o,s=n&&n.incrementalLoading;if(t){if((u=this).Hc(),u.lE++,c=t.dataTable,h=u.Sx,d=u.Tx,c?s&&3===o?$t(u,c,h,d,n,e,st,a,u.a8,i,r):te(u,c,h,d,n,e,u.a8,i,r):s&&a&&setTimeout(a,0),m=t.rowDataArray||t.AE)for(f=0;f<h;f++)I(m,f)&&m[f]&&ue(m[f],u.J_(f,-1,!0),e,f,-1,n,u.a8);if(p=t.columnDataArray||t.IE)for(l=0;l<d;l++)I(p,l)&&p[l]&&ue(p[l],u.J_(-1,l,!0),e,-1,l,n,u.a8);(o=t.defaultDataNode||t.xE)&&ue(o,u.J_(-1,-1,!0),e,-1,-1,n,u.a8),u.lE--}else s&&a&&setTimeout(a,0)},o.prototype.wh=function(t,F,e,_,n,i){var r,A,L,D,j,O,V,o,Y,a,K,s,i,z,a,u,i,W,J,c,f,l,h,d,v,g,v,Z,m,p,S,w,w,b,C,y,M,Q,k,T,x,G,B,I,P,R,N,E,H,X,q,$,tt,E,N,U,N,et,R,r=this,A=0,L=0,D=r.Sx,j=r.Tx,O=r.dataTable,V=[],o=i&&!1===i.includeStyles,Y=i&&i.saveAsView,a=i&&!1===i.includeEmptyRegionCells,K=t&&t.parent&&!ot(t.parent.bp),s=i&&i.fileType===rt.OpenSaveFileType.excel,z=[];for(a&&(i=rt.UsedRangeType.all-rt.UsedRangeType.colStyle-rt.UsedRangeType.rowStyle-rt.UsedRangeType.style-rt.UsedRangeType.axis,a=t.getUsedRange(i))&&(A=a.row,L=a.col,-1!==a.rowCount&&(D=a.row+a.rowCount),-1!==a.colCount)&&(j=a.col+a.colCount),i={sheetData:u={n_:ft.XFileConstants.bo,rowCount:r.Sx,colCount:r.Tx},hyperlinks:V},W=!t.NMi&&t.getDefaultStyle(3),Object.keys(F).forEach(function(t){var e,n,i,e,t,e=F[t],n=e&&e.size,i=!ut(n)&&n!==_,e=e&&!1===e.visible?1:st;!0!=i&&!e||((t=u[t]={}).h=i&&n!==st?+it.SJSColumnWidthHelper.pixelToPoint(n).toFixed(2):st,t.v=e)}),J=s?t.Ut.yle().gle():{},c=A;c<D;c++){if(f=u[c]||{r:c+1},l=O[c],h=J[c],d=void 0,g=(v=r.J_(c,-1))&&v.style,ut(g)||o||(s?("string"==typeof g&&0===g.indexOf(e.Jd)&&(v=g,g=(g=t.i3(v,!1))||(Z=t.parent)&&Z.i3(v,!1)),f.s=e.getStyleIndex(g)):"string"==typeof g?f.t=e.getOriginNamedStyleIndex(g,t):g!==st&&(f.e=e.getOriginStyleIndex(g,t)),d=!0),l||h){for(m=L;m<j;m++){if(S={},!(p=l&&l[m]))if(h&&h[m])p=h[m];else if(!s||!t.tables.find(c,m))continue;if(p&&(ut(p.tag)||(S.tag=p.tag),ut(p.altText)||(S.altText=p.altText),w=p.bindingPath,ut(w)||(S.bindingPath=w)),w=r.getStyle(-1,m,!0),b=at,B=null==p?void 0:p.value,I=r.getStyle(c,m,!(G=x=T=k=Q=M=y=C=void 0)),P=null==p?void 0:p.hyperlink,ut(B)&&h&&h[m]&&(B=h[m].value),null!=p&&p.fileGUID&&(G=null==p?void 0:p.fileGUID),N=R=!1,Y&&(!(E=r.TE(c,m,t))&&K&&(E=t.getFormatter(c,m)),lt(E))&&(N=!0,H=t.Oe(c,m,3,E),!ut(H))){switch(X=typeof H){case"boolean":M=H?1:0;break;case"string":x=$=(q=Yt(H,n)).OADateNumber,C=tt=q.valueIndex;break;case"object":C=H instanceof Date?(H=it.util.Z0(H),I.formatter="M/d/yyyy",n.getTextIndex(H)):H;break;default:y=isFinite(H)?H:st}R=!0}if(N&&(I.formatter=void 0),!o)if(s){if(E=P||"string"==typeof B&&"/OADate"===B.substring(0,7)||B!==at&&void 0!==B&&(w||g),I?b=Be(t,I):E?b=new nt.Style:(w||g)&&(N=t.getValue(c,m),ut(N)||(b=new nt.Style)),b){if(b.parentName)for((U=Be(t,b.parentName))&&Ie(t,b,U);U&&U.parentName;)(U=Be(t,U.parentName))&&Ie(t,b,U);g&&Ie(t,b,g),w&&Ie(t,b,w),W&&Ie(t,b,W),b=xe(B,b)}}else"string"==typeof I?k=e.getOriginNamedStyleIndex(I,t):I!==st&&(T=e.getOriginStyleIndex(I,t));if(ut(B)&&(k===st&&T===st&&ut(b)||o)&&ut(P))ot(S)||(f[m]={lossless:S},d=!0);else{if(d=!0,!R&&!ut(B))switch("object"==(N=typeof B)&&0<Object.keys(B).length&&(B=Ne(B)).richText&&(B.converted=st),N){case"boolean":M=B?1:0;break;case"string":x=$=(et=Yt(B,n)).OADateNumber,C=tt=et.valueIndex;break;case"object":C=B&&B.richText?n.getTextIndex(B):B&&B instanceof Date?n.getTextIndex(B.toISOString()):ut(B._error)&&ut(B._code)?B:{error:B._error,code:B._code};break;default:y=isFinite(B)?B:st}ut(P)||(s&&(b?"string"==typeof b&&(b=t.u8(b)):b=new nt.Style,ut(P.linkColor)?P.linkColor===st&&(b.foreColor||b.foreColor===at)||(b.foreColor="hyperlink"):b.foreColor=P.linkColor,P.drawUnderline&&ut(b.textDecoration)?b.textDecoration=1:2!==b.textDecoration&&4!==b.textDecoration||(b.textDecoration+=1)),V.push({row:c,col:m,value:p.value,hyperlink:ct(P)})),R={s:Q=b?e.getStyleIndex(b,3,t.name()):Q,v:C,n:y,b:M,t:k,e:T,o:x,d:G},G&&z.push(G),ot(S)||(R.lossless=S),f[m]=R}}}d&&(u[c]=f)}return z.length&&(u.usedAttachmentFileGUIDs=z),i},o.prototype.yh=function(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,c=this,f={};if(e)for(l=e.colCount,h=0;h<l;h++)(d=c.J_(-1,h))&&d.style&&(f[h]=1);ee(this,t,e,n,i,r,o,a,s,u,f)},xt=o,g.ZTe=xt,a.prototype.NE=function(t,e){var n,i,n=this.infos,i=n[t];return i=!i&&e?n[t]={}:i},a.prototype.kE=function(t,e){var n=this.infos,i=n.length;0<=t&&t<=i&&0<e&&u(n,i,t,e)},a.prototype.DE=function(t,e,n){var i,r,o,a,i=this.infos,r=i.length;if(0<=t&&t<r&&0<e){if(e=k(e,r-t),n)for(o=0;o<e;o++)n.push([["infos",a=t+o],i[a]]);b(i,r,t,e)}},a.prototype._E=function(){return this.infos.length},a.prototype.EE=function(){return this.infos},a.prototype.q_=function(t){return this.infos[t]},a.prototype.X_=function(t,e,n){var i=this.infos[t];this.infos[t]=e,n&&(n[0].push("infos",t),n[1]=i,n[2]=e)},a.prototype.getSize=function(t){var t=this.infos[t],e=at;return t&&(!1===t.visible?e=0:Lt(t.size)&&(e=V(t.size))),e},a.prototype.getColumnHeaderFitMode=function(t){var t=this.infos[t],e=rt.ColumnHeaderFitMode.normal;return e=t?t.columnHeaderFitMode||e:e},a.prototype.setColumnHeaderFitMode=function(t,e,n){var i,r,i=this.NE(t,!0),r=i.columnHeaderFitMode;r!==e&&(i.columnHeaderFitMode=e),n&&(n[0].push("infos",t,"columnHeaderFitMode"),n[1]=r)},a.prototype.getActualSize=function(t){var t=this.infos[t];return t?V(t.size):at},a.prototype.setSize=function(t,e,n){var i,r,i=this.NE(t,!0),r=i.size;r!==e&&(i.size=e),n&&(n[0].push("infos",t,"size"),n[1]=r,n[2]=e)},a.prototype.getStarSize=function(t){var t=this.infos[t];return t?t.starSize:st},a.prototype.setStarSize=function(t,e,n){var i,r,i=this.NE(t,!0),r=i.starSize;ut(e)&&ut(r)||(r!==e&&(ut(e)?delete i.starSize:i.starSize=e),n&&(n[0].push("infos",t,"starSize"),n[1]=r,n[2]=e))},a.prototype.getScrollOffsetX=function(t){var t,e,t=this.q_(t),e=0;return e=t&&Lt(t.scrollOffsetX)?t.scrollOffsetX:e},a.prototype.setScrollOffsetX=function(t,e,n){var t=this.NE(t,!0);n&&(e+=t.scrollOffsetX||0),t.scrollOffsetX=e},a.prototype.getScrollContentWidth=function(t){var e,t,n,e=this.q_(t),t=this.getSize(t),n=t;return e&&Lt(e.scrollContentWidth)&&(n=e.scrollContentWidth),p(n,t)},a.prototype.setScrollContentWidth=function(t,e){var n,t,n=this.NE(t,!0),t=this.getSize(t);n.scrollContentWidth=e=e<t?t:e},a.prototype.getHiddenRows=function(){return this.R8},a.prototype.wh=function(t){return this.infos},a.prototype.yh=function(t,e){var n,i,r,o,a,s,u,n=this,i=t;if(i)for(r=t.rowCount,o=0;o<r;o++)(a=i[o])&&(u=s=void 0,a.h!==st&&(s=Math.round(it.SJSColumnWidthHelper.pointToPixel(a.h))),a.v&&(ut(a.l)||0===a.l)&&(u=!1,n.R8.push(o)),ut(s=!1===u&&0===s?st:s)||n.setSize(+o,s),ut(u)||n.setVisible(+o,u))},a.prototype.toJSON=function(t){var e,n,i,r,o,r,r,a,r,a,e=this.infos,n=[];if(t&&t.ignoreStarSize)for(i=0;i<e.length;i++)ut(e[i])||(o=(r=e[i]).cellType,r=v(r,["cellType"]),n[i]=ct(r),o&&(o.toJSON&&(o=o.toJSON()),r=_.ti,a=o.typeName,r=r[o.type]||r[a]||F.getTypeFromString(a))&&((a=new r).fromJSON(o,t),n[i].cellType=a),delete n[i].starSize);else for(i=0;i<e.length;i++)ut(e[i])||(n[i]=e[i]);return 0<n.length?n:st},a.prototype.fromJSON=function(t){t&&(this.infos=t)},f=a,g.YTe=f,Gt=f.prototype,D({visible:!0,resizable:!0,pageBreak:!1},function(o,n){var t=o[0].toUpperCase()+o.substr(1);Gt["get"+t]=function(t){var e,t,e=n,t=this.infos[t];return e=t&&!ut(t[o])?t[o]:e},Gt["set"+t]=function(t,e,n){var i,r,i=this.NE(t,!0),r=i[o];r!==e&&(i[o]=e),n&&(n[0].push("infos",t,o),n[1]=r,n[2]=e)}}),It=62,Pt=40,g.DEFAULT_COL_HEADER_ROW_HEIGHT=Bt=20,T.prototype.Spe=function(){this.lh={}},T.prototype.getUsedRange=function(t){var e=this,n={};return d(n,e.ZE(t)),d(n,e.sheetModels[3].hE(t)),d(n,e.defaultValueModels[3].hE(t)),d(n,e.WE(t)),d(n,e.QE(t)),n},T.prototype.ZE=function(t){var e,n,t,i,r,o,a;if(t&rt.UsedRangeType.span&&(t=(n=(e=this).spanModels[rt.SheetArea.viewport]).spans,!ut(t))&&0<t.length){for(i={},r=0,o=t;r<o.length;r++)a=o[r],d(i,dt(a));return i}},T.prototype.WE=function(t){var e,n,i,r,t,o,e,a,s,u,c,f,l,e=!(t&rt.UsedRangeType.axis);if(t&rt.UsedRangeType.data||!e){if(n=e?function(t){return!ut(t)&&!ut(t.name)}:function(t){return!ut(t)},r=(i=this).colInfos[3].infos,t={},0<(e=(o=Object.keys(r)).length)){for(u=0,c=o;u<c.length;u++)if(n(r[f=c[u]])){a=+f;break}for(l=e-1;0<=l;l--)if(n(r[o[l]])){s=+o[l];break}ut(a)||ut(s)||d(t,{minRow:0,minCol:a,maxRow:1/0,maxCol:s})}return t}},T.prototype.QE=function(t){var e,n,t,i,r,o,a,s,u,c,f;if(t&rt.UsedRangeType.axis){if(n=(e=this).rowInfos[3].infos,t={},0<(a=(o=Object.keys(n)).length)){for(s=0,u=o;s<u.length;s++)if(c=u[s],!ut(n[c])){i=+c;break}for(f=a-1;0<=f;f--)if(!ut(n[o[f]])){r=+o[f];break}ut(i)||ut(r)||d(t,{minRow:i,minCol:0,maxRow:r,maxCol:1/0})}return t}},T.prototype.KE=function(t,e,n,i,r){var r;3!==n||t<0||e<0||!this.Mf||this.Mf.hasFormula===st||Me(r=this.W_(3).J_(t,e,!!r),i,this.Mf.hasFormula(t,e,n),r&&r.style,this.F8,this.Mf.parent)},T.prototype.JE=function(t,e,n){var n;3!==n||t<0||e<0||(n=this.W_(3).J_(t,e))&&Ce(n)},T.prototype.V8=function(t,e){var n=this;n.L8({type:rt.AxisInfoChangeType.setRowCount,count:t}),n.L8({type:rt.AxisInfoChangeType.setColumnCount,count:e})},T.prototype.L8=function(t){var e,n,i,r,r,o,a,s,u,c,f,l,h,d,e=this,n=e.Mf,i=t.type,r=t.sheetArea,r=void 0===r?rt.SheetArea.viewport:r;if(r===rt.SheetArea.viewport)if(ut(e.XE)&&(e.XE=[]),ut(e.qE)&&(e.qE=[]),e.$E)e.tj(t);else switch(o=e.XE,a=e.qE,i){case rt.AxisInfoChangeType.deleteRows:s=t.index,u=t.count,o.splice(s,u);break;case rt.AxisInfoChangeType.deleteColumns:s=t.index,u=t.count,a.splice(s,u);break;case rt.AxisInfoChangeType.setRowHeight:case rt.AxisInfoChangeType.setRowVisible:s=t.index,c=t.value,o[s]=c;break;case rt.AxisInfoChangeType.setColumnWidth:case rt.AxisInfoChangeType.setColumnVisible:s=t.index,c=t.value,a[s]=c;break;case rt.AxisInfoChangeType.filterRows:for(l=0,h=f=t.index;l<h.length;l++)s=h[l],c=n.getRowHeight(s),o[s]=c;break;case rt.AxisInfoChangeType.outlineExpandRows:for(f=t.index,d=0;d<f.length;d++)s=f[d],c=n.getRowHeight(s),o[s]=c;break;case rt.AxisInfoChangeType.outlineExpandColumns:for(f=t.index,d=0;d<f.length;d++)s=f[d],c=n.getColumnWidth(s),a[s]=c}},T.prototype.nj=function(t){var t;if(this.XE)return t=this.XE[t],ut(t)?this.defaults.rowHeight:t},T.prototype.ej=function(t){var t;if(this.qE)return t=this.qE[t],ut(t)?this.defaults.colWidth:t},T.prototype.v8=function(){this.$E=[]},T.prototype.A8=function(){var t,e,n,i,r,t=this,e=t.$E;if(t.$E=at,e)for(n=0,i=e;n<i.length;n++)r=i[n],t.L8(r)},T.prototype.tj=function(t){this.$E&&this.$E.push(t)},T.prototype.m8=function(){var t=this;t.XE=at,t.qE=at},T.prototype.ij=function(){this.F8=at},T.prototype.L0=function(t){var e;!1!==t&&((e=this).Mf=at,e.sheetModels=at,e.defaultValueModels&&(e.defaultValueModels.forEach(function(t){null!=t&&t.dispose()}),e.defaultValueModels=at),e.m8(),e.ij(),T.f2e(this.Cpe)),T.et(this,"dispose",{clearCache:t})},T.prototype.addRows=function(t,e,n,i,r){var o,a;void 0===r&&(r=rt.SheetArea.viewport),0<(o=this).P8&&o.G8.push(a={row:t,rowCount:e,type:"addRows",sheetArea:r}),1===r?(o.W_(1).rE(t,e,i),o.yle(1).rE(t,e),o.K_(1).rE(t,e),o.Q_(!0,1).kE(t,e)):(o.W_(3).rE(t,e,i),o.W_(2).rE(t,e,i),o.yle(3).rE(t,e),o.yle(2).rE(t,e),o.K_(3).rE(t,e),o.K_(2).rE(t,e),o.Q_(!0,3).kE(t,e),!i&&R&&o.Mf.Uw(3).t8.rE(t,e)),n||T.et(o,"addRows",{row:t,rowCount:e,sheetArea:r,changes:o.G8}),o.L8({type:rt.AxisInfoChangeType.addRows,index:t,count:e,sheetArea:r})},T.prototype.rj=function(t,e){var n,i,r,t,n=this,i=t.row,r=t.rowCount,t=t.sheetArea;e?n.addRows(i,r,!0,!e,t):n.deleteRows(i,r,!0,t),T.et(n,"undoAddRows",{row:i,rowCount:r,sheetArea:t})},T.prototype.deleteRows=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,g,o=(i=void 0===i?rt.SheetArea.viewport:i)===rt.SheetArea.colHeader;if(0<(r=this).P8&&(s=[],u=[],c=o?[]:[["spanModels",3],st],f=o?[]:[["spanModels",2],st],l=[],h=[],a={row:t,rowCount:e,type:"deleteRows",sheetArea:i}),o?(r.W_(1).yE(t,e),r.yle(1).yE(t,e),r.K_(1).aE(t,e),r.Q_(!0,1).DE(t,e)):(R&&r.Mf.Uw(3).t8.aE(t,e,!0),r.W_(3).yE(t,e,s),r.W_(2).yE(t,e,u),r.yle(3).yE(t,e,h),r.yle(2).yE(t,e),r.K_(3).aE(t,e,c),r.K_(2).aE(t,e,f),r.Q_(!0,3).DE(t,e,l)),n||T.et(r,"deleteRows",{row:t,rowCount:e,changes:r.G8,sheetArea:i}),a){for(r.G8.push(a),d=a.changes=[],v=[C,3],g=0;g<s.length;g++)s[g][0]=v.concat(s[g][0]),d.push(s[g]);for(v=[C,2],g=0;g<u.length;g++)u[g][0]=v.concat(u[g][0]),d.push(u[g]);for(0<c.length&&d.push(c),0<f.length&&d.push(f),v=[S,3],g=0;g<l.length;g++)l[g][0]=v.concat(l[g][0]),d.push(l[g]);for(v=[y,3],g=0;g<h.length;g++)h[g][0]=v.concat(h[g][0]),d.push(h[g])}r.L8({type:rt.AxisInfoChangeType.deleteRows,index:t,count:e,sheetArea:i})},T.prototype.oj=function(t,e){var n,i,r,o,a,s,e,n=this,i=t.row,r=t.rowCount,o=t.sheetArea;if(e)n.deleteRows(i,r,!0,o);else{for(n.addRows(i,r,!0,!0,o),s=(a=t.changes).length-1;0<=s;s--)me(n,a[s]);R&&n.Mf.Uw(3).t8.Eme(i,r)}(e=n.Mf&&n.Mf.aj)&&e.splice(e.length-r,r)},T.prototype.addColumns=function(t,e,n,i,r){var o,a;void 0===i&&(i=rt.SheetArea.viewport),0<(o=this).P8&&o.G8.push(a={col:t,colCount:e,type:"addColumns",sheetArea:i}),2===i?(o.W_(2).oE(t,e),o.yle(2).oE(t,e),o.K_(2).oE(t,e),o.Q_(!1,2).kE(t,e)):(o.W_(3).oE(t,e),o.W_(1).oE(t,e),o.yle(3).oE(t,e),o.yle(1).oE(t,e),o.K_(3).oE(t,e),o.K_(1).oE(t,e),o.Q_(!1,3).kE(t,e),!r&&R&&o.Mf.Uw(3).t8.oE(t,e)),n||T.et(o,"addColumns",{col:t,colCount:e,changes:o.G8,sheetArea:i}),o.L8({type:rt.AxisInfoChangeType.addColumns,index:t,count:e,sheetArea:i})},T.prototype.uj=function(t,e){var n,i,r,t,n=this,i=t.col,r=t.colCount,t=t.sheetArea;e?n.addColumns(i,r,!0,t):n.deleteColumns(i,r,!0,t)},T.prototype.deleteColumns=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,g,o=(i=void 0===i?rt.SheetArea.viewport:i)===rt.SheetArea.rowHeader;if(0<(r=this).P8&&(s=[],u=[],c=o?[]:[["spanModels",3],st],f=o?[]:[["spanModels",1],st],l=[],h=[],a={col:t,colCount:e,type:"deleteColumns",sheetArea:i}),o?(r.W_(2).wE(t,e),r.yle(2).wE(t,e),r.K_(2).uE(t,e),r.Q_(!1,2).DE(t,e)):(R&&r.Mf.Uw(3).t8.uE(t,e,!0),r.W_(3).wE(t,e,s),r.W_(1).wE(t,e,u),r.yle(3).wE(t,e,h),r.yle(1).wE(t,e),r.K_(3).uE(t,e,c),r.K_(1).uE(t,e,f),r.Q_(!1,3).DE(t,e,l)),n||T.et(r,"deleteColumns",{col:t,colCount:e,changes:r.G8,sheetArea:i}),a){for(r.G8.push(a),d=a.changes=[],v=[C,3],g=0;g<s.length;g++)s[g][0]=v.concat(s[g][0]),d.push(s[g]);for(v=[C,1],g=0;g<u.length;g++)u[g][0]=v.concat(u[g][0]),d.push(u[g]);for(0<c.length&&d.push(c),0<f.length&&d.push(f),v=[w,3],g=0;g<l.length;g++)l[g][0]=v.concat(l[g][0]),d.push(l[g]);for(v=[y,3],g=0;g<h.length;g++)h[g][0]=v.concat(h[g][0]),d.push(h[g])}r.L8({type:rt.AxisInfoChangeType.deleteColumns,index:t,count:e,sheetArea:i})},T.prototype.sj=function(t,e){var n,i,r,o,a,s,n=this,i=t.col,r=t.colCount,o=t.sheetArea;if(e)n.deleteColumns(i,r,!0,o);else{for(n.addColumns(i,r,!0,o,!0),s=(a=t.changes).length-1;0<=s;s--)me(n,a[s]);R&&n.Mf.Uw().t8.Ome(i,r)}},T.prototype.getRowCount=function(t){return this.W_(t).getRowCount()},T.prototype.setRowCount=function(t,e,n){var i,r,i=this,r=i.getRowCount(e);0<i.P8&&i.G8.push({oldRowCount:r,sheetArea:e,type:"setRowCount"}),3===e||2===e?(t<r&&i.deleteRows(t,r-t,n),i.W_(3).setRowCount(t),i.W_(2).setRowCount(t),i.yle(3).setRowCount(t),i.Mf.ki(it.Events.WorksheetDataChanged,{type:"count"})):1===e&&(t<r&&i.Q_(!0,e).DE(t,r-t),i.W_(e).setRowCount(t)),i.L8({type:rt.AxisInfoChangeType.setRowCount,count:t,sheetArea:e})},T.prototype.cj=function(t){var e=this;e.W_(3).setRowCount(t),e.W_(2).setRowCount(t),e.yle(3).setRowCount(t),e.L8({type:rt.AxisInfoChangeType.setRowCount,count:t,sheetArea:3})},T.prototype.fj=function(t,e){e?this.setRowCount(t.rowCount,t.sheetArea,!0):this.setRowCount(t.oldRowCount,t.sheetArea,!0)},T.prototype.getColumnCount=function(t){return this.W_(t).getColumnCount()},T.prototype.setColumnCount=function(t,e,n){var i,r,i=this,r=i.getColumnCount(e);0<i.P8&&i.G8.push({oldColCount:r,sheetArea:e,type:"setColumnCount"}),3===e||1===e?(t<r&&i.deleteColumns(t,r-t,n),i.W_(3).setColumnCount(t),i.W_(1).setColumnCount(t),i.yle(3).setColumnCount(t),i.Mf.ki(it.Events.WorksheetDataChanged,{type:"count"})):2===e&&(t<r&&i.Q_(!1,e).DE(t,r-t),i.W_(e).setColumnCount(t)),i.L8({type:rt.AxisInfoChangeType.setColumnCount,count:t,sheetArea:e})},T.prototype.lj=function(t,e){e?this.setColumnCount(t.colCount,t.sheetArea,!0):this.setColumnCount(t.oldColCount,t.sheetArea,!0)},T.prototype.getLastNonNullRow=function(t,e){var n,n;return n={isRow:!0,sheetArea:t=ut(t)?3:t,index:st,isIndexGet:!1},T.et(this,"getLastNonNullRowOrCol",n),n.isIndexGet?n.index:(n=e?0:this.Q_(!0,t)._E()-1,p(this.W_(t).I8,this.K_(t).I8,this.yle(t).I8,n))},T.prototype.getLastNonNullCol=function(t,e){var n,n;return n={isRow:!1,sheetArea:t=ut(t)?3:t,index:st,isIndexGet:!1},T.et(this,"getLastNonNullRowOrCol",n),n.isIndexGet?n.index:(n=e?0:this.Q_(!1,t)._E()-1,p(this.W_(t).x8,this.K_(t).x8,this.yle(t).x8,n))},T.prototype.getFreeAreaRowCount=function(t){var t=this.W_(t);return t&&t.getFreeAreaRowCount()},T.prototype.getFreeAreaColumnCount=function(t){var t=this.W_(t);return t&&t.getFreeAreaColumnCount()},T.prototype.setFreeAreaRowCount=function(t,e){this.W_(e).setFreeAreaRowCount(t)},T.prototype.setFreeAreaColumnCount=function(t,e){this.W_(e).setFreeAreaColumnCount(t)},T.prototype.hj=function(){var t,s,e,t;function n(t,e){for(var n,i,r,o,a,n=e.length,i=0;i<n;i++)r=e[i][0],o=e[i][1],(a=e[i][2])!==o&&(t?s.dj(r,3,"height",o,a):s.vj(r,3,"width",o,a))}e=0!==(s=(t=this).Mf).ot().height&&t.mj(!0,s.defaults.rowHeight),t=0!==s.ot().width&&t.mj(!1,s.defaults.colWidth),e&&n(!0,e),t&&n(!1,t)},T.prototype.mj=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,f,k,T,T,n=this,i=n.Mf,r=[],o=i.zoom(),a=t?i.getRowCount():i.getColumnCount(),s=n.Q_(t,3),u=0,f=0;if(i.gj&&(f=t?i.gj().height:i.gj().width),t){if(i.options.colHeaderVisible)for(l=0;l<i.getRowCount(1);l++)u+=x(o*i.getRowHeight(l,1));c=i.ot().height-i.options.sheetAreaOffset.top-f-u}else{if(i.options.rowHeaderVisible)for(l=0;l<i.getColumnCount(2);l++)u+=x(o*i.getColumnWidth(l,2));c=i.ot().width-i.options.sheetAreaOffset.left-f-u}for(h=[],d=[],v=[],m=t?i.getRowVisible:i.getColumnVisible,l=g=0;l<a;l++)if(p=m.call(i,l),S=i.Ut.getSize(t,3,l),w=i.Ut.getStarSize(t,3,l),O.test(w))b="*"===w?1:parseFloat(w.replace("*","")),p&&0<b?(g+=b,h.push(l),d.push(b),v.push(S)):r.push([l,0,S]);else if(S=Lt(S)?Math.floor(S):e,p&&(c-=x(o*S))<1)return;if(!(g+r.length===0||c<1)){for(C=h.length,l=0;l<C-1;l++)if(S=V((y=c/g/o)*(b=d[l])),M=x(o*S),r.push([h[l],S,v[l]]),c-=M,g-=b,M<1||c<1)return;for(f=x((c-1e-4)/o),r.push([h[C-1],f,v[C-1]]),l=0;l<r.length;l++)k=r[l][0],T=r[l][1],s.setSize(k,T),T=t?rt.AxisInfoChangeType.setRowHeight:rt.AxisInfoChangeType.setColumnWidth,n.L8({type:T,index:k});return r}},T.prototype.setCellState=function(t,e,n,i,r){var r=this.W_(r);r&&r.setCellState(t,e,n,i)},T.prototype.toJSON=function(t){var e,n,i,r,i,t,o,e=this,n={},i=e.Mf;return n.data=e.W_(3).toJSON(3,t,e.Mf),n.rowHeaderData=e.W_(2).toJSON(2,t),n.colHeaderData=e.W_(1).toJSON(1,t),n.rows=e.Q_(!0,3).toJSON(t),n.columns=e.Q_(!1,3).toJSON(t),n.rowHeaderColInfos=e.Q_(!1,2).toJSON(t),n.colHeaderRowInfos=e.Q_(!0,1).toJSON(t),n.defaultData=e.yle(3).toJSON(),i.filterRowsVisibleInfo&&!i.filterRowsVisibleInfo.empty&&e.updateToJsonRowInfo(i.filterRowsVisibleInfo.rowsVisibleInfo,n,i),n.leftCellIndex=i.getViewportLeftColumn(1),n.topCellIndex=i.getViewportTopRow(1),(r=t&&t.ignoreStyle)||(n.spans=ge(e.K_(3).toJSON()),n.rowHeaderSpan=ge(e.K_(2).toJSON()),n.colHeaderSpan=ge(e.K_(1).toJSON())),n.selections=e.selectionModel.toJSON(),(o=20===(t={colHeaderRowHeight:(i=e.defaults).colHeaderRowHeight,colWidth:i.colWidth,rowHeaderColWidth:i.rowHeaderColWidth,rowHeight:i.rowHeight,_isExcelDefaultColumnWidth:i._isExcelDefaultColumnWidth}).rowHeight&&62===t.colWidth&&40===t.rowHeaderColWidth&&t.colHeaderRowHeight===g.DEFAULT_COL_HEADER_ROW_HEIGHT)||(n.defaults=t),n},T.prototype.updateToJsonRowInfo=function(t,e,n){var i,r,o,a;for(ut(e.rows)&&(e.rows=[]),i=e.rows,r=n.getRowCount(),o=0;o<r;o++)(a=!1===t[o])&&(ut(i[o])?i[o]={}:i[o]=l({},i[o]),i[o].visible=!1,i[o].isFilter=!0)},T.prototype.fromJSON=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,i,r,o=this,a=o.F8;if(o.W_(3).fromJSON(t.data,e,n,a,i,3,r),o.W_(2).fromJSON(t.rowHeaderData,e,n,a),o.W_(1).fromJSON(t.colHeaderData,e,n,a),o.Q_(!0,3).fromJSON(t.rows),o.Q_(!1,3).fromJSON(t.columns),o.Q_(!1,2).fromJSON(t.rowHeaderColInfos),o.Q_(!0,1).fromJSON(t.colHeaderRowInfos),o.yle(3).fromJSON(t.defaultData),t&&t.rows)for(u=0,c=s=Object.keys(t.rows);u<c.length;u++)f=c[u],l=t.rows[f],ut(l)||o.L8({type:rt.AxisInfoChangeType.setRowHeight,index:+f});if(t&&t.columns)for(h=0,d=s=Object.keys(t.columns);h<d.length;h++)f=d[h],l=t.columns[f],ut(l)||o.L8({type:rt.AxisInfoChangeType.setColumnWidth,index:+f});(v=n&&n.ignoreStyle)||(o.K_(3).fromJSON(t.spans,o.getRowCount(),o.getColumnCount()),o.K_(2).fromJSON(t.rowHeaderSpan),o.K_(1).fromJSON(t.colHeaderSpan)),o.Mf.showCell(t.topCellIndex||0,t.leftCellIndex||0,rt.VerticalPosition.top,rt.HorizontalPosition.left),o.selectionModel.fromJSON(t.selections,t.rowCount,t.columnCount),o.Rue(t.tag),(i=t.defaults)!==st&&((r=o.defaults).colHeaderRowHeight=At(i.colHeaderRowHeight,g.DEFAULT_COL_HEADER_ROW_HEIGHT),r.colWidth=At(i.colWidth,62),r.rowHeaderColWidth=At(i.rowHeaderColWidth,40),r.rowHeight=At(i.rowHeight,20),r._isExcelDefaultColumnWidth=i._isExcelDefaultColumnWidth)},T.prototype.Rue=function(t){var e,n,n,n;t!==st&&t!==at&&(e=this,typeof(n=t.typeName)===m&&(n=F.getTypeFromString(n))&&((n=new n).fromJSON&&n.fromJSON(t),t=n),e.do("setValueForKey",-1,-1,"tag",t,3))},T.prototype.wh=function(t,e,n){var i,r,o,t,r,e,t,a,s,u,t,c,f,l,h,n,n,d,o,i,v,i=this,r=i.defaults.rowHeight,o=i.Q_(!0,3).wh(n),t=i.W_(3).wh(i.Mf,o,t,r,e,n),r=t.sheetData,e=t.hyperlinks,t={};return n&&(t.saveAsView=n.saveAsView,t.ignoreStyle=!1===n.includeStyles),a=i.W_(2).toJSON(2,t),s=i.W_(1).toJSON(1,t),u=i.Q_(!1,2).toJSON(t),t=i.Q_(!0,1).toJSON(t),c=i.yle(3).wh(n),f=i.getValueForKey(-1,-1,"tag",3),n&&!1===n.includeStyles||(l=ge(i.K_(2).toJSON()),h=ge(i.K_(1).toJSON())),n={colHeaderRowHeight:(n=i.defaults).colHeaderRowHeight,rowHeaderColWidth:n.rowHeaderColWidth},d=[],o.forEach(function(t,e){t&&t.starSize&&(d[e]={starSize:t.starSize})}),o=i.selectionModel.selectionPolicy,i=i.selectionModel.selectionUnit,v=40===n.rowHeaderColWidth&&n.colHeaderRowHeight===g.DEFAULT_COL_HEADER_ROW_HEIGHT,{sheetData:r,hyperlinks:e,rowHeaderData:a,colHeaderData:s,rowHeaderColInfos:u,colHeaderRowInfos:t,rowHeaderSpan:l,colHeaderSpan:h,rowInfos:d,defaultData:c,tag:f,defaults:v?void 0:n,selectionPolicy:o,selectionUnit:i}},T.prototype.yh=function(t,e,n,i,r,o,a){var s,t,u,c,e,r,o,a,s=this;s.Q_(!0,3).yh(t,n),s.W_(3).yh(s.Mf,t,e,n,st,r,o,s.F8,a),i&&(t={},n&&(t.ignoreStyle=!1===n.includeStyles,A.Util.Mo(n))&&(t.incrementalLoading=!0),s.W_(2).fromJSON(i.rowHeaderData,st,t),s.W_(1).fromJSON(i.colHeaderData,st,t),s.Q_(!1,2).fromJSON(i.rowHeaderColInfos),s.Q_(!0,1).fromJSON(i.colHeaderRowInfos),s.yle(3).yh(i.defaultData),n&&!1===n.includeStyles||(s.K_(2).fromJSON(i.rowHeaderSpan),s.K_(1).fromJSON(i.colHeaderSpan)),u=s.Q_(!0,3),(c=i.rowInfos||[]).forEach(function(t,e){ut(t&&t.starSize)||u.setStarSize(e,t.starSize)}),(e=i.defaults)!==st&&((r=s.defaults).colHeaderRowHeight=At(e.colHeaderRowHeight,g.DEFAULT_COL_HEADER_ROW_HEIGHT),r.rowHeaderColWidth=At(e.rowHeaderColWidth,40)),(o=i.selectionPolicy)!==st&&(s.selectionModel.selectionPolicy=+o),(a=i.selectionUnit)!==st&&(s.selectionModel.selectionUnit=+a),s.Rue(i.tag))},T.prototype.startTransaction=function(){var t,e;0===this.P8&&(this.G8=[],this.Mf.isEventSuspended()||(this.G8.events=[]),T.et(this,"startTransaction")),this.P8++},T.prototype.endTransaction=function(){var t,e;return this.P8--,0===this.P8?(T.et(this,"endTransaction"),t=this.G8,this.G8=st,(e=t.events)&&0===e.length&&delete t.events,delete t.diffCache,delete t.styleChanges,t):(this.P8<0&&(this.P8=0),[])},T.prototype.pj=function(){var t=this.G8;if(t)return t.calc||(t.calc=[]),t.calc},T.prototype.applyChange=function(t,e,n){var i,r,o,a,s,o,a,u,i=this,r=t.type;!r&&0<t.length?(me(i,t,e),a=(o=Array.isArray(t[0])?t[0]:t)[1],s=o[3],o=o[4],0<a&&0<=s&&0<=o&&(u=(a=i.W_(a)).J_(s,o))&&ue(u,u,!1,s,o,{},a.a8)):"addRows"===r?i.rj(t,e):"addColumns"===r?i.uj(t,e):"deleteRows"===r?i.oj(t,e):"deleteColumns"===r?i.sj(t,e):"setRowCount"===r?i.fj(t,e):"setColumnCount"===r?i.lj(t,e):"setZoomFactor"===r?i.wj(e?t.newValue:t.value):"updateDirty"===r?n.push(t):"setName"===r?e?i.Mj(t.newValue):i.Mj(t.value):"sortRange"===r?i.Cj(t,e):"sheetProperty"===r&&i.Mf[t.pname](e?t.value:t.oldValue)},T.prototype.applyChanges=function(t,e,u){var n,i,r,o,a;function c(t,e,n,i,r){r?t.setArrayFormula(e,n,r.rowCount,r.colCount,i):t.setFormula(e,n,i)}function s(t,e){var n,i,r,o,a,s;if(e)for(n in e)if(!isNaN(n))for(o in i=parseInt(n,10),r=e[n])isNaN(o)||(a=parseInt(o,10),u?c(t,i,a,s=r[o].formula!==r[o].oldFormula?r[o].formula:null,s?r[o].arrayInfo:null):c(t,i,a,r[o].oldFormula,r[o].oldArrayInfo))}if(n=this,i=[],e)if(r=function(t){t[0]===gt?pe(t,function(t){n.applyChange(t,u,i)}):n.applyChange(t,u,i)},u)for(o=0;o<e.length;o++)r(e[o]);else for(o=e.length-1;0<=o;o--)r(e[o]);(a=n.Mf).Sj={},a.r3(),s(a,e&&e.formulas),T.et(n,"applyChanges",{command:t,changes:e,isUndo:!u}),0<i.length&&a.Tj()},T.prototype.undo=function(t){var e,n,i,r,o,a,s,u,c,f,f,e=[],n=t&&t.events;if(n&&this.Aj(n,!0),t)for(i=t.length-1;0<=i;i--)(o=(r=t[i]).type)?"addRows"===o?this.rj(r):"addColumns"===o?this.uj(r):"deleteRows"===o?this.oj(r):"deleteColumns"===o?this.sj(r):"setRowCount"===o?this.fj(r):"setColumnCount"===o?this.lj(r):"setZoomFactor"===o?this.wj(r.value):"updateDirty"===o?(this.pE(r),e.push(r)):"setName"===o?this.Mj(r.value):"sortRange"===o?this.Cj(r):"updateAttachment"===o&&this.HHe(r):r.skipUndo||me(this,r);(a=this.Mf).Sj={},a.r3(),s=t&&t.calc,(u=0<e.length||s&&0<s.length)&&(c=a.Lp)&&c.suspend(),0<e.length&&e.forEach(function(t){var t;a.Ij(t.row,t.col,null!=(t=t.sheetArea)?t:3,!1)}),(f=t&&t.tableChanges)&&0<f.length&&(T.et(this,z,{tableChanges:f}),t.tableChanges.isRestored=!0),(f=t&&t.pivotTableChanges)&&0<f.length&&(T.et(this,z,{pivotTableChanges:f}),t.pivotTableChanges.isRestored=!0),s&&s.length&&a.xj(s),T.et(this,"undoValue",t),u&&(c&&c.resume(!1),a.Tj()),delete this.W_(3).B8.vE,t&&T.et(this,z,t),n&&this.Aj(n,!1)},T.prototype.do=function(t){for(var e,n,i,t,e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];i=this,t&&(t=i[t])&&t.apply(i,e)},T.prototype.W_=function(t){return ut(t)&&(t=3),this.sheetModels[t]},T.prototype.l8=function(t,e,n){var i=0,r=0;ut(n)&&(n=3,i=t,r=e),this.sheetModels[n]=new xt(t,e,i,r)},T.prototype.yle=function(t){return ut(t)&&(t=3),this.defaultValueModels[t]},T.prototype.ZI=function(t){var e,n=this.G8,n=n&&n.events;n&&n.push(t)},T.prototype.Aj=function(t,e){var n,i,r,o,a,n=this.Mf;for(n.Nj=!0,i=t.length-1;0<=i;i--)a=void 0,"cellChanged"!==(o=(r=t[i])[0])||e?"rowChanged"!==o||e?"columnChanged"!==o||e?"zoomChanged"!==o||e?"rowChanging"===o&&e?a=n.kj:"columnChanging"===o&&e?a=n.Dj:"tableRowsChanged"!==o||e?"tableColumnsChanged"!==o||e?"rangeChanged"!==o||e||(a=n._j):a=n.Ej:a=n.jj:a=n.Oj:a=n.vj:a=n.dj:a=n.Rj,a&&([].splice.call(t,i,1),a.apply(n,[].slice.call(r,1)));n.Nj=!1},T.prototype.Rve=function(t,e,n){var n=this.yle(n);if(n)return n.getValue(t,e)},T.prototype.gge=function(t,e,n,i){var r=this,o=r.Mf;o.hasFormula&&!o.hasFormula(t,e,i,!0)&&r.yle(i).$1e(t,e,at,at,i,n)},T.prototype.yge=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,r=this,o=r.Mf;if(o.hasFormula)for(a=r.yle(),s=k(n,a.getRowCount()),u=k(i,a.getColumnCount()),c=0;c<s;c++)for(f=t+c,l=0;l<u;l++)a.getExpression(f,h=e+l)&&!o.hasFormula(f,h,3,!0)&&r.gge(f,h)},T.prototype.getValue=function(t,e,n,i,r,o){var a,s,u,o;return void 0===o&&(o={}),ut(n)&&(n=3),!i&&(a={row:t,col:e,sheetArea:n,isValueGet:!1,value:st,valueType:r,rowSpacingIndex:o.rowSpacingIndex,isAfterRowSpacing:o.isAfterRowSpacing},T.et(this,"getValue",a,function(){return a.isValueGet}),a.isValueGet)?(s=q(o.rowSpacingIndex))||this.wle||!ut(a.value)||(u=this.Rve(t,e,n),ut(u))?a.value:u:(o=this.W_(n).getValue(t,e,r),this.wle||i||!ut(o)||(u=this.Rve(t,e,n),ut(u))?o:u)},T.prototype.setValue=function(t,e,n,i,r,o,a,s,u){var c,f,l,o,u,h,r,u,a,s,r;ut(i)&&(i=3),l=(f=this).Mf,(o=!o&&!l.isEventSuspended())&&(c=l.getValue(t,e,i,1)),u||f.KE(t,e,i,n,!0),u=!1,r||(h={row:t,col:e,value:n,sheetArea:i,isValueSet:!1,changes:f.G8},T.et(f,"setValue",h,function(){return h.isValueSet}),u=h.isValueSet),u||(u=r=void 0,0<f.P8&&(!a||l.parent&&l.parent.options.saveChangesForSheet)&&(r=[[C,i],st],u={sheetArea:i}),l.vle?(f.setDefaultValue(t,e,n,i,at,!0,at),f.W_(i).setValue(t,e,at,r,u,s)):(f.gge(t,e,ut(n),i),f.W_(i).setValue(t,e,n,r,u,s),f.W_(i).setValueForKey(t,e,K,!0)),s&&r&&!de(this.pj(),t,e)&&(r.skipUndo=!0),r&&0<r.length&&f.G8.push(r),u&&u.type&&f.G8.push(u),l.Tj()),o?(a=c!==n,s=!1,r=void 0,(a=typeof n===m&&((r=it.util.V0(n))instanceof Date&&(s=!0),c instanceof Date)?c.valueOf()!==r.valueOf():a)&&l.Rj("value",t,e,i,c,s&&r?r:n)):l.Lj(l,[{row:t,col:e}],0)},T.prototype.getFileGUID=function(t,e,n){return ut(n)&&(n=3),this.W_(n).getFileGUID(t,e)},T.prototype.setFileGUID=function(t,e,n,i){var r,o,a;ut(i)&&(i=3),0<(r=this).P8&&(o=[[C,i],st],a={sheetArea:i}),r.W_(i).setFileGUID(t,e,n,o,a),o&&0<o.length&&r.G8.push(o),a&&a.type&&r.G8.push(a)},T.prototype.Mle=function(t,e,n){ut(n)&&(n=3);var n=this.yle(n);if(n)return n.q1e(t,e)},T.prototype.getDefaultValue=function(t,e,n,i){var n=this.yle(n);if(n)return i===rt.DefaultChangeValueType.Expression?n.getFormula(t,e):i!==rt.DefaultChangeValueType.Value&&n.getFormula(t,e)||n.getValue(t,e)},T.prototype.WTe=function(t,e,n,i){var r,o,a,s;ut(i)&&(i=3),(a=(o=(r=this).yle(i))&&o.q1e(t,e))&&(s=void 0,0<r.P8&&(s=[[y,i],st]),o.X1e(a,s,t,e,n,rt.DefaultChangeValueType.Expression),a.expr=n,s)&&0<s.length&&r.G8.push(s)},T.prototype.setDefaultValue=function(t,e,n,i,r,o,a){var s,u,c;ut(i)&&(i=3),(u=(s=this).yle(i))&&(c=void 0,0<s.P8&&(c=[[y,i],st]),ut(a)&&(s.wle=!0,a=!ut(s.getValue(t,e,i))||s.Mf.hasFormula(t,e,i,!0),delete s.wle),!r&&F.kf(n)||r===rt.DefaultChangeValueType.Expression?u.setFormula(t,e,n,i,a,c):u.setValue(t,e,n,o,c),c)&&0<c.length&&s.G8.push(c)},T.prototype.getStyle=function(t,e,n,i){void 0===i&&(i={});var i={row:t,col:e,sheetArea:n=ut(n)?3:n,isStyleGet:!1,style:st,rowSpacingIndex:i.rowSpacingIndex,isAfterRowSpacing:i.isAfterRowSpacing};return T.et(this,"getStyle",i),i.isStyleGet?i.style:this.W_(n).getStyle(t,e,0<this.P8)},T.prototype.setStyle=function(t,e,n,i){var r;this.JTe(t,e,n,i),T.et(this,"setStyle",{row:t,col:e,style:n})},T.prototype.JTe=function(t,e,n,i){var r,r,o,a,r;ut(i)&&(i=3),n&&n.cellType&&n.cellType.qe(this.Mf,t,e,n,i),o=0<this.P8?[[C,i]]:st,a=this.W_(i).getStyle(t,e,!1),this.G8&&this.G8.diffCache===st&&(this.G8.diffCache=[]),this.G8&&this.G8.styleChanges===st&&(this.G8.styleChanges=[]),this.W_(i).setStyle(t,e,n,o,null==(r=this.G8)?void 0:r.styleChanges,null==(r=this.G8)?void 0:r.diffCache),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"style"}),o&&0<o.length&&this.PCe(o),r=this.Mf.parent,i===rt.SheetArea.viewport&&ke(a,n,r)&&this.KE(t,e,i,this.getValue(t,e,i,!0),!1)},T.prototype.PCe=function(t){var e,e,n,e,i,r;0===(null==(e=this.G8)?void 0:e.styleChanges.length)&&this.G8.push([gt,this.G8.styleChanges,this.G8.diffCache]),e=fe(t),(n=he(this.G8.styleChanges,e))||this.G8.styleChanges.push(n={path:e,change:{}}),e=le(t),i=n.change[e],r=3===t.length?{old:t[1],new:t[2]}:t[1],i!==st&&Array.isArray(i)?"object"==typeof i[i.length-1]?i[i.length-1].new=t[2]:i.push(r):3===t.length&&i!==st?"object"==typeof i?i.new=t[2]:n.change[e]=[i,r]:n.change[e]=r},T.prototype.getValueForKey=function(t,e,n,i){return this.W_(i).getValueForKey(t,e,n)},T.prototype.setValueForKey=function(t,e,n,i,r){ut(r)&&(r=3);var o=0<this.P8?[[C,r],st]:st;this.W_(r).setValueForKey(t,e,n,i,o),o&&0<o.length&&this.G8.push(o)},T.prototype.RCe=function(t,e,n,i,r,o){this.W_(o).clear(t,e,n,i,r)},T.prototype.clear=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p;if(ut(a)&&(a=3),s=0<this.P8?[]:st,R&&3===a&&(u=this).Mf.Uw(3).t8.Fgt(t,e,n,i),c=this.W_(a),T.et(this,"preClear",{row:t,col:e,rowCount:n,colCount:i,type:r,ignoredRowList:o,sheetArea:a,changes:this.G8}),c.clear(t,e,n,i,r,o,s),this.yle(a).resetFormulaToCalc(t,e,n,i,a),this.Mf.ki(it.Events.WorksheetDataChanged,{type:rt.StorageType[r]}),T.et(this,"clear",{row:t,col:e,rowCount:n,colCount:i,type:r,ignoredRowList:o,sheetArea:a,changes:this.G8}),s)for(f=[C,a],l=0,h=s.length;l<h;l++)(d=s[l])[0]=f.concat(d[0]),this.G8.push(d);for(v=0;v<n;v++)for(g=0;g<i;g++)this.KE(m=t+v,p=e+g,a,at,!1),c.setValueForKey(m,p,K,!0)},T.prototype.swapNode=function(t,e,n,i,r){var o,a,s,u,c;if(ut(r)&&(r=3),o=0<this.P8?[]:st,this.W_(r).SE(t,e,n,i,o),this.yle(r).SE(t,e,n,i,o),o)for(a=[C,r],s=0,u=o.length;s<u;s++)(c=o[s])[0]=a.concat(c[0]),this.G8.push(c)},T.prototype.dE=function(t,e,n,i){var r;0<this.P8&&(r={sheetArea:i},ut(i))&&(r.sheetArea=3),this.W_(i).dE(t,e,n,r),r&&this.G8.push(r)},T.prototype.pE=function(t){this.W_(t.sheetArea).pE(t)},T.prototype.Fj=function(t){return this.W_(t).B8},T.prototype.Pj=function(t,e,n){var i,n,r,i,n=this.Fj(n)[t];return!(!n||!(r=n[e]))},T.prototype.Gj=function(t,e,n){for(var i,r,o,i=this.W_(n).B8,r=0;r<e;r++)(o=t+r)in i&&delete i[o]},T.prototype.Uj=function(t,e){var n,i,r,o,n,i=this.Mf.aj;if(i)for(r=i.length-1;0<=r;r--)t<=(o=i[r].row)&&o<t+e&&i.splice(r)},T.prototype.Hj=function(t){this.W_(t).B8={}},T.prototype.zj=function(t,e,n,i){var r=this.Fj(),o,a,s;if(r)for(o in r)I(r,o)&&(a=r[o],s=parseInt(o,10),a)&&"n"===a.rs&&(t||e&&n<=s&&s<n+i)&&(r[o]={})},T.prototype.Vj=function(o,t,a,e,s){var n,u,c,f,i,r,l,n,h,d,v,n=this,u=n.Fj(),c=n.Mf,f=c.tables;if(!ot(u)){if(i=[],0<=t)for(r=t;r<t+e;r++)i.push(r);else for(l in u)I(u,l)&&i.push(parseInt(l,10));n=[],h=[],f&&(n=f.Yj(t,a,e,s),h=f.Zj(t,a,e,s),0<n.length)&&T.et(this,"clearPendingChanges",{tableList:n}),D(i,function(t,e){var n,i,r;if((d=u[e])&&"e"===d.rs)if(n=h.length,o)if(f&&0!==n&&f.Wj(h,e,-1))for(i=c.getColumnCount(),r=0;r<i;r++)f&&0!==n&&f.Wj(h,e,r)||(v=d[r])&&delete d[r];else u[e]={};else for(r=a;r<a+s;r++)f&&0!==n&&f.Wj(h,e,r)||(v=d[r])&&delete d[r]})}},T.prototype.Qj=function(){var t,e,n,t,e=this.Fj();for(n in e)I(e,n)&&e[n]&&"e"===e[n].rs&&(e[n]={})},T.prototype.Kj=function(t){this.W_(t).lE++},T.prototype.Jj=function(t){var t,e,t=this.W_(t);t.lE--,(e=t.lE)<0&&(t.lE=0)},T.prototype.getName=function(){return this.name||""},T.prototype.setName=function(t){var e,n,e=this,n=e.name;n!==t&&(0<e.P8&&e.G8.push({type:"setName",value:n}),e.name=t)},T.prototype.Xj=function(){return this.isSelected},T.prototype.qj=function(t){this.isSelected=t},T.prototype.Mj=function(t){this.Mf.name(t)},T.prototype.Cj=function(t,e){var n,i,e,n=t.byRows?t.row:t.column;e||(i=[],t.array.map(function(t,e){i[t-n]=e+n})),this.Mf.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,at,i),(e=t.sortState)?this.Mf.Tpe(e.row,e.col,e.rowCount,e.colCount,e.byRow,e.sortConditions):this.Mf.Ape()},T.prototype.UHe=function(t,e){var n,i,r,e,n,o,t,n=this,i,r=n.Mf.VTe();0<n.P8&&!e&&n.G8.push({newValue:t,type:"updateAttachment"}),t&&(e=t.name,n=t.blob,o=t.dataUrl,t=t.id,r.EAe(e,n,o,t))},T.prototype.GHe=function(t,e){var n=this,i,r=n.Mf.VTe();0<n.P8&&!e&&n.G8.push({oldValue:t,type:"updateAttachment"}),t&&r.FAe([t.id])},T.prototype.HHe=function(t){var e=t.oldValue,t=t.newValue;t&&this.GHe(t,!0),e&&this.UHe(e,!0)},T.prototype.getZoomFactor=function(){return this.zoomFactor},T.prototype.setZoomFactor=function(t){var e=this;0<e.P8&&e.G8.push({type:"setZoomFactor",value:e.zoomFactor}),e.zoomFactor=t},T.prototype.wj=function(t){this.Mf.zoom(t)},T.prototype.K_=function(t){return ut(t)&&(t=3),this.spanModels[t]},T.prototype.d8=function(t){ut(t)&&(t=3),this.spanModels[t]=new wt},T.prototype.getSpans=function(t,e,n){var i,r,o,a,r,i;return ut(e)&&(e=3),t&&(i=t.row,r=t.col,o=t.rowCount,a=t.colCount),T.et(this,"getSpans",i={row:i,col:r,rowCount:o,colCount:a,isAll:!t,sheetArea:e,isSpansGet:!1,spans:[]}),r=i.isSpansGet?i.spans:this.K_(e).getSpans(t),r=n?r.filter(function(t){return!t.isAutoMerge}):r},T.prototype.getSpan=function(t,e,n){var i={row:t,col:e,sheetArea:n=ut(n)?3:n,isSpansGet:!1,spans:[]};return T.et(this,"getSpans",i),i.isSpansGet?i.spans[0]||(0,it.Ec)(t,e,1,1):this.K_(n).get(t,e)},T.prototype.Ci=function(t,e,n){var n,n;return ut(n)&&(n=3),(n=this.W_(n))&&n.J_&&(n=n.J_(t,e))&&n.tipContent?n.tipContent:null},T.prototype.$n=function(t,e,n,i){ut(i)&&(i=3);var r=this.W_(i).J_(t,e);!n&&r?delete r.tipContent:n&&r?r.tipContent=n:n&&!r&&((r=this.W_(i).J_(t,e,!0)).tipContent=n)},T.prototype.eE=function(t,e,n,i,r){return this.K_(r).eE(t,e,n,i)},T.prototype.GT=function(t,e,n,i,r){return this.K_(r).GT(t,e,n,i)},T.prototype.findSpan=function(t,e,n){var i={row:t,col:e,sheetArea:n=ut(n)?3:n,isSpansGet:!1,spans:[]};return T.et(this,"getSpans",i),i.isSpansGet?i.spans[0]:this.K_(n).find(t,e)},T.prototype.removeSpan=function(t,e){ut(e)&&(e=3);var n=0<this.P8?[["spanModels",e],st]:st;this.K_(e).remove(t,n),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"span",isClear:!0,sheet:this.Mf}),n&&0<n.length&&this.G8.push(n)},T.prototype.addSpan=function(t,e){ut(e)&&(e=3);var n=0<this.P8?[["spanModels",e],st]:st;this.K_(e).add(t,n),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"span",range:t,isAdd:!0,sheet:this.Mf}),n&&0<n.length&&this.G8.push(n)},T.prototype.clearSpan=function(t,e,n,i,r){ut(r)&&(r=3);var o=0<this.P8?[["spanModels",r],st]:st;this.K_(r).d5(t,e,n,i,o),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"span",isClear:!0,sheet:this.Mf}),o&&0<o.length&&this.G8.push(o)},T.prototype.moveSpan=function(t,e,n,i,r,o,a){ut(a)&&(a=3);var s=0<this.P8?[["spanModels",a],st]:st;this.K_(a).iE(t,e,n,i,r,o,s),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"span"}),s&&0<s.length&&this.G8.push(s)},T.prototype.copySpan=function(t,e,n,i,r,o,a,s){ut(a)&&(a=3);var u=0<this.P8?[["spanModels",a],st]:st;this.K_(a).tE(t,e,n,i,r,o,u,s),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"span"}),u&&0<u.length&&this.G8.push(u)},T.prototype._9=function(t,e,n,i){this.colHeaderSelectionModel.$j=new it.Range(t,e,n,i)},T.prototype.J9=function(){return this.colHeaderSelectionModel.$j},T.prototype.addSelection=function(t,e,n,i,r,o){var a,s,u;if(1===o)this.colHeaderSelectionModel.add(t,e,n,i,st);else if(a=0<this.P8?[]:st,this.selectionModel.add(t,e,n,i,a,r),a)for(s=0;s<a.length;s++)(u=a[s])[0]=["selectionModel"].concat(u[0]),this.G8.push(u)},T.prototype.getSelections=function(t){return(1===t?this.colHeaderSelectionModel:this.selectionModel).get()},T.prototype.setSelections=function(t,e){var n,i,r;if(1===e)this.colHeaderSelectionModel.set(t,st);else if(n=0<this.P8?[]:st,this.selectionModel.set(t,n),n)for(i=0;i<n.length;i++)(r=n[i])[0]=["selectionModel"].concat(r[0]),this.G8.push(r)},T.prototype.clearSelection=function(t){var e,n,i;if(1===t)this.colHeaderSelectionModel.clear(st);else if(e=0<this.P8?[]:st,this.selectionModel.clear(e),e)for(n=0;n<e.length;n++)(i=e[n])[0]=["selectionModel"].concat(i[0]),this.G8.push(i)},T.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},T.prototype.setActiveSelectedRangeIndex=function(t){var e=0<this.P8?[["selectionModel"],st]:st;this.selectionModel.setProperty("activeSelectedRangeIndex",t,e),e&&this.G8.push(e)},T.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},T.prototype.setSelectionPolicy=function(t){ce(this,"selectionPolicy",t)},T.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},T.prototype.setSelectionUnit=function(t){ce(this,"selectionUnit",t)},T.prototype.T9=function(t){return this.selectionModel.T9(t)},T.prototype.S9=function(t){return this.selectionModel.S9(t)},T.prototype.ni=function(t,e,n,i,r,o){return this.selectionModel.ni(t,e,n,i,r,o)},T.prototype.ei=function(t,e,n,i,r){return this.selectionModel.ei(t,e,n,i,r)},T.prototype.Q_=function(t,e){var n;return ut(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]},T.prototype.h8=function(t,e){var n;ut(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]=new f},T.prototype.getPageBreak=function(t,e,n){var i;return this.Q_(t,e).getPageBreak(n)},T.prototype.setPageBreak=function(t,e,n,i){var r,o;ut(e)&&(e=3),r=0<this.P8?[[t?S:w,e],st]:st,(o=this.Q_(t,e)).setPageBreak(n,i,r),r&&this.G8.push(r)},T.prototype.getVisible=function(t,e,n){var i;return this.Q_(t,e).getVisible(n)},T.prototype.setVisible=function(t,e,n,i){var r,o,a,i,r=this;ut(e)&&(e=3),o=0<r.P8?[[t?S:w,e],st]:st,(a=r.Q_(t,e)).setVisible(n,i,o),o&&r.G8.push(o),i=t?rt.AxisInfoChangeType.setRowVisible:rt.AxisInfoChangeType.setColumnVisible,r.L8({type:i,index:n,sheetArea:e})},T.prototype.getResizable=function(t,e,n){var i;return this.Q_(t,e).getResizable(n)},T.prototype.setResizable=function(t,e,n,i){var r,o;ut(e)&&(e=3),r=0<this.P8?[[t?S:w,e],st]:st,(o=this.Q_(t,e)).setResizable(n,i,r),r&&this.G8.push(r)},T.prototype.getSize=function(t,e,n){var i,r;return i={index:n,isRow:t,isSizeGet:!1,sheetArea:e=ut(e)?3:e,size:st},T.et(this,"getSize",i),i.isSizeGet?i.size:(r=this.Q_(t,e)).getSize(n)},T.prototype.getColumnHeaderFitMode=function(t,e,n){var i;return this.Q_(t,e).getColumnHeaderFitMode(n)},T.prototype.setColumnHeaderFitMode=function(t,e,n,i){var r,o,a,s,u,c,f,t,l,h,d,v,g,r=this,o=60,u=r.Mf,c=u.getRowCount(1);if(ut(e)&&(e=3),r.P8&&(a=[[w,e],st],s=[[S,e],st]),l=(t=r.Q_(t,e)).getColumnHeaderFitMode(n),t.setColumnHeaderFitMode(n,i,a),d=!1,i===rt.ColumnHeaderFitMode.vertical?(h=60,u.gD&&2===l&&u.gD--):i===rt.ColumnHeaderFitMode.stack?(r.t7(n,e),u.gD||(u.gD=0),2!==l&&u.gD++):i===rt.ColumnHeaderFitMode.normal&&(h=u.defaults.colHeaderRowHeight,u.gD)&&2===l&&u.gD--,h&&i!==l){for(v=r.Q_(!0,e),g=0;g<c;g++)f=u.getRowHeight(g,e),(h=p(h,f))!==f&&(v.setSize(g,W,s),s)&&(r.G8.push(s),s=[[S,e],st]);u.NMi?u.defaults.colHeaderRowHeight=h:u.setRowHeight(0,h,rt.SheetArea.colHeader)}a&&r.G8.push(a)},T.prototype.t7=function(t,e){var n,i,r,o,a,s,u,c,f,l,n=this,o=n.Mf,a=n.Q_(!0,e);if(n.P8&&(i=[[S,e],st]),s=n.Mf.defaults.rowHeight||g.DEFAULT_COL_HEADER_ROW_HEIGHT,c=n.getRowCount(rt.SheetArea.colHeader),f=n.n7(t),!n.e7(t)){for(l=0;l<c;l++)r=s*f,u=o.getRowHeight(l,e),(r=p(r,u))!==u&&(a.setSize(l,W,i),i)&&(n.G8.push(i),i=[[S,e],st]);o.NMi?o.defaults.colHeaderRowHeight=r:o.setRowHeight(0,r,rt.SheetArea.colHeader)}},T.prototype.e7=function(t){var e,n,i,n,e,e=this,n=e.Mf,i=n.frozenColumnCount()-1,n=n.frozenTrailingColumnCount(),e=e.getColumnCount()-1;return t===i||t===e||t===e-n},T.prototype.i7=function(t){var e,n,i,n,e,r,o,e=this,n=e.Mf,i=n.frozenColumnCount(),n=n.frozenTrailingColumnCount(),e=e.getColumnCount();return n&&(o=t===e-n),(r=i?t===i:r)||o},T.prototype.n7=function(t,e){for(var n,i,r,t,o,a,s,u,c,f,t,l,h,n=this,o=rt.SheetArea.colHeader,a={},s=n.Mf,u=s.getColumnCount(),i=r=t=(e=e||n.Q_(!1,o).infos)[t]&&e[t].columnHeaderFitMode===rt.ColumnHeaderFitMode.stack?t:t-1,c=t;0<=c;c--)if(s.getColumnWidth(c,o)){if(!e[c]||e[c].columnHeaderFitMode!==rt.ColumnHeaderFitMode.stack||n.eE(-1,c,-1,1,rt.SheetArea.colHeader))break;if(n.i7(c)){i=c;break}i=c}else a[i=c]=!0;for(c=t;c<u;c++)if(s.getColumnWidth(c,o)){if(!e[c]||e[c].columnHeaderFitMode!==rt.ColumnHeaderFitMode.stack||n.eE(-1,c,-1,1,rt.SheetArea.colHeader))break;if(n.e7(c))break;r=c}else if(a[r=c]=!0,n.e7(c))break;return t=r-i-(f=Object.keys(a).length)+1,l=1,!(h=s.O5(r,o,!0))||n.e7(r)||n.eE(-1,h,-1,1,rt.SheetArea.colHeader)?t:1+t},T.prototype.r7=function(t,e,n){var i,r,o,a,s,u,c,i=this,r=0,o=i.Mf,a=o.Ut;for(e=e||i.Q_(!1,rt.SheetArea.colHeader).infos,s=i.o7(t),u=t-1;s<=u;u--)if(c=o.getColumnWidth(u))if(e[u]&&e[u].columnHeaderFitMode===rt.ColumnHeaderFitMode.stack&&!a.eE(-1,u,-1,1,rt.SheetArea.colHeader))r++;else if(!n||!e[u]||e[u].columnHeaderFitMode!==rt.ColumnHeaderFitMode.vertical||a.eE(-1,u,-1,1,rt.SheetArea.colHeader))return r;return r},T.prototype.i6=function(t,e){for(var n,i,r,o,a,n=this,i,r=n.Mf.getColumnCount(),a=t+1;a<r;a++)if((o=n.getColumnHeaderFitMode(!1,1,a))===e)return a;return at},T.prototype.o7=function(t){var e,n,i,n,e,e=this,n=e.Mf,i=n.frozenColumnCount(),n=n.frozenTrailingColumnCount(),e=e.getColumnCount();return t<i?0:t<e-n?i:e-n},T.prototype.getStarSize=function(t,e,n){var i;return this.Q_(t,e).getStarSize(n)},T.prototype.getActualSize=function(t,e,n){var i;return this.Q_(t,e).getActualSize(n)},T.prototype.setSize=function(t,e,n,i){var r,o,a,o,r=this;ut(e)&&(e=3),o=0<r.P8?[[t?S:w,e],st]:st,(a=r.Q_(t,e)).setSize(n,i,o),this.Mf.ki(it.Events.WorksheetDataChanged,{type:"size"}),o&&r.G8.push(o),r.setStarSize(t,e,n,at),o=t?rt.AxisInfoChangeType.setRowHeight:rt.AxisInfoChangeType.setColumnWidth,r.L8({type:o,index:n,value:i,sheetArea:e})},T.prototype.setStarSize=function(t,e,n,i){var r,o;ut(e)&&(e=3),r=0<this.P8?[[t?S:w,e],st]:st,(o=this.Q_(t,e)).setStarSize(n,i,r),r&&!ut(r[1])&&this.G8.push(r)},T.prototype._E=function(t,e){var n;return this.Q_(t,e)._E()},T.prototype.EE=function(t,e){var n;return this.Q_(t,e).EE()},T.prototype.q_=function(t,e,n){var i;return this.Q_(t,e).q_(n)},T.prototype.setItem=function(t,e,n,i){var r,o,a,s,r=this;ut(e)&&(e=3),o=0<r.P8?[[t?S:w,e],st]:st,(a=r.Q_(t,e)).X_(n,i,o),i&&(ut(i.size)||(s=t?rt.AxisInfoChangeType.setRowHeight:rt.AxisInfoChangeType.setColumnWidth,r.L8({type:s,index:n,value:i.size,sheetArea:e})),ut(i.visible)||(s=t?rt.AxisInfoChangeType.setRowVisible:rt.AxisInfoChangeType.setColumnVisible,r.L8({type:s,index:n,sheetArea:e}))),o&&r.G8.push(o)},Rt=T,g.Y8=Rt,(0,it.$e)(Rt,!0),Nt=["=","+","-"],Et=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,Ht="__builtInStyle"},"./dist/core/worksheet/worksheet-render.js":function(o,t,dt){"use strict";var vt,gt,et,e,u,mt,pt,St,d,wt,bt,xt,M,nt,it,Gt,ct,Ct,rt,B,c,ot,at,st,yt,N,E,w,b,C,f,l,Mt,I,ut,a,v,g,h,ft,y,m,Bt,p,s,S,k,T,x,G,R,H,U,F,_,A;function kt(t){return t.height}function Tt(t){return t.width}function L(t,e,n,i,r,o,a){t.beginPath(),t.lineWidth=e,t.strokeStyle=n,t.moveTo(i,r),t.lineTo(o,a),t.stroke()}function D(t,e){var t=t.sw&&t.sw.cellTypeHitInfo&&t.sw.cellTypeHitInfo.addRowColumnButtonHitInfo;if(t){if(e===St.SheetArea.colHeader)return 1===t.addRowColumnButtonType;if(e===St.SheetArea.rowHeader)return 2===t.addRowColumnButtonType}return!1}function j(t,e){var n,t,i,n=0;return"string"==typeof t&&(1===(i=(t=t.split(" ",4)).length)?n=2*I(t[0]):2===i||3===i?n=2*I(t[1]):4===i&&(n=I(t[1])+I(t[3]))),n*e}function P(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v,g,m,s,t,g,i,p,S,d,v,u=r.zoom(),c=u||1,f=n.font,l=n.textIndent,h=n.textOrientation,d=n.isVerticalText,v=n.textIndent&&0!==n.textIndent,g=0!==h&&!Ct(h);return f=f?at(n,u).font:i,typeof s===ft&&1!==s&&(f=ot(f,s).font,c=u*s),i=0,i=t&&t.richText?V(t.richText,f,u):t&&g&&!d&&!v?(s=w(h*Math.PI/180),t=b(s),g=C(s),n.wordWrap?(d=(S=r.Jt).Gt(o),et.q.Zt(o,a,t,g,e,f,d)):(v=nt(f),et.q.Wt(e,f)*g+v*t)):et.q.Wt(e,f),m=(i+=K(r,l,o,a,c)+y)+j(n.cellPadding,u)}function O(t,e,n){var i;if(t&&-90<=t&&t<=90)return l(n/f(w(t*Math.PI/180)))+e+4}function V(t,e,n){var t=u.GC$.extend(!0,[],t);return Y(t,e,n),et.q.ah(t,e,1)}function Y(t,e,n){for(var i,r,o,a,o,i=0,r=t;i<r.length;i++)a=void 0,(o=r[i]).style=o.style||{},a=(o=o.style).font?ot(o.font,n).font:e,o.font=a}function K(t,e,n,i,r){if(!Ct(n)&&!Ct(i)&&t.outlineColumn){var t=t.outlineColumn.a7(n,i);if(t)return t}return e?8*e*r:0}function z(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,v,g,m,p,S,w,b,C,y,n,M,M,k,T,x;if(B(r.data)&&t.parent&&t.parent.options.numbersFitMode!==St.NumbersFitMode.overflow)return st;if(c=t.Jt,f=Tt(r),l=Tt(r),d=r.style,g=r.text,m=r.printZoomFactor,p=d.watermark,S=d.wordWrap,w=d.textOrientation,y=t.options.allowCellOverflow,e.findCell(o,a))return st;if(d.cellButtons&&0<d.cellButtons.length)return st;if(wt.W.Xue(d))return st;if(n=d.cellType||n,M=(M=t.parent&&t.parent.options.numbersFitMode)===St.NumbersFitMode.mask||M===St.NumbersFitMode.overflow&&!B(r.data),!n.allowOverflow||!g&&!p||!w&&S&&M)return st;if(!y&&!w)return st;if((b=P(r.data,g=g||p,d,i,t,o,a,m))<=l)return st;if(90===Math.abs(w)&&S)return st;for(v=(T=k=a)+(u?1:-1);(u?v<=s:s<=v)&&!e.findCell(o,v)&&(C=c.qt(o,v),h=c.$t(o,v,3,1,{style:C}),x=C.textOrientation,!c.JVe(v)||(Ct(h)||x&&w))&&!C.watermark&&!(C.cellType&&"1"!==C.cellType.typeName||C.cellButtons&&0<C.cellButtons.length||wt.W.Xue(C))&&(u?T=v:k=v,!(b<=(l+=c.Kt(v))));v+=u?1:-1);return u&&T===a||!u&&k===a?st:new mt.Q8(a,k,T,b,f,l,u?-1:l,u?l:-1)}function n(t,e,n){var i=this;i.Mf=t,i.Vx=t.Yy(n),i.u7=t.s7(e,n,St.SheetArea.viewport,!0),i.c7=ot(t.Dn.Nn(),t.zoom()).font,i.f7=t.$f(),i.l7={}}function W(t){var e,n,e=t.parent,n={nps:!0};return gt.Worksheet.et(t,"needPaintSelection",n),(et.hi.A1(t)||e&&!e.options.hideSelection)&&n.nps}function lt(t){var t=t.parent;return t&&t.options.backColor||h}function i(t){this.Mf=t}function r(t){var e=this;e.h7=!1,e.d7=!1,e.Mf=t,e.v7()}Object.defineProperty(t,"__esModule",{value:!0}),t.m7=t.g7=t.needPaintSelection=t.p7=void 0,vt=dt("Common"),gt=dt("./dist/core/worksheet/worksheet.js"),et=dt("./dist/core/util/common.js"),e=dt("./dist/core/worksheet/stylehelper.js"),u=dt("./dist/core/util/domUtil.js"),mt=dt("./dist/core/worksheet/worksheet-model.js"),pt=dt("./dist/core/worksheet/worksheet-border.js"),St=dt("./dist/core/core.enum.js"),d=dt("./dist/core/celltype/basecelltype.js"),wt=dt("./dist/core/worksheet/stylehelper.js"),bt=function(t){return t.getSparkline},xt=vt.Common.Uf,M=et.mt.gt,nt=et.mt.vt,it=et.mt.bt,Gt=et.mt.St,ct=et.mt.Tt.safari,Ct=vt.Common.lt.ht,rt=vt.Common.lt.q8,B=et.mt.Ct,c=e.p5,ot=e.W.V,at=e.W.Lge,st=null,yt=void 0,N=Math.min,E=Math.max,w=Math.abs,b=Math.sin,C=Math.cos,f=Math.tan,l=Math.floor,Mt=Math.round,I=parseInt,ut="black",a="transparent",v="rowHeader",g="columnHeader",h="white",ft="number",y=2,m=100,n.prototype.b7=function(t,e,n){var i,r,o,a,s,u,c,i=this,r=i.l7[t];if(r)return r;if(a=(o=i.Vx).length,s=new mt.K8,e=e||et.q.J(),0<a){for(s.headingOverflowLayouts=i.y7(t,e),c=0;c<a;c++)(u=this.w7(t,c,e,n))&&s.push(u);s.trailingOverflowLayouts=i.C7(t,e)}return i.l7[t]=s},n.prototype.w7=function(t,e,n,i){var r,o,a,s,u,c,f,l,s,h,d,v,s,e,a,g,m,p,u,S,e,s,e,s,e,a,w,n,r=this,o=r.Mf,a=o.Jt,s=r.Vx,u=s.length;if(0!==u&&(p=s[0].col,u=s[u-1].col,n=n||et.q.J(),!(Tt(s=s[e])<=0))&&(h=s.col,d=a.o2e(t,h),v=a.$t(t,h,3,1),c=d.textOrientation,f=d.isVerticalText,l=d.textIndent&&0!==d.textIndent,S=d&&(d.borderLeft||d.borderTop||d.borderRight||d.borderBottom),!Ct(v)||d.watermark||d.cellType)&&(e=o.parent&&o.parent.options.numbersFitMode,!((d.shrinkToFit||!c&&d.wordWrap&&(e===St.NumbersFitMode.mask||e===St.NumbersFitMode.overflow&&!B(v))||f)&&4!==d.hAlign||4!==d.hAlign&&!1===o.options.allowCellOverflow||(s=o.conditionalFormats)&&(s=(e=s.U(o,t,h,v,3))&&e.dataBar,e=e&&e.iconSet,s&&s.showBarOnly||e&&e.showIconOnly))))return s=a.Kt(h),e=a.Gt(t),a=d.cellType||r.f7,g=et.Be.Cl(o,d,v,w={},{row:t,col:h,sheet:o}),w.content&&0<w.content.length&&!d.shrinkToFit&&c&&(g=a.de(n,w.content,e-4,d.font)),3===(a=d.hAlign)&&(a=M(a,v,d.formatter||d._autoFormatter,c)),n=o.options.rightToLeft,!S||!c||f&&4!==a||l?0===a?m=n?r.T7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,p):r.S7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,u):2===a?m=n?r.S7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,u):r.T7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,p):1===a?m=r.A7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,p,u):4===a&&(m=r.I7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,0,o.getColumnCount()-1)):c<0&&-90<c?m=r.x7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,p):0<c&&c<90&&(m=r.x7({data:v,style:d,width:s,text:g,printZoomFactor:i},t,h,u,!0)),m},n.prototype.N7=function(t){for(var e,n,i,r,o,a,s,u,c,f,e=this,n=e.Vx,i=n.length,r,o=e.Mf.Jt,f=i-1;0<=f;f--)if(c=(a=n[f]).col,s=o.qt(t,c),(u=o.$t(t,c,3,1))||s.watermarks)return this.w7(t,f)},n.prototype.S7=function(t,e,n,i){var r=this;return z(r.Mf,r.u7,r.f7,r.c7,t,e,n,i,!0)},n.prototype.T7=function(t,e,n,i){var r=this;return z(r.Mf,r.u7,r.f7,r.c7,t,e,n,i)},n.prototype.x7=function(t,e,n,i,r){var o,a,s,u,o,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,o=this,a=o.Mf,s=o.u7,u=o.f7,o=o.c7,c=a.Jt,f=Tt(t),l=Tt(t),h=t.style,v=t.text,g=t.printZoomFactor,m=h.watermark,p=h.wordWrap,S=h.textOrientation,C=h&&(h.borderLeft||h.borderTop||h.borderRight||h.borderBottom),y=h.isVerticalText,M=h.textIndent&&0!==h.textIndent,k=a.options.allowCellOverflow;if(s.findCell(e,n))return st;if(h.cellButtons&&0<h.cellButtons.length)return st;if(wt.W.Xue(h))return st;if(!(T=h.cellType||u).allowOverflow||!v&&!m||!S&&p)return st;if(v=v||m,!k&&!S)return st;if((w=!C||y||M?P(t.data,v,h,o,a,e,n,g):O(S,c.Kt(n),c.Gt(e)))<=l)return st;for(d=(G=x=n)+(r?1:-1);(r?d<=i:i<=d)&&!s.findCell(e,d)&&!(b=c.qt(e,d)).watermark&&!(b.cellType&&"1"!==b.cellType.typeName||b.cellButtons&&0<b.cellButtons.length||wt.W.Xue(b))&&(r?G=d:x=d,!(w<=(l+=c.Kt(d))));d+=r?1:-1);return r&&G===n||!r&&x===n?st:new mt.Q8(n,x,G,w,f,l,r?-1:l,r?l:-1)},n.prototype.A7=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,C;if(B(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==St.NumbersFitMode.overflow)return st;if(s=(a=(o=this).Mf).Jt,u=o.u7,c=Tt(t),f=Tt(t),h=t.style,v=t.text,g=t.printZoomFactor,m=h.textOrientation,p=h.watermark,S=h.wordWrap,C=a.options.allowCellOverflow,u.findCell(e,n))return st;if(h.cellButtons&&0<h.cellButtons.length)return st;if(wt.W.Xue(h))return st;if(!(y=h.cellType||o.f7).allowOverflow||!v&&!p||!m&&S&&a.parent&&a.parent.options.numbersFitMode!==St.NumbersFitMode.overflow)return st;if(!C&&!m)return st;if((w=P(t.data,v=v||p,h,o.c7,a,e,n,g))<=f)return st;if(90===Math.abs(m)&&S)return st;for(k=f/2,d=(M=n)-1;i<=d&&!u.findCell(e,d)&&(b=s.qt(e,d),l=s.$t(e,d,3,1,{style:b}),T=b.textOrientation,!s.JVe(d)||(Ct(l)||T&&m))&&!b.watermark&&!(b.cellType&&"1"!==b.cellType.typeName||b.cellButtons&&0<b.cellButtons.length||wt.W.Xue(b))&&(M=d,!(w/2<=(k+=s.Kt(d))));d--);for(G=f/2,d=(x=n)+1;d<=r&&!u.findCell(e,d)&&(b=s.qt(e,d),l=s.$t(e,d,3,1,{style:b}),T=b.textOrientation,!s.JVe(d)||(Ct(l)||T&&m))&&!b.watermark&&!(b.cellType&&"1"!==b.cellType.typeName||b.cellButtons&&0<b.cellButtons.length||wt.W.Xue(b))&&(x=d,!(w/2<=(G+=s.Kt(d))));d++);return M===x?st:(C=a.options.rightToLeft,new mt.Q8(n,M,x,w,c,k+G,C?G:k,C?k:G))},n.prototype.k7=function(t,e,n){var i,e,r,i=t.qt(e,n),e=t.$t(e,n,3,1,{style:i}),r;return!t.JVe(n)||!(!i.textOrientation&&!Ct(e)||i.watermark||i.cellType&&"1"!==i.cellType.typeName||i.cellButtons&&0<i.cellButtons.length||wt.W.Xue(i))},n.prototype.I7=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,m,S,v,w,b,C,y,M,k,T,x,o=this,a=o.Mf,s=a.Jt,u=o.u7,c=Tt(t),l=t.style,h=l.shrinkToFit,v=t.text,g=t.printZoomFactor,m=l.watermark,p=l.wordWrap;if(u.findCell(e,n))return st;if(l.cellButtons&&0<l.cellButtons.length)return st;if(wt.W.Xue(l))return st;for(m=P(t.data,v=v||m,l,o.c7,a,e,n,g),b=s.Kt(w=v=n),C=v+1;C<=r&&(S=s.qt(e,C),f=s.$t(e,C,3,1,{style:S}),Ct(f)&&4===S.hAlign&&Ct(a.getSpan(e,C)))&&!S.watermark&&!(S.cellType&&"1"!==S.cellType.typeName||S.cellButtons&&0<S.cellButtons.length||wt.W.Xue(S));C++)w=C,b+=s.Kt(C);if(y=(m-b)/2,B(t.data)&&this.Mf.parent&&this.Mf.parent.options.numbersFitMode!==St.NumbersFitMode.overflow&&(y=0),M=v,T=w,x=k=b/2,!h&&!p&&!1!==a.options.allowCellOverflow){for(d=n-1;i<=d&&0<y&&(this.k7(s,e,d)&&!u.findCell(e,d))&&(M=d,!(y<=(k+=s.Kt(d))-b/2));d--);for(d=w+1;d<=r&&0<y&&(this.k7(s,e,d)&&!u.findCell(e,d))&&(T=d,!(y<=(x+=s.Kt(d))-b/2));d++);}return new mt.Q8(n,M,T,m,c,k+x,k,x,b)},n.prototype.y7=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,f,p,S,w,b,C,n=this,i=n.Mf,r=i.Jt,o=n.Vx;if(0===o.length)return[];for(a=o[0].col,s=o[o.length-1].col,u=i.Ut,w=[],e=e||et.q.J(),b=i.options.rightToLeft,C=1;C<100;C++){if((v=a-C)<0)return w;if(u.findSpan(t,v)||i.Cb&&i.Cb.D7(t,v,St.SheetArea.viewport))return w;f=r.$t(t,v,3,1),0<(l=r.Kt(v))&&!Ct(f)&&(4!==(d=(c=r.qt(t,v)).hAlign)&&!1===i.options.allowCellOverflow||(3===d&&(d=M(d,f,yt,c.textOrientation)),h=r.Gt(t),p=c.cellType||n.f7,m=et.Be.Cl(i,c,f,S={},{row:t,col:v,sheet:i}),f={data:f,style:c,width:l,text:m=S.content&&0<S.content.length&&!c.shrinkToFit&&c.textOrientation?p.de(e,S.content,h-4,c.font):m},0<c.textOrientation&&c.textOrientation<90?g=n.x7(f,t,v,s,!0):0===d&&!b||2===d&&b?g=n.S7(f,t,v,s):1===d?g=n.A7(f,t,v,a,s):4===d&&(g=n.I7(f,t,v,a,s)),g&&g.endColumn>=a&&w.push(g)))}return w},n.prototype.C7=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,f,b,C,y,n=this,i=n.Mf,r=i.Jt,o=n.Vx;if(0===o.length)return[];for(a=o[0].col,s=o[o.length-1].col,u=i.Ut,m=i.getColumnCount(),b=[],e=e||et.q.J(),C=i.options.rightToLeft,y=1;y<100;y++){if(m<=(p=s+y))return b;if(u.findSpan(t,p)||i.Cb&&i.Cb.D7(t,p,St.SheetArea.viewport))return b;f=r.$t(t,p,3,1),0<(l=r.Kt(p))&&!Ct(f)&&(4!==(d=(c=r.o2e(t,p)).hAlign)&&!1===i.options.allowCellOverflow||(3===d&&(d=M(d,f,yt,c.textOrientation)),h=r.Gt(t),v=c.cellType||n.f7,w=et.Be.Cl(i,c,f,g={},{row:t,col:p,sheet:i}),f={data:f,style:c,width:l,text:w=g.content&&0<g.content.length&&!c.shrinkToFit&&c.textOrientation?v.de(e,g.content,h-4,c.font):w},c.textOrientation<0&&-90<c.textOrientation?S=n.x7(f,t,p,a,!1):2===d&&!C||0===d&&C?S=n.T7(f,t,p,a):1===d?S=n.A7(f,t,p,a,s):4===d&&(S=n.I7(f,t,p,0,s+100)),S&&S.startColumn<=s&&b.push(S)))}return b},Bt=n,t.p7=Bt,t.needPaintSelection=W,i.prototype.xpe=function(t,e){var n,i,e,n=this.Mf,i=n.getParent(),e={sheetArea:t,isPrinting:e,isNeedHighlightInvalid:!e&&3===t&&i&&i.options.highlightInvalidData};return gt.Worksheet.et(n,"sheetHighlightInvalid",e),e.isNeedHighlightInvalid},i.prototype.J=function(){var t,e,t,t=this.Mf,e=st,t=t.Dg();return e=t&&t.getContext?t.getContext("2d"):e},i.prototype._7=function(){var t,e,n,i,r,i,o,r,t=this,e=t.Mf,n=e.ot(),i=e.fg,r=Tt(i),i=kt(i),o=t.E7;return o&&Tt(o)===r&&kt(o)===i||(o&&(et.Bf.th(e,o),t.TCe()),t.E7=o=et.mt.En("canvas"),o.getContext&&(t.j7=o.getContext("2d"),et.Bf.Wl(o,st,e),et.Bf.$l(o,Tt(n),kt(n)))),(r=t.j7)&&(r.beginPath(),it(r,t._n(t.Nn())),r.name="bufferContext"),r},i.prototype.Nn=function(){return this.c7||(this.c7=c+" "+this.Mf.currentTheme().bodyFont()),this.c7},i.prototype.O7=function(){this.c7=st},i.prototype.R7=function(t){var e,n,i,e,r,e=this.Mf,n=e.parent,i=n?n.options.grayAreaBackColor||et.I.ll("gc-grayArea").backgroundColor:"gray",e=et.Pf.vl(e,i);return e=t&&(r=n?n.options.backgroundImage:st)?a:e},i.prototype._n=function(t){var e,n=this.Mf.zoom();return 1===n?t:ot(t,n).font},i.prototype.FA=function(t,e,n,i,r){var o,a,s,o,u,r,r,r,o=this,a=o.E7,s=o.J();!(n<=0||i<=0)&&a&&s&&(r=r||o.Mf.ot(),o=et.Bf.Kl(a),u=et.Bf.Jl(a),1!==o&&(t*=o,e*=u,n*=o,i*=u,r=new et.Rect(r.x*o,r.y*u,Tt(r)*o,kt(r)*u)),r=r.getIntersect(t,e,n,i))&&(r.round(),t=r.x,e=r.y,n=Tt(r),i=kt(r),(r=Tt(a))&&r<t+n&&(t=r-n)<0&&(n+=t,t=0),(r=kt(a))&&r<e+i&&(e=r-i)<0&&(i+=e,e=0),et.Lf.Vl(s,1,1),s.clearRect(t,e,n,i),s.drawImage(a,t,e,n,i,t,e,n,i),et.Lf.Vl(s,o,u))},i.prototype.O1=function(t,e){t&&this.FA(t.x,t.y,Tt(t),kt(t),e)},i.prototype.Ey=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y;if(void 0===a&&(a=!1),0<n&&0<i)try{u=(s=this).Mf,c=s.J(),f=u.Dg(),l=s._7(),h=s.E7,g=r,m=o,p=n,S=i,w=et.Bf.Kl(f),b=et.Bf.Jl(f),t=Mt(t*w),e=Mt(e*b),n=Mt(n*w),i=Mt(i*b),g=Mt(g*w),m=Mt(m*b),p=Mt(p*w),S=Mt(S*b),C=Tt(h),y=kt(h),C&&C<t+n&&(t=C-n)<0&&(n+=t,t=0),y&&y<e+i&&(e=y-i)<0&&(i+=e,e=0),C&&C<g+p&&(g=C-p)<0&&(p+=g,g=0),y&&y<m+S&&(m=y-S)<0&&(S+=m,m=0),et.Lf.Vl(c,1,1),et.Lf.Vl(l,1,1),a?(l.clearRect(g,m,p,S),l.drawImage(f,t,e,n,i,g,m,p,S)):(c.clearRect(g,m,p,S),c.drawImage(h,t,e,n,i,g,m,p,S),l.clearRect(g,m,p,S),l.drawImage(f,g,m,p,S,g,m,p,S)),et.Lf.Vl(c,w,b),et.Lf.Vl(l,w,b)}catch(t){}},i.prototype.E1=function(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,u,C,y,C,M,k,T,x,x,G,x,k,T,M,M,t,M,G,k,B,I,P,R,T,r,a=this,s=a.Mf,u=Ct(r)||3===r;if(n=n||a.J(),f=(c=!1,et.Ec)(-1,-1,-1,-1),l=s.Ut,t&&(f=s.options.allowCellOverflow||s.gD?(0,et.Ec)(t.row,0,t.rowCount,s.getColumnCount(r)):(0,et.Ec)(t.row,t.col,t.rowCount,t.colCount),u)&&!o){if(0<=f.col){for(d=f.col,v=f.col+f.colCount-1,g=s.getRowCount(1),m=0;m<g;m++)(h=l.findSpan(m,f.col,1))?d=N(h.col,d):s.z9&&(d=N(s.z9.col,d)),(h=l.findSpan(m,f.col+f.colCount-1,1))?v=E(h.col+h.colCount-1,v):s.z9&&(v=E(s.z9.col+s.z9.colCount-1,v));f.col=d,f.colCount=v-d+1}if(0<=f.row){for(p=f.row,S=f.row+f.rowCount-1,w=s.getColumnCount(2),b=0;b<w;b++)(h=l.findSpan(f.row,b,2))?p=N(h.row,p):s.z9&&(p=N(s.z9.row,p)),(h=l.findSpan(f.row+f.rowCount-1,b,2))?S=E(h.row+h.rowCount-1,S):s.z9&&(S=E(s.z9.row+s.z9.rowCount-1,S));f.row=p,f.rowCount=S-p+1}}if(u=s.j1(f,r),s.cellStates&&s.cellStates.hasIntersectInSelectionState(f.row,f.col,f.rowCount,f.colCount)&&s.repaint(u),y=(C=s._1)&&C.isEnable(St.RowColumnStates.selected,!0),C=C&&C.isEnable(St.RowColumnStates.selected,!1),t&&(M=void 0,(y||C)&&(M=s.s7(s.C0(t.row),s.S0(t.col),St.SheetArea.viewport,!1)),y&&(k=t.row,T=t.rowCount,M&&0<M.length&&(x=M.findLargestRange(t,!0))&&(x=(0,et.Ec)(x.row,x.col,x.rowCount,x.colCount),k=(G=t.union(x)).row,T=G.rowCount),x=s.j1((0,et.Ec)(k,-1,T,-1),r),u.x=N(u.x,x.x),u.y=N(u.y,x.y),u.width=E(u.width,x.width),u.height=E(u.height,x.height)),C)&&(k=t.col,T=t.colCount,M&&0<M.length&&(M=M.findLargestRange(t,!1))&&(M=(0,et.Ec)(M.row,M.col,M.rowCount,M.colCount),k=(G=t.union(M)).col,T=G.colCount),x=s.j1((0,et.Ec)(-1,k,-1,T),r),u.x=N(u.x,x.x),u.y=N(u.y,x.y),u.width=E(u.width,x.width),u.height=E(u.height,x.height)),t=Tt(u),M=kt(u),G=u.x,k=u.y,0<=t||0<=M){if(P=18,R=30,u.x+=I=B=-9,u.y+=-9,u.width+=18,u.height+=30,e&&!(u=u.getIntersectRect(e)))return;T=s.Fi(),r=s.options.rightToLeft,0<M&&!o&&(s.k1=!0,a._e(n,new et.Rect(r?T.x+T.width-T.XC:T.x,E(T.T6,k),T.XC,M),i)),0<t&&!o&&(s.k1=!0,a._e(n,new et.Rect(E(r?T.x:T.b6,G),T.y,t,T.qC),i)),-1!==f.row||-1!==f.col||o||(s.k1=!0,a._e(n,T.R1(),i)),0<t&&0<M&&((y||C)&&(s.k1=!0),a._e(n,u,i)),c=!0}return c},i.prototype._6=function(t,e,n,i,r){var o,a,s,o=this,a=o.Mf;a.My<=0&&(s=o.J())&&(r||(a.k1=!0),o._e(s,new et.Rect(t,e,n,i)))},i.prototype.repaint=function(t){var e,n,i,e=this,n=e.Mf;0<n.My||(i=e.J())&&(n.k1=!0,e._e(i,t))},i.prototype._e=function(t,e,n){var i=this;t&&i.Mf.My<=0&&(n||i.D1(t,e),i.jy(t,e))},i.prototype.D1=function(t,e,n,i){var r,o,a,t,s,o,r=this,o=r.Mf;t&&o.My<=0&&(t=(a=r._7())||t,s=o.ot(),(e=e||s)&&e.round(),n&&n.round(),o.k1&&(o.k1=!1,o=i||e,a&&(a.clearRect(o.x,o.y,Tt(o),kt(o)),n&&a.clearRect(n.x,n.y,Tt(n),kt(n)),et.Lf.Yl(a,-s.x,-s.y)),r.B7(t,o),n&&r.B7(t,n),a)&&et.Lf.Yl(a,s.x,s.y),a)&&(r.O1(e),n)&&r.O1(n)},i.prototype.jy=function(t,e){var n,i,r,o,a,s,u,c,n=this,i=n.Mf,r=i.Oi;if(t&&!(0<i.My)&&(e&&e.round(),o=i.Fi(),gt.Worksheet.et(i,"beforePaintAdornment",{ctx:t,clipRect:e}),!i.D_)){if(r){for(a=o.R1(),n.O1(a),u=0;u<=2;u++)(a=o.B1(u))&&0!==Tt(a)&&0!==kt(a)&&n.O1(a);for(c=0;c<=2;c++)(a=o.L1(c))&&0!==Tt(a)&&0!==kt(a)&&n.O1(a)}else if(i.NMi&&i.NMi.options.isDesignMode)for(c=0;c<=2;c++)!(a=o.L1(c))||0===Tt(a)||0===kt(a)||(s=e)&&!a.intersectRect(s)||n.L7(t,-1,c,s,1);for(u=0;u<=2;u++)for(c=0;c<=2;c++)(a=o.c9(u,c))&&0!==Tt(a)&&0!==kt(a)&&(s=e,(r&&(1!==u||1!==c)||i.parent&&i.parent.options.allowUserDragMerge)&&(n.O1(a),s=a),s&&!a.intersectRect(s)||n.L7(t,u,c,s));n.F7(t),gt.Worksheet.et(i,"paintAdornment",{ctx:t,clipRect:e})}},i.prototype.wm=function(t,e){var n,i,i,r,n,o,n=this.Mf,i=n.parent,i=i?i.options:{},r=lt(n),n=et.Pf.vl(n,r),o;i.backgroundImage&&(n=a),t.save(),t.fillStyle=n,t.fillRect(e.x,e.y,Tt(e),kt(e)),t.restore()},i.prototype.P7=function(t,e){var n,i,r,n=this.Mf,i=n.Fi(),r=0<n.frozenRowCount()?0:1;return 0===i.qC&&(t===n.getViewportTopRow(r)||e)},i.prototype.G7=function(t,e){var n,i,r,n=this.Mf,i=n.Fi(),r=0<n.frozenColumnCount()?0:1;return 0===i.XC&&(t===n.getViewportLeftColumn(r)||e)},i.prototype.U7=function(t,e,n,i,r){var o,a,s,i,u,c,u,n,o=this,a=o.Mf,s=0===i.width,i=0===i.height,u=a.options,c=u.sheetAreaOffset.top,u=u.sheetAreaOffset.left,n=n.c9(t,e);return n&&(i&&o.P7(a.H7(t),r)&&(n.y=n.y-c,n.height=n.height+c),s)&&o.G7(a.z7(e),r)&&(n.x=n.x-u,n.width=n.width+u),n},i.prototype.V7=function(t,e,n,i){for(var r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,o,r=this,o=r.Mf,a=o.options,s=o.Fi(),u=a.sheetAreaOffset.top,c=a.sheetAreaOffset.left,f=0!==s.qC,l=0!==s.XC,h=o.gj&&o.gj()||{x:a.sheetAreaOffset.left,y:a.sheetAreaOffset.top,width:0,height:0},d=0===h.width,v=0===h.height,m=0;m<=2;m++)(S=s.L1(m))&&(f&&v&&(S.y=S.y-u,S.height=S.height+u,!l)&&d&&(S.x=S.x-c,S.width=S.width+c),p=e?S.getIntersectRect(e):S)&&r.Y7(t,m,p,n,i);for(g=0;g<=3;g++)for((w=s.B1(g))&&(l&&d&&(w.x=w.x-c,w.width=w.width+c,!f)&&v&&(w.y=w.y-u,w.height=w.height+u),p=e?w.getIntersectRect(e):w)&&r.Z7(t,g,p,n,i),m=0;m<=2;m++)(b=r.U7(g,m,s,h,n))&&(p=e?b.getIntersectRect(e):b)&&r.W7(t,g,m,p,n,i);(o=s.R1())&&(p=e?o.getIntersectRect(e):o)&&r.Q7(t,p,n,i)},i.prototype.K7=function(t){var e,n,i,r,o,a,s,u,c,f,i,l,r,h,e=this,n=e.Mf,i=n.options.rightToLeft,r=n.Fi(),o=i?r.x:r.BA,a=r.LA,s=Tt(r),u=r.Ay,c=r.Iy,f=r.J7,i=i?r.Uy-1:r.Uy,l=r.X7,r=r.Ty;0<r&&(t.fillStyle=e.R7(!1),t.fillRect(o,l,s,r)),0<i&&(t.fillStyle=e.R7(!1),t.fillRect(f,a,i,l),h=n.Ny)&&t.fillRect(f,u,i,c)},i.prototype.q7=function(t,e){var n,i,r,i,o,i,a,s,u,e,n=this,i=n.Mf,r=n.R7(!1),i=i.options,o=i.sheetAreaOffset.left,i=i.sheetAreaOffset.top,a=e.x,s=e.y,u=Tt(e),e=kt(e);t.save(),0<o&&L(t,o,r,a+o/2,0<i?s+i:s,a+o/2,s+E(0,e)),0<i&&L(t,i,r,0<o?a+o:a,s+i/2,a+E(0,u),s+i/2),0<o&&0<i&&(t.fillStyle=n.R7(!1),t.fillRect(a,s,o,i)),t.beginPath(),t.restore()},i.prototype.B7=function(t,e){var n,i,r,n=this,i=n.Mf;!t||0<i.My||(r=i.ot(),t.save(),e?t.rect(e.x,e.y,Tt(e),kt(e)):t.rect(r.x,r.y,Tt(r),kt(r)),t.clip(),t.beginPath(),n.wm(t,r),gt.Worksheet.et(i,"paint",{ctx:t,clipRect:e}),n.q7(t,r),n.V7(t,e,!1),n.K7(t),n.KTe(t,e),n.tO(t),gt.Worksheet.et(i,"paintSheetEnd",{ctx:t,clipRect:e}),t.beginPath(),t.restore())},i.prototype.nO=function(t,e,n){var i,r,r,e,i=this,r=i.Mf;t&&(r=r.ot(),t.save(),e=e||new et.Rect(r.x,r.y,Tt(r),kt(r)),t.rect(e.x,e.y,Tt(e),kt(e)),t.clip(),t.beginPath(),i.wm(t,r),i.V7(t,e,!0,n),t.beginPath(),t.restore())},i.prototype.F7=function(t){var e,n,i,r,o,a,s,u,c,u,c,s,s=this.Mf,u=s.rt,c=s.sw;if(u&&u.isResizing&&c&&(u=c.resizeInfo)){if(c=s.Fi(),s=ut,t.save(),t.strokeStyle!==s&&(t.strokeStyle=s),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===u.action||"sizeHiddenRow"===u.action)for(n=E(0,u.startY-.5),r=u.movingY-.5,o=c.x+Tt(c),e=c.x;e<o;e+=2)t.moveTo(e,n),t.lineTo(e+1,n),t.moveTo(e,r),t.lineTo(e+1,r);else for(e=E(0,u.startX-.5),i=u.movingX-.5,a=c.y+kt(c),n=c.y;n<a;n+=2)t.moveTo(e,n),t.lineTo(e,n+1),t.moveTo(i,n),t.lineTo(i,n+1);t.stroke(),t.beginPath(),t.restore()}},i.prototype.TCe=function(){et.Lf.d5(this.E7),this.E7=null,this.j7=null},i.prototype.Q7=function(t,e,n,i){var r,o,a,s,u,o,c,c,r=this.Mf;t.beginPath(),a=(o=r.Fi().R1()).x,s=o.y,u=Tt(o),o=kt(o),c=r.getActualStyle(-1,-1,0),this.eO(t,[{data:st,row:-1,col:-1,x:a,y:s,width:u,height:o,style:c.clone()}],0,n,i),(c=new pt.Yx(r,r._y(0,0),r.Yy(0,0),0)).PN(0,0,a,s,u,o,st,st,st,st,{printZoomFactor:i}),c.paint(t,i)},i.prototype.KTe=function(t,e){this.XTe(t,e),this.qTe(t,e)},i.prototype.XTe=function(t,e){var n,i,r,i,o,e,e,a,s,i,u,c,f,l,h,d,h,d,h,n=this.Mf,i=n.Fi(),r=i.$Te(),i=i.XAe();Ct(r)||Ct(i)||(r.x-=o=4,r.width+=6,r.height+=4,e=r.getIntersectRect(e),Ct(e))||(t.save(),t.beginPath(),t.rect(e.x,e.y,Tt(e),kt(e)),t.clip(),e=i.x,a=i.y,s=Tt(i),i=kt(i),u=n.PTe(St.SheetArea.colHeader,!0),f=[],l=a-r.y,d=(h=D(n,St.SheetArea.colHeader))?n.sw.row:yt,h=h?n.sw.col:yt,0<l&&(c=n.getDefaultStyle(St.SheetArea.colHeader).clone(!0),u.borderBottom&&(c.borderBottom=u.borderBottom.Gf()),f.push({data:yt,row:yt,col:yt,x:e,y:r.y,width:s,height:l,style:c})),f.push({data:u.backgroundImage?yt:"+",row:d,col:h,x:e,y:a,width:s,height:i,style:u}),this.eO(t,f,St.SheetArea.colHeader,!1),d=new pt.Yx(n,n._y(0,St.SheetArea.colHeader),n.Yy(0,St.SheetArea.colHeader),St.SheetArea.colHeader),(h=0)<l&&(h=1,d.PN(0,0,e,r.y,s,l,c)),d.PN(h,0,e,a,s,i,u),d.paint(t),t.restore())},i.prototype.qTe=function(t,e){var n,i,r,i,o,e,e,a,s,i,u,c,f,l,h,d,h,d,h,n=this.Mf,i=n.Fi(),r=i.t9e(),i=i.qAe();Ct(r)||Ct(i)||(r.y-=o=4,r.width+=4,r.height+=6,e=r.getIntersectRect(e),Ct(e))||(t.save(),t.beginPath(),t.rect(e.x,e.y,Tt(e),kt(e)),t.clip(),e=i.x,a=i.y,s=Tt(i),i=kt(i),u=n.PTe(St.SheetArea.rowHeader,!0),f=[],l=e-r.x,d=(h=D(n,St.SheetArea.rowHeader))?n.sw.row:yt,h=h?n.sw.col:yt,0<l&&(c=n.getDefaultStyle(St.SheetArea.rowHeader).clone(!0),u.borderRight&&(c.borderRight=u.borderRight.Gf()),f.push({data:yt,row:yt,col:yt,x:r.x,y:a,width:l,height:i,style:c})),f.push({data:u.backgroundImage?yt:"+",row:d,col:h,x:e,y:a,width:s,height:i,style:u}),this.eO(t,f,St.SheetArea.rowHeader,!1),d=new pt.Yx(n,n._y(0,St.SheetArea.rowHeader),n.Yy(0,St.SheetArea.rowHeader),St.SheetArea.rowHeader),(h=0)<l&&(h=1,d.PN(0,0,r.x,a,l,i,c)),d.PN(0,h,e,a,s,i,u),d.paint(t),t.restore())},i.prototype.tO=function(t){var e,n,i,r,o,a,s,u,c,n,f,l,h,d,s,e=this.Mf,n=e.options.rightToLeft,i=e.frozenRowCount(),r=e.frozenColumnCount(),o=e.frozenTrailingRowCount(),a=e.frozenTrailingColumnCount();(i||r||o||a)&&(s=e.Fi(),u=n?s.b6:s.Py,c=s.Cy,n=n?s.Hy+s.zy:s.Hy,f=s.Ay,l=s.x,h=s.y,d=Tt(s),s=kt(s),t.save(),t.strokeStyle=et.Pf.vl(e,e.options.frozenlineColor),t.lineWidth=1,t.beginPath(),r&&(t.moveTo(u-.5,h),t.lineTo(u-.5,h+s)),i&&(t.moveTo(l,c-.5),t.lineTo(l+d,c-.5)),a&&(t.moveTo(n-.5,h),t.lineTo(n-.5,h+s)),o&&(t.moveTo(l,f-.5),t.lineTo(l+d,f-.5)),t.stroke(),t.restore())},i.prototype.Y7=function(t,e,n,i,r){this.iO(t,-1,e,1,n,i,r)},i.prototype.Z7=function(t,e,n,i,r){this.iO(t,e,-1,2,n,i,r)},i.prototype.W7=function(t,e,n,i,r,o){var a,s,r,o,a=this.Mf,s=a.getCalcService&&a.getCalcService();3!==e&&s&&s.HJe(!0),this.iO(t,e,n,3,i,r,o),3!==e&&s&&(r=!s.calcOnDemand,s.HJe(!1,r,a)),(o=this.Mf.lA)&&o.oO(t,i,e,n)},i.prototype.aO=function(t,e,n,i,r){var o,a,s,a,e,n,o,a=this.Mf,s=a.getRangeRect(e,n,(0,et.Ec)(r.row,r.col,r.rowCount,r.colCount));(s=s.getIntersectRect(a.Fi().c9(e,n)))&&(s.round(),a=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",a||t.setLineDash([6,2]),e=s.x+.5,n=s.y+.5,t.strokeRect(e,n,Tt(s),kt(s)),t.beginPath(),t.restore())},i.prototype.L7=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,m,p,l,l,S,w,b,l,C,y,M,k,h,M,h,T,x,G,k,M,h,T,o=Ct(r)||3===r,a=this,s=a.Mf;if(W(s)&&s.addSelection&&(l=3===e,h=s.Ut,d=s.rt,g=(v=h.getSelections(r)).length,i=a.uO(e,n,i))&&(m=et.I.fl("gc-selection"),p=I(m.zIndex),o&&!l&&(2007<p&&a.sO(t,e,n,i),l=s.Uw&&s.Uw(3),l=h.cO=l&&l.t8.getAnchorInfo(s.getActiveRowIndex(),s.getActiveColumnIndex()))&&a.aO(t,e,n,i,l),b=void 0,!((w=(S=a.fO(e,n,v,i)).length)<=0))){for(l=o&&a.fO(e,n,[s.z9],i)[0],C=!1,y=void 0,y=0;y<w;y++)if(b=S[y],!i.containsRect(b)){C=!0;break}if(l&&!i.containsRect(l)&&(C=!0),t.save(),C&&(s.options.rightToLeft&&(i.x-=2),t.rect(i.x,i.y,Tt(i),kt(i)),t.clip()),t.beginPath(),0<w)for(f=et.Pf.vl(s,s.getSelectionBackColor()),t.fillStyle!==f&&(t.fillStyle=f),c=u=0,2007<p&&(u=1,c=-3),y=0;y<w;y++)b=S[y],t.fillRect(b.x+u,b.y+u,Tt(b)+c,kt(b)+c);s.RD||(M=s.ui,k=s.ci,1===r?(M=(h=h.J9()||v[0]).row,k=h.col):l&&(M=s.U9,k=s.H9),G=x=T=h=void 0,(M=s.getCellRect(M,k,e,n))&&M.intersectRect(i)&&(h=M.x,T=M.y,x=Tt(M),G=kt(M),u=1,c=-2,2007<p&&(c=u=0),a.FA(h+u,T+u,x+c,G+c),1<g)&&(t.strokeStyle=et.Pf.vl(s,s.getSelectionBorderColor()),t.lineWidth=1,t.strokeRect(h+1.5,T+1.5,x-4,G-4))),t.restore(),t.save(),t.beginPath(),1===g&&(o&&d&&d.Yk&&d.lO&&d.lO()&&!d.hO&&(k=d.dO&&d.dO(),h=Tt(M=s.getRangeRect(e,n,k)),T=kt(M),M)&&0<h&&0<T&&(t.fillStyle=m&&m.color,t.fillRect(M.x,M.y,h,T)),b)&&0<=Tt(b)&&0<=kt(b)&&(a.vO(i,s,e,n,p),a.mO(t,e,n,b,i,v[0],r)),l&&(t.save(),C&&(t.rect(i.x,i.y,Tt(i),kt(i)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(l.x+u,l.y+u,Tt(l)+c,kt(l)+c),t.fillStyle=f,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(l.x-.5,l.y-.5,Tt(l),kt(l)),t.restore()),t.beginPath(),t.restore()}},i.prototype.vO=function(t,e,n,i,r){var o,a,s,u,o,a,c,f,r,l,s,h,d,v,s,r,l,f,c,o=e.frozenTrailingRowCount(),a=e.frozenTrailingColumnCount(),s=e.getSelections(),u=e.Fi(),o=e.getRowCount()-o-1,a=e.getColumnCount()-a-1,c=e.Yy(1,3),f=e._y(1,3);1===s.length&&2007<r&&(r=e.frozenRowCount(),l=e.frozenColumnCount(),h=(s=s[0]).row,d=s.col,v=s.rowCount,s=s.colCount,0<r&&(r<=h&&e.nI(h)<r?(t.y-=2,t.height+=2):h+v<=r&&e.j5(h+v-1)===e.Tb&&(t.height+=2)),0<l&&(l<=d&&e.r6(d)<l?(t.x-=2,t.width+=2):d+s<=l&&e.O5(d+s-1)===e.Ab&&(t.width+=2)),0===h&&0===d&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===h&&(h=0,v=e.getRowCount()),-1===d&&(d=0,s=e.getColumnCount()),l=r=!1,f=f.findRow(o),c=c.findCol(a),f&&f.y+kt(f)<u.Cy+e.Sy(u)&&(r=!0),c&&c.x+Tt(c)<u.Py+e.Gy(u)&&(l=!0),r&&h+v-1==o&&(t.height+=2),l)&&d+s-1==a&&(t.width+=2)},i.prototype.sO=function(t,e,n,i){var r,o,a,s,u,c,f,F,_,a,l,h,d,a,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,E,H,U,R,r=this,o=r.Mf,a=o.Ut.getSelections(),s=o.Fi(),u=s.b6,c=s.T6,f=a.length,F=0!==s.qC,_=0!==s.XC;if(!(f<=0)){if(l=(a=a[0]).row,h=a.rowCount,d=a.col,a=a.colCount,-1===l&&(l=0),-1===d&&(d=0),-1===h&&(h=o.getRowCount()),-1===a&&(a=o.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=o.getSelectionBorderColor(),v=i.x,g=i.y,m=Tt(i),p=kt(i),S=o.frozenRowCount(),F&&(1!==f||0!==S||o.Tb<=l||o.Tb>=l+h))for(b=0,C=(w=r.gO(n)).length;b<C;b++)k=M=0,T=(y=w[b]).x,x=y.x+Tt(y),y.x<v+m&&v<y.x+Tt(y)&&(1===f&&(0===S&&o.Tb===l||0<S&&0===l)&&(M=-1,k=1),y.x<v&&(M=0,T=v),y.x+Tt(y)>v+m&&(k=0,x=v+m),t.moveTo(T+M-1,c-1),t.lineTo(x+k,c-1),t.stroke());if(G=o.frozenColumnCount(),_&&(1!==f||0!==G||o.Ab<=d||o.Ab>=d+a))for(I=0,P=(B=r.pO(e)).length;I<P;I++)E=N=0,H=(R=B[I]).y,U=R.y+kt(R),R.y<g+p&&g<R.y+kt(R)&&(1===f&&(0===G&&o.Ab===d||0<G&&0===d)&&(N=-1,E=1),R.y<g&&(N=0,H=g),R.y+kt(R)>g+p&&(E=0,U=g+p),R=o.options.rightToLeft,t.moveTo(R?s.x+s.width-s.XC-1:u-1,H+N-1),t.lineTo(R?s.x+s.width-s.XC-1:u-1,U+E),t.stroke());t.beginPath(),t.restore()}},i.prototype.gO=function(t){for(var e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,u,m,h,d,v,g,e=this.Mf,n=e.Ut.getSelections(),i=n.length,r=e.Yy(t),o=[],a=e.options.rightToLeft,s={},c=0;c<i;c++)(f=n[c])&&(-1===(l=f.col)?(h=e.Yy(0,3),d=e.Yy(1,3),v=e.Yy(2,3),u=g=-1,0<h.length&&(g=(a?h[h.length-1]:h[0]).x,u=a?h[0].x+h[0].width-g:h[h.length-1].x+h[h.length-1].width-g,o.push(new et.Rect(g,-1,u,-1))),0<d.length&&(g=(a?d[d.length-1]:d[0]).x,u=a?d[0].x+d[0].width-g:d[d.length-1].x+d[d.length-1].width-g,o.push(new et.Rect(g,-1,u,-1))),0<v.length&&(g=(a?v[v.length-1]:v[0]).x,u=a?v[0].x+v[0].width-g:v[v.length-1].x+v[v.length-1].width-g,o.push(new et.Rect(g,-1,u,-1)))):r&&(h=l+f.colCount-1,d=r.findCol(l),v=r.findCol(h),d||v)&&(g=new et.Rect(-1,-1,-1,-1),a?(g.x=(v||r[r.length-1]).x,g.width=d?d.x+Tt(d)-g.x:r[0].x+r[0].width-g.x):(g.x=(d||r[0]).x,g.width=v?v.x+Tt(v)-g.x:r[r.length-1].x+r[r.length-1].width-g.x),s[u=[g.x,g.width].join("_")]||(s[u]=!0,o.push(g))));return o},i.prototype.pO=function(t){for(var e,n,i,r,o,a,s,u,c,f,l,h,d,s,v,l,h,d,e=this.Mf,n=e.Ut.getSelections(),i=n.length,r=e._y(t),o=[],a={},u=0;u<i;u++)(c=n[u])&&(-1===(f=c.row)?(l=e._y(0,3),h=e._y(1,3),d=e._y(2,3),v=s=-1,0<l.length&&(s=l[0].y,v=l[l.length-1].y+l[l.length-1].height-s,o.push(new et.Rect(-1,s,-1,v))),0<h.length&&(s=h[0].y,v=h[h.length-1].y+h[h.length-1].height-s,o.push(new et.Rect(-1,s,-1,v))),0<d.length&&(s=d[0].y,v=d[d.length-1].y+d[d.length-1].height-s,o.push(new et.Rect(-1,s,-1,v)))):r&&(l=r.findRow(f),h=r.findRow(f+c.rowCount-1),l||h)&&((d=new et.Rect(-1,-1,-1,-1)).y=(l||r[0]).y,d.height=h?h.y+kt(h)-d.y:r[r.length-1].y+r[r.length-1].height-d.y,a[s=[d.y,d.height].join("_")]||(a[s]=!0,o.push(d))));return o},i.prototype.mO=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,C,k,s=this,u=s.Mf,c=u.parent,f=u.rt,l=i.x,h=i.y,d=Tt(i),v=kt(i),g=u.getViewportTopRow(e),m=u.getViewportLeftColumn(n),p=u.getViewportBottomRow(e),S=u.getViewportRightColumn(n),w=0,b=0,C=u.Fi(),y=0!==C.qC,M;0!==C.XC||o.col!==m&&-1!==o.col||(w=2),y||o.row!==g&&-1!==o.row||(b=2),o.row+o.rowCount===p+1&&(r.height=r.height+1),o.col+o.colCount===S+1&&(r.width=r.width+1),0<=d&&0<=v&&(!r||i.intersect(r.x-1,r.y-1,Tt(r)+2,kt(r)+2))&&(t.save(),r&&!r.containsRect(i)&&(t.rect(r.x-w,r.y-b,Tt(r),kt(r)),t.clip()),t.beginPath(),t.strokeStyle=et.Pf.vl(u,u.getSelectionBorderColor()),t.lineWidth=2,0<d&&0<v?(f&&f.Yk?2===(C=f.bO)?(t.moveTo(l+.5,h-.5),t.lineTo(l+d-1,h-.5)):3===C?(t.moveTo(l+.5,h+v-.5),t.lineTo(l+d-1,h+v-.5)):0===C?(t.moveTo(l-.5,h+.5),t.lineTo(l-.5,h+v-1)):1===C&&(t.moveTo(l+d-.5,h+.5),t.lineTo(l+d-.5,h+v-1)):2007<(k=c&&c.SC)?t.rect(l-1,h-1,d+1,v+1):t.rect(l-.5,h-.5,d,v),t.stroke(),(Ct(a)||3===a)&&c&&c.options.allowUserDragFill&&s.yO&&s.yO(t,e,n,i,r)):0!==d&&0!==v||t.strokeRect(l-1,h-1,d+1,v+1),t.beginPath(),t.restore())},i.prototype.uO=function(t,e,n){var i,r,o,e,a,e,a,i=this.Mf,r=i.Fi();return 0<=t&&0<=e?o=r.c9(t,e):-1===t?o=r.L1(e):-1===e&&(o=r.B1(t)),1===e&&(e=i.Yy(e),i.options.rightToLeft?(a=0<e.length?e[0]:st)&&(o.width=N(Tt(o),a.x+Tt(a)-r.x-r.zy)):(a=0<e.length?e[e.length-1]:st)&&(o.width=N(Tt(o),a.x+Tt(a)-r.Py))),1===t&&(a=0<(e=i._y(t)).length?e[e.length-1]:st)&&(o.height=N(kt(o),a.y+kt(a)-r.Cy)),n=n?n.getIntersect(o.x,o.y,Tt(o),kt(o)):o},i.prototype.fO=function(t,e,n,i){for(var r,o,a,s,u,c,a,f,l,r=this.Mf,o=r.Ut,s=n.length,c=[],f=r.C6(t,e),l=0;l<s;l++)(u=n[l])&&((a=o.findSpan(u.row,u.col,f))&&a.containsRange(u)&&(u=a),a=r.getRangeRect(t,e,u))&&a.x<=i.x+Tt(i)&&a.y<=i.y+kt(i)&&i.x<=a.x+Tt(a)&&i.y<=a.y+kt(a)&&c.push(a);return c},i.prototype.wO=function(t,e,n){var i,r,o,e,a,s,u,c,f,l,h;if(t.save(),i=e.x,r=e.y,o=Tt(e),e=kt(e),a=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=n,t.setLineDash(a),t.rect(i,r,o-1,e-1);else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=n,s=a[0],u=a[1],h=l=f=c=void 0,c=i,f=r,l=o;0<l;)if(s+u<=l)t.moveTo(c,f),t.lineTo(c+s,f),c=c+s+u,l=l-s-u;else{if(s<=l){t.moveTo(c,f),t.lineTo(c+s,f),l=l-s-u;break}if(0<l){t.moveTo(c,f),t.lineTo(c+l,f),l=l-s-u;break}}for(c=i+o-1,f=r+1,h=e-1,l<0&&(u<(l=w(l))&&(t.moveTo(c,f-2),t.lineTo(c,f+(l-u))),f+=l,h-=l);0<h;)s+u<=h?(t.moveTo(c,f),t.lineTo(c,f+s),f=f+s+u,h=h-s-u):s<=h?(t.moveTo(c,f),t.lineTo(c,f+s),h=h-s-u):0<h&&(t.moveTo(c,f),t.lineTo(c,f+h),h=h-s-u);for(c=i+o-2,f=r+e-1,l=o-1,h<0&&(u<(h=w(h))&&(t.moveTo(c+2,f),t.lineTo(c-(h-u),f)),c-=h,l-=h);0<l;)if(s+u<=l)t.moveTo(c,f),t.lineTo(c-s,f),c=c-s-u,l=l-s-u;else{if(s<=l){t.moveTo(c,f),t.lineTo(c-s,f),l=l-s-u;break}if(0<l){t.moveTo(c,f),t.lineTo(c-l,f),l=l-s-u;break}}for(c=i,f=r+e-2,h=e-1,l<0&&(u<(l=w(l))&&(t.moveTo(c,f+2),t.lineTo(c,f-(l-u))),f-=l,h-=l);0<h;)s+u<=h?(t.moveTo(c,f),t.lineTo(c,f-s),f=f-s-u,h=h-s-u):s<=h?(t.moveTo(c,f),f-s===r?t.lineTo(c,f-s-1):t.lineTo(c,f-s),h=h-s-u):0<h&&(r<f&&(t.moveTo(c,f),t.lineTo(c,f-h)),h=h-s-u)}t.stroke(),t.beginPath(),t.restore()},i.prototype.mfe=function(t,e,n,i,r,o){var i,a,s,u,c,f,l,h,d,v,g,m,g;if(!i&&0!==e.length){for(i=n.row,h=l=f=c=u=s=a=void 0,d=e.length-1;0<=d&&(v=e[d]).isOutside;d--)h=d;for(f=(rt(h)?(a=(g=e[h]).col,s=g.x,u=g.width,2!==g.columnHeaderFitMode?(c=e[h].y,e[h]):(c=e[h+1].y,e[h+1])):(a=e[e.length-1].col+1,s=e[e.length-1].x+e[e.length-1].width,u=r.Jt.Kt(a,o),c=n.y,n)).height,a<r.getColumnCount(o)&&(l=r.Jt.qt(i,a,o)),wt.W.gfe(l,4)&&0<u&&r.getColumnVisible(a,o)&&t.push({style:l,x:s,y:c,width:u,height:f}),m=void 0,d=0;d<e.length&&(v=e[d]).isOutside;d++)m=d;f=(rt(m)?(a=(g=e[m]).col,s=g.x,u=g.width,2!==g.columnHeaderFitMode?(c=e[m].y,e[m]):(c=e[m+1].y,e[m+1])):(a=e[0].col-1,u=r.Jt.Kt(a,o),s=e[0].x-u,c=n.y,n)).height,a<0||(l=r.Jt.qt(i,a,o),wt.W.gfe(l,5)&&0<u&&r.getColumnVisible(a,o)&&t.push({style:l,x:s,y:c,width:u,height:f}))}},i.prototype.MO=function(t,e,n,i,r,o,a){var r,s,u,u,r;r&&0!==e.length&&(r=e[0].col-1,s=e[e.length-1].col+1,u=n.Sl(i.row,r,a),0<=r&&o.isValid&&!o.isValid(i.row,r,u)&&t.push({style:o.getDataValidator(i.row,r).highlightStyle(),x:e[0].x-o.getColumnWidth(r),y:i.y,width:o.getColumnWidth(r),height:i.height}),u=n.Sl(i.row,s,a),o.isValid)&&!o.isValid(i.row,s,u)&&(r=e[e.length-1],t.push({style:o.getDataValidator(i.row,s).highlightStyle(),x:r.x+r.width,y:i.y,width:o.getColumnWidth(s),height:i.height}))},i.prototype.CO=function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,i=e.Jt,r=t.row,o=t.col,a={},s={},u=[],c=t.rowCount,f=t.colCount,l=0;l<f;l++)s[l]=e.nn(l+o,n);for(h=0;h<c;h++){if(a[h]=e.Gt(h+r,n),d=[],0<a[h])for(v=0;v<f;v++)d.push(0<s[v]?i.qt(r+h,o+v,n):yt);u.push(d)}return{rowSizes:a,colSizes:s,styleList:u}},i.prototype.iO=function(t,d,v,g,m,p,S){var w,e,b,n,O,V,s,C,n,n,i,y,u,M,r,k,Y,c,K,T,x,G,B,I,P,R,N,E,H,U,F,_,z,A,f,U,W,J,Z,Q,X,q,$,e,tt,et,nt,it,rt,e,n,L,ot,D,j,l,at,h,e,st,ut,o,ct,ft,lt,ht,ht,n,a;if(Ct(g)&&(g=3),e=3===d,n=(b=(w=this).Mf).parent,O=b.options.rightToLeft,V=n&&n.options.resizeZeroIndicator,s=b._y(d,g),C=b.yfe(v,g),n=b.options.sheetAreaOffset,n=b.gj&&b.gj()||{x:n.left,y:n.top,width:0,height:0},i=w.U7(d,v,b.Fi(),n,p),y=!1,u=s.length,M=C.length,!(u<0||M<0)){for(r=new mt.h9,k=0;k<M;k++)C[k].isOutside||r.push(C[k]);for(Y=w.xpe(g,p),c=b.s7(d,v,g,!0),K=0<c.length,B=b.Jt,H=E=N=R=0,_=new pt.Yx(b,s,r,g,e),z=[],A=[],f=[],W=[],J=[],t.save(),t.beginPath(),Z=[],X=Q=-1,q=b.N9(3),$=b.k9(3),e=b.Fi(),tt=0===e.qC&&0===n.height,et=0===e.XC&&0===n.width,nt=!!bt(this.Mf),it=!1,rt=dt("SheetsCalc"),e=b.getActiveRowIndex(),n=b.getActiveColumnIndex(),L=this.SO(g,b,e,n),D={},K&&(ot=new vt.Common.rbush,c.forEach(function(t){ot.insert({minX:t.row,minY:t.col,maxX:t.row+t.rowCount-1,maxY:t.col+t.colCount-1,item:t})})),k=0;k<u;k++){for(T=s[k],w.MO(W,r,B,T,Y,b,g),j=[],l=function(n){var t,t,t,e,e,i,r,o,a,s,u,c,f,l,f,h,u,c,f,u,f,c;if(x=C[n],K&&(D.minX=T.row,D.minY=x.col,D.maxX=T.row,D.maxY=x.col,t=ot.search(D)[0],G=t&&t.item),G?(I=G.row,P=G.col,R=G.x,N=G.y,E=Tt(G),H=kt(G),G.isAutoMerge&&(t=w.TO(G,d,v,g),R=t.x,N=t.y,E=t.width,H=t.height),G.spanSizeInfo||(G.spanSizeInfo=w.CO(G,b,g))):(I=T.row,P=x.col,R=x.x,E=Tt(x),-1===x.y?N=T.y:(N=Mt(x.y*T.height+T.y),y=!0),-1===kt(x)?H=kt(T):(H=T.height+T.y-N,y=!0)),1===V&&(-1===d&&b.getColumnVisible(P)&&0===b.Do(P)&&((X<0||X!==P-1)&&Z.push({x1:R,y1:N,x2:R,y2:N+H,horizontal:!1}),X=P),-1===v)&&b.getRowVisible(I)&&0===b._o(I)&&((Q<0||Q!==I-1)&&Z.push({x1:R,y1:N,x2:R+E,y2:N,horizontal:!0}),Q=I),m&&(R+E<=m.x||R>=m.x+Tt(m)||N+H<=m.y||N>=m.y+kt(m))&&(!y||R>m.x+Tt(m))&&!x.isOutside)return"continue";if(0===E||0===H)return"continue";if(!O&&1===g&&n<M-1&&C[n+1].x-R==0)return"continue";if(j.push({col:P,x:R,y:N,width:E,height:H}),t=function(t){var e,e;t.columnHeaderFitMode!==St.ColumnHeaderFitMode.normal&&n<M-1&&(e=b.O5(x.col,g,!0))&&(e=C.findCol(e))&&-1!==e.y&&(t.cornerX=e.x,t.columnHeaderFitMode===St.ColumnHeaderFitMode.stack?t.cornerY=Mt(e.y*T.height)+T.y:t.cornerY=T.height+T.y)},x.isOutside)return(e=j[j.length-1]).isOutside=!0,e.columnHeaderFitMode=1===g&&b.Lt(P),t(e),e.columnHeaderFitMode===St.ColumnHeaderFitMode.stack&&(e.width=B.Kt(P,g)),"continue";if(e=!1,!G||!xt.OS(z,G)){if(i=!1,r=T.spacingIndex,o=T.isAfterSpacing,U=B.$t(I,P,g,1,{rowSpacingIndex:r,isAfterRowSpacing:o}),a=b.AO&&b.AO(),s=b.getRowCount(St.SheetArea.colHeader)-1,u=b.frozenRowCount(),c=b.getViewportTopRow(0),f=b.getViewportTopRow(1),!p&&L&&I===s&&P>=L.iw&&(0===u&&L.Ky+L.Sx>f||0<u&&0<c&&L.Ky+L.Sx>c)&&P<L.iw+L.Tx){if(U=b.getCell(L.Ky,P).text()+"",e=!0,i=L.filterButtonVisible(),a)for(l=0;l<a.length;l++)if(a[l].col===P&&a[l].rowFilter.nM===L){at.IO(a[l],1,s,!0);break}}else if(a&&0<a.length&&(h=a[f=a.length-1].rowFilter&&a[f].rowFilter.nM))for(l=a.length-1;0<=l;l--)if(a[l].tableColumnHeaderFilter&&a[l].col===P){at.IO(a[l],3,h.Ky,!1);break}F=B.qt(I,P,g,yt,{rowSpacingIndex:r,isAfterRowSpacing:o}),Y&&(u=B.Sl(I,P,g),b.isValid)&&!b.isValid(I,P,u)&&W.push({style:b.getDataValidator(I,P).highlightStyle(),x:R,y:N,width:E,height:H}),3===g&&(c=F.formatter,rt)&&c&&Gt(c)&&(!p||b.pivotTables&&b.pivotTables.findPivotTable(I,P))&&(f=b.parent&&b.parent.xO(c))&&(u=f.getExpression(),U=b.NO(c,u,I,P)),e&&(F.hAlign=0),U={data:U,row:I,col:P,x:R,y:N,width:E,sparkline:nt&&b.getSparkline(I,P),height:H,style:F,colStyle:b.Z_(-1,P,g),cellLayout:G,tableFilter:i,columnHeaderFitMode:1===g&&b.Lt(P),offsetX:x.offsetX,printZoomFactor:S,sheetArea:g,rowSpacingIndex:r,isAfterRowSpacing:o,RHe:n===C.length-1},b.getParent().options.scrollByPixel&&(U.clipRect=m),t(U),A.push(U),wt.W.Xue(F)&&J.push({style:F,x:R,y:N,width:U.columnHeaderFitMode===St.ColumnHeaderFitMode.stack?b.getColumnWidth(P,g):E,height:H,columnHeaderFitMode:U.columnHeaderFitMode,cornerY:U.cornerY,cornerX:U.cornerX}),G&&z.push(G),U.style&&4===U.style.hAlign&&(it=!0),f=(I===q||p&&0===k)&&tt,c=void 0,c=b.options.rightToLeft?P===b.G6(3):(P===$||p&&0===n)&&et,G&&(G.vIndex=k,G.hIndex=n),_.PN(I,P,R,N,E,H,F,G,f,c,U)}},at=this,h=0;h<M;h++)l(h);0<j.length&&w.mfe(J,j,T,p,b,g)}if(0<A.length){if(3===g&&(b.options.allowCellOverflow||it)&&(e=B.gl(d,v,function(){return new Bt(b,d,v)}),0<(f=w.kO(t,e,A,_,S)).length)){for(st=m.x,ut=m.x+m.width,k=0;k<f.length;k++)(o=f[k])&&(ct=o.row,ft=o.col,(lt=o.cellOverflowLayout&&o.cellOverflowLayout.layout)&&((ht=lt.x)<st&&(st=ht),ut<(ht=ht+lt.width))&&(ut=ht),o.printZoomFactor=S,_.PN(ct,ft,o.x,o.y,o.width,o.height,o.style,o.cellLayout,ct===q&&tt,ft===$&&et,o));A=A.concat(f),p||(m.x=st,m.width=ut-st,i&&(m=m?i.getIntersectRect(m):i))}1===g&&y&&w.DO(A,r,_,m,p,i,q,$,tt,et,S),m&&(n=b.printInfo&&b.printInfo(),p&&n&&(0<n.columnStart()||0<n.rowStart())&&!n.showBorder()?t.rect(m.x-(0<n.columnStart()?2:0),m.y-(0<n.rowStart()?2:0),Tt(m)+(0<n.columnStart()?4:0),kt(m)+(0<n.rowStart()?4:0)):(b.options.rightToLeft&&--m.x,t.rect(m.x,m.y,Tt(m),kt(m))),t.clip()),w.eO(t,A,g,p,S)}gt.Worksheet.et(b,"paintViewport",{ctx:t,rowViewportIndex:d,colViewportIndex:v,sheetArea:g,clipRect:m,isPrinting:p}),_.paint(t,S),0<Z.length&&w._O(t,Z,1,3),0<W.length&&(a=i.getIntersectRect(m),t.rect(a.x,a.y,Tt(a),kt(a)),t.clip(),w.EO(t,W)),0<J.length&&(a=i?i.getIntersectRect(m):m,t.rect(a.x,a.y,Tt(a),kt(a)),t.clip(),w.que(t,J,{isPrinting:p,printZoomFactor:S,sheet:b})),t.restore()}},i.prototype.IO=function(t,e,n,i){t.sheetArea=e,t.row=n,t.tableColumnHeaderFilter=i},i.prototype.SO=function(t,e,n,i){if(e.tables&&1===t){var t=e.tables.find(n,i),n=e.frozenRowCount(),i=e.getViewportTopRow(0),e=e.getViewportTopRow(1);if(t&&t.jO&&(0===n&&t.Ky<e||0<n&&0<i&&t.Ky<i))return t}return null},i.prototype.TO=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,e,d,v,g,e,r,d,v,r=t.row,o=t.col,a=t.x,s=t.y,u=t.width,c=t.height,f=this.Mf,l=f.Fi();return 1!==e||3!==i&&2!==i||(h=l.B1(e),e=f.frozenRowCount(),d=f.getRowCount(i)-f.frozenTrailingRowCount()-1,s<(v=h.y)&&e<=r&&r<=d&&(c-=v-s,s=v),v+(g=h.height)<s+c&&e<=r+t.rowCount-1&&r+t.rowCount-1<=d&&(c-=s+c-(v+g))),1!==n||3!==i&&1!==i||(h=l.L1(n),e=f.frozenColumnCount(),r=f.getColumnCount(i)-f.frozenTrailingColumnCount()-1,a<(d=h.x)&&e<=o&&o<=r&&(u-=d-a,a=d),d+(v=h.width)<a+u&&e<=o+t.colCount-1&&o+t.colCount-1<=r&&(u-=a+u-(d+v))),new et.Rect(a,s,u,c)},i.prototype._O=function(t,e,n,i){var r,o,a,s,u,c,f,a,l,h,d,v,g,m,p,S;if(0!==e.length)for(r=0,o=e.length;r<o;r++)s=(a=e[r]).x1,u=a.y1,c=a.x2,f=a.y2,a=a.horizontal,t.beginPath(),t.save(),t.lineWidth=n,t.strokeStyle=this.OO(t,a,s,u,c,f),t.fillStyle=this.RO(t,a,s,u,c,f),a?(d=-(h=1),v=-2,t.fillRect(s,u+(l=-3),c-s-1,i+2*n),f+=.5,t.moveTo(s+-1,(u+=.5)+-3),t.lineTo(c+-2,f+-3),t.moveTo(s+-1,u+1),t.lineTo(c+-2,f+1)):(S=-(m=1),t.fillRect(s+(g=-3),u+(p=0),i+2*n,f-u-1),c+=.5,t.moveTo((s+=.5)+-3,u+0),t.lineTo(c+-3,f+-1),t.moveTo(s+1,u+0),t.lineTo(c+1,f+-1)),t.stroke(),t.restore()},i.prototype.RO=function(t,e,n,i,r,o){var a,s,u,c,u,f,l,h,d,s,u=et.I.He(0,"gc-"+(e?v:g)+"-normal"),c=u&&u.backgroundColor,u=u&&u.backgroundImage;if(!e&&u&&-1!==u.indexOf("linear-gradient"))for(f=et.mt.ri(u),a=t.createLinearGradient(n,i,r,o),l=0,h=f.length;l<h;l++)d=f[l],a.addColorStop(d.point,d.color);else c&&(a=c);return a},i.prototype.OO=function(t,e,n,i,r,o){var t,a,n,t=t.createLinearGradient(n,i,r,o),a,n=et.I.He(0,"gc-"+(e?v:g)+"-normal");return e?(t.addColorStop(0,n.borderTopColor),t.addColorStop(1,n.borderBottomColor)):(t.addColorStop(0,n.borderLeftColor),t.addColorStop(1,n.borderRightColor)),t},i.prototype.que=function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,o,i=e.length,r=0;r<i;r++)a=(o=e[r]).x,s=o.y,u=o.width,c=o.height,f=o.style,l=o.columnHeaderFitMode,h=o.cornerY,o=o.cornerX,n.columnHeaderFitMode=l,n.cornerY=h,n.cornerX=o,(0,d.paintStyleDecorationOutSideIcons)(t,new et.Rect(a,s,u,c),f.decoration.icons,f.vAlign,n)},i.prototype.EO=function(t,e){var n,i,r,o,a,s,u,c,f,l,s,h,n,i,r=this.Mf.BO();if(e)for(o=e.length,a=0;a<o;a++)u=(s=e[a]).x,c=s.y,f=s.width,l=s.height,0===(h=(s=s.style).type)&&this.LO(t,u,c,f,l,s),1===h&&this.FO(t,u,c,f,l,s),2===h&&this.PO(t,u,c,f,l,s,r)},i.prototype.LO=function(t,e,n,i,r,o){var o,e,n,i,r,a,s,a,u,c,i,r,o=o.color,e=e-4,n=n-4,i=i+8,r=r+8,a=.5522848,s=i/2*a,a=r/2*a,u=e+i,c=n+r,i=e+i/2,r=n+r/2;t.save(),t.lineWidth=2,t.strokeStyle=o,t.beginPath(),t.moveTo(e,r),t.bezierCurveTo(e,r-a,i-s,n,i,n),t.bezierCurveTo(i+s,n,u,r-a,u,r),t.bezierCurveTo(u,r+a,i+s,c,i,c),t.bezierCurveTo(i-s,c,e,r+a,e,r),t.closePath(),t.stroke(),t.restore()},i.prototype.FO=function(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,o;e-=.5,n-=.5,h=Math.min(i/2,r/2),d=o.color,o=o.position,t.save(),t.lineWidth=2,t.strokeStyle=d,t.beginPath(),t.rect(e,n,i,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===o?(u=a=e,c=(s=n)+h,f=a+h,l=s):2===o?(c=(s=n+r)-h,f=(u=a=e+i)-h,l=s):3===o?(u=a=e,c=(s=n+r)-h,f=a+h,l=s):1===o&&(c=(s=n)+h,f=(u=a=e+i)-h,l=s),t.moveTo(a,s),t.lineTo(u,c),t.lineTo(f,l),t.fillStyle=d,t.fill(),t.closePath(),t.restore()},i.prototype.PO=function(t,e,n,i,r,o,a){var s,u,c,f,l,h,d,v,g,o,m;if(e-=.5,n-=.5,u=(s=this.Mf).zoom(),h=l=15,d=o.image,v=o.position,g=3,o=o.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(e,n,i,r),t.stroke(),d&&"none"!==d&&a){4===v?c=e-18:5===v&&(c=e+i+3);try{a.getState(d)?(m=a.getImage(d),f=n+r/2-7.5,t.drawImage(m,c,f,15,15)):a.addImage(d)}catch(t){}}else 4===v?c=e-18*u:5===v&&(c=e+i+3*u),t.translate(c,f=n+r/2-15*u/2),t.scale(.015*u,.015*u),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=o,t.fill(),t.stroke();t.restore()},i.prototype.eO=function(t,e,n,i,r,o,a,s,u){var c,f,l,h,d,v,F,u,_,A,L,D,j,O,V,g,m,p,S,w,b,C,y,M,k,T,x,G,Y,f,B,I,K,P,z,R,N,R,W,E,J,H,U,Z,Q,R,c,B,I,X,q,$,tt;for(void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=1),h=(l=this).Mf,d=3===n,v=(o||h).zoom()*u,F=ot(l.Nn(),v),u=h.getDefaultStyle(n),_=h.$f(n),A=l.Mf.conditionalFormats,L=lt(h),D=h.k9(2),j=h.N9(1),O=(o||h).BO(),t.save(),t.beginPath(),V=ut,u&&u.foreColor?(0,et.resetFillStyle)(t,h,u):t.fillStyle=V,it(t,F.font),t.textAlign=d?"right":"center",p=e.length,E=[],H={sheet:h,row:-1,col:-1,fontInfo:st,lineHeight:-1,imageLoader:O,conditionalFormats:A,sheetArea:n,parentBackColor:L},U=[],g=0;g<p;g++)b=(S=e[g]).data,Y=S.tableFilter,C=S.row,y=S.col,M=S.x,k=S.y,T=Tt(S),x=kt(S),1!==n||U[C]||(U[C]=h.getRowHeight(C,n)),G=S.style,P=S.cellOverflowLayout,f=S.columnHeaderFitMode,B=S.cornerX,I=S.cornerY,W=S.offsetX,K=S.colStyle,N=G.font?at(G,v):F,i&&typeof r===ft&&1!==r&&(N=ot(N.font,r)),G.font=N.font,Z=S.rowSpacingIndex,Q=S.isAfterRowSpacing,R=rt(Z),0<T&&0<x&&(w=G.cellType||_,M--,k--,T++,x++,d?H.sparkline=S.sparkline:(R=i||R?0:l.GO(C,y,n),H.visualState=R),ct&&it(t,G.font,!0),R=nt(N.font),H.lineHeight=R,H.row=C+a,H.col=y+s,H.fontInfo=N,H.cellOverflowLayout=P,c=U.length&&x!==U[C]+1,H.needTopGridline=1===n&&C===j||0===n||c,H.needLeftGridline=2===n&&y===D||0===n||c,H.isPrinting=i,H.printZoomFactor=r,H.clipRect=S.clipRect,H.columnHeaderFitMode=f,H.cornerX=B,H.cornerY=I,H.offsetX=W,H.colStyle=K,H.isFormula=!Ct(h.t0(S.row,S.col,n)),H.builtInFileIcons=o&&(null==(f=null==(c=o.getParent())?void 0:c.options)?void 0:f.builtInFileIcons),H.rowSpacingIndex=Z,H.isAfterRowSpacing=Q,H.RHe=S.RHe,w._e(t,b,M,k,T,x,G,H,Y),P)&&!H.showBarIconOnly&&(B=new et.Rect(M,k,T,x),I=w.In?w.In(t,B,G,H):B,E.push({cellType:w,data:b,x:I.x,y:I.y,width:I.width,height:I.height,style:G,richText:z,options:{sheet:h,row:C,col:y,fontInfo:N,lineHeight:R,cellOverflowLayout:P,parentBackColor:L,imageLoader:O,isPrinting:i,printZoomFactor:r}}));if(0<(p=E.length))for(X=h.isEditing(),q=h.ui,$=h.ci,m=0;m<p;m++)b=(J=E[m]).data,H=J.options,X&&h.li&&H.row===q&&H.col===$||(tt=bt(this.Mf))&&b&&"SparklineExValue"===b.typeName||l.UO(t,J);for(t.restore(),p=e.length,g=0;g<p;g++)S=e[g],gt.Worksheet.et(h,"paintCell",{ctx:t,sheetArea:n,cell:S,isPrinting:i})},i.prototype.UO=function(t,e){var n,i,r,o,a,s,u,e,c,c,c,n=e.cellType,i=e.data,r=e.x,o=e.y,a=Tt(e),s=kt(e),u=e.style,e=e.options,c=e.cellOverflowLayout;c&&n.pn&&(c=c.layout,c=new et.Rect(c?c.x:r,c?c.y:o,c?c.width:a,c?c.height:s),n.pn(t,c,e,i)),n.paintValue&&n.paintValue(t,i,r,o,a,s,u,e)},i.prototype.GO=function(t,e,n){var i,r,i=this.Mf,r=0;return W(i)&&(3===n||Ct(n)?!i.isEditing()&&i.HO(t,e)?r=3:i.ni(t,e,n)&&(r=2):(i.ni(t,e,n)&&(r=1,i.ei(t,e,n))&&(r=2),i.zO(t,e,n)&&(r=4))),r},i.prototype.kO=function(S,w,b,C,y){for(var M,k,t,T,x,G,B,I,P,R,N,E,H,U,F,_,A,L,D,j,O,V,e,n,i,M=this.Mf,k=M.Jt,t=b.length,I=[],O={},V=[],e=function(t){var e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p;if(T=b[t],B=T.row,P=T.col,R=T.y,E=kt(T),A=w.b7(B,S,y),L=A.headingOverflowLayouts,D=A.trailingOverflowLayouts,!O[B]){for(e={},n=0,i=A;n<i.length;n++)r=i[n],e[r.column]=!1;L&&L.forEach(function(t){e[t.column]=!1}),D&&D.forEach(function(t){e[t.column]=!1}),O[B]=e}for(o=O[B],j=A.find(P),a=M.options.rightToLeft,s=0;s<j.length;s++)if(u=j[s]){if(c=M.getCellRect(B,u.column,st,st,{needAutoMerge:!0}),!o[u.column]){if(f=u.column,(G=k.o2e(B,f)).showEllipsis)continue;x=k.$t(B,f,3,1,{style:G}),N=u.columnWidth,H=u.backgroundWidth,U=u.backgroundLeftWidth<0?a?c.x+Tt(c)-H:c.x:u.backgroundRightWidth<0?a?c.x:c.x+Tt(c)-H:4===G.hAlign?c.x+u.expandedWidth/2-u.backgroundLeftWidth:c.x+Tt(c)/2-u.backgroundLeftWidth,_={data:x,row:B,col:f,x:c.x,y:R,width:N,height:E,cellOverflowLayout:u,style:G},I.push(_),u.layout=new et.Rect(U,R,H,E),G=k.o2e(B,f),C.EN(B,f,u,G,c.x,R,N,E),o[u.column]=!0}u.column===P&&o[u.column]&&V.push(t)}if(L)for(l=0;l<L.length;l++)(h=L[l])&&!o[h.column]&&h.contains(T.col)&&(P=h.column,(G=k.o2e(B,P)).showEllipsis||(x=k.$t(B,P,3,1,{style:G}),N=h.columnWidth,H=h.backgroundWidth,d=2===G.hAlign,v=M.getCellRect(B,h.endColumn,st,st,{needAutoMerge:!0}),U=a?v.x+(d?h.backgroundWidth-N:0):v.x+Tt(v)-H,F=a?v.x+h.backgroundWidth-N:U,_={data:x,row:B,col:P,x:F,y:R,width:N,height:E,style:G,cellOverflowLayout:h},I.push(_),h.layout=new et.Rect(U,R,H,E),o[h.column]=!0,C.EN(B,P,h,G,U,R,N,E)));if(D)for(g=0;g<D.length;g++)(m=D[g])&&!o[m.column]&&m.contains(T.col)&&(P=m.column,(G=k.o2e(B,P)).showEllipsis||(x=k.$t(B,P,3,1,{style:G}),N=m.columnWidth,H=m.backgroundWidth,p=M.getCellRect(B,m.startColumn,st,st,{needAutoMerge:!0}),U=a?p.x+Tt(p)-H:p.x,F=a?p.x+Tt(p)-H:p.x+H-N,_={data:x,row:B,col:P,x:F,y:R,width:N,height:E,style:G,cellOverflowLayout:m},I.push(_),m.layout=new et.Rect(U,R,H,E),C.EN(B,P,m,G,U,R,N,E),o[m.column]=!0))},n=0;n<t;n++)e(n);if(0<V.length)for(i=V.length-1;0<=i;i--)b.splice(V[i],1);function r(t,e){var n,i,t,e,n=t.row,i=e.row,t=t.col,e=e.col;return n!==i?n-i:t!==e?t-e:void 0}return 0<I.length&&I.sort(r),I},i.prototype.DO=function(t,e,n,i,r,o,a,s,u,c,f){for(var l,h,d,v,g,m,p,S,w,b,C,y,M,k,k,l=this,h=[],d=l.VO(t[0].col,t[0].x),v=[],g=0;g<d.length;g++)v.push(d[g]);for(g=0;g<e.length;g++)v.push(e[g]);for(n.Vx=v,m=[],p=n.Vx.length,w=0;w<p;w++)0<(S=n.Vx[w]).width&&m.push(S.col);if(m.push(m[m.length-1]+1),n.CN=m,0<(h=l.YO(d,t)).length){for(b=i.x,C=i.x+i.width,g=h.length-1;0<=g;g--)(y=h[g])&&((M=y.overflowLayout)&&((k=M.x)<b&&(b=k),C<(k=k+M.width))&&(C=k),t.unshift(y),y.printZoomFactor=f,n.PN(y.row,y.col,y.x,y.y,y.width,y.height,y.style,yt,y.row===a&&u,y.col===s&&c,y));r||(i.width=C-b,o&&i&&o.getIntersectRect(i))}},i.prototype.VO=function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,n=new mt.h9,i,r=this.Mf,o=r.Jt,a=r.Ut,s=t,u=[],c=[],f=[],l=[],d=s,g=e,m=r.getColumnCount()-r.frozenTrailingColumnCount(),p=r.frozenColumnCount()-1,S=s-1;p<S;S--)if(u[S]=h=o.Kt(S),h){if(c[S]=a.getColumnHeaderFitMode(!1,St.SheetArea.colHeader,S),f[S]=a.eE(-1,S,-1,1,St.SheetArea.colHeader),l[S]=r.ZO(S,g,m,d,u,c,f,l),c[S]===St.ColumnHeaderFitMode.normal)break;d=S,g-=h}for(w=d;w<s;w++)u[w]||(u[w]=o.Kt(w)),Ct(c[w])&&(c[w]=a.getColumnHeaderFitMode(!1,St.SheetArea.colHeader,w)),v=u[w],b=r.ZO(w,g,m,d,u,c,f,l),n.push(l[w]=b),g+=v;return n},i.prototype.YO=function(r,o){for(var t,a,s,u,n,c,f,l,h,d,v,g,m,p,S,v,e,w,i,b,t,a=this.Mf,s=a.Ut,u=a.Jt,n=a._y(1,1),f=[],e=n.length,w=r.length,i=function(i){var t,e;for(c=n[i],t=function(t){var e,n,e,t,e,e=r[t];if(e){if(l=c.row,h=e.col,p=e.x,S=-1===e.y?c.y:Mt(e.y*c.height+c.y),g=Tt(e),m=-1===kt(e)?kt(c):c.height+c.y-S,v=u.$t(l,h,1,1,{style:d}),d=u.qt(l,h,1),v={data:v,row:l,col:h,x:p,y:S,width:g,height:m,style:d,overflowLayout:e,columnHeaderFitMode:s.getColumnHeaderFitMode(!1,St.SheetArea.colHeader,h),SheetArea:1},d.showEllipsis&&v.columnHeaderFitMode!==St.ColumnHeaderFitMode.stack)return"continue";v.columnHeaderFitMode===St.ColumnHeaderFitMode.stack&&(t===w-1?(n=o[0].col,e=o.filter(function(t){return t.row===i&&t.col===n})[0],v.cornerX=e&&e.x,v.cornerY=e&&e.y):(t=a.O5(h,1,!0))&&(e=r.findCol(t))&&-1!==e.y&&(v.cornerX=e.x,v.cornerY=Mt(e.y*c.height)+c.y)),f.push(v)}},e=0;e<w;e++)t(e)},b=0;b<e;b++)i(b);return f},p=i,t.g7=p,s=".cutCopyIndicator",S=et.Events.CellChanged,k=et.Events.ClipboardChanged,T=et.Events.ValueChanged,x=et.Events.ColumnChanged,G=et.Events.RowChanged,R=et.Events.RangeChanged,H=et.Events.ClipboardPasting,U=et.Events.ClipboardPasted,F=et.Events.DragMerging,_=et.Events.FloatingElementSelected,r.prototype._T=function(t){var e=this;if(0===arguments.length)return e.d7;e.d7=t},r.prototype.WO=function(t,e){var n,i,n=this;if(0===arguments.length)return n.h7;(n.h7!==t||t||e)&&(n.h7=t,i=n.Mf)&&(i.zw(),Ct(n.QO)||clearTimeout(n.QO),n.QO=window.setTimeout(function(){var t;n.h7||(t=i.ST())&&t.c5(e),n.QO=st}))},r.prototype.v7=function(){var c,n,f,i,r;function o(){c.h7&&c.WO(!1)}function a(t,e,n){t||e===i||e===n||e===r||o()}n=(c=this).Mf,f=!1,i="resizable",r="isVisible",n.D3(k+s,function(){c.WO(!0)}),n.D3(T+s,o),n.D3(S+s,function(t,e){e.isUndo||"tag"===e.propertyName||e.KO||o()}),n.D3(x+s,function(t,e){a(e.isUndo,e.propertyName,"width")}),n.D3(G+s,function(t,e){a(e.isUndo,e.propertyName,"height")}),n.D3(R+s,function(t,e){e.isUndo||6===e.action||3===e.action||o()}),n.D3(H+s,function(){f=c.WO()}),n.D3(U+s,function(t,e){var n,e,i,r,o,a,s,u,n=e.cellRange,e=e.sheet.ST(),i=e._S,r=f;if(n&&i&&e.DS){if(c._T()){for(a=0,s=i;a<s.length;a++)if((u=s[a]).intersect(n.row,n.col,n.rowCount,n.colCount)&&!u.equals(n)){r=!1;break}}else o=!(r=!1);c.WO(r,o)}}),n.D3(F+s,o),n.D3(_+s,function(t,e){"worksheet"!==e.type&&(n.endEdit(),et.hi.N1(n))})},r.prototype.oO=function(t,e,n,i){var r,r,o,a,a,s,u,c,f,a,c,l,h,d,r=this;if(r.h7&&(o=(r=r.Mf).Dn,a=(a=r.parent)?a.options:{},u=(s=r.ST())._S,c=a.cutCopyIndicatorVisible,Ct(c)&&(c=!0),f=et.Pf.vl(r,a.cutCopyIndicatorBorderColor||"blue"),c)&&s.DS===r&&u&&(a=o.uO(n,i,st),c=o.fO(n,i,u,e))&&a){for(t.save(),t.rect(a.x,a.y,Tt(a),kt(a)),t.clip(),l=0,h=c;l<h.length;l++)d=h[l],o.wO(t,d,f);t.beginPath(),t.restore()}},r.prototype.JO=function(){this.WO(!1)},r.prototype.XO=function(){this.WO(!1)},r.prototype.qO=function(){this.WO(!1)},r.prototype.$O=function(){this.WO(!1)},r.prototype.lI=function(){this.WO(!1)},r.prototype.L0=function(){var t=this.Mf;t._3(S+s),t._3(k+s),t._3(T+s),t._3(x+s),t._3(G+s),t._3(R+s),t._3(H+s),t._3(U+s),t._3(F+s),t._3(_+s)},A=r,t.m7=A,gt.Worksheet.ch("render",{init:function(){var t=this;t.Dn=new p(t),t.lA&&t.lA.L0(),t.lA=new A(t)},dispose:function(t){var e,t,e=this;e.Dn&&e.Dn.TCe(),!1!==t.clearCache&&(e.Dn&&(e.Dn.Mf=st,e.Dn=st),t=e.lA)&&(t.L0(),e.lA=st)},onLayoutChanged:function(t){var e,n,t,e,n=this.lA;n&&("addRows"===(t=t.changeType)?n.JO():"deleteRows"===t?n.XO():"addColumns"===t?n.qO():"deleteColumns"===t&&n.$O())}})},"./dist/core/worksheet/worksheet-selection.js":function(t,e,n){"use strict";var i,b,e,r,o,d,p,C,y,M,a;function k(t,e){return t.getColumnCount(e)}function T(t,e){return t.getRowCount(e)}function x(t){return t.rowCount}function G(t){return t.colCount}function f(t,e,n){for(var i,r,o,a,i=[],r=t.length,a=0;a<r;a++)o=t[a],a===e?i=i.concat(n):i.push(o);return i}function B(t,e,n){for(var i=n-1;0<=i;i--)if(t.getColumnVisible(e+i)&&0<t.getColumnWidth(e+i))return e+i;return e+n-1}function I(t,e,n){for(var i=n-1;0<=i;i--)if(t.getRowVisible(e+i)&&0<t.getRowHeight(e+i))return e+i;return e+n-1}Object.defineProperty(e,"__esModule",{value:!0}),i=n("./dist/core/worksheet/worksheet.js"),b=n("./dist/core/util/common.js"),e=n("Common"),r=n("./dist/core/util/domUtil.js"),o=n("./dist/core/core.enum.js"),d=e.Common.lt.ht,p=e.Common.Uf.tR,C=null,y=Math.max,M=Math.min,a="gc-selection",r.GC$.extend(i.Worksheet.prototype,{addSelection:function(t,e,n,i){this.n4(t,e,n,i,!1)},n4:function(t,e,n,i,r){var o,a,s,u,c,f,f,o=this,a=t,s=e,u=n,c=i;-1!==a&&-1!==s&&(f=o.Ut.getSpans())&&0<p(f)&&(a=(f=o.nR(f,(0,b.Ec)(t,e,n,i))).row,s=f.col,u=x(f),c=G(f)),o.Ut.do("addSelection",a,s,u,c,r),o.zw()},setSelection:function(t,e,n,i){this.eR(t,e,n,i,2)},eR:function(t,e,n,i,r){var o,a,s,s,a,r,o=this,a=T(o),s=k(o);s<=e&&(e=s-1),s=y(0,t=a<=t?a-1:t),a=y(0,e),o.IA(),r=2===r?b.hi.A1(o):1===r,o.O6(s,a,o.C0(s),o.S0(a),!r),o.n4(t,e,n,i)},getSelections:function(){return this.Ut.getSelections()},clearSelection:function(t){var e,t;void 0===t&&(t=1),(e=this).IA(),t=2===t?b.hi.A1(e):1===t,e.O6(0,0,e.C0(0),e.S0(0),!t),i.Worksheet.et(e,"clearSelection"),e.zw()},IA:function(t){this.Ut.do("clearSelection",t)},JA:function(t,e,n){var i,r,o,a,o,s,u,c,f,l,h,d,v,g,i=this,r,o=i.options.protectionOptions,a=!1!==o.allowSelectLockedCells,o=!1!==o.allowSelectUnlockedCells;if(!i.isActualProtected()||a&&o)return!0;if(!a&&!o)return!1;if(s=n?n.locked:i.l0(t,e,"locked"),u=e<0,f=(c=t<0)?T(i):1,t=c?0:t,l=u?k(i):1,e=u?0:e,o&&(c||u))return!b.util.bme(i,{row:t,col:e,rowCount:f,colCount:l});if(a===s&&(c||u)){for(h=t+f-1,d=e+l-1,g=v=void 0,v=t;v<=h;v++)for(g=e;g<=d;g++)if((n=i.getCompositeStyle(v,g))&&a!==n.locked)return!1;if(c)for(v=t;v<=h;v++)if((n=i.getCompositeStyle(v,-1))&&a!==n.locked)return!1;if(u)for(g=e;g<=d;g++)if((n=i.getCompositeStyle(-1,g))&&a!==n.locked)return!1}return a===s},iR:function(t,e,n,i){var r,o,a,r=this;for(e=e<0?0:e,o=t=t<0?0:t;o<t+n;o++)for(a=e;a<e+i;a++)if(r.l0(o,a,"locked"))return!0},rR:function(){for(var t,e,t=this.getSelections(),e=0;e<t.length;e++)if(-1!==t[e].col)return!1;return!0},oR:function(){for(var t,e,t=this.getSelections(),e=0;e<t.length;e++)if(-1!==t[e].row)return!1;return!0},selectionPolicy:function(t){var e=this,n=e.Ut;return 0===arguments.length?n.getSelectionPolicy():(n.do("setSelectionPolicy",t),e)},selectionUnit:function(t){var e=this,n=e.Ut;return 0===arguments.length?n.getSelectionUnit():(n.do("setSelectionUnit",t),e)},getSelectionBackColor:function(){return this.options.selectionBackColor||b.I.fl(a).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||b.I.fl(a).borderTopColor},aR:function(t){if(!t)return this.options.aR;this.options.aR=t},e4:function(){var t,e,e,n,t=this,e=t.Ut.getSelections();0<p(e)&&(e={selections:e},0!==(n=t.Ut.getActiveSelectedRangeIndex())&&(e.activeSelectedRangeIndex=n),t.uR=e,t.IA(),t.Dn.E1())},cR:function(){var t=this,e=t.uR,n=e&&e.selections;n&&(t.Ut.do("setSelections",n),t.Ut.do("setActiveSelectedRangeIndex",e.activeSelectedRangeIndex||0))},pA:function(t,e,n,i){var r,o,a,i,a,t,r=this,a=r.tables,o=(n||i)&&(o=a&&a.fR(t,e))||r.lR(t,e,n,r.hR||0);o&&(i=o.row,a=o.col,t=o.leadingCellCol,r.dR(i,a))&&(r.qA=i,r.hR=t,r.XA(i,a))},lR:function(t,e,n,i){var r,o,a,s,u,c,r=this,o=T(r),a=k(r),s=t;return 0===s&&!n||0===o||0===a||(c=r.vR(s,i),n||r.mR(c),s=c.r,u=c.c,s<0&&n&&(i=u=(u=r.r6(u))<0||d(u)?r.r6(a):u,s=(c=r.vR(o,u)).r,(u=c.c)===e)&&s<=t)?C:{row:s,col:u,leadingCellCol:i}},bA:function(t,e,n){var i,n,t,e,n,i=this,n=i.gR(t,e,n,i.hR||0);!n||n.row===t&&n.col===e||(t=n.row,e=n.col,n=n.leadingCellCol,i.dR(t,e)&&(i.qA=t,i.hR=n,i.XA(t,e)))},gR:function(t,e,n,i){var r,o,a,s,u,c,r=this,o=T(r),a=k(r),s=t;if((s!==o-1||n)&&0!==o&&0!==a&&(c=r.pR(s,i),n||r.mR(c),s=c.r,u=c.c,!(s===o&&n&&(i=u=a<=(u=r.O5(u))||d(u)?r.O5(-1):u,s=(c=r.pR(-1,u)).r,(u=c.c)===e)&&t<=s)))return{row:s,col:u,leadingCellCol:i}},wA:function(){var t,e,n,e,t=this,e=t.bR();e&&(n=e.row,e=e.col,t.qA=n,t.hR=e,t.XA(n,e))},bR:function(){var t,e,n,i,r,o,a,o,s,t=this,e=t.P6(),n=t.G6(),i=n;if(e||i){if(a=!1!==(o=(r=t.options).protectionOptions).allowSelectLockedCells,o=!1!==o.allowSelectUnlockedCells,!t.isActualProtected()||a&&o)return{row:e,col:i};if(a||o)for(;e!==C&&0<=e;e=t.nI(e))for(i=n;i!==C&&0<=i;i=t.r6(i))if(a===(s=t.l0(e,i,"locked")))return{row:e,col:i}}return C},yA:function(){var t,e,n,e,t=this,e=t.yR();e&&(n=e.row,e=e.col,t.qA=n,t.hR=e,t.XA(n,e))},yR:function(){var t,e,n,i,r,o,a,s,u,s,c,t=this,e=t.j5(t.frozenRowCount()-1),n=t.O5(t.frozenColumnCount()-1),i=n,r=t.P6(),o=t.G6();if(e!==C&&i!==C){if(u=!1!==(s=(a=t.options).protectionOptions).allowSelectLockedCells,s=!1!==s.allowSelectUnlockedCells,!t.isActualProtected()||u&&s)return{row:e,col:i};if(u||s)for(;e!==C&&e<=r;e=t.j5(e))for(i=n;i!==C&&i<=o;i=t.O5(i))if(u===(c=t.l0(e,i,"locked")))return{row:e,col:i}}return C},mA:function(t,e,n){var i,r,o,o,t,e,i=this,o=i.tables,r=n&&(r=o&&o.wR(t,e))||i.sI(t,e,n,i.qA||0);r&&(o=r.row,t=r.col,e=r.leadingCellRow,i.dR(o,t))&&(i.qA=e,i.hR=t,i.XA(o,t))},sI:function(t,e,n,i){var r,o,a,s,u,c,f,r=this,o=T(r),a=k(r),u=e;if(0===u&&!n||0===o||0===a)return C;for(c=r.MR(i,u),f=i,n||r.mR(c),s=c.r,u=c.c;u<0&&n;){if(i=s=(s=r.nI(s,3,!0))<0||d(s)?r.nI(o,3,!0):s,s=(c=r.MR(i,a)).r,u=c.c,s===t&&u<e)return C;if(s===t&&u===e){if(i===f)return C;s=(c=r.MR(i,u)).r,u=c.c}}return{row:s,col:u,leadingCellRow:i}},mR:function(t){var e,n,n,e=this,n=!1;t.r<0?t.r=e.N9():t.r>=T(e)&&(t.r=e.P6(),n=!0),t.c<0?t.c=e.k9():t.c>=k(e)&&(t.c=e.G6(),n=!0),n&&((n=e.Ut.getSpan(t.r,t.c)).row!==t.r&&(t.r=n.row),n.col!==t.c)&&(t.c=n.col)},CA:function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,h,n=this,i=n.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=n.JS(n.U5()),s=a.row,u=a.col,c=a.col+G(a)-1,f=t,l=e;f=(h=n.CR(f,l)).r,!(u<=(l=h.c));){if(o===r&&f===t&&l<=e)return;l=s<=--f?c+1:(h=n.JS(n.U5(3)),o=i.getActiveSelectedRangeIndex(),s=h.row,u=h.col,c=h.col+G(h)-1,f=h.row+x(h)-1,h.col+G(h))}0<=f&&(n.XA(f,l),n.qA=f,n.hR=l)},SA:function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,h,n=this,i=n.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=n.JS(n.U5()),s=a.col,u=a.row+x(a)-1,c=a.col+G(a)-1,f=t,l=e;f=(h=n.TR(f,l)).r,!((l=h.c)<=c);){if(o===r&&f===t&&e<=l)return;l=++f<=u?s-1:(h=n.JS(n.U5(4)),o=i.getActiveSelectedRangeIndex(),s=h.col,u=h.row+x(h)-1,c=h.col+G(h)-1,f=h.row,h.col-1)}0<=f&&(n.XA(f,l),n.qA=f,n.hR=l)},TA:function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,h,n=this,i=n.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=n.JS(n.U5()),s=a.row,u=a.row+x(a)-1,c=a.col,f=t,l=e;f=(h=n.AR(f,l)).r,l=h.c,!(s<=f);){if(o===r&&l===e&&f<=t)return;c<=--l?f=u+1:(h=n.JS(n.U5(1)),o=i.getActiveSelectedRangeIndex(),s=h.row,u=h.row+x(h)-1,c=h.col,f=h.row+x(h),l=h.col+G(h)-1)}0<=l&&(n.XA(f,l),n.qA=f,n.hR=l)},AA:function(t,e){for(var n,i,r,o,a,s,u,c,f,l,h,h,n=this,i=n.Ut,r=i.getActiveSelectedRangeIndex(),o=-1,a=n.JS(n.U5()),s=a.row,u=a.row+x(a)-1,c=a.col+G(a)-1,f=t,l=e;f=(h=n.IR(f,l)).r,l=h.c,!(f<=u);){if(o===r&&l===e&&t<=f)return;++l<=c?f=s-1:(h=n.JS(n.U5(2)),o=i.getActiveSelectedRangeIndex(),u=h.row+x(h)-1,c=h.col+G(h)-1,f=h.row-1,l=h.col)}0<=l&&(n.XA(f,l),n.qA=f,n.hR=l)},gA:function(t,e,n){var i,r,o,o,n,t,i=this,o=i.tables,r=n&&(r=o&&o.xR(t,e))||i.uI(t,e,n,i.qA||0);!r||r.row===t&&r.col===e||(o=r.row,n=r.col,t=r.leadingCellRow,i.dR(o,n)&&(i.qA=t,i.hR=n,i.XA(o,n)))},uI:function(t,e,n,i){var r,o,a,s,u,c,f,r=this,o=T(r),a=k(r),u=e;if(u===a-1&&!n||0===o||0===a)return C;for(c=r.NR(i,u),f=i,n||r.mR(c),s=c.r,u=c.c;u===a&&n;){if(t===o-1&&t===s&&(!r.getRowVisible(s,3)||r.Gt(s,3)<=0))return C;if(i=s=o<=(s=r.j5(s,3,!0))||d(s)?r.j5(-1,3,!0):s,s=(c=r.NR(i,-1)).r,u=c.c,s===t&&e<u)return C;if(s===t&&u===e){if(i===f)return C;s=(c=r.NR(i,u)).r,u=c.c}}return{row:s,col:u,leadingCellRow:i}},MR:function(t,e){for(var n,i,r,o,o,n=this,r=e;0<=r&&(i=t,!(--r<0));)if(n.getColumnVisible(r)&&((o=n.Ut.getSpans((0,b.Ec)(i,r,1,1)))&&0<p(o)&&r>=(o=o[0]).col&&(r=o.col,i=o.row),n.dR(i,r)))return{r:i,c:r};return{r:i,c:r}},CR:function(t,e){for(var n,i,r,n=this;0<=e&&!(--e<0);){if(i=n.Ut.findSpan(t,e)){if(!((r=n.U5()).row<=i.row&&i.row+x(i)<=r.row+x(r)&&r.col<=i.col&&i.col+G(i)<=r.col+G(r)))continue;if(i.row!==t||i.col!==e)continue;e>=i.col&&(e=i.col,t=i.row)}if(n.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},NR:function(t,e){for(var n,i,r,o,a,a,s,n=this,i=k(n),o=e;o<i&&!(i<=(o=(a=n.Ut.getSpan(r=t,o)).col+G(a)));)if(n.getColumnVisible(o)&&((a=n.Ut.getSpans((0,b.Ec)(r,o,1,1)))&&0<p(a)&&(o>(s=a[0]).col?o=y(o,s.col+G(s)):r=s.row),n.dR(r,o)))return{r:r,c:o};return{r:r,c:o}},TR:function(t,e){for(var n,i,r,o,o,a,n=this,i=n.Ut,r=k(n);e<r&&!(r<=(e=(o=i.getSpan(t,e)).col+G(o)));){if(o=i.findSpan(t,e)){if(!((a=n.U5()).row<=o.row&&o.row+x(o)<=a.row+x(a)&&a.col<=o.col&&o.col+G(o)<=a.col+G(a)))continue;if(o.row!==t||o.col!==e)continue;e>o.col?e=y(e,o.col+G(o)):t=o.row}if(n.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},dR:function(t,e){var n,i,r,o,n=this;return!!n.JA(t,e)&&(i=0<=t&&t<T(n)&&0<=e&&e<k(n)&&n.getRowVisible(t)&&n.getColumnVisible(e)&&0<n.Gt(t)&&0<n.nn(e),r=!!n.F5,!0!==i||!0!=r||!1!==(o=n.l0(t,e,"tabStop")))&&i},vR:function(t,e){for(var n,i,i,n=this;0<=t&&!(--t<0);)if(n.getRowVisible(t)&&((i=n.Ut.getSpans((0,b.Ec)(t,e,1,1)))&&0<p(i)&&t>=(i=i[0]).row&&(t=i.row,e=i.col),n.dR(t,e)))return{r:t,c:e};return{r:t,c:e}},AR:function(t,e){for(var n,i,r,n=this;0<=t&&!(--t<0);){if(i=n.Ut.findSpan(t,e)){if(!((r=n.U5()).row<=i.row&&i.row+x(i)<=r.row+x(r)&&r.col<=i.col&&i.col+G(i)<=r.col+G(r)))continue;if(i.row!==t||i.col!==e)continue;t>=i.row&&(e=i.col,t=i.row)}if(n.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},pR:function(t,e){for(var n,i,r,r,o,n=this,i=T(n);t<i&&!(i<=(t=(r=n.Ut.getSpan(t,e)).row+x(r)));)if(r=n.Ut.getSpans((0,b.Ec)(t,e,1,1)),n.getRowVisible(t)&&(r&&0<p(r)&&(t>(o=r[0]).row?t=y(t,o.row+x(o)):e=o.col),n.dR(t,e)))return{r:t,c:e};return{r:t,c:e}},IR:function(t,e){for(var n,i,r,o,o,a,n=this,i=n.Ut,r=T(n);t<r&&!(r<=(t=(o=i.getSpan(t,e)).row+x(o)));){if(o=i.findSpan(t,e)){if(!((a=n.U5()).row<=o.row&&o.row+x(o)<=a.row+x(a)&&a.col<=o.col&&o.col+G(o)<=a.col+G(a)))continue;if(o.col!==e||o.row!==t)continue;t>o.row?t=y(t,o.row+x(o)):e=o.col}if(n.dR(t,e))return{r:t,c:e}}return{r:t,c:e}},D9:function(t,e,n,i,r,o){var a=this;a.Ut.do("addSelection",t,e,n,i,C,o),r&&a.My<=0&&a.Dn.E1(C,C,C,C,o)},L9:function(t,e,n){var i,t,e,r,o,t,a,s,i=this,t=i.xA(t,e,i.ui,i.ci),e=t.row,r=t.col,o=x(t),t=G(t),a=i.selectionPolicy(),s=i.selectionUnit();0!==a&&(1===a&&i.Ut.do("clearSelection"),1===s?t=r=-1:2===s&&(o=e=-1),i.kA(e,r,o,t,n))},xA:function(t,e,n,i,r,o){var a,s,n,i,s,t,a=this;return d(n)&&(n=a.ui),d(i)&&(i=a.ci),n=(s=a.Ut).getSpan(n,i,o),i=s.getSpan(t,e,o),r&&n.equals(i)?new b.Range(n.row,n.col,1,1):(s=n.union(i),(t=a.Ut.getSpans(C,o))&&0<p(t)?a.kR(t,s):s)},kA:function(t,e,n,i,r){var o,a,s,u,c,f,c,f,a,o=this,a=o.Ut,s=o.U5();0<p(a.getSelections())?(c=(0,b.Ec)(t,e,n,i),o.O9?(u=o.z9,o.z9=c):((f=a.getSelections())[a.getActiveSelectedRangeIndex()]=c,a.do("setSelections",f))):o.O9||a.do("addSelection",t,e,n,i),r&&o.My<=0&&(c=o.U5(),!o.O9&&c.row===s.row&&c.col===s.col&&x(c)===x(s)&&G(c)===G(s)||(f=o.Dn,o.O9&&(a=o.z9,u&&u.containsRange(a)?a=u:u&&(a=u.union(a)),s=(a=a.union((0,b.Ec)(o.getActiveRowIndex(),o.getActiveColumnIndex(),1,1))).union(s),c=a.union(c)),s.containsRange(c)?f.E1(s):c.containsRange(s)?f.E1(c):(f.E1(s),f.E1(c),f.E1(o.z9))))},DR:function(t){var e=[];return e=t?this.Ut.getSpans(t):e},_R:function(t,e){var n=t.row,i=t.col,r=t.rowCount,o=t.colCount,a=e.row,s=e.col,u=e.rowCount,c=e.colCount,r=n+r,o=i+o,f=a+u,l=s+c,h=!1,d=!1,v;return t.intersect(a,s,u,c)&&(d=!(h=v=a<n||s<i||r<f||o<l)),e.ER=e.ER||d,h},jR:function(t,e,n,i){for(var r,o,a,r=[],o=[],a=0;a<t.length;a++)o=this.RR(t[a],e,n,i),r=r.concat(o);return r},RR:function(t,e,n,i){var r,o,a,s,a,u,c,r=[],o=e.length;for(r.push(t),u=o-1;0<=u;u--)for(s=e[u],c=0;c<r.length;)a=r[c],this._R(a,s)?(r=f(r,c,a=this.BR(a,s,n,i)),c+=a.length):c++;return r},LR:function(t,e){var n=e.row,i=e.col,r=e.rowCount,e=e.colCount;return t.intersect(n,i,r,e)},FR:function(t,e){for(var n,i,r,o,n,i=[],o=t.length-1;0<=o;o--)r=t[o],this.LR(r,e)||i.push(r);return i},PR:function(t){var e=!1,n=this.Ut.getSpans(t);return e=1===n.length?t.equals(n[0]):e},GR:function(t,e){for(var n,t,i,r,o,a,s,u,n=t,t=e.length,i=n.length,r=!0,s=t-1;0<=s;s--){for(a=e[s],u=i-1;0<=u;u--)if((o=n[u]).equals(a)){r=!1;break}r&&n.push(a)}return n},UR:function(t){for(var e,n,i,r,o,a,e,n=[],r=t.length-1;0<=r;r--)(i=t[r]).ER&&(delete i.ER,n.push(r));for(o=n.length,a=0;a<o;a++)t.splice(n[a],1)},BR:function(t,e,n,i){var r,e,n,i,o,a,s,u,c,f,o,l,h,e;return e=this.JS(e),r=[],e=t.getIntersect(e,n,i),t&&e?(n=0<=t.row?t.row:0,i=0<=t.col?t.col:0,o=t.rowCount,a=t.colCount,s=e.row,u=e.col,c=e.rowCount,l=i+a,e=u+(f=e.colCount),0<(o=n+o)-(h=s+c)&&r.push((0,b.Ec)(h,i,o-h,a)),0<l-e&&r.push((0,b.Ec)(s,e,c,l-e)),0<u-i&&r.push((0,b.Ec)(s,i,c,u-i)),0<s-n&&r.push((0,b.Ec)(n,i,s-n,a))):r.push(t),r},tD:function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,n=[],i=this.getRowCount(3),r=this.getColumnCount(3),o=this.deselectIgnoreSpan();if(t&&0<t.length){for(u=[],c=[],h=l=void 0,a=!(f=[]),d=(s=t.length)-1;0<=d;d--)l=t[d],o||!this.PR(l)||this.LR(l,e)?(u=this.BR(l,e,i,r),o||0<(h=this.DR(l)).length&&(u=this.jR(u,h,i,r),f=this.FR(h,e),c=this.GR(c,f),this.UR(c)),v=p(u),!a&&0<v&&(this.setSelection(u[v-1].row,u[v-1].col,1,1),a=!0),n=u.concat(n)):c=this.GR(c,[l]);o||(n=c.concat(n))}for(this.IA(),g=n.length,this.suspendPaint(),m=0;m<g;m++)this.n4(n[m].row,n[m].col,n[m].rowCount,n[m].colCount);a||this.setActiveCell(this.ui,this.ci),this.resumePaint()},HA:function(t,e){var n,i,r,r,t,e,o,r,a,s,a,n=this,i=n.Ut.getSelections();p(i)<=0||(r=n.U5(),(r=n.HR(r,t,e))&&(t=r.row,e=r.col,o=x(r),r=G(r),a=n.selectionPolicy(),s=n.selectionUnit(),0!==a)&&(1===a&&n.Ut.do("clearSelection"),1===s?r=e=-1:2===s&&(o=t=-1),n.kA(t,e,o,r,!0),a=n.Ut.getSelections(),n.rt._A(i,a))&&(n.EA(i,a),n.jA(i)))},HR:function(t,e,n,i,r){var o,a,s,o=this,a=o.JS(t),s=C;return 37===e?s=n?o.zR(a,!1,i,r):o.VR(a,i,r):39===e?s=n?o.YR(a,!1,i,r):o.ZR(a,i,r):38===e?s=n?o.WR(a,!1,i,r):o.QR(a,i,r):40===e?s=n?o.KR(a,!1,i,r):o.JR(a,i,r):36===e?s=n?o.XR(a,i,r):o.qR(a,i,r):35===e?s=n?o.$R(a,i,r):o.tB(a,i,r):33===e?s=o.nB(a,i,r):34===e&&(s=o.eB(a,i,r)),s&&(t.row<0&&(s.row=-1,s.rowCount=o.getRowCount()),t.col<0)&&(s.col=-1,s.colCount=o.getColumnCount()),s},VR:function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,l,g,m,p,S,w,i=this,r=t.row,o=t.col,a=x(t),s=G(t),u=o+s-1,c=0,f=I(i,r,a);0<u;)if(i.dR(f,--u)&&(l=i.xA(f,u,e,n),h=M(r,l.row),d=M(o,l.col),g=(v=y(r+a-1,l.row+x(l)-1))-h+1,m=(l=M(o+s-1,l.col+G(l)-1))-d+1,h!==r||d!==o||g!==a||m!==s))return p=i.Ab,o<(S=i.ci)?d<=p&&i.o9(d):o===S&&l<=p&&i.o9(l),(w=i.parent&&i.parent.options.scrollByPixel)&&d===p&&0!==i.my&&i.o9(d,0),(0,b.Ec)(h,d,g,m);return C},zR:function(t,e,n,i){var r,o,a,s,u,u,s,e,r,u,n,c,f,r=this,o=t.row,a=t.col,s=r.frozenColumnCount(),u=s?r.O5(s-1):r.k9(),u=e?u:r.k9();if(!d(u))return(s<=0||e)&&r.o9(u),s=r.xA(o,u,n,i),e=M(o,s.row),r=M(a,s.col),u=y(o+x(t)-1,s.row+x(s)-1),n=M(a+G(t)-1,s.col+G(s)-1),(0,b.Ec)(e,r,c=u-e+1,f=n-r+1)},iB:function(t){var e,n,i,r,o,i,a,e=this,n;if(e.parent&&e.parent.options.scrollByPixel){for(o=e.Jt,i=e.S0(t),a=e.getViewportWidth(i);0<=t&&!((a-=o.Kt(t))<0);t--);i=t,r=a}else i=e.rB(t,2).col,r=0;return{iw:i,Xy:r}},ZR:function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,l,g,m,p,S,w,i=this,r=t.row,o=t.col,a=x(t),s=G(t),u=o,c=k(i)-1,f=I(i,r,a);u<c;)if(i.dR(f,++u)&&(l=i.xA(f,u,e,n),h=M(r,l.row),d=y(o,l.col),g=(v=y(r+a-1,l.row+x(l)-1))-h+1,m=(l=y(o+s-1,l.col+G(l)-1))-d+1,h!==r||d!==o||g!==a||m!==s))return p=i.oB(),o<(S=i.ci)?p<=d&&(w=i.iB(d),i.o9(w.iw,w.Xy)):o===S&&p<=l&&(w=i.iB(l),i.o9(w.iw,w.Xy)),(0,b.Ec)(h,d,g,m);return C},YR:function(t,e,n,i){var r,o,a,s,s,e,r,s,n,i,u,c,r=this,o=t.row,a=t.col,s=r.aB();if(!d(s))return r.o9(s),s=r.G6(),e||(s+=r.frozenTrailingColumnCount()),e=r.xA(o,s,n,i),r=M(o,e.row),s=y(a,e.col),n=y(o+x(t)-1,e.row+x(e)-1),i=y(a+G(t)-1,e.col+G(e)-1),(0,b.Ec)(r,s,u=n-r+1,c=i-s+1)},QR:function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,g,m,l,p,S,w,i=this,r=t.row,o=t.col,a=x(t),s=G(t),u=r+a-1,c=0,f=B(i,o,s);0<u;)if(i.dR(--u,f)&&(l=i.xA(u,f,e,n),h=M(r,l.row),d=M(o,l.col),m=(v=M(r+a-1,l.row+x(l)-1))-h+1,l=(g=y(o+s-1,l.col+G(l)-1))-d+1,h!==r||d!==o||m!==a||l!==s))return p=i.Tb,r<(S=i.ui)?h<=p&&i.$A(h):r===S&&v<=p&&i.$A(v),(w=i.parent&&i.parent.options.scrollByPixel)&&h===p&&0!==i.ly&&i.$A(h,0),(0,b.Ec)(h,d,m,l);return C},WR:function(t,e,n,i){var r,o,a,s,u,u,s,e,r,u,n,c,f,r=this,o=t.row,a=t.col,s=r.frozenRowCount(),u=s?r.j5(s-1):r.N9(),u=e?u:r.N9();if(!d(u))return(s<=0||e)&&r.$A(u),s=r.xA(u,a,n,i),e=M(o,s.row),r=M(a,s.col),u=M(o+x(t)-1,s.row+x(s)-1),n=y(a+G(t)-1,s.col+G(s)-1),(0,b.Ec)(e,r,c=u-e+1,f=n-r+1)},uB:function(t){var e,n,i,r,o,i,a,e=this,n;if(e.parent&&e.parent.options.scrollByPixel){for(o=e.Jt,i=e.C0(t),a=e.getViewportHeight(i);0<=t&&!((a-=o.Gt(t))<0);t--);i=t,r=a}else i=e.Jy(t,2),r=0;return{Ky:i,Xy:r}},JR:function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,g,m,l,p,S,w,i=this,r=t.row,o=t.col,a=x(t),s=G(t),u=r,c=T(i)-1,f=B(i,o,s);u<c;)if(i.dR(++u,f)&&(l=i.xA(u,f,e,n),h=y(r,l.row),d=M(o,l.col),m=(v=y(r+a-1,l.row+x(l)-1))-h+1,l=(g=y(o+s-1,l.col+G(l)-1))-d+1,h!==r||d!==o||m!==a||l!==s))return p=i.sB(),r<(S=i.ui)?p<=h&&(w=i.uB(h),i.$A(w.Ky,w.Xy)):r===S&&p<=v&&(w=i.uB(v),i.$A(w.Ky,w.Xy)),(0,b.Ec)(h,d,m,l);return C},KR:function(t,e,n,i){var r,o,a,s,s,e,r,s,n,i,u,c,r=this,o=t.row,a=t.col,s=r.cB();if(!d(s))return r.$A(s),s=r.P6(),e||(s+=r.frozenTrailingRowCount()),e=r.xA(s,a,n,i),r=y(o,e.row),s=M(a,e.col),n=y(o+x(t)-1,e.row+x(e)-1),i=y(a+G(t)-1,e.col+G(e)-1),(0,b.Ec)(r,s,u=n-r+1,c=i-s+1)},qR:function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,g,m,l,i=this,r=t.row,o=t.col,a=x(t),s=G(t),u=i.frozenColumnCount()-1,c=i.ci,f=r+a-1;u<c;)if(i.dR(f,++u)){if(o<=u&&o+s-1===i.ci)break;return l=i.xA(f,u,e,n),h=M(r,l.row),d=M(o,l.col),m=(v=y(r+a-1,l.row+x(l)-1))-h+1,l=(g=M(o+s-1,l.col+G(l)-1))-d+1,i.o9(i.k9()),(0,b.Ec)(h,d,m,l)}return C},XR:function(t,e,n){return t=this.zR(t,!0,e,n),t=this.WR(t,!0,e,n)},tB:function(t,e,n){for(var i,r,o,a,s,u,c,f,l,h,d,v,g,m,l,i=this,r=t.row,o=t.col,a=x(t),s=G(t),u=k(i),c=i.ci,f=r+a-1;c<u;)if(i.dR(f,--u)){if(u<=o+s-1&&o===i.ci)break;return l=i.xA(f,u,e,n),h=M(r,l.row),d=y(o,l.col),m=(v=y(r+a-1,l.row+x(l)-1))-h+1,l=(g=y(o+s-1,l.col+G(l)-1))-d+1,i.o9(i.aB()),(0,b.Ec)(h,d,m,l)}return C},$R:function(t,e,n){return t=this.YR(t,!0,e,n),t=this.KR(t,!0,e,n)},nB:function(t,e,n){var i,r,o,a,s,u,c,f,s,u,i,f,e,l,h,i=this,r=t.row,o=t.col,a=x(t),s=i.QA();return d(s)?C:(u=i._y(1),f=-1,(c=i.$A(s))?f=i.j5(r+a-1-p(u)):i.frozenRowCount()<=0&&(f=i.N9()),f<i.Tb?f=i.Tb:f>=i.sB()&&(f=i.nI(i.sB())),s=i.xA(f,o,e,n),u=M(r,s.row),i=M(o,s.col),f=M(r+a-1,s.row+x(s)-1),e=y(o+G(t)-1,s.col+G(s)-1),(0,b.Ec)(u,i,l=f-u+1,h=e-i+1))},eB:function(t,e,n){var i,r,o,a,s,u,s,u,i,s,e,n,c,f,i=this,r=t.row,o=t.col,a=x(t),s=i.tI();return d(s)?C:(u=i._y(1),i.$A(s),(s=i.nI(r+a-1+p(u)))<i.Tb?s=i.Tb:s>=i.sB()&&(s=i.Tb>=i.cB()?i.sB():i.nI(i.sB())),u=i.xA(s,o,e,n),i=y(r,u.row),s=M(o,u.col),e=y(r+a-1,u.row+x(u)-1),n=y(o+G(t)-1,u.col+G(u)-1),(0,b.Ec)(i,s,c=e-i+1,f=n-s+1))},QA:function(){var t,e,e,n,i,r,o,t=this,e=t._y(1);if(!e||p(e)<=0)return C;for(n=(e=t.frozenRowCount())?t.j5(e-1):t.N9(),i=0,r=t.Tb,o=t.Fi();n<r&&!((i+=t.Gt(--r))>t.Sy(o)););return r},fB:function(){var t,e,e,n,i,r,o,t=this,e=t.Yy(1);if(!e||p(e)<=0)return C;for(n=(e=t.frozenColumnCount())?t.O5(e-1):t.k9(),i=0,r=t.Ab,o=t.Fi();n<r&&!((i+=t.nn(--r))>t.Gy(o)););return r},tI:function(){var t,e,t,t=this._y(1),e=p(t);return t&&0<e?(t=t[e-1].row,this.P6()<=t?this.Tb:t):C},cB:function(){var t,e,n,i,n,i,r,t=this;if(t.P6()===t.sB()&&(e=t.Fi(),n=t._y(1),i=p(n),n)&&1<=i&&(n=n[i-1]).y+n.height<=e.Cy+t.Sy(e))return t.Tb;i=t.Tb;try{return t.Tb=t.P6(),r=t.QA(),r=t.j5(r)}catch(t){}finally{t.Tb=i}},aB:function(){var t,e,n,i,n,r,o,t=this;if(t.G6()===t.oB()&&(e=t.Fi(),n=t.Yy(1),i=p(n),n)&&1<=i&&(n=n[i-1]).x+n.width<=e.Py+e.width)return t.Ab;for(e=t.Fi(),r=0,o=t.G6();0<o&&!((r+=t.nn(o))>t.Gy(e));)o--;return o=0<o?t.O5(o):o},sB:function(){var t=this._y(1),e=p(t);return t&&0<e?t[e-1].row:C},oB:function(){var t=this.Yy(1),e=p(t);return t&&0<e?t[e-1].col:C},getLastFullyVisibleRow:function(){var t,e,n,i,n,t=this,e=t._y(1),n=p(e);return e&&0<n?(i=t.Fi(),(e[n=n-1].y+e[n].height<=i.Cy+t.Sy(i)?e[n]:e[y(n-1,0)]).row):C},getLastFullyVisibleColumn:function(){var t,e,n,i,n,t=this,e=t.Yy(1),n=p(e);return e&&0<n?(i=t.Fi(),(e[n=n-1].x+e[n].width<=i.Py+t.Gy(i)?e[n]:e[y(n-1,0)]).col):C},P6:function(t){var e=T(this,t=d(t)?3:t);return 3!==t&&2!==t||(e-=this.frozenTrailingRowCount()),this.nI(e,t)},G6:function(t){var e=k(this,t=d(t)?3:t);return 3!==t&&1!==t||(e-=this.frozenTrailingColumnCount()),this.r6(e,t)},kR:function(t,e){var n,i,r;if(t)for(n=0,i=p(t);n<i;n++)if(r=t[n],e.intersect(r.row,r.col,x(r),G(r)))return t.splice(n,1),n--,this.kR(t,e.union(r));return e},U5:function(t){var e,n,i,r,o,e,n=this.Ut,i=p(n.getSelections()),r=(0,b.Ec)(-1,-1,0,0);return i<=0||(o=n.getActiveSelectedRangeIndex(),3===t||1===t?n.do("setActiveSelectedRangeIndex",o=--o<0?i-1:o):4!==t&&2!==t||n.do("setActiveSelectedRangeIndex",o=i<=++o?0:o),0<=(o=n.getActiveSelectedRangeIndex())&&(r=n.getSelections()[o])),r}}),i.Worksheet.ch("selection",{init:function(){this.Ut.do("addSelection",0,0,1,1),this.Ut.setCellState(0,0,o.CellStatesType.active,!0,o.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(r,t,o){"use strict";var n,t,b,w,e,C,e,y,M,e,S,s,h,k,u,c,T,f,l,x,i;function P(t,e,n){for(var i=t[n-e];i<n;)i=t[i-e];return i}function d(t,e){return"object"==typeof t?JSON.stringify(t):(t=e.getColor(t),n.Common.ft.j(n.Common.ft._(t)))}function G(t,e){return t instanceof Date&&e instanceof Date?s(t)===s(e):typeof t==c&&typeof e==c?t.toLowerCase()===e.toLowerCase():t===e}function B(t,e,n,i,r){var o,a,s,t,t=t.currentTheme();return o=(a=(a=k(e)||(a=r?e.backColor:e.foreColor,k(a))?a:d(a,t))||"")===(s=(s=k(n)||(s=r?n.backColor:n.foreColor,k(s))?s:d(s,t))||"")?0:a===i?1:s===i?-1:0}function I(t,e){var n,i,r,o,a;return t instanceof Date&&(t=s(t)),e instanceof Date&&(e=s(e)),r=(n=typeof t)==c,o=(i=typeof e)==c,a=i==T,n==i||n!=T&&!a?n==u&&o||(!r||i!=u)&&(r&&o?t.toLowerCase()>e.toLowerCase():e<t):a}function v(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,v,g,m,p,h,S,w,S,w,s=r,u=t,c=e;if(s)for(f=0;f<s.length&&(s[f]&&(l=s[f].ascending,0<=(h=s[f].index))&&(v=d=void 0,g=i?u:h,m=i?h:u,p=i?c:h,h=i?h:c,v=o?(d=o[g][m],o[p][h]):(d=n.getValue(g,m),n.getValue(p,h)),s[f].compareFunction?(a=s[f].compareFunction(d,v),l||(a*=-1)):k(s[f].color)?(S=k(d)||""===d||typeof d==T&&isNaN(d),w=k(v)||""===v||typeof v==T&&isNaN(v),S||w?S&&w?a=0:S&&!w?a=1:!S&&w&&(a=-1):a=G(d,v)?0:I(d,v)?l?1:-1:l?-1:1):(S=n.getActualStyle(g,m,3,!1,{notClone:!1,isForFilter:!(w=S=void 0)}),w=n.getActualStyle(p,h,3,!1,{notClone:!1,isForFilter:!0}),a=B(n,S,w,s[f].color,s[f].isBackColor),l||(a*=-1))),0===a);f++);return a}function m(t,e,n,i,r){var o,a,s,u,c,f,l,h,o=t.length;if(o<=1)return t;for(s=t[a=Math.floor(o/2)],u=[],c=[],f=[],l=0;l<o;l++)(a===l?f:(h=v(t[l],s,e,n,i,r))<0?u:0<h?c:f).push(t[l]);return m(u,e,n,i,r).concat(f,m(c,e,n,i,r))}function p(t,e,n){var i,r,o,i=[];if(e)for(r=n.length-1;0<=r;r--)o=n[r],0===t.getRowHeight(o)&&(n.splice(r,1),i.push({lp:r,y4:o}));else for(r=n.length-1;0<=r;r--)o=n[r],0===t.getColumnWidth(o)&&(n.splice(r,1),i.push({lp:r,y4:o}));return i}function R(t,e){for(var n,i,n=t.length-1;0<=n;n--)i=t[n],e.splice(i.lp,0,i.y4)}function N(t,e,n,i,r,o,a,s,u){for(var c,f,l,h,i,d,v,g,c=o?i:r,f=o?e:n,l=[],h=0;h<c;h++)l[h]=f+h;for(i=s.ignoreHidden?p(t,o,l):[],d=l.concat([]),v=!1,l=m(l,t,o,a,u),g=0;g<l.length;g++)if(l[g]!==d[g]){v=!0;break}return R(i,l),{array:l,isChanged:v}}function E(t,e,n,i,r,o,a,s,u){var c,f,i,r,l,h,d,e,n,c=o?i:r,f=o?e:n,i=o?t.rowOutlines:t.columnOutlines,r=i.lB(f,c),l=i.hB(r,s.groupSort);if(!l){for(h=[],d=0;d<c;d++)h.push(f+d);l=[h]}for(d=0;d<l.length;d++)l[d]=m(l[d],t,o,a,u);return n=(e=i.dB(l,r,s.groupSort)).array,e.isChanged&&g(t,o,e,n,r,f,c),{array:n,isChanged:e.isChanged}}function g(t,e,n,i,r,o,a){var s,u,c,f,l,s=e?t.rowOutlines:t.columnOutlines,u=[],c=[];if(e){for(f=o;f<o+a;f++)t.XT(f)||t.rowOutlines&&t.rowOutlines.isCollapsed(f)||(t.getRowVisible(f,3,!0)?0===t.getRowHeight(f)&&(u.push(f),t.setRowHeight(f,t.defaults.rowHeight)):(c.push(f),t.setRowVisible(f,!0)));for(s.vB(n.groupSwap,n.array,r.start),f=0;f<c.length;f++)l=h.hD(i,c[f])+o,t.setRowVisible(l,!1);for(f=0;f<u.length;f++)l=h.hD(i,u[f])+o,t.setRowHeight(l,0)}else{for(f=o;f<o+a;f++)t.columnOutlines&&t.columnOutlines.isCollapsed(f)||(t.getColumnVisible(f,3)?0===t.getColumnWidth(f)&&(u.push(f),t.setColumnWidth(f,t.defaults.colWidth)):(c.push(f),t.setColumnVisible(f,!0)));for(s.vB(n.groupSwap,n.array,r.start),f=0;f<c.length;f++)l=h.hD(i,c[f])+o,t.setColumnVisible(l,!1);for(f=0;f<u.length;f++)l=h.hD(i,u[f])+o,t.setColumnWidth(l,0)}}function H(t,e,n){var t=t.oT(e,n,!1);t&&t.hasListeners()&&t.mB()}function U(t,e,n,i){var r,r,i,r=o("SheetsCalc");r&&(r=r.CalcOperatorAdjustor.gB(t.rT,t.rT,t.pB(e,n),e,n,0,0),t.bB(e,n,r,i),i=t.oT(e,n,!!r))&&(t.Ile(e,n)&&i.isDefault(!0),i.yB())}function A(t,e,n,i,r,o,a,s,u,c,f,l){for(var h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,b=t.Ut,C=b.pI,M=C&&0<C.wB.length,T=o?e:n,x=o?e+i:n+r,B=o?n:e,I=o?n+r:e+i,k=T;k<x;k++)if(k!==(y=P(s,T,k)))for(o?(h=k,v=y):(d=k,g=y),G=B;G<I;G++)o?g=d=G:v=h=G,a&&(m=u[h][d],p=u[v][g]),M&&(S=C.get(h,d),w=C.get(v,g)),f&&l&&(H(f,h,d),H(f,v,g),f.SE(h,d,v,g),U(f,h,d),U(f,v,g)),b.do("swapNode",h,d,v,g),t.b8&&t.MB(h,d,v,g),M&&C.CB(S,h,d,w,v,g),a&&(u[h][d]=p,u[v][g]=m),c.push({row:h,col:d}),c.push({row:v,col:g})}function L(t,e,n,i,r,o,a,s,u,c,f){var l,h,d,e,v,g,m,p,S,l=[],h=t.Ut.P8;if(0<h&&(e&&(t.Ut.P8=0),[].push.apply(t.Ut.G8,[{row:n,column:i,rowCount:r,columnCount:o,byRows:a,sortInfo:s,type:"sortRange",array:c.concat([]),sortState:t.getSortState()}])),d=C&&t.b3(),e=C&&t.Uw(),A(t,n,i,r,o,a,u,c,f,l,d,e),u)for(v=n;v<n+r;v++)for(g=i;g<i+o;g++)t.setValue(v,g,f[v][g]);if(d){for(m=n;m<n+r;m++)for(p=i;p<i+o;p++)(S=d.pB(m,p))&&d.SB(m,p,S,x);t.getCalcService().recalcRange(e,n,i,r,o)}return w.Worksheet.et(t,"sortRangeChanged",{column:i,columnCount:o}),0<h&&(t.Ut.P8=h),l}function D(t,e,n,i,r,o,a,s,u,c){var f,l,h,d,v,g;t.suspendPaint(),t.suspendEvent(),C&&t.suspendCalcService();try{if(c)for(l=[],h=e;h<e+i;h++)for(l[h]=[],d=n;d<n+r;d++)l[h][d]=t.getValue(h,d);return g=v=void 0,(v=u||(g=(0===s.groupSort?N:E)(t,e,n,i,r,o,a,s,l)).array)?(f=L(t,g&&g.isChanged,e,n,i,r,o,a,c,v,l),!0):!1}finally{C&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.SI(e,n,i,r,f,4,x,x,x,!!u)}}function F(t,e){for(var n,i,r,o,a,s,u,n=[],i=0,r=e;i<r.length;i++)(o=r[i]).compareFunction?(a=o,n.push({index:a.index,ascending:a.ascending,compareFunction:a.compareFunction})):o.order&&o.hasOwnProperty(f)?(s="top"!==(a=o).order,u=k(a.backColor)?"":d(a.backColor,t.currentTheme()),n.push({index:a.index,ascending:s,color:u,isBackColor:!0})):o.order&&o.hasOwnProperty(l)?(s="top"!==(a=o).order,u=k(a.fontColor)?"":d(a.fontColor,t.currentTheme()),n.push({index:a.index,ascending:s,color:u,isBackColor:!1})):(o.color&&(o.color=d(o.color,t.currentTheme())),n.push(o));return n}function j(t,e){var n,i,r;if(e){for(n=t[0],i=1;i<t.length;i++)if((r=t[i]).row!==n.row||r.rowCount!==n.rowCount)return;return 1}}function O(t,e){for(var n,i,r,o,a,s,n=t[0],i=n.row,r=1;r<t.length;r++)(o=t[r])&&o.row<i&&(i=o.row,n=o);if(i===e.row-1)return a=e.row,s=n.row+n.rowCount,e.row=s,e.rowCount=e.rowCount-(s-a),e}function _(t,e,n,i){var r,o;if(t.sortConditions)for(r in t.sortConditions)t.sortConditions&&t.sortConditions.hasOwnProperty(r)&&((o=t.sortConditions[r]).index>=e&&o.index<e+n?i.push(o.index):o.index>=e+n&&(o.index-=n))}Object.defineProperty(t,"__esModule",{value:!0}),n=o("Common"),t=o("./dist/core/util/domUtil.js"),b=o("./dist/core/util/common.js"),w=o("./dist/core/worksheet/worksheet.js"),e=o("CalcEngine"),C=!!e,e=o("./dist/core/core.ns.js"),y=o("./dist/core/core.enum.js"),M=o("./dist/core/excel-io-util/range-parser.js"),e=new n.Common.ResourceManager(e.SR,"Sheets"),S=e.getResource.bind(e),s=n.Common.ct.o0,h=n.Common.Uf,k=n.Common.lt.ht,u="boolean",c="string",T="number",f="backColor",l="fontColor",x=void 0,t.GC$.extend(w.Worksheet.prototype,{sortRange:function(t,e,n,i,r,o,a,s,u){var c,f,f,l,h,d,v,l,h,l,h,g,h,l,m,p,h,g,l,c=!1;if(0===arguments.length){if(!(f=this.getSortState()))return!1;t=f.row,e=f.col,n=f.rowCount,i=f.colCount,o=f.sortConditions,r=f.byRow,c=!0}if(l=(f=this).getRowCount(),h=f.getColumnCount(),-1===n&&(n=l),-1===e&&(e=0),-1===i&&(i=h),(t=-1===t?0:t)<0||l<=t||e<0||h<=e||n<0||l<t+n||i<0||h<e+i||!o)return!1;if(a=f.TB(b.Ec(t,e,n,i),r,a),l=r?f.rowOutlines:f.columnOutlines,!s&&0<a.groupSort){if(!l)return!1;h=l.lB(v=r?t:e,d=r?n:i),r?(n=h.count,t=h.start):(i=h.count,e=h.start)}return C&&!f.mT(t,e,n,i,!1)?(u&&f.jT(7,S().Exp_InvalidSortArrayFormulaInRange),!1):(l=b.Ec(t,e,n,i),(h=f.Ut.getSpans(l))&&0<h.length&&(g=!0,j(h,r)&&(h=O(h,l))&&(t=h.row,n=h.rowCount,g=!1),g)?(u&&f.jT(7,S().Exp_InvalidSortSpanInRange),!1):!(l=f.tables)||(p=1===(m=l.AB(t,e,n,i)).length&&m[0].dataRange().equals(b.Ec(t,e,n,i)),m.length<=0)||p?(h=f.H3,g=(!f.NMi||f.NMi._gi!==y.SheetType.ganttSheet)&&h&&h._dataSource||p&&m[0]&&m[0].z3(),(l=D(f,t,e,n,i,r,F(f,o),a,s,g))&&0!==a.groupSort&&f.IB&&f.IB.reFilter(),c||s||this.Tpe(t,e,n,i,r,o),l):(u&&f.jT(7,S().Exp_InvalidSortPartTableOrMultiTableInRange),!1))},TB:function(t,e,n){var i,t,r,o,a,e,i=this,t=i.JS(t),r=e?t.rowCount:t.colCount,o=e?t.row:t.col,a=e?i.rowOutlines:i.columnOutlines;return k(n)&&(n={}),i.outlineColumn&&i.outlineColumn.xB()&&e&&(e=i.outlineColumn.NB.columnIndex,t.col<=e&&e<=t.col+t.colCount||(n.groupSort=0)),k(n.groupSort)&&(k(n.ignoreHidden)?n.groupSort=a&&a.kB(o,r)?1:0:n.groupSort=0),0===n.groupSort?n.ignoreHidden=!!k(n.ignoreHidden)||n.ignoreHidden:n.ignoreHidden=!1,n},_B:function(){var t=this.options;return!this.isActualProtected()||t.protectionOptions.allowSort},MB:function(t,e,n,i){var r=this,o=r.getDataValidator(t,e),a=r.getDataValidator(n,i);r.setDataValidator(t,e,a),r.setDataValidator(n,i,o)},Tpe:function(t,e,n,i,r,o){var a,s,a,a,u,s=this,a=null==(a=s.rowFilter())?void 0:a.Ipe;if(!a){if(o.length<1)return s.Ape();(a={row:t,col:e,rowCount:n,colCount:i,byRow:r}).sortConditions=o,s.fQt=a}},Ape:function(){var t;this.fQt=void 0},getSortState:function(){var t,e,t=this;return t.fQt&&((e=b.RF(t.fQt,!0)).sortConditions=e.sortConditions.map(function(t){return(Object.hasOwnProperty.call(t,"backColor")||Object.hasOwnProperty.call(t,"fontColor"))&&(t.ascending=void 0,delete t.ascending),t}),e)},Npe:function(t,e){var n,i,r,o,a,n=this.getSortState();if(n&&!(t>=n.row+n.rowCount))if(t<=n.row){if(n.row=n.row+e,!n.byRow)for(i=0,r=n.sortConditions;i<r.length;i++)(o=r[i]).index=o.index+e}else if(n.rowCount=n.rowCount+e,!n.byRow&&n.sortConditions)for(a in n.sortConditions)n.sortConditions.hasOwnProperty(a)&&(o=n.sortConditions[a]).index>=t&&(o.index+=e)},kpe:function(t,e){var n,i,r,o,a,n=this.getSortState();if(n&&!(t>=n.col+n.colCount))if(t<=n.col){if(n.col=n.col+e,n.byRow)for(i=0,r=n.sortConditions;i<r.length;i++)(o=r[i]).index=o.index+e}else if(n.colCount=n.colCount+e,n.byRow&&n.sortConditions)for(a in n.sortConditions)n.sortConditions.hasOwnProperty(a)&&(o=n.sortConditions[a]).index>=t&&(o.index+=e)},_pe:function(t,e){var n,i,r,o,a,s,n=this.getSortState();if(n&&(i=[],!(t>=n.row+n.rowCount))){if(t+e<=n.row){if(n.row=n.row-e,!n.byRow)for(r=0,o=n.sortConditions;r<o.length;r++)(a=o[r]).index=a.index-e}else if(t>=n.row&&t+e<n.row+n.rowCount){if(n.rowCount=n.rowCount-e,!n.byRow&&n.sortConditions)for(s in n.sortConditions)n.sortConditions.hasOwnProperty(s)&&((a=n.sortConditions[s]).index>=t&&a.index<t+e?i.push(a.index):a.index>=t+e&&(a.index-=e))}else t<n.row?(n.rowCount-=t+e-n.row,n.row=t):n.rowCount-=n.row+n.rowCount-t,n.byRow||_(n,t,e,i);return 0<i.length&&(n.sortConditions=n.sortConditions.filter(function(t){return-1===i.indexOf(t.index)})),0===n.sortConditions.length||n.rowCount<=0?this.Ape():void 0}},Dpe:function(t,e){var n,i,r,o,a,s,n=this.getSortState();if(n&&(i=[],!(t>=n.col+n.colCount))){if(t+e<=n.col){if(n.col=n.col-e,n.byRow)for(r=0,o=n.sortConditions;r<o.length;r++)(a=o[r]).index=a.index-e}else if(t>=n.col&&t+e<n.col+n.colCount){if(n.colCount=n.colCount-e,n.byRow&&n.sortConditions)for(s in n.sortConditions)n.sortConditions.hasOwnProperty(s)&&((a=n.sortConditions[s]).index>=t&&a.index<t+e?i.push(a.index):a.index>=t+e&&(a.index-=e))}else t<n.col?(n.colCount-=t+e-n.col,n.col=t):n.colCount-=n.col+n.colCount-t,n.byRow&&_(n,t,e,i);return 0<i.length&&(n.sortConditions=n.sortConditions.filter(function(t){return-1===i.indexOf(t.index)})),0===n.sortConditions.length||n.colCount<=0?this.Ape():void 0}}}),w.Worksheet.ch("Sort",i={yh:function(t,e,n){var i,r,o,t,a,s,u,c,f,l,h,d,v,g,g,m,p,h,h,S,w,i=this,r=b.util.go,o,t=(0,b.util.xr)(t,"sortState");if(t&&(a="1"!==t.columnSort,s=M.range_parser._c(t.ref),t)){for(c=[],f=0,l=u=r(t,"sortCondition");f<l.length;f++)if(d=(h=l[f]).sortBy,v=!h.descending,g=M.range_parser._c(h.ref),g=a?g.col:g.row,p=m=void 0,"icon"!==d){for(w in d!==y.SortBy.fontColor&&d!==y.SortBy.cellColor||(h=Number.parseInt(h.dxfId,10),h=e.styleManager.getDxf(h),p=d===y.SortBy.cellColor,h&&(m=p?h.backColor:h.foreColor)),S={index:g,ascending:v},d===y.SortBy.cellColor?(S.backColor=m,S.order=v?"top":"bottom"):d===y.SortBy.fontColor&&(S.fontColor=m,S.order=v?"top":"bottom"),S)void 0===S[w]&&delete S[w];c.push(S)}i.Tpe(s.row,s.col,s.rowCount,s.colCount,a,c)}},wh:function(t,e,n){var i,r,t,o,a,s,u,c,f,l,h,d,v,v,i=this,t=t.c_,o=this.getSortState();if(o){for(r={n_:"sortState",ref:a=M.range_parser.getRangeString([new b.Range(o.row,o.col,o.rowCount,o.colCount)]),c_:[]},o.byRow||(r.columnSort=1),u=0,c=s=F(i,o.sortConditions);u<c.length;u++)f=c[u],l=void 0,h={n_:"sortCondition",ref:l=o.byRow?M.range_parser.jc(new b.Range(o.row,f.index,o.rowCount,1)):M.range_parser.jc(new b.Range(f.index,o.col,1,o.colCount))},d=f.isBackColor,v=f.color,k(v)?f.ascending||(h.descending=1):("{"===v[0]&&(v=JSON.parse(v)),v=d?{backColor:v}:{foreColor:v},h.sortBy=d?y.SortBy.cellColor:y.SortBy.fontColor,h.dxfId=e.styleManager.getDxfIndex(v),f.ascending?h.descending=1:(h.descending=null,delete h.descending)),r.c_.push(h);r&&t.push(r)}},toJson:function(t,e){var n=this.getSortState();n&&(t.sortState=n)},fromJson:function(t,e,n){var i,t,r,o,a,s,u,t,i,t=t.sortState;t&&(r=t.row,o=t.col,a=t.rowCount,s=t.colCount,u=t.byRow,t=t.sortConditions,this.Tpe(r,o,a,s,u,t))},onLayoutChanged:function(t){var e,n,i,r,o,a,t,t,e;this.getSortState()&&(n=t.changeType,i=t.row,r=t.rowCount,o=t.col,a=t.colCount,t=t.sheetArea,t=k(t)||t===y.SheetArea.viewport,"addRows"===n&&t?this.Npe(i,r):"deleteRows"===n&&t?this._pe(i,r):"addColumns"===n&&t?this.kpe(o,a):"deleteColumns"===n&&t&&this.Dpe(o,a))}})},"./dist/core/worksheet/worksheet-static.js":function(i,t,V){"use strict";var F,p,u,_,S,Y,e,K,C,y,z,W,A,w,J,B,Z,Q,r,o,e,f,X,L,et;function q(t,e){return t.getRowCount(e)}function $(t,e){return t.getColumnCount(e)}function E(t,e,n){return t.Do(e,n)}function H(t,e,n){return t._o(e,n)}function I(t,e,n,i){t.setColumnWidth(e,n,i)}function P(t,e,n,i){t.setRowHeight(e,n,i)}function R(t,e,n,i,r){return t.getActualStyle(e,n,i,B,{notClone:B,isForFilter:B,ignoreSheet:r})}function a(t,e){return t.getDefaultStyle(e)}function s(t,e,n){t.setDefaultStyle(e,n)}function N(t,e,n,i,r){t.u5(e,n,i,r)}function l(t,e,n,i){throw new Error(S.Common.zf.I5(f().Exp_InvalidAndSpace,[t,e,n,i]))}function tt(t,e,n){return e&&n.XT&&n.XT(t)}function M(t,e,n){return n?[e,t]:[t,e]}function nt(t,e,n,i,r,o,a,s){var u,t,c,i,n,o,s,t;if(!t)throw new Error(f().Exp_SrcIsNull);if(!i)throw new Error(f().Exp_DestIsNull);u=q(t),t=$(t),c=q(i),i=$(i),(e<-1||u<=e)&&l("from row index",e,"-1",u-1),(n<-1||t<=n)&&l("from column index",n,"-1",t-1),(r<-1||c<=r)&&l("to row index",r,"-1",c-1),(o<-1||i<=o)&&l("to column index",o,"-1",i-1),(n=n)<0&&(n=0,s=t),o=o<0?0:o,(s<1||t<n+s||i<o+s)&&l("column count",s,"1",Z(t-n,i-o)),(s=e)<0&&(s=0,a=u),t=r<0?0:r,(a<1||u<s+a||c<t+a)&&l("row count",a,"1",Z(u-s,c-t))}function D(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||A(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,n,i;if(r&&t instanceof r)return new r([t],t.name,{type:t.type,lastModified:t.lastModified});if(o&&t instanceof o)return new o([t],{type:t.type});for(n in e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(n)&&(i=t[n],t.hasOwnProperty(n))&&e[n]!==i&&("object"!=typeof i||i instanceof o?e[n]=i:e[n]=D(i));return e.toString=t.toString,e.valueOf=t.valueOf,e}function d(t,e,n,i,r,o,a,s,u,c){var f,l,h,d,v,g,m,p,S,w,b,C,C,f=t.getSpans(B,u),l=i.getSpans(B,u),h=[];if(f)for(d=0;d<f.length;d++)g=(v=f[d]).row,m=v.col,p=v.rowCount,S=v.colCount,-1===e?n<=m&&m+S<=n+s&&h.push(X(g,o+m-n,p,S,c)):-1===n?e<=g&&g+p<=e+a&&h.push(X(r+g-e,m,p,S,c)):e<=g&&g<e+a&&n<=m&&m<n+s&&h.push(X(r+g-e,o+m-n,p,S,c));if(l)for(d=0;d<l.length;d++)g=(v=l[d]).row,w=void 0,b=o<=(m=v.col)&&m<o+s,C=r<=g&&g<r+a,(w=-1===e?b:-1===n?C:C&&b)&&(C=i.findSpan(g,m,u))&&C.row===g&&C.col===m&&i.do("removeSpan",C,u);for(d=0;d<h.length;d++)i.do("addSpan",h[d],u)}function it(t){t.forEach(function(t){var e=t.sheet,n=t.r,i=t.c,t=t.value;e.setTemplateCell?e.setTemplateCell(n,i,t):e.setBindingPath&&e.setBindingPath(n,i,t)})}function k(t,e,n){for(var t,i,r,o,a,s,u,c,t=t.JS(e),i=t.row,r=t.col,o=t.rowCount,a=t.colCount,s=0;s<o;s++)for(u=n[i+s]=n[i+s]||{},c=0;c<a;c++)u[r+c]=!0}function b(t,e){return t===e&&t.name()===e.name()}function T(t){var e=p([],t.sheets,!0);return t.mp&&0<t.mp.length&&t.mp.forEach(function(t){t.Mf&&e.push(t.Mf)}),e}function rt(r,o,a,s,u,c,f,l){var t,h,d,v,g,t,m,t,e,n,t=V("SheetsCalc");if(t)if(h=t.QB,g=r.Ut.pj(),r.parent&&r.parent.sheets)for(m=T(r.parent),(t=r.parent.getCustomNames())&&w(t,function(t,e){d=e.getExpression(),(v=h(null,r,o,a,s,u,c,f,l,d))!==d&&e.SB(v,g)}),e=function(n){var t,i,t=m[n].getCustomNames();t&&(i=[],w(t,function(t,e){d=e.getExpression(),(v=h(m[n],r,o,a,s,u,c,f,l,d))!==d&&(e.SB(v,g),i.push({nameInfo:e,oldExpr:d,newExpr:v}))}),0<i.length)&&"function"==typeof m[n].onCustomNameFormulaChanged&&m[n].onCustomNameFormulaChanged(i)},n=0;n<m.length;n++)e(n);else(t=r.getCustomNames())&&w(t,function(t,e){d=e.getExpression(),(v=h(r,r,o,a,s,u,c,f,l,d))!==d&&e.SB(v,g)})}function x(t,e,n,i,r,o,a,s,u){var t;n&&r&&(r=t.adjustFormulaOnMoveSwap(i,o,a,r,s,!0,{crossSheetMoved:u}),t=n.unparse(i,r,o,a),e.setDefaultValue(o,a,t,J,Y.DefaultChangeValueType.Expression,J,!0))}function v(t,e,n,i,r,o){var a,s,u,c,f,l,h,d,v,g,m,p,S,w,b;if(t)for(l in a=n!==i,s=n.Ut,u=i.Ut,c=n.Uw(),f=n.op(),t)if(t.hasOwnProperty(l)&&(h=t[l]))for(d in h)h.hasOwnProperty(d)&&(v=h[d])&&v.expr&&(o?x(e,u,f,c,S=v.expr,w=v.destRow,b=v.destCol,r,a):A(n.getValueIgnoreDefault(g=+l,m=+d))||x(e,s,f,c,v.expr,g,m,r,a))}function ot(t,e,n,i,r,o,a,s,u){var c,f,l,h,f,l,e,d,c=V("SheetsCalc");c&&(f=t.op(),l=t.Uw(),h=i.Uw(),f)&&l&&h&&(f=new c.MoveSwapInfo(l,e,n,h,r,o,a,s),v(d=(e=(l=t.Ut)&&l.yle())&&e.gle(),c,t,i,f),v(u,c,t,i,f,!0))}function h(t,e,n,i,r,o,a,s,u,c,f){var l,t,h,l=!(t===i&&t.name()===i.name()),t=t.Ut,h=t.K_(c);l?(d(t,e,n,i.Ut,r,o,a,s,c,f),u&&h&&t.do("clearSpan",e,n,a,s,c)):u?t.do("moveSpan",e,n,r,o,a,s,c):t.do("copySpan",e,n,r,o,a,s,c,f)}function G(t,e,a,s,u,c,f,l){var h,n,i,d,r,o,v,g,h={},n=X(a,s,u,c),i=t.Uw(3).t8,d=e.Uw(3).t8,r=i&&i.jme(a,s,u,c),o=d&&d.jme(f,l,u,c),v=d&&d.b3();return t===e&&n.intersect(f,l,u,c)?(g=[],r&&r.forEach(function(t){i.Rme(t),t.minX>=a&&t.minY>=s&&g.push(t)}),o&&o.forEach(function(t){i.Rme(t),v.gF(t.minX,t.minY,1,1),t.minX>=f&&t.minY>=l&&d.Lme(t,!0)}),g.forEach(function(t){var t={minX:t.minX+f-a,minY:t.minY+l-s,maxX:t.maxX+f-a,maxY:t.maxY+l-s,isValid:t.isValid};d.Bme(t,!0)})):(o&&o.forEach(function(t){t.minX>=f&&t.minY>=l?d.Rme(t,!0,!0):(d.Rme(t),v.gF(t.minX,t.minY,1,1))}),r&&r.forEach(function(t){var e,n,i,r,o;if(t.minX>=a&&t.minY>=s)(e={minX:t.minX+f-a,minY:t.minY+l-s,maxX:Z(t.maxX+f-a,f+u-1),maxY:Z(t.maxY+l-s,l+c-1),isValid:t.isValid}).isValid||(e.maxX=e.minX,e.maxY=e.minY),d&&d.Bme(e,!0);else if(t.isValid)for(n=Z(t.maxX,a+u-1),i=Z(t.maxY,s+c-1),r=Q(t.minX,a);r<=n;r++)for(h[r]=h[r]||{},o=Q(t.minY,s);o<=i;o++)h[r][o]=1})),h}function at(t,e,n,i,r,o,a,s){var u=V("SheetsCalc");u&&u.CalcOperatorAdjustor.moveFormula(t,e,n,i,r,o,a,s)}function st(t,e,n,i,r,o,a,s,u){var c,f,l,e,h,d,v,g,m,c={};if(t===e&&t.tables)for(f=X(n,i,r,o),l=X(a,s,r,o),h=(e=t.tables).all(),d=void 0,v=0,g=(h=e.zB?h.concat(e.zB):h).length;v<g;v++)(d=(m=h[v]).VB||m.range()).containsRange(f)&&d.containsRange(l)?k(t,f,c):(d.intersect(l.row,l.col,l.rowCount,l.colCount)||u&&f.containsRange(d))&&k(t,d,c);return c}function n(t,e,n,i,r,o,a,s,u,c){var t;this.src=t,this.dest=e,this.srcRow=n,this.srcColumn=i,this.destRow=r,this.destColumn=o,this.copyRowCount=a,this.copyColumnCount=s,this.isMove=u,null!=(t=(this.options=c).pasteSpecialOptions)&&t.skipBlanks&&(this.jpe=new _.Rf)}function ut(t,e,n,i,r,o,a,s,u){var c,f,c,f;z.Worksheet.et(e,"onCopyOrMoveRange",{srcSheet:t,isMove:n,fromRow:i,fromCol:r,toRow:o,toCol:a,rowCount:s,colCount:u})}function U(t,e,n,i,r,o,a,s,u,c,f){var l,h,d,v,g,m,d,p,S,w,b,C,y,l,c,h,d,F,M,k,T,x,G,_,A,L,B,M,l,I,f,M,f,P,D,R,j,N,E,H,U,O;if(c.skipRangeCheck||nt(t,e,n,i,r,o,a,s),v=c.copyToOption,g=c.ignoreFilteredOutRow,m=c.ignorePasteSkipInvisibleRange,d=c.pasteSpecialOptions,p=c.needHideFormula,C=null==d?void 0:d.pasteLink,(null!=d&&d.operationOptions||null!=d&&d.transpose)&&(y={operationOptions:null!=d&&d.operationOptions?{option:null==d?void 0:d.operationOptions,useValue:0<(1&v)&&(2&v)<=0}:void 0,transpose:d.transpose}),l=null==(l=null==d?void 0:d.advancedPasteOptions)?void 0:l.validator,c=new et(t,i,e,n,r,o,a,s,u,c),h=null==(h=null==d?void 0:d.advancedPasteOptions)?void 0:h.columnWidth,d=null==(d=null==d?void 0:d.advancedPasteOptions)?void 0:d.numberFormats,C&&(v=0),0<(1&(v=null!=y&&y.operationOptions?(v&=~Y.CopyToOptions.value)|Y.CopyToOptions.formula:v))&&0<(2&v)&&(M=t.pivotTables)&&(F=M.KB(X(Q(0,e),Q(0,n),e<0?Z(q(t),q(i)):a,n<0?Z($(t),$(i)):s),u)),u&&i.UB&&e<0)for(b=s,(w=n)<0&&(w=0,b=Z($(t),$(i))),(k=o)<0&&(k=0),S=!0,T=0;T<b;T++)x=t.Ut.q_(!1,3,w+T),G=t.Ut.q_(!1,3,k+T),_=x&&x.name,A=G&&G.name,x&&G&&_&&A||(S=!1),(G=K.GC$.extend(!0,{},i.Ut.q_(!1,3,k+T)||{})).displayName=x&&x.displayName,G.name=x&&x.name,i.Ut.do("setItem",!1,3,k+T,G);!(0<(64&v)||l)||null!=f&&f.ignoreValidator||(c.copyMoveMultiColumnPrecedents(),t.b8&&c.copyMoveValidator()),0<(64&v)&&(L=st(t,i,e,n,a,s,r,o,u)),0<(512&v)&&c.copyOrMoveConditionalFormat(),0<(1&v)&&0<(2&v)&&(M=t.tables)&&(B=M.KB(X(Q(0,e),Q(0,n),e<0?Z(q(t),q(i)):a,n<0?Z($(t),$(i)):s),u)),(l=W)&&(t.suspendCalcService(),i.suspendCalcService()),I=[],f=J,M=[],0<(256&v)&&(I=(f=c.copyMoveBindingPath()).savedValues,M=f.bindingPathInfos),0<(2048&v)&&(f=c.copyMoveDefaultValue(),u)&&f&&ot(t,e,n,i,r,o,a,s,f);try{if(C&&c.copyCellLink(),P=i.pivotTables,0<(1&v)&&0<(2&v)&&P&&P.JB(F,t,Q(0,e),Q(0,n),i,Q(0,r),Q(0,o),a,s,u),0<(1&v)&&!S){if(W&&0==(2&v)&&i.clearFormula(r,o,a,s,function(t,e){return!g||!t.XT||!t.XT(e)}),u?c.moveValue():c.copyValue(),0<(256&v))for(it(M),D=I.length,R=r<0?0:r,j=o<0?0:o,N=0;N<D;N++)E=I[N],!u&&tt(R+E.row,g,i)||i.setValue(R+E.row,j+E.col,E.value)}else 0<(256&v)&&it(M);(0<(64&v)||d)&&c.copyMoveStyle(L),H=i.tables,0<(1&v)&&0<(2&v)&&H&&H.JB(B,Q(0,e),Q(0,n),Q(0,r),Q(0,o),u),ut(t,i,u,e,n,r,o,a,s),W&&(u?(U={needAdjustCustomNameOnMove:!0},z.Worksheet.et(t,"adjustCustomNameOnMove",U),U.needAdjustCustomNameOnMove&&rt(t,e,n,i,r,o,a,s),0<(2&v)&&at(t,e,n,i,r,o,a,s)):0<(2&v)&&(O=V("SheetsCalc"))&&O.XB(t,e,n,i,r,o,a,s,g,m,!0,y,p),0<(1&v))&&0<(2&v)&&H&&H.qB(B),0<(4&v)&&c.copyMoveComment(),0<(128&v)&&c.copyMoveTag(),0<(1024&v)&&c.copyMoveHyperlink(),0<(4096&v)&&c.copyMoveAltText()}finally{l&&(t.resumeCalcService(!1),i.resumeCalcService(!1))}if(0<(16&v)&&c.copyOrMoveSparkline(),0<(8&v)&&(e<0&&c.copyOrMoveColumnRangeGroup(),n<0)&&c.copyOrMoveRowRangeGroup(),0<(32&v)&&(!u&&1===a&&1===s||c.copyOrMoveSpan()),e<0&&r<=0&&c.copyOrMoveColumnAxis(),n<0&&o<=0&&c.copyOrMoveRowAxis(),e<0&&r<=0&&n<0&&o<=0&&c.copyOrMoveSheetInfo(),h&&c.copyColumnWidth(),u&&t.UB&&e<0)for(b=s,(w=n)<0&&(w=0,b=Z($(t),$(i))),T=0;T<b;T++)t.getDataColumnName&&t.getDataColumnName(w+T)&&t.Ut.do("setItem",!1,3,w+T,J)}F=this&&this.__assign||function(){return(F=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},p=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var i=0,r=e.length,o;i<r;i++)!o&&i in e||((o=o||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))},Object.defineProperty(t,"__esModule",{value:!0}),t.staticMembers=void 0,u=V("./dist/core/core.ns.js"),_=V("./dist/core/util/common.js"),S=V("Common"),Y=V("./dist/core/core.enum.js"),e=V("CalcEngine"),K=V("./dist/core/util/domUtil.js"),C=V("./dist/core/worksheet/worksheet-model.js"),y=V("./dist/core/worksheet/style.js"),z=V("./dist/core/worksheet/worksheet.js"),W=!!e,A=S.Common.lt.ht,w=K.GC$.each,J=null,B=void 0,Z=Math.min,Q=Math.max,r="undefined"!=typeof window?window.File:J,o="undefined"!=typeof window?window.Blob:J,e=new S.Common.ResourceManager(u.SR,"Sheets"),f=e.getResource.bind(e),X=function(t,e,n,i,r){return new _.Range(t,e,r?i:n,r?n:i)},L=function(t,e,n,i,r,o,a,s,u,c,f){var l,h,d,v,g,m,p,S,w,b,l=f.pasteSkipInvisibleRange,h=f.sheetArea,d=s,v;if(!(t===e&&t.name()===e.name()))for(m=g=0;g<a&&g<q(e,h);g++)if(l&&0===e.getRowHeight(i+g,h))a++;else{for(s=d,S=p=0;p<s&&p<$(e,h);p++)l&&0===e.getColumnWidth(o+p,h)?s++:(c(e,i+g,o+p,D(w=u(t,n+m,r+S,h)),h,{sheet:t,row:n+m,col:r+S}),S++);m++}else{for(b=new _.Rf,g=0;g<a;g++)for(p=0;p<s;p++)w=u(t,n+g,r+p,h),A(w)||b.set(g,p,D(w));for(m=g=0;g<a&&g<q(e,h);g++)if(l&&0===e.getRowHeight(i+g,h))a++;else{for(s=d,S=p=0;p<s&&p<$(e,h);p++)l&&0===e.getColumnWidth(o+p,h)?s++:(c(e,i+g,o+p,b.get(m,S),h,{sheet:t,row:n+m,col:r+S}),S++);m++}}},n.prototype.Ope=function(t,e,n){var i,r,o,a,s,u,c,f,l,r,n,h,d,i,v,g,m,n,i,p,S,n,i,w,b,C,y,M,k,T,x,G,B,I,P,R,N,E,H,U,r=this,o=r.src,a=r.srcRow,s=r.srcColumn,u=r.dest,c=r.destRow,f=r.destColumn,l=r.copyRowCount,r=r.copyColumnCount,n=F(F({},this.options),n),h=n.ignoreFilteredOutRow,d=n.copyPasteHeaders,i=n.ignorePasteSkipInvisibleRange,v=!(o===u&&o.name()===u.name()),g=!i&&u.o5(),m=null==(i=n.pasteSpecialOptions)?void 0:i.transpose;if(2==(2&d)&&a<0&&(n=s,i=f,p=Z(q(o,1),q(u,1)),S=r,s<0&&(n=0,S=$(o)),L(o,u,0,0,n,i=f<0?0:i,p,S,t,e,{pasteSkipInvisibleRange:g,sheetArea:1})),1==(1&d)&&s<0&&(n=a,i=c,p=l,S=Z($(o,2),$(u,2)),a<0&&(n=0,p=q(o)),L(o,u,n,i=c<0?0:i,0,0,p,S,t,e,{pasteSkipInvisibleRange:g,sheetArea:2})),w=a,b=s,C=c,y=f,M=l,k=r,T=q(u),x=$(u),a<0&&(w=0,M=Z(q(o),T)),s<0&&(b=0,k=Z($(o),x)),c<0&&(C=0),f<0&&(y=0),G=k,v)for(I=B=0;I<M&&C+I<T;I++)if(g&&0===u.getRowHeight(C+I))M++;else{if(!tt(C+I,h,u))for(k=G,R=P=0;R<k&&y+R<x;R++)g&&0===u.getColumnWidth(y+R)?k++:(e(u,C+I,y+R,D(H=t(o,N=w+(m?P:B),E=b+(m?B:P),3)),3,{sheet:o,row:N,col:E}),P++);B++}else{U=new _.Rf;try{for(I=0;I<M;I++)for(R=0;R<k;R++)H=t(o,N=w+(m?R:I),E=b+(m?I:R),3),A(H)||U.set(I,R,D(H));for(I=B=0;I<M&&C+I<T;I++)if(g&&0===u.getRowHeight(C+I))M++;else{if(!tt(C+I,h,u))for(k=G,R=P=0;R<k&&y+R<x;R++)g&&0===u.getColumnWidth(y+R)?k++:(e(u,C+I,y+R,U.get(B,P),3,{sheet:o,row:w+(m?R:I),col:b+(m?I:R)}),P++);B++}}catch(t){}}},n.prototype.copyOrMoveConditionalFormat=function(){var t,e,n,i,r,o,a,s,u,c,e,f,t,l,h,i,n,e=this,n=e.src,i=e.dest,r=e.srcRow,o=e.srcColumn,a=e.destRow,s=e.destColumn,u=e.copyRowCount,c=e.copyColumnCount,e=e.isMove,f=this.options.ignorePasteSkipInvisibleRange,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.transpose,l=n.conditionalFormats,h=i.conditionalFormats,i=b(n,i);l&&h&&!n.EB&&(n=l.jB(r,o,h,a,s,u,c,i,f,t),e)&&l.OB(r,o,u,c,n,i)},n.prototype.copyOrMoveSparkline=function(){var t,e,n,i,r,o,a,s,u,t,c,f,l,t=this,e=t.src,n=t.dest,i=t.srcRow,r=t.srcColumn,o=t.destRow,a=t.destColumn,s=t.copyRowCount,u=t.copyColumnCount,t=t.isMove,c=this.options.ignorePasteSkipInvisibleRange;i<0&&(i=0,s=Z(q(e),q(n))),o<0&&(o=0),r<0&&(r=0,u=Z($(e),$(n))),a<0&&(a=0),(f=!(e===n&&e.name()===n.name()))?(l=n.RB)&&(t?0<e.RB.count()&&l.BB(e,i,r,o,a,s,u):l.LB(e,i,r,o,a,s,u,B,c)):(l=e.RB)&&(t?0<l.count()&&l.iE(i,r,o,a,s,u):l.tE(i,r,o,a,s,u,B,c))},n.prototype.copyOrMoveColumnRangeGroup=function(){var t,e,n,i,r,o,t,a,s,u,t=this,e=t.src,n=t.srcColumn,i=t.dest,r=t.destColumn,o=t.copyColumnCount,t=t.isMove;n<0&&(n=0,o=Z($(e),$(i))),r<0&&(r=0),a=e.columnOutlines,s=i.columnOutlines,(u=!(e===i&&e.name()===i.name()))?a&&s&&s.FB(a,n,r,o,t):a&&a.PB(n,r,o,t)},n.prototype.copyOrMoveRowRangeGroup=function(){var t,e,n,i,r,o,t,a,e,i,t=this,e=t.src,n=t.srcRow,i=t.dest,r=t.destRow,o=t.copyRowCount,t=t.isMove;n<0&&(n=0,o=Z(q(e),q(i))),r<0&&(r=0),a=!(e===i&&e.name()===i.name()),e=e.rowOutlines,i=i.rowOutlines,a?e&&i&&i.FB(e,n,r,o,t):e&&e.PB(n,r,o,t)},n.prototype.copyOrMoveSpan=function(){var t,e,n,i,r,o,a,s,u,c,e,t,f,l,e=this,n=e.src,i=e.srcRow,r=e.srcColumn,o=e.dest,a=e.destRow,s=e.destColumn,u=e.copyRowCount,c=e.copyColumnCount,e=e.isMove,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.transpose,f=i,l=r;f<0&&(f=0,u=Z(q(n),q(o))),a<0&&(a=0),l<0&&(l=0,c=Z($(n),$(o))),s<0&&(s=0),i<0&&h(n,-1,l,o,-1,s,-1,c,e,1,t),r<0&&h(n,f,-1,o,a,-1,u,-1,e,2,t),h(n,f,l,o,a,s,u,c,e,Y.SheetArea.viewport,t)},n.prototype.copyOrMoveColumnAxis=function(){var t,e,n,i,r,o,a,t,s,u,c,t,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,t=this,e=t.src,n=t.srcColumn,i=t.dest,r=t.destColumn,o=t.copyColumnCount,a=t.isMove,t=this.options,s=t.copyToOption,u=t.ignorePasteSkipInvisibleRange,c=t.ignoreSheet;for(n<0&&(n=0,o=Z($(e),$(i))),t=o,r<0&&(r=0),f=!u&&i.o5(),l=1,h=[],v=d=0;d<o&&d<$(i,1);d++)f&&0===i.getColumnWidth(r+d)?o++:(g={},0<(64&s)&&(m=E(e,v+n),A(m)||(g.size=m,a&&I(e,d+n,e.defaults.colWidth)),p=e.getColumnVisible(v+n),A(p)||(g.visible=p,a&&e.setColumnVisible(d+n,!0)),S=R(e,-1,v+n,B,c),g.style=S,a&&N(e,-1,d+n,J),S=R(e,-1,v+n,1,c),g.headerStyle=S,a&&N(e,-1,d+n,J,1),w=e.Lt(v+n),A(w)||(g.columnHeaderFitMode=w,a&&e.GB(d+n,Y.ColumnHeaderFitMode.normal))),0<(128&s)&&(b=e.getTag(-1,v+n),A(b)||(g.tag=b,a&&e.setTag(-1,d+n,B))),h[v+n]=g,v++);for(o=t,v=d=0;d<o&&d<$(i,1);d++)f&&0===i.getColumnWidth(r+d)?o++:(g=h[v+n],0<(64&s)&&(m=g.size,A(m)||I(i,d+r,m),p=g.visible,A(p)||i.setColumnVisible(d+r,p),N(i,-1,d+r,(S=g.style)?S.clone():J),N(i,-1,d+r,(S=g.headerStyle)?S.clone():J,1),w=g.columnHeaderFitMode,A(w)||i.GB(d+r,w)),0<(128&s)&&(b=g.tag,A(b)||i.setTag(-1,d+r,b)),v++);for(C=q(i,1),y=Z(q(e,1),C),k=M=0;M<y&&M<C;M++)f&&0===i.getRowHeight(M,1)?y++:(T=H(e,k,1),A(T)||(a&&P(e,M,e.defaults.colHeaderRowHeight,1),P(i,M,T,1)),k++)},n.prototype.copyOrMoveRowAxis=function(){var t,e,n,i,r,o,a,t,s,u,c,f,t,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,t=this,e=t.src,n=t.srcRow,i=t.dest,r=t.destRow,o=t.copyRowCount,a=t.isMove,t=this.options,s=t.copyToOption,u=t.ignoreFilteredOutRow,c=t.ignorePasteSkipInvisibleRange,f=t.ignoreSheet;for(n<0&&(n=0,o=Z(q(e),q(i))),t=o,r<0&&(r=0),l=!c&&i.o5(),h=2,d=[],g=v=0;v<o&&r+v<q(i,2);v++)l&&0===i.getRowHeight(r+v)?o++:(!a&&tt(r+v,u,i)||(m={},0<(64&s)&&(p=H(e,g+n),A(p)||(m.size=p,a&&P(e,v+n,e.defaults.rowHeight)),S=e.getRowVisible(g+n),A(S)||(m.visible=S,a&&e.setRowVisible(v+n,!0)),w=R(e,g+n,-1,B,f),m.style=w,a&&N(e,v+n,-1,J),w=R(e,g+n,-1,2,f),m.headerStyle=w,a)&&N(e,v+n,-1,J,2),0<(128&s)&&(b=e.getTag(g+n,-1),A(b)||(m.tag=b,a&&e.setTag(v+n,-1,B))),d[g+n]=m),g++);for(o=t,C=i.rowFilter&&i.rowFilter()&&i.rowFilter().extendedRange,g=v=0;v<o&&r+v<q(i,2);v++)y=r+v,l&&0===i.getRowHeight(y)?o++:(!a&&tt(y,u,i)||(m=d[g+n],0<(64&s)&&(p=m.size,A(p)||P(i,y,p),S=m.visible,A(S)||(C&&C.intersect(y,-1,1,0)?i.filterRowsVisibleInfo.rowsVisibleInfo[y]=!!S:i.getRowVisible(y)!==S&&i.setRowVisible(y,S)),N(i,y,-1,(w=m.style)?w.clone():J),N(i,y,-1,(w=m.headerStyle)?w.clone():J,2)),0<(128&s)&&(b=m.tag,A(b)||i.setTag(y,-1,b))),g++);for(M=$(i,2),k=Z($(e,2),M),x=T=0;T<k&&T<M;T++)l&&0===i.getColumnWidth(T,2)?k++:(G=E(e,x,2),A(G)||(a&&I(e,T,e.defaults.rowHeaderColWidth,2),I(i,T,G,2)),x++)},n.prototype.copyOrMoveSheetInfo=function(){var t,e,n,t,i,i,i,n,t=this,e=t.src,n=t.dest,t=t.isMove,i=this.options.copyToOption;e===n&&e.name()===n.name()||(0<(64&i)&&(i=a(e),s(n,t?i:i.clone()),i=a(e,1),s(n,t?i:i.clone(),1),i=a(e,2),s(n,t?i:i.clone(),2),t)&&(s(e,J),s(e,J,1),s(e,J,2)),i=n.defaults,n=e.defaults,i.colWidth=n.colWidth,i.rowHeight=n.rowHeight,i.rowHeaderColWidth=n.rowHeaderColWidth,i.colHeaderRowHeight=n.colHeaderRowHeight,t&&(n.colWidth=62,n.rowHeight=20,n.rowHeaderColWidth=40,n.colHeaderRowHeight=20))},n.prototype.copyValue=function(){var o,t,t,e,n,i,r,u,a,s,c,e,t,f,l,h,t,d,v,g,m,o=this,e=this,n=e.src,i=e.srcRow,r=e.srcColumn,u=e.dest,a=e.destRow,s=e.destColumn,c=e.copyRowCount,e=e.copyColumnCount,t=this.options,f=t.copyToOption,l=t.treatRichTextAsNormal,h=null==(t=this.options.pasteSpecialOptions)?void 0:t.skipBlanks,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.transpose,d;0<(2&f)&&W&&(v=G.apply(void 0,p(p([n,u,i,r],M(c,e,t),!1),[a,s],!1))),this.Ope(g=function(t,e,n,i){var r,o,a,s,a,a,s,r,a=l?0:1,s=t.Ut;return 3===i?o=v&&v[e]&&v[e][n]?B:t.getValueIgnoreDefault(e,n,i,a):(o=s.getValue(e,n,i,!0,a),1===i&&A(o)&&u.UB&&(a=t.H3)&&a._dataSource&&(a=s.q_(!1,3,n),s=t.options.colHeaderAutoTextIndex,a)&&(0<=s&&e===s||-1===s&&e===q(t,i)-1)&&(o=a.displayName||a.name)),o},m=function(t,e,n,i,r){A(i)?h?o.jpe.set(e,n,!0):t.YI(e,n,J,r,!!t.HB,!0):A(i)||t.YI(e,n,i,r,!!t.HB,!0)})},n.prototype.moveValue=function(){var t,s,u,c,f,o,a,l,h,t,e,d,n,v,g,m,p,S,i,r,w,b,t=this,s=t.src,u=t.srcRow,c=t.srcColumn,f=t.dest,o=t.destRow,a=t.destColumn,l=t.copyRowCount,h=t.copyColumnCount,t=this.options,e=t.copyToOption,d=t.treatRichTextAsNormal,n,v={},g={},m=[];0<(2&e)&&W&&(p=s.Uw(3).t8,S=f.Uw(3).t8,(i=p&&p.jme(u,c,l,h)).forEach(function(t){var e,n,i,r,o,a;if(t.minX>=u&&t.minY>=c)if(!t.isValid||t.maxX<u+l&&t.maxY<c+h)m.push(t);else{for(e=[],n=t.minX;n<=t.maxX;n++)for(e.push(i=[]),r=t.minY;r<=t.maxY;r++)i.push(s.getValueIgnoreDefault(n,r,3));m.push(t),t._v=e,p.Rme(t,!1,!0)}else if(t.isValid)for(o=Z(t.maxX,u+l-1),a=Z(t.maxY,c+h-1),n=Q(t.minX,u);n<=o;n++)for(v[n]=v[n]||{},r=Q(t.minY,c);r<=a;r++)v[n][r]=1;else p.b3().gF(t.minX,t.minY,1,1)}),(r=S&&S.jme(o,a,l,h)).forEach(function(t){var e,n,i,r;if(!(0<=m.indexOf(t)))if(t.minX>=o&&t.minY>=a)S.Rme(t,!0,!0,!0);else if(t.isValid)for(e=Z(t.maxX,o+l-1),n=Z(t.maxY,a+h-1),i=Q(t.minX,o);i<=e;i++)for(g[i]=g[i]||{},r=Q(t.minY,a);r<=n;r++)g[i][r]=t})),this.Ope(w=function(t,e,n,i){var r,o,a,s,a,a,u,r=3===i,a=d?0:1,s=t.Ut;return r?o=v&&v[e]&&v[e][n]?B:t.getValueIgnoreDefault(e,n,i,a):(o=s.getValue(e,n,i,!0,a),1===i&&A(o)&&f.UB&&(a=t.H3)&&a._dataSource&&(a=s.q_(!1,3,n),u=t.options.colHeaderAutoTextIndex,a)&&(0<=u&&e===u||-1===u&&e===q(t,i)-1)&&(o=a.displayName||a.name)),A(o)||(r?t.YI(e,n,J,i,!1,!0):s.do("setValue",e,n,J,i,!0,!0)),o},b=function(t,e,n,i,r){var o=g&&g[e]&&g[e][n];A(i)?o&&o.isValid||t.YI(e,n,J,r,!!t.HB,!0):(o&&o.isValid&&S.Rme(o,!0,s.Ut.G8),t.YI(e,n,i,r,!!t.HB,!0))}),(m=m.map(function(t){p.Lme(t,!0);var e={minX:t.minX+o-u,minY:t.minY+a-c,maxX:t.maxX+o-u,maxY:t.maxY+a-c,_v:t._v,isValid:t.isValid};return t._v=null,e})).forEach(function(t){t._v?S.setArray(t.minX,t.minY,t.maxX-t.minX+1,t.maxY-t.minY+1,t._v,!1,!0):S.Bme(t,!0)})},n.prototype.copyMoveStyle=function(s){var g,t,t,m,u,p,t,c,S,w,e,n,g=this,m=this.isMove,u=this.options.ignoreSheet,p=null==(t=this.options.pasteSpecialOptions)?void 0:t.skipBlanks,t=null==(t=this.options.pasteSpecialOptions)?void 0:t.advancedPasteOptions,c=null==t?void 0:t.usingSourceTheme,S=null==t?void 0:t.noBorder,w=null==t?void 0:t.numberFormats,e,n;this.Ope(function(t,e,n,i){var r,o,a,r=(3===i||A(i))&&s&&s[e]&&s[e][n],a=t.Z_(e,n,i);return c?(o=t.getActualStyle(e,n,i,B,{notClone:B,isForFilter:B,ignoreSheet:u}))&&(delete o.themeFont,a||delete o.parentName):(o=t.getCompositeStyle(e,n,i,B,B,B,{hasTableStyle:r,ignoreSheet:u}))&&!a&&delete o.parentName,m&&o&&N(t,e,n,J,i),o},function(t,e,n,i,r,o){var a,a,s,u,c,f,l,h,d,a,v;p&&g.jpe.get(e,n)||(w&&(a=i.formatter,(i=(i=t.getStyle(e,n))||new y.Style).formatter=a),S&&(s=(a=t.getCompositeStyle(e,n)).diagonalUp,u=a.diagonalDown,c=a.borderTop,f=a.borderBottom,l=a.borderLeft,h=a.borderRight,d=a.borderHorizontal,a=a.borderVertical,Object.assign(i,{diagonalUp:s,diagonalDown:u,borderTop:c,borderBottom:f,borderLeft:l,borderRight:h,borderHorizontal:d,borderVertical:a})),N(t,e,n,i,r),z.Worksheet.et(t,"afterCopyMoveStyle",v={target:{sheet:t,row:e,col:n},source:o,isMove:m}))})},n.prototype.copyMoveValidator=function(){var t,u,a,s,c,f,l,h,d,v,e,n,i,r,r,r,g,o,m,t=this,u=t.src,a=t.srcRow,s=t.srcColumn,c=t.dest,f=t.copyRowCount,l=t.copyColumnCount,h=t.isMove,d=t.destRow,v=t.destColumn,e=u.b8.YB;for(n in e)(i=e[n])&&(r=i._S,h&&u===c&&r&&(r=r.some(function(t){return t.contains(a,s,f,l)&&!t.equals(new _.Range(a,s,f,l))}),i.Epe=r),r=i.condition())&&r.initExpression();h&&b(u,c)&&(g=new S.Common.rbush),this.Ope(o=function(t,e,n){var i,r,o,o,i=t.getDataValidator(e,n,3);return i&&(h&&(r=void 0,!i.Epe&&1===i._S.length&&b(u,c)&&((r=i._S[0]).isInner(a,s,f,l)?g.insert({minX:r.row+d-a,minY:r.col+v-s,maxX:r.row+d-a+r.rowCount-1,maxY:r.col+v-s+r.colCount-1,rc:r.rowCount,cc:r.colCount}):a===d&&s<v&&s>r.col&&s+l>=r.col+r.colCount?(o=r.colCount+v-s,g.insert({minX:r.row,minY:r.col,maxX:r.row+r.rowCount-1,maxY:r.col+o-1,rc:r.rowCount,cc:o})):s===v&&a<d&&a>r.row&&a+f>=r.row+r.rowCount?(o=r.rowCount+d-a,g.insert({minX:r.row,minY:r.col,maxX:r.row+o-1,maxY:r.col+r.colCount-1,rc:o,cc:r.colCount})):r=null),r?t.setDataValidator(r.row,r.col,r.rowCount,r.colCount,J):t.setDataValidator(e,n,J)),b(u,c))&&(i.ZB=!0),i},m=function(t,e,n,i){var r,o,a,s,r=!1;g&&0<(s=g.search({minX:e,minY:n,maxX:e,maxY:n})).length&&(i&&t.setDataValidator(s[0].minX,s[0].minY,s[0].rc,s[0].cc,i),r=!0),r||t.setDataValidator(e,n,i),b(u,c)&&i&&delete i.ZB},{copyPasteHeaders:0})},n.prototype.copyMoveComment=function(){var t,r,o,e,n,r=this.isMove,o=null==(t=this.options.pasteSpecialOptions)?void 0:t.skipBlanks,e,n;this.Ope(function(t,e,n){var t,i,t=t.Ut.pI,i=t&&t.get(e,n);return i&&r&&t.remove(e,n),i},function(t,e,n,i){var t;o&&!i||(t=t.Ut.pI)&&t.WB(e,n,i)},{copyPasteHeaders:0})},n.prototype.copyMoveMultiColumnPrecedents=function(){var h,t,e,h=this.isMove,t,e;this.Ope(function(t,e,n){var i,r,o,a,s,u,c,f,l,l,i=t.Rpe&&t.Rpe(),r=[],o=t.name();if(i)for(a=0,s=i.length;a<s;a++)if(u=i[a])for(c=0,f=u.length;c<f;c++)(l=u[c])&&(h&&(u[c]=l.filter(function(t){return t.row!==e||t.col!==n||t.targetSheetName!==o})),l=l.filter(function(t){return t.row===e&&t.col===n&&t.targetSheetName===o})[0])&&r.push({row:a,col:c,dataSource:l.dataSource,dependSheetName:l.dependSheetName});return r},function(i,r,o,t){var a;t&&t.length&&(a=i.Rpe&&i.Rpe(),t.forEach(function(e){var t=e.row,n=e.col;void 0===a[t]&&(a[t]=[]),void 0===a[t][n]&&(a[t][n]=[]),a[t][n].some(function(t){return t.row===r&&t.col===o&&t.dataSource===e.dataSource&&t.targetSheetName===e.targetSheetName})||a[t][n].push({row:r,col:o,dataSource:e.dataSource,dependSheetName:e.dependSheetName,targetSheetName:i.name()})}))},{copyPasteHeaders:0})},n.prototype.copyMoveTag=function(){var r,t,e,r=this.isMove,t,e;this.Ope(function(t,e,n,i){var i=t.getTag(e,n,i);return!A(i)&&r&&t.setTag(e,n,B),i},function(t,e,n,i,r){t.setTag(e,n,i,r)})},n.prototype.copyMoveBindingPath=function(){var t,a,s,u,e,n,i,r,o,c,t,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,t=this,a=t.src,s=t.srcRow,u=t.srcColumn,e=t.dest,n=t.destRow,i=t.destColumn,r=t.copyRowCount,o=t.copyColumnCount,c=t.isMove,t=this.options.ignorePasteSkipInvisibleRange,f=[],l=[],h={},d={},v=!t&&e.o5();if(v){for(g=r,m=o,g+=e.lT(n,g,!0),m+=e.lT(i,m),p=e.getRowCount(),S=e.getColumnCount(),b=w=0;w<g&&w+n<p;w++)0!==e.getRowHeight(n+w)&&(h[b]=w,b++);for(y=C=0;C<m&&C+i<S;C++)0!==e.getColumnWidth(i+C)&&(d[y]=C,y++)}return this.Ope(M=function(t,e,n){var i,r,o,i=t.getBindingPath&&t.getBindingPath(e,n);return i&&(r=e-Q(0,s),o=n-Q(0,u),v&&(r=h[r],o=d[o]),f.push({row:r,col:o,value:t.getValue(e,n)}),c)&&(a.setTemplateCell?a.setTemplateCell(e,n,J):a.setBindingPath&&a.setBindingPath(e,n,J)),i},k=function(t,e,n,i){A(i)&&(!t.getBindingPath||A(t.getBindingPath(e,n)))||(t.setTemplateCell?t.setTemplateCell(e,n,B):t.setBindingPath&&t.setBindingPath(e,n,B),l.push({sheet:t,r:e,c:n,value:i}))},{copyPasteHeaders:0}),{savedValues:f,bindingPathInfos:l}},n.prototype.copyMoveDefaultValue=function(){var t,u,c,f,l,h,d,v,g,m,e,n,t=this,u=t.src,c=t.srcRow,f=t.srcColumn,l=t.dest,h=t.destRow,d=t.destColumn,v=t.isMove,g={},m={},e,n;return this.Ope(function(t,e,n,i){var r,o,a,o,s,u,r,r=t.Ut,o=r.yle(i),a=o.getValue(e,n),o=o.getExpression(e,n),s=e-c,u=n-f;return g[s]||(g[s]={}),v&&!m[s]&&(m[s]={}),v&&(A(a)||r.setDefaultValue(e,n,J,i,Y.DefaultChangeValueType.Value,!0),A(o)||r.setDefaultValue(e,n,J,i,Y.DefaultChangeValueType.Expression,J,!0)),o?(r=t.getValueIgnoreDefault(e,n,i),A(r)?J:(g[s][u]=1,v&&(m[s][u]={expr:o}),o)):(g[s][u]=0,a)},function(t,e,n,i,r){var t,o,a,s,o,o,t=t.Ut,o=t.yle(r),a=e-h,s=n-d;A(i)&&A(o.getValue(e,n))||(o=g[a][s],W&&1===o?v?(o=m[a][s])&&(o.destRow=e,o.destCol=n):(0,C.copyDefaultFormula)(u,l,e,n,i):t.setDefaultValue(e,n,i,r,Y.DefaultChangeValueType.Value))}),m},n.prototype.copyMoveHyperlink=function(){var r,t,e,r=this.isMove,t,e;this.Ope(function(t,e,n,i){var i=t.getHyperlink&&t.getHyperlink(e,n,i);return!A(i)&&r&&t.setHyperlink&&t.setHyperlink(e,n,B),i},function(t,e,n,i,r){t.setHyperlink&&t.setHyperlink(e,n,i,r)})},n.prototype.copyMoveAltText=function(){var r,t,e,r=this.isMove,t,e;this.Ope(function(t,e,n,i){var i=t.getAltText(e,n,i);return!A(i)&&r&&t.setAltText(e,n,B),i},function(t,e,n,i,r){t.setAltText(e,n,i,r)})},n.prototype.copyCellLink=function(){var t,e,i,r,o,a,s,n,u,e,i=!(this.src===this.dest&&this.src.name()===this.dest.name())?(0,_.i2e)(this.src.name())+"!":"",r=1===(null==(t=this.src.parent)?void 0:t.options.referenceStyle),o=(0,_.rangeToFormula)(new _.Range(this.srcRow,this.srcColumn,1,1),this.destRow,this.destColumn,15,!0),a=1===this.copyRowCount&&1===this.copyColumnCount,s=(0,_.rangeToFormula)(new _.Range(this.srcRow,this.srcColumn,1,1),0,0,0,r),n,u;this.Ope(function(t,e,n){return a?i+s:r?i+o:i+(0,_.rangeToFormula)(new _.Range(e,n,1,1),0,0,15)},function(t,e,n,i){t.setFormula(e,n,i)})},n.prototype.copyColumnWidth=function(){var r,t,e,t,e;this.Ope(function(t,e,n){return t.getColumnWidth(n)},function(t,e,n,i){if(A(r))r=e;else if(r!==e)return;t.setColumnWidth(n,i)})},et=n,t.staticMembers={copyTo:function(t,e,n,i,r,o,a,s,u,c,f,l,h,d,v,g){var m;U(t,e,n,i,r,o,a,s,!1,{copyPasteHeaders:f,ignorePasteSkipInvisibleRange:l,treatRichTextAsNormal:h,ignoreFilteredOutRow:c,copyToOption:u,pasteSpecialOptions:d,needHideFormula:g},v)},moveTo:function(t,e,n,i,r,o,a,s,u,c,f,l,h){var d,v,d=3;U(t,e,n,i,r,o,a,s,!0,v={copyToOption:u,skipRangeCheck:h,ignorePasteSkipInvisibleRange:f,treatRichTextAsNormal:l,ignoreSheet:c,copyPasteHeaders:d=t===i&&t.NMi?0:d})}}},"./dist/core/worksheet/worksheet-ui.js":function(t,e,c){"use strict";var n,u,i,m,r,o,a,s,f,l,h,g,d,a,v;function p(t){return"number"==typeof t}function S(t){return"string"==typeof t}function w(t){return parseInt(t,10)}function b(t){return Math.abs(t)}function C(t,e){var u=t,c=e;return function(t){var e,n,i,r,o,a,s,e=this,n=e.sheet,i=e.row,r=e.col,o=e.sheetArea;if(0===arguments.length)return u.call(n,i,r,o);if(0<=i&&0<=r)for(a=i;a<i+e.rowCount;a++)for(s=r;s<r+e.colCount;s++)y(n,a,s,o)&&c.call(n,a,s,t,o);return e}}function y(t,e,n,i){var r,t,r=t.getRowCount(i),t=t.getColumnCount(i);return n<0&&0<=e&&e<r||e<0&&0<=n&&n<t||0<=e&&e<r&&0<=n&&n<t||-1===e&&-1===n}function M(t,e,n,i,r,o){var a,s;y(t,e,n,o)&&("string"==typeof(a=(a=t.vI(e,n,o))||new u.Style)&&(s=a,(a=new u.Style).parentName=s),"font"!==i&&"fontFamily"!==i||k(t,a,i,r),a[i]=r,t.setStyle(e,n,a,o))}function k(t,e,n,i){var r,o;d(e.themeFont)||(r=null==e?void 0:e.fontFamily,o=i,(o="font"===n?f.W.vpe(i).fontFamily:o)!==r&&(e.themeFont=h))}function T(t,e,n,i,r,o){var a=this;e<0&&(e=i=-1),n<0&&(n=r=-1),a.sheet=t,a.row=e,a.rowCount=d(i)?1:i,a.col=n,a.colCount=d(r)?1:r,a.sheetArea=d(o)?3:o}function x(t){return t=(t=t.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}function G(t){var t,e,t,n,i,r,r,o,a,s,e,u,n,c,f,l,h,d,v,t=t.split(":"),e=t[0],t=t[1],n=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(Number(e))){if(o=(r=e.match(n))[3])return g;i=r[1],r=r[2]}else r=e;if(e&&!t){if(i&&r)return[a=B(r),s=I(i),1,1]}else if(e&&t){if(u=e=void 0,isNaN(Number(t))){if(o=(n=t.match(n))[3])return g;e=n[1],u=n[2]}else u=t;if(!i&&r&&!e&&u)return c=B(r),f=B(u),[a=Math.min(c,f),-1,l=b(c-f)+1,-1];if(i&&!r&&e&&!u)return h=I(i),d=I(e),[-1,s=Math.min(h,d),-1,v=b(h-d)+1];if(i&&r&&e&&u)return c=B(r),f=B(u),h=I(i),d=I(e),a=Math.min(c,f),l=b(c-f)+1,[a,s=Math.min(h,d),l,v=b(h-d)+1]}return g}function B(t){return w(t)-1}function I(t){for(var e,n,i,r,o,a,e=64,n=26,i=0,r=t.length,o=0;o<r;o++)a=t[o].charCodeAt(0)-64,i+=Math.pow(26,r-o-1)*a;return i-1}Object.defineProperty(e,"__esModule",{value:!0}),e.$B=e.tL=e.CellRange=void 0,n=c("./dist/core/worksheet/worksheet.js"),u=c("./dist/core/worksheet/style.js"),i=c("./dist/core/util/domUtil.js"),m=c("./dist/core/util/common.js"),r=c("Common"),o=c("./dist/core/core.enum.js"),a=c("CalcEngine"),s=c("./dist/core/worksheet/clipboardhelper.js"),f=c("./dist/core/worksheet/stylehelper.js"),l=!!a,h=void 0,g=null,d=r.Common.lt.ht,a=n.Worksheet.prototype,T.prototype.tag=function(t){var e=this,n=e.sheet,i=e.row,r=e.col,o=e.rowCount,a=e.colCount,s=e.sheetArea,u,c;if(0===arguments.length)return n.getTag(i,r,s);if(0<=i&&0<=r)for(u=i;u<i+o;u++)for(c=r;c<r+a;c++)n.setTag(u,c,t,s);else if(0<=i)for(u=i;u<i+o;u++)n.setTag(u,-1,t,s);else if(0<=r)for(c=r;c<r+a;c++)n.setTag(-1,c,t,s);return e},T.prototype.altText=function(t){var e=this,n=e.sheet,i=e.row,r=e.col,o=e.rowCount,a=e.colCount,s=e.sheetArea,u,c;if(0===arguments.length)return n.getAltText(i,r,s);if(0<=i&&0<=r)for(u=i;u<i+o;u++)for(c=r;c<r+a;c++)n.setAltText(u,c,t,s);return e},T.prototype.width=function(t){var e,n,i,r,o,a,e=this,n=e.sheet,i=e.row,r=e.col,o=e.sheetArea;if(0!==arguments.length){if(i<0)for(a=0;a<e.colCount;a++)n.setColumnWidth(a+r,t,o);return e}if(i<0)return n.getColumnWidth(r,o)},T.prototype.height=function(t){var e,n,i,r,o,a,e=this,n=e.sheet,i=e.row,r=e.col,o=e.sheetArea;if(0!==arguments.length){if(r<0)for(a=0;a<e.rowCount;a++)n.setRowHeight(a+i,t,o);return e}if(r<0)return n.getRowHeight(i,o)},T.prototype.visible=function(t){var e,n,i,r,o,a,s,e=this,n=e.sheet,i=e.row,r=e.col,o=e.sheetArea;if(0===arguments.length)return r<0&&0<=i?n.getRowVisible(i,o):0<=r&&i<0?n.getColumnVisible(r,o):void 0;if(r<0&&0<=i)for(a=0;a<e.rowCount;a++)n.setRowVisible(a+i,t,o);else if(0<=r&&i<0)for(s=0;s<e.colCount;s++)n.setColumnVisible(s+r,t,o);return e},T.prototype.resizable=function(t){var e,n,i,r,o,a,s,e=this,n=e.sheet,i=e.row,r=e.col,o=e.sheetArea;if(0===arguments.length)return r<0&&0<=i?n.getRowResizable(i,o):0<=r&&i<0?n.getColumnResizable(r,o):void 0;if(r<0&&0<=i)for(a=0;a<e.rowCount;a++)n.setRowResizable(a+i,t,o);else if(0<=r&&i<0)for(s=0;s<e.colCount;s++)n.setColumnResizable(s+r,t,o);return e},T.prototype.l0=function(t){var e=this;return e.sheet.l0(e.row,e.col,t,e.sheetArea)},T.prototype.R5=function(n,i){var t=this,r=t.sheet,o=t.sheetArea;return t.nL(function(t,e){M(r,t,e,n,i,o)}),t},T.prototype.nL=function(t){var e,n,i,r,o,a,e=this,n=e.sheet,i=e.row+e.rowCount,r=e.col+e.colCount;if(n.suspendPaint(),0<=e.row&&0<=e.col)for(o=e.row;o<i;o++)for(a=e.col;a<r;a++)t.call(e,o,a);else if(0<=e.row)for(o=e.row;o<i;o++)t.call(e,o,-1);else if(0<=e.col)for(a=e.col;a<r;a++)t.call(e,-1,a);else-1===e.row&&-1===e.col&&-1===e.rowCount&&-1===e.colCount&&t.call(e,-1,-1);n.resumePaint()},T.prototype.setStyleName=function(n){var i=this;i.nL(function(t,e){i.sheet.setStyleName(t,e,n,i.sheetArea)})},T.prototype.setStyle=function(n){var i=this;i.nL(function(t,e){i.sheet.setStyle(t,e,n.clone(),i.sheetArea)})},T.prototype.clear=function(t){var e=this;e.sheet.clear(e.row,e.col,e.rowCount,e.colCount,e.sheetArea,t)},T.prototype.setBorder=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,n=this,i=n.sheet,r=n.sheetArea;i.suspendPaint();try{if(o=new m.Range(n.row,n.col,n.rowCount,n.colCount),s=(a=i.JS(o,r)).row,u=a.col,c=a.rowCount,f=a.colCount,h=l=void 0,d=e.all,v=e.outline,g=e.inside,e.left||d||v)for(l=0;l<c;l++)i.getCell(s+l,u,r).borderLeft(t);if(e.top||d||v)for(h=0;h<f;h++)i.getCell(s,u+h,r).borderTop(t);if(e.right||d||v)for(l=0;l<c;l++)i.getCell(s+l,u+f-1,r).borderRight(t);if(e.bottom||d||v)for(h=0;h<f;h++)i.getCell(s+c-1,u+h,r).borderBottom(t);if(e.diagonalUp)for(l=0;l<c;l++)for(h=0;h<f;h++)i.getCell(s+l,u+h,r).diagonalUp(t);if(e.diagonalDown)for(l=0;l<c;l++)for(h=0;h<f;h++)i.getCell(s+l,u+h,r).diagonalDown(t);if(e.innerHorizontal||d||g)for(l=0;l<c-1;l++)for(h=0;h<f;h++)i.getCell(s+l,u+h,r).borderBottom(t),i.getCell(s+l+1,u+h,r).borderTop(t);if(e.innerVertical||d||g)for(h=0;h<f-1;h++)for(l=0;l<c;l++)i.getCell(s+l,u+h,r).borderRight(t),i.getCell(s+l,u+h+1,r).borderLeft(t)}finally{i.resumePaint()}},T.prototype.toHtml=function(t,e){void 0===t&&(t=o.HeaderOptions.noHeaders),void 0===e&&(e=!0);var n=this;return n.sheetArea===o.SheetArea.corner?"":s.yM.KS(n.sheet,t,n.row,n.rowCount,n.col,n.colCount,n.sheetArea,e,[],[],!0,!0,e,!0)},T.p0=C,v=T,(e.CellRange=v).prototype.value=C(a.getValue,a.setValue),v.prototype.text=C(a.getText,a.setText),v.prototype.D5=C(function(t,e){return l&&this.getFormula(t,e)},function(t,e,n,i){l&&this.setFormula(t,e,n,i)}),v.prototype.formula=function(t,e){if(!e)return 0===arguments.length?this.D5():this.D5(t);l&&this.sheet.eL(this.row,this.col,this.rowCount,this.colCount,t)},v.prototype.defaultValue=C(a.getDefaultValue,a.setDefaultValue),v.prototype.styleName=C(a.getStyleName,a.setStyleName),i.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","hidden","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation","mask","fontStyle","fontWeight","fontSize","fontFamily","textDirection"],function(t,e){v.prototype[e]=function(t){return 0===arguments.length?this.l0(e):this.R5(e,t)}}),e.tL=G,e.$B=I,i.GC$.extend(a,{getRange:function(){var t,e,n,i,r,o,a,s,u,r,a,t=arguments[0];if(S(t)){if(a=t.toUpperCase(),s=this.parent&&1===this.parent.options.referenceStyle)return g;if(o=arguments[1],1<(a=x(a)).split(",").length)return g;if(l){if(!(r=(u=c("SheetsCalc")).formulaToRange(this,a,h,h,o)))return g;e=r.row,n=r.col,i=r.rowCount,r=r.colCount}else{if(!(a=G(a)))return g;e=a[0],n=a[1],i=a[2],r=a[3]}}else p(t)&&(e=t,n=arguments[1],i=arguments[2],r=arguments[3],o=arguments[4]);return new v(this,e,n,i,r,o)},getCell:function(t,e,n){return d(e)&&(e=-1),new v(this,t,e,1,1,n)}})},"./dist/core/worksheet/worksheet.js":function(n,t,o){"use strict";var i,e,x,r,a,T,E,l,s,c,P,w,p,G,f,S,y,z,W,J,R,Z,Q,X,q,$,h,tt,et,nt,d,it,rt,v,ot,M,at,g,B,N,H,U,b,st,k,I,ut,C,ct,ft,lt,u,ht,F,dt,vt,gt,mt,pt,St,wt,bt,Ct,yt,Mt,kt,e,m,Tt,xt,Gt,Bt,It,Pt,e,e;function Rt(t,e){var n,i,r,o,a,s,u,n=[],i=t.Ut.Fj();if(i)for(r in i)if(et(i,r)&&(o=i[r])&&(e||"n"!==o.rs||(a={row:+r,item:t.getDataItem&&t.getDataItem(+r)},n.push(a)),e)&&"e"===o.rs)for(s in o)if(!g(s)&&(u=o[s])){(a={row:+r,item:t.getDataItem&&t.getDataItem(+r)}).originalItem=o.originalItem,n.push(a);break}return n}function _(t,e,n,i){for(var r,o,r=0,o=e;o<=n;o++)r+=t.Kt(o,i);return r}function A(t,e,n,i){for(var r,o,r=0,o=e;o<=n;o++)r+=t.Gt(o,i);return r}function Nt(t,e,n){var i,r,o,i=0,r=t.Mf;if(r&&r.PCn)for(o=e;o<=n;o++)i=(i+=r.PCn(o))+r.PCn(o,!0);return i}function L(t,e){return t.getColumnCount(e)}function D(t,e){return t.getRowCount(e)}function j(t){return t.frozenTrailingColumnCount()}function O(t){return t.frozenTrailingRowCount()}function Et(t){return t.Ny}function Ht(t){return t.Vy}function V(t){return t.frozenColumnCount()}function Y(t){return t.frozenRowCount()}function Ut(t){return t.yve}function Ft(t){return t.bve}function _t(t,e){return e===P.SheetArea.colHeader&&At(t.options)?t.options.addColumnButtonOption:e===P.SheetArea.rowHeader&&Dt(t.options)?t.options.addRowButtonOption:B}function At(t){return t.colHeaderVisible&&t.addColumnButtonOption&&t.addColumnButtonOption.visible}function Lt(t){var e,t,e=0;return e="number"==typeof t.options.addColumnButtonOption.width?t.options.addColumnButtonOption.width:b(t.defaults.colWidth),1!==(t=t.zoom())&&(e*=t),st(e)}function Dt(t){return t.rowHeaderVisible&&t.addRowButtonOption&&t.addRowButtonOption.visible}function jt(t){var e,t,e=0;return e="number"==typeof t.options.addRowButtonOption.height?t.options.addRowButtonOption.height:b(t.defaults.rowHeight),1!==(t=t.zoom())&&(e*=t),st(e)}function Ot(t){return t.options.addColumnButtonOption&&t.options.addRowButtonOption.command}function Vt(t){return t.options.addColumnButtonOption&&t.options.addColumnButtonOption.command}function Yt(t){return R(t)||t===P.SheetArea.viewport||t===P.SheetArea.rowHeader?P.SheetArea.viewport:t===P.SheetArea.colHeader?t:P.SheetArea.corner}function Kt(t){return R(t)||t===P.SheetArea.viewport||t===P.SheetArea.colHeader?P.SheetArea.viewport:t===P.SheetArea.rowHeader?t:P.SheetArea.corner}function zt(t,e){var t,e,t=x.util._0(t.font),e=x.util._0(e.font);return t.fontStyle+" "+t.fontWeight+" "+e.fontSize+" "+e.fontFamily}function Wt(t,n,i){Object.defineProperty(t,n,{get:function(){return this["_"+n]},set:function(t){var e=this["_"+n];e!==t&&(this["_"+n]=t,i)&&i(n,t,e)}})}function Jt(t,e,n){t["_"+e]=n}function Zt(t,e,n,i){return{row:e,col:n,newValue:t.getValue(e,n),oldValue:i}}function Qt(t){var e,n,i,r;if(t)for(n=(e=t.sheets).length,r=0;r<n;r++)!0===(i=e[r]).iL&&delete i.iL}function Xt(t){if(!tt(t))for(var e in t)if(!R(t[e])&&!tt(t[e]))return;return 1}function qt(t,e,n,i){var r,o,n,r=n.formatter;return"General"===(r=r&&"General"!==r?r:n._autoFormatter)&&(r=N),n=n.quotePrefix,e=(e=t.format(e,r,o={},{quotePrefix:n,sheet:i}))&&"string"==typeof e?e.replace(/\r\n?/g,"\n"):e}function K(t){this.canClone=!0;var i=this;i._id=K._ID,K._ID++,i.options=q(Bt,function(t,e,n){i.Ob(t,e,n)}),i.Hc(t),i.Vp=new a.Tasks(function(){return this.tasks.pop()},function(){var t=i.parent;return t&&t.ib.eb||i.rt.rb||i.rt.ob||i.rt.ab})}function $t(t,e,n,i,r){var r;-1===e&&-1===n||3===(r=R(r)?3:r)&&(r=t.tables&&t.tables.find(e,n))&&r.oL&&e===r.footerIndex()&&It.et(t,"composeTableFooterList",{table:r,row:e,col:n,style:i})}function te(t,e){var n,i;try{(n=w.Formatter&&w.Formatter.GeneralFormatter)&&typeof t===C&&(t=x.Be.Ue(t))}catch(t){}if((null!=t&&t.hasFormattedColor&&t.hasFormattedColor()||w.Formatter&&t instanceof w.Formatter.FormatterBase)&&(i={conditionalForeColor:B},t.format(e,i),i.conditionalForeColor))return i.conditionalForeColor}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n,i,r,n=1,i=arguments.length;n<i;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.Worksheet=t.AHe=t.InvalidType=t.ClearPendingChangeType=t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=void 0,e=o("./dist/core/core.ns.js"),x=o("./dist/core/util/common.js"),r=o("./dist/core/util/imageLoader.js"),a=o("./dist/core/util/tasks.js"),T=o("./dist/core/worksheet/style.js"),E=o("./dist/core/worksheet/worksheet-model.js"),l=o("./dist/core/util/domUtil.js"),s=o("./dist/core/celltype/textcelltype.js"),c=o("./dist/core/celltype/headercelltype.js"),P=o("./dist/core/core.enum.js"),w=o("Common"),p=o("CalcEngine"),G=!!p,S=o("./dist/core/util/theme.js"),y=o("./dist/core/worksheet/stylehelper.js"),z=o("./dist/core/worksheet/attachmentManager/attachmentsManager.js"),W=x.util.g0,J=x.util.St,R=w.Common.lt.ht,Z=w.Common.lt.q8,Q=x.util.En,X=x.util.p0,q=x.util.b0,$=x.util.x0,h=l.GC$.each,tt=l.GC$.isEmptyObject,et=w.Common.kh,nt=x.util.Z0,d=x.util.V0,it=new RegExp("^\\d*(\\.\\d+)?\\*$"),rt=new Date(1899,11,30).getTime(),v=w.Common.zf,ot=document,M=parseInt,at=parseFloat,g=isNaN,B=null,N=void 0,H=Math.min,U=Math.max,b=Math.floor,st=Math.ceil,k=Math.abs,I=Math.round,ut="undefined",C="string",ct="width",ft="height",lt="black",u="tag",ht="altText",F="onLayoutChanged",dt="beforeLayoutChanged",vt="onPaintSuspend",gt="isVisible",mt="starSize",pt="resizable",St="canAddingSpan",wt=".gcSheet",bt=".gcSheetInternal",Ct="columnHeaderFitMode",yt="gc.spread.contextMenu.insertRows",Mt="gc.spread.contextMenu.insertColumns",t.MAX_ROW_COUNT=1048576,t.MAX_COLUMN_COUNT=16384,kt={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},e=new w.Common.ResourceManager(e.SR,"Sheets"),m=e.getResource.bind(e),Tt=x.UsedRangeUtil.vh,(e=xt=t.ClearPendingChangeType||(t.ClearPendingChangeType={}))[e.dirty=1]="dirty",e[e.insert=2]="insert",e[e.delete=4]="delete",(e=Gt=t.InvalidType||(t.InvalidType={}))[e.setFormula=0]="setFormula",e[e.copyPaste=1]="copyPaste",e[e.dragFill=2]="dragFill",e[e.dragDrop=3]="dragDrop",e[e.changePartOfArrayFormula=4]="changePartOfArrayFormula",e[e.changeSheetName=5]="changeSheetName",e[e.table=6]="table",e[e.hideSheet=7]="hideSheet",e[e.pivotTable=8]="pivotTable",e[e.PTOverlapPT=9]="PTOverlapPT",Bt={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:lt,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:B,selectionBackColor:B,selectionBorderColor:B,allowCellOverflow:!0,showFormulas:!1,showZeros:!0,isProtected:!1,protectionOptions:{},gridline:{},reversalTrailingResizeOrder:!1,keepUnknownFormulas:!1,addColumnButtonOption:{visible:!1,width:B,command:Mt,style:B,tooltip:B},addRowButtonOption:{visible:!1,height:B,command:yt,style:B,tooltip:B},rightToLeft:!1,sheetAreaOffset:{left:0,top:0}},t.AHe=qt,K.prototype.sortRange=function(t,e,n,i,r,o,a,s,u){return!1},K.prototype.Ob=function(t,n,e){var i,r,o,a,s,u,c,f,l,h,i=this,r=i.parent;switch(t){case"allowCellOverflow":case"showFormulas":case"showZeros":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":case"reversalTrailingResizeOrder":i.zw();break;case"rightToLeft":r&&(r.ZVe=!0,r.jM(),r._An(n),r.sC(),r.iM()),i.zw(),K.et(i,"onRightToLeftChanged",{value:n,oldValue:e});break;case"sheetAreaOffset":o=function(t,e){e<0&&(i.options.sheetAreaOffset[t]=0),i.zw()},a=i.options.sheetAreaOffset,["left","top"].forEach(function(t){var e=n[t];Wt(a,t,o),a[t]=e});break;case"gridline":s=function(){i.zw()},u=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(t){var e=n[t];Wt(u,t,s),u[t]=e});break;case"isProtected":n&&r&&r.undoManager().aL(function(t){return t.sheetId!==i._id}),i.uL(),K.et(i,"onProtectChanged"),i.zw();break;case"protectionOptions":i.uL(),K.et(i,"onProtectChanged");break;case"sheetTabColor":r&&r.Xg();break;case"addRowButtonOption":c=function(){i.n9e=B,i.zw()},f=i.options.addRowButtonOption,["visible","command","height","style","tooltip"].forEach(function(t){var e;R(n)||(e=n[t],Wt(f,t,c),Jt(f,t,e))}),i.n9e=B,i.zw();break;case"addColumnButtonOption":l=function(){i.e9e=B,i.zw()},h=i.options.addColumnButtonOption,["visible","command","width","style","tooltip"].forEach(function(t){var e;R(n)||(e=n[t],Wt(h,t,l),Jt(h,t,e))}),i.e9e=B,i.zw();break;case"keepUnknownFormulas":i.options.keepUnknownFormulas=n}i.ki(x.Events.SheetOptionsChangedInternal,{propertyName:t,value:n})},K.prototype.getUsedRange=function(t){var e,e,n,i,r,o,a,s,e,e,e,n;return!R(t)&&(r=(i=(n=this).Ut).getUsedRange(t)||{},o=n.getRowCount(),a=n.getColumnCount(),t&P.UsedRangeType.formula&&G&&(e=(s=n.b3()).usedRange,R(e)||Tt(r,e.getUsedRange()),e=n.Uw&&n.Uw(3))&&e.t8&&Tt(r,e.t8.Fme()),Tt(r,null==(e=n.rowOutlines)?void 0:e.getUsedRange(t)),Tt(r,null==(e=n.columnOutlines)?void 0:e.getUsedRange(t)),K.et(n,"getUsedRange",{type:t,range:r}),r)&&0<Object.keys(r).length?(r.minRow<0&&(r.minRow=0,r.maxRow=o-1),r.minCol<0&&(r.minCol=0,r.maxCol=a-1),r.maxRow>=o&&r.maxRow!==1/0&&(r.maxRow=o-1),r.maxCol>=a&&r.maxCol!==1/0&&(r.maxCol=a-1),e=r.maxRow===1/0?-1:r.maxRow-r.minRow+1,n=r.maxCol===1/0?-1:r.maxCol-r.minCol+1,new x.Range(r.minRow,r.minCol,e,n)):B},K.prototype.name=function(t){var e=this,n=e.parent;if(0===arguments.length)return e.Ut?e.Ut.getName():"";if($(t,n?n.sheets:null,e))return e.ub(t),n&&n.Xg(),e;throw m().Exp_NotSupported},K.prototype.isSelected=function(t){return this.b2(t)},K.prototype.b2=function(t,e){var n,i,r,o,a,s,n=this,i=n.parent,r=!!n.Ut&&n.Ut.Xj();return R(t)?r:(t!==r&&(o=n.name(),a=i&&i.Ese(o),s=void 0,e&&(s={oldValue:r,newValue:t,sheetName:o,propertyName:"isSelected",cancel:!1,sheetIndex:a,sheetPosition:i&&i.getSheetPosition(o)},i)&&i.ki(x.Events.SheetChanging,s),!e||s&&!1===s.cancel)&&(n.Ut.qj(t),i&&i.w2&&i.w2.repaint(),e)&&i&&i.ki(x.Events.SheetChanged,{oldValue:r,newValue:t,sheetName:o,propertyName:"isSelected",sheetIndex:a,sheetPosition:i&&i.getSheetPosition(o)}),n)},K.prototype.Mtt=function(t){this.Ut.undo(t)},K.prototype.VAe=function(){this.Ut.startTransaction()},K.prototype.zAe=function(){return this.Ut.endTransaction()},K.prototype.ub=function(t,e){var n,i,r,o,n=this,i=n.name(),r=n.parent;e||K.et(n,"beforeSetName",{oldName:i,newName:t}),n.Ut.do("setName",t),r&&(o=r.sheetTabStyles.O2e[i],i!==t)&&o&&(r.sheetTabStyles.O2e[t]=o,r.sheetTabStyles.clear([i])),e||K.et(n,"setName",{oldName:i,newName:t})},K.prototype.addRows=function(t,e,n){this.ffe(t,e,n)},K.prototype.ffe=function(t,e,n,i){var r,o,a,s,u,c,f;if((n=Yt(o=n=void 0===n?P.SheetArea.viewport:n))!==P.SheetArea.corner&&!(e<=0)){s=D(a=this,n),(t<0||s<t)&&(t=s),a.suspendPaint();try{u="addRows",a.kj(t,o,u,e,s)&&(c=null==(r=null==i?void 0:i.clearUndoNotInCommand)||r,0===a.Ut.P8&&c&&a.parent&&a.parent.Wp.clear(),a.sL(!1,n),f={changeType:"addingRows",row:t,rowCount:e,canAdd:!0,sheetArea:n},K.et(a,F,f),f.canAdd)&&(R(f.newRow)||(t=f.newRow),this.Ut.do("addRows",t,e,N,N,n),a.Ww=!0,K.et(a,F,{changeType:u,row:t,oldValue:s,rowCount:e,rowExpand:null==i?void 0:i.rowExpand,ignoreExpand:null==i?void 0:i.ignoreExpand,sheetArea:n}),n===P.SheetArea.viewport&&a.tables&&a.tables.cL(!0,t),a.dj(t,o,u,e,s))}finally{a.sL(!0,n),a.resumePaint()}}},K.prototype.sL=function(t,e){var n,i,r;(e=void 0===e?P.SheetArea.viewport:e)===P.SheetArea.viewport&&(i=(n=this).ui,r=n.ci,n.Ut.setCellState(i,r,P.CellStatesType.active,t,e))},K.prototype.deleteRows=function(t,e,n){void 0===n&&(n=P.SheetArea.viewport),this.i9e(t,e,n)},K.prototype.i9e=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,g,m;if(void 0===i&&(i=!0),(n=Yt(r=n=void 0===n?P.SheetArea.viewport:n))!==P.SheetArea.corner&&(a=D(o=this,n),!(t<0||a<=t||e<=0))){o.suspendPaint();try{if(s="deleteRows",o.kj(t,r,s,e,a)&&(0===o.Ut.P8&&i&&o.parent&&o.parent.Wp.clear(),o.sL(!1,n),u={changeType:"deletingRows",row:t,rowCount:e,canDelete:!0,sheetArea:n},K.et(o,F,u),u.canDelete)){if(n===P.SheetArea.viewport&&o._j(t,e,0,this.getColumnCount()),o.Ut.do("deleteRows",t,e,N,n),0<=(c=o.Tb)){for(f=-1,l=Y(o),h=c;l<=h;h--)if(o.getRowVisible(h)&&0<o.Gt(h)){f=h;break}c!==(f=-1===f?0:f)&&o.$A(f)}d=D(o),o.getActiveRowIndex()>=d&&(v=d-1,g=o.getActiveColumnIndex(),(m=o.getSpan(v,g))&&(v=m.row,g=m.col),o.setActiveCell(v,g)),o.Ww=!0,K.et(o,F,{changeType:s,row:t,oldValue:a,rowCount:e,sheetArea:n}),n===P.SheetArea.viewport&&o.tables&&o.tables.cL(!0,t),o.dj(t,r,s,e,a)}}finally{o.sL(!0,n),o.resumePaint()}}},K.prototype.addColumns=function(t,e,n){void 0===n&&(n=P.SheetArea.viewport),this.r9e(t,e,n)},K.prototype.r9e=function(t,e,n,i){var r,o,a,s,u,r,r;(n=Kt(o=n=void 0===n?P.SheetArea.viewport:n))===P.SheetArea.corner||e<=0||(s=L(a=this,n),a.Dj(t=t<0||s<t?s:t,o,u="addColumns",e,s)&&(r=null==(r=null==i?void 0:i.clearUndoNotInCommand)||r,0===a.Ut.P8&&r&&a.parent&&a.parent.Wp.clear(),K.et(a,F,r={changeType:"addingColumns",col:t,colCount:e,canAdd:!0,sheetArea:n}),r.canAdd)&&(a.sL(!1,n),a.Ut.do("addColumns",t,e,N,n),a.Zw=!0,K.et(a,F,{changeType:u,col:t,oldValue:s,colCount:e,sheetArea:n,ignoreExpand:null==i?void 0:i.ignoreExpand}),n===P.SheetArea.viewport&&a.tables&&a.tables.cL(!1,t),a.vj(t,o,u,e,s),a.sL(!0,n),a.zw()))},K.prototype.deleteColumns=function(t,e,n){void 0===n&&(n=P.SheetArea.viewport),this.o9e(t,e,n)},K.prototype.o9e=function(t,e,n,i){var r,o,a,s,i,i,u,c,f,i,l,i,h;if(void 0===i&&(i=!0),(n=Kt(r=n=void 0===n?P.SheetArea.viewport:n))!==P.SheetArea.corner&&(a=L(o=this,n),!(t<0||a<=t||e<=0))&&o.Dj(t,r,s="deleteColumns",e,a)&&(0===o.Ut.P8&&i&&o.parent&&o.parent.Wp.clear(),K.et(o,F,i={changeType:"deletingColumns",col:t,colCount:e,canDelete:!0,sheetArea:n}),i.canDelete)){if(o.sL(!1,n),n===P.SheetArea.viewport&&o._j(0,this.getRowCount(),t,e),o.Ut.do("deleteColumns",t,e,N,n),0<=(i=o.Ab)){for(u=-1,c=V(o),f=i;c<=f;f--)if(o.getColumnVisible(f)&&0<o.nn(f)){u=f;break}i!==(u=-1===u?0:u)&&o.o9(u)}i=L(o),o.getActiveColumnIndex()>=i&&(l=o.getActiveRowIndex(),(h=o.getSpan(l,i=i-1))&&(l=h.row,i=h.col),o.setActiveCell(l,i)),o.Zw=!0,K.et(o,F,{changeType:s,col:t,oldValue:a,colCount:e,sheetArea:n}),n===P.SheetArea.viewport&&o.tables&&o.tables.cL(!1,t),o.vj(t,r,s,e,a),o.sL(!0,n),o.zw()}},K.prototype.frozenColumnCount=function(t,e){var n=this;if(0===arguments.length)return n.fp;n.ame(t,e)},K.prototype.ame=function(t,e,n){var i,r,o,i=this;0<=t&&(!R(e)&&"number"==typeof e||(e=0),r=i.yve,i.fp=t,0<e?(o=i.getColumnCount(),n||H(e,t)<o?i.yve=e<t-1?e:t-1:i.yve=o-1):i.yve=0,i.Ab<t?i.Ab=t:""!==t&&0!==t&&null!==t||(i.Ab=r||0),i.Zw=!0,i.zw())},K.prototype.frozenRowCount=function(t,e){var n=this;if(0===arguments.length)return n.ap;n.ome(t,e)},K.prototype.ome=function(t,e,n){var i,r,o,i=this;0<=t&&(!R(e)&&"number"==typeof e||(e=0),r=i.bve,i.ap=t,0<e?(o=i.getRowCount(),n||H(e,t)<o?i.bve=e<t-1?e:t-1:i.bve=o-1):i.bve=0,i.Tb<t?i.Tb=t:""!==t&&0!==t&&null!==t||(i.Tb=r||0),i.Ww=!0,i.zw())},K.prototype.wve=function(t){void 0===t&&(t=0);var e,n=Ut(this),i;return 0<n?n:t},K.prototype.Mve=function(t){void 0===t&&(t=0);var e,n=Ft(this),i;return 0<n?n:t},K.prototype.frozenTrailingRowCount=function(t,e){var n=this;return 0===arguments.length?n.fL:(0<=t&&(R(e)&&(e=!0),n.fL=t,n.Ny=e,n.Ww=!0,n.zw()),n)},K.prototype.frozenTrailingColumnCount=function(t,e){var n=this;return 0===arguments.length?n.lL:(0<=t&&(R(e)&&(e=!0),n.lL=t,n.Vy=e,n.Zw=!0,n.zw()),n)},K.prototype.getFrozenTrailingState=function(t){var e=this;return t?e.Ny:e.Vy},K.prototype.getFrozenTopLeftIndex=function(t){var e=this;return t?e.bve:e.yve},K.prototype.a9e=function(){var t=this,e=t.isActualProtected()&&t.options.protectionOptions&&!t.options.protectionOptions.allowInsertRows,n=Ot(t);return e&&t.UTe(n)?B:n},K.prototype.UTe=function(t){return t===yt},K.prototype.u9e=function(){var t=this,e=t.isActualProtected()&&t.options.protectionOptions&&!t.options.protectionOptions.allowInsertColumns,n=Vt(t);return e&&t.HTe(n)?B:n},K.prototype.HTe=function(t){return t===Mt},K.prototype.PTe=function(t,e){var n,i,i,n=this;if(t===P.SheetArea.colHeader){if(!R(n.e9e))return n.e9e.clone(!0)}else{if(t!==P.SheetArea.rowHeader)return B;if(!R(n.n9e))return n.n9e.clone(!0)}return i=_t(n,t),R(i)?B:(i=i.style,i=R(i)?n.getActualStyle(N,N,t,!0,{notClone:!0}).clone(!0):i.clone(!0).v5(n.hl),e&&R(i.cellType)&&(i.cellType=n.$Ae(t)),t===P.SheetArea.colHeader?n.e9e=i:n.n9e=i,i.clone(!0))},K.prototype.Gy=function(t){var e,n,e=Ht(this),n=t.hL;return e?n+t.Uy:n},K.prototype.Sy=function(t){var e,n,e=Et(this),n=t.A6;return e?n+t.Ty:n},K.prototype.getRowCount=function(t){return 0===t?0:this.Ut.getRowCount(t)},K.prototype.getColumnCount=function(t){return 0===t?0:this.Ut.getColumnCount(t)},K.prototype.setRowCount=function(t,e,n){var i,n,n;R(e)&&(e=3),i=this,R(n)||(n=i.getUsedRange(n),R(n))||(-1===n.rowCount&&(n.rowCount=i.getRowCount(e)),t=Math.max(t,n.row+n.rowCount)),K.et(i,F,n={changeType:"settingRowCount",rowCount:t,sheetArea:e,canSet:!0}),n.canSet&&i.setRowCountCore(t,e)},K.prototype.setRowCountCore=function(t,e){var n,i;t=M(t,10),g(t)||(R(e)&&(e=3),i=(n=this).getRowCount(e),t<0)||t===i||(3===e||2===e?(n.Ut.do("setRowCount",t,e),Y(n)>t&&n.frozenRowCount(t)):1===e&&n.Ut.do("setRowCount",t,e),K.et(n,F,{changeType:"setRowCount",row:i,rowCount:t,sheetArea:e}),n.Ww=!0,n.ui>=t&&(3===e||2===e)&&n.setActiveCell(t-1,n.getActiveColumnIndex()),n.zw(),n.clearPendingChanges())},K.prototype.setColumnCount=function(t,e,n){var i,r,n;t=M(t,10),g(t)||(r=(i=this).getColumnCount(e),t<0)||t===r||(R(e)&&(e=3),R(n)||(n=i.getUsedRange(n),R(n))||(-1===n.colCount&&(n.colCount=i.getColumnCount(e)),t=Math.max(t,n.col+n.colCount)),3===e||1===e?(i.Ut.do("setColumnCount",t,e),V(i)>t&&i.frozenColumnCount(t)):2===e&&i.Ut.do("setColumnCount",t,e),K.et(i,F,{changeType:"setColumnCount",col:r,colCount:t,sheetArea:e}),i.Zw=!0,i.ci>=t&&(3===e||1===e)&&i.setActiveCell(i.getActiveRowIndex(),t-1),i.zw(),i.clearPendingChanges())},K.prototype.getFreeAreaRowCount=function(t){var e;return this.Ut.getFreeAreaRowCount(t)},K.prototype.getFreeAreaColumnCount=function(t){var e;return this.Ut.getFreeAreaColumnCount(t)},K.prototype.setFreeAreaRowCount=function(t,e){var n;this.Ut.setFreeAreaRowCount(t,e)},K.prototype.setFreeAreaColumnCount=function(t,e){var n;this.Ut.setFreeAreaColumnCount(t,e)},K.prototype.w8=function(t){var e,n,i,r,o;if(!R(t)&&(e=t.rows,i=!1,this.filterRowsVisibleInfo)){if(r=this.filterRowsVisibleInfo.rowsVisibleInfo||{},e&&0<e.length)for(o=0;o<e.length;o++)(n=e[o])&&n.isFilter&&(n.visible=!0,delete n.isFilter,i=!(r[o]=!1));i&&(this.filterRowsVisibleInfo.rowsVisibleInfo=r,this.filterRowsVisibleInfo.empty=!1)}},K.prototype.Oe=function(t,e,n,i){var r=this;return(f=f||o("SheetsCalc"))?r.dL(t,e,n,i):N},K.prototype.t0=function(t,e,n){var i,r,r,o,n,r,n,i=this;if(3===n)return i.options.showFormulas?(r=i.getFormula(t,e,3,!0))?"="!==r[0]?"="+r:r:(r=i.Uw&&i.Uw(n))&&r.t8.getAnchorInfo(t,e)?"":void 0:i.options.showZeros||!(0===(n=i.getValue(t,e,3))||n instanceof Date&&n.getTime()===rt)||(r=(r=i.getFormatter(t,e))||(n=i.getStyle(t,e))&&n._autoFormatter&&n._autoFormatter.formatCached)&&("="===r[0]||3<=r.split(";").length)?void 0:""},K.prototype.getText=function(t,e,n){var i,r,o;return R(n)&&(n=3),r=(i=this).t0(t,e,n),R(r)?(o=i.getValue(t,e,n),i.vL(t,e,o,n,!0)):r},K.prototype.setText=function(t,e,n,i){var r,o,a,a,s,u,c,r=this;R(i)&&(i=3),o=n,K.et(r,"settingText",a={value:n}),a=n=a.value,s=r.getCellType(t,e,i),u=r.getFormatter&&r.getFormatter(t,e,i),s&&u&&!J(u)&&(a=s.parse(o,u,c={sheet:r,row:t,col:e,sheetArea:i}),a=R(a)?n:a),r.YI(t,e,a,i),r.zw()},K.prototype.getValue=function(t,e,n,i,r){return this.mL(t,e,n,i,r=void 0===r?{}:r)},K.prototype.setValue=function(t,e,n,i,r){this.YI(t,e,n,i,r),this.Cle()},K.prototype.Ij=function(t,e,n,i){var r=this;!i&&G&&r.gL(t,e,n),r.Q1i&&r.Q1i(t,e,1,1,n),r.Lpe&&r.Lpe(t,e,n)},K.prototype.Tj=function(){var t=this.conditionalFormats;t&&t.dl()},K.prototype.Lj=function(t,a,s){var e,u;t&&t.parent&&t.parent.sheets&&(e=t.parent.sheets,u=t._id,e.forEach(function(o){var t=o.cameraShapes;t&&0<t.length&&t.forEach(function(t){var e,n,i,r;if(t.cameraImageCache&&(n=(e=t.JVV).ytV.AnV)&&(o._id===u||n.sheet&&n.sheet._id===u))for(i=0;i<a.length;i++){if(r=n.cellRange,void 0!==a[i].row&&void 0===a[i].col&&2===s&&a[i].row>=r.row&&a[i].row<r.row+r.rowCount){t.cameraImageCache=null,e.ytV.rtV&&e.mtV();break}if(void 0===a[i].row&&void 0!==a[i].col&&1===s&&a[i].col>=r.col&&a[i].col<r.col+r.colCount){t.cameraImageCache=null,e.ytV.rtV&&e.mtV();break}if(0===s){if(void 0===a[i].rowCount&&void 0===a[i].colCount&&r.contains(a[i].row,a[i].col)){t.cameraImageCache=null;break}if(void 0!==a[i].rowCount&&void 0!==a[i].colCount&&r.intersect(a[i].row,a[i].col,a[i].rowCount,a[i].colCount)){t.cameraImageCache=null;break}}}})}))},K.prototype.Sle=function(t,e,n,i){var r=this;r.Ij(t,e,n,i),r.Tj()},K.prototype.YI=function(t,e,n,i,r,o){var a,s,u,c,u;0===i||(R(i)&&(i=3),u=(s=(a=this).Ut).getRowCount(i),c=s.getColumnCount(i),t<0)||u<=t||e<0||c<=e||(n=nt(n),n=W(n),u=a.Uw&&a.Uw(i),!o&&u&&u.t8.Fgt(t,e),s.do("setValue",t,e,n,i),a.Sle(t,e,i,r))},K.prototype.Cle=function(){var t=this.parent,e=t&&t.getActiveSheet();(e&&!0===e.iL?e:this).zw(),Qt(t)},K.prototype.getValueIgnoreDefault=function(t,e,n,i,r){var o,t,o=this.Ut;return o.wle=!0,t=this.mL(t,e,n,i,{realValue:r}),delete o.wle,t},K.prototype.getDefaultValue=function(t,e){return d(this.Ut.getDefaultValue(t,e))},K.prototype.getDefaultValueByType=function(t,e,n,i){return d(this.Ut.getDefaultValue(t,e,n,i))},K.prototype.setDefaultValue=function(t,e,n){var i=this;i.Ut.setDefaultValue(t,e,n),i.Sle(t,e,3,!0),i.Cle()},K.prototype.Il=function(t,e,n,i,r){var o=this,i,i=o.getActualStyle(t,e,n,i,r=void 0===r?{}:r);return $t(o,t,e,i,n),i},K.prototype.getActualStyle=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,h,d,v,g,m,d,p,S,m,S,l,w,b,C,y,y,m,M,k,h,p;if(void 0===r&&(r={}),0===(n=R(n)?3:n))return new T.Style;if(-1===t&&-1===e)return this.getDefaultStyle(n);if(o=Z(r.rowSpacingIndex),h=(a=this).pL,m="__spreadJSDefault",S="__undefined",l=this.Ut,!o&&3===n&&a.pivotTables&&(b=(w=a.pivotTables.findPivotTable(t,e)||B)&&w.hqt(t,e)),c=l.getStyle(t,e,n,r),f=l.getStyle(t,-1,n,r),l=l.getStyle(-1,e,n,r),c=c||B,f=f||B,l=l||B,r.ignoreSheet&&(-1===t&&(f=B),-1===e)&&(l=B),d=S,C=a.parent&&a.parent.Gie,c&&(d=c.charAt?c:m+c._id),p=S,f&&(p=f.charAt?f:m+f._id),S=S,l&&(S=l.charAt?l:m+l._id),h=(m=h[n])[d],y=a.tables,(y=3===n&&y&&!r.isForFilter?y.find(t,e):B)||w||a.NMi||((v=(h=h||(m[d]={}))[p])?g=v[S]:v=h[p]={}),g||(u=a.getCompositeStyle(t,e,n,c,f,l,{table:y,isForFilter:r.isForFilter,pivotTableStyle:b,ignoreSheet:r.ignoreSheet,pivotTable:w,rowSpacingIndex:r.rowSpacingIndex,isAfterRowSpacing:r.isAfterRowSpacing})),o||!(3===n||t<a.getFreeAreaRowCount(n)||1===n&&a.NMi)||i||(m=a.conditionalFormats)&&(s=m.bL(s,t,e,n)),o||!(3===n||t<a.getFreeAreaRowCount(n))||i||!R(s)&&!R(s.foreColor)||!(M=s&&s.formatter||g&&g.formatter||u&&u.formatter||c&&c._autoFormatter)||r.isForFilter||J(M)||(k=te(M,a.getValue(t,e,n)))&&((s=R(s)?new T.Style:s).foreColor=k),s)s.h5(d=g||u),s.font&&d&&d.font&&s.font!==d.font&&(s.font=zt(s,d)),u=s;else if(g)return!a.cellStates||i||C||(h=a.cellStates.getStyle(t,e,n,B,g.locked))&&(h.h5(g),(g=h).v5(a.hl)),r.notClone?g:g.clone(!0);return r.ignoreSheet||(R(u.locked)&&(u.locked=!0),R(u.hidden)&&(u.hidden=!1),u=u.v5(a.hl)),s||y||w||a.NMi||(v[S]=u.clone(!0)),o||!a.cellStates||i||C||(p=a.cellStates.getStyle(t,e,n,B,u.locked))&&(!(M=p.formatter)||r.isForFilter||J(M)||(k=te(M,a.getValue(t,e,n)))&&(p.foreColor=k),p.h5(u),u=(u=p).v5(a.hl)),u},K.prototype.l0=function(t,e,n,i,r){var o,a,s,u,c,f,l,h,d,v,g,d,g,m,p,p,S;if(void 0===r&&(r={}),0===i)return N;if(R(i)&&(i=3),c=(o=this).Ut,l=!1,3===i){if("foreColor"===n){d=o.l0(t,e,"formatter",i);try{(v=w.Formatter&&w.Formatter.GeneralFormatter)&&typeof d===C&&(d=x.Be.Ue(d))}catch(t){}d&&(d.hasFormattedColor&&d.hasFormattedColor()||w.Formatter&&d instanceof w.Formatter.FormatterBase)&&(g={conditionalForeColor:B},d.format(o.getValue(t,e),g),g.conditionalForeColor)&&(f=g.conditionalForeColor,l=!0)}(d=o.conditionalFormats)&&0<d.count(i)&&(l=(g=d.wL(t,e,n,i)).yL,f=g.Y6)}for(m=0;!l&&m<=4;)if(0===m?a=c.getStyle(t,e,i,r):1===m?(p=!o.PHe&&o.tables,(p=3===i&&p?p.find(t,e):B)&&kt[n]&&(a=p.ML(t,e,n))):a=2===m?c.getStyle(t,-1,i,r):3===m?c.getStyle(-1,e,i,r):o.getDefaultStyle(i),m++,a=a&&a.charAt&&typeof a===C?o.u8(a):a){if("font"!==n&&"fontStyle"!==n&&"fontWeight"!==n&&"fontSize"!==n&&"fontFamily"!==n||!a.themeFont||(h=h||a.themeFont),a[n]!==N){f=a[n],l=!0;break}for(s=a.parentName,S=void 0;s&&S!==s&&(u=o.u8(s));){if(u[n]!==N){f=u[n],l=!0;break}s=u.parentName,S=u.name}}return"locked"===n?!!R(f)||f:"hidden"===n?!R(f)&&f:l||h?("foreColor"!==n&&"backColor"!==n&&"font"!==n&&"fontStyle"!==n&&"fontWeight"!==n&&"fontSize"!==n&&"fontFamily"!==n&&"borderLeft"!==n&&"borderTop"!==n&&"borderRight"!==n&&"borderBottom"!==n||((a=new T.Style)[n]=f,"font"===n&&h&&(a.themeFont=h),a.v5(o.hl),f=a[n]),f):N},K.prototype.getStyle=function(t,e,n){return this.Z_(t,e,n,!0)},K.prototype.Z_=function(t,e,n,i,r){var o,t,e,n;if(void 0===r&&(r={}),0!==(n=R(n)?3:n)){if((t=(o=this.Ut).getStyle(t,e,n,r))instanceof T.Style)return i&&this.r3(),t;if(typeof t===C&&(e=this.u8(t))!==B&&e!==N)return(n=new T.Style).h5(e,!1),i&&this.r3(),n}return B},K.prototype.addNamedStyle=function(t){this.$p(t),this.zw()},K.prototype.$p=function(t){if(t){if(!t.name)throw new Error(m().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Hp[e]=t}},K.prototype.getNamedStyle=function(t){return this.i3(t,!0)},K.prototype.i3=function(t,e){var n,n,n=this.Hp;return n&&t?((n=n[t=t.toUpperCase()])&&e&&this.r3(),n):B},K.prototype.r3=function(){this.pL=[{},{},{},{}],this.s9e()},K.prototype.s9e=function(){this.n9e=B,this.e9e=B},K.prototype.removeNamedStyle=function(t){var e,n,e=this.Hp;e&&t&&(t=t.toUpperCase(),et(e,t))&&((n=e[t].formatter)&&"string"==typeof n&&this.parent.bp[n]&&this.parent.o3(n),delete e[t],this.r3(),this.zw())},K.prototype.getNamedStyles=function(){var n=[],t=this.Hp;return t&&h(t,function(t,e){n.push(e)}),this.r3(),n},K.prototype.setStyle=function(t,e,n,i){var r,i;R(i)&&(i=3),n&&n.backColor&&"object"==typeof n.backColor&&y.W.processStops(n.backColor),(r=this).CL(t,e,n,i),-1===t&&-1===e&&(r.Sj[i]=B),-1!==t&&-1!==e||(i=n&&n.validator)&&i.condition()&&4===i.condition().conType()&&i.condition().getExpected(this,t<0?0:t,e<0?0:e),r.r3(),r.zw()},K.prototype.u5=function(t,e,n,i){var r,o,a,r=this;r.isActualProtected()?(o=r.Z_(t,e,i),a=void 0,n?(a=o?o.locked:N,n.locked!==a&&(n.locked=a),r.setStyle(t,e,n,i)):o&&((a=o.locked)!==N&&((n=new T.Style).locked=a),r.setStyle(t,e,n,i))):r.setStyle(t,e,n,i)},K.prototype.getStyleName=function(t,e,n){var t=this.vI(t,e,n);return t instanceof T.Style?t.name:t},K.prototype.setStyleName=function(t,e,n,i){var r;typeof n===C&&(R(i)&&(i=3),(r=this).CL(t,e,n,i),-1===t&&-1===e&&(r.Sj[i]=B),r.r3(),r.zw())},K.prototype.vI=function(t,e,n){var i;return(i=0!==(n=R(n)?3:n)?this.Ut.getStyle(t,e,n):i)||B},K.prototype.getNamedStyleName=function(t,e,n){var t=this.vI(t,e,n);return"string"==typeof t?t:N},K.prototype.CL=function(t,e,n,i){var r,o,a,s,u,s,u,a,u,o;0!==(i=R(i)?3:i)&&(o=(r=this).vI(t,e,i),s=(a=r.Ut).getRowCount(i),u=a.getColumnCount(i),t<-1||s<=t||e<-1||u<=e||(s=a.getStyle(t,e,i),a.do("setStyle",t,e,n,i),(u=r.l0(t,e,"formatter",i))&&J(u)&&r.SL(t,e,u),a=o&&o.cellType&&o.cellType.typeName||B,u=n&&n.cellType&&n.cellType.typeName||B,t===r.ui&&e===r.ci&&a!==u&&x.hi.A1(r)&&r.rt.aA(),o="[styleinfo]",-1!==t&&-1!==e?r.Rj(o,t,e,i,s,n):-1!==t&&-1===e?r.dj(t,i,o,n,s):-1===t&&-1!==e&&r.vj(e,i,o,n,s)))},K.prototype.SL=function(t,e,n){var i=this;J(n)&&(f=f||o("SheetsCalc"))&&i.TL(t,e,n)},K.prototype.getDefaultStyle=function(t){var e,n,i,i,r,e,i;return R(t)&&(t=3),(i=(n=(e=this).Sj)[t])||(0!==t?((r=typeof(r=(i=e.Ut).getStyle(-1,-1,t))===C?e.u8(r):r)||(r=new T.Style,i.do("setStyle",-1,-1,r,t)),e=1===t||2===t,typeof r.hAlign==ut&&(r.hAlign=e?1:3),typeof r.vAlign==ut&&(r.vAlign=e?1:0),typeof r.imeMode==ut&&(r.imeMode=1),r.font||typeof r.themeFont!=ut||(r.themeFont="Body"),n[t]=r):((i=new T.Style).locked=!0,i.hidden=!1,n[t]=i))},K.prototype.setDefaultStyle=function(t,e){var n=this;0!==(e=R(e)?3:e)&&n.Ut.do("setStyle",-1,-1,t,e),n.Sj[e]=B,n.r3(),n.zw()},K.prototype.u8=function(t){var e,n,n,e=this.i3(t,!1);return e=e||(n=this.parent)&&n.i3(t,!1),n=B,e&&(n=e.clone(!0),(0,x.AL)(n)),n},K.prototype.getCompositeStyle=function(t,e,n,i,r,o,a){var i,s,u,c;if(void 0===a&&(a={}),R(n)&&(n=3),s=this,u=new T.Style,c=!1,0!==n){if(c=s.IL(t,e,n,u,c,i),a.hasTableStyle)return c?u:i;c=s.xL(t,e,n,u,c,a.table,a.isForFilter),c=(i=s.NL(t,e,n,u,c,a.pivotTable,a.isForFilter,a.pivotTableStyle)).changed,u=i.destInfo,c=s.kL(t,n,u,c,r),c=s.DL(e,n,u,c,o)}return s._L(n,u,c,a.ignoreSheet),u},K.prototype.IL=function(t,e,n,i,r,o){var a,s,u,u,c,a=this,s=a.Ut,u=s.getRowCount(n),c=s.getColumnCount(n);return 0<=t&&t<u&&0<=e&&e<c&&(u=(u=o!==N?o:s.getStyle(t,e,n))&&u.charAt?a.u8(u):u)&&(i.h5(u,!0,10),(0,T.composeParentStyle)(u,i,a,!(r=!0),10,!0)),r},K.prototype.xL=function(t,e,n,i,r,o,a){var s,u=this.tables;return(o=o!==N||a?o:3===n&&u?u.find(t,e):B)&&!a&&(o.h5(t,e,i),r=!0),r},K.prototype.NL=function(t,e,n,i,r,o,a,s){var u,c,a,u=this,c=u.pivotTables;return(s=o!==N||a?s:(o=3===n&&c?c.findPivotTable(t,e):B)&&o.hqt(t,e))&&(s.parentName&&(a=u.u8(s.parentName))&&s.h5(a),s.h5(i),i=s,r=!0),o&&(o.wqt(t,e,i),r=!0),{changed:r,destInfo:i}},K.prototype.kL=function(t,e,n,i,r){var o=this,a=o.Ut,s=a.getRowCount(e),s;return 0<=t&&t<s&&(s=(s=r!==N?r:a.getStyle(t,-1,e))&&s.charAt?o.u8(s):s)&&(n.h5(s,!i,30),(0,T.composeParentStyle)(s,n,o,!(i=!0),30,!0)),i},K.prototype.DL=function(t,e,n,i,r){var o=this,a=o.Ut,s=a.getColumnCount(e),s;return 0<=t&&t<s&&(s=(s=r!==N?r:a.getStyle(-1,t,e))&&s.charAt?o.u8(s):s)&&(n.h5(s,!i,40),(0,T.composeParentStyle)(s,n,o,!(i=!0),40,!0)),i},K.prototype._L=function(t,e,n,i){var r,t,r=this,t=r.getDefaultStyle(t);return t&&t.charAt?t=r.u8(t):t&&t.clone&&(t=t.clone(!0),(0,x.AL)(t)),t&&!i&&(e.h5(t,!n,50),(0,T.composeParentStyle)(t,e,r,!1,50,!0)),n},K.prototype.getCellType=function(t,e,n,i){return this.l0(t,e,"cellType",n,i=void 0===i?{}:i)||this.$f(n)},K.prototype.$f=function(t){R(t)&&(t=3);var e,e=(e=this.f7)||(this.f7=new s.Text);return 3===t?e:1===t?new c.ColumnHeader:2===t?new c.RowHeader:0===t?new c.Corner:e},K.prototype.$Ae=function(t){var e=this;return t===P.SheetArea.colHeader&&At(e.options)?e.c9e:t===P.SheetArea.rowHeader&&Dt(e.options)?e.f9e:B},K.prototype.setCellType=function(t,e,n,i){var r=this.Z_(t,e,i),r;(r=r||new T.Style).cellType=n,this.setStyle(t,e,r,i)},K.prototype.EL=function(t,e,n,i,r,o){var a,s,u,o,o,c,f,a=this;if(R(r)&&(r=3),s=a.Ut,o||s.do("clearSpan",t,e,n,i,r),u=(0,x.Ec)(t,e,n,i),o=a.JS(u,r),o=a.jL(o,r),s.do("addSpan",o,r),3===r){for(c=a.getSelections(),f=0;f<c.length;f++)c[f].intersect(t,e,n,i)&&(c[f]=c[f].union(u));s.do("setSelections",c)}a.zw()},K.prototype.jL=function(t,e){var n,e,i,r,o,t,n=this.getRowCount(e),e=this.getColumnCount(e),i=t.row,r=t.col,o=t.rowCount,t=t.colCount;return(0,x.Ec)(i,r,o=n<i+o?n-i:o,t=e<r+t?e-r:t)},K.prototype.addSpan=function(t,e,n,i,r){this.TTe(t,e,n,i,r)},K.prototype.addSpans=function(t,e){var n=this;t.forEach(function(t){n.TTe(t.row,t.col,t.rowCount,t.colCount,e,!0)})},K.prototype.TTe=function(t,e,n,i,r,o){var a,s,u,s,c,u,a=this;if((1!==n||1!==i)&&0!==r&&(s=a.getRowCount(r),u=a.getColumnCount(r),!(s<=t||u<=e||t<-1||e<-1))&&(s={row:t,col:e,rowCount:n,colCount:i,sheetName:a.name(),sheetArea:r,isAllow:!0},K.et(a,St,s),s.isAllow)){if(!o&&(c=a.Ut).GT(t,e,n,i,r))throw new Error(m().Exp_InvalidRange);a.OL&&a.OL(t,e,n,i),a.EL(t,e,n,i,r,o),K.et(a,F,u={sheet:a,row:t,col:e,rowCount:n,colCount:i,sheetArea:r,changeType:"addSpan"}),a.ki("spanChanged",u)}},K.prototype.removeSpan=function(t,e,n){var i,r,o,r,i=this;R(n)&&(n=3),(o=(r=i.Ut).findSpan(t,e,n))&&o.row===t&&o.col===e&&r.do("removeSpan",o,n),K.et(i,F,r={sheet:i,row:t,col:e,sheetArea:n,changeType:"removeSpan"}),i.ki("spanChanged",r),i.zw()},K.prototype.getSpans=function(t,e){return 0===e?[]:this.Ut.getSpans(t,e,!0)},K.prototype.getSpan=function(t,e,n){return 0===n?B:this.Ut.findSpan(t,e,n)},K.prototype.repaint=function(t){this.My<=0&&this.Dn&&this.Dn.repaint(t)},K.prototype.x_=function(t,e,n,i){var r,o,t,e,r=t,o=1,t=this.RL(t,e,n,i);t&&(r=t.row,o=t.rowCount),(e=this.j1(new x.Range(r,-1,o,-1))).y-=2,e.height+=4,this.repaint(e)},K.prototype.N_=function(t,e,n,i){var r,o,t,e,r=t,o=1,t=this.BL(t,e,n,i);t&&(r=t.col,o=t.colCount),(e=this.j1(new x.Range(-1,r,-1,o))).x-=2,e.width+=4,this.repaint(e)},K.prototype.LL=function(t,e){var n,i,t,n=this,i=n.Fi(),t=n.j1(new x.Range(-1,t,-1,1));t.y=i.y,t.height=i.height,e&&(t.x-=2,t.width+=4),n.repaint(t)},K.prototype.RL=function(t,e,n,i){var r,o,a,s,u,c,f,r=this,o=r.yw(n),a=o.length;if(0!==a&&(s=r.s7(e,n,P.SheetArea.viewport,i))){if(s.length>a)for(s=new E.h9,c=u=o[0].col;c<a;c++)(f=r.O_(e,n,P.SheetArea.viewport,t,o[c].col))&&s.push(f);return s.findLargestRow(t)}return B},K.prototype.BL=function(t,e,n,i){var r,o,a,s,u,c,f,r=this,o=r.dw(e),a=o.length;if(0!==a&&(s=r.s7(e,n,P.SheetArea.viewport,i))){if(s.length>a)for(s=new E.h9,c=u=o[0].row;c<a;c++)(f=r.O_(e,n,P.SheetArea.viewport,o[c].row,t))&&s.push(f);return s.findLargestCol(t)}return B},K.prototype.OA=function(t,e){var n,i,r,o,a,s,u,c,c,u,f,l,c,h,c,c,d,v,g,m,c,d,p,u,t,S,c,d,u,t,n=this,i=n.parent,r=i&&i.options.scrollbarAppearance===P.ScrollbarAppearance.mobile,o=!1,a=!1,s=i&&i.options.scrollByPixel,u=Y(n),c=V(n),c=c?n.O5(c-1):n.k9(),u=u?n.j5(u-1):n.N9();if(e<n.Ab&&c<=e?(o=!0,n.o9(n.r6(e+1),0)):s&&e===n.Ab&&0!==n.my&&(o=!0,n.o9(e,0)),e>n.getLastFullyVisibleColumn()&&e<=n.G6()){for(f=0,l=e,c=n.Fi(),h=n.Gy(c),(c=n.Ut.findSpan(t,l))&&(l=c.col+c.colCount-1);l>n.Ab&&!(h<(f+=n.nn(l)));)l--;d=c=void 0,d=s?(l===n.Ab&&f<h&&(f+=n.nn(l)),c=l,h-f):(c=(v=n.bge())===l?l:n.O5(l),0),o=!0,n.o9(c,d)}if(t<n.Tb&&u<=t?(a=!0,n.$A(n.nI(t+1),0)):s&&t===n.Tb&&0!==n.ly&&(a=!0,n.$A(t,0)),t>n.getLastFullyVisibleRow()&&t<=n.P6()){for(g=0,(c=n.Ut.findSpan(m=t,e))&&(m=c.row+c.rowCount-1),d=n.Fi(),p=n.Sy(d);m>n.Tb&&!(p<(g+=n.Gt(m)));)m--;t=u=void 0,t=s?(m===n.Tb&&g<p&&(g+=n.Gt(m)),u=m,p-g):(u=(S=n.pge())===m?m:n.j5(m),0),a=!0,n.$A(u,t)}c=n.aB(),!s&&e===n.G6()&&c&&n.o9(c,0),r&&(d=i.Xb,u=i.zb,t=i.ib,a&&(d.qy(P.ScrollbarState.show),t.$y(!0)),o)&&(u.qy(P.ScrollbarState.show),t.$y(!1))},K.prototype.hitTest=function(t,e,n,i,r){var o,a,s,u,c,s,u,c,n,r,c,r,f,s,s,r,s,c,r,s,u,r,c,s,u,r,c,s,i,o=this;return o.Fi(),a={x:t,y:e},s=o.rowOutlines,u=o.columnOutlines,(c=!(c=s?s.hitTest(o,t,e):c)&&u?u.hitTest(o,t,e):c)?a.outlineHitInfo=c:(s=o.FL(e),u=o.PL(t),a.rowViewportIndex=s,a.colViewportIndex=u,a.row=o.GL(e,s),a.col=o.UL(t,u,e,s,a.row),a.hitTestType=o.C6(s,u),3===s&&(o.l9e&&(a.rowSpacingIndex=o.l9e(e,s)),o.h9e)&&(a.isAfterRowSpacing=o.h9e(e,s)),0<=s&&s<=2&&0<=u&&!0!==n&&(c=o.O_(s,u,a.hitTestType,a.row,a.col,r))&&(a.row=c.row,a.col=c.col),n=o.rt,c=(r=o.IB)&&r.hitTest(a,t,e),!(r=o.tables)||-1===s&&-1===u||(f=-1===s?r.find(o.getActiveRowIndex(),o.getActiveColumnIndex()):r.find(a.row,a.col)),c=c||(s=f&&f.IB)&&s.hitTest(a,t,e),(s=r&&!c&&r.HL(t,e,a))?(a.tableSelectInfo=s).table&&s.table.IB&&(a.filterButtonHitInfo=c):c?a.filterButtonHitInfo=c:(r=n.zL&&n.zL(a,t,e))?a.dragMergeInfo=r:(s=n.VL&&n.VL(a,t,e))?a.dragInfo=s:(c=a.col,a.col=o.UL(t,u),a.YL=c,(r=n.bD(a,t,e,5))?a.resizeInfo=r:(a.col=c,delete a.YL,(s=n.ZL?n.ZL(a,t,e):B)?a.formulaRangeHitInfo=s:(r=(u=o.Ut.pI)&&u.hitTest(t,e))?a.commentHitInfo=r:(c=o.shapes&&o.shapes.hitTest(t,e))?a.shapeHitInfo=c:(u=(s=o.WL)&&s.hitTest(t,e,i))?a.floatingObjectHitInfo=u:(r=f&&!f.QL()&&n.KL&&n.KL(a,f))?a.resizeTableHitInfo=r:(c=o.JL(a,t,e))?a.cellTypeHitInfo=c:a.hitTestType===P.SheetArea.viewport&&o.pivotTables&&(s=o.pivotTables.findPivotTable(a.row,a.col))?a.pivotTableInfo=s:(i=n.d9e&&n.d9e(a,t,e))&&(a.dragHeaderToMoveInfo=i)))),a},K.prototype.getCellRect=function(t,e,n,i,r){var o,a,s,s,u,c,c,f,a,n,i,o,r;return void 0===r&&(r={}),o=3,-1===n?o=1:-1===i&&(o=2),s=(a=this).Fi(),-1===n&&-1===i?new x.Rect(s.BA,s.LA,s.XC,s.qC):(s=a.ot(),R(n)&&(n=a.C0(t,r.rowSpacingIndex)),R(i)&&(i=a.S0(e)),u=Z(r.rowSpacingIndex),c=a._y(n,o),c=u?c.findRowSpacing(t,r.rowSpacingIndex,r.isAfterRowSpacing):c.findRow(t),f=a.Yy(i,o).findCol(e),!u&&(a=a.s7(n,i,o,r.needAutoMerge).findCell(t,e))?new x.Rect(a.x-s.x,a.y-s.y,a.width,a.height):c&&f?(n=f.x-s.x,i=c.y-s.y,o=f.width,r=c.height,u||-1===f.height||-1===f.y||(r=c.height*f.height,i=c.height*f.y),new x.Rect(n,i,o,r)):new x.Rect)},K.prototype.XA=function(t,e,n){var i,r,o,a,s,u,c,f,l,h,l,c,f,h,l,n,i=this,r=i.rt,o=!1,a=!1,c=i.ui,f=i.ci;R(t)||(i.ui!==t&&(a=!0),s=i.ui,i.ui=t,o=!0),R(e)||(i.ci!==e&&(a=!0),u=i.ci,i.ci=e,o=!0),h=(l=i._1)&&l.isEnable(P.RowColumnStates.active,!0),l=l&&l.isEnable(P.RowColumnStates.active,!1),h&&(i.x_(c,i.R9,i.B9),i.x_(t,i.R9,i.B9)),l&&(i.N_(f,i.R9,i.B9),i.N_(e,i.R9,i.B9)),i.Ut.setCellState(c,f,P.CellStatesType.active,!1,P.SheetArea.viewport),h||l||i.k_&&i.k_(P.CellStatesType.active,c,f,P.SheetArea.viewport),i.Ut.setCellState(t,e,P.CellStatesType.active,!0,P.SheetArea.viewport),h||l||i.k_&&i.k_(P.CellStatesType.active,t,e,P.SheetArea.viewport),!n&&r&&o&&(a&&i.ki(x.Events.ActiveCellChanged,{oldRow:s,oldCol:u,row:i.ui,col:i.ci}),r.aA(),c=i.Ut,(h=(f=i.Uw&&i.Uw(P.SheetArea.viewport))&&f.t8.getAnchorInfo(t,e))!==(l=c.cO))&&(c.cO=h,i.My<=0)&&(n=void 0,n=h&&l?(0,x.getUnionRange)(h,l):(0,x.Ec)((h=h||l).row,h.col,h.rowCount,h.colCount),i.Dn.E1(n))},K.prototype.XL=function(t,e,n,i,r){var t,e,n,i,r,t=t.getCellRect(e,n,i,r),e=t.x,n=t.y,i=t.width,r=t.height;return t.x=e-2,t.y=n-2,t.width=i+4,t.height=r+4,t},K.prototype.O6=function(t,e,n,i,r){var o,a,s,u,c,c,o=this,a=o.ui,s=o.ci,u=o.Ut,c=u.getSpan(t,e);o.H5=c.rowCount,o.z5=c.colCount,o.My<=0&&(c=u.getSpan(a,s),o.Dn.E1((0,x.Ec)(a,s,c.rowCount,c.colCount))),o.R9=n,o.B9=i,o.XA(t,e,r),o.qA=t,o.hR=e},K.prototype.setActiveCell=function(t,e,n,i){this.t4(t,e,n,i,2)},K.prototype.t4=function(t,e,n,i,r){var o,a,s,a,s,r,o=this,a=D(o),s=L(o);t<0?t=0:a<=t&&(t=U(0,a-1)),e<0?e=0:s<=e&&(e=U(0,s-1)),o.IA(),a=2===r?x.hi.A1(o):1===r,o.O6(t,e,n,i,!a),s={sheet:o,sheetName:o.name(),row:t,col:e},r=o.Ut.getSpan(t,e),o.D9(r.row,r.col,r.rowCount,r.colCount),o.zw(),o.ki(x.Events.EnterCellInternal,s)},K.prototype.getActiveRowIndex=function(){return this.ui},K.prototype.getActiveColumnIndex=function(){return this.ci},K.prototype.getRowResizable=function(t,e){return this.Ut.getResizable(!0,e,t)},K.prototype.setRowResizable=function(t,e,n){this.qL(t,e,pt,!0,n)},K.prototype.qL=function(t,e,n,i,r){var o,a,s,u;switch(R(r)&&(r=3),n!==ft&&n!==ct||!it.test(e)||(n=mt),a=(o=this).Ut,n){case pt:s=a.getResizable(i,r,t);break;case"pageBreak":s=a.getPageBreak(i,r,t);break;case gt:s=a.getVisible(i,r,t);break;case ft:case ct:s=a.getSize(i,r,t);break;case Ct:s=a.getColumnHeaderFitMode(i,r,t)}if(u=!0,!(u=i?o.kj(t,r,n,e,s):o.Dj(t,r,n,e,s)))return u;switch(n){case pt:a.do("setResizable",i,r,t,e);break;case"pageBreak":a.do("setPageBreak",i,r,t,e);break;case gt:a.do("setVisible",i,r,t,e),i&&G&&3===r&&s!==e&&(o.Lp.Vct=4,o.recalcRows([t]),delete o.Lp.Vct);break;case ft:a.do("setSize",i,r,t,e),!G||3!==r||s===e||0!==s&&0!==e||(o.Lp.Vct=4,o.recalcRows([t]),delete o.Lp.Vct);break;case ct:a.do("setSize",i,r,t,e);break;case mt:a.do("setStarSize",i,r,t,e);break;case Ct:a.do("setColumnHeaderFitMode",i,r,t,e)}return i?o.dj(t,r,n,e,s):o.vj(t,r,n,e,s),!0},K.prototype.getColumnResizable=function(t,e){return this.Ut.getResizable(!1,e,t)},K.prototype.setColumnResizable=function(t,e,n){this.qL(t,e,pt,!1,n)},K.prototype.getRowHeight=function(t,e,n){var i,n,r,o,a,n,s,n,i=this;if(R(e)&&(e=3),n)return i.Ut.getStarSize(!0,e,t);if(3===e||2===e){if(n=i.getRowCount(e),t<0||n<=t)return 0;for(r=i.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return 0}return s=(n=i.defaults).rowHeight,1===e&&(s=n.colHeaderRowHeight),(n=i.Ut.getSize(!0,e,t))||0===n?n:b(s)},K.prototype._o=function(t,e){var n,i,r,i;return R(e)&&(e=3),r=(i=(n=this).defaults).rowHeight,1===e&&(r=i.colHeaderRowHeight),(i=n.Ut.getActualSize(!0,e,t))||0===i?i:b(r)},K.prototype.setRowHeight=function(t,e,n){this.qL(t,e,ft,!0,n)&&(this.Ww=!0,this.zw())},K.prototype.getRowVisible=function(t,e,n){var i,r,o,a,i=this;if(R(e)&&(e=3),!n&&(3===e||2===e))for(r=i.$L,o=0;o<r.length;o++)if(!(a=r[o]).tF(t))return!1;return this.Ut.getVisible(!0,e,t)},K.prototype.setRowVisible=function(t,e,n){var i=this;i.qL(t,e,gt,!0,n)&&(i.Ww=!0,i.zw())},K.prototype.getColumnWidth=function(t,e,n){var i,n,r,n,o,a,s,n,i=this;if(R(e)&&(e=3),n)return i.Ut.getStarSize(!1,e,t);if(r=(n=i.defaults).colWidth,2===e&&(r=n.rowHeaderColWidth),3===e||1===e){if(n=i.getColumnCount(e),t<0||n<=t)return 0;for(o=i.nF,a=0;a<o.length;a++)if(!(s=o[a]).tF(t))return 0}return(n=this.Ut.getSize(!1,e,t))||0===n?n:b(r)},K.prototype.Do=function(t,e){var n,i,r,i;return R(e)&&(e=3),r=(i=(n=this).defaults).colWidth,2===e&&(r=i.rowHeaderColWidth),(i=n.Ut.getActualSize(!1,e,t))||0===i?i:b(r)},K.prototype.setColumnWidth=function(t,e,n){this.qL(t,e,ct,!1,n)&&(this.Zw=!0,this.zw())},K.prototype.getColumnVisible=function(t,e){var n,i,r,o,n=this;if(3===(e=R(e)?3:e)||1===e)for(i=n.nF,r=0;r<i.length;r++)if(!(o=i[r]).tF(t))return!1;return n.Ut.getVisible(!1,e,t)},K.prototype.setColumnVisible=function(t,e,n){var i=this;i.qL(t,e,gt,!1,n)&&(i.Zw=!0,i.zw())},K.prototype.zoom=function(t){var e,n,e=this;return 0===arguments.length?e.Ut.getZoomFactor():(t=at(t),!g(t)&&isFinite(t)&&(t=x.util.ige(t),n=e.Ut.getZoomFactor(),e.g8(t),e.my=e.my/n*t,e.ly=e.ly/n*t,e.Zw=!0,e.Ww=!0,e.zw()),e)},K.prototype.g8=function(t){this.Ut.do("setZoomFactor",t),K.et(this,F,{changeType:"zoomSheet"})},K.prototype.n3=function(){var t=this;t.eF=B,t.N8={colHeader:B,viewport:B},t.iF={rowHeader:B,viewport:B,colHeader:B}},K.prototype.invalidateLayout=function(){var t,e,e,t,t=this,e=t.rt;t.Ut.hj(),t.n3(),K.et(t,dt,{changeType:"invalidateLayout"}),t.Zw&&(t.aw(),t.Zw=!1),t.Ww&&(t.ew(),t.Ww=!1),t.n3(),K.et(t,F,{changeType:"invalidateLayout"}),e&&e.PA&&x.hi.A1(t)&&!e.M_(t)&&e.PA(t.ui,t.ci),t.k1=!0,(e=t.parent)&&e.options.enableAccessibility&&(t=t.t2(),e.n2(t))},K.prototype.zw=function(){var t=this;t.My<=0&&(t.invalidateLayout(),t.repaint())},K.prototype.getViewportHeight=function(t){var e=this,n=e.Fi();return 0===t?n.L6:1===t?e.Sy(n):2===t?n.Iy:0},K.prototype.getViewportWidth=function(t){var e=this.Fi();return 0===t?e.F6:1===t?this.Gy(e):2===t?e.zy:0},K.prototype.getViewportTopRow=function(t){var e,n,e=this,n=Y(e);return 0===t?e.bve||0:1===t?U(n,e.Tb):2===t?U(n,D(e)-O(e)):-1},K.prototype.getViewportTopRowOffset=function(){return this.ly},K.prototype.getViewportBottomRow=function(t){var e,n,i,r,o,a,s,e=this;if(2===t)return D(e)-1;for(n=e.getViewportTopRow(t),i=e.getViewportHeight(t),r=1===t?e.ly:0,o=0,a=D(e)-O(e),0===t&&(a=H(Y(e),a)),s=n;s<a&&r<i;s++,o++)r+=e.Gt(s);return n+o-1},K.prototype.H7=function(t){for(var e,n,i,r,e,n=this.dw(t),i=0;i<n.length;i++)if(0<(r=n[i]).height)return r.row;return-1},K.prototype.getViewportLeftColumn=function(t){var e,n,e=this,n=V(e);return 0===t?e.yve||0:1===t?U(n,e.Ab):2===t?U(n,L(e)-j(e)):-1},K.prototype.getViewportLeftColumnOffset=function(){return this.my},K.prototype.getViewportRightColumn=function(t){var e,n,i,r,o,a,s,e=this;if(2===t)return L(e)-1;for(n=e.getViewportLeftColumn(t),i=e.getViewportWidth(t),r=0,o=1===t?e.my:0,a=L(e)-j(e),0===t&&(a=H(V(e),a)),s=n;s<a&&o<i;s++,r++)o+=e.nn(s);return n+r-1},K.prototype.z7=function(t){for(var e,n,i,r,e=this,n=e.getViewportLeftColumn(t),i=e.getViewportRightColumn(t),r=n;r<i+1;r++)if(-1<r&&e.getColumnVisible(r,3)&&0<e.nn(r,3))return r;return-1},K.prototype.showCell=function(t,e,n,i){this.rF(t,e,n,i)},K.prototype.rF=function(t,e,n,i,r,o){var i,i,a,s,u,c,f,l,h,d,v,n,s,u,i,a=this;t<0||t>=D(a)||e<0||e>=L(a)||(s=a.parent&&a.parent.options.scrollByPixel,u=a.parent&&a.parent.options.scrollbarMaxAlign,c=a.S0(e),f=a.C0(t),l=a.getViewportTopRow(f),h=a.ly,d=a.getViewportLeftColumn(c),v=a.my,1===c&&R(o)&&(e=(i=a.rB(e,i,s,u)).col,o=i.offset),1===f&&R(r)&&(t=(i=a.oF(t,n,s,u)).row,r=i.offset),s=n=!1,1!==f||t===l&&r===h||(t=H(t,a.mw().Ky),a.Tb=t,a.ly=r,a.tw(),n=!0),1!==c||e===d&&o===v||(e=H(e,a.Mw().iw),a.Ab=e,a.my=o,a.ow(),s=!0),(n||s)&&((u=a.parent)&&!u.options.scrollbarShowMax&&(a.Zw=!0,a.Ww=!0),a.zw(),i=a.zoom(),n&&a.ki(x.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:l,newTopRow:t,oldOffset:k(h/i),newOffset:k(r/i)}),s)&&a.ki(x.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:d,newLeftCol:e,oldOffset:k(v/i),newOffset:k(o/i)}))},K.prototype.C0=function(t,e){var n=this;return Z(e)?3:t<Y(n)?0:t>=D(n)-O(n)?2:1},K.prototype.S0=function(t){var e=this;return t<V(e)?0:t>=L(e)-j(e)?2:1},K.prototype.oF=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,g,i,e,m,p,i,r=this,o=r.Jt,a=r.C0(t),s=r.getViewportTopRow(a),u=r.ly,c=Y(r),l=r.P6();if(0===e)if(i){for(h=l,f=r.getViewportHeight(a);c<=h;h--)if((f-=o.Gt(h))<0){t<h?n||(u=0):u=t===h?n?f:0:(t=h,f);break}}else u=0;else if(1===e){if(v=d=!1,i){for(h=l,f=g=b(r.getViewportHeight(a)/2);c<=h;h--)if((f-=o.Gt(h))<0){h<=t&&(h--,f+=g,v=!0);break}if(v)for(;c<=h;h--)if((f-=o.Gt(h))<0){t=h,u=f,d=!0;break}}if(!d){for(f=b((r.getViewportHeight(a)-o.Gt(t))/2);c<t;t--)if((f-=o.Gt(t-1))<0){t-=1,u=f;break}0<f&&t===c&&(u=0)}}else if(2===e){for(f=r.getViewportHeight(a)-o.Gt(t);c<t;t--)if((f-=o.Gt(t-1))<0){t-=1,u=f;break}0<f&&t===c&&(u=0)}else if(3===e)if(s<t){if(i=r.Fi(),e=r.getCellRect(t,r.ci),m=i.c9(1,1),p=i.c9(1,0),i=i.c9(1,2),m.containsRect(e,!0)||p.containsRect(e,!0)||i.containsRect(e,!0))t=s;else for(f=r.getViewportHeight(a)-o.Gt(t);s<t;t--)if((f-=o.Gt(t-1))<0){t-=1,u=f;break}}else u=0;return!n&&u<0&&(u=0,t<l)&&(t+=1),{row:t,offset:u}},K.prototype.rB=function(t,e,n,i){var r,o,a,s,u,c,f,l,h,d,v,g,i,e,m,p,i,S,w,r=this,o=r.Jt,a=r.S0(t),s=r.getViewportLeftColumn(a),u=r.my,c=V(r),l=r.G6();if(0===e)if(i){for(f=r.getViewportWidth(a),h=l;c<=h;h--)if((f-=o.Kt(h))<0){t<h?n||(u=0):u=t===h?n?f:0:(t=h,f);break}}else u=0;else if(1===e){if(v=d=!1,i){for(f=g=b(r.getViewportWidth(a)/2),h=l;c<=h;h--)if((f-=o.Kt(h))<0){h<=t&&(h--,f+=g,v=!0);break}if(v)for(;c<=h;h--)if((f-=o.Kt(h))<0){t=h,u=f,d=!0;break}}if(!d){for(f=b((r.getViewportWidth(a)-o.Kt(t))/2);c<t;t--)if((f-=o.Kt(t-1))<0){t-=1,u=f;break}0<f&&t===c&&(u=0)}}else if(2===e){for(f=r.getViewportWidth(a)-o.Kt(t);c<t;t--)if((f-=o.Kt(t-1))<0){t-=1,u=f;break}0<f&&t===c&&(u=0)}else if(3===e)if(s<t){if(e=(i=r.Fi()).Py,m=i.Cy,p=i.hL,i=i.A6,S=r.getCellRect(r.ui,t),(w=new x.Rect(e,m,p,i)).containsRect(S,!0))t=s;else for(f=r.getViewportWidth(a)-o.Kt(t);s<t;t--)if((f-=o.Kt(t-1))<0){t-=1,u=f;break}}else u=0;return!n&&u<0&&(u=0,t<l)&&(t+=1),{col:t,offset:u}},K.prototype.Jy=function(t,e){var n=this,i=n.Jt,r=n.C0(t),o=n.getViewportTopRow(r),a;if(0!==e)if(1===e)for(a=b((n.getViewportHeight(r)-i.Gt(t))/2);0<t&&!((a-=i.Gt(t-1))<0);t--);else if(2===e)for(a=n.getViewportHeight(r)-i.Gt(t);0<t&&!((a-=i.Gt(t-1))<0);t--);else if(3===e&&!(t<o||-1===o))for(a=n.getViewportHeight(r)-i.Gt(t);o<t&&!((a-=i.Gt(t-1))<0);t--);return t},K.prototype.showColumn=function(t,e){this.showCell(this.Tb,t,0,e)},K.prototype.showRow=function(t,e){this.showCell(t,this.Ab,e,0)},K.prototype.suspendEvent=function(){this.vf++},K.prototype.resumeEvent=function(){this.vf--,this.vf<0&&(this.vf=0)},K.prototype.isEventSuspended=function(){return 0<this.vf},K.prototype.currentTheme=function(t){var e=this;return 0===arguments.length?(e.hl||e.aF(),e.hl):(typeof t===C&&(t=S.Themes[t]||new S.Theme(t)),e.hl=t,e.Dn.O7(),e.r3(),K.et(e,"onThemeChanged",{value:t}),e.zw(),e)},K.prototype.uF=function(){var t=x.I.fl(""),t=M(t.zIndex),e=S.Themes.Office2007;return e=2007<t?S.Themes.Office:e},K.prototype.aF=function(){this.hl=this.uF(),this.r3()},K.prototype.reset=function(){var t=this;t.sF(),t.zw()},K.prototype.sF=function(){var t,e,n,i,r,t=this,e=t.b2();t.cF(),t.R9=0,t.B9=0,t.Zp(),t.eF=B,t.N8={colHeader:B,viewport:B},t.iF={rowHeader:B,viewport:B,colHeader:B},t.Tb=0,t.ly=0,t.Ab=0,t.my=0,t.frozenRowCount(0),t.frozenColumnCount(0),t.frozenTrailingRowCount(0),t.frozenTrailingColumnCount(0),K.et(t,"beforeSetHost"),(n=t.parent)&&(i=n.getActiveSheet(),r=n.getActiveSheetTab(),i&&t.name()===i.name()||r&&t.name()===r.name())&&t.hg(n._vp),t.r3(),t.Jt=new x.Ff(t),t.Sj={},G&&t.resetCalc(),t.Ut&&t.Ut.L0(!0),t.Ut=new E.Y8(t,K.n8,K.e8,K.o8,K.r8,t.name()),t.defaults=t.Ut.defaults,t.b2(e),t.aF(),t.Hp={},t.Zw=!0,t.Ww=!0,t.parent&&t.parent.sg?t.My=t.parent.sg:t.My=0,t.parent&&t.parent.vf?t.vf=t.parent.vf:t.vf=0,t.lE=0,t.xT=!1,t.fF=B,t.$L=[],t.nF=[],t.Nj=!1,t.hA=P.ClipboardPasteOptions.all,t.lF=P.CopyToOptions.all,t.JT=!0,t.UB=!0,K.et(t,"init")},K.prototype.Zp=function(){var i=this;h(Bt,function(t,e){var n;R(e)||(n=e,"gridline"===t?n={color:x.I.fl("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof n&&(n=l.GC$.extend({},e)),i.options[t]=n)})},K.prototype.pM=function(t){var e,n,e=this;for(e.parent=t,n=e.My;n<t.sg;n++)e.suspendPaint();e.vf=t.vf,K.et(e,"attach",t)},K.prototype.hF=function(t,e){return t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount},K.prototype.dF=function(t,e,n,i,r){for(var o,a,s,o=this.iT(e,n,i,r).ranges,a=0;a<o.length;a++)for(s=0;s<t.length;s++)if(this.hF(t[a],o[s]))return!0;return!1},K.prototype.vF=function(t,e,n,i,r){var o,a,o=!1;return void 0!==r?0===r?0<(a=this.iT(t,e,n,this.getColumnCount()-e).ranges).length&&(o=(o=(o=0<t-1?this.dF(a,t-1,e,1,this.getColumnCount()-e):o)||this.dF(a,t+n,e,1,this.getColumnCount()-e))||this.dF(a,t,e,n,1)):0<(a=this.iT(t,e,this.getRowCount()-t,i).ranges).length&&(o=(o=(o=0<t-1?this.dF(a,t-1,e,this.getRowCount()-t,1):o)||this.dF(a,t+n,e,this.getRowCount()-t,1))||this.dF(a,t,e,1,i)):o=!0,o},K.prototype.PT=function(t,e,n,i,r){var o,a,s,u,c,f,r,l,u,o=r.invalidType,a=r.lockErrorMsg,s=r.arrayFormulaErrorMsg,u=r.isAllowDragInsert,c=r.shiftCells,f=r.isIgnoreFilterOutRow,r=r.sheetArea,l=this;return R(o)&&(o=1),!u&&l.isActualProtected()&&l.dA((0,x.Ec)(t,e,n,i),f,r)?(a&&l.jT(o,a),!1):(u=this.vF(t,e,n,i,c),!(G&&u&&!l.mT(t,e,n,i)&&(s&&l.jT(o,s),1)))},K.prototype.clear=function(t,e,n,i,r,o,a,s,u){0!==r&&this.KI(t,e,n,i,r,o,a,s,u)},K.prototype.KI=function(t,e,n,i,r,o,a,s,u,c){var f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,f=this,l=G;try{if(l&&f.suspendCalcService(),f.suspendPaint(),h=f.defaults,p=3,S={changeType:"clear",row:t,col:e,rowCount:n,colCount:i,sheetArea:r,type:o,ignoreTable:s,ignorePivotTable:u,canClear:!(m=g=v=d=void 0)},K.et(f,F,S),S.canClear){if(R(r)||3===r){if(l&&!f.mT(t,e,n,i))return!1;if(1&o&&f.getDataSource&&f.getDataSource()){for(f.suspendEvent(),d=t;d<t+n;d++)if(!(a&&f.XT&&f.XT(d)))for(v=e;v<e+i;v++)f.setValue(d,v,B,r);f.resumeEvent()}}if(w=f.Ut,b=l&&f.b3(),d=-1===t?0:t,C=-1===t?w.getRowCount(r):n,v=-1===e?0:e,y=-1===e?w.getColumnCount(r):i,M=[],a&&f.XT)for(k=d;k<C+d;k++)f.XT(k)&&M.push(k);if(w.do("clear",d,v,C,y,o,M,r),b&&1&o&&!c&&(b.mF(d,v,C,y,!0),b.clear(d,v,C,y,w.pj(),!0)),8&o&&!(0<=t&&0<=e))if(0<=e)for(m=0;m<y;m++)f.setTag(-1,v+m,B,r);else if(0<=t)for(g=0;g<C;g++)a&&f.XT&&f.XT(d+g)||f.setTag(d+g,-1,B,r);else f.setTag(-1,-1,B,r);if(256&o&&!(0<=t&&0<=e))if(0<=e)for(m=0;m<y;m++)f.setHyperlink(-1,v+m,B,r);else if(0<=t)for(g=0;g<C;g++)a&&f.XT&&f.XT(d+g)||f.setHyperlink(-1,-1,B);if(2&o&&!(0<=t&&0<=e))if(0<=e)for(m=0;m<y;m++)f.setStyle(-1,v+m,B,r);else if(0<=t)for(g=0;g<C;g++)a&&f.XT&&f.XT(d+g)||f.setStyle(d+g,-1,B,r);else f.setStyle(-1,-1,B,r);if(32&o){if(t<0)for(m=0;m<y;m++)f.setColumnVisible(v+m,!0,r),f.setColumnResizable(v+m,!0,r),f.setColumnWidth(v+m,2===r?h.rowHeaderColWidth:h.colWidth,r);if(e<0)for(g=0;g<C;g++)a&&f.XT&&f.XT(d+g)||(f.setRowVisible(d+g,!0,r),f.setRowResizable(d+g,!0,r),f.setRowHeight(d+g,1===r?h.colHeaderRowHeight:h.rowHeight,r))}for((R(r)||3===r)&&l&&1==(1&o)&&(T=f.b3())&&T.gF(t,e,n,i),x=[],g=0;g<C;g++)for(m=0;m<y;m++)x.push({row:d+g,col:v+m});f.SI(t,e,C,y,x,2,r)}}finally{f.resumePaint(),l&&f.resumeCalcService(!1)}},K.prototype.uL=function(){var t,e,n,i,n,i,n,t=this,e,n=t.options.protectionOptions;t.isActualProtected()&&n&&(i=n.allowSelectLockedCells,n=n.allowSelectUnlockedCells,!1===i&&!1!==n||!1!==i&&!1===n)&&(i=t.ui,n=t.ci,t.JA(i,n)||(t.IA(),t.gA(i,n,!0),t.MA(4,i,n)))},K.prototype.setArray=function(i,r,t,o){var a,e,s,u,c,f,a=this,e=G;if(o=e&&o,s=D(a),u=L(a),t&&0<=i&&i<s&&0<=r&&r<u){e&&a.suspendCalcService(),a.suspendPaint();try{h(t,function(n,t){l.GC$.isArray(t)?h(t,function(t,e){f=r+t,(c=i+n)<s&&f<u&&(o?a.setFormula(c,f,e):a.setValue(c,f,e,3))}):(f=r,(c=i+n)<s&&f<u&&(o?a.setFormula(c,f,t):a.setValue(c,f,t,3)))})}finally{e&&a.resumeCalcService(!1),a.resumePaint()}}},K.prototype.getArray=function(t,e,n,i,r){var o,a,s,u,c,f,o=this,a=[],s=D(o),u=L(o);if(r=r&&G,0<=t&&t<s&&0<=e&&e<u)for(s<t+n&&(n=s-t),u<e+i&&(i=u-e),c=0;c<n;c++)for(a[c]=[],f=0;f<i;f++)a[c][f]=r?o.getFormula(t+c,e+f):o.getValue(t+c,e+f);return a},K.prototype.setTag=function(t,e,n,i){var r,o,a,s,a,s,r=this;0!==(i=R(i)?3:i)&&(a=(o=r.Ut).getRowCount(i),s=o.getColumnCount(i),t<-1||a<=t||e<-1||s<=e||(n=nt(n),a=void 0,(s=0<r.vf)||(a=r.getTag(t,e,i)),o.do("setValueForKey",t,e,u,n,i),a!==n&&(-1!==t&&-1!==e?s?r.Lj(r,[{row:t,col:e}],0):r.Rj(u,t,e,i,a,n):-1!==t&&-1===e?r.dj(t,i,u,n,a):-1===t&&-1!==e&&r.vj(e,i,u,n,a))))},K.prototype.getTag=function(t,e,n){var i,i,i=this;return 0!==(n=R(n)?3:n)?(i=i.Ut.getValueForKey(t,e,u,n),d(i)):B},K.prototype.tag=function(t){var e,n,e=this;return 0===arguments.length?(n=e.Ut.getValueForKey(-1,-1,u,3),d(n)):(e.Ut.do("setValueForKey",-1,-1,u,nt(t),3),e)},K.prototype.setAltText=function(t,e,n,i){var r,o,a,s,a,s,r=this;0!==(i=R(i)?3:i)&&(a=(o=r.Ut).getRowCount(i),s=o.getColumnCount(i),t<-1||a<=t||e<-1||s<=e||(a=void 0,(s=0<r.vf)||(a=r.getAltText(t,e,i)),o.do("setValueForKey",t,e,ht,n,i),a!==n&&-1!==t&&-1!==e&&(s?r.Lj(r,[{row:t,col:e}],0):r.Rj(ht,t,e,i,a,n))))},K.prototype.getAltText=function(t,e,n){var i=this;return 0!==(n=R(n)?3:n)?i.Ut.getValueForKey(t,e,ht,n):B},K.prototype.getParent=function(){return this.parent},K.prototype.getDirtyRows=function(){return Rt(this,!0)},K.prototype.getInsertRows=function(){return Rt(this,!1)},K.prototype.getDeletedRows=function(){var n=[],t=this.aj;return t&&h(t,function(t,e){e&&!l.GC$.isFunction(e)&&n.push({row:e.row,originalItem:e.data})}),n},K.prototype.hasPendingChanges=function(){var t,e,n,t=this,e=t.aj;return!!(e&&0<e.length)||!Xt(n=t.Ut.Fj())},K.prototype.clearPendingChanges=function(t){var e,n,i,r,o,t,e=this;R(t)||tt(t)?(e.Ut.Hj(),e.aj=[],K.et(e,"clearPendingChanges")):(n=t.row,i=t.col,r=t.rowCount,o=t.colCount,(1&(t=(t=t.clearType)||xt.dirty))===xt.dirty&&e.pF(n,i,r,o),(2&t)===xt.insert&&e.bF(n,i,r,o),(4&t)===xt.delete&&e.yF(n,i,r,o))},K.prototype.pF=function(t,e,n,i){var r=this,o=r.Ut,a=r.wF(t,e,n,i),s=r.MF(e,i);a?(o.Qj(),K.et(r,"clearPendingChanges")):o.Vj(s,t,e,n,i)},K.prototype.bF=function(t,e,n,i){var r=this,o=r.Ut,a=r.wF(t,e,n,i),r=r.MF(e,i);o.zj(a,r,t,n)},K.prototype.yF=function(n,t,i,e){var r,t,o,a,s,r=this;if(r.wF(n,t,i,e))r.aj=[];else if(r.MF(t,e)&&(t=r.aj))for(o=[],h(t,function(t,e){var e;e&&(e=e.row,n<=e)&&e<n+i&&o.push(t)}),s=(a=o.length)-1;0<=s;s--)r.aj.splice(o[s],1)},K.prototype.MF=function(t,e){return R(t)||-1===t||0===t&&this.getColumnCount()===e},K.prototype.SF=function(t,e){return R(t)||-1===t||0===t&&e===this.getRowCount()},K.prototype.wF=function(t,e,n,i){return this.MF(t,n)&&this.MF(e,i)},K.prototype.getDirtyCells=function(t,r,e,o){var a,s,u,n,i,c,f,l,a=this;if(R(t)&&(t=-1),R(r)&&(r=-1),(R(e)||e<=0)&&(e=1),(R(o)||o<=0)&&(o=1),s=[],u=a.Ut.Fj(),!tt(u)){if(n=[],0<=t)for(i=t;i<t+e;i++)n.push(i);else for(c in u)et(u,c)&&n.push(M(c));h(n,function(t,e){var n,i;if((f=u[e])&&"e"===f.rs)if(0<=r)for(n=r;n<r+o;n++)(l=f[n])&&s.push(Zt(a,e,n,l.oldValue));else for(i in f)g(i)||(l=f[i])&&s.push(Zt(a,e,M(i),l.oldValue))})}return s},K.prototype.suspendDirty=function(){this.lE++,this.Ut.Kj()},K.prototype.resumeDirty=function(){var t=this;t.lE--,t.lE<0&&(t.lE=0),t.Ut.Jj()},K.prototype.isDirtySuspended=function(){return 0<this.lE},K.prototype.Hc=function(t){this.cg(new x.Rect(0,0,0,0)),this.sF(),this.ub(t)},K.prototype.TF=function(){return this},K.prototype.uw=function(){var t,e,n,e,t,e=this.Dg(),n={top:0,left:0};return e&&e.parentElement&&(n=(0,l.GC$)(e).offset())&&(n.top+=ot.body.clientTop||0,n.left+=ot.body.clientLeft||0),n=(e=e&&e.canvasOffset)?e:n},K.prototype.hg=function(t){var e,n,i,r,o,o;t&&((e=this).xT=!1,(n=e.fg)&&e.L0(!1),i=Q("canvas"),o=(r=e.parent&&e.parent.options.enableAccessibility)?"":m().NeedCanvasSupport,(0,l.GC$)(i).attr("id",t.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(o).appendTo(t),x.Bf.Wl(i,B,e),e.fg=i,(o=e.parent)&&o.ZVe&&(o.jM(),o._An(e.options.rightToLeft),o.sC(),o.iM()),e.Cg(),e.repaint(),e.parent&&e.parent.nb(),K.et(e,"setHost",(0,l.GC$)(i)))},K.prototype.AF=function(t,n,e,i,r,o,a,s,u){for(var c,f,l,h,d,v,c=this,f=c.getActiveRowIndex(),l=c.getActiveColumnIndex(),h=function(t,e){return f===n&&e===l?c._ue(t):t},d=e;d<i;d++)v=h(c.getText(n,d,u),d),t.push('"'+v+'"');for(d=r;d<o;d++)v=h(c.getText(n,d,u),d),t.push('"'+v+'"');for(d=a;d<s;d++)v=h(c.getText(n,d,u),d),t.push('"'+v+'"')},K.prototype.t2=function(t){var e,n,i,r,t,o,a,s,u,e=this,n=e.ui,i=e.ci,r=P.SheetArea.viewport;return!t||R(t.row)||R(t.col)||(n=t.row,i=t.col,r=t.hitTestType),t=m(),o="",a=e.getText(n,i,r),r===P.SheetArea.rowHeader?o=t.ARIA_RowHeader+" ":r===P.SheetArea.colHeader?o=t.ARIA_ColumnHeader+" ":!R(r)&&r!==P.SheetArea.viewport||(s=e.getFormula(n,i),u=e.comments&&e.comments.get(n,i)),o+e.N6(n,i,r,a,s,u&&u.text())},K.prototype.N6=function(t,e,n,i,r,o){var a,s,u,c,f,l,f,i,u,a=m(),s=a.ARIA_Cell+" "+x.util.Vf(e+1)+(t+1)+" ",u=this.getAltText(t,e,n);return u?(0<=u.indexOf(c="{value}")&&((f=this.getValue(t,e,n))instanceof Date&&(f=f.toLocaleString()),u=u.replace(/\{value\}/g,f)),s+=u=0<=u.indexOf(l="{formatted}")?u.replace(/\{formatted\}/g,i):u):(f="",R(i)||""===i||(f=v.I5(a.ARIA_HasValue,[i])+", "),u=void 0,(i=this.l0(t,e,"cellType",n))&&("5"===i.typeName?(u=i.SG(this.getValue(t,e,n)),f=v.I5(a.ARIA_HasCheckbox,[u])+", "):"6"===i.typeName?(u=i.text(),f=v.I5(a.ARIA_HasButton,[u])+", "):"8"===i.typeName&&(u=i.text(),f=v.I5(a.ARIA_HasHyperlink,[u])+", ")),s+=f,R(r)||(s+=v.I5(a.ARIA_HasFormula,[r])+", "),R(o)||(s+=v.I5(a.ARIA_HasComment,[o]))),this._ue(s)},K.prototype._ue=function(t){return this.Eue&&(t=this.Eue+" "+t),t=this.jue?t+" "+this.jue:t},K.prototype.setAccessibilityPrefixSuffixContent=function(t,e){this.Eue=t,this.jue=e},K.prototype.Cg=function(){var t,e,n,i,n,r,r,i,n,r,t=this,e=t.Dg();e&&e.parentNode&&(i=(n=getComputedStyle(e.parentNode)).width,n=n.height,0<(r=i.indexOf("px"))&&(i=i.substring(0,r)),0<(r=n.indexOf("px"))&&(n=n.substring(0,r)),r=M(i),i=M(n),g(r)&&(r=(0,l.GC$)(e.parentNode).width()),g(i)&&(i=(0,l.GC$)(e.parentNode).height()),0!==r)&&0!==i&&(n=U(r,0),r=U(i,0),e.style.display="none",e.style.display="",e.width=n,e.height=r,e.style.width=n+"px",e.style.height=r+"px",n=e.clientWidth||e.width,r=e.clientHeight||e.height,t.kg.width=n,t.kg.height=r,x.Bf.$l(e,n,r),t.invalidateLayout())},K.prototype.destroy=function(){this.L0(!0)},K.prototype.L0=function(t,e){this.v9e(t,e)},K.prototype.v9e=function(t,e,n){var i,e,r,r,i=this;!0!==i.xT&&(x.Bf.eh(i),i.isEditing&&i.isEditing()&&i.l6(i.ui,i.ci,P.SheetArea.viewport,void 0,void 0,void 0,void 0,!1),K.et(i,"dispose",{clearCache:t,isSheetDestroy:!0,hasActiveSheet:e}),(e=i.fg)&&((r=e.parentNode)&&r.removeChild(e),x.Lf.d5(e),i.fg=B),i.NF(),i.Ut&&i.Ut.L0(t),!1===t&&!n||i.VTe().d5(),!1!==t)&&(i.xT=!0,(r=i.lA)&&r.L0(),i.parent=B,i.Ut=B,i.Jt&&(i.Jt.L0(),i.Jt=B),i.MC&&(i.MC.L0(),i.MC=B),i.g9e&&(i.g9e.L0(),i.g9e=B),x.hi.A1(i)&&x.hi.F1(B,!0),i.bM&&(i.bM.c5(),i.bM=B),i.$L=B,i.nF=B)},K.prototype.NF=function(){var t=this.kF;t&&((0,l.GC$)(t).remove(),this.kF=N)},K.prototype.mL=function(t,e,n,i,r){var o,a,s,u,c,c,c,f,l,f,c,l,i,u,i,o,i,u,h;return void 0===r&&(r={}),a=(o=this).options,s=o.Ut,0===n||(R(n)&&(n=3),!(u=Z(r.rowSpacingIndex))&&3===n&&this.S6&&(c=(c=this.Uw&&this.Uw(n))&&c.t8.getAnchorInfo(t,e))&&c.isValid&&(t!==c.row||e!==c.col))?B:(u||this.loading||!(c=G&&this.b3(n))||!(f=c.getCalcService()).calcOnDemand||f.incrementalCalculation||f.IsSuspended()||0!==f.calculationMode||(l=c.oT(t,e))&&!0===l.k1&&(f.b_t(l,0),c.recalculateCell(l),this.Uw()._F()),f=s.getValue(t,e,n,this.loading,i,r),f=d(f),u||(c=void 0,1===n?(l=s.getRowCount(n),R(f)&&((i=o.H3)&&i._dataSource&&(u=o.Ut.q_(!1,3,e),i=a.colHeaderAutoTextIndex,u)&&(0<=i&&t===i||-1===i&&t===l-1)&&(f=u.displayName||u.name),R(f))&&t===(c=(c=a.colHeaderAutoTextIndex)<0||l<=c?l-1:c)&&(2===(o=a.colHeaderAutoText)?f=x.util.Vf(e+1):1===o&&(f=e+1))):2===n&&R(f)&&(i=s.getColumnCount(n),e===(c=(c=a.rowHeaderAutoTextIndex)<0||i<=c?i-1:c))&&(2===(u=a.rowHeaderAutoText)?f=x.util.Vf(t+1):1===u&&(f=t+1)),!(h=r.realValue)&&"number"==typeof f&&p&&p.ExcelCompatibleCalcMode&&(f=w.Common.st.E8(f,15))),f)},K.prototype.JS=function(t,e){var n,i,r,o,a,t,s,i;return R(e)&&(e=3),n=(0,x.Ec)(-1,-1,-1,-1),t&&(r=t.row,o=t.col,a=t.rowCount,t=t.colCount,s=(i=this).getRowCount(e),i=i.getColumnCount(e),-1===o&&(o=0,t=i),-1===r&&(r=0,a=s),n.col=o,n.row=r,n.colCount=H(U(i-o,0),t),n.rowCount=H(U(s-r,0),a)),n},K.prototype.getRangeRect=function(t,e,n){var i,r,o,a,s,u,n,c,f,l,h,n,d,v,g,m,p,S,w,b,C,i=new x.Rect(-1,-1,-1,-1),r=this,o=r.Fi(),a=r.C6(t,e);return 0!==o.width&&0!==o.height&&(s=r._y(t,a),(u=r.Yy(e,a))&&0!==u.length&&s&&0!==s.length)&&(n=r.JS(n),c=r.Jt,f=n.row,l=n.row+n.rowCount-1,h=n.col,n=n.col+n.colCount-1,d=Y(r),v=D(r)-O(r)-1,g=V(r),m=L(r)-j(r)-1,p=u[0].col,S=u[u.length-1].col,w=s[0].row,b=s[s.length-1].row,C=r.options.rightToLeft,h<p&&(h=y(p,h),C)&&(h=U(h,r.getViewportLeftColumn(e))),S<n&&(n=M(S,n),C)&&(n=H(n,r.getViewportRightColumn(e))),f<w&&(f=k(w,f)),b<l&&(l=T(b,l)),n<h||l<f||(0===e?h<g&&(C?(i.x=o.b6+o.F6-_(c,r.wve(),h-1),i.width=_(c,h,n),i.x-=i.width):(i.x=o.b6+_(c,r.wve(),h-1),i.width=_(c,h,n))):1===e||-1===e?h<=m&&g<=n&&(C?(i.x=h<p?u[0].x+u[0].width+_(c,h,p-1,a):u[0].x+u[0].width-_(c,p,h-1,a),i.width=_(c,h,n,a),i.x-=i.width):(i.x=h<p?u[0].x-_(c,h,p-1,a):u[0].x+_(c,p,h-1,a),i.width=_(c,h,n,a))):2===e&&m<n&&(C?(i.x=h<p?o.Hy+o.zy+_(c,h,p-1):o.Hy+o.zy-_(c,p,h-1),i.width=_(c,h,n),i.x-=i.width):(i.x=h<p?o.Hy-_(c,h,p-1):o.Hy+_(c,p,h-1),i.width=_(c,h,n))),0===t?f<d&&(i.y=o.T6+A(c,r.Mve(),f-1),i.height=A(c,f,l)):1===t||-1===t?f<=v&&d<=l&&(f<w?(i.y=s[0].y-A(c,f,w-1,a),r.FCn&&(i.y-=Nt(c,f,w-1),i.y+=c.Mf.PCn(f),i.y-=c.Mf.PCn(w))):(i.y=s[0].y+A(c,w,f-1,a),r.FCn&&(i.y+=Nt(c,w,f-1),w<f)&&(i.y-=c.Mf.PCn(w),i.y+=c.Mf.PCn(f))),i.height=A(c,f,l,a),r.FCn)&&(i.height+=Nt(c,f,l),i.height-=c.Mf.PCn(f),i.height-=c.Mf.PCn(l,!0)):2===t&&v<l&&(i.y=f<w?o.Ay-A(c,f,w-1):o.Ay+A(c,w,f-1),i.height=A(c,f,l)))),i;function y(t,e){for(;e<t;)if(r.getColumnVisible(--t))return t;return t}function M(t,e){for(;t<e;)if(r.getColumnVisible(++t))return t;return t}function k(t,e){for(;e<t;)if(r.getRowVisible(--t))return t;return t}function T(t,e){for(;t<e;)if(r.getRowVisible(++t))return t;return t}},K.prototype.isIntersectWithArrayFormula=function(t){var e,n,i,e=G&&this.b3();if(e)for(n=t.row;n<t.row+t.rowCount;n++)for(i=t.col;i<t.col+t.colCount;i++)if(e.EF(n,i,1,1))return!0;return!1},K.prototype.setRangeActiveCells=function(t,e,n){this.XA(t,e,n),this.repaint()},K.prototype.j1=function(t,e){var n,i,r,t,o,a,s,u,c,f,l,h,t,d,v,g,m,p,o,s,n=this,i=new x.Rect(-1,-1,-1,-1),r=n.Fi();if(0!==r.width&&0!==r.height){if(t=n.JS(t,e),o=V(n),a=Y(n),s=j(n),u=O(n),c=n.Jt,f=t.row,l=t.row+t.rowCount-1,h=t.col,t=t.col+t.colCount-1,d=D(n,e),v=L(n,e),p=n.options.rightToLeft,h<o)i.x=p?r.b6+r.F6-_(c,n.wve(),h-1,e):r.b6+_(c,n.wve(),h-1,e),i.width=_(c,h,H(t,o-1),e),o<=t&&t<v-s?(g=n.yw(1))&&0<g.length&&(i.width+=_(c,g[0].col,H(t,g[g.length-1].col),e)+n.my):v-s<=t&&(g=n.yw(2))&&0<g.length&&(i.width=p?i.x-(g[0].x+g[0].width):g[0].x-i.x,i.width+=_(c,v-s,H(t,v-1),e)),p&&(i.x-=i.width);else if(h<v-s){if(!(g=n.yw(1))||0===g.length||h>g[g.length-1].col||t<g[0].col)return i;i.x=p?r.b6-_(c,g[0].col,h-1,e)-n.my:r.Py+_(c,g[0].col,h-1,e)+n.my,o<=t&&t<v-s?i.width=_(c,U(h,g[0].col),H(t,g[g.length-1].col),e):v-s<=t&&(g=n.yw(2))&&0<g.length&&(i.width=p?i.x-(g[0].x+g[0].width):g[0].x-i.x,i.width+=_(c,v-s,H(t,v-1),e)),p&&(i.x-=i.width)}else h<v&&((g=n.yw(2))&&0<g.length&&(i.x=p?r.Hy+r.zy-_(c,g[0].col,h-1,e):r.Hy+_(c,g[0].col,h-1,e),i.width=_(c,h,H(t,v-1),e)),p)&&(i.x-=i.width);if(f<a)i.y=r.T6+A(c,n.Mve(),f-1,e),i.height=A(c,f,H(l,a-1),e),a<=l&&l<d-u?(m=n.dw(1))&&0<m.length&&(i.height+=A(c,m[0].row,H(l,m[m.length-1].row),e)+n.ly):d-u<=l&&(m=n.dw(2))&&0<m.length&&(i.height=m[0].y-i.y,i.height+=A(c,d-u,H(l,d-1),e));else if(f<d-u){if(!(m=n.dw(1))||0===m.length||f>m[m.length-1].row||l<m[0].row)return i;i.y=r.Cy+A(c,m[0].row,f-1,e)+n.ly,n.FCn&&(i.y+=Nt(c,m[0].row,f-1),f>m[0].row?i.y+=c.Mf.PCn(f):f===m[0].row&&(i.y+=c.Mf.PCn(m[0].row))),a<=l&&l<d-u?(o=U(f,m[0].row),s=H(l,m[m.length-1].row),i.height=A(c,o,s,e),n.FCn&&(i.height+=Nt(c,o,s),f>m[0].row&&(i.height-=c.Mf.PCn(o)),l<m[m.length-1].row)&&(i.height-=c.Mf.PCn(s,!0))):d-u<=l&&(m=n.dw(2))&&0<m.length&&(i.height=m[0].y-i.y,i.height+=A(c,d-u,H(l,d-1),e))}else f<d&&(m=n.dw(2))&&0<m.length&&(i.y=r.Ay+A(c,m[0].row,f-1,e),i.height+=A(c,f,H(l,d-1),e))}return i},K.prototype.Dg=function(){return this.fg},K.prototype.Gi=function(t,e){return this.Qt(t,e)+1},K.prototype.Qt=function(t,e){var n="",i=this.Dn,n=e||i._n(i.Nn());return x.q.Wt(t,n)},K.prototype.PL=function(t){var e,n,i,r,e,o,a,e=this,n=e.Fi(),i=B,r=n.Py,e=e.Gy(n),o=n.Hy,a=n.zy;return n.BA<t&&t<n.BA+n.XC?i=-1:n.b6<t&&t<n.b6+n.F6?i=0:r<t&&t<r+e?i=1:o<t&&t<o+a&&(i=2),i},K.prototype.FL=function(t){var e,n,i,r,o,a,s,e=this,n=e.Fi(),i=B,r=n.Cy,o=e.Sy(n),a=n.Ay,s=n.Iy;return e.m9e&&e.m9e(t)?i=3:n.LA<t&&t<n.LA+n.qC?i=-1:n.T6<t&&t<n.T6+n.L6?i=0:r<t&&t<r+o?i=1:a<t&&t<a+s&&(i=2),i},K.prototype.p9e=function(t,e){var e,e=-1===e?this.jF():this.dw(e);if(e)return e.findY(t)},K.prototype.GL=function(t,e){var t=this.p9e(t,e);if(t)return t.row},K.prototype.UL=function(t,e,n,i,r){var e,o,a,e=-1===e?this.OF():-1===i?this.BF(e):this.yw(e);if(e)return a=void 0,(a=-1!==i||R(r)?e.findX(t):(o=this.jF().findRow(r),e.findXByExactY(t,n,o)))||e[0]&&(a=(e=this.Dn.VO(e[0].col,e[0].x))?-1!==i||R(r)?e.findX(t):e.findXByExactY(t,n,o):a)?a.col:void 0},K.prototype.pD=function(t,e){var n,i,t,r,r,o,t,e,n=t.YL;return n!==t.col||(r=t.colViewportIndex,o=t.y,t=t.row,r=(i=this).BF(r),t=this.jF().findRow(t),e===n&&(n=i.O5(n,1)),(e=r.findCol(n))&&o<e.y*t.height+t.y)},K.prototype.HO=function(t,e){var n=this;return n.ui<=t&&t<n.ui+n.H5&&n.ci<=e&&e<n.ci+n.z5},K.prototype.T9=function(t){return this.Ut.T9(t)},K.prototype.S9=function(t){return this.Ut.S9(t)},K.prototype.ni=function(t,e,n,i){var r,o,r,r=this,o=D(r),r=L(r);return this.Ut.ni(t,e,n,o,r,i)},K.prototype.ei=function(t,e,n){var i,r,i,i=this,r=D(i),i=L(i);return this.Ut.ei(t,e,n,r,i)},K.prototype.zO=function(t,e,n){var i,r,o,a,s,u,c,s,i=this,s=i.sw;if(s&&!s.resizeInfo&&!R(n)){if(u=s.hitTestType,c=s.row,s=s.col,1===n)return r=!1,(o=!(o=i.Ut.findSpan(c,s,1))&&i.Cb?i.Cb.D7(c,s,1):o)&&(r=o.contains(t,e,1,1)),a=t===c&&e===s||r,u===n&&a;if(2===n)return r=!1,(o=!(o=i.Ut.findSpan(c,s,2))&&i.Cb?i.Cb.D7(c,s,2):o)&&(r=o.contains(t,e,1,1)),a=t===c&&e===s||r,u===n&&a;if(3===n)return u===n&&t===c&&e===s;if(0===n)return u===n}return!1},K.prototype.C6=function(t,e){return 0<=t&&t<=2&&0<=e?3:(0<=t&&t<=2||3===t)&&e<0?2:t<0&&0<=e?1:t<0&&e<0?0:B},K.prototype.Zg=function(t){var e=this.rt;e&&e.Zg(t)},K.prototype.qc=function(){var t,e,e,t,t=this,e=t.parent,e=e&&e.Ti;return e=e||(t=t.fg)&&t.parentElement},K.prototype.cF=function(){var t,e,n,i,r,t=this,e=0,n=0,i=1,r=1;t.ui=0,t.ci=0,t.H5=1,t.z5=1,t.qA=0,t.hR=0},K.prototype.Gt=function(t,e,n){!R(e)&&isNaN(e)&&(e=N);var i=this,t=i.getRowHeight(t,e),e=i.zoom();return 1!==e&&(t*=e),n?t:st(t)},K.prototype.nn=function(t,e,n){!R(e)&&isNaN(e)&&(e=N);var i=this,t=i.getColumnWidth(t,e),e=i.zoom();return 1!==e&&(t*=e),n?t:st(t)},K.prototype.LF=function(){var i,r,t,o,e,n,e,a,s,t,n,u,e,c,f,l,h,d,v,g,m,p,e,S,w,b,e,C,y,M,k,S,i=this,r=i.options.rightToLeft,t=i.ot(),o=i.options,e=o.sheetAreaOffset.left,n=o.sheetAreaOffset.top,e=new x.Rect(t.x+e,t.y+n,U(0,t.width-e),U(0,t.height-n)),a=e.width,s=e.height,t=Et(i),n=Ht(i),u={x:e.x,y:e.y,width:e.width,height:e.height,XC:0,qC:0,F6:0,L6:0,zy:0,Iy:0,D6:0,FF:0,PF:0,GF:0,b6:0,T6:0,Hy:0,Ay:0,Py:0,Cy:0,A6:0,hL:0,J7:0,X7:0,Ty:0,Uy:0,BA:0,LA:0,b9e:e.y,w9e:e.x,XAe:function(){var t,e,n,t=this;return At(o)?(e=Lt(i),(n=0<j(i))?r?new x.Rect(t.Hy-e,t.b9e,e,t.qC-t.b9e):new x.Rect(t.Hy+t.zy,t.b9e,e,t.y+t.qC-t.b9e):r?new x.Rect(t.Py-e,t.b9e,e,t.qC-t.b9e):new x.Rect(t.Py+t.hL,t.b9e,e,t.y+t.qC-t.b9e)):B},$Te:function(){var t,e,n,t=this;return At(o)?(e=Lt(i),(n=0<j(i))?r?new x.Rect(t.Hy-e,t.y,e,t.qC):new x.Rect(t.Hy+t.zy,t.y,e,t.qC):r?new x.Rect(t.Py-e,t.y,e,t.qC):new x.Rect(t.Py+t.hL,t.y,e,t.qC)):B},qAe:function(){var t,e,n,t=this;return Dt(o)?(e=jt(i),(n=0<O(i))?r?new x.Rect(t.w9e,t.Ay+t.Iy,t.XC,e):new x.Rect(t.w9e,t.Ay+t.Iy,t.x+t.XC-t.w9e,e):r?new x.Rect(t.w9e,t.Cy+t.A6,t.XC,e):new x.Rect(t.w9e,t.Cy+t.A6,t.x+t.XC-t.w9e,e)):B},t9e:function(){var t,e,n,t=this;return Dt(o)?(e=jt(i),(n=0<O(i))?r?new x.Rect(t.w9e,t.Ay+t.Iy,t.XC,e):new x.Rect(t.x,t.Ay+t.Iy,t.XC,e):r?new x.Rect(t.w9e,t.Cy+t.A6,t.XC,e):new x.Rect(t.x,t.Cy+t.A6,t.XC,e)):B},R1:function(){var t=this;return r?new x.Rect(t.x+t.width-t.XC,t.y,t.XC,t.qC):new x.Rect(t.x,t.y,t.XC,t.qC)},L1:function(t){var e=this;return 0===t?new x.Rect(e.b6,e.y,e.F6,e.qC):1===t?new x.Rect(e.Py,e.y,i.Gy(e),e.qC):2===t?new x.Rect(e.Hy,e.y,e.zy,e.qC):B},B1:function(t){var e=this;return 0===t?r?new x.Rect(e.x+e.width-e.XC,e.T6,e.XC,e.L6):new x.Rect(e.x,e.T6,e.XC,e.L6):1===t||3===t?r?new x.Rect(e.x+e.width-e.XC,e.Cy,e.XC,i.Sy(e)):new x.Rect(e.x,e.Cy,e.XC,i.Sy(e)):2===t?r?new x.Rect(e.x+e.width-e.XC,e.Ay,e.XC,e.Iy):new x.Rect(e.x,e.Ay,e.XC,e.Iy):B},c9:function(t,e){var n=this;if(0===t){if(0===e)return new x.Rect(n.b6,n.T6,n.F6,n.L6);if(1===e)return new x.Rect(n.Py,n.T6,i.Gy(n),n.L6);if(2===e)return new x.Rect(n.Hy,n.T6,n.zy,n.L6)}else if(1===t||3===t){if(0===e)return new x.Rect(n.b6,n.Cy,n.F6,i.Sy(n));if(1===e)return new x.Rect(n.Py,n.Cy,i.Gy(n),i.Sy(n));if(2===e)return new x.Rect(n.Hy,n.Cy,n.zy,i.Sy(n))}else if(2===t){if(0===e)return new x.Rect(n.b6,n.Ay,n.F6,n.Iy);if(1===e)return new x.Rect(n.Py,n.Ay,i.Gy(n),n.Iy);if(2===e)return new x.Rect(n.Hy,n.Ay,n.zy,n.Iy)}return B}};if(i.gj&&((c=0)<(e=i.gj()).width&&(r?u.width-=e.width+0:u.x+=e.width+0,a-=e.width+0),0<e.height)&&(u.y+=e.height+0,s-=e.height+0),o.rowHeaderVisible){for(d=i.getColumnCount(2),h=v=0;h<d;h++)v=i.nn(h,2),u.XC+=v;u.w9e=r?u.x+u.width-v:u.x+u.XC-v}else r&&(u.w9e=u.x+u.width-u.XC);if(o.colHeaderVisible){for(l=i.getRowCount(1),f=g=0;f<l;f++)g=i.Gt(f,1),u.qC+=g;u.b9e=u.y+u.qC-g}if(0<(m=V(i)))for(d=L(i),h=i.wve();h<m&&h<d;h++)i.getColumnVisible(h)&&(u.F6+=i.nn(h));if(0<(p=Y(i)))for(l=D(i),f=i.Mve();f<p&&f<l;f++)i.getRowVisible(f)&&(u.L6+=i.Gt(f));if(0<(e=j(i))){for(d=L(i),h=U(m,d-e);h<d;h++)u.zy+=i.nn(h);n&&At(o)&&(a-=Lt(i))}if(0<(S=O(i))){for(l=D(i),f=U(p,l-S);f<l;f++)u.Iy+=i.Gt(f);t&&Dt(o)&&(s-=jt(i))}if(u.BA=r?u.x+u.width-u.XC:u.x,u.LA=u.y,u.b6=r?u.x+u.width-u.XC-u.F6:u.BA+u.XC,u.T6=u.LA+u.qC,u.Py=r?u.x+u.zy:u.b6+u.F6,u.Cy=u.T6+u.L6,a=(a=a-u.XC-u.F6)-u.zy-u.Uy,s=(s=(s-=u.qC)-u.L6-u.Iy)-u.Ty-u.D6,l=D(i),(w=0)<(b=(d=L(i))-e))for(w+=i.my,h=U(m,i.Ab);h<b&&w<a;h++)w+=i.nn(h);if(w<(e=U(0,a))?(u.Uy=e-w,e=u.hL=w):u.hL=e,(C=0)<(y=l-S))for(C+=i.ly,f=U(p,i.Tb);f<y&&C<s;f++)(M=this.FCn&&this.FCn(f))&&(C+=i.PCn(f)),C+=i.Gt(f),(k=this.FCn&&this.FCn(f,!0))&&(C+=i.PCn(f,!0));return C<(S=U(0,s))?(u.Ty=S-C,S=u.A6=C):u.A6=S,u.Hy=r?u.x:u.Py+e,u.Ay=u.Cy+S,n?r?(u.J7=u.x+u.width-u.XC-u.F6-u.hL-u.Uy,u.Py+=u.Uy,At(o)&&(0<u.zy&&(u.Py+=Lt(i)),u.Hy+=Lt(i))):(u.J7=u.Py+u.hL,u.Hy+=u.Uy):r?(u.J7=u.x,u.Hy=u.J7+u.Uy,u.Py+=u.Uy):u.J7=u.Hy+u.zy,t?(u.X7=u.Cy+u.A6,u.Ay+=u.Ty):u.X7=u.Ay+u.Iy,u.PF=u.BA,u.GF=u.y+u.height-u.D6,u},K.prototype.Fi=function(){var t=this;return t.eF||(t.eF=t.LF()),t.eF},K.prototype.Yy=function(t,e){return R(e)||3===e?this.yw(t):2===e?this.OF():1===e?1!==this.getRowCount(P.SheetArea.colHeader)?this.yw(t):this.BF(t):B},K.prototype.yfe=function(t,e){return R(e)||3===e?this.yw(t):2===e?this.OF():1===e?1!==this.getRowCount(P.SheetArea.colHeader)?this.yw(t):this.wfe(t):B},K.prototype.OF=function(){var t=this;return t.iF.rowHeader||(t.iF.rowHeader=t.UF()),t.iF.rowHeader},K.prototype.yw=function(t){var e=this;return e.iF.viewport||(e.iF.viewport={}),e.iF.viewport[t]||(e.iF.viewport[t]=e.HF(t)),e.iF.viewport[t]},K.prototype.BF=function(t){var e=this;return e.iF.colHeader||(e.iF.colHeader={}),e.iF.colHeader[t]||(e.iF.colHeader[t]=e.zF(t)),e.iF.colHeader[t]},K.prototype.wfe=function(t){var e=this;return e.iF.colHeaderWithStack||(e.iF.colHeaderWithStack={}),e.iF.colHeaderWithStack[t]||(e.iF.colHeaderWithStack[t]=e.Mfe(t)),e.iF.colHeaderWithStack[t]},K.prototype.UF=function(){for(var t,e,n,i,r,o,a,t=new E.h9,e=this.Fi(),n,i=this.options.rightToLeft?e.x+e.width-e.XC:e.BA,o=this.getColumnCount(2),a=0;a<o;a++)r=this.nn(a,2),t.push(new E.W8(-1,a,i,-1,r,-1)),i+=r;return t},K.prototype.HF=function(t){var e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,e=this,n=this.options.rightToLeft,i=new E.h9,r=e.Fi(),o=L(e),c=e.Jt,f=V(e),l=j(e);if(0===t)for(s=n?r.BA:r.b6,o=H(f,o),a=e.wve();a<o;a++)u=c.Kt(a),(h=new E.W8(-1,a,s,-1,u,-1)).offsetX=e.getColumnScrollOffsetX(a),i.push(h),n?(h.x-=u,s-=u):s+=u;else if(1===t)for(d=Ht(e),v=e.my,s=n?r.x+r.width-r.XC-r.F6-v:r.Py+v,o=d?o-l:o,g=e.Gy(r)-v,a=m=U(f,e.Ab);0<g&&a<o;a++)u=c.Kt(a),(h=new E.W8(-1,a,s,-1,u,-1)).offsetX=e.getColumnScrollOffsetX(a),i.push(h),n?(h.x-=u,s-=u):s+=u,g-=u;else if(2===t)for(s=n?r.Hy+r.zy:r.Hy,a=U(f,o-l);a<o;a++)u=c.Kt(a),(h=new E.W8(-1,a,s,-1,u,-1)).offsetX=e.getColumnScrollOffsetX(a),i.push(h),n?(h.x-=u,s-=u):s+=u;return i},K.prototype.zF=function(t){var e,n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,S,e=this,n=this.options.rightToLeft,i=new E.h9,r=e.Fi(),o=L(e),c=e.Jt,f=V(e),l=j(e),h=e.Ut,d=[],v=[],g=[],m=[];if(0===t)for(s=n?r.BA:r.b6,o=H(f,o),a=e.wve();a<o;a++)d[a]=u=c.Kt(a),v[a]=h.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a),g[a]=h.eE(-1,a,-1,1,P.SheetArea.colHeader),p=e.ZO(a,s,o,0,d,v,g,m),m[a]=p,i.push(p),n?(p.x-=u,s-=u):s+=u;else if(1===t){for(S=Ht(e),w=e.my,s=n?r.x+r.width-r.XC-r.F6-w:r.Py+w,o=S?o-l:o,b=e.Gy(r)-w,M=void 0,k=(y=C=U(f,e.Ab))-1;0<=k;k--)if(d[k]=M=c.Kt(k),M){if(v[k]=h.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,k),v[k]===P.ColumnHeaderFitMode.normal)break;y=k}for(a=y;0<b&&a<o;a++)d[a]||(d[a]=c.Kt(a)),R(v[a])&&(v[a]=h.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a)),u=d[a],g[a]=h.eE(-1,a,-1,1,P.SheetArea.colHeader),p=e.ZO(a,s,o,C,d,v,g,m),m[a]=p,C<=a&&(i.push(p),n?(p.x-=u,s-=u):s+=u,b-=u);b<=0&&a<o&&2===h.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a-1)&&(S=e.ZO(a,s,o,C,d,v,g,m),m[a]=S,i.push(S))}else if(2===t)for(s=n?r.Hy+r.zy:r.Hy,a=C=U(f,o-l);a<o;a++)d[a]=u=c.Kt(a),v[a]=h.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a),g[a]=h.eE(-1,a,-1,1,P.SheetArea.colHeader),p=e.ZO(a,s,o,C,d,v,g,m),m[a]=p,i.push(p),n?(p.x-=u,s-=u):s+=u;return i},K.prototype.Mfe=function(t){var o,e,n,i,r,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,y,x,G,B,M,y,I,o=this,e=this.options.rightToLeft,n=new E.h9,i=o.Fi(),r=L(o),u=o.Jt,c=V(o),f=j(o),l=o.Ut,h=[],d=[],v=[],g=[],m=function(t){for(var e,n,i,r,i,o,e=0,n=t,r=t-1;0<=r;r--)if(h[r]=i=u.Kt(r),i){if(d[r]=l.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,r),(i=d[r]!==P.ColumnHeaderFitMode.normal)||(d[o=r-1]=l.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,o),i=d[o]!==P.ColumnHeaderFitMode.normal),!i)break;e+=h[n=r]}return{leftOutsideWidth:e,Cfe:n}},p=function(t,e,n,i){var r,n;return h[e]||(h[e]=u.Kt(e)),r=h[e],v[e]=l.eE(-1,e,-1,1,P.SheetArea.colHeader),n=o.ZO(e,n,i,t,h,d,v,g),{colLayout:g[e]=n,colWidth:r}};if(0===t)for(s=e?i.BA:i.b6,S=H(c,r),a=o.wve();a<r&&(d[a]=l.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a),!(S<=a&&2!==d[a]&&2!==d[a-1]));a++)b=(w=p(0,a,s,r)).colLayout,C=w.colWidth,a<S||(b.isOutside=!0),n.push(b),e?(b.x-=b.width,b.x<i.b6&&(b.x=i.b6),s-=C):s+=C;else if(1===t){for(y=Ht(o),M=o.my,s=e?i.x+i.width-i.XC-i.F6-M:i.Py+M,S=y?r-f:r,k=o.Gy(i)-M,s-=x=(y=m(T=U(c,o.Ab))).leftOutsideWidth,a=G=y.Cfe;a<r&&(R(d[a])&&(d[a]=l.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a)),!(k<=0||S<=a)||2===d[a]||2===d[a-1]);a++)b=(B=p(T,a,s,r)).colLayout,C=B.colWidth,T<=a&&0<k?(n.push(b),e?(b.x-=b.width,s-=C):s+=C,k-=C):(b.isOutside=!0,n.push(b),s+=C);k<=0&&a<r&&2===l.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a-1)&&(M=o.ZO(a,s,r,T,h,d,v,g),g[a]=M,n.push(M))}else if(2===t)for(s=e?i.Hy+i.zy:i.Hy,s-=x=(y=m(T=U(c,r-f))).leftOutsideWidth,a=G=y.Cfe;a<r;a++)d[a]=l.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,a),b=(I=p(T,a,s,r)).colLayout,C=I.colWidth,T<=a||(b.isOutside=!0),n.push(b),e?(b.x-=b.width,s-=C):s+=C;return n},K.prototype.ZO=function(t,e,n,i,r,o,a,s){var u,c,f,l,h,d,v,g,m,p,p,S,w,b,b,C,y,m,M,k,T,k,x,G,B,I,o,u=this,c=u.Ut,f=u.Jt,l=t,h=-1,d=-1,v=o[t],g=r[t],m=a[t],p=u.NMi,p=p&&p.options&&p.options.defaultStackRowHeight;if(v!==P.ColumnHeaderFitMode.normal&&!c.e7(t)&&!m&&!c.eE(-1,t+1,-1,1,P.SheetArea.colHeader))for(v===P.ColumnHeaderFitMode.stack&&(g+=f.Kt(l=t+1));(c.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,l)!==P.ColumnHeaderFitMode.normal||!f.Kt(l))&&l<n-1&&!c.eE(-1,l+1,-1,1,P.SheetArea.colHeader);){if((S=c.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,l))===P.ColumnHeaderFitMode.vertical&&f.Kt(l)){if(v===P.ColumnHeaderFitMode.vertical)break;if(w=u.O5(l,P.SheetArea.viewport),b=u.r6(l,P.SheetArea.viewport,!0),b=c.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,b),C=c.getColumnHeaderFitMode(!1,P.SheetArea.colHeader,w),!(b!==P.ColumnHeaderFitMode.normal&&C!==P.ColumnHeaderFitMode.normal&&w<n)||c.eE(-1,w+1,-1,1,P.SheetArea.colHeader))break}l++,g+=f.Kt(l)}for(l=t-1;i<=l&&!r[l]&&!a[l];)l--;return y=u.Ut.o7(t),(m=o[l])!==P.ColumnHeaderFitMode.normal&&r[l]&&!a[l]&&!a[t]&&y<=l?((M=s[l])===N&&(k=e-u.nn(l),M=s[l]=u.ZO(l,k,n,i,r,o,a,s)),m===P.ColumnHeaderFitMode.stack?(k=(T=function(t){for(var e=u.r6(t,P.SheetArea.viewport,!0);y<=e&&u.Lt(e)===P.ColumnHeaderFitMode.stack;)e=u.r6(e,P.SheetArea.viewport,!0);return!!(y<=e&&u.Lt(e)!==P.ColumnHeaderFitMode.normal&&s[e||0]&&-1!==s[e||0].y)&&s[e||0]})(t),h=R(p)?(G=c.r7(t))/(B=c.n7(t)):(h=p*(x=c.r7(t,N,!0))/u.defaults.colHeaderRowHeight,H(h,1)),k&&R(p)?h=1-(d=(1-h)*(I=0<k.height?k.height:1)):d=1-h):m===P.ColumnHeaderFitMode.vertical&&(v!==P.ColumnHeaderFitMode.normal?(h=M.y,d=M.height):h=d=-1)):h=d=-1,(o=new E.W8(-1,t,e,h,g,d)).offsetX=u.getColumnScrollOffsetX(t),o},K.prototype._y=function(t,e){return R(e)||3===e||2===e?this.dw(t):1===e?this.jF():B},K.prototype.d9=function(t){for(var e,n,i,e=new E.h9,n=0;n<3;n++)(i=this._y(n,t))&&0<i.length&&(e=l.GC$.merge(e,i));return e},K.prototype.m9=function(t){for(var e,n,i,e=new E.h9,n=0;n<3;n++)(i=this.Yy(n,t))&&0<i.length&&(e=l.GC$.merge(e,i));return e},K.prototype.jF=function(){var t=this;return t.N8.colHeader||(t.N8.colHeader=t.VF()),t.N8.colHeader},K.prototype.dw=function(t){var e=this;return e.N8.viewport||(e.N8.viewport={}),e.N8.viewport[t]||(e.N8.viewport[t]=e.YF(t)),e.N8.viewport[t]},K.prototype.VF=function(){for(var t,e,n,i,r,o,t=new E.h9,e,n=this.Fi().LA,r=this.getRowCount(1),o=0;o<r;o++)i=this.Gt(o,1),t.push(new E.W8(o,-1,-1,n,-1,i)),n+=i;return t},K.prototype.YF=function(t){var e,n,i,r,o,a,s,u,c,f,l,e=this,n=new E.h9;if(n.sE(),i=Y(e),r=O(e),o=e.Fi(),a=D(e),f=e.Jt,0===t)for(u=o.T6,a=H(i,a),s=e.Mve();s<a;s++)c=f.Gt(s),l=new E.W8(s,-1,-1,u,-1,c),n.push(l),n.fE(s,l),u+=c;else if(1===t)this.y9e(n);else if(2===t)for(u=o.Ay,s=U(i,a-r);s<a;s++)c=f.Gt(s),l=new E.W8(s,-1,-1,u,-1,c),n.push(l),n.fE(s,l),u+=c;else 3===t&&this.y9e(n,!0);return n},K.prototype.y9e=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,m,p,S,w,b,C,n=this,i=n.Jt,r=n.Fi(),o=Et(n),a=n.ly,s=D(n),u=Y(n),c=O(n),f=r.Cy+a;for(s=o?s-c:s,l=n.Sy(r)-a,d=h=U(u,n.Tb);0<l&&d<s;d++){if(v=n.FCn&&n.FCn(d))for(g=n.C9e(d),m=0;m<g&&(p=n.ZAe(d,m),e&&((S=new E.W8(d,-1,-1,f,-1,p)).spacingIndex=m,S.isAfterSpacing=!1,t.push(S)),f+=p,!((l-=p)<=0));m++);if(l<=0)break;if(w=i.Gt(d),e||(b=new E.W8(d,-1,-1,f,-1,w),t.push(b),t.fE(d,b)),f+=w,(l-=w)<=0)break;if(C=n.FCn&&n.FCn(d,!0))for(g=n.C9e(d,!0),m=0;m<g&&(p=n.ZAe(d,m,!0),e&&((S=new E.W8(d,-1,-1,f,-1,p)).spacingIndex=m,S.isAfterSpacing=!0,t.push(S)),f+=p,!((l-=p)<=0));m++);}},K.prototype.s7=function(t,e,n,i){var r,o,a,t,e,s,u,c,f,l,h,i,r=this,o=r.getRowCount(n),a=r.getColumnCount(n),t=r._y(t,n),e=r.Yy(e,n),s=new E.h9;return t&&0<t.length&&e&&0<e.length&&(u=t[0].row,c=e[0].col,f=t[t.length-1].row,l=e[e.length-1].col,h=r.Ut.getSpans((0,x.Ec)(u,c,f-u+1,l-c+1),n),i&&r.Cb&&(i=r.Cb.ZF(n),h=h.concat(i)),0<h.length)&&r.WF(h,u,c,f,l,s,o,a,n,t,e),s},K.prototype.O_=function(t,e,n,i,r,o){var a,s,u,t,e,c,f,l,o,i,a=this,s=a.getRowCount(n),u=a.getColumnCount(n),t=a._y(t,n),e=a.Yy(e,n),c=new E.h9;return t&&0<t.length&&e&&0<e.length&&(f=t[0].row,l=e[0].col,(o=a.getSpan(i,r,n)||o&&a.Cb&&a.Cb.D7(i,r,n))&&((i=[]).push(o),a.WF(i,f,l,o.row+o.rowCount,o.col+o.colCount,c,s,u,n,t,e)),0<c.length)?c[0]:B},K.prototype.WF=function(t,e,n,i,r,o,a,s,u,c,f){var l,h,d,v,g,m,p,S,w,b,C,y,M,k,T,x,G,B,I,P,R,N,G,l=t.length;if(!(l<=0)){for(h=this,v=i+1,g=r+1,m=[],p=[],S=[],w=[],C=b=0,d=e-1;0<=d;d--)m[d]=h.Gt(d,u),w[d]=C-=m[d];for(C=0,d=e;d<v;d++)w[d]=C,m[d]=h.Gt(d,u),C+=m[d];for(d=n-1;0<=d;d--)p[d]=h.nn(d,u),S[d]=b-=p[d];for(b=0,d=n;d<g;d++)S[d]=b,p[d]=h.nn(d,u),b+=p[d];for(y=h.options.rightToLeft,M=0;M<l;M++)if((k=t[M]).intersect(e,n,i-e+1,r-n+1)){if(v<(T=k.row+k.rowCount)){for(d=v;d<T;d++)m.push(h.Gt(d,u)),w.push(w[d-1]+m[d]);v=T}if(g<(x=k.col+k.colCount)){for(d=g;d<x;d++)p.push(h.nn(d,u)),S.push(S[d-1]+p[d]);g=x}for(G=S[k.col],B=w[k.row],N=R=void(P=I=0),N=k.col;N<k.col+k.colCount&&N<s;N++)I+=p[N];for(R=k.row;R<k.row+k.rowCount&&R<a;R++)P+=m[R];G=y?f[0].x+f[0].width-G-I:f[0].x+G,o.push(new E.W8(k.row,k.col,G,c[0].y+B,I,P,k.rowCount,k.colCount,k.isAutoMerge))}}},K.prototype.ow=function(){var t,e,n,i,e,r,i,t=this,e=t.parent,n=t.ww(t.Ab),i=t.my;-1!==n&&n!==t.Ab&&(t.Ab=n),(e=e&&e.zb)&&(i=(r=e.g4===P.ScrollType.pixels)?t.QF(n)-i:t.KF(n),e.value(i))},K.prototype.JF=function(){var t,e,e,n,n,t,e=this.parent,e=e&&e.Xw;e&&(n=this.getDockScrollbarAttachedIndex(),R(n)||(n=-this.getColumnScrollOffsetX(n),e.value(n)))},K.prototype.tw=function(){var t,e,n,i,e,r,i,t=this,e=t.parent,n=t.vw(t.Tb),i=t.ly;-1!==n&&n!==t.Tb&&(t.Tb=n),(e=e&&e.Xb)&&(i=(r=e.g4===P.ScrollType.pixels)?t.XF(n)-i:t.qF(n),e.value(i))},K.prototype.aw=function(){var t,e,n,t=this,e=t.parent;e&&e.zb&&(n=e.options.scrollByPixel,e.zb.g4=n?P.ScrollType.pixels:P.ScrollType.continuous),e&&e.Xg&&(e.options.scrollbarAppearance===P.ScrollbarAppearance.mobile&&e.kC(),e.options.scrollIgnoreHidden&&(t.$F=t.tP(!0)),e.Xg())},K.prototype.ew=function(){var t,e,n,t=this,e=t.parent;e&&e.Xb&&(n=e.options.scrollByPixel,e.Xb.g4=n?P.ScrollType.pixels:P.ScrollType.continuous),e&&e.QC&&(e.options.scrollbarAppearance===P.ScrollbarAppearance.mobile&&e.kC(),e.options.scrollIgnoreHidden&&(t.nP=t.eP(!0)),e.QC())},K.prototype.Sw=function(){var t,e,n,t=this,e=0,n=V(t);return e=0<n?t.O5(n-1):t.k9()},K.prototype.pw=function(){var t,e,n,t=this,e=0,n=Y(t);return e=0<n?t.j5(n-1):t.N9()},K.prototype.k9=function(t){return this.O5(-1,t)},K.prototype.bge=function(t,e){var n,t,n=this,t=n.getColumnCount(t);return e?t-1:t-1-j(n)},K.prototype.O5=function(t,e,n){for(var i,r,i=this,r=i.bge(e,n);t<r;)if(i.getColumnVisible(++t,e)&&0<i.nn(t,e))return t;return B},K.prototype.r6=function(t,e,n){for(var i=this,r=n?0:V(i);r<t;)if(i.getColumnVisible(--t,e)&&0<i.nn(t,e))return t;return B},K.prototype.N9=function(t){return this.j5(-1,t)},K.prototype.pge=function(t,e){var n,t,n=this,t=n.getRowCount(t);return e?t-1:t-1-O(n)},K.prototype.j5=function(t,e,n){for(var i,r,i=this,r=i.pge(e,n);t<r;)if(i.M9e(++t,e))return t;return B},K.prototype.M9e=function(t,e){var n,i,r,o,i,n=this,i=n.FCn,r=i&&n.FCn(t)&&n.S9e(t,!1,e),o=!r&&n.getRowVisible(t,e)&&0<n.Gt(t,e),i=!o&&i&&n.FCn(t,!0)&&n.S9e(t,!0,e);return r||o||i},K.prototype.nI=function(t,e,n){for(var i=this,r=n?0:Y(i);r<t;)if(i.M9e(--t,e))return t;return B},K.prototype.iP=function(){this.Ww=!0,this.tw()},K.prototype.rP=function(){this.Zw=!0,this.ow()},K.prototype.XF=function(t){var e,n,i,r,n,o,a,s,u,e=this,n=Y(e),i,r=n,n=r+(D(e)-O(e)-n)-1,o=0,a=e.FCn;if(!(t<=r))for(n<t&&(t=n),s=r;s<t;s++)a&&e.FCn(s)&&(o+=e.PCn(s)),o+=u=e.Gt(s),a&&e.FCn(s,!0)&&(o+=e.PCn(s,!0));return o},K.prototype.QF=function(t){var e,n,i,r,n,o,a,s,e=this,n=V(e),i,r=n,n=r+(L(e)-j(e)-n)-1,o=0;if(!(t<=r))for(n<t&&(t=n),a=r;a<t;a++)o+=s=e.nn(a);return o},K.prototype.qF=function(t){var e,n,e=this.parent;return e&&e.options.scrollIgnoreHidden?(n=this.eP().visibleIndex)[t]:t},K.prototype.oP=function(t){var e,n,e=this.parent;return e&&e.options.scrollIgnoreHidden?(n=this.eP().originalIndex)[t]:t},K.prototype.KF=function(t){var e,n,e=this.parent;return e&&e.options.scrollIgnoreHidden?(n=this.tP().visibleIndex)[t]:t},K.prototype.aP=function(t){var e,n,e=this.parent;return e&&e.options.scrollIgnoreHidden?(n=this.tP().originalIndex)[t]:t},K.prototype.tP=function(t){var e,t,n,i,r,o,a,s,u,e=this;if(e.$F&&!t)return e.$F;if(t=V(e),n=L(e)-j(e)-t,o=e.Jt,a={visibleIndex:{},originalIndex:{}},!((r=(i=t)+n-1)-i+1<=0)){for(s=0,u=i;u<=r;u++)a.originalIndex[s]=u,a.visibleIndex[u]=s,0<o.Kt(u)&&s++;for(u--,s--;o.Kt(u)<=0&&i<=u;)a.originalIndex[s]=u,a.visibleIndex[u]=s,u--}return a},K.prototype.eP=function(t){var e,t,n,i,r,o,a,s,u,e=this;if(e.nP&&!t)return e.nP;if(t=Y(e),n=D(e)-O(e)-t,o=e.Jt,a={visibleIndex:{},originalIndex:{}},!((r=(i=t)+n-1)-i+1<=0)){for(s=0,u=i;u<=r;u++)a.originalIndex[s]=u,a.visibleIndex[u]=s,0<o.Gt(u)&&s++;for(u--,s--;o.Gt(u)<=0&&i<=u;)a.originalIndex[s]=u,a.visibleIndex[u]=s,u--}return a},K.prototype.vw=function(t,e){var n,i,r,o,n=this,r=Y(n),o=D(n)-O(n)-1;if(e){if((i=n.nI((t=o<t?o:t)+1))!==B&&r<=i)return i}else if((i=n.j5((t=t<r?r:t)-1))!==B&&i<=o)return i;return-1},K.prototype.ww=function(t,e){var n,i,r,o,n=this,r=V(n),o=L(n)-j(n)-1;if(e){if((i=n.r6((t=o<t?o:t)+1))!==B&&r<=i)return i}else if((i=n.O5((t=t<r?r:t)-1))!==B&&i<=o)return i;return-1},K.prototype.uP=function(t,e,n){var i,r,o,a,s;if(n<e)return n;for(i=_t(this,P.SheetArea.rowHeader)&&this.getRowCount()-1===n?jt(this):0,r=this.Jt,a=o=n;e<=a;a--)if(!((s=r.Gt(a))<=0)){if(t<(i+=s))break;o=a}return o},K.prototype.gw=function(t,e,n){for(var i,r,o,a,s,i=_t(this,P.SheetArea.rowHeader)&&this.getRowCount()-1===n?jt(this):0,r=n,o=0,a=n;e<=a;a--)if(!((s=this.Gt(a))<=0)&&(r=a,t<=(i+=s))){o=t-i;break}return{Ky:r,Xy:o}},K.prototype.sP=function(t,e,n){var i,r,o,a,s;if(n<e)return n;for(i=_t(this,P.SheetArea.colHeader)&&this.getColumnCount()-1===n?Lt(this):0,r=this.Jt,a=o=n;e<=a;a--)if(!((s=r.Kt(a))<=0)){if(t<(i+=s))break;o=a}return o},K.prototype.Cw=function(t,e,n){for(var i,r,o,a,s,i=_t(this,P.SheetArea.colHeader)&&this.getColumnCount()-1===n?Lt(this):0,r=n,o=0,a=n;e<=a;a--)if(!((s=this.nn(a))<=0)&&(r=a,t<=(i+=s))){o=t-i;break}return{iw:r,Xy:o}},K.prototype.cP=function(){var t,e,n,i,r,o,a,s,t=this,e=t.Fi(),n=t.Yy(1,3),i=0,r=0;if(n)for(o=0;o<n.length;o++)i+=a=n[o].width,0<a&&r++;return 0==(s=i/(r=0===r?1:r))?1:b(t.Gy(e)/s)},K.prototype.fP=function(){var t,e,n,i,r,o,a,s,u,c,t=this,e=t.Fi(),n=t._y(1,3),i=0,r=0;if(n)for(o=0;o<n.length;o++)i+=a=n[o].height,0<a&&r++;if(t.FCn&&(s=t._y(3)))for(o=0;o<s.length;o++)i+=u=s[o].height,0<u&&r++;return 0==(c=i/(r=0===r?1:r))?1:b(t.Sy(e)/c)},K.prototype.mw=function(t){var e,n,i,r,o,a,n,o;return R(t)&&(t=3),n=(e=this).parent,i=Y(e),r=O(e),n&&n.options.scrollbarMaxAlign?(o=e.Fi(),n.options.scrollByPixel?e.gw(e.Sy(o),i,D(e)-r-1):{Ky:a=e.uP(e.Sy(o),i,D(e)-r-1),Xy:0}):(n=e.getRowCount(t),3!==t&&2!==t||(n-=r),{Ky:o=(o=e.nI(n,t))===B?i:o,Xy:0})},K.prototype.Mw=function(t){var e,n,i,r,o,n,r;return R(t)&&(t=3),n=(e=this).parent,i=V(e),n&&n.options.scrollbarMaxAlign?(r=e.Fi(),n.options.scrollByPixel?e.Cw(e.Gy(r),i,L(e)-j(e)-1):{iw:o=e.sP(e.Gy(r),i,L(e)-j(e)-1),Xy:0}):(n=e.getColumnCount(t),3!==t&&1!==t||(n-=j(e)),{iw:r=(r=e.r6(n,t))===B?i:r,Xy:0})},K.prototype.lP=function(){var n,i,r,t,e,o,a,a,a,a,o,n=this,i=Y(n),r=V(n),t=D(n)-O(n)-1,e=L(n)-j(n)-1,o=n.Ut,a=o.getLastNonNullRow(3);return i<a&&(i=a),a=o.getLastNonNullCol(3),r<a&&(r=a),a=o.getLastNonNullRow(2),i<a&&(i=a),a=o.getLastNonNullCol(1),r<a&&(r=a),(o=K.fh)&&h(o,function(t,e){var e,e,e=e.lastNonNullRowAndCol;e&&(e=e.call(n),i=U(i,e.lastNonNullRow),r=U(r,e.lastNonNullCol))}),{lastNonNullRow:i=t<i?t:i,lastNonNullCol:r=e<r?e:r}},K.prototype.getLastNonNullRow=function(){return this.lP().lastNonNullRow},K.prototype.getLastNonNullColumn=function(){return this.lP().lastNonNullCol},K.prototype.$A=function(t,e,n){var i,r,o,a,s,a,u,u,i=this,r=i.Tb,o=i.ly,a=i.mw(),s=a.Ky,a=a.Xy,u=!R(n);(t=r>=i.getRowCount()&&s<t?s:t)>=i.pw()&&t<=s&&(u||t!==r||e!==o)&&((u=i.parent)&&(e||t!==s||(e=a),u.ib&&u.ib.yy(i,t,e||0,n),i.tw()),u&&!u.options.scrollbarShowMax&&i.ew(),i.invalidateLayout())},K.prototype.o9=function(t,e,n){var i,r,o,a,s,a,u,u,i=this,r=i.Ab,o=i.my,a=i.Mw(),s=a.iw,a=a.Xy,u=!R(n);(t=r>=i.getColumnCount()&&s<t?s:t)>=i.Sw()&&t<=s&&(u||t!==r||e!==o)&&((u=i.parent)&&(e||t!==s||(e=a),u.ib&&u.ib.wy(i,t,e||0,n),i.ow()),u&&!u.options.scrollbarShowMax&&i.aw(),i.invalidateLayout())},K.prototype.JL=function(t,e,n){var i,r,o,a,s,u,c,s,u,u,s,c,s,c,s,f,l,u,s,h,i=this,r=t.row,o=t.col,a=t.hitTestType;return R(r)||R(o)?(u=!1,c=(s=i.Fi()).XAe(),!(u=!R(c)&&c.contains(e,n,!0)||(c=s.qAe(),!R(c)&&c.contains(e,n,!0))?!0:u)||(s=i.PTe(a),R(s))||(u=i.$Ae(a),R(u))?B:u.Bn(e,n,s,c,{sheet:i,row:r,col:o,sheetArea:a})):((u=3===t.rowViewportIndex)||((s=i.getSpan(r,o,a))&&(r=s.row,o=s.col),i.Cb&&(c=i.Cb.D7(r,o,a))&&(r=c.row,o=c.col)),s={},u&&(s.rowSpacingIndex=t.rowSpacingIndex,s.isAfterRowSpacing=t.isAfterRowSpacing),c=i.Il(r,o,a,N,s),s=1===a?-1:N,f=2===a?-1:N,l={needAutoMerge:!0},u&&(l.rowSpacingIndex=t.rowSpacingIndex,l.isAfterRowSpacing=t.isAfterRowSpacing),u=i.getCellRect(r,o,s,f,l),s={sheet:i,row:r,col:o,sheetArea:a,rowSpacingIndex:t.rowSpacingIndex,isAfterRowSpacing:t.isAfterRowSpacing},(h=c.cellType||i.$f(a)).Bn(e,n,c,u,s))},K.prototype.bC=function(){this.unbindAll(),this.E3()},K.prototype.dA=function(t,e,n){for(var t,i,r,o,a,s,u,c,f,s,f,f,t=this.JS(t),i=t.row,r=t.col,o=i+t.rowCount,a=r+t.colCount,u=i;u<o;u++)for(c=r;c<a;c++)if(s=(f=this.getSpan(u,c,n))?f.row:u,f=f?f.col:c,s=this.getActualStyle(s,f,n),f=e&&this.XT(u,n),!0===s.locked&&!f)return!0;return!1},K.prototype.zT=function(t,e,n,i,r,o){if(-1<=t&&t<r&&-1<=e&&e<o){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==i&&e+i<=o)return!0}else if(-1===e){if(0!==n&&t+n<=r)return!0}else if(0!==i&&e+i<=o&&0!==n&&t+n<=r)return!0}return!1},K.prototype.GT=function(t,e,n,i){var r,o,o,o,r=this;return!(t<0&&e<0)&&(t<0&&(o=r.Ut.K_(1))&&o.spans&&0<o.spans.length?r.Ut.GT(-1,e,-1,i,1):e<0&&(o=r.Ut.K_(2))&&o.spans&&0<o.spans.length?r.Ut.GT(t,-1,n,-1,2):!!((o=r.Ut.K_(3))&&o.spans&&0<o.spans.length)&&r.Ut.GT(t,e,n,i,3))},K.prototype.suspendPaint=function(){var t,e,t=this,e=t.My;t.My++,0===e&&K.et(t,vt,{suspend:!0})},K.prototype.resumePaint=function(){var t=this;t.My--,t.My<=0&&(t.My=0,K.et(t,vt,{suspend:!1}),t.hP())&&t.zw()},K.prototype.hP=function(){var t=this.parent;return!t||t.getActiveSheet()===this},K.prototype.isPaintSuspended=function(){return 0<this.My},K.prototype.nR=function(t,e){for(var n,i,r,o,n=this,i=t&&t.length,r=0;r<i;r++)if(o=t[r],e.intersect(o.row,o.col,o.rowCount,o.colCount))return t.splice(r,1),n.nR(t,e.union(o));return e},K.prototype.getClipboardHelperObj=function(){var t=this.ST();return{isCutting:t.ES,ranges:t._S,showInsertCopyPasteCells:t.TT,fromSheet:t.DS}},K.prototype.resetFloatingObjectHelperData=function(t){this.dP&&this.dP.remove(t)},K.prototype.ST=function(){var t=this,e=t.parent;return t.bM||(t.bM=e&&e.bM),t.bM},K.prototype.BO=function(){var t;return this.MC||((t=this).MC=new r.Wh(function(){!t.MC||t.parent&&t.parent.Vp&&t.parent.Vp.endingCallback||(K.et(t,"onImageLoaded"),t.repaint())})),this.MC},K.prototype.Qy=function(){var t,e=this.parent;if(e)return e.commandManager()},K.prototype.jT=function(t,e,n){var t={sheet:this,sheetName:this.name(),invalidType:t,message:e};this.ki(x.Events.InvalidOperation,i(i({},t),n))},K.prototype.Rj=function(t,e,n,i,r,o){var a,s;0===this.vf&&(a={sheet:this,sheetName:this.name(),row:e,col:n,sheetArea:i,propertyName:t,oldValue:r,newValue:o,isUndo:this.Nj},this.ki(x.Events.CellChanged,a),(s=this.Ut).ZI(["cellChanged",t,e,n,i,o,r]))},K.prototype.eT=function(t,e,n,i){this.ki(x.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:e,oldValue:n,newValue:i})},K.prototype.Dj=function(t,e,n,i,r){var o,a,o;if(0===this.vf){if(o={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:n,newValue:i,oldValue:r,cancel:!1},"addColumns"!==n&&"deleteColumns"!==n||(o.count=i),this.ki(x.Events.ColumnChanging,o),!0===o.cancel)return!1;(a=this.Ut).ZI(["columnChanging",t,e,n,r,i])}return o=this.getDockScrollbarAttachedIndex(),R(o)||this.vP(),!0},K.prototype.vj=function(t,e,n,i,r){var o,a,o;0===this.vf?(o={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:n,newValue:i,oldValue:r,isUndo:this.Nj},"addColumns"!==n&&"deleteColumns"!==n||(o.count=i),this.ki(x.Events.ColumnChanged,o),(a=this.Ut).ZI(["columnChanged",t,e,n,r,i])):this.Lj(this,[{col:t}],1),o=this.mP,R(o)||this.gP()},K.prototype._j=function(t,e,n,i){var r,o,a,s,u,o=[];if(this.tables){for(r=this.tables.pP(t,e,n,i),a=0;a<r.length;a++)o.push(r[a].name());0<o.length&&(s={isUndo:this.Nj,sheet:this,sheetName:this.name(),row:t,col:n,rowCount:e,colCount:i,tableNames:o,action:2},this.ki(x.Events.RangeChanged,s),(u=this.Ut).ZI(["rangeChanged",t,e,n,i]))}},K.prototype.kj=function(t,e,n,i,r){var o,a;if(0===this.vf){if(o={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:n,newValue:i,oldValue:r,cancel:!1},"addRows"!==n&&"deleteRows"!==n||(o.count=i),this.ki(x.Events.RowChanging,o),!0===o.cancel)return!1;(a=this.Ut).ZI(["rowChanging",t,e,n,r,i])}return!0},K.prototype.dj=function(t,e,n,i,r){var o,a;0===this.vf?(o={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:n,newValue:i,oldValue:r,isUndo:this.Nj},"addRows"!==n&&"deleteRows"!==n||(o.count=i),this.ki(x.Events.RowChanged,o),(a=this.Ut).ZI(["rowChanged",t,e,n,r,i])):this.Lj(this,[{row:t}],2)},K.prototype.Oj=function(t,e){e!==t&&(this.ki(x.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}),this.ki(x.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:e,newZoomFactor:t}))},K.prototype.EA=function(t,e){return!(this.O9||!this.rt._A(t,e)||(this.ki(x.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:e}),0))},K.prototype.jA=function(t,e){this.ki(x.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections(),shiftKey:e})},K.prototype.SI=function(t,e,n,i,r,o,a,s,u,c,f){var l,t,l={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:n,colCount:i,changedCells:r,action:o},t={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:n,colCount:i,changedCells:r,isUndo:!!c,action:o};a&&(t.sheetArea=l.sheetArea=a),s&&(l.value=s),(r&&0<r.length||f!==N)&&(u&&0<u.length&&(t.tableNames=u),this.ki(x.Events.RangeChanged,t),this.ki(x.Events.RangeChangedInternal,l))},K.prototype._i=function(t,e){var t={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:e};this.ki(x.Events.EditorStatusChanged,t)},K.prototype.bP=function(){return this.yP||(this.yP=(0,l.GC$)(Q("input"))),this.yP},K.prototype.o5=function(){var t=this;return t.parent&&t.parent.options.pasteSkipInvisibleRange},K.prototype.lT=function(t,e,n){var i,r,o,a,s,i=this,r=0,o=i.getColumnWidth,a=i.getColumnCount();for(n&&(o=i.getRowHeight,a=i.getRowCount()),s=t=t<0?0:t;s<t+e;s++)s<a&&0===o.call(i,s)&&(r++,e++);return r},K.prototype.ox=function(t,e,n){var i,r,o,a,i=this,r=0,o=i.getColumnWidth;for(n&&(o=i.getRowHeight),a=t=t<0?0:t;t-e<a&&0<a;a--)0===o.call(i,a)&&(r++,e++);return r},K.prototype.ix=function(t,e,n){var i,r,o,a,i=this,r=0,o=i.getColumnWidth;for(n&&(o=i.getRowHeight),a=t=t<0?0:t;a<t+e;a++)0===o.call(i,a)&&r++;return r},K.prototype.bind=function(t,e,n){this.bP().bind(t+wt,e,n)},K.prototype.unbind=function(t,e){this.bP().unbind(t+wt,e)},K.prototype.ki=function(t,e,n){this.updateEventsData&&this.updateEventsData(t,e),0!==this.vf&&!n||this.bP().trigger(t,e)},K.prototype.unbindAll=function(){this.unbind("")},K.prototype.D3=function(t,e,n){0<=t.indexOf(".")?this.bind(t,e,n):this.bind(t+bt,e,n)},K.prototype._3=function(t,e){0<=t.indexOf(".")?this.unbind(t,e):this.unbind(t+bt,e)},K.prototype.E3=function(){this.unbind(bt)},K.prototype.ot=function(){var t=this.kg;return new x.Rect(t.x,t.y,t.width,t.height)},K.prototype.cg=function(t){this.kg=new x.Rect(t.x,t.y,t.width,t.height)},K.prototype.scroll=function(t,e){var n,i,r,o,a,i,s,u,r,e,c,f,e,n=this,i=n.parent;i&&(o=(r=i.options).scrollByPixel,a=r.scrollPixel,i=i.ib,s=r.scrollbarShowMax,u=r.showHorizontalScrollbar,r=r.showVerticalScrollbar,0!==e&&(c=(e=i.bw(n,Math.round(e)/a)).iw,f=o?e.Xy:0,c===n.Ab&&f===n.my||(i.wy(n,c,f),u&&(n.ow(),s||(n.Zw=!0)))),0!==t)&&(c=(e=i.hw(n,Math.round(t)/a)).Ky,f=o?e.Xy:0,c===n.Tb&&f===n.ly||(i.yy(n,c,f),r&&(n.tw(),s||(n.Ww=!0))))},K.prototype.isCtrlPressed=function(t){return this.rt&&this.rt.ctrl},K.prototype.deselectIgnoreSpan=function(){return!1},K.prototype.Wb=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,g,g,m,p,S,w,b,C,y,u,i,g,n=this,i=n.zoom(),r=e.newValue,o=e.oldValue,a=e.scrollEventType,s=t.options.scrollByPixel,u=t.options.scrollPixel;if(o=e.oldValue=R(o)?0:s?I(o):M(o+"",10),n.Ww=!1,l=n.pw(),h=n.mw().Ky,d=t.options.scrollbarShowMax,v=0,s){for(g=(r=I(r))-o,a!==P.Zi.thumbTrack&&(r=o+(g*=u*i),g=t.Xb.v4(),r<0?r=0:g<r&&(r=g)),d||(n.Ww=!0,a===P.Zi.smallIncrement&&r===o?r+=u*i:e.ignoreUpdatePosition=!0),S=(g=n.frozenRowCount())+(m=n.getRowCount()-n.frozenTrailingRowCount()-g)-1,b=w=0,C=n.FCn,y=g;y<=S;y++)if(b=n.Gt(y),C&&(n.FCn(y)&&(b+=n.PCn(y)),n.FCn(y,!0))&&(b+=n.PCn(y,!0)),r<=(w+=b)){v=w-r-b,c=y;break}R(c)&&(v=-n.Gt(c=S),r=w)}else c=M(r+"",10),c=n.oP(c),a===P.Zi.largeDecrement||a===P.Zi.smallDecrement?(a===P.Zi.largeDecrement&&(c=n.QA()),-1!==(f=n.vw(c,!0))&&f!==c&&(c=f),d||(n.Ww=!0,e.ignoreUpdatePosition=!0)):a!==P.Zi.largeIncrement&&a!==P.Zi.smallIncrement||(a===P.Zi.largeIncrement&&(c=n.sB())===n.Tb&&c++,d||(n.Ww=!0,a===P.Zi.smallIncrement&&r===o&&c++),-1!==(f=n.vw(c))&&f!==c&&(c=f)),h<(c=c<l?l:c)&&(c=h);u=s?I(r):n.qF(c),e.newValue!==u&&(e.newValue=u),i=u,0!==(g=n.Gt(c))&&(i+=k(v)/g),e.newValueWithOffset=s?u:i,o===u&&!s||t.ib.ay(n,c,v)},K.prototype.Kb=function(t){var e,n,i,r,o,a,e=this,n=t.Xb,i;n.g4!==P.ScrollType.pixels&&(r=e.oP(n.value()),o=e.pw(),a=e.mw().Ky,r<o?n.value(e.qF(o)):a<r&&n.value(e.qF(a))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?e.Ww=!0:t.QC())},K.prototype.Fb=function(t,e){var n,i,r,o,a,s,u,c,f,l,h,d,v,g,g,g,m,p,S,w,b,C,u,i,g,n=this,i=n.zoom(),r=e.newValue,o=e.oldValue,a=e.scrollEventType,s=t.options.scrollByPixel,u=t.options.scrollPixel;if(o=e.oldValue=R(o)?0:s?I(o):M(o+"",10),n.Zw=!1,l=n.Sw(),h=n.Mw().iw,d=t.options.scrollbarShowMax,v=0,s){for(g=(r=I(r))-o,a!==P.Zi.thumbTrack&&(r=o+(g*=u*i),g=t.zb.v4(),r<0?r=0:g<r&&(r=g)),d||(n.Zw=!0,a===P.Zi.smallIncrement&&r===o?r+=u*i:e.ignoreUpdatePosition=!0),S=(g=n.frozenColumnCount())+(m=n.getColumnCount()-n.frozenTrailingColumnCount()-g)-1,b=w=0,C=g;C<=S;C++)if(r<=(w+=b=n.nn(C))){v=w-r-b,c=C;break}R(c)&&(v=-n.nn(c=S),r=w)}else c=M(r+"",10),c=n.aP(c),a===P.Zi.largeDecrement||a===P.Zi.smallDecrement?(a===P.Zi.largeDecrement&&(c=n.fB()),-1!==(f=n.ww(c,!0))&&f!==c&&(c=f),d||(n.Zw=!0,e.ignoreUpdatePosition=!0)):a!==P.Zi.largeIncrement&&a!==P.Zi.smallIncrement||(a===P.Zi.largeIncrement&&(c=n.oB())===n.Ab&&c++,d||(n.Zw=!0,a===P.Zi.smallIncrement&&r===o&&c++),-1!==(f=n.ww(c))&&f!==c&&(c=f)),h<(c=c<l?l:c)&&(c=h);u=s?I(r):n.KF(c),e.newValue!==u&&(e.newValue=u),i=u,0!==(g=n.nn(c))&&(i+=k(v)/g),e.newValueWithOffset=s?u:i,o===u&&!s||t.ib.ay(n,c,v,!0)},K.prototype.Gb=function(t){var e,n,i,r,o,a,e=this,n=t.zb;e&&n&&((i=n.g4===P.ScrollType.pixels)||(r=e.aP(n.value()),o=e.Sw(),a=e.Mw().iw,r<o?n.value(e.KF(o)):a<r&&n.value(e.KF(a))),t.iy(),t.options.scrollbarShowMax||(t.ib.scrolling?e.Zw=!0:t.WC()))},K.prototype.onHorizontalDockScroll=function(t,e){var n,i,e,r,n=this.wP;R(n)||(i=e.oldValue,e=e.newValue,this.scrollColumnView(n,-(r=e-i)))},K.prototype.WC=function(t,e,n){var i,r,o,a,o,s,s,a,u,c,f,l,h,d,v,g,h,f,e,t,h,f,u,i=this,r=n&&n.g4===P.ScrollType.pixels,o=i.frozenColumnCount(),a=i.getColumnCount()-i.frozenTrailingColumnCount()-o,o=o,s=i.Fi(),s=i.Gy(s),a=0==a?o:o+a-1,u=i.Ab,c=i.my,l=0;t?(r?(f=d=(h=i.Cw(s,o,a)).iw,l=v=h.Xy):f=i.sP(s,o,a),a=f):r&&(l=-i.nn(a)),e?r&&!t&&(l=-i.nn(a)):(h=(g=i.lP()).lastNonNullCol,a=(f=(f=i.sP(s,o,h))===o&&a<++f?a:f)<u?u<a?u:a:f,l=c),a<u?(i.Ab=a,i.my=r?l:0):u===a&&c<l&&(i.my=r?l:0),-1!==(e=i.ww(i.Ab))&&e!==i.Ab&&(i.Ab=e),n&&(u=f=h=t=0,r?(t=i.QF(o),h=i.QF(a)-l,f=s,u=i.QF(i.Ab)-i.my):(t=i.KF(o),h=i.KF(a),f=i.cP(),u=i.KF(i.Ab),f<1&&(f=1)),n.m4(t),n.v4(h),n.d4(f),n.w4(),n.value(u))},K.prototype.$C=function(t){var e,n,i,r,o,n,e;t&&(e=this.getDockScrollbarAttachedIndex(),R(e)||(n=this.getColumnWidth(e),r=0,o=(i=this.getColumnScrollWidth(e))-n,n=n,e=-this.getColumnScrollOffsetX(e),t.m4(0),t.v4(o),t.d4(n),t.w4(),t.value(e)))},K.prototype.QC=function(t,e,n){var i,r,o,a,o,s,a,u,c,f,l,s,h,d,v,g,m,d,f,e,t,h,d,f,i=this,r=n&&n.g4===P.ScrollType.pixels,o=i.frozenRowCount(),a=i.getRowCount()-i.frozenTrailingRowCount()-o,o=o,s=i.Fi(),a=0==a?o:o+a-1,u=i.Tb,c=i.ly,l=0,s=i.Sy(s),h=i.FCn;t?(r?(f=v=(d=i.gw(s,o,a)).Ky,l=g=d.Xy):f=i.uP(s,o,a),a=f):r&&(l=-i.Gt(a),h&&i.FCn(a)&&(l-=i.PCn(a)),h)&&i.FCn(a,!0)&&(l-=i.PCn(a,!0)),e?r&&!t&&(l=-i.Gt(a),h&&i.FCn(a)&&(l-=i.PCn(a)),h)&&i.FCn(a,!0)&&(l-=i.PCn(a,!0)):(d=(m=i.lP()).lastNonNullRow,a=(f=(f=i.uP(s,o,d))===o&&a<++f?a:f)<u?u<a?u:a:f,l=c),a<u?(i.Tb=a,i.ly=r?l:0):u===a&&c<l&&!(i.FCn&&i.parent&&i.parent.Gie)&&(i.ly=r?l:0),-1!==(e=i.vw(i.Tb))&&e!==i.Tb&&(i.Tb=e),n&&(f=d=h=t=0,r?(t=i.XF(o),h=i.XF(a)-l,d=s,f=i.XF(i.Tb)-i.ly):(t=i.qF(o),h=i.qF(a),d=i.fP(),f=i.qF(i.Tb),d<1&&(d=1)),n.m4(t),n.v4(h),n.d4(d),n.w4(),n.value(f))},K.prototype.FM=function(){for(var t,e,n,i,r,o,a,t=this,e=t.getRowCount(),n=t.getColumnCount(),i=0;i<e;i++)for(r=0;r<n;r++)(o=t.getValue(i,r))instanceof Date&&((a=t.Z_(i,r))&&a.g5(o),t.CL(i,r,a))},K.prototype.GB=function(t,e){var n=this;1===n.getRowCount(P.SheetArea.colHeader)&&(n.qL(t,e,Ct,!1,P.SheetArea.colHeader),n.Zw=!0,n.zw())},K.prototype.Lt=function(t){var e;return this.Ut.getColumnHeaderFitMode(!1,1,t)},K.prototype.vL=function(t,e,n,i,r){var o,a,r,n,s,u,u,u,u,c;return R(i)&&(i=3),o=this,r||(a=o.t0(t,e,i),R(a))?(r=o.getCellType(t,e,i),n=n,"General"===(s=!(s=(s=o.l0(t,e,"formatter",i))&&"General"!==s?s:o.l0(t,e,"_autoFormatter",i))&&(u=o.pivotTables,u=3===i&&u?u.findPivotTable(t,e):B)?(u=u.hqt(t,e))&&u.formatter:s)&&(s=N),u={},c=o.l0(t,e,"quotePrefix",i),(n=r.format(n,s,u,{sheet:o,row:t,col:e,sheetArea:i,quotePrefix:c}))&&"string"==typeof n?n.replace(/\r\n?/g,"\n"):n):a},K.prototype.isRowFilterOut=function(t){return this.XT(t)},K.prototype.getHDockScrollbarWidth=function(){var t,e,n,i,r,o,a,s,t=this.getDockScrollbarAttachedIndex(),e,n=0;return n=this.Vy&&!R(t)&&(i=this.frozenTrailingColumnCount(),(o=(r=this.getColumnCount())-i)<=t||t<=(a=r-1))?(s=this.Fi()).zy:n},K.prototype.getDockScrollbarAttachedIndex=function(){return this.wP},K.prototype.setDockScrollbarAttachedIndex=function(t){this.wP=t,this.Zw=!0,this.zw()},K.prototype.vP=function(){var t,e,n,t,t=this.getDockScrollbarAttachedIndex(),e,n,t=this.Ut.Q_(!1,P.SheetArea.viewport).NE(t);this.mP=t},K.prototype.gP=function(){var t,e,n,i,n,t,e,n=this.Ut.Q_(!1,P.SheetArea.viewport).EE(),i=this.mP,n=n.indexOf(i);-1===n&&(n=B),this.setDockScrollbarAttachedIndex(n)},K.prototype.setScrollableColumnIndexInFrozenTrailingColumnArea=function(t){var e,n,i,r;0<=t&&(t+=i=(e=this.getColumnCount())-(n=this.frozenTrailingColumnCount()))<=(r=e-1)&&this.setDockScrollbarAttachedIndex(t)},K.prototype.getColumnScrollWidth=function(t){var e,n,e,n;return this.Ut.Q_(!1,P.SheetArea.viewport).getScrollContentWidth(t)},K.prototype.setColumnScrollWidth=function(t,e){var n,i,n,i;this.Ut.Q_(!1,P.SheetArea.viewport).setScrollContentWidth(t,e),this.Zw=!0,this.zw()},K.prototype.getColumnScrollOffsetX=function(t){var e,n,e,n;return this.Ut.Q_(!1,P.SheetArea.viewport).getScrollOffsetX(t)},K.prototype.setColumnScrollOffsetX=function(t,e){var n,i,n,i;this.Ut.Q_(!1,P.SheetArea.viewport).setScrollOffsetX(t,e),this.JF(),this.n3(),this.LL(t)},K.prototype.scrollColumnView=function(t,e){var n,i,r,o,a,s,n,i=this.Ut.Q_(!1,P.SheetArea.viewport),r=this.getColumnWidth(t),o=this.getColumnScrollWidth(t),a=this.getColumnScrollOffsetX(t),s=a+e;0<s?e=-a:s<r-o&&(e=r-o-a),i.setScrollOffsetX(t,e,!0),this.JF(),this.n3(),this.LL(t)},K.prototype.getScrollTooltipContent=function(t,e){var n,i,t,i,n="",i=this.Ab+1;return t?n=m().Tip_Row+(this.Tb+1):(t=this.getDockScrollbarAttachedIndex(),e&&!R(t)&&(i=this.getDockScrollbarAttachedIndex()+1),1!==this.options.colHeaderAutoText&&(i=x.util.Vf(i)),n=m().Tip_Column+i,e&&!R(t)&&(i=I(this.getColumnScrollOffsetX(t)),n+=" ".concat(m().Tip_Column_Offset,": ").concat(i))),n},K.prototype.expandSelection=function(t,e){for(var n,i,r,o,a,s,n=new x.Range(e.row,e.col,e.rowCount,e.colCount),i=new x.Range(e.row,e.col,e.rowCount,e.colCount),r=!0,o=!0,a=!0,s=!0;r||o||a||s;)r&&x.util.X0(t,n.row-1,n.col-1,n.colCount+2)&&(n.row=n.row-1,n.rowCount=n.rowCount+1),o&&x.util.X0(t,n.row+n.rowCount,n.col-1,n.colCount+2)&&(n.rowCount=n.rowCount+1),a&&x.util.q0(t,n.row-1,n.col-1,n.rowCount+2)&&(n.col=n.col-1,n.colCount=n.colCount+1),s&&x.util.q0(t,n.row-1,n.col+n.colCount,n.rowCount+2)&&(n.colCount=n.colCount+1),s=a=o=r=!1,t.getText(n.row-1,n.col-1)&&(r=a=!0),t.getText(n.row-1,n.col+n.colCount)&&(r=s=!0),t.getText(n.row+n.rowCount,n.col-1)&&(a=o=!0),t.getText(n.row+n.rowCount,n.col+n.colCount)&&(s=o=!0),i.row===n.row?i.rowCount===n.rowCount-1&&(o=!0):(r=!0,i.rowCount===n.rowCount-2&&(o=!0)),i.col===n.col?i.colCount===n.colCount-1&&(s=!0):(a=!0,i.colCount===n.colCount-2&&(s=!0)),i.row=n.row,i.col=n.col,i.rowCount=n.rowCount,i.colCount=n.colCount;return n},K.prototype.deleteBlankContent=function(t,e){1===e.rowCount&&1===e.colCount||(x.util.X0(t,e.row,e.col,e.colCount)||(e.row=e.row+1,e.rowCount=e.rowCount-1),x.util.X0(t,e.row+e.rowCount-1,e.col,e.colCount)||(e.rowCount=e.rowCount-1),x.util.q0(t,e.row,e.col,e.rowCount)||(e.col=e.col+1,e.colCount=e.colCount-1),x.util.q0(t,e.row,e.col+e.colCount-1,e.rowCount))||(e.colCount=e.colCount-1)},K.prototype.MP=function(){return!1},K.prototype.FT=function(){return m().Exp_InvalidOperationInProtect},K.prototype.A9e=function(){return m().Exp_InvalidOperationSizeLimitExceeded},K.prototype.Ci=function(t,e,n){return this.CP(t,e,n)},K.prototype.CP=function(t,e,n){return this.Ut.Ci(t,e,n)},K.prototype.R2e=function(){return this.options.sheetTabColor},K.prototype.parameter=function(t){var e,n,i,r;if(0===arguments.length){for(i in n={},e=this.ghe)e.hasOwnProperty(i)&&(n[i]=d(e[i]));return n}if(t){for(i in r={},t)t.hasOwnProperty(i)&&(r[i]=nt(t[i]));this.ghe=r}},K.prototype.continuousPaginateLargeColumn=function(){return!1},K.prototype.$t=function(t,e,n,i,r){return this.getValue(t,e,n,i,r=void 0===r?{}:r)},K.prototype.o2e=function(t,e,n,i,r){return this.getActualStyle(t,e,n,i,r=void 0===r?{}:r)},K.prototype.isActualProtected=function(){return this.options.isProtected},K.prototype.getAutoFormatter=function(t,e){var t;return null==(t=this.getStyle(t,e))?void 0:t._autoFormatter},K.prototype.VTe=function(){var t;return this.g9e||(this.g9e=new z.AttachmentsManager),this.g9e},K._ID=1,K.Pp=Bt,K.n8=200,K.e8=20,K.r8=1,K.o8=1,It=K,t.Worksheet=It,(0,x.$e)(It),(Pt=It.prototype).visible=X("visible",P.SheetTabVisible.visible,function(t){var e,n,i,r,o,a,s,u,e=this,n=e.parent,i=n.sheets,r=i.length,o=l.GC$.inArray(e,i),a=n.getActiveSheetIndex(),s="visible";if(!0!==t&&!1!==t&&t!==P.SheetTabVisible.visible&&t!==P.SheetTabVisible.hidden&&t!==P.SheetTabVisible.veryHidden&&(e._ps[s]=P.SheetTabVisible.visible),!0===t?e._ps[s]=P.SheetTabVisible.visible:!1===t&&(e._ps[s]=P.SheetTabVisible.hidden),t===P.SheetTabVisible.visible||!0===t)a<0?(n.tb(o,1),n.w2&&n.w2.om<0&&(n.w2.om=o)):n.Xg();else if(o===a){for(u=o+1;u<r&&i[u].visible()!==P.SheetTabVisible.visible;)u++;if(r<=u)for(u=o-1;0<=u&&i[u].visible()!==P.SheetTabVisible.visible;)u--;n.w2&&u<n.w2.om&&(n.w2.om=u),u<0?(e.L0(!1),n._2=u,n.Cg()):(n.tb(u,1),t===P.SheetTabVisible.veryHidden&&i[a]&&n.a3(i[a]))}else n.Xg()})},DataManager:function(t){"use strict";t.exports=GC.Data},Common:function(t){"use strict";t.exports=GC.Spread},CalcEngine:function(t){"use strict";t.exports=GC.Spread.CalcEngine},SheetsCalc:function(t){"use strict";t.exports=GC.Spread.Sheets.CalcEngine},canvas:function(t){"use strict";t.exports=canvas}},i={},t=r("./dist/core/core.entry.js"),((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=t}();
;var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/sheetsCalc/calc-extra-save.js":function(n,t,i){var c,u,e,s,a,l,h,v,d;function r(f,o,u){for(var s,n,t,n=function(n){var t,n,e,i,r,t=o[n];if(t.l)for(n=w(t.k),e=f.oT(n[1],n[2],!0),t.v&&f.nbt(e),t.b,e.aT=t.l.map(function(n){return parseInt(n,10)}),i=function(n){var r=t.l[n];e[r]=(0,c.createMap)(),null!=(s=t[r])&&s.map(function(n){var t,i,i,t=w(n),i=t[0];"?"!==i[0]&&"!"!==i[0]||(i=i.slice(1)),i=u[i],e[r].set(n,i.oT(t[1],t[2],!0))})},r=0;r<t.l.length;r++)i(r)},t=0;t<o.length;t++)n(t)}function w(n){return n.split(",").map(function(n,t){return n=0<t?parseInt(n,10):n})}function f(n,t,i){var r,e,f,o,u,s,c,a,l,a,r=n.uT(!0);for(e in t.l)if(t.l.hasOwnProperty(e))for(o in f=t[e])if(f.hasOwnProperty(o))for(u=o.split(",").map(function(n,t){return"?"!==n[0]&&"!"!==n[0]||(n=n.slice(1)),parseInt(n,10)}),s=0;s<f[o].length;s++)a=(l=i[a="?"!==(a=(c=w(f[o][s]))[0])[0]&&"!"!==a[0]?a:a.slice(1)]).oT(c[1],c[2],!0),r.processListener(parseInt(e,10),u[0],u[1],u[2],u[3],a,!0)}function o(n){}function m(n,t){var i,r,e,f,o,u,i={};if(t&&t.idMap){for(f in e={},r=n.rO)r.hasOwnProperty(f)&&(e[r[f].getSource().getName()]=r[f]);for(f in o=t.idMap)o.hasOwnProperty(f)&&(u=o[f],i[f]=e[u])}return i}function C(n){var t,i,r,t=n.rO,i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r].getSource().getName());return i}function _(n,t){return p(n,t)}function p(n,t){var i,r,e,f,o,o,o,i=n.t;if(4===i||2===i||3===i||8===i||100===i)(r=new c.Expression(i)).value=n.v;else{if(5===i)(r=new c.Expression(5)).value=c.CalcError.ibt(n.v);else if(6===i)(r=new c.Expression(6)).value=new c.CalcArray(n.v);else if(9===i)r=(0,c.rbt)(n.o,p(n.v,t),n.w&&p(n.w,t));else if(10===i)(r=new c.Expression(10)).value=p(n.v,t);else if(11===i)r=new c.Expression(11);else if(7===i)for(r=new c.Expression(7),n.f&&(r.function=p(n,t)),n.n&&(r.function=t.getFunction(n.n),r.functionName=n.n),e=r.arguments=[],f=0;f<n.p.length;f++)n.p[f]&&(e[f]=p(n.p[f],t));else 1===i?(r=new c.ReferenceExpression(1),(o=n.v.split("*"))[0]&&(r.source=t.getExternalSource("",o[0])),o[1]&&(r.endSource=t.getExternalSource("",o[1])),o[2]&&(r.row=parseInt(o[2],10)),o[3]&&(r.column=parseInt(o[3],10)),o[4]&&(r.endRow=parseInt(o[4],10)),o[5]&&(r.endColumn=parseInt(o[5],10)),o=parseInt(o[6],10),r.rowRelative=!!(o&s),r.columnRelative=!!(o&a),r.endRowRelative=!!(o&l),r.endColumnRelative=!!(o&h),r.isFullRow=!!(o&v),r.isFullColumn=!!(o&d),r.isFullRow&&(r.column=r.endColumn=c.BAND_INDEX_CONST),r.isFullColumn&&(r.row=r.endRow=c.BAND_INDEX_CONST)):13===i?(r=new u.obt,o=n.v,r.abt=o[0],r.source=o[1],r.ubt=o[2],r.sbt=o[3],r.lbt=o[6],r.hbt=o[7],r.source=t.getExternalSource("",r.source),r.abt=t.getTableByName(r.abt)):r&&r.type;n.es&&(r.ensureSingle=!0)}return r}function g(n){return b(n)}function b(n){var t,i,r,r;if(!n)return n;if(t={t:n.type},n.ensureSingle&&(t.es=1),4===n.type||2===n.type||3===n.type||8===n.type||100===n.type)t.v=n.value;else if(5===n.type)t.v=n.value._code;else if(6===n.type)t.v=n.value.array;else if(9===n.type)t.o=n.operatorType,t.v=b(n.value),t.w=n.value2&&b(n.value2);else if(10===n.type)t.v=b(n.value);else if(7===n.type)for((0,c.isExpression)(n.function)?t.f=b(n.function):n.functionName&&(t.n=n.functionName),t.p=[],i=0;i<n.arguments.length;i++)t.p[i]=b(n.arguments[i]);else 1===n.type?(r=(n.rowRelative&&s)|(n.columnRelative&&a)|(n.endRowRelative&&l)|(n.endColumnRelative&&h)|(n.isFullRow&&v)|(n.isFullColumn&&d),r=[n.source&&n.source.getName(),n.endSource&&n.endSource.getName(),n.row,n.column,n.endRow,n.endColumn,r],n.isFullRow&&(r[3]=r[5]=e),n.isFullColumn&&(r[2]=r[4]=e),t.v=r.join("*")):13===n.type?t.v=[n.abt.name(),n.source.getName(),n.ubt,n.sbt,0,0,n.lbt,n.hbt]:n.type;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.exprToJSON=t.exprFromJSON=t.dbt=t.vbt=t.mbt=t.gbt=t.pbt=void 0,c=i("CalcEngine"),u=i("./dist/plugins/sheetsCalc/parser-sheets.js"),e=null,s=1,a=2,l=4,h=8,v=16,d=32,t.pbt=r,t.gbt=f,t.mbt=o,t.vbt=m,t.dbt=C,t.exprFromJSON=_,t.exprToJSON=g},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(N,n,t){var i,H,r,b,g,U,m,q,k,F,s,x,V,T,$,Y,L,X,y,B,z,W,K,Q,A,R,I,E,O,M,j,c,t,t,e,S,u,a,D,J,G,f,e,P,o,l,Z,nn;function h(n,t,i,r,e,f,o){var u=this;u.Zc=n,u.FY=i,u.jpt=r,u.WK=t,B(e)||(u.TZ=e),u.t1e="boolean"==typeof f&&f,u.DJ=o}function v(n,t,i,r,e,f,o){var n,r,n=P.call(this,n,r,e,f,o)||this,r=n;return r.bbt=t,r.ybt=i,n}function tn(n){var t=o.call(this,T)||this;return t.references=n,t}function d(n,t,i,r){var e,t,f,o;for(void 0===r&&(r={}),e=l.call(this,n&&n.Uw(r.sheetArea),t,i,r)||this,n||(n=d.wbt=d.wbt||new H.Worksheet,e.source)||(e.source=n.Uw(r.sheetArea)),e.Mf=n,e.row=i&&i.row||0,e.column=i&&i.col||0,f=(t=n.getCalcService()).getResolvers(),o=0;o<f.length;o++)if(f[o]instanceof g.SheetReferenceResolver)return e;return t.addResolver(new g.SheetReferenceResolver),t.addResolver(new g.StructureReferenceResolver),e}function w(n){this.XRe=n,this.YEi()}function C(n,t,i){var i=Z.call(this,i)||this;return i.getCalcSourceModel=function(){return this.Mbt},i.createSourceModel=function(n){var n=new U.CalcSourceModel(n,this);return n.usedRange=new H.BaseUsedRange,n},i.getRangeKey=function(n,t){return n.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},i.getSheetRangeReference=function(n){var t,t,i,r,e,f,o,t=this.Mf,t=t&&t.parent;if(n.endSource&&t&&t.sheets&&n.endSource instanceof C){for(i=t.sheets,r=!1,e=void 0,f=[],o=0;o<i.length;o++){if((e=i[o].Uw())===this)r=!0;else if(e===n.endSource){f.push(e.getReference(n));break}r&&f.push(e.getReference(n))}return new u(f)}},i.Mf=n,i.t8=new k.Z8(i),i.nT=t||3,i}function _(n){var t=nn.call(this,T)||this;return t.createSourceModel=function(n){return new U.CalcSourceModel(n,this)},t.vpt=n,t.Cbt={},t}function rn(n,t,i,r,e,f){var n,o,n,n=n&&n instanceof H.Worksheet&&n,o=new U.Parser;return i=i===$?0:i,r=r===$?0:r,n=new a(n,!!e,(0,U.eV)(i,r)),f&&(n.culture=!0),o.parse(n,t)}function en(n,t,i,r,e,f){var n,o,e,n=n&&n instanceof H.Worksheet&&n,o=new U.Parser;return i=i===$?0:i,r=r===$?0:r,(e=new a(n,!!e,(0,U.eV)(i,r))).Sbt=f,e.Nme=n&&n.vle,o.unparse(e,t)}function fn(n,t,i,r,e){var f;return on(n,rn(n,t,i=i===$?0:i,r=r===$?0:r,e,!0),i,r)}function on(n,t,i,r,e){var f,o,n,f=n.op();return i===$&&(i=n.getActiveRowIndex()),r===$&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==$&&(o=e.convertNullToZero),n=n.Uw(e&&e.sheetArea),f.evaluateParsedFormula(n,t,(0,U.eV)(i,r),!1,o)}function un(n,t,i,r,e){var f,o,e,n,f=n.op();return i===$&&(i=n.getActiveRowIndex()),r===$&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==$&&(o=e.convertNullToZero),e=n.Uw(),(n=(0,U.eV)(i,r)).Tbt=Math.random().toString(36).substring(2),f.Abt(e,t,n,o)}function p(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,f=n.row,o=n.col,u=n.row+n.rowCount-1,s=n.col+n.colCount-1,c=!1,a=!1,l=!1,h=!1;return 4<=arguments.length&&(f-=(c=0!=(1&r))?t:0,u-=(a=0!=(4&r))?t:0,o-=(l=0!=(2&r))?i:0,s-=(h=0!=(8&r))?i:0),e&&(d=cn(n,e,t),w=an(n,e,t),d)&&w?g.StructureReferenceResolver.create(e,d,w,n.col-e.dataRange().col,n.col+n.colCount-e.dataRange().col-1):1===n.rowCount&&1===n.colCount?(0,U.knt)(T,T,f,o,c,l):(n.row<0&&(f=u=m.BAND_INDEX_CONST),n.col<0&&(o=s=m.BAND_INDEX_CONST),(0,U.lJ)(T,T,f,o,u,s,c,l,a,h,t,i))}function sn(n){return 0<=n.indexOf("[")&&1<n.indexOf("]")}function cn(n,t,i){if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 2;if(t.hasTotalsRow()&&n.row===t.endRow())return 8;if(i===n.row)return 1}else{if(t.hasHeadersRow()&&n.row===t.startRow()){if(n.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1+1)return 14}if(n.row===t.dataRange().row){if(n.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1)return 12}}return $}function an(n,t,i){return n.col===t.startColumn()&&n.colCount===t.dataRange().colCount?1:1===n.colCount?2:n.col>=t.startColumn()&&n.col+n.colCount-1<=t.endColumn()?4:$}function ln(n,t,i,r,e){var n,r,f,e,n=p(n,t,i,r),r=new a(T,!!e,(0,U.eV)(t,i)),f,e=(new U.Parser).unparse(r,n);return r.L0(),e}function hn(n,t,i,r,e,f,o){var t,e,u,t=p(t,i,r,e,o),e=new a(n,!!f,(0,U.eV)(i,r)),u;return(new U.Parser).unparse(e,t)}function vn(n,t,i){if(!n)return!1;var r=!1,e=!1;if(1===t.rowCount){if(n.hasHeadersRow()&&t.row===n.startRow())return!0;if(n.hasTotalsRow()&&t.row===n.endRow())return!0;if(t.row===i&&t.col>=n.startColumn()&&t.col+t.colCount<=n.startColumn()+n.dataRange().colCount)return!0}else n.hasHeadersRow()&&t.row===n.startRow()&&(t.rowCount===n.dataRange().rowCount+1&&(r=!0),n.hasTotalsRow())&&t.rowCount===n.dataRange().rowCount+1+1&&(r=!0),t.row===n.dataRange().row&&(t.rowCount===n.dataRange().rowCount&&(r=!0),n.hasTotalsRow())&&t.rowCount===n.dataRange().rowCount+1&&(r=!0);return t.col+t.colCount<=n.startColumn()+n.dataRange().colCount&&(e=!0),r&&e}function dn(n,t,i,r){var e,t,f,o,u,s,c,a,l,u,s;if(!t)return null;if(i=i||0,r=r||0,o=!1,(t=(e=n.op()).parse(n.Uw(),t,i,r,!0,!0))&&(7===t.type&&"ANCHORARRAY"===t.functionName&&(t=t.arguments[0],o=!0),!(f=t.source)||13!==t.type)&&1===t.type&&t.endSource){for(u=t.source,s=t.endSource,c=u.getSources(s),a=!1,l=0;l<c.length;l++)if(c[l]===n.Uw()){a=!0;break}t=a&&t}return t&&t.getRange&&(!f||f===n.Uw())&&(u=t.getRange(i,r))?(o&&(s=new U.CalcReference(n.qgt,[u]).getSpillRef())&&s.$gt&&(u=s.$gt[0]),new H.Range(u.row,u.col,u.rowCount,u.colCount)):null}function wn(n,t,i,r,e,f,o){var u,s,c,a,l,o,h,v,d,w,m,C,_,p,u=[],s=[];if(t)if(i=i||0,r=r||0,o)try{c=rn(n,t,i,r),(a=n.Lp.evaluateExpression(n.qgt,c,{row:i,col:r},!1,!0))&&a.$gt&&(a.$gt.forEach(function(n){s.push(new H.Range(n.row,n.col,n.rowCount,n.colCount))}),u.push({sheetName:a.rT.getName(),ranges:s}))}catch(n){}else for(l={},o=new U.Parser,h=g.Vgt(o,t,n,i,r,$,e,f),v=0;v<h.length;v++)if((d=h[v].sheetRanges)&&!V(d))for(w=0;w<d.sheets.length;w++)for(m=d.sheets[w],(s=l[m])||(l[m]=s=[],u.push({sheetName:m,ranges:s})),C=d[m],_=0;_<C.length;_++)p=C[_],B(p)||s.push(new H.Range(p.row,p.col,p.rowCount,p.colCount));return u}function mn(n,t,i,r,e){var f,e,f,f=new U.Parser,e=new a(T,!!e,(0,U.eV)(t,i)),f=Cn(f,e,n,t,i,r);return e.L0(),f}function Cn(n,t,i,r,e,f,o){for(var u,s,c,c,a,u="",s=0;s<i.length;s++)c=p(i[s],r,e,f),c=n.unparse(t,c),u+=0<s?(a=o&&b.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+c:c;return u}function _n(t,i,r,e,f,o,u,n){var s,c,a,n,l,h,v,d,w,m,C,_,p,g,s=(n=n||{}).maximumIterations||100,c=n.tolerance||.001,a=function(n){return t.setValue(i,r,n),e.mL(f,o,$,$,{realValue:!0})},n=function(n){var t=(R(n)?+n:0)-u;return R(n)&&Math.abs(t)<c};if(t.suspendPaint(),t.suspendEvent(),l=e.mL(i,r,$,$,{realValue:!0}),C=!1,_=.01,v=R(l)?+l:0,h=e.mL(f,o,$,$,{realValue:!0}),w=(R(h)?+h:0)-u,R(h)&&Math.abs(w)<c)C=!0;else if(y(h))C=!1;else for(d=v+(0===v?_:_*v),p=0;!C&&p<s;p++)h=a(d=b.Common.st.E8(d,13)),m=(R(h)?+h:0)-u,R(h)&&Math.abs(m)<c?C=!0:d=y(h)?(v+d)/2:v-d==0?v+(0===v?_:_*v):w-m==0?v+2*(d-v):(g=d-m*(v-d)/(w-m),v=d,w=m,g);return(C=C||pn(a,n,l,u))||t.setValue(i,r,l),t.resumeEvent(),t.resumePaint(),C}function pn(n,t,i,r){var i,e,f,o,u,s,c,c,i=gn(n,i),e=i.find,f=i.left,o=i.right;if(e)for(u=0;u<100;){if(t(c=n(s=(f+o)/2)))return!0;c=c-r,(n(f)-r)*c<0?o=s:(n(o)-r)*c<0&&(f=s),u++}return!1}function gn(n,t){var i,r,e,f,o,u,i=-1e6,r=1e6,e=1e-5,f=t;return R(n(t))?{find:!0,left:o=bn(n,i,f,e),right:u=xn(n,f,r,e)}:{find:!1,left:0,right:0}}function bn(n,t,i,r){for(var e,f,e=0;e<100;){if(i-t<=r)return i;R(n(f=(i+t)/2))?i=f:t=f,e++}}function xn(n,t,i,r){for(var e,f,e=0;e<100;){if(i-t<=r)return t;R(n(f=(i+t)/2))?t=f:i=f,e++}}i=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}f(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.goalSeek=n.RangeReferenceRelative=n.Ibt=n.rangesToFormula=n.formulaToRanges=n.formulaToRange=n.isStructureReference=n.rangeToFormulaWithStructReference=n.rangeToFormula=n.isValidExternalReference=n.rangeToExpression=n.xbt=n.evaluateExpression=n.evaluateFormula=n.expressionToFormula=n.formulaToExpression=n.SpreadSource=n.SheetSource=n.SheetParserContext=n.SheetRangeReference=n.FormatterNameInfo=n.NameInfo=n.ReferenceStyle=void 0,H=t("Core"),r=t("Core"),b=t("Common"),g=t("./dist/plugins/sheetsCalc/parser-sheets.js"),U=t("CalcEngine"),m=t("./dist/plugins/sheetsCalc/calc.ns.js"),q=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=t("./dist/plugins/sheetsCalc/dynamic-array.js"),F=b.Common.lt,s=b.Common.zf,x=F.Dh,V=F._h,T=null,$=void 0,(Y=["v","n","s","b","d","sn"])[11]="an",L=U.Errors.Value,X=b.Formatter&&b.Formatter.GeneralFormatter,y=U.Convert.BJ,B=F.ht,z=H.mt.xr,W=H.range_parser.jc,K=H.mt.vo,Q=H.Util.addXLFNPrefix,A=b.Common.rbush,R=function(n){return U.Convert.q8(n,!0)},I=H.Range.prototype.contains,E=s.Gmt,O="number",M=H.UsedRangeUtil.updateUsedRangeByData,j="__hyperlink__",c={},(t=U.CalcSource.prototype).referenceToArray=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,s=this,l=1,h=1,m=[],w=n.getRangeCount();if(0===w)m.isError=!0;else{for(p=s.getRowCount(),g=s.getColumnCount(),i=i===$||i,b=0;b<w;b++){if(i||m.push(_=[]),0===(l=n.getRowCount(b)))return m.isError=!0,m;if(0===(h=n.getColumnCount(b)))return m.isError=!0,m;if(v=n.getRow(b),d=n.getColumn(b),2!==i){if(p<=v||g<=d)return(m=[T]).rowCount=1,m.colCount=1,m.rangeCount=1,m;g<d+h&&(h=g-d)}for(p<v+l&&(l=p-v),x=void 0,y=0;y<l;y++)for(c=v+y,i||_.push(x=[]),R=0;R<h;R++){if(C=s.getValue(c,a=d+R),r&&U.Convert.BJ(C))return(m=[C]).isError=!0,m;if(C=U.Convert.Nbt(C,t,!U.ExcelCompatibleCalcMode,f,u),e&&C===U.Convert.CalcConvertedError)return(m=[L]).isConvertError=!0,m;C===T&&f||(2===i?m[y*h+R]=C:(i?m:x).push(C))}}(m=i||1!==w?m:m[0]).rowCount=l,m.colCount=h,m.rangeCount=w}return m},t.getSheetReference=function(){var n=this;return n.kbt=n.kbt||new U.CalcReference(n),n.kbt},(e=t=n.ReferenceStyle||(n.ReferenceStyle={}))[e.a1=0]="a1",e[e.r1c1=1]="r1c1",r.ReferenceStyle=t,h.prototype.getName=function(){return this.Zc},h.prototype.set=function(n,t,i,r,e){this.DJ.qRe(this.Zc,n,t,i,r),this.TZ=e},h.prototype.btV=function(n){this.Zc=n},h.prototype.getRow=function(){return this.FY},h.prototype.getColumn=function(){return this.jpt},h.prototype.getExpression=function(){return this.WK},h.prototype.getComment=function(){return this.TZ},h.prototype.SB=function(n,t,i,r){t&&t.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=n,B(i)||(this.FY=i),B(r)||(this.jpt=r)},h.prototype.isReadOnly=function(n){return"boolean"==typeof n&&(this.t1e=n),this.t1e},n.NameInfo=e=h,r.NameInfo=e,i(v,P=e),v.prototype.getFormatter=function(){return this.bbt},v.prototype.getSheetTabName=function(){return this.ybt},n.FormatterNameInfo=v,U.CalcSource.prototype.createSourceModel=function(n){return new U.CalcSourceModel(n,this)},o=U.CalcReference,i(tn,o),tn.prototype.toArray=function(n,t,i,r,e){for(var f,o,u,s,f=this.references,o=[],u=0;u<f.length;u++){if((s=f[u].rT.referenceToArray(f[u],n,t,i,r,e)).isError&&i)return s;t?Array.prototype.push.apply(o,s):o.push(s),u||(o.rowCount=s.rowCount,o.colCount=s.colCount)}return o.rangeCount=f.length,o},u=tn,n.SheetRangeReference=u,l=U.ParserContext,i(d,l),d.prototype.getExternalSource=function(n,t){var i,r,e,f,o,u,i=this,r=i.Mf.parent,e=i.Mf.Uw();if(n&&(!r||r.name!==n))return T;if(!r)return s.Dbt(i.Mf.name(),t)?e:T;if(sn(t))return r._p.parseSource(t,e.G3);if((f=r.sheets)&&0<f.length)for(o=0;o<f.length;o++)if(u=f[o],s.Dbt(u.name(),t))return u.Uw();return U.ParserContext.prototype.getExternalSource.call(this,n,t)},d.prototype.getExternalSourceToken=function(n){return n.getName(this)},d.prototype.getTableByName=function(n){var t,i,r,e,f,t=this.Mf.tables,i=!0,r=t?t._bt(n,!0):T;if(!r&&(e=this.Mf.parent&&this.Mf.parent.sheets))for(f=0;f<e.length&&(!(t=e[f].tables)||!(r=t._bt(n,!0)));f++);return r||this.Mf.parent&&this.Mf.parent.Ofe(n)},d.prototype.getTableByIndex=function(n,t){var i=this.Mf.tables;return i?i.Hq(n,t,!0):T},d.prototype.setSource=function(n){var n=this.source=n;n&&n.getSheet&&(this.Mf=n.getSheet())},d.prototype.L0=function(){this.Mf&&this.Mf!==d.wbt&&this.Mf.L0(),this.Mf=T},a=d,n.SheetParserContext=a,w.prototype.Oy=function(){return 0===this.$Re.data.length},w.prototype.YEi=function(){var t,n,n,t=this,n=null==(n=this.XRe.Mf)?void 0:n.tables;this.$Re=new A,n&&(n.all().forEach(function(n){n.tFe(t.$Re)}),this.Oy())&&(this.$Re=$),this.nFe=!0},w.prototype.eFe=function(n,t,i,r,e){var f,o,u,f,o=this.$Re;o&&(c.minX=n,c.minY=t,c.maxX=n+i-1,c.maxY=t+r-1,(u=o.search(c)).forEach(function(n){e(n.expr,n.nodes)}))},w.prototype.o_t=function(t,n,i,r){var e,f,o;void 0===i&&(i=1),void 0===r&&(r=1),(f=(e=this).$Re)&&(c.minX=t,c.minY=n,c.maxX=t+i-1,c.maxY=n+r-1,(o=f.search(c)).forEach(function(n){n.currentRow?n.nodes.forEach(function(n){n.row>=t&&t+i>n.row&&n.vyt()}):n.nodes.forEach(function(n){n.vyt()})}))},w.prototype.J_t=function(t){var n,n,n=null==(n=this.XRe.Mf)?void 0:n.tables;this.$Re&&n&&n.all().forEach(function(n){var n;null!=(n=n.aT)&&n.forEach(function(n){n.forEach(function(n){n&&n.w3&&n.w3!==t&&n.vyt&&n.vyt()})})})},w.prototype.a_t=function(t,n,i){var r,e,f,o,r,e=this.$Re;e&&(f=i?1:-1,c.minX=c.maxX=t,c.minY=c.maxY=n,(o=e.search(c)).forEach(function(n){n.currentRow?n.nodes.forEach(function(n){n.row===t&&(n.delay+=f)}):n.nodes.forEach(function(n){n.delay+=f})}))},D=w,Z=U.CalcSource,i(C,Z),C.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},C.prototype.addReferenceSheetName=function(n){var t=this;t.Ebt||(t.Ebt={}),t.Ebt[n]=1},C.prototype.setReferenceSheetNames=function(n){this.Ebt=n},C.prototype.startCalculation=function(){this.jbt,this.Obt(),this.K5=[]},C.prototype.endCalculation=function(n){this.jbt=T,this.Rbt=T,!1!==n&&this.Bbt(),this.K5=T},C.prototype.HJe=function(n,t){n?(this.VJe||(this.VJe=this.jbt,this.YJe=this.Rbt),this.startCalculation()):(this.endCalculation(t),this.jbt=this.VJe,this.VJe=null,this.Rbt=this.YJe,this.YJe=null)},C.prototype._F=function(){var n=this;n.Fbt?n.K5&&(n.Pbt=n.Pbt.concat(n.K5),n.K5=[]):(n.Pbt=n.K5||[],n.Fbt=setTimeout(function(){n.Bbt(n.Pbt),delete n.Pbt,delete n.Fbt},0))},C.prototype.Bbt=function(n){var t,n,i,t,n=n||this.K5;n&&0<n.length&&(t=null==(t=(i=this.Mf).Ut)?void 0:t.W_(3).B8,i.Ut)&&i.ki(H.Events.RangeChanged,{isUndo:!B(t&&t.vE),sheet:i,sheetName:i.name(),row:0,col:0,rowCount:i.getRowCount(),colCount:i.getColumnCount(),changedCells:n,action:6},i.QI)},C.prototype.clearValueCache=function(){this.Obt()},C.prototype.Obt=function(){var n=this.getRowCount(),t=this.getColumnCount();this.jbt={rowCount:n,colCount:t},this.Rbt={arrayInfo:[]}},C.prototype.Gw=function(){this.jbt=T,this.Rbt=T,this.K5=T},C.prototype.getValue=function(n,t){for(var i,r,e,f,o,u,s,n,c,a,l,h,v,d,w,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(f=(e=this).Mf,typeof n==O)o=n,u=arguments[1],t=arguments[2],s=arguments[3];else if(n.row!==$)o=n.row,u=n.col;else if(n.name)return null;return n=e.nT,o<0||u<0?L:f.Gbt&&f.Ubt===o&&f.Hbt===u?f.zbt:(c=e.jbt,a=Y[t=t||0],c?(l=c.rowCount,h=c.colCount,w=d=v=void 0,l<=o||h<=u?T:((w=(d=(d=(v=(v=c[o])||(c[o]={}))[u])||(v[u]={v:s?f.getValueIgnoreDefault(o,u,n,$,!0):e.Mf.mL(o,u,n,$,{realValue:!0})}))[a])===$&&(w=U.Convert.Nbt(d.v,t,!U.ExcelCompatibleCalcMode),d[a]=w),H.mt.V0(w))):o>=e.getRowCount()||u>=e.getColumnCount()?T:s?e.Mf.getValueIgnoreDefault(o,u,n,$,!0):e.Mf.mL(o,u,n,$,{realValue:!0}))},C.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName()+"."+r+"."+e+"."+f+"."+t},C.prototype.getReference=function(n){var t=this,i=n.row,r=n.col;return-1===i&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===r&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new U.CalcReference(t,[n])},C.prototype.getSources=function(n){var t,i,r,e,f;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&n instanceof C){for(t=this.Mf.parent.sheets,i=!1,r=void 0,e=[],f=0;f<t.length;f++){if((r=t[f].Uw())===this&&(i=!0),r===n){e.push(r);break}i&&e.push(r)}return e}},C.prototype.Vbt=function(r,e){var n,f,o,u,n,f=this.Rbt,o=f&&f.arrayInfo;o&&(u=!1,o.forEach(function(n,t){var i,n;n&&(i=n.reference,n=n.key,I.call(i.$gt[0],r,e))&&(delete f[n],o[t]=$,u=!0)}),u)&&(f.arrayInfo=[],o.forEach(function(n){n&&f.arrayInfo.push(n)}))},C.prototype.referenceToArray=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,I,E,O,M,S,D,h=l=1,m=[],p=(s=this).Mf,g=s.jbt,b=s.Rbt,R=Y[t=t||0];if(0===(w=n.getRangeCount()))m.isError=!0;else{if(b&&(C=b[y=n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i]))return C;for(j=this.getRowCount(),N=this.getColumnCount(),i=i===$||i,k=0;k<w;k++){if(i||m.push(_=[]),0===(l=n.getRowCount(k)))return m.isError=!0,m;if(0===(h=n.getColumnCount(k)))return m.isError=!0,m;if(v=n.getRow(k),d=n.getColumn(k),2!==i){if(j<=v||N<=d)return(m=i?[T]:[[T]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;N<d+h&&(h=N-d)}for(j<v+l&&(l=j-v),I=A=void 0,E=p.Gbt,O=0;O<l;O++)for(c=v+O,i||_.push(A=[]),g&&(g[c]||(g[c]={}),x=g[c]),M=0;M<h;M++){if(a=d+M,E&&p.Ubt===c&&p.Hbt===a)C=p.zbt,E=!1;else{if(g?(I=x[a])?C=I.v:(C=p.mL(c,a,s.nT,$,{realValue:!0}),I=x[a]={v:C}):C=p.mL(c,a,s.nT,$,{realValue:!0}),o&&(D=void 0,"@"===(D=(S=p.getFormatter())instanceof X?S.formatString():S)?C=p.getText(c,a):C instanceof Date&&(C=F.uJ(C)),V(I)||(I=x[a]={v:C})),r&&U.Convert.BJ(C))return(m=[C]).isError=!0,m;if(I&&I[R]!==$)C=I[R];else if(C=U.Convert.Nbt(C,t,!U.ExcelCompatibleCalcMode,f,u),I&&(I[R]=C),e&&I===C)return(m=[L]).isConvertError=!0,m}U.Convert.Ybt(C,f)||(2===i?m[O*h+M]=C:(i?m:A).push(C))}}(m=i||1!==w?m:m[0]).rowCount=l,m.colCount=h,m.rangeCount=w,b&&(n.Zbt&&b.arrayInfo.length<200||!isNaN(w)&&!isNaN(l)&&!isNaN(h)&&100<w*l*h&&w*l*h<1e6&&b.arrayInfo.length<50)&&(b[y]=m,b[y].rowCount=l,b[y].colCount=h,b[y].rangeCount=w,b.arrayInfo.push({reference:n,key:y}))}return m},C.prototype.getColumnCount=function(){var n=this.Mf;return n.xT?0:n.getColumnCount(this.nT)},C.prototype.getRowCount=function(){var n=this.Mf;return n.xT?0:n.getRowCount(this.nT)},C.prototype.isHiddenRow=function(n,t){var i=this.Mf,r;return!!(i.iA&&i.iA()||!t)&&0===i.getRowHeight(n)},C.prototype.getName=function(){var n,t,n=this.nT,t=B(this.Wbt)?this.Mf.name():this.Wbt;return n===H.SheetArea.colHeader?t+"CH":n===H.SheetArea.rowHeader?t+"RH":t},C.prototype.setArray=function(n,t,i,r,e){return this.t8.setArray(n,t,i,r,e)},C.prototype.updateItem=function(n,t,i){return this.t8.updateItem(this,n,t)},C.prototype.HE=function(n,t){this.t8.HE(n,t)},C.prototype.setValue=function(n,t,i,r,e,f){var o,u,s,c,a,l,h,h,l,v,d,d,w,m,w,d,m,C,c,c,C,_,p,o=this,u=o.Mf,s=o.nT,c=o.jbt;c&&(l=c[n])&&(h=l[t])&&(!B(i)&&B(i[j])?(h.v=i,a=!0,h.b!==$&&(h.b=$),h.d!==$&&(h.d=$),h.n!==$&&(h.n=$),h.s!==$&&(h.s=$),h.sn=$,h.an=$):delete l[t]),h=H.mt.Z0(i),l=u.Ut,v=!1,d=(d=u.tables)&&d.find(n,t),3===s&&d&&(w=d.showHeader()&&n===d.headerIndex(),m=d.showFooter()&&n===d.footerIndex(),w||m||(v=d.Kbt(n,t,h))),w=u.H3,3===s&&!v&&w&&w._dataSource&&(m=!1,(d=w.getValue(n,t)).hasBinding&&(C=void 0,C=c?(C=(c=c.bindingRows=c.bindingRows||{})[n])||(c[n]=x({},u.getDataItem(n))):x({},u.getDataItem(n)),l.dE(n,t,{gE:C,d6:d.value}),m=w.setValue(n,t,h,l.G8)),v="dataManagerBindingSource"===w.K$?m:d.hasBinding),c=u.pivotTables,3===s&&!v&&c&&(v=c.eJt(n,t,h)),o.Qpe&&!f&&a?o.Qpe[p=s+" "+n+" "+t]=[n,t,s,h]:(v||(!B(h)&&h[j]&&(C=h[j],l.setHyperlink&&l.do("setHyperlink",n,t,_={url:C}),h=h.toString()),l.do("setValue",n,t,h,s,!0,!0,e,!0,!0)),u.iL=!0,this.K5?this.K5.push({row:n,col:t,sheetArea:s}):u.ki(H.Events.CellChanged,{sheet:u,sheetName:u.name(),row:n,col:t,sheetArea:s,propertyName:"value",oldValue:r,newValue:i,KO:!0}))},C.prototype.startIterativeCalc=function(){this.Qpe={}},C.prototype.endIterativeCalc=function(){var n,t,i,r,e,f,o,u,e,s,c,n=this,t=n.Mf,i=t.Ut;for(r in n.Qpe)Object.prototype.hasOwnProperty.call(n.Qpe,r)&&(f=(e=n.Qpe[r])[3],o=e[0],u=e[1],e=e[2],!B(f)&&f[j]&&(s=f[j],i.setHyperlink&&i.do("setHyperlink",o,u,c={url:s}),f=f.toString()),i.do("setValue",o,u,f,e,!0,!0,!1,!0,!0),t.iL=!0,this.K5?this.K5.push({row:o,col:u,sheetArea:e}):t.ki(H.Events.CellChanged,{sheet:t,sheetName:t.name(),row:o,col:u,sheetArea:e,propertyName:"value",KO:!0}));delete n.Qpe},C.prototype.getCustomFunction=function(n){return this.Mf?this.Mf.Jbt(n):T},C.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():T},C.prototype.getCustomNameInfo=function(n){return n=E(n),this.Mf?this.Mf.getCustomName(n):T},C.prototype.getSheet=function(){return this.Mf},C.prototype.setFormula=function(n,t,i,r,e){var f,o,u,s,c,o,c,f=this;f.Mf.Ut.G8&&(s=f.Mf.Ut.G8.formulas,u=f.getCalcSourceModel(),s=s||(f.Mf.Ut.G8.formulas={}),-1<=n)&&-1<=t&&((c=f.getCalcService()).backupR1C1Formula&&(o=f.Mbt.pB(n,t),i=en(f.Mf,o,n,t,!0,!1)),!r&&c.allowDynamicArray&&(r=f.Mbt.sT(n,t)),o=(o=s[n])||(s[n]={}),i&&"="===i[0]&&(i=i.substring(1)),c=o[t]&&o[t].formula,e?o[t]&&void 0!==o[t].oldFormula||(r=x({},r),o[t]=x({},o[t],{oldFormula:i,oldArrayInfo:r}),i)||delete o[t].oldArrayInfo:(o[t]=x({},o[t],{formula:i,arrayInfo:r}),i||delete o[t].arrayInfo,u.usedRange&&M(u.usedRange,n,t,c,i)))},C.prototype.isFormulaHidden=function(n,t){var i,r,i,e,f,i=this,r;return!!(i.getCalcSourceModel().getFormula(n,t)&&(i=i.Mf)&&(e=i.isActualProtected())&&(f=i.l0(n,t,"hidden")))},C.prototype.setArrayFormula=function(n,t,i,r,e){var f;this.setFormula(n,t,e,{row:n,col:t,rowCount:i,colCount:r})},C.prototype.setFormulaByName=function(n,t,i){var r,e,r,r=this;r.Mf.Ut.G8&&((r=(r=(e=(e=r.Mf.Ut.G8.formulas)||(r.Mf.Ut.G8.formulas={})).names)||(e.names={}))[n]=x({},r[n],{formula:t,oldFormula:i}))},C.prototype.refresh=function(){var n=this.Mf.parent;n&&n.repaint()},C.prototype.toJSON=function(n,t,i,r,e){var f,o,u,s,c,a,t,l,h,v,d,w,m,C,_,p,g,b,a,x,y,R,j,N,k,A,I,E,E,O,o=t,t=this.Mf,l=n.data||{},h=!0,v=this.op(),d=this===t.qgt,C=0;for(d&&(w=(0,U.createMap)(),t.Xbt=m={}),_=v.forceR1C1Formula&&!t.isReportTemplateSheet,p=0;p<=i;p++)if(f=l.dataTable||{},u=o[p]){for(h=!(c=f[p]),c=c||{},g=0;g<=r;g++)if(b=(s=u[g])&&s.WK,a=s&&s.calc&&s.calc.isDefault(),s&&!a&&(b||s.qbt)){a=c[g]||{};try{y=x=void 0,d&&b&&!s.$bt&&(R=b.tyt=b.tyt||v.unparse(this,b,p,g,$,2)).indexOf("!")<0&&(!(j=w.get(R))||j.baseColumn>g?_?(y=R,w.set(R,{formula:y,baseRow:p,baseColumn:g})):(y=v.unparse(this,s.WK,p,g,!1,!0)).indexOf("[")<0&&w.set(R,{formula:y,baseRow:p,baseColumn:g}):(x=j.obj)?((k=m[x.si]).lastRow=p,k.lastColumn=Math.max(g,k.lastColumn)):(x=j.obj={si:C},m[C]={formula:j.formula,baseRow:j.baseRow,baseColumn:j.baseColumn,lastRow:p,lastColumn:g},(N=p===j.baseRow?c:f[j.baseRow])[j.baseColumn].formula=j.obj,C++)),y=s.qbt||x||y||v.unparse(this,b,p,g,!1,_?2:1),s.$bt?s.$bt.row===p&&s.$bt.col===g&&(a.arrayInfo=s.$bt,a.formula=y):a.formula=y,h=!1,c[g]=a}catch(n){}}if(h){if(f!==l.dataTable)continue}else f[p]=c;l.dataTable=f}if(m&&(m.nextIndex=C),e){for(A=l.columnDataArray||[],I=0;I<e.length;I++)(E=e[I])&&E.WK&&(E=this.op().unparse(this,E.WK,0,I,!1,!0),(O=A[I]||{}).formula=E,A[I]=O);0<A.length&&(l.columnDataArray=A)}V(l)||(n.data=l)},C.prototype.iFe=function(){return this.rFe=this.rFe||new D(this),this.rFe.nFe||this.rFe.YEi(),this.rFe},C.prototype.oFe=function(){this.rFe&&(this.rFe.nFe=!1)},C.prototype.wh=function(n,V,T,Y,L,t){var r,i,e,f,o,u,s,c,X,a,l,h,v,d,J,w,m,C,_,p,g,G,P,b,x,y,R,j,N,k,A,I,E,O,M,S,D,F,r=z(n,H.XFileConstants.bo),i=this.op();for(i.nyt=!0,s=H.Util.ko(t),h=0,(X=this===(c=this.Mf).qgt)&&(a=(0,U.createMap)(),c.Xbt=l={}),v=n.lossless.exprs=[],d=s&&(null==t?void 0:t.saveR1C1Formula)&&!c.isReportTemplateSheet,J=!s&&!1===(null==t?void 0:t.exportSharedFormula),w=[],n.richValueDataArray=[],m=0;m<=T;m++)if(e=V[m],o=r[m],e)for(o=o||(r[m]={}),C=0;C<=Y;C++)if(f=e[C],u=o[C],_=f&&f.WK,g=!(p=[]),G=f&&f.calc&&f.calc.isDefault(),f&&!G&&_){u=u||{},s||7!==_.type||"IMAGE"!==_.functionName||(g=!0,3<(P=_.arguments).length&&(p=_.arguments.splice(5)));try{y=x=b=void 0,R=-1,(j=f.$bt)||(N=this.t8.Pme(m,C))&&(j={row:m,rowCount:N.maxX-m+1,col:C,colCount:N.maxY-C+1,isDynamicArray:!0},N.isValid||(j.isInvalid=!0)),X&&!j&&!J&&(k=_.tyt=_.tyt||i.unparse(this,_,m,C,$,2),s||k.indexOf("!")<0)&&(!(A=a.get(k))||A.baseColumn>C?d?(x=k,a.set(k,{formula:x,baseRow:m,baseColumn:C})):(x=i.unparse(this,_,m,C,$,1)).indexOf("[")<0&&a.set(k,{formula:x,baseRow:m,baseColumn:C}):((b=A.obj)?((I=l[b.si]).lastRow=m,I.lastColumn=Math.max(C,I.lastColumn)):(b=A.obj={si:h},l[h]={formula:A.formula,baseRow:A.baseRow,baseColumn:A.baseColumn,lastRow:m,lastColumn:C},h++),y=b.si,x=void 0)),B(y)&&(x=f.qbt||x||i.unparse(this,_,m,C,!1,d?2:1),t&&t.includeCalcModelCache&&(E=(0,q.exprToJSON)(_),f.eyt||(E.nw=1),v.push(E),R=v.length-1),x=K(Q(x))),j?(j.row===m&&j.col===C&&(O=W(j),(j.isInvalid||!j.rowCount)&&0<O.indexOf(":")&&(O=O.substring(0,O.indexOf(":"))),u.f=x,u.r=O),j.isDynamicArray&&(u.a="1",j.isInvalid||t.fileType!==H.OpenSaveFileType.excel||w.push(j))):(u.f=x,u.g=y,u.c=1,g&&(M=u.v&&u.v.value.imageBase64Data,B(M)||(S={url:_.arguments[0]&&_.arguments[0].value,ref:H.IndexHelper.nr(C)+(m+1),f:x,structureMap:{}},_.arguments[1]&&!B(_.arguments[1].value)&&(S.structureMap.a=_.arguments[1].value),_.arguments[2]&&!B(_.arguments[2].value)&&(S.structureMap.s=_.arguments[2].value),_.arguments[3]&&!B(_.arguments[3].value)&&(S.structureMap.h=_.arguments[3].value),_.arguments[4]&&!B(_.arguments[4].value)&&(S.structureMap.w=_.arguments[4].value),S.imageBase64Data=M,n.richValueDataArray.push(S)),u.v="#VALUE!",u.t="e")),-1!==R&&(u.x=R)}catch(n){}g&&0<p.length&&(_.arguments=_.arguments.concat(p)),o[C]=u}for(D in l)Object.prototype.hasOwnProperty.call(l,D)&&(F=l[D],O=W(new H.Range(F.baseRow,F.baseColumn,F.lastRow-F.baseRow+1,F.lastColumn-F.baseColumn+1)),(u=r[F.baseRow][F.baseColumn]).r=O,u.g=parseInt(D,10));w.forEach(function(n){for(var t,i,t=n.row;t<n.row+n.rowCount;t++)for(i=n.col;i<n.col+n.colCount;i++)(u=r[t]&&r[t][i])&&(u.t2=!0)}),delete i.nyt},(n.SheetSource=J=C).prototype.getParserContext=function(n,t,i){return t=t||(0,U.eV)(0,0),new a(this.Mf,n,t,i)},nn=U.CalcSource,i(_,nn),_.prototype.addUsedCustomName=function(n){this.Cbt[n]=1},_.prototype.getUsedCustomNames=function(){return this.Cbt||{}},_.prototype.getCustomFunction=function(n){return this.vpt?this.vpt.getCustomFunction(n):T},_.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():T},_.prototype.getCustomNameInfo=function(n){return this.vpt?this.vpt.getCustomName(n)||this.vpt.xO(n):T},n.SpreadSource=_,n.formulaToExpression=rn,n.expressionToFormula=en,n.evaluateFormula=fn,n.evaluateExpression=on,n.xbt=un,n.rangeToExpression=p,n.isValidExternalReference=sn,n.rangeToFormula=ln,n.rangeToFormulaWithStructReference=hn,n.isStructureReference=vn,n.formulaToRange=dn,n.formulaToRanges=wn,n.rangesToFormula=mn,n.Ibt=Cn,n.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},n.goalSeek=_n},"./dist/plugins/sheetsCalc/calc.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=t.BAND_INDEX_CONST=void 0;var i=i("Core");t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=i.XmlConstants.Io,t.MAX_COLUMN_COUNT=i.XmlConstants.xo},"./dist/plugins/sheetsCalc/dynamic-array.js":function(n,t,i){var w,r,h,v,e,m,C,f;function c(n){return n.isValid}function o(n){return{row:n.minX,col:n.minY,rowCount:n.maxX-n.minX+1,colCount:n.maxY-n.minY+1,isValid:n.isValid}}function u(n){this.Gme=new r.Common.rbush,this.rT=n}Object.defineProperty(t,"__esModule",{value:!0}),t.Z8=void 0,w=i("Core"),r=i("Common"),h=i("CalcEngine"),v=i("CalcEngine"),e=null,m=void 0,C=r.Common.lt.ht,u.prototype.Ume=function(){return this.rT.Mf.Ut},u.prototype.L0=function(){this.rT=e,this.Gme=e},u.prototype.Fme=function(){var n=this.Gme.data;if(n&&isFinite(n.minX))return{minRow:n.minX,minCol:n.minY,maxRow:n.maxX,maxCol:n.maxY}},u.prototype.jme=function(n,t,i,r){return this.Gme.search({minX:n,minY:t,maxX:n+(i=void 0===i?1:i)-1,maxY:t+(r=void 0===r?1:r)-1})},u.prototype.Pme=function(t,i){return this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0]},u.prototype.Hme=function(n,t){return this.jme(n,t).filter(c)[0]},u.prototype.zme=function(){var n,n,n=this.Ume();return n.G8?(n.G8.calc=n.G8.calc||[],(n=n.G8.calc).Vme=n.Vme||[],n.Vme):[]},u.prototype.Fgt=function(t,i,r,e){var f,o,u,n,s,f=this;void 0===r&&(r=1),void 0===e&&(e=1),o=this.jme(t,i,r,e),u=this,n=o.filter(function(n){return n.minX>=t&&n.minX<t+r&&n.minY>=i&&n.minY<i+e}),s=this.b3(),n.forEach(function(n){n.isValid&&s.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1),u.Rme(n),u.Lme(n,!0)}),o.filter(c).forEach(function(n){u.Rme(n),o=o.concat(f.jme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1))}),o.forEach(function(n){n.isValid||(u.Yme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1)?s.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1):s.gF(n.minX,n.minY,1,1))})},u.prototype.getAnchorCell=function(t,i){var n=this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0];return n&&o(n)},u.prototype.getAnchorInfo=function(t,i,n){var r,r,r=this.jme(t,i),r=r.filter(function(n){return n.minX===t&&n.minY===i})[0]||r.filter(c)[0];return r&&o(r)},u.prototype.setValue=function(n,t,i,r){r?this.Ume().setValue(n,t,i,3,!0,!0,!1,!1,!0):this.pBt().setValue(n,t,i)},u.prototype.b3=function(){return this.rT.Mbt},u.prototype.pBt=function(){return this.rT},u.prototype.Rme=function(n,t,i,r){var e,f;if(n){if(n.isValid){for(e=n.minX;e<=n.maxX;e++)for(f=n.minY+(e===n.minX?1:0);f<=n.maxY;f++)this.setValue(e,f,m,i);n.isValid=!1,i&&this.zme().push([n,"isValid",!0]),t||this.setValue(n.minX,n.minY,v.Errors.Spill,i)}t&&(this.Lme(n,i),r||this.setValue(n.minX,n.minY,m,i))}},u.prototype.Lme=function(n,t){this.Gme.remove(n),t&&this.zme().push([n])},u.prototype.Bme=function(n,t){this.Gme.insert(n),t&&this.zme().push([m,n])},u.prototype.HE=function(n,t){this.Pme(n,t).isValid=!1},u.prototype.Yme=function(n,t,i,r,e){for(var f,o,u,s,c,a,l,a,h,v,d,f=this.Gme.search({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1}),o=this.pBt(),u=this.b3(),s=0;s<f.length;s++)if((c=f[s]).isValid&&(c.minX!==n||c.minY!==t))return!1;if(t+r>o.getColumnCount()||n+i>o.getRowCount())return!1;if(a=(0,w.Ec)(n,t,i,r),(l=o.Mf).Ut.getSpans(a).length)return!1;if((a=l.tables)&&a.Pl&&a.Pl(n,t,i,r))return!1;for(h=n;h<n+i;h++)for(v=t+(h!==n||e?0:1);v<t+r;v++)if(d=o.getValue(h,v,m,!0),!C(d)||u.hasFormula(h,v,!0))return!1;return!0},u.prototype.Zme=function(n,t,i,r,e){var f;this.Gme.insert({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:e})},u.prototype.setArray=function(n,t,i,r,e,f,o){var u,s,c,a,l,u=this,s=this.Pme(n,t);if(s&&s.maxX===n+i-1&&s.maxY===t+r-1&&s.isValid||(u.Rme(s,!0,o),s={minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:!0},f||(s.isValid=u.Yme(n,t,i,r)),u.Bme(s,o)),s.isValid)for(c=n;c<n+i;c++)for(a=t;a<t+r;a++)e&&e[c-n]&&(l=e[c-n][a-t],C(l)?l=0:(h.Convert.Nh(l)||h.Convert.LE(l))&&(l=1===l.getRowCount()&&1===l.getColumnCount()?h.Convert.Nh(l)?l.getValue(0,0):l.getValue(0,0,0):v.Errors.Calc),this.setValue(c,a,l,o));else this.setValue(n,t,v.Errors.Spill,o);return s.isValid},u.prototype.updateItem=function(n,t,i){var t=this.Pme(t,i);if(t)return this.Rme(t,!0),!0},u.prototype.rE=function(r,e){var f=this,n;f.jme(r,-1,h.MAX_ROW_COUNT,-1).forEach(function(n){var t,i;if(n.minX>=r)f.Gme.remove(n),n.minX+=e,n.maxX+=e,f.Gme.insert(n);else if(n.maxX>=r)if(n.isValid){for(t=r;t<=n.maxX;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t+e,i));for(t=n.maxX+1;t<=n.maxX+e;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,m)}else f.b3().Gde(n.minX,n.minY)})},u.prototype.aE=function(f,o,u){var s=this,n;s.jme(f,-1,h.MAX_ROW_COUNT,-1).forEach(function(n){var t,i,r,e;if(n.minX>=f+o)s.Gme.remove(n),n.minX-=o,n.maxX-=o,s.Gme.insert(n);else if(n.minX>=f)s.Rme(n,!0,u);else if(n.maxX>=f&&n.isValid)if(t=n.maxX>f+o-1?n.maxX+1:f+o,i=n.maxX>f+o-1?o:n.maxX-f+1,s.Yme(t,n.minY,i,n.maxY-n.minY+1,!0))for(r=n.maxX;f<=r;r--)for(e=n.minY;e<=n.maxY;e++)s.setValue(r+o,e,s.pBt().getValue(r,e),u);else s.Rme(n,!1,u)})},u.prototype.Eme=function(t,i){var r=this,n;r.jme(t,-1,h.MAX_ROW_COUNT,-1).forEach(function(n){n.minX>=t&&(r.Gme.remove(n),n.minX+=i,n.maxX+=i,r.Gme.insert(n))})},u.prototype.oE=function(r,e){var f=this,n;this.jme(-1,r,-1,h.MAX_COLUMN_COUNT).forEach(function(n){var t,i;if(n.minY>=r)f.Gme.remove(n),n.minY+=e,n.maxY+=e,f.Gme.insert(n);else if(n.maxY>=r)if(n.isValid){for(t=n.minX;t<=n.maxX;t++)for(i=r;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t,i+e));for(t=n.minX;t<=n.maxX;t++)for(i=n.maxY+1;i<=n.maxY+e;i++)f.pBt().setValue(t,i,m)}else f.b3().Gde(n.minX,n.minY)})},u.prototype.uE=function(f,o,u){var s=this,n;this.jme(-1,f,-1,h.MAX_COLUMN_COUNT).forEach(function(n){var t,i,r,e;if(n.minY>=f+o)s.Gme.remove(n),n.minY-=o,n.maxY-=o,s.Gme.insert(n);else if(n.minY>=f)s.Rme(n,!0,u);else if(n.maxY>=f&&n.isValid)if(t=n.maxY>f+o-1?n.maxY+1:f+o,i=n.maxY>f+o-1?o:n.maxY-f+1,s.Yme(n.minX,t,n.maxX-n.minX+1,i,!0))for(r=n.minX;r<=n.maxX;r++)for(e=n.maxY;f<=e;e--)s.setValue(r,e+o,s.pBt().getValue(r,e),u);else s.Rme(n,!1,u)})},u.prototype.Ome=function(t,i){var r=this,n;this.jme(-1,t,-1,h.MAX_COLUMN_COUNT).forEach(function(n){n.minY>=t&&(r.Gme.remove(n),n.minY+=i,n.maxY+=i,r.Gme.insert(n))})},u.prototype.Wme=function(n){for(var t,i,r,e,r,t=this,i=n.length-1;0<=i;i--)e=(r=n[i])[0],2<r.length?e[r[1]]=r[2]:1<r.length?t.Gme.remove(r[1]):(r=t.Pme(e.minX,e.minY),t.Rme(r,!0),t.Gme.insert(e))},t.Z8=u},"./dist/plugins/sheetsCalc/external-reference.js":function(n,t,i){var r,j,l,M,o,i,N,k,S,D,A,h,I,E,f,e,u,s;function v(n,t){var i,r;if(Array.isArray(n))n.forEach(t);else if("object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&t(r=n[i],i)}function d(n){return n}function c(n){return"string"==typeof n&&"/OADate("===n.substr(0,8)?parseFloat(n.substr(8,n.length-10)):n}function w(n){var n,t,n=n.value;return n&&n.richText?(t="",n.richText.forEach(function(n){t+=n.text}),t):c(n)}function a(n,t,i){var r,n,e,i,r=s.call(this,D)||this;return r.getSheetRangeReference=function(n){var t,i,r,e,f,t=this.rT.sheetNames;if(n.endSource&&t&&n.source instanceof a){for(i=!1,r=[],e=0;e<t.length&&((i=t[e]===n.source.oyt?!0:i)&&(f=new a("["+this.rT.i+"]"+t[e],this.ayt,!0),r.push(f.getReference(n))),t[e]!==n.endSource.oyt);e++);return new o.SheetRangeReference(r)}return M.Errors.Name},n=n.split("]"),i&&(e=n[0].substring(1)),t.iyt[e]?r.rT=t.iyt[e]:(i=n[0].indexOf("["),r.rT=t.ryt(n[0].substring(i+1),n[0].substring(0,i),!0)),r.oyt=n[1],r.ayt=t,r}function m(n,t){var i,r,e;if(n)for(i in n)A(n,i)&&(e=(r=n[i]).getExpression())&&e.forEachNodes(function(n){(1===n.type||5===n.type||8===n.type)&&n.source instanceof f&&(t[n.source.rT.i]=!0)})}function C(n,t){var t=n.getRange(t.row,t.column);return t.sheetName=n.source.oyt,t}function _(n){this.iyt=n||{},this.uyt={},this.syt()}r=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalReferenceManager=t.ExternalSource=void 0,j=i("Core"),l=i("Common"),M=i("CalcEngine"),o=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=l.Common.lt,N=j.XFileConstants.Rr,k=j.XFileConstants.Lr,S=void 0,D=null,A=l.Common.kh,h=i.ht,I=j.Util.wr,E=j.Util.Mr,s=M.CalcSource,r(a,s),a.prototype.cyt=function(n,t,i){var r,e,r=n.getKey();this.rT=this.ayt.fyt(this.rT),this.eme(),e=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},t?e[r]?e[r][1].push(i):e[r]=[n,[i]]:e[r]&&delete e[r]},a.prototype.eme=function(){this.rT.data=this.rT.data||{};var n=this.rT.data[this.oyt];return n||(this.rT.sheetNames.push(this.oyt),n=this.rT.data[this.oyt]={isNew:!0}),n},a.prototype.getValue=function(n,t){var i,n,i,i=this.eme(),n=i[n];return!n||h(n[t])?!i.isNew||n&&n.hasOwnProperty(t)?0:M.Errors.Reference:(i=n[t])&&i._code&&(i._error||i._calcError)?new M.CalcError(i._error||i._calcError):i},a.prototype.getRowCount=function(){return M.MAX_ROW_COUNT},a.prototype.getColumnCount=function(){return M.MAX_COLUMN_COUNT},a.prototype.createSourceModel=function(){return D},a.prototype.getCalcSourceModel=function(){return D},a.prototype.setCalcSourceModel=function(){},a.prototype.getPeerSource=function(n){return new a("["+this.rT.i+"]"+n,this.ayt,!0)},a.prototype.getSources=function(n){var t,i,r,e,f,t=this.rT.sheetNames,i=[];if(n&&t&&n.oyt)for(r=!1,e=0;e<t.length&&((r=t[e]===this.oyt?!0:r)&&(f=new a("["+this.rT.i+"]"+t[e],this.ayt,!0),i.push(f)),t[e]!==n.oyt);e++);return i},a.prototype.referenceToArray=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,I,E,O,s=this,l=1,h=1,m=[],p=s.rT.Rbt,g=s.oyt+n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i;if(p){if(p.has(g))return p.get(g)}else p=s.rT.Rbt=(0,M.createMap)();if(0===(w=n.getRangeCount()))m.isError=!0;else{for(y in b=-1,x=s.eme())x.hasOwnProperty(y)&&(R=Number(y),!isNaN(R))&&b<R&&(b=R);if(-1===b)(m=[M.Errors.Reference]).isError=!0;else{for(j=b+1,N=s.getColumnCount(),i=i===S||i,k=0;k<w;k++){if(i||m.push(_=[]),v=n.getRow(k),d=n.getColumn(k),0===(l=n.getRowCount(k)))return m.isError=!0,m;if(-1===l&&(v=0,l=j),0===(h=n.getColumnCount(k)))return m.isError=!0,m;if(-1===h&&(d=0,h=N),j<=v||N<=d)return(m=i?[D]:[[D]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;for(j<v+l&&(l=j-v),N<d+h&&(h=N-d),A=void 0,I=!1,E=0;E<l;E++)for(c=v+E,i||_.push(A=[]),O=0;O<h;O++)C=s.getValue(c,a=d+O),I||(C=M.Convert.Nbt(C,t,!M.ExcelCompatibleCalcMode,f,u),r&&M.Convert.BJ(C)&&(I=(m=[C]).isError=!0),M.Convert.Ybt(C,f))||(i?m:A).push(C);if(I)return m}(m=i||1!==w?m:m[0]).rowCount=l,m.colCount=h,m.rangeCount=w,p&&p.set(g,m)}}return m},a.prototype.getName=function(n){var n,n=this.Dfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||n&&n.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return n+this.oyt},a.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName(n)+"."+r+"."+e+"."+f+"."+t},a.prototype.getReference=function(n){var t=this,i=n.row,r=n.col;return-1===i&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===r&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new M.CalcReference(t,[n])},f=a,t.ExternalSource=f,_.prototype.parseSource=function(n,t){return new f(n,this,t)},_.prototype.ryt=function(n,t,i,r){var e,f;for(e in this.iyt)if(A(this.iyt,e)&&(f=this.iyt[e])&&f.option.name===n&&f.option.path===t)return f;if(!i)for(e in this.iyt)if(A(this.iyt,e)&&(f=this.iyt[e]).option.name===n&&""===t)return f;return r?S:{option:{name:n,path:t},sheetNames:[],data:{}}},_.prototype.syt=function(){for(var n in this.iyt)this.iyt[n]&&(this.iyt[n].i=n)},_.prototype.fyt=function(n){var t,t,t=this.ryt(n.option.name,n.option.path,!0,!0);return t||(t=Object.keys(this.iyt).length+1,(this.iyt[t]=n).i=t,n)},_.prototype.Ep=function(n){var t,i,r,e,f,o,i={},r={},e=1;for(f in this.iyt)A(this.iyt,f)&&(this.uyt[f]&&!j.GC$.isEmptyObject(this.uyt[f])||(t||(t={},m(n.hyt,t),n.sheets.forEach(function(n){m(n.hyt,t)})),t[f]))&&(i[(o=this.iyt[f]).i=e]=o,r[e]=this.uyt[f],e++);this.iyt=i,this.uyt=r},_.prototype.toJSON=function(){var n,t,i,n={};for(t in this.iyt)A(this.iyt,t)&&(i=this.iyt[t],n[t]={option:{name:i.option.name,path:i.option.path},sheetNames:i.sheetNames,data:i.data});return n},_.prototype.wh=function(n){var g,b,t,x,y,R,i,r,g=this.iyt,b=[],t={n_:"externalReferences",c_:b},x={},y=n.workbook.rels,R=0,i=function(n){var t,i,r,n,e,f,o,u,s,c,a,l,h,v,d,w,m,C,_,p;if(A(g,n)){for(R++,i=(t=g[n]).option.id=N+I(y),y.c_.push({n_:k,Id:i,Type:j.RelationshipConstants.uc,Target:E(j.XFileConstants.nu+"/"+j.XFileConstants.tu+n)}),b.push({n_:"externalReference","r:id":i}),n={n_:"sheetNames",c_:r=[]},e={n_:"sheetDataSet",c_:[]},(f=t.sheetNames)&&f.forEach(function(n){r.push({n_:"sheetName",val:j.mt.Nfe(n)})}),o=t.data,u=0,s=f.length;u<s;u++)if(c=o&&o[f[u]]){for(h in a={n_:j.XFileConstants.bo,sheetId:u},c.isNew&&(a.refreshError=1),l=[],c)if(c.hasOwnProperty(h)&&(v=parseInt(h,10)+1,!isNaN(v))){for(C in m={n_:"row",r:v,c_:w=[]},d=c[h])d.hasOwnProperty(C)&&(_=d[C],(p={n_:"cell"}).r=j.IndexHelper.nr(parseInt(C,10))+v,"string"==typeof _?p.t="str":"boolean"==typeof _?(p.t="b",_=_?"1":"0"):_&&_.code&&(p.t="e","#SPILL!"!==(_=_._calcError||_.error)&&"#CALC!"!==_||(_="#VALUE!")),p.c_=[{n_:"v",c_:[_]}],w.push(p));l.push(m)}a.c_=l,e.c_.push(a)}x[i]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[n,0<e.c_.length?e:D]}],option:t.option}}};for(r in g)i(r);return{externalReferencesNode:t,externalLinks:x,count:R}},_.prototype.dyt=function(n,i,t,e){var r,f,o,r,n,u,s,c,a,r=i&&i.sheets&&Object.keys(i.sheets),f=r&&i.sheets[r[0]].data&&i.sheets[r[0]].data.dataTable,o=f?w:d,r=this.ryt(n,t||"",S,!0);if(!h(r)){for(a in n=r.i,delete(u=this.iyt[n]).Rbt,s=this.uyt[n]||{},u.ime=new l.Common.rbush,c=function(n){var t;A(s,n)&&((t=s[n][0]).vyt(),s[n][1].forEach(function(n){var n=n.getRange(t.row,t.column);u.ime.insert({minX:n.row,minY:n.col,maxX:n.row+n.rowCount-1,maxY:n.col+n.colCount-1})}))},s)c(a);u.sheetNames.forEach(function(n){var t,r,t=f?i.sheets[n]&&i.sheets[n].data.dataTable:i&&i[n];t&&(u.data[n]&&e?e&&delete u.data[n].isNew:u.data[n]={},r=u.data[n],v(t,function(n,i){u.ime.collides({minX:i,minY:-1,maxX:i,maxY:-1})&&(r[i]=r[i]||{},v(n,function(n,t){u.ime.collides({minX:i,minY:t,maxX:i,maxY:t})&&(r[i][t]=o(n))}))}))})}},_.prototype._6=function(t,n,i,r){var e,f,e=this;"string"==typeof t?e.dyt(t,n,i,r):t&&(f=e.myt(!0)).forEach(function(n){t[n.filePath+n.name]&&e.dyt(n.name,t[n.filePath+n.name],n.filePath,r)})},_.prototype.myt=function(n){var t,i,r,e,f,o,u,t=[];for(i in this.iyt)if(A(this.iyt,i)){if(r=this.iyt[i],e={name:r.option.name,filePath:r.option.path},n)for(u in f=this.uyt[i]||{},e.items=[],o=function(n){var t,i,n,n;A(f,n)&&(i={row:(t=f[n][0]).row,col:t.column,sheetName:t.w3.rT.getName()},n=1===(n=f[n][1]).length?C(n[0],t):n.map(function(n){return C(n,t)}),e.items.push({target:i,source:n}))},f)o(u);t.push(e)}return t},t.ExternalReferenceManager=_},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(f,n,t){var fn,u,ln,j,y,on,L,t,A,un,w,sn,cn,C,g,I,E,M,T,c,i,o,m,t;function a(n,t){var i,r,e,n,i=w(n.row,(t=t||this).row),r=w(n.column,t.column),e=un(n.row+n.rowCount,t.row+t.rowCount),n=un(n.column+n.columnCount,t.column+t.columnCount);return e<=i||n<=r?cn:{row:i,column:r,rowCount:e-i,columnCount:n-r,intersectWith:a}}function H(n,i,r){var e=[];return n.forEachNodes&&n.forEachNodes(function(n){var t;1===n.type&&((n.endSource?null:n.source||r)===i?e.push(n):i===r&&((n.rowRelative||n.endRowRelative)&&(e.rc=!0),n.columnRelative||n.endColumnRelative)&&(e.cc=!0))}),e}function U(n,t,i,r){var e,f,o,u,s,c,e=(0,fn.createSet)(),f=(0,fn.createSet)(),o=H(n,t,i);if(r)for(u=o.rc,s=0;s<o.length;s++)(c=o[s]).isFullColumn||((c.rowRelative?e:f).add(c.row),c.endRowRelative?e.add(c.endRow):!1===c.endRowRelative&&f.add(c.endRow));else for(u=o.cc,s=0;s<o.length;s++)(c=o[s]).isFullRow||((c.columnRelative?e:f).add(c.column),c.endColumnRelative?e.add(c.endColumn):!1===c.endColumnRelative&&f.add(c.endColumn));return[Array.from(e),Array.from(f),u]}function v(n,t,i,r,e,f){return n?f?i<=e+t&&e+t<i+r?"2":e+t<i&&i<=e||e<i&&i<=e+t?"1":"0":i+r<=e+t?"1":i<=e+t?"2":"0":i+r<=t?"1":i<=t?"2":"0"}function $(n,t,i,r,e,f,o){var u,s,c,a,l,h,u=[],s=!1;if(f&&(o?n.rc:n.cc)&&(u.push("9"),s=!0),o){for(c=0;c<n.length;c++)if(!(a=n[c]).isFullColumn&&("0"!==(l=v(a.rowRelative,a.row,t,i,r,e))&&(s=!0),u.push(l),!L(a.endRow))){if(h=v(a.endRowRelative,a.endRow,t,i,r,e),"2"===l&&"2"!==h&&a.endRowRelative||"2"!==l&&"2"===h&&a.rowRelative)return-1;"0"!==h&&(s=!0),u.push(h)}}else for(c=0;c<n.length;c++)if(!(a=n[c]).isFullRow&&("0"!==(l=v(a.columnRelative,a.column,t,i,r,e))&&(s=!0),u.push(l),!L(a.endColumn))){if(h=v(a.endColumnRelative,a.endColumn,t,i,r,e),"2"===l&&"2"!==h&&a.endColumnRelative||"2"!==l&&"2"===h&&a.columnRelative)return-1;"0"!==h&&(s=!0),u.push(h)}return s?u.join(","):0}function B(n,t,i,r,e){var f,o,u,s,f=[],o=!1;for(n[2]&&e&&(f.push("9"),o=!0),u=0;u<n[0].length;u++)s=n[0][u],r&&(i+s<t&&t<=i||i<t&&t<=i+s)||!r&&t<=i+s?(f.push("1"),o=!0):f.push("0");for(u=0;u<n[1].length;u++)t<=(s=n[1][u])?(f.push("1"),o=!0):f.push("0");return o?f.join(","):0}function r(n,t,i,r,e,f,o,u){var s=this;s.gyt=n,s.pyt=t,s.byt=i,s.yyt=r,s.wyt=e,s.Myt=f,s.Sx=o,s.Cyt=u}function X(n,t,i,r){return(!r||n<t)&&i}function W(n){return[n.row,n.col,n.rowCount,n.colCount].join(",")}function J(n,t,i,r,e){var t=t.rT.id+" "+i+" "+r;n.set(t,e)}function G(n,t,i,r){var t;if(0!==n.size)return t=t.rT.id+" "+i+" "+r,n.has(t)}function s(n,t){var t=new fn.Expression(t);return t.value=n,t}function e(n,t){if(n){for(;10===n.type||12===n.type;)n=n.value;if(1===n.type||13===n.type)t(n);else if(9===n.type)e(n.value,t),n.value2&&e(n.value2,t);else if(7===n.type)for(var i=0;i<n.arguments.length;i++)e(n.arguments[i],t)}}function hn(n,t,i,r,e){var f,o,f,o,n,f=!n&&L(t),o=!i&&L(r);if(f&&!o&&(t=0),o&&!f&&(r=0),!f||!o)return t instanceof Date&&(t=u.Common.ct.o0(t)),r instanceof Date&&(r=u.Common.ct.o0(r)),f=n&&!e.useValue?s(n,fn.ExpressionType.parentheses):s(t,fn.ExpressionType.number),o=i?s(i,fn.ExpressionType.parentheses):s(r,fn.ExpressionType.number),(n=new fn.Expression(fn.ExpressionType.operator)).operatorType=c(e.option),n.value=o,n.value2=f,n}function vn(n){e(n,function(n){var t,t,t,t,t;1===n.type&&(n.rowRelative&&n.columnRelative||n.endRowRelative&&n.endColumnRelative)&&(t=[n.row,n.column],n.column=t[0],n.row=t[1],t=[n.endColumn,n.endRow],n.endRow=t[0],n.endColumn=t[1],t=[n.columnRelative,n.rowRelative],n.rowRelative=t[0],n.columnRelative=t[1],t=[n.endColumnRelative,n.endRowRelative],n.endRowRelative=t[0],n.endColumnRelative=t[1],t=[n.isFullColumn,n.isFullRow],n.isFullRow=t[0],n.isFullColumn=t[1])})}function an(){}function q(n,t,i,r,e,f){var o,u,s,c,o={};if(n)if(t)for(s in i.QDt)i.QDt[s]&&((u=i.QDt[s]).id===r.id&&(u.row>=e?u.row+=f:u.row+u.rowCount>e&&(u.rowCount+=f)),o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u);else for(s in i.QDt)i.QDt[s]&&((u=i.QDt[s]).id===r.id&&(u.col>=e?u.col+=f:u.col+u.colCount>e&&(u.colCount+=f)),o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u);else if(t){for(s in i.QDt)if(i.QDt[s]){if((u=i.QDt[s]).id===r.id)if(u.row>=e+f)u.row-=f;else if(u.row>=e){if(!(u.row+u.rowCount>e+f))continue;u.row=e,u.rowCount=u.row+u.rowCount-f-e}else u.row+u.rowCount>e+f?u.rowCount-=f:u.row+u.rowCount>e&&(u.rowCount=e-u.row);o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u}}else for(s in i.QDt)if(i.QDt[s]){if((u=i.QDt[s]).id===r.id)if(u.col>=e+f)u.col-=f;else if(u.col>=e){if(!(u.col+u.colCount>e+f))continue;u.col=e,u.colCount=u.col+u.colCount-f-e}else u.col+u.colCount>e+f?u.colCount-=f:u.col+u.colCount>e&&(u.colCount=e-u.col);o[c=u.id+","+u.row+","+u.col+","+u.rowCount+","+u.colCount]=u}i.QDt=o}function O(n,t,i,r,e,f,o,u,s,c,a,l){var h,v,d,n;return 0<=i||!e?(h=r+(e?i:0),v=f+(o?i:0),d=a&&_(u,n,a),n=!a&&_(u,n,a),l&&-1===f?e?s+c<=h&&s<=i&&i<s+c?i-s+s+c<=h&&(h+=c):s<=h&&!(s<=i&&i<s+c)&&(h+=c):s<=h&&(h+=c):((d||n)&&(!l&&s+c<=i||l&&s<=i)&&(h-=e?c:0,v-=o?c:0),d=a&&_(u,t,a),n=!a&&_(u,t,a),(d||n)&&(!l&&s<=h||l&&(e&&s<=i+r||!e&&s<=r)?(h+=c,v+=c):(!l&&s<=v||l&&(o&&s<=i+f||!o&&s<=f))&&(v+=c)),l&&s+c<=i&&(h+=e?c:0,v+=o?c:0)),{index:h-=e?i:0,endIndex:v-=o?i:0}):{index:r,endIndex:f}}function D(n,t,i,r,e,f,o,u,s,c,a,l,h){var h,v,d,w,m;if(t&&!h){if(h=s?e.row:e.column,v=s?e.rowRelative:e.columnRelative,d=void 0,w=e.row+(e.rowRelative&&i),m=e.column+(e.columnRelative&&r),l&&!l(w,m))return e;if(e.rowRelative&&e.columnRelative&&0===e.row&&0===e.column&&0===o&&a&&(s&&a.Tge||!s&&a.Age))return e;if(s&&0<=i||!s&&0<=r||!v){if(c)d=O(n,t,s?i:r,h,v,-1,!1,f,o,u,s,l).index;else if(d=dn(n,t,s?i:r,h,v,f,o,u,s,l),C(d))return(0,fn.Syt)(d);d!==h&&(e=e.offset(s?d-h:0,s?0:d-h,!0))}}return e}function F(n,t,i,r,e,f,o,u,s,c,a,l){var l,l,h,v,d,w,c,n;if(t&&!l){if(3===(l=e.Tyt())||s&&2===l||!s&&1===l)return e;if(l=s?e.rowRelative:e.columnRelative,h=s?e.endRowRelative:e.endColumnRelative,v=s?e.row:e.column,d=s?e.endRow:e.endColumn,w=void 0,s&&0<=i||!s&&0<=r||!l||!h){if(c)w=O(n,t,s?i:r,v,l,d,h,f,o,u,s,a);else if(w=wn(n,t,s?i:r,v,l,d,h,f,o,u,s,a),C(w))return(0,fn.Syt)(w);c=w.index,n=w.endIndex,c===v&&n===d||(e=e.offset2(s?c-v:0,s?0:c-v,s?n-d:0,s?0:n-d,i,r))}}return e}function V(n,t,i,r,e,f,o,u,s,c){if(t){var t=e;if(t&&f===t.source)return t.offsetWhenInsertRemoveColumn(o,u,s,c)}return e}function x(n,t,i,r,e,f,o,u,s,c,a,l){var h,v,d,w,m,C,_,p,g,b,h=x,v=r;if(r){if(1===r.type&&r.hmt())v=D(n,r.source||n,t,i,r,e,f,o,u,s,c,a,l);else if(1===r.type)v=F(n,r.source||n,t,i,r,e,f,o,u,s,a,l);else if(10===r.type)(d=h(n,t,i,r.value,e,f,o,u,s,c,a,l))!==r.value&&(v=(0,fn.Ayt)(d));else if(9===r.type)w=h(n,t,i,r.value,e,f,o,u,s,c,a,l),m=r.value2&&h(n,t,i,r.value2,e,f,o,u,s,c,a,l),w===r.value&&m===r.value2||(v=(0,fn.rbt)(r.operatorType,w,m));else if(7===r.type){for(C=cn,p=_=void 0,b=(g=r).arguments.length,p=0;p<b;p++)if((d=h(n,t,i,_=g.arguments[p],e,f,o,u,s,c,a,l))!==_){(C=[])[p]=d;break}if(C){for(p=0;p<b;p++)_=g.arguments[p],C[p]!==sn&&C[p]!==cn||(C[p]=h(n,t,i,_,e,f,o,u,s,c,a,l));v=(0,fn.YJ)(g,C),g.s8t&&(v.s8t=g.s8t,v.u8t=g.u8t)}}else a&&!n.Iyt||u||13!==r.type||(v=V(n,n,t,i,r,e,f,o,s,a));return r.ensureSingle&&(v.ensureSingle=!0),v}}function l(f,o,u,s,n,t,i,r,c,a,l){var e,h,v,h,e=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,u,s,c,a,e,l)},h=f.getSheet();h&&(v=h.b8&&(h.parent||h).xyt(),h=h.Ut&&h.Ut.pj(),d(v,e,c,h))}function d(n,t,i,r){var e,e,f,o,u,s,c,a,l,h,v,d,w,u,m,C,_,p,g,b,x;if(n)for(s=0;s<n.length;s++){for(a=c=!0,l=y.maxRowCount-1,h=y.maxColumnCount-1,d=0,w=(v=(e=n[s].validator)._S).length;d<w&&(m=(u=v[d]).rowCount,C=u.colCount,o=u.row,u=u.col,-1!==m&&(a=!1,l=o<l?o:l),-1!==C&&(c=!1,h=u<h?u:h),c||a);d++);if(!(i&&a||!i&&c)&&(_=(f=n[s].sheet).Uw(),e=e.condition(),p=void 0,v&&v[0]&&(-1===v[0].row&&(p={Tge:1}),-1===v[0].col)&&(p={Age:1}),(g=e.getExpressions())&&0<g.length)){for(b=0;b<g.length;b++)x=g[b],g[b]=t(_,x,l,h,p);e.setExpressions(g,r)}}}function h(n){var i,t,r,n,e,f,o,i=[],t=n.parent,r=[].concat(t&&t.sheets||[n]),n=null==t?void 0:t.mp;if(n&&n.length)for(e=0,f=n;e<f.length;e++)(o=f[e])&&o.getSheet&&o.getSheet()&&r.push(o.getSheet());return r.forEach(function(t){var n=t.conditionalFormats,n=n&&n.getRules();n&&n.length&&n.forEach(function(n){n.KK&&i.push({rule:n,sheet:t})})}),i}function z(n){var t,i,r,n,e,f,o,t=[],i=n.parent,r=[].concat(i&&i.sheets||[n]),n=null==i?void 0:i.mp;if(n&&n.length)for(e=0,f=n;e<f.length;e++)(o=f[e])&&o.getSheet&&o.getSheet()&&r.push(o.getSheet());return r.forEach(function(n){n.tables&&(t=t.concat(n.tables.all()))}),t}function K(f,o,u,s,c,a){var n,t,i,r,n=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,u,s,c,a,e)},t=f.getSheet();t&&Q(i=h(t),n,r=t.Ut&&t.Ut.pj(),c,a)}function Q(n,t,i,r,e){var f,o,u,s,c,a,l,c,h,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,R,A,I,E,O;if(n)for(f=0,o=n.length;f<o;f++){if(s=(u=n[f].rule).ranges(),a=(c=M(s)).r,l=c.c,h=(c=n[f].sheet).Uw(),v=u.condition(),(d=c.tables)&&s&&1===s.length&&(m=(w=s[0]).row,C=w.col,_=w.rowCount,p=w.colCount,g=void 0,e&&r?g=d.AJ(m,C,_,p):c.EB&&c.Nyt&&(g=[c.Nyt]),g)&&g.length){for(b=!1,x=0,y=g.length;x<y;x++)if(j=(R=g[x]).row,N=R.col,k=R.rowCount,R=R.colCount,m===j&&_===k&&N<=C&&C+p<=N+R){b=!0;break}if(b)continue}if(v||(u.initCondition(),v=u.condition()),A=v&&v.getExpressions(),I=void 0,s&&s[0]&&(-1===s[0].row&&(I={Tge:1}),-1===s[0].col)&&(I={Age:1}),A&&0<A.length){for(E=0;E<A.length;E++)O=A[E],A[E]=t(h,O,a,l,I);v.setExpressions(A,i)}}}function Z(n,e,f){var t,n,t=function(n,t,i,r){return Y.call(this,n,i,r,t,e,f)},n=n.getSheet();tn(n,t,n.Ut.pj())}function nn(f,o,u,s,c,a){var n,t,i,n=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,u,s,c,a,e)},t=f.getSheet();t&&(i=t.Ut&&t.Ut.pj(),tn(t,n,i,u,s,c,a))}function tn(c,a,n,l,h,v,d){var t=z(c);t&&t.forEach(function(r){var e,n,f,o,u,s;r&&!r.IHe&&(e=r.Mf.Uw(),n=r.dataRange(),f=n.row,o=n.col,s=r.footerIndex(),r.BSt.forEach(function(n,t){var t,i,t;u=o+t,(t=n.dataAreaFormula())&&((i=a(e,t,f,u))!==t&&r.Mf.Ut.YSt(r,I,{column:n.name(),expr:t}),n.dataAreaFormula(i),v)&&d&&h&&r.Mf===c&&r.aFe(c,l,h,n,u),(t=n.footerFormula())&&((i=a(e,t,s,u))!==t&&r.Mf.Ut.YSt(r,E,{column:n.name(),expr:t}),n.footerFormula(i))}))})}function rn(n,e,f){var t,n,i,t=function(n,t,i,r){return Y.call(this,n,i,r,t,e,f)},n=n.getSheet(),i;Q(h(n),t,n.Ut.pj())}function en(n,t,i,r,e,f,o){var u,s,o,c,a,l,h,v,d,w,m,C,_,v,_;if(!o&&(c=(o=(s=(u=n.getSheet()).Ut)&&s.yle())&&o.gle()))for(a in c)if(c.hasOwnProperty(a)&&(l=c[a]))for(h in l)l.hasOwnProperty(h)&&(d=+a,w=+h,v=l[h])&&v.expr&&!L(u.getValueIgnoreDefault(d,w))&&(m=u.op(),C=v.expr,_=v.oldRow,v=v.oldCol,m)&&_&&v&&C&&(C=t.call(self,n,d,w,C,n,i,r,e,f,sn),_=m.unparse(n,C,d,w),s.setDefaultValue(d,w,_,cn,on.DefaultChangeValueType.Expression,cn,!0))}function dn(n,t,i,r,e,f,o,u,s,c){var a,l,n;if(0<=i||!e){if(a=r+(e?i:0),c&&a<i&&a<o)return r;if(l=s&&_(f,n,s),n=!s&&_(f,n,s),(l||n)&&o<=i&&(a+=e?u:0),l=s&&_(f,t,s),n=!s&&_(f,t,s),l||n)if(o+u<=a)a-=u;else if(o<=a)return g;return c&&o<=i&&e&&o<(a-=u)+u&&a<o?g:a-=e?i:0}return r}function _(n,t,i){var i=i?{2:!0}:{1:!0};return n===t||n.Mf===t.Mf&&(3===n.nT&&i[t.nT]||i[n.nT]&&3===t.nT)}function wn(n,t,i,r,e,f,o,u,s,c,a,l){var h,v,d,w,n,u,t;if(0<=i||!e){if(h=r+(e?i:0),v=f+(o?i:0),d=s+c-1,w=a&&_(u,n,a),n=!a&&_(u,n,a),(w||n)&&s<=i&&(h+=e?c:0,v+=o?c:0),w=a&&_(u,t,a),n=!a&&_(u,t,a),w||n)if(u=i+r,t=i+f,!l&&d<h||l&&d<u)h-=c,v-=c;else{if(!l&&s<=h&&v<=d||l&&s<=u&&t<=d)return g;!l&&v<s||l&&t<s||(!l&&d<=v||l&&d<=t?(h=!l&&h<=s||l&&u<=s?h:s,v-=c):v=s-1)}return h-=e?i:0,v-=o?i:0,l&&s<=i&&(h-=e?c:0,v-=e?c:0),{index:h,endIndex:v}}return{index:r,endIndex:f}}function mn(n,t,i){var r,e,f,o,u,s,c,a,c,c,a,c,l,h,a,c,v,d,r=mn,e=t;if(t)if(t.source)if(s=t.source,(c=t.endSource)&&s!==c){if(!(a=s.Mf&&s.Mf.parent))return fn.kyt;c===i?(c=i.S3,e.endSource=a.getSheet(c-1).Uw()):s===i&&(c=i.S3,e.source=a.getSheet(c).Uw()),delete i.S3,e.source===e.endSource&&delete e.endSource}else(n!==i&&s===i||n===i&&s!==i)&&(e=fn.kyt);else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,fn.Ayt)(f));else if(9===t.type)a=r(n,t.value,i),c=t.value2&&r(n,t.value2,i),a===t.value&&c===t.value2||(e=(0,fn.rbt)(t.operatorType,a,c));else if(7===t.type){for(l=cn,h=t.arguments.length,u=0;u<h;u++)if((f=r(n,o=t.arguments[u],i))!==o){(l=[])[u]=f;break}if(l){for(u=0;u<h;u++)o=t.arguments[u],l[u]!==sn&&l[u]!==cn||(l[u]=r(n,o,i));e=(0,fn.YJ)(t,l)}}else 8===t.type&&(a=n||i,c=A(t.value),s=(v=a.getCustomName(c))&&v.source||(v=(d=a.Lbt.getGlobalSourceModel()||a.getCalcSourceModel()).getSource().getCustomName(c))&&v.source?v.source:s)&&(n!==i&&s===i||n===i&&s!==i)&&(e=fn.kyt);return t.ensureSingle&&(e.ensureSingle=!0),e}function S(n,t,i,r,e){return mn(n,r,e)}function Cn(n,t){return n.yyt===n.gyt&&t!==n.yyt}function _n(n,t,i,r,e,f){var o,u,s,c,a,l,h,v,d,h,w,m,C,m,w,C,d,o=!!r.source,u=r.source||n,s=r.rowRelative,c=r.columnRelative,d=t,h=i,w=e.yyt.Mf;if(e.R0i&&(m=r.row,C=r.column,d=e.wyt+(m-e.pyt)+w.lT(e.wyt,m-e.pyt+1,!0),h=e.Myt+(C-e.byt)+w.lT(e.Myt,C-e.byt+1)),m=e.Dyt(d),w=e._yt(h),(0<=t||!s)&&(0<=i||!c)){if(a=r.row+(s?t:0),l=r.column+(c?i:0),f&&f.isNameID||n===e.gyt&&(v=n===e.yyt?e.Eyt(e.yyt,t,i,1,1)&&!e.R0i:(C=t,d=i,f&&f.crossSheetMoved&&(C-=m,d-=w),e.jyt(e.gyt,C,d,1,1))),v&&(a-=s?m:0,l-=c?w:0),u===e.yyt&&e.Eyt(u,a,l,1,1)&&!e.jyt(u,a,l,1,1))return fn.kyt;if((h=(o&&u===e.gyt||!o&&n===e.gyt)&&e.jyt(e.gyt,a,l,1,1))&&(a+=m,l+=w),l-=c?i:0,u=r.source,e.gyt!==e.yyt&&(h&&v?o&&(u=e.yyt):h?u=e.yyt:v&&!o&&(u=e.gyt)),(a-=s?t:0)!==r.row||l!==r.column||u!==r.source)return(0,fn.knt)(u,cn,a,l,s,c)}else if((0<=t||!s)&&-1===i){if(a=r.row+(s?t:0),e.Eyt(n,t,i,1,1)&&(a-=s?m:0),e.jyt(u,a,-1,1,-1))a+=m;else if(e.Eyt(u,a,-1,1,-1))return fn.kyt;if((a-=s?t:0)!==r.row)return(0,fn.knt)(r.source,cn,a,r.column,s,r.columnRelative)}else if(-1===t&&0<=i&&!c){if(l=r.column+(c?i:0),e.Eyt(n,t,i,1,1)&&(l-=c?w:0),e.jyt(u,a,l,1,1))l+=w;else if(e.Eyt(u,a,l,1,1))return fn.kyt;if(l-=c?i:0,a!==r.row||l!==r.column)return(0,fn.knt)(r.source,r.endSource,r.row,l,r.rowRelative,c)}return r}function b(n,t){var i,r,e,f;return(t=n.getIntersect(t,0,0))?(i=n.row,r=n.col,e=n.rowCount,f=n.colCount,n.rowCount===t.rowCount&&n.colCount===t.colCount||(n.rowCount===t.rowCount?(n.col===t.col&&(r=n.col+t.colCount),f=n.colCount-t.colCount):n.colCount===t.colCount&&(n.row===t.row&&(i=n.row+t.rowCount),e=n.rowCount-t.rowCount)),(0,on.Ec)(i,r,e,f)):cn}function pn(n,t,i,r,e){var n,f;return t&&n&&(!(n=t.getIntersect(n,0,0))&&(f=t.getIntersect(i,0,0))||!(!n||!(n.rowCount===t.rowCount&&0!==e||n.colCount===t.colCount&&0!==r)))}function gn(n,t,i){var n=n.getRange(t,i);return(0,on.Ec)(n.row,n.col,n.rowCount,n.colCount)}function R(n,t,i,r){var t,e,t=b(n,t);return t?(e=t.union(i),r?(e.col=n.col,e.colCount=n.colCount):(e.row=n.row,e.rowCount=n.rowCount)):e=i,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function N(n,t,i,r,e){var f,n,t,f=b(n,t),n=n.getIntersect(t,0,0);return n?(n.row+=r,n.col+=e,{startRow:(t=f?f.union(n):i).row,endRow:t.row+t.rowCount-1,startColumn:t.col,endColumn:t.col+t.colCount-1}):cn}function bn(n,t){var i,r,e,n,f,o,u,t,i=n.row,r=n.col,e=n.rowCount,n=n.colCount,f=t.row,o=t.col,u=t.rowCount,t=t.colCount;return 1===e&&1!==n?o<r&&r<=o+t-1||o<=r+n-1&&r+n-1<o+t-1:1!==n||1===e||f<i&&i<=f+u-1||f<=i+e-1&&i+e-1<f+u-1}function xn(n,t,i,r,e,f){var r,e,f,o,u,s,c,a,l,h,v,d,n,w,m,C,_,p,r=gn(r,e,f),e=r.row,f=r.row+r.rowCount-1,o=r.col,u=r.col+r.colCount-1,s=n.pyt,c=s+n.Sx-1,a=n.byt,l=a+n.Cyt-1,h=n.wyt,v=n.Myt,d=(0,on.Ec)(s,a,n.Sx,n.Cyt),n=(0,on.Ec)(h,v,n.Sx,n.Cyt),w=r.getIntersect(n,0,0);if(pn(d,r,n,t,i))if(p=_=void 0,C=0!==t)if(p=s<=f&&f<=c,(_=s<=e&&e<=c)&&p)e+=t,f+=t;else if(_&&!p){if(t<=0)e+=t;else if(!(f<s+t)){if(!(c+t<f))return N(r,d,n,t,i);if(s===e)return R(r,d,n,C);e+=t}}else if(!_&&p){if(0<=t)f+=t;else if(!(c+t<e)){if(!(e<h))return N(r,d,n,t,i);if(c===f)return R(r,d,n,C);f+=t}}else w&&!w.equals(n)&&bn(r,n)&&(e=(m=b(r,w)).row,f=m.row+m.rowCount-1,o=m.col,u=m.col+m.colCount-1);else if(p=a<=u&&u<=l,(_=a<=o&&o<=l)&&p)o+=i,u+=i;else if(_&&!p){if(i<0)o+=i;else if(!(u<a+i)){if(!(l+i<u))return N(r,d,n,t,i);if(a===o)return R(r,d,n,C);o+=i}}else if(!_&&p){if(0<i)u+=i;else if(!(l+i<o)){if(!(o<v))return N(r,d,n,t,i);if(l===u)return R(r,d,n,C);u+=i}}else w&&!w.equals(n)&&bn(r,n)&&(e=(m=b(r,w)).row,f=m.row+m.rowCount-1,o=m.col,u=m.col+m.colCount-1);return{startRow:e,endRow:f,startColumn:o,endColumn:u}}function yn(n,t,i,r){return t<i||i+r-1<n}function Rn(n,t,i,r){return i<=n&&t<=i+r-1}function jn(n,t,i,r){return n<i&&i+r-1<t}function Nn(n,t,i,r){return i===n&&i+r-1<t||n<i&&i+r-1===t}function kn(n,t,i,r){return i<n&&n<=i+r-1&&i+r-1<t||n<i&&i<=t&&t<i+r-1}function p(n,t,i,r,e){return i<=n&&e<=n||t<=i+r-1&&t<=e+r-1}function An(n,t,i,r,e){for(var f,o,u,f=[yn,Rn,jn,Nn,kn],u=0;u<f.length;u++)if(f[u](n,t,i,r)){o=u+"_";break}if(i===e)o+="9";else for(u=0;u<f.length;u++)if(i!==e&&f[u](n,t,e,r)){o+=u;break}return o}function In(n,t,i,r,e){return{row:w(n.startRow,t),col:w(n.startColumn,i),endRow:un(n.endRow,r),endCol:un(n.endColumn,e)}}function En(n,t,i,r,e){return!e.R0i&&n===e.yyt&&e.wyt<=t&&t<=e.Sx+e.wyt-1&&e.Myt<=i&&i<=e.Cyt+e.Myt-1&&(t=t+e.pyt-e.wyt,i=i+e.byt-e.Myt),{startRow:r.row+(r.rowRelative?t:0),endRow:r.endRow+(r.endRowRelative?t:0),startColumn:r.column+(r.columnRelative?i:0),endColumn:r.endColumn+(r.endColumnRelative?i:0)}}function k(n,t,i,r,e,f,o,u,s){return L(f)&&(f=t.startRow),L(o)&&(o=t.startColumn),L(u)&&(u=t.endRow),L(s)&&(s=t.endColumn),(0,fn.lJ)(e||n.source,cn,n.rowRelative?f-i:f,n.columnRelative?o-r:o,n.endRowRelative?u-i:u,n.endColumnRelative?s-r:s,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,i,r)}function On(n,t,i,r,e){var f,n,o,u,n,s,c,a,l,h,v,d,f=En(n,t,i,r,e),n=r.source||n;if(e.gyt===n&&e.yyt===n)switch(n=(o=An(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))+"-"+(u=An(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)),s=e.wyt-e.pyt,c=e.Myt-e.byt,a=In(f,e.pyt,e.byt,e.pyt+e.Sx-1,e.byt+e.Cyt-1),d=v=h=l=void 0,n){case m.outToCover+"-"+m.outToCover:case m.crossToCover+"-"+m.outToCover:case m.outToCover+"-"+m.crossToCover:case m.crossToCover+"-"+m.crossToCover:case m.coverToCover+"-"+m.outToCover:case m.outToCover+"-"+m.coverToCover:case m.coverNoMove+"-"+m.outToCover:case m.outToCover+"-"+m.coverNoMove:return fn.kyt;case m.outToCross+"-"+m.outToCover:case m.coverToCross+"-"+m.outToCover:case m.insideToCross+"-"+m.outToCover:case m.partToCross+"-"+m.outToCover:case m.crossToCross+"-"+m.outToCover:case m.crossNoMove+"-"+m.outToCover:case m.outToCross+"-"+m.coverNoMove:case m.outToCross+"-"+m.coverToCover:case m.outToCross+"-"+m.crossToCover:case m.insideToCross+"-"+m.coverNoMove:case m.insideToCross+"-"+m.coverToCover:case m.insideToCross+"-"+m.crossToCover:return e.wyt<=f.startRow?k(r,f,t,i,cn,e.wyt+e.Sx):k(r,f,t,i,cn,cn,cn,e.wyt-1);case m.outToCover+"-"+m.outToCross:case m.outToCover+"-"+m.coverToCross:case m.outToCover+"-"+m.insideToCross:case m.outToCover+"-"+m.partToCross:case m.outToCover+"-"+m.crossToCross:case m.outToCover+"-"+m.crossNoMove:case m.coverNoMove+"-"+m.outToCross:case m.coverToCover+"-"+m.outToCross:case m.crossToCover+"-"+m.outToCross:case m.coverNoMove+"-"+m.insideToCross:case m.coverToCover+"-"+m.insideToCross:case m.crossToCover+"-"+m.insideToCross:return e.Myt<f.startColumn?k(r,f,t,i,cn,cn,e.Myt+e.Cyt):k(r,f,t,i,cn,cn,cn,cn,e.Myt-1);case m.partToOut+"-"+m.coverNoMove:case m.crossToOut+"-"+m.coverNoMove:if(!p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return k(r,f,t,i);case m.coverNoMove+"-"+m.partToOut:case m.coverNoMove+"-"+m.crossToOut:if(o===m.coverNoMove&&!p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return k(r,f,t,i);case m.crossToInside+"-"+m.coverNoMove:case m.coverNoMove+"-"+m.crossToInside:return f.startRow>=e.pyt&&u===m.coverNoMove||f.startColumn>=e.byt&&o===m.coverNoMove?k(r,f,t,i,cn,a.row+s,a.col+c):k(r,f,t,i,cn,cn,cn,a.endRow+s,a.endCol+c);case m.partToInside+"-"+m.coverNoMove:return f.startRow>=e.pyt?k(r,f,t,i,cn,un(a.row+s,a.endRow+1)):k(r,f,t,i,cn,cn,cn,w(a.endRow+s,a.row-1));case m.coverNoMove+"-"+m.partToInside:return f.startColumn>=e.byt&&o===m.coverNoMove?k(r,f,t,i,cn,cn,un(a.col+c,a.endCol+1)):k(r,f,t,i,cn,cn,cn,cn,w(a.endCol+c,a.col-1));case m.partToCross+"-"+m.coverNoMove:case m.crossToPart+"-"+m.coverNoMove:case m.crossToCross+"-"+m.coverNoMove:if(p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return f.startRow>=e.pyt?k(r,f,t,i,cn,a.row+s):k(r,f,t,i,cn,cn,cn,a.endRow+s);case m.crossToCover+"-"+m.coverNoMove:case m.partToPart+"-"+m.coverNoMove:return e.pyt<e.wyt?k(r,f,t,i,cn,un(a.row+s,a.endRow+1),cn,a.endRow+s):k(r,f,t,i,cn,a.row+s,cn,w(a.endRow+s,a.row-1));case m.coverNoMove+"-"+m.partToCross:case m.coverNoMove+"-"+m.crossToPart:case m.coverNoMove+"-"+m.crossToCross:if(p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return f.startColumn>=e.byt?k(r,f,t,i,cn,cn,a.col+c):k(r,f,t,i,cn,cn,cn,cn,a.endCol+c);case m.coverNoMove+"-"+m.crossToCover:case m.coverNoMove+"-"+m.partToPart:return e.byt<e.Myt?k(r,f,t,i,cn,cn,un(a.col+c,a.endCol+1),cn,a.endCol+c):k(r,f,t,i,cn,cn,a.col+c,cn,w(a.endCol+c,a.col-1));case m.crossToCross+"-"+m.coverToCover:case m.crossToPart+"-"+m.coverToCover:case m.partToCross+"-"+m.coverToCover:if(p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return k(r,f,t,i);case m.coverToCover+"-"+m.crossToCross:case m.coverToCover+"-"+m.crossToPart:case m.coverToCover+"-"+m.partToCross:if(o===m.coverToCover&&p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return k(r,f,t,i);case m.coverToCover+"-"+m.partToPart:case m.partToPart+"-"+m.coverToCover:case m.coverToCover+"-"+m.crossToCover:case m.crossToCover+"-"+m.coverToCover:return k(r,f,t,i,cn,a.row+s,a.col+c,a.endRow+s,a.endCol+c);case m.partToPart+"-"+m.crossToCover:case m.partToCross+"-"+m.crossToCover:case m.crossToPart+"-"+m.crossToCover:case m.crossToCross+"-"+m.crossToCover:return p(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt)?k(r,f,t,i):(h=a.row===f.startRow?a.col===f.startColumn?(v=f.endColumn,d=a.col+c,l=a.endRow+s,a.row+s):(v=f.startColumn,d=a.endCol+c,l=o===m.partToCross||o===m.crossToCross?e.pyt+s-1:f.endRow,f.startRow):a.col===f.startColumn?(v=f.endColumn,d=a.col+c,l=f.endRow,o===m.partToCross||o===m.crossToCross?e.pyt+e.Sx-1+s+1:f.startRow):(v=f.startColumn,d=a.endCol+c,l=o===m.partToCross||o===m.crossToCross?a.row+s:f.startRow,a.endRow+s),k(r,f,t,i,cn,un(l,h),un(v,d),w(l,h),w(v,d)));case m.crossToCover+"-"+m.partToPart:case m.crossToCover+"-"+m.partToCross:case m.crossToCover+"-"+m.crossToPart:case m.crossToCover+"-"+m.crossToCross:return p(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)?k(r,f,t,i):(h=a.row===f.startRow?(l=(d=a.col===f.startColumn?(v=a.endCol+c,a.col+c):(v=f.endColumn,u===m.partToCross||u===m.crossToCross?e.byt+e.Cyt-1+c+1:f.startColumn),f.endRow),a.row+s):a.col===f.startColumn?(v=f.startColumn,d=u===m.partToCross||u===m.crossToCross?e.byt+c-1:f.endColumn,l=a.endRow+s,f.startRow):(v=u===m.partToCross||u===m.crossToCross?a.col+c:f.startColumn,d=a.endCol+c,l=f.startRow,a.endRow+s),k(r,f,t,i,cn,un(l,h),un(v,d),w(l,h),w(v,d)));case m.coverToOut+"-"+m.coverToOut:case m.coverToOut+"-"+m.coverToCross:case m.coverToOut+"-"+m.coverToCover:case m.coverToOut+"-"+m.coverNoMove:case m.coverToCross+"-"+m.coverToOut:case m.coverToCross+"-"+m.coverToCross:case m.coverToCross+"-"+m.coverToCover:case m.coverToCross+"-"+m.coverNoMove:case m.coverToCover+"-"+m.coverToOut:case m.coverToCover+"-"+m.coverToCross:case m.coverToCover+"-"+m.coverToCover:case m.coverToCover+"-"+m.coverNoMove:case m.coverNoMove+"-"+m.coverToOut:case m.coverNoMove+"-"+m.coverToCross:case m.coverNoMove+"-"+m.coverToCover:return k(r,f,t,i,cn,f.startRow+s,f.startColumn+c,f.endRow+s,f.endColumn+c);default:return k(r,f,t,i)}}function Mn(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,g,I,E,g,b,O,M,f,g,b,x,O,M,f,b,x,s=!!r.source,c=s?r.source:n,g=f&&f.isDataValidator,b=Cn(e,n),x=!1,a=r.rowRelative,l=r.columnRelative,h=r.endRowRelative,v=r.endColumnRelative;if(0<=t||!a||!h||0<=i||!l||!v){if(d=r.row+(a?t:0),w=r.endRow+(h?t:0),m=r.column+(l?i:0),_=w-d+1,p=(C=r.endColumn+(v?i:0))-m+1,!g&&b){if(E=e.jyt(c,d,m,_,p))return r.offset(o,u,!0,t,i);if(e.Eyt(c,d,m,_,p))return fn.kyt;if(c!==e.gyt||c!==e.yyt||0!==o&&0!==u)return r;x=!0}if(f&&f.isNameID||n===e.gyt&&(I=n===e.yyt?e.Eyt(e.yyt,t,i,1,1):(g=t,b=i,f&&f.crossSheetMoved&&(g-=o,b-=u),e.jyt(e.gyt,g,b,1,1))),(x||n===c&&n===e.gyt&&n===e.yyt)&&(O=t,M=i,I&&(O-=o,M-=u),0===o||0===u)){if(!(f=xn(e,o,u,r,O,M)))return fn.kyt;if(0===u&&o&&f.endColumn>=C&&f.startColumn<=m||0===o&&u&&f.endRow>=w&&f.startRow<=d)return g=f.startRow,b=f.startColumn,x=f.endRow,O=f.endColumn,g===d&&x===w&&b===m&&O===C?r:(a&&(g-=t),h&&(x-=t),l&&(b-=i),v&&(O-=i),(0,fn.lJ)(r.source,cn,g,b,x,O,a,l,h,v,t,i))}if(I&&(M=e.wyt-e.pyt,f=e.Myt-e.byt,_+=(a?-M:0)+(h?M:0),p+=(l?-f:0)+(v?f:0)),c===e.yyt&&e.Eyt(c,d,m,_,p)&&!p&&(!a&&!l&&!h&&!v||!I))return fn.kyt;if(g=(s&&c===e.gyt||!s&&n===e.gyt)&&(!I&&e.jyt(e.gyt,d,m,_,p)||I&&e.Eyt(e.yyt,a?d:d+o,l?m:m+u,_,p)),I&&(d-=j=a?o:0,w-=N=h?o:0,m-=k=l?u:0,C-=A=v?u:0),b=!1,g)d+=o,w+=o,m+=u,C+=u;else if(e.Eyt(c,d,m,_,p)){if(!(x=e.intersectWith(c,d,m,_,p))||x.rowCount!==_&&x.colCount!==p)return fn.kyt;d=x.row+o,m=x.col+u,w=d+x.rowCount,C=m+x.colCount,b=!0}return w-=h?t:0,m-=l?i:0,C-=v?i:0,e.gyt===e.yyt?c=s?r.source:sn:(c=r.source,g&&I&&s?c=e.yyt:g&&I||(g?c=e.yyt:I&&!s&&(c=e.gyt))),(d-=a?t:0)!==r.row||m!==r.column||w!==r.endRow||C!==r.endColumn||b||c!==r.source?(0,fn.lJ)(c,cn,d,m,w,C,a,l,h,v,t,i):void 0}}function Sn(n,t,i,r,e,f){var o,u,s,c,a,l,h,v,d,w,m,C,v,d,_,p,g,p,_,g,f,g,b,x,m,y,b,x,y,b,g,v,f,d,o,u=!!r.source?r.source:n,s=r.Tyt(),v=t,d=i,_=e.yyt.Mf;if(e.R0i&&(p=r.row,g=r.column,v=e.wyt+(p-e.pyt)+_.lT(e.wyt,p-e.pyt+1,!0),d=e.Myt+(g-e.byt)+_.lT(e.Myt,g-e.byt+1)),p=e.Dyt(v),_=e._yt(d),0===s){if(g=!e.Oyt&&On(n,t,i,r,e))return g;if(g=Mn(n,t,i,r,e,f,p,_))return g}else if(1===s){if(c=r.rowRelative,l=r.endRowRelative,0<=t||!c||!l){if(v=r.row+(c?t:0),(d=r.endRow+(l?t:0))<v)return fn.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),u===e.gyt&&u===e.yyt&&0===e.byt&&0===e.Myt&&e.Cyt===u.getColumnCount()){if(f=e.pyt,g=e.wyt,C&&(v-=p,d-=p),x=f+(b=e.Sx),y=f<=d&&d<x,(m=f<=v&&v<x)&&y)return C?r:r.offset(p,_,!0,t,i);if(b=g+b,m&&g<=d?(v+=p,d<b&&g<=d&&(d=b-1,v=x)):y&&v<=b&&(d+=p,g<=v)&&w<b&&(v=g,d=f-1),d-=l?t:0,(v-=c?t:0)!==r.row||d!==r.endRow)return(0,fn.lJ)(r.source,r.endSource,v,j.BAND_INDEX_CONST,d,j.BAND_INDEX_CONST,c,a,l,h,t,i)}if(C)return r.offset(-p,_,!0,t,i)}}else if(2===s&&(a=r.columnRelative,h=r.endColumnRelative,0<=i||!a||!h)){if(w=r.column+(a?i:0),(m=r.endColumn+(h?i:0))<w)return fn.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),u===e.gyt&&u===e.yyt&&0===e.pyt&&0===e.wyt&&e.Sx===u.getRowCount()){if(x=e.byt,y=e.Myt,C&&(w-=_,m-=_),g=x+(b=e.Cyt),f=x<=m&&m<g,(v=x<=w&&w<g)&&f)return C?r:r.offset(p,_,!0,t,i);if(d=y+b,v&&y<=m?(w+=_,m<d&&y<=m&&(m=d-1,w=g)):f&&w<=d&&(m+=_,y<=w)&&w<d&&(w=y,m=x-1),m-=h?i:0,(w-=a?i:0)!==r.column||m!==r.endColumn)return(0,fn.lJ)(r.source,r.endSource,j.BAND_INDEX_CONST,w,j.BAND_INDEX_CONST,m,c,a,l,h,t,i)}if(C)return r.offset(p,-_,!1,t,i)}return r}function Y(n,t,i,r,e,f,o){var u,s,c,a,l,h,v,d,w,u=Y,s=r;if(1===r.type&&r.hmt())s=f?_n(n,t,i,r,e,o):Fn(n,t,i,r,e);else if(1===r.type)s=f?Sn(n,t,i,r,e,o):Vn(n,t,i,r,e);else if(10===r.type)(c=u(n,t,i,r.value,e,f,o))!==r.value&&(s=(0,fn.Ayt)(c));else if(13===r.type){if(s=r.offset(0,0,!0),r.ubt&&(s.ubt=r.ubt,-1===(a=r.abt.getColumnIndexInTable(r.ubt))))return fn.kyt;if(r.sbt&&(s.sbt=r.sbt,-1===(a=r.abt.getColumnIndexInTable(r.sbt))))return fn.kyt}else if(9===r.type)l=u(n,t,i,r.value,e,f,o),h=r.value2&&u(n,t,i,r.value2,e,f,o),l===r.value&&h===r.value2||(s=(0,fn.rbt)(r.operatorType,l,h));else if(7===r.type){for(v=cn,a=d=void 0,w=r.arguments.length,a=0;a<w;a++)if((c=u(n,t,i,d=r.arguments[a],e,f,o))!==d){(v=[])[a]=c;break}if(v){for(a=0;a<w;a++)d=r.arguments[a],v[a]!==sn&&v[a]!==cn||(v[a]=u(n,t,i,d,e,f,o));s=(0,fn.YJ)(r,v)}(0,fn.isExpression)(r.function)&&(s.function=u(n,t,i,r.function,e,f,o))}return r.ensureSingle&&(s.ensureSingle=!0),s}function Dn(n,t,i){for(var r,e,f,o,u,u,s,c,a,l,u,h,v,d,r,e=t.gyt.getSheet().Ut.pj(),f=0;f<n.length;f++)if((o=n[f].validator).Epe)delete o.Epe;else if(u=o._S,s=(u=M(u)).r,c=u.c,l=(a=n[f].sheet).Uw(),(h=(u=o.condition()).getExpressions())&&0<h.length){for(v=0;v<h.length;v++)d=h[v],h[v]=Y(l,s,c,d,t,i,{isDataValidator:!0});u.setExpressions(h,e)}}function Fn(n,t,i,r,e){var f,o,u,s,c,a,l,f=r.source||n,o=r.rowRelative,u=r.columnRelative,a=e.Dyt(t),l=e._yt(i);if((0<=t||!o)&&(0<=i||!u)){if(s=r.row+(o?t:0),c=r.column+(u?i:0),e.Eyt(n,t,i,1,1)?(s-=o?a:0,c-=u?l:0):e.jyt(n,s,c,1,1)&&(s+=o?a:0,c+=u?l:0),e.jyt(f,s,c,1,1)?(s+=a,c+=l):e.Eyt(f,s,c,1,1)&&(s-=a,c-=l),c-=u?i:0,(s-=o?t:0)!==r.row||c!==r.column)return(0,fn.knt)(r.source,cn,s,c,o,u)}else if((0<=t||!o)&&-1===i){if(s=r.row+(o?t:0),e.Eyt(n,t,-1,1,-1)?s-=o?a:0:e.jyt(n,s,-1,1,-1)&&(s+=o?a:0),e.jyt(f,s,-1,1,-1)?s+=a:e.Eyt(f,s,-1,1,-1)&&(s-=a),(s-=o?t:0)!==r.row||c!==r.column)return(0,fn.knt)(r.source,cn,s,r.column,o,r.columnRelative)}else if(-1===t&&0<=i&&!u&&(c=r.column+0,e.Eyt(n,-1,i,-1,1)?c-=0:e.jyt(n,-1,c,-1,1)&&(c+=0),e.jyt(f,-1,c,-1,1)?c+=l:e.Eyt(f,-1,c,-1,1)&&(c-=l),c-=0,s!==r.row||c!==r.column))return(0,fn.knt)(r.source,cn,r.row,c,r.rowRelative,u);return r}function Vn(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,f=r.source||n,o=r.Tyt(),y=e.Dyt(t),R=e._yt(i);if(0===o){if(v=r.rowRelative,d=r.columnRelative,w=r.endRowRelative,m=r.endColumnRelative,!(0<=t)&&v&&w||!(0<=i)&&d&&m)if(!(0<=t)&&v&&w||-1!==i){if(-1===t&&(0<=i||!d||!m)){if((c=r.column+(d?i:0))<(a=r.endColumn+(m?i:0)))return fn.kyt;if(e.Eyt(n,-1,i,-1,1)?(c-=g=d?R:0,a-=x=m?R:0):e.jyt(n,-1,i,-1,1)&&(c+=g=d?R:0,a+=x=m?R:0),e.jyt(f,-1,c,-1,h=a-c)?(c+=_=R,a+=_):e.Eyt(f,-1,c,-1,h)&&(c-=_=R,a-=_),a-=m?i:0,(c-=d?i:0)!==r.column||a!==r.endColumn)return(0,fn.lJ)(r.source,cn,c,r.endRow,a,r.rowRelative,d,r.endRowRelative,m,t,i)}}else{if((u=r.row+(v?t:0))<(s=r.endRow+(w?t:0)))return fn.kyt;if(e.Eyt(n,t,-1,1,-1)?(u-=p=v?y:0,s-=b=v?y:0):e.jyt(n,t,-1,1,-1)&&(u+=p=v?y:0,s+=b=v?y:0),e.jyt(f,u,-1,l=s-u,-1)?(u+=C=y,s+=C):e.Eyt(f,u,-1,l,-1)&&(u-=C=y,s-=C),s-=w?t:0,(u-=v?t:0)!==r.row||s!==r.endRow)return(0,fn.lJ)(r.source,cn,u,r.column,s,r.endColumn,v,r.columnRelative,w,r.endColumnRelative,t,i)}else if(u=r.row+(v?t:0),s=r.endRow+(w?t:0),c=r.column+(d?i:0),l=s-u,h=(a=r.endColumn+(m?i:0))-c,e.Eyt(n,t,i,1,1)?(u-=p=v?y:0,s-=b=w?y:0,c-=g=d?R:0,a-=x=m?R:0):e.jyt(n,u,c,l,h)&&(u+=p=v?y:0,s+=b=w?y:0,c+=g=d?R:0,a+=x=m?R:0),e.jyt(f,u,c,l,h)?(u+=C=y,s+=C,c+=_=R,a+=_):e.Eyt(f,u,c,l,h)&&(u-=C=y,s-=C,c-=_=R,a-=_),s-=w?t:0,c-=d?i:0,a-=m?i:0,(u-=v?t:0)!==r.row||c!==r.column||s!==r.endRow||a!==r.endColumn)return(0,fn.lJ)(r.source,cn,u,c,s,a,v,d,w,m,t,i)}else if(1===o){if(v=r.rowRelative,w=r.endRowRelative,0<=t||!v||!w){if((u=r.row+(v?t:0))<(s=r.endRow+(w?t:0)))return fn.kyt;if(e.Eyt(n,t,-1,1,-1)?(u-=p=v?y:0,s-=b=w?y:0):e.jyt(n,t,-1,1,-1)&&(u+=p=v?y:0,s+=b=w?y:0),e.jyt(f,u,-1,l=s-u,-1)?(u+=C=y,s+=C):e.Eyt(f,u,-1,l,-1)&&(u-=C=y,s-=C),s-=w?t:0,(u-=v?t:0)!==r.row||s!==r.endRow)return(0,fn.lJ)(r.source,cn,u,j.BAND_INDEX_CONST,s,j.BAND_INDEX_CONST,v,!1,w,!1,t,i)}}else if(2===o){if(d=r.columnRelative,m=r.endColumnRelative,c=r.column+(d?i:0),(a=r.endColumn+(m?i:0))<c)return fn.kyt;if(e.Eyt(n,-1,i,-1,1)?(c-=g=d?R:0,a-=x=m?R:0):e.jyt(n,-1,i,-1,1)&&(c+=g=d?R:0,a+=x=m?R:0),e.jyt(f,-1,c,-1,h=a-c)?(c+=_=R,a+=_):e.Eyt(f,-1,c,-1,h)&&(c-=_=R,a-=_),a-=m?i:0,(c-=d?i:0)!==r.column||a!==r.endColumn)return(0,fn.lJ)(r.source,cn,j.BAND_INDEX_CONST,c,j.BAND_INDEX_CONST,a,!1,d,!1,m,t,i)}return r}function P(n,t,i,r,e,f){n.Ryt(t,i,r,e,!0,!1,f)}function Tn(n,t,i){var r,e,f,o,u,s,c,a,l,r=Tn,e=t;if(8===t.type){if(t.value===i&&(!t.source||t.source===n.getSource()))return(0,fn.Syt)(g,t.source)}else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,fn.Ayt)(f));else if(9===t.type)s=r(n,t.value,i),c=t.value2&&r(n,t.value2,i),s===t.value&&c===t.value2||(e=(0,fn.rbt)(t.operatorType,s,c));else if(7===t.type){for(a=cn,l=t.arguments.length,u=0;u<l;u++)if((f=r(n,o=t.arguments[u],i))!==o){(a=[])[u]=f;break}if(a){for(u=0;u<l;u++)o=t.arguments[u],a[u]!==sn&&a[u]!==cn||(a[u]=r(n,o,i));e=(0,fn.YJ)(t,a)}}return t.ensureSingle&&(e.ensureSingle=!0),e}Object.defineProperty(n,"__esModule",{value:!0}),n.adjustFormulaOnMoveSwap=n.CalcOperatorAdjustor=n.MoveSwapInfo=void 0,fn=t("CalcEngine"),u=t("Common"),ln=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),j=t("./dist/plugins/sheetsCalc/calc.ns.js"),y=t("./dist/plugins/sheetsCalc/parser-sheets.js"),on=t("Core"),L=u.Common.lt.ht,t=u.Common.zf,A=t.Gmt,un=Math.min,w=Math.max,sn=void 0,cn=null,C=fn.Convert.BJ,g=fn.Errors.Reference,I="columnFormula",E="footerFormula",M=on.util.z0,r.prototype.Dyt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.wyt+1,i=i.ix(t.wyt,n,!0),t.wyt-t.pyt+i):t.wyt-t.pyt},r.prototype._yt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.Myt+1,i=i.ix(t.Myt,n),t.Myt-t.byt+i):t.Myt-t.byt},r.prototype.jyt=function(n,t,i,r,e){var f=this;return f.gyt===n&&(-1===f.pyt||f.pyt<=t&&t+r<=f.pyt+f.Sx)&&(-1===f.byt||f.byt<=i&&i+e<=f.byt+f.Cyt)},r.prototype.Eyt=function(n,t,i,r,e){var f,o,u,s,c,a,l,f=this,o=f.yyt.Mf,u=o&&o.o5(),s=f.wyt,c=f.Myt,a=f.Sx,l=f.Cyt;return u&&(a+=o.lT(s,a,!0),l+=o.lT(c,l)),f.yyt===n&&(-1===s||s<=t&&t+r<=s+a)&&(-1===c||c<=i&&i+e<=c+l)},r.prototype.intersectWith=function(n,t,i,r,e){var f,t,o,f=this;return f.yyt!==n?cn:(t=f.Byt(n,t,i,r,e),(o=f.Byt(n,f.pyt,f.byt,r,e)).intersectWith(t))},r.prototype.Byt=function(n,t,i,r,e){var f,o,u,s,f,o,u,s;return{row:-1===t?0:t,column:-1===i?0:i,rowCount:-1===t||-1===r?n.rowCount:r,columnCount:-1===i||-1===e?n.colCount:e,intersectWith:a}},T=r,n.MoveSwapInfo=T,c=function(n){switch(n){case on.PasteOperationOptions.add:return 3;case on.PasteOperationOptions.subtract:return 4;case on.PasteOperationOptions.multiply:return 5;case on.PasteOperationOptions.divide:return 6}},an.gB=function(n,t,i,r,e,f,o,u,s,c,a){var l,h,v,d,w,m,C,_,p,l=i,h=an,v=this.gB;if(i){if(10===(m=i.type))l=(0,fn.Ayt)(v.call(h,n,t,i.value,r,e,f,o,u,s,c,a));else if(1===m&&i.hmt()){if(d=un((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=un((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&(i.row+r<0||i.row+r>=d)||i.columnRelative&&(i.column+e<0||i.column+e>=w))return(0,fn.Syt)(g,i.source);l=i.offset(0,0,!1)}else if(1===m){if(d=un((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=un((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&!i.isFullColumn&&(i.row+r<0||i.row+r>d)||i.columnRelative&&!i.isFullRow&&(i.column+e<0||i.column+e>w)||i.endRowRelative&&!i.isFullColumn&&(i.endRow+r<0||i.endRow+r>d)||i.endColumnRelative&&!i.isFullRow&&(i.endColumn+e<0||i.endColumn+e>w))return(0,fn.Syt)(g,i.source,i.endSource);l=i.offset(0,0,!1,r,e)}else if(9===i.type)l=(0,fn.rbt)(i.operatorType,v.call(h,n,t,i.value,r,e,f,o,u,s,c,a),i.value2&&v.call(h,n,t,i.value2,r,e,f,o,u,s,c,a));else if(7===m){if(_=[],i.arguments&&0<i.arguments.length)for(p=0;p<i.arguments.length;p++)_[p]=v.call(h,n,t,i.arguments[p],r,e,f,o,u,s,c,a);l=(0,fn.YJ)(i,_)}else 13===m&&(l=i.offsetWhenCopy(n,t,r,e,f,o,u,s,c,a));i.ensureSingle&&(l.ensureSingle=!0)}return l},an.copyFormula=function(V,T,Y,n,t,i,L,X,J,G,P,r,H){var e,f,U,$,o,B,u,W,s,c,a,l,h,v,d,w,m,C,_,p,g,b,q,z,K,Q,x,y,Z,nn,R,j,N,tn,rn,k,A,I,E,E,E,E,O,en,E,M,S,M,S,D,F,F,e=V.b3(),f=n.b3(),U=e.getSource(),$=U.getSheet(),o=f.getSource(),B=an;if(e&&f){for(r&&(u=r.transpose,W=r.operationOptions),s=o&&o.getSheet().Ut.pj(),a=Y,l=t,h=i,v=L,d=X,(c=T)<0&&(c=0,v=un(e.rC(),f.rC())),Y<0&&(a=0,d=un(e.cC(),f.cC())),t<0&&(l=0),i<0&&(h=0),w=new fn.CalcSourceModel(e.op(),U),g=o.getSheet(),b=!G&&g.o5(),q=v,z=d,K=g.getRowCount(),Q=g.getColumnCount(),m=0;m<v;m++)for(C=0;C<d;C++)x=m+c,y=C+a,u&&(x=c+C,y=a+m),H&&on.util.df(x,y,$)||e.Lyt(w,x,y,m,C);for(Z={},nn=f.op(),_=m=0;m<v&&m+l<K;m++)if(R=m+l,b&&0===g.getRowHeight(R))v++;else{if(!J||!o.isHiddenRow(R,!0))for(p=C=0,d=z;C<d&&C+h<Q;C++)if(j=C+h,b&&0===g.getColumnWidth(j))d++;else{if((N=w.pB(_,p))||r){if(N===Z)continue;if(N=B.gB(U,o,N,R,j,tn=t+m-T-_,rn=i+C-Y-p,t,i,q,z),k=w.sT(_,p),o){if(b&&k)continue;if(k&&!k.isDynamicArray){for(A=k.rowCount,I=k.colCount,0<(E=c-k.row)&&(A-=E),(E=v-m)<A&&(A=E),0<(E=a-k.col)&&(I-=E),(E=d-C)<I&&(I=E),O=0;O<A;O++)for(en=0;en<I;en++)w.bB(m+O,C+en,Z);f.setArrayFormula(R,j,A,I,nn.unparse(o,N,R,j),sn,s)}else{if(E=w.Ile(_,p),P&&g&&E&&(g.vle=E),W&&(M=_+c,S=p+a,u&&(M=p+c,S=_+a),N=hn(N,V.getValue(M,S),f.pB(R,j),n.getValue(R,j),W))&&N.value.type===fn.ExpressionType.number&&N.value2.type===fn.ExpressionType.number){(M=(0,ln.evaluateExpression)(n,N))instanceof fn.CalcError||n.setValue(R,j,M),p++;continue}N&&u&&vn(N),S=N?nn.unparse(o,N,R,j):sn,o.setFormula(R,j,S,sn),E&&g.Ut.setDefaultValue(R,j,S,cn,on.DefaultChangeValueType.Expression,cn,!0),(D=w.Fyt(_,p))&&(F=new fn.EvaluateContext(o,(0,fn.eV)(R,j),!1,sn,sn,f.oT(R,j,!0)),D=(D=f.Lbt.allowDynamicArray?(0,fn.h0t)(F,N,!1,0,0,!0,!0):(0,fn.Pyt)(F,N,!1,0,0,!1,!1))===N?sn:D),f.Gyt(R,j,N,D,k,s),E&&(delete g.vle,F=f.oT(R,j))&&F.isDefault(E)}}else f.bB(R,j,N),f.Uyt(R,j,k)}else f&&f.pB(R,j)&&f.Gyt(R,j,sn,sn,sn,s);p++}_++}}},an.moveFormula=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,V,v,d,w,m,n,C,_,p,g,b,x,y,R,j,T,N,k,A,I,E,Y,O,M,S,D,F,D,m,n,s=n.b3(),c=r.b3(),a=s.op();if(s&&c){for(l=r.getRowCount(),h=r.getColumnCount(),V=s.pj(),v=c.pj(),d=a.Hyt(),t<0&&(t=0,o=un(n.getRowCount(),l)),e<0&&(e=0),i<0&&(i=0,u=un(n.getColumnCount(),h)),f<0&&(f=0),w=!(n===r&&n.name()===r.name()),n=u,C=m=o,(p=r.o5())&&(m+=r.lT(e,o,!0),n+=r.lT(f,u)),s.mF(t,i,o,u),P(s,t,i,o,u),d.uFe(s,t,i,o,u),c.mF(e,f,m,n),P(c,e,f,m,n),d.uFe(c,e,f,m,n),g=[],b=0;b<o;b++)for(I=b+t,x=0;x<u;x++)y=s.pB(I,E=x+i),R=s.sT(I,E),j=s.Fyt(I,E),N=(T=s.oT(I,E))&&T.isDefault(),y&&(g[b*u+x]={WK:y,$bt:R,eyt:j,xle:N},s.zyt(I,E,V),R&&(I!==R.row||E!==R.col)||s.rT.setFormula(I,E,cn,sn));for(O=w?{}:null,k=b=0;b<C&&b+e<l;b++)if(M=b+e,p&&0===r.getRowHeight(M))C++;else{for(A=x=0,_=u;x<_&&f+x<h;x++)if(S=x+f,p&&0===r.getColumnWidth(S))_++;else{if(D=g[k*u+A]){if(y=D.WK,R=D.$bt,p&&R){A++;continue}a&&R&&!R.isDynamicArray&&R.row===t+b&&R.col===i+x&&(Y=(0,on.Ec)(M,S,R.rowCount,R.colCount)),F=R&&!R.isDynamicArray?Y:sn,j=D.eyt,(N=D.xle)&&(r.vle=N),c.Vyt(v,M,S),c.bB(M,S,y),c.Uyt(M,S,F),c.Yyt(M,S,j),c.Nle(M,S,N),(!F||F.row===M&&F.col===S)&&(D=c.getFormula(M,S),c.rT.setFormula(M,S,D,F),N)&&r.Ut.setDefaultValue(M,S,D,cn,on.DefaultChangeValueType.Expression,cn,!0),w&&(O[M+", "+S]=y),N&&delete r.vle}else L(c.pB(M,S))||(c.Vyt(v,M,S),c.bB(M,S,sn),c.Uyt(M,S,sn));A++}k++}d.Zyt(s,t,i,o,u),d.Zyt(c,e,f,m,n),n=(m=s.getSource().getSheet()).b8&&(m.parent||m).xyt(),d.Wyt(n,s.getSource(),t,i,c.getSource(),e,f,o,u,!0,O),!0==w&&d.Wyt(n,s.getSource(),t,i,c.getSource(),e,f,o,u,!0,O)}},an.prototype.isAdjustCell=function(n){return n.preAdj||this.y3&&n===this.y3[0]},an.prototype.isAdjust=function(n){return n.preAdj||this.y3&&n===this.y3[0]},an.prototype.Qyt=function(n,t){var i=this,r,e;isNaN(t)||(i.y3||(i.y3={},i.Kyt={}),r=i.y3[t],e=i.Kyt[t],n&&!n.preAdj&&n!==r&&(r?e.nextAdj=n:i.y3[t]=n,n.preAdj=e,n.nextAdj=cn,i.Kyt[t]=n))},an.prototype.Jyt=function(n,t){var i,r,r,e,i=this;isNaN(t)||(r=i.y3&&i.y3[t],n&&(n.preAdj||n===r)&&(r=n.preAdj,e=n.nextAdj,r?r.nextAdj=e:i.y3[t]=e,e?e.preAdj=r:i.Kyt[t]=r,n.preAdj=cn,n.nextAdj=cn))},an.prototype.Xyt=function(n,t,i,r,e,f,o,u){u?this.qyt(n,x,t,i,r,e,f,o):this.sFe(n,x,t,i,r,e,f,o);var u=0,s=0,c=0,a=0;0===t&&(r&&e?c=i:r?u=i:e?a=i:s=i),l(n,x,t,i,u,s,c,a,r,e,f),K(n,x,t,i,r,e),f||nn(n,x,t,i,r,e),en(n,x,t,i,r,e,o)},an.prototype.sFe=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,c,R,j,s,N,N,k,R,A,I,d,V,E,O,M,T,S,Y,D,F,a=this,l=a.y3;if(l){for(d=n.Mbt,g=(0,fn.createMap)(),b={l:!0};l[0];){if(x=void 0,p=(w=(C=l[0]).w3).pj(),_=w.getSource(),h=C.row,v=C.column,y=w.oT(h,v),G(g,w,h,v)||C!==y);else{if(c=w.pB(h,v),R=w.Fyt(h,v),c)if(j=!1,s=e?h:v,n===_&&i<=s&&(j=!0,s-=f?r:-r),L(c.aMt)?(m=t.call(a,_,h,v,c,n,i,r,e,f,sn,o),R&&(x=t.call(a,_,h,v,R,n,i,r,e,f,sn,o))):(c.Wx&&c.Wx.lt.l||(N=f?U(c,n,_,e):H(c,n,_),c.Wx={lt:b,ct:N}),0===(N=f?B(c.Wx.ct,i,s,n===_,j):$(c.Wx.ct,i,r,s,n===_,j,e))?m=c:c.Wx[N]?(m=c.Wx[N],R&&(x=R.eyt||t.call(a,_,h,v,R,n,i,r,e,f,sn,o))):(m=t.call(a,_,h,v,c,n,i,r,e,f,sn,o),x=R&&t.call(a,_,h,v,R,n,i,r,e,f,sn,o),-1!==N&&(c.Wx[N]=m,R)&&(R.eyt=x))),y.QDt&&q(f,e,y,n,i,r),y.vyt(),!u&&y.isDefault()&&null!=(c=null==(s=w.rT.Mf)?void 0:s.Ut)&&c.WTe(h,v,m),k=w.sT(h,v),f||j||u||k&&!k.isDynamicArray?!an.SaveFormulaChanges||j||u||w.rT.setFormula(h,v,w.getFormula(h,v),k,!0):w.Vyt(w.pj(),h,v),k){if(_===n&&(R=f?r:-r,e?i<=k.row&&(k.row+=R):i<=k.col&&(k.col+=R)),h===k.row&&v===k.col)if(k.isDynamicArray)w.dataTable[h][v].WK=m,w.dataTable[h][v].eyt=x;else for(A=h;A<h+k.rowCount;A++)for(I=v;I<v+k.colCount;I++)w.SB(A,I,m,k,A===h&&I===v,!f&&!j&&!u&&p),J(g,w,A,I,!0)}else w.dataTable[h][v].WK=m,w.dataTable[h][v].eyt=x,an.SaveFormulaChanges&&w.rT.setFormula(h,v,w.getFormula(h,v),sn);else(w.getRowExpression&&w.getRowExpression(h)||w.getColumnExpression&&w.getColumnExpression(v))&&w.gF(h,v,1,1)}a.Jyt(C,0)}for((d=d.uT())&&(V=f?d.cFe:d.fFe).call(d,i,r,e),b.l=!1;l[1];)p=(w=(C=l[1]).w3).pj(),h=C.row,w.getRowExpression&&(m=w.getRowExpression(h))&&w.SB&&(E=w.getSource(),w.SB(h,-1,t.call(a,E,h,-1,m,n,i,r,e,f),sn,!0,X(h,i,p,n.id===E.id))),a.Jyt(C,1);for(;l[2];)p=(w=(C=l[2]).w3).pj(),v=C.column,w.getColumnExpression&&(m=w.getColumnExpression(v))&&w.SB&&(E=w.getSource(),w.SB(-1,v,t.call(a,E,-1,v,m,n,i,r,e,f),sn,!0,X(v,i,p,n.id===E.id))),a.Jyt(C,2);for(;l[3];)M=(O=l[3]).name,m=(w=O.w3).$yt(M),T=t.call(a,w.getSource(),0,0,m,n,i,r,e,f,{isNameID:!0}),w.twt(M,T),a.Jyt(O,3);for(S in l)if(3<(Y=+S)&&l.hasOwnProperty(S))for(;l[S];)F=(D=l[S]).w3,m=t.call(a,F,0,0,D.expression,n,i,r,e,f),F.setExpression(D.id,D.name,m),a.Jyt(D,Y)}},an.prototype.qyt=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,g,s,y,R,j,N,k,A,I,E,O,c=this,a=c.y3;if(a){for(_=(0,fn.createMap)();a[0];){if(C=(l=(w=a[0]).w3).pj(),m=l.getSource(),G(_,l,h=w.row,v=w.column));else{if(!(d=l.pB(h,v))||t===S&&m===n)(l.getRowExpression&&l.getRowExpression(h)||l.getColumnExpression&&l.getColumnExpression(v))&&l.gF(h,v,1,1);else if(d=t.call(c,m,h,v,d,n,i,r,e,f,sn,o,u),p=l.sT(h,v)){if(m===n&&(g=f?r:-r,e?i<=p.row&&(p.row+=g):i<=p.col&&(p.col+=g)),h===p.row&&v===p.col)if(p.isDynamicArray)l.SB(h,v,d,p,!0,X(e?h:v,i,C,n.id===m.id));else for(b=h;b<h+p.rowCount;b++)for(x=v;x<v+p.colCount;x++)l.SB(b,x,d,p,b===h&&x===v,X(e?b:x,i,C,n.id===m.id)),J(_,l,b,x,!0)}else g=m.Mf,(s=!u&&(null==(s=l.oT(h,v))?void 0:s.isDefault()))&&(g.vle=s),l.SB(h,v,d,p,!0,X(e?h:v,i,C,n.id===m.id),cn,cn,u),s&&(y=m.nT,R=l.op().unparse(m,d,h,v),g.Ut.setDefaultValue(h,v,R,y,on.DefaultChangeValueType.Expression,cn,!0),delete g.vle)}c.Jyt(w,0)}for(;a[1];)C=(l=(w=a[1]).w3).pj(),h=w.row,l.getRowExpression&&(d=l.getRowExpression(h))&&l.SB&&(m=l.getSource(),l.SB(h,-1,t.call(c,m,h,-1,d,n,i,r,e,f),sn,!0,X(h,i,C,n.id===m.id))),c.Jyt(w,1);for(;a[2];)C=(l=(w=a[2]).w3).pj(),v=w.column,l.getColumnExpression&&(d=l.getColumnExpression(v))&&l.SB&&(m=l.getSource(),l.SB(-1,v,t.call(c,m,-1,v,d,n,i,r,e,f),sn,!0,X(v,i,C,n.id===m.id))),c.Jyt(w,2);for(;a[3];)N=(j=a[3]).name,d=(l=j.w3).$yt(N),k=t.call(c,l.getSource(),0,0,d,n,i,r,e,f,{isNameID:!0}),l.twt(N,k),c.Jyt(j,3);for(A in a)if(3<(I=+A)&&a.hasOwnProperty(A))for(;a[A];)O=(E=a[A]).w3,d=t.call(c,O,0,0,E.expression,n,i,r,e,f),O.setExpression(E.id,E.name,d),c.Jyt(E,I)}},an.prototype.nwt=function(n){var t=this,i,r,e;P(n.getCalcSourceModel(),0,0,n.getRowCount(),n.getColumnCount()),t.qyt(n,S),l(n,S,0,0,0,0,0,0,!0,!1),K(n,S,0,0,!0,!1)},an.prototype.Wyt=function(n,t,i,r,e,f,o,u,V,s,c){var a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,j,R,N,k,R,a,A,I,E,O,M,S,D,F,l=this,h=Y,v=new T(t,i,r,e,f,o,u,V),p=(0,fn.createMap)();if(n&&Dn(n,v,s),rn(t,v,s),Z(t,v,s),y={},b=l.y3){for(;b[0];){if(d=(w=b[0]).w3,m=w.row,C=w.column,g=d.pj(),G(p,d,m,C));else{if(_=d.pB(m,C),x=d.getSource(),_)if(R=sn,c&&c[m+", "+C]&&(x=t,R={crossSheetMoved:!0}),_=h.call(l,x,m,C,_,v,s,R),R=void 0,(j=d.sT(m,C))&&!j.isDynamicArray)if(R=W(j),m===j.row&&C===j.col)for(y[R]=!0,N=m;N<m+j.rowCount;N++)for(k=C;k<C+j.colCount;k++)d.SB(N,k,_,j,N===m&&k===C,g),J(p,d,N,k,!0);else y[R]||(d.SB(m,C,_,j,!1,g),J(p,d,m,C,!0));else R=e.Mf,(a=null==(a=d.oT(m,C))?void 0:a.isDefault())&&(R.vle=a),d.SB(m,C,_,j,!0,g),a&&delete R.vle;else(d.getRowExpression&&d.getRowExpression(m)||d.getColumnExpression&&d.getColumnExpression(C))&&d.gF(m,C,1,1)}l.Jyt(w,0)}for(;b[1];)d=(w=b[1]).w3,m=w.row,g=d.pj(),d.getRowExpression&&(_=d.getRowExpression(m))&&d.ewt&&d.ewt(m,h.call(l,x,m,-1,_,v,s),sn,g),l.Jyt(w,1);for(;b[2];)d=(w=b[2]).w3,C=w.column,g=d.pj(),d.getColumnExpression&&(_=d.getColumnExpression(C))&&d.iwt&&d.iwt(C,h.call(l,x,-1,C,_,v,s),sn,g),l.Jyt(w,2);for(;b[3];)I=(A=b[3]).name,_=(d=A.w3).$yt(I),E=h.call(l,x,0,0,_,v,s),d.twt(I,E),l.Jyt(A,3);for(O in b)if(3<(M=+O)&&b.hasOwnProperty(O))for(;b[O];)F=(D=(S=b[O]).w3).getSource(),_=h.call(l,F,0,0,S.expression,v,s),D.setExpression(S.id,S.name,_),l.Jyt(S,M)}},an.prototype.Zyt=function(n,t,i,r,e,f){for(var o,u,s,c,a,l,h,v,o=this,u=t+r,s=i+e,l=t;l<u;l++)if(n.dataTable[l])for(h=i;h<s;h++)c=n.rwt(l,h),a=n.pB(l,h),(c||a)&&(f?(c.oldRow=c.row,c.oldColumn=c.column,c.row=l,c.column=h):(o.Jyt(c,0),v=this.zCe(n,c,l,h),c&&a&&(c.row!==v.row||c.column!==v.column||c.isDefault())&&(v.oldRow=c.row,v.oldColumn=c.column,v.isDefault(c.isDefault())),c=v),o.Qyt(c,0))},an.prototype.zCe=function(n,t,i,r){var e,t;return t&&t.aT&&t[3]&&(e={aT:[3],3:t[3]}),n.owt(i,r,0),t=n.oT(i,r,!0),e&&(t[3]=e[3],t.aT=e.aT),t},an.prototype.awt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(-1,e)||n.pB(-1,e))&&(n.owt(-1,e,2),f=n.uwt(e,!0),r.Qyt(f,2))},an.prototype.swt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(e,-1)||n.pB(e,-1))&&(n.owt(e,-1,1),f=n.cwt(e,!0),r.Qyt(f,1))},an.prototype.fwt=function(n){for(var t,i,r,e,f,o,u,t=this,i=n.op().getAllSourceModels(),f=0;f<i.length;f++)if((o=i[f]).lwt)for(r=o.lwt(),u=0;u<r.length;u++)(e=r[u])&&e.isVolatile&&e instanceof fn.CellCalc&&!t.isAdjustCell(e)&&t.Qyt(e,0)},an.prototype.uFe=function(n,t,i,r,e){var n,f,n=n.getSource(),f;(n.iFe&&n.iFe()).eFe(t,i,r,e,function(n,t){n.ubt&&t.forEach(function(n){n.r_t()})})},an.prototype.onBeforeAddRemoveRows=function(n,r,t,e,f){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),e&&f?(n.b_t(r,0,f,i),n.mF(r,0,f,i),n.mF(r+f,0,t-r-f,i,sn,!0)):n.mF(r,0,t-r,i,sn,!0),n.hwt(r,t-r),P(n,r,-1,t-r,-1,e=!e&&an.SaveFormulaChanges?2:e))})},an.prototype.onAfterAddRemoveRows=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(r,0,e,i):t+=e,o.Zyt(n,r,0,t-r,i,!0),o.swt(n,r,t-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!0,f,sn,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},an.prototype.onAfterAddRemoveColumns=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(0,r,t,e):i+=e,o.Zyt(n,0,r,t,i-r,!0),o.awt(n,r,i-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!1,f,sn,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},an.prototype.onBeforeAddRemoveColumns=function(n,r,t,e,f){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),e&&f?(n.b_t(0,r,t,f),n.mF(0,r,t,f),n.mF(0,r,t+f,i-r-f,sn,!0)):n.mF(0,r,t,i-r,sn,!0),n.dwt(r,i-r),P(n,-1,r,-1,i-r,e=!e&&an.SaveFormulaChanges?2:e))})},an.prototype.onAfterRemoveName=function(n,t){var n=n.vwt(t,!1);n&&(n.updateListening(!0,!1),n.vyt(),n.updateListeningOnRemoved())},an.prototype.adjustFormulaOnRemoveName=Tn,an.prototype.invalidName=function(n,t){var i,n;t&&(n=(i=n.getCalcSourceModel()).vwt(t.toUpperCase(),!0))&&n.mB()},an.prototype.onAfterChangeTableColumn=function(n,t){var i,r,e,f,o,u,s,c,a,l,h,v,i=this,u=i.y3;if(u)for(s=(0,fn.createMap)();u[0];){if(G(s,r=(c=u[0]).w3,e=c.row,f=c.column));else{if(o=r.pB(e,f),a=r.pj(),o)if(o=an.adjustExpressionOnChangeTableColumn(o,n,t,e,f),(l=r.sT(e,f))&&!l.isDynamicArray)for(l=(0,on.Ec)(e,f,l.rowCount,l.colCount),h=e;h<e+l.rowCount;h++)for(v=f;v<f+l.colCount;v++)r.SB(h,v,o,l,h===e&&v===f,a),J(s,r,h,v,!0);else r.SB(e,f,o,l,!0,a);else(r.getRowExpression&&r.getRowExpression(e)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(e,f,1,1)}i.Jyt(c,0)}},an.adjustExpressionOnChangeTableColumn=function(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,o,u,s,f=an.adjustExpressionOnChangeTableColumn;if(9===n.type){if(o=n.value,u=n.value2,s=f(o,t,i,r,e),c=u&&f(u,t,i,r,e),o!==s||u!==c)return(0,fn.rbt)(n.operatorType,s,c)}else if(7===n.type){for(a=!1,l=[],h=0;h<n.arguments.length;h++)d=f(v=n.arguments[h],t,i,r,e),a=a||v!==d,l.push(d);if(a)return(0,fn.YJ)(n,l)}else if(10===n.type){if((o=n.value)!==(u=f(o,t,i,r,e)))return(0,fn.Ayt)(u)}else if(13===n.type){if(n=(s=n).offset(0,0,!0),s.ubt&&(n.ubt=s.ubt,-1===(h=s.abt.getColumnIndexInTable(s.ubt))))return fn.kyt;if(s.sbt&&(n.sbt=s.sbt,-1===(h=s.abt.getColumnIndexInTable(s.sbt))))return fn.kyt}return n},an.prototype.onAfterRemoveTable=function(n,t){for(var i,r,e,f,o,u,s,c,a,l,h,v,d,i=this,u=0;u<n.length;u++)(s=n[u]).eFe(function(n){n.r_t(),n.vyt()});if(c=i.y3)for(a=(0,fn.createMap)();c[0];){if(G(a,r=(l=c[0]).w3,e=l.row,f=l.column));else{if(o=r.pB(e,f))if(o=an.adjustExpressionOnRemoveTable(o,n,e,f,t),(h=r.sT(e,f))&&!h.isDynamicArray)for(h=(0,on.Ec)(e,f,h.rowCount,h.colCount),v=e;v<e+h.rowCount;v++)for(d=f;d<f+h.colCount;d++)r.SB(v,d,o,h,v===e&&d===f),J(a,r,v,d,!0);else r.SB(e,f,o,h,!0);else(r.getRowExpression&&r.getRowExpression(e)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(e,f,1,1)}i.Jyt(l,0)}},an.adjustExpressionOnRemoveTable=function(n,t,i,r,e){var f,o,u,s,c,a,l,h,v,d,w,o,u,m,C,_,p,g,f=an.adjustExpressionOnRemoveTable;if(9===n.type){if(o=n.value,u=n.value2,s=f(o,t,i,r,e),c=u&&f(u,t,i,r,e),o!==s||u!==c)return(0,fn.rbt)(n.operatorType,s,c)}else if(7===n.type){for(a=!1,l=[],h=0;h<n.arguments.length;h++)d=f(v=n.arguments[h],t,i,r,e),a=a||v!==d,l.push(d);if(a)return(0,fn.YJ)(n,l)}else if(10===n.type){if((o=n.value)!==(u=f(o,t,i,r,e)))return(0,fn.Ayt)(u)}else if(13===n.type)for(m=n,h=0;h<t.length;h++)if(m.baseTable===t[h])return e?fn.kyt:(C=m.getRange(-1===i?0:i,-1===r?0:r,!0),_=-1===i||1===m.referencePortions(),p=1===C.rowCount&&1===C.colCount,g=m.source,p?(0,fn.knt)(g,cn,_?C.row-i:C.row,C.col,_,!1):(0,fn.lJ)(g,cn,_?C.row-i:C.row,C.col,C.row+C.rowCount-1,C.col+C.colCount-1,_,!1,_,!1));return n},an.SaveFormulaChanges=!1,i=an,n.CalcOperatorAdjustor=i,(o=fn.CalcService.prototype).mwt=function(){return new i},(t=m=m||{}).outToOut="0_0",t.outToCover="0_1",t.outToInside="0_2",t.outToPart="0_3",t.outToCross="0_4",t.outNoMove="0_9",t.coverToOut="1_0",t.coverToCover="1_1",t.coverToCross="1_4",t.coverNoMove="1_9",t.insideToOut="2_0",t.insideToInside="2_2",t.insideToPart="2_3",t.insideToCross="2_4",t.insideNoMove="2_9",t.partToOut="3_0",t.partToInside="3_2",t.partToPart="3_3",t.partToCross="3_4",t.partNoMove="3_9",t.crossToOut="4_0",t.crossToCover="4_1",t.crossToInside="4_2",t.crossToPart="4_3",t.crossToCross="4_4",t.crossNoMove="4_9",n.adjustFormulaOnMoveSwap=Y},"./dist/plugins/sheetsCalc/parser-sheets.js":function(V,d,n){var t,v,b,I,m,x,y,R,i,n,r,w,C,j,a,_,T,o,u,c,Y,l,e,f,n,n,s,h;function L(n){return i(n+1).split("")}function p(n,t){var i=t+1;return n<0?n%i+i:t<n?n%i:n}function X(n){return new I.ErrorSource(n)}function J(n,t,i,r,e,f,o){return 3===o||0<=i&&0<=r||1===o&&0<=i||2===o&&0<=r}function G(n,t,i,r,e){var f,f,o,o,o,f=x.BAND_INDEX_CONST,f={Ky:f,iw:f,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},o=t?$(n,i,r,0):U(n,0,e);if(o.DX?(f.Ky=o.Mwt,f.gwt=o.Cwt):(f.iw=o.Mwt,f.pwt=o.Cwt),f.ywt=o.ywt,f.bwt=o.bwt,o.bwt&&!(o.ywt>=n.length)){if(!t&&o.DX||t&&!o.DX)return{bwt:!1};if(o=n[f.ywt],(t||!(0,I.isNumber)(o)&&"$"!==o)&&(!t||"C"!==o&&"c"!==o))return{bwt:!1};o=t?$(n,i,r,f.ywt):U(n,f.ywt,e),f.ywt=o.ywt,!o.bwt||!t&&!o.DX||t&&o.DX?f.bwt=!1:(f.ywt<n.length&&(f.wwt=!1),t?(f.iw=o.Mwt,f.pwt=o.Cwt):(f.Ky=o.Mwt,f.gwt=o.Cwt),f.bwt=!0)}return f}function P(n){return(0,I.Swt)(n)||95===n.charCodeAt(0)}function H(n,t,i){for(var r=n,e=t[n],n=!1;r<i&&!P(e);)++r<i&&(e=t[r]);if(r<i){for(;r<i&&P(e);)++r<i&&(e=t[r]);r<i&&(n=!0)}return n}function U(n,t,i){var r,e,f,o,u,s,c,a,l,h,v,r={Cwt:!0,bwt:!1},e=n.length;if(!(e<=t||("$"===n[t]&&(r.Cwt=!1,t++),e<=t)))if(u=n[f=t],(o=0,I.isNumber)(u)&&"0"!==u){for(r.DX=!0;f<e&&(0,I.isNumber)(u);)++f<e&&(u=n[f]);if(7<f-t)return r;for(s=f-1,c=0;t<=s;s--,c++)o+=(n[s].charCodeAt(0)-48)*_[c];if(o<=d.maxRowCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}else if((0,I.Swt)(u)){for(r.DX=!1;f<e&&(0,I.Swt)(u);)++f<e&&(u=n[f]);if(3<(a=f-t)||H(f,n,e))return r;for(h=l=f-1;t<=h;h--){if(!(65<=(v=n[h].charCodeAt(0))&&v<=90||97<=v&&v<=122))return r;o+=((32|v)-96)*w[l-h]}if(o<=d.maxColumnCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}return r}function $(n,t,i,r){var e,f,o,u,s,c,a,t,e,f={ywt:r,Mwt:x.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},o=n.length;if(!(o<=r)){if("R"===(s=n[u=r])||"r"===s)f.DX=!0,c=t;else{if("C"!==s&&"c"!==s)return f;f.DX=!1,c=i}if(u++,o<=++r)f.ywt=r,f.Mwt=c,f.Cwt=!0,f.bwt=!0;else if("["===(s=n[u])&&(r++,u++,f.Cwt=!0),!(o<=r||(a=!1,s=n[u],f.Cwt&&"-"===s&&(r++,u++,a=!0),o<=r)))if(s=n[u],(0,I.isNumber)(s)){for(;u<o&&(0,I.isNumber)(s);)++u<o&&(s=n[u]);if(t=parseInt(n.slice(r,u).join(""),10),f.Cwt){if(o<=u||"]"!==n[u])return f;u++}t<=(f.DX?d.maxRowCount:d.maxColumnCount)&&(f.Mwt=f.Cwt?(t=a?-t:t)+c:t-1,f.ywt=u,f.bwt=!0)}else if(!f.Cwt)f.ywt=r,f.Mwt=c,f.Cwt=!0,f.bwt=!0}return f}function B(n,t,i,r){var e,f,o,u,e=n.row||0,f=n.column||0,o=i.type;if(i.source){if(!(u=q(n,r,i.source,i.endSource)))return void r.push("#","R","E","F","!")}else!i.source&&n.addSheetName&&1===o&&(2===n.addSheetName?r.push("!"):q(n,r,n.source,C));8===o||5===o?i.value2?r.push(i.value2.name):r.push(i.value.toString()):i.value&&i._error?r.push(i.value.toString()):i.hmt()?g(n.useR1C1,e,f,i.row,i.column,i.rowRelative,i.columnRelative,r):W(n.source,n.useR1C1,e,f,i.row,i.column,i.endRow,i.endColumn,i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative,r,i.Tyt())}function g(n,t,i,r,e,f,o,u,s){var c,c,c=d.maxRowCount-1;(0===(s=s||0)||1===s)&&-c<r&&r<=2*c&&(r=p(r+=f?t:0,c)),c=d.maxColumnCount-1,J(t,i,r,e=(0===s||2===s)&&-c<e&&e<=2*c?p(e+=o?i:0,c):e,f,o,s)?n?2!==s&&(u.push("R"),0<=r&&(t!==r||!f)&&(f?u.push("["+(r-t)+"]"):u.push(++r+"")),e<0)||1!==s&&(u.push("C"),i===e&&o||(o?u.push("["+(e-i)+"]"):u.push(++e+""))):(0<=e&&(o||u.push("$"),u.push.apply(u,L(e))),r<0||(r++,f||u.push("$"),u.push(r+""))):u.push(I.Errors.Reference.toString())}function W(n,t,i,r,e,f,o,u,s,c,a,l,h,v){3===(v=v||0)&&(e=0,o=d.maxRowCount-1,v=1),g(t,i,r,e,f,s,c,h,v);var s=x.BAND_INDEX_CONST;t&&e===o&&f===u&&(o===s||u===s)||o===s&&u===s||(h.push(":"),g(t,i,r,o,u,a,l,h,v))}function q(n,t,i,r){if(n.getExternalSourceToken){if(i){var i=(0,I.Mge)(n,n.getExternalSourceToken(i).split(""),r&&n.getExternalSourceToken(r).split(""));if(!(0<i.length))return!1;t.push.apply(t,i)}return t.push("!"),!0}return!1}function N(n){var t=new I.Expression(8);return t.value=n,t}function z(n){var t=n;return t=n&&3<=n.length&&"["===n[0]&&"0"===n[1]&&"]"===n[2]?3===n.length?"":n.substring(3):t}function K(n,t,i){var r,n,e,f,o,u,n=n.source;return r=n&&(e=n.G3,f=n.S8,o=n.T8,e)&&(u=0<=t&&t<f&&o<=i||f<=t&&0<=i&&i<o)?n:r}function k(){return f.call(this,8e3)||this}function Q(n,t,i,r,e){return 0===t.uit&&0===t.Twt||!r&&0===t.uit&&4===t.Twt&&(!e||i<n.length-2&&":"===n[i+1].Awt&&0===n[i+2].uit&&4===n[i+2].Twt)}function Z(n,t,i,r,e){return t<=n.startRow()&&i<=n.startColumn()&&t+r>n.endRow()&&i+e>n.endColumn()}function A(){return s.call(this,13)||this}function nn(n,t){this.abt.Iwt(n,this,t)}function E(){return h.call(this,7900)||this}function tn(n,t,i){var r,e,f,i,o,u,o,s,c,a,l,h,v,v,d,r=i,e=0,f=t[e],i=hn(n,t,e,f),o=i.nM;if(!o){if(u=n.keepUnknownFormulas)return;S()}for(r.baseTable=o,e=i.xwt,f=t[++e],o=e;" "===f;)f=t[++e];for("@"!==f&&"["!==f&&(f=t[e=o]),a=c=!(s=1),l=t.length;0!==s&&e<l;)if("["===f&&(s++,f=t[++e]),"#"===f)c&&s<=1&&S(),v=(h=ln(t,e,f,s)).Nwt,e=h.xwt,f=h.kwt,s=h.Dwt,c?2===r.hbt&&3===v||2===v&&3===r.hbt?r.hbt=6:3===r.hbt&&8===v||3===v&&8===r.hbt?r.hbt=12:S():r.hbt=v,c=!0;else if("@"===f){for((1<s||c)&&S(),c=!0,r.hbt=1,f=t[++e];" "===f;)f=t[++e];"["===f&&"#"===t[e+1]&&"this row"===O(t,e+2,e+10).toLowerCase()&&(c=!1),","===f&&S()}else{for(v=e;!R(f)&&"]"!==f&&"["!==f;)if("'"===f&&e++,","===f){for(f=t[++e],d=e;" "===f;)f=t[++e];if("["===f){e=d,f=",";break}}else f=t[++e];if(v<e&&((a||"["===f&&1<s)&&S(),e=(h=rn(r,t,e,f,s,v)).xwt,f=h.kwt,s=h.Dwt,a=!0),"]"===f){if(0===--s)break;e>=t.length&&S(),f=t[++e]}","===f&&(f=t[++e])}c||(r.hbt=n._wt?1:16),a||(r.lbt=1)}function O(n,t,i){return n.slice(t,i).join("")}function rn(n,t,i,r,e,f){var o,u,s,c,a,l,h,h,f,v,h,o=n,u=[],c=!1,a=!1;if(1<e)c=!0,e--,u=t.slice(f,i),":"===(r=t[++i])&&(a="["===(r=t[++i]),s=(h=cn(t,i,r,e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt);else if("["===r){for(a=!0,r=t[l=i-1];" "===r;)r=t[--l];":"!==r&&S(),u=en(u=t.slice(f,l)),s=(h=cn(t,i,r=t[i],e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt}else o.hbt!==C&&16!==o.hbt||(c=!0),0<(l=(h=t.slice(f,i)).indexOf(":"))?(u=h.slice(0,l),"["!==(s=h.slice(l+1))[0]&&S()):u=h;if(f=on(o,u,c),o.ubt=u.join(""),o.sbt=o.ubt,s?(v=on(o,s,a),o.lbt=4,o.sbt=s.join("")):(v=f,o.lbt=2),v<f&&(h=f,f=v,v=h),o.ubt=n.abt.getColumnName(f),o.sbt=n.abt.getColumnName(v),++i<t.length)for(r=t[i];" "===r;)r=t[++i];return{xwt:i,kwt:r,Dwt:e}}function en(n){for(var t=n.length-1;0<=t&&" "===n[t];)t--;for(;0<=t&&" "!==n[t];)t--;return 0<=t?n.slice(t+1,n.length-t-1):n}function fn(n){for(var t=0,i=n.length,r=0;t<i&&" "===n[t];)t++;for(r=t,t=i-1;r<t&&" "===n[t];)t++;return r<=t?n.slice(r,t+1):n}function on(n,t,i){var r,e,f,i;if(t&&un(t,i)){for(r=[],e=0,f=t.length;e<f;e++)"'"===t[e]&&e<f-1&&e++,r.push(t[e]);return t=r,(i=n.abt.getColumnIndexInTable(t.join("")))<0&&S(),i}return-1}function un(n,t){var i,r,e;if(t)return 1;if(i="","#"!==(r=i=n[0])&&"@"!==i&&" "!==i&&","!==i&&":"!==i&&"["!==i&&"]"!==i){for(e=1;e<n.length;e++){if(","===(i=n[e])||":"===i||"["===i&&"'"!==r||"]"===i&&"'"!==r||"@"===i&&"'"!==r||"#"===i&&"'"!==r)return;r=i}return 1}}function M(n){for(var t,i,r,t=[],r=0;r<n.length;r++)"["!==(i=n[r])&&"]"!==i&&"@"!==i&&"#"!==i&&"'"!==i||t.push("'"),t.push(i);return t.join("")}function sn(n){var t,i,t="";if("#"===(t=n[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return 1;for(i=1;i<n.length;i++)if(" "===(t=n[i])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return 1}function cn(n,t,i,r){var e,f,f,e=!1;if("["===i)for(e=!0,r++,i=n[++t];" "===i;)i=n[++t];for(f=t;"]"!==i&&(","!==i||1<r);)"'"===i&&t++,i=n[++t];return t<=f&&S(),f=n.slice(f,t),1<r&&r--,{sbt:f=e?f:fn(f),xwt:t,kwt:i,Dwt:r}}function an(n){var t,i,t=(0,I.getMapping)()&&(0,I.getMapping)().tableFunctionsMapping;if(!R(t))for(i in t)if(t[i].toLowerCase()===n)return i.toLowerCase();return n}function ln(n,t,i,r){for(var e,f,o,u,s,c,e=14,f=t;"]"!==i;)"'"===i&&t++,i=n[++t];for(o=an(o=O(n,f,t).toLowerCase().trim()),u=!1,s=0;s<a.length;s++)if(o===(c=a[s])){e=l[o],u=!0;break}if(u||S(),++t>=n.length)r--;else{for(i=n[t];" "===i;)i=n[++t];if(","===i){for(r<=1&&S(),i=n[++t];" "===i;)i=n[++t];"["===i&&(r++,i=n[++t])}1<r&&r--}return{Nwt:e,xwt:t,kwt:i,Dwt:r}}function hn(n,t,i,r){for(var e,f,o,u,f=0,o=t.length;"["!==r&&i<o;)r=t[++i];return{nM:e=0<i?(u=O(t,0,i),n.getTableByName(u)):n.getTableByIndex(n.row,n.column)||n.source.lFe,xwt:i,kwt:r}}function S(){throw r().Exp_FormulaInvalid}function vn(n,t,i){var r,e,f,o,u,s,c,r=(0,I.getMapping)()&&(0,I.getMapping)().tableFunctionsMapping,e=(0,I.sR)().d2t,f=r?r["#All"]:e.All.name,o=r?r["#This row"]:e.thisRow.name,u=r?r["#Headers"]:e.Headers.name,s=r?r["#Data"]:e.Data.name,c=r?r["#Totals"]:e.Totals.name;switch(n){case 1:return i?"["+o+"]":"@";case 2:return t?"["+u+"]":u;case 3:return t?"["+s+"]":s;case 8:return t?"["+c+"]":c;case 6:return"["+u+"], ["+s+"]";case 12:return"["+s+"], ["+c+"]"}return t?"["+f+"]":f}function dn(n,t){var i,r,e,f,o,u,s,c,i,a,l;for(n.unshift(new I.FormulaToken("=",1,0,0,0)),f=[],o=0,e=n.length-1;0<e;e--)n[e].lp===n[e-1].lp&&n[e].Awt===n[e-1].Awt||(f[o]=n[e],o++);for(f[o]=n[e],f.reverse(),u=[],c=s=0;c<f.length;c++,s++)r=wn(f[c]),u[s]=f[c],(i=c+1<f.length?f[c+1].lp:t.length)>f[c].lp+r&&(i=new I.FormulaToken(t.slice(f[c].lp+r,i),7,f[c].lp+r),f[c].ywt=f[c].lp+r-1,u[++s]=i);for(a=0;a<u.length;a++)l=u[a].Awt.trim(),3===u[a].Twt?u[a].Awt='"'+u[a].Awt+'"':"("===l||"{"===l?(u[a].uit=1,u[a].Twt=1):")"!==l&&"}"!==l||(u[a].uit=1,u[a].Twt=2);return u}function wn(n){return 1===n.uit&&"ARRAY"===n.Awt?1:0===n.uit&&3===n.Twt?(n.Ewt||n.Awt).length+2:0===n.uit&&12===n.Twt?n.Awt.length+3:n.Awt.length}function D(n,t,i){var t,r;n&&t&&((r=n[t=t.getName&&t.getName()||"!"])||(r=n[t]=[],n.sheets||(n.sheets=[]),n.sheets.push(t)),r.push(i))}function F(n,t,i,r,e,f){var o,u,o,s;if(n){for(;10===n.type;)n=n.value;if(!(2<=(n=12===n.type?n.value:n).type&&n.type<=6))if(1===n.type)o=n.getRange(e,f),!r.source||n.source&&n.source!==r.source||t.push(o),D(i,n.source||r.source,o);else if(13===n.type)o=n.getRange(e,f),n.source===r.source&&o&&t.push(o),D(i,n.source||r.source,o);else if(8===n.type)n.jwt||(n.jwt=!0,o=j,n.source?n.source.op()&&(o=new I.EvaluateContext(n.source,(0,I.eV)(e,f))):o=r,F(o.getName(n.value),t,i,o,e,f),n.jwt=C);else if(9===n.type)F(n.value,t,i,r,e,f),n.value2&&F(n.value2,t,i,r,e,f);else if(7===n.type)for(s=0;s<n.arguments.length;s++)F(n.arguments[s],t,i,r,e,f)}}function mn(n,t,i,r,e,f,o,u,s){var f,t,c,a;n.setParserOption(f),f=[],t=t.split(""),R(s)&&(s=v.SheetArea.viewport);try{c=!!u||i.op().useR1C1,a=i.Uw(s).getParserContext(!o&&c,(0,I.eV)(r,e),{sheetArea:s}),f=n.parseToTokens(a,t,!1)}catch(n){}return Cn(n,f=dn(f,t),t,i,r,e,o,u,s)}function Cn(n,t,i,r,e,f,o,u,s){var c,a,l,h,u;return void 0===s&&(s=v.SheetArea.viewport),a=C,l=r.Uw(s),h=r.op(),u=!!u||h.useR1C1,h?(c=new m.SheetParserContext(r,!o&&u,(0,I.eV)(e,f),{sheetArea:s}),a=new I.EvaluateContext(l,(0,I.eV)(e,f),!1)):c=new I.ParserContext(j,!1,(0,I.eV)(0,0)),c.ignoreError=!0,_n(n,l,c,a,t,i,e,f)}function _n(n,t,i,r,e,f,o,u){for(var s,c,a,l,h,v,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,s=[],a=0;a<e.length;a++)try{if("["===(c=e[a]).Awt||"#"===c.y4[0]||3===c.Twt)s.push({index:c.lp,endIndex:c.ywt,text:c.Ewt||c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt});else if(a=pn(n,i,e,a,l=[]),d=v=h=void 0,0<l.length){for(w=0;w<l.length;w++)if((m=l[w])instanceof I.FormulaToken)s.push({index:m.lp,endIndex:m.ywt,text:f.slice(m.lp,m.ywt+1).join(""),type:m.uit,subType:m.Twt,canDrag:h,ranges:[],value:m.Awt});else if(m.WK){if(_=(C=m.WK).type,p=C.source,g=f.slice(m.lp,m.ywt+1).join(""),b=[],x={},h=!0,y=C.getRange&&C.getRange(o,u),8===_)d=v=!(h=!1),r&&(R=r,F(j=(R=C.source?new I.EvaluateContext(C.source,(0,I.eV)(o,u),!1):R).getName(C.value),b,x,r,o,u));else if(13===_||22===_)d=!(h=!1),p&&t&&p.Mf===t.Mf&&y?b.push(y):b=null,D(x,p,y);else if(1===_)if(d=!0,C.endSource)for(k=C.endSource,A=p.getSources(k),w=0;w<A.length;w++){if(A[w]===t){b.push(y);break}D(x,A[w],y)}else D(x,p||t,y),(!p||t&&p.Mf===t.Mf)&&b.push(y);else d=!1,b=null;b&&0<b.length||d?s.push({index:m.lp,endIndex:m.ywt,text:g,type:0,subType:7,canDrag:h,ranges:b,value:g,sheetRanges:x,sheetArea:p&&p.nT||t.nT,isName:v}):s.push({index:m.lp,endIndex:m.ywt,text:g,type:c.uit,subType:c.Twt,canDrag:h,ranges:b,value:g,sheetRanges:x,isName:v})}}else s.push({index:c.lp,endIndex:c.ywt,text:c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt})}catch(n){s.push({index:c.lp,endIndex:c.ywt,text:c.Awt,type:c.uit,subType:c.Twt,canDrag:!1,ranges:c.ranges,value:c.Awt})}return s}function pn(n,t,i,r,e){var f,n,t,n,o,o,i,f=i[r];return f&&"function"!=typeof f&&0===f.uit&&(t=n.resolveToken(t,i,n=[],r)-1,1===(o=(n=n[0]).type)||13===o||8===o||5===o||22===o&&n.source)?(o=i[t],i={lp:f.lp,ywt:o.ywt,WK:n},e.push(i),t):r}t=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(d,"__esModule",{value:!0}),d.getExpressTokenImp=d.Vgt=d.fillBlankToTokens=d.getValidaColumnName=d.StructureReferenceResolver=d.obt=d.StructReferenceColumnSpecifier=d.StructReferencePortions=d.SheetReferenceResolver=d.validateSheetName=d.maxColumnCount=d.maxRowCount=void 0,v=n("Core"),b=n("Common"),I=n("CalcEngine"),m=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),x=n("./dist/plugins/sheetsCalc/calc.ns.js"),y=n("./dist/plugins/sheetsCalc/external-reference.js"),R=b.Common.lt.ht,i=v.util.Vf,n=new b.Common.ResourceManager(v.SR),r=n.getResource.bind(n),d.maxRowCount=v.XmlConstants.Io,d.maxColumnCount=v.XmlConstants.xo,w=[1,26,676],C=void 0,j=null,a=["#all","#data","#headers","#totals","#this row"],_=[1,10,100,1e3,1e4,1e5,1e6,1e6],d.validateSheetName=I.Cmt,f=I.TokenResolver,t(k,f),k.prototype.resolveToken=function(n,t,i,r){var e,f,o,u,s,c,a,l,h,v,d,w,l,m,C,w,C,h,l,m,h,w,l,_,p,g,e=n.useR1C1,f=n.row||0,o=n.column||0,s=i.length,c=i[r],a=c.Awt,l=c.uit,h=c.Twt;if(0!==l&&6!==h)return!1;if(0===l&&0===h&&r<s-2&&":"===i[r+1].Awt&&12===i[r+2].Twt&&i[r+2].Awt.indexOf(":")<0||0===l&&12===h){if(m=l=void 0,C=a.lastIndexOf(":"),w=a.lastIndexOf("]"),(a=b.Common.zf.fJ(a,"'")&&b.Common.zf.dT(a,"'")?a.substring(1,a.length-1):a)&&(w<C?(l=a.substring(0,C-1),m=a.substring(C)):("'"===(l=a).charAt(0)&&(l=l.substring(1,l.length-1)),0===h&&(m=i[r+2].Awt,r+=2,"'"===m.charAt(0))&&(m=m.substring(1,m.length-1)))),r++,w=!!l,(l=z(l))&&(v=(v=n.getExternalSource("",l))||X(l),m=z(m))&&(v instanceof y.ExternalSource?(d=v.getPeerSource(m)).Dfe=!0:d=(d=n.getExternalSource("",m))||X(m)),(c=i[r])&&"["===c.y4[0])return!1;if(!c)return N(a);a=c.Awt}if(C=r===s-1?j:i[r+1],Q(i,c,r,e,!0)){if(h=n&&n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray,!(l=G(c.y4,e,f,o,h)).bwt&&!w)return!1;if(c.Twt=7,l.bwt&&l.wwt){if(m=l.Ky,h=l.iw,w=l.gwt,l=l.pwt,r<s-2&&5===C.uit&&":"===C.Awt&&Q(i,C=i[r+2],r+2,e,!1)&&(_=G(C.y4,e,f,o)).bwt&&m===x.BAND_INDEX_CONST==(_.Ky===x.BAND_INDEX_CONST)&&h===x.BAND_INDEX_CONST==(_.iw===x.BAND_INDEX_CONST))return f=m===x.BAND_INDEX_CONST?0:f,o=h===x.BAND_INDEX_CONST?0:o,{index:r+3,expr:(0,I.lJ)(v,d,m-(w?f:0),h-(l?o:0),_.Ky-(_.gwt?f:0),_.iw-(_.pwt?o:0),w,l,_.gwt,_.pwt,f,o)};if(m===x.BAND_INDEX_CONST||h===x.BAND_INDEX_CONST){if(e)return m-=m!==x.BAND_INDEX_CONST&&w?f:0,h-=h!==x.BAND_INDEX_CONST&&l?o:0,{index:r+1,expr:(0,I.lJ)(v,d,m,h,m,h,w,l,w,l,f,o)};if(!v)return!1;u=N(a)}if(!u)return R(v)&&(v=K(n,f,o)),{index:r+1,expr:u=(0,I.knt)(v,d,p=m-(w?f:0),g=h-(l?o:0),w,l)}}else u=N(a)}else if(6===c.Twt)(u=new I.Expression(5)).value=I.CalcError.parse(c.Awt);else{if(!v||1===c.uit)return!1;u=N(a)}return v&&(u.source=v),d&&(u.endSource=d),{index:r+1,expr:u}},k.prototype.unparse=function(n,t,i,r){var e=i&&i.type;return(1===e||8===e||5===e)&&(B(n,t,i,r),!0)},d.SheetReferenceResolver=k,(n=o=d.StructReferencePortions||(d.StructReferencePortions={}))[n.ThisRow=1]="ThisRow",n[n.Headers=2]="Headers",n[n.Data=3]="Data",n[n.Totals=8]="Totals",n[n.HeadersAndData=6]="HeadersAndData",n[n.DataAndTotals=12]="DataAndTotals",n[n.All=14]="All",n[n.NotSpecific=16]="NotSpecific",(n=u=d.StructReferenceColumnSpecifier||(d.StructReferenceColumnSpecifier={}))[n.All=1]="All",n[n.NotSpecific=1]="NotSpecific",n[n.SingleColumn=2]="SingleColumn",n[n.ColumnRange=4]="ColumnRange",s=I.Expression,t(A,s),A.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(A.prototype,"baseTable",{get:function(){return this.abt},set:function(n){this.abt=n,this.source=n.source()},enumerable:!1,configurable:!0}),A.prototype.fHe=function(){var n=this.abt.jHe(this.ubt);return-1===n?0:n},A.prototype.columnReferenceStart=function(){return this.fHe()+this.abt.startColumn()},A.prototype.lHe=function(){var n=this.abt.jHe(this.sbt);return-1===n?this.abt.Tx:n},A.prototype.columnReferenceEnd=function(){return this.lHe()+this.abt.startColumn()},A.prototype.referencePortions=function(){return this.hbt},A.prototype.referenceColumnSpecifier=function(){return this.lbt},A.prototype.getRange=function(n,t,i){var r,e,f,o,u,s,c,a,l,h,v,d,e,r=this,e=r.abt,l=e.startRow(),h=e.endRow(),v=e.hasTotalsRow(),d=e.hasHeadersRow();switch(r.hbt){case 3:case 16:f=d?l+1:l,u=v?h-1:h;break;case 2:if(d)u=f=l;else{if(!i)return j;u=f=l-1}break;case 8:if(v)u=f=h;else{if(!i)return j;u=f=h+1}break;case 1:l+=d?1:0,h-=v?1:0,u=f=n;break;case 6:f=l+(i&&!d?-1:0),u=v?h-1:h;break;case 12:f=d?l+1:l,u=h+(i&&!v?1:0);break;default:f=l+(i&&!d?-1:0),u=h+(i&&!v?1:0)}if(22===r.type){if(1===r.lbt)o=0;else if(o=r.abt.getColumnIndexInTable(r.ubt),s=r.abt.getColumnIndexInTable(r.sbt),-1===o||-1===s)return j}else o=r.columnReferenceStart(),s=r.columnReferenceEnd();return e=e.endColumn(),1===r.lbt&&(s=e),e<o||e<s?(r._error=!0,j):u<f||!i&&f<l||!i&&h<u?j:(0,I.Rwt)(f,o,c=u-f+1,a=s-o+1)},A.prototype.offsetWhenInsertRemoveColumn=function(n,t,i,r){var e,f,o,e=this,f=e.offset(0,0,!0);if(!i){if(e.ubt&&-1===(o=e.abt.getColumnIndexInTable(e.ubt)))return I.kyt;if(e.sbt&&-1===(o=e.abt.getColumnIndexInTable(e.sbt)))return I.kyt}return f.ensureSingle=e.ensureSingle,f.UFe=e.UFe,f},A.prototype.offsetWhenCopy=function(n,t,i,r,e,f,o,u,s,c){var t,a,l,h,v,i,r,e,f,d,w,a=this,l=new m.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,I.eV)(i,r)),h=l.getTableByIndex(i,r),v=a.offset();return h&&(i=i-e,r=r-f,e=o-e,f=u-f,d=void 0,(d=(n===t?l:w=new m.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,I.eV)(i,r))).getTableByIndex(i,r))!==h)&&d===a.abt&&Z(d,e,f,s,c)&&Z(h,o,u,s,c)&&(v.baseTable=h),null!=(t=n.Mf)&&t.$He&&v.Bwt(n.Mf.$He),v.ensureSingle=a.ensureSingle,v.UFe=a.UFe,v},A.prototype.Bwt=function(n){var t,i,n,t=this;2===t.lbt&&n&&((i=((i=t.abt.getColumnIndexInTable(t.ubt))+n)%(n=t.abt.endColumn()-t.abt.startColumn()+1))<0&&(i+=n),t.ubt=t.sbt=t.abt.getColumnName(i))},A.prototype.offset=function(n,t,i){var r,e,r=this,e=new A;return e.baseTable=r.baseTable,e.ubt=r.ubt,e.sbt=r.sbt,e.hbt=r.hbt,e.lbt=r.lbt,e.ensureSingle=r.ensureSingle,e.UFe=r.UFe,e},A.prototype.Lwt=function(n,t){var i=this.abt;return n>=i.startRow()&&t>=i.startColumn()&&n<=i.endRow()&&t<=i.endColumn()},c=A,d.obt=c,h=I.TokenResolver,t(E,h),E.prototype.resolveToken=function(n,t,i,r){var e,i,f,o,e,u,s,e,i,e=i[r],i=i[r+1];if(0===e.uit){if(o=f=void 0,0===e.Twt||7===e.Twt)f=e.Awt;else{if(12!==e.Twt||!i||0!==i.uit||0!==i.Twt||"["!==i.y4[0])return j;f=(e="'"===(e=e.Awt)[0]?e.substr(1,e.length-2):e)+i.Awt,o=!0}if("]"===f.charAt(f.length-1))try{return u=new c,tn(n,f.split(""),u),u.baseTable?(u.abt.Mf.NMi&&((s=u).type=22,s.Iwt=nn),o?{index:r+2,expr:u}:u):new I.Expression(0)}catch(n){}else if(e=n.getTableByName&&n.getTableByName(f))return i=E.create(e),e.Mf.NMi&&(i.type=22,i.Iwt=nn),i}return j},E.prototype.unparse=function(n,t,i,r){var i,e,f,o,u,s,t,c,o,f,e,f,o;if(13!==i.type&&22!==i.type)return!1;if(e=(i=i).abt.Gwt,f=R(e)?i.abt.tableName():e,n.Sbt)o=i.getRange(n.row,n.column,!0),B(n,t,u=(0,I.lJ)(i.source,j,o.row,o.col,o.row+o.rowCount-1,o.col+o.colCount-1,!1,!1,!1,!1),r);else{if(t=r.length,22===i.type&&i.baseTable.Mf.xT)s=!0;else if(16===i.hbt&&1===i.lbt)return r.push(f),void(n.lyt&&r.push("[]"));(c=n.source===i.abt.source()&&i.Lwt(n.row,n.column))&&!n.lyt&&!i.abt.Mf.NMi||(o=R(e)?i.abt.tableName():e,(f=i.abt.Mf)&&f.NMi&&!(0,I.Cmt)(o.split(""))&&(o=(0,I.Mge)(n,o.split(""),null).join("")+"!"),r.push(o)),r.push("["),16!==i.hbt&&(e=vn(i.hbt,1!==i.lbt,n.lyt),r.push(e)),1!==i.lbt&&(1===i.hbt&&!n.lyt||16===i.hbt||r.push(", "),(f=i.ubt)?f=M(f):s=!0,s||(4===i.lbt?(o=i.sbt)?(o=M(o),r.push("[",f,"]:[",o,"]")):s=!0:1===i.hbt&&!n.lyt&&!sn(f)||16===i.hbt?r.push(f):r.push("[",f,"]"))),s?(r.length=t,r.push("#REF!")):r.push("]")}return!0},E.create=function(n,t,i,r,e){void 0===t&&(t=o.NotSpecific),void 0===i&&(i=u.NotSpecific);var f=new c;return f.baseTable=n,f.hbt=t,0<=r&&(f.ubt=n.getColumnName(r)),0<=e&&(f.sbt=n.getColumnName(e)),f.lbt=i,f},d.StructureReferenceResolver=E,d.getValidaColumnName=M,l={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},d.fillBlankToTokens=dn,d.Vgt=mn,d.getExpressTokenImp=_n},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(n,t,i){var r,e,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/sheetsCalc/calc.ns.js"),t),e(i("./dist/plugins/sheetsCalc/parser-sheets.js"),t),e(i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),t),e(i("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),t),e(i("./dist/plugins/sheetsCalc/worksheet-formula.js"),t),i("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(n,t,i){var X,t,r,w,h,J,x,R,e,v,i,y,j,N,k,d,A,G,P,I,H,E,O,M,a,S,U,i;function D(n){n.forEach(function(n){var t;delete n.Uw().G3})}function m(n,c,a,l){X.GC$.each(n,function(n,t){var i,r,e,f,o,u,t,s,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.getComment(),u=t.getFormatter&&t.getFormatter(),t=t.getSheetTabName&&t.getSheetTabName();f&&(i={name:i,formula:s=u||c.unparse(a,f,r,e,!1,!0),sheetTabName:t,row:r,col:e},o&&(i.comment=o),l.push(i))})}function $(n,t){var n,i,r,n=A(n);if("str"===t)i=n;else if("b"===t)i="1"===n;else if("e"===t){switch(r=N,n){case"#DIV/0!":r=7;break;case"#N/A":r=42;break;case"#NAME?":r=29;break;case"#NULL!":r=0;break;case"#NUM!":r=36;break;case"#REF!":r=23;break;case"#VALUE!":r=15}i=r!==N?{error:n,code:r}:N}else i=n===N?N:parseFloat(n);return i}Object.defineProperty(t,"__esModule",{value:!0}),X=i("Core"),t=i("Common"),r=i("CalcEngine"),w=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),J=i("./dist/plugins/sheetsCalc/external-reference.js"),x=i("./dist/plugins/sheetsCalc/calc-extra-save.js"),R=i("./dist/plugins/sheetsCalc/worksheet-formula.js"),e=w.SpreadSource,v=t.Common.zf.Gmt,i=new t.Common.ResourceManager(X.SR),y=i.getResource.bind(i),j=void 0,N=null,k=t.Common.lt.ht,d=X.mt.o1,A=X.mt.c1,G=X.mt.xr,P=X.mt.go,I=X.Util.Sr,H=X.IndexHelper.$i,E=X.Util.mr,O=X.mt.n1,M=X.Util.io,a=X.mt.St,S=X.XFileConstants.mo,U=X.XFileConstants.Ki,(i=X.Workbook.prototype).Qp=function(n){var t,i,t=this,i=t.Lp;t.Lp=new r.CalcService,t.Lp.useR1C1=1===t.options.referenceStyle,t.Lp.allowDynamicArray=t.options.allowDynamicArray,t.Lp.iterativeCalculation=t.options.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Lp.calculationMode=t.options.calculationMode,t.Lp.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,n&&i&&t.Lp.cloneFrom(i),t.yC=new e(t),t.wC=t.Lp.getGlobalSourceModel(t.yC)},i.addCustomFunction=function(n){this.Uwt(n)},i.Uwt=function(n){if(!(n&&n instanceof r.Functions.Function))throw new Error(y().Exp_InvalidCustomFunction);n.name=v(n.name),this.Amt[n.name]=n},i.getCustomFunction=function(n){return n?this.Amt[v(n)]:j},i.removeCustomFunction=function(n){n&&delete this.Amt[v(n)]},i.clearCustomFunctions=function(){this.Amt={}},i.addCustomName=function(n,t,i,r,e,f){this.zwt(this.hyt,n,t,i,r,!1,e,f)},i.Vwt=function(n){return!this.hyt[v(n)]},i.isValidCustomName=function(n){return n&&X.mt.P0(n)&&this.Vwt(n)},i.pp=function(n,t,i,r,e,f,o,u){var s,c,s=this;if(!t||!i)throw new Error(y().Exp_InvalidCustomName);u&&s.Lp&&a(i)?(c=u.Ywt(i,r,e),n[v(t)]=new h.FormatterNameInfo(t,i,u.name(),c,r,e)):s.zwt(n,t,i,r,e,f,o)},i.zwt=function(n,t,i,r,e,f,o,u,s){var c,a,a,l,a,i,c=this;if(!t||!i||!f&&!c.isValidCustomName(t))throw new Error(y().Exp_InvalidCustomName);if(c.Lp){if(a=(a=(0,X.jf)(this))?a.Uw():N,l=void 0,f)try{l=c.Lp.parse(a,i,r,e,!1,!0,!0)}catch(n){}else l=c.Lp.parse(a,i,r,e);a=void 0,s?(a=s).SB(l,j,r,e):a=new h.NameInfo(t,l,r,e,o,u,c),n[v(t)]=a,l&&(0,R.addNameInName)(c,l,a),f||((i={})[t]=t,this.Zwt(i,!0))}},i.Wwt=function(n,t,i,r,e,f,o,u){var s,i,n,s=this;if(!t||!i||!o&&!s.isValidCustomName(t))throw new Error(y().Exp_InvalidCustomName);s.Lp&&(i=n[v(t)]=new h.NameInfo(t,r,e,f,u,j,s),r&&(0,R.addNameInName)(s,r,i),o||((n={})[t]=t,this.Zwt(n,!0)))},i.getCustomName=function(n){return n?this.hyt[v(n)]:j},i.qRe=function(t,i,n,r,e){var f,f,o,u,s,f,f,c,a,f,f,l,f,o=this;if(r=null!=r?r:0,e=null!=e?e:0,o.Lp){if(u=o.hyt[v(t)])if(s=void 0,n&&(f=(f=(0,X.jf)(this))?f.Uw():N,s=o.Lp.parse(f,n,r,e)),i&&t!==i){if(!o.isValidCustomName(i))throw new Error(y().Exp_InvalidCustomName);if(c=[],a=[],(f=o.hFe)&&f.forEach(function(n){n.forEach(function(n){n.value!==t||n.source||c.push(n),n.value!==i||n.source||a.push(n)})}),2===(f=null==(f=o.wC)?void 0:f.dFe(t,i,0<c.length,0<a.length)))throw new Error(y().Exp_CustomNameBothInUse);o.suspendCalcService(),(u=o.hyt[v(t)]).btV(i),delete o.hyt[v(t)],o.hyt[v(i)]=u,c.forEach(function(n){n.value=i}),o.wC.updateNameCalc(i,!0),s&&(l=o.hyt[v(i)],o.removeCustomName(i),o.zwt(o.hyt,i,n,r,e,!1,u.getComment(),u.isReadOnly(),l)),3!==f||s||((f={})[i]=i,this.Zwt(f,!0)),o.resumeCalcService()}else s&&(o.suspendCalcService(),l=o.hyt[v(t)],o.removeCustomName(t),o.zwt(o.hyt,t,n,r,e,!1,u.getComment(),u.isReadOnly(),l),o.resumeCalcService());null!=(f=(0,X.jf)(this))&&f.zw()}},i.xO=function(n){return n?this.bp[v(n)]:j},i.getCustomNames=function(){var i=[];return X.GC$.each(this.hyt,function(n,t){i.push(t)}),i},i.Qwt=function(){var i=[];return X.GC$.each(this.bp,function(n,t){i.push(t)}),i},i.removeCustomName=function(n){var t,i,t;n&&(i=this.hyt[v(n)],null!=(t=this.hFe)&&t.delete(i),delete this.hyt[v(n)],(t={})[n]=n,this.Zwt(t,!1))},i.o3=function(n){var t;n&&(delete this.bp[v(n)],(t={})[n]=n,this.Zwt(t,!1))},i.clearCustomNames=function(){var n,t,i,n=this.hyt;if(this.hFe)for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(i=n[t],this.hFe.delete(i));this.hyt={},this.Zwt(n,!1)},i.getNameInfos=function(){return this.hyt},i.setNameInfos=function(n){k(n)||(this.hyt=n)},i.Kwt=function(){var n=this.bp;this.bp={},this.Zwt(n,!1)},i.Zwt=function(n,t){var i,r,n;if(n){for(r in i=this.wC,n)i&&i.updateNameCalc(r,t);this.Lp&&!this.Lp.IsSuspended()&&(n=this.getActiveSheet())&&(n.suspendPaint(),this.Lp.recalculateAll(!1),n.resumePaint()),this.ki(X.Events.CustomNameChangedInternal,{})}},i.calculate=function(n,t){var i,r,e,f,o,u,s,c,a,l,h,v,d,n,i=this,r=i.op();if(r){switch(f=!(e=j),n){case X.CalculationType.rebuild:e=!0;break;case X.CalculationType.minimal:f=e=!1;break;case X.CalculationType.regular:e=!1}if(this.suspendPaint(),k(t)){if(r.suspend(!0),e)for(o=void 0,o=i.sheets||[],(0,R.resetCustomName)(i&&i.hyt,N,r,i),u=0;u<o.length;u++)for(c=(s=o[u]).Uw(),(0,R.resetCustomName)(s.hyt,c,r,i),l=(a=c.getCalcSourceModel()).getAllNodes(),h=0;h<l.length;h++)(d=(v=l[h]).calc)&&v.WK&&(0,R.adjustOneFormula)(r,d);r.resume(e,!f,!0)}else(s=i.getSheetFromName(t))?s.c3n(e,f):0<i.sheets.length&&(n=w.formulaToRanges(i.sheets[0],t,0,0,!0)[0]||w.formulaToRanges(i.sheets[0],t,0,0)[0])&&(s=i.getSheetFromName(n.sheetName)).c3n(e,f,n.ranges[0]);this.resumePaint()}},i.getCalcService=function(){return this.Lp},i.op=function(){return this.Lp},i.suspendCalcService=function(n){this.Lp&&this.Lp.suspend(n)},i.resumeCalcService=function(n){this.Lp&&this.Lp.resume(n)},i.getCircularReference=function(){return this.Lp.MTe()},i.updateExternalReference=function(n,t,i,r){this.suspendPaint(),this.suspendCalcService(),this._p._6(n,t,i,r),this.resumeCalcService(!1),this.resumePaint()},i.getExternalReferences=function(n){return this._p.myt(n)},X.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new J.ExternalReferenceManager},toJson:function(n){var t,i,i,s,i,r,e,c,t,a,t=this,i=t.Amt;X.GC$.isEmptyObject(i)||(n.customFunctions=i),i=t._p.toJSON(t),X.GC$.isEmptyObject(i)||(n.externalReference=i),s=[],i=[],r=t.getCustomNames(),e=t.Qwt(),c=t.Lp,t=(0,X.Sp)(this),a=t?t.Uw():N,r&&c&&(X.GC$.each(r,function(n,t){var i,r,e,f,o,t,u,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:u=c.unparse(a,f,r,e,!1,!0,2),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),s.push(i))}),m(e,c,a,i),0<s.length&&(n.names=s),0<i.length)&&(n.formatStringNames=i)},wh:function(n,t,o){var i,r,r,e,f,u,s,r,e,c,f,a,f,l,h,v,f,r,i=this,r=i.Amt;X.GC$.isEmptyObject(r)||(n.workbook.lossless.customFunctions=r),X.Util.ko(o)&&null!=o&&o.saveR1C1Formula&&(n.workbook.lossless.frc=1),i._p&&(e=(r=i._p.wh(n)).externalReferencesNode,f=r.externalLinks,0<(u=r.count))&&(n.workbook.c_.push(e),n.externalLinks=f),s=[],r=d(n.workbook,"definedNames"),e=i.getCustomNames(),c=i.Lp,f=(0,X.Sp)(this),a=f?f.Uw():N,f=i.yC,l=f&&f.getUsedCustomNames()||{},e&&0<e.length&&c&&(r||n.workbook.c_.push(r={n_:"definedNames",c_:[]}),h=r.c_,v=!o||!1!==o.includeUnusedNames,X.GC$.each(e,function(n,t){var i,r,e,t,f,i,t,i=t.getName(),r=t.getExpression(),e=t.isReadOnly(),t=t.getComment();r&&(v||l[i])&&(f=c.unparse(a,r,0,0,!1,!0,2),i=X.Util.Oge({name:i,comment:t,isReadOnly:e},f),o&&o.includeCalcModelCache&&(t=(0,x.exprToJSON)(r),s.push(t),i.e=s.length-1),h.push(i))})),0<s.length&&(n.workbook.lossless.exprs=s),f=[],(r=i.Qwt())&&0<r.length&&c&&(m(r,c,a,f),0<f.length)&&(n.workbook.lossless.formatStringNames=f),n.workbook.lossless.idMap=(0,x.dbt)(c)},preFromSJSFormat:function(n,V,T){var t,i,r,e,f,o,u,s,c,a,l,h,v,u,d,w,m,C,_,p,g,b,x,y,R,j,N,k,A,I,E,O,M,S,S,O,D,F,Y,L,t=G(n.workbook,"externalReferences"),i=n.externalLinks;if(t&&i&&t.c_&&0<t.c_.length){for(e in r={},i)if(i.hasOwnProperty(e)){if(f=i[e],o={},u=G(f,"externalBook")){if(c=[],(s=G(u,"sheetNames"))&&s.c_&&s.c_.length){for(a=0,l=s.c_.length;a<l;a++)(h=s.c_[a])&&(v=h.val)&&(v=X.mt.kfe(v),c.push(v));o.sheetNames=c}if(u=G(u,"sheetDataSet")){if(d={},w=P(u,X.XFileConstants.bo))for(m=0,C=w.length;m<C;m++)if(p=+(_=w[m]).sheetId,g=!!_.refreshError,b=d[v=c[p]]={},g&&(b.isNew=!0),x=P(_,"row"))for(y=0,R=x.length;y<R;y++)if((j=x[y])&&(k=b[N=j.r-1]=b[N]||{},A=P(j,"cell")))for(I=0,E=A.length;I<E;I++)M=void 0,(O=A[I])&&((S=O.r)&&(M=H(S)),S=O.t,D=void 0,(O=G(O,"v"))&&(D=$(O,S)),k[M]=D);o.data=d}}o.option=f.option,r[e]=o}for(F={},L=(Y=t.c_).length,a=0;a<L;a++)F[a+1]=r[Y[a][U]];this._p=new J.ExternalReferenceManager(F)}},yh:function(e,i,r){var f,t,o,u,n,s,c,a,l,h,v,d,w,m,C,C,_,p,g;function b(){var n,n;return t||(n=(n=(0,X.jf)(f)||f.sheets[0])?n.Uw():N,t=n&&n.getParserContext(!1)),t}if(o=(f=this).Lp,u=r&&!r.fullRecalc,n=X.Util.wo(r,f.v2),o&&(o.suspend(),o.lb=u),f.clearCustomNames(),(s=f.sheets).forEach(function(n){n.Uw().G3=!0}),c=e.workbook.lossless,r&&(r.$wt=(0,x.vbt)(o,c)),(a=i.workbookNames)&&0<a.length&&a.forEach(function(n){var t=O(n.name),i=A(n),r=O(n.comment),e=n.isReadOnly;c&&c.exprs&&c.exprs[n.e]?f.Wwt(f.hyt,(0,R.convertBuiltInNameToDisplayName)(t),""+E(O(i)),(0,x.exprFromJSON)(c.exprs[n.e],b()),0,0,!0,r,!0):i&&f.zwt(f.hyt,(0,R.convertBuiltInNameToDisplayName)(t),""+E(O(i)),0,0,!0,r,e)}),f.Kwt(),l=c&&c.formatStringNames)for(h=0;h<l.length;h++)v=l[h],k(v.sheetTabName)&&f.pp(this.bp,v.name,v.formula,v.row,v.col,!0,v.comment,j,!0);if(f.clearCustomFunctions(),d=c&&c.customFunctions)for(w in d)d.hasOwnProperty(w)&&(m=d[w],C=(0,X.getTypeFromString)(m.typeName))&&((C=new C).fromJSON(m),f.Uwt(C));n||(_=[],p=e.workbook.rels&&e.workbook.rels.c_,(g=G(e.workbook,S).c_).forEach(function(n){var t,t,n,n,n,i,r,t=M(O(n.name)),t=f.getSheetFromName(t)||f.Gm(t),n=n[U],n=I(p,n),n=n&&n.Target;t&&n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],_.push({sheet:3===t._gi?t.getTemplate():t,sheetData:r}))}),_.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.nameFunctionFromSJSFormat&&t.nameFunctionFromSJSFormat(n,i,r)}),_.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.formulaFromSJSFormat&&t.formulaFromSJSFormat(n,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){o&&(u?o.resumeWithoutCalc():o.resume(!1,!1,!o.calcOnDemand),delete o.lb),D(s)},[o,e,r],u?j:y().STEP.startCalc,function(){return u?X.STEP_RATE.end:X.STEP_RATE.loadFileData+X.STEP_RATE.parseFile+X.STEP_RATE.loadSheetDataWithCalc+X.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(e,i,r){var f,o,u,n,s,t,c,a,l,h,v,d,w,m,m,C,_,p,f=this,o=f.Lp,u=r&&!r.fullRecalc,n=X.Util.wo(r,f.v2);if(o&&(o.suspend(),o.lb=u),f.clearCustomNames(),(s=f.sheets).forEach(function(n){n.Uw().G3=!0}),t=e.workbook.lossless,(c=i.workbookNames)&&0<c.length&&c.forEach(function(n){var t=O(n.name),i=A(n),r=O(n.comment),n=n.isReadOnly;i&&f.zwt(f.hyt,(0,R.convertBuiltInNameToDisplayName)(t),""+E(O(i)),0,0,!0,r,n)}),f.Kwt(),a=t&&t.formatStringNames)for(l=0;l<a.length;l++)h=a[l],k(h.sheetTabName)&&f.pp(this.bp,h.name,h.formula,h.row,h.col,!0,h.comment,j,!0);if(f.clearCustomFunctions(),v=t&&t.customFunctions)for(d in v)v.hasOwnProperty(d)&&(w=v[d],m=(0,X.getTypeFromString)(w.typeName))&&((m=new m).fromJSON(w),f.Uwt(m));n||(C=[],_=e.workbook.rels&&e.workbook.rels.c_,(p=G(e.workbook,S).c_).forEach(function(n){var t,t,n,n,n,i,r,t=M(O(n.name)),t=f.getSheetFromName(t)||f.Gm(t),n=n[U],n=I(_,n),n=n&&n.Target;t&&n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],C.push({sheet:3===t._gi?t.getTemplate():t,sheetData:r}))}),C.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.nameFunctionFromSJSFormat&&t.nameFunctionFromSJSFormat(n,i,r)}),C.forEach(function(n){var t=n.sheet,n=n.sheetData;t&&t.formulaFromSJSFormat&&t.formulaFromSJSFormat(n,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){var r;o&&(u?o.resumeWithoutCalc():(o.resume(!1,!1,!o.calcOnDemand),delete o.tMt,(r=f.getActiveSheet())&&r.zw()),delete o.lb),D(s)},[o,e,r])},preFromJson:function(n,t,i){this._p=new J.ExternalReferenceManager(n.externalReference)},fromJson:function(n,t,i){var r,e,f,o,u,s,c,a,l,h,v,d,w,m,C,_,p,g,g,b,x,y,r=this,e=r.Lp,f=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(e&&(e.suspend(),e.lb=f),r.clearCustomNames(),c=[],s=n.sheets)for(l in s)"string"==typeof l&&(h=s[l],u=r.getSheetFromName(h.name||l))&&(u.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],r.zwt(this.hyt,(0,R.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(r.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],k(w.sheetTabName)&&r.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(r.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,X.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),r.Uwt(g));if(s){for(l in o=0,s)"string"==typeof l&&(h=s[l],u=r.getSheetFromName(h.name||l))&&(c.push(u),u.nameFunctionsFromJSON(h,t,i),o++);for(a=c.length,o=0;o<a;o++)(u=c[o]).formulaFromJSON(s[u.name()],t,i)}for(e&&(f?e.resumeWithoutCalc():(e.resume(!1,!1,!e.calcOnDemand),delete e.tMt),delete e.lb),b=0,x=c;b<x.length;b++)delete(y=(u=x[b]).Uw()).G3},Yp:function(n,t,i){var u,s,c,r,a,e,l,f,o,h,v,d,w,m,C,_,p,g,g,u=this,s=u.Lp,c=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(s&&(s.suspend(),s.lb=c),u.clearCustomNames(),e=n.sheets,l=[],e)for(o in e)"string"==typeof o&&(h=e[o],a=u.getSheetFromName(h.name||o))&&(a.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],u.zwt(this.hyt,(0,R.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(u.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],k(w.sheetTabName)&&u.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(u.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,X.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),u.Uwt(g));if(e){for(o in r=0,e)"string"==typeof o&&(h=e[o],a=u.getSheetFromName(h.name||o))&&(l.push(a),a.nameFunctionsFromJSON(h,t,i),r++);for(f=l.length,r=0;r<f;r++)(a=l[r]).formulaFromJSON(e[a.name()],t,i)}i.incrementLoadTask.addTask(function(n,t,i){var r,e,f,o;for(s&&(c?s.resumeWithoutCalc():(s.resume(!1,!1,!s.calcOnDemand),delete s.tMt,(r=u.getActiveSheet())&&r.zw()),delete s.lb),e=0,f=l;e<f.length;e++)delete(o=(a=f[e]).Uw()).G3},[s,n,i])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(r,n,t){var e,g,i,I,h,p,w,E,b,C,v,x,t,y,R,f,J,o,G,P,m,_,j,N,t,s;function u(n){return"="===n.charAt(0)}function H(n){var t,i;return{left:n.indexOf("["),right:n.indexOf("]")}}function U(n){var n=H(n),t=n.left,n=n.right;return 0<=t&&t<n}function $(n){var t=H(n),i=t.left,t=t.right,n=n.indexOf("@");return i<n&&n<t}function B(n){return u(n)&&$(n)}function W(n){return u(n)&&U(n)}function q(n,t){var i,r;if(n.NMi){if(W(t=t.trim()))return 1;if(0<=t.indexOf("{{")&&0<=t.indexOf("}}"))for(i=t.split(/{{|}}/),r=0;r<i.length;r++)if(W(i[r].trim()))return 1}}function z(n,t,i,r){return i===b&&(i=n.getActiveRowIndex()),n.NMi.nMt(t,i,r)}function K(n){return n.columnRelative}function Q(n){return n.endColumnRelative}function Z(n){return n.rowRelative}function nn(n){return n.endRowRelative}function k(n){return n.op()}function d(n){return n.toUpperCase()===f?o:n}function tn(){var n=this;n.eMt?n.eMt=!1:(n.Amt={},n.hyt={},n.iMt?n.iMt.clearAll():n.T3=new h.SheetSource(n,g.SheetArea.colHeader),n.rMt?n.rMt.clearAll():n.A3=new h.SheetSource(n,g.SheetArea.rowHeader),n.oMt?n.oMt.clearAll():n.qgt=new h.SheetSource(n,g.SheetArea.viewport))}function rn(n,t){var n,i,n=n.Uw(),i;(n&&n.t8.jme(-1,-1,-1,-1)).forEach(function(n){n.isValid||(t.spillCells=t.spillCells||{},t.spillCells[n.minX+","+n.minY]=1)})}function c(n,t,i,r,e,f){var n=n.iT(t,i,r,e,f),t=n&&n.formulas;return t&&0<t.length}function en(n,t,i,r,e,f,o){var u=c(n,t,i,r,e,3);return!u&&f&&(e=n.getColumnCount(2),u=c(n,t,0,r,e,2)),!u&&o&&(r=n.getRowCount(1),u=c(n,0,i,r,e,1)),u}function fn(n){for(var t,i,r,e,f,t=[],i=[],r=0;r<n.length;r++)f=""+(e=n[r]).row+e.col+e.rowCount+e.colCount+e.sheetName,t.indexOf(f)<0&&(t.push(f),i.push(e));return i}function on(n,t){var n=n.formulaLoad/n.total;return t?.4*n+.5:.3*n+.4}function un(n,t,i,r,e,f){var o,u,s,c,a,c,a,o=r.Uw(),u=n&&n.formula;u&&(s=void 0,"object"==typeof u&&(c=r.b3(f),(a=r.Xbt[u.si]).baseRow===t&&a.baseColumn===i?(u=a.formula,a.$fe=!0):a.$fe?(s=c.pB(a.baseRow,a.baseColumn))?(s.aMt=u.si,r.Lp.tMt&&r.Lp.tMt[o.id+","+a.baseRow+","+a.baseColumn]&&(r.Lp.tMt[o.id+","+t+","+i]={id:o.id,row:t,col:i})):(u=a.formula,a.baseRow=t,a.baseColumn=i):(u=a.formula,a.$fe=!0,a.baseRow=t,a.baseColumn=i)),(c=n.arrayInfo)&&!c.isDynamicArray?r.uMt(t,i,j(c.rowCount,10),j(c.colCount,10),u,!0,f):(a=o.getCalcSourceModel(),c&&o.t8.Zme(c.row,c.col,c.rowCount,c.colCount,!c.isInvalid),r.zI(t,i,u,s,!0,f,!0,!c,b,!0),c&&a.Uyt(t,i,c)))}function A(n,t,i,r,e,f,o){var u,s,c,a,l,h,v,d,u,f,u=e&&e.incrementLoadTask;if(u&&!u.isTerminated){for(s=u.isBusyFunc,c=f=f||0,n.suspendPaint(),a=30,l=new Date;c<i;){if(h=t[c])for(v=0;v<r;v++)un(h[v],c,v,n,!0,o);if(c++,s&&s())break;if(30<(d=new Date)-l)break}n.resumePaint(),(u=(e=e||{})&&e.incrementalLoading)&&(u.loadStatus.formulaLoad+=c-f,f=on(u.loadStatus,e.doNotRecalculateAfterLoad),n.parent&&n.parent.ki(g.Events.ProgressChanged,{loadStatus:u.loadStatus,progress:f,sheet:n}),u.loading)&&u.loading(f,{sheet:n}),c<i&&e.incrementLoadTask.pushTask(A,[n,t,i,r,e,c])}}function a(n,t,i,r,e){for(var f,o,u,f=0;f<i;f++)if(o=t[f])for(u=0;u<r;u++)un(o[u],f,u,n,!0,e)}function sn(n,t){var i,r,e,f,o,u;if(t)for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i])r.hasOwnProperty(e)&&(o=+i,u=+e,(f=r[e]).f)&&R(n.getValueIgnoreDefault(o,u))&&!n.getFormula(o,u)&&!n.getBindingPath(o,u)&&n.Ut.setDefaultValue(o,u,m(f.f),b,g.DefaultChangeValueType.Expression)}function cn(n,t,i,r,e,f,o){var u,s,c,s,a,l,h,v,d,h,h,u=n.Uw(),s=n.Ut,c=s.ap||0,s=s.fp||0;t===b||(a=m(t.f),l=t.g,(h=t.r)!==b&&(v=P(h).toJSON()),0<=l&&(a=(a&&(h={formula:a},v&&(h.lastRow=v.rowCount+v.row-1,h.lastColumn=v.colCount+v.col-1,h.baseRow=v.row,h.baseColumn=v.col,v=E),f[l]||(f[l]=h,f.nextIndex=Math.max(f.nextIndex,l+1))),{si:l}),(h=n.Xbt[a.si]).baseRow===i&&h.baseColumn===r?(a=h.formula,h.$fe=!0):h.$fe?(d=e.pB(h.baseRow,h.baseColumn))?(d.aMt=a.si,n.Lp.tMt&&n.Lp.tMt[u.id+","+h.baseRow+","+h.baseColumn]&&(n.Lp.tMt[u.id+","+i+","+r]={id:u.id,row:i,col:r})):(a=h.formula,h.baseRow=i,h.baseColumn=r):(a=h.formula,h.$fe=!0,h.baseRow=i,h.baseColumn=r)),R(a))||(1==+t.a&&v&&(v.isDynamicArray=!0,o)&&o.spillCells&&o.spillCells[i+","+r]&&(v.isInvalid=!0),a=_(a),v&&!v.isDynamicArray?c<=i&&r<s?n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),a,!0,2):i<c&&s<=r?n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),a,!0,1):c<=i&&s<=r&&n.uMt(i,r,j(v.rowCount,10),j(v.colCount,10),a,!0,3):(v&&u.t8.Zme(v.row,v.col,v.rowCount,v.colCount,!v.isInvalid),!d&&o&&o.exprs&&o.exprs[t.x]&&(d=(0,w.exprFromJSON)(o.exprs[t.x],u.getParserContext(!1)),o.exprs[t.x].nw)&&(d.sMt=!0),c<=i&&r<s?n.zI(i,r,a,d,!0,2,!0,!v):i<c&&s<=r?n.zI(i,r,a,d,!0,1,!0,!v):c<=i&&s<=r&&n.zI(i,r,a,d,!0,3,!0,!v,b,!0),v&&e.Uyt(i,r,v)))}function O(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,o,o,s,c=(f&&f.incrementLoadTask).isBusyFunc,a=o=o||0;for(n.suspendPaint(),n.suspendCalcService(),h=30,(l=f.openMode===g.OpenMode.incremental)&&(v=new Date),d=n.Xbt=n.Xbt||{nextIndex:0},w=n.b3(3);a<i;){if(m=t[a])for(C=0;C<r;C++)cn(n,m[C],a,C,w,d,e);if(a++,!u&&c&&c())break;if(l&&(_=new Date,!u)&&30<_-v)break}n.resumeCalcService(),n.resumePaint(),f.loadStatus.formulaLoad+=a-o,l&&(o=f.loadStatus.formulaLoad/f.loadStatus.total,o=+(f.fullRecalc?.3*o+.5:.4*o+.6).toFixed(5),f.incrementLoadTask.progress)&&f.incrementLoadTask.progress({progress:o,sheetName:n.name(),step:x.I5(y().STEP.loadSheetFormula,[n.name()])}),a<i&&f.incrementLoadTask.pushTask(O,[n,t,i,r,e,f,a])}function an(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterFormula;t&&t.call(i,r,e,f)})}function ln(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterSJSFormula;t&&t.call(i,r,e,f)})}function hn(t,i,r,n,e,f){var o,u,s,c,a,l,h,v,o=g.Worksheet.fh,u=!1,s=[],c=n.getReferenceSheetNames(),a=t&&t.v2,l=function(n,t){return n[t]===b||0===n[t]},h=function(n){var r;c.hasOwnProperty(n)&&(u=!0,r=(0,g._f)(t,n),l(a.sheetsState,n))&&l(a.refSheetsState,n)&&r&&(a.refSheetsState[n]=1,a.getSheet(n,function(i){var n,n,n=r.NMi;n?(n.yh(i,e,f),R(i.order)||(n.E0i=i.order),(n=(0,g.Ip)(n,i.lossless.addition,t.dataManager()))&&s.push(n)):(r.yh(i,e,f,!0),R(i.order)||(r.E0i=i.order)),o&&C(o,function(n,t){t.refSheetLazyLoaded&&t.refSheetLazyLoaded.call(r,i,e,f)})}))};for(v in c)h(v);u&&o&&C(o,function(n,t){t.afterRefSheetLazyLoaded&&t.afterRefSheetLazyLoaded.call(i,r,e,f)}),0<s.length&&f&&f.fullRecalc&&Promise.all(s).then(function(){t.suspendPaint(),t.mp[0].Mf.recalcAll(!0),t.resumePaint()})}function M(n,t,i,r){var e,f,o,o;if(n)for(e in n)(o=(f=n[e]).WK)!==b&&(r&&r.hFe&&r.hFe.delete(f),o=i.unparse(t,o,0,0),f.WK=i.parse(t,o,0,0),r)&&S(r,f.WK,f)}function S(n,t,i){var r=n.hFe=n.hFe||(0,I.createMap)();t.forEachNodes(function(n){var t;8===n.type&&((t=r.get(i))||(t=(0,I.createSet)(),r.set(i,t)),t.add(n))})}function vn(r,e){return function(n){var t,i,t,t=n.w3.rT;t&&t.Mf.xT||(i=(t?t.Mf:e).name(),t=(t?t.Mf:e)._id,r[t+" "+n.row+" "+n.column]={row:n.row,col:n.column,rowCount:1,colCount:1,sheetName:i})}}function dn(n){var t,i,t=[];for(i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t}function D(n,e,t,i,f,r,o,u){r&&n.lossless&&([n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){var t,n,i,r;n&&n.dataTable&&(n=n.dataTable,i=e.getRowCount(t=t+1),r=e.getColumnCount(t),o&&!u?A(e,n,i,r,f,0,t):a(e,n,i,r,t))}),n.lossless.defaultData)&&sn(e,n.lossless.defaultData),o&&!u?f.incrementLoadTask.pushTask(ln,[e,n,i,f]):ln(e,n,i,f)}function l(n,t,i){n&&"function"==typeof n.onCustomNameFormulaChanged&&n.onCustomNameFormulaChanged([{nameInfo:t.nameInfo,oldExpr:i,newExpr:t.expr}])}function wn(n){var t=e([],n.sheets,!0);return n.mp&&0<n.mp.length&&n.mp.forEach(function(n){n.Mf&&t.push(n.Mf)}),t}function F(n,t,i,r){var e,f,o,o,u,o=null==n?void 0:n.baseTable;n&&o&&16===n.hbt&&1===n.lbt?(e=o.range(),f=o.Mf&&o.Mf.name()):9===n.type?(F(n.value,t,i,r),F(n.value2,t,i,r)):(o=i.MX.evaluateExpression(n,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof I.CalcReference&&(f=o.getSource().getName(),0<o.getRangeCount())&&(e=(0,g.Ec)(o.getRow(u=0),o.getColumn(0),o.getRowCount(0),o.getColumnCount(0))),e&&r.push({sheetName:f,range:e})}function V(n,t){var i,r,e,n;return!t||(i=n.getRow(),r=n.getColumn(),(n=n.getExpression().getRange(i,r))&&!(n=n instanceof g.Range?n:new g.Range(n.row,n.col,n.rowCount,n.colCount)).containsRange(t))}function T(e,f,o,u,s,c){var n,a,l,h,v,d,t,i,r,w,m,h=!u&&e.Ut.pj(),v=!!c;if(e.parent&&e.parent.sheets)for(d=wn(e.parent),t=e.parent.getCustomNames(),i=e.parent.Qwt(),r=!R(e.parent.fMt)&&e.parent.wJt(),t&&C(t,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(null,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)}),i&&C(i,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(null,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)}),r&&C(r,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(null,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)}),w=function(i){var r;(n=d[i].getCustomNames())&&(r=[],C(n,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(d[i],e,f,o,u,s,a,v))!==a)&&(t.SB(l,h),r.push({nameInfo:t,oldExpr:a,newExpr:l}))}),0<r.length)&&"function"==typeof d[i].onCustomNameFormulaChanged&&d[i].onCustomNameFormulaChanged(r)},m=0;m<d.length;m++)w(m);else(n=e.getCustomNames())&&C(n,function(n,t){V(t,c)&&(a=t.getExpression(),(l=Y(e,e,f,o,u,s,a,v))!==a)&&t.SB(l,h)})}function Y(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,w,m,C,_,p,l,v,h,d,h,d,l,v,g,b,x,y,R,j,N,k,c,j,A;if(o){if(s=t.Uw(),c=(0,I.Syt)(I.Errors.Reference,s),9===o.type){if(l=o.value,h=o.value2,v=Y(n,t,i,r,e,f,l,u),d=h&&Y(n,t,i,r,e,f,h,u),l!==v||h!==d)return(0,I.rbt)(o.operatorType,v,d)}else if(7===o.type){for(w=!1,m=[],C=void 0,_=0;_<o.arguments.length;_++)p=Y(n,t,i,r,e,f,C=o.arguments[_],u),w=w||C!==p,m.push(p);if(w)return(0,I.YJ)(o,m)}else if(1===o.type&&o.hmt()){if(a=o.source||n&&n.Uw(),h=l=o.row,d=v=o.column,a&&a===s&&(f&&!o.rowRelative||!f&&!o.columnRelative)){if(f&&e)l+=i<=l?r:0;else if(!f&&e)v+=i<=v?r:0;else if(f){if(i+r<=l)l-=r;else if(i<=l)return c}else if(i+r<=v)v-=r;else if(i<=v)return c;if(l!==h||v!==d)return(0,I.knt)(s,E,l,v,o.rowRelative,o.columnRelative)}}else if(1===o.type){if(a=o.source||n&&n.Uw(),h=o.row,d=o.column,l=o.endRow,v=o.endColumn,g=o.rowRelative,b=o.columnRelative,x=o.endRowRelative,y=o.endColumnRelative,R=h,j=d,N=l,k=v,a&&a===s){if(f&&e)h+=!g&&i<=h?r:0,l+=!x&&i<=l?r:0;else if(!f&&e)d+=!b&&i<=d?r:0,v+=!y&&i<=v?r:0;else if(f&&!e){if(!g&&i<=h&&!x&&l<i+r)return c;if(g&&x||l<i)return o;if(!g)if(i+r<=h)h-=r;else if(!(h<i)){if(x)return c;i<h&&(h=i)}if(!x)if(i+r<=l)l-=r;else{if(g)return c;l<i+r&&(l=i-1)}}else{if(!b&&i<=d&&!y&&v<i+r)return c;if(b&&y||v<i)return o;if(!b)if(i+r<=d)d-=r;else if(!(d<i)){if(y)return c;i<d&&(d=i)}if(!y)if(i+r<=v)v-=r;else{if(b)return c;v<i+r&&(v=i-1)}}if(d!==j||v!==k||h!==R||l!==N)return(0,I.lJ)(s,E,h,d,l,v,g,b,x,y)}}else if(10===o.type){if((c=o.value)!==(j=Y(n,t,i,r,e,f,c,u)))return(0,I.Ayt)(j)}else 13===o.type&&(a=o.source||n&&n.Uw())&&a===s&&!f&&(o=o.offsetWhenInsertRemoveColumn(i,r,e,u));return o}}function L(n,t){var i,r,e,f,o,u,s,c,t,a,r,i=t.w3,r=i.getSource(),o=-1,u=-1;t.name?(f=t.name,c=t.id,R(c)?e=i.getNodeByName(f):(e={WK:t.expression},s=!0)):(o=t.row,u=t.column,e=i.getNode(o=void 0===o?-1:o,u=void 0===u?-1:u)),t=e.WK,a=e.$bt,r=n.unparse(r,t,o<0?0:o,u<0?0:u),a&&(!0!==n.allowDynamicArray||!0===n.allowDynamicArray&&!a.isDynamicArray)?o===a.row&&u===a.col&&i.setArrayFormula(a.row,a.col,a.rowCount,a.colCount,r):f?s?i.setFormula(c,f,r):i.setFormulaByName(f,r):i.setFormula(o,u,r,null,!0,!0),e.WK.lMt=t.lMt}function mn(n){for(var t,i,r,e,f,o,u,s,c,a,l,h,v,d,t=k(n),i,r,e,f=[n.b3(g.SheetArea.colHeader),n.b3(g.SheetArea.rowHeader),n.b3(g.SheetArea.viewport)],o=0;o<f.length;o++){if(!(u=f[o]))return;for(s=u.getAllNodes(),c=0;c<s.length;c++)if(l=(a=s[c]).calc)for(h=l.aT,v=0;v<h.length;v++)(d=l[h[v]])&&d.forEach(function(n){n&&n instanceof I.PathCalc&&L(t,n)})}}function Cn(n,t,i,r,e,f,o,u,s,c,a,l,h){p.CalcOperatorAdjustor.copyFormula(n,t,i,r,e,f,o,u,s,c,a,l,h)}function _n(n,t){var n=n.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=t,n}function X(n,t,i,r,e,f,o,u,s,c){var a,l,h,v,d,w,m,C,_,a,l,h,v,a,l,v,h,a;if(c){if(9===c.type){if(a=c.value,l=c.value2,h=X(n,t,i,r,e,f,o,u,s,a),v=l&&X(n,t,i,r,e,f,o,u,s,l),a!==h||l!==v)return(0,I.rbt)(c.operatorType,h,v)}else if(7===c.type){for(d=!1,w=[],m=void 0,C=0;C<c.arguments.length;C++)_=X(n,t,i,r,e,f,o,u,s,m=c.arguments[C]),d=d||m!==_,w.push(_);if(d)return(0,I.YJ)(c,w)}else if(1===c.type){if(a=!Z(c)&&!K(c),l=!nn(c)&&!Q(c),h=t.Uw(),(!c.source||c.source===h)&&a&&l)return v=e.Uw(),a=new p.MoveSwapInfo(h,i,r,v,f,o,u,s),l=_n(c,!0),a.R0i=!0,(v=(0,p.adjustFormulaOnMoveSwap)(h,0,0,l,a,!0))===l?c:1===v.type&&_n(v,!1)||v}else if(10===c.type&&(h=c.value)!==(a=X(n,t,i,r,e,f,o,u,s,h)))return(0,I.Ayt)(a);return c}}function pn(n,t){var i,r,e,f,o,u,s,c,i=n.printInfo&&n.printInfo();if(i)for(r=t.split(","),e=0;e<r.length;e++)for(f=(0,h.formulaToRanges)(n,r[e],0,0),o=0;o<f.length;o++)for(u=f[o].ranges,s=0;s<u.length;s++)-1===(c=u[s]).col||-1===c.colCount?(i.repeatRowStart(c.row),i.repeatRowEnd(c.row+c.rowCount-1)):-1!==c.row&&-1!==c.rowCount||(i.repeatColumnStart(c.col),i.repeatColumnEnd(c.col+c.colCount-1))}function gn(n,t,i,r,e){var n=n[t];n&&(r=n.rT,R(e)||(r.Wbt=e),n.toJSON({data:i}),delete r.Wbt)}function bn(n,t,i,r,e,f){n&&(t&&!t.fullRecalc?n.resumeWithoutCalc():n.resume(!1,!1,!n.calcOnDemand),delete n.lb),delete i.G3,f.resumePaint()}e=this&&this.__spreadArray||function(n,t,i){if(i||2===arguments.length)for(var r=0,e=t.length,f;r<e;r++)!f&&r in t||((f=f||Array.prototype.slice.call(t,0,r))[r]=t[r]);return n.concat(f||Array.prototype.slice.call(t))},Object.defineProperty(n,"__esModule",{value:!0}),n.QB=n.XB=n.adjustOneFormula=n.hMt=n.addNameInName=n.resetCustomName=n.dMt=n.convertBuiltInNameToDisplayName=void 0,g=t("Core"),i=t("Common"),I=t("CalcEngine"),h=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),p=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),w=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),E=null,b=void 0,C=g.GC$.each,v=i.Common.zf.Gmt,x=i.Common.zf,t=new i.Common.ResourceManager(g.SR),y=t.getResource.bind(t),R=i.Common.lt.ht,f="_XLNM.PRINT_AREA",J="PRINT_AREA",o="Print_Area",G=g.mt.xr,P=g.range_parser._c,m=g.mt.n1,_=g.Util.mr,j=parseInt,N=g.UsedRangeUtil.updateUsedRangeByData,n.convertBuiltInNameToDisplayName=d,n.dMt=a,(t=g.Worksheet.prototype).resetCalc=function(){tn.call(this),this.eMt=!0},t.c3n=function(n,t,i){var r,e,f,o,u,s,c,a,l,h,r=this,e=k(r);if(e){if(this.suspendPaint(),e.suspend(!0),f=this.Uw().getCalcSourceModel(),R(i)){if(n)for(M(r.hyt,r.Uw(),e,r.parent),o=f.getAllNodes(),u=0;u<o.length;u++)(c=(s=o[u]).calc)&&s.WK&&L(e,c);r.oMt.Bde(n,!t),r.iMt.Bde(n,!t),r.rMt.Bde(n,!t)}else if(!1!==n||t)for(-1===i.row&&(i.row=0,i.rowCount=r.getRowCount()),-1===i.col&&(i.col=0,i.colCount=r.getColumnCount()),a=0;a<i.rowCount;a++)for(l=0;l<i.colCount;l++)(c=(s=f.getNode(a+i.row,l+i.col))&&s.calc)&&s.WK&&(n&&L(e,c),!1!==n||t&&c.isVolatile)&&c.vyt();h=!1,1===e.calculationMode&&(h=i?function(n){return n.w3===r.oMt&&i.contains(n.row,n.column)}:function(n){return n.w3===r.oMt||n.w3===r.iMt||n.w3===r.rMt}),e.resume(!1,!0,h),this.resumePaint()}},t.recalcAll=function(n){var t,i,r,e,f,o,u,s,c,a,l,t=k(this);if(t){if(this.suspendPaint(),t.suspend(!0),n)for(r=void 0,r=(i=this.parent)&&i.sheets||[this],M(i&&i.hyt,this.Uw(),t,self.parent),e=0;e<r.length;e++)for(o=(f=r[e]).Uw(),M(f.hyt,o,t,self.parent),s=(u=o.getCalcSourceModel()).getAllNodes(),c=0;c<s.length;c++)(l=(a=s[c]).calc)&&a.WK&&L(t,l);t.resume(n),this.resumePaint()}},n.resetCustomName=M,t.recalcRange=function(n,t,i,r){var e=k(this);e&&e.recalcRange(this.Uw(),n,t,i,r)},t.recalcRows=function(n){var t,i,r,e,t=k(this);if(t&&!t.ignoreDirty()&&0<n.length){if(t.suspend(),i=n.reduce(function(n,t){return Math.min(n,t)}),r=n.reduce(function(n,t){return Math.max(n,t)}),n.length*n.length>r-i)t.recalcRange(this.qgt,i,-1,r-i+1,-1);else for(e=0;e<n.length;e++)t.recalculate(this.qgt,n[e],-1);t.resume(!1)}},t.recalcCols=function(n){var t,i,t=k(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,-1,n[i]);t.resume(!1)}},t.gL=function(n,t,i){var i,r,e,i,r=k(this);r&&!r.ignoreDirty()&&(e=this.qgt,1===i?e=this.T3:2===i&&(e=this.A3),(i=null==(i=null==e?void 0:e.t8)?void 0:i.getAnchorInfo(n,t))&&(n=i.row,t=i.col),r.recalculate(e,n,t))},t.getCalcService=function(){return this.Lp||(this.Lp=new I.CalcService,this.Uw(g.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(g.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},t.op=function(){return this.getCalcService()},t.suspendCalcService=function(n){var t=k(this);t&&t.suspend(n)},t.resumeCalcService=function(n){var t=k(this);t&&t.resume(n)},t.Uw=function(n){return R(n)||3===n?this.qgt:1===n?this.T3:2===n?this.A3:E},t.b3=function(n){var t=this;return 1===n?(!t.iMt&&t.T3&&(t.iMt=t.op().getSourceModel(t.T3)),t.iMt):2===n?(!t.rMt&&t.A3&&(t.rMt=t.op().getSourceModel(t.A3)),t.rMt):(!t.oMt&&t.qgt&&(t.oMt=t.op().getSourceModel(t.qgt)),t.oMt)},t.vMt=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!0,!0)},t.KT=function(n,t,i,r,e,f){var o=this.vMt(n,t,i,r,3);return!o&&e&&(r=this.getColumnCount(2),o=this.vMt(n,0,i,r,2)),!o&&f&&(i=this.getRowCount(1),o=this.vMt(0,t,i,r,1)),o},t.iT=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!1,!0)},t.mT=function(n,t,i,r,e,f,o){var u,e,u=(e=void 0===e?!0:e)&&this.KT(n,t,i,r,f,o),e=!e&&en(this,n,t,i,r,f,o);return!u&&!e||(this.jT(4,y().Exp_ChangePartOfArray),!1)},t.addCustomFunction=function(n){this.Uwt(n),this.recalcAll()},t.Uwt=function(n){if(!(n&&n instanceof I.Functions.Function))throw new Error(y().Exp_InvalidCustomFunction);n.name=v(n.name),this.Amt[n.name]=n},t.getCustomFunction=function(n){return n?this.Amt[v(n)]:E},t.removeCustomFunction=function(n){n&&(delete this.Amt[v(n)],this.recalcAll())},t.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},t.Jbt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomFunction(n))&&i&&i.getCustomFunction?i.getCustomFunction(n):t):E},t.addCustomName=function(n,t,i,r,e,f){this.zwt(n,t,i,r,!1,e,f)},t.getCustomName=function(n){return n?this.hyt[v(n)]:b},t.qRe=function(i,r,n,t,e){var f,f,o,u,s,c,a,f,f,l,f,o=this;if(t=null!=t?t:0,e=null!=e?e:0,o.Lp){if(u=o.hyt[v(i)])if(s=void 0,n&&(s=o.Lp.parse(o.Uw(),n,t,e)),r&&i!==r){if(!o.isValidCustomName(r))throw new Error(y().Exp_InvalidCustomName);if(c=[],a=[],(f=o.parent.hFe)&&f.forEach(function(n){n.forEach(function(n){var t,t;n.value===i&&(null==(t=n.source)?void 0:t.Mf)===o&&c.push(n),n.value===r&&(null==(t=n.source)?void 0:t.Mf)===o&&a.push(n)})}),2===(f=null==(f=o.b3())?void 0:f.dFe(i,r,0<c.length,0<a.length,null==(f=o.parent)?void 0:f.wC)))throw new Error(y().Exp_CustomNameBothInUse);o.suspendCalcService(),(u=o.hyt[v(i)]).btV(r),delete o.hyt[v(i)],o.hyt[v(r)]=u,c.forEach(function(n){n.value=r}),o.b3().updateNameCalc(r,!0),s&&(l=o.hyt[v(r)],o.removeCustomName(r),o.zwt(r,n,t,e,!1,u.getComment(),u.isReadOnly(),l)),3!==f||s||((f={})[r]=r,this.Zwt(f,!0)),o.resumeCalcService()}else s&&(o.suspendCalcService(),l=o.hyt[v(i)],o.removeCustomName(i),o.zwt(i,n,t,e,!1,u.getComment(),u.isReadOnly(),l),o.resumeCalcService());o.zw()}},t.getCustomNames=function(){var i=[];return C(this.hyt,function(n,t){i.push(t)}),i},t.removeCustomName=function(n){var t,t,n,i,t;n&&(n=v(n),i=this.hyt[n],null!=(t=null==(t=this.parent)?void 0:t.hFe)&&t.delete(i),delete this.hyt[n],(t={})[n]=n,this.Zwt(t,!1))},t.clearCustomNames=function(){var n,t,i,r,e,f,i=this,r=i.hyt;if(null!=(n=this.parent)&&n.hFe)for(e in r)Object.prototype.hasOwnProperty.call(r,e)&&(f=r[e],null!=(t=this.parent))&&t.hFe.delete(f);i.hyt={},this.Zwt(r,!1)},t.createNameInfo=function(n,t,i,r,e){var f,o,f,o,f=this,o=k(f),f=f.Uw();return o&&f?(o=o.parse(f,t,r,e),new h.NameInfo(n,o,r,e,i)):E},t.getNameInfos=function(){return this.hyt},t.setNameInfos=function(n){R(n)||(this.hyt=n)},t.Vwt=function(n){var t,i,t,t=this,i=!t.hyt[v(n)];return i=i&&(t=t.tables)?!t.findByName(n):i},t.isValidCustomName=function(n){return n&&g.mt.P0(n)&&this.Vwt(n)},n.addNameInName=S,t.zwt=function(n,t,i,r,e,f,o,u){var s,c,a,l,c,a,s=this;if(!n||!t||!e&&!s.isValidCustomName(n))throw new Error(y().Exp_InvalidCustomName);if(c=k(s),a=s.Uw(),c&&a){if(l=void 0,e)try{l=c.parse(a,t,i,r,!1,!0,!0)}catch(n){}else l=c.parse(a,t,i,r);c=void 0,u?(c=u).SB(l,b,i,r):c=new h.NameInfo(n,l,i,r,f,o,s),s.hyt[v(n)]=c,l&&s.parent&&S(s.parent,l,c),e||((a={})[n]=n,this.Zwt(a,!0))}},t.Wwt=function(n,t,i,r,e,f,o,u){var s,t,c,t,c,s=this;if(!n||!t||!f&&!s.isValidCustomName(n))throw new Error(y().Exp_InvalidCustomName);t=k(s),c=s.Uw(),t&&c&&(t=s.hyt[v(n)]=new h.NameInfo(n,i,r,e,o,b,s),i&&s.parent&&S(s.parent,i,t),f||((c={})[n]=n,this.Zwt(c,!0)))},t.Zwt=function(n,t){var i,r,e,r=this.b3();if(r){for(e in n)r.updateNameCalc(e,t);null!=(i=this.parent)&&i.Zwt(n,t),this.recalcAll(!1)}this.ki(g.Events.CustomNameChangedInternal,{})},t.gMt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomName(n))&&i&&i.getCustomName?i.getCustomName(n):t):E},t.setFormula=function(n,t,i,r){this.zI(n,t,i,E,!1,r)},t.zI=function(n,t,i,r,e,f,o,u,s,c,a){var l,h,v,d,w,m,C,C,_,m,h,v,u,C,c,d,r,l=this;R(f)&&(f=3),n<0||n>=l.getRowCount(f)||t<0||t>=l.getColumnCount(f)?l.jT(0,y().Exp_IndexOutOfRange):(h=0<=n?n:0,v=0<=t?t:0,d=l.Uw(f),w=l.options.keepUnknownFormulas,(m=l.Lp).forceR1C1Formula&&3===f&&!l.isReportTemplateSheet?(C=m.useR1C1,m.useR1C1=!0,r=r||(i&&m?m.parse(d,i,h,v,!1,e,!1,w):E),m.useR1C1=C):r=r||(i&&m?m.parse(d,i,h,v,!!l.OTe,e,e,w):E),r&&u&&(r.ensureSingle=!0),C=l.tables,3===f&&0<=n&&0<=t&&C&&!(_=C.pMt(n,t,1,1,i,r))||(m=w&&i&&!r,h=l.b3(f),v=l.conditionalFormats,h&&(u=h.getFormula(n,t,b,!0),C=l.Ut,c||d.t8.Fgt(n,t),(c=R(l.vle)&&!i)&&(l.vle=!(i||l.Sge&&l.Sge(n,t))),h.FE=!0,d=l.vle&&i===E,h.setFormula(n,t,i,r,e,d,!a&&C.pj(),s,w),c&&delete h.FE,delete l.vle,h.usedRange&&N(h.usedRange,n,t,u,i),m&&(r=h.getNode(n,t,!0))&&(r.qbt=i),v&&v.dl(),l.hasFormula(n,t,f)&&C.JE(n,t,f),o?l.Lj(l,[{row:n,col:t}],0):l.Rj("formula",n,t,f,u,i)),l.Q1i&&l.Q1i(n,t,1,1,f),l.zw()))},t.eL=function(n,t,i,r,e,f,o,u){var s,c,a,l,h,v,d,s=this,c=this.op();if(n<0||n>=s.getRowCount()||t<0||t>=s.getColumnCount())s.jT(0,y().Exp_IndexOutOfRange);else if(l=s.b3(o))for(h=n;h<i+n;h++)for(v=t;v<r+t;v++)h===n&&v===t&&(s.zI(n,t,e,E,!1,o),a=l.pB(n,t),s.Xbt=s.Xbt||{nextIndex:0},d=s.Xbt.nextIndex,s.Xbt[d]={formula:c.unparse(this.qgt,a,n,t,!1,!0),baseRow:n,baseColumn:t,lastRow:n+i-1,lastColumn:t+r-1},s.Xbt.nextIndex++,a.aMt=d),s.zI(h,v," ",a,!0,o,!0,!0)},t.setArrayFormula=function(n,t,i,r,e,f){this.uMt(n,t,i,r,e,!1,f)},t.uMt=function(n,t,i,r,e,f,o,u){var s,c,a,l,c,h,v,d,w;if(void 0===o&&(o=3),s=this,n<0||n+i>s.getRowCount()||t<0||t+r>s.getColumnCount())s.jT(0,y().Exp_IndexOutOfRange);else if(s.Ut.eE(n,t,i,r))s.jT(0,y().Exp_ArrayFormulaSpan);else if(c=s.tables,!(3===o&&0<=n&&0<=t&&c)||(a=c.pMt(n,t,i,r,e))){if(l=s.b3(o),c=s.conditionalFormats,l){for(h=[],v=n;v<n+i;v++)for(h[v]=[],d=t;d<t+r;d++)h[v][d]=l.getFormula(v,d);for(l.setArrayFormula(n,t,i,r,e,f,s.Ut.pj(),u,!1),v=n;v<n+i;v++)for(d=t;d<t+r;d++)l.usedRange&&N(l.usedRange,v,d,h[v][d],e);if(c&&c.dl(),s.vf<1){for(w=[],v=n;v<n+i;v++)for(d=t;d<t+r;d++)w.push({row:v,col:d});s.SI(n,t,i,r,w,5,o,e)}}s.zw()}},t.getFormula=function(n,t,i,r){var i,e,i=this.b3(i);return!i||(e=i.oT(n,t))&&e.isDefault()?E:i.getFormula(n,t,r)},t.bMt=function(n,t,i){var i=this.b3(i);return i?i.pB(n,t):E},t.getFormulaInformation=function(n,t,i,r){var e,i,f,o,f,u,u,s,c,e={},i=this.b3(i);if(i){if(o=(f=i.oT(n,t))&&f.isDefault())return e;(f=i.pB(n,t))?(u=i.sT(n,t),e.hasFormula=!0,u&&(e.baseRange=new g.Range(u.row,u.col,u.rowCount,u.colCount)),e.isArrayFormula=u&&!u.isDynamicArray,n=u?u.row:n,t=u?u.col:t,r||(e.formula=this.Lp.unparse(this.qgt,f,n,t),e.formulaWithCulture=this.Lp.unparse(this.qgt,f,n,t,!0)),e.hasFormula=!!e.formula):(u=this.Uw().t8.getAnchorInfo(n,t))&&u.isValid&&(s=u.row,c=u.col,e.baseRange=new g.Range(u.row,u.col,u.rowCount,u.colCount),n===s&&t===c||(f=i.pB(s,c),r||(e.formulaWithCulture=this.Lp.unparse(this.qgt,f,s,c,!0)),e.hasFormula=!0,e.isDynamicArray=!0))}return e},t.VI=function(n,t,i,r,e,f){var o,u,s,c,a,l,h,v,d,w,m,C;for(i||(i=this,r=n,e=t,f=[]),o=i.qwt(r,e),u=this.name(),s=0;s<o.length;s++){if(f[a=(c=o[s]).sheetName+"_"+c.row+"_"+c.col+"_"+c.rowCount+"_"+c.colCount])return!1;if(f[a]=!0,(c.row<=n&&n<c.row+c.rowCount||-1===c.rowCount)&&(c.col<=t&&t<c.col+c.colCount||-1===c.colCount)&&u===c.sheetName)return!0;for(l=c.sheetName===u?i:i.parent.getSheetFromName(c.sheetName),h=c.rowCount,v=c.row,d=c.colCount,w=c.col,-1===h&&(h=l.getRowCount(),v=0),-1===d&&(d=l.getColumnCount(),w=0),m=v;m<h+v;m++)for(C=w;C<d+w;C++)if(this.VI(n,t,l,v,w,f))return!0}return!1},t.getCrossSheetReferences=function(r){for(var n,e,t,i,f,o,u,s,c,a,l,h,v,d,n=this,e=(0,I.createMap)(),t=n.getRowCount(),i=n.getColumnCount(),f=n.b3(),o=f.rT.id,s=function(n,t){var i,i,i=n.w3.getSource();i&&i.id!==o&&(r?(i=i.getName())&&0<i.length&&e.set(i,!0):e.set(t,n))},c=0;c<t;c++)for(a=0;a<i;a++)if((l=f.oT(c,a))&&l.aT)for(u=l.aT,h=0;h<u.length;h++)(v=l[u[h]])&&v.forEach(s);if((d=f.uT())&&d.aT)for(u=d.aT,h=0;h<u.length;h++)(v=d[u[h]])&&v.forEach(function(n){n&&n.content.forEach(s)});return e},t.getPrecedents=function(n,t){var i,r,r,e,f,n,f,i=[],r=this.b3();return r&&(r=r.Fyt(n,t)||r.pB(n,t),n=(f=(e=this.getFormulaInformation(n,t,3,!0)).baseRange)?f.row:n,f=f?f.col:t,this.yMt(r,n,f,i),i=fn(i)),i},t.getDependents=function(c,a){var l,n,h,l=[],n=this.parent&&this.parent.sheets||[this],h=this.name();return n.forEach(function(n){for(var t,i,r,e,f,o,u,s,t=n.getRowCount(),i=n.getColumnCount(),r=n.name(),e=0;e<t;e++)for(f=0;f<i;f++)for(o=n.getPrecedents(e,f),u=0;u<o.length;u++)if((s=o[u]).sheetName===h&&(-1===s.row||s.row<=c&&c+1<=s.row+s.rowCount)&&(-1===s.col||s.col<=a&&a+1<=s.col+s.colCount)){l.push({row:e,col:f,rowCount:1,colCount:1,sheetName:r});break}}),l},s={},t.qwt=function(n,t){var i,r,e,r,r,f,o,u,i={},r=this.b3().oT(n,t),e=this.b3().uT();if(r&&(r=r[0])&&r.forEach(vn(i,this)),e&&e[0])for(r=e["0c"],s.minX=t,s.minY=n,s.maxX=t,s.maxY=n,f=r.search(s),o=0;o<f.length;o++)(u=f[o].content).forEach(vn(i,this));return dn(i)},t.yMt=function(n,t,i,r){var e,f,f,o,u,s;if(n)switch(e=n.type){case I.ExpressionType.reference:case I.ExpressionType.structReference:f=n.getRange(t,i),r.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:(n.source&&n.source.Mf?n.source.Mf:this).name()});break;case I.ExpressionType.operator:this.yMt(n.value,t,i,r),this.yMt(n.value2,t,i,r);break;case I.ExpressionType.expand:case I.ExpressionType.parentheses:this.yMt(n.value,t,i,r);break;case I.ExpressionType.name:f=this.gMt(n.value),this.yMt(f.getExpression(),t,i,r);break;case I.ExpressionType.function:for(o=n.arguments,u=0;u<o.length;u++)s=o[u],this.yMt(s,t,i,r)}},t.hasFormula=function(n,t,i,r){var i=this.b3(i);return!!i&&i.hasFormula(n,t,r)},t.wMt=function(){var n=this.b3();n&&n.MMt(function(n){n.CMt(),n.yB()})},t.clearFormula=function(n,t,i,r,e){var f,o,u,f=this;for(n<0&&(n=0,i=f.getRowCount()),t<0&&(t=0,r=f.getColumnCount()),o=0;o<i;o++)if(e(f,o+n))for(u=0;u<r;u++)f.setFormula(o+n,u+t,E)},t.nameFunctionsFromJSON=function(n,t,i,r){var e,f,o,u,s,s,c,a,l;if(n){if(e=this,f=n.customFunctions)for(o in f)f.hasOwnProperty(o)&&(u=f[o],s=(0,g.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u,t),e.Uwt(s));if((c=n.names)&&0<c.length){for(a=0;a<c.length;a++)l=c[a],e.zwt(d(l.name),l.formula,l.row,l.col,!0,l.comment,l.isReadOnly);e.wMt()}r&&r()}},t.formulaFromJSON=function(n,t,e){var f,o,u;n&&((f=this).Xbt=n.sharedFormulas,o=e&&e.ignoreFormula,u=e&&e.incrementalLoading,[n.colHeaderData,n.rowHeaderData,n.data].forEach(function(n,t){var t,n,i,r;n&&!o&&n.dataTable&&(n=n.dataTable,i=f.getRowCount(t=t+1),r=f.getColumnCount(t),u?A(f,n,i,r,e,0,t):a(f,n,i,r,t))}),n.defaultData&&sn(f,n.defaultData),u?e.incrementLoadTask.pushTask(an,[f,n,t,e]):an(f,n,t,e))},t.formulaFromSJSFormat=function(n,t,i,r){var e,f,o,u,s,c,f,a,l,e=this,f=e.Uw(),o=!i||!1!==i.includeFormulas,u=g.Util.Mo(i),s=g.Util.wo(i,e.parent&&e.parent.v2),c=e.b3(3);f.G3=!0,o&&n.lossless&&n.lossless.tree&&i.$wt&&f.setReferenceSheetNames(n.lossless.referenceSheetNames),(f=G(n,g.XFileConstants.bo))?(a=f.rowCount,l=f.colCount,r?(o&&O(e,f,a,l,n.lossless,i,0,r),D(n,e,c,t,i,o,u,r)):(o&&i.incrementLoadTask.addTask(O,[e,f,a,l,n.lossless,i,0],x.I5(y().STEP.loadSheetFormula,[e.name()]),function(){var n=i.loadStatus.formulaLoad/i.loadStatus.total;return i.fullRecalc?s?.5:n*g.STEP_RATE.loadSheetFormulaWithCalc+g.STEP_RATE.loadSheetDataWithCalc+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData:s?.6:n*g.STEP_RATE.loadSheetFormula+g.STEP_RATE.loadSheetData+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData},e.name()),i.incrementLoadTask.addTask(D,[n,e,c,t,i,o,u]))):r?D(n,e,c,t,i,o,u,r):i.incrementLoadTask.addTask(D,[n,e,c,t,i,o,u])},t.nameFunctionFromSJSFormat=function(n,t,i){var e,f,r,o,u,s,s,c,a,e=this,f=e?e.Uw():E,r=n.lossless&&n.lossless.customFunctions;if(r)for(o in r)r.hasOwnProperty(o)&&(u=r[o],s=(0,g.getTypeFromString)(u.typeName))&&((s=new s).fromJSON(u),e.Uwt(s));c=n.lossless&&n.lossless.definedNames,a=n.lossless&&n.lossless.nExpr,c&&0<c.length&&(c.forEach(function(n){var t=""+n.c_[0],i=m(n.name),r=m(n.comment);"_xlnm.Print_Titles"===i?pn(e,t):a&&a[n.e]?e.Wwt(d(i),_(m(t)),(0,w.exprFromJSON)(a[n.e],f.getParserContext(!1)),0,0,!0,r,"_xlnm.Print_Area"!==i):e.zwt(d(i),_(m(t)),0,0,!0,r,n.isReadOnly)}),e.wMt())},t.SMt=function(n){var t=this,i=t.Lp;i&&!n||(t.Lp=n||new I.CalcService,t.Uw(g.SheetArea.colHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.rowHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.viewport).setCalcService(t.Lp),t.Lp.initParserContext(t.Uw()),i?(n.setSourceModel(t.T3,i.getSourceModel(t.T3)),n.setSourceModel(t.A3,i.getSourceModel(t.A3)),n.setSourceModel(t.qgt,i.getSourceModel(t.qgt))):(t.iMt=t.Lp.getSourceModel(t.T3),t.rMt=t.Lp.getSourceModel(t.A3),t.oMt=t.Lp.getSourceModel(t.qgt)),t.oMt.usedRange=new g.BaseUsedRange)},t.setCalc=function(n,t){this.Lp=n,this.qgt=t||this.qgt,this.oMt=n.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=n)},t.YA=function(){this.ol(!1,1)},t.TMt=function(n,t){var i,r,e,f,o,u,s,c,a,l,h,v,d,w,m,C,_,p,i=this,r=n.changeType,e=n.row,f=n.rowCount,o=n.col,u=n.colCount,s=n.sheetArea,c=R(s)||s===g.SheetArea.viewport,a=i.b3(s),l=a.usedRange;a&&(v=(h=i.Ut).pj(),d=k(a),w=a.rT,m=d.Hyt(),C=d.MX.asyncManager,"addingRows"===r?i.mT(e,0,0,i.getColumnCount(),void 0,!0,!1)?n.onlyCheck||(_=c?i.b3(2):b,m.onBeforeAddRemoveRows(a,e,_),T(i,e,f,!0,!0),[a,_].forEach(function(n){n&&n.addRows(e,f)}),C.addRows(w,e,f)):n.canAdd=!1:"addRows"===r?(d.suspend(),_=c?i.b3(2):b,m.onAfterAddRemoveRows(a,e,f,!0,t,_),d.resume(!1),v&&v.push({type:"addRows",row:e,rowCount:f,sheetArea:s}),l&&l.addHeadInfo(e,f,!0)):"deletingRows"===r?i.mT(e,0,f,i.getColumnCount(),void 0,!0,!1)?n.onlyCheck||(_=c?i.b3(2):b,d.KAe=v,m.onBeforeAddRemoveRows(a,e,_,!t,f),T(i,e,f,!1,!0),[a,_].forEach(function(n){n&&n.deleteRows(e,f,t)}),C.deleteRows(w,e,f)):n.canDelete=!1:"deleteRows"===r?(d.suspend(),_=c?i.b3(2):b,m.onAfterAddRemoveRows(a,e,f,!1,t,_),d.resume(!1),v&&v.push({type:"deleteRows",row:e,rowCount:f,sheetArea:s}),delete d.KAe,l&&l.removeHeadInfo(e,f,!0)):"setRowCount"===r&&f!==e?(d.suspend(),_=i.b3(2),e<f?(a.gF(e+1,0,f-e,i.getColumnCount()),_.gF(e+1,0,f-e,i.getColumnCount()),a.rT.t8.Fgt(e+1,-1,f-e,-1)):(a.gF(f+1,0,e-f,i.getColumnCount()),_.gF(f+1,0,e-f,i.getColumnCount()),a.rge(f,e),_.rge(f,e)),d.AMt(2),d.resume(!1)):"setColumnCount"===r&&u!==o?(d.suspend(),p=i.b3(1),o<u?(a.gF(0,o+1,i.getRowCount(),u-o),p.gF(0,o+1,i.getRowCount(),u-o),a.rT.t8.Fgt(-1,o+1,-1,u-o)):(a.gF(0,u+1,i.getRowCount(),o-u),p.gF(0,u+1,i.getRowCount(),o-u),a.oge(u,o),p.oge(u,o)),d.AMt(3),d.resume(!1)):"addingColumns"===r?i.mT(0,o,i.getRowCount(),0,void 0,!1,!0)?n.onlyCheck||(p=c?i.b3(1):b,m.onBeforeAddRemoveColumns(a,o,p),T(i,o,u,!0,!1),[a,p].forEach(function(n){n&&n.addColumns(o,u)}),C.addColumns(w,e,f)):n.canAdd=!1:"addColumns"===r?(d.suspend(),p=c?i.b3(1):b,m.onAfterAddRemoveColumns(a,o,u,!0,t,p),d.resume(!1),v&&v.push({type:"addColumns",col:o,colCount:u}),l&&l.addHeadInfo(o,u,!1)):"deletingColumns"===r?i.mT(0,o,i.getRowCount(),u,void 0,!1,!0)?n.onlyCheck||(p=c?i.b3(1):b,d.KAe=v,m.onBeforeAddRemoveColumns(a,o,p,!t,u),T(i,o,u,!1,!1),[a,p].forEach(function(n){n&&n.deleteColumns(o,u,t)}),C.deleteColumns(w,e,f)):n.canDelete=!1:"deleteColumns"===r&&(d.suspend(),p=c?i.b3(1):b,m.onAfterAddRemoveColumns(a,o,u,!1,t,p),d.resume(!1),v&&v.push({type:"deleteColumns",col:o,colCount:u,sheetArea:s}),delete d.KAe,l)&&l.removeHeadInfo(o,u,!1))},t.IMt=function(n,t,i,r){var e,f,o,u,s,c,e=i.type,f=this;if(r){if("addRows"===e)i.changeType="addingRows",f.TMt(i),i.changeType="addRows",f.TMt(i);else if("deleteRows"===e)i.changeType="deletingRows",f.TMt(i),i.changeType="deleteRows",f.TMt(i);else if("addColumns"===e)i.changeType="addingColumns",f.TMt(i),i.changeType="addColumns",f.TMt(i);else if("deleteColumns"===e)i.changeType="deletingColumns",f.TMt(i),i.changeType="deleteColumns",f.TMt(i);else if("customName"===e)o=n.parse(f,i.newFormula,0,0),u=i.nameInfo.getExpression(),i.nameInfo.SB(o),l(f,i,u);else if("condition"===e){for(s=[],c=0;c<i.newFormulas.length;c++)o=n.parse(f,i.newFormulas[c],0,0),s.push(o);i.condition.setExpressions(s)}}else if("addRows"===e)i.changeType="deletingRows",f.TMt(i,!0),i.changeType="deleteRows",f.TMt(i,!0);else if("deleteRows"===e)i.changeType="addingRows",f.TMt(i,!0),i.changeType="addRows",f.TMt(i,!0);else if("addColumns"===e)i.changeType="deletingColumns",f.TMt(i,!0),i.changeType="deleteColumns",f.TMt(i,!0);else if("deleteColumns"===e)i.changeType="addingColumns",f.TMt(i,!0),i.changeType="addColumns",f.TMt(i,!0);else if("customName"===e)o=n.parse(f,i.formula,0,0),u=i.nameInfo.getExpression(),i.nameInfo.SB(o),l(f,i,u);else if("condition"===e){for(s=[],c=0;c<i.formulas.length;c++)o=n.parse(f,i.formulas[c],0,0),s.push(o);i.condition.setExpressions(s)}},t.xMt=function(n,t,i){var r,e,f,r=i.type,e=this;"addRows"===r?(i.changeType="deletingRows",e.TMt(i,!0),i.changeType="deleteRows",e.TMt(i,!0)):"deleteRows"===r?(i.changeType="addingRows",e.TMt(i,!0),i.changeType="addRows",e.TMt(i,!0)):"addColumns"===r?(i.changeType="deletingColumns",e.TMt(i,!0),i.changeType="deleteColumns",e.TMt(i,!0)):"deleteColumns"===r?(i.changeType="addingColumns",e.TMt(i,!0),i.changeType="addColumns",e.TMt(i,!0)):"customName"===r?(f=i.nameInfo.getExpression(),i.nameInfo.SB(i.expr),l(e,i,f)):"condition"===r&&i.condition.setExpressions(i.expressions)},t.NMt=function(n,t){var i,r,e,f,o,i=this,r=k(i),e=i.b3();if(r.suspend(),t)for(f=0;f<n.length;f++)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue&&i.setFormula(o[0],o[1],o.formula);else for(f=n.length-1;0<=f;f--)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue||i.setFormula(o[0],o[1],o.formula);r.resume(!1)},t.xj=function(n){var t,t,i,r,e,f,o,u,s,c,a,l,h,v,d,w,m,C,t=n[n.length-1],t=t&&t.sheetArea,i=R(t)||t===g.SheetArea.viewport,r=k(this),e=this.b3(t),f=this.Uw(t);for(r.suspend();n.length;)if((o=n.pop()).type)this.xMt(r,e,o);else{if(u=o[0],s=o[1],c=o[2],a=o[3],l=o[4],h=u.pB(s,c),d=[],v=i&&f.t8.getAnchorInfo(s,c)){for(w=v.row;w<v.row+v.rowCount;w++)for(d[w]=[],m=v.col;m<v.col+v.colCount;m++)d[w][m]=this.getValue(w,m);!v.isValid||a||l||f.t8.Rme(f.t8.Pme(s,c),!0,!1,!0)}if(u.kMt.apply(u,o),(C=i&&u&&u.usedRange)&&(N(C,s,c,h,a),v))for(w=v.row;w<v.row+v.rowCount;w++)for(m=v.col;m<v.col+v.colCount;m++)w===s&&m===c||N(C,w,m,d[w][m],a)}n&&n.Vme&&f.t8.Wme(n.Vme),r.resume(!1)},t.getReferenceRange=function(n){var t,i,r,e,f,o,n,u,t=this.Uw(),i=this.getCalcService(),r=i.parse(t,n,0,0,void 0,!0),o=r.baseTable;return r&&o&&n===o.name()?(e=o.range(),f=o.Mf&&o.Mf.name()):(n=i.MX.evaluateExpression(r,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof I.CalcReference&&(f=n.getSource().getName(),0<n.getRangeCount())&&(e=(0,g.Ec)(n.getRow(u=0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))),{sheetName:f,range:e}},t.sCe=function(n){var t,i,n,r,e,f,t=this.Uw(),i=this.getCalcService(),n=i.parse(t,n,0,0,void 0,!0),r=[],e=[],f={};return F(n,t,i,r),r.forEach(function(n){var t=n.sheetName,n=n.range;f[t]||(f[t]={sheetName:t,ranges:[]},e.push(f[t])),f[t].ranges.push(n)}),e},t.dL=function(n,t,i,r){var e,f,f,e=this,f="string"==typeof r&&e.parent&&e.parent.xO(r);return f&&-1!==n&&-1!==t?(f=f.getExpression(),q(e,r)?z(e,f,n,t):(0,h.evaluateExpression)(e,f,n,t,{sheetArea:i})):b},t.TL=function(n,t,i){var r,e,f,o,f,u,s,c,a,r=this,e=!!r.NMi,f=r.getCell(n=-1===n?0:n,t=-1===t?0:t,3),o=(0,h.rangeToFormula)(f,n,t,3);if(0<=(f="="===(f=i.trim()).charAt(0)&&0<=f.indexOf("@")&&!B(f)?f.replace(/@/g,o):f).indexOf("{{")&&0<=f.indexOf("}}")){for(""===(u=f.split(/{{|}}/))[0]&&u.shift(),""===u[u.length-1]&&u.pop(),s=0;s<u.length;s++)-1===u[s].indexOf("=")?u[s]='"'+u[s]+'"':(!e||!B(u[s]))&&(0<=u[s].indexOf("@")&&(u[s]=u[s].replace(/@/g,o)),(c=(0,h.evaluateFormula)(r,u[s]))instanceof I.CalcError)?u[s]='"'+c.toString()+'"':u[s]=u[s].replace(/=/g,"");f="=CONCAT("+u.join(",")+")"}(a=r.parent).xO(i)||a.pp(a.bp,i,f,n,t,!0,"",r.NMi)},t.NO=function(n,t,i,r){var e=this;return(q(e,n)?z:(0,h.evaluateExpression))(e,t,i,r)},n.hMt=T,n.adjustOneFormula=L,n.XB=Cn,n.QB=X,g.Worksheet.ch("calc",{priority:1e3,init:tn,dispose:function(n){var n,n,t,i,t,t,t,t,i=this;!1!==n.clearCache&&(i.qgt=E,i.A3=E,i.T3=E,i.Lp=E,(t=i.oMt)&&(!0===n.isSheetDestroy?t.DMt():t._Mt(),i.oMt=E),(t=i.rMt)&&(!0===n.isSheetDestroy?t.DMt():t._Mt(),i.rMt=E),(t=i.iMt)&&(!0===n.isSheetDestroy?t.DMt():t._Mt(),i.iMt=E),t=null==(n=i.parent)?void 0:n.Lp)&&null!=(t=null==(n=t.MX)?void 0:n.asyncManager)&&t.clearNodesByName(i.name())},attach:function(n){var t=this;n instanceof g.Workbook?t.SMt(n.Lp):t.SMt()},onLayoutChanged:function(n){this.op().isAdjustSuspended()||this.TMt(n)},toJson:function(n,t){var s,i,r,c,i,a,e,f,o,u,s=this,i=s.Amt;g.GC$.isEmptyObject(i)||(n.customFunctions=i),r=t&&t.newWorkSheetName,c=[],i=s.getCustomNames(),a=k(s),e=s.b3(),f=e.rT,i&&a&&(!R(r)&&e&&f&&(f.Wbt=r),C(i,function(n,t){var i,r,e,f,o,t,u,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:u=a.unparse(s.Uw(),f,r,e,!1,!0,1),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),c.push(i))}),0<c.length&&(n.names=c),delete f.Wbt),(o=t&&t.ignoreFormula)||(u=[s.oMt,s.iMt,s.rMt],[n.data,n.colHeaderData,n.rowHeaderData].forEach(function(n,t){gn(u,t,n,f,r)}),s.Xbt&&0<s.Xbt.nextIndex&&(n.sharedFormulas=s.Xbt))},fromJson:function(n,t,i,r){var e,f,e=this,f;i&&i.incrementalLoading||(e.clearCustomFunctions(),e.clearCustomNames()),r&&(e.nameFunctionsFromJSON(n,t,i),e.formulaFromJSON(n,t,i))},wh:function(n,t,o){var u,i,r,s,c,i,a,e,f,l,h,v,h,e,d,u=this,i=u.Amt;g.GC$.isEmptyObject(i)||(n.lossless.customFunctions=i),r=o&&o.newWorkSheetName,s=[],c=[],i=u.getCustomNames(),a=k(u),e=u.b3(),f=e.rT,l={},u.parent&&(h=u.parent.yC,l=h&&h.getUsedCustomNames()||{}),i&&a&&!u.NMi&&(!R(r)&&e&&f&&(f.Wbt=r),v=!o||!1!==o.includeUnusedNames,C(i,function(n,t){var i,r,e,t,f,i,t,i=t.getName(),r=t.getExpression(),e=t.isReadOnly(),t=t.getComment();i.toUpperCase()!==J&&r&&(v||l[i])&&(i={name:i,comment:t,isReadOnly:e,formula:f=a.unparse(u.Uw(),r,0,0,!1,!0,1)},o&&o.includeCalcModelCache&&!u.ctr&&(t=(0,w.exprToJSON)(r),s.push(t),i.e=s.length-1),c.push(i))}),0<c.length&&(n.lossless.definedNames=c),0<s.length&&(n.lossless.nExpr=s),delete f.Wbt),(h=o&&!1===o.includeFormulas)||((e=u.oMt)&&(f=e.rT,R(r)||(f.Wbt=r),e.wh(n,o),delete f.Wbt),d=[u.iMt,u.rMt],n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){gn(d,t,n,f,r)})),!h&&g.Util.ko(o)&&(o&&o.includeCalcModelCache&&!u.ctr&&(n.lossless.tree=(0,w.mbt)(u.b3())),f=u.Uw(),n.lossless.referenceSheetNames=f&&f.getReferenceSheetNames(),rn(u,n.lossless))},yh:function(n,t,i,r){var e,f,o,u,s,c,a,e=this,f=e.parent,u=g.Util.wo(i,e.parent&&e.parent.v2),s=i&&!i.fullRecalc,c=e.Uw();e.suspendPaint(),f&&f.Lp&&((o=f.Lp).suspend(),o.lb=s),(a=g.Util.Mo(i))||(e.clearCustomFunctions(),e.clearCustomNames()),u&&(c.G3=!0,e.nameFunctionFromSJSFormat(n,t,i),e.formulaFromSJSFormat(n,t,i,r),r?hn(f,e,n,c,t,i):i.incrementLoadTask.addTask(hn,[f,e,n,c,t,i])),r?bn(o,i,c,u,s,e):i.incrementLoadTask.addTask(function(n,t,i,r,e,f){bn(n,t,i,r,e,f)},[o,i,c,u,s,e])},setName:function(n){var t,i,r;mn(this),(r=(i=k(t=this.b3())).MX.asyncManager).changeSourceName(n.oldName,n.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()},canAddingSpan:function(n){var t,i,r,e,f,o,t=this,i=n.sheetArea,r=n.row,e=n.col,f=n.rowCount,o=n.colCount;3!==i&&!R(i)||t.mT(r,e,f,o,!1)||(n.isAllow=!1)}}),g.Y8.ch("calc",{isInvalidFormula:function(t){var n,i,n=E,i=b;try{t.allowDynamicArray&&(R(h.SheetParserContext.wbt)&&(h.SheetParserContext.wbt=new g.Worksheet),(n=h.SheetParserContext.wbt).getCalcService())&&(i=n.getCalcService().allowDynamicArray,n.getCalcService().allowDynamicArray=!0),(0,h.formulaToExpression)(n,t.value)}catch(n){t.isInvalid=!0}finally{R(n)||R(i)||!n.getCalcService()||n.getCalcService().allowDynamicArray===i||(n.getCalcService().allowDynamicArray=i)}}})},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CalcEngine=n}();
;var GC;!function(){"use strict";var n,e,t;function i(t){var r,r,r=e[t];return void 0!==r||(r=e[t]={exports:{}},n[t].call(r.exports,r,r.exports,i)),r.exports}n={"./dist/plugins/conditional/conditional.entry.js":function(t,r,n){var e,i,e=this&&this.__createBinding||(Object.create?function(t,r,n,e){void 0===e&&(e=n);var i=Object.getOwnPropertyDescriptor(r,n);i&&("get"in i?r.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(t,e,i)}:function(t,r,n,e){t[e=void 0===e?n:e]=r[n]}),i=this&&this.__exportStar||function(t,r){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||e(r,t,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n("./dist/plugins/conditional/conditional.js"),r),i(n("./dist/plugins/conditional/conditional.ns.js"),r)},"./dist/plugins/conditional/conditional.js":function(O,b,t){var M,B,V,q,D,r,F,m,Y,G,L,W,j,P,U,o,p,K,C,k,Z,z,X,tt,rt,nt,et,it,ot,at,ut,ft,st,lt,t,ct,ht,vt,dt,T,yt,g,x,Ct,bt,pt,gt,St,wt,mt,kt,Tt,xt,_t,Nt,It,t,Rt,At,Et,Ot,Mt,Bt,Vt,$,qt,Dt,Ft,Gt,Lt,J,Wt,jt,Pt,Ut,$t,d,r,Jt,Qt,Ht,Yt,r,Kt,Zt,n,zt,_,Xt,tr,rr,nr,er,v,ir,or,ar,ur,fr,N,sr,I,lr,cr,hr,vr,dr,yr,y,Cr,l,c,h,br,pr,gr,Sr,wr,mr,kr,Tr,xr,_r,Nr,S,n,e,Ir,Rr,Ar,Er,w,e,Or,Mr,Br,e,Vr,qr,e,Dr,Fr,Gr,e,Lr,Wr,jr,Pr,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,Ur,n,n,e,$r,Jr,Qr,Hr,Yr;function Kr(t){return kt(Tt(t))}function Q(t){return t.rowCount}function H(t){return t.colCount}function Zr(t){return""===t.trim()}function zr(t){return""===t}function Xr(t){return T(t)?m.SheetArea.viewport:t}function tn(t,r,n,e){switch(e&&"string"==typeof r&&"string"==typeof n&&(r=r.toLowerCase(),n=n.toLowerCase()),t){case Xt.equalsTo:return r===n;case Xt.notEqualsTo:return r!==n;case Xt.greaterThan:return n<r;case Xt.greaterThanOrEqualsTo:return n<=r;case Xt.lessThan:return r<n;case Xt.lessThanOrEqualsTo:return r<=n;default:return!1}}function rn(t){return(null==t?void 0:t.fileType)===m.OpenSaveFileType.excel}function nn(t){var r,n,r={},n;return ot.YK(t,r)?r.value:typeof t===z&&t.toLowerCase()===X}function a(t,r){var n,e,n=(r=r||{}).formula;(e=this).offsetRow=0,e.offsetCol=0,e.conType("string"==typeof t?y[t]:t),T(r.compareType)||e.ZK(r.compareType),T(r.expected)||e.expected(r.expected),T(n)||e.formula("string"==typeof n?ct(p.trim(n),"="):n),T(r.item1)||e.item1(r.item1),T(r.item2)||e.item2(r.item2),T(r.customValueType)||e.customValueType(r.customValueType),T(r.type)||e.type(r.type),e.ranges(r.ranges),e.WK=C,e.QK=C}function en(t,r,n,e,i,o,a,u,f){var s=Math.round;switch(t.lineWidth=1,t.rect(o,a,u,f),n=s(++n),e=s(e),t.clip(),r.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:G.drawArrows(t,r.iconSetType,r.iconIndex,n,e,i);break;case 2:G.drawIconTypeIsTwo(t,r.iconSetType,r.iconIndex,n,e,i);break;case 3:G.drawStar(t,r.iconSetType,r.iconIndex,n,e,i);break;case 14:case 12:case 5:G.drawCircle(t,r.iconSetType,r.iconIndex,n,e,i);break;case 4:G.drawFlag(t,r.iconSetType,r.iconIndex,n,e,i);break;case 6:G.drawTrafficLight(t,r.iconSetType,r.iconIndex,n,e,i);break;case 7:G.drawIconTypeIsSen(t,r.iconSetType,r.iconIndex,n,e,i);break;case 8:G.drawIconTypeIsEight(t,r.iconSetType,r.iconIndex,n,e,i);break;case 9:G.drawIconTypeIsNine(t,r.iconSetType,r.iconIndex,n,e,i);break;case 18:G.drawSector(t,r.iconSetType,r.iconIndex,n,e,i);break;case 17:case 13:G.drawSignal(t,r.iconSetType,r.iconIndex,n,e,i);break;case 19:G.drawMagicCube(t,r.iconSetType,r.iconIndex,n,e,i)}}function on(t,r,n){var e,i,o,a,u,e=[],i=t.row,o=t.rowCount,a=t.col,u=t.col+t.colCount-1;return a<r?r<=u&&u<=n?(e[0]=$(i,a,o,r-a),e[1]=$(i,r,o,u-r+1)):n<u&&(e[0]=$(i,a,o,r-a),e[1]=$(i,r,o,n-r+1),e[2]=$(i,n+1,o,u-n)):a<=n&&(r<=u&&u<=n?e[1]=t:n<u&&(e[1]=$(i,a,o,n-a+1),e[2]=$(i,n+1,o,u-n))),e}function an(t,r,n){var e,i,o,a,u,e=[],i=t.col,o=t.colCount,a=t.row,u=t.row+t.rowCount-1;return a<r?r<=u&&u<=n?(e[0]=$(a,i,r-a,o),e[1]=$(r,i,u-r+1,o)):n<u&&(e[0]=$(a,i,r-a,o),e[1]=$(r,i,n-r+1,o),e[2]=$(n+1,i,u-n,o)):a<=n&&(r<=u&&u<=n?e[1]=t:n<u&&(e[1]=$(a,i,n-a+1,o),e[2]=$(n+1,i,u-n,o))),e}function i(t,r,n){var e=this;e.KK=!0,e.ruleType(t),e.style(r),e.ranges(n)}function un(t,r){return t===_.cellValueRule&&(r===nr.between||r===nr.notBetween)}function fn(t,r,n){var r,e,i,r;if(t&&r&&!(!(r=r[0])||r.row<0||r.col<0)){if(e=m.IndexHelper.nr(r.col)+(r.row+1),i="",i=r.rowCount===m.XmlConstants.Io?o("${0}:${1}",[m.IndexHelper.nr(r.col),m.IndexHelper.nr(r.col+r.colCount-1)]):r.colCount===m.XmlConstants.xo?o("${0}:${1}",[r.row+1,r.row+r.rowCount]):o("${0}${1}:${2}${3}",[m.IndexHelper.nr(r.col),r.row+1,m.IndexHelper.nr(r.col+r.colCount-1),r.row+r.rowCount]),r=_n(n),"top10"===t.type)return t.bottom?t.percent?o("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",[i,t.rank,e]):o("SMALL(({0}),MIN({1},COUNT({0})))>={2}",[i,t.rank,e]):t.percent?o("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",[i,t.rank,e]):o("LARGE(({0}),MIN({1},COUNT({0})))<={2}",[i,t.rank,e]);if("containsText"===t.type)return o('NOT(ISERROR(SEARCH("{0}",{1})))',[r,e]);if("notContainsText"===t.type)return o('ISERROR(SEARCH("{0}",{1}))',[r,e]);if("beginsWith"===t.type)return o('LEFT({0},{1}) = "{2}"',[e,n.length,r]);if("endsWith"===t.type)return o('RIGHT({0},{1}) = "{2}"',[e,n.length,r]);if("duplicateValues"===t.type)return o("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",[i,e]);if("uniqueValues"===t.type)return o("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",[i,e]);if("aboveAverage"===t.type||"belowAverage"===t.type||"aboveOrEqualToAverage"===t.type||"belowOrEqualToAverage"===t.type){if("aboveAverage"===t.type&&T(t.stdDev))return o("{0}>AVERAGE({1})",[e,i]);if(!T(t.aboveAverage)){if(!(T(t.equalAverage)||t.aboveAverage||T(t.equalAverage))&&t.equalAverage&&T(t.stdDev))return o("{0}<=AVERAGE({1})",[e,i]);if(!t.aboveAverage&&T(t.stdDev))return o("{0}<AVERAGE({1})",[e,i])}if(!T(t.equalAverage)&&t.equalAverage&&T(t.stdDev))return o("{0}>=AVERAGE({1})",[e,i]);if(!T(t.stdDev))return T(t.aboveAverage)||t.aboveAverage?o("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",[e,i,t.stdDev]):o("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",[e,i,t.stdDev])}}return null}function sn(t){return t&&t.font&&0===t.font.indexOf("normal normal")&&delete t.font,t}function u(t,r,n,e,i,o,a,u,f,s){var t,n,t=$r.call(this,t,n)||this,n=t;return n.ranges(r),n.operator(e),n.value1("string"==typeof i?p.trim(i):i),n.value2("string"==typeof o?p.trim(o):o),n.text(a),n.formula(u),n.type(f),n.rank(s),n.cached=!1,n.JK=C,t}function ln(t,r,n,e){var r,r,n,r=r.ranges(),r=Et(r),n=Y.formulaToExpression(t,n,r.r,r.c,e);return Y.expressionToFormula(t,n,r.r,r.c,!e)}function cn(t,r){this.type=t,this.value=r}function f(t,r,n,e,i,o,a,u,f,s,l){var t,l,r,n,e,i,o,a,u,f,s,t=Jr.call(this,t,C,l)||this,l=t;return l.KK=!1,l.lowestValueCached=C,l.highestValueCached=C,l.XK={},l.cached=!1,l.JK=C,r=r,n=n,e=e,i=i,o=o,a=a,u=u,f=f,s=s,arguments.length<=1&&(r=1,n=C,e=Vt(255,248,105,107),i=4,o=50,a=Vt(255,255,235,132),u=2,f=C,s=Vt(255,99,190,123)),l.minColor(e),l.minValue(n),l.minType(r),l.midColor(a),l.midValue(o),l.midType(i),l.maxColor(s),l.maxValue(f),l.maxType(u),t}function hn(t){return t.c_[0]&&t.c_[0].c_[0]&&t.c_[0].c_[0].c_[0]}function s(t,r,n,e,i,o){var a,t,r,n,e,i,a=this,t=t,r=r,n=n,e=e,i=i;return 0===arguments.length&&(t=5,n=7,e=r=C,i=Vt(255,99,142,198)),(a=Qr.call(this,12,t,r,C,C,C,C,n,e,C,o)||this).KK=!1,a.Hc(i),a}function vn(t,r,n){this.isGreaterThanOrEqualTo=t,this.iconValueType=r,this.iconValue=n}function R(t,r){var n,t,n=this,t=0===arguments.length?0:t;return(n=Hr.call(this,13,C,C,C)||this).KK=!1,n.ranges(r),n.Hc(t),n}function dn(t){return t="string"==typeof t&&"="!==t[0]?'="'+K.Vi(t,'"','""')+'"':t}function A(t,r,n,e){var t,e,t=Yr.call(this,t,k,e)||this,e=t;return e.style(n),e.state(r),t}function E(t){this.qK=[],this.$K=C,this.sE(),this.nJ=!0,this.eJ=t}function yn(t,r,n,e,i){var o,a,u,f;if(!$t(r))return r[t];for(o=tt(r.length,n.length),a=0;a<o;a++)if((u=n[a]).contains(e,i,1,1))return(f=r[a])[t]}function Cn(t,r){if(r)for(var n=0;n<r.length;n++)t.push(r[n])}function bn(t){for(var r,n,e,i,o,a,r=J(t),n=0;n<r;n++)if(i=(e=t[n]).ranges)for(o=0;o<i.length;o++)if(1e3<(a=i[o]).rowCount)return 1}function pn(t){for(var r,n,e,i,o,a,r=J(t),n=0;n<r;n++)if(i=(e=t[n]).ranges())for(o=0;o<i.length;o++)if(1e3<(a=i[o]).rowCount)return 1}function gn(t){for(var r,n,e,i,r=[],n=J(t),i=0;i<n;i++)e=t[i],r.push($(e.row,e.col,Q(e),H(e)));return r}function Sn(t,r){for(var n,e,n=0;n<t.length;n++)if((e=t[n])&&e.equals(r))return 1}function wn(t,r){for(var n,e,i,o,a,n=!0,e=!0,i=!0,o=r.iJ,a=0;a<o.length;a++)if(o[a].iconSetType!==t){n=!1;break}for(a=0;a<o.length;a++)if(o[a].iconIndex!==a){e=!1;break}for(a=0;a<o.length;a++)if(o[a].iconIndex!==o.length-1-a){i=!1;break}return!n||!e&&!i||!e&&!r.reverseIconOrder()}function mn(t){return!(!t.ruleType||t.ruleType()!==_.dataBarRule)}function kn(t){var r;if(t.ruleType()===_.iconSetRule)return 3===(r=t.iconSetType())||2===r||19===r||wn(r,t)}function Tn(t){return t.ruleType()===_.rowStateRule||t.ruleType()===_.columnStateRule}function xn(t){var r,n,e,r,n=/</g,e=/>/g;return"string"==typeof t?t.replace(/&/g,"&amp;").replace(n,"&lt;").replace(e,"&gt;"):T(t)?t:""+t}function _n(t){return"string"==typeof t?t.replace(/"/g,'""'):T(t)?t:""+t}function Nn(t){var t=t.c_&&t.c_[0];if(t)return gt(t,"cfvo")}function In(t){var t,t,t=t.c_&&t.c_[0];return t&&(t=gt(t,"color"))&&0<t.length?t.map(function(t){return wt(t)}):[]}function Rn(t,r,n){switch(t){case"cellIs":return Er[r];case"containsText":return er.contains;case"beginsWith":return er.beginsWith;case"endsWith":return er.endsWith;case"notContainsText":return er.doesNotContain;case"timePeriod":return N[n]}}function An(t,r,n){var e,i,o;switch(t){case _.cellValueRule:return e={type:"cellIs"},T(n)||(e.operator=Er[n]),e;case _.specificTextRule:return i="containsText",o="contains",2===n?o=i="beginsWith":3===n?o=i="endsWith":1===n?(i="notContainsText",o="notContains"):0===n&&(o="containsText"),e={type:i,operator:o};case _.formulaRule:return e={type:"expression"},T(n)||(e.operator=n),e;case _.dateOccurringRule:return e={type:"timePeriod"},T(r)||(e.timePeriod=Ar[r]),e;case _.top10Rule:return e={type:"top10"},T(n)||(e.operator=n),e;case _.uniqueRule:return e={type:"uniqueValues"},T(n)||(e.operator=n),e;case _.duplicateRule:return e={type:"duplicateValues"},T(n)||(e.operator=n),e;case _.averageRule:return e={type:"aboveAverage"},T(n)||(e.operator=n),e;case _.twoScaleRule:return e={type:"colorScale"},T(n)||(e.operator=n),e;default:return}}function En(t){var r;return{num:0,min:1,max:2,percent:3,percentile:4,formula:6,autoMin:5,autoMax:7}[t]}function On(t){var r;return{0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"}[t]}function Mn(t){var r;return{"3Arrows":0,"3ArrowsGray":1,"3Flags":4,"3TrafficLights1":5,"3TrafficLights2":6,"3Signs":7,"3Symbols":8,"3Symbols2":9,"4Arrows":10,"4ArrowsGray":11,"4RedToBlack":12,"4Rating":13,"4TrafficLights":14,"5Arrows":15,"5ArrowsGray":16,"5Rating":17,"5Quarters":18,"3Stars":3,"3Triangles":2,"5Boxes":19,NoIcons:20}[t]}function Bn(t){var r;return{0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"}[t]}function Vn(t){var r,t,r,t={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8}[t];return t!==k?t:1}function qn(t){var r;return{1:"num",4:"percent",5:"percentile",7:"formula"}[t]}function Dn(t){var r;return{num:1,percent:4,percentile:5,formula:7}[t]}function Fn(t){return"lowestValue"===t||"highestValue"===t}function Gn(t){return"string"==typeof(t=Tt(t))&&"="!==t.charAt(0)?"="+t:t}function Ln(t,r){for(var n,e,i,n=0,e=t.length;n<e;n++)if(i=t[n].rJ,!T(i)&&i===r)return t[n]}function Wn(t,r){var n;return T(t.val)?T(r)||(n=U(Tt(r.c_&&r.c_[0]))):n=t.val,n}function jn(t,r,n){for(var e,i,o,e=0,i=t;e<i.length;e++)if((o=i[e]).rule===n)return void(Sn(o.ranges,r)||o.ranges.push(r));t.push({rule:n,ranges:[r]})}function Pn(t,r,n){for(var e,i,o,e=0,i=t;e<i.length;e++)if((o=i[e]).rule===r)return void(o.rule=n)}function Un(t,r,n){for(var e,i,o,e=0,i=t;e<i.length;e++)if((o=i[e]).rule===n&&Sn(o.ranges,r))return 1}function $n(t,r){if(10===t){if(3===r)return{iconSetType:0,iconIndex:2};if(0===r)return{iconSetType:0,iconIndex:0}}else if(15===t){if(4===r)return{iconSetType:0,iconIndex:2};if(0===r)return{iconSetType:0,iconIndex:0};if(2===r)return{iconSetType:0,iconIndex:1};if(3===r)return{iconSetType:10,iconIndex:2};if(1===r)return{iconSetType:10,iconIndex:1}}else if(11===t){if(3===r)return{iconSetType:1,iconIndex:2};if(0===r)return{iconSetType:1,iconIndex:0}}else if(16===t){if(4===r)return{iconSetType:1,iconIndex:2};if(0===r)return{iconSetType:1,iconIndex:0};if(2===r)return{iconSetType:1,iconIndex:1};if(3===r)return{iconSetType:11,iconIndex:2};if(1===r)return{iconSetType:11,iconIndex:1}}else if(14===t){if(3===r)return{iconSetType:5,iconIndex:2};if(2===r)return{iconSetType:5,iconIndex:1};if(1===r)return{iconSetType:5,iconIndex:0}}else if(13===t){if(0===r)return{iconSetType:17,iconIndex:1};if(1===r)return{iconSetType:17,iconIndex:2};if(2===r)return{iconSetType:17,iconIndex:3};if(3===r)return{iconSetType:17,iconIndex:4}}return{iconSetType:t,iconIndex:r}}M=this&&this.__extends||(Pr=function(t,r){return(Pr=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,r){t.__proto__=r}:function(t,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}))(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}Pr(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),B=this&&this.__spreadArray||function(t,r,n){if(n||2===arguments.length)for(var e=0,i=r.length,o;e<i;e++)!o&&e in r||((o=o||Array.prototype.slice.call(r,0,e))[e]=r[e]);return t.concat(o||Array.prototype.slice.call(r))},Object.defineProperty(b,"__esModule",{value:!0}),b.ConditionalFormats=b.StateRule=b.IconSetRule=b.IconCriterion=b.DataBarRule=b.ScaleRule=b.ScaleValue=b.NormalConditionRule=b.ConditionRuleBase=b.Condition=b.oJ=b.aJ=b.ConditionType=b.IconValueType=b.IconSetType=b.DataBarAxisPosition=b.BarDirection=b.ScaleValueType=b.AverageConditionType=b.QuarterType=b.DateOccurringType=b.Top10ConditionType=b.DateExConditionExpectType=b.DateCompareType=b.CustomValueType=b.ColorCompareType=b.TextCompareType=b.TextComparisonOperators=b.ComparisonOperators=b.LogicalOperators=b.GeneralComparisonOperators=b.RuleType=void 0,V=t("Common"),q=t("Core"),D=t("CalcEngine"),r=t("./dist/plugins/conditional/conditional.ns.js"),F=t("CalcEngine"),m=t("Core"),Y=t("SheetsCalc"),G=t("./dist/plugins/conditional/conditionalFormatIcon.js"),L=m.UsedRangeUtil.vh,W=m.UsedRangeUtil.hh,j=m.XFileConstants.Au,P=m.XFileConstants.ju,U=m.Util.mr,o=V.Common.zf.I5,p=q.GC$,K=V.Common.zf,C=null,k=void 0,Z="undefined",z="string",X="true",tt=Math.min,rt=Math.max,nt=Math.abs,et=Math.floor,it=Math.ceil,ot=D.Convert,at=ot.q8,ut=ot.uJ,ft=ot.sJ,st=String.fromCharCode(32),lt=String.fromCharCode(160),t=V.Common.zf,ct=t.cJ,ht=t.fJ,vt=t.dT,dt=t.OS,T=V.Common.lt.ht,yt=V.Common.$T,g=V.Common.ut,x=q.mt,Ct=x.t1,bt=m.mt.getFormulaString,pt=x.vo,gt=x.go,St=x.h1,wt=x.d1,mt=x.xr,kt=x.g1,Tt=x.n1,xt=x.Hue,_t=x.c1,Nt=m.range_parser.Dc,It=m.range_parser.getRangeString,t=q.$e,Rt=x.G0,At=x.C1,Et=x.z0,Ot=!!D,Mt=q.Style,Bt=V.Common.ft,Vt=Bt.j,$=q.Ec,qt=q.Range,Dt=V.Common.ct,Ft=V.Common.Uf,Gt=Ft.VP,Lt=Ft.hD,J=Ft.tR,Wt=D.Functions,jt=D.evaluateOperator,Pt=q.Pf,Ut=m.Util.no,$t=Array.isArray,d=m.NodeHelper.ur,r=new V.Common.ResourceManager(r.SR,"ConditionalFormatting"),Jt=r.getResource.bind(r),Qt=function(t){return/[\f\n\r\t\v]/.test(t)},Ht=function(t){var r,n,r=t.row<0?Y.BAND_INDEX_CONST:t.row,n=t.col<0?Y.BAND_INDEX_CONST:t.col;return(0,F.lJ)(C,C,r,n,r+t.rowCount-1,n+t.colCount-1)},Yt=function(t){var r;if(t instanceof D.Expression)r=t;else if(t instanceof qt)r=Ht(t);else{if(!at(t))throw Jt().Exp_NotSupport;t=ut(t),isNaN(t)||((r=new D.Expression(2)).value=t)}return r},r=function(t,r,o,a){var u,f,t,u=t,f=r,t=function(t,r){var n,e,i,n=this;return n.hasOwnProperty("_ps")||(n._ps={}),e=n._ps,0===arguments.length?e[u]!==k?a?a.call(n,e[u]):e[u]:f:(e[u]!==t&&(i=e[u]!==k?e[u]:f,e[u]=t,!1!==r)&&o&&o.call(n,t,i),n)};return t.isDefault=function(t){return t===f},t},Kt=function(o,t,a){var u=this;return a=a||{},t=t||u,T(u.pivotTableName)||(a.pivot=!0),p.each(t,function(t,r){var n,e,i,n=u[r];T(n)||(e=n.call(u),"formula"===r?(u.getFormulaString?e=u.getFormulaString(o,k,k,!0):u.condition()&&u.condition().getFormulaString&&(e=u.condition().getFormulaString(o,k,k,!0)),e&&(a[r]=e)):"style"===r&&$t(e)?(i=e.map(function(t){return t.toJSON()}),a[r]=i):"iconCriteria"===r||"icons"===r?a[r]=e:Dt.W0(e)?a[r]=Dt.Q0(e):e&&e.toJSON?a[r]=e.toJSON(o):T(e)||n.isDefault(e)||(a[r]=e))}),a},Zt=function(h,t,v,d){var y,C;v&&(y=this,p.each(t=t||y,function(t,r){var n,e,i,o,a,u,f,s,l,c,o;if(C=v[r],!T(C))if("ranges"===r){for(n=[],e=0;e<C.length;e++)i=C[e],n.push($(i.row,i.col,Q(i),H(i)));y.ranges(n,!1)}else if("style"===r)$t(C)?(o=C.map(function(t){var r=new Mt;return r.fromJSON(t,d),r}),y.style(o)):(y.style(new Mt,!1),y.style().fromJSON(C,d));else if("iconCriteria"===r)for(a=C.length,u=0;u<a;u++)f=C[u],y.hJ[u]=new Dr(f.isGreaterThanOrEqualTo,f.iconValueType,f.iconValue);else if("icons"===r)for(s=C.length,l=0;l<s;l++)c=C[l],y.iJ[l]={iconSetType:c.iconSetType,iconIndex:c.iconIndex};else"iconSetType"===r?y[r](C,!0):"item1"===r||"item2"===r?(y[r]((0,b.aJ)(),!1),y[r]().fromJSON(C,h)):"expected"===r?p.getType(C)!==z||5!==v.conType&&13!==v.conType?y[r](C,!1):"/OADate("===C.substr(0,8)?y[r](Dt.dJ(C),!1):y[r](new Date(C)):"condition"===r?((o=new S).fromJSON(C,h),y.condition(o,!1)):p.getType(C)===z&&"/OADate("===C.substr(0,8)?y[r](Dt.dJ(C),!1):y[r](C,!1)}))},n=q.Y8,p.extend(n.prototype,{vJ:function(t){var r,n,r,r=this,n=r.G8;!n||!t&&n.originalConditionalRules||(r=r.mJ.qK.map(function(t){return{rule:t,ranges:t.ranges().slice()}}),t?n.currentConditionalRules=r:n.originalConditionalRules=r)},gJ:function(t){var e=this.mJ,i=this.Mf;i.suspendPaint(),t&&(0===t.length&&e.qK&&1===e.qK.length&&e.constructor.et(i,"onRuleUpdated",{ranges:e.qK[0].ranges()}),e.qK=t.map(function(t){var r,n,r=t.rule,n=t.ranges;return"Object"===r.constructor.name&&(r=e.pJ(t.rule,i,!1),n=n.map(function(t){return new qt(t.row,t.col,t.rowCount,t.colCount)})),r.ranges(n),e.constructor.et(i,"onRuleUpdated",{ranges:r.ranges()}),r}),e.C8()),i.resumePaint()},bJ:function(t,r,n){this.vJ();var e=n.affectRanges,i=n.isFromTable,n=n.ignoreExpand;this.mJ.JO(t,r,e,i,n),this.vJ(!0)},yJ:function(t,r,n,e){this.vJ(),this.mJ.xP(t,r,n,e),this.vJ(!0)},wJ:function(t,r,n){this.vJ();var e=n.affectRanges,i=n.isFromTable,n=n.ignoreExpand;this.mJ.qO(t,r,e,i,n),this.vJ(!0)},MJ:function(t,r,n,e){this.vJ(),this.mJ.NP(t,r,n,e),this.vJ(!0)},CJ:function(){this.vJ(),this.mJ.dl(),this.vJ(!0)},SJ:function(){this.vJ(),this.mJ.C8()}}),n.ch("conditionalFormat",{init:function(){this.mJ=new jr(this.Mf)},applyChanges:function(t){var r,t,t,r=t.changes,t=t.isUndo;r&&(t=t?r.originalConditionalRules:r.currentConditionalRules)&&this.gJ(t)},undo:function(t){var t=t.originalConditionalRules;t&&this.gJ(t)},dispose:function(t){var r=this,n;!1!==(t&&t.clearCache)&&r.mJ&&(r.mJ.L0(),r.mJ=C)}}),q.Worksheet.ch("conditionalFormat",zt={init:function(){this.conditionalFormats=this.Ut.mJ},getUsedRange:function(t){var r,n,e;t.type&m.UsedRangeType.conditionFormat&&(e=(n=(r=this).conditionalFormats).getUsedRange(),L(t.range,e))},dispose:function(t){var t;!1!==t.clearCache&&(t=this.conditionalFormats)&&t.TJ()},onLayoutChanged:function(t){var r,n,e,i,o,a,u,t,f,s,r=t.changeType,n=t.row,e=Q(t),i=t.col,o=H(t),a=t.sheetArea,u=T(a)||a===m.SheetArea.viewport,t=t.ignoreExpand,f=this.Ut,s=this.tables;"addRows"===r&&u?f.bJ(n,e,{affectRanges:s&&s.AJ(n,-1,e,-1,!0),isFromTable:!1,ignoreExpand:t}):"deleteRows"===r&&u?f.yJ(n,e):"addColumns"===r&&u?f.wJ(i,o,{ignoreExpand:t}):"deleteColumns"===r&&u?f.MJ(i,o):"clear"===r?f.CJ():"setColumnCount"!==r&&"setRowCount"!==r||3!==a&&1!==a||f.SJ()},toJson:function(t,r){var n,r,n=this.conditionalFormats,r=r&&r.ignoreStyle;n&&!r&&(t.conditionalFormats=n.toJSON(this))},fromJson:function(t,r,n){var n=n&&n.ignoreStyle;t&&t.conditionalFormats&&!n&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,r,!0)},wh:function(t,r,n){var e,i,o,a,u,f,s,l,c,h,v,d,y,C,b,C,i,p,e=this,i=n&&!1===n.includeStyles,o=e.conditionalFormats;if(!i&&o&&Y&&!e.NMi&&(a=o.qK)&&0<a.length){for(u=r.styleManager,f=t.c_,s=[],h=c=l=void 0,v=0,d=a.length;v<d;v++)C=(y=a[v]).ruleType(),b=!0,kn(y)||mn(y)?(s.push(y.IJ()),kn(y)&&(b=!1)):C===_.formulaRule&&x.e1(y.D5,e.name(),e.parent&&e.parent.r4())&&(l||(c=new m.SimpleSharedStrings,h=new m.SimpleSharedStrings,l=new m.SharedDxfs(c,h)),s.push(y.IJ(l)),b=!1),Tn(y)?(t.lossless||(t.lossless={}),t.lossless.stateRules||(t.lossless.stateRules=[]),t.lossless.stateRules.push(y.toJSON())):b&&(C=y.wh(u,void 0,void 0,n,e))&&(C.lossless?(t.lossless.dateOccurringRules||(t.lossless.dateOccurringRules=[]),t.lossless.dateOccurringRules.push(C.lossless)):f.push(C));0<s.length&&((i=mt(t,j)).c_.push(p={n_:"ext",r_:[1,3],c_:[{n_:"conditionalFormattings",c_:s}]}),l)&&(i.lossless={sharedDxfs:l.iv(),sharedColors:c.wh(),commonSharedStrings:h.wh()})}},yh:function(t,i,o){var a,r,u,f,s,r,n,e,l,c,a=this,r=o&&!1===o.includeStyles,u=this.conditionalFormats,f=u.qK,s=m.Util.Co(o);if(Y&&u&&!r){for(r=gt(t,P),n=mt(t,j),e=xt(n,"conditionalFormattings"),l=i.styleManager,r&&0<r.length&&r.forEach(function(t){var n,e,r,n=m.NodeHelper.ur(t.pivot),e=Nt(t.sqref);s&&m.Util.Ao(a,e,!0,i),(r=t.c_).forEach(function(t){var r,r,r=e.map(function(t){return new qt(t.row,t.col,t.rowCount,t.colCount)}),r=u.xJ(t,r,l,a,o);r&&(r.pivot=n,T(t.priority)||r.priority(+t.priority),f.push(r))})}),u.NJ(e,i,a,f,n,s),c=f.length-1;-1<c;c--)f[c].pivot&&f.splice(c,1);t.lossless&&t.lossless.stateRules&&0<t.lossless.stateRules.length&&t.lossless.stateRules.forEach(function(t){var r=new Wr;r.fromJSON(t,a),u.qK.push(r)}),t.lossless&&t.lossless.dateOccurringRules&&0<t.lossless.dateOccurringRules.length&&t.lossless.dateOccurringRules.forEach(function(t){var r=new w;r.fromJSON(t,a),u.qK.push(r)}),u.nJ=!pn(u.qK),u.C8()}}}),q.Workbook.ch("conditionalFormat",{fromJson:function(t,r,n){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},yh:function(t,r,n){this.sheets.forEach(function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach(function(t){t.kJ()})})},onCultureChanged:function(){Jt()}}),(n=_=b.RuleType||(b.RuleType={}))[n.conditionRuleBase=0]="conditionRuleBase",n[n.cellValueRule=1]="cellValueRule",n[n.specificTextRule=2]="specificTextRule",n[n.formulaRule=3]="formulaRule",n[n.dateOccurringRule=4]="dateOccurringRule",n[n.top10Rule=5]="top10Rule",n[n.uniqueRule=6]="uniqueRule",n[n.duplicateRule=7]="duplicateRule",n[n.averageRule=8]="averageRule",n[n.twoScaleRule=10]="twoScaleRule",n[n.threeScaleRule=11]="threeScaleRule",n[n.dataBarRule=12]="dataBarRule",n[n.iconSetRule=13]="iconSetRule",n[n.rowStateRule=14]="rowStateRule",n[n.columnStateRule=15]="columnStateRule",(n=Xt=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.greaterThan=2]="greaterThan",n[n.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",n[n.lessThan=4]="lessThan",n[n.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",tr=[9,10,13,14,11,12],(n=rr=b.LogicalOperators||(b.LogicalOperators={}))[n.or=0]="or",n[n.and=1]="and",(n=nr=b.ComparisonOperators||(b.ComparisonOperators={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.greaterThan=2]="greaterThan",n[n.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",n[n.lessThan=4]="lessThan",n[n.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",n[n.between=6]="between",n[n.notBetween=7]="notBetween",(n=er=b.TextComparisonOperators||(b.TextComparisonOperators={}))[n.contains=0]="contains",n[n.doesNotContain=1]="doesNotContain",n[n.beginsWith=2]="beginsWith",n[n.endsWith=3]="endsWith",(n=v=b.TextCompareType||(b.TextCompareType={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.beginsWith=2]="beginsWith",n[n.doesNotBeginWith=3]="doesNotBeginWith",n[n.endsWith=4]="endsWith",n[n.doesNotEndWith=5]="doesNotEndWith",n[n.contains=6]="contains",n[n.doesNotContain=7]="doesNotContain",(n=ir=b.ColorCompareType||(b.ColorCompareType={}))[n.backgroundColor=0]="backgroundColor",n[n.foregroundColor=1]="foregroundColor",(n=or=b.CustomValueType||(b.CustomValueType={}))[n.empty=0]="empty",n[n.nonEmpty=1]="nonEmpty",n[n.error=2]="error",n[n.nonError=3]="nonError",n[n.formula=4]="formula",(n=ar=b.DateCompareType||(b.DateCompareType={}))[n.equalsTo=0]="equalsTo",n[n.notEqualsTo=1]="notEqualsTo",n[n.before=2]="before",n[n.beforeEqualsTo=3]="beforeEqualsTo",n[n.after=4]="after",n[n.afterEqualsTo=5]="afterEqualsTo",(n=ur=b.DateExConditionExpectType||(b.DateExConditionExpectType={}))[n.dateOccurring=0]="dateOccurring",n[n.yearOccurring=1]="yearOccurring",n[n.quarterOccurring=2]="quarterOccurring",n[n.monthOccurring=3]="monthOccurring",n[n.weekOccurring=4]="weekOccurring",n[n.dayOccurring=5]="dayOccurring",n[n.yearToDate=6]="yearToDate",(n=fr=b.Top10ConditionType||(b.Top10ConditionType={}))[n.top=0]="top",n[n.bottom=1]="bottom",(n=N=b.DateOccurringType||(b.DateOccurringType={}))[n.today=0]="today",n[n.yesterday=1]="yesterday",n[n.tomorrow=2]="tomorrow",n[n.last7Days=3]="last7Days",n[n.thisMonth=4]="thisMonth",n[n.lastMonth=5]="lastMonth",n[n.nextMonth=6]="nextMonth",n[n.thisWeek=7]="thisWeek",n[n.lastWeek=8]="lastWeek",n[n.nextWeek=9]="nextWeek",n[n.nextQuarter=10]="nextQuarter",n[n.thisQuarter=11]="thisQuarter",n[n.lastQuarter=12]="lastQuarter",n[n.nextYear=13]="nextYear",n[n.thisYear=14]="thisYear",n[n.lastYear=15]="lastYear",(n=sr=b.QuarterType||(b.QuarterType={}))[n.quarter1=0]="quarter1",n[n.quarter2=1]="quarter2",n[n.quarter3=2]="quarter3",n[n.quarter4=3]="quarter4",(n=I=b.AverageConditionType||(b.AverageConditionType={}))[n.above=0]="above",n[n.below=1]="below",n[n.equalOrAbove=2]="equalOrAbove",n[n.equalOrBelow=3]="equalOrBelow",n[n.above1StdDev=4]="above1StdDev",n[n.below1StdDev=5]="below1StdDev",n[n.above2StdDev=6]="above2StdDev",n[n.below2StdDev=7]="below2StdDev",n[n.above3StdDev=8]="above3StdDev",n[n.below3StdDev=9]="below3StdDev",(n=lr=b.ScaleValueType||(b.ScaleValueType={}))[n.number=0]="number",n[n.lowestValue=1]="lowestValue",n[n.highestValue=2]="highestValue",n[n.percent=3]="percent",n[n.percentile=4]="percentile",n[n.automin=5]="automin",n[n.formula=6]="formula",n[n.automax=7]="automax",(n=cr=b.BarDirection||(b.BarDirection={}))[n.leftToRight=0]="leftToRight",n[n.rightToLeft=1]="rightToLeft",(n=hr=b.DataBarAxisPosition||(b.DataBarAxisPosition={}))[n.automatic=0]="automatic",n[n.cellMidPoint=1]="cellMidPoint",n[n.none=2]="none",(n=vr=b.IconSetType||(b.IconSetType={}))[n.threeArrowsColored=0]="threeArrowsColored",n[n.threeArrowsGray=1]="threeArrowsGray",n[n.threeTriangles=2]="threeTriangles",n[n.threeStars=3]="threeStars",n[n.threeFlags=4]="threeFlags",n[n.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",n[n.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",n[n.threeSigns=7]="threeSigns",n[n.threeSymbolsCircled=8]="threeSymbolsCircled",n[n.threeSymbolsUncircled=9]="threeSymbolsUncircled",n[n.fourArrowsColored=10]="fourArrowsColored",n[n.fourArrowsGray=11]="fourArrowsGray",n[n.fourRedToBlack=12]="fourRedToBlack",n[n.fourRatings=13]="fourRatings",n[n.fourTrafficLights=14]="fourTrafficLights",n[n.fiveArrowsColored=15]="fiveArrowsColored",n[n.fiveArrowsGray=16]="fiveArrowsGray",n[n.fiveRatings=17]="fiveRatings",n[n.fiveQuarters=18]="fiveQuarters",n[n.fiveBoxes=19]="fiveBoxes",n[n.noIcons=20]="noIcons",(n=dr=b.IconValueType||(b.IconValueType={}))[n.number=1]="number",n[n.percent=4]="percent",n[n.formula=7]="formula",n[n.percentile=5]="percentile",Ur=yr=yr||{},yr[yr.contains=0]="contains",(n=y=b.ConditionType||(b.ConditionType={}))[n.relationCondition=0]="relationCondition",n[n.numberCondition=1]="numberCondition",n[n.textCondition=2]="textCondition",n[n.colorCondition=3]="colorCondition",n[n.formulaCondition=4]="formulaCondition",n[n.dateCondition=5]="dateCondition",n[n.dateExCondition=6]="dateExCondition",n[n.textLengthCondition=7]="textLengthCondition",n[n.top10Condition=8]="top10Condition",n[n.uniqueCondition=9]="uniqueCondition",n[n.averageCondition=10]="averageCondition",n[n.cellValueCondition=11]="cellValueCondition",n[n.areaCondition=12]="areaCondition",n[n.timeCondition=13]="timeCondition",n[n.stateCondition=14]="stateCondition",(n=Cr=Cr||{})[n.automatic=0]="automatic",n[n.middle=1]="middle",n[n.none=2]="none",l=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},c=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},h=function(t,r){t.setDate(r)},br=function(t){return t.getDate()},pr=function(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()},gr=function(t,r){var n;return c(t)<r},Sr=function(t,r){return t<r},wr=function(t,r){var n;return r<l(t)},mr=function(t,r){return r<t},kr=function(t,r){return t.getHours()===r.getHours()&&t.getMinutes()===r.getMinutes()&&t.getSeconds()===r.getSeconds()&&t.getMilliseconds()===r.getMilliseconds()},Tr=function(t,r){var n,e,n,e;return new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())<new Date(1899,11,30,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())},xr=function(t,r){return!Tr(t,r)&&!kr(t,r)},b.aJ=_r=function(t,r,n,e,i,o,a,u,f){return new S(t,{compareType:r,expected:n,formula:e,customValueType:i,type:o,ranges:a,item1:u,item2:f})},b.oJ=new Mt,Nr=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],a.prototype.context=function(t){var r,n;return 1===arguments.length&&(this.DJ=t,r=this.item1(),n=this.item2(),r&&r.context&&r.context(t),n)&&n.context&&n.context(t),this.DJ},a.prototype.U0=function(t){var r=this,n=r.item1(),e=r.item2();t?r.G3=!0:r._J=!0,n&&n.U0(t),e&&e.U0(t)},a.prototype.H0=function(){var t=this,r=t.item1(),n=t.item2();delete t.G3,delete t._J,r&&r.H0(),n&&n.H0()},a.prototype.initExpression=function(t,r,n){var e,i,e,i,i,t,o,i,e=this.item1(),i=this.item2();e&&e.initExpression&&e.initExpression(),i&&i.initExpression&&i.initExpression(),t=t||this.DJ,e=this.D5,t&&e&&!this.WK&&(n=this.ranges()?(r=(i=Et(this.ranges())).r,i.c):(r=r||0,n||0),i=t.getCalcService(),t=t.Uw(),i)&&t&&(o=!1,this.G3&&(o=!this._J),this.WK=i.parse(t,e,r,n,!1,!0,o),i={expr:this.WK,baseRow:r,baseCol:n},a.et(t.getSheet(),"initConditionExpression",i))},a.prototype.expression=function(t,r,n,e){var i,i,o;return 1===arguments.length?(this.WK=t,r=r||this.DJ,t?r&&(e=this.ranges()?(n=(i=Et(this.ranges())).r,i.c):(n=n||0,e||0),i=r.getCalcService(),o=r.Uw(),i)&&o&&(this.D5=i.unparse(o,t,n,e)):this.D5=t):this.WK||this.initExpression(r,n,e),this.WK},a.prototype.getFormulaString=function(t,r,n,e){var i,o,a;return t=t||this.DJ,i=this.WK,o=this.D5,!t||!o||(i||(this.initExpression(t,r,n),i=this.WK),o&&(i.value&&14===i.value.type||i.value2&&14===i.value2.type))?o:(a=Et(this.ranges()),r=T(r)?a.r:r,n=T(n)?a.c:n,t.getCalcService().unparse(t.Uw(),i,r,n,k,!!e))},a.prototype.formula=function(t,r,n){var e,i;if("string"!=typeof t)return e=this.item1(),i=this.item2(),0===n&&e&&e.formula?e.formula(t,r,n):1===n&&i&&i.formula?i.formula(t,r,n):this.getFormulaString(k,t,r);this.D5=t,this.WK=C},a.prototype.adjustOffset=function(t,r){var n,e,n=this,e=n.item1();e&&e.adjustOffset&&e.adjustOffset(t,r),(e=n.item2())&&e.adjustOffset&&e.adjustOffset(t,r),n.offsetRow=t,n.offsetCol=r},a.prototype.relationConditionEvaluate=function(e,i,o,n,t){var a,r,t,u,f;function s(t,r){var n;return e&&t&&3===t.conType()&&(n=e.getActualStyle(i,o,3,!0))&&(0===t.ZK()?r=n.backColor:1===t.ZK()&&(r=n.foreColor)),r}function l(t,r){if(t)return t.ignoreBlank(a.ignoreBlank()),arguments.length<5?s(t,n):r}function c(t,r){return!T(t)&&t.evaluate(e,i,o,r)}return r=l((a=this).item1(),n),t=l(a.item2(),t),(u=c(a.item1(),r)?1:0)+(f=c(a.item2(),t)?1:0)>a.ZK()},a.prototype.cellValueConditionEvaluate=function(t,r,n,e){var r=this.getExpected(t,r,n);return!(r!==C||!t||!t.EJ)||this.cellValueConditionCheckCondition(r,e)},a.prototype.cellValueConditionCheckCondition=function(t,r){var n,e,i,o,a,u,n,f,n=this,e=0,i=!1,o=n.ZK();if(T(r)&&T(t))switch(o){case Xt.equalsTo:case Xt.greaterThanOrEqualsTo:case Xt.lessThanOrEqualsTo:return!0;case Xt.notEqualsTo:case Xt.greaterThan:case Xt.lessThan:default:return!1}if(a=tr[o],D.ExcelCompatibleCalcMode)return jt(a,r,t);if("boolean"==typeof t||"boolean"==typeof r)return tn(o,r,t);if(u={},T(r))n.treatNullValueAsZero()?i=!0:e=r;else{if(typeof r===z&&"number"==typeof t)return tn(o,1,0);"boolean"!=typeof r&&ft(r,u)&&(e=u.value,i=!isNaN(e))}return n=0,f=!1,("number"==typeof t||t&&"string"==typeof t&&!Zr(t))&&ft(t,u)&&(n=u.value,f=!0),i?f?tn(o,e,n):jt(a,r,t):"string"==typeof r?f?jt(a,r,n):"string"==typeof t?jt(a,r,t):1===o:!!T(r)&&o===Xt.notEqualsTo},a.prototype.numberConditionEvaluate=function(t,r,n,e){var r=this.numberConditionGetExpected(t,r,n);return!(r!==C||!t||!t.EJ)||(this.integerValue()&&(r=isNaN(r)?C:(0<r?et:it)(r)),this.numberConditionCheckCondition(r,e))},a.prototype.numberConditionCheckCondition=function(t,r){var n,e,i,n=this;if((T(r)||""===r)&&n.ignoreBlank())return!0;if(T(t)){if(n.ignoreBlank())return!0;t=0}try{e=T(r)?0:"string"==typeof r?m.mt.Xf(C,r,!0):parseFloat(r)}catch(t){return!1}return"number"==typeof e&&(!n.integerValue()||(i=e-et(e)==0))&&tn(n.ZK(),e,t)},a.prototype.numberConditionGetExpected=function(t,r,n){var e,i,e=this;return e.D5&&0<e.D5.length&&(i=t.op())?i.evaluate(t.Uw(),e.expression(C,t),r,n):e.expected()},a.prototype.textConditionEvaluate=function(t,r,n,e){var i,o,a,u,t,f;function s(t,r){return i.testTextByCondition(r,t,"^","$",function(){return a?t.toLowerCase()===r.toLowerCase():t===r})}function l(t,r){return i.testTextByCondition(r,t,"^","",function(){return ht(r,t,a)})}function c(t,r){return i.testTextByCondition(r,t,"","$",function(){return vt(r,t,a)})}function h(t,r){return i.testTextByCondition(r,t,"","",function(){return dt(r,t===k||t===C?"":t,a)})}if(o=(i=this).compareType(),a=i.ignoreCase(),!i.forceValue2Text()&&g(e,Date))return o!==v.beginsWith&&o!==v.endsWith&&o!==v.contains&&(o===v.doesNotBeginWith||o===v.doesNotEndWith||o===v.doesNotContain);if(u=T(e)?"":e.toString(),i.ignoreBlank()&&""===u)return!0;if(t=this.getExpected(t,r,n),f=T(t)?"":t.toString(),i.hasWildcard(f)&&"number"==typeof e)return o===v.doesNotBeginWith||o===v.doesNotContain||o===v.doesNotEndWith||o===v.notEqualsTo;switch(o){case v.equalsTo:return s(f,u);case v.notEqualsTo:return!s(f,u);case v.beginsWith:return l(f,u);case v.doesNotBeginWith:return!l(f,u);case v.endsWith:return c(f,u);case v.doesNotEndWith:return!c(f,u);case v.contains:return h(f,u);case v.doesNotContain:return!h(f,u);default:return!1}},a.prototype.hasWildcard=function(t){return-1<t.indexOf("*")||-1<t.indexOf("?")},a.prototype.testTextByCondition=function(t,r,n,e,i){var o,r,o;return this.useWildCards()?this.regex()?yt.qT(this.regex()).test(t):(r=yt.jJ(r))?(r=n+r+e,(this.ignoreCase()?yt.OJ(r):yt.qT(r)).test(t)):i():i()},a.prototype.colorConditionEvaluate=function(t,r,n,e){var i,o,e,t;function a(t){return T(t)||""===t?C:Bt._(t)}if(o=a((i=this).expected()),T(o)||""===o){if(i.ignoreBlank()||T(o)&&T(e))return!0}else if(e=a(e),(T(e)||""===e)&&t&&t.getDefaultStyle&&(t=t.getDefaultStyle(),i.ZK()===ir.backgroundColor?e=t.backColor:i.ZK()===ir.foregroundColor&&(e=t.foreColor)),!T(e)&&""!==e)return V.Common.ft.Tv(e,o);return!1},a.prototype.formulaConditionEvaluate=function(t,r,n,e){var i,o,o,a;if(!Ot)return!1;if((i=this).customValueType()===or.formula)return(o=i.DJ&&i.DJ.getDataSource&&i.DJ.getDataSource())&&o.RJ&&(t.Uw().DJ=o.RJ(r)),o=i.getExpected(t,r,n),!(!i.ignoreBlank()||!T(o)&&""!==o)||(!D.ExcelCompatibleCalcMode||"0"!==o)&&nn(o);switch(a=ot.BJ,i.customValueType()){case or.empty:return T(e)||""===e;case or.nonEmpty:return!T(e)&&""!==e;case or.error:return a(e);case or.nonError:return!a(e);default:return!1}},a.prototype.formulaConditionGetExpected=function(t,r,n){var e,i,o,a,u,f,s,l,c,e=this;if(e.D5&&0<e.D5.length){if(!(i=t.op()))return e.expected();if(o=t.Uw(),a=i.evaluateParsedFormula(o,e.expression(k,t),(0,F.eV)(r,n),!0),c=l=s=f=u=void 0,ot.LE(a)){for(u=a.getRowCount(0),f=a.getColumnCount(0),s=[],l=0;l<u;l++)for(s[l]=[],c=0;c<f;c++)s[l][c]=a.getValue(0,l,c);a=s}else if(ot.Nh(a)){for(u=a.getRowCount(),f=a.getColumnCount(),s=[],l=0;l<u;l++)for(s[l]=[],c=0;c<f;c++)s[l][c]=a.getValue(l,c);a=s}return g(a,Array)?a[0][0]:a}return e.expected()},a.prototype.dateOrTimeEvaluate=function(t,r,n,e,i,o,a){var u,f,s,e,u=this;if((T(e)||""===e)&&u.ignoreBlank())return!0;if(!g(f=e,Date)){if(u.ZK()===ar.notEqualsTo)return!0;if(!T(e))return!1;f=Dt.Y0(0)}if(s=C,e=this.getExpected(t,r,n),g(e,Date)?s=e:"string"==typeof e?s=Dt.yU(e):"number"==typeof e&&(s=Dt.Y0(e)),T(s))return!!u.ignoreBlank();switch(u.ZK()){case ar.equalsTo:return i(s,f);case ar.notEqualsTo:return!i(s,f);case ar.after:return a(s,f);case ar.afterEqualsTo:return a(s,f)||i(s,f);case ar.before:return o(s,f);case ar.beforeEqualsTo:return o(s,f)||i(s,f);default:return!1}},a.prototype.dateConditionEvaluate=function(t,r,n,e){var i=this.preciseCompareDate();return this.dateOrTimeEvaluate(t,r,n,e,pr,i?mr:wr,i?Sr:gr)},a.prototype.timeConditionEvaluate=function(t,r,n,e){return this.dateOrTimeEvaluate(t,r,n,e,kr,xr,Tr)},a.prototype.dateExConditionEvaluate=function(t,r,n,e){var t=this.LJ(t,r,n);return!T(t)&&this.dateExConditionCheckCondition(t,e)},a.prototype.getExConditionDateScope=function(t){var r,n,e,i,o,a,o,a,o,a,o,a,o,a,o,a,o,a,u,f,s,a,u,s,f,o,u,s,o,f,a,s,o,a,u,f,s,r=C,n=C,e=new Date,i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());switch(t){case N.last7Days:h(i,br(i)-6),r=l(i),n=c(e);break;case N.yesterday:h(i,br(i)-1),r=l(i),n=c(i);break;case N.today:r=l(e),n=c(e);break;case N.tomorrow:h(i,br(i)+1),r=l(i),n=c(i);break;case N.lastWeek:h(o=e,br(e)-e.getDay()-7),(a=i).setDate(br(i)-i.getDay()-1),r=l(o),n=c(a);break;case N.thisWeek:h(o=e,br(e)-e.getDay()),h(a=i,br(i)-i.getDay()+6),r=l(o),n=c(a);break;case N.nextWeek:h(o=e,br(e)-e.getDay()+7),h(a=i,br(i)-i.getDay()+13),r=l(o),n=c(a);break;case N.lastMonth:h(o=e,1),o.setMonth(e.getMonth()-1),h(a=i,0),r=l(o),n=c(a);break;case N.thisMonth:h(o=e,1),h(a=i,1),a.setMonth(i.getMonth()+1),h(a,0),r=l(o),n=c(a);break;case N.nextMonth:h(o=e,1),o.setMonth(e.getMonth()+1),h(a=i,1),a.setMonth(i.getMonth()+2),h(a,0),r=l(o),n=c(a);break;case N.nextQuarter:u=(a=(o=e).getMonth())%3,o.setDate(1),o.setMonth(a-u+3),s=void 0,(f=i).setDate(1),f.setMonth(a-u+3+2),s=2===f.getMonth()||11===f.getMonth()?31:30,f.setDate(s),r=l(o),n=c(f);break;case N.thisQuarter:s=(u=(a=e).getMonth())%3,a.setDate(1),a.setMonth(u-s),o=void 0,(f=i).setDate(1),f.setMonth(u-s+2),o=2===f.getMonth()||11===f.getMonth()?31:30,f.setDate(o),r=l(a),n=c(f);break;case N.lastQuarter:o=(s=(u=e).getMonth())%3,u.setDate(1),u.setMonth(s-o-3),a=void 0,(f=i).setDate(1),f.setMonth(s-o-3+2),a=2===f.getMonth()||11===f.getMonth()?31:30,f.setDate(a),r=l(u),n=c(f);break;case N.nextYear:(s=e).setDate(1),s.setFullYear(s.getFullYear()+1),s.setMonth(0),(o=i).setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31),r=l(s),n=c(o);break;case N.thisYear:(a=e).setDate(1),a.setMonth(0),(u=i).setMonth(11),u.setDate(31),r=l(a),n=c(u);break;case N.lastYear:(f=e).setFullYear(f.getFullYear()-1),f.setDate(1),f.setMonth(0),(s=i).setFullYear(s.getFullYear()-1),s.setMonth(11),s.setDate(31),r=l(f),n=c(s)}return{from:r,to:n}},a.prototype.dateExConditionCheckCondition=function(t,r){var n,r,e,i,t,e,t,e,t,o,t,n;function a(t,r){switch(t){case sr.quarter1:return 0<=r.getMonth()&&r.getMonth()<=2;case sr.quarter2:return 3<=r.getMonth()&&r.getMonth()<=5;case sr.quarter3:return 6<=r.getMonth()&&r.getMonth()<=8;case sr.quarter4:return 9<=r.getMonth()&&r.getMonth()<=11;default:return!1}}if(r=r,(n=this).ignoreBlank()&&(T(r)||""===r))return!0;try{if(T(r)&&!n.treatNullValueAsZero())return!1;r=ot.r0(r)}catch(t){return!1}if((i=n.expectTypeId())===ur.dateOccurring){if(e=(t=this.getExConditionDateScope(t)).from,t=t.to,!T(e)&&!T(t))return e=(0,b.aJ)(y.dateCondition,ar.afterEqualsTo,e,C),t=(0,b.aJ)(y.dateCondition,ar.beforeEqualsTo,t,C),(o=(0,b.aJ)(y.relationCondition,rr.and,C,C,C,C,C,e,t)).evaluate(C,0,0,r)}else if(e=n.LJ(C,0,0),!T(e)){if(i===ur.yearOccurring)return e===r.getFullYear();if(i===ur.quarterOccurring)return a(e,r);if(i===ur.monthOccurring)return e===r.getMonth();if(i===ur.weekOccurring)return e===r.getDay();if(i===ur.dayOccurring)return e===br(r);if(i===ur.yearToDate)return t=new Date,n=new Date,t.setMonth(0,1),t.setHours(0,0,0,0),n.setHours(23,59,59,999),t<=r&&r<=n}return!1},a.prototype.textLengthConditionEvaluate=function(t,r,n,e){var e,t;return!(!T(e)&&""!==e||!this.ignoreBlank())||(e=T(e)?0:e.toString().length,"number"==typeof(t=this.LJ(t,r,n))&&tn(this.ZK(),e,t))},a.prototype.top10ConditionEvaluate=function(t,r,n,e){var i,r,o,n,i=this;if(T(e)||""===e)return i.ignoreBlank();if(r=i.LJ(t,r,n),!T(r)&&(o=void 0,o=i.FJ?(T(i.PJ)&&(i.PJ=i.getTopValues(t,r,i.ranges())),i.PJ):i.getTopValues(t,r,i.ranges()))){n=0;try{n=i.uJ(e)}catch(t){return!1}if(Ft.OS(o,n))return!0}return!1},a.prototype.LJ=function(t,r,n){var t=this.getExpected(t,r,n),t=parseInt(t,10);return isNaN(t)||!isFinite(t)?C:t},a.prototype.adjustRange=function(t,r){return $(t.row,t.col,Math.min(Q(t),r.getRowCount()),Math.min(H(t),r.getColumnCount()))},a.prototype.getTopValues=function(t,r,n){var e,i,o,a,u,f,s,s,l,c,h,e=0===this.type()?1:-1,i=[];if(n){for(o=this.GJ(t,n),a=J(o),l=0;l<a;l++)for(u=this.adjustRange(o[l],t),c=0;c<Q(u);c++)for(f=c+u.row,h=0;h<H(u);h++)s=h+u.col,s=this.uJ(t.getValue(f,s)),T(s)||i.push(s);i.sort(function(t,r){return(r-t)*e}),J(i)>r&&(i=i.slice(0,r))}return i},a.prototype.uJ=function(t){return("number"==typeof t||g(t,Date))&&Ot?ut(t):C},a.prototype.uniqueConditionEvaluate=function(t,r,n,e){var i,e,r,n,r,n,i=this,e=e;return T(e)||""===e?i.ignoreBlank():(Ot&&at(e)&&!Qt(e)&&!m.mt.isInfinityNumberString(e)&&(e=ut(e)),r=this.getExpected(t,r,n),ot.YK(r,n={}),!T(r=n.value)&&(n=i.duplicatedArrayCached||i.getDuplicated(t,i.ranges()),!T(n)&&Ft.OS(n,e)?!0===r:!0!==r))},a.prototype.getDuplicated=function(t,r){var n,e,i,o,a,u,f,s,l,c,h,v,v,d,n=[],e={},i=this.GJ(t,r);if(i)for(o=J(i),a=0;a<o;a++)for(u=i[a],f=Q(u=this.adjustRange(u,t)),s=H(u),l=0;l<f;l++)for(c=l+u.row,h=0;h<s;h++)v=h+u.col,v=t.getValue(c,v,3),(d=e[v=T(v)||!Ot||!at(v)||Qt(v)||m.mt.isInfinityNumberString(v)?v:ut(v)])?1===d&&n.push(v):e[v]=1;return n},a.prototype.UJ=function(t,r){for(var n,e,n=t.length,e=0;e<n;e++)if(t[e].key===r)return!0;return!1},a.prototype.averageConditionEvaluate=function(t,r,n,e){var i,o,o,a,u,t,f,s;if(!Ot)return!1;if((i=this).ignoreBlank()&&(T(e)||""===e))return!0;if(i.HJ(),o=i.FJ?(T(i.PJ)&&(i.PJ=i.getExpected(t,r,n)),i.PJ):i.getExpected(t,r,n),a=ft(o,o={})?o.value:NaN,u=C,t=i.QK?i.zJ(t,i.QK,r,n):C,T(t)||(u=ft(t,o={})?o.value:NaN),isNaN(a)||!at(e,!0))return!1;switch(f=ut(e),s=isNaN(u),i.type()){case I.above:return a<f;case I.below:return f<a;case I.equalOrAbove:return a<=f;case I.equalOrBelow:return f<=a;case I.above1StdDev:return!s&&a+u<f;case I.below1StdDev:return!s&&f<a-u;case I.above2StdDev:return!s&&a+2*u<f;case I.below2StdDev:return!s&&f<a-2*u;case I.above3StdDev:return!s&&a+3*u<f;case I.below3StdDev:return!s&&f<a-3*u;default:return!1}},a.prototype.HJ=function(){var t=this;t.ranges()&&(t.WK=t.VJ("AVERAGE",t.ranges()),4<=t.type())&&t.type()<=9&&(t.QK=t.VJ("STDEV",t.ranges()))},a.prototype.VJ=function(t,r){var t,n,e,i;if(Ot&&(t=Wt.findGlobalFunction(t))){for(n=[],e=J(r),i=0;i<e;i++)n[i]=Yt(r[i]);return D.YJ(t,n)}return C},a.prototype.averageConditionGetExpected=function(t,r,n){var e=t.op();return e?e.evaluateParsedFormula(t.Uw(),this.expression(k,t),(0,F.eV)(r,n),!1):C},a.prototype.ZJ=function(){var t=this.conType();t!==y.averageCondition&&t!==y.top10Condition||(this.FJ=!0)},a.prototype.WJ=function(){var t=this;t.FJ=!1,t.PJ=k},a.prototype.zJ=function(t,r,n,e){var i=t.op();return i?i.evaluateParsedFormula(t.Uw(),r,(0,F.eV)(n,e),!1):C},a.prototype.QJ=function(t,r){for(var n,e,e=0;e<J(r);e++)n=r[e],g(n,Array)&&0<J(n)?1<J(r)?t.push(n[0]):t.push.apply(t,n):t.push(n)},a.prototype.getValidList=function(t,r,n){for(var e,i,o,a,e=[],i=this.getValidListImp(t,r,n),o=0,a=J(i);o<a;o++)e.push(i[o].value);return e},a.prototype.KJ=function(){return this.D5&&0<this.D5.length},a.prototype.getValidListImp=function(t,r,n){var e,i,t,o,a,u,f,s,l,s,e=this,i=[];if(e.D5&&0<e.D5.length)t=e.getExpected(t,r,n),g(t,Array)?e.QJ(i,t):i.push(t);else if(e.expected()&&0<e.expected().length&&(u=(a=(o=e.expected()).replace(/\\,/g,String.fromCharCode(206))).split(",")))for(f=0;f<J(u);f++)s=u[f],T(s)||(l=new RegExp(String.fromCharCode(206),"g"),""!==(s=p.trim(s).replace(l,","))&&i.push({text:s,value:s}));return i},a.prototype.areaConditionEvaluate=function(t,r,n,e){var i,o,a,u,f,s;function l(t,r,n){return g(t,Date)&&g(r,Date)?t.valueOf()===r.valueOf():n||"string"!=typeof t||"string"!=typeof r?t===r:t.toLowerCase()===r.toLowerCase()}if(i=this,T(e)||""===e)return!0===i.ignoreBlank();for(o=i.getValidList(t,r,n),a=0;a<J(o);a++){if(u=o[a],T(u)&&T(e))return!0;if(i.D5){if(l(u,e,!1))return!0}else if(f=t.getActualStyle(r,n,3,!0),l(s=x.Xf(f,u,!0),e,!0))return!0}return!1},a.prototype.areaConditionGetExpected=function(t,r,n){var e,i,o,a,u,f,s,l,c,h,v,d,y,c,t,e=this,i=[];if(e.D5){if(l=s=f=u=a=o=void 0,!(c=t.op()))return i;if(h=c.evaluateParsedFormula(t.Uw(),e.expression(k,t),(0,F.eV)(r,n),!0),ot.LE(h))for(o=h.getRowCount(0),a=h.getColumnCount(0),v=h.getRow(0),d=h.getColumn(0),(y=h.rT&&h.rT.Mf)&&(y.nre&&y.nre(),c=y.getRowCount(),t=y.getColumnCount(),o=c<o?rt(c-v,0):o,a=t<a?rt(t-d,0):a),u=0;u<o;u++)for(i[u]=[],f=0;f<a;f++)s=h.getValue(0,u,f),l=y?y.getText(v+u,d+f):s,i[u][f]={value:s,text:l};else if(ot.Nh(h))for(o=h.getRowCount(),a=h.getColumnCount(),u=0;u<o;u++)for(i[u]=[],f=0;f<a;f++)s=h.getValue(u,f),i[u][f]={value:s,text:s}}else i.push({value:e.expected(),text:e.expected()});return i},a.prototype.stateConditionEvaluate=function(t,r,n,e){var i=this.expected();return!(T(e)||T(i)||isNaN(e)||isNaN(e))&&0<(e&i)},a.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.preciseCompareDate(!1),t.ZK(1),t.item1(C),t.item2(C),t.value1=C,t.value2=C,t.expected(C),t.ZK(0),t.integerValue(!1),t.operator=0,t.text="",t.ZK(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.WK=C,t.type(0),this.expectTypeId(0),t.ranges(C),t.isPercent(!1),t.regex(C),t.conType()){case y.relationCondition:t.ignoreBlank(!1),t.ZK(1);break;case y.numberCondition:t.ZK(0),t.integerValue(!1);break;case y.textCondition:t.ZK(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case y.colorCondition:t.ZK(0);break;case y.formulaCondition:t.customValueType(0),t.QK=C;break;case y.dateCondition:case y.timeCondition:t.ZK(0);break;case y.dateExCondition:t.expectTypeId(0);break;case y.textLengthCondition:t.ZK(0);break;case y.top10Condition:case y.averageCondition:t.type(0);break;case y.cellValueCondition:t.operator=6;break;case y.areaCondition:}},a.prototype.evaluate=function(t,r,n,e){var i=this.conType();return!T(i)&&this[y[i]+"Evaluate"](t,r,n,e)},a.prototype.getExpectedNormal=function(t,r,n,e,i,o){var a,u,f,u,a=this,u=a.D5,f=a.expected();return(u=u&&t.op())?u.evaluateParsedFormula(t.Uw(),a.expression(k,t),(0,F.eV)(r,n),!1,o):f},a.prototype.getExpected=function(t,r,n){var e=this;switch(e.conType()){case 2:return e.getExpectedNormal(t,r,n,r-e.offsetRow,n-e.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return e.getExpectedNormal(t,r,n,r-e.offsetRow,n-e.offsetCol,!1);case 8:return e.getExpectedNormal(t,r,n,r,n);case 0:return C;case 1:return e.numberConditionGetExpected(t,r,n);case 3:return C;case 4:return e.formulaConditionGetExpected(t,r,n);case 10:return e.averageConditionGetExpected(t,r,n);case 12:return e.areaConditionGetExpected(t,r,n);default:return C}},a.prototype.GJ=function(t,r){for(var n,e,i,o,n=[],e=0,i=J(r);e<i;e++)o=t.JS(r[e]),n.push(o);return n},a.prototype.getExpressions=function(){var t=[],r=this;return 0===r.conType()?(r.item1()&&r.item1().getExpressions&&(t=r.item1().getExpressions()),r.item2()&&r.item2().getExpressions?t.concat(r.item2().getExpressions()):t):(r.WK||r.initExpression(),r.WK?[r.WK]:[])},a.prototype.setExpressions=function(t,r){var n=this,e;r&&r.push({type:"condition",condition:this,expressions:n.getExpressions(),newExpressions:t}),0===n.conType()?(n.item1()&&n.item1().setExpressions&&(e=n.item1().getExpressions().length,n.item1().setExpressions(t.slice(0,e))),n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(t.slice(e))):n.expression(t[0])},a.prototype.toJSON=function(t){var t=Kt.call(this,t,Nr);return t.ignoreBlank&&!isNaN(t.ignoreBlank)&&(t.ignoreBlank=0!==parseInt(t.ignoreBlank,10)),t},a.prototype.fromJSON=function(t,r,n){var e,i;t&&(Zt.call(e=this,r,Nr,t,n),(i=r&&r.Lp&&r.Lp.useR1C1)&&r instanceof m.Worksheet&&(e.context(r),Rt(e)),e.U0(!0),e.initExpression(),e.H0())},a.fromSource=function(t){return(0,b.aJ)(12,C,t,C)},a.fromFormula=function(t){return(0,b.aJ)(12,C,"",t)},a.fromDay=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(5),t},a.fromMonth=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(3),t},a.fromQuarter=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(2),t},a.fromWeek=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(4),t},a.fromYear=function(t){var t=(0,b.aJ)(6,C,t);return t.expectTypeId(1),t},S=a,t(b.Condition=S),S.prototype.conType=r("conType",C),S.prototype.ranges=r("ranges",C,function(t){var r=this.item1(),n=this.item2();r&&r.ranges&&r.ranges(t),n&&n.ranges&&n.ranges(t)}),S.prototype.ignoreBlank=r("ignoreBlank",!1),S.prototype.preciseCompareDate=r("preciseCompareDate",!1),S.prototype.compareType=r("compareType",k),S.prototype.ZK=S.prototype.compareType,S.prototype.expected=r("expected",k),S.prototype.item1=r("item1",C),S.prototype.item2=r("item2",C),S.prototype.treatNullValueAsZero=r("treatNullValueAsZero",!1),S.prototype.integerValue=r("integerValue",!1),S.prototype.forceValue2Text=r("forceValue2Text",!1),S.prototype.useWildCards=r("useWildCards",!0),S.prototype.regex=r("regex",C),S.prototype.ignoreCase=r("ignoreCase",!1),S.prototype.customValueType=r("customValueType",k),S.prototype.expectTypeId=r("expectTypeId",0),S.prototype.type=r("type",C),S.prototype.isPercent=r("isPercent",!1),i.prototype.stopIfTrue=function(t){},i.prototype.evaluate=function(t,r,n,e){var i,o,a,a,u,t,i=this,o=i.JJ(r,n);return i.zT(o)?(i.initCondition(),i.getBaseCoordinate(a={baseRow:0,baseCol:0}),i.condition().adjustOffset(r-a.baseRow,n-a.baseCol),a=C,u=ot.BJ,(t=i.condition().evaluate(t,r,n,e))&&!u(t)&&(a=i.getExpected(o)||b.oJ),i.condition().adjustOffset(0,0),a):C},i.prototype.JJ=function(t,r){return this.contains(t,r)},i.prototype.zT=function(t){return t},i.prototype.contains=function(t,r){var n,e,i,o,n=this.ranges();if(n)for(e=J(n),i=void 0,o=0;o<e;o++)if((i=n[o]).contains(t,r))return!0;return!1},i.prototype.createCondition=function(){return this.KK=!1,null},i.prototype.initCondition=function(t){var r=this.condition();r||((r=this.createCondition())&&(r.ranges(this.ranges()),this.condition(r)),t&&this.context(t),this.context()&&r&&r.context(this.context()))},i.prototype.XJ=function(){var t,r,t=this;t.KK&&((r=t.condition())||(t.initCondition(),r=t.condition()),r)&&!r.WK&&r.initExpression()},i.prototype.context=function(t){return 1===arguments.length&&(this.DJ=t,this.condition())&&this.condition().context(t),this.DJ},i.prototype.getExpected=function(t){return this.style()},i.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.stopIfTrue(!1),t.priority(1)},i.prototype.intersects=function(t,r,n,e){var i,o,a,u,i=this.ranges();if(i)for(o=J(i),a=void 0,u=0;u<o;u++)if((a=i[u]).intersect(t,r,n,e))return!0;return!1},i.prototype.isScaleRule=function(){return!1},i.prototype.isStateRule=function(){return!1},i.prototype.getBaseCoordinate=function(t){var r,n,e,i,o,a,o;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,0<(e=(n=(r=this).ranges())?n.length:0))for(i=0;i<e;i++)a=(o=n[i]).row,o=-1===(o=o.col)?0:o,t.baseRow=tt(a=-1===a?0:a,t.baseRow),t.baseCol=tt(o,t.baseCol);else t.baseRow=0,t.baseCol=0},i.prototype.qJ=function(t,r,n){var e,i,o,a,u,f,s,l,c,f,h,v,d,e=this,i=!1;if(e.XJ(),o=e.ranges())for(a=J(o),u=0;u<a;u++)s=(f=o[u]).row,l=Q(f),c=f.col,f=H(f),h=s===t.row&&l===t.rowCount&&t.col<=c&&f<=t.colCount,v=s===r.row&&l===r.rowCount&&r.col<=c&&f<=r.colCount,(d=h||v)&&(o[u]=$(s,c,l+n,f),i=!0);return i},i.prototype.$J=function(t,r,n,e,i,o){var a,u,f,s,l,c,h,v,d,y,C,b,p,g,S,w,g,m,k,k,T,x,_,a=this,u=n?r:0,f=n?0:r;if(a.XJ(),s=a.ranges()){for(l=[],c=J(s),h=0;h<c;h++)if(v=s[h],d=n?v.row:v.col,y=(n?Q:H)(v),-1!==d){if(e&&0<e.length){for(C=!1,b=0,p=e.length;b<p;b++)if((g=e[b])&&(S=!n&&g.col===t&&g.col===v.col&&g.colCount-r===v.colCount,w=!n&&g.col===t&&g.row===v.row&&g.rowCount===v.rowCount&&v.col>=g.col&&v.col+v.colCount<=g.col+g.colCount,g=n&&g.row===t&&g.row===v.row&&g.rowCount-r===v.rowCount,S||w||g)){s[h]=$(v.row,v.col,Q(v)+u,H(v)+f),C=!0;break}if(C)break}if(m=v,k=i&&e&&e[0]){if((k=n?on(v,k.col,k.col+k.colCount-1):an(v,k.row,k.row+k.rowCount-1))[0]&&l.push(k[0]),k[2]&&l.push(k[2]),!k[1])continue;m=k[1]}t<=d?s[h]=$(m.row+u,m.col+f,Q(m),H(m)):t<d+y?s[h]=$(m.row,m.col,Q(m)+u,H(m)+f):t===d+y&&(s[h]=$(m.row,m.col,Q(m)+(o?0:u),H(m)+(o?0:f)))}for(T=0,x=l;T<x.length;T++)s.push(_=x[T])}},i.prototype.JO=function(t,r,n,e,i){this.$J(t,r,!0,n,e,i)},i.prototype.qO=function(t,r,n,e,i){this.$J(t,r,!1,n,e,i)},i.prototype.tX=function(t,r,n,e,i){var o,a,u,f,s,l,c,h,v,d,y,C,b,p,g,y,g,S,w,m,k,T,x,o=this,a=n?t:0,u=n?0:t,f=n?r:0,s=n?0:r;if(o.XJ(),l=o.ranges()){for(c=[],h=[],v=J(l),d=0;d<v;d++)if(y=l[d],C=n?y.row:y.col,b=(n?Q:H)(y),-1!==C){if(p=y,g=i&&e&&e[0]){if((y=n?on(y,g.col,g.col+g.colCount-1):an(y,g.row,g.row+g.rowCount-1))[0]&&c.push(y[0]),y[2]&&c.push(y[2]),!y[1])continue;p=y[1]}t<C?C+b<=t+r?h.push(p):l[d]=$(p.row-f,p.col-s,Q(p),H(p)):t<C+b&&(g=$(p.row,p.col,Q(p)-tt(p.row+Q(p)-a,f),H(p)-tt(p.col+H(p)-u,s)),0===H(g)||0===Q(g)?h.push(p):l[d]=g)}for(S=0,w=c;S<w.length;S++)l.push(m=w[S]);for(k=J(h),T=0;T<k;T++)Gt(l,x=h[T])}},i.prototype.xP=function(t,r,n,e){this.tX(t,r,!0,n,e)},i.prototype.NP=function(t,r,n,e){this.tX(t,r,!1,n,e)},i.prototype.toJSON=function(t){return Kt.call(this,t)},i.prototype.fromJSON=function(t,r,n){t&&(Zt.call(this,r,C,t,n),this.initCondition(r))},i.prototype.kJ=function(){var t=this.condition();t&&Rt(t)},i.prototype.nX=function(){var t,r,n,e,i,t=this.JK,r=this.ranges();if(t){if((n=J(t))!==(e=J(r)))return!0;for(i=0;i<e;i++)if(!t[i].equals(r[i]))return!0}else this.JK=gn(r);return!1},(e=(b.ConditionRuleBase=n=i).prototype).ruleType=r("ruleType",C),e.ranges=r("ranges",C,function(t){var r,n,r=this.condition();r&&r.ranges()&&((n=r.DJ)&&n.Ut.vJ(),r.ranges(t),n)&&n.Ut.vJ(!0)}),e.condition=r("condition",C),e.style=r("style",C),e.priority=r("priority",1),e.stopIfTrue=r("stopIfTrue",!1),Ir=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Rr={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},Ar={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},(e=Er=Er||{})[e.equal=0]="equal",e[e.notEqual=1]="notEqual",e[e.greaterThan=2]="greaterThan",e[e.greaterThanOrEqual=3]="greaterThanOrEqual",e[e.lessThan=4]="lessThan",e[e.lessThanOrEqual=5]="lessThanOrEqual",e[e.between=6]="between",e[e.notBetween=7]="notBetween",M(u,$r=n),u.prototype.value1=function(t,r){var n,n;if(1!==arguments.length)return(n=this.condition())&&(n=n.formula(t,r,0))&&0<n.length?"="+ct(p.trim(n.toString()),"="):this.eX;this.eX=t},u.prototype.value2=function(t,r){var n,n;if(1!==arguments.length)return(n=this.condition())&&(n=n.formula(t,r,1))&&0<n.length?"="+ct(p.trim(n.toString()),"="):this.iX;this.iX=t},u.prototype.formula=function(t,r){var n=this,e=n.condition();if("string"!=typeof t)return e&&e.formula(t,r)||n.D5;n.D5=t,e&&e.formula(t)},u.prototype.cellValueRuleCreateCondition=function(){var t,r,n,e,i,o,a,u,f,s,l,c,t,h,a,t=this,r=t.value1(),n=t.value2(),e=t.ranges(),i=t.kf(r)?ct(r,"="):C,o=t.kf(n)?ct(n,"="):C,t=t.operator();return t===nr.between?((a=(0,b.aJ)(y.cellValueCondition,3,r,i,k,k,e)).treatNullValueAsZero(!0),(u=(0,b.aJ)(y.cellValueCondition,5,n,o,k,k,e)).treatNullValueAsZero(!0),l=(0,b.aJ)(y.relationCondition,1,C,C,C,C,e,a,u),(f=(0,b.aJ)(y.cellValueCondition,5,r,i,k,k,e)).treatNullValueAsZero(!0),(s=(0,b.aJ)(y.cellValueCondition,3,n,o,k,k,e)).treatNullValueAsZero(!0),c=(0,b.aJ)(y.relationCondition,1,C,C,C,C,e,f,s),(0,b.aJ)(y.relationCondition,0,C,C,C,C,e,l,c)):t===nr.notBetween?((a=(0,b.aJ)(y.cellValueCondition,4,r,i,k,k,e)).treatNullValueAsZero(!0),u=(0,b.aJ)(y.cellValueCondition,2,n,o,k,k,e),a.treatNullValueAsZero(!0),l=(0,b.aJ)(y.relationCondition,0,C,C,C,C,e,a,u),(f=(0,b.aJ)(y.cellValueCondition,2,r,i,k,k,e)).treatNullValueAsZero(!0),(s=(0,b.aJ)(y.cellValueCondition,4,n,o,k,k,e)).treatNullValueAsZero(!0),c=(0,b.aJ)(y.relationCondition,0,C,C,C,C,e,f,s),(0,b.aJ)(y.relationCondition,1,C,C,C,C,e,l,c)):((a=(0,b.aJ)(11,t,r,i,k,k,e)).treatNullValueAsZero(!0),a)},u.prototype.kf=function(t){return!T(t)&&"="===t[0]},u.prototype.specificTextRuleCreateCondition=function(){var t,r,n,e,n,r=this.operator();switch(r){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return n=this.text(),e=C,n&&"="===n[0]&&(e=n),(n=(0,b.aJ)(2,t,n,e,k,k,this.ranges())).ignoreCase(!0),n.useWildCards(2!==r&&3!==r),n},u.prototype.formulaRuleCreateCondition=function(){var t=this,r=t.ranges();return(0,b.aJ)(4,C,C,t.D5,4,C,r)},u.prototype.dateOccurringRuleCreateCondition=function(){return(0,b.aJ)(6,C,this.type(),C,C,k,this.ranges())},u.prototype.top10RuleCreateCondition=function(){return(0,b.aJ)(8,C,this.rank(),C,C,this.type(),this.ranges())},u.prototype.uniqueRuleCreateCondition=function(){return(0,b.aJ)(9,C,!1,C,C,C,this.ranges())},u.prototype.duplicateRuleCreateCondition=function(){return(0,b.aJ)(9,C,!0,C,C,C,this.ranges())},u.prototype.averageRuleCreateCondition=function(){return(0,b.aJ)(10,C,C,C,C,this.type(),this.ranges())},u.prototype.createCondition=function(){return this[_[this.ruleType()]+"CreateCondition"]()},u.prototype.reset=function(){var t=this;switch(t.ranges(C),t.condition(C),t.style(C),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(C),t.value2(C),t.text(""),t.formula(C),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(C);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},u.prototype.evaluate=function(t,r,n,e){return this.rX(t),$r.prototype.evaluate.call(this,t,r,n,e)},u.prototype.rX=function(t){var r,n,r=this;r.initCondition(),9===(n=r.condition()).conType()&&(r.nX()&&(r.dl(),r.JK=gn(r.ranges())),!1===r.cached)&&(n.duplicatedArrayCached=n.getDuplicated(t,r.ranges()),r.cached=!0)},u.prototype.dl=function(){this.cached=!1},u.prototype.JO=function(t,r,n,e,i){$r.prototype.JO.call(this,t,r,n,e,i),this.dl()},u.prototype.qO=function(t,r,n,e,i){$r.prototype.qO.call(this,t,r,n,e,i),this.dl()},u.prototype.xP=function(t,r,n,e){$r.prototype.xP.call(this,t,r,n,e),this.dl()},u.prototype.NP=function(t,r,n,e){$r.prototype.NP.call(this,t,r,n,e),this.dl()},u.prototype.toJSON=function(t){var r,n,e,i,o,a,r=this;return T(r.condition())&&this.initCondition(),n=Kt.call(r,t,Ir),e=r.value1(),un(n.ruleType,n.operator)&&(i=r.value2()),o=t&&t.parent&&1===t.parent.options.referenceStyle,T(e)||(r.kf(e)&&o&&(e=ln(t,r,e,o)),n.value1=e),T(i)||(r.kf(i)&&o&&(i=ln(t,r,i,o)),n.value2=i),(a=r.ruleType())===_.conditionRuleBase&&(n.condition=r.condition().toJSON()),n},u.prototype.fromJSON=function(t,r,n){var e=Ir;T(t.condition)||(e=Ir.concat(["condition"])),Zt.call(this,r,e,t,n),T(t.value1)||this.value1(t.value1),T(t.value2)||this.value2(t.value2),this.initCondition(r)},u.prototype.oX=function(t,r,n){var e,i,r,o,t,a,u,f,f,n,s,l,f,c,h,v,d,l,y,C,b,p,g,u,S,w,S,a,r,e=this,i=e.ruleType(),r=m.Util.ko(r),o={n_:P,sqref:It(e.ranges())};return o.pivot=T(e.pivotTableName)?k:"1",t=t.getDxfIndex(e.style(),!0),a=e.operator&&e.operator(),u=e.type&&e.type(),f=[N.nextQuarter,N.thisQuarter,N.lastQuarter,N.nextYear,N.thisYear,N.lastYear],i===_.dateOccurringRule&&-1<f.indexOf(u)?o.lossless=e.toJSON(n):(n=(f=An(i,u,a)).type,s=f.operator,l=e.condition(),f=f.timePeriod,c=e.priority()?""+e.priority():"1",h=e.stopIfTrue()?1:k,v=1===u?1:k,l=(d=l&&l.isPercent())?1:k,y=e.rank&&e.rank()||k,C=e.text&&e.text(),g=p=b=void 0,i===_.averageRule&&(g=0,u!==I.equalOrAbove&&u!==I.equalOrBelow||(p=1),u!==I.above1StdDev&&u!==I.below1StdDev||(g=1),u!==I.above2StdDev&&u!==I.below2StdDev||(g=2),u!==I.above3StdDev&&u!==I.below3StdDev||(g=3),u!==I.below&&u!==I.equalOrBelow&&u!==I.below1StdDev&&u!==I.below2StdDev&&u!==I.below3StdDev||(b=0)),u=[],S=T(e.value1())?e.D5:e.value1(),w=e.value2(),T(S)||u.push({n_:"formula",c_:[xn(r?S:Ct(S))]}),un(i,a)&&!T(w)&&u.push({n_:"formula",c_:[xn(r?w:Ct(w))]}),S={n_:"cfRule",type:n,dxfId:t!==k?+t:t,priority:c,stopIfTrue:h,aboveAverage:b,equalAverage:p,bottom:v,percent:l,rank:y,operator:s,text:pt(C),stdDev:g,timePeriod:f},i===_.specificTextRule||i===_.dateOccurringRule||i===_.top10Rule||i===_.uniqueRule||i===_.duplicateRule||i===_.averageRule?(a=fn(S,e.ranges(),C))&&(r=[{n_:"formula",c_:[xn(x.getFormulaString(a))]}],S.c_=r):S.c_=u,o.c_=[S]),o},u.prototype.IJ=function(t){var r,n,e,i,e,t,r=this,n={n_:"conditionalFormatting","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},e=Ut(),i={n_:"cfRule",type:"expression",id:e};return r.rJ=e,T(r.priority())||(i.priority=r.priority()),e={n_:"f",c_:[pt(bt(r.D5))]},r.style()&&(t={n_:"dxf",v:t.cv(r.style(),!0)},i.c_=[e,t]),n.c_=[i,{n_:"sqref",c_:[It(r.ranges())]}],n},u.prototype.aX=function(){var t=this;if(At(t.value1())||At(t.value2())||At(t.text())||At(t.D5))return!0},u.prototype.wh=function(t,r,n,e,i){var o=this;if(!rn(e)||!o.aX())return T(o.condition())&&o.initCondition(),r?o.IJ(n):o.oX(t,e,i)},u.prototype.uX=function(t,r,n,e){var i,o,e,n,a,u,a,f,e,s,l,c,h,a,i=this,o=t.type,e=m.Util.ko(e),n=n.getDxf(t.dxfId,void 0,!0,!0),a=gt(t,"formula"),u=U(a&&_t(a[0])),a=U(a&&_t(a[1]));switch("cellIs"===o?(i.eX=(e?"":"=")+Tt(u),a&&(i.iX=(e?"":"=")+Tt(a))):i.D5=Tt(u),T(t.stopIfTrue)||i.stopIfTrue(1==+t.stopIfTrue),f=t.rank,e=Vn(o)){case 8:l=!0,0==+t.aboveAverage&&(l=!1),s=(c=1==+t.equalAverage)?l?2:3:l?0:1,T(t.stdDev)||(h=+t.stdDev,l?1==h?s=4:2==h?s=6:3==h&&(s=8):1==h?s=5:2==h?s=7:3==h&&(s=9));break;case 5:s=0,t.bottom&&(s=1),t.percent&&0===(f=Math.floor(r[0].rowCount*r[0].colCount*f/100))&&(f=1);break;case 4:s=0,"timePeriod"===t.type&&t.timePeriod&&(s=Rr[t.timePeriod])}i.type(s),T(f)||i.rank(+f),a=Rn(o,t.operator,t.timePeriod),i.operator(a),i.text(Tt(t.text)),i.ranges(r),i.ruleType(e),i.style(sn(n)),T(t.priority)||i.priority(+t.priority)},u.prototype.sX=function(t,r,n){var e,i,o,a,u,f,s,l,c,c,h,c,i,h,e=this,i=t.type,o=Vn(i);switch(T(t.stopIfTrue)||e.stopIfTrue(1==+t.stopIfTrue),u=t.rank,o){case 8:f=!0,0==+t.aboveAverage&&(f=!1),a=(s=1==+t.equalAverage)?f?2:3:f?0:1,T(t.stdDev)||(l=+t.stdDev,f?1==l?a=4:2==l?a=6:3==l&&(a=8):1==l?a=5:2==l?a=7:3==l&&(a=9));break;case 5:a=0,t.bottom&&(a=1),t.percent&&0===(u=Math.floor(r[0].rowCount*r[0].colCount*u/100))&&(u=1);break;case 4:a=0,"timePeriod"===t.type&&t.timePeriod&&(a=Rr[t.timePeriod])}e.type(a),T(u)||e.rank(+u),c=Rn(i,t.operator,t.timePeriod),e.operator(c),e.ruleType(o),h=(c=gt(t,"f"))&&Tt(kt(_t(c[0]))),c=c&&Tt(kt(_t(c[1]))),"cellIs"===i?(e.eX=h,e.iX=c):e.D5=h,o===_.specificTextRule&&e.text(c),(i=mt(t,"dxf"))&&(h=i.v,e.style(sn(n.fv(h,k,k,!0)))),e.ranges(r)},u.prototype.yh=function(t,r,n,e,i,o,a){var u=this;i?u.sX(t,r,o):u.uX(t,r,n,a),u.initCondition(e)},w=u,b.NormalConditionRule=w,e={operator:r("operator",C),text:r("text",C),type:r("type",C),rank:r("rank",C),priority:r("priority",1)},p.extend(w.prototype,e),b.ScaleValue=cn,Mr=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],M(f,Jr=n),f.prototype.stopIfTrue=function(t){return!1},f.prototype.isScaleRule=function(){return!0},f.prototype.createCondition=function(){return C},f.prototype.cX=function(t){var t=(0,b.aJ)(8,C,C,C,C,1).getTopValues(t,1,this.ranges());return 0<J(t)?t[0]:C},f.prototype.fX=function(t){var t=(0,b.aJ)(8,C,C,C,C,0).getTopValues(t,1,this.ranges());return 0<J(t)?t[0]:C},f.prototype.rX=function(t){var r=this;r.nX()&&(r.dl(),r.JK=gn(r.ranges())),!1===r.cached&&(r.lowestValueCached=r.cX(t),r.highestValueCached=r.fX(t),r.cached=!0)},f.prototype.dl=function(){this.lowestValueCached=C,this.highestValueCached=C,this.XK={},this.cached=!1},f.prototype.lX=function(t,r,n,e){var i,e;return e&&(i=t.op())?(e=i.parse(t.Uw(),e,r,n),i.evaluateParsedFormula(t.Uw(),e,(0,F.eV)(r,n),!1)):C},f.prototype.kf=function(t){return t&&"="===t[0]},f.prototype.hX=function(t){return T(t)||""===t?C:"="===t[0]?t.substr(1):t},f.prototype.dX=function(t,r,n,e){var t;return this.kf(e)?this.lX(t,r,n,this.hX(e.toString())):ft(e,t={})?t.value:NaN},f.prototype.vX=function(t){return this.rX(t),this.highestValueCached},f.prototype.mX=function(t){return this.rX(t),this.lowestValueCached},f.prototype.gX=function(t,r,n,e){var r,n,e,r=this.dX(t,r,n,e);return!isNaN(r)&&0<=r&&r<=100&&(n=this.mX(t),e=this.vX(t),typeof n!=Z)&&n!==C&&typeof e!=Z&&e!==C?n+(e-n)*r/100:C},f.prototype.pX=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,l,l,c,h,i=this.XK;if(void 0===i[e])if(o=this.dX(t,r,n,e),!isNaN(o)&&0<=o&&o<=100){for(a=0,u=this.ranges(),f=J(u),s=0;s<f;s++)l=this.VJ("PERCENTILE",[t.JS(u[s]),o/100]),c=t.op(),h=t.Uw(),l=c.unparse(h,l,r,n),l=c.parse(h,l,r,n),c=c.evaluateParsedFormula(h,l,(0,F.eV)(r,n),!1),a+=ft(c,h={})?h.value:0;i[e]=a/f}else i[e]=C;return i[e]},f.prototype.bX=function(t,r,n,e,i){var o,a,a,o=this;switch(e){case lr.formula:return o.kf(i)||(i="="+i),o.dX(t,r,n,i);case lr.highestValue:return o.vX(t);case lr.lowestValue:return o.mX(t);case lr.number:return o.dX(t,r,n,i);case lr.percent:return o.gX(t,r,n,i);case lr.percentile:return o.pX(t,r,n,i);case lr.automax:return(a=o.vX(t))<0?0:a;case lr.automin:return 0<(a=o.mX(t))?0:a;default:return C}},f.prototype.yX=function(t,r,n){return t===r&&t===n?1:t<=r?0:n<=t?1:(t-r)/(n-r)},f.prototype.wX=function(t,r,n){var r,n,e,i,o,r;return 0<=t&&t<=1?(r=Bt._(r),n=Bt._(n),e=r.a*(1-t)+n.a*t,i=r.r*(1-t)+n.r*t,o=r.g*(1-t)+n.g*t,r=r.b*(1-t)+n.b*t,Vt(parseFloat(e/255+""),parseInt(i+"",10),parseInt(o+"",10),parseInt(r+"",10))):C},f.prototype.VJ=function(t,r){var t,n,e,i;if(Ot&&(t=Wt.findGlobalFunction(t))){for(n=[],e=J(r),i=0;i<e;i++)n[i]=Yt(r[i]);return D.YJ(t,n)}return C},f.prototype.JO=function(t,r,n,e,i){Jr.prototype.JO.call(this,t,r,n,e,i),this.dl()},f.prototype.qO=function(t,r,n,e,i){Jr.prototype.qO.call(this,t,r,n,e,i),this.dl()},f.prototype.xP=function(t,r,n,e){Jr.prototype.xP.call(this,t,r,n,e),this.dl()},f.prototype.NP=function(t,r,n,e){Jr.prototype.NP.call(this,t,r,n,e),this.dl()},f.prototype.scaleEvaluate=function(t,r,n,e){var i,o,a,u,f,i=this;if(i.rX(t),i.contains(r,n)){if(T(e))return C;try{if(o=ut(e),a=i.bX(t,r,n,i.minType(),i.minValue()),u=i.bX(t,r,n,i.midType(),i.midValue()),(f=i.bX(t,r,n,i.maxType(),i.maxValue()))<a)return C;if(isNaN(u)){if(!isNaN(a)&&!isNaN(f))return i.yX(o,a,f)}else if(!isNaN(a)&&!isNaN(f))return o<a?0:f<=o?2:a<=o&&o<=u?i.yX(o,a,u):1+i.yX(o,a,f)}catch(t){}}return C},f.prototype.twoScaleRuleEvaluate=function(t,r,n,e){var i,e,i,o,t,r;if(!T(e)){if(i={},e=at(e)&&ft(e,i)?i.value:NaN,isNaN(e))return C;if(o=(i=this).bX(t,r,n,i.minType(),i.minValue()),t=i.bX(t,r,n,i.maxType(),i.maxValue()),!T(o)&&!T(t))return r=i.yX(e,o,t),i.wX(r,i.minColor(),i.maxColor())}return C},f.prototype.threeScaleRuleEvaluate=function(t,r,n,e){var i,o,e,o,a,t,r,i=this;if(i.MX=t,!T(e)){if(o={},e=at(e)&&ft(e,o)?o.value:NaN,isNaN(e))return C;if(o=i.bX(t,r,n,i.minType(),i.minValue()),a=i.bX(t,r,n,i.midType(),i.midValue()),t=i.bX(t,r,n,i.maxType(),i.maxValue()),!T(o)&&!T(t)&&!T(a))return r=void 0,t<o?C:e<=o||o===t?t<=e?i.maxColor():i.minColor():t<=e?i.maxColor():e<=a?(r=i.yX(e,o,a),i.wX(r,i.minColor(),i.midColor())):(r=i.yX(e,a,t),i.wX(r,i.midColor(),i.maxColor()))}return C},f.prototype.evaluate=function(t,r,n,e){return this[_[this.ruleType()]+"Evaluate"](t,r,n,e)},f.prototype.Hc=function(){var t=this;t.minValue(C),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(C),t.maxType(2),10===t.ruleType()&&(t.minColor(Vt(0,255,255,255)),t.maxColor(Vt(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(Vt(255,248,105,107)),t.midColor(Vt(255,255,235,132)),t.maxColor(Vt(255,99,190,123)))},f.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.Hc(),t.MX=C,t.stopIfTrue(!1),t.priority(1)},f.prototype.toJSON=function(t){return Kt.call(this,t,Mr)},f.prototype.fromJSON=function(t,r,n){Zt.call(this,r,Mr,t,n),this.initCondition(r)},f.prototype.aX=function(){var t=this;if(At(t.minValue())||At(t.midValue())||At(t.maxValue()))return!0},f.prototype.wh=function(t,r,n,e,i){var o,e,a,u,f,s,l,c,h,u,f,s,o=this;if(!rn(e)||!o.aX())return T(o.condition())&&o.initCondition(),e=o.ruleType(),(a={n_:P,sqref:It(o.ranges())}).pivot=T(o.pivotTableName)?k:"1",u=On(o.minType()),f=o.minValue(),s=On(o.maxType()),l=o.maxValue(),c=o.minColor(),h=o.maxColor(),!T(u)&&"autoMin"!==u||(u="min"),!T(s)&&"autoMax"!==s||(s="max"),a.c_=[{n_:"cfRule",type:"colorScale",priority:o.priority()?""+o.priority():"1",c_:[{n_:"colorScale",c_:[{n_:"cfvo",type:u,val:T(f)||Fn(u)?k:pt(Ct(f))},{n_:"cfvo",type:s,val:T(l)||Fn(s)?k:pt(Ct(l))}]}]}],T(c)||a.c_[0].c_[0].c_.push(St(c)),T(h)||a.c_[0].c_[0].c_.push(St(h)),11===e&&(u=On(o.midType()),f=o.midValue(),s=o.midColor(),a.c_[0].c_[0].c_.splice(1,0,{n_:"cfvo",type:u,val:T(f)?50:pt(Ct(f))}),T(s)||a.c_[0].c_[0].c_.splice(4,0,St(s))),a},f.prototype.yh=function(t,r,n,e){var i,o,a,u,f,s,o,a,l,i=this,o=Nn(t),a=In(t),u=o[0],o=2===o.length?o[1]:(f=o[1],o[2]),l=a[0],a=f?(s=a[1],a[2]):a[1];f?i.ruleType(_.threeScaleRule):i.ruleType(_.twoScaleRule),i.minColor(l),i.minValue(Gn(u.val)),i.minType(En(u.type)),i.midColor(s),f&&!T(f.val)&&i.midValue(Gn(f.val)),i.midType(En(f&&f.type)),i.maxColor(a),i.maxValue(Gn(o.val)),i.maxType(En(o.type)),i.ranges(r),i.initCondition(e),T(t.priority)||i.priority(+t.priority)},Br=f,b.ScaleRule=Br,e={minValue:r("minValue",C),minType:r("minType",5),minColor:r("minColor",C),midValue:r("midValue",50,C,function(t){var r=this;if(r.MX){if(2===r.midType())return r.vX(r.MX);if(1===r.midType())return r.mX(r.MX)}return t}),midType:r("midType",C),midColor:r("midColor",C),maxType:r("maxType",7),maxValue:r("maxValue",C),maxColor:r("maxColor",C)},p.extend(Br.prototype,e),Vr=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],M(s,Qr=Br),s.prototype.Hc=function(t){var r=this;r.gradient(!0),r.color(t),r.showBorder(!1),r.borderColor("black"),r.dataBarDirection(0),r.negativeFillColor("red"),r.useNegativeFillColor(!0),r.negativeBorderColor("black"),r.useNegativeBorderColor(!1),r.axisPosition(0),r.axisColor("black"),r.showBarOnly(!1)},s.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.Hc(Vt(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(C),t.minType(5),t.midValue(C),t.midType(C),t.maxValue(C),t.maxType(7),t.minColor(C),t.midColor(C),t.maxColor(C)},s.prototype.CX=function(t,r,n,e){var i,o,a,u,f,s,o,i=this,a=e?i.maxType():i.minType(),u=e?i.maxValue():i.minValue();if(6!==a&&4!==a)return i.bX(t,r,n,a,u);for(f=0;f<J(i.ranges());f++)if(i.ranges()[f].intersect(r,-1,1,-1)&&(o=i.ranges()[f]))return s=o.row,o=o.col,i.bX(t,s=-1===s?0:s,o=-1===o?0:o,a,u)},s.prototype.SX=function(t,r,n){var e=0;return n<=t&&r<t?[1,0]:t<=r&&t<n?[0,0]:n===r?[.5,0]:[(t-r)/(n-r),0]},s.prototype.TX=function(t,r,n){var e,i,o,i,e=.5,i=nt(n-r);return 0<n&&0<=r?n===r||n<=t?[.5,.5]:t<=r?[r/n*.5,.5]:[.5*nt(t/n),.5]:0<n&&r<0?(o=n>nt(r)?.5:n/i,i=n>nt(r)?r/i:-.5,0<t?n<=t?[o,.5]:[t/n*o,.5]:t<0?t<=r?[i,.5]:[t/r*i,.5]:[0,.5]):n<=0&&r<0?n===r?[-.5,.5]:n<=t?[-n/r*.5,.5]:t<=r?[-.5,.5]:[-t/r*.5,.5]:0===n&&0===r?[0,.5]:[e=-1,-1]},s.prototype.AX=function(t,r,n){var e,i,o,a,u,f,i,o,e=-1,i=nt(r),o=nt(n),a=nt(n-r),u=r<0?-1:1;return 0<n&&0<=r||n<=0&&r<0?(f=rt(i,o),i=tt(i,o),e=r<0?1:0,(o=nt(t))<=i&&o<f?[0,e]:f<=o&&i<o?[u,e]:i===f?[.5*u,e]:[u*(nt(t)-i)/a,e]):0<n&&r<0?(e=nt(r)/a,0===t?[0,e]:n<=t?[1-e,e]:[rt(t,r)/a,e]):0===n&&0===r?(e=.5,0===t?[0,e]:[.5*u,e]):[-1,e]},s.prototype.IX=function(t,r,n){var e=this;return 0===e.axisPosition()?e.AX(t,r,n):1===e.axisPosition()?e.TX(t,r,n):e.SX(t,r,n)},s.prototype.evaluate=function(t,r,n,e){var i,e,i,o,r,n,n,o,r,o,e,a;if(!T(e)){if(i={},e=at(e,!0)&&ft(e,i)?i.value:NaN,isNaN(e))return C;if(o=(i=this).CX(t,r,n,!1),r=i.CX(t,r,n,!0),g(o,Date)&&(o=Dt.o0(o)),g(r,Date)&&(r=Dt.o0(r)),!T(o)&&!T(r))return r<o&&(n=r,r=o,o=n),n=void 0,!(o=i.IX(e,o,r))||J(o)<2?C:(r=o[0],n=o[1],o=e<0&&i.useNegativeFillColor()?i.negativeFillColor():i.color(),e=e<0&&i.useNegativeBorderColor()?i.negativeBorderColor():i.borderColor(),a=i.axisColor(),o=Pt.vl(t,o),e=Pt.vl(t,e),a=Pt.vl(t,a),{fillColor:o,borderColor:e,showBorder:i.showBorder(),axisColor:a,isGradient:i.gradient(),direction:i.dataBarDirection(),axisLocation:n,scale:r,showBarOnly:i.showBarOnly()})}return C},s.prototype.toJSON=function(t){return Kt.call(this,t,Vr)},s.prototype.fromJSON=function(t,r,n){Zt.call(this,r,Vr,t,n),this.initCondition(r)},s.paintDataBar=function(t,r,n,e,i,o){var e,a,u,f,s,l,c,h,v,d,e,o,a,y,o,o,C,b,p,e=new q.Rect(n+2,e+2,i-4,o-4),a=e.x,u=e.y,f=et(nt(e.width*r.scale)),s=e.height;if(0===r.axisLocation)r.scale<=0&&(f=0);else if(1===r.axisLocation)r.scale<0?a=a+e.width-f:f=0;else{for(l=et(e.width*r.axisLocation+a)+.5,c=e.y,v=o-2,t.lineWidth=h=1,t.strokeStyle=r.axisColor,t.beginPath(),d=0;d<=v;d+=2)1===r.direction?(t.moveTo(2*n+i-l,c+d),t.lineTo(2*n+i-l,c+d+1)):(t.moveTo(l,c+d),t.lineTo(l,c+d+1));t.stroke(),0<r.scale?a=l+1:r.scale<0?a=l-f:f=0}r.showBorder&&(a=et(a)+.5,--f,u+=.5,--s),o=(e=a)+f,1===r.direction&&(e=2*n+i-a-f,o=2*n+i-a),0<=f&&0<=s&&(a=r.fillColor,r.isGradient&&(y=.9,a=t.createLinearGradient(e,u,o,u),o=Bt._(r.fillColor),o=Vt(o.a,et(229.5+o.r*(1-.9)),et(229.5+o.g*(1-.9)),et(229.5+o.b*(1-.9))),C=r.scale<0?1-.9:.9,b=r.fillColor,p=r.scale<0?1:0,1===r.direction?(a.addColorStop(C,b),a.addColorStop(p,o)):(a.addColorStop(C,o),a.addColorStop(p,b))),t.fillStyle=a,t.fillRect(e,u,f,s),r.showBorder)&&0<f&&0<s&&(t.strokeStyle=r.borderColor,t.strokeRect(e,u,f,s))},s.prototype.oX=function(){var t,r,n,e,i,o,a,u,f,t=this,r={n_:P,sqref:It(t.ranges())};return r.pivot=T(t.pivotTableName)?k:"1",n=t.showBarOnly()?0:k,e=On(t.minType()),i=t.minValue(),o=On(t.maxType()),a=t.maxValue(),u=t.color(),!T(e)&&"autoMin"!==e||(e="min"),!T(o)&&"autoMax"!==o||(o="max"),(f=[]).push({n_:"cfvo",type:e,val:T(i)||zr(i)||Fn(e)?k:pt(Ct(i))}),f.push({n_:"cfvo",type:o,val:T(a)||zr(a)||Fn(o)?k:pt(Ct(a))}),u&&f.push(St(u)),r.c_=[{n_:"cfRule",type:"dataBar",priority:t.priority()?""+t.priority():"1",c_:[{n_:"dataBar",showValue:n,c_:f}]}],t.rJ&&r.c_[0].c_.push({n_:j,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),r},s.prototype.IJ=function(){var t,r,n,e,n,i,i,o,o,a,u,f,t=this,r={n_:"conditionalFormatting",r_:[2]};return r.pivot=T(t.pivotTableName)?k:"1",e={n_:"cfRule",type:"dataBar",id:n=Ut()},t.rJ=n,n={n_:"dataBar",minLength:0,maxLength:100},t.showBarOnly()&&(n.showValue="0"),t.showBorder()&&(n.border="1"),!1===t.gradient()&&(n.gradient="0"),!1===t.useNegativeFillColor()&&(n.negativeBarColorSameAsPositive="1"),t.useNegativeBorderColor()&&(n.negativeBarBorderColorSameAsPositive="0"),n.direction=1===t.dataBarDirection()?"rightToLeft":"leftToRight",1===(i=t.axisPosition())?n.axisPosition="middle":2===i&&(n.axisPosition="none"),i=[],(o=t.color())&&i.push(St(o)),o=t.minType(),a=t.minValue(),u=t.maxType(),f=t.maxValue(),T(o)||5===o?i.push({n_:"cfvo",type:"autoMin"}):T(a)||zr(a)?i.push({n_:"cfvo",type:On(o)}):i.push({n_:"cfvo",type:On(o),c_:[{n_:"f",c_:[pt(bt(a))]}]}),T(u)||7===u?i.push({n_:"cfvo",type:"autoMax"}):T(f)||zr(f)?i.push({n_:"cfvo",type:On(u)}):i.push({n_:"cfvo",type:On(u),c_:[{n_:"f",c_:[pt(bt(f))]}]}),t.showBorder()&&t.borderColor()&&i.push(St(t.borderColor(),k,"borderColor")),T(t.negativeFillColor())?i.push(St("red",k,"negativeFillColor")):i.push(St(t.negativeFillColor(),k,"negativeFillColor")),T(t.negativeBorderColor())?i.push(St("black",k,"negativeBorderColor")):i.push(St(t.negativeBorderColor(),k,"negativeBorderColor")),2!==t.axisPosition()&&i.push(St(t.axisColor(),k,"axisColor")),n.c_=i,e.c_=[n],r.c_=[e,{n_:"sqref",c_:[It(t.ranges())]}],r},s.prototype.wh=function(t,r,n,e,i){var o=this;if(!rn(e)||!o.aX())return r?o.IJ():o.oX()},s.prototype.uX=function(t,r){var n,e,i,i,e,i,n=this,e=Nn(t),i=In(t);n.color(i[0]),i=e[0],e=e[1],n.minType(En(i.type)),n.minValue(Gn(i.val)),n.maxType(En(e.type)),n.maxValue(Gn(e.val)),n.priority(+t.priority),n.ranges(r),i=mt(t,"dataBar"),T(i.showValue)||n.showBarOnly(!d(i.showValue,!0)),t.c_[1]&&t.c_[1].n_===j&&(n.rJ=hn(t.c_[1]))},s.prototype.sX=function(t,r){var n,e,i,o,a,a,i,o,a,i,o,a,n=this,e=mt(t,"dataBar");T(e.showValue)||n.showBarOnly(!d(e.showValue,!0)),T(e.border)||n.showBorder(d(e.border,!1)),T(e.gradient)||n.gradient(d(e.gradient,!0)),T(e.direction)||n.dataBarDirection("rightToLeft"===e.direction?1:0),T(e.axisPosition)||n.axisPosition(+Cr[e.axisPosition]),T(e.negativeBarColorSameAsPositive)||n.useNegativeFillColor(!d(e.negativeBarColorSameAsPositive,!1)),T(e.negativeBarBorderColorSameAsPositive)||n.useNegativeBorderColor(!d(e.negativeBarBorderColorSameAsPositive,!0)),2===(i=gt(e,"cfvo")).length&&(n.minType(En(i[0].type)),o=gt(i[0],"f"),a=Wn(i[0],o&&o[0]),T(a)||n.minValue(Gn(a)),n.maxType(En(i[1].type)),o=gt(i[1],"f"),a=Wn(i[1],o&&o[0]),T(a)||n.maxValue(Gn(a))),(i=mt(e,"fillColor"))&&n.color(wt(i)),(o=mt(e,"borderColor"))&&n.borderColor(wt(o)),(a=mt(e,"negativeFillColor"))&&n.negativeFillColor(wt(a)),(i=mt(e,"negativeBorderColor"))&&n.negativeBorderColor(wt(i)),(o=mt(e,"axisColor"))&&n.axisColor(wt(o)),(a=In(t))&&0<a.length&&n.color(a[0]),n.ranges(r)},s.prototype.yh=function(t,r,n,e,i,o){var a=this;i?a.sX(t,r):a.uX(t,r),a.initCondition(e)},qr=s,b.DataBarRule=qr,e={gradient:r("gradient",!0),color:r("color",C),showBorder:r("showBorder",!1),borderColor:r("borderColor","black"),dataBarDirection:r("dataBarDirection",0),negativeFillColor:r("negativeFillColor","red"),useNegativeFillColor:r("useNegativeFillColor",!0),negativeBorderColor:r("negativeBorderColor","black"),useNegativeBorderColor:r("useNegativeBorderColor",!1),axisPosition:r("axisPosition",0),axisColor:r("axisColor","black"),showBarOnly:r("showBarOnly",!1)},p.extend(qr.prototype,e),Dr=vn,b.IconCriterion=Dr,Fr=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],M(R,Hr=Br),R.prototype.xX=function(t){var r=this;r.iconSetType(t,!1),r.iconSetType()>=vr.threeArrowsColored&&r.iconSetType()<=vr.threeSymbolsUncircled?(r.hJ=[],r.hJ[0]=new Dr(!0,dr.percent,33),r.hJ[1]=new Dr(!0,dr.percent,67),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2}):r.iconSetType()>=vr.fourArrowsColored&&r.iconSetType()<=vr.fourTrafficLights?(r.hJ=[],r.hJ[0]=new Dr(!0,dr.percent,25),r.hJ[1]=new Dr(!0,dr.percent,50),r.hJ[2]=new Dr(!0,dr.percent,75),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2},r.iJ[3]={iconSetType:t,iconIndex:3}):r.iconSetType()>=vr.fiveArrowsColored&&r.iconSetType()<=vr.fiveBoxes?(r.hJ=[],r.hJ[0]=new Dr(!0,dr.percent,20),r.hJ[1]=new Dr(!0,dr.percent,40),r.hJ[2]=new Dr(!0,dr.percent,60),r.hJ[3]=new Dr(!0,dr.percent,80),r.iJ=[],r.iJ[0]={iconSetType:t,iconIndex:0},r.iJ[1]={iconSetType:t,iconIndex:1},r.iJ[2]={iconSetType:t,iconIndex:2},r.iJ[3]={iconSetType:t,iconIndex:3},r.iJ[4]={iconSetType:t,iconIndex:4}):r.iconSetType()>vr.fiveBoxes&&(r.hJ=[],r.iJ=[])},R.prototype.Hc=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xX(t)},R.prototype.NX=function(t){var r=J(this.hJ)+1;return this.reverseIconOrder()&&2<r?r-1-t:t},R.prototype.bX=function(t,r,n,e){var i,o,i=this,o=i.hJ[e];if(o)switch(o.iconValueType){case dr.formula:case dr.number:return i.dX(t,r,n,o.iconValue);case dr.percent:return i.gX(t,r,n,o.iconValue);case dr.percentile:return i.pX(t,r,n,o.iconValue);default:return C}},R.prototype.evaluate=function(t,r,n,e){var i,o,a,u,o,e,f,s,l,c,h,s,a,e,i=this,o=e;if(T(o))return C;if(a={},u=at(e,!0)&&"boolean"!=typeof o&&ft(e,a)?a.value:NaN,isNaN(u))return C;if(o=0,e=i.iconSetType(),f=i.hJ,e>=vr.fiveArrowsColored?o=5:e>=vr.fourArrowsColored?o=4:e>=vr.threeArrowsColored&&(o=3),!f)return 0;for(l=0,c=o-1;0<c;c--)if(c<J(f)+1&&(s=f[c-1],!T(s&&s.iconValue))&&(h=i.bX(t,r,n,c-1),!T(h))&&(s=s.isGreaterThanOrEqualTo?h<=u:h<u,u<Number.MAX_VALUE)&&s){l=c;break}return a=i.NX(l),(e=i.iJ)?{iconSetType:e[a]?e[a].iconSetType:vr.noIcons,iconIndex:e[a]?e[a].iconIndex:0,showIconOnly:i.showIconOnly()}:{iconSetType:vr.noIcons,iconIndex:0,showIconOnly:i.showIconOnly()}},R.prototype.reset=function(){var t=this;t.ranges(C),t.condition(C),t.style(C),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,C),t.hJ=C,t.stopIfTrue(!1),t.priority(1),t.minColor(C),t.minValue(C),t.minType(5),t.midColor(C),t.midValue(C),t.midType(C),t.maxColor(C),t.maxValue(C),t.maxType(7),t.iJ=C},R.prototype.icons=function(t){return 1===arguments.length&&(this.iJ=t),this.iJ},R.prototype.iconCriteria=function(){return this.hJ},R.prototype.toJSON=function(t){return Kt.call(this,t,Fr)},R.prototype.fromJSON=function(t,r,n){Zt.call(this,r,Fr,t,n),this.initCondition(r)},R.prototype.aX=function(){var t,r,n,e,t,r=this.hJ;if(r&&0<r.length)for(n=0;n<r.length;n++)if(e=r[n].iconValue,At(e))return!0},R.prototype.oX=function(){var t,r,n,e,i,o,a,u,t=this,r={n_:P,sqref:It(t.ranges())};for(r.pivot=T(t.pivotTableName)?k:"1",n=t.iconSetType(),T(n)&&(n=0),r.c_=[{n_:"cfRule",type:"iconSet",priority:t.priority()?""+t.priority():"1",c_:[{n_:"iconSet",iconSet:Bn(n),reverse:t.reverseIconOrder()?"1":k,showValue:t.showIconOnly()?"0":k,c_:[{n_:"cfvo",type:"percent",val:"0"}]}]}],e=r.c_[0].c_[0].c_,o=0,a=(i=t.hJ).length;o<a;o++)u=i[o],e.push({n_:"cfvo",type:qn(u.iconValueType),val:pt(bt(u.iconValue)),gte:!1===u.isGreaterThanOrEqualTo?"0":k});return t.rJ&&r.c_[0].c_.push({n_:j,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[t.rJ]}]}]}),r},R.prototype.IJ=function(){var t,r,n,e,n,i,n,o,a,u,f,s,l,c,h,v,d,h,h,t=this,r={n_:"conditionalFormatting",r_:[2]};for(r.pivot=T(t.pivotTableName)?k:"1",e={n_:"cfRule",type:"iconSet",id:n=Ut()},t.rJ=n,T(t.priority())||(e.priority=t.priority()),i={n_:"iconSet",iconSet:Bn(n=t.iconSetType())},(n=wn(n,t))&&(i.custom="1"),t.showIconOnly()&&(i.showValue="0"),!t.reverseIconOrder()||n||(i.reverse="1"),o=[{n_:"cfvo",type:"percent",c_:[{n_:"f",c_:["0"]}]}],a=t.hJ,n&&t.reverseIconOrder()&&(a=a.concat([]).reverse()),u=0;u<a.length;u++)!(s={n_:"cfvo",type:qn((f=a[u]).iconValueType),c_:[{n_:"f",c_:[pt(Ct(f.iconValue))]}]})===f.isGreaterThanOrEqualTo&&(s.gte="0"),o.push(s);for(l=t.iJ,c=0;c<l.length;c++)h={n_:"cfIcon",iconSet:Bn((h=$n(v=(h=l[c]).iconSetType,d=h.iconIndex)).iconSetType),iconId:h.iconIndex},o.push(h);return i.c_=o,e.c_=[i],r.c_=[e,{n_:"sqref",c_:[It(t.ranges())]}],r},R.prototype.wh=function(t,r,n,e,i){var o=this;if(!rn(e)||!o.aX())return T(o.condition())&&o.initCondition(),r?o.IJ():o.oX()},R.prototype.uX=function(t,r){var n,e,i,o,a,u,f,s,n=this,e=t.c_[0];if(e)for(i=Mn(e.iconSet||"3TrafficLights1"),n.showIconOnly(!d(e.showValue,!0)),n.reverseIconOrder(d(e.reverse,!1)),n.iconSetType(i),n.ranges(r),a=1,u=(o=Nn(t)).length;a<u;a++)f=n.hJ[a-1],s=o[a],f?(s.type&&(f.iconValueType=Dn(s.type)),T(s.val)||(f.iconValue=Kr(s.val)),T(s.gte)||(f.isGreaterThanOrEqualTo=d(s.gte))):(f=new Dr(d(s.gte),Dn(s.type),Kr(s.val)),n.hJ[a-1]=f);t.c_[1]&&t.c_[1].n_===j&&(n.rJ=hn(t.c_[1]))},R.prototype.sX=function(t,r){var n,e,i,o,a,u,f,s,l,c,h,v,n=this,e=mt(t,"iconSet");for(n.iconSetType(Mn(e.iconSet)),n.ranges(r),T(e.showValue)||n.showIconOnly(!d(e.showValue,!0)),T(e.reverse)||n.reverseIconOrder(d(e.reverse,!1)),o=1,a=(i=gt(e,"cfvo")).length;o<a;o++)u=n.hJ[o-1],s=(f=i[o]).val,T(s)&&(l=mt(f,"f"),s=U(l&&l.c_&&l.c_[0])),u?(f.type&&(u.iconValueType=Dn(f.type)),T(s)||(u.iconValue=0===s?"=0":Kr(s)),T(f.gte)||(u.isGreaterThanOrEqualTo=d(f.gte))):(u=new Dr(d(f.gte),Dn(f.type),Kr(s)),n.hJ[o-1]=u);for(o=0,a=(c=gt(e,"cfIcon")).length;o<a;o++)h=n.iJ[o],v=c[o],h&&(T(v.iconSet)||(h.iconSetType=Mn(v.iconSet)),T(v.iconId)||(h.iconIndex=+v.iconId));T(t.priority)||n.priority(+t.priority)},R.prototype.yh=function(t,r,n,e,i,o){var a=this;i?a.sX(t,r):a.uX(t,r),a.initCondition(e)},R.getIcon=function(t,r){return C},R.kX=function(t,r,n,e,i,o,a){var u;a.getState(r)?(u=a.getImage(r),t.drawImage(u,n,e,i,o)):a.addImage(r)},R.paintIconSet=function(t,r,n,e,i,o,a,u,f,s){var l,a,c,h,v,d,u,c,h=m.W.Lge(a,1).fontSize,v=2,d=2,l=n+2;if(r.showIconOnly&&(1===a.hAlign?l=n+i/2-h/2:2===a.hAlign&&(l=n+i-2-h-2)),a=1===a.vAlign?e+o/2-h/2:2===a.vAlign?e+o-2-u/2-h/2:e+2+u/2-h/2,r.iconSetType!==vr.noIcons)if((u=R.getIcon(r.iconSetType,r.iconIndex))&&"string"===p.getType(u)&&s)try{R.kX(t,u,l,a,h,h,s)}catch(t){}else en(t,r,l,a,h,n,e,i,o)},Gr=R,b.IconSetRule=Gr,e={iconSetType:r("iconSetType",vr.threeArrowsColored,function(t){this.xX(t)}),reverseIconOrder:r("reverseIconOrder",!1),showIconOnly:r("showIconOnly",!1)},p.extend(Gr.prototype,e),Lr=["ruleType","state","style","priority","stopIfTrue","ranges"],M(A,Yr=n),A.prototype.JJ=function(t,r){var n,e,i,o,n=this.ranges();if(n)for(e=J(n),i=void 0,o=0;o<e;o++)if((i=n[o]).contains(t,r))return o;return-1},A.prototype.zT=function(t){return-1<t},A.prototype.getExpected=function(t){void 0===t&&(t=0);var r=this.style();return $t(r)?r[t]:r},A.prototype.isRow=function(){var t,r,t=this,r=t.ruleType();return T(t.DX)&&(r===_.rowStateRule?t.DX=!0:r===_.columnStateRule&&(t.DX=!1)),this.DX},A.prototype.isStateRule=function(){return!0},A.prototype._X=function(){var t,r,t,t=this,r=t.state(),t=t.ranges();return(0,b.aJ)(y.stateCondition,yr.contains,r,k,k,k,t)},A.prototype.rowStateRuleCreateCondition=function(){return this._X()},A.prototype.columnStateRuleCreateCondition=function(){return this._X()},A.prototype.createCondition=function(){return this[_[this.ruleType()]+"CreateCondition"]()},A.prototype.EX=function(t){var r;return A.StatesPriority.indexOf(this.state())<A.StatesPriority.indexOf(t.state())},A.prototype.fromJSON=function(t,r,n){var e=Lr;T(t.condition)||(e=Lr.concat(["condition"])),Zt.call(this,r,e,t,n),this.initCondition(r)},A.prototype.toJSON=function(t){var r,t,n,r=this;return T(r.condition())&&this.initCondition(),t=Kt.call(r,t,Lr),(n=r.ruleType())===_.conditionRuleBase&&(t.condition=r.condition().toJSON()),t},A.StatesPriority=[4,m.RowColumnStates.invalid,m.RowColumnStates.dirty,m.RowColumnStates.invalidFormula,m.RowColumnStates.inserted,256,m.RowColumnStates.selected,m.RowColumnStates.active,m.RowColumnStates.hover,m.RowColumnStates.edit],Wr=A,(b.StateRule=Wr).prototype.state=r("state",C),E.prototype.getUsedRange=function(){var t,r,n,e,i,o,a,u,f,s,t,r=this.getRules(),n={};if(r)for(e=void 0,i=0,o=r;i<o.length;i++)for(u=0,f=e=(a=o[i]).ranges();u<f.length;u++)s=f[u],L(n,W(s));return n},E.prototype.L0=function(){this.eJ=C},E.prototype.getRule=function(t){return this.qK[t]},E.prototype.count=function(t){var r,n,e,i,o;if(T(t))return J(this.qK);for(e=n=0,i=(r=this.qK).length;e<i;e++)Xr((o=r[e]).nT)===t&&n++;return n},E.prototype.qve=function(t){var r,n,e,i;if(T(t))return 0<J(this.qK);for(n=0,e=(r=this.qK).length;n<e;n++)if(Xr((i=r[n]).nT)===t)return!0;return!1},E.prototype.jX=function(){return this.qK},E.prototype.GJ=function(t){for(var r,n,e,i,o,r=[],n=this.eJ,e=J(t),i=0;i<e;i++)o=n.JS(t[i]),r.push(o);return r},E.prototype.OX=function(t){for(var r,n,e,i,o,a,r=[],n=this.eJ,e=0,i=J(t);e<i;e++)o=t[e],a=new qt(o.row,o.col,Q(o),H(o)),0===o.row&&Q(o)===n.getRowCount()&&(a.row=-1),0===o.col&&H(o)===n.getColumnCount()&&(a.col=-1),r.push(a);return r},E.prototype.Ige=function(t,r,n){var e,n,n,e=this;-1!==n&&(n=e.xge[n])&&Cn(t,n),-1!==r&&(n=e.Nge[r])&&Cn(t,n),0<e.kge.length&&Cn(t,e.kge)},E.prototype._ge=function(t,r,n,e,i){var o,a,u,f,s,l,c,h,v,d,o=this,a=o.xge,u=o.Nge,f=function(t){var r=t.indexOf(i);-1<r&&t.splice(r,1)};if(-1===t&&-1!==r&&0<e)for(l=(s=r)+e;s<l;s++)(c=a[s])&&(i?f(c):delete a[s]);if(-1!==t&&-1===r&&0<n)for(l=(h=t)+n;h<l;h++)(v=u[h])&&(i?f(v):delete u[h]);if(-1===t&&-1===r)if(i){for(d in f(o.kge),a)a.hasOwnProperty(d)&&f(a[d]);for(d in u)u.hasOwnProperty(d)&&f(u[d])}else o.kge=[],o.xge={},o.Nge={}},E.prototype.sE=function(){this.tJ={},this.kge=[],this.Nge={},this.xge={}},E.prototype.C8=function(){if(this.nJ&&(this.sE(),this.qK))for(var t=0;t<J(this.qK);t++)this.fE(this.qK[t])},E.prototype.TJ=function(){this.nJ&&(this.tJ={})},E.prototype.fE=function(t){var r,n,e,i,o,a,u,f,s,l,c,h,v,d,y,C,b,p,g,S,w,m,k,T,x,_;if(this.nJ){for(n=(r=this).tJ,u=t.ranges(),f=[],s=0;s<J(u);s++)if(c=-1===(l=u[s]).col,(h=-1===l.row)&&c)r.kge.push(t);else if(h){if(0<l.colCount)for(d=(v=l.col)+l.colCount;v<d;v++)(y=r.xge[v])||(r.xge[v]=y=[]),y.push(t)}else if(c){if(0<l.rowCount)for(d=(C=l.row)+l.rowCount;C<d;C++)(b=r.Nge[C])||(r.Nge[C]=b=[]),b.push(t)}else f.push(l);for(f=r.GJ(f),g=(p=r.eJ).getRowCount(),S=p.getColumnCount(),s=0;s<J(f);s++)for(w=(l=f[s]).row,m=l.col,g<=w+(k=Q(l))-1&&(k=g-w),S<=m+(T=H(l))-1&&(T=S-m),x=0;x<k;x++)for((e=n[o=x+w])||(n[o]=e=[]),_=0;_<T;_++)(i=e[a=_+m])||(e[a]=i=[]),i.push(t)}},E.prototype.RX=function(t){var r,n,e,i,o,a,u,f,s,l,c,h,v,d,y,C;if(this.nJ){for(r=t.ranges(),n=0,e=J(r);n<e;n++)i=r[n],this._ge(i.row,i.col,i.rowCount,i.colCount,t);for(o=this.tJ,l=this.GJ(t.ranges()),c=0;c<J(l);c++)for(h=l[c],v=0;v<Q(h);v++)if(a=o[f=v+h.row])for(d=0;d<H(h);d++)if(u=a[s=d+h.col]){for(y=[],C=0;C<J(u);C++)u[C]!==t&&y.push(u[C]);0===J(y)&&(y=k),a[s]=y}}},E.prototype.BX=function(t,r,n,e){var i,o,a,u,f,s;if(this.nJ)for(this._ge(t,r,n,e),-1===r&&(r=0,e=this.eJ.getColumnCount()),-1===t&&(t=0,n=this.eJ.getRowCount()),a=this.tJ,f=0;f<n;f++)if(u=a[i=f+t])for(s=0;s<e;s++)u[o=s+r]=k},E.prototype.LX=function(r,n){var t,e,i,o,t=this.qK;return-1===r&&-1===n?B([],t,!0):(e=this.eJ,-(o=i=1)===r?i=e.getRowCount():-1===n&&(o=e.getColumnCount()),t.filter(function(t){return t.intersects(r,n,i,o)}))},E.prototype.addSpecificTextRule=function(t,r,n,e){var e=new w(2,e,n,t,C,C,r);return this.addRule(e)},E.prototype.addCellValueRule=function(t,r,n,e,i){var i=new w(1,i,e,t,dn(r),dn(n));return this.addRule(i)},E.prototype.addDateOccurringRule=function(t,r,n){var n=new w(4,n,r,C,C,C,C,C,t);return this.addRule(n)},E.prototype.addFormulaRule=function(t,r,n){var n=new w(3,n,r,C,C,C,C,t);return this.addRule(n)},E.prototype.addTop10Rule=function(t,r,n,e){var e=new w(5,e,n,C,C,C,C,C,t,r);return this.addRule(e)},E.prototype.addUniqueRule=function(t,r){var r=new w(6,r,t);return this.addRule(r)},E.prototype.addDuplicateRule=function(t,r){var r=new w(7,r,t);return this.addRule(r)},E.prototype.addAverageRule=function(t,r,n){var n=new w(8,n,r,C,C,C,C,C,t);return this.addRule(n)},E.prototype.add3ScaleRule=function(t,r,n,e,i,o,a,u,f,s){var t,t=0===arguments.length?new Br(11):new Br(11,t,r,n,e,i,o,a,u,f,s);return this.addRule(t)},E.prototype.add2ScaleRule=function(t,r,n,e,i,o,a){var t,t=0===arguments.length?new Br(10):new Br(10,t,r,n,C,C,C,e,i,o,a);return this.addRule(t)},E.prototype.addDataBarRule=function(t,r,n,e,i,o){var t,t=0===arguments.length?new qr:new qr(t,r,n,e,i,o);return this.addRule(t)},E.prototype.addIconSetRule=function(t,r){var t=new Gr(t,r);return this.addRule(t)},E.prototype.addRowStateRule=function(t,r,n){var e,t,e=this,t=new Wr(_.rowStateRule,t,r,n);return e.addRule(t)},E.prototype.addColumnStateRule=function(t,r,n){var e,t,e=this,t=new Wr(_.columnStateRule,t,r,n);return e.addRule(t)},E.prototype.addRule=function(t){var r,n,e,i,o,a,a,a,i,o,u,f,s,l,c,h,r=this,n=r.eJ;if(n){if(!t)throw new Error(Jt().Exp_RuleIsNull);for(o=i=void 0,(e=t.ranges())&&(i=(a=Et(e)).r,o=a.c,t.ranges(e.slice(0))),(a=(a=t.getExpected())&&a.formatter)&&"string"==typeof a&&n.SL(i||0,o||0,a),t.isStateRule()&&(i=t.state(),o=t.isRow(),n._1)&&n._1.enableState(i,o),n.Ut.vJ(),u=1,f=void 0,s=J(r.qK),f=0;f<s;f++)h=(c=(l=r.qK[f])._ps).priority||1,c.priority=h+1,t.isStateRule()&&l.isStateRule()&&t.EX(l)&&(u=rt(u,c.priority),--c.priority);return t.priority(u),r.qK.push(t),E.et(n,"onRuleAdded",{ranges:e}),t.context(n),r.fE(t),n.Ut.vJ(!0),n.zw(),t}},E.prototype.removeRule=function(t){var r,n,e,i,i,o,e,a,u,f,s,r=this,n=r.eJ,e=n.parent;if(n){if(t&&((i=(i=t.getExpected())&&i.formatter)&&"string"==typeof i&&e.bp[i]&&e.o3(i),n.Ut.vJ(),r.RX(t),Gt(r.qK,t),n.Ut.vJ(!0),E.et(n,"onRuleRemoved",{priority:t.priority(),ranges:t.ranges()}),t.isStateRule())){for(o=t.state(),e=t.isRow(),a=!1,u=0,f=r.qK;u<f.length;u++)if((s=f[u]).isStateRule()&&s.state()===o){a=!0;break}a||n._1.disableState(o,e)}n.zw()}},E.prototype.FX=function(t,r,n,e,i){var o,a,u,f,r,e,n,i,s,l,l,l,r;return t.intersect(r,n,e,i)?(o=t.row,a=t.row+Q(t)-1,u=t.col,f=t.col+H(t)-1,e=(r=r)+e-1,i=(n=n)+i-1,s=[],-1!==o&&-1!==u&&-1!==r&&-1!==n&&(0<n-u&&(l=$(o,u,Q(t),n-u),s.push(l)),0<f-i&&(l=$(o,1+i,Q(t),f-i),s.push(l)),0<r-o&&(l=$(o,rt(n,u),r-o,tt(i,f)-rt(n,u)+1),s.push(l)),0<a-e)&&(r=$(1+e,rt(n,u),a-e,tt(i,f)-rt(n,u)+1),s.push(r)),0<J(s)?s:C):[t]},E.prototype.removeRuleByRange=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,v,d,y,C,b,i=this,o=i.eJ;if(o){if(a=[],i.qK)for(o.Ut.vJ(),i.BX(t,r,n,e),u=0,f=J(i.qK);u<f;u++)if(s=i.qK[u],E.et(o,"onRuleRemoved",{ranges:[new qt(t,r,n,e)]}),s&&s.ranges()&&s.intersects(t,r,n,e))if(o.pivotTables&&s.pivotTableName)(l=o.pivotTables.get(s.pivotTableName)).tqt(s,t,r,n,e);else{for(c=[],h=i.GJ(s.ranges()),v=0,d=J(h);v<d;v++)(y=i.FX(h[v],t,r,n,e))&&(c=c.concat(y));0<J(c)?s.ranges(i.OX(c)):a.push(s)}for(C=0,b=J(a);C<b;C++)Gt(i.qK,a[C]);o.Ut.vJ(!0),o.zw()}},E.prototype.clearRule=function(){var t,r,n,e,i,o,a,a,u,f,t=this,r=t.eJ,n=r.parent;if(r){for(e=t.qK,r.Ut.vJ(),i=0;i<e.length;i++)a=(a=(o=e[i]).getExpected())&&a.formatter,E.et(r,"onRuleRemoved",{ranges:o.ranges()}),a&&"string"==typeof a&&n.bp[a]&&n.o3(a);if(r.pivotTables)for(u=r.pivotTables.all(),i=0;i<u.length;i++)(f=u[i]).iqt();t.qK.length=0,t.C8(),r.Ut.vJ(!0),r.zw()}},E.prototype.getRules=function(t,n){var r,e,i,e,o,a,r=this,e=r.qK;return 0===arguments.length||0===J(e)?e:(t=t===k?-1:t,n=n===k?-1:n,i=[],r.nJ?(e=r.tJ,a=void 0,-1!==t&&-1!==n?(a=e[t])&&(o=a[n],Cn(i,o)):-1===t?p.each(e,function(t,r){o=r[n],Cn(i,o)}):(a=e[t])&&p.each(a,function(t,r){Cn(i,r)}),r.Ige(i,t,n),i):r.LX(t,n))},E.prototype.containsRule=function(t,r,n){return!(!t||!Ft.OS(this.qK,t))&&t.contains(r,n)},E.prototype.PX=function(t,r){var n,e,i,o,a,i,i,i,u,f,s,l,n=this,e=n.eJ;if(e){if(!t)throw new Error(Jt().Exp_RuleIsNull);for(a=o=void 0,(i=t.ranges())&&(o=(i=Et(i)).r,a=i.c),(i=(i=t.getExpected())&&i.formatter)&&"string"==typeof i&&e.SL(o||0,a||0,i),e.Ut.vJ(),u=0,f=J(n.qK);u<f;u++)r<=(l=(s=n.qK[u]._ps).priority||1)&&(s.priority=l+1);return t.priority(r),(n.qK[r]=t).context(e),n.fE(t),e.zw(),t}},E.prototype.qJ=function(t,r,n){var e,i,o,a,u,f,s,l,e=this,i,o=e.eJ.Ut,a=e.qK,u=J(a),f=!1;for(o.vJ(),s=0;s<u;s++)(l=a[s])&&l.qJ(t,r,n)&&(f=!0);f&&e.C8()},E.prototype.$J=function(t,r,n,e,i,o){var a,u,f,s,a=this;if(a.qK&&a.eJ)for(u=J(a.qK),f=0;f<u;f++)(s=a.qK[f])&&(n?s.JO(t,r,e,i,o):s.qO(t,r,e,i,o));a.C8()},E.prototype.JO=function(t,r,n,e,i){this.$J(t,r,!0,n,e,i)},E.prototype.qO=function(t,r,n,e,i){this.$J(t,r,!1,n,e,i)},E.prototype.tX=function(t,r,n,e,i){var o,a,u,f,o=this;if(o.qK&&o.eJ)for(u=(a=J(o.qK))-1;0<=u;u--)(f=o.qK[u])&&(n?f.xP(t,r,e,i):f.NP(t,r,e,i),f.ranges().length<=0)&&(o.RX(f),o.qK.splice(u,1));o.C8()},E.prototype.xP=function(t,r,n,e){this.tX(t,r,!0,n,e)},E.prototype.NP=function(t,r,n,e){this.tX(t,r,!1,n,e)},E.prototype.dl=function(){var t,r,n,e,t=this.qK;if(t!==C&&0<J(t))for(n=0,e=J(t);n<e;n++)(r=t[n]).dl&&r.dl()},E.prototype.jB=function(t,r,q,n,e,i,o,D,a,u){var a,f,s,l,c,F,h,v,d,G,y,C,b,p,g,S,w,m,k,T,f,x,_,T,L,N,I,R,W,A,R,A,j,E,O,P,M,B,V,M,U,V,M,V,M,s=[],l=[],c=[],F=[],h=[],v=this,d=v.eJ,G=!a&&d.o5();for(u&&(i=(a=[o,i])[0],o=a[1]),-1===t&&(n=t=0,i=d.getRowCount()),-1===r&&(e=r=0,o=d.getColumnCount()),y=0;y<i;y++)for(C=0;C<o;C++)for(b=v.getRules(t+y,r+C),p=0;p<J(b);p++)if(S=(g=b[p]).ranges(),!g.isStateRule()){for(w=[],m=0;m<J(S);m++)k=S[m],f=(T=d.JS(k)).row,x=T.col,_=Q(T),T=H(T),(L=Lt(c,k)<=-1||-1<Lt(c,k)&&Lt(F,g)<=-1)&&k.contains(t+y,r+C)&&(c.push(k),F.push(g),N=$(n+y,e+C,-1,-1),(N=u?$(n+C,e+y,-1,-1):N).rowCount=i+t<=f+_?i-y:t<f?_:f+_-t,N.colCount=o+r<=x+T?o-C:r<x?T:x+T-r,u&&(f=[N.colCount,N.rowCount],N.rowCount=f[0],N.colCount=f[1]),v===q&&k.containsRange(N)||w.push(N),D)&&jn(h,N,g);0<w.length&&((I=s.indexOf(g))<0?(G&&(w=v.GX(w)),s.push(g),l.push(w)):(G&&(W=R=void 0,A=l[I][0].row,j=l[I][0].col,R=(E=w[0]).row-A,W=E.col-j,A=d.lT(A,R,!(R=A=void 0)),R=d.lT(j,W),E.row+=A,E.col+=R,w=v.GX(w)),l[I]=l[I].concat(w)))}for(O=0,P=s.length;O<P;O++)V=(B=v.pJ((M=s[O]).toJSON(),M.context())).ranges(),Pn(h,M,B),B.ranges(l[O]),(M=B.D5)&&(U=1===d.parent.options.referenceStyle,V=Et(V),M=Y.formulaToExpression(d,M,V.r,V.c,U),V=Et(l[O]),M=Y.expressionToFormula(d,M,V.r,V.c,U),B.formula(M)),q.addRule(B);return v.C8(),h},E.prototype.GX=function(t){var r,n,t,e,i,o,a,u,f,s,l,c,h,r,n=this.eJ,e=[];if(0<t.length){for(i=(t=t[0]).row,o=t.col,a=t.rowCount,u=t.colCount,a+=n.lT(i,a,!0),u+=n.lT(o,u),f=[],s=void 0,l=0;l<u;l++)0===l?s=new qt(i,o,1,1):0!==n.getColumnWidth(o+l)?s.colCount++:(f.push(s),l=n.O5(o+l-1)-1-o,s=new qt(i,o+l+1,1,0));for(f.push(s),c=0;c<a;c++)if(0!==c)if(0!==n.getRowHeight(i+c))for(h=0;h<f.length;h++)f[h].rowCount++;else for(e=e.concat(gn(f)),c=n.j5(i+c-1)-1-i,h=0;h<f.length;h++)f[h].rowCount=0,f[h].row=i+c+1;e=e.concat(f)}return e},E.prototype.OB=function(t,r,n,e,i,o){var a,u,f,s,l,c,h,v,d,y,C,b,p,g,S,w,m,k,T,x,_,N,I,R,A,N,E,a=this,u=a.eJ,f=u.getRowCount(3),s=u.getColumnCount(3);for(-1===t&&(t=0,n=u.getRowCount()),-1===r&&(r=0,e=u.getColumnCount()),l=[],c=[],h=0,v=i;h<v.length;h++)for(y=0,C=(d=v[h]).ranges;y<C.length;y++)Sn(l,b=C[y])||l.push(b),c.push({range:b,rule:d.rule});for(p=0;p<n;p++)for(g=0;g<e;g++)for(S=a.getRules(t+p,r+g),w=0;w<J(S);w++)if(k=(m=S[w]).ranges(),T=[],!m.isStateRule()){for(x=[],_=0;_<J(k);_++)b=k[_],I=(N=u.JS(b)).row,R=N.col,A=Q(N),N=H(N),Un(i,b,m)||Lt(T,b)<=-1&&b.contains(t+p,r+g)&&(T.push(b),I<t&&x.push($(I,R,t-I,N)),R<r&&x.push($(rt(t,I),R,tt(t+n,I+A)-rt(t,I),r-R)),r+e<R+N&&x.push($(rt(t,I),r+e,tt(t+n,I+A)-rt(t,I),R+N-(r+e))),t+n<I+A)&&x.push($(t+n,R,I+A-(t+n),N));u&&u.Ut.vJ(),a.UX(u,T,c,k,f,s,o,new qt(t,r,n,e),m),0<(E=k.concat(x)).length?(m.XJ(),m.ranges(E)):a.removeRule(m)}a.C8()},E.prototype.UX=function(t,r,n,e,i,o,a,u,f){for(var s,l,c,h,v,d,d,y,s=0;s<J(r);s++){if(c=[l=r[s]],a)for(h=0;h<J(n);h++)v=n[h].range,d=n[h].rule,l.intersect(v.row,v.col,v.rowCount,v.colCount)&&(c=c.concat(t.BR(l,v,i,o)),d===f)&&(d=u.getIntersect(v,i,o))&&e.push(d);for(y=0;y<J(c);y++)Gt(e,c[y])}},E.prototype._e=function(t,r,n,e,i,o,a,u){var f,s,l,c,h,v,h,v,d,c,f=16,s=!1,l=!1,c=u.sheet,h=u.row,v=u.col,d=c.zoom(),c=this.U(c,h,v,r,u.sheetArea),h=c&&c.iconSet,v=c&&c.dataBar;return(v||h)&&(t.save(),t.beginPath(),v&&(qr.paintDataBar(t,v,n,e,i,o),s=v.showBarOnly),h&&((i<(f=parseInt(16*d+"",10))||o<f)&&(t.rect(n,e,i,o),t.clip(),t.beginPath()),Gr.paintIconSet(t,h,n,e,i,o,a,u.lineHeight,d,u.imageLoader),l=h.showIconOnly),t.restore()),s||l},E.prototype.U=function(t,r,n,e,i){var i,o,a,u,f,s,l,c,h,v,d,y;if(T(i)||3===i){if(i=this,f=(o=t.Jt).yl(r,n))a=f.i,u=f.d;else{if(s=i.getRules(r,n),0<(l=J(s))){for(s.sort(function(t,r){return t.priority()-r.priority()}),h=c=C,y=d=v=void 0,y=0;y<l&&(!c||!h);y++)(v=s[y])&&(g(v,qr)&&(c=v),g(v,Gr))&&(h=v);if(c||h)for(c=h=C,y=0;y<l&&(!c||!h)&&!((v=s[y])&&(!c&&g(v,qr)&&(c=v),!h&&g(v,Gr)&&(h=v),v.stopIfTrue())&&(d=v.evaluate(t,r,n,e)));y++);c&&(u=c.evaluate(t,r,n,e)),h&&(a=h.evaluate(t,r,n,e))}o.Ml(r,n,u,a)}return{dataBar:u,iconSet:a}}},E.prototype.O=function(t,r,n){var e,i,o;if(T(n)||3===n)for(e=this.getRules(t,r),i=0,o=J(e);i<o;i++)if(e[i]instanceof Gr)return!0;return!1},E.prototype.toJSON=function(t){for(var r,n,e,r=[],n=0;n<J(this.qK);n++)e=this.qK[n],r.push(e?e.toJSON(t):C);return 0===J(r)?k:{rules:r}},E.prototype.fromJSON=function(t,r,n,e){var i,o,a,u,u;if(t&&(i=t.rules)){for(this.qK=[],o=J(i),a=0;a<o;a++)(u=i[a]).pivot&&e||(u=this.pJ(u,r,n))&&this.qK.push(u);this.nJ=!bn(i),this.C8()}},E.prototype.xJ=function(t,r,n,e,i,o){var a,u;switch(t.type){case"dataBar":u=new qr;break;case"iconSet":u=new Gr;break;case"colorScale":u=new Br;break;default:u=new w}return u&&u.yh(t,r,n,e,o,void 0,i),u},E.prototype.pJ=function(t,r,n){var e,i,o,o,t,e=C;return t&&(o=(i=this.HX())[t.ruleType])&&(e=new o).fromJSON(t,r,n),e.isStateRule()&&(o=e.state(),t=e.isRow(),r)&&r._1&&r._1.enableState(o,t),e},E.prototype.HX=function(){var t;return this.$K||((t={})[0]=w,t[1]=w,t[2]=w,t[3]=w,t[4]=w,t[5]=w,t[6]=w,t[7]=w,t[8]=w,t[9]=Br,t[10]=Br,t[11]=Br,t[12]=qr,t[13]=Gr,t[14]=Wr,t[15]=Wr,this.$K=t),this.$K},E.prototype.NJ=function(t,r,n,e,i,o){var a,u,f,s,l,c,h,v,d,y,C,b,p,b,g,g,S;if(t&&t.c_&&!(t.c_.length<=0))for(f=0,s=(a=t.c_).length;f<s;f++)for(l=a[f],c=m.NodeHelper.ur(l.pivot),v=void 0,(h=mt(l,"sqref"))&&(v=Nt(h.c_[0]),o)&&m.Util.Ao(n,v,!0,r),d=gt(l,"cfRule"),y=0;y<d.length;y++)p=void 0,"dataBar"===(b=(C=d[y]).type)?(p=Ln(e,C.id))||(p=new qr,this.qK.push(p)):"iconSet"===b?(p=Ln(e,C.id))||(p=new Gr,this.qK.push(p)):(g=Vn(b)===_.specificTextRule,((b="expression"===b||"cellIs"===b)||g)&&(!u&&i.lossless&&((g=new m.SimpleSharedStrings).yh(i.lossless.sharedColors),(S=new m.SimpleSharedStrings).yh(i.lossless.commonSharedStrings),(u=new m.SharedDxfs(g,S)).rv(i.lossless.sharedDxfs)),p=b?new w(3):new w(_.specificTextRule,v,void 0),this.qK.push(p))),p&&(p.pivot=c,p.yh(C,v,r.styleManager,n,!0,u),T(C.priority)||p.priority(+C.priority))},E.prototype.bL=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,v,c,h,i=this;if(i&&i.qve(e)&&(o=i.getRules(r,n),a=J(o),u=void 0,f=C,0<a))for(e=Xr(e),o.sort(function(t,r){return t.priority()-r.priority()}),s=0;s<a&&!((u=o[s])&&e===Xr(u.nT)&&(l=i.eJ,u.isScaleRule()?10!==u.ruleType()&&11!==u.ruleType()||(f=u.evaluate(l,r,n,l.getValue(r,n,e)))&&(t=t||new Mt).backColor===k&&(t.backColor=f):u.isStateRule()?(c=u.state(),h=u.isRow(),v=u.ranges(),c=l._1.getState(r,n,c,h,v,e),(f=u.evaluate(l,r,n,c))&&(t=t||new Mt,h=l.NMi&&e===m.SheetArea.colHeader,t.h5(f,!1,1,k,h))):(f=u.evaluate(l,r,n,l.getValue(r,n,e)))&&(t=t||new Mt).h5(f,!1,1),u.stopIfTrue())&&f);s++);return t},E.prototype.wL=function(t,r,n,e){var i,o,a,u,f,s,l,c,h,h,v,d,v,y,i={yL:!1},o=this;if(o&&o.qve(e)&&(a=o.getRules(t,r),u=J(a),f=void 0,s=C,0<u))for(e=Xr(e),a.sort(function(t,r){return t.priority()-r.priority()}),l=0;l<u;l++)if((f=a[l])&&e===Xr(f.nT)){if(c=o.eJ,f.isScaleRule()){if(h=f.ruleType(),"backColor"===n&&(10===h||11===h)&&(s=f.evaluate(c,t,r,c.getValue(t,r,e)))){i.Y6=s,i.yL=!0;break}}else if(f.isStateRule()){if(h=f.state(),v=f.isRow(),d=f.ranges(),v=c._1.getState(t,r,h,v,d,e),!((y=f.style())&&void 0!==yn(n,y,d,t,r)||f.stopIfTrue()))continue;if((s=f.evaluate(c,t,r,v))&&s[n]!==k){i.Y6=s[n],i.yL=!0;break}}else{if(!((y=f.style())&&void 0!==y[n]||f.stopIfTrue()))continue;if((s=f.evaluate(c,t,r,c.getValue(t,r,e)))&&s[n]!==k){i.Y6=s[n],i.yL=!0;break}}if(f.stopIfTrue()&&s)break}return i},jr=E,t(b.ConditionalFormats=jr)},"./dist/plugins/conditional/conditional.ns.js":function(t,r,n){Object.defineProperty(r,"__esModule",{value:!0}),r.SR=void 0;var n=n("./dist/plugins/conditional/conditional.res.en.js");r.SR={en:n}},"./dist/plugins/conditional/conditional.res.en.js":function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Exp_NotSupported=r.Exp_RuleIsNull=void 0,r.Exp_RuleIsNull="The argument 'rule' is null",r.Exp_NotSupported="Not supported exception"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(q,t){var f,s,l,c,r,n,e,i,o,a,u,h,v,d,d,y,C,b;function p(t,r,n,e,i){t.beginPath(),t.moveTo(r,n),t.lineTo(r+e,n),t.lineTo(r+e,n+i),t.lineTo(r,n+i),t.lineTo(r,n),t.closePath(),t.fill(),t.stroke()}function g(t,r,n,e,i,o){var e,i;t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,e=b[r][n].fillColor.split(" "),i=s(.2*o),t.fillStyle=e[0],p(t,i+.5,3*i+.5,i,2*i),t.fillStyle=e[1],p(t,2*i+.5,2*i+.5,i,3*i),t.fillStyle=e[2],p(t,3*i+.5,i+.5,i,4*i),t.fillStyle=e[3],p(t,4*i+.5,.5,i,5*i)}function S(t,r,n,e,i,o){var e,i;t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,e=b[r][n].fillColor.split(" "),t.fillStyle=b[r][n].strokeStyle,i=s(o/2),t.fillStyle=e[0],p(t,.5,.5,i,i),t.fillStyle=e[1],p(t,i+.5,.5,i,i),t.fillStyle=e[2],p(t,.5,i+.5,i,i),t.fillStyle=e[3],p(t,i+.5,i+.5,i,i)}function w(t,r,n,e,i,o){t.translate(e+o/2,i+o/2),t.strokeStyle=b[r][n].strokeStyle,4===n?(t.beginPath(),t.arc(0,0,o/2,0,b[r][n].rotate),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,b[r][n].rotate),t.closePath(),t.stroke()):0===n?(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,o/2,0,b[r][n].rotate),t.stroke(),t.closePath()):1===n?(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-f,0),t.lineTo(0,0),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.arc(0,0,o/2,0,2*f),t.stroke()):2===n?(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-f,.5*f),t.moveTo(0,0),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.arc(0,0,o/2,0,2*f),t.stroke()):3===n&&(t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-o/2),t.arc(0,0,o/2,.5*-f,f),t.lineTo(0,0),t.fillStyle=b[r][n].fillColor,t.fill(),t.arc(0,0,o/2,0,2*f),t.stroke(),t.closePath())}function m(t,r,n){t.moveTo(l(.1*f)*r,-c(.1*f)*r),t.lineTo(l(.3*f)*n,-c(.3*f)*n),t.lineTo(0*r,-c(.5*f)*r),t.lineTo(l(.7*f)*n,-c(.7*f)*n),t.lineTo(l(.9*f)*r,-c(.9*f)*r),t.lineTo(l(1.1*f)*n,-c(1.1*f)*n),t.lineTo(l(1.3*f)*r,-c(1.3*f)*r),t.lineTo(0*n,-c(1.5*f)*n),t.lineTo(l(1.7*f)*r,-c(1.7*f)*r),t.lineTo(l(1.9*f)*n,-c(1.9*f)*n),t.lineTo(l(.1*f)*r,-c(.1*f)*r)}function k(t,r,n,e,i,o){var a,o,u,a,o=o/1.8,u=o/2.5;t.translate(o+e,o+i),t.strokeStyle="#727272",t.fillStyle=b[r][n].fillColor,t.beginPath(),2===n&&(t.strokeStyle="#727272",m(t,o,u),t.fill(),t.stroke(),t.strokeStyle=b[r][n].strokeStyle,m(t,o,u),t.stroke(),t.closePath()),0===n&&(t.fillStyle="white",m(t,o,u),t.fill(),t.stroke(),t.strokeStyle="#727272",m(t,o,u),t.stroke(),t.closePath()),1===n&&(t.strokeStyle=b[r][n].fillColor,t.moveTo(0*o,-c(.5*f)*o),t.lineTo(l(.7*f)*u,-c(.7*f)*u),t.lineTo(l(.9*f)*o,-c(.9*f)*o),t.lineTo(l(1.1*f)*u,-c(1.1*f)*u),t.lineTo(l(1.3*f)*o,-c(1.3*f)*o),t.lineTo(0*u,-c(1.5*f)*u),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*o,-c(.5*f)*o),t.lineTo(-l(.7*f)*u,-c(.7*f)*u),t.lineTo(-l(.9*f)*o,-c(.9*f)*o),t.lineTo(-l(1.1*f)*u,-c(1.1*f)*u),t.lineTo(-l(1.3*f)*o,-c(1.3*f)*o),t.lineTo(0*u,-c(1.5*f)*u),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",m(t,o,u),t.stroke(),t.closePath())}function T(t,r,n,e,i,o){2===n?N(t,r,n,e,i,o):0===n?x(t,r,n,e,i,o):1===n&&_(t,r,n,e,i,o)}function x(t,r,n,e,i,o){var o,a,o=o,a=s(o/2);t.translate(e+a,i+a),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),t.arc(0,0,a,0,2*f),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,a,0,2*f),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.375*-o,.1*-o,.75*o,.2*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.1*-o,.375*-o,.2*o,.75*o),t.closePath(),t.fill(),t.stroke()}function _(t,r,n,e,i,o){var o=o;t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*f),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(.5*o,.5*o,.5*o,0,2*f),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(o/3,.1*o),t.lineTo(o/1.5,.1*o),t.lineTo(.625*o,.6*o),t.lineTo(.375*o,.6*o),t.lineTo(o/3,.1*o),t.moveTo(.625*o,.85*o),t.arc(.5*o,.8*o,.15*o,0,2*f),t.fillStyle=b[r][n].fillColor2,t.fill(),t.closePath()}function N(t,r,n,e,i,o){var o=o;t.translate(s(e+o/2),s(o/2+i)),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),t.arc(0,0,o/2,0,2*f),t.closePath(),t.fillStyle=b[r][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,o/2,0,2*f),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.325*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[r][n].fillColor2,t.fillRect(.325*-o,.05*o,.65*o,.2*o),t.closePath(),t.fill(),t.stroke()}function I(t,r,n,e,i,o){2===n?E(t,r,n,e,i,o):0===n?A(t,r,n,e,i,o):1===n&&R(t,r,n,e,i,o)}function R(t,r,n,e,i,o){var o=o;t.translate(e,i),t.beginPath(),t.strokeStyle=b[r][n].strokeStyle,t.moveTo(o/3,.5),t.lineTo(o/1.5,.5),t.lineTo(.625*o,.65*o),t.lineTo(.375*o,.65*o),t.lineTo(o/3,.5),t.moveTo(.65*o,.85*o),t.arc(.5*o,.85*o,.15*o,0,2*f),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function A(t,r,n,e,i,o){var o,e,i,o=o;t.translate(s(e+o/2),s(i+o/2)),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),V(t,-(e=.5*o),-(i=.075*o)),B(t,-e,i),B(t,-i,i),B(t,-i,e),B(t,i,e),B(t,i,i),B(t,e,i),B(t,e,-i),B(t,i,-i),B(t,i,-e),B(t,-i,-e),B(t,-i,-i),B(t,-e,-i),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function E(t,r,n,e,i,o){var o=o;t.translate(s(e+o/2),s(i+o/2)),t.strokeStyle=b[r][n].strokeStyle,t.rotate(b[r][n].rotate),t.beginPath(),t.fillStyle=b[r][n].fillColor,t.fillRect(.375*-o,.25*-o,.2*o,.5*o),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[r][n].fillColor,t.fillRect(.375*-o,.05*o,.75*o,.2*o),t.closePath(),t.fill(),t.stroke()}function O(t,r,n,e,i,o){var o=1.2*o;t.translate(e,i),t.strokeStyle=v,t.fillStyle=v,p(t,s(.2*o)+.5,.5,s(.06*o),s(.8*o)),t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),V(t,.4*o,.5),B(t,.4*o,.5*o),B(t,.9*o,.25*o),B(t,.4*o,.5),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function D(t,r,n,e,i,o){(2===n?M:1===n?W:L)(t,r,n,e,i,o)}function F(t,r,n,e,i,o){var o=s(o);t.strokeStyle=b[r][n].strokeStyle,t.fillStyle=b[r][n].fillColor,p(t,e+.5,i+.5,o,o),t.beginPath(),t.arc(o/2+e+.5,o/2+i+.5,.375*o,0,2*f),t.fillStyle=b[r][n].fillColor2,t.fill(),t.stroke()}function M(t,r,n,e,i,o){var o=o;t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),t.arc(o/2+e,o/2+i,o/2,0,2*f),t.fillStyle=b[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function G(t,r,n,e,i,o){1===n?j(t,r,n,e,i,o):0===n?P(t,r,n,e,i,o):2===n&&U(t,r,n,e,i,o)}function L(t,r,n,e,i,o){var o=o;t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),t.translate(e+s(o/2),i+s(o/2)),t.beginPath(),V(t,0,-o/2),B(t,o/2,0),B(t,0,o/2),B(t,-o/2,0),B(t,0,-o/2),t.fillStyle=b[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function W(t,r,n,e,i,o){var o=s(o);t.translate(e,i),t.strokeStyle=b[r][n].strokeStyle,t.beginPath(),V(t,0,o),B(t,o/2,o-o/2*Math.sqrt(3)),B(t,o,o),B(t,0,o),t.fillStyle=b[r][n].fillColor,t.closePath(),t.fill(),t.stroke()}function j(t,r,n,e,i,o){var o=o;t.strokeStyle=b[r][n].strokeStyle,t.translate(s(o/2+e),s(o/2+i)),t.beginPath(),t.rotate(b[r][n].rotate),V(t,-o/2,-o/5.4),B(t,o/2,-o/5.4),B(t,o/2,o/5.4),B(t,-o/2,o/5.4),B(t,-o/2,-o/5.4),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function P(t,r,n,e,i,o){t.strokeStyle=b[r][n].strokeStyle;var o=o;t.translate(s(o/2+e),s(o/2+i)),t.beginPath(),V(t,-o/2,-o/3),B(t,o/2,-o/3),B(t,0,o/3),B(t,-o/2,-o/3),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function U(t,r,n,e,i,o){t.strokeStyle=b[r][n].strokeStyle;var o=o;t.translate(s(o/2+e),s(o/2+i)),t.beginPath(),V(t,-o/2,o/3),B(t,o/2,o/3),B(t,0,-o/3),B(t,-o/2,o/3),t.fillStyle=b[r][n].fillColor,t.fill(),t.stroke()}function $(t,r,n,e,i,o){var o,a,e,i,u,o,o=o/3.5,a=b[r].length-1;t.strokeStyle=b[r][a-n].strokeStyle,t.translate(s(1.75*o+e),s(1.75*o+i)),t.rotate(b[r][a-n].rotate),t.beginPath(),e=.25*o,i=1.25*o,V(t,-(u=.75*o),-(o=1.75*o)),B(t,e,-o),B(t,e,e),B(t,i,-u),B(t,i,e),B(t,-e,o),B(t,-o,e),B(t,-o,-u),B(t,-u,e),B(t,-u,-o),t.fillStyle=b[r][a-n].fillColor,t.fill(),t.stroke()}function B(t,r,n){t.lineTo(s(r)+.5,s(n)+.5)}function V(t,r,n){t.moveTo(s(r)+.5,s(n)+.5)}Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=t.drawIconTypeIsTwo=t.drawCircle=t.drawTrafficLight=t.drawIconTypeIsSen=t.drawFlag=t.drawIconTypeIsNine=t.drawIconTypeIsEight=t.drawStar=t.drawSector=t.drawMagicCube=t.drawSignal=void 0,f=Math.PI,s=Math.round,l=Math.cos,c=Math.sin,b=[[{strokeStyle:n="#326f5b",fillColor:e="#76a797",fillColor2:"",rotate:f},{strokeStyle:i="#A4802b",fillColor:o="#EAC282",fillColor2:"",rotate:-.5*f},{strokeStyle:a="#9E381C",fillColor:u="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:h="#646262",fillColor:v="#808080",fillColor2:"",rotate:f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.5*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:f}],[{strokeStyle:i,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:d="#303030",fillColor:y="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:d,fillColor:y,fillColor2:"#eac282",rotate:0},{strokeStyle:d,fillColor:y,fillColor2:e,rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:a,fillColor:u,fillColor2:"white",rotate:.25*f},{strokeStyle:i,fillColor:o,fillColor2:"white",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"white",rotate:-.25*f}],[{strokeStyle:a,fillColor:u,fillColor2:"",rotate:.25*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:-.25*f}],[{strokeStyle:n,fillColor:e,fillColor2:"",rotate:f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.75*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.25*f},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:v,fillColor2:"",rotate:f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.75*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.25*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:0}],[{strokeStyle:d="#353535",fillColor:y,fillColor2:"",rotate:0},{strokeStyle:v,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:C="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:r="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:y,fillColor2:"",rotate:0},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:0},{strokeStyle:n,fillColor:e,fillColor2:"",rotate:0}],[{strokeStyle:n,fillColor:e,fillColor2:"",rotate:f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.75*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.5*f},{strokeStyle:i,fillColor:o,fillColor2:"",rotate:-.25*f},{strokeStyle:a,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:v,fillColor2:"",rotate:f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.75*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.5*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:-.25*f},{strokeStyle:h,fillColor:v,fillColor2:"",rotate:0}],[{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:r,fillColor2:"",rotate:0}],[{strokeStyle:y,fillColor:y,fillColor2:"",rotate:2*f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:.5*f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:.5*f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:+f},{strokeStyle:y,fillColor:y,fillColor2:"",rotate:2*f}],[{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:r,fillColor2:"",rotate:0}]],t.drawSignal=g,t.drawMagicCube=S,t.drawSector=w,t.drawStar=k,t.drawIconTypeIsEight=T,t.drawIconTypeIsNine=I,t.drawFlag=O,t.drawIconTypeIsSen=D,t.drawTrafficLight=F,t.drawCircle=M,t.drawIconTypeIsTwo=G,t.drawArrows=$},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},e={},t=i("./dist/plugins/conditional/conditional.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).ConditionalFormatting=t}();
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t=function(n){return GC.Spread.Common.CultureManager.getCultureInfo(n).predefinedFormats.Time},r=new Set(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],t("zh-cn"),!0),t("ja-jp"),!0),t("ko-kr"),!0),t("en-us"),!0)),i=function(){function t(){}return t.execute=function(n){t.resetCursorResource(n);t.resetCulture(n);t.handleExcelSpecialDate(n);t.overrideSomeFunction(n)},t.overrideSomeFunction=function(t){var e=t.Spread.Sheets.Commands.editCell.execute,u,f,i;t.Spread.Sheets.Commands.editCell.execute=function(n,i){var f,o,s,h,u=n.getActiveSheetTab();return t.Spread.Report&&u&&u instanceof t.Spread.Report.ReportSheet&&r.has((o=(f=u===null||u===void 0?void 0:u.getSheet())===null||f===void 0?void 0:f.getCell(i.row,i.col))===null||o===void 0?void 0:o.formatter())&&((h=(s=i.newValue)===null||s===void 0?void 0:s.toString())===null||h===void 0?void 0:h.startsWith("01/00/1900"))&&(i.newValue=i.newValue.replace("01/00/1900","12/30/1899")),e.apply(this,arguments)};t.Spread.Sheets.Worksheet.prototype.recalcAll=function(){return null};t.Spread.Sheets.Worksheet.prototype.suspendCalcService=function(){return null};t.Spread.Sheets.Worksheet.prototype.resumeCalcService=function(){return null};u=t.Spread.Sheets.Worksheet.prototype.setValue;t.Spread.Sheets.Worksheet.prototype.setValue=function(n,t,i,r){u.call(this,n,t,i,r,!0)};t.Spread.CalcEngine.supportRowColumnFormula=!0;f=t.Spread.Sheets.Worksheet.prototype.clearSelection;t.Spread.Sheets.Worksheet.prototype.clearSelection=function(){f.call(this,2)};i=t.Spread.CalcEngine.CalcService.prototype.evaluateParsedFormula;t.Spread.CalcEngine.CalcService.prototype.evaluateParsedFormula=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t[0]instanceof n.FormulaReferCalcSource&&(t[4]=!1),i.call.apply(i,__spreadArray([this],t,!1))}},t.handleExcelSpecialDate=function(n){n.Spread.Common.HandleExcelSpecialDate=function(n,i){var r=n.valueOf();switch(i){case 0:return r>=t.date18991230&&r<t.date19000101?1900:n.getFullYear();case 1:return r>=t.date18991230&&r<t.date19000101?0:r>=t.date19000131&&r<t.date19000201?1:n.getMonth();case 2:return r>=t.date18991230&&r<t.date18991231?0:r>=t.date18991231&&r<t.date19000101||r>=t.date19000131&&r<t.date19000201?1:r>=t.date19000101&&r<t.date19000131||r>=t.date19000201&&r<t.date19000301?n.getDate()+1:n.getDate();default:return}}},t.resetCursorResource=function(t){t.Spread.Sheets.CursorResource.ResizeCol="url('"+n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/vresize.cur'),pointer";t.Spread.Sheets.CursorResource.ResizeRow="url('"+n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/hresize.cur'),pointer";t.Spread.Sheets.CursorResource.ResizeHiddenCol="col-resize";t.Spread.Sheets.CursorResource.ResizeHiddenRow="row-resize"},t.resetCulture=function(t){var i;if(t===void 0&&(t=GC),t===GC)switch(n.RS.Culture){case"cn":t.Spread.Common.CultureManager.culture("zh-cn");i=t.Spread.Common.CultureManager.getCultureInfo("zh-cn");i.DateTimeFormat.preselectedFormatters=["yyyyMd","yyyyMdd","yyyyMMd","yyyyMMdd"];break;case"ja":t.Spread.Common.CultureManager.culture("ja-jp");break;case"kr":t.Spread.Common.CultureManager.culture("ko-kr");break;case"en":t.Spread.Common.CultureManager.culture("en-us")}else{var r=GC.Spread.Common.CultureManager.culture(),u=GC.Spread.Common.CultureManager.getResources(),i=GC.Spread.Common.CultureManager.getCultureInfo(r);t.Spread.Common.CultureManager.addCultureInfo(r,i,u);t.Spread.Common.CultureManager.culture(r)}},t.date18991230=new Date(1899,11,30).valueOf(),t.date19000101=new Date(1900,0,1).valueOf(),t.date19000131=new Date(1900,0,31).valueOf(),t.date19000201=new Date(1900,1,1).valueOf(),t.date19000301=new Date(1900,2,1).valueOf(),t.date18991231=new Date(1899,11,31).valueOf(),t}();n.SpreadJSModifier=i;i.execute(GC)})(Forguncy||(Forguncy={}))
;