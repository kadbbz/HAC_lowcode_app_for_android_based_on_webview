(function(n){"use strict";function d(n){function l(n,r){var a,v,y,o,e,c,h,u,f=this;if(!(f instanceof l))return new l(n,r);if(r==null){if(n&&n._isBigNumber===!0){f.s=n.s;!n.c||n.e>ft?f.c=f.e=null:n.e<ct?f.c=[f.e=0]:(f.e=n.e,f.c=n.c.slice());return}if((c=typeof n=="number")&&n*0==0){if(f.s=1/n<0?(n=-n,-1):1,n===~~n){for(o=0,e=n;e>=10;e/=10,o++);o>ft?f.c=f.e=null:(f.e=o,f.c=[n]);return}u=String(n)}else{if(!g.test(u=String(n)))return pt(f,u,c);f.s=u.charCodeAt(0)==45?(u=u.slice(1),-1):1}(o=u.indexOf("."))>-1&&(u=u.replace(".",""));(e=u.search(/e/i))>0?(o<0&&(o=e),o+=+u.slice(e+1),u=u.substring(0,e)):o<0&&(o=u.length)}else{if(i(r,2,at.length,"Base"),r==10)return f=new l(n),it(f,ut+f.e+1,tt);if(u=String(n),c=typeof n=="number"){if(n*0!=0)return pt(f,u,c,r);if(f.s=1/n<0?(u=u.slice(1),-1):1,l.DEBUG&&u.replace(/^0\.0*|\./,"").length>15)throw Error(k+n);}else f.s=u.charCodeAt(0)===45?(u=u.slice(1),-1):1;for(a=at.slice(0,r),o=e=0,h=u.length;e<h;e++)if(a.indexOf(v=u.charAt(e))<0){if(v=="."){if(e>o){o=h;continue}}else if(!y&&(u==u.toUpperCase()&&(u=u.toLowerCase())||u==u.toLowerCase()&&(u=u.toUpperCase()))){y=!0;e=-1;o=0;continue}return pt(f,String(n),c,r)}c=!1;u=wt(u,r,10,f.s);(o=u.indexOf("."))>-1?u=u.replace(".",""):o=u.length}for(e=0;u.charCodeAt(e)===48;e++);for(h=u.length;u.charCodeAt(--h)===48;);if(u=u.slice(e,++h)){if(h-=e,c&&l.DEBUG&&h>15&&(n>w||n!==s(n)))throw Error(k+f.s*n);if((o=o-e-1)>ft)f.c=f.e=null;else if(o<ct)f.c=[f.e=0];else{if(f.e=o,f.c=[],e=(o+1)%t,o<0&&(e+=t),e<h){for(e&&f.c.push(+u.slice(0,e)),h-=t;e<h;)f.c.push(+u.slice(e,e+=t));e=t-(u=u.slice(e)).length}else e-=h;for(;e--;u+="0");f.c.push(+u)}}else f.c=[f.e=0]}function kt(n,t,r,u){var a,o,s,c,f;if(r==null?r=tt:i(r,0,8),!n.c)return n.toString();if(a=n.c[0],s=n.e,t==null)f=e(n.c),f=u==1||u==2&&(s<=ht||s>=vt)?y(f,s):h(f,s,"0");else if(n=it(new l(n),t,r),o=n.e,f=e(n.c),c=f.length,u==1||u==2&&(t<=o||o<=ht)){for(;c<t;f+="0",c++);f=y(f,o)}else if(t-=s,f=h(f,o,"0"),o+1>c){if(--t>0)for(f+=".";t--;f+="0");}else if(t+=o-c,t>0)for(o+1==c&&(f+=".");t--;f+="0");return n.s<0&&a?"-"+f:f}function gt(n,t){for(var i,u=1,r=new l(n[0]);u<n.length;u++)if(i=new l(n[u]),i.s)t.call(r,i)&&(r=i);else{r=i;break}return r}function dt(n,i,r){for(var f=1,u=i.length;!i[--u];i.pop());for(u=i[0];u>=10;u/=10,f++);return(r=f+r*t-1)>ft?n.c=n.e=null:r<ct?n.c=[n.e=0]:(n.e=r,n.c=i),n}function it(n,i,r,u){var a,h,e,c,v,l,w,f=n.c,y=b;if(f){n:{for(a=1,c=f[0];c>=10;c/=10,a++);if(h=i-a,h<0)h+=t,e=i,v=f[l=0],w=v/y[a-e-1]%10|0;else if(l=p((h+1)/t),l>=f.length)if(u){for(;f.length<=l;f.push(0));v=w=0;a=1;h%=t;e=h-t+1}else break n;else{for(v=c=f[l],a=1;c>=10;c/=10,a++);h%=t;e=h-t+a;w=e<0?0:v/y[a-e-1]%10|0}if(u=u||i<0||f[l+1]!=null||(e<0?v:v%y[a-e-1]),u=r<4?(w||u)&&(r==0||r==(n.s<0?3:2)):w>5||w==5&&(r==4||u||r==6&&(h>0?e>0?v/y[a-e]:0:f[l-1])%10&1||r==(n.s<0?8:7)),i<1||!f[0])return f.length=0,u?(i-=n.e+1,f[0]=y[(t-i%t)%t],n.e=-i||0):f[0]=n.e=0,n;if(h==0?(f.length=l,c=1,l--):(f.length=l+1,c=y[t-h],f[l]=e>0?s(v/y[a-e]%y[e])*c:0),u)for(;;)if(l==0){for(h=1,e=f[0];e>=10;e/=10,h++);for(e=f[0]+=c,c=1;e>=10;e/=10,c++);h!=c&&(n.e++,f[0]==o&&(f[0]=1));break}else{if(f[l]+=c,f[l]!=o)break;f[l--]=0;c=1}for(h=f.length;f[--h]===0;f.pop());}n.e>ft?n.c=n.e=null:n.e<ct&&(n.c=[n.e=0])}return n}function et(n){var t,i=n.e;return i===null?n.toString():(t=e(n.c),t=i<=ht||i>=vt?y(t,i):h(t,i,"0"),n.s<0?"-"+t:t)}var rt,wt,pt,nt=l.prototype={constructor:l,toString:null,valueOf:null},st=new l(1),ut=20,tt=4,ht=-7,vt=21,ct=-1e7,ft=1e7,lt=!1,yt=1,ot=0,bt={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},at="0123456789abcdefghijklmnopqrstuvwxyz";return l.clone=d,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.EUCLID=9,l.config=l.set=function(n){var f,t;if(n!=null)if(typeof n=="object"){if(n.hasOwnProperty(f="DECIMAL_PLACES")&&(t=n[f],i(t,0,r,f),ut=t),n.hasOwnProperty(f="ROUNDING_MODE")&&(t=n[f],i(t,0,8,f),tt=t),n.hasOwnProperty(f="EXPONENTIAL_AT")&&(t=n[f],t&&t.pop?(i(t[0],-r,0,f),i(t[1],0,r,f),ht=t[0],vt=t[1]):(i(t,-r,r,f),ht=-(vt=t<0?-t:t))),n.hasOwnProperty(f="RANGE"))if(t=n[f],t&&t.pop)i(t[0],-r,-1,f),i(t[1],1,r,f),ct=t[0],ft=t[1];else if(i(t,-r,r,f),t)ct=-(ft=t<0?-t:t);else throw Error(u+f+" cannot be zero: "+t);if(n.hasOwnProperty(f="CRYPTO"))if(t=n[f],t===!!t)if(t)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))lt=t;else{lt=!t;throw Error(u+"crypto unavailable");}else lt=t;else throw Error(u+f+" not true or false: "+t);if(n.hasOwnProperty(f="MODULO_MODE")&&(t=n[f],i(t,0,9,f),yt=t),n.hasOwnProperty(f="POW_PRECISION")&&(t=n[f],i(t,0,r,f),ot=t),n.hasOwnProperty(f="FORMAT"))if(t=n[f],typeof t=="object")bt=t;else throw Error(u+f+" not an object: "+t);if(n.hasOwnProperty(f="ALPHABET"))if(t=n[f],typeof t!="string"||/^.?$|[+\-.\s]|(.).*\1/.test(t))throw Error(u+f+" invalid: "+t);else at=t}else throw Error(u+"Object expected: "+n);return{DECIMAL_PLACES:ut,ROUNDING_MODE:tt,EXPONENTIAL_AT:[ht,vt],RANGE:[ct,ft],CRYPTO:lt,MODULO_MODE:yt,POW_PRECISION:ot,FORMAT:bt,ALPHABET:at}},l.isBigNumber=function(n){if(!n||n._isBigNumber!==!0)return!1;if(!l.DEBUG)return!0;var i,h,f=n.c,e=n.e,c=n.s;n:if({}.toString.call(f)=="[object Array]"){if((c===1||c===-1)&&e>=-r&&e<=r&&e===s(e)){if(f[0]===0){if(e===0&&f.length===1)return!0;break n}if(i=(e+1)%t,i<1&&(i+=t),String(f[0]).length==i){for(i=0;i<f.length;i++)if(h=f[i],h<0||h>=o||h!==s(h))break n;if(h!==0)return!0}}}else if(f===null&&e===null&&(c===null||c===1||c===-1))return!0;throw Error(u+"Invalid BigNumber: "+n);},l.maximum=l.max=function(){return gt(arguments,nt.lt)},l.minimum=l.min=function(){return gt(arguments,nt.gt)},l.random=function(){var n=9007199254740992,f=Math.random()*n&2097151?function(){return s(Math.random()*n)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(n){var h,y,v,a,o,e=0,c=[],w=new l(st);if(n==null?n=ut:i(n,0,r),a=p(n/t),lt)if(crypto.getRandomValues){for(h=crypto.getRandomValues(new Uint32Array(a*=2));e<a;)o=h[e]*131072+(h[e+1]>>>11),o>=9e15?(y=crypto.getRandomValues(new Uint32Array(2)),h[e]=y[0],h[e+1]=y[1]):(c.push(o%1e14),e+=2);e=a/2}else if(crypto.randomBytes){for(h=crypto.randomBytes(a*=7);e<a;)o=(h[e]&31)*281474976710656+h[e+1]*1099511627776+h[e+2]*4294967296+h[e+3]*16777216+(h[e+4]<<16)+(h[e+5]<<8)+h[e+6],o>=9e15?crypto.randomBytes(7).copy(h,e):(c.push(o%1e14),e+=7);e=a/7}else{lt=!1;throw Error(u+"crypto unavailable");}if(!lt)for(;e<a;)o=f(),o<9e15&&(c[e++]=o%1e14);for(a=c[--e],n%=t,a&&n&&(o=b[t-n],c[e]=s(a/o)*o);c[e]===0;c.pop(),e--);if(e<0)c=[v=0];else{for(v=-1;c[0]===0;c.splice(0,1),v-=t);for(e=1,o=c[0];o>=10;o/=10,e++);e<t&&(v-=t-e)}return w.e=v,w.c=c,w}}(),l.sum=function(){for(var i=1,n=arguments,t=new l(n[0]);i<n.length;)t=t.plus(n[i++]);return t},wt=function(){function t(n,t,i,r){for(var f,u=[0],e,o=0,s=n.length;o<s;){for(e=u.length;e--;u[e]*=t);for(u[0]+=r.indexOf(n.charAt(o++)),f=0;f<u.length;f++)u[f]>i-1&&(u[f+1]==null&&(u[f+1]=0),u[f+1]+=u[f]/i|0,u[f]%=i)}return u.reverse()}var n="0123456789";return function(i,r,u,f,o){var p,a,b,v,w,c,s,d,y=i.indexOf("."),g=ut,k=tt;for(y>=0&&(v=ot,ot=0,i=i.replace(".",""),d=new l(r),c=d.pow(i.length-y),ot=v,d.c=t(h(e(c.c),c.e,"0"),10,u,n),d.e=d.c.length),s=t(i,r,u,o?(p=at,n):(p=n,at)),b=v=s.length;s[--v]==0;s.pop());if(!s[0])return p.charAt(0);if(y<0?--b:(c.c=s,c.e=b,c.s=f,c=rt(c,d,g,k,u),s=c.c,w=c.r,b=c.e),a=b+g+1,y=s[a],v=u/2,w=w||a<0||s[a+1]!=null,w=k<4?(y!=null||w)&&(k==0||k==(c.s<0?3:2)):y>v||y==v&&(k==4||w||k==6&&s[a-1]&1||k==(c.s<0?8:7)),a<1||!s[0])i=w?h(p.charAt(1),-g,p.charAt(0)):p.charAt(0);else{if(s.length=a,w)for(--u;++s[--a]>u;)s[a]=0,a||(++b,s=[1].concat(s));for(v=s.length;!s[--v];);for(y=0,i="";y<=v;i+=p.charAt(s[y++]));i=h(i,b,p.charAt(0))}return i}}(),rt=function(){function n(n,t,i){var f,e,o,s,r=0,u=n.length,h=t%c,l=t/c|0;for(n=n.slice();u--;)o=n[u]%c,s=n[u]/c|0,f=l*o+s*h,e=h*o+f%c*c+r,r=(e/i|0)+(f/c|0)+l*s,n[u]=e%i;return r&&(n=[r].concat(n)),n}function i(n,t,i,r){var u,f;if(i!=r)f=i>r?1:-1;else for(u=f=0;u<i;u++)if(n[u]!=t[u]){f=n[u]>t[u]?1:-1;break}return f}function r(n,t,i,r){for(var u=0;i--;)n[i]-=u,u=n[i]<t[i]?1:0,n[i]=u*r+n[i]-t[i];for(;!n[0]&&n.length>1;n.splice(0,1));}return function(u,e,h,c,a){var ut,ft,d,st,p,g,tt,rt,et,y,w,ht,ct,lt,at,nt,ot,k=u.s==e.s?1:-1,b=u.c,v=e.c;if(!b||!b[0]||!v||!v[0])return new l(!u.s||!e.s||(b?v&&b[0]==v[0]:!v)?NaN:b&&b[0]==0||!v?k*0:k/0);for(rt=new l(k),et=rt.c=[],ft=u.e-e.e,k=h+ft+1,a||(a=o,ft=f(u.e/t)-f(e.e/t),k=k/t|0),d=0;v[d]==(b[d]||0);d++);if(v[d]>(b[d]||0)&&ft--,k<0)et.push(1),st=!0;else{for(lt=b.length,nt=v.length,d=0,k+=2,p=s(a/(v[0]+1)),p>1&&(v=n(v,p,a),b=n(b,p,a),nt=v.length,lt=b.length),ct=nt,y=b.slice(0,nt),w=y.length;w<nt;y[w++]=0);ot=v.slice();ot=[0].concat(ot);at=v[0];v[1]>=a/2&&at++;do{if(p=0,ut=i(v,y,nt,w),ut<0){if(ht=y[0],nt!=w&&(ht=ht*a+(y[1]||0)),p=s(ht/at),p>1)for(p>=a&&(p=a-1),g=n(v,p,a),tt=g.length,w=y.length;i(g,y,tt,w)==1;)p--,r(g,nt<tt?ot:v,tt,a),tt=g.length,ut=1;else p==0&&(ut=p=1),g=v.slice(),tt=g.length;if(tt<w&&(g=[0].concat(g)),r(y,g,w,a),w=y.length,ut==-1)while(i(v,y,nt,w)<1)p++,r(y,nt<w?ot:v,w,a),w=y.length}else ut===0&&(p++,y=[0]);et[d++]=p;y[0]?y[w++]=b[ct]||0:(y=[b[ct]],w=1)}while((ct++<lt||y[0]!=null)&&k--);st=y[0]!=null;et[0]||et.splice(0,1)}if(a==o){for(d=1,k=et[0];k>=10;k/=10,d++);it(rt,h+(rt.e=d+ft*t-1)+1,c,st)}else rt.e=ft,rt.r=+st;return rt}}(),pt=function(){var n=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,i=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,f=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(e,o,s,h){var a,c=s?o:o.replace(f,"");if(r.test(c))e.s=isNaN(c)?null:c<0?-1:1;else{if(!s&&(c=c.replace(n,function(n,t,i){return a=(i=i.toLowerCase())=="x"?16:i=="b"?2:8,!h||h==a?t:n}),h&&(a=h,c=c.replace(t,"$1").replace(i,"0.$1")),o!=c))return new l(c,a);if(l.DEBUG)throw Error(u+"Not a"+(h?" base "+h:"")+" number: "+o);e.s=null}e.c=e.e=null}}(),nt.absoluteValue=nt.abs=function(){var n=new l(this);return n.s<0&&(n.s=1),n},nt.comparedTo=function(n,t){return a(this,new l(n,t))},nt.decimalPlaces=nt.dp=function(n,u){var s,e,o,h=this;if(n!=null)return i(n,0,r),u==null?u=tt:i(u,0,8),it(new l(h),n+h.e+1,u);if(!(s=h.c))return null;if(e=((o=s.length-1)-f(this.e/t))*t,o=s[o])for(;o%10==0;o/=10,e--);return e<0&&(e=0),e},nt.dividedBy=nt.div=function(n,t){return rt(this,new l(n,t),ut,tt)},nt.dividedToIntegerBy=nt.idiv=function(n,t){return rt(this,new l(n,t),0,1)},nt.exponentiatedBy=nt.pow=function(n,i){var w,c,o,e,b,a,y,h,f,r=this;if(n=new l(n),n.c&&!n.isInteger())throw Error(u+"Exponent not an integer: "+et(n));if(i!=null&&(i=new l(i)),a=n.e>14,!r.c||!r.c[0]||r.c[0]==1&&!r.e&&r.c.length==1||!n.c||!n.c[0])return f=new l(Math.pow(+et(r),a?2-v(n):+et(n))),i?f.mod(i):f;if(y=n.s<0,i){if(i.c?!i.c[0]:!i.s)return new l(NaN);c=!y&&r.isInteger()&&i.isInteger();c&&(r=r.mod(i))}else{if(n.e>9&&(r.e>0||r.e<-1||(r.e==0?r.c[0]>1||a&&r.c[1]>=24e7:r.c[0]<8e13||a&&r.c[0]<=9999975e7)))return e=r.s<0&&v(n)?-0:0,r.e>-1&&(e=1/e),new l(y?1/e:e);ot&&(e=p(ot/t+2))}for(a?(w=new l(.5),y&&(n.s=1),h=v(n)):(o=Math.abs(+et(n)),h=o%2),f=new l(st);;){if(h){if(f=f.times(r),!f.c)break;e?f.c.length>e&&(f.c.length=e):c&&(f=f.mod(i))}if(o){if(o=s(o/2),o===0)break;h=o%2}else if(n=n.times(w),it(n,n.e+1,1),n.e>14)h=v(n);else{if(o=+et(n),o===0)break;h=o%2}r=r.times(r);e?r.c&&r.c.length>e&&(r.c.length=e):c&&(r=r.mod(i))}return c?f:(y&&(f=st.div(f)),i?f.mod(i):e?it(f,ot,tt,b):f)},nt.integerValue=function(n){var t=new l(this);return n==null?n=tt:i(n,0,8),it(t,t.e+1,n)},nt.isEqualTo=nt.eq=function(n,t){return a(this,new l(n,t))===0},nt.isFinite=function(){return!!this.c},nt.isGreaterThan=nt.gt=function(n,t){return a(this,new l(n,t))>0},nt.isGreaterThanOrEqualTo=nt.gte=function(n,t){return(t=a(this,new l(n,t)))===1||t===0},nt.isInteger=function(){return!!this.c&&f(this.e/t)>this.c.length-2},nt.isLessThan=nt.lt=function(n,t){return a(this,new l(n,t))<0},nt.isLessThanOrEqualTo=nt.lte=function(n,t){return(t=a(this,new l(n,t)))===-1||t===0},nt.isNaN=function(){return!this.s},nt.isNegative=function(){return this.s<0},nt.isPositive=function(){return this.s>0},nt.isZero=function(){return!!this.c&&this.c[0]==0},nt.minus=function(n,i){var h,s,c,p,v=this,e=v.s;if(n=new l(n,i),i=n.s,!e||!i)return new l(NaN);if(e!=i)return n.s=-i,v.plus(n);var y=v.e/t,a=n.e/t,r=v.c,u=n.c;if(!y||!a){if(!r||!u)return r?(n.s=-i,n):new l(u?v:NaN);if(!r[0]||!u[0])return u[0]?(n.s=-i,n):new l(r[0]?v:tt==3?-0:0)}if(y=f(y),a=f(a),r=r.slice(),e=y-a){for((p=e<0)?(e=-e,c=r):(a=y,c=u),c.reverse(),i=e;i--;c.push(0));c.reverse()}else for(s=(p=(e=r.length)<(i=u.length))?e:i,e=i=0;i<s;i++)if(r[i]!=u[i]){p=r[i]<u[i];break}if(p&&(c=r,r=u,u=c,n.s=-n.s),i=(s=u.length)-(h=r.length),i>0)for(;i--;r[h++]=0);for(i=o-1;s>e;){if(r[--s]<u[s]){for(h=s;h&&!r[--h];r[h]=i);--r[h];r[s]+=o}r[s]-=u[s]}for(;r[0]==0;r.splice(0,1),--a);return r[0]?dt(n,r,a):(n.s=tt==3?-1:1,n.c=[n.e=0],n)},nt.modulo=nt.mod=function(n,t){var r,u,i=this;if(n=new l(n,t),i.c&&n.s&&(!n.c||n.c[0])){if(!n.c||i.c&&!i.c[0])return new l(i)}else return new l(NaN);return yt==9?(u=n.s,n.s=1,r=rt(i,n,0,3),n.s=u,r.s*=u):r=rt(i,n,0,yt),n=i.minus(r.times(n)),n.c[0]||yt!=1||(n.s=i.s),n},nt.multipliedBy=nt.times=function(n,i){var p,d,e,w,k,g,a,v,nt,y,tt,it,s,rt,h,b=this,r=b.c,u=(n=new l(n,i)).c;if(!r||!u||!r[0]||!u[0])return b.s&&n.s&&(!r||r[0]||u)&&(!u||u[0]||r)?(n.s*=b.s,r&&u?(n.c=[0],n.e=0):n.c=n.e=null):n.c=n.e=n.s=null,n;for(d=f(b.e/t)+f(n.e/t),n.s*=b.s,a=r.length,y=u.length,a<y&&(s=r,r=u,u=s,e=a,a=y,y=e),e=a+y,s=[];e--;s.push(0));for(rt=o,h=c,e=y;--e>=0;){for(p=0,tt=u[e]%h,it=u[e]/h|0,k=a,w=e+k;w>e;)v=r[--k]%h,nt=r[k]/h|0,g=it*v+nt*tt,v=tt*v+g%h*h+s[w]+p,p=(v/rt|0)+(g/h|0)+it*nt,s[w--]=v%rt;s[w]=p}return p?++d:s.splice(0,1),dt(n,s,d)},nt.negated=function(){var n=new l(this);return n.s=-n.s||null,n},nt.plus=function(n,i){var s,c=this,r=c.s;if(n=new l(n,i),i=n.s,!r||!i)return new l(NaN);if(r!=i)return n.s=-i,c.minus(n);var a=c.e/t,h=n.e/t,u=c.c,e=n.c;if(!a||!h){if(!u||!e)return new l(r/0);if(!u[0]||!e[0])return e[0]?n:new l(u[0]?c:r*0)}if(a=f(a),h=f(h),u=u.slice(),r=a-h){for(r>0?(h=a,s=e):(r=-r,s=u),s.reverse();r--;s.push(0));s.reverse()}for(r=u.length,i=e.length,r-i<0&&(s=e,e=u,u=s,i=r),r=0;i;)r=(u[--i]=u[i]+e[i]+r)/o|0,u[i]=o===u[i]?0:u[i]%o;return r&&(u=[r].concat(u),++h),dt(n,u,h)},nt.precision=nt.sd=function(n,u){var o,e,f,s=this;if(n!=null&&n!==!!n)return i(n,1,r),u==null?u=tt:i(u,0,8),it(new l(s),n,u);if(!(o=s.c))return null;if(f=o.length-1,e=f*t+1,f=o[f]){for(;f%10==0;f/=10,e--);for(f=o[0];f>=10;f/=10,e++);}return n&&s.e+1>e&&(e=s.e+1),e},nt.shiftedBy=function(n){return i(n,-w,w),this.times("1e"+n)},nt.squareRoot=nt.sqrt=function(){var a,t,i,h,u,o=this,s=o.c,n=o.s,r=o.e,c=ut+4,v=new l("0.5");if(n!==1||!s||!s[0])return new l(!n||n<0&&(!s||s[0])?NaN:s?o:1/0);if(n=Math.sqrt(+et(o)),n==0||n==1/0?(t=e(s),(t.length+r)%2==0&&(t+="0"),n=Math.sqrt(+t),r=f((r+1)/2)-(r<0||r%2),n==1/0?t="1e"+r:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+r),i=new l(t)):i=new l(n+""),i.c[0])for(r=i.e,n=r+c,n<3&&(n=0);;)if(u=i,i=v.times(u.plus(rt(o,u,c,1))),e(u.c).slice(0,n)===(t=e(i.c)).slice(0,n))if(i.e<r&&--n,t=t.slice(n-3,n+1),t!="9999"&&(h||t!="4999")){+t&&(+t.slice(1)||t.charAt(0)!="5")||(it(i,i.e+ut+2,1),a=!i.times(i).eq(o));break}else{if(!h&&(it(u,u.e+ut+2,0),u.times(u).eq(o))){i=u;break}c+=4;n+=4;h=1}return it(i,i.e+ut+1,tt,a)},nt.toExponential=function(n,t){return n!=null&&(i(n,0,r),n++),kt(this,n,t,1)},nt.toFixed=function(n,t){return n!=null&&(i(n,0,r),n=n+this.e+1),kt(this,n,t)},nt.toFormat=function(n,t,i){var s,l=this;if(i==null)n!=null&&t&&typeof t=="object"?(i=t,t=null):n&&typeof n=="object"?(i=n,n=t=null):i=bt;else if(typeof i!="object")throw Error(u+"Argument not an object: "+i);if(s=l.toFixed(n,t),l.c){var r,v=s.split("."),e=+i.groupSize,o=+i.secondaryGroupSize,y=i.groupSeparator||"",f=v[0],a=v[1],p=l.s<0,h=p?f.slice(1):f,c=h.length;if(o&&(r=e,e=o,o=r,c-=r),e>0&&c>0){for(r=c%e||e,f=h.substr(0,r);r<c;r+=e)f+=y+h.substr(r,e);o>0&&(f+=y+h.slice(r));p&&(f="-"+f)}s=a?f+(i.decimalSeparator||"")+((o=+i.fractionGroupSize)?a.replace(new RegExp("\\d{"+o+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):a):f}return(i.prefix||"")+s+(i.suffix||"")},nt.toFraction=function(n){var o,s,h,r,a,y,i,f,c,p,k,w,v=this,d=v.c;if(n!=null&&(i=new l(n),!i.isInteger()&&(i.c||i.s!==1)||i.lt(st)))throw Error(u+"Argument "+(i.isInteger()?"out of range: ":"not an integer: ")+et(i));if(!d)return new l(v);for(o=new l(st),c=s=new l(st),h=f=new l(st),w=e(d),a=o.e=w.length-v.e-1,o.c[0]=b[(y=a%t)<0?t+y:y],n=!n||i.comparedTo(o)>0?a>0?o:c:i,y=ft,ft=1/0,i=new l(w),f.c[0]=0;;){if(p=rt(i,o,0,1),r=s.plus(p.times(h)),r.comparedTo(n)==1)break;s=h;h=r;c=f.plus(p.times(r=c));f=r;o=i.minus(p.times(r=o));i=r}return r=rt(n.minus(s),h,0,1),f=f.plus(r.times(c)),s=s.plus(r.times(h)),f.s=c.s=v.s,a=a*2,k=rt(c,h,a,tt).minus(v).abs().comparedTo(rt(f,s,a,tt).minus(v).abs())<1?[c,h]:[f,s],ft=y,k},nt.toNumber=function(){return+et(this)},nt.toPrecision=function(n,t){return n!=null&&i(n,1,r),kt(this,n,t,2)},nt.toString=function(n){var t,r=this,f=r.s,u=r.e;return u===null?f?(t="Infinity",f<0&&(t="-"+t)):t="NaN":(n==null?t=u<=ht||u>=vt?y(e(r.c),u):h(e(r.c),u,"0"):n===10?(r=it(new l(r),ut+u+1,tt),t=h(e(r.c),r.e,"0")):(i(n,2,at.length,"Base"),t=wt(h(e(r.c),u,"0"),10,n,f,!0)),f<0&&r.c[0]&&(t="-"+t)),t},nt.valueOf=nt.toJSON=function(){return et(this)},nt._isBigNumber=!0,n!=null&&l.set(n),l}function f(n){var t=n|0;return n>0||n===t?t:t-1}function e(n){for(var i,f,e=1,r=n.length,u=n[0]+"";e<r;){for(i=n[e++]+"",f=t-i.length;f--;i="0"+i);u+=i}for(r=u.length;u.charCodeAt(--r)===48;);return u.slice(0,r+1||1)}function a(n,t){var r,f,u=n.c,e=t.c,i=n.s,h=t.s,o=n.e,s=t.e;if(!i||!h)return null;if(r=u&&!u[0],f=e&&!e[0],r||f)return r?f?0:-h:i;if(i!=h)return i;if(r=i<0,f=o==s,!u||!e)return f?0:!u^r?1:-1;if(!f)return o>s^r?1:-1;for(h=(o=u.length)<(s=e.length)?o:s,i=0;i<h;i++)if(u[i]!=e[i])return u[i]>e[i]^r?1:-1;return o==s?0:o>s^r?1:-1}function i(n,t,i,r){if(n<t||n>i||n!==s(n))throw Error(u+(r||"Argument")+(typeof n=="number"?n<t||n>i?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n));}function v(n){var i=n.c.length-1;return f(n.e/t)==i&&n.c[i]%2!=0}function y(n,t){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(t<0?"e":"e+")+t}function h(n,t,i){var u,r;if(t<0){for(r=i+".";++t;r+=i);n=r+n}else if(u=n.length,++t>u){for(r=i,t-=u;--t;r+=i);n+=r}else t<u&&(n=n.slice(0,t)+"."+n.slice(t));return n}var l,g=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,p=Math.ceil,s=Math.floor,u="[BigNumber Error] ",k=u+"Number primitive has more than 15 significant digits: ",o=1e14,t=14,w=9007199254740991,b=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],c=1e7,r=1e9;l=d();l["default"]=l.BigNumber=l;typeof define=="function"&&define.amd?define(function(){return l}):typeof module!="undefined"&&module.exports?module.exports=l:(n||(n=typeof self!="undefined"&&self?self:window),n.BigNumber=l)})(this)
;var Forguncy;(function(n){var t=function(){function n(n,t){this.isLargeNumber=t;this.isLargeNumber?this._bigNumber=n instanceof BigNumber?n:new BigNumber(n):this.number=n instanceof BigNumber?n.toNumber():parseFloat(n)}return n.prototype.multipliedBy=function(t){if(this.isLargeNumber)return new n(this._bigNumber.multipliedBy(t instanceof n?t._bigNumber:t),this.isLargeNumber);var i=this.number*(t instanceof n?t.number:t);return new n(i,this.isLargeNumber)},n.prototype.toString=function(){return this.isLargeNumber?this._bigNumber.toString():this.number.toString()},n.prototype.plus=function(t){if(this.isLargeNumber)return new n(this._bigNumber.plus(t instanceof n?t._bigNumber:t),this.isLargeNumber);var i=this.number+(t instanceof n?t.number:t);return new n(i,this.isLargeNumber)},n.prototype.mod=function(t){if(this.isLargeNumber)return new n(this._bigNumber.mod(t instanceof n?t._bigNumber:t),this.isLargeNumber);var i=this.number%(t instanceof n?t.number:t);return new n(i,this.isLargeNumber)},n.prototype.dividedBy=function(t){if(this.isLargeNumber)return new n(this._bigNumber.dividedBy(t instanceof n?t._bigNumber:t),this.isLargeNumber);var i=this.number/(t instanceof n?t.number:t);return new n(i,this.isLargeNumber)},n.prototype.toFormat=function(){return this.isLargeNumber?this._bigNumber.toFormat(0,BigNumber.ROUND_DOWN,{groupSeparator:""}):(~~this.number).toString()},n.prototype.isEqualTo=function(t){return this.isLargeNumber?this._bigNumber.isEqualTo(t instanceof n?t._bigNumber:t):this.number===(t instanceof n?t.number:t)},n.prototype.isLessThan=function(t){return this.isLargeNumber?this._bigNumber.isLessThan(t instanceof n?t._bigNumber:t):this.number<(t instanceof n?t.number:t)},n.prototype.isGreaterThanOrEqualTo=function(t){return this.isLargeNumber?this._bigNumber.isGreaterThanOrEqualTo(t instanceof n?t._bigNumber:t):this.number>=(t instanceof n?t.number:t)},n.Safe_Max_Number=900719925474099,n}();n.BigNumber2=t})(Forguncy||(Forguncy={}))
;(function(){function f(n,t,i){switch(i.length){case 0:return n.call(t);case 1:return n.call(t,i[0]);case 2:return n.call(t,i[0],i[1]);case 3:return n.call(t,i[0],i[1],i[2])}return n.apply(t,i)}function ph(n,t,i,r){for(var f=-1,e=n==null?0:n.length,u;++f<e;)u=n[f],t(r,u,i(u),n);return r}function c(n,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(t(n[i],i,n)===!1)break;return n}function wh(n,t){for(var i=n==null?0:n.length;i--;)if(t(n[i],i,n)===!1)break;return n}function re(n,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(!t(n[i],i,n))return!1;return!0}function tt(n,t){for(var i=-1,f=n==null?0:n.length,e=0,u=[],r;++i<f;)r=n[i],t(r,i,n)&&(u[e++]=r);return u}function pi(n,t){var i=n==null?0:n.length;return!!i&&yt(n,t,0)>-1}function br(n,t,i){for(var r=-1,u=n==null?0:n.length;++r<u;)if(i(t,n[r]))return!0;return!1}function r(n,t){for(var i=-1,r=n==null?0:n.length,u=Array(r);++i<r;)u[i]=t(n[i],i,n);return u}function it(n,t){for(var i=-1,r=t.length,u=n.length;++i<r;)n[u+i]=t[i];return n}function kr(n,t,i,r){var u=-1,f=n==null?0:n.length;for(r&&f&&(i=n[++u]);++u<f;)i=t(i,n[u],u,n);return i}function bh(n,t,i,r){var u=n==null?0:n.length;for(r&&u&&(i=n[--u]);u--;)i=t(i,n[u],u,n);return i}function dr(n,t){for(var i=-1,r=n==null?0:n.length;++i<r;)if(t(n[i],i,n))return!0;return!1}function kh(n){return n.split("")}function dh(n){return n.match(ss)||[]}function fe(n,t,i){var r;return i(n,function(n,i,u){if(t(n,i,u))return r=i,!1}),r}function wi(n,t,i,r){for(var f=n.length,u=i+(r?1:-1);r?u--:++u<f;)if(t(n[u],u,n))return u;return-1}function yt(n,t,i){return t===t?sc(n,t,i):wi(n,ee,i)}function gh(n,t,i,r){for(var u=i-1,f=n.length;++u<f;)if(r(n[u],t))return u;return-1}function ee(n){return n!==n}function oe(n,t){var i=n==null?0:n.length;return i?tu(n,t)/i:oi}function gr(t){return function(i){return i==null?n:i[t]}}function nu(t){return function(i){return t==null?n:t[i]}}function se(n,t,i,r,u){return u(n,function(n,u,f){i=r?(r=!1,n):t(i,n,u,f)}),i}function nc(n,t){var i=n.length;for(n.sort(t);i--;)n[i]=n[i].value;return n}function tu(t,i){for(var r,f=-1,e=t.length,u;++f<e;)u=i(t[f]),u!==n&&(r=r===n?u:r+u);return r}function iu(n,t){for(var i=-1,r=Array(n);++i<n;)r[i]=t(i);return r}function tc(n,t){return r(t,function(t){return[t,n[t]]})}function e(n){return function(t){return n(t)}}function ru(n,t){return r(t,function(t){return n[t]})}function ui(n,t){return n.has(t)}function he(n,t){for(var i=-1,r=n.length;++i<r&&yt(t,n[i],0)>-1;);return i}function ce(n,t){for(var i=n.length;i--&&yt(t,n[i],0)>-1;);return i}function ic(n,t){for(var i=n.length,r=0;i--;)n[i]===t&&++r;return r}function rc(n){return"\\"+lh[n]}function uc(t,i){return t==null?n:t[i]}function pt(n){return oh.test(n)}function fc(n){return sh.test(n)}function ec(n){for(var t,i=[];!(t=n.next()).done;)i.push(t.value);return i}function uu(n){var i=-1,t=Array(n.size);return n.forEach(function(n,r){t[++i]=[r,n]}),t}function ve(n,t){return function(i){return n(t(i))}}function rt(n,t){for(var i=-1,f=n.length,e=0,u=[],r;++i<f;)r=n[i],(r===t||r===fi)&&(n[i]=fi,u[e++]=i);return u}function bi(n){var i=-1,t=Array(n.size);return n.forEach(function(n){t[++i]=n}),t}function oc(n){var i=-1,t=Array(n.size);return n.forEach(function(n){t[++i]=[n,n]}),t}function sc(n,t,i){for(var r=i-1,u=n.length;++r<u;)if(n[r]===t)return r;return-1}function hc(n,t,i){for(var r=i+1;r--;)if(n[r]===t)return r;return r}function wt(n){return pt(n)?cc(n):ue(n)}function v(n){return pt(n)?lc(n):kh(n)}function cc(n){for(var t=yr.lastIndex=0;yr.test(n);)++t;return t}function lc(n){return n.match(yr)||[]}function ac(n){return n.match(eh)||[]}var n,pe="4.17.11",ki=200,we="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",di="__lodash_hash_undefined__",be=500,fi="__lodash_placeholder__",g=1,eu=2,ot=4,st=1,ei=2,s=1,ut=2,ou=4,y=8,ht=16,p=32,ct=64,b=128,bt=256,gi=512,ke=30,de="...",ge=800,no=16,su=1,to=2,io=3,ft=1/0,nt=9007199254740991,ro=17976931348623157e292,oi=NaN,w=4294967295,uo=w-1,fo=w>>>1,eo=[["ary",b],["bind",s],["bindKey",ut],["curry",y],["curryRight",ht],["flip",gi],["partial",p],["partialRight",ct],["rearg",bt]],lt="[object Arguments]",si="[object Array]",oo="[object AsyncFunction]",kt="[object Boolean]",dt="[object Date]",so="[object DOMException]",hi="[object Error]",ci="[object Function]",hu="[object GeneratorFunction]",l="[object Map]",gt="[object Number]",ho="[object Null]",k="[object Object]",cu="[object Promise]",co="[object Proxy]",ni="[object RegExp]",a="[object Set]",ti="[object String]",li="[object Symbol]",lo="[object Undefined]",ii="[object WeakMap]",ao="[object WeakSet]",ri="[object ArrayBuffer]",at="[object DataView]",nr="[object Float32Array]",tr="[object Float64Array]",ir="[object Int8Array]",rr="[object Int16Array]",ur="[object Int32Array]",fr="[object Uint8Array]",er="[object Uint8ClampedArray]",or="[object Uint16Array]",sr="[object Uint32Array]",vo=/\b__p \+= '';/g,yo=/\b(__p \+=) '' \+/g,po=/(__e\(.*?\)|\b__t\)) \+\n'';/g,lu=/&(?:amp|lt|gt|quot|#39);/g,au=/[&<>"']/g,wo=RegExp(lu.source),bo=RegExp(au.source),ko=/<%-([\s\S]+?)%>/g,go=/<%([\s\S]+?)%>/g,vu=/<%=([\s\S]+?)%>/g,ns=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ts=/^\w*$/,is=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,hr=/[\\^$.*+?()[\]{}|]/g,rs=RegExp(hr.source),yu=/^\s+|\s+$/g,pu=/^\s+/,us=/\s+$/,fs=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,es=/\{\n\/\* \[wrapped with (.+)\] \*/,os=/,? & /,ss=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,hs=/\\(\\)?/g,cs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wu=/\w*$/,ls=/^[-+]0x[0-9a-f]+$/i,as=/^0b[01]+$/i,vs=/^\[object .+?Constructor\]$/,ys=/^0o[0-7]+$/i,ps=/^(?:0|[1-9]\d*)$/,ws=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ai=/($^)/,bs=/['\n\r\u2028\u2029\\]/g,vi="\\ud800-\\udfff",bu="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ku="\\u2700-\\u27bf",du="a-z\\xdf-\\xf6\\xf8-\\xff",gu="A-Z\\xc0-\\xd6\\xd8-\\xde",nf="\\ufe0e\\ufe0f",tf="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",cr="['’]",ks="["+vi+"]",rf="["+tf+"]",yi="["+bu+"]",uf="\\d+",ds="["+ku+"]",ff="["+du+"]",ef="[^"+vi+tf+uf+ku+du+gu+"]",lr="\\ud83c[\\udffb-\\udfff]",gs="(?:"+yi+"|"+lr+")",sf="[^"+vi+"]",ar="(?:\\ud83c[\\udde6-\\uddff]){2}",vr="[\\ud800-\\udbff][\\udc00-\\udfff]",vt="["+gu+"]",hf="\\u200d",cf="(?:"+ff+"|"+ef+")",nh="(?:"+vt+"|"+ef+")",lf="(?:"+cr+"(?:d|ll|m|re|s|t|ve))?",af="(?:"+cr+"(?:D|LL|M|RE|S|T|VE))?",vf=gs+"?",yf="["+nf+"]?",th="(?:"+hf+"(?:"+[sf,ar,vr].join("|")+")"+yf+vf+")*",pf=yf+vf+th,ih="(?:"+[ds,ar,vr].join("|")+")"+pf,rh="(?:"+[sf+yi+"?",yi,ar,vr,ks].join("|")+")",uh=RegExp(cr,"g"),fh=RegExp(yi,"g"),yr=RegExp(lr+"(?="+lr+")|"+rh+pf,"g"),eh=RegExp([vt+"?"+ff+"+"+lf+"(?="+[rf,vt,"$"].join("|")+")",nh+"+"+af+"(?="+[rf,vt+cf,"$"].join("|")+")",vt+"?"+cf+"+"+lf,vt+"+"+af,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",uf,ih].join("|"),"g"),oh=RegExp("["+hf+vi+bu+nf+"]"),sh=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ch=-1,i={},t,ue,le,ae,ye,fu,d;i[nr]=i[tr]=i[ir]=i[rr]=i[ur]=i[fr]=i[er]=i[or]=i[sr]=!0;i[lt]=i[si]=i[ri]=i[kt]=i[at]=i[dt]=i[hi]=i[ci]=i[l]=i[gt]=i[k]=i[ni]=i[a]=i[ti]=i[ii]=!1;t={};t[lt]=t[si]=t[ri]=t[at]=t[kt]=t[dt]=t[nr]=t[tr]=t[ir]=t[rr]=t[ur]=t[l]=t[gt]=t[k]=t[ni]=t[a]=t[ti]=t[li]=t[fr]=t[er]=t[or]=t[sr]=!0;t[hi]=t[ci]=t[ii]=!1;var lh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ah=parseFloat,vh=parseInt,wf=typeof global=="object"&&global&&global.Object===Object&&global,yh=typeof self=="object"&&self&&self.Object===Object&&self,u=wf||yh||Function("return this")(),pr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,et=pr&&typeof module=="object"&&module&&!module.nodeType&&module,bf=et&&et.exports===pr,wr=bf&&wf.process,h=function(){try{var n=et&&et.require&&et.require("util").types;return n?n:wr&&wr.binding&&wr.binding("util")}catch(t){}}(),kf=h&&h.isArrayBuffer,df=h&&h.isDate,gf=h&&h.isMap,ne=h&&h.isRegExp,te=h&&h.isSet,ie=h&&h.isTypedArray;ue=gr("length");le=nu({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"});ae=nu({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});ye=nu({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});fu=function fu(h){function et(n){if(wr(n)&&!vi(n)&&!(n instanceof lr)){if(n instanceof vf)return n;if(vr.call(n,"__wrapped__"))return wd(n)}return new vf(n)}function ga(){}function vf(t,i){this.__wrapped__=t;this.__actions__=[];this.__chain__=!!i;this.__index__=0;this.__values__=n}function lr(n){this.__wrapped__=n;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=w;this.__views__=[]}function vit(){var n=new lr(this.__wrapped__);return n.__actions__=ff(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=ff(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=ff(this.__views__),n}function yit(){if(this.__filtered__){var n=new lr(this);n.__dir__=-1;n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function pit(){var n=this.__wrapped__.value(),f=this.__dir__,e=vi(n),o=f<0,s=e?n.length:0,h=pft(0,s,this.__views__),c=h.start,l=h.end,t=l-c,a=o?l:c-1,v=this.__iteratees__,d=v.length,y=0,p=nf(t,this.__takeCount__),r,u,i;if(!e||!o&&s==t&&p==t)return uk(n,this.__actions__);r=[];n:while(t--&&y<p){for(a+=f,u=-1,i=n[a];++u<d;){var w=v[u],g=w.iteratee,b=w.type,k=g(i);if(b==to)i=k;else if(!k)if(b==su)continue n;else break n}r[y++]=i}return r}function bc(n){var i=-1,r=n==null?0:n.length,t;for(this.clear();++i<r;)t=n[i],this.set(t[0],t[1])}function wit(){this.__data__=yl?yl(null):{};this.size=0}function bit(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}function kit(t){var i=this.__data__,r;return yl?(r=i[t],r===di?n:r):vr.call(i,t)?i[t]:n}function dit(t){var i=this.__data__;return yl?i[t]!==n:vr.call(i,t)}function git(t,i){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=yl&&i===n?di:i,this}function th(n){var i=-1,r=n==null?0:n.length,t;for(this.clear();++i<r;)t=n[i],this.set(t[0],t[1])}function nrt(){this.__data__=[];this.size=0}function trt(n){var t=this.__data__,i=nv(t,n),r;return i<0?!1:(r=t.length-1,i==r?t.pop():ya.call(t,i,1),--this.size,!0)}function irt(t){var i=this.__data__,r=nv(i,t);return r<0?n:i[r][1]}function rrt(n){return nv(this.__data__,n)>-1}function urt(n,t){var i=this.__data__,r=nv(i,n);return r<0?(++this.size,i.push([n,t])):i[r][1]=t,this}function ih(n){var i=-1,r=n==null?0:n.length,t;for(this.clear();++i<r;)t=n[i],this.set(t[0],t[1])}function frt(){this.size=0;this.__data__={hash:new bc,map:new(al||th),string:new bc}}function ert(n){var t=yv(this,n)["delete"](n);return this.size-=t?1:0,t}function ort(n){return yv(this,n).get(n)}function srt(n){return yv(this,n).has(n)}function hrt(n,t){var i=yv(this,n),r=i.size;return i.set(n,t),this.size+=i.size==r?0:1,this}function kc(n){var t=-1,i=n==null?0:n.length;for(this.__data__=new ih;++t<i;)this.add(n[t])}function crt(n){return this.__data__.set(n,di),this}function lrt(n){return this.__data__.has(n)}function ss(n){var t=this.__data__=new th(n);this.size=t.size}function art(){this.__data__=new th;this.size=0}function vrt(n){var t=this.__data__,i=t["delete"](n);return this.size=t.size,i}function yrt(n){return this.__data__.get(n)}function prt(n){return this.__data__.has(n)}function wrt(n,t){var i=this.__data__,r;if(i instanceof th){if(r=i.__data__,!al||r.length<ki-1)return r.push([n,t]),this.size=++i.size,this;i=this.__data__=new ih(r)}return i.set(n,t),this.size=i.size,this}function ub(n,t){var r=vi(n),u=!r&&tl(n),f=!r&&!u&&yh(n),o=!r&&!u&&!f&&il(n),s=r||u||f||o,e=s?iu(n.length,vtt):[],h=e.length;for(var i in n)!(t||vr.call(n,i))||s&&(i=="length"||f&&(i=="offset"||i=="parent")||o&&(i=="buffer"||i=="byteLength"||i=="byteOffset")||lh(i,h))||e.push(i);return e}function fb(t){var i=t.length;return i?t[gy(0,i-1)]:n}function brt(n,t){return pv(ff(n),dc(t,0,n.length))}function krt(n){return pv(ff(n))}function hy(t,i,r){(r===n||ks(t[i],r))&&(r!==n||i in t)||rh(t,i,r)}function bl(t,i,r){var u=t[i];vr.call(t,i)&&ks(u,r)&&(r!==n||i in t)||rh(t,i,r)}function nv(n,t){for(var i=n.length;i--;)if(ks(n[i][0],t))return i;return-1}function drt(n,t,i,r){return eh(n,function(n,u,f){t(r,n,i(n),f)}),r}function eb(n,t){return n&&gs(t,du(t),n)}function grt(n,t){return n&&gs(t,sf(t),n)}function rh(n,t,i){t=="__proto__"&&pa?pa(n,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):n[t]=i}function cy(t,i){for(var r=-1,u=i.length,f=bu(u),e=t==null;++r<u;)f[r]=e?n:fw(t,i[r]);return f}function dc(t,i,r){return t===t&&(r!==n&&(t=t<=r?t:r),i!==n&&(t=t>=i?t:i)),t}function yf(i,r,u,f,e,o){var s,l=r&g,a=r&eu,d=r&ot,v,h,y,p,b,w;if(u&&(s=e?u(i,f,e,o):u(i)),s!==n)return s;if(!pr(i))return i;if(v=vi(i),v){if(s=bft(i),!l)return ff(i,s)}else{if(h=tf(i),y=h==ci||h==hu,yh(i))return sk(i,l);if(h==k||h==lt||y&&!e){if(s=a||y?{}:od(i),!l)return a?oft(i,grt(s,i)):eft(i,eb(s,i))}else{if(!t[h])return e?i:{};s=kft(i,h,l)}}return(o||(o=new ss),p=o.get(i),p)?p:(o.set(i,s),uw(i))?(i.forEach(function(n){s.add(yf(n,r,u,n,i,o))}),s):rw(i)?(i.forEach(function(n,t){s.set(t,yf(n,r,u,t,i,o))}),s):(b=d?a?lp:cp:a?sf:du,w=v?n:b(i),c(w||i,function(n,t){w&&(t=n,n=i[t]);bl(s,t,yf(n,r,u,t,i,o))}),s)}function nut(n){var t=du(n);return function(i){return ob(i,n,t)}}function ob(t,i,r){var u=r.length;if(t==null)return!u;for(t=yr(t);u--;){var f=r[u],o=i[f],e=t[f];if(e===n&&!(f in t)||!o(e))return!1}return!0}function sb(t,i,r){if(typeof t!="function")throw new af(o);return ra(function(){t.apply(n,r)},i)}function kl(n,t,i,u){var a=-1,h=pi,c=!0,v=n.length,s=[],y=t.length,f,o,l;if(!v)return s;i&&(t=r(t,e(i)));u?(h=br,c=!1):t.length>=ki&&(h=ui,c=!1,t=new kc(t));n:while(++a<v)if(f=n[a],o=i==null?f:i(f),f=u||f!==0?f:0,c&&o===o){for(l=y;l--;)if(t[l]===o)continue n;s.push(f)}else h(t,o,u)||s.push(f);return s}function tut(n,t){var i=!0;return eh(n,function(n,r,u){return i=!!t(n,r,u)}),i}function tv(t,i,r){for(var o=-1,h=t.length,f,u,e,s;++o<h;)f=t[o],u=i(f),u!=null&&(e===n?u===u&&!lf(u):r(u,e))&&(e=u,s=f);return s}function iut(t,i,r,u){var f=t.length;for(r=yi(r),r<0&&(r=-r>f?0:f+r),u=u===n||u>f?f:yi(u),u<0&&(u+=f),u=r>u?0:ln(u);r<u;)t[r++]=i;return t}function hb(n,t){var i=[];return eh(n,function(n,r,u){t(n,r,u)&&i.push(n)}),i}function gu(n,t,i,r,u){var e=-1,o=n.length,f;for(i||(i=gft),u||(u=[]);++e<o;)f=n[e],t>0&&i(f)?t>1?gu(f,t-1,i,r,u):it(u,f):r||(u[u.length]=f);return u}function ds(n,t){return n&&iv(n,t,du)}function vy(n,t){return n&&ay(n,t,du)}function rv(n,t){return tt(t,function(t){return kh(n[t])})}function el(t,i){i=vc(i,t);for(var r=0,u=i.length;t!=null&&r<u;)t=t[nh(i[r++])];return r&&r==u?t:n}function cb(n,t,i){var r=t(n);return vi(n)?r:it(r,i(n))}function rf(t){return t==null?t===n?lo:ho:pc&&pc in yr(t)?yft(t):fet(t)}function yy(n,t){return n>t}function rut(n,t){return n!=null&&vr.call(n,t)}function uut(n,t){return n!=null&&t in yr(n)}function fut(n,t,i){return n>=nf(t,i)&&n<ku(t,i)}function py(t,i,u){for(var b=u?br:pi,k=t[0].length,a=t.length,f=a,v=bu(a),y=Infinity,l=[],o,p,c,s,h,w;f--;)o=t[f],f&&i&&(o=r(o,e(i))),y=nf(o.length,y),v[f]=!u&&(i||k>=120&&o.length>=120)?new kc(f&&o):n;o=t[0];p=-1;c=v[0];n:while(++p<k&&l.length<y)if(s=o[p],h=i?i(s):s,s=u||s!==0?s:0,!(c?ui(c,h):b(l,h,u))){for(f=a;--f;)if(w=v[f],!(w?ui(w,h):b(t[f],h,u)))continue n;c&&c.push(h);l.push(s)}return l}function eut(n,t,i,r){return ds(n,function(n,u,f){t(r,i(n),u,f)}),r}function dl(t,i,r){i=vc(i,t);t=ad(t,i);var u=t==null?t:t[nh(wf(i))];return u==null?n:f(u,t,r)}function lb(n){return wr(n)&&rf(n)==lt}function out(n){return wr(n)&&rf(n)==ri}function sut(n){return wr(n)&&rf(n)==dt}function gl(n,t,i,r,u){return n===t?!0:n==null||t==null||!wr(n)&&!wr(t)?n!==n&&t!==t:hut(n,t,i,r,gl,u)}function hut(n,t,i,r,u,f){var s=vi(n),p=vi(t),e=s?si:tf(n),o=p?si:tf(t),l,a,v,y;e=e==lt?k:e;o=o==lt?k:o;var h=e==k,w=o==k,c=e==o;if(c&&yh(n)){if(!yh(t))return!1;s=!0;h=!1}return c&&!h?(f||(f=new ss),s||il(n)?ud(n,t,i,r,u,f):aft(n,t,e,i,r,u,f)):!(i&st)&&(l=h&&vr.call(n,"__wrapped__"),a=w&&vr.call(t,"__wrapped__"),l||a)?(v=l?n.value():n,y=a?t.value():t,f||(f=new ss),u(v,y,i,r,f)):c?(f||(f=new ss),vft(n,t,i,r,u,f)):!1}function cut(n){return wr(n)&&tf(n)==l}function wy(t,i,r,u){var e=r.length,l=e,a=!u,f,h,c;if(t==null)return!l;for(t=yr(t);e--;)if(f=r[e],a&&f[2]?f[1]!==t[f[0]]:!(f[0]in t))return!1;while(++e<l){f=r[e];var o=f[0],s=t[o],v=f[1];if(a&&f[2]){if(s===n&&!(o in t))return!1}else if(h=new ss,u&&(c=u(s,v,o,t,i,h)),!(c===n?gl(v,s,st|ei,u,h):c))return!1}return!0}function ab(n){if(!pr(n)||tet(n))return!1;var t=kh(n)?ktt:vs;return t.test(nl(n))}function lut(n){return wr(n)&&rf(n)==ni}function aut(n){return wr(n)&&tf(n)==a}function vut(n){return wr(n)&&ny(n.length)&&!!i[rf(n)]}function vb(n){return typeof n=="function"?n:n==null?hf:typeof n=="object"?vi(n)?wb(n[0],n[1]):pb(n):ctt(n)}function by(n){var i,t;if(!ia(n))return uit(n);i=[];for(t in yr(n))vr.call(n,t)&&t!="constructor"&&i.push(t);return i}function yut(n){var r,i,t;if(!pr(n))return uet(n);r=ia(n);i=[];for(t in n)t=="constructor"&&(r||!vr.call(n,t))||i.push(t);return i}function ky(n,t){return n<t}function yb(n,t){var r=-1,i=ef(n)?bu(n.length):[];return eh(n,function(n,u,f){i[++r]=t(n,u,f)}),i}function pb(n){var t=ap(n);return t.length==1&&t[0][2]?cd(t[0][0],t[0][1]):function(i){return i===n||wy(i,n,t)}}function wb(t,i){return yp(t)&&hd(i)?cd(nh(t),i):function(r){var u=fw(r,t);return u===n&&u===i?ew(r,t):gl(i,u,st|ei)}}function uv(t,i,r,u,f){t!==i&&iv(i,function(e,o){if(pr(e))f||(f=new ss),put(t,i,o,r,uv,u,f);else{var s=u?u(wp(t,o),e,o+"",t,i,f):n;s===n&&(s=e);hy(t,o,s)}},sf)}function put(t,i,r,u,f,e,o){var c=wp(t,r),s=wp(i,r),y=o.get(s),h,l;if(y){hy(t,r,y);return}if(h=e?e(c,s,r+"",t,i,o):n,l=h===n,l){var a=vi(s),v=!a&&yh(s),p=!a&&!v&&il(s);h=s;a||v||p?vi(c)?h=c:nu(c)?h=ff(c):v?(l=!1,h=sk(s,!0)):p?(l=!1,h=hk(s,!0)):h=[]:fa(s)||tl(s)?(h=c,tl(c)?h=an(c):(!pr(c)||kh(c))&&(h=od(s))):l=!1}l&&(o.set(s,h),f(h,s,u,e,o),o["delete"](s));hy(t,r,h)}function bb(t,i){var r=t.length;if(r)return i+=i<0?r:0,lh(i,r)?t[i]:n}function kb(n,t,i){var f=-1,u;return t=r(t.length?t:[hf],e(vt())),u=yb(n,function(n){var i=r(t,function(t){return t(n)});return{criteria:i,index:++f,value:n}}),nc(u,function(n,t){return fft(n,t,i)})}function wut(n,t){return db(n,t,function(t,i){return ew(n,i)})}function db(n,t,i){for(var f=-1,o=t.length,e={},r,u;++f<o;)r=t[f],u=el(n,r),i(u,r)&&na(e,vc(r,n),u);return e}function but(n){return function(t){return el(t,n)}}function dy(n,t,i,u){var c=u?gh:yt,s=-1,l=t.length,f=n;for(n===t&&(t=ff(t)),i&&(f=r(n,e(i)));++s<l;)for(var o=0,h=t[s],a=i?i(h):h;(o=c(f,a,o,u))>-1;)f!==n&&ya.call(f,o,1),ya.call(n,o,1);return n}function gb(n,t){for(var r=n?t.length:0,f=r-1,i,u;r--;)i=t[r],(r==f||i!==u)&&(u=i,lh(i)?ya.call(n,i,1):rp(n,i));return n}function gy(n,t){return n+ba(ib()*(t-n+1))}function kut(n,t,i,r){for(var e=-1,u=ku(wa((t-n)/(i||1)),0),f=bu(u);u--;)f[r?u:++e]=n,n+=i;return f}function np(n,t){var i="";if(!n||t<1||t>nt)return i;do t%2&&(i+=n),t=ba(t/2),t&&(n+=n);while(t);return i}function cr(n,t){return bp(ld(n,t,hf),n+"")}function dut(n){return fb(cl(n))}function gut(n,t){var i=cl(n);return pv(i,dc(t,0,i.length))}function na(t,i,r,u){var e,o,h;if(!pr(t))return t;i=vc(i,t);for(var s=-1,c=i.length,l=c-1,f=t;f!=null&&++s<c;)e=nh(i[s]),o=r,s!=l&&(h=f[e],o=u?u(h,e,f):n,o===n&&(o=pr(h)?h:lh(i[s+1])?[]:{})),bl(f,e,o),f=f[e];return t}function nft(n){return pv(cl(n))}function pf(n,t,i){var u=-1,r=n.length,f;for(t<0&&(t=-t>r?0:r+t),i=i>r?r:i,i<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0,f=bu(r);++u<r;)f[u]=n[u+t];return f}function tft(n,t){var i;return eh(n,function(n,r,u){return i=t(n,r,u),!i}),!!i}function fv(n,t,i){var f=0,r=n==null?f:n.length,e,u;if(typeof t=="number"&&t===t&&r<=fo){while(f<r)e=f+r>>>1,u=n[e],u!==null&&!lf(u)&&(i?u<=t:u<t)?f=e+1:r=e;return r}return ip(n,t,hf,i)}function ip(t,i,r,u){var v;i=r(i);for(var s=0,e=t==null?0:t.length,y=i!==i,p=i===null,w=lf(i),b=i===n;s<e;){var h=ba((s+e)/2),f=r(t[h]),c=f!==n,l=f===null,o=f===f,a=lf(f);v=y?u||o:b?o&&(u||c):p?o&&c&&(u||!l):w?o&&c&&!l&&(u||!a):l||a?!1:u?f<=i:f<i;v?s=h+1:e=h}return nf(e,uo)}function tk(n,t){for(var r=-1,o=n.length,s=0,f=[],i,u,e;++r<o;)i=n[r],u=t?t(i):i,r&&ks(u,e)||(e=u,f[s++]=i===0?0:i);return f}function ik(n){return typeof n=="number"?n:lf(n)?oi:+n}function cf(n){if(typeof n=="string")return n;if(vi(n))return r(n,cf)+"";if(lf(n))return rb?rb.call(n):"";var t=n+"";return t=="0"&&1/n==-ft?"-0":t}function lc(n,t,i){var l=-1,o=pi,a=n.length,s=!0,e=[],r=e,h,u,f,c;if(i)s=!1,o=br;else if(a>=ki){if(h=t?null:nd(n),h)return bi(h);s=!1;o=ui;r=new kc}else r=t?[]:e;n:while(++l<a)if(u=n[l],f=t?t(u):u,u=i||u!==0?u:0,s&&f===f){for(c=r.length;c--;)if(r[c]===f)continue n;t&&r.push(f);e.push(u)}else o(r,f,i)||(r!==e&&r.push(f),e.push(u));return e}function rp(n,t){return t=vc(t,n),n=ad(n,t),n==null||delete n[nh(wf(t))]}function rk(n,t,i,r){return na(n,t,i(el(n,t)),r)}function ev(n,t,i,r){for(var f=n.length,u=r?f:-1;(r?u--:++u<f)&&t(n[u],u,n););return i?pf(n,r?0:u,r?u+1:f):pf(n,r?u+1:0,r?f:u)}function uk(n,t){var i=n;return i instanceof lr&&(i=i.value()),kr(t,function(n,t){return t.func.apply(t.thisArg,it([n],t.args))},i)}function up(n,t,i){var u=n.length,r,f,o,e;if(u<2)return u?lc(n[0]):[];for(r=-1,f=bu(u);++r<u;)for(o=n[r],e=-1;++e<u;)e!=r&&(f[r]=kl(f[r]||o,n[e],t,i));return lc(gu(f,1),t,i)}function fk(t,i,r){for(var u=-1,o=t.length,s=i.length,f={},e;++u<o;)e=u<s?i[u]:n,r(f,t[u],e);return f}function fp(n){return nu(n)?n:[]}function ep(n){return typeof n=="function"?n:hf}function vc(n,t){return vi(n)?n:yp(n,t)?[n]:kp(ar(n))}function yc(t,i,r){var u=t.length;return r=r===n?u:r,!i&&r>=u?t:pf(t,i,r)}function sk(n,t){if(t)return n.slice();var i=n.length,r=dw?dw(i):new n.constructor(i);return n.copy(r),r}function op(n){var t=new n.constructor(n.byteLength);return new aa(t).set(new aa(n)),t}function ift(n,t){var i=t?op(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.byteLength)}function rft(n){var t=new n.constructor(n.source,wu.exec(n));return t.lastIndex=n.lastIndex,t}function uft(n){return wl?yr(wl.call(n)):{}}function hk(n,t){var i=t?op(n.buffer):n.buffer;return new n.constructor(i,n.byteOffset,n.length)}function ck(t,i){if(t!==i){var o=t!==n,s=t===null,r=t===t,u=lf(t),h=i!==n,c=i===null,f=i===i,e=lf(i);if(!c&&!e&&!u&&t>i||u&&h&&f&&!c&&!e||s&&h&&f||!o&&f||!r)return 1;if(!s&&!u&&!e&&t<i||e&&o&&r&&!s&&!u||c&&o&&r||!h&&r||!f)return-1}return 0}function fft(n,t,i){for(var r=-1,f=n.criteria,o=t.criteria,s=f.length,h=i.length,u,e;++r<s;)if(u=ck(f[r],o[r]),u)return r>=h?u:(e=i[r],u*(e=="desc"?-1:1));return n.index-t.index}function lk(n,t,i,r){for(var u=-1,o=n.length,s=i.length,f=-1,h=t.length,c=ku(o-s,0),e=bu(h+c),l=!r;++f<h;)e[f]=t[f];while(++u<s)(l||u<o)&&(e[i[u]]=n[u]);while(c--)e[f++]=n[u++];return e}function ak(n,t,i,r){for(var u=-1,s=n.length,h=-1,c=i.length,e=-1,l=t.length,a=ku(s-c,0),f=bu(a+l),v=!r,o;++u<a;)f[u]=n[u];for(o=u;++e<l;)f[o+e]=t[e];while(++h<c)(v||u<s)&&(f[o+i[h]]=n[u++]);return f}function ff(n,t){var i=-1,r=n.length;for(t||(t=bu(r));++i<r;)t[i]=n[i];return t}function gs(t,i,r,u){var h=!r,o,s,f,e;for(r||(r={}),o=-1,s=i.length;++o<s;)f=i[o],e=u?u(r[f],t[f],f,r,t):n,e===n&&(e=t[f]),h?rh(r,f,e):bl(r,f,e);return r}function eft(n,t){return gs(n,vp(n),t)}function oft(n,t){return gs(n,fd(n),t)}function ov(n,t){return function(i,r){var u=vi(i)?ph:drt,f=t?t():{};return u(i,n,vt(r,2),f)}}function ol(t){return cr(function(i,r){var e=-1,u=r.length,f=u>1?r[u-1]:n,s=u>2?r[2]:n,o;for(f=t.length>3&&typeof f=="function"?(u--,f):n,s&&uf(r[0],r[1],s)&&(f=u<3?n:f,u=1),i=yr(i);++e<u;)o=r[e],o&&t(i,o,e,f);return i})}function vk(n,t){return function(i,r){if(i==null)return i;if(!ef(i))return n(i,r);for(var f=i.length,u=t?f:-1,e=yr(i);t?u--:++u<f;)if(r(e[u],u,e)===!1)break;return i}}function yk(n){return function(t,i,r){for(var s=-1,f=yr(t),e=r(t),o=e.length,u;o--;)if(u=e[n?o:++s],i(f[u],u,f)===!1)break;return t}}function sft(n,t,i){function r(){var t=this&&this!==u&&this instanceof r?e:n;return t.apply(f?i:this,arguments)}var f=t&s,e=ta(n);return r}function pk(t){return function(i){i=ar(i);var r=pt(i)?v(i):n,u=r?r[0]:i.charAt(0),f=r?yc(r,1).join(""):i.slice(1);return u[t]()+f}}function sl(n){return function(t){return kr(utt(ntt(t).replace(uh,"")),n,"")}}function ta(n){return function(){var t=arguments,i,r;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}return i=wc(n.prototype),r=n.apply(i,t),pr(r)?r:i}}function hft(t,i,r){function e(){for(var s=arguments.length,h=bu(s),c=s,l=hl(e),a,v;c--;)h[c]=arguments[c];return(a=s<3&&h[0]!==l&&h[s-1]!==l?[]:rt(h,l),s-=a.length,s<r)?gk(t,i,sv,e.placeholder,n,h,a,n,n,r-s):(v=this&&this!==u&&this instanceof e?o:t,f(v,this,h))}var o=ta(t);return e}function wk(t){return function(i,r,u){var e=yr(i),o,f;return ef(i)||(o=vt(r,3),i=du(i),r=function(n){return o(e[n],n,e)}),f=t(i,r,u),f>-1?e[o?i[f]:f]:n}}function bk(t){return sh(function(i){var s=i.length,e=s,c=vf.prototype.thru,u,r,h,f;for(t&&i.reverse();e--;){if(u=i[e],typeof u!="function")throw new af(o);c&&!r&&vv(u)=="wrapper"&&(r=new vf([],!0))}for(e=r?e:s;++e<s;)u=i[e],h=vv(u),f=h=="wrapper"?av(u):n,r=f&&pp(f[0])&&f[1]==(b|y|p|bt)&&!f[4].length&&f[9]==1?r[vv(f[0])].apply(r,f[3]):u.length==1&&pp(u)?r[h]():r.thru(u);return function(){var u=arguments,f=u[0],n,t;if(r&&u.length==1&&vi(f))return r.plant(f).value();for(n=0,t=s?i[n].apply(this,u):f;++n<s;)t=i[n].call(this,t);return t}})}function sv(t,i,r,f,e,o,h,c,l,a){function p(){for(var s=arguments.length,n=bu(s),b=s,tt,ut,ft,it,y;b--;)n[b]=arguments[b];return(v&&(tt=hl(p),ut=ic(n,tt)),f&&(n=lk(n,f,e,v)),o&&(n=ak(n,o,h,v)),s-=ut,v&&s<a)?(ft=rt(n,tt),gk(t,i,sv,p.placeholder,r,n,ft,c,l,a-s)):(it=d?r:this,y=w?it[t]:t,s=n.length,c?n=eet(n,c):g&&s>1&&n.reverse(),k&&l<s&&(n.length=l),this&&this!==u&&this instanceof p&&(y=nt||ta(y)),y.apply(it,n))}var k=i&b,d=i&s,w=i&ut,v=i&(y|ht),g=i&gi,nt=w?n:ta(t);return p}function kk(n,t){return function(i,r){return eut(i,n,t(r),{})}}function hv(t,i){return function(r,u){var f;if(r===n&&u===n)return i;if(r!==n&&(f=r),u!==n){if(f===n)return u;typeof r=="string"||typeof u=="string"?(r=cf(r),u=cf(u)):(r=ik(r),u=ik(u));f=t(r,u)}return f}}function sp(n){return sh(function(t){return t=r(t,e(vt())),cr(function(i){var r=this;return n(t,function(n){return f(n,r,i)})})})}function cv(t,i){var r,u;return(i=i===n?" ":cf(i),r=i.length,r<2)?r?np(i,t):i:(u=np(i,wa(t/wt(i))),pt(i)?yc(v(u),0,t).join(""):u.slice(0,t))}function cft(n,t,i,r){function e(){for(var a=-1,c=arguments.length,t=-1,l=r.length,s=bu(l+c),v=this&&this!==u&&this instanceof e?h:n;++t<l;)s[t]=r[t];while(c--)s[t++]=arguments[++a];return f(v,o?i:this,s)}var o=t&s,h=ta(n);return e}function dk(t){return function(i,r,u){return u&&typeof u!="number"&&uf(i,r,u)&&(r=u=n),i=sc(i),r===n?(r=i,i=0):r=sc(r),u=u===n?i<r?1:-1:sc(u),kut(i,r,u,t)}}function lv(n){return function(t,i){return typeof t=="string"&&typeof i=="string"||(t=ue(t),i=ue(i)),n(t,i)}}function gk(t,i,r,u,f,e,o,h,c,l){var a=i&y,b=a?o:n,k=a?n:o,d=a?e:n,g=a?n:e,w,v;return i|=a?p:ct,i&=~(a?ct:p),i&ou||(i&=~(s|ut)),w=[t,i,f,d,b,g,k,h,c,l],v=r.apply(n,w),pp(t)&&vd(v,w),v.placeholder=u,yd(v,t,i)}function hp(n){var t=rl[n];return function(n,i){if(n=ue(n),i=i==null?0:nf(yi(i),292),i){var r=(ar(n)+"e").split("e"),u=t(r[0]+"e"+(+r[1]+i));return r=(ar(u)+"e").split("e"),+(r[0]+"e"+(+r[1]-i))}return t(n)}}function td(n){return function(t){var i=tf(t);return i==l?uu(t):i==a?oc(t):tc(t,n(t))}}function oh(t,i,r,u,f,e,h,c){var w=i&ut,a,b,k,v,l,d,g;if(!w&&typeof t!="function")throw new af(o);return a=u?u.length:0,a||(i&=~(p|ct),u=f=n),h=h===n?h:ku(yi(h),0),c=c===n?c:yi(c),a-=f?f.length:0,i&ct&&(b=u,k=f,u=f=n),v=w?n:av(t),l=[t,i,r,u,f,b,k,e,h,c],v&&ret(l,v),t=l[0],i=l[1],r=l[2],u=l[3],f=l[4],c=l[9]=l[9]===n?w?0:t.length:ku(l[9]-a,0),!c&&i&(y|ht)&&(i&=~(y|ht)),d=i&&i!=s?i==y||i==ht?hft(t,i,c):i!=p&&i!=(s|p)||f.length?sv.apply(n,l):cft(t,i,r,u):sft(t,i,r),g=v?tp:vd,yd(g(d,l),t,i)}function id(t,i,r,u){return t===n||ks(t,ul[r])&&!vr.call(u,r)?i:t}function rd(t,i,r,u,f,e){return pr(t)&&pr(i)&&(e.set(i,t),uv(t,i,n,rd,e),e["delete"](i)),t}function lft(t){return fa(t)?n:t}function ud(t,i,r,u,f,e){var p=r&st,l=t.length,w=i.length,a,o,h,y;if(l!=w&&!(p&&w>l))return!1;if(a=e.get(t),a&&e.get(i))return a==i;var s=-1,c=!0,v=r&ei?new kc:n;for(e.set(t,i),e.set(i,t);++s<l;){if(o=t[s],h=i[s],u&&(y=p?u(h,o,s,i,t,e):u(o,h,s,t,i,e)),y!==n){if(y)continue;c=!1;break}if(v){if(!dr(i,function(n,t){if(!ui(v,t)&&(o===n||f(o,n,r,u,e)))return v.push(t)})){c=!1;break}}else if(!(o===h||f(o,h,r,u,e))){c=!1;break}}return e["delete"](t),e["delete"](i),c}function aft(n,t,i,r,u,f,e){var o,h,s,c;switch(i){case at:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer;t=t.buffer;case ri:return n.byteLength!=t.byteLength||!f(new aa(n),new aa(t))?!1:!0;case kt:case dt:case gt:return ks(+n,+t);case hi:return n.name==t.name&&n.message==t.message;case ni:case ti:return n==t+"";case l:o=uu;case a:return(h=r&st,o||(o=bi),n.size!=t.size&&!h)?!1:(s=e.get(n),s)?s==t:(r|=ei,e.set(n,t),c=ud(o(n),o(t),r,u,f,e),e["delete"](n),c);case li:if(wl)return wl.call(n)==wl.call(t)}return!1}function vft(t,i,r,u,f,e){var y=r&st,w=cp(t),b=w.length,g=cp(i),nt=g.length,s,o,k,h,p,c,l,d,a,v;if(b!=nt&&!y)return!1;for(s=b;s--;)if(o=w[s],!(y?o in i:vr.call(i,o)))return!1;if(k=e.get(t),k&&e.get(i))return k==i;for(h=!0,e.set(t,i),e.set(i,t),p=y;++s<b;){if(o=w[s],c=t[o],l=i[o],u&&(d=y?u(l,c,o,i,t,e):u(c,l,o,t,i,e)),!(d===n?c===l||f(c,l,r,u,e):d)){h=!1;break}p||(p=o=="constructor")}return h&&!p&&(a=t.constructor,v=i.constructor,a!=v&&"constructor"in t&&"constructor"in i&&!(typeof a=="function"&&a instanceof a&&typeof v=="function"&&v instanceof v)&&(h=!1)),e["delete"](t),e["delete"](i),h}function sh(t){return bp(ld(t,n,dd),t+"")}function cp(n){return cb(n,du,vp)}function lp(n){return cb(n,sf,fd)}function vv(n){for(var t=n.name+"",u=pl[t],f=vr.call(pl,t)?u.length:0,i,r;f--;)if(i=u[f],r=i.func,r==null||r==n)return i.name;return t}function hl(n){var t=vr.call(et,"placeholder")?et:n;return t.placeholder}function vt(){var n=et.iteratee||lw;return n=n===lw?vb:n,arguments.length?n(arguments[0],arguments[1]):n}function yv(n,t){var i=n.__data__;return net(t)?i[typeof t=="string"?"string":"hash"]:i.map}function ap(n){for(var t=du(n),i=t.length,r,u;i--;)r=t[i],u=n[r],t[i]=[r,u,hd(u)];return t}function gc(t,i){var r=uc(t,i);return ab(r)?r:n}function yft(t){var u=vr.call(t,pc),f=t[pc],i,r;try{t[pc]=n;i=!0}catch(e){}return r=ca.call(t),i&&(u?t[pc]=f:delete t[pc]),r}function pft(n,t,i){for(var f=-1,e=i.length,u,r;++f<e;){u=i[f];r=u.size;switch(u.type){case"drop":n+=r;break;case"dropRight":t-=r;break;case"take":t=nf(t,n+r);break;case"takeRight":n=ku(n,t-r)}}return{start:n,end:t}}function wft(n){var t=n.match(es);return t?t[1].split(os):[]}function ed(n,t,i){var u;t=vc(t,n);for(var f=-1,r=t.length,e=!1;++f<r;){if(u=nh(t[f]),!(e=n!=null&&i(n,u)))break;n=n[u]}return e||++f!=r?e:(r=n==null?0:n.length,!!r&&ny(r)&&lh(u,r)&&(vi(n)||tl(n)))}function bft(n){var i=n.length,t=new n.constructor(i);return i&&typeof n[0]=="string"&&vr.call(n,"index")&&(t.index=n.index,t.input=n.input),t}function od(n){return typeof n.constructor=="function"&&!ia(n)?wc(va(n)):{}}function kft(n,t,i){var r=n.constructor;switch(t){case ri:return op(n);case kt:case dt:return new r(+n);case at:return ift(n,i);case nr:case tr:case ir:case rr:case ur:case fr:case er:case or:case sr:return hk(n,i);case l:return new r;case gt:case ti:return new r(n);case ni:return rft(n);case a:return new r;case li:return uft(n)}}function dft(n,t){var i=t.length,r;return i?(r=i-1,t[r]=(i>1?"& ":"")+t[r],t=t.join(i>2?", ":" "),n.replace(fs,"{\n/* [wrapped with "+t+"] */\n")):n}function gft(n){return vi(n)||tl(n)||!!(tb&&n&&n[tb])}function lh(n,t){var i=typeof n;return t=t==null?nt:t,!!t&&(i=="number"||i!="symbol"&&ps.test(n))&&n>-1&&n%1==0&&n<t}function uf(n,t,i){if(!pr(i))return!1;var r=typeof t;return(r=="number"?ef(i)&&lh(t,i.length):r=="string"&&t in i)?ks(i[t],n):!1}function yp(n,t){if(vi(n))return!1;var i=typeof n;return i=="number"||i=="symbol"||i=="boolean"||n==null||lf(n)?!0:ts.test(n)||!ns.test(n)||t!=null&&n in yr(t)}function net(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}function pp(n){var r=vv(n),t=et[r],i;return typeof t!="function"||!(r in lr.prototype)?!1:n===t?!0:(i=av(t),!!i&&n===i[0])}function tet(n){return!!kw&&kw in n}function ia(n){var t=n&&n.constructor,i=typeof t=="function"&&t.prototype||ul;return n===i}function hd(n){return n===n&&!pr(n)}function cd(t,i){return function(r){return r==null?!1:r[t]===i&&(i!==n||t in yr(r))}}function iet(n){var t=dv(n,function(n){return i.size===be&&i.clear(),n}),i=t.cache;return t}function ret(n,t){var f=n[1],u=t[1],e=f|u,o=e<(s|ut|b),h=u==b&&f==y||u==b&&f==bt&&n[7].length<=t[8]||u==(b|bt)&&t[7].length<=t[8]&&f==y,i,r;return(o||h)?(u&s&&(n[2]=t[2],e|=f&s?0:ou),i=t[3],i&&(r=n[3],n[3]=r?lk(r,i,t[4]):i,n[4]=r?rt(n[3],fi):t[4]),i=t[5],i&&(r=n[5],n[5]=r?ak(r,i,t[6]):i,n[6]=r?rt(n[5],fi):t[6]),i=t[7],i&&(n[7]=i),u&b&&(n[8]=n[8]==null?t[8]:nf(n[8],t[8])),n[9]==null&&(n[9]=t[9]),n[0]=t[0],n[1]=e,n):n}function uet(n){var t=[],i;if(n!=null)for(i in yr(n))t.push(i);return t}function fet(n){return ca.call(n)}function ld(t,i,r){return i=ku(i===n?t.length-1:i,0),function(){for(var e=arguments,n=-1,o=ku(e.length-i,0),s=bu(o),u;++n<o;)s[n]=e[i+n];for(n=-1,u=bu(i+1);++n<i;)u[n]=e[n];return u[i]=r(s),f(t,this,u)}}function ad(n,t){return t.length<2?n:el(n,pf(t,0,-1))}function eet(t,i){for(var f=t.length,r=nf(i.length,f),e=ff(t),u;r--;)u=i[r],t[r]=lh(u,f)?e[u]:n;return t}function wp(n,t){if(t!="__proto__")return n[t]}function yd(n,t,i){var r=t+"";return bp(n,dft(r,oet(wft(r),i)))}function pd(t){var i=0,r=0;return function(){var u=fit(),f=no-(u-r);if(r=u,f>0){if(++i>=ge)return arguments[0]}else i=0;return t.apply(n,arguments)}}function pv(t,i){var r=-1,f=t.length,o=f-1,u,e;for(i=i===n?f:i;++r<i;)u=gy(r,o),e=t[u],t[u]=t[r],t[r]=e;return t.length=i,t}function nh(n){if(typeof n=="string"||lf(n))return n;var t=n+"";return t=="0"&&1/n==-ft?"-0":t}function nl(n){if(n!=null){try{return ha.call(n)}catch(t){}try{return n+""}catch(t){}}return""}function oet(n,t){return c(eo,function(i){var r="_."+i[0];t&i[1]&&!pi(n,r)&&n.push(r)}),n.sort()}function wd(n){if(n instanceof lr)return n.clone();var t=new vf(n.__wrapped__,n.__chain__);return t.__actions__=ff(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}function set(t,i,r){var u;if(i=(r?uf(t,i,r):i===n)?1:ku(yi(i),0),u=t==null?0:t.length,!u||i<1)return[];for(var f=0,o=0,e=bu(wa(u/i));f<u;)e[o++]=pf(t,f,f+=i);return e}function het(n){for(var i=-1,u=n==null?0:n.length,f=0,r=[],t;++i<u;)t=n[i],t&&(r[f++]=t);return r}function cet(){var n=arguments.length;if(!n)return[];for(var r=bu(n-1),t=arguments[0],i=n;i--;)r[i-1]=arguments[i];return it(vi(t)?ff(t):[t],gu(r,1))}function pet(t,i,r){var u=t==null?0:t.length;return u?(i=r||i===n?1:yi(i),pf(t,i<0?0:i,u)):[]}function wet(t,i,r){var u=t==null?0:t.length;return u?(i=r||i===n?1:yi(i),i=u-i,pf(t,0,i<0?0:i)):[]}function bet(n,t){return n&&n.length?ev(n,vt(t,3),!0,!0):[]}function ket(n,t){return n&&n.length?ev(n,vt(t,3),!0):[]}function det(n,t,i,r){var u=n==null?0:n.length;return u?(i&&typeof i!="number"&&uf(n,t,i)&&(i=0,r=u),iut(n,t,i,r)):[]}function bd(n,t,i){var u=n==null?0:n.length,r;return u?(r=i==null?0:yi(i),r<0&&(r=ku(u+r,0)),wi(n,vt(t,3),r)):-1}function kd(t,i,r){var f=t==null?0:t.length,u;return f?(u=f-1,r!==n&&(u=yi(r),u=r<0?ku(f+u,0):nf(u,f-1)),wi(t,vt(i,3),u,!0)):-1}function dd(n){var t=n==null?0:n.length;return t?gu(n,1):[]}function get(n){var t=n==null?0:n.length;return t?gu(n,ft):[]}function not(t,i){var r=t==null?0:t.length;return r?(i=i===n?1:yi(i),gu(t,i)):[]}function tot(n){for(var i=-1,u=n==null?0:n.length,r={},t;++i<u;)t=n[i],r[t[0]]=t[1];return r}function gd(t){return t&&t.length?t[0]:n}function iot(n,t,i){var u=n==null?0:n.length,r;return u?(r=i==null?0:yi(i),r<0&&(r=ku(u+r,0)),yt(n,t,r)):-1}function rot(n){var t=n==null?0:n.length;return t?pf(n,0,-1):[]}function oot(n,t){return n==null?"":rit.call(n,t)}function wf(t){var i=t==null?0:t.length;return i?t[i-1]:n}function sot(t,i,r){var f=t==null?0:t.length,u;return f?(u=f,r!==n&&(u=yi(r),u=u<0?ku(f+u,0):nf(u,f-1)),i===i?hc(t,i,u):wi(t,ee,u,!0)):-1}function hot(t,i){return t&&t.length?bb(t,yi(i)):n}function tg(n,t){return n&&n.length&&t&&t.length?dy(n,t):n}function cot(n,t,i){return n&&n.length&&t&&t.length?dy(n,t,vt(i,2)):n}function lot(t,i,r){return t&&t.length&&i&&i.length?dy(t,i,n,r):t}function aot(n,t){var r=[],u;if(!(n&&n.length))return r;var i=-1,f=[],e=n.length;for(t=vt(t,3);++i<e;)u=n[i],t(u,i,n)&&(r.push(u),f.push(i));return gb(n,f),r}function dp(n){return n==null?n:oit.call(n)}function vot(t,i,r){var u=t==null?0:t.length;return u?(r&&typeof r!="number"&&uf(t,i,r)?(i=0,r=u):(i=i==null?0:yi(i),r=r===n?u:yi(r)),pf(t,i,r)):[]}function yot(n,t){return fv(n,t)}function pot(n,t,i){return ip(n,t,vt(i,2))}function wot(n,t){var r=n==null?0:n.length,i;return r&&(i=fv(n,t),i<r&&ks(n[i],t))?i:-1}function bot(n,t){return fv(n,t,!0)}function kot(n,t,i){return ip(n,t,vt(i,2),!0)}function dot(n,t){var r=n==null?0:n.length,i;return r&&(i=fv(n,t,!0)-1,ks(n[i],t))?i:-1}function got(n){return n&&n.length?tk(n):[]}function nst(n,t){return n&&n.length?tk(n,vt(t,2)):[]}function tst(n){var t=n==null?0:n.length;return t?pf(n,1,t):[]}function ist(t,i,r){return(t&&t.length)?(i=r||i===n?1:yi(i),pf(t,0,i<0?0:i)):[]}function rst(t,i,r){var u=t==null?0:t.length;return u?(i=r||i===n?1:yi(i),i=u-i,pf(t,i<0?0:i,u)):[]}function ust(n,t){return n&&n.length?ev(n,vt(t,3),!1,!0):[]}function fst(n,t){return n&&n.length?ev(n,vt(t,3)):[]}function hst(n){return n&&n.length?lc(n):[]}function cst(n,t){return n&&n.length?lc(n,vt(t,2)):[]}function lst(t,i){return i=typeof i=="function"?i:n,t&&t.length?lc(t,n,i):[]}function gp(n){if(!(n&&n.length))return[];var t=0;return n=tt(n,function(n){if(nu(n))return t=ku(n.length,t),!0}),iu(t,function(t){return r(n,gr(t))})}function rg(t,i){if(!(t&&t.length))return[];var u=gp(t);return i==null?u:r(u,function(t){return f(i,n,t)})}function bst(n,t){return fk(n||[],t||[],bl)}function kst(n,t){return fk(n||[],t||[],na)}function fg(n){var t=et(n);return t.__chain__=!0,t}function dst(n,t){return t(n),n}function wv(n,t){return t(n)}function gst(){return fg(this)}function nht(){return new vf(this.value(),this.__chain__)}function tht(){this.__values__===n&&(this.__values__=cn(this.value()));var t=this.__index__>=this.__values__.length,i=t?n:this.__values__[this.__index__++];return{done:t,value:i}}function iht(){return this}function rht(t){for(var u,r=this,i,f;r instanceof ga;)i=wd(r),i.__index__=0,i.__values__=n,u?f.__wrapped__=i:u=i,f=i,r=r.__wrapped__;return f.__wrapped__=t,u}function uht(){var i=this.__wrapped__,t;return i instanceof lr?(t=i,this.__actions__.length&&(t=new lr(this)),t=t.reverse(),t.__actions__.push({func:wv,args:[dp],thisArg:n}),new vf(t,this.__chain__)):this.thru(dp)}function fht(){return uk(this.__wrapped__,this.__actions__)}function eht(t,i,r){var u=vi(t)?re:tut;return r&&uf(t,i,r)&&(i=n),u(t,vt(i,3))}function oht(n,t){var i=vi(n)?tt:hb;return i(n,vt(t,3))}function sht(n,t){return gu(bv(n,t),1)}function hht(n,t){return gu(bv(n,t),ft)}function cht(t,i,r){return r=r===n?1:yi(r),gu(bv(t,i),r)}function cg(n,t){var i=vi(n)?c:eh;return i(n,vt(t,3))}function lg(n,t){var i=vi(n)?wh:ly;return i(n,vt(t,3))}function lht(n,t,i,r){n=ef(n)?n:cl(n);i=i&&!r?yi(i):0;var u=n.length;return i<0&&(i=ku(u+i,0)),iy(n)?i<=u&&n.indexOf(t,i)>-1:!!u&&yt(n,t,i)>-1}function bv(n,t){var i=vi(n)?r:yb;return i(n,vt(t,3))}function aht(t,i,r,u){return t==null?[]:(vi(i)||(i=i==null?[]:[i]),r=u?n:r,vi(r)||(r=r==null?[]:[r]),kb(t,i,r))}function vht(n,t,i){var r=vi(n)?kr:se,u=arguments.length<3;return r(n,vt(t,4),i,u,eh)}function yht(n,t,i){var r=vi(n)?bh:se,u=arguments.length<3;return r(n,vt(t,4),i,u,ly)}function pht(n,t){var i=vi(n)?tt:hb;return i(n,gv(vt(t,3)))}function wht(n){var t=vi(n)?fb:dut;return t(n)}function bht(t,i,r){i=(r?uf(t,i,r):i===n)?1:yi(i);var u=vi(t)?brt:gut;return u(t,i)}function kht(n){var t=vi(n)?krt:nft;return t(n)}function dht(n){if(n==null)return 0;if(ef(n))return iy(n)?wt(n):n.length;var t=tf(n);return t==l||t==a?n.size:by(n).length}function ght(t,i,r){var u=vi(t)?dr:tft;return r&&uf(t,i,r)&&(i=n),u(t,vt(i,3))}function nct(n,t){if(typeof t!="function")throw new af(o);return n=yi(n),function(){if(--n<1)return t.apply(this,arguments)}}function bg(t,i,r){return i=r?n:i,i=t&&i==null?t.length:i,oh(t,b,n,n,n,n,i)}function kg(t,i){var r;if(typeof i!="function")throw new af(o);return t=yi(t),function(){return--t>0&&(r=i.apply(this,arguments)),t<=1&&(i=n),r}}function dg(t,i,r){i=r?n:i;var u=oh(t,y,n,n,n,n,n,i);return u.placeholder=dg.placeholder,u}function gg(t,i,r){i=r?n:i;var u=oh(t,ht,n,n,n,n,n,i);return u.placeholder=gg.placeholder,u}function nn(t,i,r){function p(i){var r=e,u=h;return e=h=n,c=i,s=t.apply(u,r)}function g(n){return c=n,u=ra(v,i),b?p(n):s}function nt(n){var r=n-f,u=n-c,t=i-r;return l?nf(t,a-u):t}function k(t){var r=t-f,u=t-c;return f===n||r>=i||r<0||l&&u>=a}function v(){var n=ua();if(k(n))return d(n);u=ra(v,nt(n))}function d(t){return(u=n,y&&e)?p(t):(e=h=n,s)}function tt(){u!==n&&ok(u);c=0;e=f=h=u=n}function it(){return u===n?s:d(ua())}function w(){var t=ua(),r=k(t);if(e=arguments,h=this,f=t,r){if(u===n)return g(f);if(l)return u=ra(v,i),p(f)}return u===n&&(u=ra(v,i)),s}var e,h,a,s,u,f,c=0,b=!1,l=!1,y=!0;if(typeof t!="function")throw new af(o);return i=ue(i)||0,pr(r)&&(b=!!r.leading,l="maxWait"in r,a=l?ku(ue(r.maxWait)||0,i):a,y="trailing"in r?!!r.trailing:y),w.cancel=tt,w.flush=it,w}function tct(n){return oh(n,gi)}function dv(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new af(o);var i=function(){var u=arguments,f=t?t.apply(this,u):u[0],r=i.cache,e;return r.has(f)?r.get(f):(e=n.apply(this,u),i.cache=r.set(f,e)||r,e)};return i.cache=new(dv.Cache||ih),i}function gv(n){if(typeof n!="function")throw new af(o);return function(){var t=arguments;switch(t.length){case 0:return!n.call(this);case 1:return!n.call(this,t[0]);case 2:return!n.call(this,t[0],t[1]);case 3:return!n.call(this,t[0],t[1],t[2])}return!n.apply(this,t)}}function ict(n){return kg(2,n)}function fct(t,i){if(typeof t!="function")throw new af(o);return i=i===n?i:yi(i),cr(t,i)}function ect(n,t){if(typeof n!="function")throw new af(o);return t=t==null?0:ku(yi(t),0),cr(function(i){var r=i[t],u=yc(i,0,t);return r&&it(u,r),f(n,this,u)})}function oct(n,t,i){var r=!0,u=!0;if(typeof n!="function")throw new af(o);return pr(i)&&(r="leading"in i?!!i.leading:r,u="trailing"in i?!!i.trailing:u),nn(n,t,{leading:r,maxWait:t,trailing:u})}function sct(n){return bg(n,1)}function hct(n,t){return tw(ep(t),n)}function cct(){if(!arguments.length)return[];var n=arguments[0];return vi(n)?n:[n]}function lct(n){return yf(n,ot)}function act(t,i){return i=typeof i=="function"?i:n,yf(t,ot,i)}function vct(n){return yf(n,g|ot)}function yct(t,i){return i=typeof i=="function"?i:n,yf(t,g|ot,i)}function pct(n,t){return t==null||ob(n,t,du(t))}function ks(n,t){return n===t||n!==n&&t!==t}function ef(n){return n!=null&&ny(n.length)&&!kh(n)}function nu(n){return wr(n)&&ef(n)}function dct(n){return n===!0||n===!1||wr(n)&&rf(n)==kt}function gct(n){return wr(n)&&n.nodeType===1&&!fa(n)}function nlt(n){var t,i;if(n==null)return!0;if(ef(n)&&(vi(n)||typeof n=="string"||typeof n.splice=="function"||yh(n)||il(n)||tl(n)))return!n.length;if(t=tf(n),t==l||t==a)return!n.size;if(ia(n))return!by(n).length;for(i in n)if(vr.call(n,i))return!1;return!0}function tlt(n,t){return gl(n,t)}function ilt(t,i,r){r=typeof r=="function"?r:n;var u=r?r(t,i):n;return u===n?gl(t,i,n,r):!!u}function iw(n){if(!wr(n))return!1;var t=rf(n);return t==hi||t==so||typeof n.message=="string"&&typeof n.name=="string"&&!fa(n)}function rlt(n){return typeof n=="number"&&iit(n)}function kh(n){if(!pr(n))return!1;var t=rf(n);return t==ci||t==hu||t==oo||t==co}function en(n){return typeof n=="number"&&n==yi(n)}function ny(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=nt}function pr(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}function wr(n){return n!=null&&typeof n=="object"}function ult(n,t){return n===t||wy(n,t,ap(t))}function flt(t,i,r){return r=typeof r=="function"?r:n,wy(t,i,ap(i),r)}function elt(n){return on(n)&&n!=+n}function olt(n){if(sd(n))throw new ww(we);return ab(n)}function slt(n){return n===null}function hlt(n){return n==null}function on(n){return typeof n=="number"||wr(n)&&rf(n)==gt}function fa(n){var i,t;return!wr(n)||rf(n)!=k?!1:(i=va(n),i===null)?!0:(t=vr.call(i,"constructor")&&i.constructor,typeof t=="function"&&t instanceof t&&ha.call(t)==wtt)}function clt(n){return en(n)&&n>=-nt&&n<=nt}function iy(n){return typeof n=="string"||!vi(n)&&wr(n)&&rf(n)==ti}function lf(n){return typeof n=="symbol"||wr(n)&&rf(n)==li}function llt(t){return t===n}function alt(n){return wr(n)&&tf(n)==ii}function vlt(n){return wr(n)&&rf(n)==ao}function cn(n){if(!n)return[];if(ef(n))return iy(n)?v(n):ff(n);if(ll&&n[ll])return ec(n[ll]());var t=tf(n),i=t==l?uu:t==a?bi:cl;return i(n)}function sc(n){if(!n)return n===0?n:0;if(n=ue(n),n===ft||n===-ft){var t=n<0?-1:1;return t*ro}return n===n?n:0}function yi(n){var t=sc(n),i=t%1;return t===t?i?t-i:t:0}function ln(n){return n?dc(yi(n),0,w):0}function ue(n){var t,i;return typeof n=="number"?n:lf(n)?oi:(pr(n)&&(t=typeof n.valueOf=="function"?n.valueOf():n,n=pr(t)?t+"":t),typeof n!="string")?n===0?n:+n:(n=n.replace(yu,""),i=as.test(n),i||ys.test(n)?vh(n.slice(2),i?2:8):ls.test(n)?oi:+n)}function an(n){return gs(n,sf(n))}function ylt(n){return n?dc(yi(n),-nt,nt):n===0?n:0}function ar(n){return n==null?"":cf(n)}function klt(n,t){var i=wc(n);return t==null?i:eb(i,t)}function dlt(n,t){return fe(n,vt(t,3),ds)}function glt(n,t){return fe(n,vt(t,3),vy)}function nat(n,t){return n==null?n:iv(n,vt(t,3),sf)}function tat(n,t){return n==null?n:ay(n,vt(t,3),sf)}function iat(n,t){return n&&ds(n,vt(t,3))}function rat(n,t){return n&&vy(n,vt(t,3))}function uat(n){return n==null?[]:rv(n,du(n))}function fat(n){return n==null?[]:rv(n,sf(n))}function fw(t,i,r){var u=t==null?n:el(t,i);return u===n?r:u}function eat(n,t){return n!=null&&ed(n,t,rut)}function ew(n,t){return n!=null&&ed(n,t,uut)}function du(n){return ef(n)?ub(n):by(n)}function sf(n){return ef(n)?ub(n,!0):yut(n)}function cat(n,t){var i={};return t=vt(t,3),ds(n,function(n,r,u){rh(i,t(n,r,u),n)}),i}function lat(n,t){var i={};return t=vt(t,3),ds(n,function(n,r,u){rh(i,r,t(n,r,u))}),i}function yat(n,t){return kn(n,gv(vt(t)))}function kn(n,t){if(n==null)return{};var i=r(lp(n),function(n){return[n]});return t=vt(t),db(n,i,function(n,i){return t(n,i[0])})}function pat(t,i,r){var e,f,u;for(i=vc(i,t),e=-1,f=i.length,f||(f=1,t=n);++e<f;)u=t==null?n:t[nh(i[e])],u===n&&(e=f,u=r),t=kh(u)?u.call(t):u;return t}function wat(n,t,i){return n==null?n:na(n,t,i)}function bat(t,i,r,u){return u=typeof u=="function"?u:n,t==null?t:na(t,i,r,u)}function kat(n,t,i){var u=vi(n),f=u||yh(n)||il(n),r;return t=vt(t,4),i==null&&(r=n&&n.constructor,i=f?u?new r:[]:pr(n)?kh(r)?wc(va(n)):{}:{}),(f?c:ds)(n,function(n,r,u){return t(i,n,r,u)}),i}function dat(n,t){return n==null?!0:rp(n,t)}function gat(n,t,i){return n==null?n:rk(n,t,ep(i))}function nvt(t,i,r,u){return u=typeof u=="function"?u:n,t==null?t:rk(t,i,ep(r),u)}function cl(n){return n==null?[]:ru(n,du(n))}function tvt(n){return n==null?[]:ru(n,sf(n))}function ivt(t,i,r){return r===n&&(r=i,i=n),r!==n&&(r=ue(r),r=r===r?r:0),i!==n&&(i=ue(i),i=i===i?i:0),dc(ue(t),i,r)}function rvt(t,i,r){return i=sc(i),r===n?(r=i,i=0):r=sc(r),t=ue(t),fut(t,i,r)}function uvt(t,i,r){var f,u;return(r&&typeof r!="boolean"&&uf(t,i,r)&&(i=r=n),r===n&&(typeof i=="boolean"?(r=i,i=n):typeof t=="boolean"&&(r=t,t=n)),t===n&&i===n?(t=0,i=1):(t=sc(t),i===n?(i=t,t=0):i=sc(i)),t>i&&(f=t,t=i,i=f),r||t%1||i%1)?(u=ib(),nf(t+u*(i-t+ah("1e-"+((u+"").length-1))),i)):gy(t,i)}function gn(n){return uy(ar(n).toLowerCase())}function ntt(n){return n=ar(n),n&&n.replace(ws,le).replace(fh,"")}function fvt(t,i,r){var u,f;return t=ar(t),i=cf(i),u=t.length,r=r===n?u:dc(yi(r),0,u),f=r,r-=i.length,r>=0&&t.slice(r,f)==i}function evt(n){return n=ar(n),n&&bo.test(n)?n.replace(au,ae):n}function ovt(n){return n=ar(n),n&&rs.test(n)?n.replace(hr,"\\$&"):n}function lvt(n,t,i){var r,u;return(n=ar(n),t=yi(t),r=t?wt(n):0,!t||r>=t)?n:(u=(t-r)/2,cv(ba(u),i)+n+cv(wa(u),i))}function avt(n,t,i){n=ar(n);t=yi(t);var r=t?wt(n):0;return t&&r<t?n+cv(t-r,i):n}function vvt(n,t,i){n=ar(n);t=yi(t);var r=t?wt(n):0;return t&&r<t?cv(t-r,i)+n:n}function yvt(n,t,i){return i||t==null?t=0:t&&(t=+t),eit(ar(n).replace(pu,""),t||0)}function pvt(t,i,r){return i=(r?uf(t,i,r):i===n)?1:yi(i),np(ar(t),i)}function wvt(){var n=arguments,t=ar(n[0]);return n.length<3?t:t.replace(n[1],n[2])}function bvt(t,i,r){return(r&&typeof r!="number"&&uf(t,i,r)&&(i=r=n),r=r===n?w:r>>>0,!r)?[]:(t=ar(t),t&&(typeof i=="string"||i!=null&&!ty(i))&&(i=cf(i),!i&&pt(t)))?yc(v(t),0,r):t.split(i,r)}function kvt(n,t,i){return n=ar(n),i=i==null?0:dc(yi(i),0,n.length),t=cf(t),n.slice(i,i+t.length)==t}function dvt(t,i,r){var s=et.templateSettings,e,f;r&&uf(t,i,r)&&(i=n);t=ar(t);i=ry({},i,s,id);var h=ry({},i.imports,s.imports,id),c=du(h),y=ru(h,c),l,o,a=0,v=i.interpolate||ai,u="__p += '",p=fy((i.escape||ai).source+"|"+v.source+"|"+(v===vu?cs:ai).source+"|"+(i.evaluate||ai).source+"|$","g"),w="//# sourceURL="+("sourceURL"in i?i.sourceURL:"lodash.templateSources["+ ++ch+"]")+"\n";if(t.replace(p,function(n,i,r,f,e,s){return r||(r=f),u+=t.slice(a,s).replace(bs,rc),i&&(l=!0,u+="' +\n__e("+i+") +\n'"),e&&(o=!0,u+="';\n"+e+";\n__p += '"),r&&(u+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),a=s+n.length,n}),u+="';\n",e=i.variable,e||(u="with (obj) {\n"+u+"\n}\n"),u=(o?u.replace(vo,""):u).replace(yo,"$1").replace(po,"$1;"),u="function("+(e||"obj")+") {\n"+(e?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(l?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}",f=hw(function(){return bw(c,w+"return "+u).apply(n,y)}),f.source=u,iw(f))throw f;return f}function gvt(n){return ar(n).toLowerCase()}function nyt(n){return ar(n).toUpperCase()}function tyt(t,i,r){if(t=ar(t),t&&(r||i===n))return t.replace(yu,"");if(!t||!(i=cf(i)))return t;var u=v(t),f=v(i),e=he(u,f),o=ce(u,f)+1;return yc(u,e,o).join("")}function iyt(t,i,r){if(t=ar(t),t&&(r||i===n))return t.replace(us,"");if(!t||!(i=cf(i)))return t;var u=v(t),f=ce(u,v(i))+1;return yc(u,0,f).join("")}function ryt(t,i,r){if(t=ar(t),t&&(r||i===n))return t.replace(pu,"");if(!t||!(i=cf(i)))return t;var u=v(t),f=he(u,v(i));return yc(u,f).join("")}function uyt(t,i){var s=ke,e=de,r,h,o,u,f,a,y,c,l;if(pr(i)&&(r="separator"in i?i.separator:r,s="length"in i?yi(i.length):s,e="omission"in i?cf(i.omission):e),t=ar(t),h=t.length,pt(t)&&(o=v(t),h=o.length),s>=h)return t;if(u=s-wt(e),u<1)return e;if(f=o?yc(o,0,u).join(""):t.slice(0,u),r===n)return f+e;if(o&&(u+=f.length-u),ty(r)){if(t.slice(u).search(r)){for(y=f,r.global||(r=fy(r.source,ar(wu.exec(r))+"g")),r.lastIndex=0;a=r.exec(y);)c=a.index;f=f.slice(0,c===n?u:c)}}else t.indexOf(cf(r),u)!=u&&(l=f.lastIndexOf(r),l>-1&&(f=f.slice(0,l)));return f+e}function fyt(n){return n=ar(n),n&&wo.test(n)?n.replace(lu,ye):n}function utt(t,i,r){return(t=ar(t),i=r?n:i,i===n)?fc(t)?ac(t):dh(t):t.match(i)||[]}function eyt(n){var t=n==null?0:n.length,i=vt();return n=t?r(n,function(n){if(typeof n[1]!="function")throw new af(o);return[i(n[0]),n[1]]}):[],cr(function(i){for(var u=-1,r;++u<t;)if(r=n[u],f(r[0],this,i))return f(r[1],this,i)})}function oyt(n){return nut(yf(n,g))}function cw(n){return function(){return n}}function syt(n,t){return n==null||n!==n?t:n}function hf(n){return n}function lw(n){return vb(typeof n=="function"?n:yf(n,g))}function hyt(n){return pb(yf(n,g))}function cyt(n,t){return wb(n,yf(t,g))}function aw(n,t,i){var u=du(t),r=rv(t,u),f,e;return i!=null||pr(t)&&(r.length||!u.length)||(i=t,t=n,n=this,r=rv(t,du(t))),f=!(pr(i)&&"chain"in i)||!!i.chain,e=kh(n),c(r,function(i){var r=t[i];n[i]=r;e&&(n.prototype[i]=function(){var i=this.__chain__,t,u;return f||i?(t=n(this.__wrapped__),u=t.__actions__=ff(this.__actions__),u.push({func:r,args:arguments,thisArg:n}),t.__chain__=i,t):r.apply(n,it([this.value()],arguments))})}),n}function lyt(){return u._===this&&(u._=btt),this}function vw(){}function ayt(n){return n=yi(n),cr(function(t){return bb(t,n)})}function ctt(n){return yp(n)?gr(nh(n)):but(n)}function wyt(t){return function(i){return t==null?n:el(t,i)}}function yw(){return[]}function pw(){return!1}function byt(){return{}}function kyt(){return""}function dyt(){return!0}function gyt(n,t){var i,r,u;if(n=yi(n),n<1||n>nt)return[];for(i=w,r=nf(n,w),t=vt(t),n-=w,u=iu(r,t);++i<n;)t(i);return u}function npt(n){return vi(n)?r(n,nh):lf(n)?[n]:ff(kp(ar(n)))}function tpt(n){var t=++ptt;return ar(n)+t}function ept(t){return t&&t.length?tv(t,hf,yy):n}function opt(t,i){return t&&t.length?tv(t,vt(i,2),yy):n}function spt(n){return oe(n,hf)}function hpt(n,t){return oe(n,vt(t,2))}function cpt(t){return t&&t.length?tv(t,hf,ky):n}function lpt(t,i){return t&&t.length?tv(t,vt(i,2),ky):n}function ppt(n){return n&&n.length?tu(n,hf):0}function wpt(n,t){return n&&n.length?tu(n,vt(t,2)):0}var wc,eh,ly,iv,ay,tp,nk,ek,ok,nd,av,sd,kp,ng,ig,ug,eg,og,sg,hg,ag,vg,yg,pg,wg,ua,kv,nw,tn,rn,yh,fn,rw,ty,uw,il,sn,hn,yn,pn,bn,ow,sw,dn,ttt,itt,rtt,uy,hw,ftt,ett,ott,stt,htt,ltt,att;h=h==null?u:d.defaults(u.Object(),h,d.pick(u,hh));var bu=h.Array,ea=h.Date,ww=h.Error,bw=h.Function,rl=h.Math,yr=h.Object,fy=h.RegExp,vtt=h.String,af=h.TypeError,oa=bu.prototype,ytt=bw.prototype,ul=yr.prototype,sa=h["__core-js_shared__"],ha=ytt.toString,vr=ul.hasOwnProperty,ptt=0,kw=function(){var n=/[^.]+$/.exec(sa&&sa.keys&&sa.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),ca=ul.toString,wtt=ha.call(yr),btt=u._,ktt=fy("^"+ha.call(vr).replace(hr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),la=bf?h.Buffer:n,cc=h.Symbol,aa=h.Uint8Array,dw=la?la.allocUnsafe:n,va=ve(yr.getPrototypeOf,yr),gw=yr.create,nb=ul.propertyIsEnumerable,ya=oa.splice,tb=cc?cc.isConcatSpreadable:n,ll=cc?cc.iterator:n,pc=cc?cc.toStringTag:n,pa=function(){try{var n=gc(yr,"defineProperty");return n({},"",{}),n}catch(t){}}(),dtt=h.clearTimeout!==u.clearTimeout&&h.clearTimeout,gtt=ea&&ea.now!==u.Date.now&&ea.now,nit=h.setTimeout!==u.setTimeout&&h.setTimeout,wa=rl.ceil,ba=rl.floor,ey=yr.getOwnPropertySymbols,tit=la?la.isBuffer:n,iit=h.isFinite,rit=oa.join,uit=ve(yr.keys,yr),ku=rl.max,nf=rl.min,fit=ea.now,eit=h.parseInt,ib=rl.random,oit=oa.reverse,oy=gc(h,"DataView"),al=gc(h,"Map"),sy=gc(h,"Promise"),fl=gc(h,"Set"),vl=gc(h,"WeakMap"),yl=gc(yr,"create"),ka=vl&&new vl,pl={},sit=nl(oy),hit=nl(al),cit=nl(sy),lit=nl(fl),ait=nl(vl),da=cc?cc.prototype:n,wl=da?da.valueOf:n,rb=da?da.toString:n;wc=function(){function t(){}return function(i){if(!pr(i))return{};if(gw)return gw(i);t.prototype=i;var r=new t;return t.prototype=n,r}}();et.templateSettings={escape:ko,evaluate:go,interpolate:vu,variable:"",imports:{_:et}};et.prototype=ga.prototype;et.prototype.constructor=et;vf.prototype=wc(ga.prototype);vf.prototype.constructor=vf;lr.prototype=wc(ga.prototype);lr.prototype.constructor=lr;bc.prototype.clear=wit;bc.prototype["delete"]=bit;bc.prototype.get=kit;bc.prototype.has=dit;bc.prototype.set=git;th.prototype.clear=nrt;th.prototype["delete"]=trt;th.prototype.get=irt;th.prototype.has=rrt;th.prototype.set=urt;ih.prototype.clear=frt;ih.prototype["delete"]=ert;ih.prototype.get=ort;ih.prototype.has=srt;ih.prototype.set=hrt;kc.prototype.add=kc.prototype.push=crt;kc.prototype.has=lrt;ss.prototype.clear=art;ss.prototype["delete"]=vrt;ss.prototype.get=yrt;ss.prototype.has=prt;ss.prototype.set=wrt;eh=vk(ds);ly=vk(vy,!0);iv=yk();ay=yk(!0);tp=ka?function(n,t){return ka.set(n,t),n}:hf;nk=pa?function(n,t){return pa(n,"toString",{configurable:!0,enumerable:!1,value:cw(t),writable:!0})}:hf;ek=cr;ok=dtt||function(n){return u.clearTimeout(n)};nd=(fl&&1/bi(new fl([,-0]))[1]==ft)?function(n){return new fl(n)}:vw;av=ka?function(n){return ka.get(n)}:vw;var vp=ey?function(n){return n==null?[]:(n=yr(n),tt(ey(n),function(t){return nb.call(n,t)}))}:yw,fd=ey?function(n){for(var t=[];n;)it(t,vp(n)),n=va(n);return t}:yw,tf=rf;(oy&&tf(new oy(new ArrayBuffer(1)))!=at||al&&tf(new al)!=l||sy&&tf(sy.resolve())!=cu||fl&&tf(new fl)!=a||vl&&tf(new vl)!=ii)&&(tf=function(t){var i=rf(t),r=i==k?t.constructor:n,u=r?nl(r):"";if(u)switch(u){case sit:return at;case hit:return l;case cit:return cu;case lit:return a;case ait:return ii}return i});sd=sa?kh:pw;var vd=pd(tp),ra=nit||function(n,t){return u.setTimeout(n,t)},bp=pd(nk);kp=iet(function(n){var t=[];return n.charCodeAt(0)===46&&t.push(""),n.replace(is,function(n,i,r,u){t.push(r?u.replace(hs,"$1"):i||n)}),t});var aet=cr(function(n,t){return nu(n)?kl(n,gu(t,1,nu,!0)):[]}),vet=cr(function(t,i){var r=wf(i);return nu(r)&&(r=n),nu(t)?kl(t,gu(i,1,nu,!0),vt(r,2)):[]}),yet=cr(function(t,i){var r=wf(i);return nu(r)&&(r=n),nu(t)?kl(t,gu(i,1,nu,!0),n,r):[]});var uot=cr(function(n){var t=r(n,fp);return t.length&&t[0]===n[0]?py(t):[]}),fot=cr(function(t){var u=wf(t),i=r(t,fp);return u===wf(i)?u=n:i.pop(),i.length&&i[0]===t[0]?py(i,vt(u,2)):[]}),eot=cr(function(t){var i=wf(t),u=r(t,fp);return i=typeof i=="function"?i:n,i&&u.pop(),u.length&&u[0]===t[0]?py(u,n,i):[]});ng=cr(tg);ig=sh(function(n,t){var i=n==null?0:n.length,u=cy(n,t);return gb(n,r(t,function(n){return lh(n,i)?+n:n}).sort(ck)),u});var est=cr(function(n){return lc(gu(n,1,nu,!0))}),ost=cr(function(t){var i=wf(t);return nu(i)&&(i=n),lc(gu(t,1,nu,!0),vt(i,2))}),sst=cr(function(t){var i=wf(t);return i=typeof i=="function"?i:n,lc(gu(t,1,nu,!0),n,i)});var ast=cr(function(n,t){return nu(n)?kl(n,t):[]}),vst=cr(function(n){return up(tt(n,nu))}),yst=cr(function(t){var i=wf(t);return nu(i)&&(i=n),up(tt(t,nu),vt(i,2))}),pst=cr(function(t){var i=wf(t);return i=typeof i=="function"?i:n,up(tt(t,nu),n,i)}),wst=cr(gp);ug=cr(function(t){var r=t.length,i=r>1?t[r-1]:n;return i=typeof i=="function"?(t.pop(),i):n,rg(t,i)});eg=sh(function(t){var r=t.length,u=r?t[0]:0,i=this.__wrapped__,f=function(n){return cy(n,t)};return r>1||this.__actions__.length||!(i instanceof lr)||!lh(u)?this.thru(f):(i=i.slice(u,+u+(r?1:0)),i.__actions__.push({func:wv,args:[f],thisArg:n}),new vf(i,this.__chain__).thru(function(t){return r&&!t.length&&t.push(n),t}))});og=ov(function(n,t,i){vr.call(n,i)?++n[i]:rh(n,i,1)});sg=wk(bd);hg=wk(kd);ag=ov(function(n,t,i){vr.call(n,i)?n[i].push(t):rh(n,i,[t])});vg=cr(function(n,t,i){var u=-1,e=typeof t=="function",r=ef(n)?bu(n.length):[];return eh(n,function(n){r[++u]=e?f(t,n,i):dl(n,t,i)}),r});yg=ov(function(n,t,i){rh(n,i,t)});pg=ov(function(n,t,i){n[i?0:1].push(t)},function(){return[[],[]]});wg=cr(function(n,t){if(n==null)return[];var i=t.length;return i>1&&uf(n,t[0],t[1])?t=[]:i>2&&uf(t[0],t[1],t[2])&&(t=[t[0]]),kb(n,gu(t,1),[])});ua=gtt||function(){return u.Date.now()};kv=cr(function(n,t,i){var r=s,u;return i.length&&(u=rt(i,hl(kv)),r|=p),oh(n,r,t,i,u)});nw=cr(function(n,t,i){var r=s|ut,u;return i.length&&(u=rt(i,hl(nw)),r|=p),oh(t,r,n,i,u)});tn=cr(function(n,t){return sb(n,1,t)});rn=cr(function(n,t,i){return sb(n,ue(t)||0,i)});dv.Cache=ih;var rct=ek(function(n,t){t=t.length==1&&vi(t[0])?r(t[0],e(vt())):r(gu(t,1),e(vt()));var i=t.length;return cr(function(r){for(var u=-1,e=nf(r.length,i);++u<e;)r[u]=t[u].call(this,r[u]);return f(n,this,r)})}),tw=cr(function(t,i){var r=rt(i,hl(tw));return oh(t,p,n,i,r)}),un=cr(function(t,i){var r=rt(i,hl(un));return oh(t,ct,n,i,r)}),uct=sh(function(t,i){return oh(t,bt,n,n,n,i)});var wct=lv(yy),bct=lv(function(n,t){return n>=t}),tl=lb(function(){return arguments}())?lb:function(n){return wr(n)&&vr.call(n,"callee")&&!nb.call(n,"callee")},vi=bu.isArray,kct=kf?e(kf):out;yh=tit||pw;fn=df?e(df):sut;rw=gf?e(gf):cut;ty=ne?e(ne):lut;uw=te?e(te):aut;il=ie?e(ie):vut;sn=lv(ky);hn=lv(function(n,t){return n<=t});var plt=ol(function(n,t){if(ia(t)||ef(t)){gs(t,du(t),n);return}for(var i in t)vr.call(t,i)&&bl(n,i,t[i])}),vn=ol(function(n,t){gs(t,sf(t),n)}),ry=ol(function(n,t,i,r){gs(t,sf(t),n,r)}),wlt=ol(function(n,t,i,r){gs(t,du(t),n,r)}),blt=sh(cy);yn=cr(function(t,i){var r,f;t=yr(t);var e=-1,u=i.length,o=u>2?i[2]:n;for(o&&uf(i[0],i[1],o)&&(u=1);++e<u;)for(var s=i[e],h=sf(s),c=-1,l=h.length;++c<l;)r=h[c],f=t[r],(f===n||ks(f,ul[r])&&!vr.call(t,r))&&(t[r]=s[r]);return t});pn=cr(function(t){return t.push(n,rd),f(wn,n,t)});var oat=kk(function(n,t,i){t!=null&&typeof t.toString!="function"&&(t=ca.call(t));n[t]=i},cw(hf)),sat=kk(function(n,t,i){t!=null&&typeof t.toString!="function"&&(t=ca.call(t));vr.call(n,t)?n[t].push(i):n[t]=[i]},vt),hat=cr(dl);var aat=ol(function(n,t,i){uv(n,t,i)}),wn=ol(function(n,t,i,r){uv(n,t,i,r)}),vat=sh(function(n,t){var i={},u,f;if(n==null)return i;for(u=!1,t=r(t,function(t){return t=vc(t,n),u||(u=t.length>1),t}),gs(n,lp(n),i),u&&(i=yf(i,g|eu|ot,lft)),f=t.length;f--;)rp(i,t[f]);return i});bn=sh(function(n,t){return n==null?{}:wut(n,t)});ow=td(du);sw=td(sf);dn=sl(function(n,t,i){return t=t.toLowerCase(),n+(i?gn(t):t)});var svt=sl(function(n,t,i){return n+(i?"-":"")+t.toLowerCase()}),hvt=sl(function(n,t,i){return n+(i?" ":"")+t.toLowerCase()}),cvt=pk("toLowerCase");ttt=sl(function(n,t,i){return n+(i?"_":"")+t.toLowerCase()});itt=sl(function(n,t,i){return n+(i?" ":"")+uy(t)});rtt=sl(function(n,t,i){return n+(i?" ":"")+t.toUpperCase()});uy=pk("toUpperCase");hw=cr(function(t,i){try{return f(t,n,i)}catch(r){return iw(r)?r:new ww(r)}});ftt=sh(function(n,t){return c(t,function(t){t=nh(t);rh(n,t,kv(n[t],n))}),n});ett=bk();ott=bk(!0);stt=cr(function(n,t){return function(i){return dl(i,n,t)}});htt=cr(function(n,t){return function(i){return dl(n,i,t)}});var vyt=sp(r),yyt=sp(re),pyt=sp(dr);ltt=dk();att=dk(!0);var ipt=hv(function(n,t){return n+t},0),rpt=hp("ceil"),upt=hv(function(n,t){return n/t},1),fpt=hp("floor");var apt=hv(function(n,t){return n*t},1),vpt=hp("round"),ypt=hv(function(n,t){return n-t},0);return et.after=nct,et.ary=bg,et.assign=plt,et.assignIn=vn,et.assignInWith=ry,et.assignWith=wlt,et.at=blt,et.before=kg,et.bind=kv,et.bindAll=ftt,et.bindKey=nw,et.castArray=cct,et.chain=fg,et.chunk=set,et.compact=het,et.concat=cet,et.cond=eyt,et.conforms=oyt,et.constant=cw,et.countBy=og,et.create=klt,et.curry=dg,et.curryRight=gg,et.debounce=nn,et.defaults=yn,et.defaultsDeep=pn,et.defer=tn,et.delay=rn,et.difference=aet,et.differenceBy=vet,et.differenceWith=yet,et.drop=pet,et.dropRight=wet,et.dropRightWhile=bet,et.dropWhile=ket,et.fill=det,et.filter=oht,et.flatMap=sht,et.flatMapDeep=hht,et.flatMapDepth=cht,et.flatten=dd,et.flattenDeep=get,et.flattenDepth=not,et.flip=tct,et.flow=ett,et.flowRight=ott,et.fromPairs=tot,et.functions=uat,et.functionsIn=fat,et.groupBy=ag,et.initial=rot,et.intersection=uot,et.intersectionBy=fot,et.intersectionWith=eot,et.invert=oat,et.invertBy=sat,et.invokeMap=vg,et.iteratee=lw,et.keyBy=yg,et.keys=du,et.keysIn=sf,et.map=bv,et.mapKeys=cat,et.mapValues=lat,et.matches=hyt,et.matchesProperty=cyt,et.memoize=dv,et.merge=aat,et.mergeWith=wn,et.method=stt,et.methodOf=htt,et.mixin=aw,et.negate=gv,et.nthArg=ayt,et.omit=vat,et.omitBy=yat,et.once=ict,et.orderBy=aht,et.over=vyt,et.overArgs=rct,et.overEvery=yyt,et.overSome=pyt,et.partial=tw,et.partialRight=un,et.partition=pg,et.pick=bn,et.pickBy=kn,et.property=ctt,et.propertyOf=wyt,et.pull=ng,et.pullAll=tg,et.pullAllBy=cot,et.pullAllWith=lot,et.pullAt=ig,et.range=ltt,et.rangeRight=att,et.rearg=uct,et.reject=pht,et.remove=aot,et.rest=fct,et.reverse=dp,et.sampleSize=bht,et.set=wat,et.setWith=bat,et.shuffle=kht,et.slice=vot,et.sortBy=wg,et.sortedUniq=got,et.sortedUniqBy=nst,et.split=bvt,et.spread=ect,et.tail=tst,et.take=ist,et.takeRight=rst,et.takeRightWhile=ust,et.takeWhile=fst,et.tap=dst,et.throttle=oct,et.thru=wv,et.toArray=cn,et.toPairs=ow,et.toPairsIn=sw,et.toPath=npt,et.toPlainObject=an,et.transform=kat,et.unary=sct,et.union=est,et.unionBy=ost,et.unionWith=sst,et.uniq=hst,et.uniqBy=cst,et.uniqWith=lst,et.unset=dat,et.unzip=gp,et.unzipWith=rg,et.update=gat,et.updateWith=nvt,et.values=cl,et.valuesIn=tvt,et.without=ast,et.words=utt,et.wrap=hct,et.xor=vst,et.xorBy=yst,et.xorWith=pst,et.zip=wst,et.zipObject=bst,et.zipObjectDeep=kst,et.zipWith=ug,et.entries=ow,et.entriesIn=sw,et.extend=vn,et.extendWith=ry,aw(et,et),et.add=ipt,et.attempt=hw,et.camelCase=dn,et.capitalize=gn,et.ceil=rpt,et.clamp=ivt,et.clone=lct,et.cloneDeep=vct,et.cloneDeepWith=yct,et.cloneWith=act,et.conformsTo=pct,et.deburr=ntt,et.defaultTo=syt,et.divide=upt,et.endsWith=fvt,et.eq=ks,et.escape=evt,et.escapeRegExp=ovt,et.every=eht,et.find=sg,et.findIndex=bd,et.findKey=dlt,et.findLast=hg,et.findLastIndex=kd,et.findLastKey=glt,et.floor=fpt,et.forEach=cg,et.forEachRight=lg,et.forIn=nat,et.forInRight=tat,et.forOwn=iat,et.forOwnRight=rat,et.get=fw,et.gt=wct,et.gte=bct,et.has=eat,et.hasIn=ew,et.head=gd,et.identity=hf,et.includes=lht,et.indexOf=iot,et.inRange=rvt,et.invoke=hat,et.isArguments=tl,et.isArray=vi,et.isArrayBuffer=kct,et.isArrayLike=ef,et.isArrayLikeObject=nu,et.isBoolean=dct,et.isBuffer=yh,et.isDate=fn,et.isElement=gct,et.isEmpty=nlt,et.isEqual=tlt,et.isEqualWith=ilt,et.isError=iw,et.isFinite=rlt,et.isFunction=kh,et.isInteger=en,et.isLength=ny,et.isMap=rw,et.isMatch=ult,et.isMatchWith=flt,et.isNaN=elt,et.isNative=olt,et.isNil=hlt,et.isNull=slt,et.isNumber=on,et.isObject=pr,et.isObjectLike=wr,et.isPlainObject=fa,et.isRegExp=ty,et.isSafeInteger=clt,et.isSet=uw,et.isString=iy,et.isSymbol=lf,et.isTypedArray=il,et.isUndefined=llt,et.isWeakMap=alt,et.isWeakSet=vlt,et.join=oot,et.kebabCase=svt,et.last=wf,et.lastIndexOf=sot,et.lowerCase=hvt,et.lowerFirst=cvt,et.lt=sn,et.lte=hn,et.max=ept,et.maxBy=opt,et.mean=spt,et.meanBy=hpt,et.min=cpt,et.minBy=lpt,et.stubArray=yw,et.stubFalse=pw,et.stubObject=byt,et.stubString=kyt,et.stubTrue=dyt,et.multiply=apt,et.nth=hot,et.noConflict=lyt,et.noop=vw,et.now=ua,et.pad=lvt,et.padEnd=avt,et.padStart=vvt,et.parseInt=yvt,et.random=uvt,et.reduce=vht,et.reduceRight=yht,et.repeat=pvt,et.replace=wvt,et.result=pat,et.round=vpt,et.runInContext=fu,et.sample=wht,et.size=dht,et.snakeCase=ttt,et.some=ght,et.sortedIndex=yot,et.sortedIndexBy=pot,et.sortedIndexOf=wot,et.sortedLastIndex=bot,et.sortedLastIndexBy=kot,et.sortedLastIndexOf=dot,et.startCase=itt,et.startsWith=kvt,et.subtract=ypt,et.sum=ppt,et.sumBy=wpt,et.template=dvt,et.times=gyt,et.toFinite=sc,et.toInteger=yi,et.toLength=ln,et.toLower=gvt,et.toNumber=ue,et.toSafeInteger=ylt,et.toString=ar,et.toUpper=nyt,et.trim=tyt,et.trimEnd=iyt,et.trimStart=ryt,et.truncate=uyt,et.unescape=fyt,et.uniqueId=tpt,et.upperCase=rtt,et.upperFirst=uy,et.each=cg,et.eachRight=lg,et.first=gd,aw(et,function(){var n={};return ds(et,function(t,i){vr.call(et.prototype,i)||(n[i]=t)}),n}(),{chain:!1}),et.VERSION=pe,c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){et[n].placeholder=et}),c(["drop","take"],function(t,i){lr.prototype[t]=function(r){r=r===n?1:ku(yi(r),0);var u=this.__filtered__&&!i?new lr(this):this.clone();return u.__filtered__?u.__takeCount__=nf(r,u.__takeCount__):u.__views__.push({size:nf(r,w),type:t+(u.__dir__<0?"Right":"")}),u};lr.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}}),c(["filter","map","takeWhile"],function(n,t){var i=t+1,r=i==su||i==io;lr.prototype[n]=function(n){var t=this.clone();return t.__iteratees__.push({iteratee:vt(n,3),type:i}),t.__filtered__=t.__filtered__||r,t}}),c(["head","last"],function(n,t){var i="take"+(t?"Right":"");lr.prototype[n]=function(){return this[i](1).value()[0]}}),c(["initial","tail"],function(n,t){var i="drop"+(t?"":"Right");lr.prototype[n]=function(){return this.__filtered__?new lr(this):this[i](1)}}),lr.prototype.compact=function(){return this.filter(hf)},lr.prototype.find=function(n){return this.filter(n).head()},lr.prototype.findLast=function(n){return this.reverse().find(n)},lr.prototype.invokeMap=cr(function(n,t){return typeof n=="function"?new lr(this):this.map(function(i){return dl(i,n,t)})}),lr.prototype.reject=function(n){return this.filter(gv(vt(n)))},lr.prototype.slice=function(t,i){t=yi(t);var r=this;return r.__filtered__&&(t>0||i<0)?new lr(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),i!==n&&(i=yi(i),r=i<0?r.dropRight(-i):r.take(i-t)),r)},lr.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},lr.prototype.toArray=function(){return this.take(w)},ds(lr.prototype,function(t,i){var e=/^(?:filter|find|map|reject)|While$/.test(i),r=/^(?:head|last)$/.test(i),u=et[r?"take"+(i=="last"?"Right":""):i],f=r||/^find/.test(i);u&&(et.prototype[i]=function(){var o=this.__wrapped__,s=r?[1]:arguments,h=o instanceof lr,a=s[0],c=h||vi(o),v=function(n){var t=u.apply(et,it([n],s));return r&&l?t[0]:t},i;c&&e&&typeof a=="function"&&a.length!=1&&(h=c=!1);var l=this.__chain__,w=!!this.__actions__.length,y=f&&!l,p=h&&!w;return!f&&c?(o=p?o:new lr(this),i=t.apply(o,s),i.__actions__.push({func:wv,args:[v],thisArg:n}),new vf(i,l)):y&&p?t.apply(this,s):(i=this.thru(v),y?r?i.value()[0]:i.value():i)})}),c(["pop","push","shift","sort","splice","unshift"],function(n){var t=oa[n],i=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",r=/^(?:pop|shift)$/.test(n);et.prototype[n]=function(){var u=arguments,n;return r&&!this.__chain__?(n=this.value(),t.apply(vi(n)?n:[],u)):this[i](function(n){return t.apply(vi(n)?n:[],u)})}}),ds(lr.prototype,function(n,t){var i=et[t],r,u;i&&(r=i.name+"",u=pl[r]||(pl[r]=[]),u.push({name:t,func:i}))}),pl[sv(n,ut).name]=[{name:"wrapper",func:n}],lr.prototype.clone=vit,lr.prototype.reverse=yit,lr.prototype.value=pit,et.prototype.at=eg,et.prototype.chain=gst,et.prototype.commit=nht,et.prototype.next=tht,et.prototype.plant=rht,et.prototype.reverse=uht,et.prototype.toJSON=et.prototype.valueOf=et.prototype.value=fht,et.prototype.first=et.prototype.head,ll&&(et.prototype[ll]=iht),et};d=fu();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(u._=d,define(function(){return d})):et?((et.exports=d)._=d,pr._=d):u._=d}).call(this)
;var PivotData;(function(n){var t=function(){function n(){}return n}();n.enums=t})(PivotData||(PivotData={}))
;!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.R={})}(this,function(t){"use strict";function n(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function r(t){return function r(e){return 0===arguments.length||n(e)?r:t.apply(this,arguments)}}function e(t){return function e(u,i){switch(arguments.length){case 0:return e;case 1:return n(u)?e:r(function(n){return t(u,n)});default:return n(u)&&n(i)?e:n(u)?r(function(n){return t(n,i)}):n(i)?r(function(n){return t(u,n)}):t(u,i)}}}function u(t,n){t=t||[],n=n||[];var r,e=t.length,u=n.length,i=[];for(r=0;e>r;)i[i.length]=t[r],r+=1;for(r=0;u>r;)i[i.length]=n[r],r+=1;return i}function i(t,n){switch(t){case 0:return function(){return n.apply(this,arguments)};case 1:return function(t){return n.apply(this,arguments)};case 2:return function(t,r){return n.apply(this,arguments)};case 3:return function(t,r,e){return n.apply(this,arguments)};case 4:return function(t,r,e,u){return n.apply(this,arguments)};case 5:return function(t,r,e,u,i){return n.apply(this,arguments)};case 6:return function(t,r,e,u,i,o){return n.apply(this,arguments)};case 7:return function(t,r,e,u,i,o,c){return n.apply(this,arguments)};case 8:return function(t,r,e,u,i,o,c,a){return n.apply(this,arguments)};case 9:return function(t,r,e,u,i,o,c,a,s){return n.apply(this,arguments)};case 10:return function(t,r,e,u,i,o,c,a,s,f){return n.apply(this,arguments)};default:throw Error("First argument to _arity must be a non-negative integer no greater than ten")}}function o(t,r,e){return function(){for(var u=[],c=0,a=t,s=0;r.length>s||arguments.length>c;){var f;s>=r.length||n(r[s])&&arguments.length>c?(f=arguments[c],c+=1):f=r[s],u[s]=f,n(f)||(a-=1),s+=1}return a>0?i(a,o(t,u,e)):e.apply(this,u)}}function c(t){return function u(i,o,c){switch(arguments.length){case 0:return u;case 1:return n(i)?u:e(function(n,r){return t(i,n,r)});case 2:return n(i)&&n(o)?u:n(i)?e(function(n,r){return t(n,o,r)}):n(o)?e(function(n,r){return t(i,n,r)}):r(function(n){return t(i,o,n)});default:return n(i)&&n(o)&&n(c)?u:n(i)&&n(o)?e(function(n,r){return t(n,r,c)}):n(i)&&n(c)?e(function(n,r){return t(n,o,r)}):n(o)&&n(c)?e(function(n,r){return t(i,n,r)}):n(i)?r(function(n){return t(n,o,c)}):n(o)?r(function(n){return t(i,n,c)}):n(c)?r(function(n){return t(i,o,n)}):t(i,o,c)}}}function a(t){return"function"==typeof t["@@transducer/step"]}function s(t,n,r){return function(){if(0===arguments.length)return r();var e=Array.prototype.slice.call(arguments,0),u=e.pop();if(!At(u)){for(var i=0;t.length>i;){if("function"==typeof u[t[i]])return u[t[i]].apply(u,e);i+=1}if(a(u))return n.apply(null,e)(u)}return r.apply(this,arguments)}}function f(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}}function l(t,n){this.xf=n,this.f=t,this.all=!0}function p(t,n){for(var r=0,e=n.length,u=Array(e);e>r;)u[r]=t(n[r]),r+=1;return u}function h(t){return"[object String]"===Object.prototype.toString.call(t)}function y(t){this.f=t}function d(t){return new y(t)}function g(t,n,r){for(var e=0,u=r.length;u>e;){if((n=t["@@transducer/step"](n,r[e]))&&n["@@transducer/reduced"]){n=n["@@transducer/value"];break}e+=1}return t["@@transducer/result"](n)}function v(t,n,r){for(var e=r.next();!e.done;){if((n=t["@@transducer/step"](n,e.value))&&n["@@transducer/reduced"]){n=n["@@transducer/value"];break}e=r.next()}return t["@@transducer/result"](n)}function m(t,n,r,e){return t["@@transducer/result"](r[e](qt(t["@@transducer/step"],t),n))}function b(t,n,r){if("function"==typeof t&&(t=d(t)),_t(r))return g(t,n,r);if("function"==typeof r["fantasy-land/reduce"])return m(t,n,r,"fantasy-land/reduce");if(null!=r[kt])return v(t,n,r[kt]());if("function"==typeof r.next)return v(t,n,r);if("function"==typeof r.reduce)return m(t,n,r,"reduce");throw new TypeError("reduce: list must be array or iterable")}function x(t,n){this.xf=n,this.f=t}function w(t,n){return Object.prototype.hasOwnProperty.call(n,t)}function j(t,n){this.xf=n,this.f=t,this.any=!1}function A(t,n){this.xf=n,this.pos=0,this.full=!1,this.acc=Array(t)}function O(t){return"[object Function]"===Object.prototype.toString.call(t)}function S(t){return function n(r){for(var e,u,i,o=[],c=0,a=r.length;a>c;){if(_t(r[c]))for(i=0,u=(e=t?n(r[c]):r[c]).length;u>i;)o[o.length]=e[i],i+=1;else o[o.length]=r[c];c+=1}return o}}function E(t){return{"@@transducer/value":t,"@@transducer/reduced":!0}}function _(t){return RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""))}function q(t,n,r,e){var u=function(u){for(var i=n.length,o=0;i>o;){if(t===n[o])return r[o];o+=1}n[o+1]=t,r[o+1]=u;for(var c in t)u[c]=e?q(t[c],n,r,!0):t[c];return u};switch(mn(t)){case"Object":return u({});case"Array":return u([]);case"Date":return new Date(t.valueOf());case"RegExp":return _(t);default:return t}}function k(t,n){return function(){return n.call(this,t.apply(this,arguments))}}function N(t,n){return function(){var r=arguments.length;if(0===r)return n();var e=arguments[r-1];return At(e)||"function"!=typeof e[t]?n.apply(this,arguments):e[t].apply(e,Array.prototype.slice.call(arguments,0,r-1))}}function I(){if(0===arguments.length)throw Error("pipe requires at least one argument");return i(arguments[0].length,Mt(k,arguments[0],On(arguments)))}function W(){if(0===arguments.length)throw Error("compose requires at least one argument");return I.apply(this,Sn(arguments))}function P(){if(0===arguments.length)throw Error("composeK requires at least one argument");var t=Array.prototype.slice.call(arguments),n=t.pop();return W(W.apply(this,Rt(gn,t)),n)}function C(t,n){return function(){var r=this;return t.apply(r,arguments).then(function(t){return n.call(r,t)})}}function T(){if(0===arguments.length)throw Error("pipeP requires at least one argument");return i(arguments[0].length,Mt(C,arguments[0],On(arguments)))}function B(t){for(var n,r=[];!(n=t.next()).done;)r.push(n.value);return r}function F(t,n,r){for(var e=0,u=r.length;u>e;){if(t(n,r[e]))return!0;e+=1}return!1}function R(t){var n=(t+"").match(/^function (\w*)/);return null==n?"":n[1]}function U(t,n,r,e){function u(t,n){return D(t,n,r.slice(),e.slice())}var i=B(t);return!F(function(t,n){return!F(u,n,t)},B(n),i)}function D(t,n,r,e){if(En(t,n))return!0;var u=mn(t);if(u!==mn(n))return!1;if(null==t||null==n)return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof n["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](n)&&"function"==typeof n["fantasy-land/equals"]&&n["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof n.equals)return"function"==typeof t.equals&&t.equals(n)&&"function"==typeof n.equals&&n.equals(t);switch(u){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===R(t.constructor))return t===n;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof n||!En(t.valueOf(),n.valueOf()))return!1;break;case"Date":if(!En(t.valueOf(),n.valueOf()))return!1;break;case"Error":return t.name===n.name&&t.message===n.message;case"RegExp":if(t.source!==n.source||t.global!==n.global||t.ignoreCase!==n.ignoreCase||t.multiline!==n.multiline||t.sticky!==n.sticky||t.unicode!==n.unicode)return!1}for(var i=r.length-1;i>=0;){if(r[i]===t)return e[i]===n;i-=1}switch(u){case"Map":return t.size===n.size&&U(t.entries(),n.entries(),r.concat([t]),e.concat([n]));case"Set":return t.size===n.size&&U(t.values(),n.values(),r.concat([t]),e.concat([n]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var o=Ft(t);if(o.length!==Ft(n).length)return!1;var c=r.concat([t]),a=e.concat([n]);for(i=o.length-1;i>=0;){var s=o[i];if(!w(s,n)||!D(n[s],t[s],c,a))return!1;i-=1}return!0}function z(t,n,r){var e,u;if("function"==typeof t.indexOf)switch(typeof n){case"number":if(0===n){for(e=1/n;t.length>r;){if(0===(u=t[r])&&1/u===e)return r;r+=1}return-1}if(n!==n){for(;t.length>r;){if("number"==typeof(u=t[r])&&u!==u)return r;r+=1}return-1}return t.indexOf(n,r);case"string":case"boolean":case"function":case"undefined":return t.indexOf(n,r);case"object":if(null===n)return t.indexOf(n,r)}for(;t.length>r;){if(_n(t[r],n))return r;r+=1}return-1}function M(t,n){return z(n,t,0)>=0}function L(t){return'"'+t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}function K(t){return function(){return!t.apply(this,arguments)}}function V(t,n){for(var r=0,e=n.length,u=[];e>r;)t(n[r])&&(u[u.length]=n[r]),r+=1;return u}function $(t){return"[object Object]"===Object.prototype.toString.call(t)}function H(t,n){this.xf=n,this.f=t}function J(t,n){var r=function(r){var e=n.concat([t]);return M(r,e)?"<Circular>":J(r,e)},e=function(t,n){return p(function(n){return L(n)+": "+r(t[n])},n.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+p(r,t).join(", ")+"))";case"[object Array]":return"["+p(r,t).concat(e(t,In(function(t){return/^\d+$/.test(t)},Ft(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+r(t.valueOf())+")":""+t;case"[object Date]":return"new Date("+(isNaN(t.valueOf())?r(NaN):L(kn(t)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+r(t.valueOf())+")":1/t==-1/0?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+r(t.valueOf())+")":L(t);case"[object Undefined]":return"undefined";default:if("function"==typeof t.toString){var u=""+t;if("[object Object]"!==u)return u}return"{"+e(t,Ft(t)).join(", ")+"}"}}function X(t,n,r,e){this.valueFn=t,this.valueAcc=n,this.keyFn=r,this.xf=e,this.inputs={}}function Y(t,n){this.xf=n,this.n=t}function Z(t,n){this.xf=n,this.n=t,this.i=0}function G(t,n){this.xf=n,this.pos=0,this.full=!1,this.acc=Array(t)}function Q(t,n){this.f=t,this.retained=[],this.xf=n}function tt(t,n){this.xf=n,this.pred=t,this.lastValue=void 0,this.seenFirstValue=!1}function nt(t,n){this.xf=n,this.f=t}function rt(t,n){this.xf=n,this.f=t,this.found=!1}function et(t,n){this.xf=n,this.f=t,this.idx=-1,this.found=!1}function ut(t,n){this.xf=n,this.f=t}function it(t,n){this.xf=n,this.f=t,this.idx=-1,this.lastIdx=-1}function ot(t){return t}function ct(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}function at(t,n,r){var e,u=typeof t;switch(u){case"string":case"number":return 0===t&&1/t==-1/0?!!r._items["-0"]||(n&&(r._items["-0"]=!0),!1):null!==r._nativeSet?n?(e=r._nativeSet.size,r._nativeSet.add(t),r._nativeSet.size===e):r._nativeSet.has(t):u in r._items?t in r._items[u]||(n&&(r._items[u][t]=!0),!1):(n&&(r._items[u]={},r._items[u][t]=!0),!1);case"boolean":if(u in r._items){var i=t?1:0;return!!r._items[u][i]||(n&&(r._items[u][i]=!0),!1)}return n&&(r._items[u]=t?[!1,!0]:[!0,!1]),!1;case"function":return null!==r._nativeSet?n?(e=r._nativeSet.size,r._nativeSet.add(t),r._nativeSet.size===e):r._nativeSet.has(t):u in r._items?!!M(t,r._items[u])||(n&&r._items[u].push(t),!1):(n&&(r._items[u]=[t]),!1);case"undefined":return!!r._items[u]||(n&&(r._items[u]=!0),!1);case"object":if(null===t)return!!r._items.null||(n&&(r._items.null=!0),!1);default:return(u=Object.prototype.toString.call(t))in r._items?!!M(t,r._items[u])||(n&&r._items[u].push(t),!1):(n&&(r._items[u]=[t]),!1)}}function st(t){if(a(t))return t;if(_t(t))return $r;if("string"==typeof t)return Hr;if("object"==typeof t)return Jr;throw Error("Cannot create transformer for "+t)}function ft(t){return"[object Number]"===Object.prototype.toString.call(t)}function lt(t){return e(function(n,r){return i(Math.max(0,n.length-r.length),function(){return n.apply(this,t(r,arguments))})})}function pt(t,n){this.xf=n,this.f=t}function ht(t,n){this.xf=n,this.f=t}function yt(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var dt=r(function(t){return function(){return t}}),gt=dt(!1),vt=dt(!0),mt={"@@functional/placeholder":!0},bt=e(function(t,n){return+t+ +n}),xt=e(function(t,n){return 1===t?r(n):i(t,o(t,[],n))}),wt=r(function(t){return xt(t.length,function(){var n=0,r=arguments[0],e=arguments[arguments.length-1],i=Array.prototype.slice.call(arguments,0);return i[0]=function(){var t=r.apply(this,u(arguments,[n,e]));return n+=1,t},t.apply(this,i)})}),jt=c(function(t,n,r){if(n>=r.length||-r.length>n)return r;var e=(0>n?r.length:0)+n,i=u(r);return i[e]=t(r[e]),i}),At=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)},Ot={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}};l.prototype["@@transducer/init"]=Ot.init,l.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},l.prototype["@@transducer/step"]=function(t,n){return this.f(n)||(this.all=!1,t=f(this.xf["@@transducer/step"](t,!1))),t};var St=e(s(["all"],e(function(t,n){return new l(t,n)}),function(t,n){for(var r=0;n.length>r;){if(!t(n[r]))return!1;r+=1}return!0})),Et=e(function(t,n){return n>t?n:t}),_t=r(function(t){return!!At(t)||!!t&&("object"==typeof t&&(!h(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))});y.prototype["@@transducer/init"]=function(){throw Error("init not implemented on XWrap")},y.prototype["@@transducer/result"]=function(t){return t},y.prototype["@@transducer/step"]=function(t,n){return this.f(t,n)};var qt=e(function(t,n){return i(t.length,function(){return t.apply(n,arguments)})}),kt="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";x.prototype["@@transducer/init"]=Ot.init,x.prototype["@@transducer/result"]=Ot.result,x.prototype["@@transducer/step"]=function(t,n){return this.xf["@@transducer/step"](t,this.f(n))};var Nt=e(function(t,n){return new x(t,n)}),It=Object.prototype.toString,Wt=function(){return"[object Arguments]"===It.call(arguments)?function(t){return"[object Arguments]"===It.call(t)}:function(t){return w("callee",t)}},Pt=!{toString:null}.propertyIsEnumerable("toString"),Ct=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Tt=function(){return arguments.propertyIsEnumerable("length")}(),Bt=function(t,n){for(var r=0;t.length>r;){if(t[r]===n)return!0;r+=1}return!1},Ft=r("function"!=typeof Object.keys||Tt?function(t){if(Object(t)!==t)return[];var n,r,e=[],u=Tt&&Wt(t);for(n in t)!w(n,t)||u&&"length"===n||(e[e.length]=n);if(Pt)for(r=6;r>=0;)w(n=Ct[r],t)&&!Bt(e,n)&&(e[e.length]=n),r-=1;return e}:function(t){return Object(t)!==t?[]:Object.keys(t)}),Rt=e(s(["fantasy-land/map","map"],Nt,function(t,n){switch(Object.prototype.toString.call(n)){case"[object Function]":return xt(n.length,function(){return t.call(this,n.apply(this,arguments))});case"[object Object]":return b(function(r,e){return r[e]=t(n[e]),r},{},Ft(n));default:return p(t,n)}})),Ut=e(function(t,n){for(var r=n,e=0;t.length>e;){if(null==r)return;r=r[t[e]],e+=1}return r}),Dt=e(function(t,n){return Ut([t],n)}),zt=e(function(t,n){return Rt(Dt(t),n)}),Mt=c(b),Lt=r(function(t){return xt(Mt(Et,0,zt("length",t)),function(){for(var n=0,r=t.length;r>n;){if(!t[n].apply(this,arguments))return!1;n+=1}return!0})}),Kt=e(function(t,n){return t&&n});j.prototype["@@transducer/init"]=Ot.init,j.prototype["@@transducer/result"]=function(t){return this.any||(t=this.xf["@@transducer/step"](t,!1)),this.xf["@@transducer/result"](t)},j.prototype["@@transducer/step"]=function(t,n){return this.f(n)&&(this.any=!0,t=f(this.xf["@@transducer/step"](t,!0))),t};var Vt=e(function(t,n){return new j(t,n)}),$t=e(s(["any"],Vt,function(t,n){for(var r=0;n.length>r;){if(t(n[r]))return!0;r+=1}return!1})),Ht=r(function(t){return xt(Mt(Et,0,zt("length",t)),function(){for(var n=0,r=t.length;r>n;){if(t[n].apply(this,arguments))return!0;n+=1}return!1})}),Jt=e(function(t,n){return"function"==typeof n["fantasy-land/ap"]?n["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(n):"function"==typeof t?function(r){return t(r)(n(r))}:b(function(t,r){return u(t,Rt(r,n))},[],t)});A.prototype["@@transducer/init"]=Ot.init,A.prototype["@@transducer/result"]=function(t){return this.acc=null,this.xf["@@transducer/result"](t)},A.prototype["@@transducer/step"]=function(t,n){return this.store(n),this.full?this.xf["@@transducer/step"](t,this.getCopy()):t},A.prototype.store=function(t){this.acc[this.pos]=t,(this.pos+=1)===this.acc.length&&(this.pos=0,this.full=!0)},A.prototype.getCopy=function(){return u(Array.prototype.slice.call(this.acc,this.pos),Array.prototype.slice.call(this.acc,0,this.pos))};var Xt=e(s([],e(function(t,n){return new A(t,n)}),function(t,n){for(var r=0,e=n.length-(t-1),u=Array(0>e?0:e);e>r;)u[r]=Array.prototype.slice.call(n,r,r+t),r+=1;return u})),Yt=e(function(t,n){return u(n,[t])}),Zt=e(function(t,n){return t.apply(this,n)}),Gt=r(function(t){for(var n=Ft(t),r=n.length,e=[],u=0;r>u;)e[u]=t[n[u]],u+=1;return e}),Qt=r(function t(n){return n=Rt(function(n){return"function"==typeof n?n:t(n)},n),xt(Mt(Et,0,zt("length",Gt(n))),function(){var t=arguments;return Rt(function(n){return Zt(n,t)},n)})}),tn=e(function(t,n){return n(t)}),nn=c(function(t,n,r){var e=t(n),u=t(r);return u>e?-1:e>u?1:0}),rn=c(function(t,n,r){var e={};for(var u in r)e[u]=r[u];return e[t]=n,e}),en=Number.isInteger||function(t){return t<<0===t},un=r(function(t){return null==t}),on=c(function t(n,r,e){if(0===n.length)return r;var u=n[0];if(n.length>1){var i=!un(e)&&w(u,e)?e[u]:en(n[1])?[]:{};r=t(Array.prototype.slice.call(n,1),r,i)}if(en(u)&&At(e)){var o=[].concat(e);return o[u]=r,o}return rn(u,r,e)}),cn=e(function(t,n){switch(t){case 0:return function(){return n.call(this)};case 1:return function(t){return n.call(this,t)};case 2:return function(t,r){return n.call(this,t,r)};case 3:return function(t,r,e){return n.call(this,t,r,e)};case 4:return function(t,r,e,u){return n.call(this,t,r,e,u)};case 5:return function(t,r,e,u,i){return n.call(this,t,r,e,u,i)};case 6:return function(t,r,e,u,i,o){return n.call(this,t,r,e,u,i,o)};case 7:return function(t,r,e,u,i,o,c){return n.call(this,t,r,e,u,i,o,c)};case 8:return function(t,r,e,u,i,o,c,a){return n.call(this,t,r,e,u,i,o,c,a)};case 9:return function(t,r,e,u,i,o,c,a,s){return n.call(this,t,r,e,u,i,o,c,a,s)};case 10:return function(t,r,e,u,i,o,c,a,s,f){return n.call(this,t,r,e,u,i,o,c,a,s,f)};default:throw Error("First argument to nAry must be a non-negative integer no greater than ten")}}),an=r(function(t){return cn(2,t)}),sn=e(function(t,n){var r=xt(t,n);return xt(t,function(){return b(Jt,Rt(r,arguments[0]),Array.prototype.slice.call(arguments,1))})}),fn=r(function(t){return sn(t.length,t)}),ln=e(function(t,n){return O(t)?function(){return t.apply(this,arguments)&&n.apply(this,arguments)}:fn(Kt)(t,n)}),pn=r(function(t){return xt(t.length,t)}),hn=pn(function(t){return t.apply(this,Array.prototype.slice.call(arguments,1))}),yn=function(t){return{"@@transducer/init":Ot.init,"@@transducer/result":function(n){return t["@@transducer/result"](n)},"@@transducer/step":function(n,r){var e=t["@@transducer/step"](n,r);return e["@@transducer/reduced"]?E(e):e}}},dn=function(t){var n=yn(t);return{"@@transducer/init":Ot.init,"@@transducer/result":function(t){return n["@@transducer/result"](t)},"@@transducer/step":function(t,r){return _t(r)?b(n,t,r):b(n,t,[r])}}},gn=e(s(["fantasy-land/chain","chain"],e(function(t,n){return Rt(t,dn(n))}),function(t,n){return"function"==typeof n?function(r){return t(n(r))(r)}:S(!1)(Rt(t,n))})),vn=c(function(t,n,r){if(t>n)throw Error("min must not be greater than max in clamp(min, max, value)");return t>r?t:r>n?n:r}),mn=r(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}),bn=r(function(t){return null!=t&&"function"==typeof t.clone?t.clone():q(t,[],[],!0)}),xn=r(function(t){return function(n,r){return t(n,r)?-1:t(r,n)?1:0}}),wn=r(function(t){return!t}),jn=fn(wn),An=c(N("slice",function(t,n,r){return Array.prototype.slice.call(r,t,n)})),On=r(N("tail",An(1,1/0))),Sn=r(function(t){return h(t)?t.split("").reverse().join(""):Array.prototype.slice.call(t,0).reverse()}),En=e(function(t,n){return t===n?0!==t||1/t==1/n:t!==t&&n!==n}),_n=e(function(t,n){return D(t,n,[],[])}),qn=function(t){return(10>t?"0":"")+t},kn="function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+qn(t.getUTCMonth()+1)+"-"+qn(t.getUTCDate())+"T"+qn(t.getUTCHours())+":"+qn(t.getUTCMinutes())+":"+qn(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};H.prototype["@@transducer/init"]=Ot.init,H.prototype["@@transducer/result"]=Ot.result,H.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.xf["@@transducer/step"](t,n):t};var Nn=e(s(["filter"],e(function(t,n){return new H(t,n)}),function(t,n){return $(n)?b(function(r,e){return t(n[e])&&(r[e]=n[e]),r},{},Ft(n)):V(t,n)})),In=e(function(t,n){return Nn(K(t),n)}),Wn=r(function(t){return J(t,[])}),Pn=e(function(t,n){if(At(t)){if(At(n))return t.concat(n);throw new TypeError(Wn(n)+" is not an array")}if(h(t)){if(h(n))return t+n;throw new TypeError(Wn(n)+" is not a string")}if(null!=t&&O(t["fantasy-land/concat"]))return t["fantasy-land/concat"](n);if(null!=t&&O(t.concat))return t.concat(n);throw new TypeError(Wn(t)+' does not have a method named "concat" or "fantasy-land/concat"')}),Cn=r(function(t){return i(Mt(Et,0,Rt(function(t){return t[0].length},t)),function(){for(var n=0;t.length>n;){if(t[n][0].apply(this,arguments))return t[n][1].apply(this,arguments);n+=1}})}),Tn=e(function(t,n){if(t>10)throw Error("Constructor with greater than ten arguments");return 0===t?function(){return new n}:pn(cn(t,function(t,r,e,u,i,o,c,a,s,f){switch(arguments.length){case 1:return new n(t);case 2:return new n(t,r);case 3:return new n(t,r,e);case 4:return new n(t,r,e,u);case 5:return new n(t,r,e,u,i);case 6:return new n(t,r,e,u,i,o);case 7:return new n(t,r,e,u,i,o,c);case 8:return new n(t,r,e,u,i,o,c,a);case 9:return new n(t,r,e,u,i,o,c,a,s);case 10:return new n(t,r,e,u,i,o,c,a,s,f)}}))}),Bn=r(function(t){return Tn(t.length,t)}),Fn=e(M),Rn=e(function(t,n){return xt(Mt(Et,0,zt("length",n)),function(){var r=arguments,e=this;return t.apply(e,p(function(t){return t.apply(e,r)},n))})});X.prototype["@@transducer/init"]=Ot.init,X.prototype["@@transducer/result"]=function(t){var n;for(n in this.inputs)if(w(n,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[n]))["@@transducer/reduced"]){t=t["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](t)},X.prototype["@@transducer/step"]=function(t,n){var r=this.keyFn(n);return this.inputs[r]=this.inputs[r]||[r,this.valueAcc],this.inputs[r][1]=this.valueFn(this.inputs[r][1],n),t};var Un=o(4,[],s([],o(4,[],function(t,n,r,e){return new X(t,n,r,e)}),function(t,n,r,e){return b(function(e,u){var i=r(u);return e[i]=t(w(i,e)?e[i]:n,u),e},{},e)})),Dn=Un(function(t,n){return t+1},0),zn=bt(-1),Mn=e(function(t,n){return null==n||n!==n?t:n}),Ln=c(function(t,n,r){var e=t(n),u=t(r);return e>u?-1:u>e?1:0}),Kn=e(function(t,n){for(var r=[],e=0,u=t.length;u>e;)M(t[e],n)||M(t[e],r)||(r[r.length]=t[e]),e+=1;return r}),Vn=c(function(t,n,r){for(var e=[],u=0,i=n.length;i>u;)F(t,n[u],r)||F(t,n[u],e)||e.push(n[u]),u+=1;return e}),$n=e(function(t,n){var r={};for(var e in n)r[e]=n[e];return delete r[t],r}),Hn=c(function(t,n,r){var e=Array.prototype.slice.call(r,0);return e.splice(t,n),e}),Jn=c(function(t,n,r){return jt(dt(n),t,r)}),Xn=e(function t(n,r){switch(n.length){case 0:return r;case 1:return en(n[0])?Hn(n[0],1,r):$n(n[0],r);default:var e=n[0],u=Array.prototype.slice.call(n,1);return null==r[e]?r:en(n[0])?Jn(e,t(u,r[e]),r):rn(e,t(u,r[e]),r)}}),Yn=e(function(t,n){return t/n});Y.prototype["@@transducer/init"]=Ot.init,Y.prototype["@@transducer/result"]=Ot.result,Y.prototype["@@transducer/step"]=function(t,n){return this.n>0?(this.n-=1,t):this.xf["@@transducer/step"](t,n)};var Zn=e(s(["drop"],e(function(t,n){return new Y(t,n)}),function(t,n){return An(Math.max(0,t),1/0,n)}));Z.prototype["@@transducer/init"]=Ot.init,Z.prototype["@@transducer/result"]=Ot.result,Z.prototype["@@transducer/step"]=function(t,n){this.i+=1;var r=0===this.n?t:this.xf["@@transducer/step"](t,n);return 0>this.n||this.n>this.i?r:f(r)};var Gn=e(s(["take"],e(function(t,n){return new Z(t,n)}),function(t,n){return An(0,0>t?1/0:t,n)}));G.prototype["@@transducer/init"]=Ot.init,G.prototype["@@transducer/result"]=function(t){return this.acc=null,this.xf["@@transducer/result"](t)},G.prototype["@@transducer/step"]=function(t,n){return this.full&&(t=this.xf["@@transducer/step"](t,this.acc[this.pos])),this.store(n),t},G.prototype.store=function(t){this.acc[this.pos]=t,(this.pos+=1)===this.acc.length&&(this.pos=0,this.full=!0)};var Qn=e(s([],e(function(t,n){return new G(t,n)}),function(t,n){return Gn(n.length>t?n.length-t:0,n)}));Q.prototype["@@transducer/init"]=Ot.init,Q.prototype["@@transducer/result"]=function(t){return this.retained=null,this.xf["@@transducer/result"](t)},Q.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.retain(t,n):this.flush(t,n)},Q.prototype.flush=function(t,n){return t=b(this.xf["@@transducer/step"],t,this.retained),this.retained=[],this.xf["@@transducer/step"](t,n)},Q.prototype.retain=function(t,n){return this.retained.push(n),t};var tr=e(s([],e(function(t,n){return new Q(t,n)}),function(t,n){for(var r=n.length-1;r>=0&&t(n[r]);)r-=1;return An(0,r+1,n)}));tt.prototype["@@transducer/init"]=Ot.init,tt.prototype["@@transducer/result"]=Ot.result,tt.prototype["@@transducer/step"]=function(t,n){var r=!1;return this.seenFirstValue?this.pred(this.lastValue,n)&&(r=!0):this.seenFirstValue=!0,this.lastValue=n,r?t:this.xf["@@transducer/step"](t,n)};var nr=e(function(t,n){return new tt(t,n)}),rr=e(function(t,n){var r=0>t?n.length+t:t;return h(n)?n.charAt(r):n[r]}),er=rr(-1),ur=e(s([],nr,function(t,n){var r=[],e=1,u=n.length;if(0!==u)for(r[0]=n[0];u>e;)t(er(r),n[e])||(r[r.length]=n[e]),e+=1;return r})),ir=r(s([],nr(_n),ur(_n)));nt.prototype["@@transducer/init"]=Ot.init,nt.prototype["@@transducer/result"]=Ot.result,nt.prototype["@@transducer/step"]=function(t,n){if(this.f){if(this.f(n))return t;this.f=null}return this.xf["@@transducer/step"](t,n)};var or=e(s(["dropWhile"],e(function(t,n){return new nt(t,n)}),function(t,n){for(var r=0,e=n.length;e>r&&t(n[r]);)r+=1;return An(r,1/0,n)})),cr=e(function(t,n){return t||n}),ar=e(function(t,n){return O(t)?function(){return t.apply(this,arguments)||n.apply(this,arguments)}:fn(cr)(t,n)}),sr=r(function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():At(t)?[]:h(t)?"":$(t)?{}:Wt(t)?function(){return arguments}():void 0}),fr=e(function(t,n){return Zn(0>t?0:n.length-t,n)}),lr=e(function(t,n){return _n(fr(t.length,n),t)}),pr=c(function(t,n,r){return _n(t(n),t(r))}),hr=c(function(t,n,r){return _n(n[t],r[t])}),yr=e(function t(n,r){var e,u,i,o={};for(u in r)i=typeof(e=n[u]),o[u]="function"===i?e(r[u]):e&&"object"===i?t(e,r[u]):r[u];return o});rt.prototype["@@transducer/init"]=Ot.init,rt.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,void 0)),this.xf["@@transducer/result"](t)},rt.prototype["@@transducer/step"]=function(t,n){return this.f(n)&&(this.found=!0,t=f(this.xf["@@transducer/step"](t,n))),t};var dr=e(s(["find"],e(function(t,n){return new rt(t,n)}),function(t,n){for(var r=0,e=n.length;e>r;){if(t(n[r]))return n[r];r+=1}}));et.prototype["@@transducer/init"]=Ot.init,et.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,-1)),this.xf["@@transducer/result"](t)},et.prototype["@@transducer/step"]=function(t,n){return this.idx+=1,this.f(n)&&(this.found=!0,t=f(this.xf["@@transducer/step"](t,this.idx))),t};var gr=e(s([],e(function(t,n){return new et(t,n)}),function(t,n){for(var r=0,e=n.length;e>r;){if(t(n[r]))return r;r+=1}return-1}));ut.prototype["@@transducer/init"]=Ot.init,ut.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.last))},ut.prototype["@@transducer/step"]=function(t,n){return this.f(n)&&(this.last=n),t};var vr=e(s([],e(function(t,n){return new ut(t,n)}),function(t,n){for(var r=n.length-1;r>=0;){if(t(n[r]))return n[r];r-=1}}));it.prototype["@@transducer/init"]=Ot.init,it.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.lastIdx))},it.prototype["@@transducer/step"]=function(t,n){return this.idx+=1,this.f(n)&&(this.lastIdx=this.idx),t};var mr=e(s([],e(function(t,n){return new it(t,n)}),function(t,n){for(var r=n.length-1;r>=0;){if(t(n[r]))return r;r-=1}return-1})),br=r(S(!0)),xr=r(function(t){return xt(t.length,function(n,r){var e=Array.prototype.slice.call(arguments,0);return e[0]=r,e[1]=n,t.apply(this,e)})}),wr=e(N("forEach",function(t,n){for(var r=n.length,e=0;r>e;)t(n[e]),e+=1;return n})),jr=e(function(t,n){for(var r=Ft(n),e=0;r.length>e;){var u=r[e];t(n[u],u,n),e+=1}return n}),Ar=r(function(t){for(var n={},r=0;t.length>r;)n[t[r][0]]=t[r][1],r+=1;return n}),Or=e(N("groupBy",Un(function(t,n){return null==t&&(t=[]),t.push(n),t},null))),Sr=e(function(t,n){for(var r=[],e=0,u=n.length;u>e;){for(var i=e+1;u>i&&t(n[i-1],n[i]);)i+=1;r.push(n.slice(e,i)),e=i}return r}),Er=e(function(t,n){return t>n}),_r=e(function(t,n){return t>=n}),qr=e(w),kr=e(function(t,n){return t in n}),Nr=rr(0),Ir=r(ot),Wr=c(function(t,n,r){return xt(Math.max(t.length,n.length,r.length),function(){return t.apply(this,arguments)?n.apply(this,arguments):r.apply(this,arguments)})}),Pr=bt(1),Cr=Un(function(t,n){return n},null),Tr=e(function(t,n){return"function"!=typeof n.indexOf||At(n)?z(n,t,0):n.indexOf(t)}),Br=An(0,-1),Fr=c(function(t,n,r){return V(function(n){return F(t,n,r)},n)}),Rr=c(function(t,n,r){t=r.length>t&&t>=0?t:r.length;var e=Array.prototype.slice.call(r,0);return e.splice(t,0,n),e}),Ur=c(function(t,n,r){return t=r.length>t&&t>=0?t:r.length,[].concat(Array.prototype.slice.call(r,0,t),n,Array.prototype.slice.call(r,t))});ct.prototype.add=function(t){return!at(t,!0,this)},ct.prototype.has=function(t){return at(t,!1,this)};var Dr=e(function(t,n){for(var r,e,u=new ct,i=[],o=0;n.length>o;)r=t(e=n[o]),u.add(r)&&i.push(e),o+=1;return i}),zr=Dr(Ir),Mr=e(function(t,n){var r,e;return t.length>n.length?(r=t,e=n):(r=n,e=t),zr(V(xr(M)(r),e))}),Lr=e(N("intersperse",function(t,n){for(var r=[],e=0,u=n.length;u>e;)e===u-1?r.push(n[e]):r.push(n[e],t),e+=1;return r})),Kr="function"==typeof Object.assign?Object.assign:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,e=arguments.length;e>r;){var u=arguments[r];if(null!=u)for(var i in u)w(i,u)&&(n[i]=u[i]);r+=1}return n},Vr=e(function(t,n){var r={};return r[t]=n,r}),$r={"@@transducer/init":Array,"@@transducer/step":function(t,n){return t.push(n),t},"@@transducer/result":ot},Hr={"@@transducer/init":String,"@@transducer/step":function(t,n){return t+n},"@@transducer/result":ot},Jr={"@@transducer/init":Object,"@@transducer/step":function(t,n){return Kr(t,_t(n)?Vr(n[0],n[1]):n)},"@@transducer/result":ot},Xr=c(function(t,n,r){return a(t)?b(n(t),t["@@transducer/init"](),r):b(n(st(t)),q(t,[],[],!1),r)}),Yr=r(function(t){for(var n=Ft(t),r=n.length,e=0,u={};r>e;){var i=n[e],o=t[i],c=w(o,u)?u[o]:u[o]=[];c[c.length]=i,e+=1}return u}),Zr=r(function(t){for(var n=Ft(t),r=n.length,e=0,u={};r>e;){var i=n[e];u[t[i]]=i,e+=1}return u}),Gr=e(function(t,n){return xt(t+1,function(){var r=arguments[t];if(null!=r&&O(r[n]))return r[n].apply(r,Array.prototype.slice.call(arguments,0,t));throw new TypeError(Wn(r)+' does not have a method named "'+n+'"')})}),Qr=e(function(t,n){return null!=n&&n.constructor===t||n instanceof t}),te=r(function(t){return null!=t&&_n(t,sr(t))}),ne=Gr(1,"join"),re=r(function(t){return Rn(function(){return Array.prototype.slice.call(arguments,0)},t)}),ee=r(function(t){var n,r=[];for(n in t)r[r.length]=n;return r}),ue=e(function(t,n){if("function"!=typeof n.lastIndexOf||At(n)){for(var r=n.length-1;r>=0;){if(_n(n[r],t))return r;r-=1}return-1}return n.lastIndexOf(t)}),ie=r(function(t){return null!=t&&ft(t.length)?t.length:NaN}),oe=e(function(t,n){return function(r){return function(e){return Rt(function(t){return n(t,e)},r(t(e)))}}}),ce=r(function(t){return oe(rr(t),Jn(t))}),ae=r(function(t){return oe(Ut(t),on(t))}),se=r(function(t){return oe(Dt(t),rn(t))}),fe=e(function(t,n){return n>t}),le=e(function(t,n){return n>=t}),pe=c(function(t,n,r){for(var e=0,u=r.length,i=[],o=[n];u>e;)o=t(o[0],r[e]),i[e]=o[1],e+=1;return[o[0],i]}),he=c(function(t,n,r){for(var e=r.length-1,u=[],i=[n];e>=0;)i=t(r[e],i[0]),u[e]=i[1],e-=1;return[u,i[0]]}),ye=e(function(t,n){return b(function(r,e){return r[e]=t(n[e],e,n),r},{},Ft(n))}),de=e(function(t,n){return n.match(t)||[]}),ge=e(function(t,n){return en(t)?!en(n)||1>n?NaN:(t%n+n)%n:NaN}),ve=c(function(t,n,r){return t(r)>t(n)?r:n}),me=Mt(bt,0),be=r(function(t){return me(t)/t.length}),xe=r(function(t){var n=t.length;if(0===n)return NaN;var r=2-n%2,e=(n-r)/2;return be(Array.prototype.slice.call(t,0).sort(function(t,n){return n>t?-1:t>n?1:0}).slice(e,e+r))}),we=e(function(t,n){var r={};return i(n.length,function(){var e=t.apply(this,arguments);return w(e,r)||(r[e]=n.apply(this,arguments)),r[e]})}),je=we(function(){return Wn(arguments)}),Ae=e(function(t,n){return Kr({},t,n)}),Oe=r(function(t){return Kr.apply(null,[{}].concat(t))}),Se=c(function(t,n,r){var e,u={};for(e in n)w(e,n)&&(u[e]=w(e,r)?t(e,n[e],r[e]):n[e]);for(e in r)w(e,r)&&!w(e,u)&&(u[e]=r[e]);return u}),Ee=c(function t(n,r,e){return Se(function(r,e,u){return $(e)&&$(u)?t(n,e,u):n(r,e,u)},r,e)}),_e=e(function(t,n){return Ee(function(t,n,r){return n},t,n)}),qe=e(function(t,n){return Ee(function(t,n,r){return r},t,n)}),ke=c(function(t,n,r){return Ee(function(n,r,e){return t(r,e)},n,r)}),Ne=c(function(t,n,r){return Se(function(n,r,e){return t(r,e)},n,r)}),Ie=e(function(t,n){return t>n?n:t}),We=c(function(t,n,r){return t(r)<t(n)?r:n}),Pe=e(function(t,n){return t%n}),Ce=e(function(t,n){return t*n}),Te=r(function(t){return-t}),Be=e(K(s(["any"],Vt,$t))),Fe=r(function(t){return xt(0>t?1:t+1,function(){return rr(t,arguments)})}),Re=c(function(t,n,r){return t(n(r))}),Ue=r(function(t){return[t]}),De=e(function(t,n){for(var r={},e={},u=0,i=t.length;i>u;)e[t[u]]=1,u+=1;for(var o in n)e.hasOwnProperty(o)||(r[o]=n[o]);return r}),ze=r(function(t){var n,r=!1;return i(t.length,function(){return r?n:(r=!0,n=t.apply(this,arguments))})}),Me=function(t){return{value:t,map:function(n){return Me(n(t))}}},Le=c(function(t,n,r){return t(function(t){return Me(n(t))})(r).value}),Ke=e(function(t,n){return[t,n]}),Ve=lt(u),$e=lt(xr(u)),He=re([Nn,In]),Je=c(function(t,n,r){return _n(Ut(t,r),n)}),Xe=c(function(t,n,r){return Mn(t,Ut(n,r))}),Ye=c(function(t,n,r){return n.length>0&&t(Ut(n,r))}),Ze=e(function(t,n){for(var r={},e=0;t.length>e;)t[e]in n&&(r[t[e]]=n[t[e]]),e+=1;return r}),Ge=e(function(t,n){for(var r={},e=0,u=t.length;u>e;){var i=t[e];r[i]=n[i],e+=1}return r}),Qe=e(function(t,n){var r={};for(var e in n)t(n[e],e,n)&&(r[e]=n[e]);return r}),tu=e(function(t,n){return u([t],n)}),nu=Mt(Ce,1),ru=e(function(t,n){return xt(n.length,function(){for(var r=[],e=0;n.length>e;)r.push(n[e].call(this,arguments[e])),e+=1;return t.apply(this,r.concat(Array.prototype.slice.call(arguments,n.length)))})}),eu=ru(p,[Ge,Ir]),uu=c(function(t,n,r){return _n(n,r[t])}),iu=c(function(t,n,r){return Qr(t,r[n])}),ou=c(function(t,n,r){return null!=r&&w(n,r)?r[n]:t}),cu=c(function(t,n,r){return t(r[n])}),au=e(function(t,n){for(var r=t.length,e=[],u=0;r>u;)e[u]=n[t[u]],u+=1;return e}),su=e(function(t,n){if(!ft(t)||!ft(n))throw new TypeError("Both arguments to range must be numbers");for(var r=[],e=t;n>e;)r.push(e),e+=1;return r}),fu=c(function(t,n,r){for(var e=r.length-1;e>=0;)n=t(r[e],n),e-=1;return n}),lu=o(4,[],function(t,n,r,e){return b(function(r,e){return t(r,e)?n(r,e):f(r)},r,e)}),pu=r(f),hu=e(function(t,n){var r,e=+n,u=0;if(0>e||isNaN(e))throw new RangeError("n must be a non-negative number");for(r=Array(e);e>u;)r[u]=t(u),u+=1;return r}),yu=e(function(t,n){return hu(dt(t),n)}),du=c(function(t,n,r){return r.replace(t,n)}),gu=c(function(t,n,r){for(var e=0,u=r.length,i=[n];u>e;)n=t(n,r[e]),i[e+1]=n,e+=1;return i}),vu=e(function(t,n){return"function"==typeof n.sequence?n.sequence(t):fu(function(t,n){return Jt(Rt(tu,t),n)},t([]),n)}),mu=c(function(t,n,r){return Le(t,dt(n),r)}),bu=e(function(t,n){return Array.prototype.slice.call(n,0).sort(t)}),xu=e(function(t,n){return Array.prototype.slice.call(n,0).sort(function(n,r){var e=t(n),u=t(r);return u>e?-1:e>u?1:0})}),wu=e(function(t,n){return Array.prototype.slice.call(n,0).sort(function(n,r){for(var e=0,u=0;0===e&&t.length>u;)e=t[u](n,r),u+=1;return e})}),ju=Gr(1,"split"),Au=e(function(t,n){return[An(0,t,n),An(t,ie(n),n)]}),Ou=e(function(t,n){if(0>=t)throw Error("First argument to splitEvery must be a positive integer");for(var r=[],e=0;n.length>e;)r.push(An(e,e+=t,n));return r}),Su=e(function(t,n){for(var r=0,e=n.length,u=[];e>r&&!t(n[r]);)u.push(n[r]),r+=1;return[u,Array.prototype.slice.call(n,r)]}),Eu=e(function(t,n){return _n(Gn(t.length,n),t)}),_u=e(function(t,n){return+t-+n}),qu=e(function(t,n){return Pn(Kn(t,n),Kn(n,t))}),ku=c(function(t,n,r){return Pn(Vn(t,n,r),Vn(t,r,n))}),Nu=e(function(t,n){for(var r=n.length-1;r>=0&&t(n[r]);)r-=1;return An(r+1,1/0,n)});pt.prototype["@@transducer/init"]=Ot.init,pt.prototype["@@transducer/result"]=Ot.result,pt.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.xf["@@transducer/step"](t,n):f(t)};var Iu=e(s(["takeWhile"],e(function(t,n){return new pt(t,n)}),function(t,n){for(var r=0,e=n.length;e>r&&t(n[r]);)r+=1;return An(0,r,n)}));ht.prototype["@@transducer/init"]=Ot.init,ht.prototype["@@transducer/result"]=Ot.result,ht.prototype["@@transducer/step"]=function(t,n){return this.f(n),this.xf["@@transducer/step"](t,n)};var Wu=e(s([],e(function(t,n){return new ht(t,n)}),function(t,n){return t(n),n})),Pu=e(function(t,n){if(!yt(t))throw new TypeError("‘test’ requires a value of type RegExp as its first argument; received "+Wn(t));return _(t).test(n)}),Cu=Gr(0,"toLowerCase"),Tu=r(function(t){var n=[];for(var r in t)w(r,t)&&(n[n.length]=[r,t[r]]);return n}),Bu=r(function(t){var n=[];for(var r in t)n[n.length]=[r,t[r]];return n}),Fu=Gr(0,"toUpperCase"),Ru=xt(4,function(t,n,r,e){return b(t("function"==typeof n?d(n):n),r,e)}),Uu=r(function(t){for(var n=0,r=[];t.length>n;){for(var e=t[n],u=0;e.length>u;)void 0===r[u]&&(r[u]=[]),r[u].push(e[u]),u+=1;n+=1}return r}),Du=c(function(t,n,r){return"function"==typeof r["fantasy-land/traverse"]?r["fantasy-land/traverse"](n,t):vu(t,Rt(n,r))}),zu="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",Mu=r(!("function"==typeof String.prototype.trim)||zu.trim()?function(t){var n=RegExp("^["+zu+"]["+zu+"]*"),r=RegExp("["+zu+"]["+zu+"]*$");return t.replace(n,"").replace(r,"")}:function(t){return t.trim()}),Lu=e(function(t,n){return i(t.length,function(){try{return t.apply(this,arguments)}catch(t){return n.apply(this,u([t],arguments))}})}),Ku=r(function(t){return function(){return t(Array.prototype.slice.call(arguments,0))}}),Vu=r(function(t){return cn(1,t)}),$u=e(function(t,n){return xt(t,function(){for(var r,e=1,u=n,i=0;t>=e&&"function"==typeof u;)r=e===t?arguments.length:i+u.length,u=u.apply(this,Array.prototype.slice.call(arguments,i,r)),e+=1,i=r;return u})}),Hu=e(function(t,n){for(var r=t(n),e=[];r&&r.length;)e[e.length]=r[0],r=t(r[1]);return e}),Ju=e(W(zr,u)),Xu=e(function(t,n){for(var r,e=0,u=n.length,i=[];u>e;)F(t,r=n[e],i)||(i[i.length]=r),e+=1;return i}),Yu=c(function(t,n,r){return Xu(t,u(n,r))}),Zu=c(function(t,n,r){return t(r)?r:n(r)}),Gu=gn(ot),Qu=c(function(t,n,r){for(var e=r;!t(e);)e=n(e);return e}),ti=r(function(t){var n,r=[];for(n in t)r[r.length]=t[n];return r}),ni=function(t){return{value:t,"fantasy-land/map":function(){return this}}},ri=e(function(t,n){return t(ni)(n).value}),ei=c(function(t,n,r){return t(r)?n(r):r}),ui=e(function(t,n){for(var r in t)if(w(r,t)&&!t[r](n[r]))return!1;return!0}),ii=e(function(t,n){return ui(Rt(_n,t),n)}),oi=e(function(t,n){return In(xr(M)(t),n)}),ci=e(function(t,n){for(var r,e=0,u=t.length,i=n.length,o=[];u>e;){for(r=0;i>r;)o[o.length]=[t[e],n[r]],r+=1;e+=1}return o}),ai=e(function(t,n){for(var r=[],e=0,u=Math.min(t.length,n.length);u>e;)r[e]=[t[e],n[e]],e+=1;return r}),si=e(function(t,n){for(var r=0,e=Math.min(t.length,n.length),u={};e>r;)u[t[r]]=n[r],r+=1;return u}),fi=c(function(t,n,r){for(var e=[],u=0,i=Math.min(n.length,r.length);i>u;)e[u]=t(n[u],r[u]),u+=1;return e});t.F=gt,t.T=vt,t.__=mt,t.add=bt,t.addIndex=wt,t.adjust=jt,t.all=St,t.allPass=Lt,t.always=dt,t.and=Kt,t.any=$t,t.anyPass=Ht,t.ap=Jt,t.aperture=Xt,t.append=Yt,t.apply=Zt,t.applySpec=Qt,t.applyTo=tn,t.ascend=nn,t.assoc=rn,t.assocPath=on,t.binary=an,t.bind=qt,t.both=ln,t.call=hn,t.chain=gn,t.clamp=vn,t.clone=bn,t.comparator=xn,t.complement=jn,t.compose=W,t.composeK=P,t.composeP=function(){if(0===arguments.length)throw Error("composeP requires at least one argument");return T.apply(this,Sn(arguments))},t.concat=Pn,t.cond=Cn,t.construct=Bn,t.constructN=Tn,t.contains=Fn,t.converge=Rn,t.countBy=Dn,t.curry=pn,t.curryN=xt,t.dec=zn,t.defaultTo=Mn,t.descend=Ln,t.difference=Kn,t.differenceWith=Vn,t.dissoc=$n,t.dissocPath=Xn,t.divide=Yn,t.drop=Zn,t.dropLast=Qn,t.dropLastWhile=tr,t.dropRepeats=ir,t.dropRepeatsWith=ur,t.dropWhile=or,t.either=ar,t.empty=sr,t.endsWith=lr,t.eqBy=pr,t.eqProps=hr,t.equals=_n,t.evolve=yr,t.filter=Nn,t.find=dr,t.findIndex=gr,t.findLast=vr,t.findLastIndex=mr,t.flatten=br,t.flip=xr,t.forEach=wr,t.forEachObjIndexed=jr,t.fromPairs=Ar,t.groupBy=Or,t.groupWith=Sr,t.gt=Er,t.gte=_r,t.has=qr,t.hasIn=kr,t.head=Nr,t.identical=En,t.identity=Ir,t.ifElse=Wr,t.inc=Pr,t.indexBy=Cr,t.indexOf=Tr,t.init=Br,t.innerJoin=Fr,t.insert=Rr,t.insertAll=Ur,t.intersection=Mr,t.intersperse=Lr,t.into=Xr,t.invert=Yr,t.invertObj=Zr,t.invoker=Gr,t.is=Qr,t.isEmpty=te,t.isNil=un,t.join=ne,t.juxt=re,t.keys=Ft,t.keysIn=ee,t.last=er,t.lastIndexOf=ue,t.length=ie,t.lens=oe,t.lensIndex=ce,t.lensPath=ae,t.lensProp=se,t.lift=fn,t.liftN=sn,t.lt=fe,t.lte=le,t.map=Rt,t.mapAccum=pe,t.mapAccumRight=he,t.mapObjIndexed=ye,t.match=de,t.mathMod=ge,t.max=Et,t.maxBy=ve,t.mean=be,t.median=xe,t.memoize=je,t.memoizeWith=we,t.merge=Ae,t.mergeAll=Oe,t.mergeDeepLeft=_e,t.mergeDeepRight=qe,t.mergeDeepWith=ke,t.mergeDeepWithKey=Ee,t.mergeWith=Ne,t.mergeWithKey=Se,t.min=Ie,t.minBy=We,t.modulo=Pe,t.multiply=Ce,t.nAry=cn,t.negate=Te,t.none=Be,t.not=wn,t.nth=rr,t.nthArg=Fe,t.o=Re,t.objOf=Vr,t.of=Ue,t.omit=De,t.once=ze,t.or=cr,t.over=Le,t.pair=Ke,t.partial=Ve,t.partialRight=$e,t.partition=He,t.path=Ut,t.pathEq=Je,t.pathOr=Xe,t.pathSatisfies=Ye,t.pick=Ze,t.pickAll=Ge,t.pickBy=Qe,t.pipe=I,t.pipeK=function(){if(0===arguments.length)throw Error("pipeK requires at least one argument");return P.apply(this,Sn(arguments))},t.pipeP=T,t.pluck=zt,t.prepend=tu,t.product=nu,t.project=eu,t.prop=Dt,t.propEq=uu,t.propIs=iu,t.propOr=ou,t.propSatisfies=cu,t.props=au,t.range=su,t.reduce=Mt,t.reduceBy=Un,t.reduceRight=fu,t.reduceWhile=lu,t.reduced=pu,t.reject=In,t.remove=Hn,t.repeat=yu,t.replace=du,t.reverse=Sn,t.scan=gu,t.sequence=vu,t.set=mu,t.slice=An,t.sort=bu,t.sortBy=xu,t.sortWith=wu,t.split=ju,t.splitAt=Au,t.splitEvery=Ou,t.splitWhen=Su,t.startsWith=Eu,t.subtract=_u,t.sum=me,t.symmetricDifference=qu,t.symmetricDifferenceWith=ku,t.tail=On,t.take=Gn,t.takeLast=fr,t.takeLastWhile=Nu,t.takeWhile=Iu,t.tap=Wu,t.test=Pu,t.times=hu,t.toLower=Cu,t.toPairs=Tu,t.toPairsIn=Bu,t.toString=Wn,t.toUpper=Fu,t.transduce=Ru,t.transpose=Uu,t.traverse=Du,t.trim=Mu,t.tryCatch=Lu,t.type=mn,t.unapply=Ku,t.unary=Vu,t.uncurryN=$u,t.unfold=Hu,t.union=Ju,t.unionWith=Yu,t.uniq=zr,t.uniqBy=Dr,t.uniqWith=Xu,t.unless=Zu,t.unnest=Gu,t.until=Qu,t.update=Jn,t.useWith=ru,t.values=Gt,t.valuesIn=ti,t.view=ri,t.when=ei,t.where=ui,t.whereEq=ii,t.without=oi,t.xprod=ci,t.zip=ai,t.zipObj=si,t.zipWith=fi,Object.defineProperty(t,"__esModule",{value:!0})});
;var PivotData;(function(n){function t(){n.SR=Forguncy.RS}n.SR=Forguncy.RS;n.setCulture=t})(PivotData||(PivotData={}))
;var PivotData;(function(n){var t=function(){function t(){}return t.isNumberNeedRound=function(n){return n==null?!1:n!==_.round(n,2)},t.isEmpty=function(n){return n===undefined||n===null||n===""||Array.isArray(n)&&n.length===0},t.getGuid=function(n){return""+(n||"")+(new Date).getTime()+Math.floor(Math.random()*1e4)},t.valueCompare=function(n,t){var i=n==null,r=t==null;return i&&r?0:i?1:r?-1:(n=n.valueOf(),t=t.valueOf(),n>t?1:n<t?-1:0)},t.entryKey=function(n){return n==null?'\0':""+(n instanceof Date?n.valueOf():n)},t.createEventHandler=function(n,t){return function(){return t.apply(n,arguments)}},t.getDefaultFormat=function(){return"General"},t.datetimeFromJSON=function(n){if(n==null)return null;var t;return n instanceof Date?n:(t=new Date(n),new Date(t.getTime()+t.getTimezoneOffset()*6e4))},t.datetimeToJSON=function(n){return n instanceof Date?new Date(n.getTime()-n.getTimezoneOffset()*6e4).toJSON():n},t.isValidFormat=function(n){return!!n},t.getRoundedFloatingNumber=function(n,t){return!n||!n.toPrecision?n:(t===undefined&&(t=15),Number(n.toPrecision(t)))},t.getFormatter=function(t){var i;if(t.type==="subDate")switch(t.subDatePart){case"year":case"fiscalYear":i=n.SR.datetime_year_format;break;default:i="@"}else i=t.format;return i},t.formatstring=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return arguments.length==0?null:(i=Array.prototype.slice.call(arguments,1),n.replace(/\{(\d+)\}/g,function(n,t){return i[t]}))},t.getLocaleDateFormat=function(n){var t="yyyy/M/d";return n&&(t=t+" HH:mm:ss"),t},t.bSearchBy=function(n){function t(t,i,r){while(i<r){var u=i+r>>>1;n(u)<t?i=u+1:r=u}return i}function i(t,i,r){while(i<r){var u=i+r>>>1;t<n(u)?r=u:i=u+1}return i}return{left:t,right:i}},t.intersectMapping=function(n,t){var e=[],i=0,r=0,u,f;if(n&&t&&n.length&&t.length)for(u=n.length,f=t.length;i<u&&r<f;){while(i<u&&n[i]<t[r])++i;if(i==u)break;while(r<f&&t[r]<n[i])++r;if(r==f)break;n[i]===t[r]&&(e.push(n[i]),++i,++r)}return e},t.getFiscalYear=function(n,t){var r=n.getMonth(),i=n.getFullYear();return r<t?i-1:i},t.getFiscalYearQuarter=function(n,t){return~~((n.getMonth()+12-t)%12/3)+1},t.getFiscalWeek=function(n,t){var i=new Date(n.valueOf());i.setHours(0,0,0,0);var r=new Date(i.getFullYear(),t,1,0,0,0,0),u=r.getDay(),f=((i.valueOf()-r.valueOf())/864e5+u)/7+(u?0:1);return Math.ceil(f)},t.IsIE=function(){var n=window.navigator.userAgent,t=n.indexOf("MSIE ")>0,i=n.indexOf("Trident/")>0;return t||i},t.trimExtraFloatNumber=function(n){return typeof n=="number"&&n%1!=0&&(n=Math.round(n*1e6)/1e6),n},t}(),i;n.utils=t;i=function(){function n(){this._eventData={}}return n.prototype.on=function(n,t){var i=this._eventData[n];i==null&&(i=this._eventData[n]=[]);i.push(t)},n.prototype.off=function(n,i){var r,u;if(t.isEmpty(n))this._eventData={};else{if(r=this._eventData[n],r==null)return;i?(u=r.indexOf(i),r.splice(u,1)):r=[];this._eventData[n]=r}},n.prototype.fire=function(n,t){var r=this,i=this._eventData[n];i!=null&&i.forEach(function(n){try{n.call(r,t)}catch(i){}})},n}();n.EventBase=i})(PivotData||(PivotData={}));String.prototype.format||(String.prototype.format=function(){var n=arguments;return this.replace(/{(\d+)}/g,function(t,i){return typeof n[i]!="undefined"?n[i]:t})});String.prototype.endsWith||(String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1});String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")})
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),PivotData;(function(n){var u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABGdBTUEAALGPC/xhBQAAADdJREFUKFNjSM8u/E8KBmt4/fYtURinhtyiCjBGF6ezBpgiXJhyDcgYWREyHkANuDBcA/G48D8Aamyz8N1rlfYAAAAASUVORK5CYII=",f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABGdBTUEAALGPC/xhBQAAACdJREFUKFNjSM8u/E8KBmt4/fYtUXiwawDR+DDlGojBg1kD8bjwPwC4WsPYCYUkkAAAAABJRU5ErkJggg==",i=5,t=12,e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.processMouseDown=function(n){var t=n.row,i=n.col;return t===0&&i===0&&n.sheet.setSelection(-1,-1,n.sheet.getRowCount(),n.sheet.getColumnCount()),!0},t.prototype.getHitInfo=function(n,t,i,r,u){return{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:u.sheetArea}},t.prototype.paintValue=function(n,t,i,r,u,f,e,o){n.save();n.rect(i+1,r+1,u-2,f-2);n.clip();n.beginPath();GC.Spread.Sheets.CellTypes.Base.prototype.paintValue.call(this,n,t,i,r,u,f,e,o);n.restore()},t.prototype.paintContent=function(n,t,i,r,u,f,e,o){var h=o.sheetArea,l,c,a,s;(h===2||h===1)&&(l=o.visualState||0,c="columnHeader",h===2&&(c="rowHeader"),a=this.getThemeStyle(o.visualState,"gc-"+c+"-"+Forguncy.SpreadJSHelpMethods.HelpMethods.getVisualStateName(l)),Forguncy.SpreadJSHelpMethods.CellTypeContext.paintHeaderCellGridline(n,i,r,u,f,e,c,a,h));o.cellOverflowLayout||(s=new GC.Spread.Sheets.Rect(i,r,u,f),this.paintValue(n,t,s.x,s.y,s.width,s.height,e,o))},t}(GC.Spread.Sheets.CellTypes.Base),r;n.NormalColumnHeaderCellType=e;r=function(n){function r(){return n!==null&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.paintContent=function(n,t,i,r,u,f,e,o){var h=o.sheetArea,l,c,a,s;(h===2||h===1)&&(l=o.visualState||0,c="columnHeader",h===2&&(c="rowHeader"),a=this.getThemeStyle(o.visualState,"gc-"+c+"-"+Forguncy.SpreadJSHelpMethods.HelpMethods.getVisualStateName(l)),Forguncy.SpreadJSHelpMethods.CellTypeContext.paintHeaderCellGridline(n,i,r,u,f,e,c,a,h));this.fixRightBorder(n,i,r,u,f,o);o.cellOverflowLayout||(s=new GC.Spread.Sheets.Rect(i,r,u,f),this.paintValue(n,t,s.x,s.y,s.width,s.height,e,o))},r.prototype.fixRightBorder=function(n,t,i,r,u,f){var s,h=GC.Spread.Sheets.SheetArea.colHeader,e,o,v;if(f.sheetArea===h){var y=f.row,p=f.col,c=f.sheet,l=c.getColumnCount(),a=f.sheet.getSpan(y,p,h);a&&a.colCount>1&&p+a.colCount===l&&c.getColumnWidth(l-1)===0&&(e=(s=c.getStyle(y,l-1,h))===null||s===void 0?void 0:s.borderRight,o=Forguncy.SpreadJSHelper.getBorderWidth(e===null||e===void 0?void 0:e.style),o>0&&(n.beginPath(),n.strokeStyle=e.color,n.lineWidth=o,v=o===2?1:.5,n.moveTo(t+r-v,i),n.lineTo(t+r-v,i+u),n.stroke()))}},r.prototype.paintValue=function(n,r,e,o,s,h,c,l){var w,a,b,p;if(n.save(),n.rect(e+1,o+1,s-2,h-2),n.clip(),n.beginPath(),w=l.sheet,a=w.getTag(l.row,l.col,l.sheetArea),a===null||a===void 0?void 0:a.hide){n.restore();return}var v=a.collapse?u:f,y=l.imageLoader,k=y.getState(v);k?(b=y.getImage(v),n.drawImage(b,e+i,o+h*.5-t/2,t,t)):y.addImage(v);p={x:e+i+t,width:s-i-t};GC.Spread.Sheets.CellTypes.Base.prototype.paintValue.call(this,n,r,p.x,o,p.width,h,c,l);n.restore()},r.prototype.getHitInfo=function(n,t,i,r,u){return u?{x:n,y:t,row:u.row,col:u.col,cellRect:r,sheetArea:u.sheetArea,sheet:u.sheet}:null},r.prototype.hitOnCollapseIcon=function(n){var r=n.cellRect,u=n.x,f=n.y,s=r.height,e=r.x+i,o=r.y+s*.5;return e<=u+10&&u<e+t&&f+10>=o&&f<o+t},r.prototype.processMouseUp=function(n){var r=n.sheet,u=n.row,f=n.col,e=n.sheetArea,t=r.getTag(u,f,e),i;return t||(t={}),i=this.hitOnCollapseIcon(n),i&&(t.collapse=!t.collapse),t.isHitOnCollapseIcon=i,r.setTag(u,f,t,e),!0},r.prototype.getAutoFitWidth=function(t,r,u,f,e){return n.prototype.getAutoFitWidth.call(this,t,r,u,f,e)+i+12+3},r}(GC.Spread.Sheets.CellTypes.Base);n.CollapseHeaderCellType=r})(PivotData||(PivotData={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),PivotData;(function(n){var tt=function(){function n(){this.layout=3;this.subtotals=3;this.grandTotals=1;this.headerText=2;this.highlightOverwriteData=!0}return n}(),it,rt,ut,a,ft,et,ot,st,r,s,at,vt,y,yt,u,h,c,b,k,d,bt,l;n.PivotLayoutSetting=tt;it=function(){function n(){}return n.String="String",n.Number="Number",n.Date="Date",n.DateTime="DateTime",n.Boolean="Boolean",n}();n.DataType=it;rt=function(){function n(){this.measures=[];this.dimensions=[];this.columns={};this.startMonth=0}return n}();n.DataSetDataType=rt;ut=function(){function n(){this.lookUps=[];this.backgroundLookUps=[];this.values=[];this.startMonth=0}return n}();n.DataSetDataColumn=ut;a=function(){function n(n,t){this.name=n;this.display=t}return n}();n.PivotSettingConfigItem=a;ft=function(){function n(){this.addressing=[];this.partitioning=[]}return n}();n.PivotSettingValueAdvance=ft;et=function(){function n(){}return n}();n.PivotSettingValueAlong=et;ot=function(){function n(n,t){this.name=n;this.display=t}return n}();n.PivotSettingConfigValue=ot;st=function(){function n(){this.columns=[];this.rows=[];this.values=[]}return n}();n.PivotSettingConfig=st;var o=function(t){function i(n,r){var u=t.call(this)||this,f,e;if(u.__proto__=i.prototype,u._column=n,r)for(f=!1;!f;)e=r.splice(0,1e4),u.push.apply(u,e),e.length<1e4&&(f=!0);return u}return __extends(i,t),i.prototype.getPos=function(t){var u=this._column.dataType==="datetime"||this._column.dataType==="date",i,r;return i=u?function(n){return n==null?'\0':n.valueOf()}:n.utils.entryKey,r=this._column.lookUps.reduce(function(n,t,r){return n[i(t)]=r,n},{}),r[i(t)]},i}(Array),ht=function(){function n(){this.funcType=4}return n}(),ct=function(t){function i(n){var r=t.call(this)||this,u,f;for(r.lookUps=new o(r),r.backgroundLookUps=new o(r),r.startMonth=0,r.__proto__=i.prototype,u=!1;!u;)f=n.splice(0,1e4),r.push.apply(r,f),f.length<1e4&&(u=!0);return r}return __extends(i,t),i.prototype.setDefaultMapping=function(n){this._defaultMapping=n},i.prototype.getSortFunction=function(){var t=this.getSortInfo();return t&&t.func||n.utils.valueCompare},i.prototype.getSortInfo=function(){return this._sortInfo},i.prototype.setSortInfo=function(n){n.func=s.buildSortFunction(n.funcType,n.setting);this._sortInfo=n;delete this._orderedIndexes;delete this._sortedEntries},i.prototype.getOrderedIndexes=function(){return this._orderedIndexes||(this._orderedIndexes=s.buildOrderedIndexes(this,this._defaultMapping.slice(0))),this._orderedIndexes},i.prototype.getEntries=function(){var t,i,n,r;if(!this._entries){if(t=this.lookUps?this.lookUps.slice(0):[],!t.length){for(i={},n=0;n<this.length;++n)i[this[n]]=this[n];for(r in i)t.push(i[r])}this._entries=t}return this._entries.slice(0)},i.prototype.getSortedEntries=function(){if(!this._sortedEntries){var n=this.getEntries(),t=this.getSortFunction();this._sortedEntries=n.sort(t)}return this._sortedEntries.slice(0)},i.prototype.getEntriesMapping=function(){var r,i,u,e,t,f;if(!this._entriesMapping){var o=this.getSortedEntries(),s=this.getOrderedIndexes(),c=!!this.lookUps,h={},l=this.getSortFunction();for(r=0,i=0;r<o.length;++r){for(u=o[r],e={value:u,start:i,end:i},h[n.utils.entryKey(u)]=e,t=i;t<s.length;){if(f=this[s[t]],c&&(f=this.lookUps[f]),l(u,f)<0){i=t;break}t++}e.end=t-1}this._entriesMapping=h}return this._entriesMapping},i}(Array),hi=function(n){function t(i){var r=n.call(this)||this;return r.$br={},r.__proto__=t.prototype,r._dataSet=i,r}return __extends(t,n),t.prototype.getColumn=function(n){var t,i;return n==null?null:(t=typeof n=="number"?this[n]:this.$br[n],i=t&&t.dataType,(i==="date"||i==="datetime")&&this._dataSet._createSubDateColumns(t,i),t)},t.prototype.getColumnByDisplay=function(n){var i=this.$br,r,t;for(r in i)if(t=i[r],t.displayName===n)return t;return null},t.prototype.getColumns=function(){var n=[],t=this.$br;for(var i in t)n.push(t[i]);return n},t}(Array),v=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.$br={},t}return __extends(t,n),t}(Array),ci=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.$br={},t}return __extends(t,n),t}(Array),li=function(){function n(){}return n}(),lt=function(){function n(){}return n}();n.TableDataCell=lt;r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.visible=!0,t}return __extends(t,n),t}(lt);s=function(t){function i(n){var i=t.call(this)||this;return i._init(n),i}return __extends(i,t),i.getDataType=function(n){switch(n){case"Date":return"date";case"DateTime":return"datetime";case"String":return"string";case"SByte":case"Int16":case"Int64":case"Int32":case"Byte":case"UInt16":case"UInt32":case"UInt64":case"Single":case"Double":case"Decimal":case"Number":return"number";case"Boolean":return"boolean";default:return"unknown"}},i.buildLookUps=function(t){var r,u,i;if(t)for(r={},u=t.lookUps=[],i=0;i<t.length;++i){var e=t[i],o=n.utils.entryKey(e),f=r[o];f===undefined&&(r[o]=f=u.length,u.push(e));t[i]=f}},i.buildOrderedIndexes=function(n,t){if(n&&n.length){var r=!!n.lookUps,u=n.getSortFunction(),i=[];t.forEach(function(t){var u=r?n.lookUps[n[t]]:n[t];i.push({index:t,value:u})});i.sort(function(n,t){return u(n.value,t.value)});t=i.map(function(n){return n.index})}return t},i.buildSortFunction=function(t,i){var u,f,r;switch(t){case 1:for(u={},f=i,r=0;r<12;r++)u[(r+f)%12||12]=r;return function(n,t){return u[n]-u[t]};case 3:default:return n.utils.valueCompare}},i.synchronizeSubDate=function(t,i,r,u,f){for(var o,c,l=["year","fiscalYear","month","quarter","week","day","hour","minute","second","millisecond"],a=l.map(function(n){return r+"("+n+")"}),s=0;s<a.length;s++){var h=a[s],v=l[s],e=void 0;switch(v){case"year":e=n.SR.directives_scenariodimension_datadimensions_year;break;case"fiscalYear":e=n.SR.directives_scenariodimension_datadimensions_fiscalyear;break;case"quarter":e=n.SR.directives_scenariodimension_datadimensions_quarter;break;case"month":e=n.SR.directives_scenariodimension_datadimensions_month;break;case"week":e=n.SR.directives_scenariodimension_datadimensions_week;break;case"day":e=n.SR.directives_scenariodimension_datadimensions_day;break;case"hour":e=n.SR.directives_scenariodimension_datadimensions_hour;break;case"minute":e=n.SR.directives_scenariodimension_datadimensions_minute;break;case"second":e=n.SR.directives_scenariodimension_datadimensions_second;break;case"millisecond":e=n.SR.directives_scenariodimension_datadimensions_millisecond;break;default:e=v}o=t.table.getColumn(h);o&&(c=i.content.nameMappings[h],c?o.displayName=c:(o.displayName=e+"("+u+")",f?t.fire("columnRenamedAndChanged",{columnName:h,newDisplayName:o.displayName,newColumnLookUps:o.lookUps}):t.fire("columnRenamed",{columnName:h,newDisplayName:o.displayName})))}},i.prototype._init=function(t){var u=this,a=new hi(this),l=new ci,y=new v,f,s,r,c,h,e,p;if(u.table=a,u._fields=l,u._columnTypes=y,u._views={},u.count=0,u.startMonth=0,t){if(t.columns)for(f in t.columns)if(s=t.columns[f],r=new ct(s.values||[]),r.name=f,r.lookUps=new o(r,s.lookUps),r.backgroundLookUps=new o(r,s.backgroundLookUps),r.startMonth=s.startMonth,c=r.dataType=i.getDataType(s.dataType),y.push(c),y.$br[f]=c,l.$br[f]=l.length,l.push(f),a.$br[f]=r,a.push(r),!u.count&&r.length&&(u.count=r.length),r.setDefaultMapping(this.getDefaultMapping()),c==="date"||c==="datetime")for(h=r.lookUps,e=0,p=h.length;e<p;++e)h[e]=h[e]===""||h[e]===null?null:n.utils.datetimeFromJSON(h[e]);u.startMonth=t.startMonth}},i.prototype.getColumns=function(){return this._fields.slice(0)},i.prototype.getColumnTypes=function(){return this._columnTypes.slice(0)},i.prototype._createSubDateColumns=function(n,t){var u=this,a=n.name,y=n.displayName||n.name,e={year:[],fiscalYear:[],quarter:[],month:[],week:[],day:[]},c,v,o,r,l,f,h,s;if(t==="datetime"&&$.extend(e,{hour:[],minute:[],second:[]}),n.dateSubFields!==undefined&&n.dateSubFields!==null)return!0;n.dateSubFields=31;t==="datetime"&&(n.dateSubFields=n.dateSubFields|224);c=n.startMonth;this.buildSubData(n,e,u.count,t,c);v="number";for(f in e)o=a+"\x1d"+f+"\x1d",r=new ct(e[f]),r.name=o,l=v,r.dataType=l,r.type="subDate",r.subDatePart=f,r.displayName=u.getSubDateDefaultDisplayName(f,y),u.table.$br[o]&&(r.displayName=u.table.$br[o].displayName),u.table.$br[o]=r,u._columnTypes.$br[o]=l,i.buildLookUps(r);for(f in e)h=new ht,h.columnName=e[f].name,h.funcType=3,u.setColumnSortInfo(h);return s=new ht,s.columnName=a+"\x1dmonth\x1d",s.funcType=1,s.setting=c+1,u.setColumnSortInfo(s),!0},i.prototype.buildSubData=function(t,i,r,u,f){for(var s,o,e=0;e<r;++e)s=t.lookUps[t[e]],o=undefined,s&&(o=new Date(s)),o===undefined?(i.year[e]=null,i.fiscalYear[e]=null,i.quarter[e]=null,i.month[e]=null,i.week[e]=null,i.day[e]=null,u==="datetime"&&(i.hour[e]=null,i.minute[e]=null,i.second[e]=null)):(i.year[e]=o.getFullYear(),i.fiscalYear[e]=n.utils.getFiscalYear(o,f),i.quarter[e]=n.utils.getFiscalYearQuarter(o,f),i.month[e]=o.getMonth()+1,i.week[e]=n.utils.getFiscalWeek(o,f),i.day[e]=o.getDate(),u==="datetime"&&(i.hour[e]=o.getHours(),i.minute[e]=o.getMinutes(),i.second[e]=o.getSeconds()))},i.prototype.getSubDateDefaultDisplayName=function(t,i){var r;switch(t){case"year":r=n.SR.directives_scenariodimension_datadimensions_year+"("+i+")";break;case"fiscalYear":r=n.SR.directives_scenariodimension_datadimensions_fiscalyear+"("+i+")";break;case"quarter":r=n.SR.directives_scenariodimension_datadimensions_quarter+"("+i+")";break;case"month":r=n.SR.directives_scenariodimension_datadimensions_month+"("+i+")";break;case"week":r=n.SR.directives_scenariodimension_datadimensions_week+"("+i+")";break;case"day":r=n.SR.directives_scenariodimension_datadimensions_day+"("+i+")";break;case"hour":r=n.SR.directives_scenariodimension_datadimensions_hour+"("+i+")";break;case"minute":r=n.SR.directives_scenariodimension_datadimensions_minute+"("+i+")";break;case"second":r=n.SR.directives_scenariodimension_datadimensions_second+"("+i+")";break;case"millisecond":r=n.SR.directives_scenariodimension_datadimensions_millisecond+"("+i+")";break;default:r=i}return r},i.prototype.getColumnSortInfo=function(n){var t=this,i;if(t.table.$br.hasOwnProperty(n))return i=t.table.$br[n],i.getSortInfo()},i.prototype.setColumnSortInfo=function(n){var t=this,i;t.table.$br.hasOwnProperty(n.columnName)&&(i=t.table.$br[n.columnName],i.setSortInfo(n))},i.prototype.getDefaultMapping=function(){var t,n,i;if(!this._defaultMapping){for(t=[],n=0,i=this.count;n<i;++n)t[n]=n;this._defaultMapping=t}return this._defaultMapping},i.prototype.getDefaultMapSet=function(){var t,n,i;if(!this._defaultMapSet){for(t=[],n=0,i=this.count;n<i;++n)t[n]=0;this._defaultMapSet=t}return this._defaultMapSet},i.prototype.addView=function(){var t=n.utils.getGuid("view"),i=this._views[t]=new yt(this);return i.id=t,i},i.prototype.columnRename=function(n,t){this.fire("columnDisplayChanged",{columnName:n,newDisplayName:t})},i.prototype.getColumnFormat=function(n){return this.table.getColumn(n).format},i.prototype.changeColumnFormat=function(n,t){this.table.getColumn(n).format=t;this.fire("columnFormatChanged")},i}(n.EventBase);n.DataSet=s;at=function(){function n(){this.choice={}}return n}();n.SlicerSetting=at;vt=function(){function n(){}return n}();n.SlicerChioce=vt;y=function(t){function i(n,i){var r=t.call(this)||this;return r._init(n,i),r}return __extends(i,t),i.prototype.onChoiceChange=function(n){var u=this,r,f={added:[],removed:[]},i,t;switch(this._type){case 10:i=n.items;t=this.changeExact;break;case 20:case 21:case 22:i={min:n.min,max:n.max,minIncluded:n.minIncluded,maxIncluded:n.maxIncluded};t=this.changeRange;break;case 30:case 31:case 32:i=n.value;t=this.changeStr}return t&&(r=t.call(u,i,f)),r&&u._onChange(f),r},i.prototype.fillChangeSet=function(t,i){var r=this,u=this._column.getOrderedIndexes(),f=this._column.getEntriesMapping();i.added&&i.added.forEach(function(i){r.fillArray(f[n.utils.entryKey(i)],t.added,u)});i.removed&&i.removed.forEach(function(i){r.fillArray(f[n.utils.entryKey(i)],t.removed,u)})},i.prototype.fillArray=function(n,t,i){if(n&&t)for(var r=n.start;r<=n.end;++r)t.push(i[r])},i.prototype.getFieldsItems=function(t){var i=[];return t.forEach(function(t){typeof t=="string"&&t.indexOf("\x1d")!=-1?i.push(t.split("\x1d")):i.push(n.utils.entryKey(t))}),i},i.prototype.changeExact=function(t,i){var l,s,h,a;t||(t=[]);var r=this,u=r._choices,f=[],c,e=[],o=[];for(f.mapping={},l=function(i){var o=t[i],r=n.utils.entryKey(o),c=s.getFieldsItems(s._fieldValues),h=c.filter(function(n){return Array.isArray(n)?n.indexOf(r)!=-1:n===r});if(h.length<=0)return"continue";c=s.getFieldsItems(u);h=c.filter(function(n){return Array.isArray(n)?n.indexOf(r)!=-1:n===r}).map(function(n){return Array.isArray(n)?n.join("\x1d"):n});h.length>0?h.forEach(function(n){delete u.mapping[n]}):e.push(o);f.push(o);f.mapping[r]=o},s=this,h=0;h<t.length;++h)l(h);r._choices=f;for(a in u.mapping)o.push(u.mapping[a]);return c=!!(e.length||o.length),c&&this.fillChangeSet.call(r,i,r._exclude?{added:o,removed:e}:{added:e,removed:o}),c},i.prototype.changeRange=function(t,i){var r=this,tt=!!t.minIncluded,it=!!t.maxIncluded,b,k,rt,ut,u,o=r._column.getSortedEntries(),s=o.length,f,ft=r._column.getEntriesMapping(),et=r._dataSet.count,st=et-1,c=n.utils.bSearchBy(function(n){return o[n]}),d,g,e,p,h,w,ot;t.min===undefined||isNaN(t.min)?(ut=0,k=0):(d=tt?c.left(t.min,0,s-1):c.right(t.min,0,s-1),u=o[d],f=ft[n.utils.entryKey(u)],e=n.utils.valueCompare(u,t.min),e<0||e===0&&!tt?(++d,k=f.end+1):k=f.start);t.max===undefined||isNaN(t.max)?(rt=s-1,b=et-1):(g=it?c.right(t.max,0,s-1):c.left(t.max,0,s-1),u=o[g],f=ft[n.utils.entryKey(u)],e=n.utils.valueCompare(u,t.max),e<0||e===0&&it?b=f.end:(--g,b=f.start-1));var l=r._choices,a=[],v=[],y=[],nt;for(a.mapping={},p=ut;p<=rt;++p)h=o[p],w=n.utils.entryKey(h),l.mapping.hasOwnProperty(w)?delete l.mapping[w]:v.push(h),a.push(h),a.mapping[w]=h;r._choices=a;for(ot in l.mapping)y.push(l.mapping[ot]);return nt=!!(v.length||y.length),nt&&this.fillChangeSet.call(r,i,r._exclude?{added:y,removed:v}:{added:v,removed:y}),nt},i.prototype.changeStr=function(t,i){var r=this,b=r._type,k=r._column.dataType==="string",w=r._fieldValues,d=r._column.getEntriesMapping(),v,h=[],e=[],y=r._choices,c=[],o,l,s;if(c.mapping={},t||t===0)for(o=""+t,l=0;l<w.length;++l){var u=w[l],p=n.utils.entryKey(u),f=void 0,a=void 0;if(u!=null){s=k?u:""+u;switch(b){case 30:f=s.indexOf(o);a=!f;break;case 31:f=s.lastIndexOf(o);a=f===s.length-o.length;break;case 32:f=s.indexOf(o);a=f!==-1}}a?(c.push(u),c.mapping[p]=u,y.mapping.hasOwnProperty(p)||h.push(u)):y.mapping.hasOwnProperty(p)&&e.push(u)}else e=y.slice(0);return r._choices=c,v=!!(h.length||e.length),v&&this.fillChangeSet.call(r,i,r._exclude?{added:e,removed:h}:{added:h,removed:e}),v},i.prototype._init=function(t,i){var r=this;r.id=t.id;r._dataView=i;r._dataSet=i.getDataSet();r._column=r._dataSet.table.getColumn(t.field);r._type=t.type||10;r._exclude=!!t.exclude;r._field=t.field;r._fieldValues=r._column.getEntries();r._choices=r._fieldValues.slice(0);r._fieldValues.mapping={};r._choices.mapping={};r._fieldValues.forEach(function(t){var i=n.utils.entryKey(t);r._fieldValues.mapping[i]=t;r._choices.mapping[i]=t})},i.prototype.getColumnName=function(){return this._field},i.prototype.choiceChange=function(n){this._lastChoice=n;this.onChoiceChange.call(this,n)},i.prototype.checkActiveEntry=function(t,i){return t!==this._field?!0:!!(this._choices.mapping.hasOwnProperty(n.utils.entryKey(i))^this._exclude)},i.prototype._onChange=function(n){this.fire("change",{slicer:this,changes:n})},i}(n.EventBase);n.Slicer=y;yt=function(t){function i(n){var i=t.call(this)||this;return i._init(n),i}return __extends(i,t),i.prototype._init=function(n){this._dataSet=n;this._slicers=[];this._defaultMapping=n.getDefaultMapping();this._mapCache=n.getDefaultMapSet().slice(0);this._itemStates={}},i.prototype.getDataSet=function(){return this._dataSet},i.prototype.getMapping=function(){return this._mapping||this._defaultMapping},i.prototype.isEntryActive=function(n){return!this._mapCache[n]},i.prototype.addSlicer=function(t,i){var e,u;if(!t||!t.field)return null;var r=this,o=i||n.utils.getGuid("slicer"),f=r._slicers[o]=new y(t,this);if(r._slicers.push(f),f.id=o,e=!1,u=r._dataSet.table.getColumn(t.field),(!u||u.disable)&&(e=!0),!e&&r._itemStates&&!r._itemStates[t.field]){var s={},h=u.getOrderedIndexes(),c=u.getEntriesMapping(),l=u.getEntries();l.forEach(function(t){var f=s[n.utils.entryKey(t)]={activeCount:0,indexes:[],entryStates:[]},e=c[n.utils.entryKey(t)],i,u;if(e)for(i=e.start;i<=e.end;++i)u=h[i],f.indexes.push(u),(f.entryStates[u]=r.isEntryActive(u))&&++f.activeCount});r._itemStates[t.field]=s}f.on("change",function(n){r._onSlicerChange(n)});return f},i.prototype._onSlicerChange=function(t){var i=this,u,f;if(i._itemStates){var r=[],e=t.slicer,o=e.getColumnName(),s=function(n){n!==o&&r.push({field:n,states:i._itemStates[n],column:i._dataSet.table.getColumn(n),slicer:_.find(i._slicers,function(t){return t.getColumnName()===n})})};for(f in i._itemStates)s(f);u=function(t,i){for(var u=0;u<r.length;u++){var f=r[u],e=f.column,h=e.lookUps?e.lookUps[e[t]]:e[t],o=f.states[n.utils.entryKey(h)],s=i-(f.slicer.checkActiveEntry(f.field,h)?0:1)==0;s!=o.entryStates[t]&&(o.entryStates[t]=s,o.activeCount+=s?1:-1)}}}i._updateMapping(t.changes,u)},i.prototype._updateMapping=function(n,t){function f(n,i){n.forEach(function(n){r[n]+=i;t&&t(n,r[n])})}var r=this._mapCache,u,i,e;for(f(n.added,-1),f(n.removed,1),u=[],i=0,e=r.length;i<e;++i)r[i]||u.push(i);this._mapping=u;this._onMappingChange()},i.prototype._onMappingChange=function(){this._onChange(this._mapping)},i.prototype._onChange=function(n){this.fire("change",{mapping:n})},i.prototype.addPivot=function(){return this._pivot=new u(this),this._pivot},i}(n.EventBase);u=function(i){function r(n){var t=i.call(this)||this;return t._init(n),t}return __extends(r,i),r.getColumnsCache=function(t,i){var r={};return t&&t.dimensions.forEach(function(t){var u=i.getColumn(t),o=u.dataType==="datetime"||u.dataType==="date",f,e;f=o?function(n){return n==null?'\0':n.valueOf()}:n.utils.entryKey;e=u.lookUps.reduce(function(n,t,i){return n[f(t)]=i,n},{});u.lookUps.getPos=function(n){return e[f(n)]};r[t]=u}),r},r.prototype._init=function(n){var t=this;t._aggregateData=null;t._setting=new h;t._privateView=n;t._setting.onChanged=function(){t._aggregate.call(t)};t._setting.on(h.FilterAddedEvent,function(n){var i=t._privateView.addSlicer(n.data);n.slicer=i});t._aggregate()},r.prototype.getSetting=function(){return this._setting},r.prototype._getDummyColumn=function(){var n=this._cachedDummyColumn,t;if(!n){n=[];var r=this._privateView.getDataSet(),i=r.table,u=i[0]&&i[0].length;for(t=0;t<u;t++)n.push(t);this._cachedDummyColumn=n}return n},r.prototype._aggregate=function(){try{this._aggregateCore()}catch(n){}this.fire("change",{pivot:this});$(document).trigger("pivotChange",this)},r.prototype._aggregateCore=function(){var ii=this._privateView.getDataSet(),ri=ii.table,st,ui,vt,bt,s,at,kt,dt,ut,et,gt,di,e,ft,n,ni,ti;if(ii){this.isLargeNumber=!1;var y=this._setting.getDimensions(),ot=[],o=[];if(y.length)for(o=[],st=0;st<y.length;++st)ui=y[st],vt=ri.getColumn(ui),ot.push(vt),o.push(vt.lookUps.length);for(var yt=this._setting.getMeasures(),ht=this._setting.getTotalMeasures(),fi=this._privateView.getMapping(),gi=fi.length,h,f,i,p,w,b,k,d,g,nt,tt,it,pt,ei,oi,si,hi,ci,ai,vi,yi,pi,wi,r=new li,ct={},c=[],u=0,rt=0,l=0,a=0,bi={},ki,lt=o.length,wt=!1,u=0;u<yt.length;++u)s=yt[u],s.getAggregatorType()===t.NONE&&(wt=!0),at=s.getMetas(),i=s.getColumnName(),at.forEach(function(n){r[n+"_"+i]={}}),ct[i]||(ct[i]=!0,c.push(i));for(bt=0,ht&&(bt=ht.length),u=0;u<bt;++u)s=ht[u],s.getAggregatorType()===t.NONE&&(wt=!0),at=s.getMetas(),i=s.getColumnName(),at.forEach(function(n){r[n+"_"+i]={}}),ct[i]||(ct[i]=!0,c.push(i));for(wt&&(kt=this._getDummyColumn(),ot.push(kt),o.push(kt.length),lt=o.length),dt=[1],ut=0;ut<lt;++ut){if(ft=dt[ut]*o[ut],ft>Forguncy.BigNumber2.Safe_Max_Number){this.isLargeNumber=!0;break}dt.push(ft)}for(et=[new Forguncy.BigNumber2(1,this.isLargeNumber)],u=0;u<lt;++u)et.push(et[u].multipliedBy(o[u]));for(gt=[],rt=0,ki=c.length;rt<ki;++rt)if(i=c[rt],p=r[t.CNT+"_"+i],ei=p!==undefined,w=r[t.SUM+"_"+i],oi=w!==undefined,b=r[t.SSQ+"_"+i],si=b!==undefined,k=r[t.MIN+"_"+i],hi=k!==undefined,d=r[t.MAX+"_"+i],ci=d!==undefined,g=r[t.DST+"_"+i],ai=g!==undefined,nt=r[t.FIRST+"_"+i],vi=nt!==undefined,tt=r[t.LAST+"_"+i],yi=tt!==undefined,it=r[t.CUSTOM+"_"+i],pi=it!==undefined,pt=r[t.NONE+"_"+i],wi=pt!==undefined,h=ri.getColumn(i),di=!!h.lookUps,h)for(u=0;u<gi;++u){if(a=fi[u],e=void 0,rt)e=gt[u];else{for(e=new Forguncy.BigNumber2(0,this.isLargeNumber),l=0;l<lt;++l)if(ft=e.plus(et[l].multipliedBy(ot[l][a])),e=ot[l][a]<0?new Forguncy.BigNumber2(-1,this.isLargeNumber):ft,e.isEqualTo(-1))break;gt[u]=e;e.isGreaterThanOrEqualTo(0)&&(bi[e.toString()]=!0)}e.isLessThan(0)||(n=e.toString(),f=di?h.lookUps[h[a]]:h[a],f!=null&&(ei&&(p[n]===undefined&&(p[n]=0),p[n]+=1),oi&&(w[n]===undefined&&(w[n]=0),w[n]+=f),si&&(b[n]===undefined&&(b[a]=0),b[n]+=f*f),hi&&(k[n]===undefined||f<k[n])&&(k[n]=f),ci&&(d[n]===undefined||f>d[n])&&(d[n]=f),ai&&(g[n]===undefined&&(g[n]={}),g[n][f]=!0),vi&&(nt[n]===undefined&&(nt[n]=[]),nt[n].push({v:f,i:u})),yi&&(tt[n]===undefined&&(tt[n]=[]),tt[n].push({v:f,i:u})),pi&&(it[n]===undefined&&(it[n]=[]),it[n].push(f)),wi&&(pt[n]=f)))}r.vectors=bi;ni=new v;y.forEach(function(n){ni.push(n)});r.dimensions=ni;r.dimensions.$br=y.reduce(function(n,t,i){return n[t]=i,n},{});ti=new v;c.forEach(function(n){ti.push(n)});r.measures=ti;r.measures.$br=c.reduce(function(n,t,i){return n[t]=i,n},{});r.values=yt;r.totalValues=ht;r.dimSize=o;r.weights=et;this._aggregateData=r}},r.prototype.hasData=function(n){var r=this._aggregateData,t,e,i,u,f;if(!r||(t=this._setting.getAllValues(!1,n),t.length===0))return!1;for(e=function(n){var i=t[n],u=_.find(r.values,function(n){return n.getAggregatorType()===i.getAggregatorType()&&n.getColumnName()===i.getColumnName()});if(u&&Object.keys(r[u.getMetas()[0]+"_"+i.getColumnName()]||[]).length>0)return{value:!0}},i=0,u=t.length;i<u;i++)if(f=e(i,u),typeof f=="object")return f.value;return!1},r.prototype.getData=function(n,i){var u,s,r,h;if(n===18)return i||(i=new tt),u=new ai(this,n,i),u.buildPivotSheetData();if(n===16){var c=this._setting._values[0][0].getColumnName(),l=t.NONE+"_"+c,f=this._aggregateData[l],e=[],o={};for(s in f)r=f[s],o[r]||(e.push(r),o[r]=!0);return e}return h=new d(this,n),h.buildChartData()},r.prototype.getDataset=function(){return this._privateView.getDataSet()},r}(n.EventBase);n.Pivot=u;h=function(t){function i(){var i=t.call(this)||this;return i._rowDimensions=[],i._columnDimensions=[],i._values=[],i.id=n.utils.getGuid("pivot"),i.onChanged=null,i}return __extends(i,t),i.getRealColumnNames=function(n){var t=[];return n instanceof Array&&n.forEach(function(n){if(n)if(n.method)t.push(n.name);else if(n.type==="hierarchy")for(var i=0,r=n.activePath.length;i<=r;i++)t.push(n.subDims[i].name);else if(n.name)t.push(n.name);else if(typeof n=="string")t.push(n);else throw"PivotSetting: this is not a good column object.";}),t},i.getRevisedItems=function(n,t){return _.reduce(n,function(n,i){if(i.type==="hierarchy"){var u=_.cloneDeep(i),r=u.activePath,f=u.subDims;_.eachRight(i.subDims,function(n,t){r.length>t&&r.splice(t,1);f.splice(t,1);f.length===r.length&&r.length>0&&(r.length=r.length-1)});f.length===0||(n[n.length]=t?u:u.name)}else n[n.length]=t?i:i.name;return n},[])},i.prototype.addFilter=function(n){var t=this;n.forEach(function(n){var u=$.extend({},n),f={data:u,slicer:null},r;t.fire(i.FilterAddedEvent,f);r=f.slicer;r||console.debug("addFilter() should be called after event binding.");r.choiceChange(u.choice)});this._trigger("change")},i.prototype.getRows=function(n){return i.getRevisedItems(this._rowDimensions,n)},i.prototype.getColumns=function(n){return i.getRevisedItems(this._columnDimensions,n)},i.prototype._updateValue=function(n){for(var r=this,u=function(t){var i=n[t];i.forEach(function(n,t){i[t]=n.valueType===2?new ki(r,n):new f(n)})},t=0,i=n.length;t<i;t++)u(t,i);this._values=n},i.prototype.getValues=function(n){return this._values.map(function(t){for(var r,f,u=[],i=0,o=t.length;i<o;i++)(r=t[i],f=r instanceof e,n||!f)&&u.push(r);return u})},i.prototype.getAllValues=function(n,t){var r=_.flatten(this._values),i=[];return _.each(r,function(n){var r,u;(t||!n.invalid)&&(n instanceof e?(r=n.getMeasure(),i[i.length]=new f(r)):(u=n,i[i.length]=u))}),_.uniq(i,function(t){return n?t.getId():t.getName()})},i.prototype.getDimensions=function(n,t){function u(n,t){t&&t.forEach(function(t){if(t.type==="hierarchy"){var i=t.subDims.slice(0);i.length=t.activePath.length+1;u(n,i)}else n[t.name]=!0})}function e(n){var t=[];for(var i in n)t.push(i);return t}function f(n,t){t&&t.forEach(function(t){if(t.type==="hierarchy"){var i=t.subDims.slice(0);f(n,i)}else n.push(new a(t.name,t.display))})}var i,r;return n?(i=[],f(i,this.getRows(!0,t)),f(i,this.getColumns(!0,t)),i):(r={},u(r,this.getRows(!0,t)),u(r,this.getColumns(!0,t)),e(r))},i.prototype.getMeasures=function(){var n=this.getAllValues();return n.map(function(n){var t;switch(n.getAggregatorType()){case"sum":t=new gt(n);break;case"cnt":t=new ni(n);break;case"max":t=new ti(n);break;case"min":t=new ii(n);break;case"avg":t=new ri(n);break;case"dst":t=new ui(n);break;case"first":t=new fi(n);break;case"last":t=new ei(n);break;case"custom":t=new oi(n);break;case"none":t=new si(n)}return t})},i.prototype.getTotalMeasures=function(){var n=this.getAllValues();return n.map(function(n){var t;switch(n.getTotalAggregatorType()){case"sum":t=new gt(n);break;case"cnt":t=new ni(n);break;case"max":t=new ti(n);break;case"min":t=new ii(n);break;case"avg":t=new ri(n);break;case"dst":t=new ui(n);break;case"first":t=new fi(n);break;case"last":t=new ei(n);break;case"custom":t=new oi(n);break;case"none":t=new si(n)}return t})},i.prototype.getSchema=function(n,t,r){var u=[];return t||u.push("%%"),n===1&&i.getRealColumnNames(this.getRows(!1,r)).forEach(function(n){u.push(n)}),t||u.push("%%"),n===2&&i.getRealColumnNames(this.getColumns(!1,r)).forEach(function(n){u.push(n)}),t||u.push("%%"),n===4&&this.getValues(!1).forEach(function(n){i.getRealColumnNames(n).forEach(function(n){u.push(n)})}),t||u.push("%%"),n===32,u},i.prototype.setSortInfo=function(n){this._sortInfo=n;this._trigger("change")},i.prototype.getSortInfo=function(t){function f(n){return n?n.method+"$"+n.name+"$"+n.idx:""}function h(n){for(var i=!1,t=0;t<3;t++)if(n[t]instanceof Date){i=!0;break}return i}var e;if(!this._sortInfo)return e;var i=t,o=this.getAllValues(!0,i),s=o.reduce(function(n,t){return n[f(t.toJSON(i))]=!0,n},{}),r={},u=this._sortInfo;return this.getDimensions(!1,i).forEach(function(i){var e=u[i],o;e&&(t&&e.manual&&h(e.manual)&&(e.manual=e.manual.map(function(t){return t==null?null:n.utils.datetimeToJSON(t)})),e.type!==4||(o=f(e.sortBy.measure),s[o]))&&(r[i]=u[i])}),r},i.prototype.update=function(n){n.rows&&(this._rowDimensions=n.rows);n.columns&&(this._columnDimensions=n.columns);n.values&&this._updateValue(n.values);this._trigger("change")},i.prototype._trigger=function(n){switch(n){case"change":typeof this.onChanged=="function"&&this.onChanged();this.fire("change")}},i.FilterAddedEvent="filteradded",i}(n.EventBase);n.PivotSetting=h;var pt=function(){function n(n,t){this.formatterCache={};this.scenarioType=t;this.pivot=n;this.setting=n._setting;this.vp=new kt(n);var i=n._setting.getSortInfo();this.sortManager=new bi(n,i);this.columns=u.getColumnsCache(n._aggregateData,n._privateView.getDataSet().table)}return Object.defineProperty(n.prototype,"table",{get:function(){return this.pivot._privateView.getDataSet().table},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"series",{get:function(){return this.setting.getSchema(2,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"axes",{get:function(){return this.setting.getSchema(1,!0)},enumerable:!1,configurable:!0}),n.prototype.mergeAllVectors=function(){var n=$.extend({},this.pivot._aggregateData.vectors);return new nt(Object.keys(n))},n.prototype.buildAllValues=function(n){var t=this,i=[],r=this.setting.getValues(!0);return r.forEach(function(r,u){r.length>0?r.forEach(function(r){if(r.getValueType()===1)t.pivot._aggregateData.values.filter(function(n){return r.isMatchAggregator(n)}).forEach(function(n){i.push(new p(n,r))});else{var u=r;u.update();i.push(new p(u.getAggregator(n,t.vp,t.sortManager,t.pivot.isLargeNumber),u))}}):i[u]=undefined}),i},n.prototype.buildAllTotalValues=function(){var t=this,n=[],i=this.setting.getValues(!0);return i.forEach(function(i,r){i.length>0?i.forEach(function(i){i.getValueType()===1&&t.pivot._aggregateData.totalValues.filter(function(n){return i.isMatchTotalAggregator(n)}).forEach(function(t){n.push(new p(t,i))})}):n[r]=undefined}),n},n}(),p=function(){function n(n,t){this.aggregator=n;this.value=t}return n}(),ai=function(t){function u(n,i,r){var u=t.call(this,n,i)||this;return u.startIndex=0,u.subtotalMapping={},u.option=r,u}return __extends(u,t),u.prototype.buildPivotSheetData=function(){var v=this;if(!this.pivot||!this.pivot._aggregateData)return null;var n=this.mergeAllVectors(),f=this.buildAllValues(n),y=this.buildAllTotalValues(n),r=f.filter(function(n){return!!n}),e=this.series,t=this.axes,p=e.concat(t),i=r.length>1||t.length===0,o=this.buildHeader(n,e,"rowHeader"),u=this.buildHeader(n,t,"colHeader");this.addValueHeaderTo(u,r,1,t.length);var s=this.generateHeaderMapping(o),h=this.generateHeaderMapping(u,i),w=this.vp.getPartitionedVectors(n,p),b=e.length,k=t.length,c=this.transformRowHeader(o,b),l=this.transformColHeader(u,k,i),a=this.generateData(s,h,w,i,r);return this.addSubtotalToData(a,s,h,o.subtotal,u.subtotal,c,l,y,i),{data:{data:a,rowHeader:c,colHeader:l},valueIdentifications:f.map(function(n){return n?n.value.getId():n}),schema:{tableRowLevel:this.series.length,tableColLevel:this.axes.length,valueLevel:i?1:0,measureLength:r.length,rowDim:this.setting.getColumns(!0,!0),colDim:this.setting.getRows(!0,!0)},valueFormats:f.map(function(n){var t;if((t=n===null||n===void 0?void 0:n.value)!==null&&t!==void 0)return t.getFormat(v.table)})}},u.prototype.generateData=function(n,t,u,f,e){var o=this,h=this.series,s=h.length;return u.reduce(function(u,h){var a=h.path.slice(0,s),c=h.path.slice(s),v=""+a,l=n[v];return u[l]||(u[l]=[]),e.forEach(function(n,e){var y=n.aggregator,p=n.value,s=new r,w=h[0],b=""+(f?c.concat(e):c),d=t[b],k;s.rowPath=a;s.colPath=c;s.rowStr=v;s.colStr=b;s.vector=w;s.aggratator=y;s.pivotValue=p;s.displayName=p.getDisplay();s.format=p.getFormat(o.table);y instanceof i?(k=p.getId(),s.value=y.getValue(y.getMetaValue(o.pivot._aggregateData,w,k))):s.value=y.getValue(w);u[l][d]=s}),u},[])},u.prototype.addSubtotalToData=function(n,t,i,r,u,f,e,o,s){var h=this,c;f.map(function(n){var t=_.filter(n,function(n){return n.type===32||n.type===64})[0];return t?t:_.last(n)}).forEach(function(r){var c;if(r){var e=r.path,l=e+"",f=t[r.path],a=function(t){var c=u[t];o&&o.forEach(function(t,u){var y=t.aggregator,a=t.value,p=s?c.path.concat(u):c.path,w=p+"",b=i[w],o,v;n[f]||(n[f]=[]);o={};v=h.intersection(r.vectors,c.vectors);o.type=r.type?r.type===64?64:32:undefined;o.rowPath=e;o.colPath=p;o.rowStr=l;o.colStr=w;o.vector=v;o.aggratator=y;o.pivotValue=a;o.displayName=a.getDisplay();o.format=a.getFormat(h.table);v.length>0&&(o.value=h.getValue(y,v,a));n[f][b]=o})};for(c in u)a(c)}});c=_.last(e);c&&c.forEach(function(u,f){var e,a,c,l;if(u&&u.type)for(e=0;e<n.length;e++)a=n[e],n[e][f]&&(n[e][f].type=u.type);c=function(f){var c=r[f],l=c.path,a=l+"",e=t[a];o&&o.forEach(function(t,r){var p=t.aggregator,o=t.value,f,y;if(!s||u.path[u.path.length-1]===r){var w=u.path,b=w+"",v=i[b];n[e]||(n[e]=[]);f={};y=h.intersection(c.vectors,u.vectors);f.type=c.type===64?64:32;f.rowPath=l;f.colPath=w;f.rowStr=a;f.colStr=b;f.vector=y;f.aggratator=p;f.pivotValue=o;f.displayName=o.getDisplay();f.format=o.getFormat(h.table);y.length>0&&(f.value=h.getValue(p,y,o));n[e][v]?n[e][v].type=n[e][v].type|f.type:n[e][v]=f}})};for(l in r)c(l)})},u.prototype.getValue=function(n,t,r){var f=this.pivot._aggregateData,u;return n instanceof i?(u=t.reduce(function(t,i){var u=n.getMetaValue(f,i,r.getId());return n.mergeMetaValues(u,t),u},{}),n.getValue(u)):t.reduce(function(t,i){return t+n.getValue(i)},0)},u.prototype.intersection=function(n,t){for(var r,u,e,f={},i=0,o=n.length;i<o;i++)f[n[i]]=!0;for(r=[],i=0,e=t.length;i<e;i++)u=t[i],f[u]&&r.push(u);return r},u.prototype.transformRowHeader=function(n,t){return this.header=[],this.transformRowHeaderTree(n,[],t),this.header},u.prototype.transformRowHeaderTree=function(n,t,i){var s=this,f,e,u,o;if(n.length===0){if(f=[],n.type===32)for(e=0;e<i;e++)u=new r,e===t.length-1&&(u.format=n.format,u.level=t.length+1-1,u.path=n.path,u.value=n.key,u.backgroundValue=n.backgroundValue,u.type=n.type,u.display=n.display,u.vectors=n.vectors),f.push(u);else u=new r,u.format=n.format,u.level=t.length+1,u.path=n.path,u.value=n.key,u.backgroundValue=n.backgroundValue,u.type=n.type,f=t.concat(u),u.vectors=n.vectors,o=!0,f=f.reverse().map(function(n){return o=o&&n.visible,o?n:{}}).reverse();this.header.push(f)}else n instanceof Array&&n.forEach(function(u,f){var o=t,e;n.key!==undefined&&(e=new r,e.format=n.format,e.level=t.length+1,e.value=n.key,e.backgroundValue=n.backgroundValue,e.visible=s.option.headerText===1?!0:f===0,o=t.concat(e));s.transformRowHeaderTree(u,o,i)})},u.prototype.transformColHeader=function(n,t,i){return this.header=[],this.transformColHeaderTree(n,[],0,t,i),this.header},u.prototype.transformColHeaderTree=function(n,t,i,u,f,e,o){var v=this,l,a,s,y,h;if(n.length===0){var p=n.index,w=f?n.path.concat(n.valueId):n.path,b=f?u+1:u,c=new r;for(c.format=n.format,c.path=n.path,c.value=n.key,c.type=n.type,c.display=n.display,c.vectors=n.vectors,c.backgroundValue=n.backgroundValue,t.push(c),l=!0,a=void 0,s=b-1;s>=0;s--)t[s]&&(l=l&&t[s].visible,a=l?t[s].value:undefined),this.header[s]||(this.header[s]=[]),y=this.header[s],h=new r,h.format=t[s]&&t[s].format,h.path=w,h.value=a,h.backgroundValue=t[s]&&t[s].backgroundValue,h.type=n.type,h.display=t[s]?t[s].display:undefined,h.level=s+1,h.displayName=n.displayName,h.vectors=n.vectors,h.aggregator=n.aggregator,(e===32&&h.level>=o||e===64)&&(h.level=o,h.type=e),y[p]=h}else n instanceof Array&&n.forEach(function(s,h){var l=t.slice(0),a=i+1,c;n.key!==undefined&&(c=new r,c.format=n.format,c.value=n.key,c.visible=v.option.headerText===1?!0:h===0,c.display=n.display,c.backgroundValue=n.backgroundValue,l=t.concat(c));e===undefined&&(n.type===32&&(e=n.type,o=i-1),n.type===64&&(e=n.type,o=1));v.transformColHeaderTree(s,l,a,u,f,e,o)})},u.prototype.generateHeaderMapping=function(n,t){return this.mapping={},this.generateHeaderMappingTree(n,t),this.mapping},u.prototype.generateHeaderMappingTree=function(n,t){var r=this,i;n.length===0?(i=t?n.path.concat(n.valueId):n.path,this.mapping[i.toString()]=n.index):n instanceof Array&&n.forEach(function(n){r.generateHeaderMappingTree(n,t)})},u.prototype.getColumnFormatter=function(t){var i=this.table.getColumn(t);return n.utils.getFormatter(i)},u.prototype.getColumnValue=function(t,i){if(n.utils.isEmpty(i))return i;var u=this.table.getColumn(t),r=i;if(u.type==="subDate")switch(u.subDatePart){case"quarter":r=n.SR["datetime_quarter_q"+i];break;case"month":r=n.SR["datetime_month_m"+i];break;default:r=i}return r},u.prototype.buildHeader=function(n,t,i){this.startIndex=0;this.subtotalMapping={};var r=this.buildHeaderTree(n,t,i,0,[]);return r.subtotal=this.subtotalMapping,r},u.prototype.buildHeaderTree=function(t,i,r,u,f){var a=this,h,s,l,e;if(u===i.length)return h=new w,h.path=f,h.vectors=t,h.index=this.startIndex++,h;var c=new w,o=i[u],k=this.sortManager.getCmpFunc(o),d=this.columns[o].lookUps.getPos,y=this.vp.filteredLookUps(o,t),g=this.columns[o].backgroundLookUps,p=this.pivot._aggregateData.dimensions.$br[o],nt=this.pivot._aggregateData.weights[p+1],tt=this.pivot._aggregateData.weights[p],v={},b={};if(t.forEach(function(n){var t=new Forguncy.BigNumber2(n,a.pivot.isLargeNumber),i=t.mod(nt).dividedBy(tt).toFormat(),r=v[i]||[];r.push(n);v[i]=r;b[t.toString()]=!0}),y.sort(k).forEach(function(n,t){var s=d(n),h=v[s],e;h&&h.length&&(e=a.buildHeaderTree(h,i,r,u+1,f.concat(s)),e.key=a.getColumnValue(o,n),e.format=a.getColumnFormatter(o),e.backgroundValue=g[s],c[t]=e,c.path=f)}),c.length=y.length,s=!1,l=u===0,l){if(r==="colHeader")switch(this.option.grandTotals){case 3:case 1:s=!0}else if(r==="rowHeader")switch(this.option.grandTotals){case 4:case 1:s=!0}}else this.option.subtotals!==1&&(s=!0);return e=[],e.path=f,e.vectors=t,e.index=this.startIndex,e.type=l?64:32,e.level=u,e.display=!0,e.key=l?n.SR.spread_pivot_table_grand_total:n.SR.spread_pivot_table_subtotal,s||(e.display=!1),(!l||s)&&(this.subtotalMapping[f.toString()]={vectors:t,vectorMap:b,index:this.startIndex,path:f,type:e.type},c.push(e),this.startIndex++),c},u.prototype.addValueHeaderTo=function(n,t){this.addValueHeaderToTree(t,n,0)},u.prototype.addValueHeaderToTree=function(n,t){var i=this;t.length===0?n&&n.forEach(function(i,r){var u=new w,e=i.aggregator,f=i.value;u.displayName=f.getDisplay();u.key=f.getDisplay();u.path=t.path;u.vectors=t.vectors;u.valueId=r;u.index=t.index*n.length+r;u.aggregator=e;t.push(u)}):t instanceof Array&&t.forEach(function(t){i.addValueHeaderToTree(n,t)})},u}(pt),nr=function(){function n(){}return n}(),w=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(Array),wt=function(){function n(){}return n}();n.SeriesListItem=wt;c=function(n){function t(t){var i=n.call(this)||this,r,u;if(t)for(r=!1;!r;)u=t.splice(0,1e4),i.push.apply(i,u),u.length<1e4&&(r=!0);return i}return __extends(t,n),t}(Array);b=function(){function n(){}return n}();n.PivotChartOption=b;k=function(){function n(){}return n}();n.PivotChartSchemaOption=k;d=function(t){function r(){var n=t!==null&&t.apply(this,arguments)||this;return n.seriesVectsCache={},n.axisLookUpsCache={},n}return __extends(r,t),Object.defineProperty(r.prototype,"series",{get:function(){return this.setting.getSchema(1,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"axes",{get:function(){return this.setting.getSchema(2,!0)},enumerable:!1,configurable:!0}),r.prototype.buildChartData=function(){var i=this.mergeAllVectors(),r=this.buildAllValues(i),n,t;return this.sortedSeriesKeyArray=this.buildSeriesList(i,r,this.sortManager),n=new b,n.data=this.buildTrellis(i,r,0,[]),t=new k,t.values=this.setting.getValues(!0),t.series=this.series.slice(0),t.axes=this.axes.slice(0),n.shema=t,n.series=this.sortedSeriesKeyArray,n},Object.defineProperty(r.prototype,"isScatterValues",{get:function(){return this.scenarioType===23||this.scenarioType===24},enumerable:!1,configurable:!0}),r.prototype.buildSeriesList=function(n,t,i){var r=this,f,u,s;if(this.series.length===0)return f=new c(t.map(function(n){return[r.toValueObj(n)]})),this.bindBackReference(f);var h=this.series.length,e=this.series.map(function(n){return i.getPosCmpFunc(n)}),l=this.vp.getPartitionedVectors(n,this.series).filter(function(n){return n.length>0}).sort(function(n,t){for(var r,i=0;i<h;){if(r=e[i]&&e[i](n.path[i],t.path[i]),r!==0)return r;i++}return r}),o=new c(l.map(function(n){return n.path.map(function(n,t){return r.columns[r.series[t]].lookUps[n]})}));return t.length<2?this.bindBackReference(o):(u=[],o.forEach(function(n){r.isScatterValues?u.push(n):t.forEach(function(t){u.push(n.concat(r.toValueObj(t)))})}),s=new c(u),this.bindBackReference(s))},r.prototype.toValueObj=function(n){var t=null;return n!==null&&(t=new wt,t.display=n.value.getDisplay(),t.name=n.value.getName(),t.idx=n.value.getIndex(),t.id=n.value.getId()),t},r.prototype.bindBackReference=function(n){var t=this;if(!n)throw"getData error.";return n.$br=n.reduce(function(n,i,r){var u=t.getSeriesAndValueArrayHashkey(i);return n[u]=r,n},{}),n},r.prototype.buildTrellis=function(n,t,i,r){return this.buildCellData(n,i+1,t,r)},r.prototype.buildCellData=function(n,t,i,r){var u=this.getAxisLookUps(r,n),e=this.buildSeriesVectsList(n,i),o=this.buildSeriesValues(e,u),f=new vi(o);return f.axes=u,f},r.prototype.buildSeriesVectsList=function(n,t){var i=this,f=this.pivot._aggregateData,s;n.forEach(function(n){var t=i.series.reduce(function(t,r){var u=f.dimensions.$br[r],e=new Forguncy.BigNumber2(n,i.pivot.isLargeNumber).mod(f.weights[u+1]).dividedBy(f.weights[u]).toFormat();return t.key+="d"+u+"r"+e,t.entries.push(i.columns[r].lookUps[e]),t},new pi);i.seriesVectsCache.hasOwnProperty(t.key)||(i.seriesVectsCache[t.key]=new yi,i.seriesVectsCache[t.key].vectors=[],i.seriesVectsCache[t.key].entries=t.entries);i.seriesVectsCache[t.key].vectors.push(n)});var r=[],e=t.length,u=0,h=function(n){var h=o.seriesVectsCache[n],s,f;e>1||n===""?o.isScatterValues?(f=new g,f.vectors=h.vectors,f.entryKey=h.entries,s=r[u]=f,t.forEach(function(n){n?(s.valueFormats.push(n.value.getFormat(i.table)),s.values.push(n.value),s.aggregators.push(n.aggregator)):(s.valueFormats.push(undefined),s.values.push(undefined),s.aggregators.push(undefined))})):t.forEach(function(n,t){if(n){var f=new g;f.vectors=h.vectors;f.valueFormats.push(undefined);f.valueFormats.push(n.value.getFormat(i.table));f.values.push(undefined);f.values.push(n.value);f.aggregators.push(undefined);f.aggregators.push(n.aggregator);f.entryKey=h.entries.concat({display:n.value.getDisplay(),name:n.value.getName(),idx:n.value.getIndex()});r[t+u*e]=f}else r[t+u*e]=undefined}):(f=new g,f.vectors=h.vectors,f.valueFormats.push(undefined),f.valueFormats.push(t[0].value.getFormat(o.table)),f.values.push(undefined),f.values.push(t[0].value),f.aggregators.push(undefined),f.aggregators.push(t[0].aggregator),f.entryKey=h.entries,r[u]=f);u++},o=this;for(s in this.seriesVectsCache)h(s);return r},r.prototype.buildSeriesValues=function(n,t){var i=this,r=this.pivot._aggregateData;return n.map(function(n){if(n){var f=n.vectors.map(function(u){var e=i.axes.map(function(n){var t=r.dimensions.$br[n],f=new Forguncy.BigNumber2(u,i.pivot.isLargeNumber).mod(r.weights[t+1]).dividedBy(r.weights[t]).toFormat();return i.columns[n].lookUps[f]}),f=new bt;return f.id=u,f.axis=e,f.axisId=t.getIndexById(u),n.aggregators[0]&&(f.x=i.getValue(n.aggregators[0],n.values[0],u)),n.aggregators[1]&&(f.y=i.getValue(n.aggregators[1],n.values[1],u)),n.aggregators[2]&&(f.z=i.getValue(n.aggregators[2],n.values[2],u)),f}),e=i.getSeriesAndValueArrayHashkey(n.entryKey),u=new l;return u.id=i.sortedSeriesKeyArray.$br[e],u.values=f,u.key=n.entryKey,u.valueFormats=n.valueFormats,u}return new l})},r.prototype.getValue=function(t,r,u){var f,e;return t instanceof i?(f=t.getValue(t.getMetaValue(this.pivot._aggregateData,u,r.getId())),n.utils.getRoundedFloatingNumber(f)):(e=t,f=e.getValue(u),n.utils.getRoundedFloatingNumber(f))},r.prototype.getAxisLookUps=function(n,t){var i=this,r,u,f;return this.axes.length===0?(r=[[]],r.getIndexById=function(){return 0},r):(n=[],u=n.reduce(function(n,t){return n+t},"p"),this.axisLookUpsCache[u]||(f=this.vp.getPartitionedVectors(t,[]),f.forEach(function(n){var f=n.path.reduce(function(n,t){return n+t},"p"),t=0,e=i.vp.getPartitionedVectors(n,i.axes.slice(t,t+1)),r={index:0},u=i.buildSortedAxis(e,t,r);u.getIndexById=function(n){return r[n]};i.axisLookUpsCache[f]=u})),this.axisLookUpsCache[u])},r.prototype.buildSortedAxis=function(n,t,i){var r=this,u=[],f=0,e={},o=this.sortManager.getPosCmpFunc(this.axes[t]),s=n.map(function(n){var t=n.path[0];return e[t]=n,t}),h=o==null?s.sort():s.sort(o);return t<this.axes.length?h.forEach(function(n){var c=e[n],s=t+1,l=r.vp.getPartitionedVectors(c,r.axes.slice(s,s+1)),a=i.index,o=r.buildSortedAxis(l,s,i),h;o.count>0&&(h=c.path[0],o.key=r.columns[r.axes[t]].lookUps[h],o.entryPos=h,o.axisId=a,u.push(o));f+=o.count}):(n.reduce(function(n,t){return t.forEach(function(t){n.push(t);i[t]=i.index}),f++,n},u),i.index++),u.count=f,u},r.prototype.getSeriesAndValueArrayHashkey=function(n){if(!n)return"";var t="\x1d,\x1d",i="\x1d_\x1d";return n.reduce(function(n,r){var u;return u=r==null?'\0':r.display?[r.idx,r.name].join(i):r.valueOf(),n+t+u},"")},r}(pt);n.PivotChartDataBuilder=d;bt=function(){function n(){}return n}();l=function(){function n(){}return n}();n.SeriesList=l;var vi=function(n){function t(t){for(var i=n.call(this)||this,u=!1,r;!u;)r=t.splice(0,1e4),i.push.apply(i,r),r.length<1e4&&(u=!0);return i}return __extends(t,n),t}(Array),yi=function(){function n(){}return n}(),g=function(){function n(){this.valueFormats=[];this.values=[];this.aggregators=[]}return n}(),pi=function(){function n(){this.key="";this.entries=[]}return n}(),tr=function(){function n(){this.index=0}return n}(),wi=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.getIndexById=function(){return 0},t}return __extends(t,n),t}(Array);n.SortedAxisList=wi;var kt=function(){function n(n){this._pivot=n;this._pivotSetting=n.getSetting();var t=this._pivot._aggregateData,i=this._pivot._privateView.getDataSet().table;this._columns=u.getColumnsCache(t,i);this._aggregated=t}return n.prototype.getVectors=function(){return Object.keys($.extend({},this._aggregated.vectors))},n.prototype.getValue=function(n,t,i){return n.getValue(n.getMetaValue(this._aggregated,t,i))},n.prototype.getPartitionedVectors=function(n,t){var s=this,u=this._aggregated,i=[],e=new nt(n.slice(0)),o,r,f;for(e.path=[],i.push(e),o=function(n){for(var h=[],c=u.dimensions.$br[t[n]],l=u.weights[c+1],a=u.weights[c],r,f,e,o;i.length>0;){r=i.shift();f=r.reduce(function(n,t){var i=new Forguncy.BigNumber2(t,s._pivot.isLargeNumber).mod(l).dividedBy(a).toFormat();return(n[i]=n[i]||[]).push(t),n},{});for(e in f)o=new nt(f[e]),o.path=r.path.concat(parseInt(e,10)),h.push(o)}i=h},r=0,f=t.length;r<f;r++)o(r,f);return i},n.prototype.getWeight=function(n){var t=this._aggregated,i=t.dimensions.$br[n];return{ceil:t.weights[i+1],floor:t.weights[i]}},n.prototype.getMeasureAggregator=function(n){return this._aggregated.values.filter(function(t){return t.getColumnName()===n.name&&t.getAggregatorType()===n.method})[0]},n.prototype.buildWeightsByDimension=function(n,t,i){var h=this,f=[],r=this._aggregated,c=this.getVectors(),e=r.dimensions.$br[n],l=r.weights[e+1],a=r.weights[e],v=this._columns[n]&&this._columns[n].lookUps,u={},o,s;c.forEach(function(n){var t=new Forguncy.BigNumber2(n,h._pivot.isLargeNumber).mod(l).dividedBy(a).toFormat(),i=u[t]||[];i.push(n);u[t]=i});o=function(n){var e={},s=v[n],o=u[n];o.forEach(function(n){var u=t.getMetaValue(r,n,i);t.mergeMetaValues(u,e);e=u});f.push({entry:s,value:t.getValue(e),subVectors:o,pos:n})};for(s in u)o(s);return f},n.prototype.filteredLookUps=function(n,t){var o=this,r=this._columns[n].lookUps,u=this._aggregated.dimensions.$br[n],s=this._aggregated.weights[u+1],h=this._aggregated.weights[u],f,i,e;if(r){f=t.reduce(function(n,t){var i=new Forguncy.BigNumber2(t,o._pivot.isLargeNumber).mod(s).dividedBy(h).toFormat();return n[i]=!0,n},{});i=[];for(e in f)i.push(r[e]);return i.$br=r.$br,i}return[]},n.prototype._getValueId=function(n,t){var r=n.getSetting(),u,i;return r&&(u=r.getAllValues(!0),i=_.find(u,function(n){return n.getColumnName()===t.name&&n.getAggregatorType()===t.method&&n.getIndex()===t.idx}),i)?i.getId():null},n}(),nt=function(n){function t(t){for(var i=n.call(this)||this,u=!1,r;!u;)r=t.splice(0,1e4),i.push.apply(i,r),r.length<1e4&&(u=!0);return i}return __extends(t,n),t}(Array),dt=function(t){function i(n,i,r){var u,f=t.call(this,n)||this;return f._cultureMap=(u={},u.cn="zh-CN",u.en="en-US",u.ja="ja-JP",u.kr="ko-KR",u),f._dimName=i,f.fromJSON(r),f}return __extends(i,t),i.decendingCmpFunc=function(t,i){return n.utils.valueCompare(i,t)},i.prototype._init=function(){this.type=2;this.order=1;this.manual=[];var n=this._columns[this._dimName];this._useBareValue=n.dataType==="datetime"||n.dataType==="date"?!0:!1},i.prototype.setType=function(n){this.type=n},i.prototype.getType=function(){return this.type},i.prototype.setOrder=function(n){this.order=n},i.prototype.getOrder=function(){return this.order},i.prototype.setManual=function(n){this.manual=n},i.prototype.getManual=function(){return this.manual},i.prototype._getDataSourceCmpFunc=function(){var t=this._columns[this._dimName],n=t.getSortInfo();this._dataSourceCmpFunc=n&&n.func?n.func:this._getCmpFuncByManaualArray(t.lookUps)},i.prototype._getNumericalCmpFunc=function(){this._numericalCmpFunc=this.order===1?i.ascendingCmpFunc:i.decendingCmpFunc},i.prototype._getChronologicalCmpFunc=function(){this._chronologicalCmpFunc=this.order===1?i.ascendingCmpFunc:i.decendingCmpFunc},i.prototype._getAlphabeticCmpFunc=function(){var t,n,r;try{t=Intl}catch(u){}t&&t.Collator?(n=this._cultureMap[Forguncy.RS.Culture],(this._isEmpty(n)||n==="ja-JP")&&(n="en-US"),r=new Intl.Collator(n),this._alphabeticCmpFunc=this.order===1?function(n,t){return typeof n=="string"&&typeof t=="string"?r.compare(n,t):i.ascendingCmpFunc(n,t)}:function(n,t){return typeof n=="string"&&typeof t=="string"?r.compare(t,n):i.decendingCmpFunc(n,t)}):this._alphabeticCmpFunc=this.order===1?i.ascendingCmpFunc:i.decendingCmpFunc},i.prototype._getCmpFuncByManaualArray=function(t){if(!t||t.length===0)return n.utils.valueCompare;var i={},r=this._useBareValue;return t.forEach(function(t,u){var f=r?n.utils.entryKey(t).valueOf():n.utils.entryKey(t);i[f]=u}),r?function(t,r){var u=n.utils.entryKey(t).valueOf(),f=n.utils.entryKey(r).valueOf();return i.hasOwnProperty(u)?i.hasOwnProperty(f)?i[u]-i[f]:-1:1}:function(t,r){var u=n.utils.entryKey(t),f=n.utils.entryKey(r);return i.hasOwnProperty(u)?i.hasOwnProperty(f)?i[u]-i[f]:-1:1}},i.prototype._getManualCmpFunc=function(){var t=this._useBareValue?this.manual.map(function(t){return t instanceof Date?t:n.utils.datetimeFromJSON(t)}):this.manual;this._manualCmpFunc=this._getCmpFuncByManaualArray(t)},i.prototype._getValueCmpFunc=function(){function i(n,t){return n>=t&&n<=t?0:n>t?1:n<t?-1:n==null?-1:1}var n,r=this.sortBy.measure.name,u=this.sortBy.measure.method,f=this._aggregated.values.filter(function(n){return n.getColumnName()===r&&n.getAggregatorType()===u})[0],e=this._getValueId(this._pivot,this.sortBy.measure),t=this.buildWeightsByDimension(this._dimName,f,e);n=this.order===1?t.sort(function(n,t){return i(n.value,t.value)}).map(function(n){return n.entry}):t.sort(function(n,t){return i(t.value,n.value)}).map(function(n){return n.entry});this._valueCmpFunc=this._getCmpFuncByManaualArray(n)},i.prototype.getCmpFunc=function(){var t,n;switch(this.type){case 4:return this._valueCmpFunc;case 3:return this._manualCmpFunc;case 2:t=this._columns[this._dimName];switch(t.dataType){case"number":return this._numericalCmpFunc;case"date":case"datetime":return this._chronologicalCmpFunc;case"string":default:return this._alphabeticCmpFunc}case 1:return this._dataSourceCmpFunc;default:return n=this._columns[this._dimName].getSortInfo(),n&&n.func?n.func:this._alphabeticCmpFunc}},i.prototype.getPosCmpFunc=function(){var t=this._columns[this._dimName].lookUps,n={};return t.slice(0).sort(this.getCmpFunc()).forEach(function(i,r){n[t.getPos(i)]=r}),function(t,i){return t instanceof Forguncy.BigNumber2&&i instanceof Forguncy.BigNumber2?n[t.toString()]-n[i.toString()]:n[t]-n[i]}},i.prototype.toJSON=function(){return{type:this.type,order:this.order,manual:this.manual}},i.prototype.fromJSON=function(n){if(this._init(),n!=null){this.type=n.type;this.order=n.order;this.manual=n.manual;this.sortBy=n.sortBy;switch(this.type){case 4:this._getValueCmpFunc();break;case 3:this._getManualCmpFunc();break;case 2:var t=this._columns[this._dimName];switch(t.dataType){case"number":this._getNumericalCmpFunc();break;case"date":case"datetime":this._getChronologicalCmpFunc();break;case"string":default:this._getAlphabeticCmpFunc()}break;case 1:default:this._getDataSourceCmpFunc()}}},i.prototype._isEmpty=function(n){return n===""||n===null||n===undefined},i.ascendingCmpFunc=n.utils.valueCompare,i}(kt),bi=function(){function n(n,t){this._pivot=n;this.fromJSON(t)}return n.prototype._init=function(){this.sortInfoes={}},n.prototype.addSortInfo=function(n,t){this.sortInfoes[n]=t},n.prototype.getCmpFunc=function(n){return this.sortInfoes.hasOwnProperty(n)?this.sortInfoes[n].getCmpFunc():null},n.prototype.getPosCmpFunc=function(n){return this.sortInfoes.hasOwnProperty(n)?this.sortInfoes[n].getPosCmpFunc():null},n.prototype.toJSON=function(){var n={};for(var t in this.sortInfoes)n[t]=this.sortInfoes[t].toJSON();return n},n.prototype.fromJSON=function(n){var t=this;this._init();n==null&&(n={});this._pivot.getSetting().getDimensions().forEach(function(i){if(n[i])t.sortInfoes[i]=new dt(t._pivot,i,n[i]);else{var u=t._pivot.getDataset().table.getColumn(i).dataType,r=void 0;r=u==="date"?{type:2,order:1}:{type:1,order:1};t.sortInfoes[i]=new dt(t._pivot,i,r)}})},n}(),t={CNT:"cnt",SUM:"sum",MAX:"max",MIN:"min",SSQ:"ssq",AVG:"avg",STDEV:"stdev",VAR:"var",DST:"dst",FIRST:"first",LAST:"last",CUSTOM:"custom",NONE:"none"},i=function(){function n(n){this._metas=[];this._columnName=n.getColumnName();this._display=n.getColumnDisplay()}return n.prototype.getAggregatorType=function(){return t.CNT},n.prototype.getMetaValues=function(){return{}},n.prototype.getMetas=function(){return this._metas},n.prototype.getColumnName=function(){return this._columnName},n.prototype.mergeMetaValues=function(){},n.prototype.getValue=function(){},n.prototype.getMetaValue=function(){},n}(),gt=function(i){function r(n){var r=i.call(this,n)||this;return r._metas=[t.SUM],r}return __extends(r,i),r.prototype.getAggregatorType=function(){return t.SUM},r.prototype.getMetaValues=function(n){var i=t.SUM,r={};return r[i]=n[i+"_"+this._columnName],r},r.prototype.mergeMetaValues=function(n,i){if(n){var r=t.SUM,f=n[r],u=i&&i[r];n[r]=isNaN(f)?u:f+(isNaN(u)?0:u)}},r.prototype.getValue=function(i){var r=i&&i[t.SUM];return r===+r?n.utils.trimExtraFloatNumber(r):null},r.prototype.getMetaValue=function(n,i,r){var u=t.SUM,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},r}(i),ni=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.CNT],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.CNT},i.prototype.getMetaValues=function(n){var i=t.CNT,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.CNT,f=n[r],u=i&&i[r];n[r]=isNaN(f)?u:f+(isNaN(u)?0:u)}},i.prototype.getValue=function(n){return n&&n[t.CNT]},i.prototype.getMetaValue=function(n,i,r){var u=t.CNT,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ti=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.MAX],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.MAX},i.prototype.getMetaValues=function(n){var i=t.MAX,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var f=t.MAX,r=n[f],u=i&&i[f];n[f]=r===undefined?u:u===undefined?r:r>u?r:u}},i.prototype.getValue=function(n){return n&&n[t.MAX]},i.prototype.getMetaValue=function(n,i,r){var u=t.MAX,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ii=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.MIN],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.MIN},i.prototype.getMetaValues=function(n){var i=t.MIN,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var f=t.MIN,r=n[f],u=i&&i[f];n[f]=r===undefined?u:u===undefined?r:r<u?r:u}},i.prototype.getValue=function(n){return n&&n[t.MIN]},i.prototype.getMetaValue=function(n,i,r){var u=t.MIN,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),ri=function(i){function r(n){var r=i.call(this,n)||this;return r._metas=[t.CNT,t.SUM],r}return __extends(r,i),r.prototype.getAggregatorType=function(){return t.AVG},r.prototype.getMetaValues=function(n){var i={};return i[t.CNT]=n[t.CNT+"_"+this._columnName],i[t.SUM]=n[t.SUM+"_"+this._columnName],i},r.prototype.mergeMetaValues=function(n,i){if(n){var r=t.CNT,u=t.SUM,o=n[r],f=i&&i[r],s=n[u],e=i&&i[u];n[r]=isNaN(o)?f:o+(isNaN(f)?0:f);n[u]=isNaN(s)?e:s+(isNaN(e)?0:e)}},r.prototype.getValue=function(i){return i&&i[t.SUM]!=null&&i[t.CNT]!=null?n.utils.trimExtraFloatNumber(i[t.SUM]/i[t.CNT]):null},r.prototype.getMetaValue=function(n,i){var r={};return r[t.SUM]=n[t.SUM+"_"+this._columnName][i],r[t.CNT]=n[t.CNT+"_"+this._columnName][i],r},r}(i),ui=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.DST],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.DST},i.prototype.getMetaValues=function(n){var i={};return i[t.DST]=n[t.DST+"_"+this._columnName],i},i.prototype.mergeMetaValues=function(n,i){function e(n,t){var i={};for(var r in n)i[r]=!0;for(r in t)i[r]=!0;return i}if(n){var r=t.DST,u=n[r],f=i&&i[r];n[r]=e(u,f)}},i.prototype.getValue=function(n){return n&&n[t.DST]?Object.keys(n[t.DST]).length:0},i.prototype.getMetaValue=function(n,i){var r={};return r[t.DST]=n[t.DST+"_"+this._columnName][i],r},i}(i),fi=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.FIRST],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.FIRST},i.prototype.getMetaValues=function(n){var i=t.FIRST,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.FIRST,f=n[r],u=i&&i[r];return f?n[r]=u?f.concat(u):f:u?n[r]=u:null}},i.prototype.getValue=function(n){return n&&n[t.FIRST]&&n[t.FIRST].length>0?n[t.FIRST].sort(function(n,t){return n.i-t.i})[0].v:null},i.prototype.getMetaValue=function(n,i){var r=t.FIRST,u={};return u[r]=n[r+"_"+this._columnName][i],u},i}(i),ei=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.LAST],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.LAST},i.prototype.getMetaValues=function(n){var i=t.LAST,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.LAST,f=n[r],u=i&&i[r];return f?n[r]=u?f.concat(u):f:u?n[r]=u:null}},i.prototype.getValue=function(n){return n&&n[t.LAST]&&n[t.LAST].length>0?n[t.LAST].sort(function(n,t){return t.i-n.i})[0].v:null},i.prototype.getMetaValue=function(n,i,r){var u=t.LAST,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),oi=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.CUSTOM],r._customAggregator=i._customAggregator,r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.CUSTOM},i.prototype.getMetaValues=function(n){var i=t.CUSTOM,r={};return r[i]=n[i+"_"+this._columnName],r},i.prototype.mergeMetaValues=function(n,i){if(n){var u=t.CUSTOM,f=n[u],r=i&&i[u];return n[u]=f?r?f.concat(r):f:r?r:[]}},i.prototype.getValue=function(n){return this._customAggregator(n&&n[t.CUSTOM],this._columnName)},i.prototype.getMetaValue=function(n,i,r){var u=t.CUSTOM,f={},e=r;return f[u]=n[u+"_"+this._columnName][i],f},i}(i),si=function(n){function i(i){var r=n.call(this,i)||this;return r._metas=[t.NONE],r}return __extends(i,n),i.prototype.getAggregatorType=function(){return t.NONE},i.prototype.getMetaValues=function(n){var i={},r=t.NONE;return i[r]=n[r+"_"+this._columnName],i},i.prototype.mergeMetaValues=function(n,i){if(n){var r=t.NONE,u=n[r],f=i&&i[r];n[r]=isNaN(u)?f:u}},i.prototype.getValue=function(n){return n&&n[t.NONE]},i.prototype.getMetaValue=function(n,i){var r={},u=t.NONE;return r[u]=n[u+"_"+this._columnName][i],r},i}(i),f=function(){function t(n){this.customValueName="";this._valueColumnName=n.name;this._valueColumnDisplayName=n.display;this._index=n.idx;this._method=n.method;this._totalMethod=n.totalMethod;this._format=n.format;this.invalid=n.invalid;this.customValueName=n.customValueName;this._customAggregator=n.customAggregator}return t.prototype.getValueType=function(){return 1},t.prototype.getAggregatorType=function(){return this._method},t.prototype.getTotalAggregatorType=function(){return this._totalMethod},t.prototype.getId=function(){return t.getValueId(this.getAggregatorType(),this._index,this._valueColumnName,this.getIsCalculate())},t.prototype.getName=function(){return t.getValueName(this.getAggregatorType(),this._index,this._valueColumnName,this.getIsCalculate())},t.prototype.getDisplay=function(){return t.getValueDisplay(this.customValueName,this._index,this._valueColumnDisplayName,this.getAggregatorType(),this.getIsCalculate())},t.prototype.setIndex=function(n){this._index=n},t.prototype.getIndex=function(){return this._index},t.prototype.getFormat=function(t){return n.utils.isValidFormat(this._format)?this._format:t&&t.getColumn(this._valueColumnName).format},t.prototype.toJSON=function(n){var t={name:this._valueColumnName,method:this._method,display:this._valueColumnDisplayName,format:this._format,idx:this._index,valueType:1};return n&&(t.invalid=this.invalid),t},t.prototype.isMatchAggregator=function(n){return n.getAggregatorType()===this.getAggregatorType()&&n.getColumnName()===this.getColumnName()},t.prototype.isMatchTotalAggregator=function(n){return n.getAggregatorType()===this.getTotalAggregatorType()&&n.getColumnName()===this.getColumnName()},t.prototype.getColumnName=function(){return this._valueColumnName},t.prototype.getColumnDisplay=function(){return this._valueColumnDisplayName},t.prototype.setColumnDisplay=function(n){this._valueColumnDisplayName=n},t.prototype.getIsCalculate=function(){return!1},t.getValueDisplay=function(t,i,r,u,f){var e,o,h,s;if(!n.utils.isEmpty(t))return t;o=n.SR.dashboard_scenario_value_running_sum;switch(u){case"sum":e=n.SR.dashboard_scenario_value_sumof;o=n.SR.dashboard_scenario_value_running_sum;break;case"cnt":e=n.SR.dashboard_scenario_value_cntof;o=n.SR.dashboard_scenario_value_running_cnt;break;case"avg":e=n.SR.dashboard_scenario_value_avgof;o=n.SR.dashboard_scenario_value_running_avg;break;case"max":e=n.SR.dashboard_scenario_value_maxof;o=n.SR.dashboard_scenario_value_running_max;break;case"min":e=n.SR.dashboard_scenario_value_minof;o=n.SR.dashboard_scenario_value_running_min;break;case"dst":e=n.SR.dashboard_scenario_value_dstof;break;case"first":e=n.SR.dashboard_scenario_value_firstof;break;case"last":e=n.SR.dashboard_scenario_value_lastof;break;case"none":e=""}return h=!n.utils.isEmpty(i)&&i!=0?"(".concat(i,")"):"",s=n.utils.formatstring(e,r)+h,u=="none"&&(s=r+h),f&&(s=o+" "+s),s},t.getValueName=function(n,t,i,r){if(r){var u=t?'\0('+t+")":"";return"running_".concat(n,"_").concat(n,"_of_").concat(i).concat(u)}return"".concat(n,"_of_").concat(i)},t.getValueId=function(n,i,r,u){var f=t.getValueName(n,i,r,u);return u||(f=f+t.SubDateSymbol+i),f},t.SubDateSymbol="\x1d",t}();n.PivotValue=f;var e=function(t){function i(n,i){var r=t.call(this,i)||this;return r._pivotSetting=n,r.fromJSON(i),r}return __extends(i,t),i.prototype.getValueType=function(){return 2},i.prototype.getAggregatorType=function(){return this._method},i.prototype.getIsCalculate=function(){return!0},i.prototype.getType=function(){return this._type},i.prototype.getMethod=function(){return this._method},i.prototype.getMeasure=function(){return this._measure},i.prototype.getColumnName=function(){return this._measure&&this._measure.name},i.prototype.setColumnDisplay=function(n){this._measure&&(this._measure.display=n)},i.prototype.getAlong=function(){return this.update(),this._along},i.prototype.getFormat=function(t){if(n.utils.isValidFormat(this._format))return this._format;if(this._method==="cnt")return n.utils.getDefaultFormat();if(n.utils.isValidFormat(this._measure.format))return this._measure.format;var i=this._measure.method==="cnt";return i||!t?"General":t.getColumn(this.getColumnName()).format},i.prototype.fromJSON=function(n){n&&(this._index=n.idx,this._type=n.type,this._method=n.method,this._along=n.along,this._measure=n.measure,this._format=n.format,this.invalid=n.invalid)},i.prototype.update=function(){var t,n,i,r;if(this._along){t=[];n=[];switch(this._along.name){case"table":t=this._pivotSetting.getSeriesByType(this._type);n=this._pivotSetting.getRowsByType().concat(this._pivotSetting.getColumnsByType().concat(this._pivotSetting.getAxisByType()));break;case"row":t=this._pivotSetting.getSeriesByType(this._type).concat(this._pivotSetting.getRowsByType());n=this._pivotSetting.getColumnsByType().concat(this._pivotSetting.getAxisByType());break;case"column":t=this._pivotSetting.getSeriesByType(this._type).concat(this._pivotSetting.getColumnsByType());n=this._pivotSetting.getRowsByType().concat(this._pivotSetting.getAxisByType());break;case"cell":t=this._pivotSetting.getSeriesByType(this._type).concat(this._pivotSetting.getRowsByType().concat(this._pivotSetting.getColumnsByType()));n=this._pivotSetting.getAxisByType();break;default:i=this._pivotSetting.getDimensions().reduce(function(n,t){return n[t]=!0,n},{});this._along.advance.partitioning.forEach(function(n){i[n]&&(t.push(n),i[n]=!1)});this._along.advance.addressing.forEach(function(t){i[t]&&(n.push(t),i[t]=!1)});for(r in i)i[r]&&n.push(r)}this._along.advance={partitioning:t,addressing:n}}},i.prototype.toJSON=function(n){var t={idx:this._index,type:this._type,method:this._method,along:this._along,measure:this._measure,format:this._format,valueType:2};return n&&(t.invalid=this.invalid),t},i}(f),ki=function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t.prototype.getOption=function(){return{restartOn:this._restartOn}},t.prototype.getAggregator=function(n,t,i,r){function w(n,t){for(var u,f,o,i=0;i<p;i++)if(f=new Forguncy.BigNumber2(n,r).mod(e[i].ceil).dividedBy(e[i].floor).toFormat(),o=new Forguncy.BigNumber2(t,r).mod(e[i].ceil).dividedBy(e[i].floor).toFormat(),u=y[i](new Forguncy.BigNumber2(f,r),new Forguncy.BigNumber2(o,r)),u!==0)return u;return u}var u=t,c=this._along.advance.partitioning,o=this._along.advance.addressing,s={},l=this._method,h,a=u.getMeasureAggregator(this._measure),v=new f(this._measure);h=u.getPartitionedVectors(n,c);var y=o.map(function(n){return i.getPosCmpFunc(n)}),e=o.map(function(n){return u.getWeight(n)}),p=o.length;return h.forEach(function(n){n.sort(w);var t=new gi(l);n.forEach(function(n){s[n]=t.addUp(u.getValue(a,n,v.getId()))})}),this._latestAggregator=new di(s),this._latestAggregator},t.prototype.fromJSON=function(n){n&&(e.prototype.fromJSON.call(this,n),this._restartOn=n.option&&n.option.restartOn)},t.prototype.toJSON=function(n){var t=e.prototype.toJSON.call(this,n);return t.option={restartOn:this._restartOn},t},t}(e),di=function(){function n(n){this._cache=n}return n.prototype.getValue=function(n){return this._cache[n]},n}(),gi=function(){function n(n){this._method=n;this._counter=0;this._addedVal=null}return n.prototype.addUp=function(n){this._addedVal===null&&this._method!=="min"&&(this._addedVal=0);var t=0,i=n;n===undefined?i=0:this._counter++;switch(this._method){case"sum":t=this._addedVal+i;this._addedVal=t;break;case"max":t=Math.max(this._addedVal,i);this._addedVal=t;break;case"min":t=this._addedVal===null?i:Math.min(this._addedVal,i);this._addedVal=t;break;case"cnt":t=this._counter;this._addedVal=t;break;case"avg":this._addedVal=this._addedVal+i;t=this._addedVal/this._counter}return t},n}()})(PivotData||(PivotData={}))
;var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},PivotData;(function(n){var c=Forguncy.ColorHelper,i=function(){function t(n,t){this._colHeaderName="colHeader";this._rowHeaderName="rowHeader";this._dataCellName="df_pt_dataCell";this._grandTotalColumnsName="grandTotalsColumn";this._grandTotalRowsName="grandTotalsRow";this._firstLevelSubtotalForRowsName="subTotalForRow1";this._firstLevelSubtotalForColumnsName="subTotalForCol1";this._secondLevelSubtotalForRowsName="subTotalForRow2";this._secondLevelSubtotalForColumnsName="subTotalForCol2";this._thirdLevelSubtotalForRowsName="subTotalForRow3";this._thirdLevelSubtotalForColumnsName="subTotalForCol3";this._init(n,t)}return t.prototype._init=function(i,r){for(var v,y,s=i.schema.tableRowLevel,c=f.getColLevel(i),h=f.getRowCount(i),l=f.getColCount(i),u={},o=0,e=0,p,a,o=0;o<h;o++)for(u[o]={},e=0;e<l;e++)u[o][e]=new GC.Spread.Sheets.Style;for(e=s;e<l;e++)for(p=this.getFormat(i,e,s),o=c;o<h;o++)u[o][e].formatter=p;for(o=0;o<h;o++)for(e=0;e<s;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.rowHeader,r.font));for(s>1&&i.data.rowHeader.forEach(function(n,i){for(var o,e=i+c,f=0;f<n.length-1;f++)o=n[f],o.type!==64&&o.type!==32&&(o.level===1?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.rowSubheading1,r.font)):o.level%2==0?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.rowSubheading2,r.font)):o.level%2==1&&(u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.rowSubheading3,r.font))))}),o=0;o<c;o++)for(e=0;e<l;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colHeader,r.font));if(i.data.colHeader.forEach(function(n,i){n.forEach(function(n,f){if(n.type!==64){var e=f+s;n.level===1?u[i][e]=t._compose(u[i][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colSubheading1,r.font)):n.level%2==0?u[i][e]=t._compose(u[i][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colSubheading2,r.font)):n.level%2==1&&(u[i][e]=t._compose(u[i][e],t._getSpreadJSStyleFromPivotAreaStyle(r.colSubheading3,r.font)))}})}),((v=i.data.colHeader)===null||v===void 0?void 0:v.length)>0&&_.last(i.data.colHeader).forEach(function(n,i){var e,f;if(n.type===32)for(e=i+s,f=c;f<h;f++)n.level===1?u[f][e]=t._compose(u[f][e],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForCol1,r.font)):n.level%2==0?u[f][e]=t._compose(u[f][e],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForCol2,r.font)):n.level%2==1&&(u[f][e]=t._compose(u[f][e],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForCol3,r.font)))}),i.data.rowHeader&&i.data.rowHeader.map(function(t){var i=_.filter(t,function(n){return n.type===32})[0];return i?i:new n.TableDataCell}).forEach(function(n,i){var e,f;if(n.type===32)for(e=i+c,f=0;f<l;f++)n.level===1?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForRow1,r.font)):n.level%2==0?u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForRow2,r.font)):n.level%2==1&&(u[e][f]=t._compose(u[e][f],t._getSpreadJSStyleFromPivotAreaStyle(r.subTotalForRow3,r.font)))}),((y=i.data.colHeader)===null||y===void 0?void 0:y.length)>0&&(a=l-s-i.schema.measureLength,i.data.colHeader[0][a]&&i.data.colHeader[0][a].type===64))for(o=0;o<h;o++)for(e=a+s;e<l;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.grandTotalsColumn,r.font));if(i.data.rowHeader[h-c-1][0]&&i.data.rowHeader[h-c-1][0].type===64)for(o=h-1,e=0;e<l;e++)u[o][e]=t._compose(u[o][e],t._getSpreadJSStyleFromPivotAreaStyle(r.grandTotalsRow,r.font));this._styleNameCache=u},t.prototype.getFormat=function(n,t,i){var r=(t-i)%n.valueFormats.length;return n.valueFormats[r]},t._compose=function(n,t){if(!n)return t?t.clone():new GC.Spread.Sheets.Style;if(!t)return n.clone();var i=n.clone(),r=undefined;return t.backColor&&(i.backColor=t.backColor),t.foreColor&&(i.foreColor=t.foreColor),Forguncy.Common.IsEmpty(t.hAlign)||(i.hAlign=t.hAlign),Forguncy.Common.IsEmpty(t.vAlign)||(i.vAlign=t.vAlign),t.font&&(i.font=this._composeFont(i.font,t.font)),t.formatter&&(i.formatter=t.formatter),t.borderLeft&&(i.borderLeft=t.borderLeft),t.borderTop&&(i.borderTop=t.borderTop),t.borderRight&&(i.borderRight=t.borderRight),t.borderBottom&&(i.borderBottom=t.borderBottom),t.diagonalDown&&(i.diagonalDown=t.diagonalDown),t.diagonalUp&&(i.diagonalUp=t.diagonalUp),t.textIndent&&(i.textIndent=t.textIndent),t.wordWrap!==r&&(i.wordWrap=t.wordWrap),t.shrinkToFit!==r&&(i.shrinkToFit=t.shrinkToFit),t.cellType&&(i.cellType=t.cellType),t.tabStop!==r&&(i.tabStop=t.tabStop),t.textDecoration&&(i.textDecoration=t.textDecoration),t.name&&(i.name=t.name),t.parentName&&(i.parentName=t.parentName),t.watermark&&(i.watermark=t.watermark),t.cellPadding&&(i.cellPadding=t.cellPadding),t.labelOptions&&(i.labelOptions=t.labelOptions),t.quotePrefix&&(i.quotePrefix=t.quotePrefix),t.isVerticalText!==r&&(i.isVerticalText=t.isVerticalText),i},t._composeFont=function(n,t){if(!n||!t)return n||t;var i=this._getFontProperties(n),r=this._getFontProperties(t);return this._composeFontProps(i,r)},t._composeFontProps=function(n,t){var i=[],r;return(n.bold||t.bold)&&i.push("bold"),(n.italic||t.italic)&&i.push("italic"),(n.fontSize||t.fontSize)&&i.push(t.fontSize||n.fontSize),(n.fontFamily||t.fontFamily)&&(r=t.fontFamily||n.fontFamily,r&&r!="undefined"?i.push(r):i.push(Forguncy.ForguncyData.GlobalSettings.ThemeFont)),i.join(" ")},t._getFontProperties=function(n){if(this._fontCache[n])return this._fontCache[n];this._span.style.font=n;var t=this._span.style,i={fontFamily:t.fontFamily,fontSize:t.fontSize,bold:t.fontWeight=="bold",italic:t.fontStyle=="italic"};return this._fontCache[n]=i,i},t._getSpreadJSStyleFromPivotAreaStyle=function(n,i){var r=new GC.Spread.Sheets.Style;return t._applyStyle(r,n,i),r},t._getSpreadJSVAlign=function(n){switch(n){case"Top":return GC.Spread.Sheets.VerticalAlign.top;case"Center":return GC.Spread.Sheets.VerticalAlign.center;default:return GC.Spread.Sheets.VerticalAlign.bottom}},t._getSpreadJSHAlign=function(n){switch(n){case"Left":return GC.Spread.Sheets.HorizontalAlign.left;case"Center":return GC.Spread.Sheets.HorizontalAlign.center;case"Right":return GC.Spread.Sheets.HorizontalAlign.right;default:return GC.Spread.Sheets.HorizontalAlign.general}},t.prototype._getBaseStyle=function(n){var i=new GC.Spread.Sheets.Style;return t._applyStyle(i,n.wholeTable,n.font),i},t.prototype._getDataCellStyles=function(n){var t=this._getBaseStyle(n);return t.name=this._dataCellName,[t]},t._applyStyle=function(n,i,r){i.foreColor&&(n.foreColor=i.foreColor);i.backColor&&(n.backColor=i.backColor);i.CellVerticalAligment&&(n.vAlign=t._getSpreadJSVAlign(i.CellVerticalAligment));i.CellHorizontalAlignment&&(n.hAlign=t._getSpreadJSHAlign(i.CellHorizontalAlignment));n.font=t._getFontStr(i,r)},t._getFontStr=function(n,t){var i={},r;return n.Bold&&(i.bold=!0),n.Italic&&(i.italic=!0),r=this._getFontProperties(t),this._composeFontProps(i,r)},t.prototype._getRowHeaderStyles=function(n){var i=this._getBaseStyle(n);return t._applyStyle(i,n.rowHeader,n.font),i.name=this._rowHeaderName,[i]},t.prototype._getColHeaderStyles=function(n){var i=this._getBaseStyle(n);return i.name=this._colHeaderName,t._applyStyle(i,n.colHeader,n.font),[i]},t.prototype._getGrandTotalStyles=function(n){var i=this._getBaseStyle(n),r;return i.name=this._grandTotalColumnsName,t._applyStyle(i,n.grandTotalsColumn,n.font),r=this._getBaseStyle(n),r.name=this._grandTotalRowsName,t._applyStyle(i,n.grandTotalsRow,n.font),[r,i]},t.prototype._getSubtotalStyles=function(n){var o=this._getBaseStyle(n),i,r,u,f,e;return o.name=this._firstLevelSubtotalForColumnsName,t._applyStyle(o,n.subTotalForCol1,n.font),i=this._getBaseStyle(n),i.name=this._secondLevelSubtotalForColumnsName,t._applyStyle(i,n.subTotalForCol2,n.font),r=this._getBaseStyle(n),r.name=this._thirdLevelSubtotalForColumnsName,t._applyStyle(r,n.subTotalForCol3,n.font),u=this._getBaseStyle(n),u.name=this._firstLevelSubtotalForRowsName,t._applyStyle(u,n.subTotalForRow1,n.font),f=this._getBaseStyle(n),f.name=this._secondLevelSubtotalForRowsName,t._applyStyle(f,n.subTotalForRow2,n.font),e=this._getBaseStyle(n),e.name=this._thirdLevelSubtotalForRowsName,t._applyStyle(e,n.subTotalForRow3,n.font),[o,i,r,u,f,e]},t.prototype.getAllNamedStyle=function(n){var t=[],e=this._getDataCellStyles(n),i,r,u,f;return t=t.concat(e),i=this._getRowHeaderStyles(n),t=t.concat(i),r=this._getColHeaderStyles(n),t=t.concat(r),u=this._getGrandTotalStyles(n),t=t.concat(u),f=this._getSubtotalStyles(n),t.concat(f)},t.prototype.getSpreadJSStyle=function(n,t){return this._styleNameCache&&this._styleNameCache[n]&&this._styleNameCache[n][t]?this._styleNameCache[n][t]&&this._styleNameCache[n][t].clone():null},t.defaultFontSize="14px",t.defaultFontFamily="Calibri",t._fontCache={},t._span=document.createElement("span"),t}(),l=function(){function n(){this.data=[];this.rowHeader=[];this.colHeader=[]}return n}(),a=function(){function n(){this.tableRowLevel=0;this.tableColLevel=0;this.valueLevel=0;this.measureLength=0;this.rowDim=[];this.colDim=[]}return n}(),p=function(){function n(){}return n}(),v=function(){function n(){this.data=new l;this.schema=new a}return n}(),t,u,h,r;n.TableData=v;t=function(){function n(n,t){this.backColor=n;this.foreColor=t}return n}();n.PivotAreaStyle=t;var y=function(){function n(){this.colHeader=new t("","");this.rowHeader=new t("","");this.subTotalForRow1=new t("","");this.subTotalForRow2=new t("","");this.subTotalForRow3=new t("","");this.subTotalForCol1=new t("","");this.subTotalForCol2=new t("","");this.subTotalForCol3=new t("","");this.grandTotalsColumn=new t("","");this.grandTotalsRow=new t("","");this.firstColStripe=new t("","");this.secondColStripe=new t("","");this.firstRowStripe=new t("","");this.secondRowStripe=new t("","");this.colSubheading1=new t("","");this.colSubheading2=new t("","");this.colSubheading3=new t("","");this.rowSubheading1=new t("","");this.rowSubheading2=new t("","");this.rowSubheading3=new t("","");this.wholeTable=new t("transparent","#333333");this.gridLine="";this.rowHeight=21;this.font=i.defaultFontSize+" "+i.defaultFontFamily;this.isColumnHeader=!0;this.isRowHeader=!0;this.showPlus=!0;this.showFieldHeader=!0;this.isAutofitColumn=!0;this.columnWidth=62;this.rowHeaderColumnWidth=62;this.showBandedRows=!1;this.showBandedCols=!1}return n}(),o=function(){function n(){this[32]=[];this[64]=[]}return n}(),s=function(){function n(n,t){this.row=n;this.col=t}return n}(),e=function(){function n(n,t,i){this.row=n;this.col=t;this.value=i;this.rowCount=1;this.colCount=1}return n}(),f=function(){function t(){this._sheet=null;this._theme=null;this._mergeRangeRowCount={};this._collapsedRange={};this._stylesSetByInspector=new y;this._totalsRegion=new o;this._colHiddenMap={};this._rowHiddenMap={};this._colSubtotalMap=[];this._rowSubtotalMap=[];this._colSelectCellMap={};this._colHeaderCollapseRange={}}return t.prototype.init=function(n){this._pivotData=n;this._colHiddenMap={};this._rowHiddenMap={};this._colSubtotalMap=[];this._rowSubtotalMap=[]},t.prototype.render=function(n,t){this.init(t);this.setTheme(new i(t,this._stylesSetByInspector));this._theme.getAllNamedStyle(this._stylesSetByInspector).forEach(function(t){n.addNamedStyle(t)});this._sheet=n;this._renderTable(n,t)},t.prototype._renderTable=function(n,i){n.suspendPaint();n.suspendEvent();try{var r=t.getRowCount(i)-t.getColLevel(i),u=t.getColCount(i);n&&(n.setRowCount(r),n.setColumnCount(u));this._setDefaultStyle(n);this._renderCornerPortion(n,i);this._renderRowHeaderPortion(n,i);this._renderColHeaderPortion(n,i);this._renderDataPortion(n,i);this._expandCollapseHeader(n);this.autoResizeColumn(n,i);this._renderStripe(n,i);this._renderBorder(n,i)}finally{n.resumeEvent();n.resumePaint()}},t.prototype._renderBorder=function(n,i){var r=this,nt,tt,it,s=n.getRowCount(),y=n.getColumnCount(),rt=t.getColLevel(i),h=i.schema.tableRowLevel,p=GC.Spread.Sheets.SheetArea.colHeader,ut=new GC.Spread.Sheets.LineBorder("",GC.Spread.Sheets.LineStyle.empty),k,ft,u,w,et,ot,lt,v,c,at,vt,b,l,yt,e,pt,wt,bt,kt,d,a,g,f,st,dt,gt,ni;if(this._stylesSetByInspector.gridLine&&(ut=new GC.Spread.Sheets.LineBorder(this._stylesSetByInspector.gridLine,GC.Spread.Sheets.LineStyle.thin)),k=n.getRange(0,0,rt,y,p),ft=n.getRange(0,0,s,y),k.setBorder(ut,{all:!0}),ft.setBorder(ut,{all:!0}),u=this._stylesSetByInspector,w=u.wholeTable,this._hasBorder(w)&&(et=__assign({},w),et.borderBottomString=w.insideHorizontalBorderString,this._renderRangeBorder(k,et),ot=__assign({},w),ot.borderTopString=w.insideHorizontalBorderString,this._renderRangeBorder(ft,ot)),u.showBandedCols){if(this._hasBorder(u.firstColStripe))for(v=0,c=h;c<y;c++)n.getColumnVisible(c)&&(v%2==0&&(lt=n.getRange(-1,c,-1,1),this._renderRangeBorder(lt,u.firstColStripe)),v++);if(this._hasBorder(u.secondColStripe))for(v=0,c=h;c<y;c++)n.getColumnVisible(c)&&(v%2==1&&(at=n.getRange(-1,c,-1,1),this._renderRangeBorder(at,u.secondColStripe)),v++)}if(u.showBandedRows){if(this._hasBorder(u.firstRowStripe))for(b=0,l=0;l<s;l++)n.getRowVisible(l)&&(b%2==0&&(vt=n.getRange(l,-1,1,-1),this._renderRangeBorder(vt,u.firstRowStripe)),b++);if(this._hasBorder(u.secondRowStripe))for(b=0,l=0;l<s;l++)n.getRowVisible(l)&&(b%2==1&&(yt=n.getRange(l,-1,1,-1),this._renderRangeBorder(yt,u.secondRowStripe)),b++)}if(e=u.rowHeader,this._hasBorder(e)&&(pt={borderTopString:e.borderTopString,borderBottomString:e.insideHorizontalBorderString,borderLeftString:e.borderLeftString,borderRightString:e.borderRightString,insideHorizontalBorderString:e.insideHorizontalBorderString,insideVerticalBorderString:e.insideVerticalBorderString},wt=n.getRange(0,0,rt,h,p),this._renderRangeBorder(wt,pt),bt={borderTopString:e.insideHorizontalBorderString,borderBottomString:e.borderBottomString,borderLeftString:e.borderLeftString,borderRightString:e.borderRightString,insideHorizontalBorderString:e.insideHorizontalBorderString,insideVerticalBorderString:e.insideVerticalBorderString},kt=n.getRange(0,0,s,h),this._renderRangeBorder(kt,bt)),h>1)for(d=this.getMergeRowHeader(i,n),a=0;a<i.schema.tableRowLevel-1;a++)if(d[a])for(g=0;g<d[a].length;g++)f=d[a][g],f.type!==64&&f.type!==32&&(a===0?this._renderRangeBorder(n.getRange(f.row,f.col,f.rowCount,f.colCount),this._stylesSetByInspector.rowSubheading1):a%2==1?this._renderRangeBorder(n.getRange(f.row,f.col,f.rowCount,f.colCount),this._stylesSetByInspector.rowSubheading2):a%2==0&&this._renderRangeBorder(n.getRange(f.row,f.col,f.rowCount,f.colCount),this._stylesSetByInspector.rowSubheading3));st=u.colHeader;this._hasBorder(st)&&this._renderRangeBorder(k,st);i.data.colHeader.forEach(function(t,i){t.forEach(function(t,u){if(t.type!==64){var f=u+h;t.level===1?r._renderRangeBorder(n.getCell(i,f,p),r._stylesSetByInspector.colSubheading1):t.level%2==0?r._renderRangeBorder(n.getCell(i,f,p),r._stylesSetByInspector.colSubheading2):t.level%2==1&&r._renderRangeBorder(n.getCell(i,f,p),r._stylesSetByInspector.colSubheading3)}})});((nt=i.data.colHeader)===null||nt===void 0?void 0:nt.length)>0&&_.last(i.data.colHeader).forEach(function(t,i){if(t.type===32){var u=i+h;t.level===1&&r._renderRangeBorder(n.getRange(0,u,s,1),r._stylesSetByInspector.subTotalForCol1)}});((tt=i.data.colHeader)===null||tt===void 0?void 0:tt.length)>0&&_.last(i.data.colHeader).forEach(function(t,i){if(t.type===32){var u=i+h;t.level>1&&t.level%2==0&&r._renderRangeBorder(n.getRange(0,u,s,1),r._stylesSetByInspector.subTotalForCol2)}});((it=i.data.colHeader)===null||it===void 0?void 0:it.length)>0&&_.last(i.data.colHeader).forEach(function(t,i){if(t.type===32){var u=i+h;t.level>1&&t.level%2==1&&r._renderRangeBorder(n.getRange(0,u,s,1),r._stylesSetByInspector.subTotalForCol3)}});i.data.rowHeader.forEach(function(t,i){t.forEach(function(t,u){t.type===32&&t.level===1&&r._renderRangeBorder(n.getRange(i,u,1,n.getColumnCount()-u),r._stylesSetByInspector.subTotalForRow1)})});i.data.rowHeader.forEach(function(t,i){t.forEach(function(t,u){t.type===32&&t.level>1&&t.level%2==0&&r._renderRangeBorder(n.getRange(i,u,1,n.getColumnCount()-u),r._stylesSetByInspector.subTotalForRow2)})});i.data.rowHeader.forEach(function(t,i){t.forEach(function(t,u){t.type===32&&t.level>1&&t.level%2==1&&r._renderRangeBorder(n.getRange(i,u,1,n.getColumnCount()-u),r._stylesSetByInspector.subTotalForRow3)})});var o=u.grandTotalsColumn,ht=i.schema.measureLength,ct=y-h-ht;if(this._hasBorder(o)&&i.data.colHeader[0][ct]&&i.data.colHeader[0][ct].type===64){var v=ct+h,ti={borderTopString:o.borderTopString,borderBottomString:o.insideHorizontalBorderString,borderLeftString:o.borderLeftString,borderRightString:o.borderRightString,insideHorizontalBorderString:o.insideHorizontalBorderString,insideVerticalBorderString:o.insideVerticalBorderString},ii=n.getRange(0,v,rt,ht,p);this._renderRangeBorder(ii,ti);dt={borderTopString:o.insideHorizontalBorderString,borderBottomString:o.borderBottomString,borderLeftString:o.borderLeftString,borderRightString:o.borderRightString,insideHorizontalBorderString:o.insideHorizontalBorderString,insideVerticalBorderString:o.insideVerticalBorderString};gt=n.getRange(0,v,s,ht);this._renderRangeBorder(gt,dt)}this._hasBorder(u.grandTotalsRow)&&i.data.rowHeader[s-1][0]&&i.data.rowHeader[s-1][0].type===64&&(ni=n.getRange(s-1,0,1,y),this._renderRangeBorder(ni,u.grandTotalsRow))},t.prototype.getMergeRowHeader=function(n){for(var i,l,r,a,w,b,v,y=t._getDataRowCount(n),s=n.schema.tableRowLevel,o={},h=s-1,c=0;c<h;++c)o[c]=[];for(i=0;i<y;i++)if(l=n.data.rowHeader[i],l)for(r=0;r<s;r++){var u=l[r],p=i,f=r;u&&u.value!==undefined?(b=u.value,s>=2&&r<h&&(v=new e(p,f,b),v.type=u.type?u.type:undefined,o[r].push(v))):p<y-1+t.getColLevel(n)&&f<h&&o[f].length>0&&(n.data.rowHeader[i][f-1]&&n.data.rowHeader[i][f-1].type||u&&u.type||(a=o[f],w=a[a.length-1],++w.rowCount))}return o},t.prototype._hasBorder=function(n){return n.borderBottomString||n.borderTopString||n.borderLeftString||n.borderRightString||n.insideHorizontalBorderString||n.insideVerticalBorderString?!0:!1},t.prototype._renderRangeBorder=function(n,t){var f=new GC.Spread.Sheets.LineBorder("",GC.Spread.Sheets.LineStyle.empty),i=this._sheet,h,c,s,e,o,l,r;t.borderBottomString&&(n.row>=0&&n.row+n.rowCount<this._sheet.getRowCount()&&(h=i.getRange(n.row+n.rowCount,n.col,1,n.colCount,n.sheetArea),h.setBorder(f,{top:!0})),r=u.ConvertCssRuleToBorderLine(t.borderBottomString),n.setBorder(r,{bottom:!0}),n.row+n.rowCount===i.getRowCount()&&i.getRowHeight(i.getRowCount()-1)===0&&n.row+n.rowCount-2>=0&&(c=i.getRange(n.row+n.rowCount-2,n.col,1,n.colCount,n.sheetArea),c.setBorder(r,{bottom:!0})));t.borderTopString&&(n.row>0&&(e=i.getRange(n.row-1,n.col,1,n.colCount,n.sheetArea),e.setBorder(f,{bottom:!0})),r=u.ConvertCssRuleToBorderLine(t.borderTopString),n.row===0&&n.sheetArea===GC.Spread.Sheets.SheetArea.viewport&&(s=GC.Spread.Sheets.SheetArea.colHeader,e=i.getRange(i.getRowCount(s)-1,n.col,1,n.colCount,s),e.setBorder(r,{bottom:!0})),n.setBorder(r,{top:!0}));t.borderLeftString&&(n.col>0&&(o=i.getRange(n.row,n.col-1,n.rowCount,1,n.sheetArea),o.setBorder(f,{right:!0})),r=u.ConvertCssRuleToBorderLine(t.borderLeftString),n.setBorder(r,{left:!0}));t.borderRightString&&(n.col>=0&&n.col+n.colCount<i.getColumnCount()&&(o=i.getRange(n.row,n.col+n.colCount,n.rowCount,1,n.sheetArea),o.setBorder(f,{left:!0})),r=u.ConvertCssRuleToBorderLine(t.borderRightString),n.setBorder(r,{right:!0}),n.col+n.colCount===i.getColumnCount()&&i.getColumnWidth(i.getColumnCount()-1)===0&&n.col+n.colCount-2>=0&&(l=i.getRange(n.row,n.col+n.colCount-2,n.rowCount,1,n.sheetArea),l.setBorder(r,{right:!0})));t.insideHorizontalBorderString&&(r=u.ConvertCssRuleToBorderLine(t.insideHorizontalBorderString),n.setBorder(r,{innerHorizontal:!0}));t.insideVerticalBorderString&&(r=u.ConvertCssRuleToBorderLine(t.insideVerticalBorderString),n.setBorder(r,{innerVertical:!0}))},t.prototype._renderStripe=function(n,t){var h=n.getRowCount(),c=n.getColumnCount(),l=t.schema.rowDim.length,o,r,f,s,u,e;if(this._stylesSetByInspector.showBandedRows){for(o=0,r=0;r<h;r++)n.getRowVisible(r)&&(o%2==0&&(f=n.getStyle(r,-1),f||(f=new GC.Spread.Sheets.Style),i._applyStyle(f,this._stylesSetByInspector.firstRowStripe,this._stylesSetByInspector.font),n.setStyle(r,-1,f)),o++);for(o=0,r=0;r<h;r++)n.getRowVisible(r)&&(o%2==1&&(f=n.getStyle(r,-1),f||(f=new GC.Spread.Sheets.Style),i._applyStyle(f,this._stylesSetByInspector.secondRowStripe,this._stylesSetByInspector.font),n.setStyle(r,-1,f)),o++)}if(this._stylesSetByInspector.showBandedCols){for(s=0,u=l;u<c;u++)n.getColumnVisible(u)&&(s%2==0&&(e=n.getStyle(-1,u),e||(e=new GC.Spread.Sheets.Style),i._applyStyle(e,this._stylesSetByInspector.firstColStripe,this._stylesSetByInspector.font),n.setStyle(-1,u,e)),s++);for(s=0,u=l;u<c;u++)n.getColumnVisible(u)&&(s%2==1&&(e=n.getStyle(-1,u),e||(e=new GC.Spread.Sheets.Style),i._applyStyle(e,this._stylesSetByInspector.secondColStripe,this._stylesSetByInspector.font),n.setStyle(-1,u,e)),s++)}},t.prototype._setDefaultStyle=function(n){var t=n.getDefaultStyle();t.textIndent=0;t.vAlign=GC.Spread.Sheets.VerticalAlign.center;delete t.themeFont;i._applyStyle(t,this._stylesSetByInspector.wholeTable,this._stylesSetByInspector.font);n.setDefaultStyle(t,GC.Spread.Sheets.SheetArea.viewport);n.setDefaultStyle(t,GC.Spread.Sheets.SheetArea.colHeader)},t.prototype._copyColumnHeader=function(n){for(var i,e,o,s,r=GC.Spread.Sheets.SheetArea.colHeader,u=n.getRowCount(r),f=n.getColumnCount(r),t=0;t<u;t++){for(i=0;i<f;i++)e=n.getValue(t,i,GC.Spread.Sheets.SheetArea.colHeader),n.setValue(t,i,e),o=n.getStyle(t,i,GC.Spread.Sheets.SheetArea.colHeader),n.setStyle(t,i,o);n.setRowVisible(t,!1)}s=n.getSpans(new GC.Spread.Sheets.Range(0,0,u,f),r);s.forEach(function(t){n.addSpan(t.row,t.col,t.rowCount,t.colCount)})},t.prototype._renderCornerPortion=function(i,r){var h=t.getColLevel(r),l=r.schema.tableRowLevel,f=GC.Spread.Sheets.SheetArea.colHeader,v=this._theme,o,s,c;for(i.setRowCount(h,f),o=0;o<l;o++){var u=0+o,e=0,a=this._getHeaderStyle(e,u);this.mergeCells(i,0,u,h,1,f);s="";this._stylesSetByInspector.showFieldHeader&&(s=r.schema.rowDim[u].display);i.setStyle(e,u,a,f);c=new n.NormalColumnHeaderCellType;i.setCellType(e,u,c,f);i.setValue(e,u,s,f);this._setRowHeight(e,u,f)}},t.prototype._renderColHeaderPortion=function(i,r){for(var h,f,v,u,c,g,ht,nt,y,tt,it,rt,ut,ft,p=this,et=r.schema.tableRowLevel,a=t.getColLevel(r),b=t._getDataColCount(r),pt=this._theme,s=GC.Spread.Sheets.SheetArea.colHeader,w=r.schema.measureLength,ct=n.SR.spread_pivot_table_grand_total,lt=n.SR.spread_pivot_table_subtotal,ot=this.mergeTotals(r),st=ot[0],k=ot[1],l=0;l<a;l++)for(v=r.data.colHeader[l],c=0;c<b;c++)h=v[c],h&&h.display===!1&&(this._colHiddenMap[c+et]=!0);for(l=0;l<a;l++)if(f=l+0,v=r.data.colHeader[l],v){for(u=null,c=0;c<b;c++){var h=v[c],o=c+et,d=h&&h.value!==undefined;if(f<a-1&&(g=st[f]&&st[f][o],(d||g||this._colHiddenMap[o])&&u&&(ht=o-u.col,ht>1&&(nt=u.col,f<a-(w>1?1:0)-1&&this._stylesSetByInspector.showPlus?i.setCellType(u&&u.row,u&&u.col,new n.CollapseHeaderCellType,s):i.setCellType(u&&u.row,u&&u.col,new n.NormalColumnHeaderCellType,s),k.push({row:f,col:nt,colCount:o-nt,rowCount:1}))),g?u=null:d&&(u=new e(f,o,h.value),u.path=h.path||[])),h!==undefined){y=h.value;y===null&&(y=n.SR.nullvalue_display);d||(y=i.getValue(f,o-1,s));i.setValue(f,o,y,s);this._setRowHeight(f,o,s);tt=i.getTag(f,o,s)||{collapse:!1};tt.backgroundValue=h.backgroundValue;i.setTag(f,o,tt,s);var at=f,vt=o,yt=this._getHeaderStyle(at,vt);i.setStyle(f,o,yt,s);it=new n.NormalColumnHeaderCellType;rt=h.value===ct||h.value===lt;h.type!==undefined||rt?(ut=it,rt&&f<a-1&&(ut=new n.NormalColumnHeaderCellType),i.setCellType(f,o,ut,s)):i.setCellType(f,o,it,s);this._colHiddenMap[o]&&i.setColumnVisible(o,!1,s)}}ft=b+r.schema.tableRowLevel;u&&u.col<ft-1&&k.push({row:f,col:u.col,colCount:ft-u.col,rowCount:1});f<a-(w>1?1:0)-1&&this._stylesSetByInspector.showPlus&&u&&i.setCellType(u&&u.row,u&&u.col,new n.CollapseHeaderCellType,s)}this._colHeaderCollapseRange={};k.forEach(function(n){p.mergeCells(i,n.row,n.col,n.rowCount,n.colCount,s);n.row<a-(w>1?1:0)-1&&(p._colHeaderCollapseRange[n.row]===undefined&&(p._colHeaderCollapseRange[n.row]={}),p._colHeaderCollapseRange[n.row][n.col]=n.colCount-w)})},t.prototype.mergeTotals=function(n){for(var r,y,o,s,u,p,c,f,l,i={},a=[],v=t.getColLevel(n),w=t._getDataColCount(n),b=n.schema.tableRowLevel,h=n.schema.measureLength,e=0;e<v-1;++e)if(r=e+0,y=this._pivotData.data.colHeader[e],y)for(o=0;o<w;++o)if(s=y[o],u=o+b,s&&s.value&&s.path&&s.path.length<t.getColLevel(n)&&!(i[r]&&i[r][u])){if(h>1&&a.push({row:r,col:u,rowCount:1,colCount:h}),p=v-e-1,p>1)for(c=0;c<h;++c)a.push({row:r+1,col:u+c,rowCount:p,colCount:1});for(f=r;f<v;++f)for(i[f]||(i[f]={}),l=u;l<u+h;++l)i[f][l]=!0}return[i,a]},t.prototype._renderRowHeaderPortion=function(i,r){var a=0,p=0,v=t._getDataRowCount(r),c=r.schema.tableRowLevel,w=this._theme,f={},l=c-1,s,y,u,h;for(this._totalsRegion=new o,s=0;s<l;++s)f[s]=[];for(y=function(o){var b=r.data.rowHeader[o],d,rt,w,g,ut,nt,ft,k,tt,et,it;if(!b)return"continue";for(d=!0,b.forEach(function(n){n&&n.display===!1&&(d=!1)}),d||(u._rowHiddenMap[o+a]=!0),rt=!1,b[0]&&b[0].type===64&&(rt=!0),w=0;w<c;w++){var y=b[w],h=o+a,s=w+p;i.setValue(h,s,undefined);y&&y.value!==undefined?(k=y.value,k===null&&(k=n.SR.nullvalue_display),i.setValue(h,s,k),c>=2&&w<l&&(tt=new e(h,s,k),tt.type=y.type?y.type:undefined,f[w].push(tt))):h<v-1+t.getColLevel(r)&&s<l&&f[s].length>0&&(r.data.rowHeader[o][s-1]&&r.data.rowHeader[o][s-1].type||y&&y.type||(g=f[s],ut=g[g.length-1],++ut.rowCount,nt=r.data.rowHeader[o][s+1],nt&&nt.type||(ft=i.getValue(h-1,s),i.setValue(h,s,ft))));et=u._getDataStyle(h,s);i.setStyle(h,s,et);u._setRowHeight(h,s);u._getTotalsRegion(y,h);u._rowHiddenMap[h]&&i.setRowVisible(h,!1,GC.Spread.Sheets.SheetArea.viewport);y&&y.backgroundValue!==undefined&&(it=i.getTag(h,s,GC.Spread.Sheets.SheetArea.viewport)||{},it.backgroundValue=y.backgroundValue,i.setTag(h,s,it,GC.Spread.Sheets.SheetArea.viewport))}},u=this,h=0;h<v;h++)y(h);this.addMergeForRowHeader(f,i)},t.prototype.addMergeForRowHeader=function(t,i){var r=this;Object.keys(t).map(function(n){return t[n]}).forEach(function(t){t.forEach(function(t){var u=t.row,f=t.col,c=t.rowCount,l=t.colCount,e,h;if(t.type){r._mergeRangeRowCount[[u]+"_"+[f]]=1;return}var o=i.getSpans(t),a=o&&o.length>0,v=[n.SR.spread_pivot_table_subtotal,n.SR.spread_pivot_table_grand_total],y=r._getFontSize(),s=new n.NormalColumnHeaderCellType;r._stylesSetByInspector.showPlus&&(s=new n.CollapseHeaderCellType);e=c;v.indexOf(t.text)===-1?(i.setValue(u,f,t.value),i.setCellType(u,f,s,GC.Spread.Sheets.SheetArea.viewport)):e=1;r._mergeRangeRowCount[[u]+"_"+[f]]=e;a||(i.addSpan(u,f,e,l),h=i.getTag(u,f)||{collapse:!1},i.setTag(u,f,h))})})},t.prototype._renderDataPortion=function(n,i){for(var s,r,h,u,f,o,c=i.schema.tableRowLevel,l=t._getDataRowCount(i),a=t._getDataColCount(i),w=this._theme,e=0;e<l;e++)if(s=i.data.data[e],s){for(r=e+0,h=0,u=0;u<a;u++){f=s[u];o=u+c;f&&(typeof f.value=="number"&&isNaN(f.value)||n.setValue(r,o,f.value));var v=r,y=o,p=this._getDataStyle(v,y);n.setStyle(r,o,p)}this._setRowHeight(r,h)}},t.prototype._renderTotalsRegionStyle=function(n,i){var r=this,u=t.getColCount(n);Object.keys(this._totalsRegion).forEach(function(f){var e=parseInt(f,10)===32,o=e&&i.subtotals!==1,s=!e&&(i.grandTotals===4||i.grandTotals===1);(o||!e)&&(s||e)&&r._totalsRegion[f].forEach(function(i){for(var f=0;f<u;++f)r._renderInspectorStyle2Table(i+t.getColLevel(n),f)})})},t.prototype._renderInspectorStyle2Table=function(n,t){var r=this,i;if(this._sheet){if(i=this._theme.getSpreadJSStyle(n,t),!i)return;Object.keys(i).forEach(function(u){var f=r._sheet.getStyle(n,t)||new GC.Spread.Sheets.Style;f[u]=i[u];r._sheet.setStyle(n,t,f)})}},t.prototype._expandCollapseHeader=function(t){if(t.getParent().unbind(GC.Spread.Sheets.Events.CellClick),this._stylesSetByInspector.showPlus){var i=this;t.getParent().bind(GC.Spread.Sheets.Events.CellClick,function(t,r){if(i._isHitOnCollapseIcon(r)){var u=r.sheet,f=r.row,e=r.col,o=r.sheetArea,c=u.getCellType(f,e,o),s=o===GC.Spread.Sheets.SheetArea.viewport&&c instanceof n.CollapseHeaderCellType,h=o===GC.Spread.Sheets.SheetArea.colHeader;if(s||h){u.suspendPaint();u.suspendEvent();try{s&&i._expandCollapseRowHeader(u,f,e);h&&i._expandCollapseColHeader(u,f,e)}finally{u.resumeEvent();u.resumePaint()}}}})}},t.prototype.collapseHeader=function(n,t){this._sheet.suspendPaint();this._sheet.suspendEvent();try{this._collapseRowHeaders(n);this._collapseColHeaders(t)}finally{this._sheet.resumeEvent();this._sheet.resumePaint()}},t.prototype._collapseRowHeaders=function(n){var i,t,r;if(!Forguncy.Common.IsEmpty(n)&&!(n<0)&&!(n>=this._pivotData.schema.tableRowLevel-1)){i=n;for(t in this._mergeRangeRowCount)t.endsWith("_"+n)&&(r=Number(t.split("_")[0]),this.collapseRowHeaderByCode(r,i))}},t.prototype._collapseColHeaders=function(n){var r,t,i,u;if(!Forguncy.Common.IsEmpty(n)&&!(n<0)&&!(n>=this._pivotData.schema.tableColLevel-1)){r=n;t=this._colHeaderCollapseRange[n];for(i in t)u=Number(i),t[i]>0&&this.collapseColHeaderByCode(r,u)}},t.prototype.collapseColHeaderByCode=function(n,t){var i=this._sheet.getTag(n,t,GC.Spread.Sheets.SheetArea.colHeader)||{};i.collapse=!0;this._sheet.setTag(n,t,i,GC.Spread.Sheets.SheetArea.colHeader);this._expandCollapseColHeader(this._sheet,n,t)},t.prototype.collapseRowHeaderByCode=function(t,i){var u=this._sheet.getCellType(t,i,GC.Spread.Sheets.SheetArea.viewport),f=u instanceof n.CollapseHeaderCellType,r;f&&(r=this._sheet.getTag(t,i)||{},r.collapse=!0,this._sheet.setTag(t,i,r),this._expandCollapseRowHeader(this._sheet,t,i))},t.prototype._isHitOnCollapseIcon=function(n){var o=this,f=n.sheet,i=n.row,r=n.col,e=n.sheetArea,u={isHitOnCollapseIcon:!1},t;return e===GC.Spread.Sheets.SheetArea.colHeader?(t=Object.keys(this._colHeaderCollapseRange[i]||{}).filter(function(n){return r>=parseInt(n,10)&&parseInt(n,10)+o._colHeaderCollapseRange[i][n]>=r})[0],t!==undefined&&(t=parseInt(t,10),u=f.getTag(i,t,e))):r<this._pivotData.schema.tableRowLevel&&(u=f.getTag(i,r)),u&&u.isHitOnCollapseIcon},t.prototype._expandCollapseRowHeader=function(n,t,i){var r=this,u=r._mergeRangeRowCount[[t]+"_"+[i]],s,f,l,e,o,h,c;if(!isNaN(u)){if(s=n.getTag(t,i),!s)return;for(f=!s.collapse,l=i+1,e=t;e<t+u-1;++e)for(o=l;o<r._pivotData.schema.tableRowLevel-1;++o)h=n.getTag(e,o)||{},h.collapse=!1,n.setTag(e,o,h);for(r._collapsedRange[t]=u;u;)c=t+u-1,r._rowHiddenMap[c]&&f||n.setRowVisible(c,f,GC.Spread.Sheets.SheetArea.viewport),u-=1;if(r._expandRowHeader(n,f,t,i),f){var a=n.getViewportTopRow(1),y=n.getViewportBottomRow(1),v=a;t+r._collapsedRange[t]===a&&(v=t);n.showRow(v,GC.Spread.Sheets.VerticalPosition.top)}r._showScrollBarOrNot(r._pivotData)}},t.prototype._expandCollapseColHeader=function(n,i,r){var f=this,a=GC.Spread.Sheets.SheetArea.colHeader,u=Object.keys(f._colHeaderCollapseRange[i]||{}).filter(function(n){return r>=parseInt(n,10)&&parseInt(n,10)+f._colHeaderCollapseRange[i][n]>=r})[0],e=f._colHeaderCollapseRange[i]&&f._colHeaderCollapseRange[i][u],l,o,v,s,h,y,p,w,b,k,c;if(e!==undefined){if(u=parseInt(u,10),l=n.getTag(i,u,a),!l)return;if(o=!0,l&&(o=!l.collapse),v=t.getColLevel(f._pivotData),v>2)for(s=i+1;s<v-1;++s)for(h=u;h<u+e;++h)y=n.getTag(s,h,a)||{collapse:!1},y.collapse=!1,n.setTag(s,h,y,a);for(p=e;e;)w=u+e-1,this._colHiddenMap[w]&&o||n.setColumnVisible(w,o,GC.Spread.Sheets.SheetArea.colHeader),e-=1;this._expandColHeader(n,o,u,p,i);o?(b=n.getViewportLeftColumn(1),k=b,parseInt(u,10)+p===b&&(k=parseInt(u,10)),n.showColumn(k,GC.Spread.Sheets.HorizontalPosition.left),f._colSelectCellMap[u]&&(c=f._colSelectCellMap[u],n.setSelection(c.row,c.col,c.rowCount,c.colCount))):f._colSelectCellMap[u]=n.getSelections()[0]}f._showScrollBarOrNot(f._pivotData)},t.prototype._getAllHeaderValue=function(n,t,i,r){for(var c,s,l,e,h,f,o={},a=this._pivotData.data.rowHeader[n],u=0;u<i;u++){if(c=this._pivotData.schema.rowDim[u],e=a[u],e&&!e.type&&e.value!==undefined){o[c.name]=e.value;continue}for(s=n-1,f=undefined;s>=0&&f===undefined;)f=this._pivotData.data.rowHeader[s][u].value,s--;if(f!==undefined){o[c.name]=f;continue}}for(u=0;u<r;u++){if(l=this._pivotData.schema.colDim[u],e=this._pivotData.data.colHeader[u][t],e&&e.value!==undefined){o[l.name]=e.value;continue}for(h=t-1,f=undefined;h>=0&&f===undefined;)f=this._pivotData.data.colHeader[u][h].value,h--;if(f!==undefined){o[l.name]=f;continue}}return o},t.prototype._expandRowHeader=function(n,t,i,r){var h=i+this._collapsedRange[i],c,e,a,l,o,v,y,u,p,f;if(t){for(c=this._rowSubtotalMap.length-1;c>=0;c--)if(e=this._rowSubtotalMap[c],e.row>=i&&e.row<=h){for(u=n.getSpan(e.row,e.col),u&&(n.removeSpan(u.row,u.col),u.rowCount-=1,n.addSpan(u.row,u.col,u.rowCount,u.colCount)),this._rowHiddenMap[e.subTotalRow]&&n.setRowVisible(e.subTotalRow,!1,GC.Spread.Sheets.SheetArea.viewport),f=r;f<n.getColumnCount();f++){for(a=this._getDataStyle(e.subTotalRow,f),l=0;l<this._colSubtotalMap.length;l++)o=this._colSubtotalMap[l],f>=o.col+o.firstCol&&f<o.col+o.firstCol+o.measuresLength&&(a=this._getDataStyle(e.subTotalRow,o.col));v=n.getStyle(e.subTotalRow,f);y=this.copyStyleBorder(v,a);n.setStyle(e.subTotalRow,f,y)}this._rowSubtotalMap.splice(c,1)}}else{for(u=n.getSpan(i,r),u?n.removeSpan(u.row,u.col):u=new GC.Spread.Sheets.Range(i,r,1,1),u.rowCount+=1,p=new s(i,r),p.subTotalRow=h,this._rowHiddenMap[h]&&n.setRowVisible(h,!0,GC.Spread.Sheets.SheetArea.viewport),f=r+1;f<n.getColumnCount();f++){var v=n.getStyle(h,f),w=f<this._pivotData.schema.tableRowLevel?n.getStyle(i,this._pivotData.schema.tableRowLevel-1):n.getStyle(i,f),y=this.copyStyleBorder(v,w);n.setStyle(h,f,y)}this._rowSubtotalMap.push(p);n.addSpan(u.row,u.col,u.rowCount,u.colCount)}},t.prototype._expandColHeader=function(t,i,r,u,f){var d=r+u,l=this._pivotData.schema.measureLength,tt=t.getRowCount(),it=GC.Spread.Sheets.SheetArea.colHeader,a,h,y,p,nt,v,e,o,w,b,k;if(i){for(a=this._colSubtotalMap.length-1;a>=0;a--)if(h=this._colSubtotalMap[a],h.col>=r&&h.col<r+u+l-1){if(this._colHiddenMap[d])for(e=0;e<h.measuresLength;e++)v=h.col+h.firstCol+e,t.setColumnVisible(v,!1,GC.Spread.Sheets.SheetArea.colHeader);for(e=0;e<l;e++)for(o=0;o<tt;o++){var c=h.col+h.firstCol+e,rt=t.getStyle(o,c),g=this._getDataStyle(o,c);for(y=0;y<this._rowSubtotalMap.length;y++)p=this._rowSubtotalMap[y],o===p.row+p.subTotalRow&&(g=this._getDataStyle(p.row,c));nt=this.copyStyleBorder(rt,g);t.setStyle(o,c,nt)}w=h.row+1;b=h.col+h.firstCol;t.setText(w,b,n.SR.spread_pivot_table_subtotal,it);this._colSubtotalMap.splice(a,1)}}else{if(this._colHiddenMap[d])for(e=0;e<l;e++)v=d+e,t.setColumnVisible(v,!0,GC.Spread.Sheets.SheetArea.colHeader);for(e=0;e<l;e++)for(o=0;o<tt;o++){var c=r+u+e,rt=t.getStyle(o,c),g=t.getStyle(o,r+e),nt=this.copyStyleBorder(rt,g);t.setStyle(o,c,nt)}w=f+1;b=r+u;t.setText(w,b,"",it);k=new s(f,r);k.firstCol=u;k.measuresLength=l;this._colSubtotalMap.push(k)}},t.prototype.copyStyleBorder=function(n,t){return t=t?t.clone():new GC.Spread.Sheets.Style,n&&(t.borderLeft=this.cloneBorder(n.borderLeft),t.borderRight=this.cloneBorder(n.borderRight),t.borderTop=this.cloneBorder(n.borderTop),t.borderBottom=this.cloneBorder(n.borderBottom)),t},t.prototype.cloneBorder=function(n){return n?new GC.Spread.Sheets.LineBorder(n.color,n.style):undefined},t.prototype.mergeCells=function(n,t,i,r,u,f){var e=n.getSpans(new GC.Spread.Sheets.Range(t,i,r,u),f);e.forEach(function(t){n.removeSpan(t.row,t.col,f)});(r>1||u>1)&&n.addSpan(t,i,r,u,f)},t.prototype.getTableWidth=function(n){for(var u=this._sheet,r=0,f=t.getColCount(n),e=GC.Spread.Sheets.SheetArea.viewport,i=0;i<f;++i)r+=u.getColumnWidth(i,e);return r},t.prototype.getTableHeight=function(n){for(var e,i,f=this._sheet,r=0,o=t.getRowCount(n),s=t.getColLevel(n),u=0;u<s;++u)r+=f.getRowHeight(u,GC.Spread.Sheets.SheetArea.colHeader);for(e=GC.Spread.Sheets.SheetArea.viewport,i=0;i<o;++i)r+=f.getRowHeight(i,e);return r},t.prototype._getTotalsRegion=function(n,t){if(n)[32,64,96].indexOf(n.type)>-1&&this._totalsRegion[n.type].indexOf(t)===-1&&this._totalsRegion[n.type].push(t)},t.prototype._setRowHeight=function(n,t,i){isNaN(this._stylesSetByInspector.rowHeight)||this._sheet.setRowHeight(n,this._stylesSetByInspector.rowHeight,i)},t.prototype._getFontSize=function(){var n=this._stylesSetByInspector.font.split(" "),t=i.defaultFontSize;return n&&!isNaN(parseInt(n[0],10))&&(t=n[0]),t},t.prototype.autoResizeColumn=function(n,i){var s=this;n.suspendEvent();try{for(var e=n.getParent(),u=[],f=t.getColCount(i),o=i.schema.tableRowLevel,r=0;r<o&&r<f;r++)n.setColumnWidth(r,this._stylesSetByInspector.rowHeaderColumnWidth);for(;r<f;r++)this._stylesSetByInspector.isAutofitColumn?u.push({col:r}):n.setColumnWidth(r,this._stylesSetByInspector.columnWidth);u.length>0&&e.commandManager().execute({cmd:"autoFitColumn",sheetName:n.name()||"Sheet1",columns:u,isRowHeader:!0,autoFitType:GC.Spread.Sheets.AutoFitType.cellWithHeader})}finally{n.resumeEvent()}},t.prototype._getPivotRanges=function(i,r){for(var f,s,l,a=i.schema.tableRowLevel,v=t._getDataRowCount(i),y=t._getDataColCount(i),o={},e=0;e<y;++e)for(f=0;f<v;++f)if(s=i.data.data[f],s){var u=s[e],h=f+0,c=e+a;u||(l=this._getCellPositionInPivotTable(h,c,i),l&&(u=new n.TableDataCell,u.displayName=l.displayName));u&&(r===undefined&&u.type===undefined?this._getPivotRangesCore(u,h,c,o):(u.type&r)>0&&this._getPivotRangesCore(u,h,c,o))}return o},t.prototype.getCurrentGroupLastCelRowIndex=function(n){return n.row+n.rowCount-1},t.prototype._getPivotRangesCore=function(n,t,i,r){var u=n.displayName,f,e;r[u]===undefined?r[u]=[new GC.Spread.Sheets.Range(t,i,1,1)]:(f=r[u][r[u].length-1],e=this.getCurrentGroupLastCelRowIndex(f),t-e==1?f.rowCount+=1:r[u].push(new GC.Spread.Sheets.Range(t,i,1,1)))},t.prototype._getCellPositionInPivotTable=function(n,t,i){var e=n,o=t-i.schema.tableRowLevel,f,r,u;return i.data.rowHeader&&i.data.rowHeader[e]&&(r=i.data.rowHeader[e].slice(-1)[0]),i.data.colHeader&&(u=i.data.colHeader.map(function(n){return n[o]}).slice(-1)[0]),u?f={path:u.path,displayName:u.displayName}:r&&(f={path:r.path,displayName:r.displayName}),f},t._getDataRowCount=function(n){var t=n.data.data.length,i=n.data.rowHeader.length;return Math.max(t,i)},t._getDataColCount=function(n){var t=n.data.data.reduce(function(n,t){return Math.max(n,t.length)},0),i=n.data.colHeader.reduce(function(n,t){return Math.max(n,t.length)},0);return Math.max(t,i)},t.prototype.setTheme=function(n){this._theme=n},t.getRowCount=function(n){return this._getDataRowCount(n)+t.getColLevel(n)},t.getColCount=function(n){return n.schema.tableRowLevel+this._getDataColCount(n)},t.getColLevel=function(n){return n.schema.tableColLevel+n.schema.valueLevel},t.prototype.getPivotValueRanges=function(n){return this._pivotValueRanges||(this._pivotValueRanges=this._getPivotRanges(this._pivotData,undefined)),this._pivotValueRanges[n]},t.prototype.getPivotSubtotalRanges=function(n){return this._pivotSubtotalRanges||(this._pivotSubtotalRanges=this._getPivotRanges(this._pivotData,32)),this._pivotSubtotalRanges[n]},t.prototype.getPivotGrandtotalRanges=function(n){return this._pivotGrandtotalRanges||(this._pivotGrandtotalRanges=this._getPivotRanges(this._pivotData,64)),this._pivotGrandtotalRanges[n]},t.prototype._showScrollBarOrNot=function(n){if(this._sheet){var t=this._sheet.getParent(),u=t.getHost(),f=u.offsetWidth||this._sheet.getViewportWidth(1),e=u.offsetHeight||this._sheet.getViewportHeight(1),o=this.getTableWidth(n),s=this.getTableHeight(n),i=o>f,r=s>e;i&&(r=s+15>e);r&&(i=o+15>f);t.options.showHorizontalScrollbar=i;t.options.showVerticalScrollbar=r}},t.prototype._getHeaderStyle=function(n,t){return this._theme.getSpreadJSStyle(n,t)},t.prototype._getDataStyle=function(n,i){return this._theme.getSpreadJSStyle(n+t.getColLevel(this._pivotData),i)},t.prototype.setInspectorStyles=function(n){this._stylesSetByInspector=n;this._stylesSetByInspector.font=i._getFontStr(this._stylesSetByInspector.wholeTable,this._stylesSetByInspector.font)},t.prototype.getInspectorStyles=function(){return this._stylesSetByInspector},t}();n.PivotTable=f;u=function(){function n(){}return n.ConvertCssRuleToBorderLine=function(n){var t=this.ConvertCssRuleToBorderProps(n),i;return t?(i=GC.Spread.Sheets.LineStyle.empty,t.BorderWidth==1?t.BorderStyle==r.solid?i=GC.Spread.Sheets.LineStyle.thin:t.BorderStyle==r.dashed?i=GC.Spread.Sheets.LineStyle.dashed:t.BorderStyle==r.dotted&&(i=GC.Spread.Sheets.LineStyle.dotted):t.BorderWidth==2?t.BorderStyle==r.solid?i=GC.Spread.Sheets.LineStyle.medium:t.BorderStyle==r.dashed&&(i=GC.Spread.Sheets.LineStyle.mediumDashed):t.BorderWidth>=3&&(t.BorderStyle==r.solid?i=GC.Spread.Sheets.LineStyle.thick:t.BorderStyle==r.double&&(i=GC.Spread.Sheets.LineStyle.double)),new GC.Spread.Sheets.LineBorder(t.BorderColor,i)):null},n.ConvertCssRuleToBorderProps=function(n){var i=this,u,t;if(n)return u=n.trim().split(" "),t=new h,u.forEach(function(n){var u=n.toLowerCase(),f,e,o;i.IsWidthString(u)?u.endsWith("px")&&(f=parseFloat(u.substr(0,u.length-2)),isNaN(f)||(t.BorderWidth=f)):i.IsBorderStyleString(u)?(e=r[u],e!==undefined&&(t.BorderStyle=e)):(o=n,o!=null&&(t.BorderColor=c.Convert(o.replace(/_/g," "))))}),t},n.IsWidthString=function(n){return this._matchWidthString.test(n)||this._matchWidthKeywordString.test(n)},n.IsBorderStyleString=function(n){return this._matchBorderStyleString.test(n)},n._matchBorderStyleString=new RegExp("^(none|hidden|dotted||solid|dashed|double|groove|ridge|inset|outset)$","g"),n._matchWidthString=new RegExp("^([1-9][0-9]*)+(.[0-9]{1,2})?(px|cm|mm|in|pc|pt|em|rem|ch|ex|vh|vw|vmin|vmax)$","g"),n._matchWidthKeywordString=new RegExp("^(thin|medium|thick|inherit|initial|unset)$","g"),n}();h=function(){function n(){}return n}(),function(n){n[n.none=0]="none";n[n.double=1]="double";n[n.hidden=2]="hidden";n[n.dotted=3]="dotted";n[n.solid=4]="solid";n[n.dashed=5]="dashed";n[n.groove=6]="groove";n[n.ridge=7]="ridge";n[n.inset=8]="inset";n[n.outset=9]="outset"}(r||(r={}))})(PivotData||(PivotData={}))
;var Forguncy;(function(n){var t=function(){function n(n,t,i,r,u,f){this.label=n;this.header=t;this.columnIndex=i;this.backgroundLabel=r;this.backgroundValue=u;this.backgroundValueColumnIndex=f}return n}(),i,r;n.PivotTableHeaderInfo=t;i=function(){function n(n,t,i,r,u,f){this.dataType=n;this.row=t;this.col=i;this.value=r;this.colHeaders=u;this.rowHeaders=f}return n}();n.PivotTableEventParameter=i;r=function(){function r(n,t,i){this._sheet=n;this._cellTypeMetaData=t;this._pivotTableSetting=t.PivotTableSetting;this._listview=i;this._rowHeaderOffset=0;i.isRowHeaderVisible()&&this._rowHeaderOffset++;i.isRowHeaderCheckBoxVisible()&&this._rowHeaderOffset++}return r.prototype.bindingPivotTableClickEvent=function(t,r,u){var s=this._sheet,f=this.getClickCellAreaType(t,u),e=this,o=new i(f,t.row,this.getColForClickEvent(t.col,f),s.getValue(t.row,t.col,t.sheetArea),e.getColHeaders(t.col),e.getRowHeaders(t.row,n.PivotTableClickCell[f]));r.trigger("pivottableclick",o);r.trigger("pivottablecommand",o)},r.prototype.getClickCellAreaType=function(t,i){var e=this._cellTypeMetaData,u=this._pivotTableSetting,o=u.Rows?u.Rows.length:0,s=1;u.Values&&(s=u.Values.length);var c=e.ShowRowsTotal,h=e.ShowColsTotal,f=this._sheet,r=n.PivotTableClickCell.Data;return i&&(r=n.PivotTableClickCell.Subtotal),t.sheetArea===GC.Spread.Sheets.SheetArea.colHeader?(r=n.PivotTableClickCell.ColHeader,t.col<=o-1&&(r=n.PivotTableClickCell.FirstCell)):t.col<=o-1?r=n.PivotTableClickCell.RowHeader:c&&t.col>=f.getColumnCount()-s?r=h&&t.row>=f.getRowCount()-1?n.PivotTableClickCell.GrandTotal:n.PivotTableClickCell.RowTotal:h&&t.row>=f.getRowCount()-1&&(r=n.PivotTableClickCell.ColTotal),r},r.prototype.getColForClickEvent=function(t,i){if(i!==n.PivotTableClickCell.FirstCell&&i!==n.PivotTableClickCell.RowHeader){var r=this._cellTypeMetaData.PivotTableSetting,u=r.Rows?r.Rows.length:0;return t-u}return t},r.prototype.writeDataToSpreadView=function(n){return this.writeData(n.row,n.col,n.oldValue,n.newValue),[{Row:n.row,Column:n.col}]},r.prototype.clearCellByDeleteKey=function(n){var r,i,t;if(n.action===GC.Spread.Sheets.RangeChangedAction.clear&&n.changedCells.length>0){for(r=[],i=0;i<n.changedCells.length;i++)t=n.changedCells[i],r.push({Row:t.row,Column:t.col}),this.writeData(t.row,t.col,null,null,!1);return r}return null},r.prototype.writeData=function(t,i,r,u,f){var s,l;f===void 0&&(f=!0);var e=this.getColHeaders(i),h=this.getRowHeaders(t),a=this.getHeaderDataIndexs(e,h),c=this.getValueColumnIndex(e),o=this._listview.getMergedColumnInfos()[c];u&&o&&(o.ColumnDataType===n.ColumnDataType.Date||o.ColumnDataType===n.ColumnDataType.Time)&&(s=this.tryConvertOADateToDate(u),s instanceof Date&&(u=n.ConvertDateToOADate(s)));l=this.createNewData(e,h,u);this.writeDataToListView(l,a,c,r,u,f)},r.prototype.tryConvertOADateToDate=function(t){var i,u;return typeof t=="string"&&t.startsWith("/")&&(i=void 0,r._jsonOADateRegExp.test(t)?(i=t.match(r._jsonOADateRegExp),t=n.ConvertOADateToDate(parseFloat(i[1]))):r._jsonDateRegExp.test(t)&&(i=t.match(r._jsonDateRegExp),t=new Date(parseFloat(i[1])))),typeof t=="string"&&(u=new Date(t),isNaN(u.valueOf())||(t=u)),t},r.prototype.writeDataToListView=function(n,t,i,r,u,f){var e,o;f===void 0&&(f=!0);e=n.slice();e[i]=r;o=this.indexOfListView(e,t);o===-1?f&&(this._listview.addNewRow(n),this._listview.selectRow(this._listview.getRowCount()-1)):this._listview.setValue(o,i,u);this._listview.getDataCommitMode()===0&&this._listview.commitEditChange()},r.prototype.getHeaderDataIndexs=function(n,t){var i=[];return t.forEach(function(n){i.push(n.columnIndex);n.backgroundValueColumnIndex>=0&&i.push(n.backgroundValueColumnIndex)}),n.forEach(function(n){n.columnIndex>=0&&i.push(n.columnIndex);n.backgroundValueColumnIndex>=0&&i.push(n.backgroundValueColumnIndex)}),i},r.prototype.createNewData=function(n,t,i){var r=[],f,u;if(t.forEach(function(n){r[n.columnIndex]=n.header;n.backgroundValueColumnIndex!==undefined&&(r[n.backgroundValueColumnIndex]=n.backgroundValue)}),f=this._pivotTableSetting.Values,f.length>1){for(u=0;u<n.length-1;u++)r[n[u].columnIndex]=n[u].header,n[u].backgroundValueColumnIndex!==undefined&&(r[n[u].backgroundValueColumnIndex]=n[u].backgroundValue);f.forEach(function(t){t.DatabaseColumnName===n[n.length-1].header&&(r[t.ListViewColumnIndex]=i)})}else n.forEach(function(n){r[n.columnIndex]=n.header;n.backgroundValueColumnIndex!==undefined&&(r[n.backgroundValueColumnIndex]=n.backgroundValue)}),r[f[0].ListViewColumnIndex]=i;return r},r.prototype.getValueColumnIndex=function(n){var t=-1,i=this._pivotTableSetting.Values;return i.length>1?i.forEach(function(i){i.DatabaseColumnName===n[n.length-1].header&&(t=i.ListViewColumnIndex)}):t=i[0].ListViewColumnIndex,t},r.prototype.indexOfListView=function(n,t){for(var u,i,f=this._listview.getRowCount(),r=0;r<f;r++){for(u=!0,i=0;i<t.length;i++)if(!this.isValueEquals(this._listview.getValue(r,t[i]),n[t[i]])){u=!1;break}if(u)return r}return-1},r.prototype.isValueEquals=function(t,i){return t===i?!0:(t instanceof Date&&(t=n.ConvertDateToOADate(t)),i instanceof Date&&(i=n.ConvertDateToOADate(i)),t===i)},r.prototype.updateListViewSelection=function(n){var t=n.newSelections[0],i=this.getColHeaders(t.col),u=this.getRowHeaders(t.row),e=this.createNewData(i,u,this._sheet.getValue(t.row,t.col)),o=this.getHeaderDataIndexs(i,u),f=this.getValueColumnIndex(i),r=this.indexOfListView(e,o);r!==-1&&f!==-1&&(this._listview.selectRow(r),this._listview.setSelection(r,f-this._rowHeaderOffset))},r.prototype.getColHeaders=function(n){var o=this._sheet,u=this._pivotTableSetting.Cols,s=[],h=0,i,f,e,c;if(u&&u.length>0)for(h=u.length,i=0;i<h;i++){var r=u[i],l=void 0,a=void 0,v=void 0;r.BackgroundValue&&(l=r.BackgroundValue.DatabaseColumnName,f=this.getTagFromSheet(this._sheet,i,n,GC.Spread.Sheets.SheetArea.colHeader),a=f===null||f===void 0?void 0:f.backgroundValue,v=r.BackgroundValue.ListViewColumnIndex);e=this.getValueFromSheet(o,i,n,GC.Spread.Sheets.SheetArea.colHeader);e===PivotData.SR.nullvalue_display&&(e=null);s.push(new t(r.DatabaseColumnName,e,r.ListViewColumnIndex,l,a,v))}return c=o.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),c>h&&s.push(new t("ValueHeader",this.getValueFromSheet(o,c-1,n,GC.Spread.Sheets.SheetArea.colHeader),-1)),s},r.prototype.getRowHeaders=function(i,r){var p=this._sheet,e=this._pivotTableSetting.Rows,c=[],o,l,u,s,h;if(!e||e.length===0)return c;for(o=GC.Spread.Sheets.SheetArea.viewport,r===n.PivotTableClickCell.ColHeader&&(o=GC.Spread.Sheets.SheetArea.colHeader),l=e.length,u=0;u<l;u++){var f=e[u],a=void 0,v=void 0,y=void 0;f.BackgroundValue&&(a=f.BackgroundValue.DatabaseColumnName,s=this.getTagFromSheet(this._sheet,i,u,o),v=s===null||s===void 0?void 0:s.backgroundValue,y=f.BackgroundValue.ListViewColumnIndex);h=this.getValueFromSheet(p,i,u,o);h===PivotData.SR.nullvalue_display&&(h=null);c.push(new t(f.DatabaseColumnName,h,f.ListViewColumnIndex,a,v,y))}return c},r.prototype.getValueFromSheet=function(n,t,i,r){var u=n.getSpans(new GC.Spread.Sheets.Range(t,i,1,1),r);return u&&u.length>0?n.getValue(u[0].row,u[0].col,r):n.getValue(t,i,r)},r.prototype.getTagFromSheet=function(n,t,i,r){var u=n.getSpans(new GC.Spread.Sheets.Range(t,i,1,1),r);return u&&u.length>0?n.getTag(u[0].row,u[0].col,r):n.getTag(t,i,r)},r._jsonDateRegExp=new RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),r._jsonOADateRegExp=new RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),r}();n.PivotTableEventHandler=r})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){function r(n){var t;return t=typeof n=="string"?parseFloat(n):n,t*s}var i,u,t,o,e,s;(function(n){n[n.Other=0]="Other";n[n.Number=1]="Number";n[n.Bool=2]="Bool";n[n.Date=3]="Date";n[n.Time=4]="Time";n[n.String=5]="String";n[n.Image=6]="Image";n[n.Attachment=7]="Attachment";n[n.User=8]="User"})(i||(i={})),function(n){n.FirstCell="FirstCell";n.ColHeader="ColHeader";n.RowHeader="RowHeader";n.Data="Data";n.Subtotal="Subtotal";n.ColTotal="ColTotal";n.RowTotal="RowTotal";n.GrandTotal="GrandTotal"}(u=n.PivotTableClickCell||(n.PivotTableClickCell={})),function(n){n[n.sum=0]="sum";n[n.avg=1]="avg";n[n.cnt=2]="cnt";n[n.dst=3]="dst";n[n.max=4]="max";n[n.min=5]="min";n[n.first=6]="first";n[n.last=7]="last";n[n.custom=8]="custom";n[n.none=9]="none"}(t||(t={}));o=0;e=function(e){function s(t,i,r,u){var f=this,s;return n.ForguncyData.GlobalSettings.MultipleLanguageSettings.EnableMultipleLanguage&&(t.CellType.PivotTableSetting.Rows&&(t.CellType.PivotTableSetting.Rows=t.CellType.PivotTableSetting.Rows.map(function(n){return f.translatePivotTableColumnInfoModel(n)})),t.CellType.PivotTableSetting.Cols&&(t.CellType.PivotTableSetting.Cols=t.CellType.PivotTableSetting.Cols.map(function(n){return f.translatePivotTableColumnInfoModel(n)})),t.CellType.PivotTableSetting.Values&&(t.CellType.PivotTableSetting.Values=t.CellType.PivotTableSetting.Values.map(function(n){return f.translatePivotTableColumnInfoModel(n)})),((s=t.CellType.PivotTableConditionalFormatSetting)===null||s===void 0?void 0:s.Conditions)&&(t.CellType.PivotTableConditionalFormatSetting.Conditions=t.CellType.PivotTableConditionalFormatSetting.Conditions.map(function(t){return __assign(__assign({},t),{Label:n.Common.getMultiLanguageWord(t.Label)})})),t.CellType.PivotTableClickCommand&&(t.CellType.PivotTableClickCommand.RowHeaderList&&(t.CellType.PivotTableClickCommand.RowHeaderList=t.CellType.PivotTableClickCommand.RowHeaderList.map(function(t){return __assign(__assign({},t),{Label:n.Common.getMultiLanguageWord(t.Label)})})),t.CellType.PivotTableClickCommand.ColumnHeaderList&&(t.CellType.PivotTableClickCommand.ColumnHeaderList=t.CellType.PivotTableClickCommand.ColumnHeaderList.map(function(t){return __assign(__assign({},t),{Label:n.Common.getMultiLanguageWord(t.Label)})})),t.CellType.PivotTableClickCommand.CellValueList&&(t.CellType.PivotTableClickCommand.CellValueList=t.CellType.PivotTableClickCommand.CellValueList.map(function(t){return __assign(__assign({},t),{Label:n.Common.getMultiLanguageWord(t.Label)})})))),f=e.call(this,t,i,r,u)||this,f._pivotTableCalcSourceIndex=0,f.loadingIndicator=null,f.cover=null,f._pivotTableCalcSourceIndex=o++,PivotData.setCulture(),f.supportedEvents=["pivottableclick","pivottablecommand"],f}return __extends(s,e),s.prototype.translatePivotTableColumnInfoModel=function(t){return __assign(__assign({},t),{DisplayName:n.Common.getMultiLanguageWord(t.DisplayName),DatabaseColumnName:n.Common.getMultiLanguageWord(t.DatabaseColumnName),BackgroundValue:t.BackgroundValue?__assign(__assign({},t.BackgroundValue),{DatabaseColumnName:n.Common.getMultiLanguageWord(t.BackgroundValue.DatabaseColumnName)}):null})},s.setCustomFunction=function(n,t){s.customFunctions[n]=t},s.prototype._canStretch=function(){var t=this._getPageLayout(),n=this._getPageStretchInfo();return(n===null||n===void 0?void 0:n.StretchMode)!==0||t.possibleStretch(this.CellElement.Layout)?!0:!1},s.prototype._getPageStretchInfo=function(){return n.PageManager.getPageStretchInfo(this.runTimePageName)},s.prototype._getPageLayout=function(){return n.PageManager.getPageLayout(this.runTimePageName)},s.prototype.createContent=function(){var n,t,i;return!this.IsShouldPreview()&&this._canStretch()?(n="100%",t="100%"):(n=this.CellElement.Width+"px",t=this.CellElement.Height+"px"),this.IsShouldPreview()&&(i=$(this._pivotTableDomCssSelector()),i&&i.remove()),$('<div id="'.concat(this.ID,'" pivottableid="').concat(this.getPivotTableID(),'" style="width:').concat(n,";height:").concat(t,'" ><\/div>'))},s.prototype.getTabIndexDom=function(){return this.getContainer().find("[gcuielement=gcSheetFocusElementForTab]")},s.prototype.getPivotTableID=function(){return this.IsShouldPreview()?this.ID:n.Page.getPageName()+"_"+this.ID},s.prototype.IsShouldPreview=function(){var n=this.getPivotTableSetting();return n.hasOwnProperty("IsPreviewing")&&n.IsPreviewing},s.prototype.onWindowResized=function(){var n;!this.IsShouldPreview()&&this._canStretch()?(n=$(this._pivotTableDomCssSelector()),n.css("width","100%"),n.css("height","100%")):(n=$(this._pivotTableDomCssSelector()),n.css("width",n.parent().width()+"px"),n.css("height",n.parent().height()+"px"));this._spread&&this._sheet&&(this._spread.refresh(),this.showScrollBarOrNot())},s.prototype._getlistview=function(){var t=this.CellElement.CellType.PivotTableSetting.SelectedListViewName;return n.ListviewBase.getListview(t,this.runTimePageName)},s.prototype.onLoad=function(){var u=this,o=this.getContainer(),i,t,r,f,e;(o.css("overflow","hidden"),i=this.CellElement.CellType,t=i.PivotTableSetting,n.Common.IsEmpty(t))||this.IsShouldPreview()||(r=this._getlistview(),r)&&(t.original_IsFillFormMode=t.IsFillFormMode,i.original_EditAndUpdate=i.EditAndUpdate,r.allowEdit()||(t.IsFillFormMode=!1,i.EditAndUpdate=!1),r.bind("valuechanged",function(){u.paintPivotTable()}),r.bind("listviewDataChanged",function(){var e=t.IsFillFormMode,o=i.EditAndUpdate,n=t.original_IsFillFormMode,f=i.original_EditAndUpdate;r.allowEdit()||(n=!1,f=!1);(e!==n||o!==f)&&(t.IsFillFormMode=n,i.EditAndUpdate=f,u.paintPivotTable())}),t.ColumnMaster&&(f=this.getListView(t.ColumnMaster),f.bind("valuechanged",function(){u.paintPivotTable()})),t.RowMaster&&(e=this.getListView(t.RowMaster),e.bind("valuechanged",function(){u.paintPivotTable()})))},s.prototype._pivotTableDomCssSelector=function(){return"#".concat(this.ID,'[pivottableid="').concat(this.getPivotTableID(),'"]')},s.prototype._getRowHeaderColumnCount=function(){var n=this.CellElement.CellType.PivotTableSetting;return n.Rows?n.Rows.length:0},s.prototype.donotNeedRepaint=function(n){return this.CellElement.CellType.EditAndUpdate?!1:!n||n.length===0?!1:!0},s.prototype.paintPivotTable=function(){var f=this,t=this,u=this.CellElement,r=u.CellType,i=r.PivotTableSetting;if(!i.Values||i.Values.length===0){t.destroySpreadJS();return}if(this.donotNeedRepaint(this._changedCells)){this.autoFitChangedColumns(r.PivotTableStyle,this._changedCells);return}t.showLoadingIndicator();n.DelayRefresh.Push(null,function(){var v,h=t._changedCells,g=(h===null||h===void 0?void 0:h.length)>0,y,k,e,o,d,a,p,s;if(t._changedCells=null,f.donotNeedRepaint(h)){t.autoFitChangedColumns(r.PivotTableStyle,h);t.hiddenLoadingIndicator();return}var w=new c(t._sheet,t._getRowHeaderColumnCount()),b=!0,nt=i.SelectedListViewName,l=t.getListView(nt);if(l!==null){if(t.preprocessColumnInfo(l,i),y=t.getTableData(l,i),t.isDataSetEmpty(y)){t.hiddenLoadingIndicator();t.destroySpreadJS();t._headerValuesCache=null;return}if(k=t.updateSetting(y,i,l),t.createSpreadJS(i),e=t._sheet,e.suspendPaint(),n.Page.suspendCalc(),e.suspendDirty(),e.suspendEvent(),o=new PivotData.PivotTable,d=t.setTableOptions(o,r),t.applyStyle(o,r,(v=u.StyleTemplate)===null||v===void 0?void 0:v.Styles),a=k.getData(18,d),!a){t.hiddenLoadingIndicator();t.destroySpreadJS();t._headerValuesCache=null;return}try{t.setFormatterForHeader(i,e);o.render(e,a);p=t.getConditionalFormatHandler().applyConditionalFormat(o);p&&t.addDependenceHandler(p);t.adjustColumnWidth(r.PivotTableStyle,o);t.setFrozenColumnCount(o,i);b=t.refreshPivotTableStatus(o,a,w,r.PivotTableStyle);t.bindEventInSheet(e,o,i);t.setTabIndexToElement(t.getElementTabIndex())}finally{e.resumePaint();n.Page.resumeCalc();e.resumeDirty();e.resumeEvent();t.IsShouldPreview()&&e.clearSelection();t.showScrollBarOrNot();b||w.restoreScrollBar(e);t.hiddenLoadingIndicator();t.IsShouldPreview()||(s=t._getlistview(),(s===null||s===void 0?void 0:s.isFocused)?(s.focus(!0),s instanceof n.SpreadJSView&&s.canEditInListview()&&s.getAlwaysInEditMode()&&s.getSheet().startEdit(!0)):g&&t._sheet.getParent().focus(!0))}t.executeClickCommand(r.PivotTableClickCommand,o,i)}},"paintPivotTable"+this.ID)},s.prototype.refreshPivotTableStatus=function(n,t,i,r){var u=new h(t),f=!h.equals(this._headerValuesCache,u);return f?this.collapseByDefault(n):i.restore(this._sheet,n,r),this._headerValuesCache=u,f},s.prototype.setFrozenColumnCount=function(t,i){var r=0;i.ForceFrozenRowHeader?r=t._pivotData.schema.tableRowLevel:n.Common.IsEmpty(i.FrozenColumnIndex)||(r=i.FrozenColumnIndex+1);r>0&&this._sheet.frozenColumnCount(r)},s.prototype.getPivot=function(){var n=this.getPivotTableSetting(),u=this.getSelectedListViewName(),t=this.getListView(u),i,r;return this.preprocessColumnInfo(t,n),i=this.getTableData(t,n),r=this.updateSetting(i,n,t),r},s.prototype.getSelectedListViewName=function(){var n=this.getPivotTableSetting();return n.SelectedListViewName},s.prototype.getPivotTableSetting=function(){var n=this.CellElement,t=n.CellType;return t.PivotTableSetting},s.prototype.useSimpleBar=function(){var n;return!!((n=this.CellElement.CellType.PivotTableStyle)===null||n===void 0?void 0:n.UseSimpleBar)},s.prototype.showScrollBarOrNot=function(){var n;if(this._sheet){if(n=this._sheet.getParent(),this.IsShouldPreview()){n.options.showHorizontalScrollbar=!1;n.options.showVerticalScrollbar=!1;return}var r=$(n.getHost()),u=r.width()||this._sheet.getViewportWidth(1),f=r.height()||this._sheet.getViewportHeight(1),e=this.getTableWidth(),o=this.getTableHeight(),t=e>u,i=o>f;this.useSimpleBar()||(t&&(i=o+15>f),i&&(t=e+15>u));n.options.showHorizontalScrollbar=t;n.options.showVerticalScrollbar=i}},s.prototype.getTableWidth=function(){for(var t=this._sheet,i=0,r=t.getColumnCount(),u=GC.Spread.Sheets.SheetArea.viewport,n=0;n<r;++n)i+=t.getColumnWidth(n,u);return i},s.prototype.getTableHeight=function(){for(var t,n=this._sheet,i=0,u=n.getRowCount(),f=n.getRowCount(GC.Spread.Sheets.SheetArea.colHeader),r=0;r<f;++r)i+=n.getRowHeight(r,GC.Spread.Sheets.SheetArea.colHeader);for(t=0;t<u;++t)i+=n.getRowHeight(t);return i},s.prototype.getConditionalFormatHandler=function(){var t=this.CellElement.CellType;return new n.PivotTableConditionalFormat(t,this.CellElement.StyleInfo,this._sheet,this.getPivotTableCalcSourceName(),this.runTimePageName)},s.prototype.getPivotTableFillHandler=function(){var t=this.CellElement.CellType;return new n.PivotTableEventHandler(this._sheet,t,this.getListView(t.PivotTableSetting.SelectedListViewName))},s.prototype.bindEventInSheet=function(n,t,i){var r=this,u,f;n.unbind(GC.Spread.Sheets.Events.ColumnWidthChanged);n.bind(GC.Spread.Sheets.Events.ColumnWidthChanged,function(){r.showScrollBarOrNot()});n.unbind(GC.Spread.Sheets.Events.RowHeightChanged);n.bind(GC.Spread.Sheets.Events.RowHeightChanged,function(){r.showScrollBarOrNot()});n.bind(GC.Spread.Sheets.Events.CellClick,function(n,u){var f=r.getPivotTableSubtotalAreaRanges(t,i),e=r.isCellInValueArea(f,u.row,u.col);r.getPivotTableFillHandler().bindingPivotTableClickEvent(u,r,e)});u=i;f=r.getPivotTableValueAreaRanges(t,u);n.unbind(GC.Spread.Sheets.Events.EditStarting);n.bind(GC.Spread.Sheets.Events.EditStarting,function(n,t){r.canCellEnterEditMode(u,t.row,t.col)||(t.cancel=!0);r.isCellInValueArea(f,t.row,t.col)||(t.cancel=!0)});n.unbind(GC.Spread.Sheets.Events.EditStarted);n.bind(GC.Spread.Sheets.Events.EditStarted,function(){$("[gcuielement=gcEditingInput]").parent().parent().css("background-color","white")});n.unbind(GC.Spread.Sheets.Events.ValueChanged);n.bind(GC.Spread.Sheets.Events.ValueChanged,function(n,t){r._changedCells=r.getPivotTableFillHandler().writeDataToSpreadView(t)});n.unbind(GC.Spread.Sheets.Events.RangeChanged);n.bind(GC.Spread.Sheets.Events.RangeChanged,function(n,t){r._changedCells=r.getPivotTableFillHandler().clearCellByDeleteKey(t)});i.IsFillFormMode&&(n.unbind(GC.Spread.Sheets.Events.SelectionChanged),n.bind(GC.Spread.Sheets.Events.SelectionChanged,function(n,t){r.getPivotTableFillHandler().updateListViewSelection(t)}))},s.prototype.canCellEnterEditMode=function(n,t,i){var r,u=0;return((r=n.Rows)===null||r===void 0?void 0:r.length)&&(u=n.Rows.length),i>=u},s.prototype.autoFitChangedColumns=function(n,t){var u=this,i;(n===null||n===void 0?void 0:n.IsDataColumnAutoFitWidth)&&t&&(i=n.MinDataColumnWidth?r(n.MinDataColumnWidth):0,t.map(function(n){return n.Column}).filter(function(n,t,i){return i.indexOf(n)===t}).forEach(function(n){u._sheet.autoFitColumn(n);i>0&&i>u._sheet.getColumnWidth(n)&&u._sheet.setColumnWidth(n,i)}))},s.prototype.adjustColumnWidth=function(n,t){if(n){var i=t._pivotData.schema.tableRowLevel,r=this._sheet.getColumnCount();this.autofitColumn(n,i,r);this.applyMinColumnWidth(n,i,r)}},s.prototype.autofitColumn=function(n,t,i){var u=[],r;if(n.IsRowHeaderAutoFitWidth)for(r=0;r<t&&r<i;r++)u.push({col:r});if(n.IsDataColumnAutoFitWidth)for(r=t;r<i;r++)u.push({col:r});u.length>0&&this._spread.commandManager().execute({cmd:"autoFitColumn",sheetName:this._sheet.name()||"Sheet1",columns:u,isRowHeader:!1,autoFitType:GC.Spread.Sheets.AutoFitType.cellWithHeader})},s.prototype.applyMinColumnWidth=function(n,t,i){var f,e,u;if(n.IsRowHeaderAutoFitWidth&&n.RowHeaderMinColumnWidth)for(f=r(n.RowHeaderMinColumnWidth),u=0;u<t&&u<i;u++)f>this._sheet.getColumnWidth(u)&&this._sheet.setColumnWidth(u,f);if(n.IsDataColumnAutoFitWidth&&n.MinDataColumnWidth)for(e=r(n.MinDataColumnWidth),u=t;u<i;u++)e>this._sheet.getColumnWidth(u)&&this._sheet.setColumnWidth(u,e)},s.prototype.collapseByDefault=function(n){var i=this.CellElement.CellType,t=i.PivotTableSetting;n.collapseHeader(t.CollapseRowHeaderIndex,t.CollapseColumnHeaderIndex)},s.prototype.isDataSetEmpty=function(n){var t,i=!1;for(var r in n.columns)if(((t=n.columns[r])===null||t===void 0?void 0:t.values)&&n.columns[r].values.length>0){i=!0;break}return!i},s.prototype.setFormatterForHeader=function(t,r){var u;(u=t.Rows)===null||u===void 0?void 0:u.forEach(function(t,u){t.Format?r.setFormatter(-1,u,t.Format,GC.Spread.Sheets.SheetArea.viewport):t.ColumnDataType===i.Date?r.setFormatter(-1,u,n.StaticFormatString.dateTimeDefaultFormattingString,GC.Spread.Sheets.SheetArea.viewport):t.ColumnDataType===i.Time&&r.setFormatter(-1,u,n.StaticFormatString.timeDefaultFormattingString,GC.Spread.Sheets.SheetArea.viewport)});t.Cols&&(t.Cols.length>1&&r.setRowCount(t.Cols.length,GC.Spread.Sheets.SheetArea.colHeader),t.Cols.forEach(function(t,u){t.Format?r.setFormatter(u,-1,t.Format,GC.Spread.Sheets.SheetArea.colHeader):t.ColumnDataType===i.Date?r.setFormatter(u,-1,n.StaticFormatString.dateTimeDefaultFormattingString,GC.Spread.Sheets.SheetArea.colHeader):t.ColumnDataType===i.Time&&r.setFormatter(u,-1,n.StaticFormatString.timeDefaultFormattingString,GC.Spread.Sheets.SheetArea.colHeader)}))},s.prototype.addDependenceHandler=function(t){var r=this,i=t.getDependences();i&&i.length>0&&n.DependenceCellValueChangeHelper.listenFormulaRefChanged(i,function(){r.paintPivotTable()},r.runTimePageName)},s.prototype.createSpreadJS=function(t){var u,i,r;this.destroySpreadJS();u=document.body.querySelector(this._pivotTableDomCssSelector());i=this._spread=new GC.Spread.Sheets.Workbook(u,{showHorizontalScrollbar:!1,showVerticalScrollbar:!1});i.refresh();this.initWorkbook(i);r=this._sheet=i.getActiveSheet();this.initWorksheet(r,t);n.ForguncyData.pageInfo.formulaManager.removeCalcSourceByName(this.getPivotTableCalcSourceName());n.ForguncyData.pageInfo.formulaManager.addCalcSource(new n.PivotTableCalcSource(n.ForguncyData.pageInfo.formulaManager.getCalcService(),this.getPivotTableCalcSourceName(),r,this.runTimePageName));r.setCalc(n.ForguncyData.pageInfo.formulaManager.getCalcService(),null)},s.prototype.initWorksheet=function(n,t){var r=n.getSelections(),i;n.reset();n.options.rowHeaderVisible=!1;n.options.allowCellOverflow=!1;n.options.clipBoardOptions=GC.Spread.Sheets.ClipboardPasteOptions.values;n.autoGenerateColumns=!1;n.options.isProtected=!0;t.IsFillFormMode&&(n.options.isProtected=!1);n.options.protectionOptions.allowResizeColumns=!0;n.options.protectionOptions.allowResizeRows=!0;n.options.protectionOptions.allowSort=!1;n.options.protectionOptions.allowDeleteColumns=!1;n.options.protectionOptions.allowDeleteRows=!1;n.options.sheetAreaOffset={top:3,left:3};n.selectionUnit(GC.Spread.Sheets.SelectionUnit.cell);n.selectionPolicy(GC.Spread.Sheets.SelectionPolicy.single);r&&r.length>0&&(i=r[0],i.row<n.getRowCount()&&i.col<n.getColumnCount()&&n.setSelection(i.row,i.col,i.rowCount,i.colCount))},s.prototype.initWorkbook=function(n){n.options.tabStripVisible=!1;n.options.allowUserEditFormula=!1;n.options.scrollbarMaxAlign=!0;n.options.backColor="transparent";n.options.tabStripVisible=!1;n.options.allowUserDragDrop=!1;n.options.allowUserDragFill=!1;n.options.showHorizontalScrollbar=!1;n.options.showVerticalScrollbar=!1;n.options.showDragFillSmartTag=!1;n.options.autoFitType=GC.Spread.Sheets.AutoFitType.cellWithHeader;n.options.defaultDragFillType=GC.Spread.Sheets.Fill.AutoFillType.fillWithoutFormatting;n.options.allowUserZoom=!1;n.options.allowExtendPasteRange=!0;n.options.copyPasteHeaderOptions=GC.Spread.Sheets.CopyPasteHeaderOptions.noHeaders;n.options.allowCopyPasteExcelStyle=!1;n.options.allowUndo=!1;n.options.showDragDropTip=!1;n.options.showDragFillSmartTag=!1;n.options.showDragFillTip=!1;n.options.allowContextMenu=!1;this.useSimpleBar()&&(n.options.scrollbarAppearance=GC.Spread.Sheets.ScrollbarAppearance.mobile);var t=n.commandManager();t.register("moveToNextCellThenControl",GC.Spread.Sheets.Commands.moveToNextCellThenControl,GC.Spread.Commands.Key.tab,!1,!1,!1,!1);t.register("moveToPreviousCellThenControl",GC.Spread.Sheets.Commands.moveToPreviousCellThenControl,GC.Spread.Commands.Key.tab,!1,!0,!1,!1);t.setShortcutKey(null,GC.Spread.Commands.Key.v,!0,!1,!1,!1)},s.prototype.setTableOptions=function(n,t){var u=t.ShowColsTotal,r=t.ShowRowsTotal,i=new PivotData.PivotLayoutSetting;return i.grandTotals=u?r?1:4:r?3:2,i.subtotals=t.ShowSubtotal?3:1,i},s.prototype.updateSetting=function(r,u){var e,o=this.getListViewColumnName(u.Rows),h=this.getListViewColumnName(u.Cols),a=new PivotData.DataSet(r),v=a.addView(),c=v.addPivot(),y=c.getSetting(),p=$(this._pivotTableDomCssSelector()).parent().attr("fgcname"),l=s.customFunctions[p],f=new PivotData.PivotSettingConfig;return f.values.push([]),(e=u.Values)===null||e===void 0?void 0:e.forEach(function(r,u){var e=new PivotData.PivotSettingConfigValue(r.DatabaseColumnName,r.DatabaseColumnName);l?(e.customAggregator=l,e.method=t[t.custom]):e.method=t[r.Aggregator]||t[t.cnt];e.totalMethod=r.KeepTotalAggregatorSameWithValue?e.method:t[r.TotalAggregator];e.format="General";r.Format?e.format=r.Format:r.ColumnDataType===i.Date?(e.method===t[t.first]||e.method===t[t.last]||e.method===t[t.max]||e.method===t[t.min]||e.method===t[t.avg]||e.method===t[t.sum])&&(e.format=n.StaticFormatString.dateTimeDefaultFormattingString):r.ColumnDataType===i.Time&&(e.method===t[t.first]||e.method===t[t.last]||e.method===t[t.max]||e.method===t[t.min]||e.method===t[t.avg]||e.method===t[t.sum])&&(e.format=n.StaticFormatString.timeDefaultFormattingString);e.customValueName=r.DisplayName?r.DisplayName:"";e.idx=u;f.values[0].push(e)}),o===null||o===void 0?void 0:o.forEach(function(n){var t=new PivotData.PivotSettingConfigItem(n,n);f.columns.push(t)}),h===null||h===void 0?void 0:h.forEach(function(n){var t=new PivotData.PivotSettingConfigItem(n,n);f.rows.push(t)}),y.update(f),c},s.prototype.updateHeaderList=function(n,t){var i,r=(i=n===null||n===void 0?void 0:n.map(function(n){return{Label:n.DatabaseColumnName,CellLocation:{Row:-1,Column:-1,Name:n.ValidDatabaseColumnName}}}))!==null&&i!==void 0?i:[];return r.forEach(function(n){var i=t.filter(function(t){return t.Label==n.Label});i.length>0&&(n.CellLocation=i[0].CellLocation)}),r},s.prototype.updateValueList=function(t,i){var f,r,u;return i.length===1?r=i[0].CellLocation:i.length===2&&(f=i[0].CellLocation,r=i[1].CellLocation),f||(f={Row:-1,Column:-1,Name:n.RS.PivotTableCellType_ClickCellTitle_Lable}),r||(r={Row:-1,Column:-1,Name:n.RS.PivotTableCellType_ClickCellValue_Lable}),u=[],t.length===1?u.push({Label:n.RS.PivotTableCellType_ClickCellValue_Lable,CellLocation:r}):t.length>1&&(u.push({Label:n.RS.PivotTableCellType_ClickCellTitle_Lable,CellLocation:f}),u.push({Label:n.RS.PivotTableCellType_ClickCellValue_Lable,CellLocation:r})),u},s.prototype.updatePivotTableClickCommandSetting=function(n,t){n.RowHeaderList=this.updateHeaderList(t.Rows,n.RowHeaderList);n.ColumnHeaderList=this.updateHeaderList(t.Cols,n.ColumnHeaderList);n.CellValueList=this.updateValueList(t.Values,n.CellValueList)},s.prototype.executeClickCommand=function(t,i,r){if(!n.Common.IsEmpty(t)){this.updatePivotTableClickCommandSetting(t,r);var u=this,f=u.getPivotTableValueAreaRanges(i,r);u.unbind("pivottablecommand");u.bind("pivottablecommand",function(i,e){if(!u.allowCommandTrigger(e,f,r)){u.clearOldValue(t);return}var o={};u.setBindingCellValue(t.RowHeaderList,e.rowHeaders,o);u.setBindingCellValue(t.ColumnHeaderList,e.colHeaders,o);t.CellValueList&&t.CellValueList.length>0&&(t.CellValueList.length>1?(u.setValueToCell(t.CellValueList[0].CellLocation,e.colHeaders[e.colHeaders.length-1].header,o),u.setValueToCell(t.CellValueList[1].CellLocation,e.value,o)):u.setValueToCell(t.CellValueList[0].CellLocation,e.value,o));n.ForguncyData.commandExecutor.executeCommand(t.CommandList,{runTimePageName:u.runTimePageName,commandTrigger:u,commandID:u.ID,eventType:"click",locationString:n.FormulaHelper.getCellLogLocationString(u.ID,u.Name,u.runTimePageName),initParams:o})})}},s.prototype.allowCommandTrigger=function(n,t,i){if(n.dataType===u.ColHeader||n.dataType===u.RowHeader)return!1;var r=this.convertColFromClickEvent(n.col,u[n.dataType],i);return this.isCellInValueArea(t,n.row,r)?this.isCommandExecuting()?!1:!0:!1},s.prototype.convertColFromClickEvent=function(n,t,i){if(t!==u.FirstCell&&t!==u.RowHeader){var r=i.Rows?i.Rows.length:0;return n+r}return n},s.prototype.clearOldValue=function(n){var t=this,i,r,u;(i=n.RowHeaderList)===null||i===void 0?void 0:i.forEach(function(n){return t.setValueToCell(n.CellLocation,"")});(r=n.ColumnHeaderList)===null||r===void 0?void 0:r.forEach(function(n){return t.setValueToCell(n.CellLocation,"")});(u=n.CellValueList)===null||u===void 0?void 0:u.forEach(function(n){return t.setValueToCell(n.CellLocation,"")})},s.prototype.getPivotTableValueAreaRanges=function(n,t){var i,r=[];return(i=t.Values)===null||i===void 0?void 0:i.forEach(function(t){var i=n.getPivotValueRanges(t.DisplayName);i&&i.length>0&&(r=r.concat(i))}),r},s.prototype.getPivotTableSubtotalAreaRanges=function(n,t){var i,r=[];return(i=t.Values)===null||i===void 0?void 0:i.forEach(function(t){var i=n.getPivotSubtotalRanges(t.DisplayName);i&&i.length>0&&(r=r.concat(i))}),r},s.prototype.isCellInValueArea=function(n,t,i){return n.length>0?n.some(function(n){return t>=n.row&&t<n.row+n.rowCount&&i>=n.col&&i<n.col+n.colCount}):!1},s.prototype.setBindingCellValue=function(n,t,i){for(var u=Math.min(n.length,t.length),r=0;r<u;r++)this.setValueToCell(n[r].CellLocation,t[r].header,i)},s.prototype.setValueToCell=function(t,i,r){if(r===void 0&&(r=null),t){var u=this.getCellID(t,this.runTimePageName);u?n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(u,{newValue:i},5):t.Name&&r&&(r[t.Name]=i)}},s.prototype.getCellID=function(t,i){if(t.Name){var r=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(t.Name,!1);return r&&r.length>0?r[0].id:null}return n.Common.getIdStr(t.Row,t.Column,i)},s.prototype.getListView=function(n){return f.getListView(n,this.getFormulaCalcContext().PageID)},s.prototype.applyStyle=function(t,i,u){var s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,e;if(!u){this.applyStyle_Old(t,i.PivotTableStyle);return}e=(s=i.PivotTableStyle)!==null&&s!==void 0?s:this.getDefaultPivotTableStyle();u||(u={});var o=this.CellElement.StyleInfo,lt=o.FontSize+"px "+(o.FontFamily||n.LocaleFonts.default),f=t.getInspectorStyles();f.font=lt;o.Foreground&&o.Foreground!=="#000000"&&(f.wholeTable.foreColor=n.ColorHelper.Convert(o.Foreground));this._spread.options.grayAreaBackColor=e.GrayAreaColor?n.ColorHelper.Convert(e.GrayAreaColor):"transparent";this._sheet.options.frozenlineColor=((c=(h=u.WholeTable)===null||h===void 0?void 0:h.NormalStyle)===null||c===void 0?void 0:c.FrozenlineColor)?n.ColorHelper.Convert(u.WholeTable.NormalStyle.FrozenlineColor):"transparent";this.applyPartStyle(f.wholeTable,(l=u.WholeTable)===null||l===void 0?void 0:l.NormalStyle);i.ShowBandedCols&&(this.applyPartStyle(f.firstColStripe,(a=u.FirstColStripe)===null||a===void 0?void 0:a.NormalStyle),this.applyPartStyle(f.secondColStripe,(v=u.SecondColStripe)===null||v===void 0?void 0:v.NormalStyle));i.ShowBandedRows&&(this.applyPartStyle(f.firstRowStripe,(y=u.FirstRowStripe)===null||y===void 0?void 0:y.NormalStyle),this.applyPartStyle(f.secondRowStripe,(p=u.SecondRowStripe)===null||p===void 0?void 0:p.NormalStyle));this.applyPartStyle(f.colHeader,(w=u.HeaderRow)===null||w===void 0?void 0:w.NormalStyle);this.applyPartStyle(f.rowHeader,(b=u.FirstColumn)===null||b===void 0?void 0:b.NormalStyle);i.ShowSubtotal&&(this.applyPartStyle(f.subTotalForRow1,(k=u.SubtotalRow1)===null||k===void 0?void 0:k.NormalStyle),this.applyPartStyle(f.subTotalForRow2,(d=u.SubtotalRow2)===null||d===void 0?void 0:d.NormalStyle),this.applyPartStyle(f.subTotalForRow3,(g=u.SubtotalRow3)===null||g===void 0?void 0:g.NormalStyle),this.applyPartStyle(f.subTotalForCol1,(nt=u.SubtotalCol1)===null||nt===void 0?void 0:nt.NormalStyle),this.applyPartStyle(f.subTotalForCol2,(tt=u.SubtotalCol2)===null||tt===void 0?void 0:tt.NormalStyle),this.applyPartStyle(f.subTotalForCol3,(it=u.SubtotalCol3)===null||it===void 0?void 0:it.NormalStyle));this.applyPartStyle(f.rowSubheading1,(rt=u.RowSubheading1)===null||rt===void 0?void 0:rt.NormalStyle);this.applyPartStyle(f.rowSubheading2,(ut=u.RowSubheading2)===null||ut===void 0?void 0:ut.NormalStyle);this.applyPartStyle(f.rowSubheading3,(ft=u.RowSubheading3)===null||ft===void 0?void 0:ft.NormalStyle);this.applyPartStyle(f.colSubheading1,(et=u.ColSubheading1)===null||et===void 0?void 0:et.NormalStyle);this.applyPartStyle(f.colSubheading2,(ot=u.ColSubheading2)===null||ot===void 0?void 0:ot.NormalStyle);this.applyPartStyle(f.colSubheading3,(st=u.ColSubheading3)===null||st===void 0?void 0:st.NormalStyle);i.ShowColsTotal&&this.applyPartStyle(f.grandTotalsRow,(ht=u.GrandTotalRow)===null||ht===void 0?void 0:ht.NormalStyle);i.ShowRowsTotal&&this.applyPartStyle(f.grandTotalsColumn,(ct=u.GrandTotalColumn)===null||ct===void 0?void 0:ct.NormalStyle);f.isAutofitColumn=!1;e.DataColumnWidth&&(f.columnWidth=r(e.DataColumnWidth));e.RowHeaderColumnWidth&&(f.rowHeaderColumnWidth=r(e.RowHeaderColumnWidth));e.RowHeight&&(f.rowHeight=r(e.RowHeight));i.ShowBandedRows!==undefined&&(f.showBandedRows=i.ShowBandedRows);i.ShowBandedCols!==undefined&&(f.showBandedCols=i.ShowBandedCols);t.setInspectorStyles(f)},s.prototype.applyPartStyle=function(t,i){i&&(i.Background&&(t.backColor=n.ColorHelper.Convert(i.Background)),i.FontColor&&(t.foreColor=n.ColorHelper.Convert(i.FontColor)),i.CellHorizontalAlignment&&(t.CellHorizontalAlignment=i.CellHorizontalAlignment),i.CellVerticalAligment&&(t.CellVerticalAligment=i.CellVerticalAligment),i.Bold!==undefined&&i.Bold!==null&&(t.Bold=i.Bold),i.Italic!==undefined&&i.Italic!==null&&(t.Italic=i.Italic),this.applyBorderStyle(t,i))},s.prototype.applyBorderStyle=function(n,t){t.BorderString?(n.borderTopString=t.BorderString,n.borderBottomString=t.BorderString,n.borderLeftString=t.BorderString,n.borderRightString=t.BorderString):(t.BorderTopString&&(n.borderTopString=t.BorderTopString),t.BorderBottomString&&(n.borderBottomString=t.BorderBottomString),t.BorderLeftString&&(n.borderLeftString=t.BorderLeftString),t.BorderRightString&&(n.borderRightString=t.BorderRightString));t.InsideHorizontalBorderString&&(n.insideHorizontalBorderString=t.InsideHorizontalBorderString);t.InsideVerticalBorderString&&(n.insideVerticalBorderString=t.InsideVerticalBorderString)},s.prototype.getDefaultPivotTableStyle=function(){return{HeaderStyle:{BackColor:"#5B9BD5",ForeColor:"#FFFFFF"},SubtotalStyle:{BackColor:"#5B9BD5",ForeColor:"#FFFFFF"},TotalStyle:{BackColor:"#2F75B5",ForeColor:"#FFFFFF"},DataColumnWidth:undefined,IsDataColumnAutoFitWidth:!1,MinDataColumnWidth:undefined,RowHeaderColumnWidth:undefined,IsRowHeaderAutoFitWidth:!1,RowHeaderMinColumnWidth:undefined,RowHeight:undefined,GrayAreaColor:"transparent",UseSimpleBar:!1}},s.prototype.applyStyle_Old=function(t,i){var o,h,f,s;i=i!==null&&i!==void 0?i:this.getDefaultPivotTableStyle();var e=this.CellElement.StyleInfo,c=e.FontSize+"px "+e.FontFamily,u=t.getInspectorStyles();u.font=c;e.Foreground&&e.Foreground!=="#000000"&&(u.colHeader.foreColor=n.ColorHelper.Convert(e.Foreground),u.rowHeader.foreColor=n.ColorHelper.Convert(e.Foreground),u.wholeTable.foreColor=n.ColorHelper.Convert(e.Foreground),u.grandTotalsColumn.foreColor=n.ColorHelper.Convert(e.Foreground),u.grandTotalsRow.foreColor=n.ColorHelper.Convert(e.Foreground),u.subTotalForRow1.foreColor=n.ColorHelper.Convert(e.Foreground),u.subTotalForRow2.foreColor=n.ColorHelper.Convert(e.Foreground),u.subTotalForRow3.foreColor=n.ColorHelper.Convert(e.Foreground),u.subTotalForCol1.foreColor=n.ColorHelper.Convert(e.Foreground),u.subTotalForCol2.foreColor=n.ColorHelper.Convert(e.Foreground),u.subTotalForCol3.foreColor=n.ColorHelper.Convert(e.Foreground));this._spread.options.grayAreaBackColor=i.GrayAreaColor?n.ColorHelper.Convert(i.GrayAreaColor):"transparent";this._sheet.options.frozenlineColor="transparent";o=i.HeaderStyle;o&&(o.BackColor&&(u.colHeader.backColor=n.ColorHelper.Convert(o.BackColor),u.rowHeader.backColor=n.ColorHelper.Convert(o.BackColor)),o.ForeColor&&(u.colHeader.foreColor=n.ColorHelper.Convert(o.ForeColor),u.rowHeader.foreColor=n.ColorHelper.Convert(o.ForeColor)));h=i.BodyStyle;h&&(h.BackColor&&(u.wholeTable.backColor=n.ColorHelper.Convert(h.BackColor)),h.ForeColor&&(u.wholeTable.foreColor=n.ColorHelper.Convert(h.ForeColor)));f=i.SubtotalStyle;f&&(f.BackColor&&(u.subTotalForRow1.backColor=n.ColorHelper.Convert(f.BackColor),u.subTotalForRow2.backColor=n.ColorHelper.Convert(f.BackColor),u.subTotalForRow3.backColor=n.ColorHelper.Convert(f.BackColor),u.subTotalForCol1.backColor=n.ColorHelper.Convert(f.BackColor),u.subTotalForCol2.backColor=n.ColorHelper.Convert(f.BackColor),u.subTotalForCol3.backColor=n.ColorHelper.Convert(f.BackColor)),f.ForeColor&&(u.subTotalForRow1.foreColor=n.ColorHelper.Convert(f.ForeColor),u.subTotalForRow2.foreColor=n.ColorHelper.Convert(f.ForeColor),u.subTotalForRow3.foreColor=n.ColorHelper.Convert(f.ForeColor),u.subTotalForCol1.foreColor=n.ColorHelper.Convert(f.ForeColor),u.subTotalForCol2.foreColor=n.ColorHelper.Convert(f.ForeColor),u.subTotalForCol3.foreColor=n.ColorHelper.Convert(f.ForeColor)));s=i.TotalStyle;s&&(s.BackColor&&(u.grandTotalsColumn.backColor=n.ColorHelper.Convert(s.BackColor),u.grandTotalsRow.backColor=n.ColorHelper.Convert(s.BackColor)),s.ForeColor&&(u.grandTotalsColumn.foreColor=n.ColorHelper.Convert(s.ForeColor),u.grandTotalsRow.foreColor=n.ColorHelper.Convert(s.ForeColor)));u.isAutofitColumn=!1;i.DataColumnWidth&&(u.columnWidth=r(i.DataColumnWidth));i.RowHeaderColumnWidth&&(u.rowHeaderColumnWidth=r(i.RowHeaderColumnWidth));i.RowHeight&&(u.rowHeight=r(i.RowHeight));u.gridLine="#dfe8e8";t.setInspectorStyles(u)},s.prototype.getListViewColumnName=function(n){for(var i=[],r=n?n.length:0,t=0;t<r;t++)i.push(n[t].DatabaseColumnName);return i},s.prototype.convertDesignerColumnToListViewColum=function(n,t){for(var s,o,r,u=n.getMergedColumnInfos(),h=t?t.length:0,f=0;f<h;f++){var i=t[f],c=this.getDesignerColumnIndex(i.ColumnCell),e=this.getListViewIndex(u,c);e!==-1&&(i.ListViewColumnIndex=e,i.ColumnDataType=u[e].ColumnDataType);((r=i.BackgroundValue)===null||r===void 0?void 0:r.ColumnCell)&&(s=this.getDesignerColumnIndex(i.BackgroundValue.ColumnCell),o=this.getListViewIndex(u,s),o!==-1&&(i.BackgroundValue.ListViewColumnIndex=o))}},s.prototype.convertDesignerColumnToListViewColumForMaster=function(n,t){for(var r,u,e=t?t.length:0,i=0;i<e;i++)r=t[i],u=f.getListviewColumnIndexByHeaderText(n,r.DatabaseColumnName),u!==-1&&(r.ListViewColumnIndexForMaster=u)},s.prototype.getDesignerColumnIndex=function(n){var t=/([A-Za-z]+)(\d*)/.exec(n);return t.length>1?this.convertNum(t[1])-1:-1},s.prototype.convertNum=function(n){for(var t,r=0,f=n.match(/./g),i=n.length-1,u=1;i>=0;i--,u*=26){if(t=f[i].toUpperCase(),t<"A"||t>"Z")return 0;r+=(t.charCodeAt(0)-64)*u}return r},s.prototype.getListViewIndex=function(n,t){if(t===-1)return-1;for(var i=0;i<n.length;i++)if(t===n[i].DesignerColumnIndex)return i;return-1},s.prototype.preprocessColumnInfo=function(n,t){var i,r;this.convertDesignerColumnToListViewColum(n,t.Rows);this.convertDesignerColumnToListViewColum(n,t.Cols);this.convertDesignerColumnToListViewColum(n,t.Values);t.IsFillFormMode&&(t.RowMaster&&(i=this.getListView(t.RowMaster),this.convertDesignerColumnToListViewColumForMaster(i,t.Rows)),t.ColumnMaster&&(r=this.getListView(t.ColumnMaster),this.convertDesignerColumnToListViewColumForMaster(r,t.Cols)))},s.prototype.getTableData=function(n,t){return new l(this.getFormulaCalcContext().PageID,n,t).getPivotData()},s.prototype.getPivotTableCalcSourceName=function(){return this._pivotTableCalcSourceIndex>0?"pvt"+this._pivotTableCalcSourceIndex:"pvt"},s.prototype.destroySpreadJS=function(){var r,u,t,i;if(this._sheet){for(n.ForguncyData.pageInfo.formulaManager.removeCalcSourceByName(this.getPivotTableCalcSourceName()),this.removeSheetSource(),this._sheet.setCalc(new GC.Spread.CalcEngine.CalcService,null),r=this._sheet.getColumnCount(),u=this._sheet.getActiveRowIndex(),t=0;t<r;t++)i=this._sheet.getCellType(u,t),i instanceof n.SpreadJSEditCellType&&i.destroy();this._sheet.unbindAll();this._sheet=null}if(this._spread){this._spread.unbindAll();try{this._spread.focus(!1)}catch(f){}this._spread.destroy();this._spread=null}},s.prototype.removeSheetSource=function(){var i=n.ForguncyData.pageInfo.formulaManager.getCalcService(),r=i.getAllSourceModels(),u,t;for(u in r)if(t=r[u].getSource(),t.getSheet&&t.getSheet()===this._sheet){i.removeSource(t);break}},s.prototype.destroy=function(){this.destroySpreadJS();e.prototype.destroy.call(this)},s.prototype.enterPrintMode=function(){this._spread&&(this._spread.options.hideSelection=!0,this._oldShowHorizontalScrollbar=this._spread.options.showHorizontalScrollbar,this._spread.options.showHorizontalScrollbar=!1,this._oldShowVerticalScrollbar=this._spread.options.showVerticalScrollbar,this._spread.options.showVerticalScrollbar=!1)},s.prototype.quitPrintMode=function(){this._spread&&(this._spread.options.hideSelection=!1,this._spread.options.showHorizontalScrollbar=this._oldShowHorizontalScrollbar,this._spread.options.showVerticalScrollbar=this._oldShowVerticalScrollbar)},s.prototype.showLoadingIndicator=function(){var t,i,r;if(!this.IsShouldPreview()){if(this.loadingIndicator===null){if(t=$(this._pivotTableDomCssSelector()).parent(),!t||t.length===0)return;i=999;r=17;this.cover=n.Common.getCover("transparent",1).css("position","absolute").css("width","100%").css("height","100%").css("left","0").css("top","0").css("zIndex",i).appendTo(t);this.loadingIndicator=$("<img class='loading-indicator'><\/img>").attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/fgc_loading.gif").css("position","absolute").css("width",r).css("height",r).css("left","50%").css("top","50%").css("transform","translate(-50%, -50%)").css("zIndex",i).appendTo(t)}this.cover.show();this.loadingIndicator.show()}},s.prototype.hiddenLoadingIndicator=function(n){(n===void 0&&(n=!1),this.IsShouldPreview())||this.loadingIndicator&&(this.cover.hide(),this.loadingIndicator.hide())},s.customFunctions={},s}(n.CellTypeBase);n.PivotTableCellType=e;s=1.3333333333333333;var h=function(){function t(n){this._rowHeaderValues=this._getHeaderValues(n.data.rowHeader);this._colHeaderValues=this._getHeaderValues(n.data.colHeader)}return t.prototype._getHeaderValues=function(n){for(var u,t,i,f=[],r=0;r<n.length;r++)for(u=n[r],t=0;t<u.length;t++)f.push((i=u[t])===null||i===void 0?void 0:i.value);return f},t.equals=function(t,i){return n.Common.IsEmpty(t)||n.Common.IsEmpty(i)?!1:this.isValuesEquals(t._rowHeaderValues,i._rowHeaderValues)&&this.isValuesEquals(t._colHeaderValues,i._colHeaderValues)},t.isValuesEquals=function(t,i){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(i)||t.length!==i.length)return!1;for(var r=0;r<t.length;r++)if(t[r]instanceof Date&&i[r]instanceof Date){if(t[r].getTime()!==i[r].getTime())return!1}else if(t[r]!==i[r])return!1;return!0},t}(),c=function(){function t(n,t){(this._rowHeaderColumnCount=t,this.activeRow=0,this.activeCol=0,this.viewportTopRow=0,this.viewportLeftColumn=0,this.colHeaderCollapseCells=[],this.rowHeaderCollapseCells=[],this.columnWidthList=[],n)&&(this.activeRow=n.getActiveRowIndex(),this.activeCol=n.getActiveColumnIndex(),this.viewportTopRow=n.getViewportTopRow(1),this.viewportLeftColumn=n.getViewportLeftColumn(1),this.colHeaderCollapseCells=this.getCollapseIndexes(n,GC.Spread.Sheets.SheetArea.colHeader),this.rowHeaderCollapseCells=this.getCollapseIndexes(n,GC.Spread.Sheets.SheetArea.viewport,this._rowHeaderColumnCount),this.columnWidthList=this.getColumnWidth(n))}return t.prototype.getCollapseIndexes=function(t,i,r){var e,o=[],h=t.getRowCount(i),u,f,s;for(n.Common.IsEmpty(r)&&(r=t.getColumnCount(i)),u=0;u<r;u++)for(f=0;f<h;f++)s=(e=t.getTag(f,u,i))===null||e===void 0?void 0:e.collapse,s&&o.push({Row:f,Column:u});return o},t.prototype.getColumnWidth=function(n){for(var i=[],r=n.getColumnCount(),t=0;t<r;t++)i.push(n.getColumnWidth(t));return i},t.prototype.restore=function(n,t,i){this.restoreActiveCell(n);this.restoreColHeaderCollapse(t);this.restoreRowHeaderCollapse(t);this.restoreColumnWidth(n,i)},t.prototype.restoreActiveCell=function(n){n.setActiveCell(this.activeRow,this.activeCol)},t.prototype.restoreRowHeaderCollapse=function(n){this.rowHeaderCollapseCells.forEach(function(t){return n.collapseRowHeaderByCode(t.Row,t.Column)})},t.prototype.restoreColHeaderCollapse=function(n){this.colHeaderCollapseCells.forEach(function(t){return n.collapseColHeaderByCode(t.Row,t.Column)})},t.prototype.restoreScrollBar=function(n){n.showCell(this.viewportTopRow,this.viewportLeftColumn,GC.Spread.Sheets.VerticalPosition.top,GC.Spread.Sheets.HorizontalPosition.left)},t.prototype.restoreColumnWidth=function(n,t){var r,i;if(!(t===null||t===void 0?void 0:t.IsRowHeaderAutoFitWidth))for(i=0;i<this._rowHeaderColumnCount;i++)this.columnWidthList[i]!==n.getColumnWidth(i)&&n.setColumnWidth(i,this.columnWidthList[i]);if(!(t===null||t===void 0?void 0:t.IsDataColumnAutoFitWidth))for(r=n.getColumnCount(),i=this._rowHeaderColumnCount;i<r;i++)this.columnWidthList[i]!==n.getColumnWidth(i)&&n.setColumnWidth(i,this.columnWidthList[i])},t}(),l=function(){function t(n,t,i){this._pageID=n;this._listView=t;this._pivotTableSetting=i;this._indexMaps={}}return t.prototype.getPivotData=function(){var n={measures:[],dimensions:[],columns:{},startMonth:0},t=this.appendMasterData(n,this._pivotTableSetting);return this.appendTableData(n,this._listView,this._pivotTableSetting),this.resetInvalidValue(n,t),n},t.prototype.resetInvalidValue=function(n,t){t&&t.forEach(function(t){var u=n.columns[t.DatabaseColumnName],i=u.values,f,r;if(i.length!==0)for(u.lookUps.length===0&&(u.lookUps=[null]),f=i[i.length-1]===-1?0:i[i.length-1],r=0;r<i.length;r++)if(i[r]===-1)i[r]=f;else break})},t.prototype.appendTableData=function(n,t,i){var r,u,f,e,o;this.appendColumns(i.Rows,n,this._listView,!0);this.appendColumns(i.Cols,n,this._listView,!0);var s=(u=(r=i.Rows)===null||r===void 0?void 0:r.map(function(n){return n.DatabaseColumnName}))!==null&&u!==void 0?u:[],h=(e=(f=i.Cols)===null||f===void 0?void 0:f.map(function(n){return n.DatabaseColumnName}))!==null&&e!==void 0?e:[],c=__spreadArray(__spreadArray([],s,!0),h,!0),l=(o=i.Values)===null||o===void 0?void 0:o.filter(function(n){return c.indexOf(n.DatabaseColumnName)===-1});this.appendColumns(l,n,this._listView,!1)},t.prototype.appendColumns=function(n,t,i,r){var f=this,u=[];n===null||n===void 0?void 0:n.forEach(function(n){f.getColumnData(i,n,t.columns,u);r&&u.push(n.DatabaseColumnName)})},t.prototype.getColumnData=function(n,t,i,r){var u,f=t.ListViewColumnIndex,e=(u=t.BackgroundValue)===null||u===void 0?void 0:u.ListViewColumnIndex;this.getColumnDataFromListview(n,t,i,f,e,r)},t.prototype.getColumnDataForMaster=function(n,t,i,r){var u,e=f.getListviewColumnIndexByHeaderText(n,t.DatabaseColumnName),o=f.getListviewColumnIndexByHeaderText(n,(u=t.BackgroundValue)===null||u===void 0?void 0:u.DatabaseColumnName);this.getColumnDataFromListview(n,t,i,e,o,r)},t.prototype.getColumnDataFromListview=function(t,r,u,f,e,o){var c,a,v,h,s;if(!n.Common.IsEmpty(f)){var y=this.getColumnObject(u,r.DatabaseColumnName),p=this.getIndexCache(r.DatabaseColumnName),l=t.getRowCount();if(!(l<=0)){for(c=[],a=[],s=0;s<l;s++)v=void 0,n.Common.IsEmpty(e)||(v=this.getListViewValue(t,s,e)),a.push(v),h=this.getListViewValue(t,s,f),h&&(r.ColumnDataType===i.Date||r.ColumnDataType===i.Time)&&(h=n.Convertor.fromOADateToDate(h)),c.push(h);for(this.preprocessLookupsAndIndexMap(y,p,c,o,u),s=0;s<l;s++)this.addToDataSet(y,c[s],p,a[s])}}},t.prototype.preprocessLookupsAndIndexMap=function(n,t,i,r,u){var f,e;if(!(r.length<=0)&&!(n.lookUps.length>0)&&!(i.length<=0)){f=[];try{e=this.getValueDictionary(i,r,u,n.values.length);f=this.getSortedDistinctValues(i,e)}catch(o){return}n.lookUps=f;f.forEach(function(n,i){t[n]=i})}},t.prototype.getValueDictionary=function(n,t,i,r){var f="|",u={};return n.forEach(function(n,e){var o=t.map(function(n){return i[n]}).map(function(n){return n.lookUps[n.values[e+r]]}).join(f);u[o]?u[o].indexOf(n)===-1&&u[o].push(n):u[o]=[n]}),u},t.prototype.getDistinctValues=function(n){var t={};return n.filter(function(n){return t[n]===1?!1:(t[n]=1,!0)})},t.prototype.getSortedDistinctValues=function(n,t){var f=this,i=this.getDistinctValues(n),u,r;if(i.length===n.length)return i;for(u in t)if(t[u].length===i.length)return t[u];return r=this.getValueCompareDic(t),i.sort(function(n,t){var u=r[n].smallerValues,i;return u[t]?1:(i=r[n].biggerValues,i[t])?-1:(f.addValueCompareResult(n,t,r),1)})},t.prototype.addValueCompareResult=function(n,t,i){var u=[n],r;for(var f in i[n].biggerValues)u.push(f);r=[t];for(f in i[t].smallerValues)r.push(f);r.forEach(function(n){u.forEach(function(t){i[t].smallerValues[n]=1})});u.forEach(function(n){r.forEach(function(t){i[t].biggerValues[n]=1})})},t.prototype.getValueCompareDic=function(n){var t=this.getDirectValueCompareDic(n);return this.getCascadedValueCompareDic(t)},t.prototype.getDirectValueCompareDic=function(n){var u={},e,i,r,f,o,s,t;for(e in n)for(i=n[e],r=0;r<i.length;r++){for(f=i[r],u[f]||(u[f]={smallerValues:{},biggerValues:{}}),o=u[f].smallerValues,s=u[f].biggerValues,t=0;t<r;t++)o[i[t]]=1;for(t=r+1;t<i.length;t++)s[i[t]]=1}return u},t.prototype.getCascadedValueCompareDic=function(n){var i={};for(var t in n)i[t]={smallerValues:{},biggerValues:{}},this.getSmallerValues(n,t,i[t].smallerValues),this.getBiggerrValues(n,t,i[t].biggerValues);return i},t.prototype.getSmallerValues=function(n,t,i){for(var r in n[t].smallerValues)i[r]||(i[r]=1,this.getSmallerValues(n,r,i))},t.prototype.getBiggerrValues=function(n,t,i){for(var r in n[t].biggerValues)i[r]||(i[r]=1,this.getBiggerrValues(n,r,i))},t.prototype.getColumnObject=function(n,t){return n[t]||(n[t]={lookUps:[],values:[],startMonth:0,dataType:"String",backgroundLookUps:[]}),n[t]},t.prototype._appendMasterDataAndGetRowCount=function(t,i,r,u){var s=this,e,o;return n.Common.IsEmpty(t)?0:(e=f.getListView(t,this._pageID),o=[],i===null||i===void 0?void 0:i.forEach(function(n){s.getColumnDataForMaster(e,n,u.columns,o);o.push(n.DatabaseColumnName)}),e.getRowCount())},t.prototype.appendMasterData=function(n,t){var o=this,i,r=this._appendMasterDataAndGetRowCount(t.ColumnMaster,t.Cols,t.Rows,n),u=this._appendMasterDataAndGetRowCount(t.RowMaster,t.Rows,t.Cols,n),s=!1,f=u>r?t.Cols:t.Rows,h=Math.abs(u-r),e;return h>0&&f&&f.forEach(function(t){var i=o.getColumnObject(n.columns,t.DatabaseColumnName),r=null,u;for(i.values.length===0?(s=!0,r=-1):r=i.values[0],u=0;u<h;u++)i.values.push(r)}),e=Math.max(r,u),e>0&&((i=t.Values)===null||i===void 0?void 0:i.forEach(function(t){var i=o.getColumnObject(n.columns,t.DatabaseColumnName),r;for(i.lookUps=[null],i.values=[],r=0;r<e;r++)i.values.push(0)})),s?f:null},t.prototype.getIndexCache=function(n){var t=this._indexMaps[n];return t===undefined&&(t={},this._indexMaps[n]=t),t},t.prototype.addToDataSet=function(n,t,i,r){var u=i[t];u===undefined?(u=n.lookUps.length,n.lookUps.push(t),n.backgroundLookUps.push(r),i[t]=u):n.backgroundLookUps[u]=r;n.values.push(u)},t.prototype.getListViewValue=function(n,t,i){return t<0||i<0?null:n.getValue(t,i)},t}(),f=function(){function t(){}return t.getListView=function(t,i){var r,u,e,f;if(t)return(u=n.Page.getSubPageInfoByPageID(i),n.Common.IsEmpty(u)===!1)?u.getListView(t):(e=t.toLowerCase(),f=(r=n.Page.getListViews(!1))===null||r===void 0?void 0:r.filter(function(n){return n.getName().toLowerCase()===e}),!n.Common.IsEmpty(f)&&f.length>0)?n.Page.getListView(t,!1):null},t.getListviewColumnIndexByHeaderText=function(t,i){var r=n.ListviewBase.getListviewByCalcSheetName(t._getUniqueID()),f,e,u,o;if(!r||(f=r.getColumnHeaderRowCount()-1,f<0))return-1;for(e=r.getMergedColumnInfos().length,u=0;u<e;u++)if(o=r.getDataColIndexByMergedColIndex(u),r.getColumnHeaderText(f,o)===i)return u;return-1},t}();n.CellTypeHelper.registerCellType("Forguncy.PivotTableCellType, ServerDesignerCommon",e)})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(n,t,i,r,u){this._cellTypeMetaData=n;this._defaultStyle=t;this._sheet=i;this._pivotTableCalcSourceName=r;this._runTimePageName=u}return t.prototype.applyConditionalFormat=function(t){var r=this._cellTypeMetaData.PivotTableConditionalFormatSetting,f,i,e,o,s;if(r===null||r===void 0?void 0:r.Conditions){var h={FontFamily:this._defaultStyle.FontFamily,FontSize:this._defaultStyle.FontSize,Foreground:n.ColorHelper.Convert(this._defaultStyle.Foreground)},l=[],u=new n.ConditionFormatFormulaHelper(this._runTimePageName),c=new n.ConditionFormatRuleHelper;for(f=0;f<r.Conditions.length;f++)i=r.Conditions[f],e=this.getPivotValueRanges(t,i),this.removeInvisibleCell(e),o=this.getPivotSubtotalRanges(t,i),this.removeInvisibleCell(o),s=this.getPivotGrandtotalRanges(t,i),this.removeInvisibleCell(s),l=l.concat(e).concat(o).concat(s),this.handleFormulaInConditionFormat(i.DataConditionalFormattingMetadata,u),this.convertToSpreadJSRule(i.DataConditionalFormattingMetadata,e,c,h),this.handleFormulaInConditionFormat(i.SubtotalConditionalFormattingMetadata,u),this.convertToSpreadJSRule(i.SubtotalConditionalFormattingMetadata,o,c,h),this.handleFormulaInConditionFormat(i.GrandtotalConditionalFormattingMetadata,u),this.convertToSpreadJSRule(i.GrandtotalConditionalFormattingMetadata,s,c,h);return u}},t.prototype.removeInvisibleCell=function(n){var u,t,i,r;if(n&&n.length>0)for(u=n.length-1;u>=0;u--){if(t=n[u],!this._sheet.getColumnVisible(t.col)){n.splice(u,1);continue}if(t.rowCount===1)this._sheet.getRowVisible(t.row)||n.splice(u,1);else{for(i=t.row-1,r=t.row;r<t.row+t.rowCount;r++)this._sheet.getRowVisible(r)||(r>t.row&&r<t.row+t.rowCount&&n.push(new GC.Spread.Sheets.Range(i+1,t.col,r-i-1,t.colCount)),i=r);i!==t.row-1&&(i<t.row+t.rowCount-1&&n.push(new GC.Spread.Sheets.Range(i+1,t.col,t.row+t.rowCount-1-i,t.colCount)),n.splice(u,1))}}return n},t.prototype.getPivotGrandtotalRanges=function(n,t){for(var i,r=n.getPivotGrandtotalRanges(t.Label),f=[],e=r?r.length:0,u=0;u<e;u++)i=r[u],f.push(new GC.Spread.Sheets.Range(i.row,i.col,i.rowCount,i.colCount));return f},t.prototype.getPivotSubtotalRanges=function(n,t){for(var i,r=n.getPivotSubtotalRanges(t.Label),f=[],e=r?r.length:0,u=0;u<e;u++)i=r[u],f.push(new GC.Spread.Sheets.Range(i.row,i.col,i.rowCount,i.colCount));return f},t.prototype.getPivotValueRanges=function(n,t){for(var i,r=n.getPivotValueRanges(t.Label),f=[],e=r?r.length:0,u=0;u<e;u++)i=r[u],f.push(new GC.Spread.Sheets.Range(i.row,i.col,i.rowCount,i.colCount));return f},t.prototype.convertToSpreadJSRule=function(n,t,i,r){var u,f,s,e,o,h,c;if(n&&(u=n.Rules,u))for(f=u.length-1;f>=0;f--)if(s=i.ConvertConditionRuleToSpreadJSByRanges(r,u[f],t),e=s.ranges(),u[f].RuleType===10&&e&&e.length>0)for(o=0;o<e.length;o++)h=e[o],c=i.ConvertConditionRuleToSpreadJSByRanges(r,u[f],[h]),this.convertFormulaRule(c,h);else this._sheet.conditionalFormats.addRule(s)},t.prototype.convertFormulaRule=function(t,i){var e=this,o=t,r=o.formula(),u,f,s;r&&(u=["=ISBLANK(","=NOT(ISBLANK(","=ISERROR(","=NOT(ISERROR("],f=u.findIndex(function(n){return r.startsWith(n+e._runTimePageName+"!")||r.startsWith(n+"'"+e._runTimePageName+"'!")}),f>=0&&(s=n.Common.getA1ReferenceString(i.row,i.col,!0,!0),r=u[f]+"'"+this._pivotTableCalcSourceName+"'!"+s+")",o.formula(r)));this._sheet.conditionalFormats.addRule(t)},t.prototype.handleFormulaInConditionFormat=function(n,t){var i,r;if(n&&(i=n.Rules,i))for(r=0;r<i.length;r++)t.HandleFormulaInConditionFormat(i[r])},t}();n.PivotTableConditionalFormat=t})(Forguncy||(Forguncy={}))
;