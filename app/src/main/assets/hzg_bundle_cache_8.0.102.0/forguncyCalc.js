/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./node_modules_local/@grapecity/js-sheets-common/index.js")}({"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(a,b){var c="object"==typeof c?c:{};c.Spread=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/all.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()}catch(a){"object"==typeof window&&(c=window)}a.exports=c},"./src/all.entry.ts":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/common.entry.ts"),b.Common=d,e=c("./src/plugins/commands/commands.entry.ts"),b.Commands=e,f=c("./src/plugins/formatter/formatter.entry.ts"),b.Formatter=f,g=c("./src/plugins/sparkline/sparkline.entry.ts"),b.Sparklines=g,h=c("./src/plugins/slicer/slicer.entry.ts"),b.Slicers=h},"./src/common/common.entry.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;function o(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/colorhelper.ts"),b.pc=d.pc,e=c("./src/common/util/types.ts"),b.j=e.j,f=c("./src/common/util/arrayhelper.ts"),b.k=f.k,g=c("./src/common/util/datetimehelper.ts"),b.l=g.l,h=c("./src/common/util/numberhelper.ts"),b.o=h.o,i=c("./src/common/util/regexhelper.ts"),b.q=i.q,j=c("./src/common/util/stringhelper.ts"),b.u=j.u,k=c("./src/common/util/rbush.ts"),b.rbush=k.rbush,l=c("./src/common/util/datetimehelper.ts"),b.FXc=l.getSR,m=c("./src/common/util/common.ts"),Object.defineProperty(b,"HandleExcelSpecialDate",{set:function(a){m.HandleExcelSpecialDate=a},get:function(){return m.HandleExcelSpecialDate}}),o(c("./src/common/util/common.ts")),n=c("./src/common/culture/cultureInfo.ts"),b.CultureInfo=n.CultureInfo,b.CultureManager=n.CultureManager,o(c("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(a,b,c){"use strict";(function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/types.ts"),e=c("./src/common/util/common.ts"),f=c("./src/common/util/arrayhelper.ts"),g="undefined"!=typeof window?window:a,h=void 0,i=null,j=d.j.H,k=d.j.Ia,l=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],m=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],n=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],o=l.concat(m),j(l,function(a,b){j(m,function(a,c){a<m.length-4&&o.push(b+" "+c)})}),o=o.concat(n),j(n,function(a,b){j(m,function(a,c){a<m.length-4&&o.push(b+" "+c)})});function B(a){return a.split("\xa0").join(" ").toUpperCase()}function C(a){var b,c,d=[];for(b=0,c=a.length;b<c;b++)d[b]=B(a[b]);return d}function D(a,b,c){var d=B(a),e=b.indexOf(d);return e===-1&&(e=c.indexOf(d)),e}p=function(){function a(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={}}return a.prototype.ma=function(){var a,b,c,d;return this.na||(a=this.DateTimeFormat,b=a.shortDatePattern.replace(/m/g,"M"),c=[b,b+" h:mm",b+" h:mm:ss",b+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"],c=c.concat(o),1041===this.id&&(d=a.eraFormatter,c=c.concat(this._Ab),c=c.concat(d)),c=c.concat(a.preselectedFormatters),this.na=c),this.na},a.prototype.oa=function(a){var b=this;return b.pa||(b.pa=C(b.DateTimeFormat.monthNames),b.qa=C(b.DateTimeFormat.monthGenitiveNames)),D(a,b.pa,b.qa)},a.prototype.ra=function(a){var b=this;return b.sa||(b.sa=C(b.DateTimeFormat.abbreviatedMonthNames),b.ta=C(b.DateTimeFormat.abbreviatedMonthGenitiveNames)),D(a,b.sa,b.ta)},a.prototype.ua=function(a){var b=this;return b.va||(b.va=C(b.DateTimeFormat.dayNames)),b.va.indexOf(B(a))},a.prototype.wa=function(a){var b=this;return b.xa||(b.xa=C(b.DateTimeFormat.abbreviatedDayNames)),b.xa.indexOf(B(a))},a}(),b.CultureInfo=p,q=function(){function a(){}return a.I=function(b){return b>=a.J()&&b<=a.K()},a.L=function(){var a,b,c=p.eras;if(c!==h){for(a=[],b=0;b<c.length;b++)a[b]=new Date(c[b].startDate.replace(/-/g,"/"));return a}return this.O},a.P=function(b){var c,d,e,f,g;switch(b){case"g":c="symbol",d=a.R;break;case"gg":c="abbreviation",d=a.S;break;case"ggg":c="name",d=a.U;break;default:return[]}if(e=p.eras,f=[],e!==h){for(g=0;g<e.length;g++)f[g]=e[g][c];return f}return d},a.K=function(){var a,b=p.eras;return b!==h&&b.length>0?(a=new Date(b[b.length-1].startDate.replace(/-/g,"/")),a.setFullYear(a.getFullYear()+99),a):this.W},a.J=function(){var a=p.eras;return a!==h&&a.length>0?new Date(a[0].startDate.replace(/-/g,"/")):this.Z},a.$=function(){var a=p.eras;return a!==h?a.length:this._},a.aa=function(){var a,b,c,d,e=p.eras;if(e!==h){for(a=[],b=1;b<e.length;b++)c=new Date(e[b-1].startDate.replace(/-/g,"/")),d=new Date(e[b].startDate.replace(/-/g,"/")),a[b-1]=d.getFullYear()-c.getFullYear()+1;return a[b-1]=99,a}return this.ba},a.ca=function(b){var c,d,e={da:-1,ea:-1};if(!a.I(b)){if(!(b>a.K()))return e;b=a.K()}for(c=0;c<a.$();c++)if(d=c+1!==a.$()?a.L()[c+1]:a.fa(a.K(),1),b<d){e.da=c,e.ea=b.getFullYear()-a.L()[c].getFullYear()+1;break}return e},a.fa=function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());return c.setMilliseconds(c.getMilliseconds()+b),new Date(c.valueOf())},a.ga=function(b,c){var d=a.L()[b].getFullYear();return d+c-1},a.ha=function(b,c){var d,e;for(c=c.toUpperCase(),d=a.P(b),e=0;e<d.length;e++)if(d[e]===c)return e;return-1},a.ia=function(b,c,d){var e,f,g,h=a,i=h.ca(c),j=i.da;if(j>=0&&(e=h.P(b),e.length>0))return e[j];if(f=i.ea,f>=0){if(g=""+f,"1"===g&&d)return g="\u5143";if("ee"===b)return 1===g.length&&(g="0"+g),g;if("e"===b)return g}return""},a.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],a._=5,a.ba=[45,15,64,31,99],a.W=new Date(2117,11,31,23,59,59),a.Z=new Date(1868,8,8),a.ja=["1,m","2,t","3,s","4,h","5,r"],a.ka=[0,1,2,3,0,1,2,3],a.U=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210","\u4ee4\u548c"],a.R=["M","T","S","H","R"],a.S=["\u660e","\u5927","\u662d","\u5e73","\u4ee4"],a.la=99,a.eraExcelFormatter="[$-ja-JP-x-gannen]",a.eraInternalFormatter="[$-411]",a}(),b.aBb=q,r=function(a){A(b,a);function b(){var b,c=a.call(this)||this;return E.call(c,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),b=["MMM yyyy","MMMM yyyy"],E.call(c,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1,b]),c.DateTimeFormat.defaultDatePattern=c.DateTimeFormat.shortDatePattern+" H:mm:ss",c.name=function(){return"en-US"},c.id=1033,c}return b}(p),s=function(a){A(b,a);function b(){var b,c,d,e=a.call(this)||this,f={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:i,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},g={Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u5104",Trillions:"\u5146"};return E.call(e,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",f,g]),b=["1","2","3","4","5","6","7","8","9","10","11","12",""],c=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],d=["yyyy\u5e74M\u6708d\u65e5","yyyy\u5e74M\u6708dd\u65e5","yyyy\u5e74MM\u6708d\u65e5","yyyy\u5e74MM\u6708dd\u65e5"],E.call(e,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],b,b,"\u5348\u524d",!1,["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",c,c,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",d,"ggge/mmmm/d\u65e5"]),e.DateTimeFormat.eras=!0,e.DateTimeFormat.defaultDatePattern=e.DateTimeFormat.shortDatePattern+" "+e.DateTimeFormat.longTimePattern,e._Ab=['gggee"\u5e74"MM"\u6708"dd"\u65e5','gggee"\u5e74"M"\u6708"d"\u65e5','ge"\u5e74"M"\u6708"d"\u65e5','ggge"\u5e74"M"\u6708"d"\u65e5','ggee"\u5e74"M"\u6708"d"\u65e5','gge"\u5e74"M"\u6708"d"\u65e5'],e.name=function(){return"ja-JP"},e.id=1041,e.isJCKCulture=!0,e}return b}(p),t=function(a){A(b,a);function b(){var b,c,d,e=a.call(this)||this,f={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:i,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},g={Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u4ebf",Trillions:"\u5146"};return E.call(e,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",f,g]),b=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],c=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],d=["yyyy\u5e74M\u6708","M\u6708d\u65e5","yyyy\u5e74M\u6708d\u65e5","h\u65f6mm\u5206","h\u65f6mm\u5206ss\u79d2"],E.call(e,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],b,b,"\u4e0a\u5348",!1,["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",c,c,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",d]),e.DateTimeFormat.defaultDatePattern=e.DateTimeFormat.shortDatePattern+" "+e.DateTimeFormat.longTimePattern,e.name=function(){return"zh-cn"},e.id=2052,e.isJCKCulture=!0,e.localeCompare=function(a,b){return a.localeCompare(b,"en")},e}return b}(p),u=function(a){A(b,a);function b(){var b,c,d=a.call(this)||this,e={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]},4:{letters:["\uc870","\ucc9c","\ubc31","\uc2ed","\uc5b5","\ucc9c","\ubc31","\uc2ed","\ub9cc","\ucc9c","\ubc31","\uc2ed",""],numbers:["\u25cb","\uc77c","\uc774","\uc0bc","\uc0ac","\uc624","\uc721","\uce60","\ud314","\uad6c"]}},f={Hundreds:"\ubc31",Thousands:"\ucc9c",Millions:"\ubc31\ub9cc",Billions:"10\uc5b5",Trillions:"\uc870"};return E.call(d,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"\u20a9",!1,e,f]),b=["1","2","3","4","5","6","7","8","9","10","11","12",""],c=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""],E.call(d,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],b,b,"\uc624\uc804",!1,["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",c,c,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'","yyyy\ub144/mmmm/d\uc77c"]),d.DateTimeFormat.defaultDatePattern=d.DateTimeFormat.shortDatePattern+" "+d.DateTimeFormat.longTimePattern,d.name=function(){return"ko-kr"},d.id=1042,d.isJCKCulture=!0,d}return b}(p),v={invariant:new p,"en-us":new r,"ja-jp":new s,"zh-cn":new t,"ko-kr":new u};function E(a,b,c){var d,e,f,g=this;for(e=0,f=b.length;e<f;e++)d=b[e],g[a][d]=c[e]}function F(a,b){if("object"==typeof document){var c;"function"!=typeof CustomEvent?(c=document.createEvent("CustomEvent"),c.initCustomEvent("cultureChanged",!1,!1,void 0)):c=new CustomEvent("cultureChanged",{}),c.cultureInfo=a,g.gcCultureInfo=a,g.gcCultureObj=b,document.dispatchEvent(c)}}w={},x=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],y=["wmk1","wmk2"],z=function(){function a(){this.bBb=1,this.OXc={}}return a.instance=function(){return this.cBb||(this.cBb=new this)},a.prototype.culture=function(b){return 0===arguments.length?a.dBb:void(b&&a.dBb!==b&&(a.dBb=b.toLowerCase(),this.bBb++,F(a.dBb,a.cBb.getCultureInfo())))},a.prototype.addCultureInfo=function(a,b,c){var d,f,g,h,i;if(b&&b instanceof p){if(d=b.NumberFormat&&b.NumberFormat.numberDecimalSeparator,f=b.NumberFormat.arrayListSeparator,g=b.NumberFormat.arrayGroupSeparator,d===b.NumberFormat.listSeparator||g===f)throw h=new e.ResourceManager(e.SR),h.getResource().Exp_Separator;v[a.toLowerCase()]=b}c&&"object"==typeof c&&(i=a.toLowerCase(),w[i]=k(!0,{},c),this.bBb++)},a.prototype.getCultureInfo=function(b){var c,d,e;if(0===arguments.length)return v[a.dBb];"string"==typeof b&&(b=b.toLowerCase()),c=v,d=i;for(e in c)if(e===b||c[e].id!==h&&c[e].id===b){d=c[e];break}return d},a.prototype.getLanguage=function(a){if("string"==typeof a){var b=a.toLowerCase();return w[b]}return i},a.prototype.getResources=function(a){var b,c=this.culture().toLowerCase();return a!==i&&a!==h||(a=c),"string"==typeof a&&(b=a.toLowerCase(),this.OXc[b])?this.PXc(this.OXc[b]):i},a.prototype.PXc=function(a){var b,c="PivotTables",d="Sheets",e="CalcEngine",f="Functions",g="TableFunctions",h=k(!0,{},a);return h[c]&&this.QXc(h[c],y),h[d]&&this.QXc(h[d],x),b=h[e],b&&(h[f]=b._h,h[g]=b.B2,delete b._h,delete b.B2),h},a.prototype.QXc=function(a,b){var c,d,e;for(c=0,d=b;c<d.length;c++)e=d[c],delete a[e]},a.prototype.eBb=function(a,b){var c,d,e=w[a.toLowerCase()];for(c in b)f.k.Bb(x,c)||(d=this.fBb(e,c),null!==d&&"string"==typeof d&&"string"==typeof b[c]&&(b[c]=d));b._h&&e.Functions&&this.gBb(e.Functions,b._h),b.B2&&e.TableFunctions&&k(!0,b.B2,e.TableFunctions)},a.prototype.fBb=function(a,b){var c,d;if(a.hasOwnProperty(b))return a[b];for(c in a)if(d=a[c],d&&"object"==typeof d&&d.hasOwnProperty(b))return d[b];return null},a.prototype.gBb=function(a,b){var c,d,e,f,g,h,i,j={};for(c in b)if(a.hasOwnProperty(c)){d=b[c],e=a[c],f=d.parameters,g=e.parameters,d.description=e.description;for(h in f)g.hasOwnProperty(h)&&(i=g[h],"string"==typeof i&&(f[h].name=i))}return j},a.prototype.q4=function(b){var c=this.getCultureInfo(b);return c||(c=v[a.dBb],c||(c=new p)),c},a.prototype.LZa=function(a,b){var c=this.getCultureInfo(a)||this.getCultureInfo("en-US"),d=c.DateTimeFormat,e=d.filterDialogDateFormatter;return(b.indexOf("g")>=0||b.indexOf("e")>=0)&&(e=d.EraFilterDialogDateFormatter||e),e},a.dBb="en-us",a}(),b.CultureManager=z.instance()}).call(this,c("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=null,e=void 0;function g(a,b){var c,e;for(c in b)b.hasOwnProperty(c)&&(e=b[c],Array.isArray(e)?(a[c]=[],g(a[c],b[c])):e!==d&&"object"==typeof e?(a[c]={},g(a[c],b[c])):a[c]=b[c])}f=function(){function a(){}return a.Eb=function(a,b,c){a.splice(b,0,c)},a.Sb=function(a,b){a.push(b)},a.Bb=function(a,b){return a.indexOf(b)>-1},a.Fb=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},a.Zb=function(a,b){return a.slice(0,b).concat(a.slice(b+1))},a.Cb=function(a,b,c){return a.indexOf(b,c)},a.$b=function(a,b,c){if(!(b<0))for(var e=0;e<c&&b+e<a.length;e++)a[b+e]=d},a._b=function(a,b){var c,f;for(b<0&&(b=-1),c=b+1,f=c;f<a.length;f++)if(a[f]!==e&&a[f]!==d)return f;return-1},a.ac=function(a){return a&&a.length},a.Uo=function(a){var b=[];return g(b,a),b},a}(),b.k=f},"./src/common/util/colorhelper.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/numberhelper.ts"),e=d.o.pb,f=Math.min,g=Math.max,h=Math.abs,i=parseInt;function m(a,b,c){return c<0&&(c+=240),c>240&&(c-=240),c<40?a+((b-a)*c+20)/40:c<120?b:c<160?a+((b-a)*(160-c)+20)/40:a}function n(a,b,c){var d,e,f,g,h;return 0===c?d=e=f=i(255*b/240+"",10):(g=void 0,h=void 0,h=b<=120?i((b*(240+c)+120)/240+""):b+c-i((b*c+120)/240+""),g=2*b-h,d=o(g,h,a+80),e=o(g,h,a),f=o(g,h,a-80)),{a:255,r:d,g:e,b:f}}function o(a,b,c){return f(i((255*m(a,b,c)+120)/240+""),255)}j=function(){function a(a){var b,c,d,e,h=this,j=a.r,k=a.g,l=a.b,m=g(g(j,k),l),n=f(f(j,k),l),o=m+n;h.kc=i((240*o+255)/510+"",10),b=m-n,0===b?(h.mc=0,h.lc=160):(h.kc<=120?h.mc=i((240*b+o/2)/o+"",10):h.mc=i((240*b+(510-o)/2)/(510-o)+"",10),c=(40*(m-j)+b/2)/b,d=(40*(m-k)+b/2)/b,e=(40*(m-l)+b/2)/b,j===m?h.lc=i(e-d+"",10):k===m?h.lc=i(80+c-e+"",10):h.lc=i(160+d-c+"",10),h.lc<0&&(h.lc+=240),h.lc>240&&(h.lc-=240))}return a.prototype.nc=function(a){var b=this,c=b.kc,d=b.oc(b.kc,500,!0);return n(b.lc,c+(d-c)*a,b.mc)},a.prototype.oc=function(a,b,c){return 0===b?a:c?b>0?(a*(1e3-b)+241*b)/1e3:a*(b+1e3)/1e3:(a+=240*b/1e3,a<0&&(a=0),a>240&&(a=240),a)},a}(),k=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/;function p(a){var b,c,d,e;return/^#[A-Fa-f0-9]+$/.test(a)?(b=a.replace(/^#/,""),c=b.length,d=b.split(3===c?/(.)/:/(..)/),d=d.filter(Boolean).map(function(a){return 3===c?parseInt(a+a,16):parseInt(a,16)}),d[0]||(d[0]=0),d[1]||(d[1]=0),d[2]||(d[2]=0),[d[0],d[1],d[2],1]):(e=k.exec(a),null!==e?[e[1],e[2],e[3],1]:null)}l=function(){function a(){}return a.bc=function(a){var b=a.a,c=a.r,d=a.g,f=a.b;return 3===arguments.length&&(b=255,c=arguments[0],d=arguments[1],f=arguments[2]),4===arguments.length&&(b=arguments[0],c=arguments[1],d=arguments[2],f=arguments[3]),255===b?"#"+e(c,!0,2)+e(d,!0,2)+e(f,!0,2):"rgba("+c+","+d+","+f+","+b+")"},a.Pka=function(a,b){return a.stops||a.type?JSON.stringify(a)===JSON.stringify(b):a.a===b.a&&a.r===b.r&&a.g===b.g&&a.b===b.b},a.dc=function(a){return(299*a.r+587*a.g+114*a.b)/1e3},a.hc=function(a,b){var c,d=255-h(a.r-b.r),e=255-h(a.g-b.g),f=255-h(a.b-b.b),g=h(a.a-b.a);return d/=255,e/=255,f/=255,c=(d+e+f)/3,!!(c>=.9&&g<=.05)},a.ic=function(b){var c=255^b.r,d=255^b.g,e=255^b.b;return a.bc(b.a,c,d,e)},a.hBb=function(b){var c,d,e;return"object"!=typeof document?p(b):(c=a.Yn,c||(d=document.createElement("canvas"),d&&d.getContext&&(c=a.Yn=d.getContext("2d"))),c?(c.clearRect(1,1,1,1),c.fillStyle=b,c.fillRect(1,1,1,1),e=c.getImageData(1,1,1,1),e?e.data:null):b)},a.ec=function(b){var c,d,e,f,g;return b instanceof a?b:null!==b&&"object"==typeof b?b:(c=0,d=0,e=0,f=0,b&&(g=a.hBb(b),g&&(d=g[0],e=g[1],f=g[2],c=g[3])),{a:c,r:d,g:e,b:f})},a.jc=function(b,c){var d,e;return 0===c?b:(d=new j(b),e=i((c>0?(240-d.kc)*c:d.kc*c)+"",10),a.gc(d.lc,d.kc+e,d.mc))},a.nc=function(b,c){var d=a.ec(b),e=new j(d),f=e.nc(c);return a.bc(f)},a.fc=m,a.gc=n,a}(),b.pc=l},"./src/common/util/common.ts":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/culture/cultureInfo.ts"),e=c("./src/common/util/util.res.en.ts"),f=c("./src/common/util/types.ts"),b.SR={en:e},g=f.j.Ia,h=function(){function a(a,b){this.res=a,this.RXc=b,this.OXc=d.CultureManager.OXc,this.cachedResource=this.iBb(a,!0),this.SXc(this.cachedResource,b),this.bBb=0}return a.prototype.getResource=function(){var a=this.iBb(this.res,!this.cachedResource);return a&&(this.cachedResource=a),this.SXc(this.cachedResource,this.RXc),this.cachedResource},a.prototype.SXc=function(a,b){var c,e;b&&(c=d.CultureManager.culture(),e=c.toLowerCase(),this.OXc[e]=this.OXc[e]||{},this.OXc[e][b]=a,d.CultureManager.OXc=this.OXc)},a.prototype.iBb=function(a,b){var c,e,f,h=d.CultureManager.culture();if(a&&h){if(c=d.CultureManager.bBb,this.bBb===c&&!b)return;return this.bBb=c,d.CultureManager.getLanguage(h)?(e=g(!0,{},a.en),d.CultureManager.eBb(h,e),e):(f=h.substr(0,2).toLowerCase(),a.hasOwnProperty(f)?a[f]:a.en)}return{}},a}(),b.ResourceManager=h;function i(a,b,c,d){var e,f,g,h,i;if(a&&0<=c&&c<b){for(e=[],f=void 0,g=void 0,g=c;g<b;g++)void 0!==a[g]&&e.push(g);for(f=e.length,g=0;g<f;g++)h=e[f-g-1],i=a[h],a[h]=null,a[Math.floor(h)+d]=i}}b.A=i;function j(a,b,c,d){var e,f,g,h,i,j;if(a&&0<=c&&c<b){for(e=[],f=void 0,g=c+d,h=void 0,h=c;h<b;h++)void 0!==a[h]&&(c<=h&&h<g?a[h]=null:h>=g&&e.push(h));for(f=e.length,h=0;h<f;h++)i=e[h],j=a[i],a[i]=null,a[Math.floor(i)-d]=j}}b.B=j;function k(a,b){return a.hasOwnProperty(b)}b.D=k;function l(a,b){return a instanceof b}b.F=l},"./src/common/util/datetimehelper.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/common.ts"),e=c("./src/common/util/stringhelper.ts"),f=c("./src/common/util/arrayhelper.ts"),g=c("./src/common/culture/cultureInfo.ts"),h=c("./src/common/util/types.ts"),i=h.j.Fa,j=e.u.Sa,k=null,l=parseInt,m=!1,n=!0,o=Math.floor,p=Math.abs,q=new d.ResourceManager(d.SR,"Common"),b.getSR=q.getResource.bind(q),r={};function t(a,b){if(d.HandleExcelSpecialDate)return d.HandleExcelSpecialDate.apply(null,[a,b]);switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate();default:return}}function u(a,c,d,e){var f,h,i,k,l,m,q,r,s,w,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=d.DateTimeFormat,N=M.Calendar.convert;if(!c||!c.length)return d&&d.name.length?N?u(a,M.fullDateTimePattern,d):a.toLocaleString():""+a;f=M.eras,h="s"===c,i="",q=/([^d]|^)(d|dd)([^d]|$)/g;function O(){return l||m?l:(l=q.test(c),m=n,l)}r=0,s=x(),!h&&N&&(w=N.fromGregorian(a));function P(a,b){return w?w[b]:t(a,b)}for(y=-2,z=-2,A={Qb:""},B=0;C=s.lastIndex,D=s.exec(c),E=c.slice(C,D?D.index:c.length),A.Qb="",r+=v(E,A),i+=A.Qb,D;B++)if(r%2!==1)switch(F=P(a,0),G=a.getDay(),H=a.getHours(),I=a.getMinutes(),J=a.getSeconds(),K=a.getMilliseconds(),L=a.getTimezoneOffset(),D[0]){case"dddd":i+=M.dayNames[G];break;case"ddd":i+=M.abbreviatedDayNames[G];break;case"dd":l=n,i+=j(P(a,2),2);break;case"d":l=n,i+=P(a,2);break;case"MMMM":i+=M.monthGenitiveNames&&O()?M.monthGenitiveNames[P(a,1)]:M.monthNames[P(a,1)];break;case"MMM":i+=M.abbreviatedMonthGenitiveNames&&O()?M.abbreviatedMonthGenitiveNames[P(a,1)]:M.abbreviatedMonthNames[P(a,1)];break;case"MM":i+=j(P(a,1)+1,2);break;case"M":i+=P(a,1)+1;break;case"yyyy":case"yyy":i+=y>=0?g.aBb.ia("ee",a,e):j(w?w[0]:F,4);break;case"yy":i+=y>=0?g.aBb.ia("ee",a,e):j((w?w[0]:F)%100,2);break;case"y":i+=y>=0?g.aBb.ia("e",a,e):""+(w?w[0]:F)%100;break;case"hh":k=H%12,0===k&&(k=12),i+=j(k,2);break;case"h":k=H%12,0===k&&(k=12),i+=k;break;case"HH":i+=j(H,2);break;case"H":i+=""+H;break;case"mm":i+=j(I,2);break;case"m":i+=""+I;break;case"ss":i+=j(J,2);break;case"s":i+=""+J;break;case"tt":i+=H<12?M.amDesignator:M.pmDesignator;break;case"t":i+=(H<12?M.amDesignator:M.pmDesignator).charAt(0);break;case"f":case"0":i+=j(K,3).charAt(0);break;case"ff":case"00":i+=j(K,3).substr(0,2);break;case"fff":case"000":i+=j(K,3);break;case"z":k=L/60,i+=(k<=0?"+":"-")+o(p(k));break;case"zz":k=L/60,i+=(k<=0?"+":"-")+j(o(p(k)),2);break;case"zzz":k=L/60,i+=(k<=0?"+":"-")+j(o(p(k)),2)+":"+j(p(L%60),2);break;case"g":case"gg":case"ggg":if(!f)break;if(y===B-1){y=B;break}i+=g.aBb.ia(D[0],a,e),y=B;break;case"e":case"ee":if(!f){i+=j(w?w[0]:F,4);break}if(z===B-1){z=B;break}i+=g.aBb.ia(D[0],a,e),z=B;break;case"/":i+=M.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":i+=D[0];break;default:throw Error(b.getSR().Exp_InvalidDateFormat)}else i+=D[0];return""+i}function v(a,b){var c,d,e,f=0,g=m;for(c=0,d=a.length;c<d;c++)switch(e=a.charAt(c)){case'"':g?b.Qb+="'":f++,g=m;break;case"\\":g&&(b.Qb+="\\"),g=!g;break;default:b.Qb+=e,g=m}return f}function w(a,b){var c,d=new Date,e=a.DateTimeFormat.eras;return e&&b<100&&(c=g.aBb.ca(d).ea,b+=c-c%100,b>a.DateTimeFormat.Calendar.TwoDigitYearMax&&(b-=100)),b}function x(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g;
}function y(a,c,d){var e,g,h,i,j,l,m,n,o,p,q;if(a.Rb){if(a.Rb[c])return a.Rb[c]}else a.Rb={};for(e=c,e=e.replace("%M","M"),e=e.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),g="^",h={Qb:""},i=[],j=0,l=0,m=x();(n=m.exec(e))!==k;)if(h.Qb="",o=e.slice(j,n.index),j=m.lastIndex,l+=v(o,h),g+=h.Qb,l%2!==1){switch(n[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":g+="(\\D+)";break;case"tt":case"t":g+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":g+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":g+=d?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":g+="(\\d{2}|\\d{4})";break;case"fff":case"000":g+="(\\d{3})";break;case"ff":case"00":g+="(\\d{2})";break;case"f":case"0":g+="(\\d)";break;case"zzz":g+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":g+="([+-]?\\d\\d?)";break;case"/":g+="/"===a.dateSeparator?"(\\/)":"([\\/\\"+a.dateSeparator+"])";break;default:throw Error(b.getSR().Exp_InvalidDateFormat)}f.k.Sb(i,n[0])}else g+=n[0];return h.Qb="",v(e.slice(j),h),g+=h.Qb,g+="$",p=(""+g).replace(/\s+/g,"\\s+"),q={Tb:p,Ub:i,_a:RegExp(p)},a.Rb[c]=q,q}function z(a){var b=a.getTimezoneOffset();return b===-485&&(b=-485-43/60),b===-321&&(b=-321-10/60),b===-507&&(b=-507-52/60),b}s=function(){function a(){}return a.mb=function(a,b,c,d){return c||(c=g.CultureManager.q4()),u(a,b,c,d)},a.Vb=function(a,b,c){return u(a,b,c||g.CultureManager.q4())},a.gBa=function(b,c,d){var e,f,g,h,i,j=m;for(i=d,i.slice(1).forEach(function(a){a&&(j=!0)}),j||(i=i.concat(c.ma())),f=i.length,e=1;e<f;e++)if(h=i[e],h&&(j=n,g=a.Wb(b,h,c)))return g;return k},a.Qa=function(b,c,d){var e,f;return c||d||(f=r[b],void 0===f)?(e=c?[b,c]:[b],f=a.gBa(b,d||g.CultureManager.q4(),e),c||d||(r[b]=f),f?new Date(f):f):f?new Date(f):f},a.lb=function(b,c){return a.gBa(b,g.CultureManager.q4("invariant"),[b,c])},a.Wb=function(a,b,c){var d,f,h,i,j,n,o,p,q,r,s,t,u,v,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;if(a=a.trim(),d=c.DateTimeFormat,f=1041===c.id,h=y(d,b,f),i=h._a.exec(a),i===k)return k;for(j=h.Ub,n=k,o=k,p=k,q=k,r=k,s=0,u=0,v=0,x=0,z=k,A=m,B=m,C=0,D=j.length;C<D;C++)if(E=i[C+1])switch(j[C]){case"dd":case"d":if(q=l(E,10),q<1||q>31)return k;break;case"MMMM":if(p=c.oa(E),p<0||p>11)return k;break;case"MMM":if(p=c.ra(E),p<0||p>11)return k;break;case"M":case"MM":case"%M":if(p=l(E,10)-1,p<0||p>11)return k;break;case"e":case"ee":if(o=f&&"\u5143"===E?1:w(c,l(E,10)),o<0||o>9999)return k;break;case"y":case"yy":case"yyy":case"yyyy":if(o=l(E,10),o<0||o>9999)return k;break;case"h":case"hh":case"H":case"HH":if(s=l(E,10),s<0)return k;break;case"m":case"mm":if(u=l(E,10),u<0||u>59)return k;break;case"s":case"ss":if(v=l(E,10),v<0||v>59)return k;break;case"tt":case"t":if(F=E.toUpperCase(),A=F===d.pmDesignator.toUpperCase(),B=F===d.amDesignator.toUpperCase(),!A&&!B)return k;break;case"f":case"0":if(x=100*l(E,10),x<0||x>999)return k;break;case"ff":case"00":if(x=10*l(E,10),x<0||x>999)return k;break;case"fff":case"000":if(x=l(E,10),x<0||x>999)return k;break;case"dddd":if(r=c.ua(E),r<0||r>6)return k;break;case"ddd":if(r=c.wa(E),r<0||r>6)return k;break;case"zzz":if(G=E.split(/:/),2!==G.length)return k;if(t=l(G[0],10),t<-12||t>13)return k;if(H=l(G[1],10),H<0||H>59)return k;z=60*t+(e.u.kb(E,"-")?-H:H);break;case"z":case"zz":if(t=l(E,10),t<-12||t>13)return k;z=60*t;break;case"g":case"gg":case"ggg":if(I=E,!I||!d.eras)return k;if(n=g.aBb.ha(j[C],I),n<0)return k}if(J=/^(\d|\d\d|\d\d\d):/.test(a),K=J?new Date(1899,11,30):new Date,M=d.Calendar.convert,M&&(L=M.fromGregorian(K)),M||(L=[K.getFullYear(),K.getMonth(),K.getDate()]),o===k?o=L[0]:o<100&&(d.eras&&n!==k?o=g.aBb.ga(n||0,o):o+=o>=30?1900:2e3),p===k&&(p=L[1]),q===k&&(q=J?L[2]:1),M){if(K=M.toGregorian(o,p,q),K===k)return k}else{if(K.setFullYear(o,p,q),K.getDate()!==q)return k;if(r!==k&&K.getDay()!==r)return k}return A&&s<12?s+=12:B&&12===s&&(s=0),K.setHours(s,u,v,x),z!==k&&(N=K.getMinutes()-(z+K.getTimezoneOffset()),K.setHours(K.getHours()+N/60,N%60)),K},a.Xb=function(a){var b,c=a-25569,d=new Date(864e5*c),e=c>=0?1:-1,f=z(d),g=(864e5*a*1440+e-3181192704e6+864e5*f)/1440,h=new Date(g),i=f>=0?1:-1,j=new Date(g+36e5*i),k=z(j);if(p(f-k)>=60)if(b=new Date(g+60*(k-f)*1e3),f>k){if(i===-1||k===z(h))return b=999===b.getMilliseconds()?new Date(b.valueOf()+1):b}else if(f<k&&(1===i||k===z(h)))return b=999===b.getMilliseconds()?new Date(b.valueOf()+1):b;return h=999===h.getMilliseconds()?new Date(h.valueOf()+1):h},a.Rka=function(b){if("/OADate("===b.substr(0,8)){var c=parseFloat(b.substr(8,b.length-10));return a.Xb(c)}},a.Daa=function(b){return"/OADate("+a.Ra(b)+")/"},a.Ra=function(a){if(i(a))return 0;"number"==typeof a&&(a=new Date(a));var b=z(a);return(1440*a.getTime()+3181192704e6-864e5*b)/124416e6},a.Yb=function(c){var d,e,f,g=k,h=n;if(i(c)?g=a.Xb(0):c instanceof Date?g=new Date(c.valueOf()):"string"==typeof c?(d=a.Qa(c),d||(isNaN(c)?a.fvb(c)?h=m:(d=new Date(c),isNaN(d.valueOf())&&(h=m),e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,f=e.exec(c.replace(/ |\n/g,"").trim()),f&&4===f.length&&(f.indexOf(""+d.getFullYear())!==-1&&f.indexOf(""+(d.getMonth()+1))!==-1&&f.indexOf(""+d.getDate())!==-1||(h=m))):(d=a.Xb(parseFloat(c)),d||(h=m))),g=d):"number"==typeof c?g=a.Xb(c):h=m,h)return g;throw b.getSR().Exp_InvalidCast},a.fvb=function(a){var b=g.CultureManager.q4().DateTimeFormat,c=function(a,b){var c=0;return b.forEach(function(b){b&&a.indexOf(b)>-1&&c++}),c>1},d=function(a,b){if(a&&a.indexOf(" ")>-1){var c=a.split(" "),d=c.length;return d>=2&&b.indexOf(c[d-2])<=-1&&!isNaN(c[d-1])}return!1};return c(a,b.monthNames)||c(a,b.abbreviatedMonthNames)||c(a,b.dayNames)||c(a,b.abbreviatedDayNames)||d(a,b.monthNames.concat(b.abbreviatedMonthNames))},a.Ska=function(a){return a&&(a.constructor===Date||a.getUTCDate&&a.setFullYear)},a}(),b.l=s},"./src/common/util/functionhelper.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=isNaN,e="rowCount",f="colCount";function g(a){return a}function h(a,b,c,g,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=c[e],M=c[f],N=b[e],O=b[f],P=g[e],Q=g[f],R=1===M,S=1===O;if(N===L&&O===M){for(E=0,F=0,G=0,H=0,u=L*M,o=0;o<L;o++)for(p=0;p<M;p++){if(r=i(c[o][p]),s=i(b[o][p]),a&&(d(r)||d(s)))return l;s=m(s),E+=r,F+=r*r,G+=s,H+=r*s}for(I=u*H-E*G,t=h?I/(u*F-E*E):H/F,v=h?(G*F-E*H)/(u*F-E*E):0,w=[],o=0;o<P;o++)for(w[o]=[],p=0;p<Q;p++){if(r=i(g[o][p]),a&&d(r))return l;w[o][p]=0===I?b[0][0]:n(t*r+v)}return j?new j(w):w}if(S&&N===L||1===N&&O===M){for(r=[],s=[],C=M+1,D=M+2,o=0;o<L;o++){if(y=S?b[o][0]:b[0][o],v=i(y),a&&d(v))return l;s[o]=R?m(v):v}for(o=0;o<L;o++)for(r[o]=[],p=0;p<M;p++){if(v=i(c[o][p]),a&&d(v))return l;r[o][p]=v}for(J=[],t=0;t<C;t++)for(J[t]=[],u=0;u<D;u++)J[t][u]=0;for(q=0;q<L;q++)for(J[0][C]+=s[q],o=0;o<M;o++)for(y=o+1,J[0][y]+=r[q][o],J[y][0]=J[0][y],J[y][C]+=r[q][o]*s[q],p=o;p<M;p++)A=p+1,J[A][y]+=r[q][o]*r[q][p],J[y][A]=J[A][y];for(J[0][0]=L,K=h?0:1,x=K;x<C;x++){if(a){if(0===J[x][x]){for(B=!1,p=x+1;!B&&p<C;p++)if(0!==J[p][x]){for(q=0;q<D;q++)A=J[x][q],J[x][q]=J[p][q],J[p][q]=A;B=!0}if(!B)return k}}else{for(o=x;o<C&&0===J[o][x];)o++;if(o>=C)return k;for(z=K;z<D;z++)y=J[x][z],J[x][z]=J[o][z],J[o][z]=y}for(y=1/J[x][x],z=K;z<D;z++)J[x][z]*=y;for(o=K;o<C;o++)if(o!==x)for(y=-J[o][x],z=0;z<D;z++)J[o][z]+=y*J[x][z];h||(J[0][C]=0)}for(w=[],S||(w[0]=[]),o=0;o<P;o++){for(S&&(w[o]=[]),y=J[0][C],p=0;p<M;p++){if(v=i(S?g[o][p]:g[p][o]),a&&d(v))return l;y+=J[p+1][C]*v}S?w[o][0]=n(y):w[0][o]=n(y)}return j?new j(w):w}return k}function i(a,b,c,d,e,f,i,j){return h(!0,a,b,c,d,e,f,j,i,g,g)}b.qc=i;function j(a,b,c,d,i,j,k){var l,m;for(l=0;l<a[e];l++)for(m=0;m<a[f];m++)if(a[l][m]<=0)return j;return h(!1,a,b,c,d,g,i,k,null,Math.log,Math.exp)}b.sc=j},"./src/common/util/numberhelper.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/common.ts"),e=c("./src/common/util/types.ts"),f=c("./src/common/util/regexhelper.ts"),g=c("./src/common/util/stringhelper.ts"),h=c("./src/common/culture/cultureInfo.ts"),i=e.j.Fa,j=g.u.Sa,k=g.u.Ta,l=null,m=void 0,n=parseInt,o=parseFloat,p=!1,q=!0,r=Math.floor,s=Math.abs,t=Math.pow,u=Math.min,v="#dot#",w="#group#",x=function(a,b,c){return a.substr(b,c)},y=function(a){return f.q.qb(a)},z=new d.ResourceManager(d.SR),A=z.getResource.bind(z),B="##################0",C="################",D={1:"+",0:"","-1":"-"},E=4294967295,F=["0","#","?"],G={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"};function H(a,b,c,d){return b&&0!==b.length&&"i"!==b?I(a,b,c.NumberFormat,d):c&&c.name.length>0?a.toLocaleString():""+a}function I(a,b,c,d){var e=L(b);return U(a,e,c,d)}function J(a,b){for(var c,d,e,f,g,h,i,j,k=r(s(a)),l={Xa:1,Ya:0};k>=10;)k/=10,l.Xa++;return c=""+a,d=c.search(/e/gi),e=c.indexOf(b),d!==-1?(g=x(c,0,d),h=x(c,d+1),i=0,e!==-1&&(i=x(g,e+1).length),j=o(h),f=i-j,f<0&&(f=0),l.Ya=f):(f=0,e!==-1&&(f=x(c,e+1).length),l.Ya=f),l}function K(a){var b,c={Za:a.charAt(0),$a:0,_a:0},d="";for(b=1;b<a.length;b++)if(d=a.charAt(b),"+"===d)c.$a=1;else{if("-"!==d){if("0"===d){c._a=a.length-b;break}throw Error(A().Exp_InvalidExponentFormat)}c.$a=-1}return c}function L(a){var b,c,d,e,f,g,h={ab:l,bb:l,cb:p,eb:0,fb:0,Rja:0,hb:l},i="",j=p,k=p,m=p,n=p,o=p,r=p,s=l,t=[];for(c=0;c<a.length;c++){if(b=a.charAt(c),j)i+=b,'"'===b&&(t.push(i),i="",j=p);else if(k){if("E"===s||"e"===s){if(!(["+","-","0"].indexOf(b)>=0)){k=p,c--;continue}i+=b}else if("+"===s||"-"===s){if("0"!==b){k=p,c--;continue}i+=b}else if("0"===s){if("0"!==b){k=p,o||(o=q,h.hb=K(i)),c--;continue}i+=b}}else if("*"!==s&&"_"!==s&&"\\"!==s||""===i)if("*"===b||"_"===b||"\\"===b)r=p,""!==i&&(t.push(i),i=""),i+=b;else if("'"===b)r=p,""!==i&&(t.push(i),i=""),t.push(b);else if('"'===b)r=p,j=q,""!==i&&(t.push(i),i=""),i+=b;else if(F.indexOf(b)>=0)r=q,F.indexOf(s)<0&&""!==i&&(t.push(i),i=""),i+=b;else if("."!==b||m)if("%"===b)r=p,h.fb++,""!==i&&(t.push(i),i=""),t.push(b);else if("\u2030"===b)r=p,h.Rja++,""!==i&&(t.push(i),i=""),t.push(b);else if(","===b)if(r){for(d=void 0,""!==i&&(t.push(i),i=""),e=q,f="",g=c+1;g<a.length;g++)if(d=a.charAt(g),""===f)if('"'===d)f=d;else{if(F.indexOf(d)>=0){e=p;break}if("."===d||";"===d)break}else'"'===d&&(f="");e?h.eb++:m||(d=a.charAt(c+1),d&&F.indexOf(d)>=0&&(n=q))}else i+=b;else"E"===b||"e"===b?(r=p,k=q,""!==i&&(t.push(i),i=""),i+=b):(r=p,F.indexOf(s)>=0&&""!==i&&(t.push(i),i=""),i+=b);else""!==i&&(t.push(i),i=""),h.ab=t,t=[],m=q,r=p;else i+=b,t.push(i),i="";s=b}return""!==i&&(k&&!o&&(h.hb=K(i)),t.push(i)),n&&(h.cb=q),m?h.bb=t:h.ab=t,h}function M(a,b,c,d){var e,f,g,h,i,j=b[0],k=1,l=0,m=p,n=a.length;for(e=0;e<n;e++)if(f=a[e].type,"number"===f){for(g="",h=a[e].value,i=h.length-1;i>=0;){if(!(1<=j&&j<=9||0===j&&k===b.length))throw Error(A().Exp_InvalidNumberGroupSize);/\d/gi.test(h[i])?(m&&(g&&a.push({type:"number",value:g}),a.push({type:"groupSeparator",value:c}),g="",m=p),l++):l=0,g=h[i]+g,l===j&&j>0&&(m=q,l=0,k<b.length&&(j=b[k],k++)),i--}g&&a.push({type:f,value:g})}else"fillingChar"===f&&(d.infillIndex=a.length-n),a.push({type:f,value:a[e].value});return a.splice(0,n)}function N(a,b,c,d,e,f){var g,h,i,l,m=Y(a,-b);return isFinite(m)||(m=a),a=m,g=""+a,l=g.split(/e/i),g=l[0],i=l.length>1?n(l[1],10):0,l=g.split("."),g=l[0],h=l.length>1?l[1]:"",i>0?(h=k(h,i),g+=h.slice(0,i),h=x(h,i)):i<0&&(i=-i,g=a<0?f+j(g.replace(f,""),i+1):j(g,i+1),h=g.slice(-i,g.length)+h,g=g.slice(0,-i)),b>0?(h=h.length>b?h.slice(0,b):k(h,b),h=e+h):h="",g+h}function O(a,b,c,d){var e=a;return b>0&&(e=_(e*t(100,b),15)),c>0&&(e=_(e*t(1e3,c),15)),d>0&&(e=_(e/t(1e3,d),15)),e}function P(a){var b,c,d=l;if(a)for(d="",b=0;b<a.length;b++)c=a[b],/^(0|#|\?)+/g.test(c)&&(d+=c);return d}function Q(a,b,c){var d,e={value:a,exponentValue:0},f=J(a,"."),g=f.Xa,h=s(a),i=c?c.length:1;if(h>=1)g>i?(g-=i,e.value=a/t(10,g),e.exponentValue=g):e.exponentValue=0,b.$a===-1&&(b.$a=0);else if(h<1&&h>0){for(b.$a=-1,d=t(10,i);10*h<d;)h*=10,e.exponentValue++;e.value*=t(10,e.exponentValue)}return e}function R(a,b,c,d,e,f,g,h){var i,k,l,m,n,o,p,r,s,t,u,v,w=h.numberGroupSizes,y=h.numberGroupSeparator,z=h.negativeSign,A=h.percentSymbol,B=h.perMilleSymbol,C=d.hb,E=x(b,0,1);for(E===z&&(b=x(b,1)),i=1===b.length&&"0"===b?0:b.length,b=0===i?"":b,k=0,l="",m=a.length-1;m>=0;m--)if(n="",o=a[m],/^(0|#|\?)+/g.test(o)){if(l!==c){for(p=o.length,r=i-k-1;r>=0&&p>0;r--)s=b.charAt(r),n=s+n,p--,k++;for(t=p-1;t>=0;t--)u=o[t],k++,"0"===u?n=u+n:"?"===u&&(""!==n&&(f.push({type:"number",value:n}),n=""),f.push({type:"numberPlaceholder",value:u}));l=o+l,l===c&&k<i&&(n=b.substr(0,i-k)+n),""!==n&&f.push({type:"number",value:n})}}else d.hb&&!g.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(o)?(g.replaceExponent=q,v="",v+=C.Za,v+=D[C.$a],v+=j(""+e,C._a),f.push({type:"exponent",value:v})):"_"===o[0]?f.push({type:"placeholder",value:o[1]}):"*"===o[0]?g.hasInfilling||(f.push({type:"fillingChar",value:o[1]}),g.hasInfilling=!0,g.infillIndex=f.length-1):"\\"===o[0]?2===o.length&&f.push({type:"text",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&f.push({type:"text",value:o.substr(1,o.length-2)}):o===A?f.push({type:"percent",value:o}):o===B?f.push({type:"permille",value:o}):G[o]?f.push({type:"currency",value:o}):f.push({type:"text",value:o});E===z&&c&&f.push({type:"text",value:E}),d.cb===q&&M(f,w,y,g),f.reverse(),g.infillIndex=f.length-1-g.infillIndex}function S(a,b,c,d,e,f,g,h,i){var k,l,m,n,o,p,r,s,t,u,v,w,x=i.numberDecimalSeparator,y=i.percentSymbol,z=i.perMilleSymbol,A=b.indexOf(x),E=e.hb;for((A>0||d!==B||c!==C)&&g.push({type:"decimalSeparator",value:x}),k=A!==-1?b.substring(A+1):"",l=0,m="",n=0;n<a.length;n++)if(o=a[n],/^(0|#|\?)+/g.test(o)){if(p="",m!==c){for(r=o.length,s=0,t=l;r>0&&k.length-l>0;)p+=k.charAt(t),r--,l++,s++,t++;for(u=s;r>0;)v=o[u],u++,l++,r--,"0"===v?p+=v:"?"===v&&(""!==p&&(g.push({type:"number",value:p}),p=""),g.push({type:"numberPlaceholder",value:v}));""!==p&&g.push({type:"number",value:p}),m+=o}}else E&&!h.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(o)?(h.replaceExponent=q,w="",w+=E.Za,w+=D[E.$a],w+=j(""+f,E._a),g.push({type:"exponent",value:w})):"_"===o[0]?g.push({type:"placeholder",value:o[1]}):"*"===o[0]?(g.push({type:"fillingChar",value:o[1]}),h.hasInfilling&&g.splice(h.infillIndex,1),h.hasInfilling=!0,h.infillIndex=g.length-1):"\\"===o[0]?2===o.length&&g.push({type:"text",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&g.push({type:"text",value:o.substr(1,o.length-2)}):o===y?g.push({type:"percent",value:o}):o===z?g.push({type:"permille",value:o}):G[o]?g.push({type:"currency",value:o}):g.push({type:"text",value:o})}function T(a,b){var c=a,d=a.indexOf(b);return d!==-1&&(c=a.replace(/0+$/,"")),c}function U(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,v,w=[];return a=O(a,b.fb,b.Rja,b.eb),e=b.ab,f=b.bb,e||f?(g=P(e),h=P(f),h||(h=""),b.hb&&(j=Q(a,b.hb,g),a=j.value,i=j.exponentValue),k=J(a,"."),k.Xa+k.Ya>15&&(a=_(a,15)),l=c.numberGroupSizes,m=c.numberGroupSeparator,n=c.numberDecimalSeparator,o=c.negativeSign,q=u(k.Ya,h.length),r=N(a,q,l,m,n,o),d||(r=T(r,n)),""===r?(w.push({type:"text",value:(e?e.join(""):"")+(f?f.join(""):"")}),w):(s={hasInfilling:p,infillIndex:-1,replaceExponent:p},t=r.split(n)[0],"10"!==t||isNaN(i)||(t="1",v=b&&b.hb&&b.hb.$a===-1,i+=v?-1:1),e&&R(e,t,g,b,i,w,s,c),"0"!==t&&""===g&&f&&w.push({type:"number",value:t}),f&&S(f,r,h,g,b,i,w,s,c),w)):w}function V(a,b){var c,d,e,f,h,j,k,m,p,q,r,s,t,u,v,w,y;return a=i(a)?"":g.u.ib(a,""),a.match(/^[+-]?infinity$/i)?o(a):a.match(/^0x[a-f0-9]+$/i)?n(a,10):(c=b.NumberFormat,d=c.numberNegativePattern,e=W(a,c,d),f=e[0],h=e[1],""===f&&1!==d&&(e=W(a,c,1),f=e[0],h=e[1]),""===f&&(f="+"),h[0]===c.currencySymbol&&(h=x(h,1)),m=h.indexOf("e"),m<0&&(m=h.indexOf("E")),m<0?(k=h,j=l):(k=x(h,0,m),j=x(h,m+1)),r=k.indexOf("."),r<0?(p=k,q=l):(p=x(k,0,r),q=x(k,r+1)),p=p.split(",").join(""),s=",".replace(/\u00A0/g," "),","!==s&&(p=p.split(s).join("")),t=f+p,q!==l&&(t+="."+q),u=t[t.length-1],u===c.percentSymbol&&(t=x(t,0,t.length-1),t=g.u.ib(t,""),v=t.indexOf("."),v===-1&&(v=t.length),w="",w+=x(t,0,v-2),w+=".",w+=x(t,v-2,2),w+=x(t,v+1),t=w),j!==l&&(y=W(j,c,1),""===y[0]&&(y[0]="+"),t+="e"+y[0]+y[1]),t.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?o(t):NaN)}function W(a,b,c){var d=b.negativeSign,e=b.positiveSign;if(4!==c&&2!==c||(d=" "+d,e=" "+e),4===c||3===c){if(g.u.jb(a,d))return["-",x(a,0,a.length-d.length)];if(g.u.jb(a,e))return["+",x(a,0,a.length-e.length)]}else if(2===c||1===c){if(g.u.kb(a,d))return["-",x(a,d.length)];if(g.u.kb(a,e))return["+",x(a,e.length)]}else{if(0!==c)throw Error("");if(g.u.kb(a,"(")&&g.u.jb(a,")"))return["-",x(a,1,a.length-2)]}return["",a]}function X(a,b,c){if(0!==s(r(a)-a))throw Error(A().Exp_BadFormatSpecifier);var d=a>=0?a.toString(16):(E+a+1).toString(16);return d=b?d.toLowerCase():d.toUpperCase(),!i(c)&&d.length<c?j(d,c):d}function Y(a,b){var c,d;return a=+a,b=+b,isNaN(a)||b%1!==0?NaN:(c=a<0,a=c?-a:a,typeof b===m||0===b?(a=Math.round(a),c?-a:a):(d=(""+a).split("e"),a=Math.round(+(d[0]+"e"+(d[1]?+d[1]-b:-b))),a=c?-a:a,d=(""+a).split("e"),+(d[0]+"e"+(d[1]?+d[1]+b:b))))}function Z(a){var b=h.CultureManager.q4().NumberFormat;return"string"==typeof a&&(b=h.CultureManager.q4(a).NumberFormat),b}function $(a){var b,c,d,e="";if(Array.isArray(a)&&a.length>0)for(b=0;b<a.length;b++)if(c=a[b].type,d=a[b].value,"placeholder"===c)e+=" ";else{if("fillingChar"===c)continue;e+="numberPlaceholder"===c?" ":d}return e}function _(a,b){return"number"==typeof a&&(""+a).length>=b&&(a=+a.toPrecision(b)),a}b.o={Qa:function(a){return V(a,h.CultureManager.q4())},lb:function(a){return V(a,h.CultureManager.q4("invariant"))},mb:function(a,b,c,d){return c||(c=h.CultureManager.q4()),H(a,b,c,d)},nb:function(a,b){var c,d,e;return"string"!=typeof a?a:(c=Z(b),d=c.numberDecimalSeparator,e=c.numberGroupSeparator,"."!==d&&(a=a.replace(y("[.]"),v)),","!==e&&(a=a.replace(y("[,]"),w)),"."!==d&&(a=a.replace(y(v),d)),","!==e&&(a=a.replace(y(w),e)),a)},Oa:function(a,b){var c,d,e;return"string"!=typeof a?a:(c=Z(b),d=c.numberDecimalSeparator,e=c.numberGroupSeparator,"."!==d&&(a=a.replace(y("["+d+"]"),v)),","!==e&&(a=a.replace(y("["+e+"]"),w)),"."!==d&&(a=a.replace(y(v),".")),","!==e&&(a=a.replace(y(w),",")),a)},Xia:function(a,b){var c,d,e;return!("string"==typeof a&&(c=Z(b),d=c.numberDecimalSeparator,e=c.numberGroupSeparator,"."!==d&&"."!==e&&a.indexOf(".")>=0||","!==d&&","!==e&&a.indexOf(",")>=0))},ob:function(a,b){return o(this.Oa(a,b))},pb:X,Hja:L,Ija:U,Jja:$,eka:B,fka:C,Lma:_}},"./src/common/util/rbush.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});function d(a,b){this.TMc=Math.max(4,a||9),this.UMc=Math.max(2,Math.ceil(.4*this.TMc)),b&&this.VMc(b),this.clear()}b.rbush=d,d.prototype={all:function(){return this.zR(this.data,[])},search:function(a){var b,c,d,e,f,g=this.data,h=[],i=this.toBBox;if(!p(a,g))return h;for(b=[];g;){for(c=0,d=g.children.length;c<d;c++)e=g.children[c],f=g.leaf?i(e):e,p(a,f)&&(g.leaf?h.push(e):o(a,f)?this.zR(e,h):b.push(e));g=b.pop()}return h},collides:function(a){var b,c,d,e,f,g=this.data,h=this.toBBox;if(!p(a,g))return!1;for(b=[];g;){for(c=0,d=g.children.length;c<d;c++)if(e=g.children[c],f=g.leaf?h(e):e,p(a,f)){if(g.leaf||o(a,f))return!0;b.push(e)}g=b.pop()}return!1},insert:function(a){return a&&this.Eb(a,this.data.height-1),this},clear:function(){return this.data=q([]),this},remove:function(a,b){if(!a)return this;for(var c=this.data,d=this.toBBox(a),f=[],g=[],h,i,j,k;c||f.length;){if(c||(c=f.pop(),i=f[f.length-1],h=g.pop(),k=!0),c.leaf&&(j=e(a,c.children,b),j!==-1))return c.children.splice(j,1),f.push(c),this.WMc(f),this;k||c.leaf||!o(c,d)?i?(h++,c=i.children[h],k=!1):c=null:(f.push(c),g.push(h),h=0,i=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:i,compareMinY:j,toJSON:function(){return this.data},fromJSON:function(a){return this.data=a,this},zR:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},XMc:function(a,b,c,d){for(var e,f,g,h,i,j,l,n;;){if(d.push(b),b.leaf||d.length-1===c)break;for(l=n=1/0,e=0,f=b.children.length;e<f;e++)g=b.children[e],i=k(g),j=m(a,g)-i,j<n?(n=j,l=i<l?i:l,h=g):j===n&&i<l&&(l=i,h=g);b=h||b.children[0]}return b},Eb:function(a,b,c){var d=this.toBBox,e=c?a:d(a),f=[],g=this.XMc(e,this.data,b,f);for(g.children.push(a),h(g,e);b>=0&&f[b].children.length>this.TMc;)this.YMc(f,b),b--;this.ZMc(e,f,b)},YMc:function(a,b){var c,d,e=a[b],g=e.children.length,h=this.UMc;this.$Mc(e,h,g),c=this._Mc(e,h,g),d=q(e.children.splice(c,e.children.length-c)),d.height=e.height,d.leaf=e.leaf,f(e,this.toBBox),f(d,this.toBBox),b?a[b-1].children.push(d):this.aNc(e,d)},aNc:function(a,b){this.data=q([a,b]),this.data.height=a.height+1,this.data.leaf=!1,f(this.data,this.toBBox)},_Mc:function(a,b,c){var d,e,f,h,i,j,l,m;for(j=l=1/0,d=b;d<=c-b;d++)e=g(a,0,d,this.toBBox),f=g(a,d,c,this.toBBox),h=n(e,f),i=k(e)+k(f),h<j?(j=h,m=d,l=i<l?i:l):h===j&&i<l&&(l=i,m=d);return m},$Mc:function(a,b,c){var d=a.leaf?this.compareMinX:i,e=a.leaf?this.compareMinY:j,f=this.bNc(a,b,c,d),g=this.bNc(a,b,c,e);f<g&&a.children.sort(d)},bNc:function(a,b,c,d){a.children.sort(d);var e=this.toBBox,f=g(a,0,b,e),i=g(a,c-b,c,e),j=l(f)+l(i),k,m;for(k=b;k<c-b;k++)m=a.children[k],h(f,a.leaf?e(m):m),j+=l(f);for(k=c-b-1;k>=b;k--)m=a.children[k],h(i,a.leaf?e(m):m),j+=l(i);return j},ZMc:function(a,b,c){for(var d=c;d>=0;d--)h(b[d],a)},WMc:function(a){for(var b=a.length-1,c=void 0;b>=0;b--)0===a[b].children.length?b>0?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():f(a[b],this.toBBox)},VMc:function(a){var b=["return a"," - b",";"];this.compareMinX=Function("a","b",b.join(a[0])),this.compareMinY=Function("a","b",b.join(a[1])),this.toBBox=Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};function e(a,b,c){if(!c)return b.indexOf(a);for(var d=0;d<b.length;d++)if(c(a,b[d]))return d;return-1}function f(a,b){g(a,0,a.children.length,b,a)}function g(a,b,c,d,e){e||(e=q(null)),e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0);for(var f=b,g=void 0;f<c;f++)g=a.children[f],h(e,a.leaf?d(g):g);return e}function h(a,b){return a.minX=Math.min(a.minX,b.minX),a.minY=Math.min(a.minY,b.minY),a.maxX=Math.max(a.maxX,b.maxX),a.maxY=Math.max(a.maxY,b.maxY),a}function i(a,b){return a.minX-b.minX}function j(a,b){return a.minY-b.minY}function k(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function l(a){return a.maxX-a.minX+(a.maxY-a.minY)}function m(a,b){return(Math.max(b.maxX,a.maxX)-Math.min(b.minX,a.minX))*(Math.max(b.maxY,a.maxY)-Math.min(b.minY,a.minY))}function n(a,b){var c=Math.max(a.minX,b.minX),d=Math.max(a.minY,b.minY),e=Math.min(a.maxX,b.maxX),f=Math.min(a.maxY,b.maxY);return Math.max(0,e-c)*Math.max(0,f-d)}function o(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&(b.maxX>=0&&b.maxX<=a.maxX||a.maxX<0)&&(b.maxY>=0&&b.maxY<=a.maxY||a.maxY<0)}function p(a,b){return(a.minY===-1||b.minY===-1||a.minY<=b.maxY&&b.minY<=a.maxY)&&(a.minX===-1||b.minX===-1||a.minX<=b.maxX&&b.minX<=a.maxX)}function q(a){return{children:a,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)}}},"./src/common/util/regexhelper.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/stringhelper.ts"),e=!0,f=function(){function a(){}return a.qb=function(b){var c=a.rb[b];return c||(c=a.rb[b]=RegExp(b,"g")),c.lastIndex=0,c},a.sb=function(b){var c=a.tb[b];return c||(c=a.tb[b]=RegExp(b,"gi")),c.lastIndex=0,c},a.ub=function(b,c,d){var f,g,h,i,j,k;if(a.vb[b])return a.wb[b];if(f="[~?*]+",a.qb(f).test(b)){for(g=[],h=b.split(""),i=void 0,j={".":e,"+":e,$:e,"^":e,"[":e,"]":e,"(":e,")":e,"{":e,"}":e,"|":e,"/":e,"\\":e},k=0;k<h.length;k++)i=h[k],"~"===i&&k<h.length-1?(k++,i=h[k],"*"===i||"?"===i?g.push("\\"):c&&g.push("~"),g.push(i)):"?"===i?g.push("."):"*"===i?(g.push("[\\s\\S]"),d?g.push("+"):g.push("*")):j[i]?(g.push("\\"),g.push(i)):g.push(i);return g.join("")}return null},a.zb=function(b,c,d){var e=a.ub(b,c,d);return e&&(e="^"+e+"$"),e},a.xb=function(a,b){for(var c="#"+a+"0#",e=1;b.indexOf(c)>0;)c=d.u.yb(c,"#"+a+(e-1)+"#","#"+a+e+"#"),e++;return c},a.Ab=function(a){return a.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},a.rb={},a.tb={},a.vb={},a.wb={},a}(),b.q=f},"./src/common/util/stringhelper.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./src/common/util/regexhelper.ts");function e(a,b,c){return a.substr(b,c)}function f(a){return null===a||void 0===a}function g(a,b,c,d){var e,g;if(f(b))throw Error();return""===b||!(b.length>a.length)&&(e=a,g=b,c&&(e=e.toLowerCase(),g=g.toLowerCase()),d(e,g))}b.u={Bb:function(a,b,c){return c&&(a=a.toLowerCase(),b=b.toLowerCase()),""===b||a.indexOf(b)>=0},Cb:function(a,b,c){var d,e;return c?(d=a.toLowerCase(),e=b.toLowerCase(),d.indexOf(e)):a.indexOf(b)},Db:function(a,b){if(!b)return a;for(var c=a;e(c,0,b.length)===b;)c=e(c,b.length);return c},ib:function(a,b){if(!b)return a;for(var c=a;e(c,c.length-b.length,b.length)===b;)c=e(c,0,c.length-b.length);return c},Eb:function(a,b,c){var d,g;if(b<0||b>a.length||f(c))throw Error();return d=e(a,0,b),g=e(a,b,a.length-b),d+c+g},Fb:function(a,b,c){var d,g;if(f(c)&&(c=a.length-b),b<0||c<0||b+c>a.length)throw Error();return d=e(a,0,b),g=e(a,b+c,a.length-b-c),d+g},kb:function(a,b,c){return void 0===c&&(c=!1),g(a,b,c,function(a,b){return a.slice(0,b.length)===b})},jb:function(a,b,c){return void 0===c&&(c=!1),g(a,b,c,function(a,b){return a.slice(-b.length)===b})},Gb:function(a,b,c,d){if(!b)throw Error();return c=(""+c).replace(/\$/g,"$$$$"),a.replace(RegExp(b,"g"+(d?"i":"")),c)},Hb:function(a,c,e,f){return c=d.q.Ab(c),b.u.Gb(a,c,e,f)},Ib:function(a,b){var c=a.indexOf(b);return c<0||c>=a.length?a:e(a,0,c)},Jb:function(a,b){for(var c=0,d=a.indexOf(b);d>=0;)c+=1,d=a.indexOf(b,d+1);return c},yb:function(a,b,c){return a.split(b).join(c)},Kb:function(a,b){var c,d,e=a;for(c=0;c<b.length;c++)d=RegExp("\\{"+c+"\\}","g"),e=e.replace(d,b[c]);return e},Lb:function(a,b,c){var d,e=""+a;for(d=e.length;d<b;d++)e=c?"0"+e:e+"0";return e},Sa:function(a,c){return b.u.Lb(a,c,!0)},Ta:function(a,c){return b.u.Lb(a,c,!1)},Mb:function(a,b){return a===b||!a&&!b||a&&b&&a.toLowerCase()===b.toLowerCase()},Nb:function(a){return a.toUpperCase()},Ob:function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=d.q.qb("(?:&|<|>|\"|'|`)");return c.test(a)?a.replace(c,function(a){return b[a]}):a},Pb:function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},c=d.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return c.test(a)?a.replace(c,function(a){return b[a]}):a},BIc:function(a){var b=/javascript:/gi;return a.replace(b,"")}}},"./src/common/util/types.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.j={r4:null,H:function(a,c){var d,e,f,g;if(b.j.ya(a))for(e=0,f=a.length;e<f&&(d=c.call(a[e],e,a[e]),d!==!1);e++);else for(g in a)if(a.hasOwnProperty(g)&&(d=c.call(a[g],g,a[g]),d===!1))break;return a},za:function(a){return!a||"object"==typeof a&&0===Object.keys(a).length},Aa:function(a){return"function"===b.j.Ba(a)},Ca:function(a){return Array.isArray?Array.isArray(a):"array"===b.j.Ba(a)},Da:function(a){return b.j.jk(a)&&(a=parseFloat(a)),!isNaN(a)&&isFinite(a)},jk:function(a){return"string"==typeof a},Ba:function(a){var c,d,e,f,g,h;if(null===a)return"null";if(c=b.j.r4,!c)for(c=b.j.r4={},d=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],e=0,f=d.length;e<f;e++)c["[object "+d[e]+"]"]=d[e].toLowerCase();return g=c.toString,h=typeof a,"object"===h||"function"===h?c[g.call(a)]||"object":h},Ea:function(a,c,d){var e,f;if(c){if(f=[].indexOf)return f.call(c,a,d);for(e=c.length,b.j.Fa(d)&&(d=0),d=d<0?Math.max(0,e+d):d;d<e;d++)if(d in c&&c[d]===a)return d}return-1},Ga:function(a,b){var c=b.length,d=a.length,e=0;if("number"==typeof c)for(;e<c;e++)a[d]=b[e],d++;else for(;void 0!==b[e];)a[d]=b[e],d++,e++;return a.length=d,a},Ha:function(a,c,d){var e,f,g,h,i=[];if(b.j.ya(a))for(f=0,g=a.length;f<g;f++)e=c(a[f],f,d),null!==e&&(i[i.length]=e);else{h=void 0;for(h in a)a.hasOwnProperty(h)&&(e=c(a[h],h,d),null!==e&&(i[i.length]=e))}return i.concat([])},Ia:function(){var a,c,d,e,f,g,h,i,j,k,l,m=[];for(a=0;a<arguments.length;a++)m[a]=arguments[a];for(i=m[0]||{},j=1,k=m.length,l=!1,"boolean"==typeof i&&(l=i,i=m[1]||{},j=2),"object"==typeof i||b.j.Aa(i)||(i={}),k===j&&(i=this,--j);j<k;j++)if(g=m[j],!b.j.Fa(g))for(f in g)c=i[f],e=g[f],i!==e&&(d=b.j.Ca(e),l&&e&&(b.j.Ja(e)||d)?(h=d?c&&b.j.Ca(c)?c:[]:c&&b.j.Ja(c)?c:{},i[f]=b.j.Ia(l,h,e)):void 0!==e&&(i[f]=e));return i},G:function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);function d(){this.constructor=a}d.prototype=b.prototype,a.prototype=new d},Ka:function(a){return null!==a&&a===a.window},Ja:function(a){var c,d;if(!a||"object"!==b.j.Ba(a)||a.nodeType||b.j.Ka(a))return!1;c={}.hasOwnProperty;try{if(a.constructor&&!c.call(a,"constructor")&&!c.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}for(d in a);return void 0===d||c.call(a,d)},ya:function(a){if(b.j.Fa(a))return!1;var c=a.length,d=b.j.Ba(a);return!b.j.Ka(a)&&(!(1!==a.nodeType||!c)||("array"===d||"function"!==d&&(0===c||"number"==typeof c&&c>0&&c-1 in a)))},La:function(a,c){var d=c||[];return null!==a&&(b.j.ya(Object(a))?b.j.Ga(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d},Ma:null,Fa:function(a){return void 0===a||null===a},Na:null,Pa:null,
C4:function(a){if(!a)return a;if("number"==typeof a||"string"==typeof a||"boolean"==typeof a||b.j.Fa(a))return a;if(a.clone)return a.clone();if(a instanceof Date)return new Date(a.valueOf());var c,d,e;c=a instanceof Object?new a.constructor:new a.constructor(a.valueOf());for(d in a)a.hasOwnProperty(d)&&(e=a[d],a.hasOwnProperty(d)&&c[d]!==e&&("object"==typeof e?c[d]=b.j.C4(e):c[d]=e));return c.toString=a.toString,c.valueOf=a.valueOf,c}}},"./src/common/util/util.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_InvalidDateFormat="Invalid date format pattern",b.Exp_InvalidExponentFormat="invalid exponent format",b.Exp_InvalidSemicolons="invalid format : too many semicolons",b.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",b.Exp_BadFormatSpecifier="Bad Format Specifier",b.Exp_InvalidNumberFormat="Invalid number format pattern",b.Exp_InvalidCast="InvalidCastException",b.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."},"./src/plugins/commands/commands.entry.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/plugins/commands/commands.ts"),b.Key=d.Key,b.CommandManager=d.CommandManager,e=c("./src/plugins/commands/undomanager.ts"),b.UndoManager=e.UndoManager},"./src/plugins/commands/commands.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.left=37]="left",a[a.right=39]="right",a[a.up=38]="up",a[a.down=40]="down",a[a.tab=9]="tab",a[a.enter=13]="enter",a[a.shift=16]="shift",a[a.ctrl=17]="ctrl",a[a.space=32]="space",a[a.altkey=18]="altkey",a[a.home=36]="home",a[a.end=35]="end",a[a.pup=33]="pup",a[a.pdn=34]="pdn",a[a.backspace=8]="backspace",a[a.del=46]="del",a[a.esc=27]="esc",a[a.a=65]="a",a[a.c=67]="c",a[a.v=86]="v",a[a.x=88]="x",a[a.z=90]="z",a[a.y=89]="y"}(d=b.Key||(b.Key={})),e=function(){function a(a,b,c){var d,e;this.tc=a,this.j4=b,this.Cj=c,d=this,Object.defineProperty(d,"shortcutKey",{get:function(){return d.vc},set:function(a){var b,c,f=d.vc;f!==a&&(e=d.tc.wc,b=e[f],b&&(c=b.indexOf(d),c>=0&&b.splice(c,1)),d.vc=a,a&&(b=e[a],b||(e[a]=b=[]),b.splice(0,0,d)))}})}return a.prototype.canUndo=function(){var a=this.j4;return a.canUndo},a.prototype.execute=function(a,b,c){var d,e,f=this,g=!0;f.j4&&b&&f.j4.canUndo&&f.tc.cNc({command:b,result:d,s4:c,actionType:c});try{e=f.j4.execute||f.j4,d=e(a,b,1===c),g=d!==!1}catch(a){g=!1}return b&&g&&f.tc.g4({command:b,result:d,s4:c,actionType:c}),d},a}(),f=function(){function a(a){this.xc=a,this.Ze={},this.dNc={},this.wc={}}return a.prototype.register=function(a,b,c,d,f,g,h){var i=this,j=new e(i,b,a);i[a]=j,c&&(j.shortcutKey=i.getShortcutKey(c,d,f,g,h))},a.prototype.getCommand=function(a){return this[a]},a.prototype.execute=function(a){var b=this[a.cmd];if(b)return b.execute(this.xc,a,0)},a.prototype.setShortcutKey=function(a,b,c,d,e,f){var g,h,i,j,k=this;if(a)g=k[a],g&&(g.shortcutKey=k.getShortcutKey(b,c,d,e,f));else if(h=k.getShortcutKey(b,c,d,e,f),i=k.getCommands(h))for(j=i.length-1;j>=0;j--)i[j].shortcutKey=void 0},a.prototype.getShortcutKey=function(a,b,c,e,f){if(a){var g="A".charCodeAt(0)<=a&&a<="Z".charCodeAt(0)?String.fromCharCode(a):d[a];return g||(g=a),""+g+(b?"+ctrl":"")+(c?"+shift":"")+(e?"+alt":"")+(f?"+window":"")}},a.prototype.getCommands=function(a){return this.wc[a]},a.prototype.addListener=function(a,b){this.Ze[a]=b},a.prototype.removeListener=function(a){delete this.Ze[a]},a.prototype.g4=function(a){var b,c=this.Ze;for(b in c)c.hasOwnProperty(b)&&c[b](a)},a.prototype.EKc=function(a,b){this.dNc[a]=b},a.prototype.eNc=function(a){delete this.dNc[a]},a.prototype.cNc=function(a){var b,c=this.dNc;for(b in c)c.hasOwnProperty(b)&&c[b](a)},a.prototype.no=function(){this.xc=null},a}(),b.CommandManager=f},"./src/plugins/commands/undomanager.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b,c){var d=this;d.xc=a,b<0&&(b=2147483647),d.yc=b,d.zc=c,d.Ac=[],d.Bc=[]}return a.prototype.Cc=function(a,b){var c,d,e,f=this;if(a)if(1===b)f.Bc.push(a);else{if(c=f.yc,d=f.Ac.length,c>0&&d>=c)for(e=0;e<d-c+1;e++)f.Ac.shift();f.Ac.push(a),0===b&&(f.Bc=[])}},a.prototype.canUndo=function(){return this.Ac.length>0},a.prototype.undo=function(){var a,b,c=this,d=c.Ac,e=!0;if(c.zc&&c.canUndo()){a=d[d.length-1];try{b=c.xc.commandManager()[a.cmd],b&&(a.yTa=!0,e=b.execute(c.xc,a,1))}catch(a){e=!1}delete a.yTa,e!==!1&&(d.pop(),c.Bc.push(a))}return e},a.prototype.canRedo=function(){return this.Bc.length>0},a.prototype.redo=function(){var a,b,c=this,d=c.Bc,e=!0;if(c.zc&&c.canRedo()){a=d[d.length-1];try{b=c.xc.commandManager()[a.cmd],b&&(a.yTa=!0,e=b.execute(c.xc,a,2))}catch(a){e=!1}delete a.yTa,e!==!1&&(d.pop(),c.Ac.push(a))}return e},a.prototype.getRedoStack=function(){return this.Bc.slice()},a.prototype.getUndoStack=function(){return this.Ac.slice()},a.prototype.maxSize=function(a){var b=this;return arguments.length<1?b.yc:(a>=0&&(b.yc=a),b)},a.prototype.clear=function(){this.Ac=[],this.Bc=[]},a.prototype.PY=function(a){this.Ac=this.Ac.filter(a),this.Bc=this.Bc.filter(a)},a.prototype.no=function(){this.xc=null},a}();b.UndoManager=d},"./src/plugins/formatter/formatter.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_TokenIsNull="token is null",b.Exp_InvalidBackslash="the '\\' cannot be evaluated",b.Exp_FormatIllegal="format is illegal.",b.Exp_ValueIsNull="value is null",b.Exp_DuplicatedDescriptor="The type of descriptor was added.",b.Exp_TokenIllegal="token is illegal.",b.Exp_ValueIllegal="value is illegal.",b.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/stringhelper.ts"),e=c("./src/common/util/datetimehelper.ts"),f=c("./src/common/util/types.ts"),g=c("./src/common/util/numberhelper.ts"),h=c("./src/common/culture/cultureInfo.ts"),i=c("./src/common/util/common.ts"),j=c("./src/plugins/formatter/formatter.res.en.ts"),f.j.Ia(i.SR.en,j),k=new i.ResourceManager(i.SR),l=k.getResource.bind(k),f.j.Ma=function(a,b){if(f.j.Fa(a))return"null"===b;if(!b)return!1;if(b instanceof Function&&a instanceof b)return!0;if(typeof a===b)return!0;if("function"===b&&/^\s*\bfunction\b/.test(""+a))return!0;if(Object.prototype.toString.call(a).slice(8,-1).toLowerCase()===b.toLowerCase())return!0;if("DateTime"===b)return a instanceof Date;if("TimeSpan"===b){if(a instanceof Date){var c=e.l.Ra(a);return c>=0&&c<1}return!1}return"string"==typeof b&&"undefined number boolean string".indexOf(b)>-1,!1},f.j.Na=function(a,b){return!!g.o.Xia(a,b)&&(a=g.o.Oa(a,b),f.j.Ma(a,"number")||f.j.Ma(a,"DateTime")||f.j.Ma(a,"TimeSpan")||a&&!f.j.Ma(a,"boolean")&&!isNaN(a)&&!isNaN(parseFloat(a))&&!(a.length>=2&&"0"===a[0]&&"x"===a[1]))},f.j.Pa=function(a){return f.j.Fa(a)||""===a?0:f.j.Ma(a,"number")?a:f.j.Ma(a,"string")&&!isNaN(a)?g.o.Qa(a):f.j.Ma(a,"boolean")?a?1:0:f.j.Ma(a,"DateTime")?e.l.Ra(a):f.j.Ma(a,"TimeSpan")?Math.floor(e.l.Ra(a)):parseFloat(a)},m=null,n=void 0,o=Math.abs,p={Rc:"yy",vd:"y",Qc:"yyyy",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},q=[p.vd,p.Rc,p.Qc,p.jd,p.hd,p.gd,p.fd,p.dd,p.ud,p.wd,p.kd,p.ld,p.md,p.nd,p.xd,p.yd,p.td,p.zd,"ggg","gg","g","ee","e"],r="\u4e00\u5341",s="\u5341",t={Hc:0,Va:1,Ua:2,_text:3},u=[{Hc:0,Va:0,Ua:0,_text:0},{Hc:0,Va:1,Ua:0,_text:0},{Hc:0,Va:1,Ua:2,_text:0},{Hc:0,Va:1,Ua:2,_text:3}],v=RegExp("([.+?*$^\\[\\](){}|/])","g"),w=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],x=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"],y=RegExp("color\\s*(\\d+)","i"),z=f.j.Ma,A=f.j.Ca,B=g.o,C=B.eka+"."+B.fka,D=B.Jja,E=B.mb,F=B.Lma,G=f.j.Fa,H=isNaN,I=function(a){return h.CultureManager.q4(a)},J=function(a){return I(a).DateTimeFormat},K=function(a){return I(a).NumberFormat},L=function(a){return a&&a.toLowerCase()},M=function(a){return a&&a.toUpperCase()},N=function(){throw Error(l().Exp_FormatIllegal)},O=function(){return h.CultureManager.booleanMapping},P={Dc:"",Kb:function(){var a,b,c,d,e,f,g=[];for(a=0;a<arguments.length;a++)g[a]=arguments[a];for(b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];if(0===arguments.length)return m;for(d=b[0],e=1;e<arguments.length;e++)f=RegExp("\\{"+(e-1)+"\\}","gm"),d=d.replace(f,arguments[e]);return d},Ec:function(a){return!a||a===P.Dc}},Q={Fc:function(a){var b=a.charCodeAt(0);return b>=48&&b<=57},Gc:function(a){var b=a.charCodeAt(0);return b>=9&&b<=13||32===b||133===b||160===b}},R=function(){function a(a,b){var c,e,f,g;if(qa.call(this,b),c=this,c.Uc=a,e=c.Uc,f=la(e[0],"$",!1),g=e.indexOf("-"),!(f&&g>-1))throw Error(l().Exp_TokenIllegal);c.Vc=da(e,1,g-1),e=d.u.Fb(e,0,g+1),e.length>0&&(c.Wc=parseInt(e,16))}return a.prototype.cultureInfo=function(){var a=this;return a.Xc||(a.Xc=I(a.Wc),a.Vc&&a.Vc!==P.Dc&&!a.Xc.NumberFormat.isReadOnly&&(a.Xc.NumberFormat.currencySymbol=a.Vc)),a.Xc},a.prototype.currencySymbol=function(){return this.Vc?d.u.Gb(this.Vc,"\\.",'"."'):P.Dc},a.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},a.prototype.toString=function(){return this.Uc?ga(this.Uc):P.Dc},a.Name="LocaleIDFormatPart",a}(),S=function(){function a(a,b){this.formatCached=a,this.cultureName=b,this.typeName=""}return a.prototype.format=function(a){return m},a.prototype.parse=function(a){return m},a.prototype.formatString=function(a){return this.formatCached},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)a[b]!==n&&(this[b]=a[b])},a}(),b.FormatterBase=S,T=function(){function a(a,b){var c,e,f,g,h,i,j,k;for(qa.call(this,b),c=this,h=["<=","<>",">=",">","<","="],i=0,j=h.length;i<j;i++)if(e=h[i],d.u.kb(a,e,!0)){f=d.u.Fb(a,0,e.length),k=parseFloat(f),H(k)||(g=k);break}if(g===m&&g===n)throw Error(l().Exp_TokenIllegal);c.value=g,c.Sc=e,c.isMeetCondition=function(a){var b=c.Sc,d=c.value;switch(b){case"<=":return a<=d;case"<>":return a!==d;case">=":return a>=d;case">":return a>d;case"<":return a<d;case"=":return a===d}}}return a.prototype.toString=function(){return ga(this.Sc+(""+this.value))},a}(),U=function(){function a(a,b){qa.call(this,b);var c=this;if(c.token=a,c.type=parseInt(d.u.Fb(a,0,5),10),c.type<0||c.type>4)throw Error(l().Exp_TokenIllegal)}return a.prototype.Pc=function(b,c,e){var f,g,h,i,j,k,l,m,n,o;if(!b||b===P.Dc)return b;for(f=b,g=b,h=-1,i=-1,j=!1,n=b.length-1;n>=0;n--)o=g[n],!H(o)&&!la(o," ",!1)||la(o,".",!1)&&!j?(la(o,".",!1)&&(j=!0),h===-1&&(h=n),i=n):i>-1&&h>-1&&(k=da(g,i,h-i+1),l=parseFloat(k),H(l)||(m=a.numberString(k,c,e),f=d.u.Fb(f,i,h-i+1),f=d.u.Eb(f,i,m)),h=-1,i=-1,j=!1);return i>-1&&h>-1&&(k=da(g,i,h-i+1),l=parseFloat(k),H(l)||(m=a.numberString(k,c,e),f=d.u.Fb(f,i,h-i+1),f=d.u.Eb(f,i,m))),f},a.prototype.toString=function(){if(this.type>-1)return ga("DBNum"+this.type);throw Error()},a.numberString=function(b,c,d){var e,f,g=a.formatNumberString,h=b.split(".");if(h){if(1===h.length)return g(h[0],c.numbers,d?c.letters:m);if(2===h.length)return e=g(h[0],c.numbers,d?c.letters:m),f=g(h[1],c.numbers),e+"."+f}throw Error(l().Exp_ValueIllegal)},a.formatNumberString=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=b,u=0,v=0;if(2===arguments.length){for(f="",u=0;u<t.length;u++)e=da(t,u,1),v=parseInt(e,10),f+=c[v];return f}if(3===arguments.length){if(!d)return a.formatNumberString(b,c);for(g=0,h="",i=t.length,j=!1,k=[],u=0;u<i;u++)l=d.length-1-u,l>-1?k.push(""+d[l]):k.push(P.Dc);for(m=[],n=k.length-1;n>=0;n--)m[k.length-n-1]=k[n];for(k=m,o=!1,n=0;n<i;n++)e=da(t,n,1),v=parseInt(e,10),p=void 0,q=P.Dc,i-n-16>0?(p=c[v],q="",o=!0):n!==i-1&&n!==i-5&&n!==i-9&&n!==i-13?"0"===e?(p="",q="",g+=1):"0"!==e&&0!==g?(p=c[0]+c[v],q=k[n],g=0):(p=c[v],q=k[n],g=0):"0"!==e&&0!==g?(p=c[0]+c[v],q=k[n],g=0):"0"!==e&&0===g||o?(p=c[v],q=k[n],g=0,o=!1):"0"===e&&g>=3?(p="",q="",g+=1):i>=11?(p="",g+=1):(p="",q=k[n],g+=1),r=p+q===P.Dc,r||(j=!1),n!==i-13||j||(q=k[n],j=!0),n!==i-9||j||(q=k[n],j=!0),n===i-1&&(q=k[n],j=!0),h=h+p+q;return s=parseInt(b,10),0===s?c[0]:h}},a}(),V=function(){function a(a,b,c,d,e,f){pa.call(this,b,c,d,f);var g=this;g.Yc=g.Zc(ma(a)),g.$c=e,g._c=2,g.ad()}return a.prototype.ad=function(){var b,c,d,e,f=this,g={Qb:f.Yc},h=a;if(h.Lc(g.Qb)){if(b=f.bd(g),c=J(this.cultureName).amDesignator&&J(this.cultureName).pmDesignator,f.hasJD=f.Gb(g.Qb,p.dd,'"'+p.ed+'"',!0,!1,g,!1),f.Gb(g.Qb,p.fd,"MMMM",!0,!1,g,!1),f.Gb(g.Qb,p.gd,"MMM",!0,!1,g,!1),f.kYc(g.Qb,g,"mm","MM"),f.kYc(g.Qb,g,"m","M"),f.Gb(g.Qb,p.kd,"ddd",!0,!0,g,!0),f.Gb(g.Qb,p.ld,"dddd",!0,!0,g,!0),b&&c||(f.Gb(g.Qb,p.md,"H",!0,!0,g,!1),f.Gb(g.Qb,p.nd,"HH",!0,!0,g,!1)),f.Jc&&(f.Ic||I(f.cultureName).NumberFormat.dbNumber)&&(f.od=f.od||f.Gb(g.Qb,p.Qc,'"@'+p.Qc+'"',!0,!1,g,!0),f.od=f.od||f.Gb(g.Qb,p.Rc,'"@'+p.Rc+'"',!0,!1,g,!0)),f.$c)for(d=0;d<f.$c.length;d++)e=f.$c[d],f.Gb(g.Qb,e.Kc,"@"+e.Kc,!0,!0,g,!0);f.pd=g.Qb}else N()},a.prototype.formatString=function(){return this.Yc},a.prototype.format=function(a){var b,c,f,g,h,i,j=this,k=P.Dc,l=m;try{if(l=e.l.Yb(a),l&&H(l.valueOf())&&(l=m),l?a=l:k=""+a,l&&(k=e.l.mb(l,j.pd,j.Ic&&j.Ic.cultureInfo()||I(j.cultureName),j.nOb),j.hasJD&&(b=I(j.cultureName).DateTimeFormat.monthNames[l.getMonth()],k=d.u.Gb(k,p.ed,da(b,0,1))),j.$c))for(c=24*(e.l.Ra(l)-e.l.Ra(p.qd))*60*60*1e3,f=0;f<j.$c.length;f++)g=j.$c[f],h=g.Tc(c),G(h)||(i=g.Kc.replace("[","\\[").replace("]","\\]"),k=d.u.Gb(k,"@"+i,h))}catch(b){k=ea(a)}return va(k,a,j.Ic,j.Jc,j.cultureName)},a.prototype.parse=function(a){var b,c,d,f,g;if(!a||a===P.Dc)return m;if(b=this,c=a,d=L(c),"true"===d)return!0;if("false"===d)return!1;if(b.pd&&(f=e.l.Wb(c,b.pd,I(b.cultureName))))return f;try{return g=e.l.Yb(c),g&&!H(g)?g:(g=new Date(c),H(g.valueOf())?c:g)}catch(a){return c}},a.prototype.Zc=function(a){var b,c,d,e=a,f="",g=!1;for(b=0;b<e.length;b++)c=e[b],'"'===c?g=!g:g||("Y"===c||"D"===c||"S"===c||"E"===c||"G"===c?c=L(c):"M"===c&&(d=e[b-1],la("A",d,!0)||la("P",d,!0)||(c=L(c)))),f+=c;return f},a.prototype.bd=function(a){var b,c,e,f=J(this.cultureName).amDesignator,g=J(this.cultureName).pmDesignator,h=[p.rd];for(f&&g?h.push(f+"/"+g):h.push(p.rd),h.push(p.sd),b=["tt","tt","t"],c=a.Qb,e=0;e<3;e++){if(d.u.Bb(c,b[e]))return!0;if(d.u.Bb(c,h[e],!0))return a.Qb=d.u.Gb(c,h[e],b[e],!0),!0}return!1},a.prototype.kYc=function(a,b,c,d){var e,f,g,h="",i=a.length,j=0;for(e=0;e<i;e++)if('"'===a[e]&&(j=(j+1)%2),"m"!==a[e]||j)h+=a[e];else{for(f="m";e+1<i&&"m"===a[e+1];)e++,f+="m";h+=f===c?d:f}g=RegExp(d+"(?=[^yYdDhHmM]*[Ss])|"+d+"(?=.0)","g"),h=h.replace(g,c),h=h.split("").reverse().join(""),g=RegExp(d+"(?=[^mM]*[Hh])","g"),h=h.replace(g,c),h=h.split("").reverse().join(""),b.Qb=h},a.prototype.Gb=function(b,c,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t;if(f||g){for(j=[],k=!0,!a.hasDate(b)&&a.hasTime(b)&&(k=!1),l=!1,m=0;m<b.length;m++){if(n=b[m],a.hasTime(n)&&!l?k=!1:a.hasDate(n)&&!l&&(k=!0),f&&la(n,c[0],i)&&k||g&&la(n,c[0],i)&&!k){for(o=!0,p=0;p<c.length;p++)if(p+m>=b.length||!la(c[p],b[p+m],i)){o=!1;break}if(q=m+c.length-1,o&&q+1<b.length){for(r=b[q],s=-1,s=q+1;s<b.length&&la(r,b[s],i);s++);s>q+1&&(m=s,o=!1)}o&&!l&&j.splice(0,0,m)}'"'===n&&(l=!l)}if(h.Qb=b,j.length>0){for(m=0;m<j.length;m++)t=j[m],h.Qb=d.u.Fb(h.Qb,t,c.length),h.Qb=d.u.Eb(h.Qb,t,e);return!0}return!1}return!1},a.hasTime=function(a){return d.u.Cb(a,p.md[0],!0)>-1||d.u.Cb(a,p.td[0],!0)>-1},a.hasDate=function(a){return d.u.Cb(a,p.Rc[0],!0)>-1||d.u.Cb(a,p.ud[0],!0)>-1},a.Lc=function(a,b){return oa(a,b||q)},a}(),b.lxb=V,W=function(){function a(a,b){var c,d,e;if(qa.call(this,b),c=this,d=L(a)[0],"h"===d)e=3600;else if("m"===d)e=60;else{if("s"!==d)throw Error(l().Exp_TokenIllegal);e=1}c.Tc=function(a){var b=a/1e3/e;return Math.abs(b-Math.round(b))<1e-6?Math.round(b):Math.floor(b)}}return a.Name="ABSTimeFormatPart",a}(),X=function(){function a(a,b){var c,d;qa.call(this,b),c=y.exec(a),null!==c&&(d=+c[1],d-=1,d>=0&&d<x.length&&(a=x[d])),this.foreColor=a}return a.prototype.toString=function(){return ga(this.foreColor)},a.Name="ColorFormatPart",a}(),Y=function(){function a(a,b,c,d){var e,f,g,h,i,j;function k(a,b){var c,d,e,f,g,h=[],i='"';if(a===m||""===a)return h;for(c=!1,d=[],e=!1,f=0;f<a.length;f++)g=a[f],g!==i||c||(e=!e),c||e||g!==b?d.push(g):(h.push(d.join("")),d=[]),c="\\"===g&&!c;return h.push(d.join("")),h}pa.call(this,b,c,d),e=this,e.Ad=!1,e._c=1,e.Bd=ha(a),f=ma(a),b&&(f=ja(f,e.Ic.Kc,e.Ic.currencySymbol())),f=ha(f),g=f.indexOf("/"),g>-1&&(h=k(f,"/"),h&&2===h.length&&(e.Cd=h[1],i=h[0],i&&(j=i.lastIndexOf(" "),j>-1?(e.Dd=da(i,0,j),e.Ed=da(i,j+1,i.length-j-1)):e.Ed=i))),e.Fd=f}return a.prototype.formatString=function(){return this.Bd},a.prototype.format=function(b){var c,d,e,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,A;return z(b,"boolean")?(""+b).toUpperCase():(c=this,d=f.j.Pa(b),H(d)||!isFinite(d)||H(b)?"string"==typeof b?b:m:(e=I(c.cultureName),c.Ed&&c.Cd?(n={value:0},o={value:0},p={value:0},q=c.bPa(),a.getFraction(d,q,n,o,p)?(r=a.getGCD(o.value,p.value),r>1&&(o.value/=r,p.value/=r),c.Dd?(l="",1===p.value&&(n.value+=o.value,o.value=0,p.value=0),s=D(E(n.value,c.Dd,e)),s&&"0"!==s&&(l+=s,l+=" "),0===n.value&&d<0&&(l+=e.NumberFormat.negativeSign),0===d&&(l+="0"),h=c.Cd,i=parseFloat(h),!H(i)&&i>0&&(0!==o.value&&0!==p.value&&(o.value*=i/p.value),p.value=i,h=h.replace(/^\d+/,a.toNumberPlaceholder(i)),j=Math.ceil(o.value),k=j-o.value,k<=.5&&k>=0?o.value=parseFloat(""+j):o.value=parseFloat(""+(j-1))),t=c.Ed,u=parseFloat(t),H(u)||0!==u||(v=t.length,w=""+o.value,x=w.length,v>x?t=t.substr(0,v-(v-x)):v<x&&(w=w.substr(0,x-(x-v)),o.value=parseInt(w,10))),y=c.Mja(o.value,p.value,t,h,e),0===o.value&&(y=y.replace(/./g," "),""===s)?"0 "+y:(l+=y,""===l?"0":l)):(l="",A=n.value*p.value+o.value,h=c.Cd,i=parseFloat(h),i>0?(A*=i/p.value,p.value=i,j=Math.ceil(A),k=j-A,A=k<=.5&&k>=0?parseFloat(""+j):parseFloat(""+(j-1)),l+=A+"/"+p.value):l+=c.Mja(A,p.value,c.Ed,c.Cd,e),0===A?"0":l)):""+d):(g=E(d,c.Fd,e),g=wa(g,c.Ad,c.Ic,c.Jc,c.cultureName))))},a.prototype.parse=function(a){var b,c,e,f,g,h,i,j,k,l,n=this;return a&&a!==P.Dc?(b=M(a),!!("TRUE"===b||b===O()&&O().boolean_true)||!("FALSE"===b||b===O()&&O().boolean_false)&&(c=n.Ed&&n.Cd,e=n.Jd(n.Fd).Kd,(c||e)&&(f=a.indexOf("/"),0<f&&f<a.length-1&&(g=parseInt(a.substr(0,f),10),h=parseInt(a.substr(f+1),10),!isNaN(g)&&!isNaN(h)&&0!==h))?g/h:(a=n.Hd(a),a=n.Id(a),i=n.Jd(a),j=i.Kd,k=i.Ld,n.jBb(k)&&(k=d.u.Hb(k,K(n.cultureName).numberGroupSeparator,"",!1),l=B.ob(k,n.cultureName),!H(l)&&isFinite(l))?(j&&(l=F(l/100,15)),l):m))):m},a.prototype.bPa=function(){var a,b,c=this,d=c.Cd,e=0;if(d)for(a=d.length,b=0;b<a&&d[b].match(/[#?0\d]/);b++)e++;return e},a.prototype.jBb=function(a){var b,c="",d=0,e=0,f=0,g=m,h=K(this.cultureName);for(b=a.length-1;b>-1;b--){if(a[b]===h.numberDecimalSeparator)d++,f>0&&(g=!1),c="";else if("e"===L(a[b])){if(e++,c="",b===a.length-1)return!1}else if(a[b]===h.numberGroupSeparator)g=3===c.length,f++,c="";else if("-"===a[b]||"+"===a[b]){if(b>0&&"e"!==L(a[b-1]))return!1}else{if(!Q.Fc(a[b]))return!1;if(c+=a[b],0===b&&0===parseInt(c,10)&&g)return!1}if(d>1||e>1||g===!1)return!1}return!0},a.prototype.Hd=function(a){var b,c,e,f,g,h,i,j=a,k=[];for(b=0;b<j.length;b++)Q.Fc(j[b])&&k.push(b);for(c=K(this.cultureName),e=[c.currencyDecimalSeparator,c.currencyGroupSeparator,c.currencySymbol,c.nanSymbol,c.negativeInfinitySymbol,c.negativeSign,c.numberDecimalSeparator,c.numberGroupSeparator,c.percentDecimalSeparator,c.percentGroupSeparator,c.percentSymbol,c.perMilleSymbol,c.positiveInfinitySymbol,c.positiveSign],f=j.length-1;f>-1;f--)if(g=j[f],!Q.Gc(g)||e.indexOf(""+g)>-1){if(("-"===g||"+"===g)&&(h=f>0?""+j[f-1]:m,i=["e","E","(",K(this.cultureName).currencySymbol],i.indexOf(h)<0))break}else(f<k[0]||k[k.length-1]<f)&&(j=d.u.Fb(j,f,1));return j},a.prototype.Id=function(a){var b=K(this.cultureName).currencySymbol,c=d.u.kb(a,b)?d.u.Fb(a,0,b.length):a;return c.indexOf(b)<0?c:a},a.prototype.Jd=function(a){var b=K(this.cultureName).percentSymbol,c=!0,e=a;return d.u.kb(a,b)?e=d.u.Fb(a,0,b.length):d.u.jb(a,b)?e=d.u.Fb(a,a.length-b.length,b.length):c=!1,d.u.Bb(e,b)&&(c=!1),{Ld:e,Kd:c}},a.prototype.Mja=function(a,b,c,d,e){var f=D(E(a,c,e)),g="0."+b,h="#."+d,i=D(E(g,h,e,!0)),j=e&&e.NumberFormat&&e.NumberFormat.numberDecimalSeparator||".",k=f+"/"+i.substr(i.indexOf(j)+1);return""===c&&(k=a+k),""===d&&(k+=b),k},a.getGCD=function(a,b){var c,d,e;if(0===a)return o(b);if(0===b)return o(a);for(c=Math.max(a,b),d=Math.min(a,b),e=c%d;0!==e;)c=d,d=e,e=c%d;return o(d)},a.getFraction=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,p=0,q=0,r=0,s=0,t=Math.ceil;for(a>0?(s=a-t(a)+1,1===s?(s=0,p=a):p=t(a)-1):a<0&&(p=t(a),s=t(a)-a),f=Math.pow(10,b-1),g=Math.pow(10,b)-1,f<2&&(f=2),g<2&&(g=2),h=!1,i=0,j=f;j<=g&&(k=j*s,l=Math.round(k),m=l/j,n=o(m-s),!((!h||n<o(i-s))&&(h=!0,i=m,q=l,r=j,n<1e-6)));j++);return c.value=p,d.value=q,e.value=r,h},a.toNumberPlaceholder=function(a){return(""+a).replace(/\d/g,"?")},a}(),Z=function(){function a(b,c,d,e){pa.call(this,c,d,e),arguments.length>0?(a.kBb(b)||N(),this.Bd=b):this.Bd="General",this._c=0}return a.kBb=function(a){var b,c,d="",e=!1,f=-1,g=a.length;for(b=0;b<g;b++)c=a[b],'"'===c?(e=!e,f=e?b:-1):e||(d+=c);return f>0&&(d+=a.substring(f,g)),!(d.indexOf("0")>=0||d.indexOf("#")>=0||d.indexOf(".")>=0||d.indexOf("@")>=0)},a.prototype.Nd=function(){var a,b=this;return b.Od||(a=b.Bd,a=ja(a,"General",C),b.Od=new Y(a,b.Ic,b.Jc,b.cultureName),b.Od.Ad=!0),b.Od},a.prototype.Pd=function(){var a=this;return a.Qd||(a.Qd=new Y("0.#####E+00",a.Ic,a.Jc,a.cultureName),a.Qd.Ad=!0),a.Qd},a.prototype.formatString=function(){return d.u.Gb(this.Bd,"@NumberFormat","General")},a.prototype.format=function(a){var b,c,e,g=this;if(f.j.Na(a,g.cultureName)){if(b=!g.Ic||g.Ic.allowScience(),c=f.j.Pa(a),c!==n&&c!==m)return o(c)>99999999999&&b||o(c)<1e-11&&0!==c?g.Pd().format(a):g.Nd().format(a)}else{if(z(a,"string"))return e=d.u.Gb(g.formatString(),'"',""),e=ka(e),e?a:a;if(z(a,"boolean"))return(""+a).toUpperCase()}return""},a.prototype.parse=function(a){var b,c,f,g,i,j,k,l,p,q,r,s,t,u;return P.Ec(a)?m:"number"==typeof a?a:(b=!1,c=a.trim(),f=d.u.Cb(c,"-",!1),f>0&&!la(c.charAt(f-1),"E",!0)&&(b=!0),g=I(this.cultureName),i=g.DateTimeFormat,j=i.dateSeparator,k=i.timeSeparator,l=i.monthNames,p=i.abbreviatedMonthNames,q=function(a,b){var c,e,f;if(!b||0===b.length)return!1;for(c=!1,e=0,f=b.length;e<f;e++)if(d.u.Bb(a,b[e],!0)){c=!0;break}return c},(b||d.u.Bb(c,j,!1)||d.u.Bb(c,k,!1)||d.u.Bb(c,"/",!1)||d.u.Bb(c,":",!1)||d.u.Bb(c,"-",!1)||d.u.Bb(c,"\u5e74",!1)||d.u.Bb(c,"\u6708",!1)||d.u.Bb(c,"\u65e5",!1)||q(c,l)||q(c,p)||"ja-JP"===g.name()&&h.aBb.R.indexOf(c[0].toUpperCase())>=0&&d.u.Bb(c,".",!1))&&(r=e.l.Qa(c))?r:(t="-"===c.charAt(0),c=t?d.u.Fb(c,0,1):c,u="("===c.charAt(0)&&")"===c.charAt(c.length-1),u&&(c=c.substring(1,c.length-1)),s=this.Nd().parse(c),s!==m&&s!==n?(u||t)&&z(s,"number")?-1*o(s):s:a))},a}(),$=function(){function a(a,b,c,d){var e,f=this;pa.call(f,b,c,d),e=ma(a,!1),b&&(e=ja(e,f.Ic.Kc,f.Ic.currencySymbol())),e=ha(e),e=ka(e),f.Yc=e,f._c=3}return a.prototype.format=function(a,b){var c,d,f,g=this;try{return c=void 0,d=void 0,d=a instanceof Date?""+e.l.Ra(a):ea(a),f=g.Kja(g.Yc),c=g.Lja(d,f.formatTokens,a,f.hasAtPart,b)}catch(a){return""}},a.prototype.parse=function(a){return a?a:""},a.prototype.formatString=function(){return this.Yc},a.prototype.Kja=function(a){var b,c,d=[],e=!1,f="",g=!1,h=m;for(c=0;c<a.length;c++)b=a.charAt(c),g?('"'!==b?f+=b:(f+=b,d.push(f),f="",g=!1),h=b):"*"!==h&&"_"!==h&&"\\"!==h||""===f?"*"!==b&&"_"!==b&&"\\"!==b?"@"!==b?'"'!==b?(f+=b,h=b):(h=b,""!==f&&d.push(f),f=b,g=!0):(h=b,""!==f&&(d.push(f),f=""),d.push(b),e=!0):(h=b,""!==f&&(d.push(f),f=""),f+=b):(f+=b,d.push(f),f="");return""!==f&&d.push(f),{formatTokens:d,hasAtPart:e}},a.prototype.Lja=function(a,b,c,d,e){var f,g,h=[],i=!1;if("string"!=typeof c||d||e)for(f=b.length-1;f>=0;f--)g=b[f],"*"===g[0]?i||(i=!0,h.push({type:"fillingChar",value:g[1]})):"_"===g[0]?h.push({type:"placeholder",value:g[1]}):'"'===g[0]&&'"'===g[g.length-1]?g.length>=2&&h.push({type:"text",value:g.substr(1,g.length-2)}):"\\@"===g?h.push({type:"text",value:"@"}):"@"===g[0]?h.push({type:"text",value:a}):h.push({type:"text",value:g});else h.push({type:"text",value:c});return h.reverse()},a}();function da(a,b,c){return a.substr(b,c)}function ea(a){return f.j.Fa(a)?"":"boolean"==typeof a?a?"TRUE":"FALSE":"string"==typeof a?a:""+a}function fa(a,b){if("\\"===a[b])throw Error(l().Exp_InvalidBackslash);if(b-1>0&&b-1<a.length&&"\\"===a[b-1]){if(b-2<0)return!0;if(b-2>0&&b-2<a.length)return"\\"!==a[b-2]}return!1}function ga(a){if(!a)throw Error(l().Exp_TokenIsNull);return"["+a+"]"}function ha(a){var b,c,d,e,f;if(a===n||a===m||""===a)return a;for(b="",c=0,d=!1,e=0;e<a.length;e++)f=a[e],'"'===f?(d=!d,b+=f):d?b+=f:"["===f?c++:"]"===f?(c--,c<0&&(c=0)):0===c&&(b+=f);return""+b}function ia(a){return a=ja(a,"[",""),ja(a,"]","")}function ja(a,b,c){return!a||a===P.Dc||la(b,c,!0)?a:(b=b.replace(v,"\\$1"),a.replace(RegExp(b,"g"),c))}function ka(a){var b,c,d=a.length,e=!1,f="";for(b=0;b<d;b++)c=a.charAt(b),"\\"===c?(e=!e,e&&"@"!==a.charAt(b+1)||(f+=c)):(e=!1,f+=c);return f}function la(a,b,c){return c?L(a)===L(b):a===b}function ma(a,b){var c,d,e,f;for(1===arguments.length&&(b=!0),c=!1,d="",e=0;e<a.length;e++){
if(f=a[e],'"'===f)c=!c;else if(!c&&!b&&"/"===f&&!fa(a,e))continue;d+=f}return d}function na(a){var b,c,d,e="",f=!1;for(b=0,c=a.length;b<c;b++)d=a[b],'"'===d&&(f=!f),"E"===d||f||(e+=L(d));return e}function oa(a,b){var c,d,e,f;if(!a||a===P.Dc)return!1;for(c=ma(a),d=na(c),e=0;e<b.length;e++){if(f=d.indexOf(b[e]),0===f)return!0;if(f>0&&"_"!==d[f-1]&&"*"!==d[f-1])return!0}return!1}_=function(){return{pattern:w,formatter:["d-mmm","mmm-yy",J().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",J().shortDatePattern+" h:mm",J().shortDatePattern+" h:mm:ss",J().shortDatePattern+" h:mm:ss.0"]}};function pa(a,b,c,d){this.Ic=a,this.Jc=b,this.cultureName=c,this.nOb=d}function qa(a){this.Kc=a}function ra(a){var b,c,e=ia(a);return e&&e!==P.Dc?(c=e[0],["<",">","="].indexOf(c)>-1?(b=T,b.Name="ConditionalFormatPart"):d.u.kb(e,"DBNum",!0)?(b=U,b.Name="DBNumberFormatPart"):la(e[0],"$",!1)&&e.indexOf("-")>-1?(b=R,b.Name="LocaleIDFormatPart"):ta(e)?(b=W,b.Name="ABSTimeFormatPart"):e.indexOf("$")<0&&e.length>=3&&(b=X,b.Name="ColorFormatPart"),b):b}function sa(a,b){var c,d=!1;return a=a?""+a:P.Dc,oa(a,["general"])?c=Z:V.Lc(a)?c=V:oa(a,["E+","E-","#",".",",","%","0","/","?"])||b?(d=!0,c=Y):(d=!0,c=$),{Mc:d,Nc:c}}function ta(a){var b,c=L(a),d=c[0];if("h"!==d&&"m"!==d&&"s"!==d)return!1;for(b=1;b<c.length;b++)if(d!==c[b])return!1;return!0}function ua(a,b,c){var d,e;return d=a?a.cultureInfo():I(c),(b<4||4===b&&("ko-kr"===c||"ko-kr"===d.name()))&&(e=d.NumberFormat.dbNumber)?e[b]:m}function va(a,b,c,d,f){var g,h=a;if(!G(d)&&b instanceof Date){if(g=ua(c,d.type,f),!g)return a;h=d.Pc(h,g,!0),1===d.type&&(h=h.replace(RegExp(r,"g"),s)),h=h.replace("@"+p.Qc,e.l.Vb(b,p.Qc)),h=h.replace("@"+p.Rc,e.l.Vb(b,p.Rc)),h=d.Pc(h,g,!1)}return h}function wa(a,b,c,d,e){var f,g,h,i,j,k,l;if(!G(d)&&(f=ua(c,d.type,e),!G(f))){for(g=!1,h=void 0,i=I(e),j=void 0,k=0,l=a.length;k<l;k++)"decimalSeparator"===a[k].type&&(g=!0,a[k].value=d.Pc(a[k].value,f,b),h=a[k].value),"number"===a[k].type&&(g?a[k].value=d.Pc(h+a[k].value,f,b).slice(1):a[k].value=d.Pc(a[k].value,f,b),"ja-JP"===i.name()&&a[k].value.length>1&&(j=a[k].value.substr(0,2),"\u4e00\u5343"!==j&&"\u4e00\u767e"!==j&&"\u4e00\u5341"!==j||(a[k].value=a[k].value.substr(1))));return a}return a}aa=function(){function a(a,b){var c=this;0===arguments.length?(c.formatCached="General",c.Rd=new Z):c.ad(a,b)}return a.prototype.ad=function(b,c){var d,e,f,g,i,j,k,l,o,p,q,r,s,t,u,v,w;for(b!==m&&b!==n||N(),d=b,e=this,e.formatCached=b,f="",g="",i=!1,j=!1,k=!1,l=[],o=0;o<b.length;o++)p=b[o],'"'===p?(j=!j,g+=p):j?g+=p:"["===p?(i&&N(),g&&(f||(f=""),f+=g),g=""+p,i=!0):"]"===p?(i||N(),g?(g+=p,q=""+g,r=ra(""+g),r?"ABSTimeFormatPart"===r.Name?(l.push(new r(a.preProcessPart(q),q)),f+=g):q===h.aBb.eraExcelFormatter?(e.addPart(r,h.aBb.eraInternalFormatter),k=!0):e.addPart(r,q):(s=a.partToNormalStr(q),f+=s,d=ja(b,q,s)),g=""):N(),i=!1):g+=p;g?i?N():f+=g:f||(f=e.o$a()),e.localeIDFormatPart&&(c=e.localeIDFormatPart.cultureInfo().name()),t=e.conditionalFormatPart,u=sa(f,t),v=u.Nc,w=u.Mc?d:f,v?e.Rd=new v(w,e.localeIDFormatPart,e.dbNumberFormatPart,c,l.length>0?l:m,k):N()},a.prototype.o$a=function(){var b,c=this,d="";return c.dbNumberFormatPart&&(b=a.proNames.some(function(a){return"dbNumberFormatPart"!==a&&c[a]}),b||(d="General")),d},a.prototype.formatString=function(){var b,c,d,e=this,f="";for(b=0,c=a.proNames.length;b<c;b++)d=a.proNames[b],e[d]&&(f+=""+e[d]);return f+=e.Rd.formatString()},a.prototype.addPart=function(b,c){var d,e,f,g=this,h=a.proNames,i=a.preProcessPart(c);for(d=0,e=h.length;d<e;d++)if(f=h[d],la(f,b.Name,!0)){if(g[f])throw Error(l().Exp_DuplicatedDescriptor);g[f]=new b(i,c)}},a.prototype.format=function(a,b){return this.Rd.format(a,b)},a.prototype.parse=function(a){return this.Rd.parse(a)},a.checkFormatter=function(a){if(!a||a===P.Dc)throw Error(l().Exp_TokenIllegal)},a.preProcessPart=function(b){a.checkFormatter(b);var c=ia(b);return a.checkFormatter(c),c},a.partToNormalStr=function(b){var c=a.preProcessPart(b);return"$"===c[0]&&(c=c.slice(1)),'"'+c+'"'},a.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],a}(),ba=function(a){ca(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d;return e.Sd=!0,e.PropertyChanged=[],P.Ec(b)&&(b="General"),e.formatCached=b,e.cultureName=c,e.init(),d}return b.prototype.toJSON=function(){var a=this,b={formatCached:a.formatCached};return a.cultureName&&(b.customerCultureName=a.cultureName),"general"===L(a.formatCached)&&delete b.formatCached,b},b.prototype.hasFormatedColor=function(){var a,b,c=this;for(a in t)if(t.hasOwnProperty(a)&&(b=c.getFormatter(t[a]),b&&b.colorFormatPart))return!0;return!1},b.prototype.formatString=function(a){var b,c,d,e,f=this;if(0===arguments.length){for(b=P.Dc,c=0,d=f.formatters.length;c<d;c++)e=f.formatters[c],b+=e.formatString(),c!==d-1&&(b+=";");return b}if(!a)throw Error(l().Exp_ValueIsNull);return f.formatters=m,f.formatCached=a,f.init(),f.Td("formatString"),f},b.prototype.getFormatter=function(a){var b=this;return b.formatters&&b.formatters[a]},b.prototype.getPreferredEditingFormatter=function(a){var c,d,e=J(this.cultureName),g=b.defFormatter;return z(a,"TimeSpan")?g(e.longTimePattern):z(a,"DateTime")?(c=0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()?"":" h:mm:ss",g(e.shortDatePattern+c)):f.j.Na(a,this.cultureName)?(d=f.j.Pa(a),g(d>=1e20||d<=1e-17&&d>0||d<=-1e20||d<0&&d>=-1e-17?"0.##E+00":C)):g("General")},b.prototype.getPreferredDisplayFormatter=function(a,c){var g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,G,H=this,J=b.defFormatter;if(c||(c={value:m}),c.value=m,P.Ec(a))return new b;if(g=a,h=c.value=H.parse(g),z(h,"DateTime")||z(h,"TimeSpan")){for(i=_(),j=i.pattern,k=i.formatter,l=I(H.cultureName),n=l.DateTimeFormat,o=n.preselectedFormatters,o.length>0&&(j=j.concat([o]),k=k.concat([o[0]])),"ja-JP"===l.name()&&(j=j.concat([n.eraFormatter]),k=k.concat(["ge.M.d"]),p=l._Ab.filter(function(a){return"ggge"===a.substr(0,4)}),j=j.concat([p]),k=k.concat(['ggge"\u5e74"M"\u6708"d"\u65e5']),q=l._Ab.filter(function(a){return"gge"===a.substr(0,3)}),j=j.concat([q]),k=k.concat(['gge"\u5e74"M"\u6708"d"\u65e5']),r=l._Ab.filter(function(a){return"ge"===a.substr(0,2)}),j=j.concat([r]),k=k.concat(['ge"\u5e74"M"\u6708"d"\u65e5'])),s=0;s<j.length;s++)for(t=j[s],u=0;u<t.length;u++)if(v=t[u],w=e.l.Qa(a,v),w&&w-h===0)return new b(k[s])}else if(f.j.Na(h,H.cultureName)){if(x=K(H.cultureName),y=x.currencySymbol,A=x.numberDecimalSeparator,B=x.percentSymbol,C=x.numberGroupSeparator,D="E",E=d.u.Bb,F=E(g,A),G=F?".00":"",g[0]===y)return J(P.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",y,G));if(E(g,D,!0))return J("0.00E+00");if(""+g[0]===B||""+g[g.length-1]===B)return J(P.Kb("0{0}%",G));if(E(g,C))return J(P.Kb("#,##0{0}",G))}return J("General")},b.prototype.format=function(a,b){var c,d,e,g,h,i,j;if(z(a,"boolean"))return O()&&(a=a?O().boolean_true:O().boolean_false),(""+a).toUpperCase();if(c=this,e=0,g=c.Ud(a)){h=g.colorFormatPart,b&&h&&(b.conditionalForeColor=b.value=h.foreColor),d=f.j.Na(a,c.cultureName),d&&(e=f.j.Pa(a)),i=P.Dc;try{d&&g===c.getFormatter(t.Va)&&0!==this.expressionNumber?(i=g.format(g.considerNegSymbol?e:o(e)),i===m&&z(a,"string")&&(i=a)):(i=g.value,i===n&&(j=!c.Sd&&g===c.getFormatter(t._text),i=g.format(a,j))),b&&(b.content=A(i)?i:[{type:"text",value:i}]),A(i)&&(i=B.Jja(i))}catch(b){z(a,"string")&&(i=""+a)}return i}return d&&e<0?"-":z(a,"string")?""+a:a===n||a===m?P.Dc:""+a},b.prototype.parse=function(a){var b=this;return b.formatters&&b.formatters.length>0?b.formatters[0].parse(a):m},b.prototype.init=function(){var a,b,c,d=this,e=d.formatCached;for(P.Ec(e)&&N(),d.formatters=[],a=e.split(";"),d.Sd=1===a.length,(!a||a.length<1||a.length>4)&&N(),b=0;b<a.length;b++)a[b].indexOf("@")!==-1&&a[b].indexOf("\\@")===-1&&(b!==a.length-1?N():this.hasAt=!0),c=new aa(a[b],d.cultureName),d.formatters.push(c);d.getFormatter(t.Hc)||N(),this._Xc()},b.prototype._Xc=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var a=(0===this.expressionNumber?1:this.expressionNumber)-1;t=f.j.Ia({},u[a]),this.hasAt&&0!==this.expressionNumber&&(t._text=this.formatters.length-1)},b.prototype.Ud=function(a){var b,c,d,e,g,h,i,j,k,l,n,o=this;if(o._Xc(),b=o.getFormatter(t.Hc),c=b&&b.conditionalFormatPart,d=o.getFormatter(t._text),c&&(t.Ua=2,this.hasAt||(t._text=3)),"string"==typeof a&&H(a))return d?d:c?a:b;if(f.j.Na(a,o.cultureName)||z(a,"boolean")){if(e=o.getFormatter(t.Va),g=o.getFormatter(t.Ua),h=f.j.Pa(a),i=c&&b.conditionalFormatPart.isMeetCondition(h),j=e&&e.conditionalFormatPart,k=j&&e.conditionalFormatPart.isMeetCondition(h),l=void 0,o.Sd||(c?i:h>0||0===h&&!g))l=b;else if(j?k:h<0)l=e;else if(g)l=g;else if(e){if(c&&j)return n=h+"",{value:n};l=e}return l&&(!c||j||l!==e||g||(l.considerNegSymbol=!0),c&&j&&l===e&&e.conditionalFormatPart&&e.conditionalFormatPart.isMeetCondition(1e-10)&&(l.considerNegSymbol=!0),this.expressionNumber<=1&&(l.considerNegSymbol=!0)),l}return m},b.prototype.Td=function(a){var b,c,d=this;if(d.PropertyChanged)for(b=0;b<d.PropertyChanged.length;b++)c=d.PropertyChanged[b],"function"==typeof c&&c(d,a)},b.defFormatter=function(a){var c=b[a];return c||(c=new b(a),b[a]=c),c},b}(S),b.GeneralFormatter=ba},"./src/plugins/slicer/slicer.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/datetimehelper.ts"),e=void 0,f=null,g="number",h="string",i="boolean",j=d.l.Ra,function(a){a[a.all=0]="all",a[a.byCurrentColumn=1]="byCurrentColumn",a[a.byOtherColumns=2]="byOtherColumns"}(k=b.FilteredOutDataType||(b.FilteredOutDataType={})),function(a){a[a.average=1]="average",a[a.count=2]="count",a[a.counta=3]="counta",a[a.max=4]="max",a[a.min=5]="min",a[a.product=6]="product",a[a.stdev=7]="stdev",a[a.stdevp=8]="stdevp",a[a.sum=9]="sum",a[a.vars=10]="vars",a[a.varp=11]="varp"}(l=b.SlicerAggregateType||(b.SlicerAggregateType={}));function o(a){return a&&a.text!==e}m=function(){function a(){}return a.Ra=function(a){return j(a)},a.quickSort=function(b){var c,d=D(b),e=[];for(c=0;c<d;c++)e[c]={index:c,value:b[c]};return a.quickSortImp(e)},a.quickSortImp=function(b){var c,d,e,f,g,h,i,j;if(D(b)<=1)return b;for(c=a,d=Math.floor(D(b)/2),e=b[d],f=[],g=[],h=[],i=0;i<D(b);i++)j=c.sortCompare(b[i].value,e.value),j<0?f.push(b[i]):j>0?g.push(b[i]):h.push(b[i]);return c.quickSortImp(f).concat(h,c.quickSortImp(g))},a.isEquals=function(a,b){return!(!B(a)&&""!==a||!B(b)&&""!==b)||(a instanceof Date&&b instanceof Date?a.valueOf()===b.valueOf():C(a)===h&&C(b)===h?a.toLowerCase()===b.toLowerCase():a===b)},a.isGreaterThan=function(b,c){var d=C(b),e=C(c);return d===i?b=b?1:0:b instanceof Date&&(b=a.Ra(b)),e===i?c=c?1:0:c instanceof Date&&(c=a.Ra(c)),d===e||d!==g&&e!==g?d===h&&e===h?b.toLowerCase()>c.toLowerCase():b>c:C(c)===g},a.sortCompare=function(b,c){var d=a,e=0,f=B(b)||""===b||C(b)===g&&isNaN(b),h=B(c)||""===c||C(c)===g&&isNaN(c);return e=f&&h?0:f?1:h?-1:d.isEquals(b,c)?0:d.isGreaterThan(b,c)?1:-1},a}(),b.jf=m;function p(a,b){var c,d,j;if(a===f||a===e)return!1;if(C(a)===g)b.value=a;else if(C(a)===i)b.value=a?1:0;else if(a instanceof Date)b.value=m.Ra(a);else{if(C(a)!==h)return!1;if(a=a.trim(),0===D(a))return!1;if(c=!1,"%"===a.charAt(D(a)-1)&&(c=!0,a=a.substr(0,D(a)-1)),D(a)>=2&&"0"===a[0]&&"x"===a[1])return!1;if(d=(+a).valueOf(),isNaN(d)||!isFinite(d)){if(j=new Date(a),isNaN(j))return!1;d=m.Ra(j)}c&&(d/=100),b.value=d}return!0}function q(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=a.Ce;for(o||(a.Ee=[],a.Ie=[]),b=o?a.De:a.Ee,c=a.Fe,d=a.Ge,e=o?a.He:a.Ie,f=a.Je,g=a.Ke,h=a.Le,i=D(a.data),k=0;k<i;k++){for(l=!1,m=void 0,n=0;n<D(f)&&(m=f[n],o&&m===a.Me||(d[m]?(j=a.getExclusiveRowIndex(a.columnNames[m],k),l=!d[m][j]):c[m]&&(l=!c[m][k]),!l));n++);!l&&o&&(g?(j=a.getExclusiveRowIndex(a.columnNames[m],k),l=!g[j]):h&&(l=!h[k])),l||(b[k]=!0)}for(n=0;n<D(b);n++)b[n]&&e.push(n)}function r(a){return"string"==typeof a?a.toLowerCase():a instanceof Date?m.Ra(a):a}function s(a){var b,c,d=a.Ne={};for(a.Oe=[],a.Pe=[],a.Qe=[],a.Re=[],b=a.columnNames,c=0;c<D(b);c++)d[(b[c]+"").toUpperCase()]=c}function t(a,b){var c,d,e,f,g,h,i,j=a.Oe,k=a.Pe,l=a.Se,m=a.Qe,n=a.Re,p=a.data,q=n[b]=[];for(a._e=[],j[b]=[],k[b]=[],l[b]={},m[b]=[],c={},d=0;d<D(p);d++)e=p[d][b],f=o(e)?e.text.trim():e,j[b].push(f),g=c[r(f)],g?(g.list.push(d),q[d]=g.index):(h=[d],k[b].push(f),m[b].push(h),i=D(m[b])-1,l[b][f]=i,q[d]=i,c[r(f)]={list:h,index:i})}function u(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,p,q=a.Te,r=a.getColumnIndex(b),s=[];if(!r)return s;if(d=a.Ce?a.Ue:a.Ve[r],e=a.Ee,!d)return s;for(q[r]||a.We(r),f=[],g=q[r],h=0;h<D(g);h++)i=a.data[h][r],j=o(i)?i.value:i,f[g[h]]=j;for(k=a.af[r],h=0;h<D(d);h++){for(l=d[h],m=!1,n=a.Xe(f,l),p=n.start;p<=n.end;p++)if(e[k[p]]){m=!0;break}m!==c&&s.push(l)}return s}function v(a,b){var c,d,e,f,g=[],h=a.getColumnIndex(b);if(h>=0){for(c=D(a.getData(b)),d=a.Ce?a.De:a.Ee,e=0;e<c;e++)d[e]||(f=a.getExclusiveRowIndex(b,e),g.indexOf(f)===-1&&g.push(f));return g}}function w(a,b){var c,d,e,f,g,h,i,j=[],k={},l=a.getColumnIndex(b);if(l>=0)for(c=a.Ke||a.Le,d=a.Ge[l]||a.Fe[l],e=a.Ce&&l===a.Me?c:d,f=!!a.Fe[l],g=D(f?a.getData(b):a.getExclusiveData(b)),h=0;h<g;h++)e&&!e[h]&&(i=f?a.getExclusiveRowIndex(b,h):h,k[i]||(k[i]=!0,j.push(i)));return j}function x(a,b){var c,d,e,f,g,h,i,j,k,l={},m=a.columnNames,n=D(m);for(c=0;c<n;c++)if(m[c]!==b)for(d=w(a,m[c]),e=0;e<D(d);e++)for(f=a.getRowIndexes(m[c],d[e]),g=0;g<D(f);g++)l[f[g]]||(l[f[g]]=!0);for(h={},n=D(a.data),c=0;c<n;c++)i=a.getExclusiveRowIndex(b,c),l[c]||(h[i]=!0);for(j=D(a.getExclusiveData(b)),k=[],c=0;c<j;c++)h[c]||k.push(c);return k}function y(a,b,c,d){var e,f,g,h,i,j,k,l,m=a.getColumnIndex(b),n=a.Te;for(n[m]||a.We(m),e=[],f=n[m],g=0;g<D(f);g++)h=a.data[g][m],i=o(h)?h.value:h,e[f[g]]=i;for(j=[],g=0;g<D(c);g++)for(k=a.Xe(e,c[g]),l=0;l<D(f);l++)f[l]>=k.start&&f[l]<=k.end&&(j[l]=!0);d?(a.Le=j,a.Ue=c):(a.Ve[m]=c,a.Fe[m]=j,delete a.Ge[m],delete a.Ye[m]),q(a)}function z(a,b,c,d){var e,f=a.getColumnIndex(b),g=[];for(e=0;e<D(c);e++)g[c[e]]=!0;d?a.Ke=g:(a.Ge[f]=g,a.Ye[f]=c,delete a.Ve[f],delete a.Fe[f]),q(a)}function A(a,b){a.Ce=!1,a.Ke=[],a.He=[],a.De=[],a.Le=[],b&&a.onFiltered()}n=function(){function a(a,b){var c,d=this;for(d.Ne={},d.Oe=[],d.Pe=[],d.Se=[],d.Qe=[],d.Re=[],d.Ge=[],d.Ye=[],d.Fe=[],d.Ve=[],d.Ee=[],d.Ie=[],d.Je=[],d.He=[],d.De=[],d.Ce=!1,d.Ze=[],d.$e=0,d._e=[],d.af=[],d.Te=[],d.bf(a,b),c=0;c<D(d.data);c++)d.Ee[c]=!0,d.Ie.push(c)}return a.prototype.inPreview=function(){return this.Ce},a.prototype.bf=function(a,b){var c=this;c.data=a,c.columnNames=b,s(c)},a.prototype.onDataChanged=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=Array(D(l.columnNames)),n=l.Ye,p=l.Pe,r=l.Ge,s=l.Oe;for(b=0;b<D(a);b++)c=a[b],d=c.data,e=c.row,f=l.getColumnIndex(c.columnName),l.data[e][f]=d,g=o(d)?d.text:d,s[f]&&(s[f][e]=g),m[f]=!0;for(h=0;h<D(m);h++)if(m[h]){for(i=n[h],n[h]=i?[]:void 0,r[h]=i?[]:void 0,j=[],b=0;i&&b<D(i);b++)j.push(p[h][i[b]]);for(t(l,h),b=0;b<D(j);b++)k=l.Se[h][j[b]],n[h].push(k),r[h][k]=!0}q(l),l.cf("onDataChanged",a)},a.prototype.cf=function(a){var b,c,d,e,f=[];for(b=1;b<arguments.length;b++)f[b-1]=arguments[b];for(c=this.Ze||[],d=0;d<D(c);d++)e=c[d],e[a]&&e[a].apply(e,f)},a.prototype.onColumnNameChanged=function(a,b){var c=this,d=c.Ne,e=c.getColumnIndex(a);e<0||(c.columnNames[e]=b,delete d[a.toUpperCase()],d[b.toUpperCase()]=e,c.cf("onColumnNameChanged",a,b))},a.prototype.onRowsAdded=function(a,b,c){var d,g,h,i,j,k,l,n,o,p,q,r,s,t=this,u=D(t.columnNames),v=t.data,w=t.Oe,x=t.Pe,y=t.Qe,z=t.Re,A=t.Ge,B=t.Ye,C=t.Ee,E=t.Ie,F=t.Je;for(t._e=[],d=0;d<b;d++)v.splice(a,0,Array(u));for(g=0;g<u;g++){for(d=0;d<b;d++)w[g]&&w[g].splice(a,0,e);if(i=x[g],j=void 0,i){for(k=f,l=0;l<D(i);l++){for(n=y[g][l],o=0;o<D(n);o++)n[o]>=a&&(n[o]+=b);m.isEquals(i[l],f)&&(k=n,j=l)}for(k||(k=[],i.push(f),j=D(i)-1,t.Se[g][f]=j,y[g].push(k),A[g]&&F.indexOf(g)===-1&&(A[g][j]=!0,B[g].push(j))),p=a;p<a+b;p++)k.push(p);for(h=a;h<a+b;h++)z[g].splice(h,0,j)}}for(q=!0,d=0;d<D(F);d++)g=F[d],r=z[g][a],A[g][r]!==!0&&(q=!1);for(d=0;d<D(E);d++)E[d]>=a&&(E[d]+=b);for(h=D(v)-1;h>=a+b;h--)C[h]=C[h-b];for(s=D(F)>0,h=a;h<a+b;h++)q&&E.push(h),C[h]=!s;c||t.cf("onRowsChanged",a,b,!0)},a.prototype.onRowsRemoved=function(a,b){this.df(a,b,!0)},a.prototype.df=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.Ye,n=l.Pe,o=l.Ge,p=l.data,r=D(l.columnNames),s=l.Oe;for(p.splice(a,b),e=0;e<r;e++){if(s[e]&&s[e].splice(a,b),f=m[e],g=[],f&&c){for(d=0;d<D(f);d++){for(h=l.getRowIndexes(l.columnNames[e],f[d]),i=!0,j=0;j<D(h);j++)if(h[j]<a||h[j]>=a+b){i=!1;break}i||g.push(n[e][f[d]])}m[e]=[],o[e]=[]}if(t(l,e),f&&c)for(d=0;d<D(g);d++)k=l.Se[e][g[d]],m[e].push(k),o[e][k]=!0}c&&q(l),l.cf("onRowsChanged",a,b,!1)},a.prototype.onColumnsRemoved=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.data,m=[],n=k.Je,o=a+b;for(c=a;c<o;c++)d=k.columnNames[c],e=c,m.push(d),n.indexOf(e)!==-1&&k.doUnfilter(d);for(f=k.Ge||k.Fe,g=k.Ye||k.Ve,h=k.Ne,c=0;c<D(l);c++)l[c].splice(a,b);k._e=[],k.columnNames.splice(a,b),k.Oe.splice(a,b),k.Pe.splice(a,b),k.Se.splice(a,b),k.Qe.splice(a,b),k.Re.splice(a,b),f.splice(a,b),g.splice(a,b);for(i in h)h[i]>=a+b&&(h[i]-=b);for(c=0;c<D(m);c++)d=m[c],delete h[d.toUpperCase()],a=k.getColumnIndex(d),j=n.indexOf(a),j!==-1&&n.splice(j,1),k.cf("onColumnRemoved",m[c])},a.prototype.ef=function(){return this._e},a.prototype.ff=function(){return this.af},a.prototype.We=function(a){var b,c,d,e,f,g,h,i,j,k,l,n=this,p=n.data;for(n.Oe[a]||t(n,a),b=D(p),c=[],d=0;d<b;d++)e=p[d][a],f=o(e)?e.value:e,c.push(f);for(g=m.quickSort(c),h=n._e[a]=[],i=n.af[a]=[],j=n.Te[a]=[],k=0;k<D(g);k++)l=g[k],h.push(l.value),i.push(l.index),j[l.index]=k},a.prototype.getColumnIndex=function(a){var b=this.Ne[a.toUpperCase()];return void 0===b?-1:b},a.prototype.getFilteredRowIndexes=function(){var a=this;return a.Ce?a.He:a.Ie},a.prototype.getFilteredOutRowIndexes=function(){var a,b=this,c=D(b.data),d=b.Ce?b.De:b.Ee,e=[];for(a=0;a<c;a++)d[a]||e.push(a);return e},a.prototype.getData=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.Oe,l=j.getColumnIndex(a);if(l>=0){if(b){for(j._e[l]||j.We(l),c=k[l],d=j._e[l],e=j.Xe(d,b),f=e.start,g=e.end,h=[],i=f;i<=g;i++)h.push(c[j.af[l][i]]);return h}return k[l]||t(j,l),k[l]}return[]},a.prototype.aggregateData=function(a,b,c){var d,f,g,h,i,j,k,l,m,n=this,o=n.getColumnIndex(a);return o<0?e:(n._e[o]||n.We(o),g=n._e[o],h=D(g),i=n.Xe(g,c),d=i.start,f=i.end,5===b?d>=h?e:g[d]:4===b?f<0?e:g[f]:3===b?f<d?0:f-d+1:(j=n.Qka(g,b,d,f),k=j.data1,l=j.data2,m=j.data3,1===b?k/=l:7===b||10===b?(k=(m*l-k*k)/(m*(m-1)),k=7===b?Math.sqrt(k):k):8!==b&&11!==b||(k=(m*l-k*k)/(m*m),k=8===b?Math.sqrt(k):k),k))},a.prototype.Qka=function(a,b,c,d){var g,h,i,j=6===b?1:0,k=0,l=0;for(g=c;g<=d;g++)h=a[g],h===f&&h===e||(i={value:f},p(h,i)&&(h=i.value,1===b?(j+=h,k++):2===b?j++:9===b?j+=h:6===b?j*=h:7!==b&&8!==b&&10!==b&&11!==b||(j+=h,k+=h*h,l++)));return{data1:j,data2:k,data3:l}},a.prototype.Xe=function(a,b){var c=D(a),d,f,g,h;if(b){if(b.min===-(1/0))d=0;else for(g=0;g<c;g++)if(h=a[g],m.isEquals(b.min,h)||m.isGreaterThan(h,b.min)){d=g;break}if(d===e&&(d=c),f===1/0)f=c-1;else{for(g=c-1;g>=0;g--)if(h=a[g],m.isEquals(h,b.max)||m.isGreaterThan(b.max,h)){f=g;break}f===e&&(f=-1)}}else d=0,f=c-1;return{start:d,end:f}},a.prototype.getExclusiveData=function(a){var b=this,c=b.Pe,d=b.getColumnIndex(a);return d>=0?(c[d]||t(b,d),c[d]):[]},a.prototype.getRowIndexes=function(a,b){var c=this,d=c.getColumnIndex(a);return d>=0?(c.Re[d]||t(c,d),c.Qe[d][b]):[]},a.prototype.getExclusiveRowIndex=function(a,b){var c=this,d=c.Re,e=c.getColumnIndex(a);return e>=0?(d[e]||t(c,e),d[e][b]):-1},a.prototype.getFilteredIndexes=function(a){var b=[],c={};return this.gf(a,b,c),b},a.prototype.gf=function(a,b,c){var d,e,f,g=this,h=g.Ce?g.He:g.Ie;for(d=0;d<D(h);d++)e=h[d],f=g.getExclusiveRowIndex(a,e),B(f)||(c[f]?c[f]++:(c[f]=1,b.push(f)))},a.prototype.getFilteredRanges=function(a){return u(this,a,!1)},a.prototype.getFilteredOutRanges=function(a){return u(this,a,!0)},a.prototype.getFilteredOutIndexes=function(a,b){var c=this;return 0===b?v(c,a):1===b?w(c,a):x(c,a)},a.prototype.attachListener=function(a){this.Ze.push(a)},a.prototype.detachListener=function(a){var b,c=this.Ze||[];for(b=0;b<D(c);b++)if(c[b]===a){c.splice(b,1);break}},a.prototype.suspendFilteredEvents=function(){this.$e++},a.prototype.resumeFilteredEvents=function(){var a=this;a.$e--,0===a.$e&&a.onFiltered()},a.prototype.doFilter=function(a,b,c){this.hf(a,b,c),this.onFiltered()},a.prototype.hf=function(a,b,c){var d=this,e=d.Je,f=d.getColumnIndex(a);f<0||(c?(d.Ce=!0,d.Me=f):d.Ce&&A(d,!1),e.indexOf(f)<0&&e.push(f),b.ranges?y(d,a,b.ranges,c):z(d,a,b.exclusiveRowIndexes,c))},a.prototype.clearPreview=function(){A(this,!0)},a.prototype.doUnfilter=function(a){this.if(a),this.onFiltered()},a.prototype.if=function(a){var b,c,d=this;d.Ce&&A(d,!1),b=d.getColumnIndex(a),b<0||(delete d.Ve[b],delete d.Fe[b],delete d.Ge[b],delete d.Ye[b],q(d),c=d.Je.indexOf(b),c>=0&&d.Je.splice(c,1))},a.prototype.onFiltered=function(){var a=this;0===a.$e&&a.cf("onFiltered",{rowIndexes:a.getFilteredRowIndexes(),isPreview:a.Ce})},a.prototype.getListener=function(){return this.Ze},a}(),b.GeneralSlicerData=n;function B(a){return a===f||a===e}function C(a){return typeof a}function D(a){return a?a.length:0}},"./src/plugins/sparkline/sparkline.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/types.ts"),e=c("./src/common/util/colorhelper.ts"),f=c("./src/common/util/arrayhelper.ts"),g=d.j.Fa,h=e.pc.nc,i=e.pc.ec,j=f.k.Cb,b.Vd={},k=null,l=void 0,m=Math.floor,n=Math.PI,o=Math.sin,p=Math.cos,q=Math.min,r=Math.max,s=Math.round,t=Math.pow,u=Math.sqrt,v=Math.abs,w=Math.ceil,x="undefined",y="string",z=isNaN,A=parseFloat,B=Number.MAX_VALUE,C=new Date(""),D="#969696",E="#CB0000",F="#646464",G="#DCDCDC",H="white",I="black",J="blue",K="green",L="grey",M="red",N="lightgrey",O="left",P="right",Q="center",R="top",S="bottom",T="middle",U="start",V="px Arial",W="-",X="+",Y="=",Z=.05,$=.03,_=1.06,aa=.02,ba=4,ca=5,da=5,ea=3,fa=10,ga=8,ha=.8,ia=.25,ja=.9,ka=.7,la=.1,ma=1/45*n,na=function(){function a(a){this.x=a.x,this.y=a.y}return a}(),oa=function(){function a(a){this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height}return a}();function ya(a,b){return{x:a,y:b}}function za(a,b,c,d){return{x:a,y:b,width:c,height:d}}function Aa(a,b){var c,d,e,f=a[0],g=f&&f.value?f.value:f;for(d=1,e=a.length;d<e;d++)f=a[d],c=f&&f.value?f.value:f,(b&&g>c||!b&&g<c)&&(g=c);return g}function Ba(a,b,c,d,e,f,g){f&&(a.strokeStyle=f),g&&(a.lineWidth=g),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.stroke()}function Ca(a,b,c,d,e,f,g){a.save(),f&&(a.strokeStyle=f),g&&(a.lineWidth=g),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.closePath(),a.stroke(),a.restore()}function Da(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;if(a.save(),i=[f,g],a.setLineDash)a.beginPath(),a.strokeStyle=h,a.setLineDash(i),a.stroke(),a.moveTo(b,c),a.lineTo(d,e),a.stroke();else{for(a.beginPath(),a.lineWidth=1,a.strokeStyle=h,j=u(t(d-b,2)+t(e-c,2)),k={x:(d-b)/j,y:(e-c)/j},l=0,m=0;l<j;)n=q(i[m%2],j-l),m++,o=m%2,l+=n,o&&a.moveTo(b,c),b+=n*k.x,c+=n*k.y,o&&a.lineTo(b,c);a.stroke()}a.restore()}function Ea(a,b,c,d,e,f,g,h,i,j,k,l){b?Ba(a,c,d,e,f,k,l):Ba(a,g,h,i,j,k,l)}function Fa(a,b,c,d,e,f,g,h){a.save(),g&&(a.fillStyle=g),a.textBaseline=h||S,a.beginPath(),a.font=e,a.textAlign=f,d="string"==typeof d?d:d+"",a.fillText(d,b,c),a.restore()}function Ga(a){return e.pc.dc(i(a))<127.5?H:I}function Ha(a,b,c,d,e,f,h,i){var j,k,l,m,n=i;return g(i)&&(n=e),h?(j=b+n+f,l=d-2*n,k=a+e,m=c-2*e):(j=a+n,l=c-2*n,k=b+e,m=d-2*e),{left:j,top:k,width:l,height:m}}function Ia(a,b){var c,d,e=0;for(c=0,d=a.length;c<d;c++)e+=b&&!b(a[c])?0:a[c];return e}function Ja(a){return a*n/180}function Ka(a,b,c,d){var e,f,g,h,i=[];for(f=0,g=0,h=a.length;f<h;f++)b?(b(a[f])?i[g]=c?c(a[f]):a[f]:i[g]=0,g++):(e=A(a[f]),!z(e)&&isFinite(e)&&(i[g]=e,g++));return d&&d(i),i}function La(a,b,c,d,e,f){var g=s(b+d),h=s(c+e);b=s(b),c=s(c),d=s(g-b),e=s(h-c),a.beginPath(),a.fillStyle=f,a.fillRect(b,c,d,e),a.fill()}function Ma(a,b,c){return a=q(a,b),a=r(a,c)}function Na(a,b,c,d,e){a.save(),a.rect(b,c,d,e),a.clip()}function Oa(a,b){var c,d,e,f;return!(!a||!b)&&(c=r(a.x+a.width,b.x+b.width),d=r(a.y+a.height,b.y+b.height),e=q(a.x,b.x),f=q(a.y,b.y),c-e<=a.width+b.width&&d-f<=a.height+b.height)}function Pa(a,b,c,d,e,f){var h,i,j,k,l,m,r=c+e/2,s=d+f/2,t=5,u=q(e,f)/2-t,w=-.5*n,x=r+u*p(w),y=s+u*o(w),A=[],B=[];if(!(u<=0)){for(i=Ka(b.values,function(a){return!g(a)&&!z(a)&&isFinite(a)},function(a){return v(a)},function(a){1===a.length&&(a[1]=1-a[0])}),j=i.length,k=Qa(j,b.colors),l=Ia(i),a.save(),m=0;m<j;m++)h=w+i[m]/l*2*n,a.beginPath(),a.moveTo(r,s),a.lineTo(x,y),a.arc(r,s,u,w,h,!1),a.lineTo(r,s),a.fillStyle=k[m],a.fill(),A.push(x),B.push(y),w=h,x=r+u*p(w),y=s+u*o(w);for(m=0;m<j;m++)Ba(a,r,s,A[m],B[m],H);a.restore()}}function Qa(a,b){var c,d,f,g,h,j,k=[],l=b.length;if(a<=l)k=b.slice(0,a);else{for(0===l?(k.push("darkgray"),l=1):k=b.slice(0),c=[],d=void 0,f=a-l+1,g=void 0,g=0;g<l;g++)c[g]=i(k[g]);for(g=l;g<a;g++){d=c[g%l];for(h in d)d.hasOwnProperty(h)&&(j=d[h],d[h]=m(j-j/f*(g/l)));d.a=255,k[g]=e.pc.bc(d)}}return k}pa=function(a){xa(b,a);function b(b){var c=a.call(this,ya(b.x,b.y))||this;return c.value=b.value,c}return b}(na);function Ra(a,b,c){return{x:a,y:b,value:c}}function Sa(a,b,c,d,e,f){var h,i,j,l,m,n,o,p,t,u,v,w,y,A,B,C,D,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U;for(a.save(),h=b.points,i=b.mini,j=b.maxi,l=b.line1,m=b.line2,n=b.colorPositive,o=b.colorNegative,p=5,h=Ka(h,function(a){return!g(a)&&!z(a)&&isFinite(a)}),n=g(n)?"#787878":n,o=g(o)?E:o,G=Aa(h,!1),j=g(j)?G:j,u=r(j,G),H=Aa(h,!0),i=g(i)?H:i,t=q(i,H),t=t>0?0:t,u=u<0?0:u,v=0,v=v>u?u:v,v=v<t?t-1:v,w=h.length,I=Ha(c,d,e,f,p),y=I.left,A=I.top,B=I.width,C=I.height,D=B/(w-1),F=(u-t)/C,K=[],P=A+(u-v)/F,S=0;S<w;S++)L=h[S],Q=y+D*S,R=A+(u-L)/F,0===S&&K.push(new pa(Ra(Q,P,v))),S>0&&L*h[S-1]<0&&(N=K[K.length-1],N&&(O=Ta(N.x,N.y,Q,R,P),K.push(new pa(Ra(O,P,v))))),K.push(new pa(Ra(Q,R,L))),S===w-1&&K.push(new pa(Ra(Q,P,v)));for(a.beginPath(),T=0,U=K.length;T<U;T++)M=K[T],M&&(0===T?a.moveTo(M.x,M.y):a.lineTo(M.x,M.y),N=K[T-1],M.value===v&&N&&(a.fillStyle=N.value>v?n:o,a.fill(),T!==U-1&&(a.beginPath(),a.moveTo(M.x,M.y))));V(l),V(m),a.restore();function V(b){var c,d,e;b===k&&typeof b!==x||(c=Ma(b,u,t),d=0!==F?(u-c)/F:C/2,e=s(A+d)-.5,Ba(a,y,e,y+B,e,J))}}function Ta(a,b,c,d,e){return((b-e)*c+(e-d)*a)/(b-d)}function Ua(a,b,c,d,e,f){var h,i,j,k,l,m,o,p,t,u,v,w,x,y,z,A,C,F,H,I,J,K,L,M,N,O,P=b.points1,Q=b.points2,R=b.minX,S=b.maxX,T=b.minY,U=b.maxY,V=b.hLine,W=b.vLine,X=b.xMinZone,Y=b.xMaxZone,Z=b.yMinZone,$=b.yMaxZone,_=b.tags,aa=b.drawSymbol,ba=b.drawLines,ca=b.color1,da=b.color2,ea=b.dash,fa=4,ga=Ha(c,d,e,f,5),ha=ga.left,ia=ga.top,ja=ga.width,ka=ga.height;function la(b,c,d,e){p=b[c],u=p.x,v=p.y,p=b[c+1],w=p.x,x=p.y,y=ha+(u-l)*ja/(m-l),A=ha+(w-l)*ja/(m-l),z=ia+(k-v)*ka/(k-j),C=ia+(k-x)*ka/(k-j),ba&&Xa(a,y,z,A,C,d,ea),aa&&(0===c&&e(y,z),e(A,C))}function ma(a,b,c,d,e){var f=Va(a,!0),h=Va(a,!1);j=g(T)?f.y:b,k=g(U)?h.y:c,l=g(R)?f.x:d,m=g(S)?h.x:e,m=l>=m?l+1:m,k=j>=k?j+1:k}function na(b,c,d){a.beginPath(),a.arc(b-fa/2,c-fa/2,fa/2,0,2*n,!1),a.fillStyle=d,a.fill()}function oa(b,c){a.beginPath(),a.strokeStyle=ca,a.arc(b-fa/2,c-fa/2,fa/2,0,2*n,!1),a.stroke()}function pa(b,c){a.beginPath(),a.strokeStyle=da,a.strokeRect(b-fa/2,c-fa/2,fa,fa)}if(P&&!(P.length<=0)&&(h=Ya(P),!(h.length<=0||Q&&Q.length>0&&(i=Ya(Q),i.length<=0)))){for(Na(a,c,d,e,f),a.beginPath(),aa=!!g(aa)||aa,ca=g(ca)?D:ca,da=g(da)?E:da,ma(h,T,U,R,S),!g(X)&&!g(Y)&&!g(Z)&&!g($)&&l<=X&&X<=m&&l<=Y&&Y<=m&&j<=Z&&Z<=k&&j<=$&&$<=k&&(L=r(l,X),M=q(m,Y),N=r(j,Z),O=q(k,$),L>=M&&(M=L+1),N>=O&&(O=N+1),La(a,ha+(L-l)*ja/(m-l),ia+(k-O)*ka/(k-j),(M-L)*ja/(m-l),(O-N)*ka/(k-j),G)),F=-B,H=-B,I=B,J=B,t=h.length,o=0;o<t-1;o++)la(h,o,ca,oa),_&&(0===o&&(z>H&&(F=y,H=z),z<J&&(I=y,J=z)),C>H&&(F=A,H=C),C<J&&(I=A,J=C));if(i&&i.length>0)for(ma(i,j,k,l,m),t=i.length,o=0;o<t-1;o++)la(i,o,da,pa);_&&(na(F,H,E),na(I,J,"#0000FF")),!g(V)&&j<=V&&V<=k&&(K=s(ia+(k-V)*ka/(k-j))-.5,Xa(a,ha,K,ha+ja,K,E)),!g(W)&&l<=W&&W<=m&&(K=s(ha+(W-l)*ja/(m-l))-.5,Xa(a,K,ia,K,ia+ka,E)),a.restore()}}function Va(a,b){var c,d,e=b?1:-1,f=b?q:r,g=new na(ya(e*B,e*B)),h=a.length;for(d=0;d<h;d++)c=a[d],g.x=f(g.x,c.x),g.y=f(g.y,c.y);return g}function Wa(a,b,c,d){return c/d*(b-a)+a}function Xa(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,v,w,x,y,z;if(g){for(h=u(t(d-b,2)+t(e-c,2)),i=0,j=6,k=2,l=4,m=[],n=void 0,o=void 0,p=void 0,q=void 0,b<=d?(n=b,o=d,p=b,q=c):(n=d,o=b,p=d,q=e),r=(e-c)/(d-b),s=c-r*b,m.push(new na(ya(p,q))),v=[j,l,k,l];i<h;)for(w=0,x=v.length;w<x;w++)i+=v[w],i<=h&&(p=Wa(n,o,i,h),q=r*p+s,m.push(new na(ya(p,q))));for(y=0,z=m.length;y<z-1;y+=2)Ba(a,m[y].x,m[y].y,m[y+1].x,m[y+1].y,f)}else Ba(a,b,c,d,e,f)}function Ya(a){var b,c,d,e=[],f=a.length;if(f>0)if(b=a[0].length,f<b){if(f>=2)for(c=0;c<b;c++)e.push(new na(ya(a[0][c],a[1][c])))}else if(b>=2)for(d=0;d<f;d++)e.push(new na(ya(a[d][0],a[d][1])));return e}function Za(a,b,c,d,e,f){var i,j,k,l,n,o,p,q,t,u,v,w,x,y,A,B,C,D=b.measure,G=b.target,H=b.maxi,I=b.good,J=b.bad,K=b.forecast,L=b.tickUnit,M=b.colorScheme,N=b.vertical,O=5,P=b.measureColor,Q=b.targetColor,R=b.maxiColor,S=b.goodColor,T=b.badColor,U=b.forecastColor,V=b.allowMeasureOverMaxi,W=b.barSize;function X(b,g,h,i,j){var m,n,o;a.fillStyle=b,m=k,n=l*(g/h),n>l&&!V&&(n=l),o=new oa(N?za(c+e*i,m-n,e*j,n):za(m,d+f*i,n,f*j)),a.fillRect(o.x,o.y,o.width,o.height)}if(!(g(H)||H<0)&&(g(W)||!(z(W)||W<=0))){if(W>1&&(W=1),D=g(D)||D<0?0:D,I=g(I)||I<0?0:I,J=g(J)||J<0?0:J,G=g(G)?0:G,K=g(K)?0:K,L=g(L)?0:L,M=g(M)?"#A0A0A0":M,i=g(P)?"#252525":P,D>H&&!V&&(D=H,i=E),I>H&&(I=H,i=E),J>H&&(J=H,i=E),G>H&&(G=0,i=E),K>H&&(K=H,i=E),j=Ha(c,d,e,f,O,f-2*O,N),k=j.left,l=j.width,a.save(),n=g(W)?.2:(1-W)/2,o=g(W)?.6:W,p=V?r(H,D):H,X(g(R)?h(M,1.66):R,H,p,n,o),X(g(S)?h(M,1.33):S,I,p,n,o),X(g(T)?M:T,J,p,n,o),q=.25*W/.6,t=g(W)?.375:(1-q)/2,u=g(W)?.25:q,X(i,D,p,t,u),K>0&&(v=k,w=l*(K/p),w>l&&(w=l),x=g(W)?3:3*W/.6,Ea(a,N,c+.5*e,v,c+.5*e,v-w,v,d+.5*f,v+w,d+.5*f,g(U)?"#3690BF":U,x)),G>0&&(y=s(k-(N?1:-1)*l*(G/p))-.5,Ea(a,N,c+e*n,y,c+e*(1-n),y,y,d+f*n,y,d+f*(1-n),g(Q)?E:Q,1)),L>0)for(A=m(p/L),B=void 0,C=0;C<=A;C++)B=s(k-(N?1:-1)*(l/p*L)*C)-.5,Ea(a,N,c,B,c+.05*e,B,B,d+f,B,d+.95*f,F,1);a.restore()}}function $a(a,b,c,d,e,f){var h,i,j,k,l,m,n,o,p,t,u,v,w,x,y,z,A,B,C,D,G,H,I=b.spreadData,J=b.showAverage,K=b.scaleStart,L=b.scaleEnd,M=b.style,N=b.colorScheme,O=b.vertical,P=5,Q=I.length;if(!(Q<=0)){for(h=I[0].key,i=I[Q-1].key,K=g(K)?h:K,L=g(L)?i:L,M=g(M)?4:M,N=g(N)?F:N,j=Ha(c,d,e,f,P,f-2*P,O),k=j.left,l=j.width,m=j.top,n=j.height,Na(a,c,d,e,f),a.beginPath(),a.strokeStyle=N,a.fillStyle=N,a.lineWidth=2,t=Aa(I,!1),v=0,w=I.length;v<w;v++)if(x=I[v],y=x.key,z=x.value,o=k+(O?-1:1)*l*(y-K)/(L-K),O?(o=q(o,k),o=r(o,k-l)):(o=r(o,k),o=q(o,k+l)),o=s(o),1===M)u=z/2*n/t,u=u<.5?.5:u,A=m+n/2-u,B=m+n/2+u,Ea(a,O,A,o,B,o,o,A,o,B);else if(4===M)u=z*n/t,u=u<1?1:u,Ea(a,O,m,o,m+u,o,o,m+n,o,m+n-u);else if(6===M)Ea(a,O,m,o,m+n,o,o,m,o,m+n);else for(C=2,D=1;D<=z;D++){switch(M){case 2:p=m+n/2-P-(z/2-D)*n/t;break;case 3:G=_a(z,n,C+1,x.randomNumbers),p=m+n-P-G[D-1];break;case 5:default:p=m+n-D*n/t}p=s(p),a.beginPath(),a.fillRect(O?p:o,O?o:p,C,C)}J&&(H=ab(I),o=k-(O?1:-1)*l*(H-K)/(L-K),
Ea(a,O,m-P,o,m+n+P,o,o,m-P,o,m+n+P,E)),a.restore()}}function _a(a,b,c,d){for(var e,f=[],g=r(100,10*a),h=0,i=[],j=0;f.length<a;)e=m(d[j]*b),j++,(h>g||bb(e,i))&&(f.push(e),i.push([e-c,e+c])),h++;return f}function ab(a){var b,c,d,e=0,f=0;for(b=0,c=a.length;b<c;b++)d=a[b],f+=d.value,e+=d.key*d.value;return 0===f?0:e/f}function bb(a,b){var c,d,e;for(c=0,d=b.length;c<d;c++)if(e=b[c],e[0]<=a&&a<=e[1])return!1;return!0}function cb(a,b,c,d,e,f,i){var j,m,n,o,p,q,r,t,u,v,w,x,y,A,B,C,D,G,H=b.points,I=H&&H.length,L=b.colorRange,N=b.labelRange,O=b.maximum,P=b.targetRed,R=b.targetGreen,S=b.targetBlue,U=b.targetYellow,W=b.color,X=b.highlightPosition,Y=b.vertical,Z=b.textOrientation,$=b.textSize,_=5;function aa(b,c,d){var e,f;c!==k&&c!==l&&(c=c>O?O:c,d&&!d(c)||(c=c<0?0:c,f=c/O*p,Y?(e=s(o-f)-.5,Ba(a,q,e,q+r,e,b)):(e=s(o+f)-.5,Ba(a,e,q,e,q+r,b))))}if(!(g(H)||I<=0)){if(W=g(W)?F:W,g(L)||L.length!==I||db(L))for(L=[],j=0;j<I;j++)L.push(h(W,1+j/I));for(m=Ia(H,function(a){return a>0}),O=g(O)||O<m?m:O,Z=g(Z)?0:Z,$=g($)||$<=0?10:$,$=z($)?$:$*i.zoomFactor,n=Ha(c,d,e,f,_,f-2*_,Y),o=n.left,p=n.width,q=n.top,r=n.height,a.save(),t=o,B=0,C=I;B<C;B++)A=H[B],A<=0||(u=A/O*p,Y?(v=c+.15*e,x=.7*e,w=t-u,y=u):(v=t,x=u,w=d+.15*f,y=.7*f),D=B+1===X?E:L[B],a.save(),a.fillStyle=D,a.fillRect(v,w,x,y),G=N&&N[B],G&&(a.save(),a.fillStyle=Ga(D),a.textBaseline=T,a.textAlign=Q,a.font=$+V,a.rect(v,w,x,y),a.clip(),1===Z?(a.translate(v+x/2,w),a.rotate(Math.PI/2),a.fillText(G,y/2,0)):a.fillText(G,v+x/2,w+y/2),a.restore()),t+=(Y?-1:1)*u,a.restore());aa(M,P,function(a){return a>0}),aa(K,R),aa(J,S),aa("yellow",U),a.restore()}}function db(a){for(var b=0,c=a.length;b<c;b++)if(g(a[b]))return!0;return!1}function eb(a,b,c,d,e,f){Ba(a,hb(b),hb(c),hb(d),hb(e),g(f)?I:f,1)}function fb(a,b,c,d,e){var f,g,h,i,j,k=.4*d;switch(b=hb(b),c=hb(c),a.beginPath(),a.moveTo(b,c),f=k/2,g=u(3)*k/2,h=k/u(3),e){case 0:i=[-f,0,f],j=[g,h,g];break;case 2:i=[-f,0,f],j=[-g,-h,-g];break;case 3:i=[g,h,g],j=[-f,0,f];break;case 1:i=[-g,-h,-g],j=[-f,0,f];break;default:i=[],j=[]}i.forEach(function(d,e){a.lineTo(hb(b+d),hb(c+j[e]))}),a.lineTo(b,c),a.closePath(),a.fillStyle=H,a.fill()}function gb(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,w,x=c.value,y=c.colorScheme,B=c.axisVisible,C=c.barHeight,D=c.barWidth,E=5,F=5,G=!1,H=A(x);if(!z(H)){if(o=0===a?C:D,g(o))p=.7;else{if(z(o)||o<=0)return;p=Math.min(1,o)}H>1?(H=1,G=!0):H<-1&&(H=-1,G=!0),y=g(y)?"grey":y,B=!!g(B)||B,b.save(),0===a?(q=f-2*E,r=h*p,H>=0?(G&&(i=new na(ya(d+E+q-F,e+h/2))),j=new oa(za(d+E,e+h*(1-p)/2,q*H,r)),k=new na(ya(d+E,e+1)),l=new na(ya(d+E,e+h)),m=1):(s=v(q*H),G&&(i=new na(ya(d+E+F,e+h/2))),j=new oa(za(d+f-E-s,e+h*(1-p)/2,s,r)),k=new na(ya(d+f-E,e+1)),l=new na(ya(d+f-E,e+h)),m=3),n=g(o)?h:h*p):1===a&&(t=h-2*E,u=f*p,H>=0?(w=t*H,j=new oa(za(d+(1-p)/2*f,e+h-E-w,u,w)),G&&(i=new na(ya(d+f/2,e+h-E-w+F)),m=0),k=new na(ya(d+1,e+h-E)),l=new na(ya(d+f,e+h-E))):(H=v(H),j=new oa(za(d+(1-p)/2*f,e+E,u,t*H)),G&&(i=new na(ya(d+f/2,e+E+t-F)),m=2),k=new na(ya(d+1,e+E)),l=new na(ya(d+f,e+E))),n=g(o)?f:f*p),b.beginPath(),j&&(La(b,j.x,j.y,j.width,j.height,y),Na(b,j.x,j.y,j.width,j.height)),i&&fb(b,i.x,i.y,n,m),b.restore(),B&&k&&eb(b,k.x,k.y,l.x,l.y),b.restore()}}function hb(a){return s(a)-.5}function ib(a,b,c,d,e,f){gb(0,a,b,c,d,e,f)}function jb(a,b,c,d,e,f){gb(1,a,b,c,d,e,f)}function kb(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,s,t,w,x,y,B,C,F,G,H,J,L=b.variance,N=b.reference,U=b.mini,W=b.maxi,X=b.mark,Y=b.tickUnit,Z=b.legend,$=b.colorPositive,_=b.colorNegative,aa=b.vertical,ba=.5,ca=.5-ba/2,da=5,ea=E,fa=D,ga=13*h.zoomFactor,ha=A(L);function ia(b,g,h,j,k,l,o,q,r,s,t,v,w,z){var A,B,C,D,E,F;aa?(A=c+ca*e,B=0===g?x-y:x,C=e*ba,D=y,La(a,A,B,C,D,b)):(A=0===g?x:x-y,B=d+ca*f,C=y,D=f*ba,La(a,A,B,C,D,b)),p&&(Na(a,A,B,C,D),aa?fb(a,c+e/2,i+h,n,k):fb(a,i+j,d+f/2,n,l),a.restore()),Z&&(E=void 0,F=0,p&&(F=.4*n*u(3)/2+da+2),a.save(),a.beginPath(),a.font=ga+V,a.fillStyle=I,aa?(a.textAlign=Q,E=ga+y+o,ja(E,z,b,q,r,A,B,C,D,aa),a.fillText(m,c+e/2,x+w*(y-F))):(a.textBaseline=T,E=a.measureText(m).width+y+s,ja(E,z,b,t,v,A,B,C,D,aa),a.fillText(m,x+w*(F-y),d+f/2)),a.restore())}function ja(b,c,d,e,f,g,h,i,j,k){k?a.textBaseline=e:a.textAlign=e,b>0&&c<y&&(a.rect(g,h,i,j),a.clip(),k?a.textBaseline=f:a.textAlign=f,a.fillStyle=Ga(d))}function ka(b,c,d,e,f,g,h,i,j,k){aa?eb(a,b,c,d,e,j):eb(a,f,g,h,i,k)}if(!(z(ha)||(_=g(_)?M:_,$=g($)?K:$,Y=g(Y)?0:Y,W=g(W)?1:W,U=g(U)?-1:U,o=!g(N),o||(N=0),aa?(i=d+f-da,j=f-2*da,k=e-4*da,l=-1):(i=c+da,j=e-2*da,k=f-4*da,l=1),Z&&(q=A(b.variance),z(q)||(r=""+q,s=r.substr(r.indexOf(".")+1).length,m=s>=2?(100*q).toFixed(s-2)+"%":(100*q).toFixed(0)+"%")),ha>W&&(ha=W,p=!0),ha<U&&(ha=U,p=!0),N=Ma(N,W,U),p&&(n=Ma(k,60,15)),t=v(W-U),w=j/t,x=i+l*v(U-N)*w,y=v(ha-N)*w,y>v(t)*w&&(y=v(t+U)*w),B=i+l*j,aa&&x<B||!aa&&x>B))){if(Na(a,c,d,e,f),ha>N?ia($,0,da-j,j-da,0,1,d-x,S,R,x-c-e,O,P,-1,v(W-ha)*w):(y>v(t)*w&&(y=v(t+U)*w,x=i),ia(_,1,-da,da,2,3,x-d-f,R,S,c-x,P,O,1,v(U-ha)*w)),o&&(C=i+l*(Math.abs(U-N)*w),ka(c,C,c+e,C,C,d,C,d+f)),Y>0)for(a.beginPath(),F=t/Y,G=0;G<=F;G++)H=i+j/F*G*l,ka(c,H,c+.1*e,H,H,d+.9*f,H,d+f,fa,fa);!g(X)&&U<=X&&X<=W&&(a.beginPath(),J=i-(aa?1:-1)*v(U-X)*w,ka(c,J,c+.33*e,J,J,d+.66*f,J,d+f,ea,ea),a.fill()),a.restore()}}qa="7ns",ra="5ns",sa="tukey",ta="bowley",ua="sigma3";function lb(a,b,c,d,e,f){var h,i,j,l,m,n,o,p,s,t,u,w,x,B,C,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,va,wa,xa=b.points,ya=b.boxPlotClass,za=b.showAverage,Ba=b.scaleStart,Ca=b.scaleEnd,Da=b.acceptableStart,Fa=b.acceptableEnd,Ga=b.style,Ja=b.colorScheme,Ma=b.vertical,Oa=5,Pa=Aa(xa,!1),Qa=Aa(xa,!0);function Ra(b,c,d,e,f,g,h,i,j){Ma?La(a,c,d,e,f,b):La(a,g,h,i,j,b)}function Sa(b,c,d,e){Ea(a,Ma,T+U*b,d,T+U*c,d,d,T+U*b,d,T+U*c,e)}if(!(g(xa)||(xa=Ka(xa),xa.length<=0))){for(ya=ya===k||typeof ya!==y?ra:ya.toLocaleLowerCase(),ya!==ra&&ya!==qa&&ya!==sa&&ya!==ta&&ya!==ua&&(ya=ra),h=A(Ba),h=z(h)?Qa:h,i=A(Ca),i=z(i)?Pa:i,j=A(Da),l=A(Fa),Ja!==k&&typeof Ja===y||(Ja="#D2D2D2"),(Ga===k||0!==Ga&&1!==Ga)&&(Ga=0),m=E,h>Qa&&(Ja=m,h=Qa),i<Pa&&(Ja=m,i=Pa),Na(a,c,d,e,f),a.lineWidth=2,n=Ha(c,d,e,f,Oa,f-2*Oa,Ma),o=n.left,p=n.width,s=n.top,t=n.height,u=Ma?-1:1,w=b.perc02,x=b.perc09,B=b.perc10,C=b.perc90,G=b.perc91,H=b.perc98,I=b.q1,J=b.q3,K=J-I,L=Qa,M=Pa,N=1.5*K,O=1.5*K,P=b.stDev,Q=Ia(xa)/r(1,xa.length),R=0,S=0,T=s+.1*t,U=.7*t,V=v(i-h),W=0,X=xa.length;W<X;W++)Y=xa[W],Y<I&&Y>=I-1.5*K&&Y-(I-1.5*K)<N&&(N=Y-(I-1.5*K),L=Y),Y>J&&Y<=J+1.5*K&&J+1.5*K-Y<O&&(O=J+1.5*K-Y,M=Y),Z=!1,R=o+u*(p*((Y-h)/V)),ya===sa&&(Y<=I-1.5*K||Y>=J+1.5*K)&&(Z=!0,S=Y<=I-3*K||Y>=J+3*K?0:1),ya===qa&&(Y<=w||Y>=H)&&(Z=!0,S=1),ya===ua&&(Y<=Q-2*P||Y>=Q+2*P)&&(Z=!0,S=Y<=Q-3*P||Y>=Q+3*P?0:1),$=D,Z&&(1===Ga?1===S?Sa(.2,.8,R,$):Sa(.3,.7,R,$):(_=.1*t,_<2&&(_=2),a.beginPath(),a.strokeStyle=$,aa=s+.45*t,ba=R,a.arc(Ma?aa:ba,Ma?ba:aa,_/2,0,2*Math.PI),a.stroke()));switch((h>j||i<l)&&(Ja="#C0FF00"),j=r(h,j),l=q(i,l),j>l?Ja=m:j<l&&(ca=o+u*(p*((j-h)/V)),da=o+u*(p*((l-h)/V)),ea=s+.9*t,Ea(a,Ma,ea,ca,ea,da,ca,ea,da,ea,F)),fa=o+u*(p*((I-h)/V)),ga=v(o+u*(p*((J-h)/V))-fa),ha=b.median,ia=o+u*(p*((ha-h)/V)),ya){case qa:la=w,ma=H;break;case sa:la=L,ma=M;break;case ua:fa=o+u*(p*((Q-P-h)/V)),ga=v(o+u*(p*((Q+P-h)/V))-fa),ia=o+u*(p*((Q-h)/V)),na=Q-2*P,la=na>h?na:Qa,na=Q+2*P,ma=na<i?na:Pa,za=!1;break;case ra:case ta:default:la=Qa,ma=Pa}ja=o+u*(p*((la-h)/V)),ka=o+u*(p*((ma-h)/V)),oa=D,1===Ga?Ra("#F2F2F2",T,ka,U,ja-ka,ja,T,ka-ja,U):(pa=s+.45*t,Ea(a,Ma,pa,ja,pa,ka,ja,pa,ka,pa,oa)),Ra(Ja,T,fa-ga,U,ga,fa,T,ga,U),Ea(a,Ma,T,ia,T+U,ia,ia,T,ia,T+U,oa),0===Ga&&(Ea(a,Ma,T+.3*U,ka,T+.7*U,ka,ka,T+.3*U,ka,T+.7*U,oa),Ea(a,Ma,T+.3*U,ja,T+.7*U,ja,ja,T+.3*U,ja,T+.7*U,oa)),ya!==qa&&ya!==ta||(va=void 0,wa=void 0,ya===qa?(la=x,ma=G):(la=B,ma=C),va=o+u*(p*((la-h)/V)),wa=o+u*(p*((ma-h)/V)),Sa(.3,.7,wa,oa),Sa(.3,.7,va,oa)),za&&(R=o+u*(p*((Q-h)/V)),Sa(.2,.8,R,m)),a.restore()}}function mb(a,b,c,d,e){b=s(b),c=s(c),d=s(d),e=s(e),b===d&&(d-=.5,b=d),c===e&&(e-=.5,c=e),a.moveTo(b,c),a.lineTo(d,e)}function nb(a,b,c,d,e,f,g,h,i,j,k){a.beginPath(),a.strokeStyle=c,b?mb(a,d,e,f,g):mb(a,h,i,j,k),a.stroke()}function ob(a,b,c,d,e){a.rect(b,c,d,e),a.clip()}function pb(a,b,c,d,e,f){var h,i,j,k,l,m,n,o=f.labelText,p=f.fontSize,q=f.startBox,r=f.endBox,s=f.boxColor,t=f.isInRightOrTopOfBox,u=f.fillStyle;a.save(),a.beginPath(),a.font=p+V,k=1,u=g(u)?I:u,f.vertical?(l=Q,t?(h=p+r-(q-c),h>0&&q-r-c<r?(m=R,u=Ga(s),j=q-r+k,ob(a,b,q-r,d,r)):(m=S,j=q-r-k)):(h=p-(c+e-q),h>0&&c+e-q<r?(ob(a,b,q-r,d,r),m=S,u=Ga(s),j=q-k):(m=R,j=q+k)),a.textAlign=l,a.textBaseline=m,a.fillStyle=u,a.fillText(o,b+d/2,j)):(m=T,n=a.measureText(o),t?(h=n.width+r-(b+d-q),h>0&&b+d-(q+r)<r?(ob(a,q,c,r,e),l=P,u=Ga(s),i=q+r-k):(l=O,i=q+r+k)):(h=n.width-(q-b),h>0&&q-b<r?(ob(a,q,c,r,e),i=q+k,l=O,u=Ga(s)):(l=P,i=q-k)),a.textAlign=l,a.textBaseline=m,a.fillStyle=u,a.fillText(o,i,c+e/2)),a.restore()}function qb(a,b,c,d,e,f,i){var j,l,m,n,o,p,s,t,u,w,x,B,C,D,E,F,H,J,K,L,M,N,O,P,Q,R,S,T,U,V,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa=b.points,pa=b.labels,qa=b.pointIndex,ra=b.minimum,sa=b.maximum,ta=b.colorPositive,ua=b.colorNegative,va=b.vertical,wa=b.itemTypeRange,xa=b.colorTotal,ya=5,za=13*i.zoomFactor;if(!(g(oa)||(j=oa.length,j<=0||(l=parseInt(qa,10),z(l)||l<=0||l>j)))){for(pa=g(pa)?[]:pa,ta!==k&&typeof ta===y||(ta="#8CBF64"),ua!==k&&typeof ua===y||(ua="#D6604D"),typeof xa!==y&&(xa=k),m=ta,n=h(ta,1.3),o=ua,p=h(ua,1.3),s=1,t=0,u=0,w=0,x=0,B=[],C=0,D=0,F=0,H=j;F<H;F++)D=oa[F],E=wa[F],J=!1,K=1===s,L=!g(E),L&&(E===X?D=v(D):E===W?D=-v(D):E===Y?(J=!0,K?t=D:D=t):L=!1),B[s]=[],M=B[s],z(D)?(M[0]=0,M[1]=t,M[2]=0):(M[0]=v(D),t=J?t:D+t,M[1]=D>0?u:t,M[2]=D),M[3]=s,w=q(u,w),x=r(u,x),N=s===j,(N&&!L||J)&&(C=w<0?-w:0,M[1]=D>0?0:D),L&&J&&!K||(u=D+u,N&&L&&(w=q(u,w),x=r(u,x))),s++;O=!1,g(E)||(P=[W,X,Y],O=P.indexOf(E)===-1),(g(E)||O)&&(t-=D),S=A(ra),z(S)||S>0||S>w?(Q=w,S=w):(Q=S,C=-S),T=A(sa),z(T)||T<0||T<x?R=x:(R=T,C=-S),U=Ha(c,d,e,f,ya,f-2*ya,va),V=U.left,Z=U.width,$=U.top,_=U.height,aa=va?-1:1,ba=R-Q,ca=Z/ba,Na(a,c,d,e,f),a.beginPath(),a.lineWidth=1,da=B[l],ea=da[2],fa=wa[l-1],ga=V+aa*(da[1]+C)*ca,ha=da[0]*ca,ja=fa===Y,ka=(g(fa)||O)&&l===j||ja,ia=xa&&ka?xa:1===l||ka?ea>=0?m:o:ea>=0?n:p,va?La(a,$,ga-ha,_,ha,ia):La(a,ga,$,ha,_,ia),va?(1!==l&&(l!==j?nb(a,ea>0,G,c,ga,$+_,ga,c,ga-ha,$+_,ga-ha):(la=V-(t+C)*ca,nb(a,!0,G,c,la,$+_,la))),l!==j&&nb(a,ea>0,G,$,ga-ha,c+e,ga-ha,$,ga,c+e,ga)):(1!==l&&(l!==j?nb(a,ea>0,G,ga,d,ga,$+_,ga+ha,d,ga+ha,$+_):(ma=V+(t+C)*ca,nb(a,!0,G,ma,d,ma,$+_))),l!==j&&nb(a,ea>0,G,ga+ha,$,ga+ha,d+f,ga,$,ga,d+f)),na=pa[l-1],pa.length>0&&!g(na)&&""!==na&&pb(a,c,d,e,f,{labelText:na,vertical:va,isInRightOrTopOfBox:ea>0,fontSize:za,startBox:ga,endBox:ha,boxColor:ia}),nb(a,va,I,c,V-C*ca,c+e,V-C*ca,V+C*ca,d,V+C*ca,d+f),a.restore()}}function rb(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,t,u,v,x,B,C,F,G,H,I,J,K,L,M,N,O,P,Q=b.points,R=b.pointIndex,S=b.colorRange,T=b.target,U=b.target2,V=b.highlightPosition,W=b.label,X=b.vertical,Y=13*h.zoomFactor,Z=b.targetColor,$=b.target2Color,_=b.labelColor,aa=b.barSize;function ba(a){var b=A(a);return b=z(b)?0:b,b=b<0?0:b,b=b>1?1:b}if(!g(Q)&&(g(aa)||!(z(aa)||aa<=0))&&(aa>1&&(aa=1),i=Q.length,!(i<=0||(j=parseInt(R,10),z(j)||j<=0||j>i)))){for(S=g(S)?[]:S,k=parseInt(W,10),k=z(k)?0:k,l=1,m=0,n=[],o=0,p=Q.length;o<p;o++)q=Q[o],n[l]=[],r=n[l],q<0||z(q)||g(q)?(r[0]=1===l?0:m,r[1]=0):(m+=q,r[0]=1===l?0:m-q,r[1]=q),l++;u=5,t=g(aa)?u:X?e*(1-aa)/2:f*(1-aa)/2,v=Ha(c,d,e,f,t,f-2*u,X,u),x=v.left,B=v.width,C=v.top,F=v.height,G=X?-1:1,H=B/m,Na(a,c,d,e,f),a.beginPath(),a.lineWidth=1,I=n[j],J=I[1],K=x+G*I[0]*H,L=I[1]*H,M=j===V?E:0===S.length||typeof S[j-1]!==y?D:S[j-1],X?La(a,C,K-L,F,L,M):La(a,K,C,L,F,M),1===k?N=(I[0]+J)/m*1e3:2===k&&(N=J/m*1e3),O=s(N)/10+"%",1!==k&&2!==k||""===O||pb(a,c,d,e,f,{labelText:O,vertical:X,isInRightOrTopOfBox:(I[0]+I[1])*H<B/2,fontSize:Y,startBox:K,endBox:L,boxColor:M,fillStyle:_}),P=[g(Z)?"#8CBF64":Z,g($)?"#EE5D5D":$],[T,U].forEach(function(b,g){var h=ba(b),i=w(x+G*B*h);nb(a,X,P[g],c,i,c+e,i,i,d,i,d+f)}),a.restore()}}function sb(a,b){switch(b){case 2:var c=a%4===0&&a%100!==0||a%400===0;return c?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function tb(a,b,c){var d,e,f,g,h,j;return a<0&&(a=0),a>1&&(a=1),d=i(b),e=i(c),f=d.a*(1-a)+e.a*a,g=d.r*(1-a)+e.r*a+"",h=d.g*(1-a)+e.g*a+"",j=d.b*(1-a)+e.b*a+"","rgba("+parseInt(g,10)+","+parseInt(h,10)+","+parseInt(j,10)+","+A(f/255+"")+")"}function ub(a,b,c){return a===b&&a===c?1:a<=b?0:a>=c?1:(a-b)/(c-b)}function vb(a,b,c,d,e,f){var g=(f+e)/2;return e<=d&&d<=g?tb(ub(d,e,g),a,b):tb(ub(d,g,f),b,c)}function wb(a){var b=B,c=-B;return a.forEach(function(a){a!==k&&a!==l&&(b>a&&(b=a),c<a&&(c=a))}),{min:b,max:c}}function xb(a,b,c,d,e,f,g){var h,i,j;d?a.forEach(function(a,e){0!==a&&a!==k&&a!==l&&(b[c+e]=d[e]||b[c+e])}):(h=wb(a),i=h.min,j=h.max,a.forEach(function(a,d){0!==a&&a!==k&&a!==l&&(b[c+d]=vb(e,f,g,a,i,j))}))}function yb(a,b,c,d,e,f){var g,h,i,j,k=b.year,l=b.month,m=b.values,n=b.emptyColor||"lightgray",o=b.startColor,p=b.middleColor,q=b.endColor,r="white",s=6,t=7,u=2,v=(e-(s+1)*u)/s,w=(f-(t+1)*u)/t,x=[],y=new Date(k,l-1,1).getDay();for(g=0;g<s*t;g++)g<y?x[g]=r:g<y+sb(k,l)?x[g]=n:x[g]=r;for(xb(m,x,y,b.colors,o,p,q),a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),h=0,i=0;i<s;i++)for(j=0;j<t;j++)a.fillStyle=x[h],h++,a.fillRect(c+i*v+(i+1)*u,d+j*w+(j+1)*u,v,w);a.restore()}function zb(a){var b,c=a.getFullYear(),d=a.getMonth(),e=a.getDate();for(b=1;b<d+1;b++)e+=sb(c,b);return e}function Ab(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=b.year,G=b.values,H=b.emptyColor||"lightgray",I=b.startColor,J=b.middleColor,K=b.endColor,L="white",M=7,N=parseInt(366/M+"",10)+2,O=[],P=new Date(F,0,1).getDay(),Q=zb(new Date(F,11,31));for(h=0;h<N*M;h++)h<P?O[h]=L:h<P+Q?O[h]=H:O[h]=L;for(xb(G,O,P,b.colors,I,J,K),a.save(),a.rect(c,d,e,f),a.clip(),i=g.zoomFactor,j=15*i,k=c+j,l=d,m=e-j,n=f,a.save(),a.translate(c+j/2,l+n),a.rotate(-Math.PI/2),a.font=13*i+V,a.fillStyle="black",a.textBaseline="middle",a.textAlign="center",a.fillText(F+"",n/2,0),a.restore(),o=2,p=(m-(N+1)*o)/N,q=(n-(M+1)*o)/M,r=0,v=[],t=0;t<N;t++)for(s=0;s<M;s++)u={x:k+t*p+(t+1)*o,y:l+s*q+(s+1)*o,w:p,h:q},v[r]=u,a.fillStyle=O[r],r++,a.fillRect(u.x,u.y,u.w,u.h);for(w=[],x={},y=0;y<12;y++)x[y]=zb(new Date(F,y,1))-1+P;for(z=x[11]+sb(F,12)-1,r=0,t=0;t<N;t++)for(s=0;s<M;s++)P<=r&&r<P+Q&&(A=new Date(F,0,r-P+1),B=A.getMonth(),C=x[B],u=v[r],C<=r&&r<7+C&&w.push({x1:u.x,y1:u.y-o/2,x2:u.x,y2:u.y+u.h+o/2}),r!==C&&0!==A.getDay()||w.push({x1:u.x-o/2,y1:u.y,x2:u.x+u.w+o/2+(r===C?o:0),y2:u.y}),z-7<r&&r<=z&&w.push({x1:u.x+u.w,y1:u.y-o/2,x2:u.x+u.w,y2:u.y+u.h+o/2}),r!==z&&6!==A.getDay()||w.push({x1:u.x-o/2-(r===z?o:0),y1:u.y+u.h,x2:u.x+u.w+o/2,y2:u.y+u.h})),r++;for(a.strokeStyle="black",a.lineWidth=2,D=0;D<w.length;D++)E=w[D],a.beginPath(),a.moveTo(E.x1,E.y1),a.lineTo(E.x2,E.y2),a.stroke();a.restore()}function Bb(a){var b,c,d=Ja(a.minAngle-90),e=Ja(a.maxAngle-90),f=a.minValueOption.value,g=a.maxValueOption.value,h=a.ranges,i=N,j=(e-d)/(g-f),k=[];return h.length>0&&h.forEach(function(a){b=a.start,c=a.end,k.push({start:j*(b-f)+d,end:j*(c-f)+d,color:a.color})}),k.unshift({start:d,end:e,color:i}),{paintRanges:k,fillColor:i,targetValueRadian:j*(a.targetValueOption.value-f)+d,currentValueRadian:j*(a.currentValueOption.value-f)+d,minValueRadian:d,maxValueRadian:e}}function Cb(a,b,c,d,e,f,g){var h,i,j,k,n,o,p,s=f.zoomFactor,t=a.currentValueOption.normalFontHeight*s,u=a.minValueOption.normalFontHeight*s,w=a.maxValueOption.normalFontHeight*s,x=a.minAngle,y=a.maxAngle,z=a.currentValueOption.normalFontWidth*s,A=v(x)>90||v(y)>90,B=v(x)>120||v(y)>120,C=la*q(d,e);return g?(h=m(d/2*ka),i=m(e*ka),j=A?i/2:i,k=q(h,j),o=(e-(A?2*k:k))/2,p=.03*k,n={x:b+d/2,y:c+e/2+(A?0:k/2),outerRadius:k,innerRadius:k*a.radiusRatio,currentValuePoint:l,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:u<o,enoughShowMaxLabel:w<o,moreThanSemiCircle:A},A?B?2*t/3<o-p-r(w,u)&&z<d-2*C&&(n.currentValuePoint={x:n.x,y:n.y+k+p+t/2+r(w,u)},n.enoughShowCurrentLabel=!0):2*t/3<e/2-p&&z<d-2*C&&(n.currentValuePoint={x:n.x,y:n.y+2*p+t},n.enoughShowCurrentLabel=!0):t<o-p&&z<d-2*C&&(n.currentValuePoint={x:n.x,y:n.y+t},n.enoughShowCurrentLabel=!0)):(h=m(d/2*ja),i=m(e*ja),j=A?i/2:i,k=q(h,j),n={x:b+d/2,y:c+e/2+(A?0:k/2),outerRadius:k,innerRadius:k*a.radiusRatio}),n}function Db(a,b,c,d){return{x:a+p(c)*d,y:b+o(c)*d}}function Eb(a,b){return v(b.x-a.x)<.01?{x:b.x,y:b.y,textAlign:Q}:b.x>a.x?{x:b.x+da,y:b.y,textAlign:O}:b.x<a.x?{x:b.x-da,y:b.y,textAlign:P}:{x:b.x,y:b.y,textAlign:O}}function Fb(a,b,c,d,e,f,h){var i,j,k,l,q,s,t,u,w,x,y,z,A,B,C,D,E,F,G,J,K,M,N,R,S,T,V,W,X,Y,aa,da,ea,fa,ha,ia=h.zoomFactor,ja=!!g(b.showLabel)||b.showLabel,ka=Cb(b,c,d,e,f,h,ja);if(!(ka.outerRadius<=0))return i={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},j=ka.innerRadius,k=ka.outerRadius,l=ka.currentValuePoint,q=ka.moreThanSemiCircle,s={x:ka.x,y:ka.y},t=Bb(b),u=t.paintRanges,w=t.fillColor,a.save(),u.forEach(function(b){a.beginPath(),a.strokeStyle=H,a.moveTo(s.x,s.y),a.fillStyle=b.color||w,a.arc(s.x,s.y,k,b.start,b.end,!1),a.lineTo(s.x,s.y),a.closePath(),a.fill(),a.stroke(),a.beginPath(),a.fillStyle=H,a.strokeStyle=H,a.moveTo(s.x,s.y),a.arc(s.x,s.y,j,b.start-ma,b.end+ma,!1),a.lineTo(s.x,s.y),a.closePath(),a.fill(),a.stroke()}),a.beginPath(),a.moveTo(s.x,s.y),a.fillStyle=I,a.arc(s.x,s.y,k*Z,0,2*n,!1),a.fill(),x=Db(s.x,s.y,t.targetValueRadian,j),y=Db(s.x,s.y,t.targetValueRadian,k*_),Da(a,x.x,x.y,y.x,y.y,ba,ca,L),z=Db(s.x,s.y,t.currentValueRadian,k*_),Ba(a,s.x,s.y,z.x,z.y,I,$*k),ja&&(a.save(),a.beginPath(),a.textAlign=U,a.fillStyle=L,A=b.minValueOption.normalFontHeight*ia,B=b.maxValueOption.normalFontHeight*ia,C=b.minValueOption.normalFontWidth*ia,D=b.maxValueOption.normalFontWidth*ia,E=t.minValueRadian,F=t.maxValueRadian,G=b.currentValueOption.normalFontHeight*ia,J=b.currentValueOption.normalFontWidth*ia,K=void 0,M=void 0,N=void 0,ka.enoughShowCurrentLabel&&(Fa(a,l.x,l.y,b.currentValueOption.label,b.currentValueOption.fontAfterZoom,Q),i.showCurrentLabel=!0,K={x:l.x-J/2,y:l.y-G,width:J,height:G}),ka.enoughShowMinLabel&&v(p(E)*k)+C<e/2-ga&&(R=Db(s.x,s.y,t.minValueRadian,k),S=Eb(s,R),M={x:S.x-C,y:S.y,width:C,height:A},Oa(M,K)||(Fa(a,S.x,S.y+m(A),b.minValueOption.label,b.minValueOption.fontAfterZoom,P),i.showMinLabel=!0)),ka.enoughShowMaxLabel&&v(p(F)*k)+D<e/2-ga&&(T=Db(s.x,s.y,t.maxValueRadian,k),V=Eb(s,T),N={x:V.x,y:V.y,width:D,height:B},Oa(N,K)||(Fa(a,V.x,V.y+m(B),b.maxValueOption.label,b.maxValueOption.fontAfterZoom,O),i.showMaxLabel=!0)),ka.enoughShowTargetLabel&&(W=b.targetValueOption.normalFontWidth*ia,X=b.targetValueOption.normalFontHeight*ia,Y=b.targetValueOption.label,aa=k+3*X/2,y=Db(s.x,s.y,t.targetValueRadian,aa),da=Eb(s,y),ea=t.targetValueRadian,fa=q?(f-2*aa)/2+aa:f-(f-k)/2,v(p(ea)*aa)+W<e/2-ga&&v(o(ea)*aa)+X/2+ga/2<fa&&(ha=r(A,B)/2,Fa(a,da.x,da.y-(ea>n?ha:-ha),Y,b.targetValueOption.fontAfterZoom,da.textAlign),i.showTargetLabel=!0)),a.restore()),a.restore(),i}b.fNc=Fb;function Gb(a,b,c,d,e,f){var g=f.zoomFactor,h=a.showLabel,i=a.minValueOption.normalFontHeight*g,j=a.maxValueOption.normalFontHeight*g,k=a.targetValueOption.normalFontHeight*g,n=a.currentValueOption.normalFontHeight*g,o=a.minValueOption.normalFontWidth*g,p=a.maxValueOption.normalFontWidth*g,q=a.targetValueOption.normalFontWidth*g,s=a.currentValueOption.normalFontWidth*g,t=.05*d,u=m(e*ha),v=m(d*ia),w={x:b+d*(1-ia)/2,y:c+e*(ha+(1-ha)/2),graphWidth:v,graphHeight:u,targetValuePoint:l,currentValuePoint:l,minValuePoint:l,maxValuePoint:l};return h&&(i<(e-u)/2&&o<(d-v)/2-t&&(w.minValuePoint={x:w.x-o,y:w.y+i/3},w.enoughShowMinLabel=!0),j<(e-u)/2&&p<(d-v)/2-t&&(w.maxValuePoint={x:w.x-p,y:w.y-u+j/3},w.enoughShowMaxLabel=!0),(k<(e-u)/2||k/2<u)&&q<(d-v)/2-t-r(o,p)&&(w.targetValuePoint={x:w.x-q-r(o,p),y:l},w.enoughShowTargetLabel=!0),(n<(e-u)/2||n/2<u)&&s<(d-v)/2-t&&(w.currentValuePoint={x:w.x+v+t,y:l},w.enoughShowCurrentLabel=!0)),w}function Hb(a,b){var c,d,e=a.minValueOption.value,f=a.maxValueOption.value,g=a.ranges,h=N,i=b.graphHeight/(f-e),j=[];return g.length>0&&g.forEach(function(a){c=a.start,d=a.end,j.push({start:b.y-i*(c-e),height:i*(d-c),color:a.color})}),j.unshift({start:b.y,height:b.graphHeight,color:h}),{paintRanges:j,fillColor:h,targetValueY:b.y-i*(a.targetValueOption.value-e),currentValueY:b.y-i*(a.currentValueOption.value-e)}}function Ib(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=g.zoomFactor,u=b.showLabel,v=b.minValueOption,w=b.maxValueOption,x=b.currentValueOption,y=b.targetValueOption,z=Gb(b,c,d,e,f,g),A=z.graphWidth,B=z.graphHeight;if(!(A<=0||B<=0))return h={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},i=z.currentValuePoint,j=z.targetValuePoint,k=z.minValuePoint,l=z.maxValuePoint,m={x:z.x,y:z.y},n=Hb(b,z),o=n.paintRanges,p=x.normalFontHeight*t,q=y.normalFontHeight*t,r=n.targetValueY,s=n.currentValueY,a.save(),o.forEach(function(b){La(a,m.x,b.start,A,-b.height,b.color)}),Da(a,m.x-(_-1)*A,r,m.x+A,r,ba,ca,L),Ba(a,m.x,s,m.x+A*_,s,I,aa*B),u&&(a.save(),a.beginPath(),z.enoughShowMinLabel&&(Fa(a,k.x,k.y,v.label,v.fontAfterZoom,O,L),h.showMinLabel=!0),z.enoughShowMaxLabel&&(Fa(a,l.x,l.y,w.label,w.fontAfterZoom,O,L),h.showMaxLabel=!0),z.enoughShowTargetLabel&&!(r-d+q/2>f||r-d-fa<0)&&(Fa(a,j.x,n.targetValueY+y.normalFontHeight*t/3,y.label,y.fontAfterZoom,O,L),h.showTargetLabel=!0),z.enoughShowCurrentLabel&&!(s-d+p/2>f||s-d-fa<0)&&(Fa(a,i.x,n.currentValueY+x.normalFontHeight*t/3,x.label,x.fontAfterZoom,O,L),h.showCurrentLabel=!0),a.restore()),a.restore(),h}b.gNc=Ib;function Jb(a,b,c,d,e,f){var g=f.zoomFactor,h=a.showLabel,i=a.minValueOption.normalFontHeight*g,j=a.maxValueOption.normalFontHeight*g,k=a.targetValueOption.normalFontHeight*g,n=a.currentValueOption.normalFontHeight*g,o=a.minValueOption.normalFontWidth*g,p=a.maxValueOption.normalFontWidth*g,s=a.currentValueOption.normalFontWidth*g,t=a.targetValueOption.normalFontWidth*g,u=.1*q(d,e),v=m(e*ia),w=m(d*ha),x={x:b+d*(1-ha)/2,y:c+e*(1-ia)/2,graphWidth:w,graphHeight:v,targetValuePoint:l,currentValuePoint:l,minValuePoint:l,maxValuePoint:l};return h&&((s<3*(d-w)/4||s<w)&&n<(e-v)/2-ga&&(x.currentValuePoint={x:l,y:x.y-n/2},x.enoughShowCurrentLabel=!0),(t<3*(d-w)/4||t<w)&&k<(e-v)/2-r(i,j)&&(x.targetValuePoint={x:l,y:x.y+v+r(i,j)+k/4*3},x.enoughShowTargetLabel=!0),o<3*(d-w)/4&&i<(e-v)/2-u&&(x.minValuePoint={x:x.x-o/2,y:x.y+v+i},x.enoughShowMinLabel=!0),p<3*(d-w)/4&&j<(e-v)/2-u&&(x.maxValuePoint={x:x.x+w-p/2,y:x.y+v+j},x.enoughShowMaxLabel=!0)),x}function Kb(a,b){var c,d,e=a.minValueOption.value,f=a.maxValueOption.value,g=a.ranges,h=N,i=b.graphWidth/(f-e),j=[];return g.length>0&&g.forEach(function(a){c=a.start,d=a.end,j.push({start:b.x+i*(c-e),width:i*(d-c),color:a.color||h})}),j.unshift({start:b.x,width:b.graphWidth,color:h}),{paintRanges:j,fillColor:h,targetValueX:b.x+i*(a.targetValueOption.value-e),currentValueX:b.x+i*(a.currentValueOption.value-e)}}function Lb(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=g.zoomFactor,u=b.showLabel,v=b.minValueOption,w=b.maxValueOption,x=b.currentValueOption,y=b.targetValueOption,z=Jb(b,c,d,e,f,g),A=z.graphWidth,B=z.graphHeight;if(!(A<=0||B<=0))return h={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},i=z.currentValuePoint,j=z.targetValuePoint,k=z.minValuePoint,l=z.maxValuePoint,m={x:z.x,y:z.y},n=Kb(b,z),o=n.paintRanges,p=x.normalFontWidth*t,q=y.normalFontWidth*t,r=n.targetValueX,s=n.currentValueX,a.save(),o.forEach(function(b){La(a,b.start,m.y,b.width,B,b.color)}),Da(a,r,m.y,r,m.y+B*_,ba,ca,L),Ca(a,s,m.y+B-1,s,m.y-B*(_-1)-1,I,A*aa),u&&(a.save(),z.enoughShowMinLabel&&(Fa(a,k.x,k.y,v.label,v.fontAfterZoom,O,L),h.showMinLabel=!0),z.enoughShowMaxLabel&&(Fa(a,l.x,l.y,w.label,w.fontAfterZoom,O,L),h.showMaxLabel=!0),z.enoughShowTargetLabel&&!(r-c+q/2+ea>e||r-c-q/2-ea<0)&&(Fa(a,r-y.normalFontWidth*t/2,j.y,y.label,y.fontAfterZoom,O,L),h.showTargetLabel=!0),z.enoughShowCurrentLabel&&!(s-c+p/2+ea>e||s-c-p/2-ea<0)&&(Fa(a,s-x.normalFontWidth*t/2,i.y,x.label,x.fontAfterZoom,O,L),h.showCurrentLabel=!0),a.restore()),a.restore(),h}b.hNc=Lb;function Mb(a,b,c,d,e,f,g){a.save(),a.rect(c,d,e,f),a.clip(),0===b.gaugeType?Fb(a,b,c,d,e,f,g):1===b.gaugeType?Ib(a,b,c,d,e,f,g):2===b.gaugeType&&Lb(a,b,c,d,e,f,g),a.restore()}function Nb(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o=[],p=a.length,q=0,r=g.fontPixelSize;if(f&&(q=r+3),0===p)return o;for(i=d/p,j=a[0].value,k=1;k<p;k++)j=Math.max(j,a[k].value);for(l=0;l<p;l++)m=c+e-q,n=a[l].value/j*(e-q),n<0&&(n=0),o.push({x:b+l*i+i*(1-h)/2,textX:b+l*i,y:m-n,width:i*h,textWidth:i,height:n,axis:a[l].axis});return o}function Ob(a,b,c,d){a.save(),a.fillStyle=c;for(var e=0;e<b.length;e++)a.fillRect(b[e].x,b[e].y,b[e].width,b[e].height);a.restore()}function Pb(a,b,c,d){var e,f,g,h,i;for(a.save(),e=c.fontPixelSize,f=Tb(c),a.textAlign="center",a.fillStyle=d,g=0;g<b.length;g++)h=void 0,i=void 0,h=b[g].x+b[g].width/2,i=b[g].y+b[g].height+5+e,a.save(),a.font=f,a.beginPath(),a.rect(b[g].textX,b[g].y+b[g].height+1,b[g].textWidth,e+3),a.clip(),a.textBaseline="bottom",a.fillText(b[g].axis,h,i),a.restore();a.restore()}function Qb(a,b,c,d){if("none"!==d){a.save(),a.lineWidth=1,a.strokeStyle=d,a.beginPath();for(var e=0;e<b.length;e++)Ba(a,b[e].x,b[e].y,b[e].x+b[e].width,b[e].y),Ba(a,b[e].x,b[e].y+b[e].height,b[e].x+b[e].width,b[e].y+b[e].height),b[e-1]&&b[e-1].height>=b[e].height&&1===c||Ba(a,b[e].x,b[e].y,b[e].x,b[e].y+b[e].height),b[e+1]&&b[e+1].height>b[e].height&&1===c||Ba(a,b[e].x+b[e].width,b[e].y,b[e].x+b[e].width,b[e].y+b[e].height);a.stroke(),a.closePath(),a.restore()}}function Rb(a,b,c,d,e){var f,g,h=!1;return a.save(),a.font=e,f=b.length,g=(c-6)/f,b.forEach(function(b,c){if(a.measureText(b.axis).width>g)return void(h=!0)}),a.restore(),h}function Sb(a,b,c,d,e,f,h){var i,j,k,l=b.barColor,m=b.values,n=b.paintLabel,o=b.barWidth,p=b.labelFontStyle,q=b.afterZoomFontStyle,r=b.edgeColor,s=b.labelColor;g(p)||(i=q.fontPixelSize,(f<3*i||Rb(a,m,e,f,Tb(q)))&&(n=!1)),n&&g(p)&&(j=Math.floor(f/3>=12?12:Math.floor(f/3)),q.fontPixelSize=j,q.fontSize=j+"px",Rb(a,m,e,f,Tb(q))&&(n=!1)),k=Nb(m,c+3,d+3,e-6,f-6,n,q,o),Ob(a,k,l,r),Qb(a,k,o,r),n&&Pb(a,k,q,s)}function Tb(a){return a.fontStyle+" "+a.fontWeight+" "+a.fontSize+" "+a.fontFamily}function Ub(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;a.save(),a.rect(c,d,e,f),a.clip(),h=b.clipX,i=b.clipY,j=b.clipWidth,k=b.clipHeight,l=b.paintX,m=b.paintY,n=b.paintWidth,o=b.paintHeight,p=b.img,j>0&&k>0&&n>0&&o>0&&a.drawImage(p,h,i,j,k,l,m,n,o),a.restore()}va=function(){function a(a,b,c,d){this.X=a,this.Y=b,this.Width=c,this.Height=d,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height}return a}(),wa=function(){function a(){this.Wd=2,this.Xd=C,this.Yd=C,this.Zd=B,this.$d=-B}return a.prototype.paint=function(a,b,c,d,e,f){var g,h,i,j=this;j.options=b,j.setting=b.settings,g=b.values,h=b.dateValues,i=b.zoomFactor,a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),0===b.sparklineType&&j._d(a,c,d,e,f,g,h,i),j.ae(a,c,d,e,f,g,h,i),j.be(a,c,d,e,f,g,h,i),a.restore()},a.prototype.ce=function(a){return 0===this.options.sparklineType?3+this.de(a)+1:3},a.prototype.ee=function(a,c){var d,e,g,h,i,m,n,o,p,r=this.fe;if(r)return r;if(r=this.fe=[],d=a.length,this.options.displayDateAxis){for(h=c.length,i=q(d,h),m=[],i>0&&(m=c.slice(0,i)),m.sort(function(a,c){return a===c?0:(a===b.Vd&&(a=0),c===b.Vd&&(c=0),a-c)}),n=m.length,o=void 0,p=void 0,e=0;e<n;e++)if(o=m[e],typeof o!==x&&o!==k){for(p=j(c,o);f.k.Bb(r,p);)p=j(c,o,p+1);isNaN(o)||(g=a[p],g!==l&&g!==k&&isNaN(g)&&g!==b.Vd||r.push(p))}}else for(e=0;e<d;e++)g=a[e],typeof g!==x&&g!==k&&isNaN(g)&&g!==b.Vd||r.push(e);return r},a.prototype.ge=function(a,c){var d=c[a];return typeof d===x||d===k?1===this.setting.options.displayEmptyCellsAs&&(d=0):d===b.Vd&&(d=0),d},a.prototype._d=function(a,b,c,d,e,f,g,h){var i,j,l,m,n,o,p,q,r,s,t,u,v,w,y,z=this,A=z.ee(f,g),B=A.length-1;for(B<0&&(B=0),m=z.setting.options,n=z.linePos=[],t=m.displayEmptyCellsAs,i=0;i<B;i++)if(o=z.ge(A[i],f),typeof o!==x&&o!==k){if(q=i+1,p=z.ge(A[q],f),typeof p===x||p===k)if(1===t)p=0;else if(2===t)for(q=i+2;q<=B;q++)if(u=f[A[q]],typeof u!==x&&u!==k){p=u;break}typeof p!==x&&p!==k?(r=z.he(A[i],{Width:d,Height:e},f,g,h),s=z.he(A[q],{Width:d,Height:e},f,g,h),v=r.Width/2,j={X:r.X+v,Y:r.Y+v},l={X:s.X+v,Y:s.Y+v},n[i]={P1:j,P2:l}):i++}if(w=n.length,w>0)for(a.strokeStyle=z.options.getColor(m.seriesColor),a.lineCap="round",a.lineWidth=z.de(h),i=0;i<w;i++)y=n[i],y&&(a.beginPath(),j=y.P1,l=y.P2,a.moveTo(b+j.X,c+j.Y),a.lineTo(b+l.X,c+l.Y),a.stroke(),a.closePath())},a.prototype.ie=function(a,b,c){var d,e,f,g=this,h=g.options,i=g.setting.options,m=k,n=g.ge(a,b),o=g.ee(b,c),p=o.length,q=h.getColor.bind(g);return typeof n!==x&&n!==k&&(g.Zd!==B&&g.$d!==-B||g.je(b),n===g.Zd&&i.showLow&&(m=q(i.lowMarkerColor)),n!==g.$d||!i.showHigh||typeof m!==x&&m!==k||(m=q(i.highMarkerColor)),typeof m!==x&&m!==k||(h.displayDateAxis?(d=j(o,a),0===d&&i.showFirst&&(m=q(i.firstMarkerColor))):0===a&&i.showFirst&&(m=q(i.firstMarkerColor))),typeof m!==x&&m!==k||(h.displayDateAxis?(e=j(o,a),e===p-1&&i.showLast&&(m=q(i.lastMarkerColor))):a===p-1&&i.showLast&&(m=q(i.lastMarkerColor))),n<0&&i.showNegative&&(typeof m===x||m===k)&&(m=q(i.negativeColor)),typeof m!==x&&m!==k||(f=h.sparklineType,0===f?i.showMarkers&&(m=q(i.markersColor)):1===f?m=q(i.seriesColor):2===f&&(m=q(i.seriesColor)))),m===l||m===k?"Transparent":m},a.prototype.ae=function(a,b,c,d,e,f,g,h){var i,j,k,l,o,p,q,r,s,t,u=this,v={Width:d,Height:e},w=u.ee(f,g),x=w.length,y=u.options.sparklineType;for(t=0;t<x;t++)i=w[t],j=u.ie(i,f,g),k=u.he(i,v,f,g,h),a.fillStyle!==j&&(a.fillStyle=j),0===y?(a.save(),l=b+k.X+k.Width/2,o=c+k.Y+k.Height/2,a.translate(l,o),a.rotate(45*n/180),a.fillRect(0-k.Width/2,0-k.Height/2,k.Width,k.Height),a.restore()):(p=b+k.X+k.Width/4,p=m(p),q=c+k.Y,r=k.Width/2,s=k.Height,a.fillRect(p,q,r,s))},a.prototype.be=function(a,b,c,d,e,f,g,h){var i,j,k,l,n,o,p,q=this,r=q.setting&&q.setting.options;r&&r.displayXAxis&&q.ke(f,g)&&(i={Width:d,Height:e},j=q.ce(h),k=i.Width-q.ce(h),l=m(q.le(i,f,h))+.5,n=l,o=q.options.getColor(r.axisColor),p=h,p<1&&(p=1),a.strokeStyle!==o&&(a.strokeStyle=o),a.lineWidth!==p&&(a.lineWidth=p),a.beginPath(),a.moveTo(b+j,c+l),a.lineTo(b+k,c+n),a.stroke())},a.prototype.me=function(a){var b,c=this.ne(a);return c===-B||(b=this.oe(a),b===B)||(c===b||c*b<=0)},a.prototype.ke=function(a,b){var c,d,e,f,g,h=this.me(a);if(2!==this.options.sparklineType)return h;if(c=this.ee(a,b),d=c.length,!h&&d>0)for(g=0;g<d;g++)if(e=c[g],f=a[e],typeof f!==x&&f!==k)return!0;return h},a.prototype.pe=function(a,b){var c=this.Xd;return isNaN(c&&c.valueOf())&&this.qe(a,b),this.Xd},a.prototype.re=function(a,b){var c=this.Yd;return isNaN(c&&c.valueOf())&&this.qe(a,b),this.Yd},a.prototype.qe=function(a,b){var c,d,e,f,g=this,h=new Date(0,0,0),i=B,j=g.ee(a,b),l=j.length;for(f=0;f<l;f++)c=j[f],d=b[c],isNaN(d)||(e=g.ge(c,a),e!==k&&typeof e===x||isNaN(e)||typeof d!==x&&d!==k&&(d>h&&(h=d),d<i&&(i=d)));g.Yd=h,g.Xd=i},a.prototype.se=function(a,b,c,d){var e,f,g,h,i,j,k,l,m=this,n=m.pe(b,c),o=m.re(b,c),p=[],q=m.ee(b,c),r=q.length;for(e=0;e<r;e++)g=q[e],f=c[g],f&&!isNaN(f)&&p.push(f);if(p.sort(function(a,b){return a-b}),h=p.length,h>1&&n!==o){for(i=B,j=0,k=void 0,e=1;e<h;e++)k=p[e],f=k-p[e-1],f<i&&f>0&&(i=f),j+=f;return l=(a.Width-m.ce(d)-m.ce(d))*i/j/2,l<2&&(l=2),l}return(a.Width-m.ce(d)-m.ce(d))/2},a.prototype.te=function(a,b,c,d){var e,f=this;return f.options.displayDateAxis?f.se(a,b,c,d):(e=f.ee(b,c).length,(a.Width-f.ce(d)-f.ce(d))/e)},a.prototype.ue=function(a,b,c,d,e){var f,g,h,i,k,l,n,o,p=this,q=p.ce(e);return p.options.displayDateAxis?(f=p.te(a,c,d,e),g=p.re(c,d),h=p.pe(c,d),g===h?q+f/2:(i=d[b])?(k=a.Width-q-p.ce(e),k-=f,l=g.valueOf()-h.valueOf(),q+m((i.valueOf()-h.valueOf())/l*k)):0):(f=p.te(a,c,d,e),n=j(p.ee(c,d),b),o=q+f*n,m(o))},a.prototype.ve=function(a,b){var c,d=this,e=a.Width-d.ce(b)-d.ce(b);return e=r(e,0),c=a.Height-d.ce(b)-d.ce(b),c=r(c,0),{Width:e,Height:c}},a.prototype.je=function(a){var b,c,d=this,e=a.length;for(c=0;c<e;c++)b=a[c],typeof b!==x&&b!==k&&("number"!=typeof b&&(b=0),b<d.Zd&&(d.Zd=b),b>d.$d&&(d.$d=b))},a.prototype.ne=function(a){var b,c,d=this;return d.$d!==-B&&d.$d||d.je(a),b=d.setting.options,c=b.maxAxisType,0===c?d.$d:1===c?b.groupMaxValue:2===c?b.manualMax:d.$d;
},a.prototype.oe=function(a){var b,c,d=this;return d.Zd!==B&&d.Zd||d.je(a),b=d.setting.options,c=b.minAxisType,0===c?d.Zd:1===c?b.groupMinValue:2===c?b.manualMin:void 0},a.prototype.we=function(a,b,c,d){var e=this.ve(a,d),f=this.ne(c),g=this.oe(c),h=f-g,i,j;if(f===g){if(0===f)return 0;h=v(f)}return i=c[b],i||(i=0),j=e.Height/h,i*j},a.prototype.xe=function(a,b,c,d){var e,f,g,h=this,i=h.options.sparklineType;if(0===i)return h.we(a,b,c,d);if(1===i){if(e=c[b],1===h.setting.options.displayEmptyCellsAs&&(typeof e===x||e===k))return 0;if(f=h.we(a,b,c,d),f>-h.Wd&&f<h.Wd){if(e>0)return f+h.Wd;if(e<0)return f-h.Wd}return f}return 2===i?(e=c[b],typeof e===x||e===k||0===e||isNaN(e)?0:(g=h.ve(a,d),e>=0?g.Height/2:-g.Height/2)):void 0},a.prototype.ye=function(a,b,c){var d,e,f=this,g=f.ve(a,c),h=f.ne(b),i=f.oe(b);if(h===-B||i===B)return a.Height/2;if(d=h-i,h===i){if(0===h)return a.Height/2;d=h,h<0&&(h=0)}return e=g.Height/d,f.ce(c)+h*e},a.prototype.le=function(a,b,c){return 2===this.options.sparklineType?a.Height/2:this.ye(a,b,c)},a.prototype.ze=function(a,b,c,d){var e,f,g,h=this,i=h.ve(a,d),j=h.ne(c),l=h.oe(c),m=j-l;if(j===l){if(0===j)return 0;m=j}return e=i.Height/m,f=h.ge(b,c),typeof f!==x&&f!==k||(f=0),j!==l&&j*l>0?(g=0,g=f>=0?(f-l)*e:(f-j)*e):f*e},a.prototype.Ae=function(a,b,c,d){var e,f,g,h=this,i=h.options.sparklineType;return 0===i?h.ze(a,b,c,d):1===i?(e=h.ze(a,b,c,d),f=h.Wd,e>-f&&e<f&&(g=h.ge(b,c),typeof g!==x&&g!==k||(g=0),0!==g)?g>0?e+f:e-f:e):2===i?h.xe(a,b,c,d):void 0},a.prototype.Be=function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p=this,q=p.te(b,c,d,e),s=p.ue(b,a,c,d,e);return q<0&&(q=0),q=m(q),q%2===1&&(q+=1),f=p.xe(b,a,c,e),g=p.le(b,c,e),h=p.ne(c),i=p.oe(c),j=0,h<0&&i<0?j=r(p.ce(e),g):(j=g,f>=0&&(j=g-f)),k=p.Ae(b,a,c,e),l=new va(s,j,q,v(k)),0!==f&&(n=p.ce(e),l.Y<n&&l.Bottom<n+1?l.Height=m(l.Height+1):(o=b.Height-p.ce(e),l.Bottom>o&&l.Y>o-1&&(l.Y=o-k,l.Height=k))),l},a.prototype.de=function(a){var b=this.setting.options.lineWeight*a;return b<1&&(b=1),b},a.prototype.he=function(a,b,c,d,e){var f,g,h,i,j,l=this,m=l.de(e);return m++,m<2&&(m=2),f=l.Be(a,b,c,d,e),0===l.options.sparklineType&&(f.X=f.X+(f.Width-m)/2,g=l.ge(a,c),typeof g!==x&&g!==k?(g>=0?f.Y-=m/2:f.Y=f.Bottom-m/2,f.Width=m,f.Height=m):(f.Width=0,f.Height=0)),l.setting.options.rightToLeft&&(h=f.X,i=b.Width-h,j=i-f.Width,f=new va(j,f.Y,f.Width,f.Height)),f},a}(),b.SparklineRender=wa,b.SparklineExRenders={PIESPARKLINE:Pa,AREASPARKLINE:Sa,SCATTERSPARKLINE:Ua,BULLETSPARKLINE:Za,SPREADSPARKLINE:$a,STACKEDSPARKLINE:cb,HBARSPARKLINE:ib,VBARSPARKLINE:jb,VARISPARKLINE:kb,BOXPLOTSPARKLINE:lb,CASCADESPARKLINE:qb,PARETOSPARKLINE:rb,MONTHSPARKLINE:yb,YEARSPARKLINE:Ab,GAUGEKPISPARKLINE:Mb,HISTOGRAMSPARKLINE:Sb,IMAGESPARKLINE:Ub}}}),a.exports=c.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")}});;/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./node_modules_local/@grapecity/js-calc/index.js")}({"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/calc.entry.ts")}({"./src/Parser.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=void 0,g=null,h="string",i="boolean",j="TRUE",k="FALSE",l="ARRAY",m=d.Common.u,n=d.Common.j,o=n.Fa,p="Exp_FormulaInvalidChar",q="Exp_FormulaInvalid",r="Exp_NoSyntax";function F(){throw e.sR()[q]}function G(a,b,c){throw m.Kb(e.sR()[c||p],[a,b])}b.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],s={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},t=".",u=",",v=";",w=",",x=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function H(a){return a<=255}function I(a){return a<=127}function J(a){return a===e.getBoolean().boolean_true||a===j}function K(a){return a===e.getBoolean().boolean_false||a===k}function L(a){return a>=48&&a<=57}b.isDigit=L;function M(a){var b=a.charCodeAt(0);return!H(b)||(I(b)?(b|=32,b>=96&&b<=122):0===x[b]||1===x[b])}b.ei=M;function N(a){var b=a.charCodeAt(0);return!H(b)||(I(b)?b<=57?b>=48:(b|=32,b>=96&&b<=122):0===x[b]||1===x[b])}b.fi=N;function O(a){var b=a.charCodeAt(0);return I(b)?b>=48&&b<=57:8===x[b]||10===x[b]}b.isNumber=O;function P(a,b,c,d,e,f){var g,h,i=a.length,j=c===d?0:1,k=[],l=0;for(g=b+1;g<i;g++)if(h=a[g],h===e&&(k.push(h),g++,l++,h=a[g]),h===c&&j++,h===d)if(j--,c===d&&g+2<i&&a[g+1]===c)k.push(c),g++,l++;else{if(0===j)return{result:k,endIndex:g,skipCount:l};k.push(h)}else k.push(h);f&&G(d,c,r)}function Q(a,b,c){var d,f,g,h,i=a.length,j=i-b;for(d=0;d<e.ErrorList.length;d++)if(f=e.ErrorList[d],g=f.length,b+g<=i&&(h=a.slice(b,b+g),g<=j&&f===h.join("").toUpperCase()))return{result:h,endIndex:b+g-1};c&&G([a[b],b])}function R(a,b,c){var d,e,f=a.length,g=0,h=[];for(d=b;d<f;d++)if(e=a[d],L(e.charCodeAt(0)))0===g?g=2:3===g?g=4:1===g?g=2:5!==g&&6!==g||(g=7),h.push(e);else if(e===c){if(2===g)g=4;else{if(0!==g&&1!==g)return{};g=3}h.push(".")}else if("+"===e||"-"===e){if(0===g)g=1;else{if(5!==g)return{num:h,endIndex:d-1};g=6}h.push(e)}else if("E"===e||"e"===e){if(2!==g&&4!==g)return{};g=5,h.push(e)}else if(2===g||4===g||7===g)return{num:h,endIndex:d-1};return 2===g||4===g||7===g?{num:h,endIndex:f-1}:{}}y=[].push;function S(a,b){return y.apply(a,b),a}z=function(){function a(a,b,c,d,e){var f,g,h;this.oi=[],e=e||0,f=this,f.Qb=a,g=Array.isArray(a)?a.join(""):a,f.Nc=b,f.mi=c,f.li=d||c+a.length-1,0===b&&0===e&&a&&(h=g.toUpperCase(),(J(h)||K(h))&&(e=5,g=h)),f.ni=g,f.hi=e}return a.prototype.type=function(){return this.Nc},a.prototype.subType=function(){return this.hi},a.prototype.stringValue=function(){return this.ni},a}(),b.FormulaToken=z,A=function(){function a(a){void 0===a&&(a=5e3),this.priority=a}return a.prototype.resolveToken=function(a,b,c,d,e){return 0},a.prototype.unparse=function(a,b,c,d){return!0},a}(),b.TokenResolver=A,b.preOperaterTypesMap={"+":0,"-":1},b.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14};function T(a){var b,c,d=[];if(a.indexOf(":")>-1)for(b=a.split(":"),c=0;c<b.length;c++)d.push("'"+b[c].replace(/'/g,"''")+"'");return d}B=function(){function a(){}return a.prototype.setParserOption=function(b){var c,e;b!==f&&d.Common.CultureManager.q4()?(e="object"==typeof b&&b.NumberFormat?b.NumberFormat:d.Common.CultureManager.q4().NumberFormat,c=b?e:{}):(c={},e=c),u=a.listSeparator=c.listSeparator||",",t=c.numberDecimalSeparator||".",!b&&a.numberDecimalSeparator||(a.numberGroupSeparator=e.numberGroupSeparator||",",a.numberDecimalSeparator=e.numberDecimalSeparator||"."),v=a.arrayGroupSeparator=c.arrayGroupSeparator||";",w=a.arrayListSeparator=c.arrayListSeparator||","},a.prototype.parse=function(a,b){var c,d;return b=e.o$c(b),this.setParserOption(a.culture),c=b.split(""),this.gi=c,d=this.parseToTokens(a,c,!a.ignoreError),this.buildExpressionTree(a,d,!a.ignoreError)},a.prototype.unparse=function(a,b,c){return void 0===c&&(c=[]),this.Cma(a,b,c),"@"===c[0]&&b&&b.arguments&&b.arguments[0]&&1===b.arguments[0].type&&a&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray!==!0&&c.splice(0,1),c.join("")},a.prototype.Cma=function(a,b,c){var d,e;if(b)for(this.setParserOption(a.culture),d=a.getResolvers(),e=0;e<d.length&&!d[e].unparse(a,this,b,c);e++);},a.prototype.parseToTokens=function(a,c,d){var e,f,g,h,i,j,k,m,n,o,p,q,r,s,x;for(void 0===d&&(d=!0),e=this,f=function(a,b,c){return b.length>0&&a.push(new z(b,0,c)),[]},g=c.length,h=[],i=[],j=-1,k=[],o=0;o<g&&" "===c[o];)o++;for("="===c[o]&&o++,n=o,r=function(o){var r,x,A,B,C,D,E,F,H,I,J=c[o],K=J.charCodeAt(0),M=void 0;if(64===K&&a.kj&&a.kj.Wu&&a.kj.Wu.allowDynamicArray===!0)m=new z(J,1,o),h.push(m),n=o+1;else if(K>=97&&K<=122||K>=65&&K<=90)k.push(J);else if(34===K)k.length>0&&(k=f(h,k,n)),M=P(c,o,'"','"',"",d),M?(r=new z(M.result,0,o,o+M.result.length+2,3),M.skipCount&&(r.HTa=c.slice(o,M.endIndex+1).join(""),r.li+=M.skipCount),h.push(r),o=M.endIndex,n=o+1):(S(k,c.slice(o,g)),o=g-1);else if(39===K)M=P(c,o,"'","'","",d),M?(x=T(M.result.join("")),A=[],x.length>1&&(B=x.join(":").split(""),A=e.parseToTokens(a,B,d)),A&&A.length>0?(A.forEach(function(a){a.mi+=o,a.li+=o}),S(h,A)):(k.push("'"),S(k,M.result),k.push("'")),o=M.endIndex):(k.push("'"),o=g-1);else if(91===K)if(M=P(c,o,"[","]","'",d))k.push("["),S(k,M.result),k.push("]"),o=M.endIndex;else{if(e.lda&&0===k.length&&("R"===k[0]||"r"===k[0]||"C"===k[0]||"c"===k[0]))return s=o,"continue";S(k,c.slice(o,g)),o=g-1}else{if(13===K||10===K)return s=o,"continue";if(35===K)C=Q(c,o),C?(h.push(new z(C.result,0,o,o+C.result.length-1,6)),n=o+1,o=C.endIndex):(k=f(h,k,n),h.push(new z(c[o],6,o,o)),n=o+1);else if(33===K)0===k.length,D=h.length,D>0&&0===h[D-1].Nc?(E=h[D-1],y.apply(E.Qb,k),h[D-1]=new z(E.Qb,0,E.mi,o,12)):h.push(new z(k,0,n,o,12)),k=[],n=o+1;else if(43===K||45===K)F=0===h.length?null:h[h.length-1],0!==k.length?(h.push(new z(k,0,n)),h.push(new z(J,5,o)),k=[],n=o+1):(F&&7===F.Nc&&h.pop(),!F||2!==F.hi&&6!==F.Nc&&0!==F.Nc?(h.push(new z(J,4,o)),n=o+1):(h.push(new z(J,5,o)),n=o+1));else if(J===t||L(K))k.length>0?k.push(J):(H=R(c,o,t),H.num?(p=H.endIndex,I=H.num,p<=g-2&&"!"===c[p+1]?(S(k,I),n=p):(h.push(new z(I,0,o,p,4)),n=p+1),o=p):k.push(J));else if(123===K)k.length>0&&(d?G(J,o):k=f(h,k,n)),m=new z(l,1,o,o,1),h.push(m),i[++j]=m,n=o+1;else if(J===v&&j>=0&&i[j].value===l)k=f(h,k,n),j<0&&d&&G(J,o),h.push(new z(v,3,o,o)),n=o+1;else if(125===K)k=f(h,k,n),p<0&&d&&G(J,o),q=i[j--],q=new z(J,q.Nc,o,o,2),h.push(q),n=o+1;else if(32===K)k=f(h,k,n),n=o+1;else if(J===u||J===w||J===v)k=f(h,k,n),j<0||1!==i[j].Nc?h.push(new z(u,5,o,o,10)):h.push(new z(J,3,o,o)),n=o+1;else if(37===K)k=f(h,k,n),h.push(new z(c[o],6,o,o)),n=o+1;else if(o+2<=g&&b.operaterTypesMap[J+c[o+1]])k=f(h,k,n),h.push(new z(c.slice(o,o+2),5,o,o+1,5)),o++,n=o+1;else if(b.operaterTypesMap[J])k=f(h,k,n),h.push(new z(J,5,o,o)),n=o+1;else if("("===J)k.length>0?(m=new z(k,1,n,o,1),k=[]):m=new z(J,2,o,o,1),h.push(m),i[++j]=m,n=o+1;else if(")"===J){if(k=f(h,k,n),j<0)return d&&G(J,o),f(h,J,o),n=o+1,s=o,"continue";q=i[j--],q=new z(J,q.Nc,o,o,2),h.push(q),n=o+1}else if(":"===J)k=f(h,k,n),h.push(new z(J,5,o,o,11)),n=o+1;else if("\r"===J||"\n"===J);else{if("\\"===J){if(o++,o>=g)return d&&G(J,o),s=o,"continue";k.push(J),J=c[o]}k.push(J)}}s=o},x=o;x<g;x++)r(x),x=s;return f(h,k,n),h},a.prototype.buildExpressionTree=function(a,b,c){var d,f,g,h;return this.p$c(b),d=this.ii(a,b,c),f=this.ji(a,d,c),c&&(f||F(),this.rSa(f)),this.q$c(f,new e.LocalScopes,!1,!1,a,c),g=a.source,h=g&&g.q$a,!h&&f&&(f.ehc=!0),f},a.prototype.rSa=function(a){for(var b,c,d,f,g,h;10===a.type;)a=a.value;if(b=this,9===a.type)a.value||F(),b.rSa(a.value),a.value2&&b.rSa(a.value2);else if(7===a.type)if(c=a.arguments,d=c.length,f=a.function,e.isExpression(f))this.rSa(f);else for(f&&f.gEc(f.minArgs,f.maxArgs,d,c),g=0;g<d;g++)h=c[g],f?f.hEc(h,g):e.iEc(h,g),b.rSa(h)},a.prototype.ji=function(a,b,c){var d,f,g,h,i,j,k=this.ki(a,b,c);for(h=3;h<k.length;)if(i=k[h],j=k[h-2],9!==j.type&&c&&F(),i&&9===i.type){for(;h>=3&&s[i.value]>=s[j.value];)f=k[h-3],g=k[h-1],d=e.Kh(j.operatorType,f,g),k.splice(h-3,3,d),h-=2,h>=3&&(j=k[h-2]);h+=2}else h++;if(1===k.length)return k[0];for(h=k.length-2;h>0;h-=2)f=k[h-1],g=k[h+1],9!==k[h].type&&c&&F(),d=e.Kh(k[h].operatorType,f,g),k.splice(h-1,3,d);return d},a.prototype.r$c=function(a,b,c){var d,f,g,h,i,j;if(!a||a.length<=0)return a;for(d=a,f=0,g=[],h=[],i=0;i<=d.length;i++)j=d[i],i===d.length||c(j)?(f===i?g.push(new e.Expression(11)):g.push(this.ji(b,h)),f=i+1,h=[]):h.push(j);return g},a.prototype.ki=function(a,b,c){var d,g,h,i,j,k,l,m,n,o,p,q;for(b=Array.isArray(b)?b:[b],d=[],g=b.length,h=0;h<g;h++){if(i=b[h],j=i,10===i.type){if(k=d.length>0?d[d.length-1]:f,k&&7===k.type){l=this.r$c(i.value,a,function(a){return a.value===u}),d[d.length-1]=e.s$c(k,l);continue}i.value=this.ji(a,i.value),j=i}else 7===i.type&&(m=function(a){return 0===a.type&&a.value===u},i.arguments=this.r$c(i.arguments,a,m));d.push(j)}for(b=d,d=[],g=b.length,h=0;h<g;h++){if(i=b[h],j=i,9===i.type)if(0===i.operatorType||1===i.operatorType)if(h===g-1)c&&F();else{for(n=h;9===b[n].type&&b[n].operatorType<=1;)n++;for(o=b[n],p=n-1;p>=h;p--)j=e.Kh(b[p].operatorType,o),o=j;j=o,h=n}else if(2===i.operatorType){if(0!==h){j=e.Kh(i.operatorType,d[d.length-1]),d[d.length-1]=j;continue}c&&F()}else if("#"===i.value){if(0!==h){if(b[h+1]&&8===b[h+1].type&&8===d[d.length-1].type){d[d.length-1].value+="#"+b[h+1].value,h++;continue}q=a.getFunction("ANCHORARRAY"),j=e.Jh(q,[d[d.length-1]]),d[d.length-1]=j;continue}c&&F()}d.push(j)}return d},a.prototype.ii=function(a,b,c){var d,e,f=[];for(d=0,e=b.length;d<e;)d=this.resolveToken(a,b,f,d,c);return f},a.prototype.addDynamicCell=function(a){var b,c=a.source&&a.source.getCalcService&&a.source.getCalcService();c&&(c.m7c||(c.m7c={}),b=a.source.id+","+a.row+","+a.column,c.m7c[b]={id:a.source.id,row:a.row,col:a.column})},a.prototype.resolveToken=function(a,b,c,d,h){var i,j,k,l,m,n,o=b[d],p=a.getResolvers();for(i=0;i<p.length;i++)if(j=p[i].resolveToken(a,this,b,d,h)){k=j.expr,l=d-1,k&&j.index!==f?d=j.index-1:k=j,m=c.length>0?c[c.length-1]:g,m&&0!==k.type&&7!==k.type&&k.type<9&&0!==m.type&&7!==m.type&&m.type<9&&(n=b[l].li,n<o.mi-1&&c.push(e.Kh(17," "))),(15===k.operatorType||16===k.operatorType||k.function&&k.function.haveDynamicListener)&&this.addDynamicCell(a),c.push(k);break}return d+1},a.prototype.resolveSubTokens=function(a,b,c,d,e){for(var f=[];c<b.length&&2!==b[c].hi;)if(c=this.resolveToken(a,b,f,c,d),e){c--;break}return{exprs:f,index:c+1}},a.prototype.p$c=function(a){a.forEach(function(a){1===a.Nc&&a.ni!==l&&(a.ni=a.ni.toUpperCase())})},a.prototype.q$c=function(a,b,c,d,f,g){var h,i,j,k,l,m;if(a)if(Array.isArray(a))for(h=0;h<a.length;h++)this.q$c(a[h],b,c,d,f,g);else if(8===a.type)b.hasVariable(a.value)&&(a.type=100,a.t0a=c,a.t$c=d,a.value=b.getVariable(a.value),g||(a.value=a.value.replace(/\./g,"_")));else if(7===a.type){if(i=a.functionName,j=a.function,k=a.arguments,"LET"===i){for(b.enterScope(),l=k.length-1,h=0;h<l;h+=2){if(m=k[h],8!==m.type)return;this.q$c(k[h+1],b,c,d,f,g),b.setVariable(m.value,m.value),this.q$c(m,b,c,d,f,g)}this.q$c(k[l],b,c,d,f,g),b.exitScope()}else if("LAMBDA"===i){for(b.enterScope(),l=k.length-1,h=0;h<l;h++){if(m=k[h],8!==m.type)return;b.setVariable(m.value,m.value),this.q$c(m,b,c,d,f,g)}this.q$c(k[l],b,c,d,f,g),b.exitScope()}else for(h=0;h<k.length;h++)c=e.getFunctionAcceptsArray(j,h),d=e.getFunctionAcceptsReference(j,h),this.q$c(k[h],b,c,d,f,g);e.isExpression(j)&&this.q$c(j,b,c,d,f,g),i&&b.hasVariable(i)&&(a.isLocalFunctionName=!0,a.functionName=b.getVariable(i))}else 9===a.type?(c=d=a.operatorType>=15,this.q$c(a.value,b,c,d,f,g),this.q$c(a.value2,b,c,d,f,g)):(this.q$c(a.value,b,c,d,f,g),this.q$c(a.value2,b,c,d,f,g))},a}(),b.Parser=B,C=function(){function a(a,b,c,d){this.Eh=!1,this.ignoreError=!1;var e=this;e.useR1C1=b,e.baseIdentity=c,e.option=d,e.source=a}return a.prototype.getExternalSource=function(a,b){var c,d=this.source.getCalcService(),e=d.getAllSourceModels();for(c=0;c<e.length;c++)if(m.Mb(e[c].getSource().getName(),b))return e[c].getSource();return g},a.prototype.getExternalSourceToken=function(a){return a.getName()},a.prototype.setSource=function(a){this.source=a},a.prototype.getResolvers=function(){var a=(this.source||this.kj).getCalcService();return a&&a.getResolvers()},a.prototype.addResolver=function(a){var b=(this.source||this.kj).getCalcService();b&&b.addResolver(a)},a.prototype.getFunction=function(a){var b,c=a,d=e.getMapping()&&e.getMapping().builtInFunctionsMapping;if(!o(d))for(b in d)d[b].alias===a&&(c=b);return this.source&&this.source.getCustomFunction(c)||e.Functions.findGlobalFunction(a)},a}(),b.ParserContext=C,e.CalcSource.prototype.getParserContext=function(a,b,c){return new C(this,a,b,c)};function U(a,b,c){var d,e;if(!b||0===b.length||V(a,b)||V(a,c))return[];if(d=b,c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function V(a,b){if(!b||0===b.length||!a.Eh)return!1;var c="'"===b[0]?1:0;return"["===b[c]&&b.indexOf("]")>c}D=function(a){E(c,a);function c(){return null!==a&&a.apply(this,arguments)||this}return c.prototype.resolveToken=function(a,c,d,g,h){var i,j,k,n,o,p,q,r,s,t,u=d[g],w=u.ni,x=u.Qb,y=u.Nc,z=null,A=u.hi,B=a.source&&a.source.Af&&a.source.Af.allowDynamicArray;if(0===y&&12===A){if(o=void 0,w&&(o=w,"'"===o.charAt(0)&&(o=o.substring(1,o.length-1))),g++,o&&(z=a.getExternalSource("",o)),u=d[g],!u)return i=new e.Expression(8),i.value=w,i;w=u.ni}if(0===y)0===u.hi?(k=w.toUpperCase(),J(k)||K(k)?(u.hi=5,u.ni=k,i=new e.Expression(4),i.value=J(k)):(i=new e.Expression(8),i.value=w)):4===u.hi?(i=new e.Expression(2),i.value=parseFloat(w),i.originalValue=w):3===u.hi?(i=new e.Expression(3),i.value=w):5===u.hi?(i=new e.Expression(4),i.value=J(w)):6===u.hi?(i=new e.Expression(5),i.value=e.CalcError.parse(w)):7===u.hi&&(i=new e.Expression(8),i.value=w);else if(1===y){if(w===l){for(i=new e.Expression(6),g++,k=[[]],j=0,p=0,q=0;g<d.length&&2!==d[g].hi;){if(u=d[g],g<d.length-1&&4===u.Nc&&"-"===u.ni&&4===d[g+1].hi&&(g++,u=d[g],u.Qb.unshift("-"),u.ni="-"+u.ni),3===u.Nc){if(u.ni===v){if(p!==q)throw m.Kb(e.sR().Exp_InvalidArrayColumns,[u.mi]);k.push([]),j++,q=0}}else{if(0!==u.Nc||4!==u.hi&&3!==u.hi&&5!==u.hi&&6!==u.hi)throw e.sR().Exp_InvalidArray;r=u.ni,s=r,4===u.hi?s=parseFloat(r):5===u.hi?s="TRUE"===r.toUpperCase():6===u.hi&&(s=e.CalcError.parse(r)),k[j].push(s),0===j&&p++,q++}g++}if(p!==q)throw m.Kb(e.sR().Exp_InvalidArrayColumns,[u.mi]);return g++,i.value=new e.CalcArray(k),{expr:i,index:g}}if(x.length>0)return"@"!==x[0]||B||(u.ni=x.slice(1).join(""),w=u.ni),i=new e.Expression(7),i.functionName=w,t=a.getFunction(i.functionName)||e.Functions.findGlobalFunction(i.functionName),B===!1&&t&&t.isDynamicArrayFunction===!0&&(t=f),i.function=t,(n=c.resolveSubTokens(a,d,g+1,void 0,"@"===x[0]&&B))?(i.arguments=n.exprs,{expr:i,index:n.index}):(i.arguments=[],i)}else if(4===y||6===y||5===y)i=e.Kh(4===y?b.preOperaterTypesMap[w]:b.operaterTypesMap[w],w);else if(2===y){if(i=new e.Expression(10),n=c.resolveSubTokens(a,d,g+1))return i.value=n.exprs,{expr:i,index:n.index};h&&F()}else 3===y&&(i=new e.Expression(0),i.value=w);return z&&i&&(i.source=z,i={expr:i,index:g+1}),i},c.prototype.unparse=function(a,b,c,d){var f,g,h,i,j,k=this;if(6===c.type||4===c.type||2===c.type||5===c.type||3===c.type)k.qi(a,c,d);else if(9===c.type)k.ri(a,b,c,d);else if(10===c.type)d.push("("),b.Cma(a,c.value,d),d.push(")");else if(7===c.type)f=e.isFunction(c.function)&&c.function.name||c.functionName,"ANCHORARRAY"!==f||a.Eh?!c.functionName&&e.isExpression(c.function)?(k.unparse(a,b,c.function,d),d.push("("),k.unparseArguments(a,b,c,d),d.push(")")):(c.isLocalFunctionName&&a.Eh&&(f=e.XLPMPrefix+f),g=e.getMapping()&&e.getMapping().builtInFunctionsMapping,h=g&&g[f],S(d,(h&&h.alias||f).split("")),i="@"===f?["",""]:["(",")"],d.push(i[0]),this.unparseArguments(a,b,c,d),d.push(i[1])):(b.Cma(a,c.arguments[0],d),d.push("#"));else{if(1===c.type||8===c.type)return k.unparseRefenceExpressions(a,b,c,d),!0;if(100!==c.type)return!1;j=a.Eh?e.XLPMPrefix+c.value:c.value,S(d,j.split(""))}return!0},c.prototype.unparseArguments=function(a,b,c,d){for(var e=0;e<c.arguments.length;e++)0!==e&&d.push(u),b.Cma(a,c.arguments[e],d)},c.prototype.unparseSource=function(a,b,c,d){if(a.getExternalSourceToken){if(c!==e.BangSource){var f=U(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(f.length>0))return!1;y.apply(b,f)}return b.push("!"),!0}return!1},c.prototype.unparseRefenceExpressions=function(a,b,c,d){if(c.source===e.BangSource)d.push("!");else if(c.source){var f=this.unparseSource(a,d,c.source,c.endSource);if(!f)return void d.push("#","R","E","F","!")}8===c.type&&d.push(c.value)},c.prototype.ri=function(a,c,d,e){var f=d.operatorType;2===f?(c.Cma(a,d.value,e),e.push("%")):0===f||1===f?(e.push(b.di[f]),c.Cma(a,d.value,e)):(c.Cma(a,d.value,e),e.push(b.di[f]),c.Cma(a,d.value2,e))},c.prototype.qi=function(a,b,c){var d,j,k,l,n,o,p,q,r=e.sR().Exp_InvalidArray;if(3===b.type)c.push('"'),c.push(m.Gb(b.value,'"','""')),c.push('"');else if(2===b.type)d=b.originalValue||""+b.value,"."!==t&&(d=d.replace(".",t)),c.push(d);else if(4===b.type)c.push(b.value?e.getBoolean().boolean_true:e.getBoolean().boolean_false);else if(6===b.type){if(c.push("{"),j=b.value,j.getRowCount()<=0)throw r;for(k=0,l=j.getRowCount();k<l;k++)for(k>=1&&c.push(v),n=0,o=j.getColumnCount();n<o;n++){if(0!==n&&c.push(w),p=j.getValue(k,n),p===f||p===g)throw r;q=typeof p,q===h?(c.push('"'),c.push(m.Gb(p,'"','""')),c.push('"')):q===i?c.push(p?e.getBoolean().boolean_true:e.getBoolean().boolean_false):"number"===q&&"."!==t?c.push((""+p).replace(".",t)):c.push(""+p)}c.push("}")}else 5===b.type?c.push(""+b.value):11===b.type},c}(A),b.DefaultTokenResolver=D,e.ParserWrapper.XAb=function(){if(B.numberDecimalSeparator===f){var a=new B;a.setParserOption(!0)}return B.numberDecimalSeparator},e.ParserWrapper.YAb=function(){if(B.numberGroupSeparator===f){var a=new B;a.setParserOption(!0)}return B.numberGroupSeparator}},"./src/calc.common.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calcEngine.res.en.ts"),f=c("./src/text_Filter/text_Filter.ts"),b.n$c=f.n$c,b.ExcelCompatibleCalcMode=!1,b.SR={en:e.resource},b.ErrorCodeList=[0,7,15,23,29,42,36,99,100],b.XLPMPrefix="_xlpm.",g="number",h="string",i="boolean",j="TRUE",k="FALSE",l="object",m="#NULL!",n="#DIV/0!",o="#VALUE!",p="#REF!",q="#NAME?",r="#N/A",s="#NUM!",t="#SPILL!",u="#CALC!",v=1,w=2,x=[m,n,o,p,q,r,s,t,u],b.ErrorList=x,b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384,y=d.Common.j,z=y.Ca,A=y.Fa,B=y.Ea,C=d.Common.k.ac,D=d.Common.q,E=parseInt,F=isNaN,G=d.Common.l,H=G.Ra,I=d.Common.u,J=d.Common.o;function sa(a){return a&&a.toUpperCase()}function ta(a){var b,c;if(a){if(7===a.type&&("SUBTOTAL"===a.functionName||"AGGREGATE"===a.functionName))return!0;for(b=a.arguments&&a.arguments.length,c=0;c<b;c++)if(ta(a.arguments[c]))return!0;if(ta(a.value)||ta(a.value2))return!0}return!1}function ua(a){return a.indexOf(b.XLPMPrefix)>-1?a.replace(/_xlpm\./g,""):a}b.o$c=ua;function va(a){var b=(a&&a.message)+"";return b=b.toLowerCase(),"maximum call stack size exceeded"===b||"too much recursion"===b||"out of stack space"===b}b.isStackOverflowError=va,K=new d.Common.ResourceManager(b.SR,"CalcEngine"),b.sR=K.getResource.bind(K),b.getMapping=function(){return pa&&pa.resourceMapping},b.getBoolean=function(){var a=b.getMapping()&&b.getMapping().booleanMapping;return{boolean_true:a&&a.boolean_true||j,boolean_false:a&&a.boolean_false||k}},L=null,M=void 0,N=Math.abs,O=Math.exp,P=Math.log,Q=Math.pow,R=Math.floor,S=Math.ceil,T={},b.BangSource=T,U={},b.RefErrorSource=U,b.missingArgument=V,W={},X=function(){function a(c){var d=a.nf(c);if(!d)throw b.sR().Exp_NotSupported;this._error=d.error,this._code=d.code}return a.prototype.toString=function(){var a=b.getMapping()&&b.getMapping().clacErrorMapping,c=a&&a[this._error];return c||this._error},a.prototype.clone=function(){return new a(this._error)},a.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},a.parse=function(b){try{return new a(b)}catch(a){return M}},a.nf=function(a){var c,d;if(a)for(c=0;c<x.length;c++)if(d=x[c],d===a||d===sa(a))return{error:d,code:b.ErrorCodeList[c]};return M},a}(),b.CalcError=X,Y={Name:new X(q),Null:new X(m),DivideByZero:new X(n),NotAvailable:new X(r),Value:new X(o),Reference:new X(p),Number:new X(s),Spill:new X(t),Calc:new X(u)},b.Errors=Y,Z=Y.Value,$=Y.Reference,_=Y.Number,aa=Y.DivideByZero,ba=Y.NotAvailable,ca=Y.Null,da={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},ea=function(){function a(){}return a}(),b.ParserWrapper=ea;function wa(a){return isNaN(a)||!isFinite(a)}function xa(a,b){var c,d,e,f,j,k,l,m,n,o,p,q;if(!a)return b.value=0,!0;d=typeof a;try{if(d===g)c=a;else if(d===h){if(/[\f\n\r\t\v]/.test(a))return!1;if(e=a,a=a.trim(),0===a.length)return b.value=0,!0;if(f=ea.XAb(),j=ea.YAb(),"."!==f&&"."!==j&&a.indexOf(".")>=0||","!==f&&","!==j&&a.indexOf(",")>=0)return!1;if(k=!1,l=!1,m=a[0],n=a[a.length-1],"("===a[0]&&")"===n){if(l=!0,a=a.substring(1,a.length-1).trim(),m=a[0],"+"===m||"-"===m)return!1;n=a[a.length-1]}if("%"===m?(k=!0,a=a.substring(1)):"%"===n?(k=!0,a=a.substring(0,a.length-1)):"$"===m&&(a=a.substring(1)),""===a)return!1;if(a.indexOf(j)>=0&&(o=D.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+j+"\\d{3,})+(\\"+f+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$"),o.test(a)&&(a=a.replace(D.qb("[ \\"+j+"]"),""))),a=a.trim()," "===a[1]&&("+"===a[0]?a=a.replace(/^\+ +/,"+"):"-"===a[0]&&(a=a.replace(/^\- +/,"-"))),"."!==f&&(a=a.replace(f,".")),a.indexOf(f)!==a.lastIndexOf(f))return!1;if(a.length>=2&&"0"===a[0]&&"x"===a[1])return!1;if(c=(+a).valueOf(),k&&(c/=100),l&&(c=-c),wa(c)){if(a=e.trim(),p=a.charCodeAt(0),p|=32,a.length>4&&p>=97&&p<=122&&(q=a[0]+a[1]+a[2],q=q.toUpperCase(),!da[q]))return!1;if(m=a[0],n=a[a.length-1],"/"===m||"-"===m||":"===m||"/"===n||"-"===n)return!1;if(o=D.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,\\z\\Z]"),o.test(a))return!1;if(c=new Date(a),wa(c.valueOf()))return!1;c=G.Ra(c)}}else if(d===i)c=a?1:0;else{if(!(a instanceof Date))return!1;c=G.Ra(a)}}catch(a){return!1}return b.value=c,!0}function ya(a){var c={value:0};if(xa(a,c))return c.value;throw b.sR().Exp_InvalidCast}function za(a,b){return b&&(a===L||a===M||typeof a===h&&""===a.trim())}function Aa(a,b){try{if(a)if(typeof a===i);else if(a instanceof Date)a=0!==G.Ra(a);else{if(!Ca(a))return!1;a=0!==a}else a=!1}catch(a){return!1}return b.value=a,!0}function Ba(a,b,c,e,f){var j,k,l;if(Da(a))return a;if(j={value:L},k=W,0!==b&&za(a,e))return k;switch(b){case 1:case 5:if(c&&5!==b){if(typeof a===i&&f)return k;a=xa(a,j)?j.value:k}else typeof a===g||(a=a instanceof Date?G.Ra(a):k);break;case 11:a=xa(a,j)?j.value:k;break;case 4:typeof a===h?(l=d.Common.l.Qa(a),a=l!==M&&l!==L?G.Ra(l):k):c?a=xa(a,j)?j.value:k:typeof a===g||a instanceof Date||(a=k);break;case 3:c?a=xa(a,j)?j.value:k:typeof a!==i&&(a=k);break;case 2:a=a===L||a===M?"":""+a}return a}fa=function(){function a(a,b){this.array=a,this.referenceInTwoDimension=b}return a.prototype.getRowCount=function(){return this.array.length},a.prototype.getColumnCount=function(){var a=this.array[0];return a&&a.length||0},a.prototype.getValue=function(a,b){var c,d=this.array,e=a;return"number"!=typeof b&&(c=a,e=c.row,b=c.column),e<0||b<0||e>=d.length||b>=d[0].length?Z:this.array[e][b]},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=R(a/b),d=a%b;return this.getValue(c,d)},a.prototype.toArray=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;if(void 0===b&&(b=!0),h=this,i=0,j=0,k=[],n=W,i=h.getRowCount())for(j=h.getColumnCount(),o=0;o<i;o++)for(b||(m=[],k.push(m)),p=0;p<j;p++){if(l=h.getValue(o,p),h.referenceInTwoDimension&&Fa(l)&&(l=l.getValueByIndex(0)),c&&Da(l))return k=[l],k.isError=!0,k;if(l=Ba(l,a,!1,f),d&&l===n)return k=[l],k.isConvertError=!0,k;b?k.push(l):m.push(l)}return k.rowCount=i,k.colCount=j,k.rangeCount=1,k},a.prototype.slice=function(b,c,d,e){var f,g,h,i=this,j=i.array,k=[];for(b=b<0?0:b,c=c<0?0:c,d=b+d>i.getRowCount()?i.getRowCount()-b:d,e=c+e>i.getColumnCount()?i.getColumnCount()-c:e,g=0;g<d;g++)for(f=[],k.push(f),h=0;h<e;h++)f.push(j[g+b][h+c]);return new a(k)},a}(),b.CalcArray=fa;function Ca(a,b){var c=typeof a;return c===g||c===l&&a instanceof Date||!b&&(c===i||!isNaN(a)&&!isNaN(parseFloat(a)))}function Da(a){return a instanceof X}function Ea(a){return a instanceof fa}function Fa(a){return a instanceof ka}ga=["o","n","s","b","d"],ha=function(){function a(){}return a.jja=function(a){return Da(a)&&a._code===b.ErrorCodeList[5]},a.Nh=function(a){return isNaN(a)||!isFinite(a)?_:a},a.Ph=function(b,c,d,e,f,g,h,i){var j,k,l;if(b&&b.length&&b.rowCount&&b.colCount)return b;if(Ea(b))j=b.toArray(c,d,e,f,g),j.isArray=!0;else if(Fa(b))j=b.toArray(c,d,e,f,g,h,i),j.isReference=!0;else if(z(b)){if(j=[],0===b.length)return j;if(z(b[0]))return a.Oh(b,c,!0);for(k=0;k<b.length;k++)l=Ba(b[k],c,!1),l===a.CalcConvertedError&&(j.isConvertError=!0),j.push(l);j.rowCount=1,j.colCount=b.length,j.rangeCount=1}else b=Ba(b,c,!0,g),e&&a.vf(b)?(j=[Z],j.isError=!0):b===a.CalcConvertedError?(j=[a.CalcConvertedError],j.isConvertError=!0):d?(j=[],j.push(b)):(j=[[]],j[0].push(b)),j.rowCount=1,j.colCount=1,j.rangeCount=1;return j},a.Oh=function(b,c,d){var e,f,h,j,k,l,m,n,o,p,q,r,s;if(!b||!b.length||!b[0].length)return e=[],e.isError=!0,[[Z]];if(0===c)return b;if(f=ga[c],h=b.length,j=b[0].length,n={value:L},o=!1,p=!1,q=a.CalcConvertedError,e=b[f],!e)for(e=[],b[f]=e,r=0;r<h;r++)for(k=b[r],l=e[r]=[],s=0;s<j;s++)if(m=k[s],Da(m))o||(e.isError=!0,o=!0),l.push(m);else{switch(c){case 1:case 5:d&&5!==c?xa(m,n)?m=n.value:(p||(p=!0,e.isConvertError=!0),m=0):typeof m===g||m instanceof Date||(p||(p=!0,e.isConvertError=!0),m=q);break;case 3:d?Aa(m,n)?m=n.value:(p||(p=!0,e.isConvertError=!0),m=!1):typeof m!==i&&(p||(p=!0,e.isConvertError=!0),m=q);break;case 2:m=m===L||m===M?"":""+m}l.push(m)}return e},a.Rh=function(a){var c=ya(a);if(N(c)<1e21)return parseInt(""+c,10);throw b.sR().Exp_InvalidCast},a.Sh=function(a,b){if(""===a)return!1;var c=xa(a,b);return!!c&&(N(b.value)<1e21&&(b.value=parseInt(""+b.value,10),!0))},a.Vh=function(c){if(!c)return!1;if(typeof c===i)return c;if(c instanceof Date)return 0!==G.Ra(c);if(a.Na(c))return 0!==c;if(a.vf(c))return!1;throw b.sR().Exp_InvalidCast},a.bc=function(a){try{if(a===M||a===L)return"";if(typeof a===i)return a?j:k;if(typeof a===h)return a;if(a instanceof Date)return""+G.Ra(a);if(Ea(a))throw b.sR().Exp_InvalidCast;return typeof a===g?""+J.Lma(a,pa.CALC_PRECISION||15):""+a}catch(a){throw b.sR().Exp_InvalidCast}},a.Wh=function(c){var d={value:L};if(a.Xh(c,d))return d.value;throw b.sR().Exp_InvalidCast},a.Xh=function(a,b){var c,e,f,i;if(a)if(a instanceof Date)b.value=new Date(a.valueOf());else if(typeof a===h){if(c=d.Common.l.Qa(a),!c)if(isNaN(a)){if(c=new Date(a),isNaN(c.valueOf()))return!1;try{if(e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,f=I.ib(I.Db(a.replace(/ |\n/g,"")," ")," "),i=e.exec(f),i&&4===i.length&&(i.indexOf(""+c.getFullYear())===-1||i.indexOf(""+c.getMonth())===-1||i.indexOf(""+c.getDate())===-1))return!1}catch(a){return!1}}else if(c=d.Common.l.Xb(parseFloat(a)),!c)return!1;b.value=c}else{if(typeof a!==g)return!1;b.value=d.Common.l.Xb(a)}else b.value=d.Common.l.Xb(0);return!0},a.CalcConvertedError=W,a.Ca=Ea,a.Na=Ca,a.vf=Da,a.Fh=Fa,a.wf=Ba,a.j$a=za,a.Qh=wa,a.Pa=ya,a.Th=xa,a.Uh=Aa,a}(),b.Convert=ha,function(a){a[a.unknow=0]="unknow",a[a.reference=1]="reference",a[a.number=2]="number",a[a.string=3]="string",a[a.boolean=4]="boolean",a[a.error=5]="error",a[a.array=6]="array",a[a.function=7]="function",a[a.name=8]="name",a[a.operator=9]="operator",a[a.parentheses=10]="parentheses",a[a.missingArgument=11]="missingArgument",a[a.expand=12]="expand",a[a.structReference=13]="structReference",a[a.field=14]="field",a[a.fieldItem=15]="fieldItem",a[a.LocalName=100]="LocalName"}(ia=b.ExpressionType||(b.ExpressionType={})),ja=function(){function a(a){this.type=a}return a.prototype.sf=function(){return L},a.prototype.offset=function(a,b,c,d,e){return L},a.prototype.offsetWhenCopy=function(a,b,c,d,e,f,g,h,i,j){return L},a.prototype.getRange=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c];return L},a}(),b.Expression=ja,ka=function(){function a(a,b){var c=this;c.xf=a,b?(c.yf=b,c.zf=b.length):c.zf=1}return a.prototype.getRangeCount=function(){return this.zf},a.prototype.getSource=function(){
return this.xf},a.prototype.create=function(b){return new a(this.xf,b)},a.prototype.toArray=function(a,b,c,d,e,f,g){var h=this.xf,i=h.referenceToArray;return i&&i.call(h,this,a,b,c,d,e,f,g)},a.prototype.getRow=function(a){return this.yf?this.yf[a||0].row:0},a.prototype.getColumn=function(a){return this.yf?this.yf[a||0].col:0},a.prototype.getRowCount=function(a){return this.yf?this.yf[a||0].rowCount:this.xf.getRowCount()},a.prototype.getColumnCount=function(a){return this.yf?this.yf[a||0].colCount:this.xf.getColumnCount()},a.prototype.getValue=function(a,b,c){var d,e,f;if(typeof a===g?(d=arguments[1],e=arguments[2],b=arguments[0]):(a=a,d=a.row,e=a.col),b=b||0,d>=0||e>=0){if(f=this.yf,!f)return this.xf.getValue(d,e);if(b<f.length)return this.xf.getValue(d+f[b].row,e+f[b].col)}return $},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=R(a/b),d=a%b;return this.getValue(0,c,d)},a.prototype.isHiddenRow=function(a,b,c){return this.xf.isHiddenRow(b+this.getRow(a),c)},a.prototype.isSubtotal=function(a,b,c){var d,e=this.xf;return 0===a&&b<e.getRowCount()&&c<e.getColumnCount()&&(d=e.getCalcSourceModel().ATa(b,c),ta(d))},a.prototype.getSpillRef=function(){var b,c,d,e,f,g,h,i,j,k=this;if(1!==k.getRowCount()||1!==k.getColumnCount())return $;if(b=k.getSource(),c=k.getRow(),d=k.getColumn(),e=ab(c,d),f=new a(b,[e]),b){if(g=b.yLb().getAnchorCell(c,d))return g.isValid?(e.rowCount=g.rowCount,e.colCount=g.colCount,f):Y.Spill;if(h=b.getCalcSourceModel(),i=h.Qf(c,d))return i.row===c&&i.col===d?(e.rowCount=i.rowCount,e.colCount=i.colCount,new a(b,[e])):void 0;if(j=h.Kf(c,d),!j||33!==j.type)return j&&("@"===j.functionName||j)?(e.rowCount=1,e.colCount=1,new a(b,[e])):void 0;f.isSpillError=!0,e.rowCount=1,e.colCount=1}},a}(),b.CalcReference=ka,la=function(){function a(b){this.id=a.sourceId++,this.Af=b,this.Bf=null}return a.prototype.getCalcService=function(){return this.Af},a.prototype.Cf=function(){return this.Af},a.prototype.setCalcService=function(a){this.Af=a},a.prototype.getCalcSourceModel=function(){return this.Bf},a.prototype.setCalcSourceModel=function(a){this.Bf=a},a.prototype.getValue=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a];return L},a.prototype.getName=function(){return""},a.prototype.getField=function(a){return L},a.prototype.getFieldItem=function(a){return L},a.prototype.setValue=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.getReference=function(a){return new ka(this,a&&[a])},a.prototype.getSources=function(a){return[this]},a.prototype.referenceToArray=function(a,b,c,d,e,f,g,h){return a.toArray(b,c,d,e,f,g,h)},a.prototype.setFormula=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.setArrayFormula=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.getRowCount=function(){return 1e3},a.prototype.getColumnCount=function(){return 100},a.prototype.isHiddenRow=function(a,b){return!1},a.prototype.startCalculation=function(){},a.prototype.endCalculation=function(){},a.prototype.getCustomFunction=function(a){return L},a.prototype.getCustomName=function(a){return L},a.prototype.getCustomNameInfo=function(a){return L},a.prototype.refresh=function(){},a.prototype.toJSON=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c]},a.sourceId=1,a}(),b.CalcSource=la;function Ga(a,b,c){var d=new ja(5);return b&&(d.source=b),c&&(d.endSource=c),d.value=a,d}b.Hh=Ga,b.Ih=Ga($);function Ha(a,b){var c=new ja(7);return c.arguments=b,a instanceof ja?(c.function=a.function,c.functionName=a.functionName):(c.function=a.name&&a,c.functionName=a.name||a),c}b.Jh=Ha;function Ia(a,b){var c=new ja(7);return c.arguments=b,c.function=a,c}b.s$c=Ia;function Ja(a,b){var c=new ja(12);return c.value=a,c.needExpendIndexs=b,c}b.createExpandExpression=Ja;function Ka(a,b,c){var d=new ja(9);return d.operatorType=a,d.value=b,d.value2=c,d}b.Kh=Ka;function La(a){var b=new ja(10);return b.value=a,b}b.Lh=La;function Ma(a){var b=new ja(3);return b.value=a,b}b.createStringExpression=Ma;function Na(a){var b=new ja(2);return b.value=a,b}b.createNumberExpression=Na;function Oa(a){var b=new ja(4);return b.value=a,b}b.createBooleanExpression=Oa,ma=function(){function a(){}return a.Yh=function(a,b){var c=16777216,d=a===b||N(a-b)<N(a)/(c*c);return!!d||(a=J.Lma(a,15),b=J.Lma(b,15),N(a-b)<N(a)/(c*c))},a.getArrayValue=function(a,b,c){return a?b<a.getRowCount()&&c<a.getColumnCount()?a.getValue(b,c):c>=a.getColumnCount()&&1===a.getColumnCount()&&b<a.getRowCount()?a.getValue(b,0):b>=a.getRowCount()&&1===a.getColumnCount()&&c<a.getColumnCount()?a.getValue(0,c):Z:Z},a.tryExtractToSingleValue=function(a){var b,c=!0;return(Fa(a)||Ea(a))&&(b=ha.Ph(a,0,!1,!0),b.isError?a=b[0]:1===b.rowCount&&1===b.colCount?a=b[0][0]:(a=b,c=!1)),{value:a,success:c}},a}(),b.Zh=ma;function Pa(a,b){return a.charAt(b)}b.charAtFunc=Pa;function Qa(a,b){for(var c=a.length,d=!1;b<c&&!isNaN(+Pa(a,b));)b++,d=!0;for(b<c&&"."===Pa(a,b)&&b++;b<c&&!isNaN(+Pa(a,b));)b++,d=!0;if(b<c&&("E"===Pa(a,b)||"e"===Pa(a,b)))for(b++,d=!1,b<c&&("+"===Pa(a,b)||"-"===Pa(a,b))&&b++;b<c&&!isNaN(+Pa(a,b));)b++,d=!0;return{Vi:d,mi:b}}function Ra(a){return"string"==typeof a}na=function(){function a(a){this.Di=a}return a.prototype.$j=function(a){var b,c,d,e,f,g,h,i,j=this.Di;if(y.Ca(j)||(j=[j]),j[0]===-1)return!0;for(b=0;b<j.length;b++)if(c=j[b],d=void 0,e=void 0,Ra(c)){for(f=c.split(" && "),g=!0,h=0;h<f.length;h++)i=f[h].split(" "),d=i[0],e=E(i[1]),"!="===d&&a!==e||">"===d&&a>e||">="===d&&a>=e||"%="===d&&a%2===e||(g=!1);if(g)return!0}else if(a===c)return!0;return!1},a.prototype._j=function(){return this.Di},a}();function Sa(a,c){if(!a||8===a.type&&a.value.indexOf("'")>=0)throw b.sR().Exp_FormulaInvalid}b.iEc=Sa,oa=function(){function a(){this.context=[{}],this.closure={},this.backupClosure=[]}return a.prototype.getVariable=function(a){var b,c;for(a=sa(a),c=this.context.length-1;c>=0&&(b=this.context[c][a],b===M);c--);return b===M&&this.closure&&(b=this.closure[a]),b},a.prototype.setVariable=function(a,b){a=sa(a),this.context[this.context.length-1][a]=b},a.prototype.hasVariable=function(a){return a=sa(a),this.getVariable(a)!==M},a.prototype.enterScope=function(){this.context.push({})},a.prototype.exitScope=function(){this.context.pop()},a.prototype.saveThenSwitchClosure=function(a){this.backupClosure.push(this.closure),this.closure=a},a.prototype.restoreClosure=function(){this.backupClosure.length>0?this.closure=this.backupClosure.pop():this.closure={}},a.prototype.createClosure=function(){var a,b={};for(this.copyTo(this.closure,b),a=0;a<this.context.length;a++)this.copyTo(this.context[a],b);return b},a.prototype.copyTo=function(a,b){var c,d,e=Object.keys(a);for(c=0;c<e.length;c++)d=e[c],b[d]=a[d]},a}(),b.LocalScopes=oa,function(a){var c,e,f,g,h,i,j,k,m,n,o,p,q,r,s,t,u,x;!function(a){a[a.normal=0]="normal",a[a.allwaysExpand=1]="allwaysExpand",a[a.neverExpand=2]="neverExpand"}(c=a.ArrayArgumentEvaluateMode||(a.ArrayArgumentEvaluateMode={})),e=function(){function a(a,b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),this.name=a,this.minArgs=b,this.maxArgs=c;var e=this;e.$h=d,e.typeName=""}return a.prototype.description=function(){var a=this,c=b.sR()._h;return a.$h?a.$h:c&&c[a.name]},a.prototype.acceptsArray=function(a){return!1},a.prototype.acceptsReference=function(a){return!1},a.prototype.acceptsError=function(a){return!1},a.prototype.acceptsMissingArgument=function(a){return!1},a.prototype.isVolatile=function(){return!1},a.prototype.isContextSensitive=function(){return!1},a.prototype.isBranch=function(){return!1},a.prototype.findTestArgument=function(){return-1},a.prototype.findBranchArgument=function(a){return-1},a.prototype.expandRows=function(){return!0},a.prototype.expandColumns=function(){return!0},a.prototype.skipPrecedent=function(a){return!1},a.prototype.returnReference=function(){return!1},a.prototype.evaluate=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.evaluateWithContext=function(a,b){var c=this,d=b;return c.isContextSensitive()&&(d=[a].concat(d)),c.evaluate.apply(c,d)},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)a[b]!==M&&(this[b]=a[b])},a.prototype.gEc=function(a,c,d,e){if(d<a||d>c)throw b.sR().Exp_FormulaInvalid},a.prototype.hEc=function(a,b){Sa(a,b)},a.ai=function(b,c,d){var e,f=new a(b,0,255);if(c&&"function"==typeof c&&(f.evaluate=c),d)for(e in d)d.hasOwnProperty(e)&&"override"!==e&&(f[e]=d[e]);return f},a}(),a.Function=e,f=function(a){ra(b,a);function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return b.prototype.isContextSensitive=function(){return!0},b.prototype.evaluate=function(a,b){return this.evaluateAsync.apply(this,arguments)},b.prototype.evaluateAsync=function(a,b){this.evaluate.apply(this,arguments)},b.prototype.defaultValue=function(){return 0},b.prototype.evaluateMode=function(){return 0},b.prototype.evaluateWhenArgumentsIsSame=function(){return!0},b.prototype.interval=function(){return 1e4},b}(e),a.AsyncFunction=f,g=function(a){ra(b,a);function b(b,c){var d=this,e=b.arguments,f=e.slice(0,e.length-1),g=e[e.length-1];return d=a.call(this,"LAMBDA",f.length,f.length)||this,d.parameters=f,d.calculation=g,d.closure=c,d}return b.prototype.acceptsArray=function(a){return!0},b.prototype.acceptsReference=function(a){return!0},b.prototype.acceptsError=function(a){return!0},b}(e),a.LambdaFunction=g,a.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},a.bi={},a.ci={};function z(b,c){return c.name=sa(c.name),a.ci[sa(b)]=c,c}a.defineGlobalCustomFunction=z;function G(c){var d,e,f;return c?(c=sa(c),d=a.bi,e=a.ci,f=b.getMapping()&&b.getMapping().builtInFunctionsMapping,d&&(U(f,c)||d[c])||e&&e[c]):T()}a.findGlobalFunction=G;function I(){return T()}a.findGlobalFunctions=I;function K(b){if(!b)return a.bi={},void(a.ci={});b=sa(b);var c=a.bi,d=a.ci;c[b]?delete c[b]:d[b]&&delete d[b]}a.removeGlobalFunction=K;function T(){var b,c,d=a.bi,e=a.ci,f=[];for(b in d)f.push(d[b]);for(c in e)f.push(e[c]);return f}function U(b,c){var d,e=a.bi;if(!A(b))for(d in b)if(b[d].alias===c)return e[d];return M}h=b.sR().Exp_Format,i=function(){function b(a,b,c){this.Ri=a,this.Si=b,this.kja=c||"i"}return b.prototype.Pi=function(){return this.Ri},b.prototype.Qi=function(){return this.Si},b.prototype.lja=function(){return this.kja},b.prototype.bc=function(b){b=b||"i";var c=this,d=c.Ri,e=c.Si,f="",g=a.CALC_PRECISION;return g&&(d=J.Lma(d,g),e=J.Lma(e,g)),0===d&&0!==e||(f+=""+d),e===-1?f+="-":0!==d&&e>0&&(f+="+"),e!==-1&&0!==e&&1!==e&&(f+=""+e),0!==e&&(f+=b),f},b}(),a.Ui=i;function V(a){function c(a){var c,d,e,f,g=0,j=0,k=!1,l=0,m=0,n=0,o=a.length;if(!a)throw b.sR().Exp_ArgumentNull;if(0===o)throw h;if(n<o&&("+"===Pa(a,n)||"-"===Pa(a,n))&&n++,f=Qa(a,n),n=f.mi,c=f.Vi,n<o&&("+"===Pa(a,n)||"-"===Pa(a,n))?(l=n,n++,f=Qa(a,n),n=f.mi,d=f.Vi,n<o&&("i"===Pa(a,n)||"j"===Pa(a,n))&&(e=Pa(a,n),n++,k=!0),m=n-l):n<o&&("i"===Pa(a,n)||"j"===Pa(a,n))?(e=Pa(a,n),n++,m=n,d=c,k=!0,c=!1):l=n,n<o)throw h;if(l>0){if(!c)throw h;g=parseInt(a.substr(0,l),10)}if(m>0){if(!k)throw h;if(1===m||2===m&&"+"===Pa(a,l))j=1;else if(2===m&&"-"===Pa(a,l))j=-1;else{if(!d)throw h;j=parseInt(a.substr(l,m-1),10)}}return new i(g,j,e)}try{return a?"number"==typeof a?new i(a,0):"string"==typeof a?c(a):null:new i(0,0)}catch(a){return null}}a.Wi=V,j=ha.Th,k=ha.Rh,m=ha.Pa,n=ha.Na,o=ha.Ph,p=ha.Nh,q=ha.vf,r=ma.Yh;function Y(c,d,f){var g,h,i;if(A(c))throw b.sR().Exp_InvalidFunctionName;if(c=c.toUpperCase(),a.bi[c])throw b.sR().Exp_InvalidOverrideFunction;if(g=a.bi[c]){if(!f||!f.override)throw b.sR().Exp_OverrideNotAllowed}else a.bi[c]=g=new e(c,0,255);return d&&"function"==typeof d&&(g.evaluate=d),"function"==typeof f.argsValidator&&(h=g.gEc,g.gEc=function(a,b,c,d){h(a,b,c,d),f.argsValidator(a,b,c,d)}),"function"==typeof f.subExpressionValidator&&(i=g.hEc,g.hEc=function(a,b){i(a,b),f.subExpressionValidator(a,b)}),y.H(f,function(a,b){var c;B(a,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])>=0?(c=new na(b),g[a]=function(a){return c.$j(a)}):B(a,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])>=0?(c=new na(b),g[a]=function(){return c._j()}):f.hasOwnProperty(a)&&(g[a]=b)}),g}function $(a,b,c,d,e,f,g,h,i){return h||(h={}),c!==M&&(h.minArgs=c),d!==M&&(h.maxArgs=d),f!==M&&(h.acceptsReference=f),g!==M&&(h.acceptsArray=g),e!==M&&(h.Ci=e),h.bk!==M&&(h.acceptsMissingArgument=h.bk),h.ck!==M&&(h.isVolatile=h.ck),h.dk!==M&&(h.isContextSensitive=h.dk),h.l7c!==M&&(h.haveDynamicListener=h.l7c),h.KMc!==M&&(h.skipPrecedent=h.KMc),h.fk!==M&&(h.arrayArgumentEvaluateMode=h.fk),h.gk!==M&&(h.acceptsError=h.gk),i!==M&&(h.isDynamicArrayFunction=i),Y(a,b,h)}a.ak=$,a.hk=1.79769e308;function da(a){return"boolean"==typeof a}a.ik=da,a.jk=Ra;function ea(a){return"number"==typeof a}a.Na=ea;function ga(a){return a%400===0||a%4===0&&a%100!==0||1900===a}a.kk=ga,s=ga;function ia(a,b){switch(b){case 0:case 2:case 4:return 360;case 1:return s(a.getFullYear())?366:365;case 3:return 365;default:return-1}}a.lk=ia;function ja(a,b){return a-b}a.mk=ja;function la(a,b){return B(b,[0,2,4,6,7,9,11])>=0?31:B(b,[3,5,8,10])>=0?30:1===b?s(a)?29:28:void 0}a.nk=la,t=la;function oa(a,b,c,d){var e,f,g=c.getFullYear(),h=c.getMonth(),i=c.getDate(),j=d.getFullYear(),k=d.getMonth(),l=d.getDate();return a?(e=1===h&&t(g,h)===i,f=1===k&&t(j,k)===l,b?(e&&(i=30),f&&(l=30)):(e&&f&&(l=30),e&&(i=30)),31===l&&i>=30&&(l=30)):31===l&&(b?(l=1,k++):l=30),31===i&&(i=30),360*(j-g)+30*(k-h)+l-i}function pa(a,b,c){var d,e,f=1;return ja(a,b)>0&&(e=a,a=b,b=e,f=-1),d=B(c,[1,2,3])>=0?f*k(H(b)-H(a)):B(c,[4,5])>=0?f*oa(!1,5===c,a,b):f*oa(!0,6===c,a,b)}a.pk=pa;function qa(a){var b,c,d;return 0===a?c=0:(d=.5*N(a),d>=3?c=1:d<1?(b=d*d,c=((((((((.000124818987*b-.001075204047)*b+.005198775019)*b-.019198292004)*b+.059054035642)*b-.151968751364)*b+.319152932694)*b-.5319230073)*b+.797884560593)*d*2):(d-=2,c=(((((((((((((-45255659e-12*d+.00015252929)*d-19538132e-12)*d-.000676904986)*d+.001390604284)*d-.00079462082)*d-.002034254874)*d+.006549791214)*d-.010557625006)*d+.011630447319)*d-.009279453341)*d+.005353579108)*d-.002141268741)*d+.000535310849)*d+.999936657524)),a>0?.5*(c+1):.5*(1-c)}a.qk=qa;function ta(a,c,d,e,f){var g,h,i,j,k,l,m,n,q,r,s,t,u,v,w=d<100,x=2===d||102===d,y=x||3===d||103===d,z=5===d||105===d,B=4===d||104===d||z,D=9===d||109===d,E=1===d||101===d||D||e,F=6===d||106===d,G=F?1:0,H=!1,I=0;for(g=0;g<C(a);g++){if(r=a[g],s=void 0,y?s=o(r,0,!1,!1,!1,x):(t=1,(!b.ExcelCompatibleCalcMode||Ea(r)||Fa(r))&&(t=5),s=o(r,t,!1,!1,!1,!0)),s.isError)return s[0];if(s.isConvertError)return Z;for(u=s.rangeCount,v=s.isReference,h=0;h<u;h++)for(i=u>1?s[h]:s,v&&(j=r.getRow(h),k=r.getColumn(h)),l=0;l<C(i);l++)if(2===c||!v||!r.isHiddenRow(h,l,w))for(n=i[l],m=0;m<C(n);m++)if(!(1!==c&&2!==c&&v&&r.isSubtotal(h,l+j,m+k)||(q=n[m],null===q||q===W))){if(q&&q._error&&!y)return f&&(f.sumx=0,f.sumx2=0,f.n=0),q;y&&!A(q)&&(!x||""!==q&&ha.Na(q,!0))?G++:B&&(!H||z&&q<G||!z&&q>G)?G=q:E?e?(f.sumx+=q,f.sumx2+=q*q,f.n++,f.values.push(q),f.values[0]!==q&&(f.allSame=!1)):(G+=q,I++):F&&(G*=q,I++),H=!0}}return E?D?G:e?void 0:0===I?aa:p(G/I):F?p(I>0?G:0):G}a.Hfc=ta;function ua(a,b,c){var d,e,f=c%100,g=7===f||8===f,h=7===f||10===f?1:0,i={sumx:0,sumx2:0,n:0,values:[],allSame:!1},j=ta(a,b,c,!0,i);if(j&&j._error)return j;if(i.n<=h)return aa;if(i.allSame)j=0;else if(r(i.n*i.sumx2,i.sumx*i.sumx))for(j=0,d=i.sumx/i.n,e=0;e<i.n;e++)j+=Q(i.values[e]-d,2);else j=i.sumx2-i.sumx*i.sumx/i.n;return j/=i.n-h,p(g?Math.sqrt(j):j)}a.sk=ua;function va(a,b,c,d){var e,f,g,h,i,j,n,p,r,s,t,u,v,w,x,y,z,A,B,D;if(null===c)return Z;if(c=parseInt(c,10),c<=0||c>19)return Z;b||(b=0),e=1===b||3===b||5===b||7===b,f=1===b||2===b||3===b||0===b,g=2===b||3===b||6===b||7===b,h=2===c,i=h||3===c,j=12===c,n=13===c,p=14===c,r=15===c,s=16===c,t=17===c,u=18===c,v=19===c,w=p||r||s||t||u||v,x=[];function E(a){var b,d,j,k,m,n,p,r,s,t,u,v=[];if(b=i?o(a,0,!1,!1,!1,!1):o(a,5,!1,!1,!1,!1),b.isConvertError)return Z;for(t=b.rangeCount,u=b.isReference,d=0;d<t;d++)for(j=t>1?b[d]:b,u&&(k=a.getRow(d),m=a.getColumn(d)),n=0;n<C(j);n++)if(!(u&&a.isHiddenRow(d,n,!1)&&e))for(r=j[n],p=0;p<C(r);p++)if(!(u&&f&&a.isSubtotal(d,n+k,p+m)||(s=r[p],null===s||g&&q(s)||q(s)&&h))){if(!g&&q(s)&&3!==c)return s;typeof s===l&&0===Object.keys(s).length||v.push(s)}return v}function F(a){var b,c=a.getRow(0),e=a.getColumn(0),f=a.getRowCount(0),g=a.getColumnCount(0);if(1===f&&1===g)b=a.getValue(0,0,0);else if(1!==f&&1===g&&c<=d.row&&d.row<c+f)b=a.getValue(0,d.row-c,0);else{if(!(1===f&&1!==g&&e<=d.column&&d.column<e+g))return Z;b=a.getValue(0,0,d.column-e)}return b===L||""===b?_:isNaN(parseInt(b,10))?Z:parseFloat(b)}if(y=C(a),w){if(2!==y)return Z;if(x=E(a[0]),x._error)return x;if(z=void 0,a[1]===L)return _;if(a[1]instanceof ka)z=F(a[1]);else if(a[1]instanceof fa)z=a[1].array[0][0];else{if(isNaN(parseInt(a[1],10)))return Z;z=m(a[1])}return z._error?z:(17!==c&&19!==c||(z=k(z)),Na([x,z],c))}for(A=0;A<y;A++)if(!(a[A]instanceof ka))return Z;for(A=0;A<y;A++){if(B=E(a[A]),!(B instanceof Array))return B;x.push.apply(x,B)}return j||n?Na([x],c):7===c||8===c||10===c||11===c?(D=f?1:0,ua(x,D,c)):ta(x,1,c)}a.mja=va;function wa(a){var b=a.charCodeAt(0);return b>=0&&b<129||63728===b||b>=65377&&b<65440||b>=63729&&b<63732?"singleByte":b>=55296&&b<=57343?"fourByte":"doubleByte"}a.UAb=wa;function xa(a){var b,c=[];for(b=0;b<a.length;b++)A(a[b])?(c[b]=a[b+1],b++):c[b]=a[b];return c.length===a.length-1&&(c[c.length]=M),c}a.WAb=xa;function ya(a){var b,c,d,e,f=[],g=0,h=0;for(c=0;c<a.length;c++){if(b=a[c],d=wa(a[c]),"doubleByte"===d||"fourByte"===d)if("fourByte"===d){if(g%2===0){g++;continue}h++,g++,b=a[c-1]+a[c]}else h++,b=a[c];e=g>0?g/2:0,f[c-e+h]=b}return xa(f)}a.VAb=ya;function za(a,b){var c,d;for(void 0===b&&(b=!0),c=[],d=0;d<C(a);d++)Ba(a[d],c,b);return c}function Aa(a){a.sort(function(a,b){return a-b})}function Ba(a,b,c){var d,e;for(void 0===c&&(c=!0),d=0;d<C(a);d++)e=a[d],e!==W&&b.push(e);c&&Aa(b)}function Ca(){var a,b,c,d=[];for(a=0;a<arguments.length;a++)d[a]=arguments[a];return b=za(arguments[0]),c=C(b),0===c?_:c%2===0?(m(b[c/2-1])+m(b[c/2]))/2:b[E(""+c/2)]}function Da(){var a,b,c,d,e,f,g,h,i=[];for(a=0;a<arguments.length;a++)i[a]=arguments[a];for(b=L,c=0,d=za(arguments[0],!1),e=C(d),f=0;f<e;f++){for(h=0,g=0;g<e;g++)g!==f&&d[g]===d[f]&&h++;h>c&&(c=h,b=d[f])}return 0===c?ba:b}function Ga(a,b){return Ia(!0,a,b)}function Ha(a,b){return Ia(!1,a,b)}function Ia(a,b,c){var d,e=[];return Ba(b,e),d=C(e),c<1||d<c?_:(c=a?S(c):R(c),a?e[d-c]:e[c-1])}function Ja(a,b){var c,d,e;return a=o(a,1,!0,!0,!1,!0),b=m(b),a.isError?a[0]:a.isConvertError||F(b)?Z:(c=[],Ba(a,c),!C(c)||b<0||b>1?_:(d=b*(C(c)-1),e=d%1,d=E(""+d),0===e?c[d]:m(c[d])+e*(m(c[d+1])-m(c[d]))))}function Ka(a,b){var c=B(b,[0,1,2,3,4]);return c<0?_:Ja(a,.25*c)}function La(a,b){var c,d,e,f,g,h,i=C(a),j=[];for(c=0;c<i;c++)n(a[c],!0)&&j.push(a[c]);return j.length?(d=j.length,Aa(j),e=b*(d+1)-1,f=e%1,e<0||d-1<e?_:(g=R(e),h=j[g],0===f?h:h+f*(j[g+1]-h))):_}function Ma(a,b){var c=B(b,[1,2,3]);return c<0?_:La(a,.25*(c+1))}function Na(a,b){var c=12===b,d=13===b,e=14===b,f=15===b,g=16===b,h=17===b,i=18===b,j=19===b;return c?Ca(a):d?Da(a):e?Ga(a[0],a[1]):f?Ha(a[0],a[1]):g?Ja(a[0],a[1]):h?Ka(a[0],a[1]):i?La(a[0],a[1]):j?Ma(a[0],a[1]):ca}a.sja=Na;function Oa(a){var b=1,c;for(c=a;c>1;c--)b*=c;return b}a.tk=Oa;function Ta(a,b,c){var d=a.getDate(),e=b.getDate(),f=a.getMonth(),g=b.getMonth(),h=a.getFullYear(),i=b.getFullYear();return d=31===d?30:d,c?e=31===e?30:e:31===e&&(d<30?(e=1,g++,g>12&&(g=1,i++)):e=30),30*(12*(i-h)+g-f)+e-d}a.uk=Ta;function Ua(a,b,c){var d,e,f,g,h,i,j,l,n,o=pa(a,b,c);return o<0&&(o=-o,e=a,a=b,b=e),1===c?(f=a.getFullYear(),g=b.getFullYear(),h=void 0,i=void 0,j=void 0,l=void 0,h=new Date(a.valueOf()),h.setFullYear(h.getFullYear()+1),ja(b,h)>0?(l=g+1-f,h=new Date(f,0,1),i=new Date(g+1,0,1),j=k(H(i)-H(h))-365*(g+1-f)):(l=1,j=s(f)&&a.getMonth()<w||s(g)&&256*b.getMonth()+b.getDate()>=256*v+29?1:0),n=m(j)/m(l),d=365+n):d=ia(new Date,c),o/d}function Va(a,b,c){return c<0||c>4?_:Ua(a,b,c)}a.vk=Va;function Wa(a,b,c){var d;return 0===a?d=b<=c:1===a?d=b>=c:2===a?d=b!==c:3===a?d=b<c:4===a?d=b===c:5===a&&(d=b>c),d}function Xa(a,c){var e,f,g=-1,h=!0,i={value:0},k=D.zb(c);if(4!==a&&2!==a||!k||(f=c.replace(/\*+/g,"*"),f!==c&&(k=D.zb(f)),e=function(b){if(""===b)return 2===a;var c=D.sb(k);return c.lastIndex=0,4===a?c.test(b):!c.test(b)}),4===a&&d.Common.F(c,Date))return function(a,b){var d={value:null};return!(!a||!ha.Xh(a,d))&&d.value.getTime()===c.getTime()};function l(a){return 0===(""+a).trim().length}return A(c)?g=0:k?h=!1:l(c)||F(parseFloat(c))||!j(c,i)?h=!1:g=i.value,function(d,f){var i,l;return(""!==c||4===a||2===a)&&(!(!f&&d instanceof X)&&(A(d)&&(d=""),i={value:0},!(b.ExcelCompatibleCalcMode&&h&&!n(d,!0)&&4!==a&&2!==a)&&(b.ExcelCompatibleCalcMode&&h&&"boolean"==typeof d?2===a:h&&j(d,i)?""===d?2===a:Wa(a,i.value,g):k&&n(d,!0)?2===a:(l=A(c)?"":(""+c).toUpperCase(),k&&e?e(""+d):Wa(a,(""+d).toUpperCase(),l)))))}}u={},x=function(){function b(){}return b.wk=function(a){var b=R(a);return r(a,b+1)?b+1:b},b.xk=function(a){var b,c,d,e,f,g,h=a,i=u;if(i||(u=i={}),b=i[h])return b;if(n(a))return b=i[h]=Xa(4,a);for(c="=><",d=A(a)?"":(""+a).toUpperCase(),e="\0",f=0;f<2&&f<C(d);f++){if(g=d[f],c.indexOf(g)===-1){if("<"===e)return i[h]=b=Xa(3,d.substring(1)),b;if(">"===e)return i[h]=b=Xa(5,d.substring(1)),b;break}if("="===g)return b="<"===e?Xa(0,d.substring(2)):">"===e?Xa(1,d.substring(2)):Xa(4,"\0"===e?d.substring(1):a),i[h]=b,b;if("\0"===e)e=g;else{if("<"===e)return b=">"===g?Xa(2,d.substring(2)):Xa(3,d.substring(1)),i[h]=b,b;if(">"===e)return i[h]=b=Xa(5,d.substring(1)),b}}return i[h]=b=Xa(4,a),b},b.yk=function(a){var b=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][a];return a>308&&(a=308),A(b)?Q(10,parseFloat(a)):b},b.zk=function(a){var b=S(a);return r(a,b-1)?b-1:b},b.Ak=function(a,c){for(var d,e,f=b.yk(N(c)),g=S,h=R,i=c,j=i<0?a/f:a*f;N(i)>2&&j===1/0;)i=Math.round(i/2),f=b.yk(N(i)),j=i<0?a/f:a*f;return a=j,d=a.toExponential(),e=E(d.split("e")[1])+1,e<=15&&e>=-85&&(a=parseFloat(a.toFixed(15-e))),a=a<0?g(a-.5):h(a+.5),a=c<0?a*f:a/f,p(a)},b.Bk=function(a,b){var c,d;if(a<0||b<0||a<b)return _;for(c=1,b=Math.min(a-b,b),d=1;d<=b;d++)c*=a-d+1,c/=d;return p(c)},b.YDc=function(a,b){if(a<0&&N(b)<1){var c=(1/b).toPrecision(15);if(parseFloat(c)===parseInt(c,10)&&parseInt(c,10)%2!==0)return-Q(-a,b)}return Q(a,b)},b.Ck=function(b,c){var d=N(b)>.5?Q(1+b,c):O(c*P(1+b));return isFinite(d)?F(d)&&(d=5e-324):d===Number.POSITIVE_INFINITY?d=a.hk:d===Number.NEGATIVE_INFINITY&&(d=-a.hk),d},b.Dk=function(a,b){return(O(a)+(b?-1:1)*O(-a))/2},b.Ek=function(a,b){return F(a)?a:F(b)?b:1!==b&&1===a||0!==b&&b!==Number.POSITIVE_INFINITY?P(a)/P(b):NaN},b}(),a.MathHelper=x}(pa||(pa={})),b.Functions=pa;function Ta(a,b){return a.localeCompare(b)}function Ua(a,b,c){var e,f;try{f=d.Common.CultureManager.getCultureInfo(),e=f.localeCompare?c?f.localeCompare(a,b):f.localeCompare(a.toLowerCase(),b.toLowerCase()):c?Ta(a,b):Ta(a.toLowerCase(),b.toLowerCase())}catch(d){e=c?Ta(a,b):Ta(a.toLowerCase(),b.toLowerCase())}return e}b.Xmc=Ua;function Va(a,b,c){var d,e,f,g,j,k,l,m,n,o;if(void 0===c&&(c=!0),Da(a))return a;if(Da(b))return b;if(e=typeof a===i,f=typeof b===i,e||f)d=e&&f?a===b?0:a>b?1:-1:e?1:-1;else{if(g=typeof a===h,j=typeof b===h,k=g||j,l=k?"":0,a=a===L||a===M?l:a,b=b===L||b===M?l:b,m=function(){return a===b?0:g&&j?Ua(a,b,c):g?1:j?-1:(a=J.Lma(a,15),b=J.Lma(b,15),a-b)},!k){if(n={value:0},o={value:0},!xa(a,n)||!xa(b,o))return Z;a=n.value,b=o.value}d=m()}return d}b.gOb=Va;function Wa(a){return a instanceof pa.Function}b.isFunction=Wa;function Xa(a){return a instanceof pa.LambdaFunction}b.isLambdaFunction=Xa;function Ya(a){return a instanceof ja}b.isExpression=Ya;function Za(a,b){return!Wa(a)||a.acceptsArray(b)}b.getFunctionAcceptsArray=Za;function $a(a,b){return!Wa(a)||a.acceptsReference(b)}b.getFunctionAcceptsReference=$a;function _a(a){return a&&a.arrayArgumentEvaluateMode}b.getFunctionArrayArgumentEvaluateMode=_a,qa=function(a){ra(b,a);function b(b){var c=a.call(this,L)||this;return c.u4=b,c}return b.prototype.startCalculation=function(){},b.prototype.endCalculation=function(){},b.prototype.getValue=function(){return Y.Reference},b.prototype.getReference=function(){var a=new ka(this,[ab(0,0)]);return a.getValue=function(){return Y.Reference},a},b.prototype.referenceToArray=function(){var a=[Y.Reference];return a.isError=!0,a},b.prototype.getName=function(){return this.u4},b.prototype.setValue=function(){},b}(la),b.ErrorSource=qa;function ab(a,b){return{row:a,col:b}}},"./src/calc.entry.ts":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),f(c("./src/calc.common.ts")),f(c("./src/Parser.ts")),f(c("./src/evaluator.ts")),f(c("./src/calc.ts")),f(c("./src/referenceExpression.ts")),d=c("./src/calc.ts"),Object.defineProperty(b,"supportRowColumnFormula",{set:function(a){d.supportRowColumnFormula=a},get:function(){return d.supportRowColumnFormula}}),Object.defineProperty(b,"approximatelyEqual",{set:function(a){d.approximatelyEqual=a},get:function(){return d.approximatelyEqual}}),e=c("./src/calc.common.ts"),Object.defineProperty(b,"ExcelCompatibleCalcMode",{set:function(a){e.ExcelCompatibleCalcMode=a},get:function(){return e.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=c("./src/referenceExpression.ts"),g=c("./src/Parser.ts"),h=c("./src/evaluator.ts"),i=d.Common.F,j=d.Common.A,k=d.Common.B,l=d.Common.u,m=d.Common.l,n=null,o=void 0,p=Math.abs,q=e.Errors.Name,r=e.Errors.Reference,s=e.Errors.Value,t=e.Errors.NotAvailable,u=e.Errors.Calc,v=e.Convert.Ca,w=e.Convert.Fh,x=l.Nb,y=d.Common.j,z=y.Fa,A=Math.min,B="cellListeners",C="rowSliceListeners",D="nameIDListeners",E="number",F="string",G="boolean",b.approximatelyEqual=function(a,b,c){if(void 0===a&&(a=0),void 0===b&&(b=0),a===b||i(a,e.CalcError)&&i(b,e.CalcError)&&a._code===b._code)return!0;var d=1;return i(a,Date)&&i(b,Date)?d=864e5:i(a,Date)?a=m.Ra(a):i(b,Date)&&(b=m.Ra(b)),p(b-a)/d<c};function T(a,b){var c,d,e,f=a.ah&&a.ah.getSource();f&&(c=a.row,d=a.column,e=f.getValue(c,d),f.setValue(c,d,b,e))}b.supportRowColumnFormula=!1,H=function(){function a(a){this.Ze=[],this.ah=a}return a.prototype.getKey=function(){return""},a.prototype.hasListeners=function(){var a,b,c,d,e,f=this,g=f.Ze;for(a=0,b=g;a<b.length;a++)if(c=b[a],d=this[c])for(e in d)if(d[e])return!0;return!1},a.prototype.gmb=function(a,b,c){var d,e,f=this[a],g=b.getKey();b.LDc&&b.LDc.length>=1&&(d=b.LDc,e=d[d.length-1],e.push(this),g="?"+g),f||(this.Ze.push(a),f=this[a]={}),c?f[g]=b:delete f[g]},a.prototype.lWc=function(a,b,c){var d=this[a],e=b.getKey();e="!"+e,d||(this.Ze.push(a),d=this[a]={}),c?d[e]=b:delete d[e]},a.prototype.Yg=function(){var a,b,c,d,e,f,g=[];for(a=0;a<arguments.length;a++)g[a]=arguments[a];for(b=this.Ze,d=0;d<b.length;d++)if(e=this[b[d]])for(f in e)c=e[f],c&&c.bh()},a.prototype.Bg=function(){var a,b,c,d,e,f,g=[];for(a=0;a<arguments.length;a++)g[a]=arguments[a];for(b=this.Ze,d=0;d<b.length;d++)if(e=this[b[d]])for(f in e)c=e[f],!c||c.dh||c.eh||c.fh()},a.prototype.gh=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=[];for(a=0;a<arguments.length;a++)m[a]=arguments[a];for(b=m[0],c=this.Ze,d=b?1:-1,e=0;e<c.length;e++)if(f=this[c[e]])for(g in f)if(h=f[g],"?"===g[0]){if(b||!this.MDc)continue;for(;this.MDc.indexOf(h)>=0;)this.MDc.splice(this.MDc.indexOf(h),1),h.delay--}else h&&(h.delay+=d,b&&h.y$a&&h.y$a());if(i=this.node&&this.node.Pf,i&&i.isDynamicArray)for(j=0;j<i.rowCount;j++)for(k=0;k<i.colCount;k++)0===j&&0===k||(l=this.ah.getNode(j+i.row,k+i.col),l&&l.calc&&l.calc.gh(b))},a.prototype.bh=function(){},a.prototype.fh=function(){},a.prototype.ng=function(){},a.prototype.og=function(){},a.prototype.ZAb=function(){return this.ah.Cf()},a}(),b.BaseCalc=H,I=function(a){S(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d.delay=0,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.og=function(){var a=this;a.ah.Og(a.name,!0)},b.prototype.ng=function(){var a=this;a.ah.Og(a.name,!1)},b.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},b.prototype.fh=function(){this.ZAb().pg(this,3)},b}(H),b.NameIDCalc=I,J=function(a){S(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.id=c,e.name=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this;return a.ah.getName()+","+a.id+"#"+a.name},b.prototype.og=function(){var a=this;a.ah.Ig(a.id,a.name,!0)},b.prototype.ng=function(){var a=this;a.ah.Ig(a.id,a.name,!1)},b.prototype.ZAb=function(){return this.ah.Af},b.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},b.prototype.fh=function(){this.ZAb().pg(this,6)},b}(H),b.PathCalc=J,K=function(){function a(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.mh=0,this.Bka=0,this.hmb=[];var a=this;a.kh=new g.Parser,a.lh=new h.Evaluator(a),a.nh=a.uzb&&a.uzb(),a.addResolver(new g.DefaultTokenResolver)}return a.prototype.getResolvers=function(){return this.hmb},a.prototype.addResolver=function(a){var b,c=this.hmb;for(b=0;;b++)if(!c[b]||a.priority>c[b].priority){c.splice(b,0,a);break}},a.prototype.dispose=function(){var a=this;a.jh={},a.oh=n},a.prototype.cloneFrom=function(a){var b=this;b.useR1C1=a.useR1C1,b.mh=a.mh,b.qh=a.qh,b.calcOnDemand=a.calcOnDemand},a.prototype.ih=function(){return this.nh},a.prototype.getExternalSource=function(a,b){var c,d,e=this,f=e.getAllSourceModels();for(c=0,d=f.length;c<d;c++)if(l.Mb(f[c].getSource().getName(),b))return f[c].getSource();return n},a.prototype.getSourceModel=function(a){var b=this.jh[a.id];return b||(b=a.createSourceModel?a.createSourceModel(this):this.createSourceModel(this,a),this.jh[a.id]=b,a.setCalcSourceModel(b),a.setCalcService(this)),b},a.prototype.getGlobalSourceModel=function(a){return this.oh||(a=a||new e.CalcSource,a.createSourceModel?this.oh=a.createSourceModel(this):this.oh=this.createSourceModel(this,a),a.setCalcSourceModel(this.oh)),this.oh},a.prototype.setSourceModel=function(a,b){this.jh[a.id]=b,b.setCalcService(this)},a.prototype.getAllSourceModels=function(){var a,b=[],c=this.jh;for(a in c)b.push(c[a]);return b},a.prototype.removeSource=function(a){var b,c,d,e,f,g;this.suspend(),b=this.jh[a.id],b&&(""!==a.getName()&&this.onRemoveSource(a),delete this.jh[a.id]),this.clearDirties(),c=this.jh;for(e in c)d=c[e],d.addDirtyNodesForCalc(!0);f=this.Dh&&this.Dh.kj,g=a&&a.kj,f&&g&&g===f&&(this.Dh=null),this.resume(!1)},a.prototype.clearSource=function(){this.jh={},this.Dh=null,this.clearDirties()},a.prototype.ignoreDirty=function(){return this.qh},a.prototype.suspend=function(a){this.mh++,this.qh=!!a},a.prototype.resume=function(a){var b=this;b.mh--,b.mh<0&&(b.mh=0),b.IsSuspended()||(b.rh=n,b.qh=!1,b.recalculateAll(a))},a.prototype.suspendAdjust=function(){this.Bka++},a.prototype.resumeAdjust=function(){var a=this;a.Bka--,a.Bka<0&&(a.Bka=0)},a.prototype.isAdjustSuspended=function(){return this.Bka>0},a.prototype.clearDirties=function(){var a,b,c,d=this,e=d.imb;if(e)for(a in e)if(e.hasOwnProperty(a))for(b=e[a];b;)c=b.eh,c?(b.$l=!1,b.eh=c.dh=o,b=c):b=n;d.imb=d.jmb=n},a.prototype.resumeWithoutCalc=function(){this.mh--,this.mh<0&&(this.mh=0),this.clearDirties(),
this.qh=!1},a.prototype.IsSuspended=function(){return this.mh>0},a.prototype.recalculateAll=function(a,b){var c=this;c.IsSuspended()||(c.nYc(a,b),c.n7c&&(c.n7c.forEach(function(a){a[0].Ag(a[1].row,a[1].col,a[1].rowCount,a[1].colCount)}),c.nYc(!1,!0),delete c.n7c))},a.prototype.processDynamicRef=function(){var a,b,c,d,e,f,g,h,i,j=this;if(j.m7c){if(a=j.imb,b=null,a)for(b=[],c=void 0,d=a[0];d;d=c)b.push(d),c=d.eh;e=j.jh;for(f in e)g=e[f],g.addDirtyNodesForCalc(!0,!1);if(a=j.imb)for(c=void 0,d=a[0];d;d=c)c=d.eh,j.Bh(d,0);for(h in j.m7c)j.m7c.hasOwnProperty(h)&&(i=j.m7c[h],g=j.jh[i.id],g&&g.processDynamicListenerForCell(i.row,i.col));delete j.m7c,b&&b.length>0&&b.forEach(function(a){j.pg(a,0)})}},a.prototype.nYc=function(a,b){var c,d,e,f=this;f.CIb=Date.now(),a&&f.imb&&delete f.m7c,b||f.lh.startCache(),d=f.jh;for(e in d)c=d[e],c.getSource().startCalculation(),c.addDirtyNodesForCalc(a,b);f.Gg(!0,a);for(e in d)c=d[e],c.getSource().endCalculation();b||f.lh.endCache(),delete f.CIb},a.prototype.k7c=function(){var a,b,c,d,e,f,g,h,i,j,k,l,n,p,q,r,s,t,u=this,v=u.imb;for(a=v[0];a;a=a.eh)a.isVolatile&&(b=a.row,c=a.column,d=a.ah,e=d.xf,f=d.BTa(b,c)||d.ATa(b,c),g=!0,f&&(h=ia(b,c),i=e.getValue(b,c),j=!1,k=o,l=o,n=o,p=o,q=d.Qf(b,c),q&&q.isDynamicArray!==!0&&(j=!0,k=q.row,l=q.col,n=q.rowCount,p=q.colCount),r=u.Hg(e,f,h,j,!0,q&&q.isDynamicArray!==!0&&ja(k,l,n,p),u.allowDynamicArray),a.kOb||a.eOb?g=!0:(s="hyperlink",i!==r||"string"==typeof r&&r[s]?i instanceof Date?r instanceof Date&&i.valueOf()===r.valueOf()?g=!1:typeof r===E&&(t=m.Ra(i),t===r&&(g=!1)):typeof i===E&&typeof r===E&&(g=i!==r):g=!1)),f&&!g&&u.Bh(a,0))},a.prototype.Gg=function(a,b){var c,d,e,f,g,h,i=this,j=i.imb;if(j){if(i.processDynamicRef(),i.calcOnDemand||!a||b||i.k7c(),a){e=j[1]||j[2];for(c in j)j.hasOwnProperty(c)&&(f=parseInt(c),e&&1!==f&&2!==f||(d=j[c],d&&(d.ah.addListenersToDirty(i,f),d.processed=!0)));for(c in j)j.hasOwnProperty(c)&&(d=j[c],d&&(d.processed?delete d.processed:d.ah.addListenersToDirty(i,parseInt(c))))}for(c in j)j.hasOwnProperty(c)&&j[c].ah.initDelay(i,parseInt(c));for(c in j)j.hasOwnProperty(c)&&j[c].ah.adjustDelayOfListeners(i,parseInt(c),!0);do{g=!1;for(c in j)j.hasOwnProperty(c)&&(h=j[c].ah.calculateDirtyNodes(i,parseInt(c)),h&&(g=!0))}while(g);for(c in j)j.hasOwnProperty(c)&&j[c].ah.calculateIterations(i,parseInt(c));i.imb=i.jmb=o}},a.prototype.initParserContext=function(a){var b=this.Dh;b||(this.Dh=a.getParserContext(this.useR1C1))},a.prototype.getParserContext=function(a){var b=this,c=b.Dh;return c||(a?b.Dh=c=a.getParserContext(b.useR1C1):c=new g.ParserContext(n,b.useR1C1)),c.setSource(a),c},a.prototype.parseWithContext=function(a,b){return this.kh.parse(a,b)},a.prototype.unparseWithContext=function(a,b){return this.kh.unparse(a,b)},a.prototype.pg=function(a,b){var c,d,e,f,g=this;isNaN(b)||(e=g.imb,f=g.jmb,e||(e=g.imb={},f=g.jmb={}),c=e[b],d=f[b],a.$l=!0,a&&!a.dh&&a!==c&&(c?d.eh=a:e[b]=a,a.dh=d,a.eh=n,f[b]=a))},a.prototype.Bh=function(a,b){var c,d,e,f,g,h=this;isNaN(b)||(a.$l=!1,d=h.imb,e=h.jmb,d&&(c=h.imb[b]),a&&(a.dh||a===c)&&(f=a.dh,g=a.eh,f?f.eh=g:d&&(g?d[b]=g:delete d[b]),g?g.dh=f:e&&(f?e[b]=f:delete e[b]),a.dh=n,a.eh=n))},a.prototype.evaluateExpression=function(a,b,c){var d=this;return d.lh.evaluateExpression(b,a.getEvaluatorContext(c,!1),!1)},a.prototype.onClearExpr=function(a,b){this.lh&&this.lh.asyncManager.clearCell(a,b)},a.prototype.parse=function(a,b,c,d,e,f,g){var h,i,j=this,k=j.rh,l=j.getParserContext(a);return l.useR1C1=!g&&j.useR1C1,l.ignoreError=f,l.row=c,l.column=d,l.culture=e,k?(h=k[b])?h:(i=j.kh.parse(l,b),k[b]=i,i):j.kh.parse(l,b)},a.prototype.unparse=function(a,b,c,d,e,f,g){var h,i=this.getParserContext(a);return i.useR1C1=this.useR1C1,i.row=c,i.column=d,i.culture=e,i.addSheetName=g,f&&(i.Eh=!0,i.useR1C1=!1),h=this.kh.unparse(i,b),i.Eh=!1,h},a.prototype.recalculate=function(a,b,c,d){var e=this.getSourceModel(a);c===-1?e.Ag(b,0,1,e.cC()):b===-1?e.Ag(0,c,e.rC(),1):e.Ag(b,c,1,1),this.IsSuspended()||this.recalculateAll(!1,d)},a.prototype.recalculateByName=function(a,b){var c,d;b&&(c=U(this,a),d=c.mg(x(b),!0),this.pg(d,3),this.IsSuspended()||this.recalculateAll(!1))},a.prototype.recalcRange=function(a,b,c,d,e){var f=this.getSourceModel(a);c===-1?f.Ag(b,0,d,f.cC()):b===-1?f.Ag(0,c,f.rC(),e):f.Ag(b,c,d,e),this.IsSuspended()||this.recalculateAll(!1)},a.prototype.evaluate=function(a,b,c,d,f){var g=this,h=b instanceof e.Expression?b:g.parse(a,b,c,d);return g.lh.evaluateExpression(h,a.getEvaluatorContext(ia(c,d),!1),!1,f,f)},a.prototype.Hg=function(a,b,c,d,f,g,h,i){var j,k,l,m,p,q,r,u,v,w,x,y,A,B,C,D;if(!z(b)){if(j=c.row||0,k=c.col||0,l=g?g.row:j,m=g?g.col:k,p=a.getEvaluatorContext(c,d,g,b),p.NMc=i,r=4===arguments.length&&d||h,this.allowDynamicArray&&!d&&(p.Exb=!0),q=this.lh.evaluateExpression(b,p,f,r,r),q&&q.pause)return q;if(a.ODc){for(u=0;u<a.ODc.length;u++)delete a.ODc[u].PDc;delete a.ODc}if(d&&arguments.length<=5)return q;if(!d&&h&&(e.Convert.Fh(q)||e.Convert.Ca(q)))return q;if(e.Convert.Fh(q)){if(v=q.getRowCount(0),w=q.getColumnCount(0),1!==q.getRangeCount())return s;try{if(x=d?j-l:j-q.getRow(0),y=d?k-m:k-q.getColumn(0),A=ia(0,0),1===v&&1===w);else if(1===v&&w>1&&y>=0&&y<w)A.col=y;else if(v>1&&1===w&&x>=0&&x<v)A.row=x;else{if(!(d&&x<v&&y<w))return d?t:s;A.row=x,A.col=y}q=q.getValue(A,0)}catch(a){return s}}else if(e.Convert.Ca(q))if(d){if(B=q,C=B.getRowCount(),D=B.getColumnCount(),1!==C&&j-l>=C||1!==D&&k-m>=D)return t;q=q.getValue(1===C?0:j-l,1===D?0:k-m)}else q=q.getValueByIndex(0);return q===o||q===n?f===!1?q:0:q}},a.prototype.onAddAdjust=function(a,b){this.nh.hh(a,b)},a.prototype.onRemoveSource=function(a){this.nh.ph(a)},a.prototype.createSourceModel=function(a,b){return new M(a,b)},a.prototype.NHb=function(){var a,b,c,d=this.jh;for(a in d)b=d[a],b instanceof M&&(c=b.getAllNodes(),c.forEach(function(a){var b=a.calc;b&&(b.$l=!1,(b.eh||b.dh)&&(b.dh=b.eh=n))}))},a}(),b.CalcService=K;function U(a,b){return a.getSourceModel(b)}function V(a,b){var c,d,e,f,g,h;if(a)for(c in a)if(d=+c,e=a[c])for(f in e)g=+f,h=e[f],h&&b.setValue(d,g,h.value,h.oldValue,h.isAnchorCell!==!0)}b.setSpillValues=V;function W(a,b){return[a,b].join(",")}function X(a,b){var c=b.split(",").map(function(a){return+a}),d=c[0],e=c[1],f=a[d];return f&&f[e]}function Y(a,b,c){if(a){var d=c.anchors,e={};a.forEach(function(a){var f,g,h,i,j,k,l,m,n=a.row,o=a.col,p=W(n,o);for(b.Ag(n,o,1,1),e[p]=!0,f=a.rowCount,g=a.colCount,h=1,i=0;i<f;i++){for(;h<g;h++)if(j=c.getAnchorItem(i+n,h+o)){k=j.anchorRefs;for(l in k)p!==l&&k[l]&&(m=X(d,l),m&&!e[l]&&(b.Ag(m.row,m.col,1,1),e[l]=!0))}h=0}})}}b.markAnchorCellDirty=Y,L=function(){function a(){}return a.getLength=function(a,b){return v(a)?a.getRowCount()*a.getColumnCount():w(a)?(b=b?b:0,a.getRowCount(b)*a.getColumnCount(b)):void 0},a.getRowCount=function(a,b){return v(a)?a.getRowCount():w(a)?(b=b?b:0,a.getRowCount(b)):void 0},a.getColumnCount=function(a,b){return v(a)?a.getColumnCount():w(a)?(b=b?b:0,a.getColumnCount(b)):void 0},a.getValueByIndex=function(a,b,c){if(v(a))return a.getValueByIndex(b);if(w(a)){c=c?c:0;var d=a.getColumnCount(c);return a.getValue(c,parseInt(""+b/d,10),b%d)}},a.getValue=function(a,b,c,d){return v(a)?a.getValue(b,c):w(a)?(d=d?d:0,a.getValue(d,b,c)):void 0},a}(),b.CalcArrayHelper=L;function Z(a,b,c,d,e,f){$(a.kOb,a.eOb)&&(a.kOb&&(aa(c,a,a.kOb,!1),delete a.kOb),a.eOb&&(a.delay=aa(c,a,a.eOb,!0,f),a.kOb=a.eOb,delete a.eOb))}function $(a,b){return(!z(a)||!z(b))&&(!(!z(a)&&!z(b))||Object.keys(a).join()!==Object.keys(b).join())}function _(a,b,c,d,e,f,g,h,i){var j,k,l,m=0;for(j=0;j<e;j++)for(k=0;k<f;k++)l=b.qg(j+c,k+d,!0),g&&l&&l.lWc(0,a,h),i&&l&&l.$l&&m++;return m}function aa(a,b,c,d,e){var f,g,h,i,j,k=0;for(f in c)if(c.hasOwnProperty(f)){if(g=!1,h=c[f],i=a.jh[h.id],!i)continue;i&&ka(h)&&(j=i.ug(!0),j.Jg(h.rowUndefine?-1:h.row,h.colUndefine?-1:h.col,h.rowUndefine?-1:h.rowCount,h.colUndefine?-1:h.colCount,b,d,!0),g=!0),!i||g&&!e||(k+=_(b,i,h.row,h.col,h.rowCount,h.colCount,!g,d,e))}return k}M=function(){function a(a,b){this.Ef=0,this.Ff=0,this.Gf=[],this.OMc=[],this.qhc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;var c=this;c.xf=b,c.Af=a}return a.prototype.getNode=function(a,b,c){var d,e=this,f=n;return a>=0&&b>=0?(d=e.dataTable[a],c&&!d&&(d=e.dataTable[a]={},a>e.Ef&&(e.Ef=a)),d&&(f=d[b],c&&!f&&(f=d[b]={},b>e.Ff&&(e.Ff=b)))):a===-1&&b>=0?(f=e.If[b],c&&!f&&(f=e.If[b]={},b>e.Ff&&(e.Ff=b))):a>=0&&b===-1?(f=e.Hf[a],c&&!f&&(f=e.Hf[a]={},b>e.Ff&&(e.Ff=b))):a===-1&&b===-1&&(f=e.Jf,c&&!f&&(f=e.Jf={})),f},a.prototype.getNodeByName=function(a,b){var c=this,d=c.dataTableByName[a];return b&&!d&&(d=c.dataTableByName[a]={}),d},a.prototype.Kf=function(a,b){var c=this.getNode(a,b);return c&&c.Lf},a.prototype.Mf=function(a,b){var c=this.getNode(a,b);return c&&c.Nf},a.prototype.Qf=function(a,b){return this.getWorkingNodeInfo(a,b,2)},a.prototype.BTa=function(a,b){return this.getWorkingNodeInfo(a,b,1)},a.prototype.ATa=function(a,b){return this.getWorkingNodeInfo(a,b,0)},a.prototype.CTa=function(a){var b=this.getNodeByName(a);return b&&b.Nf},a.prototype.DTa=function(a){var b=this.getNodeByName(a);return b&&b.Lf},a.prototype.clearAll=function(){var a=this;a.clear(-1,-1,-1,-1),a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=n},a.prototype.clear=function(a,b,c,d,e){this.$b(a,b,c,d,e)},a.prototype.rzb=function(){var a=this;da(a.Hf),da(a.If),da(a.dataTable,!0),da(a.dataTableByName),a.eHb()},a.prototype.eHb=function(){var a=this;a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=n,a.Gf=[],a.OMc=[],a.vg=n,a.xg=n},a.prototype.addRows=function(a,b){var c,d=this,e=d.rC();if(!(a<0||a>e||b<0))for(j(d.dataTable,e,a,b),j(d.Hf,e,a,b),c=0;c<b;c++)d.dataTable[a+c]&&(d.dataTable[a+c]={rs:"n"})},a.prototype.deleteRows=function(a,b){var c=this,d=c.rC();a<0||a>=d||b<=0||(a+b>d&&(b=d-a),k(c.dataTable,d,a,b),k(c.Hf,d,a,b))},a.prototype.addColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>g||b<0)){for(c=0;c<f;c++)d=e.dataTable[c],d&&a<g&&j(d,g,a,b);j(this.If,g,a,b)}},a.prototype.deleteColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>=g||b<0)){for(c=0;c<f;c++)d=this.dataTable[c],d&&k(d,g,a,b);k(this.If,g,a,b)}},a.prototype.ETa=function(a,b,c){var d,e,f=[a,b];return c&&(f.newValue=c),d=this.getNode(a,b),d&&(d.Lf&&(e=d.Pf,(!e||e&&e.row===a&&e.col===b)&&this.getSource().setFormula(a,b,this.getFormula(a,b),e,!0)),f.push(d.Lf,d.Nf,d.Pf)),f},a.prototype.FTa=function(a,b,c,d){a&&a.push(this.ETa(b,c,d))},a.prototype.dUa=function(){var a=this.getSource(),b=a&&a.getSheet(),c=b&&b.ITa;return c&&c.dUa()},a.prototype.$Va=function(a,b,c,d,e){var f=this;a===-1?f.kg(b,c,d):b===-1?f.jg(a,c,d):f.ig(a,b,c,d,e)},a.prototype.Rf=function(a,b,c,d){var e=this.getNode(a,b,!!c);e&&(d&&d.push([a,b,e.Lf]),e.Lf=c)},a.prototype.GTa=function(a,b,c,d,e,f,g){var h=this.getNode(a,b,!!c);h&&(this.FTa(g,a,b),h.Lf=c,(h.Nf||d)&&(h.Nf=d),(h.Pf||e)&&(h.Pf=e),h.isVolatile&&!c?this.Tf(h):(f||h.isVolatile)&&(h.isVolatile=f))},a.prototype.Sf=function(a,b,c){this.GTa(a,b,o,o,o,!1,c)},a.prototype.Uf=function(a,b,c,d,e,f){var g=this.getNode(b,c);g&&g.Lf&&a.GTa(d,e,g.Lf,g.Nf,g.Pf,g.isVolatile,f)},a.prototype.ega=function(a,b){var c=this.dataTable[a];return c&&c[b]},a.prototype.Wf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Nf=c)},a.prototype.Xf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Pf=c)},a.prototype.Yf=function(a,b){var c=this.getNode(a,b);return c&&c.calc},a.prototype.Zf=function(a,b,c){var d=this.getNode(a,b,!0);d&&(d.calc&&d.calc.isVolatile&&this.Tf(d),d.calc&&d.calc.isPivotData&&this.PMc(d),d.calc=c,c&&(c.node=d))},a.prototype.Q3=function(a,b,c){var d=this.getNode(a,b,!0);d&&d.calc&&(d.calc.isVolatile&&this.Tf(d),d.calc.isPivotData&&this.PMc(d),this.Af.Bh(d.calc,c),d.calc=o)},a.prototype.$f=function(a,b,c,d,e){var f,g=this;c>=0&&d>=0?(f=g.dataTable[c],f||(f=g.dataTable[c]={}),f[d]=e,e&&e.calc&&delete e.calc):c>=0&&d===-1&&a>=0&&b===-1?g.Hf[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(g.If[d]=e)},a.prototype._f=function(a,b,c,d){var e=this,f=e.getNode(a,b),g=e.getNode(c,d);f&&f.Lf?e.$f(a,b,c,d,f):g&&g.Lf&&e.$f(a,b,c,d,n),g&&g.Lf?e.$f(c,d,a,b,g):f&&f.Lf&&e.$f(c,d,a,b,n)},a.prototype.rhc=function(a,b,c){a.isIterativeCalc||(a.isIterativeCalc=!0,this.qhc.push(a),b||T(a,c))},a.prototype.shc=function(a){delete a.isIterativeCalc},a.prototype.thc=function(){var a,b=this,c=[],d=b.qhc,e=b.qhc.length;for(a=0;a<e;a++)d[a].isIterativeCalc&&c.push(d[a]);return b.qhc=c,b.qhc},a.prototype.lmb=function(){return this.Gf},a.prototype.QMc=function(){return this.OMc},a.prototype.bg=function(a){a.isVolatile||(a.isVolatile=!0,this.Gf.push(a))},a.prototype.RMc=function(a){a.isPivotData||(a.isPivotData=!0,this.OMc.push(a))},a.prototype.Tf=function(a){var b,c,d,e,f;if(a.isVolatile=o,b=this,b.B5++,b.B5>100){for(b.B5=0,c=[],d=b.Gf,e=b.Gf.length,f=0;f<e;f++)d[f].isVolatile&&c.push(d[f]);b.Gf=c}},a.prototype.PMc=function(a){var b,c,d,e,f;for(a.isPivotData=void 0,b=this,c=[],d=b.OMc,e=b.OMc.length,f=0;f<e;f++)d[f].isPivotData&&c.push(d[f]);b.OMc=c},a.prototype.getCalcService=function(){return this.Af},a.prototype.setCalcService=function(a){this.Af=a},a.prototype.Cf=function(){return this.Af},a.prototype.getSource=function(){return this.xf},a.prototype.hasFormula=function(a,b){return a=a!==o?a:-1,b=b!==o?b:-1,!!this.ATa(a,b)},a.prototype.setFormula=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,p,q=this;if(c&&0===c.length&&(c=n),!e&&q.dg(a,b,1,1)&&q.eg(),i=q.getFormula(a,b),j=q.Qf(a,b),f||i!==c&&(""!==i||c)&&(i||""!==c)||i===c&&j){if(k=q.Cf(),l=n,k)try{m=a>=0?a:0,p=b>=0?b:0,l=d||(c?k.parse(q.xf,c,m,p,!1,e):n),q.fg(a,b,l,o,!1,g,h)}catch(a){if(!e)throw a}a>=0&&b>=0&&q.xf.setFormula(a,b,c,o)}},a.prototype.getFormula=function(a,b,c){var d,e,f=this.Cf();return f&&(d=this.ATa(a,b))?(e=this.Qf(a,b),a=e&&e.isDynamicArray!==!0?e.row:a,b=e&&e.isDynamicArray!==!0?e.col:b,f.unparse(this.xf,d,a,b,c)):n},a.prototype.setFormulaByName=function(a,b,c,d,e){var f,g,h,i;if(a&&(a=x(a),f=this,b&&0===b.length&&(b=n),g=f.getFormulaByName(a),g!==b&&(""!==g||b)&&(g||""!==b))){if(h=f.Cf(),i=n,h)try{i=b?h.parse(f.xf,b,0,0,!1,c):n,f.gg(a,i,o,!1,d,e)}catch(a){if(!c)throw a}f.xf.setFormula({name:a},b)}},a.prototype.getFormulaByName=function(a){var b,c=this.Cf();return c&&a&&(b=this.DTa(x(a)))?c.unparse(this.xf,b,0,0):n},a.prototype.eg=function(){throw e.sR().Exp_ArrayFromulaPart},a.prototype.rC=function(){return A(this.xf.getRowCount())},a.prototype.cC=function(){return A(this.xf.getColumnCount())},a.prototype.setArrayFormula=function(a,b,c,d,e,f,g,h){var i,j,k,l,m=this;if(e&&0===e.length&&(e=n),m.dg(a,b,c,d)&&m.eg(),a=a<0?0:a,b=b<0?0:b,j=m.Cf()){if(m.$b(a,b,c,d,g),e){try{i=e?j.parse(m.xf,e,a,b,!1,f,f):n}catch(a){if(!f)throw a;return}for(k=a;k<a+c;k++)for(l=b;l<b+d;l++)m.fg(k,l,i,ja(a,b,c,d),!1,g,h)}a>=0&&b>=0&&m.xf.setArrayFormula(a,b,c,d,j.unparse(m.xf,i,a,b))}},a.prototype.getWorkingNodeInfo=function(a,b,c){var d,e=this,f=e.xf;return a>=f.getRowCount()||b>=f.getColumnCount()?d:(a>=0&&b>=0?(d=e.getNode(a,b),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(a,-1)),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(-1,b))):d=a>=0&&b===-1?e.getNode(a,-1):a===-1&&b>=0?e.getNode(-1,b):e.getNode(-1,-1),d&&(0===c&&d.Lf||1===c&&d.Nf||2===c&&d.Pf))},a.prototype.fg=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,p,q,r,s,t=this,u=t.Cf();u.nia&&u.lh.asyncManager.endCalcCell(),i=d!==o&&null!==d,j=i?d.row:a,k=i?d.col:b,l=t.xf,m=new h.EvaluateContext(l,ia(j,k),i),n=u.allowDynamicArray?ga(m,c,i,i?a-d.row:0,i?b-d.col:0,!0,!0):fa(m,c,i,i?a-d.row:0,i?b-d.col:0),p=m.iOb,p&&(delete m.iOb,1===p&&(q=u.unparse(l,c,j,k),c=u.parse(l,q,j,k))),n=n===c?o:n,d!==o&&(r=d),a>=0&&b>=0?((e===o||e)&&(s=c?u.unparse(l,c,a,b):o,t.xf.setFormula(a,b,s,r)),t.ig(a,b,c,n,r,f,g)):a>=0&&b===-1?t.jg(a,c,n,f,g):a===-1&&b>=0&&t.kg(b,c,n,f,g),u.autoCalculation&&!u.IsSuspended()&&u.recalculateAll(!1)},a.prototype.gg=function(a,b,c,d,e,f){var g,i,j=this,k=j.Cf(),l=new h.EvaluateContext(j.xf,ia(0,0),(!1)),m=ga(l,b,!1,0,0);m=m===b?o:m,d!==o&&!d||e||(g=j.getFormulaByName(a),i=b?k.unparse(j.xf,b,0,0):o,j.xf.setFormulaByName&&j.xf.setFormulaByName(a,i,g)),j.lg(a,b,m,null,f),k.autoCalculation&&!k.IsSuspended()&&(e||k.recalculateAll(!1))},a.prototype.getRowExpression=function(a){return this.Kf(a,-1)},a.prototype.getColumnExpression=function(a){return this.Kf(-1,a)},a.prototype.lg=function(a,b,c,d,e){var f,g=this,h=g.mg(a,!0);h&&(e||h.ng(),f=this.getNodeByName(a,!0),f.Lf=b,d&&(d[0].push("dataTable",a),d[1]=f.Lf),c=b&&c?c:o,f.Nf=c,e||h.og(),h.fh())},a.prototype.ig=function(a,b,c,d,e,f,g){var h,i=this,j=i.qg(a,b,!0);j&&(i.FTa(f,a,b),h=i.Af,h.onClearExpr(i.xf,ia(a,b)),aa(h,j,j.kOb,!1),delete j.kOb,delete j.eOb,j.ng(),i.Rf(a,b,c),c?((d||i.Mf(a,b))&&i.Wf(a,b,d),e&&e.isDynamicArray===!0||i.Xf(a,b,e)):(i.Wf(a,b,o),i.Xf(a,b,o)),j.og(),j.fh())},a.prototype.jg=function(a,b,c,d,e){var f=this,g=f.rg(a,!0);g&&(f.FTa(d,a,-1),e||g.ng(),f.Rf(a,-1,b),(c||f.Mf(a,-1))&&f.Wf(a,-1,c),e||g.og(),g.fh())},a.prototype.kg=function(a,b,c,d,e){var f=this,g=f.sg(a,!0);g&&(f.FTa(d,-1,a),e||g.ng(),f.Rf(-1,a,b),(c||f.Mf(-1,a))&&f.Wf(-1,a,c),e||g.og(),g.fh())},a.prototype.$b=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=a<0?0:a,m=b<0?0:b,p=a<0?k.rC():c,q=b<0?k.cC():d,r=l+p-1,s=m+q-1,t=function(a,b){if(f=k.Mf(a,b),g=k.Kf(a,b),f||g){h=k.Qf(a,b);var c=h&&h.isDynamicArray!==!0?ja(h.row,h.col,h.rowCount,h.colCount):o;k.fg(a,b,n,c,!0,e)}};for(i=l;i<=r&&i>=0;i++)for(b<0&&t(i,-1),j=m;j<=s&&j>=0;j++)i===l&&a<0&&t(-1,j),t(i,j);a<0&&b<0&&t(a,b)},a.prototype.dg=function(a,b,c,d){return this.tg(a,b,c,d,!0,!0)},a.prototype.tg=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=this,p=a<0?0:a,q=b<0?0:b,r=a<0?o.rC():c,s=b<0?o.cC():d,t=p+(0===r?1:r)-1,u=q+(0===s?1:s)-1,v=!1,w=[],x=[],y=o.dataTable;for(i=p;i<=t&&i>=0&&!(i>o.Ef);i++)if(h=y[i])for(j=q;j<=u&&j>=0&&!(j>o.Ff);j++)if(g=h[j])if(k=g.Pf,l=void 0,k&&!k.isDynamicArray){if(k.row<p||k.row+k.rowCount-1>t||k.col<q||k.col+k.colCount-1>u){if(e)return m=k.row===a&&0===c,n=k.col===b&&0===d,!m&&!n;v=!0}if(i!==k.row&&i!==p)continue;w.push(ja(k.row,k.col,k.rowCount,k.colCount)),l=g.Lf,x.push(l),j=k.col+k.colCount-1}else f||(l=g.Lf,l&&(w.push({row:i,col:j}),x.push(l)));return!e&&{hasPart:v,ranges:w,formulas:x}},a.prototype.getCalcObj=function(){var a,b,c,d,e,f,g,h,i,j,k,l=[];for(a=0;a<arguments.length;a++)l[a]=arguments[a];if(b=l[0],c=l[1],d=this,e=b.row,f=b.column,g=null,isNaN(e)||isNaN(f))b.name&&(g=d.mg(b.name,c));else if(e>=0&&f>=0)if(b.sf())g=d.qg(e,f,c);else for(h=b.endRow,i=b.endColumn,g=[],j=e;j<=h;j++)for(k=f;k<=i;k++)g.push(d.qg(j,k,c));else e>=0?g=d.rg(e,c):f>=0&&(g=d.sg(f,c));return g},a.prototype.mg=function(a,b){var c=this,d=n,e=c.getNodeByName(a,b);return e&&(d=e.calc,!d&&b&&(d=new I(c,a),e.calc=d,d.node=e)),d},a.prototype.oYc=function(a){var b,c,d=this;for(b in d.dataTable)for(c in d.dataTable[b])d.dataTable[b][c].calc&&a(d.dataTable[b][c].calc)},a.prototype.qg=function(a,b,c){var d,e,f,g=this,h=n;if(a>=0&&b>=0){if(d=g.dataTable,e=d[a],!e){if(!c)return h;e=d[a]={},a>g.Ef&&(g.Ef=a)}if(f=e[b],!f)return c&&(f=e[b]={},h=new N(g,a,b),f.calc=h,h.node=f,b>g.Ff&&(g.Ff=b)),h;h=f.calc,!h&&c&&(h=new N(g,a,b),f.calc=h,h.node=f,a>g.Ef&&(g.Ef=a),b>g.Ff&&(g.Ff=b))}return h},a.prototype.rg=function(a,b){var c=this,d=n;return a>=0&&(d=c.Yf(a,-1),!d&&b&&(d=new O(c,a),c.Zf(a,-1,d),a>c.Ef&&(c.Ef=a))),d},a.prototype.sg=function(a,b){var c=this,d=n;return a>=0&&(d=c.Yf(-1,a),!d&&b&&(d=new P(c,a),c.Zf(-1,a,d),a>c.Ff&&(c.Ff=a))),d},a.prototype.ug=function(a){var b=this;return!b.vg&&a&&(b.vg=new R(b)),b.vg},a.prototype.wg=function(a,b){var c,d=this;return a=x(a),d.xg||(d.xg={}),c=d.xg[a],!c&&b&&(c=d.xg[a]=new Q(d,a)),c},a.prototype.updateNameCalc=function(a,b){var c=this.wg(x(a));c&&(c.updateListening(!0,b),c.fh())},a.prototype.yg=function(a,b){var c,d,e=this,f=A(e.Ff,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(-1,c)&&(d=e.sg(c,!0),e.Af.pg(d,2))},a.prototype.zg=function(a,b){var c,d,e=this,f=A(e.Ef,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(c,-1)&&(d=e.rg(c,!0),e.Af.pg(d,1))},a.prototype.Ag=function(a,b,c,d){var e,f,g,h=this,i=null,j=A(h.Ef,a+c-1),k=A(h.Ff,b+d-1);for(e=a;e<=j;e++)for(f=b;f<=k;f++)h.ega(e,f)&&(h.Af.calcOnDemand?(i=h.qg(e,f,!1),i&&(i.Bg(),i.$l=!0)):(i=h.qg(e,f,!0),h.Af.pg(i,0)));h.zg(a,c),h.yg(b,d),g=h.ug(!1),g&&g.Bg(a,b,c,d)},a.prototype.uhc=function(){var a,b,c,d,e,f=this,g=f.lmb().concat(f.thc()).concat(f.QMc());for(c=0;c<g.length;c++)d=g[c],f.Af.calcOnDemand&&d&&(d.isVolatile||d.isIterativeCalc)&&(d.$l=!0,d.Bg()),d&&(d.isVolatile||d.isIterativeCalc||d.isPivotData)&&d instanceof N&&!f.Dg(d)&&(e=f.qg(d.row,d.column,!0),f.Af.pg(e,0),a=f.rg(d.row,!1),a&&!f.Eg(a)&&f.zg(d.row,1),b=f.sg(d.column,!1),b&&!f.Eg(b)&&f.yg(d.column,1))},a.prototype.Dg=function(a){var b=this.getCalcService().imb;return!!a.dh||a===(b&&b[0])},a.prototype.Eg=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[1])},a.prototype.isDirtyColumn=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[2])},a.prototype.isDirty=function(a,b){return!(!this.Yf(a,b)&&!this.Kf(a,b))},a.prototype.recalculateForContext=function(a,b,c){var d=this.Af,e=d.getSourceModel(a),f=b.row,g=b.col;g===-1?e.Ag(f,0,1,e.cC()):f===-1?e.Ag(0,g,e.rC(),1):e.Ag(f,g,1,1),d.IsSuspended()||d.recalculateAll(!1,c)},a.prototype.processDynamicListenerForCell=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.xf,n=l.BTa(a,b)||l.ATa(a,b);n&&(c=ia(a,b),d=!1,e=void 0,f=void 0,g=void 0,h=void 0,i=l.Qf(a,b),i&&i.isDynamicArray!==!0&&(d=!0,e=i.row,f=i.col,g=i.rowCount,h=i.colCount),j=l.Af,j.Hg(l.xf,n,c,d,!0,i&&i.isDynamicArray!==!0&&ja(e,f,g,h),j.allowDynamicArray,!1),k=l.xf.getCalcSourceModel().qg(a,b),Z(k,m,j,a,b,!1))},a.prototype.recalculateCell=function(a,b,c){var d,f,g,h,i,j,k,l,p,q,r,t,v,w,x,y,A,B,C,D,F,G,H,I=this,J=I.xf,K=I.BTa(a,b)||I.ATa(a,b),L=J,M=L.q$a,N=L&&L.kj&&L.kj.ITa;if(N&&(N.SIb=!0),f=!1,K){if(g=ia(a,b),h=J.getValue(a,b),i=!1,j=void 0,k=void 0,l=void 0,p=void 0,q=I.Qf(a,b),q&&q.isDynamicArray!==!0&&(i=!0,j=q.row,k=q.col,l=q.rowCount,p=q.colCount),r=I.Af,r.nia&&r.lh.asyncManager.startCalcCell(I.xf,g),t=r.Hg(I.xf,K,g,i,!0,q&&q.isDynamicArray!==!0&&ja(j,k,l,p),r.allowDynamicArray,c),c&&t&&t.pause)return t;if(v=I.xf.getCalcSourceModel().qg(a,b),Z(v,J,r,a,b,c),c&&v.delay>0)return{pause:"newDetectedRefs"};if(w=e.Convert.Fh(t)||e.Convert.Ca(t),x=!1,!i&&r.allowDynamicArray&&(K.hJc||!K.ensureSingle&&w)&&(l=t.getRowCount?t.getRowCount():1,p=t.getColumnCount?t.getColumnCount():1,y={row:a,col:b,rowCount:l,colCount:p,isDynamicArray:!0},x=!0,I.Xf(a,b,y),A=q&&q.rowCount||1,B=q&&q.colCount||1,(l>A||p>B)&&(r.n7c=r.n7c||[],r.n7c.push([I,y]))),f=!0,C=void 0,w&&(C=e.Convert.Ph(t,0,!1,!1,!1),C.isError||C.isConvertError?(t=s,w=!1):(l=C.rowCount,p=C.colCount,0===l||0===p?(t=u,w=!1):1===l&&1===p&&(t=C[0][0],z(t)&&(t=0),w=!1),x||(D=I.getNode(a,b),delete K.ensureSingle,K=D.Lf=e.Jh(e.Functions.findGlobalFunction("@"),[K]),D.Nf=o,t=K.function.evaluate({row:a,column:b},t),w=!1))),w)F=L.setArray(a,b,l,p,C),F&&V(F[1],L);else if(F=L.updateItem&&L.updateItem(a,b,t),F&&(V(F[0],L),d=F[1]),G="hyperlink",h!==t||"string"==typeof t&&t[G]){if(h instanceof Date){if(t instanceof Date&&h.valueOf()===t.valueOf())return!1;if(typeof t===E){if(H=m.Ra(h),H===t)return!1;t=m.Xb(t)}}J.setValue(a,b,t,h)}else f=!1;r.nia&&r.lh.asyncManager.endCalcCell(),L.Ppb&&L.Ppb(a,b)}else M||(F=L.updateItem&&L.updateItem(a,b,n),F&&(V(F[0],L),d=F[1]));return N&&(d&&Y(d,I,N.ZHb),N.SIb=!1),f},a.prototype.recalculateNameID=function(a){var b,c,d=this,e=d.xf,f=d.CTa(a)||d.DTa(a);if(f){if(b=e.getValueByName?e.getValueByName(a):e.getValue({name:a}),c=d.Af.Hg(d.xf,f,{name:a},!1,!0),b===c)return;if(b instanceof Date&&c instanceof Date&&b.valueOf()===c.valueOf())return;e.setValueByName?e.setValueByName(a,c):e.setValue({name:a},c)}},a.prototype.addDirtyNodesForCalc=function(a,b){var c,d,e=this;a!==!1?(c=e.cC(),d=e.rC(),e.yg(0,c),e.zg(0,d),e.Ag(0,0,d,c)):b||e.uhc()},a.prototype.addListenersToDirtyForRow=function(a){for(var b,c,d,e;a.imb[1];){for(b=a.imb[1],c=b.ah,d=c.cC(),e=0;e<d;e++)a.pg(c.qg(b.row,e,!0),0);a.Bh(b,1)}},a.prototype.addListenersToDirtyForCol=function(a){for(var b,c,d,e;a.imb[2];){if(b=a.imb[2],c=b.ah,d=c.rC(),d>0)for(e=0;e<d;e++)a.pg(c.qg(e,b.column,!0),0);else b.Bg();a.Bh(b,2)}},a.prototype.Ah=function(a,b){for(var c=a.length,d=b;d;)a[c]=d,c++,d=d.eh},a.prototype.addListenersToDirty=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(1===b)this.addListenersToDirtyForRow(a);else if(2===b)this.addListenersToDirtyForCol(a);else if(0===b)for(c=[],a.imb[2]&&this.Ah(c,a.imb[2]),d=a.imb[0];d;d=d.eh)for(e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.Bg(),h&&h.Bg(),i&&i.Bg(),j&&j.Bg(f,g,1,1),this.addListenersToDirtyForRow(a);a.imb[2];){for(k=a.imb[2],l=!1,m=0;m<c.length;m++)if(c[m]===k){l=!0;break}if(l)a.Bh(k,2);else{for(c[c.length]=k,e=k.ah,n=e.rC(),o=0;o<n;o++)a.pg(e.qg(o,k.column,!0),0);a.Bh(k,2)}}else if(3===b)for(p=a.imb[3];p;p=p.eh)p.Bg()},a.prototype.initDelay=function(a,c){var d,e,f,g,h,i,j;if(0===c)for(d=null,e=a.imb[0];e;e=d)e.kOb&&(aa(a,e,e.kOb,!1),delete e.kOb),d=e.eh,f=e.ah,g=f.rC(),h=f.cC(),e.row<g&&e.column<h?(b.supportRowColumnFormula&&(i=f.sg(e.column,!1),i&&(i.delay=0)),e.delay=0,delete e.MDc):a.Bh(e,0);else if(3===c)for(j=a.imb[3];j;j=j.eh)j.delay=0},a.prototype.adjustDelayOfListeners=function(a,b,c){var d,e,f,g,h,i,j,k;if(0===b)for(d=a.imb[b];d;d=d.eh)e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.gh(c),h&&h.gh(c),i&&i.gh(c),j&&j.gh(f,g,c);else if(3===b)for(k=a.imb[3];k;k=k.eh)k.gh(c)},a.prototype.calculateDirtyNodes=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(a.calcOnDemand)return!1;if(c=!1,d=null,0===b){for(f=a.imb[b];f;f=e)if(e=f.eh,f.delay<=0){if(this.shc(f),d=f.ah,g=f.row,h=f.column,i=d.rg(g,!1),j=d.sg(h,!1),j&&j.delay)continue;if(k=d.ug(!1),l=d.recalculateCell(g,h,!f.SMc||f.SMc<32),l&&l.pause){if(f.SMc=f.SMc?f.SMc+1:1,l.branch)for(e=f,m=0;m<l.branch.length;m++)(l.branch[m].dh||l.branch[m].eh||l.branch[m]===f)&&(f.delay++,n=l.branch[m],n.MDc=n.MDc||[],n.MDc.push(f))}else delete f.SMc,a.Bh(f,0),f.gh(!1),i&&i.gh(!1),j&&j.gh(!1),k&&k.gh(g,h,!1),o=f.node&&f.node.Lf,o&&o.ehc&&delete o.ehc;c=!0}}else if(3===b)for(p=a.imb[b];p;p=e)e=p.eh,0===p.delay&&(d=p.ah,d.recalculateNameID(p.name),a.Bh(p,3),p.gh(!1),c=!0);return c},a.prototype.calculateIterations=function(a,c){var d,e,f,g,h,i,j,k,l,m,p,q,r;if(!a.calcOnDemand&&0===c&&(d=a.imb[c])){if(e=null,f=!0,a.iterativeCalculation){for(h in a.jh)a.jh.hasOwnProperty(h)&&(i=a.jh[h].getSource(),i.clearValueCache&&i.clearValueCache());for(j=0;f&&j<a.iterativeCalculationMaximumIterations;j++)for(f=!1,e=d;e;e=e.eh)delete e.SMc,g=e.node&&e.node.Lf&&e.node.Lf.ehc,this.rhc(e,!g,n),g&&(e.node.Lf.ehc=o),k=e.ah,l=e.row,m=e.column,p=k.getSource().getValue(l,m),k.recalculateCell(l,m),f||(q=k.getSource().getValue(l,m),b.approximatelyEqual(p,q,a.iterativeCalculationMaximumChange)||(f=!0))}else for(e=d;e;e=e.eh)g=e.node&&e.node.Lf&&e.node.Lf.ehc,this.rhc(e,!g,0),g&&(e.node.Lf.ehc=o),delete e.SMc;for(r=null,e=d;e;e=r)r=e.eh,e.eh=o,r&&(r.dh=o)}},a.prototype.Ig=function(a,b,c,d,g,h,i){var j,k,l,m,p,q,r,s,t,u,v,w,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,O,P,Q,R,S,T,U,V,W,X,Y=this;for(h&&Y.shc(a);12===d.type;)d=d.value;for(;10===d.type;)d=d.value;for(;12===d.type;)d=d.value;if(g){for(;12===g.type;)g=g.value;for(;10===g.type;)g=g.value;for(;12===g.type;)g=g.value}if(13===d.type){if(r=d.getRange(b,c,!0),r===n)return;d=1===r.rowCount&&1===r.colCount?f.rf(n,n,r.row,r.col,!1,!1):f.uf(n,n,r.row,r.col,r.row+r.rowCount-1,r.col+r.colCount-1,!1,!1,!1,!1)}if(g&&g!==d&&8===g.type){if(g.source instanceof e.ErrorSource)return;k=g.value,G=d.source||g.source||i||Y.xf,l=G.getCustomName(k),l?H=G.getCalcSourceModel():(H=Y.Af.getGlobalSourceModel()||G.getCalcSourceModel(),l=H.getSource().getCustomName(k),l||(I=G.getCalcSourceModel().wg(k,!0),I.gmb(0,a,h))),p=H.wg(k,!0),p.gmb(0,a,h),g=null,l&&Y.Ig(a,b,c,l,n,h,H.getSource())}if(1===d.type&&d.endSource)for(J=d,K=J.source.getSources(J.endSource),j=0;j<K.length;j++)L=f.uf(K[j],n,J.row,J.column,J.endRow,J.endColumn,J.rowRelative,J.columnRelative,J.endRowRelative,J.endColumnRelative,b,c),L.isFullRow=J.isFullRow,L.isFullColumn=J.isFullColumn,Y.Ig(a,b,c,L,n,h);else if(1===d.type){if(G=d.source!==e.BangSource&&d.source||Y.xf,H=G.getCalcSourceModel(),!H)return;if(M=d,O=a.row===o||a.column===o,P=M.tf(),Q=f.getRangeForReference(M,b,c),u=Q.row,w=Q.col,z=Q.rowCount,A=Q.colCount,v=u+z-1,y=w+A-1,0===P){if(0<=b&&0<=c)if(ka(Q))q=H.ug(!0),O?q.Xoa(u,w,z,A,a,h):q.Jg(u,w,z,A,a,h);else for(E=u;E<=v;E++)for(F=w;F<=y;F++)B=H.qg(E,F,!0),O?B&&B.gmb(3,a,h):B&&B.gmb(0,a,h);else if(0<=b&&c===-1)for(E=u;E<=v;E++)for(F=w;F<=y;F++)M.columnRelative||M.endColumnRelative?(C=H.rg(E,!0),C&&C.Kg(a.row,-F,h)):(B=H.qg(E,F,!0),B&&B.gmb(1,a,h));else if(0<=c&&b===-1)for(E=u;E<=v;E++)for(F=w;F<=y;F++)M.rowRelative||M.endRowRelative?(D=H.sg(F,!0),D&&D.Mg(a,-E,h)):(B=H.qg(E,F,!0),B&&B.gmb(2,a,h))}else if(1===P){if(0<=b&&0<=c)q=H.ug(!0),O?q.Xoa(u,w,z,A,a,h):q.Jg(u,w,z,A,a,h);else if(0<=b&&c===-1);else if(b===-1&&0<=c)if(M.rowRelative||M.endRowRelative);else for(u=M.row,v=M.endRow,E=u;E<=v;E++)C=H.rg(E,!0),C&&C.gmb(2,a,h)}else if(2===P)if(0<=b&&0<=c)q=H.ug(!0),O?q.Xoa(u,w,z,A,a,h):q.Jg(u,w,z,A,a,h);else if(0<=b&&c===-1);else if(b===-1&&0<=c)for(F=w;F<=y;F++)D=H.sg(F,!0),D&&D.gmb(2,a,h)}else if(9===d.type)Y.Ig(a,b,c,d.value,g&&9===g.type&&g.value,h),d.value2&&Y.Ig(a,b,c,d.value2,g&&9===g.type&&g.value2,h);else if(8===d.type){if(d.g$c)return;if(d.g$c=!0,G=d.source||i||Y.xf,k=x(d.value),l=G.getCustomName(k),l?H=G.getCalcSourceModel():(H=Y.Af.getGlobalSourceModel()||G.getCalcSourceModel(),l=H.getSource().getCustomName(k),l||(m=G.getCalcSourceModel().wg(k,!0),m.gmb(0,a,h))),p=H.wg(k,!0),!p)return;p.gmb(0,a,h),l&&Y.Ig(a,b,c,l,n,h,H.getSource()),d.g$c=o}else if(7===d.type){if(d.g$c)return;if(d.g$c=!0,R=d.function)if(e.isExpression(R))for(Y.Ig(a,b,c,R,g&&7===g.type&&g.function instanceof e.Expression&&g.function,h),T=d.arguments.length,j=0;j<T;j++)Y.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h);else for(R&&(R.isVolatile()&&(h?Y.bg(a):Y.Tf(a)),"GETPIVOTDATA"===R.name&&(h?Y.RMc(a):Y.PMc(a)),R instanceof e.Functions.AsyncFunction&&(Y.Af.nia=!0)),T=d.arguments.length,j=0;j<T;j++)R&&R.skipPrecedent(j)&&(U=d.arguments[j],12===U.type&&(U=U.value),!U||!U.function||"IF"!==U.function.name||6!==U.arguments[0].type)||(V=!1,R&&R.isBranch()&&R.findTestArgument()!==j&&a instanceof N&&(d.QDc=!0,d.RDc=d.RDc||[],d.RDc[j]=[],V=!0,a.LDc=a.LDc||[],a.LDc.push(d.RDc[j])),Y.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h),V&&a.LDc.pop());else for(!d.isLocalFunctionName&&d.functionName&&(S=new e.Expression(8),S.value=d.functionName,Y.Ig(a,b,c,S,d,h)),T=d.arguments.length,j=0;j<T;j++)Y.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h);d.g$c=o}else if(25===d.type||26===d.type){if(W=d,G=d.source||Y.xf,H=G.getCalcSourceModel(),X=H.mg(W.value,!0),!X)return;X.gmb(0,a,h)}},a.prototype.Og=function(a,b){var c=this.getNodeByName(a);c&&(c.Nf||c.Lf)&&this.Ig(this.mg(a),0,0,c.Nf||c.Lf,c.Lf,b)},a.prototype.Pg=function(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=a+c,n=b+d;for(i=a;i<m;i++)for(j=b;j<n;j++)f=l.Mf(i,j),g=l.Kf(i,j),(f||g)&&(h=l.Qf(i,j),k=l.qg(i,j),h&&h.isDynamicArray!==!0?l.Ig(k,h.row,h.col,f||g,g,e):l.Ig(k,i,j,f||g,g,e),e||k.kOb&&aa(k.ZAb(),k,k.kOb,!1,!1))},a.prototype.Qg=function(a,b,c){var d,e,f=a+b;for(d=a;d!==-1&&d<f;d++)e=this.getColumnExpression(d),e&&this.Ig(this.sg(d,!1),-1,d,e,e,c)},a.prototype.Rg=function(a,b,c,d){this.Pg(a,b,c,d,!0)},a.prototype.Sg=function(a,b,c,d){this.Pg(a,b,c,d,!1)},a.prototype.Tg=function(a,b){},a.prototype.Ug=function(a,b){},a.prototype.Vg=function(a,b){this.Qg(a,b,!0)},a.prototype.Wg=function(a,b){this.Qg(a,b,!1)},a.prototype.Xg=function(a,b,c,d,e,f,g){var h,i,j,k=a+c,l=b+d,m=this;for(h=a;h<k;h++)for(i=b;i<l;i++)j=this.qg(h,i,!1),j&&(m.FTa(g,h,i),e&&j.Yg(),f&&j.Bg())},a.prototype.Zg=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.Hf;if(a!==-1&&k)for(f=A(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,g,-1),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype.$g=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.If;if(a!==-1&&k)for(f=A(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,-1,g),
i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype._g=function(a,b,c,d,e,f,g){var h,i,j,k;(e||f)&&(h=this,i=void 0,g&&(i=h.dUa()),0<=a&&0<=b?(h.Xg(a,b,c,d,e,f,i),h.Zg(a,c,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):0<=a&&b===-1?(h.Xg(a,0,c,h.cC(),e,f,i),h.Zg(a,c,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&0<=b?(h.Xg(0,b,h.rC(),d,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&b===-1&&(j=h.rC(),k=h.cC(),h.Xg(0,0,j,k,e,f,i),h.Zg(0,j,e,f,i),h.$g(0,k,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))))},a.prototype.getAllNodes=function(){var a,b,c,d,e=[],f=this.dataTable,g=this.Hf,h=this.If,i=this.Jf;i&&e.push(i);for(b in g)g.hasOwnProperty(b)&&(a=g[b],a&&e.push(a));for(b in h)h.hasOwnProperty(b)&&(a=h[b],a&&e.push(a));for(c in f)if(f.hasOwnProperty(c)&&(d=f[c]))for(b in d)d.hasOwnProperty(b)&&(a=d[b],a&&e.push(a));return e},a.prototype.toJSON=function(a){b.supportRowColumnFormula?this.xf.toJSON(a,this.dataTable,this.Ef,this.Ff,this.If):this.xf.toJSON(a,this.dataTable,this.Ef,this.Ff)},a}(),b.CalcSourceModel=M,N=function(a){S(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.row=c,e.column=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+","+a.column},b.prototype.og=function(){var a=this;a.ah.Rg(a.row,a.column,1,1)},b.prototype.ng=function(){var a=this;a.ah.Sg(a.row,a.column,1,1)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},b.prototype.fh=function(){this.ah.Cf().pg(this,0)},b.prototype.Bg=function(){var a,b,c,d,e,f,g,h,i=this.ah.Cf(),j=this.Ze;for(b=0;b<j.length;b++)if(c=this[j[b]])for(d in c)c.hasOwnProperty(d)&&(a=c[d],!a||a.dh||a.eh||a.fh(),i.calcOnDemand&&a&&!a.$l&&(a.$l=!0,a.Bg()));if(e=this.node&&this.node.Pf,e&&e.isDynamicArray)for(f=0;f<e.rowCount;f++)for(g=0;g<e.colCount;g++)0===f&&0===g||(h=this.ah.getNode(f+e.row,g+e.col),h&&h.calc&&h.calc.Bg())},b.prototype.y$a=function(){var a,b,c,d,e,f,g,h,i=this,j=i.ah,k=j.getCalcService();k&&k.nia&&(a=i.nia,b=a&&i.z$a,!b&&z(a)&&(c=j.getSource(),c&&(d=c.getName(),e=k.lh.asyncManager,f=e.y5[d],f&&(g=f[i.row],g&&(h=g[i.column],h&&(b=h[0],b?(i.nia=!0,i.z$a=b,b.h_a=i):i.nia=!1))))),b&&0===b.evaluateMode&&(b.v5=!1))},b}(H),b.CellCalc=N;function ba(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function ca(a,b,c){var d,e=a[b];if(e)for(d=0;d<e.length;d++)if(e[d]===c)return void e.splice(d,1)}O=function(a){S(b,a);function b(b,c){var d=a.call(this,b)||this;return d.row=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+",-1"},b.prototype.og=function(){this.ah.Tg(this.row,1)},b.prototype.ng=function(){this.ah.Ug(this.row,1)},b.prototype.Kg=function(a,b,c){c?ba(this,C,{row:a,columnOffset:b,columnCount:1}):ca(this,C,{row:a,columnOffset:b,columnCount:1})},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},b.prototype.fh=function(){this.ah.Cf().pg(this,1)},b}(H),b.RowCalc=O,P=function(a){S(b,a);function b(b,c){var d=a.call(this,b)||this;return d.column=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+"-1,"+a.column},b.prototype.og=function(){this.ah.Vg(this.column,1)},b.prototype.ng=function(){this.ah.Wg(this.column,1)},b.prototype.Mg=function(a,b,c){this.gmb(2,a,c)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},b.prototype.fh=function(){this.ah.Cf().pg(this,2)},b}(H),b.ColumnCalc=P,Q=function(a){S(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.updateListening=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.Ze;for(e=0;e<l.length;e++)if(f=k[l[e]]){g=[];for(h in f)f.hasOwnProperty(h)&&(c=f[h],c&&g.push(c));for(i=g.length,j=0;j<i;j++)c=g[j],d=c.node,c.ng(),d&&(!d.Pf||d.Pf.row===c.row&&d.Pf.col===c.column)&&c.ah.fg(c.row,c.column,d.Lf,d.Pf,!0)}},b.prototype.updateListeningOnRemoved=function(){var a,b,c,d,e,f,g,h,i,j,k=this,l=k.Ze,m=k.ah,n=m.Cf();for(f=0;f<l.length;f++)if(g=k[l[f]])for(h in g)g.hasOwnProperty(h)&&(a=g[h],a&&(b=a.ah,c=a.row,d=a.col,c=c===o?-1:c,d=d===o?-1:d,e=b.Kf(c,d),i=b.Qf(c,d),e&&(j=n.ih().adjustFormulaOnRemoveName(m,e,k.name),j!==e&&b.fg(c,d,j,i,!0))))},b.prototype.fh=function(){var a,b,c,d,e=this.Ze;for(b=0;b<e.length;b++)if(c=this[e[b]])for(d in c)c.hasOwnProperty(d)&&(a=c[d],a&&a.fh())},b}(H),b.NameCalc=Q,R=function(a){S(b,a);function b(b){return a.call(this,b)||this}return b.prototype.processListener=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=this,o=n[a],p=b+","+c+","+d+","+e;if(3!==a||f instanceof I){if(f.LDc&&f.LDc.length>=1&&(k=f.LDc,l=k[k.length-1],l.push(this),p="?"+p),h&&(p="!"+p),o||(n.Ze.push(a),n[a]=o={}),i=o[p],!i){if(!g)return;i=o[p]={},i.content={},i.length=0,i.row=b,i.col=c,i.rowCount=d,i.colCount=e}if(m=f.getKey(),g){if(i.content[m])return;i.content[m]=f,i.length++}else i.content[m]&&(delete i.content[m],i.length--,i.length<1&&(delete i.content,delete o[p]));n.clearListenersCache()}},b.prototype.Jg=function(a,b,c,d,e,f,g){this.processListener(0,a,b,c,d,e,f,g)},b.prototype.Xoa=function(a,b,c,d,e,f){this.processListener(3,a,b,c,d,e,f)},b.prototype.Yg=function(a,b,c,d){this.visit(0,a,b,c,d)},b.prototype.clearListenersCache=function(){var a,b=this.Ze;for(a=0;a<b.length;a++)delete this[b[a]+"cached"]},b.prototype.getListeners=function(a,b){var c,e,f,g,h=a[b],i=this[h];if(i&&(e=h+"cached",c=this[e],!c)){c=this[e]=new d.Common.rbush(16);for(f in i)i.hasOwnProperty(f)&&(g=i[f],g&&c.insert({minX:g.col,minY:g.row,maxX:g.col+g.colCount-1,maxY:g.row+g.rowCount-1,item:g}))}return c},b.prototype.visit=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n=this.Ze;for(f=0;f<n.length;f++)if(g=this[n[f]])for(h=this.getListeners(n,f),i=h.search({minX:c,minY:b,maxX:c+e-1,maxY:b+d-1}),j=0;j<i.length;j++){k=i[j].item.content;for(l in k)m=k[l],0===a?m.bh():m.fh()}},b.prototype.Bg=function(a,b,c,d){this.visit(1,a,b,c,d)},b.prototype.gh=function(a,b,c){var d,e,f,g,h,j,k,l,m,n=this.Ze,o=c?1:-1;for(e=0;e<n.length;e++)if(f=this[n[e]])for(g=this.getListeners(n,e),h=g.search({minX:b,minY:a,maxX:b,maxY:a}),j=0;j<h.length;j++){k=h[j].item.content;for(l in k)m=k[l],i(m,H)&&(m.delay+=o)}},b.prototype.og=function(){},b.prototype.ng=function(){},b}(H),b.RangeCalc=R;function da(a,b){var c,d,e;for(c in a)d=a[c],d&&(b?da(d):(e=d.calc,e&&e.ng()))}function ea(a,b){if(!a.function){var c=b.getNameInfo(a.functionName);c&&(a.functionName=c.Cj)}}function fa(a,b,c,d,i,j,k){var l,m,p,u,v,w,x,y,A,B,C,D,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,fa,ga,ja,ka,la=a.row,ma=a.column,na=[],oa=0,pa=a.arrayIdentity?a.arrayIdentity.row:la,qa=a.arrayIdentity?a.arrayIdentity.col:ma;for(na[oa]={expr:b,acceptsArray:j||!1,acceptsRef:k||!1,index:-1},l=0,m=0,p=!1,v=d,w=i,x=!1;oa>=0;){if(y=na[oa],oa--,A=y.acceptsArray,B=y.acceptsRef,b=y.expr,C=n,b){if(7===b.type){if(O=b,P=O.arguments.length,!O.function){if(!a){C=e.Hh(q);continue}O.function=a.getFunction(O.functionName),ea(O,a)}if(Q=O.function,R=y.index,N=y.neeedExpendindexs,R<0?(y.arrayArgumentEvaluateMode=x,y.arrayFormulaCatchValue=c,e.getFunctionArrayArgumentEvaluateMode(Q)&&(x=e.getFunctionArrayArgumentEvaluateMode(Q)),y.args=[]):(e.getFunctionAcceptsArray(Q,R)?l--:p&&(N||(N=[],y.neeedExpendindexs=N),O.arguments[R]!==D,N.push(R)),y.args.push(D)),R===P-1){if(x=y.arrayArgumentEvaluateMode,c=y.arrayFormulaCatchValue,S=y.args,T=!1,S&&S.length>0)for(U=0;U<S.length;U++)if(S[U]!==O.arguments[U]){T=!0;break}C=T?e.Jh(O,S):b,N&&N.length>0&&(C=e.createExpandExpression(C,N),p=!0)}else 0===R&&Q&&3===e.getFunctionArrayArgumentEvaluateMode(Q)&&3===x&&(x=0),p=!1,R++,y.index=R,e.getFunctionAcceptsArray(Q,R)&&l++,++oa,na[oa]=y,++oa,na[oa]={expr:O.arguments[R],acceptsArray:e.getFunctionAcceptsArray(Q,R),acceptsRef:e.getFunctionAcceptsReference(Q,R),index:-1}}else if(1===b.type&&b.sf())m&&(I=b.source!==e.BangSource&&b.source||a.source,J=I.getRowCount(),K=I.getColumnCount(),L=b.rowRelative?(b.row+pa)%e.MAX_ROW_COUNT%J:b.row,M=b.columnRelative?(b.column+qa)%e.MAX_COLUMN_COUNT%K:b.column,L=L<0?L+J:L,M=M<0?M+K:M,b=f.rf(b.source&&I,n,L,M,!1,!1));else if(1===b.type||13===b.type){if(13===b.type){if(V=b,H=V.getRange(la,ma),V.tzb(la,ma,a.source.id),!H){V._error?(delete V._error,C=D=r,a.iOb=1):(C=b,D=b);continue}b=f.uf(V.source===a.source?n:V.source,n,H.row,H.col,H.row+H.rowCount-1,H.col+H.colCount-1)}W=b.source!==e.BangSource&&b.source,X=b,m&&(I=W||a.source,J=e.MAX_ROW_COUNT,K=e.MAX_COLUMN_COUNT,Y=X.rowRelative?(X.row+pa)%J:X.row,Z=X.columnRelative?(X.column+qa)%K:X.column,$=X.endRowRelative?(X.endRow+pa)%J:X.endRow,_=X.endColumnRelative?(X.endColumn+qa)%K:X.endColumn,Y=Y<0?Y+J:Y,Z=Z<0?Z+K:Z,$=$<0?$+J:$,_=_<0?_+K:_,aa=void 0,Y>$&&(aa=Y,Y=$,$=aa),Z>_&&(aa=Z,Z=_,_=aa),J=I.getRowCount(),K=I.getColumnCount(),Y>=J?(Y%=J,$%=J):$>=J&&($=J-1),Z>=K?(Z%=K,_%=K):_>=K&&(_=K-1),b.row===e.BAND_INDEX_CONST&&(Y=$=e.BAND_INDEX_CONST),b.column===e.BAND_INDEX_CONST&&(Z=_=e.BAND_INDEX_CONST),b=f.uf(W,b.endSource,Y,Z,$,_,!1,!1,!1,!1)),B&&(A||!c&&1!==x&&3!==x)||la<0||ma<0||4===x||(l>0&&!c&&1!==x&&3!==x||0===l||2===x?(H=X.getRange(la,ma),c||(B||A)&&1===x?!X.isFullColumn&&1!==H.rowCount&&v>=H.rowCount||!X.isFullRow&&1!==H.colCount&&w>=H.colCount?C=e.Hh(t):(L=(X.isFullColumn?0:H.row)+(1===H.rowCount?0:v),M=(X.isFullRow?0:H.col)+(1===H.colCount?0:w),C=f.rf(W,b.endSource,L,M,!1,!1)):H.rowCount>1&&H.colCount>1||H.rowCount>1&&!X.isFullColumn&&(la<H.row||la>=H.row+H.rowCount)||H.colCount>1&&!X.isFullRow&&(ma<H.col||ma>=H.col+H.colCount)?C=e.Hh(s):(L=X.isFullColumn||H.rowCount>1?la:H.row,M=X.isFullRow||H.colCount>1?ma:H.col,C=f.rf(W,b.endSource,L,M,!1,!1))):p=!0)}else if(9===b.type)ba=b.operatorType>=15,c&&z(b.value2)&&(ba=A=!1),y.index===-1?(y.index=b.value2?0:1,++oa,na[oa]=y,++oa,na[oa]=ha(b.value,ba,ba,-1)):0===y.index?(D!==b.value&&(C=e.Kh(b.operatorType,D,b.value2),y.expr=C),p&&(N=[],N.push(0),y.neeedExpendindexs=N,p=!1),y.index=1,++oa,na[oa]=y,++oa,na[oa]=ha(b.value2,ba,ba,-1)):(C=b.value2&&D!==b.value2?e.Kh(b.operatorType,b.value,D):z(b.value2)&&D!==b.value?e.Kh(b.operatorType,D,o):b,N=y.neeedExpendindexs,p&&(N?N.push(1):N=[b.value2&&b.value2===u?1:0]),N&&(C=e.createExpandExpression(C,N),p=!0));else if(10===b.type)y.index===-1?(y.index=0,++oa,na[oa]=y,++oa,na[oa]=ha(b.value,A,B,-1)):b.value!==D&&(C=e.Lh(D));else if(8===b.type)1===y.index?(m--,C=D,y.context&&(a=y.context)):(m++,++oa,na[oa]=ha(b,A,B,1,a),ca=void 0,da=a,fa=void 0,b.source?(fa=b.source===e.BangSource?a.source:b.source,da=new h.EvaluateContext(fa),da.cloneFrom(a),ca=fa.getCustomName(b.value)):(ca=a.getName(b.value),a.source.getCustomName(b.value)||(da=new h.GloableEvaluateContext(a.source),da.cloneFrom(a))),ca||(ca=e.Hh(q)),a=da||a,++oa,na[oa]=ha(ca,A,B,-1,a));else if(6===b.type)if(ga=b,!A&&(l>0||c||1===x||3===x))p=!0,u=b;else if(!A&&0===l)if(v>=ga.value.RowCount&&ga.value.RowCount>1||w>=ga.value.colCount&&ga.value.colCount>1)C=e.Hh(t);else try{1===ga.value.RowCount&&(v=0),1===ga.value.colCount&&(w=0),ja=ga.value.getValue(v,w),typeof ja===F?C=e.createStringExpression(ja):typeof ja===E?C=e.createNumberExpression(ja):typeof ja===G?C=e.createBooleanExpression(ja):ja._error?C=e.Hh(ja):(ka=new g.Parser,C=ka.parse(a.source.getParserContext(a.useR1C1,ia(0,0)),""+ja))}catch(a){C=e.Hh(t)}}else;C===n&&(C=b),D=C}return C}b.CWc=fa;function ga(a,b,c,d,i,j,k){var l,m,p,u,v,w,x,y,A,B,C,D,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,fa,ga,ja,ka,la,ma,na,oa,pa,qa,ra,sa=a.row,ta=a.column,ua=[],va=0,wa=a.arrayIdentity?a.arrayIdentity.row:sa,xa=a.arrayIdentity?a.arrayIdentity.col:ta;for(ua[va]={expr:b,acceptsArray:j||!1,acceptsRef:k||!1,index:-1},l=0,m=0,p=!1,v=d,w=i,x=!1;va>=0;){if(y=ua[va],va--,A=y.acceptsArray,B=y.acceptsRef,b=y.expr,C=n,b){if(7===b.type){if(O=b,P=O.arguments,Q=P.length,!O.function){if(!a){C=e.Hh(q);continue}R=O.functionName,O.function=a.getFunction(R),ea(O,a)}if(S=O.function,T=y.index,N=y.neeedExpendindexs,T<0?(y.arrayArgumentEvaluateMode=x,y.arrayFormulaCatchValue=c,e.getFunctionArrayArgumentEvaluateMode(S)&&(x=e.getFunctionArrayArgumentEvaluateMode(S)),y.args=[]):(e.getFunctionAcceptsArray(S,T)?l--:p&&(N||(N=[],y.neeedExpendindexs=N),O.arguments[T]!==D,N.push(T)),y.args.push(D)),T===Q-1){if(x=y.arrayArgumentEvaluateMode,c=y.arrayFormulaCatchValue,U=y.args,V=!1,U&&U.length>0)for(W=0;W<U.length;W++)if(U[W]!==O.arguments[W]){V=!0;break}C=V?e.Jh(O,U):b,N&&N.length>0&&(C=e.createExpandExpression(C,N),p=!0)}else 0===T&&S&&3===e.getFunctionArrayArgumentEvaluateMode(S)&&3===x&&(x=0),p=!1,T++,y.index=T,e.getFunctionAcceptsArray(S,T)&&l++,++va,ua[va]=y,++va,ua[va]={expr:O.arguments[T],acceptsArray:e.getFunctionAcceptsArray(S,T),acceptsRef:e.getFunctionAcceptsReference(S,T),index:-1}}else if(1===b.type&&b.sf())m&&(I=b.source!==e.BangSource&&b.source||a.source,J=I.getRowCount(),K=I.getColumnCount(),L=b.rowRelative?(b.row+wa)%e.MAX_ROW_COUNT%J:b.row,M=b.columnRelative?(b.column+xa)%e.MAX_COLUMN_COUNT%K:b.column,L=L<0?L+J:L,M=M<0?M+K:M,b=f.rf(b.source&&I,n,L,M,!1,!1));else if(1===b.type||13===b.type){if(13===b.type){if(X=b,H=X.getRange(sa,ta),X.tzb(sa,ta,a.source.id),!H){X._error?(delete X._error,C=D=r,a.iOb=1):(C=b,D=b);continue}b=f.uf(X.source===a.source?n:X.source,n,H.row,H.col,H.row+H.rowCount-1,H.col+H.colCount-1)}Y=b.source!==e.BangSource&&b.source,Z=b,$=Z.ensureSingle,m&&(I=Y||a.source,J=e.MAX_ROW_COUNT,K=e.MAX_COLUMN_COUNT,_=Z.rowRelative?(Z.row+wa)%J:Z.row,aa=Z.columnRelative?(Z.column+xa)%K:Z.column,ba=Z.endRowRelative?(Z.endRow+wa)%J:Z.endRow,ca=Z.endColumnRelative?(Z.endColumn+xa)%K:Z.endColumn,_=_<0?_+J:_,aa=aa<0?aa+K:aa,ba=ba<0?ba+J:ba,ca=ca<0?ca+K:ca,da=void 0,_>ba&&(da=_,_=ba,ba=da),aa>ca&&(da=aa,aa=ca,ca=da),J=I.getRowCount(),K=I.getColumnCount(),_>=J?(_%=J,ba%=J):ba>=J&&(ba=J-1),aa>=K?(aa%=K,ca%=K):ca>=K&&(ca=K-1),b.row===e.BAND_INDEX_CONST&&(_=ba=e.BAND_INDEX_CONST),b.column===e.BAND_INDEX_CONST&&(aa=ca=e.BAND_INDEX_CONST),b=f.uf(Y,b.endSource,_,aa,ba,ca,!1,!1,!1,!1),$&&(b.ensureSingle=!0)),k||B&&(A||!c&&1!==x&&3!==x)||sa<0||ta<0||(l>0&&!c&&1!==x&&3!==x||0===l||2===x?(H=Z.getRange(sa,ta),c||(B||A)&&1===x?!Z.isFullColumn&&1!==H.rowCount&&v>=H.rowCount||!Z.isFullRow&&1!==H.colCount&&w>=H.colCount?C=e.Hh(t):(L=(Z.isFullColumn?0:H.row)+(1===H.rowCount?0:v),M=(Z.isFullRow?0:H.col)+(1===H.colCount?0:w),C=f.rf(Y,b.endSource,L,M,!1,!1)):H.rowCount>1&&H.colCount>1||H.rowCount>1&&!Z.isFullColumn&&(sa<H.row||sa>=H.row+H.rowCount)||H.colCount>1&&!Z.isFullRow&&(ta<H.col||ta>=H.col+H.colCount)?C=e.Hh(s):(L=Z.isFullColumn||H.rowCount>1?sa:H.row,M=Z.isFullRow||H.colCount>1?ta:H.col,C=f.rf(Y,b.endSource,L,M,!1,!1))):p=!0)}else if(9===b.type)fa=b.operatorType>=15,ga=B&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,y.index===-1?(c&&z(b.value2)&&(fa=A=!1),y.index=b.value2?0:1,++va,ua[va]=y,++va,ua[va]=ha(b.value,fa||A,fa||ga,-1)):0===y.index?(D!==b.value&&(C=e.Kh(b.operatorType,D,b.value2),y.expr=C),p&&(N=[],N.push(0),y.neeedExpendindexs=N,p=!1),y.index=1,++va,ua[va]=y,++va,ua[va]=ha(b.value2,fa||A,fa||ga,-1)):(C=b.value2&&D!==b.value2?e.Kh(b.operatorType,b.value,D):z(b.value2)&&D!==b.value?e.Kh(b.operatorType,D,o):b,N=y.neeedExpendindexs,p&&(N?N.push(1):N=[b.value2&&b.value2===u?1:0]),N&&(C=e.createExpandExpression(C,N),p=!0));else if(10===b.type)y.index===-1?(y.index=0,++va,ua[va]=y,++va,ua[va]=ha(b.value,A,B,-1)):b.value!==D&&(C=e.Lh(D));else if(8===b.type)1===y.index?(b.g$c=o,m--,C=D,y.context&&(a=y.context)):b.g$c||(b.g$c=!0,m++,++va,ua[va]=ha(b,A,B,1,a),ja=void 0,ka=a,la=void 0,b.source?(la=b.source===e.BangSource?a.source:b.source,ka=new h.EvaluateContext(la),ka.cloneFrom(a),ja=la.getCustomName(b.value)):(ja=a.getName(b.value),a.source.getCustomName(b.value)||(ka=new h.GloableEvaluateContext(a.source),ka.cloneFrom(a))),ja||(ja=e.Hh(q)),a=ka||a,++va,ua[va]=ha(ja,A,B,-1,a));else if(6===b.type)if(ma=b,na=b.value,!A&&(l>0||c||1===x||3===x))p=!0,u=b;else if(!A&&0===l)if(oa=na.getRowCount(),pa=na.getColumnCount(),v>=oa&&oa>1||w>=pa&&pa>1)C=e.Hh(t);else if(c||!(a.source&&a.source.Af&&a.source.Af.allowDynamicArray))try{1===oa&&(v=0),1===pa&&(w=0),qa=ma.value.getValue(v,w),typeof qa===F?C=e.createStringExpression(qa):typeof qa===E?C=e.createNumberExpression(qa):typeof qa===G?C=e.createBooleanExpression(qa):qa._error?C=e.Hh(qa):(ra=new g.Parser,C=ra.parse(a.source.getParserContext(a.useR1C1,ia(0,0)),""+qa))}catch(a){C=e.Hh(t)}}else;C===n&&(C=b),D=C}return C}b.Mh=ga;function ha(a,b,c,d,e){return{expr:a,acceptsArray:b,acceptsRef:c,index:d,context:e}}function ia(a,b){return{row:a,col:b}}b.pf=ia;function ja(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}b.qf=ja;function ka(a){return a.row===-1||a.col===-1||a.rowUndefine||a.colUndefine||a.rowCount*a.colCount>1}},"./src/calcEngine.res.en.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0});function f(a,b){return{description:a,parameters:b}}function g(a,b){return{name:a,repeatable:b}}d="[start_num]",e="[significance]",b.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",Exp_DuplicatedChar:"Duplicated Character",Exp_ArgumentOutOfRangeException:"Argument Out Of Range Exception",Exp_ArgumentException:"Argument Exception",_h:{ABS:f("This function calculates the absolute value of the specified value.",[g("number")]),ACCRINT:f("This function calculates the accrued interest for a security that pays periodic interest.",[g("issue"),g("first_interest"),g("settlement"),g("rate"),g("par"),g("frequency"),g("basis")]),ACCRINTM:f("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[g("issue"),g("settlement"),g("rate"),g("par"),g("basis")]),ACOS:f("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[g("number")]),ACOSH:f("This function calculates the inverse hyperbolic cosine of the specified value.",[g("number")]),ADDRESS:f("This function uses the row and column numbers to create a cell address in text.",[g("row_num"),g("column_num"),g("abs_num"),g("a1style"),g("sheet_text")]),AGGREGATE:f("This function aggregate a list of numbers using a specified built-in function.",[g("function_num"),g("options"),g("ref1"),g("ref2",!0)]),AMORDEGRC:f("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[g("cost"),g("date_purchased"),g("first_period"),g("salvage"),g("period"),g("rate"),g("basis")]),AMORLINC:f("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[g("cost"),g("date_purchased"),g("first_period"),g("salvage"),g("period"),g("rate"),g("basis")]),AND:f("Check whether all arguments are True, and returns True if all arguments are True.",[g("logical1"),g("logical2")]),ASIN:f("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[g("number")]),ASINH:f("This function calculates the inverse hyperbolic sine of a number.",[g("number")]),ATAN:f("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[g("number")]),ATAN2:f("This function calculates the arctangent of the specified x- and y-coordinates.",[g("x_num"),g("y_num")]),ATANH:f("This function calculates the inverse hyperbolic tangent of a number.",[g("number")]),AVEDEV:f("This function calculates the average of the absolute deviations of the specified values from their mean.",[g("number1"),g("number2",!0)]),AVERAGE:f("This function calculates the average of the specified numeric values.",[g("number1"),g("number2",!0)]),AVERAGEA:f("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[g("value1"),g("value2",!0)]),AVERAGEIF:f("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[g("range"),g("criteria"),g("[average_range]")]),AVERAGEIFS:f("This function calculates the average of all cells that meet multiple specified criteria.",[g("average_range"),g("criteria_range1",!0),g("criteria1",!0)]),BESSELI:f("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[g("value"),g("order")]),BESSELJ:f("This function calculates the Bessel function of the first kind.",[g("value"),g("order")]),BESSELK:f("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[g("value"),g("order")]),BESSELY:f("This function calculates the Bessel function of the second kind.",[g("value"),g("order")]),BETADIST:f("This function calculates the cumulative beta distribution function.",[g("x"),g("alpha"),g("beta"),g("lower"),g("upper")]),BETAINV:f("This function calculates the inverse of the cumulative beta distribution function.",[g("probability"),g("alpha"),g("beta"),g("lower"),g("upper")]),BIN2DEC:f("This function converts a binary number to a decimal number",[g("number")]),BIN2HEX:f("This function converts a binary number to a hexadecimal number.",[g("number"),g("places")]),BIN2OCT:f("This function converts a binary number to an octal number.",[g("number"),g("places")]),BINOMDIST:f("This function calculates the individual term binomial distribution probability.",[g("number_s"),g("trials"),g("probability_s"),g("cumulative")]),CEILING:f("This function rounds a number up to the nearest multiple of a specified value.",[g("number"),g("significance")]),CHAR:f("This function returns the character specified by a number.",[g("number")]),CHIDIST:f("This function calculates the one-tailed probability of the chi-squared distribution.",[g("value"),g("deg_freedom")]),CHIINV:f("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[g("probability"),g("deg_freedom")]),CHITEST:f("This function calculates the test for independence from the chi-squared distribution.",[g("actual_range"),g("expected_range")]),CHOOSE:f("This function returns a value from a list of values.",[g("index_num"),g("value1"),g("value2",!0)]),CLEAN:f("This function removes all non-printable characters from text.",[g("text")]),CODE:f("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[g("text")]),COLUMN:f("This function returns the column number of a reference.",[g("reference")]),COLUMNS:f("This function returns the number of columns in an array.",[g("array")]),COMBIN:f("This function calculates the number of possible combinations for a specified number of items.",[g("number"),g("number_chosen")]),COMPLEX:f("This function converts real and imaginary coefficients into a complex number.",[g("real_num"),g("image_num"),g("suffix")]),CONCATENATE:f("This function combines multiple text strings or numbers into one text string.",[g("text1"),g("text2",!0)]),CONFIDENCE:f("This function returns confidence interval for a population mean.",[g("alpha"),g("standard_dev"),g("size")]),CONVERT:f("This function converts a number from one measurement system to its equivalent in another measurement system.",[g("number"),g("from_unit"),g("to_unit")]),CORREL:f("This function returns the correlation coefficient of the two sets of data.",[g("array1"),g("array2")]),COS:f("This function returns the cosine of the specified angle.",[g("number")]),COSH:f("This function returns the hyperbolic cosine of the specified value.",[g("number")]),COUNT:f("This function returns the number of cells that contain numbers.",[g("value1"),g("value2",!0)]),COUNTA:f("This function returns the number of number of cells that contain numbers, text, or logical values.",[g("value1"),g("value2",!0)]),COUNTBLANK:f("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[g("cellrange")]),COUNTIF:f("This function returns the number of cells that meet a certain condition",[g("cellrange"),g("criteria")]),COUNTIFS:f("This function returns the number of cells that meet multiple conditions.",[g("criteria_range1",!0),g("criteria1",!0)]),COUPDAYBS:f("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[g("settlement"),g("maturity"),g("frequency"),g("basis")]),COUPDAYS:f("This function returns the number of days in the coupon period that contains the settlement date.",[g("settlement"),g("maturity"),g("frequency"),g("basis")]),COUPDAYSNC:f("This function calculates the number of days from the settlement date to the next coupon date.",[g("settlement"),g("maturity"),g("frequency"),g("basis")]),COUPNCD:f("This function returns a date number of the next coupon date after the settlement date.",[g("settlement"),g("maturity"),g("frequency"),g("basis")]),COUPNUM:f("This function returns the number of coupons due between the settlement date and maturity date.",[g("settlement"),g("maturity"),g("frequency"),g("basis")]),COUPPCD:f("This function returns a date number of the previous coupon date before the settlement date.",[g("settlement"),g("maturity"),g("frequency"),g("basis")]),COVAR:f("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[g("array1"),g("array2")]),CRITBINOM:f("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[g("trials"),g("probability_s"),g("alpha")]),CUMIPMT:f("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[g("rate"),g("nper"),g("pval"),g("start_period"),g("end_period"),g("paytype")]),CUMPRINC:f("This function returns the cumulative principal paid on a loan between the start and end periods.",[g("rate"),g("nper"),g("pval"),g("start_period"),g("end_period"),g("paytype")]),DATE:f("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[g("year"),g("month"),g("day")]),DATEDIF:f("This function returns the number of days, months, or years between two dates.",[g("start_date"),g("end_date"),g("unit")]),DATEVALUE:f("This function returns a DateTime object of the specified date.",[g("date_text")]),DAVERAGE:f("This function calculates the average of values in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),DAY:f("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[g("date")]),DAYS360:f("This function returns the number of days between two dates based on a 360-day year.",[g("start_date"),g("end_date"),g("method")]),DB:f("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[g("cost"),g("salvage"),g("life"),g("period"),g("month")]),DCOUNT:f("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[g("database"),g("field"),g("criteria")]),DCOUNTA:f("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[g("database"),g("field"),g("criteria")]),DDB:f("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[g("cost"),g("salvage"),g("life"),g("period"),g("factor")]),DEC2BIN:f("This function converts a decimal number to a binary number.",[g("number"),g("places")]),DEC2HEX:f("This function converts a decimal number to a hexadecimal number",[g("number"),g("places")]),DEC2OCT:f("This function converts a decimal number to an octal number",[g("number"),g("places")]),DEGREES:f("This function converts the specified value from radians to degrees",[g("angle")]),DELTA:f("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[g("number1"),g("number2")]),DEVSQ:f("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[g("number1"),g("number2",!0)]),DGET:f("This function extracts a single value from a column of a list or database that matches the specified conditions.",[g("database"),g("field"),g("criteria")]),DISC:f("This function calculates the discount rate for a security.",[g("settlement"),g("maturity"),g("price"),g("redemption"),g("basis")]),DMAX:f("This function returns the largest number in a column of a list or database that matches the specified conditions.",[g("database"),g("field"),g("criteria")]),DMIN:f("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[g("database"),g("field"),g("criteria")]),DOLLAR:f("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[g("number"),g("decimals")]),DOLLARDE:f("This function converts a fraction dollar price to a decimal dollar price.",[g("fractional_dollar"),g("fraction")]),DOLLARFR:f("This function converts a decimal number dollar price to a fraction dollar price.",[g("decimal_dollar"),g("fraction")]),DPRODUCT:f("This function multiplies the values in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),DSTDEV:f("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),DSTDEVP:f("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),DSUM:f("This function adds the numbers in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),DURATION:f("This function returns the Macaulay duration for an assumed par value of $100.",[g("settlement"),g("maturity"),g("coupon"),g("yield"),g("frequency"),g("basis")]),DVAR:f("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),DVARP:f("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[g("database"),g("field"),g("criteria")]),EDATE:f("This function calculates the date that is the indicated number of months before or after a specified date.",[g("start_date"),g("months")]),EFFECT:f("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[g("nominal_rate"),g("npery")]),EOMONTH:f("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[g("start_date"),g("months")]),ERF:f("This function calculates the error function integrated between a lower and an upper limit.",[g("lower_limit"),g("upper_limit")]),
ERFC:f("This function calculates the complementary error function integrated between a lower limit and infinity.",[g("lowerlimit")]),"ERROR.TYPE":f("This function returns a number corresponding to one of the error values.",[g("error_val")]),EURO:f("This function returns the equivalent of one Euro based on the ISO currency code.",[g("code")]),EUROCONVERT:f("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[g("number"),g("source"),g("target"),g("full_precision"),g("triangulation_precision")]),EVEN:f("This function rounds the specified value up to the nearest even integer.",[g("number")]),EXACT:f("This function returns true if two strings are the same; otherwise, false.",[g("text1"),g("text2")]),EXP:f("This function returns e raised to the power of the specified value.",[g("number")]),EXPONDIST:f("This function returns the exponential distribution or the probability density.",[g("value"),g("lambda"),g("cumulative")]),FACT:f("This function calculates the factorial of the specified number.",[g("number")]),FACTDOUBLE:f("This function calculates the double factorial of the specified number.",[g("number")]),FALSE:f("This function returns the value for logical FALSE.",[]),FDIST:f("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[g("value"),g("deg_freedom1"),g("deg_freedom2")]),FIND:f("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[g("find_text"),g("within_text"),g(d)]),FINV:f("This function returns the inverse of the F probability distribution.",[g("probability"),g("deg_freedom1"),g("deg_freedom2")]),FISHER:f("This function returns the Fisher transformation for a specified value.",[g("value")]),FISHERINV:f("This function returns the inverse of the Fisher transformation for a specified value.",[g("value")]),FIXED:f("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[g("number"),g("decimals"),g("no_commas")]),FLOOR:f("This function rounds a number down to the nearest multiple of a specified value.",[g("number"),g("significance")]),FORECAST:f("This function calculates a future value using existing values.",[g("value"),g("Yarray"),g("Xarray")]),FREQUENCY:f("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[g("data_array"),g("bins_array")]),FTEST:f("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[g("array1"),g("array2")]),FV:f("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[g("rate"),g("numper"),g("paymt"),g("pval"),g("type")]),FVSCHEDULE:f("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[g("principal"),g("schedule")]),GAMMADIST:f("This function returns the gamma distribution.",[g("x"),g("alpha"),g("beta"),g("cumulative")]),GAMMAINV:f("This function returns the inverse of the gamma cumulative distribution.",[g("probability"),g("alpha"),g("beta")]),GAMMALN:f("This function returns the natural logarithm of the Gamma function, G(x).",[g("value")]),GCD:f("This function returns the greatest common divisor of two numbers.",[g("number1"),g("number2")]),GEOMEAN:f("This function returns the geometric mean of a set of positive data.",[g("number1"),g("number2",!0)]),GESTEP:f("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[g("number"),g("step")]),GROWTH:f("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[g("y"),g("x"),g("newx"),g("constant")]),HARMEAN:f("This function returns the harmonic mean of a data set.",[g("number1"),g("number2",!0)]),HEX2BIN:f("This function converts a hexadecimal number to a binary number.",[g("number"),g("places")]),HEX2DEC:f("This function converts a hexadecimal number to a decimal number.",[g("number")]),HEX2OCT:f("This function converts a hexadecimal number to an octal number.",[g("number"),g("places")]),HLOOKUP:f("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[g("lookup_value"),g("table_array"),g("row_index_num"),g("range_lookup")]),HOUR:f("This function returns the hour that corresponds to a specified time.",[g("time")]),HYPGEOMDIST:f("This function returns the hypergeometric distribution.",[g("sample_s"),g("number_sample"),g("population_s"),g("number_pop")]),IF:f("This function performs a comparison and returns one of two provided values based on that comparison.",[g("logical_test"),g("value_if_true"),g("value_if_false")]),IFERROR:f("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[g("value"),g("value_if_error")]),IMABS:f("This function returns the absolute value or modulus of a complex number.",[g("complexnum")]),IMAGINARY:f("This function returns the imaginary coefficient of a complex number.",[g("complexnum")]),IMARGUMENT:f("This function returns the argument theta, which is an angle expressed in radians.",[g("complexnum")]),IMCONJUGATE:f("This function returns the complex conjugate of a complex number.",[g("complexnum")]),IMCOS:f("This function returns the cosine of a complex number.",[g("complexnum")]),IMDIV:f("This function returns the quotient of two complex numbers.",[g("complexnum"),g("complexdenom")]),IMEXP:f("This function returns the exponential of a complex number.",[g("complexnum")]),IMLN:f("This function returns the natural logarithm of a complex number.",[g("complexnum")]),IMLOG2:f("This function returns the base-2 logarithm of a complex number.",[g("complexnum")]),IMLOG10:f("This function returns the common logarithm of a complex number.",[g("complexnum")]),IMPOWER:f("This function returns a complex number raised to a power.",[g("complexnum"),g("powernum")]),IMPRODUCT:f("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[g("complexnum1"),g("complexnum2",!0)]),IMREAL:f("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[g("complexnum")]),IMSIN:f("This function returns the sine of a complex number in the x+yi or x+yj text format.",[g("complexnum")]),IMSQRT:f("This function returns the square root of a complex number in the x+yi or x+yj text format.",[g("complexnum")]),IMSUB:f("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[g("complexnum1"),g("complexnum2")]),IMSUM:f("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[g("complexnum1"),g("complexnum2",!0)]),INDEX:f("This function returns a value or the reference to a value from within an array or range.",[g("array"),g("row_num"),g("column_num"),g("area_num")]),INDIRECT:f("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[g("ref_text"),g("[a1_style]")]),INT:f("This function rounds a specified number down to the nearest integer.",[g("number")]),INTERCEPT:f("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[g("dependent"),g("independent")]),INTRATE:f("This function calculates the interest rate for a fully invested security.",[g("settlement"),g("maturity"),g("investment"),g("redemption"),g("basis")]),IPMT:f("This function calculates the payment of interest on a loan.",[g("rate"),g("per"),g("nper"),g("pval"),g("fval"),g("type")]),IRR:f("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[g("arrayvals"),g("estimate")]),ISBLANK:f("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[g("cellreference")]),ISERR:f("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[g("cellreference")]),ISERROR:f("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[g("cellreference")]),ISEVEN:f("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[g("cellreference")]),ISLOGICAL:f("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[g("cellreference")]),ISNA:f("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[g("cellreference")]),ISNONTEXT:f("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[g("cellreference")]),ISNUMBER:f("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[g("cellreference")]),ISODD:f("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[g("cellreference")]),ISPMT:f("This function calculates the interest paid during a specific period of an investment.",[g("rate"),g("per"),g("nper"),g("pv")]),ISREF:f("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[g("cellreference")]),ISTEXT:f("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[g("cellreference")]),KURT:f("This function returns the kurtosis of a data set.",[g("number1"),g("number2"),g("number3"),g("number4",!0)]),LARGE:f("This function returns the nth largest value in a data set, where n is specified.",[g("array"),g("n")]),LCM:f("This function returns the least common multiple of two numbers.",[g("number1"),g("number2")]),LEFT:f("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[g("text"),g("num_chars")]),LEN:f("This function returns the length of the number of characters in a text string.",[g("text")]),LINEST:f("This function calculates the statistics for a line.",[g("y"),g("x"),g("constant"),g("stats")]),LN:f("This function returns the natural logarithm of the specified number.",[g("value")]),LOG:f("This function returns the logarithm base Y of a number X.",[g("number"),g("base")]),LOG10:f("This function returns the logarithm base 10 of the number given.",[g("number")]),LOGEST:f("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[g("y"),g("x"),g("constant"),g("stats")]),LOGINV:f("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[g("probability"),g("mean"),g("standard_dev")]),LOGNORMDIST:f("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[g("x"),g("mean"),g("standard_dev")]),LOOKUP:f("This function searches for a value and returns a value from the same location in a second area.",[g("lookup_value"),g("lookup_vector"),g("result_vector")]),LOWER:f("This function converts text to lower case letters.",[g("text")]),MATCH:f("This function returns the relative position of a specified item in a range.",[g("lookup_value"),g("lookup_array"),g("match_type")]),XMATCH:f("This function returns the relative position of an item in an array. By default, an exact match is required.",[g("lookup_value"),g("lookup_array"),g("[match_mode]"),g("[search_mode]")]),XLOOKUP:f("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[g("lookup_value"),g("lookup_array"),g("return_array"),g("[if_not_found]"),g("[match_mode]"),g("[search_mode]")]),MAX:f("This function returns the maximum value, the greatest value, of all the values in the arguments.",[g("number1"),g("number2",!0)]),MAXA:f("This function returns the largest value in a list of arguments, including text and logical values.",[g("value1"),g("value2",!0)]),MDETERM:f("This function returns the matrix determinant of an array.",[g("array")]),MDURATION:f("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[g("settlement"),g("maturity"),g("coupon"),g("yield"),g("frequency"),g("basis")]),MEDIAN:f("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[g("number1"),g("number2",!0)]),MID:f("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[g("text"),g("start_num"),g("num_chars")]),MIN:f("This function returns the minimum value, the least value, of all the values in the arguments.",[g("number1"),g("number2",!0)]),MINA:f("This function returns the minimum value in a list of arguments, including text and logical values.",[g("value1"),g("value2",!0)]),MINUTE:f("This function returns the minute corresponding to a specified time.",[g("time")]),MINVERSE:f("This function returns the inverse matrix for the matrix stored in an array.",[g("array")]),MIRR:f("This function returns the modified internal rate of return for a series of periodic cash flows.",[g("values"),g("finance_rate"),g("reinvest_rate")]),MMULT:f("This function returns the matrix product for two arrays.",[g("array1"),g("array2")]),MOD:f("This function returns the remainder of a division operation.",[g("dividend"),g("divisor")]),MODE:f("This function returns the most frequently occurring value in a set of data.",[g("number1"),g("number2",!0)]),MONTH:f("This function returns the month corresponding to the specified date value.",[g("date")]),MROUND:f("This function returns a number rounded to the desired multiple.",[g("number"),g("multiple")]),MULTINOMIAL:f("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[g("number1"),g("number2",!0)]),MUNIT:f("The function returns the unit matrix for the specified dimension.",[g("dimension")]),N:f("This function returns a value converted to a number.",[g("value")]),NA:f("This function returns the error value #N/A that means not available.",[]),SHEET:f("Returns the sheet number of reference sheet.",[g("[value]")]),SHEETS:f("Returns the number of sheets in a reference.",[g("[reference]")]),NEGBINOMDIST:f("This function returns the negative binomial distribution.",[g("number_f"),g("number_s"),g("probability_s")]),NETWORKDAYS:f("This function returns the total number of complete working days between the start and end dates.",[g("start_date"),g("end_date"),g("holidays")]),NOMINAL:f("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[g("effect_rate"),g("npery")]),NORMDIST:f("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[g("x"),g("mean"),g("standard_dev"),g("cumulative")]),NORMINV:f("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[g("probability"),g("mean"),g("standard_dev")]),NORMSDIST:f("This function returns the standard normal cumulative distribution function.",[g("value")]),NORMSINV:f("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[g("probability")]),NOT:f("This function reverses the logical value of its argument.",[g("logical")]),NOW:f("This function returns the current date and time.",[]),NPER:f("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[g("rate"),g("paymt"),g("pval"),g("fval"),g("type")]),NPV:f("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[g("rate"),g("value1"),g("value2",!0)]),OBJECT:f("This function converts the property/expression sequence to an object.",[g("property1",!0),g("expression1",!0)]),OCT2BIN:f("This function converts an octal number to a binary number.",[g("number"),g("places")]),OCT2DEC:f("This function converts an octal number to a decimal number.",[g("number")]),OCT2HEX:f("This function converts an octal number to a hexadecimal number.",[g("number"),g("places")]),ODD:f("This function rounds the specified value up to the nearest odd integer.",[g("number")]),ODDFPRICE:f("This function calculates the price per $100 face value of a security with an odd first period.",[g("settlement"),g("maturity"),g("issue"),g("first_coupon"),g("rate"),g("yield"),g("redemption"),g("frequency"),g("basis")]),ODDFYIELD:f("This function calculates the yield of a security with an odd first period.",[g("settlement"),g("maturity"),g("issue"),g("first_coupon"),g("rate"),g("price"),g("redemption"),g("frequency"),g("basis")]),ODDLPRICE:f("This function calculates the price per $100 face value of a security with an odd last coupon period.",[g("settlement"),g("maturity"),g("last_interest"),g("rate"),g("yield"),g("redemption"),g("frequency"),g("basis")]),ODDLYIELD:f("This function calculates the yield of a security with an odd last period.",[g("settlement"),g("maturity"),g("last_interest"),g("rate"),g("price"),g("redemption"),g("frequency"),g("basis")]),OFFSET:f("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[g("reference"),g("rows"),g("cols"),g("height"),g("width")]),OR:f("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[g("logical1"),g("logical2",!0)]),PEARSON:f("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[g("array_ind"),g("array_dep")]),PERCENTILE:f("This function returns the nth percentile of values in a range.",[g("array"),g("n")]),PERCENTRANK:f("This function returns the rank of a value in a data set as a percentage of the data set.",[g("array"),g("x"),g("significance")]),PERMUT:f("This function returns the number of possible permutations for a specified number of items.",[g("number"),g("number_chosen")]),PI:f("This function returns PI as 3.1415926536.",[]),PMT:f("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[g("rate"),g("nper"),g("pval"),g("fval"),g("type")]),POISSON:f("This function returns the Poisson distribution.",[g("nevents"),g("mean"),g("cumulative")]),POWER:f("This function raises the specified number to the specified power.",[g("number"),g("power")]),PPMT:f("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[g("rate"),g("per"),g("nper"),g("pval"),g("fval"),g("type")]),PRICE:f("This function calculates the price per $100 face value of a periodic interest security",[g("settlement"),g("maturity"),g("rate"),g("yield"),g("redemption"),g("frequency"),g("basis")]),PRICEDISC:f("This function returns the price per $100 face value of a discounted security.",[g("settlement"),g("maturity"),g("discount"),g("redemption"),g("basis")]),PRICEMAT:f("This function returns the price at maturity per $100 face value of a security that pays interest.",[g("settlement"),g("maturity"),g("issue"),g("rate"),g("yield"),g("basis")]),PROB:f("This function returns the probability that values in a range are between two limits.",[g("x_range"),g("prob_range"),g("lower_limit"),g("upper_limit")]),PRODUCT:f("This function multiplies all the arguments and returns the product.",[g("number1"),g("number2",!0)]),PROPER:f("This function capitalizes the first letter in each word of a text string.",[g("text")]),PROPERTY:f("This function returns the value of property path in object.",[g("data_expression"),g("property_path")]),PV:f("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[g("rate"),g("numper"),g("paymt"),g("fval"),g("type")]),QUARTILE:f("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[g("array"),g("quart")]),QUOTIENT:f("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[g("numerator"),g("denominator")]),RADIANS:f("This function converts the specified number from degrees to radians.",[g("angle")]),RAND:f("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:f("This function returns a random number between the numbers you specify.",[g("bottom"),g("top")]),RANGEBLOCKSPARKLINE:f("This function returns a rangetemplate.",[g("template_range"),g("data_expression")]),RANK:f("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[g("number"),g("ref"),g("order")]),RATE:f("This function returns the interest rate per period of an annuity.",[g("nper"),g("pmt"),g("pval"),g("fval"),g("type"),g("guess")]),RECEIVED:f("This function returns the amount received at maturity for a fully invested security.",[g("settlement"),g("maturity"),g("investment"),g("discount"),g("basis")]),REPLACE:f("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[g("old_text"),g("start_num"),g("num_chars"),g("new_text")]),REPT:f("This function repeats text a specified number of times.",[g("text"),g("number_times")]),RIGHT:f("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[g("text"),g("num_chars")]),ROMAN:f("This function converts an Arabic numeral to a Roman numeral text equivalent.",[g("number"),g("form")]),ROUND:f("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[g("number"),g("num_digits")]),ROUNDDOWN:f("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[g("number"),g("num_digits")]),ROUNDUP:f("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[g("number"),g("num_digits")]),ROW:f("This function returns the number of a row from a reference.",[g("reference")]),ROWS:f("This function returns the number of rows in an array.",[g("array")]),RSQ:f("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[g("array_dep"),g("array_ind")]),SEARCH:f("This function finds one text string in another text string and returns the index of the starting position of the found text.",[g("find_text"),g("within_text"),g(d)]),SECOND:f("This function returns the seconds (0 to 59) value for a specified time.",[g("time")]),SERIESSUM:f("This function returns the sum of a power series.",[g("x"),g("n"),g("m"),g("coefficients")]),SIGN:f("This function returns the sign of a number or expression.",[g("cellreference")]),SIN:f("This function returns the sine of the specified angle.",[g("angle")]),SINH:f("This function returns the hyperbolic sine of the specified number.",[g("number")]),SKEW:f("This function returns the skewness of a distribution.",[g("number1"),g("number2",!0)]),SLN:f("This function returns the straight-line depreciation of an asset for one period.",[g("cost"),g("salvage"),g("life")]),SLOPE:f("This function calculates the slope of a linear regression.",[g("array_dep"),g("array_ind")]),SMALL:f("This function returns the nth smallest value in a data set, where n is specified.",[g("array"),g("n")]),SQRT:f("This function returns the positive square root of the specified number.",[g("value")]),SQRTPI:f("This function returns the positive square root of a multiple of pi (p).",[g("multiple")]),STANDARDIZE:f("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[g("x"),g("mean"),g("standard_dev")]),STDEVA:f("This function returns the standard deviation for a set of numbers, text, or logical values.",[g("value1"),g("value2",!0)]),STDEVP:f("This function returns the standard deviation for an entire specified population (of numeric values).",[g("number1"),g("number2",!0)]),STDEVPA:f("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[g("value1"),g("value2",!0)]),STEYX:f("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[g("array_dep"),g("array_ind")]),SUBSTITUTE:f("This function substitutes a new string for specified characters in an existing string.",[g("text"),g("old_text"),g("new_text"),g("instance_num")]),SUBTOTAL:f("This function calculates a subtotal of a list of numbers using a specified built-in function.",[g("function_num"),g("ref1"),g("ref2",!0)]),SUM:f("This function returns the sum of cells or range of cells.",[g("number1"),g("number2",!0)]),SUMIF:f("This function adds the cells using a given criteria.",[g("range"),g("criteria"),g("sum_range")]),SUMIFS:f("This function adds the cells in a range using multiple criteria.",[g("sum_range"),g("criteria_range1",!0),g("criteria1",!0)]),SUMPRODUCT:f("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[g("array1"),g("array2",!0)]),SUMSQ:f("This function returns the sum of the squares of the arguments.",[g("number1"),g("number2",!0)]),SUMX2MY2:f("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[g("array_x"),g("array_y")]),SUMX2PY2:f("This function returns the sum of the sum of squares of corresponding values in two arrays.",[g("array_x"),g("array_y")]),SUMXMY2:f("This function returns the sum of the square of the differences of corresponding values in two arrays.",[g("array_x"),g("array_y")]),SYD:f("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[g("cost"),g("salvage"),g("life"),g("period")]),T:f("This function returns the text in a specified cell.",[g("value")]),TAN:f("This function returns the tangent of the specified angle.",[g("angle")]),TANH:f("This function returns the hyperbolic tangent of the specified number.",[g("number")]),TBILLEQ:f("This function returns the equivalent yield for a Treasury bill (or T-bill)",[g("settlement"),g("maturity"),g("discount")]),TBILLPRICE:f("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[g("settlement"),g("maturity"),g("discount")]),TBILLYIELD:f("This function returns the yield for a Treasury bill (or T-bill).",[g("settlement"),g("maturity"),g("priceper")]),TDIST:f("This function returns the probability for the t-distribution.",[g("x"),g("deg_freedom"),g("tails")]),TEXT:f("This function formats a number and converts it to text.",[g("value"),g("format_text")]),TIME:f("This function returns the TimeSpan object for a specified time.",[g("hour"),g("minute"),g("second")]),TIMEVALUE:f("This function returns the TimeSpan object of the time represented by a text string.",[g("time_text")]),TINV:f("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[g("probability"),g("deg_freedom")]),TODAY:f("This function returns the date and time of the current date.",[]),TRANSPOSE:f("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[g("array")]),TREND:f("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[g("y"),g("x"),g("newx"),g("constant")]),TRIM:f("This function removes extra spaces from a string and leaves single spaces between words.",[g("text")]),TRIMMEAN:f("This function returns the mean of a subset of data excluding the top and bottom data.",[g("array"),g("percent")]),TRUE:f("This function returns the value for logical TRUE.",[]),TRUNC:f("This function removes the specified fractional part of the specified number.",[g("number"),g("num_digits")]),TTEST:f("This function returns the probability associated with a t-test.",[g("array1"),g("array2"),g("tails"),g("type")]),TYPE:f("This function returns the type of value.",[g("value")]),UPPER:f("This function converts text to uppercase letters.",[g("text")]),VALUE:f("This function converts a text string that is a number to a numeric value.",[g("text")]),VAR:f("This function returns the variance based on a sample of a population, which uses only numeric values.",[g("number1"),g("number2",!0)]),VARA:f("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[g("value1"),g("value2",!0)]),VARP:f("This function returns variance based on the entire population, which uses only numeric values.",[g("number1"),g("number2",!0)]),VARPA:f("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[g("value1"),g("value2",!0)]),VDB:f("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[g("cost"),g("salvage"),g("life"),g("start_period"),g("end_period"),g("factor"),g("no_switch")]),VLOOKUP:f("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[g("lookup_value"),g("table_array"),g("col_index_num"),g("range_lookup")]),WEEKDAY:f("This function returns the number corresponding to the day of the week for a specified date.",[g("date"),g("type")]),WEEKNUM:f("This function returns a number that indicates the week of the year numerically.",[g("date"),g("weektype")]),WEIBULL:f("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[g("x"),g("alpha"),g("beta"),g("cumulative")]),WORKDAY:f("This function returns the number of working days before or after the starting date.",[g("start_date"),g("days"),g("holidays")]),XIRR:f("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[g("values"),g("dates"),g("guess")]),XNPV:f("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[g("rate"),g("values"),g("dates")]),YEAR:f("This function returns the year as an integer for a specified date.",[g("date")]),
YEARFRAC:f("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[g("start_date"),g("end_date"),g("basis")]),YIELD:f("This function calculates the yield on a security that pays periodic interest.",[g("settlement"),g("maturity"),g("rate"),g("price"),g("redemption"),g("frequency"),g("basis")]),YIELDDISC:f("This function calculates the annual yield for a discounted security.",[g("settlement"),g("maturity"),g("price"),g("redemption"),g("basis")]),YIELDMAT:f("This function calculates the annual yield of a security that pays interest at maturity.",[g("settlement"),g("maturity"),g("issue"),g("rate"),g("price"),g("basis")]),ZTEST:f("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[g("array"),g("x"),g("sigma")]),HBARSPARKLINE:f("This function returns a data set used for representing a Hbar sparkline",[g("value"),g("colorScheme"),g("axisVisible"),g("barHeight")]),VBARSPARKLINE:f("This function returns a data set used for representing a Vbar sparkline",[g("value"),g("colorScheme"),g("axisVisible"),g("barWidth")]),VARISPARKLINE:f("This function returns a data set used for representing a variance sparkline",[g("variance"),g("reference"),g("mini"),g("maxi"),g("mark"),g("tickunit"),g("legend"),g("colorPositive"),g("colorNegative"),g("vertical")]),PIESPARKLINE:f("This function returns a data set used for representing a pie sparkline",[g("range|percentage"),g("color",!0)]),AREASPARKLINE:f("This function returns a data set used for representing a area sparkline",[g("points"),g("mini"),g("maxi"),g("line1"),g("line2"),g("colorPositive"),g("colorNegative")]),SCATTERSPARKLINE:f("This function returns a data set used for representing a scatter sparkline",[g("points1"),g("points2"),g("minX"),g("maxX"),g("minY"),g("maxY"),g("hLine"),g("vLine"),g("xMinZone"),g("xMaxZone"),g("yMinZone"),g("yMaxZone"),g("tags"),g("drawSymbol"),g("drawLines"),g("color1"),g("color2"),g("dash")]),LINESPARKLINE:f("This function returns a data set used for representing a line sparkline",[g("data"),g("dataOrientation"),g("dateAxisData"),g("dateAxisOrientation"),g("setting")]),COLUMNSPARKLINE:f("This function returns a data set used for representing a column sparkline",[g("data"),g("dataOrientation"),g("dateAxisData"),g("dateAxisOrientation"),g("setting")]),WINLOSSSPARKLINE:f("This function returns a data set used for representing a win/loss sparkline",[g("data"),g("dataOrientation"),g("dateAxisData"),g("dateAxisOrientation"),g("setting")]),BULLETSPARKLINE:f("This function returns a data set used for representing a bullet sparkline",[g("measure"),g("target"),g("maxi"),g("good"),g("bad"),g("forecast"),g("tickunit"),g("colorScheme"),g("vertical"),g("measureColor"),g("targetColor"),g("maxiColor"),g("goodColor"),g("badColor"),g("forecastColor"),g("allowMeasureOverMaxi"),g("barSize")]),SPREADSPARKLINE:f("This function returns a data set used for representing a spread sparkline",[g("points"),g("showAverage"),g("scaleStart"),g("scaleEnd"),g("style"),g("colorScheme"),g("vertical")]),STACKEDSPARKLINE:f("This function returns a data set used for representing a stacked sparkline",[g("points"),g("colorRange"),g("labelRange"),g("maximum"),g("targetRed"),g("targetGreen"),g("targetBlue"),g("tragetYellow"),g("color"),g("highlightPosition"),g("vertical"),g("textOrientation"),g("textSize")]),BOXPLOTSPARKLINE:f("This function returns a data set used for representing a boxplot sparkline",[g("points"),g("boxPlotClass"),g("showAverage"),g("scaleStart"),g("scaleEnd"),g("acceptableStart"),g("acceptableEnd"),g("colorScheme"),g("style"),g("vertical")]),CASCADESPARKLINE:f("This function returns a data set used for representing a cascade sparkline",[g("pointsRange"),g("pointIndex"),g("labelsRange"),g("minimum"),g("maximum"),g("colorPositive"),g("colorNegative"),g("vertical"),g("itemTypeRange"),g("colorTotal")]),PARETOSPARKLINE:f("This function returns a data set used for representing a pareto sparkline",[g("points"),g("pointIndex"),g("colorRange"),g("target"),g("target2"),g("highlightPosition"),g("label"),g("vertical"),g("targetColor"),g("target2Color"),g("labelColor"),g("barSize")]),MONTHSPARKLINE:f("This function returns a data set used for representing a month sparkline",[g("year"),g("month"),g("dataRange"),g("emptyColor"),g("startColor"),g("middleColor"),g("endColor")]),YEARSPARKLINE:f("This function returns a data set used for representing a year sparkline",[g("year"),g("dataRange"),g("emptyColor"),g("startColor"),g("middleColor"),g("endColor")]),GAUGEKPISPARKLINE:f("This function returns a data set used for representing a gauge KPI sparkline",[g("targetValue"),g("currentValue"),g("minValue"),g("maxValue"),g("showLabel"),g("targetValueLabel"),g("currentValueLabel"),g("minValueLabel"),g("maxValueLabel"),g("fontArray"),g("minAngle"),g("maxAngle"),g("radiusRatio"),g("gaugeType"),g("colorRange"),g("...")]),HISTOGRAMSPARKLINE:f("This function returns a data set used for representing a histogram sparkline",[g("dateRange"),g("continuous"),g("paintLabel"),g("scale"),g("barWidth"),g("barColor"),g("labelFontStyle"),g("labelColor"),g("edgeColor")]),"CEILING.PRECISE":f("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[g("number"),g(e)]),"COVARIANCE.S":f("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[g("array1"),g("array2")]),"FLOOR.PRECISE":f("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[g("number"),g(e)]),"PERCENTILE.EXC":f("This function returns the nth percentile of values in a range.",[g("array"),g("k")]),"QUARTILE.EXC":f("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[g("array"),g("quart")]),"RANK.AVG":f("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[g("number"),g("ref"),g("[order]")]),"MODE.MULT":f("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[g("number1"),g("number2",!0)]),"STDEV.P":f("This function returns the standard deviation for an entire specified population (of numeric values).",[g("number1"),g("number2",!0)]),"VAR.P":f("This function returns variance based on the entire population, which uses only numeric values.",[g("number1"),g("number2",!0)]),"COVARIANCE.P":f("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[g("array1"),g("array2")]),"MODE.SNGL":f("This function returns the most frequently occurring value in a set of data.",[g("number1"),g("number2",!0)]),"PERCENTILE.INC":f("This function returns the nth percentile of values in a range.",[g("array"),g("k")]),"QUARTILE.INC":f("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[g("array"),g("quart")]),"RANK.EQ":f("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[g("number"),g("ref"),g("[order]")]),STDEV:f("This function returns standard deviation is estimated based on a sample.",[g("number1"),g("number2",!0)]),"STDEV.S":f("This function returns standard deviation is estimated based on a sample.",[g("number1"),g("number2",!0)]),"VAR.S":f("This function returns the variance based on a sample of a population, which uses only numeric values.",[g("number1"),g("number2",!0)]),"BETA.INV":f("This function calculates the inverse of the cumulative beta distribution function.",[g("probability"),g("alpha"),g("beta"),g("[lower]"),g("[upper]")]),"BINOM.DIST":f("This function calculates the individual term binomial distribution probability.",[g("number_s"),g("trials"),g("probability_s"),g("cumulative")]),"BINOM.INV":f("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[g("trials"),g("probability_s"),g("alpha")]),"CHISQ.DIST.RT":f("This function calculates the one-tailed probability of the chi-squared distribution.",[g("value"),g("deg_freedom")]),"CHISQ.INV.RT":f("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[g("probability"),g("deg_freedom")]),"CHISQ.TEST":f("This function calculates the test for independence from the chi-squared distribution.",[g("actual_range"),g("expected_range")]),"CONFIDENCE.NORM":f("This function returns confidence interval for a population mean.",[g("alpha"),g("standard_dev"),g("size")]),"EXPON.DIST":f("This function returns the exponential distribution or the probability density.",[g("value"),g("lambda"),g("cumulative")]),"F.DIST.RT":f("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[g("value"),g("deg_freedom1"),g("deg_freedom2")]),"F.INV.RT":f("This function returns the inverse of the F probability distribution.",[g("probability"),g("deg_freedom1"),g("deg_freedom2")]),"F.TEST":f("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[g("array1"),g("array2")]),"GAMMA.DIST":f("This function returns the gamma distribution.",[g("x"),g("alpha"),g("beta"),g("cumulative")]),"GAMMA.INV":f("This function returns the inverse of the gamma cumulative distribution.",[g("probability"),g("alpha"),g("beta")]),"LOGNORM.INV":f("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[g("probability"),g("mean"),g("standard_dev")]),"NORM.DIST":f("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[g("x"),g("mean"),g("standard_dev"),g("cumulative")]),"NORM.INV":f("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[g("probability"),g("mean"),g("standard_dev")]),"NORM.S.INV":f("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[g("probability")]),"PERCENTRANK.INC":f("This function returns the rank of a value in a data set as a percentage of the data set.",[g("array"),g("n"),g(e)]),"POISSON.DIST":f("This function returns the Poisson distribution.",[g("nevents"),g("mean"),g("cumulative")]),"T.INV.2T":f("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[g("probability"),g("deg_freedom")]),"T.TEST":f("This function returns the probability associated with a t-test.",[g("array1"),g("array2"),g("tails"),g("type")]),"WEIBULL.DIST":f("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[g("x"),g("alpha"),g("beta"),g("cumulative")]),"Z.TEST":f("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[g("array"),g("x"),g("[sigma]")]),"T.DIST.RT":f("This function returns the right-tailed t-distribution.",[g("x"),g("deg_freedom")]),"T.DIST.2T":f("This function returns the two-tailed t-distribution.",[g("x"),g("deg_freedom")]),"ISO.CEILING":f("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[g("number"),g(e)]),"BETA.DIST":f("This function returns the beta distribution.",[g("x"),g("alpha"),g("beta"),g("cumulative"),g("lower"),g("upper")]),"GAMMALN.PRECISE":f("This function returns the natural logarithm of the gamma function.",[g("value")]),"ERF.PRECISE":f("This function returns the error function.",[g("lowerlimit")]),"ERFC.PRECISE":f("This function returns the complementary ERF function.",[g("lowerlimit")]),"PERCENTRANK.EXC":f("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[g("array"),g("x"),g(e)]),"HYPGEOM.DIST":f("This function returns the hypergeometric distribution.",[g("sample_s"),g("number_sample"),g("population_s"),g("number_pop"),g("cumulative")]),"LOGNORM.DIST":f("This function returns the log normal distribution of x.",[g("x"),g("mean"),g("stdev"),g("cumulative")]),"NEGBINOM.DIST":f("This function returns the negative binomial distribution.",[g("number_f"),g("number_s"),g("probability_s"),g("cumulative")]),"NORM.S.DIST":f("This function returns the standard normal distribution.",[g("z"),g("cumulative")]),"T.DIST":f("This function returns the t-distribution.",[g("x"),g("deg_freedom"),g("cumulative")]),"F.DIST":f("This function returns the F probability distribution.",[g("x"),g("deg_freedom1"),g("deg_freedom2"),g("cumulative")]),"CHISQ.DIST":f("This function returns the chi-squared distribution.",[g("x"),g("deg_freedom"),g("cumulative")]),"F.INV":f("This function returns the inverse of the F probability distribution.",[g("probability"),g("deg_freedom1"),g("deg_freedom2")]),"T.INV":f("This function returns the left-tailed inverse of the t-distribution.",[g("probability"),g("deg_freedom")]),"CHISQ.INV":f("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[g("probability"),g("deg_freedom")]),"CONFIDENCE.T":f("This function returns the confidence interval for a Student's t distribution.",[g("alpha"),g("standard_dev"),g("size")]),"NETWORKDAYS.INTL":f("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[g("start_date"),g("end_date"),g("[weekend]"),g("[holidays]")]),"WORKDAY.INTL":f("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[g("start_date"),g("days"),g("[weekend]"),g("[holidays]")]),REFRESH:f("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[g("formula"),g("evaluateMode"),g("interval")]),DAYS:f("This function returns the number of days between two dates.",[g("end_date"),g("start_date")]),ISOWEEKNUM:f("This function returns the number of the ISO week number of the year for a given date.",[g("date")]),BITAND:f('This function returns a bitwise "AND" of two numbers.',[g("number1"),g("number2")]),BITLSHIFT:f('This function returns a bitwise "OR" of two numbers.',[g("number"),g("shift_amount")]),BITOR:f('This function returns a bitwise "OR" of two numbers.',[g("number1"),g("number2")]),BITRSHIFT:f('This function returns a bitwise "OR" of two numbers.',[g("number"),g("shift_amount")]),BITXOR:f('This function returns a bitwise "XOR" of two numbers.',[g("number1"),g("number2")]),IMCOSH:f("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[g("complexnum")]),IMCOT:f("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[g("complexnum")]),IMCSC:f("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[g("complexnum")]),IMCSCH:f("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[g("complexnum")]),IMSEC:f("This function returns the secant of a complex number in x+yi of x+yj text format.",[g("complexnum")]),IMSECH:f("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[g("complexnum")]),IMSINH:f("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[g("complexnum")]),IMTAN:f("This function returns the tangent of a complex number in x+yi or x+yj text format.",[g("complexnum")]),PDURATION:f("This function returns the number of periods required by an investment to reach a specified value.",[g("rate"),g("pval"),g("fval")]),RRI:f("This function returns an equivalent interest rate for the growth of an investment.",[g("nper"),g("pval"),g("fval")]),ISFORMULA:f("This function tests whether contains a formula of a referenced cell.",[g("cellreference")]),IFNA:f("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[g("value"),g("value_if_na")]),IFS:f("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[g("logical_test1"),g("value_if_true1",!0)]),SWITCH:f("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[g("expression"),g("value1"),g("result1"),g("[default_or_value2]",!0),g("[result2]",!0)]),XOR:f("This function returns a logical exclusive or of all arguments.",[g("logical",!0)]),AREAS:f("This function returns the number of areas in a reference.",[g("reference")]),FORMULATEXT:f("This function returns a formula as a string.",[g("reference")]),HYPERLINK:f("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[g("link_location"),g("friendly_name")]),ACOT:f("This function calculates the inverse arccotangent of a number.",[g("number")]),ACOTH:f("This function calculates the inverse hyperbolic arccotangent of a number.",[g("number")]),ARABIC:f("This function converts a Roman numeral text to an Arabic numeral equivalent.",[g("text")]),BASE:f("This function converts a number into a text representation with the given radix (base).",[g("number"),g("radix"),g("[min_length]")]),"CEILING.MATH":f("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[g("number"),g(e),g("[mode]")]),COMBINA:f("This function calculates the number of possible combinations with repetitions for a specified number of items.",[g("number"),g("number_chosen")]),COT:f("This function returns the cotangent of the specified angle.",[g("angle")]),COTH:f("This function returns the hyperbolic cotangent of the specified number.",[g("value")]),CSC:f("This function returns the cosecant of the specified angle.",[g("angle")]),CSCH:f("This function returns the hyperbolic cosecant of the specified number.",[g("value")]),DECIMAL:f("This function converts a text representation of a number in a given base into a decimal number.",[g("text"),g("radix")]),"FLOOR.MATH":f("This function round a number down to the nearest integer or to the nearest multiple of significance.",[g("number"),g(e),g("[mode]")]),SEC:f("This function returns the secant of the specified angle.",[g("angle")]),SECH:f("This function returns the hyperbolic secant of the specified value.",[g("value")]),"BINOM.DIST.RANGE":f("This function calculates the probability of a trial result using a binomial distribution.",[g("trials"),g("probability_s"),g("number_s"),g("[number_s2]")]),GAMMA:f("This function returns the gamma function value.",[g("number")]),MAXIFS:f("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[g("max_range"),g("criteria_range",!0),g("criteria",!0)]),GAUSS:f("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[g("number")]),MINIFS:f("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[g("min_range"),g("criteria_range",!0),g("criteria",!0)]),PERMUTATIONA:f("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[g("number"),g("number_chosen")]),PHI:f("This function returns the value of the density function for a standard normal distribution.",[g("value")]),"SKEW.P":f("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[g("number1"),g("number2",!0)]),BAHTTEXT:f('This function converts a number to Thai text and adds a suffix of "Baht"',[g("number")]),CONCAT:f('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[g("text1"),g("text2",!0)]),FINDB:f("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[g("find_text"),g("within_text"),g(d)]),LEFTB:f("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[g("text"),g("num_bytes")]),LENB:f("This function returns the length of the number of bytes in a text string.",[g("text")]),MIDB:f("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[g("text"),g("start_num"),g("num_bytes")]),REPLACEB:f("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[g("old_text"),g("start_byte"),g("num_bytes"),g("new_text")]),RIGHTB:f("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[g("text"),g("num_bytes")]),SEARCHB:f("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[g("find_text"),g("within_text"),g(d)]),TEXTJOIN:f("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[g("delimiter"),g("ignore_empty"),g("text1"),g("text2",!0)]),UNICHAR:f("This function returns the Unicode character of a given numeric reference.",[g("number")]),UNICODE:f("This function returns the number corresponding to the first character of the text.",[g("text")]),ENCODEURL:f("This function returns a URL-encoded string.",[g("text")]),BC_QRCODE:f("This function returns a data set for representing a QRCode",[g("value"),g("color"),g("backgroundColor"),g("errorCorrectionLevel"),g("model"),g("version"),g("mask"),g("connection"),g("connectionNo"),g("charCode"),g("charset"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_EAN13:f("This function returns a data set for representing a EAN13.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("addOn"),g("addOnLabelPosition"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_EAN8:f("This function returns a data set for representing a EAN8.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_CODABAR:f("This function returns a data set for representing a CODABAR.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("checkDigit"),g("nwRatio"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_CODE39:f("This function returns a data set for representing a CODE39.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("labelWithStartAndStopCharacter"),g("checkDigit"),g("nwRatio"),g("fullASCII"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_CODE93:f("This function returns a data set for representing a CODE93.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("checkDigit"),g("fullASCII"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_CODE128:f("This function returns a data set for representing a CODE128.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("codeSet"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_GS1_128:f("This function returns a data set for representing a GS1_128.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_CODE49:f("This function returns a data set for representing a CODE49.",[g("value"),g("color"),g("backgroundColor"),g("showLabel"),g("labelPosition"),g("grouping"),g("groupNo"),g("fontFamily"),g("fontStyle"),g("fontWeight"),g("textDecoration"),g("textAlign"),g("fontSize"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_PDF417:f("This function returns a data set for representing a PDF417.",[g("value"),g("color"),g("backgroundColor"),g("errorCorrectionLevel"),g("rows"),g("columns"),g("compact"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),BC_DATAMATRIX:f("This function returns a data set for representing a DATAMATRIX.",[g("value"),g("color"),g("backgroundColor"),g("eccMode"),g("ecc200SymbolSize"),g("ecc200EncodingMode"),g("ecc00_140SymbolSize"),g("structuredAppend"),g("structureNumber"),g("fileIdentifier"),g("quietZoneLeft"),g("quietZoneRight"),g("quietZoneTop"),g("quietZoneBottom")]),FILTER:f("This function filter a range or array.",[g("array"),g("include"),g("if_empty")]),RANDARRAY:f("This function returns an array of random numbers.",[g("rows"),g("columns"),g("min"),g("max"),g("whole_number")]),SEQUENCE:f("This function returns a sequence of numbers.",[g("rows"),g("columns"),g("start"),g("step")]),SINGLE:f("This function returns a single value when given a value, range or array.",[g("value")]),SORT:f("This function sorts a range or array.",[g("array"),g("sort_index"),g("sort_order"),g("by_col")]),SORTBY:f("This function sorts a range or array based on the values in a corresponding range or array.",[g("array"),g("by_array1"),g("sort_order1"),g("by_array2",!0),g("sort_order2",!0)]),UNIQUE:f("This function returns the unique values from a range or array.",[g("array"),g("by_col"),g("exactly_once")]),LET:f("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[g("name1"),g("name_value1"),g("calculation_or_name2"),g("[name_value2, ...")]),IMAGE:f("This function input an URL or a base64 string to show an image in cell",[g("URL"),g("[mode]"),g("[height]"),g("[width]"),g("[clipY]"),g("[clipX]"),g("[clipHeight]"),g("[clipWidth]"),g("[vAlign]"),g("[hAlign]")]),GETPIVOTDATA:f("This function extracts data stored in a PivotTable",[g("data_field"),g("pivot_table"),g("[field1, item1]"),g("...")]),WEBSERVICE:f("This function returns data from a web service",[g("url")]),FILTERJSON:f("This function parses json string to a scalar value, an object or an array of objects.",[g("json_string")]),ASC:f("The ASC function changes full-width(double-byte) characters to half-width(single-byte) characters, Use with double-byte character sets (DBCS).",[g("text")]),DBCS:f("The DBCS function converts half-width(single-byte) letters within a character string to full-width(double-byte) characters.",[g("text")]),LAMBDA:f("Creates a function value, which can be called within formulas.",[g("parameter_or_calculation"),g("[parameter_or_calculation]",!0)]),MAP:f("Returns an array formed by mapping each value in the array(s) to a new value by applying a LAMBDA to create a new value.",[g("array"),g("lambda_or_array",!0)]),REDUCE:f("Reduces an array to an accumulated value by applying a LAMBDA to each value and returning the total value in the accumulator.",[g("init_value"),g("array"),g("function")]),SCAN:f("Scans an array by applying a LAMBDA to each value and returns an array that has each intermediate value.",[g("init_value"),g("array"),g("function")]),MAKEARRAY:f("Returns a calculated array of a specified row and column size, by applying a LAMBDA.",[g("rows"),g("cols"),g("function")]),BYCOL:f("Applies a LAMBDA to each column and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 3 columns by 1 row.",[g("array"),g("function")]),BYROW:f("Applies a LAMBDA to each row and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 1 column by 2 rows.",[g("array"),g("function")]),ISOMITTED:f("Checks whether the value in a LAMBDA is missing and returns TRUE or FALSE.",[g("argument")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=c("./src/calc.ts"),g=d.Common.j.Fa,h=null,i=void 0,j=Math.pow,k=Math.min,l=Math.max,m="string",n="boolean",o=e.Convert.Th,p=e.Convert.vf,q=e.Convert.Ph,r=e.Convert.Ca,s=e.Convert.Fh,t=e.Errors.Reference,u=e.Errors.Value,v=e.Errors.Name,w=e.Errors.NotAvailable,x=e.Errors.DivideByZero,y=e.Errors.Number,z=e.Errors.Calc;function M(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}function N(a,b){var c,d,e,f=a.getRangeCount(),g=a.xf,h=b.source.getCalcSourceModel().qg(b.identity.row,b.identity.col,!0);for(c=0;c<f;c++)d=a.yf[c],d.id=g.id,g.getRangeKey&&(e=g.getRangeKey(g,d),h&&(h.eOb||(h.eOb={}),h.eOb[e]=d))}function O(a){return a&&a.getRowCount&&(a.getRowCount()>1||a.getColumnCount()>1)}A=function(){function a(a,b,c,d,f){var g,h,i=[];for(g=5;g<arguments.length;g++)i[g-5]=arguments[g];this.si=0,this.ti=0,this.ui=0,this.localScopes=new e.LocalScopes,this.lambdaFunctionCallDepth=0,h=this,h.source=a,h.arrayFormulaMode=!!c,h.identity=b||h.$Ab(0,0),h.arrayIdentity=d,h.row=d?d.row:h.identity.row||0,h.column=d?d.col:h.identity.col||0,h.rowOffset=d?h.identity.row-d.row:h.row,h.columnOffset=d?h.identity.col-d.col:h.column,
h.Lf=f}return a.prototype.$Ab=function(a,b){return{row:a,col:b}},a.prototype.fga=function(a){return a===e.BangSource?this.source:a},a.prototype.getValue=function(a,b){return a?this.fga(a).getValue(b):t},a.prototype.getReference=function(a,b){return a?this.fga(a).getReference(b):t},a.prototype.getSheetRangeReference=function(a){return!a||!a.source||!a.endSource||a.source instanceof e.ErrorSource?t:this.fga(a.source).getSheetRangeReference(a)},a.prototype.getFunction=function(a){var b=this;return b.source?b.source.getCustomFunction(a):h},a.prototype.getName=function(a){var b,c=this,d=c.source?c.source.getCustomName(a):h;return!d&&c.source&&(b=c.source.Cf().getGlobalSourceModel(),d=b&&b.getSource().getCustomName(a)),d},a.prototype.getNameInfo=function(a){var b,c=this,d=c.source?c.source.getCustomNameInfo(a):h;return!d&&c.source&&(b=c.source.Cf().getGlobalSourceModel(),d=b&&b.getSource().getCustomNameInfo(a)),d},a.prototype.getField=function(a){var b=this;return b.source?b.source.getField(a):h},a.prototype.getFieldItem=function(a){var b=this;return b.source?b.source.getFieldItem(a):h},a.prototype.vi=function(){return this.ui>0},a.prototype.wi=function(){this.ui++},a.prototype.xi=function(){this.ui--},a.prototype.SetAsyncResult=function(a,b){this.source.Cf().lh.SetAsyncResult(a,b)},a.prototype.cloneFrom=function(a){var b=this;b.acceptsReference=a.acceptsReference,b.arrayFormulaMode=a.arrayFormulaMode},a}(),b.EvaluateContext=A,e.CalcSource.prototype.getEvaluatorContext=function(a,b,c,d){return new A(this,a,b,c,d)},B=function(){function a(a,b){this.id=a.si++,this.ctx=a,this.row=a.row+(a.arrayFormulaMode&&a.rowOffset||0),this.col=a.column+(a.arrayFormulaMode&&a.columnOffset||0),this.node=b}return a.prototype.setAsyncResult=function(a){this.node.Fi=a,this.node.v5=!0,this.ctx.SetAsyncResult(this,a),this.ctx.source.refresh()},a.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},a.prototype.DIc=function(){var a,b=this.node&&this.node.parent&&this.node.parent.oi||[];for(a=0;a<b.length;a++)if(!b[a].v5)return!1;return!0},a}(),b.AsyncEvaluateContext=B,C=function(a){L(b,a);function b(b,c,d,e,f,g,i,j){var k=a.call(this,b,isNaN(j)?h:{row:i,col:j},c,isNaN(g)?h:{row:d,col:e,rowCount:f,colCount:g})||this,l=b.Cf().getGlobalSourceModel(b);return k.yi=l&&l.getSource(),k}return b.prototype.getName=function(a){var b=this;return b.yi?b.yi.getCustomName(a):h},b}(A),b.GloableEvaluateContext=C;function P(a,b){return a&&b?a.row===b.row&&a.col===b.col:a===b}D=function(){function a(a){this.service=a,this.asyncManager=new F(this)}return a.prototype.evaluateExpression=function(a,b,c,f,g){var j,k,l=void 0===a.type&&a.Lf?a.Lf:a,m=this.evaluate(l,b,!!f,!!g);return m&&m.pause?m:e.isLambdaFunction(m)?z:m===i||m===h?c===!1?m:0:((r(m)&&!f||s(m)&&!g)&&(m=this.getOneValue(b,m)),j=15,"number"==typeof m&&m>-10&&m<10&&(k=""+m,(k.indexOf("000000000000")>1||k.indexOf("999999999999")>1)&&(j=14)),d.Common.o.Lma(m,e.Functions.CALC_PRECISION||j))},a.prototype.evaluate=function(a,b,c,d){var f,g,j,k;if(!a)throw e.sR().Exp_ExprIsNull;if(void 0===a.type){if(a._error)return a;a.Lf&&(a=a.Lf)}for(;10===a.type;)a=a.value;if(f=this,j=h,12===a.type?(j=a.needExpendIndexs,a=a.value):b.Exb&&(c=!0,j=[]),k=a.type,k>=2&&k<=6)g=f.evaluateConst(a,b,c);else if(1===k||13===k)g=f.evaluateReference(a,b,d,c);else if(8===k)g=f.evaluateName(a,b,c,d);else if(100===k)g=f.evaluateLocalName(a,b);else if(9!==k||a.value2){if(9===k)g=f.evaluateBinaryOperation(a,b,c,d,j);else if(7===k){if(a.QDc&&b.NMc&&(g=f.evaluateBranchFunction(a,b,c,d,j),g&&g.pause))return g;g=f.evaluateFunction(a,b,c,d,j)}else if(11===k)g=i;else if(14===k)g=f.evaluateField(a,b);else if(15===k)g=f.evaluateFieldItem(a,b);else if(b.evaluate)return b.evaluate(a,c,d)}else g=f.evaluateUnaryOperation(a,b,c,d,j);return g},a.prototype.evaluateConst=function(a,b,c){var d=a.value;return r(d)?c||b&&(b.arrayFormulaMode||b.vi())?d:d.getValue(0,0):d},a.prototype.evaluateReference=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,v,w;if(!b)return u;if(f=a.source||b.source,g=isNaN(b.row)?0:b.row,h=isNaN(b.column)?0:b.column,i=a.getRange&&a.getRange(g,h),j=a.type,!i)return 13===j?u:t;if(k=i.row<0?0:i.row,l=i.col<0?0:i.col,m=i.rowCount,n=i.colCount,i.row<0&&(i.rowUndefine=!0),i.col<0&&(i.colUndefine=!0),d&&(o=f.getRowCount(),p=f.getColumnCount(),(m===-1||m>o)&&(m=o),(n===-1||n>p)&&(n=p)),c||b.arrayFormulaMode)return a.endSource?b.getSheetRangeReference({source:a.source,endSource:a.endSource,row:k,col:l,rowCount:m,colCount:n}):b.getReference(f,i);if(d&&(m>1||n>1)){for(q=[],r=0;r<m;r++)for(q[r]=[],s=0;s<n;s++)q[r][s]=f.getValue(r+k,s+l);return new e.CalcArray(q)}if(m>1||n>1)if(v=g>=i.row&&g<i.row+m,w=h>=i.col&&h<i.col+n,v&&w)k=g,l=h;else{if(!v&&!w)return u;if(v&&1===n)k=g;else{if(!w||1!==m)return u;l=h}}else if(i.row===-1&&m===-1){if(1!==n)return u;k=g}else if(i.col===-1&&n===-1){if(1!==m)return u;l=h}return f.getValue(k,l)},a.prototype.evaluateName=function(a,b,c,d){var e,g,h;return b?(a.source&&(e=a.source,b=e.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),(g=b.getName(a.value))?(h=f.Mh(b,g,!1,0,0,c,d),this.evaluate(h,b,c,d)):v):v},a.prototype.evaluateLocalName=function(a,b){var c,d,f,g,h,i,j,k;if(!a.value||!b||!b.localScopes.hasVariable(a.value))return v;if(c=b.localScopes.getVariable(a.value),d=b.source&&b.source.Af&&b.source.Af.allowDynamicArray,!d){if(f=a.t0a,g=a.t$c,b.arrayFormulaMode&&b.vi())return c;if(r(c)&&!f)return this.getOneValue(b,c);if(s(c)&&!g){if(h=c,f&&1===h.getRangeCount()){for(i=[],j=0;j<h.getRowCount(0);j++)for(i[j]=[],k=0;k<h.getColumnCount(0);k++)i[j][k]=h.getValue(0,j,k);return new e.CalcArray(i)}return this.getOneValue(b,c)}}return c},a.prototype.evaluateUnaryOperation=function(a,b,c,d,f){var g,h=!1;return f&&f.length>0&&(c=!0,h=!0),g=this.evaluate(a.value,b,c,h),g&&g.pause?g:e.Convert.vf(g)?g:g===e.missingArgument?w:this.evaluateWithArgs(a,function(c){return c[0]&&c[0].getRowCount&&b.Exb&&b.Lf&&(b.Lf.hJc=!0),T(a.operatorType,c[0],b.Exb)},b,f,[g],c,d)},a.prototype.evaluateBinaryOperation=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p=b.Exb;if(p&&(c=!0),g=[c,c],h=a.operatorType>=15,i=[h,h],f&&f.length>0)for(j=0;j<f.length;j++)g[f[j]]=!0,i[f[j]]=!0;for(k=function(a,b){if(0===b){for(;10===a.type;)a=a.value;if(7===a.type&&a.function&&e.isFunction(a.function)&&a.function.TAb)return null}return b},l=[a.value,a.value2],m=[],j=0;j<2;j++){if(n=this.evaluate(l[j],b,g[j],i[j]),n&&n.pause)return n;if(o=k(l[j],n),e.Convert.vf(o))return o;if(o===e.missingArgument)return w;m[j]=o}return this.evaluateWithArgs(a,function(c){return b.Lf&&(O(c[0])||O(c[1]))&&(b.Lf.hJc=!0),T(a.operatorType,c[0],c[1])},b,f,m,c,d)},a.prototype.evaluateField=function(a,b){var c,d;return b?(a.source&&(c=a.source,b=c.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),d=b.getField(a.value),g(d)?w:d):v},a.prototype.evaluateFieldItem=function(a,b){var c,d;return b?(a.source&&(c=a.source,b=c.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),d=b.getFieldItem(a.value),g(d)?w:d):v},a.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},a.prototype.endCache=function(){this.Bi=h},a.prototype.evaluateBranchFunction=function(a,b,c,d,f){var h,i,j,k,l,m,n;if(g(a.PDc)&&e.isFunction(a.function))return h=a.function,i=a.arguments.length,j=h.findTestArgument(),k=this.preprocessFunction(b,h,i,f,c),l=k.acceptsArrays,m=k.keepArrayValuesFlagSet,n=this.testArgGetBranch(b,h,a,l[j],!1,j),n&&n.pause?n:(m&&delete b.Exb,n.branchArgument>=0&&"number"==typeof n.branchArgument?(a.PDc=!0,b.source.ODc=b.source.ODc||[],b.source.ODc.push(a),{pause:"Branch",branch:a.RDc[n.branchArgument]}):void(n.testArgValue._error||delete a.QDc))},a.prototype.evaluateLetFunction=function(a,b,c,d){var e,f,g,h,i,j,k=a.arguments.length,l=this;for(b.localScopes.enterScope(),f=1;f<k-1;f+=2){if(g=a.arguments[f-1],h=a.arguments[f],i=g.value,e=l.evaluate(h,b,c,d),e&&e.pause)return e;b.localScopes.setVariable(i,e)}return j=l.evaluate(a.arguments[k-1],b,c,d),j&&j.pause?j:(b.localScopes.exitScope(),j)},a.prototype.evaluateLambdaFunction=function(a,b,c,d){return b.source&&b.source.Af&&b.source.Af.allowDynamicArray&&(b.Lf.hJc=!0),new e.Functions.LambdaFunction(a,b.localScopes.createClosure())},a.prototype.evaluateISOMITTEDFunction=function(a,b,c,d){var e=a.arguments[0];return e&&100===e.type&&null===b.localScopes.getVariable(e.value)},a.prototype.preprocessFunction=function(a,b,c,d,e){var f,g,i,j,k=[],l=[],m=a.Exb,n=!1,o=h;for(!m&&(1===b.arrayArgumentEvaluateMode||4===b.arrayArgumentEvaluateMode&&e)&&(m=a.Exb=!0,n=!0),f=0;f<c;f++)k[f]=b.acceptsArray(f),l[f]=b.acceptsReference(f);if(d&&d.length>0||m){for(o=[],f=0;f<c;f++)o[f]=!0;for(g=m?c:d.length,f=0;f<g;f++)i=m?f:d[f],k[i]=!0,l[i]=!0,j=!(b.acceptsReference(i)&&!b.acceptsArray(i)),j&&m&&b.acceptsReference(i)&&(j=!1),o[i]=j}return b.isBranch()&&(a.arrayFormulaMode||a.vi())&&(k[b.findTestArgument()]=!0,l[b.findTestArgument()]=!0),{acceptsArrays:k,acceptsReferences:l,getReferenceValues:o,keepArrayValuesFlagSet:n}},a.prototype.testArgGetBranch=function(a,b,c,d,e,f){var g,h=-1,i=a.Exb;return a.arrayFormulaMode&&(a.Exb=!0),b.acceptsArray(f)&&a.wi(),g=this.evaluate(c.arguments[f],a,d,e),g&&g.pause?g:(b.acceptsArray(f)&&a.xi(),a.Exb=i,s(g)||r(g)||(h=b.findBranchArgument(g)),{testArgValue:g,branchArgument:h})},a.prototype.evaluateFunction=function(a,b,c,d,f){var g;try{g=!a.function||e.isExpression(a.function)?this.evaluateLambdaFunctionCall(a,b,c,d,f):this.evaluateBuildInFunction(a,b,c,d,f)}catch(a){if(e.isStackOverflowError(a)){if(b.lambdaFunctionCallDepth>=2)throw a;g=y}else g=u}return g},a.prototype.evaluateBuildInFunction=function(a,b,c,d,f){if(!a||!a.function||!e.isFunction(a.function))return v;var g=a.function,h=a.functionName,i=this,j=b.ti;return"LET"===h?i.evaluateLetFunction(a,b,c,d):"LAMBDA"===h?i.evaluateLambdaFunction(a,b,c,d):"ISOMITTED"===h?i.evaluateISOMITTEDFunction(a,b,c,d):i.evaluateFunctionCore(a,function(a,c,f){var h,k,l,m,n,o=aa(a,g.Ci);return a=o.Di,o.Ei?g.isContextSensitive()?(b.acceptsReference=d||b.vi(),g instanceof e.Functions.AsyncFunction?(i.T4=i.T4||{},g.evaluateWhenArgumentsIsSame()?i.evaluateAsyncFunction(b,c,g,j,a,f):i.evaluateWithCache(g,a,function(){return i.evaluateAsyncFunction(b,c,g,j,a,f)},i.T4)):g.evaluateWithContext(b,a)):(k=b.arrayFormulaMode,k&&(g.y0a={row:b.rowOffset,col:b.columnOffset}),l=e.getMapping()&&e.getMapping().builtInFunctionsMapping,m=l&&l[g.name]&&l[g.name].specialFun,n=function(){return m&&m.apply(g,a)||g.evaluate.apply(g,a)},h=k?i.evaluateWithCache(g,a,n,i.Bi):n(),delete g.y0a,h):o.Fi},b,c,d,f)},a.prototype.tryGetLambdaFunction=function(a,b,c,d){var f,g;if(e.isExpression(a.function))f=this.evaluate(a.function,b,c,d);else if(a.isLocalFunctionName?f=b.localScopes.getVariable(a.functionName):(g=b.getName(a.functionName),g&&(f=this.evaluate(g,b,c,d))),!f)return v;return f&&f.pause?f:p(f)?f:e.isLambdaFunction(f)?f:u},a.prototype.evaluateLambdaFunctionCall=function(a,b,c,d,f){var g,h,i=this,j=this.tryGetLambdaFunction(a,b,c,d);return j&&j.pause?j:p(j)?j:(g=j,h=e.Jh(j,a.arguments),this.evaluateFunctionCore(h,function(a){var e,f,h,j=b.localScopes;try{if(b.lambdaFunctionCallDepth++,j.enterScope(),j.saveThenSwitchClosure(g.closure),f=g.parameters,f.length!==a.length)return u;for(h=0;h<f.length;h++)b.localScopes.setVariable(f[h].value,a[h]);e=i.evaluate(g.calculation,b,c,d)}finally{b.lambdaFunctionCallDepth--,j.exitScope(),j.restoreClosure()}return e},b,c,d,f))},a.prototype.evaluateFunctionCore=function(a,b,c,d,f,g){var i,j,k,l,m,n,o,p,q,t,u,w,x,y,z,A,B,C,D,E;if(!a||!a.function||!e.isFunction(a.function))return v;if(i=a.arguments.length,j=this,k=a.function,l=[],n=h,k instanceof e.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(k,a,c),0!==i){if(p=j.preprocessFunction(c,k,i,g,d),q=p.acceptsArrays,t=p.acceptsReferences,n=p.getReferenceValues,o=p.keepArrayValuesFlagSet,u=void 0,w=void 0,x=void 0,k.isBranch()){if(w=k.findTestArgument(),y=j.testArgGetBranch(c,k,a,q[w],t[w],w),y&&y.pause)return y;u=y.testArgValue,x=y.branchArgument}for(z=0;z<i;z++){if(w===z)m=u;else{if(x>=0&&z!==x){l[z]=null;continue}if(k.acceptsArray(z)&&c.wi(),m=j.evaluate(a.arguments[z],c,q[z],t[z]),m&&m.pause)return m;k.acceptsArray(z)&&c.xi()}if(!k.acceptsArray(z)&&r(m)||!k.acceptsReference(z)&&s(m))if(A=r(m)?m:h,B=s(m)?m:h,A&&1===A.getRowCount()&&1===A.getColumnCount())m=A.getValue(0,0);else if(B&&1===B.getRowCount(0)&&1===B.getColumnCount(0))m=B.getValue(0,0,0);else{if(C=[],D=!1,g)for(E=0;E<g.length;E++)C.push(g[E]),g[E]===z&&(D=!0);D||(C.push(z),g=C)}if(e.Convert.vf(m)&&!k.acceptsError(z))return k instanceof e.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),m;m!==e.missingArgument||k.acceptsMissingArgument(z)||(m=h),l[z]=m,m&&"INDIRECT"!==a.functionName&&m.ck&&m.xf&&N(m,c)}}return o&&delete c.Exb,j.evaluateWithArgs(a,b,c,g,l,d,f,n)},a.prototype.evaluateAsyncFunction=function(a,b,c,d,e,f){var g,h,j=this.asyncManager.getNode();if(j.v5)g=j.Fi;else if(j.canEvaluate()){if(h=new B(a,j),g=c.evaluateWithContext(h,e),h.notAsync)return g;g===i?g=j.Fi!==i?j.Fi:c.defaultValue():1===j.evaluateMode&&(j.v5=!0)}else g=j.Fi!==i?j.Fi:c.defaultValue();return j.Fi=g,f||this.asyncManager.endCalcFunction(),g},a.prototype.evaluateWithCache=function(a,b,c,d){var f,g,h,j,k,l,m,n,o,p,q,r;if(d)if(g=!1,f=d[a.name+b.length])for(h=0;h<f.length;h++){if(j=f[h],g=!1,j.args.length===b.length){for(g=!0,k=0;k<b.length;k++)if(l=j.args[k],m=b[k],l!==m){if(!(l instanceof e.CalcReference&&m instanceof e.CalcReference)){g=!1;break}if(n=l.zf,l.xf!==m.xf||n!==m.zf){g=!1;break}for(o=0;o<n;o++)if(l.getRow(o)!==m.getRow(o)||l.getColumn(o)!==m.getColumn(o)||l.getRowCount(o)!==m.getRowCount(o)||l.getColumnCount(o)!==m.getColumnCount(o)){g=!1;break}}g&&!P(j.y0a,a.y0a)&&(g=!1)}if(g)return j.flag++,j.value}else f=d[a.name+b.length]=[];if(p=c(),d&&p!==i){if(q=f.length,q>=100){for(r=[],h=0;h<q;h++)f[h].flag>0&&r.push(f[h]);r.sort(function(a,b){return b.flag-a.flag}),q=Math.min(50,r.length),f=r.slice(0,q),d[a.name+b.length]=f}f.push({args:b,value:p,flag:0,y0a:a.y0a})}return p},a.prototype.SetAsyncResult=function(a){if(a.DIc()){var b=a.ctx;b.source.Cf().recalculate(b.source,a.row,a.col,!0)}},a.prototype.evaluateWithArgs=function(a,b,c,d,f,g,h,i){var j,k,l,m,n,o,p,q,t,v,x,y,z,A,B=c.Exb;if(!B||d&&d.length>0||(d=[],j=7===a.type&&a.function,j&&f.forEach(function(a,b){(!j.acceptsArray(b)&&r(a)||!j.acceptsReference(b)&&s(a))&&d.push(b)})),d&&d.length>0){if(l=this.Gi(c,a,f,d,i),!l)return w;for(m=[],n=l[0].length,o=l[0][0].length,p=0;p<n;p++)for(m[p]=[],q=0;q<o;q++)try{for(t=[],v=0;v<f.length;v++)t[v]=l[v][p][q];if(k=b(t,a,p+1!==n||q+1!==o),s(k)&&!B){if(7===a.type&&(j=a.function,j.returnReference&&j.returnReference()))return k;k=this.getOneValue(c,k)}m[p][q]=k,c.Lf.hJc=!0}catch(a){if(e.isStackOverflowError(a))throw a;m[p][q]=u}return new e.CalcArray(m,B)}try{if(k=b(f,a),15===a.operatorType&&k&&k.ck&&N(k,c),c.arrayFormulaMode&&c.vi())return k;if(r(k)&&!g)return this.getOneValue(c,k);if(s(k)&&!h){if(x=k,g&&1===x.getRangeCount()){for(y=[],z=0;z<x.getRowCount(0);z++)for(y[z]=[],A=0;A<x.getColumnCount(0);A++)y[z][A]=x.getValue(0,z,A);return new e.CalcArray(y)}return this.getOneValue(c,k)}return k}catch(a){if(e.isStackOverflowError(a))throw a;return u}},a.prototype.getOneValue=function(a,b){var c,d,e,f,g,h;return s(b)?(e=b,f=e.getRowCount(0),g=e.getColumnCount(0),e.getRangeCount()>1||!a.arrayFormulaMode&&f>1&&g>1?b=u:(a.rowOffset!==-1||a.columnOffset!==-1?(c=1===f?0:a.arrayFormulaMode?a.rowOffset:a.rowOffset-e.getRow(0),d=1===g?0:a.arrayFormulaMode?a.columnOffset:a.columnOffset-e.getColumn(0)):(c=1===f?0:a.row-e.getRow(0),d=1===g?0:a.column-e.getColumn(0)),b=c>=f||d>=g?w:e.getValue(0,c,d))):r(b)&&(h=b,!a.arrayFormulaMode||a.rowOffset===-1&&a.columnOffset===-1?b=h.getValue(0,0):(c=1===h.getRowCount()?0:a.rowOffset,d=1===h.getColumnCount()?0:a.columnOffset,b=c>=h.getRowCount()||d>=h.getColumnCount()?w:h.getValue(c,d))),s(b)||r(b)?this.getOneValue(a,b):b},a.prototype.Gi=function(a,b,c,f,g){var j,k,l,m,n,o,p,q,t,u,v,x,y,z,A,B,C,D,E,F=1,G=1,H=-1,I=!0,J=!0,K=1,L=1,N=7===b.type?b:h,O=N&&N.function,P=a.arrayFormulaMode||a.source&&a.source.Af&&a.source.Af.allowDynamicArray;if(O&&e.isFunction(O)&&!O.expandRows()&&(I=!1),O&&e.isFunction(O)&&!O.expandColumns()&&(J=!1),O&&e.isFunction(O)&&O.isBranch()&&(P||a.vi())){if(H=O.findTestArgument(),l=[],m=!1,f)for(n=0;n<f.length;n++)l.push(f[n]),f[n]===H&&(m=!0);if(m||r(c[H])||s(c[H])){for(o=0;o<N.arguments.length;o++)o!==H&&d.Common.k.Cb(l,o)<0&&(r(c[o])||s(c[o]))&&l.push(o);f=l}}for(p=[],q=0,t=f[q],u=c.length,y=[],v=0;v<u;v++)x=c[v],j=h,k=h,K=L=1,v===t?(j=r(x)?x:h,k=s(x)?x:h,(j||k)&&(K=j&&j.getRowCount()||(I&&k?k.getRowCount(0):1),L=j&&j.getColumnCount()||(J&&k?k.getColumnCount(0):1)),q++,t=q<f.length?f[q]:-1):g===i&&(j=r(x)?x:h,k=s(x)?x:h,(j||k)&&(K=j&&j.getRowCount()||(I&&k?k.getRowCount(0):1),L=j&&j.getColumnCount()||(J&&k?k.getColumnCount(0):1))),y[v]=[j,k,x,K,L],F=K>F?K:F,G=L>G?L:G;for(v=0;v<u;v++){if(z=p[v]=[],A=y[v],j=A[0],k=A[1],x=A[2],K=A[3],L=A[4],(j||k)&&(1!==K&&K!==F||1!==L&&L!==G)&&(H===-1||v===H)&&!P)return;for(B=0;B<F;B++)for(C=z[B]=[],D=0;D<G;D++)1!==K&&B>=K||1!==L&&D>=L?C[D]=w:j?(E=j.getValue(1===K?0:B,1===L?0:D),r(E)&&(E=E.getValue(0,0)),C[D]=E):k?!g||g[v]?C[D]=k.getValue(0,1===K?0:B,1===L?0:D):C[D]=k.create([M(k.getRow(0)+(1===K?0:B),k.getColumn(0)+(1===L?0:D),1,1)]):C[D]=x}return p},a}(),b.Evaluator=D,E=function(){function a(a,b){this.id=a,this.Fi=i,this.v5=!1,this.oi=[],b!==i&&(this.evaluateMode=b)}return a.prototype.canEvaluate=function(){var a,b=this.oi;for(a=0;a<b.length;a++)if(!b[a].v5)return!1;return!0},a}(),b.AsyncFunctionNode=E,F=function(){function a(a){var b=this;b.w5=[],b.x5=-1,b.y5={},b.lh=a,b.vQa=0}return a.prototype.startCalc=function(){var a,b,c,d,e,f,g,h,i;if(this.vQa)for(b in this.y5)if(c=this.y5[b])for(d in c)if(e=c[d])for(f in e)if(g=e[f],g&&(g.root.oi=[],a=g.length,a>0))for(h=0;h<a;h++)i=g[h],0===i.evaluateMode&&(i.v5=!1)},a.prototype.startCalcCell=function(a,b){var c,d,e,f,g=this,h=a.getName(),i=b.row,j=b.col;g.source=a,c=g.y5[h],c||(c=g.y5[h]={}),d=c[i],d||(d=c[i]={}),e=d[j],e||(f=new E((-1)),e=d[j]=[],e.root=f),g.vQa++,g.x5=0,g.cellNodes=e,g.row=i,g.col=j,g.w5[0]=e.root,g.evaluateMode=-1},a.prototype.startCalcFunction=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=b.arguments,q=!1;if(0!==o.w5.length&&o.cellNodes||(q=!0,o.startCalcCell(c.source,c.identity)),d=o.evaluateMode,e=a.evaluateMode(),"REFRESH"===a.name?(e=p[1]?o.lh.evaluate(p[1],c,!1,!1):0,o.evaluateMode=e):d!==-1&&(e=d),g=c.identity?c.identity.row+"|"+c.identity.col:"0",b.PIc&&b.PIc[g]?f=b.PIc[g]:(b.PIc=b.PIc||{},f=b.PIc[g]=new E(o.cellNodes.length,e),o.cellNodes.push(f)),o.currentNode=f,o.w5[o.x5].oi.indexOf(f)<0&&(o.w5[o.x5].oi.push(f),f.parent=o.w5[o.x5],f.oi=[]),o.w5.push(f),o.x5++,2===e&&d===-1){for(h=6e4,i=o.intervals,j=a.interval()||h,"REFRESH"===a.name&&(f.isRefresh=!0,j=p[2]?o.lh.evaluate(p[2],c,!1,!1):h),i||(o.intervals=i={}),k=i[j],k||"object"!=typeof window||(k=i[j]=[],k.intervalObj=window.setInterval(function(){var a,b,c=o.intervals[j];for(l=0;l<c.length;l++)a=c[l],b=a.node,b.v5=!1,b.isRefresh&&Q(b),o.lh.service.recalculate(a.source,a.row,a.col,!0),o.source.refresh()},j)),m=!1,l=0;l<k.length;l++)if(n=k[l],n.source===o.source&&n.node===f&&n.row===o.row&&n.col===o.col){m=!0;break}m||k.push({source:o.source,node:f,row:o.row,col:o.col})}return q&&o.endCalcCell(),f},a.prototype.getNode=function(){return this.currentNode},a.prototype.endCalcFunction=function(){this.w5.pop(),this.x5--,this.currentNode=this.currentNode.parent},a.prototype.endCalcCell=function(){var a=this;a.x5=-1,a.w5=[]},a.prototype.clearCell=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r=this;if(r.vQa&&(c=a.getName(),d=b.row,e=b.col,r.source=a,f=r.y5[c],f&&(g=f[d],g&&(h=g[e],h&&(j=h[0],k=j&&j.h_a,k&&(delete k.nia,delete k.z$a),g[e]=i,r.vQa--))),"object"==typeof window)){l=r.intervals;for(m in l)if(n=l[m]){for(o=[],p=0;p<n.length;p++)q=n[p],q.source===a&&q.row===b.row&&q.col===b.col||o.push(q);o.length?o.length!==n.length&&(o.intervalObj=n.intervalObj,l[m]=o):(l[m]=i,window.clearInterval(n.intervalObj))}}},a.prototype.setAsyncResult=function(a,b){a.Fi=b},a.prototype.addRows=function(a,b,c){this.GQa(a,b,c,!0)},a.prototype.deleteRows=function(a,b,c){this.GQa(a,b,c,!1)},a.prototype.GQa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;if(r.vQa){if(e=a.getName(),f=r.y5[e]){g={};for(h in f)i=f[h],i&&(j=parseInt(h,10),d?(k=j>=b?j+c:j,g[k]=i):j<b?g[j]=i:j>=b+c&&(g[j-c]=i));r.y5[e]=g}l=r.intervals;for(m in l)if(n=l[m]){for(o=[],p=0;p<n.length;p++)q=n[p],q.source===a&&d&&q.row>=b?q.row+=c:q.source===a&&!d&&(q.row<b||q.row>=b+c)&&(q.row=q.row<b?q.row:q.row-c,o.push(q));d||o.length===n.length||(o.intervalObj=n.intervalObj,l[m]=o)}}},a.prototype.addColumns=function(a,b,c){this.HQa(a,b,c,!0)},a.prototype.deleteColumns=function(a,b,c){this.HQa(a,b,c,!1)},a.prototype.HQa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;if(t.vQa){if(e=a.getName(),f=t.y5[e])for(g in f)if(h=f[g]){i={};for(j in h)k=h[j],k&&k.length&&(l=parseInt(j,10),d?(m=l>=b?l+c:l,i[m]=k):l<b?i[l]=k:l>=b+c&&(i[l-c]=k));f[g]=i}n=t.intervals;for(o in n)if(p=n[o]){for(q=[],r=0;r<p.length;r++)s=p[r],s.source===a&&d&&s.col>=b?s.col+=c:s.source===a&&!d&&(s.col<b||s.col>=b+c)&&(s.col=s.col<b?s.col:s.col-c,q.push(s));d||q.length===p.length||(q.intervalObj=p.intervalObj,n[o]=q)}}},a.prototype.changeSourceName=function(a,b){var c,d=this;d.vQa&&(c=d.y5[a],c&&(d.y5[b]=c,delete d.y5[a]))},a}();function Q(a){var b,c;for(c=0;c<a.oi.length;c++)b=a.oi[c],b.v5=!1,b.oi.length>0&&Q(b)}function R(a){var b,c=!0,d=a;return a&&a.getValue&&(b=q(a,0,!1,!1),b.isError?d=b[0]:1===b.rowCount&&1===b.colCount?d=b[0][0]:(d=b,c=!1)),{value:d,success:c}}function S(a,b,c){var d=w,e=1===a.rowCount,f=1===a.colCount;return e&&f?a[0][0]:(e&&c<a.colCount?d=a[0][c]:f&&b<a.rowCount?d=a[b][0]:b<a.rowCount&&c<a.colCount&&(d=a[b][c]),d)}function T(a,b,c){return p(b)?b:p(c)?c:e.isLambdaFunction(b)||e.isLambdaFunction(c)?u:a<=2?U(a,b,c):a<=14?V(a,b,c):Z(a,b,c)}b.evaluateOperator=T;function U(a,b,c){var d,f,g,h,i,j,k,l;if(0===a)return b;if(!b)return 0;if(d=R(b),d.success)return W(a,d.value);if(c){for(f=[],g=d.value,h=g.rowCount,i=g.colCount,j=0;j<h;j++)for(k=f[j]=[],l=0;l<i;l++)k[l]=W(a,g[j][l]);return new e.CalcArray(f)}}function V(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(d=a<=7?W:8===a?X:Y,f=R(b),g=R(c),f.success&&g.success)return d(a,f.value,g.value);for(b=f.value,c=g.value,h=f.success?1:b.rowCount,i=f.success?1:b.colCount,j=g.success?1:c.rowCount,k=g.success?1:c.colCount,l=Math.max(h,j),m=Math.max(i,k),n=[],o=0;o<l;o++){for(p=[],q=0;q<m;q++)r=f.success?b:S(b,o,q),s=g.success?c:S(c,o,q),r===w||s===w?p.push(w):p.push(d(a,r,s));n.push(p)}return new e.CalcArray(n)}function W(a,b,c){var f,g,h,j;function k(a){return"string"==typeof a&&0===a.trim().length}if(k(b)||k(c))return u;if(f={value:0},!o(b,f))return b instanceof e.CalcError?b:u;if(g=f.value,c!==i){if(!o(c,f))return c instanceof e.CalcError?c:u;h=f.value}else h=0;return 1===a?-g:2===a?g/100:3===a?e.Zh.Yh(g,-h)?0:g+h:4===a?e.Zh.Yh(g,h)?0:g-h:5===a?d.Common.o.Lma(g*h,e.Functions.CALC_PRECISION||15):6===a?h?g/h:x:7===a?!g&&h<0?x:0===g&&0===h?y:(j=e.Functions.MathHelper.YDc(g,h),j===Number.POSITIVE_INFINITY||j===Number.NEGATIVE_INFINITY||isNaN(j)?y:j):void 0}function X(a,b,c){if(8===a)return p(b)?b:p(c)?c:e.Convert.bc(b)+e.Convert.bc(c)}function Y(a,b,c){var d=e.gOb(b,c,!1);return p(d)?d:9===a&&0===d||10===a&&0!==d||11===a&&d<0||12===a&&d<=0||13===a&&d>0||14===a&&d>=0}function Z(a,b,c){var d,f,g,h,i,j,m,n,o,p,q,r,s;if(!b||!c||(1!==b.getRangeCount()||1!==c.getRangeCount())&&16!==a||b.endSource||c.endSource)return u;if(d=b.getSource(),!d||d!==c.getSource())return u;if(16===a)f=b.yf.concat(c.yf);else{if(g=15===a?k:l,h=15===a?l:k,i=b.getRow(0),j=b.getColumn(0),m=c.getRow(0),n=c.getColumn(0),o=g(i,m),p=g(j,n),q=h(i+b.getRowCount(0),m+c.getRowCount(0))-o,r=h(j+b.getColumnCount(0),n+c.getColumnCount(0))-p,q<1||r<1)return e.Errors.Null;f=[M(o,p,q,r)]}return s=new e.CalcReference(d,f),s.ck=!0,s}G=e.Convert.Pa,H=e.Convert.Rh,I=e.Convert.bc,J=e.Convert.Xh,K=e.Convert.Vh;function $(a,b){var c,d,f,g=!0;switch(b.Hi){case 0:c=G(a),d=!0;break;case 1:c=parseFloat(a),d=!0;break;case 2:c=H(a),d=!0;break;case 3:c=parseInt(a,10),d=!0;break;case 4:c=q(a,b.Ii,b.Ji||!1,b.Ki||!1,b.Li||!1,b.Mi,b.xTa,b.hOb),c.isError&&(c=c[0],g=!1),c.isConvertError&&(c=u,g=!1);break;case 5:c=I(a),b.Ni&&""===c&&(c=u,g=!1);break;case 6:f={value:h},J(a,f)?c=f.value:(c=u,g=!1);break;case 7:c=K(a);break;case 8:c=e.Functions.Wi(a),!c||b.Oi&&0===c.Pi()&&0===c.Qi()?(c=e.Errors.Number,g=!1):c={Ri:c.Pi(),Si:c.Qi()};break;default:c=a}return d&&isNaN(c)&&(c=u,g=!1),{Ti:c,Ei:g}}function _(a,b,c){var d,f,g,h,j;for(Array.isArray(b)||(b=[b]),d=a.Ti,f=0;f<b.length;f++)if(g=b[f].split(" "),h=g[0],j=parseInt(g[1],10),"<"===h&&d<j||">"===h&&d>j||"<="===h&&d<=j||">="===h&&d>=j||"="===h&&d===j||"!="===h&&d!==j||"checkLength"===h&&d.length>j)return a.Ti=c===i?e.Errors.Number:c,void(a.Ei=!1)}function aa(a,b){var c,d,f,g,h,j=[];if(!b)return{Di:a,Ei:!0};if(b.Xi)for(f=0;f<a.length;f++)j.push(b);else j=Array.isArray(b)?b:[b];for(d=0;d<j.length;d++){if(g=j[d],g.Yi&&!a[d])throw e.sR().Exp_ArgumentNull;if(h=a[d]!==i){if(c=$(a[d],g),g.aj&&_(c,g.aj,g.bj),!c.Ei)break;a[d]=g.Zi?{$i:h,Qb:c.Ti}:c.Ti}else a[d]=g.Zi?{$i:h,Qb:g._i}:g._i}return c?{Di:a,Ei:c.Ei,Fi:c.Ti}:void 0}},"./src/referenceExpression.ts":function(a,b,c){"use strict";var d,e,f,g,h=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/calc.common.ts"),e=void 0,f=Math.abs,g=function(a){h(b,a);function b(b){return a.call(this,b)||this}return b.prototype.sf=function(){var a=this;return a.endRow===e||a.endColumn===e},b.prototype.tf=function(){var a=this;return a.isFullRow&&a.isFullColumn?3:a.isFullRow?1:a.isFullColumn?2:0},b.prototype.getRange=function(a,b){return k(this,a,b)},b.prototype.offset=function(a,b,c,d,e){var f,g=this,h=g.source,k=g.endSource;return g.sf()?i(h,k,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.rowRelative,g.columnRelative):(f=j(h,k,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.endRow+(g.isFullColumn||!g.endRowRelative&&!c?0:a),g.endColumn+(g.isFullRow||!g.endColumnRelative&&!c?0:b),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,d,e),f.isFullRow=g.isFullRow,f.isFullColumn=g.isFullColumn,f)},b.prototype.offset2=function(a,b,c,d,e,f){var g=this,h=j(g.source,g.endSource,g.row+(g.isFullColumn?0:a),g.column+(g.isFullRow?0:b),g.endRow+(g.isFullColumn?0:c),g.endColumn+(g.isFullRow?0:d),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,e,f);return h.isFullRow=g.isFullRow,h.isFullColumn=g.isFullColumn,h},b}(d.Expression),b.ReferenceExpression=g;function i(a,b,c,d,e,f){var h=new g(1);return h.row=c,h.column=d,h.rowRelative=e,h.columnRelative=f,a&&(h.source=a),b&&(h.endSource=b),h}b.rf=i;function j(a,b,c,e,f,h,i,j,k,l,m,n,o){var p,q,r,s,t,u=new g(1);return u.isFullRow=e===d.BAND_INDEX_CONST,m=m||0,n=n||0,q=c-(i?0:m),r=e-(j?0:n),s=f-(k?0:m),t=h-(l?0:n),u.isFullRow&&0===c&&f===d.MAX_ROW_COUNT-1&&(c=f=d.BAND_INDEX_CONST),u.isFullColumn=c===d.BAND_INDEX_CONST,q>s&&(p=c,c=f,f=p,p=i,i=k,k=p),r>t&&(p=e,e=h,h=p,p=j,j=l,l=p),u.row=c,u.column=e,u.endRow=f,u.endColumn=h,u.rowRelative=i,u.columnRelative=j,u.endRowRelative=k,u.endColumnRelative=l,u.isArrayReference=o,a&&(u.source=a),b&&(u.endSource=b),u}b.uf=j;function k(a,b,c){var e={row:-1,col:-1,rowCount:-1,colCount:-1},g,h,i,j;return a.isFullRow?(e.col=-1,e.colCount=-1):(a.columnRelative?(i=a.column+c,i=i>=d.MAX_COLUMN_COUNT?i%d.MAX_COLUMN_COUNT:i):i=a.column,a.sf()?(e.col=i,e.colCount=1):(a.endColumnRelative?(j=a.endColumn+c,j=j>=d.MAX_COLUMN_COUNT?j%d.MAX_COLUMN_COUNT:j):j=a.endColumn,e.col=i<=j?i:j,e.colCount=f(j-i)+1)),a.isFullColumn?(e.row=-1,e.rowCount=-1):(a.rowRelative?(g=a.row+b,g=g>=d.MAX_ROW_COUNT?g%d.MAX_ROW_COUNT:g):g=a.row,a.sf()?(e.row=g,e.rowCount=1):(a.endRowRelative?(h=a.endRow+b,h=h>=d.MAX_ROW_COUNT?h%d.MAX_ROW_COUNT:h):h=a.endRow,e.row=g<=h?g:h,e.rowCount=f(h-g)+1)),e}b.getRangeForReference=k},"./src/text_Filter/charProcess.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=function(){function a(){this.otherChar=0,this.control=1,this.numeric=2,this.mathSymbol=3,this.symbol=4,this.punctuation=5,this.space=6,this.upperCase=7,this.lowerCase=8,this.katakana=9,this.hiragana=10,this.farEastPunctuation=11,this.hangul=12,this.fullWidth=32768}return a}(),b.CharType=d,e=function(){function a(){this.minValue="\0",this.maxValue="\uffff",this.ANSI_START=0,this.ANSI_END=255,this.BOTH_WIDTH_START=65280,this.BOTH_WIDTH_END=65519,this.FULL_ALPHA_START=65281,this.FULL_UPPER_START=65313,this.FULL_UPPER_END=65338,this.FULL_ALPHA_END=65374,this.CJK_HALF_SYMBOL_START=65377,this.CJK_HALF_SYMBOL_END=65380,this.KANA_HALF_START=65381,this.KANA_HALF_END=65439,this.HANGUL_HALF_START=65440,this.HANGUL_HALF_END=65500,this.FULL_SYMBOL_START=65504,this.FULL_SYMBOL_END=65510,this.HALF_VARIANTS_START=65512,this.HALF_VARIANTS_END=65518,this.KATAKANA_VOICED="\uff9e",this.KATAKANA_SEMI_VOICED="\uff9f",this.tab="\t",this.space=" ",this.u$c=["\0","\x80","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"],this.blocks=["BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"],this.v$c=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"],this.w$c=new d,this.x$c=[this.w$c.symbol|this.w$c.fullWidth,this.w$c.numeric|this.w$c.fullWidth,this.w$c.symbol|this.w$c.fullWidth,this.w$c.upperCase|this.w$c.fullWidth,this.w$c.symbol|this.w$c.fullWidth,this.w$c.lowerCase|this.w$c.fullWidth,this.w$c.symbol|this.w$c.fullWidth,this.w$c.farEastPunctuation,this.w$c.katakana,this.w$c.hangul,this.w$c.symbol|this.w$c.fullWidth,this.w$c.symbol],
this.y$c=["\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"],this.z$c=["\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"],this.A$c=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"],this.B$c=[0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0],this.C$c=["\u2018","\u2019","\u201c","\u201d"],this.D$c=["\u30fc"],this.E$c=["\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"],this.F$c=[" ","\uff64","\uff61","\uff62","\uff63",'"','"',"'","'","\uff9e","\uff9f","\xa5"]}return a}(),b.G$c=e,f=function(){function a(){this.charCategory=new e,this.charType=new d}return a.prototype.isAlphabet=function(a){var b=this;return b.isUpper(a)||b.isLower(a)},a.prototype.isHiragana=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.hiragana||b.charCategory.D$c[0]===a},a.prototype.getCharType=function(a){var b=this,c=b.charType.otherChar,d=b.belongTo(a);if("\x7f"===a||"\0"<=a&&a<="\x1f"||"\x80"<=a&&a<="\x9f")return b.charType.control;if("A"<=a&&a<="Z")return b.charType.upperCase;if("a"<=a&&a<="z")return b.charType.lowerCase;if("0"<=a&&a<="9")return b.charType.numeric;switch((b.isFullWidthSymbol(a)||b.isHalfWidthSymbol(a))&&(c=b.charType.symbol),8216!==a.charCodeAt(0)&&8217!==a.charCodeAt(0)&&8220!==a.charCodeAt(0)&&8221!==a.charCodeAt(0)||(c=b.charType.punctuation),12288===a.charCodeAt(0)&&(c=b.charType.space),b.charCategory.blocks[d]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return b.multiWidthDetails(a);case"KATAKANA":return b.charType.katakana|b.charType.fullWidth;case"HIRAGANA":return b.charType.hiragana|b.charType.fullWidth}return b.isFarEastBlock(d,a)&&(c|=b.charType.fullWidth),c},a.prototype.isLower=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.lowerCase},a.prototype.isUpper=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.upperCase},a.prototype.belongTo=function(a){for(var b=this,c=0,d=83,e=d>>1;d-c>1;)a>=b.charCategory.u$c[e]?c=e:d=e,e=d+c>>1;return e},a.prototype.isFullWidthSymbol=function(b){for(var c=0;c<a.fullWidthSymbolArray.length;c++)if(b===a.fullWidthSymbolArray[c])return!0;return!1},a.prototype.isHalfWidthSymbol=function(b){for(var c=0;c<a.halfWidthSymbolArray.length;c++)if(b===a.halfWidthSymbolArray[c])return!0;return!1},a.prototype.multiWidthDetails=function(a){for(var b=this,c=0,d=b.charCategory.v$c.length,e=d>>1;d-c>1;)a>=b.charCategory.v$c[e]?c=e:d=e,e=d+c>>1;return b.charCategory.x$c[e]},a.prototype.isFarEastBlock=function(a,b){var c,d=this;switch(d.charCategory.blocks[a]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(c=0;c<d.charCategory.C$c.length;c++)if(b===d.charCategory.C$c[c])return!0;if(b.charCodeAt(0)>255)return!0;if(8216===b.charCodeAt(0)||8217===b.charCodeAt(0)||8220===b.charCodeAt(0)||8221===b.charCodeAt(0))return!0}return!1},a.prototype.isFullWidth=function(a){var b,c,d=this;return!!d.isFullWidthSymbol(a)||!d.isHalfWidthSymbol(a)&&(b=d.belongTo(a),c=d.isFarEastBlock(b,a),"HALFWIDTH_AND_FULLWIDTH_FORMS"===d.charCategory.blocks[b]&&(c=(d.multiWidthDetails(a)&d.charType.fullWidth)===d.charType.fullWidth),c)},a.prototype.toHalfWidth=function(a){return this.toHalfWidthEx(a)},a.prototype.toHalfWidthEx=function(a){var b,c,d,e,f=this,g=f.getCharType(a),h=f.isMultiWidth(a);if((g&f.charType.fullWidth)===f.charType.fullWidth)switch(g&~f.charType.fullWidth){case f.charType.punctuation:case f.charType.upperCase:case f.charType.lowerCase:case f.charType.symbol:case f.charType.numeric:case f.charType.mathSymbol:b=f.getFullHalfWidthSpecialChar(a,!1),b!==!1?a=b:h&&(c="!",a=String.fromCharCode(a.charCodeAt(0)-(f.charCategory.u$c[81].charCodeAt(0)+1)+c.charCodeAt(0)));break;case f.charType.katakana:if(d=a.charCodeAt(0)-(f.charCategory.u$c[62].charCodeAt(0)+1),d<0||d>91)return a;if(a=f.charCategory.z$c[d],e=f.charCategory.B$c[d],e>0)return a+=String.fromCharCode(1===e?f.charCategory.KATAKANA_VOICED.charCodeAt(0):f.charCategory.KATAKANA_SEMI_VOICED.charCodeAt(0));break;case f.charType.space:a=" ";break;case f.charType.hangul:}return a},a.prototype.isMultiWidth=function(a){var b=this,c=b.belongTo(a),d=b.charCategory.blocks[c];return"KATAKANA"===d||"CJK_SYMBOLS_AND_PUNCTUATION"===d||"HALFWIDTH_AND_FULLWIDTH_FORMS"===d||"BASIC_LATIN"===d&&a>=" "},a.prototype.getFullHalfWidthSpecialChar=function(a,b){var c,d,e,f,g=this;for(b===!0?(c=g.charCategory.F$c,d=g.charCategory.E$c):(c=g.charCategory.E$c,d=g.charCategory.F$c),e=-1,f=0;f<c.length;){if(c[f]===a){e=f;break}f++}return e!==-1&&f<d.length&&d[f]},a.prototype.toFullWidth=function(a){var b,c,d,e,f,g={},h=this;if(g.text=a,g.processedAll=!1,0===a.length)return g;if(b=a.substring(0,1),h.isMultiWidth(b)){if(b<h.charCategory.u$c[1])return" "===b?(g.text="\u3000",g):(c="!",g.text=String.fromCharCode(b.charCodeAt(0)-c.charCodeAt(0)+(h.charCategory.u$c[81].charCodeAt(0)+1)),g);if((h.multiWidthDetails(b)&h.charType.katakana)===h.charType.katakana){if(b.charCodeAt(0)<h.charCategory.KANA_HALF_START)return d=h.getFullHalfWidthSpecialChar(b,!0),g.text=d!==!1?d:b,g;if(b=h.charCategory.y$c[b.charCodeAt(0)-h.charCategory.KANA_HALF_START],a.length<2)return g.text=b,g;e=a.charCodeAt(1)-(h.charCategory.KATAKANA_VOICED.charCodeAt(0)-1),1!==e&&2!==e||(g.processedAll=!0,f=h.charCategory.B$c[b.charCodeAt(0)-(h.charCategory.u$c[62].charCodeAt(0)+1)],0!==f&&((2&Math.abs(f))===e&&(b=String.fromCharCode(b.charCodeAt(0)+1)),b=String.fromCharCode(b.charCodeAt(0)+1))),1===e&&"\u30a6"===b&&(b="\u30f4")}}return g.text=b,g},a.prototype.isUpperKana=function(a){return!this.isLowerKana(a)},a.prototype.isLowerKana=function(b){return a.lowerKana.search(b)!==-1},a.prototype.hasLowerKana=function(b){return a.upperKana.search(b)!==-1||this.isLowerKana(b)},a.prototype.toUpperKana=function(b){var c=a.lowerKana.search(b);return c===-1?b:a.upperKana.substr(c,1)},a.prototype.toLowerKana=function(b){var c=a.upperKana.search(b);return c>=a.upperKana.length-4&&c<a.upperKana.length?b:c===-1?b:a.lowerKana.substr(c,1)},a.prototype.toKatakana=function(a){var b,c=this;return c.isCharOfType(a,c.charType.hiragana|c.charType.fullWidth)?(b=c.getFullHalfWidthSpecialChar(a,!1),b!==!1?b:String.fromCharCode(a.charCodeAt(0)-c.charCategory.u$c[61].charCodeAt(0)+c.charCategory.u$c[62].charCodeAt(0))):a},a.prototype.isCharOfType=function(a,b){return this.getCharType(a)===b},a.prototype.isKatakana=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.katakana},a.prototype.toHiragana=function(a){var b=this;return b.isKatakana(a)?(b.isFullWidth(a)||(a=b.toFullWidth(a).text),b.isCharOfType(a,b.charType.katakana|b.charType.fullWidth)?a>="\u30f7"&&a<="\u30ff"?a:"\u30f5"===a?"\u304b":"\u30f6"===a?"\u3051":String.fromCharCode(a.charCodeAt(0)+b.charCategory.u$c[61].charCodeAt(0)-b.charCategory.u$c[62].charCodeAt(0)):a):a},a.prototype.isDigit=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.numeric},a.prototype.isSurrogate=function(a){return null!==a&&a.charCodeAt(0)>="\ud800".charCodeAt(0)&&a.charCodeAt(0)<="\udfff".charCodeAt(0)},a.lowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30f5\u30f6\u3095\u3096",a.upperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30ab\u30b1\u304b\u3051",a.fullWidthSymbolArray=["\u3001","\u3002","\uff0c","\uff0e","\u30fb","\uff1a","\uff1b","\uff1f","\uff01","\u309b","\u309c","\xb4","\uff40","\xa8","\uff3e","\uffe3","\uff3f","\u30fd","\u30fe","\u309d","\u309e","\u3003","\u4edd","\u3005","\u3006","\u3007","\u30fc","\u2014","\u2010","\uff0f","\u301c","\u2016","\uff5c","\u2026","\u2025","\u2018","\u2019","\u201c","\u201d","\uff08","\uff09","\u3014","\u3015","\uff3b","\uff3d","\uff5b","\uff5d","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff0b","\u2212","\xb1","\xd7","\xf7","\uff1d","\u2260","\uff1c","\uff1e","\u2266","\u2267","\u221e","\u2234","\u2642","\u2640","\xb0","\u2032","\u2033","\u2103","\uffe5","\uff04","\xa2","\xa3","\uff05","\uff03","\uff06","\uff0a","\uff20","\xa7","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u203b","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uff07","\uff02","\uff0d","\u3033","\u3034","\u3035","\u303b","\u303c","\u30ff","\u309f","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2284","\u2285","\u228a","\u228b","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\xac","\u21d2","\u21d4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212b","\u2030","\u266f","\u266d","\u266a","\u2020","\u2021","\xb6","\u266e","\u266b","\u266c","\u2669","\u25ef","\uff3c","\uff5e","\uffe0","\uffe1","\uffe2","\u2015"],a.halfWidthSymbolArray=["\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","\uff61","\uff62","\uff63","\uff64","\uff65","\xa1","\xa4","\xa5"],a}(),b.H$c=f},"./src/text_Filter/emoji_helper.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/calc.common.ts"),e=function(){function a(){}return a.isEmoji=function(b,c,d){d.emojiCharLength=0;try{if(a.isEmojiEnclosedAlphanumericSymbol(b,c))return d.emojiCharLength=2,!0;if(a.isEmojiInSpecificRange(b,c)||a.isEmojiInUnicodeStandardSymbol(b,c))return a.isHighSurrogate(b,c)?d.emojiCharLength=2:d.emojiCharLength=1,!0}catch(a){}return!1},a.isEmojiEnclosedAlphanumericSymbol=function(b,c){return!(c>=b.length-1)&&(!a.isHighSurrogate(b,c)&&!(!a.contains(a.I$c,a.convertToUtf32(b,c))||a.J$c!==a.convertToUtf32(b,c+1)))},a.isEmojiInSpecificRange=function(b,c){var d,e=a.convertToUtf32(b,c),f=Math.floor(a.K$c.length/2);for(d=0;d<f;d++)if(a.K$c[2*d]<=e&&e<=a.K$c[2*d+1])return!0;return!1},a.isEmojiInUnicodeStandardSymbol=function(b,c){var d=a.convertToUtf32(b,c);return a.contains(a.L$c,d)},a.contains=function(a,b){for(var c,d=0,e=a.length-1;d<=e;){if(c=Math.floor((d+e)/2),a[c]===b)return!0;a[c]>b?e=c-1:d=c+1}return!1},a.convertFromUtf32=function(a){if(a<0||a>1114111||a>=55296&&a<=57343)throw Error(d.sR().Exp_ArgumentOutOfRangeException);return a<65536?String.fromCharCode(a):(a-=65536,String.fromCharCode(Math.floor(a/1024)+55296,a%1024+56320))},a.convertToUtf32=function(a,b){var c,e;if(b<0||b>=a.length)throw Error(d.sR().Exp_ArgumentOutOfRangeException);if(c=a.charCodeAt(b)-55296,c<0||c>2047)return a.charCodeAt(b);if(c>1023)throw Error(d.sR().Exp_ArgumentException);if(b>=a.length-1)throw Error(d.sR().Exp_ArgumentException);if(e=a.charCodeAt(b+1)-56320,e<0||e>1023)throw Error(d.sR().Exp_ArgumentException);return 1024*c+e+65536},a.isHighSurrogate=function(a,b){var c=a.charCodeAt(b);return c>=55296&&c<=56319},a.isLowSurrogate=function(a,b){var c=a.charCodeAt(b);return c>=56320&&c<=57343},a.J$c=8419,a.I$c=[35,48,49,50,51,52,53,54,55,56,57],a.K$c=[9728,9983,9984,10175,10240,10495,11008,11263,19904,19967,65936,65999,118784,119039,119040,119295,119296,119375,119552,119647,126976,127023,127024,127135,127136,127231,127232,127487,127488,127743,127744,128511,128512,128591,128640,128767,128768,128895],a.L$c=[169,174,8194,8195,8197,8252,8265,8482,8505,8596,8597,8598,8599,8600,8601,8617,8618,8986,8987,9193,9194,9195,9196,9200,9203,9410,9642,9643,9654,9664,9723,9724,9725,9726,10548,10549,12336,12349,12951,12953],a}(),b.M$c=e},"./src/text_Filter/text_Filter.ts":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/text_Filter/charProcess.ts"),e=c("./src/text_Filter/emoji_helper.ts"),f=c("./src/calc.common.ts"),function(a){a[a.DBCS_UpperAlphabet=2147483650]="DBCS_UpperAlphabet",a[a.SBCS_UpperAlphabet=1073741825]="SBCS_UpperAlphabet",a[a.DBCS_LowerAlphabet=2147483656]="DBCS_LowerAlphabet",a[a.SBCS_LowerAlphabet=1073741828]="SBCS_LowerAlphabet",a[a.DBCS_Number=2147483680]="DBCS_Number",a[a.SBCS_Number=1073741840]="SBCS_Number",a[a.DBCS_Binary=2147483776]="DBCS_Binary",a[a.SBCS_Binary=1073741888]="SBCS_Binary",a[a.DBCS_Hexadecimal=2147484160]="DBCS_Hexadecimal",a[a.SBCS_Hexadecimal=1073742080]="SBCS_Hexadecimal",a[a.DBCS_Symbol=2147485696]="DBCS_Symbol",a[a.SBCS_Symbol=1073742848]="SBCS_Symbol",a[a.DBCS_NumberSymbol=2147491840]="DBCS_NumberSymbol",a[a.SBCS_NumberSymbol=1073745920]="SBCS_NumberSymbol",a[a.DBCS_Katakana=2147516416]="DBCS_Katakana",a[a.SBCS_Katakana=1073758208]="SBCS_Katakana",a[a.DBCS_Space=2147614720]="DBCS_Space",a[a.SBCS_Space=1073807360]="SBCS_Space",a[a.TwoBytes=2148007936]="TwoBytes",a[a.FourBytes=2147745792]="FourBytes",a[a.DBCS_ShiftJIS=2148532224]="DBCS_ShiftJIS",a[a.DBCS_JISX0208=2149580800]="DBCS_JISX0208",a[a.Emoji=4194304]="Emoji",a[a.IVS=8388608]="IVS",a[a.DBCS_Hiragana=2164260864]="DBCS_Hiragana",a[a.Upper_SBCS_Katakana=1207959552]="Upper_SBCS_Katakana",a[a.Upper_DBCS_Katakana=2415919104]="Upper_DBCS_Katakana",a[a.Upper_DBCS_Hiragana=2684354560]="Upper_DBCS_Hiragana",a[a.All=3321888768]="All",a[a.DBCS_All=2214592512]="DBCS_All",a[a.SBCS_All=1107296256]="SBCS_All",a[a.DBCS=2147483648]="DBCS",a[a.SBCS=1073741824]="SBCS"}(g=b.CharacterType||(b.CharacterType={})),h={"\uff21":g.DBCS_UpperAlphabet,A:g.SBCS_UpperAlphabet,"\uff41":g.DBCS_LowerAlphabet,a:g.SBCS_LowerAlphabet,"\uff2b":g.DBCS_Katakana,K:g.SBCS_Katakana,"\uff19":g.DBCS_Number,9:g.SBCS_Number,"\uff03":g.DBCS_NumberSymbol,"#":g.SBCS_NumberSymbol,"\uff20":g.DBCS_Symbol,"@":g.SBCS_Symbol,"\uff22":g.DBCS_Binary,B:g.SBCS_Binary,"\uff38":g.DBCS_Hexadecimal,X:g.SBCS_Hexadecimal,"\uff2a":g.DBCS_Hiragana,"\uff3a":g.DBCS_All,"\uff2d":g.DBCS_ShiftJIS,"\uff29":g.DBCS_JISX0208,H:g.SBCS_All,N:g.Upper_SBCS_Katakana,"\uff2e":g.Upper_DBCS_Katakana,"\uff27":g.Upper_DBCS_Hiragana,"\uff33":g.DBCS_Space,S:g.SBCS_Space,"\uff34":g.FourBytes,"\uff24":g.TwoBytes,"\uff25":g.IVS},i=function(){function a(a,b,c){void 0===c&&(c=!0);var e=this;e.format=b,e.includeFormat="",e.excludeFormat="",e.includeNormalChar="",e.excludeNormalChar="",e.allowTypes=g.All,e.excludeTypes=g.All,e.include=!0,e.autoConvert=a,e.charExInstance=new d.H$c,e.keepInvalidChar=c,e.parseFormat(e.format)}return a.prototype.parseFormat=function(a){var b=this;b.includeFormat=b.getIncludeFormat(a),b.excludeFormat=b.getExcludeFormat(a),b.parseIncludeFormat(b.includeFormat),b.parseExcludeFormat(b.excludeFormat)},a.prototype.getIncludeFormat=function(a){var b,c,d;if(null===a||0===a.length)return"";for(b="",c=0;c<a.length;c++)if(d=a.substring(c,c+1),"\\"===d){if(c===a.length-1)throw f.sR().Exp_FormulaInvalid;b=b+d+a.substring(c+1,c+2),c++}else{if("^"===d)return b;b+=d}return b},a.prototype.getExcludeFormat=function(a){var b,c,d,e;if(null===a||0===a.length)return"";for(b=0,c="",d=0;d<a.length;d++)if(e=a.substring(d,d+1),"\\"===e){if(d===a.length-1)throw f.sR().Exp_FormulaInvalid;0!==b&&(c=c+e+a.substring(d+1,d+2)),d++}else if("^"===e){if(b++,b>1)throw f.sR().Exp_DuplicatedChar}else 0!==b&&(c+=e);return 1===b&&(c="^"+c),c},a.prototype.parseIncludeFormat=function(a){var b,c,d,e=this;if(null===a||0===a.length)return e.allowTypes=g.All,e.includeNormalChar="",void(e.includeFormat="");for(e.allowTypes=0,e.includeNormalChar="",b=0;b<a.length;b++)switch(a.charCodeAt(b)){case 94:break;case 92:if(b===a.length-1)throw f.sR().Exp_FormulaInvalid;e.includeNormalChar=e.includeNormalChar+a.substring(b+1,b+2),b++;break;default:c=a[b],d=h[c],d?e.allowTypes|=d:e.includeNormalChar=e.includeNormalChar+a.substring(b,b+1)}},a.prototype.parseExcludeFormat=function(a){var b,c,d,e=this;if(null===a||0===a.length)return e.excludeTypes=g.All,e.excludeNormalChar="",void(e.excludeFormat="");if("^"===a)return e.excludeTypes=g.All,e.excludeNormalChar="",void(e.excludeFormat="^");for(e.excludeTypes=0,e.excludeNormalChar="",b=0;b<a.length;b++)switch(a.charCodeAt(b)){case 94:0===b&&(e.include=!1);break;case 92:if(b===a.length-1)throw f.sR().Exp_FormulaInvalid;e.excludeNormalChar=e.excludeNormalChar+a.substring(b+1,b+2),b++;break;default:c=a[b],d=h[c],d?e.excludeTypes|=d:e.excludeNormalChar=e.excludeNormalChar+a.substring(b,b+1)}},a.prototype.checkText=function(a){var b,c,d,e=this,f=a.length,g={IsInputValid:!0,CheckedText:""};for(b=0;b<f;)c=a.substring(b,b+1),"\t"!==c&&"\r"!==c&&"\n"!==c?(d=e.check(a,b),e.isNullOrUndefined(d.index)?(c=d,b++):(b=d.index,c=d.strValue),""===c&&(g.IsInputValid=!1)):b++,g.CheckedText+=c;return g},a.prototype.check=function(a,b){var c,d,e=this;return c=null!==b?a.substring(b,b+1):a,d=e.IsValid(c),d?c:e.autoConvert?null!==b?e.Convert(a,b):e.Convert(c):""},a.prototype.IsValid=function(a){var b=this;if(""!==b.excludeFormat){if(b.IsValidProcess(a,b.excludeTypes,b.excludeNormalChar))return!1;if(""!==b.includeFormat)return b.IsIncludeValid(a)}else if(""!==b.includeFormat)return b.IsIncludeValid(a);return!0},a.prototype.Convert=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this;if(c=null===b?a:a.substring(b,b+1),d=!1,m.charExInstance.isAlphabet(c))return e=m.charExInstance.isLower(c)?c.toUpperCase():c.toLowerCase(),(d=m.IsValid(e))?e:(c=m.charExInstance.isFullWidth(c)?m.charExInstance.toHalfWidth(c):m.charExInstance.toFullWidth(c).text,(d=m.IsValid(c))?c:(e=m.charExInstance.isFullWidth(e)?m.charExInstance.toHalfWidth(e):m.charExInstance.toFullWidth(e).text,d=m.IsValid(e),d?e:m.keepInvalidChar?c:""));if(m.charExInstance.isHiragana(c)){if(m.charExInstance.isLowerKana(c)){if(f=m.charExInstance.toUpperKana(c),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(c)&&(g=m.charExInstance.toLowerKana(c),d=m.IsValid(g)))return g;if(e=m.charExInstance.toKatakana(c),d=m.IsValid(e))return e;if(m.charExInstance.isLowerKana(e)){if(f=m.charExInstance.toUpperKana(e),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(e)&&(g=m.charExInstance.toLowerKana(e),d=m.IsValid(g)))return g;if(h=m.charExInstance.toHalfWidthEx(e),d=m.IsValid(h))return h;if(m.charExInstance.isLowerKana(h)){if(h=m.charExInstance.toUpperKana(h),d=m.IsValid(h))return h}else if(m.charExInstance.hasLowerKana(h)&&(h=m.charExInstance.toLowerKana(h),d=m.IsValid(h)))return h;return m.keepInvalidChar?c:""}if(m.charExInstance.isKatakana(c)){if(m.charExInstance.isLowerKana(c)){if(f=m.charExInstance.toUpperKana(c),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(c)&&(g=m.charExInstance.toLowerKana(c),d=m.IsValid(g)))return g;if(i=!1,e=c,m.charExInstance.isFullWidth(c)){if(j=m.charExInstance.toHalfWidthEx(c),j.length>0&&(d=m.IsValid(j)))return j;if(m.charExInstance.isLowerKana(j)){if(j=m.charExInstance.toUpperKana(j),d=m.IsValid(j))return j}else if(m.charExInstance.hasLowerKana(j)&&(j=m.charExInstance.toLowerKana(j),d=m.IsValid(j)))return j}else{if(null===b){if(e=m.charExInstance.toFullWidth(c).text,!m.charExInstance.isKatakana(e))return m.keepInvalidChar?c:"";if(d=m.IsValid(e))return e}else{if(b+1<a.length?(k=m.charExInstance.toFullWidth(a.substring(b,b+2)),e=k.text,i=k.processedAll):e=m.charExInstance.toFullWidth(c).text,!m.charExInstance.isKatakana(e))return m.keepInvalidChar?c:"";if(d=m.IsValid(e))return b++,i&&b++,l={},l.index=b,l.strValue=e,l}if(m.charExInstance.isLowerKana(e)){if(f=m.charExInstance.toUpperKana(e),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(e)&&(g=m.charExInstance.toLowerKana(e),d=m.IsValid(g)))return g}if(e=m.charExInstance.toHiragana(e),d=m.IsValid(e))return null!==b?(b++,i&&b++,l={},l.index=b,l.strValue=e,"\u3094"===e&&(i?l.strValue="\u3046\u309b":l.strValue=""),l):"\u3094"===e?m.keepInvalidChar?c:"":e;if(m.charExInstance.isLowerKana(e)){if(f=m.charExInstance.toUpperKana(e),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(e)&&(g=m.charExInstance.toLowerKana(e),d=m.IsValid(g)))return g}return c=m.charExInstance.isFullWidth(c)?m.charExInstance.toHalfWidth(c):m.charExInstance.toFullWidth(c).text,d=m.IsValid(c),d?c:m.keepInvalidChar?c:""},a.prototype.IsIncludeValid=function(a){var b=this;return b.IsValidProcess(a,b.allowTypes,b.includeNormalChar)},a.prototype.IsValidProcess=function(a,b,c){var d,f,h=this;if(c.indexOf(a)!==-1)return!0;if("\t"===a||"\r"===a||"\n"===a)return!0;if(0===b)return!1;if(d=!1,b===g.All||(b&g.Emoji)===(0|g.Emoji)&&e.M$c.isEmoji(a,0,{})||(b&g.FourBytes)===(0|g.FourBytes)&&h.IsFourBytes(a))return!0;if(1===a.length&&a.length>1)return!1;if(h.charExInstance.isFullWidth(a)){if((b&g.DBCS)!==(0|g.DBCS))return!1;(b&g.DBCS_All)===(0|g.DBCS_All)&&"\u3000"!==a||(b&g.DBCS_LowerAlphabet)===(0|g.DBCS_LowerAlphabet)&&h.IsLower(a)||(b&g.DBCS_UpperAlphabet)===(0|g.DBCS_UpperAlphabet)&&h.IsUpper(a)||(b&g.DBCS_Number)===(0|g.DBCS_Number)&&h.IsNumber(a)||(b&g.DBCS_Binary)===(0|g.DBCS_Binary)&&h.IsBinary(a)||(b&g.DBCS_Hexadecimal)===(0|g.DBCS_Hexadecimal)&&h.IsHex(a)||(b&g.DBCS_Symbol)===(0|g.DBCS_Symbol)&&h.IsSymbol(a)||(b&g.DBCS_NumberSymbol)===(0|g.DBCS_NumberSymbol)&&h.IsNumberSymbol(a)||(b&g.Upper_DBCS_Katakana)===(0|g.Upper_DBCS_Katakana)&&h.IsKatakana(a)&&h.IsUpperKana(a)||(b&g.Upper_DBCS_Hiragana)===(0|g.Upper_DBCS_Hiragana)&&h.IsHiragana(a)&&h.IsUpperKana(a)||(b&g.DBCS_Space)===(0|g.DBCS_Space)&&h.IsFormatSpace(a)||(b&g.FourBytes)===(0|g.FourBytes)&&h.IsFourBytes(a)||(b&g.TwoBytes)===(0|g.TwoBytes)&&!h.IsFourBytes(a)&&"\u3000"!==a?d=!0:(b&g.DBCS_Katakana)===(0|g.DBCS_Katakana)&&h.IsKatakana(a)?(f=h.IsHiragana(a),d=!f||(!!h.include||(b&g.DBCS_Hiragana)===(0|g.DBCS_Hiragana))):(b&g.DBCS_Hiragana)===(0|g.DBCS_Hiragana)&&h.IsHiragana(a)&&(f=h.IsKatakana(a),d=!f||(!!h.include||(b&g.DBCS_Katakana)===(0|g.DBCS_Katakana)))}else{if((b&g.SBCS)!==g.SBCS)return!1;((b&g.SBCS_All)===g.SBCS_All&&" "!==a||(b&g.SBCS_LowerAlphabet)===g.SBCS_LowerAlphabet&&h.IsLower(a)||(b&g.SBCS_UpperAlphabet)===g.SBCS_UpperAlphabet&&h.IsUpper(a)||(b&g.SBCS_Number)===g.SBCS_Number&&h.IsNumber(a)||(b&g.SBCS_Binary)===g.SBCS_Binary&&h.IsBinary(a)||(b&g.SBCS_Hexadecimal)===g.SBCS_Hexadecimal&&h.IsHex(a)||(b&g.SBCS_Symbol)===g.SBCS_Symbol&&h.IsSymbol(a)||(b&g.SBCS_NumberSymbol)===g.SBCS_NumberSymbol&&h.IsNumberSymbol(a)||(b&g.SBCS_Katakana)===g.SBCS_Katakana&&h.IsKatakana(a)||(b&g.Upper_SBCS_Katakana)===g.Upper_SBCS_Katakana&&h.IsKatakana(a)&&h.IsUpperKana(a)||(b&g.SBCS_Space)===g.SBCS_Space&&h.IsFormatSpace(a))&&(d=!0)}return d},a.prototype.IsUpper=function(a){return this.charExInstance.isUpper(a)},a.prototype.IsLower=function(a){return this.charExInstance.isLower(a)},a.prototype.IsNumber=function(a){return this.charExInstance.isDigit(a)},a.prototype.IsBinary=function(a){return a=this.IsFullWidth(a)?this.ToHalfWidth(a):a,"0"===a||"1"===a},a.prototype.IsHex=function(a){var b=this;return a=b.IsFullWidth(a)?b.ToHalfWidth(a):a,"A"===a||"B"===a||"C"===a||"D"===a||"E"===a||"F"===a||"a"===a||"b"===a||"c"===a||"d"===a||"e"===a||"f"===a||b.IsDigit(a)},a.prototype.IsNumberSymbol=function(a){var b=this;return a=b.IsFullWidth(a)?b.ToHalfWidth(a):a,b.IsDigit(a)||"+"===a||"-"===a||"$"===a||"%"===a||"\\"===a||","===a||"."===a},a.prototype.IsKatakana=function(a){return this.charExInstance.isKatakana(a)},a.prototype.IsHiragana=function(a){return this.charExInstance.isHiragana(a)},a.prototype.IsFullWidth=function(a){return this.charExInstance.isFullWidth(a)},a.prototype.ToHalfWidth=function(a){return this.charExInstance.toHalfWidth(a)},a.prototype.IsDigit=function(a){return this.charExInstance.isDigit(a)},a.prototype.IsFourBytes=function(a){var b,c=this.charExInstance,d=a.substring(0,1);if(2===d.length)for(b=0;b<d.length;b++)if(c.isSurrogate(d[b]))return!0;return!1},a.prototype.IsFormatSpace=function(a){return" "===a||"\u3000"===a},a.prototype.IsSymbol=function(a){var b=this;return b.charExInstance.isHalfWidthSymbol(a)||b.charExInstance.isFullWidthSymbol(a)},a.prototype.IsUpperKana=function(a){return this.charExInstance.isUpperKana(a)},a.prototype.isNullOrUndefined=function(a){return null===a||void 0===a},a}(),b.n$c=i},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),a.exports=d.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"@grapecity/js-sheets-common":function(a,b){a.exports=GC.Spread}});;/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=GC.Spread.CalcEngine||{},GC.Spread.CalcEngine.BasicFunctions=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./node_modules_local/@grapecity/js-calc-basicfunctions/index.js")}({"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=d.Spread.CalcEngine||{},d.Spread.CalcEngine.BasicFunctions=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/basicFunctions.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()}catch(a){"object"==typeof window&&(c=window)}a.exports=c},"./src/basicFunctions.entry.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("CalcEngine");b.Functions=d.Functions,c("./src/functions-basic.ts")},"./src/functions-basic.ts":function(a,b,c){"use strict";(function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.q,g=d.Common.u,h=d.Common.l,i=h.Ra,j=h.Xb,k=h.Qa,l=d.Common.k.ac,m=d.Common.j,n=m.Ea,o=m.Fa,p=null,q=void 0,r=isNaN,s=parseFloat,t=parseInt,u=Math.round,v=Math.abs,w=Math.sqrt,x=Math.max,y=Math.min,z=Math.floor,A=Math.exp,B=Math.log,C=Math.PI,D=Math.random,E=Math.pow,F=e.Errors.Null,G=e.Errors.DivideByZero,H=e.Errors.Value,I=e.Errors.Reference,J=e.Errors.Name,K=e.Errors.Calc,L=e.Errors.NotAvailable,M=e.Errors.Number,N=e.Convert.CalcConvertedError,O=e.Convert.vf,P=e.Convert.Fh,Q=e.Convert.Ca,R=e.Convert.Uh,S=e.Convert.Rh,T=e.Convert.Pa,U=e.Convert.bc,V=e.Convert.Na,W=e.Convert.Ph,X=e.Convert.Nh,Y=e.Zh.tryExtractToSingleValue,Z=e.Functions.ik,$=e.Functions.Na,_=h.Ska,aa=e.Functions.jk,ba=e.Functions.kk,ca=e.Functions.UAb,da=e.Functions.VAb,ea=e.Functions.WAb,fa=e.Functions.nk,ga=e.Functions.tk,ha=e.Functions.Hfc,ia=e.Functions.mja,ja=e.Functions.sk,ka=e.Functions.MathHelper,la=ka.zk,ma=ka.wk,na=e.Functions.ak,oa=e.Convert.Th,pa=e.Convert.Uh,qa=e.Convert.jja,ra=2048,sa=1e4,ta=new Date(1900,0,1),ua=new Date(9999,11,31);function Oa(a,b){for(;0!==b;){var c=a%b;a=b,b=c}return a}function Pa(a,b,c,d){return 0===b||0===a?0:0!==c&&a<0?d===!0?ma(a/Math.abs(b))*Math.abs(b):la(a/Math.abs(b))*Math.abs(b):d===!0?la(a/Math.abs(b))*Math.abs(b):ma(a/Math.abs(b))*Math.abs(b)}function Qa(a,b,c){var d,e,f,g,h,i,j=a[0],k=W(a[1],1,!0,!1,!1,!0),m=l(k),n=k.rowCount,o=k.colCount,p=[],q=[],r=[],s=j.row,t=j.column,u=j.source.getCalcSourceModel().qg(s,t);function v(a){var b=a.getSource();return function(c){return{id:b.id,source:b,row:a.getRow(0)+c%n,col:a.getColumn(0)+z(c/n),rowCount:1,colCount:1}}}for(g=2;g<l(a);g+=2){if(i=W(a[g],0,!0,!1,!1),i.rowCount!==n||i.colCount!==o)return H;h=ka.xk(a[g+1]),p.push(i),q.push(h),g>=4&&u&&P(a[g])&&(i.getRef=v(a[g]))}for(u&&P(a[1])&&!c&&(k.getRef=v(a[1])),f=0;f<m;f++){for(e=!0,g=0;g<l(p)&&(h=q[g],d=p[g][f],e=h&&h(d),p[g].getRef&&Ib(u,p[g].getRef(f)),e);g++);e&&(k.getRef&&Ib(u,k.getRef(f)),d=k[f],(c||d!==N)&&r.push(d))}return b(r)}function Ra(a,b){return b=b<0?z(b):Math.ceil(b),(a&&b%2===0||!a&&b%2!==0)&&(b+=b<0?-1:1),b}function Sa(a,b,c){return b>0&&c<0?M:b<0&&c>0?(c=-c,a?ma(b/c)*c:la(b/c)*c):a?la(b/c)*c:ma(b/c)*c}function Ta(a,b,c){var d,e,f,g=ka.yk(v(c));return b=c<0?b/g:b*g,d=la(b),e=ma(b),a&&(f=d,d=e,e=f),b=b<0?d:e,b=c<0?b*g:b/g,X(b)}function Ua(a,b,c,d){var e=b?-1:1,f=0,g,h,i;if(l(c)!==l(d))return L;for(i=0;i<l(c);i++)g=c[i],h=d[i],g!==N&&h!==N&&(f+=a?(g-h)*(g-h):g*g+e*h*h);return X(f)}function Va(a){return X(v(a))}function Wa(a,b){var c,d,e,f;if(P(b))if(c=b.getRow(0),d=b.getColumn(0),e=b.getRowCount(0),f=b.getColumnCount(0),1===e&&1===f)b=b.getValue(0,0,0);else if(1!==e&&1===f&&c<=a.row&&a.row<c+e)b=b.getValue(0,a.row-c,0);else{if(!(1===e&&1!==f&&d<=a.column&&a.column<d+f))return H;b=b.getValue(0,0,a.column-d)}return b=T(b),isNaN(b)?H:ma(b)}function Xa(a,b){var c=1,d;if(a<b)return M;for(b=y(a-b,b),d=1;d<=b;d++)c*=a-d+1,c/=d;return X(c)}function Ya(a,b){var c=1,d;for(d=1;d<=b;d++)c*=a+d-1;for(d=2;d<=b;d++)c/=d;return X(c)}function Za(a,b){var c,d,e,f,g,h,i;if(!a||a.length>255)return 0;if(c=a.length,0===c)return 0;if("-"===a[0])return M;for(d=0;d<c&&" "===a[d];)d++;if(e=0,d===c)return 0;for(f=1,g=c-1;g>=d;g--){if(h=a.charCodeAt(g)|" ".charCodeAt(0),i=h-"a".charCodeAt(0)>=0?h-87:h-48,i<0||i>=b)return M;e+=i*f,f*=b}return e}function $a(a){return 180*a/C}function _a(a){return Ra(!0,a)}function ab(a){return Ra(!1,a)}function bb(a){return ga(a)}function cb(a){var b=1,c;for(c=a;c>1;c-=2)b*=c;return b}function db(a){return X(B(a))}function eb(a,b){return a-b*z(a/b)}function fb(){return C}function gb(a,b){if(0===a&&b<0)return G;if(0===a&&0===b)return M;var c=e.Functions.MathHelper.YDc(a,b);return c===Number.POSITIVE_INFINITY||c===Number.NEGATIVE_INFINITY||isNaN(c)?M:c}function hb(){var a,b,c,d,e=arguments,f=0;for(a=0;a<l(e);a++){if(b=e[a],c=void 0,d=void 0,O(b))return b;if(P(b)||Q(b)){if(c=W(b,1,!0,!0,!1),c.isError)return c[0]}else c=W(b,1,!0,!0,!0);for(d=0;d<l(c);d++)c[d]!==N&&(f+=c[d])}return f}function ib(){var a,b,c,d,f,g;if(!e.ExcelCompatibleCalcMode)return hb.apply(null,arguments);for(a=arguments,b=0,c=0;c<l(a);c++){if(d=a[c],f=void 0,g=void 0,O(d))return d;if(P(d)||Q(d)){if(f=W(d,5,!0,!0,!1,!0),f.isError)return f[0]}else f=W(d,1,!0,!0,!1,!0);for(g=0;g<l(f);g++)f[g]!==N&&(b+=f[g])}return b}function jb(a){return 0===a?0:-1}function kb(){var a,b,c,d,e=arguments,f=0;for(a=0;a<l(e);a++)for(c=e[a],b=0;b<l(c);b++)if(d=c[b],d!==N){if(d<0)return M;f=Oa(f,S(d))}return f}function lb(){var a,b,c,d,e=arguments,f=1,g=[];for(a=0;a<l(e);a++){for(c=e[a],b=0;b<l(c);b++)if(d=c[b],d!==N){if(d<0)return M;if(0===d)return 0;g.push(S(d))}for(b=0;b<l(g);b++)d=g[b],f/=Oa(f,d),f*=d}return f}function mb(){return ha(arguments,2,6)}function nb(a){return w(a)}function ob(a,b){return t(""+a/b)}function pb(a){var b,c=arguments,d=[];for(b=1;b<l(c);b++)d[b-1]=c[b];return rb(a,0,d)}function qb(a){var b,c=arguments,d=[];for(b=1;b<l(c);b++)d[b-1]=c[b];return rb(a,1,d)}function rb(a,b,c){var d=H;return n(a,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?d=ha(c,b,a):n(a,[7,107,8,108,10,110,11,111])>=0&&(d=ja(c,b,a)),d}function sb(a,b,c){var d,e=arguments,f=[];for(d=3;d<l(e);d++)f[d-3]=e[d];return ia(f,c,b,a)}function tb(a,b){return Sa(!0,a,b)}function ub(a,b){return Sa(!1,a,b)}function vb(a,b,c){return Pa(a,b,c,!0)}function wb(a,b,c){return Pa(a,b,c,!1)}function xb(a,b,c){var d=""+a.toString(b);return c&&d.length<c?Array.apply(null,{length:c-d.length+1}).join(0)+d:d}function yb(a,b){return a<0&&b>0||b<0&&a>0?M:ma(a/b+.5)*b}function zb(a,b){return ka.Ak(a,b)}function Ab(a,b){return Ta(!1,a,b)}function Bb(a,b){return Ta(!0,a,b)}function Cb(a){return X(A(a))}function Db(a,b){return la(a/v(b))*v(b)}function Eb(a,b){return ma(a/v(b))*v(b)}function Fb(a,b){return 1===b?G:X(ka.Ek(a,b))}function Gb(a){return X(ka.Ek(a,10))}function Hb(a,b,c,d){var e,f,g,h,i,j,k,m,n,p,r,s,t,u,v,w,x,y,z,A,B=d!==q&&P(d);if(d=d!==q?d:b,o(c)&&(c=0),e=0,f=ka.xk(c),g=Q(b),h=Q(d),(g?1:b.getRangeCount())!==(h?1:d.getRangeCount()))return H;if(i=d,d===b||h||(j=g?b.getRowCount():b.getRowCount(0),k=g?b.getColumnCount():b.getColumnCount(0),j===d.getRowCount(0)&&k===d.getColumnCount(0)||(m=d.getRow(0),n=d.getColumn(0),i=d.create([{row:m,col:n,rowCount:j,colCount:k}]))),p=b.toArray(0,!1,!1),r=i.toArray(1,!1,!1),p.isError)return p[0];if(r.isError)return r[0];for(B&&(s=a.row,t=a.column,u=i.getRow(0),v=i.getColumn(0),w=a.source.getCalcSourceModel().qg(s,t),x=d.getSource(),B=w&&x.getRangeKey),y=0;y<l(p);y++)for(z=0;z<l(p[y]);z++)f&&f(p[y][z])&&(A=r[y]&&r[y][z],A&&A!==N&&(e+=A),B&&Ib(w,{id:x.id,source:x,row:u+y,col:v+z,rowCount:1,colCount:1}));return X(e)}function Ib(a,b){var c,d=b.source;d.getRangeKey&&(c=d.getRangeKey(d,b),a.eOb||(a.eOb={}),a.eOb[c]=b)}function Jb(){return Qa(arguments,function(a){var b,c,d=0;for(b=0;b<a.length;b++){if(c=a[b],O(c))return c;d+=c}return d})}function Kb(){return Qa(arguments,function(a){var b=null;return a.length>0&&(b=Math.max.apply(null,a)),b})}function Lb(){return Qa(arguments,function(a){var b=null;return a.length>0&&(b=Math.min.apply(null,a)),b})}function Mb(){var a,b=arguments,c=l(b),d=[b[0],b[1]];for(a=1;a<c;a++)d[a+1]=b[a];return Qa(d,function(a){return a.length},!0)}function Nb(a){return Qa(arguments,function(a){var b,c,d=0,e=0;for(b=0;b<a.length;b++){if(c=a[b],O(c))return c;d+=c,e++}return 0===e?G:X(d/e)})}function Ob(a){for(var b=[],c=0,d=[];c<a;c++)d[c]=0;for(c=0;c<a;c++)b[c]=d.slice(0),b[c][c]=1;return new e.CalcArray(b)}function Pb(){var a,b,c,d,e,f,g,h=arguments,i=0,j=[],k=0;for(a=0;a<l(h);a++){if(d=W(h[a],1,!0,!0,!1,!0),d.isError)return d[0];if(d.isConvertError)return H;if(0===a)b=d.rowCount,c=d.colCount,k=l(d);else if(d.rowCount!==b||d.colCount!==c)return H;j.push(d)}for(a=0;a<k;a++){for(e=1,f=0;f<l(h);f++){if(g=j[f][a],g===N){if(1===k)return H;e=0;break}e*=g}i+=e}return X(i)}function Qb(){var a,b,c,d,e=arguments,f=0;for(b=0;b<l(e);b++)for(d=e[b],c=0;c<l(d);c++)a=d[c],a!==N&&(f+=a*a);return X(f)}function Rb(a,b){return Ua(!1,!0,a,b)}function Sb(a,b){return Ua(!1,!1,a,b)}function Tb(a,b){return Ua(!0,!1,a,b)}function Ub(a,b,c,d){var e,f,g=0;for(e=0;e<l(d);e++){if(f=T(d[e]),r(f))return H;g+=f*E(a,b+e*c)}return X(g)}function Vb(a){return X(w(a*C))}function Wb(a){return C*a/180}function Xb(a){return X(Math.sin(a))}function Yb(a){var b=Xb(a);return 0===b?G:1/b}function Zb(a){return X(Math.cos(a))}function $b(a){var b=Zb(a);return 0===b?G:1/b}function _b(a){return X(Math.tan(a))}function ac(a){return 0===a?G:X(1/Math.tan(a))}function bc(a){return X(Math.asin(a))}function cc(a){return X(Math.acos(a))}function dc(a){return X(ka.Dk(a,!0))}function ec(a){if(a>709||a<-709)return 0;var b=dc(a);return 0===b?G:1/b}function fc(a){return X(ka.Dk(a,!1))}function gc(a){if(a>709||a<-709)return 0;var b=fc(a);return 0===b?G:1/b}function hc(a){return X(B(a+w(a*a+1)))}function ic(a){return X(B(a+w(a*a-1)))}function jc(a){return X(Math.atan(a))}function kc(a){return X(a<0?Math.PI+Math.atan(1/a):Math.atan(1/a))}function lc(a,b){return 0===a&&0===b?G:X(Math.atan2(b,a))}function mc(a){var b=A(a),c=A(-a);return X(b-c)/(b+c)}function nc(a){if(0===a)return G;if(a>10)return 1;if(a<-10)return-1;var b=mc(a);return 1/b}function oc(a){return X(B((1+a)/(1-a))/2)}function pc(a){return oc(1/a)}function qc(a){var b=a.rowCount,c=1,d,e,f,g,h,i,j,k;if(a.rangeCount>1||b!==a.colCount)return H;for(d=0;d<b-1;d++){if(0===a[d][d]){for(i=!1,e=d+1;!i&&e<b;e++)if(0!==a[e][d]){for(g=d;g<b;g++)j=a[d][g],a[d][g]=a[e][g],a[e][g]=j;c*=-1,i=!0}if(!i)return 0}for(f=d+1;f<b;f++)if(0!==a[f][d])for(k=a[f][d]/a[d][d],h=d;h<b;h++)a[f][h]-=k*a[d][h]}for(d=0;d<b;d++)c*=a[d][d];return c}function rc(a){var b=a.rowCount,c=[],d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(a.rangeCount>1||b!==a.colCount)return H;for(d=0;d<b;d++)for(c[d]=[b],h=0;h<b;h++)c[d][h]=d===h?1:0;for(f=0;f<b;f++){if(0===a[f][f]){for(t=!1,i=f+1;!t&&i<b;i++)if(0!==a[i][f]){for(k=f;k<b;k++)r=a[f][k],a[f][k]=a[i][k],a[i][k]=r;for(l=1;l<b;l++)s=c[f][l],c[f][l]=c[i][l],c[i][l]=s;t=!0}if(!t)return M}for(j=0;j<b;j++)if(j!==f&&0!==a[j][f]){for(p=a[j][f]/a[f][f],m=f;m<b;m++)a[j][m]-=p*a[f][m];for(n=0;n<b;n++)c[j][n]-=p*c[f][n]}}for(g=0;g<b;g++)for(q=a[g][g],o=0;o<b;o++)c[g][o]/=q;return new e.CalcArray(c)}function sc(a,b){var c,d,f,g,h,i,j=a.rowCount,k=a.colCount,l=b.rowCount,m=b.colCount,n=[];if(k!==l)return H;for(f=0;f<j;f++)for(n[f]=c=[],d=a[f],g=0;g<m;g++){for(i=0,h=0;h<l;h++)i+=d[h]*b[h][g];c[g]=i}return new e.CalcArray(n)}function tc(){var a,b,c,d,e=arguments,f=0,g=1;for(b=0;b<l(e);b++)for(a=e[b],c=0;c<l(a);c++){if(d=S(a[c]),d<0||170<d)return M;f+=d,g*=ga(d)}return f<0||170<f?M:ga(f)/g}function uc(){return v(2*D()-1)}function vc(a,b){return b<a?M:S(a+D()*(b-a+1))}function wc(a,b){var c,d,e,f,g,h,i,j,k=["M","D","C","L","X","V","I"],l=[1e3,500,100,50,10,5,1],m=7,n=[];if(c=Z(b)?b?0:4:b,c>4||c<0)return H;for(d=0;d<m;d+=2){if(2<=d&&l[d-2]-l[d]<=a){for(e=d,f=d-2,g=void 0,g=0;g<c&&e+1<m&&l[f]-l[e+1]<=a;g++)e++;n.push(k[e]),n.push(k[f]),a+=l[e],a-=l[f]}if(1<=d&&l[d-1]<=a&&(n.push(k[d-1]),a-=l[d-1]),1<=d&&l[d-1]-l[d]<=a){for(h=d,i=d-1,j=void 0,j=0;j<c&&h+1<m&&l[i]-l[h+1]<=a;j++)h++;n.push(k[h]),n.push(k[i]),a+=l[h],a-=l[i]}for(;l[d]<=a;)n.push(k[d]),a-=l[d]}return n.join("")}function xc(a){var b,c,d,e,f,g,h,i,j,k;if(!a.length)return 0;if(a.length>255)return H;for(a=a.toLowerCase(),b=0,c=a.length-1,e=0,h=-1;c>=0&&" "===a[c];)c--;for(i=0;i<=c&&" "===a[i];)i++;j=!1,i<=c&&"-"===a[i]&&(j=!0,i++);do{for(d=c,k=a[d],--c;c>=i&&(a[c].charCodeAt(0)|" ".charCodeAt(0))===k.charCodeAt(0);)--c;switch(k){case"i":f=d-c,g=1;break;case"v":f=5*(d-c),g=5;break;case"x":f=10*(d-c),g=10;break;case"l":f=50*(d-c),g=50;break;case"c":f=100*(d-c),g=100;break;case"d":f=500*(d-c),g=500;break;case"m":f=1e3*(d-c),g=1e3;break;default:return H}g>=h?(b+=f-e,h=g,e=0):e+=f}while(c>=i);return 0!==e&&(b-=e),j&&(b=-b),b}function yc(a,b,c,d){var f,g,h,i,j,k,l;if(void 0===a&&(a=1),void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=1),f=c,0===a||0===b)return K;if(a<0||b<0)return H;if("string"==typeof c||c instanceof Date){if(g={},!e.Convert.Th(c,g))return H;f=g.value}for(h=[],i=0,j=f;i<a;i++)for(k=[],h.push(k),l=0;l<b;l++)k.push(j),j+=d;return new e.CalcArray(h)}function zc(a,b,c,d,f){var g,h,i,j,k,l;if(void 0===a&&(a=1),void 0===b&&(b=1),void 0===c&&(c=0),void 0===d&&(d=1),void 0===f&&(f=!1),0===a||0===b)return K;if(a<0||b<0)return H;if(c>d)return H;if(f&&(c!==z(c)||d!==z(d)))return H;for(g=d-c,f&&g++,h=[],i=0;i<a;i++)for(j=[],h.push(j),k=0;k<b;k++)l=c+D()*g,f&&(l=t(l)),j.push(l);return new e.CalcArray(h)}function Ac(a,b){var c,d,f,g,h=!0;for(c=0;c<l(b);c++)for(f=b[c],d=0;d<l(f);d++){if(e.ExcelCompatibleCalcMode){if("string"==typeof f[d]||o(f[d]))continue;h=!1}if(g={value:p},f[d]=oa(f[d],g)?g.value:N,a){if(!f[d])return!1}else if(f[d]&&f[d]!==N)return!0}return e.ExcelCompatibleCalcMode&&h?H:!!a}function Bc(){return Ac(!0,arguments)}function Cc(){return Ac(!1,arguments)}function Dc(a){var b,c;return e.ExcelCompatibleCalcMode&&"string"==typeof a?H:(b={},c=e.Convert.Uh(a,b),c?!b.value:H)}function Ec(a,b,c){var d,e,f=a,g=b,h=Y(f);return O(a)?a:(d=c!==q?c:2!==l(arguments)&&null,e={},R(h.value,e),e.value?g:d)}function Fc(a,b){return O(a)?o(b)?0:b:o(a)?0:a}function Gc(a,b){var c,d,e,f;if(!O(a)&&P(a)){if(a.getRangeCount()>1)return H;if(c=0,d=0,e=this.y0a)if(c=e.row,d=e.col,f=a.yf&&a.yf[0],f&&1===f.rowCount&&1===f.colCount)c=0,d=0;else if(f&&(c+1>f.rowCount||d+1>f.colCount))return b;a=a.getValue(0,c,d)}return Fc(a,b)}function Hc(){return!0}function Ic(){return!1}function Jc(a,b){return qa(a)?b:a}function Kc(){var a,b,c;for(a=0,b=arguments.length;a<b;a++){if(c={value:!1},O(arguments[a]))return arguments[a];if(!R(arguments[a++],c))return H;if(c.value)return arguments[a]}return L}function Lc(){var a,b,c,d,e=arguments;if(e.length<3)return H;if(a=e[0],O(a))return a;for(a===p&&(a=0),b=1,c=e.length-1;b<c;b++){if(d=e[b],b++,O(d))return d;if(d===p&&(d=0),aa(a)&&aa(d)){if(a.toUpperCase()===d.toUpperCase())return e[b]}else if(a===d)return e[b]}return e.length%2===0?e[e.length-1]:L}function Mc(){var a,b,c,d=0;for(a=0;a<l(arguments);a++)for(c=arguments[a],b=0;b<l(c);b++)c[b]&&d++;return!!(d%2)}function Nc(a,b,c){var d,e,f,g,h=a.source&&a.source.Af&&a.source.Af.lh;if(!h)return K;d=a.localScopes;try{if(a.lambdaFunctionCallDepth++,d.enterScope(),d.saveThenSwitchClosure(b.closure),f=b.parameters,f.length!==c.length)return H;for(g=0;g<f.length;g++)a.localScopes.setVariable(f[g].value,c[g]);e=h.evaluate(b.calculation,a,!1,!1)}finally{a.lambdaFunctionCallDepth--,d.exitScope(),d.restoreClosure()}return e}function Oc(a){return!Q(a)||1===a.getColumnCount()&&1===a.getRowCount()}function Pc(a){return Q(a)?a.getValue(0,0):a}function Qc(a,b,c){return a[b*a.colCount+c]}function Rc(){var a,b,c,d,f,g,h,i,j,k,m,n,o=arguments,p=l(o),q=o[0],r=o[p-1];if(!e.isLambdaFunction(r))return H;for(a=[],b=0,c=0,d=1;d<p-1;d++){if(f=Me(o[d],0),O(f))return f;b=Math.max(b,f.rowCount),c=Math.max(c,f.colCount),a.push(f)}if(r.parameters.length!==a.length)return H;for(g=[],h=0;h<b;h++){for(i=[],j=0;j<c;j++){for(k=[],m=!1,d=0;d<a.length;d++){if(!(h<a[d].rowCount&&j<a[d].colCount)){m=!0;break}k.push(Qc(a[d],h,j))}if(m)i.push(L);else{if(n=Nc(q,r,k),n&&n.pause)return n;if(!Oc(n))return K;n=Pc(n),i.push(n)}}g.push(i)}return new e.CalcArray(g)}function Sc(a,b,c,d){var f,g,h,i,j,k;if(c=Me(c,0,!1),O(c))return c;if(!e.isLambdaFunction(d)||2!==d.parameters.length)return H;for(f=c.rowCount,g=c.colCount,h=b,i=0;i<f;i++)for(j=0;j<g;j++){if(k=Qc(c,i,j),h=b===p&&0===i&&0===j?k:Nc(a,d,[h,k]),h&&h.pause)return h;if(!Oc(h))return K;h=Pc(h)}return h}function Tc(a,b,c,d){var f,g,h,i,j,k,l,m;if(c=Me(c,0,!1),O(c))return c;if(!e.isLambdaFunction(d)||2!==d.parameters.length)return H;for(f=c.rowCount,g=c.colCount,h=[],i=b,j=0;j<f;j++){for(k=[],l=0;l<g;l++){if(m=Qc(c,j,l),i=b===p&&0===j&&0===l?m:Nc(a,d,[i,m]),i&&i.pause)return i;if(!Oc(i))return K;i=Pc(i),k.push(i)}h.push(k)}return new e.CalcArray(h)}function Uc(a,b,c,d){var f,g,h,i,j;if(!e.isLambdaFunction(d)||2!==d.parameters.length)return H;if(b<=0||c<=0)return new e.CalcArray([[0]]);for(f=[],g=0;g<b;g++){for(h=[],i=0;i<c;i++){if(j=Nc(a,d,[g+1,i+1]),j&&j.pause)return j;if(!Oc(j))return K;j=Pc(j),h.push(j)}f.push(h)}return new e.CalcArray(f)}function Vc(a,b,c){var d,f,g,h,i,j,k;if(!e.isLambdaFunction(c)||1!==c.parameters.length)return 2===arguments.length?L:H;if(b=Me(b,0,!1),O(b))return b;for(d=b.rowCount,f=b.colCount,g=[],h=0;h<d;h++){for(i=[],j=0;j<f;j++)i.push(Qc(b,h,j));if(k=Nc(a,c,[new e.CalcArray([i])]),k&&k.pause)return k;if(!Oc(k))return K;k=Pc(k),g.push([k])}return new e.CalcArray(g)}function Wc(a,b,c){var d,f,g,h,i,j,k;if(!e.isLambdaFunction(c)||1!==c.parameters.length)return 2===arguments.length?L:H;if(b=Me(b,0,!1),O(b))return b;for(d=b.rowCount,f=b.colCount,g=[],h=0;h<f;h++){for(i=[],j=0;j<d;j++)i.push(Qc(b,j,h));if(k=Nc(a,c,[new e.CalcArray([i])]),k&&k.pause)return k;if(!Oc(k))return K;k=Pc(k),g.push(k)}return new e.CalcArray([g])}function Xc(a){var b,c=a.getFullYear(),d=a.getMonth(),e=a.getDate(),f=e;for(b=0;b<d;b++)f+=fa(c,b);return f}function Yc(a){if(aa(a)){if(7!==l(a)||r(t(a)))return H}else if(!r(a)){if(z(a)<1||z(a)>17)return M;a=""+a}var b=["1","2","3","4","5","6","7"],c=[0,0,0,0,0,0,0],d;switch(l(a)){case 1:if(n(a,b)>=0){d=t(a),c[(d+4)%7]=1,c[(d+5)%7]=1;break}return M;case 2:if("1"===a[0]&&n(a[1],b)>=0){d=t(a[1]),c[(d+5)%7]=1;break}return M;case 7:for(d=0;d<7;d++)c[d]=t(a[d]);break;default:return H}return c}function Zc(a,b,c,d,e){var f,g=od(b,3);if(O(g))return g;for(f=S(g);c<0;++c)b.setDate(b.getDate()-1),f=0===f?6:--f,(a&&(5===f||6===f)||!a&&e[f]||d.indexOf(i(b))>=0)&&c--;for(;c>0;--c)b.setDate(b.getDate()+1),f=6===f?0:++f,(a&&(5===f||6===f)||!a&&e[f]||d.indexOf(i(b))>=0)&&c++;return i(b)}function $c(a,b,c,d,e,f){var g,h,i,k,m,n,o,p,r;if(f&&(a=a!==q?a:"0000011",h=Yc(a),O(h)))return h;if(b!==q&&(g=W(b,4,!0,!0,!1)),!g)return e;if(g.isError)return g[0];for(i=l(g),k=[],m=0;m<i;m++)n=g[m],o=j(n),p=o.getDay(),r=l(h)?h[od(o,3)]:6===p||0===p,k.indexOf(n)===-1&&!r&&n>=c&&n<=d&&k.push(n);return e-=l(k)}function _c(a,b,c,d,e,f){var g,h,j,k=S(i(b)),l=S(i(c)),m=!1;return k>l&&(g=b,b=c,c=g,h=k,k=l,l=h,m=!0),j=l-k+1,j=f(b,c,j,d),a&&O(j)?j:j<=0?0:(j=$c(d,e,k,l,j,a),j=m?-j:j)}function ad(a,b,c){var d,f;return b=e.Convert.Wh(b),d=new Date(b.getFullYear(),b.getMonth(),1),d.setMonth(d.getMonth()+c),f=fa(d.getFullYear(),d.getMonth()),d.setDate(a?f:y(b.getDate(),f)),d}function bd(a,b,c){a<=1899&&(a+=1900);var d=new Date(a,b-1,c);return d<new Date(1899,11,30)?M:d}function cd(a,b,c){var d=j(0);return d.setHours(a),d.setMinutes(b),d.setSeconds(c),d.setMilliseconds(0),d.getHours()<0&&d.getMinutes()<0&&d.getSeconds()<0?M:d}function dd(a){var b,c,d,e;if(aa(a)&&(b=k(a),b||(b=new Date(a),b&&!r(b.valueOf())||(b=null))),!b)return H;if(d=b.getFullYear(),e=Xc(b),d<1900)return H;for(c=1900;c<d;c++)e+=365,ba(c)&&e++;return e}function ed(a){var b;return aa(a)&&(b=k(a)),b?(60*(60*b.getHours()+b.getMinutes())+b.getSeconds())/86400:H}function fd(){return new Date}function gd(){var a=new Date;return a.setHours(0,0,0,0),a}function hd(a){return a.getHours()}function id(a){return a.getMinutes()}function jd(a){return a.getSeconds()}function kd(a){return a.getDate()}function ld(a){return a.getMonth()+1}function md(a){return a.getFullYear()}function nd(a,b){var c,d,e;return 1===b||17===b||o(b)||2===b||11===b||12===b||13===b||14===b||15===b||16===b?(c=Xc(a),d=new Date(a.getFullYear(),0,1).getDay(),2===b?d-=1:11===b||12===b||13===b||14===b||15===b?d=d-b+10:16===b&&(d+=1),d<0&&(d=7+d),e=c-1-(6-d),e<0&&(e=0),7===d&&16===b?S(e/7)+(e%7!==0?1:0):1+S(e/7)+(e%7!==0?1:0)):21===b?yd(a):M}function od(a,b){var c=a.getDay();switch(b){case 1:return c+1;case 2:return 0===c?7:c;case 3:return 0===c?6:c-1;default:return M}}function pd(a,b){return ad(!1,a,b)}function qd(a,b){return ad(!0,a,b)}function rd(a,b,c){return Zc(!0,a,b,c)}function sd(a,b,c,d){o(c)&&0===b&&(c=1);var e=Yc(c);return O(e)?e:"1111111"===e.join("")?H:Zc(!1,a,b,d,e)}function td(a,b,c){function d(a,b,c){var d=S(i(b)-i(a))%7,e=S(od(a,2)+d),f=0===a.getDay()?1:2;return d=e>5?e-5:0,d=d>f?f:d,c-=d,c-=2*z(c/7)}return _c(!1,a,b,q,c,d)}function ud(a,b,c,d){var e,f,g,h,i,j,k;if(d=d!==q?d:"0000011",e=Yc(d),f=0,g=0,O(e))return e;for(h=0;h<l(e);h++)1===e[h]&&f++;if(c<30){for(h=0;h<c;h++)e[(S(od(a,3))+h)%7]&&g++;return c-=g}for(i=c,j=0,k=0,h=0;h<i&&S(od(a,3)+h)%7!==0;h++)j++;for(h=0;h<j;h++)e[(S(od(a,3))+h)%7]&&g++;for(h=0;h<i&&(S(od(b,3))+7-h)%7!==6;h++)k++;for(h=0;h<k;h++)e[(S(od(b,3))+7-h)%7]&&g++;return i=i-j-k,c-=S(i/7)*f,c-=g}function vd(a,b,c,d){return _c(!0,a,b,c,d,ud)}function wd(a,b,c){var d,f,g;function h(){var a=[];return a[0]=function(a,b){return b.getFullYear()-a.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0)},a[1]=function(a,b){return 12*(b.getFullYear()-a.getFullYear())+(b.getMonth()-a.getMonth())+(b.getDate()<a.getDate()?-1:0)},a[2]=function(a,b){return(b.getTime()-a.getTime())/864e5},a[3]=function(a,b){var c=new Date(b.getFullYear(),b.getMonth()+(b.getDate()<a.getDate()?-1:0),a.getDate());return(b.getTime()-c.getTime())/864e5},a[4]=function(a,b){return b.getMonth()-a.getMonth()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?12:0)+(b.getDate()<a.getDate()?-1:0)},a[5]=function(a,b){var c,d=b.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0),e=a.getMonth(),f=a.getDate(),g=ba(a.getFullYear());return 1!==e||29!==f||ba(d)||f--,!g&&1===e&&28===f&&ba(d)&&f++,c=new Date(d,e,f),(b-c)/864e5},a}if(a.setHours(0,0,0,0),b.setHours(0,0,0,0),e.ExcelCompatibleCalcMode&&(a<ta||b>ua))return M;if(c=c.toLocaleUpperCase(),d=h(),f=n(c,["Y","M","D","MD","YM","YD"]),b<a)return M;if(f<0)throw e.sR().Exp_NotSupported;return(g=d[f])(a,b)}function xd(a,b){var c,d,e={value:0};if(!oa(a,e))return H;if(c={value:0},!oa(b,c))return H;d=2958465;function f(a){return a>=0&&a<d+1}return f(e.value)&&f(c.value)?e.value-c.value:M}function yd(a){var b,c,d;if(isNaN(a))return M;function e(a){var b=new Date(a,0,4),c=b.getDay();return 0===c&&(c=7),b.setDate(b.getDate()+1-c),b}return b=new Date(1900,1,28),a.getTime()<=b.getTime()&&a.setDate(a.getDate()-1),1900===(c=a.getFullYear())?c+=400:9999===c&&(c-=400),a.setYear(c),a.getTime()<new Date(c,11,29).getTime()&&c--,d=e(c+1),a.getTime()<d.getTime()&&(d=e(c)),t(""+(a.getTime()-d.getTime())/864e5/7)+1}function zd(a){var b,c,d,e=""+a,f="",g=[];if(a<0&&(e=e.substr(1),f="-"),c=e.split("."),d=l(c),d<1||d>2)return H;for(2===d&&(g.push(c[1]),g.push(".")),e=c[0],b=l(e)-3;b>=0;b-=3)g.push(e.substr(b,3)),b>0&&g.push(",");return g.push(e.substring(0,b+3)),g.reverse(),f+g.join("")}function Ad(a,b){var c,d,e,f,g=[],h=l(a);for(c=0;c<h;c++){if(e=a[c],f=l(e),0===f&&"concat"===b)return F;for(d=0;d<f;d++)o(e[d])||g.push(U(e[d]))}return g.join("")}function Bd(a,b,c){var d,e,f=[],g=0;for(d=0;d<b.length;d++)if(e=ca(b[d]),"fourByte"===e){if(0===g){g++;continue}g=0,f.push(b[d-1]+b[d])}else f.push(b[d]);return c>=f.length?b:f.splice(a?0:f.length-c,c).join("")}function Cd(a){var b=[],c,d;for(c=0;c<l(a);c++)d=a.charCodeAt(c),0<=d&&d<=31||127===d||128<=d&&d<=159||b.push(a[c]);return b.join("")}function Dd(a){var b,c,d,e,f;for(a=a.trim(),b=[],c=!0,d=0;d<l(a);d++)e=a.charAt(d),f=" "===e||"\t"===e||"\n"===e,f&&!c||b.push(e),c=!f;return b.join("")}function Ed(a,b){function c(a){var b=zd(a),c=[];return a<0&&(b=b.substr(1)),c.push("$"),c.push(b),a<0&&(c.push(")"),c.unshift("(")),c.join("")}return a=T(zb(a,b)),c(a)}function Fd(a,b,c){var d,e,f,g,h,i=0;if(b<0&&(i=S(E(10,v(b))),a/=i),a=T(zb(a,x(0,b))),b<0&&(a*=i),d=c?""+a:zd(a),b>0)if(e=d.indexOf("."),e===-1)for(d+=".",f=0;f<b;f++)d+="0";else for(g=d.length-(e+1),h=g;h<b;h++)d+="0";return d}function Gd(a,b){var c,e;if(""===b)return U(a);o(a)&&(a=0),"string"==typeof a&&(a=a.trim());try{return c=d.Formatter&&d.Formatter.GeneralFormatter,c?(e=new c(b),e.format(a)):""+a}catch(a){return H}}function Hd(a){if(!a)return 0;var b=k(a),c;return o(b)?Id(a):(c=i(b),O(c)?ed(b):c)}function Id(a){var b,c,f,h,i,j,k=d.Common.CultureManager.q4().NumberFormat;if("$"!==a[0]&&a[0]!==k.currencySymbol||(a=a.substring(1)),b=s(a),r(b))return H;for(("."===a[0]||"-"===a[0]&&"."===a[1])&&(a="-"===a[0]?a.replace(a[1],"0."):"0"+a),c=a.length,f=0,i=0,j=0;f<c;f++){for(h=a[f];f<c&&e.isDigit(h.charCodeAt(0));)f++,h=a[f];if(f===c){if(i&&f-i<=3)return H;break}if(h===k.numberGroupSeparator){if(j||i&&f-i<=3)return H;i=f}else if(h===k.numberDecimalSeparator){if(j||i&&f-i<=3)return H;j=f}}return a=g.Gb(a,",",""),s(a)}function Jd(a){return a.toLowerCase()}function Kd(a){return a.toUpperCase()}function Ld(a){var b,c,d,f=l(a),g=[];if(f>0)for(b=a.toUpperCase(),c=a.toLowerCase(),d=1,g[0]=b[0];d<f;)g[d]=e.ei(a[d-1])?c[d]:b[d],d++;return g.join("")}function Md(a){return String.fromCharCode(a)}function Nd(a){return a[0].charCodeAt(0)}function Od(a,b,c,d){var e,f,g=l(a);return b=y(b,g+1),c=y(c||0,g-b+1),e=a.substring(0,b-1),f=a.substr(b-1+c),e.concat(d).concat(f)}function Pd(a,b,c,d){var f,g,h,i,j,k,l,m;if(de()||e.usedbcs){for(f=[],g=void 0,h=0,i=0;i<a.length;i++)g=a[i],j=ca(a[i]),"doubleByte"===j&&(h++,g=a[i]),f[i+h]=g;return k=f.length,b=y(b,k+1),c=y(c||0,k-b+1),o(f[b-1])?(f[b-1]=" ",f[b]=" "):o(f[b-2])&&b>=2&&(f[b-2]=" ",f[b-1]=" "),l=f.slice(0,b-1).join(""),m=f.slice(b-1+c).join(""),l.concat(d).concat(m)}return Od(a,b,c,d)}function Qd(a,b,c,d){var e,f,h,i,j,k,m=l(b);if(l(arguments)>3){if(f=S(d),h=0,i=void 0,f<1)return H;for(i=0;i<f;i++){if(h=a.indexOf(b,h),h===-1)return a;h+=m}j=a.substring(0,h-m),k=a.substr(h),e=j.concat(c).concat(k)}else e=g.yb(a,b,c);return e}function Rd(){return Ad(arguments,"concatenate")}function Sd(){return Ad(arguments,"concat")}function Td(a,b){var c,d,e,f,g,h,i;if(a.isReference&&0===a.length)return F;if(c={value:!1},d=!!o(b[0])||b[0],!pa(d,c))return H;for(d=c.value,e=arguments,f=[],g=[],h=l(e),i=2;i<h;i++)Ud(f,e[i],d);return Ud(g,e[0],!1),Vd(f,g)}function Ud(a,b,c){var d,e=l(b);if(0===e)return F;for(d=0;d<e;d++)o(b[d])||""===b[d]?c||a.push(""):a.push(U(b[d]))}function Vd(a,b){if(0===a.length)return"";if(1===b.length)return a.join(b[0]);for(var c=a[0],d=1,e=0;d<a.length;d++,e++)e===b.length&&(e=0),c+=b[e]+a[d];return c}function Wd(a,b){return Bd(!0,a,b)}function Xd(a,b){return Bd(!1,a,b)}function Yd(a,b,c){var d,f,g,h,i,j,k,l,m;if(de()||e.usedbcs){for(d=[],f=void 0,g=0,h=void 0,i=0,h=0;h<b.length;h++)if(f=b[h],j=ca(b[h]),"fourByte"===j){if(g%2===0){g++;continue}g++,f=b[h-1]+b[h],d[d.length]=f}else"doubleByte"===j&&(i++,f=b[h]),k=g>0?g/2:0,d[h-k+i]=f;return a||(d=ea(d)),l=d.length,c>=l?b:(m=void 0,a?(m=d.slice(0,c-1<0?0:c),m.length>0&&o(m[m.length-1])&&(m[m.length-1]="\u200b")):(m=d.slice(l-c),m.length>0&&o(m[0])&&(m[0]="\u200b")),m.join(""))}return Bd(a,b,c)}function Zd(a,b){return Yd(!0,a,b)}function $d(a,b){return Yd(!1,a,b)}function _d(a,b,c){b--;var d=l(a);return b>=d?"":d<b+c?a.substr(b):a.substr(b,c)}function ae(a,b,c){var d,f,g;return de()||e.usedbcs?(d=da(a),f=d.length,b--,b<0?H:b>=f?"":f<b+c?d.slice(b).join(""):(g=d.slice(b,b+c),"singleByte"!==ca(g[g.length-1])&&(g[g.length-1]="\u200b",o(g[0])&&(g[g.length]="\u200b")),g.join(""))):_d(a,b,c)}function be(a,b){var c=[],d;if(b<0||b*l(a)>32767)return H;for(d=0;d<b;d++)c.push(a);return c.join("")}function ce(a){return a?a.length:0}function de(){var a=d.Common.CultureManager.q4();return!!a.isJCKCulture}function ee(a){var b,c,f,g;if(!a)return 0;if(de()||e.usedbcs){for(b=0,c=0;c<a.length;c++)if(8203!==a[c].charCodeAt(0)&&(f=ca(a[c]),g=d.Common.CultureManager.q4(),"doubleByte"===f&&9390!==a[c].charCodeAt(0))){if("ja-jp"===(g&&g.name().toLocaleLowerCase())&&(711===a[c].charCodeAt(0)||9356===a[c].charCodeAt(0)||8212===a[c].charCodeAt(0)))continue;b++}return a.length+b}return a.length}function fe(a,b,c){if(c<1||l(b)<c)return H;var d=b.indexOf(a,c-1);return d===-1?H:d+1}function ge(a,b,c){var d,f,g,h,i,j;return de()||e.usedbcs?(d=da(b),f=da(a),g=d.length,c<1||g<c?H:(h=ie(d),i=ie(f),j=h.indexOf(i,c-1),j===-1?H:j+1)):fe(a,b,c)}function he(a,b,c){var d=-1,e,g;return e=f.ub(a),e?(g=f.sb(e).exec(b),d=o(g)?-1:g.index):d=b.toLowerCase().indexOf(a.toLowerCase(),--c),d===-1?H:d+1}function ie(a){for(var b=0;b<a.length;b++)o(a[b])&&a[b-1]&&2!==a[b-1].length&&(a[b]="\u200b");return a.join("")}function je(a){for(var b=0;b<a.length;b++)o(a[b])&&(a[b]="\u200b");return a}function ke(a,b,c){var d,f,g,h;return de()||e.usedbcs?(d=da(b),f=da(a),g=d.length,c<1||g<c?H:(h=he(ie(f),ie(d),c),h===H?H:h)):he(a,b,c)}function le(a,b){return a===b}function me(a){return aa(a)?a:""}function ne(a){if(a){var b=a;return b<=0||b>1114111?H:b>=55296&&b<=57343?L:b<1048576?String.fromCharCode(b):(b-=1048576,String.fromCharCode((b>>10)+55296,(1023&b)+56320))}return H}function oe(a){var b,c,d=U(a);return""===d||null===d?H:(b=d.charCodeAt(0))>=55296&&b<=56319?1===d.length?H:(c=void 0,(c=d.charCodeAt(1))>=56320&&c<=57343?b|c<<8:1):b>=56320&&b<=57343?b-53248+53248:b}function pe(a){var b,c;function d(a){var b,c,d,e,f=["\u0e25\u0e49\u0e32\u0e19","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19",""],g=["\u0e28\u0e39\u0e19\u0e22\u0e4c","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],h=["\u0e25\u0e1a","\u0e1a\u0e32\u0e17","\u0e16\u0e49\u0e27\u0e19","\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c","\u0e22\u0e35\u0e48","\u0e40\u0e2d\u0e47\u0e14",","," ","\u0e3f"],i="",j=a+"",k=j.length;
for(b=k;b>0;--b){if(c=t(j[k-b]),d=g[c],e=1<b?(b-1)%6:6,1===e&&2===c&&(d=h[4]),1===c)switch(e){case 0:case 6:i+=b<k?h[5]:d;break;case 1:break;default:i+=d}else{if(0===c){0===e&&(i+=f[e]);continue}i+=d}i+=f[e]}return i}return a?(b=Math.abs(t(a)),c=parseFloat((Math.abs(a)-b).toFixed(2)),0!==b?0===c?(a<0?"\u0e25\u0e1a":"")+d(b)+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":(a<0?"\u0e25\u0e1a":"")+d(b)+"\u0e1a\u0e32\u0e17"+d(100*c)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":0!==c?(a<0?"\u0e25\u0e1a":"")+d(100*c)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":"\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19"):H}function qe(a){return O(a)}function re(a){return!!O(a)&&a._code!==L._code}function se(a){return!!O(a)&&a._code===L._code}function te(a){if(!o(a)&&O(a)){var b=n(a._code,[F._code,G._code,H._code,I._code,J._code,M._code,L._code]);if(b>=0)return b+1}return L}function ue(a){return V(a,e.ExcelCompatibleCalcMode)}function ve(a){return ma(v(a))%2===0}function we(a){return ma(v(a))%2!==0}function xe(a){return $(a)||_(a)?T(a):Z(a)?a?1:0:O(a)?a:0}function ye(a){return o(a)}function ze(a){return Z(a)}function Ae(a){return aa(a)}function Be(a){return!aa(a)}function Ce(a){return P(a)}function De(a){return Z(a)?4:$(a)||_(a)?1:aa(a)?2:O(a)?16:Q(a)?64:e.isLambdaFunction(a)?128:H}function Ee(){return L}function Fe(a,b){var c,d,f=0,g=a.source.kj;if(Q(b))return L;if(b instanceof e.CalcReference||o(b))return c=b,d=c&&(c.xf||c.references[0].xf)||a.source,g.parent.getSheetIndex(d.kj.name())+1;if(V(b)||aa(b))for(f;f<g.parent.sheets.length;f++)if(b.toUpperCase()===g.parent.sheets[f].name().toUpperCase())return f+1;return L}function Ge(a,b){var c,d,f,g=a.source.kj;return o(b)?g.parent.sheets.length:Q(b)||V(b)?L:aa(b)?H:b instanceof e.CalcReference?(c=b,(d=c.references)?d.length:(f=c.xf||a.source,g.parent.getSheetIndex(f.kj.name())+1)):L}function He(){var a=new e.Functions.AsyncFunction("REFRESH",1,3);a.evaluate=Ie,e.Functions.bi.REFRESH=a}function Ie(a,b){return b}function Je(a){return a>=55296&&a<=57343}function Ke(a,b){return!(a<55296||a>56319)&&(b>=56320&&b<=57343)}function Le(b){var c,d,e,f,g,h,i="object"==typeof a&&a&&a.Object===Object&&a,j="object"==typeof self&&self&&self.Object===Object&&self,k=i||j||Function("return this")();if(k&&k.encodeURIComponent)return encodeURIComponent(b).replace(/[!~'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()});if(c="",d=void 0,(d=b.length-1)<0)return"";for(e=0;e<=d;e++)if(f=b.charCodeAt(e),f>="A".charCodeAt(0)&&f<="Z".charCodeAt(0)||f>="0".charCodeAt(0)&&f<="9".charCodeAt(0)||f>="a".charCodeAt(0)&&f<="z".charCodeAt(0)||f==="-".charCodeAt(0)||f==="_".charCodeAt(0)||f===".".charCodeAt(0))c+=b[e];else{if(g=void 0,Je(f)){if(d===e||!Ke(f,b.charCodeAt(e+1)))return null;g=[f,b.charCodeAt(e+1)],e++}else g=[f];for(h=0;h<g.length;h++)c+="%",c+=g[h].toString(16).toUpperCase()}return c}function Me(a,b,c){void 0===c&&(c=!0);var d;return a!==p||c?O(a)?L:d=Q(a)?W(a,b,!0,!0,!1):W(a,b,!0,!0,!0):H}function Ne(a){var b,c,d,e,f,g,h,i,j,k,l,m=[];for(b=1;b<arguments.length;b++)m[b-1]=arguments[b];if(c=m[0],d=m[1],e=[],f=[],g=d&&d.getSource()&&d.getSource().getSheet()||a.source&&a.source.kj,h=g&&g.pivotTables&&d&&g.pivotTables.findPivotTable(d.getRow(),d.getColumn()),o(h))return I;for(i=2;i<m.length;i+=2)j=m[i],k=m[i+1],P(j)&&(j=j.getValueByIndex(0)),l={fieldName:j,itemName:k},P(k)||Q(k)?f.push(l):e.push(l);return P(c)&&(c=c.getValueByIndex(0)),f.length>0?Oe(c,h,e,f):h.evaluateGetPivotDataFunction(c,e)}function Oe(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=1,z=1,A=[],B=[],C=[];for(f=0,g=d;f<g.length;f++){if(h=g[f],i=h.fieldName,j=h.itemName,O(j))return j;if((P(j)||Q(j))&&(h.itemName=W(j,0,!1,!1,!1),h.itemName.isError))return h.itemName[0];k=b.getField(i),l=k.pivotArea,m=h.itemName.rowCount,n=h.itemName.colCount,y=y>m?y:m,z=z>n?z:n,m>n||m===n&&1===l?A.push(h):(n>m||m===n&&2===l)&&B.push(h)}for(o=0;o<y;o++){for(p=[],q=0;q<z;q++){for(r=[],s=0,t=A;s<t.length;s++)u=t[s],u.itemName.colCount>1?r.push({fieldName:u.fieldName,itemName:u.itemName[o]&&u.itemName[o][q]}):r.push({fieldName:u.fieldName,itemName:u.itemName[o]&&u.itemName[o][0]});for(v=0,w=B;v<w.length;v++)x=w[v],x.itemName.rowCount>1?r.push({fieldName:x.fieldName,itemName:x.itemName[o]&&x.itemName[o][q]}):r.push({fieldName:x.fieldName,itemName:x.itemName[0]&&x.itemName[0][q]});p.push(b.evaluateGetPivotDataFunction(a,c.concat(r)))}C.push(p)}return new e.CalcArray(C)}function Pe(){var a,b,c,d,f,g,h,i,j,k,m,n,p,q,r,s,t,u=arguments,v=l(u);if(v<2||v%2!==0)return L;for(b=0;b<v;b+=2){if(f=u[b],g=u[b+1],h=Me(f,2),i=Me(g,0),O(h))return h;if(O(i))return i;if(h.isError||i.isError)return L;if(j=h.length,k=i.length,o(d))d=k;else if(d!==k)return L;if(j>k)return L;if(j<k){if(c===!1||j>1)return L;for(o(a)&&(a=[]),m=i.rowCount,n=i.colCount,p=h[0],q=0;q<m;q++){for(r=a[q],o(r)&&(r=a[q]=[]),s=0;s<n;s++)o(r[s])&&(r[s]={}),r[s][p]=i[s+q*n];a[q]=r}c=!0}else{if(c===!0)return L;for(o(a)&&(a={}),t=0;t<k;t++)a[h[t]]=i[t];c=!1}}return c?new e.CalcArray(a):a}function Qe(){var a,b=arguments,c=b[0],d=b[1],e=d.split("."),f=e.length,g=c;if(o(c)||"object"!=typeof c)return L;for(a=0;a<f;a++)if(g=g[e[a]],o(g))return L;return g}function Re(a){var b,c,d,f,g;try{if(b=JSON.parse(a),Array.isArray(b)&&b.length>0){for(c=!0,d=0;d<b.length;d++)if(!Array.isArray(b[d])){c=!1;break}if(c)b=new e.CalcArray(b);else{for(f=[],g=0;g<b.length;g++)f.push([b[g]]);b=new e.CalcArray(f)}}return b}catch(a){return H}}function Se(a){return Ue(a,"AaK9#@BXHN\uff27S")}function Te(a){return Ue(a,"\uff21\uff41\uff2b\uff19\uff03\uff20\uff22\uff38\uff3a\uff2e\uff33")}function Ue(a,b){var c,d,f,g="";if(a&&(c=typeof a),"number"===c||"boolean"===c)g=a+"";else if(a instanceof Date)g=""+h.Ra(a);else{if("object"===c)return H;"string"===c&&(g=a)}return d=new e.n$c((!0),b),f=d.checkText(g),f.CheckedText}function Ve(){var a=new e.Functions.AsyncFunction("WEBSERVICE",1,1);a.defaultValue=function(){return""},a.evaluate=We,e.Functions.bi.WEBSERVICE=a}function We(a,b){var c,d,e,f=b;if(!f||f.length>ra)return H;if(c=null,XMLHttpRequest&&(c=new XMLHttpRequest),d=function(b){a.setAsyncResult(b)},e=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===c)return H;try{c.open("GET",f,!0),c.onreadystatechange=function(){var a,b,f;4===c.readyState&&(200===c.status?(a=c.response,b=a&&a.type,!b||b.indexOf("text")===-1&&e.indexOf(b)===-1?d(H):(f=new FileReader,f.onloadend=function(){d(f.result)},f.onerror=function(){d(H)},f.readAsText(a))):d(H))},c.onerror=function(){d(H)},c.timeout=sa,c.ontimeout=function(){d(H)},c.responseType="blob",c.send(null)}catch(a){return H}}va={Hi:0},wa={Hi:0,aj:"= 0",bj:G},xa={Hi:0,aj:"= 0",bj:0},ya={_i:1,Hi:0,aj:"= 0",bj:0},za={Hi:2,aj:"< 0"},Aa={Hi:0,aj:["> 134217728","< -134217728"]},Ba={Hi:1},Ca={Hi:2},Da={_i:1,Hi:2},Ea={_i:1,Hi:2,aj:"< 0",bj:H},Fa={Hi:5},Ga={Hi:6},Ha={Hi:2,aj:"< 0",bj:H},Ia={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},Ja={Hi:4,Ii:1,Ki:!0,Li:!0},Ka={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},La={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},Ma={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},Na=[0,"%= 1 && >= 3"];function Xe(a,b){if(!a||8!==a.type)throw e.sR().Exp_FormulaInvalid;if(b.indexOf(a.value)!==-1)throw e.sR().Exp_FormulaInvalid;if(a.value.indexOf(".")>-1)throw e.sR().Exp_FormulaInvalid}na("ABS",Va,1,1,va),na("ACOS",cc,1,1,{Hi:0,aj:["> 1","< -1"]}),na("ACOT",kc,1,1,va),na("ASIN",bc,1,1,{Hi:0,aj:["> 1","< -1"]}),na("ATAN",jc,1,1,va),na("ATAN2",lc,2,2,[va,va]),na("COS",Zb,1,1,va),na("SEC",$b,1,1,Aa),na("CEILING",tb,2,2,[xa,xa]),na("ODD",_a,1,1,Ba),na("EVEN",ab,1,1,Ba),na("FLOOR",ub,2,2,[xa,xa]),na("LN",db,1,1,{Hi:1,aj:"<= 0"}),na("SQRT",nb,1,1,{Hi:0,aj:"< 0"}),na("SIN",Xb,1,1,va),na("CSC",Yb,1,1,Aa),na("TAN",_b,1,1,va),na("COT",ac,1,1,Aa),na("SIGN",jb,1,1,{Hi:1,aj:"> 0",bj:1}),na("GCD",kb,1,q,Ka,-1,-1),na("LCM",lb,1,q,Ka,-1,-1),na("PRODUCT",mb,1,q,q,-1,-1),na("POWER",gb,2,2,[va,va]),na("MOD",eb,2,2,[va,{Hi:0,aj:"= 0",bj:G}]),na("QUOTIENT",ob,2,2,[va,wa],q,q),na("SUBTOTAL",pb,2,q,Ca,"!= 0"),na("_SUBTOTALFORSTATUSBAR",qb,2,5e3,Ca,"!= 0"),na("INT",Wa,1,1,q,[0],q,{dk:!0}),na("MROUND",yb,2,2,[xa,xa]),na("ROUND",zb,2,2,[va,Ca]),na("ROUNDDOWN",Ab,2,2,[va,Ca]),na("ROUNDUP",Bb,2,2,[va,Ca]),na("TRUNC",Ab,1,2,[va,{_i:0,Hi:2}],q,q,{bk:1}),na("EXP",Cb,1,1,va),na("LOG",Fb,1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],q,q,{bk:1}),na("LOG10",Gb,1,1,{Hi:0,aj:"<= 0"}),na("SUM",ib,1,q,q,-1,-1),na("SUMIF",Hb,2,3,q,[0,2],q,{bk:2,KMc:[2],l7c:!0,fk:4,gk:1,dk:!0}),na("SUMIFS",Jb,3,q,q,[0,"%= 1"],q,{KMc:Na,l7c:!0,fk:4,dk:!0}),na("SUMPRODUCT",Pb,1,q,q,-1,-1,{fk:1}),na("SUMSQ",Qb,1,q,Ka,-1,-1),na("SUMX2MY2",Rb,2,2,Ka,-1,-1),na("SUMX2PY2",Sb,2,2,Ka,-1,-1),na("SUMXMY2",Tb,2,2,Ka,-1,-1),na("SERIESSUM",Ub,4,4,[va,Ca,Ca,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),na("PI",fb,0,0),na("SQRTPI",Vb,1,1,{Hi:0,aj:"< 0"}),na("DEGREES",$a,1,1,Ba),na("RADIANS",Wb,1,1,va),na("COSH",fc,1,1,va),na("SECH",gc,1,1,va),na("ACOSH",ic,1,1,{Hi:0,aj:"< 1"}),na("SINH",dc,1,1,va),na("CSCH",ec,1,1,va),na("ASINH",hc,1,1,va),na("TANH",mc,1,1,va),na("COTH",nc,1,1,{Hi:0}),na("ATANH",oc,1,1,{Hi:0,aj:["<= -1",">= 1"]}),na("ACOTH",pc,1,1,{Hi:0}),na("MDETERM",qc,1,1,Ja,-1,-1),na("MINVERSE",rc,1,1,Ja,-1,-1),na("MMULT",sc,2,2,[Ja,Ja],-1,-1),na("FACT",bb,1,1,{Hi:3,aj:["< 0","> 170"]}),na("FACTDOUBLE",cb,1,1,{Hi:3,aj:["< 0","> 300"]}),na("MULTINOMIAL",tc,1,q,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),na("RAND",uc,0,0,q,q,q,{ck:!0}),na("RANDBETWEEN",vc,2,2,[Ca,Ca],q,q,{ck:!0}),na("COMBIN",Xa,2,2,[za,za]),na("COMBINA",Ya,2,2,[za,za]),na("DECIMAL",Za,2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),na("CEILING.MATH",vb,1,3,[va,{Hi:0,_i:1},{Hi:0,_i:0}]),na("FLOOR.MATH",wb,1,3,[va,{Hi:0,_i:1},{Hi:0,_i:0}]),na("BASE",xb,2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),na("ROMAN",wc,1,2,[{Hi:2,aj:["< 0","> 3999"],bj:H},{_i:0}],q,q,{bk:1}),na("ARABIC",xc,1,1,Fa),na("CEILING.PRECISE",Db,1,2,[xa,ya]),na("ISO.CEILING",Db,1,2,[xa,ya]),na("FLOOR.PRECISE",Eb,1,2,[xa,ya]),na("MAXIFS",Kb,3,q,q,[0,"%= 1"],[0,"%= 1"],{KMc:Na,l7c:!0,dk:!0}),na("MINIFS",Lb,3,q,q,[0,"%= 1"],[0,"%= 1"],{KMc:Na,l7c:!0,dk:!0}),na("AVERAGEIFS",Nb,3,q,q,[0,"%= 1"],[0,"%= 1"],{KMc:Na,l7c:!0,dk:!0}),na("COUNTIFS",Mb,2,q,q,"%= 0","%= 0",{KMc:["%= 0 && >= 2"],l7c:!0,dk:!0}),na("MUNIT",Ob,1,1,{Hi:2,aj:"<= 0",bj:H}),na("SEQUENCE",yc,1,4,[Ca,Ca,va,va],q,q,{bk:[0,1,2,3]},!0),na("RANDARRAY",zc,0,5,[Ca,Ca,va,va],q,q,{ck:!0,bk:[0,1,2,3,4]},!0),na("AGGREGATE",sb,3,q,q,"> 1","> 1",{fk:1,dk:!0}),na("AND",Bc,1,q,Ma,-1,-1),na("OR",Cc,1,q,Ma,-1,-1),na("NOT",Dc,1,1),na("IF",Ec,2,3,q,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(a){if(e.Convert.vf(a))return-1;var b={value:!1};return R(a,b),b.value?1:2}}),na("IFERROR",Gc,2,2,q,q,q,{gk:-1}),na("TRUE",Hc,0,0),na("FALSE",Ic,0,0),na("IFNA",Jc,2,2,q,q,q,{gk:-1}),na("IFS",Kc,2,254,q,0,q,{gk:-1}),na("SWITCH",Lc,3,253,q,q,q,{gk:-1}),na("XOR",Mc,1,q,La,-1,-1),na("LET",q,3,253,q,q,q,{argsValidator:function(a,b,c,d){var f,g;if(c%2===0)throw e.sR().Exp_FormulaInvalid;for(f=[],g=0;g<d.length-1;g+=2)Xe(d[g],f),f.push(d[g].value)}}),na("LAMBDA",q,1,253,q,q,q,{argsValidator:function(a,b,c,d){var e,f=[];for(e=0;e<d.length-1;e++)Xe(d[e],f),f.push(d[e].value)}}),na("MAP",Rc,2,q,q,-1,-1,{isContextSensitive:!0},!0),na("REDUCE",Sc,3,3,q,-1,-1,{isContextSensitive:!0},!0),na("SCAN",Tc,3,3,q,-1,-1,{isContextSensitive:!0},!0),na("BYROW",Vc,1,2,q,-1,-1,{isContextSensitive:!0},!0),na("BYCOL",Wc,1,2,q,-1,-1,{isContextSensitive:!0},!0),na("MAKEARRAY",Uc,3,3,[za,za],q,q,{isContextSensitive:!0},!0),na("DATE",bd,3,3,[{Hi:2,aj:["< 0","> 9999"]},Ca,Ca]),na("TIME",cd,3,3,[Ca,Ca,Ca]),na("DATEVALUE",dd,1,1,{Ni:!0}),na("TIMEVALUE",ed,1,1,{Ni:!0}),na("NOW",fd,0,0,q,q,q,{ck:!0}),na("TODAY",gd,0,0,q,q,q,{ck:!0}),na("HOUR",hd,1,1,Ga),na("MINUTE",id,1,1,Ga),na("SECOND",jd,1,1,Ga),na("DAY",kd,1,1,Ga),na("MONTH",ld,1,1,Ga),na("YEAR",md,1,1,Ga),na("WEEKNUM",nd,1,2,[Ga,Da],q,q,{bk:1}),na("WEEKDAY",od,1,2,[Ga,Da],q,q,{bk:1}),na("EDATE",pd,2,2,[Ga,Ca]),na("EOMONTH",qd,2,2,[Ga,Ca]),na("WORKDAY",rd,2,3,[Ga,Ca,Ia],2,2,{bk:2}),na("WORKDAY.INTL",sd,2,4,[Ga,Ca,{_i:"0000011"},Ia],[3],[2,3],{bk:[2,3]}),na("DAYS360",e.Functions.uk,2,3,[Ga,Ga,{_i:!1,Hi:7}],q,q,{bk:2}),na("NETWORKDAYS",td,2,3,[Ga,Ga],2,2,{bk:2}),na("NETWORKDAYS.INTL",vd,2,4,[Ga,Ga],[2,3],[2,3],{bk:[2,3]}),na("YEARFRAC",e.Functions.vk,2,3,[Ga,Ga,{_i:0,Hi:2}],q,q,{bk:2}),na("DATEDIF",wd,3,3,[Ga,Ga,Fa]),na("DAYS",xd,2,2),na("ISOWEEKNUM",yd,1,1,Ga),na("CLEAN",Cd,1,1,Fa),na("TRIM",Dd,1,1,Fa),na("DOLLAR",Ed,1,2,[va,{_i:2,Hi:2,aj:"> 99",bj:H}],q,q,{bk:1}),na("FIXED",Fd,1,3,[va,{_i:2,Hi:2},{_i:!1,Hi:7}],q,q,{bk:[1,2]}),na("TEXT",Gd,2,2,[{},Fa]),na("VALUE",Hd,1,1,Fa),na("LOWER",Jd,1,1,Fa),na("UPPER",Kd,1,1,Fa),na("PROPER",Ld,1,1,Fa),na("CHAR",Md,1,1,{Hi:2,aj:["> 255","< 1"],bj:H}),na("CODE",Nd,1,1,{Hi:5,Ni:!0}),na("REPLACE",Od,4,4,[Fa,{Hi:2,aj:"< 1",bj:H},Ha,Fa],q,q,{bk:2}),na("SUBSTITUTE",Qd,3,4,[Fa,{Hi:5,Ni:!0},Fa],q,q,{bk:3}),na("CONCATENATE",Rd,1,q,{Hi:4,Ii:0,Ji:!0,Xi:!0},q,-1),na("LEFT",Wd,1,2,[Fa,Ea],q,q,{bk:1}),na("MID",_d,3,3,[Fa,{Hi:2,aj:"<= 0",bj:H},Ha]),na("RIGHT",Xd,1,2,[Fa,Ea],q,q,{bk:1}),na("REPT",be,2,2,[Fa,Ca]),na("LEN",ce,1,1,Fa),na("FIND",fe,2,3,[Fa,Fa,Da],q,q,{bk:2}),na("SEARCH",he,2,3,[Fa,Fa,Ea],q,q,{bk:2}),na("EXACT",le,2,2,[Fa,Fa]),na("T",me,1,1),na("UNICHAR",ne,1,1,[{Hi:2,bj:H}]),na("UNICODE",oe,1,1),na("BAHTTEXT",pe,1,1,[{Hi:0,bj:H}]),na("CONCAT",Sd,1,q,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),na("TEXTJOIN",Td,3,q,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),na("FINDB",ge,2,3,[Fa,Fa,Da],q,q,{bk:2}),na("LEFTB",Zd,1,2,[Fa,Ea],q,q,{bk:1}),na("RIGHTB",$d,1,2,[Fa,Ea],q,q,{bk:1}),na("MIDB",ae,3,3,[Fa,Ha,Ha]),na("LENB",ee,1,1,Fa),na("REPLACEB",Pd,4,4,[Fa,{Hi:2,aj:"< 1",bj:H},Ha,Fa],q,q,{bk:2}),na("SEARCHB",ke,2,3,[Fa,Fa,Ea],q,q,{bk:2}),na("ENCODEURL",Le,0,1,Fa),na("ISERROR",qe,1,1,q,q,q,{gk:-1}),na("ISERR",re,1,1,q,q,q,{gk:-1}),na("ISNA",se,1,1,q,q,q,{gk:-1}),na("ERROR.TYPE",te,1,1,q,q,q,{gk:-1}),na("ISNUMBER",ue,1,1,q,q,q,{gk:-1}),na("ISEVEN",ve,1,1,va,q,q),na("ISODD",we,1,1,va,q,q),na("N",xe,1,1,q,q,q),na("ISBLANK",ye,1,1,q,q,q,{gk:-1}),na("ISLOGICAL",ze,1,1,q,q,q,{gk:-1}),na("ISTEXT",Ae,1,1,q,q,q,{gk:-1}),na("ISNONTEXT",Be,1,1,q,q,q,{gk:-1}),na("ISREF",Ce,1,1,q,-1,q,{gk:-1}),na("TYPE",De,1,1,q,q,-1,{gk:-1}),na("NA",Ee,0,0),na("SHEET",Fe,0,1,q,-1,q,{dk:!0}),na("SHEETS",Ge,0,1,q,-1,q,{dk:!0}),na("GETPIVOTDATA",Ne,2,253,q,-1,-1,{dk:!0}),na("OBJECT",Pe,2,q,q,-1,-1),na("PROPERTY",Qe,2,2,q),na("FILTERJSON",Re,1,1,q),na("ASC",Se,1,1),na("DBCS",Te,1,1),na("ISOMITTED",q,1,1,q,-1,-1),Ve(),He()}).call(this,c("./node_modules/webpack/buildin/global.js"))},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),a.exports=d.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"@grapecity/js-calc":function(a,b){a.exports=GC.Spread.CalcEngine},"@grapecity/js-sheets-common":function(a,b){a.exports=GC.Spread}});;/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=GC.Spread.CalcEngine||{},GC.Spread.CalcEngine.AdvancedFunctions=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js")}({"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=d.Spread.CalcEngine||{},d.Spread.CalcEngine.AdvancedFunctions=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/advancedFunctions.entry.ts")}({"./src/advancedFunctions.entry.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("CalcEngine");b.Functions=d.Functions,c("./src/functions-db.ts"),c("./src/functions-eng.ts"),c("./src/functions-fin.ts"),c("./src/functions-lookup.ts"),c("./src/functions-stat.ts")},"./src/functions-db.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.q,g=null,h=e.Convert.Pa,i=e.Convert.Na,j=e.Convert.vf,k=e.Convert.Nh,l=e.Errors.DivideByZero,m=e.Errors.Value,n=e.Functions.ak,o=e.Functions.jk,p=isNaN,q=d.Common.u,r=q.kb,s=e.sR().Exp_InvalidCast,t=function(){function a(a,b,c){this.Gk=a,this.Hk=b,this.Wob=c}return a.prototype.Ik=function(a){var b={"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14},c=e.evaluateOperator(b[this.Gk],a,this.Hk);return!!e.Functions.ik(c)&&e.Convert.Vh(c)},a}();function z(a,b){return[a,b].join(",")}u=function(){function a(a,b,c){var d=this;if(d.cj=0,d.Jk=a,d.Kk=c,d.Xob={},3===arguments.length){if(d.Lk=d.Mk(a,b),a.rowCount<2||a.colCount<1||c.rowCount<2||c.colCount<1||d.Lk<0||d.Jk.colCount<=d.Lk)throw s}else if(2===arguments.length&&(d.Lk=-1,a.rowCount<2||a.colCount<1||c.rowCount<2||c.colCount<1))throw s}return a.prototype.Mk=function(a,b){var c,d;if(o(b)){for(c=0;c<a.colCount;c++)if(d=e.Convert.bc(a[0][c]),d&&this.Nk(d,b))return c;return-1}return e.Convert.Rh(b)-1},a.prototype.Ok=function(){var a=this;if(a.cj<=0||a.Jk.rowCount<=a.cj)throw e.sR().Exp_InvalidOperation;return a.Jk[a.cj][a.Lk]},a.prototype.Pk=function(){for(var a=this,b=!1,c=a.Jk.rowCount;!b&&a.cj<c;)a.cj++,a.cj<c&&(b=a.Qk());return b},a.prototype.Rk=function(a){var b,c,f,h,i;if(o(a)){for(b=["=","<>","<=",">=","<",">"],c=e.Convert.bc(a),f=void 0,h=void 0,f=0;f<b.length;f++)if(d.Common.u.kb(c,b[f]))return c=c.substring(b[f].length),i=d.Common.o.lb(c),p(i)?this.Nk("true",c)?a=!0:this.Nk("false",c)?a=!1:(a=c,h=0===f):a=i,new t(b[f],a,h);return new t("=",a)}return a?new t("=",a):g},a.prototype.Yob=function(a,b){var c,d=this,e=d.Xob,f=z(a,b),g=e[f];return g||(c="_"+f,e[c]||(g=e[f]=d.Rk(d.Kk[a][b]),e[c]=!0)),g},a.prototype.Qk=function(){var a,b,c,d,e,g,h,i,j,k=this,l=!1,m=k.Kk,n=k.cj,p=m.rowCount,q=m.colCount,s=k.Jk,t=k.Zob;if(!t){for(d=m[0],t=[],b=0;b<q;b++){if(c=k.Mk(s,d[b]),c<0)return!1;t[b]=c}k.Zob=t}for(a=1;!l&&a<p;a++)for(l=!0,b=0;l&&b<q;b++)if(e=k.Yob(a,b)){if(g=s[n][t[b]],"="===e.Gk&&(h=e.Hk,o(h)&&o(g))){i=f.ub(h,!0),j=e.Wob,l=i?f.sb("^"+i+(j?"$":"")).test(g):j?g.toLowerCase()===h.toLowerCase():r(g,h,!0);continue}l=e.Ik(g)}return l},a.prototype.Nk=function(a,b){return a.toLowerCase()===b.toLowerCase()},a}();function A(a,b,c,d){for(var e,f=0,g=new u(a,b,c);g.Pk();)e=g.Ok(),e=d?i(e):e,e&&f++;return k(f)}function B(a,b,c,d,e,f,g){for(var n,o,q,r,s=g?1:0,t=0,v=0,w=new u(a,b,c);w.Pk();)if(n=w.Ok(),i(n)){if(o=h(n),p(o))return m;s=g?s*o:s+o,t+=o*o,v++}else if(j(n))return n;return f||g?k(s):(q=Math.max(0,(v*t-s*s)/(v*(v-e))),r=d?Math.sqrt(q):q,v<=1?l:k(r))}function C(a,b,c){for(var d,f,g=0,h=0,n=new u(a,b,c);n.Pk();){if(d=n.Ok(),j(d))return d;if(i(d)){if(f={value:0},!e.Convert.Th(d,f))return m;g+=f.value,h++}}return 0===h?l:k(g/h)}function D(a,b,c){return A(a,b,c,!0)}function E(a,b,c){return A(a,b,c,!1)}function F(a,b,c){var d,f=new u(a,b,c);return f.Pk()?(d=f.Ok(),f.Pk()?e.Errors.Number:d):m}function G(a,b,c){for(var d,f,g=!1,l=-e.Functions.hk,n=new u(a,b,c);n.Pk();){if(d=n.Ok(),j(d))return d;if(i(d)){if(f=h(d),p(f))return m;(!g||f>l)&&(l=f),g=!0}}return g?k(l):0}function H(a,b,c){for(var d,f,g=!1,l=e.Functions.hk,n=new u(a,b,c);n.Pk();){if(d=n.Ok(),j(d))return d;if(i(d)){if(f=h(d),p(f))return m;(!g||d<l)&&(l=d),g=!0}}return g?k(l):0}function I(a,b,c){return B(a,b,c,!1,0,!1,!0)}function J(a,b,c){return B(a,b,c,!0,1)}function K(a,b,c){return B(a,b,c,!0,0)}function L(a,b,c){return B(a,b,c,!1,0,!0)}function M(a,b,c){return B(a,b,c,!1,1)}function N(a,b,c){return B(a,b,c,!1,0)}v="!= 1",w={Yi:!0,Hi:4,Ii:0},x={Yi:!0},y=[w,x,w],n("DAVERAGE",C,3,3,y,v,v),n("DCOUNT",D,3,3,y,v,v),n("DCOUNTA",E,3,3,y,v,v),n("DGET",F,3,3,y,v,v),n("DMAX",G,3,3,y,v,v),n("DMIN",H,3,3,y,v,v),n("DPRODUCT",I,3,3,y,v,v),n("DSTDEV",J,3,3,y,v,v),n("DSTDEVP",K,3,3,y,v,v),n("DSUM",L,3,3,y,v,v),n("DVAR",M,3,3,y,v,v),n("DVARP",N,3,3,y,v,v)},"./src/functions-eng.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.k.ac,g=void 0,h=Math.abs,i=Math.sin,j=Math.cos,k=Math.sqrt,l=Math.log,m=Math.pow,n=Math.exp,o=Math.E,p=Math.atan2,q=parseFloat,r=isNaN,s=e.Errors.NotAvailable,t=e.Errors.Number,u=e.Errors.Value,v=e.Functions.ak,w=e.Functions.qk,x=e.Convert.Nh,y=e.Convert.vf,z=e.Functions.MathHelper,A=z.Dk,B=e.Functions.Wi,C=0xffffffffffff,D=e.Convert.Th;function eb(a,b){return new e.Functions.Ui(a,b)}E=eb(1,0);function fb(a,b){return{Ld:a,_c:b}}function gb(a,b){var c=[],d;for(d=0;d<f(a);d++)c.push(fb(a[d],b[d]));return c.push(fb(null,0)),c}F=.00220462262184878,G=7e3*F,H=F/100,I=F/112,J=F/14,K=F/2240,L=gb(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,F,6.02214179421676e23,.0352739619495804,G,H,H,I,I,I,J,110231131092439e-20,K,K,K]),M=1e4/254,N=M/12,O=N/3,P=O/1760,Q=M/45,R=6*M,S=.00062136994949495,T=1.05700083402462e-16,U=3.24077928966473e-17,V=gb(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,P,1/1852,M,N,O,1e10,2834.64566929134,Q,T,U,R,S,U,2834.64566929134]),W=365.25,X=24*W,Y=60*X,Z=60*Y,$=gb(["yr","day","hr","mn","sec","d","min","s"],[1,W,X,Y,Z,W,Y,Z]),_=.007500637554192,aa=gb(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,_,1,986923266716013e-20,.000145037737730209,.0075006168270417]),ba=1e5,ca=gb(["N","dyn","lbf","dy","pond"],[1,ba,.22480894309971,ba,101.971621297793]),da=745.69987158227,ea=gb(["HP","W","h","w","PS"],[1,da,1,da,1.013869665424]),fa=624150964712042e4,ga=1/(3600*da),ha=1/3600,ia=.000947817120313317,ja=.239005736137667,ka=gb(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,ja,ja,fa,ga,ha,.737562149277265,ia,fa,ga,ha,ia]),la=gb(["T","ga"],[1,1e4]),ma=.00492892159375,na=1e27*ma,oa=.000139870932189991,pa=.00017406322338,qa=.30078125,ra=8.2073596535e-44,sa=492892159375e-17,ta=1.18251117638e-15,ua=64467860511e-16,va=7.75941468987e-16,wa=112266,xa=1740632233796e-18,ya=4351580584491e-18,za=gb(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,ma,.00867368942321863,1/96,ma,na,na,1/32256,oa,pa,pa,qa,qa,ra,ra,sa,sa,ta,ta,ua,ua,va,va,wa,wa,wa,wa,xa,xa,ya,ma]),Aa=gb(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),Ba=10.7639104167097,Ca=144*Ba,Da=Ba/9,Ea=.000247105381467165,Fa=.000247104393046628,Ga=Da/3097600,Ha=2.91553349598123e-7,Ia=8035216.07043214,Ja=1.11725076312873e-32,Ka=gb(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,Ba,Ba,Ca,Ca,Da,Da,Ea,Fa,1e20,1e20,.01,1e-4,4e-4,Ga,Ga,Ha,Ha,Ia,Ia,Ia,Ia,Ja,Ja]),La=gb(["bit","byte"],[1,.125]),Ma={bit:"bit",byte:"byte"},Na={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},Oa={day:"day",d:"d",yr:"yr",hr:"hr",mn:"mn",min:"min",sec:"sec",s:"s"},Pa=273.15,Qa=459.67,Ra=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],Sa=gb(Ra,[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Ta=gb(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Ua=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"];function hb(a,b,c){var d,f,g,h,i,j,k,l=100,n=.5*a,o=n*n;for(n=m(n,q(b)),d=e.Functions.tk(b),f=1,g=0,h=q(b),i=n/d,j=.9*i,k=!1;i!==j&&0!==l;)n*=o,d*=++g,f*=++h,j=i,i=c||k?i+n/d/f:i-n/d/f,l--,k=!k;return i}function ib(a,b){var c=m(b,10),d=parseInt(a,b);return r(d)?t:c/2<=d?d-c:d}function jb(a,b,c){a<0&&(a+=m(b,10));var d=a.toString(b),e=c-f(d),g;for(g=0;g<e;g++)d="0"+d;return d.toUpperCase()}function kb(a,b){if(a<0)return t;var c=ib(a,b);return y(c)?t:c}function lb(a,b,c){var d=jb(a,c,b.Qb);return 0<=d&&b.Qb<f(d)&&b.$i?t:d}function mb(a,b,c,d,e){var g,h;return a<0?t:(g=ib(a,c),y(g)?t:e&&(g<-e||e-1<g)?t:(h=jb(g,d,b.Qb),0<=g&&b.Qb<f(h)&&b.$i?t:h))}function nb(a,b){var c=Number.POSITIVE_INFINITY,d=a.Pi(),e=a.Qi();return r(d)||d===c||r(e)||e===c?t:a.bc(b)}function ob(a,b,c,d){var e=a,f=b,g=c.Pi(),h=c.Qi();return a=d?e*g-f*h:e+g,b=d?e*h+f*g:f+h,{Ri:a,Si:b}}function pb(a,b){var c,d,g,h,i,j,k,l,m=b?1:0,n=0;for(d=0;d<f(a);d++)if(e.Convert.Ca(a[d]))for(k=a[d],g=0;g<k.rowCount;g++)for(h=0;h<k.columnCount;h++){if(c=B(k.getValue(g,h)),!c)return t;j=ob(m,n,c,b),m=j.Ri,n=j.Si}else if(e.Convert.Fh(a[d]))for(l=a[d],i=0;i<l.getRangeCount();i++)for(g=0;g<l.getRowCount(i);g++)for(h=0;h<l.getColumnCount(i);h++){if(c=B(l.getValue(i,g,h)),!c)return t;j=ob(m,n,c,b),m=j.Ri,n=j.Si}else{if(c=B(a[d]),!c)return t;j=ob(m,n,c,b),m=j.Ri,n=j.Si}return nb(eb(m,n))}function qb(a,b){return x(hb(a,b,!0))}function rb(a,b){return x(hb(a,b,!1))}function sb(a,b){var c,d,e,f,g,i,j,k,m,n=1.7976931348623157e308,o=.5772156649015329,p=0,q=.25*a*a,r=1,s=0,t=1,u=2/a;if(b>0){for(s=-o,f=1;f<b;f++)s+=1/f,r*=f+1;if(t=u,1===b)p=1/a;else{for(g=r/b,i=1,j=1,c=g,f=1;f<b;f++){if(g/=b-f,i*=f,j*=-q,d=g*j/i,c+=d,n-h(d)<h(c)||u>1&&n/u<t)return n;t*=u}if(c*=.5,d=h(c),t>1&&n/t<d||d>1&&n/d<t)return n;p=c*t}}k=2*l(a/2),m=-o,0===b?(s=m,d=1):(s+=1/b,d=1/r),c=(m+s-k)*d,e=1;do d*=q/(e*(e+b)),m+=1/e,s+=1/(e+b),c+=(m+s-k)*d,e++;while(h(d/c)>1.1102230246251565e-16);return c=.5*c/t,0!==(1&b)&&(c=-c),p+=c,x(p)}function tb(a,b){var c=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],d=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],e=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],f=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],g=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],h=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],m=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],n=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],o=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],p=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],r=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],s=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],t=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],u=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],v=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],w=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],y=.7978845608028654,z=2.356194490192345,A=.7853981633974483;function B(a,b,c,d){var e=0,f=q(b[e++]),g=c;d&&(f+=a,g--);do f=f*a+q(b[e++]);while(0!==--g);return f}function C(a,b){var l,o,p,q,r,s=b?c:d,x=b?e:f,C=b?g:h,D=b?m:n,E=b?t:u,F=b?v:w,G=b?5.783185962946784:14.681970642123893,H=b?30.471262343662087:49.2184563216946;return a<=5?(o=a*a,b&&a<1e-5?1-o/4:(l=B(o,E,3)/B(o,F,8,!0),p=(o-G)*(o-H),p*=l,b?p:p*a)):(l=5/a,o=b?25/(a*a):l*l,p=B(o,s,6)/B(o,x,6),q=B(o,C,7)/B(o,D,7,!0),r=a-(b?A:z),p=p*j(r)-l*q*i(r),p*y/k(a))}function D(a,b){var q,t,u,v,w,x=b?c:d,D=b?e:f,E=b?g:h,F=b?m:n,G=b?o:p,H=b?r:s,I=b?1:a,J=b?7:5,K=b?7:8;return a<=5?(t=a*a,q=I*B(t,G,J)/B(t,H,K,!0),q+=.6366197723675814*(b?l(a)*C(a,!0):C(a,!1)*l(a)-1/a)):(q=5/a,t=b?25/(a*a):q*q,u=B(t,x,6)/B(t,D,6),v=B(t,E,7)/B(t,F,7,!0),w=a-(b?A:z),u=u*i(w)+q*v*j(w),u*y/k(a))}function E(a,b){var c=D(a,!0),d=D(a,!1),e=1,f=2*e,g;if(0===b)return c;if(1===b)return d;do g=f*d/a-c,c=d,d=g,f+=2,++e;while(e<b);return g}return x(E(a,b))}function ub(a){return kb(a,2)}function vb(a){return kb(a,16)}function wb(a){return kb(a,8)}function xb(a,b){return mb(a,b,2,16)}function yb(a,b){return mb(a,b,2,8)}function zb(a,b){return lb(a,b,2)}function Ab(a,b){return lb(a,b,16)}function Bb(a,b){return lb(a,b,8)}function Cb(a,b){return mb(a,b,16,2,512)}function Db(a,b){return mb(a,b,8,2,512)}function Eb(a,b){return mb(a,b,16,8,536870912)}function Fb(a,b){return mb(a,b,8,16,549755813888)}function Gb(a,b){var c,d=w(a*k(2)),e=2*d-1;return b.$i&&(d=w(b.Qb*k(2)),c=2*d-1,e=c-e),e}function Hb(a){return Gb(a,{$i:!1})}function Ib(a){return 1-Gb(a,{$i:!1})}function Jb(a,b){return e.Zh.Yh(a,b)?1:0}function Kb(a,b){return a>=b?1:0}function Lb(a,b,c){return"i"!==c&&"j"!==c?e.Errors.Value:nb(eb(a,b),c)}function Mb(a){return x(k(a.Ri*a.Ri+a.Si*a.Si))}function Nb(a){return x(a.Si)}function Ob(a){return 0===a.Ri&&0===a.Si?e.Errors.DivideByZero:x(p(a.Si,a.Ri))}function Pb(a){return nb(eb(a.Ri,-a.Si))}function Qb(a){return nb(eb(j(a.Ri)*A(a.Si,!1),-i(a.Ri)*A(a.Si,!0)))}function Rb(a,b){var c=a.Ri,d=a.Si,e=b.Ri,f=b.Si;return nb(eb((c*e+d*f)/(e*e+f*f),(d*e-c*f)/(e*e+f*f)))}function Sb(a){return nb(eb(n(a.Ri)*j(a.Si),n(a.Ri)*i(a.Si)))}function Tb(a){var b=a.Ri,c=a.Si;return nb(eb(l(k(b*b+c*c)),p(c,b)))}function Ub(a){var b=a.Ri,c=a.Si,d=z.Ek(o,10);return nb(eb(d*l(k(b*b+c*c)),d*p(c,b)))}function Vb(a){var b=a.Ri,c=a.Si,d=z.Ek(o,2);return nb(eb(d*l(k(b*b+c*c)),d*p(c,b)))}function Wb(a,b){var c,d,e=a.Ri,f=a.Si;return 0===e&&0===f?b>0?"0":t:(c=k(e*e+f*f),d=p(f,e),nb(eb(m(c,b)*j(b*d),m(c,b)*i(b*d))))}function Xb(a){return x(a.Ri)}function Yb(a){return nb(eb(i(a.Ri)*A(a.Si,!1),j(a.Ri)*A(a.Si,!0)))}function Zb(a){var b,c,d=a.Ri,e=a.Si;return 0===d&&0===e?"0":(b=k(d*d+e*e),c=p(e,d),nb(eb(k(b)*j(c/2),k(b)*i(c/2))))}function $b(a,b){return nb(eb(a.Ri-b.Ri,a.Si-b.Si))}function _b(){return pb(arguments,!0)}function ac(){return pb(arguments,!1)}function bc(a){var b,c=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(b=0;c[b];b++)if(0===a.localeCompare(c[b]))return!1;return!0}function cc(a,b,c){var d,e,g,h,i,j,k=0,l=1;for(d=0;a[d].Ld;d++)if(0===c.localeCompare(a[d].Ld))return k=a[d]._c,{Tk:!0,Uk:l,Vk:k};if(b)for(d=0;b[d].Ld;d++)e=c.substr(0,1),g=b[d].Ld.substr(0,1),e===g&&bc(c)&&(l=b[d]._c);for(d=0;a[d].Ld;d++)if(h=f(a[d].Ld),i=c.substr(1,h),j=a[d].Ld.substr(0,h),i===j&&bc(c))return k=a[d]._c,{Tk:!0,Uk:l,Vk:k};return{Tk:!1,Uk:l,Vk:k}}function dc(a,b,c){var d,e,g,h,i,j,k,l,m,n,o;if(qc(b).unit&&qc(c).unit)return kc(a,b,c);if(d=hc(b,c),1===d)return s;if(2===d)return ic(a,b,c);if(fc(b)&&fc(c))return gc(a,b,c);if(ec(b)||ec(c))return s;for(e=[L,V,aa,ca,ka,ea,la,za,la,Aa,Ka],g=0;g<f(e);g++)if(h=e[g],i=cc(h,Sa,b),j=i.Tk,k=i.Vk,l=i.Uk,i=cc(h,Sa,c),m=i.Tk,n=i.Uk,o=i.Vk,j&&m&&0!==k&&0!==n)return a*l/k*o/n;return s}function ec(a){if(Ua.indexOf(a)>=0)return!1;var b=[a.slice(0,1),a.slice(1)],c=b[0],d=b[1];return Ra.indexOf(c)>=0&&Ua.indexOf(d)>=0}function fc(a){for(var b=0;b<$.length;b++)if(a===$[b].Ld)return!0;return"sec"===a.slice(1)||"s"===a.slice(1)}function gc(a,b,c){var d=cc($,Sa,b),e=cc($,Sa,c);return a*d.Uk/d.Vk*e.Vk/e.Uk}function hc(a,b){var c=a.indexOf("bit")>-1||a.indexOf("byte")>-1,d=b.indexOf("bit")>-1||b.indexOf("byte")>-1;return c&&d?2:d||c?1:0}function ic(a,b,c){var d=jc(b),e=jc(c);return a*d.Uk/d.Vk*e.Vk/e.Uk}function jc(a){var b,c,d,e,f,g,h;if(a.indexOf(Ma.bit)>-1?(b=[a.slice(0,-3),a.slice(-3)],d=b[0],f=b[1]):a.indexOf(Ma.byte)>-1&&(c=[a.slice(0,-4),a.slice(-4)],d=c[0],f=c[1]),d)for(h=0;Ta[h].Ld;h++)d===Ta[h].Ld&&(e=Ta[h]._c);else e=1;return f===Ma.bit?g=La[0]._c:f===Ma.byte&&(g=La[1]._c),{Uk:e,Vk:g}}function kc(a,b,c){var d,e=qc(b);switch(e.unit){case Na.Rank:d=oc(a,c);break;case Na.Reau:d=pc(a,c);break;case Na.C:case Na.cel:d=lc(a,c);break;case Na.F:case Na.fah:d=mc(a,c);break;case Na.K:case Na.kel:d=nc(a*e.prefixNumber,c)}return d}function lc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return 9*a/5+32+Qa;case Na.Reau:return.8*a;case Na.cel:case Na.C:return a;case Na.F:case Na.fah:return 9*a/5+32;case Na.K:case Na.kel:return c=d.prefixNumber,(a+Pa)/c}}function mc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return a+Qa;case Na.Reau:return 4*(a-32)/9;case Na.F:case Na.fah:return a;case Na.C:case Na.cel:return 5*(a-32)/9;case Na.K:case Na.kel:return c=d.prefixNumber,(5*(a-32)/9+Pa)/c}}function nc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return 9*a/5;case Na.Reau:return.8*(a-Pa);case Na.C:case Na.cel:return a-Pa;case Na.F:case Na.fah:return 9*(a-Pa)/5+32;case Na.K:case Na.kel:return c=d.prefixNumber,a/c}}function oc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return a;case Na.Reau:return.8*(a-Qa-32)*5/9;case Na.C:case Na.cel:return 5*(a-Qa-32)/9;case Na.F:case Na.fah:return a-Qa;case Na.K:case Na.kel:return c=d.prefixNumber,(Pa+5*(a-Qa-32)/9)/c}}function pc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return 1.25*a*9/5+32+Qa;case Na.Reau:return a;case Na.C:case Na.cel:return 1.25*a;case Na.F:case Na.fah:return 1.25*a*9/5+32;case Na.K:case Na.kel:return c=d.prefixNumber,(1.25*a+Pa)/c}}function qc(a){var b,c,d=1;if(Na[a])return{unit:a,prefixNumber:d};if("K"===Na[a.slice(1)]||"kel"===Na[a.slice(1)]){for(b=a.slice(0,1),a=a.slice(1),c=0;Sa[c].Ld;c++)b===Sa[c].Ld&&(d=Sa[c]._c);return{unit:a,prefixNumber:d}}return{unit:void 0,prefixNumber:d}}function rc(a,b,c,d){var e,f;if(""===a&&""===b)return u;if(e={value:0},f={value:0},D(a,e)===!0&&D(b,f)===!0){if(a=e.value,b=f.value,a<0||a>C||a%1!==0)return t;if("bitOperator"===c){if(b<0||b>C||b%1!==0)return t}else if("shiftOperator"===c&&0===a)return 0;return d(a,b)}return u}function sc(a,b){return rc(a,b,"bitOperator",function(a,b){return a&b})}function tc(a,b){return rc(a,b,"bitOperator",function(a,b){return a|b})}function uc(a,b){return rc(a,b,"bitOperator",function(a,b){return a^b})}function vc(a,b){return rc(a,b,"shiftOperator",function(a,b){if(b>=48)return t;if(b<0&&a<1<<-b)return 0;var c=a<<b;return c>C?t:c})}function wc(a,b){return rc(a,b,"shiftOperator",function(c,d){return d>53?t:b>=0?a>>b:a<<-b})}function xc(a,b){if(""===a)return t;if(a===!0||a===!1)return u;var c=B(a);return c?b(c):t}function yc(a){return xc(a,function(a){return nb(Jc(a),a.lja())})}function zc(a){return xc(a,function(a){return Qc(Gc(a),eb(0,0))?t:nb(Pc(Hc(a),Gc(a)),a.lja())})}function Ac(a){return xc(a,function(a){return Qc(a,eb(0,0))?t:nb(Lc(a),a.lja())})}function Bc(a){return xc(a,function(a){return Qc(Ic(a),eb(0,0))?t:nb(Mc(a),a.lja())})}function Cc(a){return xc(a,function(a){return Qc(Hc(a),eb(0,0))?t:nb(Nc(a),a.lja())})}function Dc(a){return xc(a,function(a){return Qc(Jc(a),eb(0,0))?t:nb(Oc(a),a.lja())})}function Ec(a){return xc(a,function(a){return nb(Ic(a),a.lja())})}function Fc(a){return xc(a,function(a){return nb(Kc(a),a.lja())})}function Gc(a){var b=a.Pi(),c=a.Qi();return eb(i(b)*A(c,!1),j(b)*A(c,!0))}function Hc(a){var b=a.Pi(),c=a.Qi();return eb(j(b)*A(c,!1),-(i(b)*A(c,!0)))}function Ic(a){var b=a.Pi(),c=a.Qi();return eb(A(b,!0)*j(c),A(b,!1)*i(c))}function Jc(a){var b=a.Pi(),c=a.Qi();return eb(A(b,!1)*j(c),A(b,!0)*i(c))}function Kc(a){return Pc(Gc(a),Hc(a))}function Lc(a){return Pc(E,Gc(a))}function Mc(a){return Pc(E,Ic(a))}function Nc(a){return Pc(E,Hc(a))}function Oc(a){return Pc(E,Jc(a))}function Pc(a,b){var c,d,e=a.Pi(),f=a.Qi(),g=b.Pi(),h=b.Qi();return Math.abs(h)<Math.abs(g)?(c=h/g,eb((e+f*c)/(g+h*c),(f-e*c)/(g+h*c))):(d=g/h,eb((f+e*d)/(h+g*d),(-e+f*d)/(h+g*d)))}function Qc(a,b){return a.Pi()===b.Pi()&&a.Qi()===b.Qi()}Va={Hi:0},Wa={Hi:5},Xa={Hi:5,aj:["checkLength 10"]},Ya={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]},Za={Hi:2,aj:"< 0"},$a={Hi:8},_a={Hi:8,Oi:!0},ab=[Va,Za],bb=[{Hi:0,aj:"<= 0"},Za],cb=[Va,{Hi:0,_i:0}],db=[Xa,Ya],v("BESSELI",qb,2,2,ab),v("BESSELJ",rb,2,2,ab),v("BESSELK",sb,2,2,bb),v("BESSELY",tb,2,2,bb),v("BIN2DEC",ub,1,1,Xa),v("BIN2HEX",xb,1,2,db,g,g,{bk:1}),v("BIN2OCT",yb,1,2,db,g,g,{bk:1}),v("DEC2BIN",zb,1,2,[{Hi:0,aj:["< -512","> 511"]},Ya],g,g,{bk:1}),v("DEC2HEX",Ab,1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},Ya],g,g,{bk:1}),v("DEC2OCT",Bb,1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},Ya],g,g,{bk:1}),v("HEX2BIN",Cb,1,2,db,g,g,{bk:1}),v("HEX2DEC",vb,1,1,Xa),v("HEX2OCT",Eb,1,2,db,g,g,{bk:1}),v("OCT2BIN",Db,1,2,db,g,g,{bk:1}),v("OCT2DEC",wb,1,1,Xa),v("OCT2HEX",Fb,1,2,db,g,g,{bk:1}),v("ERF",Gb,1,2,[Va,{Zi:!0,Hi:0}],g,g,{bk:1}),v("ERF.PRECISE",Hb,1,1,Va),v("ERFC",Ib,1,1,Va),v("ERFC.PRECISE",Ib,1,1,Va),v("DELTA",Jb,1,2,cb,g,g,{bk:1}),v("GESTEP",Kb,1,2,cb,g,g,{bk:1}),v("COMPLEX",Lb,2,3,[Va,Va,{Hi:5,_i:"i"}],g,g,{bk:2}),v("IMABS",Mb,1,1,$a),v("IMAGINARY",Nb,1,1,$a),v("IMARGUMENT",Ob,1,1,$a),v("IMCONJUGATE",Pb,1,1,$a),v("IMCOS",Qb,1,1,$a),v("IMDIV",Rb,2,2,[$a,_a]),v("IMEXP",Sb,1,1,$a),v("IMLN",Tb,1,1,_a),v("IMLOG10",Ub,1,1,_a),v("IMLOG2",Vb,1,1,_a),v("IMREAL",Xb,1,1,$a),v("IMSIN",Yb,1,1,$a),v("IMSQRT",Zb,1,1,$a),v("IMSUB",$b,2,2,[$a,$a]),v("IMPOWER",Wb,2,2,[$a,{Hi:2}]),v("IMPRODUCT",_b,1,255,g,-1,-1),v("IMSUM",ac,1,255,g,-1,-1),v("CONVERT",dc,3,3,[{Hi:1},Wa,Wa]),v("BITAND",sc,0,2),v("BITLSHIFT",vc,0,2),v("BITOR",tc,0,2),v("BITRSHIFT",wc,0,2),v("BITXOR",uc,0,2),v("IMCOSH",yc,1,1),v("IMCOT",zc,1,1),v("IMCSC",Ac,1,1),v("IMCSCH",Bc,1,1),v("IMSEC",Cc,1,1),v("IMSECH",Dc,1,1),v("IMSINH",Ec,1,1),v("IMTAN",Fc,1,1)},"./src/functions-fin.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.j.C4,g=isFinite,h=parseInt,i=d.Common.j,j=i.Ea,k=i.Ca,l=i.Fa,m=d.Common.k.ac,n=e.Convert.Rh,o=e.Convert.vf,p=e.Convert.Nh,q=e.Convert.Ph,r=e.Convert.Pa,s=e.Convert.CalcConvertedError,t=null,u=void 0,v=Math.pow,w=Math.abs,x=Math.ceil,y=Math.log,z=Math.sqrt,A=Math.floor,B=Math.max,C=Math.min,D=e.Errors.DivideByZero,E=e.Errors.Value,F=e.Errors.Number,G=e.Functions.ak,H=e.Functions.MathHelper,I=H.Ak,J=e.Functions.hk,K=e.Functions.lk,L=e.Functions.nk,M=e.Functions.mk,N=e.Functions.pk,O=e.Functions.vk,P=e.Convert.Th;function xa(a){return a.getMonth()}function ya(a){return a.getDate()}function za(a){return a.getFullYear()}function Aa(a,b){var c=za(a),d=new Date(c,b,1),e=L(za(d),xa(d));ya(a)>e&&a.setDate(e),a.setMonth(b)}function Ba(a){return a instanceof Date?d.Common.l.Ra(a):a}function Ca(a,b,c){var d=za(b)-za(a),f=xa(b)-xa(a)+12*d,g=ya(b)-ya(a),h=-1;return 0===c?h=e.Functions.uk(a,b):j(c,[1,2,3])>=0?h=Ba(b)-Ba(a):4===c&&(h=30*f+g),h}function Da(a,b,c,d,e){var f,h=v(1+a,b),i=g(h)?h:F;return 0===a?b:o(i)||(h=(h-1)/a,f=g(h)?h:F,o(f))?F:(h=(-c*i-d)/((1+a*e)*f),g(h)?h:F)}function Ea(a,b,c,d){var e=za(b),f=xa(b),g=ya(b),h=new Date(1,0,1),i=0,j=g===L(e,f),k=12/c,l=e-za(a);h.setFullYear(1),l>0&&(l=(l-1)*c);do h=new Date(e,f,g),l++,Aa(h,f-l*k),j&&(i=L(za(h),xa(h)),h=new Date(za(h),xa(h),i));while(M(a,h)<0);return d&&(h=new Date(e,f,g),l--,Aa(h,f-l*k),j&&(i=L(za(h),xa(h)),h=new Date(za(h),xa(h),i))),h}function Fa(a,b,c,d){return N(Ea(a,b,c,!1),a,d)}function Ga(a,b,c,d){var e;return e=j(d,[0,2,4,5])>=0?360/c:3===d?365/c:N(Ea(a,b,c,!1),Ea(a,b,c,!0),1)}function Ha(a,b,c,d){return N(a,Ea(a,b,c,!0),d)}function Ia(a,b,c){var d=za(b),e=xa(b),f=ya(b),g=new Date(d,e,f),i=e-xa(a)+12*(d-za(a));if(Aa(g,xa(g)-i),f===L(d,e))for(;ya(g)!==L(za(g),xa(g));)g.setDate(ya(g)+1);return ya(a)>=ya(g)&&i--,h(""+(1+i/(12/c)))}function Ja(a,b,c){return b>0?(c.Wk?c.Xk?w(a-c.Yk)<w(c.Zk-c.Yk)&&(c.Zk=a,c.$k=b):b<c.$k&&(c.Zk=a,c.$k=b):(c.Zk=a,c.$k=b,c.Wk=!0),[!1,c]):b<0?(c.Xk?c.Wk?w(a-c.Zk)<w(c.Zk-c.Yk)&&(c.Yk=a,c._k=b):-b<-c._k&&(c.Yk=a,c._k=b):(c.Yk=a,c._k=b,c.Xk=!0),[!1,c]):isNaN(b)?[!1,c]:(c.al=a,[!0,c])}function Ka(a,b,c,d,e){var f,g=Ea(a,c,d,!0),h=Ea(a,c,d,!1);if(M(g,b)>=0)return N(a,b,e)/Ga(h,g,d,e);for(f=N(a,g,e)/Ga(h,g,d,e);;){if(h=new Date(za(g),xa(g),ya(g)),Aa(g,xa(g)+12/d),M(g,b)>=0)return f+=N(h,b,e)/Ga(h,g,d,e);f+=1}}function La(a,b,c,d,e,f,g){var i,j,k,l=Fa(a,b,f,g),m=Ha(a,b,f,g),n=Ga(a,b,f,g),o=h(""+Ia(a,b,f)),p=0,q=100*c/f,r=1+d/f,s=m/n;for(i=0;i<o;i++)p+=q/v(r,s+i);return j=e/v(r,o-1+m/n),k=l/n*q,j+p-k}function Ma(a,b,c,d,e,f,g,i,j){var k,l,m,n,o,p,q=N(i,a,g),r=N(a,j,g),s=N(i,j,g),t=Ga(a,b,f,g),u=h(""+Ia(a,b,f)),w=100*c/f,y=1+d/f;if(r>t)switch(g){case 0:case 4:k=N(j,b,g),u=1+h(""+x(k/t));break;default:for(l=new Date(za(j),xa(j),ya(j)),u=0;u<32767;u++)if(m=new Date(za(l),xa(l),ya(l)),Aa(l,xa(l)+12/f),M(l,b)>=0){u+=h(""+x(N(m,b,g))/Ga(m,l,f,g))+1;break}q=t*Ka(i,a,j,f,g),r=t*Ka(a,j,j,f,g),s=t*Ka(i,j,j,f,g)}return n=e/v(y,u-1+r/t),o=s/t/v(y,r/t),p=v(y,-r/t)*(v(y,-u)-1/y)/(1/y-1),n+w*(o+p-q/t)}function Na(a,b){var c=a.substr(0,3),d={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return d[c]?I(d[c],b):-1}function Oa(a,b,c,d,e){var f,g=v(1+a,b);return 0===a?f=(c+d)/b:(f=d*a/(g-1)+c*a/(1-1/g),e>0&&(f/=1+a)),-f}function Pa(a,b,c,d,e){var f=v(1+a,b),g=e>0?1+a:1;return-(0===a?d+c*b:d*f+c*g*(f-1)/a)}function Qa(a,b,c,d,e,f,g){if(f<e||f>c||0!==g&&1!==g)return F;var h=Oa(b,c,d,0,g),i=0,j,k;for(1===e&&(a&&(i=h),g<=0&&(i+=a?d*b:-d),e++),j=e;j<=f;j++)k=g>0?Pa(b,j-2,h,d,1)-h:Pa(b,j-1,h,d,0),i+=a?h-k*b:k;return a?i:i*b}function Ra(a,b,c,d){var e=v(1+c,d),f=-(a*e*c+b*(e-1));return g(f)?f:F}function Sa(a,b,c,d,e){return j(d,[1,2,4])<0||M(b,c)>=0?F:a(b,c,d,e)}function Ta(a,b,c,d,e,f){function g(a,b,c,d){var e=0,f,g=0,h=100;for(a*=h/r(c),b/=c,b++,f=1;f<d;f++)e+=f*a/v(b,f);for(e+=d*(a+h)/v(b,d),f=1;f<d;f++)g+=a/v(b,f);return g+=(a+h)/v(b,d),e/=g,e/=r(c)}if(j(f,[1,2,4])<0||M(b,c)>0)return F;var h=g(d,e,f,Ia(b,c,f));return a?h/(1+e/f):h}function Ua(a,b,c,d,e,f,g,h,i){var k,l,m,n;if(j(g,[1,2,4])<0||M(b,c)>0||M(d,b)>0)return F;k=new Date(za(d),xa(d),ya(d));do Aa(k,xa(k)+12/g);while(M(k,c)<0);return l=Ka(d,b,k,g,h),m=Ka(d,c,k,g,h),n=Ka(b,c,k,g,h),a?(f*g+100*e*(m-l*(1+i*n/g)))/(i*n+g):(g*(f-i)+100*e*(m-l))/(n*i+100*e*l*n/g)}function Va(a,b,c){var d,e,f,g;return 0===c?D:(d=b<0?x(b):A(b),e=v(10,x(H.Ek(c,10))),f=b-d,g=a?f*e/c:f*c/e,p(d+g))}function Wa(a,b,c,d){var e,f,g=m(b),h=0,i=1+a,j=0;if(i>=.75&&i<=1.25&&g>12&&d&&(j=2.5),c)for(e=0;e<g;e++){if(f=-(e-j)*b[e]*Math.pow(i,-(e-j)-1),isNaN(f))return h;h+=f}else for(e=0;e<g;e++){if(f=b[e]*Math.pow(i,-(e-j)),isNaN(f))return h;h+=f}return h}function Xa(a,b,c,d){var e,f,h=0,i=m(b);for(a<=-1&&(a=-1+1e-10),e=0;e<i;e++){if(f=Ba(d[e])-Ba(d[0]),f<0)return[!1,c];h+=b[e]/H.Ck(a,f/365)}return g(h)?c=isNaN(h)?5e-324:h:h===Number.POSITIVE_INFINITY?c=J:h===Number.NEGATIVE_INFINITY&&(c=-J),[!0,c]}function Ya(a,b,c,d){var e,f,g;return a>-1&&0!==a?(e=c,f=v(1+a,e.bl-(d?1:0)),g=(v(1+a,e.bl)-1)/a,b=d?-e.cl*g/a+f*e.bl*(e.dl+e.cl*(e.Nc+1/a)):e.dl*f+e.cl*(1+a*e.Nc)*g+e.el,[!0,b,c]):[!1,b,c]}function Za(a,b,c,d,e,f,g,h,i,j,l,m,n,o,p){var q,r,s,t,u=0,v=0,w=c-e,x=c+e,y=2===a;if(w<f.fl&&(w=c),x>f.gl&&(x=c),w===x)return y?[!1,d,f,g]:[!1,d,f];if(0===a?(q=b(g,h,i,w,l,m,n,o,p)-j,r=b(g,h,i,x,l,m,n,o,p)-j):1===a?(q=b(w,g,u,h),r=b(x,g,v,h)):(q=Ya(w,u,g),r=Ya(x,v,g)),k(q)){if(t=q[2],u=q[1],s=q[0],!s)return y?[s,d,f,t]:[s,d,f]}else u=q;if(k(r)){if(t=r[2],v=r[1],s=r[0],!s)return y?[s,d,f,t]:[s,d,f]}else v=r;return d=(v-u)/(x-w),y?[!0,d,f,t]:[!0,d,f]}function $a(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o;return d<c.fl||d>c.gl?[!1,c]:(n=a?Wa(d,e):b(e,f,g,d,i,j,k,l,m)-h,o=Ja(d,n,c),c=o[1],[!!o[0],c])}function _a(a,b,c,d,e){if(b>a.gl)return[!1,a,c];var f=Xa(b,d,c,e);return c=f[1],f[0]?(f=Ja(b,c,a),a=f[1],[!!f[0],a,c]):[f[0],a,c]}function ab(a,b,c){var d,e,f=0;
return b<a.fl||b>a.gl?[!1,a,c]:(d=Ya(b,f,c),c=d[2],f=d[1],d[0]?(e=Ja(b,f,a),a=e[1],[!!e[0],a,c]):[d[0],a,c])}function bb(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q=0,r=a?15:2;if(!c.Wk||!c.Xk)return a?[!1,c,d]:[!1,c];for(l=w(c.Zk-c.Yk)/(w(c.Zk)+w(c.Yk)),k=0;k<100+4*r;k++)if(m=0,n=0,o=void 0,o=k%4===0?1:k%4===2?2:3,p=void 0,p=a?ib(c,d,l,q,n,o):b?jb(!0,c,q,m,n,o,Xa,l,e,d,Za):jb(!1,c,q,m,n,o,La,l,f,g,h,d,e,i,j),c=p[1],a&&(d=p[2]),q=a?p[3]:p[2],p[0])return a?[!0,c,d]:[!0,c];return a?[!1,c,d]:[!1,c]}function cb(a,b,c,d,e,f,g,h,i,j,k){var m,n,o,p,q,r,s,v=0,x=a?15:2;if(!b.Wk||!b.Xk)return[!1,b];for(n=w(b.Zk-b.Yk)/(w(b.Zk)+w(b.Yk)),m=0;m<100+4*x;m++)if(o=0,p=0,q=void 0,q=m%4===0?1:m%4===2?2:3,r=a?jb(!0,b,v,o,p,q,Wa,n,u,c,Za):jb(!1,b,v,o,p,q,Ma,n,g,h,i,c,d,j,k,e,f),b=r[1],v=r[2],o=r[3],!(a&&r[0]===t||!a&&l(r[0]))){if(r[0])return[!0,b];if(p=a?Wa(o,c):Ma(c,d,g,o,i,j,k,e,f)-h,s=Ja(o,p,b),b=s[1],s[0])return[!0,b];if(n=w(b.Zk-b.Yk)/(w(b.Zk)+w(b.Yk)),n<b.hl)return b._k<p&&(p=b._k,o=b.Yk),b.$k<p&&(o=b.Zk),b.al=o,[!0,b]}return[!1,b]}function db(a,b,c,d,e,f,g,h,i,j,l,m,n){var o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G,H=c.hl/2,I=!1;for(p=0;p<20;p++){if(d<c.fl||d>c.gl){if(!a||c.Xk&&c.Wk||!(d<=-1))return[!1,c];d=-1,I=!0}if(s=a?Xa(d,e,0,f):b(e,f,g,d,i,j,l,m,n)-h,k(s)){if(r=s[1],q=s[0],!q)return[q,c]}else r=s;if(t=Ja(d,r,c),c=t[1],t[0])return[!0,c];if(I)return[!1,c];if(u=c.Xk&&c.Wk?w(c.Zk-c.Yk):c.gl-c.fl,v=(w(d)<1e-10?u:w(d))/1e6,x=0,t=a?Za(1,Xa,d,x,v,c,e,f):Za(0,b,d,x,v,c,e,f,g,h,i,j,l,m,n),c=t[2],x=t[1]<0?t[1]:-t[1],q=t[0],!q)return[q,c];if(0===x)return[!1,c];if(y=d-1.000001*r/x,y===d)return c.al=d,[!0,c];if(a&&c.Xk&&c.Wk&&(z=[c.Zk,c.Yk],A=z[0],B=z[1],y<A==y<B&&(C=!0,A>B&&(o=[B,A],A=o[0],B=o[1],C=!1),D=[c.$k,c._k],E=D[0],F=D[1],y=A+w((C?E:F)/(F-E))*(B-A))),G=w(y-d)/(w(d)+w(y)),d=y,G<H)return c.al=d,[!0,c]}return[!1,c]}function eb(a,b,c){for(var d,e,g,h,i,j,k,l=a.hl/2,m=0;0===b[m];)m++;for(d=b.slice(m),g=[!1,null],h=[c],.1!==c&&h.push(.1),h.push(-.1,.99*a.gl,a.fl+.01),i=0;!g[0]&&i<h.length;i++)g=gb(f(a),d,h[i],l),fb(g,d);if(!g[0]){for(j=0,i=1,k=d.length;i<k;i++)j+=d[i];e=-j/d[0]-1,g=gb(f(a),d,e,l)}return g}function fb(a,b){var c,e,f,g;a[0]&&(c=a[1].al,e=15,"number"==typeof c&&c>-10&&c<10&&(f=""+c,(f.indexOf("000000000000")>1||f.indexOf("999999999999")>1)&&(e=14)),c=d.Common.o.Lma(c,e),g=mb(c,b),(g>.001||g<-.001)&&(a[0]=!1))}function gb(a,b,c,d){var e,f,g,h,i,j;for(e=0;e<32;e++){if(c<a.fl||c>a.gl)return[!1,a];if(f=Wa(c,b,!1,!0),g=Ja(c,f,a),a=g[1],g[0])return[!0,a];if(h=Wa(c,b,!0,!0),0===h)return[!1,a];if(i=c-1.0000001*f/h,i===c)return a.al=c,[!0,a];if(j=w(i-c)/(w(c)+w(i)),c=i,j<d)return a.al=c,[!0,a]}return[!1,a]}function hb(a,b,c){var d,e,f,g,h,i,j,k,l=a.hl/2;for(d=0;d<100;d++){if(e=void 0,f=void 0,g=void 0,h=0,i=0,c<a.fl||c>a.gl)return[!1,a,b];if(j=Ya(c,h,b),b=j[2],h=j[1],g=j[0],!g)return[g,a,b];if(k=Ja(c,h,a),a=k[1],k[0])return[!0,a,b];if(j=Ya(c,i,b,!0),b=j[2],i=j[1],g=j[0],!g)return[g,a,b];if(0===i)return[!1,a,b];if(e=c-1.000001*h/i,e===c)return a.al=c,[!0,a,b];if(f=w(e-c)/(w(c)+w(e)),c=e,f<l)return a.al=c,[!0,a,b]}return[!1,a,b]}function ib(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p;if(1===f){if(i=void 0,g=(a.Zk+a.Yk)/2,j=Ya(g,e,b),b=j[2],e=j[1],h=j[0],!h)return[t,a,b,d];if(0===e)return a=Ja(g,e,a)[1],[!0,a,b,d];if(i=z(e*e-a.$k*a._k),0===i)return[t,a,b,d]}else if(2===f){if(k=void 0,l=void 0,m=0,n=0,c>.1)return f=3,ib(a,b,c,d,e,f);if(o=d++%4,0===o)k=a.Zk,m=a.$k;else if(2===o)k=a.Yk,m=a._k;else if(k=(a.Zk+a.Yk)/2,j=Ya(k,m,b),b=j[2],m=j[1],h=j[0],!h)return[t,a,b,d];if(l=w(a.Zk-a.Yk)/1e6,p=Za(2,void 0,k,n,l,a,b),b=p[3],a=p[2],n=p[1],h=p[0],!h||0===n)return[t,a,b,d];if(g=k-1.01*m/n,g<a.Zk&&g<a.Yk||g>a.Zk&&g>a.Yk)return[t,a,b,d]}return[!1,a,b,d]}function jb(a,b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r){var s,u,v,x,y,A,B,C,D;switch(f){case 0:d=b.Zk-b.$k*((b.Yk-b.Zk)/(b._k-b.$k));break;case 1:if(d=(b.Zk+b.Yk)/2,s=a?g(d,j,e,i):g(m,n,i,d,l,o,p,q,r)-j,k(s)){if(e=s[1],!s[0])return[t,b,c,d,e,f]}else e=s;if(0===e)return b=Ja(d,e,b)[1],[!0,b,c,d,e,f];if(u=z(e*e-b.$k*b._k),0===u)return[t,b,c,d,e,f];d+=(d-b.Zk)*e/u;break;case 3:d=(b.Zk+b.Yk)/2;break;case 2:if(v=void 0,x=0,y=void 0,A=0,h>.1)return f=3,jb(a,b,c,d,e,f,g,h,i,j,l,m,n,o,p);if(B=c++%4,0===B)v=b.Zk,x=b.$k;else if(2===B)v=b.Yk,x=b._k;else if(v=(b.Zk+b.Yk)/2,s=a?g(v,j,x,i):g(m,n,i,v,l,o,p,q,r)-j,k(s)){if(x=s[1],!s[0])return[t,b,c,d,e,f]}else x=s;if(y=w(b.Zk-b.Yk)/1e6,C=a?l(1,g,v,A,y,b,j,i):Za(0,g,v,A,y,b,m,n,i,j,l,o,p,q,r),b=C[2],A=C[1],!C[0]||0===A)return[t,b,c,d,e,f];if(d=v-1.01*x/A,d<b.Zk&&d<b.Yk||d>b.Zk&&d>b.Yk)return[t,b,c,d,e,f]}return s=a?g(d,j,e,i):g(m,n,i,d,l,o,p,q,r)-j,k(s)&&(e=s[1],!s[0])?[t,b,c,d,e,f]:(D=Ja(d,e,b),D[0]?[!0,b,c,d,e,f]:(h=w(b.Zk-b.Yk)/(w(b.Zk)+w(b.Yk)),h<b.hl?(b._k<e&&(e=b._k,d=b.Yk),b.$k<e&&(e=b.$k,d=b.Zk),b.al=d,[!0,b,c,d,e,f]):[!1,b,c,d,e,f]))}function kb(a,b,c,d,e){e=e?1:0;var f=v(1+a,b);return f=0===a?c*b+d:d*f+c*(1+a*e)*(f-1)/a,p(-f)}function lb(a,b){for(var c=0;c<m(b);c++)b[c]!==s&&(a*=1+b[c]);return a}function mb(a,b){var c,d,e,f=arguments,g=0,h=1;for(d=1;d<m(f);d++){if(e=q(f[d],1,!0,!0,!1,!0),e.isError)return e[0];for(c=0;c<m(e);c++)e[c]!==s&&(g+=e[c]/v(1+a,h++))}return g}function nb(a,b,c,d,e){if(e=e?1:0,0===a)return p(-(c*b+d));var f=v(1+a,b);return a===-1?D:p(-(d+c*(1+a*e)*(f-1)/a)/f)}function ob(a,b,c,d,e){var f,g,h;return M(a,b)>=0?F:(f=Ca(a,b,e),g=K(a,e),f<=0||g<=0?F:(h=1-d*f/g,h<=0?F:c/h))}function pb(a,b,c){var d=m(b),e=m(c),f=0,g;if(d!==e)return F;if(b.some(function(a){return a===s}))return E;for(g=0;g<d;g++)f+=b[g]/v(1+a,(c[g]-c[0])/365);return f}function qb(a,b,c,d,e,f){return Qa(!1,a,b,c,d,e,f)}function rb(a,b,c,d,e,f){return Qa(!0,a,b,c,d,e,f)}function sb(a,b,c,d,e,f){if(b>=c+1||0!==f&&1!==f)return F;var g=Da(a,c,d,e,f);return Ra(d,g,a,b-1)}function tb(a,b,c,d){return p(d*a*(b/c-1))}function ub(a,b,c,d,e){e=e?1:0;var f=v(1+a,b);return f=0===a?(c+d)/b:(c*f+d)/((1+a*e)*(f-1)/a),p(-f)}function vb(a,b,c,d,e,f){var g,h;return f=f?1:0,b>=c+1?F:(g=Da(a,c,d,e,f),o(g)||(h=Ra(d,g,a,b-1),o(h))?F:g-h)}function wb(a,b,c,d){return Sa(Fa,a,b,c,d)}function xb(a,b,c,d){return Sa(Ga,a,b,c,d)}function yb(a,b,c,d){return Sa(Ha,a,b,c,d)}function zb(a,b,c){return Ba(Ea(a,b,c,!0))}function Ab(a,b,c){return Sa(zb,a,b,c)}function Bb(a,b,c){return Sa(Ia,a,b,c)}function Cb(a,b,c){return Ba(Ea(a,b,c,!1))}function Db(a,b,c){return Sa(Cb,a,b,c)}function Eb(a){var b=L(a.getFullYear(),a.getMonth());return b===a.getDate()}function Fb(a,b,c,d,e,f){var g,h,i,k,l,m,n,o,p,q,r,s;if(j(e,[1,2,4])<0||M(a,b)>0)return F;for(g=Ia(a,b,e),h=Ga(a,b,e,f),i=Ea(a,b,e,!1),k=N(i,a,f),0===f&&31===a.getDate()&&1===i.getMonth()&&Eb(i)&&k++,l=h-k,m=l/h,n=v(1+d/e,g-1+m),o=100/n,p=o*(g-1+m),q=0;q<g;q++)r=q+m,s=100*c/(e*v(1+d/e,r)),o+=s,p+=s*r;return p/o/e}function Gb(a,b,c,d,e){return d<0||c<0?F:Ta(!0,a,b,c,d,e)}function Hb(a,b,c,d,e){return e=e?1:0,0===a?0===b?D:p(-(c+d)/b):p(y((b*(1+a*e)-d*a)/(c*a+b*(1+a*e)))/y(1+a))}function Ib(a,b,c,d,e,f,g){var h,i,k,l,m,n,o,p,q,r,s;if(j(f,[1,2,4])<0||M(a,b)>0)return F;if(h=Ia(a,b,f),h<=1)return i=Fa(a,b,f,g),k=Ha(a,b,f,g),l=Ga(a,b,f,g),m=f*l/k,n=e/100+c/f-(d/100+i/l*c/f),o=d/100+i/l*c/f,n/o*m;if(q=.1,r={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},s=db(!1,La,r,q,a,b,c,d,e,f,g),r=s[1],p=s[0],!p){for(q=1e-10;q<r.gl;q*=2)r=$a(!1,La,r,q,a,b,c,d,e,f,g)[1];s=bb(!1,!1,r,a,b,c,d,e,f,g),r=s[1],p=s[0]}return p?r.al:F}function Jb(a,b,c,d,e){return M(a,b)>=0?F:(d/c-1)/O(a,b,e)}function Kb(a,b,c,d,e,f){var g,h,i,j;return M(a,b)>=0?F:(g=O(c,b,f),h=O(c,a,f),i=O(a,b,f),j=1+g*d,j/=e/100+h*d,j--,j/=i)}function Lb(a,b,c,d,e,f,g){function h(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=1/f;if(i=n<3?1:n<5?1.5:n<=6?2:2.5,f*=i,l=O(b,c,g),o(l))return 0;for(j=A(l*f*a+.5),a-=j,k=a-d,h=0;h<e;h++){if(j=A(f*a+.5),k-=j,k<0)return m=e-h,0===m||1===m?A(.5*a+.5):0;a-=j}return j}var i=1/f;return i>0&&i<1||i>1&&i<2||i>2&&i<3||i>4&&i<5||M(b,c)>0?F:h(a,b,c,d,e,f,g)}function Mb(a,b,c,d,e,f,g){function h(a,b,c,d,e,f,g){var h,i,j,k,l=a*f,m=a-d,p=O(b,c,g);return o(p)?0:(h=p*f*a,i=(a-d-h)/l,j=n((a-d-h)/l),k=0===e?h:e<=j?l*(i<1?i:1):e===j+1?m-l*j-h:0)}return M(b,c)>0?F:h(a,b,c,d,e,f,g)}function Nb(a,b,c,d,e,f,g,h,i){var k,l,m,n=.1;if(j(h,[1,2,4])<0||M(c,a)>0||M(a,d)>0||M(d,b)>0)return F;if(k={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},l=db(!1,Ma,k,n,a,b,e,f,g,h,i,c,d),k=l[1],m=l[0]){for(n=1e-10;n<k.gl;n*=2)k=$a(!1,Ma,k,n,a,b,e,f,g,h,i,c,d)[1];l=cb(!1,k,a,b,c,d,e,f,g,h,i),k=l[1],m=l[0]}return m?k.al:F}function Ob(a,b,c,d,e,f,g,h){return Ua(!1,a,b,c,d,f,g,h,e)}function Pb(a,b,c,d,e,f,g,h){return Ua(!0,a,b,c,d,f,g,h,e)}function Qb(a,b,c){var d,e,f=Ba(b)-Ba(a);return M(a,b)>=0||f>365?F:(d=365*c,e=360-c*f,0===e?D:e<0?F:p(d/e))}function Rb(a,b,c){var d=Ba(b)-Ba(a);return M(a,b)>=0||d>365?F:(100-c)/c*(360/d)}function Sb(a,b){var c,d,e,f,g,h=m(a),i=[],j=!1,k=!1,l={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(w(b)>1&&(b=.1),c=-1,d=0,e=0;e<h;e++)f=a[e],f!==s&&(0!==f&&(d=i.length+1,c===-1&&(c=i.length)),i.push(f),f>0&&(j=!0),f<0&&(k=!0));return i=i.slice(c,d+1),!j||!k||m(i)<2?F:(g=eb(l,i,b),l=g[1],g[0]?l.al:F)}function Tb(a,b,c){var d,e,f,g,h=0,i=0,j=0,k=0,l=0,n=[],o=m(a);if(o<2)return D;for(d=0;d<o;d++)e=a[d],e!==s&&(n.push(e),j++,0!==e&&(e>0?h++:i++));if(i<1||h<1)return D;for(f=0;f<j;f++)g=n[f],0!==g&&(g>0?k+=g/v(1+c,f):l+=g/v(1+b,f));return 0===l||0===k||c<=-1?D:v(-k*v(1+c,j)/(l*(1+c)),1/(j-1))-1}function Ub(a,b,c,d){for(var e=.5,f=c-e,g=c+e,h=0,i=0;Xa(f,a,i,b)[1]*Xa(g,a,i,b)[1]>0&&h++<d;)f-=e,g+=e;return h>=d?[0,0]:[f,g]}function Vb(a,b,c,d){var e,f,g=100,h=d.hl,i=d.Xk&&d.Wk?[d.Zk,d.Yk]:Ub(a,b,c,g),j=i[0],k=i[1],l=Xa(j,a,0,b)[1],m=Xa(k,a,0,b)[1],n=0;for(e=0;e<g&&!(l*m>0);e++)if(n=(j+k)/2,f=Xa(n,a,0,b)[1],f*l<0?(k=n,m=f):(j=n,l=f),w(j-k)<h)return[!0,n];return[!1,n]}Q=2.98023e-9,R=4.88281e-9;function Wb(a,b,c){var d,e,f,g,h,i,j,k,l=m(a),n=m(b);if(l!==n)return F;for(f=l-1;f>=0;f--)d=a[f]>0||d,e=a[f]<0||e,b[f]===s&&(0!==a[f]?b[f]=0:(a.splice(f,1),b.splice(f,1)));return d&&e?(g=a[0],0===g?0===c?R:Q:(h={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},i=db(!0,Za,h,c,a,b),h=i[1],i[0]?(j=h.al,Math.abs(j)<h.hl?Q:j):(k=Vb(a,b,c,h),k[0]?k[1]:F))):F}function Xb(a,b,c,d,e,f){var g,h,i,j,k,l;if(e=e?1:0,g=v(1.7976931348623157e298,1/a),h={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:B(-1e10,-g+1),gl:C(1e10,g-1)},i={bl:a,cl:b,dl:c,el:d,Nc:e},j=hb(h,i,f),i=j[2],h=j[1],k=j[0],!k){for(l=2;(!h.Xk||!h.Wk)&&l<100;l*=2)j=ab(h,f*l,i),i=j[2],h=j[1],j=ab(h,f/l,i),i=j[2],h=j[1];j=bb(!0,!1,h,i),h=j[1],k=j[0]}return k?h.al:F}function Yb(a,b,c,d,e){var f,g,h,i=e/c;return i>=1?(i=1,g=1===d?a:0):g=a*v(1-i,d-1),h=a*v(1-i,d),f=g-(h<b?b:h),f<0?0:f}function Zb(a,b,c,d,e,f){var g,h,i,j=0,k=0,l=x(e),m=l,n=a-b,o=!1;for(i=1;i<=m;i++)o?h=k:(g=Yb(a,b,c,i,f),k=n/(d-(i-1)),k>g?(h=k,o=!0):(h=g,n-=g)),i===m&&(h*=e+1-l),j+=h;return j}function $b(a,b,c,d,e,f,g){var h,i,j,k,l=A(d),m=l,n=x(e),o=n,p=0;if(g)for(h=m+1;h<=o;h++)i=Yb(a,b,c,h,f),h===m+1?i*=C(e,l+1)-d:h===o&&(i*=e+1-n),p+=i;else j=c,k=void 0,d!==A(d)&&f>1&&d>=c/2&&(k=d-c/2,d=c/2,e-=k,j+=1),a-=Zb(a,b,c,j,d,f),p=Zb(a,b,c,c-d,e-d,f);return p}function _b(a,b,c,d,e,f,g){return e<d?F:a<b&&0===d&&1===e?a-b:$b(a,b,c,d,e,f,g)}function ac(a,b,c,d,e,f,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(j(f,[1,2,4])<0||M(a,c)>=0)return F;if(1===f||0===g||4===g)return bc(a,b,c,d,e,f,g);for(h=a.getFullYear(),i=a.getMonth(),k=a.getDate(),l=c.getFullYear(),m=c.getMonth(),n=c.getDate(),o=b.getMonth(),p=b.getDate(),q=[],r=[],s=[],t=[31,28,31,30,31,30,31,31,30,31,30,31],u=0;u<f;u++)q[u]=(o+12*u/f)%12,r[u]=p<=t[q[u]]?p:t[q[u]],2===g?s[u]=360/f:3===g&&(s[u]=365/f);for(u=0;u<f;u++)v=u===f-1?0:u+1,w=q[v]>q[u]?2001:2002,s[u]=Ba(new Date(w,q[v],r[v]))-Ba(new Date(2001,q[u],r[u]));for(x=0,y=Ba(c);h<l||h===l&&i<m||h===l&&i===m&&k<n;){for(u=0;u<f&&(i<q[u]||i===q[u]&&k<r[u])&&(0===u||q[u]>q[u-1]);)u++;for(;u<f&&(i>q[u]||i===q[u]&&k>=r[u])&&(u++,i!==q[u-1]||k!==r[u-1]););u--,v=u===f-1?0:u+1,w=i+12/f>=12?h+1:h,z=Ba(new Date(h,i,k)),A=Math.min(Ba(new Date(w,q[v],r[v])),y),x+=e*d/f*(A-z)/s[u],h=w,i=q[v],k=r[v]}return x}function bc(a,b,c,d,e,f,g){var h=Ca(a,c,g),i=K(a,g);return h<0||i<=0?F:e*d*(h/i)}function cc(a,b,c,d,e){if(M(a,b)>0)return F;var f=Ca(a,b,e),g=K(a,e);return f<0||g<=0?F:d*c*f/g}function dc(a,b,c,d,e){if(M(a,b)>=0)return F;var f=K(a,e),g=Ca(a,b,e);return g<=0||f<=0?F:(d-c)/d*(f/g)}function ec(a,b){return v(1+a/b,b)-1}function fc(a,b,c,d,e){if(M(a,b)>=0)return F;var f=Ca(a,b,e),g=K(a,e);return f<=0||g<=0?F:(d-c)/c*(g/f)}function gc(a,b){return b*(v(1+a,1/b)-1)}function hc(a,b,c,d,e){var f,g,h,i,j=c+(e<12?1:0);if(j<d)return F;if(0===a)return 0;for(f=I(1-v(b/a,1/c),3),g=0,h=0,i=1;i<=d;i++)h=1===i?a*f*e/12:i===c+1?(a-g)*f*(12-e)/12:(a-g)*f,g+=h;return h}function ic(a,b,c,d,e){var f,g=0,h=0;if(c<d)return F;if(a<=b)return 0;for(f=1;f<=d;f++)h=(a-g)*(e/c),h=C(h,a-g-b),g+=h;return h}function jc(a,b,c){return(a-b)/c}function kc(a,b,c,d){return d>c?F:(a-b)*(c-d+1)*2/(c*(c+1))}function lc(a,b){return b<1?D:Va(!0,a,b)}function mc(a,b){return 0===b?D:Va(!1,a,b)}function nc(a,b,c,d,e,f,g){return j(f,[1,2,4])<0||M(a,b)>0?F:La(a,b,c,d,e,f,g)}function oc(a,b,c,d,e){if(M(a,b)>=0)return F;var f=Ca(a,b,e),g=K(a,e);return f<=0||g<=0?F:d-c*d*f/g}function pc(a,b,c,d,e,f){var g,h,i,j,k;return M(a,b)>=0?F:(g=Ca(a,b,f),h=Ca(c,b,f),i=Ca(c,a,f),j=K(a,f),i<=0||j<=0||g<=0||h<=0?F:(k=1+g/j*e,0===k?F:(100+h/j*d*100)/k-i/j*d*100))}function qc(a,b,c,d,e,f,g,h,i){return j(h,[1,2,4])<0||M(c,a)>0||M(a,d)>0||M(d,b)>0?F:Ma(a,b,e,f,g,h,i,c,d)}function rc(a,b,c){var d=Ba(b)-Ba(a);return M(a,b)>=0||d>365?F:100*(1-c*d/360)}function sc(a){var b=Na(a,2);return b>=0?b:F}function tc(a,b,c,d,e){var f,g,h,i;function k(a){var b=a.substr(0,3),c=["BEF","LUF","ESP","ITL","PTE","GRD","LUX"];return j(b,c)>=0?0:2}function l(a){var b=a.substr(0,3),c=["BEF","LUF","ESP","ITL","LUX"];return j(b,c)>=0?0:2}return f=0,d||(f=l(c)),e.$i||(e.Qb=k(b)),h=Na(b,e.Qb),i=Na(c,e.Qb),h>=0&&i>=0?(g=a*i/h,d||(g=I(g,f)),g):E}function uc(a,b,c,d){var e,f,g;return""===a&&""===b&&""===c?E:(e={value:0},a=P(a,e),f={value:0},b=P(b,f),g={value:0},c=P(c,g),a===!0&&b===!0&&c===!0?d(e,f,g):E)}function vc(a,b,c){return uc(a,b,c,function(a,b,c){var d,e;return b.value>0&&a.value>0&&c.value>0?(d=(Math.log(c.value)-Math.log(b.value))/Math.log(1+a.value),e=Math.abs(d),e<=1.79769e308?e>=2.2250738585072014e-308?d:0:D):F})}function wc(a,b,c){return uc(a,b,c,function(b,c,d){if(c.value>0&&b.value>0&&d.value>=0){a=Math.pow(d.value/c.value,1/b.value)-1;var e=Math.abs(a);if(e<=1.79769e308)return e>=2.2250738585072014e-308?a:0}return F})}S={Hi:0},T={_i:0,Hi:0},U={Hi:0,aj:"<= 0"},V={Hi:0,aj:"< 1"},W={Hi:0,aj:"< 0"},X={_i:.1,Hi:0},Y={_i:2,Hi:0},Z={_i:1e3,Hi:0,aj:"<= 0"},$={Hi:6},_={Hi:5},aa={_i:!1,Hi:7},ba={Hi:2},ca={Hi:2,aj:"<= 0"},da={Hi:2,aj:"< 1"},ea={_i:0,Hi:2},fa={_i:0,Hi:2,aj:["< 0","> 4"]},ga={_i:0,Hi:2,aj:["< 0","> 4","= 2"]},ha={Hi:2,aj:"= 0",bj:D},ia={Hi:2,aj:"< 0"},ja={Hi:4,Ii:1,Ji:!0,Ki:!0},ka={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},la={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ma={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},na={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},oa=[$,$,ba,fa],pa=[$,$,S,S,ba,fa],qa=[$,$,U],ra=[S,$,$,S,ba,U,ga],sa=[S,S,S,T,T],ta=[$,$,U,U,fa],ua=[U,ca,U,da,ba,ba],va=[U,da],wa=[S,ia],G("FV",kb,3,5,sa,u,u,{bk:[3,4]}),G("FVSCHEDULE",lb,2,2,[S,ja],1,1),G("NPV",mb,2,u,S,"> 0","> 0"),G("PV",nb,3,5,sa,u,u,{bk:[3,4]}),G("RECEIVED",ob,4,5,ta,u,u,{bk:3}),G("XNPV",pb,3,3,[S,ma,ma],"!= 0","!= 0"),G("CUMIPMT",qb,6,6,ua),G("CUMPRINC",rb,6,6,ua),G("IPMT",sb,4,6,[S,V,V,S,T,ea],u,u,{bk:[4,5]}),G("ISPMT",tb,4,4,[S,ba,ha,S]),G("PMT",ub,3,5,[S,{Hi:0,aj:"= 0",bj:D},S,T,T],u,u,{bk:[3,4]}),G("PPMT",vb,4,6,[S,V,S,S,T,T],u,u,{bk:[4,5]}),G("COUPDAYBS",wb,3,4,oa,u,u,{bk:3}),G("COUPDAYS",xb,3,4,oa,u,u,{bk:3}),G("COUPDAYSNC",yb,3,4,oa,u,u,{bk:3}),G("COUPNCD",Ab,3,4,oa,u,u,{bk:3}),G("COUPNUM",Bb,3,4,oa,u,u,{bk:3}),G("COUPPCD",Db,3,4,oa,u,u,{bk:3}),G("DURATION",Fb,5,6,pa,u,u,{bk:5}),G("MDURATION",Gb,5,6,pa,u,u,{bk:5}),G("NPER",Hb,3,5,[{Hi:0,aj:"<= -1"},S,S,T,T],u,u,{bk:[3,4]}),G("YIELD",Ib,6,7,[$,$,W,U,U,ba,fa],u,u,{bk:6}),G("YIELDDISC",Jb,4,5,[$,$,U,U,fa],u,u,{bk:3}),G("YIELDMAT",Kb,5,6,[$,$,$,W,U,fa],u,u,{bk:5}),G("AMORDEGRC",Lb,6,7,ra,u,u,{bk:6}),G("AMORLINC",Mb,6,7,ra,u,u,{bk:6}),G("ODDFYIELD",Nb,8,9,[$,$,$,$,W,U,U,ba,fa],u,u,{bk:8}),G("ODDLYIELD",Ob,7,8,[$,$,$,W,U,U,S,fa],u,u,{bk:7}),G("ODDLPRICE",Pb,7,8,[$,$,$,W,W,U,ba,fa],u,u,{bk:7}),G("TBILLEQ",Qb,3,3,qa),G("TBILLYIELD",Rb,3,3,qa),G("IRR",Sb,1,2,[ka,X],0,0,{bk:1}),G("MIRR",Tb,3,3,[ka,S,S],0,0),G("XIRR",Wb,2,3,[na,la,X],"!= 2","!= 2",{bk:2}),G("RATE",Xb,3,6,[U,S,S,T,{_i:0,Hi:2,aj:"< 0",bj:E},X],u,u,{bk:[3,4,5]}),G("VDB",_b,5,7,[W,W,ia,W,W,Y,aa],u,u,{bk:[5,6]}),G("ACCRINT",ac,6,8,[$,$,$,U,Z,ba,fa],u,u,{bk:[4,6,7]}),G("ACCRINTM",cc,3,5,[$,$,U,Z,fa],u,u,{bk:[3,4]}),G("DISC",dc,4,5,[$,$,U,U,fa],u,u,{bk:3}),G("EFFECT",ec,2,2,va),G("INTRATE",fc,4,5,ta,u,u,{bk:3}),G("NOMINAL",gc,2,2,va),G("DB",hc,4,5,[W,S,da,da,{_i:12,Hi:2,aj:["< 1","> 12"]}],u,u,{bk:3}),G("DDB",ic,4,5,[W,S,ca,ca,{_i:2,Hi:0,aj:"<= 0"}],u,u,{bk:3}),G("SLN",jc,3,3,[S,S,ha]),G("SYD",kc,4,4,[S,W,da,ca]),G("DOLLARDE",lc,2,2,wa),G("DOLLARFR",mc,2,2,wa),G("PRICE",nc,6,7,[$,$,W,W,U,ba,fa],u,u,{bk:6}),G("PRICEDISC",oc,4,5,ta,u,u,{bk:3}),G("PRICEMAT",pc,5,6,[$,$,$,W,W,fa],u,u,{bk:5}),G("ODDFPRICE",qc,8,9,[$,$,$,$,W,W,U,ba,fa],u,u,{bk:8}),G("TBILLPRICE",rc,3,3,[$,$,U]),G("EURO",sc,1,1,_),G("EUROCONVERT",tc,3,5,[S,_,_,aa,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:E}],u,u,{bk:[3,4]}),G("PDURATION",vc,3,3),G("RRI",wc,3,3)},"./src/functions-lookup.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=null,g=void 0,h=d.Common.q,i=d.Common.j,j=d.Common.l,k=j.lb,l=i.Fa,m=i.G,n=d.Common.k.ac,o=j.Ska,p=j.Ra,q=e.Convert.vf,r=e.Convert.Rh,s=e.Convert.Sh,t=e.Convert.Na,u=e.Convert.Pa,v=e.Convert.Fh,w=e.Convert.Ca,x=e.Convert.bc,y=e.Errors.Value,z=e.Errors.Reference,A=e.Errors.NotAvailable,B=e.Errors.Null,C=e.Errors.Calc,D=e.Functions.ak,E=e.Functions.ik,F=e.Functions.jk,G=1048576,H=16384;function Z(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}function $(a,b,c){var d,e;return l(a)?f:a.isArray||a.isReference?(d=a.colCount,b>d&&(e=b,b=c,c=e),a[c*d+b]):a[0]}function _(a,b,c){return!(!c||null!==a&&null!==b)||!l(b)&&(!!((l(a)||t(a,!0))&&t(b,!0)||E(a)&&E(b))||!(!F(a)||!F(b)))}function aa(a,b,c,d,e){if(a<0||b<0||b<a||c<a||c>b)return-1;if(e)return I=a,J=b,K=c,L=c,M=d,N=d,K;if(M){if(K++,K>J){if(M!==N)return-1;K=L-1,M=!1}}else if(K--,K<I){if(M!==N)return-1;K=L+1,M=!0}return K}function ba(a,b,c){var d=k(a),e=c;return d===b?e=0:d>b?e=1:d<b&&(e=2),e}function ca(a,b,c){var d,f,g;return a===b?0:F(a)?b||0!==n(a)?t(b)&&!t(a)?1:E(b)?2:F(b)?(d=e.Xmc(a,b,c),d<0?d=2:d>0&&(d=1),d):b instanceof Date?ba(a,b,1):-1:0:F(b)?a||0!==n(b)?t(a)?2:E(a)?1:a instanceof Date?ba(a,b,2):-1:0:E(a)&&t(b)?1:E(b)&&t(a)?2:(f=u(a),g=u(b),f===g?0:f<g?2:1)}function da(a,b,c){var d=$(a,b,c);return l(d)?0:d}function ea(a,b,c,d){var e,g,h,i,j=-1,k=0,l=-1,m=-1,n=d?b.rowCount:b.colCount;if(n--,n<k)return-1;for(;k<=n;){for(e=f,g=void 0,h=a[0],c>=1!=(2===j)&&(l=m),m=r((k+n)/2),m=aa(k,n,m,c>=0,!0),g=m;!_(h,e)&&m!==-1&&(e=d?$(b,0,m):$(b,m,0),!_(h,e));)m=aa(0,0,0,!1,!1),c>=0&&m<g?n=m:c<0&&m>g&&(k=m);if(m===-1&&c>=1!=(2===j))return l;if(m===-1)return-1;if(j=ca(h,e,!1),c>=1&&1===j)k=m+1;else if(c>=1&&2===j)n=m-1;else if(c<=-1&&1===j)n=m-1;else if(c<=-1&&2===j)k=m+1;else if(0===j){for(;c<=-1&&m>k||c>=0&&m<n;){if(i=0,i=c>=0?m+1:m-1,e=d?da(b,0,i):da(b,i,0),null===e)return-1;if(!_(h,e))break;if(j=ca(h,e,!1),0!==j)break;m=i}return m}}return c>=1!=(2===j)?m:l}function fa(a,b,c,d,e,g){var i,j,k,l,m,n,o=f,p=-1,q=a[0],r=F(q),s=h.zb(q),t=d?b.rowCount:b.colCount;for(r&&s&&(k=h.sb(s)),j=0;j<t;j++)if(m=e?t-1-j:j,l=d?$(b,0,m):$(b,m,0),_(q,l,g))if(n=F(l),r&&n&&s?(k.lastIndex=0,i=k.test(l)?0:1):i=ca(q,l,!1),c>=1&&1===i)i=-1,p>=0&&(i=ca(l,o,!1)),(p<0||p>=0&&1===i)&&(p=m,o=l);else if(c<=-1&&2===i)i=-1,p>=0&&(i=ca(l,o,!1)),(p<0||p>=0&&2===i)&&(p=m,o=l);else if(0===i)return m;return p}function ga(a,b){var c,d,e,f,g;if(!b)for(c=n(a),d=void 0,d=1;d<c;d++)if(e=a[d-1],f=a[d],g=ca(e,f,!1),2===g)return!1;return!0}O=e.CalcReference.prototype,P=function(a){Y(b,a);function b(b,c,d,e,f,g){var h,i=a.call(this,b,[Z(c,d,e,f)])||this;return i.getValue=function(a,b,c){var d=this,e=d.Nc,f;return f=0===e?d.getRow(0)+1+b:1===e?d.getColumn(0)+1+c:O.getValue.call(d,a,b,c)},h=i,h.cj=c,h.Lk=d,h.Xj=e,h.Yj=f,h.Nc=g,i}return b.prototype.type=function(){return this.Nc},b.prototype.toArray=function(a,b){var c=this,d=[],e=c.cj,f=c.Lk,g=c.Nc,h=c.getRangeCount(),i=c.Xj,j=c.Yj,k,l,m,n,o,p;for(k=0;k<h;k++)for(b||(m=[],d.push(m)),o=0;o<i;o++)for(b||(n=[],m.push(n)),p=0;p<j;p++)l=0===g?e+1+o:1===g?f+1+p:O.getValue.call(c,k,e+o,f+p),b?d.push(l):n.push(l);return b||1!==h||(d=d[0]),d.rowCount=i,d.colCount=j,d.rangeCount=h,d},b}(e.CalcReference),Q=function(a){Y(b,a);function b(b){var c=a.call(this,g)||this;return c.il=b,c}return b.prototype.getRowCount=function(){return e.CalcArrayHelper.getColumnCount(this.il)},b.prototype.getColumnCount=function(){return e.CalcArrayHelper.getRowCount(this.il)},b.prototype.getValue=function(a,b){return e.CalcArrayHelper.getValue(this.il,b,a)},b}(e.CalcArray);function ha(a,b,c){var d,f,h,i,j,k,l,m;if(!a)return y;if(d=a.arrayFormulaMode,f=b!==g,h=c?0:1,b=f?b:a.getReference(a.source,Z(a.row,a.column,a.rowCount,a.columnCount)),!b||1!==b.getRangeCount())return y;if(k=[],c){if(l=b.getRow(0)+1,j=b.getRowCount(0),j>1){for(i=0;i<j;i++)k.push([l+i]);return new e.CalcArray(k)}return l}if(m=b.getColumn(0)+1,j=b.getColumnCount(0),j>1){for(i=0;i<j;i++)k.push(m+i);return new e.CalcArray([k])}return m}function ia(a,b,c,d,f,h){var i,j,k,l,m,n,o;return a&&c instanceof e.CalcReference?(k=c.getRowCount(0),l=c.getColumnCount(0),j=c.create([{row:c.getRow(0),col:c.getColumn(0),rowCount:h?k:1,colCount:h?1:l}]),Aa(a,c,j.getRow(0),j.getColumn(0),j.getRowCount(0),j.getColumnCount(0),h&&c.yf[0].rowUndefine,!h&&c.yf[0].colUndefine)):(c instanceof e.CalcArray?(k=c.getRowCount(),l=c.getColumnCount()):Array.isArray(c)&&(k=c.rowCount,l=c.colCount),j=c),h&&d>l||!h&&d>k?z:(i=e.Convert.Ph(j,0,!0,!1,!1),i.isError||i.isConvertError?z:(m=f||f===g?ea(b,i,1,h):fa(b,i,0,h),m>=0?a&&c instanceof e.CalcReference?(n=h?m:d-1,o=h?d-1:m,Aa(a,c,c.getRow(0)+n,c.getColumn(0)+o,1,1),c.getValue(0,n,o)):h?da(i,d-1,m):da(i,m,d-1):A))}function ja(a,b){return ha(a,b,!0)}function ka(a,b){return ha(a,b,!1)}function la(a){return e.CalcArrayHelper.getRowCount(a)}function ma(a){return e.CalcArrayHelper.getColumnCount(a)}function na(a){return new Q(a)}function oa(a,b,c,d,e){return ia(a,b,c,d,e,!1)}function pa(a,b,c,d,e){return ia(a,b,c,d,e,!0)}function qa(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=b.getRowCount(),t=b.getColumnCount(),u=1===s&&1===t,v=c.getRowCount(),w=c.getColumnCount(),x=1===s&&t>=1,z=1===v&&w>=1;if(u){if(v>1&&w>1)return y}else if(x&&t!==w||!x&&s!==v)return y;if(h=ua(a,e.Convert.Ph(b,0,!0),f,g),h===A)return i="string"==typeof d?d:A,u?i:new e.CalcArray([[i]]);if(h===y)return y;if(h>0){if(u)return c;if(h-=1,j=[],e.Convert.Ca(c)){if(x)for(k=0;k<v;k++)l=c.getValue(0,h),j.push([l]);else m=z?[c.getValue(0,h)]:[c.getValue(h,0)],j.push(m);return new e.CalcArray(j)}if(c instanceof e.CalcReference)return n=c,o=n.getRow(),p=n.getColumn(),q=v,r=w,x?(p=n.getColumn()+h,r=1):(o=n.getRow()+h,q=1),n.create([{row:o,col:p,rowCount:q,colCount:r}])}}function ra(a,b,c){var d,f,h,i,j,k,m,n=[];if(b)for(d=0;d<b.length;d++)n.push(b[d]);if(b.colCount<=b.rowCount?(n.colCount=b.colCount,n.rowCount=Math.ceil(n.length/n.colCount)):(n.rowCount=b.rowCount,n.colCount=Math.ceil(n.length/n.rowCount)),l(b.isReference)||(n.isReference=b.isReference),l(b.isArray)||(n.isArray=b.isArray),n.rangeCount=b.rangeCount,f=-1,i=n.colCount,j=n.rowCount,k=a,c===g)return m=i>j?oa(g,k,n,j,!0):pa(g,k,n,i,!0),q(m)?A:m;if(h=e.Convert.Ph(c,0,!0,!1,!1)){if(h.colCount>1&&h.rowCount>1)return A}else h=n;return f=ea(k,n,1,!(i>j)),f>=0?(i=h.colCount,j=h.rowCount,i>j?da(h,f,j-1):da(h,i-1,f)):A}function sa(a){var b=arguments;return a<1||n(b)<=a?y:l(b[a])?0:b[a]}function ta(a,b,c){var d,e,h,i=a,j=b;return j.isArray||j.isReference?(d=j.colCount,e=j.rowCount,h=-1,d>1&&e>1?A:1===c&&!ga(j,!0)||c===-1&&!ga(j,!1)?A:(c===g?c=1:c===f&&(c=0),1===c?h=ea(i,j,1,e>1):0===c?h=fa(i,j,0,e>1):c===-1&&(h=ea(i,j,-1,e>1)),h===-1?A:h+1)):A}function ua(a,b,c,d){var e,f,g,i,j,k,m,n,o,p,q,r,s=b;if(!s.isArray&&!s.isReference)return A;if(e=s.colCount,f=s.rowCount,e>1&&f>1)return y;if(2===c&&(2===d||d===-2))return y;if(g=2===d&&!ga(s,!0),i=d===-2&&!ga(s,!1),g||i)return A;if(j=a,k=a&&a[0],m=-1,l(c)&&(c=0),(l(d)||0===d)&&(d=1),d===-1&&(n=!0),0!==c&&2!==c||(o=0),1===d||d===-1){if(1===c)o=-1;else if(c===-1){if(h.ub(k))return A;o=1}m=fa(j,s,o,f>1,n,!0)}else if(2===d||d===-2){if(1===e&&1===f){if(p=0,q=s[p],!_(k,q))return A;if(r=ca(k,q,!1),0===r)return p+1;if(0===c)return 0===r?p+1:A;if(1===c)return 2===r?p+1:A;if(c===-1)return 1===r?p+1:A}o=2===d?1:-1,m=ea(j,s,o,f>1)}return m===-1?A:0!==c||Qa(k,s[m])?Qa(k,s[m])?m+1:2===d&&1===c?m+2:d===-2&&c===-1?m+2:m+1:A}function va(a,b,c,d){return a+=b,d?0!==c&&(a+="[",a+=""+c,a+="]"):a+=c,a}function wa(a,b,c){return c||(a+="$"),a+=b}function xa(a,b,c){c||(a+="$");for(var e=a.length;b>.1;b=parseInt(""+(b-1)/26,10))a=d.Common.u.Eb(a,e,String.fromCharCode("A".charCodeAt(0)+(b-1)%26));return a}function ya(a,b){if(b&&0<n(b)){var c=void 0,d=!e.ei(b[0])&&"_"!==b[0];for(c=1;!d&&c<n(b);c++)d=!e.fi(b[c])&&"_"!==b[c];d?(a+="'",a+=b.replace("'","''"),a+="'"):a+=b,a+="!"}return a}function za(a,b,c,d,e){var f=3===c||4===c||7===c||8===c,g=2===c||4===c||6===c||8===c,h="";return a<1&&(d||!f)||a>G||b<1&&(d||!g)||b>H||c<1||8<c?y:(h=ya(h,e),d?(h=xa(h,b,g),h=wa(h,a,f)):(h=va(h,"R",a,f),h=va(h,"C",b,g)),h)}function Aa(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q;a&&a.identity&&(i=a.identity.row,j=a.identity.col,k=a.source.getCalcSourceModel().qg(i,j),l=b.getSource(),k&&l.getRangeKey&&(m=c,n=d,o=e,p=f,g&&(m=o=-1),h&&(n=p=-1),q=l.getRangeKey(l,{id:l.id,row:m,col:n,rowCount:o,colCount:p}),k.eOb||(k.eOb={}),k.eOb[q]={id:l.id,row:c,col:d,rowCount:e,colCount:f,rowUndefine:g,colUndefine:h}))}function Ba(a,b,c,d,h){var i,j,k,m,o,p,q,t,u,v,w,x,A;function B(a){return!l(a)&&!a._error}if(i=f,j=a,k=j!==f&&j.acceptsReference,m=j!==f&&j.arrayFormulaMode,b instanceof e.CalcReference){if(o={value:-1},p=b,h===g&&(h=1),h=B(h)&&s(h,o)?o.value-1:i,h>=p.getRangeCount())return z;if(h===i||h<0)return y;if(q=p.getRowCount(h),t=p.getColumnCount(h),u=p.getRow(h),v=p.getColumn(h),w=void 0,x=void 0,3===n(arguments)){if(1!==q&&1!==t)return z;1!==t?(d=c,c=1):1!==q&&(d=1)}if(c===g&&(c=0),c=B(c)&&s(c,o)?o.value-1:i,c===-1){if(1!==q&&!k&&!m&&(u>j.row||j.row>=u+q))return y}else{if(c<-1||c===i)return y;if(q<=c&&!b.yf[0].rowUndefine)return z;w=c+u}if(d===g&&(d=0),d=B(d)&&s(d,o)?o.value-1:i,d===-1){if(1!==t&&!k&&!m&&(v>j.column||j.column>=v+t))return y}else{if(d<-1||d===i)return y;if(t<=d&&!b.yf[0].colUndefine)return z;x=d+v}return c===-1&&d===-1?(w=u,x=v):c===-1?(w=u,t=1):d===-1?(x=v,q=1):(t=1,q=1),Aa(a,p,w,x,q,t,c===-1&&b.yf[0].rowUndefine,d===-1&&b.yf[0].colUndefine),p.create([Z(w,x,q,t)])}if(e.Convert.Ca(b))return A=b,q=A.getRowCount(),c=c!==g?r(c):-1,d=d!==g?r(d):-1,h=h!==g?r(h)-1:1,1!==h?z:(c===-1&&d===-1?c=d=0:d===-1&&1===q&&(d=c,c=1),c=c===-1?0:c,d=d===-1?0:d,q=A.getRowCount(),t=A.getColumnCount(),c<0||d<0||h<0?y:(c>q&&1===q&&d===g&&(d=c,c=0),q<c||t<d?z:0===c&&0===d?A.slice(0,0,q,t):0===c?A.slice(0,d-1,q,1):0===d?A.slice(c-1,0,1,t):A.getValue(c-1,d-1)))}function Ca(a,b,c,d,f,h){var i,j,k,m;return a?b&&b instanceof e.CalcReference&&1===b.getRangeCount()?(i=f!==g?r(f):b.getRowCount(0),j=h!==g?r(h):b.getColumnCount(0),k=b.getRow(0)+c,m=b.getColumn(0)+d,Aa(a,b,k,m,i,j,l(f)&&b.yf[0].rowUndefine,l(h)&&b.yf[0].colUndefine),i<=0||j<=0||k<0||m<0?z:b.create([{row:k,col:m,rowCount:i,colCount:j}])):y:A}function Da(a,b,c){var d,f,g,h,j,k,l,m,n,o,p,q;return a?b&&"!"!==b[0]?(d=a.row,f=a.column,g={row:d,col:f},h=a.parser,h||(h=a.parser=new e.Parser),j=a.source,k=j.parserContext,k?(k.useR1C1=!c,k.row=g&&g.row||0,k.column=g&&g.col||0,k.baseIdentity=g,k.source=a.source):(j.parserContext=k=a.source?a.source.getParserContext(!c,g):new e.ParserContext(a.source,(!c),g),k.onlyValidateSourceNameWithSpecial=!0),c?l=h.parse(k,b):(n=j.expressions,n||(n=j.expressions={}),l=n[b],l||(l=h.parse(k,b),n[b]=l)),l?(o=!1,7===l.type&&"ANCHORARRAY"===l.functionName&&(l=l.arguments[0],o=!0),8===l.type&&(l.source?(m=l.source,l=m.getCustomName(l.value)):l=a.getName(l.value)),!l||i.Ea(l.type,[1,13])<0?z:(m=l.source||a.source,25===l.type||26===l.type?m.getValueByName(l.nameIdentity):(p=l.getRange(d,f),13===l.type&&(m=l.source),q=null,q=m.getReference(p),o&&(q=q.getSpillRef()),Aa(a,q,q.getRow(0),q.getColumn(0),q.getRowCount(0),q.getColumnCount(0),q.yf[0].rowUndefine,q.yf[0].colUndefine),q))):z):z:A}function Ea(a,b){var c,d="__proto__";return c=x(2===arguments.length?b:a),c[d].hyperlink=x(a),c}function Fa(){var a,b=0;for(a=0;a<n(arguments);a++){if(0===arguments[a].length)return B;arguments[a].isReference&&(b+=arguments[a].rangeCount)}return b}function Ga(a,b){var c=b.getRow(0),d=b.getColumn(0),e=b.getSource().getCalcSourceModel().getFormula(c,d);return e?"="+e:A}function Ha(a,b){var c=b.getRow(0),d=b.getColumn(0),e=b.getSource().getCalcSourceModel().getFormula(c,d);return!!e}function Ia(a,b){void 0===b&&(b=!1);var c;return v(a)||w(a)?c=a.toArray(0,!1):a.length&&a[0].length&&(c=a),c?Ja(c,b):q(a)?a:y}function Ja(a,b){var c,d,e,f,g,h,i;if(void 0===b&&(b=!1),d=a.rowCount,e=a.colCount,d||e||(d=a.length,e=a[0].length),f=a,b){for(f=[],g=0;g<e;g++)for(h=[],f.push(h),i=0;i<d;i++)h.push(a[i][g]);c=[e,d],d=c[0],e=c[1]}return f.rowCount=d,f.colCount=e,f}function Ka(a){return 1===a||a===-1}function La(a,b){var c=b.length;a.sort(function(a,d){var f,g,h,i;for(f=0;f<c;f++)if(g=b[f],h=g[0],i=e.gOb(a[h],d[h]),0!==i)return g[1]?i:-i;return 0})}function Ma(a,b,c){if(c)a.forEach(function(a,c){a.push(b[c][0])});else{var d=b[0];a.forEach(function(a,b){a.push(d[b])})}}function Na(a){if(a&&a.length&&a.length>=0){for(var b=0;b<a.length;b++)if("number"!=typeof a[b])return!1;return!0}return!1}function Oa(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,r,s,t,u,x,z,A,B,C,D;if(void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=!1),f=[].concat(Ia(a,d)),q(f))return f;if(g=f,h=[],v(b)||w(b)){if(l=b.toArray(0,!1),m=l.rowCount,n=l.colCount,o=0,v(c)||w(c)){if(j=c.toArray(0,!1),o=j.rowCount,1!==n){if(n<1||1!==j.colCount&&j.colCount!==n||1!==m||!Na(l[0]))return y;if(p=[],p.push(a),d)for(g=Ja(g,d),r=0;r<n;r++){for(s=[],t=0;t<g[0].length;t++)s.push(g[l[0][r]-1][t]);p.push(new e.CalcArray([s])),1===o?p.push(j[0][0]):p.push(j[r][0])}else for(r=0;r<n;r++){for(s=[],t=0;t<g.length;t++)s.push([g[t][l[0][r]-1]]);p.push(new e.CalcArray(s)),1===o?p.push(j[0][0]):p.push(j[r][0])}return Pa.apply(Pa,p)}if(1!==j.colCount||1!==o&&o!==m)return y;1===o&&(o=0,k=j[0][0])}else k=c;for(i=0;i<m;i++)h.push([l[i][0],i<o?j[i][0]:k])}else if(v(c)||w(c)){if(j=c.toArray(0,!1),1!==j.colCount||1!==j.rowCount)return y;h.push([b,j[0][0]])}else h.push([b,c]);for(u=g.colCount,x=[],z=0,A=h;z<A.length;z++){if(B=A[z],C=B[0],D=B[1],C<1||C>u||!Ka(D))return y;x.push([C-1,1===D])}return La(g,x),new e.CalcArray(d?Ja(g,d):g)}function Pa(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,r,s,t,u,x,z,A,B,C,D,E,F,G,H,I;for(void 0===c&&(c=1),d=[],f=3;f<arguments.length;f++)d[f-3]=arguments[f];if(i=0,j=0,k=y,w(a)?g=a:v(a)&&(h=a,i=h.getRow(),j=h.getColumn()),l=g||h){if(m=l.getColumnCount(),n=l.getRowCount(),q(a))return k;for(o=[],p=void 0,r=0,s=0,t=void 0,u=void 0,x=1,z=arguments.length;x<z;x+=2){if(A=arguments[x],B=[].concat(Ia(A)),q(B))return k;if(C=A.getRowCount(),D=A.getColumnCount(),r||(p=1===D,r=p?2:1,u=[].concat(Ia(a,!p))),!(!p&&1===C&&D===m||p&&1===D&&C===n))return k;
if(E=w(A),v(A)&&(F=void 0,p?(G=A.getColumn(),F=j-G,F>=0&&F<m?t=F:E=!0):(H=A.getRow(),F=i-H,F>=0&&F<n?t=F:E=!0)),E&&(s+=1,t=p?m++:n++,Ma(u,B,p)),I=arguments[x+1]||1,!Ka(I))return k;o.push([t,1===I])}return La(u,o),s&&u.forEach(function(a){a.length-=s}),new e.CalcArray(p?u:Ja(u,!0))}return k}function Qa(a,b){return!!(a===b||o(a)&&o(b)&&p(a)===p(b)||q(a)&&q(b)&&a._code===b._code)}function Ra(a,b){var c,d,e,f;for(c=0,d=a.length;c<d;c++)if(e=a[c],f=b[c],!Qa(e,f))return!1;return!0}function Sa(a,b,c){var d,f,g,h;return void 0===b&&(b=!1),void 0===c&&(c=!1),d=Ia(a,b),q(d)?d:(f=d,g=[],h=f.rowCount,f.forEach(function(a,b){var d,e,i;if(!a.duplicated){for(d=0,e=b+1;e<h;e++)i=f[e],Ra(a,i)&&(i.duplicated=!0,d++);c&&0!==d||g.push(a)}}),new e.CalcArray(b?Ja(g,b):g))}function Ta(a,b,c){var d,f,g,h=Ia(a);return q(h)?h:(d=h,f=[].concat(Ia(b)),g=[],1===f.length&&f[0].length===d[0].length?d.forEach(function(a,b){var c=[];a.forEach(function(a,b){f[0][b]&&c.push(a)}),g.push(c)}):d.forEach(function(a,b){f[b][0]&&g.push(a)}),0===g.length?l(c)?C:c:new e.CalcArray(g))}function Ua(a,b){var c,d,e,f,g,h,i,j,k,l;return w(b)?b.getValue(0,0):v(b)?(c=b,d=c.getColumn(),e=c.getRow(),f=c.getColumnCount(),g=c.getRowCount(),h=a.row,i=a.column,j=h-e,k=i-d,l=a.source===c.getSource(),1===g&&(!l||e!==h)&&k>=0&&k<f?c.getValue(0,0,k):1===f&&(!l||d!==i)&&j>=0&&j<g?c.getValue(0,j,0):1===g&&1===f?c.getValue(0,0,0):y):b}function Va(a,b){return b instanceof e.CalcReference?b.getSpillRef():z}R={_i:!0,Hi:7},S={Hi:7},T={Hi:2},U={Hi:2},V={_i:1,Hi:2},W={Hi:2,aj:"<= 0",bj:y},X={Hi:4,Ii:0,Ji:!0},D("ADDRESS",za,2,5,[T,T,V,R,{_i:"",Hi:5}],g,g,{bk:[2,3,4]}),D("INDEX",Ba,2,4,g,0,0,{bk:[1,2,3],KMc:[0],l7c:!0,dk:!0,fk:3}),D("OFFSET",Ca,3,5,[{},T,T],0,0,{bk:[3,4],KMc:[0],l7c:!0,dk:!0,fk:2,returnReference:!0}),D("ROW",ja,0,1,g,-1,g,{dk:!0,KMc:-1,expandColumns:!1}),D("COLUMN",ka,0,1,g,-1,g,{bk:0,dk:!0,KMc:-1,expandRows:!1}),D("ROWS",la,1,1,g,-1,-1,{KMc:-1,expandColumns:!1,ck:!0}),D("COLUMNS",ma,1,1,g,-1,-1,{KMc:-1,expandRows:!1,ck:!0}),D("TRANSPOSE",na,1,1,g,-1,-1),D("LOOKUP",ra,2,3,[X,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),D("HLOOKUP",oa,3,4,[X,{},W,S],1,1,{dk:!0,KMc:[1],l7c:!0}),D("VLOOKUP",pa,3,4,[X,{},W,S],1,1,{dk:!0,KMc:[1],l7c:!0,TAb:!0}),D("XLOOKUP",qa,3,6,[X,{},{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),D("CHOOSE",sa,2,255,T,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(a){var b={value:-1};return q(a)?-1:(s(a,b),b.value)}}),D("MATCH",ta,2,3,[X,X,U],1,1,{}),D("XMATCH",ua,2,4,[X,X,U,U],1,1,{}),D("INDIRECT",Da,1,2,[{Hi:5},R],g,g,{bk:2,l7c:!0,dk:!0}),D("HYPERLINK",Ea,1,2),D("AREAS",Fa,1,g,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),D("FORMULATEXT",Ga,1,1,g,-1,g,{dk:!0}),D("ISFORMULA",Ha,1,1,g,-1,g,{dk:!0}),D("SORT",Oa,1,4,g,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),D("SORTBY",Pa,2,g,g,[0,"%= 1"],[0,"%= 1"],g,!0),D("UNIQUE",Sa,1,3,g,[0],[0],{bk:[1,2]},!0),D("FILTER",Ta,2,3,g,[0,1,2],[0,1,2],g,!0),D("@",Ua,1,1,g,[0],[0],{dk:!0},!0),D("ANCHORARRAY",Va,1,1,g,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.k.ac,g=null,h=void 0,i=isNaN,j=isFinite,k=parseInt,l=Math.pow,m=Math.max,n=Math.min,o=Math.floor,p=Math.sin,q=Math.tan,r=Math.PI,s=Math.atan,t=Math.exp,u=Math.abs,v=Math.sqrt,w=Math.log,x=Math.round,y=e.Errors.DivideByZero,z=e.Errors.Value,A=e.Errors.NotAvailable,B=e.Errors.Number,C=e.Errors.Null,D=e.Convert.Nh,E=e.Convert.Ph,F=e.Convert.Rh,G=e.Convert.Pa,H=e.Convert.Fh,I=e.Functions.MathHelper,J=I.Bk,K=I.xk,L=e.Convert.Na,M=e.Convert.vf,N=e.Functions.Hfc,O=e.Functions.sk,P=e.Functions.sja,Q=e.Functions.qk,R=e.Functions.ik,S=e.Functions.jk,T=e.Functions.Na,U=e.Functions.hk,V=e.Convert.CalcConvertedError,W=e.Functions.ak,X=e.Convert.Th,Y=e.Convert.Sh;function Za(a){var b,c=0;for(b=0;b<a.length;b++)a[b]!==V&&c++;return c}function $a(a){var b,c,d,e=6;return 0===a?b=0:(c=.5*Math.abs(a),c>=.5*e?b=1:c<1?(d=c*c,b=((((((((.000124818987*d-.001075204047)*d+.005198775019)*d-.019198292004)*d+.059054035642)*d-.151968751364)*d+.319152932694)*d-.5319230073)*d+.797884560593)*c*2):(c-=2,b=(((((((((((((-45255659e-12*c+.00015252929)*c-19538132e-12)*c-.000676904986)*c+.001390604284)*c-.00079462082)*c-.002034254874)*c+.006549791214)*c-.010557625006)*c+.011630447319)*c-.009279453341)*c+.005353579108)*c-.002141268741)*c+.000535310849)*c+.999936657524)),a>0?.5*(b+1):.5*(1-b)}function _a(a,b,c){var d,e,g,h,i,j=f(a);if(b!==a[0]){for(g=0,h=a[0],e=1;e<j&&a[e]<b;e++)a[e]!==h&&(g=e,h=a[e]);a[e]!==h&&(g=e),b===a[e]?d=c?g/(j-1):(e+1)/(j+1):0===g?d=0:(i=(b-a[g-1])/(a[g]-a[g-1]),d=c?(g-1+i)/(j-1):(g+i)/(j+1))}else d=c?0:1/(j+1);return d}function ab(a,b,c,d){var e,g,h=[];return sb(a,h),e=f(h),0===e||b<h[0]||b>h[e-1]?A:(g=1===e?1:_a(h,b,d),0!==g?x(g*l(10,c))/l(10,c):g)}function bb(a,b,c){var d,e,f,g,h,i=300,j=1e-50,k=1e-20,l=a+b,m=a+1,n=a-1,o=1,p=1-l*c/m;for(u(p)<j&&(p=j),p=1/p,d=p,e=1;e<=i&&(f=e+e,g=(b-e)*e*c/((n+f)*(a+f)),p=1+g*p,u(p)<j&&(p=j),o=1+g/o,u(o)<j&&(o=j),p=1/p,d*=p*o,g=0-(a+e)*(l+e)*c/((a+f)*(m+f)),p=1+g*p,u(p)<j&&(p=j),o=1+g/o,u(o)<j&&(o=j),p=1/p,h=p*o,d*=h,!(u(h-1)<k));e++);return d}function cb(a){var b=[2.2250738585072014e-308,1.7976931348623157e308,l(2,-53),l(2,-52),I.Ek(2,10)];return b[a-1]||0}function db(a,b,c){var d,e=0,f=0;if(b<1)return 0;for(d=1;d<=b;d++)if(e=b-d,f+=u(G(a[e])),f>c)return e;return e}function eb(a,b,c){var d,e,f,g,h;if(c<1||c>1e3||a<-1.1||a>1.1)return NaN;for(d=2*a,f=e=0,g=0,h=1;h<=c;h++)f=e,e=g,g=d*e-f+G(b[c-h]);return.5*(g-f)}function fb(a){var b,c=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],d=db(c,15,cb(3)),e=1/v(cb(3)),f=t(n(w(cb(2)/12),-w(12*cb(1))));return a<10?NaN:a>=f?4.930380657631324e-32:a<e?(b=10/a,eb(b*b*2-1,c,d)/a):1/(12*a)}function gb(a){var b=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-7.71908941348408e-11,1.407574648135907e-11,-2.5769072058024682e-12,4.734240666629442e-13,-8.724901267474264e-14,1.612461490274055e-14,-2.9875652015665774e-15,5.548070120908289e-16,-1.0324619158271569e-16,1.9250239203049852e-17,-3.595507346526515e-18,6.726454253787686e-19,-1.260262416873522e-19,2.364488440860621e-20,-4.4419377050807936e-21,8.354659446403425e-22,-1.5731559416479563e-22,2.9653128740247425e-23,-5.594958348181595e-24,1.056635426883568e-24,-1.9972483680670205e-25,3.778297781883936e-26,-7.153158688908174e-27,1.3552488463674214e-27,-2.5694673048487566e-28,4.8747756066216946e-29,-9.254211253084972e-30,1.757859784176024e-30,-3.341002667773101e-31,6.353393618023618e-32],c=db(b,43,.1*cb(3));return a<=-1?NaN:u(a)<=.375?a*(1-a*eb(a/.375,b,c)):w(a+1)}function hb(a){var b,c,d,e,f,g,h=1,i=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,7.7823e-12,-3.6968e-12,5.1e-13,-2.06e-14,-5.4e-15,1.4e-15];if(a>171)return 1e308;if(a===F(a))if(a>0)for(b=1,e=2;e<a;e++)b*=e;else b=1e308;else{if(u(a)>1){for(d=u(a),f=F(d),h=1,c=1;c<=f;c++)h*=d-c;d-=f}else d=a;for(g=i[24],c=23;c>=0;c--)g=g*d+i[c];b=1/(g*d),u(a)>1&&(b*=h,a<0&&(b=-r/(a*b*p(r*a))))}return b}function ib(a){var b,c,d,e,f,g=0,h=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],i=a;if(a<=0)return 1e308;if(1===a||2===a)return 0;for(a<=7&&(g=F(7-a),i=a+g),c=1/(i*i),d=2*r,e=h[9],b=8;b>=0;b--)e=e*c+h[b];if(f=e/i+.5*w(d)+(i-.5)*w(i)-i,a<=7)for(b=1;b<=g;b++)f-=w(i-1),i-=1;return f}function jb(a,b){var c,d,e,f=d=a;return b<f&&(f=b),b>d&&(d=b),f<0?NaN:0===f?U:f>=10?(c=fb(f)+fb(d)-fb(f+d),w(d)*-.5+.9189385332046728+c+(f-.5)*w(f/(f+d))+d*gb(-f/(f+d))):d>=10?(c=fb(d)-fb(f+d),e=pd(f),M(e)?NaN:G(e)+c+f-f*w(f+d)+(d-.5)*gb(-f/(f+d))):w(hb(f)*(hb(d)/hb(f+d)))}function kb(a,b,c){var d,e,f,g,h,i,j,k,l,p,q,r=cb(3),s=w(r),u=cb(1),v=w(u),x=a,y=b,z=c;if(y/(y+z)<a&&(x=1-x,y=c,z=b),(y+z)*x/(y+1)<r)d=0,f=y*w(m(x,u))-w(y)-jb(y,z),f>v&&0!==x&&(d=t(f)),x===a&&y===b||(d=1-d);else{if(i=z-o(z),0===i&&(i=1),f=y*w(x)-jb(i,y)-w(y),d=0,f>=v&&(d=t(f),e=d*y,1!==i))for(h=F(m(s/w(x),4)),j=1;j<=h;j++)g=j,e=e*(g-i)*x/g,d+=e/(y+g);if(z>1){for(f=y*w(x)+z*w(1-x)-jb(y,z)-w(z),k=F(m(f/v,0)),e=t(f-k*v),l=1/(1-x),p=z*l/(y+z-1),q=0,h=F(z),z===h&&(h-=1),j=1;j<=h&&!(p<=1&&e/r<=q);j++)g=j,e=(z-g+1)*l*e/(y+z-g),e>1&&(k-=1,e*=u),0===k&&(q+=e);d+=q}x===a&&y===b||(d=1-d),d=m(n(d,1),0)}return d}function lb(a){var b,c;return a=.7071067811865475*-a,b=G(a),i(b)?z:(c=Q(b*v(2)),M(c)?NaN:.5*(2-2*c))}function mb(a,b,c,d){var e,f,g,h,i,j,k,l,n,o,p,q,r,s;function t(a,b){return a<0&&b>0||a>0&&b<0}for(e=1e-307,f=2.22045e-16,g=a.ge(b),h=a.ge(c),j=0;j<1e3&&!t(g,h);j++)u(g)<=u(h)?(i=b,b+=2*(b-c),b<0&&(b=0),c=i,h=g,g=a.ge(b)):(i=c,c+=2*(c-b),b=i,g=h,h=a.ge(c));if(0===g)return b;if(0===h)return c;if(!t(g,h))return d.jl=!0,0;for(k=b,l=g,n=c,o=h,p=b,q=g,r=.5*(b+c),s=!0,j=0;j<500&&u(q)>e&&c-b>m(u(b),u(c))*f;)s&&(l!==o&&o!==q&&q!==l?(r=k*q*o/(q-l)/(o-l)+p*o*l/(o-q)/(l-q)+n*l*q/(l-o)/(q-o),s=b<r&&r<c):s=!1),s||(r=.5*(b+c),n=c,o=h,s=!0),k=n,n=p,p=r,l=o,o=q,q=a.ge(r),t(g,q)?(c=p,h=q):(b=p,g=q),s=s&&2*u(q)<=u(o),++j;return p}function nb(a,b){var c,d,e,g,h=f(b);for(c=0;c<h;c++)d=G(b[c]),e=d-a.M,g=e/(a.N+1),a.M+=g,a.Q+=a.N*e*g,a.N++,a.kl+=d}function ob(a){var b,c=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],d=1.000000000190015,e=a,f=a+5.5;for(f-=(a+.5)*w(f),b=0;b<=5;b++)d+=c[b]/++e;return-f+w(2.5066282746310007*d/a)}function pb(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=0===c||1===c?0:t(ob(a+b)-ob(a)-ob(b)+a*w(c)+b*w(1-c)),s=c>=(a+1)/(a+b+2);for(s&&(d=a,a=b,b=d,c=1-c),e=4.450147717014403e-308,f=100,g=a+b,h=a+1,i=a-1,j=1,k=1-g*c/h,u(k)<e&&(k=e),k=1/k,l=k,m=1,n=2;m<=f;m++,n+=2)if(o=m*(b-m)*c/((i+n)*(a+n)),k=1+o*k,u(k)<e&&(k=e),j=1+o/j,u(j)<e&&(j=e),k=1/k,l*=k*j,o=-(a+m)*(g+m)*c/((a+n)*(h+n)),k=1+o*k,u(k)<e&&(k=e),j=1+o/j,u(j)<e&&(j=e),k=1/k,p=k*j,l*=p,u(G(p-1))<5e-324)return q=r*l/a,s?1-q:q;return B}function qb(a,b){var c,d,e,g,h=f(b);for(c=0;c<h;c++)d=b[c],d!==V&&(e=d-a.M,g=e/(a.N+1),a.M+=g,a.Q+=a.N*e*g,a.N++,a.kl+=d)}function rb(a){a.sort(function(a,b){return a-b})}function sb(a,b){var c,d;for(c=0;c<f(a);c++)d=a[c],d!==V&&b.push(d);rb(b)}function tb(a){var b,c=[];for(b=0;b<f(a);b++)sb(a[b],c);return c}function ub(a,b,c){var d,e,f,g,h,i,j,k,m,n,o,p=Math.expm1||function(a){return t(a)-1},q=Math.log1p||function(a){return w(1+a)};return a<=0?0:a>=1?1:1===c?l(a,b):1===b?-p(c*q(-a)):(e=.5-a+.5,f=q(-a),g=a,h=w(a),i=b,j=c,k=a>b/(b+c),k&&(i=c,j=b,g=e,e=a,h=f,f=w(a)),d=vb(g,i,j),d/=i,m=i/(i+j),n=j/(i+j),o=i>1&&j>1&&m<.97&&n<.97?wb(g,i,j)*g*e:t(i*h+j*f-xb(!1,i,j)),d*=o,k&&(d=.5-d+.5),d>1&&(d=1),d<0&&(d=0),d)}function vb(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=2.22045e-16,o=1,p=1,q=1-(b+c)/(b+1)*a;0===q?(d=0,e=1,g=1):(d=1,e=1/q,g=d*e),f=1,h=1,i=5e4,j=!1;do k=b+2*h,l=h*(c-h)*a/((k-1)*k),m=-(b+h)*(b+c+h)*a/(k*(k+1)),o=(d+l*o)*e,p=(q+l*p)*e,d=o+m*d*e,q=p+m*q*e,0!==q&&(e=1/q,f=d*e,j=u(g-f)<u(g)*n),g=f,h+=1;while(h<i&&!j);return g}function wb(a,b,c){var d,e,f,g,h,i,j;return 1===b?1===c?1:2===c?-2*a+2:a<=.01?c+c*t((c-1)*w(1-a))-1:c*l(.5-a+.5,c-1):1===c?2===b?b*a:b*l(a,b-1):a<=0&&!(b<1&&0===a)||a>=1&&!(c<1&&1===a)?0:(d=w(cb(2)),e=w(cb(1)),f=w(a<.1?1+a:1-a),g=w(a),h=(b-1)*g,i=(c-1)*f,j=xb(!1,b,c),h<d&&h>e&&i<d&&i>e&&j<d&&j>e&&h+i<d&&h+i>e?l(a,b-1)*l(.5-a+.5,c-1)/xb(!0,b,c):t(h+i-j))}function xb(a,b,c){var d,e,f,g,h,i,j,k,l,m=c,n=b,o=171.624376956302;return b>c&&(d=m,m=n,n=d),a&&m+n<o?zb(m)/zb(m+n)*zb(n):(e=6.02468004077673,f=e-.5,g=Bb(m),g/=Bb(m+n),g*=Bb(n),h=m+n+f,i=a?g*v(h/(m+f)/(n+f)):w(g)+.5*(w(h)-w(m+f)-w(n+f)),j=n/(m+f),k=m/(n+f),l=-m*w(1+j)-n*w(1+k)-f,a?t(l)*i:l+i)}function yb(a){var b=Bb(a),c=6.02468004077673,d=a+c-.5,e=l(d,a/2-.25);return b*=e,b/=t(d),b*=e,a<=20&&a===I.wk(a)&&(b=x(b)),b}function zb(a){var b,c,d=w(r),e=w(cb(2)),f=171.624376956302;return a>f?B:a>=1?yb(a):a>=.5?yb(a+1)/a:a>=-.5?(b=yb(a+2)-w(a+1)-w(u(a)),b>=e?B:yb(a+2)/(a+1)/a):(c=yb(1-a)+w(u(p(r*a))),c-d>=e?0:c<0&&d-c>e?B:t(d-c)*(p(r*a)<0?-1:1))}function Ab(a){var b=171.624376956302;return a>=b?yb(a):a>=1?w(yb(a)):a>=.5?w(yb(a+1)/a):yb(a+2)-w(a+1)-w(a)}function Bb(a){var b,c,d,e,f=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],g=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(a<=1)for(b=f[12],c=g[12],d=11;d>=0;--d)b*=a,b+=f[d],c*=a,c+=g[d];else for(e=1/a,b=f[0],c=g[0],d=1;d<=12;++d)b*=e,b+=f[d],c*=e,c+=g[d];return b/c}function Cb(a,b){return a<=0?0:Db(b/2,a/2)}function Db(a,b){var c=a*w(b)-b-Ab(a),d=t(c);return b>a+1?1-d*Fb(a,b):d*Eb(a,b)}function Eb(a,b){var c=.5*cb(3),d=a,e=1/a,f=e,g=1;do d+=1,e=e*b/d,f+=e,g+=1;while(e/f>c&&g<=1e4);return g>1e4?z:f}function Fb(a,b){var c=cb(3),d=.5*c,e=1/c,f=0,g=0,h=1-a,i=b+2-a,j=0,k=b+1,l=1,m=1,n=i*b,o=b,p=k/n,q=!1,r=0;do f+=1,h+=1,g=h*f,i+=2,j=k*i-l*g,m=n*i-o*g,0!==m&&(r=j/m,q=u((p-r)/r)<=d,p=r),l=k,k=j,o=n,n=m,u(j)>e&&(l*=c,k*=c,o*=c,n*=c);while(!q&&f<1e4);return q?p:z}function Gb(a,b){var c,d;if(a<=0)return 0;if(b*a>1391e3)c=t((.5*b-1)*w(.5*a)-.5*a-w(2)-Ab(.5*b));else{for(b%2<.5?(c=.5,d=2):(c=1/v(2*a*r),d=1);d<b;)c*=a/d,d+=2;c=a>=1425?t(w(c)-a/2):c*t(-a/2)}return c}function Hb(a,b,c,d){var e,f,g,h=J(c,a);return M(h)?h:(e=G(h),h=J(d-c,b-a),M(h)?h:(f=G(h),h=J(d,b),M(h)?h:(g=G(h),D(e*f/g))))}function Ib(a,b,c){var d,e,f=ub(b/(b+a*a),b/2,.5);switch(c){case 1:return.5*f;case 2:return f;case 3:return l(1+a*a/b,-(b+1)/2)/(v(b)*xb(!0,.5,b/2));case 4:return d=b/(a*a+b),e=.5*ub(d,.5*b,.5),a<0?e:1-e}return z}function Jb(a,b,c){return{ge:function(d){return a-Ib(d,b,c)}}}function Kb(a,b,c){var d={jl:!1},e=Jb(a,b,c),f=mb(e,.5*b,b,d);return d.jl?A:f}function Lb(a,b){var c=!1,d=0,e,g,h,i,j;for(g=0;g<f(b);g++)for(j=b[g],h=0;h<f(j);h++)if(i=j[h],L(i)||R(i)||S(i))e=S(i)?0:G(i),(!c||a&&e>d||!a&&e<d)&&(d=e),c=!0;else if(M(i))return i;return d}function Mb(a,b,c,d){var e,g,h,i=0,j=0,k=0;for(e=0;e<f(b);e++)g=b[e],g!==V&&(g<c?i++:c<g?k++:j++);return 0===j?A:(h=(0===d?k:i)+1,a?h:h+(j-1)/2)}function Nb(a,b,c){var d,h,i,j,k,l,m,n;for(i=0;i<f(a);i++)for(k=a[i],l=!!k.isArray,m=!!k.isReference,j=0;j<f(k);j++)if(h=k[j],h!==g)if(S(h)){if(e.ExcelCompatibleCalcMode){if(l)continue;if(m){b.n++;continue}}if(n={value:0},e.Convert.Th(h,n))d=n.value,b.ll+=d,b.ml+=d*d;else if(!k.isArray&&!k.isReference)return z;b.n++}else{if(M(h))return h;!L(h)||c&&"boolean"==typeof h&&k.isArray||(d=G(h),b.ll+=d,b.ml+=d*d,b.n++)}}function Ob(a,b,c,d){var e,f={ll:0,ml:0,n:0},g=Nb(a,f,d);return M(g)?g:f.n<=b?y:(e=m(0,(f.n*f.ml-f.ll*f.ll)/(f.n*(f.n-b))),e=c?v(e):e,D(e))}function Pb(a,b,c){var d,e,g,h,i,j=0,k=0,l=0,m=0,n=f(b);if(n!==f(c))return A;for(g=0;g<n;g++)d=b[g],e=c[g],d!==V&&e!==V&&(j+=d,k+=e,m++);if(m<=1)return y;for(h=j/m,i=k/m,g=0;g<n;g++)d=b[g],e=c[g],d!==V&&e!==V&&(l+=(d-h)*(e-i));return D(a?l/m:l/(m-1))}function Qb(a,b){var c,d,e,g,h=a?1:0,i=0;for(e=0;e<f(b);e++)for(c=b[e],g=0;g<f(c);g++)if(d=c[g],d!==V){if(d<=0)return B;h=a?h*d:h+1/d,i++}return a?i<=0?y:D(l(h,1/i)):0===h?y:D(i/h)}function Rb(a,b,c,d,f){var i,j,k,l,m,n,o,p,q,r,s,u,x,y,z,C,D,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=b.rowCount,Z=b.colCount;if(a?c=c!==h?E(c,1,!1,!0,!0):b:(i=c!==h?c:function(a,b){var c=[];for(j=0;j<a;j++)for(c[j]=[],k=0;k<b;k++)c[j][k]=j*b+k+1;return new e.CalcArray(c)}(Y,Z),c=E(i,1,!1,!0,!0)),l=c.rowCount,m=c.colCount,Y===l&&Z===m&&(d||!f)){for(p=a?l*m:G(l*m),F=0,H=0,I=0,J=0,K=0,L=void 0,j=0;j<l;j++)for(k=0;k<m;k++)q=c[j][k],r=b[j][k],a&&(r=w(r)),F+=q,H+=q*q,I+=r,J+=r*r,K+=q*r;return z=p*H-F*F,o=d?(p*K-F*I)/z:K/H,L=d?(I*H-F*K)/z:0,a&&(o=t(o),L=t(L)),x=[[o,L]],f&&(x[1]=[],x[2]=[],x[3]=[],x[4]=[],M=p*H-F*F,N=p*J-I*I,O=p*K-F*I,P=J-L*I-o*K,Q=O*O/(M*N),p<3?(x[1][0]=B,x[1][1]=B,x[2][1]=B,x[3][0]=B):(x[1][0]=v(P*p/(M*(p-2))),x[1][1]=v(P*H/(M*(p-2))),x[2][1]=v((N-O*O/M)/(p*(p-2))),x[3][0]=1===Q?B:Q*(p-2)/(1-Q)),x[2][0]=Q,x[3][1]=p-2,x[4][0]=N/p-P,x[4][1]=P),new e.CalcArray(x)}if(1===Z&&Y===l||1===Y&&Z===m){for(r=[],q=[],z=1===Z,p=l,o=m,j=0;j<p;j++)r[j]=d?b[j][0]:b[0][j],a&&(r[j]=w(r[j]));for(j=0;j<p;j++)for(q[j]=[],k=0;k<o;k++)q[j][k]=z?c[j][k]:c[k][j];for(R=[],n=0;n<o+1;n++)R[n]=[];for(s=0;s<o+1;s++)for(u=0;u<o+2;u++)R[s][u]=0;for(S=[],s=0;s<o+2;s++)S[s]=0;for(T=f?[]:g,n=0;n<p;n++)for(S[o+1]+=r[n]*r[n],R[0][o+1]+=r[n],S[0]=R[0][o+1],j=0;j<o;j++)for(R[0][j+1]+=q[n][j],R[j+1][0]=R[0][j+1],R[j+1][o+1]+=q[n][j]*r[n],S[j+1]=R[j+1][o+1],k=j;k<o;k++)R[k+1][j+1]+=q[n][j]*q[n][k],R[j+1][k+1]=R[k+1][j+1];if(R[0][0]=p,f){for(s=0;s<o+1;s++)for(T[s]=[],u=0;u<o+1;u++)T[s][u]=0;for(j=0;j<o+1;j++)T[j][j]=1}for(U=d?0:1,j=0;j<o+1;j++){if(0===R[j][j]){for(y=!1,k=j+1;!y&&k<o+1;k++)if(0!==R[k][j]){for(n=0;n<o+2;n++)z=R[j][n],R[j][n]=R[k][n],R[k][n]=z;if(f)for(n=0;n<o+1;n++)z=T[j][n],T[j][n]=T[k][n],T[k][n]=z;y=!0}if(!y)return B}for(C=1/R[j][j],n=U;n<o+2;n++)R[j][n]*=C;if(f)for(n=U;n<o+1;n++)T[j][n]*=C;for(k=U;k<o+1;k++)if(k!==j){for(C=-R[k][j],n=U;n<o+2;n++)R[k][n]+=C*R[j][n];if(f)for(n=U;n<o+1;n++)T[k][n]+=C*T[j][n]}d||(R[0][o+1]=0)}for(x=a?[[],o+1]:[[]],j=0;j<o+1;j++)x[0][j]=a?t(R[o-j][o+1]):R[o-j][o+1];if(f){if(a)x[1]=[],x[2]=[],x[3]=[],x[4]=[];else for(s=1;s<5;s++)for(x[s]=[],u=0;u<o+1;u++)x[s][u]=0;for(V=void 0,W=void 0,X=void 0,W=S[o+1]-S[0]*S[0]/p,V=S[o+1],j=0;j<o+1;j++)V-=R[j][o+1]*S[j];if(X=W-V,x[2][0]=0===W?B:X/W,x[4][0]=X,x[4][1]=V,z=d?p-o-1:p-o,0===z){for(j=0;j<o+1;j++)x[1][j]=B;x[2][1]=B}else{for(D=V/G(z),d||(x[1][o]=A),j=U;j<o+1;j++)x[1][o-j]=v(D*T[j][j]);x[2][1]=v(D)}for(x[3][0]=0===V?B:G(z)*X/(V*G(o)),x[3][1]=G(z),j=2;j<5;j++)for(k=2;k<o+1;k++)x[j][k]=A}return new e.CalcArray(x)}return B}function Sb(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=[];for(e=0;e<f(b);e++)for(h=b[e],l.push(h),g=0;g<f(h);g++)c=h[g],c!==V&&(i+=c,k++);for(d=i/k,e=0;e<f(b);e++)for(h=l[e],g=0;g<f(h);g++)c=h[g],c!==V&&(j+=a?(c-d)*(c-d):u(c-d));return a?D(j):0===k?y:D(j/k)}function Tb(a,b,c,f){b=b!==h?E(b,0,!1,!0,!1):a,c=c!==h?E(c,0,!1,!0,!1):b;var g,i;for(g=0;g<a.rowCount;g++)for(i=0;i<a.colCount;i++)if(!L(a[g][i]))return z;for(g=0;g<b.rowCount;g++)for(i=0;i<b.colCount;i++)if(!L(b[g][i]))return z;for(g=0;g<c.rowCount;g++)for(i=0;i<c.colCount;i++)if(!L(c[g][i]))return z;return d.Common.qc(a,b,c,f,G,e.CalcArray,z,A)}function Ub(a,b,c,f){return b=b!==h?E(b,1,!1,!0,!0):a,c=c!==h?E(c,1,!1,!0,!0):b,d.Common.sc(a,b,c,f,e.CalcArray,B,A)}function Vb(a,b,c){var d,e,g,h,i,j=0,k=0,l=0,m=0,n=f(b),o=0;if(n!==f(c))return A;for(d=0;d<n;d++)e=b[d],g=c[d],e!==V&&g!==V&&(j+=e,k+=g,l+=g*g,m+=g*e,o++);return 0===o?y:o*l-k*k===0?y:(h=(o*m-k*j)/(o*l-k*k),i=j/o-h*(k/o),D(i+h*a))}function Wb(){return N(arguments,2,1)}function Xb(){return O(arguments,2,7)}function Yb(a,b){return P([a,b],16)}function Zb(){return N(arguments,2,4)}function $b(){return Lb(!0,arguments)}function _b(){return N(arguments,2,5)}function ac(){return Lb(!1,arguments)}function bc(a,b){return P([a,b],14)}function cc(a,b){return P([a,b],15)}function dc(){var a,b,c,d,e=arguments,h=0,i=0;for(a=0;a<f(e);a++)for(d=e[a],b=0;b<f(d);b++)c=d[b],L(c,!0)||R(c)?(h+=G(c),i++):(c===g||S(c))&&i++;return 0===i?y:D(h/i)}function ec(a,b,c,d){var e,g,i,j,k,l,m,n,p,q,r,s,t,u,v,w=c,x=c!==h&&H(c);if(c!==h){if(a=E(a,0,!0,!1,!1),c=E(c,1,!0,!1,!1,!0,h,!0),c.isError)return c[0]}else{if(a=E(a,1,!0,!1,!1,!0,h,!0),a.isError)return a[0];c=a}if(e=0,g=0,i=K(b),a.rowCount!==c.rowCount||a.colCount!==c.colCount)return z;for(q=a.rowCount,x&&(j=d.row,k=d.column,l=w.getRow(0),m=w.getColumn(0),n=d.source.getCalcSourceModel().qg(j,k),p=w.getSource(),x=n&&p.getRangeKey),r=0;r<f(a);r++)if(s=a[r],i&&i(s,!0)&&(t=c[r],x&&(u={id:p.id,row:l+r%q,col:m+o(r/q),rowCount:1,colCount:1},v=p.getRangeKey(p,u),n.eOb||(n.eOb={}),n.eOb[v]=u),t!==V)){if(M(t))return t;e+=t,g++}return 0===g?y:D(e/g)}function fc(a,b,c,d,f){var g,h,i,j=b,k=b,l=a?j.getRowCount():k.getRowCount(0),m=a?j.getColumnCount():k.getColumnCount(0),n=[];for(g=0;g<l;g++)for(n[g]=[],h=0;h<m;h++)i=a?j.getValue(g,h):k.getValue(0,g,h),n[g][h]=ec(c,i,d,f);return new e.CalcArray(n)}function gc(a,b,c,d){return e.Convert.Fh(c)?fc(!1,c,b,d,a):e.Convert.Ca(c)?fc(!0,c,b,d,a):ec(b,c,d,a)}function hc(){return P(arguments,12)}function ic(){return P(arguments,13)}function jc(){return Qb(!0,arguments)}function kc(){return Qb(!1,arguments)}function lc(a,b){var c,d,e,f=0,g=[];for(sb(a,g),c=Za(g),d=k(""+c*b/2),e=d;e<c-d;e++)f+=G(g[e]);return f/(c-2*d)}function mc(a,b){var c,d,f,g,h,i,j,k,l,m,n,o,p=0,q=b.rowCount,r=b.colCount;for(c=0;c<q;c++)for(d=0;d<r;d++)b[c][d]!==V&&p++;for(g=a.rowCount,h=a.colCount,i=[],j=[],k=p+1,p=0,c=0;c<q;c++)for(d=0;d<r;d++)f=b[c][d],f!==V&&(i[p++]=G(f));for(l=i.slice(0),rb(i),c=0;c<k;c++)j[c]=[0];for(c=0;c<g;c++)for(d=0;d<h;d++)if(f=a[c][d],L(f)){for(m=G(f),n=!1,o=0;!n&&o<p;o++)m<=i[o]&&(j[l.indexOf(i[o])][0]++,n=!0);n||j[p][0]++}return new e.CalcArray(j)}function nc(a,b,c){var d=e.CalcArrayHelper;if(e.Convert.Fh(a)){if(1!==d.getLength(a))return z;a=d.getValueByIndex(a,0)}return a=G(a),i(a)?z:Mb(!0,b,a,c)}function oc(){var a,b,c,d,e,g,h=arguments,i=0,j=0,k=0,m=0,n=f(h),o=[];if(n>0){for(g=h[0],o.push(g),d=0;d<f(g);d++)a=g[d],a!==V&&(i+=a,j+=a*a,m++);if(m<=3)return y;if(b=i/m,c=v((m*j-i*i)/(m*(m-1))),0===c)return y;for(e=0;e<n;e++)for(g=o[e],d=0;d<f(g);d++)a=g[d],a!==V&&(k+=l((a-b)/c,4));return D(m*(m+1)*k/((m-1)*(m-2)*(m-3))-3*(m-1)*(m-1)/((m-2)*(m-3)))}}function pc(a,b,c){return ab(a,b,c,!0)}function qc(a,b,c){return ab(a,b,c,!1)}function rc(a,b){return P([a,b],17)}function sc(){return N(arguments,2,2)}function tc(){return N(arguments,2,3)}function uc(a){var b,c=0;for(b=0;b<f(a);b++)a[b]!==g&&""!==a[b]||c++;return c}function vc(a,b){var c,d,e=0,h=0===b||"*"===b,i=K(b);for(c=0;c<f(a);c++)d=a[c],h&&d===g||!i||!i(d)||e++;return D(e)}function wc(a,b){var c,d,f,g,h,j,k,l,m;if(b.isArray||b.isReference){for(c=void 0,d=void 0,f=0,g=[],h=b.rowCount,j=b.colCount,k=0;k<h;k++){for(l=[],m=0;m<j;m++,f++)d=vc(a,b[f]),M(d)?l.push(d):(c=G(d),i(c)?l.push(z):l.push(c));g.push(l)}return new e.CalcArray(g)}return vc(a,b[0])}function xc(){return Sb(!1,arguments)}function yc(){return Ob(arguments,1,!0,!0)}function zc(){return O(arguments,2,8)}function Ac(){return Ob(arguments,0,!0,!1)}function Bc(){return O(arguments,2,10)}function Cc(){return Ob(arguments,1,!1,!1)}function Dc(){return O(arguments,2,11)}function Ec(){return Ob(arguments,0,!1,!1)}function Fc(a,b){return Pb(!0,a,b)}function Gc(){return Sb(!0,arguments)}function Hc(a,b,c){var d=xd(a/2);return M(d)?d:-G(d)*(b/v(c))}function Ic(a,b,c){return 1===c?y:b*Kb(a,c-1,2)/v(c)}function Jc(a,b){var c,d,e,g,h=0,i=0,j=0,k=0,l=0,m=f(a);if(m!==f(b))return A;for(g=0;g<m;g++)c=a[g],d=b[g],d!==V&&c!==V&&(h+=c,i+=d,j+=d*d,k+=d*c,l++);return 0===l?y:l*j-i*i===0?y:(e=(l*k-i*h)/(l*j-i*i),D(h/l-e*(i/l)))}function Kc(a,b,c,d){return Rb(!1,a,b,c,d)}function Lc(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=0,m=0,n=f(b);if(n!==f(a))return A;for(c=0;c<n;c++)d=a[c],e=b[c],e===V||d===V||M(e)||M(d)||(g=G(d),h=G(e),i+=g,j+=h,k+=h*h,l+=h*g,m++);return m*k-j*j===0?y:D((m*l-j*i)/(m*k-j*j))}function Mc(a,b,c,d){return Rb(!0,a,b,c,d)}function Nc(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=0,m=0,n=0,o=f(a);if(o!==f(b))return A;for(e=0;e<o;e++)g=a[e],h=b[e],g!==V&&h!==V&&(d=g,c=h,i+=d,j+=d*d,k+=c,l+=c*c,m+=c*d,n++);return n*(n-2)===0||n*l-k*k===0?y:v((n*j-i*i-(n*m-k*i)*(n*m-k*i)/(n*l-k*k))/(n*(n-2)))}function Oc(a){var b,c=a,d=c+5.5;return d-=(c+.5)*w(d),b=1.000000000190015+76.18009172947146/(a+1),b-=86.50532032941678/(a+2),b+=24.01409824083091/(a+3),b-=1.231739572450155/(a+4),b+=.001208650973866179/(a+5),b-=5395239384953e-18/(a+6),w(2.506628274631001*b/c)-d}function Pc(a,b,c,d,e){var f,g,h,i,j,k,l,m;return a<d||e<a||d===e?B:(f=(a-d)/(e-d),g=Oc(b+c),h=Oc(b),i=Oc(c),j=w(f),k=w(1-f),l=t(g-h-i+b*j+c*k),m=f<(b+1)/(b+c+2)?l*bb(b,c,f)/b:1-l*bb(c,b,1-f)/c,D(m))}function Qc(a,b,c,d,e,f){if(a<e||f<a||e===f)return B;var g=(a-e)/(f-e);return d?ub(g,b,c):wb(g,b,c)/(f-e)}function Rc(a,b,c,d,e){var f,g,h,i,j,k,n,o,p,q,r,s,x,y,z,A,B,C,E,F=2.30753,G=.27061,H=.99229,I=.04481,J=3e-308,K=1e-300,L=J,M=1-2.22e-16,N=5,O=6,P=2,Q=jb(b,c);for(a<=.5?(i=a,o=b,q=c,f=0):(i=1-a,o=c,q=b,f=1),r=v(-w(i*i)),A=r-(F+G*r)/(1+(H+I*r)*r),o>1&&q>1?(r=(A*A-3)/6,s=1/(o+o-1),x=1/(q+q-1),n=2/(s+x),z=A*v(n+r)/n-(x-s)*(r+N/O-P/(3*n)),E=o/(o+q*t(z+z))):(r=q+q,x=1/(9*q),x=r*l(1-x+A*v(x),3),x<=0?E=1-t((w((1-i)*q)+Q)/q):(x=(4*o+r-P)/x,E=x<=1?t((w(i*o)+Q)/o):1-P/(x+1))),r=1-o,x=1-q,B=0,j=1,E<L?E=L:E>M&&(E=M),C=m(K,l(10,-13-2.5/(o*o)-.5/(i*i))),y=p=0,g=0;g<1e3;g++){for(A=kb(E,o,q),A=(A-i)*t(Q+r*w(E)+x*w(1-E)),A*B<=0&&(p=m(u(j),J)),k=1,h=0;h<1e3;h++){if(j=k*A,u(j)<p&&(y=E-j,y>=0&&y<=1)){if(p<=C)return 0!==f&&(E=1-E),D((e-d)*E+d);if(u(A)<=C)return 0!==f&&(E=1-E),D((e-d)*E+d);if(0!==y&&1!==y)break}k/=3}if(y===E)return 0!==f&&(E=1-E),D((e-d)*E+d);E=y,B=A}return 0!==f&&(E=1-E),D((e-d)*E+d)}function Sc(a,b,c){var d,e,f,g;if(2*a>b)return Sc(b-a,b,1-c);for(d=0,e=0,f=0,g=1;d<a||e<a||f<b-a;)d<a&&g<1?(d++,g*=(b-a+d)/d):e<a?(e++,g*=c):(f++,g*=1-c);return g}function Tc(a,b,c,d){return d*(b-a)/(a+1)*c/(1-c)}function Uc(a,b,c,d){return d*a/(b-a+1)*(1-c)/c}function Vc(a,b,c,d){var e,f,g,h,i,j,k,l;if(0===c&&d===a)return 1;if(0===b)return 0===c?1:0;if(1===b)return d===a?1:0;if(c===d)return Sc(c,a,b);if(e=Math.floor(a*b),c<=e&&d>=e?(f=e,g=Sc(f,a,b)):(h=Sc(c,a,b),i=Sc(d,a,b),h>i?(f=c,g=h):(f=d,g=i)),0===g)return 0;for(j=g,k=g,l=f;l<d&&(k=Tc(l,a,b,k),0!==k);l++)j+=k;for(k=g,l=f;l>c&&(k=Uc(l,a,b,k),0!==k);l--)j+=k;return j}function Wc(a,b,c,d){return b<a?B:d?Vc(b,c,0,a):Sc(a,b,c)}function Xc(a,b,c){if(a+b-1<=0)return B;var d=J(a+b-1,b-1);return M(d)?d:D(G(d)*l(c,b)*l(1-c,a))}function Yc(a,b,c,d){if(a+b-1<=0)return B;if(d)return 1-ub(1-c,a+1,b);var e=l(c,b),f;for(f=0;f<a;f++)e*=(f+b)/(f+1)*(1-c);return e}function Zc(a,b,c){for(var d,e,f=0,g=a;f+1<g;)d=o((f+g)/2),e=Vc(a,b,0,d),e>=c?g=d:f=d;return g}function $c(a,b){var c,d,e,f,g,h,i=w(v(r)),j=1/v(r),k=0,l=a,m=.5*l,n=b%2===0;if(b>1&&(k=t(-m)),g=Q(-v(l)),M(g))return g;if(h=G(g),d=n?k:2*h,b>2){if(l=.5*(b-1),e=n?1:.5,m>20){for(c=n?0:i,f=w(m);e<=l;)c=w(e)+c,d+=t(f*e-m-c),e+=1;return d}for(c=n?1:j/v(m),f=0;e<=l;)c*=m/e,f+=c,e+=1;return f*k+d}return d}function _c(a,b,c){return c?Cb(a,b):Gb(a,b)}function ad(a,b){var c=od(1-a,.5*b,2);return G(c)}function bd(a,b){return{ge:function(c){return a-Cb(c,b)}}}function cd(a,b){var c=bd(a,b),d={jl:!1},e=mb(c,.5*b,b,d);return d.jl?A:e}function dd(a,b){var c,d,e,g,h=0,i=a.rowCount,j=a.colCount;if(i!==b.rowCount||j!==b.colCount)return A;if(i>1&&j>1)c=(i-1)*(j-1);else if(i>1&&1===j)c=i-1;else{if(!(1===i&&j>1))return A;c=j-1}for(d=0;d<f(a);d++)if(e=a[d],g=b[d],e!==V&&g!==V){if(0===g)return y;h+=(e-g)*(e-g)/g}return h<0?B:$c(h,c)}function ed(a,b){var c,d,g,h,i,j,k,l,m=e.ExcelCompatibleCalcMode?5:1,n=E(a,m,!0,!1,!1,!0),o=E(b,m,!0,!1,!1,!0),p=0,q=0,r=0,s=0,t=0,u=f(o);if(u!==f(n))return A;for(i=0,j=0;j<u;j++){if(k=n[j],l=o[j],M(k))return k;if(M(l))return l;k!==V&&l!==V&&(p+=k,q+=l,r+=k*k,s+=l*l,i++)}if(i<=1)return y;if(c=p/i,d=q/i,g=v((i*r-p*p)/(i*(i-1))),h=v((i*s-q*q)/(i*(i-1))),0===g||0===h)return y;for(j=0;j<u;j++)k=n[j],l=o[j],k!==V&&l!==V&&(t+=(k-c)*(l-d));return D(t/G((i-1)*g*h))}function fd(a,b,c){var d=t(-b*a);return D(c?1-d:b*d)}function gd(a,b,c){var d=b*a/(b*a+c),e=.5*b,f=.5*c,g=Pc(d,e,f,0,1);return M(g)?g:1-G(g)}function hd(a,b,c,d){if(d){var e=ub(c/(c+b*a),c/2,b/2);return 1-e}return l(b/c,b/2)*l(a,b/2-1)/(l(1+a*b/c,(b+c)/2)*xb(!0,b/2,c/2))}function id(a,b,c){var d=1-a,e=Rc(1-d,c/2,b/2,0,1);return M(e)?e:(1/G(e)-1)*(c/b)}function jd(a,b,c){var d=1-a,e=Rc(d,c/2,b/2,0,1);return M(e)?e:(1/G(e)-1)*(c/b)}function kd(a){return w((1+a)/(1-a))/2}function ld(a){var b=t(2*a)-1,c=t(2*a)+1;return!j(b)&&b>0&&!j(c)&&c>0?1:b/c}function md(a,b){var c,d,e,f,g,h,i={N:0,M:0,Q:0,kl:0};return qb(i,a),f=i.N-1,1===i.N?y:(c=i.Q/(i.N-1),0===c?y:(i.N=0,i.M=0,i.Q=0,i.kl=0,qb(i,b),g=i.N-1,1===i.N?y:(d=i.Q/(i.N-1),0===d?y:(h=gd(c/d,f,g),M(h)?h:(e=2*(1-G(h)),e>1&&(e=2-e),e)))))}function nd(a,b,c,d){var e,f,g,h,k,m,o,p,q,r,s,x,z,A,C,D,E,F,H,I,J,K,L,N;if(d===!1)return e=l(c,b),i(e)||!j(e)?y:(f=1/(e*hb(b)),g=l(a,b-1),h=t(-(a/c)),k=g*h,f*k);if(I=1/3,J=1e8,K=1e37,L=1e3,N=-88,a/=c,a<=0)return B;if(b>L)return m=3*v(b)*(l(a/b,I)+1/(9*b)-1),H=vd(m,0,1,!0),M(H)?H:G(H);if(a>J)return 1;if(a<=1||a<b){if(H=pd(b+1),M(H))return H;x=b*w(a)-a-G(H),z=1,F=1,C=b;do C+=1,z=z*a/C,F+=z;while(z>2.220446049250313e-16);x+=w(F),F=0,x>=N&&(F=t(x))}else{if(H=pd(b),M(H))return H;for(x=b*w(a)-a-G(H),C=1-b,D=C+a+1,z=0,m=1,o=a,p=a+1,q=a*D,F=p/q;;){if(C+=1,D+=2,z+=1,E=C*z,r=D*p-E*m,s=D*q-E*o,u(s)>0){if(A=r/s,u(F-A)<=n(2.220446049250313e-16,2.220446049250313e-16*A))break;F=A}m=p,o=q,p=r,q=s,u(r)>=K&&(m/=K,o/=K,p/=K,q/=K)}x+=w(F),F=1,x>=N&&(F=1-t(x))}return F}function od(a,b,c){var d,e,f,g,h,i,j,k,m,n,o,p,q,r,s,x,y,z,A,B=4.67,C=6.66,D=6.73,E=13.32,F=60,H=70,I=84,J=105,K=120,L=127,N=140,O=1175,P=210,Q=252,R=2264,S=294,T=346,V=420,W=462,X=606,Y=672,Z=707,$=735,_=889,aa=932,ba=966,ca=1141,da=1182,ea=1278,fa=1740,ga=2520,ha=5040,ia=5e-7,ja=.01,ka=5e-7,la=20,ma=2e-6,na=.999998;if(a<ma)return 0;if(a>na)return U;if(j=2*b,f=b-1,A=pd(b),M(A))return A;if(h=G(A),j<-1.24*w(a)){if(g=l(a*b*t(h+.6931471805599453*b),1/b),g<ia)return NaN}else if(j>.32){if(A=wd(a,0,1),M(A))return A;y=G(A),i=.222222/j,g=j*l(y*v(i)+1-i,3),g>2.2*j+6&&(g=-2*(w(1-a)-f*w(.5*g)+h))}else{g=.4,d=w(1-a)+h+.6931471805599453*f;do m=g,i=1+g*(B+g),k=g*(D+g*(C+g)),x=-.5+(B+2*g)/i-(D+g*(E+3*g))/k,g-=(1-t(d+.5*g)*k/i)/x;while(u(m/g-1)>ja)}for(z=1;z<=la;z++){if(m=g,i=.5*g,A=nd(i,b,1,!0),M(A))return A;if(k=a-G(A),x=k*t(.6931471805599453*b+h+i-f*w(g)),e=x/g,d=.5*x-e*f,n=(P+d*(N+d*(J+d*(I+d*(H+F*d)))))/V,o=(V+d*($+d*(ba+d*(ca+ea*d))))/ga,p=(P+d*(W+d*(Z+aa*d)))/ga,q=(Q+d*(Y+da*d)+f*(S+d*(_+fa*d)))/ha,r=(I+R*d+f*(O+X*d))/ga,s=(K+f*(T+L*f))/ha,g+=x*(1+.5*x*n-e*f*(n-e*(o-e*(p-e*(q-e*(r-e*s)))))),u(m/g-1)>ka)return.5*c*g}return.5*c*g}function pd(a){return ib(a)}function qd(a,b,c,d){return a>n(b,c)||a<m(0,b-d+c)||b>d||c>d?B:Hb(a,b,c,d)}function rd(a,b,c,d,e){var f,g;if(a>n(b,c)||a<m(0,b-d+c)||b>d||c>d)return B;if(e){for(f=0,g=0;g<=a;g++)f+=Hb(g,b,c,d);return f}return Hb(a,b,c,d)}function sd(a,b,c){return Q((w(a)-b)/c)}function td(a,b,c,d){if(d)return Q((w(a)-b)/c);var e=(w(a)-b)/c;return.3989422804014327*t(-(e*e)/2)/c/a}function ud(a,b,c){var d,e=xd(a);return M(e)?e:(d=G(e),D(t(b+c*d)))}function vd(a,b,c,d){return d?Q((a-b)/c):D(t(-((a-b)*(a-b))/(2*c*c))/(v(2*r)*c))}function wd(a,b,c){var d,e,f,g,h,i=a-.5;if(u(i)<=.42)d=i*i,e=i*(((-25.44106049637*d+41.39119773534)*d-18.61500062529)*d+2.50662823884)/((((3.13082909833*d-21.06224101826)*d+23.08336743743)*d+-8.4735109309)*d+1);else{if(d=a,i>0&&(d=1-a),!(d>2.220446049250313e-16))return d>1e-300?(e=-2*w(a),d=w(6.283185307179586*e),d=d/e+(2-d)/(e*e)+(-14+6*d-d*d)/(2*e*e*e),e=v(e*(1-d)),i<0?-e:e):i<0?-U:U;d=v(-w(d)),e=(((2.32121276858*d+4.85014127135)*d-2.29796479134)*d-2.78718931138)/((1.63706781897*d+3.54388924762)*d+1),i<0&&(e=-e)}return f=(e-0)/1,g=.3989422804014327*t(-.5*f*f)/1,h=vd(e,0,1,!0),M(h)?h:(e-=(h-a)/g,b+c*e)}function xd(a){return wd(a,0,1)}function yd(a,b){return b?lb(a):t(-l(a,2)/2)/v(2*r)}function zd(a,b){var c,d,e,g,h=0,i=0,j=0,k=0,l=0,m=f(a);if(m!==f(b))return A;for(c=0,d=0;d<m;d++)e=a[d],g=b[d],T(e)&&T(g)&&(h+=e,
i+=g,j+=e*e,k+=g*g,l+=e*g,c++);return c*j-h*h===0||c*k-i*i===0?y:(c*l-h*i)/v((c*j-h*h)*(c*k-i*i))}function Ad(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=0,m=0,n=0,o=f(b);if(o!==f(a))return A;for(c=0;c<o;c++)d=b[c],e=a[c],T(d)&&T(e)&&(i+=d,j+=e,k+=d*d,l+=e*e,m+=d*e,n++);return g=v((n*k-i*i)*(n*l-j*j)),0===g?y:(h=(n*m-i*j)/g,D(h*h))}function Bd(a,b,c){var d,f=0;if(c)for(d=0;d<=a;d++)f+=t(-b)*l(b,d)/e.Functions.tk(d);else f=t(-b)*l(b,a)/e.Functions.tk(a);return D(f)}function Cd(a,b,c,d){var e,g,j,k,l,m,n=c;if(d!==h&&(n=G(d),i(n)))return z;if(e=0,g=0,j=f(a),j!==f(b))return A;for(k=0;k<j;k++)if(l=a[k],m=b[k],l!==V&&m!==V){if(m<=0||1<m)return B;c<=l&&l<=n&&(e+=m),g+=m}return 1!==g?B:e}function Dd(){var a,b,c,d,e,g,h=arguments,i=0,j=0,k=0,m=0,n=[];for(c=0;c<f(h);c++)for(g=h[c],n.push(g),d=0;d<f(g);d++)e=g[d],e!==V&&(i+=e,j+=e*e,m++);if(m<=2)return y;if(a=i/m,b=v((m*j-i*i)/(m*(m-1))),0===b)return y;for(c=0;c<f(n);c++)for(g=n[c],d=0;d<f(g);d++)e=g[d],e!==V&&(k+=l((e-a)/b,3));return D(m*k/((m-1)*(m-2)))}function Ed(){var a,b,c,d,e,g,h,i,j,k,m=arguments,n=0,o=0,p=[];for(c=0;c<f(m);c++){if(g=m[c],1===f(m)&&0===f(g))return C;for(d=0;d<f(g);d++)e=g[d],h={value:0},e!==V&&"boolean"!=typeof e&&X(e,h)&&(n+=h.value,o++,p.push(h.value))}if(o<=2)return y;for(a=n/o,i=0,j=0,k=0,c=0;c<p.length;c++)k=p[c]-a,j+=l(k,2),i+=l(k,3);return b=v(j/o),0===b?y:D(i/o/b/b/b)}function Fd(a,b,c){return(a-b)/c}function Gd(a,b,c){var d,e,f,g,h,i,j,k,l,m;if(1!==c&&2!==c)return B;if(d=b,e=a/v(d),f=d/(d+a*a),g=d-2,h=d%2,i=1,j=1,d=1,k=2+h,l=k,g>=2)for(m=F(k);m<=g&&(j=j*f*(l-1)/l,i+=j,i!==d);m+=2)d=i,l+=2;return 1!==h?c*(1-(.5+.5*e*v(f)*i)):(1===b&&(i=0),c*(1-(.5+.3183098862*(e*f*i+s(e)))))}function Hd(a,b,c){return Ib(a,b,c?4:3)}function Id(a,b){return Gd(a,b,1)}function Jd(a,b){return Gd(a,b,2)}function Kd(a,b){var c,d,e,f,g,h,i,j,k,m,n,o=1e-12,p=a/2,r=p;if(b>1e20)return xd(p);if(r<.5?(m=0,h=2*r):(m=1,h=2*(1-r)),u(b-2)<o)i=h>0?v(2/(h*(2-h))-2):U;else if(G(b)<1+o)h>0?(g=1.5707963267948966*(h+1),i=-q(g)):i=U;else{if(c=1/(b-.5),d=48/(c*c),e=((20700*c/d-98)*c-16)*c+96.36,f=((94.5/(d+e)-3)/d+1)*v(1.5707963267948966*c)*b,k=l(f*h,2/b),k>.05+c){if(n=xd(.5*h),M(n))return n;j=G(n),k=j*j,b<5&&(e+=.3*(b-4.5)*(j+.6)),e=(((.05*f*j-5)*j-7)*j-2)*j+d+e,k=(((((.4*k+6.3)*k+36)*k+94.5)/e-k-3)/d+1)*j,k=c*k*k,k=k>.002?t(k)-1:.5*k*k+k}else k=((1/(((b+6)/(b*k)-.089*f-.822)*(b+2)*3)+.5/(b+4))*k-1)*(b+1)/(b+2)+1/k;i=v(b*k)}return 0!==m&&(i=-i),D(i)}function Ld(a,b){return a<.5?-Kb(1-a,b,4):Kb(a,b,4)}function Md(a,b,c,d){var e,g,h,k,l,m,n,o,p,q,r,s,t,w,x,z,C,D,E,F,H={N:0,M:0,Q:0,kl:0};if(1!==c&&2!==c)return B;if(1===d){if(q=void 0,r=void 0,s=void 0,t=void 0,w=void 0,x=void 0,z=void 0,f(a)!==f(b))return A;for(C=f(a),z=0;z<C;z++)a[z]=a[z]-b[z];for(t=w=x=q=0,z=0;z<C;z++)D=a[z],r=D-t,s=r/(x+1),t+=s,w+=x*r*s,x++,q+=D;if(x-1===0||0===x)return y;if(k=v(w/(x-1)),i(k)||!j(k))return B;e=q/x,h=e/(k/v(x)),n=x-1}else H.N=0,H.M=0,H.Q=0,H.kl=0,nb(H,a),l=H.Q/(H.N-1),e=H.kl/H.N,o=H.N,H.N=0,H.M=0,H.Q=0,H.kl=0,nb(H,b),m=H.Q/(H.N-1),g=H.kl/H.N,p=H.N,2!==d?(E=l/o/(l/o+m/p),n=1/(E*E/G(o-1)+(1-E)*(1-E)/G(p-1))):n=G(o+p-2),h=(e-g)/v(l/G(o)+m/G(p));return h=u(h),F=pb(.5*n,.5,n/(n+h*h)),M(F)?F:.5*c*G(F)}function Nd(a,b,c,d){var e=t(-l(a/c,b));return D(d?1-e:b/l(c,b)*l(a,b-1)*e)}function Od(a,b,c){var d,e,g,j,k,l,m=0,n=0,o=0,p=0;if(c!==h&&(m=G(c),i(m)))return z;for(j=0;j<f(a);j++)k=a[j],k!==V&&(g=G(k),n+=g,o+=g*g,p++);return 0===p?A:1===p?y:(d=n/p,e=c!==h?m:v((p*o-n*n)/(p*(p-1))),0===e?y:(l=Q((d-b)/(e/v(p))),M(l)?l:D(1-G(l))))}function Pd(a,b){a=G(F(a)),b=G(F(b));var c=1,d;if(a<0||b<0||a<b)return B;for(d=a-b+1;d<=a;d++)c*=d;return D(c)}function Qd(a,b){return Pb(!1,a,b)}function Rd(){var a,b,c,d=0,g=[],h=tb(arguments),i=f(h);for(a=0;a<i;a++){for(b=0,c=a+1;c<i;c++)h[a]===h[c]&&b++;b>d?(d=b,g=[],g.push([h[a]])):b===d&&g.push([h[a]])}return 0===d?A:new e.CalcArray(g)}function Sd(a,b){return P([a,b],18)}function Td(a,b){return P([a,b],19)}function Ud(a,b,c){return a.rowCount>1||a.colCount>1?z:Mb(!1,b,a[0],c)}function Vd(a,b){var c,d=b;return a>=0&&a<2147483647&&d>=0&&d<2147483647&&(a=Math.pow(k(a),k(d)),c=Math.abs(a),c<=1.79769e308)?c>=2.2250738585072014e-308?a:0:B}function Wd(a){var b,c;return""===a?z:(b={value:0},X(a,b)===!0?(a=.3989422804014327*Math.exp(.5*-(b.value*b.value)),c=Math.abs(a),c<=1.79769e308?c>=2.2250738585072014e-308?a:0:B):z)}function Xd(a,b,c,d){var e,f,g,h={value:0};return a=Y(a,h),e={value:0},b=X(b,e),f={value:0},c=Y(c,f),4===arguments.length&&d?(g={value:0},d=Y(d,g)):(d=c,g=f),a===!0&&b===!0&&c===!0&&d===!0?(a=h.value,b=e.value,c=f.value,d=g.value,a>=0&&a<=2147483646&&b>=0&&b<=1&&c>=0&&c<=a&&d>=c&&d<=a?Vc(a,b,c,d):B):z}function Yd(a){var b,c,d;if(a>0)a=Math.exp(ib(a));else{if(b=Math.abs(k(a)),c=a+b,0===c)return B;a=Math.pow(-1,b-1)*Math.exp(ib(-c))*Math.exp(ib(1+c))/Math.exp(ib(b+1-c))}return d=Math.abs(a),d<=1.79769e308?d>=2.2250738585072014e-308?a:0:B}function Zd(a){a=$a(a)-.5;var b=Math.abs(a);return b<=1.79769e308?b>=2.2250738585072014e-308?a:0:B}Z={Hi:7},$={_i:!0,Hi:7},_={Hi:2},aa={Hi:2,aj:"< 1"},ba={Hi:2,aj:"< 0"},ca={Hi:2,aj:["< 1","> 10000000000"]},da={Hi:0},ea={Hi:0,aj:["< 0",">= 1"]},fa={Hi:0,aj:["<= 0",">= 1"]},ga={Hi:0,aj:"<= 0"},ha={_i:0,Hi:0},ia={_i:1,Hi:0},ja={Hi:0,aj:["< 0","> 1"]},ka={Hi:0,aj:"< 0"},la={Hi:0,aj:["< 1","> 10000000000"]},ma={Hi:0,aj:["< 1",">= 10000000000"]},na={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},oa={Hi:4,Ii:1,Ji:!0,Ki:!0},pa={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},qa={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},ra={Hi:4,Ii:1,Ki:!0,Mi:!0},sa={Hi:4,Ii:0,Ji:!0},ta={Hi:4,Ii:1,Ji:!0},ua={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},va={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},wa={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},xa={Hi:4,Ii:1,Ki:!0,Li:!0},ya={Hi:4,Ii:1,Ji:!0,Ki:!0,hOb:!0,Mi:!0},za=[na,{Hi:2}],Aa=[na,da,{_i:3,Hi:2,aj:"< 1"}],Ba=[fa,ga,aa],Ca=[fa,ga,ga,ha,ia],Da=[ba,ba,ja,Z],Ea=[ba,ja,fa],Fa=[ka,la],Ga=[ja,ca],Ha=[oa,oa],Ia=[ka,ga,Z],Ja=[ka,ma,ma],Ka=[ja,ma,ma],La=[na,na],Ma=[ka,ga,ga,Z],Na=[ja,ga,ga],Oa=[ja,da,ga],Pa=[da,da,ga,Z],Qa=[ta,ta],Ra=[ba,ka,Z],Sa=[ka,aa],Ta=[ua,ua,_,{Hi:2,aj:["< 1","> 3"]}],Ua=[ka,ga,ga,Z],Va=[na,da],Wa=[xa,{},$,{_i:!1,Hi:7}],Xa=[{},na,ha],Ya=[ya,da],W("TREND",Tb,1,4,[{Hi:4,Ii:0,Ki:!0},{},{},$],[0,1,2],[0,1,2],{bk:[1,2,3]}),W("GROWTH",Ub,1,4,[xa,{},{},$],"!= 3","!= 3",{bk:[1,2,3]}),W("FORECAST",Vb,3,3,[da,na,na],"> 0","> 0"),W("AVERAGE",Wb,1,h,h,-1,-1),W("STDEV",Xb,1,h,h,-1,-1),W("STDEV.S",Xb,1,h,h,-1,-1),W("PERCENTILE",Yb,2,2,h,0,0),W("PERCENTILE.INC",Yb,2,2,h,0,0),W("MAX",Zb,1,h,h,-1,-1),W("MAXA",$b,1,h,va,-1,-1),W("MIN",_b,1,h,h,-1,-1),W("MINA",ac,1,h,va,-1,-1),W("LARGE",bc,2,2,Ya,0,0),W("SMALL",cc,2,2,Ya,0,0),W("AVERAGEA",dc,1,h,wa,-1,-1),W("AVERAGEIF",gc,2,3,h,[0,1,2],[0,1,2],{bk:2,KMc:[2],l7c:!0,dk:!0}),W("MEDIAN",hc,1,h,pa,-1,-1),W("MODE",ic,1,h,pa,-1,-1),W("MODE.SNGL",ic,1,h,pa,-1,-1),W("GEOMEAN",jc,1,h,qa,-1,-1),W("HARMEAN",kc,1,h,pa,-1,-1),W("TRIMMEAN",lc,2,2,[na,ea],0,0),W("FREQUENCY",mc,2,2,[ra,ra],-1,-1),W("RANK",nc,2,3,Xa,[0,1],[0,1],{bk:2}),W("RANK.EQ",nc,2,3,Xa,[0,1],1,{bk:2}),W("KURT",oc,1,h,pa,-1,-1),W("PERCENTRANK",pc,2,3,Aa,0,0,{bk:2}),W("PERCENTRANK.INC",pc,2,3,Aa,0,0,{bk:2}),W("PERCENTRANK.EXC",qc,2,3,Aa,0,0,{bk:2}),W("QUARTILE",rc,2,2,za,0,0),W("QUARTILE.INC",rc,2,2,za,0,0),W("COUNT",sc,1,h,h,-1,-1,{gk:-1}),W("COUNTA",tc,1,h,h,-1,-1,{gk:-1}),W("COUNTBLANK",uc,1,1,sa,-1,-1),W("COUNTIF",wc,2,2,[sa,sa],[0,1],[0,1]),W("AVEDEV",xc,1,h,pa,-1,-1),W("STDEVA",yc,1,h,wa,-1,-1),W("STDEVP",zc,1,h,h,-1,-1),W("STDEV.P",zc,1,h,h,-1,-1),W("STDEVPA",Ac,1,h,wa,-1,-1),W("VAR",Bc,1,h,h,-1,-1),W("VAR.S",Bc,1,h,h,-1,-1),W("VARA",Cc,1,h,wa,-1,-1),W("VARP",Dc,1,h,h,-1,-1),W("VAR.P",Dc,1,h,h,-1,-1),W("VARPA",Ec,1,h,wa,-1,-1),W("COVAR",Fc,2,2,Ha,-1,-1),W("COVARIANCE.P",Fc,2,2,Ha,-1,-1),W("DEVSQ",Gc,1,h,pa,-1,-1),W("CONFIDENCE",Hc,3,3,Ba),W("CONFIDENCE.NORM",Hc,3,3,Ba),W("CONFIDENCE.T",Ic,3,3,Ba),W("INTERCEPT",Jc,2,2,[pa,pa],-1,-1),W("LINEST",Kc,1,4,Wa,[0,1],[0,1],{bk:[1,2,3],fk:1}),W("SLOPE",Lc,2,2,[pa,pa],-1,-1,{fk:1}),W("LOGEST",Mc,1,4,Wa,[0,1],[0,1],{bk:[1,2,3]}),W("STEYX",Nc,2,2,Ha,-1,-1),W("BETADIST",Pc,3,5,[da,ga,ga,ha,ia],h,h,{bk:[3,4]}),W("BETA.DIST",Qc,4,6,[da,ga,ga,Z,ha,ia],h,h,{bk:[5,6]}),W("BETAINV",Rc,3,5,Ca,h,h,{bk:[3,4]}),W("BETA.INV",Rc,3,5,Ca,h,h,{bk:[3,4]}),W("BINOMDIST",Wc,4,4,Da),W("BINOM.DIST",Wc,4,4,Da),W("NEGBINOMDIST",Xc,3,3,[_,_,ea]),W("NEGBINOM.DIST",Yc,4,4,[ba,aa,ea,Z]),W("CRITBINOM",Zc,3,3,Ea),W("BINOM.INV",Zc,3,3,Ea),W("CHIDIST",$c,2,2,Fa),W("CHISQ.DIST.RT",$c,2,2,Fa),W("CHISQ.DIST",_c,3,3,[ka,ca,Z]),W("CHIINV",ad,2,2,Ga),W("CHISQ.INV.RT",ad,2,2,[ja,aa]),W("CHISQ.INV",cd,2,2,Ga),W("CHITEST",dd,2,2,Ha,-1,-1),W("CHISQ.TEST",dd,2,2,Ha,-1,-1),W("CORREL",ed,2,2,h,-1,-1),W("EXPONDIST",fd,3,3,Ia),W("EXPON.DIST",fd,3,3,Ia),W("FDIST",gd,3,3,Ja),W("F.DIST",hd,4,4,[ka,la,la,Z]),W("F.DIST.RT",gd,3,3,Ja),W("FINV",id,3,3,Ka),W("F.INV.RT",id,3,3,Ka),W("F.INV",jd,3,3,[ja,ca,ca]),W("FISHER",kd,1,1,{Hi:0,aj:["<= -1",">= 1"]}),W("FISHERINV",ld,1,1,da),W("FTEST",md,2,2,La,-1,-1),W("F.TEST",md,2,2,La,-1,-1),W("GAMMADIST",nd,4,4,Ma),W("GAMMA.DIST",nd,4,4,Ma),W("GAMMAINV",od,3,3,Na),W("GAMMA.INV",od,3,3,Na),W("GAMMALN",pd,1,1,ga),W("GAMMALN.PRECISE",pd,1,1,ga),W("HYPGEOMDIST",qd,4,4,[ba,ba,ba,ba]),W("HYPGEOM.DIST",rd,5,5,[ba,ba,ba,ba,Z]),W("LOGNORMDIST",sd,3,3,[ga,da,ga]),W("LOGNORM.DIST",td,4,4,[ga,da,ga,Z]),W("LOGINV",ud,3,3,Oa),W("LOGNORM.INV",ud,3,3,Oa),W("NORMDIST",vd,4,4,Pa),W("NORM.DIST",vd,4,4,Pa),W("NORMINV",wd,3,3,Oa),W("NORM.INV",wd,3,3,Oa),W("NORMSDIST",Q,1,1,da,h,h),W("NORMSINV",xd,1,1,ja),W("NORM.S.INV",xd,1,1,ja),W("NORM.S.DIST",yd,2,2,[da,Z]),W("PEARSON",zd,2,2,Qa,-1,-1),W("RSQ",Ad,2,2,Qa,[0,1],[0,1]),W("POISSON",Bd,3,3,Ra),W("POISSON.DIST",Bd,3,3,Ra),W("PROB",Cd,3,4,[ua,oa,da],[0,1],[0,1],{bk:3}),W("SKEW",Dd,1,h,pa,-1,-1),W("STANDARDIZE",Fd,3,3,[da,da,ga]),W("TDIST",Gd,3,3,[ka,aa,_]),W("T.DIST",Hd,3,3,[da,aa,Z]),W("T.DIST.RT",Id,2,2,Sa),W("T.DIST.2T",Jd,2,2,Sa),W("TINV",Kd,2,2,Ga),W("T.INV.2T",Kd,2,2,Ga),W("T.INV",Ld,2,2,[{Hi:0,aj:["<= 0","> 1"]},ca]),W("TTEST",Md,4,4,Ta,[0,1],[0,1]),W("T.TEST",Md,4,4,Ta,[0,1],[0,1]),W("WEIBULL",Nd,4,4,Ua),W("WEIBULL.DIST",Nd,4,4,Ua),W("ZTEST",Od,2,3,Va,0,0,{bk:2}),W("Z.TEST",Od,2,3,Va,0,0,{bk:2}),W("PERMUT",Pd,2,2),W("COVARIANCE.S",Qd,2,2,Ha,-1,-1),W("MODE.MULT",Rd,1,h,qa,-1,-1),W("PERCENTILE.EXC",Sd,2,2,[na,fa],0,0),W("QUARTILE.EXC",Td,2,2,[va,_],0,0),W("RANK.AVG",Ud,2,3,[ua,ta,ha],[0,1],1,{bk:2}),W("PERMUTATIONA",Vd,2,2,[da,da]),W("PHI",Wd,1,1),W("BINOM.DIST.RANGE",Xd,3,4,[{_i:0},{_i:0},{_i:0}]),W("GAMMA",Yd,1,1,ga),W("GAUSS",Zd,1,1,da),W("SKEW.P",Ed,1,h,wa,-1,-1)},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),a.exports=d.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"@grapecity/js-calc":function(a,b){a.exports=GC.Spread.CalcEngine},"@grapecity/js-sheets-common":function(a,b){a.exports=GC.Spread}});;var GC;(function(n){var t;(function(){var n=window,i,t;try{for(i=[n.jQuery,n.Forguncy],t=0;t<i.length;t++)if(!i[t]){n.GC=null;break}n.GC&&$("#pageCover").length!==1&&(n.GC=null)}catch(r){n.GC=null}})(t=n.Spread||(n.Spread={}))})(GC||(GC={}))
;/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/core/core.entry.js")}({"./dist/core/celltype/basecelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/core.enum.js"),i=c("./dist/core/celltype/celltype.ns.js"),j=c("CalcEngine"),k=d.Common.F,l=d.Common.CultureManager,m=d.Common.o,n=d.Common.l,o=d.Common.pc,p=d.Common.j,q=p.Fa,r=p.Ma,s=f.Ul.fp,t=f.Ul.ol,u=f.Ul.uWa,v=f.Ul.lZa,w=f.Ul.hZa,x=f.Ul.K_a,y=f.Ul.pL,z=f.Ul.Fxb,A=f.Ul.lHb,B=d.Common.j.Fa,C=e.GC$.extend,D=f.Ul.Ml,E="left",F="right",G="center",H="alphabetic",I=16,J="string",K="number",L=null,M=void 0,N=Math.floor,O=Math.ceil,P=Math.sin,Q=Math.cos,R=Math.tan,S=Math.abs,T="none",U="General",V=Math.max,W=.7,X={},Y="...",function(a){a[a.top=0]="top",a[a.right=1]="right",a[a.bottom=2]="bottom",a[a.left=3]="left"}(Z||(Z={}));function ba(a){var b=a.isPrinting,c=a.printZoomFactor;return b&&typeof c===K&&1!==c}$=function(){function a(){}return a.Gxb=function(a){var b,c,d=a.split("e")[1];if(d&&d.length>0&&("+"===d[0]?b=!0:"-"===d[0]&&(b=!1),c=d.slice(1)),void 0!==b)return{isAdd:b,length:c}},a.Apb=function(b,c,d){var e=a.Hxb,f=e[c+d];return f||(f=y(b,c,d),e[c+d]=f),f},a.Ixb=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=e.font;if(d=d-1-3*f,g=e.textIndent&&0!==e.textIndent,h=e.isVerticalText,typeof c===K&&e.shrinkToFit!==!0&&!h&&!g){if(i=c<0,c=S(c),j=i?a.Apb(b,z,"-"):0,k=""+c,l=a.Gxb(k),m=void 0,n=a.Jxb(e._autoFormatter,c),l)return m=(""+l.length).length,m=V(m,2),a.Kxb(b,d,e,m,j,l.isAdd,n);if(o=j,p=a.Apb(b,z,"0"),q=k.split("."),r=(""+Math.round(c)).length,s=p*r,o+=s,t=a.Apb(b,z,"."),u=void 0,s<=d){if(!q[1]||0===q[1].length)return e._autoFormatter;if(o=o+q[1].length*p+t,o<=d)return e._autoFormatter;if(c<.001)return m=(""+q[1].length).length,m=V(m,2),a.Kxb(b,d,e,m,j,!1,n);for(v=d-j-s-t,w=Math.floor(v/p),w=Math.min(w,q[1].length),u="0",w>0&&(u+="."),x=0;x<w;x++)u+="0";return u}return y=Math.round(c),m=(""+(""+y).length).length,m=V(m,2),a.Kxb(b,d,e,m,j,!0,n)}return e._autoFormatter},a.Kxb=function(b,c,d,e,f,g,h){var i,j,k,l=d.font,m=a.Apb(b,l,"0"),n=a.Apb(b,l,"E"),o=a.Apb(b,l,"+"),p=a.Apb(b,l,"-"),q=g?o:p,r=a.Apb(b,l,"."),s=c-f-e*m-n-q-m,t=s-r;if(t<=m)return g?"0E+00":s>0?"0E-00":"0";for(i=Math.floor(t/m),i=Math.min(i,h),j="0",k=0;k<i;k++)0===k&&(j+="."),j+="0";return j+=g?"E+00":"E-00"},a.Lxb=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o=e.font;if(d=d-1-3*f,g=e.textIndent||0,h=e.hAlign,i=d,1!==h&&g>0&&(i=d-8*g),j=y(b,e.font,c),i<j){for(k=a.Apb(b,o,"#"),l=Math.floor(d/k),m="",n=0;n<l;n++)m+="#";return m}return c},a.ap=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t;if(f&&"none"!==f&&h)try{h.ko(f)?(i=h.lo(f),j=void 0,D.msie&&(j=document.createElement("div"),j.appendChild(i),document.body.appendChild(j)),k=i.width,l=i.height,D.msie&&(j.removeChild(i),document.body.removeChild(j)),m=0,n=0,o=k,p=l,q=d,r=e,s=b,t=c,1===g?(o=d>=k?k:d,p=e>=l?l:e,s=d>k&&k>0?O(b+d/2-k/2):b,t=e>l&&l>0?O(c+e/2-l/2):c,q=o,r=p):2===g?e>0&&l>0&&d/e>k/l?(q=k/l*e,s=b+d/2-q/2):d>0&&k>0&&e/d>l/k&&(r=l/k*d,t=c+e/2-r/2):3===g&&(o=d>=k?k:d,p=e>=l?l:e,q=o,r=p),a.drawImage(i,m,n,o,p,s,t,q,r)):h.fo(f)}catch(a){}},a.cp=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B=0,D=e&&e.sheet,E=c.textIndent,F=c.hAlign,G=c.isVerticalText,H=c.textOrientation,K=c.borderTop||c.borderBottom||c.borderLeft||c.borderRight,L=c.font,M=e.row,N=e.col;if(H&&-90<=H&&H<=90&&(j=S(H*Math.PI/180),h=P(j),i=Q(j)),D&&typeof b===J&&b)if(k=[],l=void 0,a&&a.richText)if(m=c.formatter||c._autoFormatter,n=D.getCellType(M,N),o=n.T_a(m,a.text),l=C(!0,[],n.U_a(a,b,o,L,c.foreColor)),Ca(l,L,d),G)if(c.wordWrap){if(p=e.sheetArea,q=D.Sl(M),r=D.ITa.findSpan(M,N,p),r&&r.row>=M&&r.col>=N&&r.rowCount>1)for(t=M+1;t<M+r.rowCount;t++)q+=D.Sl(t);for(u=0,E>0&&(u=8*E),v=na(c,0),w=na(c,2),v>0&&(q-=v),w>0&&(q-=w),q++,k=f.Vn.M_a(b,q-3-u,L,l,G),g=0;g<k.length;g++)B+=ha(k[g].textInfos,L,d)}else B=ha(l,L,d);else{if(c.wordWrap){for(x=b.split(/\r\n|\r|\n/),g=0;g<x.length;g++)k.push(f.$6c(x[g]));for(k=f.Vn.O_a(k,f.Vn.P_a(l)),g=0;g<k.length;g++)B=Math.max(B,ja(k[g],L,d,G,!0))}else B=ia(l,L,d);1!==F&&E>0&&(B+=8*E/d),ga(D,M,N,e.sheetArea)&&(B+=ma(D))}else if(k=b.split(/\r\n|\r|\n/),y=c.font,z=s(y)/d,G)if(c.wordWrap)for(g=0;g<k.length;g++)B+=z;else B=z;else{if(c.wordWrap){if(H)return A=D.Sl(M),f.Vn.mHb(M,N,h,i,b,y,A);for(g=0;g<k.length;g++)B=Math.max(B,f.Vn.Xn(k[g],y,!0)/d)}else B=H?K?(z+4)/h:i*(D.dp(b,y)/d)+z*h:4===c.hAlign?D.ss._m(N):D.dp(b,y)/d;1!==F&&E>0&&(B+=8*E/d),ga(D,M,N,e.sheetArea)&&(B+=I)}return B},a.rYc=function(a,b,c){var d,e,f,g=a.ss._m(c);for(d=c+1;d<a.getColumnCount()&&(e=a.ss.Ym(b,d),f=a.ss.zHb(b,d,3,1,e),B(f))&&!e.watermark&&!(e.cellType&&"1"!==e.cellType.typeName||e.cellButtons&&e.cellButtons.length>0)&&4===e.hAlign;d++)g+=a.ss._m(d);return g},a.ep=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,A,B,D,E,F,G,H,I,K,L,M=0,N=e&&e.sheet,O=c.font,R=c.isVerticalText,T=c.textIndent,U=c.vAlign,V=c.textOrientation,W=e.row,X=e.col;if(V&&-90<=V&&V<=90&&(w=S(V*Math.PI/180),u=P(w),v=Q(w)),N&&typeof b===J&&b)if(x=[],y=void 0,a&&a.richText)if(A=c.formatter||c._autoFormatter,B=N.getCellType(W,X),D=B.T_a(A,a.text),y=C(!0,[],B.U_a(a,b,D,O,c.foreColor)),Ca(y,O,d),R){if(c.wordWrap){for(E=b.split(/\r\n|\r|\n/),g=0;g<E.length;g++)x.push(f.$6c(E[g]));for(x=f.Vn.O_a(x,f.Vn.P_a(y)),g=0;g<x.length;g++)M=Math.max(M,ja(x[g],O,d,R,!0))}else M=ia(y,O,d,R);1!==U&&T>0&&(M+=8*T/d)}else if(c.wordWrap){if(h=e.sheetArea,i=N.Tl(X),l=N.ITa.findSpan(W,X,h),l&&l.row>=W&&l.col>=X&&l.colCount>1)for(m=X+1;m<X+l.colCount;m++)i+=N.Tl(m);for(o=0,T>0&&(o=8*T),p=na(c,1),q=na(c,3),q>0&&(i-=q),p>0&&(i-=p),i++,x=f.Vn.M_a(b,i-3-o,O,y),g=0;g<x.length;g++)M+=ha(x[g].textInfos,O,d)}else M=ha(y,O,d);else if(F=c.font,G=s(F)/d,R){if(c.wordWrap)for(x=b.split(/\r\n|\r|\n/),g=0;g<x.length;g++)H=x[g].length*G,M=Math.max(M,H);else M=b.length*G;1!==U&&T>0&&(M+=8*T/d)}else if(c.wordWrap){if(h=e.sheetArea,i=4===c.hAlign?this.rYc(e.sheet,W,X):N.Tl(X),j=N.Sl(W),l=N.ITa.findSpan(W,X,h),l&&l.row>=W&&l.col>=X&&l.colCount>1){for(m=X+1;m<X+l.colCount;m++)i+=N.Tl(m);for(n=W+1;n<W+l.colCount;n++)j+=N.Sl(n)}if(o=0,T>0&&(o=8*T),p=na(c,1),q=na(c,3),r=na(c,0),t=na(c,2),q>0&&(i-=q),p>0&&(i-=p),r>0&&(j-=r),t>0&&(j-=t),c.cellButtons&&c.cellButtons.length>0&&(i-=pa(e,c)),1===h&&(I=N.rowFilter&&N.rowFilter(),K=!!(I&&I.Dl(W,X,h)&&I.filterButtonVisible(X)),K&&(i-=N.oK(new f.Rect(0,0,i,j),h).width)),V)return L=(j-G*v)/u,x=f.Vn.Wn(b,L,F),k=N.dp(x[0],F)/d,M=u*k+G*v;x=z(a)?[b]:f.Vn.Wn(b,i-3-o,F),M=x.length*G}else V?(k=N.dp(b,F)/d,M=u*k+G*v):M=G;return M},a.gp=function(a,b,c,d,e,f,g,h,i,j,k){var l;1===i?(a.beginPath(),l=a.createLinearGradient(b,c+1,b,c+e-2),l.addColorStop(0,h.borderLeftColor),l.addColorStop(1,h.borderRightColor),a.strokeStyle!==l&&(a.strokeStyle=l),f.borderLeft||(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e)),f.borderRight||(a.moveTo(b+d-.5,c),a.lineTo(b+d-.5,c+e)),j&&!f.borderTop&&(a.moveTo(b,c+.5),a.lineTo(b+d,c+.5)),a.stroke(),h.borderBottomWidth&&!f.borderBottom&&(a.beginPath(),a.strokeStyle!==h.borderBottomColor&&(a.strokeStyle=h.borderBottomColor),a.moveTo(b+1,c+e-.5),a.lineTo(b+d,c+e-.5),a.stroke())):(a.beginPath(),l=a.createLinearGradient(b,c,b+d-2,c),l.addColorStop(0,h.borderTopColor),l.addColorStop(1,h.borderBottomColor),a.strokeStyle!==l&&(a.strokeStyle=l),f.borderTop||(a.moveTo(b,c+.5),a.lineTo(b+d,c+.5)),f.borderBottom||(a.moveTo(b,c+e-.5),a.lineTo(b+d,c+e-.5)),k&&!f.borderLeft&&(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e)),a.stroke(),h.borderRightWidth&&!f.borderRight&&(a.beginPath(),a.strokeStyle!==h.borderRightColor&&(a.strokeStyle=h.borderRightColor),a.moveTo(b+d-.5,c+1),a.lineTo(b+d-.5,c+e),a.stroke()))},a.hp=function(a,b){var c;c=2===b?"active":4===b?"inactive":0===b?"disabled":"auto",e.GC$(a).css("ime-mode",c)},a.bDc=function(a,b,c,d,e,f,g){var h,i,j,k,l;return!!(b&&"SparklineExValue"===b.typeName&&(h=g.sheet,i=h&&h.parent,i&&(j=i.getSparklineEx(b.name))))&&(k=ba(g)?g.printZoomFactor:h.zoom(),l={zoomFactor:k,sheet:h,rowIndex:g.row,columnIndex:g.col},2===g.columnHeaderFitMode&&(e=h.getColumnWidth(g.col)+1),j.paint(a,b.value,c,d,e,f,l),!0)},a.Hxb={},a.Jxb=function(a,b){var c,d,e,f,g,h;return a&&a.Ud&&(c=a.Ud(b),d=c.format(b),d&&d[1]&&"decimalSeparator"===d[1].type)?(e=d[2],e&&e.type===K?(f=e.value,g=d[3],h=g&&"exponent"===g.type&&g.value&&g.value.indexOf("E")>-1,!q(f)&&h?f.length:5):0):5},a.u5=na,a}(),b.Context=$;function ca(a,b){var c=a>8?N((a-8)/5+2):1;return b/2-a/2+c-1}_={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092};function da(a){var b=_[a.charCodeAt(0)];return b?String.fromCharCode(b):a}function ea(a,b,c){return q(a.x)||(a.x+=b.width),a.width=a.width-b.width-c.width,a}function fa(a,b,c,d){var e,g=c.foreColor;g=f.Im._ob(b,g),d=q(c.opacity)?d:c.opacity,q(d)||(e=o.ec(g),e.a=d,g=o.bc(e)),a.fillStyle!==g&&(a.fillStyle=g||"#000000")}aa=function(){function a(){this.allowOverflow=!1,this.typeName="0"}return a.prototype.uxb=function(b,c,d,e){var f={ctx:b,options:{rect:c,context:d,value:e}};return a.ao(d.sheet,"paintCellPadding",f),f.options.rect},a.prototype.Mfc=function(b,c,d){var e={context:b,options:{dom:c,cellRect:d,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)}};return a.ao(b.sheet,"onCreateCellEditor",e),e.options.dom},a.prototype.TBb=function(b,c,d){var e={ctx:null,options:{rect:c.clone(),context:b,value:null,style:d}};return a.ao(b.sheet,"getCellButtonRect",e),e.options.rect},a.prototype.Nfc=function(b,c,d,e){var g={context:b,options:{dom:c,cellRect:d,cellStyle:e,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)}};return a.ao(b.sheet,"onActivateCellEditor",g),g},a.prototype.VBb=function(b,c,d,e){var g={context:b,contentContainer:c,editorBounds:d,cellStyle:e,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)};return a.ao(b.sheet,"onUpdateContainer",g),g},a.prototype.Ofc=function(b,c,d){var e={context:b,options:{dom:c,cellRect:d,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)}};return a.ao(b.sheet,"onDeactivateCellEditor",e),e.options.dom},a.prototype.XBb=function(a,b,c){var d=this;d.deactivateEditor(a,b),d.Ofc(b,a,c)},a.prototype.i5=function(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p=c.labelOptions;if(p&&(e=d.sheet,f=c.watermark)){if(h=p.visibility,i=e.getText(d.row,d.col,d.sheetArea),1===h||(2===h||h===M)&&""===i)return;j=e.zoom(),k=p.font,l=void 0,l=k?g.To.No(k,j):g.To.No(c.font,1),m=s(l.font),n=va(b,c),o=void 0,ua(c,b)&&(o=xa(b,c,l,m)),o&&(a.save(),a.textAlign=wa(p.alignment),a.textBaseline="alphabetic",v(a,l.font),a.fillStyle=p.foreColor||c.foreColor||"grey",a.rect(n.x,n.y,n.width,n.height),a.clip(),a.beginPath(),a.fillText(f,o.x,o.y),a.restore())}},a.prototype.f5=function(a,b,c){var d=a.clone(),e=na(b,0,!1,c),f=na(b,1,!1,c),g=na(b,2,!1,c),h=na(b,3,!1,c);return e>0&&(d.y+=e,d.height-=e),g>0&&(d.height-=g),h>0&&(d.x+=h,d.width-=h),f>0&&(d.width-=f),f+h>=a.width&&(d.width=0),e+g>=a.height&&(d.height=0),d},a.prototype.Ama=function(b,c,d,e){var f,g=this,h=ba(e)?e.printZoomFactor:e.sheet.zoom();return c=g.f5(c,d,h),f={ctx:b,options:{rect:c,context:e}},a.ao(e.sheet,"getCellPaddingRect",f),f.options.rect},a.prototype.e5=function(a,b,c,d){var g,h,i,j,k,l,m,n,o,p,q,r,t,u=c.labelOptions;u&&(g=d.sheet,h=g.getText(d.row,d.col,d.sheetArea),i=c.watermark,j=u.visibility,1!==j&&i&&(k=u.font||c.font||g.yl.Bl(),l=g.zoom(),1!==l&&(k=g.yl.Cl(k)),m=s(k),ua(c,b)&&(n=ya(b,c)),n&&(o=e.GC$(f.Ul.Nl("span")),o.text(i),p=(2===j||j===M)&&""===h,q=n.height-m,r=n.y+(p&&q>0?q:0),o.css({display:"block",position:"absolute",left:n.x,top:r,width:n.width,height:n.height,font:w(k),color:u.foreColor||c.foreColor||"grey",textAlign:wa(u.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),e.GC$(a).append(o),p&&(t=setInterval(function(){r--,o.css("top",r),r<=n.y&&clearInterval(t)},20)))))},a.prototype.a5=function(a){var b,c,d=this,g=f.Ul.Nl("div");return g.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",b=f.Ul.Nl("div"),b.style.cssText="position: absolute; outline: none; border: none",e.GC$(g).append(e.GC$(b)),c=d.createEditorElement(a,g),c&&e.GC$(b).append(e.GC$(c)),d.Mfc(a,g,a.sheet.getCellRect(a.row,a.col)),g},a.prototype.d5=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o;a&&a.firstChild&&(f=this,g=Ba(c),sa(a,b,g,d),h=f.Nfc(d,a,g,b),i=h.options.contentRect,j=h.options.cellRect,k=h.options.leftExternalRect,l=h.options.rightExternalRect,f.e5&&f.e5(a,i,b,d),m=d.sheet.zoom(),i=f.f5?f.f5(i,b,m):i,n=ea(i,k,l),o=a.firstChild,e.GC$(o).css({left:(+e.GC$(o).css("left").replace("px","")||0)+na(b,3,!1,m),top:(+e.GC$(o).css("top").replace("px","")||0)+na(b,0,!1,m)}),f.activateEditor(a.firstChild.firstChild,b,n,d,j,k,l))},a.prototype.updateEditorContainer=function(a,b,c,d,f,g,h){var i,j,k,l,m,n;a&&b&&(i=a.parentNode,j=i?i.parentNode:M,j&&f&&(k=e.GC$(j),l=f.width,m=f.height,l>0&&(k.width(l),n=j.lastChild,c&&"gcEditorLabel"===n.getAttribute("gcUIElement")&&e.GC$(n).width(l-na(c,3,!0)-na(c,1,!0)-2)),m>0&&k.height(m),q(f.x)||k.css("left",f.x+"px"),q(f.y)||k.css("top",f.y+"px")))},a.prototype.g5=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=a.firstChild,t=Ba(c);sa(a,b,t,d),e=r.VBb(d,s,t,b),f=e.editorBounds,g=e.contentRect,h=e.leftExternalRect,i=e.rightExternalRect,j=s.firstChild,g=r.f5?r.f5(g,b,d.sheet.zoom()):g,k=ea(g,h,i),l=r.updateEditor(j,b,k,d,f,h,i),m={width:h.width,height:h.height},n={width:i.width,height:i.height},p=!isNaN(l&&l.width)&&l.width+m.width+n.width>f.width?l.width+m.width+n.width:f.width,q=!isNaN(l&&l.height)&&l.height+m.height+n.height>f.height?l.height+m.height+n.height:f.height,o={width:p,height:q},r.updateEditorContainer(j,l,b,d,o,m,n)},a.prototype.h5=function(a,b,c,d,e){return this.getCellAndPaddingHitInfo(a,b,c,d,e)},a.prototype.X4=function(a,b,c,d,e){var f=pa(e,c)+oa(e)+qa(e,c),g=this.getAutoFitWidth(a,b,c,d,e);return g>0&&(f+=g+na(c,3,!1)+na(c,1,!1)),f},a.prototype.Y4=function(a,b,c,d,e){var f=0,g=this.getAutoFitHeight(a,b,c,d,e);return g>0&&(f+=g+na(c,0,!1)+na(c,2,!1)),Math.max(ra(e,c),f)},a.prototype.paintValue=function(a,b,c,d,e,g,h,i){var j,k,l,m=this,n={};i.quotePrefix=h.quotePrefix,j=this.format(x(b),h.formatter||h._autoFormatter,n,i),j&&(k=new f.Rect(c,d,e,g),this.adjustRectForIconSet(h.hAlign,i.sheet,i.row,i.col,i.sheetArea,k,n.content&&this.hasInfilling(n.content)),c=k.x,e=k.width,l=m.Pfc(a,j,h,i,c,d,e,g),this.paintText(a,b,c,d,e,g,h,i,j,n,M,l.externals))},a.prototype.S_a=function(a,b,c){var d=0;return a>0&&(d=8*a),b&&b.XQa(c)&&(d=0),d},a.prototype.T_a=function(a,b){return!!(!a||r(a,J)&&a===U||a&&a.formatString&&a.formatString()===U)||!(b&&(!isNaN(b)||"TRUE"===b.toUpperCase()||"FALSE"===b.toUpperCase())&&"@"!==a)},a.prototype.Qfc=function(a){var b,c=0;for(b=0;b<a.length;b++)c+=a[b].width;return c},a.prototype.Rfc=function(a){var b,c=0;for(b=0;b<a.length;b++)c+=a[b].height;return c},a.prototype.Sfc=function(b,c,d,e,f){var g={ctx:b,options:{rect:d,context:c,value:e,style:f}};a.ao(c.sheet,"beforePaintLabel",g)},a.prototype.Pfc=function(b,c,d,e,g,h,i,j){var k={ctx:b,text:c,rect:new f.Rect(g,h,i,j),style:d,context:e,externals:{left:[],right:[]}};return a.ao(e.sheet,"beforePaintText",k),k},a.prototype.Tfc=function(b,c,d,e,g,h,i,j,k){var l={ctx:b,style:c,context:d,textRect:new f.Rect(e,g,h,i),availRect:j};return a.ao(d.sheet,k,l),l},a.prototype.Ufc=function(a,b,c,d,e,f,g,h){return this.Tfc(a,b,c,d,e,f,g,h,"beforeFillTextArea")},a.prototype.Vfc=function(a,b,c,d,e,f,g,h){return this.Tfc(a,b,c,d,e,f,g,h,"afterFillTextArea")},a.prototype.paintText=function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,r=this;a.save(),a.beginPath(),m=g.textOrientation,n=g.textIndent&&0!==g.textIndent,o=g.hAlign,p=g.isVerticalText&&4!==o,4===o&&(m=0,n=!1),b&&b.richText&&b.richText.length>0||p?r.Fpb(a,b,c,d,e,f,g,h,i,j,k,l):0!==m&&!q(m)&&-90<=m&&m<=90&&!n&&!p?r.nHb(a,b,c,d,e,f,g,h,i,j,k,l):r.N$a(a,b,c,d,e,f,g,h,i,j,k,l),a.restore()},a.prototype.oHb=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x=b.sheet,y=b.row,z=b.col,A=e.vAlign,B=b.sheetArea;for(k=0;k<c.length;k++)if(l=c[k].text,m=d[k].lineHeight,n=1===A?0:h,o=this.pHb(a,"0"),p="",q=f,q-1-2-n<l.length*m){if(q<3*o)j.push(0),p=Y;else if(r=N((q-1-2-3*o-(1===A?0:h))/m),s=0,0===A){for(t=0;t<r;t++)p+=l[t];u=p.length,p+=Y,3*o+(p.length-3)*m+h>q-1-2?(p=p.substring(0,p.length-4)+Y,j.push(p.split(Y)[0].length)):j.push(u)}else if(1===A){for(v=0;v<O(r/2);v++)w=l.charAt(v),p+=w,s=v;for(u=p.length,p+=Y,v=O(l.length-r/2);v<l.length;v++)w=l.charAt(v),p+=w;3*o+(p.length-3)*m+h>q-1-2?(p=p.replace(l[s],""),j.push(p.split(Y)[0].length)):j.push(u),i[k].y=g+(f-(3*o+(p.length-3)*m))/2}else{for(j.push(0),t=l.length-1;t>=l.length-r;t--)p=l[t]+p;p=Y+p,3*o+(p.length-3)*m+h>q-1-2&&(p=p.replace(l[l.length-r],"")),i[k].y=g+f-h-(3*o+(p.length-3)*m)-2}c[k].textInfos[0].text=p,x.ITa.qHb(y,z,l,B)}else x.ITa.qHb(y,z,null,B)},a.prototype.Fpb=function(a,b,c,d,e,g,h,i,j,k,l,m){var n,o,p,q,r,s,v,w,x,y,z,A,B,D,E,H,I,J,K,M,N,O,P=this,Q=new f.Rect(c,d,e,g),R=P.S_a(h.textIndent,i.sheet.outlineColumn,i.col),S=i.cellOverflowLayout&&i.cellOverflowLayout.expandedWidth,T=h.hAlign;if(3===T&&(T=t(T,b,h.formatter)),n=h.isVerticalText&&4!==T,o=!!n&&u(j),p=h.font,q=h.formatter||h._autoFormatter,r=P.T_a(q,b.text),s=C(!0,[],P.U_a(b,j,r,p,h.foreColor)),fa(a,i.sheet,h,l),b&&b.richText&&b.richText.length>0&&(v=i.sheet?i.sheet.zoom():1,w=i.printZoomFactor,w=ba(i)?w:L,P.V_a(s,p,v,w)),x=0,y=0,m&&(x=P.Qfc(m.left),y=P.Qfc(m.right)),z=x+y,A={left:x,right:y},!h.wordWrap&&h.shrinkToFit&&(4===h.hAlign?P.W_a(s,S-z,g,h,p,1,n):P.W_a(s,e-z,g,h,p,1,n)),B=P.X_a(a,j,h.font,n?g:e-z,R,n?h.vAlign:h.hAlign,h.wordWrap,n,s),D=P.Y_a(B,h,T,l),E=P.Z_a(a,h,c,d,e,g,h.wordWrap,i.cellOverflowLayout,T,R,n,B[0].textLength,D[0].lineHeight),H=!1,h.showEllipsis&&n&&!b.richText&&(H=!0),I=[],I=4===T?P.$_a(c,d,i.cellOverflowLayout.expandedWidth,g,T,h.vAlign,R,n,o,B,D,A,H):P.$_a(c,d,e,g,T,h.vAlign,R,n,o,B,D,A,H),J=B.length,K=[],H&&k&&(k.content&&1===k.content.length&&"text"===k.content[0].type||!k.content&&1===B.length&&B[0].text)&&this.oHb(a,i,B,D,h,g,d,R,I,K),1===J&&k&&!r)P.__a(a,i.sheet,j,k,I[0].x,I[0].y,e,g,T,h,E.width,E.height,R,n,B[0].textLength,i,A,Q);else{for(M=P.Wfc(B),N=I[0].x,a.textAlign===G?N-=M/2:a.textAlign===F&&(N-=M),P.Ufc(a,h,i,N,I[0].y,M,0,Q),O=0;O<J;O++)P.a0a(a,i.sheet,I[O].x,I[O].y,D[O],T,B[O],K[O]);P.Ufc(a,h,i,N,I[0].x,M,0,Q)}},a.prototype.Wfc=function(a){var b,c=a[0].textLength;for(b=0;b<a.length;b++)c=V(c,a[b].textLength);return c},a.prototype.pHb=function(a,b){var c=0,d=a.font+b;return X[d]?c=X[d]:(c=y(a,a.font,b),X[d]=c),c},a.prototype.rHb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=a.sheetArea,t=c,u=this.pHb(d,t),v=a.sheet,w=a.row,x=a.col,y=e,z=0,A=this.pHb(d,"0"),B=this.pHb(d,Y);if(z=B,h=1===f?0:g,u>y-1-2-h){if(i="",2===f)for(j=t.length-1;j>=0;j--){if(z>y-1-2-g){k=i.length,i=Y+i.substring(1,k);break}l=t.charAt(j),i=l+i,m=this.pHb(d,l),z+=m}else if(1===f){for(n=O((y-z)/A),j=0;j<n/2;j++)l=t.charAt(j),i+=l;for(i+=Y,j=N(t.length-n/2);j<t.length;j++)l=t.charAt(j),i+=l;for(o=this.pHb(d,i);o>y-1-2&&i!==Y;)p=i.split(Y),q=p[0],r=p[1],i=q.length>r.length?q.substring(0,q.length-1)+Y+r:q+Y+r.substring(1,r.length),o=this.pHb(d,i)}else for(j=0;j<t.length;j++){if(z>y-1-2-g){k=i.length,i=i.substring(0,k-1)+Y;break}l=t.charAt(j),i+=l,m=this.pHb(d,l),z+=m}b.content=[{value:i,type:"text"}],v.ITa.qHb(w,x,t,s)}},a.prototype.N$a=function(a,b,c,d,e,i,j,k,l,m,n,o){var p,r,w,x,z,A,B,C,D,E,I,J,K,L,M,O,P,Q,R,S,T,U,W,X,Y,Z,$,_,aa,ca,da,ea,ga,ha=this,ia=0,ja=j.textIndent,ka=j.wordWrap,la=j.hAlign,ma=j.vAlign,oa=j.shrinkToFit,pa=j.textDecoration,qa="left",ra=2,sa=2,ta=j.font,ua=0,va=[],wa=0,xa=k.sheet,ya=new f.Rect(c,d,e,i),za=k.cellOverflowLayout&&k.cellOverflowLayout.expandedWidth;if(4===la&&(pa=0,ja=0),q(k.fontInfo)&&(k.fontInfo=g.To.No(j.font,xa.zoom()),ba(k)&&(k.fontInfo=g.To.No(k.fontInfo.font,k.printZoomFactor))),p=parseInt(k.fontInfo.fontSize,10),q(k.lineHeight)&&(k.lineHeight=s(g.To.No(j.font,xa.zoom()).font,!1,u(l))),r=k.lineHeight,fa(a,xa,j,n),ja>0&&(ia=8*ja),xa.outlineColumn&&xa.outlineColumn.XQa(k.col)&&(ia=0),3===la&&(la=t(la,b,j.formatter)),w=1,v(a,ta),x=0,z=0,o&&(x=ha.Qfc(o.left),z=ha.Qfc(o.right)),A=x+z,B={left:x,right:z},!ka&&oa){for(C=0,D={value:!1},E=void 0,I=0;I<3&&D.value===!1&&(J=a.measureText(l).width,C=V(0,e-4-(1===la?0:ia)-A),4===la&&(C=V(0,za-4-ia-A)),C<J);I++)E=g.To.No(ta,C/J,D,!0),ta=E.font,v(a,ta);E&&(w=p/E.fontSize,p=E.fontSize)}if(K=xa.parent&&xa.parent.options.numbersFitMode===h.NumbersFitMode.overflow||!1,K||(K=m&&m.content?!(!m.content||1!==m.content.length||"text"!==m.content[0].type):"string"==typeof b&&b===l),!ka&&!oa&&j.showEllipsis&&K&&this.rHb(k,m,l,a,e,la,ia),ra+=ia+x,1===la||4===la?(ra=(e+x-z)/2,qa=G):2===la&&(ra=e-z-1-2,ra-=ia,qa=F),a.textAlign!==qa&&(a.textAlign=qa),L=0,ka&&(L=e-A-3-ia,4===la&&(L=za-A-3-ia),L-=1,va=f.Vn.Wn(l,L,ta,!1,a),wa=va.length,wa>1&&0!==ma&&(ua=(wa-1)*r)),M=p>8?N((p-8)/5+2):1,O=r/2-p/2+M-1,sa+=r-O,sa/=w,1===ma?sa=(i-ua)/2+r/2-O:2===ma&&(sa=i-(ua+2+O)/w),a.textBaseline!==H&&(a.textBaseline=H),P=k.cellOverflowLayout,Q=P&&P.layout,R={x:Q?Q.x:c+1,y:Q?Q.y:d+1,width:Q?Q.width:e-2,height:Q?Q.height:i-2},P&&4===la&&(ra+=(P.expandedWidth-e)/2),S=Q&&Q.width>e||4===la,T=R.x,U=R.y,W=R.width,X=R.height,ka)if(a.rect(T,U,W,X),a.clip(),a.beginPath(),Y=d+sa,wa>1){for(Z=c+ra,a.textAlign===G?Z-=L/2:a.textAlign===F&&(Z-=L),ha.Ufc(a,j,k,Z,Y,L,r*wa,ya),I=0;I<wa;I++)a.fillText(va[I],c+ra,Y),pa&&(J=a.measureText(va[I]).width,ha.ip(a,pa,c+ra,Y,J,p,M)),Y+=r;ha.Ufc(a,j,k,Z,Y,L,r*wa,ya)}else ha.Oja(a,l,m,c+ra,d+sa,la,W,ia,pa,M,p,k,j,B,ya,S);else $=y(a,a.font,l)+A,_=$>W-(c+1-T)||r>X,4===la&&(_=!0),aa=na(j,0),ca=na(j,1),da=na(j,2),ea=na(j,3),_||(1===la||4===la?P&&(ga=$/2,(ga>P.backgroundLeftWidth||ga>P.backgroundRightWidth)&&(_=!0)):($+ia+aa+da>W||ua+ea+ca>X)&&(_=!0)),_&&(a.rect(T,U,W,X),a.clip(),a.beginPath()),ha.Oja(a,l,m,c+ra,d+sa,la,W,ia,pa,M,p,k,j,B,ya,S)},a.prototype.nHb=function(a,b,c,d,e,h,i,j,k,l,m,n){var o,p,q,r,s,u,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,O,T,U,W,X,Y,Z,$,_,aa,ba,ca,da,ea,ga=this,ha=i.wordWrap,ia=i.hAlign,ja=i.vAlign,ka=i.shrinkToFit,la=i.textDecoration,ma=2,oa=2,pa=i.font,qa=[],ra=0,sa=parseInt(j.fontInfo.fontSize,10),ta=j.sheet,ua=new f.Rect(c,d,e,h),va=j.cellOverflowLayout,wa=va&&va.layout,xa=i&&(i.borderLeft||i.borderTop||i.borderRight||i.borderBottom)&&!ta.getSpan(j.row,j.col),ya=i.textOrientation,za=ya*Math.PI/180,Aa=S(za),Ba=Q(Aa),Ca=P(Aa),Ea=R(Aa),Fa=j.lineHeight,Ga=90===ya||ya===-90;if(xa&&(ya>-90&&ya<0&&(r=!1),ya>0&&ya<90&&(r=!0)),s={x:wa?wa.x:c+1,y:wa?wa.y:d+1,width:wa?wa.width:e-2,height:wa?wa.height:h-2},u=s.x,w=s.y,x=s.width,y=s.height,z=Fa/2*P(Aa),A=Fa/2*Q(Aa),B=sa>8?N((sa-8)/5+2):1,C=Fa/2-sa/2+B-1,l&&l.content&&l.content.length>0&&!ka&&(k=ga.sHb(a,l.content,h-4,pa)),D=ta.dp(k,pa),fa(a,ta,i,m),3===ia&&(ia=t(ia,b,i.formatter,ya)),v(a,pa),E=0,F=0,n&&(E=ga.Qfc(n.left),F=ga.Qfc(n.right)),!ha&&ka)for(G=0,H={value:!1},I=0;I<3&&H.value===!1&&(G=V(0,(h-4-2*A)/Ca),G<D);I++)pa=g.To.No(pa,G/D,H,!0).font,v(a,pa),sa=parseInt(j.fontInfo.fontSize,10),D=ta.dp(k,pa),Fa=f.Ul.fp(pa),z=Fa/2*P(Aa),A=Fa/2*Q(Aa);if(J=0,K=0,ha)for(K=(h-4-2*A)/Ca,qa=f.Vn.Wn(k,K,pa,!1,a),ra=qa.length,D=ta.dp(qa[0],pa),L=0;L<ra;L++)M=ta.dp(qa[L],pa),M>J&&(J=M);switch(q=(ha?J:D)*Ca+2*A,h<=q&&(ja=2),o=D/2*Ba,p=(ha?J:D)/2*Ca,O=""+ia+ja){case"00":ma+=o+z+E,oa+=p,Ga||(oa+=A),xa&&(ma=(r?1:-1)*((h-oa)/Ea)+(Fa/2+2)/Ca);break;case"01":ma+=o+z+E,oa=h/2,xa&&(ma=(r?1:-1)*((h-oa)/Ea)+(Fa/2+2)/Ca);break;case"02":ma+=o+z+E,oa+=p,Ga||(oa+=A),xa&&(ma=(r?1:-1)*(oa/Ea)+(Fa/2+2)/Ca),oa=h-oa;break;case"10":ma=(e+E-F)/2,oa+=p,Ga||(oa+=A),xa&&(ma+=(r?1:-1)*(h-oa)/Ea);break;case"11":ma=(e+E-F)/2,oa=h/2,xa&&(ma+=(r?1:-1)*(h-oa)/Ea);break;case"12":ma=(e+E-F)/2,oa+=p,Ga||(oa+=A),xa&&(ma+=(r?1:-1)*oa/Ea),oa=h-oa;break;case"20":ma=e-2-o-z-F,oa+=p,Ga||(oa+=A),xa&&(ma=e+(r?1:-1)*((h-oa)/Ea)-(Fa/2+2)/Ca);break;case"21":ma=e-2-o-z-F,oa=h/2,xa&&(ma=e+(r?1:-1)*((h-oa)/Ea)-(Fa/2+2)/Ca);break;case"22":ma=e-2-o-z-F,oa+=p,Ga||(oa+=A),xa&&(ma=e+(r?1:-1)*(oa/Ea)-(Fa/2+2)/Ca),oa=h-oa}if(ha)if(T=c+ma,U=Fa/Ca,W=void 0,ra>1){for(X=ra%2!==0,1===ia&&(T-=X?U*(ra-1)/2:U*(ra/2)-.5*U),Y=Da(T,d+oa,D,za,Fa),Z=Y.width+U*(ra-1),$=Y.height,_=2===ia?Y.x-U*(ra-1):Y.x+U*(ra-1),aa=Y.y,ga.Ufc(a,i,j,_,aa,Z,$,ua),I=0;I<ra;I++)W=I,(i.textOrientation>0&&2===ia||i.textOrientation<0&&(0===ia||1===ia))&&(W=ra-I-1),ga.tHb(a,za,qa[W],T,d+oa,la,sa,B,C),T=2===ia?T-U:T+U;ga.Ufc(a,i,j,_,aa,Z,$,ua)}else ga.Xfc(a,k,c,d,ma,oa,j,i,D,za,la,sa,B,Fa,C,ua);else ba=D*Ca+sa*Ca+2,ca=na(i,0),da=na(i,2),ea=ba>y-(d+1-w)||Fa>y||ba+ca+da>y,ea&&(a.rect(u,w,x,y),a.clip()),ga.Xfc(a,k,c,d,ma,oa,j,i,D,za,la,sa,B,Fa,C,ua)},a.prototype.Xfc=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this,r=Da(c,d,i,j,n),s=r.width,t=r.height,u=r.x,v=r.y;q.Ufc(a,h,g,u,v,s,t,p),q.tHb(a,j,b,c+e,d+f,k,l,m,o),q.Ufc(a,h,g,u,v,s,t,p)},a.prototype.V_a=function(a,b,c,d){Ca(a,b,c,d)},a.prototype.W_a=function(a,b,c,d,e,f,h){var i,j,k,l=0,m={value:!1};for(i=0;i<3&&m.value===!1&&(j=ia(a,e,f,h),l=V(0,(h?c:b)-4),(h?d.vAlign:1!==d.hAlign&&d.textIndent)&&(l=V(0,l-8*d.textIndent)),l<j);i++)for(k=0;k<a.length;k++)a[k].style.font=g.To.No(a[k].style.font,l/j,m,!0).font},a.prototype.U_a=function(a,b,c,d,e){var f=a.richText;return!q(f)&&c||(f=[{style:{font:d,foreColor:e},text:b}]),f},a.prototype.Z_a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=h&&h.layout,p={x:o?o.x:c+1,y:o?o.y:d+1,width:o?o.width:e-2,height:o?o.height:f-2},q=p.x,r=p.y,s=p.width,t=p.height;return g?(a.rect(q,r,s,t),a.clip(),a.beginPath()):(n=this.b0a(b,i,b.vAlign,c,d,t,s,q,r,l,m,j,k,h),n&&(a.rect(q,r,s,t),a.clip(),a.beginPath())),p},a.prototype.b0a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q=na(a,0),r=na(a,1),s=na(a,2),t=na(a,3);return m?(o=j>f-(e+1-i)||k>g,(!o&&1!==c&&j+l+q+s>f||k+t+r>g)&&(o=!0)):(o=j>g-(d+1-h)||k>f,o||(1===b?n&&(p=j/2,(p>n.backgroundLeftWidth||p>n.backgroundRightWidth)&&(o=!0)):(j+l+t+r>g||k+q+s>f)&&(o=!0))),o},a.prototype.X_a=function(a,b,c,d,e,h,i,j,k){var l,m,n,o,p;if(1!==h?d=d-3-e:d-=3,i)return f.Vn.M_a(b,d,c,k,j,a);for(l=0,m=0;m<k.length;m++)n=k[m].text,j?l+=s(k[m].style.font)*(n?n.length:0):(o=g.To.No(k[m].style.font,1),p=k[m].style.vertAlign?o.fontSize*W+"px "+o.fontFamily:k[m].style.font,l+=y(a,p,n));return[{textLength:l,text:b,textInfos:k}]},a.prototype.__a=function(a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s){var t,u=k.font,v=g.To.No(u,1).fontSize,w=v>8?N((v-8)/5+2):1;this.L$a(a,b,k),o?this.c0a(a,c,d,k,e,f,m,n,m,q,r,s):(t=l>h,this.Oja(a,c,d,e,f,j,l,n,k.textDecoration,w,v,q,k,r,s,t,p))},a.prototype.c0a=function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r=this,s=c.content,t=f;if(r.Ufc(a,d,j,e,t,i,i*b.length,l),s&&s.length>0)for(n=za(a,s,!0),o=g-h-n-2,o=o>0?o:0,p=void 0,m=0;m<s.length;m++)"fillingChar"===s[m].type?(q=Aa(a,o,s[m].value,!0),this.vWa(a,q,e,f),f+=o):"placeholder"===s[m].type?f+=s[m].value?s[m].value.length*i:0:"numberPlaceholder"===s[m].type?f+=i:(this.vWa(a,s[m].value,e,f),p=s[m].value?s[m].value.length*i:0,f+=p);else if(b)for(m=0;m<b.length;m++)f=this.vWa(a,b[m],e,f,i).y;r.Vfc(a,d,j,e,t,i,f-t,l)},a.prototype.d0a=function(a){var b=E;return 1===a?b=G:2===a&&(b=F),b},a.prototype.a0a=function(a,b,c,d,e,f,g,h){var i,j,k=[],l=g.textInfos;for(i=0;i<l.length;i++)k.push(C(!0,{},e,l[i].style));for(i=0;i<l.length;i++)j=this.f0a(a,b,c,d,k[i],l[i].text,h),c=j.x,d=j.y},a.prototype.Y_a=function(a,b,c,d){var e,f,g=[],h=a.length;for(e=0;e<h;e++)f=this.g0a(b,c,d,a[e].textInfos),g.push(f);return g},a.prototype.g0a=function(a,b,c,d){var e,f,h,i,j=this,k=0,l=0;for(e=0;e<d.length;e++)f=void 0,f=d[e].style&&d[e].style.font?d[e].style.font:a.font,k=Math.max(s(f,M,u(d[e].text)),k),l=Math.max(g.To.No(f,1).fontSize,l),(d[e].style&&1===d[e].style.vertAlign||2===d[e].style.vertAlign)&&(k=Math.max(s(f,M,u(d[e].text))+2*g.To.No(f,W).fontSize*.218,k));return h=l>8?N((l-8)/5+2):1,i=k/2-l/2+h-1,{lineHeight:k,fontSize:l,baselineOffset:h,lineOffset:i,font:a.font,foreColor:a.foreColor,textDecoration:a.textDecoration,isVerticalText:a.isVerticalText,textAlign:j.d0a(b),textBaseline:H,opacity:c}},a.prototype.h0a=function(a,b,c){var d=0,e=0,f;for(f=0;f<a.length;f++)e+=b[f].lineHeight,d=Math.max(a[f].textLength,d);return{width:c?e:d,height:c?d:e}},a.prototype.$_a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=this.h0a(j,k,h),p=o.height,q=o.width,r=[];if(h)for(n=0;n<j.length;n++)r.push(this.i0a(a,b,c,d,e,f,g,q,j[n].textLength,k[n].lineHeight,k[n].lineOffset,i,l,j[n],m)),i?a-=k[n].lineHeight:a+=k[n].lineHeight;else for(n=0;n<j.length;n++)r.push(this.j0a(a,b,c,d,e,f,g,j[n].textLength,p,k[n].lineHeight,k[n].lineOffset,l)),b+=k[n].lineHeight;return r},a.prototype.j0a=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=0,n=0,o=l.left,p=l.right;return n=1===f?(d-i)/2+j-k:2===f?d-i-2+j-k:2+j-k,1===e||4===e?m=(c-h+o-p)/2:2===e?(m=c-1-2-h-p,m-=g):m=2+g+o,{x:a+m,y:b+n}},a.prototype.i0a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q=0,r=0,s=m.left,t=m.right;return l?0===e?q=2+h+t-j/2:1===e?q=(c-s+t+h)/2-j/2:2===e&&(q=c-s-1-2-j/2):1===e?q=(c-h+s-t)/2+j/2:2===e?q=c-1-2-t-h+j/2:0===e&&(q=2+s+j/2),r=1===f?(d-i)/2:2===f?d-g-i-2:2+g,{x:a+q,y:b+r}},a.prototype.f0a=function(a,b,c,d,e,f,g){var h,i;return a.save(),this.L$a(a,b,e),h=e.vertAlign,i=e.isVerticalText?this.vWa(a,f,c,d,e.textDecoration,e.baselineOffset,g):this.k0a(a,c,d,e,f,h),a.restore(),i},a.prototype.L$a=function(a,b,c){fa(a,b,c);var d=c.vertAlign?this.l0a(c.font):c.font;q(c.textBaseline)||a.textBaseline===c.textBaseline?q(a.textBaseline)&&a.textBaseline!==H&&(a.textBaseline=H):a.textBaseline=c.textBaseline,c.isVerticalText?a.textAlign!==G&&(a.textAlign=G):a.textAlign!==E&&(a.textAlign=E),v(a,d)},a.prototype.l0a=function(a){var b=g.To.Ko(a),c=parseFloat(b.fontSize)*W;return b.fontSize=c+"px",this.m0a(b)},a.prototype.m0a=function(a){var b="",c="normal",d="Calibri",e=a.fontStyle,f=a.fontSize,g=a.fontWeight,h=a.fontFamily;return b=void 0!==e?e:c,b+=void 0!==g?(b?" ":"")+g:(b?" ":"")+c,b+=(b?" ":"")+f,b+=void 0!==h?(b?" ":"")+h:(b?" ":"")+d},a.prototype.vWa=function(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r;if(b&&b.length>0)for(i=a.font,j=s(i,M,u(b)),k=ca(g.To.No(i,1).fontSize,j),l=this.pHb(a,"0"),m=l/2,n=0;n<b.length;n++)o=da(b[n]),p=void 0!==h&&n>=h&&n<=h+2&&(h+3===b.length||0===h&&h+3<b.length||0!==h&&h+3<b.length),q=p?l:j,r=p?m:k,d=d+q-r,a.fillText(o,c,d),this.Mxb(a,e,c,d,y(a,a.font,o),g.To.No(a.font,1).fontSize,f),
d+=r;return{x:c,y:d}},a.prototype.Mxb=function(a,b,c,d,e,f,g){var h,i,j,k,l;a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),h=0,i=0,j=.5,k=f<=12?12:f,i=N((k-12)/21+1),a.lineWidth!==i&&(a.lineWidth=i),0===(1&i)&&(j=0),l=a.textAlign,l===G?c-=e/2:l===F&&(c-=e),a.beginPath(),2===(2&b)&&(h=O(d+g-f/2)-j,a.moveTo(c,h),a.lineTo(c+e,h)),a.stroke()},a.prototype.k0a=function(a,b,c,d,e,f){var h,i,j,k,l;return q(e)?{x:b,y:c}:(h=g.To.No(a.font,1).fontSize,i=h>8?N((h-8)/5+2):1,j=0,f?(j=1===f?.74*h:.28*-h,a.fillText(e,b,c-j)):a.fillText(e,b,c),k=y(a,a.font,e),l=d.textDecoration,this.ip(a,l,b,c,k,h,i-j),{x:b+k,y:c})},a.prototype.jp=function(b,c,d,e,f,g,h,i){var j={row:i.row,col:i.col,sheet:i.sheet,sheetArea:i.sheetArea,style:h,underline:h.textDecoration,foreColor:h.foreColor};a.ao(i.sheet,"applyHyperlinkStyle",j),this.paint(b,c,d,e,f,g,h,i)},a.prototype.paint=function(a,b,c,d,e,g,h,i){var j,k,l;a&&(j=h.backColor,i.parentBackColor!==j&&ka(a,c,d,e,g,i.imageLoader,h,b,i),k=this,l=new f.Rect(c,d,e,g),k.Sfc(a,i,l,b,h),k.i5&&(k.i5(a,l,h,i),l=k.f5(l,h,ba(i)?i.printZoomFactor:i.sheet.zoom())),i.cellOverflowLayout||k.uxb(a,l,i,x(b)),l.width>0&&l.height>0&&(h&&h.showEllipsis&&i.sheet.ITa.qHb(i.row,i.col,null,i.sheetArea),k.paintContent(a,b,l.x,l.y,l.width,l.height,h,i)))},a.prototype.paintContent=function(a,b,c,d,e,g,h,i){var j,k,l,m,n,o,p,q,r=i.sheetArea;2!==r&&1!==r||(j=i.visualState||0,k="columnHeader",2===r&&(k="rowHeader"),l=this.getThemeStyle(i.visualState,"gc-"+k+"-"+f.Im.Jm(j)),$.gp(a,c,d,e,g,h,k,l,r)),n=i.conditionalFormats,n&&(m=n.jp(a,x(b),c,d,e,g,h,i)),i.showBarIconOnly=m,o=i.sparkline,o&&o.paintSparkline(a,c,d,e,g),p=$.bDc(a,x(b),c,d,e,g,i),i.cellOverflowLayout||m||p||(q=new f.Rect(c,d,e,g),this.paintValue(a,b,q.x,q.y,q.width,q.height,h,i))},a.prototype.adjustRectForIconSet=function(a,b,c,d,e,f,g){la(a,b,c,d,e,f,g)},a.prototype.hasInfilling=function(a){for(var b=0;b<a.length;b++)if("fillingChar"===a[b].type)return!0;return!1},a.prototype.createEditorElement=function(a,b){return L},a.prototype.getEditorValue=function(a,b){return L},a.prototype.kp=function(a,b,c,d){return c},a.prototype.setEditorValue=function(a,b,c){},a.prototype.getEditingElement=function(){return L},a.prototype.parse=function(a,b,c){var e,f,g=q(b),h=q(a);try{if(e=d.Formatter&&d.Formatter.GeneralFormatter,!g&&!h&&e)return f=typeof b===J?new e(b):b,f.parse(a)}catch(a){}return h?"":""+a},a.prototype.format=function(a,b,c,e){var g,h,i,k,o,p,r=A(b);if(e&&r&&(g=e.sheet,h=g.aHb(e.row,e.col,b),q(h)||(a=h)),q(a)||""===a)return"";if(e&&e.quotePrefix&&typeof a===J)return""+a;if(!r&&typeof b===J&&"object"!=typeof a)return f.mn.un(a,b,c);if(!b||"General"===b||r)return"boolean"==typeof a||a instanceof Boolean?(j&&(a=a?j.getBoolean().boolean_true:j.getBoolean().boolean_false),(""+a).toUpperCase()):a instanceof Date?(i=l.q4(l.culture()).DateTimeFormat,k=i.shortDatePattern,0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(k=i.defaultDatePattern),n.Vb(a,k)):(typeof a===K&&(a=m.nb(""+a)),""+a);try{return o=d.Formatter&&d.Formatter.GeneralFormatter,o?(p=L,p=typeof b===J?f.mn.tn(b):b,p.format(a,c)):""+a}catch(b){return""+a}},a.prototype.focus=function(a,b){a&&a.focus&&a.focus()},a.prototype.getThemeStyle=function(a,b){return f.Im.Km(a,b)},a.prototype.activateEditor=function(a,b,c,d,e,f,g){},a.prototype.deactivateEditor=function(a,b){},a.prototype.selectAll=function(a,b){a&&a.select&&a.select()},a.prototype.updateEditor=function(a,b,c,d,e,f,g){},a.prototype.setImeMode=function(a,b,c){this.isImeAware(c)?this.updateImeMode(a,b,c):a&&$.hp(a,0)},a.prototype.updateImeMode=function(a,b,c){a&&$.hp(a,b)},a.prototype.getHitInfo=function(a,b,c,d,e){return L},a.prototype.getCellAndPaddingHitInfo=function(b,c,d,e,f){var g,h,i=this;if(f){if(g={x:b,y:c,context:f,cellStyle:d,cellRect:e,paddingHitInfo:null},a.ao(f.sheet,"getCellButtonHitInfo",g,function(){return null!==g.paddingHitInfo&&void 0!==g.paddingHitInfo}),h=g.paddingHitInfo,g.paddingHitInfo&&!q(g.paddingHitInfo.cellButtonHitInfo)&&!q(g.paddingHitInfo.cellButtonHitInfo.buttonConfig))return g.paddingHitInfo;if(g.cellRect=i.f5?i.f5(g.cellRect,d,f.sheet.zoom()):g.cellRect,a.ao(f.sheet,"getCellTextHitInfo",g,function(){return!q(g.paddingHitInfo)&&g.paddingHitInfo.isReservedLocation}),g.paddingHitInfo&&g.paddingHitInfo.isReservedLocation)return g.paddingHitInfo;if(3===f.sheetArea)return a.ao(f.sheet,"getCellPaddingHitInfo",g,function(){return!q(g.paddingHitInfo)&&g.paddingHitInfo.isReservedLocation}),g.paddingHitInfo?g.paddingHitInfo:h?h:this.getHitInfo(b,c,d,e,f)}return this.getHitInfo(b,c,d,e,f)},a.prototype.processCellAndPaddingMouseDown=function(b){return a.ao(b.sheet,"processMouseDownOnCellPadding",b),this.processMouseDown(b)},a.prototype.processMouseDown=function(a){return!1},a.prototype.YBb=function(b){return a.ao(b.sheet,"processMouseMoveOnCellPadding",b),this.processMouseMove(b)},a.prototype.processMouseMove=function(a){return!1},a.prototype.XGb=function(b){return a.ao(b.sheet,"processMouseUpOnCellPadding",b),this.processMouseUp(b)},a.prototype.processMouseUp=function(a){return!1},a.prototype.processMouseEnter=function(a){return!1},a.prototype.ZBb=function(b){return a.ao(b.sheet,"processMouseLeaveOnCellPadding",b),this.processMouseLeave(b)},a.prototype.processMouseLeave=function(a){return!1},a.prototype.isReservedKey=function(a,b){return!1},a.prototype.isEditingValueChanged=function(a,b,c){var d=c.sheet,e=c.row,f=c.col,g=d&&d.getValue(e,f,3,h.ValueType.richText);return g&&g.richText&&(a=a.replace(/\r\n?/g,"\n")),a===L&&(a=M),b===L&&(b=M),a!==b},a.prototype.processCompositionStart=function(a,b){return!1},a.prototype.processKeyDown=function(a,b){return!1},a.prototype.processKeyUp=function(a,b){return!1},a.prototype.getAutoFitWidth=function(a,b,c,d,e){return $.cp(a,b,c,d,e)},a.prototype.getAutoFitHeight=function(a,b,c,d,e){return $.ep(a,b,c,d,e)},a.prototype.Oja=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t=this;c&&c.content&&c.content.length>0&&(r||!p||4===f)?this.Pja(a,c.content,d,e,f,g,h,i,j,k,l,m,n,o,q):(q=q?q:y(a,a.font,b),s=d,a.textAlign===G?s-=q/2:a.textAlign===F&&(s-=q),t.Ufc(a,m,l,s,e,q,l.lineHeight,o),a.fillText(b,d,e),i&&this.ip(a,i,d,e,q,k,j),t.Vfc(a,m,l,s,e,q,l.lineHeight,o))},a.prototype.tHb=function(a,b,c,d,e,f,g,h,i){if(a.save(),a.textAlign="center",a.textBaseline="middle",a.translate(d,e),a.rotate(-b),a.fillText(c,0,0),f){var j=a.measureText(c).width;this.ip(a,f,0,i,j,g,h)}a.restore()},a.prototype.sHb=function(a,b,c,d){var e,f,g,h;for(a.font||v(a,d),e=za(a,b),f=c-e,f=f>0?f:0,g=[],h=0;h<b.length;h++)if("fillingChar"===b[h].type)g.push(Aa(a,f,b[h].value));else{if("placeholder"===b[h].type||"numberPlaceholder"===b[h].type)continue;g.push(b[h].value)}return g.join("")},a.prototype.Pja=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,r,s,t,u,v,w;a.save(),a.textAlign!==E&&(a.textAlign=E),p=this,r=za(a,b),s=m?m.left:0,t=m?m.right:0,u=s+t,v=f-g-r-u-2,v=v>0?v:0,q(o)?this.hasInfilling(b)?1===e||4===e?(c-=(f+s-t)/2,c+=g+s):2===e&&(c=c-f+t+2,c+=g+s):q(r)||(1===e||4===e?c-=r/2:2===e&&(c-=r)):this.hasInfilling(b)?1===e?(c=c+(o?o:r)/2-(f+s-t)/2,c+=g+s):2===e&&(c=c+(o?o:r)-f+t+2,c+=g+s):q(r)||(1===e?c=c+o/2-r/2:2===e&&(c=c+o-r)),p.Ufc(a,l,k,c,d,r,k.lineHeight,n),w=this.Qja(a,b,c,d,v,h,i,j),p.Vfc(a,l,k,c,d,w-c,k.lineHeight,n),a.restore()},a.prototype.Qja=function(a,b,c,d,e,f,g,h,i){var j,k,l,m=0;for(X[a.font+"0"]?m=X[a.font+"0"]:(m=y(a,a.font,"0"),X[a.font+"0"]=m),j=0;j<b.length;j++)"fillingChar"===b[j].type?(a.fillText(Aa(a,e,b[j].value),c,d),f&&this.ip(a,f,c,d,e,h,g),c+=e):"placeholder"===b[j].type?c+=y(a,a.font,b[j].value):"numberPlaceholder"===b[j].type?c+=m:(k=b[j].value,k!==L&&a.fillText(k,c,d),l=y(a,a.font,k),f&&this.ip(a,f,c,d,l,h,g),c+=l);return c},a.prototype.ip=function(a,b,c,d,e,f,g){var h,i,j,k,l;a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),h=a.textAlign,i=0,j=0,k=.5,l=f<=12?12:f,j=N((l-12)/21+1),a.lineWidth!==j&&(a.lineWidth=j),0===(1&j)&&(k=0),h===G?c-=e/2:h===F&&(c-=e),a.beginPath(),4===(4&b)&&(i=O(d+g-f-1)-k,a.moveTo(c,i),a.lineTo(c+e,i)),2===(2&b)&&(i=O(d+g-f/2)-k,a.moveTo(c,i),a.lineTo(c+e,i)),1===(1&b)&&(i=O(d+g-1)-k,a.moveTo(c,i),a.lineTo(c+e,i)),8===(8&b)&&(i=O(d+g-1)-k,a.moveTo(c,i-j),a.lineTo(c+e,i-j),a.moveTo(c,i+j),a.lineTo(c+e,i+j)),a.stroke()},a.prototype.lp=function(a,b){var c="";4===(4&b)&&(c="overline"),2===(2&b)&&(c+=" line-through"),1===(1&b)&&(c+=" underline"),a.css("text-decoration",c)},a.prototype.gQa=function(){return L},a.prototype.isImeAware=function(a){return!1},a.prototype.isEditting=function(){return!1},a.prototype.lJc=function(a){},a.prototype.toJSON=function(){var a,b={},c=this;for(a in c)c.hasOwnProperty(a)&&(b[a]=c[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)q(a[b])||(this[b]=a[b])},a}(),b.Base=aa,f.Zn(aa),i._o[0]=aa;function ga(a,b,c,d){var e,f,g=a.conditionalFormats;if(g)return e=a.getValue(b,c,d),f=g.oRa(a,b,c,e).iconSet,g.bp(b,c,d)&&f}function ha(a,b,c){var d,e,f=0;for(d=0;d<a.length;d++)e=void 0,e=a[d].style&&a[d].style.font?a[d].style.font:b,f=Math.max(s(e,M,u(a[d].text))/c,f),(a[d].style&&1===a[d].style.vertAlign||2===a[d].style.vertAlign)&&(f=Math.max(s(e,M,u(a[d].text))/c+2*g.To.No(e,W).fontSize*.218,f));return f}function ia(a,b,c,d,e){var h,i,j,k,l,m=f.Vn.bm();if(!m)return 0;for(h=0,i=0;i<a.length;i++)j=void 0,j=a[i].style&&a[i].style.font?a[i].style.font:b,a[i].style&&a[i].style.vertAlign&&(j=g.To.No(j,W).font),v(m,j),k="",k=i===a.length-1&&e?f.Vn.Rvb(a[i].text):a[i].text,l=0,d?l=s(j)*k.length/c:q(a[i].text)||(l=y(m,j,a[i].text)/c),h+=l;return h}function ja(a,b,c,d,e){var g,h,i=f.Vn.bm();if(!i)return 0;for(g=0,h=0;h<a.length;h++)g+=ia(a[h],b,c,d,e);return g}function ka(a,b,c,d,e,f,h,i,j){var k,l,m,n=h.backColor,o=h.backgroundImage,p=h.textOrientation,q=h.isVerticalText,r=h.textIndent&&0!==h.textIndent,s=h.backgroundImageLayout,t=j.row,u=j.col,v=j.sheet&&j.sheet.getSpan(t,u),w=h&&(h.borderLeft||h.borderTop||h.borderRight||h.borderBottom),x=0,y=b,z=!1;a.save(),p&&0!==p&&w&&i&&!v&&!q&&!r?(k=S(p*Math.PI/180),l=R(k),x=N(e/l),p>-90&&p<0&&(y=b-x),p>0&&p<90&&(y=b+x),m=function(){a.beginPath(),a.moveTo(y,c),a.lineTo(y+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.fill()}):m=function(){a.fillRect(b,c,d,e)},(n||o)&&(n&&g.To.setFillStyle(a,n,Math.min(y,b),c,d+x,e,m),$.ap(a,b,c,d,e,o,s,f)),a.restore()}function la(a,b,c,d,e,f,g){if((0===a||g)&&ga(b,c,d,e)){var h=ma(b);f.x+=h,f.width-=h}}function ma(a){return parseInt(I*a.zoom(),10)}function na(a,b,c,d){var e=a.cellPadding,f=0,g=a.labelOptions;return c&&(e=g?g.margin:"0"),e&&(f=parseInt(ta(e)[b],10),f=typeof f===K&&f>0?f:0),d===M?f:f*d}function oa(a){var b={context:a,value:0};return aa.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function pa(a,b){var c={context:a,value:0,cellStyle:b};return aa.ao(a.sheet,"getCellButtonAutoWidth",c),c.value}function qa(a,b){var c={context:a,value:0,cellStyle:b};return aa.ao(a.sheet,"getSpecialIconsAutoWidth",c),c.value}function ra(a,b){var c={context:a,value:0,cellStyle:b};return aa.ao(a.sheet,"getCellButtonAutoHeight",c),c.value}function sa(a,b,c,d){var f,g,h,i,j=d&&d.sheet;j&&c&&(f=d.canvasOffset||j.mm.bG(),g=j.Dr(),h=b.backColor||"white",h.stops&&(i=h.stops,h=i[0]&&i[0].color),h.backgroundColor&&(h=h.backgroundColor),e.GC$(a).width(c.width).height(c.height).css({top:f.top+g.y+c.y-2,left:f.left+g.x+c.x-2,"background-color":h}))}function ta(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===J&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}function ua(a,b){var c,d=na(a,0),e=na(a,2),f=na(a,0,!0),g=na(a,2,!0);if(na(a,3,!0)+na(a,1,!0)>=b.width)return!1;if(c=a.labelOptions.alignment,c===M&&(c=a.labelOptions.alignment=0),0===c||1===c||2===c){if(d>0&&f+g<d)return!0}else if((3===c||4===c||5===c)&&d<b.height&&e>0&&f+g<e)return!0;return!1}function va(a,b){var c=na(b,0),d=na(b,3,!0),e=na(b,2,!0),f=a.clone(),g=b.labelOptions.alignment;return 0===g||1===g||2===g?c<a.height&&(f.height=c-e+1):3!==g&&4!==g&&5!==g||(f.height=a.height-e),f.x+=d,f.width-=d+na(b,1,!0),f}function wa(a){var b="left";return 1===a||4===a?b="center":2!==a&&5!==a||(b="right"),b}function xa(a,b,c,d){var e=new f.Point(a.x,a.y),g=parseInt(c.fontSize,10),h=na(b,0),i=na(b,2),j=na(b,3,!0),k=na(b,1,!0),l=a.width,m=a.height,n=g>8?Math.floor((g-8)/5+2):1,o=d/2-g/2+n-1,p=g>8?1:2,q=d-o+na(b,0,!0),r=q+1,s=h+i>m?h+q:m-i+q-1;switch(b.labelOptions.alignment){case 0:e.x+=j+p+1,e.y+=r;break;case 1:e.x+=j+(l-j-k)/2,e.y+=r;break;case 2:e.x+=l-k-2,e.y+=r;break;case 3:e.x+=j+p+1,e.y+=s;break;case 4:e.x+=j+(l-j-k)/2,e.y+=s;break;case 5:e.x+=l-k-2,e.y+=s}return e}function ya(a,b){var c=na(b,3,!0),d=na(b,1,!0),e=na(b,0,!0),f=na(b,2,!0),g=a.clone(),h=b.labelOptions.alignment;return g.x=c+1,g.width-=c+d,0===h||1===h||2===h?(g.y=e,g.height=na(b,0)-e-f):3!==h&&4!==h&&5!==h||(g.y=a.height-na(b,2)+e,g.height=na(b,2)-e-f),2!==h&&5!==h||(g.width-=2),g}function za(a,b,c){var d,e,f;if(r(b,J))return d=0,X[a.font+b]?d=X[a.font+b]:(d=y(a,a.font,b),X[a.font+b]=d),d;if(c&&b&&b[0]&&b[0].value)return b[0].value.length*s(a.font);for(e=0,f=0;f<b.length;f++)"fillingChar"!==b[f].type&&(d=0,X[a.font+b[f].value]?d=X[a.font+b[f].value]:(d=y(a,a.font,b[f].value),X[a.font+b[f].value]=d),e+=d);return e}function Aa(a,b,c,d,e){var f;return f=d?Math.floor(b/e):Math.floor(b/y(a,a.font,c)),Array(f+1).join(c)}function Ba(a){var b=a.clone();return b.width--,b.height--,b}function Ca(a,b,c,d){var e,f,h;for(e=0;e<a.length;e++)f=void 0,a[e].style=a[e].style||{},h=a[e].style,f=h.font?g.To.No(h.font,c).font:b,q(d)||(f=g.To.No(f,d).font),h.font=f}function Da(a,b,c,d,e){var g=c*Q(-d)+e*P(-d),h=c*Q(-d)+e*P(-d),i=a-g/2,j=b-h/2;return new f.Rect(i,j,g,h)}},"./dist/core/celltype/cellType.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/core/celltype/celltype.ns.js")),d(c("./dist/core/celltype/basecelltype.js")),d(c("./dist/core/celltype/textcelltype.js")),d(c("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b._o={}},"./dist/core/celltype/headercelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/celltype/basecelltype.js"),j=c("./dist/core/core.enum.js"),k=f.Im,l=f.Vn,m=f.Ul.wl,n=f.Ul.uWa,o=f.Ul.lZa,p=d.Common.j.Fa,q=f.Ul.K_a,r=e.GC$.extend,s="none",t=void 0,u=Math.floor,v=f.Rect;function A(a,b){return a=a||0,k.Km(a,"gc-"+b+"-"+k.Jm(a))}function B(a,b,c,d,e,f){var g=new Image,h=f;h=h.replace('url("',""),h=h.replace('")',""),g.src=h,a.drawImage(g,b,c,d,e)}function C(a,b,c,d,e,f,h,k,l){var n,o,q,r,t,u,v,w,x,y,z,A,C;function D(){a.fillRect(b+1,c+1,d-1,e-1)}if(!p(k)){if(a.save(),a.beginPath(),n=f.backColor,0===k&&n)g.To.setFillStyle(a,n,b,c,d,e,D);else try{if(n=l&&l.backgroundColor,o=l&&l.backgroundImage,q=h.sheet,r=h.row,t=h.col,u=h.sheetArea,v=void 0,w=!1,q.cellStates&&k===j.VisualState.hover&&(v=q.cellStates.getStyle(r,t,u),v&&v.backColor&&(n=v.backColor,w=!0)),!w&&o&&o.indexOf("linear-gradient")!==-1){for(x=m(o),y={degree:90,stops:[]},z=0,A=x.length;z<A;z++)C=x[z],y.stops.push({position:C.point,color:C.color});g.To.setFillStyle_Gradient(a,y,b,c,d,e,D)}else n?(a.fillStyle=n,D()):o&&o!==s&&B(a,b+1,c+1,d-1,e-1,o)}catch(a){}2===h.columnHeaderFitMode&&(d=h.sheet.getColumnWidth(h.col)+1),i.Context.ap(a,b,c,d,e,f.backgroundImage,f.backgroundImageLayout,h.imageLoader),a.restore()}}function D(a,b,c,d,e,g,h,j,k,l,m,n){var o,p,q,r,s;b&&(o=k.visualState||0,p=A(o,l),C(b,d,e,g,h,j,k,o,p),i.Context.gp(b,d,e,g,h,j,l,p,m,k.needTopGridline,k.needLeftGridline),q=new f.Rect(d,e,g,h),a.Sfc(b,k,q,c,j),a.i5&&(a.i5(b,q,j,k),r=k.printZoomFactor,s=k.isPrinting&&"number"==typeof r&&1!==r?r:k.sheet.zoom(),q=a.f5(q,j,s)),q.width>0&&q.height>0&&a.paintContent(b,c,q.x,q.y,q.width,q.height,j,k,n))}function E(a,b,c,d,e,f){var h,i={font:b,fillStyle:c},j=d.sheet;return 0!==d.visualState&&parseInt(f.zIndex,10)>2007&&j.vp(d.row,d.col,e)&&(h=void 0,h=j.wp(d.row,d.col,e)?a(d.visualState,"gc-columnHeader-selected"):a(d.visualState,"gc-columnHeader-highlight"),i.fillStyle=h.color,i.font=g.To.Ro(i.font,"bold")),i}function F(a,b,c,d,e,g,h,i,k,l,m,n){var o,r,s,u,v,w={},x=a.format(q(c),i.formatter,w),y=k.sheet;x&&(b.save(),b.beginPath(),o=y.rowFilter&&y.rowFilter(),r=k.columnHeaderFitMode,s=!!(o&&o.Dl(k.row,k.col,l)&&o.filterButtonVisible(k.col)),!s&&!n||r===j.ColumnHeaderFitMode.stack&&!p(k.cornerX)||(g-=y.oK(new f.Rect(d,e,g,h),l).width),u=i.foreColor,u||(u=m.color),u&&b.fillStyle!==u&&(b.fillStyle=u),1===k.columnHeaderFitMode?(v=E(a.getThemeStyle,i.font||b.font,b.fillStyle,k,l,m),i.foreColor=v.fillStyle,i.font=f.util.hZa(v.font),i.textOrientation=-90,a.nHb(b,c,d,e,g,h,i,k,x,w,t,t)):c&&c.richText&&c.richText.length>0||i.isVerticalText?G(a,y,b,c,d,e,g,h,i,x,w,k,l,m):H(a,b,c,d,e,g,h,i,x,w,k,l,m),b.restore())}function G(a,b,c,d,e,f,g,h,i,j,k,l,m,o){var p,s,u,w,x,y,z,A,B,C,D,F,G,H,K,L,M,N=new v(e,f,g,h),O=E(a.getThemeStyle,i.font||c.font,c.fillStyle,l,m,o),P=i.isVerticalText,Q=i.hAlign,R=J(i),S=a.T_a(i.formatter||i._autoFormatter,d.text),T=r(!0,[],a.U_a(d,j,S,O.font,O.fillStyle));if(d&&d.richText&&d.richText.length>0&&(p=l.sheet?l.sheet.zoom():1,s=l.printZoomFactor,s=l.isPrinting&&"number"==typeof s&&1!==s?s:t,a.V_a(T,O,p,s)),u=a.Pfc(c,q(d),i,l,e,f,g,h),w=a.Qfc(u.externals.left),x=a.Qfc(u.externals.right),y=w+x,z={left:w,right:x},!i.wordWrap&&i.shrinkToFit&&a.W_a(T,g-y,h,i,O,1,P),A=a.X_a(c,j,i.font,P?h:g-y,R,P?i.vAlign:i.hAlign,i.wordWrap,P,T),B=a.Y_a(A,i,Q),I(c,i,e,f,g,h,R,A[0].textLength,B[0].lineHeight),C=P?n(j):t,D=!1,i.wordWrap||i.shrinkToFit||!i.showEllipsis||!P||d.richText||(D=!0),F=a.$_a(N.x,N.y,N.width,N.height,Q,i.vAlign,R,P,C,A,B,z,D),G=[],D&&k&&(k.content&&1===k.content.length&&"text"===k.content[0].type||!k.content&&1===A.length&&A[0].text)&&a.oHb(c,l,A,B,i,h,f,R,F,G),H=A.length,1===H&&k.content&&!S)a.__a(c,b,j,k,F[0].x,F[0].y,g,h,Q,i,N.width,N.height,R,P,A[0].textLength,l,z,N);else for(K=0;K<H;K++)L=a.Wfc(A),M=F[0].x,"center"===c.textAlign?M-=L/2:"right"===c.textAlign&&(M-=L),a.Ufc(c,i,l,M,F[0].y,L,0,N),a.a0a(c,b,F[K].x,F[K].y,B[K],Q,A[K],G[K]),a.Ufc(c,i,l,M,F[0].x,L,0,N)}function H(a,b,c,d,e,f,h,i,k,m,n,q,r){var s,t,w,x,y,z,A,B,C,D,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca=new v(d,e,f,h),da=n.columnHeaderFitMode,ea=E(a.getThemeStyle,i.font||b.font,b.fillStyle,n,q,r);if(o(b,ea.font),b.fillStyle=ea.fillStyle,s=0,t=i.textIndent,t>0&&(s=8*t),w=parseInt(n.fontInfo.fontSize,10),x=i.hAlign,y=i.vAlign,z="left",A=2,B=a.Pfc(b,k,i,n,d,e,f,h),C=a.Qfc(B.externals.left),D=a.Qfc(B.externals.right),F=C+D,G={left:C,right:D},A+=s+C,da!==j.ColumnHeaderFitMode.stack||p(n.cornerX)||(h=n.cornerY-e,x=0),1===x?(A=(f+C-D)/2,z="center"):2===x&&(A=f-D-1,A-=s,z="right"),b.textAlign!==z&&(b.textAlign=z),H=0,I="alphabetic",J=2,K=i.wordWrap,L=i.shrinkToFit,M=i.font,N=n.lineHeight,O=[],P=0,!K&&L)for(Q=0,R={value:!1},S=0;S<3&&R.value===!1&&(T=b.measureText(k).width,Q=Math.max(0,f-4-(1===x?0:s)),Q<T);S++)M=g.To.No(M,Q/T,R,!0).font,o(b,M);if(U=0,K&&(U=f-F-3-s,U-=1,O=l.Wn(k,U,ea.font),P=O.length,P>1&&0!==y&&(H=(P-1)*N)),V=w>8?u((w-8)/5+2):1,W=N/2-w/2+V-1,!K&&i.showEllipsis&&a.rHb(n,m,k,b,f,x,s),J+=N-W,1===y?J=(h-H)/2+N/2-W:2===y&&(J=h-H-2-W),b.textBaseline!==I&&(b.textBaseline=I),X=i.textDecoration,Y=ca.x,Z=ca.y,$=ca.width,_=ca.height,i.wordWrap)if(b.rect(Y,Z,$,_),b.clip(),b.beginPath(),aa=e+J,P>1){for(a.Ufc(b,i,n,d+A,aa,U,N*P,ca),S=0;S<P;S++)b.fillText(O[S],d+A,aa),X&&(T=b.measureText(O[S]).width,a.ip(b,X,d+A,aa,T,w,V)),aa+=N;a.Ufc(b,i,n,d+A,aa,U,N*P,ca)}else a.Oja(b,k,m,d+A,e+J,x,$,s,X,V,w,n,i,G,ca);else ba=b.measureText(k).width,(ba>$||N>_)&&(b.rect(Y,Z,$,_),b.clip(),b.beginPath()),a.Oja(b,k,m,d+A,e+J,x,$,s,X,V,w,n,i,G,ca,void 0,void 0,i.showEllipsis)}function I(a,b,c,d,e,f,g,h,i){var j=!1;j=!!b.wordWrap||(b.isVerticalText?h+g>f||i>e:h+g>e||i>f),j&&(a.rect(c,d,e,f),a.clip(),a.beginPath())}function J(a){var b=0,c=a.textIndent;return c>0&&(b=8*c),b}w=function(a){z(b,a);function b(){var b=a.call(this)||this;return b.typeName="2",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h,i){D(this,a,b,c,d,e,f,g,h,"columnHeader",1,i)},b.prototype.paintContent=function(a,b,c,d,e,f,g,h,j){var k,l=i.Context.bDc(a,q(b),c,d,e,f,h);l||(k=A(h.visualState,"columnHeader"),F(this,a,b,c,d,e,f,g,h,1,k,j))},b}(i.Base),b.ColumnHeader=w,h._o[2]=w,x=function(a){z(b,a);function b(){var b=a.call(this)||this;return b.typeName="3",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h){D(this,a,b,c,d,e,f,g,h,"rowHeader",2)},b.prototype.paintContent=function(a,b,c,d,e,f,g,h){var j,k=i.Context.bDc(a,q(b),c,d,e,f,h);k||(j=A(h.visualState,"rowHeader"),F(this,a,b,c,d,e,f,g,h,2,j))},b}(i.Base),b.RowHeader=x,h._o[3]=x,y=function(a){z(b,a);function b(){var b=a.call(this)||this;return b.typeName="4",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h){var i,j,l,n,o,p,q,r,t,u,v,w,x,y,z,A,C;if(a){a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),i=this,j=h.visualState||0;try{l=i.getThemeStyle(h.visualState,"gc-corner-"+k.Jm(j)),n=l&&l.backgroundColor,o=l&&l.backgroundImage,n?(a.fillStyle=n,a.fillRect(c,d,e,f)):o&&o!==s&&B(a,c,d,e,f,o)}catch(a){}if(p=i.getThemeStyle(4,"gc-corner-triangle-"+k.Jm(j)),q=p&&p.backgroundImage,r=p&&p.backgroundColor,t=a.createLinearGradient(c+e/2,d,c+e/2,d+f),q&&q.indexOf("linear-gradient")!==-1){for(u=m(q),v=0,w=u.length;v<w;v++)x=u[v],t.addColorStop(x.point,x.color);a.fillStyle=t}else r&&(t.addColorStop(.125,"#f6fafb"),t.addColorStop(1,r),a.fillStyle=t);y=a.createLinearGradient(c+e,d+1,c+e,d+f-2),y.addColorStop(0,p.borderLeftColor),y.addColorStop(1,p.borderRightColor),a.beginPath(),a.strokeStyle=y,a.moveTo(c+e-.5,d),a.lineTo(c+e-.5,d+f),a.stroke(),h.needLeftGridline&&(a.beginPath(),a.strokeStyle=p.borderLeftColor,a.moveTo(c+.5,d),a.lineTo(c+.5,d+f),a.stroke()),z=a.createLinearGradient(c,d,c+e-2,d),z.addColorStop(0,p.borderTopColor),z.addColorStop(1,p.borderBottomColor),a.beginPath(),a.strokeStyle=z,a.moveTo(c,d+f-.5),a.lineTo(c+e,d+f-.5),a.stroke(),h.needTopGridline&&(a.beginPath(),a.strokeStyle=p.borderTopColor,a.moveTo(c,d+.5),a.lineTo(c+e,d+.5),a.stroke()),a.beginPath(),A=3,C=f,e<f&&(C=e),a.moveTo(c+e-C+A,d+f-A),a.lineTo(c+e-A,d+f-A),a.lineTo(c+e-A,d+f-C+A),a.fill(),a.restore()}},b}(i.Base),b.Corner=y,h._o[4]=y},"./dist/core/celltype/textcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/celltype/basecelltype.js"),j=c("./dist/core/core.enum.js"),k=c("./dist/core/util/common.js"),l=d.Common.j.Fa,m=g.Vn,n=g.Events.EditChange,o=g.Vl,p=g.Ul,q=g.uHb,r=p.lHb,s=p.Nl,t=p.Ml,u=t.msie,v=t.edge,w=t.chrome,x=p.nl,y=p.ol,z=p.Il,A=p.vl,B=p.rl(),C=p.fp,D=p.Voa,E=p.pL,F=p.Ika,G=p.hZa,H=p.K_a,I=p.Fxb,J="left",K="right",L="center",M="top",N="gcUIElement",O="none",P=".gcEditingInput",Q="gcEditingInput",R="width",S="height",T="text-align",U="hidden",V="word-wrap",W="overflow",X="vertical-align",Y="normal",Z="break-word",$="overflow-y",_="scroll",aa="word-break",ba="float",ca=window,da=document,ea=.337,fa=B.ipad,ga=B.iphone||fa||B.android,ha=null,ia=void 0,ja=Math.ceil,ka=Math.min,la=Math.sin,ma=Math.cos,na=Math.abs,oa=Math.max,pa=parseInt,qa="\xa0",ra="\u200b",sa="string",ta="number";function xa(a){return ga||0===a}function ya(a){return xa(a)?f.GC$(s("textarea")):f.GC$(s("div"))}function za(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable}function Aa(a){return za(a)?u&&parseFloat(t.version)<10?p.Woa(a):a.innerText:a.value}function Ba(a,b){za(a)?a.innerText=l(b)?"":b:a.value=b}function Ca(a){if(za(a)){var b=ca.getSelection();b.selectAllChildren(a),b.rangeCount>0&&b.collapseToEnd()}else a.selectionStart=a.selectionEnd=a.value.length}function Da(a){var b,c;return za(a)?(b=ca.getSelection(),b.rangeCount>0?(c=b.getRangeAt(0),c.startOffset):0):a.selectionStart}function Ea(a){var b,c;return za(a)?(b=ca.getSelection(),b.rangeCount>0?(c=b.getRangeAt(0),c.endOffset):0):a.selectionEnd}function Fa(a){var b=a.keyCode,c=a.shiftKey,d={106:42,107:43,109:45,110:46,111:47,173:45},e={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},f={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},g=b;return b>=96&&b<=105?g=b-48:d[b]?g=d[b]:c&&f[b]?g=f[b]:!c&&e[b]?g=e[b]:!c&&b>=65&&b<=90&&(g=b+32),g}function Ga(a){return a&&"BR"===a.tagName}function Ha(a){return a&&"SPAN"===a.tagName}function Ia(a){return a&&"DIV"===a.tagName}function Ja(a){return a instanceof Text}function Ka(a){return a===ra}function La(a,b,c,d){var e=a.substr(0,b),f=a.substr(c,a.length-c);return e+d+f}function Ma(a,b,c,d,e,f){var g,h,i,j,k,l="",m=a.childNodes,n=m.length;for(g=0;g<n;g++)h=m[g],Ha(h)?l+=Ma(h,b,c,d,e,f):Ja(h)?(i=b&&b.startContainer,j=b&&b.endContainer,k=h.textContent,h===i||h===j?i!==j?h===i?(l+=La(k,c,k.length,e),f=!0):(l+=La(k,0,d,""),f=!1):l+=La(k,c,d,e):f||(l+=k)):Ga(h)&&!f&&(l+="\n");return l}function Na(a,b,c,d,e){var f,g,h=String.fromCharCode(Fa(e));return za(a)?(f=ca.getSelection(),f.rangeCount>0&&(g=f.getRangeAt(0),Ja(g.startContainer))?Ma(a,g,c,d,h):g&&g.startOffset===g.endOffset?b+h:h):La(b,c,d,h)}function Oa(a){var b=Sa(a);return b&&b.indexOf(" ")>=0&&(b=F(b," ",qa)),b}function Pa(a,b,c,d,f,g){var h,i,j,k,l,m,n,p,q,r,s,t=a.srcElement||a.target;t&&t.getAttribute(N)===Q&&13===a.keyCode&&(a.ctrlKey||a.altKey)&&(h=o.Xl(),h instanceof e.Worksheet&&(i=h.getCellType(h.Jl,h.Kl),i&&(za(t)?(c&&(t.blur(),t.focus()),j=ca.getSelection(),j.rangeCount>0&&(k=j.getRangeAt(0),l=da.createElement("br"),m=da.createTextNode(ra),k.insertNode(m),k.insertNode(l),Qa(k),n=da.createRange(),n.setStartAfter(m),n.setEndAfter(m),n.collapse(!1),j.removeAllRanges(),j.addRange(n))):(p=t.selectionStart,q=t.value,r=q.substr(0,p),s=q.substr(p,q.length-p),t.value=r+"\n"+s,t.selectionStart=p+1,t.selectionEnd=p+1),i.$fc(h.BF,ha,ha,a,b,!0))),x(a))}function Qa(a){var b,c=a.endContainer,d=c.lastChild;Ja(d)&&0===d.textContent.length&&c.removeChild(d),d=c.lastChild,b=d.previousSibling,Ka(d.textContent)&&!Ga(b)&&0===b.textContent.length&&c.removeChild(b)}function Ra(a){var b,c=a;return c?c.indexOf(ra)<0&&c.indexOf("\n")<0?c:(b=a.split("\n"),b.forEach(function(a,b,c){Ka(a[0])&&(c[b]=a.substr(1))}),b.join("\n")):c}function Sa(a){var b,c=a;return c?(b=c.length,b>0&&(c=c.replace(/\n/g,"\n"+ra)),c):c}function Ta(a){var b,c,d,e,f,g,h,i,j,k,l=ca.getSelection(),m=!1,n=0,o=0,p="";if(l.rangeCount>0){if(b=l.getRangeAt(0),c=Da(a),d=Ea(a),e=b.startContainer,f=b.endContainer,Ia(e))m=!0,n=c;else if(g=e.childNodes,h=g.length,i=void 0,h>0)for(i=0;i<h;i++){if(j=g[i],!j.tagName||"br"!==j.tagName.toLocaleLowerCase()){e=j;break}p+="\n"}return Ia(f)&&(o=d),k=Ua(a,c,d,e,f,m,n,o),p+k.content}}function Ua(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;if(d===e&&!f)return{content:Ra(d.textContent.slice(b,c))};for(i="",j=g,m=a.childNodes,n=h||m.length,j;j<n;j++)if(o=m[j],Ha(o)){if(k=Ua(o,b,c,d,e,f,0,0),i+=k.content,k.startFlag&&(f=!0),k.endFlag){l=!0;break}}else if(Ja(o)&&o===d)i+=o.textContent.slice(b,o.textContent.length),f=!0;else{if(Ja(o)&&o===e){i+=o.textContent.slice(0,c),l=!0;break}f&&(i+=Ga(o)?"\n":o.innerText||o.textContent)}return{content:Ra(i),startFlag:f,endFlag:l}}function Va(a,b){var c,d=a.length,e=[];for(c=0;c<d;c++)e.push(D(a[c],b));return e}function Wa(a){var b,c=a.length,d=0;for(b=0;b<c;b++)d+=a[b];return d}function Xa(a,b,c,d){var e,f,g=0,h=c;for(e=0;e<a.length;e++)w&&(h=d[e]),a[e]>b?(f=ja(a[e]/b),g+=h*f):g+=h;return g}function Ya(a,b,c){var d=Aa(a);return d&&"="===d[0]||""===d&&"="===b[0]||0===c&&"="===b[0]}!function(a){a[a.textarea=0]="textarea",a[a.editableDiv=1]="editableDiv"}(ua=b.EditorType||(b.EditorType={})),va=function(a){wa(b,a);function b(b){var c=a.call(this)||this;return c.allowOverflow=!0,c.typeName="1",c.editorType=l(b)?1:b,c}return b.prototype.getText=function(a,b){return a},b.prototype.paintValue=function(a,b,c,d,e,f,g,h){var l,m,n,o,p,q,s,t,u,v,x,z,A,B,C,D,E,F,G,J,K,L,M=this,N=h.sheet,O=N.zoom?N.zoom():1;if(b=M.getText(b,h),l={},h.quotePrefix=g.quotePrefix,n=g.formatter,o=n&&"General"!==n,p=r(n),"string"==typeof n&&(o=o&&!p),q=g.textOrientation,s=g.textIndent&&0!==g.textIndent,t=g.isVerticalText,u=e,q&&-90<=q&&q<=90&&!s&&!t&&(v=na(q*Math.PI/180),u=(f-h.lineHeight*ma(v))/la(v)),z=M.Pfc(a,m,g,h,c,d,e,f),x=z.externals,A=M.Qfc(x.left),B=M.Qfc(x.right),C=g.hAlign,3===C&&(C=y(C,b,g.formatter)),2===C?u-=B:0===C&&(u-=A),D=g._autoFormatter&&g._autoFormatter.formatCached&&"General"!==g._autoFormatter.formatCached,o?E=g.formatter:D?E=g._autoFormatter:N.parent&&N.parent.options.numbersFitMode===j.NumbersFitMode.mask?E=i.Context.Ixb(a,b,u,g,O):N.parent&&N.parent.options.numbersFitMode===j.NumbersFitMode.overflow&&(E=g._autoFormatter),m=p&&(b instanceof Date||"boolean"==typeof b||b instanceof Boolean||"number"==typeof b)?M.format(b,n,{}):M.format(H(b),E,l,h),F=new k.Rect(c,d,e,f),this.adjustRectForIconSet(g.hAlign,h.sheet,h.row,h.col,h.sheetArea,F,l.content&&this.hasInfilling(l.content)),c=F.x,e=F.width,g.shrinkToFit!==!0&&!t)if(I(b)){if(N.parent){switch(G=m,N.parent.options.numbersFitMode){case j.NumbersFitMode.mask:G=this.Yfc(a,m,u,g,O,h,l,N);break;case j.NumbersFitMode.overflow:G=this.Klb(a,h,b,g,N,m,l)}m=G}}else void 0===N.ITa.uIb(h.row,h.col,h.sheetArea)||g.showEllipsis||N.ITa.qHb(h.row,h.col,void 0,h.sheetArea);return J=g.labelOptions,K=g.watermark,L=!J||0!==J.visibility,K&&!m&&L?void M.paintText(a,K,c,d,e,f,g,h,K,l,ea):void((m||l.content&&l.content.length)&&(1===g.vAlign&&w&&d--,M.paintText(a,b,c,d,e,f,g,h,m,l,ia,x)))},b.prototype.Yfc=function(a,b,c,d,e,f,g,h){var j=f.cellOverflowLayout&&f.cellOverflowLayout.expandedWidth,k=i.Context.Lxb(a,b,l(j)?c:j,d,e),m=f.row,n=f.col;return b!==k?(delete g.content,d.textIndent=0,h.ITa.qHb(m,n,h.getText(m,n,f.sheetArea),f.sheetArea)):h.ITa.qHb(m,n,void 0,f.sheetArea),k},b.prototype.Klb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m=b.row,n=b.col;if(d.wordWrap&&(d.wordWrap=!1),h=E(a,d.font,f),i=e.ss._m(n),j=b.cellOverflowLayout,k=void 0,!j&&i<h)k=e.getText(m,n,b.sheetArea);else if(j&&i<h&&this.lDc(j.backgroundWidth)&&this.lDc(j.valueWidth)){if(!this.lDc(d.hAlign))return;l=void 0,l=1!==d.hAlign?j.valueWidth>j.backgroundWidth:j.valueWidth/2>j.backgroundLeftWidth||j.valueWidth/2>j.backgroundRightWidth,k=l?e.getText(m,n,b.sheetArea):void 0}return e.ITa.qHb(m,n,k,b.sheetArea),f},b.prototype.lDc=function(a){return null!==a&&void 0!==a},b.prototype.createEditorElement=function(a,b){var c,d,e=a&&a.sheet&&a.sheet.parent&&a.sheet.parent.qo,g=A(e)+1e3;return f.GC$(b).css("z-index",g),c=ya(this.editorType),f.GC$(c).css({font:"normal 11pt calibri",outline:O,resize:O,border:O,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(V,Y).attr({tabindex:-1,
autocomplete:"off",contenteditable:!0}).css(W,U).attr(N,Q),t.safari&&f.GC$(c).css("-webkit-user-select","auto"),d=za(f.GC$(c)[0]),d&&(f.GC$(c).css("display","table-cell"),f.GC$(c).css(aa,Y)),f.GC$(c)[0]},b.prototype.getEditorValue=function(a,b){var c,d;return a&&(c=Aa(a),!l(c)&&c.length>0)?(d=Ra(c),d=d.replace(/\r\n?/g,"\n"),d.indexOf(qa)<0?d:F(d,qa," ")):ha},b.prototype.setEditorValue=function(a,b,c,d){var e,f;a&&(e=c&&c.sheet&&c.sheet.HF,f=Oa(b),u?e&&c.isImeInput||Ba(a,l(f)?d?"%":"":f):Ba(a,e?d?"%":"":f))},b.prototype.selectAll=function(a,b){if(a&&a.select)a.select();else{var c=ca.getSelection();c.selectAllChildren(a)}},b.prototype.focus=function(a,b){this.isImeAware()&&a?(a.focus(),Ca(a)):a.parentNode.parentNode.focus()},b.prototype.kp=function(a,b,c,d){var e=a&&d&&d.sheet,f={},g=z(b,c,e,f);return a.oja=f.formatter||ia,g},b.prototype.activateEditor=function(a,b,c,d,e,g,h){var i,j,k,m,o=d&&d.sheet;o&&(i=this,j=a,j&&(k=f.GC$(j),m=za(j),i._editingElement=j,k.attr(N)||k.attr(N,Q),B.android&&k.bind("input"+P,function(a){try{i.$fc(j,b,c,a,d,!1,e,g,h)}catch(a){}}),k.bind("keydown"+P,function(a){var f,k;try{f=a.keyCode,m&&(8===f?q.processBackspaceAndLeftArrowKeyEvent(a,!0):46===f?q.processDeleteAndRightArrowKeyEvent(a,!0):37===f?q.processBackspaceAndLeftArrowKeyEvent(a,!1):39===f&&q.processDeleteAndRightArrowKeyEvent(a,!1)),k=229===f||0===f,k||i.kK||i.$fc(j,b,c,a,d,!0,e,g,h),Pa(a,d,i.kK,e,g,h)}catch(a){}}),k.bind("keyup"+P,function(a){var k=a.keyCode,l=a.ctrlKey,p=a.altKey,q=229===k||0===k;q||i.kK||(46!==k&&8!==k&&(90!==k&&89!==k||!l||p)||(m&&"\n"===j.innerText&&f.GC$(j).empty(),i.$fc(j,b,c,a,d,!1,e,g,h)),(13!==k&&9!==k&&27!==k&&16!==k||l||p)&&o.Wq(n,{sheet:o,sheetName:o.name(),row:o.Jl,col:o.Kl,editingText:i.getEditorValue(j,d)}))}),k.bind("mousedown"+P,function(){1===o.Px&&(o.Px=2,o.Cu(1,2))}),k.bind("textInput"+P,function(a){if(a.data&&(i.probabilityAddPercentSpec||i.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(a.data)){var b=document.createElement("span");b.innerText="%",b.id="updateEditorImpAddPercent","#text"===j.firstChild.nodeName?j.appendChild(b):j.firstChild.appendChild(b),delete i.probabilityAddPercentSpec,delete i.probabilityAddPercent}}),k.bind("compositionstart"+P,function(){i.kK=!0,i.nK=Aa(j)}),k.bind("compositionupdate"+P,function(a){i.$fc(j,b,c,a?a:ha,d,!0,e,g,h)}),k.bind("compositionend"+P,function(a){var f,k,l,m;i.$fc(j,b,c,a?a:ha,d,!1,e,g,h),i.kK=!1,f=a.keyCode,k=a.ctrlKey,l=a.altKey,m=i.getEditorValue(j,d)||"",i.nK!==m&&(f===ia||13!==f&&9!==f||k||l)&&o.Wq(n,{sheet:o,sheetName:o.name(),row:o.Jl,col:o.Kl,editingText:m})}),m&&(k.bind("copy"+P,function(a){var b=ca.clipboardData,c=a.clipboardData,d=Ta(a.currentTarget);l(d)||(b&&b.setData?(b.setData("text",d),x(a)):c&&c.setData&&(c.setData("text/plain",d),x(a)))}),k.bind("paste"+P,function(a){var f,k,l,n,o,p,q,r,s=!1;if(m)try{f=void 0,u&&!v&&ca.clipboardData&&ca.clipboardData.getData?f=ca.clipboardData.getData("text"):a.clipboardData&&a.clipboardData.getData&&(f=a.clipboardData.getData("text/plain")),f=f.replace(/\r\n?/g,"\n"),f=Oa(f),k=ca.getSelection(),k.rangeCount>0&&(l=k.getRangeAt(0),n=l.startOffset,o=l.endOffset,n!==o&&l.deleteContents(),Ya(j,f,n)||(p=da.createElement("span"),f=f.replace(/\u200B/g,""),q=f.length,"\n"===f[q-1]&&(f="\r"===f[q-2]?f.substr(0,q-2):f.substr(0,q-1)),p.innerText=f,l.insertNode(p),r=document.createRange(),r.setStartAfter(p),r.setEndAfter(p),r.collapse(!1),k.removeAllRanges(),k.addRange(r),s=!0))}catch(a){}if(i.mK=ca.setTimeout(function(){i.$fc(j,b,c,a,d,!1,e,g,h),i.mK&&(clearTimeout(i.mK),delete i.mK)},10),s)return!1}))))},b.prototype.deactivateEditor=function(a,b){var c,d,e,g,h,i,j,k,l,m=this;if(a&&b&&b.sheet){if(c=b.sheet,m.kK&&fa&&c.CH)try{f.GC$(a).trigger("compositionend"+P)}catch(a){}if(d=c.getActualStyle(b.row,b.col,b.sheetArea).cellPadding)for(e=[J,M],g=[3,0],h=0;h<e.length;h++)i=parseInt(Za(d)[g[h]],10),i=typeof i===ta&&i>0?i:0,m.shiftPadding(a,e[h],i);f.GC$(a).unbind(P),j=c.getActiveRowIndex(),k=c.getActiveColumnIndex(),l=c.getActualStyle(j,k),c.KF(m,a,j,k,l)}m._editingElement=ha},b.prototype.shiftPadding=function(a,b,c){var d=f.GC$(a).parent();d&&(b===J?d.css({left:(+f.GC$(d).css(J).replace("px","")||0)-c}):b===M&&d.css({top:(+f.GC$(d).css(M).replace("px","")||0)-c}))},b.prototype.getEditingElement=function(){return this._editingElement},b.prototype.lK=function(a,b,c,d,e,g,h,j,n){var o,p,q,r,s,t,v,x,z,A,B,D,E,F,H,I,M,N,P,Q,ca,da,ea,fa,ga,ha,ia,la,ma,na,qa,ra,sa,ta,ua,va,wa,xa,ya,Ba=e&&e.sheet,Ca=this,Fa=Ba.options.sheetAreaOffset,Ga=a;if(Ga&&Ba&&(o=f.GC$(Ga),p=Ba.yl,q=e.preventOverflow,r=Aa(Ga),Ba.isEditing())){if(s=za(Ga),t=void 0,v=J,x=void 0,z=i.Context.u5,A=0,B=0,D=0,E=0,b&&(F=Ba.zoom(),A=z(b,0,!1,F),B=z(b,1,!1,F),D=z(b,2,!1,F),E=z(b,3,!1,F),t=y(b.hAlign,a.LF),1===t?v=L:2===t&&(v=K),o.css(T,v),b.foreColor&&o.css("color",b.foreColor),x=b.font||p.Bl(),x&&(Ba.zoom()>1&&(x=p.Cl(x)),o.css("font",G(x))),b.textDecoration&&Ca.lp(o,b.textDecoration)),H=pa(o.css("padding-left"),10)||0+pa(o.css("padding-right"),10)||0,I=pa(o.css("padding-top"),10)||0+pa(o.css("padding-bottom"),10)||0,c||(H+=2*+o.parent().css("left").replace("px",""),I+=2*+o.parent().css("top").replace("px","")),l(h)&&(h=c),h&&(M=Ba.am(),N=c.width,h.x+h.width-Fa.left>M.width&&(c.width=M.width-c.x,h.width=M.width-h.x),o.css(R,N-H).css(S,c.height-I),Ga.maxWidth=Fa.left+M.width-c.x-H-B,o.css("max-width",Ga.maxWidth+"px"),Ga.maxHeight=Fa.top+M.height-c.y-I-D,Ga.minWidth=pa(Ga.style.width,10),Ga.minHeight=pa(Ga.style.height,10)),P=Da(Ga),Q=Ea(Ga),g=g&&d&&d.keyCode&&Ba.mm.LH(d)&&0===P&&Q===r.length,g=g||Ba.HF,ca=g?"":r,x=Ga.style.font,x||(x=p.Cl(p.Bl())),da=C(x),d&&Ca.probabilityAddPercent&&(ea=d.key,ea&&k.NUMBER_ARRAY.indexOf(ea)!==-1&&(Ba.parent.options.enableFormulaTextbox?(ga=Ga.innerText,/[a-z]/i.test(ga)?Ca.probabilityAddPercent=!1:(fa=document.createElement("span"),fa.innerText="%",fa.id="updateEditorImpAddPercent",Ga.appendChild(fa),delete Ca.probabilityAddPercent)):(fa=document.createElement("span"),fa.innerText="%",fa.id="updateEditorImpAddPercent",Ga.firstChild.appendChild(fa),delete Ca.probabilityAddPercent))),!g&&d&&(Ba.mm.LH(d)&&8!==d.keyCode&&(ca=Na(Ga,ca,P,Q,d)),Ca.kK&&(ca=u?r:Ca.nK+d.data)),ha=[],ha=b&&b.wordWrap?m.Wn(ca,pa(Ga.style.width)-H,x):ca.split(/\r\n|\r|\n/),ia=void 0,la=void 0,ma=ha.length,Ga.minWidth=ka(Ga.minWidth,Ga.maxWidth),Ga.minHeight=ka(Ga.minHeight,Ga.maxHeight),b&&b.wordWrap||ma>0){if(na=void 0,qa=void 0,w?(qa=Va(ha,x),na=Wa(qa)):na=ma*da,b&&b.wordWrap)o.css(V,Z).css(W,U).css("max-width",Ga.style.width);else{for(ra=0,sa=[],ia=0;ia<ma;ia++)la=ja(Ba.rt(ha[ia],x)),sa.push(la),ra=oa(ra,la);ta=o.css(V),ua=pa(Ga.style.width),b||ta!==Z?ra<=Ga.minWidth?(o.css(R,Ga.minWidth).css(V,Y).css(W,U),s&&o.css(aa,Y)):ra>Ga.minWidth&&ra<=Ga.maxWidth&&!q?(o.css(R,ra).css(V,Y).css(W,U),s&&o.css(aa,Y)):ra>Ga.maxWidth&&!q&&(o.css(R,Ga.maxWidth-2).css(V,Z).css(W,U),na=Xa(sa,Ga.maxWidth,da,qa)):ra>ua&&!q&&(na=Xa(sa,ua,da,qa))}na<=Ga.minHeight?o.css(S,Ga.minHeight).css(ba,O):na>Ga.minHeight&&na<=Ga.maxHeight?o.css(S,na).css(ba,O):na>Ga.maxHeight&&o.css(S,Ga.maxHeight-1).css($,_).css(ba,J)}return t=o.css(T),va=o.width()-Ga.minWidth,l(t)||t===J||(t===L?o.css(J,Ga.originalLeft-va/2):t===K&&o.css(J,Ga.originalLeft-va)),b&&s&&(wa=b.vAlign,1===wa?o.css(X,"middle"):2===wa&&o.css(X,"bottom")),xa=pa(Ga.style.height)+I+A+D,ya=H+E+B,o.css($)===_?{width:Ga.offsetWidth+ya,height:g?0:xa}:{width:pa(Ga.style.width)+ya,height:xa}}},b.prototype.updateEditor=function(a,b,c,d,e,g,h){var i,j,m;return c=this.lK(a,b,c,ha,d,!1,e,g,h),u&&a&&(i=f.GC$(a),j=i[0].style.width,i.width(j+1).width(j)),!l(c)&&a&&(m=new k.Rect(a.style.left?parseFloat(a.style.left):0,a.style.top?parseFloat(a.style.top):0,c.width,c.height)),m},b.prototype.$fc=function(a,b,c,d,e,g,h,i,j){if(c=this.lK(a,b,c,d,e,g,h,i,j),u&&a){var k=f.GC$(a),m=k[0].style.width;k.width(m+1).width(m)}!l(c)&&a&&(l(h)?h=c:(h.x=ia,h.y=ia),this.updateEditorContainer(a,c,b,e,h,i,j))},b.prototype.updateEditorContainer=function(b,c,d,e,g,h,i){var j,k,l;e&&e.preventOverflow?(a.prototype.updateEditorContainer.call(this,b,c,d,e,g,h,i),j=b.parentNode,j&&c&&(k=f.GC$(j),l=c.width,l>0&&k.width(l))):(c&&c.width&&g&&g.width&&(g.width=c.width),c&&c.height&&g&&g.height&&(g.height=c.height),a.prototype.updateEditorContainer.call(this,b,c,d,e,g,h,i))},b.prototype.updateImeMode=function(a,b,c){this.isImeAware()&&a&&i.Context.hp(a,b)},b.prototype.isReservedKey=function(a,b){var c=a.srcElement||a.target,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey;return!!(c&&b&&b.isEditing&&c.getAttribute(N)===Q)&&(13===d&&(e&&!a.shiftKey||f)||90===d&&e&&!f||89===d&&e&&!f||67===d&&(e||g)&&!f||88===d&&(e||g)&&!f)},b.prototype.isImeAware=function(a){return!0},b.prototype.toJSON=function(){var a,b={},c=this;for(a in c)c.hasOwnProperty(a)&&"_editingElement"!==a&&(b[a]=c[a]);return b},b}(i.Base),b.Text=va;function Za(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===sa&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}h._o[1]=va},"./dist/core/core.definition.js":function(a,b){},"./dist/core/core.entry.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;function k(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/core/core.res.en.js"),k(c("./dist/core/core.ns.js")),k(c("./dist/core/core.enum.js")),k(c("./dist/core/util/common.js")),k(c("./dist/core/util/domUtil.js")),c("./dist/core/core.definition.js"),d=c("./dist/core/util/common.js"),Object.defineProperty(b,"getTypeFromString",{set:function(a){d.getTypeFromString=a},get:function(){return d.getTypeFromString}}),e=c("./dist/core/lc/debugLc.js"),f=e.Soa,g=-1,1===f&&(g=Math.floor(5*Math.random()),b["G".concat("C","$")]["s".concat("d")]=g),k(c("./dist/core/util/theme.js")),k(c("./dist/core/util/basedialog.js")),k(c("./dist/core/util/imageLoader.js")),k(c("./dist/core/util/tasks.js")),0===g&&c("./dist/core/lc/debugLc.js"),k(c("./dist/core/worksheet/stylehelper.js")),1===g&&c("./dist/core/lc/debugLc.js"),k(c("./dist/core/worksheet/style.js")),2===g&&c("./dist/core/lc/debugLc.js"),k(c("./dist/core/worksheet/clipboardhelper.js")),3===g&&c("./dist/core/lc/debugLc.js"),k(c("./dist/core/worksheet/worksheet-model.js")),4===g&&c("./dist/core/lc/debugLc.js"),k(c("./dist/core/worksheet/worksheet.js")),c("./dist/core/worksheet/worksheet-formatter.js"),k(c("./dist/core/worksheet/worksheet-actions.js")),k(c("./dist/core/worksheet/worksheet-border.js")),c("./dist/core/worksheet/worksheet-edit.js"),k(c("./dist/core/worksheet/worksheet-event.js")),c("./dist/core/worksheet/worksheet-json.js"),k(c("./dist/core/worksheet/worksheet-render.js")),c("./dist/core/worksheet/worksheet-selection.js"),c("./dist/core/worksheet/worksheet-sort.js"),k(c("./dist/core/worksheet/worksheet-ui.js")),k(c("./dist/core/worksheet/worksheet-static.js")),k(c("./dist/core/workbook/workbook.js")),c("./dist/core/workbook/workbook-json.js"),k(c("./dist/core/workbook/sheettabbase.js")),k(c("./dist/core/workbook/sheettab.js")),k(c("./dist/core/workbook/sheettab2007.js")),k(c("./dist/core/workbook/workbookpanelex.js")),h=c("./dist/core/celltype/cellType.entry.js"),b.CellTypes=h,i=c("./dist/core/celltype/headercelltype.js"),Object.defineProperty(h,"Corner",{set:function(a){a!==i.Corner&&(i.Corner=a)},get:function(){return i.Corner}}),Object.defineProperty(h,"ColumnHeader",{set:function(a){a!==i.ColumnHeader&&(i.ColumnHeader=a)},get:function(){return i.ColumnHeader}}),Object.defineProperty(h,"RowHeader",{set:function(a){a!==i.RowHeader&&(i.RowHeader=a)},get:function(){return i.RowHeader}}),j=c("./dist/core/celltype/textcelltype.js"),Object.defineProperty(h,"Text",{set:function(a){a!==j.Text&&(j.Text=a)},get:function(){return j.Text}}),h.vHb=i,h.wHb=j,1!==f&&2!==f||e.Gb(b)},"./dist/core/core.enum.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.pixels=0]="pixels",a[a.continuous=1]="continuous"}(d=b.ScrollType||(b.ScrollType={})),function(a){a[a.setRowCount=0]="setRowCount",a[a.setColumnCount=1]="setColumnCount",a[a.addRows=2]="addRows",a[a.deleteRows=3]="deleteRows",a[a.addColumns=4]="addColumns",a[a.deleteColumns=5]="deleteColumns",a[a.setRowHeight=6]="setRowHeight",a[a.setColumnWidth=7]="setColumnWidth",a[a.setRowVisible=8]="setRowVisible",a[a.setColumnVisible=9]="setColumnVisible",a[a.filterRows=10]="filterRows",a[a.outlineExpandRows=11]="outlineExpandRows",a[a.outlineExpandColumns=12]="outlineExpandColumns"}(e=b.AxisInfoChangeType||(b.AxisInfoChangeType={})),function(a){a[a.hide=0]="hide",a[a.show=1]="show",a[a.active=2]="active",a[a.inactive=3]="inactive"}(f=b.ScrollbarState||(b.ScrollbarState={})),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.both=3]="both"}(g=b.ShowResizeTip||(b.ShowResizeTip={})),function(a){a[a.skin=0]="skin",a[a.mobile=1]="mobile"}(h=b.ScrollbarAppearance||(b.ScrollbarAppearance={})),function(a){a[a.none=0]="none",a[a.horizontal=1]="horizontal",a[a.vertical=2]="vertical",a[a.both=3]="both"}(i=b.ShowScrollTip||(b.ShowScrollTip={})),function(a){a[a.right=0]="right",a[a.down=1]="down"}(j=b.InsertShiftCell||(b.InsertShiftCell={})),function(a){a[a.normal=0]="normal",a[a.split=1]="split"}(k=b.ResizeMode||(b.ResizeMode={})),function(a){a[a.noHeaders=0]="noHeaders",a[a.rowHeaders=1]="rowHeaders",a[a.columnHeaders=2]="columnHeaders",a[a.allHeaders=3]="allHeaders"}(l=b.CopyPasteHeaderOptions||(b.CopyPasteHeaderOptions={})),function(a){a[a.noHeaders=0]="noHeaders",a[a.rowHeaders=1]="rowHeaders",a[a.columnHeaders=2]="columnHeaders",a[a.allHeaders=3]="allHeaders"}(m=b.HeaderOptions||(b.HeaderOptions={})),function(a){a[a.default=0]="default",a[a.enhanced=1]="enhanced"}(n=b.ResizeZeroIndicator||(b.ResizeZeroIndicator={})),function(a){a[a.setFormula=0]="setFormula",a[a.copyPaste=1]="copyPaste",a[a.dragFill=2]="dragFill",a[a.dragDrop=3]="dragDrop",a[a.changePartOfArrayFormula=4]="changePartOfArrayFormula",a[a.changeSheetName=5]="changeSheetName",a[a.table=6]="table",a[a.filter=7]="filter",a[a.hideSheet=8]="hideSheet",a[a.sort=9]="sort",a[a.pivotTable=10]="pivotTable",a[a.ptOverlapValue=11]="ptOverlapValue",a[a.groupProtected=12]="groupProtected"}(o=b.InvalidOperationType||(b.InvalidOperationType={})),function(a){a[a.cell=0]="cell",a[a.cellWithHeader=1]="cellWithHeader"}(p=b.AutoFitType||(b.AutoFitType={})),function(a){a[a.all=0]="all",a[a.values=1]="values",a[a.formatting=2]="formatting",a[a.formulas=3]="formulas",a[a.valuesAndFormatting=4]="valuesAndFormatting",a[a.formulasAndFormatting=5]="formulasAndFormatting"}(q=b.ClipboardPasteOptions||(b.ClipboardPasteOptions={})),function(a){a[a.value=1]="value",a[a.formula=2]="formula",a[a.comment=4]="comment",a[a.outline=8]="outline",a[a.sparkline=16]="sparkline",a[a.span=32]="span",a[a.style=64]="style",a[a.tag=128]="tag",a[a.bindingPath=256]="bindingPath",a[a.conditionalFormat=512]="conditionalFormat",a[a.hyperlink=1024]="hyperlink",a[a.all=2047]="all"}(r=b.CopyToOptions||(b.CopyToOptions={})),function(a){a[a.topLeft=0]="topLeft",a[a.topCenter=1]="topCenter",a[a.topRight=2]="topRight",a[a.bottomLeft=3]="bottomLeft",a[a.bottomCenter=4]="bottomCenter",a[a.bottomRight=5]="bottomRight"}(s=b.LabelAlignment||(b.LabelAlignment={})),function(a){a[a.visible=0]="visible",a[a.hidden=1]="hidden",a[a.auto=2]="auto"}(t=b.LabelVisibility||(b.LabelVisibility={})),function(a){a[a.underline=1]="underline",a[a.lineThrough=2]="lineThrough",a[a.overline=4]="overline",a[a.doubleUnderline=8]="doubleUnderline",a[a.none=0]="none"}(u=b.TextDecorationType||(b.TextDecorationType={})),function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.general=3]="general",a[a.centerContinuous=4]="centerContinuous"}(v=b.HorizontalAlign||(b.HorizontalAlign={})),function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom"}(w=b.VerticalAlign||(b.VerticalAlign={})),function(a){a[a.normal=0]="normal",a[a.superscript=1]="superscript",a[a.subscript=2]="subscript"}(x=b.VertAlign||(b.VertAlign={})),function(a){a[a.smallDecrement=0]="smallDecrement",a[a.smallIncrement=1]="smallIncrement",a[a.largeDecrement=2]="largeDecrement",a[a.largeIncrement=3]="largeIncrement",a[a.thumbPosition=4]="thumbPosition",a[a.thumbTrack=5]="thumbTrack",a[a.endScroll=6]="endScroll"}(y=b.Nxb||(b.Nxb={})),function(a){a[a.normal=0]="normal",a[a.highlight=1]="highlight",a[a.selected=2]="selected",a[a.active=3]="active",a[a.hover=4]="hover",a[a.activeNotSelected=5]="activeNotSelected"}(z=b.VisualState||(b.VisualState={})),function(a){a[a.ready=0]="ready",a[a.enter=1]="enter",a[a.edit=2]="edit"}(A=b.EditorStatus||(b.EditorStatus={})),function(a){a[a.auto=1]="auto",a[a.active=2]="active",a[a.inactive=4]="inactive",a[a.disabled=0]="disabled"}(B=b.ImeMode||(b.ImeMode={})),function(a){a[a.single=0]="single",a[a.range=1]="range",a[a.multiRange=2]="multiRange"}(C=b.SelectionPolicy||(b.SelectionPolicy={})),function(a){a[a.cell=0]="cell",a[a.row=1]="row",a[a.column=2]="column"}(D=b.SelectionUnit||(b.SelectionUnit={})),function(a){a[a.data=1]="data",a[a.style=2]="style",a[a.comment=4]="comment",a[a.tag=8]="tag",a[a.sparkline=16]="sparkline",a[a.axis=32]="axis",a[a.bindingPath=64]="bindingPath",a[a.hyperlink=256]="hyperlink"}(E=b.StorageType||(b.StorageType={})),function(a){a[a.blank=0]="blank",a[a.numbers=1]="numbers",a[a.letters=2]="letters"}(F=b.HeaderAutoText||(b.HeaderAutoText={})),function(a){a[a.dragDrop=0]="dragDrop",a[a.dragFill=1]="dragFill",a[a.clear=2]="clear",a[a.paste=3]="paste",a[a.sort=4]="sort",a[a.setArrayFormula=5]="setArrayFormula",a[a.evaluateFormula=6]="evaluateFormula"}(G=b.RangeChangedAction||(b.RangeChangedAction={})),function(a){a[a.normal=0]="normal",a[a.richText=1]="richText"}(H=b.ValueType||(b.ValueType={})),function(a){a[a.stretch=0]="stretch",a[a.center=1]="center",a[a.zoom=2]="zoom",a[a.none=3]="none"}(I=b.ImageLayout||(b.ImageLayout={})),function(a){a.ThumbButton="thumbButton",a.TrackButton="trackButton",a.LeftButton="leftButton",a.RightButton="rightButton",a.UpButton="upButton",a.DownButton="downButton"}(J=b.Oxb||(b.Oxb={})),function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.nearest=3]="nearest"}(K=b.HorizontalPosition||(b.HorizontalPosition={})),function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom",a[a.nearest=3]="nearest"}(L=b.VerticalPosition||(b.VerticalPosition={})),function(a){a[a.corner=0]="corner",a[a.colHeader=1]="colHeader",a[a.rowHeader=2]="rowHeader",a[a.viewport=3]="viewport"}(M=b.SheetArea||(b.SheetArea={})),function(a){a[a.none=0]="none",a[a.ascending=1]="ascending",a[a.descending=2]="descending"}(N=b.SortState||(b.SortState={})),function(a){a[a.hover=1]="hover",a[a.invalid=2]="invalid",a[a.readonly=4]="readonly",a[a.edit=8]="edit",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty"}(O=b.CellStatesType||(b.CellStatesType={})),function(a){a[a.hover=1]="hover",a[a.invalid=2]="invalid",a[a.edit=8]="edit",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty",a[a.inserted=128]="inserted"}(P=b.RowColumnStates||(b.RowColumnStates={})),function(a){a[a.always=0]="always",a[a.onSelected=1]="onSelected",a[a.onEditing=2]="onEditing"}(Q=b.ButtonVisibility||(b.ButtonVisibility={})),function(a){a[a.none=0]="none",a[a.custom=1]="custom",a[a.clear=2]="clear",a[a.cancel=3]="cancel",a[a.ok=4]="ok",a[a.dropdown=5]="dropdown",a[a.ellipsis=6]="ellipsis",a[a.left=7]="left",a[a.right=8]="right",a[a.plus=9]="plus",a[a.minus=10]="minus",a[a.undo=11]="undo",a[a.redo=12]="redo",a[a.search=13]="search",a[a.separator=14]="separator",a[a.spinLeft=15]="spinLeft",a[a.spinRight=16]="spinRight",a[a.collapse=17]="collapse",a[a.expand=18]="expand"}(R=b.ButtonImageType||(b.ButtonImageType={})),R.calcel=R.cancel,function(a){a[a.colorPicker=0]="colorPicker",a[a.dateTimePicker=1]="dateTimePicker",a[a.timePicker=2]="timePicker",a[a.monthPicker=3]="monthPicker",a[a.list=4]="list",a[a.slider=5]="slider",a[a.calculator=6]="calculator",a[a.workflowList=7]="workflowList",a[a.multiColumn=8]="multiColumn"}(S=b.DropDownType||(b.DropDownType={})),function(a){a[a.left=0]="left",a[a.right=1]="right",a[a.leftOfText=2]="leftOfText",a[a.rightOfText=3]="rightOfText"}(T=b.ButtonPosition||(b.ButtonPosition={})),function(a){a[a.left=0]="left",a[a.right=1]="right"}(U=b.CaptionAlignment||(b.CaptionAlignment={})),function(a){a[a.horizontal=0]="horizontal",a[a.vertical=1]="vertical"}(V=b.LayoutDirection||(b.LayoutDirection={})),function(a){a[a.inline=0]="inline",a[a.popup=1]="popup",a[a.tree=2]="tree"}(W=b.LayoutDisplayAs||(b.LayoutDisplayAs={})),function(a){a[a.year=1]="year",a[a.month=2]="month",a[a.day=3]="day"}(X=b.CalendarPage||(b.CalendarPage={})),function(a){a[a.monday=1]="monday",a[a.tuesday=2]="tuesday",a[a.wednesday=3]="wednesday",a[a.thursday=4]="thursday",a[a.friday=5]="friday",a[a.saturday=6]="saturday",a[a.sunday=7]="sunday"}(Y=b.CalendarStartDay||(b.CalendarStartDay={})),function(a){a[a.none=0]="none",a[a.group=1]="group",a[a.child=2]="child",a[a.full=3]="full"}(Z=b.GroupSort||(b.GroupSort={})),function(a){a[a.string=0]="string",a[a.array=1]="array"}($=b.DropdownListValue||(b.DropdownListValue={})),function(a){a[a.solid=1]="solid",a[a.darkGray=2]="darkGray",a[a.mediumGray=3]="mediumGray",a[a.lightGray=4]="lightGray",a[a.gray125=5]="gray125",a[a.gray0625=6]="gray0625",a[a.darkHorizontal=7]="darkHorizontal",a[a.darkVertical=8]="darkVertical",a[a.darkDown=9]="darkDown",a[a.darkUp=10]="darkUp",a[a.darkGrid=11]="darkGrid",a[a.darkTrellis=12]="darkTrellis",a[a.lightHorizontal=13]="lightHorizontal",a[a.lightVertical=14]="lightVertical",a[a.lightDown=15]="lightDown",a[a.lightUp=16]="lightUp",a[a.lightGrid=17]="lightGrid",a[a.lightTrellis=18]="lightTrellis"}(_=b.PatternType||(b.PatternType={})),function(a){a[a.mask=0]="mask",a[a.overflow=1]="overflow"}(aa=b.NumbersFitMode||(b.NumbersFitMode={})),function(a){a[a.bottom=0]="bottom",a[a.top=1]="top",a[a.left=2]="left",a[a.right=3]="right"}(ba=b.TabStripPosition||(b.TabStripPosition={})),function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(ca=b.HyperlinkTargetType||(b.HyperlinkTargetType={})),function(a){a[a.tableSheet=0]="tableSheet",a[a.ganttSheet=1]="ganttSheet",a[a.customSheetTab=2]="customSheetTab"}(da=b.SheetType||(b.SheetType={})),function(a){a[a.normal=0]="normal",a[a.vertical=1]="vertical",a[a.stack=2]="stack"}(ea=b.ColumnHeaderFitMode||(b.ColumnHeaderFitMode={}))},"./dist/core/core.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/core/core.res.en.js");b.SR={en:d}},"./dist/core/core.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_NotSupported="NotSupportException",b.Exp_PasteExtentIsNull="pasteExtent is null",b.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",b.Exp_MultipleSelections="This action won't work on multiple selections.",b.Exp_ChangePartOfArray="Cannot change part of an array.",b.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",b.Exp_SrcIsNull="The argument 'src' is null",b.Exp_DestIsNull="The argument 'dest' is null",b.Exp_InvalidCustomFunction="invalid custom function",b.Exp_InvalidCustomName="invalid custom name",b.Exp_IndexOutOfRange="Index is out of range!",b.Exp_InvalidRange="Invalid range",b.Exp_NotAFunction="Not A Function",b.Exp_ArgumentOutOfRange="ArgumentOutOfRange",b.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",b.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",b.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",b.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",b.Tip_Row="Row: ",b.Tip_Column="Column: ",b.Tip_Height="Height: {0} pixels",b.Tip_Width="Width: {0} pixels",b.NewTab="New...",b.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",b.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",b.Exp_SheetNameConflict="That name is already taken. Try a different one.",b.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",b.Exp_DestSheetIsNull="destSheet is null",b.Exp_SheetIsNull="sheet is null.",b.Exp_OverlappingSpans="This operation will cause overlapping spans.",b.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",b.ARIA_Resize="resize",b.ARIA_First="first",b.ARIA_PreviousArrow="previous arrow",b.ARIA_NextArrow="next arrow",b.ARIA_Last="last",b.ARIA_PreviousButton="previous button",b.ARIA_NextButton="next button",b.ARIA_SheetTab="sheet tab",b.ARIA_NewSheet="new sheet",b.ARIA_Blank="blank",b.ARIA_Scrollbar_Left_Button="scrollbar left button",b.ARIA_Scrollbar_Top_Button="scrollbar top button",b.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",b.ARIA_Scrollbar_Right_Button="scrollbar right button",b.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",b.ARIA_Scrollbar_TRACK_Button="scrollbar track button",b.ARIA_Cell="cell",b.ARIA_HasValue="has value {0}",b.ARIA_HasFormula="has formula {0}",b.ARIA_HasComment="has comment {0}",b.ARIA_RowHeader="row header",b.ARIA_ColumnHeader="column header",b.SHEET_NAME="Sheet",b.lsru=["","6465706c6f796d656e74"],b.lsde=["","64657369676e6572"],b.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],b.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],b.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],b.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],b.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],b.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],b.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],b.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],b.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",b.Exp_InsertCopiedCutCellsOnSpanTable="This won\u2019t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",b.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",b.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",b.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",b.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist."},"./dist/core/lc/debugLc.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=d.GC$.sd,d.GC$[e]=function(a){};function f(){}b.n4=f,b.Soa=0},"./dist/core/util/basedialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("./dist/core/util/domUtil.js"),f=e.GC$,g=d.util.Nl,h=d.util.Ml,i=d.util.nl,j=document,k=window,l=k.Yl,m="touchstart",n="MSPointerDown",o="pointerdown",p=function(){function a(a,b,c){this.s7c="gc-popup",this.q7c="gc-overlay",this.AWa=null;var d=this;d.qo=a,d.zWa=c,b=b||0,d.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:b,backgroundColor:"rgba(0,0,0,0)"},d.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:b+1,outline:"none"},d.ad()}return a.prototype.ad=function(){var a=this;a.vo(a.Cj)?a.xo=f("#"+a.Cj):(a.Cj=a.wo(),a.so=a.q7c+"-"+a.Cj,a.c4=a.s7c+"-"+a.Cj,a.xo=f(g("div")).addClass(a.c4+" ui-widget").attr({id:a.Cj,tabIndex:-1}).css(a.uo))},a.prototype.wo=function(){for(var a=0,b="gc-dialog";this.vo(b+(""+a));)a++;return b+(""+a)},a.prototype.yo=function(){if(this.xo)return this.xo},a.prototype.zo=function(){return this.qo?this.qo:j.body},a.prototype.Ao=function(a){var b=this,c=b.xo;b.Bo()||b.Co(),l.Gm(),b.vo(b.Cj)||(f(b.zo()).append(c),b.Do(),c.css("display","none")),c.show(a)},a.prototype.cXa=function(){return"block"===this.xo.css("display")},a.prototype.close=function(){var a=this;a.o7c(),a.vo(a.Cj)&&a.xo.remove(),f("."+a.c4).isVisible()||a.Eo(),l.Hm()},a.prototype.Eo=function(){f("."+this.so).remove(),this.AWa=null},a.prototype.o7c=function(){var a=this.Cj;[m,n,o].forEach(function(b){f(j).unbind(b+"."+a)})},a.prototype.Do=function(){var a,b,c,d,e,g,h,i,k,l,m,n=this.xo,o=this.zo();0!==n.length&&(a=f(o).offset(),b=parseInt(n.css("left"),10)+a.left,c=parseInt(n.css("top"),10)+a.top,d=n.width(),e=n.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=j.documentElement,k=i.clientWidth,l=i.clientHeight,m=n[0].getBoundingClientRect(),m.left+d>k&&(h=m.left+d-k),m.top+e>l&&(g=m.top+e-l),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),n.css({left:b-a.left+"px",top:c-a.top+"px"}))))},a.prototype.vo=function(a){return f("#"+a).length>0},a.prototype.Co=function(){var a,b,c=this,d=c.Cj,e=f(g("div")).addClass(c.so),l=c.xo;c.AWa=e,e.css(c.to),f(c.zo()).append(e),a=h&&h.mozilla,a&&(b=(new Date).valueOf()),e.bind("mousedown",function(d){if(!c.zWa){if(a){var e=(new Date).valueOf();if(e-b<100)return}c.close(),a&&c.Fo&&clearTimeout(c.Fo)}i(d)}),e.bind("contextmenu",function(a){c.zWa&&i(a)}),l.bind("contextmenu",function(a){i(a)}),[m,n,o].forEach(function(b){f(j).bind(b+"."+d,function(b){var d=b.target;c.AWa&&!c.p7c(d)&&(c.zWa||(a?c.Fo=k.setTimeout(function(){c.close()},100):c.close()),i(b))})})},a.prototype.r7c=function(a,b){for(var c=a;b&&b!==document.body;){if(b===c)return!0;b=b.parentNode}return!1},a.prototype.p7c=function(a){return!!this.xo&&this.r7c(this.xo.get(0),a)},a.prototype.Bo=function(){return f("."+this.so).length>0},a}(),b.Go=p},"./dist/core/util/common.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/core.ns.js"),g=c("./dist/core/core.enum.js"),h=c("CalcEngine"),
i=e.GC$,j=i.extend,k=d.Common.o,l=d.Common.k.Uo,m=d.Formatter&&d.Formatter.GeneralFormatter,n=d.Formatter&&d.Formatter.lxb,o=d.Common.j.Fa,p=d.Common.u,q=new d.Common.ResourceManager(f.SR),r=q.getResource.bind(q),b.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',s=window,t=document,u="boolean",v="date",w="undefined",x="function",y=void 0,z=null,A=Math.floor,B=Math.ceil,C=Math.min,D=Math.max,E=Math.round,F=parseInt,G=parseFloat,H=isNaN,I=.7,J="px",K=" ",L=".",M="string",N="number",O="touch",P="MSPOINTER_TYPE_TOUCH",Q=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),R=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),S="\u200b";function ka(a){return typeof a!==w}function la(a){return t.createElement(a)}function ma(a){t.body&&t.body.insertBefore(a,z)}function na(a,b,c){Object.defineProperty(a,b,{get:function(){return this._ps[b]},set:function(a){var d=this._ps[b];d!==a&&(this._ps[b]=a,c&&c(b,a,d))},enumerable:!0})}b.productInfo={productVersion:"15.0.7"},b.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},b.getTypeFromString=function(a){var b,c,d,e=!1,f=s;if(typeof a===M){for(b=a.split(L),c=0,d=b.length;c<d&&f;c++)f=f[b[c]];f&&c===d&&d>0&&(e=!0)}return e?f:y},b.findControl=function(a){return typeof a===M&&(a=t.getElementById(a)),i(a).data("workbook")};function oa(a){return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1),!1}function pa(a){var b,c,d=!1;if(a)for(b=0;b<a.length;b++)if(c=a.charCodeAt(b),c>=11904&&c<12032||c>=12288&&c<40960||c>=43360&&c<43392||c>=63744&&c<64256){d=!0;break}return d}T=function(){function a(){}return a.xq=function(a){for(var b,c="";a>0;a=parseInt((a-1)/26+"",10))b=(a-1)%26,c=String.fromCharCode(65+b)+c;return c},a.ol=function(b,c,d,e){if(3===b){var f=i.getType(c);b=d&&"@"===d?0:f===u?1:f===N||f===v?2:f===M&&a.YGb(c)?2:0,e&&0!==e&&(e>0?b=0:e<0&&(b=2),e===-90?b=0:90===e&&(b=2))}return b},a.YGb=function(b){return a.ZGb.test(b)},a.bc=function(b){var c,e=i.getType(b);return b===z||b===y?b="":e===u?b=(""+b).toUpperCase():e===v?(c=0===b.getHours()&&0===b.getMinutes()&&0===b.getSeconds()&&0===b.getMilliseconds(),b=d.Common.l.Vb(b,c?"M/d/yyyy":"M/d/yyyy h:mm:ss")):b=b.richText?a.K_a(b):""+b,b},a.ql=function(a,b,c,d,e,f,g){var h,j,k,l,m,n,o=i(a),p=b,q=c,r="background-position",s="background-size",t="auto",u="0%",v="50%",w="100%";switch(f){case 0:g?o.css(r,g.position).css(s,g.size):o.css(r,u+K+u).css(s,w+K+w);break;case 1:h=v,j=v,d>p&&(h=u),e>q&&(j=u),o.css(r,h+K+j).css(s,t+K+t);break;case 2:k=0,l=0,m=p,n=q,q>0&&e>0&&p/q>d/e?(m=d/e*q,k=k+p/2-m/2):p>0&&d>0&&q/p>e/d&&(n=e/d*p,l=l+q/2-n/2),o.css(r,k+J+K+l+J).css(s,m+J+K+n+J);break;case 3:o.css(r,u+K+u).css(s,t+K+t)}},a.device=function(){var a,b,c,d,e=navigator.userAgent,f=e.match(/iPad/i);if(f)a=f[0],a&&(b="ipad"===a.toLowerCase());else if(f=e.match(/Macintosh/i),f&&(a=f[0]))try{document.createEvent("TouchEvent"),b="macintosh"===a.toLowerCase()}catch(a){}return f=e.match(/iPhone/i),f&&(a=f[0],a&&(c="iphone"===a.toLowerCase())),f=e.match(/android/i),f&&(a=f[0],a&&(d="android"===a.toLowerCase())),{ipad:b,iphone:c,android:d}},a.sl=function(){var a=navigator.platform;return a&&a.indexOf("Mac")>-1},a.tl=function(a){if(a===y||a===z)return!1;var b=""+a;return b=k.Oa(b),!H(+(""===b.trim()?NaN:b))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(b)},a.ul=function(b,c,d,e,f){var g,h,i,j,k,l,n=z,o=!1;if(b&&(g=b.formatter,g?(f?n=f:a.lHb(g)||(n=g,o=!0),typeof n===M&&m&&(n=new m(n))):n=b._autoFormatter),n&&!n.isAuto){h=z;try{if(h=n.parse(c),o&&h instanceof Date&&(i=(new m).getPreferredDisplayFormatter(c,f),i&&(h=i.parse(c))),typeof h===N)return h}catch(a){}return h===y||h===z?c:h}if(d){if(j=void 0,j={},k=void 0,l=z,m)try{l=(new m).getPreferredDisplayFormatter(c,j)}catch(a){}return k=j.value,typeof k===N?c=k:a.tl(c)&&(k=j.value=c),e&&(e.value=l),k!==y&&k!==z?k:c}return c},a.vl=function(a){for(var b,c,d=t.body,e=a;e&&e.parentElement&&e.parentElement!==d;)e=e.parentElement;return b=1e3,e&&e.parentElement===d&&(c=F(i(e).css("z-index")),H(c)||(b+=c)),b},a.wl=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(!a)return[];if(b=a.indexOf("("),c=a.lastIndexOf(")"),d=a.substring(b+1,c),!d)return[];for(e=[],f=0,g="",h=0,i=0;i<d.length;)h=d.indexOf("rgb",f),i=d.indexOf("rgb",f+1),i===-1&&(i=d.length),g=d.substring(h,i),e.push(g),f=i;for(j=[],k=0,l=e.length;k<l;k++)m=e[k],n=m.indexOf(")"),o=m.substring(0,n+1),p=G(m.substring(n+1,m.length)),H(p)&&(k===l-1?p=100:k<=1&&(p=0)),(o||0!==k)&&(p/=100,j.push({color:o,point:p}));return j},a.xl=function(b,c,d,e,f){var h,i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,y,A,D,E,G,H,I,J=c.yl,K=0,L=[d],M=c.zoom();for(e===g.AutoFitType.cellWithHeader&&(d===g.SheetArea.viewport?L.push(1):d===g.SheetArea.rowHeader&&L.push(0)),h=0;h<L.length;h++)for(i=0,j=L[h],k=f?f:c.getRowCount(j);i>=0&&i<k;)if(l=c.ITa.findSpan(i,b,j),l&&(l.col<b||l.colCount>1||l.row<i))i=l.row+l.rowCount;else{if(m=c.getActualStyle(i,b,j),n=0,p=m.cellType||c.Al(j),p&&(q=m.font||J.Bl(),m.font=J.Cl(q),r=c.rowFilter&&c.rowFilter(),s=!(!r||!r.Dl(i,b,j)),s||3!==j||(t=c.tables?c.tables.find(i,b):z,t&&t.showHeader()&&t.headerIndex()===i&&t.rowFilter()&&t.filterButtonVisible(b-t.range().col)&&(s=!0)),u=m.formatter?m.formatter:m._autoFormatter,v={sheet:c,row:i,col:b,sheetArea:j,quotePrefix:m.quotePrefix},w={},x=c.getValue(i,b,j,g.ValueType.richText),y=c.xHb(i,b,d),A="",A=x&&x.richText?c.getText(i,b,j):o(y)?p.format(x,u,w,v):y,n=p.X4(x,A,m,M,v),s&&(D=C(M,1),E=F(""+c.defaults.rowHeight*D,10),n+=E)),G=m.cellButtons,f&&G)for(H=0;H<G.length;H++)I=G[H],I.imageSize&&(n+=I.imageSize.width+7);n>K&&(K=n),j===g.SheetArea.viewport?i=a.El(i,b,c,j):i++}return 0===K?K=c.defaults.colWidth:K+=B(3),B(K)},a.El=function(a,b,c,d){var e,f,g,h=-1,i=c.getRowCount(d);for(e=a+1;e<i;e++){if(f=c.getText(e,b,d)){h=e;break}if(g=c.getActualStyle(e,b,d),g&&(g.cellType||g.cellButtons&&g.cellButtons.length>0)){h=e;break}}return h},a.Fl=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=c.yl,u=0,v=[d],w=c.zoom();for(1===e&&(3===d?v.push(2):1===d&&v.push(0)),g=0,h=!1,i=0;i<v.length;i++)for(d=v[i],j=0,k=c.getColumnCount(d);j>=0&&j<k;)l=c.ITa.findSpan(b,j,d),l&&(l.row<b||l.rowCount>1||l.col<j)?j=l.col+l.colCount:(c.getColumnWidth(j,d)>0&&(m=c.getActualStyle(b,j,d),n=m.font||t.Bl(),m.font=t.Cl(n),o=0,p=c.getCellType(b,j,d),p&&(q=c.getText(b,j,d),r=c.getValue(b,j,d,1),s={sheet:c,row:b,col:j,sheetArea:d},o=p.Y4(r,q,m,w,s)),f=c.sYc(j),2===f?g=g+o+B(3):(g&&(o+=g,g=0),1===f&&(h=!0)),g&&(o=g),o>u&&(u=o)),3===d?j=a.Gl(b,j,c,d):j++);return h&&u<60&&(u=60),0===u?u=c.defaults.rowHeight:u+=B(3),B(u)},a.Gl=function(a,b,c,d){var e,f,g,h=-1,i=c.getColumnCount(d);for(e=b+1;e<i;e++){if(f=c.getText(a,e,d)){h=e;break}if(g=c.getActualStyle(a,e,d),g&&g.cellType){h=e;break}}return h},a.Il=function(b,c,e,f){var g,i,j,l,o,p,q,r,s;if(e&&(g=e.Jl,i=e.Kl,j=b.formatter?b.formatter:b._autoFormatter,l=f||{},m&&c!==z&&c!==y))if(o=void 0,j&&j.isAuto)o=typeof c===N,p=a.tl(c),!o&&p&&(c=k.Oa(c)),c=j.getPreferredEditingFormatter?j.getPreferredEditingFormatter(c).format(c):c;else if(typeof j!==M||a.lHb(j)||(j=new m(j)),j)try{c instanceof Date?(q=h&&h.Convert.Wh(c),q&&(c=q),r=d.Common.CultureManager.q4().DateTimeFormat,s=d.Common.l.Ra(c),j=new m(!n.Lc(j.formatString(),["d","y"])&&s>=0&&s<1?r.longTimePattern:0===c.getHours()&&0===c.getMinutes()&&0===c.getSeconds()&&0===c.getMilliseconds()?r.shortDatePattern:r.shortDatePattern+K+r.longTimePattern),e.Ll=!0,c=j.format(c),l.formatter=j):typeof c===N&&(c=k.nb(""+c))}catch(a){c=e.getText(g,i)}else c=e.getText(g,i,3);return c!==z&&c!==y&&(c=a.bc(c)),c},a.ZXc=function(b,c,e,f){var g,i,j,l,o,p,q;if(e&&(g=b.formatter?b.formatter:b._autoFormatter,i=f||{},m&&c!==z&&c!==y))if(j=void 0,g&&g.isAuto)j=typeof c===N,l=a.tl(c),!j&&l&&(c=k.Oa(c)),c=g.getPreferredEditingFormatter?g.getPreferredEditingFormatter(c).format(c):c;else if(typeof g!==M||a.lHb(g)||(g=new m(g)),g)try{c instanceof Date?(o=h&&h.Convert.Wh(c),o&&(c=o),p=d.Common.CultureManager.q4().DateTimeFormat,q=d.Common.l.Ra(c),g=new m(!n.Lc(g.formatString(),["d","y"])&&q>=0&&q<1?p.longTimePattern:0===c.getHours()&&0===c.getMinutes()&&0===c.getSeconds()&&0===c.getMilliseconds()?p.shortDatePattern:p.shortDatePattern+K+p.longTimePattern),c=g.format(c),i.formatter=g):typeof c===N&&(c=k.nb(""+c))}catch(a){}return c!==z&&c!==y&&(c=a.bc(c)),c},a.$Xc=function(b,c,d){var e,f,g,h,i,j="";if(b)if(e=b.parent,f=e&&e.options,g=b.getFormulaInformation(c,d),g&&g.hasFormula){if(j="="+g.formulaWithCulture,g.isDynamicArray)return""}else h=b.getActualStyle(c,d),i=b.getValue(c,d),j="string"==typeof i&&h.quotePrefix||j.length>0&&"="===j[0]&&f&&f.allowUserEditFormula?"'"+i:a.ZXc(h,i,b)||"";return j},a.yIc=function(a,b){var c,e=a,f=d.Common.CultureManager.q4(b).NumberFormat,g=f&&f.percentSymbol;return!(!g||!a)&&("object"==typeof a&&a.formatCached&&(e=a.formatCached),"object"!=typeof e&&("string"==typeof e&&(c=k.Hja(e),c.fb>0)))},a._Va=function(b){var c,d=a.Ml.msie||a.Ml.edge,e=d&&s.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return b?e:(c=d&&s.PointerEvent&&(navigator.maxTouchPoints||0)>1,e||c)},a.K_a=function(b){return b&&b.richText&&b.richText.length>0?(b.text||(b=a.n0a(b)),b.text):b},a.n0a=function(a){var b,c,d;if(!a)return a;if(b=a.richText,b&&b.length>0){for(c=[],d=0;d<b.length;d++)c.push(b[d].text?b[d].text:"");a.text=c.join("")}return a},a.lHb=function(a){return"string"==typeof a&&("="===a.charAt(0)||a.indexOf("{{")>=0&&a.indexOf("}}")>=0)},a.Pl=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==y?g[e]:f:(b!==!1&&d&&!d.call(i,a)||(h=g[e]!==y?g[e]:f,h!==a&&(g[e]=a,b!==!1&&c&&c.call(i,a,h))),i)};return g.isDefault=function(a){return a===f},g},a.Ql=function(a,b){var c={_ps:{}};return d.Common.j.H(a,function(a){na(c,a,b)}),c},a.Rl=function(a,b,c,d,e){var f,g=C(b,c),h=D(b,c),i=0;for(f=g;f<h&&(i+=d?a.Sl(f,3):a.Tl(f,3),!(e&&i>e));f++);return i},a.YIc=function(a,b,c,d,e){var f,g,h=C(b,c),i=D(b,c),j=0;for(f=h;f<i&&(d?(g=a.Er(f),a.getViewportTopRow(g)<=f&&a.getViewportBottomRow(g)>=f&&(j+=a.Sl(f,3))):(g=a.Fr(f),a.getViewportLeftColumn(g)<=f&&a.getViewportRightColumn(g)>=f&&(j+=a.Tl(f,3))),!(e&&j>e));f++);return j},a.Z3=function(a,b){var c,d,e=0,f=0;return a!==b&&(c=i(a).offset(),d=i(b).offset(),e=c.left-d.left,f=c.top-d.top),{FB:f,EB:e}},a.bq=function(a,b,c,d){var e,f,g,h,i=d||{};if(!a||"string"!=typeof a)return i.message=r().Exp_SheetNameInvalid,!1;for(f=0;f<a.length;f++)if(e=a.charAt(f),"*"===e||":"===e||"["===e||"]"===e||"?"===e||"\\"===e||"/"===e)return i.message=r().Exp_SheetNameInvalid,!1;if("'"===a.charAt(0)||"'"===a.charAt(a.length-1))return i.message=r().Exp_SheetNameInvalid,!1;if(!b)return!0;for(g=b.length,f=0;f<g;f++)if(h=b[f],c!==h&&a.toUpperCase()===h.name().toUpperCase())return i.message=r().Exp_SheetNameConflict,!1;return!0},a.Ika=function(a,b,c){var d,e,f;if(!a)return a;for(d=0,e=a.length,f=[];d<e;)a[d]===b?f[d]=c:f[d]=a[d],d++;return f.join("")},a.tt=function(){var b,c,d,e=a;return e.ct||(b=la("span"),c=b.style,d="-10000px",c.visibility="hidden",c.top=d,c.left=d,c.position="absolute",b.setAttribute("gcUIElement","gcStringWidthSpan"),t.body.insertBefore(b,z),e.ct=b),e.ct},a.fp=function(b,c,d){var e,f,g,h=a,i=h.st;if(!c)if(i){if(d&&(i=i.CJKFontCache),e=i[b])return e}else i=h.st={CJKFontCache:{}},d&&(i=i.CJKFontCache);return f=h.tt(),f.style.font=a.hZa(b),a.Ml&&a.Ml.safari&&(f.style.lineHeight="normal"),f.innerHTML=d?String.fromCharCode(20013):"H",g=f.offsetHeight,c||(i[b]=g),g},a.Pxb=function(b){var c,d,e=a,f=e.Qxb;if(f){if(f[b])return f[b]}else f=e.Qxb={};return d=e.tt(),d.style.font=b,d.innerHTML="H",c={},c.fontFamily=d.style.fontFamily,c.fontSize=d.style.fontSize,c.fontStyle=d.style.fontStyle,c.fontWeight=d.style.fontWeight,f[b]=c,c},a.Voa=function(b,c){var d=a.tt();return d.style.font=a.hZa(c),a.Ml&&a.Ml.safari&&(d.style.lineHeight="normal"),d.innerHTML=p.Ob(b||"H"),d.offsetHeight},a.iZa=function(c){var d,e,f=a;return c.indexOf(b.FallbackFontFamily)>=0?c:(c=c.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),d=f.tt(),e=d.style,e.font=c,e.fontFamily=[].concat(e.fontFamily.split(","),b.FallbackFontFamily.split(",")).join(","),e.font)},a.hZa=function(b){var c,d,e=a;return b&&e.jZa?(c=e.kZa,c||(c=e.kZa={}),d=c[b],d||(d=c[b]=e.iZa(b)),d):b},a.lZa=function(b,c){c&&(c=a.hZa(c),b.font!==c&&(b.font=c))},a.pL=function(b,c,d){return!c||o(d)?0:(a.lZa(b,c),b.measureText(d).width)},a.no=function(){var b=a,c=b.ct;c&&(i(c).remove(),b.ct=y),b.st=y,b.Qxb=y,a._0&&(a._0=y),b.kZa=y},a.Woa=function(b){var c,d=a._0;return d||(d=a._0=la("div")),c=b.innerHTML,d.innerHTML=c,d.innerText},a.G$a=function(a){return a&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(a)&&!(["C","c","R","r"].indexOf(a)!==-1||/^[A-Za-z]{1,3}(\$)?\d+$/.test(a)||/^[Rr]\d*[Cc]\d*$/.test(a)||a.length>=255)},a.T$a=function(a){a&&(a.j_a(!0),a.initExpression(),a.k_a())},a.l_a=function(a){var b,c,d=0,e=0,f=a.length;for(f>0&&(d=a[0].row,e=a[0].col),b=1;b<f;b++)c=a[b],d>c.row&&(d=c.row),e>c.col&&(e=c.col);return d=d<0?0:d,e=e<0?0:e,{r:d,c:e}},a.w0a=function(a){var b,c;return typeof a===M&&"/"===a.charAt(0)?(c=void 0,R.test(a)?(c=a.match(R),b=d.Common.l.Xb(G(c[1]))):Q.test(a)?(c=a.match(Q),b=new Date(G(c[1]))):b=a):b=a,b},a.x0a=function(a){var b;return b=!o(a)&&d.Common.l.Ska(a)?d.Common.l.Daa(a):a},a.yHb=function(a,b){var c,d,e=a.getImageData(b.x,b.y,b.width,b.height),f=e.data;for(c=0;c<f.length-4;c+=4)d=A((30*f[c]+59*f[c+1]+11*f[c+2]+50)/100),f[c]=d,f[c+1]=d,f[c+2]=d;a.putImageData(e,b.x,b.y)},a.rXc=function(a,b,c){a.rowCount>b&&(a.rowCount=b),a.colCount>c&&(a.colCount=c)},a.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,a.nl=oa,a.rl=a.device,a.Ml=function(){var a,b,c,d,e,f,g;function h(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}}a=navigator.userAgent,b=h(a),c={version:y,chrome:y,webkit:y,safari:y,mozilla:y,msie:y,metroMode:y,edge:y},b.browser&&(c[b.browser]=!0,c.version=b.version),c.chrome?c.webkit=!0:c.webkit&&(c.safari=!0),d=a.indexOf("PhantomJS")>=0,d&&(c.safari=!1,c.chrome=!0),e=a.toLowerCase(),f=e.indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(e)!==z,f&&(c.mozilla=y,c.msie=!0),g=/Edge\/\d+/.exec(a),g!==z&&g.length>0&&(c.webkit=y,c.chrome=y,c.msie=!0,c.edge=!0,c.version=g[0].substr(g[0].indexOf("/")+1));function i(){var a=z,b=!1;try{new ActiveXObject("")}catch(b){a=b.name}try{b=!!new ActiveXObject("htmlfile")}catch(a){b=!1}return b="ReferenceError"===a||b!==!1,!b}return c.msie&&i()&&(c.metroMode=!0),c}(),a.browser=a.Ml,a.Nl=la,a.Ol=ka,a.uWa=pa,a.jZa=a.sl(),a.Fxb=function(a){return!o(a)&&(typeof a===N||typeof a===u||a instanceof Date||h&&a instanceof h.CalcError)},a}(),b.util=T,b.Ul=T,U=T.pL,V=function(){function a(){}return a.Wl=function(b){return!(a.Xl()!==b||!b.mm||!b.mm.YH)},a.Xl=function(){return s&&s.Yl&&s.Yl.activeElement},a.kmb=function(b){var c,d,e,f,h,i,j,k,l,m,n;function o(a){var f,g;for(f=0;f<=2;f++)g=a.call(c,f),g&&0!==g.width&&0!==g.height&&(b.$l=!0,d._l(e,g))}if(b&&!a.Wl(b)&&b.parent&&b.parent.options.hideSelection)if(c=b.am(),d=b.yl,e=d.bm(),f=b.QLc,h=f&&f.isEnable(g.RowColumnStates.selected,!0),i=f&&f.isEnable(g.RowColumnStates.selected,!1),j=b.getSelections(),k=void 0,l=void 0,h||i){for(m=void 0,k=0;k<j.length;k++)n=j[k],m=m?m.union(n):n;m&&d.im(m)}else{for(k=0;k<j.length;k++)n=j[k],l=b.cm(n),l.width>=0&&l.height>=0&&(l.x-=9,l.y-=9,l.width+=18,l.height+=30,d.dm(l));l=c.em(),b.$l=!0,d._l(e,l),o(c.fm),o(c.gm)}},a.Zl=function(b,c){var d=a.Xl();s.Yl.activeElement=b,b===d||c||(d&&(d.endEdit(),a.kmb(d),d.hm&&d.hm()),b&&b.yl.im())},a}(),b.Vl=V;function qa(a,b){var c=la("span");return c.className=a,b&&(c.id=b),c.style.display="none",ma(c),c}function ra(a,b,c,d){a.addEventListener(b,c,d)}function sa(a){var b=a.currentStyle,c=t.defaultView;return c&&c.getComputedStyle&&(b=c.getComputedStyle(a,"")),b}function ta(a){var b,c,d,e,f,g,h,j=s.Yl;j.jm>0||(16!==a.keyCode&&(j.XCb=!0),b=V.Xl(),c=b&&b.lm,c&&(d=i(c),d.isVisible())||b&&b.mm&&b.mm.nm&&(b.mm.nm(a),b.isEditing()||(e=a.keyCode,f=a.ctrlKey,g=a.altKey,h=a.shiftKey,90!==e&&89!==e||!f||g?86!==e||!f||g||h||a.stopPropagation&&a.stopPropagation():oa(a))))}function ua(a){var b,c=s.Yl;c.jm>0||(c.XCb=!1,b=V.Xl(),b&&b.mm&&b.mm.om&&b.mm.om(a))}function va(a){var b,c=s.Yl;c.jm>0||(b=V.Xl(),b&&b.mm&&b.mm.pm&&b.mm.pm(a))}function wa(a){var b,c=s.Yl;c.jm>0||c.XCb!==!0&&(b=V.Xl(),b&&b.mm&&b.mm.pm&&b.mm.pm(a))}function xa(a){return t.all===y&&V.Xl()&&oa(a),!1}W=function(){function a(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}return a.prototype.rm=function(){var a="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",b="span."+a.split(K).join(L);return X.vm?i(t).find(b).length<=0&&ma(X.vm):X.vm=qa(a),X.vm},a.prototype.sm=function(){var a="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",b="span."+a.split(K).join(L);return X.wm?i(t).find(b).length<=0&&ma(X.wm):X.wm=qa(a),X.wm},a.prototype.tm=function(){var a="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",b="span."+a.split(K).join(L);return X.xm?i(t).find(b).length<=0&&ma(X.xm):X.xm=qa(a),X.xm},a.prototype.um=function(){var a="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",b="span."+a.split(K).join(L);return X.ym?i(t).find(b).length<=0&&ma(X.ym):X.ym=qa(a),X.ym},a.prototype.zm=function(){var a="gc-theme-version",b="gcDummyElement";return X.Am?i(t).find("#"+b).length<=0&&ma(X.Am):X.Am=qa(a,b),X.Am},a.prototype.qm=function(){X.rm(),X.sm(),X.tm(),X.um()},a.prototype.ad=function(){var a,b,c=this;c.jm=0,ra(s,"keydown",ta,!0),ra(s,"keyup",ua,!0),ra(s,"compositionstart",va,!0),ra(s,"selectstart",xa,!0),a=T.rl(),b=a.ipad||a.iphone,T.browser.safari&&!b&&ra(s,"textInput",wa,!0);function d(a,b){for(var c=!1,d=a;d;){if("gcSpread"===i(d).attr("gcUIElement")){c=b.zo()!==d;break}d=d.parentElement}return c}function e(a){var e,f,g,h=V.Xl();if(h&&(e=X.Bm(a.target),f=h.Cw&&h.Cw.V4,c.km.forEach(function(a){a&&a(h,e)}),!e||d(e,h)))if(h.gv(y,y,f))b&&(g=h.mm,g&&g.Cm&&g.Cm()),V.Zl(z);else if(a.cancelable)return!1}function f(a){var b=a.pointerType;b!==a[P]&&b!==O||e(a)}T._Va()?(i(t).bind("MSPointerDown",f),i(t).bind("pointerdown",f)):i(t).bind("touchstart",e),ra(t,"mousedown",function(a){var b=e(a);b===!1&&oa(a)},!0),i(t).bind("DOMContentLoaded",function(){X.qm()})},a.prototype.Bm=function(a){for(var b,c=a;c&&"BODY"!==c.tagName&&typeof c.getAttribute===x;){if(b=c.getAttribute("gcUIElement"),b||(b=c.gcUIElement),b)return c;c=c.parentNode}return z},a.prototype.Dm=function(a,b){var c,d,e,f,h=X.rm();return a===g.VisualState.highlight||a===g.VisualState.selected?h=X.um():a===g.VisualState.hover&&(h=X.tm()),c=h.className,i(h).removeClass(c).addClass(b),d=sa(h),e={backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage},i(h).addClass(c),d=sa(h),f={backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage,color:d.color,zIndex:d.zIndex},f.borderLeftColor=d.borderLeftColor,f.borderRightColor=d.borderRightColor,f.borderBottomColor=d.borderBottomColor,f.borderBottomWidth=d.borderBottomWidth,f.borderTopColor=d.borderTopColor,f.borderRightWidth=d.borderRightWidth,f.backgroundImage===e.backgroundImage&&f.backgroundColor!==e.backgroundColor&&(f.backgroundImage=y),i(h).removeClass(b),f},a.prototype.Em=function(a){var b,c=X.zm();return i(c).removeClass(c.className).addClass("gc-theme-version "+a),b=sa(c),j({},b)},a.prototype.Fm=function(a){var b,c=X.sm();return i(c).removeClass(c.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+a),b=sa(c),j({},b)},a.prototype.Gm=function(){var a=s.Yl;a.jm++},a.prototype.Hm=function(){var a=s.Yl;a.jm--,a.jm<0&&(a.jm=0)},a}(),X=W.prototype,s.Yl||(s.Yl=new W),Y=function(){function a(){}return a.Jm=function(a){var b={0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"};return b[a]||""},a.Km=function(b,c){var d=a.Jm(b)+c,e=a.styleCache;return e[d]||(e[d]=X.Dm(b,c)),e[d]},a.Lm=function(b){var c=b,d=a.styleCache;return d[c]||(d[c]=X.Em(b)),d[c]},a.Mm=function(b){var c="content"+b,d=a.styleCache;return d[c]||(d[c]=X.Fm(b)),d[c]},a._ob=function(a,b){var c=a.Pm;return c&&c.getColor&&(b=c.getColor(b)),b},a.Nm=function(){a.styleCache={}},a.styleCache={},a}(),b.Im=Y,Z=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.clone=function(){return new a(this.x,this.y)},a}(),b.Point=Z,$=function(){function a(a,b,c,d){var e=this;e.x=a,e.y=b,e.width=c,e.height=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return a<e.x+e.width&&e.x<a+c&&b<e.y+e.height&&e.y<b+d},a.prototype.intersectRect=function(a){return this.intersect(a.x,a.y,a.width,a.height)},a.prototype.contains=function(a,b,c){var d=this;return c?d.x<=a&&a<=d.x+d.width&&d.y<=b&&b<=d.y+d.height:d.x<a&&a<d.x+d.width&&d.y<b&&b<d.y+d.height},a.prototype.containsRect=function(a,b){return this.contains(a.x,a.y,b)&&this.contains(a.x+a.width,a.y+a.height,b)},a.prototype.getIntersectRect=function(a){return this.getIntersect(a.x,a.y,a.width,a.height)},a.prototype.getIntersect=function(b,c,d,e){var f=this,g=f.x,h=f.y,i=f.x+f.width,j=f.y+f.height,k=b,l=c,m=b+d,n=c+e,o=D(g,k),p=D(h,l),q=C(i,m),r=C(j,n),s=o,t=p,u=q-o,v=r-p;return u>0&&v>0?new a(s,t,u,v):z},a.prototype.round=function(){var a=this;a.x=A(a.x),a.y=A(a.y),a.width=B(a.width),a.height=B(a.height)},a.prototype.clone=function(){var b=this;return new a(b.x,b.y,b.width,b.height)},a}(),b.Rect=$,_=function(){function a(a,b,c,d){var e=this;e.row=a,e.rowCount=c,e.col=b,e.colCount=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return(a===-1||e.row===-1||e.row<a+c&&a<e.row+e.rowCount)&&(b===-1||e.col===-1||e.col<b+d&&b<e.col+e.colCount)},a.prototype.getIntersect=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=this;return b&&o.intersect(b.row,b.col,b.rowCount,b.colCount)?(e=o.col===-1?d-1:o.col+o.colCount-1,f=b.col===-1?d-1:b.col+b.colCount-1,g=o.row===-1?c-1:o.row+o.rowCount-1,h=b.row===-1?c-1:b.row+b.rowCount-1,i=D(o.col,b.col),j=C(e,f),k=D(o.row,b.row),l=C(g,h),m=k===-1?-1:l-k+1,n=i===-1?-1:j-i+1,new a(k,i,m,n)):z},a.prototype.contains=function(a,b,c,d){var e=this,f=arguments.length,g=!1;return 2!==f&&4!==f||(2===f&&(c=1,d=1),g=(e.row===-1||e.row<=a&&a+c<=e.row+e.rowCount)&&(e.col===-1||e.col<=b&&b+d<=e.col+e.colCount)),g},a.prototype.containsRange=function(a){return this.contains(a.row,a.col,a.rowCount,a.colCount)},a.prototype.offset=function(b,c){var d=this,e=d.col,f=d.row;return e!==-1&&(e+=b),f!==-1&&(f+=c),new a(f,e,d.rowCount,d.colCount)},a.prototype.union=function(a){return ya(this,a)},a.prototype.equals=function(b){var c=this;return b instanceof a&&c.row===b.row&&c.col===b.col&&c.rowCount===b.rowCount&&c.colCount===b.colCount},a}(),b.Range=_,b.kf=function(a,b,c,d){return new _(a,b,c,d)};function ya(a,b){var c=C(a.row,b.row),d=C(a.col,b.col),e=D(a.row+a.rowCount-1,b.row+b.rowCount-1),f=D(a.col+a.colCount-1,b.col+b.colCount-1);return c>=0&&d>=0?new _(c,d,e-c+1,f-d+1):c>=0?new _(c,(-1),e-c+1,(-1)):d>=0?new _((-1),d,(-1),f-d+1):new _((-1),(-1),(-1),(-1))}b.getUnionRange=ya,aa=function(){function a(){}return a.Om=function(a,b){if(a&&b){var c=a.currentTheme();if(c)return c.getColor(b)}return b},a.Qm=function(a,b){if(a&&b){var c=a.currentTheme();return c?c.getFont(b):b}return z},a}(),b.Rm=aa,ba=function(){function a(){}return a.ValidationError="ValidationError",a.CellClick="CellClick",a.CellDoubleClick="CellDoubleClick",a.ColumnChanging="ColumnChanging",a.RowChanging="RowChanging",a.EnterCell="EnterCell",a.LeaveCell="LeaveCell",a.ValueChanged="ValueChanged",a.TopRowChanged="TopRowChanged",a.SheetChanging="SheetChanging",a.SheetChanged="SheetChanged",a.PivotTableChanged="PivotTableChanged",a.LeftColumnChanged="LeftColumnChanged",a.InvalidOperation="InvalidOperation",a.RangeFiltering="RangeFiltering",a.RangeFiltered="RangeFiltered",a.RangeFilterClearing="RangeFilterClearing",a.TableFilterClearing="TableFilterClearing",a.RangeFilterCleared="RangeFilterCleared",a.TableFilterCleared="TableFilterCleared",a.TableFiltering="TableFiltering",a.TableFiltered="TableFiltered",a.RangeSorting="RangeSorting",a.RangeSorted="RangeSorted",a.ClipboardChanging="ClipboardChanging",a.ClipboardChanged="ClipboardChanged",a.ClipboardPasting="ClipboardPasting",a.ClipboardPasted="ClipboardPasted",a.ColumnWidthChanging="ColumnWidthChanging",a.ColumnWidthChanged="ColumnWidthChanged",a.RowHeightChanging="RowHeightChanging",a.RowHeightChanged="RowHeightChanged",a.DragDropBlock="DragDropBlock",a.DragDropBlockCompleted="DragDropBlockCompleted",a.DragFillBlock="DragFillBlock",a.DragFillBlockCompleted="DragFillBlockCompleted",a.EditStarting="EditStarting",a.EditStarted="EditStarted",a.EditChange="EditChange",a.EditEnding="EditEnding",a.EditEnd="EditEnd",a.EditEnded="EditEnded",a.RangeGroupStateChanging="RangeGroupStateChanging",a.RangeGroupStateChanged="RangeGroupStateChanged",a.SelectionChanging="SelectionChanging",a.SelectionChanged="SelectionChanged",a.SheetTabClick="SheetTabClick",a.SheetTabDoubleClick="SheetTabDoubleClick",a.SheetNameChanging="SheetNameChanging",a.SheetNameChanged="SheetNameChanged",a.ViewZooming="ViewZooming",a.ViewZoomed="ViewZoomed",a.UserZooming="UserZooming",a.UserFormulaEntered="UserFormulaEntered",a.CellChanged="CellChanged",a.ColumnChanged="ColumnChanged",a.RowChanged="RowChanged",a.ActiveSheetChanging="ActiveSheetChanging",a.ActiveSheetChanged="ActiveSheetChanged",a.SparklineChanged="SparklineChanged",a.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",a.RangeChanged="RangeChanged",a.ButtonClicked="ButtonClicked",a.EditorStatusChanged="EditorStatusChanged",a.FloatingObjectChanged="FloatingObjectChanged",a.DrawingElementZIndexChanged="DrawingElementZIndexChanged",a.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",a.ShapeChanged="ShapeChanged",a.ShapeSelectionChanged="ShapeSelectionChanged",a.PictureChanged="PictureChanged",a.FloatingObjectRemoving="FloatingObjectRemoving",a.ShapeRemoving="ShapeRemoving",a.FloatingObjectRemoved="FloatingObjectRemoved",a.ShapeRemoved="ShapeRemoved",a.PictureSelectionChanged="PictureSelectionChanged",a.FloatingObjectLoaded="FloatingObjectLoaded",a.TouchToolStripOpening="TouchToolStripOpening",a.CommentChanged="CommentChanged",a.CommentRemoving="CommentRemoving",a.CommentRemoved="CommentRemoved",a.SlicerChanged="SlicerChanged",a.BeforeDragDrop="BeforeDragDrop",a.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",a.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",a.FormulatextboxEditStarted="FormulatextboxEditStarted",a.FormulatextboxEnterCell="FormulatextboxEnterCell",a.FormulatextboxEditEnded="FormulatextboxEditEnded",a.FormulatextboxRangeChanged="FormulatextboxRangeChanged",a.SheetMoving="SheetMoving",a.SheetMoved="SheetMoved",a.DragMerging="DragMerging",a.DragMerged="DragMerged",a.ChartClicked="ChartClicked",a.FloatingElementSelected="FloatingElementSelected",a.BeforePrint="BeforePrint",a.TableResizing="TableResizing",a.TableResized="TableResized",a.TableRowsChanged="TableRowsChanged",a.TableColumnsChanged="TableColumnsChanged",a.DropdownSpreadMouseClick="DropdownSpreadMouseClick",a.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",a.PasteEnd="PasteEnd",a}(),b.Events=ba,ca=function(){function a(a){this.kj=a}return a.prototype.no=function(){this.kj=z},a.prototype.Sm=function(a,b,c){var d,e=this.Tm,f=a<<4+b;return e?(d=e[f],d||(d=c(),e[f]=d),d):c()},a.prototype.Um=function(a,b){var c,d=this.Vm;return d&&(c=d[a])?c[b]:z},a.prototype.Wm=function(a,b,c,d){var e,f=this.Vm;f&&(f[a]||(f[a]={}),e=f[a],e[b]={d:c,i:d})},a.prototype.zHb=function(a,b,c,d,e){var f,g=this,h=g.kj;return c===y&&(c=3),f=h.xHb(a,b,c),o(f)?!o(e)&&T.lHb(e.formatter)?da.vn(h,e,g.ge(a,b,c,0),{},{row:a,col:b,sheet:h}):g.ge(a,b,c,d):f},a.prototype.ge=function(a,b,c,d){var e,f,g,h=this,i=h.kj,j=h.Xm;return c===y&&(c=3),j?(e=j[c],e||(e={},j[c]=e),f=e[a],f||(f={},e[a]=f),g=f[b],g===y&&(g=i.getValue(a,b,c,d),f[b]=g),g):i.getValue(a,b,c,d)},a.prototype.Ym=function(a,b,c){var d,e,f,g=this,h=g.kj,i=g.Zm;return c===y&&(c=3),i?(d=i[c],d||(d={},i[c]=d),e=d[a],e||(e={},d[a]=e),f=e[b],f||(f=h.AHb(a,b,c,!1,!0),e[b]=f),f.clone(!0)):h.AHb(a,b,c,!1,!1)},a.prototype.Sl=function(a){var b,c=this,d=c.kj,e=c.$m;return e?(b=e[a],b===y&&(b=e[a]=d.Sl(a)),b):d.Sl(a)},a.prototype._m=function(a){var b,c=this,d=c.kj,e=c.an;return e?(b=e[a],b===y&&(b=e[a]=d.Tl(a)),b):d.Tl(a)},a.prototype.bn=function(a){var b=this;return b.Xm?(b.cn||(b.cn=a()),b.cn):a()},a.prototype.dn=function(a){var b=this;return b.Xm?(b.gn||(b.gn=a()),b.gn):a()},a.prototype.hn=function(){var a=this;a.in=!0,a.Tm={},a.Vm={},a.Xm={},a.Zm={},a.$m={},a.an={}},a.prototype.jn=function(){this.in=!1},a.prototype.kn=function(){var a=this;a.in=!1,a.Tm=z,a.Vm=z,a.Xm=z,a.Zm=z,a.an=z,a.$m=z,a.cn=z,a.gn=z},a}(),b.ln=ca,da=function(){function a(){}return a.qn=function(b,c,d,e,f){var g,h,i,j;if(a.nn=!0,g=b.tables,g&&g.rn(c,d,e-c+1,f-d+1))for(h=-1,i=a.sn=[],j=0;j<=e;j++)b.getRowVisible(j)?(h++,i[j]=h):i[j]=-1},a.Nm=function(){a.sn=z,a.nn=!1},a.tn=function(b){var c=a.on;return c[b]||(c[b]=m?new m(b):z),c[b]},a.un=function(b,c,d){var e,f,g,h,i,j,k,n=a.pn,o=b+"_"+typeof b;return m?(n[c]||(n[c]={}),e=n[c],(f=e[o])?(d&&(d.conditionalForeColor=d.value=f.color,d.content=l(f.content)),f.text):(g=a.on,g[c]||(g[c]=new m(c)),h=g[c],i={},j=h.format(b,i),k=e[o]={},k.text=j,k.color=i.conditionalForeColor,k.content=i.content,d&&(d.conditionalForeColor=d.value=i.conditionalForeColor,d.content=l(i.content)),j)):""+b},a.vn=function(a,b,c,d,e){var f,g;return c&&"SparklineExValue"===c.typeName?"":(f=b.cellType||a.Al(),g=b.formatter||b._autoFormatter,f.format(c,g,d,e))},a.wn=function(){a.on={},a.pn={}},a.nn=!1,a.on={},a.pn={},a.sn=[],a}(),b.mn=da;function za(a){var b=a.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return a.An=b,b}ea=function(){function a(){}return a.Cn=function(a,b,c){var d=za(a);d.scaleX=b,d.scaleY=c,d.translateX=d.orgTranslateX*b,d.translateY=d.orgTranslateY*c,a.setTransform(d.scaleX,d.skewX,d.skewY,d.scaleY,d.translateX,d.translateY)},a.Dn=function(a,b,c){var d=za(a);d.orgTranslateX+=b,d.orgTranslateY+=c,d.translateX=d.orgTranslateX*d.scaleX,d.translateY=d.orgTranslateY*d.scaleY,a.setTransform(d.scaleX,d.skewX,d.skewY,d.scaleY,d.translateX,d.translateY)},a}(),b.Bn=ea,fa=ea;function Aa(a,b){a&&(a.Gn=b)}function Ba(a,b){a&&(a.Hn=b)}function Ca(a,b){a.In=b}function Da(a,b){a.Jn=b}ga=function(){function a(){}return a.npb=function(){var a=s.screen,b=a.deviceXDPI,c=s.devicePixelRatio||(b?b/a.logicalXDPI:1),d=20*c,e=E(d);return e-d>.82?e/20:E(100*c)/100},a.Kn=function(b,c,d){var e,f,g,h,i,j,k,l,m=a;if(Aa(b,1),Ba(b,1),e=a.npb(),(1!==e||1!==m.dpr)&&(m.dpr=e,f=c?c:d&&d.parent)){for(g=m.Fn,h=void 0,i=0;i<g.length;i++)if(f===g[i].workbook){h=g[i];break}if(h||(h={workbook:f,sheets:[],canvases:[]},g.push(h)),c)h.canvases.push(b);else{for(j=void 0,k=h.sheets,l=0;l<k.length;l++)if(k[l].sheet===d){j=k[l];break}j||(j={sheet:d,canvases:[]},k.push(j)),j.canvases.push(b)}}},a.Ln=function(a){return a&&a.Gn||1},a.Mn=function(a){return a&&a.Hn||1},a.Nn=function(a){return a.In},a.On=function(a){return a.Jn},a.Pn=function(b,c,d){var e,f,g,h=a,i=h.dpr,j=h.Ln(b),k=h.Mn(b);Ca(b,c),Da(b,d),1===i&&1===j&&1===k?(b.width=c,b.height=d):(e=b.getContext("2d"),fa.Cn(e,1,1),T.Ml.mozilla?(b.width=B(c*i),b.height=B(d*i)):(b.width=E(c*i),b.height=E(d*i)),b.style.width=c+J,b.style.height=d+J,f=b.width/c,g=b.height/d,f===j&&g===k||(Aa(b,f),Ba(b,g)),fa.Cn(e,f,g))},a.Qn=function(b,c){var d,e,f,g,h,i=a.Fn,j=b.parent;for(f=0;f<i.length;f++)if(!j||i[f].workbook===j)for(d=i[f].sheets,g=0;g<d.length;g++)if(d[g].sheet===b){for(e=d[g].canvases,h=0;h<e.length;h++)if(e[h]===c){e.splice(h,1);
break}break}},a.Rn=function(b,c){var d,e,f,g=a.Fn;for(e=0;e<g.length;e++)if(g[e].workbook===b)for(d=g[e].canvases,f=0;f<d.length;f++)if(d[f]===c){d.splice(f,1);break}},a.Sn=function(b){var c,d,e,f=a.Fn,g=b.parent;for(d=0;d<f.length;d++)if(!g||f[d].workbook===g){for(c=f[d].sheets,e=0;e<c.length;e++)c[e].sheet===b&&c.splice(e,1);return}},a.Tn=function(b){var c,d=a.Fn;for(c=0;c<d.length;c++)if(d[c].workbook===b)return void d.splice(c,1)},a.Un=function(){var b,c,d,e,f,g,h,i,j=a,k=j.npb();if(j.dpr!==k)for(b=j.Fn,c=void 0,d=void 0,e=void 0,f=void 0,j.dpr=k,g=0;g<b.length;g++){for(d=b[g],e=d.canvases,c=d.sheets,h=0;h<c.length;h++)e=e.concat(c[h].canvases);for(i=0;i<e.length;i++)f=e[i],j.Pn(f,j.Nn(f),j.On(f))}},a.dpr=1,a.Fn=[],a}(),b.En=ga;function Ea(){return ha.Yn||(ha.Yn=la("canvas").getContext("2d")),ha.Yn}function Fa(a){var b,c,d,e=[],f=0,g=K;for(b=0;b<a.length;b++)e[f]===y&&(e[f]=""),c=a.charAt(b),d="",b+1<a.length&&(d=a.charAt(b+1)),c===g&&d!==g||"-"===c&&"-"!==d?(e[f]+=c,f++):e[f]+=c;return e}b.$6c=Fa;function Ga(a){for(var b=a.length-1;" "===a.charAt(b);)b--;return b!==a.length-1&&(a=a.substring(0,b+1)),a}function Ha(a){var b,c=a instanceof Array?[]:{};for(b in a)a.hasOwnProperty(b)&&(c[b]="object"==typeof a[b]&&a[b]!==z?Ha(a[b]):a[b]);return c}function Ia(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=[],p=e?e:Ea();if(!p)return o;for(c?(h=a.length*d,g=B(b/d)):(h=U(p,p.font,a),f=h/a.length,g=B(b/f));h>b&&a;)for(i=!1,j=g;;){if(a.length<j){o.push(a),a="";break}if(k=a.substring(0,j),l=c?j*d:U(p,p.font,k),"-"===k.charAt(k.length-1)&&(l=c?j*d:U(p,p.font,k)-U(p,p.font,"-")),l===b||i&&l<b){o.push(k),a=a.substring(j),h-=l;break}if(l>b){if(1===k.length){m=a.substring(k.length),m.trim()?(o.push(k),a=a.substring(j),h-=l):(o.push(a),a="");break}j-=1,i=!0}else n=c?(b-l)/d:(b-l)/f,n=n>=1?n:1,j+=n}return a&&a.search(/^[ ]*$/)===-1&&o.push(a),o}function Ja(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=f?f:Ea();if(!q)return[a];for(g=[],h=0,i=b,j=[],k=0;k<a.length;k++)if(l=a[k].style&&a[k].style.font||e,m=T.fp(l),a[k].text&&a[k].text.length>0?h+=d?m*a[k].text.length:U(q,l,a[k].text):h=0,h<i)j.push(a[k]);else for(h-=d?m*a[k].text.length:U(q,l,a[k].text),n=0;n<a[k].text.length;n++){if(o=d?m:U(q,l,a[k].text.charAt(n)),o>c&&0===n){j.length>0&&(g.push(j),j=[]),j.push({style:a[k].style,text:a[k].text.substring(0,1)}),g.push(j),j=[],p=a[k].text.substring(1,a[k].text.length),p.length&&a.splice(k+1,0,{style:a[k].style,text:p}),h=0,i=c;break}if(h+=o,h>i){j.push({style:a[k].style,text:a[k].text.substring(0,n)}),g.push(j),j=[],p=a[k].text.substring(n,a[k].text.length),p.length&&a.splice(k+1,0,{style:a[k].style,text:p}),h=0,i=c;break}}return j.length>0&&g.push(j),g}function Ka(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=[],u=Fa(a),v=e?e:Ea();if(!v)return t;for(f=U(v,v.font,a),g=c?d:f/a.length,h=F(b/g+"",10),i=0,j=0,k=0,l=0,m=[],n=!1;l<u.length;){if(n===!1){if(o=u[l],m.push(o),j+=o.length,j<h&&l<u.length-1){l++;continue}k=j,j=0}if(p=c?m.join("").length*d:ha.Xn(m.join(""),v.font,!0,v),"-"===m.join("").charAt(m.join("").length-1)&&(p=c?m.join("").length*d:U(v,v.font,m.join(""))-U(v,v.font,"-")),p>b)if(q=m.pop(),0===m.length){for(r=Ia(q,b,c,d,v),s=0;s<r.length-1;s++)t[i]=r[s],i++;1===r.length&&(t[i]=r[0],i++),r.length>=2?u[l]=r[r.length-1]:l++,n=!1}else n=!0,l--;else p<b&&n===!0||p===b?(n=!1,t[i]=Ga(m.join("")),i++,m=[],l++):p<b&&(l++,j=k)}return 0!==m.length&&(t[i]=Ga(m.join(""))),t}function La(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,p,q,r=[],s=e?e:Ea();if(!s)return r;if(0===a.length)return r.push({textLength:0,text:"",textInfos:[{style:{font:c},text:""}]}),r;for(f=0,g=[],h=0;h<a.length;h++){for(i=a[h],j=0,k=0,l=0;l<i.length;l++)m=void 0,m=i[l].style&&i[l].style.font?i[l].style.font:c,d?(k=T.fp(m),j+=k*i[l].text.length):o(i[l].text)||(j+=U(s,m,i[l].text));if(j>b){for(g.length>0&&(r.push({textLength:f,text:Ga(Na(g)),textInfos:Ha(g)}),g=[],f=0),n=Ja(i,b-f,b,d,c,s),g=g.concat(n[0]),o(n[0])||r.push({textLength:f+Ma(n[0],c,d,s),text:Ga(Na(g)),textInfos:Ha(g)}),g=[],f=0,p=1;p<n.length-1;p++)o(n[p])||r.push({textLength:Ma(n[p],c,d,s),text:Ga(Na(n[p])),textInfos:Ha(n[p])});n.length>1&&(q=n[n.length-1],g=g.concat(q),o(q)||(f+=Ma(q,c,d,s)))}else f+j>b?(r.push({textLength:f,text:Ga(Na(g)),textInfos:Ha(g)}),g=[],g=g.concat(i),f=j):(g=g.concat(i),f+=j)}return g.length>0&&r.push({textLength:f,text:Ga(Na(g)),textInfos:Ha(g)}),r}function Ma(a,b,c,d){var e,f,g=0,h=d?d:Ea();for(e=0;e<a.length;e++)f=a[e].style&&a[e].style.font||b,g+=c?T.fp(f)*a[e].text.length:U(h,f,a[e].text);return g}function Na(a){var b,c="";for(b=0;b<a.length;b++)c+=a[b].text;return c}function Oa(a,b,c,d){var e,f,g,h,i,j=-1,k=!0;for(e=0;e<b.length;e++)if(!o(b[e].text))for(f=0;f<b[e].text.length;f++)g=b[e].text.charAt(f),h=b[e].style?b[e].style.font:c,T.lZa(a,h),i=T.fp(h),g===K||k?g!==K&&k&&(j=d?i:U(a,c,g),k=!1):j=C(j,d?i:U(a,c,g));return j}ha=function(){function a(){}return a.Wn=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=[];if(!a||0===a.length||isNaN(b))return p;if(f=e?e:Ea(),!f)return p;if(T.lZa(f,c),g=T.fp(c),b<=0){for(h=-1,i=!0,j=0;j<a.length;j++)k=a.charAt(j),k===K||i?k!==K&&i&&(h=d?g:U(f,f.font,k),i=!1):h=C(h,d?g:U(f,f.font,k));if(b=h,b<=0)return[a]}for(l=a.split(/\r\n|\r|\n/),m=0;m<l.length;m++)if(n=Ka(l[m],b,d,g,f))if(0===n.length)p.push("");else for(o=0;o<n.length;o++)p.push(n[o]);return p},a.oV=function(b,c,d,e,f){var g,h,i,j,k=[];if(0===c.length)return k;if(e)k=a.Wn(c,f,d,!0);else for(g=c.split(/\r\n|\r|\n/),h=0;h<g.length;h++){for(i=[],j=0;j<g[h].length;j++)i.push(g[h][j]);k.push(i)}return k},a.M_a=function(b,c,d,e,f,g){var h,i,j,k,l,m,n,p=[];if(0===b.length)return p;if(h=g?g:Ea(),!h)return p;if(c<=0&&(c=Oa(h,e,d,f),c<=0)){for(j=[],i=0;i<e.length;i++)o(e[i].text)||j.push({textLength:a.R_a([e[i]],d,1,f,!1,h),text:e[i].text,textInfos:[e[i]]});return j}for(k=a.N_a(b),l=a.O_a(k,a.P_a(e)),i=0;i<l.length;i++)if(m=La(l[i],c,d,f,h))if(0===m.length)p.push("");else for(n=0;n<m.length;n++)p.push(m[n]);return p},a.N_a=function(a){var b,c=[],d=a.split(/\r\n|\r|\n/);for(b=0;b<d.length;b++)c.push(Fa(d[b]));return c},a.O_a=function(a,b){var c,d,e,f,g,h,i=[],j=0,k=0;for(c=0;c<a.length;c++){for(d=[],e=0;e<a[c].length&&j<b.length;e++)if(f=a[c][e],f.length<=b[j].text.length-k)d.push([{style:b[j].style,text:f}]),k+=f.length;else{for(g=[],g.push({style:b[j].style,text:b[j].text.substring(k)}),h=f.length-(b[j].text.length-k),j++;j<b.length;j++){if(h<b[j].text.length){g.push({style:b[j].style,text:f.substring(f.length-h)}),k=h;break}if(h===b[j].text.length){g.push({style:b[j].style,text:f.substring(f.length-h)}),j++,k=0;break}g.push({style:b[j].style,text:b[j].text}),h-=b[j].text.length}d.push(g)}i.push(d)}return i},a.Xn=function(a,b,c,d){var e,f=d?d:Ea();return f?(b&&T.lZa(f,b),e=c?Ga(a):a,U(f,f.font,e)):0},a.P_a=function(a){var b,c=[];for(b=0;b<a.length;b++)c.push({style:a[b].style,text:a[b].text?a[b].text.replace(/\r\n|\r|\n/g,""):a[b].text});return c},a.R_a=function(a,b,c,d,e,f){var g,h,i,j,k,l=f?f:Ea();if(!l)return 0;for(g=0,h=0;h<a.length;h++)i=void 0,i=a[h].style&&a[h].style.font?a[h].style.font:b,T.lZa(l,i),j="",j=h===a.length-1&&e?Ga(a[h].text):a[h].text,k=0,d?k=T.fp(i)*j.length/c:o(a[h].text)||(k=U(l,l.font,a[h].text)/c),a[h].style&&a[h].style.vertAlign&&(k*=I),g+=k;return g},a.mHb=function(b,c,d,e,f,g,h,i){var j=0,k=T.fp(g),l=(h-4-k*e)/d,m=a.Wn(f,l,g),n=m.length,o=k/d,p=k*d;return j=(n-1)*o,j+=a.Xn(m[0],g)/2*e+p,j+=a.Xn(m[n-1],g)/2*e+p},a.Rvb=function(a){return Ga(a)},a.bm=function(){return Ea()},a}(),b.Vn=ha,b.Zn=function(a){a.$n=function(b,c){var d,e;for(a._n||(a._n=[]),a._fc={},d=a._n,c.name=b,c.priority=c.priority||5e3,e=0;;e++)if(e>=d.length||c.priority>d[e].priority){d.splice(e,0,c);break}},a.ao=function(b,c,d,e){var f,g,h,i=a._n;if(i){if(f=a._fc[c],!f)for(f=a._fc[c]=[],g=0;g<i.length;g++)h=i[g][c],h&&f.push(h);for(g=0;g<f.length&&(f[g].call(b,d),!e||!e());g++);}}},ia=function(){function a(){this.JTa={}}return a.prototype.get=function(a,b){var c=this.JTa[a];return c?c[b]:y},a.prototype.set=function(a,b,c){var d=this.JTa[a];d||(d=this.JTa[a]={}),d[b]=c},a}(),b.KTa=ia,ja=function(){function a(){}return a.processBackspaceAndLeftArrowKeyEvent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,u=s.getSelection();if(!(u.rangeCount<=0)){if(c=u.anchorNode,d=u.anchorOffset,e=a.target,T.browser.msie&&!T.browser.edge&&b&&Sa(c,d,e))return f=parseFloat(T.browser.version)<10?ab(e):e.innerText,g=f.slice(0,-1),e.innerHTML=g.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),u.selectAllChildren(e),u.rangeCount>0&&u.collapseToEnd(),void oa(a);if(h=u.getRangeAt(0),i=h.startContainer,j=h.endContainer,k=h.startOffset,l=h.endOffset,m=i===j&&k===l){if(n=$a(c,d),n&&n.zeroWidthCharNode){if(o=n.zeroWidthCharNode,p=n.previousTextNode,b)if(Ta(o))o.parentNode.removeChild(o);else{if(o.parentNode.removeChild(o.previousSibling),Ua(p))return void oa(a);q=u.getRangeAt(0),q.setStart(o,0),q.setEnd(o,1),q.deleteContents()}r=t.createRange(),Qa(p)?(r.setStart(p,1),r.setEnd(p,1)):(r.setStartAfter(p),r.setEndAfter(p)),r.collapse(!1),u.removeAllRanges(),u.addRange(r),oa(a)}}else b&&Pa(u)}},a.processDeleteAndRightArrowKeyEvent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=s.getSelection();p.rangeCount<=0||(c=p.getRangeAt(0),d=c.startContainer,e=c.endContainer,f=c.startOffset,g=c.endOffset,h=d===e&&f===g,h?(i=_a(p),i&&i.node&&(j=i.node,k=i.offset,l=$a(j,k),b?(m=p.getRangeAt(0),1===k?(m.setStart(j,0),m.setEnd(j,1),j.parentNode.removeChild(j.previousSibling),m.deleteContents(),l&&l.previousTextNode&&(n=l.previousTextNode,o=t.createRange(),Qa(n)?(o.setStart(n,1),o.setEnd(n,1)):(o.setStartAfter(n),o.setEndAfter(n)),o.collapse(!1),p.removeAllRanges(),p.addRange(o))):0===k&&(m.setStart(j,1),m.setEnd(j,2),m.deleteContents())):(o=t.createRange(),o.setStart(j,k),o.setEnd(j,k),o.collapse(!1),p.removeAllRanges(),p.addRange(o)),oa(a))):b&&Pa(p))},a}(),b.uHb=ja;function Pa(a){var b,c,d,e,f=a.getRangeAt(0),g=f.startContainer,h=f.startOffset,i=Ra(g);i&&(b=$a(g,h),b&&b.zeroWidthCharNode&&(c=b.zeroWidthCharNode,d=a.getRangeAt(0),d.setStart(c,1),d.deleteContents(),e=t.createRange(),e.setStart(c,1),e.setEnd(c,1),a.removeAllRanges(),a.addRange(e),oa(event)))}function Qa(a){return a.textContent&&1===a.textContent.length&&a.textContent.split("")[0]===S}function Ra(a){return a.textContent&&a.textContent.split("")[0]===S}function Sa(a,b,c){if(1===b&&Ta(c.firstChild)&&Ta(c.firstChild.firstChild)){var d=c.firstChild.firstChild.lastChild,e=void 0;if(a===c)return e=d.textContent,1===e.length&&e[0]!==S&&Ua(d.previousSibling);if(d===a||Ua(d)&&a===d.previousSibling)return e=a.textContent,1===e.length&&e[0]!==S&&Ua(a.previousSibling)}return!1}function Ta(a){return a&&"SPAN"===a.tagName}function Ua(a){return a&&"BR"===a.tagName}function Va(a){return a&&"DIV"===a.tagName}function Wa(a){return a instanceof Text}function Xa(a){if(a){var b=a.childNodes;return Ta(a)&&2===b.length&&Ua(b[0])&&Za(b[1])}return!1}function Ya(a,b){if(a){var c=a.childNodes;return Ta(a)&&Ua(c[b-2])&&Za(c[b-1])}return!1}function Za(a){if(a&&Wa(a)){var b=a.textContent;if(1===b.length&&cb(b[0]))return!0}return!1}function $a(a,b){var c,d,e,f,g,h=a.childNodes.length;if(!cb(a.textContent[0])||0!==b&&1!==b)if(0===b)d=a,a===a.parentNode.firstChild&&(d=a.parentNode),e=db(d,Xa),c=e&&e.lastChild;else{if(Va(a))return 1===h&&1===b?c=a.firstChild.firstChild.lastChild:h>1&&b===h&&(c=a.lastChild),Za(c)?{zeroWidthCharNode:c,previousTextNode:c.previousSibling.previousSibling}:Xa(c)?{zeroWidthCharNode:c,previousTextNode:db(d,Wa)}:z;!Ta(a)||b!==h&&b!==h-1||(Xa(a)?c=a:Xa(a.lastChild)?c=a.lastChild:Ya(a,b)&&(c=a.childNodes[b-1]))}else c=a;return c?(Ta(c)?d=c:Wa(c)&&(f=c.previousSibling,g=c.parentNode,d=f===g.firstChild?g:f),{zeroWidthCharNode:c,previousTextNode:db(d,Wa)}):z}function _a(a){var b,c,d=a.anchorNode,e=a.anchorOffset,f=d.textContent,g=f.length;if(e===g){if(b=eb(d),c=void 0,!b)return z;if(Ta(b)&&cb(b.textContent[0])){for(;Ta(b.firstChild);)b=b.firstChild;c=b.childNodes[1]}else Ua(b)&&cb(b.nextSibling.textContent[0])&&(c=b.nextSibling);return{node:c,offset:1}}return 0===e&&cb(f[0])?{node:d,offset:0}:z}function ab(a,b,c,d,e,f){var g,h,i,j,k,l="",m=a.childNodes,n=m.length;for(g=0;g<n;g++)h=m[g],Ta(h)?l+=ab(h,b,c,d,e,f):Wa(h)?(i=b&&b.startContainer,j=b&&b.endContainer,k=h.textContent,h===i||h===j?i!==j?h===i?(l+=bb(k,c,k.length,e),f=!0):(l+=bb(k,0,d,""),f=!1):l+=bb(k,c,d,e):f||(l+=k)):Ua(h)&&!f&&(l+="\n");return l}function bb(a,b,c,d){var e=a.substr(0,b),f=a.substr(c,a.length-c);return e+d+f}function cb(a){return a===S}function db(a,b){for(var c=a&&a.previousSibling;c;){if(b(c))return c;c=c.lastChild}return z}function eb(a){for(var b,c=a;c;){if(b=c.parentNode,c!==b.lastChild)return c.nextSibling;c=b}return z}b.Rxb={touch:!1};function fb(a){var b,c;return a&&(b=a.getActiveSheet(),b||(c=a.getActiveSheetTab(),c&&(b=c.kj))),b}b.sJc=fb;function gb(a,b){var c,d;a&&(c=a.getSheetFromName(b),c?a.setActiveSheet(b):(d=a.getSheetTab(b),d&&a.setActiveSheetTab(b)))}b.tJc=gb;function hb(a,b){var c,d=a.getSheetFromName(b);return d||(c=a.getSheetTab(b),c&&(d=c.kj)),d}b.uJc=hb;function ib(a){return"="===a||"+"===a||"-"===a}b.tYc=ib;function jb(a){return a&&a.length>0&&ib(a[0])&&isNaN(+a)&&!ib(a)}b.bW=jb,b.NUMBER_ARRAY=["0","1","2","3","4","5","6","7","8","9"]},"./dist/core/util/domUtil.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=d.Common.j,f=d.Common.D,g=void 0,h=null,i=parseFloat,j=document,k="_nonamespace",l="events",m="get",n="set",o="width",p="height",q="left",r="right",s="top",t="bottom",u="hidden",v="block",w="none",x="position",y="visibility",z="display",A={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},B={tabIndex:{get:function(a){var b=a.getAttributeNode("tabindex"),c=/^(?:input|select|textarea|button|object)$/i,d=/^(?:a|area)$/i,e=a.nodeName;return b&&b.specified?parseInt(b.value,10):c.test(e)||d.test(e)&&a.href?0:g}}},C={option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?h:[],i=f?e+1:d.length,j=f?e:0;for(e<0&&(j=i);j<i;j++)if(c=d[j],(c.selected||j===e)&&!c.disabled&&(!c.parentNode.disabled||!O(c.parentNode,"optgroup"))){if(b=H(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c=H.makeArray(b),d=H(a).find("option").getAll();return d.forEach(function(a){a.selected=H.inArray(H(a).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},D={},E="$"+(""+Math.random()).replace(/\D/g,""),F=1,G={},[p,o].forEach(function(a){G[a]={get:function(b){var c,d,e,f=getComputedStyle(b),g=b.style,h=g[x],i=g[y],k=g[z],l=0===b.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(f[z]);if(l&&(g[x]="absolute",g[y]=u,g[z]=v),c=f&&f[a],l&&(g[x]=h,g[y]=i,g[z]=k),""===c){for(d=b.parentElement,e=j.body;d&&d!==e;)d=d.parentElement;d!==e&&(c=g[a])}return c}}});function K(a,b){var c,d;for(Array.call(this),"string"==typeof a?c=(b||j).querySelectorAll(a):a&&(c=e.Ca(a)||a instanceof HTMLCollection?a:[a]),d=0;c&&d<c.length;d++)this.push(c[d])}H=function(a,b){return a instanceof K?a:new K(a,b)},b.GC$=H,I={get:function(a){return this[a]},getAll:function(){return this},bind:function(a,b,c){var d=this;return Z(c)&&(c=b,b=g),d.forEach(function(d){var e,f,h,i,j,m,n=T(d,l,g,!0);n||(n={},T(d,l,n,!0)),e=a.split("."),f=e[0],h=e[1]||k,i=n[h],i||(i=n[h]={}),j=function(a){Z(b)||(a.data=b);var e=c.apply(d,arguments);a.result=e,e===!1&&(a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1))},j.original=c,m=i[f],m||(m=i[f]=[]),m.push(j),d.addEventListener(f,j)}),d},unbind:function(a,b){var c=this;return c.forEach(function(c){var d,e,h,i,j=a.split("."),m=j[0],n=j[1]||k,o=T(c,l,g,!0),p=o&&o[n];if(b){if(p&&m&&(d=p[m]))for(h=d.length,e=0;e<h;e++)if(d[e].original===b){da(c,m,d[e]),d.splice(e,1);break}}else if(p)if(m){if(d=p[m])for(h=d.length,e=0;e<h;e++)da(c,m,d[e]);p[m]=g}else{for(i in p)if(f(p,i)&&(d=p[i]))for(h=d.length,e=0;e<h;e++)da(c,i,d[e]);o[n]=g}}),c},trigger:function(a,b){var c,d,e,h,i,j,k,m,n,o,p,q=this;for(c=0,d=q.length;c<d;c++)if(e=q[c],h=T(e,l,g,!0)){i=a.split("."),j=i[0];for(k in h)if(f(h,k)&&(m=h[k],n=m&&m[j]))for(o=0,p=n.length;o<p;o++)n[o].apply(e,[{type:j},b])}return q},css:function(a,b){var c,d,e,g=this,h=g,i=arguments.length;function j(a,b){h.forEach(function(c){c.style[a]=P(a,b)})}if(1===i){if(!Y(a))return c=g[0],d=G[a],d&&m in d?d.get(c):(e=getComputedStyle(c),e&&e[a]);h.forEach(function(b){for(var c in a)f(a,c)&&(b.style[c]=P(c,a[c]))})}else 2===i&&(Array.isArray(a)&&Array.isArray(b)&&a.length===b.length?a.forEach(function(a,c){j(a,b[c])}):j(a,b));return g},width:$(!0),height:$(),innerWidth:_(!0),innerHeight:_(),outerWidth:aa(!0),outerHeight:aa(),append:function(a){var b,c,d=[a];return a instanceof H&&(d=a.getAll()),b=this,c=b[0],d.forEach(function(a){a&&c.appendChild(a)}),b},appendTo:function(a){var b,c=a;return a instanceof H&&(c=a[0]),b=this,b.forEach(function(a){c.appendChild(a)}),b},prepend:function(a){var b=this,c=b[0];return c.insertBefore(a,c.firstChild),b},insertBefore:function(a){var b=this,c=a.parentElement;return b.forEach(function(b){c.insertBefore(b,a)}),b},addClass:function(a){var b,c,d,e,f,g=0,h=this,i=h.length,j=/\S+/g,k=/[\t\r\n]/g;for(b=(a||"").match(j)||[];g<i;g++)if(c=h[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(k," "):" ")){for(f=0,e=b[f];e;)d.indexOf(" "+e+" ")<0&&(d+=e+" "),f++,e=b[f];c.className=H.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this,i=h.length,j=/\S+/g,k=/[\t\r\n]/g;for(b=(a||"").match(j)||[];g<i;g++)if(c=h[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(k," "):"")){for(f=0,e=b[f];e;){for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");f++,e=b[f]}c.className=a?H.trim(d):""}return this},hasClass:function(a){var b,c=0,d=this,e=d.length,f=/[\t\r\n]/g;for(a=" "+a+" ";c<e;c++)if(b=d[c],1===b.nodeType&&(" "+b.className+" ").replace(f," ").indexOf(a)>=0)return!0;return!1},toggle:function(){var a=this,b=a[0];return b.style[z]===w?a.show():a.hide(),a},show:ba(!0),hide:ba(),attr:function(a,b){var c=this,d=c,e=arguments.length;if(1===e){if(!Y(a))return c[0].getAttribute(a);d.forEach(function(b){for(var c in a)f(a,c)&&b.setAttribute(c,a[c])})}else 2===e&&d.forEach(function(c){c.setAttribute(a,b)});return c},removeAttr:function(a){return this.forEach(function(b){b.removeAttribute(a)}),this},prop:function(a,b){var c=this,d=c,e=arguments.length;if(1===e){if(!Y(a))return Q(c[0],a);d.forEach(function(b){for(var c in a)f(a,c)&&Q(b,c,a[c])})}else 2===e&&d.forEach(function(c){Q(c,a,b)});return c},removeProp:function(a){a=A[a]||a;var b=this,c=b;return c.forEach(function(b){try{b[a]=g,delete b[a]}catch(a){}}),b},text:function(a){var b=this,c=b;return 0===arguments.length?b[0].textContent:(c.forEach(function(b){b.textContent=a}),b)},val:function(a){var b,c,d,e,f=this;{if(arguments.length)return e=H.isFunction(a),f.forEach(function(c,d){var f;1===c.nodeType&&(f=e?a.call(c,d,H(c).val()):a,f===h||f===g?f="":"number"==typeof f?f+="":H.isArray(f)&&(f=H.map(f,function(a){return a===h||a===g?"":a+""})),b=C[c.type]||C[c.nodeName.toLowerCase()],b&&n in b&&!Z(b.set(c,f,"value"))||(c.value=f))}),f;if(c=f[0],d=void 0,c)return b=C[c.type]||C[c.nodeName.toLowerCase()],b&&m in b&&(d=b.get(c,"value"),!Z(d))?d:(d=c.value,X(d)?d.replace(/\r/g,""):d===h||d===g?"":d)}},position:function(){var a,b,c,d,e=this[0];if(e){if(a={top:0,left:0},b={top:0,left:0},"fixed"===H(e).css(x))try{a=e.getBoundingClientRect()}catch(a){}else c=this.offsetParent(),a=this.offset(),d=c[0],O(d,"html")||(b=c.offset(),b.left-=d.scrollLeft,b.top-=d.scrollTop),b.top+=i(H(d).css("borderTopWidth")),b.left+=i(H(d).css("borderLeftWidth"));return{top:a.top-b.top-i(H(e).css("marginTop")),left:a.left-b.left-i(H(e).css("marginLeft"))}}},offsetParent:function(){var a=H.map(this,function(a){for(var b=j.documentElement,c=a.offsetParent||b;c&&!O(c,"html")&&"static"===H(c).css(x);)c=c.offsetParent;return c||b});return H(a)},offset:function(){var a,b,c={top:0,left:0},d=this[0],e=d&&d.ownerDocument;if(e){if(a=e.documentElement,!Z(d.getBoundingClientRect))try{c=d.getBoundingClientRect()}catch(a){}return b=N(e),{top:c.top+(b.pageYOffset||a.scrollTop)-(a.clientTop||0),left:c.left+(b.pageXOffset||a.scrollLeft)-(a.clientLeft||0)}}},scrollLeft:ca(!0),scrollTop:ca(),html:function(a){var b=this,c=b;return 0===arguments.length?b[0].innerHTML:(c.forEach(function(b){b.innerHTML=a}),b)},remove:function(){var a=this;a.forEach(function(a){var b=a.parentElement;b&&(b.removeChild(a),W([a]))})},empty:function(){return this.forEach(function(a){H(a.children).remove()}),this},find:function(a){var b=[];return X(a)&&this.forEach(function(c){var d=c.querySelectorAll(a);H.merge(b,d)}),H(b)},parent:function(){var a=[];return this.forEach(function(b){var c=b.parentElement;c&&a.push(c)}),H(a)},index:function(a){var b=this[0];return a?X(a)?H.inArray(b,H(a).getAll()):H.inArray(a,this):b&&b.parentElement?H.inArray(b,b.parentElement.children):-1},focus:function(){var a=this,b=a[0];return b!==j.activeElement&&b.focus&&b.focus(),a},isVisible:function(){var a=0;return this.forEach(function(b){var c=getComputedStyle(b);c[y]!==u&&c[z]!==w&&a++}),a>0},data:function(a,b){var c=this,d=Z(b);return d&&(c=void 0),H.each(this,function(e,f){var g=T(f,a,b);if(d)return c=g,!1}),c},removeData:function(a){return H.each(this,function(b,c){V(c,a)}),this}},J=K.prototype=[],e.Ia(J,I),H.prototype=J,H.each=e.H,H.isEmptyObject=e.za,H.isFunction=e.Aa,H.isArray=e.Ca,H.isNumeric=e.Da,H.getType=e.Ba,H.inArray=e.Ea,H.merge=e.Ga,H.map=e.Ha,H.extend=e.Ia,H.inherit=e.G,H.isPlainObject=e.Ja,H.isArraylike=e.ya,H.isWindow=e.Ka,H.makeArray=e.La,H.trim=function(a){if(a.trim)return a.trim();var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return a===h||a===g?"":(a+"").replace(b,"")},H.Nl=function(a,b,c,d,e){var f=H(j.createElement(a));return b&&c&&f.css(b,c),d&&f.addClass(d),e&&(e instanceof H?e.append(f):H(e).append(f)),f};function L(a){for(var b,c=M(a);a.parentElement;)a=a.parentElement,b=M(a),b>c&&(c=b);return c}b.getHostMaxZIndex=L;function M(a){var b=getComputedStyle(a).zIndex;return"auto"===b||""===b?0:+b}function N(a){return H.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}function O(a,b){var c=a.nodeName;return c&&c.toLowerCase()===b.toLowerCase()}function P(a,b){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(a)>=0&&isFinite(b)?("width height".split(" ").indexOf(a)>=0&&b<0&&(b=0),b+"px"):b}function Q(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g,f&&(b=A[b]||b,e=B[b]),Z(c)?e&&m in e&&(d=e.get(a,b),d!==h)?d:a[b]:e&&n in e&&(d=e.set(a,c,b),!Z(d))?d:(a[b]=c,c)}function R(a){var b,c,d,e=a.nodeType;return(!e||1===e||9===e)&&(b={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},c=a.nodeName,d=c&&b[c.toLowerCase()],!d||d!==!0&&a.getAttribute("classid")===d)}function S(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(a,b){return b.toUpperCase()})}function T(a,b,c,d){if(R(a)){var e,f,i=E,j=X(b),k=a.nodeType,l=k?D:a,m=k?a[i]:a[i]&&i;if(m&&l[m]&&(d||l[m].data)||!j||!Z(c))return m||(k?(a[i]=m=F,F++):m=i),l[m]||(l[m]={},k||(l[m].toJSON=function(){})),(Y(b)||"function"==typeof b)&&(d?l[m]=H.extend(l[m],b):l[m].data=H.extend(l[m].data,b)),e=l[m],d||(e.data||(e.data={}),e=e.data),Z(c)||(e[S(b)]=c),j?(f=e[b],f!==h&&f!==g||(f=e[S(b)])):f=e,f}}function U(a){var b;for(b in a)if(("data"!==b||!H.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function V(a,b,c){if(R(a)){var d,e,f,g=a.nodeType,i=g?D:a,j=g?a[E]:E;if(i[j]){if(b&&(f=c?i[j]:i[j].data)){H.isArray(b)?b=b.concat(H.map(b,S)):b in f?b=[b]:(b=S(b),b=b in f?[b]:b.split(" ")),e=b.length;for(d=0;d<e;d++)delete f[b[d]];if(!(c?U:H.isEmptyObject)(f))return}(c||(delete i[j].data,U(i[j])))&&(g?W([a],!0):i!==i.window?delete i[j]:i[j]=h)}}}function W(a,b){for(var c,d,e,g,i,j,k,l,m,n=0,o=E,p=D,q=a[n];q!==h&&void 0!==q;){if((b||R(q))&&(c=q[o],d=c&&p[c])){if(e=d.events)for(g in e)if(f(e,g)&&(i=e[g]))for(j in i)if(f(i,j)&&(k=i[j]))for(l=0,m=k.length;l<m;l++)da(q,g,k[l]);p[c]&&(delete p[c],delete q[o])}n++,q=a[n]}}function X(a){return"string"==typeof a}function Y(a){return"object"==typeof a}function Z(a){return typeof a==typeof g}function $(a){var b=a;return function(a){var c,d=this,e="border-box"===d.css("box-sizing"),f=b?o:p,g=b?q:s,h=b?r:t;return 0===arguments.length?(c=Math.round(i(d.css(f)))||0,e&&(c-=i(d.css("padding-"+g))+i(d.css("padding-"+h))+i(d.css("border-"+g+"-"+o))+i(d.css("border-"+h+"-"+o))),c):(d.css(f,a),d)}}function _(a){var b=a;return function(){var a=this,c=b?q:s,d=b?r:t;return b?a.width():a.height()+i(a.css("padding-"+c))+i(a.css("padding-"+d))}}function aa(a){var b=a;return function(a){var c=b?q:s,d=b?r:t,e=this,f=b?e.innerWidth():e.innerHeight();return f+=i(e.css("border-"+c+"-"+o))+i(e.css("border-"+d+"-"+o)),a&&(f+=i(e.css("margin-"+c))+i(e.css("margin-"+d))),f}}function ba(a){var b=a;return function(a){return this.forEach(function(c){c.style[z]=b?v:w,a&&a.apply(c)}),this}}function ca(a){var b=a;return function(a){var c="scrollLeft",d="scrollTop",e=b?c:d,f=b?"pageXOffset":"pageYOffset",g=this,h=g[0],i=N(h);return Z(a)?i?f in i?i[f]:j.documentElement[e]:h[e]:(i?i.scrollTo(b?a:H(i)[c](),b?H(i)[d]():a):h[e]=a,g)}}function da(a,b,c){a.removeEventListener(b,c)}},"./dist/core/util/imageLoader.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=d.GC$,f=".gcSheet",g=function(){function a(a){this.bo=0,this.co=0,this.eo={};var b=this;b.do=a}return a.prototype.fo=function(a){var b,c,d,g=this;function h(){g.ho(a,!0)}function i(){g.ho(a,!1)}b=g.eo,c=b[a],c||(d=e(document.createElement("img")),d.bind("load"+f,h),d.bind("error"+f,i),d.bind("abort"+f,i),g.bo++,b[a]={io:!1,jo:d[0],agc:!1},d[0].src=a)},a.prototype.ko=function(a){var b=this.eo[a];return!!b&&b.io},a.prototype.bgc=function(a){var b=this.eo[a];return!!b&&b.agc},a.prototype.lo=function(a){var b=this.eo[a];return b?b.jo:null},a.prototype.ho=function(a,b){var c=this;c.co++,c.eo[a].io=!0,c.eo[a].agc=b,c.mo()&&c.do&&c.do()},a.prototype.mo=function(){return this.co>=this.bo},a.prototype.no=function(){var a,b,c=this.eo;if(c)for(a in c)c[a]&&(b=e(c[a].jo),b.unbind(f));this.do=null},a}(),b.oo=g},"./dist/core/util/tasks.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=100,e=10,f=function(){function a(a,b){this.fn=a,this.args=b}return a.prototype.run=function(){this.fn.apply(null,this.args)},a}(),b.Task=f,g=function(){function a(a,b){var c=this;c.tasks=[],c.nextTaskFunc=a.bind(c),c.isBusyFunc=b.bind(c)}return a.prototype.addTask=function(a,b){this.tasks.splice(0,0,new f(a,b))},a.prototype.pushTask=function(a,b){this.tasks.push(new f(a,b))},a.prototype.runNextTask=function(){var a,b=this,c=b.tasks;if(!b.isTerminated){if(c.length<1)return void(b.endingCallback&&b.endingCallback());if(b.isBusyFunc())return void setTimeout(function(){b.runNextTask()},d);a=b.nextTaskFunc(),a.run(),setTimeout(function(){b.runNextTask()},e)}},a.prototype.start=function(){var a=this;a.runNextTask()},a.prototype.terminate=function(){var a=this;a.tasks=[],a.isTerminated=!0},a}(),b.Tasks=g},"./dist/core/util/theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/common.js"),f=d.Common.j.Fa,g=d.Common.pc,h=g.ec,i=parseInt,j=e.util.Pl,k="Gill Sans MT",l="Franklin Gothic Book",m="Trebuchet MS";function F(a){var b=a;return function(c){return 0===arguments.length?this.po[b]:(this.po[a]=h(c),this)}}n=0,o=1,p=2,q=3,r=4,s=5,t=6,u=7,v=8,w=9,x=10,y=11,z=function(){function a(a,b,c,d,e,f,g,i,j,k,l,m,z){this.background1=F(n),this.background2=F(o),this.textColor1=F(p),this.textColor2=F(q),this.accent1=F(r),this.accent2=F(s),this.accent3=F(t),this.accent4=F(u),this.accent5=F(v),this.accent6=F(w),this.hyperlink=F(x),this.followedHyperlink=F(y),this.Cj=a,this.po=[];for(var A=1;A<13;A++)this.po.push(h(arguments[A]))}return a.prototype.name=function(a){return 0===arguments.length?this.Cj:(this.Cj=a,this)},a.prototype.getColor=function(a){var b,c,d,e,f;if(a&&"string"==typeof a&&(b=a.split(" "),c=void 0,b)){if(d=-1,e=b.length,e>1){if(!b[0])return a;c=b[0].toLowerCase(),"background"===c?d=i(b[1],10)-1:"text"===c?d=i(b[1],10)+1:"accent"===c&&(d=i(b[1],10)+3)}else 1===e&&(c=b[0].toLowerCase(),"hyperlink"===c?d=x:"followedhyperlink"===c&&(d=y));if(d>=0&&d<=11)return e>2?(f=i(b[2],10)/100,g.bc(g.jc(this.po[d],f))):g.bc(this.po[d])}return a},a.prototype.toJSON=function(){var a=this,b=a.po;return{name:a.Cj,background1:b[n],background2:b[o],text1:b[p],text2:b[q],accent1:b[r],accent2:b[s],accent3:b[t],accent4:b[u],accent5:b[v],accent6:b[w],hyperlink:b[x],followedHyperlink:b[y]}},a.prototype.fromJSON=function(a,b){var c,d,e,g,h,i,j,k,l,m,z,A,B,C,D,E,F;function G(a,b){f(b)||(c.po[a]={a:b.a,r:b.r,g:b.g,b:b.b})}a&&(c=this,d="_colorList",e="_name",b?(E=a.name?a.name:a[e],f(E)||(c.Cj=E),F=a.colorList?a.colorList:a[d],g=F[n],h=F[o],i=F[p],j=F[q],k=F[r],l=F[s],m=F[t],z=F[u],A=F[v],B=F[w],C=F[x],D=F[y]):(f(a.name)||(c.Cj=a.name),g=a.background1,h=a.background2,i=a.text1,j=a.text2,k=a.accent1,l=a.accent2,m=a.accent3,z=a.accent4,A=a.accent5,B=a.accent6,C=a.hyperlink,D=a.followedHyperlink),G(n,g),G(o,h),G(p,i),G(q,j),G(r,k),G(s,l),G(t,m),G(u,z),G(v,A),G(w,B),G(x,C),G(y,D))},a.prototype.e4=function(a){var b,c,d,e;if(this.name()!==a.name())return!1;for(b=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"],c=0,d=b.length;c<d;c++)if(e=b[c],!g.Pka(this[e](),a[e]()))return!1;return!0},a}(),b.ColorScheme=z,A=function(){function a(a,b,c,d){this.name=j("name"),this.colors=j("colors"),this.headerFont=j("headerFont"),this.bodyFont=j("bodyFont");var e=this;e.name(a),e.colors(b?b:new z(a)),e.headerFont(c),e.bodyFont(d)}return a.prototype.getColor=function(a){return this.colors().getColor(a)},a.prototype.getFont=function(a){return"Body"===a?this.bodyFont():"Headings"===a?this.headerFont():a},a.prototype.toJSON=function(){var b=this,c=b.name();return a.f4(b)?c:{name:c,themeColor:b.colors()?b.colors().toJSON():void 0,headingFont:b.headerFont(),bodyFont:b.bodyFont()}},a.f4=function(a){var b,c=a.name();return!!E[c]&&(b=E[c],a.bodyFont()===b.bodyFont()&&a.headerFont()===b.headerFont()&&a.colors().e4(b.colors()))},a}(),b.Theme=A,B="#000000",C="#FFFFFF",D=function(){function a(){}return a.Default=new z("Default",C,"#EEECE1",B,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office2007=new z("Office2007",C,"#EEECE1",B,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office=new z("Office",C,"#E7E6E6",B,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),a.Apex=new z("Apex",C,"#C9C2D1",B,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),a.Aspect=new z("Aspect",C,"#E3DED1",B,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),a.Concourse=new z("Concourse",C,"#DEF5FA",B,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),a.Civic=new z("Civic",C,"#C5D1D7",B,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),a.Oriel=new z("Oriel",C,"#FFF39D",B,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),a.Origin=new z("Origin",C,"#DDE9EC",B,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),
a.Paper=new z("Paper",C,"#FEFAC9",B,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),a.Solstice=new z("Solstice",C,"#E7DEC9",B,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),a.Technic=new z("Technic",C,"#D4D2D0",B,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),a.Trek=new z("Trek",C,"#FBEEC9",B,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),a.Urban=new z("Urban",C,"#DEDEDE",B,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),a.Verve=new z("Verve",C,"#D2D2D2",B,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),a.Equity=new z("Equity",C,"#E9E5DC",B,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),a.Flow=new z("Flow",C,"#DBF5F9",B,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),a.Foundry=new z("Foundry",C,"#EAEBDE",B,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),a.Median=new z("Median",C,"#EBDDC3",B,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),a.Metro=new z("Metro",C,"#D6ECFF",B,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),a.Module=new z("Module",C,"#D4D4D6",B,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),a.Opulent=new z("Opulent",C,"#F4E7ED",B,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),a}(),b.ThemeColors=D,E=function(){function a(){}return a.Default=new A("Default",D.Default,"Cambria","Calibri"),a.Office=new A("Office",D.Office,"Calibri Light","Calibri"),a.Office2007=new A("Office2007",D.Office2007,"Cambria","Calibri"),a.Apex=new A("Apex",D.Apex,"Lucida Sans","Book Antiqua"),a.Aspect=new A("Aspect",D.Aspect,"Verdana","Verdana"),a.Concourse=new A("Concourse",D.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),a.Civic=new A("Civic",D.Civic,"Georgia","Georgia"),a.Oriel=new A("Oriel",D.Oriel,"Century Schoolbook","Century Schoolbook"),a.Origin=new A("Origin",D.Origin,"Bookman Old Style",k),a.Paper=new A("Paper",D.Paper,"Constantia","Constantia"),a.Solstice=new A("Solstice",D.Solstice,k,k),a.Technic=new A("Technic",D.Technic,l,"Arial"),a.Trek=new A("Trek",D.Trek,"Franklin Gothic Medium",l),a.Urban=new A("Urban",D.Urban,m,"Georgia"),a.Verve=new A("Verve",D.Verve,"Century Gothic","Century Gothic"),a.Equity=new A("Equity",D.Equity,l,"Perpetua"),a.Flow=new A("Flow",D.Flow,"Calibri","Constantia"),a.Foundry=new A("Foundry",D.Foundry,"Rockwell","Rockwell"),a.Median=new A("Median",D.Median,"Tw Cen MT","Tw Cen MT"),a.Metro=new A("Metro",D.Metro,"Consolas","Corbel"),a.Module=new A("Module",D.Module,"Corbel","Corbel"),a.Opulent=new A("Opulent",D.Opulent,m,m),a}(),b.Themes=E},"./dist/core/workbook/sheettab.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/common.js"),f=c("./dist/core/worksheet/stylehelper.js"),g=c("./dist/core/workbook/sheettabbase.js"),h=c("./dist/core/core.enum.js"),i=d.Common.pc,j=i.ic,k=i.ec,l=null,m="blank",n="nextButton",o=function(a){p(b,a);function b(b){var c,d=a.call(this,b)||this;return d.vJc=4,d.wJc="white",c=d,c.EC=13,c.GC=12,c.HC=0,c.kw=30,c.IC=28,c.JC=28,c.KC=g.NEW_TAB_SIZE_ASIDE,c.LC=0,c._font="10pt Segoe UI",d}return b.prototype.NC=function(){var a=this.OC,b=a&&a.options;return b&&b.tabNavigationVisible?this.IC*(b.useTouchLayout?1.5:1):0},b.prototype.PC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?a.xJc():0},b.prototype.QC=function(){return this.JC},b.prototype.RC=function(){return this.SC?0:this.JC},b.prototype.TC=function(){var a=this,b=a.OC.options.newTabVisible;return b?this.SC?0:this.KC:0},b.prototype.UC=function(){var a,b,c,d=this,e=d.OC.yJc(),f=d.VC(),g=d.WC,h=d.zJc(),i=d.Dr();for(a=h?i.x+i.width-d.AJc()-d.TC()-d.RC():i.y+i.height-d.PC(),b=d.gq,c=e.length;b<c;b++)if(e[b].visible()&&(f+=h?g[b]:d.BJc),f>a){f=a;break}return f},b.prototype.VC=function(){var a=this,b=a.zJc();return b?2*a.NC()+a.QC()+a.XC():a.TC()},b.prototype.XC=function(){var a=this,b=a.OC;return b&&b.options.tabNavigationVisible?a.AJc()/2:0},b.prototype.getResizeBarBounds=function(){var a=this,b=a.Dr();return{x:b.x+b.width-a.AJc(),y:l,width:a.AJc(),height:l}},b.prototype.getNavButtonBounds=function(){var a,b,c,d,e,f,g,h,i,j=this,k=j.zJc();return k?(a=j.AJc()/2,b=l,c=j.NC(),d=l):(g=j.Dr(),h=j.PC(),i=j.NC(),a=g.width/2-i,b=g.height-h,c=i,d=h),e=1,f=3,{x:a,y:b,width:c,height:d,startIndex:e,endIndex:f}},b.prototype.getSheetTabBounds=function(){var a=this,b=a.Dr(),c=a.RC();return{x:a.VC(),y:l,height:l,secondMoreTabWidth:a.RC(),moreTabPos:b.x+b.width-a.AJc()-a.TC()-c}},b.prototype.getPreMoreTabBounds=function(){var a=this;return{x:a.VC()-a.QC(),width:a.QC()}},b.prototype.YC=function(){var a=this,b=a.zJc();return b?a.ZC+a.WC[a.$C]>a._C():a.ZC+2*a.BJc>a._C()},b.prototype._C=function(){var a=this,b=a.zJc();return b?a.Dr().width-a.AJc()-a.TC()-a.RC():a.Dr().height-a.PC()},b.prototype.aD=function(){return 6},b.prototype.Via=function(){return[m,n]},b.prototype.cD=function(){return this.VC()},b.prototype.CJc=function(a,b){var c,d=this;a.save(),a.beginPath(),c=e.Im.Km(0,"gc-tabStripBackground").backgroundColor,d.eD=k(c),a.fillStyle=c,a.fillRect(b.x,b.y,b.width,b.height),a.restore()},b.prototype.DJc=function(a,b){var c,d,f,g,i=this,j=i.OC,k=j&&j.options.tabStripPosition,l=e.Im.Km(0,"gc-tabStripBackground").borderTopColor;a.save(),a.beginPath(),a.strokeStyle=l,k===h.TabStripPosition.bottom?(c=b.x,d=b.y,f=b.x+b.width,g=b.y+.5):k===h.TabStripPosition.top?(c=b.x,d=b.height-.5,f=b.x+b.width,g=b.y+b.height-.5):k===h.TabStripPosition.left?(c=b.x+b.width-.5,d=b.y,f=b.x+b.width-.5,g=b.y+b.height):k===h.TabStripPosition.right&&(c=b.x+.5,d=b.y,f=b.x+.5,g=b.y+b.height),a.moveTo(c,d),a.lineTo(f,g),a.stroke(),a.restore()},b.prototype.dD=function(a,b){var c=this;c.CJc(a,b),c.DJc(a,b)},b.prototype.fD=function(a,b,c){var d,e,f,g,h=this,i=h.OC.options,j=i.newTabVisible,k=h.zJc(),l=h.VC(),m=h.IC,n=c,o=0,p=m;k?(e=h.RC(),n+=e,f=b.x+b.width-h.AJc()-h.TC(),n>f&&(n=f,g=f-e,g<l&&(g=l,n=g+m),h.gD(a,g,0,e,b.height)),d=b.height):(n=(b.width-l)/2,d=l,p=d),j&&h.hD(a,n,o,p,d,h.iD===-2)},b.prototype.jD=function(a,b,c,d){var e=this.QC();this.gD(a,d-e,0,e,b.height)},b.prototype.kD=function(a,b){var c,d,e=this,f=e.zJc(),h=e.EJc,i=e.NC(),j=e.PC(),k=e.lD;f?(c=e.AJc()/2+i/2,d=j/2,e.mD(a,c,d,c+h,d+h,c+h,d-h,g.NavButtonDirection.left,l,1===k),c+=i,e.mD(a,c,d,c-h,d+h,c-h,d-h,g.NavButtonDirection.right,l,2===k)):(c=(b.width-i)/2,d=b.height-j/2,e.mD(a,c,d,c+h,d+h,c-h,d+h,g.NavButtonDirection.top,l,1===k),c+=i,e.mD(a,c,d,c-h,d+h,c-h,d-h,g.NavButtonDirection.bottom,l,2===k))},b.prototype.nD=function(a,b){var c,d,f=this,g=f.AJc(),h=e.Im.Km(0,"gc-tabStripResizeBarInner");f.OC.options.showHorizontalScrollbar&&(a.beginPath(),a.rect(b.x+b.width-g,0,g,b.height),a.clip(),c=b.x+b.width-g/2,d=b.y+b.height/2,a.fillStyle=h.color,a.fillRect(c,d,2,2),a.fillRect(c,d-4,2,2),a.fillRect(c,d+4,2,2))},b.prototype.FJc=function(a,b,c,d,e,f,g,i){var j=this,k=j.OC,l=k.options.tabStripPosition,m=j.GJc,n=j.wJc,o=j.vJc,p=j.HJc,q=j.zJc();a.save(),i&&g&&(a.fillStyle=n,l===h.TabStripPosition.bottom?a.fillRect(b,c,d,e-o):l===h.TabStripPosition.top?a.fillRect(b,c+o,d,e):l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e):a.fillRect(b,c,d-m,e)),g?(a.fillStyle=n,l===h.TabStripPosition.bottom?a.fillRect(b,c+1,d,e-o):l===h.TabStripPosition.top?a.fillRect(b,c+o-1,d,e):i?l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e+1):a.fillRect(b,c,d-m,e+1):a.fillRect(b+m,c,d-2*m,e+1)):i&&(a.fillStyle=n,l===h.TabStripPosition.bottom?a.fillRect(b,c,d,1):l===h.TabStripPosition.top?a.fillRect(b,c+e,d,1):l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e+1):a.fillRect(b,c,d-m,e+1)),a.fillStyle=f,q?a.fillRect(b+p,c+p,d-2*p+1,e-2*p):i?l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e+1):a.fillRect(b,c,d-m,e+1):a.fillRect(b+m,c,d-2*m,e+1),a.restore()},b.prototype.IJc=function(a,b,c,d,e,f,g){var i=this,j=i.OC,k=j.options.tabStripPosition,l=i.vJc,m=i.GJc,n=i.zJc();a.save(),n?(a.beginPath(),a.lineWidth=1,a.strokeStyle=f&&f.borderLeftColor,g?k===h.TabStripPosition.bottom?(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e-l),a.moveTo(b+d+.5,c),a.lineTo(b+d+.5,c+e-l)):k===h.TabStripPosition.top&&(a.moveTo(b+.5,c+l),a.lineTo(b+.5,c+e),a.moveTo(b+d+.5,c+l),a.lineTo(b+d+.5,c+e)):(a.moveTo(b+.5,c+l),a.lineTo(b+.5,c+e-l),a.moveTo(b+d+.5,c+l),a.lineTo(b+d+.5,c+e-l))):(a.beginPath(),a.lineWidth=1,a.strokeStyle=f&&f.borderLeftColor,g?k===h.TabStripPosition.left?(a.moveTo(b+m,c+.5),a.lineTo(b+m+d,c+.5),a.moveTo(b+m,c+e+.5),a.lineTo(b+m+d,c+e+.5)):(a.moveTo(b,c+.5),a.lineTo(b+d-m,c+.5),a.moveTo(b,c+e+.5),a.lineTo(b+d-m,c+e+.5)):(a.moveTo(b+m,c+.5),a.lineTo(b-m+d,c+.5),a.moveTo(b+m,c+e+.5),a.lineTo(b-m+d,c+e+.5))),a.stroke(),a.restore()},b.prototype.JJc=function(a,b,c,d,e,f,g){var i=this,j=i.OC,k=j.options.tabStripPosition,l=i.vJc,m=i.GJc;g&&(a.save(),a.beginPath(),a.strokeStyle=f&&f.borderBottomColor,a.lineWidth=2,k===h.TabStripPosition.bottom?(a.moveTo(b,c+e-l),a.lineTo(b+d+1,c+e-l)):k===h.TabStripPosition.top?(a.moveTo(b,c+l),a.lineTo(b+d+1,c+l)):k===h.TabStripPosition.left?(a.moveTo(b+m,c),a.lineTo(b+m,c+e+1)):(a.moveTo(d-m,c),a.lineTo(d-m,c+e+1)),a.stroke(),a.restore())},b.prototype.KJc=function(a,b,c,d,e,g,j,k,l,m,n){var o,p,q,r,s,t,u,v=this,w=v.OC.options.tabStripPosition,x=v.GJc,y=v.HJc,z=v.LJc,A=v.OC.MJc(g),B=A&&A.options,C=B&&B.sheetTabColor;a.save(),a.textBaseline="top","string"==typeof k&&(o=k),p=v.qD(j,o),a.fillStyle=p,(n||m||l)&&(a.font=f.To.Ro(a.font,"bold")),q=v.EC,a.textBaseline="middle",w===h.TabStripPosition.bottom?a.fillText(g,b+q,c+e/2-1):w===h.TabStripPosition.top?a.fillText(g,b+q,c+e/2+1):(a.beginPath(),r=b+d-2*x-2*y-2-1,a.rect(b+x,c+.5,r+y,e+.5),a.clip(),a.fillText(g,b+x+y,c+e/2+2),s=a.measureText(z).width,t=a.measureText(g).width,t-s>r&&(a.beginPath(),u=void 0,u=C?k:m||l?v.wJc:i.bc(v.eD),a.fillStyle=u,a.fillRect(b+x+y+r-s,c+1.5,r,e-1.5),a.fillStyle=p,a.fillText(z,b+x+y+r-s,c+e/2+2))),a.restore()},b.prototype.oD=function(a,b,c,d,f,g,i,j,k,l){var m,n,o,p=this,q=h.VisualState.normal;j&&(q=h.VisualState.hover),l&&(q=h.VisualState.selected),i&&(q=h.VisualState.active),i&&!l&&(q=h.VisualState.activeNotSelected),m=e.Im.Km(q,"gc-tab-"+e.Im.Jm(q)),n=e.Im.Km(0,"gc-tab-"+e.Im.Jm(0)),o=p.pD(a,i,k,n,c),p.FJc(a,b,c,d,f,o,l,i),p.IJc(a,b,c,d,f,n,i),p.JJc(a,b,c,d,f,m,l),p.KJc(a,b,c,d,f,k,m,o,l,i,j)},b.prototype.mD=function(a,b,c,d,f,i,j,k,l,m){var n,o,p,q,r,s,t;a.save(),n=this,o=k===g.NavButtonDirection.left||k===g.NavButtonDirection.top,p=h.VisualState.highlight,m&&(p=h.VisualState.hover),o?(k===g.NavButtonDirection.left?(b-=2,d-=2):(c-=2,f-=2),q=n.rw(n.gq),q===-1&&(p=h.VisualState.normal)):(k===g.NavButtonDirection.right?(b+=2,d+=2):(c+=2,f+=2),r=n.rD(n.sD()),r===-1&&(p=h.VisualState.normal)),s=e.Im.Km(p,"gc-navButton-"+e.Im.Jm(p)),a.strokeStyle=this.tD(s.borderTopColor),a.beginPath(),t=o?1:-1,k===g.NavButtonDirection.left||k===g.NavButtonDirection.right?(a.moveTo(b-.5,c),a.lineTo(b-.5,c+1),a.moveTo(b+t-.5,c-1),a.lineTo(b+t-.5,c+2),a.moveTo(b+2*t-.5,c-2),a.lineTo(b+2*t-.5,c+3),a.moveTo(b+3*t-.5,c-3),a.lineTo(b+3*t-.5,c+4)):k!==g.NavButtonDirection.top&&k!==g.NavButtonDirection.bottom||(a.moveTo(b,c-.5),a.lineTo(b+1,c-.5),a.moveTo(b-1,c+t-.5),a.lineTo(b+2,c+t-.5),a.moveTo(b-2,c+2*t-.5),a.lineTo(b+3,c+2*t-.5),a.moveTo(b-3,c+3*t-.5),a.lineTo(b+4,c+3*t-.5)),a.stroke(),a.restore()},b.prototype.hD=function(a,b,c,d,f,g){var i,j,k,l=this;a.save(),a.beginPath(),i=(f-2*l.NJc)/2,j=h.VisualState.highlight,g&&(j=h.VisualState.hover),k=e.Im.Km(j,"gc-tabStripNewTab-"+e.Im.Jm(j)),a.lineWidth=1.5,a.strokeStyle=l.tD(k.borderTopColor),a.arc(b+d/2,c+f/2,i,0,2*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=2,a.moveTo(b+d/2-4,c+f/2),a.lineTo(b+d/2+4,c+f/2),a.moveTo(b+d/2,c+f/2-4),a.lineTo(b+d/2,c+f/2+4),a.stroke(),a.restore()},b.prototype.gD=function(a,b,c,d,f){var g,i,j;a.save(),a.beginPath(),g=h.VisualState.highlight,i=this.lD,5!==i&&6!==i||(g=h.VisualState.hover),j=e.Im.Km(g,"gc-navMoreButton-"+e.Im.Jm(g)),a.fillStyle=this.tD(j.borderTopColor),a.fillRect(b+d/2,c+f/2,2,2),a.fillRect(b+d/2-4,c+f/2,2,2),a.fillRect(b+d/2+4,c+f/2,2,2),a.restore()},b.prototype.tD=function(a){var b=k(a),c=this.eD;return b.a<=.01?j(c):i.hc(c,b)?j(b):a},b}(g.DC),b.iv=o},"./dist/core/workbook/sheettab2007.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/common.js"),g=c("./dist/core/workbook/sheettabbase.js"),h=c("./dist/core/worksheet/stylehelper.js"),i=c("./dist/core/core.enum.js"),j=f.Ul.wl,k=null,l=Math.min,m=Math.max,n="#92A5C7",o="newSheet",p="linear-gradient",q=new e.Common.ResourceManager(d.SR),r=q.getResource.bind(q),s=function(a){t(b,a);function b(b){var c=a.call(this,b)||this,d=c;return d.EC=12,d.GC=8,d.HC=3,d.kw=12,d.KC=48,d.LC=5,d._font="10pt Arial",c}return b.prototype.NC=function(){var a=this.OC,b=a&&a.options,c=0;return c=b&&b.tabNavigationVisible?a.Wv()*(b.useTouchLayout?2:1):0},b.prototype.PC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?a.Wv():0},b.prototype.VC=function(){var a=this,b=a.zJc();return b?4*a.NC()+a.lE():a.TC()},b.prototype.lE=function(){var a=this,b=a.OC;return b&&b.options.tabNavigationVisible?2:0},b.prototype.getResizeBarBounds=function(){var a=this,b=a.Dr();return{x:b.x+b.width-a.AJc(),y:k,width:a.AJc(),height:k}},b.prototype.getNavButtonBounds=function(){var a,b,c,d,e,f,g,h,i,j=this,l=j.zJc();return l?(a=0,b=k,c=j.NC(),d=k):(g=j.Dr(),h=j.PC(),i=j.NC(),a=g.width/2-2*i,b=g.height-h,c=i,d=h),e=0,f=4,{x:a,y:b,width:c,height:d,startIndex:e,endIndex:f}},b.prototype.getSheetTabBounds=function(){var a=this;return{x:a.VC(),y:k,height:k,secondMoreTabWidth:0,moreTabPos:0}},b.prototype.getPreMoreTabBounds=function(){var a=this;return{x:a.VC(),width:a.HC+a.LC}},b.prototype.YC=function(){var a=this,b=a.zJc();return b?a.ZC+a.WC[a.$C]+a.TC()>a._C():a.ZC+2*a.BJc>a._C()},b.prototype._C=function(){var a=this,b=a.zJc();return b?a.Dr().width-a.AJc():a.Dr().height-a.PC()},b.prototype.aD=function(){var a=this.zJc();return a?1:4},b.prototype.Via=function(){return[o]},b.prototype.cD=function(){var a=this,b=a.zJc(),c=a.VC();return b&&(c+=a.Dr().height,a.OC.options.newTabVisible&&(c+=a.TC(),c+=a.HC)),c},b.prototype.dD=function(a,b){var c,d,e,g,h,i,k,l;if(a.save(),a.beginPath(),c=a.createLinearGradient(b.x,b.y,b.width,b.height),d=f.Im.Km(0,"gc-tabStripBackground"),e=d&&d.backgroundImage,g=d&&d.backgroundColor,e&&e.indexOf(p)!==-1)for(h=j(e),i=0,k=h.length;i<k;i++)l=h[i],c.addColorStop(l.point,l.color);else g&&(c.addColorStop(0,"#DDDDDD"),c.addColorStop(1,g));a.fillStyle=c,a.fillRect(b.x,b.y,b.width,b.height),a.restore()},b.prototype.fD=function(a,b,c){var d,e,f,h,i,j,k=this,l=k.OC,m=r().NewTab,n=k.zJc(),o=l.options.newTabVisible;o&&(d=void 0,e=0,f=void 0,h=void 0,i=k.iD===-2,n?(k.KC=a.measureText(m).width+k.EC,d=c,f=k.TC(),h=b.height,k.oD(a,d,e,f,h,void 0,!1,i,m,!1)):(j=g.NEW_TAB_SIZE_ASIDE,k.KC=j,d=(b.width-j)/2,f=j,h=j,k.OJc(a,d,e,f,h,i)))},b.prototype.OJc=function(a,b,c,d,e,g){var h,k,l,m,n,o,q,r,s,t=this;if(a.save(),a.beginPath(),h=(e-2*t.NJc)/2,k=i.VisualState.normal,g&&(k=i.VisualState.hover),l=f.Im.Km(k,"gc-tab-"+f.Im.Jm(k)),m=g?l.backgroundColor:l.backgroundImage,m&&m.indexOf(p)!==-1)for(n=a.createLinearGradient(b+.7*e,c+0,.7*e,e),o=j(m),q=0,r=o.length;q<r;q++)s=o[q],n.addColorStop(s.point,s.color);else n=m;a.lineWidth=1.5,a.strokeStyle=n,a.arc(b+d/2,c+e/2,h,0,2*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=2,a.moveTo(b+d/2-4,c+e/2),a.lineTo(b+d/2+4,c+e/2),a.moveTo(b+d/2,c+e/2-4),a.lineTo(b+d/2,c+e/2+4),a.stroke(),a.restore()},b.prototype.jD=function(a,b,c,d){var e=this,f=c-1,g=e.WC[f];e.oD(a,d+e.LC-g-e.HC,0,g,b.height,f,e.$C===f,e.iD===f,"",!1)},b.prototype.kD=function(a,b){var c,d,e=this,f=e.zJc(),h=e.VC(),i=e.EJc,j=e.NC(),l=e.PC(),m=e.lD;a.fillStyle=n,f?a.fillRect(b.x,b.y,h-1,b.height):a.fillRect(b.x,b.height-l,b.width,l),f?(c=j/2,d=l/2,e.mD(a,c,d,c+i,d+i,c+i,d-i,g.NavButtonDirection.left,c-i,0===m),c+=j,e.mD(a,c,d,c+i,d+i,c+i,d-i,g.NavButtonDirection.left,k,1===m),c+=j,e.mD(a,c,d,c-i,d+i,c-i,d-i,g.NavButtonDirection.right,k,2===m),c+=j,e.mD(a,c,d,c-i,d+i,c-i,d-i,g.NavButtonDirection.right,c+4,3===m)):(c=b.width/2-1.5*j,d=b.height-l/2,e.mD(a,c,d,c+i,d+i,c-i,d+i,g.NavButtonDirection.top,d-i,0===m),c+=j,e.mD(a,c,d,c+i,d+i,c-i,d+i,g.NavButtonDirection.top,k,1===m),c+=j,e.mD(a,c,d,c+i,d-i,c-i,d-i,g.NavButtonDirection.bottom,k,2===m),c+=j,e.mD(a,c,d,c+i,d-i,c-i,d-i,g.NavButtonDirection.bottom,d+i,3===m))},b.prototype.nD=function(a,b){var c,d=this,e=d.OC,g=d.AJc(),h=f.Im.Km,i=h(4,"gc-tabStripResizeBarInner"),j=h(0,"gc-tabStripResizeBarOuter");e.options.showHorizontalScrollbar&&(c=b.x+b.width-g,a.fillStyle=j.backgroundColor,a.fillRect(c,b.y,g,b.height),a.fillStyle=i.backgroundColor,a.fillRect(c+1,b.y+1,g-2,b.height-2),a.fillStyle=i.color,a.fillRect(c+g/2-1,b.y+4,2,b.height-8))},b.prototype.oD=function(a,b,c,d,e,g,h,j,k,l){var m,n=this,o=n.zJc(),p=i.VisualState.normal;(j||l)&&(p=i.VisualState.hover),m=f.Im.Km(p,"gc-tab-"+f.Im.Jm(p)),o?n.PJc(a,b,c,d,e,k,m,l,h,j):n.QJc(a,b,c,d,e,g,k,m,l,h,j)},b.prototype.PJc=function(a,b,c,d,e,f,g,j,k,l){var m,o,p,q=this,r=q.OC.options.tabStripPosition,s=q.RJc;a.save(),a.beginPath(),r===i.TabStripPosition.bottom?(a.moveTo(b,c),a.lineTo(b,c+e-s),a.arcTo(b,c+e,b+d,c+e,s),a.lineTo(b+d,c+e),a.lineTo(b+d+e,c),k||a.lineTo(b,c)):(a.moveTo(b,c+e),a.lineTo(b,c-s),a.arcTo(b,c,b+d,c,s),a.lineTo(b+d,c),a.lineTo(b+d+e,c+e),k||a.lineTo(b,c+e)),m=q.pD(a,j||l,f,g),a.fillStyle=m,a.fill(),a.strokeStyle=n,a.stroke(),a.textBaseline="top","string"==typeof m&&(o=m),a.fillStyle=q.qD(g,o),k&&(a.font=h.To.Ro(a.font,"bold")),p=q.EC,a.textBaseline="middle",a.fillText(f,b+p,c+e/2),a.restore()},b.prototype.QJc=function(a,b,c,d,e,f,g,j,k,l,m){var o,p,q,r,s,t,u=this,v=u.OC.options.tabStripPosition,w=u.OC.sheets,x=f===w.length-1,y=u.RJc,z=u.GJc,A=u.EJc,B=u.HJc,C=u.LJc;a.save(),a.beginPath(),v===i.TabStripPosition.left?(b+=z,d-=z,a.moveTo(b+d,c),a.lineTo(b+y,c),a.arcTo(b,c,b,c+y,y),a.lineTo(b,c+e-y),a.arcTo(b,c+e,b+y,c+e,y),x?a.lineTo(b+d,c+e):(a.lineTo(b+d-A,c+e),a.lineTo(b+d,c+e+A)),l||a.lineTo(b+d,c)):(d-=z,a.moveTo(b,c),a.lineTo(b+d-y,c),a.arcTo(b+d,c,b+d,c+y,y),a.lineTo(b+d,c+e-y),a.arcTo(b+d,c+e,b+d-y,c+e,y),x?a.lineTo(b,c+e):(a.lineTo(b+A,c+e),a.lineTo(b,c+e+A)),l||a.lineTo(b,c)),o=u.pD(a,k||m,g,j,c),a.fillStyle=o,a.fill(),a.strokeStyle=n,a.stroke(),a.textBaseline="top","string"==typeof o&&(p=o),q=u.qD(j,p),a.fillStyle=q,l&&(a.font=h.To.Ro(a.font,"bold")),a.textBaseline="middle",a.beginPath(),r=d-2*z,a.rect(b,c,r,e),a.clip(),a.fillText(g,b+z+B,c+e/2+2),s=a.measureText(C).width,t=a.measureText(g).width,t-s>r&&(a.beginPath(),a.fillStyle=o,a.fillRect(b+r-s,c+1.5,r,e-2.5),a.fillStyle=q,a.fillText(C,b+r-s,c+e/2+2)),a.restore()},b.prototype.mD=function(a,b,c,d,e,h,i,n,o,q){var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;if(a.save(),r=this,s=r.zJc(),t=n===g.NavButtonDirection.left||n===g.NavButtonDirection.top,u=r.Dr(),v=r.NC(),w=f.Im.Km,x=w(4,"gc-navButton-hover"),y=w(0,"gc-navButton-normal"),z=y&&y.backgroundColor,A=y&&y.backgroundImage,A&&A.indexOf(p)!==-1)for(B=a.createLinearGradient(u.x+.7*u.height,u.y+0,.7*u.height,u.height),C=j(A),D=0,E=C.length;D<E;D++)F=C[D],B.addColorStop(F.point,F.color);s&&(q?(a.fillStyle=x.backgroundColor,a.fillRect(b-v/2+2,u.y+2,v-4,u.height-4)):(B?a.fillStyle=B:z&&(a.fillStyle=z),a.fillRect(b-v/2,u.y+1,v,u.height-2))),s?q?a.fillStyle=x.color:a.fillStyle=y.color:q?a.fillStyle=z:a.fillStyle=B?B:z,void 0!==o&&o!==k&&(n===g.NavButtonDirection.left||n===g.NavButtonDirection.right?a.fillRect(o,l(e,i),1,m(e,i)-l(e,i)):a.fillRect(l(d,h),o,m(d,h)-l(d,h),1)),t?n===g.NavButtonDirection.left?(b-=2,d-=2,h-=2):(c-=2,e-=2,i-=2):n===g.NavButtonDirection.right?(b+=2,d+=2,h+=2):(c+=2,e+=2,i+=2),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.lineTo(h,i),a.lineTo(b,c),a.fill(),a.restore()},b}(g.DC),b.jv=s},"./dist/core/workbook/sheettabbase.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/worksheet/stylehelper.js"),i=c("./dist/core/core.enum.js"),j=e.Common.pc,k=g.Ul.wl,l=g.Ul.bq,m=e.Common.j.Fa,n=g.Ul.Nl,o=g.Ul.fp,p=g.Ul.lZa,q=parseInt,r=window,s=document,t=null,u=Math.max,v=Math.min,w=Math.pow,x=Math.round,y="px",z="none",A=".gcTab",B="mousedown"+A,C="mousemove"+A,D="mouseup"+A,E="mouseout"+A,F="dblclick"+A,G="mousewheel"+A,H=".spliter",I="mousemove"+H,J="mouseup"+H,K=".tabNameEditor",L="keydown"+K,M="focus"+K,N="blur"+K,O="canvas",P="2d",Q="resize",R="navButton",S="tab",T="newSheet",U="blank",V="black",W="white",X=7,Y=10,Z="navButton",$="sheetTab",b.NEW_TAB_SIZE_ASIDE=28,_=new e.Common.ResourceManager(d.SR),aa=_.getResource.bind(_);function da(a,b,c){a.Wq(g.Events.SheetTabClick,{sheet:b,sheetName:b?b.name():t,sheetTabIndex:m(c)?-1:c})}function ea(a,b){a.Wq(g.Events.SheetMoving,b)}function fa(a,b,c,d){a.Wq(g.Events.SheetMoved,{sheet:b,sheetName:b?b.name():t,oldIndex:c,newIndex:d})}function ga(a,b,c,d){var e;if(b>c)for(e=c;e<b;e++)a-=d[e];else if(b<c)for(e=b;e<c;e++)a+=d[e];return a}function ha(a,b,c,d,e){return(c<d&&a>d||c>=d&&a<d)&&(b=ga(b,a,d,e),a=d),{index:a,position:b}}!function(a){a[a.left=0]="left",a[a.right=1]="right",a[a.top=2]="top",a[a.bottom=3]="bottom"}(ba=b.NavButtonDirection||(b.NavButtonDirection={})),ca=function(){function a(a){this.Cj=a,this.SC=!1,this.LC=0,this.HC=0,this.GJc=6,this.SJc=3,this.RJc=5,this.EJc=5,this.HJc=3,this.NJc=7,this.LJc="...",this.buffer=null;var b=this;b.OC=t,b.$C=0,b.gq=0,b.ZC=70,b.lD=-1,b.iD=-1,b._font="",b.WC=[],b.BJc=0,b.uD=-1,b.vD=-1,b.wD=t,b.xD=0,b.Us(new g.Rect(0,0,200,28))}return a.prototype.getNewTabBounds=function(){var a,b,c,d,e=this,f=e.OC.options.useTouchLayout,g=e.Dr(),h=e.TC(),i=(h-2*e.NJc)/2;return f?(a=g.x,b=g.y,c=g.width,d=h):(a=(g.x+g.width-2*i)/2,b=(g.y+h-2*i)/2,c=2*i,d=2*i),{x:a,y:b,width:c,height:d}},a.prototype.getCanvas=function(){return this.Xs},a.prototype.zJc=function(){var a=this,b=a.OC.options.tabStripPosition;return b===i.TabStripPosition.bottom||b===i.TabStripPosition.top},a.prototype.ws=function(b){var c,d,e;b&&(c=this,d=c.Xs,d&&c.no(!0),e=n(O),g.En.Kn(e,c.OC),e.setAttribute("id",c.Cj),c.yD=c.zD(),c.TJc(),b.appendChild(c.yD[0]),b.appendChild(e),c.Xs=e,f.GC$(e).bind(B,function(a){return c.AD(a)}).bind(C,function(a){return c.BD(a)}).bind(D,function(a){return c.CD(a)}).bind(E,function(a){return c.DD(a)}).bind(F,function(a){return c.ED(a)}).bind(G,function(a){return c.Rw(a)}),c.fq(),a.ao(c,"setHost"))},a.prototype.Yv=function(a){var b,c=this;c.OC=a,a&&(b=a.options.font,b&&b.length>0&&(c._font=b),c.TJc())},a.prototype.RIc=function(a){var b=this.OC;b.suspendPaint(),this.SIc(a),b.resumePaint()},a.prototype.SIc=function(a){var b,c,d,e,f=this,g=f.OC,h=f.zJc(),i=f.BJc,j=f._C(),k=0,l=f.WC,m=f.cD(),n=f.sD(),o=f.TIc().tabsInfo;if(o[0].index>a)return void g.startSheetIndex(a);for(b=a-1;b>=0;b--)if(a=n[b],d=h?l[a]:i,k+=d,b!==n.length-1&&(k+=h?f.HC:0),e=m+k,0!==b&&(e+=h?f.LC:i),e>j){b=h?b+1:b,c=b;break}c&&g.startSheetIndex(c)},a.prototype.Dr=function(){var a=this.Zs;return new g.Rect(a.x,a.y,a.width,a.height)},a.prototype.Us=function(a){var b=this.Zs=new g.Rect(0,0,0,0);b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height},a.prototype.TC=function(){var a=this,b=a.OC.options.newTabVisible;return b?this.KC:0},a.prototype.UC=function(){var a=this,b=a.Dr(),c=a.zJc();return c?b.x+b.width-a.AJc():b.y+b.height-a.PC()},a.prototype.VC=function(){return 0},a.prototype.AJc=function(){var a=this,b=i.TabStripPosition.bottom,c=a.OC;return c&&(b=c.options.tabStripPosition),b===i.TabStripPosition.bottom?a.kw:0},a.prototype.fq=function(){var a,b,c,d,e=this,h=e.Ws();h&&h.parentNode&&(a=f.GC$(h.parentNode),0!==a.width()&&0!==a.height()&&(b=u(a.width(),0),c=u(a.height(),0),h.style.display=z,h.width=b,h.height=c,h.style.display="",h.style.width=b+y,h.style.height=c+y,b=h.clientWidth||h.width,c=h.clientHeight||h.height,d=e.Dr(),e.Us(new g.Rect(d.x,d.y,b,c)),g.En.Pn(h,b,c),e.repaint()))},a.prototype.YC=function(){return!1},a.prototype.PC=function(){return 0},a.prototype._C=function(){return 0},a.prototype.aD=function(){return 0},a.prototype.Via=function(){return[]},a.prototype.cD=function(){return 0},a.prototype.zD=function(){return this.yD?this.yD:f.GC$(n("div"))},a.prototype.TJc=function(){var a,b,c,d=this,e=d.yD;e&&(a=d.OC,b=a?a.options.tabStripPosition:i.TabStripPosition.bottom,c=void 0,b===i.TabStripPosition.bottom?c="gc-tab-indicator-bottom":b===i.TabStripPosition.top?c="gc-tab-indicator-top":b===i.TabStripPosition.left?c="gc-tab-indicator-left":b===i.TabStripPosition.right&&(c="gc-tab-indicator-right"),e.removeClass(),e.addClass(c))},a.prototype.no=function(b){var c,d=this,e=d.Xs;e&&(c=e.parentNode,f.GC$(e).unbind(B).unbind(C).unbind(D).unbind(F).unbind(E),c&&c.removeChild(e)),f.GC$(d.yD).remove(),a.ao(d,"dispose"),b||(d.OC=t)},a.prototype.UJc=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t=this,u=t.OC,v=u.options.scrollbarAppearance===i.ScrollbarAppearance.mobile,w=u.options.showHorizontalScrollbar,x=t.Dr();if(w&&!v&&(c=t.getResizeBarBounds(),u.options.showHorizontalScrollbar&&!v&&a>c.x&&a<x.x+x.width))return{type:"resize",element:Q};for(d=t.getNavButtonBounds(),e=-1,f=d.startIndex,g=d.x,h=d.endIndex,j=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],k=f;k<h;k++){if(g<a&&a<g+d.width){e=k,R=j[k];break}g+=d.width}if(e!==-1)return{type:Z,element:R,index:k};if(l=t.getPreMoreTabBounds(),g=l.x,m=0,n=t.rw(t.gq),n!==-1){if(g<=a&&a<g+l.width)return R=j[5],{type:Z,element:R,index:5,position:g};m=t.LC}if(o=t.getSheetTabBounds(),p=u.yJc(),q=t.WC,r=t.HC,s=0,g=o.x+m,t.gq>-1)for(k=t.gq;k<p.length&&k<q.length;k++)if(p[k].visible()){if(s=q[k],g<a&&a<g+s+r){if(o.moreTabPos>0&&a<o.moreTabPos)return{type:$,element:S,index:k,position:g};if(0===o.moreTabPos)return{type:$,element:S,index:k,position:g}}g+=s+r}if(g>o.moreTabPos&&o.moreTabPos>0&&(g=o.moreTabPos),t.rD(t.sD())!==-1){if(g<a&&a<g+o.secondMoreTabWidth)return R=j[6],{type:Z,element:j[6],index:6,position:g}}else if(g<a&&a<g+o.secondMoreTabWidth)return{element:U,position:g};return g+=o.secondMoreTabWidth,u.options.newTabVisible&&g<a&&a<g+t.TC()?{type:$,element:T,position:g,index:-1}:{element:U}},a.prototype.VJc=function(a,b){var c,d,e,f,g,h,i=this,j=i.OC,k=i.getNavButtonBounds(),l=-1,m=k.x,n=k.y,o=k.startIndex,p=k.endIndex,q=["first","prevArrow","nextArrow","last","","prevButton","nextButton"];for(c=o;c<p;c++){if(m<a&&a<m+k.width&&n<b&&b<n+k.height){l=c,R=q[c];break}m+=k.width}if(l!==-1)return{type:Z,element:R,index:c};if(d=i.TC(),n=d,e=j.yJc(),f=i.WC,g=i.BJc,i.gq>-1)for(c=i.gq;c<e.length&&c<f.length;c++)if(e[c].visible()){if(n<b&&b<n+g)return{type:$,element:S,index:c,position:n};n+=g}return h=i.getNewTabBounds(),j.options.newTabVisible&&h.x<a&&a<h.x+h.width&&h.y<b&&b<h.y+h.height?{type:$,element:T,position:n,index:-1}:n<b&&b<n+k.y?i.rD(i.sD())!==-1?(R=q[6],{type:Z,element:q[6],index:6,position:n}):{element:U,position:n}:{element:U}},a.prototype.hitTest=function(a,b){var c,d=this,e=d.zJc();return c=e?d.UJc(a,b):d.VJc(a,b)},a.prototype.AD=function(b){var c,d,e,g,h,i,j,k=this,l={e:b,r:t};return a.ao(k,"preProcessMouseDown",l),c=l.r,m(c)?(d=f.GC$(k.Ws()).offset(),e=b.pageX-d.left,g=b.pageY-d.top,h=k.OC.WJc(),k.FD&&k.GD(h,!1),i=k.hitTest(e,g),j=i.element,0===b.button&&(j===Q?(k.HD=!0,k.ID=b.pageX,k.tC()):j===R?k.JD(i.index):j===S?(k.KD(i.index,i.position,b),k.LD(b,i)):j===T&&k.MD(i.position),h=k.OC.WJc(),h&&!h.isEditing()&&h.zt()),k.ND=!0,!1):c},a.prototype.BD=function(b){var c,d,e,g,h,i,j,k,l,n,o,p,q,r,s,u=this,v=u.OC,x={e:b,r:t};if(a.ao(u,"preProcessMouseMove",x),c=x.r,!m(c))return c;if(d=u.Xs.style,e="default",g="w-resize",u.OD&&!u.PD&&(h=Math.sqrt(w(u.OD.x-b.pageX,2)+w(u.OD.y-b.pageY,2)),h>Y&&(u.PD=!0)),u.HD)d.cursor=g,i=b.pageX-u.ID,j=u.OC.xs.clientWidth,v.options.tabStripRatio=v.Iv()+i/j,k=u.AJc()/j,l=1,v.Iv()<k?(v.options.tabStripRatio=k,u.ID=u.AJc()):v.Iv()>=l?(v.options.tabStripRatio=l,u.ID=j):u.ID=b.pageX,v.aq();else if(u.PD)u.QD(b.pageX,b.pageY),u.RD(b);else{if(u.lD=-1,u.iD=-1,n=f.GC$(u.Ws()).offset(),o=b.pageX-n.left,p=b.pageY-n.top,q=u.hitTest(o,p),r=q.element,u.OC&&u.OC.options.enableAccessibility&&(s=u.cgc(q),u.OC.dgc(s)),""===r)return d.cursor=e,u.repaint(),!1;r===Q?d.cursor=g:(d.cursor=e,r===R?u.lD=q.index:r===S?u.iD=q.index:r===T&&(u.iD=-2)),u.repaint()}return!1},a.prototype.cgc=function(a){var b,c,d=aa(),e="",f=a.element;return f===Q?e=d.ARIA_Resize:f===R?(b={first:d.ARIA_First,prevArrow:d.ARIA_PreviousArrow,nextArrow:d.ARIA_NextArrow,last:d.ARIA_Last,prevButton:d.ARIA_PreviousButton,nextButton:d.ARIA_NextButton},e=b[R]||""):f===S?(c=this.OC.XJc(a.index).name(),e=d.ARIA_SheetTab+" "+c.replace(/([0-9]+)/," $1 ")):f===T?e=d.ARIA_NewSheet:f===U&&(e=d.ARIA_Blank),e},a.prototype.CD=function(b){var c,d=this,e={e:b,r:t};return a.ao(d,"preProcessMouseUp",e),c=e.r,m(c)?(d.HD&&(d.HD=!1,d.OC.aq()),d.SD(),d.PD&&(d.PD=!1,d.TD.remove(),d.UD(),d.yD.hide()),d.OD=t,d.VD(),d.uC(),!d.ND||(d.ND=!1,!1)):c},a.prototype.DD=function(b){var c,d,e,f=this,g={e:b,r:t};return a.ao(f,"preProcessMouseOut",g),c=g.r,m(c)?(f.VD(),d=f.lD,f.lD=-1,e=f.iD,f.iD=-1,f.lD===d&&f.iD===e||f.repaint(),!1):c},a.prototype.tC=function(){var a,b=this;b.WD||(f.GC$(s).bind(I,function(a){b.BD(a)}).bind(J,function(a){b.CD(a)}),a=b.OC.getActiveSheet(),a&&(a.XD=!0),b.WD=!0)},a.prototype.uC=function(){if(this.WD){this.WD=!1,f.GC$(s).unbind(I).unbind(J);var a=this.OC.getActiveSheet();a&&delete a.XD}},a.prototype.JD=function(a,b){var c,d,e=this;e.VD(),c=e.sD(),c.length<=0||(d=200,a%=4,0===a?e.YD(c):1===a?(b||(e.ZD=r.setTimeout(function(){e.JD(1)},d)),e.$D(c)):2===a?(b||(e.ZD=r.setTimeout(function(){e.JD(2)},d)),e._D(c)):3===a&&e.aE(c))},a.prototype.KD=function(a,b,c){var d,e,f,g=this,h=g.OC;g.$C=a,g.ZC=b,h.suspendPaint(),d=h.getActiveSheet(),e=h.XJc(a),e&&e.isEditing()&&e!==d&&(f=d&&d.Cw&&d.Cw.V4,!e.gv(void 0,void 0,f))||(da(h,e,a),g.iw(a,c),h.resumePaint(),g.repaint())},a.prototype.BHb=function(a,b,c,d,e,f){var h={oldValue:c,newValue:d,sheetName:e,propertyName:"isSelected",cancel:!1,sheetIndex:f};a.Wq(g.Events.SheetChanging,h),h.cancel||(b.DHb(d),a&&a.YJc&&a.YJc.repaint(),delete h.cancel,a.Wq(g.Events.SheetChanged,h))},a.prototype.MD=function(a){var b,c,d,e,f,h=this,i=h.OC,j=h.zJc(),k=i.getActiveSheet();if((!h.bE||h.bE(k))&&(da(i,t,t),b=i.yJc(),c=i.getSheetCount(),d=i.vv(i.wv(c)),b.forEach(function(a){a.DHb(!1,!0)}),e=d.name(),f={sheetName:e,propertyName:"insertSheet",cancel:!1,sheetIndex:c},h.BHb(i,d,!1,!0,e,c),i.Wq(g.Events.SheetChanging,f),!f.cancel)){for(i.ow(c,1,d),i.Wq(g.Events.SheetChanged,{sheetName:d.name(),propertyName:"insertSheet",sheetIndex:c}),h.$C=c,h.ZC=a,i.ZJc(i.sheets.length-1,1,!1,!0);h.$C>h.gq&&(h.YC()||h.gq<h.jw(-1));)h.hE(h.gq)&&(h.ZC-=j?h.WC[h.gq]:h.BJc),h.gq++;h.repaint()}},a.prototype.iw=function(a,b){var c,d,e,f,h,i,j,k,l,m,n=this,o=n.OC,p=o.yJc(),q=n.zJc(),r=o.getActiveSheet();n.uYc&&!n.uYc(r)||(c=!1,
r&&r.Cw&&r.Cw.V4&&(c=!0),d=!!b,d&&(h=g.Ul.sl(),e=h?b.metaKey:b.ctrlKey,f=b.shiftKey),a!==o.eq?(e?(i=p[a],i.DHb()?i.DHb(!1,!0):(i.DHb(!0,!0),r&&!r.DHb()&&r.DHb(!0,!0))):f?(j=p.slice(v(o.eq,a),u(o.eq,a)+1),p.forEach(function(a){a.visible()&&(j.indexOf(a)!==-1?a.DHb()||a.DHb(!0,!0):a.DHb()&&a.DHb(!1,!0))})):(k=p.every(function(a){return!a.visible()||a.DHb()}),p[a].DHb()&&!k||p.forEach(function(a){a.DHb(!1,!0)}),i=p[a],i.DHb()||i.DHb(!0,!0),o.ZJc(a,1,c,!0)),l=n.jw(n.gq),m=!1,m=q?n.ZC+n.WC[n.$C]>n._C():n.ZC+n.BJc>=n._C(),n.$C>n.gq&&m&&l!==-1&&(n.gq=l)):f&&p.forEach(function(a){var b=a.name(),c=o.getSheetIndex(b);c!==o.eq&&a.DHb()&&a.visible()&&a.DHb(!1,!0)}),n.$C<n.gq&&(n.gq=n.rw(n.gq)))},a.prototype.cE=function(a,b){var c,d,e,h,j,k,l,m,o,p,r,s,u,v,w,x=this,A=x.OC,B=x.zJc(),C=A.options.tabStripPosition,D=q(g.Im.Lm("").zIndex),E=x.hitTest(a,b);if(E.element===S){if(c=x.$C,d=A.XJc(c),E.index!==c)return;if(A.Wq(g.Events.SheetTabDoubleClick,{sheet:d,sheetName:d.name(),sheetTabIndex:c}),!A.options.tabEditable)return!1;if(e=g.Vl.Xl(),e&&e.endEdit&&!e.endEdit())return;g.Vl.Zl(t),h=f.GC$(x.Ws()).offset(),j=A.xv(),k=f.GC$(j).offset(),l=f.GC$(j).width(),m=n("input"),o=m.style,m.type="text",m.value=d.name(),m.setAttribute("contentEditable","true"),m.setAttribute("autocomplete","off"),o.position="absolute",o.margin="0px",o.padding="0px",p=void 0,r=void 0,s=void 0,u=void 0,v=x.WC[c],B?(u=v-x.EC-x.GC+2,s=h.top-k.top+x.aD(),p=h.left-k.left+x.ZC+x.EC):(w=x.Dr(),u=v-x.EC-x.GC+2,s=h.top-k.top+x.ZC+x.aD(),p=h.left-k.left+w.x+x.GJc+x.HJc,C===i.TabStripPosition.left&&2007===D&&(p+=x.GJc),C===i.TabStripPosition.right&&p+u>l&&(r=h.left+w.width-l+x.GJc+x.HJc)),r?o.right=r+y:p&&(o.left=p+y),o.top=s+y,o.width=u+y,o.backgroundColor=W,o.borderWidth="0px",o.outline=z,o.zIndex="1",f.GC$(m).appendTo(j),x.FD=m,f.GC$(m).addClass("gc-sheetTabEditor").bind(L,function(a){return 13===a.keyCode?(x.GD(d,!1),!1):27===a.keyCode?(x.GD(d,!0),!1):void 0}).bind(M,function(){m.selectionStart=0,m.selectionEnd=m.value.length}).bind(N,function(){x.GD(d,!1)}),m.focus()}return!1},a.prototype.ED=function(b){var c,d,e,g,h=this,i={e:b,r:t};return a.ao(h,"preProcessMouseDbClick",i),c=i.r,m(c)?(d=f.GC$(h.Ws()).offset(),e=b.pageX-d.left,g=b.pageY-d.top,h.cE(e,g)):c},a.prototype.Rw=function(a){var b,c,d=this,e=d.zJc(),f=!m(d.FD);return e||f||(m(a.wheelDelta)&&m(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta,c=d.sD(),b>0?d.$D(c):d._D(c)),!1},a.prototype.GD=function(a,b){var c,d,e,h=this,i=h.FD;i&&(f.GC$(i).unbind(L).unbind(M).unbind(N),c=i.value,b===!1&&(d=a.name(),c!==d&&(e={message:""},l(c,h.OC.yJc(),a,e)&&!m(c)&&""!==c?a.getParent().commandManager().execute({cmd:"renameSheet",sheetName:d,name:c}):a.Wq(g.Events.InvalidOperation,{sheet:a,sheetName:a.name(),invalidType:5,message:e.message}))),i.parentNode.removeChild(i),delete h.FD)},a.prototype.dE=function(){return this.OC.options.allowSheetReorder},a.prototype.LD=function(a,b){var c=this;c.dE()?(c.vD=b.index,c.TD=c.eE(c.vD),c.OD=new g.Point(a.pageX,a.pageY),c.tC()):c.PD=!1},a.prototype.eE=function(a){var b,c,d=this.OC.yJc(),e=d.length;if(!(a>=e||a<0))return b=d[a].name(),b||(b="sheet"),c=f.GC$(n("span")).text(b).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"}),c.addClass("ui-widget-header gc-tab-tip-span btn-primary"),c},a.prototype.VD=function(){var a=this.ZD;a&&(clearTimeout(a),this.ZD=t)},a.prototype.QD=function(a,b){var c,d,e=this,g=e.TD;g&&0===f.GC$(".gc-tab-tip-span").length&&(g.appendTo(s.body),g.hide()),c=g.width(),d=g.height(),g.css({left:a-c/2,top:b-d/2}),g.show()},a.prototype.RD=function(a){var b,c,d,e,g,h,j,k=this,l=k.OC,n=f.GC$(k.Ws()),o=n.position(),p=n.offset(),q=a.pageX-p.left,s=a.pageY-p.top,u=k.hitTest(q,s),v=u.element,w=k.Dr(),x=k.VC(),y=k.OC.yJc().length,z=100,A=l.options.tabStripPosition,B=k.zJc(),C=k.TC(),D=k.yD,E=B?q:s;b=B?w.x+k._C():w.y+k._C()+C,E>b?k.wD===t&&k.uD<y&&(k.wD=r.setInterval(function(){k._D(k.sD()),k.uD===y?(k.SD(),A===i.TabStripPosition.bottom?(c=o.left+k.fE()-X/2,d=o.top-X/2):A===i.TabStripPosition.top?(c=o.left+k.fE()-X/2,d=o.top+w.height):A===i.TabStripPosition.left?(c=o.left+w.width,d=o.top+k.fE()-X/2):A===i.TabStripPosition.right&&(c=o.left-X/2,d=o.top+k.fE()-X/2),D.show()):(k.uD++,D.hide()),D.css({left:c,top:d})},z)):E<x?k.wD===t&&k.uD>0&&(k.wD=r.setInterval(function(){k.$D(k.sD()),0===k.uD?(k.SD(),A===i.TabStripPosition.bottom?(c=o.left+x-X/2,d=o.top-X/2):A===i.TabStripPosition.top?(c=o.left+x-X/2,d=o.top+w.height):A===i.TabStripPosition.left?(c=o.left+w.width,d=o.top+C-X/2):A===i.TabStripPosition.right&&(c=o.left-X,d=o.top+C-X/2),D.show()):(k.uD--,D.hide()),D.css({left:c,top:d})},z)):(k.SD(),v!==S&&k.Via().indexOf(v)===-1||(e=u.index,v===U&&(e=k.uD),(v!==S||m(e))&&(e=y),g=ha(e,u.position,k.vD,y,k.WC),h=g.index,j=g.position,k.uD=h,A===i.TabStripPosition.bottom?(c=o.left+j-X/2,d=o.top-X):A===i.TabStripPosition.top?(c=o.left+j-X/2,d=o.top+w.height):A===i.TabStripPosition.left?(c=o.left+w.width,d=o.top+j-X/2):A===i.TabStripPosition.right&&(c=o.left-X,d=o.top+j-X/2),D.css({left:c,top:d}),D.show()))},a.prototype.fE=function(){var a,b=this,c=b.zJc(),d=b.WC,e=b.sD(),f=b.gE(b.gq,e),g=0,h=b.VC(),i=b.BJc,j=c?h+b.LC:h;for(a=f;a<e.length;a++)g=e[a],c?(j+=d[g],j+=b.HC):j+=i;return j},a.prototype.SD=function(){var a=this.wD;a&&(clearInterval(a),this.wD=t)},a.prototype.UD=function(){var a,b,c,d=this,e=d.OC,f=d.uD,g=d.vD,h=e.yJc();if(e.suspendPaint(),this.vYc(h)){for(a=[],b=0;b<h.length;b++)h[b].DHb()&&(h[b].DHb(!1),a.push(h[b]));for(b=a.length-1;b>=0&&!(e.getSheetIndex(a[b].name())<=f);b--)e.commandManager().execute({cmd:"moveSheet",sheetName:a[b].name(),targetIndex:f});for(f-=1,b=0;b<a.length&&!(e.getSheetIndex(a[b].name())>f);b++)e.commandManager().execute({cmd:"moveSheet",sheetName:a[b].name(),targetIndex:f})}else c=e.XJc(g),f!==-1&&g!==-1&&g!==f&&g!==f-1&&d.yD.isVisible()&&(g<f-1&&(f-=1),e.commandManager().execute({cmd:"moveSheet",sheetName:c.name(),targetIndex:f}));e.resumePaint()},a.prototype.vYc=function(a){var b,c=[];for(b=0;b<a.length;b++)if(a[b].DHb()&&(c.push(a[b]),c.length>1))return!0;return!1},a.prototype.DXc=function(a,b){var c,d=this,e=d.OC,f=d.sD();return b===e.getSheetCount()?(d.aE(f),void d.fq()):0===b?(d.YD(f),void d.fq()):(c=d.EXc(a,b),void(c&&d.RIc(b)))},a.prototype.EXc=function(a,b){var c,d=this,e=d.TIc().tabsInfo,f=!1,g=!1;for(c=0;c<e.length;c++)if(a===e[c].index&&(f=!0),b===e[c].index&&(g=!0),f&&g)return d.fq(),!1;return!0},a.prototype.sD=function(){var a,b=[],c=this.OC.yJc();for(a=0;a<c.length;a++)this.hE(a)&&b.push(a);return b},a.prototype.YD=function(a){a.length>0&&this.gq!==a[0]&&this.OC.startSheetIndex(a[0])},a.prototype.$D=function(a){var b,c;a.length>0&&(b=this,b.gq>a[0]&&(c=b.rw(b.gq),c!==-1&&b.OC.startSheetIndex(c)))},a.prototype._D=function(a){var b,c;a.length>0&&(b=this,b.gq<a[a.length-1]&&(c=b.rD(a),c!==-1&&b.OC.startSheetIndex(b.jw(b.gq))))},a.prototype.aE=function(a){if(a.length>0&&this.gq<a[a.length-1]){var b=this.rD(a);b!==-1&&this.OC.startSheetIndex(b)}},a.prototype.rD=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(a.length>0)for(b=this,c=b.zJc(),d=b.BJc,e=b._C(),f=0,g=b.WC,h=void 0,i=void 0,j=b.cD(),k=b.gE(b.gq,a),k===-1&&(k=0),h=a.length-1;h>=k;h--)if(i=a[h],l=c?g[i]:d,f+=l,h!==a.length-1&&(f+=c?b.HC:0),m=j+f,0!==h&&(m+=c?b.LC:d),m>e)return n=void 0,n=h+1<a.length?a[h+1]:a[a.length-1],b.gq<n?n:-1;return-1},a.prototype.rw=function(a){var b;for(b=a-1;b>=0;b--)if(this.hE(b))return b;return-1},a.prototype.jw=function(a){var b,c=this.OC.yJc().length;for(b=a+1;b<c;b++)if(this.hE(b))return b;return-1},a.prototype.gE=function(a,b){var c;for(c=0;c<=b.length-1;c++)if(a===b[c])return c;return-1},a.prototype.hE=function(a){var b=this.OC.XJc(a);return b&&b.visible()},a.prototype.fw=function(){this.xD++},a.prototype.gw=function(){var a=this;a.xD--,a.xD<=0&&(a.xD=0,a.repaint())},a.prototype.repaint=function(a){var b=this.Ws();b&&b.getContext&&this.jp(b.getContext(P),a)},a.prototype.jp=function(a,b){var c,d,e,f,h,i,j,k,l,m,o,p,q,r=this;if(!(r.xD>0)){if(c=r.Dr(),d=r.Xs,b){if(b.x>=c.x+c.width)return;if(b.y>=c.y+c.height)return;if(b.x+b.width>c.width&&(b.width=c.width-b.x,b.width<=0))return;if(b.y+b.height>c.height&&(b.height=c.height-b.y,b.height<=0))return;if(b.width<=0||b.height<=0)return}if(f=r.buffer,f&&(!f||f.width===d.width&&f.height===d.height)&&(f||f.width===c.width&&f.height===c.height)||(f&&g.En.Rn(r.OC,f),r.buffer=f=n(O),g.En.Kn(f,r.OC),g.En.Pn(f,c.width,c.height)),!(c.width<=0||c.height<=0||b&&(b.width<=0||b.height<=0))){e=r.buffer.getContext(P),e.clearRect(0,0,c.width,c.height),g.Bn.Dn(e,-c.x,-c.y),r.iE(e,b),g.Bn.Dn(e,c.x,c.y),h=c.x>=0?0:-c.x,i=c.y>=0?0:-c.y,j=h,k=i,b&&(j=c.x+b.x,k=c.y+b.y,c=new g.Rect(j,k,b.width,b.height)),h=c.x>=0?c.x:0,i=c.y>=0?c.y:0,o=t,p=g.En.Ln(d),q=g.En.Mn(d),d&&1!==p&&(j*=p,k*=q,c.x*=p,c.y*=q,c.width*=p,c.height*=q);try{d?b?(l=u(c.width-j,0),m=u(c.height-k,0)):(l=v(c.width-j,u(d.width-c.x,3)),m=v(c.height-k,u(d.height-c.y,3))):(j=b.x,k=b.y,l=b.width,m=b.height),d?(g.Bn.Cn(a,1,1),a.clearRect(h,i,l,m),a.drawImage(r.buffer,j,k,l,m,h,i,l,m),g.Bn.Cn(a,p,q)):(e=r.buffer.getContext(P),o=e.getImageData(j,k,l,m))}catch(a){return}!d&&o&&c.width>0&&c.height>0&&a.putImageData(o,h,i)}}},a.prototype._Jc=function(a,b){var c=this,d=c.Dr();b?a.rect(b.x,b.y,b.width,b.height):a.rect(d.x,d.y,d.width,d.height),a.clip()},a.prototype.aKc=function(a){var b,c,d,e=this,f=e.OC,g=e.zJc();for(a.save(),a.font=h.To.Ro(a.font,"bold"),e.WC=[],d=f.yJc(),c=0;c<d.length;c++)b=Math.round(a.measureText(d[c].name()).width)+e.GC+e.EC,e.WC.push(b);g||(e.BJc=o(a.font)+2*e.SJc),a.restore()},a.prototype.TIc=function(){var a,b,c,d=this,e=d.OC,f=e.yJc(),g=d.zJc(),h=d.Dr(),i=[],j=d.VC(),k=j,l=d.gq;for(g&&l>0&&d.rw(l)>=0&&(k+=d.LC),l<0&&(d.gq=0),b=d.gq;b<f.length;b++){if(c=f[b].visible(),a=d.WC[b],g){if(k>h.x+h.width)break}else if(k>h.y+h.height)break;i.push({index:b,position:k,width:a,text:f[b].name(),visible:c}),c&&(k+=g?a+d.HC:d.BJc)}return{tabsInfo:i,newTabStartPosition:k}},a.prototype.iE=function(a,b){var c,d,e,f,g=this,h=g.OC,j=h.options.scrollbarAppearance===i.ScrollbarAppearance.mobile,k=h.options.tabStripPosition,l=h.options.showHorizontalScrollbar;a&&h&&(c=g.Dr(),a.save(),p(a,g._font),g._Jc(a,b),a.beginPath(),g.aKc(a),d=g.TIc(),e=d.tabsInfo,f=d.newTabStartPosition,g.dD(a,c),g.fD(a,c,f),g.jE(a,c,e),g.OC&&g.OC.options.tabNavigationVisible&&g.kD(a,c),l&&!j&&k===i.TabStripPosition.bottom&&g.nD(a,c),a.beginPath(),a.restore())},a.prototype.dD=function(a,b){},a.prototype.fD=function(a,b,c){},a.prototype.bKc=function(a,b){var c,d,e=this,f=e.zJc(),g=e.VC();f?(c=b.x+e._C(),a.rect(g,0,c-g,b.height)):(d=e.PC(),a.rect(0,g,b.width,b.height-g-d)),a.clip()},a.prototype.cKc=function(a,b,c){var d,e,f,g=this,h=g.OC,i=g.zJc(),j=g.$C,k=g.iD;for(d=c.length-1;d>=0;d--)e=c[d],e.index!==j&&e.visible&&(f=h.MJc(e.text).DHb(),i?g.oD(a,e.position,0,e.width,b.height,e.index,!1,e.index===k,e.text,f):g.oD(a,0,e.position,b.width,g.BJc,e.index,!1,e.index===k,e.text,f))},a.prototype.dKc=function(a,b,c){var d,e,f=this,g=f.OC,h=g.yJc(),i=f.zJc(),j=f.$C,k=f.gq,l=c[j-k];j>=k&&j<h.length&&l&&l.visible&&(d=g.WJc(),d&&(e=d.DHb(),i?f.oD(a,l.position,0,l.width,b.height,j,!0,!1,l.text,e):f.oD(a,0,l.position,b.width,f.BJc,j,!0,!1,l.text,e)))},a.prototype.eKc=function(a,b){var c=this,d=c.gq,e=c.zJc(),f=c.VC();d>0&&c.rw(d)>=0&&e&&c.jD(a,b,d,f)},a.prototype.jE=function(a,b,c){var d=this,e=d.OC,f=e.yJc();d.$C=e.fKc(),f.length>0&&(a.save(),a.beginPath(),d.bKc(a,b),d.cKc(a,b,c),d.dKc(a,b,c),a.restore(),a.save(),a.beginPath(),d.eKc(a,b),a.restore())},a.prototype.jD=function(a,b,c,d){},a.prototype.kD=function(a,b){},a.prototype.nD=function(a,b){},a.prototype.mD=function(a,b,c,d,e,f,g,h,i,j){},a.prototype.oD=function(a,b,c,d,e,f,g,h,i,j){},a.prototype.Ws=function(){return this.Xs},a.prototype.kE=function(a,b){var c,d,e,f,h=a.createLinearGradient(b.x,b.y,b.width,b.height),j=g.Im.Km(i.VisualState.normal,"gc-tabStripBackground"),l=j&&j.backgroundImage,m=j&&j.backgroundColor;if(l&&l.indexOf("linear-gradient")!==-1)for(c=k(l),d=0,e=c.length;d<e;d++)f=c[d],h.addColorStop(f.point,f.color);else m&&(h.addColorStop(0,"#DDDDDD"),h.addColorStop(1,m));return h},a.prototype.pD=function(a,b,c,d,e){var f,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.zJc(),y=w.Dr();if(x?f=a.createLinearGradient(y.x+.7*y.height,y.y+0,.7*y.height,y.height):(h=y.y,i=0,e>0&&(h=e,i=w.BJc),f=a.createLinearGradient(y.x+.7*i,h,.7*i,h+i)),j=w.OC.MJc(c),""===c&&w.gq>0&&(j=w.OC.XJc(w.gq-1)),l=j&&j.options,m=l&&l.sheetTabColor)n="rgba(0, 0, 0, 0)",a.fillStyle=n,o=a.fillStyle,a.fillStyle=g.Rm.Om(j,m),p=a.fillStyle,p!==o&&(b?(f.addColorStop(0,W),f.addColorStop(.45,"#F1F6FD"),f.addColorStop(.9,p),f.addColorStop(1,W)):f=p);else if(d)if(q=d.backgroundImage,r=d.backgroundColor,q&&q.indexOf("linear-gradient")!==-1)for(s=k(q),t=0,u=s.length;t<u;t++)v=s[t],f.addColorStop(v.point,v.color);else r&&f.addColorStop(0,r);return f},a.prototype.qD=function(a,b){var c=V;return a&&(c=a.color),b&&j.dc(j.ec(b))<127.5&&(c=W),c},a}(),b.DC=ca,g.Zn(ca)},"./dist/core/workbook/workbook-json.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/workbook/workbook.js"),e=c("./dist/core/worksheet/style.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/tasks.js"),h=c("Common"),i=c("./dist/core/util/common.js"),j=c("CalcEngine"),k=!!j,l=e.Style.kxb,m=h.Commands.UndoManager,n=h.Common.CultureManager,o=h.Common.j.C4,p=h.Common.j.Fa,q=f.GC$.each,r=i.Ul.Ol,s=parseFloat;function t(a,b){return a.hasOwnProperty(b)}function u(a){var b,c,d,e;if(!a||"string"!=typeof a)return 1;if(b=a.split("."),c=b.length,c>3)return 3;if(d=s(b[0]),c<=2)return isNaN(d)?1:d;if(e=s(b[1]),d>=10)return d;if(d>=3){if(e>=20143)return 3;if(e>=20142)return 2}return 1}function v(a,b){var c,d,e,f,g=this,h=b&&b.frozenColumnsAsRowHeaders,i=b&&b.frozenRowsAsColumnHeaders,j=0,k=a.sheets;if(i||h)for(d in k)"string"==typeof d&&(e=k[d],f=r(e.index)?e.index:e.mi,c=g.sheets[r(f)?f:j],i&&r(e.frozenRowCount)&&(c.$Bb=!0,c.deleteRows(0,e.frozenRowCount)),h&&r(e.frozenColCount)&&c.deleteColumns(0,e.frozenColCount),j++)}function w(a,b){var c=b.sheetTabCount;r(c)&&a.gKc(c,0)}function x(a,b,c,d){var e,f,g,h,i,j,k,l=0,m=b.sheetTabs,n=[],o=d&&d.QIc,p=a.pJc;if(p&&p.length&&m){for(e in m)"string"==typeof e&&(f=m[e],g=a.pJc[l],g.fromJSON(f,!1,c,d,!0),o||(n[l]=[g,f.addition]),l++);n.length>0&&(h=a.dataManager(),i=n[0][1].dataView,j=h.tables[i&&i.tableName],j&&(k=j.views[i.name],k&&k.fetch().then(function(){var b,c,d;for(b=0,c=n;b<c.length;b++)d=c[b],d[0].x3c(d[1]);a.suspendPaint(),a.pJc[0].kj.recalcAll(!0),a.resumePaint()})))}}function y(a,b){var c,d=b.activeSheetTabIndex;r(d)&&(a.hKc(d,0),c=a.pJc[d],c&&c.DHb(!0,!1))}d.Workbook.prototype.toJSON=function(a){return this.t7c(a)},d.Workbook.prototype.t7c=function(a,b){var c,e,g,h,l,m,n,r,s,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=this,N={version:i.productInfo.productVersion},O=a&&a.rowHeadersAsFrozenColumns,P=a&&a.columnHeadersAsFrozenRows,Q=O||P;if(Q&&(a.Yec=!0),M.EHb&&(N.docProps=o(M.EHb)),k&&(c=j.Functions.setLanguagepackage,c&&(e=c(),c("en"))),g=M.getSheetCount(),N.sheetCount=g,Q)for(h=new d.Workbook,l=a&&a.includeAutoMergedCells,h.fromJSON(M.toJSON({includeBindingSource:!0,includeAutoMergedCells:l})),M=h,m=0;m<g;m++)n=M.getSheet(m),r=n.getRowCount(1),s=n.getColumnCount(2),u=O&&s>0,v=P&&r>0,u&&n.addColumns(0,s),v&&n.addRows(0,r,v),u&&n.Zec(s,v?r:0),v&&n.$ec(r,u?s:0);for(M.mv=!0,M.suspendPaint(),M.suspendEvent(),k&&(w=M.Wu,w.calcOnDemand&&(w.calcOnDemand=!1,M.FHb(),w.suspend(!0),w.resume(!0),w.calcOnDemand=!0),w.suspend(!0)),x=M.startSheetIndex(),x&&(N.startSheetIndex=x),q(M.options,function(a,b){"_ps"!==a&&d.Workbook.Qp[a]!==b&&(N[a]=b)}),y=M.getActiveSheetIndex(),y!==d.Workbook.ov&&(N.activeSheetIndex=y),z={},A=0;A<g;A++)n=M.getSheet(A),B=a,p(b)||A===b||(B={}),z[n.name()]=n.toJSON(B),z[n.name()].index=A;for(f.GC$.isEmptyObject(z)||(N.sheets=z),C=M.getSheetTabCount(),0!==C&&(N.sheetTabCount=C),D=M.getActiveSheetTabIndex(),D!==-1&&(N.activeSheetTabIndex=D),E={},F=0,G=0;G<C;G++)H=M.getSheetTab(G),I=H.toJSON(a),I?(I.index=g+G-F,E[H.name()]=I):(F++,D>=G&&D--);if(N.sheetTabCount=(N.sheetTabCount||0)-F,D!==-1&&(N.activeSheetTabIndex=D),f.GC$.isEmptyObject(E)||(N.sheetTabs=E),J=[],K=M.Lq,K){for(L in K)t(K,L)&&J.push(K[L]);J.length>0&&(N.namedStyles=J)}return d.Workbook._n&&q(d.Workbook._n,function(b,c){c.toJson&&c.toJson.call(M,N,a)}),k&&c&&c(e),M.mv=!1,k&&M.Wu.resume(!1),M.resumeEvent(),M.resumePaint(),Q&&delete a.Yec,N},d.Workbook.prototype.fromJSON=function(a,b){var c,f,g,h,j,p,s,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this;if(Y.vXc(),a){if(b&&b.incrementalLoading)return b.incrementalLoading===!0&&(b.incrementalLoading={}),Y.egc(a,b);c=u(a.version),f=c<3,g={noSchema:f,version:c},h=i.Vl.Xl(),Y.mv=!0,Y.suspendPaint(),Y.suspendEvent(),j=n.culture(),n.culture("");try{Y.T3(),Y.pv=new m(Y,(-1),Y.options.allowUndo),k&&Y.qv(!0),k&&Y.Wu.suspendAdjust(),Y.lv=-1,Y.clearSheets(),Y.clearSheetTabs(),p=Y.options,s=a.canUserEditFormula,r(s)&&(p.allowUserEditFormula=s),A=a.allowDragDrop,r(A)&&(p.allowUserDragDrop=A),B=a.allowDragFill,r(B)&&(p.allowUserDragFill=B);for(C in p)t(p,C)&&(D=a[C],r(D)&&(p[C]=D));if(Y.EHb=o(a.docProps),z(Y,"preFromJson",[a,f,b]),E=a.sheetCount,r(E)||(E=d.Workbook.nv),Y.sw(E,0),Y.Lq={},Y.dkc={},F=a.namedStyles)for(G=0,H=F;G<H.length;G++)I=H[G],J=new e.Style,l(I,Y),J.fromJSON(I,f,Y),Y.Kq(J);if(K=0,L=void 0,M=a.sheets,N=void 0,O=void 0,P=!1,Q=!0,M)for(R in M)"string"==typeof R&&(S=M[R],T=r(S.index)?S.index:S.mi,L=Y.sheets[r(T)?T:K],S.isApplyRefilter=b&&b.isApplyRefilter,L.fromJSON(S,!1,g,b,!0),K++,O=S.allowUndo,P?Q=Q&&O===N:(N=O,P=!0));r(N)&&Q&&(p.allowUndo=N),w(Y,a),x(Y,a,g,b),y(Y,a),U=a.activeSheetIndex,r(U)||(U=d.Workbook.ov),Y.dq(U,0),V=Y.sheets[U],V&&V.DHb(!0,!1),W=a.startSheetIndex,r(W)&&Y.startSheetIndex(W),X=a.backgroundImage,r(X)&&Y.Ys(),d.Workbook._n&&q(d.Workbook._n,function(c,d){var e=d.fromJson;e&&e.call(Y,a,f,b)}),k&&Y.Wu.resumeAdjust(),v.call(Y,a,b),d.Workbook.ao(Y,"initCustomName")}finally{k&&Y.Wu.resumeAdjust(),n.culture(j),Y.mv=!1,V=Y.getActiveSheet(),h&&V&&V.zt(),Y.resumeEvent(),Y.fq(),Y.resumePaint(),V&&Y.Wq(i.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:V})}}};function z(a,b,c){d.Workbook._n&&q(d.Workbook._n,function(d,e){var f=e[b];f&&f.call.apply(f,[a].concat(c))})}d.Workbook.prototype.egc=function(a,b){var c,f,h,j,p,s,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this;Y.fgc&&Y.fgc.terminate(),Y.fgc=new g.Tasks(function(){var a,b,c,d=Y.getActiveSheet();if(!d.loaded)for(a=this.tasks.length-1;a>=0;a--)if(b=this.tasks[a].args[0],b&&b.ITa&&b.name&&b.name()===d.name())return c=this.tasks[a],this.tasks.splice(a,1),c;return this.tasks.pop()},function(){var a=Y.getActiveSheet();return a&&(Y.ku.Gw||a.isEditing()||a.mm.OG||a.mm.xG||a.mm.eG)}),c=u(a.version),f=c<3,h={noSchema:f,version:c},j=i.Vl.Xl(),Y.mv=!0,Y.suspendPaint(),Y.suspendEvent(),p=n.culture(),n.culture("");try{Y.T3(),Y.pv=new m(Y,(-1),Y.options.allowUndo),k&&Y.qv(!0),k&&Y.Wu.suspendAdjust(),Y.lv=-1,Y.clearSheets(),Y.clearSheetTabs(),s=Y.options,A=a.canUserEditFormula,r(A)&&(s.allowUserEditFormula=A),B=a.allowDragDrop,r(B)&&(s.allowUserDragDrop=B),C=a.allowDragFill,r(C)&&(s.allowUserDragFill=C);for(D in s)t(s,D)&&(E=a[D],r(E)&&(s[D]=E));if(Y.EHb=o(a.docProps),z(Y,"preFromJson",[a,f,b]),F=a.sheetCount,r(F)||(F=d.Workbook.nv),Y.sw(F,0),Y.Lq={},G=a.namedStyles)for(H=0;H<G.length;H++)I=G[H],J=new e.Style,l(I,Y),J.fromJSON(I,f,Y),Y.Kq(J);if(K=0,M=a.sheets,N=void 0,O=void 0,P=!1,Q=!0,M){R={total:0,valuesLoad:0,formulaLoad:0},K=0,b.incrementLoadTask=Y.fgc,b.incrementalLoading.loadStatus=R;for(S in M)"string"==typeof S&&(T=M[S],U=r(T.index)?T.index:T.mi,L=Y.sheets[r(U)?U:K],L.loading=!0,L.cq(T.name+"",!0),L.DHb(T.isSelected),L.setRowCount(T.rowCount),L.setColumnCount(T.columnCount),r(T.visible)&&L.visible(T.visible),R.total+=L.getRowCount(),Y.fgc.addTask(function(a,c){c.isApplyRefilter=b&&b.isApplyRefilter,a.egc(c,!1,h,b,!0)},[L,T]),K++,O=T.allowUndo,P?Q=Q&&O===N:(N=O,P=!0))}r(N)&&Q&&(s.allowUndo=N),w(Y,a),x(Y,a,h,b),y(Y,a),V=a.activeSheetIndex,r(V)||(V=d.Workbook.ov),Y.dq(V,0),W=Y.sheets[V],W&&W.DHb(!0,!1),X=a.startSheetIndex,r(X)&&Y.startSheetIndex(X),Y.fgc.endingCallback=function(){d.Workbook._n&&q(d.Workbook._n,function(c,d){d.egc?Y.fgc.addTask(function(a,b,c,e){d.egc.call(a,b,c,e)},[Y,a,f,b]):d.fromJson&&d.fromJson.call(Y,a,f,b)}),Y.fgc.endingCallback=function(){var c,e;for(k&&Y.Wu.resumeAdjust(),v.call(Y,a,b),d.Workbook.ao(Y,"initCustomName"),c=0;c<Y.sheets.length;c++)delete Y.sheets[c].loading;L=Y.getActiveSheet(),L&&Y.Wq(i.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:L}),b&&b.incrementalLoading&&b.incrementalLoading.loading&&b.incrementalLoading.loading(1,{sheet:L}),e=b&&b.incrementalLoading&&b.incrementalLoading.loaded,e&&e(),L&&L.repaint(),Y.fgc.endingCallback=void 0},Y.fgc.start()},Y.fgc.start()}finally{n.culture(p),Y.mv=!1,W=Y.getActiveSheet(),j&&W&&W.zt(),Y.resumeEvent(),Y.fq(),Y.resumePaint()}}},"./dist/core/workbook/workbook.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/workbook/workbookpanelex.js"),e=c("./dist/core/core.ns.js"),f=c("Common"),g=c("./dist/core/util/domUtil.js"),h=c("./dist/core/util/common.js"),i=c("./dist/core/util/imageLoader.js"),j=c("./dist/core/worksheet/worksheet-actions.js"),k=c("./dist/core/workbook/sheettab.js"),l=c("./dist/core/workbook/sheettab2007.js"),m=c("./dist/core/worksheet/stylehelper.js"),n=c("./dist/core/worksheet/clipboardhelper.js"),o=c("./dist/core/worksheet/worksheet.js"),p=c("CalcEngine"),q=!!p,r=c("./dist/core/core.enum.js"),s=f.Common.u,t=f.Commands.UndoManager,u=f.Commands.CommandManager,v=g.GC$.each,w=g.GC$.extend,x=q,y=f.Common.j.Fa,z=h.Ul.Nl,A=h.Ul.Pl,B=h.Ul.Ql,C=h.Ul.hZa,D=f.Common.CultureManager,E=parseInt,F=window,G=document,H=null,I=Math.round,J=Math.min,K=Math.floor,L=Math.abs,M="number",N="mousedown",O="mousemove",P="mouseup",Q="mouseenter",R="mouseleave",S="scroll",T="resize",U="focus",V=".gcSpread",W=".gcSpreadInternal",X=".gcScrollbar",Y="span",Z="div",$="table",_="px",aa="100%",ba="gc-scroll-handle",ca="gc-scroll-bar",da="none",ea="display",fa="block",ga="absolute",ha="content-box",ia="solid",ja=" ui-widget-header ui-state-default btn btn-default",ka="gc-scroll-mobile-container",la="gc-scroll-mobile-container-horizontal",ma="gc-scroll-mobile-container-vertical",na="gc-scroll-mobile-spread-hovering",oa="gc-scroll-mobile-state-hide",pa="gc-scroll-mobile-state-hover",qa=F.jQuery,ra="cultureChanged",sa="workbook",ta="gcUIElement",ua="gc-no-user-select",va="visible",wa="overflow",xa="en-US",ya=80,za=1,Aa=new f.Common.ResourceManager(e.SR,"Sheets"),Ba=Aa.getResource.bind(Aa);function Ia(a,b){return h.En.npb()%1!==0||a.zoom()%1!==0||a.parent&&a.parent.options.scrollByPixel&&b&&a.mJb&&a.mJb.mgc(h.kf(a.lq,a.qq,1,1))}function Ja(a,b){return F.setTimeout(function(){a.invalidateLayout(),a.repaint(),b.GHb=H;var c=a.Dr();b.pWc(a,c.x,c.width),b.sWc(a,c.y,c.height)},200)}function Ka(a,b,c){a.Wq(h.Events.ActiveSheetChanged,{oldSheet:b,newSheet:c})}function La(a,b){a.Wq(h.Events.ActiveSheetChanging,b)}function Ma(a,b){a.Wq(h.Events.FormulatextboxActiveSheetChanging,b)}function Na(a,b,c){a.Wq(h.Events.FormulatextboxActiveSheetChanged,{oldSheet:b,newSheet:c})}function Oa(a,b){return void 0===b&&(b=12),+parseFloat(a.toPrecision(b))}Ca=100,Da=30,Ea=40,Fa=function(){function a(a){this.yw=a}return a.Lv=function(a,b){var c,d=a.data,e=d.ku;e.HHb&&(F.clearTimeout(e.HHb),e.HHb=H),c=d.WJc(),c&&b&&c.iKc(d,b)},a.Mv=function(a){var b=a.data,c=b.WJc();c&&c.jKc(b)},a.Nv=function(a){var b,c,d,e,f,h,i=a.data;i&&(b=i.getActiveSheet(),b?(c=i.kKc.xR,c&&c.mR&&(b.CH=!0),b.zt(),d=i.options.showScrollTip,1!==d&&3!==d||(e=g.GC$(a.srcElement||a.target),f=e.parent(),(e&&(e.hasClass(ba)||e.hasClass(ca))||f&&(f.hasClass(ba)||f.hasClass(ca)))&&i.ku.Dw(!1,a))):(h=i.getActiveSheetTab(),h.zt()))},a.Dv=function(a,b){var c,d=a.data,e=d.ku;e.HHb&&(F.clearTimeout(e.HHb),e.HHb=H),c=d.WJc(),c&&b&&c.lKc(d,b)},a.Ev=function(a){var b=a.data,c=b.WJc();c&&c.mKc(b)},a.Fv=function(a){var b,c,d,e,f,h,i=a.data;i&&(b=i.getActiveSheet(),b?(c=i.nKc.xR,c&&c.mR&&(b.CH=!0),b.zt(),d=i.options.showScrollTip,2!==d&&3!==d||(e=g.GC$(a.srcElement||a.target),e&&(f=e.parent(),(e.hasClass(ba)||f&&f.hasClass(ba)||e.hasClass(ca)||f&&f.hasClass(ca))&&i.ku.Dw(!0,a)))):(h=i.getActiveSheetTab(),h&&h.zt()))},a.Gv=function(a){var b=a.data;b&&b.xw()},a.ggc=function(a){var b,c,d,e,f=Ba(),h=a.data,i=a.scrollbar;h.options.enableAccessibility&&(b=g.GC$(i.Bv()).offset(),c=i.hitTest(a.x-b.left,a.y-b.top),d={thumbButton:f.ARIA_Scrollbar_Thumb_Button,trackButton:f.ARIA_Scrollbar_TRACK_Button,leftButton:f.ARIA_Scrollbar_Left_Button,rightButton:f.ARIA_Scrollbar_Right_Button,upButton:f.ARIA_Scrollbar_Top_Button,downButton:f.ARIA_Scrollbar_Bottom_Button},e=d[c.element],h.dgc(e))},a.prototype.no=function(){this.yw=H},a.prototype.Bw=function(a,b,c,d){var e=this;a&&(e.Gw=!0,e.Hw=d?a.lq:b,e.bCb=d?a.cCb:c,e.Iw=d?b:a.qq,e.dCb=d?c:a.eCb,F.setTimeout(function(){e.Kw(a)},0))},a.prototype.Kw=function(a){var b=this;a&&b.Gw&&(b.Gw=!1,b.Lw(a))},a.prototype.Lw=function(a){var b,c,d,e,f,g,h=this;h.Mw||(h.Mw=!0,b=h.yw,a&&(c=b.options.showScrollTip,d=h.Hw,e=h.bCb,f=h.Iw,g=h.dCb,d!==a.lq||e!==a.cCb?(h.ju(a,d,e),2!==c&&3!==c||b.ww(h.Nw(!0))):f===a.qq&&g===a.eCb||(h.lu(a,f,g),1!==c&&3!==c||b.ww(h.Nw(!1)))),h.Mw=!1)},a.prototype.ju=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,z,A,B,C,D,E,G,I,K,M,N,O,P,Q,R,S,T,U=this;if(U.GHb&&(F.clearTimeout(U.GHb),U.GHb=H),a){if(e=a.lq,f=a.cCb,g=!y(d),!g&&b===e&&c===f)return;if(g&&(e=d),a.lq=b,a.cCb=c,a.Xq>0)return void(e!==b&&a.Wq(h.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:e,newTopRow:b}));if(i=!1,j=a.options,k=j.sheetAreaOffset.top,l=k+2,m=a.Zs,n=a.am(),o=n.qt,p=a.oKc(n),q=n.pKc,r=n.ot,s=n.gs,t=n.width+j.sheetAreaOffset.left,u=void 0,v=void 0,w=void 0,x=a.yl,z=x.bm(),A=a.qKc,a.tables&&0===a.frozenRowCount()&&(B=a.tables.KHb(),B&&(B.x=B.x-2,B.width=B.width+4,B.y=k,B.height=o,a.$l=!0,x._l(z,B))),b>e||b===e&&L(c)>L(f)){if(C=void 0,D=void 0,E=a.Gr(1),E&&E.length>0&&(C=E.findRow(b)),C){for(G=E.length-1,D=E[G];D&&D.y+D.height>o+p;)G-=1,D=E[G];D&&D.row>b&&(i=!0,v=m?m.x:n.x,w=C.y+L(c),u=D.y+D.height-w-l,x.Ow(v,w,t,u,v,o),j.colHeaderVisible||(a.invalidateLayout(),x._l(z,new h.Rect(v,0,t,k))),a.invalidateLayout(),I=A?p:p+s+q,x._l(z,new h.Rect(v,o+u,t,I-u)),I-=A?0:q,x.Pw(z,new h.Rect(v,o-2,t,I+2)),this.pWc(a,v,t))}}else{for(K=0,M=b;M<e&&K<p;M++)K+=a.Sl(M);K+=L(f)-L(c),K<p&&(i=!0,v=m?m.x:n.x,w=o,u=p-K,a.frozenTrailingRowCount()>0&&(u-=za),N=0,!A&&q>0&&(N=s,O=J(m.height-N-za,r-za+K),x.Ow(v,r-za,t,N+za,v,O)),P=A?0:J(K,q)-za,x.Ow(v,w,t,u+P,v,w+K),a.invalidateLayout(),Q=a.rowOutlines&&!a.rowOutlines.iT()?a.rowOutlines.s0a()+k+1:0,x._l(z,new h.Rect(v,w-k,t,K+k+Q+5)),R=p+P+N+2,x.Pw(z,new h.Rect(v,w-2,t,R)),this.pWc(a,v,t))}i||(a.invalidateLayout(),a.repaint()),e!==b&&a.Wq(h.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:e,newTopRow:b}),S=a.mm,S&&S.Qw(),T=e===a.lq&&f!==a.cCb,i&&Ia(a,T)&&(U.GHb=Ja(a,U))}},a.prototype.pWc=function(a,b,c){var d=a.yl,e=d.bm();this.qWc(a).concat(this.rWc(a)).forEach(function(a){var f=a.layout,g=new h.Rect(b,f.y,c,f.height);d.dm(g),d.Pw(e,g)})},a.prototype.qWc=function(a){var b,c,d,e,f,g,h,i=this,j=a.getSelections();return 1===j.length?(b=i.yw.options.scrollByPixel,c=a.lq,d=a.cCb,e=j[0].row,f=j[0].row+j[0].rowCount-1,b&&f===c-1?[]:(g=[],(e===c+1||e<c&&c<=f||f===c-1||b&&e===c&&0!==d)&&(h=a.Gr(0),h&&h.length>0&&g.push({layout:h[h.length-1]})),g)):[]},a.prototype.rWc=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=a.getSelections();return 1===o.length?(b=n.yw.options.scrollByPixel,c=a.getViewportBottomRow(1),d=o[0].row,e=o[0].row+o[0].rowCount-1,f=[],g=a.Gr(2),h=g&&g.length>0,i=h?g[0]:H,j=a.Gr(1),k=j&&j.length>0,l=k?j.findRow(c):H,m=h&&k&&i.y!==l.y+l.height,(e===c-1||d<=c&&c<e||d===c+1||b&&e===c&&m)&&h&&f.push({layout:i}),f):[]},a.prototype.lu=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,z,A,B,C,D,E,G,I,K,M,N,O,P,Q,R,S,T=this;if(T.GHb&&(F.clearTimeout(T.GHb),T.GHb=H),a){if(e=a.qq,f=a.eCb,g=!y(d),!g&&b===e&&c===f)return;if(g&&(e=d),a.qq=b,a.eCb=c,a.Xq>0)return void(e!==b&&a.Wq(h.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:e,newLeftCol:b}));if(i=!1,j=a.options,k=j.sheetAreaOffset.left,l=k+2,m=a.Zs,n=a.am(),o=n.pt,p=a.rKc(n),q=n.sKc,r=n.lt,s=n.js,t=n.height+j.sheetAreaOffset.top,u=void 0,v=void 0,w=void 0,x=a.yl,z=x.bm(),A=a.tKc,b>e||b===e&&L(c)>L(f)){if(B=void 0,C=void 0,D=a.Hr(1),D&&D.length>0&&(B=D.findCol(b)),B){for(E=D.length-1,C=D[E];C&&C.x+C.width>o+p;)E-=1,C=D[E];C&&C.col>b&&(i=!0,u=B.x+L(c),v=m?m.y:n.y,w=C.x+C.width-u-l,x.Ow(u,v,w,t,o,v),j.rowHeaderVisible||(a.invalidateLayout(),x._l(z,new h.Rect(0,v,k,t))),a.invalidateLayout(),G=A?p:p+s+q,x._l(z,new h.Rect(o+w,v,G-w,t)),G-=A?0:q,x.Pw(z,new h.Rect(o-2,v,G+2,t)),this.sWc(a,v,t))}}else{for(I=0,K=b;K<e&&I<p;K++)I+=a.Tl(K);I+=L(f)-L(c),I<p&&(i=!0,u=o,v=m?m.y:n.y,w=p-I,a.frozenTrailingColumnCount()>0&&(w-=za),M=0,!A&&q>0&&(M=s,N=J(m.width-M-za,r-za+I),x.Ow(r-za,v,M+za,t,N,v)),O=A?0:J(I,q)-za,x.Ow(u,v,w+O,t,u+I,v),a.invalidateLayout(),P=a.columnOutlines&&!a.columnOutlines.iT()?a.columnOutlines.s0a()+k+1:0,x._l(z,new h.Rect(u-k,v,I+k+P+5,t)),Q=p+O+M+2,x.Pw(z,new h.Rect(o-2,v,Q,t)),this.sWc(a,v,t))}i||(a.invalidateLayout(),a.repaint()),e!==b&&a.Wq(h.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:e,newLeftCol:b}),R=a.mm,R&&R.Qw(),S=e===a.qq&&f!==a.eCb,i&&Ia(a,S)&&(T.GHb=Ja(a,T))}},a.prototype.sWc=function(a,b,c){var d=a.yl,e=d.bm();this.tWc(a).concat(this.uWc(a)).forEach(function(a){var f=a.layout,g=new h.Rect(f.x,b,f.width,c);d.dm(g),d.Pw(e,g)})},a.prototype.tWc=function(a){var b,c,d,e,f,g,h,i=this,j=a.getSelections();return 1===j.length?(b=i.yw.options.scrollByPixel,c=a.qq,d=a.eCb,e=j[0].col,f=j[0].col+j[0].colCount-1,b&&f===c-1?[]:(g=[],(e===c+1||e<c&&c<=f||f===c-1||b&&e===c&&0!==d)&&(h=a.Hr(0),h&&h.length>0&&g.push({layout:h[h.length-1]})),g)):[]},a.prototype.uWc=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=a.getSelections();return 1===o.length?(b=n.yw.options.scrollByPixel,c=a.getViewportRightColumn(1),d=o[0].col,e=o[0].col+o[0].colCount-1,f=[],g=a.Hr(2),h=g&&g.length>0,i=h?g[0]:H,j=a.Hr(1),k=j&&j.length>0,l=k?j.findCol(c):H,m=h&&k&&i.x!==l.x+l.width,(e===c-1||d<=c&&c<e||d===c+1||b&&e===c&&m)&&h&&f.push({layout:i}),f):[]},a.prototype.Rw=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A=this,B=A.yw,C=!1,D=!1,E=B.nKc,F=B.kKc,G=B.options.scrollbarShowMax,H=B.options.scrollbarAppearance===r.ScrollbarAppearance.mobile;if(a){if(e=a.name(),b.ctrlKey){if(!B.options.allowUserZoom)return!0;if(f=a.zoom(),g=Oa(f-.05*c),a.isEditing()&&!a.endEdit())return;if(i={sheet:a,sheetName:a.name(),oldZoomFactor:f,newZoomFactor:g,cancel:!1},a.Wq(h.Events.ViewZooming,i),i&&i.cancel===!0)return!1;j={cmd:"zoom",sheetName:e,oldZoomFactor:f,zoomFactor:i.newZoomFactor},a.wu().execute(j),g=a.zoom(),f!==g&&(delete i.cancel,a.Wq(h.Events.ViewZoomed,i),a.Wq(h.Events.UserZooming,i))}else d=d||0,k=a.lq,l=a.cCb,m=A.ms(a,c),n=m.cj,o=m.UP,k!==n||l!==o?(H&&(E.Jwa(r.ScrollbarState.show),A.Rdc(!0)),A.ju(a,n,o),a.os(),G||a.es()):C=!0,p=a.qq,q=a.eCb,s=A.Sw(a,d),t=s.dj,u=s.UP,p===t&&q===u||(H&&(F.Jwa(r.ScrollbarState.show),A.Rdc(!1)),A.lu(a,t,u),a.qs(),G||a.ds());v=a.Vs(),w=a.hitTest(b.pageX-v.left,b.pageY-v.top),x=a.yt,y=x&&x.cellTypeHitInfo,y&&(y.cellRect=a.getCellRect(x.row,x.col)),z=a.mm,z.Tw(w),z.Uw(w)}return C&&0===d},a.prototype.aCb=function(a,b){var c,d,e,f,g,h,i,j,k=a.lq,l=a.cCb,m=a.parent,n=a.zoom(),o=I(b*m.options.scrollPixel*n),p=0,q=a.am().qt,r=a.jt(1).findRow(k);if(r)if(o<0){for(c=a.Rt(-1),p=-(q-r.y);k>c&&p>=o;)k--,p-=a.Sl(k);l=p-o,k===c&&l>0&&(l=0)}else if(o>0){for(d=a.ns(),p=r.y+r.height-q;k<d&&p<=o;)k++,
p+=a.Sl(k);e=a.Sl(k),l=p-o-e,m.options.scrollbarMaxAlign?(f=a.am(),g=a.frozenRowCount(),h=a.getRowCount()-a.frozenTrailingRowCount()-1,i=a.LHb(a.oKc(f),g,h),d=i.cj,j=i.UP,k>d?(k=d,l=j):k===d&&L(l)>L(j)&&(l=j)):k<d&&p-o===0?(k++,l=0):k===d&&p-o<0&&(l=-e)}return{cj:k,UP:l}},a.prototype.ms=function(a,b){var c,d,e,f,g=a.lq,h=a.cCb,i=a.parent;return i&&i.options.scrollByPixel?i.ku.aCb(a,b):(c=a.frozenRowCount(),c>0&&(0===g&&b>0?g=c:b<0&&g===c-b&&(g=0)),d=a.Rt(g+b,b<0),d!==-1?g=d:g+=b,e=a._t(),f=a.ns(),a.getRowCount()-c-a.frozenTrailingRowCount()<=0||e===H?g=a.lq:(g<e?g=e:g>f&&(g=f),g===H&&(g=-1)),{cj:g,UP:h})},a.prototype._Bb=function(a,b){var c,d,e,f,g,h,i,j,k=a.qq,l=a.eCb,m=a.parent,n=a.zoom(),o=I(b*m.options.scrollPixel*n),p=0,q=a.am().pt,r=a.it(1).findCol(k);if(r)if(o<0){for(c=a.Ot(-1),p=-(q-r.x);k>c&&p>=o;)k--,p-=a.Tl(k);l=p-o,k===c&&l>0&&(l=0)}else if(o>0){for(d=a.ps(),p=r.x+r.width-q;k<d&&p<=o;)k++,p+=a.Tl(k);e=a.Tl(k),l=p-o-e,m.options.scrollbarMaxAlign?(f=a.am(),g=a.frozenColumnCount(),h=a.getColumnCount()-a.frozenTrailingColumnCount()-1,i=a.MHb(a.rKc(f),g,h),d=i.dj,j=i.UP,k>d?(k=d,l=j):k===d&&L(l)>L(j)&&(l=j)):k<d&&p-o===0?(k++,l=0):k===d&&p-o<0&&(l=-e)}return{dj:k,UP:l}},a.prototype.Sw=function(a,b){var c,d,e,f,g=a.qq,h=a.eCb,i=a.parent;return i&&i.options.scrollByPixel?i.ku._Bb(a,b):(c=a.frozenColumnCount(),c>0&&(0===g&&b>0?g=c:b<0&&g===c-b&&(g=0)),d=a.Ot(g+b,b<0),d!==-1?g=d:g+=b,e=a.$t(),f=a.ps(),a.getColumnCount()-c-a.frozenTrailingColumnCount()<=0||e===H?g=a.qq:(g<e?g=e:g>f&&(g=f),g===H&&(g=-1)),{dj:g,UP:h})},a.prototype.Dw=function(a,b){var c,d,e=this,f=e.yw,g=f.getActiveSheet();g&&(a?(c=b.pageY,d=b.pageX-Ca):(c=b.pageY-Ea,d=b.pageX-Da),f.uw(s.Ob(e.Nw(a)),d,c,!0))},a.prototype.Nw=function(a){var b,c=this.yw.getActiveSheet(),d=c.qq+1;return c&&(a?b=Ba().Tip_Row+(c.lq+1):(1!==c.options.colHeaderAutoText&&(d=h.Ul.xq(d)),b=Ba().Tip_Column+d)),b},a.prototype.Sdc=function(a){g.GC$(a).addClass(oa)},a.prototype.Tdc=function(a){g.GC$(a).removeClass(oa)},a.prototype.Udc=function(a){g.GC$(a).addClass(pa)},a.prototype.uKc=function(a){g.GC$(a).removeClass(pa)},a.prototype.Rdc=function(a,b){var c,d,e,f,g;void 0===b&&(b=1e3),c=this,d=c.yw,e=a?d.vKc:d.wKc,f=d.options.scrollbarAppearance=r.ScrollbarAppearance.mobile,g=function(){c.uKc(e),c.Sdc(e)},f&&(c.Wdc(a),a?c.Xdc=setTimeout(g,b):c.Ydc=setTimeout(g,b))},a.prototype.Wdc=function(a){var b=this;a&&b.Xdc?(clearTimeout(b.Xdc),b.Xdc=null):!a&&b.Ydc&&(clearTimeout(b.Ydc),b.Ydc=null)},a}(),Ga={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:r.TabStripPosition.bottom,tabStripWidth:ya,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:H,backgroundImageLayout:0,showResizeTip:r.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:r.ShowScrollTip.none,grayAreaBackColor:H,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:r.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,autoFitType:r.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:r.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:r.ResizeMode.normal,columnResizeMode:r.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:r.ScrollbarAppearance.skin,font:H,customList:[],numbersFitMode:r.NumbersFitMode.mask,pasteSkipInvisibleRange:!1};function Pa(a,b){b?g.GC$(a).removeClass(oa):g.GC$(a).addClass(oa)}function Qa(a,b,c){var d,e,f=h.Im.Lm("gc-vertical-scrollbar"+ja),i=E(f.zIndex)>2007?1:0,j=b-c;j%2===0?(d=j/2,e=d-i):(d=(j-i)/2,e=d),g.GC$(a).css({"box-sizing":ha,border:da,"border-color":da,"border-left-style":ia,"border-left-width":i+_,"border-left-color":f.borderLeftColor,"background-color":f.backgroundColor,width:c,padding:"0px "+d+"px 0px "+e+_,margin:0})}function Ra(a,b,c){var d,e,f=h.Im.Lm("gc-horizontal-scrollbar"+ja),i=E(f.zIndex)>2007?1:0,j=b-c;j%2===0?(d=j/2,e=d-i):(d=(j-i)/2,e=d),g.GC$(a).css({"box-sizing":ha,border:da,"border-color":da,"border-top-style":ia,"border-top-width":i+_,"border-top-color":f.borderTopColor,"background-color":f.backgroundColor,height:c,padding:e+"px 0px "+d+"px 0px",margin:0})}function Sa(a){var b=h.Im.Lm("gc-footer-corner"+ja);g.GC$(a).css({border:da,padding:0,margin:0,"background-color":b.backgroundColor})}function Ta(a,b,c,d,e){var f=a.pia(),g=b.left-c.left,h=b.top-c.top;if(d>g&&d<f.width+g&&e>h&&e<f.height+h)return{horizontalScrollBarHitInfo:{element:a.hitTest(d-g,e-h).element},x:d,y:e}}function Ua(a,b,c,d,e){var f=a.pia(),g=b.left-c.left,h=b.top-c.top;if(d>g&&d<f.width+g&&e>h&&e<f.height+h)return{verticalScrollBarHitInfo:{element:a.hitTest(d-g,e-h).element},x:d,y:e}}function Va(a){var b=g.GC$(a);return{top:Wa(b,"borderTopWidth"),right:Wa(b,"borderRightWidth"),bottom:Wa(b,"borderBottomWidth"),left:Wa(b,"borderLeftWidth")}}function Wa(a,b){var c=a.css(b);switch(c){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(c)}}function Xa(a){var b=g.GC$(a);return{top:parseFloat(b.css("paddingTop")),right:parseFloat(b.css("paddingRight")),bottom:parseFloat(b.css("paddingBottom")),left:parseFloat(b.css("paddingLeft"))}}function Ya(a){var b=a.getBoundingClientRect().width,c=Va(a),d=c.left,e=c.right,f=Xa(a),g=f.left,h=f.right;return b-d-e-g-h}function Za(a){return!!r.SheetType[a]}Ha=function(){function a(a,b){var c,d,e=this;e.name="",e.kv=!1,e.lv=-1,e.eq=0,e.xKc=-1,e.mv=!1,e.options=B(Ga,function(a,b,c){e.Op(a,b,c)}),e.T3(b),b&&"white"===b.backColor?e.Sxb=!0:e.Sxb=!1,c=1,b&&(d=b.sheetCount,typeof d===M&&(c=d)),"string"==typeof a&&(a=G.getElementById(a)),e.qo=a,e.ad(c,a)}return a.prototype.commandManager=function(){return this.wu},a.prototype.undoManager=function(){return this.pv},a.prototype.Txb=function(){var a=this.Uxb(),b=this.Vxb;return b instanceof Array?b.concat(a):a},a.prototype.Uxb=function(){var a=D.culture(),b=[],c=[],d=D.q4(xa).DateTimeFormat,e=D.q4(a).DateTimeFormat;return b=this.Wxb(d),a!==xa&&(c=this.Wxb(e)),b.concat(c)},a.prototype.Wxb=function(a){var b=[],c,d;return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach(function(e){c=a[e],c instanceof Array&&c.length>0&&(d=e.indexOf("month")>-1||e.indexOf("Month")>-1,c=d?c.slice(0,12):c,b.push(c))}),b},a.prototype.FHb=function(){var a=this,b=x&&a.Cf();b&&b.NHb(),this.sheets.forEach(function(a){var b=a.yj();b.OHb()})},a.prototype.Op=function(a,b,c){var d,e=this,f=h.sJc(e),g=x&&e.Cf();switch(a){case"allowUndo":e.pv&&(e.pv.zc=b);break;case"backColor":e.Sxb=!0,f&&f.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":f&&f.$p();break;case"backgroundImage":case"backgroundImageLayout":e.Ys(),f&&f.$p();break;case"newTabVisible":case"tabNavigationVisible":d=e.YJc,d&&d.repaint();break;case"tabStripPosition":b!==c&&e.yKc(b);break;case"tabStripWidth":b!==c&&e.zKc(b);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":e.fq();break;case"tabStripRatio":e.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":f&&(f.oq=!0,f.jq=!0,f.$p());break;case"scrollByPixel":f&&(f.oq=!0,f.jq=!0,f.cCb=0,f.eCb=0,f.$p());break;case"scrollPixel":b<=0&&(e.options.scrollPixel=c);break;case"scrollbarAppearance":e.ku&&b!==c&&e.Zdc(b);break;case"calcOnDemand":g&&(!b&&g.calcOnDemand&&e.FHb(),g.calcOnDemand=b);break;case"customList":e.Vxb=b;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":e.PHb(a,b),f&&f.$p()}},a.prototype.Zdc=function(a){var b,c;y(a)&&(a=r.ScrollbarAppearance.skin),b=this,c=a===r.ScrollbarAppearance.mobile,b.nKc.$dc(a),b.kKc.$dc(a),b.AKc(),c?b.BKc():b.CKc(),b.refresh()},a.prototype.yKc=function(a){var b=this;y(a)&&(a=r.TabStripPosition.bottom,b.options.tabStripPosition=a),b.sj&&(b.DKc(),b.v8a(),b.fq())},a.prototype.zKc=function(a){var b=this;y(a)?(a=ya,b.options.tabStripWidth=a):a<ya&&(b.options.tabStripWidth=ya),b.sj&&(b.v8a(),b.fq())},a.prototype.PHb=function(a,b){var c=this,d=x&&c.Cf();if(d)switch(a){case"referenceStyle":d.useR1C1=1===b;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":d[a]=b}},a.prototype.ad=function(b,c){var d,e,f,g,h=this;for(x&&h.qv(),h.rv=[],h.sv=z("input"),h.jm=0,h.xD=0,h.tv={fromSheet:H,isCutting:!1},h.mmb={fromSheet:H,isCutting:!1},h.Ks=H,h.sheets=[],h.pJc=[],h.Lq={},h.Vxb=h.options.customList,h.pv=new t(h,(-1),h.options.allowUndo),d=h.wu=new u(h),d.EKc("beforeWorkbookExecute",function(a){h.FKc(a)}),d.addListener("workbookUndo",function(a){var b,c=a.command,d=j.Commands.aWa(c),e=h.wu[c.cmd];e&&e.canUndo()&&!d&&!c.yTa&&(b=h.getSheetFromName(c.sheetName),b&&(c.sheetId=b._id),h.undoManager().Cc(c,a.s4)),1!==a.s4&&2!==a.s4||h.GKc(a)}),j.Commands.uv(d),a.ao(h,"init"),e=0;e<b;e++)f=h.vv(h.wv(e)),h.sheets.push(f),f.Ls(h);g=h.sheets[h.eq],g&&g.isSelected(!0),h.suspendPaint(),c&&h.ws(c),h.uu=new n.S4(h),h.resumePaint()},a.prototype.hitTest=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,I,J,K,L,M,N=this,O=N.WJc(),P=N.YJc,Q=N.kKc,R=N.nKc,S=g.GC$(N.getHost()).width(),T=g.GC$(N.getHost()).height();if(a<0||a>S||b<0||b>T)return H;if(d=N.oia(),e=N.options.scrollbarAppearance===r.ScrollbarAppearance.mobile){if(f=g.GC$(N.wKc).offset(),h=Ta(Q,f,d,a,b))return h;if(i=g.GC$(N.vKc).offset(),j=Ua(R,i,d,a,b))return j}if(O&&(k=O.Vs(),l=O.Dr(),m=k.left-d.left,n=k.top-d.top,a>m&&a<l.width+m&&b>n&&b<l.height+n))return{worksheetHitInfo:O.hitTest(a-m,b-n,!1,c),x:a,y:b};if(o=g.GC$(P.Ws()).offset(),p=P.Dr(),q=o.left-d.left,s=o.top-d.top,a>q&&a<p.width+q&&b>s&&b<p.height+s){switch(t=P.hitTest(a-q,b-s),u={},v=t.index,w=N.XJc(v),x=w&&w.name(),y=H,w&&Za(w.wYc)&&(y=w.wYc),t.type){case"navButton":u={navButton:t.element};break;case"sheetTab":u={sheetTab:{sheetName:x||t.element,sheetIndex:v}},y!==H&&(u.sheetTab.sheetType=y);break;case"resize":u={resize:!0};break;default:u={blank:!0}}return{tabStripHitInfo:u,x:a,y:b}}return z=g.GC$(Q.Bv()).offset(),A=Q.pia(),B=z.left-d.left,C=z.top-d.top,a>B&&a<A.width+B&&b>C&&b<A.height+C?{horizontalScrollBarHitInfo:{element:Q.hitTest(a-B,b-C).element},x:a,y:b}:(D=g.GC$(R.Bv()).offset(),E=R.pia(),F=D.left-d.left,G=D.top-d.top,a>F&&a<E.width+F&&b>G&&b<E.height+G?{verticalScrollBarHitInfo:{element:R.hitTest(a-F,b-G).element},x:a,y:b}:(I=g.GC$(N.HKc).offset(),J=parseInt(N.HKc.style.width.substr(0,N.HKc.style.width.indexOf("px")),10),K=parseInt(N.HKc.style.height.substr(0,N.HKc.style.height.indexOf("px")),10),L=I.left-d.left,M=I.top-d.top,a>L&&a<J+L&&b>M&&b<K+M?{footerCornerHitInfo:{element:"footerCorner"},x:a,y:b}:void 0))},a.prototype.oia=function(){var a=this,b;return b=qa?qa(a.qo).offset():g.GC$(a.qo).offset(),b?(b.top+=G.body.clientTop||0,b.left+=G.body.clientLeft||0):b={top:0,left:0},b},a.prototype.T3=function(a){var b=this.options,c=a||{};c=w(!0,{},Ga,c),v(c,function(a,c){b.hasOwnProperty(a)&&(b[a]=c)})},a.prototype.xv=function(){var a=this;return!a.Ks&&a.qo&&(a.Ks=z(Z),g.GC$(a.Ks).css({position:"relative",left:0,top:0,height:0}).attr(ta,"gcLayerContainer"),g.GC$(a.qo).prepend(a.Ks)),a.Ks},a.prototype.wv=function(a){var b,c,d,e,f,g,h=this,i=h.getSheetCount();h.lv<i?h.lv=i:h.lv++,(y(a)||a<h.lv)&&(a=h.lv),b=!1,d=h.sheets;do for(c=(Ba().SHEET_NAME||"Sheet")+(a+1),e=d.length,f=0;f<e;f++)if(g=d[f]){if(g.name().toUpperCase()===c.toUpperCase()){a++,b=!0;break}b&&(b=!1)}while(b);return c},a.prototype.vv=function(a){return new o.Worksheet(a)},a.prototype.setHost=function(a){this.ws(a)},a.prototype.ws=function(b){var c=this;b&&(c.qo=b,c.IKc(),c.qm(),c.JKc(),c.KKc(),c.LKc(),c.MKc(),c.NKc(),c.OKc(),c.PKc(),c.QKc(),c.RKc(),c.BKc(),c.SKc(),c.TKc(),c.UKc(),c.VKc(),c.v8a(),c.fq(),c.Rv(b),a.ao(c,"setHost",b))},a.prototype.IKc=function(){var a=this,b=a.qo;qa&&qa(b).data(sa,a),g.GC$(b).data(sa,a).attr(ta,"gcSpread").addClass(ua).css(wa,va)},a.prototype.qm=function(){F.Yl.qm()},a.prototype.JKc=function(){var a=this;a.cultureChangedHandler=function(){a.Av()},G.addEventListener(ra,a.cultureChangedHandler)},a.prototype.KKc=function(){var a=this;a.WKc(),a.XKc(),a.YKc()},a.prototype.XKc=function(){var a,b,c,d,e,f=this,g=f.qo,h=z($),i=h.style;for(h.cellSpacing="0px",h.cellPadding="0px",h.border="0",i.width=aa,i.height=aa,i.border="0",i.margin="0",i.borderCollapse="collapse",i.float="left",a=0;a<3;a++){for(b=z("tr"),c=0;c<2;c++)d=z("td"),e=d.style,e.padding="0",e.border="0",b.appendChild(d);h.appendChild(b)}g.appendChild(h),f.sj=h},a.prototype.WKc=function(){var a=this,b=a.qo,c=z(Z),d=c.style;d.width="0",d.height="0",d.float="left",b.appendChild(c),a.ZKc=c},a.prototype.YKc=function(){var a=this,b=a.qo,c=z(Z),d=c.style;d.width="0",d.height="0",d.float="left",b.appendChild(c),a.$Kc=c},a.prototype.LKc=function(){var a=this,b=a.qo,c=a.sj,d=c.rows[1].cells[0],e=z(Z);e.id=b.id+"vp",g.GC$(d).append(e),a.xs=e},a.prototype.MKc=function(){var a=this,b=a.sj,c=b.rows[1].cells[1],e=a.options,f=e.scrollByPixel,h=e.scrollbarAppearance,i=f?r.ScrollType.pixels:r.ScrollType.continuous,j=new d.hv((!1),H,H,H,H,H,i,h,function(){a.cec(!0)}),k=z(Z),l=j.Bv();g.GC$(k).append(l),a.nKc=j,a.vKc=k,a._Kc=c},a.prototype.aLc=function(){var a=this,b=a.nKc.Bv();g.GC$(b).bind(S+X,function(b,c){var e=c.scrollEventType;b.data=a,c.scrollOrientation===d.ScrollOrientation.verticalScroll&&(e===r.Nxb.smallDecrement||e===r.Nxb.smallIncrement||e===r.Nxb.largeDecrement||e===r.Nxb.largeIncrement||e===r.Nxb.thumbTrack?Fa.Dv(b,c):e===r.Nxb.thumbPosition&&Fa.Ev(b))}).bind(N+X,function(b){b.data=a,Fa.Fv(b)}).bind(P+X,function(b){b.data=a,Fa.Gv(b)}).bind(O+X,function(b){b.data=a,b.scrollbar=a.nKc,Fa.ggc(b)})},a.prototype.NKc=function(){var a,b,c,d,e=this,f=e.sj,h=f.rows[2].cells[0],i=z($),j=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",j.border="0",j.margin="0",g.GC$(i).css("user-select",da),a=z("tr"),b=0;b<2;b++)c=z("td"),d=c.style,d.padding="0",d.border="0",a.appendChild(c);i.appendChild(a),g.GC$(h).append(i),e.bLc=i},a.prototype.OKc=function(){var a=this,b=a.qo,c=z(Z),d=c.style;d.width=""+a.Iv()*g.GC$(b).width()+_,d.height=""+a.xJc()+_,d.fontSize="10pt",d.fontFamily="Arial",a.cLc=c},a.prototype.PKc=function(){var a=this,b=a.bLc,c=b.rows[0].cells[1],e=a.options,f=e.scrollByPixel,h=e.scrollbarAppearance,i=f?r.ScrollType.pixels:r.ScrollType.continuous,j=new d.hv((!0),H,H,H,H,H,i,h,function(){a.cec(!1)}),k=j.Bv(),l=z(Z);g.GC$(l).append(k),a.kKc=j,a.wKc=l,a.dLc=c},a.prototype.eLc=function(){var a=this,b=a.kKc.Bv();g.GC$(b).bind(S+X,function(b,c){var e=c.scrollEventType;b.data=a,c.scrollOrientation===d.ScrollOrientation.horizontalScroll&&(e===r.Nxb.smallDecrement||e===r.Nxb.smallIncrement||e===r.Nxb.largeDecrement||e===r.Nxb.largeIncrement||e===r.Nxb.thumbTrack?Fa.Lv(b,c):e===r.Nxb.thumbPosition&&Fa.Mv(b))}).bind(N+X,function(b){b.data=a,Fa.Nv(b)}).bind(P+X,function(b){b.data=a,Fa.Gv(b)}).bind(O+X,function(b){b.data=a,b.scrollbar=a.kKc,Fa.ggc(b)})},a.prototype.QKc=function(){var a=this;a.fLc(),a.gLc()},a.prototype.fLc=function(){var a=this,b=a.sj,c=b.rows[0].cells[1],d=z(Z);g.GC$(c).append(d),a.hLc=d},a.prototype.gLc=function(){var a=this,b=a.sj,c=b.rows[2].cells[1],d=z(Z);g.GC$(c).append(d),a.HKc=d},a.prototype.SKc=function(){var a=this;a.ku=new Fa(a)},a.prototype.RKc=function(){var a=this;a.aLc(),a.eLc()},a.prototype.BKc=function(){var a,b,c,d=this,e=d.options,f=e.scrollbarAppearance;f===r.ScrollbarAppearance.mobile&&(a=d.qo,b=d.vKc,c=d.wKc,g.GC$(b).bind(Q,function(){d.nKc.Jwa(r.ScrollbarState.active)}).bind(R,function(){d.nKc.Jwa(r.ScrollbarState.inactive)}),g.GC$(c).bind(Q,function(){d.kKc.Jwa(r.ScrollbarState.active)}).bind(R,function(){d.kKc.Jwa(r.ScrollbarState.inactive)}),g.GC$(a).bind(Q,d.fec).bind(R,d.gec))},a.prototype.CKc=function(){var a=this,b=a.vKc,c=a.wKc;b&&(g.GC$(b).unbind(Q).unbind(R),a.ku.Wdc(!0)),c&&(g.GC$(c).unbind(Q).unbind(R),a.ku.Wdc(!1)),g.GC$(a.qo).unbind(Q,a.fec).bind(R,a.gec)},a.prototype.fec=function(){g.GC$(this).find("."+ka).addClass(na)},a.prototype.gec=function(){g.GC$(this).find("."+ka).removeClass(na)},a.prototype.TKc=function(){var a=this;a.DKc(),a.AKc()},a.prototype.O6c=function(){var a,b=this,c=b.YJc,d=b.options.tabStripPosition,e=b.options.tabStripVisible,f=0,g=0;return c&&e&&(a=c.Dr(),d===r.TabStripPosition.top?g=a.height:d===r.TabStripPosition.left&&(f=a.width)),{left:f,top:g}},a.prototype.P6c=function(){var a=this,b=a.xv(),c=a.O6c();g.GC$(b).css({left:c.left,top:c.top})},a.prototype.AKc=function(){var a,b,c,d,e,f=this,h=f.qo;f.ku&&(a=f.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,b=f._Kc,c=f.dLc,d=f.vKc,e=f.wKc,g.GC$(d).removeAttr("style"),g.GC$(e).removeAttr("style"),a?(d.style.position="absolute",d.style.top="0px",d.style.left="0px",g.GC$(d).addClass(ka+" "+ma),g.GC$(h).css("position","relative").append(d),e.style.position="absolute",e.style.top="0px",e.style.left="0px",g.GC$(e).addClass(ka+" "+la),g.GC$(h).append(e)):(g.GC$(b).append(d),g.GC$(c).append(e),g.GC$(d).removeClass(ka+" "+oa+" "+ma+" "+pa),g.GC$(e).removeClass(ka+" "+oa+" "+la+" "+pa),g.GC$(h).css("position","auto")))},a.prototype.DKc=function(){var a,b=this,c=b.sj,d=b.ZKc,e=b.$Kc,f=b.bLc,h=b.cLc,i=b.options.tabStripPosition,j=b.options.tabStripVisible;i===r.TabStripPosition.bottom?a=f.rows[0].cells[0]:i===r.TabStripPosition.top?a=c.rows[0].cells[0]:i===r.TabStripPosition.left?a=d:i===r.TabStripPosition.right&&(a=e),i!==r.TabStripPosition.bottom&&i!==r.TabStripPosition.top&&j?c.style.tableLayout="fixed":c.style.tableLayout="",g.GC$(a).append(h)},a.prototype.Rv=function(a){var b=this,c="tabindex",d=E(g.GC$(a).attr(c),10)||0,e=z(Z);g.GC$(e).css({position:ga,overflow:"hidden"}).attr(ta,"gcSheetFocusElementForTab").attr(c,d).bind(U,function(){b.Sv||h.sJc(b).zt(),b.Sv=!1}),a.insertBefore(e,H),b.Tv=e},a.prototype.UKc=function(){var a=this,b=function(){a.Pv()};g.GC$(F).bind(T+V,b),a.oTa=b},a.prototype.VKc=function(){var a=this,b=h.sJc(a);b&&b.ws(a.xs)},a.prototype.Uv=function(){var a=this,b=a.Tv;b&&(a.Sv=!0,b.focus())},a.prototype.hgc=function(){var a,b,c,d,e,f=this.getActiveSheet();if(f)if(h.Vl.Wl(f)){if(b=this.qo)for(c=document.activeElement,d=document.body,e=c;e;){if(e===b){a=c;break}if(e===d)break;e=e.parentElement}}else f.Xs&&(a=f.Xs);return a},a.prototype.dgc=function(a){var b=this;b.igc&&(F.clearTimeout(b.igc),b.igc=H),b.igc=F.setTimeout(function(){var c=b.hgc();c&&c.setAttribute("aria-label",a),F.clearTimeout(b.igc),b.igc=H},50)},a.prototype.no=function(){var b,c,d,e,f,i,j,k=this,l=k.kKc,n=k.nKc,o=k.sheets,p=k.options.scrollbarAppearance===r.ScrollbarAppearance.mobile;for(k.vXc(),h.En.Tn(k),h.Ul.no(),k.oTa&&g.GC$(F).unbind(T+V,k.oTa),k.oTa=H,k.Zv&&clearTimeout(k.Zv),l&&l.dispose(),n&&n.dispose(),k.mu(),k.xw(),h.Vl.Xl()===k.getActiveSheet()&&h.Vl.Zl(H),b=0;b<o.length;b++)o[b].no(!0);for(o.splice(0,o.length),c=k.pJc,b=0;b<c.length;b++)c[b].no(!0);c.splice(0,c.length),d=k.uu,d&&(d.no(),k.uu=H),e=k.qo,i="class",j="unselectable",e&&(f=g.GC$(e),G.removeEventListener(ra,k.cultureChangedHandler),f.html("").removeAttr(ta).removeClass(ua),f.attr(i)||f.removeAttr(i),f.attr(j)||f.removeAttr(j),f.data(sa)&&f.data(sa,H),qa&&qa(e).data(sa)&&qa(e).data(sa,H)),p&&k.CKc(),k.wKc=H,k.vKc=H,k.pv&&(k.pv.no(),k.pv=H),k.YJc&&(k.YJc.no(),k.YJc=H),a.ao(k,"dispose"),k.Tv&&(g.GC$(k.Tv).unbind(U),k.Tv=H),k.Wu&&(k.Wu.dispose(),k.Wu=H,k.yv=H,k.zv=H),k.bt&&(k.bt.no(),k.bt=H),m.To.no(),k.wu&&(k.wu.no(),k.wu=H),k.ku&&(k.ku.no(),k.ku=H)},a.prototype.mu=function(){var a,b,c,d,e,f,h=this,i=h.sheets;for(g.GC$(h.sv).unbind(V),a=0;a<i.length;a++)b=i[a],b.mu();for(c=h.pJc,d=0,e=c;d<e.length;d++)f=e[d],f.mu();h.rv&&(h.rv.length=0)},a.prototype.vXc=function(){var a,b,c,d=this,e=d.wXc;if(e)for(a=0,b=e;a<b.length;a++)c=b[a],c.close&&c.close();d.wXc=[]},a.prototype.v8a=function(){var a=this,b=E(h.Im.Lm("").zIndex),c=b!==a.Vv;c&&a.iLc(b),a.jLc(c),a.aZ(),a.kLc()},a.prototype.iLc=function(a){this.Vv=a},a.prototype.jLc=function(a){var b=this,c=b.qo,d=b.Vv,e=c.getAttribute("id")+"_tabStrip",f=b.YJc;f&&!a?(f.TJc(),f.repaint()):(f&&f.no(),f=d>2007?new k.iv(e):new l.jv(e),b.YJc=f,f.Yv(b),f.ws(b.cLc))},a.prototype.aZ=function(){var a=this,b=a.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,c=a.xJc(),d=a.Wv(),e=a.Xv();b?a.hec():(Qa(a.vKc,e,d),Ra(a.wKc,c,d))},a.prototype.kLc=function(){var a=this;Sa(a.HKc),Sa(a.hLc)},a.prototype.Pv=function(){var a=this,b=a.Zv;b&&clearTimeout(b),a.Zv=F.setTimeout(function(){h.En.Un(),a.fq(),a.Zv=H},100)},a.prototype.fq=function(){var a=this;a.kv||(a.kv=!0,a.$v(),a.kv=!1)},a.prototype.$v=function(){var a=this,b=a.qo;b&&(a.lLc(),a.mLc(),a.nLc(),a.oLc(),a.u7c(),a.qLc(),a.rLc(),a.sLc(),a.tLc(),a.uLc(),a.vLc(),a.P6c(),a.wLc())},a.prototype.lLc=function(){var a,b,c,d,e,f,h,i,j,k=this,l=k.ZKc;l&&(a=l.style,b=k.options,c=b.tabStripVisible,d=b.tabStripPosition,e=c?b.tabStripWidth:0,f=k.qo,h=g.GC$(f).height(),d===r.TabStripPosition.left?(i=e,j=h):(i=0,j=0),a.width=""+i+_,a.height=""+j+_)},a.prototype.mLc=function(){var a,b,c,d,e,f,h,i,j=this,k=j.sj;k&&(a=k.style,b=j.options,c=b.tabStripVisible,d=b.tabStripPosition,e=b.tabStripWidth,f=g.GC$(j.qo).width(),!c||d!==r.TabStripPosition.left&&d!==r.TabStripPosition.right?h=f+_:(i=K(Ya(j.qo)),h=i-e+_),a.width=h)},a.prototype.oLc=function(){var a,b,c,d,e,f,h,i,j,k=this,l=k.$Kc;l&&(a=l.style,b=k.options,c=b.tabStripVisible,d=b.tabStripPosition,e=c?b.tabStripWidth:0,f=k.qo,h=g.GC$(f).height(),d===r.TabStripPosition.right?(i=e,j=h):(i=0,j=0),a.width=""+i+_,a.height=""+j+_)},a.prototype.nLc=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,s=this,t=s.qo,u=g.GC$(t),v=s.xs;v&&(a=v.style,b=u.width(),c=u.height(),d=s.Xv(),e=s.xJc(),f=s.options,h=f.showVerticalScrollbar,i=f.showHorizontalScrollbar,j=f.scrollbarAppearance,k=f.tabStripVisible,l=f.tabStripPosition,m=k?f.tabStripWidth:0,n=j===r.ScrollbarAppearance.mobile,o=l===r.TabStripPosition.left||l===r.TabStripPosition.right,p=o?K(Ya(t)):b,h&&!n&&(p-=d),o&&(p-=m),q=c,l===r.TabStripPosition.top?(i&&!n&&(q-=e),k&&(q-=e)):(i&&!n||k&&l===r.TabStripPosition.bottom)&&(q-=e),q<2&&(q=2),a.width=p+_,a.height=q+_)},a.prototype.u7c=function(a){var b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,s,t,u,v=this,w=v.qo,x=g.GC$(w),z=v.xs;z&&(y(a)&&(a=x.width()),b=g.GC$(z).height(),c=v.kKc,d=v.nKc,e=v.options,f=e.showVerticalScrollbar,h=e.showHorizontalScrollbar,i=e.scrollbarAppearance,j=e.tabStripVisible,k=e.tabStripPosition,l=j?e.tabStripWidth:0,m=i===r.ScrollbarAppearance.mobile,n=v.Wv(),o=v.Xv(),p=v.xLc(),f?(g.GC$(v.vKc).show(),g.GC$(d.Bv()).show()):(g.GC$(v.vKc).hide(),g.GC$(d.Bv()).hide()),h?(g.GC$(v.wKc).show(),g.GC$(c.Bv()).show()):(g.GC$(v.wKc).hide(),g.GC$(c.Bv()).hide()),q=n,s=b,d.Vo(q),d._v(s),t=a,k!==r.TabStripPosition.left&&k!==r.TabStripPosition.right||(t-=l),j&&!m&&k===r.TabStripPosition.bottom&&(t-=p),f&&!m&&(t-=o),t<=0&&(t=1),u=n,h||j||k!==r.TabStripPosition.bottom||(u=0),c.Vo(t),c._v(u))},a.prototype.xLc=function(){var a,b=this,c=b.xs,d=b.options,e=d.tabStripPosition,f=d.tabStripWidth,h=g.GC$(c).width();return e===r.TabStripPosition.bottom||e===r.TabStripPosition.top?(a=I(b.Iv()*h),e===r.TabStripPosition.bottom&&a===h&&(a=h-1)):a=f,a},a.prototype.qLc=function(){var a,b,c,d,e,f,h,i=this,j=i.qo,k=g.GC$(j).height(),l=i.cLc;l&&(a=l.style,b=i.options,c=b.tabStripVisible,d=b.tabStripPosition,e=i.xJc(),f=i.xLc(),h=d===r.TabStripPosition.bottom||d===r.TabStripPosition.top?e:k,c||(h=0),a.width=""+f+_,a.height=""+h+_)},a.prototype.rLc=function(){var a,b,c,d,e=this,f=e.hLc,h=e.HKc,i=e.options,j=i.showVerticalScrollbar,k=i.showHorizontalScrollbar,l=i.tabStripVisible,m=i.tabStripPosition,n=i.scrollbarAppearance===r.ScrollbarAppearance.mobile,o=e.Xv(),p=e.xJc();m===r.TabStripPosition.top?(a=j&&!n?o:0,b=l?p:0):(a=0,b=0),g.GC$(f).css("width",a+_),g.GC$(f).css("height",b+_),c=j&&!n?o:0,k||l&&m===r.TabStripPosition.bottom?(d=p,n&&(l?l&&m!==r.TabStripPosition.bottom&&(d=0):d=0)):d=0,g.GC$(h).css("width",c+_),g.GC$(h).css("height",d+_)},a.prototype.sLc=function(){var a,b,c,d,e,f=this;f.xs&&(a=f.sj,b=f.options,c=b.scrollbarAppearance===r.ScrollbarAppearance.mobile,d=b.showVerticalScrollbar,e=[g.GC$(f.xs).width(),f.Xv()],!c&&d||(e[1]=0),a.rows[0].cells[0].style.width=e[0]+_,a.rows[0].cells[1].style.width=e[1]+_)},a.prototype.uLc=function(){var a=this,b=a.options,c=b.scrollbarAppearance===r.ScrollbarAppearance.mobile;c&&a.hec(),a.Ut(),a.Xt(),c&&(a.nKc.Jwa(r.ScrollbarState.hide),a.kKc.Jwa(r.ScrollbarState.hide))},a.prototype.vLc=function(){var a=this,b=a.options,c=b.tabStripVisible;c?g.GC$(a.cLc).show():g.GC$(a.cLc).hide(),a.YJc&&a.YJc.fq()},a.prototype.tLc=function(a){var b,c,d;void 0===a&&(a=!0),b=this,c=h.sJc(b),c?(0===c.lq&&(c.lq=c._t()),0===c.qq&&(c.qq=c.$t()),a&&c.fq()):(d=b.getActiveSheetTab(),d&&d.fq())},a.prototype.wLc=function(){var a,b=this,c=h.sJc(b);c&&(c.invalidateLayout(),c.repaint()),a=b.X6c(),a&&!b.aw&&(b.aw=!0,setTimeout(function(){delete b.aw,b.$v()},1))},a.prototype.X6c=function(){var a,b,c,d=this,e=g.GC$(d.qo),f=e.width(),h=2,i=e.width(),j=f!==i&&L(f-i)>h,k=!1,l=d.ZKc,m=d.$Kc,n=d.sj;return l&&m&&n&&(a=g.GC$(l).width(),b=g.GC$(m).width(),c=g.GC$(n).width(),k=L(a+c+b-i)>h),j||k},a.prototype.hec=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,z,A,B,C,D,F,G,H,I=this;y(I.qo)||(a=g.GC$(I.qo),b=I.getActiveSheet(),b&&(c=g.GC$(I.vKc),d=g.GC$(I.wKc),e=b.am(),f=a.width(),h=a.height(),i=2,j=I.options,k=j.tabStripVisible,l=j.showVerticalScrollbar,m=j.tabStripPosition,n=k?j.tabStripWidth:0,o=k?I.xJc():0,p=e.x+e.Br,q=e.y+e.Cr,s=l?c.width():0,t=h-q,m!==r.TabStripPosition.bottom&&m!==r.TabStripPosition.top||(t-=o),u=0,m===r.TabStripPosition.right&&(u+=n),v=q,m===r.TabStripPosition.top&&(v+=o),w=E(c.css("padding-top")),x=E(c.css("padding-bottom")),z=t-w-x,A=f-s-p,m!==r.TabStripPosition.left&&m!==r.TabStripPosition.right||(A-=n),B=d.height(),C=0,m===r.TabStripPosition.bottom&&(C+=o),D=p,m===r.TabStripPosition.left&&(D+=n),F=E(d.css("padding-left")),G=E(d.css("padding-right")),H=A-F-G-i,I.nKc.Vo(s),I.nKc._v(z),I.kKc.Vo(H),I.kKc._v(B),c.css(["height","left","right","top"],[t,"auto",u,v]),d.css(["width","top","bottom","left"],[A,"auto",C,D])))},a.prototype.Ut=function(){var a=this,b=a.WJc(),c=a.options;b&&b.Ut(c.scrollbarMaxAlign,c.scrollbarShowMax,a.kKc)},a.prototype.Xt=function(){var a=this,b=a.WJc(),c=a.options;b&&b.Xt(c.scrollbarMaxAlign,c.scrollbarShowMax,a.nKc)},a.prototype.aq=function(){var a,b=this,c=b.qo;c&&(a=b.v7c(),b.qLc(),b.u7c(a),b.tLc(!1),b.uLc(),b.vLc())},a.prototype.v7c=function(){var a,b,c=this.qo,d=c.parentNode;return d&&(b=d.style.display||getComputedStyle(d).display,"flex"===b&&(a=g.GC$(c).width())),a},a.prototype.suspendPaint=function(){var a,b,c,d,e,f,g=this,h=g.YJc,i=g.sheets,j=g.pJc;for(g.xD++,a=0,b=i;a<b.length;a++)c=b[a],c.suspendPaint();for(d=0,e=j;d<e.length;d++)f=e[d],f.suspendPaint();h&&h.fw()},a.prototype.resumePaint=function(){var a,b,c,d,e,f,g=this,h=g.YJc,i=g.sheets,j=g.pJc;for(g.xD-=g.xD>0?1:0,a=0,b=i;a<b.length;a++)c=b[a],c.resumePaint();for(d=0,e=j;d<e.length;d++)f=e[d],f.resumePaint();h&&h.gw()},a.prototype.isPaintSuspended=function(){return this.xD>0},a.prototype.Ys=function(){var a,b,c,d,e,f,j=this,k=j.options.backgroundImage,l=j.options.backgroundImageLayout,m=h.sJc(j);if(m&&k&&(a=g.GC$(m.Ws()),b=void 0,a.css({"background-image":"url('"+k+"')","background-repeat":"no-repeat"}),!y(l))){b=j.bt,b||(b=j.bt=new i.oo(function(){j.bt&&j.Ys()}));try{b.ko(k)?(c=b.lo(k),d=m.Dr(),e=d.width,f=d.height,h.Ul.ql(m.Ws(),e,f,c.width,c.height,l)):b.fo(k)}catch(a){}}},a.prototype.hw=function(a){var b=this,c=a.name(),d=b.getSheetIndex(c);y(d)&&(d=b.getSheetCount()+b.getSheetTabIndex(c)),b.YJc.iw(d)},a.prototype.startSheetIndex=function(a){var b=this,c=b.YJc;return 0===arguments.length?c?c.gq:0:(c&&(c.hE(a)||(a=c.jw(a),a===-1&&(a=c.rw(a))),c.gq=a),b.aq(),b)},a.prototype.Iv=function(){var a,b,c,d,e,f=this,h=f.options,i=f.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,j=h.tabStripPosition;return h.showHorizontalScrollbar&&!i&&j===r.TabStripPosition.bottom?(a=h.tabStripRatio,isNaN(a)?.5:(b=0,c=f.xs,d=f.YJc,c&&d&&(e=g.GC$(c).width(),b=d.AJc()/e),a<b?a=b:a>1&&(a=1),a)):1},a.prototype.destroy=function(){this.oTa&&g.GC$(F).unbind(T+V,this.oTa),this.no()},a.prototype.repaint=function(){var a,b=this,c=b.YJc;c&&c.repaint(),a=h.sJc(b),a&&a.repaint()},a.prototype.refresh=function(){var a=this;a.qo&&(h.Im.Nm(),a.v8a(),a.fq(),a.repaint())},a.prototype.getHost=function(){return this.qo},a.prototype.invalidateLayout=function(){var a=h.sJc(this);a&&a.invalidateLayout()},a.prototype.addNamedStyle=function(a){this.Kq(a);var b=h.sJc(this);b&&b.$p()},a.prototype.Kq=function(a){if(a){if(!a.name)throw Error(Ba().Exp_EmptyNamedStyle);var b=a.name.toUpperCase();this.Lq[b]=a}},a.prototype.getNamedStyle=function(a){return this.Mq(a,!0)},a.prototype.Mq=function(a,b){var c,d=this.Lq;return d&&a?(a=a.toUpperCase(),c=d[a],c&&b&&this.Jq(),c):H},a.prototype.Jq=function(){var a,b,c,d=this.sheets;for(a=0,b=d;a<b.length;a++)c=b[a],c.Jq()},a.prototype.removeNamedStyle=function(a){var b,c,d=this.Lq;d&&a&&(a=a.toUpperCase(),d.hasOwnProperty(a)&&(b=d[a].formatter,b&&"string"==typeof b&&this.QHb[b]&&this.RHb(b),delete d[a],this.Jq(),c=h.sJc(this),c&&c.$p()))},a.prototype.getNamedStyles=function(){var a=[],b=this.Lq;return b&&v(b,function(b,c){a.push(c)}),this.Jq(),a},a.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this.eq]:H},a.prototype.getActiveSheetTab=function(){return this.pJc&&this.pJc.length>0?this.pJc[this.xKc]:H},a.prototype.setActiveSheet=function(a){var b=this.getActiveSheet(),c=this.getActiveSheetTab();this.lw(a,2),this.SHb(b),this.yLc(c)},a.prototype.setActiveSheetTab=function(a){var b=this.getActiveSheet(),c=this.getActiveSheetTab();"number"==typeof a?this.hKc(a,2):"string"==typeof a&&this.zLc(a,2),this.SHb(b),this.yLc(c)},a.prototype.lw=function(a,b){var c,d=this.sheets;for(c=0;c<d.length;c++)if(d[c].name()===a){this.dq(c,b);break}},a.prototype.zLc=function(a,b){var c,d=this.pJc;for(c=0;c<d.length;c++)if(d[c].name()===a){this.hKc(c,b);break}},a.prototype.getActiveSheetIndex=function(){return this.eq},a.prototype.getActiveSheetTabIndex=function(){return this.xKc},a.prototype.setActiveSheetIndex=function(a){var b=this.getActiveSheet(),c=this.getActiveSheetTab();this.dq(a,2),this.SHb(b),this.yLc(c)},a.prototype.dq=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o;typeof a===M&&(e=this,a!==e.eq&&(f=e.sheets[a],f&&f.visible()&&(g=h.Ul.rl(),(g.ipad||g.iphone)&&(i=e.mw,i&&(new Date).valueOf()-i<300)||(j=e.getActiveSheet(),k=j,k||(l=e.getActiveSheetTab(),k=l&&l.kj),m={oldSheet:k,newSheet:f,needTriggerSheetChange:!0},Ma(e,m),n={oldSheet:k,newSheet:f,cancel:!1},o=m.needTriggerSheetChange&&d,o&&La(e,n),n.cancel===!1&&(e.eq=a,e.ALc(),f!==j&&(j&&(j.no(!1),j.charts&&j.charts.all().forEach(function(a){a.clearflexDVs()})),e.nw(f,b,!1,o,c)),e.fq(),Na(e,k,f),o&&Ka(e,k,f)),(g.ipad||g.iphone)&&(e.mw=(new Date).valueOf())))))},a.prototype.hKc=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o;typeof a===M&&(e=this,a!==e.xKc&&(f=e.pJc[a],f&&f.visible()&&(g=f.kj,i=h.Ul.rl(),(i.ipad||i.iphone)&&(j=e.mw,j&&(new Date).valueOf()-j<300)||(k=e.getActiveSheetTab(),l=k?k.kj:e.getActiveSheet(),m={oldSheet:l,newSheet:g,needTriggerSheetChange:!0},Ma(e,m),n={oldSheet:l,newSheet:g,cancel:!1},o=m.needTriggerSheetChange&&d,o&&La(e,n),n.cancel===!1&&(e.xKc=a,
e.BLc(),f!==k&&(k&&k.no(!1),e.CLc(f,b,!1,o,c)),e.fq(),Na(e,l,g),o&&Ka(e,l,g)),(i.ipad||i.iphone)&&(e.mw=(new Date).valueOf())))))},a.prototype.nw=function(a,b,c,d,e){var f,g,i;c||a.ws(this.xs),f=h.Vl.Xl(),g=f&&f.parent===this,i=2===b?g:1===b,h.Vl.Zl(H),!this.mv&&i&&a.zt(e),a.qs(),a.os()},a.prototype.CLc=function(a,b,c,d,e){var f,g,i;c||a.ws(this.xs),f=h.Vl.Xl(),g=f&&f.parent===this,i=2===b?g:1===b,h.Vl.Zl(H),!this.mv&&i&&a.zt(e),a.qs(),a.os()},a.prototype.SHb=function(a){var b=this.getActiveSheet();a&&a.DHb(!1,!1),b&&b.DHb(!0,!1)},a.prototype.yLc=function(a){var b=this.getActiveSheetTab();a&&a.DHb(!1,!1),b&&b.DHb(!0,!1)},a.prototype.addSheet=function(a,b){var c=this.getActiveSheet(),d=this.getActiveSheetTab();this.ow(a,2,b),this.SHb(c),this.yLc(d)},a.prototype.addSheetTab=function(a,b,c){var d=this.getActiveSheet(),e=this.getActiveSheetTab(),f=this.DLc(b,c);if(f)return this.suspendPaint(),this.ELc(a,2,f),this.SHb(d),this.yLc(e),this.resumePaint(),f},a.prototype.ow=function(a,b,c){var d,e,f,g,h,i,j,k,l=this;if(c||(c=l.vv(l.wv(a))),e=l.sheets,f=e.length,c.name()){for(d=0;d<f;d++)if(e[d].name()===c.name())throw Ba().Exp_NotSupported}else c.cq(l.wv(a));for(l.pw(c),g=l.getActiveSheet(),h=l.eq,i=f-a,j=[],d=0;d<i&&f>0;d++)j.push(e.pop());for(e.push(c),c.Ls(l);j.length>0;)e.push(j.pop());f=e.length,1===f?(l.xs&&c.ws(l.xs),l.eq=0):(h<0&&l.YJc&&(h=l.YJc.jw(h)),l.eq=h),l.ALc(),k=l.getActiveSheet(),k!==g&&(g&&g.no(!1),k&&l.nw(k,b,1===f,!0),l.fq()),l.YJc&&(l.YJc.gq<0&&(l.YJc.gq=l.eq),l.YJc.repaint())},a.prototype.ELc=function(a,b,c){var d,e,f,g,h,i,j,k,l;if(c){for(d=this,f=d.pJc,g=f.length,e=0;e<g;e++)if(f[e].name()===c.name())throw Ba().Exp_NotSupported;for(d.pw(c),h=d.getActiveSheetTab(),i=d.xKc,j=g-a,k=[],e=0;e<j&&g>0;e++)k.push(f.pop());for(f.push(c),c.Ls(d);k.length>0;)f.push(k.pop());g=f.length,1===g?(d.xs&&c.ws(d.xs),d.xKc=0):(i<0&&d.YJc&&(i=d.YJc.jw(i)),d.xKc=i),d.BLc(),l=d.getActiveSheetTab(),l!==h&&(h&&h.no(!1),l&&d.CLc(l,b,1===g,!0),d.fq()),d.YJc&&(d.YJc.gq<0&&(d.YJc.gq=d.xKc),d.YJc.repaint())}},a.prototype.removeSheet=function(a){this.qw(a,2)},a.prototype.removeSheetTab=function(a){"string"==typeof a&&(a=this.getSheetTabIndex(a)),this.FLc(a,2)},a.prototype.qw=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.sheets,o=m.Wu,p=m.YJc,q=n.length;if(isNaN(a)||a<0||a>=q)throw Error(Ba().Exp_IndexOutOfRange);if(c=a<=m.eq||a===q-1,d=m.getActiveSheet(),a<m.eq&&m.eq--,e=n[a],e.mu(),n.splice(a,1),q=n.length,0===q)m.eq=-1;else if(m.eq>=q)m.eq=p.rw(q);else{for(f=void 0,f=m.eq;f<q;f++)if(n[f].visible()){m.eq=f;break}f>=q&&(m.eq=p.rw(q))}m.ALc(),c&&(g=n[m.eq],d!==g&&(d&&d.no(!1),g&&m.nw(g,b,!1,!0))),o&&(o.suspend(),h=e.yj(),h.VDc=a,o.removeSource(h),i=e.fDc,o.removeSource(i),j=e.hDc,o.removeSource(j),k=e.Vva,y(k)||o.removeSource(k),o.resume()),e.no(!0,m.eq!==-1),x&&!o.Dh&&m.sheets&&m.sheets.length>0&&(l=m.sheets[0],o.initParserContext(l.yj())),p&&(p.gq>=q?m.startSheetIndex(p.rw(q)):p.gq<0?m.startSheetIndex(p.jw(-1)):m.fq())},a.prototype.FLc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.pJc,o=m.Wu,p=m.YJc,q=n.length;if(isNaN(a)||a<0||a>=q)throw Error(Ba().Exp_IndexOutOfRange);if(c=a<=m.xKc||a===q-1,d=m.getActiveSheetTab(),a<m.xKc&&m.xKc--,e=n[a],e.mu(),n.splice(a,1),q=n.length,0===q)m.xKc=-1;else if(m.xKc>=q)m.xKc=p.rw(q);else{for(f=void 0,f=m.xKc;f<q;f++)if(n[f].visible()){m.xKc=f;break}f>=q&&(m.xKc=p.rw(q))}m.BLc(),c&&(g=n[m.xKc],d!==g&&(d&&d.no(!1),g&&m.CLc(g,b,!1,!0),m.yLc(d))),o&&(o.suspend(),h=e.kj,i=h.yj(),i.VDc=a,o.removeSource(i),j=h.fDc,o.removeSource(j),k=h.hDc,o.removeSource(k),l=h.Vva,y(l)||o.removeSource(l),o.resume()),e.no(!0,m.xKc!==-1),p&&(p.gq>=q?m.startSheetIndex(p.rw(q)):p.gq<0?m.startSheetIndex(p.jw(-1)):m.fq())},a.prototype.clearSheets=function(){var a,b,c,d=this,e=d.sheets,f=d.Wu,g=d.YJc;for(a=0,b=e;a<b.length;a++)c=b[a],c.mu(),c.no(!0);e.splice(0,e.length),f&&f.clearSource(),d.eq=-1,g&&(g.gq=-1,g.repaint())},a.prototype.clearSheetTabs=function(){var a,b,c,d=this,e=d.pJc,f=d.YJc;for(a=0,b=e;a<b.length;a++)c=b[a],c.mu(),c.no(!0);e.splice(0,e.length),d.xKc=-1,f&&(f.gq=-1,f.repaint())},a.prototype.getSheet=function(a){var b=this.sheets;return a>=0&&a<b.length?b[a]:H},a.prototype.getSheetTab=function(a){var b,c,d,e=this.pJc;if("number"==typeof a)return a>=0&&a<e.length?e[a]:H;if("string"==typeof a)for(b=0,c=e;b<c.length;b++)if(d=c[b],d.name()===a)return d;return H},a.prototype.getSheetFromName=function(a){var b,c,d,e=this.sheets;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.name()===a)return d;return H},a.prototype.getSheetIndex=function(a){var b,c=this.sheets;for(b=0;b<c.length;b++)if(c[b].name()===a)return b;return H},a.prototype.getSheetTabIndex=function(a){var b,c=this.pJc;for(b=0;b<c.length;b++)if(c[b].name()===a)return b;return H},a.prototype.getSheetCount=function(){return this.sheets.length},a.prototype.getSheetTabCount=function(){return this.pJc.length},a.prototype.setSheetCount=function(a){var b=this,c=b.getActiveSheet(),d=b.getActiveSheetTab();b.sw(a,2),b.SHb(c),b.yLc(d)},a.prototype.sw=function(a,b){var c,d,e=this;if(a<0)throw Ba().Exp_ArgumentOutOfRange;if(0===a&&e.clearSheets(),c=e.sheets.length,a<c)for(d=c-1;d>=a;d--)e.qw(d,b);else if(a>c)for(d=c;d<a;d++)e.ow(d,b)},a.prototype.gKc=function(a,b){var c,d,e,f=this;if(a<0)throw Ba().Exp_ArgumentOutOfRange;if(0===a&&f.clearSheetTabs(),c=f.pJc.length,a<c)for(d=c-1;d>=a;d--)f.FLc(d,b);else if(a>c)for(d=c;d<a;d++)e=f.DLc(H,r.SheetType.tableSheet),f.ELc(d,b,e)},a.prototype.DLc=function(b,c){var d={name:b,type:c,sheetTab:H};return a.ao(this,"createSheetTab",d,function(){return d.sheetTab!==H}),d.sheetTab},a.prototype.bind=function(a,b,c){var d,e,f,h,i,j,k,l=this,m=l.sheets;for(l.rv&&l.rv.push({type:a,data:b,fn:c}),g.GC$(l.sv).bind(a+V,b,c),d=0,e=m;d<e.length;d++)f=e[d],f.bind(a,b,c);for(h=l.pJc,i=0,j=h;i<j.length;i++)k=j[i],k.bind(a,b,c)},a.prototype.unbind=function(a,b){var c,d,e,f,h,i,j,k,l,m=this,n=m.sheets,o=m.rv;if(o)for(c=o.length-1;c>=0;c--)d=o[c],(d.type===a||m.bJc(d.type,a))&&o.splice(c,1);for(g.GC$(m.sv).unbind(a+V,b),e=0,f=n;e<f.length;e++)h=f[e],h.unbind(a,b);for(i=m.pJc,j=0,k=i;j<k.length;j++)l=k[j],l.unbind(a,b)},a.prototype.bJc=function(a,b){return 0===b.indexOf(".")&&a.substring(a.length-b.length)===b},a.prototype.unbindAll=function(){var a,b,c,d,e,f,h,i=this,j=i.sheets;for(i.rv.length=0,g.GC$(i.sv).unbind(V),a=0,b=j;a<b.length;a++)c=b[a],c.unbindAll();for(d=i.pJc,e=0,f=d;e<f.length;e++)h=f[e],h.unbindAll()},a.prototype.Fu=function(a,b,c){var d,e,f,h,i,j,k,l=this,m=l.sheets;for(l.rv.push({type:a,data:b,fn:c}),g.GC$(l.sv).bind(a+W,b,c),d=0,e=m;d<e.length;d++)f=e[d],f.Fu(a,b,c);for(h=l.pJc,i=0,j=h;i<j.length;i++)k=j[i],k.Fu(a,b,c)},a.prototype.Gu=function(a,b){var c,d,e,f,h,i,j,k,l,m=this,n=m.sheets,o=m.rv;for(c=0;c<o.length;c++)d=o[c],(d.type===a||m.bJc(d.type,a))&&o.splice(c,1);for(g.GC$(m.sv).unbind(a+W,b),e=0,f=n;e<f.length;e++)h=f[e],h.Gu(a,b);for(i=m.pJc,j=0,k=i;j<k.length;j++)l=k[j],l.Gu(a,b)},a.prototype.nu=function(){var a,b,c,d,e,f,h,i=this,j=i.sheets;for(i.rv.length=0,g.GC$(i.sv).unbind(W),a=0,b=j;a<b.length;a++)c=b[a],c.nu();for(d=i.pJc,e=0,f=d;e<f.length;e++)h=f[e],h.nu()},a.prototype.Wq=function(a,b){0===this.jm&&g.GC$(this.sv).trigger(a,b)},a.prototype.tw=function(a,b,c,d){this.Wq(h.Events.ButtonClicked,{sheet:a,sheetName:a.name(),row:b,col:c,sheetArea:d})},a.prototype.pw=function(a){var b,c,d,e=this.rv;for(b=0,c=e;b<c.length;b++)d=c[b],a.bind(d.type,d.data,d.fn)},a.prototype.suspendEvent=function(){var a,b,c,d,e,f,g,h=this,i=h.sheets;for(h.jm++,a=0,b=i;a<b.length;a++)c=b[a],c.suspendEvent();for(d=h.pJc,e=0,f=d;e<f.length;e++)g=f[e],g.suspendEvent()},a.prototype.resumeEvent=function(){var a,b,c,d,e,f,g,h=this,i=h.sheets;for(h.jm--,h.jm<0&&(h.jm=0),a=0,b=i;a<b.length;a++)c=b[a],c.resumeEvent();for(d=h.pJc,e=0,f=d;e<f.length;e++)g=f[e],g.resumeEvent()},a.prototype.focus=function(a){var b,c;a===!1?h.Vl.Zl(H):(b=this.getActiveSheet(),b?b.zt():(c=this.getActiveSheetTab(),c&&c.zt()))},a.prototype.Wv=function(){return this.Vv>2007?15:18},a.prototype.Xv=function(){return this.Vv>2007?22:this.Wv()},a.prototype.cec=function(a){var b,c,d=this,e=a?d.vKc:d.wKc,f=a?d.nKc:d.kKc,g=d.options.scrollbarAppearance===r.ScrollbarAppearance.mobile;if(e&&f&&g)switch(b=d.ku,c=f.iec){case r.ScrollbarState.hide:b.Rdc(a);break;case r.ScrollbarState.show:b.Tdc(e),b.Wdc(a);break;case r.ScrollbarState.active:b.Tdc(e),b.Wdc(a),b.Udc(e);break;case r.ScrollbarState.inactive:b.uKc(e),b.Rdc(a)}},a.prototype.xJc=function(){return this.Vv>2007?28:this.Wv()},a.prototype.uw=function(a,b,c,d,e){var f,h,i="auto",j=this;j.vw||(f=g.getHostMaxZIndex(j.qo)+1,h=z(Z),e?g.GC$(h).addClass("gc-spread-pivot-toolTip"):g.GC$(h).addClass("gc-spread-toolTip"),g.GC$(h).addClass("ui-state-default ui-widget-content btn-default").css({position:ga,padding:"0px 3px 0px 3px",font:C("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":f}).width(i).height(i).appendTo(G.body),j.vw=h),j.ww(a,b,c,d)},a.prototype.ww=function(a,b,c,d){var e,f,h,i,j,k,l=this,m=l.WJc();m&&(e=l.vw,e&&(f=g.GC$(e),a?(f.html(a),f.show()):f.hide(),h=m.Vs(),d&&(c-=h.top,b-=h.left),i=m.Dr(),j=i.x+i.width-f.outerWidth(),k=i.y+i.height-f.outerHeight(),j<0?b=0:k<0?c=0:(c=J(c,k),b=J(b,j)),y(c)||f.css("top",c+h.top),y(b)||f.css("left",b+h.left)))},a.prototype.xw=function(){var a=this,b=a.vw;b&&(g.GC$(b).remove(),a.vw=H)},a.prototype.Av=function(){var b,c,d,e=this,g=e.yJc();for(h.mn.wn(),e.invalidateLayout(),b=0,c=g.length;b<c;b++)d=g[b],d.Av();Ba(),f.Common.FXc(),q&&p.sR(),e.repaint(),a.ao(e,"onCultureChanged")},a.prototype.getTab=function(){return this.YJc},a.prototype.changeSheetIndex=function(a,b){var c,d,e,f=this,g=f.getSheetIndex(a),h=!1;return y(g)&&(h=!0,g=f.getSheetCount()+f.getSheetTabIndex(a)),c=f.getTab(),d=f.getSheetCount()+f.getSheetTabCount(),!("number"!=typeof b||g===-1||g===b||b<0||b>=d||b%1!==0||f.GXc(a))&&(e=f.WJc().name(),e!==a?(f.suspendPaint(),f.xYc(h,a),f.UD(g,b),f.xYc(h,e),f.resumePaint()):(f.UD(g,b),c.DXc(g,b)),!0)},a.prototype.GXc=function(a){var b,c,d,e,f,g,h,i=this,j=i.sheets;for(b=0,c=j;b<c.length;b++)if(d=c[b],d.name()===a)return!1;for(e=i.pJc,f=0,g=e;f<g.length;f++)if(h=g[f],h.name()===a)return!1;return!0},a.prototype.UD=function(a,b){var c,d=this,e=-1,f=d.yJc(),g=f[a],h=d.sheets.length;if(a>b)if(a>=h&&h>b)f.splice(a,1),f.splice(h,0,g),e=h;else{for(c=a;c>b;c--)f[c]=f[c-1];f[b]=g,e=b}else if(a<b)if(a<h&&h<=b)f.splice(h,0,g),f.splice(a,1),e=h-1;else{for(c=a;c<b;c++)f[c]=f[c+1];f[b]=g,e=b}d.$Jc(f),e<h?d.eq=e:d.xKc=e-h},a.prototype.xYc=function(a,b){a?this.setActiveSheetTab(b):this.setActiveSheet(b)},a.prototype.clone=function(a,b,c,d){var e,f,g,h,i,j,k,l,m=this,n=m.getSheetFromName(a);if(y(d)&&(d=!0),!(y(n)||y(c)||m.getSheetFromName(c))){for(m.suspendPaint(),m.suspendCalcService(),e=JSON.stringify(n.toJSON({newWorkSheetName:c})),b<0&&(b=0),f=m.vv(c),m.addSheet(b,f),f.yj().q$a=!0,f.fromJSON(JSON.parse(e)),m.setActiveSheet(f.name()),g=n.tables.l$,h=f.tables.l$,k=0;k<g.length;k++)g[k].wq&&d&&(i=g[k].LZ(),h[k].p$(i)),j=h[k].range(),f.t4&&f.t4(j.row,j.col,j.rowCount,j.colCount,r.SheetArea.viewport);return i=n.wq._dataSource,i&&d&&(l=f.wq,l.bind(i)),m.resumeCalcService(),m.resumePaint(),f}},a.prototype.FKc=function(a){var b,c,d,e,f=this,g=a.command;0!==a.s4&&g.yTa||(b=g.sheetName?h.uJc(f,g.sheetName):h.sJc(f),b&&(c=b.getActiveRowIndex(),d=b.getActiveColumnIndex(),e=b.getSelections(),g.xC={GLc:e,HLc:{row:c,col:d}}))},a.prototype.GKc=function(b){var c,d,e,f,g,i,j,k,l,m,n=this,o=b.command,p=o.xC,q=h.sJc(n),r=q&&q.name();if(r!==o.sheetName&&(h.tJc(n,o.sheetName),q=h.sJc(n)),!y(p)&&q){if(q.suspendPaint(),c=p.HLc,d=p.GLc,e=p.ILc,f=p.JLc,y(c)||q.Sr(c.row,c.col),!y(d))if(g=d.length,1===g)q.setSelection(d[0].row,d[0].col,d[0].rowCount,d[0].colCount);else for(i=0;i<g;i++)j=d[i].row,k=d[i].col,l=d[i].rowCount,m=d[i].colCount,q.j7c(j,k,l,m);if(a.ao(n,"onCommandExecuting",q),!y(e)){for(i=0;i<e.length;i++)e[i].isSelected&&e[i].isSelected(!0);f||q.EJ()}q.showCell(c.row,c.col,3,3),q.resumePaint()}},a.prototype.changeSelectionInCommandExecuting=function(a,b,c,d,e){if(a&&a.xC){var f=a.xC,g=f.HLc;y(g)||(y(b)||(g.row=b),y(c)||(g.col=c)),y(d)||(f.GLc=d),y(e)||(f.ILc=e)}},a.prototype.BLc=function(){var a=this.getActiveSheet();a&&a.no(!1),this.eq=-1},a.prototype.ALc=function(){var a=this.getActiveSheetTab();a&&a.no(!1),this.xKc=-1},a.prototype.yJc=function(){return[].concat(this.sheets).concat(this.pJc)},a.prototype.$Jc=function(a){var b,c,d,e,f;for(this.sheets.length=0,this.pJc.length=0,b=this.sheets,c=this.pJc,d=0,e=a;d<e.length;d++)f=e[d],f instanceof o.Worksheet?b.push(f):c.push(f)},a.prototype.MJc=function(a){return this.getSheetFromName(a)||this.getSheetTab(a)},a.prototype.XJc=function(a){return this.yJc()[a]},a.prototype.WJc=function(){return this.getActiveSheet()||this.getActiveSheetTab()},a.prototype.ZJc=function(a,b,c,d){var e=this.sheets.length;a<e?this.dq(a,b,c,d):(a-=e,this.hKc(a,b,c,d))},a.prototype.fKc=function(){var a=this.eq;return a<0&&(a=this.sheets.length+this.xKc),a},a.prototype.yYc=function(){var a=[].concat(this.sheets);return this.pJc.forEach(function(b){b.kj&&a.push(b.kj)}),a},a.Qp=Ga,a.nv=1,a.ov=0,a}(),b.Workbook=Ha,h.Zn(Ha),Ha.prototype.nextControl=A("nextControl",H),Ha.prototype.previousControl=A("previousControl",H)},"./dist/core/workbook/workbookpanelex.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/core.enum.js"),h=c("./dist/core/workbook/sheettabbase.js"),i=f.Common.j.Fa,j=null,k=e.Ul.Ml,l=e.Ul.nl,m=e.Ul.Nl,n=e.Ul.Pl,o=document,p=window,q=Math.round,r=Math.ceil,s="gc-scroll-container",t="gc-scroll-corner-all",u="gc-scroll-arrow",v="gc-scrollbar-wrapper",w="gc-scroll-bar",x="gc-scroll-arrowUp",y="gc-scroll-arrowDown",z="gc-scroll-arrowLeft",A="gc-scroll-arrowRight",B="gc-scroll-mobile-track",C="gc-scroll-mobile-thumb",D="gc-scroll-mobile-state-active",E="gc-scrollbar-vertical",F="gc-scrollbar-horizontal",G="gc-no-user-select",H="width",I="height",J="gc-scrollbar-stateActive ui-state-active",K="left",L="right",M="top",N="bottom",O="margin-left",P="position",Q="border",R="padding",S="margin",T="overflow",U="display",V="outline",W="100%",X="borderWidth",Y="boxSizing",Z="absolute",$="relative",_="margin-top",aa=".gcScrollbar",ba="mousedown"+aa,ca="mouseup"+aa,da="mousemove"+aa,ea="mouseover"+aa,fa="mouseout"+aa,ga="mousewheel",ha="inline-block",ia="content-box",ja="DOMMouseScroll",ka="scroll"+aa,la="scrollbar";function ra(a){a.preventDefault?a.preventDefault():a.returnValue=!1}!function(a){a[a.horizontalScroll=0]="horizontalScroll",a[a.verticalScroll=1]="verticalScroll"}(ma=b.ScrollOrientation||(b.ScrollOrientation={})),na=function(){function a(a,b,c,d,e,f,h,i,k){this.updateStateFn=k;var l=this;l.jec=i,l.JB=!1,l.KB=!1,l.LB=j,l.MB=j,l.NB=300,l.OB=70,l.PB=a,l.Jwa(g.ScrollbarState.show),l.Vo("number"==typeof b?b:0),l._v("number"==typeof c?c:0),l.dw("number"==typeof d?d:0),l.cw("number"==typeof e?e:0),l.bw("number"==typeof f?f:0),l.QB="number"==typeof h?h:1,l.RB=!1,l.SB=0,l.Qb=l.bw(),l.ew()}return a.prototype.Bv=function(){return this.TB},a.prototype.Jwa=function(a){a===g.ScrollbarState.inactive&&this.JB||(this.iec=a,this.updateStateFn&&this.updateStateFn())},a.prototype.value=function(a){var b,c=this;return 0===arguments.length?c.Qb:("number"==typeof a&&a<=c.cw()&&a>=c.bw()&&(c.Qb=a,b=(a-c.bw())*c.UB,c.scrollTo(b,!0)),c)},a.prototype.ew=function(){var a,b,c,e=this,f=0,h=0,i=!1,j=e.jec,k=j===g.ScrollbarAppearance.mobile,l=k?0:2,n="ui-widget ui-corner-all",o=e._v(),p=e.Vo(),r=k?0:o,D=p-2*r,J=r,aa=K,ba=L,ca=z,da=A,ea=F,fa=O,ga="ui-button ui-state-default ui-corner-bl btn btn-default",ja="ui-icon ui-icon-triangle-1-w",ka="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",la="ui-icon ui-icon-grip-solid-vertical",ma="ui-button ui-state-default ui-corner-br btn btn-default",na="ui-icon ui-icon-triangle-1-e";e.VB=D,e.PB||(r=k?0:p,D=r,J=o-2*r,aa=M,ba=N,ca=x,da=y,ea=E,fa=_,ga="ui-button ui-state-default ui-corner-tr btn btn-default",ja="ui-icon ui-icon-triangle-1-n",ka="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",la="ui-icon ui-icon-grip-solid-horizontal",ma="ui-button ui-state-default ui-corner-br btn btn-default",na="ui-icon ui-icon-triangle-1-s",e.VB=J);function oa(){e.TB=m("div"),e.WB=d.GC$(e.TB),e.WB.css([P,K,M,T,V,R,S],[$,0,0,"hidden","none",0,0]).addClass(s+" "+t+" "+n+" ")}function pa(a){e.XB=d.GC$.Nl("div",[P,U,X,R,S,Y],[Z,ha,"1px",0,0,ia],u+" "+ga,a),e.YB=d.GC$.Nl("span",[U,Q,R,S],["block","none",0,0],ca+" "+ja,e.XB)}function qa(a){e.ZB=d.GC$.Nl("div",[P,U,Y,Q,R,S],[Z,ha,ia,"none",0,0],v+" "+v,a)}function ra(a){e.$B=d.GC$.Nl("div",[],[],G+" "+ka+" "+w,a),e._B=d.GC$.Nl("span",[U,Q,R,S],["block","none",0,0],ea+" "+la,e.$B)}function ta(a){e.aC=d.GC$.Nl("div",[P,U,X,R,S,Y],[Z,ha,"1px",0,0,ia],u+" "+ma,a),e.bC=d.GC$.Nl("span",[U,Q,R,S],["block","none",0,0],da+" "+na,e.aC)}a=e.VB,b=e.cw()-e.bw(),e.dC=e.dw()*a/(b+e.dw()),e.dC>a&&(e.dC=a),e.dC<10&&(e.dC=10),c=e.dC,e.UB=0===b?1:(a-c)/b,e.PB?(f=c,h=r):(f=r,h=c),e.WB||(i=!0,oa()),k?e.WB.addClass(B):e.WB.removeClass(B),e.XB||pa(e.WB),e.ZB||qa(e.WB),e.$B?e.$B.removeAttr("style"):ra(e.ZB),k?e.$B.css(P,Z).addClass(C):e.$B.css([P,X,R,S,Y],[Z,"1px",0,0,ia]).removeClass(C),e.aC||ta(e.WB),k?(sa(e.WB,"border"),e.PB?(e.WB.css([H,I],[W,W]),e.ZB.css([aa,H,I],[r,W,W]),e.$B.css([aa,H,I],[e.SB,q(f-l),W])):(e.WB.css([H,I],[W,W]),e.ZB.css([aa,H,I],[r,W,W]),e.$B.css([aa,H,I],[e.SB,W,q(h-l)])),e._B.remove(),e.XB.remove(),e.aC.remove()):(e.WB.css([H,I,Q],[p,o,"none"]),e.ZB.css([aa,H,I],[r,D,J]),e.$B.css([aa,H,I],[e.SB,q(f-l),q(h-l)]),e.XB.css([aa,H,I],[0,r-l,r-l]),e.YB.css([H,I],[W,W]),e.aC.css([ba,H,I],[0,r-l,r-l]),e.bC.css([H,I],[W,W]),e._B.css([H,I,fa],[r-l,r-l,Math.floor((e.dC-r)/2)]),e.$B.append(e._B),e.WB.append(e.XB),e.WB.append(e.aC)),i&&e.eC()},a.prototype.eC=function(){var b=this;function c(a,c){a.bind(ba,function(a){b.fC(a,c)}).bind(ca,function(a){b.gC(a,c)}).bind(ea,function(a){b.hC(a,c)}).bind(fa,function(a){b.iC(a,c)})}c(b.XB,!0),c(b.aC,!1),b.$B.bind(ba,function(a){b.jC(a)}).bind(da,function(a){b.kC(a)}).bind(ca,function(a){b.lC(a)}).bind(ea,function(a){b.mC(a)}).bind(fa,function(a){b.nC(a)}),b.ZB.bind(ba,function(a){var c,d,e=k&&k.mozilla;e&&(c=(new Date).valueOf(),d=b.oC,b.oC=c,d&&c-d<100)||b.pC(a)}).bind(ca,function(a){b.qC(a)}),b.GB=function(a){b.sC(a)},b.WB.bind(ga,b.GB),b.WB.bind(ja,b.GB),a.ao(b,"initEvents",b.TB)},a.prototype.$dc=function(a){this.jec=a},a.prototype.dispose=function(){var b=this;function c(a){a&&a.unbind(aa)}c(b.aC),c(b.$B),c(b.XB),c(b.ZB),b.WB&&(b.GB&&(b.WB.unbind(ga,b.GB),b.WB.unbind(ja,b.GB)),a.ao(b,"dispose",b.TB),b.WB.unbind(aa).remove())},a.prototype.tC=function(){var a=this;a.RB||(d.GC$(o).bind(da,function(b){a.kC(b)}).bind(ca,function(b){a.lC(b)}),a.RB=!0)},a.prototype.uC=function(){this.RB&&(this.RB=!1,d.GC$(o).unbind(da).unbind(ca))},a.prototype.fC=function(a,b){var c,d=0,e=this,f=!0;e.KB=!0,null===e.LB&&(b?(e.XB.addClass(J),d=0-e.qB(),e.vC=g.Nxb.smallDecrement):(e.aC.addClass(J),d=e.qB(),e.vC=1),c=function(){e.scrollTo(e.SB+d*e.UB,!1),e.LB=p.setTimeout(c,f?e.NB:e.OB),f=!1},c(),ra(a))},a.prototype.gC=function(a,b){var c=this,d=b?c.XB:c.aC;d.removeClass(J),c.wC(),ra(a)},a.prototype.hC=function(a,b){var c=this,d=b?c.XB:c.aC;d.addClass("gc-scroll-arrow-hover ui-state-hover"),ra(a)},a.prototype.iC=function(a,b){var c=this,d=b?c.XB:c.aC;d.removeClass("gc-scroll-arrow-hover ui-state-hover "+J),c.wC(),ra(a)},a.prototype.jC=function(a){var b,c,d,e,f,h,i=this;0===a.button&&(i.JB=!0,i.xC={x:a.pageX,y:a.pageY},i.Jwa(g.ScrollbarState.show),i.tC(),i.WB.addClass(D),i.$B.addClass(J),b=i.$B.offset(),c=i.$B.outerWidth(!0),d=i.$B.outerHeight(!0),e=i.ZB.offset(),f=i.ZB.outerWidth(!0),h=i.ZB.outerHeight(!0),i.yC={isBeyondEdge:!1,startEdgePosition:{x:e.left+a.pageX-b.left,y:e.top+a.pageY-b.top},endEdgePosition:{x:e.left+f-(c-a.pageX+b.left),y:e.top+h-(d-a.pageY+b.top)}}),ra(a)},a.prototype.kC=function(a){var b=this;b.JB&&(b.Jwa(g.ScrollbarState.active),b.zC={x:a.pageX,y:a.pageY},b.AC(),b.xC=b.zC,d.GC$(o.body).attr("unselectable","on").addClass(G)),ra(a)},a.prototype.lC=function(a){var b,c,e,f,h,i=this;i.JB=!1,i.vC=g.Nxb.thumbPosition,i.yC=null,i.WB.trigger(ka,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?ma.horizontalScroll:ma.verticalScroll,scrollEventType:i.vC}),b=i.Qb,c=(b-i.bw())*i.UB,e="left",f=a.target.classList,h=f&&f.contains(C),i.PB||(e="top"),h?i.Jwa(g.ScrollbarState.hide):i.Jwa(g.ScrollbarState.inactive),i.SB=c,i.$B.css(e,q(c)),i.uC(),d.GC$(o.body).removeClass(G),d.GC$(o.body).attr("unselectable")&&d.GC$(o.body).removeAttr("unselectable"),i.$B.removeClass(J),i.WB.removeClass(D),i.vC=6,i.WB.trigger(ka,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?ma.horizontalScroll:ma.verticalScroll,scrollEventType:i.vC}),ra(a)},a.prototype.mC=function(a){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),ra(a)},a.prototype.nC=function(a){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),ra(a)},a.prototype.sC=function(a){var b,c,d,e=this;i(a.wheelDelta)&&i(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta/-40,c=b/3*e.qB()*e.UB,e.vC=c>=0?1:0,e.scrollTo(e.SB+c,!1),e.vC=6,d={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?ma.horizontalScroll:ma.verticalScroll,scrollEventType:e.vC},e.WB.trigger(ka,d),ra(a)},a.prototype.pC=function(a){var b,c=this,d=!0,e=a.pageX,f=a.pageY,h=0,i=c.ZB.offset(),j=c.rB();null===c.MB&&(h=c.PB?e-i.left-c.SB:f-i.top-c.SB,b=function(){var a=0,k=c.SB;if(a=c.PB?e-i.left-k:f-i.top-k,a*h<0||a>=0&&a<c.dC)return void c.CC();if(h<0)c.vC=g.Nxb.largeDecrement,c.scrollTo(k-j*c.UB,!1);else{if(!(h>0))return void c.CC();c.vC=g.Nxb.largeIncrement,c.scrollTo(k+j*c.UB,!1)}c.MB=p.setTimeout(b,d?c.NB:c.OB),d=!1},b(),ra(a))},a.prototype.qC=function(a){this.CC(),ra(a)},a.prototype.CC=function(){var a,b=this;b.MB&&clearTimeout(b.MB),b.MB=j,b.vC=g.Nxb.endScroll,a={newValue:b.Qb,oldValue:b.Qb,scrollOrientation:b.PB?ma.horizontalScroll:ma.verticalScroll,scrollEventType:b.vC},b.WB.trigger(ka,a)},a.prototype.wC=function(){var a,b=this;b.KB&&(b.KB=!1,b.LB&&clearTimeout(b.LB),b.LB=j,b.vC=6,a={newValue:b.Qb,oldValue:b.Qb,scrollOrientation:b.PB?ma.horizontalScroll:ma.verticalScroll,scrollEventType:b.vC},b.WB.trigger(ka,a))},a.prototype.AC=function(){var a,b,c,d,e,f,g,h,i=this,j=i.SB,k=i.zC,l=i.yC;function m(a){return i.PB?a.x:a.y}function n(a,b){i.PB?a.x=b:a.y=b}if(c=m(k),d=m(i.xC),l&&l.isBeyondEdge){if(e=m(l.startEdgePosition),f=m(l.endEdgePosition),a=c<e,b=c>f,a||b)return;d<e&&n(i.xC,e),d>f&&n(i.xC,f)}g=c-d,h=j+g,h!==j&&(i.vC=5,i.scrollTo(h,!1))},a.prototype.scrollTo=function(a,b){var c,d,e,f,h,j,k,l,m=this,n=M,o=m.VB-m.dC;m.PB&&(n=K),c=!1,d=!1,e=!1,a>o&&(a=o,e=!0,d=!0),a<0&&(a=0,e=!0,c=!0),m.yC&&(m.yC.isBeyondEdge=e),f=m.QB===g.ScrollType.continuous?q(a/m.UB)+m.bw():a/m.UB+m.bw(),h=m.Qb,j=!1,b||(l={newValue:f,oldValue:h,scrollOrientation:m.PB?ma.horizontalScroll:ma.verticalScroll,scrollEventType:m.vC,isBeyondMaxEdge:d,isBeyondMinEdge:c},m.WB.trigger(ka,l),j=l.ignoreUpdatePosition,l.newValue>m.cw()&&(l.newValue=m.cw()),f=l.newValue,k=l.newValueWithOffset),i(k)&&(k=f),m.Qb=f,5!==m.vC&&(a=(k-m.bw())*m.UB),m.SB=a,j||m.$B.css(n,q(a))},a.prototype.hitTest=function(a,b){var c,e,f,h,i=this,j=0,k=0,l=i.$B.outerWidth(),m=i.XB.outerWidth(),n=i.ZB.outerWidth(),o=i.$B.offset(),p=d.GC$(i.Bv()).offset(),q=o.left-p.left-18;return i.PB?a<j+n+m&&a>j+m?a<j+q+l+m&&a>q?{element:g.Oxb.ThumbButton,x:a,y:b}:{element:g.Oxb.TrackButton}:a<=j+m&&a>j?{element:g.Oxb.LeftButton,x:a,y:b}:{element:g.Oxb.RightButton,x:a,y:b}:(c=i.$B.outerHeight(),e=i.XB.outerHeight(),f=i.ZB.outerHeight(),h=o.top-p.top-18,b<k+f+e&&b>k+e?b<k+h+c+e&&b>h?{element:g.Oxb.ThumbButton,x:a,y:b}:{element:g.Oxb.TrackButton}:b<=k+e&&b>k?{element:g.Oxb.UpButton,x:a,y:b}:{element:g.Oxb.DownButton,x:a,y:b})},a.prototype.pia=function(){var a=this;return{x:0,y:0,width:a.Vo(),height:a._v()}},a.prototype.show=function(){this.ZB.show()},a.prototype.hide=function(){this.ZB.hide()},a.prototype.wDc=function(a){var b=this,c=b.WB.parent()&&b.WB.parent().parent();return c?a?c.height():c.width():j},a}(),b.hv=na;function sa(a,b){var c=a.get(0);c&&(c.style[b]="")}e.Zn(na),oa=na.prototype,oa.qB=n("smallChange",1),oa.rB=n("largeChange",10),oa.dw=n("pageValue",10,function(a){a<=0&&this.dw(1)}),oa.cw=n("maximum",100,function(a){a<=0&&this.cw(0)}),oa.bw=n("minimum",0,function(a){a<=0&&this.bw(0)}),oa.Vo=n("width",0),oa._v=n("height",0),pa=function(){function a(a,b){var c=this;c.fB=!0,c.gB=!0,c.hB=18,c.iB=a&&d.GC$(a),c.jB=b&&d.GC$(b),c.ew(!0)}return a.prototype.ew=function(a){var b,c,e,f,g,h,i,l,m,n,o,p,s,t=this;function u(a){return a===Z?d.GC$.Nl("div",[P,K,M,Q,R,S],[Z,0,0,"none",0,0]):a===$?d.GC$.Nl("div",[P,K,M,Q,R,S],[$,0,0,"none",0,0]):j}function v(a,b){var c,e,f,g=b?t.mB:t.nB;return g?g:(c=new na(b),e=d.GC$.Nl("div"),b?(t.oB=e,t.mB=c,e.css([P,K,N,Q,R,S],[Z,0,0,"none",0,0])):(t.pB=e,t.nB=c,e.css([P,L,M,Q,R,S],[Z,0,0,"none",0,0])),f=(b?t.mB:t.nB).Bv(),e.append(f),a.append(e),c)}function w(a,b,c,e,f,g){g?(t.oB.css([H,I],[b,e]),a.Vo(b),a._v(e)):(t.pB.css([H,I],[e,b]),a.Vo(e),a._v(b)),a.bw(0),a.cw(f-b),a.dw(b),a.qB(g?t.kB():t.lB()),a.rB(b),a.ew(),d.GC$(a.Bv()).bind(ka,function(a,b){c.css(g?K:M,0-b.newValue)}),g?t.oB.show():t.pB.show()}function x(a){t.sB||(t.sB=u($),t.sB.css([T,U,H],["hidden",ha,W]),a.append(t.sB))}function y(a){t.tB||(t.tB=d.GC$.Nl("div",P,$,j,a))}t.iB&&t.jB&&(b=t.hB,c=t.jB.width(),e=t.jB.height(),f=t.iB.width(),g=t.iB.height(),h=f-b,i=g-b,l=!1,t.uB||(t.uB=u($),t.uB.css([P,T],[$,"hidden"]),l=!0),t.uB.css(I,g),x(t.uB),y(t.sB),a&&t.tB.append(t.jB).css([M,K],[0,0]),k.chrome&&(c=q(c),e=q(e),f=r(f),g=r(g)),m=t.vB(c,e,f,g),n=m.wB,o=m.xB,o?(n||(h+=b),p=v(t.uB,!0),w(p,h,t.tB,b,c,!0)):t.oB&&t.oB.hide(),n?(o||(i+=b),s=v(t.uB,!1),w(s,i,t.tB,b,e,!1)):t.pB&&t.pB.hide(),o||n||(h+=b,i+=b),t.fB=o,t.gB=n,t.yB=h,t.zB=i,t.sB.css(I,i),l&&(t.iB.append(t.uB),t.AB()))},a.prototype.BB=function(a){var b=this,c=b.CB(a),d=c.EB,e=c.FB;!i(d)&&b.mB&&b.lu(d),!i(e)&&b.nB&&b.ju(e)},a.prototype.lu=function(a){var b,c,d=this;d.mB.value(a),b=d.yB,c=d.jB.width(),a>=0&&a<=c-b&&d.tB.css(K,0-a)},a.prototype.ju=function(a){var b,c,d=this;d.nB.value(a),b=d.zB,c=d.jB.height(),a>=0&&a<=c-b&&d.tB.css(M,0-a)},a.prototype.vB=function(a,b,c,d){var e=this.hB,f=c,g=d-e,h={xB:!1,wB:!1};return a>c&&(h.xB=!0,h.wB=b>g),b>d&&(h.wB=!0,h.xB=a>f),h},a.prototype.CB=function(a){var b=d.GC$(a),c=this.sB,e=this.tB,f,g,h,i,k,l,m,n={EB:j,FB:j};return a?(f=b.offset(),g=e.offset(),h=c.offset(),f.leftWidth=f.left+b.outerWidth(),f.topHeight=f.top+b.outerHeight(),h.leftWidth=h.left+c.outerWidth(),h.topHeight=h.top+c.outerHeight(),i=f.left-g.left,f.left<h.left?n.EB=i:f.leftWidth>h.leftWidth&&(k=f.leftWidth-g.left-c.innerWidth(),i<k?n.EB=i:n.EB=k),l=f.top-g.top,f.top<h.top?n.FB=l:f.topHeight>h.topHeight&&(m=f.topHeight-g.top-c.innerHeight(),l<m?n.FB=l:n.FB=m),n):n},a.prototype.AB=function(){var a=this;this.tB&&(a.GB=function(b){a.HB(b)},a.tB.bind(ga,a.GB),a.tB.bind(ja,a.GB))},a.prototype.HB=function(a){var b,c,d,e,f,g,h,j=this;i(a.wheelDelta)&&i(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta/-40,c=b,d=j.nB,e=parseInt(j.tB.css(M),10),f=j.zB,g=j.jB.height(),g<f&&(g=f),isNaN(e)&&(e=0),h=e-c*j.lB(),h>=0&&(h=0),h<0&&0-h>g-f&&(h=0-(g-f)),h!==e&&(j.tB.css(M,h),j.gB&&d.value(0-h)),l(a)},a.prototype.dispose=function(){var a=this;a.uB&&(a.mB&&a.mB.dispose(),a.nB&&a.nB.dispose(),a.tB&&a.GB&&(a.tB.unbind(ga,a.GB),a.tB.unbind(ja,a.GB)),d.GC$(a.uB).remove())},a}(),b.IB=pa,qa=pa.prototype,qa.kB=n("horizontalSmallChange",10),qa.lB=n("verticalSmallChange",10),h.DC.$n(la,{preProcessMouseMove:function(a){var b=this.OC,c=b.nKc.JB||b.kKc.JB;c&&(a.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("Common"),f=c("./dist/core/worksheet/stylehelper.js"),g=c("./dist/core/worksheet/style.js"),h=c("./dist/core/core.enum.js"),i=e.Common.u,j=/<img[^>]+>/g,k=d.Ul.Ml,l=e.Common.j.Fa,m=e.Common.k.Bb,n=null;function p(a){return a&&a.options.allowCopyPasteExcelStyle}function q(a,b){var c,d;if(k.msie){for(c=[],d=0;d<a.length;d++)b&&""===a[d].trim()||c.push(a[d]);return c.join("")}return a.join("")}function r(a){for(var b="picture",c=1,d=b+(""+c);a.get(d);)c++,d=b+(""+c);return d}function s(a,b,c,d){var e,f,g=[];for(e=0,f=c;e<f;e++)g[e]=a.getRowHeight(b+e,d);return g}function t(a,b,c,d){var e,f,g=[];for(e=0,f=c;e<f;e++)g[e]=a.getColumnWidth(b+e,d);return g}function u(a){var b,c,d;if(!a)return a;for(b=0;b<a.length&&(c=a.indexOf("<!--",b),!(c<0))&&(b=c,d=a.indexOf("-->",b),!(d<0));)b=d,a=a.substring(0,c)+a.substring(d+3);return a}function v(a,b,c){var d,e=-1;if(c)for(e=0,d=0;d<b;d++)e+=c[a+d]||0;return e}function w(a,b,c){var d,e=-1;if(c)for(e=0,d=0;d<b;d++)e+=c[a+d]||0;return e}o=function(){function a(a){var b=this;b.PA=n,b.n5=n,b.G4=!1,b.tc=a,b.Nl()}return a.prototype.Nl=function(){var b,c,e,f=this,g=document.createElement("div");g.style.position="fixed",g.style.top="0px",g.style.left="0px",g.style.width="0px",g.style.height="0px",g.style.overflow="hidden",b=document.createElement("div"),b.setAttribute("contenteditable","true"),b.setAttribute("gcUIElement","gcSheetClipboard"),b.setAttribute("tabindex","-1"),b.style.position="absolute",b.style.overflow="hidden",b.style.background="white",b.style.webkitUserSelect="text",g.appendChild(b),f.KM=b,c=document.createElement("textarea"),c.setAttribute("gcUIElement","gcSheetClipboard"),f.tc&&f.tc.options.enableAccessibility&&c.setAttribute("aria-hidden","true"),c.setAttribute("tabindex","-1"),c.style.position="absolute",c.style.overflow="hidden",c.style.background="white",c.style.webkitUserSelect="text",g.appendChild(c),f.qka=c,e=f.tc.getHost(),e&&e.appendChild(g),k.msie||k.edge||(f.H4=function(b){var c,e,g,h,i,k,l,m=d.sJc(f.tc),n=b.clipboardData;if(n)if(c=n.getData("text/html"),c=c.replace(j,""),e=f.I4(),e.innerHTML=c,g=c?f.EZa(e,!0):a.formatClipboardData(n.getData("text/plain")),e.innerHTML="",g||c&&c.indexOf("<table")>=0)m.J4(g,c);else{for(h=void 0,i=n.items,k=0;k<i.length&&(0!==i[k].type.indexOf("image")||!(h=i[k].getAsFile()));k++);h&&(l=new FileReader,l.onload=function(a){var b=new Image;b.src=a.target.result,b.onload=function(){m.J4(g,c,b.src)}},l.readAsDataURL(h))}b.preventDefault()},b.addEventListener("paste",f.H4),f.rka=function(b){var c,e,g,h=d.sJc(f.tc),i=b.clipboardData;i&&(c=a.formatClipboardData(i.getData("text/plain")),c||(e=i.getData("text/html"),e&&(g=f.I4(),g.innerHTML=e,c=f.EZa(g,!1),g.innerHTML="")),h.J4(c,"")),b.preventDefault()},c.addEventListener("paste",f.rka))},a.prototype.no=function(){var a,b,c,d,e,f,g=this,h=g.KM;h&&(k.msie||k.edge||(h.removeEventListener("paste",g.H4),g.qka.removeEventListener("paste",g.rka)),a=h.parentElement,a&&(b=a.parentElement,b&&b.removeChild(a)),g.KM=n,g.qka=n),c=g.K4,c&&(d=c.parentElement,d&&d.removeChild(c),g.K4=n),e=g.FZa,e&&(f=e.parentElement,f&&f.removeChild(e),g.FZa=n),g.tc=n},a.prototype.ska=function(a){p(this.tc)?this.KM.innerHTML=a:this.qka.value=a},a.prototype.M4=function(){p(this.tc)?this.KM.focus():this.qka.focus()},a.prototype.N4=function(){p(this.tc)?document.execCommand("selectAll"):this.qka.select()},a.prototype.wx=function(){var b,c,d,e="",f="",g="";return p(this.tc)?(b=this.KM,b&&(c=b.getElementsByTagName("table"),c.length>0?e=c[0].outerHTML:(d=b.getElementsByTagName("img"),d.length>0&&(g=d[0].src))),f=this.EZa(this.KM,!0)):f=a.formatClipboardData(this.qka.value),{html:e,text:f,image:g}},a.Q4=function(b,c,e,f,g,i,j,k,l,m,o,p,q,r){var u,v,w,x,y,z,A,B,C,D,E,F=b.Tq(d.kf(e,g,f,i),j),G=RegExp(String.fromCharCode(32),"g"),H="&nbsp;",I=!1,J=!1;return j===h.SheetArea.viewport&&(e<0&&2===(2&c)&&(I=!0),
g<0&&1===(1&c)&&(J=!0)),e=F.row,g=F.col,f=F.rowCount,i=F.colCount,u=o?b.options.gridline:n,v=o?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:n,w=q?s(b,e,f,j):n,x=q?t(b,g,i,j):n,j===h.SheetArea.viewport?(y=void 0,z=void 0,A=n,B=n,C=a.Ema(b,e,f,g,i,3,l,m,k,F,G,H,u,p,w,x,r),J&&(y=q?t(b,g,i,2):n,D=b.getColumnCount(2),A=a.Ema(b,e,f,0,D,2,l,[],k,F,G,H,v,p,w,y,r)),I&&(z=q?s(b,e,f,1):n,E=b.getRowCount(1),B=a.Ema(b,0,E,g,i,1,[],m,k,F,G,H,v,p,z,x,r)),a.yb(C,A,B,r)):j===h.SheetArea.rowHeader?(A=a.Ema(b,e,f,g,i,2,l,m,k,F,G,H,v,p,w,x,r),a.yb(A,n,n,r)):j===h.SheetArea.colHeader?(B=a.Ema(b,e,f,g,i,1,l,m,k,F,G,H,v,p,w,x,r),a.yb(B,n,n,r)):void 0},a.yb=function(b,c,d,e){var f,g,h=b,i=0,j=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(a[c].concat(b[c]));return d};return c&&(i=c[0].length,h=j(c,b)),d&&(f=d.length,i&&(g=a.Ema(n,0,f,0,i,n,[],[],!1,n,n,n,n,!1,[],[],e),d=j(g,d)),h=d.concat(h)),a.Fma(h,e)},a.Fma=function(a,b){var c,d,e="",f=a.length;for(e+=b?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true">',c=0;c<f;c++){for(e+="<tr>",d=0;d<a[c].length;d++)e+=a[c][d];e+="</tr>"}return e+="</table>"},a.gYc=function(a){return a&&a.indexOf('gc-sjs-clipboard="true"')>=0},a.Ema=function(b,c,e,f,g,h,j,o,p,q,r,s,t,u,v,w,x){var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa;for(t&&(y=t.color,z=t.showHorizontalGridline,A=t.showVerticalGridline),B=[],C=0;C<e;C++)if(D=c+C,!(m(j,D)||x&&v&&v[D]<=0)){for(E=[],F=0;F<g;F++)if(G=f+F,!(m(o,G)||x&&w&&w[G]<=0)){if(H="",I=void 0,J=void 0,K=1,L=1,p&&b&&(I=b.getSpan(D,G,h),I&&a.isPartSpan(I,q,j,o)&&(I=n),I)){if(I.row!==D||I.col!==G)continue;J=b.getActualStyle(D,G,h),M=b.getActualStyle(I.row+I.rowCount-1,I.col+I.colCount-1,h),!J.borderRight&&M.borderRight&&(J.borderRight=M.borderRight),!J.borderBottom&&M.borderBottom&&(J.borderBottom=M.borderBottom)}H+="<td",N=b&&b.getValue(D,G,h),p&&b&&(I&&(K=I.rowCount,K>1&&(H+=" rowSpan="+K),L=I.colCount,L>1&&(H+=" colSpan="+L)),J||(J=b.getActualStyle(D,G,h)),O=a.convertVAlign,P=a.convertHAlign,Q=a.convertLineBorder,H+=x?' style="padding: 0; ':' style="',R=z,S=A,T=J.backColor,T&&(H+="background-color: "+T+";",R=!1,S=!1),U=J.foreColor,U&&(H+="color: "+U+";"),V=J.font,V&&(u&&(V=V+", "+d.FallbackFontFamily),H+="font: "+V.replace(/"/g,"'")+";"),W=J.vAlign,l(W)||(H+="vertical-align: "+O(W)+";"),X=J.hAlign,l(X)||(x&&(X=d.Ul.ol(X,N)),Y=P(X),Y&&(H+="text-align: "+Y+";")),Z=J.borderLeft,Z&&(H+="border-left: "+Q(Z)+";",S=!1),$=J.borderRight,$&&(H+="border-right: "+Q($)+";",S=!1),_=J.borderTop,_&&(H+="border-top: "+Q(_)+";",R=!1),aa=J.borderBottom,aa&&(H+="border-bottom: "+Q(aa)+";",R=!1),R&&S?H+="border: 1px solid "+y+";":R?(H+="border-top: 1px solid "+y+";",H+="border-bottom: 1px solid "+y+";"):S&&(H+="border-left: 1px solid "+y+";",H+="border-right: 1px solid "+y+";"),ba=V?d.Ul.fp(V):0,H+=a.dYc(C,F,K,L,v,w,ba),H+='"'),H+=">",ca=void 0,da=void 0,p&&b&&(ea=J.textDecoration,ca=2===(2&ea),da=1===(1&ea),da||(da=8===(8&ea)),ca&&(H+="<s>"),da&&(H+="<u>")),fa=b?b.getText(D,G,h):"",fa?(" "!==fa[0]&&" "!==fa[fa.length-1]||"number"!=typeof N||(fa=fa.trim()),fa=i.Ob(fa).replace(r,s)):k.chrome?fa=" ":k.safari&&(fa="&nbsp;"),H+=fa,p&&(da&&(H+="</u>"),ca&&(H+="</s>")),H+="</td>",E.push(H)}B.push(E)}return B},a.dYc=function(a,b,c,d,e,f,g){var h,i,j="",k=v(a,c,e);return k>0&&(k-=1),h=w(b,d,f),h>0&&(h-=1),k>=0&&h>=0&&(i=Math.min(g,k),j="overflow: hidden;white-space: nowrap;height: "+k+"px;line-height: "+i+"px; width: "+h+"px;max-width: "+h+"px;min-width: "+h+"px;"),j},a.prototype.I4=function(){var a,b,c=this;return c.K4||(a=document.createElement("div"),a.style.display="none",b=c.tc.getHost(),b&&b.appendChild(a),c.K4=a),c.K4},a.prototype.GZa=function(){var a,b,c=this;return c.FZa||(a=document.createElement("div"),a.style.display="none",b=c.tc.getHost(),b&&b.appendChild(a),c.FZa=a),c.FZa},a.prototype.R4=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=this.I4();if(q.innerHTML=a,e=q.getElementsByTagName("table"),f=b.KLc(),e.length>0)for(g=this.HZa(e[0],!0),h=0,i=c+h;h<g.length;h++,i++){if(j=g[h],f)for(;0===b.getRowHeight(i);)i++;for(k=0,l=d+k;k<j.length;k++,l++)if(m=j[k]){if(f)for(;0===b.getColumnWidth(l);)l++;b.Pq(i,l,m.style),n=m.rowSpan,o=m.colSpan,(n>1||o>1)&&(p=b.getSpan(i,l),p?(p.row=i,p.col=l,p.rowCount=n,p.colCount=o):b.addSpan(i,l,n,o))}}q.innerHTML=""},a.prototype.lgc=function(a,b,c,d){var e,f,g=b.pictures;g&&(e=r(g),f=g.add(e,a,0,0),f.startRow(c),f.startColumn(d))},a.prototype.HZa=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=this.GZa(),q=[],r=/ +/g;for(d=0;d<b.rows.length;d++)for(e=b.rows[d],q[d]||(q[d]=[]),f=q[d],g=0,h=0;g<e.cells.length;g++){for(i=e.cells[g];f[h];)h++;for(j=f[h]={},k=void 0,c&&(k=a.getStyleFromDOM(i),j.style=k),p.innerHTML=i.innerHTML.replace(r," "),j.text=p.innerText,j.rowSpan=i.rowSpan,l=i.getAttribute("style"),l&&l.search(/mso-ignore:\s*colspan/)>=0?j.colSpan=1:j.colSpan=i.colSpan,m=0;m<i.rowSpan;m++)for(n=0;n<i.colSpan;n++)0===m&&0===n||(q[d+m]||(q[d+m]=[]),o=q[d+m],o[h+n]={style:k,text:"",rowSpan:1,colSpan:1});h+=i.colSpan}return p.innerHTML="",q},a.prototype.EZa=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=[];if(a)if(c=a.getElementsByTagName("table"),c.length>0)for(d=this.HZa(c[0],!1),e=RegExp(String.fromCharCode(160),"g"),f=String.fromCharCode(32),g=0,h=d.length;g<h;g++){for(i=d[g],j=0,k=i.length;j<k;j++)l=i[j]?i[j].text:"",l.indexOf("\n")>=0&&(b?(l.indexOf("\r\n")>=0&&(l=q(l.split("\r\n"),!0)),l=q(l.split("\n"),!0)):l='"'+l+'"'),m.push(l.replace(e,f)),j<k-1&&m.push("\t");g<h-1&&m.push("\r\n")}else m.push(u(a.innerText).trim());return m.join("")},a.prototype.hZ=function(a){var b=this;b.PA=n,b.n5=n,b.G4=!1,b.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!a})},a.isPartSpan=function(a,b,c,d){var e,f,g,h,i,j;if(!b.containsRange(a))return!0;for(e=0,f=c;e<f.length;e++)if(g=f[e],a.row<=g&&g<a.row+a.rowCount)return!0;for(h=0,i=d;h<i.length;h++)if(j=i[h],a.col<=j&&j<a.col+a.colCount)return!0;return!1},a.formatClipboardData=function(a){var b,c,d,e,f,g=[];if(a){for(b='"',c=!1,d=0;d<a.length;d++)e=d>0?a[d-1]:"",f=a[d],f===b?(c=!c,g.push(b)):c||"\n"!==f||"\r"===e?g.push(f):g.push("\r\n");return g.join("")}return""},a.convertHAlign=function(a){var b={0:"left",1:"center",2:"right"};return b[a]},a.convertVAlign=function(a){var b={0:"top",1:"middle",2:"bottom"};return b[a]},a.convertLineBorder=function(a){var b={0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"},c={9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5};return c[a.style]+"pt "+b[a.style]+" "+a.color},a.convertToHAlign=function(a){var b={left:0,center:1,right:2};return b[a]},a.convertToVAlign=function(a){var b={top:0,middle:1,bottom:2};return b[a]},a.convertToLineBorder=function(a,b,c){var d={none:0,solid:1,dashed:3,dotted:4,double:6};return(k.msie||k.edge)&&"2px"===c?d.solid=5:(c=Math.round(10*parseFloat(c)*3/4)/10,c<=.8?d.solid=1:c<=1?(d.solid=2,d.dashed=8):c<=1.5&&(d.solid=5)),new g.LineBorder(a,d[b])},a.convertToTextDecoration=function(a){var b={underline:1,"line-through":2,none:0};return b[a]},a.isTransparent=function(a){return 0===e.Common.pc.ec(a).a},a.isBlack=function(a){var b=e.Common.pc.ec(a);return 0!==b.a&&0===b.r&&0===b.g&&0===b.b},a.getStyleFromDOM=function(b){var c,d,e,h,i,j,l,m,n,o,p,q,r,s,t=b.getElementsByTagName("font")[0],u=getComputedStyle(b),v=b.style,w=new g.Style,x=u.backgroundColor;return x&&!a.isTransparent(x)&&(w.backColor=x),c=u.color,t&&(c=t.color),c&&!a.isBlack(c)&&(w.foreColor=c),t?w.font=f.To.F4(getComputedStyle(t)):(d=f.To.F4(u),d&&(w.font=d)),e=u.verticalAlign,h=a.convertToVAlign,i=a.convertToHAlign,j=a.convertToLineBorder,l=a.convertToTextDecoration,e&&(w.vAlign=h(e)),m=v.textAlign,n=u.textAlign,k.msie||k.edge?""!==m?w.hAlign=i(m):w.hAlign=i("general"):n&&(w.hAlign=i(n)),o=u.borderLeftStyle,"none"!==o&&(w.borderLeft=j(u.borderLeftColor,o,u.borderLeftWidth)),p=u.borderRightStyle,"none"!==p&&(w.borderRight=j(u.borderRightColor,p,u.borderRightWidth)),q=u.borderTopStyle,"none"!==q&&(w.borderTop=j(u.borderTopColor,q,u.borderTopWidth)),r=u.borderBottomStyle,"none"!==r&&(w.borderBottom=j(u.borderBottomColor,r,u.borderBottomWidth)),s=l(u.textDecorationLine||u.textDecoration),b.getElementsByTagName("u").length>0&&(s|=l("underline")),b.getElementsByTagName("s").length>0&&(s|=l("line-through")),0!==s&&(w.textDecoration=s),w},a}(),b.S4=o},"./dist/core/worksheet/style.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/core.enum.js"),j=e.GC$.each,k=f.Ul,l=k.Ol,m=d.Common.j.C4,n=d.Common.j.Fa,o=void 0,p=null,q=Math.sin,r=Math.cos,s=Math.abs,t=Math.max,u="autoFormatter",v="formatter",w="cellType",x="hAlign",y="vAlign",z="imeMode",A="labelOptions",B="cellButtons",C="dropDowns",D="applyFont",E="applyFill",F="applyAlignment",G="applyBorder",H="applyNumberFormat",I="applyProtection",J={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0};function Q(a){var b,c={};return a&&a.option&&a.option.dataSource?(b=a.option.dataSource,a.option.dataSource=o,c=m(a),c.option.dataSource=b,a.option.dataSource=b):c=m(a),c}!function(a){a[a.empty=0]="empty",a[a.thin=1]="thin",a[a.medium=2]="medium",a[a.dashed=3]="dashed",a[a.dotted=4]="dotted",a[a.thick=5]="thick",a[a.double=6]="double",a[a.hair=7]="hair",a[a.mediumDashed=8]="mediumDashed",a[a.dashDot=9]="dashDot",a[a.mediumDashDot=10]="mediumDashDot",a[a.dashDotDot=11]="dashDotDot",a[a.mediumDashDotDot=12]="mediumDashDotDot",a[a.slantedDashDot=13]="slantedDashDot"}(K=b.LineStyle||(b.LineStyle={})),function(a){a[a.conditionalFormat=1]="conditionalFormat",a[a.cell=10]="cell",a[a.table=20]="table",a[a.row=30]="row",a[a.column=40]="column",a[a.sheet=50]="sheet"}(L=b.LineBorderComposeLevel||(b.LineBorderComposeLevel={})),M=function(){function a(a,b,c){this.color=a||"black",this.style=b||0,this.level=c}return a.prototype.Uo=function(){return new a(this.color,this.style,this.level)},a.prototype.toJSON=function(){var a={},b=this,c=b.color,d=b.style;return"black"!==c&&(a.color=c),a.style=d,a},a.prototype.fromJSON=function(a,b){if(a){var c=this,d=a.color,e=a.style;l(d)&&(c.color=d),l(e)&&(c.style=e)}},a.Vo=function(a){var b=a&&a.style,c={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3};return c[b]||0},a}(),b.LineBorder=M;function R(a){return!(!a||"object"!=typeof a)&&(!a.patternColor&&!a.stops)}function S(a){return a&&a.type?{type:_(i.PatternType,a.type,o),patternColor:a.patternColor,backgroundColor:a.backgroundColor}:a}function T(a){return a?new M(a.color,_(K,a.style,o)):o}function U(a){var b,c,d,e;return a&&(b={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12"},c=b[a.type],c&&(d=h._o[c]))?(e=new d,e.lJc(a),e):a}function V(a){return a?{alignment:_(i.LabelAlignment,a.alignment,o),visibility:_(i.LabelVisibility,a.visibility,o),font:a.font,foreColor:a.foreColor,margin:a.margin}:o}function W(a){return a?a.map(function(a){return{position:_(i.ButtonPosition,a.position,o),useButtonStyle:a.useButtonStyle,enabled:a.enabled,width:a.width,caption:a.caption,imageSrc:a.imageSrc,imageSize:a.imageSize,captionAlign:_(i.CaptionAlignment,a.captionAlign,o),command:a.command,imageType:_(i.ButtonImageType,a.imageType,o),visibility:_(i.ButtonVisibility,a.visibility,o),hoverBackColor:a.hoverBackColor,buttonBackColor:a.buttonBackColor}}):o}function X(a){var b,c,d,f,g,h,j,k;if(a)return b=e.GC$.extend(!0,{},a),c=a.calendarPage,c&&(b.calendarPage=i.CalendarPage[c]),d=a.startDay,d&&(b.startDay=i.CalendarStartDay[d]),f=a.layout,f&&(g=f.direction,g&&(b.layout.direction=i.LayoutDirection[g]),h=f.displayAs,h&&(b.layout.displayAs=i.LayoutDisplayAs[h])),j=a.valueType,j&&(b.valueType=i.DropdownListValue[j]),k=a.direction,k&&(b.direction=i.LayoutDirection[k]),b}function Y(a){return a?a.map(function(a){return{type:_(i.DropDownType,a.type,o),option:X(a.option),submitCommand:a.submitCommand}}):o}function Z(a){var b;return b="lineThroughUnderline"===a?i.TextDecorationType.lineThrough|i.TextDecorationType.underline:"lineThroughDoubleUnderline"===a?i.TextDecorationType.lineThrough|i.TextDecorationType.doubleUnderline:_(i.TextDecorationType,a,i.TextDecorationType.none)}N=["backColor","foreColor",x,y,"font","themeFont",v,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",w,"backgroundImageLayout","tabStop","textDecoration",z,"name","parentName","watermark","cellPadding",A,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",B,C,"textOrientation"],O=[D,E,F,G,H,I],P=function(){function a(){var b,c,d,e,f=[];for(b=0;b<arguments.length;b++)f[b]=arguments[b];if(c=this,c._id=a.Wo,a.Wo++,0!==f.length)if(d=f[0],1===f.length&&R(d))c.lJc(d);else for(e=0;e<N.length;e++)c[N[e]]=f[e]}return a.kxb=function(a,b){var c=a.parentName;c&&!b.getNamedStyle(c)&&delete a.parentName},a.prototype.Yo=function(a,b,c,d){var e,f,g,h,i,j,k,l,n,p=this,q=a.labelOptions,r=a.cellButtons;if(a.cellButtons&&a.cellButtons.length>0)for(r=[],k=0;k<a.cellButtons.length;k++)r.push(m(a.cellButtons[k]));if(l=a.dropDowns,a.dropDowns&&a.dropDowns.length>0)for(l=[],k=0;k<a.dropDowns.length;k++)l.push(Q(a.dropDowns[k]));b?(p._autoFormatter=a._autoFormatter,p.backgroundImage=a.backgroundImage,p.backgroundImageLayout=a.backgroundImageLayout,p.backColor=a.backColor,p.foreColor=a.foreColor,p.hAlign=a.hAlign,p.vAlign=a.vAlign,p.font=a.font,p.themeFont=a.themeFont,p.formatter=a.formatter,p.showEllipsis=a.showEllipsis,p.THb=a.THb,e=a.borderLeft,p.borderLeft=e&&e.Uo()||e,p.borderLeft&&c&&(p.borderLeft.level=c),f=a.borderTop,p.borderTop=f&&f.Uo()||f,p.borderTop&&c&&(p.borderTop.level=c),g=a.borderRight,p.borderRight=g&&g.Uo()||g,p.borderRight&&c&&(p.borderRight.level=c),h=a.borderBottom,p.borderBottom=h&&h.Uo()||h,p.borderBottom&&c&&(p.borderBottom.level=c),i=a.diagonalDown,p.diagonalDown=i&&i.Uo()||i,p.diagonalDown&&c&&(p.diagonalDown.level=c),j=a.diagonalUp,p.diagonalUp=j&&j.Uo()||j,p.diagonalUp&&c&&(p.diagonalUp.level=c),p.locked=a.locked,p.textIndent=a.textIndent,p.wordWrap=a.wordWrap,p.shrinkToFit=a.shrinkToFit,p.cellType=a.cellType,p.name=a.name,p.parentName=a.parentName,p.tabStop=a.tabStop,p.textDecoration=a.textDecoration,p.imeMode=a.imeMode,p.watermark=a.watermark,p.cellPadding=a.cellPadding,p.isVerticalText=a.isVerticalText,p.textOrientation=a.textOrientation,q&&(p.labelOptions={alignment:q.alignment,font:q.font,foreColor:q.foreColor,visibility:q.visibility,margin:q.margin}),p.quotePrefix=a.quotePrefix,p.cellButtons=r,p.dropDowns=l):(p.backgroundImage===o&&(p.backgroundImage=a.backgroundImage),p.backgroundImageLayout===o&&(p.backgroundImageLayout=a.backgroundImageLayout),p.backColor===o&&(p.backColor=a.backColor),p.foreColor===o&&(p.foreColor=a.foreColor),p.hAlign===o&&(p.hAlign=a.hAlign),p.vAlign===o&&(p.vAlign=a.vAlign),p.themeFont===o&&p.font===o?(p.themeFont=a.themeFont,p.font=a.font):p.themeFont!==o&&p.font===o&&(p.font=a.font),p.formatter===o&&(p.formatter=a.formatter),p.showEllipsis===o&&(p.showEllipsis=a.showEllipsis),p.THb===o&&(p.THb=a.THb),p._autoFormatter===o&&(p._autoFormatter=a._autoFormatter),p.borderLeft===o&&(e=a.borderLeft,p.borderLeft=e&&e.Uo()||e,p.borderLeft&&c&&(p.borderLeft.level=c)),p.borderTop===o&&(f=a.borderTop,p.borderTop=f&&f.Uo()||f,p.borderTop&&c&&(p.borderTop.level=c)),p.borderRight===o&&(g=a.borderRight,p.borderRight=g&&g.Uo()||g,p.borderRight&&c&&(p.borderRight.level=c)),p.borderBottom===o&&(h=a.borderBottom,p.borderBottom=h&&h.Uo()||h,p.borderBottom&&c&&(p.borderBottom.level=c)),p.diagonalDown===o&&(i=a.diagonalDown,p.diagonalDown=i&&i.Uo()||i,p.diagonalDown&&c&&(p.diagonalDown.level=c)),p.diagonalUp===o&&(j=a.diagonalUp,p.diagonalUp=j&&j.Uo()||j,p.diagonalUp&&c&&(p.diagonalUp.level=c)),p.locked===o&&(p.locked=a.locked),p.textIndent===o&&(p.textIndent=a.textIndent),p.wordWrap===o&&(p.wordWrap=a.wordWrap),p.shrinkToFit===o&&(p.shrinkToFit=a.shrinkToFit),p.cellType===o&&(p.cellType=a.cellType),p.tabStop===o&&(p.tabStop=a.tabStop),p.textDecoration===o&&(p.textDecoration=a.textDecoration),p.imeMode===o&&(p.imeMode=a.imeMode),p.name===o&&(p.name=a.name),p.parentName===o&&(p.parentName=a.parentName),p.watermark===o&&(p.watermark=a.watermark),p.cellPadding===o&&(p.cellPadding=a.cellPadding),!p.labelOptions&&q&&(p.labelOptions={}),n=p.labelOptions,n&&q&&(n.alignment===o&&(n.alignment=q.alignment),n.font===o&&(n.font=q.font),n.foreColor===o&&(n.foreColor=q.foreColor),n.visibility===o&&(n.visibility=q.visibility),n.margin===o&&(n.margin=q.margin)),d||p.quotePrefix!==o||(p.quotePrefix=a.quotePrefix),p.isVerticalText===o&&(p.isVerticalText=a.isVerticalText),p.textOrientation===o&&(p.textOrientation=a.textOrientation),p.cellButtons===o&&(p.cellButtons=r),p.dropDowns===o&&(p.dropDowns=l))},a.prototype.$b=function(a){var b=this;0===arguments.length?(j(N,function(a,c){b[c]=o}),j(O,function(a,c){l(b[c])&&(b[c]=o)})):b[a]=o},a.prototype.clone=function(b){var c=this,d=c.borderLeft,e=c.borderTop,f=c.borderRight,g=c.borderBottom,h=c.diagonalDown,i=c.diagonalUp,j=new a;return j.backColor=c.backColor,j.foreColor=c.foreColor,j.hAlign=c.hAlign,j.vAlign=c.vAlign,j.font=c.font,j.themeFont=c.themeFont,j.formatter=o,j.borderLeft=d&&!b&&d.Uo()||d,j.borderTop=e&&!b&&e.Uo()||e,j.borderRight=f&&!b&&f.Uo()||f,j.borderBottom=g&&!b&&g.Uo()||g,j.locked=c.locked,j.textIndent=c.textIndent,j.wordWrap=c.wordWrap,j.shrinkToFit=c.shrinkToFit,j.backgroundImage=c.backgroundImage,j.cellType=o,j.backgroundImageLayout=c.backgroundImageLayout,j.tabStop=c.tabStop,j.textDecoration=c.textDecoration,j.imeMode=c.imeMode,j.name=c.name,j.parentName=c.parentName,j.watermark=c.watermark,j.cellPadding=c.cellPadding,j.labelOptions=c.labelOptions,j.quotePrefix=c.quotePrefix,j.diagonalDown=h&&!b&&h.Uo()||h,j.diagonalUp=i&&!b&&i.Uo()||i,j.isVerticalText=c.isVerticalText,j.showEllipsis=c.showEllipsis,j.THb=c.THb,j.textOrientation=c.textOrientation,$(c,j),da(j,c.formatter,!b),ea(j,c._autoFormatter,!b),aa(j,c.cellType,!b,!0),ba(j,c.cellButtons,!b,!0),ca(j,c.dropDowns,!b,!0),j},a.prototype.Zo=function(a){var b,c,d,e,f,h,i,j,k=this;if(a&&a.getColor){if(fa(a,k.foreColor,function(a){k.foreColor=a}),b=k.backColor,"string"==typeof b)fa(a,b,function(a){k.backColor=a});else if(b&&(b.backgroundColor&&fa(a,b.backgroundColor,function(a){b.backgroundColor=a}),b.patternColor&&fa(a,b.patternColor,function(a){b.patternColor=a}),b.stops))for(c=function(c){fa(a,b.stops[c].color,function(a){b.stops[c].color=a})},d=0;d<b.stops.length;d++)c(d);for(e=[k.borderLeft,k.borderTop,k.borderRight,k.borderBottom,k.diagonalDown,k.diagonalUp],f=function(b,c){var d=e[b];d&&d.color&&fa(a,d.color,function(a){d.color=a})},d=0,h=e.length;d<h;d++)f(d,h)}return i=k.themeFont,j=k.font,a&&a.getFont&&(i?k.font=g.To.Io(j,a.getFont(i)):j||(k.font=g.To.Io(j,a.bodyFont()))),k},a.prototype.$o=function(a){var b,c=this,d=c._autoFormatter;d&&a!==p&&(b=d.getPreferredEditingFormatter(a),b.isAuto=!0,c._autoFormatter=b)},a.prototype.toJSON=function(a,b){var c,d,f=this,g={},h=f._autoFormatter;for(!l(h)||b&&ga(u,h,a)||(h.toJSON&&(h=h.toJSON()),e.GC$.isEmptyObject(h)||(g[u]=h)),c=0;c<N.length;c++)d=N[c],h=f[d],d!==A||e.GC$.isEmptyObject(h)?d!==C&&d!==B||e.GC$.isEmptyObject(h)?!l(h)||b&&ga(d,h,a)||(g[d]=h&&h.toJSON?h.toJSON():h):g[d]=h:g[A]=h;for(c=0;c<O.length;c++)d=O[c],h=f[d],l(h)&&(g[d]=h);return e.GC$.isEmptyObject(g)?o:g},a.prototype.fromJSON=function(b,c,d){var e,f,g,h,i;if(b){e=this;for(f in b)if(b.hasOwnProperty(f)){if(g=b[f],!l(g))continue;h={p:f,v:g,r:!1},h.noSchema=c,h.context=d,a.ao(e,"fromJson",h),h.r||("formatter"===f?da(e,g,!0):"autoFormatter"===f?ea(e,g,!0):f===w?aa(e,g,!0,c):J[f]?g===p?e[f]=null:(i=new M,i.fromJSON(g,c),e[f]=i):e[f]=g)}}},a.prototype.lJc=function(a){var b=this;b.backColor=S(a.backColor),b.foreColor=a.foreColor,b.hAlign=_(i.HorizontalAlign,a.hAlign,o),b.vAlign=_(i.VerticalAlign,a.vAlign,o),b.font=a.font,b.themeFont=a.themeFont,b.formatter=a.formatter,b.borderLeft=T(a.borderLeft),b.borderTop=T(a.borderTop),b.borderRight=T(a.borderRight),b.borderBottom=T(a.borderBottom),b.diagonalDown=T(a.diagonalDown),b.diagonalUp=T(a.diagonalUp),b.locked=a.locked,b.textIndent=a.textIndent,b.wordWrap=a.wordWrap,b.shrinkToFit=a.shrinkToFit,b.backgroundImage=a.backgroundImage,b.cellType=U(a.cellType),b.backgroundImageLayout=_(i.ImageLayout,a.backgroundImageLayout,o),b.tabStop=a.tabStop,b.textDecoration=Z(a.textDecoration),b.imeMode=_(i.ImeMode,a.imeMode,o),b.name=a.name,b.parentName=a.parentName,b.watermark=a.watermark,b.cellPadding=a.cellPadding,b.labelOptions=V(a.labelOptions),b.isVerticalText=a.isVerticalText,b.textOrientation=a.textOrientation,b.showEllipsis=a.showEllipsis,b.cellButtons=W(a.cellButtons),b.dropDowns=Y(a.dropDowns),$(a,b)},a}(),b.Style=P;function $(a,b){n(a.applyFill)||(b.applyFill=a.applyFill),n(a.applyFont)||(b.applyFont=a.applyFont),n(a.applyAlignment)||(b.applyAlignment=a.applyAlignment),n(a.applyBorder)||(b.applyBorder=a.applyBorder),n(a.applyProtection)||(b.applyProtection=a.applyProtection),n(a.applyNumberFormat)||(b.applyNumberFormat=a.applyNumberFormat)}function _(a,b,c){c=c||o;var d;return n(b)||(d=a[b]),n(d)?c:d}function aa(a,b,c,d){var e,g,i,j,k=b;if(c&&b){if(e=b.gQa&&b.gQa())return void(a.cellType=k);b.toJSON&&(b=b.toJSON()),g=h._o,i=b.typeName,j=g[b.type]||g[i]||f.getTypeFromString(i),j?(k=new j,k.fromJSON(b,d)):k=o}a.cellType=k}function ba(a,b,c,d){var e,f;if(b===p&&(a.cellButtons=b),b){if(e=b,c)for(e=[],f=0;f<b.length;f++)e.push(m(b[f]));a.cellButtons=e}}function ca(a,b,c,d){var e,f;if(b===p&&(a.dropDowns=b),b){if(e=b.slice(),c)for(e=[],f=0;f<b.length;f++)e.push(m(b[f]));a.dropDowns=e}}function da(a,b,c){var e,g,h,i,j=b;c&&b&&"object"==typeof b&&(b.toJSON&&(b=b.toJSON()),e=d.Formatter,g=e&&e.GeneralFormatter,g&&(h=b.typeName,h?(i=f.getTypeFromString(h),i&&(j=new i,j.fromJSON(b))):j=new g(b.formatCached,b.customerCultureName))),a.formatter=j}function ea(a,b,c){var e,f,g=b;c&&b&&(b.toJSON&&(b=b.toJSON()),e=d.Formatter,f=e&&e.GeneralFormatter,f&&(g=new f(b.formatCached,b.customerCultureName),g.isAuto=!0)),a._autoFormatter=g}function fa(a,b,c){b&&(b=a.getColor(b),b&&c(b))}function ga(a,b,c){return a===x?2===c?1===b:1===c?1===b:3===b:a===y?2===c?1===b:1===c?1===b:0===b:a===z?1===b:a===u?b===o:void 0}f.Zn(P),P.Wo=0},"./dist/core/worksheet/stylehelper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/util/common.js"),f=document,g=Math.max,h=Math.min,i=void 0,j="#FFFFFF",k="#000000",l=Math.abs,m=Math.PI,n=Math.cos,o=Math.sin,p=Math.atan,q=Math.tan,b.Ho="11pt",r={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]};function t(a){return a=a||0,a=g(a,0),a=h(a,1)}s=function(){function a(){}return a.Io=function(b,c){return c?a.Jo(b,c):b},a.Ko=function(b){var c,d;return b?(c=a.Lo(),c.style.font=b,d=c.style,{fontFamily:d.fontFamily,fontSize:d.fontSize,fontStyle:d.fontStyle,fontWeight:d.fontWeight}):{}},a.F4=function(a){var b,c,d,f,g,h,i,j,k,l,m;return e.Ul.Ml.safari?a.font:(b="",c="normal",d="400",f="11pt",g="Calibri",h=a.fontStyle,i=a.fontVariant,j=a.fontWeight,k=a.lineHeight,l=a.fontSize,m=a.fontFamily,h&&h!==c&&(b=h),i&&i!==c&&(b+=(b?" ":"")+i),j&&j!==c&&j!==d&&(b+=(b?" ":"")+j),l=l?l:f,b+=(b?" ":"")+l,k&&k!==c&&(b+="/"+k),m=m?m:g,b+=" "+m)},a.Jo=function(c,e){var g,h,i,j,k;if(!c&&!e)return c;if(c){if(h=e?c+"+"+e:c,i=a.Mo[h])return i;g=a.Lo(),d.GC$(g).css("font",c)}else{if(h=e,i=a.Mo[h])return i;g=a.Lo(),d.GC$(g).css("fontSize",b.Ho)}return e&&d.GC$(g).css("fontFamily",e),j=g.currentStyle,k=f.defaultView,k&&k.getComputedStyle&&(j=k.getComputedStyle(g,"")),i=a.F4(j),a.Mo[h]=i,a.Mo[i]=i,i},a.No=function(b,c,d,e){var h,i,j,k,l,m,n,o,p,q=a.Oo[c];if(!e)if(q){if(h=q[b])return h}else q=a.Oo[c]={};return i=a.Lo(),i.style.font=b,j=i.currentStyle,k=f.defaultView,k&&k.getComputedStyle&&(j=k.getComputedStyle(i,"")),l=j.fontSize,m="px",l.indexOf(m)!==-1&&(n=g(1,parseFloat(l.replace(m,""))*c),d&&1===n&&(d.value=!0),l=n+m),o=j.lineHeight,o.indexOf(m)!==-1&&(p=g(1,parseFloat(o.replace(m,""))*c),o=p+m),1===c?h={font:b,fontFamily:i.style.fontFamily,fontSize:n}:(i.style.fontSize=l,i.style.lineHeight=o,h={font:i.style.font,fontFamily:i.style.fontFamily,fontSize:n}),e||(q[b]=h),h},a.Lo=function(){var b,c,d;return a.Po?a.Po.style.cssText=a.Qo:(b="-10000px",c=e.Ul.Nl("span"),d=c.style,d.visibility="hidden",d.top=b,d.left=b,d.lineHeight="normal",d.position="absolute",d.fontWeight="normal",d.fontStretch="normal",d.fontVariant="normal",d.fontStyle="normal",f.body.insertBefore(c,null),a.Po=c,a.Qo=d.cssText),a.Po},a.no=function(){var b=a.Po;b&&(d.GC$(b).remove(),a.Po=i,a.Qo=i)},a.stringFontCatch={},a.Ro=function(b,c){var d,e=b+","+c,f=a.stringFontCatch,g=f[e];return g||(d=a.Lo(),d.style.font=b,c&&(d.style.fontWeight=c),g=f[e]=d.style.font),g},a.Mo={},a.Oo={},a.So=function(a){if(a<=0)return"none";var b="";return(1|a)===a&&(b+="underline "),(2|a)===a&&(b+="line-through "),(4|a)===a&&(b+="overline "),b.trim()},a.setFillStyle=function(b,c,d,e,f,g,h){"string"==typeof c?(b.fillStyle!==c&&(b.fillStyle=c),h()):"path"===c.type?a.setFillStyle_Path(b,c,d,e,f,g,h):c.stops?a.setFillStyle_Gradient(b,c,d,e,f,g,h):c.type&&a.setFillStyle_patternFill(b,c,d,e,f,g,h)},a.setFillStyle_patternFill=function(a,b,c,d,e,f,g){var h,i,l,m,n,o=r[b.type],p=o.length,q=o[0].length,s=document.createElement("canvas");for(s.width=q,s.height=p,h=s.getContext("2d"),h.fillStyle=b.backgroundColor||j,h.fillRect(0,0,q,p),h.fillStyle=b.patternColor||k,i=0;i<p;i++)for(l=0;l<q;l++)m=o[i][l],m&&h.fillRect(l,i,1,1);a.createPattern(s,"repeat"),n=a.createPattern(s,"repeat"),a.fillStyle=n,g()},a.processStops=function(a){var b,c;if(a.stops||"path"===a.type){if(b=a.stops)if(0===b.length)b=[{position:0,color:k},{position:1,color:k}];else{for(b=b.filter(function(a,b,c){return a.position<=1&&a.position>=0}),b.sort(function(a,b){return a.position-b.position}),c=0;c<b.length;c++)b[c].color=b[c].color||k;0!==b[0].position&&b.splice(0,0,{position:0,color:k}),1!==b[b.length-1].position&&b.push({position:1,color:k})}else b=[{position:0,color:j},{position:1,color:j}];a.stops=b}"path"===a.type?(a.left=t(a.left),a.right=t(a.right),a.top=t(a.top),a.bottom=t(a.bottom)):a.stops&&(delete a.type,a.degree=a.degree||0)},a.setFillStyle_Gradient=function(a,b,c,d,e,f,g){var h,i,k,r,s,t,u,v=b.degree||0;for(v%90===0?(i=v/180*m,k=l(v%180/180*m)-p(f/e)):(i=p(e/f*q(v/180*m)),k=l(i)-p(f/e),i=Math.round(v/180)*m+i),r=Math.sqrt(e*e+f*f)/2,h=a.createLinearGradient(c+e/2-r*n(k)*n(i),d+f/2-r*n(k)*o(i),c+e/2+r*n(k)*n(i),d+f/2+r*n(k)*o(i)),s=b.stops,t=0,u=s.length;t<u;t++)h.addColorStop(s[t].position,s[t].color||j);a.fillStyle=h,g()},a.setFillStyle_Path=function(a,b,c,d,e,f,g){var h,i,k,l=b.left||0,m=b.right||0,n=b.top||0,o=b.bottom||0,p=b.stops;if(l>m&&(m=l),n>o&&(o=n),l>0){for(a.save(),a.beginPath(),h=a.createLinearGradient(c+e*l,0,c,0),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c,d-1),a.lineTo(c+e*l+1,d+f*n),a.lineTo(c+e*l+1,d+f*o),a.lineTo(c,d+f+1),a.clip(),g(),a.restore()}if(m<1){for(a.save(),a.beginPath(),h=a.createLinearGradient(c+e*m,0,c+e,0),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c+e,d-1),a.lineTo(c+e,d+f+1),a.lineTo(c+e*m-1,d+f*o),a.lineTo(c+e*m-1,d+f*n),a.clip(),g(),a.restore()}if(n>0){for(a.save(),a.beginPath(),h=a.createLinearGradient(0,d+f*n,0,d),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c,d),a.lineTo(c+e,d),a.lineTo(c+e*m,d+f*n+1),a.lineTo(c+e*l,d+f*n+1),a.clip(),g(),a.restore()}if(o<1){for(a.save(),a.beginPath(),h=a.createLinearGradient(0,d+f*o,0,d+f),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c+e,d+f),a.lineTo(c,d+f),a.lineTo(c+e*l,d+f*o-1),a.lineTo(c+e*m,d+f*o-1),a.clip(),g(),a.restore()}l<m&&n<o&&(a.save(),a.beginPath(),a.fillStyle=p[0].color,a.rect(c+e*l,d+f*n,e*(m-l),f*(o-n)),a.clip(),g(),a.restore())},a}(),b.To=s},"./dist/core/worksheet/worksheet-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("Common"),g=c("./dist/core/worksheet/style.js"),h=c("./dist/core/worksheet/worksheet.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/worksheet/clipboardhelper.js"),k=c("./dist/core/util/domUtil.js"),l=c("./dist/core/core.enum.js"),m=k.GC$,n=c("./dist/core/worksheet/worksheet-static.js"),o=c("CalcEngine"),p=!!o,q=e.Common.j.Fa,r=e.Common.k.Bb,s=e.Common.u,t=s.jb,u=i.Events.CellChanged,v=i.Events.ColumnWidthChanging,w=i.Events.ColumnWidthChanged,x=i.Events.RowHeightChanging,y=i.Events.RowHeightChanged,z=i.Ul.Ml,A=i.Ul.Ol,B=m.extend,C=m.inherit,D=null,E=void 0,F=Math.max,G=Math.min,H=Math.floor,I=Math.ceil,J=Number.MAX_VALUE,K=isNaN,L="^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$",M="^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$";function lb(a,b){return a.getRowCount(b)}function mb(a,b){return a.getColumnCount(b)}function nb(a){return a.rowCount}function ob(a){return a.colCount}function pb(a){var b=a.parent;return b&&b.options.allowExtendPasteRange}function qb(a){var b=a.parent;return b&&b.options.allowCopyPasteExcelStyle}function rb(a){var b=a.parent;return b&&b.options.copyPasteHeaderOptions}N=new e.Common.ResourceManager(d.SR),O=N.getResource.bind(N);function sb(a,b,c,d){throw Error(s.Kb(O().Exp_InvalidAndSpace,[a,b,c,d]))}function tb(a){a.suspendPaint()}function ub(a){a.resumePaint()}function vb(a){a.suspendEvent()}function wb(a){a.resumeEvent()}function xb(a,b){a&&p&&a.suspendCalcService(b)}function yb(a,b){a&&p&&a.resumeCalcService(b)}function zb(a,b,c,d,e){var f=a.getSpan(b,c,d);if(f&&e&&(f.row!==b||f.col!==c))return!0}function Ab(a){var b=this;b.Vw=1===(1&a),b.Ww=2===(2&a),b.Xw=8===(8&a),b.Yw=p&&16===(16&a),b.Zw=!0,b.$w=!0}function Bb(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,r,s,u,v,w,x,y;if(q(a)||""===a)return D;for((q(b)||""===b)&&(b="\r\n"),g="\n",(q(c)||""===c)&&(c="\t"),(q(d)||""===d)&&(d='"'),t(a,b)||(a+=b),h=!e,i=[],j=[],k="",m=!1,n=d.length,o=b.length,p=g.length,r=c.length,s=a.length,u=0;u<s;u++)k+=a[u],l=k.length,h&&l>=n&&d===k.substr(l-n,n)?m&&s>=u+1+n&&d===a.substr(u+1,n)?u+=n:m?(k=k.substr(0,l-n),m=!1):(v=k,0===v.indexOf(d)&&(k=k.substr(0,l-n),
m=!0)):!m&&l>=r&&c===k.substr(l-r,r)?(k=k.substr(0,l-r),j.push(""+k),k=""):!m&&l>=o&&b===k.substr(l-o,o)?(k=k.substr(0,l-o),j.push(""+k),i.push(j),j=[],k=""):!m&&l>=p&&g===k.substr(l-p,p)?(k=k.substr(0,l-p),j.push(""+k),i.push(j),j=[],k=""):m&&s>=u+1+r&&c===a.substr(u+1,r)&&","!==c&&(u+=n);if(m){if(j.length>0){for(w=void 0,w=0;w<i.length&&i[w]!==j;w++);w>=i.length&&i.push(j)}x=""+k,x&&(x=x.replace(RegExp(c,"g"),""),t(x,b)&&(x=x.substr(0,x.length-o)),0===i.length&&i.push([x]))}return 0===i.length&&(y=a,t(a,b)&&(y=y.substr(0,y.length-o)),i.push([y])),f&&Cb(i)&&/^(\s)*$/.test(a)&&a.substr(a.length-p,p)===g&&i.push([""]),i}function Cb(a){var b,c;if(a){for(b=0;b<a.length&&(c=a[b],c&&1===c.length);b++);if(b===a.length)return!0}return!1}function Db(a,b,c,d,e){var f,g,h,i,j,k,l,m,n=d.length,o=Gb(d);if(0!==n&&0!==o)for(f=new Ab(e),a&&(mb(a,2)<=0&&(f.Vw=!1),lb(a,1)<=0&&(f.Ww=!1)),g=f.Vw?mb(a,2):0,h=f.Ww?lb(a,1):0,i=0,o-=g,o<=0&&(o=0),n-=h,n<=0&&(i=0),n-=i,n<=0&&(n=0),f.Zw&&b+n>lb(a)&&a.setRowCount(b+n),f.$w&&c+o>mb(a)&&a.setColumnCount(c+o),j=0,k=0;j<d.length;j++,k++)l=d[j],m=a.KLc(),l.length<=0||(h>0&&j<h?Eb(a,l,k,c,o,1,f):n>0&&k<lb(a)&&(j===h&&(k=b),Eb(a,l,k,0,g,2,f),l.splice(0,g),m&&(k=a._q(k-1,3)),Eb(a,l,k,c,o,3,f,m)))}function Eb(a,b,c,d,e,f,g,h){var i,j,k=mb(a,f);for(i=0,j=d;i<b.length;i++,j++)e>0&&j<k&&(h&&(j=a.Zq(j-1,3)),Fb(a,f,c,j,b[i],g))}function Fb(a,b,c,d,e,g){var h,j,k,l,m,n,o,p=e,r=D;if(g.Xw===!1&&(h={value:D},p=i.Ul.ul(D,e,!g.Xw,h),r=h.value),q(p))a.setValue(c,d,p,b);else if(""!==e)if(g.Yw&&"="===e[0]&&e.length>1)try{a.setFormula(c,d,e.substr(1))}catch(f){a.setText(c,d,e,b)}else j=a.tq(c,d,"formatter",b),g.Xw===!1&&r?j?j&&("string"==typeof j&&f.Formatter&&(j=new f.Formatter.GeneralFormatter(j)),o=j.parse&&j.parse(e),p=q(o)?p:o):(r.isAuto=!0,a.getCell(c,d,b)._w("_autoFormatter",r),k=e,l=a.getCellType(c,d,b),m=r.formatString(),l&&"7"===l.typeName&&(n={sheet:a,row:c,col:d,sheetArea:b},k=l.parse(e,m,n),p=q(k)?e:k)):j&&a.getCell(c,d,b).formatter(D),a.setValue(c,d,p,b);else a.setValue(c,d,D,b)}function Gb(a){var b,c,d=0;for(b=0;b<(a&&a.length);b++)c=a[b],d=F(c.length,d);return d}function Hb(a,b,c,d,e,f,g,h,i,j){if(!a)throw Error(O().Exp_SheetIsNull);if((b<-1||b>=lb(a))&&sb("row",b,"-1",lb(a)-1),(c<-1||c>=mb(a))&&sb("column",c,"-1",mb(a)-1),!q(d)&&""!==d){b===-1&&(b=0),c===-1&&(c=0);var k=Bb(d,e,f,g,i,j);k&&k.length>0&&Db(a,b,c,k,h)}}function Ib(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,r,s,t,u,v,w,x,y,z,A;if(!a)throw Error(O().Exp_SheetIsNull);return o=lb(a),p=mb(a),(b<-1||b>=o)&&sb("row",b,"-1",o-1),(c<-1||b+c>o)&&sb("rowCount",c,"-1",o-b),(d<-1||d>=p)&&sb("column",d,"-1",p-1),(e<-1||d+e>p)&&sb("columnCount",e,"-1",p-d),r=-1,s=-1,t=!1,u=!1,b===-1&&d===-1&&c===-1&&e===-1?(b=0,d=0,r=lb(a)-1,s=mb(a)-1):(b===-1&&(b=0,2===(2&rb(a))&&(t=!0)),d===-1&&(d=0,1===(1&rb(a))&&(u=!0)),c===-1&&(c=lb(a)-b),e===-1&&(e=mb(a)-d),r=b+c-1,s=d+e-1),(q(f)||""===f)&&(f="\r\n"),(q(g)||""===g)&&(g="\t"),(q(h)||""===h)&&(h='"'),v=RegExp(h,"g"),w=null,x=null,y=Lb(a,b,r,d,s,3,j,k,f,g,h,v,i,l,m,n),u&&(z=a.getColumnCount(2),w=Lb(a,b,r,0,z-1,2,j,k,f,g,h,v,i,l,m,n)),t&&(A=a.getRowCount(1),x=Lb(a,0,A-1,d,s,1,j,k,f,g,h,v,i,l,m,n)),Jb(y,w,x,f,g)}function Jb(a,b,c,d,e){var f,g,h=a,i=0,j=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(a[c].concat(b[c]));return d};return b&&(i=b[0].length,h=j(b,a)),c&&(f=c.length,g=null,i&&(g=Lb(null,0,f-1,0,i-1,null,[],[],d,e,null,null,null,!1,!1),c=j(g,c)),h=c.concat(h)),Kb(h,d,e)}function Kb(a,b,c){var d,e,f="",g=a.length;for(d=0;d<g;d++){for(e=0;e<a[d].length;e++)0!==e&&(f+=c),f+=a[d][e];f+=b}return f}function Lb(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,s,t,u,v=[],w=a&&qb(a);for(q=b;q<=c;q++)if(!g||!r(g,q)){for(t=[],s=d;s<=e;s++)h&&r(h,s)||(u="",a&&!zb(a,q,s,f,n)&&(u=a.getText(q,s,f),p&&w&&u&&(u=" "!==u[0]&&" "!==u[u.length-1]||"number"!=typeof a.getValue(q,s,f)?u.replace(/[\r\n]+/g,"\n"):u.trim())),u=Mb(u,n,w,l,k,o,m,j,i),t.push(u));v.push(t)}return v}function Mb(a,b,c,d,e,f,g,h,i){var j="";return q(a)||(j=a,b&&c||(j=j.replace(d,e+e))),f&&!j&&(j=" "),b&&c?j=j.replace(/\n/g," "):(g||j.indexOf(e)!==-1||j.indexOf(h)!==-1||j.indexOf(i)!==-1||j.indexOf("\n")!==-1)&&(j=e+j+e),j}function Nb(a,b,c,d,e,f){var g,h,i,j,k,l=D,m=Bb(a,b,c,d,e,f);if(m){for(g=m.length,h=Gb(m),i=[],j=0;j<g;j++)for(i[j]=[],k=0;k<h;k++)k<m[j].length?i[j][k]=m[j][k]:i[j][k]=D;l=i}return l}B(h.Worksheet.prototype,{autoFitColumn:function(a){0<=a&&a<mb(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:a}],rowHeader:!1})},autoFitRow:function(a){0<=a&&a<lb(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:a}],columnHeader:!1})},setCsv:function(a,b,c,d,e,f,g,h){var i=this;tb(i),vb(i),Hb(i,a,b,c,d,e,'"',f,g,h),wb(i),ub(i)},setDataToCell:function(a,b,c,d){Db(a,b,c,d,0)},getCsv:function(a,b,c,d,e,f){return Ib(this,a,c,b,d,e,f,'"',!0)},getRangeTextHasIgnore:function(a,b,c,d,e,f){return Ib(this,a,c,b,d,"\r\n","\t",'"',!0,e,f)},copyTo:function(a,b,c,d,e,f,g){this.ax(a,b,c,d,e,f,g)},ax:function(a,b,c,d,e,f,g,h,i){var j=this;tb(j),vb(j),n.staticMembers.copyTo(j,a,b,j,c,d,e,f,g,h,0,i),wb(j),ub(j)},moveTo:function(a,b,c,d,e,f,g,h){var i=this;if(!(p&&g&l.CopyToOptions.formula)||i.Vq(a,b,e,f,!0)&&i.Vq(c,d,e,f,!0))try{tb(i),vb(i),n.staticMembers.moveTo(i,a,b,i,c,d,e,f,g,h)}finally{wb(i),ub(i)}},Q6c:function(a){var b,c,d,e,f=this,g=f.o5(a);if(g)return b="\t",c="\r\n",d='"',e=f.J5(a),Ib(f,g.row,nb(g),g.col,ob(g),c,b,d,!1,e.rows,e.cols,!0)},R6c:function(a){var b,c,d=this,e=d.o5(a);if(e)return b=d.J5(a),c=rb(d),j.S4.Q4(d,c,e.row,nb(e),e.col,ob(e),l.SheetArea.viewport,qb(d),b.rows,b.cols,!1,!1,!1,!1)},bx:function(a,b,c){var d,e,f,g,h=this,j=h.mm,k=h.Q6c(a);if(k){d=h.tu(),d.PA=h,d.n5=a,d.G4=b,e=h.tu(),e.UHb=!0,f=h.R6c(a),h.ex&&h.ex(),h.Sob&&h.Sob();try{if(g={sheet:h,sheetName:h.name(),copyData:{text:k,html:f},cancel:!1},h.Wq(i.Events.ClipboardChanging,g),g&&g.cancel===!1)return j&&!c&&j.gx(qb(h)?f:k),h.Wq(i.Events.ClipboardChanged,{sheet:h,sheetName:h.name(),copyData:{text:k,html:f}}),setTimeout(function(){!j||c||h.Js||j.hx()},100),{copyText:k,copyHtml:f};d.hZ()}catch(a){}}},ix:function(a,b,c,d,e,f,g,h,i,k){var l,m,n,o,p,q,r=O().Exp_PasteSourceCellsLocked;if(g.pastedInternal=!1,g.pastedRange=D,l=!f&&!i,!a&&l)return!1;if(m=this,n=m,o=m.J5(b),m.jx(a,m.o5(b),n,f,o.rows,o.cols,k)||l){if(g.pastedInternal=!0,e&&a.options.isProtected&&a.p5(b))return m.Os(1,r),!1;g.pastedRange=m.kx(a,b,n,c,d,e)}else p=m.lx(n,c,f,j.S4.gYc(i)),q=m.f7c(n,c,i),g.pastedRange=p.union(q);return m.mx(a,b,c,d,e,g,h)},mx:function(a,b,c,d,e,f,g){var h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=O().Exp_InvalidCopyPasteSize,y=O().Exp_PasteDestinationCellsLocked,z=O().Exp_PasteChangeMergeCell,A=O().Exp_ChangePartOfArray,B=this,C=B,D=f.pastedRange,G=C.KLc();if(!D)return B.Os(1,x),!1;if(!C.Y3(D.row,D.col,nb(D),ob(D),y,A,E,g))return!1;if(f.pastedInternal){if(h=b.length,1===h){if(j=b[0],e&&!a.Y3(j.row,j.col,nb(j),ob(j),y,A))return!1;if(a.qu(j.row,j.col,nb(j),ob(j)))return B.Os(1,z),!1;if(k=D.row<0?lb(C):nb(D),l=D.col<0?mb(C):ob(D),m=j.row<0?lb(a):nb(j),n=j.col<0?mb(a):ob(j),G&&(k-=C.MLc(c.row,F(k,m),!0),l-=C.MLc(c.col,F(l,n)),k=k<1?1:k,l=l<1?1:l),o=2===d,(k>m||l>n)&&!o){for(p=c.row,q=c.col,c.row<0&&m<lb(C)&&(p=0),c.col<0&&n<mb(C)&&(q=0),k%m===0&&1===l?(l=n,G||(D=f.pastedRange=new i.Range(p,q,k,l))):1===k&&l%n===0?(k=m,G||(D=f.pastedRange=new i.Range(p,q,k,l))):k%m===0&&l%n===0||(k=m,l=n,D=f.pastedRange=new i.Range(p,q,k,l)),r=H(k/m),s=H(l/n),t=0;t<r;t++)for(u=0;u<s;u++)if(!B.nx(j,D)&&C.qu(p<0?-1:p+t*m,q<0?-1:q+u*n,p<0?-1:m,q<0?-1:n))return B.Os(1,z),!1}else if(g===E&&!B.nx(j,D)&&C.qu(D.row,D.col,nb(D),ob(D)))return B.Os(1,z),!1}else if(h>1){for(v=0;v<h;v++)if(w=b[v],a.qu(w.row,w.col,nb(w),ob(w)))return B.Os(1,z),!1;if(C.qu(D.row,D.col,nb(D),ob(D)))return B.Os(1,z),!1}}else{if(C.qu(D.row,D.col,nb(D),ob(D)))return B.Os(1,z),!1;if(!C.l5(D.row,D.col,nb(D),ob(D)))return B.Os(1,x),!1}return!0},nx:function(a,b){if(a&&1===nb(a)&&1===ob(a)){var c=this.getSpan(b.row,b.col);if(c&&c.equals(b))return!0}return!1},jx:function(a,b,c,d,e,f,g){var h,i,j,k;if(a&&b&&c)try{return h=Ib(a,b.row,nb(b),b.col,ob(b),"\r\n","\t",'"',!1,e,f,!0,z.safari,!0),i=h===d,i||(i=h===d+"\r\n",!i&&z.chrome&&(i=h===d+"\t\r\n"),i||!(z.safari||z.mozilla||g)&&qb(c)||(i=h.replace(/\s/g,"")===d.replace(/\s/g,"")),i||(j=RegExp(String.fromCharCode(160),"g"),k=String.fromCharCode(32),h=h.replace(j,k),i=h.replace(/\s+$/,"")===d.replace(/\s+$/,""))),i}catch(a){return!1}return!1},kx:function(a,b,c,d,e,f){var g,h,j,k,l,m,n,o,p,q,r,s,t,u=this,v=b.length,w=c.KLc();if(1===v){if(g=b[0],h=g.row<0?0:g.row,j=g.col<0?0:g.col,k=g.row<0?lb(a):nb(g),l=g.col<0?mb(a):ob(g),m=d.row<0?0:d.row,n=d.col<0?0:d.col,o=d.row<0?lb(c):nb(d),p=d.col<0?mb(c):ob(d),q=void 0,r=void 0,w&&(q=c.MLc(m,F(o,k),!0),r=c.MLc(n,F(p,l)),o-=q,p-=r,o=o<1?1:o,p=p<1?1:p),s=2===e,f||1===o&&1===p)o=k,p=l;else if(!s&&(o%k===0&&1===p?p=l:1===o&&p%l===0?o=k:o%k===0&&p%l===0||(o=k,p=l),!u.pu(h,j,k,l,lb(a),mb(a))))return D;if(t=new i.Range(m,n,o,p),!f&&a.name()===c.name())if(t.contains(h,j,k,l)){if((h-m)%k!==0||(j-n)%l!==0)return D}else if(t.intersect(h,j,k,l)&&(o>k||p>l))return D;return w&&(o+=q,p+=r),c.l5(m,n,o,p)?(d.row===-1&&(m=-1,o=-1),d.col===-1&&(n=-1,p=-1),new i.Range(m,n,o,p)):D}return v>1?u.q5(b,d):D},q5:function(a,b){var c,d,e,f,g,h,j,k,l=this,m=l.KLc();if(a.length>1){if(c=a[0],d=a[1],e=c.rowCount,f=c.colCount,c.row===d.row&&e===d.rowCount)return g=0,h=e,a.forEach(function(a){g+=a.colCount}),m&&(h+=l.MLc(b.row,h,!0),g+=l.MLc(b.col,g)),i.kf(b.row,b.col,h,g);if(c.col===d.col&&f===d.colCount)return j=0,k=f,a.forEach(function(a){j+=a.rowCount}),m&&(j+=l.MLc(b.row,j,!0),k+=l.MLc(b.col,k)),i.kf(b.row,b.col,j,k)}return D},lx:function(a,b,c,d){var e,f,g=b.row<0?0:b.row,h=b.col<0?0:b.col,j=new i.Range(g,h,1,1),k=Nb(c,"\r\n","\t",'"',qb(a),d);return k&&(e=k.length,f=Gb(k),e>0&&f>0&&(a.KLc()&&(e+=a.MLc(g,e,!0),f+=a.MLc(h,f)),j=new i.Range(g,h,e,f))),j},f7c:function(a,b,c){var d,e,f,g,h,j=b.row<0?0:b.row,k=b.col<0?0:b.col,l=1,m=1,n=a.tu();return n&&(d=n.GZa(),d.innerHTML=c,e=d.getElementsByTagName("table"),f=e&&e[0],f&&(g=f.rows,g&&(l=g.length,h=g[0]&&g[0].cells,h&&(m=h.length)),l>0&&m>0&&a.KLc()&&(l+=a.MLc(j,l,!0),m+=a.MLc(k,m)))),new i.Range(j,k,l,m)},ox:function(){var a=this.tu();a&&a.hZ()},HXc:function(a,b,c,d,e,f,g,h,j,k){var l,m,o,p,q,r,s,t,u,v,w,x,y,z,A=ib.qx(j),B=d.row<0?lb(c):nb(d),C=d.col<0?mb(c):ob(d),D=b.row<0?lb(a):nb(b),E=b.col<0?mb(a):ob(b),F=d.row,G=d.col;for(d.row<0&&D<lb(c)&&(F=0),d.col<0&&E<mb(c)&&(G=0),l=H(B/D),m=H(C/E),o=0;o<l&&l&&m;o++)for(p=0;p<m;p++)n.staticMembers.copyTo(a,b.row,b.col,c,F+D*o,G+E*p,D,E,A,k,rb(a));for(x=A&-33,s=F+D*l,t=G,u=B-D*l,v=E,w=Ob(new i.Range(b.row,b.col,u,v),a.getSpans(b)),y=function(d){w.forEach(function(a){c.addSpan(s+a.row-b.row,t+E*d+a.col-b.col,a.rowCount,a.colCount)}),n.staticMembers.copyTo(a,b.row<0?0:b.row,b.col<0?0:b.col,c,s,t+E*d,u,v,x,k,rb(a))},p=0;p<m&&u&&v;p++)y(p);for(s=F,t=G+E*m,u=D,v=C-E*m,w=Ob(new i.Range(b.row,b.col,u,v),a.getSpans(b)),z=function(d){w.forEach(function(a){c.addSpan(s+D*d+a.row-b.row,t+a.col-b.col,a.rowCount,a.colCount)}),n.staticMembers.copyTo(a,b.row<0?0:b.row,b.col<0?0:b.col,c,s+D*d,t,u,v,x,k,rb(a))},o=0;o<l&&u&&v;o++)z(o);s=F+D*l,t=G+E*m,u=B-D*l,v=C-E*m,w=Ob(new i.Range(b.row,b.col,u,v),a.getSpans(b)),u&&v&&(w.forEach(function(a){c.addSpan(s+a.row-b.row,t+a.col-b.col,a.rowCount,a.colCount)}),n.staticMembers.copyTo(a,b.row<0?0:b.row,b.col<0?0:b.col,c,s,t,u,v,x,k,rb(a)))},px:function(a,b,c,d,f,g,h,k,l,m){var o,s,t,u,v,w,x,y,z,A,B,C,E,G,I,J,K,N,P,Q,R,S,T,U;if(a&&c.name()===a.name()&&c.parent&&!a.xUc&&!r(c.parent.sheets,a)&&c.parent!==a.parent)return void a.ox();o=c.KLc(),y=ib.qx(l),xb(a),xb(c);try{if(a&&b){if(0!==(2&y)&&f&&p&&(a.Ns(b.row,b.col,nb(b),ob(b))||c.Ns(d.row,d.col,nb(d),ob(d))))throw O().Exp_ChangePartOfArray;if(z=2===l,f)n.staticMembers.moveTo(a,b.row,b.col,c,d.row,d.col,nb(b),ob(b),y,a.L6c),a.ox();else if(z)this.HXc(a,b,c,d,f,g,h,k,l,m);else if(A=d.row<0?lb(c):nb(d),B=d.col<0?mb(c):ob(d),u=b.row<0?lb(a):nb(b),v=b.col<0?mb(a):ob(b),o&&(A-=c.MLc(d.row,F(A,u),!0),B-=c.MLc(d.col,F(B,v)),A=A<1?1:A,B=B<1?1:B),A>u||B>v)for(s=d.row,t=d.col,d.row<0&&u<lb(c)&&(s=0),d.col<0&&v<mb(c)&&(t=0),A%u===0&&1===B?B=v:1===A&&B%v===0?A=u:A%u===0&&B%v===0||(A=u,B=v),C=H(A/u),E=H(B/v),G=u,I=v,J=void 0,K=void 0,N=void 0,P=void 0,w=0;w<C;w++){for(J=q(N)?s<0?-1:s+w*u:N,x=0;x<E;x++)K=q(P)?t<0?-1:t+x*v:P,u=s<0?-1:G,v=t<0?-1:I,o&&(u=s<0?-1:u+c.MLc(J,G,!0),v=t<0?-1:v+c.MLc(K,I)),n.staticMembers.copyTo(a,b.row,b.col,c,J,K,G,I,y,m,rb(a)),P=K+(v<0?0:v);N=J+(u<0?0:u),P=null}else n.staticMembers.copyTo(a,b.row,b.col,c,d.row,d.col,nb(b),ob(b),y,m,rb(a))}else{if(s=d.row,t=d.col,u=nb(d),v=ob(d),g)for(Q=c.ITa,R=Q.getSpans(i.kf(s,t,u,v)),S=R.length-1;S>=0;S--)Q.do("removeSpan",R[S]);if(p&&(1&y)>0&&c.clearFormula(s,t,u,v,function(a,b){return!a.Ps||!a.Ps(b)}),T=c.tu(),U=0===l||2===l,g&&""!==g)c.parent&&c.parent.options.allowAutoCreateHyperlink&&1===u&&1===v&&(e.Common.q.qb(L).test(g)||e.Common.q.qb(M).test(g))&&c.setHyperlink&&c.setHyperlink(s,t,{url:g,tooltip:g}),c.setCsv(s,t,g,"\r\n","\t",16,qb(c),j.S4.gYc(h));else if(T&&U&&k)T.lgc(k,c,s,t);else for(w=0;w<u;w++)for(x=0;x<v;x++)c.setValue(s+w,t+x,D);T&&U&&h&&T.R4(h,c,s,t)}}finally{yb(a,!1),yb(c,!1)}},sx:function(a){if(!this.isEditing()){var b=this.getSelections();if(b&&1===b.length)return this.bx(b,!0,a)}return D},r5:function(a,b){var c,d,e,f,g,h,i;if(a&&(c=a.length,c>1)){for(d=void 0,d=0;d<c;d++)for(e=a[d],f=d+1;f<c;f++)if(g=a[f],e.intersect(g.row,g.col,g.rowCount,g.colCount))return!1;for(h=a[0],i=void 0,d=1;d<c&&(i=a[d],h.row===i.row&&h.rowCount===i.rowCount);d++);if(d>=c)return b&&(b.inSameRow=!0),!0;for(d=1;d<c&&(i=a[d],h.col===i.col&&h.colCount===i.colCount);d++);if(d>=c)return b&&(b.inSameCol=!0),!0}return!1},o5:function(a){var b,c,d,e,f;if(a){if(b=a.length,1===b)return a[0];if(b>1){if(c=a[0],d=a[b-1],e=void 0,f=void 0,c.row===d.row&&c.rowCount===d.rowCount){for(e=0;e<b;e++)f=a[e],f.col<c.col&&(c=f),f.col>d.col&&(d=f);return i.kf(c.row,c.col,c.rowCount,d.col+d.colCount-c.col)}if(c.col===d.col&&c.colCount===d.colCount){for(e=0;e<b;e++)f=a[e],f.row<c.row&&(c=f),f.row>d.row&&(d=f);return i.kf(c.row,c.col,d.row+d.rowCount-c.row,c.colCount)}}}return D},J5:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=[],o=[];if(a&&(b=a.length,b>1&&(c=a[0],d=a[b-1],e=c.row===d.row&&c.rowCount===d.rowCount,f=c.col===d.col&&c.colCount===d.colCount,e||f)))for(a.sort(e?function(a,b){return a.col-b.col}:function(a,b){return a.row-b.row}),g=1;g<b;g++)for(h=a[g-1],i=a[g],j=e?h.col+h.colCount:h.row+h.rowCount,k=e?i.col:i.row,l=e?o:n,m=j;m<k;m++)l.push(m);return{rows:n,cols:o}},ux:function(a){var b,c,d,e,f,g,h,j=this;if(!j.isEditing()){if(b=j.getSelections(),b&&1===b.length){if(c=j.tu(),c.UHb=!0,d=b[0],d.row!==-1&&j.Nu&&j.Nu()){for(e=[],f=-1,g=0;g<d.rowCount;g++)h=d.row+g,j.Ps(h)?f!==-1&&(e.push(i.kf(f,d.col,h-f,d.colCount)),f=-1):f===-1&&(f=h);f!==-1&&e.push(i.kf(f,d.col,d.row+d.rowCount-f,d.colCount)),b=e}return j.bx(b,!1,a)}if(j.r5(b))return j.bx(b,!1,a);j.Os(1,O().Exp_MultipleSelections)}return D},vx:function(a){var b,c,d,e,f,g,h,j=this,k=j.mm;j.isEditing()||(a&&(b=a.pasteText,c=a.pasteHtml,d=void 0===a.pasteOption?j.options.clipBoardOptions:a.pasteOption,e=a.shiftCells,f=j.getSelections()[0],g=a.isFromDesigner),k&&!b&&k.gx(""),h=j.tu(),h&&(h.VHb=!1),setTimeout(function(){var a,l,m,n,o,p;j.Js||(a=b||"",l=c||"",k&&!b&&(h&&(o=h.wx(),p=h.PA,a=o.text,l=o.html,n=o.image,m=h.n5&&h.n5[0],p&&i.Ul.rXc(m,p.getRowCount(),p.getColumnCount())),k.hx()),(z.msie||z.edge||b||!a&&!l&&!h.VHb)&&j.J4(a,l,n,d,e,f,m,g),j.mm.Qq(),j.Wq(i.Events.PasteEnd))},100))},J4:function(a,b,c,d,e,f,g,h){var j,k=this,l=k.tu();if(l&&(l.VHb=!0),j=k.xx(a,d,e,b,h),!j){if(!c)return;j={pasteOption:void 0===d?k.options.clipBoardOptions:d,pastedRanges:[i.kf(k.getActiveRowIndex(),k.getActiveColumnIndex(),1,1)],clipboardText:""}}e!==E&&(j.WHb=e),f&&(j.XHb=f),g&&(j.YHb=g),j.cmd="clipboardPaste",j.sheetName=k.name(),qb(k)&&(j.clipboardHtml=b,j.clipboardImage=c),k.wu().execute(j)},xx:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this,q=O().Exp_InvalidPastedArea,r=p.tu(),s=r.PA,t=r.n5,u=r.G4;if(u&&s&&t&&s.options.isProtected&&s.p5(t)&&(u=!1),f={pastedRange:D,pastedInternal:!1},g=[],h=p.getSelections(),h.length>1)for(j=2===b,k=0;k<h.length;k++){if(i=h[k],!p.ix(s,t,i,b,u,a,f,E,d,e))return;if(i.containsRange(f.pastedRange)&&!i.equals(f.pastedRange)&&!j)return void p.Os(1,q);g.push(f.pastedRange)}else{if(i=h.length>0?h[0]:p.ITa.getSpan(p.Jl,p.Kl),!p.ix(s,t,i,b,u,a,f,c,d,e))return;g.push(f.pastedRange)}if(l=p.at,l&&l.jx(f.pastedInternal),f.pastedInternal||(s=D,t=D,u=!1),m=void 0===b?p.options.clipBoardOptions:b,u&&(m=p.M6c),t&&1===t.length)for(n=0;n<g.length;n++)o=g[n],p.nx(t[0],o)&&(o.rowCount=1,o.colCount=1);return(!t||t.length>1)&&g.length>1?void p.Os(1,O().Exp_MultipleSelections):{fromSheet:s,fromRanges:t,isCutting:u,pasteOption:m,pastedRanges:g,clipboardText:a}},l5:function(a,b,c,d,e){var f=this,g=lb(f),h=mb(f);return pb(f)?-1<=a&&(e||a<g)&&-1<=b&&(e||b<h):f.pu(a,b,c,d,g,h)},p5:function(a){for(var b=0;b<a.length;b++)if(this.ou(a[b]))return!0;return!1},yx:function(a,b,c,d){var e,f,g,h=this;h.endEdit&&!h.endEdit()||(e={sheet:h,sheetName:h.name(),row:h.Jl,col:h.Kl,cancel:!1},h.Wq(i.Events.LeaveCell,e),e.cancel!==!0&&(f=h.Jl,g=h.Kl,q(c)&&(c=h.Jl),q(d)&&(d=h.Kl),3===a?h.zx(c,d,b):4===a?h.Rs(c,d,b):1===a?h.Ax(c,d,b):2===a?h.Bx(c,d,b):5===a?h.Cx():6===a&&h.Dx(),h.Ss(a,f,g)))},Ex:function(a){var b,c,d,e=this;e.endEdit()&&(b={sheet:e,sheetName:e.name(),row:e.Jl,col:e.Kl,cancel:!1},e.Wq(i.Events.LeaveCell,b),b.cancel!==!0&&(c=e.Jl,d=e.Kl,3===a?e.Fx(e.Jl,e.Kl):4===a&&e.Gx(e.Jl,e.Kl),e.Ss(a,c,d)))},Ss:function(a,b,c){var d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=x.mm,z=x.ITa.getSelections(),A=!1;x.Hx||(d=x.Tq(x.Ix()),(z.length>1||nb(d)>1||ob(d)>1)&&(A=!0),!A&&x.mJb&&x.mJb.mgc(d)&&(A=!0),x.Tr()),e=x.Jl,f=x.Kl,g=x.ITa.getSpan(e,f),x.Lr=nb(g),x.Mr=ob(g),x.Hx||(h=x.Jx(e,f),j=x.selectionPolicy(),k=x.selectionUnit(),0===j?x.ITa.do("clearSelection"):1===j&&x.ITa.do("clearSelection"),1===k?(h.col=-1,h.colCount=-1):2===k&&(h.row=-1,h.rowCount=-1),x.Kx(h.row,h.col,nb(h),ob(h),!1),l=x.ITa.getSelections(),y.zu(z,l)&&(x.yu(z,l),x.Au(z))),x.Yq(e,f),b!==e&&(m=x.wq,m&&m.Lx()),n=x.yl,A?(o=x.am(),p=o.zr,q=o.Ar,r=o.width-p,s=o.height-q,n.Mx(p,q,r,s),n.repaint(new i.Rect(p,q,r,o.Cr)),n.repaint(new i.Rect(p,q,o.Br,s)),n.Pw(n.bm())):(t=x.ITa.getSpan(b,c),u=nb(t),v=ob(t),n.im(new i.Range(e,f,x.Lr,x.Mr).union(new i.Range(b,c,u,v)))),w={sheet:x,sheetName:x.name(),row:e,col:f},x.Wq(i.Events.EnterCell,w),x.Wq(i.Events.FormulatextboxEnterCell,w),y.cs&&y.cs(e,f)},Nx:function(a,b){var c=this,d=c.getDataValidator&&c.getDataValidator(a,b),e={sheet:c,sheetName:c.name(),row:a,col:b,validator:d,validationResult:0};return c.Wq(i.Events.ValidationError,e),e.validationResult}});function Ob(a,b){var c=[];return b.forEach(function(b){var d=Pb(a,b);d&&c.push(d)}),c}function Pb(a,b){var c,d,e,f,g=a.row,h=a.col,j=a.row+a.rowCount,k=a.col+a.colCount,l=b.row,m=b.col,n=b.row+b.rowCount,o=b.col+b.colCount,p=F(g,l)<=G(j,n)&&F(h,m)<=G(k,o);return!!p&&(c=F(g,l),d=F(h,m),e=G(j,n)-c,f=G(k,o)-d,new i.Range(c,d,e,f))}function Qb(a,b){if(a.sheets){var c=i.uJc(a,b.sheetName);if(c)return c}return a}function Rb(a,b,c,d){var e=Qb(a,c),f=new b(e,c,d);return d?f.undo(e):f.execute(e)}P={},b.Commands=P,P.Ox=function(a,b){return!!a&&(2!==a.Px&&(a.yx(b,!1),!0))},P.Qx=function(a,b,c,d){return!!a&&(2!==a.Px&&(a.yx(b,!1,c,d),!0))},P.Rx=function(a,b,c){return!!a&&(2!==a.Px&&(!(a.endEdit&&!a.endEdit())&&(a.Sx(b,c),!0)))};function Sb(a){var b=a;return function(a,c){var d=Qb(a,c);return P.Ox(d,b)}}function Tb(a,b){var c=a,d=b;return function(a,b){var e=Qb(a,b);return P.Rx(e,c,d)}}function Ub(a,b){var c,d,e,f,g=a.parent;g&&(c=g.getSheetCount(),d=void 0,e=void 0,d=e=g.getActiveSheetIndex(),b?e<c-1&&e++:e>0&&e--,d!==e&&(f=g.getActiveSheet(),g.dq(e,1),g.SHb(f),g.repaint()))}function Vb(a,b){a.Tx=!0,a.Hx?a.Ex(b):a.yx(b,!0),a.Tx=!1}function Wb(a,b){var c,d,e,f;return!!a.endEdit()&&(c=a.mm,c.Ux(),c.Vx(),i.Vl.Zl(D),d=!1,e=a.parent,e&&(f=b.call(e),f&&f.focus?(f.focus(),d=!0):e.Uv()),{ignoreCancelDefault:!d})}Q="navigationLeft",R="navigationRight",S="navigationUp",T="navigationDown",U="navigationHome2",V="navigationEnd2",W="navigationTop",X="navigationBottom",Y="navigationHome",Z="navigationFirst",$="navigationEnd",_="navigationLast",aa="moveToNextCell",ba="moveToPreviousCell",ca="navigationPageUp",da="navigationPageDown",ea="navigationPreviousSheet",fa="navigationNextSheet",ga="clear",ha="clearAndEditing",ia="commitInputNavigationDown",ja="commitInputNavigationUp",ka="cancelInput",la="commitArrayFormula",ma="selectionLeft",na="selectionRight",oa="selectionUp",pa="selectionDown",qa="selectionHome",ra="selectionEnd",sa="selectionPageUp",ta="selectionPageDown",ua="selectionTop",va="selectionBottom",wa="selectionFirst",xa="selectionLast",ya="copy",za="cut",Aa="paste",Ba="undo",Ca="redo",Da="resizeColumn",Ea="resizeRow",Fa="splitResizeRow",Ga="splitResizeColumn",Ha="autoFitColumn",Ia="autoFitRow",Ja="editCell",Ka="renameSheet",La="zoom",Ma="clearValues",Na="clipboardPaste",Oa="selectNextControl",Pa="selectPreviousControl",Qa="moveToNextCellThenControl",Ra="moveToPreviousCellThenControl",Sa="changeFormulaReference",Ta="moveSheet",Ua="copySheet",P.bT=Qb,P.h4=Rb,P.uv=function(a){var b=i.Ul.sl(),c=!b,d=b;a.register(Q,P[Q],37,!1,!1,!1,!1),a.register(R,P[R],39,!1,!1,!1,!1),a.register(S,P[S],38,!1,!1,!1,!1),a.register(T,P[T],40,!1,!1,!1,!1),a.register(U,P[U],37,c,!1,!1,d),a.register(V,P[V],39,c,!1,!1,d),a.register(W,P[W],38,c,!1,!1,d),a.register(X,P[X],40,c,!1,!1,d),a.register(Y,P[Y],36,!1,!1,!1,!1),a.register(Z,P[Z],36,!0,!1,!1,!1),a.register($,P[$],35,!1,!1,!1,!1),a.register(_,P[_],35,!0,!1,!1,!1),a.register(aa,P[aa],9,!1,!1,!1,!1),a.register(ba,P[ba],9,!1,!0,!1,!1),a.register(ca,P[ca],33,!1,!1,!1,!1),a.register(da,P[da],34,!1,!1,!1,!1),a.register(ea,P[ea],33,c,!1,!1,d),a.register(fa,P[fa],34,c,!1,!1,d),a.register(ga,P[ga],46,!1,!1,!1,!1),a.register(ha,P[ha],8,!1,!1,!1,!1),a.register(ia,P[ia],13,!1,!1,!1,!1),a.register(ja,P[ja],13,!1,!0,!1,!1),a.register(ka,P[ka],27,!1,!1,!1,!1),a.register(la,P[la],13,!0,!0,!1,!1),a.register(ma,P[ma],37,!1,!0,!1,!1),a.register(na,P[na],39,!1,!0,!1,!1),a.register(oa,P[oa],38,!1,!0,!1,!1),a.register(pa,P[pa],40,!1,!0,!1,!1),a.register(qa,P[qa],36,!1,!0,!1,!1),a.register(ra,P[ra],35,!1,!0,!1,!1),a.register(sa,P[sa],33,!1,!0,!1,!1),a.register(ta,P[ta],34,!1,!0,!1,!1),a.register(qa,P[qa],37,c,!0,!1,d),a.register(ra,P[ra],39,c,!0,!1,d),a.register(ua,P[ua],38,c,!0,!1,d),a.register(va,P[va],40,c,!0,!1,d),a.register(wa,P[wa],36,!0,!0,!1,!1),a.register(xa,P[xa],35,!0,!0,!1,!1),a.register(ya,P[ya],67,c,!1,!1,d),a.register(za,P[za],88,c,!1,!1,d),a.register(Aa,P[Aa],86,c,!1,!1,d),a.register(Ba,P[Ba],90,c,!1,!1,d),a.register(Ca,P[Ca],89,c,!1,!1,d),b&&a.register(Ca,P[Ca],90,c,!0,!1,d),a.register(Oa,P[Oa]),a.register(Pa,P[Pa]),a.register(Qa,P[Qa]),a.register(Ra,P[Ra]),a.register(Sa,P[Sa]),a.register(Da,P[Da]),a.register(Ea,P[Ea]),a.register(Ga,P[Ga]),a.register(Fa,P[Fa]),a.register(Ha,P[Ha]),a.register(Ia,P[Ia]),a.register(Ja,P[Ja]),a.register(Ka,P[Ka]),a.register(La,P[La]),a.register(Ma,P[Ma]),a.register(Na,P[Na]),a.register(Ta,P[Ta]),a.register(Ua,P[Ua])},Va={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Wa=".cellEditAction",P[Q]={canUndo:!1,execute:Sb(3)},P[R]={canUndo:!1,execute:Sb(4)},P[S]={canUndo:!1,execute:Sb(1)},P[T]={canUndo:!1,execute:Sb(2)},P[la]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=P.Wx;return d&&(c=d.fv(c)),c.fv&&c.fv(),!0}},P[ia]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=P.Wx;return d&&(c=d.Xx(c)),c.yx(2,!1),!0}},P[ja]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=P.Wx;return d&&(c=d.Yx(c)),c.yx(1,!1),!0}},P[Y]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return P.Qx(c,4,D,c.frozenColumnCount()-1)}},P[U]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return P.Qx(c,4,D,-1)}},P[$]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return P.Qx(c,3,D,mb(c)-c.frozenTrailingColumnCount())}},P[V]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return P.Qx(c,3,D,mb(c))}},P[W]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return P.Qx(c,2,-1,D)}},P[X]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return P.Qx(c,1,lb(c),D)}},P[ca]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=Qb(a,b);if(!h||2===h.Px)return!1;if(c=h.Ew(),c===D||c===h.lq)return!0;if(d=h.Gr(1,3),e=h._q(h.Jl-d.length),e<c&&(e=c),f=P.Wx){if(g=f.Zx(h,e,c),g.r)return!0;h=g.sheet}return!!h.endEdit()&&(h.Qs(e,h.getActiveColumnIndex())&&(h.Jr(e,D),h.Qr=e,h.yx()),h.mq(c,0),!0)}},P[da]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=Qb(a,b);if(!h||2===h.Px)return!1;if(c=h.$x(),c===D||c===h.lq)return!0;if(d=h.Gr(1,3),e=h.gr(h.Jl+d.length),e<c&&(e=c),f=P.Wx){if(g=f._x(h,e,c),g.r)return!0;h=g.sheet}return!!h.endEdit()&&(h.Qs(e,h.getActiveColumnIndex())&&(h.Jr(e,D),h.Qr=e,h.yx()),h.mq(c,0),!0)}},P[fa]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);Ub(c,!0)}},P[ea]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);Ub(c,!1)}},P[Z]={canUndo:!1,execute:function(a,b){var c,d,e=Qb(a,b);if(!e||2===e.Px)return!1;if(c=P.Wx){if(d=c.ay(e),d.r)return!0;e=d.sheet}return e.yx(5,!1,e.Jl,e.Kl),!0}},P[_]={canUndo:!1,execute:function(a,b){var c,d,e=Qb(a,b);if(!e||2===e.Px)return!1;if(c=P.Wx){if(d=c.by(e),d.r)return!0;e=d.sheet}return e.yx(6,!1,e.Jl,e.Kl),!0}},P[Oa]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return!!c.parent&&Wb(c,c.parent.nextControl)}},P[Pa]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return!!c.parent&&Wb(c,c.parent.previousControl)}},P[aa]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=P.Wx;return d&&(c=d.ey(c)),Vb(c,4),!0}},P[ba]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=P.Wx;return d&&(c=d.gy(c)),Vb(c,3),!0}},P[Qa]={canUndo:!1,execute:function(a,b){var c,d,e=Qb(a,b),f=e.Qr,g=e.getActiveColumnIndex();return e.Tx=!0,c=e.hy(e.getActiveRowIndex(),g,!0,f),e.Tx=!1,d=!c||(c.leadingCellRow<f||c.leadingCellRow===f&&g>c.col),d?P[Oa].execute(a,b):P[aa].execute(a,b)}},P[Ra]={canUndo:!1,execute:function(a,b){var c,d,e=Qb(a,b),f=e.Qr,g=e.getActiveColumnIndex();return e.Tx=!0,c=e.iy(e.getActiveRowIndex(),g,!0,f),e.Tx=!1,d=!c||(c.leadingCellRow>f||c.leadingCellRow===f&&g<c.col),d?P[Pa].execute(a,b):P[ba].execute(a,b)}},P[ka]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i,j,k,l,m=Qb(a,b),n=P.Wx;return n&&(c=n.jy(m)),m.isEditing()?(d=m.Jl,e=m.Kl,f=m.getValue(d,e,3,1),g=m.getCellType(d,e),h=g.getEditorValue(m.BF,a),!!m.endEdit(!0)&&(i=m.ITa,j=i&&i.ZHb,j&&j.getAnchorCell(d,e)||(k=g.isEditingValueChanged(f,h,a),k&&m.setValue(d,e,f,3,!0)),!0)):q(c)?(P.Yxb(m.parent),m.uu=D,m.parent.uu.hZ(),l=m,l.ex&&l.ex(),void(l.Sob&&l.Sob())):c}},P.Yxb=function(a){var b,c,d,e=a&&a.sheets;if(e)for(b=0,c=e.length;b<c;b++)d=e[b],d&&d.at&&d.at.ky()},P[ga]={canUndo:!1,execute:function(a,b){var c,d=Qb(a,b);return!d.isEditing()&&(c=d.getSelections(),d.wu().execute({cmd:Ma,sheetName:d.name(),ranges:c}),!0)}},P[ha]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);return!c.isEditing()&&(i.Ul.sl()?(P[ga].execute(a,b),!0):(c.HF=!0,c.startEdit(!0,""),c.HF=!1,!0))}},P[ya]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=b.copyData=c.ux(b.ignoreClipboard);return b.callback&&b.callback(),!d||E}},P[za]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=b.cutData=c.sx(b.ignoreClipboard);return b.callback&&b.callback(),!d||E}},P[Aa]={canUndo:!1,execute:function(a,b){var c=Qb(a,b);c.vx(b)}},P[ma]={canUndo:!1,execute:Tb(37)},P[na]={canUndo:!1,execute:Tb(39)},P[oa]={canUndo:!1,execute:Tb(38)},P[pa]={canUndo:!1,execute:Tb(40)},P[qa]={canUndo:!1,execute:Tb(37,!0)},P[ra]={canUndo:!1,execute:Tb(39,!0)},P[sa]={canUndo:!1,execute:Tb(33)},P[ta]={canUndo:!1,execute:Tb(34)},P[ua]={canUndo:!1,execute:Tb(38,!0)},P[va]={canUndo:!1,execute:Tb(40,!0)},P[wa]={canUndo:!1,execute:Tb(36,!0)},P[xa]={canUndo:!1,execute:Tb(35,!0)},P[Sa]={canUndo:!1,execute:function(a,b){var c=Qb(a,b),d=c&&c.mm;if(d){tb(c);try{d.ly&&d.ly()}finally{ub(c)}}}},P[Ba]={canUndo:!1,execute:function(a){var b,c=a;return c&&(b=c.undoManager(),b&&b.canUndo()&&b.undo()),!0}},P[Ca]={canUndo:!1,execute:function(a){var b,c=a;return c&&(b=c.undoManager(),b&&b.canRedo()&&b.redo()),!0}},P[Da]={canUndo:!0,execute:function(a,b,c){return Rb(a,Za,b,c)}},P[Ea]={canUndo:!0,execute:function(a,b,c){return Rb(a,$a,b,c)}},P[Ga]={canUndo:!0,execute:function(a,b,c){return Rb(a,_a,b,c)}},P[Fa]={canUndo:!0,execute:function(a,b,c){return Rb(a,ab,b,c)}},P[Ha]={canUndo:!0,execute:function(a,b,c){return Rb(a,bb,b,c)}},P[Ia]={canUndo:!0,execute:function(a,b,c){return Rb(a,cb,b,c)}},P[Ja]={canUndo:!0,execute:function(a,b,c){return Rb(a,db,b,c)}},P[Ka]={canUndo:!0,execute:function(a,b,c){return Rb(a,eb,b,c)}},P[La]={canUndo:!0,execute:function(a,b,c){return Rb(a,fb,b,c)}},P[Ma]={canUndo:!0,execute:function(a,b,c){return Rb(a,hb,b,c)}},P[Na]={canUndo:!0,execute:function(a,b,c){return Rb(a,jb,b,c)}},P[Ta]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=b.sheetName,j=b.targetIndex,k=a.getSheetIndex(h);return q(k)&&(k=a.getSheetCount()+a.getSheetTabIndex(h)),c=a.WJc(),d=k,e=j,f={sheet:c,sheetName:c.name(),oldIndex:d,newIndex:e,cancel:!1},a.Wq(i.Events.SheetMoving,f),!f.cancel&&(g=a.changeSheetIndex(h,j),a.Wq(i.Events.SheetMoved,{sheet:c,sheetName:c?c.name():D,oldIndex:d,newIndex:e}),g)}},P[Ua]={canUndo:!1,execute:function(a,b){var c,d=b.sheetName,e=b.targetIndex,f=b.newName,g=b.includeBindingSource,h=a.getSheetFromName(d);return a.Wq(i.Events.SheetChanging,{sheetName:f,propertyName:"insertSheet",cancel:!1,sheetIndex:e}),a.Wq(i.Events.ActiveSheetChanging,{oldSheet:h,newSheet:c,cancel:!1}),c=a.clone(d,e,f,g),!q(c)&&(a.Wq(i.Events.SheetChanged,{sheetName:c.name(),propertyName:"insertSheet",sheetIndex:e}),a.Wq(i.Events.ActiveSheetChanged,{oldSheet:h,newSheet:c}),!0)}},Xa=function(){function a(a,b,c){var d=this;d.kj=a,d.my=b,d.ny=c,d.oy=[],d.Iu=[],d.py()}return a.prototype.py=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z,A,B=this,C=B.my,F=B.kj;if(F&&C){if(a=B.ny,b=C.row,c=C.col,d=nb(C),e=ob(C),f=B.oy,g=!1,b===-1&&(g=!0,b=0,d=lb(F)),c===-1&&(g=!0,c=0,e=mb(F)),i=[],(64&a)>0)for(k=0;k<e;k++)i[k]=F.Aj(-1,k)||D;for(l=0;l<d;l++)for(m=b+l,(64&a)>0&&(h=F.Aj(m,-1)||D),n=0;n<e;n++){if(o=void 0,q=c+n,p&&(2&a)>0&&F.getFormulaInformation&&(o=F.getFormulaInformation(m,q),o.hasFormula))if(o.isArrayFormula){if(r=o.baseRange,r.row===m&&r.col===q)for(s=r.row,t=r.row+nb(r);s<t;s++)for(u=r.col,v=r.col+ob(r);u<v;u++)B.qy(f,s-b,u-c,o,2)}else B.qy(f,l,n,o.formula,2);!((1&a)>0)||o&&o.hasFormula||B.qy(f,l,n,F.getValue(m,q,3),1),(16&a)>0&&F.getSparkline&&(w=F.getSparkline(m,q),x=D,w&&(x=w.data()),w&&x&&B.qy(f,l,n,w,16)),(64&a)>0&&(y=void 0,g?y=F.getActualStyle(m,q,3):(j=F.Aj(m,q)||D,y=F.getCompositeStyle(m,q,3,j,h,i[n])),z=E,y&&y.toJSON&&(z=JSON.stringify(y.toJSON(3,!0))),B.qy(f,l,n,z,64)),A=F.ITa.Ky,(4&a)>0&&A&&B.qy(f,l,n,A.get(m,q),4),(128&a)>0&&B.qy(f,l,n,F.getTag(m,q,3),128),(256&a)>0&&B.qy(f,l,n,F.getBindingPath&&F.getBindingPath(m,q,3),256),(1024&a)>0&&B.qy(f,l,n,F.getHyperlink&&F.getHyperlink(l,n,3),1024)}}},a.prototype.sy=function(){return this.oy},a.prototype.qy=function(a,b,c,d,e){!q(d)&&a&&(a[b]===E&&(a[b]=[]),a[b][c]===E&&(a[b][c]={}),a[b][c][Va[e]]=d)},a.prototype.uy=function(a){var b,c,d,e,f,g,h,i,j;if(a)for(b=this,c=b.oy,d=0,e=a.length;d<e;d++)if(f=a[d])for(g=0,h=f.length;g<h;g++)i=f[g],i&&(c[d]||(c[d]=[]),j=c[d][g],j?b.vy(i,j)&&(c[d][g]=E):c[d][g]=i)},a.prototype.vy=function(a,b){var c,d,e,f=this.ny,g=[];for(256&f&&g.push(Va[256]),4&f&&g.push(Va[4]),2&f&&g.push(Va[2]),16&f&&g.push(Va[16]),64&f&&g.push(Va[64]),128&f&&g.push(Va[128]),1024&f&&g.push(Va[1024]),1&f&&g.push(Va[1]),c=0,d=g.length;c<d;c++)if(e=g[c],a[e]!==b[e])return!1;return!0},a.prototype.wy=function(){var a,b,c,d,e,f=this,g=f.my.row,h=f.my.col,i=f.oy,j=f.Iu;if(j&&j.length>0)return j;for(j=[],g=g===-1?0:g,h=h===-1?0:h,a=0,b=i.length;a<b;a++)if(c=i[a])for(d=0,e=c.length;d<e;d++)c[d]&&j.push({row:a+g,col:d+h});return f.Iu=j,j},a}(),P.xy=Xa,P.Bu=function(a,b,c,d,e,f,g,h,i){a&&(b<0&&(b=0,d=lb(a)),
c<0&&(c=0,e=mb(a)),a.Bu(b,c,d,e,f,g,E,E,h,i))};function Xb(a,b){var c,d=[];return"string"==typeof b?(c=i.uJc(a,b),c&&d.push(c)):Array.isArray(b)&&b.forEach(function(b){var c=i.uJc(a,b);c&&d.push(c)}),d}P.bWa=function(a){return"changes"+a},P.cWa=function(a){return a&&(0!==a.length||!m.isEmptyObject(a))},P.aWa=function(a){var b,c=a.sheetName;return"string"==typeof c?b=[c]:Array.isArray(c)&&(b=c),!!b&&b.every(function(b){var c=P.bWa(b),d=a[c];return d&&0===d.length&&m.isEmptyObject(d)})},P.startTransaction=function(a,b){Xb(a,b.sheetName).forEach(function(a){a.ITa.startTransaction()})},P.endTransaction=function(a,b){Xb(a,b.sheetName).forEach(function(a){var c=P.bWa(a.name());b[c]=a.ITa.endTransaction()})},P.undoTransaction=function(a,b){Xb(a,b.sheetName).forEach(function(a){var c=P.bWa(a.name());a.ITa.undo(b[c]),a.$p()})};function Yb(a){return a instanceof h.Worksheet?a:a.kj instanceof h.Worksheet?a.kj:void 0}P.Zxb=function(a){a.forEach(function(a){var b=Yb(a);b&&b.ITa.startTransaction()})},P.$xb=function(a,b){var c=[];a.forEach(function(a){var d,e,f,g=Yb(a);g&&(d=g.name(),e=P.bWa(d),f=g.ITa.endTransaction(),f&&(b[e]=f,c.push(d)))}),b.sheetNames=c},P._xb=function(a,b){a.forEach(function(a){var c,d=Yb(a);d&&(c=P.bWa(d.name()),d.ITa.undo(b[c]))})};function Zb(a,b){tb(a),b||vb(a)}function $b(a,b){b||wb(a),ub(a)}Ya=function(){function a(a,b){this.Lz=Zb,this.Mz=$b;var c=this;c.kj=a,c.VQ=b}return a.prototype.execute=function(){},a.prototype.canExecute=function(){return!0},a.prototype.canUndo=function(){return!0},a.prototype.undo=function(){return!0},a}(),P.ActionBase=Ya;function _b(a,b){q(a.lq)&&(a.lq=b.lq,a.qq=b.qq)}Za=function(a){kb(b,a);function b(b,c){var d=a.call(this,b,c)||this;return _b(c,b),d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=!1;if(r.canExecute()&&(a=r.VQ,b=r.kj,c=a.columns,d=a.rowHeader,e=c&&c.length,b&&e>0)){if(f=r.Sz(c),g={sheet:b,sheetName:b.name(),colList:f,header:d,cancel:!1},b.Wq(v,g),g&&g.cancel===!0)return s;a.Tz=!0,b.ITa.startTransaction(),Zb(b);try{for(h=2,i=3,j=d?mb(b,h):mb(b,i),b.qq=a.qq,k=a.size,l=0;l<e;l++)for(m=c[l],n=m.firstCol,o=m.lastCol,p=n;p<=o;p++)0<=p&&p<j&&(d&&b.getColumnResizable(p,h)&&k!==b.$r(p,h)?(b.setColumnWidth(p,k,h),s=!0):!d&&b.getColumnResizable(p,i)&&k!==b.$r(p,i)&&(b.setColumnWidth(p,k,i),s=!0))}finally{wb(b),b.Wq(w,{sheet:b,sheetName:b.name(),colList:f,header:a.rowHeader}),ub(b),q=P.bWa(b.name()),a[q]=b.ITa.endTransaction()}b.qs()}return s},b.prototype.undo=function(){var a,b,c,d,e,f,g,h,i=this,j=!1;if(i.canUndo()&&(a=i.VQ,b=i.kj,c=a.columns,d=a.rowHeader,e=c&&c.length,b&&e>0)){if(f=i.Sz(c),g={sheet:b,sheetName:b.name(),colList:f,header:d,cancel:!1},b.Wq(v,g),g&&g.cancel===!0)return j;Zb(b);try{h=P.bWa(b.name()),b.ITa.undo(a[h]),b.oq=!0,b.showCell(b.getActiveRowIndex(),b.getActiveColumnIndex(),1,1),j=!0}finally{wb(b),b.Wq(w,{sheet:b,sheetName:b.name(),colList:f,header:a.rowHeader}),ub(b)}}return j},b.prototype.Sz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstCol,f=d.lastCol,g=e;g<=f;g++)h.push(g);return h},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ya),$a=function(a){kb(b,a);function b(b,c){var d=a.call(this,b,c)||this;return _b(c,b),d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=!1;if(r.canExecute()&&(a=r.kj,b=r.VQ,c=b.rows,d=c&&c.length,a&&d>0)){if(e=r.Vz(c),f={sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader,cancel:!1},a.Wq(x,f),f&&f.cancel===!0)return s;b.Tz=!0,a.ITa.startTransaction(),Zb(a);try{for(g=3,h=1,i=b.columnHeader,j=i?lb(a,h):lb(a,g),a.lq=b.lq,k=b.size,l=0;l<d;l++)for(m=c[l],n=m.firstRow,o=m.lastRow,p=n;p<=o;p++)0<=p&&p<j&&(i&&a.getRowResizable(p,h)&&k!==a.Yr(p,h)?(a.setRowHeight(p,k,h),s=!0):!i&&a.getRowResizable(p,g)&&k!==a.Yr(p,g)&&(a.setRowHeight(p,k,g),s=!0))}finally{wb(a),a.Wq(y,{sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader}),ub(a),q=P.bWa(a.name()),b[q]=a.ITa.endTransaction()}a.os()}return s},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this,i=!1;if(h.canUndo()&&(a=h.kj,b=h.VQ,c=b.rows,d=c&&c.length,a&&d>0)){if(e=h.Vz(c),f={sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader,cancel:!1},a.Wq(x,f),f&&f.cancel===!0)return i;Zb(a);try{g=P.bWa(a.name()),a.ITa.undo(b[g]),a.jq=!0,a.showCell(a.getActiveRowIndex(),a.getActiveColumnIndex(),1,1),i=!0}finally{wb(a),a.Wq(y,{sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader}),ub(a)}}return i},b.prototype.Vz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstRow,f=d.lastRow,g=e;g<=f;g++)h.push(g);return h},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ya),_a=function(a){kb(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i=this,j=!1,k=i.VQ,l=i.kj,m=k.columns,n=k.rowHeader,o=i.Sz(m);if(l&&m&&m.length>0){if(a={sheet:l,sheetName:l.Cj,colList:o,header:n,cancel:!1},l.Wq(v,a),a&&a.cancel===!0)return j;l.ITa.startTransaction(),i.Lz(l);try{b=I(k.size),c=n?2:3,d=m[0].firstCol,e=void 0,f=void 0,g=void 0,e=l.$r(d,c),b!==e&&(f=b-e,g=l.Zq(d,c),l.setColumnWidth(d,b,c),l.setColumnWidth(g,l.$r(g,c)-f,c)),j=!0}finally{wb(l),l.Wq(w,{sheet:l,sheetName:l.Cj,colList:o,header:k.rowHeader}),ub(l),h=P.bWa(l.name()),k[h]=l.ITa.endTransaction()}}return j},b.prototype.undo=function(){var a,b=this.kj,c=this.VQ.columns,d=!1,e=this.VQ,f=this.VQ.rowHeader,g=this.Sz(c),h={sheet:b,sheetName:b.Cj,colList:g,header:f,cancel:!1};if(b.Wq(v,h),h&&h.cancel===!0)return d;Zb(b);try{a=P.bWa(b.name()),b.ITa.undo(e[a]),d=!0}finally{wb(b),b.Wq(w,{sheet:b,sheetName:b.Cj,colList:g,header:e.rowHeader}),ub(b)}return d},b.prototype.Sz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstCol,f=d.lastCol,g=e;g<=f;g++)h.push(g);return h},b}(Ya),ab=function(a){kb(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i=this,j=!1,k=i.VQ,l=i.kj,m=k.rows,n=k.columnHeader,o=i.Vz(m);if(l&&m&&m.length>0){if(a={sheet:l,sheetName:l.Cj,rowList:o,header:n,cancel:!1},l.Wq(x,a),a&&a.cancel===!0)return j;l.ITa.startTransaction(),i.Lz(l);try{b=I(k.size),c=n?1:3,d=m[0].firstRow,e=void 0,f=void 0,g=void 0,e=l.Yr(d,c),b!==e&&(f=b-e,g=l._q(d,c),l.setRowHeight(d,b,c),l.setRowHeight(g,l.Yr(g,c)-f,c)),j=!0}finally{wb(l),l.Wq(y,{sheet:l,sheetName:l.Cj,rowList:o,header:k.columnHeader}),ub(l),h=P.bWa(l.name()),k[h]=l.ITa.endTransaction()}}return j},b.prototype.undo=function(){var a,b=this.kj,c=this.VQ.rows,d=!1,e=this.VQ,f=this.VQ.columnHeader,g=this.Vz(c),h={sheet:b,sheetName:b.Cj,rowList:g,header:f,cancel:!1};if(b.Wq(x,h),h&&h.cancel===!0)return d;Zb(b);try{a=P.bWa(b.name()),b.ITa.undo(e[a]),d=!0}finally{wb(b),b.Wq(y,{sheet:b,sheetName:b.Cj,rowList:g,header:e.columnHeader}),ub(b)}return d},b.prototype.Vz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstRow,f=d.lastRow,g=e;g<=f;g++)h.push(g);return h},b}(Ya),bb=function(a){kb(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d,f=b.parent;return e.Wz=c.rowHeader?2:3,A(c.autoFitType)||(c.autoFitType=f?f.options.autoFitType:0),d}return b.prototype.canExecute=function(){var a=this.VQ;return this.kj&&a.columns&&a.columns.length>0},b.prototype.execute=function(){var a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,r=this,s=!1;if(r.canExecute()){if(a=r.VQ,b=r.kj,c=r.Wz,d=r.Sz(a.columns),e=2===c,f={sheet:b,sheetName:b.name(),colList:d,header:e,cancel:!1},b.Wq(v,f),f&&f.cancel===!0)return s;for(a.Tz=!0,g=mb(b,c),h=g-1,j=0,k=void 0,l=0,m=a.columns.length;l<m;l++)k=a.columns[l].col,h=h>k?k:h,j=j<k?k:j;i.mn.qn(b,0,h,lb(b)-1,j),b.ITa.startTransaction(),Zb(b);try{for(n=void 0,l=0,m=a.columns.length;l<m;l++)o=a.columns[l].col,0<=o&&o<g&&b.getColumnResizable(o,c)&&(n=r.xl(o),n===b.getColumnWidth(o,c)&&q(b.getColumnWidth(o,c,!0))||(b.setColumnWidth(o,n,c),s=!0))}finally{i.mn.Nm(),wb(b),b.Wq(w,{sheet:b,sheetName:b.name(),colList:d,header:e}),ub(b),p=P.bWa(b.name()),a[p]=b.ITa.endTransaction()}}return s},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this,i=!1;if(h.canUndo()){if(a=h.VQ,b=h.kj,c=h.Wz,d=h.Sz(a.columns),e=2===c,f={sheet:b,sheetName:b.name(),colList:d,header:e,cancel:!1},b.Wq(v,f),f&&f.cancel===!0)return i;Zb(b);try{g=P.bWa(b.name()),b.ITa.undo(a[g]),i=!0}finally{wb(b),b.Wq(w,{sheet:b,sheetName:b.name(),colList:d,header:e}),ub(b)}}return i},b.prototype.Sz=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],d.push(c.col);return d},b.prototype.xl=function(a){return i.Ul.xl(a,this.kj,this.Wz,this.VQ.autoFitType)},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ya),cb=function(a){kb(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d,f=b.parent;return e.Wz=c.columnHeader?1:3,A(c.autoFitType)||(c.autoFitType=f?f.options.autoFitType:0),d}return b.prototype.canExecute=function(){var a=this.VQ;return this.kj&&a.rows&&a.rows.length>0},b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this,n=!1;if(m.canExecute()){if(a=m.VQ,b=m.kj,c=m.Vz(a.rows),d=m.Wz,e=1===m.Wz,f={sheet:b,sheetName:b.name(),rowList:c,header:e,cancel:!1},b.Wq(x,f),f&&f.cancel===!0)return n;a.Tz=!0,b.ITa.startTransaction(),Zb(b);try{for(g=lb(b,d),h=void 0,i=0,j=a.rows.length;i<j;i++)k=a.rows[i].row,0<=k&&k<g&&b.getRowResizable(k,d)&&(h=m.Fl(k),h===b.getRowHeight(k,d)&&q(b.getRowHeight(k,d,!0))||(b.setRowHeight(k,h,d),n=!0))}finally{wb(b),b.Wq(y,{sheet:b,sheetName:b.name(),rowList:c,header:e}),ub(b),l=P.bWa(b.name()),a[l]=b.ITa.endTransaction()}}return n},b.prototype.undo=function(){var a,b,c,d,e,f,g=this,h=!1;if(g.canUndo()){if(a=g.VQ,b=g.kj,c=g.Vz(a.rows),d=1===g.Wz,e={sheet:b,sheetName:b.name(),rowList:c,header:d,cancel:!1},b.Wq(x,e),e&&e.cancel===!0)return h;Zb(b);try{f=P.bWa(b.name()),b.ITa.undo(a[f]),h=!0}finally{wb(b),b.Wq(y,{sheet:b,sheetName:b.name(),rowList:c,header:d}),ub(b)}}return h},b.prototype.Vz=function(a){var b,c,d,e=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.push(d.row);return e},b.prototype.Fl=function(a){return i.Ul.Fl(a,this.kj,this.Wz,this.VQ.autoFitType)},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ya);function ac(a,b){"value"===b.propertyName&&a.xu(b.row,b.col,b.oldValue,b.newValue)}db=function(a){kb(b,a);function b(b,c){var d,e,f=a.call(this,b,c)||this;return p&&c.ranges&&1===c.endEditType&&(d=b.Tq(c.ranges[0]),c.ranges[0]=d,1===nb(d)&&1===ob(d)&&(e=b.Ms(d.row,d.col,1,1),e&&e.ranges&&e.ranges.length>0&&(c.ranges=[e.ranges[0]]))),f}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=c.VQ,f=e.ranges,g=e.row,h=e.col;if(f){for(a=0;a<f.length;a++)if(b=f[a],!d.Y3(b.row,b.col,nb(b),ob(b)))return!1}else if(!d.Y3(g,h,1,1))return!1;return!0},b.prototype.yA=function(a){var b,c,d,e,f=this,g=f.VQ,h=g.ranges;if(h)for(b=0;b<h.length;b++)for(c=h[b],d=c.row;d<c.row+nb(c);d++)for(e=c.col;e<c.col+ob(c);e++)a(d,e);else a(g.row,g.col)},b.prototype.undo=function(){var a,b,c,d=this;if(d.canUndo()){a=d.kj,b=d.VQ,Zb(a,!0);try{a.Fu(u+Wa,function(b,c){ac(a,c)}),c=P.bWa(a.name()),a.ITa.undo(b[c])}catch(a){return!1}finally{a.Gu(u+Wa),$b(a,!0)}return!0}return!1},b.prototype.execute=function(){var a,b,c=this,d=!1;if(c.canExecute()){a=c.kj,b=a.parent.yYc(),P.Zxb(b),Zb(a,!0);try{a.Fu(u+Wa,function(b,c){ac(a,c)}),c.VQ.applyResult=c.AA(),d=!0}catch(a){d=!1}finally{a.Gu(u+Wa),P.$xb(b,c.VQ),$b(a,!0)}}return d},b.prototype.zA=function(a,b){return a+"_"+b},b.prototype.BA=function(a){var b,c,d,e,f,g,h=this,i=0,j=h.kj,k=h.VQ,l=k.row,m=k.col,n=k.newValue,o=!k.hasOwnProperty("autoFormat")||k.autoFormat;return p&&n&&n.length>0&&"="===n[0]?j.getDataValidator&&j.getDataValidator(l,m)&&(b=n.substring(1),""!==b&&b!==j.getFormula(l,m)&&(c=j.Cf(),c&&(d=c.parse(j.yj(),b,l>=0?l:0,m>=0?m:0,!0),d&&(e=c.Hg(j.yj(),d,{row:l,col:m}),j.isValid&&!j.isValid(l,m,e)&&(i=j.Nx(l,m)))))):(f=h.CA(l,m,n,o,a),g=!j.isValid||j.isValid(l,m,f),g||(i=j.Nx(l,m),j.mm.DA=!0)),i},b.prototype.AA=function(){var a,b,c,d,e,f,j,k,l,m,n,q,r,s,t,u,v=this,w=v.kj,x=v.VQ,y=x.newValue,z=x.ignoreValidate,A={tka:!1,uka:!1,_autoFormatter:E,quotePrefix:E},B=0;if(z!==!0&&(B=v.BA(A),1===B||2===B))return B;if(b=!x.hasOwnProperty("autoFormat")||x.autoFormat,c=x.row,c=c>=0?c:0,d=x.col,d=d>=0?d:0,e=p&&o&&o.Parser,!w.xUc&&e)if(k=w.Cf(),l=w.parent,m=l&&l.options.allowUserEditFormula,n=w.getFormatter(c,d),"@"!==n&&m&&k&&i.bW(y)){"="===y[0]&&(y=y.substring(1));try{if(x.ranges&&1===x.endEditType)return j=x.ranges[0],w.setArrayFormula(j.row,j.col,nb(j),ob(j),y),B;f=k.parse(w.yj(),y,c,d,!0)}catch(a){throw w.Os(0,"string"==typeof a?a:a.message),a}}else x.ranges&&1===x.endEditType&&(j=x.ranges[0],w.getRange(j.row,j.col,nb(j),ob(j),3).clear(1));return f||(y&&"'"===y[0]?v.Uia(c,d,!0,A):v.Uia(c,d,E,A),a=v.CA(c,d,y,b,A)),v.yA(function(b,c){if(f)try{var d=k.unparse(w.yj(),f,b,c);w._u(b,c,d,f),w.Wq(i.Events.UserFormulaEntered,{sheet:w,sheetName:w.name(),row:b,col:c,isCircularReference:w.ngc(b,c),formula:d})}catch(a){throw w.Os(0,"string"==typeof a?a:a.message),a}else{try{w.hasFormula&&w.hasFormula(b,c)&&w.setFormula(b,c,D)}catch(a){throw w.Os(0,"string"==typeof a?a:a.message),a}try{w.uq(b,c,a,x.sheetArea),"string"!=typeof a&&null!==a||h.Worksheet.ao(w,"setHyperlinkWhenEditing",{url:a,row:b,col:c,sheetArea:x.sheetArea})}catch(a){w.setValue(b,c,y)}}}),q=A.tka,r=A.uka,(q||r)&&(s=w.Aj(c,d),t="string"==typeof s,s&&!t||(u=new g.Style,t&&(u.parentName=s),s=u),q&&(s._autoFormatter=A._autoFormatter),r&&(s.quotePrefix=A.quotePrefix),w.setStyle(c,d,s)),B},b.prototype.canUndo=function(){return 0===this.VQ.applyResult},b.prototype.CA=function(a,b,c,d,e){var f,g,h,j=this,k=j.kj,l=j.VQ,m=l.ignoreFormatting,n=k.getActualStyle(a,b),o={};return f="string"!=typeof c||m?c:c&&"'"===c[0]?c.substring(1):i.Ul.ul(n,c,d,o,l.editingFormatter),e.quotePrefix?(e._autoFormatter=E,e.tka=!0):(g=o.value,d&&g&&(h=D,(f!==D&&"General"!==g.formatString()||!n._autoFormatter)&&(g.isAuto=!0,h=g),h&&(e.tka=!0,e._autoFormatter=h))),f},b.prototype.Uia=function(a,b,c,d){var e,f=this,h=f.kj,i=h.Aj(a,b),j="string"==typeof i;i&&!j||(e=new g.Style,j&&(e.parentName=i),i=e),i.quotePrefix!==c&&(d.uka=!0,d.quotePrefix=c)},b}(Ya);function bc(a){var b=a.parent,c=b&&b.YJc;c&&c.repaint()}eb=function(a){kb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canUndo=function(){return!!this.VQ.oldName},b.prototype.canExecute=function(){var a=this,b=a.VQ;return a.kj&&b.name&&b.name!==b.oldName},b.prototype.execute=function(){var a,b,c,d,e,f=this,g=f.kj,h=f.VQ,j=h.name,k=!1;return f.canExecute()&&(a=g.name(),b=j,c={sheet:g,oldValue:a,newValue:b,cancel:!1},g.Wq(i.Events.SheetNameChanging,c),c.cancel===!1&&(h.oldName=a,g.ITa.startTransaction(),Zb(g,!0),xb(g),g.cq(j),bc(g),d=P.bWa(g.name()),h[d]=g.ITa.endTransaction(),k=!0,h.sheetName=j,yb(g,!1),$b(g,!0),e={sheet:g,oldValue:a,newValue:b},g.Wq(i.Events.SheetNameChanged,e))),k},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this;return!(!h.canUndo()||(a=h.kj,b=h.VQ,c=b.name,d=b.oldName,e={sheet:a,oldValue:c,newValue:d,cancel:!1},a.Wq(i.Events.SheetNameChanging,e),e.cancel!==!1))&&(Zb(a,!0),xb(a),f=P.bWa(a.name()),a.ITa.undo(b[f]),bc(a),b.sheetName=b.oldName,yb(a,!1),$b(a,!0),g={sheet:a,oldValue:c,newValue:d},a.Wq(i.Events.SheetNameChanged,g),!0)},b}(Ya),fb=function(a){kb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a=this;return a.kj&&a.kj.parent.options.allowUserZoom&&a.kj.zoom()!==a.VQ.zoomFactor},b.prototype.execute=function(){var a,b,c,d,e=this,f=e.VQ,g=!1;return e.canExecute()&&(a=e.kj,b=a.ITa,c=f.zoomFactor,b.startTransaction(),g=cc(a,c),b.ZVa(["zoomChanged",c,f.oldZoomFactor]),d=P.bWa(a.name()),f[d]=a.ITa.endTransaction()),g},b.prototype.undo=function(){var a,b=this.kj;if(this.canUndo())return!(b.isEditing()===!0&&!b.endEdit())&&(b.suspendPaint(),a=P.bWa(b.name()),b.ITa.undo(this.VQ[a]),b.resumePaint(),!0)},b}(Ya);function cc(a,b){return!(a.isEditing()===!0&&!a.endEdit())&&(a.suspendPaint(),a.zoom(b),a.resumePaint(),!0)}gb=function(a){kb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k=this;k.canExecute()&&(a=k.kj,b=k.VQ.clearRange,c=a.tables&&a.tables.$Hb&&a.tables.$Hb(b.row,b.col,b.rowCount,b.colCount),a.isDirtySuspended()||(k.VQ.Iu=new Xa(a,a.Tq(b),3)),c&&c.length>0&&(k.VQ.tableNames=c),d=a.Tq(b),e=d.row,f=d.col,g=nb(d),h=ob(d),h>0&&g>0&&(a.ITa.startTransaction(),Zb(a),a.vxb=!0,a.cg(e,f,g,h,3,1,!0),$b(a),a.vxb=!1,i=P.bWa(a.name()),k.VQ[i]=a.ITa.endTransaction(),j=k.VQ.Iu,P.Bu(a,e,f,g,h,j?j.wy():[],2,c)))},b.prototype.canExecute=function(){var a=this.VQ.clearRange;return this.kj.Y3(a.row,a.col,nb(a),ob(a))},b.prototype.canUndo=function(){var a=P.bWa(this.kj.name()),b=this.VQ[a];return P.cWa(b)},b.prototype.undo=function(){var a,b,c,d=this,e=d.kj;if(d.canUndo()&&e&&(a=e.Tq(d.VQ.clearRange),ob(a)>0&&nb(a)>0)){Zb(e);try{b=P.bWa(e.name()),e.ITa.undo(d.VQ[b])}finally{$b(e)}return c=d.VQ.Iu,P.Bu(e,a.row,a.col,nb(a),ob(a),c?c.wy():[],2,d.VQ.tableNames,!0),!0}return!1},b.prototype.toJSON=function(){var a=this;return{sheetName:a.kj?a.kj.name():"",command:a.VQ}},b}(Ya),hb=function(a){kb(b,a);function b(b,c,d){var e,f,g=a.call(this,b,c)||this;if(!d&&(c.cachedActions=[],e=c.ranges,e&&e.length>0))for(f=0;f<e.length;f++)c.cachedActions[f]=new gb(b,{clearRange:e[f]});return g}return b.prototype.canExecute=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canExecute())return!1;return!0}return!1},b.prototype.execute=function(){var a,b,c,d,e=this;if(e.canExecute()&&(a=e.VQ.cachedActions,b=e.kj,a)){for(Zb(b,!0),c=0;c<a.length;c++)d=a[c],d.execute();return $b(b,!0),!0}return!1},b.prototype.canUndo=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canUndo())return!1;return!0}return!1},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.VQ.cachedActions;if(e.canUndo()){for(a=e.kj,b=f.length-1;b>=0;b--)if(c=f[b],Zb(a,!0),d=c.undo(),$b(a,!0),!d)return!1;return!0}return!1},b}(Ya),P.OA=hb,ib=function(a){kb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.qx=function(a){var b=0;return 0!==a&&1!==a||(b|=1),0!==a&&2!==a||(b|=64,b|=32,b|=512),0!==a&&3!==a||(b|=2),0!==a&&4!==a||(b|=1,b|=64,b|=32),0!==a&&5!==a||(b|=64,b|=32,b|=2),0===a&&(b|=32,b|=16,b|=256,b|=4,b|=512,b|=128,b|=1024),b},b.prototype.canExecute=function(){var a=this,b=a.VQ,c=b.pasteExtent,d=c.targetRange,e=c.sourceRange;return b.toSheet.Y3(d.row,d.col,nb(d),ob(d))&&(!c.isCutting||b.fromSheet.Y3(e.row,e.col,nb(e),ob(e)))},b.prototype.oUa=function(){var a=this,c=a.VQ.pasteExtent,d=a.VQ.io={},e=c.isCutting,f=b.qx(a.VQ.pasteOption),g=c.sourceRange,h=c.targetRange,i=a.VQ.fromSheet,j=a.VQ.toSheet;i&&g&&e&&!i.isDirtySuspended()&&(d.cA=new Xa(i,g,f)),j.isDirtySuspended()||(d.fA=new Xa(j,h,f))},b.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},b.prototype._Hb=function(a,b,c,d,e){var f,g,h,i,j,k,m,n,o,p,q,r,s,t=!1,u=b.row,v=b.col,w=b.rowCount,x=b.colCount,y=!1,z=!1,A=!1,B=!1,C=pb(e),D=!1,E=!1,F=e.KLc(),G=e.getRowCount(),H=e.getColumnCount(),I=w,J=x,K=0,L=0,M=0,N=0;if(F&&(I-=e.NLc(u,I,!0),J-=e.NLc(v,J)),a||I%c.rowCount!==0&&J%c.colCount!==0){if(d===l.InsertShiftCell.right){if(n=c.rowCount,o=void 0,f=u,h=c.rowCount,F&&(o=e.MLc(u,n),n+=o,h+=o),u!==c.row&&c.intersect(u,v,n,e.getColumnCount()-v))return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(v>c.col&&v<=c.col+c.colCount-1&&u>c.row&&u<=c.row+c.rowCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(this.aIb(e,u,v,n,e.getColumnCount()-v))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),E=!0,{returnFunc:E};if(u===c.row&&v<=c.col&&(F?(c.col+=c.colCount,c.col=e.Zq(c.col-1),L=e.MLc(c.col,c.colCount),c.colCount+=L):c.col=c.col+c.colCount,y=!0),g=e.getColumnCount()-c.colCount,i=c.colCount,F&&(N=e.MLc(v,c.colCount),p=c.colCount+N,i=p+e.OLc(H-1,p),g=H-i,y&&(c.col+=N)),D=this.bIb(e,f,g,h,i),D&&!C)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),E=!0,{returnFunc:E}}else if(d===l.InsertShiftCell.down){if(q=c.colCount,r=void 0,g=v,i=c.colCount,F&&(r=e.MLc(v,q),q+=r,i+=r),v!==c.col&&c.intersect(u,v,e.getRowCount()-u,q))return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(u>c.row&&u<=c.row+c.rowCount-1&&v>c.col&&v<=c.col+c.colCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(this.cIb(e,u,v,e.getRowCount()-u,q))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),E=!0,{returnFunc:E};if(v===c.col&&u<=c.row&&(F?(c.row=c.row+c.rowCount,c.row=e._q(c.row-1),K=e.MLc(c.row,c.rowCount,!0),c.rowCount+=K):c.row=c.row+c.rowCount,z=!0),f=G-c.rowCount,h=c.rowCount,F&&(M=e.MLc(u,c.rowCount,!0),s=c.rowCount+M,h=s+e.OLc(G-1,s,!0),f=G-h,z&&(c.row+=M)),D=this.bIb(e,f,g,h,i),D&&!C)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),E=!0,{returnFunc:E}}}else if(j=0,k=0,I%c.rowCount===0&&J%c.colCount!==0?(x=b.colCount=c.colCount,F&&(j=e.MLc(v,x),x+=j,b.colCount=x)):I%c.rowCount!==0&&J%c.colCount===0&&(w=b.rowCount=c.rowCount,F&&(k=e.MLc(u,w,!0),w+=k,b.rowCount=w)),t=!0,d===l.InsertShiftCell.right){if(m=!1,u<=c.row&&u+w>=c.row+c.rowCount&&(m=!0),v>c.col&&v<=c.col+c.colCount-1&&u>c.row&&u<=c.row+c.rowCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(!m&&c.intersect(u,v,w,e.getColumnCount()-v))return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(this.aIb(e,u,v,w,e.getColumnCount()-v))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),E=!0,{returnFunc:E};if(m&&v<=c.col&&(F?(c.col+=x,c.col=e.Zq(c.col-1),L=e.MLc(c.col,x),c.colCount+=L):c.col+=x,A=!0),f=u,h=w,g=e.getColumnCount()-x,i=x,F&&(N=e.OLc(H-1,x),i=x+N+j,g=H-i),D=this.bIb(e,f,g,h,i),D&&!C)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),E=!0,{returnFunc:E}}else if(d===l.InsertShiftCell.down){if(m=!1,v<=c.col&&v+x>=c.col+c.colCount&&(m=!0),u>c.row&&u<=c.row+c.rowCount-1&&v>c.col&&v<=c.col+c.colCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(!m&&c.intersect(u,v,e.getRowCount()-u,x))return e.Os(1,O().Exp_InsertCopiedCutCells),E=!0,{returnFunc:E};if(this.cIb(e,u,v,e.getRowCount()-u,x))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),E=!0,{returnFunc:E};if(m&&u<=c.row&&(F?(c.row+=w,c.row=e._q(c.row-1),K=e.MLc(c.row,w,!0),c.rowCount+=K):c.row+=w,B=!0),f=e.getRowCount()-w,h=w,g=v,i=x,F&&(M=e.OLc(G-1,w,!0),h=w+M+k,f=G-h),D=this.bIb(e,f,g,h,i),D&&!C)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),E=!0,{returnFunc:E}}return{changePasteDataRangeCol:y,changePasteDataRangeRow:z,changePasteDataRangeCols:A,changePasteDataRangeRows:B,moveRangeHaveValue:D,returnFunc:E,selectRange:t,changePasteDataRangeRowInvisibleCount:K,changePasteDataRangeColInvisibleCount:L,invisibleRowCountInAcRange:M,invisibleColCountInAcRange:N}},b.prototype.dIb=function(a,b,c,d,e,f,g,h,i){var j,k,m,n,o,p,q,r,s,t,u,v,w=!1,x=!1,y=c.KLc();if(a){if(b===l.InsertShiftCell.right)if(c.Vq(f,g+i,h,c.getColumnCount()-g-i,!0))if(g+i<c.getColumnCount()){if(y)if(j=h,k=i+c.OLc(c.getColumnCount()-1,i),f<0)c.moveTo(f,g,f,g+i,h,c.getColumnCount()-g-i,1023,!0);else for(m=f;m<f+j&&m<c.getRowCount();m++)0!==c.getRowHeight(m)&&c.moveTo(m,g,m,g+i,1,c.getColumnCount()-g-k,1023,!0);else c.moveTo(f,g,f,g+i,h,c.getColumnCount()-g-i,1023,!0);n=c.rowFilter(),o=n&&n.range,o&&f===-1&&o.colCount>1&&g>o.col&&g<=o.col+o.colCount-1&&(o.colCount=o.colCount+e.colCount)}else g+i>c.getColumnCount()&&(w=!0,x=!0);else w=!0,x=!0;else if(b===l.InsertShiftCell.down)if(c.Vq(f+h,g,c.getRowCount()-f-h,i,!0))if(f+h<c.getRowCount())if(y)if(p=i,q=h+c.OLc(c.getRowCount()-1,h,!0),g<0)c.moveTo(f,g,f+h,g,c.getRowCount()-f-q,e.colCount,1023,!0);else for(r=g;r<g+p&&r<c.getColumnCount();r++)0!==c.getColumnWidth(r)&&c.moveTo(f,r,f+h,r,c.getRowCount()-f-q,1,1023,!0);else c.moveTo(f,g,f+h,g,c.getRowCount()-f-h,i,1023,!0);else f+h>c.getRowCount()&&(w=!0,x=!0);else w=!0,x=!0}else if(b===l.InsertShiftCell.right)if(c.Vq(f,g+e.colCount,e.rowCount,c.getColumnCount()-g-e.colCount,!0))if(g+e.colCount<c.getColumnCount()){if(y)if(s=e.rowCount,t=e.colCount+c.MLc(g,e.colCount),k=t+c.OLc(c.getColumnCount()-1,t),f<0)c.moveTo(f,g,f,g+t,e.rowCount,c.getColumnCount()-g-k,1023,!0);else for(m=f;m<f+s&&m<c.getRowCount();m++)0!==c.getRowHeight(m)?c.moveTo(m,g,m,g+t,1,c.getColumnCount()-g-k,1023,!0):s++;else c.moveTo(f,g,f,g+e.colCount,e.rowCount,c.getColumnCount()-g-e.colCount,1023,!0);n=c.rowFilter(),o=n&&n.range,o&&f===-1&&o.colCount>1&&g>o.col&&g<=o.col+o.colCount-1&&(o.colCount=o.colCount+e.colCount)}else g+e.colCount>c.getColumnCount()&&(w=!0,x=!0);else w=!0,x=!0;else if(b===l.InsertShiftCell.down)if(c.Vq(f+e.rowCount,g,c.getRowCount()-f-e.rowCount,e.colCount,!0))if(f+e.rowCount<c.getRowCount())if(y)if(u=e.colCount,v=e.rowCount+c.MLc(f,e.rowCount,!0),q=v+c.OLc(c.getRowCount()-1,v,!0),g<0)c.moveTo(f,g,f+v,g,c.getRowCount()-f-q,e.colCount,1023,!0);else for(r=g;r<g+u&&r<c.getColumnCount();r++)0!==c.getColumnWidth(r)?c.moveTo(f,r,f+v,r,c.getRowCount()-f-q,1,1023,!0):u++;else c.moveTo(f,g,f+e.rowCount,g,c.getRowCount()-f-e.rowCount,e.colCount,1023,!0);else f+e.rowCount>c.getRowCount()&&(w=!0,x=!0);else w=!0,x=!0;return{raiseInvalidOperation:w,returnFunc:x}},b.prototype.ogc=function(a,b,c,d,e,f,g,h){var i=h.changePasteDataRangeRowInvisibleCount,j=h.changePasteDataRangeColInvisibleCount,k=h.invisibleRowCountInAcRange,l=h.invisibleColCountInAcRange,m=this.VQ.pasteExtent.targetRange;a&&(b.colCount-=j,b.col-=b.colCount,b.col-=l,m.colCount-=j),c&&(b.rowCount-=i,b.row-=b.rowCount,b.row-=k,m.rowCount-=i),d&&(b.colCount-=j,b.col-=f,b.col-=l,m.colCount-=j),e&&(b.rowCount-=i,b.row-=g,b.row-=k,m.rowCount-=i),h.changePasteDataRangeRowInvisibleCount=0,h.changePasteDataRangeColInvisibleCount=0,h.invisibleRowCountInAcRange=0,h.invisibleColCountInAcRange=0},b.prototype.PLc=function(a,b){var c=[].concat(b.parent.sheets);return a&&a.xUc&&c.push(a),b&&b!==a&&b.xUc&&c.push(b),c},b.prototype.execute=function(){var a,c,d,e,f,g,h,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,F,G,H,I,J,K,L,M,N,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da=this;if(da.canExecute()){if(a=da.VQ.fromSheet,c=da.VQ.toSheet,d=da.VQ.pasteExtent,e=da.VQ.pasteOption,f=d.sourceRange,g=d.targetRange,h=d.isCutting,a&&f&&!a.pu(f.row,f.col,nb(f),ob(f),lb(a),mb(a)))return;if(!(c&&g&&c.l5(g.row,g.col,nb(g),ob(g),!0)))return;if(c.tables&&c.tables.zxb(a,f,c,g,h))return;if(c.pivotTables&&c.pivotTables.OOc(f,g,c))return;if(j=void 0,k=void 0,m=void 0,n=void 0,a&&(m=a.tu(),j=da.WHb,k=da.YHb,n=k&&new i.Range(k.row,k.col,k.rowCount,k.colCount)),o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,da.XHb&&(o=da.XHb.row,p=da.XHb.col,q=da.XHb.rowCount,r=da.XHb.colCount),t=!1,u=!1,v=!1,w=!1,x=pb(c),y=!1,z=0,A=0,B=0,C=0,j!==E&&k){if(D=this._Hb(h,da.XHb,k,j,c),D.returnFunc)return;t=D.changePasteDataRangeCol,u=D.changePasteDataRangeRow,z=D.changePasteDataRangeRowInvisibleCount,A=D.changePasteDataRangeColInvisibleCount,B=D.invisibleRowCountInAcRange,C=D.invisibleColCountInAcRange,v=D.changePasteDataRangeCols,w=D.changePasteDataRangeRows,y=D.moveRangeHaveValue,s=D.selectRange,q=da.XHb.rowCount,r=da.XHb.colCount,g.rowCount+=z,g.colCount+=A}da.oUa(),F=da.PLc(a,c),P.Zxb(F),tb(c),vb(c),c.vxb=!0,G=!1,a&&(vb(a),a.vxb=!0);try{if(x&&(H=-1,I=-1,g.row!==-1?H=g.row+nb(g):f.row===-1&&(H=lb(a)),J=lb(c),K=H-J,H>J&&da.vTa(f,g)?j===l.InsertShiftCell.down&&y?c.addRows(J,K+(J-o)):c.addRows(J,K):y||o+g.rowCount!==lb(c)||j!==l.InsertShiftCell.down?y&&j===l.InsertShiftCell.down&&c.addRows(J,K+(J-o)):c.addRows(J,K+(J-o)-n.rowCount),g.col!==-1?I=g.col+ob(g):f.col===-1&&(I=mb(a)),I>mb(c)&&da.vTa(f,g)?j===l.InsertShiftCell.right&&y?c.setColumnCount(I+c.getColumnCount()-p):c.setColumnCount(I):y||p+g.colCount!==mb(c)||j!==l.InsertShiftCell.right?y&&j===l.InsertShiftCell.right&&c.setColumnCount(I+c.getColumnCount()-p):c.setColumnCount(I+c.getColumnCount()-p-n.colCount)),L=j!==E&&this.dIb(s,j,c,da.XHb,n,o,p,q,r),G=L.raiseInvalidOperation,L.returnFunc)return;f&&i.mn.qn(a,f.row,f.col,f.row+nb(f)-1,f.col+ob(f)-1);try{c.tables&&c.tables.fIb(g,f)}catch(a){return c.Os(6,a.message),void c.resumePaint()}c.px(a,f,c,g,h,d.clipboardText,d.clipboardHtml,d.clipboardImage,e,!d.includeFilteredOutRow),h&&j!==E&&(M=f.row,N=f.col,Q=f.rowCount,R=f.colCount,S=g.row,T=g.col,U=g.rowCount,V=g.colCount,j===l.InsertShiftCell.right&&f.row===g.row&&a.moveTo(M,N+R,S,N,Q,c.getColumnCount()-N-R,1023,!0),j===l.InsertShiftCell.down&&f.col===g.col&&a.moveTo(M+Q,N,M,T,c.getRowCount()-M-Q,R,1023,!0))}finally{f&&i.mn.Nm(),wb(c),c.vxb=!1,a&&(wb(a),a.vxb=!1),ub(c),P.$xb(F,da.VQ),W=da.VQ.io,X=b.qx(e),d.isCutting&&a&&(Y=[],a.isDirtySuspended()||(Z=new Xa(a,f,X),Z.uy(W.cA.sy()),W._z=Z,Y=Z.wy()),P.Bu(a,f.row,f.col,nb(f),ob(f),Y,3)),c&&($=[],c.isDirtySuspended()||(_=new Xa(c,g,X),_.uy(W.fA.sy()),W.dA=_,$=_.wy()),aa=c.tables&&c.tables.$Hb&&c.tables.$Hb(g.row,g.col,g.rowCount,g.colCount),ba=nb(g),ca=ob(g),P.Bu(c,g.row,g.col,ba,ca,$,3,aa),da.tableNamesObj={r:g.row,c:g.col,rc:ba,cc:ca,tableNames:aa}),da.pgc={changePasteDataRangeCol:t,changePasteDataRangeRow:u,changePasteDataRangeCols:v,changePasteDataRangeRows:w,acColCount:r,acRowCount:q,changePasteDataRangeRowInvisibleCount:z,changePasteDataRangeColInvisibleCount:A,invisibleRowCountInAcRange:B,invisibleColCountInAcRange:C},m&&delete m.UHb,G&&c.Os(1,O().Exp_InsertCopiedCutCellsNoRange)}}},b.prototype.aIb=function(a,b,c,d,e){var f,g,h,i=a.ITa.getSpans(),j=a.tables.l$;for(f=0;f<i.length;f++)if(g=i[f],!(b<=g.row&&c<=g.col&&b+d>=g.row+g.rowCount&&c+e>=g.col+g.colCount||g.row>b+d||g.row+g.rowCount-1<b||g.row>b+d-1||g.row+g.rowCount-1<b||g.col+g.colCount-1<c))return!0;for(f=0;f<j.length;f++)if(h=j[f],!(b<=h.cj&&c<=h.dj&&b+d>=h.cj+h.Xj&&c+e>=h.dj+h.OZ||h.cj>b+d||h.cj+h.Xj-1<b||h.cj>b+d-1||h.cj+h.Xj-1<b||h.dj+h.OZ-1<c))return!0;return!1},b.prototype.cIb=function(a,b,c,d,e){var f,g,h,i=a.ITa.getSpans(),j=a.tables.l$;for(f=0;f<i.length;f++)if(g=i[f],!(b<=g.row&&c<=g.col&&b+d>=g.row+g.rowCount&&c+e>=g.col+g.colCount||g.col>c+e||g.col+g.colCount-1<c||g.col>c+e-1||g.col+g.colCount-1<c||g.row+g.rowCount-1<b))return!0;for(f=0;f<j.length;f++)if(h=j[f],!(b<=h.cj&&c<=h.dj&&b+d>=h.cj+h.Xj&&c+e>=h.dj+h.OZ||h.dj>c+e||h.dj+h.OZ-1<c||h.dj>c+e-1||h.dj+h.OZ-1<c||h.cj+h.Xj-1<b))return!0;return!1},b.prototype.bIb=function(a,b,c,d,e){var f,g,h,i,j,k,l,m=a.ITa.getSpans(),n=a.tables.l$;for(f=b;f<b+d;f++)for(g=c;g<c+e;g++){if(h=a.getCell(f,g),!q(h.value())||h.backColor()||h.comment()||h.tag())return!0;for(i=0;i<m.length;i++)if(j=m[i],f>=j.row&&f<=j.row+j.rowCount-1&&g>=j.col&&g<=j.col+j.colCount-1)return!0;for(k=0;k<n.length;k++)if(l=n[k],f>=l.cj&&f<=l.cj+l.Xj-1&&g>=l.dj&&g<=l.dj+l.OZ-1)return!0}return!1},b.prototype.vTa=function(a,b){var c,d,e,f,g,h,i;return!a||(c=a.row,d=a.col,e=b.row,f=b.col,g=c===-1&&d!==-1,h=d===-1&&c!==-1,i=c===-1&&d===-1,c!==-1&&d!==-1||g&&e<=0||h&&f<=0||i&&e<=0&&f<=0)},b.prototype.undo=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y=this;if(y.canUndo()){if(a=y.VQ.fromSheet,b=y.VQ.toSheet,c=y.VQ.pasteExtent,d=c.sourceRange,e=c.targetRange,!b||!e)return!1;if(y.pgc&&(f=y.pgc,this.ogc(f.changePasteDataRangeCol,d,f.changePasteDataRangeRow,f.changePasteDataRangeCols,f.changePasteDataRangeRows,f.acColCount,f.acRowCount,f)),!b.pu(e.row,e.col,nb(e),ob(e),lb(b),mb(b)))return!1;if(a&&d){if(!a.pu(d.row,d.col,nb(d),ob(d),lb(a),mb(a)))return!1;if(a&&a.name()===b.name()&&b.parent&&!a.xUc&&!r(b.parent.sheets,a))return!1}g=y.VQ.io,tb(b);try{h=e.row<0?0:e.row,i=e.col<0?0:e.col,j=e.row<0?lb(b):nb(e),k=e.col<0?mb(b):ob(e),l=y.PLc(a,b),P._xb(l,y.VQ),m=b.rowFilter(),n=m&&m.range,n&&e.row===-1&&n.col<e.col&&n.col+n.colCount>=e.col+e.colCount&&(n.colCount=n.colCount-e.colCount),o=0,p=0,q=0,s=0,a&&d&&(o=d.row<0?0:d.row,p=d.col<0?0:d.col,q=d.row<0?lb(a):nb(d),s=d.col<0?mb(a):ob(d)),t=[],u=[],v=y.tableNamesObj,v&&(b&&v.r===h&&v.c===i&&v.rc===j&&v.cc===k&&(u=v.tableNames),a&&v.r===o&&v.c===p&&v.rc===q&&v.cc===s&&(t=v.tableNames)),b&&(w=g.dA,P.Bu(b,h,i,j,k,w?w.wy():[],3,t,!0)),a&&(x=g._z,P.Bu(a,o,p,q,s,x?x.wy():[],3,u,!0))}finally{ub(b)}}return!0},b.prototype.toJSON=function(){var a=this;return{sheetName:a.kj?a.kj.name():"",command:a.VQ}},b}(Ya),jb=function(a){kb(b,a);function b(b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.call(this,b,c)||this;if(!d){if(e=b,f=c.fromSheet,!e)throw Error(O().Exp_DestSheetIsNull);
if(g=c,h=g.pastedRanges,j=e.KLc(),h&&h.length>0)if(c.cachedActions=[],k=g.fromRanges||[g.fromRange],l=k.length,m=g.isCutting,n=g.clipboardText,o=g.clipboardHtml,p=g.clipboardImage,q=g.pasteOption,r={},s=h[0],!m&&f&&f.r5(k,r)&&s.equals(f.q5(k,s))){for(t=r.inSameRow,u=r.inSameCol,t?k.sort(function(a,b){return a.col-b.col}):u&&k.sort(function(a,b){return a.row-b.row}),v=s.row,w=s.col,x=0;x<l;x++)y=k[x],z=y.rowCount,A=y.colCount,j&&(z+=b.MLc(v,z,!0),A+=b.MLc(w,A)),B={sourceRange:y,targetRange:i.kf(v,w,z,A),isCutting:m,clipboardText:n,clipboardHtml:o,clipboardImage:p,includeFilteredOutRow:!0},c.cachedActions[x]=new ib(b,{fromSheet:f,toSheet:e,pasteExtent:B,pasteOption:q}),t?w+=A:u&&(v+=z);c.s5=!0}else for(C=0;C<h.length;C++)D={sourceRange:k[0],targetRange:h[C],isCutting:m,clipboardText:n,clipboardHtml:o,clipboardImage:p},c.cachedActions[C]=new ib(b,{fromSheet:f,toSheet:e,pasteExtent:D,pasteOption:q})}return E}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,j,k,l,m,n,o=this,p=o.VQ,q=p.cachedActions,r=!1;if(o.canExecute()&&q){a=o.kj,b=a.parent.WJc(),Zb(b,!0);try{for(c=!1,d=0;d<q.length;d++)e=q[d],e.WHb=p.WHb,e.XHb=p.XHb,e.YHb=p.YHb,a?(f=e.VQ.pasteExtent,g=o.VQ,h=g.fromSheet,j=g.fromRanges&&g.fromRanges[d],k=f.clipboardText,l=f.clipboardHtml,!k&&h&&j&&(k=h.Q6c([j])),!l&&h&&j&&qb(a)&&(l=h.R6c([j])),m={sheet:a,sheetName:a.name(),cellRange:e.VA(),pasteOption:e.VQ.pasteOption,pasteData:{text:k,html:l},shiftCells:p.WHb,fromSheet:h,fromRange:j,isCutting:!!g.isCutting,cancel:!1},n=f.clipboardImage,n&&(m.pasteData.image=n),a.Wq(i.Events.ClipboardPasting,m),m.cancel||(r=e.execute(),delete m.cancel,c=!0,a.Wq(i.Events.ClipboardPasted,m))):r=e.execute();c&&o.WA()}finally{$b(b,!0)}}return r},b.prototype.WA=function(){var a,b,c,d,e,f,g,h,i=this,j=i.VQ,k=j.cachedActions,l=i.kj;if(l&&k){if(a=l.getSelections(),b=[],c=l.parent,l.Tr(),j.s5)d=j.pastedRanges[0],l.j7c(d.row,d.col,nb(d),ob(d));else if(k.length>1)for(e=0;e<k.length;e++)f=k[e],g=f.VA(),l.j7c(g.row,g.col,nb(g),ob(g));else k.length>0&&(h=k[0].VA(),l.j7c(h.row,h.col,nb(h),ob(h)),h.contains(l.Jl,l.Kl)||l.Jr(h.row,h.col));b=l.getSelections(),l.yu(a,b)&&l.Au(a),c&&j.xC&&c.changeSelectionInCommandExecuting(j,null,null,b)}},b.prototype.canExecute=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canExecute())return!1;return!0}return!1},b.prototype.canUndo=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canUndo())return!1;return!0}return!1},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.VQ.cachedActions;if(e.canUndo()&&f){a=!0,b=e.kj.parent.WJc(),Zb(b,!0);try{for(c=f.length-1;c>=0;c--)d=f[c],a=a&&d.undo()}finally{$b(b,!0)}return a}return!1},b}(Ya)},"./dist/core/worksheet/worksheet-border.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/style.js"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/core.enum.js"),g=c("Common"),h=void 0,i=null,j=Math.sqrt,k=Math.pow,l=Math.min,m=Math.abs,n=Math.tan,o=Math.floor,p=Math.PI,q=e.GC$.inherit,r=e.GC$.isEmptyObject,s=g.Common.j.Fa,t={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},u={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},v=function(){function a(){}return a.prototype.mE=function(a){var b=this;0===a._orientation?(a.nE&&(b.oE+=a.nE),a.pE&&(b.qE+=a.pE)):(a.nE&&(b.rE+=a.nE),a.pE&&(b.sE+=a.pE))},a.prototype.jp=function(a){var b=this.tE||"#9eb6ce",c=this.uE,d=a.lineWidth,e=a.strokeStyle;d===c&&e===b||(d!==c&&(a.lineWidth=c),e!==b&&(a.strokeStyle=b)),this.hWa(a)},a.prototype.hWa=function(a){var b,c,d=this,e=d.qE===d.oE,f=d.sE===d.rE;e&&f||(e||f?(a.beginPath(),d.vE(a),a.stroke()):(a.save(),b=Math.min(d.qE,d.oE),c=Math.min(d.sE,d.rE),a.rect(b,c,Math.abs(d.oE-d.qE),Math.abs(d.rE-d.sE)),a.clip(),a.beginPath(),d.vE(a),a.stroke(),a.beginPath(),a.restore()))},a.prototype.vE=function(a){var b=this;a.moveTo(b.qE,b.sE),a.lineTo(b.oE,b.rE)},a}(),w=function(a){D(b,a);function b(b,c,d,e,f,g,h){var i,j=a.call(this)||this,k=g%2;return k||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5)),i=j,i.qE=b,i.sE=c,i.oE=d,i.rE=e,i.tE=f,i.uE=g,i.gIb=h,j}return b}(v),x=function(a){D(b,a);function b(b,c,d,e,f,g,h,i){var j,k=a.call(this)||this,l=g%2;return l||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5)),j=k,j.qE=b,j.sE=c,j.oE=d,j.rE=e,j.tE=f,j.uE=g,j.wE=h,j.gIb=i,k}return b.prototype.vE=function(a){var c=this;b.yl(a,c.qE,c.sE,c.oE,c.rE,c.wE)},b.yl=function(a,b,c,d,e,f){var g,h,i=j(k(d-b,2)+k(e-c,2)),m={x:(d-b)/i,y:(e-c)/i},n=0,o=0;for(f=f&&f.length?f:[4,4];n<i;)g=l(f[o%f.length],i-n),o++,h=o%2,n+=g,h&&a.moveTo(b,c),b+=g*m.x,c+=g*m.y,h&&a.lineTo(b,c)},b}(v),y=function(a){D(b,a);function b(b,c,d,e,f,g,h,i,j){var k,l=a.call(this)||this;return g?(b-=1,d-=1):(c-=1,e-=1),k=l,k.qE=b,k.sE=c,k.oE=d,k.rE=e,k.tE=f,k.xE=g,k.uE=1,k.yE=h,k.zE=i,k.gIb=j,l}return b.prototype.vE=function(a){var b=this,c=b.xE?0:1,d=b.xE?1:0;x.yl(a,b.qE-c,b.sE-d,b.oE-c,b.rE-d,b.yE),x.yl(a,b.qE,b.sE,b.oE,b.rE,b.zE)},b}(v),z=function(a){D(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this)||this,j=i;return j.qE=b,j.sE=c,j.oE=d,j.rE=e,j.tE=f,j.iWa=g,j.gIb=h,j.AE=new w(j.qE,j.sE,j.oE,j.rE,f,1,h),j.BE=null,i}return b.prototype.hWa=function(a){this.AE&&this.AE.hWa(a),this.BE&&this.BE.hWa(a)},b.prototype.mE=function(a){var b=this;b.BE?(a.pE&&b.AE&&b.AE.mE(a),a.nE&&b.BE.mE(a)):b.AE&&b.AE.mE(a)},b.prototype.jWa=function(a){var b,c,d,e,f,g,h,i,j=this;a&&a.severX&&a.severY?(b=a.severX||0,c=a.severY||0,b=j.iWa?b:-b,d=parseInt(j.qE+(j.oE-j.qE)/2,10),e=parseInt(j.sE+(j.rE-j.sE)/2,10),f=d-b,g=e-c,h=d+b,i=e+c,j.AE=new w(j.qE,j.sE,f,g,j.tE,1,j.gIb),j.BE=new w(h,i,j.oE,j.rE,j.tE,1,j.gIb)):(j.AE=new w(j.qE,j.sE,j.oE,j.rE,j.tE,1,j.gIb),j.BE=null)},b}(v),A=function(a){D(b,a);function b(b,c,d,e,f,g){var h=a.call(this)||this,i=h,j=0,k=0;return b===d&&(j=1),c===e&&(k=1),b!==d&&c!==e?g?(j=2,i.AE=new w(b-j,c,d-j,e,f,1,g),i.BE=new w(b+j,c,d+j,e,f,1,g)):(j=2,k=2,b>d?(i.AE=new z(b-j,c,d,e-k,f,(!1),g),i.BE=new z(b,c+k,d+j,e,f,(!1),g)):(i.AE=new z(b,c+k,d-j,e,f,(!0),g),i.BE=new z(b+j,c,d,e-k,f,(!0),g))):(i.AE=new w(b-j,c-k,d-j,e-k,f,1,g),i.BE=new w(b+j,c+k,d+j,e+k,f,1,g)),i.gIb=g,i.tE=f,i.uE=1,h}return b.prototype.hWa=function(a){this.AE.hWa(a),this.BE.hWa(a)},b.prototype.mE=function(a){var b=this;a.CE?1===a.CE?b.AE.mE(a):2===a.CE&&b.BE.mE(a):(b.AE.mE(a),b.BE.mE(a))},b.prototype.jWa=function(){var a=this,b={severX:1,severY:1},c=a.AE,d=a.BE;c.jWa(b),d.jWa(b)},b}(v);function E(a,b,c,d,e,f,g){switch(f!==h&&f!==i||(f=1),f){case 1:return new w(a,b,c,d,e,1,g);case 2:return new w(a,b,c,d,e,2,g);case 5:return new w(a,b,c,d,e,3,g);case 3:return new x(a,b,c,d,e,1,[3,1],g);case 9:return new x(a,b,c,d,e,1,[8,2,2,2],g);case 4:return new x(a,b,c,d,e,1,[2,2],g);case 11:return new x(a,b,c,d,e,1,[9,3,3,3,3,3],g);case 13:return new y(a,b,c,d,e,a!==c,[11,1,5,1],[10,2,4,2],g);case 10:return new x(a,b,c,d,e,2,[9,3,3,3],g);case 12:return new x(a,b,c,d,e,2,[9,3,3,3,3,3],g);case 8:return new x(a,b,c,d,e,2,[9,3],g);case 7:return new x(a,b,c,d,e,1,[1],g);case 6:return new A(a,b,c,d,e,g)}return i}b.zF=E,B=function(){function a(){}return a.DE=function(b,c,d){var e,f;return b?c?(e=a.EE,f=e[b.style]-e[c.style],0!==f||d?f:(c.level||0)-(b.level||0)):1:c?-1:0},a.FE=function(a){if(a){if(a.isGridLine)return 1;if(a.style)return d.LineBorder.Vo(a.style)}return 0},a.GE=function(a){return a&&6===a.style},a.HE=function(a){return a&&13===a.style},a.IE=function(b,c){return b?c?a.DE(b.style,c.style)>=0?b:c:b:c},a.JE=function(a,b){a&&a.line?a.line.mE(b):a.mE&&a.mE(b)},a.KE=function(b,c,d){return b===c?0:b?c?b.isGridLine?c.isGridLine?0:-1:c.isGridLine?1:a.DE(b.style,c.style,d):1:-1},a.LE=function(a){return a&&a.style&&6===a.style.style},a.ME=function(a,b,c,d){if(a.style&&6===a.style.style)return!0;var e=0;return e+=b&&b.style&&6===b.style.style?1:0,e+=c&&c.style&&6===c.style.style?1:0,e+=d&&d.style&&6===d.style.style?1:0,e<2},a.NE=function(a,b,c,d,e,f){var g={_orientation:f?1:0,pE:0,nE:0},h=this.KE(a,c),i=this.KE(a,d);h>=0&&i>=0?0===h&&0===i?e!==-1&&1===e&&(g.nE-=e):e===-1?g.pE-=e:1===e&&(g.nE-=2*e):i>=0?(g.CE=2,g.pE+=e):h>=0&&(g.CE=1,g.pE+=e),this.JE(a,g)},a.OE=function(b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t={_orientation:i?1:0,CE:j?2:1,pE:0,nE:0},u={_orientation:i?1:0,CE:j?1:2,pE:0,nE:0},v=1===g?e:f,w=1===h?d:c,x=this.LE(w);x?(k=this.KE(b,v),0===k?(l=this.KE(b,w),0===l?1===h&&(u.nE-=h):l>0&&(h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h))):k>0?(m=this.KE(b,w),0===m?1===h&&(u.nE-=h):m>0&&(h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h))):(n=this.KE(b,w),0===n?h===-1?t.pE+=2*h:1===h&&(t.nE+=2*h):n>0&&(h===-1?t.pE-=3*h:1===h&&(t.nE-=3*h)))):this.KE(b,v)>=0?h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h):h===-1?t.pE+=2*h:1===h&&(t.nE+=2*h),o=1===g?2:1,p=1===o?e:f,q=!1,r=0,this.LE(p)&&this.KE(p,b)>0&&(q=!0,s=a.FE(p),this.KE(p,v)>0?s>0&&(r=1===h&&this.LE(d)?s>=2?2:1:h===-1&&this.LE(c)?s>=3?2:1:3===s?3:2):r=3===s?3:2),q||this.LE(w)||!(w&&!w.isGridLine||p&&!p.isGridLine)||(q=!0,r=h===-1?2:1),q&&(h===-1?(t.pE+=h*r,u.pE+=h*r):1===h&&(t.nE+=h*r,u.nE+=h*r)),(t.pE||t.nE)&&this.JE(b,t),(u.pE||u.nE)&&this.JE(b,u)},a.PE=function(a,b,c,d,e,f){if(this.KE(a,c)>=0&&this.KE(a,d)>=0){var g={_orientation:f?1:0,pE:0,nE:0};e===-1?(g.pE-=2*e,this.LE(a)&&this.KE(b,a)>0&&(g.pE-=1)):1===e&&(g.nE-=2*e,this.LE(a)&&this.KE(b,a)>0&&(g.nE+=1)),this.JE(a,g)}},a.QE=function(b,c,d,e,f,g){var h,i,j;this.LE(b)&&(h=this.IE(d,e),h&&!h.isGridLine&&(i=a.FE(h),i>0&&(j={_orientation:g?1:0,pE:0,nE:0},f===-1?j.pE+=i*f:j.nE+=i*f,(j.pE||j.nE)&&this.JE(b,j))))},a.RE=function(b,c,d,e,f,g,h){var i,j,k,l,m=a;(c||d||e)&&(k=m.IE(d,e),m.ME(b,c,d,e)?(j=m.KE(k,b,!0))>0?(i=m.FE(k),m.LE(b)&&(m.LE(d)||m.LE(e)||m.LE(c))||3===i&&m.JE(b,{_orientation:0,pE:1})):k&&j<0?(j=m.KE(b,c,!0))>0?(i=m.FE(k),3===i||2===i?m.JE(b,{_orientation:0,pE:-2}):1===i&&m.JE(b,{_orientation:0,pE:-1})):0!==j&&m.KE(c,k,!0)>0&&(i=m.FE(k),3===i&&m.JE(b,{_orientation:0,pE:1})):0===j&&(!c||m.KE(b,c,!0)>0)&&(i=m.FE(k),3===i||2===i?m.JE(b,{_orientation:0,pE:-2}):1===i&&m.JE(b,{_orientation:0,pE:-1})):m.JE(b,{_orientation:0,pE:1})),(f||g||h)&&(l=m.IE(g,h),m.ME(b,f,g,h)?(j=m.KE(l,b,!0))>0?(i=m.FE(l),m.LE(b)&&(m.LE(g)||m.LE(h)||m.LE(f))||(3===i?m.JE(b,{_orientation:0,nE:-2}):2!==i&&1!==i||m.JE(b,{_orientation:0,nE:-1}))):j<=0&&((j=m.KE(b,f,!0))>0?(i=m.FE(l),3===i&&m.JE(b,{_orientation:0,nE:1})):0!==j&&m.JE(b,{_orientation:0,nE:-1})):m.JE(b,{_orientation:0,nE:-2}))},a.SE=function(b,c,d,e,f,g,h){var j,k,l,m,n=a;(c||d||e)&&(l=n.IE(d,e),k=n.KE(l,b,!0),n.ME(b,c,d,e)?k>0?(j=n.FE(l),n.LE(b)&&(n.LE(d)||n.LE(e)||n.LE(c))||3===j&&n.JE(b,{_orientation:1,pE:1})):k<0?(k=n.KE(b,c,!0),k>0?(j=n.FE(l),3===j||2===j?n.JE(b,{_orientation:1,pE:-2}):1===j&&n.JE(b,{_orientation:1,pE:-1})):0!==k&&n.KE(c,l,!0)>0&&(j=n.FE(l),3===j&&n.JE(b,{_orientation:1,pE:1}))):0===k&&n.KE(b,c,!0)>0&&(j=n.FE(l),3===j||2===j?n.JE(b,{_orientation:1,pE:-2}):1===j&&n.JE(b,{_orientation:1,pE:-1})):n.JE(b,{_orientation:1,pE:1})),(f||g||h)&&(m=n.IE(g,h),k=n.KE(b,m,!0),n.ME(b,f,g,h)?k<0?(j=n.FE(m),n.LE(b)&&(n.LE(g)||n.LE(h)||n.LE(f))||(3===j||2===j?n.JE(b,{_orientation:1,nE:-2}):1===j&&n.JE(b,{_orientation:1,nE:-1}))):m!==i&&k>=0&&(k=n.KE(b,f,!0),k>0?(j=n.FE(m),3===j&&n.JE(b,{_orientation:1,nE:1})):0!==k&&n.JE(b,{_orientation:1,nE:-1})):n.JE(b,{_orientation:1,nE:-2}))},a.TE=function(b,c,d,e,f,g,h,i){var j,k,l,m,n=a;i?this.SE(b,c,d,e,f,g,h):this.RE(b,c,d,e,f,g,h),j=n.LE(d),k=n.LE(e),l=n.LE(c),j&&k&&l?n.NE(b,c,d,e,-1,i):j&&!k?n.OE(b,c,f,d,e,1,-1,i,!0):!j&&k?n.OE(b,c,f,d,e,2,-1,i,!1):j&&k&&!l?n.PE(b,c,d,e,-1,i):l&&n.QE(b,c,d,e,-1,i),j=n.LE(g),k=n.LE(h),m=n.LE(f),j&&k&&m?n.NE(b,f,g,h,1,i):j&&!k?n.OE(b,c,f,g,h,1,1,i,!0):!j&&k?n.OE(b,c,f,g,h,2,1,i,!1):j&&k&&!m?n.PE(b,f,g,h,1,i):m&&n.QE(b,f,g,h,1,i)},a.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],a.kWa=function(a,b){return!(!a||!b||a.color!==b.color||a.level!==b.level||a.style!==b.style)},a}(),C=function(){function a(a,b,c,d){var e=this;e.UE=!1,e.VE=!1,e.kj=a,e.Wz=d,e.hIb=b,e.pJ=c}return a.prototype.YE=function(){var a,b,c,d,e,f,g,h,i,j,k=this;if(k.ZE=[],k.$E=[],k._E=[],k.aF=[],k.bF=[],k.cF={},k.dF={},k.eF={},k.fF={},k.lWa={},k.mWa={},k.C$a={},a=k.hIb,b=k.pJ,a&&a.length>0&&b&&b.length>0){for(c=k.$E,d=a.length,e=void 0,f=0;f<d;f++)e=a[f],e.height>0&&c.push(e.row);for(c.push(c[c.length-1]+1),g=k._E,h=b.length,i=void 0,j=0;j<h;j++)i=b[j],i.width>0&&g.push(i.col);g.push(g[g.length-1]+1)}k.UE=!0},a.prototype.gF=function(a,b,c,d,e,f,g,h){if(c){var i={cj:a,dj:b,hF:c.startColumn,iF:c.endColumn,Wqa:d,XHa:e,YHa:f,Vo:g,_v:h};this.aF.push(i)}},a.prototype.jF=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t,u,v=this;v.UE||v.YE(),h?v.ZE.push(h):(l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,g&&(l=g.borderLeft,m=g.borderTop,n=g.borderRight,o=g.borderBottom,u=g.backColor,k&&2===k.columnHeaderFitMode||(p=g.diagonalDown,q=g.diagonalUp),r=g.textOrientation,s=g.isVerticalText,t=g.textIndent),!u||l||n||m||o||v.bF.push({r:a,c:b,rc:1,cc:1}),v.kF(a,b,c,d,e,f,l,m,n,o,p,q,u,!1,!1,i,j,r,s,t&&0!==t,k))},a.prototype.kF=function(a,b,c,d,e,g,i,j,k,l,o,q,r,t,u,v,w,x,y,z,A){var B,C,D,E,F,G,H,I,J,K,L,M=this,N=!1,O=!1,P=!1,Q=!1,R=x!==h&&x&&-90<=x&&x<=90,S=c,T=i||j||k||l;R&&T&&!y&&!z&&A&&A.data&&(B=m(x*p/180),C=n(B),D=Math.floor(g/C),x>-90&&x<0&&(S=c-D),x>0&&x<90&&(S=c+D)),o&&!R&&M.lF(a,b,c-1,d-1,c+e,d+g,o,M.lWa),q&&!R&&M.lF(a,b,c+e,d-1,c-1,d+g,q,M.mWa),j&&g>0&&(N=M.lF(a,b,S,d-.5,S+e,d-.5,j,M.eF,R)),i&&e>0&&(O=M.lF(a,b,S-.5,d,c-.5,d+g,i,M.fF,R)),k&&e>0&&(A&&A.columnHeaderFitMode===f.ColumnHeaderFitMode.stack&&!s(A.cornerX)?(E=A.cornerX,F=A.cornerY,G=F-d,M.lF(a,b+1,S+e-.5,d,c+e-.5,d+G,k,M.fF,R,{isMultiLine:!0,multiLinePart:"topVertical"}),M.lF(a,b+1,E,d+G-.5,c+e-.5,d+G-.5,k,M.eF,R,{isMultiLine:!0,multiLinePart:"horizontal"}),Q=M.lF(a,b+1,E-.5,F,E-.5,d+g,k,M.fF,R,{isMultiLine:!0,multiLinePart:"bottomVertical"})):Q=M.lF(a,b+1,S+e-.5,d,c+e-.5,d+g,k,M.fF,R)),l&&g>0&&(A&&A.columnHeaderFitMode===f.ColumnHeaderFitMode.stack&&!s(A.cornerX)?(E=A.cornerX,P=M.lF(a+1,b,c,d+g-.5,E,d+g-.5,l,M.eF,R)):P=M.lF(a+1,b,c,d+g-.5,c+e,d+g-.5,l,M.eF,R)),H=M.kj,r&&0!==H.ss.Sl(a)&&0!==H.ss._m(b)||(I=!P&&!t,J=!Q&&!u,K=!N&&!t,L=!O&&!u,(I||J||K||L)&&M.mF(a,b,c,d,e,g,I,J,v,w)),!N&&!r||R||M.nF(a-1,b,M.cF),(O||r)&&M.nF(a,b-1,M.dF),!r||i||k||j||l||(M.oF(a-1,b-1,M.dF,!1),M.oF(a-1,b-1,M.cF,!0))},a.prototype.lF=function(a,b,c,d,e,f,g,h,j,k){var l,m,n,o,p;return!!g&&(l=void 0,m=void 0,k&&(l=k.isMultiLine,m=k.multiLinePart),n=this.pF(a,b,h,!0),n?l?(o=E(c,d,e,f,g.color,g.style,j),o.multiLinePart=m,n.splitLines||(n.splitLines=[]),"horizontal"===m&&(n.line=o),n.splitLines.push(o)):j||6!==n.style.style&&(6===g.style||B.DE(g,n.style)>0)?(n.line=E(c,d,e,f,g.color,g.style,j),n.style=g):n.line&&!n.splitLines&&f-d!==n.line.rE-n.line.sE&&(n.line.rE=f,n.line.sE=d):(p=E(c,d,e,f,g.color,g.style,j),p&&(n=this.pF(a,b,h),n.line=p,n.style=g,l&&(n.line.multiLinePart=m,n.splitLines=[n.line]))),n&&n.line!==i)},a.prototype.mF=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p=this,q=3===p.Wz,r=p.kj.options.gridline;q&&r&&(k=r.color,r.showHorizontalGridline&&(g&&(l=p.pF(a,b,p.cF),l.isGridLine=!0,l.line=E(c,d+f-.5,c+e,d+f-.5,k)),i&&(m=p.pF(-1,b,p.cF,!1,!0),m.isGridLine=!0,m.line=E(c,d-.5,c+e,d-.5,k))),r.showVerticalGridline&&(h&&(n=p.pF(a,b,p.dF),n.isGridLine=!0,n.line=E(c+e-.5,d,c+e-.5,d+f,k)),j&&(o=p.pF(a,-1,p.dF,!1,!0),o.isGridLine=!0,o.line=E(c-.5,d,c-.5,d+f,k))))},a.prototype.oF=function(a,b,c,d){var e,f=this.pF(a,b,c,!0);f&&(e=f,e.line&&e.line.mE({_orientation:d?0:1,nE:-1}))},a.prototype.nF=function(a,b,c){var d,e;(a>=0&&b>=0||0===a&&b===-1||a===-1&&0===b)&&(d=c[a],d&&(e=d[b],e&&delete d[b]))},a.prototype.pF=function(a,b,c,d,e){var f,g;if(!e&&(a===-1||b===-1))return i;if(f=c[a],!f){if(d)return i;c[a]=f={}}if(g=f[b],!g){if(d)return i;f[b]=g={}}return g},a.prototype.qF=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this,D=C.aF,F=D.length,G=C.fF,H=C.eF,I=C.dF,J=C.cF;for(a=0;a<F;a++)if(b=D[a],c=b.cj,d=b.dj,e=b.hF,f=b.Wqa,g=b.iF,h=void 0,i=b.XHa,j=b.Vo,k=b._v,l=i,m=void 0,n=f.textOrientation,o=f.borderTop,p=D[a-1],!p||p.cj!==c||p.hF!==e||p.iF!==g){for(q=e;q<g;q++)h=C.pF(c,q+1,G,!0),h&&!n?C.nF(c,q+1,G):(h=C.pF(c,q,I,!0),h&&C.nF(c,q,I));if(r=C.pF(c,d,H,!0),n&&o&&!r)for(s=void 0,s=k/Math.tan(Math.abs(n*Math.PI/180)),n>-90&&n<0&&(l=i-s),n>0&&n<90&&(l=i+s),m=l+j,t=e;t<g+1;t++)if(u=C.pF(c-1,t,J,!0),v=u&&u.line)for(u.splitLines||(u.splitLines=[],u.splitLines.push(v)),w=0;w<u.splitLines.length;w++)if(x=u.splitLines[w],y=x.qE,z=x.oE,A=x.sE,B=x.rE,l>y&&m>z&&z>l)x.oE=l;else if(l<y&&m>z)C.nF(c-1,t,C.cF);else if(l<y&&m<z&&y<m)x.qE=m;else if(l>y&&m<z){u.splitLines.splice(w,1,E(y,A,l,A,x.color),E(m,B,z,B,x.color));break}}},a.prototype.rF=function(){var a,b,c=this.ZE,d=c.length;if(d>0)for(b=0;b<d;b++)a=c[b],this.sF(a)},a.prototype.D$a=function(){var a,b,c,d,e,f,g,h;if(this.C$a={},a=this.ZE,b=a.length,b>0)for(d=0;d<b;d++)for(c=a[d],e=0;e<c.rowCount;e++)for(f=e+c.row,this.C$a[f]=this.C$a[f]||{},g=0;g<c.colCount;g++)h=g+c.col,this.C$a[f][h]=c},a.prototype.sF=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s=this,t=a.row,u=a.col,v=a.x,w=a.y,x=a.spanSizeInfo,y=x.styleList[0][0],z=y?y.backColor:i,A=v,C=w,D=null,E=!0,F=null,G=!0;if(1===a.rowCount){for(g=t,j=x.rowSizes[0],f=0;f<a.colCount;f++)l=0===f,n=f===a.colCount-1,h=u+f,k=x.colSizes[f],p=x.styleList[0][f],g===a.row&&h===a.col&&(q=p,D=q&&q.diagonalDown,F=q&&q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,E&&(E=B.kWa(D,p.diagonalDown)),G&&(G=B.kWa(F,p.diagonalUp))):b=c=d=e=i,l?s.kF(g,h,A,C,k,j,b,c,i,e,i,i,z,!1,!0):n?s.kF(g,h,A,C,k,j,i,c,d,e,i,i,z,!1,!1):s.kF(g,h,A,C,k,j,i,c,i,e,i,i,z,!1,!0),A+=k;D=E?D:null,F=G?F:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,i,i,i,i,D,F,i,!0,!0)}else if(1===a.colCount){for(h=u,k=x.colSizes[0],f=0;f<a.rowCount;f++)m=0===f,o=f===a.rowCount-1,g=t+f,j=x.rowSizes[f],p=x.styleList[f][0],g===a.row&&h===a.col&&(q=p,D=q&&q.diagonalDown,F=q&&q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,E&&(E=B.kWa(D,p.diagonalDown)),G&&(G=B.kWa(F,p.diagonalUp))):b=c=d=e=i,m?s.kF(g,h,A,C,k,j,b,c,d,i,i,i,z,!0,!1):o?s.kF(g,h,A,C,k,j,b,i,d,e,i,i,z,!1,!1):s.kF(g,h,A,C,k,j,b,i,d,i,i,i,z,!0,!1),C+=j;D=E?D:null,F=G?F:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,i,i,i,i,D,F,i,!0,!0)}else{for(f=0;f<a.rowCount;f++){for(g=t+f,m=0===f,o=f===a.rowCount-1,j=x.rowSizes[f],r=0;r<a.colCount;r++)h=u+r,l=0===r,n=r===a.colCount-1,k=x.colSizes[r],p=x.styleList[f][r],g===a.row&&h===a.col&&(q=p,D=q&&q.diagonalDown,F=q&&q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,E&&(E=B.kWa(D,p.diagonalDown)),G&&(G=B.kWa(F,p.diagonalUp))):b=c=d=e=i,m?l?s.kF(g,h,A,C,k,j,b,c,i,i,i,i,z,!0,!0):n?s.kF(g,h,A,C,k,j,i,c,d,i,i,i,z,!0,!1):s.kF(g,h,A,C,k,j,i,c,i,i,i,i,z,!0,!0):o?l?s.kF(g,h,A,C,k,j,b,i,i,e,i,i,z,!1,!0):n?s.kF(g,h,A,C,k,j,i,i,d,e,i,i,z,!1,!1):s.kF(g,h,A,C,k,j,i,i,i,e,i,i,z,!1,!0):l?s.kF(g,h,A,C,k,j,b,i,i,i,i,i,z,!0,!0):n&&s.kF(g,h,A,C,k,j,i,i,d,i,i,i,z,!0,!1),A+=k;A=v,C+=j}D=E?D:null,F=G?F:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,i,i,i,i,D,F,i,!0,!0)}!z||b||d||c||e||s.bF.push({r:t,c:u,rc:a.rowCount,cc:a.colCount})},a.prototype.mE=function(){var a=this,b=!1,c=!1,d=!1,e=!1;r(a.fF)||(b=!0),r(a.eF)||(c=!0),(b||c)&&(a.tF(),a.tWa()),r(a.lWa)||(d=!0),r(a.mWa)||(e=!0),(d||e)&&a.oWa(),a.bF.length>0&&a.uF()},a.prototype.E$a=function(a,b,c,d,e){var f=this,g=this.C$a[a]?this.C$a[a][b]:null;if(g)switch(e){case u.H_TOP_LEFT:return f.vF(a,b,c,d);case u.H_TOP_Right:return f.vF(a,b+g.colCount-1,c,d);case u.V_RIGHT_TOP:return f.vF(a,b+g.colCount-1,c,d);case u.V_RIGHT_BOTTOM:return f.vF(a+g.rowCount-1,b+g.colCount-1,c,d);case u.H_BOTTOM_RIGHT:return f.vF(a+g.rowCount-1,b+g.colCount-1,c,d);case u.H_BOTTOM_LEFT:return f.vF(a+g.rowCount-1,b,c,d);case u.V_LEFT_BOTTOM:return f.vF(a+g.rowCount-1,b,c,d);case u.V_LEFT_TOP:return f.vF(a,b,c,d)}return f.vF(a,b,c,d)},a.prototype.oWa=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.$E,r=p._E,s=q.length,t=r.length,v={},w={};for(a=0;a<s;a++)for(c=q[a],b=0;b<t;b++)d=r[b],m=p.pF(c,d,p.lWa,!1),n=p.pF(c,d,p.mWa,!1),(m||n)&&(B.LE(m)&&B.LE(n)&&(m.line.jWa(),n.line.jWa()),o=[],e=p.E$a(c,d,!1,v,u.H_TOP_LEFT),e&&e.line&&!e.isGridLine&&(o=[1,1,2],p.pWa(o,e,m,!0,1)),i=p.E$a(c,d,!1,v,u.H_TOP_Right),i&&i.line&&!i.isGridLine&&(o=[1,1,2],p.pWa(o,i,n,!0,1)),f=p.E$a(c,d,!0,w,u.V_LEFT_TOP),f&&f.line&&!f.isGridLine&&(o=[1,1,2],p.pWa(o,f,m,!0,0)),j=p.E$a(c,d,!0,w,u.V_LEFT_BOTTOM),j&&j.line&&!j.isGridLine&&(o=[1,1,2],p.pWa(o,j,n,!1,0)),g=p.E$a(c+1,d,!1,v,u.H_BOTTOM_LEFT),g&&g.line&&!g.isGridLine&&(o=[-1,-2,-2],p.pWa(o,g,n,!1,1)),k=p.E$a(c+1,d,!1,v,u.H_BOTTOM_RIGHT),k&&k.line&&!k.isGridLine&&(o=[-1,-2,-2],p.pWa(o,k,m,!1,1)),h=p.E$a(c,d+1,!0,w,u.V_RIGHT_TOP),h&&h.line&&!h.isGridLine&&(o=[-1,-2,-2],p.pWa(o,h,n,!0,0)),l=p.E$a(c,d+1,!0,w,u.V_RIGHT_BOTTOM),l&&l.line&&!l.isGridLine&&(o=[-1,-2,-2],p.pWa(o,l,m,!1,0)))},a.prototype.pWa=function(a,b,c,d,e){var f,g,h=B.LE(b),i=B.HE(b),j=b.line.uE;h&&(j=3),i&&(j=2),f=a[j-1],c&&c.line&&(g={_orientation:e},d?g.pE=f:g.nE=f,c.line.mE(g))},a.prototype.uF=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this,n=m.bF,o=n.length;for(a=0;a<o;a++){for(b=n[a],c=b.r,d=b.c,e=c,f=c-1,g=d-1,h=d,b.rc>1&&(e+=b.rc-1),b.cc>1&&(h+=b.cc-1),i=!1,j=!1,k=a+1;k<o&&(l=n[k],l.c===h+1&&l.r===c&&(j=!0),l.r===e+1&&l.c===d&&(i=!0),!i||!j)&&!(l.r>c+1&&l.c>d+1);k++);i||m.oF(e,g,m.cF,!0),j||m.oF(f,h,m.dF,!1)}},a.prototype.tF=function(){var a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this,C=A.kj,D=C.ITa,E=A.$E,F=A._E,G=E.length,H=F.length,I={},J={};for(a=0;a<G;a++)for(c=E[a],b=0;b<H;b++){if(d=F[b],p=0,q=0,r=A.pF(c,d,A.fF,!0)){if(r.line&&r.line.gIb)continue;p++}else r=A.pF(c,d-1,A.dF,!0);if(s=A.pF(c,d,A.eF,!0),s?q++:s=A.pF(c-1,d,A.cF,!0),r||s){if(e=0===a?i:A.vF(E[a-1],d,!0,J),e&&e.line&&!e.isGridLine&&(p++,q++),f=0===b?i:A.vF(c,F[b-1],!1,I),f&&f.line&&!f.isGridLine&&(p++,q++),r)for(t=[r],r.splitLines&&r.splitLines.length>0&&(t=r.splitLines),u=0;u<t.length;u++)v=t[u],v.style=r.style,g=A.vF(c,d,!1,I),g&&g.line&&!g.isGridLine&&p++,a!==G-1&&(j=A.vF(E[a+1],d,!0,J),j&&j.line&&!j.isGridLine&&p++),0!==b&&a!==G-1&&(k=A.vF(E[a+1],F[b-1],!1,I),k&&k.line&&!k.isGridLine&&p++),a!==G-1&&(l=A.vF(E[a+1],d,!1,I),l&&l.line&&!l.isGridLine&&p++),p>0&&("topVertical"===v.multiLinePart?(w=D.AYc(d,0),x=C.br(w),2===C.sYc(x)&&(w=C.Zq(w)),y=C.Zq(d),g=A.vF(c,w,!1,I),j=A.vF(c,y,!0,J),k=v,l=i):"bottomVertical"===v.multiLinePart&&(e=i,f=i,g=v,j=i,k=A.vF(E[a+1],F[b-1],!1,I),l=A.vF(E[a+1],F[b],!1,I)),B.GE(r.style)?B.TE(v,e,f,g,j,k,l,!0):B.HE(r.style)||B.SE(v,e,f,g,j,k,l));s&&(h=A.vF(c,d,!0,J),h&&h.line&&!h.isGridLine&&q++,b!==H-1&&(z=F[b+1],2===C.sYc(z)&&(z=D.AYc(z,0),z=C.Zq(z)),m=A.vF(c,z,!1,I),m&&m.line&&!m.isGridLine&&q++),0!==a&&b!==H-1&&(n=A.vF(E[a-1],F[b+1],!0,J),n&&n.line&&!n.isGridLine&&q++),b!==H-1&&(o=A.vF(c,F[b+1],!0,J),o&&o.line&&!o.isGridLine&&q++),q>0&&(s.line&&"horizontal"===s.line.multiLinePart&&(w=D.AYc(d,0),x=C.br(w),2===C.sYc(x)&&(w=C.Zq(w)),f=i,e=i,h=s,m=i,n=s,o=A.vF(c,w,!0,J)),B.GE(s.style)?B.TE(s,f,e,h,m,n,o,!1):B.HE(s.style)||B.RE(s,f,e,h,m,n,o)))}}},a.prototype.F$a=function(a,b,c,d){var e=this,f=this.C$a[a]?this.C$a[a][b]:null,g=c?e.mWa:e.lWa;return f?a===f.row&&b===f.col&&d===t.LEFT_TOP?e.pF(f.row,f.col,g,!1):a===f.row&&b===f.col+f.colCount-1&&d===t.RIGHT_TOP?e.pF(f.row,f.col,g,!1):a===f.row+f.rowCount-1&&b===f.col+f.colCount-1&&d===t.RIGHT_BOTTOM?e.pF(f.row,f.col,g,!1):a===f.row+f.rowCount-1&&b===f.col&&d===t.LEFT_BOTTOM?e.pF(f.row,f.col,g,!1):void 0:e.pF(a,b,g,!1)},a.prototype.tWa=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.$E,r=p._E,s=q.length,u=r.length;for(a=0;a<s;a++)for(c=q[a],b=0;b<u;b++)d=r[b],n=p.pF(c,d,p.fF,!0),n&&n.line&&n.line._noNeedAdjust||(n&&n.line&&B.LE(n)&&(e=p.F$a(c,d,!1,t.LEFT_TOP),f=p.F$a(c,d,!0,t.LEFT_BOTTOM),g=B.LE(e),h=B.LE(f),i=p.F$a(c,d-1,!1,t.RIGHT_BOTTOM),j=p.F$a(c,d-1,!0,t.RIGHT_TOP),k=B.LE(i),l=B.LE(j),e&&g&&(m={CE:2,_orientation:1,pE:2},n.line.mE(m)),f&&h&&(m={CE:2,_orientation:1,nE:-2},n.line.mE(m)),i&&k&&(m={CE:1,_orientation:1,nE:-2},n.line.mE(m)),j&&l&&(m={CE:1,_orientation:1,pE:2},n.line.mE(m))),o=p.pF(c,d,p.eF,!0),o&&o.line&&B.LE(o)&&(e=p.F$a(c,d,!1,t.LEFT_TOP),f=p.F$a(c,d,!0,t.RIGHT_TOP),g=B.LE(e),h=B.LE(f),i=p.F$a(c-1,d,!1,t.RIGHT_BOTTOM),j=p.F$a(c-1,d,!0,t.LEFT_BOTTOM),k=B.LE(i),l=B.LE(j),e&&g&&(m={CE:2,_orientation:0,pE:2},o.line.mE(m)),f&&h&&(m={CE:2,_orientation:0,nE:-2},o.line.mE(m)),i&&k&&(m={CE:1,_orientation:0,nE:-2},o.line.mE(m)),j&&l&&(m={CE:1,_orientation:0,pE:2},o.line.mE(m))))},a.prototype.vF=function(a,b,c,d){var e,f=d[a];return f||(f=d[a]={}),e=f[b],e===h&&(e=f[b]=this.wF(a,b,c)),e},a.prototype.wF=function(a,b,c){var d,e,f;if(a===h||a<0||b===h||b<0)return i;if(d=this,e=c?d.fF:d.eF,f=d.pF(a,b,e,!0),f)return f;if(e=c?d.dF:d.cF,c){if(--b,b<0)return i}else if(--a,a<0)return i;return f=d.pF(a,b,e,!0),f?f:i},a.prototype.paint=function(a){var b=this;b.UE&&(b.VE||(b.D$a(),b.rF(),b.qF(),b.mE(),b.VE=!0),a.save(),b.jp(a),a.restore())},a.prototype.jp=function(a){this.xF(a),this.yF(a)},a.prototype.xF=function(a){var b=this;b._d(a,b.cF),b._d(a,b.dF)},a.prototype.yF=function(a){var b=this;b._d(a,b.eF),b._d(a,b.fF),b._d(a,b.lWa),b._d(a,b.mWa)},a.prototype._d=function(a,b){var c,d,e,f,g,h;for(c in b)if(b[c]){e=b[c];for(d in e)if(e[d])if(f=e[d].line,g=e[d].splitLines,g&&g.length>0)for(h=0;h<g.length;h++)g[h]&&g[h].jp(a);else f&&f.jp(a)}},a}(),b.AF=C},"./dist/core/worksheet/worksheet-edit.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/util/domUtil.js"),h=g.GC$,i=c("Common"),j=c("./dist/core/core.enum.js"),k=c("CalcEngine"),l=!!k,m=f.Ul.Ml,n=f.Ul.rl(),o=i.Common.j.Fa,p=i.Common.u,q=i.Common.CultureManager,r=null,s=void 0,t="string",u=f.Ul.K_a,v=new i.Common.ResourceManager(d.SR),w=v.getResource.bind(v),x={startEdit:function(a,b){var c=this;c.EF(c.Ws(),c.Jl,c.Kl,r,r,a,b)},editorStatus:function(){return this.Px||0},isEditing:function(){var a=this.Px;return 1===a||2===a},endEdit:function(a){return this.gv(a)},gv:function(a,b,c,d){var e=this;if(!e.isEditing())return!0;e.suspendPaint();try{return e.Yoa(a,b,c,d)}finally{e.resumePaint()}},Yoa:function(a,b,c,d){var g,i,k,l,n,p,q,s,t,u,v,w,x,y,z,A=this,B=A.mm,C=A.BF,D=A.name(),E=A.Jl,F=A.Kl,G=A.getCellType(E,F),H={sheet:A,row:E,col:F,sheetArea:3};if(G.isImeAware(H)||B.Qq(),C&&C.parentNode){if(i=G.getEditorValue(C,H),k={sheet:A,sheetName:D,row:E,col:F,editor:C,editingText:i,cancel:!1},A.Wq(f.Events.EditEnd,k),k.cancel&&!d)return;if(A.Wq(f.Events.EditEnding,k),k.cancel&&!d)return;if(l=A.parent,n=l&&l.CF,document.activeElement===(n&&n.qo)&&B.Qq(),E>=0&&F>=0&&(p=C.Ep,q=A.getFormulaInformation&&A.getFormulaInformation(E,F),G.isEditingValueChanged(p,i,H)||1===b||q&&q.isArrayFormula&&1!==b))if(a)G.setEditorValue(C,p,H),G.selectAll(C,H);else if(s=G.DF,o(s)&&(s=!0),t={cmd:"editCell",sheetName:D,row:E,col:F,newValue:i,autoFormat:s,editingFormatter:C.oja},1===b&&(t.ranges=[A.Ix()],t.endEditType=b),null===i||a||(u=A.tables&&A.tables.find&&(A.tables.find(E-1,F)||A.tables.find(E,F-1)),u&&A.tables.fIb(new f.Range(E,F,1,1),null,i,!0)),A.wu().execute(t),g=t.applyResult,2===g&&(G.focus(C,H),!d))return!1;if(A.$l=!0,G.XBb(C,H,A.getCellRect(E,F)),G.isImeAware(H))m.msie&&9===parseFloat(m.version)?B.Qq():h(C.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(v=A.zo(),w=C;w;)w.parentNode===v?v.removeChild(w):w=w.parentNode}return A.Ll=!1,x={sheet:A,sheetName:D,row:E,col:F,editingText:i},y=h.extend({},x),A.Wq(f.Events.EditEnded,x),A.Wq(f.Events.FormulatextboxEditEnded,y),!(c!==!0&&y.ignore&&!d)&&(0!==A.Px&&(z=A.Px,A.Px=0,A.Cu(z,0)),A.ITa.setCellState(E,F,j.CellStatesType.edit,!1,j.SheetArea.viewport),e.Worksheet.ao(A,"endEdit"),A.BF=r,1!==g)},FF:function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.hitTest(b,c);!m||m.cellTypeHitInfo&&(m.cellTypeHitInfo.outlineColumnHitInfo||m.cellTypeHitInfo.cellButtonHitInfo)||(d=m.row,e=m.col,d>=0&&e>=0&&m.rowViewportIndex>=0&&m.colViewportIndex>=0&&!m.resizeInfo&&!m.dragInfo&&d===l.Jl&&e===l.Kl&&(f=l.isEditing(),l.EF(a,d,e),!f&&l.isEditing()&&(g=m.hitTestType,h=l.getCellType(d,e),h.tw&&(i=l.getCellRect(d,e,1===g?-1:s,2===g?-1:s),j=l.getActualStyle(d,e,g),k=h.h5(b,c,j,i,{sheet:l,row:d,col:e,sheetArea:g}),k&&k.isReservedLocation&&h.tw(l,d,e,3)))))},inputFormulaAndSelectFormulaRange:function(a,b,c,d){var g,h,i,j,k,l=this,m=l.options,n=l.getCellRect(a,b),o=l.getActualStyle(a,b),p=l.getCellType(a,b),q=l.mm;q.zt(),g={sheet:l,row:a,col:b,sheetArea:3},h=q.GF,h&&h.firstChild&&(i=h.firstChild.firstChild),i&&(l.BF=i,j=l.am(),p.isImeAware(g)&&q.JF(),p.d5(h,o,n,g),l.KF(p,i,a,b,o,void 0,void 0),p.g5(h,o,n,g),m.allowCellOverflow&&(k=n.clone(),k.y-=2,k.height+=4,k.x=j.kt,k.width=l.rKc(j),l.repaint(k)),e.Worksheet.ao(l,"startEdit",{element:p.getEditingElement()}),l.Px=2,l.Cw.text(d),l.Cw.caret(d.length-1),c&&l.Cw.iIb(3,4),l.Cw.S1(),f.Vl.Zl(l))},EF:function(a,b,c,d,g,h,i,k,p){var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa;if(!(b<0||c<0||(s=this,t=s.name(),u=s.options,s.isEditing()))){if(v=s.ITa,v.setCellState(b,c,j.CellStatesType.edit,!0,j.SheetArea.viewport),w=s.getActualStyle(b,c),u.isProtected&&w.locked!==!1)return void v.setCellState(b,c,j.CellStatesType.edit,!1,j.SheetArea.viewport);if(x=s.getCellType(b,c),!x)return void v.setCellState(b,c,j.CellStatesType.edit,!1,j.SheetArea.viewport);if(s.pivotTables)for(y=s.pivotTables.all(),z=0;z<y.length;z++)if(A=y[z],B=A.getRange(),C=B.page,D=B.content,C&&C.contains(b,c)||D&&D.contains(b,c))return void v.setCellState(b,c,j.CellStatesType.edit,!1,j.SheetArea.viewport);if(E=s.mm,E.zt(),F={sheet:s,row:b,col:c,sheetArea:3},G=x.isImeAware(F)?E.GF:x.a5(F),G&&G.firstChild&&(H=G.firstChild.firstChild),!H)return void v.setCellState(b,c,j.CellStatesType.edit,!1,j.SheetArea.viewport);if(I=s.getActualStyle(b,c),J=!1,L=q.culture(),(I.formatter&&f.util.yIc(I.formatter,L)||I._autoFormatter&&I._autoFormatter.formatCached&&f.util.yIc(I._autoFormatter,L))&&(p&&p.key&&(M=p.key,N=p.code,p&&M&&f.NUMBER_ARRAY.indexOf(M)!==-1&&(J=!0),"+"!==M&&"-"!==M||(x.probabilityAddPercent=!0),"process"===M.toLowerCase()&&(!p.shiftKey&&N.length-N.replace(/[0-9]/,"").length>0&&(J=!0),!p.shiftKey&&(N.length-N.replace("Minus","").length>0||N.length-N.replace("Subtract","").length>0||N.length-N.replace("Add","").length>0)&&(x.probabilityAddPercentSpec=!0),p.shiftKey&&N.length-N.replace("Equal","").length>0&&(x.probabilityAddPercentSpec=!0))),O=G.innerText,m.msie&&(O=O.replace("\r\n","")),P=q.q4(q.culture()).NumberFormat.numberDecimalSeparator,Q=RegExp("^[-]?[0-9]+(\\"+P+"[0-9]+)?$"),!p&&O&&Q.test(O)&&(K=!0)),s.BF=H,R={sheet:s,sheetName:t,row:b,col:c,cancel:!1},s.Wq(f.Events.EditStarting,R),R.cancel)return n.ipad&&E.Qq(),void v.setCellState(b,c,j.CellStatesType.edit,!1,j.SheetArea.viewport);s.showCell(s.Jl,s.Kl,3,3),s.jIb=!0,S=s.getValue(b,c),T=l&&s.getFormula(b,c),U=s.Px,s.HF?s.Px=1:o(S)&&o(T)?s.Px=1:s.Px=2,s.Cu(U,s.Px),V=s.am(),W=s.getCellRect(b,c,d,g),!W||o(W.width)||o(W.height)||o(W.x)||o(W.y)||W.width<=0||W.height<=0||(x.isImeAware(F)&&E.JF(),x.d5(G,w,W,F),s.KF(x,H,b,c,w,i,k,J,K),X=s.zo(),x.isImeAware(F)||X.insertBefore(G,r),delete s.jIb,x.g5(G,w,W,F),x.isImeAware(F)&&h||x.focus(H,F),u.allowCellOverflow&&(Y=W.clone(),Y.y-=2,Y.height+=4,s.QLc&&s.QLc.isEnable(j.RowColumnStates.edit,!1)&&(Y.y=V.nt,Y.height=V.jr),Y.x=V.kt,Y.width=s.rKc(V),s.repaint(Y)),e.Worksheet.ao(s,"startEdit",{element:x.getEditingElement()}),!J&&h&&x.selectAll(H,F),J&&(Z=window.getSelection(),$=document.createRange(),$.setStart(H,0),Z.removeAllRanges(),Z.addRange($)),K&&(Z=window.getSelection(),
_=document.createElement("span"),_.innerText="%",$=document.createRange(),s.parent.options.enableFormulaTextbox&&s.parent.options.allowUserEditFormula?(H.firstChild.appendChild(_),$.setStart(H.firstChild,1),s.Cw&&s.Cw.BXc()):(H.appendChild(_),$.setStart(H,1)),Z.removeAllRanges(),Z.addRange($)),f.Vl.Zl(s),aa={sheet:s,sheetName:t,row:b,col:c},s.Wq(f.Events.EditStarted,aa),s.Wq(f.Events.FormulatextboxEditStarted,aa))}},KF:function(a,b,c,d,e,f,g,h,i){var j,k,m,n,p,q,r,s,v,w=this,x=l&&w.getFormula(c,d,3,!0);x&&(x="="+x),j=x,k={sheet:w,row:c,col:d,sheetArea:3,isImeInput:g},x&&0!==x.length||(x=w.getValue(c,d,3,1),x&&x.richText&&(x=u(x)),m=w.parent,n=l&&m&&m.options.allowUserEditFormula,typeof x===t&&e.quotePrefix||x&&x.length>0&&"="===x[0]&&n?(x="'"+x,j=x):(j=x,x=a.kp(b,e,x,k))),b.Ep=x,o(f)||(x=f),i&&x&&(x=this.dJc(x,e)),a.setEditorValue(b,x,k,h),w.parent&&w.parent.options.enableAccessibility&&(p=x&&"="===x[0],q=p?w.getText(c,d):x,r=p?x:w.getFormula(c,d),s=w.comments&&w.comments.get(c,d),v=w.fYc(c,d,q,r,s&&s.text()),b.setAttribute("aria-label",v)),b.LF=j},eYc:function(a){var b="",c=a&&(a.formatter||a._autoFormatter);return c&&(b=typeof c===t?c:c.formatCached),b},dJc:function(a,b){var c,d,e,f,g,h,i,j,k=q.q4(q.culture()).NumberFormat,l=k.negativeSign,m=k.numberDecimalSeparator,n=this.eYc(b),o="%"===n[0],p=n.split(";");if(o?c=p[0].split("%")[1].split(".")[1]:p[0].indexOf("%")>-1&&(c="00"),void 0===c&&(c=""),a.split("e").length>1)return d=a.split("e")[0],e=a.split("e")[1],d+"e+"+(parseInt(e.split("+")[1],10)+2);if(a.split(m).length>1){for(f=!1,a.charAt(0)===l&&(a=a.substr(1,a.length-1),f=!0),a+=c,g=a.indexOf(m),a=a.split(m).join(""),a=a.substr(0,g+2)+m+a.substr(g+2,a.length-1),h=a.split(m),i=h[0],j=h[1];i&&"0"===i.charAt(0);)i=i.substr(1,i.length-1);for(;j&&"0"===j.charAt(j.length-1);)j=j.substr(0,j.length-1);return f&&i&&(i=l+i),i&&j?i+m+j:!i&&j?(f?l+"0"+m:"0"+m)+j:i&&!j?i:"0"}return"0"===a?a:a+c}},h.extend(e.Worksheet.prototype,x)},"./dist/core/worksheet/worksheet-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("Common"),g=c("./dist/core/worksheet/worksheet-model.js"),h=c("./dist/core/util/domUtil.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/core.enum.js"),k=c("./dist/core/workbook/sheettabbase.js"),l=window,m=document,n=h.GC$.each,o=i.Ul.Ml,p=i.Ul.rl(),q=i.Ul.nl,r=i.Ul.Nl,s=f.Common.u,t=f.Common.u.Kb,u=i.kf,v=f.Common.j.Fa,w={lIb:".handler"},x="mousedown"+w.lIb,y="mouseup"+w.lIb,z="mousemove"+w.lIb,A="mousewheel"+w.lIb,B="DOMMouseScroll"+w.lIb,C="wheel"+w.lIb,D="mouseout"+w.lIb,E="dblclick"+w.lIb,F=null,G=void 0,H=isNaN,I=parseInt,J=Math.max,K=Math.floor,L=Math.min,M=Math.abs,N=Math.ceil,O="function",P="position",Q="absolute",R="border",S="overflow",T="top",U="left",V="width",W="height",X="resize",Y="hidden",Z="visible",$="none",_="tabindex",aa="gcUIElement",ba="corner",ca="sizeHiddenRow",da="sizeRow",ea="sizeCol",fa="sizeHiddenCol",ga="default",ha=p.iphone||p.ipad||p.android,ia=new f.Common.ResourceManager(d.SR),ja=ia.getResource.bind(ia),ka=30;function na(a,b){var c=3;return va(b)<0&&(c=1),wa(b)<0&&(c=2),!(3===c||!a.vp(b.row,b.col,c,!0))}function oa(a,b,c){var d,e,f,g,h,j,k,l=!1,m=a.am();return b&&(d=va(b),e=wa(b),(d<0||e<0)&&(f=a.getCellRect(b.row,b.col,d,e),f&&f.width>0&&f.height>0&&(g=m.x,h=m.y,(f.x<m.Br+g||f.y<m.Cr+h||f.y>=m.height-m.Bt)&&(j=new i.Rect(f.x-2,f.y-2,f.width+4,f.height+4),k=void 0,k=d<0&&e<0?m.em():d<0?m.gm(e):m.fm(d),j=j.getIntersectRect(k),c.VF(j.x,j.y,j.width,j.height),l=na(a,b))))),l}function pa(a){return a.isEditing()}function qa(a){return a.endEdit()}function ra(a){return a.frozenRowCount()}function sa(a){return a.frozenColumnCount()}function ta(a,b){return a.getRowCount(b)}function ua(a,b){return a.getColumnCount(b)}function va(a){return a.rowViewportIndex}function wa(a){return a.colViewportIndex}function xa(a){return a.hitTestType}function ya(a){return a.getActiveRowIndex()}function za(a){return a.getActiveColumnIndex()}function Aa(a){return a.keyCode}function Ba(a){return a.ctrlKey}function Ca(a){return a.shiftKey}function Da(a){return a.altKey}function Ea(a){return a.metaKey}function Fa(a){return a.colCount}function Ga(a){return a.rowCount}function Ha(a,b,c){return{action:a,index:b,sheetArea:c}}function Ia(a,b,c){return F===b.Zq(a,c,!0)}function Ja(a,b,c){return F===b._q(a,c,!0)}function Ka(a,b){return b?a.BYc?a.startY-a.movingY:a.movingY-a.startY:a.CYc?a.startX-a.movingX:a.movingX-a.startX}function La(a,b,c,d,e,f){var g={sheet:a,sheetName:b,sheetArea:e,row:c,col:d};return f&&(g.cancel=!1),g}function Ma(a,b,c,d,e,f){var g=a.kj,h=La(g,g.name(),g.Jl,g.Kl,G,!0);return g.Wq(i.Events.LeaveCell,h),!(!h||h.cancel!==!0)||(g.Kr(b,c,d,e,f),g.Wq(i.Events.EnterCell,La(g,g.name(),b,c)),g.Wq(i.Events.FormulatextboxEnterCell,La(g,g.name(),b,c)),void(a.cs&&a.cs(b,c)))}function Na(a,b,c,d,e,f,g){var h,i=a.kj,j=b.call(i,f.sheetArea);return(g&&!i.getRowVisible(f.index,f.sheetArea)||!g&&!i.getColumnVisible(f.index,f.sheetArea))&&(f.index=c.call(a,f.index,f.sheetArea)),h=d.call(j,f.index),h||(h=d.call(j,e)),h}function Oa(a,b,c,d,e){var f,g,h,i=d?"movingY":"movingX",j=d?"startY":"startX";a[i]=b,f=a.CYc||a.BYc?a[i]>a[j]:a[i]<a[j],f&&(a[i]=a[j]),g=d?c.y+c.height:c.x+c.width,h=d?a.DYc:a.EYc,a[i]>g&&!h&&(a[i]=g),e!==F&&a[i]>a[j]+e&&(a[i]=a[j]+e)}function Pa(a,b){var c=a.am();return ra(a)>0&&b<c.nt+c.fs?0:a.frozenTrailingRowCount()>0&&b>c.ot?2:1}function Qa(a,b){var c=a.am();return sa(a)>0&&b<c.kt+c.hs?0:a.frozenTrailingColumnCount()>0&&b>c.lt?2:1}function Ra(a,b,c){var d=a.Gr(b);return d?d.findNearY(c):F}function Sa(a,b,c){var d=a.Hr(b);return d?d.findNearX(c):F}function Ta(a){return!a.options.isProtected||a.options.protectionOptions.allowResizeRows}function Ua(a){return!a.options.isProtected||a.options.protectionOptions.allowResizeColumns}function Va(a,b){var c=b.row,d=b.rowCount,e=b.col,f=b.colCount,g=a.getColumnCount(),h=a.getRowCount();return f+e>g&&(f=g-e),d+c>h&&(d=h-c),{row:c,col:e,rowCount:d,colCount:f}}function Wa(a,b){var c,d=a.getViewportBottomRow(a.Er(b));if(d===-1&&(d=a.ir()),b<d)for(c=d;c>b;c--)if(0!==a.getRowHeight(c))return!1;return!0}function Xa(a){var b,c,d=a.ITa.getSelections();if(d.length>0)return b=0,c=a.getRowCount(),d.every(function(d){var e,f,g=Va(a,d),h=!1;return 1===g.rowCount&&(b+=1,h=b<=1),e=g.row<c,f=g.col!==-1,f||h&&e})}function Ya(a,b,c){var d=a.parent,e=d.options.rowResizeMode;return c&&0===e&&(e=1),b.action!==ca&&1===e&&(!Wa(a,b.index)&&(!(!a.getRowResizable(b.index,b.sheetArea)||!a.getRowResizable(b.index+1,b.sheetArea))&&Xa(a)))}function Za(a,b,c,d){return Ya(a,b,d)&&1===c.length&&c[0].firstRow===c[0].lastRow}function $a(a,b){var c,d=a.getViewportRightColumn(a.Fr(b));if(d===-1&&(d=a.dr()),b<d)for(c=d;c>b;c--)if(0!==a.getColumnWidth(c))return!1;return!0}function _a(a){var b,c,d=a.ITa.getSelections();if(d.length>0)return b=0,c=a.getColumnCount(),d.every(function(d){var e,f,g=Va(a,d),h=!1;return 1===g.colCount&&(b+=1,h=b<=1),e=g.col<c,f=g.row!==-1,f||h&&e})}function ab(a,b,c){var d=a.parent,e=d.options.columnResizeMode;return c&&0===e&&(e=1),b.action!==fa&&1===e&&(!$a(a,b.index)&&(!(!a.getColumnResizable(b.index,b.sheetArea)||!a.getColumnResizable(b.index+1,b.sheetArea))&&_a(a)))}function bb(a,b,c,d){return ab(a,b,d)&&1===c.length&&c[0].firstColumn===c[0].lastColumn}function cb(a,b,c,d,e){var f,g,h=b.index,i=a.am();Ya(a,b,e)?(f=a._q(h,c),g=a.Sl(h,c)+a.Sl(f,c),Oa(b,d,i,!0,g)):Oa(b,d,i,!0)}function db(a,b,c,d,e){var f,g,h=b.index,i=a.am();ab(a,b,e)?(f=a.Zq(h,c),g=a.Tl(h,c)+a.Tl(f,c),Oa(b,d,i,!1,g)):Oa(b,d,i,!1)}function eb(a,b,c){var d,e,f,g,h=c?a.frozenRowCount():a.frozenColumnCount(),i=c?a.lq:a.qq,j=!1,k=i-1;if(h>0&&h<i)for(e=i-1;e>=h;){if(d=c?a.getRowVisible(e):a.getColumnVisible(e)){if(f=c?a.getRowHeight(e):a.getColumnWidth(e),e===k&&0===f)break;if(f>0){j=!0;break}}else k--;e--}for(g=j?h:b,g--;g>=0;){if(d=c?a.getRowVisible(g):a.getColumnVisible(g))return g;g--}return-1}function fb(a){var b=a.Cw;return b&&b.w7c}la=function(){function a(a){var b=this;b.qo=a,b.jI=F,b.kI=F,b.lI=F,b.Fi=F,b.mI=!1,b.nI=!1}return a.prototype.tG=function(a){typeof a===O&&(this.kI=a)},a.prototype.PG=function(a){var b,c=this;H(a)||0===a?c.SG():(c.nI=a>0,a=M(a),b=c.jI,c.jI=a,b!==a&&c.oI())},a.prototype.oI=function(){var a=this;a.$b(),H(a.jI)||(a.lI=l.setInterval(function(){a.pI()},a.jI))},a.prototype.pI=function(){var a=this,b=a.kI;a.mI=!0,typeof b===O&&(a.Fi=b.call(a.qo,a.nI))},a.prototype.SG=function(){var a=this;a.$b(),a.jI=F,a.lI=F,a.Fi=F,a.mI=!1},a.prototype.$b=function(){var a=this.lI;a&&clearInterval(a)},a.prototype.no=function(){this.SG()},a}(),ma=function(){function a(a){this.mIb=0;var b=this;b.WF=0,b.XF=!1,b.Gma=!1,b.gA={},b.kj=a,b.nIb="gcEvent"+a._id}return a.prototype.no=function(){var a=this;a.YF&&a.YF.no(),a.ZF&&a.ZF.no(),a.$F=F},a.prototype._F=function(){var a=this;return a.YF||(a.YF=new la(a)),a.YF},a.prototype.aG=function(){var a=this;return a.ZF||(a.ZF=new la(a)),a.ZF},a.prototype.Vs=function(){return this.kj.Vs()},a.prototype.bG=function(){var a=h.GC$(this.kj.Ws()).position();return a||(a={top:0,left:0}),a},a.prototype.AD=function(a){var b,c,d,e,f,g,h,j,k,l,m=i.Ul.sl(),n=Ba(a),p=m&&n===!0&&0===a.button;return!(2!==a.button&&!p)||(b=this,c=b.kj,b.tC(),o&&o.msie&&a.offsetX!==G&&a.offsetY!==G&&(d=0,e=0,f=c.Xs,a.target!==f&&(g=i.Ul.Z3(a.target,f),d=g.EB,e=g.FB),f&&(h=a.pageX-(a.offsetX+d),j=a.pageY-(a.offsetY+e),f.canvasOffset={top:j,left:h})),k=c.Vs(),l=b.cG(a,a.pageX-k.left,a.pageY-k.top),pa(c)||l||b.zt(),c.dG=!0,!1)},a.prototype.tC=function(){var a=this;a.RB||(h.GC$(m).bind("mousemove.gcSheet."+a.nIb,function(b){a.BD(b)}).bind("mouseup.gcSheet."+a.nIb,function(b){a.CD(b)}),a.RB=!0)},a.prototype.uC=function(){this.RB&&(this.RB=!1,h.GC$(m).unbind("mousemove.gcSheet."+this.nIb).unbind("mouseup.gcSheet."+this.nIb))},a.prototype.cG=function(a,b,c){var d,f,g,h,j,k,l,m,n,o,p,q=this,r=q.kj,s=r.hitTest(b,c),t=s.row,u=s.col,w=s.dragInfo,x=s.formulaRangeHitInfo,y=s.cellTypeHitInfo,z=s.resizeTableHitInfo,A={hitInfo:s,e:a,r:F};if(e.Worksheet.ao(r,"processMouseDown",A),d=r.am(),b>=d.x&&c>=d.y){if(r.yt=s,A.r)return;if(q.eG=!0,s.tableSelectInfo&&!r.Cw)q.oIb(s,r);else if(s.resizeInfo){if(!fb(r)&&!qa(r))return;q.fG(s)}else if(s.dragMergeInfo){if(!qa(r))return;q.Zia&&q.Zia(s)}else if(w&&w.side&&w.side!==ba){if(!qa(r))return;q.gG&&q.gG(s),q.lG(a)}else if(w&&w.side===ba){if(!qa(r))return;q.hG&&q.hG(s)}else if(s.filterButtonHitInfo)qa(r);else if(x)x.inBorder?q.iG(s):(x.inTopLeft||x.inTopRight||x.inBottomLeft||x.inBottomRight)&&q.jG(s);else if(z)q.pIb&&q.pIb(s);else if(r.Qs(va(s)<0?-1:t,wa(s)<0?-1:u)){if(s.tableSelectInfo&&r.Cw&&(f=r.Cw,g=this.qgc(s,r),s.tableSelectInfo.tableSelection=g,f.rgc(g)),q.kG&&q.kG(r,s))return;if(h=ya(r),j=za(r),y){if(k=r.getCellType(y.row,y.col,xa(s)),y.sheet||(y.sheet=r),q.Sia(k,y)&&(l=y.sheetArea,(v(l)||3===l)&&(t!==h||u!==j))){r.suspendPaint();try{if(!qa(r))return;if(m=La(r,r.name(),h,j,G,!0),r.Wq(i.Events.LeaveCell,m),m&&m.cancel===!0)return;n=r.ITa.getSelections(),o=r.ITa.getSpan(t,u),p=[new i.Range(o.row,o.col,o.rowCount,o.colCount)],r.Wq(i.Events.FloatingElementSelected,{type:"worksheet"}),r.yu(n,p),r.Sr(t,u,G,G,1),r.Wq(i.Events.EnterCell,La(r,r.name(),t,u)),r.Wq(i.Events.FormulatextboxEnterCell,La(r,r.name(),t,u)),r.Au(n),r.Uja=!0,q.cs&&q.cs(t,u)}finally{r.resumePaint()}}k.processCellAndPaddingMouseDown(y)}if(y&&y.isReservedLocation)return!0;q.lG(a),q.Ala(r,s,t,u)}}},a.prototype.Ala=function(a,b,c,d){var e,f,g=this;try{if(g.mG=b,pa(a)&&!qa(a))return}finally{g.mG=F}v(c)||v(d)||(3===xa(b)&&g.cs&&g.cs(c,d),a.Wq(i.Events.FloatingElementSelected,{type:"worksheet"}),e=a.ITa.getSelections(),g.nG(b,e),f=a.ITa.getSelections(),a.yu(e,f))},a.prototype.Sia=function(a,b){return a&&b&&b.isReservedLocation&&(!a.activeOnClick||a.activeOnClick())},a.prototype.oG=function(a){var b,c=this.kj;return!c||(b=c.am(),v(a.x)||v(a.y)||v(a.width)||v(a.height)||a.x+a.width>b.pt+c.rKc(b)+b.js||a.y+a.height>b.qt+c.oKc(b)+b.gs)},a.prototype.pG=function(a,b,c,d,e){var f,g,i,j,k,l,m,n,o=this.kj;for(g=0,i=a.options,j=i.length;g<j;g++)if(k=i[g],k.selected){f=d[g].value;break}l=!1,o.options.isProtected&&(m=o.getActualStyle(b,c),m&&(l=m.locked)),f===G||l||(n={cmd:"editCell",sheetName:o.name(),row:b,col:c,newValue:f,autoFormat:!0,ignoreFormatting:e},o.wu().execute(n)),h.GC$(a).hide()},a.prototype.qG=function(){var a,b=this;b.rG&&(a=b.rG.sG,3!==a&&2!==a||b.aG().tG(b.uG),3!==a&&1!==a||b._F().tG(b.vG))},a.prototype.wG=function(){var a=this;a.xG&&a.yG(),a.$ia&&a._ia&&a._ia(),a.zG&&a.AG&&a.AG(),a.BG&&a.CG&&a.CG(),a.DG&&a.EG(),a.FG&&a.GG(),a.HG&&a.IG(),a.qIb&&a.rIb&&a.rIb()},a.prototype.uG=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.JG();k||(b=j.rG,c=j.kj,d=b.KG,e=c.getViewportTopRow(d),f=c.getViewportBottomRow(d),a?f<ta(c)-c.frozenTrailingRowCount()-1?c.mq(c._q(e)):(g=c.Gr(d),g&&g.length>0&&(h=c.am(),i=g[g.length-1],i.y+i.height>=h.qt+c.oKc(h)&&c.mq(c._q(e)))):e>ra(c)&&c.mq(c.gr(e))),j.wG()},a.prototype.vG=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.LG();k||(b=j.kj,c=j.rG,d=c.MG,e=b.getViewportLeftColumn(d),f=b.getViewportRightColumn(d),a?f<ua(b)-b.frozenTrailingColumnCount()-1?b.rq(b.Zq(e)):(g=b.Hr(d),g&&g.length>0&&(h=b.am(),i=g[g.length-1],i.x+i.width>=h.pt+b.rKc(h)&&b.rq(b.Zq(e)))):e>sa(b)&&b.rq(b.br(e))),j.wG()},a.prototype.JG=function(){var a,b,c,d,e,f,g=this.kj,h=g.am(),i=ra(g),j=g.frozenTrailingRowCount(),k=this.$F,l=this.rG,m=l.KG;if(0===m){if(k.y>h.qt)return g.mq(g._t()),l.KG=1,!0}else if(1===m){if(a=g.Gr(1),a&&a.length>0){if(b=a[0],i>0&&k.y<h.qt&&b.row<=g._t())return l.KG=0,!0;if(b=a[a.length-1],j>0&&k.y>h.ot&&b.row>=g.ir()&&b.y+b.height<=h.ot)return l.KG=2,!0}}else if(2===m&&(a=g.Gr(1),a&&a.length>0&&k.y<h.ot)){if(b=a[a.length-1],b.y+b.height>h.ot){for(c=g.oKc(h),d=ta(g)-j-1,e=0,f=d;f>=i;f--)if(e+=g.Sl(f),e>c){d=L(f+1,d);break}g.mq(g._q(d-1))}return l.KG=1,!0}return!1},a.prototype.LG=function(){var a,b,c,d,e,f,g=this.kj,h=g.frozenTrailingColumnCount(),i=sa(g),j=g.am(),k=this.$F,l=this.rG,m=l.MG;if(0===m){if(k.x>j.pt)return g.rq(g.$t()),l.MG=1,!0}else if(1===m){if(a=g.Hr(1),a&&a.length>0){if(b=a[0],i>0&&k.x<j.pt&&b.col<=g.$t())return l.MG=0,!0;if(b=a[a.length-1],h>0&&k.x>j.lt&&b.col>=g.dr()&&b.x+b.width<=j.lt)return l.MG=2,!0}}else if(2===m&&(a=g.Hr(1),a&&a.length>0&&k.x<j.lt)){if(b=a[a.length-1],b.x+b.width>j.lt){for(c=g.rKc(j),d=ua(g)-h-1,e=0,f=d;f>=i;f--)if(e+=g.Tl(f),e>c){d=L(f+1,d);break}g.rq(g.Zq(d-1))}return l.MG=1,!0}return!1},a.prototype.NG=function(){var a,b,c,d,e,f,g,h,i,k,l,m,n,o,p=this;(p.OG||p.O3||p.lV)&&(a=p.kj,b=a.am(),c=p.rG,v(c)||(d=c.KG,e=c.MG,f=p.$F,g=F,d>=0&&e>=0?(g=b.Ft(d,e),0===d&&a.lq===a.frozenRowCount()&&(h=b.Ft(1,e),g.height+=h.height),0===e&&a.qq===a.frozenColumnCount()&&(h=b.Ft(d,1),g.width+=h.width)):d>=0?g=b.fm(d):e>=0&&(g=b.gm(e)),g&&(i=a.parent,k=i&&i.options.scrollbarAppearance===j.ScrollbarAppearance.mobile,l=0,m=0,n=!1,o=!1,f.x<=g.x?(l=f.x-g.x,k&&(o=!0)):f.x>=g.x+g.width?(l=f.x-(g.x+g.width),0===l&&(l=50),k&&(o=!0)):k&&f.x===g.x+g.width-1&&(l=50,o=!0),f.y<=g.y?(m=f.y-g.y,k&&(n=!0)):f.y>=g.y+g.height&&(m=f.y-(g.y+g.height),k&&(n=!0)),i&&k&&(n&&(i.nKc.Jwa(j.ScrollbarState.show),i.ku.Rdc(!0)),o&&(i.kKc.Jwa(j.ScrollbarState.show),i.ku.Rdc(!1))),p._F().PG(p.QG(l)),p.aG().PG(p.QG(m)))))},a.prototype.RG=function(){this._F().SG(),this.aG().SG()},a.prototype.fG=function(a){var b,c,d,e,f,h,i=this,j=g.yp.prototype,k=i.kj,l=a.resizeInfo;l.action===da||l.action===ca?(b=Na(i,k.Jt,i.TG,j.findRow,a.row,l,!0),l.startY=b.y+(l.BYc?b.height:0)):(c=Na(i,k.Kt,i.UG,j.findCol,a.col,l,!1),l.startX=c.x+(l.CYc?c.width:0)),d=k.parent,e=a.x,f=a.y,d&&(h=d.options.showResizeTip,(1!==h||l.action!==ea&&l.action!==fa)&&(2!==h||l.action!==da&&l.action!==ca)&&3!==h||(f-ka<0?f+=ka/2:f-=ka,d.uw(s.Ob(i.VG()),e,f))),i.isResizing=!0,i.OG=!0,i.ctrl&&(i.fCb=!0)},a.prototype.WG=function(){var a,b,c,d=this,e=d.kj,f=e.yt,g=f.resizeInfo,h=d.$F,i=h.x,j=h.y,k=e.am(),l=e.parent,m=g.sheetArea;g&&d.OG&&d.isResizing&&(f.x===i&&f.y===j||(g.action===da||g.action===ca?cb(e,g,m,j,d.fCb):db(e,g,m,i,d.fCb),a=e.yl,b=a.bm(),a.Mx(k.x,k.y,k.width,k.height),a.Pw(b),l&&(c=l.options.showResizeTip,(1!==c||g.action!==ea&&g.action!==fa)&&(2!==c||g.action!==da&&g.action!==ca)&&3!==c||l.ww(d.XG(g)))))},a.prototype.YG=function(){var a,b,c,d,e,f,g,i,j,k,l,m,n=this;n.isResizing=!1,n.OG=!1,a=!0,b=n.kj,c=b.yt,d=c.resizeInfo,d&&(n.xw(),d.action===da||d.action===ca?v(d.movingY)?a=!1:(e=J(0,Ka(d,!0)/b.zoom()),f=[],g="resizeRow",b.tp(d.index)?h.GC$.each(b.ITa.getSelections(),function(a,c){if(c.col===-1)if(1===d.sheetArea)f.push({firstRow:d.index,lastRow:d.index});else{var e=b.Tq(c);f.push({firstRow:e.row,lastRow:e.row+Ga(e)-1})}}):f.push({firstRow:d.index,lastRow:d.index}),Za(b,d,f,n.fCb)&&(g="splitResizeRow"),i=1===d.sheetArea,b.wu().execute({cmd:g,sheetName:b.name(),rows:f,size:e,columnHeader:i})):v(d.movingX)?a=!1:(e=J(0,Ka(d)/b.zoom()),j=[],k="resizeColumn",b.sp(d.index)?h.GC$.each(b.ITa.getSelections(),function(a,c){if(c.row===-1){var e=b.Tq(c);2===d.sheetArea?j.push({firstCol:d.index,lastCol:d.index}):j.push({firstCol:e.col,lastCol:e.col+Fa(e)-1})}}):j.push({firstCol:d.index,lastCol:d.index}),bb(b,d,j,n.fCb)&&(k="splitResizeColumn"),l=2===d.sheetArea,b.wu().execute({cmd:k,sheetName:b.name(),columns:j,size:e,rowHeader:l})),m=b.hitTest(n.$F.x,n.$F.y),m&&n.Tw(m),a||b.repaint(),n.fCb=!1)},a.prototype.ZG=function(a,b){var c,d,e,f,g,h,i,j,k=0,l=0,m=0,n=0,o=this,p=o.kj,q=p.wq,r=ra(p),s=sa(p),t=xa(a);if(o.o4=o.$G=p.ITa.getSelections(),p.isCtrlPressed(t)||o.shift||p.Tr(),0===t){if(!o.shift&&(d=r?p.ar():p.lq,g=s?p.$q():p.qq,c=Ma(o,d,g,1,1,b)))return;p.isCtrlPressed(t)||p.Tr(),p.Ur(-1,-1,ta(p),ua(p),!0)}else if(1===t){if(!o.shift&&(d=r?p.ar():p.lq,e=o._G(d,a.col,!1),c=Ma(o,e.row,e.col,1,wa(a),b)))return;o.shift||p.n_a?(k=L(p.Kl,a.col),n=M(p.Kl-a.col)+1,p.Kx(-1,k,ta(p),n,!0)):p.Ur(-1,p.Kl,ta(p),1,!0)}else if(2===t){if(!o.shift){if(h=s?p.$q():p.qq,e=o._G(a.row,h,!0),f=p.Jl!==e.row,c=Ma(o,e.row,e.col,va(a),1,b))return;f&&q&&q.Lx()}o.shift||p.n_a?(l=L(p.Jl,a.row),m=M(p.Jl-a.row)+1,p.Kx(l,-1,m,ua(p),!0)):p.Ur(p.Jl,-1,1,ua(p),!0)}else if(3===t)if(H(a.row)||H(a.col))pa(p)&&(j=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p.yl.VF(j.x,j.y,j.width,j.height));else{if(!o.shift&&(p.Jl!==a.row||p.Kl!==a.col)){if(f=p.Jl!==a.row,c=Ma(o,a.row,a.col,va(a),wa(a),b))return;f&&q&&q.Lx()}o.shift?p.aH(a.row,a.col,!0):(i=p.ITa.getSpan(a.row,a.col),p.n_a||p.Ur(i.row,i.col,Ga(i),Fa(i),!0))}},a.prototype.bH=function(a){if(a&&(3!==xa(a)||!H(a.row)&&!H(a.col))){var b=this;b.OG=!0,b.xG=!0,b.rG={KG:va(a),MG:wa(a),sG:xa(a)},b.qG()}},a.prototype.ayb=function(a,b){var c,d=this,e=d.kj,f=e.getSpan(a,b),g=a,h=b,j=1,k=1,l=e.selectionUnit(),m=!1;return 1===l?(h=-1,k=-1,g=f?f.row:g,j=f?f.rowCount:j):2===l?(g=-1,j=-1,h=f?f.col:h,k=f?f.colCount:k):m=!0,c=f&&m?f:new i.Range(g,h,j,k)},a.prototype.nG=function(a,b){var c=this,d=c.kj,e=a.row,f=a.col;d.n_a=c.I0a(e,f,b,xa(a))&&d.parent.options.allowUserDeselect,d.n_a&&(d.s_a=d.Jl,d.t_a=d.Kl,d.p_a=c.ayb(e,f)),c.ZG(a),c.bH(a)},a.prototype.I0a=function(a,b,c,d){var e=this,f=e.kj,g=e.o_a(a,b,c,d);return g&&2===f.selectionPolicy()},a.prototype.o_a=function(a,b,c,d){var e,f,g,h=this.kj,i=h.getRowCount(),j=h.getColumnCount();if(!h.isCtrlPressed(d))return!1;for(e=!1,f=c.length,g=0;g<f;g++)if(3===d){if(c[g].contains(a,b,1,1)){e=!0;break}}else if(2===d){if(c[g].contains(a,-1,1,j)||c[g].contains(a,0,1,j)){e=!0;break}}else if(1===d&&(c[g].contains(-1,b,i,1)||c[g].contains(0,b,i,1))){e=!0;break}return e},a.prototype.yG=function(){var a,b=this;b.rG&&b.OG&&b.DA!==!0&&(a=b.rG.sG,3===a?b.cH():2===a?b.dH():1===a&&b.eH())},a.prototype.cH=function(){var a,b,c,d,e=this,f=e.kj,g=e.fH(),h=e.gH();if(g>=0&&h>=0&&f.Qs(g,h)){if(e.NG(),a=f.ITa.getSelections(),1===a.length&&(b=f.Jx(g,h,f.Jl,f.Kl),c=a[0],!f.n_a&&b.equals(c)))return;f.aH(g,h,!0),d=f.ITa.getSelections(),f.yu(a,d)}},a.prototype.dH=function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=i.fH(!0);if(k>=0&&j.Qs(k,-1)){if(a=L(j.Jl,k),b=J(j.Jl,k)-a+1,c=-1,d=ua(j),e=j.selectionPolicy(),0===e)return;f=j.selectionUnit(),2===f&&(a=-1,b=-1),g=j.ITa.getSelections(),j.Kx(a,c,b,d,!0),h=j.ITa.getSelections(),j.yu(g,h)}i.NG()},a.prototype.eH=function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=i.gH(!0);if(k>=0&&j.Qs(-1,k)){if(a=L(j.Kl,k),b=J(j.Kl,k)-a+1,c=-1,d=ta(j),e=j.selectionPolicy(),0===e)return;f=j.selectionUnit(),1===f&&(a=-1,b=-1),g=j.ITa.getSelections(),j.Kx(c,a,d,b,!0),h=j.ITa.getSelections(),j.yu(g,h)}i.NG()},a.prototype.hH=function(){var a,b,c,d,e=this;e.rG=F,e.RG(),e.DA=F,e.OG=!1,e.xG=!1,a=e.kj,0!==a.ITa.getSelections().length&&(a.n_a&&(a.n_a=!1,b=a.p_a,a.p_a=null,a.u_a(a.ITa.getSelections(),b),delete a.s_a,delete a.t_a),a.Uja?delete a.Uja:(c=!e.$G,c||(d=a.ITa.getSelections(),c=e.zu(e.$G,d)),c&&a.Au(e.o4)),e.$G=a.ITa.getSelections())},a.prototype.iH=function(){var a=this.kj,b=Pa(a,this.$F.y),c=this.rG.KG,d=a.Gr(1);return 0===b&&c>0&&d.length>0&&d[0].row>a._t()?b=1:2===b&&c<2&&d.length>0&&d[d.length-1].row<a.ir()&&(b=1),b},a.prototype.jH=function(){var a=this.kj,b=Qa(a,this.$F.x),c=this.rG.MG,d=a.Hr(1);return 0===b&&c>0&&d.length>0&&d[0].col>a.$t()?b=1:2===b&&c<2&&d.length>0&&d[d.length-1].col<a.dr()&&(b=1),b},a.prototype.fH=function(a){var b,c,d,e=this.kj,f=this.$F.y,g=this.iH(),h=Ra(e,g,f);if(h){if(b=e.am(),c=h.row,1===g&&f<b.qt){if(d=e._t(),c>d)return e._q(c-1)||c;if(c===d&&a)return 0}else if(0===g&&f<b.nt&&a)return 0;return 1===g&&f>b.ot&&c>e.hr()?e.gr(c)||c:c}return-1},a.prototype.gH=function(a){var b,c,d,e=this.kj,f=this.$F.x,g=this.jH(),h=Sa(e,g,f);if(h){if(b=e.am(),c=h.col,1===g&&f<b.pt){if(d=e.$t(),c>d)return e.Zq(c-1)||c;if(c===d&&a)return 0}else if(0===g&&f<b.kt&&a)return 0;return 1===g&&f>b.lt&&c>e.cr()?e.br(c)||c:c}return-1},a.prototype.QG=function(a){var b,c=0;return H(a)||0===a||(b=a<0,c=N(500/M(a)),c=J(20,10*c),c>200&&(c=200),b&&(c=-c)),c},a.prototype.TG=function(a,b){var c=this.kj,d=c.gr(a,b);return d!==F?d:a},a.prototype.UG=function(a,b){var c=this.kj,d=c.br(a,b);return d!==F?d:a},a.prototype.kH=function(a,b,c){for(var d=this.kj;a>b;)if(a--,d.getRowVisible(a,c))return a;return a},a.prototype.lH=function(a,b,c){for(var d=this.kj;a>b;)if(a--,d.getColumnVisible(a,c))return a;return a},a.prototype.FYc=function(a,b,c){for(var d=this.kj;a<b;)if(a++,d.getColumnVisible(a,c))return a;return a},a.prototype.GYc=function(a,b,c){for(var d=this.kj;a<b;)if(a++,d.getRowVisible(a,c))return a;return a},a.prototype.mH=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=F;return Ta(a)?(g=this,h=a.options.reversalTrailingResizeOrder,i=a.qKc,j=2===va(b),k=j&&i,l=h&&k,m=j&&!i||l,n=a.Gr(va(b),d),!n||H(b.row)||H(b.col)||(a.getRowVisible(b.row,d)||(b.row=this.TG(b.row,d)),o=n.findRow(b.row),o&&(p=!(l&&n[n.length-1].row===o.row),o.y+o.height-c<=e&&e<=o.y+o.height+c&&p?(x=Ha(da,b.row,d),q=n[n.length-1].row,q>=0&&(r=a.ir(d),x.index===r&&x.index!==q&&o.y+o.height-c/2<=e&&(x=Ha(g.nH(a,q,d),q,d))),j&&Ja(x.index,a,d)&&(x.DYc=!0),l&&(s=g.GYc(x.index,n[n.length-1].row,d),x=Ha(g.nH(a,s,d),s,d),x.BYc=l)):o.y-c<=e&&e<=o.y+c&&(f.Common.k.Cb(n,o)>0||m)&&(t=g.kH(b.row,0,d),x=Ha(g.nH(a,t,d),t,d),l&&(x=Ha(da,b.row,d),u=n[0].row,u>=0&&(v=a._q(u-1,d,!0),x.index===v&&x.index!==u&&e<o.y+c/2&&(x=Ha(g.nH(a,u,d),u,d))),x.BYc=l))),!x&&1===va(b)&&n.length>0&&(o=n[0],J(0,o.y-c)<=e&&e<=o.y+c&&(w=eb(a,b.row,!0),w>=0&&(x=Ha(g.nH(a,w,d),w,d))))),x&&!a.getRowResizable(x.index,d)&&(x=F),x):x},a.prototype.nH=function(a,b,c){var d=a.parent;return d&&1===d.options.resizeZeroIndicator&&a.getRowVisible(b)&&0===a.Yr(b,c)?ca:da},a.prototype.oH=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=F;return Ua(a)?(g=this,h=a.options.reversalTrailingResizeOrder,i=a.tKc,j=2===wa(b),k=j&&i,l=h&&k,m=j&&!i||l,n=a.Hr(wa(b),d),!n||H(b.col)||H(b.row)||(a.getColumnVisible(b.col,d)||(b.col=this.UG(b.col,d)),o=n.findCol(b.col),o&&(p=a.getColumnWidth(b.col,d),q=a.zoom(),p*=q,r=!(l&&n[n.length-1].col===o.col),o.x+p-c<=e&&e<=o.x+p+c&&r?(z=Ha(ea,b.col,d),s=n[n.length-1].col,s>=0&&(t=a.dr(d),z.index===t&&z.index!==s&&o.x+p-c/2<=e&&(z=Ha(g.pH(a,s,d),s,d))),j&&Ia(z.index,a,d)&&(z.EYc=!0),l&&(u=g.FYc(z.index,n[n.length-1].col,d),z=Ha(g.pH(a,u,d),u,d),z.CYc=l)):o.x-c<=e&&e<=o.x+c&&(f.Common.k.Cb(n,o)>0||m)&&(v=g.lH(b.col,0,d),z=Ha(g.pH(a,v,d),v,d),l&&(z=Ha(ea,b.col,d),w=n[0].col,w>=0&&(x=a.Zq(w-1,d,!0),z.index===x&&z.index!==w&&e<o.x+c/2&&(z=Ha(g.pH(a,w,d),w,d))),z.CYc=l))),!z&&1===wa(b)&&n.length>0&&(o=n[0],J(0,o.x-c)<=e&&e<=o.x+c&&(y=eb(a,b.col,!1),y>=0&&(z=Ha(g.pH(a,y,d),y,d))))),z&&a.HYc&&a.IYc(b,z.index)&&(z=F),z&&!a.getColumnResizable(z.index,d)&&(z=F),z):z},a.prototype.pH=function(a,b,c){var d=a.parent;return d&&1===d.options.resizeZeroIndicator&&a.getColumnVisible(b)&&0===a.$r(b,c)?fa:ea},a.prototype.ur=function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l.kj,n=m.parent,o=m.options,p=o.colHeaderVisible,q=o.rowHeaderVisible,r=F;return n&&!n.options.allowUserResize||(g=m.am(),va(a)<0&&wa(a)>=0&&p?(r=l.oH(m,a,d,1,b),r||(r=l.mH(m,a,d,1,c))):va(a)>=0&&wa(a)<0&&q?(r=l.mH(m,a,d,2,c),r||(r=l.oH(m,a,d,2,b))):va(a)<0&&wa(a)<0?m.ir(2)===F&&M(c-g.Cr)<=d?(h=m.Gr(1),h&&h.length>0&&(e=h[h.length-1].row,e>=0&&m.getRowResizable(e,2)&&(r=Ha(l.nH(m,e,2),e,2)))):m.dr(1)===F&&M(b-g.Br)<=d&&(i=m.Hr(1),i&&i.length>0&&(f=i[i.length-1].col,f>=0&&m.getColumnResizable(f,1)&&(r=Ha(l.pH(m,f,1),f,1)))):va(a)>=0&&wa(a)>=0&&(e=ta(m,1)-1,f=ua(m,2)-1,j=m.options.sheetAreaOffset.top,k=m.options.sheetAreaOffset.left,e>=0&&0===g.Cr&&j<=c&&c<=d+j&&p?r=Ha(l.nH(m,e,1),e,1):f>=0&&0===g.Br&&k<=b&&b<=d+k&&q&&(r=Ha(l.pH(m,f,2),f,2)))),r},a.prototype.qH=function(a,b,c,d){var e,f,g,h,i=this.kj,j=i.am(),k=j.Ft(1,1);if(1===b)if(e=i.Hr(b),e&&e.length>0){if(f=e[e.length-1],f.x+f.width<=c&&c<k.x+k.width)return!0}else if(k.contains(c,d))return!0;if(1===a)if(g=i.Gr(a),g&&g.length>0){if(h=g[g.length-1],h.y+h.height<=d&&d<k.y+k.height)return!0}else if(k.contains(c,d))return!0;return!1},a.prototype.BD=function(a){var b=this.Vs();this.sH(a,a.pageX-b.left,a.pageY-b.top)},a.prototype.DD=function(){var a,b,c,d,e,f,g=this.kj,h=g.yt;h&&(a=h.cellTypeHitInfo,a&&(b=g.getCellType(a.row,a.col,xa(h)),b.ZBb(a))),this.OG||(g.Uja=G,c={x:-1e4,y:-1e4,rowViewportIndex:F,colViewportIndex:F,row:-1,col:-1,resizeInfo:F,hitTestType:F},this.Uw(c),h&&(d=h.row,e=h.col,f=g.getActualStyle(d,e),g.RLc&&(clearTimeout(g.RLc),delete g.RLc),g.parent&&f&&f.showEllipsis&&g.parent.xw()))},a.prototype.sH=function(a,b,c){var d,e,f,g,h,k,l,m,n,o,p,q,r,t,u=this;return u.$F={e:a,x:b,y:c},d=u.kj,u.eG&&!i.Vl.Wl(d)&&i.Vl.Zl(d),u.eG&&u.OG?void(u.isResizing?u.WG():u.$ia?u._ia&&u._ia():u.zG?u.AG&&u.AG():u.BG?u.CG&&u.CG():u.DG?u.EG():u.FG?u.GG():u.HG?u.IG():u.qIb?u.rIb&&u.rIb():u.xG&&u.yG()):(e=d.hitTest(b,c),u.sIb(d,e,u),void(e&&(0===u.mIb&&e.tableSelectInfo&&u.eG&&u.tIb(d,u,e),f=d.parent,g=e.row,h=e.col,k=d.sr(e.rowViewportIndex,e.colViewportIndex),n=e.pivotTableInfo,o=!v(n)&&n.options.showToolTip,f?(m=d.getActualStyle(g,h,k),p=d.getCellRect(g,h,e.rowViewportIndex,e.colViewportIndex),!o||d.isEditing&&d.isEditing()?(clearTimeout(d.RLc),delete d.RLc,l=d.ITa.uIb(g,h,k),v(l)&&!v(g)&&d.xUc&&k===j.SheetArea.rowHeader&&(l=d.ITa.uIb(-1,h,k)),l&&m.THb!==!1&&k?f.uw(s.Ob(l),p.x+p.width+5,p.y+p.height+5,!1):(r=f.options.showScrollTip&&(f.nKc.JB||f.kKc.JB),r||f.xw())):(l=n.UOc(g,h),q="gc-spread-pivot-toolTip",clearTimeout(d.RLc),delete d.RLc,f.xw(),l&&m.THb!==!1&&(d.RLc=setTimeout(function(a,b){f.uw(l,a,b+15,!1,q)}.bind(void 0,e.x,e.y),700)))):(clearTimeout(d.RLc),delete d.RLc),u.Tw(e),f&&f.options.enableAccessibility&&(t=d.cgc(e),f.dgc(t)),u.Uw(e))))},a.prototype.sIb=function(a,b,c){var d,e,f,g,h;1===c.mIb?(d=c.vIb.row,e=c.vIb.col,f=b.col,g=a.getSelections()[0],a.Kx(d,e>f?f:e,g.rowCount,e-f>0?e-f+1:f-e+1,!0)):2===c.mIb&&(d=c.vIb.row,e=c.vIb.col,h=b.row,g=a.getSelections()[0],a.Kx(d>h?h:d,e,d-h>0?d-h+1:h-d+1,g.colCount,!0))},a.prototype.tIb=function(a,b,c){var d,e=a.getActiveRowIndex(),f=a.getActiveColumnIndex();b.vIb={row:e,col:f},d=c.tableSelectInfo.action,"tableColSelect"===d?b.mIb=1:"tableRowSelect"===d&&(b.mIb=2)},a.prototype.Tw=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s=this,t=s.kj,u=t.Ws();u&&(b=t.yt,d=!b||a.row!==b.row||a.col!==b.col||xa(a)!==xa(b)||a.resizeInfo&&!b.resizeInfo||!a.resizeInfo&&b.resizeInfo||a.resizeInfo&&a.resizeInfo.action!==b.resizeInfo.action||a.dragInfo&&!b.dragInfo||!a.dragInfo&&b.dragInfo||a.dragInfo&&a.dragInfo.action!==b.dragInfo.action||a.resizeTableHitInfo&&!b.resizeTableHitInfo||!a.cellTypeHitInfo&&b.cellTypeHitInfo,b&&d&&(e=b.cellTypeHitInfo,e&&(c=t.getCellType(e.row,e.col,xa(b)),c.ZBb(e))),f=a.resizeInfo,g=a.dragMergeInfo,h=a.dragInfo,j=a.formulaRangeHitInfo,k=a.cellTypeHitInfo,l=t.yl,m=a.resizeTableHitInfo,n=a.tableSelectInfo,n?"tableRowSelect"===n.action?u.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===n.action?u.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===n.action?u.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===n.action?u.style.cursor="move":"default"===n.action&&(u.style.cursor=""):f?f.action===ea?u.style.cursor=i.CursorResource.ResizeCol:f.action===da?u.style.cursor=i.CursorResource.ResizeRow:f.action===fa?u.style.cursor=i.CursorResource.ResizeHiddenCol:f.action===ca?u.style.cursor=i.CursorResource.ResizeHiddenRow:u.style.cursor=ga:g?g.left||g.right?u.style.cursor="w-resize":(g.top||g.bottom)&&(u.style.cursor="n-resize"):h&&"drag"===h.action?h.side===ba?u.style.cursor="crosshair":h.side?u.style.cursor="move":u.style.cursor=ga:j?(j.inBorder?u.style.cursor="move":j.inTopLeft?u.style.cursor="nw-resize":j.inTopRight?u.style.cursor="ne-resize":j.inBottomLeft?u.style.cursor="sw-resize":j.inBottomRight&&(u.style.cursor="se-resize"),o=s.isFormulaRangeHoving,p=s.tH,q=p&&p.paramRange,r=j.paramRange,s.isFormulaRangeHoving=!0,s.tH={paramRange:r},o&&r.index===q.index||l.uH()):m?u.style.cursor="se-resize":(k&&(c=t.getCellType(k.row,k.col,xa(a)),k.sheet=t,d&&c.processMouseEnter(k),c.YBb(k)),!d&&k&&k.isReservedLocation||(u.style.cursor=ga),s.isFormulaRangeHoving&&(s.isFormulaRangeHoving=!1,s.tH=F,l.uH())))},a.prototype.CD=function(a){var b=this,c=b.kj;return b.uC(),!c.dG||(c.dG=!1,b.vH(a),!1)},a.prototype.vH=function(a){var b,c,d,e=this,f=e.kj,g=i.Vl.Xl();e.eG=!1,e.mIb=0,g&&g!==f&&g.endEdit&&(g.Cw&&g.Cw.V4||(g.endEdit(),g.repaint())),i.Vl.Zl(f),e.isResizing?e.YG():e.$ia?e.aja&&e.aja():e.zG?e.wH&&e.wH():e.BG?e.xH&&e.xH():e.DG?e.yH():e.FG?e.zH():e.HG?e.AH():e.qIb?e.wIb&&e.wIb():f.yt&&(b=f.yt,
c=b.cellTypeHitInfo,!b.filterButtonHitInfo&&!b.resizeInfo&&b.row>=0&&b.col>=0&&(c&&(d=f.getCellType(c.row,c.col,xa(b)),c.sheet||(c.sheet=f),d.XGb(c)),c&&c.isReservedLocation||f.Wq(i.Events.CellClick,La(f,f.name(),b.row,b.col,xa(b))),e.hH(),f.sgc&&f.tgc&&f.tgc())),e.SLc=!1,e.lG(a)},a.prototype.UF=function(a,b,c){var d,e=this.kj;e.isEditing&&e===i.Vl.Xl()&&(d=e.Ws(),Ca(a)||Ba(a)||e.FF(d,b,c))},a.prototype.nm=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o=this,p=o.kj;if(p){if(b=ya(p),c=za(p),d=p.getCellType(b,c),e={isEditing:pa(p),sheet:p,row:b,col:c,sheetArea:3},f={sheet:p,row:b,col:c,sheetArea:3},d&&d.isReservedKey(a,e))return void(pa(p)||d.processKeyDown(a,f));if(g=p.Cw,g&&g.BH(a))return;if(h=p.parent&&p.parent.CF,h&&h.BH(a,e))return}if(j=!(pa(p)||Ba(a)||Ea(a)||34!==Aa(a)&&33!==Aa(a)&&37!==Aa(a)&&39!==Aa(a)&&9!==Aa(a)&&13!==Aa(a)&&38!==Aa(a)&&40!==Aa(a)),p.CH&&(p.CH=!1,p.yl.DH()),l=Aa(a),m=13===l,n=27===l,p.sgc&&p.ugc&&(m||n)?p.ugc(n):k=o.EH(a),j&&k&&i.Vl.Wl(p)){if(o.Uoa=new Date,o.FH)return o.GH<25&&o.GH++,void q(a);o.FH=!0,o.GH=1,o.HH(a,!0)}},a.prototype.VG=function(){var a,b,c=this.kj,d=c.yt,e=d.resizeInfo;return e.action===da||e.action===ca?(a=c.getRowHeight(e.index),t(ja().Tip_Height,[a])):(b=c.getColumnWidth(e.index),t(ja().Tip_Width,[b]))},a.prototype.XG=function(a){var b=this.kj;return a.action===da||a.action===ca?t(ja().Tip_Height,[J(0,K((a.movingY-a.startY)/b.zoom()))]):t(ja().Tip_Width,[J(0,K((a.movingX-a.startX)/b.zoom()))])},a.prototype.HH=function(a,b){var c=this;if(c.FH){if(new Date-c.Uoa>100)return void c.Ux();b||c.EH(a),c.FH&&(c.WF=l.setTimeout(function(){c.HH(a)},500/c.GH))}},a.prototype.IH=function(a,b){var c,d,e,f=this.kj,g=f.Ws();if(g){f.HF=!0;try{c=pa(f),f.EF&&f.EF(g,f.Jl,f.Kl,F,F,!0,F,b,a),!c&&pa(f)&&(d=f.getCellType(f.Jl,f.Kl),!d.tw||32!==Aa(a)||Ba(a)||Ca(a)||Da(a)||d.tw(f,f.Jl,f.Kl,3),d.JH&&d.JH(a))}finally{f.HF=!1,e=f.tu(),e.UHb&&delete e.UHb}}},a.prototype.EH=function(a){var b,c,d,f,g,i,j,k,m,n,o,p,r=this,s=r.kj;if(r.lG(a),pa(s)||27!==Aa(a)||Da(a)||Ba(a)||Ca(a)||!s.KH||(h.GC$(s.KH).remove(),s.KH=F),b=s.tu(),pa(s)||27!==Aa(a)||Da(a)||Ba(a)||Ca(a)||!b.UHb||delete b.UHb,pa(s)||34!==Aa(a)&&33!==Aa(a)&&35!==Aa(a)&&36!==Aa(a)&&38!==Aa(a)&&40!==Aa(a)||q(a),pa(s)||37!==Aa(a)&&39!==Aa(a)||q(a),pa(s)&&Ba(a)&&(89===Aa(a)||90===Aa(a)))return q(a),!1;if(c=s.wu(),d=c.getShortcutKey(Aa(a),Ba(a),Ca(a),Da(a),Ea(a)),f=c.getCommands(d))for(g=0;g<f.length;g++)if(i={sheetName:s.name()},j=f[g].execute(s.parent,i),j||i.vgc)return j.ignoreCancelDefault||q(a),!0;return k={e:a,r:F},e.Worksheet.ao(s,"processKeyDown",k),!!k.r||(r.LH(a)&&(m=s.Cw,m&&m.MH&&m.NH(),n=pa(s),n||(o=l.Yl.Bm(a.target),p=o&&"gcAttachedFormulaTextBox"===o.getAttribute(aa),p||r.IH(a))),!1)},a.prototype.Ux=function(){var a=this;a.FH=!1,a.WF>0&&(clearTimeout(a.WF),a.WF=0)},a.prototype.om=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Ux(),b=j.kj){if(c=ya(b),d=za(b),e=b.getCellType(c,d),f={isEditing:pa(b),sheet:b,row:c,col:d,sheetArea:3},g={sheet:b,row:c,col:d,sheetArea:3},e&&e.isReservedKey(a,f))return void(pa(b)||e.processKeyUp(a,g));if(h=b.Cw,h&&h.BH(a))return;if(i=b.parent&&b.parent.CF,i&&i.BH(a))return}j.lG(a)},a.prototype.pm=function(a){var b=this,c=b.kj,d={e:a,r:F};e.Worksheet.ao(c,"processCompositionStart",d),d.r||this.IH(a,!0)},a.prototype.LH=function(a){return!(Ba(a)||Da(a)||Ea(a))&&(Aa(a)>=65&&Aa(a)<=90||Aa(a)>=48&&Aa(a)<=59||Aa(a)>=96&&Aa(a)<=105||Aa(a)>=186&&Aa(a)<=192||Aa(a)>=220&&Aa(a)<=222||219===Aa(a)||Aa(a)>=106&&Aa(a)<=111||32===Aa(a)||61===Aa(a)||173===Aa(a)||229===Aa(a)||0===Aa(a)||8===Aa(a))},a.prototype.lG=function(a){var b,c,d,e,f,g=this,h=g.kj,j=i.Ul.sl(),k=j?Ea(a):Ba(a);g.ctrl=k&&!Ca(a),g.shift=Ca(a)&&!k,h.Hx=!1,9===Aa(a)&&(b=h.ITa.getSelections().length,b>1?h.Hx=!0:(c=h.Ix(),c&&b>0&&(h.Hx=!(h.Jl===c.row&&h.Kl===c.col&&h.Lr>=Ga(c)&&h.Mr>=Fa(c))))),g.zG===!0&&(d=h.Ix(),e=g.OH,f=g.PH,d.row===-1||d.col===-1?g.OH=Ca(a):g.OH=!1,g.PH=k,e===g.OH&&f===g.PH||h.yl.QH&&h.yl.QH()),g.RH=k},a.prototype.Vx=function(){var a=this;a.shift=!1,a.ctrl=!1,a.kj.Hx=!1,a.zG=!1,a.OH=!1,a.PH=!1,a.RH=!1},a.prototype.Qw=function(a){var b,c,d,e,f,g,i,j,k,l,m,n;a&&a.sheet?(b=a.sheet,c=a.editor,d=a.canvasOffset):(b=this.kj,c=b.BF),pa(b)&&(e=b.Jl,f=b.Kl,g=b.getCellType(e,f),i=b.am(),j=b.getActualStyle(e,f),k=b.getCellRect(e,f),c&&c.parentNode&&(l=c.parentNode.parentNode,k&&k.width>0&&k.height>0&&k.x>=i.kt&&k.y>=i.nt&&k.x+k.width<=i.lt+i.js&&k.y+k.height<=i.ot+i.gs?(m={sheet:b,row:e,col:f,sheetArea:3,canvasOffset:d},g.g5(l,j,k,m)):h.GC$(l).css({top:-1e4,left:-1e4})),n=b.Cw,n&&n.SH())},a.prototype.TH=function(a,b){var c,d;if(!a)return F;for(c=a.firstChild;c;){if(c.id===b||c.name===b)return c;if(d=this.TH(c,b))return d;c=c.nextSibling}return F},a.prototype.zu=function(a,b){var c,d,e,f=!0;if(a.length===b.length)for(c=0;c<a.length;c++){if(d=a[c],e=b[c],d.row!==e.row||d.col!==e.col||Ga(d)!==Ga(e)||Fa(d)!==Fa(e)){f=!0;break}f=!1}return f},a.prototype.UH=function(a,b,c,d){var e,f,g,i,j,k,m,n,p=this,q=p.kj,s={sheet:q,row:b,col:c,sheetArea:3},t=q.zo(),u=a.isImeAware(s),w=ha?Q:"fixed";return d&&p.VH(),u&&!p.GF&&(e=a.a5(s),f=e.style,p.WH||(p.WH={overflow:Z,border:$,position:Q}),p.WH.overflow=f.overflow,p.WH.border=f.border,p.WH.position=f.position,h.GC$(e).css([P,S,T,U,V,W,R],[w,Y,"0px","0px","0px","0px",$]),q.KF&&e.firstChild&&(g=e.firstChild.firstChild,q.KF(a,g,b,c,q.getActualStyle(b,c)),i=a.getEditorValue(g,s),o.safari&&(""===i||v(i))&&a.setEditorValue(g," ",s)),t&&t.insertBefore(e,F),p.GF=e),p.XH||(e=r("div"),h.GC$(e).css([P,S,T,U,V,W],[w,Y,"0px","0px","0px","0px"]),p.XH=e,j=r("textarea"),h.GC$(j).attr(aa,"gcSheetFocusInput").attr(_,-1).css([P,S,R,X],[Q,Y,$,$]),j.value=" ",e.insertBefore(j,F),p.YH=j,k=r("div"),h.GC$(k).css(P,Q).css(S,Y).attr(aa,"gcSheetFocusInput").attr(_,-1),e.insertBefore(k,F),p.ZH=k,t&&t.insertBefore(e,F)),m=l.location!==l.parent.location,n=l.scrollX>0||l.scrollY>0,(ha||o.mozilla&&m||n)&&(p.GF&&p.$H(q,p.GF),p.$H(q,p.XH)),u?p.GF:p.YH},a.prototype.JF=function(){var a=this;a.GF&&a.WH&&h.GC$(a.GF).css(S,a.WH.overflow).css(R,a.WH.border).css(P,a.WH.position)},a.prototype.VH=function(){var a=this;a.GF&&(a.GF.parentElement&&a.GF.parentElement.removeChild(a.GF),a.GF.comboBox&&(a.GF.comboBox=F),a.GF=F)},a.prototype.zt=function(a){i.Vl.Wl(this.kj)||this._H(!0,!0,a)},a.prototype.Cm=function(){var a=this.ZH;a&&a.focus()},a.prototype.Qq=function(){this._H(!0,!0)},a.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=F)},a.prototype._H=function(a,b,c){var d,e,f,g,h,j,k,n,q,r,s,t;0===arguments.length&&(a=!0),d=this,d.Gma||(d.XF=!1,d.aI(),e=d.kj,f=ya(e),g=za(e),h=e.getCellType(f,g),d.UH(h,f,g,b),j={sheet:e,row:f,col:g,sheetArea:3},k=h.isImeAware(j)&&d.GF.firstChild?d.GF.firstChild.firstChild:d.YH,n=k,b&&!o.msie&&h.setImeMode(n,e.getActualStyle(f,g).imeMode,j),m.body.focus(),q=function(){var a=function(){try{h.isImeAware(j)?(h.focus(n,j),h.selectAll(n,j)):(k.focus(),k.select())}catch(a){}};b&&o.msie&&h.setImeMode(n,e.getActualStyle(f,g).imeMode,j),a()},r=p,s=o.metroMode||r.ipad||r.iphone||r.android,!e.CH&&!s||!a&&h.isImeAware(j)?e._enhanceIme===!1||c||d.TLc(e)||q():!pa(e)&&s?b&&(t=d.GF&&d.GF.firstChild&&d.GF.firstChild.firstChild,h.setImeMode(t,e.getActualStyle(f,g).imeMode,j)):d.bI=l.setTimeout(function(){d.TLc(e)||(d.aI(),pa(e)||e._enhanceIme===!1||c||q())},200),i.Vl.Wl(e)||d.TLc(e)||i.Vl.Zl(e),d.byb(e)||d.cs&&d.cs(e.Jl,e.Kl))},a.prototype.$H=function(a,b){var c,d,e,f,g,i,j,k=ya(a),m=za(a),n=a.Nr,o=a.Pr,p=a.getCellRect(k,m,n,o),q=this,r=a.Vs(),s=q.bG(),t=q.GF,u=0,v=0,w=0,x=0;t&&(e=h.GC$(t),u=parseInt(e.css(T),10),v=parseInt(e.css(U),10),w=parseInt(e.css(W),10),x=parseInt(e.css(V),10)),q.oG(p)?(c=u,d=v):(c=p.y+s.top-2,d=p.x+s.left-2),f=l.pageYOffset-r.top+s.top,g=l.innerHeight+f-w,i=l.pageXOffset-r.left+s.left,j=l.innerWidth+i-x,(H(c)||c<f||c>g)&&(c=f),(H(d)||d<i||d>j)&&(d=i),h.GC$(b).css(T,c).css(U,d)},a.prototype.cI=function(a){var b,c,d,e,f=this;f.aI(),pa(f.kj)||f.XF&&m.activeElement===f.ZH||(b=f.kj,a?(c=a.row,d=a.col):(c=b.Jl,d=b.Kl),e=b.getCellType(c,d),f.UH(e,c,d,!1),f.ZH.focus(),f.XF=!0)},a.prototype.dI=function(a,b){var c=this;c.XF&&(c.XF=!1,!b&&c._H(a))},a.prototype.gx=function(a){var b=this.kj,c=b.tu();c&&(c.ska(a),c.M4(),this.Gma=!0,a&&c.N4())},a.prototype.hx=function(){var a=this,b=a.kj.tu();b&&b.ska(""),a.Gma=!1,a._H(!0,!1)},a.prototype.MF=function(){var a,b=this;b.aI(),a=b.GF,a&&(h.GC$(a).remove(),b.GF=G),a=b.XH,a&&(h.GC$(a).remove(),b.YH=G,b.XH=F,b.ZH=F)},a.prototype.uw=function(a,b,c,d){var e=this.kj.parent;e&&e.uw(s.Ob(a),b,c,d)},a.prototype.ww=function(a,b,c,d){var e=this.kj.parent;e&&e.ww(a,b,c,d)},a.prototype.xw=function(){var a=this.kj.parent;a&&a.xw()},a.prototype.Uw=function(a){var b,c,d,e,f,g,h,i,k,l,m,n,o,p;function q(a,b){var c=!1;return a||b?a&&b&&(c=a.action===b.action&&a.index===b.index&&a.sheetArea===b.sheetArea):c=!0,c}b=this,c=b.kj,d=c.hCb,e=c.iCb,f=c.yt,g=!1,f||(g=!0),g||a||(g=!0),g||(g=a.col!==f.col||a.row!==f.row||wa(a)!==wa(f)||va(a)!==va(f)||xa(a)!==xa(f)||!q(a.resizeInfo,f.resizeInfo)),c.yt=a,g&&(h=c.QLc,i=h&&h.isEnable(j.RowColumnStates.hover,!0),k=h&&h.isEnable(j.RowColumnStates.hover,!1),l=a.hitTestType,f&&!v(f.hitTestType)&&(c.hCb=null,c.iCb=null,c.ITa.setCellState(d,e,j.CellStatesType.hover,!1,f.hitTestType),i&&c.ULc(d,f.rowViewportIndex,f.colViewportIndex),k&&c.VLc(e,f.rowViewportIndex,f.colViewportIndex),i||k||c.xIb&&c.xIb(j.CellStatesType.hover,d,e,f.hitTestType,f.rowViewportIndex,f.colViewportIndex)),a&&!v(l)&&(m=void 0!==a.row&&void 0!==a.col&&l===j.SheetArea.viewport,c.hCb=a.row,c.iCb=a.col,a.resizeInfo||(c.ITa.setCellState(a.row,a.col,j.CellStatesType.hover,!0,l),i&&m&&c.ULc(a.row,a.rowViewportIndex,a.colViewportIndex),k&&m&&c.VLc(a.col,a.rowViewportIndex,a.colViewportIndex),i||k||c.xIb&&c.xIb(j.CellStatesType.hover,a.row,a.col,l,a.rowViewportIndex,a.colViewportIndex))),c.fI=!0,n=c.yl,o=oa(c,f,n),p=oa(c,a,n),o=o||p,c.fI=!1,(o||c.HYc)&&n.im())},a.prototype._G=function(a,b,c){var d=this.gI(a,b,c);return this.hI(d)},a.prototype.gI=function(a,b,c){var d=this.kj.ITa.getSpan(a,b),e=Ga(d),f=Fa(d);return 1===e&&1===f?d:c&&1===e||!c&&1===f?d:(c?b++:a++,this.gI(a,b,c))},a.prototype.hI=function(a){var b,c,d,e=this.kj,f=a.row,g=ta(e);for(b=f;b<g&&e.getRowVisible(b)!==!0;b++);for(b<g&&(f=b),c=a.col,d=ua(e),b=c;b<d&&e.getColumnVisible(b)!==!0;b++);return b<d&&(c=b),u(f,c,Ga(a),Fa(a))},a.prototype.byb=function(a){var b,c,d=a.floatingObjects&&a.floatingObjects.all(),e=a.shapes&&a.shapes.all();if(!v(d))for(b=0;b<d.length;b++)if(d[b].isSelected())return!0;if(!v(e))for(c=0;c<e.length;c++)if(e[c].isSelected())return!0},a.prototype.TLc=function(a){return"function"==typeof a.isShapeTextEditorOpened&&a.isShapeTextEditorOpened()},a}(),b.iI=ma,e.Worksheet.$n("eventHandler",{beforeSetHost:function(){var a=this;a.mm=new ma(a)},dispose:function(a){var b,c,d,e,f=this,g=f.mm;g&&(g.uC(),b=g.nIb,h.GC$(f.Ws()).unbind(x+"."+b).unbind(y+"."+b).unbind(z+"."+b).unbind(A+"."+b).unbind(D+"."+b).unbind(E+"."+b),o.mozilla&&(c="onwheel"in document?C:B,h.GC$(f.Ws()).unbind(c+"."+b)),g.no(),g.MF()),d=f.BF,d&&h.GC$(d).remove(),e=f.NF,e&&(e.close(),f.NF=null),a.clearCache!==!1&&(f.OF=F,f.PF=F,f.QF=F,f.RF=F,f.SF=F,f.TF=F,f.mm=F)},setHost:function(a){var b,c,d,f;function g(a,c){var d=b.Vs(),e=c.pageX-d.left,f=c.pageY-d.top,g=b.hitTest(e,f),h=g.dragInfo;g.tableSelectInfo||(h&&a.cyb&&"corner"===h.side?a.cyb():a.UF(c,e,f))}a&&(b=this,c=b.mm,b.OF=function(a){var d={e:a,r:F};if(e.Worksheet.ao(b,"preProcessMouseDown",d),!d.r)return c.AD(a)},b.PF=function(a){var d={e:a,r:F};e.Worksheet.ao(b,"preProcessMouseMove",d),d.r||c.RB||c.BD(a)},b.QF=function(a){var d={e:a,r:F};if(e.Worksheet.ao(b,"preProcessMouseUp",d),!d.r&&!b.XD){if(c.RB)return;return c.CD(a)}},b.RF=function(a){var c,d,f,g,h,i,j,k,m,n,p,q;if(a=a||l.event,c={e:a,r:F},e.Worksheet.ao(b,"preProcessMouseWheel",c),!c.r)return d=b.parent,f=d&&d.options.scrollByPixel,g=a.detail?a.detail:a.wheelDelta/-40,h=0,"wheel"===a.type?(i=17,j=o.mozilla&&+o.version>=88?i:1,g=a.deltaY/j,h=a.deltaX/j,f||(M(g)>=M(h)?h=0:g=0)):(k=(new Date).valueOf(),m=a.wheelDeltaY,n=a.wheelDeltaX,f||(M(m)>=M(n)?n=0:m=0),p=!b.nka||k-b.nka>200,(o.safari||o.chrome)&&(j=o.safari?-4:-40,v(m)||(p?(g=m/j,g=(g>=0?1:-1)*K(M(g)),b.oka=0):(g=m/j,b.oka+=g,g=(g>=0?1:-1)*K(M(b.oka)),b.oka-=g)),v(n)||(p?(h=n/j,h=(h>=0?1:-1)*K(M(h)),b.pka=0):(h=n/j,b.pka+=h,h=(h>=0?1:-1)*K(M(b.pka)),b.pka-=h))),b.nka=k),(0!==g||0!==h)&&(q=b.parent.ku.Rw(b,a,I(g,10)||0,I(h,10)||0),d.xw(),!!q&&void 0)},b.SF=function(a){var d={e:a,r:F};if(e.Worksheet.ao(b,"preProcessMouseOut",d),!d.r)return c.DD(a)},b.TF=function(a){var d,f,h={e:a,r:F};e.Worksheet.ao(b,"preProcessMouseDbClick",h);function j(a,b){var c,d,e=a.kj,f=b.resizeInfo;return!!f&&(f.action===da||f.action===ca?(c=[],e.tp(f.index)?n(e.ITa.getSelections(),function(a,b){var d,f;if(b.col===-1)for(d=e.Tq(b),f=0;f<Ga(d);f++)c.push({row:d.row+f})}):c.push({row:f.index}),e.wu().execute({cmd:"autoFitRow",sheetName:e.name(),rows:c,columnHeader:1===f.sheetArea})):(d=[],e.sp(f.index)?n(e.ITa.getSelections(),function(a,b){var c,f;if(b.row===-1)for(c=e.Tq(b),f=0;f<Fa(c);f++)d.push({col:c.col+f})}):d.push({col:f.index}),e.wu().execute({cmd:"autoFitColumn",sheetName:e.name(),columns:d,rowHeader:2===f.sheetArea})),!0)}h.r||(d=b.yt,d&&(f=!1,3===xa(d)?g(c,a):f=j(c,d),f||b.Wq(i.Events.CellDoubleClick,La(b,b.name(),d.row,d.col,xa(d)))))},d=c.nIb,a.bind(x+"."+d,function(a){return b.OF(a)}).bind(y+"."+d,function(a){return b.QF(a)}).bind(z+"."+d,function(a){return b.PF(a)}).bind(A+"."+d,function(a){return b.RF(a)}).bind(D+"."+d,function(a){return b.SF(a)}).bind(E+"."+d,function(a){return b.TF(a)}),o.mozilla&&(f="onwheel"in document?C:B,a.bind(f+"."+d,function(a){return b.RF(a)})))}}),k.DC.$n("worksheet-event",{preProcessMouseMove:function(a){var b,c=this.OC.getActiveSheet();c&&(b=c.mm,b&&b.eG&&b.OG&&b.isResizing&&(b.BD(a.e),a.r=!1))}})},"./dist/core/worksheet/worksheet-formatter.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/worksheet/style.js"),g=c("./dist/core/util/common.js"),h=c("Common"),d.GC$.extend(e.Worksheet.prototype,{getFormatter:function(a,b,c){return this.tq(a,b,"formatter",c)},setFormatter:function(a,b,c,d){var e=this.Iq(a,b,d);e||(e=new f.Style),e.formatter=c,this.setStyle(a,b,e,d)}}),e.Worksheet.$n("formatter",{settingText:function(a){var b,c=g.util.tl(a.value),d=h.Formatter&&h.Formatter.GeneralFormatter;d&&c&&(b={},(new d).getPreferredDisplayFormatter(a.value,b),"number"==typeof b.value&&(a.value=b.value))}})},"./dist/core/worksheet/worksheet-json.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/worksheet/style.js"),g=f.Style.kxb,h=c("./dist/core/util/common.js"),i=c("./dist/core/util/theme.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/worksheet/stylehelper.js"),l=c("./dist/core/core.enum.js"),m=c("CalcEngine"),n=!!m,o=d.Common.CultureManager,p=e.Worksheet._n,q=h.util.Ol,r=j.GC$.each,s=j.GC$.isEmptyObject,t=d.Common.D,u=d.Common.j.Fa,v="string",w=parseInt,x=isNaN,y=void 0;function z(a,b,c,d){var e,f;if(a.dataTable&&(b.dataTable||(b.dataTable={}),e=a.dataTable[c])){if(b.dataTable[c]||(b.dataTable[c]={}),f=e[d],!f)return;b.dataTable[c][d]||(b.dataTable[c][d]={}),f.formula&&(b.dataTable[c][d].formula=f.formula)}}function A(a,b,c,d){var e,f,g,i=a.ITa,j=i.XTa(),k=i.XTa(l.SheetArea.colHeader),m=i.YTa(!0),n=i.YTa(!0,l.SheetArea.colHeader),o=i.zl(),p=i.zl(l.SheetArea.colHeader),q=j.getColumnCount();for(u(b.colHeaderData)&&(b.colHeaderData={}),k.setRowCount(c),e=0;e<c;e++)for(k.setNode(e,-1,j.RTa(e,-1)),n.Kp(e,m.Jp(e)),f=d;f<q;f++)k.setNode(e,f,j.RTa(e,f)),z(b.data,b.colHeaderData,e,f);g=o.getSpans(h.kf(0,0,c,q)),g.forEach(function(a){p.add(a)}),a.frozenRowCount(0)}function B(a,b,c,d){var e,f,g,i=a.ITa,j=i.XTa(),k=i.XTa(l.SheetArea.rowHeader),m=i.YTa(!1),n=i.YTa(!1,l.SheetArea.rowHeader),o=i.zl(),p=i.zl(l.SheetArea.rowHeader),q=j.getRowCount();for(u(b.rowHeaderData)&&(b.rowHeaderData={}),k.setColumnCount(c),e=0;e<c;e++)for(k.setNode(-1,e,j.RTa(-1,e)),n.Kp(e,m.Jp(e)),f=d;f<q;f++)k.setNode(f,e,j.RTa(f,e)),z(b.data,b.rowHeaderData,f,e);g=o.getSpans(h.kf(0,0,q,c)),g.forEach(function(a){p.add(a)}),a.frozenColumnCount(0)}function C(a,b){switch(a){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===b;case"rowCount":return 200===b;case"columnCount":return 20===b;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===b;case"visible":return b===!0}return!1}function D(a,b){return q(a)?a:b}function E(a,b,c){q(c)&&b.call(a,c,!1)}function F(a,b,c,d,e,f){p&&r(p,function(g,h){var i=h.fromJson;i&&i.call(a,b,c,d,!q(e)||e,f)})}function G(a,b){var c,d,e,f,g,h,i,j,k,l=a.ITa.ZHb.anchors;for(c in l)if(d=+c,e=l[c],f=b[d],e&&f)for(g in e)h=+g,i=e[g],i&&(j=f[h],j&&(k={row:i.row,rowCount:i.rowCount,col:i.col,colCount:i.colCount,isDynamicArray:!0},i.isValid||(k.isInvalid=!0),j.arrayInfo=k))}j.GC$.extend(e.Worksheet.prototype,{qI:function(a,b,c,d){var e,f;a[b]||(a[b]={}),e=a[b],e[c]||(e[c]={}),f=e[c],u(f.value)&&(f.value=d)},$ec:function(a,b){var c,d,f,g,h=this,i=h.ITa,j=i.XTa(),k=i.XTa(l.SheetArea.colHeader),m=i.YTa(!0),n=i.YTa(!0,l.SheetArea.colHeader),o=i.zl(),p=i.zl(l.SheetArea.colHeader),q=h.rowFilter(),r=j.getColumnCount();for(c=0;c<a;c++)for(j.setNode(c,-1,k.RTa(c,-1)),m.Kp(c,n.Jp(c)),d=b;d<r;d++)f=k.RTa(c,d),f||(f={}),f.style=h.getActualStyle(c,d,l.SheetArea.colHeader),j.setNode(c,d,f),g=h.getFormula(c,d,l.SheetArea.colHeader),g&&h.setFormula(c,d,g,l.SheetArea.viewport);p.getSpans().forEach(function(a){o.add(a)}),q&&q.range&&q.range.row===-1&&(q.jXc=!0),h.frozenRowCount(a),i.dWa(e.Worksheet.Vp,r,l.SheetArea.colHeader),i.fWa(!1,l.SheetArea.colHeader),i.eWa(l.SheetArea.colHeader),h.Bj(l.SheetArea.colHeader).clearAll()},Zec:function(a,b){var c,d,f,g,h=this,i=h.ITa,j=i.XTa(),k=i.XTa(l.SheetArea.rowHeader),m=i.YTa(!1),n=i.YTa(!1,l.SheetArea.rowHeader),o=i.zl(),p=i.zl(l.SheetArea.rowHeader),q=j.getRowCount();for(c=0;c<a;c++)for(j.setNode(-1,c,k.RTa(-1,c)),m.Kp(c,n.Jp(c)),d=b;d<q;d++)f=k.RTa(d,c),f||(f={}),f.style=h.getActualStyle(d,c,l.SheetArea.rowHeader),j.setNode(d,c,f),g=h.getFormula(d,c,l.SheetArea.rowHeader),g&&h.setFormula(d,c,g,l.SheetArea.viewport);p.getSpans().forEach(function(a){o.add(a)}),h.frozenColumnCount(a),i.dWa(q,e.Worksheet.Tp,l.SheetArea.rowHeader),i.fWa(!1,l.SheetArea.rowHeader),i.eWa(l.SheetArea.rowHeader),h.Bj(l.SheetArea.rowHeader).clearAll()},toJSON:function(a){var b,c,d,f,g,i,j,m,n,o,q,v,w,x,y,z,A,B,D,E,F,H,I,J=this,K=a&&a.ignoreStyle;a&&!a.Yec&&(b=J.getRowCount(l.SheetArea.colHeader),c=J.getColumnCount(l.SheetArea.rowHeader),d=a.rowHeadersAsFrozenColumns,f=a.columnHeadersAsFrozenRows,g=d&&c>0,i=f&&b>0,g&&J.addColumns(0,c),i&&J.addRows(0,b,i),g&&J.Zec(c,i?b:0),i&&J.$ec(b,g?c:0)),j=J.getRowCount(),m=J.getColumnCount(),n=J.getRowCount(l.SheetArea.colHeader),o=J.getColumnCount(l.SheetArea.rowHeader),q={name:a&&a.newWorkSheetName||J.name(),isSelected:J.DHb(),rowCount:j,columnCount:m,activeRow:J.Jl,activeCol:J.Kl,zoomFactor:J.zoom(),rowHeaderColCount:o,colHeaderRowCount:n,visible:J.visible()},K||(q.frozenRowCount=J.frozenRowCount(),q.frozenColCount=J.frozenColumnCount(),q.frozenTrailingRowCount=J.frozenTrailingRowCount(),q.frozenTrailingColCount=J.frozenTrailingColumnCount(),q.frozenTrailingRowStickToEdge=J.qKc,q.frozenTrailingColumnStickToEdge=J.tKc,q.theme=J.Pm.toJSON()),v=J.ITa,w=v.toJSON(a);for(x in w)q[x]=w[x];p&&r(p,function(b,c){c.toJson&&c.toJson.call(J,q,a)}),y={};for(z in q)t(q,z)&&(A=q[z],u(A)||C(z,A)||(y[z]=A));if(G(J,q.data.dataTable),r(J.options,function(a,b){var c,d,f,g=b;"gridline"===a&&(g={},c=b.color,d=b.showHorizontalGridline,f=b.showVerticalGridline,c&&c!==h.Im.Lm("gc-gridlineColor").borderTopColor&&(g.color=c),d===!1&&(g.showHorizontalGridline=d),f===!1&&(g.showVerticalGridline=f)),"sheetAreaOffset"===a&&(g={},b.left&&(g.left=b.left),b.top&&(g.top=b.top)),"_ps"===a||u(g)||e.Worksheet.Qp[a]===g||"object"==typeof g&&s(g)||(y[a]=g)}),B=[],D=J.Lq,D){for(E in D)t(D,E)&&(F=D[E],F&&(H=F.toJSON(),I=F.font,s(H)||(I&&(H.font=k.To.Jo(I)),B.push(H))));B.length>0&&(y.namedStyles=B)}return y},fromJSON:function(a,b,c,d,h){var j,k,m,p,r,s,u,z,C,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa;if(c&&(j=c.noSchema,k=c.version),a){m=this,p=m.ITa,r=d&&d.ignoreStyle,m.T3(),e.Worksheet.ao(m,"preFromJson"),m.suspendPaint(),p.wgc(),p.xgc(),s=o.culture(),o.culture(""),u=D(a.rowCount,e.Worksheet.Rp),z=D(a.columnCount,e.Worksheet.Sp);try{if(m.cq(a.name+"",!0),m.DHb(a.isSelected),m.setRowCount(u),m.setColumnCount(z),m.Lq={},C=a.namedStyles)for(G=0;G<C.length;G++)H=C[G],I=new f.Style,g(H,m),I.fromJSON(H,j,m),m.Kq(I);J=m.options;for(K in J)if(t(J,K)&&(L=a[K],"protectionOptions"===K?L=L||a.protectionOption:"allowCellOverflow"===K&&(L=q(a[K])?a[K]:!k||k>=11),q(L)))if("object"==typeof L)for(M in L)t(L,M)&&(J[K][M]=L[M]);else"borderWidth"===K?(J.sheetAreaOffset.left=L,J.sheetAreaOffset.top=L):J[K]=L;if(N=D(a.activeRow,m.Jl),O=D(a.activeCol,m.Kl),m.Kr(N,O,y,y,!0),r||(E(m,m.frozenRowCount,a.frozenRowCount),E(m,m.frozenColumnCount,a.frozenColCount),E(m,m.frozenTrailingRowCount,a.frozenTrailingRowCount),E(m,m.frozenTrailingColumnCount,a.frozenTrailingColCount),m.qKc=!q(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,m.tKc=!q(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!r){if(P=a.colStyles)for(Q in P)x(Q)||m.setStyle(-1,w(Q,10),P[Q],l.SheetArea.viewport);if(R=a.rowStyles)for(S in R)x(S)||m.setStyle(w(S,10),-1,R[S],l.SheetArea.viewport)}T=D(a.rowHeaderColCount,e.Worksheet.Tp),U=D(a.colHeaderRowCount,e.Worksheet.Vp),m.setColumnCount(T,l.SheetArea.rowHeader),m.setRowCount(U,l.SheetArea.colHeader),m.XSa(D(a._zoomFactor||a.zoomFactor,m.zoom())),E(m,m.visible,a.visible),V=m.uja,W={sheet:m,setValidator:function(a,b,c){V&&V.vja(a,b,c)},ignoreStyle:r},a.isApplyRefilter||m.JYc(a),p.fromJSON(a,j,W),m.defaults=p.defaults,V&&V.QV(!0),X=a.theme,X&&!r&&(Y=X,typeof Y!==v&&q(Y)&&(Z="_themeColor",$="_name",_=Y.themeColor||Y[Z],aa=new i.ColorScheme(_.name||_[$]),aa.fromJSON(_,j),Y=new i.Theme(Y.name||Y.Cj,aa,Y.headingFont||Y.Vaa,Y.bodyFont||Y.Waa)),m.currentTheme(Y)),F(m,a,j,d,b,h),ba=d&&d.frozenColumnsAsRowHeaders,ca=d&&d.frozenRowsAsColumnHeaders,da=ca?a.frozenRowCount||0:0,ea=ba?a.frozenColCount||0:0,ca&&da>0&&A(m,a,da,ea),ba&&ea>0&&B(m,a,ea,da),n&&(fa=m.yj(),da>0&&(fa.cDc=da),ea>0&&(fa.dDc=ea)),h||(da>0&&m.deleteRows(0,da),ea>0&&m.deleteColumns(0,ea)),m.clearPendingChanges()}finally{o.culture(s),p.ygc(),m.resumePaint()}}},egc:function(a,b,c,d,h){var j,k,m,p,r,s,u,z,C,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;if(c&&(j=c.noSchema,k=c.version),a){m=this,p=m.ITa,r=d.ignoreStyle,m.T3(),e.Worksheet.ao(m,"preFromJson"),p.wgc(),p.xgc(),s=o.culture(),o.culture(""),u=D(a.rowCount,e.Worksheet.Rp),z=D(a.columnCount,e.Worksheet.Sp);try{if(m.Lq={},C=a.namedStyles)for(G=0;G<C.length;G++)H=C[G],I=new f.Style,g(H,m),I.fromJSON(H,j,m),m.Kq(I);J=m.options;for(K in J)if(t(J,K)&&(L=a[K],"protectionOptions"===K?L=L||a.protectionOption:"allowCellOverflow"===K&&(L=q(a[K])?a[K]:!k||k>=11),q(L)))if("object"==typeof L)for(M in L)t(L,M)&&(J[K][M]=L[M]);else"borderWidth"===K?(J.sheetAreaOffset.left=L,J.sheetAreaOffset.top=L):J[K]=L;if(N=D(a.activeRow,m.Jl),O=D(a.activeCol,m.Kl),m.Kr(N,O,y,y,!0),r||(E(m,m.frozenRowCount,a.frozenRowCount),E(m,m.frozenColumnCount,a.frozenColCount),E(m,m.frozenTrailingRowCount,a.frozenTrailingRowCount),E(m,m.frozenTrailingColumnCount,a.frozenTrailingColCount),m.qKc=!q(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,m.tKc=!q(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!r){if(P=a.colStyles)for(Q in P)x(Q)||m.setStyle(-1,w(Q,10),P[Q],l.SheetArea.viewport);if(R=a.rowStyles)for(S in R)x(S)||m.setStyle(w(S,10),-1,R[S],l.SheetArea.viewport)}T=D(a.rowHeaderColCount,e.Worksheet.Tp),U=D(a.colHeaderRowCount,e.Worksheet.Vp),m.setColumnCount(T,l.SheetArea.rowHeader),m.setRowCount(U,l.SheetArea.colHeader),m.XSa(D(a._zoomFactor||a.zoomFactor,m.zoom())),V=m.uja,W={sheet:m,setValidator:function(a,b,c){V&&V.vja(a,b,c)},ignoreStyle:r,incrementalLoading:d.incrementalLoading,incrementLoadTask:d.incrementLoadTask},a.isApplyRefilter||m.JYc(a),p.fromJSON(a,j,W,function(){var c,e,f,g,k,l,t,u,w,x,y;m.defaults=p.defaults,V&&V.QV(!0),c=a.theme,c&&!r&&(e=c,typeof e!==v&&q(e)&&(f="_themeColor",g="_name",k=e.themeColor||e[f],l=new i.ColorScheme(k.name||k[g]),l.fromJSON(k,j),e=new i.Theme(e.name||e.Cj,l,e.headingFont||e.Vaa,e.bodyFont||e.Waa)),m.currentTheme(e)),F(m,a,j,d,b,h),t=d&&d.frozenColumnsAsRowHeaders,u=d&&d.frozenRowsAsColumnHeaders,w=u?a.frozenRowCount||0:0,x=t?a.frozenColCount||0:0,u&&w>0&&A(m,a,w,x),t&&x>0&&B(m,a,x,w),n&&(y=m.yj(),w>0&&(y.cDc=w),x>0&&(y.dDc=x)),h||(w>0&&m.deleteRows(0,w),x>0&&m.deleteColumns(0,x)),m.clearPendingChanges(),o.culture(s),p.ygc(),m.loaded=!0})}finally{}}}})},"./dist/core/worksheet/worksheet-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ga=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/style.js"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/core/util/common.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/core.enum.js"),l=c("CalcEngine"),m=c("./dist/core/celltype/celltype.ns.js"),n=!!l,o=j.GC$.each,p=j.GC$.isEmptyObject,q=j.GC$.extend,r=RegExp("^\\d*(\\.\\d+)?\\*$"),s=null,t=void 0,u="string",v=Math.min,w=Math.floor,x=Math.max,y=Math.ceil,z="dirtyNodes",A="undo",B="rowInfos",C="colInfos",D="default_size",E=f.Common.A,F=f.Common.B,G=f.Common.j.Fa,H=h.util.K_a,I=h.util.n0a,J=h.util.lHb,K=f.Common.j.C4,L=f.Common.j.Na,M=200,N=20,O=new f.Common.ResourceManager(d.SR),P=O.getResource.bind(O);function ha(a,b){return G(a)?b:a}function ia(a,b){return a.hasOwnProperty(b)}function ja(a){return a.rowCount}function ka(a){return a.colCount}function la(a,b,c,d){var e=c;Object.defineProperty(a,b,{get:function(){return e},set:function(a){var c=e;e=a,d(this,a,b,c)}})}function ma(a,b){a.cache={},b&&b.forEach(function(b){na(a,b)})}function na(a,b){var c,d;if(a.Ef=x(a.Ef,b.row+ja(b)-1),a.Ff=x(a.Ff,b.col+ka(b)-1),!a.suspendUpdatingCache)for(c=0;c<b.rowCount;c++)for(d=0;d<b.colCount;d++)a.cache[b.row+c+"_"+(b.col+d)]=b}function oa(a,b){var c,d;if(!a.suspendUpdatingCache)for(c=0;c<b.rowCount;c++)for(d=0;d<b.colCount;d++)a.cache[b.row+c+"_"+(b.col+d)]=t}Q=function(){function a(){la(this,"spans",[],ma),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}return a.prototype.find=function(a,b){return this.cache[a+"_"+b]||s},a.prototype.get=function(a,b){return this.find(a,b)||h.kf(a,b,1,1)},a.prototype.remove=function(a,b){var c=this.spans.indexOf(a);c>=0?(b&&(b[0].push("spans"),b[1]=[].concat(this.spans)),this.removeSpan(c,1),b&&(b[2]=[].concat(this.spans))):b&&(b.length=0)},a.prototype.removeSpan=function(a,b){for(var c=0;c<b;c++)oa(this,this.spans[a+c]);this.spans.splice(a,b)},a.prototype.update=function(a,b){var c=this;oa(c,c.spans[a]),c.spans[a]=b,na(c,b)},a.prototype.add=function(a,b){b&&(b[0].push("spans"),b[1]=[].concat(this.spans)),na(this,a),this.spans.push(a),b&&(b[2]=[].concat(this.spans))},a.prototype.Zz=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p=this,q=!1;for(g&&(i=[].concat(p.spans)),j=p.spans.length,o=[],n=0;n<j;n++)k=p.spans[n],m=k.col,l=k.row,(a===-1||a<=l&&l<a+e)&&(b===-1||b<=m&&m<b+f)?(o.push(h.kf(a===-1?l:c+l-a,b===-1?m:d+m-b,ja(k),ka(k))),q=!0):(a===-1||c<=l&&l<c+e)&&(b===-1||d<=m&&m<d+f)&&(p.removeSpan(n,1),n--,j--,q=!0);for(n=0;n<o.length;n++){if(k=o[n],!p.LTa(p.spans,0,p.spans.length,k))throw Error(P().Exp_OverlappingSpans);p.add(k)}g&&(q?(g[0].push("spans"),g[1]=i,g[2]=[].concat(p.spans)):g.length=0)},a.prototype.LTa=function(a,b,c,d){for(var e=b;e<c&&e<a.length;e++)if(a[e].intersect(d.row,d.col,ja(d),ka(d)))return!1;return!0},a.prototype.getSpans=function(a){var b,c,d,e=this.spans;if(!a)return[].concat(e);for(b=[],c=0;c<e.length;c++)d=e[c],d.intersect(a.row,a.col,ja(a),ka(a))&&b.push(d);return b},a.prototype.qu=function(a,b,c,d){var e,f,g=this.spans;for(e=0;e<g.length;e++)if(f=g[e],f.intersect(a,b,c,d)&&(a!==-1&&(f.row<a||f.row+ja(f)>a+c)||b!==-1&&(f.col<b||f.col+ka(f)>b+d)))return!0;return!1},a.prototype.MTa=function(a,b,c,d){var e,f,g=!1,h=this.spans;for(e=0,f=h.length;e<f;e++){if(a>=0||b>=0)for(;e<f&&!h[e].intersect(a,b,c,d);)e++;if(e<f){g=!0;break}}return g},a.prototype.$b=function(a,b,c,d,e){var f,g,h,i,j,k=this.spans,l=!1;for(e&&(f=[].concat(k)),g=0;g<k.length;g++)h=k[g],i=h.row,j=h.col,(a===-1||a<=i&&i<a+c)&&(b===-1||b<=j&&j<b+d)&&(this.removeSpan(g,1),g--,l=!0);e&&(l?(e[0].push("spans"),e[1]=f,e[2]=[].concat(this.spans)):e.length=0)},a.prototype.aB=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p,q,r=this,s=!1;for(g&&(i=[].concat(r.spans)),j=[],k=[],l=r.spans.length,p=0;p<l;p++)m=r.spans[p],n=m.row,o=m.col,(a===-1||a<=n&&n<a+e)&&(b===-1||b<=o&&o<b+f)?(q=h.kf(a===-1?n:c+n-a,b===-1?o:d+o-b,ja(m),ka(m)),k.push(q),s=!0):(a===-1||c<=n&&n<c+e)&&(b===-1||d<=o&&o<d+f)?s=!0:j.push(m);if(s){if(k.length>0)for(p=0;p<k.length;p++){if(q=k[p],!r.LTa(j,0,j.length,q))throw Error(P().Exp_OverlappingSpans);j.push(q)}for(r.spans.length=0,r.cache={},p=0;p<j.length;p++)r.add(j[p]);g&&(g[0].push("spans"),g[1]=i,g[2]=[].concat(r.spans))}else g&&(g.length=0)},a.prototype.NTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n=this,o=n.spans;for(n.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(o)),f=o.length,g=0;g<f;g++)i=o[g],j=i.row,k=i.col,l=ja(i),m=ka(i),j>=a?(n.update(g,h.kf(j+b,k,l,m)),d=!0):a<j+l&&(n.update(g,h.kf(j,k,l+b,m)),d=!0);n.suspendUpdatingCache=!1,d&&ma(n,o),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(n.spans)):c.length=0)},a.prototype.OTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n=this,o=n.spans;for(n.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(o)),f=o.length,g=0;g<f;g++)i=o[g],j=i.row,k=i.col,l=ja(i),m=ka(i),k>=a?(n.update(g,h.kf(j,k+b,l,m)),d=!0):a<k+m&&(n.update(g,h.kf(j,k,l,m+b)),d=!0);n.suspendUpdatingCache=!1,d&&ma(n,o),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(n.spans)):c.length=0)},a.prototype.PTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this,r=q.spans;for(q.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(r)),f=[],g=r.length,i=0;i<g;i++)j=r[i],k=j.row,l=j.col,m=ja(j),n=ka(j),k>=a?k<a+b?k+m<=a+b?(f.push(i),d=!0):(q.update(i,h.kf(a,l,k+m-(a+b),n)),d=!0):(q.update(i,h.kf(k-b,l,m,n)),d=!0):a<k+m&&(o=h.kf(k,l,m-v(k+m-a,b),n),q.update(i,o),1===o.rowCount&&1===o.colCount&&f.push(i),d=!0);for(i=f.length-1;i>=0;i--)p=f[i],q.removeSpan(p,1);q.suspendUpdatingCache=!1,d&&ma(q,r),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(q.spans)):c.length=0)},a.prototype.QTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this,r=q.spans;for(q.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(r)),f=[],g=r.length,i=0;i<g;i++)j=r[i],k=j.row,l=j.col,m=ja(j),n=ka(j),l>=a?l<a+b?l+n<=a+b?(f.push(i),d=!0):(q.update(i,h.kf(k,a,m,l+n-(a+b))),d=!0):(q.update(i,h.kf(k,l-b,m,n)),d=!0):a<l+n&&(o=h.kf(k,l,m,n-v(l+n-a,b)),q.update(i,o),1===o.rowCount&&1===o.colCount&&f.push(i),d=!0);for(i=f.length-1;i>=0;i--)p=f[i],q.removeSpan(p,1);q.suspendUpdatingCache=!1,d&&ma(q,r),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(q.spans)):c.length=0);
},a.prototype.toJSON=function(){var a=[].concat(this.spans);return 0===a.length?t:a},a.prototype.fromJSON=function(a,b,c){var d,e,f,g,i,j,k;if(a)for(this.spans=[],d=a,e=0;e<d.length;e++)f=d[e],g=ja(f),i=ka(f),j=G(b)?g:v(g,b),k=G(c)?i:v(i,c),this.add(h.kf(f.row,f.col,j,k))},a}(),R=function(){function a(){Array.apply(this,arguments)}return a.prototype.pop=function(){return s},a.prototype.push=function(a){return 0},a.prototype.splice=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c];return s},a.prototype.slice=function(a,b){return null},a}(),R.prototype=[],S=function(a){fa(b,a);function b(){var b=a.call(this)||this;return b.headingOverflowlayouts=s,b.trailingOverflowLayouts=s,b}return b.prototype.find=function(a){var b,c,d=this,e=d.length,f=[];for(c=0;c<e;c++)b=d[c],b.contains(a)&&f.push(b);return f},b}(R),b.np=S,T=function(){function a(a,b,c,d,e,f,g,h,i){var j=this;j.column=a,j.startColumn=b,j.endColumn=c,j.valueWidth=d,j.columnWidth=e,j.backgroundWidth=f,j.backgroundLeftWidth=g,j.backgroundRightWidth=h,j.expandedWidth=i}return a.prototype.contains=function(a){return a>=this.startColumn&&a<=this.endColumn},a}(),b.op=T;function pa(a,b,c){var d,e,f,g,i=h.kf(-1,-1,-1,-1);return a&&(d=a.col,e=a.row,f=e===-1,g=d===-1,i.row=f?0:e,i.rowCount=f?b:ja(a),i.col=g?0:d,i.colCount=g?c:ka(a)),i}U=function(){function a(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return a.prototype.getProperty=function(a){return this[a]},a.prototype.setProperty=function(a,b,c){c&&(c[0].push(a),c[1]=this[a],c[2]=b),this[a]=b},a.prototype.clear=function(a){a&&(a.push(["selections",this.get()]),a.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},a.prototype.add=function(a,b,c,d,e,f){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var g=this,i=g.selectionPolicy,j=g.selectionUnit;0===i?(c=v(c,1),d=v(d,1),g.clear()):1===i&&g.clear(),1===j?(b=-1,d=-1):2===j&&(a=-1,c=-1),g.selections.push(h.kf(a,b,c,d)),f!==!1&&(g.activeSelectedRangeIndex=g.selections.length-1)},a.prototype.get=function(){return[].concat(this.selections)},a.prototype.set=function(a,b){b&&(b.push(["selections",this.get()]),b.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=a,this.activeSelectedRangeIndex>=a.length&&(this.activeSelectedRangeIndex=0)},a.prototype.toJSON=function(){var a,b=this,c={},d=b.selectionPolicy,e=b.selectionUnit,f=b.activeSelectedRangeIndex,g=b.selections.length;for(2!==d&&(c.selectionPolicy=d),0!==e&&(c.selectionUnit=e),0!==f&&(c.activeSelectedRangeIndex=f),c.length=g,a=0;a<g;a++)c[a]=b.selections[a];return p(c)?t:c},a.prototype.fromJSON=function(a,b,c){var d,e,f,g,i,j,k,l,m=b||M,n=c||N;if(a){for(f=this,f.clear(),g=a.selectionPolicy,i=a.selectionUnit,j=a.length,G(j)&&(j=1),k=0;k<j;k++)l=a[k],d=v(l?ja(l):1,m),e=v(l?ka(l):1,n),f.selections.push(h.kf(l?l.row:0,l?l.col:0,d,e));f.activeSelectedRangeIndex=a.activeSelectedRangeIndex||0,G(g)||(f.selectionPolicy=g),G(i)||(f.selectionUnit=i)}},a.prototype.sp=function(a){var b,c,d,e=this.selections;for(b=0;b<e.length;b++)if(c=e[b],d=c.col===-1?0:c.col,c.row===-1&&a>=d&&a<d+ka(c))return!0;return!1},a.prototype.tp=function(a){var b,c,d,e=this.selections;for(b=0;b<e.length;b++)if(c=e[b],d=c.row===-1?0:c.row,c.col===-1&&a>=d&&a<d+ja(c))return!0;return!1},a.prototype.vp=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=!1,p=this.selections,q=f?1:0;for(g=0,h=p.length;g<h&&(i=p[g],j=pa(i,d,e),k=j.row,l=j.col,m=k-q<=a&&a<k+ja(j)+q,n=l-q<=b&&b<l+ka(j)+q,3===c||G(c)?o=m&&n:2===c?o=m:1===c?o=n:0===c&&(o=i.row===-1&&i.col===-1),!o);g++);return o},a.prototype.wp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this.selections,q=!1;for(f=0;f<p.length&&(g=p[f],h=g.row,i=g.col,j=ja(g),k=ka(g),l=i===-1,m=h===-1,G(c)||3===c||(2===c?(n=m?0:h,q=l&&a>=n&&a<n+j):1===c?(o=l?0:i,q=m&&b>=o&&b<o+k):0===c&&(q=m&&l&&j===d&&k===e),!q));f++);return q},a}();function qa(a,b,c,d,e,f){var g,h,i=a.length,j=!1,k=[];for(h=0;h<i;h++)if(g=a[h],j=G(b)||G(c)?G(b)?G(c)?G(d)?g.containsY(e):g.containsX(d):g.col===c:g.row===b:g.contains(b,c)){if(!f)return g;k.push(g)}return f&&k.length>0?k:s}function ra(a,b,c){var d=s,e=a.length,f=!G(b);return e>0&&(d=f?a.findX(b):a.findY(c),d||(d=f&&b<a[0].x||!f&&c<a[0].y?a[0]:a[e-1])),d}V=function(a){fa(b,a);function b(){return a.call(this)||this}return b.prototype.findCell=function(a,b){var c,d,e=this.length;for(d=0;d<e;d++)if(c=this[d],c.contains(a,b))return c;return s},b.prototype.findRow=function(a){var b,c,d=this.length;for(c=0;c<d;c++)if(b=this[c],b.row===a)return b;return s},b.prototype.findCol=function(a){var b,c,d=this.length;for(c=0;c<d;c++)if(b=this[c],b.col===a)return b;return s},b.prototype.findLargestRow=function(a){var b,c,d,e,f=this.length;if(0===f)return s;for(b=0,d=0;d<f;d++)e=this[d],e.row===a&&e.height>b&&(b=e.height,c=d);return L(c)&&this[c]},b.prototype.findLargestCol=function(a){var b,c,d,e,f=this.length;if(0===f)return s;for(b=0,d=0;d<f;d++)e=this[d],e.col===a&&e.width>b&&(b=e.width,c=d);return L(c)&&this[c]},b.prototype.findLargestRange=function(a,b){var c,d,e,f,g,h,i,j,k,l=this.length;if(0===l)return s;for(c=a.row,d=a.col,e=a.rowCount,f=a.colCount,h=0,i=0;i<l;i++)if(b)for(j=a.row;j<c+e;j++)k=this[i],k.row===j&&k.height>h&&(h=k.height,g=i);else for(j=a.col;j<d+f;j++)k=this[i],k.col===j&&k.width>h&&(h=k.width,g=i);return L(g)&&this[g]},b.prototype.findX=function(a,b){return qa(this,t,t,a,t,b)},b.prototype.findY=function(a){return qa(this,t,t,t,a)},b.prototype.findNearX=function(a){return ra(this,a)},b.prototype.findNearY=function(a){return ra(this,t,a)},b.prototype.findXByExactY=function(a,b,c){var d,e,f,g,h,i=this.findX(a,!0);if(!Array.isArray(i))return i;for(d=i.length,e=c.y,f=c.height,g=d-1;g>=0;g--)if(h=i[g],b>e+h.y*f)return h},b}(R),b.yp=V,W=function(){function a(a,b,c,d,e,f,g,h,i){var j=this;j.rowCount=g,j.colCount=h,j.row=a,j.col=b,j.x=c,j.y=d,j.width=e,j.height=f,j.isAutoMerge=i}return a.prototype.contains=function(a,b){var c=this;return a<c.row+ja(c)&&c.row<=a&&b<c.col+ka(c)&&c.col<=b},a.prototype.intersect=function(a){var b=this;return(b.x<0||a.x<b.x+b.width&&b.x<a.x+a.width)&&(b.y<0||a.y<b.y+b.height&&b.y<a.y+a.height)},a.prototype.containsX=function(a){return this.x<=a&&a<this.x+this.width},a.prototype.containsY=function(a){return this.y<=a&&a<this.y+this.height},a}(),b.zp=W;function sa(a,b){var c=a.valuesLoad/a.total;return b?.4*c+.1:.3*c+.1}function ta(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v=e&&e.incrementLoadTask;if(v&&!v.isTerminated){for(i=v.isBusyFunc,g=g||0,j=g,k=!1,l=30,m=new Date;j<c;){if(n=b[j])for(o=0;o<d;o++)p=n[o],p&&(k=!0,za(p,a.RTa(j,o,!0),f,j,o,e));if(j++,i&&i())break;if(q=new Date,q-m>l)break}if(k){if(r=e&&e.sheet,0!==g&&r.parent.getActiveSheet()===r)for(s=g;s<j;s++)if(r.as.viewport[1].findRow(s)){r.repaint();break}t=e&&e.incrementalLoading,t&&t.loading&&(t.loadStatus.valuesLoad+=j-g,u=sa(t.loadStatus,e.doNotRecalculateAfterLoad),t.loading(u,{sheet:r}))}j<c?e.incrementLoadTask.pushTask(ta,[a,b,c,d,e,f,j,h]):h&&e.incrementLoadTask.pushTask(h,[])}}function ua(a,b,c,d,e,f){var g,h,i,j;for(g=0;g<c;g++)if(h=b[g])for(i=0;i<d;i++)j=h[i],j&&za(j,a.RTa(g,i,!0),f,g,i,e)}function va(a,b,c,d,e,f,g,h){if(c>=0&&d>=0){f[c]||(f[c]={});var i=f[c];i[d]=e}else c>=0&&d===-1&&a>=0&&b===-1?g[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(h[d]=e)}function wa(a,b,c,d,e,f,g){if(c>=0&&d>=0){f[c]||(f[c]={}),f[c].rs="e";var h=f[c];h.originalItem=g,h[d]=e}}function xa(a,b,c){var d,e,f,g,h,i={};for(d in a)a[d]&&(e=w(d),!isNaN(e)&&e>=b&&(f=a[e],g=a[e+c],h=i[e],g&&(i[e+c]=g),h?a[e+c]=h:(delete a[e],a[e+c]=f)))}function ya(a,b,c){var d,e,f;for(d in a)a[d]&&(e=Math.floor(d),!isNaN(e)&&e>=b&&(f=a[e],delete a[e],e>=b+c&&(a[e-c]=f)))}X=function(){function a(a,b){var c=this;c.Xj=a,c.OZ=b,c.ad()}return a.prototype.ad=function(){var a=this;a.dataTable={},a.rowDataArray=[],a.columnDataArray=[],a.defaultDataNode=s,a.Ap={},a.gga=0,a.Ff=-1,a.Ef=-1},a.prototype.getRowCount=function(){return this.Xj},a.prototype.getColumnCount=function(){return this.OZ},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.setColumnCount=function(a){this.OZ=a},a.prototype.Cp=function(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.Ap;if(!(l.gga>0)){if(f=this.Ap.KYc,g=a+"_"+b,f&&f[g]){if(f[g].oldCalcValue===c.IV)return;delete f[g]}a>=0&&b>=0&&(d&&(d.type="updateDirty",d.row=a,d.col=b,d.skipUndo=e,m[a]?m[a][b]||(d.isEmptyCol=!0):d.isEmptyRow=!0),m[a]||(m[a]={}),h=m[a],h[b]||(h[b]={}),i=h[b],"n"!==h.rs&&(h.rs="e"),j=c.Dp,k=c.Ep,G(j)||(d&&(d.originalItem=h.originalItem),h.originalItem=j),G(k)||(d&&(d.oldValue=i.oldValue,e&&(d.oldCalcValue=k)),i.oldValue=k))}},a.prototype.gWa=function(a){var b=this.Ap,c=a.row,d=a.col;a.skipUndo&&(this.Ap.KYc=this.Ap.KYc||{},this.Ap.KYc[c+"_"+d]=a),a.isEmptyRow&&b?delete b[c]:a.isEmptyCol&&b[c]?delete b[c][d]:(a.hasOwnProperty("originalItem")&&(G(a.originalItem)&&!G(b[c].originalItem)?delete b[c].originalItem:b[c].originalItem=a.originalItem),a.hasOwnProperty("oldValue")&&b[c]&&(G(a.oldValue)&&!G(b[c][d].oldValue)?delete b[c][d].oldValue:b[c][d].oldValue=a.oldValue))},a.prototype.getValue=function(a,b,c){var d=this.RTa(a,b);return d&&!G(d.value)?1!==c?H(d.value):G(d.value.richText)?d.value:q(!0,{},d.value):s},a.prototype.setValue=function(a,b,c,d,e,f){var g,h=this.RTa(a,b,!0,d?d[0]:t);!h||G(h.value)&&G(c)||h.value===c?d&&(d.length=0):(g=h.value,h.value=c,this.Cp(a,b,{Ep:g,IV:c},e,f),d&&(d[0].push("value"),d[1]=g,d[2]=c))},a.prototype.getStyle=function(a,b,c){var d=this.RTa(a,b),e=d&&d.style;return e&&c&&e.clone&&(e=e.clone(!0)),e},a.prototype.setStyle=function(a,b,c,d){var e,f=this.RTa(a,b,!0,d?d[0]:t);f&&f.style!==c?(e=f.style,f.style=c,d&&(d[0].push("style"),d[1]=e,d[2]=c)):d&&(d.length=0)},a.prototype.getCellState=function(a,b){var c=this.RTa(a,b);return c?c.cellState:s},a.prototype.setCellState=function(a,b,c,d){var e,f,g=this.getCellState(a,b)||0;e=d?g|c:g&~c,0!==e?(f=this.RTa(a,b,!0,t,!0),f&&(f.cellState=e)):(f=this.RTa(a,b),f&&delete f.cellState,p(f)&&(La(this.dataTable,a,b),p(this.dataTable[a])&&delete this.dataTable[a]))},a.prototype.getValueForKey=function(a,b,c){var d=this.RTa(a,b);return d&&d[c]},a.prototype.setValueForKey=function(a,b,c,d,e){var f,g=this.RTa(a,b,!0,e?e[0]:t);g&&g[c]!==d?(f=g[c],g[c]=d,e&&(e[0].push(c),e[1]=f,e[2]=d)):e&&(e.length=0)},a.prototype.NTa=function(a,b,c){var d,e=this,f=e.Xj,g=e.dataTable,h=e.Ap;if(0<=a&&a<=f&&b>=0&&(E(g,f,a,b),E(e.rowDataArray,f,a,b),E(h,f,a,b),e.Xj+=b,!c))for(d=0;d<b;d++)g[a+d]={rs:"n"},h[a+d]={rs:"n"}},a.prototype.STa=function(a,b,c){var d,e,f=this,g=f.Xj;if(0<=a&&a<g&&b>0){if(a+b>g&&(b=g-a),c)for(d=0;d<b;d++)e=a+d,c.push([["dataTable",e],f.dataTable[e]]),c.push([["rowDataArray",e],f.rowDataArray[e]]),c.push([[z,e],f.Ap[e]]);F(f.dataTable,g,a,b),F(f.rowDataArray,g,a,b),F(f.Ap,g,a,b),f.Xj-=b}},a.prototype.OTa=function(a,b){var c,d,e,f=this,g=f.OZ,h=f.Ap;if(0<=a&&a<=g&&b>=0){for(c=0;c<f.Xj;c++)d=f.dataTable[c],d&&a<g&&(E(d,g,a,b),e=h[c],e&&xa(e,a,b));E(f.columnDataArray,g,a,b),f.OZ+=b}},a.prototype.TTa=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.OZ,m=k.Ap;if(0<=a&&a<l&&b>0){for(d=0;d<k.Xj;d++)if(e=k.dataTable[d]){if(c)for(f=0;f<b;f++)g=a+f,c.push([["dataTable",d,g],e[g]]),k.Ap[d]&&c.push([[z,d,g],k.Ap[d][g]]);F(e,l,a,b),h=m[d],ya(h,a,b)}if(c)for(i=0;i<b;i++)j=a+i,c.push([["columnDataArray",j],k.columnDataArray[j]]);F(k.columnDataArray,l,a,b),a+b>l&&(b=l-a),k.OZ-=b}},a.prototype.RTa=function(a,b,c,d,e){var f,g=this,h=g.dataTable,i=g.columnDataArray,j=g.rowDataArray,k=s;return a<g.Xj&&b<g.OZ&&(a>=0&&b>=0?(f=h[a],c&&(f||(f=h[a]={}),!e&&a>g.Ef&&(g.Ef=a)),f&&(k=f[b],c&&(k||(k=f[b]={}),!e&&g.Ff<b&&(g.Ff=b))),d&&d.push("dataTable",a,b)):a===-1&&b>=0?(k=i[b],c&&(k||(k=i[b]={}),!e&&g.Ff<b&&(g.Ff=b)),d&&d.push("columnDataArray",b)):a>=0&&b===-1?(k=j[a],c&&(k||(k=j[a]={}),!e&&g.Ef<a&&(g.Ef=a)),d&&d.push("rowDataArray",a)):a===-1&&b===-1&&(k=g.defaultDataNode,c&&!k&&(k=g.defaultDataNode={}),d&&d.push("defaultDataNode"))),k},a.prototype.setNode=function(a,b,c){var d,e=this,f=e.dataTable,g=e.columnDataArray,h=e.rowDataArray;a<e.Xj&&b<e.OZ&&(a>=0&&b>=0?(d=f[a],d||(d=f[a]={}),d[b]=c):a===-1&&b>=0?g[b]=c:b===-1&&a>=0&&(h[a]=c))},a.prototype._f=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r;e&&(f=[],g=[]),h=this,i=h.dataTable,j=h.rowDataArray,k=h.columnDataArray,l=h.Ap,m=h.RTa(a,b,t,f),n=l[a]&&l[a][b],o=l[a]&&l[a].originalItem,p=h.RTa(c,d,t,g),q=l[c]&&l[c][d],r=l[c]&&l[c].originalItem,e&&(e.push([f,m]),e.push([g,p])),m?va(a,b,c,d,m,i,j,k):p&&va(a,b,c,d,s,i,j,k),p?va(c,d,a,b,p,i,j,k):m&&va(c,d,a,b,s,i,j,k),n?wa(a,b,c,d,n,l,o):q&&wa(a,b,c,d,s,l,o),q?wa(c,d,a,b,q,l,r):n&&wa(c,d,a,b,s,l,r)},a.prototype.Yea=function(a){a++;for(var b=this.Xj,c=this.dataTable;a>=0&&a<b&&!c[a];)a++;return a<b?a:-1},a.prototype.Hl=function(a,b){var c=this,d=s,e=c.OZ;if(a>=0&&a<c.Xj&&(d=c.dataTable[a]),d){for(b++;b>=0&&b<e&&!d[b];)b++;if(b<e)return b}return-1},a.prototype.yIb=function(a){var b,c,d,e,f,g=a.row,h=a.col,i=a.rowCount,j=a.colCount,k=this;for(b=g,c=0;c<i;c++,b++)for(d=h,e=0;e<j;e++,d++)f=k.RTa(b,d),f&&(f.value=s)},a.prototype._Sb=function(a,b,c){var d=c&&c.getFormatter(a,b);return!!J(d)&&d},a.prototype.clear=function(a,b,c,d,e,g,h){var i,j,k,l,m,n,o,p=this,q=p.Xj,r=p.OZ,u=[],w=!!h,x=[];if(a>=0&&b>=0){if(c=v(c,q-a),d=v(d,r-b),c>0&&d>0)for(k=a;k<a+c;k++)if(!g||f.Common.k.Cb(g,k)<0)for(j=b;j<b+d;j++)w&&(l=[]),i=p.RTa(k,j,t,l),i&&(u.push(i),w&&x.push(l),(1&e)>0&&!G(i.value)&&(m=void 0,w&&(m={}),p.Cp(k,j,{Ep:i.value},m),m&&h.push(m)))}else if(a>=0&&b===-1){if(c=v(c,q-a),c>0)for(k=a;k<a+c;k++)w&&(l=[]),i=p.RTa(k,-1,t,l),i&&(u.push(i),w&&x.push(l))}else if(a===-1&&b>=0){if(d=v(d,r-b),d>0)for(j=b;j<b+d;j++)w&&(l=[]),i=p.RTa(-1,j,t,l),i&&(u.push(i),w&&x.push(l))}else a===-1&&b===-1&&(w&&(l=[]),i=p.RTa(-1,-1,t,l),i&&(u.push(i),w&&x.push(l)));for(n=function(a){if(i=u[a]){var b=w?[]:t;(8&e)>0&&(b&&b.push(["tag",i.tag]),i.tag=s),(2&e)>0&&(b&&b.push(["style",i.style]),i.style=s),(1&e)>0&&(b&&b.push(["value",i.value]),i.value=s),(16&e)>0&&(b&&b.push(["sparkline",i.sparkline]),i.sparkline=s),(64&e)>0&&(b&&b.push(["bindingPath",i.bindingPath]),i.bindingPath=s),(256&e)>0&&(b&&b.push(["hyperlink",i.hyperlink]),i.hyperlink=s),(4&e)>0&&(b&&b.push(["comment",i.comment]),i.comment=s),w&&b.forEach(function(b){var c=[].concat(x[a]);c.push(b[0]),b[0]=c,h.push(b)})}},o=0;o<u.length;o++)n(o)},a.prototype.toJSON=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,q,r,u,v,w,x,y,z,A,B,C,D=c&&c.parent&&!p(c.parent.QHb);function E(a,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r;return e?(i={},j=e.value,G(j)||(i.value=j),b&&b.saveAsView&&(k=void 0,h?k=h:D&&(k=c&&c.getFormatter(a,d)),J(k)&&(l=c.aHb(a,d,k,j),G(l)||(i.value=l))),m=b&&b.ignoreStyle,m||(n=e.style,"string"==typeof n?i.style=n:n&&(o=n.toJSON(f,g),o&&(o.name=t,o.fontForColumnWidth=n.fontForColumnWidth,i.style=o))),p=e.bindingPath,G(p)||(i.bindingPath=p),q=e.tag,G(q)||(i.tag=q),r=e.hyperlink,G(r)||(i.hyperlink=K(r),delete i.hyperlink.isVisited),i):s}if(d=this,e={},f={},g=d.Xj,h=d.OZ,i=d.dataTable,j=d.rowDataArray,k=d.columnDataArray,b&&b.saveAsView)for(n=0;n<g;){for(o={},q=!1,r=i[n],u=0;u<h;)v={},r&&r[u]||k[u]?v=E(n,u,d.RTa(n,u,!0)):3===a&&D&&(w=this._Sb(n,u,c),w&&(v=E(n,u,d.RTa(n,u,!0),3,!1,w))),p(v)||(o[u]=v,q=!0),u++;q&&(f[n]=o),n++}else for(l=d.Yea(-1);l>=0;){for(o={},q=!1,m=d.Hl(l,-1);m>=0;)x=d.RTa(l,m),x&&(v=E(l,m,x),p(v)||(o[m]=v,q=!0)),m=d.Hl(l,m);q&&(f[l]=o),l=d.Yea(l)}for(p(f)||(e.dataTable=f),y=[],l=0;l<g;l++)ia(j,l)&&j[l]&&(z=E(l,-1,j[l]),p(z)||(y[l]=z));for(y.length>0&&(e.rowDataArray=y),A=[],m=0;m<h;m++)ia(k,m)&&k[m]&&(B=E(-1,m,k[m]),p(B)||(A[m]=B));return A.length>0&&(e.columnDataArray=A),C=E(-1,-1,d.defaultDataNode,a,!0),p(C)||(e.defaultDataNode=C),e},a.prototype.fromJSON=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=c&&c.incrementalLoading;if(!a)return void(q&&e&&setTimeout(e,0));if(f=this,f.ad(),f.gga++,g=a.dataTable,j=f.Xj,k=f.OZ,g?q&&3===d?ta(f,g,j,k,c,b,t,e):ua(f,g,j,k,c,b):q&&e&&setTimeout(e,0),n=a.rowDataArray||a.Hf)for(h=0;h<j;h++)ia(n,h)&&n[h]&&za(n[h],f.RTa(h,-1,!0),b,h,-1,c);if(o=a.columnDataArray||a.If)for(i=0;i<k;i++)ia(o,i)&&o[i]&&za(o[i],f.RTa(-1,i,!0),b,-1,i,c);p=a.defaultDataNode||a.Jf,p&&za(p,f.RTa(-1,-1,!0),b,-1,-1,c),f.gga--},a}(),Y=function(){function a(){this.infos=[]}return a.prototype.WLc=function(a,b){var c=this.infos,d=c[a];return!d&&b&&(d=c[a]={}),d},a.prototype.uL=function(a,b){var c=this.infos,d=c.length;0<=a&&a<=d&&b>0&&E(c,d,a,b)},a.prototype.UTa=function(a,b,c){var d,e,f=this.infos,g=f.length;if(0<=a&&a<g&&b>0){if(b=v(b,g-a),c)for(d=0;d<b;d++)e=a+d,c.push([["infos",e],f[e]]);F(f,g,a,b)}},a.prototype.VTa=function(){return this.infos.length},a.prototype.Hp=function(){return this.infos},a.prototype.Jp=function(a){return this.infos[a]},a.prototype.Kp=function(a,b,c){var d=this.infos[a];this.infos[a]=b,c&&(c[0].push("infos",a),c[1]=d,c[2]=b)},a.prototype.getSize=function(a){var b=this.infos[a],c=s;return b&&(b.visible===!1?c=0:"number"==typeof b.size&&(c=w(b.size))),c},a.prototype.getColumnHeaderFitMode=function(a){var b=this.infos[a],c=k.ColumnHeaderFitMode.normal;return b&&(c=b.columnHeaderFitMode||c),c},a.prototype.setColumnHeaderFitMode=function(a,b,c){var d=this.WLc(a,!0),e=d.columnHeaderFitMode;e!==b&&(d.columnHeaderFitMode=b),c&&(c[0].push("infos",a,"columnHeaderFitMode"),c[1]=e)},a.prototype.getActualSize=function(a){var b=this.infos[a];return b?w(b.size):s},a.prototype.setSize=function(a,b,c){var d=this.WLc(a,!0),e=d.size;e!==b&&(d.size=b),c&&(c[0].push("infos",a,"size"),c[1]=e,c[2]=b)},a.prototype.getStarSize=function(a){var b=this.infos[a];return b?b.starSize:t},a.prototype.setStarSize=function(a,b,c){var d=this.WLc(a,!0),e=d.starSize;G(b)&&G(e)||(e!==b&&(G(b)?delete d.starSize:d.starSize=b),c&&(c[0].push("infos",a,"starSize"),c[1]=e,c[2]=b))},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,j,k=this.infos,l=[];if(a&&a.ignoreStarSize)for(b=0;b<k.length;b++)G(k[b])||(c=k[b],d=c.cellType,e=ga(c,["cellType"]),l[b]=K(e),d&&(d.toJSON&&(d=d.toJSON()),f=m._o,g=d.typeName,h=f[d.type]||f[g]||i.getTypeFromString(g),h&&(j=new h,j.fromJSON(d,a),l[b].cellType=j)),delete l[b].starSize);else for(b=0;b<k.length;b++)G(k[b])||(l[b]=k[b]);return l.length>0?l:t},a.prototype.fromJSON=function(a){a&&(this.infos=a)},a}(),Z=Y.prototype,o({visible:!0,resizable:!0,pageBreak:!1},function(a,b){var c=a[0].toUpperCase()+a.substr(1);Z["get"+c]=function(c){var d=b,e=this.infos[c];return e&&!G(e[a])&&(d=e[a]),d},Z["set"+c]=function(b,c,d){var e=this.WLc(b,!0),f=e[a];f!==c&&(e[a]=c),d&&(d[0].push("infos",b,a),d[1]=f,d[2]=c)}});function za(a,b,c,d,f,h){var j,k,l,m,o,p,q,r,v,w,x;a&&(j=a.value,j!==t&&(j=j,j!==s&&(j._calcError||j._error&&!G(j._code))&&(k=n&&g.CalcError.parse(j._calcError||j._error),k!==t&&(k=I(k),j=k)),b.value=j),l=a.style,m=h&&h.sheet,l===t||h.ignoreStyle||(o=s,typeof l===u?(b.style=l,o=m&&(m.Mq(l,!1)||m.parent&&m.parent.Mq(l,!1))):l&&(o=new e.Style,o.fromJSON(l,c),o.name=t,b.style=o),o&&o.validator&&h&&h.setValidator&&h.setValidator(d,f,o.validator)),p=a.visualState,p!==t&&(b.visualState=p),q=a.bindingPath,q!==t&&(b.bindingPath=q),r=a.tag,r!==t&&r!==s&&(v=r.typeName,typeof v===u&&(w=i.getTypeFromString(v),w&&(r=new w,r.fromJSON&&r.fromJSON(a.tag))),b.tag=r),x=a.hyperlink,x!==t&&(b.hyperlink=K(x)))}$=20,_=62,aa=40,ba=20;function Aa(a,b){for(var c,d,e,f,g,h=b[0],i=a,j=0;j<h.length-1;j++)c=h[j],c===z?i=i.Ap:(i[c]||(i[c]={}),i=i[c]);i[h[j]]=b[1],d=h[h.length-1],f=h[h.length-2],g=h[1],"size"===d?e=h[0]===B?k.AxisInfoChangeType.setRowHeight:k.AxisInfoChangeType.setColumnWidth:"visible"===d&&(e=h[0]===B?k.AxisInfoChangeType.setRowVisible:k.AxisInfoChangeType.setColumnVisible),G(e)||a.zgc({type:e,index:f,sheetArea:g})}function Ba(a,b,c){var d=a.WTa>0?[["selectionModel"],t]:t;a.selectionModel.setProperty(b,c,d),d&&a.zTa.push(d)}function Ca(a,b,c,d,e){void 0===e&&(e=!1);var f=a[b];return e?void(f&&delete f[c]):(f||(f=a[b]={}),void(f[c]=d))}function Da(a,b,c,d){Ca(a,b,c,{value:d})}function Ea(a,b,c,d,e,f){Ca(a,b,c,{value:d,oldValue:e,isAnchorCell:f})}function Fa(a,b,c,d){var e,f=a[b],g=f&&f[c];return g?g.value:(e=d.getValue(b,c),Da(a,b,c,e),e)}function Ga(a,b){return[a,b].join(",")}function Ha(a,b){a.indexOf(b)===-1&&a.push(b)}function Ia(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]===b&&a[d][1]===c)return void 0!==a[d][2];return!0}function Ja(a,b,c){var d=a[b];return d&&d[c]}function Ka(a,b){var c=b.split(",").map(function(a){return+a}),d=c[0],e=c[1],f=a[d];return f&&f[e]}function La(a,b,c,d){var e=a[b];e&&delete e[c],d&&p(e)&&delete a[b]}ca=5e5,da=function(){function a(a){this.modelManager=a,this.anchors={},this.cells={},this.invalidAnchors={}}return a.prototype.no=function(){this.modelManager=s},a.prototype.getAnchorCell=function(a,b){return Ja(this.anchors,a,b)},a.prototype.getAnchorItem=function(a,b){return Ja(this.cells,a,b)},a.prototype.getAnchorInfo=function(a,b,c){var d,e,f,g,h=this,i=h.anchors,j=h.getAnchorCell(a,b);if(j)return j;if(d=h.getAnchorItem(a,b)){e=d.anchorRefs;for(f in e)if(e[f]&&(g=Ka(i,f),c||g.isValid))return g}},a.prototype.isCellHasItsOwnValue=function(a,b,c){var d,e,f,g,h=this,i=h.getAnchorItem(a,b);if(i){if(!G(i.value)||i.AIb)return!0;d=i.anchorRefs,e=h.anchors;for(f in d)if(c!==f&&d[f]&&(g=Ka(e,f),g&&g.isValid))return!0}return!1},a.prototype.removeRef=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r,t=this,u=t.cells,v=b.isValid,w=b.row,x=b.col,y=b.rowCount,z=b.colCount,A=1;for(g=0,h=w;g<y;g++,h++){for(i=x+A;A<z;A++,i++){if(j=Ja(u,h,i),k=j&&j.anchorRefs,l=!0,v){if(m=a.getValue(h,i),n=j&&j.value,G(n)){if(o=j&&j.AIb,q=!o||o===c,k)for(r in k)if(r!==c&&k[r]){l=!1;break}q?Ea(d,h,i,s,m,b.row===h&&b.col===i):n=m}e&&Da(e,h,i,n)}k&&(delete k[c],l&&f&&p(k)&&La(u,h,i,!0))}A=0}},a.prototype.BIb=function(a,b,c,d,e){var f,g,i,j=a.getRowCount(),k=a.getColumnCount();return!(b+d>j||c+e>k)&&(!(d*e>ca)&&(f=a.getSheet(),g=h.kf(b,c,d,e),!f.ITa.getSpans(g).length&&(i=f.tables,!(i&&i.rn&&i.rn(b,c,d,e)))))},a.prototype.setArray=function(a,b,c,d,e,f,h){var i,j,k,l,m,o,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F=this,H=Ga(b,c),I=F.anchors,J=Ja(I,b,c),K=F.cells;if(J&&!f)return i=F.updateItem(a,b,c),j=i[0],k=i[1],[J,j,k];if(l={},m={},o=!1,J&&J.isValid&&(o=!0,F.removeRef(a,J,H,l,m,!0)),p=J,J={row:b,col:c,rowCount:d,colCount:e,values:f,isValid:!1},Ca(I,b,c,J),q=a.getCalcService().CIb,J.CIb=q,r=p&&p.CIb===q&&(d!==p.rowCount||e!==p.colCount),t=a.q$a,u=t&&Ja(F.invalidAnchors,b,c))Ea(l,b,c,n&&g.Errors.Spill,s,J.row===b&&J.col===c),F.DIb(b,c,d,e,K,t,m,a,H,!0);else if(f){if(v=Fa(m,b,c,a),w=!r&&F.BIb(a,b,c,d,e),w&&(F.DIb(b,c,d,e,K,t,m,a,H),!t&&!h))for(x=1,y=0,z=b;y<d;y++,z++){for(A=c+x;x<e;x++,A++)if(B=Fa(m,z,A,a),!G(B)&&F.isCellHasItsOwnValue(z,A,H)){if(w=!1,!o)break;Ca(l,z,A,B,!0)}if(!o&&!w)break;x=0}if(w)for(y=0,z=b;y<d;y++,z++)for(C=f[y],x=0,A=c;x<e;x++,A++)B=Fa(m,z,A,a),D=C&&C[x],E=D,G(D)?E=0:n&&(g.Convert.Ca(D)||g.Convert.Fh(D))&&(E=1===D.getRowCount()&&1===D.getColumnCount()?g.Convert.Ca(D)?D.getValue(0,0):D.getValue(0,0,0):g.Errors.Calc),Ea(l,z,A,E,B,J.row===z&&J.col===A),(y||x)&&(Ja(K,z,A).AIb=H);else Ea(l,b,c,n&&g.Errors.Spill,v,J.row===b&&J.col===c);J.isValid=w,p&&w!==p.isValid&&F.modelManager.EIb(b,c,!w)}return[J,l,[p]]},a.prototype.DIb=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o=1;for(k=0;k<c;k++){for(l=a+k;o<d;o++)m=b+o,n=!j&&Ja(e,l,m),n||(n={anchorRefs:{}},f&&!j||(n.value=Fa(g,l,m,h)),Ca(e,l,m,n)),n.anchorRefs[i]=!0;o=0}},a.prototype.updateItem=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;if(void 0===e&&(e={}),void 0===f&&(f=[]),g=Ga(b,c),h=this,i=h.anchors,j=Ja(i,b,c),j&&(h.removeRef(a,j,g,e,t,!0),La(e,b,c),La(i,b,c,!0)),k=h.cells,l=Ja(k,b,c),l){h.modelManager.FIb(b,c,l.value),l.value=d,delete l.AIb,m=l.anchorRefs;for(n in m)m[n]&&(o=Ka(i,n),Ha(f,o))}if(j||l)return[j&&e,f]},a.prototype.GIb=function(a,b){Ca(this.invalidAnchors,a,b,!0)},a.prototype.HIb=function(){this.invalidAnchors={}},a.prototype.IIb=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.anchors,m=[];for(d in l)if(l.hasOwnProperty(d)){e=+d,f=e>=b,g=l[d];for(h in g)g.hasOwnProperty(h)&&(i=+h,f||(j=g[h],f=j&&j.rowCount+e>=b),f&&m.push([e,i]))}m.length&&m.forEach(function(b){k.updateItem(a,b[0],b[1],t)})},a.prototype.NTa=function(a,b,c){this.IIb(a,b,c)},a.prototype.PTa=function(a,b,c){this.IIb(a,b,c)},a.prototype.JIb=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.anchors,l=[];for(c in k)if(k.hasOwnProperty(c)){d=+c,e=k[c];for(f in e)e.hasOwnProperty(f)&&(g=+f,h=g>=b,h||(i=e[f],h=i&&i.colCount+g>=b),h&&l.push([d,g]))}l.length&&l.forEach(function(b){j.updateItem(a,b[0],b[1],t)})},a.prototype.OTa=function(a,b,c){this.JIb(a,b)},a.prototype.QTa=function(a,b,c){this.JIb(a,b)},a}(),b.KIb=da;function Ma(a,b,c,d,e){var f,h,i,j,k,l,m,n,o=a.XTa(3),p=a.ZHb,q=p.anchors,r=[];for(f in q)if(q.hasOwnProperty(f)&&(h=q[f]))for(i in h)h.hasOwnProperty(i)&&(j=h[i],j&&(k=j.row,l=j.col,m=j.rowCount,n=j.colCount,(e?k+m:l+n)>=b&&(j.isValid&&o.yIb(j),(e?k:l)<b&&r.push(j))));r.length&&g.markAnchorCellDirty(r,a.kj.Bj(),p)}b.clearSpillValuesOnAddRemove=Ma;function Na(a){return a?a.filter(function(a){return!a.isAutoMerge}):a}ea=function(){function a(b,c,d,e,f,g){var h,i,j,k;this.LIb=[],h=this,h.kj=b,h.sheetModels=[t,new X(e,d),new X(c,f),new X(c,d)],i=h.rowInfos=[],i[0]=i[1]=new Y,i[2]=i[3]=new Y,j=h.colInfos=[],j[0]=j[2]=new Y,j[1]=j[3]=new Y,h.spanModels=[t,new Q,new Q,new Q],h.selectionModel=new U,h.ZHb=new da(h),h.name=g||"",h.isSelected=!1,h.zoomFactor=1;function l(a,b,c,d){h.WTa>0&&h.zTa.push([["defaults",c],d,b]),h.kj.$p()}k=h.defaults={},la(k,"rowHeight",$,l),la(k,"colWidth",_,l),la(k,"rowHeaderColWidth",aa,l),la(k,"colHeaderRowHeight",ba,l),la(k,"_isExcelDefaultColumnWidth",!1,l),h.WTa=0,a.ao(this,"init"),h.Agc(c,d)}return a.prototype.Agc=function(a,b){var c=this;c.zgc({type:k.AxisInfoChangeType.setRowCount,count:a}),c.zgc({type:k.AxisInfoChangeType.setColumnCount,count:b})},a.prototype.zgc=function(a){var b,c,d,e,f,g,h,i,j,l=this,m=l.kj,n=a.type,o=a.sheetArea,p=void 0===o?k.SheetArea.viewport:o;if(p===k.SheetArea.viewport){if(G(l.Bgc)&&(l.Bgc=[]),G(l.Cgc)&&(l.Cgc=[]),l.Dgc)return void l.Egc(a);switch(b=l.Bgc,c=l.Cgc,n){case k.AxisInfoChangeType.deleteRows:d=a.index,e=a.count,b.splice(d,e);break;case k.AxisInfoChangeType.deleteColumns:d=a.index,e=a.count,c.splice(d,e);break;case k.AxisInfoChangeType.setRowHeight:case k.AxisInfoChangeType.setRowVisible:d=a.index,f=a.value,b[d]=f;break;case k.AxisInfoChangeType.setColumnWidth:case k.AxisInfoChangeType.setColumnVisible:d=a.index,f=a.value,c[d]=f;break;case k.AxisInfoChangeType.filterRows:for(g=a.index,h=0,i=g;h<i.length;h++)d=i[h],f=m.getRowHeight(d),b[d]=f;break;case k.AxisInfoChangeType.outlineExpandRows:for(g=a.index,j=0;j<g.length;j++)d=g[j],f=m.getRowHeight(d),b[d]=f;break;case k.AxisInfoChangeType.outlineExpandColumns:for(g=a.index,j=0;j<g.length;j++)d=g[j],f=m.getColumnWidth(d),c[d]=f}}},a.prototype.Fgc=function(a){if(this.Bgc){var b=this.Bgc[a];return G(b)?this.defaults.rowHeight:b}},a.prototype.Ggc=function(a){if(this.Cgc){var b=this.Cgc[a];return G(b)?this.defaults.colWidth:b}},a.prototype.wgc=function(){this.Dgc=[]},a.prototype.ygc=function(){var a,b,c,d=this,e=d.Dgc;if(d.Dgc=s,e)for(a=0,b=e;a<b.length;a++)c=b[a],d.zgc(c)},a.prototype.Egc=function(a){this.Dgc&&this.Dgc.push(a)},a.prototype.xgc=function(){var a=this;a.Bgc=s,a.Cgc=s},a.prototype.no=function(b){if(b!==!1){var c=this;c.kj=s,c.sheetModels=s,c.ZHb&&(c.ZHb.no(),c.ZHb=s),c.xgc()}a.ao(this,"dispose",{clearCache:b})},a.prototype.addRows=function(b,c,d,e){var f,g=this;g.WTa>0&&(f={row:b,rowCount:c,type:"addRows"},g.zTa.push(f)),g.XTa(3).NTa(b,c,e),g.XTa(2).NTa(b,c,e),g.zl(3).NTa(b,c),g.zl(2).NTa(b,c),g.YTa(!0,3).uL(b,c),n&&g.ZHb.NTa(g.kj.yj(),b,c),d||a.ao(g,"addRows",{row:b,rowCount:c,changes:g.zTa}),g.zgc({type:k.AxisInfoChangeType.addRows,index:b,count:c})},a.prototype.ZTa=function(b){var c=this,d=b.row,e=b.rowCount;Ma(c,d,e,!1,!0),c.deleteRows(d,e,!0),a.ao(c,"undoAddRows",{row:d,rowCount:e})},a.prototype.deleteRows=function(b,c,d){var e,f,g,h,i,j,l,m,o,p=this;if(p.WTa>0&&(f=[],g=[],h=[["spanModels",3],t],i=[["spanModels",2],t],j=[],e={row:b,rowCount:c,type:"deleteRows"},p.zTa.push(e)),p.XTa(3).STa(b,c,f),p.XTa(2).STa(b,c,g),p.zl(3).PTa(b,c,h),p.zl(2).PTa(b,c,i),p.YTa(!0,3).UTa(b,c,j),n&&p.ZHb.PTa(p.kj.yj(),b,c),d||a.ao(p,"deleteRows",{row:b,rowCount:c,changes:p.zTa}),e){for(l=e.changes=[],m=["sheetModels",3],o=0;o<f.length;o++)f[o][0]=m.concat(f[o][0]),l.push(f[o]);for(m=["sheetModels",2],o=0;o<g.length;o++)g[o][0]=m.concat(g[o][0]),l.push(g[o]);for(h.length>0&&l.push(h),i.length>0&&l.push(i),m=[B,3],o=0;o<j.length;o++)j[o][0]=m.concat(j[o][0]),l.push(j[o])}p.zgc({type:k.AxisInfoChangeType.deleteRows,index:b,count:c})},a.prototype.$Ta=function(a){var b,c,d,e=this,f=a.row,g=a.rowCount;for(Ma(e,f,g,!0,!0),e.addRows(f,g,!0,!0),b=a.changes,c=b.length-1;c>=0;c--)Aa(e,b[c]);d=e.kj&&e.kj.Ts,d&&d.splice(d.length-g,g)},a.prototype.addColumns=function(b,c,d){var e,f=this;f.WTa>0&&(e={col:b,colCount:c,type:"addColumns"},f.zTa.push(e)),f.XTa(3).OTa(b,c),f.XTa(1).OTa(b,c),f.zl(3).OTa(b,c),f.zl(1).OTa(b,c),f.YTa(!1,3).uL(b,c),n&&f.ZHb.OTa(f.kj.yj(),b,c),d||a.ao(f,"addColumns",{col:b,colCount:c,changes:f.zTa}),f.zgc({type:k.AxisInfoChangeType.addColumns,index:b,count:c})},a.prototype._Ta=function(a){var b=this,c=a.col,d=a.colCount;Ma(b,c,d,!1,!1),b.deleteColumns(c,d,!0)},a.prototype.deleteColumns=function(b,c,d){var e,f,g,h,i,j,l,m,o,p=this;if(p.WTa>0&&(f=[],g=[],h=[["spanModels",3],t],i=[["spanModels",1],t],j=[],e={col:b,colCount:c,type:"deleteColumns"},p.zTa.push(e)),p.XTa(3).TTa(b,c,f),p.XTa(1).TTa(b,c,g),p.zl(3).QTa(b,c,h),p.zl(1).QTa(b,c,i),p.YTa(!1,3).UTa(b,c,j),n&&p.ZHb.QTa(p.kj.yj(),b,c),d||a.ao(p,"deleteColumns",{col:b,colCount:c,changes:p.zTa}),e){for(l=e.changes=[],m=["sheetModels",3],o=0;o<f.length;o++)f[o][0]=m.concat(f[o][0]),l.push(f[o]);for(m=["sheetModels",1],o=0;o<g.length;o++)g[o][0]=m.concat(g[o][0]),l.push(g[o]);for(h.length>0&&l.push(h),i.length>0&&l.push(i),m=[C,3],o=0;o<j.length;o++)j[o][0]=m.concat(j[o][0]),l.push(j[o])}p.zgc({type:k.AxisInfoChangeType.deleteColumns,index:b,count:c})},a.prototype.aUa=function(a){var b,c,d=this,e=a.col,f=a.colCount;for(Ma(d,e,f,!0,!1),d.addColumns(e,f,!0),b=a.changes,c=b.length-1;c>=0;c--)Aa(d,b[c])},a.prototype.getRowCount=function(a){return this.XTa(a).getRowCount()},a.prototype.setRowCount=function(a,b,c){var d=this,e=d.getRowCount(b);d.WTa>0&&d.zTa.push({oldRowCount:e,sheetArea:b,type:"setRowCount"}),3===b||2===b?(e>a&&d.deleteRows(a,e-a,c),d.XTa(3).setRowCount(a),d.XTa(2).setRowCount(a)):1===b&&(e>a&&d.YTa(!0,b).UTa(a,e-a),d.XTa(b).setRowCount(a)),d.zgc({type:k.AxisInfoChangeType.setRowCount,count:a,sheetArea:b})},a.prototype.LYc=function(a){var b=this;b.XTa(3).setRowCount(a),b.XTa(2).setRowCount(a),b.zgc({type:k.AxisInfoChangeType.setRowCount,count:a,sheetArea:3})},a.prototype.bUa=function(a){this.setRowCount(a.oldRowCount,a.sheetArea,!0)},a.prototype.getColumnCount=function(a){return this.XTa(a).getColumnCount()},a.prototype.setColumnCount=function(a,b,c){var d=this,e=d.getColumnCount(b);d.WTa>0&&d.zTa.push({oldColCount:e,sheetArea:b,type:"setColumnCount"}),3===b||1===b?(e>a&&d.deleteColumns(a,e-a,c),d.XTa(3).setColumnCount(a),d.XTa(1).setColumnCount(a)):2===b&&(e>a&&d.YTa(!1,b).UTa(a,e-a),d.XTa(b).setColumnCount(a)),d.zgc({type:k.AxisInfoChangeType.setColumnCount,count:a,sheetArea:b})},a.prototype.cUa=function(a){this.setColumnCount(a.oldColCount,a.sheetArea,!0)},a.prototype.getLastNonNullRow=function(a,b){var c=b?0:this.YTa(!0,a).VTa()-1;return x(this.XTa(a).Ef,this.zl(a).Ef,c)},a.prototype.getLastNonNullCol=function(a,b){var c=b?0:this.YTa(!1,a).VTa()-1;return x(this.XTa(a).Ff,this.zl(a).Ff,c)},a.prototype.$Gb=function(){var a=this,b=a.kj,c=0!==b.Dr().height&&a._Gb(!0,b.defaults.rowHeight),d=0!==b.Dr().width&&a._Gb(!1,b.defaults.colWidth);function e(a,c){var d,e,f,g,h=c.length;for(d=0;d<h;d++)e=c[d][0],f=c[d][1],g=c[d][2],g!==f&&(a?b.kq(e,3,"height",f,g):b.pq(e,3,"width",f,g))}c&&e(!0,c),d&&e(!1,d)},a.prototype._Gb=function(a,b){var c,d,e,f,g,h,i,j,l,m,n,o,p,q,s,t,u,v,x=this,z=x.kj,A=[],B=z.zoom(),C=a?z.getRowCount():z.getColumnCount(),D=x.YTa(a,3),E=0,F=0;
if(z.Gt&&(F=a?z.Gt().height:z.Gt().width),a){if(z.options.colHeaderVisible)for(d=0;d<z.getRowCount(1);d++)E+=y(B*z.getRowHeight(d,1));c=z.Dr().height-z.options.sheetAreaOffset.top-F-E}else{if(z.options.rowHeaderVisible)for(d=0;d<z.getColumnCount(2);d++)E+=y(B*z.getColumnWidth(d,2));c=z.Dr().width-z.options.sheetAreaOffset.left-F-E}for(e=[],f=[],g=[],h=0,i=a?z.getRowVisible:z.getColumnVisible,d=0;d<C;d++)if(j=i.call(z,d),l=z.ITa.getSize(a,3,d),m=z.ITa.getStarSize(a,3,d),r.test(m))n="*"===m?1:parseFloat(m.replace("*","")),j&&n>0?(h+=n,e.push(d),f.push(n),g.push(l)):A.push([d,0,l]);else if(l="number"==typeof l?Math.floor(l):b,j&&(c-=y(B*l),c<1))return;if(!(h+A.length===0||c<1)){for(o=e.length,d=0;d<o-1;d++)if(p=c/h/B,n=f[d],l=w(p*n),q=y(B*l),A.push([e[d],l,g[d]]),c-=q,h-=n,q<1||c<1)return;for(s=y((c-1e-4)/B),A.push([e[o-1],s,g[o-1]]),d=0;d<A.length;d++)t=A[d][0],u=A[d][1],D.setSize(t,u),v=a?k.AxisInfoChangeType.setRowHeight:k.AxisInfoChangeType.setColumnWidth,x.zgc({type:v,index:t});return A}},a.prototype.setCellState=function(a,b,c,d,e){var f=this.XTa(e);f&&f.setCellState(a,b,c,d)},a.prototype.toJSON=function(a){var b,c,d,e,f,g=this,h={};return h.data=g.XTa(3).toJSON(3,a,g.kj),h.rowHeaderData=g.XTa(2).toJSON(2,a),h.colHeaderData=g.XTa(1).toJSON(1,a),h.rows=g.YTa(!0,3).toJSON(a),h.columns=g.YTa(!1,3).toJSON(a),h.rowHeaderColInfos=g.YTa(!1,2).toJSON(a),h.colHeaderRowInfos=g.YTa(!0,1).toJSON(a),b=g.kj,h.leftCellIndex=b.getViewportLeftColumn(1),h.topCellIndex=b.getViewportTopRow(1),c=a&&a.ignoreStyle,c||(h.spans=Na(g.zl(3).toJSON()),h.rowHeaderSpan=Na(g.zl(2).toJSON()),h.colHeaderSpan=Na(g.zl(1).toJSON())),h.selections=g.selectionModel.toJSON(),d=g.defaults,e={colHeaderRowHeight:d.colHeaderRowHeight,colWidth:d.colWidth,rowHeaderColWidth:d.rowHeaderColWidth,rowHeight:d.rowHeight,_isExcelDefaultColumnWidth:d._isExcelDefaultColumnWidth},f=e.rowHeight===$&&e.colWidth===_&&e.rowHeaderColWidth===aa&&e.colHeaderRowHeight===ba,f||(h.defaults=e),h},a.prototype.fromJSON=function(a,b,c,d){var e,f,g,h,j,l,m,n,o,p,q,r,s,v=this;if(v.XTa(3).fromJSON(a.data,b,c,3,d),v.XTa(2).fromJSON(a.rowHeaderData,b,c),v.XTa(1).fromJSON(a.colHeaderData,b,c),v.kj.showCell(a.topCellIndex||0,a.leftCellIndex||0,k.VerticalPosition.top,k.HorizontalPosition.left),v.YTa(!0,3).fromJSON(a.rows),v.YTa(!1,3).fromJSON(a.columns),v.YTa(!1,2).fromJSON(a.rowHeaderColInfos),v.YTa(!0,1).fromJSON(a.colHeaderRowInfos),a&&a.rows)for(e=Object.keys(a.rows),f=0,g=e;f<g.length;f++)h=g[f],j=a.rows[h],G(j)||v.zgc({type:k.AxisInfoChangeType.setRowHeight,index:+h});if(a&&a.columns)for(e=Object.keys(a.columns),l=0,m=e;l<m.length;l++)h=m[l],j=a.columns[h],G(j)||v.zgc({type:k.AxisInfoChangeType.setColumnWidth,index:+h});n=c&&c.ignoreStyle,n||(v.zl(3).fromJSON(a.spans,v.getRowCount(),v.getColumnCount()),v.zl(2).fromJSON(a.rowHeaderSpan),v.zl(1).fromJSON(a.colHeaderSpan)),v.selectionModel.fromJSON(a.selections,a.rowCount,a.columnCount),o=a.tag,o!==t&&(p=o.typeName,typeof p===u&&(q=i.getTypeFromString(p),q&&(o=new q,o.fromJSON&&o.fromJSON(a.tag))),v.do("setValueForKey",-1,-1,"tag",o,3)),r=a.defaults,r!==t&&(s=v.defaults,s.colHeaderRowHeight=ha(r.colHeaderRowHeight,ba),s.colWidth=ha(r.colWidth,_),s.rowHeaderColWidth=ha(r.rowHeaderColWidth,aa),s.rowHeight=ha(r.rowHeight,$),s._isExcelDefaultColumnWidth=r._isExcelDefaultColumnWidth)},a.prototype.startTransaction=function(){if(0===this.WTa){this.zTa=[];var b=this.kj,c=!b.isEventSuspended();c&&(this.zTa.events=[]),a.ao(this,"startTransaction")}this.WTa++},a.prototype.endTransaction=function(){var b,c;return this.WTa--,0===this.WTa?(a.ao(this,"endTransaction"),b=this.zTa,this.zTa=t,c=b.events,c&&0===c.length&&delete b.events,b):[]},a.prototype.dUa=function(){var a=this.zTa;if(a)return a.calc||(a.calc=[]),a.calc},a.prototype.EIb=function(a,b,c){var d=this.zTa;d&&d.push({type:"setIsValid",value:[a,b,c]})},a.prototype.FIb=function(a,b,c){var d=this.zTa;d&&d.push({type:"dirtyItem",value:[a,b,c]})},a.prototype.MIb=function(a){var b,c,d,e=a.value;e&&(b=this.ZHb,c=b.getAnchorCell(e[0],e[1]),c&&(d=e[2],c.isValid=d))},a.prototype.NIb=function(a){var b,c,d,e,f,g=a.value;g&&(b=g[0],c=g[1],d=g[2],e=this.ZHb,f=e.getAnchorItem(b,c),f&&(f.value=d))},a.prototype.undo=function(b){var c,d,e,f,g,h,i,j,k=[],l=b&&b.events;if(l&&this.YVa(l,!0),b)for(c=b.length-1;c>=0;c--)d=b[c],e=d.type,e?"addRows"===e?this.ZTa(d):"addColumns"===e?this._Ta(d):"deleteRows"===e?this.$Ta(d):"deleteColumns"===e?this.aUa(d):"setRowCount"===e?this.bUa(d):"setColumnCount"===e?this.cUa(d):"setZoomFactor"===e?this.fUa(d.value):"updateDirty"===e?(this.gWa(d),k.push(d)):"setName"===e?this.pZa(d.value):"sortRange"===e?this.yxb(d):"setIsValid"===e?this.MIb(d):"dirtyItem"===e&&this.NIb(d):d.skipUndo||Aa(this,d);f=this.kj,f.Oq={},f.Jq(),g=k.length>0,g&&(h=f.Wu,h&&h.suspend(),k.forEach(function(a){f.eyb(a.row,a.col,3,!1)})),i=b&&b.tableChanges,i&&i.length>0&&(a.ao(this,A,{tableChanges:i}),b.tableChanges.isRestored=!0),j=b&&b.calc,j&&j.length&&f.gUa(j),g&&(h&&h.resume(!1),f.fyb()),delete this.XTa(3).Ap.KYc,b&&a.ao(this,A,b),l&&this.YVa(l,!1)},a.prototype.do=function(a){var b,c,d,e=[];for(b=1;b<arguments.length;b++)e[b-1]=arguments[b];c=this,a&&(d=c[a],d&&d.apply(c,e))},a.prototype.XTa=function(a){return G(a)&&(a=3),this.sheetModels[a]},a.prototype.dWa=function(a,b,c){G(c)&&(c=3),this.sheetModels[c]=new X(a,b)},a.prototype.ZVa=function(a){var b=this,c=b.zTa,d=c&&c.events;d&&d.push(a)},a.prototype.YVa=function(a,b){var c,d,e,f,g=this.kj;for(g.OIb=!0,c=a.length-1;c>=0;c--)d=a[c],e=d[0],f=void 0,"cellChanged"!==e||b?"rowChanged"!==e||b?"columnChanged"!==e||b?"zoomChanged"!==e||b?"rowChanging"===e&&b?f=g.pCb:"columnChanging"===e&&b?f=g.qCb:"tableRowsChanged"!==e||b?"tableColumnsChanged"!==e||b?"rangeChanged"!==e||b||(f=g.RIb):f=g.QIb:f=g.PIb:f=g.gyb:f=g.pq:f=g.kq:f=g.Bq,f&&([].splice.call(a,c,1),f.apply(g,[].slice.call(d,1)));g.OIb=!1},a.prototype.getValue=function(b,c,d,e,f){if(G(d)&&(d=3),!e){var g={row:b,col:c,sheetArea:d,isValueGet:!1,value:t};if(a.ao(this,"getValue",g,function(){return g.isValueGet}),g.isValueGet)return g.value}return this.XTa(d).getValue(b,c,f)},a.prototype.setValue=function(b,c,d,e,f,g,i,j){var k,l,m,o,p,q,r,s,v,w,x,y;G(e)&&(e=3),l=this,m=l.kj,o=!g&&!m.isEventSuspended(),o&&(k=m.getValue(b,c,e,1)),p=!1,n&&m.getCalcService().allowDynamicArray&&!l.SIb&&3===e&&(l.LIb.push(l.ZHb.updateItem(m.yj(),b,c,d)),p=!0),q=!1,f||(r={row:b,col:c,value:d,sheetArea:e,isValueSet:!1,changes:l.zTa},a.ao(l,"setValue",r,function(){return r.isValueSet}),q=r.isValueSet),q||(s=void 0,v=void 0,l.WTa>0&&!i&&(s=[["sheetModels",e],t],v={sheetArea:e}),l.XTa(e).setValue(b,c,d,s,v,j),j&&s&&Ia(this.dUa(),b,c)&&(s.skipUndo=!0),s&&s.length>0&&l.zTa.push(s),v&&v.type&&l.zTa.push(v),m.fyb()),o?(w=k!==d,x=!1,y=void 0,typeof d===u&&(y=h.util.w0a(d),y instanceof Date&&(x=!0),k instanceof Date&&(w=k.valueOf()!==y.valueOf())),w&&m.Bq("value",b,c,e,k,x&&y?y:d)):m.WXc(m,[{row:b,col:c}],0),p&&l.applyDynamicChanges()},a.prototype.applyDynamicChanges=function(){var a,b,c,d,e,f=this,h=f.LIb,i=f.kj;if(!f.SIb&&h.length){for(f.SIb=!0,a=i.yj(),b=i.Bj(),c=0,d=h;c<d.length;c++)e=d[c],e&&(g.setSpillValues(e[0],a),g.markAnchorCellDirty(e[1],b,f.ZHb));h.length=0,f.SIb=!1}},a.prototype.getDynamicArrayInfo=function(a,b){return this.ZHb.getAnchorInfo(a,b)},a.prototype.getStyle=function(a,b,c){return this.XTa(c).getStyle(a,b,this.WTa>0)},a.prototype.setStyle=function(a,b,c,d){G(d)&&(d=3);var e=this.WTa>0?[["sheetModels",d],t]:t;this.XTa(d).setStyle(a,b,c,e),e&&e.length>0&&this.zTa.push(e)},a.prototype.getValueForKey=function(a,b,c,d){return this.XTa(d).getValueForKey(a,b,c)},a.prototype.setValueForKey=function(a,b,c,d,e){G(e)&&(e=3);var f=this.WTa>0?[["sheetModels",e],t]:t;this.XTa(e).setValueForKey(a,b,c,d,f),f&&f.length>0&&this.zTa.push(f)},a.prototype.clear=function(b,c,d,e,f,g,h){var i,j,k,l,m,o,p,q,r,u,v,w,x,y,z;if(G(h)&&(h=3),i=this.WTa>0?[]:t,j=this,k=!1,n&&!j.SIb&&3===h){for(l=j.kj,m=l.yj(),o=j.LIb,p=j.ZHb,q={},r=[],u=0;u<d;u++)for(v=0;v<e;v++)p.updateItem(m,b+u,c+v,s,q,r);o.push([q,r]),k=!0}if(this.XTa(h).clear(b,c,d,e,f,g,i),a.ao(this,"clear",{row:b,col:c,rowCount:d,colCount:e,type:f,ignoredRowList:g,sheetArea:h,changes:this.zTa}),i)for(w=["sheetModels",h],x=0,y=i.length;x<y;x++)z=i[x],z[0]=w.concat(z[0]),this.zTa.push(z);k&&this.applyDynamicChanges()},a.prototype.swapNode=function(a,b,c,d,e){var f,g,h,i,j;if(G(e)&&(e=3),f=this.WTa>0?[]:t,this.XTa(e)._f(a,b,c,d,f),f)for(g=["sheetModels",e],h=0,i=f.length;h<i;h++)j=f[h],j[0]=g.concat(j[0]),this.zTa.push(j)},a.prototype.Cp=function(a,b,c,d){var e;this.WTa>0&&(e={sheetArea:d},G(d)&&(e.sheetArea=3)),this.XTa(d).Cp(a,b,c,e),e&&this.zTa.push(e)},a.prototype.gWa=function(a){this.XTa(a.sheetArea).gWa(a)},a.prototype.hUa=function(a){return this.XTa(a).Ap},a.prototype.XLc=function(a,b,c){var d,e=this.hUa(c),f=e[a];return!(!f||!(d=f[b]))},a.prototype.YLc=function(a,b,c){var d,e,f=this.XTa(c).Ap;for(d=0;d<b;d++)e=a+d,e in f&&delete f[e]},a.prototype.ZLc=function(a,b){var c,d,e=this.kj,f=e.Ts;if(f)for(c=f.length-1;c>=0;c--)d=f[c].row,a<=d&&d<a+b&&f.splice(c)},a.prototype.iUa=function(a){this.XTa(a).Ap={}},a.prototype.Lec=function(a,b,c,d){var e=this.hUa(),f,g,h;if(e)for(f in e)ia(e,f)&&(g=e[f],h=parseInt(f,10),g&&"n"===g.rs&&(a||b&&c<=h&&h<c+d)&&(e[f]={}))},a.prototype.Mec=function(b,c,d,e,f){var g,h,i,j,k,l,m,n=this,q=n.hUa(),r=n.kj,s=r.tables;if(!p(q)){if(g=[],c>=0)for(h=c;h<c+e;h++)g.push(h);else for(i in q)ia(q,i)&&g.push(parseInt(i,10));j=[],k=[],s&&(j=s.Nec(c,d,e,f),k=s.Oec(c,d,e,f),j.length>0&&a.ao(this,"clearPendingChanges",{tableList:j})),o(g,function(a,c){var e,g,h;if(l=q[c],l&&"e"===l.rs)if(e=k.length,b)if(s&&0!==e&&s.Pec(k,c,-1))for(g=r.getColumnCount(),h=0;h<g;h++)s&&0!==e&&s.Pec(k,c,h)||(m=l[h],m&&delete l[h]);else q[c]={};else for(h=d;h<d+f;h++)s&&0!==e&&s.Pec(k,c,h)||(m=l[h],m&&delete l[h])})}},a.prototype.Qec=function(){var a,b=this,c=b.hUa();for(a in c)ia(c,a)&&"e"===c[a].rs&&(c[a]={})},a.prototype.jUa=function(a){this.XTa(a).gga++},a.prototype.kUa=function(a){var b,c=this.XTa(a);c.gga--,b=c.gga,b<0&&(c.gga=0)},a.prototype.getName=function(){return this.name||""},a.prototype.setName=function(a){var b=this;b.WTa>0&&b.zTa.push({type:"setName",value:b.name}),b.name=a},a.prototype.TIb=function(){return this.isSelected},a.prototype.CHb=function(a){this.isSelected=a},a.prototype.pZa=function(a){this.kj.name(a)},a.prototype.yxb=function(a){var b,c=[];b=a.byRows?a.row:a.column,a.array.map(function(a,d){c[a-b]=d+b}),this.kj.sortRange(a.row,a.column,a.rowCount,a.columnCount,a.byRows,a.sortInfo,s,c)},a.prototype.getZoomFactor=function(){return this.zoomFactor},a.prototype.setZoomFactor=function(a){var b=this;b.WTa>0&&b.zTa.push({type:"setZoomFactor",value:b.zoomFactor}),b.zoomFactor=a},a.prototype.fUa=function(a){this.kj.zoom(a)},a.prototype.zl=function(a){return G(a)&&(a=3),this.spanModels[a]},a.prototype.eWa=function(a){G(a)&&(a=3),this.spanModels[a]=new Q},a.prototype.getSpans=function(a,b,c){var d=this.zl(b).getSpans(a);return c&&(d=d.filter(function(a){return!a.isAutoMerge})),d},a.prototype.getSpan=function(a,b,c){return this.zl(c).get(a,b)},a.prototype.uIb=function(a,b,c){var d,e;return G(c)&&(c=3),d=this.XTa(c),d&&d.RTa?(e=d.RTa(a,b),e&&e.tipContent?e.tipContent:null):null},a.prototype.qHb=function(a,b,c,d){G(d)&&(d=3);var e=this.XTa(d).RTa(a,b);!c&&e?delete e.tipContent:c&&e?e.tipContent=c:c&&!e&&(e=this.XTa(d).RTa(a,b,!0),e.tipContent=c)},a.prototype.MTa=function(a,b,c,d,e){return this.zl(e).MTa(a,b,c,d)},a.prototype.qu=function(a,b,c,d,e){return this.zl(e).qu(a,b,c,d)},a.prototype.findSpan=function(a,b,c){return this.zl(c).find(a,b)},a.prototype.removeSpan=function(a,b){G(b)&&(b=3);var c=this.WTa>0?[["spanModels",b],t]:t;this.zl(b).remove(a,c),c&&c.length>0&&this.zTa.push(c)},a.prototype.addSpan=function(a,b){G(b)&&(b=3);var c=this.WTa>0?[["spanModels",b],t]:t;this.zl(b).add(a,c),c&&c.length>0&&this.zTa.push(c)},a.prototype.clearSpan=function(a,b,c,d,e){G(e)&&(e=3);var f=this.WTa>0?[["spanModels",e],t]:t;this.zl(e).$b(a,b,c,d,f),f&&f.length>0&&this.zTa.push(f)},a.prototype.moveSpan=function(a,b,c,d,e,f,g){G(g)&&(g=3);var h=this.WTa>0?[["spanModels",g],t]:t;this.zl(g).aB(a,b,c,d,e,f,h),h&&h.length>0&&this.zTa.push(h)},a.prototype.copySpan=function(a,b,c,d,e,f,g){G(g)&&(g=3);var h=this.WTa>0?[["spanModels",g],t]:t;this.zl(g).Zz(a,b,c,d,e,f,h),h&&h.length>0&&this.zTa.push(h)},a.prototype.addSelection=function(a,b,c,d,e){var f,g,h=this.WTa>0?[]:t;if(this.selectionModel.add(a,b,c,d,h,e),h)for(f=0;f<h.length;f++)g=h[f],g[0]=["selectionModel"].concat(g[0]),this.zTa.push(g)},a.prototype.getSelections=function(){return this.selectionModel.get()},a.prototype.setSelections=function(a){var b,c,d=this.WTa>0?[]:t;if(this.selectionModel.set(a,d),d)for(b=0;b<d.length;b++)c=d[b],c[0]=["selectionModel"].concat(c[0]),this.zTa.push(c)},a.prototype.clearSelection=function(){var a,b,c=this.WTa>0?[]:t;if(this.selectionModel.clear(c),c)for(a=0;a<c.length;a++)b=c[a],b[0]=["selectionModel"].concat(b[0]),this.zTa.push(b)},a.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},a.prototype.setActiveSelectedRangeIndex=function(a){var b=this.WTa>0?[["selectionModel"],t]:t;this.selectionModel.setProperty("activeSelectedRangeIndex",a,b),b&&this.zTa.push(b)},a.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},a.prototype.setSelectionPolicy=function(a){Ba(this,"selectionPolicy",a)},a.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},a.prototype.setSelectionUnit=function(a){Ba(this,"selectionUnit",a)},a.prototype.sp=function(a){return this.selectionModel.sp(a)},a.prototype.tp=function(a){return this.selectionModel.tp(a)},a.prototype.vp=function(a,b,c,d,e,f){return this.selectionModel.vp(a,b,c,d,e,f)},a.prototype.wp=function(a,b,c,d,e){return this.selectionModel.wp(a,b,c,d,e)},a.prototype.YTa=function(a,b){G(b)&&(b=3);var c=a?this.rowInfos:this.colInfos;return c[b]},a.prototype.fWa=function(a,b){G(b)&&(b=3);var c=a?this.rowInfos:this.colInfos;c[b]=new Y},a.prototype.getPageBreak=function(a,b,c){var d=this.YTa(a,b);return d.getPageBreak(c)},a.prototype.setPageBreak=function(a,b,c,d){var e,f;G(b)&&(b=3),e=this.WTa>0?[[a?B:C,b],t]:t,f=this.YTa(a,b),f.setPageBreak(c,d,e),e&&this.zTa.push(e)},a.prototype.getVisible=function(a,b,c){var d=this.YTa(a,b);return d.getVisible(c)},a.prototype.setVisible=function(a,b,c,d){var e,f,g,h=this;G(b)&&(b=3),e=h.WTa>0?[[a?B:C,b],t]:t,f=h.YTa(a,b),f.setVisible(c,d,e),e&&h.zTa.push(e),g=a?k.AxisInfoChangeType.setRowVisible:k.AxisInfoChangeType.setColumnVisible,h.zgc({type:g,index:c,sheetArea:b})},a.prototype.getResizable=function(a,b,c){var d=this.YTa(a,b);return d.getResizable(c)},a.prototype.setResizable=function(a,b,c,d){var e,f;G(b)&&(b=3),e=this.WTa>0?[[a?B:C,b],t]:t,f=this.YTa(a,b),f.setResizable(c,d,e),e&&this.zTa.push(e)},a.prototype.getSize=function(a,b,c){var d=this.YTa(a,b);return d.getSize(c)},a.prototype.getColumnHeaderFitMode=function(a,b,c){var d=this.YTa(a,b);return d.getColumnHeaderFitMode(c)},a.prototype.setColumnHeaderFitMode=function(a,b,c,d){var e,f,g,h,i,j,l,m,n,o=this,p=60,q=o.kj,r=q.getRowCount(1);if(G(b)&&(b=3),o.WTa&&(e=[[C,b],t],f=[[B,b],t]),h=o.YTa(a,b),i=h.getColumnHeaderFitMode(c),h.setColumnHeaderFitMode(c,d,e),l=!1,d===k.ColumnHeaderFitMode.vertical?(j=p,q.HYc&&2===i&&q.HYc--):d===k.ColumnHeaderFitMode.stack?(o.MYc(c,b),q.HYc||(q.HYc=0),2!==i&&q.HYc++):d===k.ColumnHeaderFitMode.normal&&(j=q.defaults.colHeaderRowHeight,q.HYc&&2===i&&q.HYc--),j){for(m=o.YTa(!0,b),n=0;n<r;n++)l||(g=q.getRowHeight(n,b),j=x(j,g)),j!==g&&(m.setSize(n,D,f),f&&(o.zTa.push(f),f=[[B,b],t]));q.defaults.colHeaderRowHeight=j}e&&o.zTa.push(e)},a.prototype.MYc=function(a,b){var c,d,e,f,g,h,i,j=this,l=j.kj,m=j.YTa(!0,b);if(j.WTa&&(c=[[B,b],t]),e=j.kj.defaults.rowHeight||ba,g=j.getRowCount(k.SheetArea.colHeader),h=j.NYc(a),!j.OYc(a)){for(i=0;i<g;i++)d=e*h,f=l.getRowHeight(i,b),d=x(d,f),d!==f&&(m.setSize(i,D,c),c&&(j.zTa.push(c),c=[[B,b],t]));l.defaults.colHeaderRowHeight=d}},a.prototype.OYc=function(a){var b=this,c=b.kj,d=c.frozenColumnCount()-1,e=c.frozenTrailingColumnCount(),f=b.getColumnCount()-1;return a===d||a===f||a===f-e},a.prototype.PYc=function(a){var b,c,d=this,e=d.kj,f=e.frozenColumnCount(),g=e.frozenTrailingColumnCount(),h=d.getColumnCount();return f&&(b=a===f),g&&(c=a===h-g),b||c},a.prototype.NYc=function(a,b){var c,d,e,f,g,h,i,j,l=this,m=k.SheetArea.colHeader,n={},o=l.kj,p=o.getColumnCount();for(b||(b=l.YTa(!1,m).infos),c=d=e=b[a]&&b[a].columnHeaderFitMode===k.ColumnHeaderFitMode.stack?a:a-1,f=e;f>=0;f--){if(o.getColumnWidth(f,m)){if(b[f]&&b[f].columnHeaderFitMode===k.ColumnHeaderFitMode.stack&&!l.MTa(-1,f,-1,1,k.SheetArea.colHeader)){if(l.PYc(f)){c=f;break}c=f;continue}break}c=f,n[f]=!0}for(f=e;f<p;f++){if(o.getColumnWidth(f,m)){if(b[f]&&b[f].columnHeaderFitMode===k.ColumnHeaderFitMode.stack&&!l.MTa(-1,f,-1,1,k.SheetArea.colHeader)){if(l.OYc(f))break;d=f;continue}break}if(d=f,n[f]=!0,l.OYc(f))break}return g=Object.keys(n).length,h=d-c-g+1,i=1,j=o.Zq(d,m,!0),!j||l.OYc(d)||l.MTa(-1,j,-1,1,k.SheetArea.colHeader)?h:h+i},a.prototype.QYc=function(a,b){var c,d,e,f=this,g=0,h=f.kj,i=h.ITa;for(b||(b=f.YTa(!1,k.SheetArea.colHeader).infos),c=f.RYc(a),d=a-1;d>=c;d--)if(e=h.getColumnWidth(d)){if(!b[d]||b[d].columnHeaderFitMode!==k.ColumnHeaderFitMode.stack||i.MTa(-1,d,-1,1,k.SheetArea.colHeader))return g;g++}return g},a.prototype.AYc=function(a,b){var c,d,e=this,f=e.kj,g=f.getColumnCount();for(d=a+1;d<g;d++)if(c=e.getColumnHeaderFitMode(!1,1,d),c===b)return d;return s},a.prototype.RYc=function(a){var b=this,c=b.kj,d=c.frozenColumnCount(),e=c.frozenTrailingColumnCount(),f=b.getColumnCount();return a<d?0:a<f-e?d:f-e},a.prototype.getStarSize=function(a,b,c){var d=this.YTa(a,b);return d.getStarSize(c)},a.prototype.getActualSize=function(a,b,c){var d=this.YTa(a,b);return d.getActualSize(c)},a.prototype.setSize=function(a,b,c,d){var e,f,g,h=this;G(b)&&(b=3),e=h.WTa>0?[[a?B:C,b],t]:t,f=h.YTa(a,b),f.setSize(c,d,e),e&&h.zTa.push(e),h.setStarSize(a,b,c,s),g=a?k.AxisInfoChangeType.setRowHeight:k.AxisInfoChangeType.setColumnWidth,h.zgc({type:g,index:c,value:d,sheetArea:b})},a.prototype.setStarSize=function(a,b,c,d){var e,f;G(b)&&(b=3),e=this.WTa>0?[[a?B:C,b],t]:t,f=this.YTa(a,b),f.setStarSize(c,d,e),e&&!G(e[1])&&this.zTa.push(e)},a.prototype.VTa=function(a,b){var c=this.YTa(a,b);return c.VTa()},a.prototype.Hp=function(a,b){var c=this.YTa(a,b);return c.Hp()},a.prototype.Jp=function(a,b,c){var d=this.YTa(a,b);return d.Jp(c)},a.prototype.setItem=function(a,b,c,d){var e,f,g,h=this;G(b)&&(b=3),e=h.WTa>0?[[a?B:C,b],t]:t,f=h.YTa(a,b),f.Kp(c,d,e),d&&(G(d.size)||(g=a?k.AxisInfoChangeType.setRowHeight:k.AxisInfoChangeType.setColumnWidth,h.zgc({type:g,index:c,value:d.size,sheetArea:b})),G(d.visible)||(g=a?k.AxisInfoChangeType.setRowVisible:k.AxisInfoChangeType.setColumnVisible,h.zgc({type:g,index:c,sheetArea:b}))),e&&h.zTa.push(e)},a}(),b.lUa=ea,h.Zn(ea)},"./dist/core/worksheet/worksheet-render.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/worksheet/worksheet-model.js"),i=c("./dist/core/worksheet/worksheet-border.js"),j=c("./dist/core/core.enum.js"),k=function(a){return a.getSparkline},l=d.Common.k,m=f.Ul.ol,n=f.Ul.fp,o=f.Ul.lZa,p=f.Ul.lHb,q=d.Common.j.Fa,r=f.Ul.Fxb,s=g.Ho,t=g.To.No,u=null,v=void 0,w=Math.min,x=Math.max,y=Math.abs,z=Math.sin,A=Math.cos,B=Math.tan,C=Math.floor,D=Math.round,E=parseInt,F="black",G="transparent",H="rowHeader",I="columnHeader",J="white",K="number";function _(a){return a.height}function aa(a){return a.width}function ba(a,b,c,d,e,f,g){a.beginPath(),a.lineWidth=b,a.strokeStyle=c,a.moveTo(d,e),a.lineTo(f,g),a.stroke()}L=2,M=100;function ca(a,b){var c,d,e=0;return"string"==typeof a&&(c=a.split(" ",4),d=c.length,1===d?e=2*E(c[0]):2===d||3===d?e=2*E(c[1]):4===d&&(e=E(c[1])+E(c[3]))),e*b}function da(a,b,c,d,e,g,h,i){var j,k,l,m,o,p,r,s,u,v=e.zoom(),w=c.font,x=c.textIndent,B=c.textOrientation,C=c.isVerticalText,D=c.textIndent&&0!==c.textIndent,E=0!==B&&!q(B);return w=w?t(w,v).font:d,typeof i===K&&1!==i&&(w=t(w,i).font),o=0,p=a,a&&p.richText?o=fa(p.richText,w,v):a&&E&&!C&&!D?(k=y(B*Math.PI/180),l=z(k),m=A(k),c.wordWrap?(r=e.ss,s=r.Sl(g),o=f.Vn.mHb(g,h,l,m,b,w,s)):(u=n(w),o=f.Vn.Xn(b,w)*m+u*l)):o=f.Vn.Xn(b,w),o+=ha(e,x,g,h)+L,j=o+ca(c.cellPadding,v)}function ea(a,b,c){if(a&&-90<=a&&a<=90){var d=C(c/B(y(a*Math.PI/180)));return d+b+4}}function fa(a,b,c){return ga(a,b,c),f.Vn.R_a(a,b,1)}function ga(a,b,c){var d,e,f,g,h;for(d=0,e=a;d<e.length;d++)f=e[d],g=void 0,f.style=f.style||{},h=f.style,g=h.font?t(h.font,c).font:b,h.font=g}function ha(a,b,c,d){if(!q(c)&&!q(d)&&a.outlineColumn){var e=a.outlineColumn.LRa(c,d);if(e)return e}return b?8*b:0}function ia(a,b,c,d,e,f,g,i,k){var l,m,n,o,p,s,t,v,w,x,y,z,A,B,C,D,E;if(r(e.data)&&a.parent&&a.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(l=a.ss,m=aa(e),n=aa(e),p=e.style,t=e.text,v=e.printZoomFactor,w=p.watermark,x=p.wordWrap,y=p.textOrientation,B=a.options.allowCellOverflow,b.findCell(f,g))return u;if(p.cellButtons&&p.cellButtons.length>0)return u;if(C=p.cellType||c,!C.allowOverflow||!t&&!w||!y&&x&&a.parent&&a.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(t||(t=w),!B&&!y)return u;if(z=da(e.data,t,p,d,a,f,g,v),z<=n)return u;for(D=g,E=g,s=g+(k?1:-1);(k?s<=i:s>=i)&&!b.findCell(f,s)&&(A=l.Ym(f,s),o=l.zHb(f,s,3,1,A),A.textOrientation||q(o))&&!A.watermark&&!(A.cellType&&"1"!==A.cellType.typeName||A.cellButtons&&A.cellButtons.length>0)&&(k?E=s:D=s,n+=l._m(s),!(z<=n));s+=k?1:-1);return k&&E===g||!k&&D===g?u:new h.op(g,D,E,z,m,n,k?-1:n,k?n:-1)}N=function(){function a(a,b,c){var d=this;d.kj=a,d.pJ=a.Hr(c),d.qJ=a.Ir(b,c,j.SheetArea.viewport,!0),d.yI=t(a.yl.Bl(),a.zoom()).font,d.Rq=a.Al(),d.rJ={}}return a.prototype.nJ=function(a,b,c){var d,e,g,i,j,k=this,l=k.rJ[a];if(l)return l;if(d=k.pJ,e=d.length,g=new h.np,b||(b=f.Vn.bm()),e>0){for(g.headingOverflowlayouts=k.sJ(a,b),j=0;j<e;j++)i=this.SYc(a,j,b,c),i&&g.push(i);g.trailingOverflowLayouts=k.wJ(a,b)}return k.rJ[a]=g,g},a.prototype.SYc=function(a,b,c,d){var e,g,h,i,k,l,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D=this,E=D.kj,F=E.ss,G=D.pJ,H=G.length;if(0!==H&&(u=G[0].col,v=G[H-1].col,c||(c=f.Vn.bm()),i=G[b],!(aa(i)<=0)&&(k=i.col,l=F.Ym(a,k),n=F.zHb(a,k,3,1),e=l.textOrientation,g=l.isVerticalText,h=l.textIndent&&0!==l.textIndent,w=l&&(l.borderLeft||l.borderTop||l.borderRight||l.borderBottom),(!q(n)||l.watermark)&&!((l.shrinkToFit||!e&&l.wordWrap&&E.parent&&E.parent.options.numbersFitMode===j.NumbersFitMode.mask||g)&&4!==l.hAlign||4!==l.hAlign&&E.options.allowCellOverflow===!1||(x=E.conditionalFormats,x&&(y=x.oRa(E,a,k,n),z=y.dataBar,A=y.iconSet,z&&z.showBarOnly||A&&A.showIconOnly))))))return o=F._m(k),p=F.Sl(a),B=l.cellType||D.Rq,C={},s=f.mn.vn(E,l,n,C,{row:a,col:k,sheet:E}),C&&C.content&&C.content.length>0&&!l.shrinkToFit&&e&&(s=B.sHb(c,C.content,p-4,l.font)),r=l.hAlign,3===r&&(r=m(r,n,l.formatter,e)),!w||!e||g&&4!==r||h?0===r?t=D.tJ({data:n,style:l,width:o,text:s,printZoomFactor:d},a,k,v):2===r?t=D.uJ({data:n,style:l,width:o,text:s,printZoomFactor:d},a,k,u):1===r?t=D.vJ({data:n,style:l,width:o,text:s,printZoomFactor:d},a,k,u,v):4===r&&(t=D.TYc({data:n,style:l,width:o,text:s,printZoomFactor:d},a,k,0,E.getColumnCount()-1)):0>e&&e>-90?t=D.UIb({data:n,style:l,width:o,text:s,printZoomFactor:d},a,k,u):0<e&&e<90&&(t=D.UIb({data:n,style:l,width:o,text:s,printZoomFactor:d},a,k,v,!0)),t},a.prototype.UYc=function(a){var b,c,d,e,f,g=this,h=g.pJ,i=h.length,j=g.kj,k=j.ss;for(f=i-1;f>=0;f--)if(b=h[f],e=b.col,c=k.Ym(a,e),d=k.zHb(a,e,3,1),d||c.watermarks)return this.SYc(a,f)},a.prototype.tJ=function(a,b,c,d){var e=this;return ia(e.kj,e.qJ,e.Rq,e.yI,a,b,c,d,!0)},a.prototype.uJ=function(a,b,c,d){var e=this;return ia(e.kj,e.qJ,e.Rq,e.yI,a,b,c,d)},a.prototype.UIb=function(a,b,c,d,e){var f,g,i,j,k,l,m=this,n=m.kj,o=m.qJ,p=m.Rq,q=m.yI,r=n.ss,s=aa(a),t=aa(a),v=a.style,w=a.text,x=a.printZoomFactor,y=v.watermark,z=v.wordWrap,A=v.textOrientation,B=v&&(v.borderLeft||v.borderTop||v.borderRight||v.borderBottom),C=v.isVerticalText,D=v.textIndent&&0!==v.textIndent,E=n.options.allowCellOverflow;if(o.findCell(b,c))return u;if(v.cellButtons&&v.cellButtons.length>0)return u;if(j=v.cellType||p,!j.allowOverflow||!w&&!y||!A&&z)return u;if(w||(w=y),!E&&!A)return u;if(g=!B||C||D?da(a.data,w,v,q,n,b,c,x):ea(A,r._m(c),r.Sl(b)),g<=t)return u;for(k=c,l=c,f=c+(e?1:-1);(e?f<=d:f>=d)&&!o.findCell(b,f)&&(i=r.Ym(b,f),!i.watermark)&&!(i.cellType&&"1"!==i.cellType.typeName||i.cellButtons&&i.cellButtons.length>0)&&(e?l=f:k=f,t+=r._m(f),!(g<=t));f+=e?1:-1);return e&&l===c||!e&&k===c?u:new h.op(c,k,l,g,s,t,e?-1:t,e?t:-1)},a.prototype.vJ=function(a,b,c,d,e){var f,g,i,k,l,m,n,o,p,s,t,v,w,x,y,z,A,B,C,D,E,F;if(r(a.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(f=this,g=f.kj,i=g.ss,k=f.qJ,l=aa(a),m=aa(a),o=a.style,s=a.text,t=a.printZoomFactor,v=o.textOrientation,w=o.watermark,x=o.wordWrap,A=g.options.allowCellOverflow,k.findCell(b,c))return u;if(o.cellButtons&&o.cellButtons.length>0)return u;if(B=o.cellType||f.Rq,!B.allowOverflow||!s&&!w||!v&&x&&g.parent&&g.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(s||(s=w),!A&&!v)return u;if(y=da(a.data,s,o,f.yI,g,b,c,t),y<=m)return u;for(C=c,D=m/2,p=c-1;p>=d&&!k.findCell(b,p)&&(z=i.Ym(b,p),n=i.zHb(b,p,3,1,z),z.textOrientation||q(n))&&!z.watermark&&!(z.cellType&&"1"!==z.cellType.typeName||z.cellButtons&&z.cellButtons.length>0)&&(C=p,D+=i._m(p),!(y/2<=D));p--);for(E=c,F=m/2,p=c+1;p<=e&&!k.findCell(b,p)&&(z=i.Ym(b,p),n=i.zHb(b,p,3,1,z),z.textOrientation||q(n))&&!z.watermark&&!(z.cellType&&"1"!==z.cellType.typeName||z.cellButtons&&z.cellButtons.length>0)&&(E=p,F+=i._m(p),!(y/2<=F));p++);return C===E?u:new h.op(c,C,E,y,l,D+F,D,F)},a.prototype.VYc=function(a,b,c){var d=a.Ym(b,c),e=a.zHb(b,c,3,1,d);return!(!d.textOrientation&&!q(e))&&(!d.watermark&&!(d.cellType&&"1"!==d.cellType.typeName||d.cellButtons&&d.cellButtons.length>0))},a.prototype.TYc=function(a,b,c,d,e){var f,g,i,k,l,m,n,o,p,s,t,v,w,x=this,y=x.kj,z=y.ss,A=x.qJ,B=aa(a),C=a.style,D=C.shrinkToFit,E=a.text,F=a.printZoomFactor,G=C.watermark,H=C.wordWrap;if(A.findCell(b,c))return u;if(C.cellButtons&&C.cellButtons.length>0)return u;for(E||(E=G),i=da(a.data,E,C,x.yI,y,b,c,F),l=c,m=c,n=z._m(c),o=l+1;o<=e&&(k=z.Ym(b,o),f=z.zHb(b,o,3,1,k),q(f)&&4===k.hAlign&&q(y.getSpan(b,o)))&&!k.watermark&&!(k.cellType&&"1"!==k.cellType.typeName||k.cellButtons&&k.cellButtons.length>0);o++)m=o,n+=z._m(o);if(p=(i-n)/2,r(a.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==j.NumbersFitMode.overflow&&(p=0),s=l,t=n/2,v=m,w=n/2,!D&&!H&&y.options.allowCellOverflow!==!1){for(g=c-1;g>=d&&p>0&&(this.VYc(z,b,g)&&!A.findCell(b,g))&&(s=g,t+=z._m(g),!(p<=t-n/2));g--);for(g=m+1;g<=e&&p>0&&(this.VYc(z,b,g)&&!A.findCell(b,g))&&(v=g,w+=z._m(g),!(p<=w-n/2));g++);}return new h.op(c,s,v,i,B,t+w,t,w,n)},a.prototype.sJ=function(a,b){var c,d,e,g,h,i,k,l,n,o,p,r,s,t,u,w,x=this,y=x.kj,z=y.ss,A=x.pJ;if(0===A.length)return[];for(c=A[0].col,d=A[A.length-1].col,e=y.ITa,u=[],b||(b=f.Vn.bm()),w=1;w<M;w++){if(n=c-w,n<0)return u;if(e.findSpan(a,n)||y.mJb&&y.mJb.oJb(a,n,j.SheetArea.viewport))return u;if(h=z.zHb(a,n,3,1),i=z._m(n),i>0&&!q(h)){if(g=z.Ym(a,n),l=g.hAlign,4!==l&&y.options.allowCellOverflow===!1)continue;3===l&&(l=m(l,h,v,g.textOrientation)),k=z.Sl(a),s=g.cellType||x.Rq,t={},p=f.mn.vn(y,g,h,t,{row:a,col:n,sheet:y}),t&&t.content&&t.content.length>0&&!g.shrinkToFit&&g.textOrientation&&(p=s.sHb(b,t.content,k-4,g.font)),r={data:h,style:g,width:i,text:p},0<g.textOrientation&&g.textOrientation<90?o=x.UIb(r,a,n,d,!0):0===l?o=x.tJ(r,a,n,d):1===l?o=x.vJ(r,a,n,c,d):4===l&&(o=x.TYc(r,a,n,c,d)),o&&o.endColumn>=c&&u.push(o)}}return u},a.prototype.wJ=function(a,b){var c,d,e,g,h,i,k,l,n,o,p,r,s,t,u,w,x,y=this,z=y.kj,A=z.ss,B=y.pJ;if(0===B.length)return[];for(c=B[0].col,d=B[B.length-1].col,e=z.ITa,p=z.getColumnCount(),w=[],b||(b=f.Vn.bm()),x=1;x<M;x++){if(r=d+x,r>=p)return w;if(e.findSpan(a,r)||z.mJb&&z.mJb.oJb(a,r,j.SheetArea.viewport))return w;if(h=A.zHb(a,r,3,1),i=A._m(r),i>0&&!q(h)){if(g=A.Ym(a,r),l=g.hAlign,4!==l&&z.options.allowCellOverflow===!1)continue;3===l&&(l=m(l,h,v,g.textOrientation)),k=A.Sl(a),n=g.cellType||y.Rq,o={},t=f.mn.vn(z,g,h,o,{row:a,col:r,sheet:z}),o&&o.content&&o.content.length>0&&!g.shrinkToFit&&g.textOrientation&&(t=n.sHb(b,o.content,k-4,g.font)),u={data:h,style:g,width:i,text:t},0>g.textOrientation&&g.textOrientation>-90?s=y.UIb(u,a,r,c,!1):2===l?s=y.uJ(u,a,r,c):1===l?s=y.vJ(u,a,r,c,d):4===l&&(s=y.TYc(u,a,r,0,d)),s&&s.startColumn<=d&&w.push(s)}}return w},a}(),b.xJ=N;function ja(a){var b=a.parent,c={nps:!0};return e.Worksheet.ao(a,"needPaintSelection",c),(f.Vl.Wl(a)||b&&!b.options.hideSelection)&&c.nps}b.needPaintSelection=ja;function ka(a){var b=a.parent;return b&&b.options.backColor||J}O=function(){function a(a){this.kj=a}return a.prototype.bm=function(){var a=this.kj,b=u,c=a.Ws();return c&&c.getContext&&(b=c.getContext("2d")),b},a.prototype.vI=function(){var a,b=this,c=b.kj,d=c.Dr(),e=c.Xs,g=aa(e),h=_(e),i=b.wI;return i&&aa(i)===g&&_(i)===h||(i&&f.En.Qn(c,i),b.wI=i=f.Ul.Nl("canvas"),i.getContext&&(b.xI=i.getContext("2d"),f.En.Kn(i,u,c),f.En.Pn(i,aa(d),_(d)))),a=b.xI,a&&(a.beginPath(),o(a,b.Cl(b.Bl())),a.name="bufferContext"),a},a.prototype.Bl=function(){return this.yI||(this.yI=s+" "+this.kj.currentTheme().bodyFont()),this.yI},a.prototype.us=function(){this.yI=u},a.prototype.zI=function(a){var b,c=this.kj,d=c.parent,e=d?d.options.grayAreaBackColor||f.Im.Mm("gc-grayArea").backgroundColor:"gray",g=f.Rm.Om(c,e);return a?(b=d?d.options.backgroundImage:u,b&&(g=G),g):g},a.prototype.Cl=function(a){var b=this.kj,c=b.zoom();return 1===c?a:t(a,c).font},a.prototype.Mx=function(a,b,c,d,e){var g,h,i,j,k,l=this,m=l.wI,n=l.bm();c<=0||d<=0||!m||!n||(e||(e=l.kj.Dr()),g=f.En.Ln(m),h=f.En.Mn(m),1!==g&&(a*=g,b*=h,c*=g,d*=h,e=new f.Rect(e.x*g,e.y*h,aa(e)*g,_(e)*h)),i=e.getIntersect(a,b,c,d),i&&(i.round(),a=i.x,b=i.y,c=aa(i),d=_(i),j=aa(m),j&&a+c>j&&(a=j-c,a<0&&(c+=a,a=0)),k=_(m),k&&b+d>k&&(b=k-d,b<0&&(d+=b,b=0)),f.Bn.Cn(n,1,1),n.clearRect(a,b,c,d),n.drawImage(m,a,b,c,d,a,b,c,d),f.Bn.Cn(n,g,h)))},a.prototype.dm=function(a,b){a&&this.Mx(a.x,a.y,aa(a),_(a),b)},a.prototype.Ow=function(a,b,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(c>0&&d>0)try{h=this,i=h.kj,j=h.bm(),k=i.Ws(),l=h.vI(),m=h.wI,n=c,o=d,p=e,q=g,r=n,s=o,t=f.En.Ln(k),u=f.En.Mn(k),a=D(a*t),b=D(b*u),c=D(c*t),d=D(d*u),p=D(p*t),q=D(q*u),r=D(r*t),s=D(s*u),v=aa(m),w=_(m),v&&a+c>v&&(a=v-c,a<0&&(c+=a,a=0)),w&&b+d>w&&(b=w-d,b<0&&(d+=b,b=0)),v&&p+r>v&&(p=v-r,p<0&&(r+=p,p=0)),w&&q+s>w&&(q=w-s,q<0&&(s+=q,q=0)),f.Bn.Cn(j,1,1),f.Bn.Cn(l,1,1),j.clearRect(p,q,r,s),j.drawImage(m,a,b,c,d,p,q,r,s),l.clearRect(p,q,r,s),l.drawImage(k,p,q,r,s,p,q,r,s),f.Bn.Cn(j,t,u),f.Bn.Cn(l,t,u)}catch(a){}},a.prototype.im=function(a,b,c,d){var e,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=this;if(c||(c=U.bm()),e=!1,g=U.kj,h=f.kf(-1,-1,-1,-1),i=g.Hx,k=g.ITa,a&&(h=g.options.allowCellOverflow||g.HYc?f.kf(a.row,0,a.rowCount,g.getColumnCount()):f.kf(a.row,a.col,a.rowCount,a.colCount),!i)){if(h.col>=0){for(m=h.col,n=h.col+h.colCount-1,o=g.getRowCount(1),p=0;p<o;p++)l=k.findSpan(p,h.col,1),l?m=w(l.col,m):g.p_a&&(m=w(g.p_a.col,m)),l=k.findSpan(p,h.col+h.colCount-1,1),l?n=x(l.col+l.colCount-1,n):g.p_a&&(n=x(g.p_a.col+g.p_a.colCount-1,n));h.col=m,h.colCount=n-m+1}if(h.row>=0){for(q=h.row,r=h.row+h.rowCount-1,s=g.getColumnCount(2),t=0;t<s;t++)l=k.findSpan(h.row,t,2),l?q=w(l.row,q):g.p_a&&(q=w(g.p_a.row,q)),l=k.findSpan(h.row+h.rowCount-1,t,2),l?r=x(l.row+l.rowCount-1,r):g.p_a&&(r=x(g.p_a.row+g.p_a.rowCount-1,r));h.row=q,h.rowCount=r-q+1}}if(u=g.cm(h),g.cellStates&&g.cellStates.hasIntersectInSeletionState(h.row,h.col,h.rowCount,h.colCount)&&g.repaint(u),
v=g.QLc,y=v&&v.isEnable(j.RowColumnStates.selected,!0),z=v&&v.isEnable(j.RowColumnStates.selected,!1),a&&(A=void 0,(y||z)&&(A=g.Ir(g.Er(a.row),g.Fr(a.col),j.SheetArea.viewport,!1)),y&&(B=a.row,C=a.rowCount,A&&A.length>0&&(D=A.findLargestRange(a,!0),D&&(E=f.kf(D.row,D.col,D.rowCount,D.colCount),F=a.union(E),B=F.row,C=F.rowCount)),G=g.cm(f.kf(B,-1,C,-1)),u.x=w(u.x,G.x),u.y=w(u.y,G.y),u.width=x(u.width,G.width),u.height=x(u.height,G.height)),z&&(H=a.col,I=a.colCount,A&&A.length>0&&(J=A.findLargestRange(a,!1),J&&(K=f.kf(J.row,J.col,J.rowCount,J.colCount),F=a.union(K),H=F.col,I=F.colCount)),G=g.cm(f.kf(-1,H,-1,I)),u.x=w(u.x,G.x),u.y=w(u.y,G.y),u.width=x(u.width,G.width),u.height=x(u.height,G.height))),L=aa(u),M=_(u),N=u.x,O=u.y,L>=0||M>=0){if(P=-9,Q=-9,R=18,S=30,u.x+=P,u.y+=Q,u.width+=R,u.height+=S,b&&(u=u.getIntersectRect(b),!u))return;T=g.am(),M>0&&!i&&(g.$l=!0,U.jp(c,new f.Rect(T.x,x(T.nt,O),T.Br,M),d)),L>0&&!i&&(g.$l=!0,U.jp(c,new f.Rect(x(T.kt,N),T.y,L,T.Cr),d)),h.row!==-1||h.col!==-1||i||(g.$l=!0,U.jp(c,T.em(),d)),L>0&&M>0&&((y||z)&&(g.$l=!0),U.jp(c,u,d)),e=!0}return e},a.prototype.VF=function(a,b,c,d,e){var g,h=this,i=h.kj;i.Xq<=0&&(g=h.bm(),g&&(e||(i.$l=!0),h.jp(g,new f.Rect(a,b,c,d))))},a.prototype.repaint=function(a){var b,c=this,d=c.kj;d.Xq>0||(b=c.bm(),b&&(d.$l=!0,c.jp(b,a)))},a.prototype.jp=function(a,b,c){var d=this;a&&d.kj.Xq<=0&&(c||d._l(a,b),d.Pw(a,b))},a.prototype._l=function(a,b,c){var d,e,g,h=this,i=h.kj;a&&i.Xq<=0&&(d=h.vI(),e=d?d:a,g=i.Dr(),b||(b=g),b&&b.round(),c&&c.round(),i.$l&&(i.$l=!1,d&&(d.clearRect(b.x,b.y,aa(b),_(b)),c&&d.clearRect(c.x,c.y,aa(c),_(c)),f.Bn.Dn(d,-g.x,-g.y)),h.AI(e,b),c&&h.AI(e,c),d&&f.Bn.Dn(d,g.x,g.y)),d&&(h.dm(b),c&&h.dm(c)))},a.prototype.Pw=function(a,b){var c,d,f,g,h,i=this,j=i.kj,k=j.CH;if(a&&!(j.Xq>0)&&(b&&b.round(),c=j.am(),e.Worksheet.ao(j,"beforePaintAdornment",{ctx:a,clipRect:b}),!j.fI)){if(k){for(d=c.em(),i.dm(d),g=0;g<=2;g++)d=c.fm(g),d&&0!==aa(d)&&0!==_(d)&&i.dm(d);for(h=0;h<=2;h++)d=c.gm(h),d&&0!==aa(d)&&0!==_(d)&&i.dm(d)}for(g=0;g<=2;g++)for(h=0;h<=2;h++)d=c.Ft(g,h),d&&0!==aa(d)&&0!==_(d)&&(f=b,(k&&(1!==g||1!==h)||j.parent&&j.parent.options.allowUserDragMerge)&&(i.dm(d),f=d),f&&!d.intersectRect(f)||i.BI(a,g,h,f));i.CI(a),e.Worksheet.ao(j,"paintAdornment",{ctx:a,clipRect:b})}},a.prototype.dD=function(a,b){var c=this.kj,d=c.parent,e=d?d.options:{},g=ka(c),h=f.Rm.Om(c,g),i=e.backgroundImage;i&&(h=G),a.save(),a.fillStyle=h,a.fillRect(b.x,b.y,aa(b),_(b)),a.restore()},a.prototype.z0a=function(a){var b=this.kj,c=b.am();return 0===c.Cr&&a===b.ar(3)},a.prototype.A0a=function(a){var b=this.kj,c=b.am();return 0===c.Br&&a===b.$q(3)},a.prototype.DI=function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l.kj,n=m.options,o=m.am(),p=n.sheetAreaOffset.top,q=n.sheetAreaOffset.left,r=0!==o.Cr,s=0!==o.Br,t=m.Gt&&m.Gt()||{x:n.sheetAreaOffset.left,y:n.sheetAreaOffset.top,width:0,height:0},u=0===t.width,v=0===t.height;for(f=0;f<=2;f++)h=o.gm(f),h&&(r&&v&&(h.y=h.y-p,h.height=h.height+p,!s&&u&&(h.x=h.x-q,h.width=h.width+q)),g=b?h.getIntersectRect(b):h,g&&l.EI(a,f,g,c,d));for(e=0;e<=2;e++)for(i=o.fm(e),i&&(s&&u&&(i.x=i.x-q,i.width=i.width+q,!r&&v&&(i.y=i.y-p,i.height=i.height+p)),g=b?i.getIntersectRect(b):i,g&&l.FI(a,e,g,c,d)),f=0;f<=2;f++)j=o.Ft(e,f),l.z0a(m.jCb(e))&&v&&(j.y=j.y-p,j.height=j.height+p),l.A0a(m.kCb(f))&&u&&(j.x=j.x-q,j.width=j.width+q),j&&(g=b?j.getIntersectRect(b):j,g&&l.GI(a,e,f,g,c,d));k=o.em(),k&&(g=b?k.getIntersectRect(b):k,g&&l.HI(a,g,c,d))},a.prototype.II=function(a){var b,c=this,d=c.kj,e=d.am(),f=e.zr,g=e.Ar,h=aa(e),i=e.ot,j=e.gs,k=e.$Lc,l=e.sKc,m=e._Lc,n=e.pKc;n>0&&(a.fillStyle=c.zI(!1),a.fillRect(f,m,h,n)),l>0&&(a.fillStyle=c.zI(!1),a.fillRect(k,g,l,m),b=d.qKc,b&&a.fillRect(k,i,l,j))},a.prototype.B0a=function(a,b){var c=this,d=c.kj,e=c.zI(!1),f=d.options,g=f.sheetAreaOffset.left,h=f.sheetAreaOffset.top,i=b.x,j=b.y,k=aa(b),l=_(b);a.save(),g>0&&ba(a,g,e,i+g/2,h>0?j+h:j,i+g/2,j+x(0,l)),h>0&&ba(a,h,e,g>0?i+g:i,j+h/2,i+x(0,k),j+h/2),g>0&&h>0&&(a.fillStyle=c.zI(!1),a.fillRect(i,j,g,h)),a.beginPath(),a.restore()},a.prototype.AI=function(a,b){var c,d=this,f=d.kj;!a||f.Xq>0||(c=f.Dr(),a.save(),b?a.rect(b.x,b.y,aa(b),_(b)):a.rect(c.x,c.y,aa(c),_(c)),a.clip(),a.beginPath(),d.dD(a,c),e.Worksheet.ao(f,"paint",{ctx:a,clipRect:b}),d.B0a(a,c),d.DI(a,b,!1),d.II(a),d.KI(a),e.Worksheet.ao(f,"paintSheetEnd",{ctx:a,clipRect:b}),a.beginPath(),a.restore())},a.prototype.LI=function(a,b,c){var d,e,g=this,h=g.kj;a&&(d=h.Dr(),a.save(),e=b||new f.Rect(d.x,d.y,aa(d),_(d)),a.rect(e.x,e.y,aa(e),_(e)),a.clip(),a.beginPath(),g.dD(a,d),g.DI(a,e,!0,c),a.beginPath(),a.restore())},a.prototype.CI=function(a){var b,c,d,e,f,g,h,i,j,k=this.kj,l=k.mm,m=k.yt;if(l&&l.isResizing&&m&&(h=m.resizeInfo)){if(i=k.am(),j=F,a.save(),a.strokeStyle!==j&&(a.strokeStyle=j),1!==a.lineWidth&&(a.lineWidth=1),a.beginPath(),"sizeRow"===h.action||"sizeHiddenRow"===h.action)for(c=x(0,h.startY-.5),e=h.movingY-.5,f=i.x+aa(i),b=i.x;b<f;b+=2)a.moveTo(b,c),a.lineTo(b+1,c),a.moveTo(b,e),a.lineTo(b+1,e);else for(b=x(0,h.startX-.5),d=h.movingX-.5,g=i.y+_(i),c=i.y;c<g;c+=2)a.moveTo(b,c),a.lineTo(b,c+1),a.moveTo(d,c),a.lineTo(d,c+1);a.stroke(),a.beginPath(),a.restore()}},a.prototype.HI=function(a,b,c,d){var e,f,g,h,j,k,l,m=this.kj;a.beginPath(),e=m.am().em(),f=e.x,g=e.y,h=aa(e),j=_(e),k=m.getActualStyle(-1,-1,0),this.SI(a,[{data:u,row:-1,col:-1,x:f,y:g,width:h,height:j,style:k.clone()}],0,c,d),l=new i.AF(m,m.Gr(0,0),m.Hr(0,0),0),l.jF(0,0,f,g,h,j),l.paint(a)},a.prototype.KI=function(a){var b,c,d,e,g,h,i,j,k,l=this.kj,m=l.frozenRowCount(),n=l.frozenColumnCount(),o=l.frozenTrailingRowCount(),p=l.frozenTrailingColumnCount();(m||n||o||p)&&(b=l.am(),c=b.pt,d=b.qt,e=b.lt,g=b.ot,h=b.x,i=b.y,j=aa(b),k=_(b),a.save(),a.strokeStyle=f.Rm.Om(l,l.options.frozenlineColor),a.lineWidth=1,a.beginPath(),n&&(a.moveTo(c-.5,i),a.lineTo(c-.5,i+k)),m&&(a.moveTo(h,d-.5),a.lineTo(h+j,d-.5)),p&&(a.moveTo(e-.5,i),a.lineTo(e-.5,i+k)),o&&(a.moveTo(h,g-.5),a.lineTo(h+j,g-.5)),a.stroke(),a.restore())},a.prototype.EI=function(a,b,c,d,e){this.TI(a,-1,b,1,c,d,e)},a.prototype.FI=function(a,b,c,d,e){this.TI(a,b,-1,2,c,d,e)},a.prototype.GI=function(a,b,c,d,e,f){var g,h,i,j,k,l=this.kj,m=l.et;if(m)if(h=m.getCalcService(),h&&h.calcOnDemand)i=m.xf,i.clearValueCache&&i.clearValueCache();else{g=h.jh;for(j in g)g[j].getSource().startCalculation()}if(this.TI(a,b,c,3,d,e,f),g)for(j in g)g[j].getSource().endCalculation();k=this.kj.at,k&&k.UI(a,d,b,c)},a.prototype.VIb=function(a,b,c,d,e){var g,h,i,j=this,k=j.kj,l=k.getRangeRect(b,c,f.kf(e.row,e.col,e.rowCount,e.colCount));l=l.getIntersectRect(k.am().Ft(b,c)),l&&(l.round(),g=e.isValid,a.save(),a.lineWidth=1,a.strokeStyle="mediumblue",g||a.setLineDash([6,2]),h=l.x+.5,i=l.y+.5,a.strokeRect(h,i,aa(l),_(l)),a.beginPath(),a.restore())},a.prototype.BI=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,F,G,H=this,I=H.kj;if(ja(I)){if(!I.addSelection)return;if(i=I.ITa,j=I.mm,k=i.getSelections(),l=k.length,d=H.VI(b,c,d),!d)return;if(m=f.Im.Lm("gc-selection"),n=E(m.zIndex),n>2007&&H.WI(a,b,c,d),o=i.WIb=i.ZHb.getAnchorInfo(I.getActiveRowIndex(),I.getActiveColumnIndex()),o&&H.VIb(a,b,c,d,o),p=H.XI(b,c,k,d),q=p.length,r=void 0,q<=0)return;for(s=H.XI(b,c,[I.p_a],d)[0],t=!1,u=void 0,u=0;u<q;u++)if(r=p[u],!d.containsRect(r)){t=!0;break}if(s&&!d.containsRect(s)&&(t=!0),a.save(),t&&(a.rect(d.x,d.y,aa(d),_(d)),a.clip()),a.beginPath(),q>0)for(h=f.Rm.Om(I,I.getSelectionBackColor()),a.fillStyle!==h&&(a.fillStyle=h),e=0,g=0,n>2007&&(e=1,g=-3),u=0;u<q;u++)r=p[u],a.fillRect(r.x+e,r.y+e,aa(r)+g,_(r)+g);I.sgc||(v=I.Jl,w=I.Kl,s&&(v=I.s_a,w=I.t_a),x=I.getCellRect(v,w,b,c),y=void 0,z=void 0,A=void 0,B=void 0,x&&x.intersectRect(d)&&(y=x.x,z=x.y,A=aa(x),B=_(x),e=1,g=-2,n>2007&&(e=0,g=0),H.Mx(y+e,z+e,A+g,B+g),l>1&&(a.strokeStyle=f.Rm.Om(I,I.getSelectionBorderColor()),a.lineWidth=1,a.strokeRect(y+1.5,z+1.5,A-4,B-4)))),a.restore(),a.save(),a.beginPath(),1===l&&(j&&j.BG&&j.ZI&&j.ZI()&&!j.$I&&(C=j._I&&j._I(),D=I.getRangeRect(b,c,C),F=aa(D),G=_(D),D&&F>0&&G>0&&(a.fillStyle=m&&m.color,a.fillRect(D.x,D.y,F,G))),r&&aa(r)>=0&&_(r)>=0&&(H.YI(d,I,b,c,n),H.aJ(a,b,c,r,d,k[0]))),s&&(a.save(),t&&(a.rect(d.x,d.y,aa(d),_(d)),a.clip()),a.beginPath(),a.fillStyle="rgba(255,255,255,0.4)",a.fillRect(s.x+e,s.y+e,aa(s)+g,_(s)+g),a.fillStyle=h,a.strokeStyle="rgb(124,124,124)",a.lineWidth=1,a.strokeRect(s.x-.5,s.y-.5,aa(s),_(s)),a.restore()),a.beginPath(),a.restore()}},a.prototype.YI=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=b.frozenTrailingRowCount(),r=b.frozenTrailingColumnCount(),s=b.getSelections(),t=b.am(),u=b.getRowCount()-q-1,v=b.getColumnCount()-r-1,w=b.Hr(1,3),x=b.Gr(1,3);1===s.length&&e>2007&&(f=b.frozenRowCount(),g=b.frozenColumnCount(),h=s[0],i=h.row,j=h.col,k=h.rowCount,l=h.colCount,f>0&&(i>=f&&b.gr(i)<f?(a.y-=2,a.height+=2):i+k<=f&&b._q(i+k-1)===b.lq&&(a.height+=2)),g>0&&(j>=g&&b.br(j)<g?(a.x-=2,a.width+=2):j+l<=g&&b.Zq(j+l-1)===b.qq&&(a.width+=2)),0===i&&0===j&&(a.x-=2,a.y-=2,a.width+=2,a.height+=2),i===-1&&(i=0,k=b.getRowCount()),j===-1&&(j=0,l=b.getColumnCount()),m=!1,n=!1,o=x.findRow(u),p=w.findCol(v),o&&o.y+_(o)<t.qt+b.oKc(t)&&(m=!0),p&&p.x+aa(p)<t.pt+b.rKc(t)&&(n=!0),m&&i+k-1===u&&(a.height+=2),n&&j+l-1===v&&(a.width+=2))},a.prototype.WI=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=F.kj,H=G.ITa.getSelections(),I=G.am(),J=I.kt,K=I.nt,L=H.length,M=0!==I.Cr,N=0!==I.Br;if(!(L<=0)){if(e=H[0],f=e.row,g=e.rowCount,h=e.col,i=e.colCount,f===-1&&(f=0),h===-1&&(h=0),g===-1&&(g=G.getRowCount()),i===-1&&(i=G.getColumnCount()),a.save(),a.beginPath(),a.lineWidth=2,a.strokeStyle=G.getSelectionBorderColor(),j=d.x,k=d.y,l=aa(d),m=_(d),n=G.frozenRowCount(),M&&(1!==L||0!==n||G.lq<=f||G.lq>=f+g))for(o=F.bJ(c),p=0,q=o.length;p<q;p++)r=o[p],s=0,t=0,u=r.x,v=r.x+aa(r),r.x<j+l&&j<r.x+aa(r)&&(1===L&&(0===n&&G.lq===f||n>0&&0===f)&&(s=-1,t=1),r.x<j&&(s=0,u=j),r.x+aa(r)>j+l&&(t=0,v=j+l),a.moveTo(u+s-1,K-1),a.lineTo(v+t,K-1),a.stroke());if(w=G.frozenColumnCount(),N&&(1!==L||0!==w||G.qq<=h||G.qq>=h+i))for(x=F.cJ(b),y=0,z=x.length;y<z;y++)A=x[y],B=0,C=0,D=A.y,E=A.y+_(A),A.y<k+m&&k<A.y+_(A)&&(1===L&&(0===w&&G.qq===h||w>0&&0===h)&&(B=-1,C=1),A.y<k&&(B=0,D=k),A.y+_(A)>k+m&&(C=0,E=k+m),a.moveTo(J-1,D+B-1),a.lineTo(J-1,E+C),a.stroke());a.beginPath(),a.restore()}},a.prototype.bJ=function(a){var b,c,d,e,g,h,i,j,k,l,m,n,o=this.kj,p=o.ITa.getSelections(),q=p.length,r=o.Hr(a),s=[],t={};for(c=0;c<q;c++)if(d=p[c])if(e=d.col,e===-1)g=o.Hr(0,3),h=o.Hr(1,3),i=o.Hr(2,3),j=-1,k=-1,g.length>0&&(j=g[0].x,k=g[g.length-1].x+g[g.length-1].width-j,s.push(new f.Rect(j,(-1),k,(-1)))),h.length>0&&(j=h[0].x,k=h[h.length-1].x+h[h.length-1].width-j,s.push(new f.Rect(j,(-1),k,(-1)))),i.length>0&&(j=i[0].x,k=i[i.length-1].x+i[i.length-1].width-j,s.push(new f.Rect(j,(-1),k,(-1))));else if(r&&(l=r.findCol(e),m=r.findCol(e+d.colCount-1),l||m)){if(n=new f.Rect((-1),(-1),(-1),(-1)),l?n.x=l.x:n.x=r[0].x,m?n.width=m.x+aa(m)-n.x:n.width=r[r.length-1].x+r[r.length-1].width-n.x,b=[n.x,n.width].join("_"),t[b])continue;t[b]=!0,s.push(n)}return s},a.prototype.cJ=function(a){var b,c,d,e,g,h,i,j,k,l,m,n,o=this.kj,p=o.ITa.getSelections(),q=p.length,r=o.Gr(a),s=[],t={};for(c=0;c<q;c++)if(d=p[c])if(e=d.row,e===-1)g=o.Gr(0,3),h=o.Gr(1,3),i=o.Gr(2,3),j=-1,k=-1,g.length>0&&(j=g[0].y,k=g[g.length-1].y+g[g.length-1].height-j,s.push(new f.Rect((-1),j,(-1),k))),h.length>0&&(j=h[0].y,k=h[h.length-1].y+h[h.length-1].height-j,s.push(new f.Rect((-1),j,(-1),k))),i.length>0&&(j=i[0].y,k=i[i.length-1].y+i[i.length-1].height-j,s.push(new f.Rect((-1),j,(-1),k)));else if(r&&(l=r.findRow(e),m=r.findRow(e+d.rowCount-1),l||m)){if(n=new f.Rect((-1),(-1),(-1),(-1)),l?n.y=l.y:n.y=r[0].y,m?n.height=m.y+_(m)-n.y:n.height=r[r.length-1].y+r[r.length-1].height-n.y,b=[n.y,n.height].join("_"),t[b])continue;t[b]=!0,s.push(n)}return s},a.prototype.aJ=function(a,b,c,d,e,g){var h,i,j=this,k=j.kj,l=k.parent,m=k.mm,n=d.x,o=d.y,p=aa(d),q=_(d),r=k.getViewportTopRow(b),s=k.getViewportLeftColumn(c),t=k.getViewportBottomRow(b),u=k.getViewportRightColumn(c),v=0,w=0,x=k.am(),y=0!==x.Cr,z=0!==x.Br;z||g.col!==s&&g.col!==-1||(v=2),y||g.row!==r&&g.row!==-1||(w=2),g.row+g.rowCount===t+1&&(e.height=e.height+1),g.col+g.colCount===u+1&&(e.width=e.width+1),p>=0&&q>=0&&(!e||d.intersect(e.x-1,e.y-1,aa(e)+2,_(e)+2))&&(a.save(),e&&!e.containsRect(d)&&(a.rect(e.x-v,e.y-w,aa(e),_(e)),a.clip()),a.beginPath(),a.strokeStyle=f.Rm.Om(k,k.getSelectionBorderColor()),a.lineWidth=2,p>0&&q>0?(m&&m.BG?(h=m.dJ,2===h?(a.moveTo(n+.5,o-.5),a.lineTo(n+p-1,o-.5)):3===h?(a.moveTo(n+.5,o+q-.5),a.lineTo(n+p-1,o+q-.5)):0===h?(a.moveTo(n-.5,o+.5),a.lineTo(n-.5,o+q-1)):1===h&&(a.moveTo(n+p-.5,o+.5),a.lineTo(n+p-.5,o+q-1))):(i=l&&l.Vv,i>2007?a.rect(n-1,o-1,p+1,q+1):a.rect(n-.5,o-.5,p,q)),a.stroke(),l&&l.options.allowUserDragFill&&j.eJ&&j.eJ(a,b,c,d,e)):0!==p&&0!==q||a.strokeRect(n-1,o-1,p+1,q+1),a.beginPath(),a.restore())},a.prototype.VI=function(a,b,c){var d,e,f,g,h=this.kj,i=h.am(),j=i.Ft(a,b);return 1===b&&(d=h.Hr(b),e=d.length>0?d[d.length-1]:u,e&&(j.width=w(aa(j),e.x+aa(e)-i.pt))),1===a&&(f=h.Gr(a),g=f.length>0?f[f.length-1]:u,g&&(j.height=w(_(j),g.y+_(g)-i.qt))),c=c?c.getIntersect(j.x,j.y,aa(j),_(j)):j},a.prototype.XI=function(a,b,c,d){var e,f,g,h,i=this.kj,j=i.ITa,k=c.length,l=[];for(h=0;h<k;h++)f=c[h],f&&(e=j.findSpan(f.row,f.col),e&&e.containsRange(f)&&(f=e),g=i.getRangeRect(a,b,f),g&&g.x<=d.x+aa(d)&&g.y<=d.y+_(d)&&d.x<=g.x+aa(g)&&d.y<=g.y+_(g)&&l.push(g));return l},a.prototype.fJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;if(a.save(),d=b.x,e=b.y,f=aa(b),g=_(b),h=[6,6],a.setLineDash)a.beginPath(),a.lineWidth=2,a.strokeStyle=c,a.setLineDash(h),a.rect(d,e,f-1,g-1),a.stroke();else{for(a.beginPath(),a.lineWidth=2,a.strokeStyle=c,i=h[0],j=h[1],k=void 0,l=void 0,m=void 0,n=void 0,k=d,l=e,m=f;m>0;)if(m>=i+j)a.moveTo(k,l),a.lineTo(k+i,l),k=k+i+j,m=m-i-j;else{if(m>=i){a.moveTo(k,l),a.lineTo(k+i,l),m=m-i-j;break}if(m>0){a.moveTo(k,l),a.lineTo(k+m,l),m=m-i-j;break}}for(k=d+f-1,l=e+1,n=g-1,m<0&&(m=y(m),m>j&&(a.moveTo(k,l-2),a.lineTo(k,l+(m-j))),l+=m,n-=m);n>0;)n>=i+j?(a.moveTo(k,l),a.lineTo(k,l+i),l=l+i+j,n=n-i-j):n>=i?(a.moveTo(k,l),a.lineTo(k,l+i),n=n-i-j):n>0&&(a.moveTo(k,l),a.lineTo(k,l+n),n=n-i-j);for(k=d+f-2,l=e+g-1,m=f-1,n<0&&(n=y(n),n>j&&(a.moveTo(k+2,l),a.lineTo(k-(n-j),l)),k-=n,m-=n);m>0;)if(m>=i+j)a.moveTo(k,l),a.lineTo(k-i,l),k=k-i-j,m=m-i-j;else{if(m>=i){a.moveTo(k,l),a.lineTo(k-i,l),m=m-i-j;break}if(m>0){a.moveTo(k,l),a.lineTo(k-m,l),m=m-i-j;break}}for(k=d,l=e+g-2,n=g-1,m<0&&(m=y(m),m>j&&(a.moveTo(k,l+2),a.lineTo(k,l-(m-j))),l-=m,n-=m);n>0;)n>=i+j?(a.moveTo(k,l),a.lineTo(k,l-i),l=l-i-j,n=n-i-j):n>=i?(a.moveTo(k,l),l-i===e?a.lineTo(k,l-i-1):a.lineTo(k,l-i),n=n-i-j):n>0&&(l>e&&(a.moveTo(k,l),a.lineTo(k,l-n)),n=n-i-j);a.stroke()}a.beginPath(),a.restore()},a.prototype.XIb=function(a,b,c,d,e,f,g){var h,i,j,k,l;e&&0!==b.length&&(h=b[0].col-1,i=b[b.length-1].col+1,j=c.zHb(d.row,h,g,1),h>=0&&f.isValid&&!f.isValid(d.row,h,j)&&a.push({style:f.getDataValidator(d.row,h).highlightStyle(),x:b[0].x-f.getColumnWidth(h),y:d.y,width:f.getColumnWidth(h),height:d.height}),k=c.zHb(d.row,i,g,1),f.isValid&&!f.isValid(d.row,i,k)&&(l=b[b.length-1],a.push({style:f.getDataValidator(d.row,i).highlightStyle(),x:l.x+l.width,y:d.y,width:f.getColumnWidth(i),height:d.height})))},a.prototype.YIb=function(a,b,c){var d,e,f,g,h=b.ss,i=a.row,j=a.col,k={},l={},m=[],n=a.rowCount,o=a.colCount;for(d=0;d<o;d++)l[d]=b.Tl(d+j,c);for(e=0;e<n;e++){if(k[e]=b.Sl(e+i,c),f=[],k[e]>0)for(g=0;g<o;g++)f.push(l[g]>0?h.Ym(i+e,j+g,c):v);m.push(f)}return{rowSizes:k,colSizes:l,styleList:m}},a.prototype.TI=function(a,b,d,f,g,h,m){var n,o,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J,K,L,M,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka;if(q(f)&&(f=3),n=this,o=n.kj,r=o.parent,s=o.am().Ft(b,d),t=r&&r.options.resizeZeroIndicator,u=o.Gr(b,f),v=o.Hr(d,f),w=o.options.sheetAreaOffset,x=o.Gt&&o.Gt()||{x:w.left,y:w.top,width:0,height:0},y=!1,z=u.length,A=v.length,!(z<0||A<0)){for(B=o.Ir(b,d,f,!0),C=B.length>0,H=o.ss,K=0,L=0,M=0,O=0,R=new i.AF(o,u,v,f),S=[],T=[],U=[],W=[],X=!h&&3===f&&r&&r.options.highlightInvalidData,a.save(),a.beginPath(),Y=[],Z=-1,$=-1,ba=o.ar(3),ca=o.$q(3),da=o.am(),ea=0===da.Cr&&0===x.height,fa=0===da.Br&&0===x.width,ga=!!k(this.kj),ha=!1,ia=c("SheetsCalc"),ja=o.getActiveRowIndex(),ka=o.getActiveColumnIndex(),la=this.ZIb(f,o,ja,ka),ma=0;ma<z;ma++)for(E=u[ma],n.XIb(W,v,H,E,X,o,f),na=0;na<A;na++)if(F=v[na],G=C&&B.findCell(E.row,F.col),G?(I=G.row,J=G.col,K=G.x,L=G.y,M=aa(G),O=_(G),G.isAutoMerge&&(oa=n.$Ib(G,b,d,f),K=oa.x,L=oa.y,M=oa.width,O=oa.height),G.spanSizeInfo||(G.spanSizeInfo=n.YIb(G,o,f))):(I=E.row,J=F.col,K=F.x,M=aa(F),F.y===-1?L=E.y:(L=D(F.y*E.height+E.y),y=!0),_(F)===-1?O=_(E):(O=E.height+E.y-L,y=!0)),1===t&&(b===-1&&o.getColumnVisible(J)&&0===o.$r(J)&&(($<0||$!==J-1)&&Y.push({x1:K,y1:L,x2:K,y2:L+O,horizontal:!1}),$=J),d===-1&&o.getRowVisible(I)&&0===o.Yr(I)&&((Z<0||Z!==I-1)&&Y.push({x1:K,y1:L,x2:K+M,y2:L,horizontal:!0}),Z=I)),(!g||!(K+M<=g.x||K>=g.x+aa(g)||L+O<=g.y||L>=g.y+_(g))||y&&!(y&&K>g.x+aa(g)))&&0!==M&&0!==O&&!(1===f&&na<A-1&&v[na+1].x-K===0||(pa=!1,G&&l.Bb(S,G)))){if(qa=!1,P=H.zHb(I,J,f,1),ra=o.jZ&&o.jZ(),la&&0===I&&J>=la.dj&&la.cj+la.Xj>o.lq&&J<la.dj+la.OZ){if(P=o.getCell(la.cj,J).text()+"",pa=!0,qa=la.filterButtonVisible(),ra)for(sa=0;sa<ra.length;sa++)if(ra[sa].col===J&&ra[sa].rowFilter.sj===la){this._Ib(ra[sa],1,0,!0);break}}else if(ra&&ra.length>0&&(ta=ra.length-1,ua=ra[ta].rowFilter&&ra[ta].rowFilter.sj))for(sa=ra.length-1;sa>=0;sa--)if(ra[sa].tableColumnHeaderFilter&&ra[sa].col===J){this._Ib(ra[sa],3,ua.cj,!1);break}Q=H.Ym(I,J,f),X&&o.isValid&&!o.isValid(I,J,P)&&W.push({style:o.getDataValidator(I,J).highlightStyle(),x:K,y:L,width:M,height:O}),3===f&&(va=Q.formatter,ia&&va&&p(va)&&(!h||o.pivotTables&&o.pivotTables.findPivotTable(I,J))&&(wa=o.parent&&o.parent.aJb(va),wa&&(xa=wa.getExpression(),P=ia.evaluateExpression(o,xa,I,J)))),pa&&(Q.hAlign=0),V={data:P,row:I,col:J,x:K,y:L,width:M,sparkline:ga&&o.getSparkline(I,J),height:O,style:Q,cellLayout:G,tableFilter:qa,columnHeaderFitMode:1===f&&o.sYc(J)},V.columnHeaderFitMode===j.ColumnHeaderFitMode.stack&&na<A-1&&(ya=o.Zq(F.col,f,!0),ya&&(za=v.findCol(ya),za&&za.y!==-1&&(V.cornerX=za&&za.x,V.cornerY=D((za&&za.y)*E.height)+E.y))),T.push(V),G&&S.push(G),V.style&&4===V.style.hAlign&&(ha=!0),R.jF(I,J,K,L,M,O,Q,G,I===ba&&ea,J===ca&&fa,V)}if(T.length>0){if(3===f&&(o.options.allowCellOverflow||ha)&&(Aa=H.Sm(b,d,function(){return new N(o,b,d)}),U=n.hJ(a,Aa,T,R,m),U.length>0)){for(Ba=g.x,Ca=g.x+g.width,ma=0;ma<U.length;ma++)Da=U[ma],Da&&(Ea=Da.row,Fa=Da.col,Ga=Da.cellOverflowLayout&&Da.cellOverflowLayout.layout,Ga&&(Ha=Ga.x,Ia=Ha+Ga.width,Ha<Ba&&(Ba=Ha),Ia>Ca&&(Ca=Ia)),R.jF(Ea,Fa,Da.x,Da.y,Da.width,Da.height,Da.style,Da.cellLayout,Ea===ba&&ea,Fa===ca&&fa,Da));T=T.concat(U),h||(g.x=Ba,g.width=Ca-Ba,s&&(g=g?s.getIntersectRect(g):s))}1===f&&y&&n.WYc(T,v,R,g,h,s,ba,ca,ea,fa),g&&(Ja=o.printInfo&&o.printInfo(),h&&Ja&&(Ja.columnStart()>0||Ja.rowStart()>0)&&!Ja.showBorder()?a.rect(g.x-(Ja.columnStart()>0?2:0),g.y-(Ja.rowStart()>0?2:0),aa(g)+(Ja.columnStart()>0?4:0),_(g)+(Ja.rowStart()>0?4:0)):a.rect(g.x,g.y,aa(g),_(g)),a.clip()),n.SI(a,T,f,h,m)}e.Worksheet.ao(o,"paintViewport",{ctx:a,rowViewportIndex:b,colViewportIndex:d,sheetArea:f,clipRect:g,isPrinting:h}),R.paint(a),Y.length>0&&n.iJ(a,Y,1,3),W.length>0&&(Ka=s.getIntersectRect(g),a.rect(Ka.x,Ka.y,aa(Ka),_(Ka)),a.clip(),n.jJ(a,W)),a.restore()}},a.prototype._Ib=function(a,b,c,d){a.sheetArea=b,a.row=c,a.tableColumnHeaderFilter=d},a.prototype.ZIb=function(a,b,c,d){if(b.tables&&1===a&&0===b.frozenRowCount()&&0===b.frozenColumnCount()){var e=b.tables.find(c,d);if(e&&e.MZ&&e.cj<b.lq)return e}return null},a.prototype.$Ib=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o=a.row,p=a.col,q=a.x,r=a.y,s=a.width,t=a.height,u=this.kj,v=u.am();return 1!==b||3!==d&&2!==d||(e=v.fm(b),g=u.frozenRowCount(),h=u.getRowCount(d)-u.frozenTrailingRowCount()-1,i=e.y,j=e.height,r<i&&g<=o&&o<=h&&(t-=i-r,r=i),r+t>i+j&&g<=o+a.rowCount-1&&o+a.rowCount-1<=h&&(t-=r+t-(i+j))),1!==c||3!==d&&1!==d||(e=v.gm(c),k=u.frozenColumnCount(),l=u.getColumnCount(d)-u.frozenTrailingColumnCount()-1,m=e.x,n=e.width,q<m&&k<=p&&p<=l&&(s-=m-q,q=m),q+s>m+n&&k<=p+a.colCount-1&&p+a.colCount-1<=l&&(s-=q+s-(m+n))),new f.Rect(q,r,s,t)},a.prototype.iJ=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(0!==b.length)for(e=0,f=b.length;e<f;e++)g=b[e],h=g.x1,i=g.y1,j=g.x2,k=g.y2,l=g.horizontal,a.beginPath(),a.save(),a.lineWidth=c,a.strokeStyle=this.kJ(a,l,h,i,j,k),a.fillStyle=this.lJ(a,l,h,i,j,k),l?(m=-3,n=1,o=-1,p=-2,a.fillRect(h,i+m,j-h-1,d+2*c),i+=.5,k+=.5,a.moveTo(h+o,i+m),a.lineTo(j+p,k+m),a.moveTo(h+o,i+n),a.lineTo(j+p,k+n)):(q=-3,r=1,s=0,t=-1,a.fillRect(h+q,i+s,d+2*c,k-i-1),h+=.5,j+=.5,a.moveTo(h+q,i+s),a.lineTo(j+q,k+t),a.moveTo(h+r,i+s),a.lineTo(j+r,k+t)),a.stroke(),a.restore()},a.prototype.lJ=function(a,b,c,d,e,g){var h,i,j,k,l,m=b?H:I,n=f.Im.Km(0,"gc-"+m+"-normal"),o=n&&n.backgroundColor,p=n&&n.backgroundImage;if(!b&&p&&p.indexOf("linear-gradient")!==-1)for(i=f.Ul.wl(p),h=a.createLinearGradient(c,d,e,g),j=0,k=i.length;j<k;j++)l=i[j],h.addColorStop(l.point,l.color);else o&&(h=o);return h},a.prototype.kJ=function(a,b,c,d,e,g){var h=a.createLinearGradient(c,d,e,g),i=b?H:I,j=f.Im.Km(0,"gc-"+i+"-normal");return b?(h.addColorStop(0,j.borderTopColor),h.addColorStop(1,j.borderBottomColor)):(h.addColorStop(0,j.borderLeftColor),h.addColorStop(1,j.borderRightColor)),h},a.prototype.jJ=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.kj,n=m.vu();if(b)for(c=b.length,d=0;d<c;d++)e=b[d],f=e.x,g=e.y,h=e.width,i=e.height,j=e.style,k=j.type,0===k&&this.hyb(a,f,g,h,i,j),1===k&&this.iyb(a,f,g,h,i,j),2===k&&this.jyb(a,f,g,h,i,j,n)},a.prototype.hyb=function(a,b,c,d,e,f){var g=f.color,h=b-4,i=c-4,j=d+8,k=e+8,l=.5522848,m=j/2*l,n=k/2*l,o=h+j,p=i+k,q=h+j/2,r=i+k/2;a.save(),a.lineWidth=2,a.strokeStyle=g,a.beginPath(),a.moveTo(h,r),a.bezierCurveTo(h,r-n,q-m,i,q,i),a.bezierCurveTo(q+m,i,o,r-n,o,r),a.bezierCurveTo(o,r+n,q+m,p,q,p),a.bezierCurveTo(q-m,p,h,r+n,h,r),a.closePath(),a.stroke(),a.restore()},a.prototype.iyb=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;b-=.5,c-=.5,m=Math.min(d/2,e/2),n=f.color,o=f.position,a.save(),a.lineWidth=2,a.strokeStyle=n,a.beginPath(),a.rect(b,c,d,e),a.stroke(),a.restore(),a.save(),a.beginPath(),0===o?(g=b,h=c,i=b,j=h+m,k=g+m,l=h):2===o?(g=b+d,h=c+e,i=g,j=h-m,k=g-m,l=h):3===o?(g=b,h=c+e,i=b,j=h-m,k=g+m,l=h):1===o&&(g=b+d,h=c,i=g,j=h+m,k=g-m,l=h),a.moveTo(g,h),a.lineTo(i,j),a.lineTo(k,l),a.fillStyle=n,a.fill(),a.closePath(),a.restore()},a.prototype.jyb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;if(b-=.5,c-=.5,h=this.kj,i=h.zoom(),l=15,m=15,n=f.image,o=f.position,p=3,q=f.color,a.save(),a.beginPath(),a.lineWidth=2,a.strokeStyle=q,a.rect(b,c,d,e),a.stroke(),n&&"none"!==n&&g){4===o?j=b-(l+p):5===o&&(j=b+d+p);try{g.ko(n)?(r=g.lo(n),k=c+e/2-m/2,a.drawImage(r,j,k,l,m)):g.fo(n)}catch(a){}}else 4===o?j=b-(l+p)*i:5===o&&(j=b+d+p*i),k=c+e/2-m*i/2,a.translate(j,k),a.scale(.015*i,.015*i),a.beginPath(),a.moveTo(512,0),a.bezierCurveTo(229.248,0,0,229.184,0,512),a.bezierCurveTo(0,794.816,229.248,1024,512,1024),a.bezierCurveTo(794.752,1024,1024,794.752,1024,512),a.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),a.closePath(),a.moveTo(783.488,692.992),a.lineTo(692.9920000000001,783.4879999999999),a.lineTo(512,602.496),a.lineTo(331.00800000000004,783.4879999999999),a.lineTo(240.51200000000006,692.992),a.lineTo(421.504,512),a.lineTo(240.512,330.944),a.lineTo(331.008,240.44800000000004),a.lineTo(512,421.44),a.lineTo(692.992,240.384),a.lineTo(783.4879999999999,330.88),a.lineTo(602.496,512),a.lineTo(783.488,692.992),a.closePath(),a.fillStyle=q,a.fill(),a.stroke();a.restore()},a.prototype.SI=function(a,b,c,d,g,h,i,j,l){var m,p,q,r,s,v,w,x,y,z,A,B,C,D,E,G,H,I,J,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,ba,ca,da,ea,fa,ga,ha,ia,ja,la;for(void 0===i&&(i=0),void 0===j&&(j=0),void 0===l&&(l=1),m=this,p=m.kj,q=3===c,r=(h?h.zoom():p.zoom())*l,s=t(m.Bl(),r),v=p.getDefaultStyle(c),w=p.Al(c),x=m.kj.conditionalFormats,y=ka(p),z=p.$q(2),A=p.ar(1),B=h?h.vu():p.vu(),a.save(),a.beginPath(),a.fillStyle=v&&v.foreColor||F,o(a,s.font),a.textAlign=q?"right":"center",E=b.length,$=[],ca={sheet:p,row:-1,col:-1,fontInfo:u,lineHeight:-1,imageLoader:B,conditionalFormats:x,sheetArea:c,parentBackColor:y},da=[],C=0;C<E;C++)G=b[C],I=G.data,R=G.tableFilter,J=G.row,L=G.col,M=G.x,N=G.y,O=aa(G),P=_(G),1!==c||da[J]||(da[J]=p.getRowHeight(J,c)),Q=G.style,V=G.cellOverflowLayout,S=G.columnHeaderFitMode,T=G.cornerX,U=G.cornerY,Y=Q.font?t(Q.font,r):s,d&&typeof g===K&&1!==g&&(Y=t(Y.font,g)),Q.font=Y.font,O>0&&P>0&&(H=Q.cellType||w,M--,N--,O++,P++,q?ca.sparkline=G.sparkline:(X=d?0:m.mJ(J,L,c),ca.visualState=X),Z=n(Y.font),ca.lineHeight=Z,ca.row=J+i,ca.col=L+j,ca.fontInfo=Y,ca.cellOverflowLayout=V,ea=da.length&&P!==da[J]+1,ca.needTopGridline=1===c&&J===A||0===c||ea,ca.needLeftGridline=2===c&&L===z||0===c||ea,ca.isPrinting=d,ca.printZoomFactor=g,ca.columnHeaderFitMode=S,ca.cornerX=T,ca.cornerY=U,H.jp(a,I,M,N,O,P,Q,ca,R),V&&!ca.showBarIconOnly&&(fa=new f.Rect(M,N,O,P),ga=H.Ama?H.Ama(a,fa,Q,ca):fa,$.push({cellType:H,data:I,x:ga.x,y:ga.y,width:ga.width,height:ga.height,style:Q,richText:W,options:{sheet:p,row:J,col:L,fontInfo:Y,lineHeight:Z,cellOverflowLayout:V,parentBackColor:y,imageLoader:B}})));if(E=$.length,E>0)for(ha=p.isEditing(),ia=p.Jl,ja=p.Kl,D=0;D<E;D++)ba=$[D],I=ba.data,ca=ba.options,ha&&ca.row===ia&&ca.col===ja||(la=k(this.kj),la&&I&&"SparklineExValue"===I.typeName||m.BWa(a,ba));for(a.restore(),E=b.length,C=0;C<E;C++)G=b[C],e.Worksheet.ao(p,"paintCell",{ctx:a,sheetArea:c,cell:G,isPrinting:d})},a.prototype.BWa=function(a,b){var c,d,e=b.cellType,g=b.data,h=b.x,i=b.y,j=aa(b),k=_(b),l=b.style,m=b.options,n=m.cellOverflowLayout;n&&e.uxb&&(c=n.layout,d=new f.Rect(c?c.x:h,c?c.y:i,c?c.width:j,c?c.height:k),e.uxb(a,d,m,g)),e.paintValue&&e.paintValue(a,g,h,i,j,k,l,m)},a.prototype.mJ=function(a,b,c){var d=this.kj,e=0;return ja(d)&&(3===c||q(c)?!d.isEditing()&&d.wt(a,b)?e=3:d.vp(a,b,c)&&(e=2):(d.vp(a,b,c)&&(e=1,d.wp(a,b,c)&&(e=2)),d.xt(a,b,c)&&(e=4))),e},a.prototype.hJ=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z=this.kj,A=z.ss,B=c.length,C=[],D={},E=[],F=function(x){var y,B,F,G,H,I,J,K,L,M,N,O,P,Q,R;if(g=c[x],j=g.row,k=g.col,l=g.y,n=_(g),s=b.nJ(j,a,e),t=s.headingOverflowlayouts,v=s.trailingOverflowLayouts,!D[j]){for(y={},B=0,F=s;B<F.length;B++)G=F[B],y[G.column]=!1;t&&t.forEach(function(a){y[a.column]=!1}),v&&v.forEach(function(a){y[a.column]=!1}),D[j]=y}for(H=D[j],w=s.find(k),I=0;I<w.length;I++)if(J=w[I]){if(K=z.getCellRect(j,J.column,u,u,!0),!H[J.column]){if(L=J.column,i=A.Ym(j,L),i.showEllipsis)continue;h=A.zHb(j,L,3,1,i),m=J.columnWidth,o=J.backgroundWidth,p=J.backgroundLeftWidth<0?K.x:J.backgroundRightWidth<0?K.x+aa(K)-o:4===i.hAlign?K.x+J.expandedWidth/2-J.backgroundLeftWidth:K.x+aa(K)/2-J.backgroundLeftWidth,r={data:h,row:j,col:L,x:K.x,y:l,width:m,height:n,cellOverflowLayout:J,style:i},C.push(r),J.layout=new f.Rect(p,l,o,n),i=A.Ym(j,L),d.gF(j,L,J,i,K.x,l,m,n),H[J.column]=!0}J.column===k&&H[J.column]&&E.push(x)}if(t)for(M=0;M<t.length;M++)if(N=t[M],N&&!H[N.column]&&N.contains(g.col)){if(k=N.column,i=A.Ym(j,k),i.showEllipsis)continue;h=A.zHb(j,k,3,1,i),m=N.columnWidth,o=N.backgroundWidth,O=z.getCellRect(j,N.endColumn,u,u,!0),p=O.x+aa(O)-o,r={data:h,row:j,col:k,x:p,y:l,width:m,height:n,style:i,cellOverflowLayout:N},C.push(r),N.layout=new f.Rect(p,l,o,n),H[N.column]=!0,d.gF(j,k,N,i,p,l,m,n)}if(v)for(P=0;P<v.length;P++)if(Q=v[P],Q&&!H[Q.column]&&Q.contains(g.col)){if(k=Q.column,i=A.Ym(j,k),i.showEllipsis)continue;h=A.zHb(j,k,3,1,i),m=Q.columnWidth,o=Q.backgroundWidth,R=z.getCellRect(j,Q.startColumn,u,u,!0),p=R.x,q=R.x+o-m,r={data:h,row:j,col:k,x:q,y:l,width:m,height:n,style:i,cellOverflowLayout:Q},C.push(r),Q.layout=new f.Rect(p,l,o,n),d.gF(j,k,Q,i,p,l,m,n),H[Q.column]=!0}};for(x=0;x<B;x++)F(x);if(E.length>0)for(y=E.length-1;y>=0;y--)c.splice(E[y],1);function G(a,b){var c=a.row,d=b.row,e=a.col,f=b.col;return c!==d?c-d:e!==f?e-f:void 0}return C.length>0&&C.sort(G),C},a.prototype.WYc=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,w=this,x=[],y=w.XYc(a[0].col,a[0].x),z=[];for(k=0;k<y.length;k++)z.push(y[k]);for(k=0;k<b.length;k++)z.push(b[k]);for(c.pJ=z,l=[],m=c.pJ.length,o=0;o<m;o++)n=c.pJ[o],n.width>0&&l.push(n.col);if(l.push(l[l.length-1]+1),c._E=l,x=w.YYc(y,a),x.length>0){for(p=d.x,q=d.x+d.width,k=x.length-1;k>=0;k--)r=x[k],r&&(s=r.overflowLayout,s&&(t=s.x,u=t+s.width,t<p&&(p=t),u>q&&(q=u)),a.unshift(r),c.jF(r.row,r.col,r.x,r.y,r.width,r.height,r.style,v,r.row===g&&i,r.col===h&&j,r));e||(d.width=q-p,f&&(d=d?f.getIntersectRect(d):f))}},a.prototype.XYc=function(a,b){var c,d,e,f,g,i=new h.yp,k=this,l=k.kj,m=l.ss,n=l.ITa,o=a,p=[],r=[],s=[],t=o,u=b,v=l.getColumnCount()-l.frozenTrailingColumnCount(),w=l.frozenColumnCount()-1;for(e=o-1;e>w;e--)if(p[e]=c=m._m(e),c){if(r[e]=n.getColumnHeaderFitMode(!1,j.SheetArea.colHeader,e),s[e]=n.MTa(-1,e,-1,1,j.SheetArea.colHeader),r[e]!==j.ColumnHeaderFitMode.stack)break;t=e,u-=c}for(f=t;f<o;f++)p[f]||(p[f]=m._m(f)),q(r[f])&&(r[f]=n.getColumnHeaderFitMode(!1,j.SheetArea.colHeader,f)),d=p[f],g=l.ZYc(f,u,v,t,p,r,s),i.push(g),u+=d;return i},a.prototype.YYc=function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o=this,p=o.kj,q=p.ITa,r=p.ss,s=p.Gr(1,1),t=[],u=s.length,v=a.length,w=function(n){var o,u;for(c=s[n],o=function(o){var s,u,w,x,y=a[o];if(y){if(d=c.row,e=y.col,k=y.x,l=y.y===-1?c.y:D(y.y*c.height+c.y),h=aa(y),i=_(y)===-1?_(c):c.height+c.y-l,g=r.zHb(d,e,1,1,f),f=r.Ym(d,e,1),m={data:g,row:d,col:e,x:k,y:l,width:h,height:i,style:f,overflowLayout:y,columnHeaderFitMode:q.getColumnHeaderFitMode(!1,j.SheetArea.colHeader,e)},f.showEllipsis&&m.columnHeaderFitMode!==j.ColumnHeaderFitMode.stack)return"continue";m.columnHeaderFitMode===j.ColumnHeaderFitMode.stack&&(o===v-1?(s=b[0].col,u=b.filter(function(a){return a.row===n&&a.col===s})[0],m.cornerX=u&&u.x,m.cornerY=u&&u.y):(w=p.Zq(e,1,!0),w&&(x=a.findCol(w),x&&x.y!==-1&&(m.cornerX=x.x,m.cornerY=D(x.y*c.height)+c.y)))),t.push(m)}},u=0;u<v;u++)o(u)};for(n=0;n<u;n++)w(n);return t},a}(),b.oJ=O,P=".cutCopyIndicator",Q=f.Events.CellChanged,R=f.Events.ClipboardChanged,S=f.Events.ValueChanged,T=f.Events.ColumnChanged,U=f.Events.RowChanged,V=f.Events.RangeChanged,W=f.Events.ClipboardPasting,X=f.Events.ClipboardPasted,Y=f.Events.DragMerging,Z=f.Events.FloatingElementSelected,$=function(){function a(a){var b=this;b.yJ=!1,b.zJ=!1,b.kj=a,b.AJ()}return a.prototype.jx=function(a){var b=this;return 0===arguments.length?b.zJ:void(b.zJ=a)},a.prototype.BJ=function(a,b){var c,d=this;return 0===arguments.length?d.yJ:void((d.yJ!==a||a||b)&&(d.yJ=a,c=d.kj,c&&(c.$p(),q(d.Lfc)||clearTimeout(d.Lfc),d.Lfc=setTimeout(function(){if(!d.yJ){var a=c.tu();a&&a.hZ(b)}d.Lfc=u}))))},a.prototype.AJ=function(){var a=this,b=a.kj,c=!1,d="resizable",e="isVisible";function g(){a.yJ&&a.BJ(!1)}function h(a,b){a!==d&&a!==b&&a!==e&&g()}b.Fu(R+P,function(){a.BJ(!0)}),b.Fu(S+P,g),b.Fu(Q+P,g),b.Fu(T+P,function(a,b){h(b.propertyName,"width")}),b.Fu(U+P,function(a,b){h(b.propertyName,"height")}),b.Fu(V+P,function(a,c){6===c.action&&b.Wu&&b.Wu.calcOnDemand||g()}),b.Fu(W+P,function(){c=a.BJ()}),b.Fu(X+P,function(b,d){var e,f,g,h,i=d.cellRange,j=d.sheet.tu(),k=j.n5,l=c;if(i&&k&&j.PA){if(a.jx()){for(f=0,g=k;f<g.length;f++)if(h=g[f],h.intersect(i.row,i.col,i.rowCount,i.colCount)){l=!1;break}}else l=!1,e=!0;a.BJ(l,e)}}),b.Fu(Y+P,g),b.Fu(Z+P,function(a,c){"worksheet"!==c.type&&(b.endEdit(),f.Vl.kmb(b))})},a.prototype.UI=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,r,s,t=this;if(t.yJ&&(e=t.kj,g=e.yl,h=e.parent,i=h?h.options:{},j=e.tu(),k=j.n5,l=i.cutCopyIndicatorVisible,q(l)&&(l=!0),m=f.Rm.Om(e,i.cutCopyIndicatorBorderColor||"blue"),l&&j.PA===e&&k&&(n=g.VI(c,d,u),o=g.XI(c,d,k,b),o&&n))){for(a.save(),a.rect(n.x,n.y,aa(n),_(n)),a.clip(),p=0,r=o;p<r.length;p++)s=r[p],g.fJ(a,s,m);a.beginPath(),a.restore()}},a.prototype.rI=function(){this.BJ(!1)},a.prototype.sI=function(){this.BJ(!1)},a.prototype.tI=function(){this.BJ(!1)},a.prototype.uI=function(){this.BJ(!1)},a.prototype.ky=function(){this.BJ(!1)},a.prototype.no=function(){
var a=this.kj;a.Gu(Q+P),a.Gu(R+P),a.Gu(S+P),a.Gu(T+P),a.Gu(U+P),a.Gu(V+P),a.Gu(W+P),a.Gu(X+P),a.Gu(Y+P),a.Gu(Z+P)},a}(),b.CJ=$,e.Worksheet.$n("render",{init:function(){var a=this;a.yl=new O(a),a.at=new $(a)},dispose:function(a){var b,c=this;a.clearCache!==!1&&(c.yl&&(c.yl.kj=u,c.yl=u),b=c.at,b&&(b.no(),c.at=u))},onLayoutChanged:function(a){var b,c=this,d=c.at;d&&(b=a.changeType,"addRows"===b?d.rI():"deleteRows"===b?d.sI():"addColumns"===b?d.tI():"deleteColumns"===b&&d.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/util/domUtil.js"),h=c("./dist/core/core.enum.js"),i=f.Common.j.Fa,j=f.Common.k.ac,k=null,l=Math.max,m=Math.min,n="gc-selection";function o(a,b){return a.getColumnCount(b)}function p(a,b){return a.getRowCount(b)}function q(a){return a.rowCount}function r(a){return a.colCount}function s(a,b,c){var d,e,f=[],g=a.length;for(e=0;e<g;e++)d=a[e],e===b?f=f.concat(c):f.push(d);return f}function t(a,b,c){for(var d=c-1;d>=0;d--)if(a.getColumnVisible(b+d))return b+d;return b+c-1}function u(a,b,c){for(var d=c-1;d>=0;d--)if(a.getRowVisible(b+d))return b+d;return b+c-1}g.GC$.extend(d.Worksheet.prototype,{addSelection:function(a,b,c,d){this.j7c(a,b,c,d,!1)},j7c:function(a,b,c,d,f){var g,h,i=this,k=a,l=b,m=c,n=d;k!==-1&&l!==-1&&(g=i.ITa.getSpans(),g&&j(g)>0&&(h=i.su(g,e.kf(a,b,c,d)),k=h.row,l=h.col,m=q(h),n=r(h))),i.ITa.do("addSelection",k,l,m,n,f),i.$p()},setSelection:function(a,b,c,d){this.DJ(a,b,c,d,2)},DJ:function(a,b,c,d,f){var g,h,i,j=this,k=p(j),m=o(j);a>=k&&(a=k-1),b>=m&&(b=m-1),g=l(0,a),h=l(0,b),j.Tr(),i=2===f?e.Vl.Wl(j):1===f,j.Kr(g,h,j.Er(g),j.Fr(h),!i),j.j7c(a,b,c,d)},getSelections:function(){return this.ITa.getSelections()},clearSelection:function(){var a=this;a.Tr(),a.Kr(0,0),d.Worksheet.ao(a,"clearSelection"),a.$p()},Tr:function(){this.ITa.do("clearSelection")},Qs:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,q=n.options,r=q.protectionOptions,s=r.allowSelectLockedCells!==!1,t=r.allowSelectUnlockedCells!==!1;if(!q.isProtected||s&&t)return!0;if(!s&&!t)return!1;if(d=c?c.locked:n.tq(a,b,"locked"),e=b<0,f=a<0,s===d&&(f||e)){for(g=f?p(n):1,a=f?0:a,h=e?o(n):1,b=e?0:b,i=n.ITa,j=a+g-1,k=b+h-1,l=void 0,m=void 0,l=a;l<=j;l++)for(m=b;m<=k;m++)if(c=i.getStyle(l,m),c&&s!==c.locked)return!1;if(f)for(l=a;l<=j;l++)if(c=i.getStyle(l,-1),c&&s!==c.locked)return!1;if(e)for(m=b;m<=k;m++)if(c=i.getStyle(-1,m),c&&s!==c.locked)return!1}return s===d},SZa:function(a,b,c,d){var e,f,g=this;for(a=a<0?0:a,b=b<0?0:b,e=a;e<a+c;e++)for(f=b;f<b+d;f++)if(g.tq(e,f,"locked"))return!0},ZZa:function(){var a,b=this.getSelections();for(a=0;a<b.length;a++)if(b[a].col!==-1)return!1;return!0},$Za:function(){var a,b=this.getSelections();for(a=0;a<b.length;a++)if(b[a].row!==-1)return!1;return!0},selectionPolicy:function(a){var b=this,c=b.ITa;return 0===arguments.length?c.getSelectionPolicy():(c.do("setSelectionPolicy",a),b)},selectionUnit:function(a){var b=this,c=b.ITa;return 0===arguments.length?c.getSelectionUnit():(c.do("setSelectionUnit",a),b)},getSelectionBackColor:function(){return this.options.selectionBackColor||e.Im.Lm(n).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||e.Im.Lm(n).borderTopColor},m_a:function(a){return a?void(this.options.m_a=a):this.options.m_a},EJ:function(){var a,b,c=this,d=c.ITa.getSelections();j(d)>0&&(a={selections:d},b=c.ITa.getActiveSelectedRangeIndex(),0!==b&&(a.activeSelectedRangeIndex=b),c.FJ=a,c.Tr(),c.yl.im())},GJ:function(){var a=this,b=a.FJ,c=b&&b.selections;c&&(a.ITa.do("setSelections",c),a.ITa.do("setActiveSelectedRangeIndex",b.activeSelectedRangeIndex||0))},Ax:function(a,b,c){var d,e,f,g=this,h=g.HJ(a,b,c,g.Rr||0);h&&(d=h.row,e=h.col,f=h.leadingCellCol,g.IJ(d,e)&&(g.Qr=d,g.Rr=f,g.Jr(d,e)))},HJ:function(a,b,c,d){var e,f,g=this,h=p(g),j=o(g),l=a;return 0===l&&!c||0===h||0===j?k:(f=g.JJ(l,d),c||g.KJ(f),l=f.r,e=f.c,l<0&&c&&(e=g.br(e),(e<0||i(e))&&(e=g.br(j)),d=e,f=g.JJ(h,e),l=f.r,e=f.c,e===b&&l<=a)?k:{row:l,col:e,leadingCellCol:d})},Bx:function(a,b,c){var d,e,f,g=this,h=g.LJ(a,b,c,g.Rr||0);!h||h.row===a&&h.col===b||(d=h.row,e=h.col,f=h.leadingCellCol,g.IJ(d,e)&&(g.Qr=d,g.Rr=f,g.Jr(d,e)))},LJ:function(a,b,c,d){var e,f,g=this,h=p(g),j=o(g),k=a;if((k!==h-1||c)&&0!==h&&0!==j&&(f=g.MJ(k,d),c||g.KJ(f),k=f.r,e=f.c,!(k===h&&c&&(e=g.Zq(e),(e>=j||i(e))&&(e=g.Zq(-1)),d=e,f=g.MJ(-1,e),k=f.r,e=f.c,e===b&&k>=a))))return{row:k,col:e,leadingCellCol:d}},Dx:function(){var a,b,c=this,d=c.NJ();d&&(a=d.row,b=d.col,c.Qr=a,c.Rr=b,c.Jr(a,b))},NJ:function(){var a,b,c,d,e,f=this,g=f.ir(),h=f.dr(),i=h;if(!g&&!i)return k;if(a=f.options,b=a.protectionOptions,c=b.allowSelectLockedCells!==!1,d=b.allowSelectUnlockedCells!==!1,!a.isProtected||c&&d)return{row:g,col:i};if(!c&&!d)return k;for(;g!==k&&g>=0;g=f.gr(g))for(i=h;i!==k&&i>=0;i=f.br(i))if(e=f.tq(g,i,"locked"),c===e)return{row:g,col:i};return k},Cx:function(){var a,b,c=this,d=c.OJ();d&&(a=d.row,b=d.col,c.Qr=a,c.Rr=b,c.Jr(a,b))},OJ:function(){var a,b,c,d,e,f=this,g=f._q(f.frozenRowCount()-1),h=f.Zq(f.frozenColumnCount()-1),i=h,j=f.ir(),l=f.dr();if(g===k||i===k)return k;if(a=f.options,b=a.protectionOptions,c=b.allowSelectLockedCells!==!1,d=b.allowSelectUnlockedCells!==!1,!a.isProtected||c&&d)return{row:g,col:i};if(!c&&!d)return k;for(;g!==k&&g<=j;g=f._q(g))for(i=h;i!==k&&i<=l;i=f.Zq(i))if(e=f.tq(g,i,"locked"),c===e)return{row:g,col:i};return k},zx:function(a,b,c){var d,e,f,g,h=this,i=h.tables;c?(d=i&&i.bJb(a,b),d||(d=h.iy(a,b,c,h.Qr||0))):d=h.iy(a,b,c,h.Qr||0),d&&(e=d.row,f=d.col,g=d.leadingCellRow,h.IJ(e,f)&&(h.Qr=g,h.Rr=f,h.Jr(e,f)))},iy:function(a,b,c,d){var e,f,g,h=this,j=p(h),l=o(h),m=b;if(0===m&&!c||0===j||0===l)return k;for(f=h.PJ(d,m),g=d,c||h.KJ(f),e=f.r,m=f.c;m<0&&c;){if(e=h.gr(e,3,!0),(e<0||i(e))&&(e=h.gr(j,3,!0)),d=e,f=h.PJ(d,l),e=f.r,m=f.c,e===a&&m<b)return k;if(e===a&&m===b){if(d===g)return k;f=h.PJ(d,m),e=f.r,m=f.c}}return{row:e,col:m,leadingCellRow:d}},KJ:function(a){var b,c=this,d=!1;a.r<0?a.r=c.ar():a.r>=p(c)&&(a.r=c.ir(),d=!0),a.c<0?a.c=c.$q():a.c>=o(c)&&(a.c=c.dr(),d=!0),d&&(b=c.ITa.getSpan(a.r,a.c),b.row!==a.r&&(a.r=b.row),b.col!==a.c&&(a.c=b.col))},Fx:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.row,k=i.col,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.QJ(m,n),m=c.r,n=c.c,n>=k)break;if(h===g&&m===a&&n<=b)return;m--,m>=j?n=l+1:(d=e.Tq(e.Ix(3)),h=f.getActiveSelectedRangeIndex(),j=d.row,k=d.col,l=d.col+r(d)-1,m=d.row+q(d)-1,n=d.col+r(d))}m>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},Gx:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.col,k=i.row+q(i)-1,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.RJ(m,n),m=c.r,n=c.c,n<=l)break;if(h===g&&m===a&&n>=b)return;m++,m<=k?n=j-1:(d=e.Tq(e.Ix(4)),h=f.getActiveSelectedRangeIndex(),j=d.col,k=d.row+q(d)-1,l=d.col+r(d)-1,m=d.row,n=d.col-1)}m>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},Rs:function(a,b,c){var d,e,f,g,h=this,i=h.tables;c?(d=i&&i.cJb(a,b),d||(d=h.hy(a,b,c,h.Qr||0))):d=h.hy(a,b,c,h.Qr||0),!d||d.row===a&&d.col===b||(e=d.row,f=d.col,g=d.leadingCellRow,h.IJ(e,f)&&(h.Qr=g,h.Rr=f,h.Jr(e,f)))},hy:function(a,b,c,d){var e,f,g,h=this,j=p(h),l=o(h),m=b;if(m===l-1&&!c||0===j||0===l)return k;for(f=h.SJ(d,m),g=d,c||h.KJ(f),e=f.r,m=f.c;m===l&&c;){if(!(a!==j-1||a!==e||h.getRowVisible(e,3)&&h.Sl(e,3)>0))return k;if(e=h._q(e,3,!0),(e>=j||i(e))&&(e=h._q(-1,3,!0)),d=e,f=h.SJ(d,-1),e=f.r,m=f.c,e===a&&m>b)return k;if(e===a&&m===b){if(d===g)return k;f=h.SJ(d,m),e=f.r,m=f.c}}return{row:e,col:m,leadingCellRow:d}},PJ:function(a,b){for(var c,d,f,g=this,h=b;h>=0&&(c=a,h--,!(h<0));)if(d=g.ITa.getSpans(e.kf(c,h,1,1)),d&&j(d)>0&&(f=d[0],h>=f.col&&(h=f.col,c=f.row)),g.IJ(c,h))return{r:c,c:h};return{r:c,c:h}},QJ:function(a,b){for(var c,d,e=this;b>=0&&(b--,!(b<0));){if(c=e.ITa.findSpan(a,b)){if(d=e.Ix(),!(d.row<=c.row&&c.row+q(c)<=d.row+q(d)&&d.col<=c.col&&c.col+r(c)<=d.col+r(d)))continue;if(c.row!==a||c.col!==b)continue;b>=c.col&&(b=c.col,a=c.row)}if(e.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},SJ:function(a,b){for(var c,d,f,g,h=this,i=o(h),k=b;k<i&&(c=a,d=h.ITa.getSpan(c,k),k=d.col+r(d),!(k>=i));)if(f=h.ITa.getSpans(e.kf(c,k,1,1)),f&&j(f)>0&&(g=f[0],k>g.col?k=l(k,g.col+r(g)):c=g.row),h.IJ(c,k))return{r:c,c:k};return{r:c,c:k}},RJ:function(a,b){for(var c,d,e,f=this,g=f.ITa,h=o(f);b<h&&(c=g.getSpan(a,b),b=c.col+r(c),!(b>=h));){if(d=g.findSpan(a,b)){if(e=f.Ix(),!(e.row<=d.row&&d.row+q(d)<=e.row+q(e)&&e.col<=d.col&&d.col+r(d)<=e.col+r(e)))continue;if(d.row!==a||d.col!==b)continue;b>d.col?b=l(b,d.col+r(d)):a=d.row}if(f.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},IJ:function(a,b){var c,d,e,f=this;return!!f.Qs(a,b)&&(c=a>=0&&a<p(f)&&b>=0&&b<o(f)&&f.getRowVisible(a)&&f.getColumnVisible(b)&&f.Sl(a)>0&&f.Tl(b)>0,d=!!f.Tx,c===!0&&d===!0&&(e=f.tq(a,b,"tabStop"),e===!1&&(c=!1)),c)},JJ:function(a,b){for(var c,d,f=this;a>=0&&(a--,!(a<0));)if(c=f.ITa.getSpans(e.kf(a,b,1,1)),c&&j(c)>0&&(d=c[0],a>=d.row&&(a=d.row,b=d.col)),f.IJ(a,b))return{r:a,c:b};return{r:a,c:b}},MJ:function(a,b){for(var c,d,f,g=this,h=p(g);a<h&&(c=g.ITa.getSpan(a,b),a=c.row+q(c),!(a>=h));)if(d=g.ITa.getSpans(e.kf(a,b,1,1)),d&&j(d)>0&&(f=d[0],a>f.row?a=l(a,f.row+q(f)):b=f.col),g.IJ(a,b))return{r:a,c:b};return{r:a,c:b}},Ur:function(a,b,c,d,e){var f=this;f.ITa.do("addSelection",a,b,c,d),e&&f.Xq<=0&&f.yl.im()},aH:function(a,b,c){var d=this,e=d.Jx(a,b,d.Jl,d.Kl),f=e.row,g=e.col,h=q(e),i=r(e),j=d.selectionPolicy(),k=d.selectionUnit();0!==j&&(1===j&&d.ITa.do("clearSelection"),1===k?(g=-1,i=-1):2===k&&(f=-1,h=-1),d.Kx(f,g,h,i,c))},Jx:function(a,b,c,d,f){var g,h,k,l,m,n=this;return i(c)&&(c=n.Jl),i(d)&&(d=n.Kl),g=n.ITa,h=g.getSpan(c,d),k=g.getSpan(a,b),f&&h.equals(k)?new e.Range(h.row,h.col,1,1):(l=h.union(k),m=n.ITa.getSpans(),m&&j(m)>0&&(l=n.TJ(m,l)),l)},Kx:function(a,b,c,d,f){var g,h,i,k,l,m,n=this,o=n.ITa,p=n.Ix();if(j(o.getSelections())>0?(h=e.kf(a,b,c,d),n.n_a?(g=n.p_a,n.p_a=h):(i=o.getSelections(),i[o.getActiveSelectedRangeIndex()]=h,o.do("setSelections",i))):n.n_a||o.do("addSelection",a,b,c,d),f&&n.Xq<=0){if(k=n.Ix(),!n.n_a&&k.row===p.row&&k.col===p.col&&q(k)===q(p)&&r(k)===r(p))return;l=n.yl,n.n_a&&(m=n.p_a,g&&g.containsRange(m)?m=g:g&&(m=g.union(m)),m=m.union(e.kf(n.getActiveRowIndex(),n.getActiveColumnIndex(),1,1)),p=m.union(p),k=m.union(k)),p.containsRange(k)?l.im(p):k.containsRange(p)?l.im(k):(l.im(p),l.im(k),l.im(n.p_a))}},kyb:function(a){var b=[];return a&&(b=this.ITa.getSpans(a)),b},lyb:function(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount,k=c+e,l=d+f,m=g+i,n=h+j,o=!1,p=!1,q;return a.intersect(g,h,i,j)&&(q=c>g||d>h||k<m||l<n,o=q,p=!q),b.myb=b.myb||p,o},nyb:function(a,b,c,d){var e,f=[],g=[];for(e=0;e<a.length;e++)g=this.oyb(a[e],b,c,d),f=f.concat(g);return f},oyb:function(a,b,c,d){var e,f,g,h,i,j=[],k=b.length;for(j.push(a),h=k-1;h>=0;h--)for(f=b[h],i=0;i<j.length;)e=j[i],this.lyb(e,f)?(g=this.v_a(e,f,c,d),j=s(j,i,g),i+=g.length):i++;return j},pyb:function(a,b){var c=b.row,d=b.col,e=b.rowCount,f=b.colCount;return a.intersect(c,d,e,f)},qyb:function(a,b){var c,d,e=a.length,f=[];for(d=e-1;d>=0;d--)c=a[d],this.pyb(c,b)||f.push(c);return f},ryb:function(a){var b=!1,c=this.ITa.getSpans(a);return 1===c.length&&(b=a.equals(c[0])),b},syb:function(a,b){var c,d,e,f,g=a,h=b.length,i=g.length,j=!0;for(e=h-1;e>=0;e--){for(d=b[e],f=i-1;f>=0;f--)if(c=g[f],c.equals(d)){j=!1;break}j&&g.push(d)}return g},tyb:function(a){var b,c,d,e,f=a.length,g=[];for(c=f-1;c>=0;c--)b=a[c],b.myb&&(delete b.myb,g.push(c));for(d=g.length,e=0;e<d;e++)a.splice(g[e],1)},v_a:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;return b=this.Tq(b),f=[],g=a.getIntersect(b,c,d),a&&g?(h=a.row>=0?a.row:0,i=a.col>=0?a.col:0,j=a.rowCount,k=a.colCount,l=g.row,m=g.col,n=g.rowCount,o=g.colCount,p=h+j,q=i+k,r=l+n,s=m+o,p-r>0&&f.push(e.kf(r,i,p-r,k)),q-s>0&&f.push(e.kf(l,s,n,q-s)),m-i>0&&f.push(e.kf(l,i,n,m-i)),l-h>0&&f.push(e.kf(h,i,l-h,k))):f.push(a),f},u_a:function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o=[],p=this.getRowCount(3),q=this.getColumnCount(3),r=this.deselectIgnoreSpan();if(a&&a.length>0){for(d=a.length,e=[],f=[],g=[],h=void 0,i=void 0,c=!1,k=d-1;k>=0;k--)h=a[k],r||!this.ryb(h)||this.pyb(h,b)?(e=this.v_a(h,b,p,q),r||(i=this.kyb(h),i.length>0&&(e=this.nyb(e,i,p,q),g=this.qyb(i,b),f=this.syb(f,g),this.tyb(f))),l=j(e),!c&&l>0&&(this.setSelection(e[l-1].row,e[l-1].col,1,1),c=!0),o=e.concat(o)):f=this.syb(f,[h]);r||(o=f.concat(o))}for(this.Tr(),m=o.length,this.suspendPaint(),n=0;n<m;n++)this.j7c(o[n].row,o[n].col,o[n].rowCount,o[n].colCount);c||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(a,b){var c,d,e,f,g,h,i,k,l,m=this,n=m.ITa.getSelections();if(!(j(n)<=0)&&(c=m.Ix(),d=m.UJ(c,a,b))){if(e=d.row,f=d.col,g=q(d),h=r(d),i=m.selectionPolicy(),k=m.selectionUnit(),0===i)return;1===i&&m.ITa.do("clearSelection"),1===k?(f=-1,h=-1):2===k&&(e=-1,g=-1),m.Kx(e,f,g,h,!0),l=m.ITa.getSelections(),m.mm.zu(n,l)&&(m.yu(n,l),m.Au(n))}},UJ:function(a,b,c,d,e){var f=this,g=f.Tq(a),h=k;return 37===b?h=c?f.VJ(g,!1,d,e):f.WJ(g,d,e):39===b?h=c?f.XJ(g,!1,d,e):f.YJ(g,d,e):38===b?h=c?f.ZJ(g,!1,d,e):f.$J(g,d,e):40===b?h=c?f._J(g,!1,d,e):f.aK(g,d,e):36===b?h=c?f.bK(g,d,e):f.cK(g,d,e):35===b?h=c?f.dK(g,d,e):f.eK(g,d,e):33===b?h=f.fK(g,d,e):34===b&&(h=f.gK(g,d,e)),h&&(a.row<0&&(h.row=-1,h.rowCount=f.getRowCount()),a.col<0&&(h.col=-1,h.colCount=f.getColumnCount())),h},WJ:function(a,b,c){for(var d,f,g,h,i,j,n,o,p,s,t=this,v=a.row,w=a.col,x=q(a),y=r(a),z=w+y-1,A=0,B=u(t,v,x);z>A;)if(z--,t.IJ(B,z)&&(d=t.Jx(B,z,b,c),f=m(v,d.row),g=m(w,d.col),h=l(v+x-1,d.row+q(d)-1),i=m(w+y-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==v||g!==w||j!==x||n!==y))return o=t.qq,p=t.Kl,w<p?g<=o&&t.rq(g):w===p&&i<=o&&t.rq(i),s=t.parent&&t.parent.options.scrollByPixel,s&&g===o&&0!==t.eCb&&t.rq(g,0),e.kf(f,g,j,n);return k},VJ:function(a,b,c,d){var f,g,h,j,k,n,o,p=this,s=a.row,t=a.col,u=p.frozenColumnCount(),v=u?p.Zq(u-1):p.$q(),w=b?v:p.$q();if(!i(w))return(u<=0||b)&&p.rq(w),f=p.Jx(s,w,c,d),g=m(s,f.row),h=m(t,f.col),j=l(s+q(a)-1,f.row+q(f)-1),k=m(t+r(a)-1,f.col+r(f)-1),n=j-g+1,o=k-h+1,e.kf(g,h,n,o)},lCb:function(a){var b,c,d,e,f,g=this,h=g.parent&&g.parent.options.scrollByPixel;if(h){for(d=g.ss,e=g.Fr(a),f=g.getViewportWidth(e);0<=a&&(f-=d._m(a),!(f<0));a--);b=a,c=f}else b=g.gXc(a,2).col,c=0;return{dj:b,UP:c}},YJ:function(a,b,c){for(var d,f,g,h,i,j,n,p,s,t,v=this,w=a.row,x=a.col,y=q(a),z=r(a),A=x,B=o(v)-1,C=u(v,w,y);A<B;)if(A++,v.IJ(C,A)&&(d=v.Jx(C,A,b,c),f=m(w,d.row),g=l(x,d.col),h=l(w+y-1,d.row+q(d)-1),i=l(x+z-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==w||g!==x||j!==y||n!==z))return p=v.Aw(),s=v.Kl,x<s?g>=p&&(t=v.lCb(g),v.rq(t.dj,t.UP)):x===s&&i>=p&&(t=v.lCb(i),v.rq(t.dj,t.UP)),e.kf(f,g,j,n);return k},XJ:function(a,b,c,d){var f,g,h,j,k,n,o,p,s=this,t=a.row,u=a.col,v=s.lr();if(!i(v))return s.rq(v),f=s.dr(),b||(f+=s.frozenTrailingColumnCount()),g=s.Jx(t,f,c,d),h=m(t,g.row),j=l(u,g.col),k=l(t+q(a)-1,g.row+q(g)-1),n=l(u+r(a)-1,g.col+r(g)-1),o=k-h+1,p=n-j+1,e.kf(h,j,o,p)},$J:function(a,b,c){for(var d,f,g,h,i,j,n,o,p,s,u=this,v=a.row,w=a.col,x=q(a),y=r(a),z=v+x-1,A=0,B=t(u,w,y);z>A;)if(z--,u.IJ(z,B)&&(d=u.Jx(z,B,b,c),f=m(v,d.row),g=m(w,d.col),h=m(v+x-1,d.row+q(d)-1),i=l(w+y-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==v||g!==w||j!==x||n!==y))return o=u.lq,p=u.Jl,v<p?f<=o&&u.mq(f):v===p&&h<=o&&u.mq(h),s=u.parent&&u.parent.options.scrollByPixel,s&&f===o&&0!==u.cCb&&u.mq(f,0),e.kf(f,g,j,n);return k},ZJ:function(a,b,c,d){var f,g,h,j,k,n,o,p=this,s=a.row,t=a.col,u=p.frozenRowCount(),v=u?p._q(u-1):p.ar(),w=b?v:p.ar();if(!i(w))return(u<=0||b)&&p.mq(w),f=p.Jx(w,t,c,d),g=m(s,f.row),h=m(t,f.col),j=m(s+q(a)-1,f.row+q(f)-1),k=l(t+r(a)-1,f.col+r(f)-1),n=j-g+1,o=k-h+1,e.kf(g,h,n,o)},mCb:function(a){var b,c,d,e,f,g=this,h=g.parent&&g.parent.options.scrollByPixel;if(h){for(d=g.ss,e=g.Er(a),f=g.getViewportHeight(e);0<=a&&(f-=d.Sl(a),!(f<0));a--);b=a,c=f}else b=g.ms(a,2),c=0;return{cj:b,UP:c}},aK:function(a,b,c){for(var d,f,g,h,i,j,n,o,s,u,v=this,w=a.row,x=a.col,y=q(a),z=r(a),A=w,B=p(v)-1,C=t(v,x,z);A<B;)if(A++,v.IJ(A,C)&&(d=v.Jx(A,C,b,c),f=l(w,d.row),g=m(x,d.col),h=l(w+y-1,d.row+q(d)-1),i=l(x+z-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==w||g!==x||j!==y||n!==z))return o=v.Fw(),s=v.Jl,w<s?f>=o&&(u=v.mCb(f),v.mq(u.cj,u.UP)):w===s&&h>=o&&(u=v.mCb(h),v.mq(u.cj,u.UP)),e.kf(f,g,j,n);return k},_J:function(a,b,c,d){var f,g,h,j,k,n,o,p,s=this,t=a.row,u=a.col,v=s.kr();if(!i(v))return s.mq(v),f=s.ir(),b||(f+=s.frozenTrailingRowCount()),g=s.Jx(f,u,c,d),h=l(t,g.row),j=m(u,g.col),k=l(t+q(a)-1,g.row+q(g)-1),n=l(u+r(a)-1,g.col+r(g)-1),o=k-h+1,p=n-j+1,e.kf(h,j,o,p)},cK:function(a,b,c){for(var d,f,g,h,i,j,n,o=this,p=a.row,s=a.col,t=q(a),u=r(a),v=o.frozenColumnCount()-1,w=o.Kl,x=p+t-1;v<w;)if(v++,o.IJ(x,v)){if(s<=v&&s+u-1===o.Kl)break;return d=o.Jx(x,v,b,c),f=m(p,d.row),g=m(s,d.col),h=l(p+t-1,d.row+q(d)-1),i=m(s+u-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,o.rq(o.$q()),e.kf(f,g,j,n)}return k},bK:function(a,b,c){return a=this.VJ(a,!0,b,c),a=this.ZJ(a,!0,b,c)},eK:function(a,b,c){for(var d,f,g,h,i,j,n,p=this,s=a.row,t=a.col,u=q(a),v=r(a),w=o(p),x=p.Kl,y=s+u-1;w>x;)if(w--,p.IJ(y,w)){if(t+v-1>=w&&t===p.Kl)break;return d=p.Jx(y,w,b,c),f=m(s,d.row),g=l(t,d.col),h=l(s+u-1,d.row+q(d)-1),i=l(t+v-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,p.rq(p.lr()),e.kf(f,g,j,n)}return k},dK:function(a,b,c){return a=this.XJ(a,!0,b,c),a=this._J(a,!0,b,c)},fK:function(a,b,c){var d,f,g,h,n,o,p,s,t,u,v=this,w=a.row,x=a.col,y=q(a),z=v.Ew();return i(z)?k:(d=v.Gr(1),f=v.mq(z),g=-1,f?g=v._q(w+y-1-j(d)):v.frozenRowCount()<=0&&(g=v.ar()),g<v.lq?g=v.lq:g>=v.Fw()&&(g=v.gr(v.Fw())),h=v.Jx(g,x,b,c),n=m(w,h.row),o=m(x,h.col),p=m(w+y-1,h.row+q(h)-1),s=l(x+r(a)-1,h.col+r(h)-1),t=p-n+1,u=s-o+1,e.kf(n,o,t,u))},gK:function(a,b,c){var d,f,g,h,n,o,p,s,t,u=this,v=a.row,w=a.col,x=q(a),y=u.$x();return i(y)?k:(d=u.Gr(1),u.mq(y),f=u.gr(v+x-1+j(d)),f<u.lq?f=u.lq:f>=u.Fw()&&(f=u.lq>=u.kr()?u.Fw():u.gr(u.Fw())),g=u.Jx(f,w,b,c),h=l(v,g.row),n=m(w,g.col),o=l(v+x-1,g.row+q(g)-1),p=l(w+r(a)-1,g.col+r(g)-1),s=o-h+1,t=p-n+1,e.kf(h,n,s,t))},Ew:function(){var a,b,c,d,e,f=this,g=f.Gr(1);if(!g||j(g)<=0)return k;for(a=f.frozenRowCount(),b=a?f._q(a-1):f.ar(),c=0,d=f.lq,e=f.am();d>b&&(d--,c+=f.Sl(d),!(c>f.oKc(e))););return d},zw:function(){var a,b,c,d,e,f=this,g=f.Hr(1);if(!g||j(g)<=0)return k;for(a=f.frozenColumnCount(),b=a?f.Zq(a-1):f.$q(),c=0,d=f.qq,e=f.am();d>b&&(d--,c+=f.Tl(d),!(c>f.rKc(e))););return d},$x:function(){var a,b=this.Gr(1),c=j(b);return b&&c>0?(a=b[c-1].row,this.ir()<=a?this.lq:a):k},kr:function(){var a,b,c,d,e,f,g=this;if(g.ir()===g.Fw()&&(a=g.am(),b=g.Gr(1),c=j(b),b&&c>=1&&(d=b[c-1],d.y+d.height<=a.qt+g.oKc(a))))return g.lq;e=g.lq;try{return g.lq=g.ir(),f=g.Ew(),f=g._q(f)}catch(a){}finally{g.lq=e}},lr:function(){var a,b,c,d,e,f,g=this;if(g.dr()===g.Aw()&&(a=g.am(),b=g.Hr(1),c=j(b),b&&c>=1&&(d=b[c-1],d.x+d.width<=a.pt+a.width)))return g.qq;for(a=g.am(),e=0,f=g.dr();f>0&&(e+=g.Tl(f),!(e>g.rKc(a)));)f--;return f>0&&(f=g.Zq(f)),f},Fw:function(){var a=this.Gr(1),b=j(a);return a&&b>0?a[b-1].row:k},Aw:function(){var a=this.Hr(1),b=j(a);return a&&b>0?a[b-1].col:k},hr:function(){var a,b,c=this,d=c.Gr(1),e=j(d);return d&&e>0?(a=c.am(),b=e-1,d[b].y+d[b].height<=a.qt+c.oKc(a)?d[b].row:d[l(b-1,0)].row):k},cr:function(){var a,b,c=this,d=c.Hr(1),e=j(d);return d&&e>0?(a=c.am(),b=e-1,d[b].x+d[b].width<=a.pt+c.rKc(a)?d[b].col:d[l(b-1,0)].col):k},ir:function(a){i(a)&&(a=3);var b=p(this,a);return 3!==a&&2!==a||(b-=this.frozenTrailingRowCount()),this.gr(b,a)},dr:function(a){i(a)&&(a=3);var b=o(this,a);return 3!==a&&1!==a||(b-=this.frozenTrailingColumnCount()),this.br(b,a)},TJ:function(a,b){var c,d,e;if(a)for(c=0,d=j(a);c<d;c++)if(e=a[c],b.intersect(e.row,e.col,q(e),r(e)))return a.splice(c,1),c--,this.TJ(a,b.union(e));return b},Ix:function(a){var b,c=this,d=c.ITa,f=j(d.getSelections()),g=e.kf(-1,-1,0,0);return f<=0?g:(b=d.getActiveSelectedRangeIndex(),3===a?(b--,b<0&&(b=f-1),d.do("setActiveSelectedRangeIndex",b)):4===a&&(b++,b>=f&&(b=0),d.do("setActiveSelectedRangeIndex",b)),b=d.getActiveSelectedRangeIndex(),b>=0&&(g=d.getSelections()[b]),g)}}),d.Worksheet.$n("selection",{init:function(){this.ITa.do("addSelection",0,0,1,1),this.ITa.setCellState(0,0,h.CellStatesType.active,!0,h.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/worksheet.js"),h=c("CalcEngine"),i=!!h,j=c("./dist/core/core.ns.js"),k=new d.Common.ResourceManager(j.SR),l=k.getResource.bind(k),m=d.Common.l.Ra,n=d.Common.k,o=d.Common.j.Fa,p="boolean",q="string",r="number",s="backColor",t="fontColor",u=void 0;function v(a,b,c){for(var d=a[c-b];d<c;)d=a[d-b];return d}function w(a,b){return"object"==typeof a?JSON.stringify(a):(a=b.getColor(a),d.Common.pc.bc(d.Common.pc.ec(a)))}function x(a,b){return a instanceof Date&&b instanceof Date?m(a)===m(b):typeof a===q&&typeof b===q?a.toLowerCase()===b.toLowerCase():a===b}function y(a,b,c,d,e){var f,g,h,i=a.currentTheme();return o(b)||(g=e?b.backColor:b.foreColor,o(g)||(g=w(g,i))),o(c)||(h=e?c.backColor:c.foreColor,o(h)||(h=w(h,i))),g=g||"",h=h||"",f=g===h?0:g===d?1:h===d?-1:0}function z(a,b){var c,d,e,f,g;return a instanceof Date&&(a=m(a)),b instanceof Date&&(b=m(b)),c=typeof a,d=typeof b,e=c===q,f=d===q,g=d===r,c===d||c!==r&&!g?!(c!==p||!f)||(!e||d!==p)&&(e&&f?a.toLowerCase()>b.toLowerCase():a>b):g}function A(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,p,q,s,t,u,v,w=e,A=a,B=b;if(w)for(h=0;h<w.length&&(w[h]&&(i=w[h].ascending,j=w[h].index,0<=j&&(k=void 0,l=void 0,m=d?A:j,n=d?j:A,p=d?B:j,q=d?j:B,f?(k=f[m][n],l=f[p][q]):(k=c.getValue(m,n),l=c.getValue(p,q)),w[h].compareFunction?(g=w[h].compareFunction(k,l),i||(g*=-1)):o(w[h].color)?(u=o(k)||""===k||typeof k===r&&isNaN(k),v=o(l)||""===l||typeof l===r&&isNaN(l),u||v?u&&v?g=0:u&&!v?g=1:!u&&v&&(g=-1):g=x(k,l)?0:z(k,l)?i?1:-1:i?-1:1):(s=void 0,t=void 0,s=c.getActualStyle(m,n,3,!1,!1,!0),t=c.getActualStyle(p,q,3,!1,!1,!0),g=y(c,s,t,w[h].color,w[h].isBackColor),i||(g*=-1)))),0===g);h++);return g}function B(a,b,c,d,e){var f,g,h,i,j,k,l,m=a.length;if(m<=1)return a;for(f=Math.floor(m/2),g=a[f],h=[],i=[],j=[],k=0;k<m;k++)f!==k?(l=A(a[k],g,b,c,d,e),l<0?h.push(a[k]):l>0?i.push(a[k]):j.push(a[k])):j.push(a[k]);return B(h,b,c,d,e).concat(j,B(i,b,c,d,e))}function C(a,b,c){var d,e,f=[];if(b)for(d=c.length-1;d>=0;d--)e=c[d],0===a.getRowHeight(e)&&(c.splice(d,1),f.push({mi:d,Qb:e}));else for(d=c.length-1;d>=0;d--)e=c[d],0===a.getColumnWidth(e)&&(c.splice(d,1),f.push({mi:d,Qb:e}));return f}function D(a,b){var c,d;for(c=a.length-1;c>=0;c--)d=a[c],b.splice(d.mi,0,d.Qb)}function E(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o=f?d:e,p=f?b:c,q=[];for(j=0;j<o;j++)q[j]=p+j;for(k=h.ignoreHidden?C(a,f,q):[],l=q.concat([]),m=!1,q=B(q,a,f,g,i),n=0;n<q.length;n++)if(q[n]!==l[n]){m=!0;break}return D(k,q),{array:q,isChanged:m}}function F(a,b,c,d,e,f,g,h,i){var j,k,l,m,n=f?d:e,o=f?b:c,p=f?a.rowOutlines:a.columnOutlines,q=p.kec(o,n),r=p.lec(q,h.groupSort);if(!r){for(j=[],k=0;k<n;k++)j.push(o+k);r=[j]}for(k=0;k<r.length;k++)r[k]=B(r[k],a,f,g,i);return l=p.mec(r,q,h.groupSort),m=l.array,l.isChanged&&G(a,f,l,m,q,o,n),{array:m,isChanged:l.isChanged}}function G(a,b,c,d,e,f,g){var h,i,j=b?a.rowOutlines:a.columnOutlines,k=[],l=[];if(b){for(h=f;h<f+g;h++)a.Ps(h)||a.rowOutlines&&a.rowOutlines.isCollapsed(h)||(a.getRowVisible(h,3,!0)?0===a.getRowHeight(h)&&(k.push(h),a.setRowHeight(h,a.defaults.rowHeight)):(l.push(h),a.setRowVisible(h,!0)));for(j.nec(c.groupSwap,c.array,e.start),h=0;h<l.length;h++)i=n.Cb(d,l[h])+f,a.setRowVisible(i,!1);for(h=0;h<k.length;h++)i=n.Cb(d,k[h])+f,a.setRowHeight(i,0)}else{for(h=f;h<f+g;h++)a.columnOutlines&&a.columnOutlines.isCollapsed(h)||(a.getColumnVisible(h,3)?0===a.getColumnWidth(h)&&(k.push(h),a.setColumnWidth(h,a.defaults.colWidth)):(l.push(h),a.setColumnVisible(h,!0)));for(j.nec(c.groupSwap,c.array,e.start),h=0;h<l.length;h++)i=n.Cb(d,l[h])+f,a.setColumnVisible(i,!1);for(h=0;h<k.length;h++)i=n.Cb(d,k[h])+f,a.setColumnWidth(i,0)}}function H(a,b,c){var d=a.qg(b,c,!1);d&&d.hasListeners()&&d.Yg()}function I(a,b,d,e){var f,g,h=c("SheetsCalc");h&&(f=h.CalcOperatorAdjustor.zj(a.xf,a.xf,a.Kf(b,d),b,d,0,0),a.Rf(b,d,f,e),g=a.qg(b,d,!!f),g&&g.og())}function J(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u,w,x,y=a.ITa,z=y.Ky,A=z&&z.sV.length>0,B=f?b:c,C=f?b+d:c+e,D=f?c:b,E=f?c+e:b+d;for(w=B;w<C;w++)if(u=v(h,B,w),w!==u)for(f?(m=w,o=u):(n=w,p=u),x=D;x<E;x++)f?(n=x,p=x):(m=x,o=x),g&&(q=i[m][n],r=i[o][p]),A&&(s=z.get(m,n),t=z.get(o,p)),k&&l&&(H(k,m,n),H(k,o,p),k._f(m,n,o,p),I(k,m,n),I(k,o,p)),y.do("swapNode",m,n,o,p),a.uja&&a.wja(m,n,o,p),A&&z.qUa(s,m,n,t,o,p),g&&(i[m][n]=r,i[o][p]=q),j.push({row:m,col:n}),j.push({row:o,col:p})}function K(a,b,c,d,e,f,h,j,k,l,m){var n,o,p,q,r,s,t,v=[],w=a.ITa.WTa;if(w>0&&b&&(a.ITa.WTa=0,[].push.apply(a.ITa.zTa,[{row:c,column:d,rowCount:e,columnCount:f,byRows:h,sortInfo:j,type:"sortRange",array:l.concat([])}])),n=i&&a.Bj(),o=i&&a.yj(),J(a,c,d,e,f,h,k,l,m,v,n,o),k)for(p=c;p<c+e;p++)for(q=d;q<d+f;q++)a.setValue(p,q,m[p][q]);if(n){for(r=c;r<c+e;r++)for(s=d;s<d+f;s++)t=n.Kf(r,s),t&&n.fg(r,s,t,u);a.getCalcService().recalcRange(o,c,d,e,f)}return g.Worksheet.ao(a,"sortRangeChanged",{column:d,columnCount:f}),w>0&&(a.ITa.WTa=w),v}function L(a,b,c,d,e,f,g,h,j,k){var l,m,n,o,p,q;a.suspendPaint(),a.suspendEvent(),i&&a.suspendCalcService();try{if(k)for(m=[],n=b;n<b+d;n++)for(m[n]=[],o=c;o<c+e;o++)m[n][o]=a.getValue(n,o);return p=void 0,q=void 0,j?p=j:0===h.groupSort?(q=E(a,b,c,d,e,f,g,h,m),p=q.array):(q=F(a,b,c,d,e,f,g,h,m),p=q.array),!!p&&(l=K(a,q&&q.isChanged,b,c,d,e,f,g,k,p,m),!0)}finally{i&&a.resumeCalcService(!1),a.resumeEvent(),a.resumePaint(),a.Bu(b,c,d,e,l,4,u,u,u,!!j)}}function M(a,b){var c,d,e,f,g,h,i=[];for(c=0,d=b;c<d.length;c++)e=d[c],e.compareFunction?(f=e,i.push({index:f.index,ascending:f.ascending,compareFunction:f.compareFunction})):e.order&&e.hasOwnProperty(s)?(f=e,g="top"!==f.order,h=o(f.backColor)?"":w(f.backColor,a.currentTheme()),i.push({index:f.index,ascending:g,color:h,isBackColor:!0})):e.order&&e.hasOwnProperty(t)?(f=e,g="top"!==f.order,h=o(f.fontColor)?"":w(f.fontColor,a.currentTheme()),i.push({index:f.index,ascending:g,color:h,isBackColor:!1})):(e.color&&(e.color=w(e.color,a.currentTheme())),i.push(e));return i}e.GC$.extend(g.Worksheet.prototype,{sortRange:function(a,b,c,d,e,g,h,j,k){var m,n,o,p,q,r,s,t,u,v,w,x=this,y=x.getRowCount(),z=x.getColumnCount();if(a===-1&&(a=0),c===-1&&(c=y),b===-1&&(b=0),d===-1&&(d=z),a<0||a>=y||b<0||b>=z||c<0||a+c>y||d<0||b+d>z||!g)return!1;if(h=x.oec(f.kf(a,b,c,d),e,h),m=e?c:d,n=e?a:b,o=e?x.rowOutlines:x.columnOutlines,!j&&h.groupSort>0){if(!o)return!1;p=o.kec(n,m),e?(c=p.count,a=p.start):(d=p.count,b=p.start)}return i&&!x.Vq(a,b,c,d,!1)?(k&&x.Os(7,l().Exp_InvalidSortArrayFormulaInRange),!1):(q=x.ITa.getSpans(f.kf(a,b,c,d)),q&&q.length>0?(k&&x.Os(7,l().Exp_InvalidSortSpanInRange),!1):(r=x.tables,!r||(s=r.s$(a,b,c,d),t=1===s.length&&s[0].dataRange().equals(f.kf(a,b,c,d)),s.length<=0||t)?(u=x.wq,v=u&&u._dataSource||t&&s[0]&&s[0].LZ(),w=L(x,a,b,c,d,e,M(x,g),h,j,v),w&&0!==h.groupSort&&x.xr&&x.xr.reFilter(),w):(k&&x.Os(7,l().Exp_InvalidSortPartTableOrMultiTableInRange),!1)))},oec:function(a,b,c){var d,e=this,f=e.Tq(a),g=b?f.rowCount:f.colCount,h=b?f.row:f.col,i=b?e.rowOutlines:e.columnOutlines;return o(c)&&(c={}),e.outlineColumn&&e.outlineColumn.ZQa()&&b&&(d=e.outlineColumn.YQa.columnIndex,f.col<=d&&d<=f.col+f.colCount||(c.groupSort=0)),o(c.groupSort)&&(o(c.ignoreHidden)?c.groupSort=i&&i.pec(h,g)?1:0:c.groupSort=0),0===c.groupSort?c.ignoreHidden=!!o(c.ignoreHidden)||c.ignoreHidden:c.ignoreHidden=!1,c},hK:function(){var a=this.options;return!a.isProtected||a.protectionOptions.allowSort},wja:function(a,b,c,d){var e=this,f=e.getDataValidator(a,b),g=e.getDataValidator(c,d);e.setDataValidator(a,b,g),e.setDataValidator(c,d,f)}})},"./dist/core/worksheet/worksheet-static.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/core.enum.js"),h=c("CalcEngine"),i=!!h,j=c("./dist/core/util/domUtil.js"),k=f.Common.j.Fa,l=j.GC$.each,m=null,n=void 0,o=Math.min,p=Math.max,q=new f.Common.ResourceManager(d.SR),r=q.getResource.bind(q);function s(a,b){return a.getRowCount(b)}function t(a,b){return a.getColumnCount(b)}function u(a,b,c){return a.$r(b,c)}function v(a,b,c){return a.Yr(b,c)}function w(a,b,c,d){a.setColumnWidth(b,c,d)}function x(a,b,c,d){a.setRowHeight(b,c,d)}function y(a,b,c,d,e){return a.getActualStyle(b,c,d,n,n,n,e)}function z(a,b){return a.getDefaultStyle(b)}function A(a,b,c){a.setDefaultStyle(b,c)}function B(a,b,c,d,e){a.Pq(b,c,d,e)}function C(a,b,c,d){throw Error(f.Common.u.Kb(r().Exp_InvalidAndSpace,[a,b,c,d]))}function D(a,b,c){return b&&c.Ps&&c.Ps(a)}function E(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,p,q,u;if(!a)throw Error(r().Exp_SrcIsNull);if(!d)throw Error(r().Exp_DestIsNull);j=s(a),k=t(a),l=s(d),m=t(d),(b<-1||b>=j)&&C("from row index",b,"-1",j-1),(c<-1||c>=k)&&C("from column index",c,"-1",k-1),(e<-1||e>=l)&&C("to row index",e,"-1",l-1),(f<-1||f>=m)&&C("to column index",f,"-1",m-1),n=c,c<0&&(n=0,h=k),p=f<0?0:f,(h<1||n+h>k||p+h>m)&&C("column count",h,"1",o(k-n,m-p)),q=b,b<0&&(q=0,g=j),u=e<0?0:e,(g<1||q+g>j||u+g>l)&&C("row count",g,"1",o(j-q,l-u))}function F(a){if(!a)return a;if("number"==typeof a||"string"==typeof a||"boolean"==typeof a||k(a))return a;if(a.clone)return a.clone();if(a instanceof Date)return new Date(a.valueOf());var b,c,d;b=a instanceof Object?new a.constructor:new a.constructor(a.valueOf());for(c in a)a.hasOwnProperty(c)&&(d=a[c],a.hasOwnProperty(c)&&b[c]!==d&&("object"==typeof d?b[c]=F(d):b[c]=d));return b.toString=a.toString,b.valueOf=a.valueOf,b}function G(a,b,c,d,f,g,h,i,j){var k,l,m,o,p,q,r,s,t,u,v=a.getSpans(n,j),w=d.getSpans(n,j),x=[];if(v)for(k=0;k<v.length;k++)l=v[k],m=l.row,o=l.col,p=l.rowCount,q=l.colCount,b===-1?c<=o&&o+q<=c+i&&x.push(e.kf(m,g+o-c,p,q)):c===-1?b<=m&&m+p<=b+h&&x.push(e.kf(f+m-b,o,p,q)):b<=m&&m<b+h&&c<=o&&o<c+i&&x.push(e.kf(f+m-b,g+o-c,p,q));if(w)for(k=0;k<w.length;k++)l=w[k],m=l.row,o=l.col,r=void 0,s=o>=g&&o<g+i,t=m>=f&&m<f+h,r=b===-1?s:c===-1?t:t&&s,r&&(u=d.findSpan(m,o,j),u&&u.row===m&&u.col===o&&d.do("removeSpan",u,j));for(k=0;k<x.length;k++)d.do("addSpan",x[k],j)}function H(a,b,c,d,e,f,g,h,i,j){var k,l=a.conditionalFormats,m=d.conditionalFormats,n=W(a,d);l&&m&&!a.dJb&&(k=l.XA(b,c,m,e,f,g,h,n,j),i&&l.YA(b,c,g,h,k,n))}function I(a,b,c,d,e,f,g,h,i,j){var k,l;b<0&&(b=0,g=o(s(a),s(d))),e<0&&(e=0),c<0&&(c=0,h=o(t(a),t(d))),f<0&&(f=0),k=!(a===d&&a.name()===d.name()),k?(l=d.ZA,l&&(i?a.ZA.count()>0&&l.$A(a,b,c,e,f,g,h):l._A(a,b,c,e,f,g,h,n,j))):(l=a.ZA,l&&(i?l.count()>0&&l.aB(b,c,e,f,g,h):l.Zz(b,c,e,f,g,h,n,j)))}function J(a,b,c,d,e,f){var g,h,i;b<0&&(b=0,e=o(t(a),t(c))),d<0&&(d=0),g=a.columnOutlines,h=c.columnOutlines,i=!(a===c&&a.name()===c.name()),i?g&&h&&h.bB(g,b,d,e,f):g&&g.cB(b,d,e,f)}function K(a,b,c,d,e,f){var g,h,i;b<0&&(b=0,e=o(s(a),s(c))),d<0&&(d=0),g=!(a===c&&a.name()===c.name()),h=a.rowOutlines,i=c.rowOutlines,g?h&&i&&i.bB(h,b,d,e,f):h&&h.cB(b,d,e,f)}function L(a,b,c,d,e,f,g,h,i,j){var k=!(a===d&&a.name()===d.name()),l=a.ITa,m=l.zl(j);k?(G(l,b,c,d.ITa,e,f,g,h,j),i&&m&&l.do("clearSpan",b,c,g,h,j)):i?l.do("moveSpan",b,c,e,f,g,h,j):l.do("copySpan",b,c,e,f,g,h,j)}function M(a,b,c,d,e,f,g,h,i){var j=b,k=c;j<0&&(j=0,g=o(s(a),s(d))),e<0&&(e=0),k<0&&(k=0,h=o(t(a),t(d))),f<0&&(f=0),b<0&&L(a,-1,k,d,-1,f,-1,h,i,1),c<0&&L(a,j,-1,d,e,-1,g,-1,i,2),L(a,j,k,d,e,f,g,h,i)}function N(a,b,c,d,e,f,h,i,j){var l,p,q,r,z,A,C,D,E,F,G,H,I,J,K,L;for(b<0&&(b=0,e=o(t(a),t(c))),d<0&&(d=0),l=!i&&c.KLc(),p=1,q=[],r=0,z=0;r<e&&r<t(c,p);r++)l&&0===c.getColumnWidth(d+r)?e++:(A={},(64&f)>0&&(C=u(a,z+b),k(C)||(A.size=C,h&&w(a,r+b,a.defaults.colWidth)),D=a.getColumnVisible(z+b),k(D)||(A.visible=D,h&&a.setColumnVisible(r+b,!0)),E=y(a,-1,z+b,n,j),A.style=E,h&&B(a,-1,r+b,m),E=y(a,-1,z+b,p,j),A.headerStyle=E,
h&&B(a,-1,r+b,m,p),F=a.sYc(z+b),k(F)||(A.columnHeaderFitMode=F,h&&a.$Yc(r+b,g.ColumnHeaderFitMode.normal))),(128&f)>0&&(G=a.getTag(-1,z+b),k(G)||(A.tag=G,h&&a.setTag(-1,r+b,n))),q[z+b]=A,z++);for(r=0,z=0;r<e&&r<t(c,p);r++)l&&0===c.getColumnWidth(d+r)?e++:(A=q[z+b],(64&f)>0&&(C=A.size,k(C)||w(c,r+d,C),D=A.visible,k(D)||c.setColumnVisible(r+d,D),E=A.style,E?B(c,-1,r+d,E.clone()):B(c,-1,r+d,m),E=A.headerStyle,E?B(c,-1,r+d,E.clone(),p):B(c,-1,r+d,m,p),F=A.columnHeaderFitMode,k(F)||c.$Yc(r+d,F)),(128&f)>0&&(G=A.tag,k(G)||c.setTag(-1,r+d,G)),z++);for(H=s(c,p),I=o(s(a,p),H),J=0,K=0;J<I&&J<H;J++)l&&0===c.getRowHeight(J,p)?I++:(L=v(a,K,p),k(L)||(h&&x(a,J,a.defaults.colHeaderRowHeight,p),x(c,J,L,p)),K++)}function O(a,b,c,d,e,f,g,h,i,j){var l,p,q,r,z,A,C,E,F,G,H,I,J,K,L;for(b<0&&(b=0,e=o(s(a),s(c))),d<0&&(d=0),l=!i&&c.KLc(),p=2,q=[],r=0,z=0;r<e&&d+r<s(c,p);r++)l&&0===c.getRowHeight(d+r)?e++:h||!D(d+r,g,c)?(A={},(64&f)>0&&(C=v(a,z+b),k(C)||(A.size=C,h&&x(a,r+b,a.defaults.rowHeight)),E=a.getRowVisible(z+b),k(E)||(A.visible=E,h&&a.setRowVisible(r+b,!0)),F=y(a,z+b,-1,n,j),A.style=F,h&&B(a,r+b,-1,m),F=y(a,z+b,-1,p,j),A.headerStyle=F,h&&B(a,r+b,-1,m,p)),(128&f)>0&&(G=a.getTag(z+b,-1),k(G)||(A.tag=G,h&&a.setTag(r+b,-1,n))),q[z+b]=A,z++):z++;for(r=0,z=0;r<e&&d+r<s(c,p);r++)l&&0===c.getRowHeight(d+r)?e++:h||!D(d+r,g,c)?(A=q[z+b],(64&f)>0&&(C=A.size,k(C)||x(c,r+d,C),E=A.visible,k(E)||c.setRowVisible(r+d,E),F=A.style,F?B(c,r+d,-1,F.clone()):B(c,r+d,-1,m),F=A.headerStyle,F?B(c,r+d,-1,F.clone(),p):B(c,r+d,-1,m,p)),(128&f)>0&&(G=A.tag,k(G)||c.setTag(r+d,-1,G)),z++):z++;for(H=t(c,p),I=o(t(a,p),H),J=0,K=0;J<I&&J<H;J++)l&&0===c.getColumnWidth(J,p)?I++:(L=u(a,K,p),k(L)||(h&&w(a,J,a.defaults.rowHeaderColWidth,p),w(c,J,L,p)),K++)}function P(a,b,c,d){var e,f,g;a===b&&a.name()===b.name()||((64&c)>0&&(e=z(a),A(b,d?e:e.clone()),e=z(a,1),A(b,d?e:e.clone(),1),e=z(a,2),A(b,d?e:e.clone(),2),d&&(A(a,m),A(a,m,1),A(a,m,2))),f=b.defaults,g=a.defaults,f.colWidth=g.colWidth,f.rowHeight=g.rowHeight,f.rowHeaderColWidth=g.rowHeaderColWidth,f.colHeaderRowHeight=g.colHeaderRowHeight,d&&(g.colWidth=62,g.rowHeight=20,g.rowHeaderColWidth=40,g.colHeaderRowHeight=20))}function Q(a,b,c,d,f,g,h,i,j,l,m,n,p){var q,r,u,v,w,x,y,z,A,B,C,E,G,H,I,J,K,L,M,N,O,P,Q=!(a===d&&a.name()===d.name()),R=!p&&d.KLc();if(2===(2&l)&&b<0)if(A=c,B=g,q=o(s(a,1),s(d,1)),r=i,c<0&&(A=0,r=t(a)),g<0&&(B=0),C=r,Q)for(u=0,y=0;u<q&&u<s(d,1);u++)if(R&&0===d.getRowHeight(u,1))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,1);v++)R&&0===d.getColumnWidth(B+v,1)?r++:(x=m(a,y,A+z,1),n(d,u,B+v,F(x),1),z++);y++}else{for(w=new e.KTa,u=0;u<q;u++)for(v=0;v<r;v++)x=m(a,u,A+v,1),k(x)||w.set(u,v,F(x));for(u=0,y=0;u<q&&u<s(d,1);u++)if(R&&0===d.getRowHeight(u,1))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,1);v++)R&&0===d.getColumnWidth(B+v,1)?r++:(n(d,u,B+v,w.get(y,z),1),z++);y++}}if(1===(1&l)&&c<0)if(E=b,G=f,q=h,r=o(t(a,2),t(d,2)),b<0&&(E=0,q=s(a)),f<0&&(G=0),C=r,Q)for(u=0,y=0;u<q&&u<s(d,2);u++)if(R&&0===d.getRowHeight(G+u,2))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,2);v++)R&&0===d.getColumnWidth(v,2)?r++:(x=m(a,E+y,z,2),n(d,G+u,v,F(x),2),z++);y++}else{for(w=new e.KTa,u=0;u<q;u++)for(v=0;v<r;v++)x=m(a,E+u,v,2),k(x)||w.set(u,v,F(x));for(u=0,y=0;u<q&&u<s(d,2);u++)if(R&&0===d.getRowHeight(G+u,2))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,2);v++)R&&0===d.getColumnWidth(v,2)?r++:(n(d,G+u,v,w.get(y,z),2),z++);y++}}if(H=b,I=c,J=f,K=g,L=h,M=i,N=s(d),O=t(d),b<0&&(H=0,L=o(s(a),N)),c<0&&(I=0,M=o(t(a),O)),f<0&&(J=0),g<0&&(K=0),P=M,Q)for(y=0,u=0;u<L&&J+u<N;u++)if(R&&0===d.getRowHeight(J+u))L++;else if(D(J+u,j,d))y++;else{for(z=0,v=0,M=P;v<M&&K+v<O;v++)R&&0===d.getColumnWidth(K+v)?M++:(x=m(a,H+y,I+z,3),n(d,J+u,K+v,F(x),3),z++);y++}else{w=new e.KTa;try{for(u=0;u<L;u++)for(v=0;v<M;v++)x=m(a,H+u,I+v,3),k(x)||w.set(u,v,F(x));for(y=0,u=0;u<L&&J+u<N;u++)if(R&&0===d.getRowHeight(J+u))L++;else if(D(J+u,j,d))y++;else{for(z=0,v=0,M=P;v<M&&K+v<O;v++)R&&0===d.getColumnWidth(K+v)?M++:(n(d,J+u,K+v,w.get(y,z),3),z++);y++}}catch(a){}}}function R(a){return[a.row,a.col].join(",")}function S(a,b,c,d,f,g,h,i,j,l,n,o,p){var q;n&&(q=e.kf(b,c,h,i)),Q(a,b,c,d,f,g,h,i,j,l,function(a,b,c,e){var f,g,h,i,j,l,p,r,t=3===e,u=a.ITa,v={};return t?(g=(n||o)&&u.getDynamicArrayInfo(b,c),g&&g.isValid?(f=m,n&&(h=R(g),v[h]||(v[h]=g,i=g.row,j=g.col,q.contains(i,j,1,1)&&u.XTa(3).yIb(g)))):f=a.getValue(b,c,e,1)):(f=u.getValue(b,c,e,!0,1),1===e&&k(f)&&d.e7c&&(l=a.wq,l&&l._dataSource&&(p=u.Jp(!1,3,c),r=a.options.colHeaderAutoTextIndex,p&&(r>=0&&b===r||r===-1&&b===s(a,e)-1)&&(f=p.displayName||p.name)))),n&&(t?a.uq(b,c,m,e,!1):a.ITa.do("setValue",b,c,m,e,!0,!0)),f},function(a,b,c,d,e){k(d)?a.uq(b,c,m,e,!1):a.uq(b,c,d,e,!1)},p)}function T(a,b,c){var d,e,f,g=a.Tq(b),h=g.row,i=g.col,j=g.rowCount,k=g.colCount;for(d=0;d<j;d++)for(e=c[h+d]=c[h+d]||{},f=0;f<k;f++)e[i+f]=!0}function U(a,b,c,d,f,g,h,i,j,l,o,p,q){var r,s,t,u,v,w,x={};if(a.tables)for(r=e.kf(b,c,h,i),s=e.kf(f,g,h,i),t=a.tables.all(),u=void 0,v=0,w=t.length;v<w;v++)u=t[v].range(),u.containsRange(r)&&u.containsRange(s)?T(a,r,x):u.intersect(s.row,s.col,s.rowCount,s.colCount)&&T(a,u,x);Q(a,b,c,d,f,g,h,i,j,l,function(a,b,c,d){var e=(3===d||k(d))&&x[b]&&x[b][c],f=a.getCompositeStyle(b,c,d,n,n,n,n,e,n,n,p);return o&&B(a,b,c,m,d),f},function(a,b,c,d,e){B(a,b,c,d,e)},q)}function V(a,b,c,d,e,f,g,h,i,j,k){var l,n,o,p=a.uja.Dja;for(l in p)n=p[l],n&&(o=n.condition(),o&&o.initExpression());Q(a,b,c,d,e,f,g,h,i,0,function(b,c,e){var f=b.getDataValidator(c,e,3);return f&&(j&&b.setDataValidator(c,e,m),W(a,d)&&(f.Nja=!0)),f},function(b,c,e,f){b.setDataValidator(c,e,f),W(a,d)&&f&&delete f.Nja},k)}function W(a,b){return a===b&&a.name()===b.name()}function X(a,b,c,d,e,f,g,h,i,j,k){Q(a,b,c,d,e,f,g,h,i,0,function(a,b,c){var d=a.ITa.Ky,e=d&&d.get(b,c);return e&&j&&d.remove(b,c),e},function(a,b,c,d){var e=a.ITa.Ky;e&&e.Cz(b,c,d)},k)}function Y(a,b,c,d,e,f,g,h,i,j,l,m){Q(a,b,c,d,e,f,g,h,i,j,function(a,b,c,d){var e=a.getTag(b,c,d);return!k(e)&&l&&a.setTag(b,c,n),e},function(a,b,c,e,f){d.setTag(b,c,e,f)},m)}function Z(a,b,c,d,e,f,g,h,i,j,k){var l,n,o,q,r,s,t,u,v=[],w=[],x={},y={},z=!k&&d.KLc();if(z){for(l=g,n=h,l+=d.MLc(e,l,!0),n+=d.MLc(f,n),o=d.getRowCount(),q=d.getColumnCount(),r=0,s=0;r<l&&r+e<o;r++)0!==d.getRowHeight(e+r)&&(x[s]=r,s++);for(t=0,u=0;t<n&&t+f<q;t++)0!==d.getColumnWidth(f+t)&&(y[u]=t,u++)}return Q(a,b,c,d,e,f,g,h,i,0,function(d,e,f){var g,h,i=d.getBindingPath&&d.getBindingPath(e,f);return i&&(g=e-p(0,b),h=f-p(0,c),z&&(g=x[g],h=y[h]),v.push({row:g,col:h,value:d.getValue(e,f)})),j&&a.setBindingPath&&a.setBindingPath(e,f,m),i},function(a,b,c,d){w.push({sheet:a,r:b,c:c,value:d})},k),{savedValues:v,bindingPathInfos:w}}function $(a){a.forEach(function(a){var b=a.sheet,c=a.r,d=a.c,e=a.value;b.setBindingPath&&b.setBindingPath(c,d,e)})}function _(a,b,c,d,e,f,g,h,i,j,l,m){Q(a,b,c,d,e,f,g,h,i,j,function(a,b,c,d){var e=a.getHyperlink&&a.getHyperlink(b,c,d);return!k(e)&&l&&a.setHyperlink&&a.setHyperlink(b,c,n),e},function(a,b,c,e,f){d.setHyperlink&&d.setHyperlink(b,c,e,f)},m)}function aa(a,b,d,e,f,g,h,i){var j=c("SheetsCalc");j&&j.CalcOperatorAdjustor.moveFormula(a,b,d,e,f,g,h,i)}function ba(a,b,d,e,f,g,h,i){var j,k,m,n,o,p,q,r,s,t=c("SheetsCalc");if(t){if(j=t.uyb,n=a.ITa.dUa(),!a.parent||!a.parent.sheets)return o=a.getCustomNames(),void(o&&l(o,function(c,l){k=l.getExpression(),m=j(a,a,b,d,e,f,g,h,i,k),m!==k&&l.fg(m,n)}));for(p=a.parent.sheets,q=a.parent.getCustomNames(),q&&l(q,function(c,l){k=l.getExpression(),m=j(null,a,b,d,e,f,g,h,i,k),m!==k&&l.fg(m,n)}),r=function(c){var o=p[c].getCustomNames();o&&l(o,function(l,o){k=o.getExpression(),m=j(p[c],a,b,d,e,f,g,h,i,k),m!==k&&o.fg(m,n)})},s=0;s<p.length;s++)r(s)}}function ca(a,b,d,f,g,h,k,l,n,q,r,u,v,w){var x,y,z,A,B,C,F,G,L,Q,R,T,W,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa;if(E(a,b,d,f,g,h,k,l,u),(1&n)>0&&(2&n)>0&&(C=a.pivotTables,C&&(B=C.dB(e.kf(p(0,b),p(0,d),b<0?o(s(a),s(f)):k,d<0?o(t(a),t(f)):l),u))),u&&f.e7c&&b<0)for(y=d,z=l,d<0&&(y=0,z=o(t(a),t(f))),F=h,h<0&&(F=0),x=!0,G=0;G<z;G++)L=a.ITa.Jp(!1,3,y+G),Q=a.ITa.Jp(!1,3,F+G),R=L&&L.name,T=Q&&Q.name,L&&Q&&R&&T||(x=!1),Q=j.GC$.extend(!0,{},f.ITa.Jp(!1,3,F+G)||{}),Q.displayName=L&&L.displayName,Q.name=L&&L.name,f.ITa.do("setItem",!1,3,F+G,Q);(64&n)>0&&(U(a,b,d,f,g,h,k,l,q,r,u,v,w),a.dJb||a.uja&&V(a,b,d,f,g,h,k,l,q,u,w)),(512&n)>0&&H(a,b,d,f,g,h,k,l,u,w),(1&n)>0&&(2&n)>0&&(ca=a.tables,ca&&(W=ca.dB(e.kf(p(0,b),p(0,d),b<0?o(s(a),s(f)):k,d<0?o(t(a),t(f)):l),u))),da=i,da&&(a.suspendCalcService(),f.suspendCalcService()),ea=[],fa=m,ga=[],(256&n)>0&&(fa=Z(a,b,d,f,g,h,k,l,q,u,w),ea=fa.savedValues,ga=fa.bindingPathInfos);try{if(ha=f.pivotTables,(1&n)>0&&(2&n)>0&&ha&&ha.eB(B,a,p(0,b),p(0,d),f,p(0,g),p(0,h),k,l,u),(1&n)>0&&!x){if(S(a,b,d,f,g,h,k,l,q,r,u,(2&n)>0,w),u&&f.Wq("shiftCellsDown",{row:g,col:h,changedRowCount:g-b,changedColCount:h-d},!0),$(ga),i&&0===(2&n)&&f.clearFormula(g,h,k,l,function(a,b){return!q||!a.Ps||!a.Ps(b)}),(256&n)>0)for(ia=ea.length,ja=g<0?0:g,ka=h<0?0:h,la=0;la<ia;la++)ma=ea[la],!u&&D(ja+ma.row,q,f)||f.setValue(ja+ma.row,ka+ma.col,ma.value)}else $(ga);na=f.tables,(1&n)>0&&(2&n)>0&&na&&na.eB(W,p(0,b),p(0,d),p(0,g),p(0,h),u),i&&(u?(a.dJb||ba(a,b,d,f,g,h,k,l),(2&n)>0&&aa(a,b,d,f,g,h,k,l)):(2&n)>0&&(oa=c("SheetsCalc"),oa&&oa.vyb(a,b,d,f,g,h,k,l,q,w)),(1&n)>0&&(2&n)>0&&na&&na.R3(W))}finally{da&&(a.resumeCalcService(!1),f.resumeCalcService(!1))}if((4&n)>0&&X(a,b,d,f,g,h,k,l,q,u,w),(128&n)>0&&Y(a,b,d,f,g,h,k,l,q,r,u,w),(1024&n)>0&&_(a,b,d,f,g,h,k,l,q,r,u,w),(16&n)>0&&I(a,b,d,f,g,h,k,l,u,w),(8&n)>0&&(b<0&&J(a,d,f,h,l,u),d<0&&K(a,b,f,g,k,u)),(32&n)>0&&(u||1!==k||1!==l)&&M(a,b,d,f,g,h,k,l,u),b<0&&g<=0&&N(a,d,f,h,l,n,u,w,v),d<0&&h<=0&&O(a,b,f,g,k,n,q,u,w,v),b<0&&g<=0&&d<0&&h<=0&&P(a,f,n,u),u&&a.e7c&&b<0)for(y=d,z=l,d<0&&(y=0,z=o(t(a),t(f))),G=0;G<z;G++)a.getDataColumnName&&a.getDataColumnName(y+G)&&a.ITa.do("setItem",!1,3,y+G,m)}b.staticMembers={copyTo:function(a,b,c,d,e,f,g,h,i,j,k,l){ca(a,b,c,d,e,f,g,h,i,j,k,!1,n,l)},moveTo:function(a,b,c,d,e,f,g,h,i,j){ca(a,b,c,d,e,f,g,h,i,n,3,!0,j)}}},"./dist/core/worksheet/worksheet-ui.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/worksheet/style.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("Common"),i=c("./dist/core/core.enum.js"),j=c("CalcEngine"),k=c("./dist/core/worksheet/clipboardhelper.js"),l=!!j,m=g.util.tt,n=void 0,o=null,p=h.Common.j.Fa,q=d.Worksheet.prototype;function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return parseInt(a,10)}function v(a){return Math.abs(a)}function w(a,b){var c=a,d=b;return function(a){var b,e,f=this,g=f.sheet,h=f.row,i=f.col,j=f.sheetArea;if(0===arguments.length)return c.call(g,h,i,j);if(h>=0&&i>=0)for(b=h;b<h+f.rowCount;b++)for(e=i;e<i+f.colCount;e++)x(g,b,e,j)&&d.call(g,b,e,a,j);return f}}function x(a,b,c,d){var e=a.getRowCount(d),f=a.getColumnCount(d);return c<0&&0<=b&&b<e||b<0&&0<=c&&c<f||0<=b&&b<e&&0<=c&&c<f||b===-1&&c===-1}function y(a,b,c,d,f,g){var h,i;x(a,b,c,g)&&(h=a.Aj(b,c,g),h||(h=new e.Style),"string"==typeof h&&(i=h,h=new e.Style,h.parentName=i),"font"===d&&z(a,h,f),h[d]=f,a.setStyle(b,c,h,g))}function z(a,b,c){var d,e,f,g,h;p(b.themeFont)||(d=m(),e=d.style,f=b.font,e.font=f,g=f&&e.fontFamily,e.font=c,h=c&&e.fontFamily,h!==g&&(b.themeFont=n))}r=function(){function a(a,b,c,d,e,f){var g=this;b<0&&(b=d=-1),c<0&&(c=e=-1),g.sheet=a,g.row=b,g.rowCount=p(d)?1:d,g.col=c,g.colCount=p(e)?1:e,g.sheetArea=p(f)?3:f}return a.prototype.tag=function(a){var b=this,c=b.sheet,d=b.row,e=b.col,f=b.rowCount,g=b.colCount,h=b.sheetArea,i,j;if(0===arguments.length)return c.getTag(d,e,h);if(d>=0&&e>=0)for(i=d;i<d+f;i++)for(j=e;j<e+g;j++)c.setTag(i,j,a,h);else if(d>=0)for(i=d;i<d+f;i++)c.setTag(i,-1,a,h);else if(e>=0)for(j=e;j<e+g;j++)c.setTag(-1,j,a,h);return b},a.prototype.width=function(a){var b,c=this,d=c.sheet,e=c.row,f=c.col,g=c.sheetArea;if(0!==arguments.length){if(e<0)for(b=0;b<c.colCount;b++)d.setColumnWidth(b+f,a,g);return c}if(e<0)return d.getColumnWidth(f,g)},a.prototype.height=function(a){var b,c=this,d=c.sheet,e=c.row,f=c.col,g=c.sheetArea;if(0!==arguments.length){if(f<0)for(b=0;b<c.rowCount;b++)d.setRowHeight(b+e,a,g);return c}if(f<0)return d.getRowHeight(e,g)},a.prototype.visible=function(a){var b,c,d=this,e=d.sheet,f=d.row,g=d.col,h=d.sheetArea;if(0!==arguments.length){if(g<0&&f>=0)for(b=0;b<d.rowCount;b++)e.setRowVisible(b+f,a,h);else if(g>=0&&f<0)for(c=0;c<d.colCount;c++)e.setColumnVisible(c+g,a,h);return d}return g<0&&f>=0?e.getRowVisible(f,h):g>=0&&f<0?e.getColumnVisible(g,h):void 0},a.prototype.resizable=function(a){var b,c,d=this,e=d.sheet,f=d.row,g=d.col,h=d.sheetArea;if(0!==arguments.length){if(g<0&&f>=0)for(b=0;b<d.rowCount;b++)e.setRowResizable(b+f,a,h);else if(g>=0&&f<0)for(c=0;c<d.colCount;c++)e.setColumnResizable(c+g,a,h);return d}return g<0&&f>=0?e.getRowResizable(f,h):g>=0&&f<0?e.getColumnResizable(g,h):void 0},a.prototype.tq=function(a){var b=this;return b.sheet.tq(b.row,b.col,a,b.sheetArea)},a.prototype._w=function(a,b){var c=this,d,e,f=c.sheet,g=c.row,h=c.col,i=c.rowCount,j=c.colCount,k=c.sheetArea;if(f.suspendPaint(),g>=0&&h>=0)for(d=g;d<g+i;d++)for(e=h;e<h+j;e++)y(f,d,e,a,b,k);else if(g>=0)for(e=-1,d=g;d<g+i;d++)y(f,d,e,a,b,k);else if(h>=0)for(d=-1,e=h;e<h+j;e++)y(f,d,e,a,b,k);else g===-1&&h===-1&&i===-1&&j===-1&&(d=-1,e=-1,y(f,d,e,a,b,k));return f.resumePaint(),c},a.prototype.clear=function(a){var b=this;b.sheet.clear(b.row,b.col,b.rowCount,b.colCount,b.sheetArea,a)},a.prototype.setBorder=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o=this,p=o.sheet,q=o.sheetArea;p.suspendPaint();try{if(c=new g.Range(o.row,o.col,o.rowCount,o.colCount),d=p.Tq(c,q),e=d.row,f=d.col,h=d.rowCount,i=d.colCount,j=void 0,k=void 0,l=b.all,m=b.outline,n=b.inside,b.left||l||m)for(j=0;j<h;j++)p.getCell(e+j,f,q).borderLeft(a);if(b.top||l||m)for(k=0;k<i;k++)p.getCell(e,f+k,q).borderTop(a);if(b.right||l||m)for(j=0;j<h;j++)p.getCell(e+j,f+i-1,q).borderRight(a);if(b.bottom||l||m)for(k=0;k<i;k++)p.getCell(e+h-1,f+k,q).borderBottom(a);if(b.diagonalUp)for(j=0;j<h;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).diagonalUp(a);if(b.diagonalDown)for(j=0;j<h;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).diagonalDown(a);if(b.innerHorizontal||l||n)for(j=0;j<h-1;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).borderBottom(a),p.getCell(e+j+1,f+k,q).borderTop(a);if(b.innerVertical||l||n)for(k=0;k<i-1;k++)for(j=0;j<h;j++)p.getCell(e+j,f+k,q).borderRight(a),p.getCell(e+j,f+k+1,q).borderLeft(a)}finally{p.resumePaint()}},a.prototype.toHtml=function(a,b){void 0===a&&(a=i.HeaderOptions.noHeaders),void 0===b&&(b=!0);var c=this;return c.sheetArea===i.SheetArea.corner?"":k.S4.Q4(c.sheet,a,c.row,c.rowCount,c.col,c.colCount,c.sheetArea,b,[],[],!0,!0,b,!0)},a.Pl=w,a}(),b.CellRange=r,r.prototype.value=w(q.getValue,q.setValue),r.prototype.text=w(q.getText,q.setText),r.prototype.formula=w(function(a,b){return l&&this.getFormula(a,b)},function(a,b,c,d){l&&this.setFormula(a,b,c,d)}),r.prototype.styleName=w(q.getStyleName,q.setStyleName),f.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],function(a,b){r.prototype[b]=function(a){return 0===arguments.length?this.tq(b):this._w(b,a)}});function A(a){return a=a.replace(/[^\:]+\!/g,""),a=a.replace(/\$/g,"")}function B(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,p,q,r=a.split(":"),s=r[0],t=r[1],u=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+s)){if(d=s.match(u),e=d[3])return o;b=d[1],c=d[2]}else c=s;if(s&&!t){if(b&&c)return f=C(c),g=D(b),[f,g,1,1]}else if(s&&t){if(h=void 0,i=void 0,isNaN(+t)){if(j=t.match(u),e=j[3])return o;h=j[1],i=j[2]}else i=t;if(!b&&c&&!h&&i)return k=C(c),l=C(i),f=Math.min(k,l),m=v(k-l)+1,[f,-1,m,-1];if(b&&!c&&h&&!i)return n=D(b),p=D(h),g=Math.min(n,p),q=v(n-p)+1,[-1,g,-1,q];if(b&&c&&h&&i)return k=C(c),l=C(i),n=D(b),p=D(h),f=Math.min(k,l),m=v(k-l)+1,g=Math.min(n,p),q=v(n-p)+1,[f,g,m,q]}return o}b.Hgc=B;function C(a){return u(a)-1}function D(a){var b,c,d=64,e=26,f=0,g=a.length;for(b=0;b<g;b++)c=a[b].charCodeAt(0)-d,f+=Math.pow(e,g-b-1)*c;return f-1}b.Igc=D,f.GC$.extend(q,{getRange:function(){var a,b,d,e,f,g,h,i,j,k,m=arguments[0];if(t(m)){if(g=m.toUpperCase(),h=this.parent&&1===this.parent.options.referenceStyle)return o;if(f=arguments[1],g=A(g),g.split(",").length>1)return o;if(l){if(i=c("SheetsCalc"),j=i.formulaToRange(this,g,n,n,f),!j)return o;a=j.row,b=j.col,d=j.rowCount,e=j.colCount}else{if(k=B(g),!k)return o;a=k[0],b=k[1],d=k[2],e=k[3]}}else s(m)&&(a=m,b=arguments[1],d=arguments[2],e=arguments[3],f=arguments[4]);return new r(this,a,b,d,e,f)},getCell:function(a,b,c){return p(b)&&(b=-1),new r(this,a,b,1,1,c)}})},"./dist/core/worksheet/worksheet.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/util/common.js"),f=c("./dist/core/util/imageLoader.js"),g=c("./dist/core/util/tasks.js"),h=c("./dist/core/worksheet/style.js"),i=c("./dist/core/worksheet/worksheet-model.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/celltype/textcelltype.js"),l=c("CalcEngine"),m=c("./dist/core/celltype/headercelltype.js"),n=c("./dist/core/core.enum.js"),o=c("Common"),p=c("CalcEngine"),q=!!p,s=c("./dist/core/util/theme.js"),t=c("./dist/core/worksheet/stylehelper.js"),u=e.util.n0a,v=e.util.lHb,w=o.Common.j.Fa,x=e.util.Nl,y=e.util.Pl,z=e.util.Ql,A=e.util.bq,B=j.GC$.each,C=j.GC$.isEmptyObject,D=o.Common.D,E=e.util.x0a,F=e.util.w0a,G=RegExp("^\\d*(\\.\\d+)?\\*$"),H=o.Common.u,I=document,J=parseInt,K=parseFloat,L=isNaN,M=null,N=void 0,O=Math.min,P=Math.max,Q=Math.floor,R=Math.ceil,S=Math.abs,T=Math.round,U="undefined",V="string",W="width",X="height",Y="black",Z="tag",$="onLayoutChanged",_="beforeLayoutChanged",aa="onPaintSuspend",ba="isVisible",ca="starSize",da="resizable",ea=".gcSheet",fa=".gcSheetInternal",ga="columnHeaderFitMode",ha={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},ia=new o.Common.ResourceManager(d.SR),ja=ia.getResource.bind(ia);function pa(a,b){var c,d,e,f,g,h=[],i=a.ITa.hUa();if(i)for(c in i)if(D(i,c)&&(d=i[c],d&&(b||"n"!==d.rs||(e={row:+c,item:a.getDataItem&&a.getDataItem(+c)},h.push(e)),b&&"e"===d.rs)))for(f in d)if(!L(f)&&(g=d[f])){e={row:+c,item:a.getDataItem&&a.getDataItem(+c)},e.originalItem=d.originalItem,h.push(e);break}return h}function qa(a,b,c){var d,e=0;for(d=b;d<=c;d++)e+=a._m(d);return e}function ra(a,b,c){var d,e=0;for(d=b;d<=c;d++)e+=a.Sl(d);return e}function sa(a){return a.getColumnCount()}function ta(a){return a.getRowCount()}function ua(a){return a.frozenTrailingColumnCount()}function va(a){return a.frozenTrailingRowCount()}function wa(a){return a.qKc}function xa(a){return a.tKc}function ya(a){return a.frozenColumnCount()}function za(a){return a.frozenRowCount()}function Aa(a,b){var c=e.util.Pxb(a.font),d=e.util.Pxb(b.font);return c.fontStyle+" "+c.fontWeight+" "+d.fontSize+" "+d.fontFamily}function Ba(a,b,c){Object.defineProperty(a,b,{get:function(){return this["_"+b]},set:function(a){var d=this["_"+b];d!==a&&(this["_"+b]=a,c&&c(b,a,d))}})}!function(a){a[a.dirty=1]="dirty",a[a.insert=2]="insert",a[a.delete=4]="delete"}(ka=b.ClearPendingChangeType||(b.ClearPendingChangeType={}));function Ca(a,b,c,d){return{row:b,col:c,newValue:a.getValue(b,c),oldValue:d}}!function(a){a[a.setFormula=0]="setFormula",a[a.copyPaste=1]="copyPaste",a[a.dragFill=2]="dragFill",a[a.dragDrop=3]="dragDrop",a[a.changePartOfArrayFormula=4]="changePartOfArrayFormula",a[a.changeSheetName=5]="changeSheetName",a[a.table=6]="table",a[a.hideSheet=7]="hideSheet",a[a.pivotTable=8]="pivotTable",a[a.PTOverlapPT=9]="PTOverlapPT"}(la=b.InvalidType||(b.InvalidType={})),ma={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:Y,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:M,selectionBackColor:M,selectionBorderColor:M,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},reversalTrailingResizeOrder:!1,sheetAreaOffset:{left:0,top:0}};function Da(a){var b,c,d,e;if(a)for(b=a.sheets,c=b.length,e=0;e<c;e++)d=b[e],d.cJc===!0&&delete d.cJc}function Ea(a){return a===!1}na=function(){function a(b){var c=this;c._id=a.Np,a.Np++,c.options=z(ma,function(a,b,d){c.Op(a,b,d)}),c.ad(b),c.fgc=new g.Tasks(function(){return this.tasks.pop()},function(){var a=c.parent;return a&&a.ku.Gw||c.mm.OG||c.mm.xG||c.mm.eG})}return a.prototype.sortRange=function(a,b,c,d,e,f,g,h,i){return!1},a.prototype.Op=function(b,c,d){var e,f,g,h,i=this,j=i.parent;switch(b){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":case"reversalTrailingResizeOrder":i.$p();break;case"sheetAreaOffset":e=function(a,b){b<0&&(i.options.sheetAreaOffset[a]=0),i.$p()},f=i.options.sheetAreaOffset,["left","top"].forEach(function(a){var b=c[a];Ba(f,a,e),f[a]=b});break;case"gridline":g=function(){i.$p()},h=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(a){var b=c[a];Ba(h,a,g),h[a]=b});break;case"isProtected":c&&j&&j.undoManager().PY(function(a){return a.sheetId!==i._id}),i._p(),a.ao(i,"onProtectChanged"),i.$p();break;case"protectionOptions":i._p(),a.ao(i,"onProtectChanged");break;case"sheetTabColor":j&&j.aq()}},a.prototype.name=function(a){var b=this,c=b.parent;if(0===arguments.length)return b.ITa?b.ITa.getName():"";if(!A(a,c?c.sheets:null,b))throw ja().Exp_NotSupported;return b.cq(a),c&&c.aq(),b},a.prototype.isSelected=function(a){return this.DHb(a)},a.prototype.DHb=function(a,b){var c,d,f,g=this,h=g.parent,i=!!g.ITa&&g.ITa.TIb();return w(a)?i:(a!==i&&(c=g.name(),d=h&&h.getSheetIndex(c),f=void 0,b&&(f={oldValue:i,newValue:a,sheetName:c,propertyName:"isSelected",cancel:!1,sheetIndex:d},h&&h.Wq(e.Events.SheetChanging,f)),(!b||f&&f.cancel===!1)&&(g.ITa.CHb(a),h&&h.YJc&&h.YJc.repaint(),b&&h&&h.Wq(e.Events.SheetChanged,{oldValue:i,newValue:a,sheetName:c,propertyName:"isSelected",sheetIndex:d}))),g)},a.prototype.cq=function(b,c){var d=this,e=d.name();c||a.ao(d,"beforeSetName",{oldName:e,newName:b}),this.ITa.do("setName",b),c||a.ao(d,"setName",{oldName:e,newName:b})},a.prototype.addRows=function(b,c,d){var e,f,g,h;if(!(c<=0)){e=this,f=ta(e),(b<0||b>f)&&(b=f),0===e.ITa.WTa&&e.parent&&e.parent.pv.clear(),e.suspendPaint();try{if(e.eJb(!1),g={changeType:"addingRows",row:b,rowCount:c,canAdd:!0},a.ao(e,$,g),!g.canAdd)return;if(w(g.newRow)||(b=g.newRow),h="addRows",!e.pCb(b,3,h,c,f))return;this.ITa.do("addRows",b,c),e.jq=!0,a.ao(e,$,{changeType:h,row:b,oldValue:f,rowCount:c,rowExpand:d}),a.ao(e,$,{changeType:"addRows2",row:b,oldValue:f,rowCount:c}),e.tables&&e.tables.Cec(!0,b),e.kq(b,3,h,c,f)}finally{e.eJb(!0),e.resumePaint()}}},a.prototype.eJb=function(a){var b=this,c=b.Jl,d=b.Kl;b.ITa.setCellState(c,d,n.CellStatesType.active,a,n.SheetArea.viewport)},a.prototype.deleteRows=function(b,c){var d,e,f,g,h,i,j,k=this,l=ta(k);if(!(0>b||b>=l||c<=0)){0===k.ITa.WTa&&k.parent&&k.parent.pv.clear(),k.suspendPaint();try{if(k.eJb(!1),d={changeType:"deletingRows",row:b,rowCount:c,canDelete:!0},a.ao(k,$,d),!d.canDelete)return;if(e="deleteRows",!k.pCb(b,3,e,c,l))return;if(k.RIb(b,c,0,this.getColumnCount()),k.ITa.do("deleteRows",b,c),f=k.lq,f>=0){for(g=-1,h=za(k),i=f;i>=h;i--)if(k.getRowVisible(i)&&k.Sl(i)>0){g=i;break}g===-1&&(g=0),f!==g&&k.mq(g)}j=l,k.getActiveRowIndex()>=j&&k.setActiveCell(j-1,k.getActiveColumnIndex()),k.jq=!0,a.ao(k,$,{changeType:e,row:b,oldValue:l,rowCount:c}),k.tables&&k.tables.Cec(!0,b),k.kq(b,3,e,c,l)}finally{k.eJb(!0),k.resumePaint()}}},a.prototype.addColumns=function(b,c){var d,e,f,g;c<=0||(d=this,e=sa(d),(b<0||b>e)&&(b=e),0===d.ITa.WTa&&d.parent&&d.parent.pv.clear(),f={changeType:"addingColumns",col:b,colCount:c,canAdd:!0},a.ao(d,$,f),f.canAdd&&(d.eJb(!1),g="addColumns",d.qCb(b,3,g,c,e)&&(d.ITa.do("addColumns",b,c),d.oq=!0,a.ao(d,$,{changeType:g,col:b,oldValue:e,colCount:c}),a.ao(d,$,{changeType:"addColumns2",col:b,oldValue:e,colCount:c}),d.tables&&d.tables.Cec(!1,b),d.pq(b,3,g,c,e),d.eJb(!0),d.$p())))},a.prototype.deleteColumns=function(b,c){var d,e,f,g,h,i,j,k=this,l=sa(k);if(!(0>b||b>=l||c<=0)&&(0===k.ITa.WTa&&k.parent&&k.parent.pv.clear(),d={changeType:"deletingColumns",col:b,colCount:c,canDelete:!0},a.ao(k,$,d),d.canDelete&&(k.eJb(!1),e="deleteColumns",k.RIb(0,this.getRowCount(),b,c),k.qCb(b,3,e,c,l)))){if(k.ITa.do("deleteColumns",b,c),f=k.qq,f>=0){for(g=-1,h=ya(k),i=f;i>=h;i--)if(k.getColumnVisible(i)&&k.Tl(i)>0){g=i;break}g===-1&&(g=0),f!==g&&k.rq(g)}j=l,k.getActiveColumnIndex()>=j&&k.setActiveCell(k.getActiveRowIndex(),j-1),k.oq=!0,a.ao(k,$,{changeType:e,col:b,oldValue:l,colCount:c}),a.ao(k,$,{changeType:"deleteColumns2",col:b,oldValue:l,colCount:c}),k.tables&&k.tables.Cec(!1,b),k.pq(b,3,e,c,l),k.eJb(!0),k.$p()}},a.prototype.frozenTrailingRowCount=function(a,b){var c=this;return 0===arguments.length?c.aMc:(a>=0&&(w(b)&&(b=!0),c.aMc=a,c.qKc=b,c.jq=!0,c.$p()),c)},a.prototype.frozenTrailingColumnCount=function(a,b){var c=this;return 0===arguments.length?c.bMc:(a>=0&&(w(b)&&(b=!0),c.bMc=a,c.tKc=b,c.oq=!0,c.$p()),c)},a.prototype.getFrozenTrailingState=function(a){var b=this;return a?b.qKc:b.tKc},a.prototype.rKc=function(a){var b=xa(this),c=a.er;return b?c+a.sKc:c},a.prototype.oKc=function(a){var b=wa(this),c=a.jr;return b?c+a.pKc:c},a.prototype.getRowCount=function(a){return 0===a?0:this.ITa.getRowCount(a)},a.prototype.getColumnCount=function(a){return 0===a?0:this.ITa.getColumnCount(a)},a.prototype.setRowCount=function(b,c){var d,e;w(c)&&(c=3),d=this,e={changeType:"settingRowCount",rowCount:b,sheetArea:c,canSet:!0},a.ao(d,$,e),e.canSet&&d.setRowCountCore(b,c)},a.prototype.setRowCountCore=function(b,c){var d,e;b=J(b,10),L(b)||(w(c)&&(c=3),d=this,e=d.getRowCount(c),b<0||b===e||(3===c||2===c?(d.ITa.do("setRowCount",b,c),za(d)>b&&d.frozenRowCount(b)):1===c&&d.ITa.do("setRowCount",b,c),a.ao(d,$,{changeType:"setRowCount",rowCount:b,sheetArea:c}),d.jq=!0,d.Jl>=b&&(3===c||2===c)&&d.setActiveCell(b-1,d.getActiveColumnIndex()),d.$p(),d.clearPendingChanges()))},a.prototype.setColumnCount=function(b,c){var d,e;b=J(b,10),L(b)||(d=this,e=d.getColumnCount(c),b<0||b===e||(w(c)&&(c=3),3===c||1===c?(d.ITa.do("setColumnCount",b,c),ya(d)>b&&d.frozenColumnCount(b)):2===c&&d.ITa.do("setColumnCount",b,c),a.ao(d,$,{changeType:"setColumnCount",colCount:b,sheetArea:c}),d.oq=!0,d.Kl>=b&&(3===c||1===c)&&d.setActiveCell(d.getActiveRowIndex(),b-1),d.$p(),d.clearPendingChanges()))},a.prototype.JYc=function(a){var b,c,d,e,f;if(!w(a)&&(b=a.rows,d=!1,this.filterRowsVisibleInfo)){if(e=this.filterRowsVisibleInfo.rowsVisibleInfo||{},b&&b.length>0)for(f=0;f<b.length;f++)c=b[f],c&&c.isFilter&&(c.visible=!0,delete c.isFilter,e[f]=!1,d=!0);d&&(this.filterRowsVisibleInfo.rowsVisibleInfo=e,this.filterRowsVisibleInfo.empty=!1)}},a.prototype.aHb=function(a,b,d){var e,f,g=this;return r||(r=c("SheetsCalc")),r&&(e="string"==typeof d&&g.parent&&g.parent.aJb(d),e&&a!==-1&&b!==-1)?(f=e.getExpression(),r.evaluateExpression(g,f,a,b)):N},a.prototype.xHb=function(a,b,c){var d,e,f=this;if(f.options.showFormulas&&3===c){if(d=f.getFormula(a,b))return"="!==d[0]&&(d="="+d),d;if(e=f.ITa&&f.ITa.ZHb&&f.ITa.ZHb.getAnchorInfo(a,b))return""}},a.prototype.getText=function(a,b,c){var d,e,f;return w(c)&&(c=3),d=this,e=d.xHb(a,b,c),w(e)?(f=d.getValue(a,b,c),d._Yc(a,b,f,c,!0)):e},a.prototype.setText=function(b,c,d,e){var f,g,h,i,j,k,l=this;w(e)&&(e=3),f=d,g={value:d},a.ao(l,"settingText",g),d=g.value,h=d,i=l.getCellType(b,c,e),j=l.getFormatter&&l.getFormatter(b,c,e),i&&j&&!v(j)&&(k={sheet:l,row:b,col:c,sheetArea:e},h=i.parse(f,j,k),h=w(h)?d:h),l.uq(b,c,h,e),l.$p()},a.prototype.getValue=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q;return 0===c?M:(w(c)&&(c=3),f=this,g=f.options,h=f.ITa,i=h.getRowCount(c),j=h.getColumnCount(c),k=f.vq(h,a,b,c,d),1===c?w(k)&&(m=f.wq,m&&m._dataSource&&(n=f.ITa.Jp(!1,3,b),o=g.colHeaderAutoTextIndex,n&&(o>=0&&a===o||o===-1&&a===i-1)&&(k=n.displayName||n.name)),w(k)&&(l=g.colHeaderAutoTextIndex,(l<0||l>=i)&&(l=i-1),a===l&&(p=g.colHeaderAutoText,2===p?k=e.util.xq(b+1):1===p&&(k=b+1)))):2===c&&w(k)&&(l=g.rowHeaderAutoTextIndex,(l<0||l>=j)&&(l=j-1),b===l&&(q=g.rowHeaderAutoText,2===q?k=e.util.xq(a+1):1===q&&(k=a+1))),k)},a.prototype.setValue=function(a,b,c,d,e){this.uq(a,b,c,d,e);var f=this.parent,g=f&&f.getActiveSheet();g&&g.cJc===!0?g.$p():this.$p(),Da(f)},a.prototype.eyb=function(a,b,c,d){var e=this;!d&&q&&e.zq(a,b,c),e.t4&&e.t4(a,b,1,1,c)},a.prototype.fyb=function(){var a=this.conditionalFormats;a&&a.Nm()},a.prototype.WXc=function(a,b,c){if(a&&a.parent&&a.parent.sheets){var d=a.parent.sheets,e=a.name();d.forEach(function(a){var d=a.cameraShapes;d&&d.length>0&&d.forEach(function(d){var f,g,h,i;if(d.cameraImageCache&&(f=d.Fmb,g=f.znb.kWc,g&&(a.name()===e||g.sheet&&g.sheet.name()===e)))for(h=0;h<b.length;h++){if(i=g.cellRange,void 0!==b[h].row&&void 0===b[h].col&&2===c&&b[h].row>=i.row&&b[h].row<i.row+i.rowCount){d.cameraImageCache=null,f.znb.nWc&&f.qnb();break}if(void 0===b[h].row&&void 0!==b[h].col&&1===c&&b[h].col>=i.col&&b[h].col<i.col+i.colCount){d.cameraImageCache=null,f.znb.nWc&&f.qnb();break}if(0===c){if(void 0===b[h].rowCount&&void 0===b[h].colCount&&i.contains(b[h].row,b[h].col)){d.cameraImageCache=null;break}if(void 0!==b[h].rowCount&&void 0!==b[h].colCount&&i.intersect(b[h].row,b[h].col,b[h].rowCount,b[h].colCount)){d.cameraImageCache=null;break}}}})})}},a.prototype.uq=function(a,b,c,d,e){var f,g,h,i;0!==d&&(w(d)&&(d=3),f=this,g=f.ITa,h=g.getRowCount(d),i=g.getColumnCount(d),a<0||a>=h||b<0||b>=i||(c=E(c),c=u(c),g.do("setValue",a,b,c,d),f.eyb(a,b,d,e),f.fyb()))},a.prototype.AHb=function(a,b,c,d,e,f){var g=this,h;return h=g.getActualStyle(a,b,c,d,e,f),Fa(g,a,b,h,c),h},a.prototype.getActualStyle=function(a,b,c,d,f,g,i){var j,k,l,m,n,p,q,r,s,t,u,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,O,P,Q;if(w(c)&&(c=3),0===c)return new h.Style;if(a===-1&&b===-1)return this.getDefaultStyle(c);if(j=this,q=j.Cq,B="__spreadJSDefault",C="__undefined",D=this.ITa,3===c&&j.pivotTables&&(E=j.pivotTables.findPivotTable(a,b)||M,F=E&&E.HPc(a,b)),m=D.getStyle(a,b,c),n=D.getStyle(a,-1,c),p=D.getStyle(-1,b,c),m=m?m:M,n=n?n:M,p=p?p:M,i&&(a===-1&&(n=M),b===-1&&(p=M)),y=C,G=j.parent&&j.parent.GBb,m&&(y=m.charAt?m:B+m._id),z=C,n&&(z=n.charAt?n:B+n._id),A=C,p&&(A=p.charAt?p:B+p._id),x=q[c],r=x[y],H=j.tables,I=3===c&&H&&!g?H.find(a,b):M,I||E||j.xUc||(r||(r=x[y]={}),t=r[z],t?u=t[A]:t=r[z]={}),u||(l=j.getCompositeStyle(a,b,c,m,n,p,I,N,g,F,i,E)),3===c&&!d&&(J=j.conditionalFormats,J&&(k=J.Eq(k,a,b,c)),(w(k)||w(k.foreColor))&&(K=k&&k.formatter||u&&u.formatter||l&&l.formatter,K&&!g&&!v(K)))){try{L=o.Formatter&&o.Formatter.GeneralFormatter,L&&typeof K===V&&(K=e.mn.tn(K))}catch(a){}(K.hasFormatedColor&&K.hasFormatedColor()||o.Formatter&&K instanceof o.Formatter.FormatterBase)&&(O={conditionalForeColor:M},K.format(j.getValue(a,b),O),O.conditionalForeColor&&(w(k)&&(k=new h.Style),k.foreColor=O.conditionalForeColor))}if(k)s=u?u:l,k.Yo(s),k&&k.font&&s&&s.font&&k.font!==s.font&&(k.font=Aa(k,s)),l=k;else if(u)return!j.cellStates||d||G||(P=j.cellStates.getStyle(a,b,c,M,u.locked),P&&(P.Yo(u),u=P,u.Zo(j.Pm))),f?u:u.clone(!0);return i||(w(l.locked)&&(l.locked=!0),l=l.Zo(j.Pm)),k||I||E||j.xUc||(t[A]=l.clone(!0)),!j.cellStates||d||G||(Q=j.cellStates.getStyle(a,b,c,M,l.locked),Q&&(Q.Yo(l),l=Q,l=l.Zo(j.Pm))),l},a.prototype.tq=function(a,b,c,d){var f,g,i,j,k,l,m,n,p,q,r,s,t,u,v,x;if(0===d)return N;if(w(d)&&(d=3),f=this,k=f.ITa,
m=!1,3===d){if("foreColor"===c){p=f.tq(a,b,"formatter",d);try{q=o.Formatter&&o.Formatter.GeneralFormatter,q&&typeof p===V&&(p=e.mn.tn(p))}catch(a){}p&&(p.hasFormatedColor&&p.hasFormatedColor()||o.Formatter&&p instanceof o.Formatter.FormatterBase)&&(r={conditionalForeColor:M},p.format(f.getValue(a,b),r),r.conditionalForeColor&&(l=r.conditionalForeColor,m=!0))}s=f.conditionalFormats,s&&s.count()>0&&(t=s.Fq(a,b,c,d),m=t.v5,l=t.Fi)}for(u=0;!m&&u<=4;)if(0===u?g=k.getStyle(a,b,d):1===u?(v=f.tables,x=3===d&&v?v.find(a,b):M,x&&ha[c]&&(g=x.Gq(a,b,c))):g=2===u?k.getStyle(a,-1,d):3===u?k.getStyle(-1,b,d):f.getDefaultStyle(d),u++,g&&g.charAt&&typeof g===V&&(g=f.Hq(g)),g){if("font"===c&&g.themeFont&&!n&&(n=g.themeFont),g[c]!==N){l=g[c],m=!0;break}for(i=g.parentName;i&&(j=f.Hq(i));){if(j[c]!==N){l=j[c],m=!0;break}i=j.parentName}}return"locked"===c?!!w(l)||l:m||n?("foreColor"!==c&&"backColor"!==c&&"font"!==c&&"borderLeft"!==c&&"borderTop"!==c&&"borderRight"!==c&&"borderBottom"!==c||(g=new h.Style,g[c]=l,"font"===c&&n&&(g.themeFont=n),g.Zo(f.Pm),l=g[c]),l):N},a.prototype.getStyle=function(a,b,c){return this.Iq(a,b,c,!0)},a.prototype.Iq=function(a,b,c,d){var e,f,g,i;if(w(c)&&(c=3),0!==c){if(e=this.ITa,f=e.getStyle(a,b,c),f instanceof h.Style)return d&&this.Jq(),f;if(typeof f===V&&(g=this.Hq(f),g!==M&&g!==N))return i=new h.Style,i.Yo(g,!1),d&&this.Jq(),i}return M},a.prototype.addNamedStyle=function(a){this.Kq(a),this.$p()},a.prototype.Kq=function(a){if(a){if(!a.name)throw Error(ja().Exp_EmptyNamedStyle);var b=a.name.toUpperCase();this.Lq[b]=a}},a.prototype.getNamedStyle=function(a){return this.Mq(a,!0)},a.prototype.Mq=function(a,b){var c,d=this.Lq;return d&&a?(a=a.toUpperCase(),c=d[a],c&&b&&this.Jq(),c):M},a.prototype.Jq=function(){this.Cq=[{},{},{},{}]},a.prototype.removeNamedStyle=function(a){var b,c=this.Lq;c&&a&&(a=a.toUpperCase(),D(c,a)&&(b=c[a].formatter,b&&"string"==typeof b&&this.parent.QHb[b]&&this.parent.RHb(b),delete c[a],this.Jq(),this.$p()))},a.prototype.getNamedStyles=function(){var a=[],b=this.Lq;return b&&B(b,function(b,c){a.push(c)}),this.Jq(),a},a.prototype.setStyle=function(a,b,c,d){var e,f;w(d)&&(d=3),c&&c.backColor&&"object"==typeof c.backColor&&t.To.processStops(c.backColor),e=this,e.Nq(a,b,c,d),a===-1&&b===-1&&(e.Oq[d]=M),a!==-1&&b!==-1||(f=c&&c.validator,f&&f.condition()&&4===f.condition().conType()&&f.condition().getExpected(this,a<0?0:a,b<0?0:b)),e.Jq(),e.$p()},a.prototype.Pq=function(a,b,c,d){var e,f,g=this;g.options.isProtected?(e=g.getStyle(a,b,d),f=void 0,c?(f=e?e.locked:N,c.locked!==f&&(c.locked=f),g.setStyle(a,b,c,d)):e&&(f=e.locked,f!==N&&(c=new h.Style,c.locked=f),g.setStyle(a,b,c,d))):g.setStyle(a,b,c,d)},a.prototype.getStyleName=function(a,b,c){var d=this.Aj(a,b,c);return d instanceof h.Style?d.name:d},a.prototype.setStyleName=function(a,b,c,d){typeof c===V&&(this.Nq(a,b,c,d),this.$p())},a.prototype.Aj=function(a,b,c){w(c)&&(c=3);var d;return 0!==c&&(d=this.ITa.getStyle(a,b,c)),d||M},a.prototype.getNamedStyleName=function(a,b,c){var d=this.Aj(a,b,c);return"string"==typeof d?d:N},a.prototype.Nq=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p;if(w(d)&&(d=3),0!==d){if(f=this,g=f.Aj(a,b,d),h=f.ITa,i=h.getRowCount(d),j=h.getColumnCount(d),a<-1||a>=i||b<-1||b>=j)return;k=c,l=h.getStyle(a,b,d),typeof k===V&&(k=f.Hq(k)),m=k&&k.formatter,m&&v(m)&&f.fJb(a,b,m),h.do("setStyle",a,b,c,d),n=g&&g.cellType&&g.cellType.typeName||M,o=c&&c.cellType&&c.cellType.typeName||M,a===f.Jl&&b===f.Kl&&n!==o&&e.Vl.Wl(f)&&f.mm.Qq(),p="[styleinfo]",a!==-1&&b!==-1?f.Bq(p,a,b,d,l,c):a!==-1&&b===-1?f.kq(a,d,p,c,l):a===-1&&b!==-1&&f.pq(b,d,p,c,l)}},a.prototype.fJb=function(a,b,d){var e,f,g,h,i,j,k,m=this;if(r||(r=c("SheetsCalc")),r){if(a===-1&&(a=0),b===-1&&(b=0),e=m.getCell(a,b,3),f=r.rangeToFormula(e,a,b,3),g=d.trim(),"="===g.charAt(0)&&g.indexOf("@")>=0&&(g=g.replace(/@/g,f)),g.indexOf("{{")>=0&&g.indexOf("}}")>=0){for(h=g.split(/{{|}}/),""===h[0]&&h.shift(),""===h[h.length-1]&&h.pop(),i=0;i<h.length;i++)h[i].indexOf("=")===-1?h[i]='"'+h[i]+'"':(h[i].indexOf("@")>=0&&(h[i]=h[i].replace(/@/g,f)),j=r.evaluateFormula(m,h[i]),j instanceof l.CalcError?h[i]='"'+j+'"':h[i]=h[i].replace(/=/g,""));g="=CONCAT("+h.join(",")+")"}k=m.parent,k.aJb(d)||k.Yu(k.QHb,d,g,a,b,!0,"")}},a.prototype.getDefaultStyle=function(a){var b,c,d,e,f,g,i;return w(a)&&(a=3),b=this,c=b.Oq,(d=c[a])?d:0!==a?(e=b.ITa,f=e.getStyle(-1,-1,a),typeof f===V&&(f=b.Hq(f)),f||(f=new h.Style,e.do("setStyle",-1,-1,f,a)),f=f,g=1===a||2===a,typeof f.hAlign===U&&(f.hAlign=g?1:3),typeof f.vAlign===U&&(f.vAlign=g?1:0),typeof f.imeMode===U&&(f.imeMode=1),f.font||typeof f.themeFont!==U||(f.themeFont="Body"),c[a]=f,f):(i=new h.Style,i.locked=!0,c[a]=i,i)},a.prototype.setDefaultStyle=function(a,b){w(b)&&(b=3);var c=this;0!==b&&c.ITa.do("setStyle",-1,-1,a,b),c.Oq[b]=M,c.Jq(),c.$p()},a.prototype.Hq=function(a){var b,c,d=this.Mq(a,!1);return d||(b=this.parent,d=b&&b.Mq(a,!1)),c=M,d&&(c=d.clone(!0),this.aZc(c)),c},a.prototype.aZc=function(a){if(a){var b=a.applyFont,c=a.applyFill,d=a.applyBorder,e=a.applyAlignment,f=a.applyNumberFormat,g=a.applyProtection;Ea(b)&&(delete a.foreColor,delete a.textDecoration,delete a.themeFont,delete a.font),Ea(c)&&delete a.backColor,Ea(d)&&(delete a.borderLeft,delete a.borderTop,delete a.borderRight,delete a.borderBottom,delete a.diagonalDown,delete a.diagonalUp),Ea(e)&&(delete a.textIndent,delete a.wordWrap,delete a.hAlign,delete a.vAlign,delete a.isVerticalText,delete a.shrinkToFit,delete a.textOrientation),Ea(f)&&delete a.formatter,Ea(g)&&delete a.locked}},a.prototype.getCompositeStyle=function(a,b,c,d,e,f,g,i,j,k,l,m){var n,o,p,q;if(w(c)&&(c=3),o=this,p=new h.Style,q=!1,0!==c){if(q=o.bZc(a,b,c,p,q,d),i)return p;q=o.cZc(a,b,c,p,q,g,j),n=o.dZc(a,b,c,p,q,m,j,k),q=n.changed,p=n.destInfo,q=o.eZc(a,c,p,q,e),q=o.fZc(b,c,p,q,f)}return o.gZc(c,p,q,l),p},a.prototype.bZc=function(a,b,c,d,e,f){var g,h,i,j=this,k=j.ITa,l=k.getRowCount(c),m=k.getColumnCount(c);if(0<=a&&a<l&&0<=b&&b<m&&(i=f!==N?f:k.getStyle(a,b,c),i&&i.charAt&&(i=j.Hq(i)),i))for(d.Yo(i,!0,10),e=!0,g=i.parentName;g&&(h=j.Hq(g));)d.Yo(h,!1,10,!0),g=h.parentName;return e},a.prototype.cZc=function(a,b,c,d,e,f,g){var h=this,i=h.tables;return f!==N||g||(f=3===c&&i?i.find(a,b):M),f&&!g&&(f.Yo(a,b,d),e=!0),e},a.prototype.dZc=function(a,b,c,d,e,f,g,h){var i,j=this,k=j.pivotTables;return f!==N||g||(f=3===c&&k?k.findPivotTable(a,b):M,h=f&&f.HPc(a,b)),h&&(h.parentName&&(i=j.Hq(h.parentName),i&&h.Yo(i)),h.Yo(d),d=h,e=!0),f&&(f.MPc(a,b,d),e=!0),{changed:e,destInfo:d}},a.prototype.eZc=function(a,b,c,d,e){var f=this,g=f.ITa,h=g.getRowCount(b),i,j,k;if(0<=a&&a<h&&(i=e!==N?e:g.getStyle(a,-1,b),i&&i.charAt&&(i=f.Hq(i)),i))for(c.Yo(i,!d,30),d=!0,j=i.parentName;j&&(k=f.Hq(j));)c.Yo(k,!1,30,!0),j=k.parentName;return d},a.prototype.fZc=function(a,b,c,d,e){var f=this,g=f.ITa,h=g.getColumnCount(b),i,j,k;if(0<=a&&a<h&&(i=e!==N?e:g.getStyle(-1,a,b),i&&i.charAt&&(i=f.Hq(i)),i))for(c.Yo(i,!d,40),d=!0,j=i.parentName;j&&(k=f.Hq(j));)c.Yo(k,!1,40,!0),j=k.parentName;return d},a.prototype.gZc=function(a,b,c,d){var e,f,g=this,h=g.getDefaultStyle(a);if(h&&h.charAt&&(h=g.Hq(h)),h&&!d)for(b.Yo(h,!c,50),e=h.parentName;e&&(f=g.Hq(e));)b.Yo(f,!1,50,!0),e=f.parentName;return c},a.prototype.getCellType=function(a,b,c){return this.tq(a,b,"cellType",c)||this.Al(c)},a.prototype.Al=function(a){w(a)&&(a=3);var b=this.Rq;return b||(b=this.Rq=new k.Text),3===a?b:1===a?new m.ColumnHeader:2===a?new m.RowHeader:0===a?new m.Corner:b},a.prototype.setCellType=function(a,b,c,d){var e=this.Iq(a,b,d);e||(e=new h.Style),e.cellType=c,this.setStyle(a,b,e,d)},a.prototype.Sq=function(a,b,c,d,f){var g,h,i,j,k,l,m=this;if(w(f)&&(f=3),g=m.ITa,g.do("clearSpan",a,b,c,d,f),h=e.kf(a,b,c,d),i=m.Tq(h,f),j=m.Fia(i,f),g.do("addSpan",j,f),3===f){for(k=m.getSelections(),l=0;l<k.length;l++)k[l].intersect(a,b,c,d)&&(k[l]=k[l].union(h));g.do("setSelections",k)}m.$p()},a.prototype.Fia=function(a,b){var c=this.getRowCount(b),d=this.getColumnCount(b),f=a.row,g=a.col,h=a.rowCount,i=a.colCount;return f+h>c&&(h=c-f),g+i>d&&(i=d-g),e.kf(f,g,h,i)},a.prototype.addSpan=function(b,c,d,e,f){var g,h,i,j,k,l=this;if((1!==d||1!==e)&&0!==f&&(g=l.getRowCount(f),h=l.getColumnCount(f),!(b>=g||c>=h||b<-1||c<-1)&&(i=!0,q&&(3===f||w(f))&&(i=l.Vq(b,c,d,e,!1),l.pivotTables&&(i=i&&l.pivotTables.MOc(b,c,d,e))),i))){if(j=l.ITa,j.qu(b,c,d,e,f))throw Error(ja().Exp_InvalidRange);l.wyb&&l.wyb(b,c,d,e),l.Sq(b,c,d,e,f),k={sheet:l,row:b,col:c,rowCount:d,colCount:e,sheetArea:f,changeType:"addSpan"},a.ao(l,$,k),l.Wq("spanChanged",k)}},a.prototype.removeSpan=function(b,c,d){var e,f,g,h=this;w(d)&&(d=3),e=h.ITa,f=e.findSpan(b,c,d),f&&f.row===b&&f.col===c&&e.do("removeSpan",f,d),g={sheet:h,row:b,col:c,sheetArea:d,changeType:"removeSpan"},a.ao(h,$,g),h.Wq("spanChanged",g),h.$p()},a.prototype.getSpans=function(a,b){return 0===b?[]:this.ITa.getSpans(a,b,!0)},a.prototype.getSpan=function(a,b,c){return 0===c?M:this.ITa.findSpan(a,b,c)},a.prototype.repaint=function(a){this.Xq<=0&&this.yl&&this.yl.repaint(a)},a.prototype.ULc=function(a,b,c,d){var f,g=a,h=1,i=this.y6c(a,b,c,d);i&&(g=i.row,h=i.rowCount),f=this.cm(new e.Range(g,(-1),h,(-1))),f.y-=2,f.height+=4,this.repaint(f)},a.prototype.VLc=function(a,b,c,d){var f,g=a,h=1,i=this.z6c(a,b,c,d);i&&(g=i.col,h=i.colCount),f=this.cm(new e.Range((-1),g,(-1),h)),f.x-=2,f.width+=4,this.repaint(f)},a.prototype.y6c=function(a,b,c,d){var e,f,g,h,j=this,k=j.it(c),l=k.length;if(0===l)return M;if(e=j.Ir(b,c,n.SheetArea.viewport,d)){if(e.length>l)for(e=new i.yp,f=k[0].col,g=f;g<l;g++)h=j.rr(b,c,n.SheetArea.viewport,a,k[g].col),h&&e.push(h);return e.findLargestRow(a)}return M},a.prototype.z6c=function(a,b,c,d){var e,f,g,h,j=this,k=j.jt(b),l=k.length;if(0===l)return M;if(e=j.Ir(b,c,n.SheetArea.viewport,d)){if(e.length>l)for(e=new i.yp,f=k[0].row,g=f;g<l;g++)h=j.rr(b,c,n.SheetArea.viewport,k[g].row,a),h&&e.push(h);return e.findLargestCol(a)}return M},a.prototype.Yq=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u=this,v=u.parent,w=v&&v.options.scrollbarAppearance===n.ScrollbarAppearance.mobile,x=!1,y=!1,z=v&&v.options.scrollByPixel,A=za(u),B=ya(u),C=B?u.Zq(B-1):u.$q(),D=A?u._q(A-1):u.ar();if(b<u.qq&&b>=C?(x=!0,u.rq(u.br(b+1),0)):z&&b===u.qq&&0!==u.eCb&&(x=!0,u.rq(b,0)),b>u.cr()&&b<=u.dr()){for(c=0,d=b,e=u.am(),f=u.rKc(e),g=u.ITa.findSpan(a,d),g&&(d=g.col+g.colCount-1);d>u.qq&&(c+=u.Tl(d),!(c>f));)d--;h=void 0,i=void 0,z?(d===u.qq&&c<f&&(c+=u.Tl(d)),h=d,i=f-c):(h=u.Zq(d),i=0),x=!0,u.rq(h,i)}if(a<u.lq&&a>=D?(y=!0,u.mq(u.gr(a+1),0)):z&&a===u.lq&&0!==u.cCb&&(y=!0,u.mq(a,0)),a>u.hr()&&a<=u.ir()){for(j=0,k=a,l=u.ITa.findSpan(k,b),l&&(k=l.row+l.rowCount-1),m=u.am(),o=u.oKc(m);k>u.lq&&(j+=u.Sl(k),!(j>o));)k--;p=void 0,q=void 0,z?(k===u.lq&&j<o&&(j+=u.Sl(k)),p=k,q=o-j):(p=u._q(k),q=0),y=!0,u.mq(p,q)}z||b!==u.dr()||u.rq(u.lr(),0),w&&(r=v.nKc,s=v.kKc,t=v.ku,y&&(r.Jwa(n.ScrollbarState.show),t.Rdc(!0)),x&&(s.Jwa(n.ScrollbarState.show),t.Rdc(!1)))},a.prototype.hitTest=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F=this;if(F.am(),e={x:a,y:b},f=F.rowOutlines,g=F.columnOutlines,f&&(h=f.hitTest(F,a,b)),!h&&g&&(h=g.hitTest(F,a,b)),h)e.outlineHitInfo=h;else{if(i=F.nr(b),j=F.or(a),e.rowViewportIndex=i,e.colViewportIndex=j,e.row=F.pr(b,i),e.col=F.qr(a,j,b,i,e.row),i>=0&&i<=2&&j>=0&&(k=F.rr(i,j,N,e.row,e.col),k&&c!==!0&&(e.row=k.row,e.col=k.col)),e.hitTestType=F.sr(i,j),l=F.mm,m=F.xr,n=m&&m.hitTest(e,a,b),o=F.tables,p=void 0,o&&(p=e.rowViewportIndex===-1?o&&o.find(F.getActiveRowIndex(),F.getActiveColumnIndex()):o.find(e.row,e.col)),n||(q=p&&p.xr,n=q&&q.hitTest(e,a,b)),r=o&&!n&&o.gJb(a,b,e))return e.tableSelectInfo=r,r.table&&r.table.xr&&(e.filterButtonHitInfo=n),e;s=l.Yia&&l.Yia(e,a,b),s?e.dragMergeInfo=s:(t=l.tr&&l.tr(e,a,b),t?e.dragInfo=t:(u=e.col,e.col=F.qr(a,j),e.hZc=u,v=l.ur(e,a,b,5),v?e.resizeInfo=v:(e.col=u,delete e.hZc,x=l.vr?l.vr(e,a,b):M,x?e.formulaRangeHitInfo=x:(y=F.ITa.Ky,z=y&&y.hitTest(a,b),z?e.commentHitInfo=z:(A=F.wr,B=A&&A.hitTest(a,b,d),C=void 0,F.shapes&&(C=F.shapes.hitTest(a,b)),C?e.shapeHitInfo=C:B?e.floatingObjectHitInfo=B:n?e.filterButtonHitInfo=n:(D=p&&!p.hJb()&&l.iJb&&l.iJb(e,p),D?e.resizeTableHitInfo=D:e.cellTypeHitInfo=F.yr(e,a,b)))))))}return E=F.pivotTables&&F.pivotTables.findPivotTable(e.row,e.col),w(E)||(e.pivotTableInfo=E),e},a.prototype.getCellRect=function(a,b,c,d,f){var g,h,i,j,k,l,m=3;return c===-1?m=1:d===-1&&(m=2),g=this,h=g.am(),c===-1&&d===-1?new e.Rect(h.zr,h.Ar,h.Br,h.Cr):(i=g.Dr(),w(c)&&(c=g.Er(a)),w(d)&&(d=g.Fr(b)),j=g.Gr(c,m).findRow(a),k=g.Hr(d,m).findCol(b),l=g.Ir(c,d,m,f).findCell(a,b),l?new e.Rect(l.x-i.x,l.y-i.y,l.width,l.height):j&&k?new e.Rect(k.x-i.x,j.y-i.y,k.width,j.height):new e.Rect)},a.prototype.Jr=function(a,b,c){var d,f,g,h,i,j,k,l=this,m=l.mm,o=!1,p=l.Jl,q=l.Kl;w(a)||(l.Jl=a,o=!0),w(b)||(l.Kl=b,o=!0),d=l.QLc,f=d&&d.isEnable(n.RowColumnStates.active,!0),g=d&&d.isEnable(n.RowColumnStates.active,!1),f&&(l.ULc(p,l.Nr,l.Pr),l.ULc(a,l.Nr,l.Pr)),g&&(l.VLc(q,l.Nr,l.Pr),l.VLc(b,l.Nr,l.Pr)),l.ITa.setCellState(p,q,n.CellStatesType.active,!1,n.SheetArea.viewport),f||g||l.xIb&&l.xIb(n.CellStatesType.active,p,q,n.SheetArea.viewport),l.ITa.setCellState(a,b,n.CellStatesType.active,!0,n.SheetArea.viewport),f||g||l.xIb&&l.xIb(n.CellStatesType.active,a,b,n.SheetArea.viewport),!c&&m&&o&&(m.Qq(),h=l.ITa,i=h.getDynamicArrayInfo(a,b),j=h.WIb,i!==j&&(h.WIb=i,l.Xq<=0&&(k=void 0,i&&j?k=e.getUnionRange(i,j):(i=i||j,k=e.kf(i.row,i.col,i.rowCount,i.colCount)),l.yl.im(k))))},a.prototype.gCb=function(a,b,c,d,e){var f=a.getCellRect(b,c,d,e),g=f.x,h=f.y,i=f.width,j=f.height;return f.x=g-2,f.y=h-2,f.width=i+4,f.height=j+4,f},a.prototype.Kr=function(a,b,c,d,f){var g,h=this,i=h.Jl,j=h.Kl,k=h.ITa,l=k.getSpan(a,b);h.Lr=l.rowCount,h.Mr=l.colCount,h.Xq<=0&&(g=k.getSpan(i,j),h.yl.im(e.kf(i,j,g.rowCount,g.colCount))),h.Nr=c,h.Pr=d,h.Jr(a,b,f),h.Qr=a,h.Rr=b},a.prototype.setActiveCell=function(a,b,c,d){this.Sr(a,b,c,d,2)},a.prototype.Sr=function(a,b,c,d,f){var g,h,i,j=this,k=ta(j),l=sa(j);a<0?a=0:a>=k&&(a=P(0,k-1)),b<0?b=0:b>=l&&(b=P(0,l-1)),j.Tr(),g=2===f?e.Vl.Wl(j):1===f,j.Kr(a,b,c,d,!g),h={sheet:j,sheetName:j.name(),row:a,col:b},j.Wq(e.Events.FormulatextboxEnterCell,h),i=j.ITa.getSpan(a,b),j.Ur(i.row,i.col,i.rowCount,i.colCount),j.$p()},a.prototype.getActiveRowIndex=function(){return this.Jl},a.prototype.getActiveColumnIndex=function(){return this.Kl},a.prototype.getRowResizable=function(a,b){return this.ITa.getResizable(!0,b,a)},a.prototype.setRowResizable=function(a,b,c){this.Vr(a,b,da,!0,c)},a.prototype.Vr=function(a,b,c,d,e){var f,g,h,i;switch(w(e)&&(e=3),c!==X&&c!==W||!G.test(b)||(c=ca),f=this,g=f.ITa,c){case da:h=g.getResizable(d,e,a);break;case"pageBreak":h=g.getPageBreak(d,e,a);break;case ba:h=g.getVisible(d,e,a);break;case X:h=g.getSize(d,e,a);break;case W:h=g.getSize(d,e,a);break;case ga:h=g.getColumnHeaderFitMode(d,e,a)}if(i=!0,i=d?f.pCb(a,e,c,b,h):f.qCb(a,e,c,b,h),!i)return i;switch(c){case da:g.do("setResizable",d,e,a,b);break;case"pageBreak":g.do("setPageBreak",d,e,a,b);break;case ba:g.do("setVisible",d,e,a,b),d&&q&&3===e&&h!==b&&f.recalcRows([a]);break;case X:g.do("setSize",d,e,a,b),!q||3!==e||h===b||0!==h&&0!==b||f.recalcRows([a]);break;case W:g.do("setSize",d,e,a,b),!q||3!==e||h===b||0!==h&&0!==b||f.recalcCols([a]);break;case ca:g.do("setStarSize",d,e,a,b);break;case ga:g.do("setColumnHeaderFitMode",d,e,a,b)}return d?f.kq(a,e,c,b,h):f.pq(a,e,c,b,h),!0},a.prototype.getColumnResizable=function(a,b){return this.ITa.getResizable(!1,b,a)},a.prototype.setColumnResizable=function(a,b,c){this.Vr(a,b,da,!1,c)},a.prototype.getRowHeight=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(w(b)&&(b=3),c)return k.ITa.getStarSize(!0,b,a);if(3===b||2===b){if(d=k.getRowCount(b),a<0||a>=d)return 0;for(e=k.Wr,f=0;f<e.length;f++)if(g=e[f],!g.Xr(a))return 0}return h=k.defaults,i=h.rowHeight,1===b&&(i=h.colHeaderRowHeight),j=k.ITa.getSize(!0,b,a),j||0===j?j:Q(i)},a.prototype.Yr=function(a,b){var c,d,e,f;return w(b)&&(b=3),c=this,d=c.defaults,e=d.rowHeight,1===b&&(e=d.colHeaderRowHeight),f=c.ITa.getActualSize(!0,b,a),f||0===f?f:Q(e)},a.prototype.setRowHeight=function(a,b,c){this.Vr(a,b,X,!0,c)&&(this.jq=!0,this.$p())},a.prototype.getRowVisible=function(a,b,c){var d,e,f,g=this;if(w(b)&&(b=3),!c&&(3===b||2===b))for(d=g.Wr,e=0;e<d.length;e++)if(f=d[e],!f.Xr(a))return!1;return this.ITa.getVisible(!0,b,a)},a.prototype.setRowVisible=function(a,b,c){var d=this;d.Vr(a,b,ba,!0,c)&&(d.jq=!0,d.$p())},a.prototype.getColumnWidth=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(w(b)&&(b=3),c)return k.ITa.getStarSize(!1,b,a);if(d=k.defaults,e=d.colWidth,2===b&&(e=d.rowHeaderColWidth),3===b||1===b){if(f=k.getColumnCount(b),a<0||a>=f)return 0;for(g=k.Zr,h=0;h<g.length;h++)if(i=g[h],!i.Xr(a))return 0}return j=this.ITa.getSize(!1,b,a),j||0===j?j:Q(e)},a.prototype.$r=function(a,b){var c,d,e,f;return w(b)&&(b=3),c=this,d=c.defaults,e=d.colWidth,2===b&&(e=d.rowHeaderColWidth),f=c.ITa.getActualSize(!1,b,a),f||0===f?f:Q(e)},a.prototype.setColumnWidth=function(a,b,c){this.Vr(a,b,W,!1,c)&&(this.oq=!0,this.$p())},a.prototype.getColumnVisible=function(a,b){var c,d,e,f=this;if(w(b)&&(b=3),3===b||1===b)for(c=f.Zr,d=0;d<c.length;d++)if(e=c[d],!e.Xr(a))return!1;return f.ITa.getVisible(!1,b,a)},a.prototype.setColumnVisible=function(a,b,c){var d=this;d.Vr(a,b,ba,!1,c)&&(d.oq=!0,d.$p())},a.prototype.zoom=function(a){var b,c=this;return 0===arguments.length?c.ITa.getZoomFactor():(a=K(a),!L(a)&&isFinite(a)&&(a>4?a=4:a<.25&&(a=.25),b=c.ITa.getZoomFactor(),c.XSa(a),c.eCb=c.eCb/b*a,c.cCb=c.cCb/b*a,c.oq=!0,c.jq=!0,c.$p()),c)},a.prototype.XSa=function(b){this.ITa.do("setZoomFactor",b),a.ao(this,$,{changeType:"zoomSheet"})},a.prototype.x6a=function(){var a=this;a._r=M,a.as={colHeader:M,viewport:M},a.bs={rowHeader:M,viewport:M,colHeader:M}},a.prototype.invalidateLayout=function(){var b,c,d=this,f=d.mm;d.ITa.$Gb(),d.x6a(),a.ao(d,_,{changeType:"invalidateLayout"}),d.oq&&(d.ds(),d.oq=!1),d.jq&&(d.es(),d.jq=!1),d.x6a(),a.ao(d,$,{changeType:"invalidateLayout"}),f&&f.cs&&e.Vl.Wl(d)&&!f.byb(d)&&f.cs(d.Jl,d.Kl),d.$l=!0,b=d.parent,b&&b.options.enableAccessibility&&(c=d.cgc(),b.dgc(c))},a.prototype.$p=function(){var a=this;a.Xq<=0&&(a.invalidateLayout(),a.repaint())},a.prototype.getViewportHeight=function(a){var b=this,c=b.am();return 0===a?c.fs:1===a?b.oKc(c):2===a?c.gs:0},a.prototype.getViewportWidth=function(a){var b=this.am();return 0===a?b.hs:1===a?this.rKc(b):2===a?b.js:0},a.prototype.getViewportTopRow=function(a){var b=this,c=za(b);return 0===a?0:1===a?P(c,b.lq):2===a?P(c,ta(b)-va(b)):-1},a.prototype.getViewportTopRowOffset=function(){return this.cCb},a.prototype.getViewportBottomRow=function(a){var b,c,d,e,f,g,h=this;if(2===a)return ta(h)-1;for(b=h.getViewportTopRow(a),c=h.getViewportHeight(a),d=1===a?h.cCb:0,e=0,f=ta(h)-va(h),0===a&&(f=O(za(h),f)),g=b;g<f&&d<c;g++,e++)d+=h.Sl(g);return b+e-1},a.prototype.jCb=function(a){var b,c=this,d=c.getViewportTopRow(a),e=c.getViewportBottomRow(a);for(b=d;b<e+1;b++)if(b>-1&&c.getRowVisible(b,3)&&c.Sl(b,3)>0)return b;return-1},a.prototype.getViewportLeftColumn=function(a){var b=this,c=ya(b);return 0===a?0:1===a?P(c,b.qq):2===a?P(c,sa(b)-ua(b)):-1},a.prototype.getViewportLeftColumnOffset=function(){return this.eCb},a.prototype.getViewportRightColumn=function(a){var b,c,d,e,f,g,h=this;if(2===a)return sa(h)-1;for(b=h.getViewportLeftColumn(a),c=h.getViewportWidth(a),d=0,e=1===a?h.eCb:0,f=sa(h)-ua(h),0===a&&(f=O(ya(h),f)),g=b;g<f&&e<c;g++,d++)e+=h.Tl(g);return b+d-1},a.prototype.kCb=function(a){var b,c=this,d=c.getViewportLeftColumn(a),e=c.getViewportRightColumn(a);for(b=d;b<e+1;b++)if(b>-1&&c.getColumnVisible(b,3)&&c.Tl(b,3)>0)return b;return-1},a.prototype.showCell=function(a,b,c,d){this.iXc(a,b,c,d)},a.prototype.iXc=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s=this;a<0||a>=ta(s)||b<0||b>=sa(s)||(i=s.parent&&s.parent.options.scrollByPixel,j=s.parent&&s.parent.options.scrollbarMaxAlign,k=s.Fr(b),l=s.Er(a),m=s.getViewportTopRow(l),n=s.cCb,o=s.getViewportLeftColumn(k),p=s.eCb,1===k&&w(f)&&(g=s.gXc(b,d,i,j),b=g.col,f=g.offset),1===l&&w(e)&&(h=s.hXc(a,c,i,j),a=h.row,e=h.offset),q=!1,1!==l||a===m&&e===n||(a=O(a,s.ns()),s.lq=a,s.cCb=e,s.os(),q=!0),1!==k||b===o&&f===p||(b=O(b,s.ps()),s.qq=b,s.eCb=f,s.qs(),q=!0),q&&(r=s.parent,r&&!r.options.scrollbarShowMax&&(s.oq=!0,s.jq=!0),s.$p()))},a.prototype.Er=function(a){var b=this,c=1;return a<za(b)?c=0:a>=ta(b)-va(b)&&(c=2),c},a.prototype.Fr=function(a){var b=this,c=1;return a<ya(b)?c=0:a>=sa(b)-ua(b)&&(c=2),c},a.prototype.hXc=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.ss,t=r.Er(a),u=r.getViewportTopRow(t),v=r.cCb,w=za(r),x=r.ir();if(0===b)if(d){for(g=x,f=r.getViewportHeight(t);w<=g;g--)if(f-=s.Sl(g),f<0){a<=g?v=0:(a=g,v=f);break}}else v=0;else if(1===b){if(h=!1,i=!1,d){for(g=x,j=Q(r.getViewportHeight(t)/2),f=j;w<=g;g--)if(f-=s.Sl(g),f<0){a>=g&&(g--,f+=j,i=!0);break}if(i)for(;w<=g;g--)if(f-=s.Sl(g),f<0){a=g,v=f,h=!0;break}}if(!h){for(f=Q((r.getViewportHeight(t)-s.Sl(a))/2);w<a;a--)if(f-=s.Sl(a-1),f<0){a-=1,v=f;break}f>0&&a===w&&(v=0)}}else if(2===b){for(f=r.getViewportHeight(t)-s.Sl(a);w<a;a--)if(f-=s.Sl(a-1),f<0){a-=1,v=f;break}f>0&&a===w&&(v=0)}else if(3===b)if(a>u){if(k=r.am(),l=k.pt,m=k.qt,n=k.er,o=k.jr,p=r.getCellRect(a,r.Kl),q=new e.Rect(l,m,n,o),q.containsRect(p,!0))a=u;else for(f=r.getViewportHeight(t)-s.Sl(a);u<a;a--)if(f-=s.Sl(a-1),f<0){a-=1,v=f;break}}else v=0;return!c&&v<0&&(v=0,a<x&&(a+=1)),{row:a,offset:v}},a.prototype.gXc=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.ss,t=r.Fr(a),u=r.getViewportLeftColumn(t),v=r.eCb,w=ya(r),x=r.dr();if(0===b)if(d){for(f=r.getViewportWidth(t),g=x;w<=g;g--)if(f-=s._m(g),f<0){a<=g?v=0:(a=g,v=f);break}}else v=0;else if(1===b){if(h=!1,i=!1,d){for(j=Q(r.getViewportWidth(t)/2),f=j,g=x;w<=g;g--)if(f-=s._m(g),f<0){a>=g&&(g--,f+=j,i=!0);break}if(i)for(;w<=g;g--)if(f-=s._m(g),f<0){a=g,v=f,h=!0;break}}if(!h){for(f=Q((r.getViewportWidth(t)-s._m(a))/2);w<a;a--)if(f-=s._m(a-1),f<0){a-=1,v=f;break}f>0&&a===w&&(v=0)}}else if(2===b){for(f=r.getViewportWidth(t)-s._m(a);w<a;a--)if(f-=s._m(a-1),f<0){a-=1,v=f;break}f>0&&a===w&&(v=0)}else if(3===b)if(a>u){if(k=r.am(),l=k.pt,m=k.qt,n=k.er,o=k.jr,p=r.getCellRect(r.Jl,a),q=new e.Rect(l,m,n,o),q.containsRect(p,!0))a=u;else for(f=r.getViewportWidth(t)-s._m(a);u<a;a--)if(f-=s._m(a-1),f<0){a-=1,v=f;break}}else v=0;return!c&&v<0&&(v=0,a<x&&(a+=1)),{col:a,offset:v}},a.prototype.ms=function(a,b){var c=this,d=c.ss,e=c.Er(a),f=c.getViewportTopRow(e),g;if(0!==b)if(1===b)for(g=Q((c.getViewportHeight(e)-d.Sl(a))/2);0<a&&(g-=d.Sl(a-1),!(g<0));a--);else if(2===b)for(g=c.getViewportHeight(e)-d.Sl(a);0<a&&(g-=d.Sl(a-1),!(g<0));a--);else if(3===b&&!(a<f||f===-1))for(g=c.getViewportHeight(e)-d.Sl(a);f<a&&(g-=d.Sl(a-1),!(g<0));a--);return a},a.prototype.showColumn=function(a,b){this.showCell(this.lq,a,0,b)},a.prototype.showRow=function(a,b){this.showCell(a,this.qq,b,0)},a.prototype.suspendEvent=function(){this.jm++},a.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},a.prototype.isEventSuspended=function(){return this.jm>0},a.prototype.currentTheme=function(a){var b=this;return 0===arguments.length?(b.Pm||b.ts(),b.Pm):(typeof a===V&&(a=s.Themes[a]?s.Themes[a]:new s.Theme(a)),b.Pm=a,b.yl.us(),b.Jq(),b.$p(),b)},a.prototype.P3=function(){var a=e.Im.Lm(""),b=J(a.zIndex),c=s.Themes.Office2007;return b>2007&&(c=s.Themes.Office),c},a.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},a.prototype.reset=function(){var a=this;a.vs(),a.$p()},a.prototype.vs=function(){var b,c,d,f=this,g=f.DHb();f.Pp(),f.Nr=0,f.Pr=0,f.T3(),f._r=M,f.as={colHeader:M,viewport:M},f.bs={rowHeader:M,viewport:M,colHeader:M},f.lq=0,f.cCb=0,f.qq=0,f.eCb=0,f.frozenRowCount(0),f.frozenColumnCount(0),f.frozenTrailingRowCount(0),f.frozenTrailingColumnCount(0),a.ao(f,"beforeSetHost"),b=f.parent,b&&(c=b.getActiveSheet(),d=b.getActiveSheetTab(),(c&&f.name()===c.name()||d&&f.name()===d.name())&&f.ws(b.xs)),f.Cq=[{},{},{},{}],f.ss=new e.ln(f),f.Oq={},q&&f.resetCalc(),f.ITa=new i.lUa(f,a.Rp,a.Sp,a.Vp,a.Tp,f.name()),f.defaults=f.ITa.defaults,f.DHb(g),f.ts(),f.Lq={},f.oq=!0,f.jq=!0,f.parent&&f.parent.xD?f.Xq=f.parent.xD:f.Xq=0,f.parent&&f.parent.jm?f.jm=f.parent.jm:f.jm=0,f.gga=0,f.Js=!1,f.Ks=M,f.Wr=[],f.Zr=[],f.OIb=!1,f.M6c=n.ClipboardPasteOptions.all,f.N6c=n.CopyToOptions.all,f.L6c=!0,f.e7c=!0,a.ao(f,"init")},a.prototype.T3=function(){var a=this;B(ma,function(b,c){if(!w(c)){var d=c;"gridline"===b?d={color:e.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof d&&(d=j.GC$.extend({},c)),a.options[b]=d}})},a.prototype.Ls=function(b){var c,d=this;for(d.parent=b,c=d.Xq;c<b.xD;c++)d.suspendPaint();d.jm=b.jm,a.ao(d,"attach",b)},a.prototype.jJb=function(a,b){return a.row===b.row&&a.col===b.col&&a.rowCount===b.rowCount&&a.colCount===b.colCount},a.prototype.kJb=function(a,b,c,d,e){var f,g,h=this.Ms(b,c,d,e).ranges;for(f=0;f<h.length;f++)for(g=0;g<a.length;g++)if(this.jJb(a[f],h[g]))return!0;return!1},a.prototype.lJb=function(a,b,c,d,e){var f,g=!1;return void 0!==e?0===e?(f=this.Ms(a,b,c,this.getColumnCount()-b).ranges,f.length>0&&(a-1>0&&(g=this.kJb(f,a-1,b,1,this.getColumnCount()-b)),g||(g=this.kJb(f,a+c,b,1,this.getColumnCount()-b)),g||(g=this.kJb(f,a,b,c,1)))):(f=this.Ms(a,b,this.getRowCount()-a,d).ranges,f.length>0&&(a-1>0&&(g=this.kJb(f,a-1,b,this.getRowCount()-a,1)),g||(g=this.kJb(f,a+c,b,this.getRowCount()-a,1)),g||(g=this.kJb(f,a,b,1,d)))):g=!0,g},a.prototype.Y3=function(a,b,c,d,f,g,h,i,j){var k,l=this;return!h&&l.options.isProtected&&l.ou(e.kf(a,b,c,d),j)?(f&&l.Os(1,f),!1):(k=this.lJb(a,b,c,d,i),!(q&&k&&!l.Vq(a,b,c,d))||(g&&l.Os(1,g),!1))},a.prototype.clear=function(a,b,c,d,e,f,g,h,i){0!==e&&this.cg(a,b,c,d,e,f,g,h,i)},a.prototype.cg=function(b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,r,s,t,u,v,x,y,z,A,B=this,C=q;try{if(C&&B.suspendCalcService(),B.suspendPaint(),k=B.defaults,l=void 0,m=void 0,n=void 0,o=void 0,p=3,r={changeType:"clear",row:b,col:c,rowCount:d,colCount:e,sheetArea:f,type:g,ignoreTable:i,ignorePivotTable:j,canClear:!0},a.ao(B,$,r),!r.canClear)return;if(w(f)||f===p){if(C&&!B.Vq(b,c,d,e))return!1;if(1&g&&B.getDataSource&&B.getDataSource()){for(B.suspendEvent(),l=b;l<b+d;l++)if(!(h&&B.Ps&&B.Ps(l)))for(m=c;m<c+e;m++)B.setValue(l,m,M,f);B.resumeEvent()}}for(s=B.ITa,t=C&&B.Bj(),l=b===-1?0:b,u=b===-1?s.getRowCount(f):d,m=c===-1?0:c,v=c===-1?s.getColumnCount(f):e,x=[],y=l;y<u+l;y++)h&&B.Ps&&B.Ps(y)&&x.push(y);if(s.do("clear",l,m,u,v,g,x,f),t&&1&g&&(t.Sg(l,m,u,v),t.clear(l,m,u,v,s.dUa())),8&g&&!(b>=0&&c>=0))if(c>=0)for(o=0;o<v;o++)B.setTag(-1,m+o,M,f);else if(b>=0)for(n=0;n<u;n++)h&&B.Ps&&B.Ps(l+n)||B.setTag(l+n,-1,M,f);else B.setTag(-1,-1,M,f);if(256&g&&!(b>=0&&c>=0))if(c>=0)for(o=0;o<v;o++)B.setHyperlink(-1,m+o,M,f);else if(b>=0)for(n=0;n<u;n++)h&&B.Ps&&B.Ps(l+n)||B.setHyperlink(-1,-1,M);if(2&g&&!(b>=0&&c>=0))if(c>=0)for(o=0;o<v;o++)B.setStyle(-1,m+o,M,f);else if(b>=0)for(n=0;n<u;n++)h&&B.Ps&&B.Ps(l+n)||B.setStyle(l+n,-1,M,f);else B.setStyle(-1,-1,M,f);if(32&g){if(b<0)for(o=0;o<v;o++)B.setColumnVisible(m+o,!0,f),B.setColumnResizable(m+o,!0,f),B.setColumnWidth(m+o,2===f?k.rowHeaderColWidth:k.colWidth,f);if(c<0)for(n=0;n<u;n++)h&&B.Ps&&B.Ps(l+n)||(B.setRowVisible(l+n,!0,f),B.setRowResizable(l+n,!0,f),B.setRowHeight(l+n,1===f?k.colHeaderRowHeight:k.rowHeight,f))}for((w(f)||f===p)&&C&&1===(1&g)&&(z=B.Bj(),z&&z.Ag(b,c,d,e)),A=[],n=0;n<u;n++)for(o=0;o<v;o++)A.push({row:l+n,col:m+o});B.Bu(b,c,u,v,A,2,f)}finally{B.resumePaint(),C&&B.resumeCalcService(!1)}},a.prototype._p=function(){var a,b,c,d,e=this,f=e.options,g=f.protectionOptions;f.isProtected&&g&&(a=g.allowSelectLockedCells,b=g.allowSelectUnlockedCells,(a===!1&&b!==!1||a!==!1&&b===!1)&&(c=e.Jl,d=e.Kl,e.Qs(c,d)||(e.Tr(),e.Rs(c,d,!0),e.Ss(4,c,d))))},a.prototype.setArray=function(a,b,c,d){var e,f,g,h,i=this,k=q;if(d=k&&d,e=ta(i),f=sa(i),c&&0<=a&&a<e&&0<=b&&b<f){k&&i.suspendCalcService(),i.suspendPaint();try{B(c,function(c,k){j.GC$.isArray(k)?B(k,function(j,k){g=a+c,h=b+j,g<e&&h<f&&(d?i.setFormula(g,h,k):i.setValue(g,h,k,3,!0))}):(g=a+c,h=b,g<e&&h<f&&(d?i.setFormula(g,h,k):i.setValue(g,h,k,3,!0)))})}finally{k&&i.resumeCalcService(),i.resumePaint()}}},a.prototype.getArray=function(a,b,c,d,e){var f,g,h=this,i=[],j=ta(h),k=sa(h);if(e=e&&q,0<=a&&a<j&&0<=b&&b<k)for(a+c>j&&(c=j-a),b+d>k&&(d=k-b),f=0;f<c;f++)for(i[f]=[],g=0;g<d;g++)e?i[f][g]=h.getFormula(a+f,b+g):i[f][g]=h.getValue(a+f,b+g);return i},a.prototype.setTag=function(a,b,c,d){var e,f,g,h,i,j;if(w(d)&&(d=3),e=this,0!==d){if(f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<-1||a>=g||b<-1||b>=h)return;c=E(c),i=void 0,j=e.jm>0,j||(i=e.getTag(a,b,d)),f.do("setValueForKey",a,b,Z,c,d),i!==c&&(a!==-1&&b!==-1?j?e.WXc(e,[{row:a,col:b}],0):e.Bq(Z,a,b,d,i,c):a!==-1&&b===-1?e.kq(a,d,Z,c,i):a===-1&&b!==-1&&e.pq(b,d,Z,c,i))}},a.prototype.getTag=function(a,b,c){var d,e=this;return w(c)&&(c=3),0!==c?(d=e.ITa.getValueForKey(a,b,Z,c),F(d)):M},a.prototype.tag=function(a){var b,c=this;return 0===arguments.length?(b=c.ITa.getValueForKey(-1,-1,Z,3),F(b)):(c.ITa.do("setValueForKey",-1,-1,Z,E(a),3),c)},a.prototype.getParent=function(){return this.parent},a.prototype.getDirtyRows=function(){return pa(this,!0)},a.prototype.getInsertRows=function(){return pa(this,!1)},a.prototype.getDeletedRows=function(){var a=[],b=this.Ts;return b&&B(b,function(b,c){c&&!j.GC$.isFunction(c)&&a.push({row:c.row,originalItem:c.data})}),a},a.prototype.hasPendingChanges=function(){var a,b=this,c=b.Ts;return!!(c&&c.length>0)||(a=b.ITa.hUa(),!C(a))},a.prototype.clearPendingChanges=function(b){var c,d,e,f,g,h=this;return w(b)||C(b)?(h.ITa.iUa(),h.Ts=[],void a.ao(h,"clearPendingChanges")):(c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=b.clearType,g=g||ka.dirty,(1&g)===ka.dirty&&h.Rec(c,d,e,f),(2&g)===ka.insert&&h.Sec(c,d,e,f),void((4&g)===ka.delete&&h.Tec(c,d,e,f)))},a.prototype.Rec=function(b,c,d,e){var f=this,g=f.ITa,h=f.Uec(b,c,d,e),i=f.Vec(c,e);h?(g.Qec(),a.ao(f,"clearPendingChanges")):g.Mec(i,b,c,d,e)},a.prototype.Sec=function(a,b,c,d){var e=this,f=e.ITa,g=e.Uec(a,b,c,d),h=e.Vec(b,d);f.Lec(g,h,a,c)},a.prototype.Tec=function(a,b,c,d){var e,f,g,h,i=this;if(i.Uec(a,b,c,d))return void(i.Ts=[]);if(i.Vec(b,d)&&(e=i.Ts))for(f=[],B(e,function(b,d){if(d){var e=d.row;a<=e&&e<a+c&&f.push(b)}}),g=f.length,h=g-1;h>=0;h--)i.Ts.splice(f[h],1)},a.prototype.Vec=function(a,b){return w(a)||a===-1||0===a&&this.getColumnCount()===b},a.prototype.Wec=function(a,b){return w(a)||a===-1||0===a&&b===this.getRowCount()},a.prototype.Uec=function(a,b,c,d){return this.Vec(a,c)&&this.Vec(b,d)},a.prototype.getDirtyCells=function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(w(a)&&(a=-1),w(b)&&(b=-1),(w(c)||c<=0)&&(c=1),(w(d)||d<=0)&&(d=1),e=[],f=l.ITa.hUa(),!C(f)){if(g=[],a>=0)for(h=a;h<a+c;h++)g.push(h);else for(i in f)D(f,i)&&g.push(J(i));B(g,function(a,c){var g,h;if(j=f[c],j&&"e"===j.rs)if(b>=0)for(g=b;g<b+d;g++)k=j[g],k&&e.push(Ca(l,c,g,k.oldValue));else for(h in j)L(h)||(k=j[h],k&&e.push(Ca(l,c,J(h),k.oldValue)))})}return e},a.prototype.suspendDirty=function(){this.gga++,this.ITa.jUa()},a.prototype.resumeDirty=function(){var a=this;a.gga--,a.gga<0&&(a.gga=0),a.ITa.kUa()},a.prototype.isDirtySuspended=function(){return this.gga>0},a.prototype.ad=function(a){this.Us(new e.Rect(0,0,0,0)),this.vs(),this.cq(a)},a.prototype.iZc=function(){return this},a.prototype.Vs=function(){var a,b=this,c=b.Ws(),d={top:0,left:0};return c&&c.parentElement&&(d=j.GC$(c).offset(),d&&(d.top+=I.body.clientTop||0,d.left+=I.body.clientLeft||0)),a=c&&c.canvasOffset,a&&(d=a),d},a.prototype.ws=function(b){var c,d,f,g,h;b&&(c=this,c.Js=!1,d=c.Xs,d&&c.no(!1),f=x("canvas"),g=c.parent&&c.parent.options.enableAccessibility,h=g?"":ja().NeedCanvasSupport,j.GC$(f).attr("id",b.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(h).appendTo(b),e.En.Kn(f,M,c),c.Xs=f,c.fq(),c.repaint(),c.parent&&c.parent.Ys(),a.ao(c,"setHost",j.GC$(f)))},a.prototype.Jgc=function(a,b,c,d,e,f,g,h,i){var j,k,l=this;for(j=c;j<d;j++)k=l.getText(b,j,i),a.push('"'+k+'"');for(j=e;j<f;j++)k=l.getText(b,j,i),a.push('"'+k+'"');for(j=g;j<h;j++)k=l.getText(b,j,i),a.push('"'+k+'"')},a.prototype.Kgc=function(){var a,b,c,d,e,f=this,g=f.getViewportTopRow(1),h=f.getViewportBottomRow(1),i=f.getViewportLeftColumn(1),j=f.getViewportRightColumn(1),k=h-g+1,l=j-i+1,m=f.getRowCount(n.SheetArea.colHeader),o=f.getColumnCount(n.SheetArea.rowHeader),p=f.frozenColumnCount(),q=ua(f),r=f.getColumnCount(),s=f.frozenRowCount(),t=va(f),u=f.getRowCount(),v=[];
for(a=0;a<m;a++)b=[],f.Jgc(b,a,0,p,i,i+l,r-q,r,n.SheetArea.colHeader),v.push(b.join(","));for(a=0;a<s;a++){for(c=[],d=0;d<o;d++)e=f.getText(a,d,n.SheetArea.rowHeader),c.push('"'+e+'"');f.Jgc(c,a,0,p,i,i+l,r-q,r),v.push(c.join(","))}for(a=g;a<g+k;a++){for(c=[],d=0;d<o;d++)e=f.getText(a,d,n.SheetArea.rowHeader),c.push('"'+e+'"');f.Jgc(c,a,0,p,i,i+l,r-q,r),v.push(c.join(","))}for(a=u-t;a<u;a++){for(c=[],d=0;d<o;d++)e=f.getText(a,d,n.SheetArea.rowHeader),c.push('"'+e+'"');f.Jgc(c,a,0,p,i,i+l,r-q,r),v.push(c.join(","))}return v.join(";")},a.prototype.cgc=function(a){var b,c,d,f,g,h,i,j,k=this;return e.util.sl()?k.Kgc():(b=k.Jl,c=k.Kl,d=n.SheetArea.viewport,!a||w(a.row)||w(a.col)||(b=a.row,c=a.col,d=a.hitTestType),f=ja(),g="",h=k.getText(b,c,d),d===n.SheetArea.rowHeader?g=f.ARIA_RowHeader+" ":d===n.SheetArea.colHeader?g=f.ARIA_ColumnHeader+" ":(w(d)||d===n.SheetArea.viewport)&&(i=k.getFormula(b,c),j=k.comments&&k.comments.get(b,c)),g+k.fYc(b,c,h,i,j&&j.text()))},a.prototype.fYc=function(a,b,c,d,f){var g=ja(),h=g.ARIA_Cell+" "+e.util.xq(b+1)+(a+1)+" ";return w(c)||""===c||(h+=H.Kb(g.ARIA_HasValue,[c])+", "),w(d)||(h+=H.Kb(g.ARIA_HasFormula,[d])+", "),w(f)||(h+=H.Kb(g.ARIA_HasComment,[f])),h},a.prototype.fq=function(){var a,b,c,d,f,g,h,i,k=this,l=k.Ws();l&&l.parentNode&&(a=getComputedStyle(l.parentNode),b=a.width,c=a.height,d=b.indexOf("px"),d>0&&(b=b.substring(0,d)),d=c.indexOf("px"),d>0&&(c=c.substring(0,d)),f=J(b),g=J(c),L(f)&&(f=j.GC$(l.parentNode).width()),L(g)&&(g=j.GC$(l.parentNode).height()),0!==f&&0!==g&&(h=P(f,0),i=P(g,0),l.style.display="none",l.style.display="",l.width=h,l.height=i,l.style.width=h+"px",l.style.height=i+"px",h=l.clientWidth||l.width,i=l.clientHeight||l.height,k.Zs.width=h,k.Zs.height=i,e.En.Pn(l,h,i),k.invalidateLayout()))},a.prototype.destroy=function(){this.no(!0)},a.prototype.no=function(b,c){var d,f,g,h=this;h.Js!==!0&&(e.En.Sn(h),h.isEditing&&h.isEditing()&&h.Yoa(),a.ao(h,"dispose",{clearCache:b,isSheetDestroy:!0,hasActiveSheet:c}),d=h.Xs,d&&(f=d.parentNode,f&&f.removeChild(d),h.Xs=M),h.$s(),h.ITa&&h.ITa.no(b),b!==!1&&(h.Js=!0,g=h.at,g&&g.no(),h.parent=M,h.ITa=M,h.ss&&(h.ss.no(),h.ss=M),h.bt&&(h.bt.no(),h.bt=M),e.Vl.Wl(h)&&e.Vl.Zl(M,!0),h.uu&&(h.uu.hZ(),h.uu=M),h.Wr=M,h.Zr=M))},a.prototype.$s=function(){var a=this.dt;a&&(j.GC$(a).remove(),this.dt=N)},a.prototype.vq=function(a,b,c,d,e){var f,g,h,i,j;return w(d)&&(d=3),3===d&&this.jIb&&(f=a.getDynamicArrayInfo(b,c),f&&f.isValid&&(b!==f.row||c!==f.col))?M:(g=this.et,!this.loading&&g&&(h=g.getCalcService(),h.calcOnDemand&&3===d&&!h.IsSuspended()&&(i=g.qg(b,c),i&&i.$l===!0&&(i.$l=!1,delete i.dh,delete i.eh,g.recalculateCell(b,c),this.yj().ZIc()))),j=a.getValue(b,c,d,this.loading,e),j=F(j))},a.prototype.Tq=function(a,b){var c,d,f,g,h,i;return w(b)&&(b=3),c=e.kf(-1,-1,-1,-1),a&&(d=this,f=a.row,g=a.col,h=a.rowCount,i=a.colCount,g===-1&&(g=0,i=d.getColumnCount(b)),f===-1&&(f=0,h=d.getRowCount(b)),c.col=g,c.row=f,c.colCount=i,c.rowCount=h),c},a.prototype.getRangeRect=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=new e.Rect((-1),(-1),(-1),(-1)),v=this,w=v.am();if(0===w.width||0===w.height)return u;if(d=v.it(b),f=v.jt(a),!d||0===d.length||!f||0===f.length)return u;g=v.Tq(c),h=v.ss,i=g.row,j=g.row+g.rowCount-1,k=g.col,l=g.col+g.colCount-1,m=za(v),n=ta(v)-va(v)-1,o=ya(v),p=sa(v)-ua(v)-1,q=d[0].col,r=d[d.length-1].col,s=f[0].row,t=f[f.length-1].row;function x(a,b){for(;a>b;)if(a--,v.getColumnVisible(a))return a;return a}function y(a,b){for(;a<b;)if(a++,v.getColumnVisible(a))return a;return a}function z(a,b){for(;a>b;)if(a--,v.getRowVisible(a))return a;return a}function A(a,b){for(;a<b;)if(a++,v.getRowVisible(a))return a;return a}return k<q&&(k=x(q,k)),l>r&&(l=y(r,l)),i<s&&(i=z(s,i)),j>t&&(j=A(t,j)),l<k||j<i?u:(0===b?k<o&&(u.x=w.kt+qa(h,0,k-1),u.width=qa(h,k,l)):1===b?k<=p&&l>=o&&(k<q?u.x=d[0].x-qa(h,k,q-1):u.x=d[0].x+qa(h,q,k-1),u.width=qa(h,k,l)):2===b&&l>p&&(k<q?u.x=w.lt-qa(h,k,q-1):u.x=w.lt+qa(h,q,k-1),u.width=qa(h,k,l)),0===a?i<m&&(u.y=w.nt+ra(h,0,i-1),u.height=ra(h,i,j)):1===a?i<=n&&j>=m&&(i<s?u.y=f[0].y-ra(h,i,s-1):u.y=f[0].y+ra(h,s,i-1),u.height=ra(h,i,j)):2===a&&j>n&&(i<s?u.y=w.ot-ra(h,i,s-1):u.y=w.ot+ra(h,s,i-1),u.height=ra(h,i,j)),u)},a.prototype.isintersectWithArrayFormula=function(a){var b,c,d=this.Bj();if(d)for(b=a.row;b<a.row+a.rowCount;b++)for(c=a.col;c<a.col+a.colCount;c++)if(d.dg(b,c,1,1))return!0;return!1},a.prototype.cm=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q=this,r=new e.Rect((-1),(-1),(-1),(-1)),s=q.am();if(0===s.width||0===s.height)return r;if(b=q.Tq(a),c=ya(q),d=za(q),f=ua(q),g=va(q),h=q.ss,i=b.row,j=b.row+b.rowCount-1,k=b.col,l=b.col+b.colCount-1,m=ta(q),n=sa(q),k<c)r.x=s.kt+qa(h,0,k-1),r.width=qa(h,k,O(l,c-1)),c<=l&&l<n-f?(o=q.it(1),o&&o.length>0&&(r.width+=qa(h,o[0].col,O(l,o[o.length-1].col))+q.eCb)):l>=n-f&&(o=q.it(2),o&&o.length>0&&(r.width=o[0].x-r.x,r.width+=qa(h,n-f,O(l,n-1))));else if(k<n-f){if(o=q.it(1),!o||0===o.length||k>o[o.length-1].col||l<o[0].col)return r;r.x=s.pt+qa(h,o[0].col,k-1)+q.eCb,c<=l&&l<n-f?r.width=qa(h,P(k,o[0].col),O(l,o[o.length-1].col)):l>=n-f&&(o=q.it(2),o&&o.length>0&&(r.width=o[0].x-r.x,r.width+=qa(h,n-f,O(l,n-1))))}else k<n&&(o=q.it(2),o&&o.length>0&&(r.x=s.lt+qa(h,o[0].col,k-1),r.width=qa(h,k,O(l,n-1))));if(i<d)r.y=s.nt+ra(h,0,i-1),r.height=ra(h,i,O(j,d-1)),d<=j&&j<m-g?(p=q.jt(1),p&&p.length>0&&(r.height+=ra(h,p[0].row,O(j,p[p.length-1].row))+q.cCb)):j>=m-g&&(p=q.jt(2),p&&p.length>0&&(r.height=p[0].y-r.y,r.height+=ra(h,m-g,O(j,m-1))));else if(i<m-g){if(p=q.jt(1),!p||0===p.length||i>p[p.length-1].row||j<p[0].row)return r;r.y=s.qt+ra(h,p[0].row,i-1)+q.cCb,d<=j&&j<m-g?r.height=ra(h,P(i,p[0].row),O(j,p[p.length-1].row)):j>=m-g&&(p=q.jt(2),p&&p.length>0&&(r.height=p[0].y-r.y,r.height+=ra(h,m-g,O(j,m-1))))}else i<m&&(p=q.jt(2),p&&p.length>0&&(r.y=s.ot+ra(h,p[0].row,i-1),r.height+=ra(h,i,O(j,m-1))));return r},a.prototype.Ws=function(){return this.Xs},a.prototype.rt=function(a,b){return this.dp(a,b)+1},a.prototype.dp=function(a,b){var c="",d=this.yl;return c=b?b:d.Cl(d.Bl()),e.Vn.Xn(a,c)},a.prototype.or=function(a){var b=this,c=b.am(),d=M,e=c.pt,f=b.rKc(c),g=c.lt,h=c.js;return c.zr<a&&a<c.zr+c.Br?d=-1:c.kt<a&&a<c.kt+c.hs?d=0:e<a&&a<e+f?d=1:g<a&&a<g+h&&(d=2),d},a.prototype.nr=function(a){var b=this,c=b.am(),d=M,e=c.qt,f=b.oKc(c),g=c.ot,h=c.gs;return c.Ar<a&&a<c.Ar+c.Cr?d=-1:c.nt<a&&a<c.nt+c.fs?d=0:e<a&&a<e+f?d=1:g<a&&a<g+h&&(d=2),d},a.prototype.pr=function(a,b){var c,d;if(c=b===-1?this.ut():this.jt(b),c&&(d=c.findY(a)))return d.row},a.prototype.qr=function(a,b,c,d,e){var f,g,h;if(f=b===-1?this.vt():d===-1?this.jZc(b):this.it(b)){if(h=void 0,d!==-1||w(e)?h=f.findX(a):(g=this.ut().findRow(e),h=f.findXByExactY(a,c,g)),h)return h.col;if(f[0]&&(f=this.yl.XYc(f[0].col,f[0].x),f&&(h=d!==-1||w(e)?f.findX(a):f.findXByExactY(a,c,g)),h))return h.col}},a.prototype.IYc=function(a,b){var c,d,e,f,g,h,i,j=a.hZc;return j!==a.col||(c=this,f=a.colViewportIndex,g=a.y,h=a.row,e=this.jZc(f),d=this.ut().findRow(h),b===j&&(j=c.Zq(j,1)),i=e.findCol(j),i&&g<i.y*d.height+d.y)},a.prototype.wt=function(a,b){var c=this;return c.Jl<=a&&a<c.Jl+c.Lr&&c.Kl<=b&&b<c.Kl+c.Mr},a.prototype.sp=function(a){return this.ITa.sp(a)},a.prototype.tp=function(a){return this.ITa.tp(a)},a.prototype.vp=function(a,b,c,d){var e=this,f=ta(e),g=sa(e);return this.ITa.vp(a,b,c,f,g,d)},a.prototype.wp=function(a,b,c){var d=this,e=ta(d),f=sa(d);return this.ITa.wp(a,b,c,e,f)},a.prototype.xt=function(a,b,c){var d,e,f,g,h,i,j=this,k=j.yt;if(k&&!k.resizeInfo&&!w(c)){if(g=k.hitTestType,h=k.row,i=k.col,1===c)return d=!1,e=j.ITa.findSpan(h,i,1),e&&(d=e.contains(a,b,1,1)),f=a===h&&b===i||d,g===c&&f;if(2===c)return d=!1,e=j.ITa.findSpan(h,i,2),e&&(d=e.contains(a,b,1,1)),f=a===h&&b===i||d,g===c&&f;if(3===c)return g===c&&a===h&&b===i;if(0===c)return g===c}return!1},a.prototype.sr=function(a,b){return a>=0&&a<=2&&b>=0?3:a>=0&&a<=2&&b<0?2:a<0&&b>=0?1:a<0&&b<0?0:M},a.prototype.zt=function(a){var b=this.mm;b&&b.zt(a)},a.prototype.zo=function(){var a,b=this,c=b.parent,d=c&&c.qo;return d||(a=b.Xs,d=a&&a.parentElement),d},a.prototype.Pp=function(){var a=this,b=0,c=0,d=1,e=1;a.Jl=b,a.Kl=c,a.Lr=d,a.Mr=e,a.Qr=b,a.Rr=c},a.prototype.Sl=function(a,b,c){var d=this,e=d.getRowHeight(a,b),f=d.zoom();return 1!==f&&(e*=f),c?e:R(e)},a.prototype.Tl=function(a,b,c){var d=this,e=d.getColumnWidth(a,b),f=d.zoom();return 1!==f&&(e*=f),c?e:R(e)},a.prototype.At=function(){var a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.Dr(),t=r.options,u=t.sheetAreaOffset.left,v=t.sheetAreaOffset.top,w=new e.Rect(s.x+u,s.y+v,P(0,s.width-u),P(0,s.height-v)),x=w.width,y=w.height,z=wa(r),A=xa(r),B={x:w.x,y:w.y,width:w.width,height:w.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,$Lc:0,_Lc:0,pKc:0,sKc:0,zr:0,Ar:0,em:function(){var a=this;return new e.Rect(a.x,a.y,a.Br,a.Cr)},gm:function(a){var b=this;return 0===a?new e.Rect(b.kt,b.y,b.hs,b.Cr):1===a?new e.Rect(b.pt,b.y,r.rKc(b),b.Cr):2===a?new e.Rect(b.lt,b.y,b.js,b.Cr):M},fm:function(a){var b=this;return 0===a?new e.Rect(b.x,b.nt,b.Br,b.fs):1===a?new e.Rect(b.x,b.qt,b.Br,r.oKc(b)):2===a?new e.Rect(b.x,b.ot,b.Br,b.gs):M},Ft:function(a,b){var c=this;if(0===a){if(0===b)return new e.Rect(c.kt,c.nt,c.hs,c.fs);if(1===b)return new e.Rect(c.pt,c.nt,r.rKc(c),c.fs);if(2===b)return new e.Rect(c.lt,c.nt,c.js,c.fs)}else if(1===a){if(0===b)return new e.Rect(c.kt,c.qt,c.hs,r.oKc(c));if(1===b)return new e.Rect(c.pt,c.qt,r.rKc(c),r.oKc(c));if(2===b)return new e.Rect(c.lt,c.qt,c.js,r.oKc(c))}else if(2===a){if(0===b)return new e.Rect(c.kt,c.ot,c.hs,c.gs);if(1===b)return new e.Rect(c.pt,c.ot,r.rKc(c),c.gs);if(2===b)return new e.Rect(c.lt,c.ot,c.js,c.gs)}return M}};if(r.Gt&&(a=r.Gt(),b=0,a.width>0&&(B.x+=a.width+b,x-=a.width+b),a.height>0&&(B.y+=a.height+b,y-=a.height+b)),t.rowHeaderVisible)for(g=r.getColumnCount(2),f=0;f<g;f++)B.Br+=r.Tl(f,2);if(t.colHeaderVisible)for(d=r.getRowCount(1),c=0;c<d;c++)B.Cr+=r.Sl(c,1);if(h=ya(r),h>0)for(g=sa(r),f=0;f<h&&f<g;f++)r.getColumnVisible(f)&&(B.hs+=r.Tl(f));if(i=za(r),i>0)for(d=ta(r),c=0;c<i&&c<d;c++)r.getRowVisible(c)&&(B.fs+=r.Sl(c));if(j=ua(r),j>0)for(g=sa(r),f=P(h,g-j);f<g;f++)B.js+=r.Tl(f);if(k=va(r),k>0)for(d=ta(r),c=P(i,d-k);c<d;c++)B.gs+=r.Sl(c);if(B.zr=B.x,B.Ar=B.y,B.kt=B.zr+B.Br,B.nt=B.Ar+B.Cr,B.pt=B.kt+B.hs,B.qt=B.nt+B.fs,x-=B.Br,y-=B.Cr,x-=B.hs,y-=B.fs,x-=B.js,y-=B.gs,x-=B.sKc,y-=B.pKc,y-=B.Bt,d=ta(r),g=sa(r),l=0,m=g-j,m>0)for(l+=r.eCb,f=P(h,r.qq);f<m&&l<x;f++)l+=r.Tl(f);if(n=P(0,x),l<n?(B.sKc=n-l,B.er=l,n=l):B.er=n,o=0,p=d-k,p>0)for(o+=r.cCb,c=P(i,r.lq);c<p&&o<y;c++)o+=r.Sl(c);return q=P(0,y),o<q?(B.pKc=q-o,B.jr=o,q=o):B.jr=q,B.lt=B.pt+n,B.ot=B.qt+q,A?(B.$Lc=B.pt+B.er,B.lt+=B.sKc):B.$Lc=B.lt+B.js,z?(B._Lc=B.qt+B.jr,B.ot+=B.pKc):B._Lc=B.ot+B.gs,B.Dt=B.zr,B.Et=B.y+B.height-B.Bt,B},a.prototype.am=function(){var a=this;return a._r||(a._r=a.At()),a._r},a.prototype.Hr=function(a,b){return w(b)||3===b?this.it(a):2===b?this.vt():1===b?this.jZc(a):M},a.prototype.vt=function(){var a=this;return a.bs.rowHeader||(a.bs.rowHeader=a.Ht()),a.bs.rowHeader},a.prototype.it=function(a){var b=this;return b.bs.viewport||(b.bs.viewport={}),b.bs.viewport[a]||(b.bs.viewport[a]=b.It(a)),b.bs.viewport[a]},a.prototype.jZc=function(a){var b=this;return b.bs.colHeader||(b.bs.colHeader={}),b.bs.colHeader[a]||(b.bs.colHeader[a]=b.kZc(a)),b.bs.colHeader[a]},a.prototype.Ht=function(){var a,b,c=new i.yp,d=this.am(),e=d.zr,f=this.getColumnCount(2);for(b=0;b<f;b++)a=this.Tl(b,2),c.push(new i.zp((-1),b,e,(-1),a,(-1))),e+=a;return c},a.prototype.It=function(a){var b,c,d,e,f,g,h,j=this,k=new i.yp,l=j.am(),m=sa(j),n=j.ss,o=ya(j),p=ua(j);if(0===a)for(c=l.kt,m=O(o,m),b=0;b<m;b++)d=n._m(b),k.push(new i.zp((-1),b,c,(-1),d,(-1))),c+=d;else if(1===a)for(e=xa(j),f=j.eCb,c=l.pt+f,m=e?m-p:m+p,g=j.rKc(l)-f,h=P(o,j.qq),b=h;g>0&&b<m;b++)d=n._m(b),k.push(new i.zp((-1),b,c,(-1),d,(-1))),c+=d,g-=d;else if(2===a)for(c=l.lt,b=P(o,m-p);b<m;b++)d=n._m(b),k.push(new i.zp((-1),b,c,(-1),d,(-1))),c+=d;return k},a.prototype.kZc=function(a){var b,c,d,e,f,g,h,j,k,l,m,o,p=this,q=new i.yp,r=p.am(),s=sa(p),t=p.ss,u=ya(p),v=ua(p),x=p.ITa,y=[],z=[],A=[];if(0===a)for(c=r.kt,s=O(u,s),b=0;b<s;b++)y[b]=d=t._m(b),z[b]=x.getColumnHeaderFitMode(!1,n.SheetArea.colHeader,b),A[b]=x.MTa(-1,b,-1,1,n.SheetArea.colHeader),e=p.ZYc(b,c,s,0,y,z,A),q.push(e),c+=d;else if(1===a){for(f=xa(p),g=p.eCb,c=r.pt+g,s=f?s-v:s+v,h=p.rKc(r)-g,j=P(u,p.qq),k=j,l=void 0,m=j-1;m>=0;m--)if(y[m]=l=t._m(m),l){if(z[m]=x.getColumnHeaderFitMode(!1,n.SheetArea.colHeader,m),z[m]!==n.ColumnHeaderFitMode.stack)break;k=m}for(b=k;h>0&&b<s;b++)y[b]||(y[b]=t._m(b)),w(z[b])&&(z[b]=x.getColumnHeaderFitMode(!1,n.SheetArea.colHeader,b)),d=y[b],A[b]=x.MTa(-1,b,-1,1,n.SheetArea.colHeader),e=p.ZYc(b,c,s,j,y,z,A),b>=j&&(q.push(e),c+=d,h-=d);h<=0&&b<s&&2===x.getColumnHeaderFitMode(!1,n.SheetArea.colHeader,b-1)&&(o=p.ZYc(b,c,s,j,y,z,A),q.push(o))}else if(2===a)for(c=r.lt,j=P(u,s-v),b=j;b<s;b++)y[b]=d=t._m(b),z[b]=x.getColumnHeaderFitMode(!1,n.SheetArea.colHeader,b),A[b]=x.MTa(-1,b,-1,1,n.SheetArea.colHeader),e=p.ZYc(b,c,s,j,y,z,A),q.push(e),c+=d;return q},a.prototype.ZYc=function(a,b,c,d,e,f,g){var h,j,k=this,l=k.ITa,m=k.ss,o=-1,p=-1,q=f[a],r=e[a],s=g[a];if(q===n.ColumnHeaderFitMode.stack&&!l.OYc(a)&&!s&&!l.MTa(-1,a+1,-1,1,n.SheetArea.colHeader))for(h=a+1,r+=m._m(h);(l.getColumnHeaderFitMode(!1,n.SheetArea.colHeader,h)===n.ColumnHeaderFitMode.stack||!m._m(h))&&h<c-1&&!l.MTa(-1,h+1,-1,1,n.SheetArea.colHeader);)h++,r+=m._m(h);for(h=a-1;h>=d&&!e[h]&&!g[h];)h--;return j=f[h],j!==n.ColumnHeaderFitMode.stack||!e[h]||g[h]||g[a]?(p=-1,o=-1):(o=l.QYc(a)/l.NYc(a),p=1-o),new i.zp((-1),a,b,o,r,p)},a.prototype.Gr=function(a,b){return w(b)||3===b||2===b?this.jt(a):1===b?this.ut():M},a.prototype.Jt=function(a){var b,c,d=new i.yp;for(b=0;b<3;b++)c=this.Gr(b,a),c&&c.length>0&&(d=j.GC$.merge(d,c));return d},a.prototype.Kt=function(a){var b,c,d=new i.yp;for(b=0;b<3;b++)c=this.Hr(b,a),c&&c.length>0&&(d=j.GC$.merge(d,c));return d},a.prototype.ut=function(){var a=this;return a.as.colHeader||(a.as.colHeader=a.Lt()),a.as.colHeader},a.prototype.jt=function(a){var b=this;return b.as.viewport||(b.as.viewport={}),b.as.viewport[a]||(b.as.viewport[a]=b.Mt(a)),b.as.viewport[a]},a.prototype.Lt=function(){var a,b,c=new i.yp,d=this.am(),e=d.Ar,f=this.getRowCount(1);for(b=0;b<f;b++)a=this.Sl(b,1),c.push(new i.zp(b,(-1),(-1),e,(-1),a)),e+=a;return c},a.prototype.Mt=function(a){var b,c,d,e,f,g,h,j=this,k=new i.yp,l=za(j),m=va(j),n=j.am(),o=ta(j),p=j.ss;if(0===a)for(c=n.nt,o=O(l,o),b=0;b<o;b++)d=p.Sl(b),k.push(new i.zp(b,(-1),(-1),c,(-1),d)),c+=d;else if(1===a)for(e=wa(j),f=j.cCb,c=n.qt+f,o=e?o-m:o+m,g=j.oKc(n)-f,h=P(l,j.lq),b=h;g>0&&b<o;b++)d=p.Sl(b),k.push(new i.zp(b,(-1),(-1),c,(-1),d)),c+=d,g-=d;else if(2===a)for(c=n.ot,b=P(l,o-m);b<o;b++)d=p.Sl(b),k.push(new i.zp(b,(-1),(-1),c,(-1),d)),c+=d;return k},a.prototype.Ir=function(a,b,c,d){var f,g,h,j,k,l,m=this,n=m.getRowCount(c),o=m.getColumnCount(c),p=m.Gr(a,c),q=m.Hr(b,c),r=new i.yp;return p&&p.length>0&&q&&q.length>0&&(f=p[0].row,g=q[0].col,h=p[p.length-1].row,j=q[q.length-1].col,k=m.ITa.getSpans(e.kf(f,g,h-f+1,j-g+1),c),d&&m.mJb&&(l=m.mJb.nJb(c),k=k.concat(l)),k.length>0&&m.Nt(k,f,g,h,j,r,n,o,c,p,q)),r},a.prototype.rr=function(a,b,c,d,e){var f,g,h,j,k=this,l=k.getRowCount(c),m=k.getColumnCount(c),n=k.Gr(a,c),o=k.Hr(b,c),p=new i.yp;return n&&n.length>0&&o&&o.length>0?(f=n[0].row,g=o[0].col,h=k.getSpan(d,e,c),h&&(j=[],j.push(h),k.Nt(j,f,g,h.row+h.rowCount,h.col+h.colCount,p,l,m,c,n,o)),p.length>0?p[0]:M):M},a.prototype.Nt=function(a,b,c,d,e,f,g,h,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a.length;if(!(G<=0)){for(m=this,o=d+1,p=e+1,q=[],r=[],s=[],t=[],u=0,v=0,n=b-1;n>=0;n--)q[n]=m.Sl(n,j),v-=q[n],t[n]=v;for(v=0,n=b;n<o;n++)t[n]=v,q[n]=m.Sl(n,j),v+=q[n];for(n=c-1;n>=0;n--)r[n]=m.Tl(n,j),u-=r[n],s[n]=u;for(u=0,n=c;n<p;n++)s[n]=u,r[n]=m.Tl(n,j),u+=r[n];for(w=0;w<G;w++)if(x=a[w],x.intersect(b,c,d-b+1,e-c+1)){if(y=x.row+x.rowCount,y>o){for(n=o;n<y;n++)q.push(m.Sl(n,j)),t.push(t[n-1]+q[n]);o=y}if(z=x.col+x.colCount,z>p){for(n=p;n<z;n++)r.push(m.Tl(n,j)),s.push(s[n-1]+r[n]);p=z}for(A=s[x.col],B=t[x.row],C=0,D=0,E=void 0,F=void 0,F=x.col;F<x.col+x.colCount&&F<h;F++)C+=r[F];for(E=x.row;E<x.row+x.rowCount&&E<g;E++)D+=q[E];f.push(new i.zp(x.row,x.col,l[0].x+A,k[0].y+B,C,D,x.rowCount,x.colCount,x.isAutoMerge))}}},a.prototype.qs=function(){var a,b,c,d=this,e=d.parent,f=d.Ot(d.qq),g=d.eCb;f!==-1&&f!==d.qq&&(d.qq=f),a=e&&e.kKc,a&&(b=a.QB===n.ScrollType.pixels,c=b?d.jgc(f)-g:d.Qt(f),a.value(c))},a.prototype.os=function(){var a,b,c,d=this,e=d.parent,f=d.Rt(d.lq),g=d.cCb;f!==-1&&f!==d.lq&&(d.lq=f),a=e&&e.nKc,a&&(b=a.QB===n.ScrollType.pixels,c=b?d.kgc(f)-g:d.Tt(f),a.value(c))},a.prototype.ds=function(){var a,b=this,c=b.parent;c&&c.kKc&&(a=c.options.scrollByPixel,c.kKc.QB=a?n.ScrollType.pixels:n.ScrollType.continuous),c&&c.Ut&&(c.options.scrollbarAppearance===n.ScrollbarAppearance.mobile&&c.hec(),c.options.scrollIgnoreHidden&&(b.Vt=b.Wt(!0)),c.Ut())},a.prototype.es=function(){var a,b=this,c=b.parent;c&&c.nKc&&(a=c.options.scrollByPixel,c.nKc.QB=a?n.ScrollType.pixels:n.ScrollType.continuous),c&&c.Xt&&(c.options.scrollbarAppearance===n.ScrollbarAppearance.mobile&&c.hec(),c.options.scrollIgnoreHidden&&(b.Yt=b.Zt(!0)),c.Xt())},a.prototype.$t=function(){var a=this,b=0,c=ya(a);return b=c>0?a.Zq(c-1):a.$q()},a.prototype._t=function(){var a=this,b=0,c=za(a);return b=c>0?a._q(c-1):a.ar()},a.prototype.$q=function(a){return this.Zq(-1,a)},a.prototype.Zq=function(a,b,c){for(var d=this,e=d.getColumnCount(b),f=c?e-1:e-1-ua(d);a<f;)if(a++,d.getColumnVisible(a,b)&&d.Tl(a,b)>0)return a;return M},a.prototype.br=function(a,b,c){for(var d=this,e=c?0:ya(d);a>e;)if(a--,d.getColumnVisible(a,b)&&d.Tl(a,b)>0)return a;return M},a.prototype.ar=function(a){return this._q(-1,a)},a.prototype._q=function(a,b,c){for(var d=this,e=d.getRowCount(b),f=c?e-1:e-1-va(d);a<f;)if(a++,d.getRowVisible(a,b)&&d.Sl(a,b)>0)return a;return M},a.prototype.gr=function(a,b,c){for(var d=this,e=c?0:za(d);a>e;)if(a--,d.getRowVisible(a,b)&&d.Sl(a,b)>0)return a;return M},a.prototype.au=function(){this.jq=!0,this.os()},a.prototype.bu=function(){this.oq=!0,this.qs()},a.prototype.kgc=function(a){var b,c,d=this,e=za(d),f=ta(d)-va(d)-e,g=e,h=g+f-1,i=0;if(a<=g)return i;for(a>h&&(a=h),b=g;b<a;b++)c=d.Sl(b),i+=c;return i},a.prototype.jgc=function(a){var b,c,d=this,e=ya(d),f=sa(d)-ua(d)-e,g=e,h=g+f-1,i=0;if(a<=g)return i;for(a>h&&(a=h),b=g;b<a;b++)c=d.Tl(b),i+=c;return i},a.prototype.Tt=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Zt().visibleIndex,b[a]):a},a.prototype.cu=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Zt().originalIndex,b[a]):a},a.prototype.Qt=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Wt().visibleIndex,b[a]):a},a.prototype.du=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Wt().originalIndex,b[a]):a},a.prototype.Wt=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Vt&&!a)return j.Vt;if(b=ya(j),c=sa(j)-ua(j)-b,d=b,e=d+c-1,f=j.ss,g={visibleIndex:{},originalIndex:{}},e-d+1<=0)return g;for(h=0,i=d;i<=e;i++)g.originalIndex[h]=i,g.visibleIndex[i]=h,f._m(i)>0&&h++;for(i--,h--;f._m(i)<=0&&i>=d;)g.originalIndex[h]=i,g.visibleIndex[i]=h,i--;return g},a.prototype.Zt=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Yt&&!a)return j.Yt;if(b=za(j),c=ta(j)-va(j)-b,d=b,e=d+c-1,f=j.ss,g={visibleIndex:{},originalIndex:{}},e-d+1<=0)return g;for(h=0,i=d;i<=e;i++)g.originalIndex[h]=i,g.visibleIndex[i]=h,f.Sl(i)>0&&h++;for(i--,h--;f.Sl(i)<=0&&i>=d;)g.originalIndex[h]=i,g.visibleIndex[i]=h,i--;return g},a.prototype.Rt=function(a,b){var c,d=this,e=za(d),f=ta(d)-va(d)-1;if(b){if(a>f&&(a=f),c=d.gr(a+1),c!==M&&c>=e)return c}else if(a<e&&(a=e),c=d._q(a-1),c!==M&&c<=f)return c;return-1},a.prototype.Ot=function(a,b){var c,d=this,e=ya(d),f=sa(d)-ua(d)-1;if(b){if(a>f&&(a=f),c=d.br(a+1),c!==M&&c>=e)return c}else if(a<e&&(a=e),c=d.Zq(a-1),c!==M&&c<=f)return c;return-1},a.prototype.eu=function(a,b,c){var d,e,f,g,h;if(c<b)return c;for(d=0,e=this.ss,f=c,g=c;g>=b;g--)if(h=e.Sl(g),!(h<=0)){if(d+=h,d>a)break;f=g}return f},a.prototype.LHb=function(a,b,c){var d,e,f=0,g=c,h=0;for(d=c;d>=b;d--)if(e=this.Sl(d),!(e<=0)&&(f+=e,g=d,f>=a)){h=a-f;break}return{cj:g,UP:h}},a.prototype.fu=function(a,b,c){var d,e,f,g,h;if(c<b)return c;for(d=0,e=this.ss,f=c,g=c;g>=b;g--)if(h=e._m(g),!(h<=0)){if(d+=h,d>a)break;f=g}return f},a.prototype.MHb=function(a,b,c){var d,e,f=0,g=c,h=0;for(d=c;d>=b;d--)if(e=this.Tl(d),!(e<=0)&&(g=d,f+=e,f>=a)){h=a-f;break}return{dj:g,UP:h}},a.prototype.gu=function(){var a,b,c,d=this,e=d.am(),f=d.Hr(1,3),g=0,h=0;if(f)for(a=0;a<f.length;a++)b=f[a].width,g+=b,b>0&&h++;return h=0===h?1:h,c=g/h,0===c?1:Q(d.rKc(e)/c)},a.prototype.hu=function(){var a,b,c,d=this,e=d.am(),f=d.Gr(1,3),g=0,h=0;if(f)for(a=0;a<f.length;a++)b=f[a].height,g+=b,b>0&&h++;return h=0===h?1:h,c=g/h,0===c?1:Q(d.oKc(e)/c)},a.prototype.ns=function(a){var b,c,d,e,f,g,h;return w(a)&&(a=3),b=this,c=b.parent,d=za(b),e=va(b),c&&c.options.scrollbarMaxAlign?(f=b.am(),b.eu(b.oKc(f),d,ta(b)-e-1)):(g=b.getRowCount(a),3!==a&&2!==a||(g-=e),h=b.gr(g,a),h===M&&(h=d),h)},a.prototype.ps=function(a){var b,c,d,e,f,g;return w(a)&&(a=3),b=this,c=b.parent,d=ya(b),c&&c.options.scrollbarMaxAlign?(e=b.am(),b.fu(b.rKc(e),d,sa(b)-ua(b)-1)):(f=b.getColumnCount(a),3!==a&&1!==a||(f-=ua(b)),g=b.br(f,a),g===M&&(g=d),g)},a.prototype.iu=function(){var b,c,d,e,f=this,g=za(f),h=ya(f),i=ta(f)-va(f)-1,j=sa(f)-ua(f)-1,k=f.ITa,l=k.getLastNonNullRow(3);return l>g&&(g=l),b=k.getLastNonNullCol(3),b>h&&(h=b),c=k.getLastNonNullRow(2),c>g&&(g=c),d=k.getLastNonNullCol(1),d>h&&(h=d),e=a._n,e&&B(e,function(a,b){var c,d=b.lastNonNullRowAndCol;d&&(c=d.call(f),g=P(g,c.lastNonNullRow),h=P(h,c.lastNonNullCol))}),g>i&&(g=i),h>j&&(h=j),{lastNonNullRow:g,lastNonNullCol:h}},a.prototype.getLastNonNullRow=function(){return this.iu().lastNonNullRow},a.prototype.getLastNonNullColumn=function(){return this.iu().lastNonNullCol},a.prototype.mq=function(a,b,c){var d,e=this,f=e.lq,g=e.cCb,h=e.ns(),i=!w(c);f>=e.getRowCount()&&a>h&&(a=h),a>=e._t()&&a<=h&&(i||a!==f||b!==g)&&(d=e.parent,d&&(d.ku&&d.ku.ju(e,a,b||0,c),e.os()),d&&!d.options.scrollbarShowMax&&e.es(),e.invalidateLayout())},a.prototype.rq=function(a,b,c){var d,e=this,f=e.qq,g=e.eCb,h=e.ps(),i=!w(c);f>=e.getColumnCount()&&a>h&&(a=h),a>=e.$t()&&a<=h&&(i||a!==f||b!==g)&&(d=e.parent,d&&(d.ku&&d.ku.lu(e,a,b||0,c),e.qs()),d&&!d.options.scrollbarShowMax&&e.ds(),e.invalidateLayout())},a.prototype.yr=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.row,n=a.col,o=a.hitTestType;return w(m)||w(n)?M:(d=l.getSpan(m,n,o),d&&(m=d.row,n=d.col),l.mJb&&(e=l.mJb.oJb(m,n,o),e&&(m=e.row,n=e.col)),f=l.AHb(m,n,o),g=1===o?-1:N,h=2===o?-1:N,i=l.getCellRect(m,n,g,h,!0),j={sheet:l,row:m,col:n,sheetArea:o},k=f.cellType||l.Al(o),k.h5(b,c,f,i,j))},a.prototype.mu=function(){this.unbindAll(),this.nu()},a.prototype.ou=function(a,b){var c,d,e,f,g,h,i,j=this.Tq(a),k=j.row,l=j.col,m=k+j.rowCount,n=l+j.colCount;for(d=k;d<m;d++)for(e=l;e<n;e++)if(f=this.getSpan(d,e),g=f?f.row:d,h=f?f.col:e,c=this.getActualStyle(g,h),i=b&&this.Ps(d),c.locked===!0&&!i)return!0;return!1},a.prototype.pu=function(a,b,c,d,e,f){if(-1<=a&&a<e&&-1<=b&&b<f){if(a===-1&&b===-1)return!0;if(a===-1){if(0!==d&&b+d<=f)return!0}else if(b===-1){if(0!==c&&a+c<=e)return!0}else if(0!==d&&b+d<=f&&0!==c&&a+c<=e)return!0}return!1},a.prototype.qu=function(a,b,c,d){var e,f,g,h=this;return!(a<0&&b<0)&&(a<0&&(e=h.ITa.zl(1),e&&e.spans&&e.spans.length>0)?h.ITa.qu(-1,b,-1,d,1):b<0&&(f=h.ITa.zl(2),f&&f.spans&&f.spans.length>0)?h.ITa.qu(a,-1,c,-1,2):(g=h.ITa.zl(3),!!(g&&g.spans&&g.spans.length>0)&&h.ITa.qu(a,b,c,d,3)))},a.prototype.suspendPaint=function(){var b=this,c=b.Xq;b.Xq++,0===c&&a.ao(b,aa,{suspend:!0})},a.prototype.resumePaint=function(){var b=this;b.Xq--,b.Xq<=0&&(b.Xq=0,a.ao(b,aa,{suspend:!1}),b.cMc()&&b.$p())},a.prototype.cMc=function(){var a=this.parent;return!a||a.getActiveSheet()===this},a.prototype.isPaintSuspended=function(){return this.Xq>0},a.prototype.su=function(a,b){var c,d,e=this,f=a&&a.length;for(c=0;c<f;c++)if(d=a[c],b.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(c,1),e.su(a,b.union(d));return b},a.prototype.getClipboardHelperObj=function(){var a=this.tu();return{isCutting:a.G4,ranges:a.n5,showInsertCopyPasteCells:a.UHb}},a.prototype.resetFloatingObjectHelperData=function(a){this.CR&&this.CR.remove(a)},a.prototype.tu=function(){var a=this,b=a.parent;return a.uu||(a.uu=b&&b.uu),a.uu},a.prototype.vu=function(){if(!this.bt){var a=this;a.bt=new f.oo(function(){a.bt&&(a.parent&&a.parent.fgc&&a.parent.fgc.endingCallback||a.repaint())})}return this.bt},a.prototype.wu=function(){var a=this,b=a.parent;if(b)return b.commandManager()},a.prototype.Os=function(a,b){this.Wq(e.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:a,message:b})},a.prototype.Bq=function(a,b,c,d,f,g){var h,i;0===this.jm&&(h={sheet:this,sheetName:this.name(),row:b,col:c,sheetArea:d,propertyName:a,oldValue:f,newValue:g,isUndo:this.OIb},this.Wq(e.Events.CellChanged,h),i=this.ITa,i.ZVa(["cellChanged",a,b,c,d,g,f]))},a.prototype.xu=function(a,b,c,d){this.Wq(e.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:a,col:b,oldValue:c,newValue:d})},a.prototype.qCb=function(a,b,c,d,f){var g,h;if(0===this.jm){if(g={sheet:this,sheetName:this.name(),col:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,cancel:!1},"addColumns"!==c&&"deleteColums"!==c||(g.count=d),this.Wq(e.Events.ColumnChanging,g),g.cancel===!0)return!1;h=this.ITa,h.ZVa(["columnChanging",a,b,c,f,d])}return!0},a.prototype.pq=function(a,b,c,d,f){var g,h;0===this.jm?(g={sheet:this,sheetName:this.name(),col:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,isUndo:this.OIb},"addColumns"!==c&&"deleteColumns"!==c||(g.count=d),this.Wq(e.Events.ColumnChanged,g),h=this.ITa,h.ZVa(["columnChanged",a,b,c,f,d])):this.WXc(this,[{col:a}],1)},a.prototype.RIb=function(a,b,c,d){var f,g,h,i,j=[];if(this.tables){for(f=this.tables.pJb(a,b,c,d),g=0;g<f.length;g++)j.push(f[g].name());j.length>0&&(h={isUndo:this.OIb,sheet:this,sheetName:this.name(),row:a,col:c,rowCount:b,colCount:d,tableNames:j,action:2},this.Wq(e.Events.RangeChanged,h),i=this.ITa,i.ZVa(["rangeChanged",a,b,c,d]))}},a.prototype.pCb=function(a,b,c,d,f){var g,h;if(0===this.jm){if(g={sheet:this,sheetName:this.name(),row:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,cancel:!1},"addRows"!==c&&"deleteRows"!==c||(g.count=d),this.Wq(e.Events.RowChanging,g),g.cancel===!0)return!1;h=this.ITa,h.ZVa(["rowChanging",a,b,c,f,d])}return!0},a.prototype.kq=function(a,b,c,d,f){var g,h;0===this.jm?(g={sheet:this,sheetName:this.name(),row:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,isUndo:this.OIb},"addRows"!==c&&"deleteRows"!==c||(g.count=d),this.Wq(e.Events.RowChanged,g),h=this.ITa,h.ZVa(["rowChanged",a,b,c,f,d])):this.WXc(this,[{row:a}],2)},a.prototype.gyb=function(a,b){b!==a&&(this.Wq(e.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:a,newZoomFactor:b}),this.Wq(e.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:a,newZoomFactor:b}))},a.prototype.yu=function(a,b){return!(this.n_a||!this.mm.zu(a,b))&&(this.Wq(e.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:a,newSelections:b}),!0)},a.prototype.Au=function(a){this.Wq(e.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:a,newSelections:this.getSelections()})},a.prototype.Bu=function(a,b,c,d,f,g,h,i,j,k){var l={sheet:this,sheetName:this.name(),row:a,col:b,rowCount:c,colCount:d,changedCells:f,action:g},m={sheet:this,sheetName:this.name(),row:a,col:b,rowCount:c,colCount:d,changedCells:f,isUndo:!!k,action:g};h&&(l.sheetArea=h,m.sheetArea=h),i&&(l.value=i),f&&f.length>0&&(j&&j.length>0&&(m.tableNames=j),this.Wq(e.Events.RangeChanged,m),this.Wq(e.Events.FormulatextboxRangeChanged,l))},a.prototype.Cu=function(a,b){var c={sheet:this,sheetName:this.name(),oldStatus:a,newStatus:b};this.Wq(e.Events.EditorStatusChanged,c)},a.prototype.Du=function(){return this.b4||(this.b4=j.GC$(x("input"))),this.b4},a.prototype.KLc=function(){var a=this;return a.parent&&a.parent.options.pasteSkipInvisibleRange},a.prototype.MLc=function(a,b,c){var d,e=this,f=0,g=e.getColumnWidth,h=e.getColumnCount();for(c&&(g=e.getRowHeight,h=e.getRowCount()),a=a<0?0:a,d=a;d<a+b;d++)d<h&&0===g.call(e,d)&&(f++,b++);return f},a.prototype.OLc=function(a,b,c){var d,e=this,f=0,g=e.getColumnWidth;for(c&&(g=e.getRowHeight),a=a<0?0:a,d=a;d>a-b&&d>0;d--)0===g.call(e,d)&&(f++,b++);return f},a.prototype.NLc=function(a,b,c){var d,e=this,f=0,g=e.getColumnWidth;for(c&&(g=e.getRowHeight),a=a<0?0:a,d=a;d<a+b;d++)0===g.call(e,d)&&f++;return f},a.prototype.bind=function(a,b,c){this.Du().bind(a+ea,b,c)},a.prototype.unbind=function(a,b){this.Du().unbind(a+ea,b)},a.prototype.Wq=function(a,b,c){this.updateEventsData&&this.updateEventsData(a,b),(0===this.jm||c)&&this.Du().trigger(a,b)},a.prototype.unbindAll=function(){this.unbind(ea)},a.prototype.Fu=function(a,b,c){a.indexOf(".")>=0?this.bind(a,b,c):this.bind(a+fa,b,c)},a.prototype.Gu=function(a,b){a.indexOf(".")>=0?this.unbind(a,b):this.unbind(a+fa,b)},a.prototype.nu=function(){this.unbind(fa)},a.prototype.Dr=function(){var a=this.Zs;return new e.Rect(a.x,a.y,a.width,a.height)},a.prototype.Us=function(a){this.Zs=new e.Rect(a.x,a.y,a.width,a.height)},a.prototype.scroll=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.parent;o&&(c=o.options,d=c.scrollByPixel,e=c.scrollPixel,f=o.ku,g=c.scrollbarShowMax,h=c.showHorizontalScrollbar,i=c.showVerticalScrollbar,0!==b&&(j=f._Bb(n,Math.round(b)/e),k=j.dj,l=d?j.UP:0,k===n.qq&&l===n.eCb||(f.lu(n,k,l),h&&(n.qs(),g||(n.oq=!0)))),0!==a&&(m=f.aCb(n,Math.round(a)/e),k=m.cj,l=d?m.UP:0,k===n.lq&&l===n.cCb||(f.ju(n,k,l),i&&(n.os(),g||(n.jq=!0)))))},a.prototype.isCtrlPressed=function(a){return this.mm&&this.mm.ctrl},a.prototype.deselectIgnoreSpan=function(){return!1},a.prototype.lKc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u=this,v=u.zoom(),x=b.newValue,y=b.oldValue,z=b.scrollEventType,A=a.options.scrollByPixel,B=a.options.scrollPixel;if(y=b.oldValue=w(y)?0:A?T(y):J(y+"",10),u.jq=!1,e=u._t(),f=u.ns(),g=a.options.scrollbarShowMax,h=0,A){for(x=T(x),i=x-y,z!==n.Nxb.thumbTrack&&(i*=B*v,x=y+i,x<0&&(x=0)),g||(u.jq=!0,z===n.Nxb.smallIncrement&&x===y?x+=B*v:b.ignoreUpdatePosition=!0),j=u.frozenRowCount(),k=u.getRowCount()-u.frozenTrailingRowCount()-j,l=j,m=l+k-1,o=0,p=0,q=l;q<=m;q++)if(p=u.Sl(q),o+=p,o>=x){h=o-x-p,c=q;break}w(c)&&(c=m,h=-u.Sl(m),x=o)}else c=J(x+"",10),c=u.cu(c),z===n.Nxb.largeDecrement||z===n.Nxb.smallDecrement?(z===n.Nxb.largeDecrement&&(c=u.Ew()),d=u.Rt(c,!0),d!==-1&&d!==c&&(c=d),g||(u.jq=!0,b.ignoreUpdatePosition=!0)):z!==n.Nxb.largeIncrement&&z!==n.Nxb.smallIncrement||(z===n.Nxb.largeIncrement&&(c=u.Fw(),c===u.lq&&c++),g||(u.jq=!0,z===n.Nxb.smallIncrement&&x===y&&c++),d=u.Rt(c),d!==-1&&d!==c&&(c=d)),c<e&&(c=e),c>f&&(c=f);r=A?T(x):u.Tt(c),b.newValue!==r&&(b.newValue=r),s=r,t=u.Sl(c),0!==t&&(s+=S(h)/t),b.newValueWithOffset=A?r:s,(y!==r||A)&&a.ku.Bw(u,c,h)},a.prototype.mKc=function(a){var b,c,d,e=this,f=a.nKc,g=f.QB===n.ScrollType.pixels;g||(b=e.cu(f.value()),c=e._t(),d=e.ns(),b<c?f.value(e.Tt(c)):b>d&&f.value(e.Tt(d))),a.xw(),a.options.scrollbarShowMax||(a.ku.scrolling?e.jq=!0:a.Xt())},a.prototype.iKc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u=this,v=u.zoom(),x=b.newValue,y=b.oldValue,z=b.scrollEventType,A=a.options.scrollByPixel,B=a.options.scrollPixel;if(y=b.oldValue=w(y)?0:A?T(y):J(y+"",10),u.oq=!1,e=u.$t(),f=u.ps(),g=a.options.scrollbarShowMax,h=0,A){for(x=T(x),i=x-y,z!==n.Nxb.thumbTrack&&(i*=B*v,x=y+i,x<0&&(x=0)),g||(u.oq=!0,z===n.Nxb.smallIncrement&&x===y?x+=B*v:b.ignoreUpdatePosition=!0),j=u.frozenColumnCount(),k=u.getColumnCount()-u.frozenTrailingColumnCount()-j,l=j,m=l+k-1,o=0,p=0,q=l;q<=m;q++)if(p=u.Tl(q),o+=p,o>=x){h=o-x-p,c=q;break}w(c)&&(c=m,h=-u.Tl(m),x=o)}else c=J(x+"",10),c=u.du(c),z===n.Nxb.largeDecrement||z===n.Nxb.smallDecrement?(z===n.Nxb.largeDecrement&&(c=u.zw()),d=u.Ot(c,!0),d!==-1&&d!==c&&(c=d),g||(u.oq=!0,b.ignoreUpdatePosition=!0)):z!==n.Nxb.largeIncrement&&z!==n.Nxb.smallIncrement||(z===n.Nxb.largeIncrement&&(c=u.Aw(),
c===u.qq&&c++),g||(u.oq=!0,z===n.Nxb.smallIncrement&&x===y&&c++),d=u.Ot(c),d!==-1&&d!==c&&(c=d)),c<e&&(c=e),c>f&&(c=f);r=A?T(x):u.Qt(c),b.newValue!==r&&(b.newValue=r),s=r,t=u.Tl(c),0!==t&&(s+=S(h)/t),b.newValueWithOffset=A?r:s,(y!==r||A)&&a.ku.Bw(u,c,h,!0)},a.prototype.jKc=function(a){var b,c,d,e,f=this,g=a.kKc;f&&g&&(b=g.QB===n.ScrollType.pixels,b||(c=f.du(g.value()),d=f.$t(),e=f.ps(),c<d?g.value(f.Qt(d)):c>e&&g.value(f.Qt(e))),a.xw(),a.options.scrollbarShowMax||(a.ku.scrolling?f.oq=!0:a.Ut()))},a.prototype.Ut=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,o,p,q=this,r=c&&c.QB===n.ScrollType.pixels,s=q.frozenColumnCount(),t=q.getColumnCount()-q.frozenTrailingColumnCount()-s,u=s,v=q.am(),w=q.rKc(v),x=0===t?u:u+t-1,y=q.qq,z=q.eCb,A=0;a?(r?(e=q.MHb(w,u,x),f=e.dj,g=e.UP,d=f,A=g):d=q.fu(w,u,x),x=d):r&&(A=-q.Tl(x)),b?r&&!a&&(A=-q.Tl(x)):(h=q.iu(),i=h.lastNonNullCol,j=q.fu(w,u,i),j===u&&(j++,j>x&&(j=x)),x=y>j?y<x?y:x:j,A=z),y>x?(q.qq=x,q.eCb=r?A:0):y===x&&A>z&&(q.eCb=r?A:0),k=q.Ot(q.qq),k!==-1&&k!==q.qq&&(q.qq=k),c&&(l=0,m=0,o=0,p=0,r?(l=q.jgc(u),m=q.jgc(x)-A,o=w,p=q.jgc(q.qq)-q.eCb):(l=q.Qt(u),m=q.Qt(x),o=q.gu(),p=q.Qt(q.qq),o<1&&(o=1)),c.bw(l),c.cw(m),c.dw(o),c.ew(),c.value(p))},a.prototype.Xt=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,o,p,q=this,r=c&&c.QB===n.ScrollType.pixels,s=q.frozenRowCount(),t=q.getRowCount()-q.frozenTrailingRowCount()-s,u=s,v=q.am(),w=0===t?u:u+t-1,x=q.lq,y=q.cCb,z=0,A=q.oKc(v);a?(r?(e=q.LHb(A,u,w),f=e.cj,g=e.UP,d=f,z=g):d=q.eu(A,u,w),w=d):r&&(z=-q.Sl(w)),b?r&&!a&&(z=-q.Sl(w)):(h=q.iu(),i=h.lastNonNullRow,j=q.eu(A,u,i),j===u&&(j++,j>w&&(j=w)),w=x>j?x<w?x:w:j,z=y),x>w?(q.lq=w,q.cCb=r?z:0):x===w&&z>y&&(q.cCb=r?z:0),k=q.Rt(q.lq),k!==-1&&k!==q.lq&&(q.lq=k),c&&(l=0,m=0,o=0,p=0,r?(l=q.kgc(u),m=q.kgc(w)-z,o=A,p=q.kgc(q.lq)-q.cCb):(l=q.Tt(u),m=q.Tt(w),o=q.hu(),p=q.Tt(q.lq),o<1&&(o=1)),c.bw(l),c.cw(m),c.dw(o),c.ew(),c.value(p))},a.prototype.Av=function(){var a,b,c,d,e=this,f=e.getRowCount(),g=e.getColumnCount();for(a=0;a<f;a++)for(b=0;b<g;b++)c=e.getValue(a,b),c instanceof Date&&(d=e.getStyle(a,b),d&&d.$o(c),e.Nq(a,b,d))},a.prototype.$Yc=function(a,b){var c=this;c.Vr(a,b,ga,!1,n.SheetArea.colHeader),c.oq=!0,c.$p()},a.prototype.sYc=function(a){var b=this;return b.ITa.getColumnHeaderFitMode(!1,1,a)},a.prototype._Yc=function(a,b,c,d,e){var f,g,h,i,j,k,l;return w(d)&&(d=3),f=this,e||(g=f.xHb(a,b,d),w(g))?(h=f.getCellType(a,b,d),i=c,j=f.tq(a,b,"formatter",d),j||(j=f.tq(a,b,"_autoFormatter",d)),"General"===j&&(j=N),k={},l=f.tq(a,b,"quotePrefix",d),i=h.format(i,j,k,{sheet:f,row:a,col:b,sheetArea:d,quotePrefix:l}),i&&"string"==typeof i&&(i=i.replace(/\r\n?/g,"\n")),i):g},a.prototype.isRowFilterOut=function(a){return this.Ps(a)},a.Np=1,a.Qp=ma,a.Rp=200,a.Sp=20,a.Tp=1,a.Vp=1,a}(),b.Worksheet=na,e.Zn(na),oa=na.prototype,oa.visible=y("visible",!0,function(a){var b,c=this,d=c.parent,e=d.sheets,f=e.length,g=j.GC$.inArray(c,e),h=d.getActiveSheetIndex();if(a)h<0?(d.dq(g,1),d.YJc&&d.YJc.gq<0&&(d.YJc.gq=g)):d.aq();else if(g===h){for(b=g+1;b<f&&!e[b].visible();)b++;if(b>=f)for(b=g-1;b>=0&&!e[b].visible();)b--;d.YJc&&b<d.YJc.gq&&(d.YJc.gq=b),b<0?(c.no(!1),d.eq=b,d.fq()):d.dq(b,1)}else d.aq()}),oa.frozenColumnCount=y("frozenColumnCount",0,function(a){var b=this;b.qq<a?b.qq=a:""!==a&&0!==a&&null!==a||(b.qq=0),b.oq=!0,b.$p()},function(a){return a>=0}),oa.frozenRowCount=y("frozenRowCount",0,function(a){var b=this;b.lq<a?b.lq=a:""!==a&&0!==a&&null!==a||(b.lq=0),b.jq=!0,b.$p()},function(a){return a>=0});function Fa(a,b,c,d,e){if((b!==-1||c!==-1)&&(w(e)&&(e=3),3===e)){var f=a.tables&&a.tables.find(b,c);f&&f.NZ&&b===f.footerIndex()&&na.ao(a,"composeTableFooterList",{table:f,row:b,col:c,style:d})}}},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});;/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/sheetsCalc/sheetsCalc.entry.js")}({"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("CalcEngine"),i=c("./dist/plugins/sheetsCalc/calc.ns.js"),j=f.Common.j,k=f.Common.u,l=j.Ia,m=j.za,n=null,o=void 0,p=["v","n","s","b","d","sn"],q=h.Errors.Value,r=h.Errors.Calc,s=f.Formatter&&f.Formatter.GeneralFormatter,t=h.Convert.vf,u=h.Convert.Fh,v=h.Convert.Ca,w=h.Errors.Reference,x=h.Errors.NotAvailable,y=h.Errors.Name,z=f.Common.A,A=f.Common.B,B=j.Fa,C=function(a){return h.Convert.Na(a,!0)},D=d.Range.prototype.contains,E=k.Nb,F="number",G=h.CalcSource.prototype,G.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,l,m,p,r,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(s=y.getRowCount(),t=y.getColumnCount(),c=c===o||c,u=0;u<C;u++){if(c||(r=[],B.push(r)),z=a.getRowCount(u),0===z)return B.isError=!0,B;if(A=a.getColumnCount(u),0===A)return B.isError=!0,B;if(l=a.getRow(u),m=a.getColumn(u),l>=s||m>=t)return B=[n],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;for(l+z>s&&(z=s-l),m+A>t&&(A=t-m),v=void 0,w=0;w<z;w++)for(j=l+w,c||(v=[],r.push(v)),x=0;x<A;x++){if(k=m+x,p=y.getValue(j,k),d&&h.Convert.vf(p))return B=[p],B.isError=!0,B;if(p=h.Convert.wf(p,b,!h.ExcelCompatibleCalcMode,f,i),e&&p===h.Convert.CalcConvertedError)return B=[q],B.isConvertError=!0,B;p===n&&f||(c?B.push(p):v.push(p))}}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},G.getSheetReference=function(){var a=this;return a.Df=a.Df||new h.CalcReference(a),a.Df},function(a){a[a.a1=0]="a1",a[a.r1c1=1]="r1c1"}(H=b.ReferenceStyle||(b.ReferenceStyle={})),e.ReferenceStyle=H,I=function(){function a(a,b,c,d,e){var f=this;f.Cj=a,f.Uu=c,f.Vu=d,f.Lf=b,B(e)||(f.kT=e)}return a.prototype.getName=function(){return this.Cj},a.prototype.getRow=function(){return this.Uu},a.prototype.getColumn=function(){return this.Vu},a.prototype.getExpression=function(){return this.Lf},a.prototype.getComment=function(){return this.kT},a.prototype.fg=function(a,b){b&&b.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=a},a}(),b.NameInfo=I,e.NameInfo=I,h.CalcSource.prototype.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},J=function(a){O(b,a);function b(b){var c=a.call(this,n)||this;return c.references=b,c}return b.prototype.toArray=function(a,b,c,d,e){var f,g,h=this.references,i=[];for(f=0;f<h.length;f++){if(g=h[f].xf.referenceToArray(h[f],a,b,c,d,e),g.isError&&c)return g;b?Array.prototype.push.apply(i,g):i.push(g[0]),f||(i.rowCount=g.rowCount,i.colCount=g.colCount)}return i.rangeCount=h.length,i},b}(h.CalcReference),b.SheetRangeReference=J,K=function(a){O(b,a);function b(c,e,f,h){var i,j,k,l=a.call(this,c&&c.yj(),e,f,h)||this;for(c||(c=b.hYc=b.hYc||new d.Worksheet),l.kj=c,l.row=f&&f.row||0,l.column=f&&f.col||0,i=c.getCalcService(),j=i.getResolvers(),k=0;k<j.length;k++)if(j[k]instanceof g.SheetReferenceResolver)return l;return i.addResolver(new g.SheetReferenceResolver(c)),i.addResolver(new g.StructureReferenceResolver(c)),l}return b.prototype.getExternalSource=function(a,b){var c,d,e,f=this,g=f.kj.parent;if(a&&(!g||g.name!==a))return n;if(!g)return k.Mb(f.kj.name(),b)?f.kj.yj():n;if(c=g.sheets,c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],k.Mb(e.name(),b))return e.yj();return h.ParserContext.prototype.getExternalSource.call(this,a,b)},b.prototype.getExternalSourceToken=function(a){return a.getName()},b.prototype.getTableByName=function(a){var b,c,d=this.kj.tables,e=d?d.findByName(a):n;if(!e&&(b=this.kj.parent&&this.kj.parent.sheets))for(c=0;c<b.length&&(d=b[c].tables,!d||!(e=d.findByName(a)));c++);return e?e:this.kj.parent&&this.kj.parent.getSheetTab(a)},b.prototype.getTableByIndex=function(a,b){var c=this.kj.tables;return c?c.find(a,b):n},b.prototype.setSource=function(a){this.source=a;var b=a;b&&b.getSheet&&(this.kj=b.getSheet())},b.prototype.no=function(){this.kj&&this.kj!==b.hYc&&this.kj.no(),this.kj=n},b}(h.ParserContext),b.SheetParserContext=K,L=new f.Common.ResourceManager(d.SR),M=function(a){O(b,a);function b(c,d){var e=a.call(this,n)||this;return e.getCalcSourceModel=function(){return this.Bf},e.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},e.getRangeKey=function(a,b){return a.id+","+b.row+","+b.col+","+b.rowCount+","+b.colCount},e.getSheetRangeReference=function(a){var c,d,e,f,g,h=this.kj,i=h&&h.parent;if(a.endSource&&i&&i.sheets&&a.endSource instanceof b){for(c=i.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this)d=!0;else if(e===a.endSource){f.push(e.getReference(a));break}d&&f.push(e.getReference(a))}return new J(f)}},e.kj=c,e.Wz=d?d:3,e}return b.prototype.startCalculation=function(){this.Hu||this.xLb()},b.prototype.endCalculation=function(){this.Hu=n,this.zIc(),this.Iu=n;var a=this.Bf.ug(!1);a&&a.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},b.prototype.ZIc=function(){var a=this;a.$Ic?a.Iu&&(a._Ic=a._Ic.concat(a.Iu),a.Iu=[]):(a._Ic=a.Iu||[],a.$Ic=setTimeout(function(){a.zIc(a._Ic),delete a._Ic,delete a.$Ic},0))},b.prototype.zIc=function(a){var b,c,e=a||this.Iu;e&&e.length>0&&(b=this.kj,c=b.ITa.XTa(3).Ap,b.Wq(d.Events.RangeChanged,{isUndo:!B(c&&c.KYc),sheet:b,sheetName:b.name(),row:0,col:0,rowCount:b.getRowCount(),colCount:b.getColumnCount(),changedCells:e,action:6},b.vxb))},b.prototype.clearValueCache=function(){this.xLb()},b.prototype.xLb=function(){var a=this.getRowCount(),b=this.getColumnCount();this.Hu={rowCount:a,colCount:b,arrayInfo:[]},this.Iu=[]},b.prototype.OHb=function(){this.Hu=n,this.Iu=n},b.prototype.getValue=function(a,b){var c,e,f,g,i,j,k,l,m,r,s,t,u,v=[];for(c=2;c<arguments.length;c++)v[c-2]=arguments[c];if(e=this,f=e.kj,typeof a===F)g=arguments[0],i=arguments[1],b=arguments[2];else if(a=a,a.row!==o)g=a.row,i=a.col;else if(a.name)return null;return j=e.Wz,b=b||0,g<0||i<0?q:f.Ju&&f.Ku===g&&f.Lu===i?f.Mu:(k=e.Hu,l=p[b],k?(m=k.rowCount,r=k.colCount,s=void 0,t=void 0,u=void 0,g>=m?n:i>=r?n:(s=k[g],s||(s=k[g]={}),t=s[i],t||(t=s[i]={v:f.getValue(g,i,j)}),u=t[l],u===o&&(u=h.Convert.wf(t.v,b,!h.ExcelCompatibleCalcMode),t[l]=u),u=d.Ul.w0a(u))):g>=e.getRowCount()?n:i>=e.getColumnCount()?n:e.kj.getValue(g,i,j))},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName()+"."+d+"."+e+"."+f+"."+g},b.prototype.getReference=function(a){var b=this,c=a.row,d=a.col;return c===-1&&(a.row=0,a.rowCount=b.getRowCount(),a.rowUndefine=!0),d===-1&&(a.col=0,a.colCount=b.getColumnCount(),a.colUndefine=!0),new h.CalcReference(b,[a])},b.prototype.getSources=function(a){var c,d,e,f,g;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&a instanceof b){for(c=this.kj.parent.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this&&(d=!0),e===a){f.push(e);break}d&&f.push(e)}return f}},b.prototype.Ppb=function(a,b){var c,d=this,e=d.Hu,f=e&&e.arrayInfo;f&&(c=!1,f.forEach(function(d,g){if(d){var h=d.reference,i=d.key;D.call(h.yf[0],a,b)&&(delete e[i],f[g]=o,c=!0)}}),c&&(e.arrayInfo=[],f.forEach(function(a){a&&e.arrayInfo.push(a)})))},b.prototype.referenceToArray=function(a,b,c,d,e,f,g,i){var k,l,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this,J=1,K=1,L=[],M=I.kj,N=I.Hu,O=p[b],P=a.getRangeCount();if(0===P)return L.isError=!0,L;if(N&&(x=a.getRangeCount()+"_"+a.getRow(0)+"_"+a.getColumn(0)+"_"+a.getRowCount(0)+"_"+a.getColumnCount(0)+"_"+b+"_"+c,u=N[x]))return u;for(y=this.getRowCount(),z=this.getColumnCount(),c=c===o||c,A=0;A<P;A++){if(c||(v=[],L.push(v)),J=a.getRowCount(A),0===J)return L.isError=!0,L;if(K=a.getColumnCount(A),0===K)return L.isError=!0,L;if(r=a.getRow(A),t=a.getColumn(A),r>=y||t>=z)return L=c?[n]:[[n]],L.rowCount=1,L.colCount=1,L.rangeCount=1,L;for(r+J>y&&(J=y-r),t+K>z&&(K=z-t),B=void 0,C=void 0,D=M.Ju,E=0;E<J;E++)for(k=r+E,c||(B=[],v.push(B)),N&&(N[k]||(N[k]={}),w=N[k]),F=0;F<K;F++){if(l=t+F,D&&M.Ku===k&&M.Lu===l)u=M.Mu,D=!1;else{if(N?(C=w[l],C?u=C.v:(u=M.getValue(k,l,I.Wz),C=w[l]={v:u})):u=M.getValue(k,l,I.Wz),g&&(G=M.getFormatter(),H=void 0,H=G instanceof s?G.formatString():G,"@"===H?u=M.getText(k,l):u instanceof Date&&(u=j.Pa(u)),m(C)||(C=w[l]={v:u})),d&&h.Convert.vf(u))return L=[u],L.isError=!0,L;if(C&&C[O]!==o)u=C[O];else if(u=h.Convert.wf(u,b,!h.ExcelCompatibleCalcMode,f,i),C&&(C[O]=u),e&&C===u)return L=[q],L.isConvertError=!0,L}h.Convert.j$a(u,f)||(c?L.push(u):B.push(u))}}return c||1!==P||(L=L[0]),L.rowCount=J,L.colCount=K,L.rangeCount=P,N&&!isNaN(P)&&!isNaN(J)&&!isNaN(K)&&P*J*K>100&&P*J*K<1e6&&N.arrayInfo.length<50&&(N[x]=L,N[x].rowCount=J,N[x].colCount=K,N[x].rangeCount=P,N.arrayInfo.push({reference:a,key:x})),L},b.prototype.getColumnCount=function(){var a=this.kj;return a.Js?0:a.getColumnCount(this.Wz)},b.prototype.getRowCount=function(){var a=this.kj;return a.Js?0:a.getRowCount(this.Wz)},b.prototype.isHiddenRow=function(a,b){var c=this.kj,d=c.Nu&&c.Nu();return!(!d&&b)&&0===c.getRowHeight(a)},b.prototype.getName=function(){var a=this.Wz,b=B(this.JXc)?this.kj.name():this.JXc;return a===d.SheetArea.colHeader?b+"CH":a===d.SheetArea.rowHeader?b+"RH":b},b.prototype.yLb=function(){var a=this,b=a.ZHb;return b||(b=a.ZHb=a.kj.ITa.ZHb),b},b.prototype.setArray=function(a,b,c,d,e){return this.yLb().setArray(this,a,b,c,d,e)},b.prototype.updateItem=function(a,b,c){return this.yLb().updateItem(this,a,b,c)},b.prototype.GIb=function(a,b){this.yLb().GIb(a,b)},b.prototype.HIb=function(){this.yLb().HIb()},b.prototype.setValue=function(a){var b,c,e,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=[];for(b=1;b<arguments.length;b++)G[b-1]=arguments[b];if(c=this,e=c.kj,h=c.Wz,a=a,a.row!==o)f=a.row,g=a.col,i=1;else{if(a.name)return;f=arguments[0],g=arguments[1],i=2}j=arguments[i],k=arguments[i+1],m=c.Hu,m&&(n=m[f],n&&(p=n[g],p&&(p.v=j,p.b!==o&&(p.b=o),p.d!==o&&(p.d=o),p.n!==o&&(p.n=o),p.s!==o&&(p.s=o),p.sn=o))),q=d.Ul.x0a(j),r=e.ITa,s=!1,t=e.tables,u=t&&t.find(f,g),3===h&&u&&(v=u.showHeader()&&f===u.headerIndex(),w=u.showFooter()&&f===u.footerIndex(),v||w||(s=u.yq(f,g,q))),x=e.wq,3===h&&!s&&x&&x._dataSource&&(y=x.getValue(f,g),z=!1,y.hasBinding&&(A=void 0,m?(B=m.bindingRows=m.bindingRows||{},A=B[f],A||(A=B[f]=l({},e.getDataItem(f)))):A=l({},e.getDataItem(f)),r.Cp(f,g,{Dp:A,Ep:y.value}),z=x.setValue(f,g,q,r.zTa)),s="dataManagerBindingSource"===x.CL?z:y.hasBinding),s||(C="hyperlink",D="__proto__","string"==typeof q&&q[C]&&(E=q[C],F={url:E},r.setHyperlink&&r.do("setHyperlink",f,g,F),delete q[D].hyperlink),r.do("setValue",f,g,q,h,!0,!0,arguments[i+2],!0)),e.cJc=!0,this.Iu?this.Iu.push({row:f,col:g}):e.Wq(d.Events.CellChanged,{sheet:e,sheetName:e.name(),row:f,col:g,sheetArea:h,propertyName:"value",oldValue:k,newValue:j})},b.prototype.getCustomFunction=function(a){return this.kj?this.kj.Pu(a):n},b.prototype.getCustomName=function(a){var b=this.getCustomNameInfo(a);return b?b.getExpression():n},b.prototype.getCustomNameInfo=function(a){return a=E(a),this.kj?this.kj.getCustomName(a):n},b.prototype.getSheet=function(){return this.kj},b.prototype.setFormula=function(a,b,c,d,e){var f,g,h=this;if(h.kj.ITa.zTa&&(g=h.kj.ITa.zTa.formulas,g||(g=h.kj.ITa.zTa.formulas={}),a>=-1&&b>=-1))if(f=g[a],f||(f=g[a]={}),e){if(f[b]&&f[b].oldFormula)return;f[b]=l({},f[b],{oldFormula:c,oldArrayInfo:d}),c||delete f[b].oldArrayInfo}else f[b]=l({},f[b],{formula:c,arrayInfo:d}),c||delete f[b].arrayInfo},b.prototype.setArrayFormula=function(a,b,c,d,e){var f={row:a,column:b,rowCount:c,colCount:d};this.setFormula(a,b,e,f)},b.prototype.setFormulaByName=function(a,b,c){var d,e,f=this;f.kj.ITa.zTa&&(d=f.kj.ITa.zTa.formulas,d||(d=f.kj.ITa.zTa.formulas={}),e=d.names,e||(e=d.names={}),e[a]=l({},e[a],{formula:b,oldFormula:c}))},b.prototype.refresh=function(){this.kj.repaint()},b.prototype.toJSON=function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r,s,t=b,u=a.data||{},v=!0,w=this.Cf();for(k=0;k<=c;k++)if(f=u.dataTable||{},g=t[k]){for(i=f[k],v=!i,i=i||{},l=0;l<=d;l++)if(h=g[l],h&&h.Lf){j=i[l]||{};try{n=w.unparse(this,h.Lf,k,l,!1,!0),!h.Pf&&n&&0===n.indexOf("@")&&Y(this.kj,n.slice(1,n.length),0,0)&&(n=n.slice(1,n.length)),h.Pf?h.Pf.row===k&&h.Pf.col===l&&(j.arrayInfo=h.Pf,j.formula=n):j.formula=n,v=!1,i[l]=j}catch(a){}}if(v){if(f!==u.dataTable)continue}else f[k]=i;u.dataTable=f}if(e){for(o=u.columnDataArray||[],p=0;p<e.length;p++)q=e[p],q&&q.Lf&&(r=this.Cf().unparse(this,q.Lf,0,p,!1,!0),s=o[p]||{},s.formula=r,o[p]=s);o.length>0&&(u.columnDataArray=o)}m(u)||(a.data=u)},b}(h.CalcSource),b.SheetSource=M,M.prototype.getParserContext=function(a,b,c){return b=b||h.pf(0,0),new K(this.kj,a,b,c)},N=function(a){O(b,a);function b(b){var c=a.call(this,n)||this;return c.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},c.Qu=b,c}return b.prototype.getCustomFunction=function(a){return this.Qu?this.Qu.getCustomFunction(a):n},b.prototype.getCustomName=function(a){var b=this.getCustomNameInfo(a);return b?b.getExpression():n},b.prototype.getCustomNameInfo=function(a){return this.Qu?this.Qu.getCustomName(a)||this.Qu.aJb(a):n},b}(h.CalcSource),b.SpreadSource=N;function P(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===o?0:c,e=e===o?0:e,i=new K(j,(!!f),h.pf(c,e)),g&&(i.culture=!0),k.parse(i,b)}b.formulaToExpression=P;function Q(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===o?0:c,e=e===o?0:e,i=new K(j,(!!f),h.pf(c,e)),i.YSa=g,k.unparse(i,b)}b.expressionToFormula=Q;function R(a,b,c,d,e){c===o&&(c=0),d===o&&(d=0);var f=P(a,b,c,d,e,!0);return S(a,f,c,d)}b.evaluateFormula=R;function S(a,b,c,d,e){var f,g,i=a.Cf();return c===o&&(c=a.getActiveRowIndex()),d===o&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==o&&(f=e.convertNullToZero),g=a.yj(),i.Hg(g,b,h.pf(c,d),!1,f)}b.evaluateExpression=S;function T(a,b,c,d,e){var f,j,k,l=a.row,m=a.col,o=a.row+a.rowCount-1,p=a.col+a.colCount-1,q=!1,r=!1,s=!1,t=!1;return arguments.length>=4&&(q=0!==(1&d),r=0!==(4&d),s=0!==(2&d),t=0!==(8&d),l-=q?b:0,o-=r?b:0,m-=s?c:0,p-=t?c:0),e&&(j=U(a,e,b),k=V(a,e,b),j&&k)?f=g.StructureReferenceResolver.create(e,j,k,a.col-e.dataRange().col,a.col+a.colCount-e.dataRange().col-1):(1===a.rowCount&&1===a.colCount?f=h.rf(n,n,l,m,q,s):(a.row<0&&(l=o=i.BAND_INDEX_CONST),a.col<0&&(m=p=i.BAND_INDEX_CONST),f=h.uf(n,n,l,m,o,p,q,s,r,t,b,c)),f)}b.rangeToExpression=T;function U(a,b,c){if(1===a.rowCount){if(b.hasHeadersRow()&&a.row===b.startRow())return 2;if(b.hasTotalsRow()&&a.row===b.endRow())return 8;if(c===a.row)return 1}else{if(b.hasHeadersRow()&&a.row===b.startRow()){if(a.rowCount===b.dataRange().rowCount+1)return 6;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1+1)return 14}if(a.row===b.dataRange().row){if(a.rowCount===b.dataRange().rowCount)return 3;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1)return 12}}return o}function V(a,b,c){return a.col===b.startColumn()&&a.colCount===b.dataRange().colCount?1:1===a.colCount?2:a.col>=b.startColumn()&&a.col+a.colCount-1<=b.endColumn()?4:o}function W(a,b,c,d,e){var f=T(a,b,c,d),g=new K(n,(!!e),h.pf(b,c)),i=new h.Parser,j=i.unparse(g,f);return g.no(),j}b.rangeToFormula=W;function X(a,b,c,d,e,f,g){var i=T(b,c,d,e,g),j=new K(a,(!!f),h.pf(c,d)),k=new h.Parser;return k.unparse(j,i)}b.rangeToFormulaWithStructReference=X;function Y(a,b,c,e){var f,g,i,j,k,l,m,n,o,p,q;if(!b)return null;if(c=c?c:0,e=e?e:0,f=a.Cf(),g=f.parse(a.yj(),b,c,e,!0,!0),j=!1,g)if(7===g.type&&"ANCHORARRAY"===g.functionName&&(g=g.arguments[0],j=!0),i=g.source,i&&13===g.type);else if(1===g.type&&g.endSource){for(k=g.source,l=g.endSource,m=k.getSources(l),n=!1,o=0;o<m.length;o++)if(m[o]===a.yj()){n=!0;break}g=n&&g}return!g||!g.getRange||i&&i!==a.yj()?null:(p=g.getRange(c,e))?(j&&(q=new h.CalcReference(a.ft,[p]).getSpillRef(),q&&q.yf&&(p=q.yf[0])),new d.Range(p.row,p.col,p.rowCount,p.colCount)):null}b.formulaToRange=Y;function Z(a,b,c,e,f,i){var j,k,l,n,p,q,r,s,t,u,v=[],w=[];if(!b)return v;for(j={},c=c||0,e=e||0,k=new h.Parser,l=g.qzb(k,b,a,c,e,o,f,i),n=0;n<l.length;n++)if(p=l[n].sheetRanges,p&&!m(p))for(q=0;q<p.sheets.length;q++)for(r=p.sheets[q],w=j[r],w||(j[r]=w=[],v.push({sheetName:r,ranges:w})),s=p[r],t=0;t<s.length;t++)u=s[t],B(u)||w.push(new d.Range(u.row,u.col,u.rowCount,u.colCount));return v}b.formulaToRanges=Z;function $(a,b,c,d,e){var f=new h.Parser,g=new K(n,(!!e),h.pf(b,c)),i=_(f,g,a,b,c,d);return g.no(),i}b.rangesToFormula=$;function _(a,b,c,d,e,f){var g,h,i,j="";for(g=0;g<c.length;g++)h=T(c[g],d,e,f),i=a.unparse(b,h),j+=g>0?", "+i:i;return j}b.ALb=_,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function aa(a,b,c,d,e,g,h){var i,j,k,l,m=d.getValue(b,c),n=!1,o=100,p=.001,q=.01,r=(C(m)?+m:0)-h,s=d.getValue(e,g),u=(C(s)?+s:0)-h;if(C(s)&&Math.abs(u)<p)n=!0;else if(t(s))n=!1;else for(i=r+(0===r?q:q*r),k=0;!n&&k<o;k++)i=f.Common.o.Lma(i,13),a.setValue(b,c,i),s=d.getValue(e,g),j=(C(s)?+s:0)-h,C(s)&&Math.abs(j)<p?n=!0:t(s)?i=(r+i)/2:r-i===0?i=r+(0===r?q:q*r):u-j===0?i=r+2*(i-r):(l=i-j*(r-i)/(u-j),r=i,u=j,i=l);return n||a.setValue(b,c,m),n}b.goalSeek=aa},"./dist/plugins/sheetsCalc/calc.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("Common"),f=c("./dist/plugins/sheetsCalc/calc.ns.js"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("Core"),i=e.Common.j.Ia,j=e.Common.j.Fa,k=e.Common.u,l=k.Nb,m=Math.min,n=Math.max,o=void 0,p=null,q=d.Convert.vf,r=d.Errors.Reference,s=h.util.l_a;function x(a,b){var c,d,e,f;return b||(b=this),c=n(a.row,b.row),d=n(a.column,b.column),e=m(a.row+a.rowCount,b.row+b.rowCount),f=m(a.column+a.columnCount,b.column+b.columnCount),c>=e||d>=f?p:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:x}}t=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.Rj=a,i.Vj=b,i.Wj=c,i.Qj=d,i.Tj=e,i.Uj=f,i.Xj=g,i.Yj=h}return a.prototype.Nj=function(a){var b,c,d=this,e=d.Qj.kj;return d.aYc=e&&e.KLc(),d.aYc&&a>=0?(b=a-d.Tj+1,c=e.NLc(d.Tj,b,!0),d.Tj-d.Vj+c):d.Tj-d.Vj},a.prototype.Oj=function(a){var b,c,d=this,e=d.Qj.kj;return d.aYc=e&&e.KLc(),d.aYc&&a>=0?(b=a-d.Uj+1,c=e.NLc(d.Uj,b),d.Uj-d.Wj+c):d.Uj-d.Wj},a.prototype.Sj=function(a,b,c,d,e){var f=this;return f.Rj===a&&(f.Vj===-1||f.Vj<=b&&b+d<=f.Vj+f.Xj)&&(f.Wj===-1||f.Wj<=c&&c+e<=f.Wj+f.Yj)},a.prototype.Pj=function(a,b,c,d,e){var f=this,g=f.Qj.kj,h=g&&g.KLc(),i=f.Tj,j=f.Uj,k=f.Xj,l=f.Yj;return h&&(k+=g.MLc(i,k,!0),l+=g.MLc(j,l)),f.Qj===a&&(i===-1||i<=b&&b+d<=i+k)&&(j===-1||j<=c&&c+e<=j+l)},a.prototype.intersectWith=function(a,b,c,d,e){var f,g,h=this;return h.Qj!==a?p:(f=h.Zj(a,b,c,d,e),g=h.Zj(a,h.Vj,h.Wj,d,e),g.intersectWith(f))},a.prototype.Zj=function(a,b,c,d,e){var f=b===-1?0:b,g=b===-1||d===-1?a.rowCount:d,h=c===-1?0:c,i=c===-1||e===-1?a.colCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:x}},a}(),b.MoveSwapInfo=t;function y(a,b,c,d){return(!d||a<b)&&c}function z(a){return[a.row,a.col,a.rowCount,a.colCount].join(",")}function A(a,b,c,d){var e=a[b];e||(e=a[b]={}),e[c]=d}function B(a,b,c){var d=a[b];return!!d&&d[c]}u=function(){function a(){}return a.zj=function(b,c,e,g,h,i,j,k,l,n,o){var p,q,s,t,u,v,w=e,x=a,y=this.zj;if(!e)return w;if(s=e.type,10===s)w=d.Lh(y.call(x,b,c,e.value,g,h,i,j,k,l,n,o));else if(1===s&&e.sf()){if(p=m((e.source||c).getRowCount(),f.MAX_ROW_COUNT),q=m((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+g<0||e.row+g>=p)||e.columnRelative&&(e.column+h<0||e.column+h>=q))return d.Hh(r,e.source);w=e.offset(0,0,!1)}else if(1===s){if(p=m((e.source||c).getRowCount(),f.MAX_ROW_COUNT),q=m((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),t=e,t.rowRelative&&!e.isFullColumn&&(t.row+g<0||t.row+g>p)||t.columnRelative&&!e.isFullRow&&(t.column+h<0||t.column+h>q)||t.endRowRelative&&!e.isFullColumn&&(t.endRow+g<0||t.endRow+g>p)||t.endColumnRelative&&!e.isFullRow&&(t.endColumn+h<0||t.endColumn+h>q))return d.Hh(r,e.source,e.endSource);w=e.offset(0,0,!1,g,h)}else if(9===e.type)w=d.Kh(e.operatorType,y.call(x,b,c,e.value,g,h,i,j,k,l,n,o),e.value2&&y.call(x,b,c,e.value2,g,h,i,j,k,l,n,o));else if(7===s){if(u=[],e.arguments&&e.arguments.length>0)for(v=0;v<e.arguments.length;v++)u[v]=y.call(x,b,c,e.arguments[v],g,h,i,j,k,l,n,o);w=d.Jh(e,u)}else 13===s&&(w=e.offsetWhenCopy(b,c,g,h,i,j,k,l,n,o));return w},a.copyFormula=function(b,c,e,f,g,h,i,j,k,l){var n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=b,$=f,_=b.getSource(),aa=f.getSource(),ba=a;if(Z&&$){for(n=aa&&aa.getSheet().ITa.dUa(),p=c,q=e,r=g,s=h,t=i,u=j,c<0&&(p=0,t=m(b.rC(),f.rC())),e<0&&(q=0,u=m(b.cC(),f.cC())),g<0&&(r=0),h<0&&(s=0),v=new d.CalcSourceModel(b.Cf(),_),A=aa.getSheet(),B=!l&&A.KLc(),C=t,D=u,E=A.getRowCount(),F=A.getColumnCount(),w=0;w<t;w++)for(x=0;x<u;x++)Z.Uf(v,w+p,x+q,w,x);for(G={},H=f.Cf(),w=0,y=0;w<t&&w+r<E;w++)if(I=w+r,B&&0===A.getRowHeight(I))t++;else if(k&&aa.isHiddenRow(I,!0))y++;else{for(x=0,z=0,u=D;x<u&&x+s<F;x++)if(J=x+s,B&&0===A.getColumnWidth(J))u++;else{if(K=v.Kf(y,z)){if(K===G)continue;if(L=g+w-c-y,M=h+x-e-z,K=ba.zj(_,aa,K,I,J,L,M,g,h,C,D),N=v.Qf(y,z),aa){if(B&&N)continue;if(N&&!N.isDynamicArray){for(O=N.rowCount,P=N.colCount,Q=p-N.row,Q>0&&(O-=Q),R=t-w,R<O&&(O=R),S=q-N.col,S>0&&(P-=S),T=u-x,T<P&&(P=T),U=0;U<O;U++)for(V=0;V<P;V++)v.Rf(w+U,x+V,G);f.setArrayFormula(I,J,O,P,H.unparse(aa,K,I,J),o,n)}else W=K?H.unparse(aa,K,I,J):o,aa.setFormula(I,J,W,o),X=v.Mf(y,z),X&&(Y=new d.EvaluateContext(aa,d.pf(I,J),(!1)),X=d.Mh(Y,K,!1,0,0,!0,!0),X=X===K?o:X),$.ig(I,J,K,X,N,n)}else $.Rf(I,J,K),$.Xf(I,J,N)}else $&&$.Kf(I,J)&&$.ig(I,J,o,o,o,n);z++}y++}}},a.moveFormula=function(a,b,c,d,e,f,g,i){var j,k,l,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=a.Bj(),P=d.Bj(),Q=O.Cf();if(O&&P){for(j=d.getRowCount(),k=d.getColumnCount(),l=O.dUa(),n=P.dUa(),q=Q.ih(),b<0&&(b=0,g=m(a.getRowCount(),j)),e<0&&(e=0),c<0&&(c=0,i=m(a.getColumnCount(),k)),f<0&&(f=0),r=!(a===d&&a.name()===d.name()),s=g,t=i,u=g,w=d.KLc(),w&&(s+=d.MLc(e,g,!0),t+=d.MLc(f,i)),O.Sg(b,c,g,i),qa(O,b,c,g,i),P.Sg(e,f,s,t),qa(P,e,f,s,t),x=[],y=0;y<g;y++)for(z=0;z<i;z++)A=O.Kf(y+b,z+c),B=O.Qf(y+b,z+c),C=O.Mf(y+b,z+c),A?(x.push({Lf:A,Pf:B,Nf:C}),O.Sf(y+b,z+c,l),(!B||B&&y+b===B.row&&z+c===B.col)&&O.xf.setFormula(y+b,z+c,p,o)):x.push(p);for(G=r?{}:null,y=0,D=0;y<u&&y+e<j;y++)if(H=y+e,w&&0===d.getRowHeight(H))u++;else{for(z=0,E=0,v=i;z<v&&f+z<k;z++)if(I=z+f,w&&0===d.getColumnWidth(I))v++;else{if(J=x[D*i+E]){if(A=J.Lf,B=J.Pf,w&&B){E++;continue}Q&&B&&!B.isDynamicArray&&B.row===b+y&&B.col===c+z&&(F=h.kf(H,I,B.rowCount,B.colCount)),K=B&&!B.isDynamicArray?F:o,C=J.Nf,P.FTa(n,H,I),P.Rf(H,I,A),P.Xf(H,I,K),P.Wf(H,I,C),(!K||K&&K.row===H&&K.col===I)&&(L=P.getFormula(H,I),P.xf.setFormula(H,I,L,K)),r&&(G[H+", "+I]=A)}else P.FTa(n,H,I),P.Rf(H,I,o),P.Xf(H,I,o);E++}D++}q.Dj(O,b,c,g,i),q.Dj(P,e,f,s,t),M=O.getSource().getSheet(),N=M.uja&&(M.parent||M).tja(),q.Ej(N,O.getSource(),b,c,P.getSource(),e,f,g,i,!0,G),r===!0&&q.Ej(N,O.getSource(),b,c,P.getSource(),e,f,g,i,!0,G)}},a.prototype.isAdjustCell=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.isAdjust=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.hh=function(a,b){var c=this,d,e;isNaN(b)||(c.imb||(c.imb={},c.jmb={}),d=c.imb[b],e=c.jmb[b],a&&!a.preAdj&&a!==d&&(d?e.nextAdj=a:c.imb[b]=a,a.preAdj=e,a.nextAdj=p,c.jmb[b]=a))},a.prototype.Fj=function(a,b){var c,d,e,f=this;isNaN(b)||(c=f.imb&&f.imb[b],a&&(a.preAdj||a===c)&&(d=a.preAdj,e=a.nextAdj,d?d.nextAdj=e:f.imb[b]=e,e?e.preAdj=d:f.jmb[b]=d,a.preAdj=p,a.nextAdj=p))},a.prototype.Gj=function(a,b,c,d,e,f,g){this.Hj(a,G,b,c,d,e,f,g);var h=0,i=0,j=0,k=0;0===b&&(d&&e?j=c:d?h=c:e?k=c:i=c),H(a,G,b,c,h,i,j,k,d,e),K(a,G,b,c,d,e)},a.prototype.Hj=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,z,C,D,E,F=this,G=F.imb;if(G){for(q={};G[0];)if(m=G[0],i=m.ah,p=i.dUa(),n=i.getSource(),j=m.row,k=m.column,B(q,j,k))F.Fj(m,0);else{if(l=i.Kf(j,k))if(l=b.call(F,n,j,k,l,a,c,d,e,f,o,g,h),r=i.Qf(j,k)){if(n===a&&(s=f?d:-d,e?c<=r.row&&(r.row+=s):c<=r.col&&(r.col+=s)),j===r.row&&k===r.col)if(r.isDynamicArray)i.fg(j,k,l,r,!0,y(e?j:k,c,p,a.id===n.id));else for(t=j;t<j+r.rowCount;t++)for(q[t]||(q[t]={}),u=k;u<k+r.colCount;u++)i.fg(t,u,l,r,t===j&&u===k,y(e?t:u,c,p,a.id===n.id)),A(q,t,u,!0)}else i.fg(j,k,l,r,!0,y(e?j:k,c,p,a.id===n.id));else(i.getRowExpression&&i.getRowExpression(j)||i.getColumnExpression&&i.getColumnExpression(k))&&i.Ag(j,k,1,1);F.Fj(m,0)}for(;G[1];)m=G[1],i=m.ah,p=i.dUa(),j=m.row,i.getRowExpression&&(l=i.getRowExpression(j),l&&i.fg&&(n=i.getSource(),i.fg(j,-1,b.call(F,n,j,-1,l,a,c,d,e,f),o,!0,y(j,c,p,a.id===n.id)))),F.Fj(m,1);for(;G[2];)m=G[2],i=m.ah,p=i.dUa(),k=m.column,i.getColumnExpression&&(l=i.getColumnExpression(k),l&&i.fg&&(n=i.getSource(),i.fg(-1,k,b.call(F,n,-1,k,l,a,c,d,e,f),o,!0,y(k,c,p,a.id===n.id)))),F.Fj(m,2);for(;G[3];)v=G[3],w=v.name,i=v.ah,l=i.DTa(w),x=b.call(F,i.getSource(),0,0,l,a,c,d,e,f,{isNameID:!0}),i.gg(w,x),F.Fj(v,3);for(z in G)if(C=+z,C>3&&G.hasOwnProperty(z))for(;G[z];)D=G[z],E=D.ah,l=b.call(F,E,0,0,D.expression,a,c,d,e,f),E.setExpression(D.id,D.name,l),F.Fj(D,C)}},a.prototype.ph=function(a){var b=this,c=a.getCalcSourceModel(),d=a.getRowCount(),e=a.getColumnCount();qa(c,0,0,d,e),b.Hj(a,R),H(a,R,0,0,0,0,0,0,!0,!1),K(a,R,0,0,!0,!1)},a.prototype.Ej=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,p,q,r,s,u,v,w,x,y,C,D,E,F,G,H,I,J,K,L,N=this,O=ma,P=new t(b,c,d,e,f,g,h,i),Q={};if(a&&na(a,P,j),M(b,P,j),s=N.imb,v={},s){for(;s[0];)if(m=s[0],l=m.ah,n=m.row,p=m.column,r=l.dUa(),B(Q,n,p))N.Fj(m,0);else{if(q=l.Kf(n,p),u=l.getSource(),q)if(w=o,k&&k[n+", "+p]&&(u=b,w={crossSheetMoved:!0}),q=O.call(N,u,n,p,q,P,j,w),x=l.Qf(n,p),y=void 0,x&&!x.isDynamicArray)if(y=z(x),n===x.row&&p===x.col)for(v[y]=!0,C=n;C<n+x.rowCount;C++)for(Q[C]||(Q[C]={}),D=p;D<p+x.colCount;D++)l.fg(C,D,q,x,C===n&&D===p,r),A(Q,C,D,!0);else v[y]||(l.fg(n,p,q,x,!1,r),A(Q,n,p,!0));else l.fg(n,p,q,x,!0,r);else(l.getRowExpression&&l.getRowExpression(n)||l.getColumnExpression&&l.getColumnExpression(p))&&l.Ag(n,p,1,1);N.Fj(m,0)}for(;s[1];)m=s[1],l=m.ah,n=m.row,r=l.dUa(),l.getRowExpression&&(q=l.getRowExpression(n),q&&l.jg&&l.jg(n,O.call(N,u,n,-1,q,P,j),o,r)),N.Fj(m,1);for(;s[2];)m=s[2],l=m.ah,p=m.column,r=l.dUa(),l.getColumnExpression&&(q=l.getColumnExpression(p),q&&l.kg&&l.kg(p,O.call(N,u,-1,p,q,P,j),o,r)),N.Fj(m,2);for(;s[3];)E=s[3],F=E.name,l=E.ah,q=l.DTa(F),G=O.call(N,u,0,0,q,P,j),l.gg(F,G),N.Fj(E,3);for(H in s)if(I=+H,I>3&&s.hasOwnProperty(H))for(;s[H];)J=s[H],K=J.ah,L=K.getSource(),q=O.call(N,L,0,0,J.expression,P,j),K.setExpression(J.id,J.name,q),N.Fj(J,I)}},a.prototype.Dj=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=b+d,m=c+e;for(h=b;h<l;h++)for(i=c;i<m;i++)f=a.Yf(h,i),g=a.Kf(h,i),(f||g)&&(k.Fj(f,0),a.Q3(h,i,0),j=a.qg(h,i,!0),f&&g&&(f.row!==j.row||f.column!==j.column)&&(j.oldRow=f.row,j.oldColumn=f.column),k.hh(j,0))},a.prototype.Ij=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(-1,d)||a.Kf(-1,d))&&(a.Q3(-1,d,2),e=a.sg(d,!0),f.hh(e,2))},a.prototype.Jj=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(d,-1)||a.Kf(d,-1))&&(a.Q3(d,-1,1),e=a.rg(d,!0),f.hh(e,1))},a.prototype.Kj=function(a){var b,c,e,f,g,h=this,i=a.Cf().getAllSourceModels();for(e=0;e<i.length;e++)if(f=i[e],f.lmb)for(b=f.lmb(),g=0;g<b.length;g++)c=b[g],c&&c.isVolatile&&c instanceof d.CellCalc&&!h.isAdjustCell(c)&&h.hh(c,0)},a.prototype.onBeforeAddRemoveRows=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(b,0,c-b,d),a.Ug(b,c-b),qa(a,b,-1,c-b,-1,!0)}})},a.prototype.onAfterAddRemoveRows=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(b,0,c,f):e+=c,g.Dj(a,b,0,e-b,f),g.Jj(a,b,e-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!0,d,o,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onAfterAddRemoveColumns=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(0,b,e,c):f+=c,g.Dj(a,0,b,e,f-b),g.Ij(a,b,f-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!1,d,o,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onBeforeAddRemoveColumns=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(0,b,c,d-b),a.Wg(b,d-b),qa(a,-1,b,-1,d-b,!0)}})},a.prototype.onAfterRemoveName=function(a,b){var c=a.wg(b,!1);c&&(c.updateListening(!0,!1),c.fh(),c.updateListeningOnRemoved())},a.prototype.adjustFormulaOnRemoveName=function(a,b,c){return ra(a,b,c)},a.prototype.invalidName=function(a,b){var c,d;b&&(c=a.getCalcSourceModel(),d=c.wg(b.toUpperCase(),!0),d&&d.Yg())},a.prototype.onAfterRemoveTable=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this;for(i=0;i<b.length;i++)j=b[i],qa(j.source().getCalcSourceModel(),j.startRow(),j.startColumn(),j.endRow()-j.startRow()+1,j.endColumn()-j.startColumn()+1);if(k=q.imb)for(l={};k[0];)if(m=k[0],d=m.ah,e=m.row,f=m.column,B(l,e,f))q.Fj(m,0);else{if(g=d.Kf(e,f))if(g=a.adjustExpressionOnRemoveTable(g,b,e,f,c),n=d.Qf(e,f),n&&!n.isDynamicArray)for(n=h.kf(e,f,n.rowCount,n.colCount),o=e;o<e+n.rowCount;o++)for(l[o]||(l[o]={}),p=f;p<f+n.colCount;p++)d.fg(o,p,g,n,o===e&&p===f),A(l,o,p,!0);else d.fg(e,f,g,n,!0);else(d.getRowExpression&&d.getRowExpression(e)||d.getColumnExpression&&d.getColumnExpression(f))&&d.Ag(e,f,1,1);q.Fj(m,0)}},a.adjustExpressionOnRemoveTable=function(b,c,e,f,g){var h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z=a.adjustExpressionOnRemoveTable;if(9===b.type){if(h=b.value,i=b.value2,j=z(h,c,e,f,g),k=i&&z(i,c,e,f,g),h!==j||i!==k)return d.Kh(b.operatorType,j,k)}else if(7===b.type){for(l=!1,m=[],n=0;n<b.arguments.length;n++)o=b.arguments[n],q=z(o,c,e,f,g),l=l||o!==q,m.push(q);if(l)return d.Jh(b,m)}else if(10===b.type){if(r=b,s=r.value,t=z(s,c,e,f,g),s!==t)return d.Lh(t)}else if(13===b.type)for(u=b,n=0;n<c.length;n++)if(u.baseTable===c[n])return g?d.Ih:(v=u.getRange(e===-1?0:e,f===-1?0:f,!0),w=e===-1||1===u.referencePortions(),x=1===v.rowCount&&1===v.columnCount,y=u.source,x?d.rf(y,p,v.row,v.col,w,!1):d.uf(y,p,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1,w,!1,w,!1));return b},a}(),b.CalcOperatorAdjustor=u,v=d.CalcService.prototype,v.uzb=function(){return new u};function C(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p;return c>=0||!e?(m=d+(e?c:0),n=f+(g?c:0),o=k&&O(h,a,k),p=!k&&O(h,a,k),(o||p)&&(!l&&i+j<=c||l&&i<=c)&&(m-=e?j:0,n-=g?j:0),o=k&&O(h,b,k),p=!k&&O(h,b,k),(o||p)&&(!l&&i<=m||l&&(e&&c+d>=i||!e&&d>=i)?(m+=j,
n+=j):(!l&&i<=n||l&&(g&&c+f>=i||!g&&f>=i))&&(n+=j)),m-=e?c:0,n-=g?c:0,l&&i+j<=c&&(m+=e?j:0,n+=g?j:0),{index:m,endIndex:n}):{index:d,endIndex:f}}function D(a,b,c,e,f,g,h,i,j,k,l,m){if(b&&!m){var n=j?f.row:f.column,o=j?f.rowRelative:f.columnRelative,p=void 0;if(j&&c>=0||!j&&e>=0||!o){if(k)p=C(a,b,j?c:e,n,o,-1,!1,g,h,i,j,l).index;else if(p=N(a,b,j?c:e,n,o,g,h,i,j,l),q(p))return d.Hh(p);p!==n&&(f=f.offset(j?p-n:0,j?0:p-n,!0))}}return f}function E(a,b,c,e,f,g,h,i,j,k,l,m){var n,o,p,r,s,t,u,v;if(b&&!m){if(n=f.tf(),3===n||j&&2===n||!j&&1===n)return f;if(o=j?f.rowRelative:f.columnRelative,p=j?f.endRowRelative:f.endColumnRelative,r=j?f.row:f.column,s=j?f.endRow:f.endColumn,t=void 0,j&&c>=0||!j&&e>=0||!o||!p){if(k)t=C(a,b,j?c:e,r,o,s,p,g,h,i,j,l);else if(t=P(a,b,j?c:e,r,o,s,p,g,h,i,j,l),q(t))return d.Hh(t);u=t.index,v=t.endIndex,u===r&&v===s||(f=f.offset2(j?u-r:0,j?0:u-r,j?v-s:0,j?0:v-s,c,e))}}return f}function F(a,b,c,d,e,f,g,h,i){if(b){var j=e;if(j&&f===j.source)return j.offsetWhenInsertRemoveColumn(g,h,i)}return e}function G(a,b,c,e,f,g,h,i,j,k,l,m){var n,q,r,s,t,u,v,w,x=G,y=e;if(e){if(1===e.type&&e.sf())y=D(a,e.source||a,b,c,e,f,g,h,i,j,l,m);else if(1===e.type)y=E(a,e.source||a,b,c,e,f,g,h,i,j,l,m);else if(10===e.type)n=x(a,b,c,e.value,f,g,h,i,j,o,l,m),n!==e.value&&(y=d.Lh(n));else if(9===e.type)q=x(a,b,c,e.value,f,g,h,i,j,o,l,m),r=e.value2&&x(a,b,c,e.value2,f,g,h,i,j,o,l,m),q===e.value&&r===e.value2||(y=d.Kh(e.operatorType,q,r));else if(7===e.type){for(s=p,t=void 0,u=void 0,v=e,w=v.arguments.length,u=0;u<w;u++)if(t=v.arguments[u],n=x(a,b,c,t,f,g,h,i,j,o,l,m),n!==t){s=[],s[u]=n;break}if(s){for(u=0;u<w;u++)t=v.arguments[u],s[u]!==o&&s[u]!==p||(s[u]=x(a,b,c,t,f,g,h,i,j,o,l,m));y=d.Jh(v,s)}}else l||i||13!==e.type||(y=F(a,a,b,c,e,f,g,h,j));return y}}function H(a,b,c,d,e,f,g,h,i,j){var k=function(e,f,g,h){return b.call(this,e,g,h,f,a,c,d,i,j)},l=a.getSheet(),m=l.uja&&(l.parent||l).tja(),n=l.ITa&&l.ITa.dUa();I(m,k,i,n)}function I(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(a)for(k=0;k<a.length;k++){for(l=!0,m=!0,n=g.maxRowCount-1,o=g.maxColumnCount-1,e=a[k].validator,p=e.n5,q=0,r=p.length;q<r&&(s=p[q],t=s.rowCount,u=s.colCount,i=s.row,j=s.col,t!==-1&&(m=!1,n=n>i?i:n),u!==-1&&(l=!1,o=o>j?j:o),l||m);q++);if(!(c&&m||!c&&l)&&(h=a[k].sheet,v=h.yj(),f=e.condition(),w=f.getExpressions(),w&&w.length>0)){for(x=0;x<w.length;x++)y=w[x],w[x]=b(v,y,n,o);f.setExpressions(w,d)}}}function J(a){var b=[],c=a.parent,d=c&&c.sheets||[a];return d.forEach(function(a){var c=a.conditionalFormats,d=c&&c.getRules();d&&d.length&&d.forEach(function(c){c.xyb&&b.push({rule:c,sheet:a})})}),b}function K(a,b,c,d,e,f){var g=function(g,h,i,j){return b.call(this,g,i,j,h,a,c,d,e,f)},h=a.getSheet(),i=J(h),j=h.ITa&&h.ITa.dUa();L(i,g,j,e,f)}function L(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(a)for(f=0,g=a.length;f<g;f++){if(h=a[f].rule,i=h.ranges(),j=s(i),k=j.r,l=j.c,m=a[f].sheet,n=m.yj(),o=h.condition(),p=m.tables,p&&i&&1===i.length&&(q=i[0],r=q.row,t=q.col,u=q.rowCount,v=q.colCount,w=void 0,e&&d?w=p.KFc(r,t,u,v):m.dJb&&m.zFc&&(w=[m.zFc]),w&&w.length)){for(x=!1,y=0,z=w.length;y<z;y++)if(A=w[y],B=A.row,C=A.col,D=A.rowCount,E=A.colCount,r===B&&u===D&&t>=C&&t+v<=C+E){x=!0;break}if(x)continue}if(o||(h.initCondition(),o=h.condition()),F=o&&o.getExpressions(),F&&F.length>0){for(G=0;G<F.length;G++)H=F[G],F[G]=b(n,H,k,l);o.setExpressions(F,c)}}}function M(a,b,c){var d=function(a,d,e,f){return ma.call(this,a,e,f,d,b,c)},e=a.getSheet(),f=J(e);L(f,d,e.ITa.dUa())}function N(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o;if(c>=0||!e){if(k=d+(e?c:0),l=i&&O(f,a,i),m=!i&&O(f,a,i),(l||m)&&g<=c&&(k+=e?h:0),l=i&&O(f,b,i),m=!i&&O(f,b,i),l||m)if(n=c+d,o=c+h+d,!j&&g+h<=k||j&&n>=g+h)k-=h;else if(!j&&g<=k||j&&n>=g&&g<=o&&o<=g+h)return r;return k-=e?c:0,j&&g<=c&&(k-=e?h:0),k}return d}function O(a,b,c){var d=c?{2:!0}:{1:!0};return a===b||a.kj===b.kj&&(3===a.Wz&&d[b.Wz]||d[a.Wz]&&3===b.Wz)}function P(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,s,t;if(c>=0||!e){if(m=d+(e?c:0),n=f+(g?c:0),o=i+j-1,p=k&&O(h,a,k),q=!k&&O(h,a,k),(p||q)&&i<=c&&(m+=e?j:0,n+=g?j:0),p=k&&O(h,b,k),q=!k&&O(h,b,k),p||q)if(s=c+d,t=c+f,!l&&o<m||l&&o<s)m-=j,n-=j;else{if(!l&&i<=m&&o>=n||l&&i<=s&&o>=t)return r;!l&&i>n||l&&i>t||(!l&&o<=n||l&&o<=t?(m=!l&&i>=m||l&&i>=s?m:i,n-=j):n=i-1)}return m-=e?c:0,n-=g?c:0,l&&i<=c&&(m-=e?j:0,n-=e?j:0),{index:m,endIndex:n}}return{index:d,endIndex:f}}function Q(a,b,c){var e,f,g,h,i,j,k,m,n,q,r,s,t,u,v,w,x=Q,y=b;if(b)if(b.source)if(h=b.source,i=b.endSource,i&&h!==i){if(j=h.kj&&h.kj.parent,!j)return d.Ih;i===c?(k=c.VDc,y.endSource=j.getSheet(k-1).yj()):h===c&&(m=c.VDc,y.source=j.getSheet(m).yj()),delete c.VDc,y.source===y.endSource&&delete y.endSource}else(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih);else if(10===b.type)e=x(a,b.value,c),e!==b.value&&(y=d.Lh(e));else if(9===b.type)n=x(a,b.value,c),q=b.value2&&x(a,b.value2,c),n===b.value&&q===b.value2||(y=d.Kh(b.operatorType,n,q));else if(7===b.type){for(r=p,s=b.arguments.length,g=0;g<s;g++)if(f=b.arguments[g],e=x(a,f,c),e!==f){r=[],r[g]=e;break}if(r){for(g=0;g<s;g++)f=b.arguments[g],r[g]!==o&&r[g]!==p||(r[g]=x(a,f,c));y=d.Jh(b,r)}}else 8===b.type&&(t=a||c,u=l(b.value),v=t.getCustomName(u),v&&v.source?h=v.source:(w=t.Af.getGlobalSourceModel()||t.getCalcSourceModel(),v=w.getSource().getCustomName(u),v&&v.source&&(h=v.source)),h&&(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih));return y}function R(a,b,c,d,e){return Q(a,d,e)}function S(a,b){return a.Qj===a.Rj&&b!==a.Qj}function T(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,q,r,s=!!e.source,t=e.source||a,u=e.rowRelative,v=e.columnRelative,w=b,x=c,y=f.Qj.kj;if(g&&g.isCustomName&&(l=e.row,m=e.column,w=f.Tj+(l-f.Vj)+y.MLc(f.Tj,l-f.Vj+1,!0),x=f.Uj+(m-f.Wj)+y.MLc(f.Uj,m-f.Wj+1)),n=f.Nj(w),o=f.Oj(x),(b>=0||!u)&&(c>=0||!v)){if(h=e.row+(u?b:0),i=e.column+(v?c:0),g&&g.isNameID||a===f.Rj&&(a===f.Qj?k=f.Pj(f.Qj,b,c,1,1):(q=b,r=c,g&&g.crossSheetMoved&&(q-=n,r-=o),k=f.Sj(f.Rj,q,r,1,1))),t===f.Qj&&f.Pj(t,h,i,1,1)&&!f.Sj(t,h,i,1,1)&&(!u&&!v||!k))return d.Ih;if(j=(s&&t===f.Rj||!s&&a===f.Rj)&&(!k&&f.Sj(f.Rj,h,i,1,1)||k&&f.Pj(f.Qj,u?h:h+n,v?i:i+o,1,1)),k&&(h-=u?n:0,i-=v?o:0),j&&(h+=n,i+=o),h-=u?b:0,i-=v?c:0,t=e.source,f.Rj!==f.Qj&&(j&&k?s&&(t=f.Qj):j?t=f.Qj:k&&!s&&(t=f.Rj)),h!==e.row||i!==e.column||t!==e.source)return d.rf(t,p,h,i,u,v)}else if((b>=0||!u)&&c===-1){if(h=e.row+(u?b:0),f.Pj(a,b,c,1,1)&&(h-=u?n:0),f.Sj(t,h,-1,1,-1))h+=n;else if(f.Pj(t,h,-1,1,-1))return d.Ih;if(h-=u?b:0,h!==e.row)return d.rf(e.source,p,h,e.column,u,e.columnRelative)}else if(b===-1&&c>=0&&!v){if(i=e.column+(v?c:0),f.Pj(a,b,c,1,1)&&(i-=v?o:0),f.Sj(t,h,i,1,1))i+=o;else if(f.Pj(t,h,i,1,1))return d.Ih;if(i-=v?c:0,h!==e.row||i!==e.column)return d.rf(e.source,e.endSource,e.row,i,e.rowRelative,v)}return e}function U(a,b){if(b=a.getIntersect(b,0,0),!b)return p;var c=a.row,d=a.col,e=a.rowCount,f=a.colCount;return a.rowCount===b.rowCount&&a.colCount===b.colCount||(a.rowCount===b.rowCount?(a.col===b.col&&(d=a.col+b.colCount),f=a.colCount-b.colCount):a.colCount===b.colCount&&(a.row===b.row&&(c=a.row+b.rowCount),e=a.rowCount-b.rowCount)),h.kf(c,d,e,f)}function V(a,b,c,d,e){var f,g;return!(!b||!a)&&(f=b.getIntersect(a,0,0),!(f||!(g=b.getIntersect(c,0,0)))||(!(!f||f.rowCount!==b.rowCount||0===e)||!(!f||f.colCount!==b.colCount||0===d)))}function W(a,b,c){var d=a.getRange(b,c);return h.kf(d.row,d.col,d.rowCount,d.colCount)}function X(a,b,c,d){var e,f=U(a,b);return f?(e=f.union(c),d?(e.col=a.col,e.colCount=a.colCount):(e.row=a.row,e.rowCount=a.rowCount)):e=c,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function Y(a,b,c,d,e){var f,g=U(a,b),h=a.getIntersect(b,0,0);return h?(h.row+=d,h.col+=e,f=g?g.union(h):c,{startRow:f.row,endRow:f.row+f.rowCount-1,startColumn:f.col,endColumn:f.col+f.colCount-1}):p}function Z(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount;return 1===e&&1!==f?h<d&&d<=h+j-1||h<=d+f-1&&d+f-1<h+j-1:1!==f||1===e||(g<c&&c<=g+i-1||g<=c+e-1&&c+e-1<g+i-1)}function $(a,b,c,d,e,f){var g,i,j,k,l=W(d,e,f),m=l.row,n=l.row+l.rowCount-1,o=l.col,p=l.col+l.colCount-1,q=a.Vj,r=q+a.Xj-1,s=a.Wj,t=s+a.Yj-1,u=a.Tj,v=a.Uj,w=h.kf(q,s,a.Xj,a.Yj),x=h.kf(u,v,a.Xj,a.Yj),y=l.getIntersect(x,0,0);if(V(w,l,x,b,c))if(i=0!==b,j=void 0,k=void 0,i)if(j=m>=q&&m<=r,k=n>=q&&n<=r,j&&k)m+=b,n+=b;else if(j&&!k)if(b<=0)m+=b;else if(q+b>n);else{if(!(r+b<n))return Y(l,w,x,b,c);if(q===m)return X(l,w,x,i);m+=b}else if(!j&&k)if(b>=0)n+=b;else if(r+b<m);else{if(!(u>m))return Y(l,w,x,b,c);if(r===n)return X(l,w,x,i);n+=b}else y&&!y.equals(x)&&Z(l,x)&&(g=U(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);else if(j=o>=s&&o<=t,k=p>=s&&p<=t,j&&k)o+=c,p+=c;else if(j&&!k)if(c<0)o+=c;else if(s+c>p);else{if(!(t+c<p))return Y(l,w,x,b,c);if(s===o)return X(l,w,x,i);o+=c}else if(!j&&k)if(c>0)p+=c;else if(t+c<o);else{if(!(v>o))return Y(l,w,x,b,c);if(t===p)return X(l,w,x,i);p+=c}else y&&!y.equals(x)&&Z(l,x)&&(g=U(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);return{startRow:m,endRow:n,startColumn:o,endColumn:p}}function _(a,b,c,d){return c>b||c+d-1<a}function aa(a,b,c,d){return c<=a&&c+d-1>=b}function ba(a,b,c,d){return c>a&&c+d-1<b}function ca(a,b,c,d){return c===a&&c+d-1<b||c>a&&c+d-1===b}function da(a,b,c,d){return c<a&&c+d-1>=a&&c+d-1<b||c>a&&c<=b&&c+d-1>b}function ea(a,b,c,d,e){return c<=a&&e<=a||c+d-1>=b&&e+d-1>=b}function fa(a,b,c,d,e){var f,g,h=[_,aa,ba,ca,da];for(g=0;g<h.length;g++)if(h[g](a,b,c,d)){f=g+"_";break}if(c===e)f+="9";else for(g=0;g<h.length;g++)if(c!==e&&h[g](a,b,e,d)){f+=g;break}return f}function ga(a,b,c,d,e){return{row:n(a.startRow,b),col:n(a.startColumn,c),endRow:m(a.endRow,d),endCol:m(a.endColumn,e)}}!function(a){a.outToOut="0_0",a.outToCover="0_1",a.outToInside="0_2",a.outToPart="0_3",a.outToCross="0_4",a.outNoMove="0_9",a.coverToOut="1_0",a.coverToCover="1_1",a.coverToCross="1_4",a.coverNoMove="1_9",a.insideToOut="2_0",a.insideToInside="2_2",a.insideToPart="2_3",a.insideToCross="2_4",a.insideNoMove="2_9",a.partToOut="3_0",a.partToInside="3_2",a.partToPart="3_3",a.partToCross="3_4",a.partNoMove="3_9",a.crossToOut="4_0",a.crossToCover="4_1",a.crossToInside="4_2",a.crossToPart="4_3",a.crossToCross="4_4",a.crossNoMove="4_9"}(w||(w={}));function ha(a,b,c,d,e){return a===e.Qj&&e.Tj<=b&&b<=e.Xj+e.Tj-1&&e.Uj<=c&&c<=e.Yj+e.Uj-1&&(b=b+e.Vj-e.Tj,c=c+e.Wj-e.Uj),{startRow:d.row+(d.rowRelative?b:0),endRow:d.endRow+(d.endRowRelative?b:0),startColumn:d.column+(d.columnRelative?c:0),endColumn:d.endColumn+(d.endColumnRelative?c:0)}}function ia(a,b,c,e,f,g,h,i,k){return j(g)&&(g=b.startRow),j(h)&&(h=b.startColumn),j(i)&&(i=b.endRow),j(k)&&(k=b.endColumn),d.uf(f||a.source,p,a.rowRelative?g-c:g,a.columnRelative?h-e:h,a.endRowRelative?i-c:i,a.endColumnRelative?k-e:k,a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,c,e)}function ja(a,b,c,e,f){var g,h,i,j,k,l,o,q,r,s,t=ha(a,b,c,e,f),u=e.source||a;if(f.Rj===u&&f.Qj===u)switch(g=fa(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj),h=fa(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj),i=g+"-"+h,j=f.Tj-f.Vj,k=f.Uj-f.Wj,l=ga(t,f.Vj,f.Wj,f.Vj+f.Xj-1,f.Wj+f.Yj-1),o=void 0,q=void 0,r=void 0,s=void 0,i){case w.outToCover+"-"+w.outToCover:case w.crossToCover+"-"+w.outToCover:case w.outToCover+"-"+w.crossToCover:case w.crossToCover+"-"+w.crossToCover:case w.coverToCover+"-"+w.outToCover:case w.outToCover+"-"+w.coverToCover:case w.coverNoMove+"-"+w.outToCover:case w.outToCover+"-"+w.coverNoMove:return d.Ih;case w.outToCross+"-"+w.outToCover:case w.coverToCross+"-"+w.outToCover:case w.insideToCross+"-"+w.outToCover:case w.partToCross+"-"+w.outToCover:case w.crossToCross+"-"+w.outToCover:case w.crossNoMove+"-"+w.outToCover:case w.outToCross+"-"+w.coverNoMove:case w.outToCross+"-"+w.coverToCover:case w.outToCross+"-"+w.crossToCover:case w.insideToCross+"-"+w.coverNoMove:case w.insideToCross+"-"+w.coverToCover:case w.insideToCross+"-"+w.crossToCover:return f.Tj<=t.startRow?ia(e,t,b,c,p,f.Tj+f.Xj):ia(e,t,b,c,p,p,p,f.Tj-1);case w.outToCover+"-"+w.outToCross:case w.outToCover+"-"+w.coverToCross:case w.outToCover+"-"+w.insideToCross:case w.outToCover+"-"+w.partToCross:case w.outToCover+"-"+w.crossToCross:case w.outToCover+"-"+w.crossNoMove:case w.coverNoMove+"-"+w.outToCross:case w.coverToCover+"-"+w.outToCross:case w.crossToCover+"-"+w.outToCross:case w.coverNoMove+"-"+w.insideToCross:case w.coverToCover+"-"+w.insideToCross:case w.crossToCover+"-"+w.insideToCross:return f.Uj<t.startColumn?ia(e,t,b,c,p,p,f.Uj+f.Yj):ia(e,t,b,c,p,p,p,p,f.Uj-1);case w.partToOut+"-"+w.coverNoMove:case w.crossToOut+"-"+w.coverNoMove:if(!ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return ia(e,t,b,c);case w.coverNoMove+"-"+w.partToOut:case w.coverNoMove+"-"+w.crossToOut:if(g===w.coverNoMove&&!ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return ia(e,t,b,c);case w.crossToInside+"-"+w.coverNoMove:case w.coverNoMove+"-"+w.crossToInside:return t.startRow>=f.Vj&&h===w.coverNoMove||t.startColumn>=f.Wj&&g===w.coverNoMove?ia(e,t,b,c,p,l.row+j,l.col+k):ia(e,t,b,c,p,p,p,l.endRow+j,l.endCol+k);case w.partToInside+"-"+w.coverNoMove:return t.startRow>=f.Vj?ia(e,t,b,c,p,m(l.row+j,l.endRow+1)):ia(e,t,b,c,p,p,p,n(l.endRow+j,l.row-1));case w.coverNoMove+"-"+w.partToInside:return t.startColumn>=f.Wj&&g===w.coverNoMove?ia(e,t,b,c,p,p,m(l.col+k,l.endCol+1)):ia(e,t,b,c,p,p,p,p,n(l.endCol+k,l.col-1));case w.partToCross+"-"+w.coverNoMove:case w.crossToPart+"-"+w.coverNoMove:case w.crossToCross+"-"+w.coverNoMove:if(ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return t.startRow>=f.Vj?ia(e,t,b,c,p,l.row+j):ia(e,t,b,c,p,p,p,l.endRow+j);case w.crossToCover+"-"+w.coverNoMove:case w.partToPart+"-"+w.coverNoMove:return f.Vj<f.Tj?ia(e,t,b,c,p,m(l.row+j,l.endRow+1),p,l.endRow+j):ia(e,t,b,c,p,l.row+j,p,n(l.endRow+j,l.row-1));case w.coverNoMove+"-"+w.partToCross:case w.coverNoMove+"-"+w.crossToPart:case w.coverNoMove+"-"+w.crossToCross:if(ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return t.startColumn>=f.Wj?ia(e,t,b,c,p,p,l.col+k):ia(e,t,b,c,p,p,p,p,l.endCol+k);case w.coverNoMove+"-"+w.crossToCover:case w.coverNoMove+"-"+w.partToPart:return f.Wj<f.Uj?ia(e,t,b,c,p,p,m(l.col+k,l.endCol+1),p,l.endCol+k):ia(e,t,b,c,p,p,l.col+k,p,n(l.endCol+k,l.col-1));case w.crossToCross+"-"+w.coverToCover:case w.crossToPart+"-"+w.coverToCover:case w.partToCross+"-"+w.coverToCover:if(ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return ia(e,t,b,c);case w.coverToCover+"-"+w.crossToCross:case w.coverToCover+"-"+w.crossToPart:case w.coverToCover+"-"+w.partToCross:if(g===w.coverToCover&&ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return ia(e,t,b,c);case w.coverToCover+"-"+w.partToPart:case w.partToPart+"-"+w.coverToCover:case w.coverToCover+"-"+w.crossToCover:case w.crossToCover+"-"+w.coverToCover:return ia(e,t,b,c,p,l.row+j,l.col+k,l.endRow+j,l.endCol+k);case w.partToPart+"-"+w.crossToCover:case w.partToCross+"-"+w.crossToCover:case w.crossToPart+"-"+w.crossToCover:case w.crossToCross+"-"+w.crossToCover:return ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj)?ia(e,t,b,c):(l.row===t.startRow?l.col===t.startColumn?(r=t.endColumn,s=l.col+k,o=l.endRow+j,q=l.row+j):(r=t.startColumn,s=l.endCol+k,o=g===w.partToCross||g===w.crossToCross?f.Vj+j-1:t.endRow,q=t.startRow):l.col===t.startColumn?(r=t.endColumn,s=l.col+k,o=t.endRow,q=g===w.partToCross||g===w.crossToCross?f.Vj+f.Xj-1+j+1:t.startRow):(r=t.startColumn,s=l.endCol+k,o=g===w.partToCross||g===w.crossToCross?l.row+j:t.startRow,q=l.endRow+j),ia(e,t,b,c,p,m(o,q),m(r,s),n(o,q),n(r,s)));case w.crossToCover+"-"+w.partToPart:case w.crossToCover+"-"+w.partToCross:case w.crossToCover+"-"+w.crossToPart:case w.crossToCover+"-"+w.crossToCross:return ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj)?ia(e,t,b,c):(l.row===t.startRow?l.col===t.startColumn?(r=l.endCol+k,s=l.col+k,o=t.endRow,q=l.row+j):(r=t.endColumn,s=h===w.partToCross||h===w.crossToCross?f.Wj+f.Yj-1+k+1:t.startColumn,o=t.endRow,q=l.row+j):l.col===t.startColumn?(r=t.startColumn,s=h===w.partToCross||h===w.crossToCross?f.Wj+k-1:t.endColumn,o=l.endRow+j,q=t.startRow):(r=h===w.partToCross||h===w.crossToCross?l.col+k:t.startColumn,s=l.endCol+k,o=t.startRow,q=l.endRow+j),ia(e,t,b,c,p,m(o,q),m(r,s),n(o,q),n(r,s)));case w.coverToOut+"-"+w.coverToOut:case w.coverToOut+"-"+w.coverToCross:case w.coverToOut+"-"+w.coverToCover:case w.coverToOut+"-"+w.coverNoMove:case w.coverToCross+"-"+w.coverToOut:case w.coverToCross+"-"+w.coverToCross:case w.coverToCross+"-"+w.coverToCover:case w.coverToCross+"-"+w.coverNoMove:case w.coverToCover+"-"+w.coverToOut:case w.coverToCover+"-"+w.coverToCross:case w.coverToCover+"-"+w.coverToCover:case w.coverToCover+"-"+w.coverNoMove:case w.coverNoMove+"-"+w.coverToOut:case w.coverNoMove+"-"+w.coverToCross:case w.coverNoMove+"-"+w.coverToCover:return ia(e,t,b,c,p,t.startRow+j,t.startColumn+k,t.endRow+j,t.endColumn+k);default:return ia(e,t,b,c)}}function ka(a,b,c,e,f,g,h,i){var j,k,l,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=!!e.source,O=N?e.source:a,P=g&&g.isDataValidator,Q=S(f,a),R=!1,T=e.rowRelative,U=e.columnRelative,V=e.endRowRelative,W=e.endColumnRelative;if(b>=0||!T||!V||c>=0||!U||!W){if(j=e.row+(T?b:0),k=e.endRow+(V?b:0),l=e.column+(U?c:0),m=e.endColumn+(W?c:0),n=k-j+1,q=m-l+1,!P&&Q){if(z=f.Sj(O,j,l,n,q))return e.offset(h,i,!0);if(f.Pj(O,j,l,n,q))return d.Ih;if(O!==f.Rj||O!==f.Qj||0!==h&&0!==i)return e;R=!0}if(g&&g.isNameID||a===f.Rj&&(a===f.Qj?y=f.Pj(f.Qj,b,c,1,1):(A=b,B=c,g&&g.crossSheetMoved&&(A-=h,B-=i),y=f.Sj(f.Rj,A,B,1,1))),(R||a===O&&a===f.Rj&&a===f.Qj)&&(C=b,D=c,y&&(C-=h,D-=i),0===h||0===i)){if(E=$(f,h,i,e,C,D),!E)return d.Ih;if(0===i&&h&&E.endColumn>=m&&E.startColumn<=l||0===h&&i&&E.endRow>=k&&E.startRow<=j)return F=E.startRow,G=E.startColumn,H=E.endRow,I=E.endColumn,F===j&&H===k&&G===l&&I===m?e:(T&&(F-=b),V&&(H-=b),U&&(G-=c),W&&(I-=c),d.uf(e.source,p,F,G,H,I,T,U,V,W,b,c))}if(y&&(J=f.Tj-f.Vj,K=f.Uj-f.Wj,n+=(T?-J:0)+(V?J:0),q+=(U?-K:0)+(W?K:0)),O===f.Qj&&f.Pj(O,j,l,n,q)&&!q&&(!T&&!U&&!V&&!W||!y))return d.Ih;if(x=(N&&O===f.Rj||!N&&a===f.Rj)&&(!y&&f.Sj(f.Rj,j,l,n,q)||y&&f.Pj(f.Qj,T?j:j+h,U?l:l+i,n,q)),y&&(t=T?h:0,u=V?h:0,v=U?i:0,w=W?i:0,j-=t,k-=u,l-=v,m-=w),L=!1,x)r=h,s=i,j+=r,k+=r,l+=s,m+=s;else if(f.Pj(O,j,l,n,q)){if(M=f.intersectWith(O,j,l,n,q),!M||M.rowCount!==n&&M.colCount!==q)return d.Ih;j=M.row+h,l=M.col+i,k=j+M.rowCount,m=l+M.colCount,L=!0}if(j-=T?b:0,k-=V?b:0,l-=U?c:0,m-=W?c:0,f.Rj===f.Qj?O=N?e.source:o:(O=e.source,x&&y&&N?O=f.Qj:x&&y||(x?O=f.Qj:y&&!N&&(O=f.Rj))),j!==e.row||l!==e.column||k!==e.endRow||m!==e.endColumn||L||O!==e.source)return d.uf(O,p,j,l,k,m,T,U,V,W,b,c)}else if(!(b>=0)&&T&&V||c!==-1){if(b===-1&&(c>=0||!U||!W)){if(l=e.column+(U?c:0),m=e.endColumn+(W?c:0),l>m)return d.Ih;if(f.Pj(a,b,c,1,1)&&(v=U?i:0,w=W?i:0,l-=v,m-=w),q=m-l+1,f.Sj(O,-1,l,-1,q))s=i,l+=s,m+=s;else if(f.Pj(O,-1,l,-1,q))return d.Ih;if(l-=U?c:0,m-=W?c:0,l!==e.column||m!==e.endColumn)return d.uf(e.source,p,e.row,l,e.endRow,m,e.rowRelative,U,e.endRowRelative,W,b,c)}}else{if(j=e.row+(T?b:0),k=e.endRow+(V?b:0),j>k)return d.Ih;if(f.Pj(a,b,c,1,1)&&(t=T?h:0,u=V?h:0,j-=t,k-=u),n=k-j+1,f.Sj(O,j,-1,n,-1))r=h,j+=r,k+=r;else if(f.Pj(O,j,-1,n,-1))return d.Ih;if(j-=T?b:0,k-=V?b:0,j!==e.row||k!==e.endRow)return d.uf(e.source,p,j,e.column,k,e.endColumn,T,e.columnRelative,V,e.endColumnRelative,b,c)}}function la(a,b,c,e,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=!!e.source,L=K?e.source:a,M=e.tf(),N=b,O=c,P=g.Qj.kj;if(h&&h.isCustomName&&(r=e.row,s=e.column,N=g.Tj+(r-g.Vj)+P.MLc(g.Tj,r-g.Vj+1,!0),O=g.Uj+(s-g.Wj)+P.MLc(g.Uj,s-g.Wj+1)),t=g.Nj(N),u=g.Oj(O),0===M){if(v=!g.aYc&&ja(a,b,c,e,g))return v;if(v=ka(a,b,c,e,g,h,t,u))return v}else if(1===M){if(i=e.rowRelative,k=e.endRowRelative,b>=0||!i||!k){if(m=e.row+(i?b:0),n=e.endRow+(k?b:0),m>n)return d.Ih;if(q=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),L===g.Rj&&L===g.Qj&&0===g.Wj&&0===g.Uj&&g.Yj===L.getColumnCount()){if(w=g.Vj,x=g.Tj,y=g.Xj,q&&(m-=t,n-=t),z=w+y,A=m>=w&&z>m,B=n>=w&&z>n,A&&B)return q?e:e.offset(t,u,!0);if(C=x+y,A&&x<=n?(m+=t,C>n&&n>=x&&(n=C-1,m=z)):B&&C>=m&&(n+=t,x<=m&&o<C&&(m=x,n=w-1)),m-=i?b:0,n-=k?b:0,m!==e.row||n!==e.endRow)return d.uf(e.source,e.endSource,m,f.BAND_INDEX_CONST,n,f.BAND_INDEX_CONST,i,j,k,l,b,c)}if(q)return e.offset(-t,u,!0)}}else if(2===M){if(j=e.columnRelative,l=e.endColumnRelative,o=e.column+(j?c:0),p=e.endColumn+(l?c:0),o>p)return d.Ih;if(q=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),L===g.Rj&&L===g.Qj&&0===g.Vj&&0===g.Tj&&g.Xj===L.getRowCount()){if(D=g.Wj,E=g.Uj,F=g.Yj,q&&(o-=u,p-=u),G=D+F,H=o>=D&&G>o,I=p>=D&&G>p,H&&I)return q?e:e.offset(t,u,!0);if(J=E+F,H&&E<=p?(o+=u,J>p&&p>=E&&(p=J-1,o=G)):I&&J>=o&&(p+=u,E<=o&&o<J&&(o=E,p=D-1)),o-=j?c:0,p-=l?c:0,o!==e.column||p!==e.endColumn)return d.uf(e.source,e.endSource,f.BAND_INDEX_CONST,o,f.BAND_INDEX_CONST,p,i,j,k,l,b,c)}if(q)return e.offset(t,-u,!0,b,c)}return e}function ma(a,b,c,e,f,g,h){var i,j,k,l,m,n,q,r=ma,s=e;if(1===e.type&&e.sf())s=g?T(a,b,c,e,f,h):oa(a,b,c,e,f);else if(1===e.type)s=g?la(a,b,c,e,f,h):pa(a,b,c,e,f);else if(10===e.type)i=r(a,b,c,e.value,f,g,h),i!==e.value&&(s=d.Lh(i));else if(9===e.type)j=r(a,b,c,e.value,f,g,h),k=e.value2&&r(a,b,c,e.value2,f,g,h),j===e.value&&k===e.value2||(s=d.Kh(e.operatorType,j,k));else if(7===e.type){for(l=p,m=void 0,n=void 0,q=e.arguments.length,n=0;n<q;n++)if(m=e.arguments[n],i=r(a,b,c,m,f,g,h),i!==m){l=[],l[n]=i;break}if(l){for(n=0;n<q;n++)m=e.arguments[n],l[n]!==o&&l[n]!==p||(l[n]=r(a,b,c,m,f,g,h));s=d.Jh(e,l)}d.isExpression(e.function)&&(s.function=r(a,b,c,e.function,f,g,h))}return s}b.adjustFormulaOnMoveSwap=ma;function na(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=b.Rj.getSheet().ITa.dUa();for(d=0;d<a.length;d++)if(e=a[d].validator,f=e.n5,g=s(f),h=g.r,i=g.c,j=a[d].sheet,k=j.yj(),l=e.condition(),m=l.getExpressions(),m&&m.length>0){for(n=0;n<m.length;n++)o=m[n],m[n]=ma(k,h,i,o,b,c,{isDataValidator:!0});l.setExpressions(m,p)}}function oa(a,b,c,e,f){var g,h,i=e.source||a,j=e.rowRelative,k=e.columnRelative,l=f.Nj(b),m=f.Oj(c);if((b>=0||!j)&&(c>=0||!k)){if(g=e.row+(j?b:0),h=e.column+(k?c:0),f.Pj(a,b,c,1,1)?(g-=j?l:0,h-=k?m:0):f.Sj(a,g,h,1,1)&&(g+=j?l:0,h+=k?m:0),f.Sj(i,g,h,1,1)?(g+=l,h+=m):f.Pj(i,g,h,1,1)&&(g-=l,h-=m),g-=j?b:0,h-=k?c:0,g!==e.row||h!==e.column)return d.rf(e.source,p,g,h,j,k)}else if((b>=0||!j)&&c===-1){if(g=e.row+(j?b:0),f.Pj(a,b,-1,1,-1)?g-=j?l:0:f.Sj(a,g,-1,1,-1)&&(g+=j?l:0),f.Sj(i,g,-1,1,-1)?g+=l:f.Pj(i,g,-1,1,-1)&&(g-=l),g-=j?b:0,g!==e.row||h!==e.column)return d.rf(e.source,p,g,e.column,j,e.columnRelative)}else if(b===-1&&c>=0&&!k&&(h=e.column+0,f.Pj(a,-1,c,-1,1)?h-=0:f.Sj(a,-1,h,-1,1)&&(h+=0),f.Sj(i,-1,h,-1,1)?h+=m:f.Pj(i,-1,h,-1,1)&&(h-=m),h-=0,g!==e.row||h!==e.column))return d.rf(e.source,p,e.row,h,e.rowRelative,k);return e}function pa(a,b,c,e,g){var h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y=e.source||a,z=e.tf(),A=g.Nj(b),B=g.Oj(c);if(0===z){if(n=e.rowRelative,o=e.columnRelative,q=e.endRowRelative,r=e.endColumnRelative,!(b>=0)&&n&&q||!(c>=0)&&o&&r)if(!(b>=0)&&n&&q||c!==-1){if(b===-1&&(c>=0||!o||!r)){if(j=e.column+(o?c:0),k=e.endColumn+(r?c:0),j<k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=o?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=o?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=o?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,p,j,e.endRow,k,e.rowRelative,o,e.endRowRelative,r,b,c)}}else{if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=n?A:0,w=n?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=n?A:0,w=n?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=n?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,p,h,e.column,i,e.endColumn,n,e.columnRelative,q,e.endColumnRelative,b,c)}else if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),j=e.column+(o?c:0),k=e.endColumn+(r?c:0),l=i-h,m=k-j,g.Pj(a,b,c,1,1)?(u=n?A:0,v=o?B:0,w=q?A:0,x=r?B:0,h-=u,i-=w,j-=v,k-=x):g.Sj(a,h,j,l,m)&&(u=n?A:0,v=o?B:0,w=q?A:0,x=r?B:0,h+=u,i+=w,j+=v,k+=x),g.Sj(y,h,j,l,m)?(s=A,t=B,h+=s,i+=s,j+=t,k+=t):g.Pj(y,h,j,l,m)&&(s=A,t=B,h-=s,i-=s,j-=t,k-=t),h-=n?b:0,i-=q?b:0,j-=o?c:0,k-=r?c:0,h!==e.row||j!==e.column||i!==e.endRow||k!==e.endColumn)return d.uf(e.source,p,h,j,i,k,n,o,q,r,b,c)}else if(1===z){if(n=e.rowRelative,q=e.endRowRelative,b>=0||!n||!q){if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=n?A:0,w=q?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=n?A:0,w=q?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=n?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,p,h,f.BAND_INDEX_CONST,i,f.BAND_INDEX_CONST,n,!1,q,!1,b,c)}}else if(2===z){if(o=e.columnRelative,r=e.endColumnRelative,j=e.column+(o?c:0),k=e.endColumn+(r?c:0),j>k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=o?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=o?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=o?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,p,f.BAND_INDEX_CONST,j,f.BAND_INDEX_CONST,k,!1,o,!1,r,b,c)}return e}function qa(a,b,c,d,e,f){a._g(b,c,d,e,!0,!1,f)}function ra(a,b,c){var e,f,g,h,i,j,k,l=ra,m=b;if(8===b.type){if(b.value===c&&(!b.source||b.source===a.getSource()))return d.Hh(r,b.source)}else if(10===b.type)e=l(a,b.value,c),e!==b.value&&(m=d.Lh(e));else if(9===b.type)h=l(a,b.value,c),i=b.value2&&l(a,b.value2,c),h===b.value&&i===b.value2||(m=d.Kh(b.operatorType,h,i));else if(7===b.type){for(j=p,k=b.arguments.length,g=0;g<k;g++)if(f=b.arguments[g],e=l(a,f,c),e!==f){j=[],j[g]=e;break}if(j){for(g=0;g<k;g++)f=b.arguments[g],j[g]!==o&&j[g]!==p||(j[g]=l(a,f,c));m=d.Jh(b,j)}}return m}},"./dist/plugins/sheetsCalc/parser-sheets.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc.ns.js"),i=c("./node_modules/util/util.js"),j=d.util.xq,k=new e.Common.ResourceManager(d.SR),l=k.getResource.bind(k),m=f.Errors.Reference,b.maxRowCount=1048576,b.maxColumnCount=16384,n=[1,26,676],o=void 0,p=null,q=["#all","#data","#headers","#totals","#this row"],r={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0},s=/^(R|C|RC)?(0*[1-9]\d*)/,t=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,u=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/;function D(a){return j(a+1).split("")}function E(a,b){var c=b+1;return a<0?a%c+c:a>b?a%c:a}function F(a){return new f.ErrorSource(a)}function G(a,b,c,d,e,f,g){return 3===g||c>=0&&d>=0||1===g&&c>=0||2===g&&d>=0}function H(a,b,c,d,e){var g,i,j=h.BAND_INDEX_CONST,k={cj:j,dj:j,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},l=b?L(a,c,d,0):K(a,0,e);return l.hj?(k.cj=l.ij,k.ej=l.jj):(k.dj=l.ij,k.fj=l.jj),k.li=l.li,k.gj=l.gj,!l.gj||l.li>=a.length?k:!b&&l.hj||b&&!l.hj?{gj:!1}:(g=a[k.li],!b&&(f.isNumber(g)||"$"===g)||b&&("C"===g||"c"===g)?(i=b?L(a,c,d,k.li):K(a,k.li,e),k.li=i.li,!i.gj||!b&&!i.hj||b&&i.hj?(k.gj=!1,k):(k.li<a.length&&(k.Vka=!1),b?(k.dj=i.ij,k.fj=i.jj):(k.cj=i.ij,k.ej=i.jj),k.gj=!0,k)):{gj:!1})}v=[1,10,100,1e3,1e4,1e5,1e6,1e6];function I(a){return f.ei(a)||95===a.charCodeAt(0)}function J(a,b,c){for(var d=a,e=b[a],f=!1;d<c&&!I(e);)d++,d<c&&(e=b[d]);if(d<c){for(;d<c&&I(e);)d++,d<c&&(e=b[d]);d<c&&(f=!0)}return f}function K(a,c,d){var e,g,h,i,j,k,l,m,o,p={jj:!0,gj:!1},q=a.length;if(c>=q)return p;if("$"===a[c]&&(p.jj=!1,c++),c>=q)return p;if(e=c,g=0,h=a[e],f.isNumber(h)&&"0"!==h){for(p.hj=!0;e<q&&f.isNumber(h);)e++,e<q&&(h=a[e]);if(e-c>7)return p;for(i=e-1,j=0;i>=c;i--,j++)g+=(a[i].charCodeAt(0)-48)*v[j];if(g<=b.maxRowCount)return p.ij=g-1,p.li=e,p.gj=!0,p}else if(f.ei(h)){for(p.hj=!1;e<q&&f.ei(h);)e++,e<q&&(h=a[e]);if(k=e-c,k>3)return p;if(J(e,a,q))return p;for(g=0,l=e-1,m=l;m>=c;m--){if(o=a[m].charCodeAt(0),!(o>=65&&o<=90||o>=97&&o<=122))return p;g+=((32|o)-96)*n[l-m]}if(g<=b.maxColumnCount)return p.ij=g-1,p.li=e,p.gj=!0,p}return p}function L(a,c,d,e){var g,i,j,k,l,m=h.BAND_INDEX_CONST,n={li:e,ij:m,hj:!0,jj:!1,gj:!1},o=a.length;if(e>=o)return n;if(g=e,i=a[g],"R"===i||"r"===i)n.hj=!0,j=c;else{if("C"!==i&&"c"!==i)return n;n.hj=!1,j=d}if(e++,g++,e>=o)return n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n;if(i=a[g],"["===i&&(e++,g++,n.jj=!0),e>=o)return n;if(k=!1,i=a[g],n.jj&&"-"===i&&(e++,g++,k=!0),e>=o)return n;if(i=a[g],!f.isNumber(i))return n.jj?n:(n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n);for(;g<o&&f.isNumber(i);)g++,g<o&&(i=a[g]);if(l=parseInt(a.slice(e,g).join(""),10),n.jj){if(g>=o||"]"!==a[g])return n;g++}return l<(n.hj?b.maxRowCount:b.maxColumnCount)?(n.jj?(l=k?-l:l,n.ij=l+j):n.ij=l-1,n.li=g,n.gj=!0,n):void 0}function M(a,b,c,d){var e,g,h=a.row||0,i=a.column||0;if(c.source===f.BangSource)d.push("!");else if(c.source&&(e=P(a,d,c.source,c.endSource),!e))return void d.push("#","R","E","F","!");g=c.type,8===g||5===g?d.push(""+c.value):c.value&&c._error?d.push(""+c.value):c.sf()?(!c.source&&a.addSheetName&&a.source&&P(a,d,a.source,o),N(a.useR1C1,h,i,c.row,c.column,c.rowRelative,c.columnRelative,d)):(!c.source&&a.addSheetName&&a.source&&P(a,d,a.source,o),O(a.source,a.useR1C1,h,i,c.row,c.column,c.endRow,c.endColumn,c.rowRelative,c.columnRelative,c.endRowRelative,c.endColumnRelative,d,c.tf()))}function N(a,c,d,e,g,h,i,j,k){var l,m;if(k=k||0,l=b.maxRowCount-1,(0===k||1===k)&&e>-l&&e<=2*l&&(e+=h?c:0,e=E(e,l)),m=b.maxColumnCount-1,(0===k||2===k)&&g>-m&&g<=2*m&&(g+=i?d:0,g=E(g,m)),!G(c,d,e,g,h,i,k))return void j.push(""+f.Errors.Reference);if(a){if(2!==k&&(j.push("R"),e>=0&&(c!==e||!h)&&(h?j.push("["+(e-c)+"]"):(e++,j.push(e+""))),g<0))return;1!==k&&(j.push("C"),d===g&&i||(i?j.push("["+(g-d)+"]"):(g++,j.push(g+""))))}else{if(g>=0&&(i||j.push("$"),j.push.apply(j,D(g))),e<0)return;e++,h||j.push("$"),j.push(e+"")}}function O(a,c,d,e,f,g,i,j,k,l,m,n,o,p){p=p||0,3===p&&(f=0,i=a?a.getRowCount():b.maxRowCount-1,p=1),N(c,d,e,f,g,k,l,o,p);var q=h.BAND_INDEX_CONST;(!c||f!==i||g!==j||i!==q&&j!==q)&&(i===q&&j===q||(o.push(":"),N(c,d,e,i,j,m,n,o,p)))}function P(a,b,c,d){if(a.getExternalSourceToken){if(c!==f.BangSource){var e=Q(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(e.length>0))return!1;b.push.apply(b,e);
}return b.push("!"),!0}return!1}function Q(a,b,c){if(!b||0===b.length||R(a,b)||R(a,c))return[];var d=b,e;if(U(b,!1)||c&&U(c,!1)){for(d=["'"],e=0;e<b.length;e++)"'"===b[e]&&d.push("'"),d.push(b[e]);if(c)for(d.push(":"),e=0;e<c.length;e++)"'"===c[e]&&d.push("'"),d.push(c[e]);d.push("'")}else if(c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function R(a,b){if(!b||0===b.length||!a.Eh)return!1;var c="'"===b[0]?1:0;return"["===b[c]&&b.indexOf("]")>c}function S(a,b){var c,d;if(!a||0===a.length)return!0;if(!b){if(f.isNumber(a[0]))return!1;if(W(a))return!1;if(u.test(a[0]))return!1}for(d=0;d<a.length;d++)if(c=a[d],b){if("*"===c||":"===c||"["===c||"]"===c||"?"===c||"\\"===c||"/"===c)return!1}else if(r[c]||f.operaterTypesMap[c])return!1;return!0}b.jma=S,b.validateSheetName=S;function T(a,b){var c,d;if(!a||0===a.length)return!0;for(d=0;d<a.length;d++)if(c=a[d],b){if("*"===c||":"===c||"["===c||"]"===c||"?"===c)return!1;if("'"===c&&(0===d||d>=a.length-1||"'"!==a[d+1]))return!1}else if("'"===c||"["===c||"]"===c||"?"===c||"%"===c||f.operaterTypesMap[c])return!1;return!0}function U(a,b){var c,d,e;return!!f.isDigit(+a[0])||(c=[],d=a,"["===a[0]&&(e=a.lastIndexOf("]"),e>0&&(c=a.slice(1,e),d=a.slice(e+1))),!T(c)||!S(d,b))}function V(a){var b=a.search(/[0-9]/),c=a.substr(0,b),d=parseInt(a.substr(b),10);return(b<=2||3===b&&c<="XFD")&&d<=1048576}function W(a){var b=a.join("").toUpperCase();return!!("RC"===b||"C"===b||"R"===b||s.test(b)||t.test(b)&&V(b))}function X(a){var b=new f.Expression(8);return b.value=a,b}function Y(a){var b=a;return a&&a.length>=3&&"["===a[0]&&"0"===a[1]&&"]"===a[2]&&(b=3===a.length?"":a.substring(3)),b}function Z(a,b,c){var d,e,f,g,h,i=a.source;return i&&(e=i.q$a,f=i.cDc,g=i.dDc,e&&(h=b>=0&&b<f&&c>=g||b>=f&&c>=0&&c<g,h&&(d=i))),d}w=function(a){C(b,a);function b(b){var c=a.call(this,8e3)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,b,c,d){var e,g,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z=a.useR1C1,A=a.row||0,B=a.column||0,C=c.length,D=c[d],E=D.ni,G=D.Nc,I=D.hi;if(0!==G&&6!==I)return!1;if(0===G&&0===I&&d<C-2&&":"===c[d+1].ni&&12===c[d+2].hi&&c[d+2].ni.indexOf(":")<0||0===G&&12===I){if(l=void 0,m=void 0,E&&(E.indexOf(":")>0?(n=E.indexOf(":"),l=E.substring(1,n-1),m=E.substring(n+1,E.length-2)):(l=E,"'"===l.charAt(0)&&(l=l.substring(1,l.length-1)),0===I&&(m=c[d+2].ni,"'"===m.charAt(0)&&(m=m.substring(1,m.length-1))))),d++,k=!!l,l=Y(l),l&&(g=E?a.getExternalSource("",l):f.BangSource,g=g||F(l),m=Y(m),m&&(j=a.getExternalSource("",m),j=j||F(m),d+=2)),D=c[d],D&&"["===D.Qb[0])return!1;if(!D)return X(E);E=D.ni}if(o=d===C-1?p:c[d+1],$(c,D,d,z,!0)){if(q=a&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,r=H(D.Qb,z,A,B,q),!r.gj&&!k)return!1;if(D.hi=7,r.gj&&r.Vka){if(s=r.cj,t=r.dj,u=r.ej,v=r.fj,d<C-2&&5===o.Nc&&":"===o.ni&&(o=c[d+2],$(c,o,d+2,z,!1)&&(w=H(o.Qb,z,A,B),w.gj&&s===h.BAND_INDEX_CONST==(w.cj===h.BAND_INDEX_CONST)&&t===h.BAND_INDEX_CONST==(w.dj===h.BAND_INDEX_CONST))))return A=s===h.BAND_INDEX_CONST?0:A,B=t===h.BAND_INDEX_CONST?0:B,{index:d+3,expr:f.uf(g,j,s-(u?A:0),t-(v?B:0),w.cj-(w.ej?A:0),w.dj-(w.fj?B:0),u,v,w.ej,w.fj,A,B)};if(s===h.BAND_INDEX_CONST||t===h.BAND_INDEX_CONST){if(z)return s-=s!==h.BAND_INDEX_CONST&&u?A:0,t-=t!==h.BAND_INDEX_CONST&&v?B:0,{index:d+1,expr:f.uf(g,j,s,t,s,t,u,v,u,v,A,B)};if(!g)return!1;e=X(E)}if(!e)return i.isNullOrUndefined(g)&&(g=Z(a,A,B)),x=s-(u?A:0),y=t-(v?B:0),e=f.rf(g,j,x,y,u,v),{index:d+1,expr:e}}else e=X(E)}else if(6===D.hi)e=new f.Expression(5),e.value=f.CalcError.parse(D.ni);else{if(!g)return!1;e=X(E)}return g&&(e.source=g),j&&(e.endSource=j),{index:d+1,expr:e}},b.prototype.unparse=function(a,b,c,d){var e=c&&c.type;return(1===e||8===e||5===e)&&(M(a,b,c,d),!0)},b}(f.TokenResolver),b.SheetReferenceResolver=w;function $(a,b,c,d,e){return 0===b.Nc&&0===b.hi||!d&&0===b.Nc&&4===b.hi&&(!e||c<a.length-2&&":"===a[c+1].ni&&0===a[c+2].Nc&&4===a[c+2].hi)}!function(a){a[a.ThisRow=1]="ThisRow",a[a.Headers=2]="Headers",a[a.Data=3]="Data",a[a.Totals=8]="Totals",a[a.HeadersAndData=6]="HeadersAndData",a[a.DataAndTotals=12]="DataAndTotals",a[a.All=14]="All",a[a.NotSpecific=16]="NotSpecific"}(x=b.StructReferencePortions||(b.StructReferencePortions={})),function(a){a[a.All=1]="All",a[a.NotSpecific=1]="NotSpecific",a[a.SingleColumn=2]="SingleColumn",a[a.ColumnRange=4]="ColumnRange"}(y=b.StructReferenceColumnSpecifier||(b.StructReferenceColumnSpecifier={}));function _(a,b,c,d,e){return b<=a.startRow()&&c<=a.startColumn()&&b+d>a.endRow()&&c+e>a.endColumn()}z=function(a){C(b,a);function b(){return a.call(this,13)||this}return b.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(b.prototype,"baseTable",{get:function(){return this.lj},set:function(a){this.lj=a,this.source=a.source()},enumerable:!0,configurable:!0}),b.prototype.JUa=function(){this.vzb=this.lj.startColumn()},b.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},b.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},b.prototype.referencePortions=function(){return this.qj},b.prototype.referenceColumnSpecifier=function(){return this.rj},b.prototype.getRange=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,q=this,r=q.lj;switch(q.JUa(),k=r.startRow(),l=r.endRow(),m=r.hasTotalsRow(),n=r.hasHeadersRow(),q.qj){case 3:case 16:d=n?k+1:k,g=m?l-1:l;break;case 2:if(n)d=k,g=k;else{if(!c)return p;d=k-1,g=k-1}break;case 8:if(m)d=l,g=l;else{if(!c)return p;d=l+1,g=l+1}break;case 1:d=a,g=a;break;case 6:d=k+(c&&!n?-1:0),g=m?l-1:l;break;case 12:d=n?k+1:k,g=l+(c&&!m?1:0);break;case 14:default:d=k+(c&&!n?-1:0),g=l+(c&&!m?1:0)}return e=q.columnReferenceStart(),h=q.columnReferenceEnd(),o=r.endColumn(),1===q.rj&&(h=o),e>o||h>o?(q._error=!0,p):g<d||!c&&d<k||!c&&g>l?p:(i=g-d+1,j=h-e+1,f.qf(d,e,i,j))},b.prototype.offsetWhenInsertRemoveColumn=function(a,c,d,e){var g,h,i=this,j=i.vzb;return a<j||a===j&&d&&!e||a>i.pj+j?i:(c=d?c:-c,g=a-j,h=new b,h.baseTable=i.lj,h.pj=i.pj+c,h.oj=i.oj,a<=j+i.oj&&(h.oj+=c,h.oj<g&&(h.oj=g)),h.rj=i.rj,h.qj=i.qj,h.pj<h.oj?f.Ih:h)},b.prototype.offsetWhenCopy=function(a,b,c,d,e,h,i,j,k,l){var m,n,o,p,q,r,s=this,t=new g.SheetParserContext(b.kj,b.Af.useR1C1,f.pf(c,d)),u=t.getTableByIndex(c,d),v=s.offset();return u&&(m=c-e,n=d-h,o=i-e,p=j-h,q=void 0,a===b?q=t.getTableByIndex(m,n):(r=new g.SheetParserContext(a.kj,a.Af.useR1C1,f.pf(m,n)),q=r.getTableByIndex(m,n)),q!==u&&q===s.lj&&_(q,o,p,k,l)&&_(u,i,j,k,l)&&(v.baseTable=u)),v},b.prototype.Jma=function(a){var c,d=this,e=new b;return e.baseTable=d.lj,e.pj=d.pj,e.oj=d.oj,2===d.rj&&a&&(c=d.lj.endColumn()-d.lj.startColumn()+1,a%=c,e.oj+=a,e.oj<0&&(e.oj+=c),e.pj=e.oj),e.rj=d.rj,e.qj=d.qj,e},b.prototype.offset=function(a,c,d){var e=this,f=new b;return f.baseTable=e.baseTable,f.qj=e.qj,f.oj=e.oj,f.pj=e.pj,f.rj=e.rj,f},b.prototype.Kma=function(a,b){var c=this.lj;return a>=c.startRow()&&b>=c.startColumn()&&a<=c.endRow()&&b<=c.endColumn()},b.prototype.tzb=function(a,b,c){this.lj.wzb(a,b,c)},b}(f.Expression),b.xzb=z,A=function(a){C(c,a);function c(b){var c=a.call(this,7900)||this;return c.kj=b,c}return c.prototype.resolveToken=function(a,b,d,e){var f,g,h,i,j,k=d[e],l=d[e+1];if(0===k.Nc){if(f=void 0,g=void 0,0===k.hi||7===k.hi)f=k.ni;else{if(12!==k.hi||!l||0!==l.Nc||0!==l.hi||"["!==l.Qb[0])return p;h=k.ni,"'"===h[0]&&(h=h.substr(1,h.length-2)),f=h+l.ni,g=!0}if("]"===f.charAt(f.length-1))try{return i=new z,aa(a,f.split(""),i),g?{index:e+2,expr:i}:i}catch(a){}else if(j=a.getTableByName&&a.getTableByName(f))return c.create(j)}return p},c.prototype.unparse=function(a,c,d,e){var g,h,j,k,l,m,n,o,q,r,s,t;return 13===d.type&&(g=d,h=g.lj.KXc,j=i.isNullOrUndefined(h)?g.lj.tableName():h,a.YSa?(k=g.getRange(a.row,a.column,!0),l=f.uf(g.source,p,k.row,k.col,k.row+k.rowCount-1,k.col+k.colCount-1,!1,!1,!1,!1),M(a,c,l,e),!0):16===g.qj&&1===g.rj?(e.push(j),void(a.Eh&&e.push("[]"))):(n=e.length,o=a.source===g.lj.source()&&g.Kma(a.row,a.column),o&&!a.Eh||(q=i.isNullOrUndefined(h)?g.lj.tableName():h,g.lj.kj.xUc&&!b.validateSheetName(q.split(""))&&(q=Q(a,q.split(""),null).join("")+"!"),e.push(q)),e.push("["),16!==g.qj&&(r=oa(g.qj,1!==g.rj,a.Eh),e.push(r)),1!==g.rj&&(1===g.qj&&!a.Eh||16===g.qj||e.push(", "),s=g.lj.getColumnName(g.oj),s?s=ha(s.split("")).join(""):m=!0,m||(4===g.rj?(t=g.lj.getColumnName(g.pj),t?(t=ha(t.split("")).join(""),e.push("[",s,"]:[",t,"]")):m=!0):1===g.qj&&!a.Eh&&!ia(s)||16===g.qj?e.push(s):e.push("[",s,"]"))),m?(e.length=n,e.push("#REF!")):e.push("]"),!0))},c.create=function(a,b,c,d,e){void 0===b&&(b=x.NotSpecific),void 0===c&&(c=y.NotSpecific),void 0===d&&(d=0),void 0===e&&(e=a.endColumn()-a.startColumn());var f=new z;return f.baseTable=a,f.qj=b,f.oj=d,f.pj=e,f.rj=c,f},c}(f.TokenResolver),b.StructureReferenceResolver=A;function aa(a,b,c){var d,e,f,g,h,j,k,l,m,n=c,o=0,p=b[o],q=ma(a,b,o,p),r=q.sj;for(r||na(),n.baseTable=r,o=q.tj,o++,p=b[o],d=o;" "===p;)o++,p=b[o];for("@"!==p&&"["!==p&&(o=d,p=b[o]),e=1,f=!1,g=!1,h=b.length;0!==e&&o<h;)if("["===p&&(e++,o++,p=b[o]),"#"===p)f&&e<=1&&na(),j=la(b,o,p,e),k=j.vj,o=j.tj,p=j.uj,e=j.wj,f?2===n.qj&&3===k||2===k&&3===n.qj?n.qj=6:3===n.qj&&8===k||3===k&&8===n.qj?n.qj=12:na():n.qj=k,f=!0;else if("@"===p){for((e>1||f)&&na(),f=!0,n.qj=1,o++,p=b[o];" "===p;)o++,p=b[o];","===p&&na()}else{for(l=o;!i.isNullOrUndefined(p)&&"]"!==p&&"["!==p;)if("'"===p&&o++,","===p){for(o++,p=b[o],m=o;" "===p;)o++,p=b[o];if("["===p){o=m,p=",";break}}else o++,p=b[o];if(o>l&&((g||"["===p&&e>1)&&na(),j=ca(n,b,o,p,e,l),o=j.tj,p=j.uj,e=j.wj,g=!0),"]"===p){if(e--,0===e)break;o>=b.length&&na(),o++,p=b[o]}","===p&&(o++,p=b[o])}f||(n.qj=a.DLb?1:16),g||(n.oj=0,n.pj=n.lj.endColumn()-n.lj.startColumn(),n.rj=1)}function ba(a,b,c){return a.slice(b,c).join("")}function ca(a,b,c,d,e,f){var g,h,i,j,k,l,m=a,n=[],p="",q=!1,r=!1;if(e>1)q=!0,e--,n=b.slice(f,c),c++,d=b[c],":"===d&&(c++,d=b[c],r="["===d,h=ja(b,c,d,e),p=h.xj,c=h.tj,d=h.uj,e=h.wj);else if("["===d){for(r=!0,g=c-1,d=b[g];" "===d;)g--,d=b[g];":"!==d&&na(),n=b.slice(f,g),n=da(n),d=b[c],h=ja(b,c,d,e),p=h.xj,c=h.tj,d=h.uj,e=h.wj}else m.qj!==o&&16!==m.qj||(q=!0),i=b.slice(f,c),g=i.indexOf(":"),g>0?(n=i.slice(0,g),p=i.slice(g+1),"["!==p[0]&&na()):n=i;if(j=fa(m,n,q),p?(k=fa(m,p,r),m.rj=4):(k=j,m.rj=2),j>k&&(l=j,j=k,k=l),m.oj=j,m.pj=k,c++,c<b.length)for(d=b[c];" "===d;)c++,d=b[c];return{tj:c,uj:d,wj:e}}function da(a){for(var b=a.length-1;b>=0&&" "===a[b];)b--;for(;b>=0&&" "!==a[b];)b--;return b>=0?a.slice(b+1,a.length-b-1):a}function ea(a){for(var b=0,c=a.length,d=0;b<c&&" "===a[b];)b++;for(d=b,b=c-1;b>d&&" "===a[b];)b++;return b>=d?a.slice(d,b+1):a}function fa(a,b,c){var d,e,f,g;if(b&&ga(b,c)){for(d=[],e=0,f=b.length;e<f;e++)"'"===b[e]&&e<f-1&&e++,d.push(b[e]);return b=d,g=a.lj.getColumnIndexInTable(b.join("")),g<0&&na(),g}return-1}function ga(a,b){var c,d,e;if(b)return!0;if(c="",c=a[0],d=c,"#"===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!1;for(e=1;e<a.length;e++){if(c=a[e],","===c||":"===c||"["===c&&"'"!==d||"]"===c&&"'"!==d||"@"===c&&"'"!==d||"#"===c&&"'"!==d)return!1;d=c}return!0}function ha(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],"["!==b&&"]"!==b&&"@"!==b&&"#"!==b&&"'"!==b||d.push("'"),d.push(b);return d}function ia(a){var b,c="";if(c=a[0],"#"===c||" "===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!0;for(b=1;b<a.length;b++)if(c=a[b]," "===c||","===c||":"===c||"["===c||"]"===c||"@"===c||"#"===c)return!0;return!1}function ja(a,b,c,d){var e,f,g=!1;if("["===c)for(g=!0,d++,b++,c=a[b];" "===c;)b++,c=a[b];for(e=b;"]"!==c&&(","!==c||d>1);)"'"===c&&b++,b++,c=a[b];return b<=e&&na(),f=a.slice(e,b),d>1&&d--,g||(f=ea(f)),{xj:f,tj:b,uj:c,wj:d}}B={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1};function ka(a){var b,c=f.getMapping()&&f.getMapping().tableFunctionsMapping;if(!i.isNullOrUndefined(c))for(b in c)if(c[b].toLowerCase()===a)return b.toLowerCase();return a}function la(a,b,c,d){for(var e,f,g,h,i=14,j=b;"]"!==c;)"'"===c&&b++,b++,c=a[b];for(e=ba(a,j,b).toLowerCase().trim(),e=ka(e),f=!1,g=0;g<q.length;g++)if(h=q[g],e===h){i=B[e],f=!0;break}if(f||na(),b++,b>=a.length)d--;else{for(c=a[b];" "===c;)b++,c=a[b];if(","===c){for(d<=1&&na(),b++,c=a[b];" "===c;)b++,c=a[b];"["===c&&(d++,b++,c=a[b])}d>1&&d--}return{vj:i,tj:b,uj:c,wj:d}}function ma(a,b,c,d){for(var e,f,g=0,h=b.length;"["!==d&&c<h;)c++,d=b[c];return g=c,g>0?(f=ba(b,0,g),e=a.getTableByName(f)):e=a.getTableByIndex(a.row,a.column),{sj:e,tj:c,uj:d}}function na(){throw l().Exp_FormulaInvalid}function oa(a,b,c){var d=f.getMapping()&&f.getMapping().tableFunctionsMapping,e=f.sR().B2,g=d?d["#All"]:e.All.name,h=d?d["#This row"]:e.thisRow.name,i=d?d["#Headers"]:e.Headers.name,j=d?d["#Data"]:e.Data.name,k=d?d["#Totals"]:e.Totals.name;switch(a){case 1:return c?"["+h+"]":"@";case 2:return b?"["+i+"]":i;case 3:return b?"["+j+"]":j;case 8:return b?"["+k+"]":k;case 6:return"["+i+"], ["+j+"]";case 12:return"["+j+"], ["+k+"]";case 14:case 16:}return b?"["+g+"]":g}function pa(a,b){var c,d,e,g,h,i,j,k,l,m,n=0;for(a.unshift(new f.FormulaToken("=",1,0,0,0)),g=[],h=0,e=a.length-1;e>0;e--)a[e].mi===a[e-1].mi&&a[e].ni===a[e-1].ni||(g[h]=a[e],h++);for(g[h]=a[e],g.reverse(),i=[],j=0,k=0;k<g.length-1;k++,j++)d=qa(g[k]),i[j]=g[k],n=g[k+1].mi-g[k].mi-d,n>0&&(c=new f.FormulaToken(b.slice(g[k].mi+d,g[k+1].mi),7,g[k].mi+d),++j,i[j]=c);for(i[j]=g[k],d=qa(i[j]),i.length>0&&b.length>i[j].mi+d&&(c=new f.FormulaToken(b.slice(i[j].mi+d,b.length),7,i[j].mi+d),i[j+1]=c),l=0;l<i.length;l++)m=i[l].ni.trim(),3===i[l].hi?i[l].ni='"'+i[l].ni+'"':"("===m||"{"===m?(i[l].Nc=1,i[l].hi=1):")"!==m&&"}"!==m||(i[l].Nc=1,i[l].hi=2);return i}function qa(a){return 1===a.Nc&&"ARRAY"===a.ni?1:0===a.Nc&&3===a.hi?(a.HTa||a.ni).length+2:0===a.Nc&&12===a.hi?a.ni.length+3:a.ni.length}function ra(a,b,c){var d,e;a&&b&&(d=b.getName&&b.getName()||"!",e=a[d],e||(e=a[d]=[],a.sheets||(a.sheets=[]),a.sheets.push(d)),e.push(c))}function sa(a,b,c,d,e,g){var h,i,j,k;if(a){for(;10===a.type;)a=a.value;if(12===a.type&&(i=a,a=i.value),a.type>=2&&a.type<=6);else if(1===a.type)h=a.getRange(e,g),!d.source||a.source&&a.source!==d.source||b.push(h),ra(c,a.source||d.source,h);else if(13===a.type)h=a.getRange(e,g),a.source===d.source&&h&&b.push(h),ra(c,a.source||d.source,h);else if(8===a.type)a.g$c||(a.g$c=!0,j=p,a.source?a.source.Cf()&&(j=new f.EvaluateContext(a.source,f.pf(e,g))):j=d,sa(j.getName(a.value),b,c,j,e,g),a.g$c=o);else if(9===a.type)sa(a.value,b,c,d,e,g),a.value2&&sa(a.value2,b,c,d,e,g);else if(7===a.type)for(k=0;k<a.arguments.length;k++)sa(a.arguments[k],b,c,d,e,g)}}function ta(a,b,c,d,e,g,h,i){var j,k,l,m;a.setParserOption(g),j=[],k=b.split("");try{l=!!i||c.Cf().useR1C1,m=c.yj().getParserContext(!h&&l,f.pf(d,e),p),j=a.parseToTokens(m,k,!1)}catch(a){}return j=pa(j,k),ua(a,j,k,c,d,e,h,i)}b.qzb=ta;function ua(a,b,c,d,e,h,i,j){var k,l,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=o,H=d.yj(),I=d.Cf(),J=!!j||I.useR1C1;for(I?(k=new g.SheetParserContext(d,!i&&J,f.pf(e,h)),G=new f.EvaluateContext(H,f.pf(e,h),(!1))):k=new f.ParserContext(p,(!1),f.pf(0,0)),k.ignoreError=!0,l=[],n=0;n<b.length;n++)try{if(m=b[n],"["===m.ni||"#"===m.Qb[0]||3===m.hi){l.push({text:m.HTa||m.ni,type:m.Nc,subType:m.hi,canDrag:!1,ranges:m.ranges,value:m.ni});continue}if(q=[],n=va(a,k,b,n,q),r=void 0,q.length>0){for(s=0;s<q.length;s++)if(t=q[s],t instanceof f.FormulaToken)l.push({text:c.slice(t.mi,t.li+1).join(""),type:t.Nc,subType:t.hi,canDrag:r,ranges:[],value:t.ni});else if(t.Lf){if(u=t.Lf,v=u.type,w=u.source,x=c.slice(t.mi,t.li+1).join(""),y=[],z={},r=!0,A=u.getRange&&u.getRange(e,h),8===v)r=!1,G&&(B=G,u.source&&(B=new f.EvaluateContext(u.source,f.pf(e,h),(!1))),C=B.getName(u.value),sa(C,y,z,G,e,h));else if(13===v)r=!1,w===H&&A?y.push(A):y=null,ra(z,w,A);else if(1===v)if(u.endSource)for(D=w,E=u.endSource,F=D.getSources(E),s=0;s<F.length;s++){if(F[s]===H){y.push(A);break}ra(z,F[s],A)}else ra(z,w||H,A),w&&w!==H||y.push(A);else y=null;y&&y.length>0?l.push({text:x,type:0,subType:7,canDrag:r,ranges:y,value:x,sheetRanges:z}):l.push({text:x,type:m.Nc,subType:m.hi,canDrag:r,ranges:y,value:x,sheetRanges:z})}}else l.push({text:m.ni,type:m.Nc,subType:m.hi,canDrag:!1,ranges:m.ranges,value:m.ni})}catch(a){l.push({text:m.ni,type:m.Nc,subType:m.hi,canDrag:!1,ranges:m.ranges,value:m.ni})}return l}function va(a,b,c,d,e){var f,g,h,i,j,k,l=c[d];return l&&"function"!=typeof l&&0===l.Nc?(f=[],g=a.resolveToken(b,c,f,d)-1,h=f[0],i=h.type,1===i||13===i||8===i||5===i&&h.source?(j=c[g],k={mi:l.mi,li:j.li,Lf:h},e.push(k),g):d):d}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/sheetsCalc/calc.ns.js")),d(c("./dist/plugins/sheetsCalc/parser-sheets.js")),d(c("./dist/plugins/sheetsCalc/calc-spreadjs.js")),d(c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),d(c("./dist/plugins/sheetsCalc/worksheet-formula.js")),c("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),j=h.SpreadSource,k=f.Common.u.Nb,l=new f.Common.ResourceManager(d.SR),m=l.getResource.bind(l),n=void 0,o=null,p=f.Common.j,q=d.Workbook.prototype,q.qv=function(a){var b=this,c=b.Wu;b.Wu=new g.CalcService,b.Wu.useR1C1=1===b.options.referenceStyle,b.Wu.allowDynamicArray=b.options.allowDynamicArray,b.Wu.iterativeCalculation=b.options.iterativeCalculation,b.Wu.iterativeCalculationMaximumIterations=b.options.iterativeCalculationMaximumIterations,b.Wu.iterativeCalculationMaximumChange=b.options.iterativeCalculationMaximumChange,a&&c&&b.Wu.cloneFrom(c),b.yv=new j(b),b.zv=b.Wu.getGlobalSourceModel(b.yv)},q.addCustomFunction=function(a){this.Xu(a)},q.Xu=function(a){if(!(a&&a instanceof g.Functions.Function))throw Error(m().Exp_InvalidCustomFunction);a.name=k(a.name),this.Su[a.name]=a},q.getCustomFunction=function(a){return a?this.Su[k(a)]:n},q.removeCustomFunction=function(a){a&&(delete this.Su[k(a)],this.iK())},q.clearCustomFunctions=function(){this.Su={}},q.addCustomName=function(a,b,c,d,e){this.Yu(this.Tu,a,b,c,d,!1,e)},q.H$a=function(a){return!this.Tu[k(a)]},q.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},q.Yu=function(a,b,c,e,f,g,h){var j,l,n,p,q=this;if(!b||!c||!g&&!q.isValidCustomName(b))throw Error(m().Exp_InvalidCustomName);if(q.Wu){if(j=d.sJc(this),l=j?j.yj():o,n=void 0,g)try{n=q.Wu.parse(l,c,e,f,!1,!1,!0)}catch(a){}else n=q.Wu.parse(l,c,e,f);a[k(b)]=new i.NameInfo(b,n,e,f,h),g||(p={},p[b]=b,this.Zu(p,!0))}},q.getCustomName=function(a){return a?this.Tu[k(a)]:n},q.aJb=function(a){return a?this.QHb[k(a)]:n},q.getCustomNames=function(){var a=[];return d.GC$.each(this.Tu,function(b,c){a.push(c)}),a},q.ELb=function(){var a=[];return d.GC$.each(this.QHb,function(b,c){a.push(c)}),a},q.removeCustomName=function(a){if(a){delete this.Tu[k(a)];var b={};b[a]=a,this.Zu(b,!1)}},q.RHb=function(a){if(a){delete this.QHb[k(a)];var b={};b[a]=a,this.Zu(b,!1)}},q.clearCustomNames=function(){var a=this.Tu;this.Tu={},this.Zu(a,!1)},q.FLb=function(){var a=this.QHb;this.QHb={},this.Zu(a,!1)},q.Zu=function(a,b){var c,d;if(a){c=this.zv;for(d in a)c&&c.updateNameCalc(d,b);this.iK()}},q.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var a=this.getActiveSheet();a&&(a.suspendPaint(),this.Wu.recalculateAll(),a.resumePaint())}},q.getCalcService=function(){return this.Wu},q.Cf=function(){return this.Wu},q.suspendCalcService=function(a){this.Wu&&this.Wu.suspend(a)},q.resumeCalcService=function(a){this.Wu&&this.Wu.resume(a)},q.getCircularReference=function(){var a,b,c,d=this.chc();d=this.dhc(d),a=[];for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&(c=b.split("\\"),a.push({row:+c[1],col:+c[2],rowCount:1,colCount:1,sheetName:c[0]}));return a},q.chc=function(){var a={};return this.sheets.forEach(function(b){var c,d,e,f,g,h,i,j=b.Bj(),k=b.getRowCount(),l=b.getColumnCount(),m=b.name();if(j)for(c=0;c<k;c++)for(d=0;d<l;d++)for(e=m+"\\"+c+"\\"+d,f=b.VXc(c,d),!a[e]&&f.length>0&&(a[e]={from:[],to:[]}),g=0;g<f.length;g++)h=f[g],i=h.sheetName+"\\"+h.row+"\\"+h.col,a[i]||(a[i]={from:[],to:[]}),a[i].from.push(e),a[e].to.push(i)}),a},q.dhc=function(a){var b,c,d;function e(a,b){a.splice(a.indexOf(b),1)}for(b=!0;Object.keys(a).length>0&&b;){b=!1,c=function(c){if(Object.prototype.hasOwnProperty.call(a,c)){var d=a[c];0===d.from.length?(d.to.forEach(function(b){e(a[b].from,c)}),delete a[c],b=!0):0===d.to.length&&(d.from.forEach(function(b){e(a[b].to,c)}),delete a[c],b=!0)}};for(d in a)c(d)}return a},d.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.QHb={}},toJson:function(a){var b,c,e,f,g,h,i,j=this,k=j.Su;d.GC$.isEmptyObject(k)||(a.customFunctions=k),b=[],c=[],e=j.getCustomNames(),f=j.ELb(),g=j.Wu,h=this.getActiveSheet(),i=h?h.yj():o,e&&g&&(d.GC$.each(e,function(a,c){var d,e,f=c.getName(),h=c.getRow(),j=c.getColumn(),k=c.getExpression(),l=c.getComment();k&&(d=g.unparse(i,k,h,j,!1,!0),e={name:f,formula:d,row:h,col:j},l&&(e.comment=l),b.push(e))}),d.GC$.each(f,function(a,b){var d,e,f=b.getName(),h=b.getRow(),j=b.getColumn(),k=b.getExpression(),l=b.getComment();k&&(d=g.unparse(i,k,h,j,!1,!0),e={name:f,formula:d,row:h,col:j},l&&(e.comment=l),c.push(e))}),b.length>0&&(a.names=b),c.length>0&&(a.formatStringNames=c))},fromJson:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=y.Wu;if(z&&z.suspend(),y.clearCustomNames(),d=a.names)for(f=0;f<d.length;f++)g=d[f],y.Yu(this.Tu,g.name,g.formula,g.row,g.col,!0,g.comment);if(y.FLb(),h=a.formatStringNames)for(f=0;f<h.length;f++)g=h[f],y.Yu(this.QHb,g.name,g.formula,g.row,g.col,!0,g.comment);if(y.clearCustomFunctions(),i=a.customFunctions)for(j in i)i.hasOwnProperty(j)&&(k=i[j],l=e.getTypeFromString(k.typeName),l&&(m=new l,m.fromJSON(k,b),y.Xu(m)));if(p=a.sheets,q=[],p){n=0;for(s in p)"string"==typeof s&&(t=p[s],o=y.getSheetFromName(t.name||s),q.push(o),o.nameFunctionsFromJSON(t,b,c),n++);for(r=q.length,n=0;n<r;n++)o=q[n],o.yj().q$a=!0,o.formulaFromJSON(p[o.name()],b,c)}for(u=a.noRecalc||c&&c.doNotRecalculateAfterLoad,z&&(u?z.resumeWithoutCalc():z.resume(!0)),v=0,w=q;v<w.length;v++)o=w[v],x=o.yj(),x.HIb(),delete x.q$a},egc:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.Wu;if(u&&u.suspend(),t.clearCustomNames(),d=a.names)for(f=0;f<d.length;f++)g=d[f],t.Yu(this.Tu,g.name,g.formula,g.row,g.col,!0,g.comment);if(t.clearCustomFunctions(),h=a.customFunctions)for(i in h)h.hasOwnProperty(i)&&(j=h[i],k=e.getTypeFromString(j.typeName),k&&(l=new k,l.fromJSON(j,b),t.Xu(l)));if(o=a.sheets,p=[],o){m=0;for(r in o)"string"==typeof r&&(s=o[r],n=t.getSheetFromName(s.name||r),p.push(n),n.nameFunctionsFromJSON(s,b,c),m++);for(q=p.length,m=0;m<q;m++)n=p[m],n.yj().q$a=!0,n.formulaFromJSON(o[n.name()],b,c)}c.incrementLoadTask.addTask(function(b,d,e){var f,g,h;for(u&&(a.noRecalc||c&&c.doNotRecalculateAfterLoad?u.resumeWithoutCalc():(u.resume(!0),t.getActiveSheet().$p())),f=0,g=p;f<g.length;f++)n=g[f],h=n.yj(),h.HIb(),delete h.q$a},[u,a,c])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),j=null,k=void 0,l=d.GC$.each,m=f.Common.u.Nb,n=new f.Common.ResourceManager(d.SR),o=n.getResource.bind(n),p=f.Common.j.Fa,q=parseInt;function s(a){return a.columnRelative}function t(a){return a.endColumnRelative}function u(a){return a.rowRelative}function v(a){return a.endRowRelative}function w(a){return a.Cf()}function x(a){return a.column}function y(){var a=this;return a.Ru?void(a.Ru=!1):(a.Su={},a.Tu={},a.eDc?a.eDc.clearAll():a.fDc=new h.SheetSource(a,d.SheetArea.colHeader),a.gDc?a.gDc.clearAll():a.hDc=new h.SheetSource(a,d.SheetArea.rowHeader),void(a.et?a.et.clearAll():a.ft=new h.SheetSource(a,d.SheetArea.viewport)))}function z(a,b,c,d,e,f){var g=a.Ms(b,c,d,e,f),h=g&&g.formulas;return h&&h.length>0}function A(a,b,c,d,e,f,g){var h=z(a,b,c,d,e,3);return!h&&f&&(e=a.getColumnCount(2),h=z(a,b,0,d,e,2)),!h&&g&&(d=a.getRowCount(1),h=z(a,0,c,d,e,1)),h}function B(a){var b,c,d,e=[],f=[];for(b=0;b<a.length;b++)c=a[b],d=""+c.row+c.col+c.rowCount+c.colCount+c.sheetName,e.indexOf(d)<0&&(e.push(d),f.push(c));return f}function C(a,b){var c=a.formulaLoad/a.total;return b?.4*c+.5:.3*c+.4}function D(a,b,c,d,e,f){var g,h=d.yj(),i=a&&a.formula;i&&(i=i.replace(/SINGLE\((.*)\)/gi,"@$1"),g=a.arrayInfo,g&&!g.isDynamicArray?d.bv(b,c,q(g.rowCount,10),q(g.colCount,10),i,!0,f):(g&&(g.isInvalid&&h.GIb(b,c),h.yLb().setArray(h,g.row,g.col,g.rowCount,g.colCount,[],!0)),d._u(b,c,i,j,!0,f,!0,!g)))}function E(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q=e&&e.incrementLoadTask;if(q&&!q.isTerminated){for(h=q.isBusyFunc,f=f||0,i=f,a.suspendPaint(),j=30,k=new Date;i<c;){if(l=b[i])for(m=0;m<d;m++)D(l[m],i,m,a,!0,g);if(i++,h&&h())break;if(n=new Date,n-k>j)break}a.resumePaint(),e||(e={}),o=e&&e.incrementalLoading,o&&o.loading&&(o.loadStatus.formulaLoad+=i-f,p=C(o.loadStatus,e.doNotRecalculateAfterLoad),o.loading(p,{sheet:a})),i<c&&e.incrementLoadTask.pushTask(E,[a,b,c,d,e,i])}}function F(a,b,c,d,e){var f,g,h;for(f=0;f<c;f++)if(g=b[f])for(h=0;h<d;h++)D(g[h],f,h,a,!0,e)}function G(a,b,c,e){var f=d.Worksheet._n;f&&l(f,function(d,f){var g=f.fromJsonAfterFormula;g&&g.call(a,b,c,e)})}r=d.Worksheet.prototype,r.resetCalc=function(){y.call(this),this.Ru=!0},r.recalcAll=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=w(this);if(q){if(this.suspendPaint(),q.suspend(!0),a)for(b=this.parent,c=void 0,c=b&&b.sheets||[this],d=0;d<c.length;d++){if(e=c[d],f=e.Tu,g=e.yj(),f)for(h in f)i=f[h],j=i.Lf,k=q.unparse(g,j,0,0),i.Lf=q.parse(g,k,0,0);for(l=g.getCalcSourceModel(),m=l.getAllNodes(),n=0;n<m.length;n++)o=m[n],p=o.calc,p&&o.Lf&&L(q,p)}q.resume(!0),this.resumePaint()}},r.recalcRange=function(a,b,c,d){var e=w(this);e&&e.recalcRange(this.yj(),a,b,c,d)},r.recalcRows=function(a){var b,c=w(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,a[b],-1);c.resume(!1)}},r.recalcCols=function(a){var b,c=w(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,-1,a[b]);c.resume(!1)}},r.zq=function(a,b,c){var d,e=w(this);e&&!e.ignoreDirty()&&(d=this.ft,1===c?d=this.fDc:2===c&&(d=this.hDc),e.recalculate(d,a,b))},r.getCalcService=function(){return this.Wu||(this.Wu=new g.CalcService,this.yj(d.SheetArea.colHeader).setCalcService(this.Wu),this.yj(d.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},r.Cf=function(){return this.getCalcService()},r.suspendCalcService=function(a){var b=w(this);b&&b.suspend(a)},r.resumeCalcService=function(a){var b=w(this);b&&b.resume(a)},r.yj=function(a){return p(a)||3===a?this.ft:1===a?this.fDc:2===a?this.hDc:j},r.Bj=function(a){var b=this;return 1===a?(!b.eDc&&b.fDc&&(b.eDc=b.Cf().getSourceModel(b.fDc)),b.eDc):2===a?(!b.gDc&&b.hDc&&(b.gDc=b.Cf().getSourceModel(b.hDc)),b.gDc):(!b.et&&b.ft&&(b.et=b.Cf().getSourceModel(b.ft)),b.et)},r.iDc=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!0,!0)},r.Ns=function(a,b,c,d,e,f){var g=this.iDc(a,b,c,d,3);return!g&&e&&(d=this.getColumnCount(2),g=this.iDc(a,0,c,d,2)),!g&&f&&(c=this.getRowCount(1),g=this.iDc(0,b,c,d,1)),g},r.Ms=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!1,!0)},r.Vq=function(a,b,c,d,e,f,g){var h,i;return void 0===e&&(e=!0),h=e&&this.Ns(a,b,c,d,f,g),i=!e&&A(this,a,b,c,d,f,g),!h&&!i||(this.Os(4,o().Exp_ChangePartOfArray),!1)},r.addCustomFunction=function(a){this.Xu(a),this.recalcAll()},r.Xu=function(a){if(!(a&&a instanceof g.Functions.Function))throw Error(o().Exp_InvalidCustomFunction);a.name=m(a.name),this.Su[a.name]=a},r.getCustomFunction=function(a){return a?this.Su[m(a)]:j},r.removeCustomFunction=function(a){a&&(delete this.Su[m(a)],this.recalcAll())},r.clearCustomFunctions=function(){this.Su={},this.recalcAll()},r.Pu=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomFunction(a),!d&&c&&c.getCustomFunction&&(d=c.getCustomFunction(a)),d):j},r.addCustomName=function(a,b,c,d,e){this.Yu(a,b,c,d,!1,e)},r.getCustomName=function(a){return a?this.Tu[m(a)]:k},r.getCustomNames=function(){var a=[];return l(this.Tu,function(b,c){a.push(c)}),a},r.removeCustomName=function(a){var b,c;a&&(b=m(a),delete this.Tu[b],c={},c[b]=b,this.Zu(c,!1))},r.clearCustomNames=function(){var a=this,b=a.Tu;a.Tu={},this.Zu(b,!1)},r.createNameInfo=function(a,b,c,d,e){var f,g=this,i=w(g),k=g.yj();return i&&k?(f=i.parse(k,b,d,e),new h.NameInfo(a,f,d,e,c)):j},r.H$a=function(a){var b,c=this,d=!c.Tu[m(a)];return d&&(b=c.tables,b&&(d=!b.findByName(a))),d},r.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},r.Yu=function(a,b,c,d,e,f){var g,i,j,k,l=this;if(!a||!b||!e&&!l.isValidCustomName(a))throw Error(o().Exp_InvalidCustomName);if(g=w(l),i=l.yj(),g&&i){if(j=void 0,e)try{j=g.parse(i,b,c,d,!1,!1,!0)}catch(a){}else j=g.parse(i,b,c,d);l.Tu[m(a)]=new h.NameInfo(a,j,c,d,f),e||(k={},k[a]=a,this.Zu(k,!0))}},r.Zu=function(a,b){var c,d=this.Bj();if(d){for(c in a)d.updateNameCalc(c,b);this.recalcAll()}},r.$u=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomName(a),!d&&c&&c.getCustomName&&(d=c.getCustomName(a)),d):j},r.setFormula=function(a,b,c,d){this._u(a,b,c,j,!1,d)},r._u=function(a,b,c,d,e,f,g,h,i){var l,m,n,q,r,s,t,u,v,w=this;return p(f)&&(f=3),a<0||a>=w.getRowCount(f)||b<0||b>=w.getColumnCount(f)?void w.Os(0,o().Exp_IndexOutOfRange):(l=a>=0?a:0,m=b>=0?b:0,n=w.yj(f),d=d||(c&&w.Wu?w.Wu.parse(n,c,l,m,!1,e,e):j),d&&h&&(d.ensureSingle=!0),q=w.tables,void(3===f&&a>=0&&b>=0&&q&&!(r=q.Hma(a,b,1,1,c,d))||(s=w.Bj(f),t=w.conditionalFormats,s&&(u=s.getFormula(a,b),v=w.ITa,s.setFormula(a,b,c,d,e,k,v.dUa(),i),t&&t.Nm(),g?w.WXc(w,[{row:a,col:b}],0):w.Bq("formula",a,b,f,u,c)),w.t4&&w.t4(a,b,1,1,f),w.$p())))},r.setArrayFormula=function(a,b,c,d,e,f){this.bv(a,b,c,d,e,!1,f)},r.bv=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,p,q;if(void 0===g&&(g=3),i=this,a<0||a+c>i.getRowCount()||b<0||b+d>i.getColumnCount())return void i.Os(0,o().Exp_IndexOutOfRange);if(i.ITa.MTa(a,b,c,d))return void i.Os(0,o().Exp_ArrayFormulaSpan);if(j=i.tables,!(3===g&&a>=0&&b>=0&&j)||(k=j.Hma(a,b,c,d,e))){if(l=i.Bj(g),m=i.conditionalFormats,l&&(i.suspendEvent(),l.setArrayFormula(a,b,c,d,e,f,i.ITa.dUa(),h),i.resumeEvent(),m&&m.Nm(),i.jm<1)){for(n=[],p=a;p<a+c;p++)for(q=b;q<b+d;q++)n.push({row:p,col:q});i.Bu(a,b,c,d,n,5,g,e)}i.$p()}},r.getFormula=function(a,b,c,d){var e=this.Bj(c);return e?e.getFormula(a,b,d):j},r.Ima=function(a,b,c){var d=this.Bj(c);return d?d.Kf(a,b):j},r.getFormulaInformation=function(a,b){var c,e,f,g,h,i={},j=this.Bj();return j&&(c=j.Kf(a,b),c?(e=j.Qf(a,b),i.hasFormula=!0,e&&!e.isDynamicArray&&(i.baseRange=new d.Range(e.row,e.col,e.rowCount,e.colCount)),i.isArrayFormula=e&&!e.isDynamicArray,a=e?e.row:a,b=e?e.col:b,i.formula=this.Wu.unparse(this.ft,c,a,b),i.formulaWithCulture=this.Wu.unparse(this.ft,c,a,b,!0),i.hasFormula=!!i.formula):(f=this.ITa.getDynamicArrayInfo(a,b),f&&f.isValid&&(g=f.row,h=f.col,a===g&&b===h||(c=j.Kf(g,h),i.formulaWithCulture=this.Wu.unparse(this.ft,c,g,h,!0),i.hasFormula=!0,i.isDynamicArray=!0)))),i},r.ngc=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r;for(c||(c=this,d=a,e=b,f=[]),g=c.VXc(d,e),h=this.name(),i=0;i<g.length;i++){if(j=g[i],k=j.sheetName+"_"+j.row+"_"+j.col+"_"+j.rowCount+"_"+j.colCount,f[k])return!1;if(f[k]=!0,(j.row<=a&&a<j.row+j.rowCount||j.rowCount===-1)&&(j.col<=b&&b<j.col+j.colCount||j.colCount===-1)&&h===j.sheetName)return!0;for(l=j.sheetName===h?c:c.parent.getSheetFromName(j.sheetName),m=j.rowCount,n=j.row,o=j.colCount,p=j.col,m===-1&&(m=l.getRowCount(),n=0),o===-1&&(o=l.getColumnCount(),p=0),q=n;q<m+n;q++)for(r=p;r<o+p;r++)if(this.ngc(a,b,l,n,p,f))return!0}return!1},r.getPrecedents=function(a,b){var c,d,e,f,g,h=[],i=this.Bj();return i&&(c=i.Mf(a,b)||i.Kf(a,b),d=this.getFormulaInformation(a,b),
e=d.baseRange,f=e?e.row:a,g=e?e.col:b,this.VGb(c,f,g,h),h=B(h)),h},r.getDependents=function(a,b){var c=[],d=this.parent&&this.parent.sheets||[this],e=this.name();return d.forEach(function(d){var f,g,h,i,j,k=d.getRowCount(),l=d.getColumnCount(),m=d.name();for(f=0;f<k;f++)for(g=0;g<l;g++)for(h=d.getPrecedents(f,g),i=0;i<h.length;i++)if(j=h[i],j.sheetName===e&&(j.row===-1||j.row<=a&&a+1<=j.row+j.rowCount)&&(j.col===-1||j.col<=b&&b+1<=j.col+j.colCount)){c.push({row:f,col:g,rowCount:1,colCount:1,sheetName:m});break}}),c},r.VXc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m={},n=this.Bj().qg(a,b),o=this.Bj().ug();if(n){c=n[0];for(d in c)c.hasOwnProperty(d)&&(e=c[d],f=e.ah.xf,g=f?f.kj.name():this.name(),h=f?f.kj._id:this._id,m[h+" "+e.row+" "+e.column]={row:e.row,col:e.column,rowCount:1,colCount:1,sheetName:g})}if(o){i=o[0];for(d in i)if(i.hasOwnProperty(d)&&(j=i[d],(j.row===-1||j.row<=a&&a+1<=j.row+j.rowCount)&&(j.col===-1||j.col<=b&&b+1<=j.col+j.colCount))){k=j.content;for(l in k)e=k[l],f=e.ah.xf,g=f?f.kj.name():this.name(),h=f?f.kj._id:this._id,m[h+" "+e.row+" "+e.column]={row:e.row,col:e.column,rowCount:1,colCount:1,sheetName:g}}}return H(m)};function H(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}r.VGb=function(a,b,c,d){var e,f,h,i,j,k;if(a)switch(e=a.type){case g.ExpressionType.reference:case g.ExpressionType.structReference:f=a.getRange(b,c),d.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:a.source&&a.source.kj?a.source.kj.name():this.name()});break;case g.ExpressionType.operator:this.VGb(a.value,b,c,d),this.VGb(a.value2,b,c,d);break;case g.ExpressionType.expand:case g.ExpressionType.parentheses:this.VGb(a.value,b,c,d);break;case g.ExpressionType.name:h=this.$u(a.value),this.VGb(h.getExpression(),b,c,d);break;case g.ExpressionType.function:for(i=a.arguments,j=0;j<i.length;j++)k=i[j],this.VGb(k,b,c,d)}},r.hasFormula=function(a,b){var c=this.Bj();return!!c&&c.hasFormula(a,b)},r.dv=function(){var a=this.Bj();a&&a.oYc(function(a){a.ng(),a.og()})},r.clearFormula=function(a,b,c,d,e){var f,g,h=this;for(a<0&&(a=0,c=h.getRowCount()),b<0&&(b=0,d=h.getColumnCount()),f=0;f<c;f++)if(e(h,f+a))for(g=0;g<d;g++)h.setFormula(f+a,g+b,j)},r.nameFunctionsFromJSON=function(a,b,c,d){var f,g,h,i,j,k,l,m,n;if(a){if(f=this,g=a.customFunctions)for(h in g)g.hasOwnProperty(h)&&(i=g[h],j=e.getTypeFromString(i.typeName),j&&(k=new j,k.fromJSON(i,b),f.Xu(k)));if(l=a.names,l&&l.length>0){for(m=0;m<l.length;m++)n=l[m],f.Yu(n.name,n.formula,n.row,n.col,!0,n.comment);f.dv()}d&&d()}},r.formulaFromJSON=function(a,b,c){var d,e,f;a&&(d=this,e=c&&c.ignoreFormula,f=c&&c.incrementalLoading,[a.colHeaderData,a.rowHeaderData,a.data].forEach(function(a,b){var g,h,i,j;a&&!e&&a.dataTable&&(g=b+1,h=a.dataTable,i=d.getRowCount(g),j=d.getColumnCount(g),f?E(d,h,i,j,c,0,g):F(d,h,i,j,g))}),f?c.incrementLoadTask.pushTask(G,[d,a,b,c]):G(d,a,b,c))},r.ev=function(a){var b=this,c=b.Wu;c&&!a||(b.Wu=a?a:new g.CalcService,b.yj(d.SheetArea.colHeader).setCalcService(b.Wu),b.yj(d.SheetArea.rowHeader).setCalcService(b.Wu),b.yj(d.SheetArea.viewport).setCalcService(b.Wu),b.Wu.initParserContext(b.yj()),c?(a.setSourceModel(b.fDc,c.getSourceModel(b.fDc)),a.setSourceModel(b.hDc,c.getSourceModel(b.hDc)),a.setSourceModel(b.ft,c.getSourceModel(b.ft))):(b.eDc=b.Wu.getSourceModel(b.fDc),b.gDc=b.Wu.getSourceModel(b.hDc),b.et=b.Wu.getSourceModel(b.ft)))},r.setCalc=function(a,b){this.Wu=a,this.ft=b||this.ft,this.et=a.getSourceModel(this.ft),this.parent&&(this.parent.Wu=a)},r.fv=function(){this.gv(!1,1)},r.mUa=function(a,b){var c,e,f,g,h,i,j,k,l=this,m=a.changeType,n=a.row,o=a.rowCount,p=a.col,q=a.colCount,r=l.Bj();r&&(c=l.ITa,e=c.dUa(),f=w(r),g=r.xf,h=f.ih(),i=f.lh.asyncManager,"addingRows"===m?l.Vq(n,0,0,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!0,!0),J(l,n,o,!0,!0),[r,j].forEach(function(a){a.addRows(n,o)}),i.addRows(g,n,o)):a.canAdd=!1:"addRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!0,b,j),f.resume(!1),e&&e.push({type:"addRows",row:n,rowCount:o})):"deletingRows"===m?l.Vq(n,0,o,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!1,!0),J(l,n,o,!1,!0),[r,j].forEach(function(a){a.deleteRows(n,o)}),i.deleteRows(g,n,o)):a.canDelete=!1:"deleteRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!1,b,j),f.resume(!1),e&&e.push({type:"deleteRows",row:n,rowCount:o})):"addingColumns"===m?l.Vq(0,p,l.getRowCount(),0,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!0,!1),J(l,p,q,!0,!1),[r,k].forEach(function(a){a.addColumns(p,q)}),i.addColumns(g,n,o)):a.canAdd=!1:"addColumns"===m?(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!0,b,k),f.resume(!1),e&&e.push({type:"addColumns",col:p,colCount:q})):"deletingColumns"===m?l.Vq(0,p,l.getRowCount(),q,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!1,!1),J(l,p,q,!1,!1),[r,k].forEach(function(a){a.deleteColumns(p,q)}),i.deleteColumns(g,n,o)):a.canDelete=!1:"deleteColumns"===m&&(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!1,b,k),f.resume(!1),e&&e.push({type:"deleteColumns",col:p,colCount:q})))},r.nUa=function(a,b,c){var d=c.type,e=this;"addRows"===d?(c.changeType="deletingRows",e.mUa(c,!0),c.changeType="deleteRows",e.mUa(c,!0)):"deleteRows"===d?(c.changeType="addingRows",e.mUa(c,!0),c.changeType="addRows",e.mUa(c,!0)):"addColumns"===d?(c.changeType="deletingColumns",e.mUa(c,!0),c.changeType="deleteColumns",e.mUa(c,!0)):"deleteColumns"===d?(c.changeType="addingColumns",e.mUa(c,!0),c.changeType="addColumns",e.mUa(c,!0)):"customName"===d?c.nameInfo.fg(c.expr):"condition"===d&&c.condition.setExpressions(c.expressions)},r.gUa=function(a){var b,c=w(this),d=this.Bj();for(c.suspend();a.length;)b=a.pop(),b.type?this.nUa(c,d,b):d.$Va.apply(d,b);c.resume(!1)},r.getReferenceRange=function(a){var b,c,e,f=this.yj(),h=this.getCalcService(),i=h.evaluate(f,a,0,0,!0);if(i instanceof g.CalcReference&&(b=i.getSource().getName(),i.getRangeCount()>0))return c=0,e=d.kf(i.getRow(c),i.getColumn(c),i.getRowCount(c),i.getColumnCount(c)),{sheetName:b,range:e}};function I(a,b){if(!b)return!0;var c=a.getRow(),e=a.getColumn(),f=a.getExpression(),g=f.getRange(c,e);return!!g&&(g instanceof d.Range||(g=new d.Range(g.row,g.col,g.rowCount,g.colCount)),!g.containsRange(b))}function J(a,b,c,d,e,f){var g,h,i,j,k,m,n,o,q,r=!d&&a.ITa.dUa();if(!a.parent||!a.parent.sheets)return g=a.getCustomNames(),void(g&&l(g,function(g,j){I(j,f)&&(h=j.getExpression(),i=K(a,a,b,c,d,e,h),i!==h&&j.fg(i,r))}));for(j=a.parent.sheets,k=a.parent.getCustomNames(),m=a.parent.ELb(),n=!p(a.parent.AO)&&a.parent.aXc(),k&&l(k,function(g,j){I(j,f)&&(h=j.getExpression(),i=K(null,a,b,c,d,e,h),i!==h&&j.fg(i,r))}),m&&l(m,function(g,j){I(j,f)&&(h=j.getExpression(),i=K(null,a,b,c,d,e,h),i!==h&&j.fg(i,r))}),n&&l(n,function(g,j){I(j,f)&&(h=j.getExpression(),i=K(null,a,b,c,d,e,h),i!==h&&j.fg(i,r))}),o=function(k){g=j[k].getCustomNames(),g&&l(g,function(g,l){I(l,f)&&(h=l.getExpression(),i=K(j[k],a,b,c,d,e,h),i!==h&&l.fg(i,r))})},q=0;q<j.length;q++)o(q)}b.kDc=J;function K(a,b,c,d,e,f,h){var i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,L,M,N,O;if(h){if(i=b.yj(),k=g.Hh(g.Errors.Reference,i),9===h.type){if(m=h.value,n=h.value2,o=K(a,b,c,d,e,f,m),p=n&&K(a,b,c,d,e,f,n),m!==o||n!==p)return g.Kh(h.operatorType,o,p)}else if(7===h.type){for(q=!1,r=[],s=void 0,t=0;t<h.arguments.length;t++)s=h.arguments[t],u=K(a,b,c,d,e,f,s),q=q||s!==u,r.push(u);if(q)return g.Jh(h,r)}else if(1===h.type&&h.sf()){if(l=h.source||a&&a.yj(),v=h.row,w=h.column,x=v,y=w,l&&l===i&&(f&&!h.rowRelative||!f&&!h.columnRelative)){if(f&&e)v+=v>=c?d:0;else if(!f&&e)w+=w>=c?d:0;else if(f){if(v>=c+d)v-=d;else if(v>=c)return k}else if(w>=c+d)w-=d;else if(w>=c)return k;if(v!==x||w!==y)return g.rf(i,j,v,w,h.rowRelative,h.columnRelative)}}else if(1===h.type){if(l=h.source||a&&a.yj(),z=h.row,A=h.column,B=h.endRow,C=h.endColumn,D=h.rowRelative,E=h.columnRelative,F=h.endRowRelative,G=h.endColumnRelative,H=z,I=A,J=B,L=C,l&&l===i){if(f&&e)z+=!D&&z>=c?d:0,B+=!F&&B>=c?d:0;else if(!f&&e)A+=!E&&A>=c?d:0,C+=!G&&C>=c?d:0;else if(f&&!e){if(!D&&z>=c&&!F&&B<c+d)return k;if(D&&F||B<c)return h;if(!D)if(z>=c+d)z-=d;else if(z<c);else{if(F)return k;z>c&&(z=c)}if(!F)if(B>=c+d)B-=d;else{if(D)return k;B<c+d&&(B=c-1)}}else{if(!E&&A>=c&&!G&&C<c+d)return k;if(E&&G||C<c)return h;if(!E)if(A>=c+d)A-=d;else if(A<c);else{if(G)return k;A>c&&(A=c)}if(!G)if(C>=c+d)C-=d;else{if(E)return k;C<c+d&&(C=c-1)}}if(A!==I||C!==L||z!==H||B!==J)return g.uf(i,j,z,A,B,C,D,E,F,G)}}else if(10===h.type){if(M=h.value,N=K(a,b,c,d,e,f,M),M!==N)return g.Lh(N)}else 13===h.type&&(l=h.source||a&&a.yj(),l&&l===i&&!f&&(O=h,h=O.offsetWhenInsertRemoveColumn(c,d,e)));return h}}function L(a,b){var c,d,e,f,g,h,i,j=b.ah,k=j.getSource(),l=-1,m=-1;b.name?(d=b.name,f=b.id,p(f)?c=j.getNodeByName(d):(c={Lf:b.expression},e=!0)):(l=b.row,m=b.column,l=void 0===l?-1:l,m=void 0===m?-1:m,c=j.getNode(l,m)),g=c.Lf,h=c.Pf,i=a.unparse(k,g,l<0?0:l,m<0?0:m),h&&(a.allowDynamicArray!==!0||a.allowDynamicArray===!0&&!h.isDynamicArray)?l===h.row&&m===h.col&&j.setArrayFormula(h.row,h.col,h.rowCount,h.colCount,i):d?e?j.setFormula(f,d,i):j.setFormulaByName(d,i):j.setFormula(l,m,i,null,!0,!0),c.Lf.ehc=g.ehc}function M(a){var b,c,e,f,h,i,j,k,l,m,n,o=w(a),p=o.getSourceModel(a.yj(d.SheetArea.colHeader)),q=o.getSourceModel(a.yj(d.SheetArea.rowHeader)),r=o.getSourceModel(a.yj()),s=[p,q,r];for(b=0;b<s.length;b++){if(c=s[b],!c)return;for(e=c.getAllNodes(),f=0;f<e.length;f++)if(h=e[f],i=h.calc)for(j=i.Ze,k=void 0,l=0;l<j.length;l++)if(m=i[j[l]])for(n in m)k=m[n],k&&k instanceof g.PathCalc&&L(o,k)}}function N(a,b,c,d,e,f,g,h,j,k){i.CalcOperatorAdjustor.copyFormula(a.Bj(),b,c,d.Bj(),e,f,g,h,j,k)}b.vyb=N;function O(a,b){var c=a.offset(0,0,!1,0,0);return c.rowRelative=c.endRowRelative=c.columnRelative=c.endColumnRelative=b,c}function P(a,b,c,d,e,f,h,j,k,l){var m,n,o,p,q,r,w,x,y,z,A,B,C,D,E,F,G,H,I;if(9===l.type){if(m=l.value,n=l.value2,o=P(a,b,c,d,e,f,h,j,k,m),p=n&&P(a,b,c,d,e,f,h,j,k,n),m!==o||n!==p)return g.Kh(l.operatorType,o,p)}else if(7===l.type){for(q=!1,r=[],w=void 0,x=0;x<l.arguments.length;x++)w=l.arguments[x],y=P(a,b,c,d,e,f,h,j,k,w),q=q||w!==y,r.push(y);if(q)return g.Jh(l,r)}else if(1===l.type){if(z=!u(l)&&!s(l),A=!v(l)&&!t(l),B=b.yj(),(!l.source||l.source===B)&&z&&A)return C=e.yj(),D=new i.MoveSwapInfo(B,c,d,C,f,h,j,k),E=O(l,!0),F={isCustomName:!0},G=i.adjustFormulaOnMoveSwap(B,0,0,E,D,!0,F),G===E?l:1===G.type&&O(G,!1)||G}else if(10===l.type&&(H=l.value,I=P(a,b,c,d,e,f,h,j,k,H),H!==I))return g.Lh(I);return l}b.uyb=P,d.Worksheet.$n("calc",{priority:1e3,init:y,dispose:function(a){var b,c,d,e=this;a.clearCache!==!1&&(e.ft=j,e.hDc=j,e.fDc=j,e.Wu=j,b=e.et,b&&(a.isSheetDestroy===!0?b.eHb():b.rzb(),e.et=j),c=e.gDc,c&&(a.isSheetDestroy===!0?c.eHb():c.rzb(),e.gDc=j),d=e.eDc,d&&(a.isSheetDestroy===!0?d.eHb():d.rzb(),e.eDc=j))},attach:function(a){var b=this;a instanceof d.Workbook?b.ev(a.Wu):b.ev()},onLayoutChanged:function(a){this.Cf().isAdjustSuspended()||this.mUa(a)},toJson:function(a,b){var c,e,f,g,h,i,j,k,m=this,n=m.Su;d.GC$.isEmptyObject(n)||(a.customFunctions=n),c=b&&b.newWorkSheetName,e=[],f=m.getCustomNames(),g=w(m),h=m.Bj(),i=h.xf,f&&g&&(!p(c)&&h&&i&&(i.JXc=c),l(f,function(a,b){var c,d,f=b.getName(),h=b.getRow(),i=b.getColumn(),j=b.getExpression(),k=b.getComment();j&&(c=g.unparse(m.yj(),j,h,i,!1,!0,!0),d={name:f,formula:c,row:h,col:i},k&&(d.comment=k),e.push(d))}),e.length>0&&(a.names=e),delete i.JXc),j=b&&b.ignoreFormula,j||(k=[m.et,m.eDc,m.gDc],[a.data,a.colHeaderData,a.rowHeaderData].forEach(function(a,b){var d=k[b];d&&(i=d.xf,p(c)||(i.JXc=c),d.toJSON({data:a}),delete i.JXc)}))},fromJson:function(a,b,c,d){var e=this,f=c&&c.incrementalLoading;f||(e.clearCustomFunctions(),e.clearCustomNames()),d&&(e.nameFunctionsFromJSON(a,b,c),e.formulaFromJSON(a,b,c))},setName:function(a){var b,c,d;M(this),b=this.Bj(),c=w(b),d=c.lh.asyncManager,d.changeSourceName(a.oldName,a.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./node_modules/process/browser.js":function(a,b){var c,d,e,f,g,h,i=a.exports={};function j(){throw Error("setTimeout has not been defined")}function k(){throw Error("clearTimeout has not been defined")}!function(){try{c="function"==typeof setTimeout?setTimeout:j}catch(a){c=j}try{d="function"==typeof clearTimeout?clearTimeout:k}catch(a){d=k}}();function l(a){if(c===setTimeout)return setTimeout(a,0);if((c===j||!c)&&setTimeout)return c=setTimeout,setTimeout(a,0);try{return c(a,0)}catch(b){try{return c.call(null,a,0)}catch(b){return c.call(this,a,0)}}}function m(a){if(d===clearTimeout)return clearTimeout(a);if((d===k||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(b){try{return d.call(null,a)}catch(b){return d.call(this,a)}}}e=[],f=!1,h=-1;function n(){f&&g&&(f=!1,g.length?e=g.concat(e):h=-1,e.length&&o())}function o(){var a,b;if(!f){for(a=l(n),f=!0,b=e.length;b;){for(g=e,e=[];++h<b;)g&&g[h].run();h=-1,b=e.length}g=null,f=!1,m(a)}}i.nextTick=function(a){var b,c=Array(arguments.length-1);if(arguments.length>1)for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];e.push(new p(a,c)),1!==e.length||f||l(o)};function p(a,b){this.fun=a,this.array=b}p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function q(){}i.on=q,i.addListener=q,i.once=q,i.off=q,i.removeListener=q,i.removeAllListeners=q,i.emit=q,i.prependListener=q,i.prependOnceListener=q,i.listeners=function(a){return[]},i.binding=function(a){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function a(b,c){b.super_=c,b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function a(b,c){b.super_=c;var d=function(){};d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b}},"./node_modules/util/support/isBufferBrowser.js":function(a,b){a.exports=function a(b){return b&&"object"==typeof b&&"function"==typeof b.copy&&"function"==typeof b.fill&&"function"==typeof b.readUInt8}},"./node_modules/util/util.js":function(a,b,c){(function(a){var d,e,f,g,h=Object.getOwnPropertyDescriptors||function a(b){var c,d=Object.keys(b),e={};for(c=0;c<d.length;c++)e[d[c]]=Object.getOwnPropertyDescriptor(b,d[c]);return e},i=/%[sdj%]/g;b.format=function(a){var b,c,d,e,f,g;if(!y(a)){for(b=[],c=0;c<arguments.length;c++)b.push(j(arguments[c]));return b.join(" ")}for(c=1,d=arguments,e=d.length,f=(a+"").replace(i,function(a){if("%%"===a)return"%";if(c>=e)return a;switch(a){case"%s":return d[c++]+"";case"%d":return+d[c++];case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),g=d[c];c<e;g=d[++c])f+=v(g)||!C(g)?" "+g:" "+j(g);return f},b.deprecate=function(c,d){if(void 0!==a&&a.noDeprecation===!0)return c;if(void 0===a)return function(){return b.deprecate(c,d).apply(this,arguments)};var e=!1;function f(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d),e=!0}return c.apply(this,arguments)}return f},d={},b.debuglog=function(c){if(A(e)&&(e=a.env.NODE_DEBUG||""),c=c.toUpperCase(),!d[c])if(RegExp("\\b"+c+"\\b","i").test(e)){var f=a.pid;d[c]=function(){var a=b.format.apply(b,arguments);console.error("%s %d: %s",c,f,a)}}else d[c]=function(){};return d[c]};function j(a,c){var d={seen:[],stylize:l};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),u(c)?d.showHidden=c:c&&b.Ia(d,c),A(d.showHidden)&&(d.showHidden=!1),A(d.depth)&&(d.depth=2),A(d.colors)&&(d.colors=!1),A(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=k),n(d,a,d.depth)}b.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function k(a,b){var c=j.styles[b];return c?"\x1b["+j.colors[c][0]+"m"+a+"\x1b["+j.colors[c][1]+"m":a}function l(a,b){return a}function m(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function n(a,c,d){var e,f,g,h,i,j,k,l,u,v;if(a.customInspect&&c&&F(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c))return e=c.inspect(d,a),y(e)||(e=n(a,e,d)),e;if(f=o(a,c))return f;if(g=Object.keys(c),h=m(g),a.showHidden&&(g=Object.getOwnPropertyNames(c)),E(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return p(c);if(0===g.length){if(F(c))return i=c.name?": "+c.name:"",a.stylize("[Function"+i+"]","special");if(B(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(D(c))return a.stylize(Date.prototype.toString.call(c),"date");if(E(c))return p(c)}return j="",k=!1,l=["{","}"],t(c)&&(k=!0,l=["[","]"]),F(c)&&(u=c.name?": "+c.name:"",j=" [Function"+u+"]"),B(c)&&(j=" "+RegExp.prototype.toString.call(c)),D(c)&&(j=" "+Date.prototype.toUTCString.call(c)),E(c)&&(j=" "+p(c)),0!==g.length||k&&0!=c.length?d<0?B(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special"):(a.seen.push(c),v=k?q(a,c,d,h,g):g.map(function(b){return r(a,c,d,h,b,k)}),a.seen.pop(),s(v,j,l)):l[0]+j+l[1]}function o(a,b){if(A(b))return a.stylize("undefined","undefined");if(y(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return x(b)?a.stylize(""+b,"number"):u(b)?a.stylize(""+b,"boolean"):v(b)?a.stylize("null","null"):void 0}function p(a){return"["+Error.prototype.toString.call(a)+"]"}function q(a,b,c,d,e){var f,g,h=[];for(f=0,g=b.length;f<g;++f)K(b,f+"")?h.push(r(a,b,c,d,f+"",!0)):h.push("");return e.forEach(function(e){e.match(/^\d+$/)||h.push(r(a,b,c,d,e,!0))}),h}function r(a,b,c,d,e,f){var g,h,i;if(i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},i.get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),K(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(i.value)<0?(h=v(c)?n(a,i.value,null):n(a,i.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),A(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function s(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function t(a){return Array.isArray(a)}b.isArray=t;function u(a){return"boolean"==typeof a}b.isBoolean=u;function v(a){return null===a}b.isNull=v;function w(a){return null==a}b.isNullOrUndefined=w;function x(a){return"number"==typeof a}b.isNumber=x;function y(a){return"string"==typeof a}b.isString=y;function z(a){return"symbol"==typeof a}b.isSymbol=z;function A(a){return void 0===a}b.isUndefined=A;function B(a){return C(a)&&"[object RegExp]"===H(a)}b.isRegExp=B;function C(a){return"object"==typeof a&&null!==a}b.isObject=C;function D(a){return C(a)&&"[object Date]"===H(a)}b.isDate=D;function E(a){return C(a)&&("[object Error]"===H(a)||a instanceof Error)}b.isError=E;function F(a){return"function"==typeof a}b.isFunction=F;function G(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}b.isPrimitive=G,b.isBuffer=c("./node_modules/util/support/isBufferBrowser.js");function H(a){return Object.prototype.toString.call(a)}function I(a){return a<10?"0"+a.toString(10):a.toString(10)}f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var a=new Date,b=[I(a.getHours()),I(a.getMinutes()),I(a.getSeconds())].join(":");return[a.getDate(),f[a.getMonth()],b].join(" ")}b.log=function(){console.log("%s - %s",J(),b.format.apply(b,arguments))},b.inherits=c("./node_modules/util/node_modules/inherits/inherits_browser.js"),b.Ia=function(a,b){var c,d;if(!b||!C(b))return a;for(c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a};function K(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,b.promisify=function a(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');if(g&&b[g]){var c=b[g];if("function"!=typeof c)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),c}function c(){var a,c,d,e=new Promise(function(b,d){a=b,c=d}),f=[];for(d=0;d<arguments.length;d++)f.push(arguments[d]);f.push(function(b,d){b?c(b):a(d)});try{b.apply(this,f)}catch(a){c(a)}return e}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),g&&Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(c,h(b))},b.promisify.custom=g;function L(a,b){if(!a){var c=Error("Promise was rejected with a falsy value");c.reason=a,a=c}return b(a)}function M(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');function c(){var c,d,e,f,g=[];for(c=0;c<arguments.length;c++)g.push(arguments[c]);if(d=g.pop(),"function"!=typeof d)throw new TypeError("The last argument must be of type Function");e=this,f=function(){return d.apply(e,arguments)},b.apply(this,g).then(function(b){a.nextTick(f,null,b)},function(b){a.nextTick(L,b,f)})}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),Object.defineProperties(c,h(b)),c}b.callbackify=M}).call(this,c("./node_modules/process/browser.js"))},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});;/*!
 * 
 * SpreadJS Library 15.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.ConditionalFormatting=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/conditional/conditional.entry.js")}({"./dist/plugins/conditional/conditional.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/conditional/conditional.js")),d(c("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("CalcEngine"),g=c("./dist/plugins/conditional/conditional.ns.js"),h=c("CalcEngine"),i=c("Core"),j=c("SheetsCalc"),k=c("./dist/plugins/conditional/conditionalFormatIcon.js"),l=e.GC$,m=d.Common.u,n=null,o=void 0,p="undefined",q="string",r="true",s=Math.min,t=Math.max,u=Math.abs,v=Math.floor,w=Math.ceil,x=f.Convert,y=x.Na,z=x.Pa,A=x.Th,B=d.Common.u,C=B.Db,D=B.kb,E=B.jb,F=B.Bb,G=d.Common.j.Fa,H=d.Common.q,I=d.Common.F,J=e.Ul,K=e.Zn,L=J.T$a,M=J.l_a,N=!!f,O=e.Style,P=d.Common.k,Q=d.Common.pc,R=Q.bc,S=e.kf,T=e.Range,U=d.Common.l,V=d.Common.k,W=V.Fb,X=V.Cb,Y=V.ac,Z=f.Functions,$=f.evaluateOperator,_=e.Rm,aa=new d.Common.ResourceManager(g.SR,"ConditionalFormatting"),ba=aa.getResource.bind(aa),ca=function(a){return/[\f\n\r\t\v]/.test(a)},da=function(a){var b=a.row<0?j.BAND_INDEX_CONST:a.row,c=a.col<0?j.BAND_INDEX_CONST:a.col;return h.uf(n,n,b,c,b+a.rowCount-1,c+a.colCount-1)},ea=function(a){var b;if(a instanceof f.Expression)b=a;else if(a instanceof T)b=da(a);else{if(!y(a))throw ba().Exp_NotSupport;a=z(a),isNaN(a)||(b=new f.Expression(2),b.value=a)}return b};function mb(a,b,c){var d,e;for(d=0;d<a.length;d++)if(e=a[d],e.contains(b,c))return e}function nb(a){return a.rowCount}function ob(a){return a.colCount}fa=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==o?d?d.call(i,g[e]):g[e]:f:(g[e]!==a&&(h=g[e]!==o?g[e]:f,g[e]=a,b!==!1&&c&&c.call(i,a,h)),i)};return g.isDefault=function(a){return a===f},g},ga=function(a,b,c){var d=this;return c||(c={}),b||(b=d),G(d.pivotTableName)||(c.pivot=!0),l.each(b,function(b,e){var f,g=d[e];G(g)||(f=g.call(d),"formula"===e?(d.getFormulaString?f=d.getFormulaString(a,o,o,!0):d.condition()&&d.condition().getFormulaString&&(f=d.condition().getFormulaString(a,o,o,!0)),f&&(c[e]=f)):"iconCriteria"===e||"icons"===e?c[e]=f:U.Ska(f)?c[e]=U.Daa(f):f&&f.toJSON?c[e]=f.toJSON(a):G(f)||g.isDefault(f)||(c[e]=f))}),c},ha=function(a,c,d,e){if(d){var f=this,g;c||(c=f),l.each(c,function(c,h){var i,j,k,m,n,o,p,r,s,t;if(g=d[h],!G(g))if("ranges"===h){for(i=[],j=0;j<g.length;j++)k=g[j],i.push(S(k.row,k.col,nb(k),ob(k)));f.ranges(i,!1)}else if("style"===h)f.style(new O,!1),f.style().fromJSON(g,e);else if("iconCriteria"===h)for(m=g.length,n=0;n<m;n++)o=g[n],f.NV[n]=new eb(o.isGreaterThanOrEqualTo,o.iconValueType,o.iconValue);else if("icons"===h)for(p=g.length,r=0;r<p;r++)s=g[r],f.CZa[r]={iconSetType:s.iconSetType,iconIndex:s.iconIndex};else"iconSetType"===h?f[h](g,!0):"item1"===h||"item2"===h?(f[h](b.$V(),!1),f[h]().fromJSON(g,a)):"expected"===h?l.getType(g)!==q||5!==d.conType&&13!==d.conType?f[h](g,!1):"/OADate("===g.substr(0,8)?f[h](U.Rka(g),!1):f[h](new Date(g)):"condition"===h?(t=new Ta,t.fromJSON(g,a),f.condition(t,!1)):l.getType(g)===q&&"/OADate("===g.substr(0,8)?f[h](U.Rka(g),!1):f[h](g,!1)})}};function pb(a,b,c,d){switch(d&&"string"==typeof b&&"string"==typeof c&&(b=b.toLowerCase(),c=c.toLowerCase()),a){case ka.equalsTo:return b===c;case ka.notEqualsTo:return b!==c;case ka.greaterThan:return b>c;case ka.greaterThanOrEqualsTo:return b>=c;case ka.lessThan:return b<c;case ka.lessThanOrEqualsTo:return b<=c;default:return!1}}ia=e.lUa,l.extend(ia.prototype,{YUa:function(a){var b,c=this,d=c.zTa;!d||!a&&d.originalConditionalRules||(b=c.U5.AW.map(function(a){return{rule:a,ranges:a.ranges().slice()}}),a?d.currentConditionalRules=b:d.originalConditionalRules=b)},$Ua:function(a){var b=this.U5,c=this.kj;c.suspendPaint(),a&&(0===a.length&&b.AW&&1===b.AW.length&&b.constructor.ao(c,"onRuleUpdated",{ranges:b.AW[0].ranges()}),b.AW=a.map(function(a){var d=a.rule;return d.ranges(a.ranges),b.constructor.ao(c,"onRuleUpdated",{ranges:d.ranges()}),d}),b.QV()),c.resumePaint()},_Ua:function(a,b,c,d){this.YUa(),this.U5.rI(a,b,c,d),this.YUa(!0)},aVa:function(a,b,c,d){this.YUa(),this.U5.GR(a,b,c,d),this.YUa(!0)},bVa:function(a,b,c,d){this.YUa(),this.U5.tI(a,b,c,d),this.YUa(!0)},cVa:function(a,b,c,d){this.YUa(),this.U5.HR(a,b,c,d),this.YUa(!0)},dVa:function(){this.YUa(),this.U5.Nm(),this.YUa(!0)},eVa:function(){this.YUa(),this.U5.QV()}}),ia.$n("conditionalFormat",{init:function(){this.U5=new kb(this.kj)},undo:function(a){var b=a.originalConditionalRules;b&&this.$Ua(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.U5&&(b.U5.no(),b.U5=n)}}),ja={init:function(){this.conditionalFormats=this.ITa.U5},dispose:function(a){if(a.clearCache!==!1){var b=this.conditionalFormats;b&&b.OV()}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=nb(a),e=a.col,f=ob(a),g=a.sheetArea,h=this.ITa,i=this.tables;"addRows"===b?h._Ua(c,d,i&&i.KFc(c,-1,d,-1,!0),!1):"deleteRows"===b?h.aVa(c,d):"addColumns"===b?h.bVa(e,f):"deleteColumns"===b?h.cVa(e,f):"clear"===b?h.dVa():"setColumnCount"!==b&&"setRowCount"!==b||3!==g&&1!==g||h.eVa()},toJson:function(a,b){var c=this.conditionalFormats,d=b&&b.ignoreStyle;c&&!d&&(a.conditionalFormats=c.toJSON(this))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;a&&a.conditionalFormats&&!d&&this.conditionalFormats.fromJSON(a.conditionalFormats,this,b,!0)}},e.Worksheet.$n("conditionalFormat",ja),e.Workbook.$n("conditionalFormat",{fromJson:function(a,b,c){this.sheets.forEach(function(a){a.conditionalFormats&&a.conditionalFormats.getRules().forEach(function(a){a.S$a()})})},onCultureChanged:function(){ba()}}),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(ka=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={})),la=[9,10,13,14,11,12],function(a){a[a.or=0]="or",a[a.and=1]="and"}(ma=b.LogicalOperators||(b.LogicalOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(na=b.ComparisonOperators||(b.ComparisonOperators={})),function(a){a[a.contains=0]="contains",a[a.doesNotContain=1]="doesNotContain",a[a.beginsWith=2]="beginsWith",a[a.endsWith=3]="endsWith"}(oa=b.TextComparisonOperators||(b.TextComparisonOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain"}(pa=b.TextCompareType||(b.TextCompareType={})),function(a){a[a.backgroundColor=0]="backgroundColor",a[a.foregroundColor=1]="foregroundColor"}(qa=b.ColorCompareType||(b.ColorCompareType={})),function(a){a[a.empty=0]="empty",a[a.nonEmpty=1]="nonEmpty",a[a.error=2]="error",a[a.nonError=3]="nonError",a[a.formula=4]="formula"}(ra=b.CustomValueType||(b.CustomValueType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo"}(sa=b.DateCompareType||(b.DateCompareType={})),function(a){a[a.dateOccurring=0]="dateOccurring",a[a.yearOccurring=1]="yearOccurring",a[a.quarterOccurring=2]="quarterOccurring",a[a.monthOccurring=3]="monthOccurring",a[a.weekOccurring=4]="weekOccurring",a[a.dayOccurring=5]="dayOccurring",a[a.yearTodate=6]="yearTodate"}(ta=b.DateExConditionExpectType||(b.DateExConditionExpectType={})),function(a){a[a.top=0]="top",a[a.bottom=1]="bottom"}(ua=b.Top10ConditionType||(b.Top10ConditionType={})),function(a){a[a.today=0]="today",a[a.yesterday=1]="yesterday",a[a.tomorrow=2]="tomorrow",a[a.last7Days=3]="last7Days",a[a.thisMonth=4]="thisMonth",a[a.lastMonth=5]="lastMonth",a[a.nextMonth=6]="nextMonth",a[a.thisWeek=7]="thisWeek",a[a.lastWeek=8]="lastWeek",a[a.nextWeek=9]="nextWeek",a[a.nextQuarter=10]="nextQuarter",a[a.thisQuarter=11]="thisQuarter",a[a.lastQuarter=12]="lastQuarter",a[a.nextYear=13]="nextYear",a[a.thisYear=14]="thisYear",a[a.lastYear=15]="lastYear"}(va=b.DateOccurringType||(b.DateOccurringType={})),function(a){a[a.quarter1=0]="quarter1",a[a.quarter2=1]="quarter2",a[a.quarter3=2]="quarter3",a[a.quarter4=3]="quarter4"}(wa=b.QuarterType||(b.QuarterType={})),function(a){a[a.above=0]="above",a[a.below=1]="below",a[a.equalOrAbove=2]="equalOrAbove",a[a.equalOrBelow=3]="equalOrBelow",a[a.above1StdDev=4]="above1StdDev",a[a.below1StdDev=5]="below1StdDev",a[a.above2StdDev=6]="above2StdDev",a[a.below2StdDev=7]="below2StdDev",a[a.above3StdDev=8]="above3StdDev",a[a.below3StdDev=9]="below3StdDev"}(xa=b.AverageConditionType||(b.AverageConditionType={})),function(a){a[a.number=0]="number",a[a.lowestValue=1]="lowestValue",a[a.highestValue=2]="highestValue",a[a.percent=3]="percent",a[a.percentile=4]="percentile",a[a.automin=5]="automin",a[a.formula=6]="formula",a[a.automax=7]="automax"}(ya=b.ScaleValueType||(b.ScaleValueType={})),function(a){a[a.leftToRight=0]="leftToRight",a[a.rightToLeft=1]="rightToLeft"}(za=b.BarDirection||(b.BarDirection={})),function(a){a[a.automatic=0]="automatic",a[a.cellMidPoint=1]="cellMidPoint",a[a.none=2]="none"}(Aa=b.DataBarAxisPosition||(b.DataBarAxisPosition={})),function(a){a[a.threeArrowsColored=0]="threeArrowsColored",a[a.threeArrowsGray=1]="threeArrowsGray",a[a.threeTriangles=2]="threeTriangles",a[a.threeStars=3]="threeStars",a[a.threeFlags=4]="threeFlags",a[a.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",a[a.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",a[a.threeSigns=7]="threeSigns",a[a.threeSymbolsCircled=8]="threeSymbolsCircled",a[a.threeSymbolsUncircled=9]="threeSymbolsUncircled",a[a.fourArrowsColored=10]="fourArrowsColored",a[a.fourArrowsGray=11]="fourArrowsGray",a[a.fourRedToBlack=12]="fourRedToBlack",a[a.fourRatings=13]="fourRatings",a[a.fourTrafficLights=14]="fourTrafficLights",a[a.fiveArrowsColored=15]="fiveArrowsColored",a[a.fiveArrowsGray=16]="fiveArrowsGray",a[a.fiveRatings=17]="fiveRatings",a[a.fiveQuarters=18]="fiveQuarters",a[a.fiveBoxes=19]="fiveBoxes",a[a.noIcons=20]="noIcons"}(Ba=b.IconSetType||(b.IconSetType={})),function(a){a[a.number=1]="number",a[a.percent=4]="percent",a[a.formula=7]="formula",a[a.percentile=5]="percentile"}(Ca=b.IconValueType||(b.IconValueType={})),function(a){a[a.contains=0]="contains"}(Da||(Da={})),function(a){a[a.relationCondition=0]="relationCondition",a[a.numberCondition=1]="numberCondition",a[a.textCondition=2]="textCondition",a[a.colorCondition=3]="colorCondition",a[a.formulaCondition=4]="formulaCondition",a[a.dateCondition=5]="dateCondition",a[a.dateExCondition=6]="dateExCondition",a[a.textLengthCondition=7]="textLengthCondition",a[a.top10Condition=8]="top10Condition",a[a.uniqueCondition=9]="uniqueCondition",a[a.averageCondition=10]="averageCondition",a[a.cellValueCondition=11]="cellValueCondition",a[a.areaCondition=12]="areaCondition",a[a.timeCondition=13]="timeCondition",a[a.stateCondition=14]="stateCondition"}(Ea=b.ConditionType||(b.ConditionType={})),function(a){a[a.conditionRuleBase=0]="conditionRuleBase",a[a.cellValueRule=1]="cellValueRule",a[a.specificTextRule=2]="specificTextRule",a[a.formulaRule=3]="formulaRule",a[a.dateOccurringRule=4]="dateOccurringRule",a[a.top10Rule=5]="top10Rule",a[a.uniqueRule=6]="uniqueRule",a[a.duplicateRule=7]="duplicateRule",a[a.averageRule=8]="averageRule",a[a.twoScaleRule=10]="twoScaleRule",a[a.threeScaleRule=11]="threeScaleRule",a[a.dataBarRule=12]="dataBarRule",a[a.iconSetRule=13]="iconSetRule",a[a.rowStateRule=14]="rowStateRule",a[a.columnStateRule=15]="columnStateRule"}(Fa=b.RuleType||(b.RuleType={})),Ga=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)},Ha=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999)},Ia=function(a,b){a.setDate(b)},Ja=function(a){return a.getDate()},Ka=function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},La=function(a,b){var c=Ha(a);return b>c},Ma=function(a,b){return b>a},Na=function(a,b){var c=Ga(a);return b<c},Oa=function(a,b){return b<a},Pa=function(a,b){return a.getHours()===b.getHours()&&a.getMinutes()===b.getMinutes()&&a.getSeconds()===b.getSeconds()&&a.getMilliseconds()===b.getMilliseconds()},Qa=function(a,b){var c=new Date(1899,11,30,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),d=new Date(1899,11,30,b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds());return d>c},Ra=function(a,b){return!Qa(a,b)&&!Pa(a,b)},b.$V=function(a,b,c,d,e,f,g,h,i){return new Ta(a,{compareType:b,expected:c,formula:d,customValueType:e,type:f,ranges:g,item1:h,item2:i})},b.Cxb=new O,Sa=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"];function qb(a){var b={},c=x.Uh(a,b);return c?b.value:typeof a===q&&a.toLowerCase()===r}Ta=function(){function a(a,b){var c,d;b||(b={}),c=b.formula,d=this,d.offsetRow=0,d.offsetCol=0,d.conType("string"==typeof a?Ea[a]:a),G(b.compareType)||d.RV(b.compareType),G(b.expected)||d.expected(b.expected),G(c)||d.formula("string"==typeof c?C(l.trim(c),"="):c),G(b.item1)||d.item1(b.item1),G(b.item2)||d.item2(b.item2),G(b.customValueType)||d.customValueType(b.customValueType),G(b.type)||d.type(b.type),d.ranges(b.ranges),d.Lf=n,d.TV=n}return a.prototype.context=function(a){if(1===arguments.length){this.xc=a;var b=this.item1(),c=this.item2();b&&b.context&&b.context(a),c&&c.context&&c.context(a)}return this.xc},a.prototype.j_a=function(a){var b=this,c=b.item1(),d=b.item2();a?b.q$a=!0:b.p$a=!0,c&&c.j_a(a),d&&d.j_a(a)},a.prototype.k_a=function(){var a=this,b=a.item1(),c=a.item2();delete a.q$a,delete a.p$a,b&&b.k_a(),c&&c.k_a()},a.prototype.initExpression=function(a,b,c){var d,e,f,g,h,i=this.item1(),j=this.item2();i&&i.initExpression&&i.initExpression(),j&&j.initExpression&&j.initExpression(),a=a||this.xc,d=this.Yw,a&&d&&!this.Lf&&(this.ranges()?(e=M(this.ranges()),b=e.r,c=e.c):(b=b||0,c=c||0),f=a.getCalcService(),g=a.yj(),f&&g&&(h=!1,this.q$a&&(h=!this.p$a),this.Lf=f.parse(g,d,b,c,!1,!0,h)))},a.prototype.expression=function(a,b,c,d){var e,f,g;return 1===arguments.length?(this.Lf=a,b=b||this.xc,a?b&&(this.ranges()?(e=M(this.ranges()),c=e.r,d=e.c):(c=c||0,d=d||0),f=b.getCalcService(),g=b.yj(),f&&g&&(this.Yw=f.unparse(g,a,c,d))):this.Yw=a,this.Lf):(this.Lf||this.initExpression(b,c,d),this.Lf)},a.prototype.getFormulaString=function(a,b,c,d){var e,f,g;return a=a||this.xc,e=this.Lf,f=this.Yw,a&&f?(e||(this.initExpression(a,b,c),e=this.Lf),f&&(e.value&&14===e.value.type||e.value2&&14===e.value2.type)?f:(g=M(this.ranges()),b=G(b)?g.r:b,c=G(c)?g.c:c,a.getCalcService().unparse(a.yj(),e,b,c,o,!!d))):f},a.prototype.formula=function(a,b,c){if("string"!=typeof a){var d=this.item1(),e=this.item2();return 0===c&&d&&d.formula?d.formula(a,b,c):1===c&&e&&e.formula?e.formula(a,b,c):this.getFormulaString(o,a,b)}this.Yw=a,this.Lf=n},a.prototype.adjustOffset=function(a,b){var c=this,d=c.item1();d&&d.adjustOffset&&d.adjustOffset(a,b),d=c.item2(),d&&d.adjustOffset&&d.adjustOffset(a,b),c.offsetRow=a,c.offsetCol=b},a.prototype.relationConditionEvaluate=function(a,b,c,d,e){var f,g,h,i,j=this;function k(d,e){if(a&&d&&3===d.conType()){var f=a.getActualStyle(b,c,3,!0);f&&(0===d.RV()?e=f.backColor:1===d.RV()&&(e=f.foreColor))}return e}function l(a,b){if(a)return a.ignoreBlank(j.ignoreBlank()),arguments.length<5?k(a,d):b}function m(d,e){return!G(d)&&d.evaluate(a,b,c,e)}return f=l(j.item1(),d),g=l(j.item2(),e),h=m(j.item1(),f)?1:0,i=m(j.item2(),g)?1:0,h+i>j.RV()},a.prototype.cellValueConditionEvaluate=function(a,b,c,d){var e=this.getExpected(a,b,c);return!(e!==n||!a||!a.lRa)||this.cellValueConditionCheckCondition(e,d)},a.prototype.cellValueConditionCheckCondition=function(a,b){var c,d,e,f,g=this,h=0,i=!1,j=g.RV();if(G(b)&&G(a))switch(j){case ka.equalsTo:case ka.greaterThanOrEqualsTo:case ka.lessThanOrEqualsTo:return!0;case ka.notEqualsTo:case ka.greaterThan:case ka.lessThan:return!1;default:return!1}if("boolean"==typeof a||"boolean"==typeof b)return pb(j,b,a);if(c={},G(b))g.treatNullValueAsZero()?i=!0:h=b;else{if(typeof b===q&&"number"==typeof a)return pb(j,1,0);"boolean"!=typeof b&&A(b,c)&&(h=c.value,i=!isNaN(h))}return d=0,e=!1,("number"==typeof a||a)&&A(a,c)&&(d=c.value,e=!0),f=la[j],i?e?pb(j,h,d):$(f,b,a):"string"==typeof b?e?$(f,b,d):"string"==typeof a?$(f,b,a):1===j:!!G(b)&&j===ka.notEqualsTo},a.prototype.numberConditionEvaluate=function(a,b,c,d){var e=this.numberConditionGetExpected(a,b,c);return!(e!==n||!a||!a.lRa)||(this.integerValue()&&(e=isNaN(e)?n:e>0?v(e):w(e)),this.numberConditionCheckCondition(e,d))},a.prototype.numberConditionCheckCondition=function(a,b){var c,d,e=this;if((G(b)||""===b)&&e.ignoreBlank())return!0;if(isNaN(b))return!1;if(G(a)){if(e.ignoreBlank())return!0;a=0}try{c=G(b)?0:parseFloat(b)}catch(a){return!1}return!(e.integerValue()&&(d=c-v(c)===0,!d))&&pb(e.RV(),c,a)},a.prototype.numberConditionGetExpected=function(a,b,c){var d,e=this;return e.Yw&&e.Yw.length>0?(d=a.Cf(),d?d.evaluate(a.yj(),e.expression(n,a),b,c):e.expected()):e.expected()},a.prototype.textConditionEvaluate=function(a,b,c,d){var e,f,g,h=this,i=h.compareType(),j=h.ignoreCase();function k(a,b){return h.testTextByCondition(b,a,"^","$",function(){return j?a.toLowerCase()===b.toLowerCase():a===b})}function l(a,b){return h.testTextByCondition(b,a,"^","",function(){return D(b,a,j)})}function m(a,b){return h.testTextByCondition(b,a,"","$",function(){return E(b,a,j)})}function p(a,b){return h.testTextByCondition(b,a,"","",function(){return F(b,a===o||a===n?"":a,j)})}if(!h.forceValue2Text()&&I(d,Date))return i!==pa.beginsWith&&i!==pa.endsWith&&i!==pa.contains&&(i===pa.doesNotBeginWith||i===pa.doesNotEndWith||i===pa.doesNotContain);if(e=G(d)?"":""+d,h.ignoreBlank()&&""===e)return!0;if(f=this.getExpected(a,b,c),g=G(f)?"":""+f,h.hasWildcard(g)&&"number"==typeof d)return i===pa.doesNotBeginWith||i===pa.doesNotContain||i===pa.doesNotEndWith||i===pa.notEqualsTo;switch(i){case pa.equalsTo:return k(g,e);case pa.notEqualsTo:return!k(g,e);case pa.beginsWith:return l(g,e);case pa.doesNotBeginWith:return!l(g,e);case pa.endsWith:return m(g,e);case pa.doesNotEndWith:return!m(g,e);case pa.contains:return p(g,e);case pa.doesNotContain:return!p(g,e);default:return!1}},a.prototype.hasWildcard=function(a){return a.indexOf("*")>-1||a.indexOf("?")>-1},a.prototype.testTextByCondition=function(a,b,c,d,e){var f,g=this.useWildCards();return g?this.regex()?H.qb(this.regex()).test(a):(f=H.ub(b))?(f=c+f+d,this.ignoreCase()?H.sb(f).test(a):H.qb(f).test(a)):e():e()},a.prototype.colorConditionEvaluate=function(a,b,c,e){var f,g,h,i;function j(a){return G(a)||""===a?n:Q.ec(a)}if(f=this,g=j(f.expected()),G(g)||""===g){if(f.ignoreBlank()||G(g)&&G(e))return!0}else if(h=j(e),(G(h)||""===h)&&a&&a.getDefaultStyle&&(i=a.getDefaultStyle(),f.RV()===qa.backgroundColor?h=i.backColor:f.RV()===qa.foregroundColor&&(h=i.foreColor)),!G(h)&&""!==h)return d.Common.pc.Pka(h,g);return!1},a.prototype.formulaConditionEvaluate=function(a,b,c,d){var e,f,g;if(!N)return!1;if(e=this,e.customValueType()===ra.formula)return a.yj().xc=b,f=e.getExpected(a,b,c),!(!e.ignoreBlank()||!G(f)&&""!==f)||qb(f);switch(g=x.vf,e.customValueType()){case ra.empty:return G(d)||""===d;case ra.nonEmpty:return!G(d)&&""!==d;case ra.error:return g(d);case ra.nonError:return!g(d);default:return!1}},a.prototype.formulaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l=this;if(l.Yw&&l.Yw.length>0){if(d=a.Cf(),!d)return l.expected();if(e=d.Hg(a.yj(),l.expression(o,a),h.pf(b,c),!0),f=void 0,g=void 0,i=void 0,j=void 0,k=void 0,x.Fh(e)){for(f=e.getRowCount(0),g=e.getColumnCount(0),i=[],j=0;j<f;j++)for(i[j]=[],k=0;k<g;k++)i[j][k]=e.getValue(0,j,k);e=i}else if(x.Ca(e)){for(f=e.getRowCount(),g=e.getColumnCount(),i=[],j=0;j<f;j++)for(i[j]=[],k=0;k<g;k++)i[j][k]=e.getValue(j,k);e=i}return I(e,Array)?e[0][0]:e}return l.expected()},a.prototype.dateOrTimeEvaluate=function(a,b,c,d,e,f,g){var h,i,j,k=this;if((G(d)||""===d)&&k.ignoreBlank())return!0;if(h=d,!I(d,Date)){if(k.RV()===sa.notEqualsTo)return!0;if(!G(d))return!1;h=U.Xb(0)}if(i=n,j=this.getExpected(a,b,c),I(j,Date)?i=j:"string"==typeof j?i=U.Qa(j):"number"==typeof j&&(i=U.Xb(j)),G(i))return!!k.ignoreBlank();switch(k.RV()){case sa.equalsTo:return e(i,h);case sa.notEqualsTo:return!e(i,h);case sa.after:return g(i,h);case sa.afterEqualsTo:return g(i,h)||e(i,h);case sa.before:return f(i,h);case sa.beforeEqualsTo:return f(i,h)||e(i,h);default:return!1}},a.prototype.dateConditionEvaluate=function(a,b,c,d){var e=this.preciseCompareDate();return this.dateOrTimeEvaluate(a,b,c,d,Ka,e?Oa:Na,e?Ma:La)},a.prototype.timeConditionEvaluate=function(a,b,c,d){return this.dateOrTimeEvaluate(a,b,c,d,Pa,Ra,Qa)},a.prototype.dateExConditionEvaluate=function(a,b,c,d){var e=this.A4(a,b,c);return!G(e)&&this.dateExConditionCheckCondition(e,d)},a.prototype.getExConditionDateScope=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=n,K=n,L=new Date,M=new Date(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds());switch(a){case va.last7Days:Ia(M,Ja(M)-6),J=Ga(M),K=Ha(L);break;case va.yesterday:Ia(M,Ja(M)-1),J=Ga(M),K=Ha(M);break;case va.today:J=Ga(L),K=Ha(L);break;case va.tomorrow:Ia(M,Ja(M)+1),J=Ga(M),K=Ha(M);break;case va.lastWeek:b=L,Ia(b,Ja(L)-L.getDay()-7),c=M,c.setDate(Ja(M)-M.getDay()-1),J=Ga(b),K=Ha(c);break;case va.thisWeek:d=L,Ia(d,Ja(L)-L.getDay()),e=M,Ia(e,Ja(M)-M.getDay()+6),J=Ga(d),K=Ha(e);break;case va.nextWeek:f=L,Ia(f,Ja(L)-L.getDay()+7),g=M,Ia(g,Ja(M)-M.getDay()+13),J=Ga(f),K=Ha(g);break;case va.lastMonth:h=L,Ia(h,1),h.setMonth(L.getMonth()-1),i=M,Ia(i,0),J=Ga(h),K=Ha(i);break;case va.thisMonth:j=L,Ia(j,1),k=M,Ia(k,1),k.setMonth(M.getMonth()+1),Ia(k,0),J=Ga(j),K=Ha(k);break;case va.nextMonth:l=L,Ia(l,1),l.setMonth(L.getMonth()+1),m=M,Ia(m,1),m.setMonth(M.getMonth()+2),Ia(m,0),J=Ga(l),K=Ha(m);break;case va.nextQuarter:o=L,p=o.getMonth(),q=p%3,o.setDate(1),o.setMonth(p-q+3),r=M,s=void 0,r.setDate(1),r.setMonth(p-q+3+2),s=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(s),J=Ga(o),K=Ha(r);break;case va.thisQuarter:t=L,u=t.getMonth(),v=u%3,t.setDate(1),t.setMonth(u-v),w=M,x=void 0,w.setDate(1),w.setMonth(u-v+2),x=2===w.getMonth()||11===w.getMonth()?31:30,w.setDate(x),J=Ga(t),K=Ha(w);break;case va.lastQuarter:y=L,z=y.getMonth(),A=z%3,y.setDate(1),y.setMonth(z-A-3),B=M,C=void 0,B.setDate(1),B.setMonth(z-A-3+2),C=2===B.getMonth()||11===B.getMonth()?31:30,B.setDate(C),J=Ga(y),K=Ha(B);break;case va.nextYear:D=L,D.setDate(1),D.setFullYear(D.getFullYear()+1),D.setMonth(0),E=M,E.setFullYear(E.getFullYear()+1),E.setMonth(11),E.setDate(31),J=Ga(D),K=Ha(E);break;case va.thisYear:F=L,F.setDate(1),F.setMonth(0),G=M,G.setMonth(11),G.setDate(31),J=Ga(F),K=Ha(G);break;case va.lastYear:H=L,H.setFullYear(H.getFullYear()-1),H.setDate(1),H.setMonth(0),I=M,I.setFullYear(I.getFullYear()-1),I.setMonth(11),I.setDate(31),J=Ga(H),K=Ha(I)}return{from:J,to:K}},a.prototype.dateExConditionCheckCondition=function(a,c){var d,e,f,g,h,i,j,k,l,m,o,p;function q(a,b){switch(a){case wa.quarter1:return b.getMonth()>=0&&b.getMonth()<=2;case wa.quarter2:return b.getMonth()>=3&&b.getMonth()<=5;case wa.quarter3:return b.getMonth()>=6&&b.getMonth()<=8;case wa.quarter4:return b.getMonth()>=9&&b.getMonth()<=11;default:return!1}}if(d=this,e=c,d.ignoreBlank()&&(G(e)||""===e))return!0;try{if(G(e)&&!d.treatNullValueAsZero())return!1;e=x.Wh(e)}catch(a){return!1}if(g=d.expectTypeId(),g===ta.dateOccurring){if(h=this.getExConditionDateScope(a),i=h.from,j=h.to,!G(i)&&!G(j))return k=b.$V(Ea.dateCondition,sa.afterEqualsTo,i,n),l=b.$V(Ea.dateCondition,sa.beforeEqualsTo,j,n),m=b.$V(Ea.relationCondition,ma.and,n,n,n,n,n,k,l),m.evaluate(n,0,0,e)}else if(f=d.A4(n,0,0),!G(f)){if(g===ta.yearOccurring)return f===e.getFullYear();if(g===ta.quarterOccurring)return q(f,e);if(g===ta.monthOccurring)return f===e.getMonth();if(g===ta.weekOccurring)return f===e.getDay();if(g===ta.dayOccurring)return f===Ja(e);if(g===ta.yearTodate)return o=new Date,p=new Date,o.setMonth(0,1),o.setHours(0,0,0,0),p.setHours(23,59,59,999),o<=e&&e<=p}return!1},a.prototype.textLengthConditionEvaluate=function(a,b,c,d){var e,f;return!(!G(d)&&""!==d||!this.ignoreBlank())||(e=G(d)?0:(""+d).length,f=this.A4(a,b,c),"number"==typeof f&&pb(this.RV(),e,f))},a.prototype.top10ConditionEvaluate=function(a,b,c,d){var e,f,g,h=this;if(G(d)||""===d)return h.ignoreBlank();if(e=h.A4(a,b,c),!G(e)&&(f=void 0,h.k$a?(G(h.mxb)&&(h.mxb=h.getTopValues(a,e,h.ranges())),f=h.mxb):f=h.getTopValues(a,e,h.ranges()),f)){g=0;try{g=h.Pa(d)}catch(a){return!1}if(V.Bb(f,g))return!0}return!1},a.prototype.A4=function(a,b,c){var d=this.getExpected(a,b,c);return d=parseInt(d,10),isNaN(d)||!isFinite(d)?n:d},a.prototype.adjustRange=function(a,b){return S(a.row,a.col,Math.min(nb(a),b.getRowCount()),Math.min(ob(a),b.getColumnCount()))},a.prototype.getTopValues=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=0===this.type()?1:-1,n=[];if(!c)return n;for(d=this.UV(a,c),e=Y(d),j=0;j<e;j++)for(f=this.adjustRange(d[j],a),k=0;k<nb(f);k++)for(g=k+f.row,l=0;l<ob(f);l++)h=l+f.col,i=this.Pa(a.getValue(g,h)),G(i)||n.push(i);return n.sort(function(a,b){return(b-a)*m}),Y(n)>b&&(n=n.slice(0,b)),n},a.prototype.Pa=function(a){return("number"==typeof a||I(a,Date))&&N?z(a):n},a.prototype.uniqueConditionEvaluate=function(a,b,c,d){var e,f,g,h,i=this,j=d;return G(j)||""===j?i.ignoreBlank():(N&&y(j)&&!ca(j)&&(j=z(j)),e=this.getExpected(a,b,c),f={},x.Uh(e,f),g=f.value,!G(g)&&(h=i.duplicatedArrayCached||i.getDuplicated(a,i.ranges()),!G(h)&&V.Bb(h,j)?g===!0:g!==!0))},a.prototype.getDuplicated=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=[],o={},p=this.UV(a,b);if(p)for(c=Y(p),d=0;d<c;d++)for(e=p[d],e=this.adjustRange(e,a),f=nb(e),g=ob(e),h=0;h<f;h++)for(i=h+e.row,j=0;j<g;j++)k=j+e.col,l=a.getValue(i,k,3),!G(l)&&N&&y(l)&&!ca(l)&&(l=z(l)),m=o[l],m?1===m&&n.push(l):o[l]=1;return n},a.prototype.VV=function(a,b){var c,d=a.length;for(c=0;c<d;c++)if(a[c].key===b)return!0;return!1},a.prototype.averageConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l;if(!N)return!1;if(e=this,e.ignoreBlank()&&(G(d)||""===d))return!0;if(e.WV(),e.k$a?(G(e.mxb)&&(e.mxb=e.getExpected(a,b,c)),f=e.mxb):f=e.getExpected(a,b,c),g={},h=A(f,g)?g.value:NaN,i=n,j=e.TV?e.XV(a,e.TV,b,c):n,G(j)||(g={},i=A(j,g)?g.value:NaN),y(d)&&(k=z(d),!isNaN(h)))switch(l=isNaN(i),e.type()){case xa.above:return k>h;case xa.below:return k<h;case xa.equalOrAbove:return k>=h;case xa.equalOrBelow:return k<=h;case xa.above1StdDev:return!l&&k>h+i;case xa.below1StdDev:return!l&&k<h-i;case xa.above2StdDev:return!l&&k>h+2*i;case xa.below2StdDev:return!l&&k<h-2*i;case xa.above3StdDev:return!l&&k>h+3*i;case xa.below3StdDev:return!l&&k<h-3*i;default:return!1}return!1},a.prototype.WV=function(){var a=this;a.ranges()&&(a.Lf=a.YV("AVERAGE",a.ranges()),a.type()>=4&&a.type()<=9&&(a.TV=a.YV("STDEV",a.ranges())))},a.prototype.YV=function(a,b){var c,d,e,g;if(!N)return n;if(c=Z.findGlobalFunction(a)){for(d=[],e=Y(b),g=0;g<e;g++)d[g]=ea(b[g]);return f.Jh(c,d)}return n},a.prototype.averageConditionGetExpected=function(a,b,c){var d=a.Cf();return d?d.Hg(a.yj(),this.expression(o,a),h.pf(b,c),!1):n},a.prototype.nxb=function(){var a=this.conType();a!==Ea.averageCondition&&a!==Ea.top10Condition||(this.k$a=!0)},a.prototype.oxb=function(){var a=this;a.k$a=!1,a.mxb=o},a.prototype.XV=function(a,b,c,d){var e=a.Cf();return e?e.Hg(a.yj(),b,h.pf(c,d),!1):n},a.prototype.ZV=function(a,b){var c,d;for(d=0;d<Y(b);d++)c=b[d],I(c,Array)&&Y(c)>0?Y(b)>1?a.push(c[0]):a.push.apply(a,c):a.push(c)},a.prototype.getValidList=function(a,b,c){var d,e,f=[],g=this.getValidListImp(a,b,c);for(d=0,e=Y(g);d<e;d++)f.push(g[d].value);return f},a.prototype.CIc=function(){return this.Yw&&this.Yw.length>0},a.prototype.getValidListImp=function(a,b,c){var d,e,f,g,h,i,j,k,m=this,n=[];if(m.Yw&&m.Yw.length>0)d=m.getExpected(a,b,c),I(d,Array)?m.ZV(n,d):n.push(d);else if(m.expected()&&m.expected().length>0&&(e=m.expected(),f=e.replace(/\\,/g,String.fromCharCode(206)),g=f.split(",")))for(h=0;h<Y(g);h++)i=g[h],G(i)||(j=RegExp(String.fromCharCode(206),"g"),k=l.trim(i).replace(j,","),""!==k&&n.push({text:k,value:k}));return n},a.prototype.areaConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j;function k(a,b,c){return I(a,Date)&&I(b,Date)?a.valueOf()===b.valueOf():c||"string"!=typeof a||"string"!=typeof b?a===b:a.toLowerCase()===b.toLowerCase()}if(e=this,G(d)||""===d)return e.ignoreBlank()===!0;for(f=e.getValidList(a,b,c),g=0;g<Y(f);g++){if(h=f[g],G(h)&&G(d))return!0;if(e.Yw){if(k(h,d,!1))return!0}else if(i=a.getActualStyle(b,c,3,!0),j=J.ul(i,h,!0),k(j,d,!0))return!0}return!1},a.prototype.areaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,p,q,r,s=this,u=[];if(s.Yw){if(d=void 0,e=void 0,f=void 0,g=void 0,i=void 0,j=void 0,k=a.Cf(),!k)return u;if(l=k.Hg(a.yj(),s.expression(o,a),h.pf(b,c),!0),x.Fh(l))for(d=l.getRowCount(0),e=l.getColumnCount(0),m=l.getRow(0),n=l.getColumn(0),p=l.xf&&l.xf.kj,p&&(q=p.getRowCount(),r=p.getColumnCount(),d=d>q?t(q-m,0):d,e=e>r?t(r-n,0):e),f=0;f<d;f++)for(u[f]=[],g=0;g<e;g++)i=l.getValue(0,f,g),j=p?p.getText(m+f,n+g):i,u[f][g]={value:i,text:j};else if(x.Ca(l))for(d=l.getRowCount(),e=l.getColumnCount(),f=0;f<d;f++)for(u[f]=[],g=0;g<e;g++)i=l.getValue(f,g),u[f][g]={value:i,text:i}}else u.push({value:s.expected(),text:s.expected()});return u},a.prototype.stateConditionEvaluate=function(a,b,c,d){var e=this.expected();return!(G(d)||G(e)||isNaN(d)||isNaN(d))&&(d&e)>0},a.prototype.reset=function(){var a=this;switch(a.ignoreBlank(!1),a.preciseCompareDate(!1),a.RV(1),a.item1(n),a.item2(n),a.value1=n,a.value2=n,a.expected(n),a.RV(0),a.integerValue(!1),a.operator=0,a.text="",
a.RV(0),a.useWildCards(!0),a.ignoreCase(!1),a.forceValue2Text(!1),a.customValueType(0),a.Lf=n,a.type(0),this.expectTypeId(0),a.ranges(n),a.isPercent(!1),a.regex(n),a.conType()){case Ea.relationCondition:a.ignoreBlank(!1),a.RV(1);break;case Ea.numberCondition:a.RV(0),a.integerValue(!1);break;case Ea.textCondition:a.RV(0),a.useWildCards(!0),a.forceValue2Text(!1);break;case Ea.colorCondition:a.RV(0);break;case Ea.formulaCondition:a.customValueType(0),a.TV=n;break;case Ea.dateCondition:case Ea.timeCondition:a.RV(0);break;case Ea.dateExCondition:a.expectTypeId(0);break;case Ea.textLengthCondition:a.RV(0);break;case Ea.top10Condition:a.type(0);break;case Ea.averageCondition:a.type(0);break;case Ea.cellValueCondition:a.operator=6;break;case Ea.areaCondition:}},a.prototype.evaluate=function(a,b,c,d){var e=this.conType();return!G(e)&&this[Ea[e]+"Evaluate"](a,b,c,d)},a.prototype.getExpectedNormal=function(a,b,c,d,e,f){var g,i=this,j=i.Yw,k=i.expected();return j?(g=a.Cf(),g?g.Hg(a.yj(),i.expression(o,a),h.pf(b,c),!1,f):k):k},a.prototype.getExpected=function(a,b,c){var d=this;switch(d.conType()){case 2:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 8:return d.getExpectedNormal(a,b,c,b,c);case 0:return n;case 1:return d.numberConditionGetExpected(a,b,c);case 3:return n;case 4:return d.formulaConditionGetExpected(a,b,c);case 10:return d.averageConditionGetExpected(a,b,c);case 12:return d.areaConditionGetExpected(a,b,c);default:return n}},a.prototype.UV=function(a,b){var c,d,e,f=[];for(c=0,d=Y(b);c<d;c++)e=a.Tq(b[c]),f.push(e);return f},a.prototype.getExpressions=function(){var a=[],b=this;return 0===b.conType()?(b.item1()&&b.item1().getExpressions&&(a=b.item1().getExpressions()),b.item2()&&b.item2().getExpressions&&(a=a.concat(b.item2().getExpressions())),a):(b.Lf||b.initExpression(),b.Lf?[b.Lf]:[])},a.prototype.setExpressions=function(a,b){var c=this,d;return b&&b.push({type:"condition",condition:this,expressions:c.getExpressions(),newExpressions:a}),0===c.conType()?(c.item1()&&c.item1().setExpressions&&(d=c.item1().getExpressions().length,c.item1().setExpressions(a.slice(0,d))),void(c.item2()&&c.item2().setExpressions&&c.item2().setExpressions(a.slice(d)))):void c.expression(a[0])},a.prototype.toJSON=function(a){var b=ga.call(this,a,Sa);return b.ignoreBlank&&!isNaN(b.ignoreBlank)&&(b.ignoreBlank=0!==parseInt(b.ignoreBlank,10)),b},a.prototype.fromJSON=function(a,b,c){var d,e;a&&(d=this,ha.call(d,b,Sa,a,c),e=b&&b.Wu&&b.Wu.useR1C1,e&&b instanceof i.Worksheet&&(d.context(b),L(d)),d.j_a(!0),d.initExpression(),d.k_a())},a.fromSource=function(a){return b.$V(12,n,a,n)},a.fromFormula=function(a){return b.$V(12,n,"",a)},a.fromDay=function(a){var c=b.$V(6,n,a);return c.expectTypeId(5),c},a.fromMonth=function(a){var c=b.$V(6,n,a);return c.expectTypeId(3),c},a.fromQuarter=function(a){var c=b.$V(6,n,a);return c.expectTypeId(2),c},a.fromWeek=function(a){var c=b.$V(6,n,a);return c.expectTypeId(4),c},a.fromYear=function(a){var c=b.$V(6,n,a);return c.expectTypeId(1),c},a}(),b.Condition=Ta,Ta.prototype.conType=fa("conType",n),Ta.prototype.ranges=fa("ranges",n,function(a){var b=this.item1(),c=this.item2();b&&b.ranges&&b.ranges(a),c&&c.ranges&&c.ranges(a)}),Ta.prototype.ignoreBlank=fa("ignoreBlank",!1),Ta.prototype.preciseCompareDate=fa("preciseCompareDate",!1),Ta.prototype.compareType=fa("compareType",o),Ta.prototype.RV=Ta.prototype.compareType,Ta.prototype.expected=fa("expected",o),Ta.prototype.item1=fa("item1",n),Ta.prototype.item2=fa("item2",n),Ta.prototype.treatNullValueAsZero=fa("treatNullValueAsZero",!1),Ta.prototype.integerValue=fa("integerValue",!1),Ta.prototype.forceValue2Text=fa("forceValue2Text",!1),Ta.prototype.useWildCards=fa("useWildCards",!0),Ta.prototype.regex=fa("regex",n),Ta.prototype.ignoreCase=fa("ignoreCase",!1),Ta.prototype.customValueType=fa("customValueType",o),Ta.prototype.expectTypeId=fa("expectTypeId",0),Ta.prototype.type=fa("type",n),Ta.prototype.isPercent=fa("isPercent",!1);function rb(a,b,c,d,e,f,g,h,i){var j=Math.round;switch(a.lineWidth=1,a.rect(f,g,h,i),c++,c=j(c),d=j(d),a.clip(),b.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:k.drawArrows(a,b.iconSetType,b.iconIndex,c,d,e);break;case 2:k.drawIconTypeIsTwo(a,b.iconSetType,b.iconIndex,c,d,e);break;case 3:k.drawStar(a,b.iconSetType,b.iconIndex,c,d,e);break;case 14:case 12:case 5:k.drawCircle(a,b.iconSetType,b.iconIndex,c,d,e);break;case 4:k.drawFlag(a,b.iconSetType,b.iconIndex,c,d,e);break;case 6:k.drawTrafficLight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 7:k.drawIconTypeIsSen(a,b.iconSetType,b.iconIndex,c,d,e);break;case 8:k.drawIconTypeIsEight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 9:k.drawIconTypeIsNine(a,b.iconSetType,b.iconIndex,c,d,e);break;case 18:k.drawSector(a,b.iconSetType,b.iconIndex,c,d,e);break;case 17:case 13:k.drawSignal(a,b.iconSetType,b.iconIndex,c,d,e);break;case 19:k.drawMagicCube(a,b.iconSetType,b.iconIndex,c,d,e)}}function sb(a,b,c){var d=[],e=a.row,f=a.rowCount,g=a.col,h=a.col+a.colCount-1;return g<b?b<=h&&h<=c?(d[0]=S(e,g,f,b-g),d[1]=S(e,b,f,h-b+1)):h>c&&(d[0]=S(e,g,f,b-g),d[1]=S(e,b,f,c-b+1),d[2]=S(e,c+1,f,h-c)):g<=c&&(b<=h&&h<=c?d[1]=a:h>c&&(d[1]=S(e,g,f,c-g+1),d[2]=S(e,c+1,f,h-c))),d}function tb(a,b,c){var d=[],e=a.col,f=a.colCount,g=a.row,h=a.row+a.rowCount-1;return g<b?b<=h&&h<=c?(d[0]=S(g,e,b-g,f),d[1]=S(b,e,h-b+1,f)):h>c&&(d[0]=S(g,e,b-g,f),d[1]=S(b,e,c-b+1,f),d[2]=S(c+1,e,h-c,f)):g<=c&&(b<=h&&h<=c?d[1]=a:h>c&&(d[1]=S(g,e,c-g+1,f),d[2]=S(c+1,e,h-c,f))),d}Ua=function(){function a(a,b,c){var d=this;d.xyb=!0,d.ruleType(a),d.style(b),d.ranges(c)}return a.prototype.stopIfTrue=function(a){},a.prototype.evaluate=function(a,c,d,e){var f,g,h,i,j=this;return j.contains(c,d)?(j.initCondition(),f={baseRow:0,baseCol:0},j.getBaseCoordinate(f),j.condition().adjustOffset(c-f.baseRow,d-f.baseCol),g=n,h=x.vf,i=j.condition().evaluate(a,c,d,e),i&&!h(i)&&(g=j.getExpected()||b.Cxb),j.condition().adjustOffset(0,0),g):n},a.prototype.contains=function(a,b){var c,d,e,f=this.ranges();if(f)for(c=Y(f),d=void 0,e=0;e<c;e++)if(d=f[e],d.contains(a,b))return!0;return!1},a.prototype.createCondition=function(){return this.xyb=!1,null},a.prototype.initCondition=function(a){var b=this.condition();b||(b=this.createCondition(),b&&(b.ranges(this.ranges()),this.condition(b)),a&&this.context(a),this.context()&&b&&b.context(this.context()))},a.prototype.yyb=function(){var a,b=this;b.xyb&&(a=b.condition(),a||(b.initCondition(),a=b.condition()),a&&!a.Lf&&a.initExpression())},a.prototype.context=function(a){return 1===arguments.length&&(this.xc=a,this.condition()&&this.condition().context(a)),this.xc},a.prototype.getExpected=function(){return this.style()},a.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.stopIfTrue(!1),a.priority(1)},a.prototype.intersects=function(a,b,c,d){var e,f,g,h=this.ranges();if(h)for(e=Y(h),f=void 0,g=0;g<e;g++)if(f=h[g],f.intersect(a,b,c,d))return!0;return!1},a.prototype.isScaleRule=function(){return!1},a.prototype.isStateRule=function(){return!1},a.prototype.getBaseCoordinate=function(a){var b,c,d,e,f;if(a.baseRow=Number.MAX_VALUE,a.baseCol=Number.MAX_VALUE,b=this,b.ranges()&&Y(b.ranges())>0)for(c=0;c<Y(b.ranges());c++)d=b.ranges()[c],e=d.row,f=d.col,e=e===-1?0:e,f=f===-1?0:f,a.baseRow=s(e,a.baseRow),a.baseCol=s(f,a.baseCol);else a.baseRow=0,a.baseCol=0},a.prototype.XXc=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=!1;if(o.yyb(),d=o.ranges())for(e=Y(d),f=0;f<e;f++)g=d[f],h=g.row,i=nb(g),j=g.col,k=ob(g),l=h===a.row&&i===a.rowCount&&a.col<=j&&k<=a.colCount,m=h===b.row&&i===b.rowCount&&b.col<=j&&k<=b.colCount,n=l||m,n&&(d[f]=S(h,j,i+c,k),p=!0);return p},a.prototype._V=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=c?b:0,B=c?0:b;if(z.yyb(),f=z.ranges()){for(g=[],h=Y(f),i=0;i<h;i++)if(j=f[i],k=c?j.row:j.col,l=c?nb(j):ob(j),k!==-1){if(d&&d.length>0){for(m=!1,n=0,o=d.length;n<o;n++)if(p=d[n],p&&(q=!c&&p.col===a&&p.col===j.col&&p.colCount-b===j.colCount,r=!c&&p.col===a&&p.row===j.row&&p.rowCount===j.rowCount&&j.col>=p.col&&j.col+j.colCount<=p.col+p.colCount,s=c&&p.row===a&&p.row===j.row&&p.rowCount-b===j.rowCount,q||r||s)){f[i]=S(j.row,j.col,nb(j)+A,ob(j)+B),m=!0;break}if(m)break}if(t=j,u=e&&d&&d[0]){if(v=c?sb(j,u.col,u.col+u.colCount-1):tb(j,u.row,u.row+u.rowCount-1),v[0]&&g.push(v[0]),v[2]&&g.push(v[2]),!v[1])continue;t=v[1]}k>=a?f[i]=S(t.row+A,t.col+B,nb(t),ob(t)):a<=k+l&&(f[i]=S(t.row,t.col,nb(t)+A,ob(t)+B))}for(w=0,x=g;w<x.length;w++)y=x[w],f.push(y)}},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c,d){this._V(a,b,!1,c,d)},a.prototype.aW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y=this,z=c?a:0,A=c?0:a,B=c?b:0,C=c?0:b;if(y.yyb(),f=y.ranges()){for(g=[],h=[],i=Y(f),j=0;j<i;j++)if(k=f[j],l=c?k.row:k.col,m=c?nb(k):ob(k),l!==-1){if(n=k,o=e&&d&&d[0]){if(p=c?sb(k,o.col,o.col+o.colCount-1):tb(k,o.row,o.row+o.rowCount-1),p[0]&&g.push(p[0]),p[2]&&g.push(p[2]),!p[1])continue;n=p[1]}l>a?l+m<=a+b?h.push(n):f[j]=S(n.row-B,n.col-C,nb(n),ob(n)):a<l+m&&(q=S(n.row,n.col,nb(n)-s(n.row+nb(n)-z,B),ob(n)-s(n.col+ob(n)-A,C)),0===ob(q)||0===nb(q)?h.push(n):f[j]=q)}for(r=0,t=g;r<t.length;r++)u=t[r],f.push(u);for(v=Y(h),w=0;w<v;w++)x=h[w],W(f,x)}},a.prototype.GR=function(a,b,c,d){this.aW(a,b,!0,c,d)},a.prototype.HR=function(a,b,c,d){this.aW(a,b,!1,c,d)},a.prototype.toJSON=function(a){return ga.call(this,a)},a.prototype.fromJSON=function(a,b,c){a&&(ha.call(this,b,n,a,c),this.initCondition(b))},a.prototype.S$a=function(){var a=this.condition();a&&L(a)},a.prototype.iW=function(){var a,b,c,d=this.cW,e=this.ranges();if(!d)return this.cW=zb(e),!1;if(a=Y(d),b=Y(e),a!==b)return!0;for(c=0;c<b;c++)if(!d[c].equals(e[c]))return!0;return!1},a}(),b.ConditionRuleBase=Ua,Va=Ua.prototype,Va.ruleType=fa("ruleType",n),Va.ranges=fa("ranges",n,function(a){var b,c=this.condition();c&&c.ranges()&&(b=c.xc,b&&b.ITa.YUa(),c.ranges(a),b&&b.ITa.YUa(!0))}),Va.condition=fa("condition",n),Va.style=fa("style",n),Va.priority=fa("priority",1),Va.stopIfTrue=fa("stopIfTrue",!1);function ub(a,b){return a===Fa.cellValueRule&&(b===na.between||b===na.notBetween)}Wa=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Xa=function(a){lb(c,a);function c(b,c,d,e,f,g,h,i,j,k){var m=a.call(this,b,d)||this,o=m;return o.ranges(c),o.operator(e),o.value1("string"==typeof f?l.trim(f):f),o.value2("string"==typeof g?l.trim(g):g),o.text(h),o.formula(i),o.type(j),o.rank(k),o.cached=!1,o.cW=n,m}return c.prototype.value1=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,0),d&&d.length>0)?"="+C(l.trim(""+d),"="):this._Qa):void(this._Qa=a)},c.prototype.value2=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,1),d&&d.length>0)?"="+C(l.trim(""+d),"="):this.aRa):void(this.aRa=a)},c.prototype.formula=function(a,b){var c=this,d=c.condition();return"string"!=typeof a?d&&d.formula(a,b)||c.Yw:(c.Yw=a,void(d&&d.formula(a)))},c.prototype.cellValueRuleCreateCondition=function(){var a,c,d,e,f,g,h,i,j=this,k=j.value1(),l=j.value2(),m=j.ranges(),p=j.bW(k)?C(k,"="):n,q=j.bW(l)?C(l,"="):n,r=j.operator();return r===na.between?(a=b.$V(Ea.cellValueCondition,3,k,p,o,o,m),a.treatNullValueAsZero(!0),c=b.$V(Ea.cellValueCondition,5,l,q,o,o,m),c.treatNullValueAsZero(!0),f=b.$V(Ea.relationCondition,1,n,n,n,n,m,a,c),d=b.$V(Ea.cellValueCondition,5,k,p,o,o,m),d.treatNullValueAsZero(!0),e=b.$V(Ea.cellValueCondition,3,l,q,o,o,m),e.treatNullValueAsZero(!0),g=b.$V(Ea.relationCondition,1,n,n,n,n,m,d,e),b.$V(Ea.relationCondition,0,n,n,n,n,m,f,g)):r===na.notBetween?(a=b.$V(Ea.cellValueCondition,4,k,p,o,o,m),a.treatNullValueAsZero(!0),c=b.$V(Ea.cellValueCondition,2,l,q,o,o,m),a.treatNullValueAsZero(!0),f=b.$V(Ea.relationCondition,0,n,n,n,n,m,a,c),d=b.$V(Ea.cellValueCondition,2,k,p,o,o,m),d.treatNullValueAsZero(!0),e=b.$V(Ea.cellValueCondition,4,l,q,o,o,m),e.treatNullValueAsZero(!0),g=b.$V(Ea.relationCondition,0,n,n,n,n,m,d,e),b.$V(Ea.relationCondition,1,n,n,n,n,m,f,g)):(h=r,i=b.$V(11,h,k,p,o,o,m),i.treatNullValueAsZero(!0),i)},c.prototype.bW=function(a){return!G(a)&&"="===a[0]},c.prototype.specificTextRuleCreateCondition=function(){var a,c,d,e,f=this.operator();switch(f){case 2:a=2;break;case 3:a=4;break;case 0:a=6;break;case 1:a=7;break;default:a=0}return c=this.text(),d=n,c&&"="===c[0]&&(d=c),e=b.$V(2,a,c,d,o,o,this.ranges()),e.ignoreCase(!0),e.useWildCards(2!==f&&3!==f),e},c.prototype.formulaRuleCreateCondition=function(){var a=this,c=a.ranges();return b.$V(4,n,n,a.Yw,4,n,c)},c.prototype.dateOccurringRuleCreateCondition=function(){return b.$V(6,n,this.type(),n,n,o,this.ranges())},c.prototype.top10RuleCreateCondition=function(){return b.$V(8,n,this.rank(),n,n,this.type(),this.ranges())},c.prototype.uniqueRuleCreateCondition=function(){return b.$V(9,n,!1,n,n,n,this.ranges())},c.prototype.duplicateRuleCreateCondition=function(){return b.$V(9,n,!0,n,n,n,this.ranges())},c.prototype.averageRuleCreateCondition=function(){return b.$V(10,n,n,n,n,this.type(),this.ranges())},c.prototype.createCondition=function(){return this[Fa[this.ruleType()]+"CreateCondition"]()},c.prototype.reset=function(){var a=this;switch(a.ranges(n),a.condition(n),a.style(n),a.stopIfTrue(!1),a.priority(1),a.operator(6),a.value1(n),a.value2(n),a.text(""),a.formula(n),a.type(0),a.rank(10),a.ruleType()){case 1:a.operator(6);break;case 2:a.operator(0);break;case 4:a.style(n);break;case 5:a.type(0),a.rank(10);break;case 8:a.type(0)}},c.prototype.evaluate=function(b,c,d,e){return this.jW(b),a.prototype.evaluate.call(this,b,c,d,e)},c.prototype.jW=function(a){var b,c=this;c.initCondition(),b=c.condition(),9===b.conType()&&(c.iW()&&(c.Nm(),c.cW=zb(c.ranges())),c.cached===!1&&(b.duplicatedArrayCached=b.getDuplicated(a,c.ranges()),c.cached=!0))},c.prototype.Nm=function(){this.cached=!1},c.prototype.rI=function(b,c,d,e){a.prototype.rI.call(this,b,c,d,e),this.Nm()},c.prototype.tI=function(b,c,d,e){a.prototype.tI.call(this,b,c,d,e),this.Nm()},c.prototype.GR=function(b,c,d,e){a.prototype.GR.call(this,b,c,d,e),this.Nm()},c.prototype.HR=function(b,c,d,e){a.prototype.HR.call(this,b,c,d,e),this.Nm()},c.prototype.toJSON=function(a){var b,c,d,e,f,g=this;return G(g.condition())&&this.initCondition(),b=ga.call(g,a,Wa),c=g.value1(),ub(b.ruleType,b.operator)&&(d=g.value2()),e=a&&a.parent&&1===a.parent.options.referenceStyle,G(c)||(g.bW(c)&&e&&(c=vb(a,g,c,e)),b.value1=c),G(d)||(g.bW(d)&&e&&(d=vb(a,g,d,e)),b.value2=d),f=g.ruleType(),f===Fa.conditionRuleBase&&(b.condition=g.condition().toJSON()),b},c.prototype.fromJSON=function(a,b,c){var d=Wa;G(a.condition)||(d=Wa.concat(["condition"])),ha.call(this,b,d,a,c),G(a.value1)||this.value1(a.value1),G(a.value2)||this.value2(a.value2),this.initCondition(b)},c}(Ua),b.NormalConditionRule=Xa;function vb(a,b,c,d){var e=b.ranges(),f=M(e),g=j.formulaToExpression(a,c,f.r,f.c,d);return j.expressionToFormula(a,g,f.r,f.c,!d)}Ya={operator:fa("operator",n),text:fa("text",n),type:fa("type",n),rank:fa("rank",n),priority:fa("priority",1)},l.extend(Xa.prototype,Ya),Za=function(){function a(a,b){this.type=a,this.value=b}return a}(),b.ScaleValue=Za,$a=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],_a=function(a){lb(c,a);function c(b,c,d,e,f,g,h,i,j,k,l){var m,o,p,q,r,s,t,u,v,w=a.call(this,b,n,l)||this,x=w;return x.xyb=!1,x.lowestValueCached=n,x.highestValueCached=n,x.zyb={},x.cached=!1,x.cW=n,m=c,o=d,p=e,q=f,r=g,s=h,t=i,u=j,v=k,arguments.length<=1&&(m=1,o=n,p=R(255,248,105,107),q=4,r=50,s=R(255,255,235,132),t=2,u=n,v=R(255,99,190,123)),x.minColor(p),x.minValue(o),x.minType(m),x.midColor(s),x.midValue(r),x.midType(q),x.maxColor(v),x.maxValue(u),x.maxType(t),w}return c.prototype.stopIfTrue=function(a){return!1},c.prototype.isScaleRule=function(){return!0},c.prototype.createCondition=function(){return n},c.prototype.fW=function(a){var c=b.$V(8,n,n,n,n,1).getTopValues(a,1,this.ranges());return Y(c)>0?c[0]:n},c.prototype.gW=function(a){var c=b.$V(8,n,n,n,n,0).getTopValues(a,1,this.ranges());return Y(c)>0?c[0]:n},c.prototype.jW=function(a){var b=this;b.iW()&&(b.Nm(),b.cW=zb(b.ranges())),b.cached===!1&&(b.lowestValueCached=b.fW(a),b.highestValueCached=b.gW(a),b.cached=!0)},c.prototype.Nm=function(){this.lowestValueCached=n,this.highestValueCached=n,this.zyb={},this.cached=!1},c.prototype.kW=function(a,b,c,d){var e,f;return d&&(e=a.Cf())?(f=e.parse(a.yj(),d,b,c),e.Hg(a.yj(),f,h.pf(b,c),!1)):n},c.prototype.bW=function(a){return a&&"="===a[0]},c.prototype.lW=function(a){return G(a)||""===a?n:"="===a[0]?a.substr(1):a},c.prototype.mW=function(a,b,c,d){if(this.bW(d))return this.kW(a,b,c,this.lW(""+d));var e={};return A(d,e)?e.value:NaN},c.prototype.dW=function(a){return this.jW(a),this.highestValueCached},c.prototype.eW=function(a){return this.jW(a),this.lowestValueCached},c.prototype.nW=function(a,b,c,d){var e,f,g=this.mW(a,b,c,d);return!isNaN(g)&&0<=g&&g<=100&&(e=this.eW(a),f=this.dW(a),typeof e!==p&&e!==n&&typeof f!==p&&f!==n)?e+(f-e)*g/100:n},c.prototype.oW=function(a,b,c,d){var e,f,g,i,j,k,l,m,o,p,q,r,s=this.zyb;if(void 0!==s[d])return s[d];if(e=this.mW(a,b,c,d),!isNaN(e)&&0<=e&&e<=100){for(f=0,g=this.ranges(),i=Y(g),j=0;j<i;j++)k=this.YV("PERCENTILE",[a.Tq(g[j]),e/100]),l=a.Cf(),m=a.yj(),o=l.unparse(m,k,b,c),p=l.parse(m,o,b,c),q=l.Hg(m,p,h.pf(b,c),!1),r={},f+=A(q,r)?r.value:0;return s[d]=f/i,s[d]}return s[d]=n,s[d]},c.prototype.pW=function(a,b,c,d,e){var f,g,h=this;switch(d){case ya.formula:return h.bW(e)||(e="="+e),h.mW(a,b,c,e);case ya.highestValue:return h.dW(a);case ya.lowestValue:return h.eW(a);case ya.number:return h.mW(a,b,c,e);case ya.percent:return h.nW(a,b,c,e);case ya.percentile:return h.oW(a,b,c,e);case ya.automax:return f=h.dW(a),f<0?0:f;case ya.automin:return g=h.eW(a),g>0?0:g;default:return n}},c.prototype.qW=function(a,b,c){return a===b&&a===c?1:a<=b?0:a>=c?1:(a-b)/(c-b)},c.prototype.rW=function(a,b,c){var d,e,f,g,h,i;return 0<=a&&a<=1?(d=Q.ec(b),e=Q.ec(c),f=d.a*(1-a)+e.a*a,g=d.r*(1-a)+e.r*a,h=d.g*(1-a)+e.g*a,i=d.b*(1-a)+e.b*a,R(parseFloat(f/255+""),parseInt(g+"",10),parseInt(h+"",10),parseInt(i+"",10))):n},c.prototype.YV=function(a,b){var c,d,e,g;if(!N)return n;if(c=Z.findGlobalFunction(a)){for(d=[],e=Y(b),g=0;g<e;g++)d[g]=ea(b[g]);return f.Jh(c,d)}return n},c.prototype.rI=function(b,c,d,e){a.prototype.rI.call(this,b,c,d,e),this.Nm()},c.prototype.tI=function(b,c,d,e){a.prototype.tI.call(this,b,c,d,e),this.Nm()},c.prototype.GR=function(b,c,d,e){a.prototype.GR.call(this,b,c,d,e),this.Nm()},c.prototype.HR=function(b,c,d,e){a.prototype.HR.call(this,b,c,d,e),this.Nm()},c.prototype.scaleEvaluate=function(a,b,c,d){var e,f,g,h,i=this;if(i.jW(a),i.contains(b,c)){if(G(d))return n;try{if(e=z(d),f=i.pW(a,b,c,i.minType(),i.minValue()),g=i.pW(a,b,c,i.midType(),i.midValue()),h=i.pW(a,b,c,i.maxType(),i.maxValue()),f>h)return n;if(isNaN(g)){if(!isNaN(f)&&!isNaN(h))return i.qW(e,f,h)}else if(!isNaN(f)&&!isNaN(h))return e<f?0:e>=h?2:f<=e&&e<=g?i.qW(e,f,g):1+i.qW(e,f,h)}catch(a){return n}}return n},c.prototype.twoScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j;if(!G(d)){if(e={},f=y(d)&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=this,h=g.pW(a,b,c,g.minType(),g.minValue()),i=g.pW(a,b,c,g.maxType(),g.maxValue()),!G(h)&&!G(i))return j=g.qW(f,h,i),g.rW(j,g.minColor(),g.maxColor())}return n},c.prototype.threeScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k=this;if(k.lh=a,!G(d)){if(e={},f=y(d)&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=k.pW(a,b,c,k.minType(),k.minValue()),h=k.pW(a,b,c,k.midType(),k.midValue()),i=k.pW(a,b,c,k.maxType(),k.maxValue()),!G(g)&&!G(i)&&!G(h))return j=void 0,g>i?n:f<=g||g===i?f>=i?k.maxColor():k.minColor():f>=i?k.maxColor():f<=h?(j=k.qW(f,g,h),k.rW(j,k.minColor(),k.midColor())):(j=k.qW(f,h,i),k.rW(j,k.midColor(),k.maxColor()))}return n},c.prototype.evaluate=function(a,b,c,d){return this[Fa[this.ruleType()]+"Evaluate"](a,b,c,d)},c.prototype.ad=function(){var a=this;a.minValue(n),a.minType(1),a.midValue(50),a.midType(4),a.maxValue(n),a.maxType(2),10===a.ruleType()&&(a.minColor(R(0,255,255,255)),a.maxColor(R(255,99,190,123))),11===a.ruleType()&&(a.midValue(50),a.midType(4),a.minColor(R(255,248,105,107)),a.midColor(R(255,255,235,132)),a.maxColor(R(255,99,190,123)))},c.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.ad(),a.lh=n,a.stopIfTrue(!1),a.priority(1)},c.prototype.toJSON=function(a){return ga.call(this,a,$a)},c.prototype.fromJSON=function(a,b,c){ha.call(this,b,$a,a,c),this.initCondition(b)},c}(Ua),b.ScaleRule=_a,ab={minValue:fa("minValue",n),minType:fa("minType",5),minColor:fa("minColor",n),midValue:fa("midValue",50,n,function(a){var b=this;if(b.lh){if(2===b.midType())return b.dW(b.lh);if(1===b.midType())return b.eW(b.lh)}return a}),midType:fa("midType",n),midColor:fa("midColor",n),maxType:fa("maxType",7),maxValue:fa("maxValue",n),maxColor:fa("maxColor",n)},l.extend(_a.prototype,ab),bb=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],cb=function(a){lb(b,a);function b(b,c,d,e,f,g){var h=this,i=b,j=c,k=d,l=e,m=f;return 0===arguments.length&&(i=5,j=n,k=7,l=n,m=R(255,99,142,198)),h=a.call(this,12,i,j,n,n,n,n,k,l,n,g)||this,h.xyb=!1,h.ad(m),h}return b.prototype.ad=function(a){var b=this;b.gradient(!0),b.color(a),b.showBorder(!1),b.borderColor("black"),b.dataBarDirection(0),b.negativeFillColor("red"),b.useNegativeFillColor(!0),b.negativeBorderColor("black"),b.useNegativeBorderColor(!1),b.axisPosition(0),b.axisColor("black"),b.showBarOnly(!1)},b.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.ad(R(255,99,142,198)),a.stopIfTrue(!1),a.priority(1),a.minValue(n),a.minType(5),a.midValue(n),a.midType(n),a.maxValue(n),a.maxType(7),a.minColor(n),a.midColor(n),a.maxColor(n)},b.prototype.qXc=function(a,b,c,d){var e,f,g,h,i=this,j=d?i.maxType():i.minType(),k=d?i.maxValue():i.minValue();if(6!==j&&4!==j)return i.pW(a,b,c,j,k);for(f=0;f<Y(i.ranges());f++)if(i.ranges()[f].intersect(b,-1,1,-1)&&(e=i.ranges()[f]))return g=e.row,h=e.col,g=g===-1?0:g,h=h===-1?0:h,i.pW(a,g,h,j,k)},b.prototype.tW=function(a,b,c){var d=0;return a>=c&&a>b?[1,d]:a<=b&&a<c?[0,d]:c===b?[.5,d]:[(a-b)/(c-b),d]},b.prototype.uW=function(a,b,c){var d,e,f=.5,g=u(c-b);return c>0&&b>=0?c===b?[.5,f]:a>=c?[.5,f]:a<=b?[b/c*.5,f]:[.5*u(a/c),f]:c>0&&b<0?(d=c>u(b)?.5:c/g,e=c>u(b)?b/g:-.5,a>0?a>=c?[d,f]:[a/c*d,f]:a<0?a<=b?[e,f]:[a/b*e,f]:[0,f]):c<=0&&b<0?c===b?[-.5,f]:a>=c?[-c/b*.5,f]:a<=b?[-.5,f]:[-a/b*.5,f]:0===c&&0===b?[0,f]:(f=-1,[-1,f])},b.prototype.vW=function(a,b,c){var d,e,f,g=-1,h=u(b),i=u(c),j=u(c-b),k=b<0?-1:1;return c>0&&b>=0||c<=0&&b<0?(d=t(h,i),e=s(h,i),f=u(a),g=b<0?1:0,f<=e&&f<d?[0,g]:f>=d&&f>e?[k,g]:e===d?[.5*k,g]:[k*(u(a)-e)/j,g]):c>0&&b<0?(g=u(b)/j,0===a?[0,g]:a>=c?[1-g,g]:[t(a,b)/j,g]):0===c&&0===b?(g=.5,0===a?[0,g]:[.5*k,g]):[-1,g]},b.prototype.wW=function(a,b,c){var d=this;return 0===d.axisPosition()?d.vW(a,b,c):1===d.axisPosition()?d.uW(a,b,c):d.tW(a,b,c)},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o,p,q;if(!G(d)){if(e={},f=y(d,!0)&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=this,h=g.qXc(a,b,c,!1),i=g.qXc(a,b,c,!0),I(h,Date)&&(h=U.Ra(h)),I(i,Date)&&(i=U.Ra(i)),!G(h)&&!G(i))return h>i&&(j=i,i=h,h=j),k=void 0,l=g.wW(f,h,i),!l||Y(l)<2?n:(m=l[0],k=l[1],o=f<0&&g.useNegativeFillColor()?g.negativeFillColor():g.color(),p=f<0&&g.useNegativeBorderColor()?g.negativeBorderColor():g.borderColor(),q=g.axisColor(),o=_.Om(a,o),p=_.Om(a,p),q=_.Om(a,q),{fillColor:o,borderColor:p,showBorder:g.showBorder(),axisColor:q,isGradient:g.gradient(),direction:g.dataBarDirection(),axisLocation:k,scale:m,showBarOnly:g.showBarOnly()})}return n},b.prototype.toJSON=function(a){return ga.call(this,a,bb)},b.prototype.fromJSON=function(a,b,c){ha.call(this,b,bb,a,c),this.initCondition(b)},b.paintDataBar=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,w,x=new e.Rect(c+2,d+2,f-4,g-4),y=x.x,z=x.y,A=v(u(x.width*b.scale)),B=x.height;if(0===b.axisLocation)b.scale<=0&&(A=0);else if(1===b.axisLocation)b.scale<0?y=y+x.width-A:A=0;else{for(h=v(x.width*b.axisLocation+y)+.5,i=x.y,j=1,k=g-2,a.lineWidth=j,a.strokeStyle=b.axisColor,a.beginPath(),l=0;l<=k;l+=2)1===b.direction?(a.moveTo(2*c+f-h,i+l),a.lineTo(2*c+f-h,i+l+1)):(a.moveTo(h,i+l),a.lineTo(h,i+l+1));a.stroke(),b.scale>0?y=h+j:b.scale<0?y=h-A:A=0}b.showBorder&&(y=v(y)+.5,A-=1,z+=.5,B-=1),m=y,n=y+A,1===b.direction&&(m=2*c+f-y-A,n=2*c+f-y),A>=0&&B>=0&&(o=b.fillColor,b.isGradient&&(p=.9,o=a.createLinearGradient(m,z,n,z),q=Q.ec(b.fillColor),r=R(q.a,v(255*p+q.r*(1-p)),v(255*p+q.g*(1-p)),v(255*p+q.b*(1-p))),s=b.scale<0?1-p:p,t=b.fillColor,w=b.scale<0?1:0,1===b.direction?(o.addColorStop(s,t),o.addColorStop(w,r)):(o.addColorStop(s,r),o.addColorStop(w,t))),a.fillStyle=o,a.fillRect(m,z,A,B),b.showBorder&&A>0&&B>0&&(a.strokeStyle=b.borderColor,a.strokeRect(m,z,A,B)))},b}(_a),b.DataBarRule=cb,db={gradient:fa("gradient",!0),color:fa("color",n),showBorder:fa("showBorder",!1),borderColor:fa("borderColor","black"),dataBarDirection:fa("dataBarDirection",0),negativeFillColor:fa("negativeFillColor","red"),useNegativeFillColor:fa("useNegativeFillColor",!0),negativeBorderColor:fa("negativeBorderColor","black"),useNegativeBorderColor:fa("useNegativeBorderColor",!1),axisPosition:fa("axisPosition",0),axisColor:fa("axisColor","black"),showBarOnly:fa("showBarOnly",!1)},l.extend(cb.prototype,db),eb=function(){function a(a,b,c){this.isGreaterThanOrEqualTo=a,this.iconValueType=b,this.iconValue=c}return a}(),b.IconCriterion=eb,fb=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],gb=function(a){lb(b,a);function b(b,c){var d=this,e=b;return 0===arguments.length&&(e=0),d=a.call(this,13,n,n,n)||this,d.xyb=!1,d.ranges(c),d.ad(e),d}return b.prototype.xW=function(a){var b=this;b.iconSetType(a,!1),b.iconSetType()>=Ba.threeArrowsColored&&b.iconSetType()<=Ba.threeSymbolsUncircled?(b.NV=[],b.NV[0]=new eb((!0),Ca.percent,33),b.NV[1]=new eb((!0),Ca.percent,67),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2}):b.iconSetType()>=Ba.fourArrowsColored&&b.iconSetType()<=Ba.fourTrafficLights?(b.NV=[],b.NV[0]=new eb((!0),Ca.percent,25),b.NV[1]=new eb((!0),Ca.percent,50),b.NV[2]=new eb((!0),Ca.percent,75),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3}):b.iconSetType()>=Ba.fiveArrowsColored&&b.iconSetType()<=Ba.fiveBoxes?(b.NV=[],b.NV[0]=new eb((!0),Ca.percent,20),b.NV[1]=new eb((!0),Ca.percent,40),b.NV[2]=new eb((!0),Ca.percent,60),b.NV[3]=new eb((!0),Ca.percent,80),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3},b.CZa[4]={iconSetType:a,iconIndex:4}):b.iconSetType()>Ba.fiveBoxes&&(b.NV=[],b.CZa=[])},b.prototype.ad=function(a){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(a)},b.prototype.yW=function(a){var b=Y(this.NV)+1;return this.reverseIconOrder()&&b>2?b-1-a:a},b.prototype.pW=function(a,b,c,d){var e=this,f=e.NV[d];if(f)switch(f.iconValueType){case Ca.formula:return e.mW(a,b,c,f.iconValue);case Ca.number:return e.mW(a,b,c,f.iconValue);case Ca.percent:return e.nW(a,b,c,f.iconValue);case Ca.percentile:return e.oW(a,b,c,f.iconValue);default:return n}},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o,p,q,r=this,s=d;if(G(s))return n;if(e={},f=y(d,!0)&&"boolean"!=typeof s&&A(d,e)?e.value:NaN,isNaN(f))return n;if(g=0,h=r.iconSetType(),i=r.NV,h>=Ba.fiveArrowsColored?g=5:h>=Ba.fourArrowsColored?g=4:h>=Ba.threeArrowsColored&&(g=3),!i)return 0;for(k=0,l=g-1;l>0;l--)if(l<Y(i)+1&&(j=i[l-1],!G(j&&j.iconValue)&&(m=r.pW(a,b,c,l-1),!G(m)&&(o=j.isGreaterThanOrEqualTo?f>=m:f>m,f<Number.MAX_VALUE&&o)))){k=l;break}return p=r.yW(k),q=r.CZa,q?{iconSetType:q[p]?q[p].iconSetType:Ba.noIcons,iconIndex:q[p]?q[p].iconIndex:0,showIconOnly:r.showIconOnly()}:{iconSetType:Ba.noIcons,iconIndex:0,showIconOnly:r.showIconOnly()}},b.prototype.reset=function(){var a=this;a.ranges(n),a.condition(n),a.style(n),a.showIconOnly(!1),a.reverseIconOrder(!1),a.iconSetType(0,n),a.NV=n,a.stopIfTrue(!1),a.priority(1),a.minColor(n),a.minValue(n),a.minType(5),a.midColor(n),a.midValue(n),a.midType(n),a.maxColor(n),a.maxValue(n),a.maxType(7),a.CZa=n},b.prototype.icons=function(a){return 1===arguments.length&&(this.CZa=a),this.CZa},b.prototype.iconCriteria=function(){return this.NV},b.prototype.toJSON=function(a){return ga.call(this,a,fb)},b.prototype.fromJSON=function(a,b,c){ha.call(this,b,fb,a,c),this.initCondition(b)},b.getIcon=function(a,b){return n},b.Pdc=function(a,b,c,d,e,f,g){if(g.ko(b)){var h=g.lo(b);a.drawImage(h,c,d,e,f)}else g.fo(b)},b.paintIconSet=function(a,c,d,e,f,g,h,j,k,m){var n,o,p=i.To.No(h.font,1).fontSize,q=p,r=2,s=2,t=d+r;if(c.showIconOnly&&(1===h.hAlign?t=d+f/2-q/2:2===h.hAlign&&(t=d+f-r-q-2)),n=1===h.vAlign?e+g/2-q/2:2===h.vAlign?e+g-s-j/2-q/2:e+s+j/2-q/2,c.iconSetType!==Ba.noIcons)if(o=b.getIcon(c.iconSetType,c.iconIndex),o&&"string"===l.getType(o)&&m)try{b.Pdc(a,o,t,n,q,q,m)}catch(a){}else rb(a,c,t,n,q,d,e,f,g)},b}(_a),b.IconSetRule=gb,hb={iconSetType:fa("iconSetType",Ba.threeArrowsColored,function(a){this.xW(a)}),reverseIconOrder:fa("reverseIconOrder",!1),showIconOnly:fa("showIconOnly",!1)},l.extend(gb.prototype,hb);function wb(a){return"string"==typeof a&&(a=l.trim(a),"="!==a[0]&&(a='="'+m.Gb(a,'"','""')+'"')),a}ib=["ruleType","state","style","priority","stopIfTrue","ranges"],jb=function(a){lb(c,a);function c(b,c,d,e){var f=a.call(this,b,d,e)||this,g=f;return g.state(c),f}return c.prototype.isRow=function(){var a=this,b=a.ruleType();return G(a.hj)&&(b===Fa.rowStateRule?a.hj=!0:b===Fa.columnStateRule&&(a.hj=!1)),this.hj},c.prototype.isStateRule=function(){return!0},c.prototype.jMc=function(){var a=this,c=a.state(),d=a.ranges();return b.$V(Ea.stateCondition,Da.contains,c,o,o,o,d)},c.prototype.rowStateRuleCreateCondition=function(){return this.jMc()},c.prototype.columnStateRuleCreateCondition=function(){return this.jMc()},c.prototype.createCondition=function(){return this[Fa[this.ruleType()]+"CreateCondition"]()},c.prototype.kMc=function(a){var b=this;return c.StatesPriority.indexOf(b.state())<c.StatesPriority.indexOf(a.state())},c.prototype.fromJSON=function(a,b,c){var d=ib;G(a.condition)||(d=ib.concat(["condition"])),ha.call(this,b,d,a,c),this.initCondition(b)},c.prototype.toJSON=function(a){var b,c,d=this;return G(d.condition())&&this.initCondition(),b=ga.call(d,a,ib),c=d.ruleType(),c===Fa.conditionRuleBase&&(b.condition=d.condition().toJSON()),b},c.StatesPriority=[4,i.RowColumnStates.invalid,i.RowColumnStates.dirty,i.RowColumnStates.inserted,256,i.RowColumnStates.selected,i.RowColumnStates.active,i.RowColumnStates.hover,i.RowColumnStates.edit],c}(Ua),b.StateRule=jb,jb.prototype.state=fa("state",n),kb=function(){function a(a){this.AW=[],this.BW=n,this.DW={},this.Kfc=!0,this.WS=a}return a.prototype.no=function(){this.WS=n},a.prototype.getRule=function(a){return this.AW[a]},a.prototype.count=function(){return Y(this.AW)},a.prototype.w4=function(){return this.AW},a.prototype.UV=function(a){var b,c,d=[],e=this.WS,f=Y(a);for(b=0;b<f;b++)c=e.Tq(a[b]),d.push(c);return d},a.prototype.EW=function(a){var b,c,d,e,f=[],g=this.WS;for(b=0,c=Y(a);b<c;b++)d=a[b],e=new T(d.row,d.col,nb(d),ob(d)),0===d.row&&nb(d)===g.getRowCount()&&(e.row=-1),0===d.col&&ob(d)===g.getColumnCount()&&(e.col=-1),f.push(e);return f},a.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var a=0;a<Y(this.AW);a++)this.FW(this.AW[a])},a.prototype.OV=function(){this.Kfc&&(this.DW={})},a.prototype.FW=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(this.Kfc)for(b=this,c=b.DW,
h=b.UV(a.ranges()),i=b.WS,j=i.getRowCount(),k=i.getColumnCount(),l=0;l<Y(h);l++)for(m=h[l],n=m.row,o=m.col,p=nb(m),q=ob(m),n+p-1>=j&&(p=j-n),o+q-1>=k&&(q=k-o),r=0;r<p;r++)for(f=r+n,d=c[f],d||(c[f]=d=[]),s=0;s<q;s++)g=s+o,e=d[g],e||(d[g]=e=[]),e.push(a)},a.prototype.GW=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(this.Kfc)for(b=this.DW,g=this.UV(a.ranges()),h=0;h<Y(g);h++)for(i=g[h],j=0;j<nb(i);j++)if(e=j+i.row,c=b[e])for(k=0;k<ob(i);k++)if(f=k+i.col,d=c[f]){for(l=[],m=0;m<Y(d);m++)d[m]!==a&&l.push(d[m]);0===Y(l)&&(l=o),c[f]=l}},a.prototype.HW=function(a,b,c,d){var e,f,g,h,i,j;if(this.Kfc)for(b===-1&&(b=0,d=this.WS.getColumnCount()),a===-1&&(a=0,c=this.WS.getRowCount()),g=this.DW,i=0;i<c;i++)if(e=i+a,h=g[e])for(j=0;j<d;j++)f=j+b,h[f]=o},a.prototype.Ayb=function(a,b){var c,d,e=[];for(c=0;c<Y(this.AW);c++)d=this.AW[c],d.contains(a,b)&&e.push(d);return e},a.prototype.addSpecificTextRule=function(a,b,c,d){var e=new Xa(2,d,c,a,n,n,b);return this.addRule(e)},a.prototype.addCellValueRule=function(a,b,c,d,e){var f=new Xa(1,e,d,a,wb(b),wb(c));return this.addRule(f)},a.prototype.addDateOccurringRule=function(a,b,c){var d=new Xa(4,c,b,n,n,n,n,n,a);return this.addRule(d)},a.prototype.addFormulaRule=function(a,b,c){var d=new Xa(3,c,b,n,n,n,n,a);return this.addRule(d)},a.prototype.addTop10Rule=function(a,b,c,d){var e=new Xa(5,d,c,n,n,n,n,n,a,b);return this.addRule(e)},a.prototype.addUniqueRule=function(a,b){var c=new Xa(6,b,a);return this.addRule(c)},a.prototype.addDuplicateRule=function(a,b){var c=new Xa(7,b,a);return this.addRule(c)},a.prototype.addAverageRule=function(a,b,c){var d=new Xa(8,c,b,n,n,n,n,n,a);return this.addRule(d)},a.prototype.add3ScaleRule=function(a,b,c,d,e,f,g,h,i,j){var k;return k=0===arguments.length?new _a(11):new _a(11,a,b,c,d,e,f,g,h,i,j),this.addRule(k)},a.prototype.add2ScaleRule=function(a,b,c,d,e,f,g){var h;return h=0===arguments.length?new _a(10):new _a(10,a,b,c,n,n,n,d,e,f,g),this.addRule(h)},a.prototype.addDataBarRule=function(a,b,c,d,e,f){var g;return g=0===arguments.length?new cb:new cb(a,b,c,d,e,f),this.addRule(g)},a.prototype.addIconSetRule=function(a,b){var c=new gb(a,b);return this.addRule(c)},a.prototype.addRowStateRule=function(a,b,c){var d=this,e=new jb(Fa.rowStateRule,a,b,c);return d.addRule(e)},a.prototype.addColumnStateRule=function(a,b,c){var d=this,e=new jb(Fa.columnStateRule,a,b,c);return d.addRule(e)},a.prototype.addRule=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.WS;if(r){if(!b)throw Error(ba().Exp_RuleIsNull);for(c=b.ranges(),d=void 0,e=void 0,c&&(f=M(c),d=f.r,e=f.c,b.ranges(c.slice(0))),g=b.getExpected(),h=g&&g.formatter,h&&"string"==typeof h&&r.fJb(d||0,e||0,h),b.isStateRule()&&(i=b.state(),j=b.isRow(),r.QLc&&r.QLc.enableState(i,j)),r.ITa.YUa(),k=1,l=void 0,m=Y(q.AW),l=0;l<m;l++)n=q.AW[l],o=n._ps,p=o.priority||1,o.priority=p+1,b.isStateRule()&&n.isStateRule()&&b.kMc(n)&&(k=t(k,o.priority),o.priority-=1);return b.priority(k),q.AW.push(b),a.ao(r,"onRuleAdded",{ranges:c}),b.context(r),q.FW(b),r.ITa.YUa(!0),r.$p(),b}},a.prototype.removeRule=function(b){var c,d,e,f,g,h,i,j,k=this,l=k.WS,m=l.parent;if(l){if(b&&(c=b.getExpected(),d=c&&c.formatter,d&&"string"==typeof d&&m.QHb[d]&&m.RHb(d),l.ITa.YUa(),k.GW(b),W(k.AW,b),l.ITa.YUa(!0),a.ao(l,"onRuleRemoved",{priority:b.priority(),ranges:b.ranges()}),b.isStateRule())){for(e=b.state(),f=b.isRow(),g=!1,h=0,i=k.AW;h<i.length;h++)if(j=i[h],j.isStateRule()&&j.state()===e){g=!0;break}g||l.QLc.disableState(e,f)}l.$p()}},a.prototype.IW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r,u;return a.intersect(b,c,d,e)?(f=a.row,g=a.row+nb(a)-1,h=a.col,i=a.col+ob(a)-1,j=b,k=b+d-1,l=c,m=c+e-1,o=[],f!==-1&&h!==-1&&j!==-1&&l!==-1&&(l-h>0&&(p=S(f,h,nb(a),l-h),o.push(p)),i-m>0&&(q=S(f,m+1,nb(a),i-m),o.push(q)),j-f>0&&(r=S(f,t(l,h),j-f,s(m,i)-t(l,h)+1),o.push(r)),g-k>0&&(u=S(k+1,t(l,h),g-k,s(m,i)-t(l,h)+1),o.push(u))),Y(o)>0?o:n):[a]},a.prototype.removeRuleByRange=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.WS;if(s){if(f=[],r.AW)for(s.ITa.YUa(),r.HW(b,c,d,e),g=0,h=Y(r.AW);g<h;g++)if(i=r.AW[g],a.ao(s,"onRuleRemoved",{ranges:[new T(b,c,d,e)]}),i&&i.ranges()&&i.intersects(b,c,d,e))if(s.pivotTables&&i.pivotTableName)j=s.pivotTables.get(i.pivotTableName),j.nPc(i,b,c,d,e);else{for(k=[],l=r.UV(i.ranges()),m=0,n=Y(l);m<n;m++)o=r.IW(l[m],b,c,d,e),o&&(k=k.concat(o));Y(k)>0?i.ranges(r.EW(k)):f.push(i)}for(p=0,q=Y(f);p<q;p++)W(r.AW,f[p]);s.ITa.YUa(!0),s.$p()}},a.prototype.clearRule=function(){var b,c,d,e,f,g,h,i=this,j=i.WS,k=j.parent;if(j){for(b=i.AW,j.ITa.YUa(),c=0;c<b.length;c++)d=b[c],e=d.getExpected(),f=e&&e.formatter,a.ao(j,"onRuleRemoved",{ranges:d.ranges()}),f&&"string"==typeof f&&k.QHb[f]&&k.RHb(f);if(j.pivotTables)for(g=j.pivotTables.all(),c=0;c<g.length;c++)h=g[c],h.oPc();i.AW.length=0,i.QV(),j.ITa.YUa(!0),j.$p()}},a.prototype.getRules=function(a,b){var c,d,e,f,g,h,i,j,k=this,m=k.AW;if(0===arguments.length||0===Y(m))return m;if(a=a===o?-1:a,b=b===o?-1:b,c=[],k.Kfc)d=k.DW,f=void 0,a!==-1&&b!==-1?(f=d[a],f&&(e=f[b],xb(c,e))):a===-1?l.each(d,function(a,d){e=d[b],xb(c,e)}):(f=d[a],f&&l.each(f,function(a,b){xb(c,b)}));else if(g=k.WS,h=g.getRowCount(),i=g.getColumnCount(),j=void 0,a!==-1&&b!==-1)xb(c,k.Ayb(a,b));else if(a===-1)for(j=0;j<h;j++)xb(c,k.Ayb(j,b));else for(j=0;j<i;j++)xb(c,k.Ayb(a,j));return c},a.prototype.containsRule=function(a,b,c){return!(!a||!V.Bb(this.AW,a))&&a.contains(b,c)},a.prototype.lMc=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.WS;if(n){if(!a)throw Error(ba().Exp_RuleIsNull);for(c=a.ranges(),d=void 0,e=void 0,c&&(f=M(c),d=f.r,e=f.c),g=a.getExpected(),h=g&&g.formatter,h&&"string"==typeof h&&n.fJb(d||0,e||0,h),n.ITa.YUa(),i=0,j=Y(m.AW);i<j;i++)k=m.AW[i]._ps,l=k.priority||1,b<=l&&(k.priority=l+1);return a.priority(b),m.AW[b]=a,a.context(n),m.FW(a),n.$p(),a}},a.prototype.XXc=function(a,b,c){var d,e,f=this,g=f.WS,h=g.ITa,i=f.AW,j=Y(i),k=!1;for(h.YUa(),d=0;d<j;d++)e=i[d],e&&e.XXc(a,b,c)&&(k=!0);k&&f.QV()},a.prototype._V=function(a,b,c,d,e){var f,g,h,i=this;if(i.AW&&i.WS)for(f=Y(i.AW),g=0;g<f;g++)h=i.AW[g],h&&(c?h.rI(a,b,d,e):h.tI(a,b,d,e));i.QV()},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c,d){this._V(a,b,!1,c,d)},a.prototype.aW=function(a,b,c,d,e){var f,g,h,i=this;if(i.AW&&i.WS)for(f=Y(i.AW),g=f-1;g>=0;g--)h=i.AW[g],h&&(c?h.GR(a,b,d,e):h.HR(a,b,d,e),h.ranges().length<=0&&(i.GW(h),i.AW.splice(g,1)));i.QV()},a.prototype.GR=function(a,b,c,d){this.aW(a,b,!0,c,d)},a.prototype.HR=function(a,b,c,d){this.aW(a,b,!1,c,d)},a.prototype.Nm=function(){var a,b,c,d=this.AW;if(d!==n&&Y(d)>0)for(b=0,c=Y(d);b<c;b++)a=d[b],a.Nm&&a.Nm()},a.prototype.XA=function(a,b,c,d,e,f,g,h,i){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,N,O,P,Q,R,T,U=[],V=[],W=[],Z=[],$=[],_=this,aa=_.WS,ba=!i&&aa.KLc();for(a===-1&&(a=0,d=0,f=aa.getRowCount()),b===-1&&(b=0,e=0,g=aa.getColumnCount()),k=0;k<f;k++)for(l=0;l<g;l++)for(m=_.getRules(a+k,b+l),n=0;n<Y(m);n++)if(o=m[n],p=o.ranges(),!o.isStateRule()){for(q=[],r=0;r<Y(p);r++)s=p[r],t=aa.Tq(s),u=t.row,v=t.col,w=nb(t),x=ob(t),y=X(W,s)<=-1||X(W,s)>-1&&X(Z,o)<=-1,y&&s.contains(a+k,b+l)&&(W.push(s),Z.push(o),z=S(d+k,e+l,-1,-1),u+w>=f+a?z.rowCount=f-k:a<u?z.rowCount=w:z.rowCount=u+w-a,v+x>=g+b?z.colCount=g-l:b<v?z.colCount=x:z.colCount=v+x-b,_===c&&s.containsRange(z)||q.push(z),h&&!Ab($,z)&&$.push(z));q.length>0&&(A=U.indexOf(o),A<0?(ba&&(q=_.mMc(q)),U.push(o),V.push(q)):(ba&&(B=void 0,C=void 0,D=void 0,E=void 0,F=V[A][0].row,G=V[A][0].col,H=q[0],B=H.row-F,C=H.col-G,D=aa.MLc(F,B,!0),E=aa.MLc(G,C),H.row+=D,H.col+=E,q=_.mMc(q)),V[A]=V[A].concat(q)))}for(I=0,J=U.length;I<J;I++)K=_.iga(U[I].toJSON(),U[I].context()),L=K.ranges(),K.ranges(V[I]),N=K.Yw,N&&(O=1===aa.parent.options.referenceStyle,P=M(L),Q=j.formulaToExpression(aa,N,P.r,P.c,O),R=M(V[I]),T=j.expressionToFormula(aa,Q,R.r,R.c,O),K.formula(T)),c.addRule(K);return _.QV(),$},a.prototype.mMc=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.WS,n=[];if(a.length>0){for(b=a[0],c=b.row,d=b.col,e=b.rowCount,f=b.colCount,e+=m.MLc(c,e,!0),f+=m.MLc(d,f),g=[],h=void 0,i=0;i<f;i++)0!==i?0!==m.getColumnWidth(d+i)?h.colCount++:(g.push(h),i=m.Zq(d+i-1)-1-d,h=new T(c,d+i+1,1,0)):h=new T(c,d,1,1);for(g.push(h),j=0;j<e;j++)if(0!==j)if(0!==m.getRowHeight(c+j))for(k=0;k<g.length;k++)g[k].rowCount++;else for(n=n.concat(zb(g)),j=m._q(c+j-1)-1-c,k=0;k<g.length;k++)g[k].rowCount=0,g[k].row=c+j+1;n=n.concat(g)}return n},a.prototype.YA=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,u,v,w,x=[],y=this,z=y.WS,A=z.getRowCount(3),B=z.getColumnCount(3);for(a===-1&&(a=0,c=z.getRowCount()),b===-1&&(b=0,d=z.getColumnCount()),g=0;g<c;g++)for(h=0;h<d;h++)for(i=y.getRules(a+g,b+h),j=0;j<Y(i);j++)if(k=i[j],l=k.ranges(),!k.isStateRule()){for(m=[],n=0;n<Y(l);n++)o=l[n],p=z.Tq(o),q=p.row,r=p.col,u=nb(p),v=ob(p),Ab(e,o)||X(x,o)<=-1&&o.contains(a+g,b+h)&&(x.push(o),a>q&&m.push(S(q,r,a-q,v)),b>r&&m.push(S(t(a,q),r,s(a+c,q+u)-t(a,q),b-r)),b+d<r+v&&m.push(S(t(a,q),b+d,s(a+c,q+u)-t(a,q),r+v-(b+d))),a+c<q+u&&m.push(S(a+c,r,q+u-(a+c),v)));z&&z.ITa.YUa(),y.Byb(z,x,e,l,A,B,f),w=l.concat(m),w.length>0?(k.yyb(),k.ranges(w)):y.removeRule(k)}y.QV()},a.prototype.Byb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m;for(h=0;h<Y(b);h++){if(i=b[h],j=[i],g)for(k=0;k<Y(c);k++)l=c[k],i.intersect(l.row,l.col,l.rowCount,l.colCount)&&(j=j.concat(a.v_a(i,l,e,f)));for(m=0;m<Y(j);m++)W(d,j[m])}},a.prototype.jp=function(a,b,c,d,e,f,g,h){var i=16,j=!1,k=!1,l=h.sheet,m=h.row,n=h.col,o=l.zoom(),p=this.oRa(l,m,n,b),q=p.iconSet,r=p.dataBar;return(r||q)&&(a.save(),a.beginPath(),r&&(cb.paintDataBar(a,r,c,d,e,f),j=r.showBarOnly),q&&(i=parseInt(i*o+"",10),(e<i||f<i)&&(a.rect(c,d,e,f),a.clip(),a.beginPath()),gb.paintIconSet(a,q,c,d,e,f,g,h.lineHeight,o,h.imageLoader),k=q.showIconOnly),a.restore()),j||k},a.prototype.oRa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,o=this,p=a.ss,q=p.Um(b,c);if(q)e=q.i,f=q.d;else{if(g=o.getRules(b,c),h=Y(g),h>0){for(g.sort(function(a,b){return a.priority()-b.priority()}),i=n,j=n,k=void 0,l=void 0,m=void 0,m=0;m<h&&(!i||!j);m++)k=g[m],k&&(I(k,cb)&&(i=k),I(k,gb)&&(j=k));if(i||j)for(i=j=n,m=0;m<h&&(!i||!j)&&(k=g[m],!(k&&(!i&&I(k,cb)&&(i=k),!j&&I(k,gb)&&(j=k),k.stopIfTrue()&&(l=k.evaluate(a,b,c,d)))));m++);i&&(f=i.evaluate(a,b,c,d)),j&&(e=j.evaluate(a,b,c,d))}p.Wm(b,c,f,e)}return{dataBar:f,iconSet:e}},a.prototype.bp=function(a,b,c){var d,e,f;if(G(c)||3===c)for(d=this.getRules(a,b),e=0,f=Y(d);e<f;e++)if(d[e]instanceof gb)return!0;return!1},a.prototype.toJSON=function(a){var b,c,d=[];for(b=0;b<Y(this.AW);b++)c=this.AW[b],d.push(c?c.toJSON(a):n);return 0===Y(d)?o:{rules:d}},a.prototype.fromJSON=function(a,b,c,d){var e,f,g,h,i;if(a&&(e=a.rules)){for(this.AW=[],f=Y(e),g=0;g<f;g++)h=e[g],h.pivot&&d||(i=this.iga(h,b,c),i&&this.AW.push(i));this.Kfc=!yb(e),this.QV()}},a.prototype.iga=function(a,b,c){var d,e,f=n;return a&&(d=this.JW(),e=d[a.ruleType],e&&(f=new e,f.fromJSON(a,b,c))),f},a.prototype.JW=function(){if(!this.BW){var a={};a[0]=Xa,a[1]=Xa,a[2]=Xa,a[3]=Xa,a[4]=Xa,a[5]=Xa,a[6]=Xa,a[7]=Xa,a[8]=Xa,a[9]=_a,a[10]=_a,a[11]=_a,a[12]=cb,a[13]=gb,a[14]=jb,a[15]=jb,this.BW=a}return this.BW},a.prototype.Eq=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,p,q=this;if(q&&q.count()>0&&(e=q.getRules(b,c),f=Y(e),g=void 0,h=n,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),i=0;i<f&&(g=e[i],!(g&&(j=q.WS,g.isScaleRule()?10!==g.ruleType()&&11!==g.ruleType()||(h=g.evaluate(j,b,c,j.getValue(b,c,d)),h&&(a||(a=new O),a.backColor===o&&(a.backColor=h))):g.isStateRule()?(k=g.state(),l=g.isRow(),m=g.ranges(),p=j.QLc.getState(b,c,k,l,m),h=g.evaluate(j,b,c,p),h&&(a||(a=new O),a.Yo(h,!1,1))):(h=g.evaluate(j,b,c,j.getValue(b,c,d)),h&&(a||(a=new O),a.Yo(h,!1,1))),g.stopIfTrue()&&h)));i++);return a},a.prototype.Fq=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,p,q,r,s={v5:!1},t=this;if(t&&t.count()>0&&(e=t.getRules(a,b),f=Y(e),g=void 0,h=n,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),i=0;i<f;i++)if(g=e[i]){if(j=t.WS,g.isScaleRule()){if(k=g.ruleType(),"backColor"===c&&(10===k||11===k)&&(h=g.evaluate(j,a,b,j.getValue(a,b,d)))){s.Fi=h,s.v5=!0;break}}else if(g.isStateRule()){if(l=g.state(),m=g.isRow(),p=g.ranges(),q=j.QLc.getState(a,b,l,m,p),r=g.style(),!(r&&void 0!==r[c]||g.stopIfTrue()))continue;if(h=g.evaluate(j,a,b,q),h&&h[c]!==o){s.Fi=h[c],s.v5=!0;break}}else{if(r=g.style(),!(r&&void 0!==r[c]||g.stopIfTrue()))continue;if(h=g.evaluate(j,a,b,j.getValue(a,b,d)),h&&h[c]!==o){s.Fi=h[c],s.v5=!0;break}}if(g.stopIfTrue()&&h)break}return s},a}(),b.ConditionalFormats=kb,K(kb);function xb(a,b){if(b)for(var c=0;c<b.length;c++)a.push(b[c])}function yb(a){var b,c,d,e,f,g=Y(a);for(b=0;b<g;b++)if(c=a[b],d=c.ranges)for(e=0;e<d.length;e++)if(f=d[e],f.rowCount>1e3)return!0;return!1}function zb(a){var b,c,d=[],e=Y(a);for(c=0;c<e;c++)b=a[c],d.push(S(b.row,b.col,nb(b),ob(b)));return d}function Ab(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d&&d.equals(b))return!0;return!1}},"./dist/plugins/conditional/conditional.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/conditional/conditional.res.en.js");b.SR={en:d}},"./dist/plugins/conditional/conditional.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RuleIsNull="The argument 'rule' is null",b.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=Math.PI,e=Math.round,f=Math.cos,g=Math.sin,h="#4d82b8 #4d82b8 #4d82b8 #4d82b8",i="#326f5b",j="#76a797",k="#A4802b",l="#EAC282",m="#9E381C",n="#D86344",o="#646262",p="#808080",q="#353535",r="#303030",s="#505050",t="#727272",u=[[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d}],[{strokeStyle:k,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:r,fillColor:s,fillColor2:"#d86344",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:"#eac282",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:j,rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"white",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"white",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"white",rotate:d*-.25}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d*-.25}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:p,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:1*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}]];function v(a,b,c,d,e){a.beginPath(),a.moveTo(b,c),a.lineTo(b+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.lineTo(b,c),a.closePath(),a.fill(),a.stroke()}function w(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),i=e(.2*g),a.fillStyle=h[0],v(a,i+.5,3*i+.5,i,2*i),a.fillStyle=h[1],v(a,2*i+.5,2*i+.5,i,3*i),a.fillStyle=h[2],v(a,3*i+.5,i+.5,i,4*i),a.fillStyle=h[3],v(a,4*i+.5,.5,i,5*i)}b.drawSignal=w;function x(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),a.fillStyle=u[b][c].strokeStyle,i=e(g/2),a.fillStyle=h[0],v(a,.5,.5,i,i),a.fillStyle=h[1],v(a,i+.5,.5,i,i),a.fillStyle=h[2],v(a,.5,i+.5,i,i),a.fillStyle=h[3],v(a,i+.5,i+.5,i,i)}b.drawMagicCube=x;function y(a,b,c,e,f,g){a.translate(e+g/2,f+g/2),a.strokeStyle=u[b][c].strokeStyle,4===c?(a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.stroke()):0===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.stroke(),a.closePath()):1===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,0),a.lineTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):2===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,.5*d),a.moveTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):3===c&&(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,d),a.lineTo(0,0),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke(),a.closePath())}b.drawSector=y;function z(a,b,c){a.moveTo(f(.1*d)*b,-g(.1*d)*b),a.lineTo(f(.3*d)*c,-g(.3*d)*c),a.lineTo(0*b,-g(.5*d)*b),a.lineTo(f(.7*d)*c,-g(.7*d)*c),a.lineTo(f(.9*d)*b,-g(.9*d)*b),a.lineTo(f(1.1*d)*c,-g(1.1*d)*c),a.lineTo(f(1.3*d)*b,-g(1.3*d)*b),a.lineTo(0*c,-g(1.5*d)*c),a.lineTo(f(1.7*d)*b,-g(1.7*d)*b),a.lineTo(f(1.9*d)*c,-g(1.9*d)*c),a.lineTo(f(.1*d)*b,-g(.1*d)*b)}function A(a,b,c,e,h,i){var j=i,k=j/1.8,l=k/2.5;a.translate(k+e,k+h),a.strokeStyle="#727272",a.fillStyle=u[b][c].fillColor,a.beginPath(),2===c&&(a.strokeStyle="#727272",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle=u[b][c].strokeStyle,z(a,k,l),a.stroke(),a.closePath()),0===c&&(a.fillStyle="white",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath()),1===c&&(a.strokeStyle=u[b][c].fillColor,a.moveTo(0*k,-g(.5*d)*k),a.lineTo(f(.7*d)*l,-g(.7*d)*l),a.lineTo(f(.9*d)*k,-g(.9*d)*k),a.lineTo(f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fill(),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(0*k,-g(.5*d)*k),a.lineTo(-f(.7*d)*l,-g(.7*d)*l),a.lineTo(-f(.9*d)*k,-g(.9*d)*k),a.lineTo(-f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(-f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fillStyle="white",a.fill(),a.closePath(),a.beginPath(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath())}b.drawStar=A;function B(a,b,c,d,e,f){2===c?E(a,b,c,d,e,f):0===c?C(a,b,c,d,e,f):1===c&&D(a,b,c,d,e,f)}b.drawIconTypeIsEight=B;function C(a,b,c,f,g,h){var i=h,j=e(i/2);a.translate(f+j,g+j),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.stroke(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.375*-i,.1*-i,.75*i,.2*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.1*-i,.375*-i,.2*i,.75*i),a.closePath(),a.fill(),a.stroke()}function D(a,b,c,e,f,g){var h=g;a.translate(e,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(h/3,.1*h),a.lineTo(h/1.5,.1*h),a.lineTo(.625*h,.6*h),a.lineTo(.375*h,.6*h),a.lineTo(h/3,.1*h),a.moveTo(.625*h,.85*h),a.arc(.5*h,.8*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.closePath()}function E(a,b,c,f,g,h){var i=h;a.translate(e(f+i/2),e(i/2+g)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.25*-i,.2*i,.5*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.05*i,.65*i,.2*i),a.closePath(),a.fill(),a.stroke()}function F(a,b,c,d,e,f){2===c?I(a,b,c,d,e,f):0===c?H(a,b,c,d,e,f):1===c&&G(a,b,c,d,e,f)}b.drawIconTypeIsNine=F;function G(a,b,c,e,f,g){var h=g;a.translate(e,f),a.beginPath(),a.strokeStyle=u[b][c].strokeStyle,a.moveTo(h/3,.5),a.lineTo(h/1.5,.5),a.lineTo(.625*h,.65*h),a.lineTo(.375*h,.65*h),a.lineTo(h/3,.5),a.moveTo(.65*h,.85*h),a.arc(.5*h,.85*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function H(a,b,c,d,f,g){var h,i,j=g;a.translate(e(d+j/2),e(f+j/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),h=.5*j,i=.075*j,V(a,-h,-i),U(a,-h,i),U(a,-i,i),U(a,-i,h),U(a,i,h),U(a,i,i),U(a,h,i),U(a,h,-i),U(a,i,-i),U(a,i,-h),U(a,-i,-h),U(a,-i,-i),U(a,-h,-i),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function I(a,b,c,d,f,g){var h=g;a.translate(e(d+h/2),e(f+h/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.25*-h,.2*h,.5*h),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.05*h,.75*h,.2*h),a.closePath(),a.fill(),a.stroke()}function J(a,b,c,d,f,g){var h=1.2*g;a.translate(d,f),a.strokeStyle=p,a.fillStyle=p,v(a,e(.2*h)+.5,.5,e(.06*h),e(.8*h)),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,.4*h,.5),U(a,.4*h,.5*h),U(a,.9*h,.25*h),U(a,.4*h,.5),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}b.drawFlag=J;function K(a,b,c,d,e,f){2===c?M(a,b,c,d,e,f):1===c?P(a,b,c,d,e,f):O(a,b,c,d,e,f)}b.drawIconTypeIsSen=K;function L(a,b,c,f,g,h){var i=e(h);a.strokeStyle=u[b][c].strokeStyle,a.fillStyle=u[b][c].fillColor,v(a,f+.5,g+.5,i,i),a.beginPath(),a.arc(i/2+f+.5,i/2+g+.5,.375*i,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.stroke()}b.drawTrafficLight=L;function M(a,b,c,e,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(h/2+e,h/2+f,h/2,0,2*d),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}b.drawCircle=M;function N(a,b,c,d,e,f){1===c?Q(a,b,c,d,e,f):0===c?R(a,b,c,d,e,f):2===c&&S(a,b,c,d,e,f)}b.drawIconTypeIsTwo=N;function O(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.translate(d+e(h/2),f+e(h/2)),a.beginPath(),V(a,0,-h/2),U(a,h/2,0),U(a,0,h/2),U(a,-h/2,0),U(a,0,-h/2),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function P(a,b,c,d,f,g){var h=e(g);a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,0,h),U(a,h/2,h-h/2*Math.sqrt(3)),U(a,h,h),U(a,0,h),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function Q(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),a.rotate(u[b][c].rotate),V(a,-h/2,-h/5.4),U(a,h/2,-h/5.4),U(a,h/2,h/5.4),U(a,-h/2,h/5.4),U(a,-h/2,-h/5.4),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function R(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,-h/3),U(a,h/2,-h/3),U(a,0,h/3),U(a,-h/2,-h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function S(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,h/3),U(a,h/2,h/3),U(a,0,-h/3),U(a,-h/2,h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function T(a,b,c,d,f,g){var h,i,j,k,l=g/3.5,m=u[b].length-1;a.strokeStyle=u[b][m-c].strokeStyle,a.translate(e(1.75*l+d),e(1.75*l+f)),a.rotate(u[b][m-c].rotate),a.beginPath(),h=.25*l,i=1.25*l,j=.75*l,k=1.75*l,V(a,-j,-k),U(a,h,-k),U(a,h,h),U(a,i,-j),U(a,i,h),U(a,-h,k),U(a,-k,h),U(a,-k,-j),U(a,-j,h),U(a,-j,-k),a.fillStyle=u[b][m-c].fillColor,a.fill(),a.stroke()}b.drawArrows=T;function U(a,b,c){a.lineTo(e(b)+.5,e(c)+.5)}function V(a,b,c){a.moveTo(e(b)+.5,e(c)+.5)}},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});;var cultureInfo,Forguncy;switch(Forguncy.StaticData.Lang){case"cn":GC.Spread.Common.CultureManager.culture("zh-cn");cultureInfo=GC.Spread.Common.CultureManager.getCultureInfo("zh-cn");cultureInfo.DateTimeFormat.preselectedFormatters=["yyyyMd","yyyyMdd","yyyyMMd","yyyyMMdd"];break;case"ja":GC.Spread.Common.CultureManager.culture("ja-jp");break;case"kr":GC.Spread.Common.CultureManager.culture("ko-kr");break;case"en":GC.Spread.Common.CultureManager.culture("en-us")}GC.Spread.Common.HandleExcelSpecialDate=function(n,t){switch(t){case 0:return n>=new Date(1899,11,30)&&n<new Date(1900,0,1)?1900:n.getFullYear();case 1:return n>=new Date(1899,11,30)&&n<new Date(1900,0,1)?0:n>=new Date(1900,0,31)&&n<new Date(1900,1,1)?1:n.getMonth();case 2:return n>=new Date(1899,11,30)&&n<new Date(1899,11,31)?0:n>=new Date(1899,11,31)&&n<new Date(1900,0,1)||n>=new Date(1900,0,31)&&n<new Date(1900,1,1)?1:n>=new Date(1900,0,1)&&n<new Date(1900,0,31)||n>=new Date(1900,1,1)&&n<new Date(1900,2,1)?n.getDate()+1:n.getDate();default:return}};GC.Spread.Sheets.Worksheet.prototype.recalcAll=function(){return null};GC.Spread.CalcEngine.supportRowColumnFormula=!0,function(n){var t=function(){function t(){}return t.init=function(){t.resetCursorResource()},t.resetCursorResource=function(){GC.Spread.Sheets.CursorResource.ResizeCol="url('"+n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/vresize.cur'),pointer";GC.Spread.Sheets.CursorResource.ResizeRow="url('"+n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/hresize.cur'),pointer";GC.Spread.Sheets.CursorResource.ResizeHiddenCol="col-resize";GC.Spread.Sheets.CursorResource.ResizeHiddenRow="row-resize"},t}();n.SpreadJSModifier=t;t.init()}(Forguncy||(Forguncy={}))
;