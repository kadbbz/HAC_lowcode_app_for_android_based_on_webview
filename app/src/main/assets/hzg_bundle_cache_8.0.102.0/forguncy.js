
;
;var Forguncy;(function(n){var t,i;(function(n){n[n.Left=0]="Left";n[n.Center=1]="Center";n[n.Right=2]="Right";n[n.General=3]="General"})(t=n.CellHorizontalAlignment||(n.CellHorizontalAlignment={})),function(n){n[n.Top=0]="Top";n[n.Center=1]="Center";n[n.Bottom=2]="Bottom"}(i=n.CellVerticalAlignment||(n.CellVerticalAlignment={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var r=function(){function t(){}return t.requestRSAPublicKey=function(t){n.Common.forguncyPost("Account/GetRSAPublicKey",null,function(i){(i===null||i===void 0?void 0:i.Result)?t(i.Result):alert(n.RS.Failed)},null,function(){alert(n.RS.Failed)})},t}(),i;t.SecurityManager=r;i=function(){function t(){}return t.encrypt=function(t,i,r){return n.ModuleLoader.LoadModels(["jsencrypt"],n.ForguncyData.ForguncyRoot).done(function(){var u=new JSEncrypt({}),n;if(u.setPublicKey(i),n=u.encrypt(t),n!==!1)r(n);else throw new Error("Can't encrypt password");})},t}();t.Encrypter=i})(t=n.Security||(n.Security={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=function(){function n(n,t){n===void 0&&(n=0);t===void 0&&(t=0);this.x=n;this.y=t}return Object.defineProperty(n,"Zero",{get:function(){return new n(0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sqrtLength",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!1,configurable:!0}),n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.normalize=function(){var t=1/this.length;return new n(this.x*t,this.y*t)},n.prototype.negate=function(){return new n(-this.x,-this.y)},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.multiply=function(t){return new n(this.x*t,this.y*t)},n.prototype.divide=function(t){var i=1/t;return new n(this.x*i,this.y*i)},n.prototype.dot=function(n){return this.x*n.x+this.y*n.y},n.prototype.rotate=function(t){var i=Math.sin(t),r=Math.cos(t);return new n(this.x*r-this.y*i,this.y*r+this.x*i)},n.prototype.setLength=function(n){var t=this.length;t>0&&(this.x=this.x*n/t,this.y=this.y*n/t)},n.prototype.limitLength=function(n){var t=this.length;t>n&&this.setLength(n)},n.prototype.cos=function(n){return this.dot(n)/(this.length*n.length)},n}();n.Vector2=t})(t=n.Numerics||(n.Numerics={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var h=function(){function t(){}Object.defineProperty(t,"default",{get:function(){var i,r=n.ForguncyData.GlobalSettings;return(i=r===null||r===void 0?void 0:r.ThemeFont)!==null&&i!==void 0?i:t[n.RS.Culture]},enumerable:!1,configurable:!0});var i,r,u,f;return i="EN",r="CN",u="JA",f="KR",t[i]="Calibri",t[r]="Microsoft YaHei",t[u]="Meiryo UI",t[f]="Malgun Gothic",t}(),t,i,r,u,f,e,o,s;n.LocaleFonts=h;t=function(){function n(){}return n.Culture="EN",n.NeedChangeOriginPassword="The current password is the initial password, please modify your initial password for security.",n.PasswordNotChange="The new password cannot be the same as the old password.",n.UserNameOrPasswordIsIncorrect="User name or password is incorrect",n.PasswordIsNotSame="The passwords do not match.",n.ForSafetyReasonPleaseChangeYourPassword="You are successfully signed in. Change your default password for security reasons.",n.TokenIsInvalid="Invalid token",n.ResetPasswordSuccess="The password has been reset successfully!",n.Failed="Failed",n.UserName="User Name",n.None="<None>",n.deleteStr="Delete",n.addStr="Add",n.listviewNotExisted="The listview does not exist.",n.FullName="Full Name",n.Email="Email",n.Role="Role",n.OrganizationSuperior="Supervisor",n.Success="Successful!",n.ConfirmDelete="Are you sure you want to delete?",n.Year="Year",n.Month="Month",n.Day="Day",n.Quarter="Quarter",n.noFieldErrorInfo="There are no data binding settings required to update the tabel {0}.",n.unique="The value already exists. Specify different value.",n.login="Sign in",n.cantAddEmptyFile="An empty file cannot be uploaded.",n.Boolean_True="Yes",n.Boolean_False="No",n.MonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],n.ColumnFilter_YearName="",n.ColumnFilter_DayName="",n.ContextMenu_CompareType_Equals="Equal to",n.ContextMenu_CompareType_DoesNotEqual="Does not equal to",n.ContextMenu_CompareType_BeginsWith="Begin with",n.ContextMenu_CompareType_DoesNotBeginWith="Does not begin with",n.ContextMenu_CompareType_EndsWith="End with",n.ContextMenu_CompareType_DoesNotEndWidth="Does not end with",n.ContextMenu_CompareType_Contains="Contain",n.ContextMenu_CompareType_DoesNotContain="Does not contain",n.ContextMenu_CompareType_IsGreaterThan="Greater than",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="Greater than or equal to",n.ContextMenu_CompareType_IsLessThan="Less than",n.ContextMenu_CompareType_IsLessThanOrEqualTo="Less than or equal to",n.ContextMenu_CompareType_IsBetween="Between",n.ContextMenu_CompareType_IsNotBetween="Not between",n.ContextMenu_CompareType_In="In",n.ContextMenu_CompareType_NotIn="Not in",n.ContextMenu_CompareType_IsLessThan_Date="Before",n.ContextMenu_CompareType_IsGreaterThan_Date="After",n.ComboBox_CompareType_Equals="equal to",n.ComboBox_CompareType_DoesNotEqual="does not equal to",n.ComboBox_CompareType_BeginsWith="begin with",n.ComboBox_CompareType_DoesNotBeginWith="does not begin with",n.ComboBox_CompareType_EndsWith="end with",n.ComboBox_CompareType_DoesNotEndWidth="does not end with",n.ComboBox_CompareType_Contains="contain",n.ComboBox_CompareType_DoesNotContain="does not contain",n.ComboBox_CompareType_IsGreaterThan="greater than",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="greater than or equal to",n.ComboBox_CompareType_IsLessThan="less than",n.ComboBox_CompareType_IsLessThanOrEqualTo="less than or equal to",n.ComboBox_CompareType_IsBetween="between",n.ComboBox_CompareType_IsNotBetween="not between",n.ComboBox_CompareType_In="in",n.ComboBox_CompareType_NotIn="not in",n.ComboBox_CompareType_IsLessThan_Date="before",n.ComboBox_CompareType_IsGreaterThan_Date="after",n.DateCompareType_Tomorrow="Tomorrow",n.DateCompareType_Today="Today",n.DateCompareType_Yesterday="Yesterday",n.DateCompareType_NextWeek="Next Week",n.DateCompareType_ThisWeek="Current Week",n.DateCompareType_LastWeek="Previous Week",n.DateCompareType_NextMonth="Next Month",n.DateCompareType_ThisMonth="Current Month",n.DateCompareType_LastMonth="Previous Month",n.DateCompareType_NextYear="Next Year",n.DateCompareType_ThisYear="Current Year",n.DateCompareType_LastYear="Previous Year",n.ForguncyUI_Dialog_OK="OK",n.ForguncyUI_Dialog_Cancel="Cancel",n.ColumnFilter_Dialog_Title="Filter",n.ColumnFilter_ContextMenu_SortAscending="Sort Ascending",n.ColumnFilter_ContextMenu_SortDesending="Sort Desending",n.ColumnFilter_ContextMenu_ClearFilter="Clear Filter",n.ColumnFilter_ContextMenu_Filter="Filter",n.ColumnFilter_ContextMenu_CustomFilter="Custom Filters",n.ColumnFilter_ContextMenu_NumberFilter="Number Filters",n.ColumnFilter_ContextMenu_TextFilter="Text Filters",n.ColumnFilter_ContextMenu_DateFilter="Date Filters",n.ColumnFilter_TreeView_SelectAll="(Select All)",n.ColumnFilter_TreeView_Blanks="(Blanks)",n.ColumnFilter_TreeView_TooManyItems="Some items are not shown.",n.ColumnFilter_TextBlock_And="And",n.ColumnFilter_TextBlock_Where="Show items where:",n.ColumnFilter_Alert_IncorrectValue="The value entered is incorrect！",n.ColumnFilter_TextBlock_TextExample_In="e.g. Apple,Banana,Orange (comma separated)",n.ColumnFilter_TextBlock_DateExample="e.g. 2019/01/01",n.ColumnFilter_TextBlock_DateExample_Between="e.g. 2019/01/01 and 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="e.g. 10:00",n.ColumnFilter_TextBlock_TimeExample_Between="e.g. 10:00 and 12:00",n.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage="(Current Page Only)",n.ColumnOptionsCommand_Title="Column Options",n.ColumnOptionsCommand_AvailableColumns="Available Columns:",n.ColumnOptionsCommand_SelectedColumns="Selected Columns:",n.ColumnOptionsCommand_UnamedColumn="<Unnamed Column>",n.ColumnOptionsCommand_ResetSetting="Reset settings",n.ColumnOptionsCommand_ConfirmResetSetting="Are you sure you want to reset the settings?\r\nNote that the browser will be refreshed immediately.",n.ColumnOptionsCommand_AddColumn="Add Column",n.ColumnOptionsCommand_RemoveColumn="Remove Column",n.ColumnOptionsCommand_MoveColumnUp="Move Column Up ",n.ColumnOptionsCommand_MoveColumnDown="Move Column Down",n.AttachmentCell_NotSupportedFile="Unsupported File",n.CurrentUserCell_ChangeProfile="Change Profile",n.CurrentUserCell_ChangePassword="Change Password",n.CurrentUserCell_Logout="Sign out",n.ChangeCurrentUserMFA_Enable="Enable Two-factor authentication",n.ChangeCurrentUserMFA_Disable="Disable Two-factor authentication",n.ChangeCurrentUserMFA_Enable_Confirm="Are you sure you want to enable the Two-factor authentication? You'll have to sign in again after the changes are made.",n.ChangeCurrentUserMFA_Disable_Confirm="Are you sure you want to disable the Two-factor authentication? This page will refresh.",n.ChangeCurrentUserMFA_Enable_Fail="Failed to enable Two-factor authentication.",n.ChangeCurrentUserMFA_Disable_Fail="Failed to disable Two-factor authentication.",n.ProcessBarCell_AssignedToPopup_Title="Currently Assigned To",n.ProcessBarCell_AssignedTo="Assigned To",n.ProcessBarCell_AssignedTo_me="me",n.ProcessBarCell_AssignedToMultiUser="{0} and {1} more",n.ProcessBarCell_HistoryPopup_Title="Status History",n.ProcessBarCell_History_Operator="Action By",n.ProcessBarCell_History_Time="Time",n.ProcessBarCell_History_EndStatus="Post Action State",n.ProcessBarCell_History_Comments="Comments",n.ProcessBarCell_History_ActionName="Action Name",n.ProcessBarCell_ActionPopup_Title="Update State",n.ProcessBarCell_ActionPopup_NextStatus="Next State:",n.ProcessBarCell_ActionPopup_Assignto_Choose="Assign To:",n.ProcessBarCell_ActionPopup_Assignto_All="Available Assignees:",n.ProcessBarCell_ActionPopup_Comments="Comments:",n.ProcessBarCell_OK="OK",n.ProcessBarCell_Cancel="Cancel",n.ProcessBarCell_Status="Status: {0}",n.ProcessBarCell_ChangeStateFailed="Failed to _execute the action",n.ProcessBarCell_ChangeAssignee="Change Assignee",n.ProcessBarCell_CreateBy="Created by {0} at {1}",n.ProcessBarCell_LastModifyBy="Modified by {0} at {1}",n.CannotFindCell="A cell with the name '{0}' does not exist on this page.",n.CannotFindCellById="A cell with an id '{0}' does not exist on this page.",n.CannotFindListview="A listview with the name '{0}' does not exist on this page.",n.CannotFindColumn="A column with the name '{0}' does not exist in '{1}' listview",n.CannotFindColumnIndex="Invalid column index '{0}' in listview '{1}'.",n.NotSupportEventForPage="The event '{0}' is not supported for {1}.",n.NotSupportEventForCellOrListview="The event '{0}' is not supported for {1} '{2}'.",n.NotSupportSetValue="This method isn't supported for cell '{0}'.",n.InvalidNumberParam="Specify a valid value for the '{0}' parameter.",n.IndexOutOfRange="Parameter '{0}' is out of range.",n.ForguncyApiExceptionString="{0} in {1}.{2} method : {3}.",n.InvalidFunctionParam="Specify a function to the parameter '{0}'.",n.HideShowColumns_CannotHideRowHeader="Can't show or hide row header columns.",n.HideShowColumns_ListviewIsEditing="Can't show or hide columns when listview is in edit mode.",n.HideShowColumns_CannotShowHiddenColumn="Can't show columns that are set to be hidden at runtime, or the widths are set to zero (0).",n.CannotFindCommandInCell="The cell '{0}' on this page doesn't have any commands associated with it.",n.CannotUseCommandParameterInCurrentContext="Can't access command parameters (variables) in the current context.",n.CannotSelectCellInColumn="Following cells can't be selected: 1) cells that are part of column or rwo headers, 2) in the selected column, 3) hidden cells.",n.WebApi_ErrorInfo_NonemptyStringParam="The '{0}' parameter can't be an empty string.",n.WebApi_ErrorInfo_ParamInvalid="The '{0}' parameter is invalid.",n.groupCell_Other="Others:",n.ClosePopupCommand_NotPopup="Can't issue a 'close popup window' command on this page because it is not a popup page.",n.AddUserApiParamError="Invalid parameters!",n.Echart_DataLoadingText="Loading data...",n.Echart_NoDataLoadingText="No Data",n.Echart_BubbleChartToolTip="Size: {0}",n.InvalidCopyPasteSize="The copy area and the paste area are NOT of the same size.",n.RangeOperationCannotInvolveTotalRow="You can't perform a cell operation on a cell range that involves cell(s) in the total row.",n.ValidateErrorMessage="The value '{0}' at Row {1} and Column {2} is invalid.\r\nError Message:\r\n{3}",n.InvalidValueTypeMessage="Invalid value type.",n.ValueNotInList="That value is not found in the list of items.",n.ErrorInfo_Uncommited="Can't perform query or sort operations since the data is in an uncommited state.",n.DataValidation_Required="Required",n.DataValidation_WholeNumberDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_DecimalDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_DateDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_TimeDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_TextLenghtDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_CustomDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_RegularUserInputDefaultErrorMessage="This value doesn't match the data validation restrictions defined for this cell.",n.DataValidation_RegularDefaultErrorMessage="An invalid regular expression is specified for '{0}'.",n.Validate_Number="Enter a valid number.",n.InvalidValueErrorMessage="Can't commit an invaid value '{0}' to the '{1}' column of '{2}'table .",n.uploadFileBiggerThanMaxFileCount="The maximum allowed number of files has already been uploaded. No further files can be uploaded.",n.uploadFileBiggerThanMaxSize="The file size of '{0}' is greater than than the maximum allowed uploadedable file size of {1}MB.",n.uploadFileNotMatchExtension="The file type of the file '{0}' is not permitted to be uploaded.",n.ExprotToExcelCalFormulaError="Can't export as an Excel document because there are errors with the formula results.",n.ExprotToPDFCalFormulaError="Can't export as a PDF document because there are errors with the formula results.",n.ExportListviewNoColumnError="There are no columns to be exported.",n.AutoGeneratedID_Conflict_Error="The auto-generated ID already exists. A new ID will be generated so try committing data again.",n.AutoGeneratedID_Generate_Error="The auto-generated number is greater than the specified length.",n.AutoGeneratedID_Conflict_Listview_Error="A value already exists in the '{0}' field.",n.ImportExcelFirstRowMissDataError="The Excel document specified for import doesn't have any data in its first row.",n.NoMatchBetweenExcelWithListViewError="The Excel document specified for import doesn't have the data structure that matches the target listview. Can’t find matching columns in the Excel document: {0}",n.InCorrectFileFormatError="An incorrect file format specified.",n.NoSelectedRowError="Select at least one row.",n.ImportExcelCannotFindListViewError="Can't find listview '{0}'.",n.GUID_Creator="CreatedBy",n.GUID_CreateDate="CreationDate",n.GUID_LastModifyBy="ModifiedBy",n.GUID_LastModifyDate="ModificationDate",n.GUID_AssignTo="AssignedTo",n.GUID_Status="Status",n.UpdateListviewCommand_Listview_Group="Can't update a listview that contains an aggregated column.",n.UpdateListviewCommand_Listview_DetailListview="Can't update a detail listview that doesn't have a record that corresponds to the master table.",n.ImportExcelToListViewError_Detail="An invalid value found in the Excel document at row '{0}' and column '{1}'.\r\nError message: {2}",n.ImportExcelToListViewError_ExistSameKeys="Ensure that the column(s) specified to identify a record uniquely don't have duplicated values in the Excel document.\r\nDuplicated values are as follows:\r\n{0}",n.UpdateViewFail_Error="Failed to update the current view.",n.UpdateListViewFail_BindingTableCantEditError="Failed to update the current data binding.",n.ConcurrentLicenseError_Kickoffed="You have been kicked out by an administrator.",n.ConcurrentLicenseError_NoEnoughLicense="Access has been denied because the permissible concurrent user count has reached its limit. Contact your administrator.",n.ConcurrentLicenseError_SendEmail="Send Email",n.ConcurrentLicenseError_Cancel="Cancel",n.ConcurrentLicenseError_MessagePlaceHolder="Input email content here.",n.ConcurrentLicenseError_AddressPlaceHolder="Input sender email address.",n.ConcurrentLicenseError_SendSuccess="Email sent successfully.",n.ConcurrentLicenseError_SendFailed="Failed to send email.",n.ConcurrentLicenseError_EmailTitle="[Forguncy Server] Access denied.",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="Input valid email address.",n.ConcurrentLicenseError_SenderAddress="From",n.ContainerCellType_Error_CircularReference="Failed to load the sub page '{0}' due to a circular reference found.",n.NameConflict="There is a conflict with the name '{0}'. Such name exists in both page '{1}' and page '{2}'.",n.ContainerCellType_Error_NoExistedPage="Can't find page '{0}'.",n.SetCurrentRow_Error_NoRecord="Failed to change current row on table '{0}'. A record matching such data queries doesn't exist.",n.ListViewAddNewRowError_CantConvertToNumber="Can't convert to a Number type.",n.ListViewAddNewRowError_CantConvertToBool="Can't convert to a YesNo type.",n.ListViewAddNewRowError_CantConvertToDateTime="Can't convert to a Date type.",n.CallStoredProcedureCommand_ExecuteFailed="Faild to execute a stored procedure.",n.Command_postFail_ErrorMessage="Failed to execute a command.",n.Commit_FailMessage="Failed to commit changes.",n.Commit_ExecutingMessage="A command is currently executing.",n.LongTimeNoOperation="The connection to application has been terminated due to a long idle time on the page.",n.PleaseClickButtonToReload="Click to reload the page.",n.ReloadPage="Reload Page",n.DateTime_Calender_HeaderFormat="yyyy/MM",n.DateTime_Calender_YearMonthFormat="yyyy/MM",n.UnauthorizedUpload="An anonymuse access not permitted. Sign in.",n.SessionTimeout="Session timed out. Sign in again.",n.ExprotActiveReportsCalFormulaError="Invalid file name for the report export.",n.ActiveReportsParameterValueCalFormulaError="Invalid parameter values for the report export.",n.NameConflictWarning="The name '{0}' conflicts with the cell name or a variable.",n.StartExecuteCommand="Execute command:",n.StartExecutePageLoadCommand="Executing on-pageload command {0}",n.StartExecuteCellClickCommand="Executing on-click command {0}",n.StartExecuteCellValudeChangedCommand="Executing on-cell-value-changed {0}",n.UseTime="Duration: {0} ms",n.DataValidationNotPassed="The command being cancelled due to the data validation failure.",n.PopupCloseButton="Close popup",n.CommandName_ClosePopupCommand="Close popup window",n.Log_NavigateCommand_PassValues="Pass values to the page being transferred to.",n.CreateCommandContextVariables="[Create command context's variables]",n.ServerCommandLog_CreateParam="Create Parameter: {0} = {1}",n.LeaveSiteConfirm="The changes you made may not be saved. Are you sure you want to leave this page?",n.LeaveSiteConsoleMessage_Cell="{0} cell",n.LeaveSiteConsoleMessage_Cell_DefaultValue="Default Value: {0}",n.LeaveSiteConsoleMessage_Cell_CurrentValue="Current Value: {0}",n.LeaveSiteConsoleMessage_Listview="{0} listview",n.CantFindParam="Can't find the parameter {0}",n.TriggerByCommand="Trigger by command {0}",n.ExportPageToExcelCommand_PageNameTooLong="The name of exported page cannot exceed 31.",n.ExportListviewToExcelCommand_PageNameTooLong="The name of page where the listview resides cannot exceed 31.",n.BPM_LogText_CommitTitle="start execute commit operation.",n.BPM_LogText_TerminateTitle="start execute terminate operation.",n.BPM_LogText_RollbackTitle="start execute rollback operation.",n.BPM_LogText_DispatchTitle="start execute dispatch operation.",n.BPM_LogText_DelegateTitle="start execute delegate operation.",n.BPM_LogText_CancelDelegateTitle="start execute cancel delegate operation.",n.BPM_LogText_AddOnSignTitle="start execute addon sign operation.",n.BPM_LogText_CarbonCopyTitle="start execute carbon copy operation.",n.BPM_LogText_ReadCarbonCopyTitle="start execute read carbon copy operation.",n.BPM_LogText_SaveBussinessData="Save business data: ",n.BPM_LogText_SaveBussinessDataCommand="[Excute save business data command]",n.BPM_LogText_ExecutePreCommands="[Execute pre commands]",n.BPM_LogText_ExecutePostCommands="[Execute post commands]",n.BPM_LogText_ExecuteTaskNodeAction="Execute task action [{0}], Task ID: [{1}]",n.BPM_LogText_CallStartProcessCommand_ByDefinitionID="Call ProcessStartCommand, ProcessDefinitionID: [{0}], Process Instance Name: {1}",n.BPM_LogText_CallStartProcessCommand_ByName="Call ProcessStartCommand, Process Name: [{0}], Process Instance Name: {1}",n.BPM_UserSetting_UnnamedNode="<Unnamed Node>",n.BPM_AssigneesRow_SelectByUser_Placeholder="Specify who to assign to",n.BPM_Error_AssigneesTarget_TypeIsNotExist="The type doesn't exist for the specified assignee.",n.CurrentRow_NotExist="Current row does not exist. Check the startup command of the process.",n.RowMode_NotExist="The selected row mode does not exist. Check the startup command of the process.",n.ProcessInstanceName_EvaluteError="The evaluation for the process instance name failed. Check the cell settings.",n.ProcessDefinitionId_EvaluteError="The evaluation for the process definition id failed. Check the cell settings.",n.ProcessPanelCellType_UnnamedAction="<Untitled Action>",n.ProcessPanelCellType_UnnamedNode="<Untitled Node>",n.ProcessPanelCellType_GenerateBusinessKey_Error="Failed to update the current database.",n.ProcessPanelCellType_UpdateCurrentRowsClosure_ConfirmText="Are you sure that you want to add this record?",n.TaskActionDialog_CommentTextRow_Label="Comments",n.TaskActionDialog_CommentTextRow_PlaceHolder="Enter comments.",n.TaskActionDialog_AssigneesRow_AssginToLabel="Assign To",n.TaskActionDialog_AssigneesRow_DelegateToLabel="Delegate To",n.TaskActionDialog_AssigneesRow_AddOnSignToLabel="AddOnSign To",n.TaskActionDialog_AssigneesRow_CarbonCopyToLabel="CarbonCopy To",n.TaskActionDialog_AssigneesRow_AddOnSignTypeLabel="Type",n.TaskActionDialog_AssigneesRow_AddOnSignTypePre="PreAddOnSign,add an approval step before current step",n.TaskActionDialog_AssigneesRow_AddOnSignTypePost="PostAddOnSign, add an approval step after current step",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle="Select User",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle_Mobile="Show the selected users ({0} users)",n.TaskActionDialog_AssigneesRow_Error_NoUserInfo="No optional users, contact your administrator",n.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty="The user(s) cannot be empty",n.UserSelectorDialog_SearchInput="Search User (UserName/Full Name/Email)",n.UserSelectorDialog_Selection_Title="{0} users selected",n.UserSelectorDialog_Selection_IsMultiple="Unlimited",n.UserSelectorDialog_Selection_NoMultiple="Only one person permitted",n.UserSelectorDialog_TreeView_Title="Organizational Department",n.UserSelectorDialog_TreeView_NotOrganizedUser="Not Organizational Users",n.UserSelectorDialog_UserList_Title="Optional Users",n.UserSelectorDialog_DeleteList_Title="Delete selected user(s)",n.UserSelectorDialog_DeleteListTip_Text="Are you sure delete {0} users?",n.CreateDelegateDialog_Title="Create Delegate",n.CreateDelegateDialog_Tip="During the delegation time, the delegation process tasks will be transferred to the agent for handling.",n.CreateDelegateDialog_DelegatedTime_Title="Time",n.CreateDelegateDialog_DelegatedTime_StartTime="Start Time:",n.CreateDelegateDialog_DelegatedTime_EndTime="End Time:",n.CreateDelegateDialog_DelegatedTime_Error_EndTimeMustEarilerStartTime="End time cannot be earlier than or equal to start time.",n.CreateDelegateDialog_Agent_Title="Agent",n.CreateDelegateDialog_Agent_Tip="* Find the first valid agent in order, if the first person is deleted, it will find the second person in order, and so on.",n.CreateDelegateDialog_Agent_SelectAgent="Select Agent",n.CreateDelegateDialog_Agent_DeleteAgent="Delete",n.CreateDelegateDialog_Agent_Error_AgentCannotBeEmpty="Agent cannot be empty",n.CreateDelegateDialog_DelegatedProcess_Title="Process",n.CreateDelegateDialog_DelegatedProcess_Tip="* 'All' are applied to all current and subsequent new processes. 'Select' only be applied to the selected processes. ",n.CreateDelegateDialog_DelegatedProcess_Type="Delegation Process:",n.CreateDelegateDialog_DelegatedProcess_AllProcesses="All Processes",n.CreateDelegateDialog_DelegatedProcess_SelectProcesses="Select Processes",n.CreateDelegateDialog_DelegatedProcess_Error_ProcessCannotBeEmpty="Process cannot be empty",n.CreateDelegateDialog_ProcessTable_Title="Title",n.CreateDelegateDialog_ProcessTable_Description="Description",n.CreateDelegateDialog_Description_Title="Description",n.CreateDelegateDialog_Description_Placeholder="Please enter description",n.CreateDelegateDialog_User_NotExist="Inexistent",n.CreateDelegateDialog_User_Disabled="Disabled",n.CreateDelegateDialog_Process_NotExist="Inexistent",n.DelegationListDialog_Title="Delegate Setting",n.DelegationListDialog_CreateDelegation="Create Delegate",n.DelegationListDialog_Table_AllProcesses="All Processes",n.DelegationListDialog_Table_EmptyTime="Empty",n.DelegationListDialog_Table_DataColumn_Agent="Agent(s)",n.DelegationListDialog_Table_DataColumn_DelegatedProcess="Process(es)",n.DelegationListDialog_Table_DataColumn_StartTime="Start Time",n.DelegationListDialog_Table_DataColumn_EndTime="End Time",n.DelegationListDialog_Table_DataColumn_CreateDate="Create Time",n.DelegationListDialog_Table_DataColumn_Description="Description",n.DelegationListDialog_Table_DataColumn_Update="Update",n.DelegationListDialog_Table_DataColumn_Delete="Delete",n.DelegationListDialog_Table_DataColumn_Enable="Enable",n.DelegationListDialog_Table_DataColumn_Disable="Disable",n.DelegationListDialog_Error_DelegationConfigurationIsEmpty="Delegation Configuration does not exist.",n.DelegationListDialog_Comfirm_EnabledConfuguration="Sure to enable delegate?",n.DelegationListDialog_Comfirm_DisabledConfuguration="Sure to disable delegate?",n.DelegationListDialog_Comfirm_DeleteConfuguration="Sure to delete delegate?",n.UpdateDelegateDialog_Title="Update Delegate",n.UI_Table_ActionColumn="Action(s)",n.ForguncyUserAvator_UserName="UserName",n.ForguncyUserAvator_FullName="FullName",n.ForguncyUserAvator_Email="Email",n.NotificationUnauthorized="Subscribe Server Notification failed, Maybe user is unauthorized.",n.NotificationLocationString="execute notification command",n}();n.RS=t;i=function(){function n(){}return n.Culture="CN",n.NeedChangeOriginPassword="当前密码为初始密码，为了安全，请修改您的初始密码。",n.UserNameOrPasswordIsIncorrect="用户名或密码错误",n.PasswordNotChange="新密码不能和旧密码相同",n.PasswordIsNotSame="输入的密码不相同",n.ForSafetyReasonPleaseChangeYourPassword="登录成功。为了安全，请修改您的初始密码",n.TokenIsInvalid="令牌值不正确",n.ResetPasswordSuccess="重置密码成功",n.Failed="失败",n.UserName="用户名",n.None="<未选择>",n.deleteStr="删除",n.addStr="添加",n.listviewNotExisted="表格不存在。",n.FullName="全名",n.Email="邮件",n.Role="角色",n.OrganizationSuperior="组织上级",n.Success="成功！",n.ConfirmDelete="确认要删除吗？",n.Year="年",n.Month="月",n.Day="日",n.Quarter="季度",n.noFieldErrorInfo="不存在数据表 {0} 的绑定字段。",n.unique="值已经存在，请输入其他值。",n.login="登录",n.cantAddEmptyFile="不能上传空文件。",n.Boolean_True="是",n.Boolean_False="否",n.MonthNames=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],n.ColumnFilter_YearName="年",n.ColumnFilter_DayName="日",n.ContextMenu_CompareType_Equals="等于",n.ContextMenu_CompareType_DoesNotEqual="不等于",n.ContextMenu_CompareType_BeginsWith="开头是",n.ContextMenu_CompareType_DoesNotBeginWith="开头不是",n.ContextMenu_CompareType_EndsWith="结尾是",n.ContextMenu_CompareType_DoesNotEndWidth="结尾不是",n.ContextMenu_CompareType_Contains="包含",n.ContextMenu_CompareType_DoesNotContain="不包含",n.ContextMenu_CompareType_IsGreaterThan="大于",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="大于或等于",n.ContextMenu_CompareType_IsLessThan="小于",n.ContextMenu_CompareType_IsLessThanOrEqualTo="小于或等于",n.ContextMenu_CompareType_IsBetween="介于两者",n.ContextMenu_CompareType_IsNotBetween="不介于两者",n.ContextMenu_CompareType_In="在里面",n.ContextMenu_CompareType_NotIn="不在里面",n.ContextMenu_CompareType_IsLessThan_Date="之前",n.ContextMenu_CompareType_IsGreaterThan_Date="之后",n.ComboBox_CompareType_Equals="等于",n.ComboBox_CompareType_DoesNotEqual="不等于",n.ComboBox_CompareType_BeginsWith="开头是",n.ComboBox_CompareType_DoesNotBeginWith="开头不是",n.ComboBox_CompareType_EndsWith="结尾是",n.ComboBox_CompareType_DoesNotEndWidth="结尾不是",n.ComboBox_CompareType_Contains="包含",n.ComboBox_CompareType_DoesNotContain="不包含",n.ComboBox_CompareType_IsGreaterThan="大于",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="大于或等于",n.ComboBox_CompareType_IsLessThan="小于",n.ComboBox_CompareType_IsLessThanOrEqualTo="小于或等于",n.ComboBox_CompareType_IsBetween="介于两者",n.ComboBox_CompareType_IsNotBetween="不介于两者",n.ComboBox_CompareType_In="在里面",n.ComboBox_CompareType_NotIn="不在里面",n.ComboBox_CompareType_IsLessThan_Date="之前",n.ComboBox_CompareType_IsGreaterThan_Date="之后",n.DateCompareType_Tomorrow="明天",n.DateCompareType_Today="今天",n.DateCompareType_Yesterday="昨天",n.DateCompareType_NextWeek="下周",n.DateCompareType_ThisWeek="本周",n.DateCompareType_LastWeek="上周",n.DateCompareType_NextMonth="下月",n.DateCompareType_ThisMonth="本月",n.DateCompareType_LastMonth="上月",n.DateCompareType_NextYear="明年",n.DateCompareType_ThisYear="今年",n.DateCompareType_LastYear="去年",n.ForguncyUI_Dialog_OK="确定",n.ForguncyUI_Dialog_Cancel="取消",n.ColumnFilter_Dialog_Title="筛选",n.ColumnFilter_ContextMenu_SortAscending="升序排序",n.ColumnFilter_ContextMenu_SortDesending="降序排序",n.ColumnFilter_ContextMenu_ClearFilter="清空筛选",n.ColumnFilter_ContextMenu_Filter="设置筛选",n.ColumnFilter_ContextMenu_CustomFilter="自定义筛选",n.ColumnFilter_ContextMenu_NumberFilter="数字筛选",n.ColumnFilter_ContextMenu_TextFilter="文本筛选",n.ColumnFilter_ContextMenu_DateFilter="日期筛选",n.ColumnFilter_TreeView_SelectAll="(全选)",n.ColumnFilter_TreeView_Blanks="(空白项)",n.ColumnFilter_TreeView_TooManyItems="数据过多，仅显示前 500 项！",n.ColumnFilter_TextBlock_And="和",n.ColumnFilter_TextBlock_Where="显示行：",n.ColumnFilter_Alert_IncorrectValue="输入的值不正确！",n.ColumnFilter_TextBlock_TextExample_In="示例：苹果,香蕉,橘子 (使用半角逗号分隔)",n.ColumnFilter_TextBlock_DateExample="示例：2019/01/01",n.ColumnFilter_TextBlock_DateExample_Between="示例：2019/01/01 和 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="示例：10:00",n.ColumnFilter_TextBlock_TimeExample_Between="示例：10:00 和 12:00",n.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage="（仅限当前页）",n.ColumnOptionsCommand_Title="列选项",n.ColumnOptionsCommand_AvailableColumns="可用列：",n.ColumnOptionsCommand_SelectedColumns="显示列：",n.ColumnOptionsCommand_UnamedColumn="<未命名列>",n.ColumnOptionsCommand_ResetSetting="重置设定",n.ColumnOptionsCommand_ConfirmResetSetting="您确定要重置设定吗?\r\n注意：这将导致浏览器立即刷新。",n.ColumnOptionsCommand_AddColumn="添加列",n.ColumnOptionsCommand_RemoveColumn="移除列",n.ColumnOptionsCommand_MoveColumnUp="上移列 ",n.ColumnOptionsCommand_MoveColumnDown="下移列",n.AttachmentCell_NotSupportedFile="不支持的文件类型",n.CurrentUserCell_ChangeProfile="修改个人信息",n.CurrentUserCell_ChangePassword="修改密码",n.CurrentUserCell_Logout="退出当前账户",n.ChangeCurrentUserMFA_Enable="启用两步验证",n.ChangeCurrentUserMFA_Disable="停用两步验证",n.ChangeCurrentUserMFA_Enable_Confirm="确定要启用两步验证吗？ 启用两步验证后需要重新登录以完成设备绑定过程。",n.ChangeCurrentUserMFA_Disable_Confirm="确定要停用两步验证吗？ 停用两步验证后当前页面会重新加载。",n.ChangeCurrentUserMFA_Enable_Fail="启用两步验证失败。",n.ChangeCurrentUserMFA_Disable_Fail="停用两步验证失败。",n.ProcessBarCell_AssignedToPopup_Title="担当者",n.ProcessBarCell_AssignedTo="担当者",n.ProcessBarCell_AssignedTo_me="我",n.ProcessBarCell_AssignedToMultiUser="{0}及其他{1}人",n.ProcessBarCell_HistoryPopup_Title="状态历史",n.ProcessBarCell_History_Operator="操作者",n.ProcessBarCell_History_Time="时间",n.ProcessBarCell_History_EndStatus="结束状态",n.ProcessBarCell_History_Comments="备注",n.ProcessBarCell_History_ActionName="操作名称",n.ProcessBarCell_ActionPopup_Title="更新状态",n.ProcessBarCell_ActionPopup_NextStatus="下个状态",n.ProcessBarCell_ActionPopup_Assignto_Choose="选择担当者",n.ProcessBarCell_ActionPopup_Assignto_All="下个操作的担当者",n.ProcessBarCell_ActionPopup_Comments="注释",n.ProcessBarCell_OK="确定",n.ProcessBarCell_Cancel="取消",n.ProcessBarCell_Status="状态: {0}",n.ProcessBarCell_ChangeStateFailed="执行操作失败",n.ProcessBarCell_ChangeAssignee="修改担当者",n.ProcessBarCell_CreateBy="创建者：{0}，创建时间：{1}",n.ProcessBarCell_LastModifyBy="最后更新者：{0}，更新时间：{1}",n.CannotFindCell="本页面不能发现命名为'{0}'的单元格",n.CannotFindCellById="本页面不能发现Id等于'{0}'的单元格",n.CannotFindListview="本页面不能发现命名为'{0}'的表格",n.CannotFindColumn="在表格'{1}'中不能发现命名为'{0}'的列",n.CannotFindColumnIndex="在表格'{1}'中没有第'{0}'列",n.NotSupportEventForPage="'{1}'不支持事件'{0}'",n.NotSupportEventForCellOrListview="'{1}'或者'{2}'不支持事件'{0}'",n.NotSupportSetValue="单元格'{0}'不支持此方法",n.InvalidNumberParam="请设置正确的值给参数'{0}'",n.IndexOutOfRange="参数'{0}'超出范围",n.ForguncyApiExceptionString="{0} 在 {1}.{2} 方法 : {3}",n.InvalidFunctionParam="参数'{0}'应当是一个函数",n.HideShowColumns_CannotHideRowHeader="不能隐藏或显示行头/选择列",n.HideShowColumns_ListviewIsEditing="表格正在编辑，不能隐藏或显示列",n.HideShowColumns_CannotShowHiddenColumn="不能显示隐藏列（没有开启忽略隐藏）和在设计器中宽度为0的列",n.CannotFindCommandInCell="在单元格 '{0}' 上没有设置命令",n.CannotUseCommandParameterInCurrentContext="不能再当前上下文环境下访问命令参数（变量）",n.CannotSelectCellInColumn="不能选择行头，选择列和非显示列中的单元格",n.WebApi_ErrorInfo_NonemptyStringParam="参数'{0}'应当是一个非空字符。",n.WebApi_ErrorInfo_ParamInvalid="参数'{0}'无效",n.groupCell_Other="其他：",n.ClosePopupCommand_NotPopup="当前页面不是弹出式页面。",n.AddUserApiParamError="参数类型不正确！",n.Echart_DataLoadingText="数据加载中...",n.Echart_NoDataLoadingText="没有数据",n.Echart_BubbleChartToolTip="大小： {0}",n.InvalidCopyPasteSize="复制区域和粘贴区域大小不一样。",n.RangeOperationCannotInvolveTotalRow="单元格区域操作不能包含汇总行。",n.ValidateErrorMessage="值'{0}'在行: {1}, 列: {2}无效。\r\n错误信息:\r\n{3}",n.InvalidValueTypeMessage="无效的值类型。",n.ValueNotInList="没有包含在项目列表里。",n.ErrorInfo_Uncommited="有未提交的数据。",n.DataValidation_Required="不能为空",n.DataValidation_WholeNumberDefaultErrorMessage="输入的整数值非法",n.DataValidation_DecimalDefaultErrorMessage="输入的小数值非法",n.DataValidation_DateDefaultErrorMessage="输入的日期值非法",n.DataValidation_TimeDefaultErrorMessage="输入的时间值非法",n.DataValidation_TextLenghtDefaultErrorMessage="输入值的长度非法",n.DataValidation_CustomDefaultErrorMessage="输入的值非法",n.DataValidation_RegularUserInputDefaultErrorMessage="输入的值非法",n.DataValidation_RegularDefaultErrorMessage="输入的值无法通过{0}的验证",n.Validate_Number="请输入一个有效数字。",n.InvalidValueErrorMessage="不能提交无效的值'{0}' 到表'{2}'的列'{1}'。",n.uploadFileBiggerThanMaxFileCount="上传的文件个数已经达到最大，不能上传更多的文件。",n.uploadFileBiggerThanMaxSize="上传的文件 {0} 的大小超出了限制, 最大上传文件的大小为 {1} MB。",n.uploadFileNotMatchExtension="上传的文件 {0} 的类型不正确。",n.ExprotToExcelCalFormulaError="导出Excel文件的文件名，被您设置成了一个错误的值。",n.ExprotToPDFCalFormulaError="导出PDF文件的文件名，被您设置成了一个错误的值。",n.ExportListviewNoColumnError="表格中没有要导出的列。",n.AutoGeneratedID_Conflict_Error="自增编号已存在。请重新提交数据。",n.AutoGeneratedID_Generate_Error="自增编号的顺序号长度超过设置长度。",n.AutoGeneratedID_Conflict_Listview_Error="字段'{0}'的数据已存在。",n.NoMatchBetweenExcelWithListViewError="要导入的Excel和页面上的表格不匹配。在Excel模板中找不到匹配的列名：{0}",n.InCorrectFileFormatError="文件格式不正确。",n.NoSelectedRowError="请至少选择一行",n.ImportExcelCannotFindListViewError="找不到表格'{0}'。",n.GUID_Creator="创建者",n.GUID_CreateDate="创建日期",n.GUID_LastModifyBy="最后更新者",n.GUID_LastModifyDate="最后更新日期",n.GUID_AssignTo="担当者",n.GUID_Status="状态",n.UpdateListviewCommand_Listview_Group="不能提交包含统计列的表格。",n.UpdateListviewCommand_Listview_DetailListview="不能提交没有主表当前行信息的从表。",n.ImportExcelFirstRowMissDataError="Excel文件中的第一行数据不能为空。",n.ImportExcelToListViewError_Detail="Excel文件中第'{0}'行，列名为'{1}'的值不合法。错误信息：{2}",n.ImportExcelToListViewError_ExistSameKeys="Excel文件中基准列存在相同数据，请确保基准列的数据唯一。\r\n重复值如下所示:\r\n{0}",n.UpdateViewFail_Error="更新失败。 \r\n当前视图不能更新。",n.UpdateListViewFail_BindingTableCantEditError="更新失败。 \r\n当前绑定的数据源不能更新。",n.ConcurrentLicenseError_Kickoffed="您已经被管理员强制登出。",n.ConcurrentLicenseError_NoEnoughLicense="访问被拒绝。并发用户访问数量达到最大值，如有疑问请联系管理员。",n.ConcurrentLicenseError_SendEmail="发送邮件",n.ConcurrentLicenseError_Cancel="不发送",n.ConcurrentLicenseError_MessagePlaceHolder="邮件内容",n.ConcurrentLicenseError_AddressPlaceHolder="请填写发件人地址",n.ConcurrentLicenseError_SendSuccess="发送成功",n.ConcurrentLicenseError_SendFailed="发送失败",n.ConcurrentLicenseError_EmailTitle="访问被拒绝",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="请填写合法的邮箱",n.ConcurrentLicenseError_SenderAddress="发件人",n.ContainerCellType_Error_CircularReference="子页面'{0}'加载失败，存在循环引用。",n.NameConflict="名称'{0}'出现冲突，分别位于页面'{1}'和页面'{2}'",n.ContainerCellType_Error_NoExistedPage="页面'{0}'不存在。",n.SetCurrentRow_Error_NoRecord="设置表'{0}'的当前行失败，没有符合条件的记录。",n.ListViewAddNewRowError_CantConvertToNumber="不能转换成数字类型。",n.ListViewAddNewRowError_CantConvertToBool="不能转换成是否类型。",n.ListViewAddNewRowError_CantConvertToDateTime="不能转换成日期或时间类型。",n.CallStoredProcedureCommand_ExecuteFailed="存储过程执行失败。",n.Command_postFail_ErrorMessage="命令执行失败。",n.Commit_FailMessage="提交失败。",n.Commit_ExecutingMessage="您已经点过一次了，休息一下...",n.LongTimeNoOperation="由于您长时间没有操作页面，连接已经断开，如需继续使用请刷新页面。",n.PleaseClickButtonToReload="点击按钮重新加载本页面",n.ReloadPage="重新加载页面",n.DateTime_Calender_HeaderFormat="yyy年M月",n.DateTime_Calender_YearMonthFormat="yyyy年,M月",n.UnauthorizedUpload="不允许匿名操作。你需要登录。",n.SessionTimeout="会话过期， 请重新登录",n.ExprotActiveReportsCalFormulaError="导出报表的文件名被您设置成了一个错误的值。",n.ActiveReportsParameterValueCalFormulaError="报表的参数值被您设置成了一个错误的值。",n.NameConflictWarning="名称'{0}'同时在单元格名称和变量中存在,单元格的值将会被使用",n.StartExecuteCommand="执行命令:",n.StartExecutePageLoadCommand="执行‘{0}’页面加载命令",n.StartExecuteCellClickCommand="执行点击命令 {0}",n.StartExecuteCellValudeChangedCommand="执行值变更命令 {0}",n.UseTime="用时: {0} 毫秒",n.DataValidationNotPassed="数据校验未通过，取消执行命令",n.PopupCloseButton="弹出框关闭按钮",n.CommandName_ClosePopupCommand="关闭弹出页面",n.Log_NavigateCommand_PassValues="传值到目标页面",n.CreateCommandContextVariables="[创建命令上下文变量]",n.ServerCommandLog_CreateParam="创建变量 {0} = {1}",n.LeaveSiteConfirm="页面上可能包含未提交的数据，确认离开吗？",n.LeaveSiteConsoleMessage_Cell="单元格({0})",n.LeaveSiteConsoleMessage_Cell_DefaultValue="默认值: {0} ",n.LeaveSiteConsoleMessage_Cell_CurrentValue="当前值: {0}",n.LeaveSiteConsoleMessage_Listview="表格({0})",n.CantFindParam="找不到名称为‘{0}’的变量或参数",n.TriggerByCommand="由[{0}]触发",n.ExportPageToExcelCommand_PageNameTooLong="导出页面的名称长度不能超过31。",n.ExportListviewToExcelCommand_PageNameTooLong="导出表格所在页面的名称长度不能超过31。",n.BPM_LogText_CommitTitle="开始执行[提交]操作。",n.BPM_LogText_TerminateTitle="开始执行[终止]操作。",n.BPM_LogText_RollbackTitle="开始执行[回退]操作。",n.BPM_LogText_DispatchTitle="开始执行[调度]操作。",n.BPM_LogText_DelegateTitle="开始执行[委托]操作。",n.BPM_LogText_CancelDelegateTitle="开始执行[取消委托]操作。",n.BPM_LogText_AddOnSignTitle="开始执行[加签]操作。",n.BPM_LogText_CarbonCopyTitle="开始执行[抄送]操作。",n.BPM_LogText_ReadCarbonCopyTitle="开始执行[标记为已读]操作。",n.BPM_LogText_SaveBussinessData="保存业务数据: ",n.BPM_LogText_SaveBussinessDataCommand="[执行保存业务数据命令]",n.BPM_LogText_ExecutePreCommands="[执行前置命令]",n.BPM_LogText_ExecutePostCommands="[执行后置命令]",n.BPM_LogText_ExecuteTaskNodeAction="执行流程节点操作[{0}],任务 ID：[{1}]",n.BPM_LogText_CallStartProcessCommand_ByDefinitionID="调用发起流程命令，流程定义ID：[{0}]，流程实例标题：{1}",n.BPM_LogText_CallStartProcessCommand_ByName="调用发起流程命令，流程定义名称：[{0}]，流程实例标题：{1}",n.BPM_UserSetting_UnnamedNode="<未命名节点>",n.BPM_AssigneesRow_SelectByUser_Placeholder="请选择用户",n.BPM_Error_AssigneesTarget_TypeIsNotExist="分配策略类型不正确",n.CurrentRow_NotExist="当前行数据为空，请检查流程发起命令",n.RowMode_NotExist="当前行模式不存在，请检查流程发起命令",n.ProcessInstanceName_EvaluteError="流程实例名称解析失败，请检查配置是否合法",n.ProcessDefinitionId_EvaluteError="流程定义ID解析失败，请检查配置是否合法",n.ProcessPanelCellType_UnnamedAction="<未命名动作>",n.ProcessPanelCellType_UnnamedNode="<未命名节点>",n.ProcessPanelCellType_GenerateBusinessKey_Error="当前数据库更新失败！",n.ProcessPanelCellType_UpdateCurrentRowsClosure_ConfirmText="您确定添加这条记录?",n.TaskActionDialog_CommentTextRow_Label="备注",n.TaskActionDialog_CommentTextRow_PlaceHolder="请输入备注信息",n.TaskActionDialog_AssigneesRow_AssginToLabel="负责人",n.TaskActionDialog_AssigneesRow_DelegateToLabel="代理人",n.TaskActionDialog_AssigneesRow_AddOnSignToLabel="审批人",n.TaskActionDialog_AssigneesRow_CarbonCopyToLabel="抄送人",n.TaskActionDialog_AssigneesRow_AddOnSignTypeLabel="模式",n.TaskActionDialog_AssigneesRow_AddOnSignTypePre="增加审批环节，在我审批之前审批",n.TaskActionDialog_AssigneesRow_AddOnSignTypePost="在我审批之后，增加一个审批环节",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle="选择用户",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle_Mobile="查看已选择的用户({0} 人)",n.TaskActionDialog_AssigneesRow_Error_NoUserInfo="无可选用户，请联系管理员",n.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty="用户不能为空",n.UserSelectorDialog_SearchInput="搜索用户(用户名/全名/邮箱)",n.UserSelectorDialog_Selection_Title="已选择 {0} 人",n.UserSelectorDialog_Selection_IsMultiple="不限人数",n.UserSelectorDialog_Selection_NoMultiple="限制 1 人",n.UserSelectorDialog_TreeView_Title="组织部门",n.UserSelectorDialog_TreeView_NotOrganizedUser="无组织用户",n.UserSelectorDialog_UserList_Title="可选用户",n.UserSelectorDialog_DeleteList_Title="删除已选择用户",n.UserSelectorDialog_DeleteListTip_Text="你确定删除 {0} 用户吗？",n.CreateDelegateDialog_Title="新建委托",n.CreateDelegateDialog_Tip="在委托时间内，委托的流程任务会转交给代理人进行办理。",n.CreateDelegateDialog_DelegatedTime_Title="委托时间",n.CreateDelegateDialog_DelegatedTime_StartTime="开始时间:",n.CreateDelegateDialog_DelegatedTime_EndTime="结束时间:",n.CreateDelegateDialog_DelegatedTime_Error_EndTimeMustEarilerStartTime="结束时间不能早于或等于开始时间",n.CreateDelegateDialog_Agent_Title="代理人",n.CreateDelegateDialog_Agent_Tip="* 按顺序查找第一个有效的代理人，比如第一个人被删除，那会按顺序查找第二个人，依次类推。",n.CreateDelegateDialog_Agent_SelectAgent="添加代理人",n.CreateDelegateDialog_Agent_DeleteAgent="删除",n.CreateDelegateDialog_Agent_Error_AgentCannotBeEmpty="代理人不能为空",n.CreateDelegateDialog_DelegatedProcess_Title="委托流程",n.CreateDelegateDialog_DelegatedProcess_Tip="* “全部流程”是应用于目前所有的流程以及后续新加的流程。“选择流程”只应用于所选择的流程。",n.CreateDelegateDialog_DelegatedProcess_Type="委托流程:",n.CreateDelegateDialog_DelegatedProcess_AllProcesses="全部流程",n.CreateDelegateDialog_DelegatedProcess_SelectProcesses="选择流程",n.CreateDelegateDialog_DelegatedProcess_Error_ProcessCannotBeEmpty="流程不能为空",n.CreateDelegateDialog_ProcessTable_Title="标题",n.CreateDelegateDialog_ProcessTable_Description="描述",n.CreateDelegateDialog_Description_Title="委托备注",n.CreateDelegateDialog_Description_Placeholder="请输入委托备注",n.DelegationListDialog_Title="委托代理",n.DelegationListDialog_CreateDelegation="新建委托",n.DelegationListDialog_Table_AllProcesses="全部流程",n.DelegationListDialog_Table_EmptyTime="无",n.DelegationListDialog_Table_DataColumn_Agent="代理人",n.DelegationListDialog_Table_DataColumn_DelegatedProcess="委托流程",n.DelegationListDialog_Table_DataColumn_StartTime="开始时间",n.DelegationListDialog_Table_DataColumn_EndTime="结束时间",n.DelegationListDialog_Table_DataColumn_CreateDate="创建时间",n.DelegationListDialog_Table_DataColumn_Description="备注",n.DelegationListDialog_Table_DataColumn_Update="更新",n.DelegationListDialog_Table_DataColumn_Delete="删除",n.DelegationListDialog_Table_DataColumn_Enable="启用",n.DelegationListDialog_Table_DataColumn_Disable="禁用",n.DelegationListDialog_Error_DelegationConfigurationIsEmpty="委托配置不存在",n.DelegationListDialog_Comfirm_EnabledConfuguration="确定启用委托吗？",n.DelegationListDialog_Comfirm_DisabledConfuguration="确定禁用委托吗？",n.DelegationListDialog_Comfirm_DeleteConfuguration="确定删除委托吗？",n.CreateDelegateDialog_User_NotExist="不存在",n.CreateDelegateDialog_User_Disabled="已禁用",n.CreateDelegateDialog_Process_NotExist="不存在",n.UpdateDelegateDialog_Title="更新委托",n.UI_Table_ActionColumn="操作",n.ForguncyUserAvator_UserName="用户名",n.ForguncyUserAvator_FullName="全名",n.ForguncyUserAvator_Email="电子邮箱",n.NotificationUnauthorized="订阅服务端通知失败，可能是因为权限不足。",n.NotificationLocationString="执行消息通知命令",n}();n._CNStringResource=i;r=function(){function n(){}return n.Culture="JA",n.NeedChangeOriginPassword="The current password is the initial password, please modify your initial password for security.",n.PasswordNotChange="The new password cannot be the same as the old password.",n.UserNameOrPasswordIsIncorrect="ユーザー名、またはパスワードが正しくありません。",n.PasswordIsNotSame="パスワードが一致していません。",n.ForSafetyReasonPleaseChangeYourPassword="ログインしました。セキュリティ強化のため、初期パスワードを変更してください。",n.TokenIsInvalid="トークンが不正です。",n.ResetPasswordSuccess="パスワードがリセットされました。",n.Failed="失敗",n.UserName="ユーザー名",n.None="＜なし＞",n.deleteStr="削除",n.addStr="添付",n.listviewNotExisted="リストビューは存在しません。",n.FullName="氏名",n.Email="メールアドレス",n.Role="ロール",n.OrganizationSuperior="上位組織のメンバー",n.Success="成功しました。",n.ConfirmDelete="本当に削除してもよろしいですか？",n.Year="年",n.Month="月",n.Day="日",n.Quarter="四半期",n.noFieldErrorInfo="「{0}」テーブルを更新するために必要なデータ連結設定がありません。",n.unique="その値は既に存在します。異なる値を入力してください。",n.login="ログイン",n.cantAddEmptyFile="空のファイルをアップロードすることはできません。",n.Boolean_True="はい",n.Boolean_False="いいえ",n.MonthNames=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],n.ColumnFilter_YearName="年",n.ColumnFilter_DayName="日",n.ContextMenu_CompareType_Equals="指定の値に等しい",n.ContextMenu_CompareType_DoesNotEqual="指定の値に等しくない",n.ContextMenu_CompareType_BeginsWith="指定値から始まる",n.ContextMenu_CompareType_DoesNotBeginWith="指定値から始まらない",n.ContextMenu_CompareType_EndsWith="指定値で終わる",n.ContextMenu_CompareType_DoesNotEndWidth="指定値で終わらない",n.ContextMenu_CompareType_Contains="指定値を含む",n.ContextMenu_CompareType_DoesNotContain="指定値を含まない",n.ContextMenu_CompareType_IsGreaterThan="指定の値より大きい",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="指定の値以上",n.ContextMenu_CompareType_IsLessThan="指定の値より小さい",n.ContextMenu_CompareType_IsLessThanOrEqualTo="指定の値以下",n.ContextMenu_CompareType_IsBetween="指定の範囲内",n.ContextMenu_CompareType_IsNotBetween="指定値の間以外",n.ContextMenu_CompareType_In="指定したリストに含まれる",n.ContextMenu_CompareType_NotIn="指定したリストに含まれない",n.ContextMenu_CompareType_IsLessThan_Date="指定の値より前",n.ContextMenu_CompareType_IsGreaterThan_Date="指定の値より後",n.ComboBox_CompareType_Equals="と等しい",n.ComboBox_CompareType_DoesNotEqual="と等しくない",n.ComboBox_CompareType_BeginsWith="で始まる",n.ComboBox_CompareType_DoesNotBeginWith="で始まらない",n.ComboBox_CompareType_EndsWith="で終わる",n.ComboBox_CompareType_DoesNotEndWidth="で終わらない",n.ComboBox_CompareType_Contains="を含む",n.ComboBox_CompareType_DoesNotContain="を含まない",n.ComboBox_CompareType_IsGreaterThan="より大きい",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="以上",n.ComboBox_CompareType_IsLessThan="より小さい",n.ComboBox_CompareType_IsLessThanOrEqualTo="以下",n.ComboBox_CompareType_IsBetween="の間",n.ComboBox_CompareType_IsNotBetween="の間以外",n.ComboBox_CompareType_In="のリストに含まれる",n.ComboBox_CompareType_NotIn="のリストに含まれない",n.ComboBox_CompareType_IsLessThan_Date="より前",n.ComboBox_CompareType_IsGreaterThan_Date="より後",n.DateCompareType_Tomorrow="明日",n.DateCompareType_Today="今日",n.DateCompareType_Yesterday="昨日",n.DateCompareType_NextWeek="来週",n.DateCompareType_ThisWeek="今週",n.DateCompareType_LastWeek="先週",n.DateCompareType_NextMonth="来月",n.DateCompareType_ThisMonth="今月",n.DateCompareType_LastMonth="先月",n.DateCompareType_NextYear="来年",n.DateCompareType_ThisYear="今年",n.DateCompareType_LastYear="昨年",n.ForguncyUI_Dialog_OK="OK",n.ForguncyUI_Dialog_Cancel="キャンセル",n.ColumnFilter_Dialog_Title="フィルター",n.ColumnFilter_ContextMenu_SortAscending="昇順で並べ替え",n.ColumnFilter_ContextMenu_SortDesending="降順で並べ替え",n.ColumnFilter_ContextMenu_ClearFilter="フィルターをクリア",n.ColumnFilter_ContextMenu_Filter="フィルター",n.ColumnFilter_ContextMenu_CustomFilter="ユーザー設定フィルター",n.ColumnFilter_ContextMenu_NumberFilter="数値フィルター",n.ColumnFilter_ContextMenu_TextFilter="テキスト フィルター",n.ColumnFilter_ContextMenu_DateFilter="日付フィルター",n.ColumnFilter_TreeView_SelectAll="（すべて選択）",n.ColumnFilter_TreeView_Blanks="（空白）",n.ColumnFilter_TreeView_TooManyItems="一部のアイテムは表示されていません",n.ColumnFilter_TextBlock_And="と",n.ColumnFilter_TextBlock_Where="抽出条件の指定：",n.ColumnFilter_Alert_IncorrectValue="適切な値を入力してください。",n.ColumnFilter_TextBlock_TextExample_In="（例） りんご,バナナ,オレンジ （半角のカンマで区切る）",n.ColumnFilter_TextBlock_DateExample="（例） 2020/01/01",n.ColumnFilter_TextBlock_DateExample_Between="（例） 2020/01/01 と 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="（例） 10:00",n.ColumnFilter_TextBlock_TimeExample_Between="（例） 10:00 と 12:00",n.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage="（現在のページのみ）",n.ColumnOptionsCommand_Title="表示列のカスタマイズ",n.ColumnOptionsCommand_AvailableColumns="追加可能な列",n.ColumnOptionsCommand_SelectedColumns="表示列",n.ColumnOptionsCommand_UnamedColumn="＜列名なし＞",n.ColumnOptionsCommand_ResetSetting="初期状態に戻す",n.ColumnOptionsCommand_ConfirmResetSetting="本当に初期状態に戻してもよろしいですか？\r\nこの操作を行った場合、Webブラウザーが本ページを自動的に再読み込みします。",n.ColumnOptionsCommand_AddColumn="列の追加",n.ColumnOptionsCommand_RemoveColumn="列の削除",n.ColumnOptionsCommand_MoveColumnUp="1つ上へ移動",n.ColumnOptionsCommand_MoveColumnDown="1つ下へ移動",n.AttachmentCell_NotSupportedFile="サポートされていないファイル",n.CurrentUserCell_ChangeProfile="プロファイルの編集",n.CurrentUserCell_ChangePassword="パスワードの変更",n.CurrentUserCell_Logout="ログアウト",n.ChangeCurrentUserMFA_Enable="二要素認証の有効化",n.ChangeCurrentUserMFA_Disable="二要素認証の無効化",n.ChangeCurrentUserMFA_Enable_Confirm="本当に二要素認証を有効化してもよろしいですか？二要素認証の有効化にはモバイル端末への認証アプリのインストールが必要です。",n.ChangeCurrentUserMFA_Disable_Confirm="本当に二要素認証を無効化してもよろしいですか？［OK］ボタンをクリックするとページの再読み込みが行われます。",n.ChangeCurrentUserMFA_Enable_Fail="二要素認証を有効化できませんでした。",n.ChangeCurrentUserMFA_Disable_Fail="二要素認証を無効化できませんでした。",n.ProcessBarCell_AssignedToPopup_Title="現在の担当者",n.ProcessBarCell_AssignedTo="担当者",n.ProcessBarCell_AssignedTo_me="あなた",n.ProcessBarCell_AssignedToMultiUser="{0}と他{1}人",n.ProcessBarCell_HistoryPopup_Title="状態の履歴",n.ProcessBarCell_History_Operator="実行者",n.ProcessBarCell_History_Time="日時",n.ProcessBarCell_History_EndStatus="実行後の状態",n.ProcessBarCell_History_Comments="コメント",n.ProcessBarCell_History_ActionName="アクション名",n.ProcessBarCell_ActionPopup_Title="状態の更新",n.ProcessBarCell_ActionPopup_NextStatus="次の状態：",n.ProcessBarCell_ActionPopup_Assignto_Choose="次の担当者：",n.ProcessBarCell_ActionPopup_Assignto_All="次のアクションを実行可能なユーザー：",n.ProcessBarCell_ActionPopup_Comments="コメント：",n.ProcessBarCell_OK="OK",n.ProcessBarCell_Cancel="キャンセル",n.ProcessBarCell_Status="状態：{0}",n.ProcessBarCell_ChangeStateFailed="アクションの実行に失敗",n.ProcessBarCell_ChangeAssignee="担当者の変更",n.ProcessBarCell_CreateBy="作成者：{0}　作成日時：{1}",n.ProcessBarCell_LastModifyBy="最終更新者：{0}　最終更新日時：{1}",n.CannotFindCell="このページに '{0}' という名前のセルは存在しません",n.CannotFindCellById="'{0}' と等しいセルがこのページに見つかりません",n.CannotFindListview="このページに '{0}' という名前のリストビューは存在しません",n.CannotFindColumn="リストビュー '{1}' に '{0}' という名前の列は存在しません",n.CannotFindColumnIndex="リストビュー '{1}' の列インデックス '{0}' が不正です",n.NotSupportEventForPage="{1}のイベント '{0}' はサポートされていません",n.NotSupportEventForCellOrListview="{1} '{2}' のイベント '{0}' はサポートされていません",n.NotSupportSetValue="このメソッドはセル '{0}' でサポートされていません",n.InvalidNumberParam="パラメーター '{0}' に正しい数値を指定してください",n.IndexOutOfRange="パラメーター '{0}' に範囲外の値が指定されています",n.ForguncyApiExceptionString="{0} が {1}.{2} メソッド内で発生：{3}",n.InvalidFunctionParam="パラメーター '{0}' は関数オブジェクトを指定してください",n.HideShowColumns_CannotHideRowHeader="行ヘッダー列の表示、非表示を行うことはできません",n.HideShowColumns_ListviewIsEditing="編集中のリストビューに対して、列の表示、非表示を行うことはできません",n.HideShowColumns_CannotShowHiddenColumn="非表示の列（［非表示を無視する］設定が有効になっていない) と、設計時の列幅が0である列を表示させることはできません。",n.CannotFindCommandInCell="セル「{0}」に設定コマンドがありません",n.CannotUseCommandParameterInCurrentContext="現在のコンテキストでコマンドパラメータ（変数）にアクセスできません",n.CannotSelectCellInColumn="列ヘッダー、行ヘッダー、選択列、非表示になっているセルを選択することはできません。",n.WebApi_ErrorInfo_NonemptyStringParam="パラメーター '{0}' を空にすることはできません。",n.WebApi_ErrorInfo_ParamInvalid="パラメーター '{0}' が正しくありません。",n.groupCell_Other="その他：",n.ClosePopupCommand_NotPopup="このページはポップアップウィンドウとして表示されていないため、［ポップアップウィンドウの終了］を実行することができません。",n.Echart_DataLoadingText="データの読み込み中...",n.Echart_NoDataLoadingText="データなし",n.InvalidCopyPasteSize="コピーと貼り付けの範囲サイズが異なっています。",n.RangeOperationCannotInvolveTotalRow="セルの操作範囲として集計行の領域を含めることはできません。",n.ValidateErrorMessage="行：{1}、列：{2}の値「{0}」は有効な値ではありません。\r\nエラー内容：\r\n{3}",n.InvalidValueTypeMessage="値の型が不正です。",n.ValueNotInList="その値は項目リストに含まれていません。",n.ErrorInfo_Uncommited="未確定のデータが含まれているため、クエリー／並べ替え処理を行うことはできません。",n.DataValidation_Required="必須入力項目です。",n.DataValidation_WholeNumberDefaultErrorMessage="入力した値は正しくありません。",n.DataValidation_DecimalDefaultErrorMessage="入力した値は正しくありません。",n.DataValidation_DateDefaultErrorMessage="入力した値は正しくありません。",n.DataValidation_TimeDefaultErrorMessage="入力した値は正しくありません。",n.DataValidation_TextLenghtDefaultErrorMessage="入力した文字列の長さは正しくありません。",n.DataValidation_CustomDefaultErrorMessage="入力した値は正しくありません。",n.DataValidation_RegularUserInputDefaultErrorMessage="入力した値は正しくありません。",n.DataValidation_RegularDefaultErrorMessage="入力した値は「{0}」の値として正しくありません。",n.Validate_Number="有効な数値を入力してください。",n.InvalidValueErrorMessage="「{2}」テーブルの「{1}」フィールドに不正な値「{0}」を登録、または更新することはできません。",n.uploadFileBiggerThanMaxFileCount="アップロードされたファイルの数が上限に達しています。これ以上ファイルをアップロードすることはできません。",n.uploadFileBiggerThanMaxSize="アップロードされたファイル「{0}」のサイズが大きすぎます。アップロード可能なファイルの最大サイズは {1} MBです。",n.uploadFileNotMatchExtension="拡張子が「{0}」であるファイルをアップロードすることは許可されていません。",n.ExprotToExcelCalFormulaError="数式の実行結果が#N/Aエラーであるため、Excelファイルをエクスポートすることができません。",n.ExprotToPDFCalFormulaError="数式の実行結果が#N/Aエラーであるため、PDFファイルをエクスポートすることができません。",n.ExportListviewNoColumnError="エクスポートの対象となる列がありません。",n.AutoGeneratedID_Conflict_Error="自動採番により生成されたIDは既に使用されています。対象のセルには新しいIDが表示されます。再度データの登録処理を行ってください。",n.AutoGeneratedID_Generate_Error="自動採番で設定した数値の桁数を超える値が採番されようとしました。新しいデータを追加するためには、自動採番の数値の桁数を増やす必要があります。",n.AutoGeneratedID_Conflict_Listview_Error="フィールド「{0}」の値は既に存在します。",n.ImportExcelFirstRowMissDataError="インポートしようとしたExcelファイルの最初の行にデータが存在しません。",n.NoMatchBetweenExcelWithListViewError="インポートに指定されたExcelファイルに、対象のリストビューに一致するデータ構造がしません。Excelファイルに一致する列が見つかりません。:{0}",n.InCorrectFileFormatError="不正なファイル形式です。",n.NoSelectedRowError="少なくとも1つ以上の行を選択してください。",n.ImportExcelCannotFindListViewError="リストビュー「{0}」が見つかりません。",n.GUID_Creator="作成者",n.GUID_CreateDate="作成日時",n.GUID_LastModifyBy="最終更新者",n.GUID_LastModifyDate="最終更新日時",n.GUID_AssignTo="担当者",n.GUID_Status="状態",n.UpdateListviewCommand_Listview_Group="集計フィールドを含むリストビューを更新することはできません。",n.UpdateListviewCommand_Listview_DetailListview="マスターテーブルに合致するレコードが存在しない場合、詳細リストビューを更新することはできません。",n.ImportExcelToListViewError_Detail="Excelシートの {0} 行目、列「{1}」にある値が不正です。\r\nエラー内容：{2}",n.ImportExcelToListViewError_ExistSameKeys="インポートしようとしたExcelファイルの「一意となる列」に重複データがないかどうか確認してください。\r\n重複している値は以下の通りです。\r\n{0}",n.UpdateViewFail_Error="更新に失敗しました。 \r\n 現在のビューを更新できません。",n.UpdateListViewFail_BindingTableCantEditError="更新処理に失敗しました。現在データ連結されているデータソースは更新できません。",n.AddUserApiParamError="パラメータの型が正しくありません。",n.ConcurrentLicenseError_Kickoffed="管理者により強制切断されました。",n.ConcurrentLicenseError_NoEnoughLicense="同時接続数が最大数に達しているため、アクセスが拒否されました。しばらくたってから再度アクセスするか、管理者に問い合わせてください。［メールを送信］ボタンを押すことでAdministratorロールのメンバーにメールを送ることができます。",n.ConcurrentLicenseError_SendEmail="メールを送信",n.ConcurrentLicenseError_Cancel="キャンセル",n.ConcurrentLicenseError_MessagePlaceHolder="送信するメールの本文を入力してください。",n.ConcurrentLicenseError_AddressPlaceHolder="送信元とするメールアドレスを入力してください。",n.ConcurrentLicenseError_SendSuccess="メールの送信が完了しました。",n.ConcurrentLicenseError_SendFailed="メールの送信に失敗しました。",n.ConcurrentLicenseError_EmailTitle="［Forguncy Server］同時接続数不足によるアクセス拒否の通知",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="不正なメールアドレスが入力されています。",n.ConcurrentLicenseError_SenderAddress="送信元",n.ContainerCellType_Error_CircularReference="サブページ「{0}」が循環参照を行っているため、読み込みに失敗しました。",n.NameConflict="「{0}」という名前が競合しています。この名前はページ「{1}」とページ「{2}」の両方に存在します。",n.ContainerCellType_Error_NoExistedPage="ページ「{0}」が見つかりません。",n.SetCurrentRow_Error_NoRecord="テーブル「{0}」のカレントレコードの設定に失敗しました。指定されたクエリー条件に合致するレコードが存在しません。",n.ListViewAddNewRowError_CantConvertToNumber="数値型に変換できません。",n.ListViewAddNewRowError_CantConvertToBool="Yes/No型に変換できません。",n.ListViewAddNewRowError_CantConvertToDateTime="日付型、または時刻型に変換できません。",n.CallStoredProcedureCommand_ExecuteFailed="ストアドプロシージャーの実行に失敗しました。",n.Echart_BubbleChartToolTip="サイズ：{0}",n.Command_postFail_ErrorMessage="コマンドの実行に失敗しました。",n.Commit_FailMessage="データベースへの更新の反映に失敗しました。",n.Commit_ExecutingMessage="コマンドが実行中です。",n.LongTimeNoOperation="一定期間操作が行われなかったため、アプリケーションは切断されました。",n.PleaseClickButtonToReload="ボタンをクリックしてこのページを再読み込みします。",n.ReloadPage="ページの再読み込み",n.DateTime_Calender_HeaderFormat="yyy年M月",n.DateTime_Calender_YearMonthFormat="yyyy年,M月",n.UnauthorizedUpload="匿名ユーザーによるアクセスは許可されていません。 ログインが必要です。",n.SessionTimeout="セッションがタイムアウトしました。再度ログインしてください。",n.NameConflictWarning="セル名と変数名の両方に「{0}」という名前が存在していますが、セルの値が使用されます。",n.ExprotActiveReportsCalFormulaError="エクスポートされたレポートのファイル名に不正な値が設定されています。",n.ActiveReportsParameterValueCalFormulaError="レポートのパラメータに不正な値が設定されています。",n.StartExecuteCommand="コマンドの実行：",n.StartExecutePageLoadCommand="ページロード時のコマンド「{0}」を実行",n.StartExecuteCellClickCommand="クリック時のコマンド「{0}」を実行",n.StartExecuteCellValudeChangedCommand="値変更時のコマンド「{0}」を実行",n.UseTime="経過時間：{0}ミリ秒",n.DataValidationNotPassed="データの入力規則違反のため、コマンドはキャンセルされました",n.PopupCloseButton="ポップアップウィンドウの閉じるボタン",n.CommandName_ClosePopupCommand="ポップアップウィンドウの終了",n.Log_NavigateCommand_PassValues="遷移先ページへの値の受け渡し",n.CreateCommandContextVariables="[Create command context's variables]",n.ServerCommandLog_CreateParam="パラーメーターの作成： {0} = {1}",n.LeaveSiteConfirm="行った変更が保存されない可能性があります。本当にこのページから離れてもよろしいですか？",n.LeaveSiteConsoleMessage_Cell="セル（{0}）",n.LeaveSiteConsoleMessage_Cell_DefaultValue="既定値：{0}",n.LeaveSiteConsoleMessage_Cell_CurrentValue="現在の値：{0}",n.LeaveSiteConsoleMessage_Listview="リストビュー（{0}）",n.CantFindParam="パラメーターが見つかりません：{0}",n.TriggerByCommand="Trigger by command {0}",n.ExportPageToExcelCommand_PageNameTooLong="The name of exported page cannot exceed 31.",n.ExportListviewToExcelCommand_PageNameTooLong="The name of page where the listview resides cannot exceed 31.",n.BPM_LogText_CommitTitle="start execute commit operation.",n.BPM_LogText_TerminateTitle="start execute terminate operation.",n.BPM_LogText_RollbackTitle="start execute rollback operation.",n.BPM_LogText_DispatchTitle="start execute dispatch operation.",n.BPM_LogText_DelegateTitle="start execute delegate operation.",n.BPM_LogText_CancelDelegateTitle="start execute cancel delegate operation.",n.BPM_LogText_AddOnSignTitle="start execute addon sign operation.",n.BPM_LogText_CarbonCopyTitle="start execute carbon copy operation.",n.BPM_LogText_ReadCarbonCopyTitle="start execute read carbon copy operation.",n.BPM_LogText_SaveBussinessData="Save business data: ",n.BPM_LogText_SaveBussinessDataCommand="[Excute save business data command]",n.BPM_LogText_ExecutePreCommands="[Execute pre commands]",n.BPM_LogText_ExecutePostCommands="[Execute post commands]",n.BPM_LogText_ExecuteTaskNodeAction="Execute task action [{0}], Task ID: [{1}]",n.BPM_LogText_CallStartProcessCommand_ByDefinitionID="Call ProcessStartCommand, ProcessDefinitionID: [{0}], Process Instance Name: {1}",n.BPM_LogText_CallStartProcessCommand_ByName="Call ProcessStartCommand, Process Name: [{0}], Process Instance Name: {1}",n.BPM_UserSetting_UnnamedNode="<Unnamed Node>",n.BPM_AssigneesRow_SelectByUser_Placeholder="Please select assignee",n.BPM_Error_AssigneesTarget_TypeIsNotExist="AssigneesTarget's type is not exist",n.CurrentRow_NotExist="current row is not exist, check the process start command please",n.RowMode_NotExist="the selected row mode is not exist, check the process start command please",n.ProcessInstanceName_EvaluteError="the process instance name evaluate failed, check the cell setting please",n.ProcessDefinitionId_EvaluteError="The evaluation for the process definition id failed. Check the cell settings.",n.ProcessPanelCellType_UnnamedAction="<Unnamed Action>",n.ProcessPanelCellType_UnnamedNode="<Unnamed Node>",n.ProcessPanelCellType_GenerateBusinessKey_Error="The current database update failed",n.ProcessPanelCellType_UpdateCurrentRowsClosure_ConfirmText="You are sure to add this record?",n.TaskActionDialog_CommentTextRow_Label="Comment",n.TaskActionDialog_CommentTextRow_PlaceHolder="please enter the comment",n.TaskActionDialog_AssigneesRow_AssginToLabel="AssignTo",n.TaskActionDialog_AssigneesRow_DelegateToLabel="DelegateTo",n.TaskActionDialog_AssigneesRow_AddOnSignToLabel="AddOnSignTo",n.TaskActionDialog_AssigneesRow_CarbonCopyToLabel="CarbonCopyTo",n.TaskActionDialog_AssigneesRow_AddOnSignTypeLabel="Type",n.TaskActionDialog_AssigneesRow_AddOnSignTypePre="PreAddOnSign,add an approval step before current step",n.TaskActionDialog_AssigneesRow_AddOnSignTypePost="PostAddOnSign, add an approval step after current step",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle="Select User",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle_Mobile="Show the selected users ({0} users)",n.TaskActionDialog_AssigneesRow_Error_NoUserInfo="No optional users, contact your administrator",n.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty="The user(s) cannot be empty",n.UserSelectorDialog_SearchInput="Search User(UserName/FullName/Email)",n.UserSelectorDialog_Selection_Title="Selected {0} Users",n.UserSelectorDialog_Selection_IsMultiple="Unlimited",n.UserSelectorDialog_Selection_NoMultiple="Limited to 1 person",n.UserSelectorDialog_TreeView_Title="Organizational Departments",n.UserSelectorDialog_TreeView_NotOrganizedUser="Not Organized Users",n.UserSelectorDialog_UserList_Title="Optional user",n.UserSelectorDialog_DeleteList_Title="Delete selected user(s)",n.UserSelectorDialog_DeleteListTip_Text="Are you sure delete {0} users?",n.CreateDelegateDialog_Title="Create Delegate",n.CreateDelegateDialog_Tip="During the delegation time, the delegation process tasks will be transferred to the agent for handling.",n.CreateDelegateDialog_DelegatedTime_Title="Time",n.CreateDelegateDialog_DelegatedTime_StartTime="Start Time:",n.CreateDelegateDialog_DelegatedTime_EndTime="End Time:",n.CreateDelegateDialog_DelegatedTime_Error_EndTimeMustEarilerStartTime="End time cannot be earlier than or equal to start time.",n.CreateDelegateDialog_Agent_Title="Agent",n.CreateDelegateDialog_Agent_Tip="* Find the first valid agent in order, if the first person is deleted, it will find the second person in order, and so on.",n.CreateDelegateDialog_Agent_SelectAgent="Select Agent",n.CreateDelegateDialog_Agent_DeleteAgent="Delete",n.CreateDelegateDialog_Agent_Error_AgentCannotBeEmpty="Agent cannot be empty",n.CreateDelegateDialog_DelegatedProcess_Title="Process",n.CreateDelegateDialog_DelegatedProcess_Tip="* 'All' are applied to all current and subsequent new processes. 'Select' only be applied to the selected processes. ",n.CreateDelegateDialog_DelegatedProcess_Type="Delegation Process:",n.CreateDelegateDialog_DelegatedProcess_AllProcesses="All Processes",n.CreateDelegateDialog_DelegatedProcess_SelectProcesses="Select Processes",n.CreateDelegateDialog_DelegatedProcess_Error_ProcessCannotBeEmpty="Process cannot be empty",n.CreateDelegateDialog_ProcessTable_Title="Title",n.CreateDelegateDialog_ProcessTable_Description="Description",n.CreateDelegateDialog_Description_Title="Description",n.CreateDelegateDialog_Description_Placeholder="Please enter description",n.DelegationListDialog_Title="Delegate Setting",n.DelegationListDialog_CreateDelegation="Create Delegate",n.DelegationListDialog_Table_AllProcesses="All Processes",n.DelegationListDialog_Table_EmptyTime="Empty",n.DelegationListDialog_Table_DataColumn_Agent="Agent(s)",n.DelegationListDialog_Table_DataColumn_DelegatedProcess="Process(es)",n.DelegationListDialog_Table_DataColumn_StartTime="Start Time",n.DelegationListDialog_Table_DataColumn_EndTime="End Time",n.DelegationListDialog_Table_DataColumn_CreateDate="Create Time",n.DelegationListDialog_Table_DataColumn_Description="Description",n.DelegationListDialog_Table_DataColumn_Update="Update",n.DelegationListDialog_Table_DataColumn_Delete="Delete",n.DelegationListDialog_Table_DataColumn_Enable="Enable",n.DelegationListDialog_Table_DataColumn_Disable="Disable",n.DelegationListDialog_Error_DelegationConfigurationIsEmpty="Delegation Configuration does not exist.",n.DelegationListDialog_Comfirm_EnabledConfuguration="Sure to enable delegate?",n.DelegationListDialog_Comfirm_DisabledConfuguration="Sure to disable delegate?",n.DelegationListDialog_Comfirm_DeleteConfuguration="Sure to delete delegate?",n.CreateDelegateDialog_User_NotExist="Inexistent",n.CreateDelegateDialog_User_Disabled="Disabled",n.CreateDelegateDialog_Process_NotExist="Inexistent",n.UpdateDelegateDialog_Title="Update Delegate",n.UI_Table_ActionColumn="Action(s)",n.ForguncyUserAvator_UserName="UserName",n.ForguncyUserAvator_FullName="FullName",n.ForguncyUserAvator_Email="Email",n.NotificationUnauthorized="Subscribe Server Notification failed, Maybe user is unauthorized.",n.NotificationLocationString="execute notification command",n}();n._JAStringResource=r;u=function(){function n(){}return n.Culture="KR",n.NeedChangeOriginPassword="현재 비밀번호는 초기 비밀번호이므로 보안을 위해 초기 비밀번호를 수정해주세요.",n.PasswordNotChange="새 암호는 이전 암호와 같을 수 없습니다.",n.UserNameOrPasswordIsIncorrect="사용자 이름 또는 암호가 올바르지 않습니다.",n.PasswordIsNotSame="암호가 동일하지 않습니다.",n.ForSafetyReasonPleaseChangeYourPassword="성공적으로 로그인하셨습니다. 이후 보안 유지를 위해 암호를 변경해 주십시오.",n.TokenIsInvalid="토큰이 잘못되었습니다.",n.ResetPasswordSuccess="암호 재설정 성공!",n.Failed="실패",n.UserName="사용자 이름",n.None="<없음>",n.deleteStr="삭제",n.addStr="추가",n.listviewNotExisted="리스트뷰가 없습니다.",n.FullName="전체 이름",n.Email="이메일",n.Role="역할",n.OrganizationSuperior="조직 관리자",n.Success="성공!",n.ConfirmDelete="삭제하시겠습니까?",n.Year="년",n.Month="월",n.Day="일",n.Quarter="분기",n.noFieldErrorInfo="{0} 표에 대한 필드가 없습니다.",n.unique="값이 존재합니다. 다른 값을 입력하십시오.",n.login="로그인",n.cantAddEmptyFile="빈 파일을 업로드할 수 없습니다.",n.Boolean_True="예",n.Boolean_False="아니오",n.MonthNames=["1월","2월","3월","4월","6월","7월","8월","9월","10월","11월","12월"],n.ColumnFilter_YearName="년",n.ColumnFilter_DayName="일",n.ContextMenu_CompareType_Equals="같음",n.ContextMenu_CompareType_DoesNotEqual="같지 않음",n.ContextMenu_CompareType_BeginsWith="~로 시작",n.ContextMenu_CompareType_DoesNotBeginWith="~로 시작하지 않는",n.ContextMenu_CompareType_EndsWith="~로 끝남",n.ContextMenu_CompareType_DoesNotEndWidth="~로 끝나지 않는",n.ContextMenu_CompareType_Contains="포함",n.ContextMenu_CompareType_DoesNotContain="포함하지 않는",n.ContextMenu_CompareType_IsGreaterThan="~보다 큰",n.ContextMenu_CompareType_IsGreaterThanOrEqualTo="크거나 같은",n.ContextMenu_CompareType_IsLessThan="~보다 작은",n.ContextMenu_CompareType_IsLessThanOrEqualTo="작거나 같은",n.ContextMenu_CompareType_IsBetween="범위 내",n.ContextMenu_CompareType_IsNotBetween="범위 밖",n.ContextMenu_CompareType_In="안에",n.ContextMenu_CompareType_NotIn="밖에",n.ContextMenu_CompareType_IsLessThan_Date="이전",n.ContextMenu_CompareType_IsGreaterThan_Date="이후",n.ComboBox_CompareType_Equals="같음",n.ComboBox_CompareType_DoesNotEqual="같지 않음",n.ComboBox_CompareType_BeginsWith="~로 시작",n.ComboBox_CompareType_DoesNotBeginWith="~로 시작하지 않는",n.ComboBox_CompareType_EndsWith="~로 끝남",n.ComboBox_CompareType_DoesNotEndWidth="~로 끝나지 않는",n.ComboBox_CompareType_Contains="포함",n.ComboBox_CompareType_DoesNotContain="포함하지 않는",n.ComboBox_CompareType_IsGreaterThan="~보다 큰",n.ComboBox_CompareType_IsGreaterThanOrEqualTo="크거나 같은",n.ComboBox_CompareType_IsLessThan="~보다 작은",n.ComboBox_CompareType_IsLessThanOrEqualTo="작거나 같은",n.ComboBox_CompareType_IsBetween="범위 내",n.ComboBox_CompareType_IsNotBetween="범위 밖",n.ComboBox_CompareType_In="안에",n.ComboBox_CompareType_NotIn="밖에",n.ComboBox_CompareType_IsLessThan_Date="이전",n.ComboBox_CompareType_IsGreaterThan_Date="이후",n.DateCompareType_Tomorrow="내일",n.DateCompareType_Today="오늘",n.DateCompareType_Yesterday="어제",n.DateCompareType_NextWeek="다음주",n.DateCompareType_ThisWeek="이번주",n.DateCompareType_LastWeek="지난주",n.DateCompareType_NextMonth="다음달",n.DateCompareType_ThisMonth="이번달",n.DateCompareType_LastMonth="지난달",n.DateCompareType_NextYear="내년",n.DateCompareType_ThisYear="올해",n.DateCompareType_LastYear="작년",n.ForguncyUI_Dialog_OK="확인",n.ForguncyUI_Dialog_Cancel="취소",n.ColumnFilter_Dialog_Title="필터",n.ColumnFilter_ContextMenu_SortAscending="오름차순 정렬",n.ColumnFilter_ContextMenu_SortDesending="내림차순 정렬",n.ColumnFilter_ContextMenu_ClearFilter="필터 초기화",n.ColumnFilter_ContextMenu_Filter="필터",n.ColumnFilter_ContextMenu_CustomFilter="사용자정의 필터",n.ColumnFilter_ContextMenu_NumberFilter="숫자 필터",n.ColumnFilter_ContextMenu_TextFilter="문자 필터",n.ColumnFilter_ContextMenu_DateFilter="날짜 필터",n.ColumnFilter_TreeView_SelectAll="(모두 선택)",n.ColumnFilter_TreeView_Blanks="(공백)",n.ColumnFilter_TreeView_TooManyItems="일부 항목 표시 안함",n.ColumnFilter_TextBlock_And="그리고",n.ColumnFilter_TextBlock_Where="항목 위치 표시:",n.ColumnFilter_Alert_IncorrectValue="입력한 값이 올바르지 않음!",n.ColumnFilter_TextBlock_TextExample_In="예) 사과,바나나,오렌지 (쉼표로 구분)",n.ColumnFilter_TextBlock_DateExample="예) 2019/01/01",n.ColumnFilter_TextBlock_DateExample_Between="예) 2019/01/01 부터 2019/12/31",n.ColumnFilter_TextBlock_TimeExample="예) 10:00",n.ColumnFilter_TextBlock_TimeExample_Between="예) 10:00 부터 12:00",n.ColumnFilter_ContextMenu_Suffix_OnlyCurrentPage="(현재 페이지에만 적용)",n.ColumnOptionsCommand_Title="열(Column) 옵션",n.ColumnOptionsCommand_AvailableColumns="사용가능한 열:",n.ColumnOptionsCommand_SelectedColumns="선택된 열:",n.ColumnOptionsCommand_UnamedColumn="<이름없는열>",n.ColumnOptionsCommand_ResetSetting="설정 초기화",n.ColumnOptionsCommand_ConfirmResetSetting="설정을 재설정 하시겠습니까? \r\n 브라우저가 즉시 새로고침됩니다.",n.ColumnOptionsCommand_AddColumn="열 추가",n.ColumnOptionsCommand_RemoveColumn="열 제거",n.ColumnOptionsCommand_MoveColumnUp="위로 열 이동 ",n.ColumnOptionsCommand_MoveColumnDown="아래로 열 이동",n.AttachmentCell_NotSupportedFile="지원하지 않는 파일입니다",n.CurrentUserCell_ChangeProfile="프로필 변경",n.CurrentUserCell_ChangePassword="암호 변경",n.CurrentUserCell_Logout="로그아웃",n.ChangeCurrentUserMFA_Enable="2단계 인증 활성화",n.ChangeCurrentUserMFA_Disable="2단계 인증 비활성화",n.ChangeCurrentUserMFA_Enable_Confirm="2단계 인증을 활성화하시겠습니까? 활성화하신 후 설정 확인을 위해 다시 로그인하셔야 합니다.",n.ChangeCurrentUserMFA_Disable_Confirm="2단계 인증을 비활성화하시겠습니까? 비활성화 하시면 현재 페이지는 새로고침됩니다.",n.ChangeCurrentUserMFA_Enable_Fail="2단계 인증 활성화 중 문제가 발생했습니다.",n.ChangeCurrentUserMFA_Disable_Fail="2단계 인증 비활성화 중 문제가 발생했습니다.",n.ProcessBarCell_AssignedToPopup_Title="현재 담당자",n.ProcessBarCell_AssignedTo="담당자",n.ProcessBarCell_AssignedTo_me="본인",n.ProcessBarCell_AssignedToMultiUser="{0} 및 {1} 등",n.ProcessBarCell_HistoryPopup_Title="상태 내역",n.ProcessBarCell_History_Operator="운영자",n.ProcessBarCell_History_Time="시간",n.ProcessBarCell_History_EndStatus="종료 상태",n.ProcessBarCell_History_Comments="메모",n.ProcessBarCell_History_ActionName="작업 이름",n.ProcessBarCell_ActionPopup_Title="상태 업데이트",n.ProcessBarCell_ActionPopup_NextStatus="다음 상태:",n.ProcessBarCell_ActionPopup_Assignto_Choose="담당자 선택:",n.ProcessBarCell_ActionPopup_Assignto_All="다음 상태의 담당자:",n.ProcessBarCell_ActionPopup_Comments="메모:",n.ProcessBarCell_OK="확인",n.ProcessBarCell_Cancel="취소",n.ProcessBarCell_Status="상태: {0}",n.ProcessBarCell_ChangeStateFailed="작업 실행 실패(_E)",n.ProcessBarCell_ChangeAssignee="담당자 변경",n.ProcessBarCell_CreateBy="{1}에 {0}이(가) 만듦",n.ProcessBarCell_LastModifyBy="{1}에 {0}이(가) 마지막으로 수정함",n.CannotFindCell="이 페이지에서 이름이 '{0}'인 셀을 찾을 수 없습니다",n.CannotFindCellById="이 페이지에서 ID가 '{0}'과(와) 같은 셀을 찾을 수 없습니다",n.CannotFindListview="이 페이지에서 이름이 '{0}'인 리스트뷰를 찾을 수 없습니다.",n.CannotFindColumn="'{1}' 리스트뷰에서 이름이 '{0}'인 열을 찾을 수 없습니다",n.CannotFindColumnIndex="'{1}' 리스트뷰의 열 인덱스 '{0}'이(가) 잘못되었습니다",n.NotSupportEventForPage="{1}에 대해 '{0}' 이벤트를 지원하지 않습니다.",n.NotSupportEventForCellOrListview="{1} '{2}'에 대해 '{0}' 이벤트를 지원하지 않습니다",n.NotSupportSetValue="이 메서드는 셀 '{0}'에 지원되지 않습니다",n.InvalidNumberParam="'{0}' 매개 변수에 대해 유효한 숫자를 제공하십시오",n.IndexOutOfRange="'{0}' 매개 변수가 범위를 벗어났습니다",n.ForguncyApiExceptionString="{1}.{2} 메서드의 {0}: {3}",n.InvalidFunctionParam="'{0}' 매개 변수는 함수여야 합니다",n.HideShowColumns_CannotHideRowHeader="행 헤더는 감추기/보이기 하실 수 없습니다",n.HideShowColumns_ListviewIsEditing="리스트뷰가 수정 모드일 때는 열을 감추기/보이기 하실 수 없습니다",n.HideShowColumns_CannotShowHiddenColumn="감추기 옵션이 선택되지 않은 감추어진 열 혹은 너비가 0인 열을 표시할 수 없습니다",n.CannotFindCommandInCell="현재 페이지의 셀 {0}에서 명령을 찾을 수 없습니다",n.CannotUseCommandParameterInCurrentContext="현재 상황에서는 매개 변수가 있는 명령을 사용하실 수 없습니다",n.CannotSelectCellInColumn="Can't select cell in column row header column, selected column and invisible columns",n.WebApi_ErrorInfo_NonemptyStringParam="'{0}' 매개 변수는 비어 있지 않은 문자열이어야 합니다.",n.WebApi_ErrorInfo_ParamInvalid="'{0}' 매개 변수가 올바르지 않습니다.",n.groupCell_Other="기타:",n.ClosePopupCommand_NotPopup="현재 페이지는 팝업 페이지가 아닙니다.",n.AddUserApiParamError="매개 변수의 유형이 잘못되었습니다!",n.Echart_DataLoadingText="데이터 로드 중...",n.Echart_NoDataLoadingText="데이터 없음",n.InvalidCopyPasteSize="복사 영역과 붙여넣기 영역의 크기가 다릅니다.",n.RangeOperationCannotInvolveTotalRow="범위 연산하실 때 전체 열을 대상으로 하실 수 없습니다.",n.ValidateErrorMessage="행: {1}, 열: {2}의 '{0}' 값이 잘못되었습니다.\r\n오류 메시지:\r\n{3}",n.InvalidValueTypeMessage="잘못된 값 유형입니다.",n.ValueNotInList="값이 항목 목록에 포함되어 있지 않습니다.",n.ErrorInfo_Uncommited="커밋되지 않은 데이터를 포함합니다.",n.DataValidation_Required="필수",n.DataValidation_WholeNumberDefaultErrorMessage="입력한 정수가 잘못되었습니다.",n.DataValidation_DecimalDefaultErrorMessage="입력한 10진수가 잘못되었습니다.",n.DataValidation_DateDefaultErrorMessage="입력한 날짜가 잘못되었습니다.",n.DataValidation_TimeDefaultErrorMessage="입력한 시간이 잘못되었습니다.",n.DataValidation_TextLenghtDefaultErrorMessage="입력한 값의 길이가 잘못되었습니다.",n.DataValidation_CustomDefaultErrorMessage="입력한 값이 수식과 일치하지 않습니다.",n.DataValidation_RegularUserInputDefaultErrorMessage="입력한 값이 정규식과 일치하지 않습니다.",n.DataValidation_RegularDefaultErrorMessage="입력한 값이 {0} 정규식과 일치하지 않습니다.",n.Validate_Number="유효한 숫자를 입력하십시오.",n.InvalidValueErrorMessage="'{2}' 표에서 '{1}' 열의 잘못된 값 '{0}'을(를) 커밋할 수 없습니다.",n.uploadFileBiggerThanMaxFileCount="업로드된 파일 수가 최대 수에 도달했습니다. 더 이상 파일을 업로드할 수 없습니다.",n.uploadFileBiggerThanMaxSize="업로드된 파일 {0} 크기가 제한보다 큽니다. 최대 크기는 {1}MB입니다.",n.uploadFileNotMatchExtension="업로드된 파일 {0}의 파일 유형이 허용되지 않습니다.",n.ExprotToExcelCalFormulaError="수식의 결과에 오류가 있어 Excel 파일로 내보내기 할 수 없습니다.",n.ExprotToPDFCalFormulaError="수식을 결과에 오류가 있어 PDF 파일로 내보내기 할 수 없습니다!",n.ExportListviewNoColumnError="테이블에 내보내기할 대상 열이 없습니다.",n.AutoGeneratedID_Conflict_Error="자동 생성된 ID가 이미 있습니다. 관련 셀이 새 ID를 업데이트했습니다. 데이터를 다시 커밋하십시오.",n.AutoGeneratedID_Generate_Error="숫자 부분의 길이가 자동 생성된 ID에 설정된 길이보다 큽니다.",n.AutoGeneratedID_Conflict_Listview_Error="'{0}' 필드의 값이 이미 존재합니다.",n.ImportExcelFirstRowMissDataError="Excel에서 가져온 첫 번째 행 데이터는 비워둘 수 없습니다.",n.NoMatchBetweenExcelWithListViewError="가져오기를 위해 지정된 Excel 문서에 대상 목록 보기와 일치하는 데이터 구조가 없습니다. Excel 문서에서 일치하는 열을 찾을 수 없음: {0}",n.InCorrectFileFormatError="올바르지 않은 파일 형식입니다.",n.NoSelectedRowError="하나 이상의 행을 선택하십시오.",n.ImportExcelCannotFindListViewError="목록 보기 '{0}'을(를) 찾을 수 없습니다.",n.GUID_Creator="작성자",n.GUID_CreateDate="작성일",n.GUID_LastModifyBy="마지막 수정자",n.GUID_LastModifyDate="마지막 수정일",n.GUID_AssignTo="담당자",n.GUID_Status="상태",n.UpdateListviewCommand_Listview_Group="통계 열을 포함하는 ListView를 업데이트할 수 없습니다.",n.UpdateListviewCommand_Listview_DetailListview="마스터 표의 현재 행이 없는 세부 ListView를 업데이트할 수 없습니다.",n.ImportExcelToListViewError_Detail="Excel의 '{1}' 행 및 '{2}' 열에 있는 '{0}' 값이 잘못되었습니다. 오류 메시지: {3}",n.ImportExcelToListViewError_ExistSameKeys="Excel 데이터에 중복되는 Key값이 있습니다. Primary Key는 유일한 값이어야 합니다. 중복되는 값은 다음과 같습니다: \r\n{0}",n.UpdateViewFail_Error="업데이트하지 못했습니다.\r\n 현재 보기를 업데이트할 수 없습니다.",n.UpdateListViewFail_BindingTableCantEditError="업데이트하지 못했습니다. \r\n 현재 연결된 데이터 원본을 업데이트할 수 없습니다.",n.ConcurrentLicenseError_Kickoffed="관리자에 의해 퇴출되었습니다.",n.ConcurrentLicenseError_NoEnoughLicense="액세스가 거부되었습니다. 계정 라이선스가 만료되었습니다. 관리자에게 문의하십시오.",n.ConcurrentLicenseError_SendEmail="이메일 보내기",n.ConcurrentLicenseError_Cancel="보내지 않음",n.ConcurrentLicenseError_MessagePlaceHolder="여기에 이메일 내용을 입력하십시오.",n.ConcurrentLicenseError_AddressPlaceHolder="이메일 주소를 입력하십시오.",n.ConcurrentLicenseError_SendSuccess="보내기에 성공했습니다.",n.ConcurrentLicenseError_SendFailed="보내기에 실패했습니다.",n.ConcurrentLicenseError_EmailTitle="액세스가 거부되었습니다.",n.ConcurrentLicenseError_PleaseInputValidEmailAddress="유효한 이메일 주소를 입력하십시오.",n.ConcurrentLicenseError_SenderAddress="보낸이",n.ContainerCellType_Error_CircularReference="하위 페이지 '{0}' 로드에 실패했습니다. 순환 참조가 있습니다.",n.NameConflict="이름 '{0}'이(가) 충돌합니다. '{1}' 페이지 및 '{2}' 페이지 모두에 이 이름이 있습니다.",n.ContainerCellType_Error_NoExistedPage="'{0}' 페이지를 찾을 수 없습니다.",n.SetCurrentRow_Error_NoRecord="'{0}' 표의 현재 행을 설정하지 못했습니다. 쿼리 조건에 따른 데이터가 없습니다.",n.ListViewAddNewRowError_CantConvertToNumber="숫자로 변환할 수 없습니다.",n.ListViewAddNewRowError_CantConvertToBool="참/거짓으로 변환할 수 없습니다.",n.ListViewAddNewRowError_CantConvertToDateTime="날짜 또는 시간으로 변환할 수 없습니다.",n.CallStoredProcedureCommand_ExecuteFailed="저장 프로시저 실행에 실패했습니다.",n.Echart_BubbleChartToolTip="크기: {0}",n.Command_postFail_ErrorMessage="명령 실행 실패.",n.Commit_FailMessage="커밋 실패.",n.Commit_ExecutingMessage="명령이 실행중입니다.",n.LongTimeNoOperation="오랜 시간 동안 페이지를 조작하지 않으면 연결이 끊어집니다.",n.PleaseClickButtonToReload="페이지를 새로 고침하려면 버튼을 클릭하십시오..",n.ReloadPage="페이지 새로 고침",n.DateTime_Calender_HeaderFormat="yyy년M월",n.DateTime_Calender_YearMonthFormat="yyyy년,M월",n.UnauthorizedUpload="익명 접근을 허용하지 않습니다. 로그인하셔야 합니다.",n.SessionTimeout="세션이 만료되었습니다. 다시 로그인해 주십시오.",n.NameConflictWarning="입력하신 「{0}」는 셀 이름 혹은 변수명으로 이미 사용 중입니다.",n.ExprotActiveReportsCalFormulaError="수식 계산 시 내보내기 하시려는 보고서 파일의 이름이 잘못되었습니다.",n.ActiveReportsParameterValueCalFormulaError="수식 계산 시 매개 변수 값이 잘못되었습니다.",n.StartExecuteCommand="명령 수행:",n.StartExecutePageLoadCommand="페이지 로딩 시 명령 {0} 수행",n.StartExecuteCellClickCommand="셀 클릭 시 명령 {0} 수행",n.StartExecuteCellValudeChangedCommand="셀 값 변경 명령 {0} 수행",n.UseTime="기간: {0} ms",n.DataValidationNotPassed="데이터 유효성 검사를 통과하지 못했습니다. 명령을 취소합니다.",n.PopupCloseButton="팝업 닫기 버튼",n.CommandName_ClosePopupCommand="팝업 닫기",n.Log_NavigateCommand_PassValues="대상 페이지에 값 전달e",n.CreateCommandContextVariables="[명령 컨텍스트의 변수 만들기]",n.ServerCommandLog_CreateParam="매개 변수 생성 : {0} = {1}",n.LeaveSiteConfirm="변경하신 내용이 저장되지 않습니다. 그냥 이동하시겠습니까?",n.LeaveSiteConsoleMessage_Cell="셀({0})",n.LeaveSiteConsoleMessage_Cell_DefaultValue="기본 값: {0}",n.LeaveSiteConsoleMessage_Cell_CurrentValue="현재 값: {0}",n.LeaveSiteConsoleMessage_Listview="리스트뷰({0})",n.CantFindParam="Can't find param: {0}",n.TriggerByCommand="Trigger by command {0}",n.ExportPageToExcelCommand_PageNameTooLong="The name of exported page cannot exceed 31.",n.ExportListviewToExcelCommand_PageNameTooLong="The name of page where the listview resides cannot exceed 31.",n.BPM_LogText_CommitTitle="커밋 작업 실행을 시작합니다.",n.BPM_LogText_TerminateTitle="종료 작업 실행을 시작합니다.",n.BPM_LogText_RollbackTitle="롤백 작업 실행을 시작합니다.",n.BPM_LogText_DispatchTitle="실행 보내기 작업을 시작합니다.",n.BPM_LogText_DelegateTitle="위임 작업 실행을 시작합니다.",n.BPM_LogText_CancelDelegateTitle="실행 취소 위임 작업을 시작합니다.",n.BPM_LogText_AddOnSignTitle="애드온 서명 작업을 시작합니다.",n.BPM_LogText_CarbonCopyTitle="사본 복사 작업을 시작합니다.",n.BPM_LogText_ReadCarbonCopyTitle="사본 읽기 복사 작업을 시작합니다.",n.BPM_LogText_SaveBussinessData="비즈니스 데이터 저장: ",n.BPM_LogText_SaveBussinessDataCommand="[Excute save business data command]",n.BPM_LogText_ExecutePreCommands="[사전 명령 실행]",n.BPM_LogText_ExecutePostCommands="[사후 명령 실행]",n.BPM_LogText_ExecuteTaskNodeAction="작업 작업 실행 [{0}], 작업 ID: [{1}]",n.BPM_LogText_CallStartProcessCommand_ByDefinitionID="프로세스시작명령 호출, 프로세스 정의ID: [{0}], 프로세스 인스턴스 이름: {1}",n.BPM_LogText_CallStartProcessCommand_ByName="프로세스시작명령 호출, 프로세스 이름: [{0}], 프로세스 인스턴스 이름: {1}",n.BPM_UserSetting_UnnamedNode="<이름없는 노드>",n.BPM_AssigneesRow_SelectByUser_Placeholder="담당자를 선택하세요.",n.BPM_Error_AssigneesTarget_TypeIsNotExist="AssigneeTarget의 유형이 존재하지 않습니다.",n.CurrentRow_NotExist="현재 행이 존재하지 않습니다. 프로세스 시작 명령을 확인하십시오.",n.RowMode_NotExist="선택한 행 모드가 존재하지 않습니다. 프로세스 시작 명령을 확인하십시오.",n.ProcessInstanceName_EvaluteError="프로세스 인스턴스 이름 평가에 실패했습니다. 셀 설정을 확인하십시오.",n.ProcessDefinitionId_EvaluteError="프로세스 정의 ID에 대한 평가가 실패했습니다. 셀 설정을 확인하십시오.",n.ProcessPanelCellType_UnnamedAction="<이름 없는 액션>",n.ProcessPanelCellType_UnnamedNode="<이름 없는 노드>",n.ProcessPanelCellType_GenerateBusinessKey_Error="현재 데이터베이스 업데이트에 실패했습니다.",n.ProcessPanelCellType_UpdateCurrentRowsClosure_ConfirmText="이 레코드를 추가하시겠습니까?",n.TaskActionDialog_CommentTextRow_Label="메모",n.TaskActionDialog_CommentTextRow_PlaceHolder="메모를 입력해주세요",n.TaskActionDialog_AssigneesRow_AssginToLabel="할당자",n.TaskActionDialog_AssigneesRow_DelegateToLabel="대리인",n.TaskActionDialog_AssigneesRow_AddOnSignToLabel="승인자",n.TaskActionDialog_AssigneesRow_CarbonCopyToLabel="참조인",n.TaskActionDialog_AssigneesRow_AddOnSignTypeLabel="유형",n.TaskActionDialog_AssigneesRow_AddOnSignTypePre="승인 링크 추가, 현재 단계 전에 승인 단계 추가",n.TaskActionDialog_AssigneesRow_AddOnSignTypePost="승인 후, 승인 링크 추가",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle="사용자 선택",n.TaskActionDialog_AssigneesRow_SelectorDialogTitle_Mobile="선택한 사용자 표시({0} 사용자)",n.TaskActionDialog_AssigneesRow_Error_NoUserInfo="선택할 수 있는 사용자가 없습니다. 관리자에게 문의하세요.",n.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty="사용자는 비워둘 수 없습니다.",n.UserSelectorDialog_SearchInput="검색 사용자(사용자 이름/전체 이름/이메일)",n.UserSelectorDialog_Selection_Title="선택된 사용자 {0}명",n.UserSelectorDialog_Selection_IsMultiple="제한 없는",n.UserSelectorDialog_Selection_NoMultiple="1인 한정",n.UserSelectorDialog_TreeView_Title="조직 부서",n.UserSelectorDialog_TreeView_NotOrganizedUser="조직화되지 않은 사용자",n.UserSelectorDialog_UserList_Title="선택적 사용자",n.UserSelectorDialog_DeleteList_Title="선택한 사용자 삭제",n.UserSelectorDialog_DeleteListTip_Text="{0}명의 사용자를 삭제하시겠습니까?",n.CreateDelegateDialog_Title="대리인 생성",n.CreateDelegateDialog_Tip="위임 시간 동안 위임 프로세스 작업은 처리를 위해 에이전트에게 전달됩니다.",n.CreateDelegateDialog_DelegatedTime_Title="시간",n.CreateDelegateDialog_DelegatedTime_StartTime="시작 시간:",n.CreateDelegateDialog_DelegatedTime_EndTime="종료 시간:",n.CreateDelegateDialog_DelegatedTime_Error_EndTimeMustEarilerStartTime="종료 시간은 시작 시간보다 빠르거나 같을 수 없습니다.",n.CreateDelegateDialog_Agent_Title="에이전트",n.CreateDelegateDialog_Agent_Tip="* 첫 번째 유효한 에이전트를 순서대로 찾고, 첫 번째 사람이 삭제되면 두 번째 사람을 순서대로 찾는 식입니다.",n.CreateDelegateDialog_Agent_SelectAgent="에이전트 선택",n.CreateDelegateDialog_Agent_DeleteAgent="삭제",n.CreateDelegateDialog_Agent_Error_AgentCannotBeEmpty="에이전트는 비워둘 수 없습니다.",n.CreateDelegateDialog_DelegatedProcess_Title="프로세스",n.CreateDelegateDialog_DelegatedProcess_Tip="* '모든'은 현재 및 이후의 모든 신규 프로세스에 적용됩니다. '선택'은 선택된 프로세스에만 적용됩니다. ",n.CreateDelegateDialog_DelegatedProcess_Type="위임 절차:",n.CreateDelegateDialog_DelegatedProcess_AllProcesses="모든 프로세스",n.CreateDelegateDialog_DelegatedProcess_SelectProcesses="선택 프로세스",n.CreateDelegateDialog_DelegatedProcess_Error_ProcessCannotBeEmpty="프로세스는 비워둘 수 없습니다.",n.CreateDelegateDialog_ProcessTable_Title="제목",n.CreateDelegateDialog_ProcessTable_Description="설명",n.CreateDelegateDialog_Description_Title="설명",n.CreateDelegateDialog_Description_Placeholder="설명을 입력하세요",n.CreateDelegateDialog_User_NotExist="Inexistent",n.CreateDelegateDialog_User_Disabled="Disabled",n.CreateDelegateDialog_Process_NotExist="Inexistent",n.DelegationListDialog_Title="대리인 설정",n.DelegationListDialog_CreateDelegation="대리인 생성",n.DelegationListDialog_Table_AllProcesses="모든 프로세스",n.DelegationListDialog_Table_EmptyTime="비어 있는",n.DelegationListDialog_Table_DataColumn_Agent="에이전트(s)",n.DelegationListDialog_Table_DataColumn_DelegatedProcess="프로세스(es)",n.DelegationListDialog_Table_DataColumn_StartTime="시작 시간",n.DelegationListDialog_Table_DataColumn_EndTime="종료 시간",n.DelegationListDialog_Table_DataColumn_CreateDate="생성 시간",n.DelegationListDialog_Table_DataColumn_Description="설명",n.DelegationListDialog_Table_DataColumn_Update="업데이트",n.DelegationListDialog_Table_DataColumn_Delete="Delete",n.DelegationListDialog_Table_DataColumn_Enable="활성화",n.DelegationListDialog_Table_DataColumn_Disable="비활성화",n.DelegationListDialog_Error_DelegationConfigurationIsEmpty="위임 구성이 존재하지 않습니다.",n.DelegationListDialog_Comfirm_EnabledConfuguration="대리인을 활성화하시겠습니까?",n.DelegationListDialog_Comfirm_DisabledConfuguration="대리인을 비활성화하시겠습니까?",n.DelegationListDialog_Comfirm_DeleteConfuguration="Sure to delete delegate?",n.UpdateDelegateDialog_Title="대리인 업데이트",n.UI_Table_ActionColumn="c",n.ForguncyUserAvator_UserName="사용자이름",n.ForguncyUserAvator_FullName="전체이름",n.ForguncyUserAvator_Email="이메일",n.NotificationUnauthorized="구독 서버 알림에 실패했습니다. 사용자가 승인되지 않았을 수 있습니다.",n.NotificationLocationString="알림 명령 실행",n}();n._KOStringResource=u;f=function(){function n(){}return n.cultureName="en-US",n.dashboard_scenario_value_running_sum="Running Sum",n.dashboard_scenario_value_running_avg="Running Average",n.dashboard_scenario_value_running_max="Running Max",n.dashboard_scenario_value_running_min="Running Min",n.dashboard_scenario_value_running_cnt="Running Count",n.dashboard_scenario_value_moving_sum="Moving Sum",n.dashboard_scenario_value_moving_avg="Moving Average",n.dashboard_scenario_value_moving_max="Moving Max",n.dashboard_scenario_value_moving_min="Moving Min",n.dashboard_scenario_value_sumof="Sum of {0}",n.dashboard_scenario_value_avgof="Average of {0}",n.dashboard_scenario_value_maxof="Max of {0}",n.dashboard_scenario_value_minof="Min of {0}",n.dashboard_scenario_value_cntof="Count of {0}",n.dashboard_scenario_value_dstof="Distinct Count of {0}",n.dashboard_scenario_value_firstof="First of {0}",n.dashboard_scenario_value_lastof="Last of {0}",n.directives_scenariodimension_datadimensions_year="Year",n.directives_scenariodimension_datadimensions_fiscalyear="Fiscal Year",n.directives_scenariodimension_datadimensions_quarter="Quarter",n.directives_scenariodimension_datadimensions_month="Month",n.directives_scenariodimension_datadimensions_week="Week",n.directives_scenariodimension_datadimensions_day="Day",n.directives_scenariodimension_datadimensions_hour="Hour",n.directives_scenariodimension_datadimensions_minute="Minute",n.directives_scenariodimension_datadimensions_second="Second",n.directives_scenariodimension_datadimensions_millisecond="Millisecond",n.spread_pivot_table_subtotal="Total",n.spread_pivot_table_grand_total="Grand Total",n.nullvalue_display="(blank)",n.datetime_quarter_q1="Q1",n.datetime_quarter_q2="Q2",n.datetime_quarter_q3="Q3",n.datetime_quarter_q4="Q4",n.datetime_month_m1="Jan",n.datetime_month_m2="Feb",n.datetime_month_m3="Mar",n.datetime_month_m4="Apr",n.datetime_month_m5="May",n.datetime_month_m6="Jun",n.datetime_month_m7="Jul",n.datetime_month_m8="Aug",n.datetime_month_m9="Sep",n.datetime_month_m10="Oct",n.datetime_month_m11="Nov",n.datetime_month_m12="Dec",n.datetime_year_format="@",n}();n._PivotTableENSR=f;e=function(){function n(){}return n.cultureName="ja-JP",n.dashboard_scenario_value_running_sum="累積合計",n.dashboard_scenario_value_running_avg="累積平均",n.dashboard_scenario_value_running_max="累積最大値",n.dashboard_scenario_value_running_min="累積最小値",n.dashboard_scenario_value_running_cnt="累積数",n.dashboard_scenario_value_moving_sum="移動合計",n.dashboard_scenario_value_moving_avg="移動平均",n.dashboard_scenario_value_moving_max="移動最大値",n.dashboard_scenario_value_moving_min="移動最小値",n.dashboard_scenario_value_sumof="合計 {0}",n.dashboard_scenario_value_avgof="平均 {0}",n.dashboard_scenario_value_maxof="最大 {0}",n.dashboard_scenario_value_minof="最小 {0}",n.dashboard_scenario_value_cntof="データの個数 {0}",n.dashboard_scenario_value_dstof="一意のデータの個数 {0}",n.dashboard_scenario_value_firstof="第一条 {0}",n.dashboard_scenario_value_lastof="最后一条 {0}",n.directives_scenariodimension_datadimensions_year="年",n.directives_scenariodimension_datadimensions_fiscalyear="会計年度",n.directives_scenariodimension_datadimensions_quarter="季度",n.directives_scenariodimension_datadimensions_month="月",n.directives_scenariodimension_datadimensions_week="周",n.directives_scenariodimension_datadimensions_day="日",n.directives_scenariodimension_datadimensions_hour="时",n.directives_scenariodimension_datadimensions_minute="分",n.directives_scenariodimension_datadimensions_second="秒",n.directives_scenariodimension_datadimensions_millisecond="毫秒",n.spread_pivot_table_subtotal="計",n.spread_pivot_table_grand_total="総計",n.nullvalue_display="(空白)",n.datetime_quarter_q1="第1四半期",n.datetime_quarter_q2="第2四半期",n.datetime_quarter_q3="第3四半期",n.datetime_quarter_q4="第4四半期",n.datetime_month_m1="1月",n.datetime_month_m2="2月",n.datetime_month_m3="3月",n.datetime_month_m4="4月",n.datetime_month_m5="5月",n.datetime_month_m6="6月",n.datetime_month_m7="7月",n.datetime_month_m8="8月",n.datetime_month_m9="9月",n.datetime_month_m10="10月",n.datetime_month_m11="11月",n.datetime_month_m12="12月",n.datetime_year_format="@年",n}();n._PivotTableJASR=e;o=function(){function n(){}return n.cultureName="zh-CN",n.dashboard_scenario_value_running_sum="累积合计",n.dashboard_scenario_value_running_avg="累积平均",n.dashboard_scenario_value_running_max="累积最大值",n.dashboard_scenario_value_running_min="累积最小值",n.dashboard_scenario_value_running_cnt="累积计数",n.dashboard_scenario_value_moving_sum="移动合計",n.dashboard_scenario_value_moving_avg="移动平均",n.dashboard_scenario_value_moving_max="移动最大值",n.dashboard_scenario_value_moving_min="移动最小值",n.dashboard_scenario_value_sumof="合計 {0}",n.dashboard_scenario_value_avgof="平均 {0}",n.dashboard_scenario_value_maxof="最大值 {0}",n.dashboard_scenario_value_minof="最小值 {0}",n.dashboard_scenario_value_cntof="数值计数 {0}",n.dashboard_scenario_value_dstof="唯一计数 {0}",n.dashboard_scenario_value_firstof="第一条 {0}",n.dashboard_scenario_value_lastof="最后一条 {0}",n.directives_scenariodimension_datadimensions_year="年",n.directives_scenariodimension_datadimensions_fiscalyear="财年",n.directives_scenariodimension_datadimensions_quarter="季度",n.directives_scenariodimension_datadimensions_month="月",n.directives_scenariodimension_datadimensions_week="周",n.directives_scenariodimension_datadimensions_day="日",n.directives_scenariodimension_datadimensions_hour="时",n.directives_scenariodimension_datadimensions_minute="分",n.directives_scenariodimension_datadimensions_second="秒",n.directives_scenariodimension_datadimensions_millisecond="毫秒",n.spread_pivot_table_subtotal="小计",n.spread_pivot_table_grand_total="总计",n.scenario_slicer_relativedate_datetype_year="年",n.scenario_slicer_relativedate_datetype_quarter="季度",n.scenario_slicer_relativedate_datetype_month="月",n.scenario_slicer_relativedate_datetype_week="周",n.scenario_slicer_relativedate_datetype_day="日",n.nullvalue_display="(空白)",n.table_rows_empty_desc="无有效项",n.pivot_table_empty_desc="点击此区域设计透视表",n.pivot_table_dataset_removed="相关数据集被删除",n.datetime_quarter_q1="第一季度",n.datetime_quarter_q2="第二季度",n.datetime_quarter_q3="第三季度",n.datetime_quarter_q4="第四季度",n.datetime_month_m1="1月",n.datetime_month_m2="2月",n.datetime_month_m3="3月",n.datetime_month_m4="4月",n.datetime_month_m5="5月",n.datetime_month_m6="6月",n.datetime_month_m7="7月",n.datetime_month_m8="8月",n.datetime_month_m9="9月",n.datetime_month_m10="10月",n.datetime_month_m11="11月",n.datetime_month_m12="12月",n.datetime_year_format="@年",n}();n._PivotTableCNSR=o;s=function(){function n(){}return n.cultureName="ko-KR",n.dashboard_scenario_value_running_sum="누적합계",n.dashboard_scenario_value_running_avg="누적평균",n.dashboard_scenario_value_running_max="누적최대",n.dashboard_scenario_value_running_min="누적최소",n.dashboard_scenario_value_running_cnt="누적개수",n.dashboard_scenario_value_moving_sum="이동합계",n.dashboard_scenario_value_moving_avg="이동평균",n.dashboard_scenario_value_moving_max="이동최대",n.dashboard_scenario_value_moving_min="이동최소",n.dashboard_scenario_value_sumof="{0}의 합계",n.dashboard_scenario_value_avgof="{0}의 평균",n.dashboard_scenario_value_maxof="{0} 중 최대",n.dashboard_scenario_value_minof="{0} 중 최소",n.dashboard_scenario_value_cntof="{0} 개수",n.dashboard_scenario_value_dstof="{0} 중 고유 데이터의 개수",n.dashboard_scenario_value_firstof="{0} 중 첫번째",n.dashboard_scenario_value_lastof="{0} 중 마지막",n.directives_scenariodimension_datadimensions_year="년",n.directives_scenariodimension_datadimensions_fiscalyear="회계 연도",n.directives_scenariodimension_datadimensions_quarter="분기",n.directives_scenariodimension_datadimensions_month="월",n.directives_scenariodimension_datadimensions_week="주",n.directives_scenariodimension_datadimensions_day="일",n.directives_scenariodimension_datadimensions_hour="시",n.directives_scenariodimension_datadimensions_minute="분",n.directives_scenariodimension_datadimensions_second="초",n.directives_scenariodimension_datadimensions_millisecond="밀리 초",n.spread_pivot_table_subtotal="소계",n.spread_pivot_table_grand_total="총 합계",n.nullvalue_display="(비어있음)",n.datetime_quarter_q1="Q분기",n.datetime_quarter_q2="Q분기",n.datetime_quarter_q3="Q분기",n.datetime_quarter_q4="Q분기",n.datetime_month_m1="1월",n.datetime_month_m2="2월",n.datetime_month_m3="3월",n.datetime_month_m4="4월",n.datetime_month_m5="5월",n.datetime_month_m6="6월",n.datetime_month_m7="7월",n.datetime_month_m8="8월",n.datetime_month_m9="9월",n.datetime_month_m10="10월",n.datetime_month_m11="11월",n.datetime_month_m12="12월",n.datetime_year_format="@",n}();n._PivotTableKRSR=s;switch(n.StaticData.Lang){case"cn":n.RS=n._CNStringResource;break;case"ja":n.RS=n._JAStringResource;break;case"kr":n.RS=n._KOStringResource}})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var f=function(){function n(){}return n.InnerID="innerid",n.NeedImplementException="Need Implement.",n.isInListview="isInListview",n.conditionalForeColor="conditionalForeColor",n.FontStyle_Italic="Italic",n.Font_Normal="Normal",n.FontWeight_Bold="Bold",n.RunTimeNormalPage="p",n.RunTimeMasterPage="m",n.DefaultFontSizeInPx=14.67,n}(),i,r,t,u;n.StaticValues=f;i=function(){function n(){}return n.toArray=function(){return[n.CreateBy,n.CreateDate,n.LastModifyBy,n.LastModifyDate,n.Status,n.AssignTo,]},n.CreateBy="FGC_Creator",n.CreateDate="FGC_CreateDate",n.LastModifyBy="FGC_LastModifier",n.LastModifyDate="FGC_LastModifyDate",n.AssignTo="FGC_AssignTo",n.Status="FGC_State",n}();n.GUIDColumnName=i;r=function(){function i(){}return i.IsKeyWord=function(n){if(n&&typeof n=="string"){var t=n;if(t===i.PageName||t===i.ViewportWidth||t===i.ViewportHeight||t===i.CurrentUserStr||t.length>i.CurrentUserPrefix.length+1&&t.indexOf(i.CurrentUserPrefix)===0&&t[t.length-1]==="%")return!0}return!1},i.GetKeyWordValue=function(r,u,f){var o,s,h,e,c,l;if(!i.IsKeyWord(r))return r;if(r===i.PageName)return u&&(o=n.PageManager.getContainerCell(u),o&&o.cellType instanceof n.UserControlPageCellType)?this.GetKeyWordValue(r,o.runTimePageName,f):n.PageManager.getDesignerPageName(u,!0);if(r===i.ViewportWidth)return f&&(s=function(){var n=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);f(n,function(){return $(window).off("resize",s)})},$(window).resize(s)),Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);if(r===i.ViewportHeight)return f&&(h=function(){var n=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);f(n,function(){return $(window).off("resize",h)})},$(window).resize(h)),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);e=0;c=null;switch(r){case i.CurrentUserStr:case i.CurrentUserUserName:e=0;break;case i.CurrentUserEmail:e=2;break;case i.CurrentUserFullName:e=1;break;case i.CurrentUserRole:e=3;break;case i.CurrentUserOrganizationSuperior:e=6;break;default:l=r.length;c=r.substr(i.CurrentUserPrefix.length,l-i.CurrentUserPrefix.length-1);e=7}return t.getUserInfo({PropertyType:e,UserProperty:c})},i.Null="%Null%",i.CurrentUserStr="%CurrentUser%",i.CurrentUserPrefix="%CurrentUser.",i.CurrentUserEmail="%CurrentUser.Email%",i.CurrentUserFullName="%CurrentUser.FullName%",i.CurrentUserRole="%CurrentUser.Role%",i.CurrentUserUserName="%CurrentUser.UserName%",i.CurrentUserOrganizationSuperior="%CurrentUser.OrganizationSuperior%",i.PageName="%PageName%",i.ViewportWidth="%ViewportWidth%",i.ViewportHeight="%ViewportHeight%",i}();n.KeyWords=r;t=function(){function t(){}return t.getUserInfo=function(i){var r=n.ForguncyData.userInfo,u;switch(i.PropertyType){case 2:return r.Email;case 1:return r.FullName;case 6:return r.OrganizationSuperior;case 3:return r.Role;case 0:return r.UserName;case 4:return t.getCustomPropertyValue(i.UserProperty).Value;case 5:return t.getOrganizationLevelValue(i.UserProperty);case 7:return u=t.getCustomPropertyValue(i.UserProperty),u.Find?u.Value:t.getOrganizationLevelValue(i.UserProperty);default:return null}},t.getCustomPropertyValue=function(t){var i=n.ForguncyData.userInfo,r,u;if(i.GetCustomPropertyValue)return i.GetCustomPropertyValue(t);if(i.Properties)for(r=0;r<i.Properties.length;r++)if(u=i.Properties[r],u.PropertyName===t)return{Find:!0,Value:u.Value};return{Find:!1,Value:null}},t.isOrganizationLevel=function(t){var r=n.ForguncyData.userInfo,i,u;if(r.OrganizationLevelValues)for(i=0;i<r.OrganizationLevelValues.length;i++)if(u=r.OrganizationLevelValues[i],u.OrganizationLevelName===t)return!0;return!1},t.getOrganizationLevelValue=function(t){var r=n.ForguncyData.userInfo,i,u;if(r.OrganizationLevelValues)for(i=0;i<r.OrganizationLevelValues.length;i++)if(u=r.OrganizationLevelValues[i],u.OrganizationLevelName===t)return u.Value;return null},t.getUserPropertyValue=function(t,i){if(t.Properties){var r=n.ArrayHelper.firstOrDefault(t.Properties,function(t){return n.Common.IsEmpty(i)||n.Common.IsEmpty(t.PropertyName)?!1:t.PropertyName.toLowerCase()===i.toLowerCase()});return r?r.Value:""}return""},t}();n.UserInfoHelper=t;u=function(){function n(){}return n.WeChartBrowser_CantDownloadFileWarning="请在浏览器中打开该网页后再下载。",n}();n.ChineseStaticValues=u})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.isValidCompressImageExtension=function(t){if(typeof t!="string"||n.Common.IsEmpty(t))return!1;var i=t.substr(t.lastIndexOf(".")+1).toLowerCase();return i==="gif"?!1:!0},t.getCompressedImageFormData=function(n,t){var i=document.createElement("img");i.src=n.src;var r=document.createElement("canvas"),f=r.getContext("2d"),u=this;i.onload=function(){var o,e,h,s;if(n.width=i.width,n.height=i.height,n.width<=n.maxWidth&&n.height<=n.maxHeight){o=new FormData;o.append("file",n.file);t(o);return}e=u.getCompressImageSize(n);r.width=e.width;r.height=e.height;f.drawImage(i,0,0,e.width,e.height);h=r.toDataURL();s=new FormData;s.append("file",u.convertBase64ToFile(h),n.file.name);t(s)}},t.getCompressImageSize=function(t){return n.Common.IsEmpty(t.maxWidth)||n.Common.IsEmpty(t.maxHeight)?t:(t.width>t.maxWidth&&(t.height=t.height*(t.maxWidth/t.width),t.width=t.maxWidth),t.height>t.maxHeight&&(t.width=t.width*(t.maxHeight/t.height),t.height=t.maxHeight),t)},t.convertBase64ToFile=function(n){for(var i=n.split(","),f=i[0].match(/:(.*?);/)[1],r=atob(i[1]),t=r.length,u=new Uint8Array(t);t--;)u[t]=r.charCodeAt(t);return new Blob([u],{type:f})},t}();n.ImageCompressHelper=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t,f,i,e,r,u,o,s,h,c;typeof String.prototype.endsWith!="function"&&(String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1});t=jQuery;f=function(){function n(){}return n.dateTimeDefaultFormattingString="yyyy/M/d h:mm:ss",n.timeDefaultFormattingString="h:mm; @",n}();n.StaticFormatString=f;i=function(){function i(){}return i.isForguncyFile=function(n){return/^[0-9a-f]{8}-?[0-9a-f]{4}-?[1-5][0-9a-f]{3}-?[89ab][0-9a-f]{3}-?[0-9a-f]{12}_.+$/i.test(n)},i.enumAllCommandsMetaData=function(n){var t=[],r,u,o,f,e,s;if(n)for(r=0;r<n.length;r++){if(u=n[r],u.$type==="Forguncy.Model.ConditionCommand, ServerDesignerCommon"&&(o=u,f=o.ConditionAndCommandPairList,f))for(e=0;e<f.length;e++)s=i.enumAllCommandsMetaData(f[e].CommandList),t=t.concat(s);t.push(u)}return t},i.isBindingInfoEquals=function(n,t){return i.IsEmpty(n)||i.IsEmpty(t)?!1:n.TableName===t.TableName&&n.ColumnName===t.ColumnName&&(i.IsEmpty(n.AttachType)&&i.IsEmpty(t.AttachType)||JSON.stringify(n.AttachType)===JSON.stringify(t.AttachType))&&this.isRelationBindinInfoEquals(n.RelationBinding,t.RelationBinding)},i.isRelationBindinInfoEquals=function(n,t){return i.IsEmpty(n)&&i.IsEmpty(t)?!0:i.IsEmpty(n)||i.IsEmpty(t)?!1:n.RelatedTable===t.RelatedTable&&n.RelatedColumn===t.RelatedColumn&&n.DisplayColumn===t.DisplayColumn&&this.isRelationBindinInfoEquals(n.NextRelationBinding,t.NextRelationBinding)},i.cannotEditedBindingInfo=function(t){return!t||!t.ColumnName||!t.TableName||t.RelationBinding?!0:t.AttachType?!0:n.GUIDColumnName.toArray().indexOf(t.ColumnName)!==-1?!0:!1},i.getMousePosition=function(n){return n.pageX||n.pageY?{x:n.pageX,y:n.pageY}:{x:n.clientX+document.body.scrollLeft-document.body.clientLeft,y:n.clientY+document.body.scrollTop-document.body.clientTop}},i.GetUrlQuery=function(n){for(var r=window.location.search.substring(1),i=r.split("&"),t=0;t<i.length;t++)if(i[t].indexOf(n)===0)try{return decodeURIComponent(i[t].substring(n.length+1))}catch(u){return null}},i.getIdStr=function(n,t,i){return"r"+n+"c"+t+i},i.parseIDStr=function(n){var t,u,f,r,e;if(!i.IsEmpty(n)&&(t=n.substring(1),u=t.indexOf("c"),!(u<0))&&(f=Number(t.substring(0,u)),!isNaN(f))){for(r=u+1;r<t.length;r++)if(t[r]>"9"||t[r]<"0")break;if(e=Number(t.substring(u+1,r)),!isNaN(e))return{suffix:t.substring(r),row:f,col:e}}},i.back=function(){history.go(n.ForguncyData.enterHistoryCount-history.length-1)},i.openWindow=function(t){var i=window.open(t);!i&&(n.Platform.isMobile()||n.Platform.isIpad())&&(window.location.href=t)},i.trimStr=function(n){var t,i;if(typeof n!="string"||n.length===0)return n;if(n.trim)return n.trim();for(t=0;t<n.length;t++)if(n[t]!==" ")break;for(i=n.length-1;i>=0;)if(n[i]!==" ")break;else i--;return t<n.length&&i>=0&&t<i?n.substring(t,i):""},i.JsonUrlSwitch=function(n){for(var r,u,f,t,i="",e=0;e<n.length;e++){for(r=n[e],u=!1,f=0;f<this.JsonUrlSwitchKeyWords.length;f++)if(t=this.JsonUrlSwitchKeyWords[f],r===t[0]){i+=t[1];u=!0;break}else if(r===t[1]){i+=t[0];u=!0;break}u||(i+=r)}return i},i.getPageContext=function(){var t=n.Common.GetUrlQuery("pageContext"),r,f,u;return(i.IsEmpty(t)&&(n.SessionStorageManager.isInIframe||(t=n.SessionStorageManager.pageContext)),t)?(t=this.JsonUrlSwitch(t),JSON.parse(t,i.dateReviver)):(r=n.Common.GetUrlQuery("currentRowInfoList"),r)?(r=decodeURIComponent(r),f=JSON.parse(r),u={},u.currentRowInfoList=f,u.loadBindingDataOption=1,u):null},i.dateReviver=function(n,t){var i;return typeof t=="string"&&(i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t),i)?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6])):t},i.format=function(n){for(var u,t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t=t.map(function(n){return i.IsEmpty(n)?"":n}),t.length===0?n:t.length===1&&typeof t[0]=="object"?(u=/{([^{}]+)}/gm,n.replace(u,function(n,i){return t[0][i]})):(u=/{(\d+)}/gm,n.replace(u,function(n,i){return t[~~i]}))},i.initalTimeStamp=function(){return n.ForguncyData.timeStamp=i.getUniqueNumber(),i.postOrder={},n.Common.getTimeStamp()},i.checkTimeStamp=function(t){return t===n.ForguncyData.timeStamp?!0:!1},i.getTimeStamp=function(){return n.ForguncyData.timeStamp},i.forguncyGET=function(r,u,f){var s=n.Common.getTimeStamp(),o,e;return r=encodeURI(n.ForguncyData.ForguncyRoot+r),o=i.getUniqueNumber(),f&&(i.postOrder[f]=o),e=this.createAjaxSettingGET(r),e.success=function(t,r,e){f&&i.postOrder[f]!==o||n.Common.checkTimeStamp(s)&&(u===null||u===void 0?void 0:u(t,r,e))},e.error=function(t){n.MetadataLoader.loggedError(r,t)},t.ajax(r,e)},i.forguncyPost=function(r,u,f,e,o,s,h){var a=n.Common.getTimeStamp(),l,c;return r=encodeURI(n.ForguncyData.ForguncyRoot+r),l=i.getUniqueNumber(),e&&(i.postOrder[e]=l),n.StaticData.IsDebugMode&&(h=h!==null&&h!==void 0?h:{},h.AcceptWrapResponse="True"),c=this.createAjaxSetting(r,u,h),c.success=function(t,r,u){if(e&&i.postOrder[e]!==l){s===null||s===void 0?void 0:s(t,r,u);return}if(!n.Common.checkTimeStamp(a)){s===null||s===void 0?void 0:s(t,r,u);return}t&&t.Fgc_WrapResponse&&(t=t.ResponseResult);f===null||f===void 0?void 0:f(t,r,u)},c.error=function(t,i,u){o===null||o===void 0?void 0:o(t,i,u);n.MetadataLoader.loggedError(r,t)},t.ajax(r,c)},i.forguncyGETAsync=function(r,u){var o=n.Common.getTimeStamp(),e,f;return r=encodeURI(n.ForguncyData.ForguncyRoot+r),e=i.getUniqueNumber(),u&&(i.postOrder[u]=e),f=this.createAjaxSettingGET(r),new Promise(function(s,h){f.success=function(t){u&&i.postOrder[u]!==e||n.Common.checkTimeStamp(o)&&s(t)};f.error=function(t,i){var u;n.MetadataLoader.loggedError(r,t);h((u=t.responseText)!==null&&u!==void 0?u:i)};t.ajax(r,f)})},i.forguncyPOSTAsync=function(r,u,f){var s=n.Common.getTimeStamp(),o,e;return r=encodeURI(n.ForguncyData.ForguncyRoot+r),o=i.getUniqueNumber(),f&&(i.postOrder[f]=o),e=this.createAjaxSetting(r,u),new Promise(function(u,h){e.success=function(t){f&&i.postOrder[f]!==o||n.Common.checkTimeStamp(s)&&u(t)};e.error=function(t,i){var u;n.MetadataLoader.loggedError(r,t);h((u=t.responseText)!==null&&u!==void 0?u:i)};t.ajax(r,e)})},i.adjustDate=function(n){if(n instanceof Date)return u.adjustDateWith485Timezone(n);if(!i.IsEmpty(n)&&typeof n=="object")for(var t in n)n[t]=this.adjustDate(n[t]);return n},i.createAjaxSetting=function(n,t,r){var u={};return u.type="POST",u.url=n,i.IsEmpty(t)||(t=i.adjustDate(t),typeof t=="object"&&n&&n.toLowerCase().indexOf("customapi")<0?(u.contentType="application/json",u.data=JSON.stringify(t)):u.data=t),u.beforeSend=this.addProcessHeader,u.headers=r,u},i.addProcessHeader=function(t){var u,f=(u=n.ForguncyData.pageInfo)===null||u===void 0?void 0:u.currentRowInfoCollection,i,r;f&&(i=f.getTaskId(),i&&t.setRequestHeader("fgc-task-id",i.toString()),r=f.getProcessInstanceId(),r&&t.setRequestHeader("fgc-process-instance-id",r.toString()),(i||r)&&t.setRequestHeader("fgc-ignore-row-permission","true"))},i.createAjaxSettingGET=function(n){var t={};return t.type="GET",t.url=n,t.beforeSend=this.addProcessHeader,t},i.forguncyPostSync=function(i,r,u,f){var e;return f===void 0&&(f=null),i=encodeURI(n.ForguncyData.ForguncyRoot+i),e=this.createAjaxSetting(i,r),e.success=function(n,t,i){n&&n.Fgc_WrapResponse&&(n=n.ResponseResult);u===null||u===void 0?void 0:u(n,t,i)},e.error=function(t){n.MetadataLoader.loggedError(i,t);f&&f()},e.async=!1,t.ajax(i,e)},i.getColumnIndex=function(n,t){if(i.IsEmpty(n))return-1;var r=i.getColumnIndexByColumnName(n,t);return r===-1&&n[0]==="="&&(r=i.getColumnIndexByFormula(n,t)),r},i.getColumnIndexByColumnName=function(n,t){return t.getColIndexOfNamedColumn(n,!1)},i.getColumnIndexByFormula=function(n,t){var f=i.parseCellReferenceFormulaToCellLocation(n),u,r;return!f||f.length<=0?-1:(u=t.getContentRangeInfo(),r=f[0].Column-u.Column,(r<0||r>=u.Column+u.ColumnCount)&&(r=-1),r)},i.typeContains=function(n,t){if(n){var i=n.$type;return typeof i=="string"&&i.indexOf(t)!==-1}return!1},i.updateFile=function(r,u,f,e,o,s,h,c){o===void 0&&(o=null);s===void 0&&(s=null);h===void 0&&(h=null);c===void 0&&(c=!1);var a=u&&(!o||o.MaxUploadFileCount!==1)?"multiple":"",l=t("#FGC_UploadFile_Input");l.length>0&&l.remove();l=t("<input type='file' name='file' ' id='FGC_UploadFile_Input' "+a+"><\/input>");n.Platform.isAndroid()&&n.Platform.isWeChatOrQQBrowser()&&(r=null);l.attr("accept",r);l.hide();l.appendTo("body");c&&l.attr(n.StaticValues.isInListview,!0);l.on("change",function(){var r,u,t,c;if(l.val())for(r=l[0],u=r.files.length,t=0;t<u;t++)h&&h(u,t),c=r.files[t],c.size===0?e(n.RS.cantAddEmptyFile):i.uploadFileByHTML5(c,function(n){f(n)},e,o,s)});n.ForguncyData.IsAutoTest||l.trigger("click")},i.uploadImageByFileSelector=function(i,r,u,f,e,o){var h=this,s;o===void 0&&(o=!1);s=t("#FGC_UploadImage_Input");s.length>0&&s.remove();s=t("<input type='file' name='file' accept='image/*' id='FGC_UploadImage_Input'><\/input>");s.hide();s.appendTo("body");o&&s.attr(n.StaticValues.isInListview,!0);s.on("change",function(){var n,t,o;if(s.val()){if(n=s[0],t=n.files.length,t===0)return;o=n.files[t-1];h.uploadImageToServer(o,i,r,u,f,e)}});n.ForguncyData.IsAutoTest||s.trigger("click")},i.uploadImageToServer=function(t,r,u,f,e,o){var h,c,s,a,l;if(u){for(h=u.split(","),c=!1,s=0;s<h.length;s++)if(a=h[s],t.name.trim().toLowerCase().endsWith(a.trim().toLowerCase())){c=!0;break}if(!c){e(i.format(n.RS.uploadFileNotMatchExtension,t.name));return}}if(t.size===0){e(n.RS.cantAddEmptyFile);return}o&&o();!i.IsEmpty(r)&&r.IsCompressImage&&n.ImageCompressHelper.isValidCompressImageExtension(t.name)?EXIF.getData(t,function(){EXIF.getAllTags(this);var o=EXIF.getTag(this,"Orientation"),u=new FileReader;u.onload=function(){var u={src:this.result,file:t,maxWidth:r.MaxWidth,maxHeight:r.MaxHeight,orientation:o};n.ImageCompressHelper.getCompressedImageFormData(u,function(n){i.uploadFileWithAjax(i.uploadImageUrl,n,f,e)})};u.readAsDataURL(t)}):(l=new FormData,l.append("file",t),i.uploadFileWithAjax(i.uploadImageUrl,l,f,e))},i.uploadFileByHTML5=function(t,r,u,f,e){var h,c,o,l,s;if(f===void 0&&(f=null),e===void 0&&(e=null),f){if(f.ExtensionFilter){for(h=f.ExtensionFilter.split(","),c=!1,o=0;o<h.length;o++)if(l=h[o],t.name.trim().toLowerCase().endsWith(l.trim().toLowerCase())){c=!0;break}if(!c){u(i.format(n.RS.uploadFileNotMatchExtension,t.name));return}}if(f.SizeLimit&&f.SizeLimit*1048576<t.size){u(i.format(n.RS.uploadFileBiggerThanMaxSize,t.name,f.SizeLimit));return}}s=new FormData;s.append("file",t);s.append("uploadLimitId",e);i.uploadFileWithAjax(i.uploadUrl,s,r,u)},i.uploadFileWithAjax=function(n,i,r,u){t.ajax({url:n,type:"POST",success:function(n,t,i){r&&r(i.responseText)},error:function(n,t,i){u&&u(i,n)},data:i,cache:!1,contentType:!1,processData:!1,headers:{Accept:"application/json"}})},i.getiframeDocument=function(n){var i=n[0],t=i.contentWindow||i.contentDocument;return t.document&&(t=t.document),t},i.clone=function(n){var i,r,t,u;if(n===null||typeof n!="object")return n;if(n instanceof Array){for(i=[],t=0;t<n.length;t++)i[t]=this.clone(n[t]);return i}if(n instanceof Date)return new Date(n.getTime());if(n instanceof GC.Spread.CalcEngine.CalcError)return new GC.Spread.CalcEngine.CalcError(n.toString());r={};for(t in n)(u=n[t],typeof u!="function")&&(r[t]=this.clone(u));return r},i.getPageConver=function(t,i){var r=n.Common.getCover(t,i);return r.addClass("fgc-page-cover"),r},i.getCover=function(i,r){var u=t('<div style="filter:alpha(opacity:1);"/>');return u.css("background",n.ColorHelper.Convert(i)),u.css("opacity",r),u.addClass("disableSelect"),u},i.equals=function(n,t){return n===t?!0:n instanceof Date&&t instanceof Date?n.valueOf()===t.valueOf():!1},i.getA1ReferenceString=function(t,i,r,u){return n.FormulaHelper.unparse(n.FormulaHelper.createCellExpression(null,null,t,i,r,u))},i.parseCellReferenceFormulaToCellLocation=function(t){var u,h,c,i,r,o,s,l;if(!t)return[];var f=[],e=t.split(","),a=e.length;for(u=0;u<a;u++)if(h=void 0,c=e[u].indexOf("!"),h=c>0?e[u].split("!")[1]:e[u],i=n.FormulaHelper.parse(h),i.type===GC.Spread.CalcEngine.ExpressionType.reference)if(r=i.getRange(0,0),n.FormulaHelper.isCellExpression(i))f.push({Row:r.row,Column:r.col,ColumnRelative:i.columnRelative,RowRelative:i.rowRelative});else for(o=r.row;o<r.row+r.rowCount;o++)for(s=r.col;s<r.col+r.colCount;s++)f.push({Row:o,Column:s,ColumnRelative:i.columnRelative,RowRelative:i.rowRelative});else i.type===GC.Spread.CalcEngine.ExpressionType.name&&(l=i,f.push({Name:l.value}));return f},i.returnArrayFormulaItems=function(t){var r,u,i;if(!t)return null;if(u=t.indexOf("!"),r=u>0?t.split("!")[1]:t,i=n.FormulaHelper.parse(r),i.type===GC.Spread.CalcEngine.ExpressionType.array)try{return i.value.array[0]}catch(f){return null}return null},i.parseCellReferenceFormula=function(t,i){for(var u,f=n.Common.parseCellReferenceFormulaToCellLocation(t),e=[],o=f.length,r=0;r<o;r++)u=f[r],e.push(n.Common.getIdStr(u.Row,u.Column,i));return e},i.IsEmpty=function(n){return n===null||n===""||n===undefined?!0:!1},i.isObjEmpty=function(n){if(typeof n!="object")return!1;for(var t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0},i.IsString=function(n){return typeof n=="string"?!0:!1},i.deepEqual=function(n,t){if(n===t)return!0;if(typeof n=="object"&&n!==null&&typeof t=="object"&&t!==null){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(var r in n)if(t.hasOwnProperty(r)){if(!i.deepEqual(n[r],t[r]))return!1}else return!1;return!0}return!1},i.getLocatedListview=function(t,i,r){var u=n.ListviewBase.getAllListviews([t]).filter(function(n){var t=n.getContentRangeInfo();return i>=t.Row&&i<t.Row+t.RowCount&&r>=t.Column&&r<t.Column+t.ColumnCount});return u.length>0?u[0]:null},i.AdjustCellRange=function(n){typeof n.Row=="undefined"&&(n.Row=0);typeof n.Column=="undefined"&&(n.Column=0);typeof n.RowCount=="undefined"&&(n.RowCount=0);typeof n.ColumnCount=="undefined"&&(n.ColumnCount=0)},i.GetLastBindingInfoColumnName=function(n){if(!n)return null;var t=n.RelationBinding;if(i.IsEmpty(t))return n.ColumnName;while(!i.IsEmpty(t.NextRelationBinding))t=t.NextRelationBinding;return t.DisplayColumn},i.rgbToHex=function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},i.hexToRgb=function(n){var t;return n=n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(n,t,i,r){return t+t+i+i+r+r}),t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},i.isEquals=function(n,t){return i.IsEmpty(n)||i.IsEmpty(t)?i.IsEmpty(n)&&i.IsEmpty(t):n===!0&&(t===1||t==="1")||t===!0&&(n===1||n==="1")||n===!1&&(t===0||t==="0")||t===!1&&(n===0||n==="0")?!1:i.isFuzzyEquals(n,t)},i.isFuzzyEquals=function(n,t){return n==t},i.isQueryEqual=function(t,r){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(r))return!1;try{for(var u in t)if(!i.isFuzzyEquals(t[u],r[u]))return!1}catch(f){return!1}return!0},i.getUniqueNumber=function(){return(new Date).valueOf()},i.isValidateTime=function(n){return/^(?:[01]\d|2[0-3]):[0-5]\d(:[0-5]\d(\.\d{3})?)?$/.test(n)?!0:!1},i.isProcessView=function(n){return n==="ACT_RU_TASK_View"||n==="ACT_HI_TASKINST_View"||n==="ACT_HI_PROCINST_View"},i.isPageContainsTableBinding=function(t,i){if(n.ForguncyData.PageBindingTables){var r=n.ForguncyData.PageBindingTables[t];if(r&&r.length>0)return r.indexOf(i)>=0}return!1},i.htmlEncode=function(n){var t=document.createElement("div"),i=document.createTextNode(n);return t.appendChild(i),t.innerHTML},i.download=function(t){try{n.PageBuilder.isDownloading=!0;var i=document.createElement("a");i.href=t;document.body.appendChild(i);i.click();document.body.removeChild(i)}finally{n.PageBuilder.isDownloading=!1}},i.getElementContentSize=function(n){var t=n.clone(),i;return t.css("display","inline"),t.appendTo("body"),i={width:t.width(),height:t.height()},t.remove(),i},i.isBuiltInDataBaseView=function(t){return n.ForguncyData.pageInfo.ViewInfoList.some(function(n){return n.ViewName===t&&n.IsBuiltin})},i.isView=function(t){return n.ForguncyData.pageInfo.ViewInfoList.some(function(n){return n.ViewName===t})},i.openTab=function(t){var r=n.PageManager.getContainerCell(t),u;r&&(r.cellType instanceof n.TabControlCellType&&(u=r.cellType,u.showTab(u.getTabIndex(t))),i.openTab(r.runTimePageName))},i.scrollToElement=function(n,t){i.openTab(t);var r=n.parents("#placeHolderDiv");r.length>0?(i._scrollPlaceHolderToElement(n,r),i._scrollWindowToElement(n)):i._scrollWindowToElement(n)},i._scrollWindowToElement=function(r){var c=t(window).width(),l=t(window).height(),u=r[0].getBoundingClientRect(),f=u.top<0||u.bottom>l,e=u.left<0||u.right>c;if(f||e){var o=r.offset(),s=f?o.top-i._scrollBufferDistance:undefined,h=e?o.left-i._scrollBufferDistance:undefined;n.DelayRefresh.NeedDelayRun?t("html, body").animate({scrollTop:s,scrollLeft:h},400):window.scrollTo({top:s,left:h})}},i._scrollPlaceHolderToElement=function(n,t){var f;if(t.css("overflow-x")==="auto"){var r=n.offset(),u=t.offset(),e=t.width(),o=r.left<u.left||r.left>=u.left+e;o&&(f=r.left+t.scrollLeft()-u.left-i._scrollBufferDistance,t.scrollLeft(f))}},i.operateODataPost=function(t,r,u,f,e,o){var l;e===void 0&&(e=!0);o===void 0&&(o=null);var h=r,c=function(n){n.Success?u&&(n.Data&&n.Data.$values?u(n.Data.$values):(n.Data===undefined&&(n.Data=null),u(n.Data))):f&&f(n.ErrorMessage)},s=null;f&&(s=function(n){f(n.responseText)});e?i.IsEmpty(o)?n.Common.forguncyPost(t,h,c,null,s):(l="GetOData:"+o,n.Common.forguncyPost(t,h,c,l,s)):n.Common.forguncyPostSync(t,h,c,s)},i.convertMetaDataDefaultValue=function(t,i){return t=n.KeyWords.GetKeyWordValue(t,i),t===undefined?null:t},i.getRunTimePageNameFromFormulaCalcContext=function(t){if(t)if(i.IsEmpty(t.PageID)){if(t.IsInMasterPage)return n.StaticValues.RunTimeMasterPage}else return t.PageID;return n.StaticValues.RunTimeNormalPage},i.remove=function(n,t){if(!n)return!1;var i=n.indexOf(t);return i>=0?(n.splice(i,1),!0):!1},i.getMFADeviceInfo=function(){return new h(i.mfaDeviceLocalStorageKey).GetDeviceInfo()},i.setCookie=function(n){document.cookie=n},i.removeCookie=function(n){var t=new Date;t.setTime(t.getTime()-1);document.cookie=n+";expires="+t.toUTCString()},i.JsonUrlSwitchKeyWords=[["{","A"],['"',"B"],["[","C"],["}","D"],["]","E"],[":","F"],[",","G"],],i.postOrder={},i.uploadUrl=n.ForguncyData.ForguncyRoot+"FileDownloadUpload/Upload",i.uploadImageUrl=n.ForguncyData.ForguncyRoot+"FileDownloadUpload/UploadImage",i.getLowerCaseString=function(n){return n=String(n),n.toLowerCase()},i._scrollBufferDistance=100,i.mfaDeviceLocalStorageKey="25538D1E-3B9A-4E10-9FA2-3D850A47A8A6",i}();n.Common=i;e=function(){function n(){}return n.getBorderWidth=function(n){switch(n){case GC.Spread.Sheets.LineStyle.hair:case GC.Spread.Sheets.LineStyle.thin:case GC.Spread.Sheets.LineStyle.dashDot:case GC.Spread.Sheets.LineStyle.dashDotDot:case GC.Spread.Sheets.LineStyle.dashed:case GC.Spread.Sheets.LineStyle.dotted:return 1;case GC.Spread.Sheets.LineStyle.medium:case GC.Spread.Sheets.LineStyle.mediumDashDot:case GC.Spread.Sheets.LineStyle.mediumDashDotDot:case GC.Spread.Sheets.LineStyle.mediumDashed:case GC.Spread.Sheets.LineStyle.slantedDashDot:return 2;case GC.Spread.Sheets.LineStyle.thick:case GC.Spread.Sheets.LineStyle.double:return 3;default:return 0}},n}();n.SpreadJSHelper=e;r=function(){function t(){}return t.fromDateToOADate=function(t){return n.SpreadJSHelpMethods._DateTimeHelper.___toOADate(t)},t.fromOADateToDate=function(t){return n.SpreadJSHelpMethods._DateTimeHelper._fromOADate(t)},t}();n.Convertor=r;u=function(){function n(){}return n.getToday=function(){var n=new Date;return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n},n.isValidDateValue=function(t){return this.isValidDate(t)?!0:typeof t=="number"?n.isValidDateValue(r.fromOADateToDate(t)):!1},n.isValidDate=function(n){return n instanceof Date&&!isNaN(n.valueOf())},n.adjustDateWith485Timezone=function(n){var t=n.getTimezoneOffset();return t===-485?r.fromDateToOADate(n):n},n}();n.DateHelper=u;o=function(){function t(){}return t.isFormatSetted=function(n){return!i.IsEmpty(n)&&n!=="General"},t.isDateOrTimeFormat=function(n){var f,i,r,e,o,s;if(!t.isFormatSetted(n))return!1;for(f=["#","?","E","%"],i=0,r=f;i<r.length;i++)if(e=r[i],n.indexOf(e)>=0)return!1;return o=new GC.Spread.Formatter.GeneralFormatter(n,null),s=o.parse("2020/1/30"),u.isValidDate(s)},t.isTimeFormat=function(n){var u,i,r,f;if(!t.isDateOrTimeFormat(n))return!1;for(u=["h","s",":","時","分","秒","时","시","분","초"],i=0,r=u;i<r.length;i++)if(f=r[i],n.indexOf(f)>=0)return!0;return!1},t.format=function(n,t){var r=new GC.Spread.Formatter.GeneralFormatter(n,null),i={},u=r.format(t,i);return{text:u,color:i.conditionalForeColor}},t.getValueFromText=function(n,t){if(t===void 0&&(t=null),typeof n!="string")return n;var i={value:null};try{new GC.Spread.Formatter.GeneralFormatter(t,null).getPreferredDisplayFormatter(n,i)}catch(r){return n}return i.value!==null?i.value:n},t.getTextFromValue=function(n,t){var r,u,f;return n instanceof Date?(r=new GC.Spread.Formatter.GeneralFormatter("",null),u=r.getPreferredEditingFormatter(n),n=u.format(n,{})):this.isPercentageFormat(t)&&!i.IsEmpty(n)&&(f=new GC.Spread.Formatter.GeneralFormatter(t,null),n=f.format(n,{})),i.IsEmpty(n)&&(n=""),n},t.isPercentageFormat=function(n){if(n&&n[n.length-1]==="%"){var t=n.substr(0,n.length-1);if(Number(t)===0)return!0}return!1},t.formatValue=function(t,r,u){if(n.Common.IsEmpty(t))return"";if(i.IsEmpty(r)&&t instanceof Date&&(r=n.StaticFormatString.dateTimeDefaultFormattingString),i.IsEmpty(r)||typeof r!="string")return t+"";var f=new GC.Spread.Formatter.GeneralFormatter(r,null);return f.format(t,u)},t}();n.FormatHelper=o;s=function(){function t(){}return t.printJavascriptAIPError=function(i,r,u){try{var f=n.Common.format(n.RS.ForguncyApiExceptionString,"ForguncyApiException",i,r,u);throw new Error(f);}catch(e){t.printError(e)}},t.printError=function(i){var f="",u,o,r;if(i instanceof Error){var h=n.ForguncyData.ForguncyRoot+"Resources/JS.js?v=",s=i.stack+"",e="\n";for(s.indexOf("\r\n")>=0&&(e="\r\n"),u=s.split(e),o=[],r=0;r<u.length;r++)u[r].indexOf(h)===-1&&o.push(u[r]);f=o.join(e)}else f=i+"";t.printErrorStr(f)},t.printErrorStr=function(n){console.error(n)},t}();n.ErrorHelper=s;h=function(){function n(n){this._localStorageKey=n}return n.prototype.GetDeviceInfo=function(){var i,n=[],r,t;for(n.push((i=localStorage.getItem(this._localStorageKey))!==null&&i!==void 0?i:this._localStorageKey),r=navigator.plugins.length,t=0;t<r;t++)n.push(navigator.plugins[t].name);return n.push(this._getCanvasFingerprint()),n.join(",")},n.prototype._getCanvasFingerprint=function(){var i,n,r;try{return i=t("<canvas>")[0],n=i.getContext("2d"),n.font="18pt Arial",n.textBaseline="top",n.fillText("Hello, user.",2,2),r=i.toDataURL("image/jpeg"),r.length}catch(u){return 0}},n}();c=function(){function t(){}return t.getHeight=function(n,t,i,r,u,f){return u===void 0&&(u="国"),f===void 0&&(f=1),this.getWidth(n,t,i,r,u)*f},t.getWidth=function(n,i,r,u,f){var h=t.getFontString(n,i,r,u),e=f+":"+h,c,o,s;return this._cachedSize[e]?this._cachedSize[e]:(this._cachedContext||(c=document.createElement("canvas"),this._cachedContext=c.getContext("2d")),o=this._cachedContext,o.font=h,s=o.measureText(f).width,this._cachedSize[e]=s,s)},t.getFontString=function(t,i,r,u){return[t?t:"normal",i?i:"normal",r+"px",u?u:n.LocaleFonts.default].join(" ")},t._cachedSize={},t}();n.MeasureHelper=c})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.addCSSRules=function(t,i){t.forEach(function(t){n.CellTypeStyleTemplateUtils.AddCSSTextToDocument(t,i)})},t.getCssFontInfoFromCssFontString=function(n){var t=$("<span />"),i,r;return t.css("font",n),i=t.css("lineHeight"),r=t.css("fontVariant"),{fontStyle:t.css("fontStyle"),fontWeight:t.css("fontWeight"),fontSize:t.css("fontSize"),fontFamily:t.css("fontFamily"),lineHeight:i==="normal"?"":i,fontVariant:r==="normal"?"":r}},t.getCssFontStringFromCssFontInfo=function(n){var t="";return Object.keys(n).forEach(function(i){n[i]&&n[i].length&&(t+=n[i]+" ")}),t.trim()},t.getClassName=function(t){var s=Object.keys(t),u,f,h,e,o,i,r,c;if(s.length===0)return null;for(s.sort(),u={},f=0,h=s;f<h.length;f++)e=h[f],t[e]!==undefined&&(u[e]=t[e]);if(o=JSON.stringify(u),this._classCache[o])return this._classCache[o];i="";r="Fgc_"+this._index;this._index++;for(c in u)i+=this.convertCssPropertyName(c)+":"+t[c]+";";return i="."+r+"{"+i+"}",n.CellTypeStyleTemplateUtils.AddCSSTextToDocument(i,r),this._classCache[o]=r,r},t.convertCssPropertyName=function(n){var t,i,u,r,f,e;if(n.toLowerCase()===n)return n;if(this._cssPropertyNameCache[n])return this._cssPropertyNameCache[n];for(t=[],i=0,u=n;i<u.length;i++)r=u[i],f=r.toLowerCase(),f===r?t.push(r):t.push("-"+f);return e=t.join(""),this._cssPropertyNameCache[n]=e,e},t._classCache={},t._index=0,t._cssPropertyNameCache={},t}(),i;n.CSSHelper=t;i=function(){function i(){}return i.getClassName=function(r){var u,f;return n.Common.IsEmpty(r)?"":(u=i.classPrefix+r.toLowerCase(),this._addedClassList.indexOf(u)===-1&&(f="."+u+"{ color: "+r+" !important}",t.addCSSRules([f],u),this._addedClassList.push(u)),u)},i.classPrefix="useFormatColor_",i._addedClassList=["useFormatColor_red"],i}();n.FormatColorClassManager=i})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.isRelationCondition=function(t){return!n.Common.IsEmpty(t.Condition1)||!n.Common.IsEmpty(t.Condition2)||!n.Common.IsEmpty(t.RelationType)},t.enumAllConditions=function(n){if(n){if(t.isRelationCondition(n)){var i=[];return i=i.concat(t.enumAllConditions(n.Condition1)),i.concat(t.enumAllConditions(n.Condition2))}return[n]}return[]},t.getConditionResult=function(n,i,r){var u=t.handlingConditionValue(n,i,r);return t.excuteConditionResult(u,r)},t.handlingConditionValue=function(i,r,u){var f,e,o,s;if(!i)return i;if(t.isRelationCondition(i))return{Condition1:t.handlingConditionValue(i.Condition1,r,u),Condition2:t.handlingConditionValue(i.Condition2,r,u),RelationType:i.RelationType};if(f=n.Common.clone(i),f.value=t.calcValue(f.value,r,u.needUnparseValue2(f)),f.value instanceof Date&&n.DateHelper.isValidDateValue(f.value)){if(e=f.value,t.isDateHaveTimePart(e))return f;if(o=null,s=null,f.compareType){if(f.compareType===1)return o=n.Common.clone(f),s=n.Common.clone(f),o.compareType=4,s.compareType=2,o.value=t.getFirstMomentOfDay(e),s.value=t.getLastMomentOfDay(e),{Condition1:o,Condition2:s,RelationType:1};f.compareType===2?f.value=t.getLastMomentOfDay(e):f.compareType===3?f.value=t.getFirstMomentOfDay(e):f.compareType===4?f.value=t.getFirstMomentOfDay(e):f.compareType===5&&(f.value=t.getLastMomentOfDay(e))}else return o=n.Common.clone(f),s=n.Common.clone(f),o.compareType=3,s.compareType=5,o.value=t.getFirstMomentOfDay(e),s.value=t.getLastMomentOfDay(e),{Condition1:o,Condition2:s,RelationType:0}}return f},t.calcValue=function(i,r,u){return n.Common.IsEmpty(i)?"":i===t.NullValueKeyWord?null:n.KeyWords.IsKeyWord(i)?n.KeyWords.GetKeyWordValue(i,r.runTimePageName):n.FormulaManager.shouldEvaluateFormula(i)?n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i,r):u?n.FormatHelper.getValueFromText(i):i},t.isDateHaveTimePart=function(n){return n.getHours()!==0||n.getMinutes()!==0||n.getSeconds()!==0||n.getMilliseconds()!==0},t.getLastMomentOfDay=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)},t.getFirstMomentOfDay=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)},t.excuteConditionResult=function(i,r){var h,c,f,l,s;if(i===null||i===undefined)return!0;if(t.isRelationCondition(i))return h=t.excuteConditionResult(i.Condition1,r),c=t.excuteConditionResult(i.Condition2,r),i.RelationType?h||c:h&&c;var u=i,e=u.value,o=r.calc(u);if(!u.compareType||u.compareType<6)return t.getNonStringCompareResult(o,u.compareType,e,r);if(u.compareType===12||u.compareType===13){if(f=void 0,n.Common.IsString(e))for(f=!1,l=e.split(",").filter(function(t){return!n.Common.IsEmpty(t)}),s=0;s<l.length;s++)f=f||t.getNonStringCompareResult(o,0,l[s],r);else f=t.getNonStringCompareResult(o,0,e,r);return u.compareType===12?f:!f}return t.getStringCompareResult(o,u.compareType,e)},t.getStringCompareResult=function(n,t,i){var u,f,r;return n===null||n===undefined||i===null||i===undefined?!1:(u=n.toString(),f=i.toString(),t===6)?u.indexOf(f)===0:t===7?u.indexOf(f)!==0:t===8?(r=u.lastIndexOf(f),r>=0&&r+f.length===u.length):t===9?(r=u.lastIndexOf(f),!(r>=0&&r+f.length===u.length)):t===10?(r=u.lastIndexOf(f),r!==-1):t===11?(r=u.lastIndexOf(f),r===-1):!1},t.getNonStringCompareResult=function(i,r,u,f){if(typeof u=="number"&&typeof i=="string"&&!n.Common.IsEmpty(i)){var e=Number(i);isNaN(e)||(i=e)}if(i instanceof Date&&(i=n.Convertor.fromDateToOADate(i)),u instanceof Date&&(u=n.Convertor.fromDateToOADate(u)),i=n.FormulaHelper.adjustNumberPrecision(i),u=n.FormulaHelper.adjustNumberPrecision(u),r){if(r===1)return t.ExceptedValueAndParamValueEmptyEquals(u,i)?!1:!f.equals(i,u);if(r===2)return i>u;if(r===3)return i>=u;if(r===4)return i<u;if(r===5)return i<=u}else return t.ExceptedValueAndParamValueEmptyEquals(u,i)?!0:f.equals(i,u);return!1},t.getComputedSqlConditionFormula=function(i,r,u,f,e,o){if(f===void 0&&(f=0),e===void 0&&(e=0),o===void 0&&(o=null),!i)return null;var h={runTimePageName:r,supportReferToListview:!0,nullAsException:!0,listInfo:o,rowOffset:f,columnOffset:e},s=n.Common.clone(i);return t.computeSqlConditionFormula(s,h,u),s},t.computeSqlConditionFormula=function(i,r,u){var e,f;if(typeof i=="undefined"||i===null)return null;e=i;t.computeSqlConditionFormula(e.Condition1,r,u);t.computeSqlConditionFormula(e.Condition2,r,u);f=i;f.Value!==null&&(""+f.Value).search("=")===0&&(f.Value=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(f.Value,r),n.Common.IsEmpty(f.Value)&&u===n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull&&(f.Value="D212D897-53A6-4450-BBC3-9EB6523B527F"))},t.NullValueKeyWord="%Null%",t.ExceptedValueAndParamValueEmptyEquals=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!0:!1},t}();n.ConditionHelper=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.addDependenceCellValueChangeHandler=function(i,r,u){var o,s,e,f;if(i){for(o=!1,s=function(f,e){i.every(function(i){var f=t.needRefresh(e,i,u);return f?o?void 0:(o=!0,n.DelayOperateHelper.Push(null,function(){o=!1;r(e.arg.uiAction)},1),!1):!0})},n.ForguncyData.pageInfo.dataModel.bind("valuechanged",s),e=n.ForguncyData.pageInfo.dependenceCellValueChangedEventHandlers,e[u]||(e[u]={}),f=(new Date).valueOf().toString();e[u][f];)f="_"+f;return e[u][f]=s,f}return null},t.destoryRunTimePage=function(t){t.forEach(function(t){var r=n.ForguncyData.pageInfo.dependenceCellValueChangedEventHandlers,i=r[t],u;if(i){delete r[t];for(u in i)n.ForguncyData.pageInfo.dataModel.unbind("valuechanged",i[u])}})},t.removeDependenceCellValueChangeHandler=function(t,i){var r,u;n.Common.IsEmpty(t)||n.Common.IsEmpty(i)||(r=n.ForguncyData.pageInfo.dependenceCellValueChangedEventHandlers[i],r)&&(u=r[t],u)&&(delete r[t],n.ForguncyData.pageInfo.dataModel.unbind("valuechanged",u))},t.needRefresh=function(n,i,r){return typeof i=="string"?t.needRefreshCellName(n,i):t.needRefreshCellRange(n,i,r)},t.needRefreshCellName=function(t,i){if(!n.Common.IsEmpty(t.calcName))return!1;var u=t.arg,r=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(u.id);return r&&r.lowerCaseName?r.lowerCaseName.indexOf(i.toLowerCase())>=0:!1},t.needRefreshCellRange=function(i,r,u){var f=t.getLocatedListviewCalcName(r,u);return n.Common.IsEmpty(i.calcName)&&n.Common.IsEmpty(f)?t.needRefreshNormalCellRange(i.arg,r,u):i.calcName===f?t.needRefreshListviewCellRange(f,i.arg,r):!1},t.needRefreshNormalCellRange=function(t,i,r){var u=n.Common.parseIDStr(t.id);return u.suffix===r&&(u.row>=i.Row&&u.row<i.Row+i.RowCount||i.Row===-1||i.RowCount===-1)&&(u.col>=i.Column&&u.col<i.Column+i.ColumnCount||i.Column===-1||i.ColumnCount===-1)},t.needRefreshListviewCellRange=function(t,i,r){if(i.cellRange.Column===-1||i.cellRange.ColumnCount===-1||r.Column===-1||r.ColumnCount===-1)return!0;var f=n.ListviewBase.getListviewByCalcSheetName(t),u=r.Column-f.getContentRangeInfo().Column;return!(u+r.ColumnCount<=i.cellRange.Column||i.cellRange.Column+i.cellRange.ColumnCount<=u)},t.getLocatedListviewCalcName=function(t,i){for(var r,e,u=null,f=t.Row;f<t.Row+t.RowCount;f++)for(r=t.Column;r<t.Column+t.ColumnCount;r++)if(e=n.Common.getLocatedListview(i,f,r),f===t.Row&&r===t.Column)u=e;else if(e!==u)return null;return u===null?null:u.getCalcSheetName()},t}();n.DependenceCellValueChangeHelper=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.register=function(t,i,r){r===void 0&&(r=!0);var u="opacity",e=t.css(u),s="0.5",f="background-color",o=t.css(f),h="gray";t.on("drop",function(){for(var s,l,c=event.dataTransfer.files,h=0;h<c.length;h++){if(s=c[h],s&&s.size===0){alert(n.RS.cantAddEmptyFile);continue}if(l=i(s),!l)break;if(!r)break}return t.css(u,e),t.css(f,o),!1});t.on("dragenter",function(){t.css(u,s);t.css(f,h)});t.on("dragleave",function(){t.css(u,e);t.css(f,o)});t.on("dragover",function(){return!1},!1)},t.unRegister=function(n){n.off("drop");n.off("dragenter");n.off("dragleave");n.off("dragover")},t}();n.DragFileToUploadHelper=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=null,i=function(){function i(){}return i.isChrome=function(){return!this.isOldEdge()&&navigator.userAgent.indexOf("Chrome/")!==-1},i.isOldEdge=function(){return navigator.userAgent.indexOf("Edge/")!==-1},i.isEdge=function(){return navigator.userAgent.indexOf("Edg/")!==-1},i.isIpad=function(){return navigator.userAgent.toLowerCase().indexOf("ipad")!==-1||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},i.isIOSDevice=function(){return/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1},i.isMac=function(){return new RegExp("Mac").test(navigator.userAgent)},i.isIE=function(){return!!window.ActiveXObject||"ActiveXObject"in window?!0:!1},i.isMobile=function(i){return(i===void 0&&(i=!1),!i&&n.ForguncyData.forceMobileChild)?!0:(t===null&&(t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))),t)},i.isAndroid=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("android")>-1||n.indexOf("adr")>-1},i.isQqBrowser=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("qqbrowser")>-1},i.isWechatBrowser=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("micromessenger")>-1},i.isWeChatOrQQBrowser=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("micromessenger")>-1||n.indexOf("qqbrowser")>-1},i}(),r;n.Platform=i;i.isAndroid()&&i.isQqBrowser()&&(r=String.prototype.localeCompare,String.prototype.localeCompare=function(n){return r.apply(this,[n])})})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.init=function(){t._operationList=[]},t.Push=function(n,i,u){var e=new r,f;e.obj=n;e.functions={f:i};f=t.getPriority(u);t._operationList[f]||(t._operationList[f]=[]);t._operationList[f].push(e);t.doOperation()},t.getPriority=function(n){return n===0?0:1},t.doOperation=function(){i.setTimeout(function(){var n,i;if(t.haveNoActiveAjaxCall())if(n=t.getNextOperation(),n){if(i=n.functions.f.apply(n.obj),i instanceof Promise){i.then(function(){t.doOperation()});return}}else return;t.doOperation()})},t.getNextOperation=function(){for(var n=t._operationList.length-1;n>=0;n--)if(t._operationList[n]&&t._operationList[n].length>0)return t._operationList[n].shift();return null},t.haveNoActiveAjaxCall=function(){return jQuery.active===0&&n.ModuleLoader.active===0},t}(),i,r;n.DelayOperateHelper=t;i=function(){function i(){}return i.Init=function(){i._refreshing=!1;i._objectMethods=[]},i.Push=function(n,t,r,u){var o,f,e;for(u===void 0&&(u=!1),o=!1,f=0;f<i._objectMethods.length;f++)if(i._objectMethods[f].obj===n){i._objectMethods[f].functions[r]=t;o=!0;break}o===!1&&(e={obj:n,functions:{}},e.functions[r]=t,u?i._objectMethods=[e].concat(i._objectMethods):i._objectMethods.push(e));i.Refresh()},i.Refresh=function(){i._refreshing||(i._refreshing=!0,i.DelayRun())},i.DelayRun=function(){if(!i.NeedDelayRun||i._isUnitTest){t.haveNoActiveAjaxCall()?i.RunNow():i.setTimeout(function(){i.DelayRun()},0);return}i.setTimeout(function(){t.haveNoActiveAjaxCall()?i.RunNow():i.DelayRun()},50)},i.DisableDelayRun=function(){i.NeedDelayRun=!1;i.DelayRun()},i.HasDelayRunItem=function(){return i._refreshing===!0||i._objectMethods&&i._objectMethods.length!==0},i.RunNow=function(){try{while(i.HasDelayRunItem())i.Run()}finally{i._refreshing=!1}},i.Run=function(){var r=i._objectMethods,n,t,u;for(i._objectMethods=[],i._refreshing=!1,n=0;n<r.length;n++){t=r[n];for(u in t.functions)t.functions[u].apply(t.obj)}},i.setTimeout=function(n,t){return i._executingSetTimeoutCount++,setTimeout(function(){n();i._executingSetTimeoutCount--},t)},i.clearTimeout=function(n){clearTimeout(n);i._executingSetTimeoutCount--},i.HasExecutingSetTimeout=function(){return i._executingSetTimeoutCount>0||n.ModuleLoader.active>0||jQuery.active>0},i._objectMethods=[],i._refreshing=!1,i.NeedDelayRun=!0,i._executingSetTimeoutCount=0,i._isUnitTest=!1,i}();n.DelayRefresh=i;r=function(){function n(){}return n}()})(Forguncy||(Forguncy={}))
;
;var Forguncy;(function(n){var i=function(){function n(){}return n.firstOrDefault=function(n,t){for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return null},n}(),t;n.ArrayHelper=i;t=function(){function n(n,t){var i,r;for(n===void 0&&(n=1),t===void 0&&(t=1),this.width=n,this.height=t,this.data=[],i=0;i<n;i++)for(this.data.push([]),r=0;r<t;r++)this.data[i][r]=undefined}return n.prototype.set=function(n,t,i){return this.data[n][t]=i,this.data[n][t]},n.prototype.get=function(n,t){var i;if((i=this.data[n])!==null&&i!==void 0)return i[t]},n.prototype.forEach=function(n){this.data.forEach(function(t,i){t&&t.forEach(function(t,r){n&&n(t,i,r)})})},n}();n.Array2=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function n(){}return n.Convert=function(n){var t;if(n&&this.ColorCache[n])return this.ColorCache[n];if(t=n,this.IsThemeColor(n)?t=this.GetThemeColor(n):this.IsGradient(n)&&(t=this.GetGradient(n)),t&&t.charAt(0)==="#"&&t.length===9)if(t.indexOf("#FF")===0)t="#"+t.substring(3);else{var i=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),u=parseInt(t.substring(5,7),16),f=parseInt(t.substring(7,9),16);t="rgba("+r+","+u+","+f+","+(i/255).toFixed(2)+")"}return n&&(this.ColorCache[n]=t),t},n.ConvertBorder=function(n){return this.ReplaceCombineCssColor(n)},n.ConvertShadow=function(n){return this.ReplaceCombineCssColor(n)},n.GetRGBNumberString=function(n){var t=this.stringToARGB(n);if(!t)return null;var i=t[0],r=t[1],u=t[2];return"".concat(i,",").concat(r,",").concat(u)},n.ReplaceCombineCssColor=function(t){return t.replace(/((Background|Text)_[12]|Accent_[123456])(_-?[\.\d]{1,3}(_\d{1,3})?)?|#[a-fA-F0-9]+/g,function(t){return n.Convert(t.replace(/_/g," "))})},n.IsGradient=function(n){return n?n.indexOf("linear-gradient")===0||n.indexOf("radial-gradient")===0:!1},n.GetGradient=function(n){return this.ReplaceCombineCssColor(n)},n.GetThemeColor=function(t){var r,i,u,f,e;return t?(r=-1,i=t.split(" "),i&&(i.length>1&&(i[0]==="Background"?(u=Number(i[1]),r=u-1):i[0]==="Text"?(u=Number(i[1]),r=u+1):i[0]==="Accent"&&(u=Number(i[1]),r=u+3)),f=0,i.length>2&&(f=Number(i[2])),e=255,i.length>3&&(e=Number(i[3])),r>-1))?n.UpdateTint(this.Convert(this.Colors[r]),f/100,e):"":""},n.UpdateTint=function(n,t,i){var u,r,e,h,f,o,s;return t===0&&i===255?n:(u="".concat(n," ").concat(t," ").concat(i),u&&this.ColorCache[u])?this.ColorCache[u]:(r=this._getHLSColor(n),t>0?(h=240-r._luminosity,f=h*t,e=r._luminosity+f):(f=r._luminosity*-t,e=r._luminosity-f),o=this._fromHLS(r._hue,e,r._saturation),o.a=i,s=this._toString(o),this.ColorCache[u]=s,s)},n.IsThemeColor=function(n){var t,i;if(!n)return!1;t=this.ThemeColorPrefix;for(i in t)if(n.indexOf(t[i])===0)return!0;return!1},n._toString=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var i=n[0],r=i.a,u=i.r,f=i.g,e=i.b;return(n.length===3&&(r=255,u=n[0],f=n[1],e=n[2]),n.length===4&&(r=n[0],u=n[1],f=n[2],e=n[3]),r===255)?"#"+this._toHexString(u)+this._toHexString(f)+this._toHexString(e):"rgba("+u+","+f+","+e+","+r/255+")"},n._hueToRGB=function(n,t,i){return(i<0&&(i+=240),i>240&&(i-=240),i<40)?n+((t-n)*i+20)/40:i<120?t:i<160?n+((t-n)*(160-i)+20)/40:n},n.saturate=function(n,t,i){return Math.min(parseInt(((this._hueToRGB(n,t,i)*255+120)/240).toString()),255)},n._fromHLS=function(n,t,i){var f,e,o,r,u;return i===0?f=e=o=parseInt((t*255/240).toString(),10):(r=t<=120?parseInt(((t*(240+i)+120)/240).toString()):t+i-parseInt(((t*i+120)/240).toString()),u=2*t-r,f=this.saturate(u,r,n+80),e=this.saturate(u,r,n),o=this.saturate(u,r,n-80)),{a:255,r:f,g:e,b:o}},n.stringToARGB=function(n){var t=this._ctx,i,r;return(t||(i=document.createElement("canvas"),i&&i.getContext&&(t=this._ctx=i.getContext("2d"))),!t)?n:(t.clearRect(1,1,1,1),t.fillStyle=n,t.fillRect(1,1,1,1),r=t.getImageData(1,1,1,1),r)?r.data:null},n._fromString=function(n){var i=0,r=0,u=0,f=0,t;return n&&(t=this.stringToARGB(n),t&&(r=t[0],u=t[1],f=t[2],i=t[3])),{a:i,r:r,g:u,b:f}},n._getHLSColor=function(n){var i=this._fromString(n);return new t(i)},n._toHexString=function(n){var t=n.toString(16);return t.length%2&&(t="0"+t),t},n.Colors=["#FFFFFF","#000000","#EEECE1","#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646"],n.ThemeColorPrefix=["Background 1","Text 1","Background 2","Text 2","Accent 1","Accent 2","Accent 3","Accent 4","Accent 5","Accent 6"],n.ColorCache={},n}(),t;n.ColorHelper=i;t=function(){function n(n){var t=this,f=n.r,e=n.g,o=n.b,r=Math.max(Math.max(f,e),o),s=Math.min(Math.min(f,e),o),u=r+s,i;if(t._luminosity=parseInt(((u*240+255)/510).toString(),10),i=r-s,i===0)t._saturation=0,t._hue=160;else{t._saturation=t._luminosity<=120?parseInt(((i*240+u/2)/u).toString(),10):parseInt(((i*240+(510-u)/2)/(510-u)).toString(),10);var h=((r-f)*40+i/2)/i,c=((r-e)*40+i/2)/i,l=((r-o)*40+i/2)/i;t._hue=f===r?parseInt((l-c).toString(),10):e===r?parseInt((80+h-l).toString(),10):parseInt((160+c-h).toString(),10);t._hue<0&&(t._hue+=240);t._hue>240&&(t._hue-=240)}}return n}()})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var u=function(){function n(n){this.ruleArr=n}return n.prototype.FeedStyle=function(n,t){this.ruleArr.push("".concat(n,":").concat(t,";"))},n.prototype.Digest=function(){this.resultString="{ ".concat(this.ruleArr.join("")," }")},n.prototype.GetResultString=function(){return this.Digest(),this.resultString},n}(),r;n.NormalStyleFeeder=u;var i=function(){function n(n){this.Dom=n}return n.prototype.FeedStyle=function(n,t){this.Dom.css(n,t)},n.prototype.Digest=function(){},n}(),f=function(){function t(n,t,i){this.styleArr=t;this.className=i;this.Dom=n}return t.prototype.FeedStyle=function(n,t){this.styleArr.push("".concat(n,":").concat(t,";"))},t.prototype.Digest=function(){var t=".".concat(this.className," { ").concat(this.styleArr.join("")," }");n.CellTypeStyleTemplateUtils.AddCSSTextToDocument(t,this.className);this.Dom.addClass(this.className)},t}(),t=function(){function t(){}return t.setPropertyToDom=function(n,i,r,u){t._init();for(var f=0;f<u.length;f++)t.funcs[u[f]](n,i,r)},t.setPropertyToClass=function(n,i,r,u){t._initClassMethods();for(var f=0;f<u.length;f++)t.classMethods[u[f]](n,i,r);i.Digest()},t.addCustomCommand=function(t,i,r,u){t.css("cursor","pointer");t.on("click",function(){return u.isDisabled()||n.ForguncyData.commandExcutor.excuteCommand(i,{runTimePageName:u.runTimePageName,commandTrigger:u,commandID:r,eventType:"click"}),!1})},t.measureElementSizes=function(n){var i=n.map(function(n){return n.clone().css("display","inline-block")}),t=$(document.createElement("div")),r;return t.append.apply(t,i),$("#".concat("fgc-page-measure-container")).append(t),r=i.map(function(n){var t=n[0].getBoundingClientRect(),i=t.width+1,r=t.height+1;return{width:i,height:r}}),t.remove(),r},t.measureBrowserScrollbarWidth=function(){var n,t;return this.browserScrollbarWidthCache>=0?this.browserScrollbarWidthCache:(n=document.createElement("div"),n.className="scrollbar-measure",document.body.appendChild(n),t=n.offsetWidth-n.clientWidth,document.body.removeChild(n),this.browserScrollbarWidthCache=t,t)},t.createJqueryDomElement=function(n){return $(document.createElement(n))},t.createAlignmentContainer=function(n,i,r){n.addClass("fgc-align__inner");n.addClass(t.getHorizontalAlignmentClass(i));n.addClass(t.getVerticalAlignmentClass(r));var u=t.createJqueryDomElement("div");return u.addClass("fgc-align"),u.append(n),u},t.createTableContainer=function(n,t){for(var i,r,u=$(document.createElement("table")).append(document.createElement("tbody")).addClass("fgc-table"),e=u.find("tbody"),o=Math.ceil(n/t),f=0;f<o;f++)for(i=$(document.createElement("tr")),e.append(i),r=0;r<t;r++)i.append($(document.createElement("td")));return u},t.createGridContainer=function(n){var t=this.createGridContainerInternal().addClass("fgc-grid"),i=this.repeat("1fr ",n);return t.css("grid-template-columns",i),t},t.setGridRowAndColumn=function(n,t,i){var r=Math.floor(i/t+1).toString(),u=(i%t+1).toString();n[0].style.gridRow=r;n[0].style.gridColumn=u;n[0].style.msGridRow=r;n[0].style.msGridColumn=u},t.repeat=function(n,t){for(var i="",r=0;r<t;r++)i+=n;return i},t.createGridContainerEx=function(n,t){var r,u,i;return n&&(r=n.join(" ")),t&&(u=t.join(" ")),i=this.createGridContainerInternal(),u?i.css("grid-template-columns",u):i.css("grid-template-columns","100%"),r?i.css("grid-template-rows",r):i.css("grid-template-rows","100%"),i},t.setGridItemPos=function(n,t,i,r,u){r===void 0&&(r=1);u===void 0&&(u=1);n.css("grid-column-start",i+"");n.css("grid-row-start",t+"");r>1&&n.css("grid-row-end",t+r);u>1&&n.css("grid-column-end",i+u)},t.createGridContainerInternal=function(){var n=this.createJqueryDomElement("div");return n.css("display","grid"),n},t.createDropDownListForFormUser=function(i,r,u){var o=t.createRelativeContainerDiv(),e=t.createRelativeContainerDiv(),f,s,h,c;return e.append(r),e.attr("data-toggle","_dropdown"),e.attr("id",u.ID+"_dropdown"),o.append(e),f=t.createJqueryDomElement("ul"),i.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Right?f.attr("class","dropdown-menu pull-right"):f.attr("class","dropdown-menu"),f.attr("role","menu"),n.ForguncyData.AuthenticationType===3&&(s=$("<li><a style='text-decoration:none' href='#' id = 'FGX_ChangeProfile' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_ChangeProfile+"<\/a><\/li>"),t.createNavigateCommand(s,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangeUserSettings],"FGX_ChangeProfile",u),f.append(s),h=$("<li><a style='text-decoration:none' href='#' id = 'FGX_ChangePassword' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_ChangePassword+"<\/a><\/li>"),t.createNavigateCommand(h,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangePassword],"FGX_ChangePassword",u),f.append(h),n.ForguncyData.AllowUserChangeMFAStatus&&n.Common.forguncyPostSync("Account/GetMFASettingInfo",null,function(t){if(t.Result){var i=t.Properties.isEnabled,r=i?n.RS.ChangeCurrentUserMFA_Disable:n.RS.ChangeCurrentUserMFA_Enable,u=i?"MFA_Disable":"MFA_Enable",e=$("<li><a style='text-decoration:none' href='#' forguncyattr='"+u+"' id = 'FGX_SwitchMFA' ignoreInMoveFocus='true'>"+r+"<\/a><\/li>");f.append(e)}})),c=$("<li><a style='text-decoration:none' href='#' forguncyattr='Logout:"+u.ID+"' ignoreInMoveFocus='true'>"+n.RS.CurrentUserCell_Logout+"<\/a><\/li>"),f.append(c),n.Platform.isMobile()&&f.find("a").css("padding-top",10).css("padding-bottom",10),o.append(f),o},t.createNavigateCommand=function(n,i,r,u){var f=[{$type:"Forguncy.Model.NavigateCommand, ServerDesignerCommon",PageName:i,navigateType:"normal"}];t.addCustomCommand(n,f,r,u)},t.createAbsoluteContainerDiv=function(){var n=t.createJqueryDomElement("div");return n.addClass("fgc-container-absolute"),n},t.createRelativeContainerDiv=function(){var n=t.createJqueryDomElement("div");return n.addClass("fgc-container-relative"),n},t.createLoadingIndicator=function(){var i=t.createAbsoluteContainerDiv().addClass("indicator").css("display","none").css("top",0),r=t.createAbsoluteContainerDiv().css("background-color","gray").css("opacity",.2).css("top",0),u=t.createAbsoluteContainerDiv().css("background-repeat","no-repeat").css("background-position","center").css("background-image",'url("'+n.ForguncyData.ForguncyRoot+'Resources/Images/SiteBuiltInImages/loading.gif")').css("top",0);return i.append(r),i.append(u),i},t._init=function(){t.inited||(t.funcs[0]=t._initalFont,t.funcs[1]=t._initalIndent,t.funcs[3]=t._initalCommand,t.funcs[4]=t._initalFormatString,t.funcs[2]=t._initalId,t.funcs[5]=t._initalForguncyAttribute,t.funcs[6]=t._initWaterMark,t.inited=!0)},t._initClassMethods=function(){t.classMethodsInited||(t.classMethods[0]=t._initalFontClass,t.classMethods[1]=t._initalIndentClass,t.classMethods[3]=t._initalCommandClass,t.classMethods[4]=t._initalFormatStringClass,t.classMethods[2]=t._initalIdClass,t.classMethods[5]=t._initalForguncyAttributeClass,t.classMethods[6]=t._initWaterMarkClass,t.classMethodsInited=!0)},t._initalFontClass=function(n,i){t.setFontStyleClass(n.StyleInfo,i)},t._initalFont=function(n,i){t.setFontStyle(n.StyleInfo,i)},t.setFontStyle=function(n,r){var u=new i(r);t.setFontStyleClass(n,u)},t._initalIndent=function(n,r,u){var f=new i(r);t._initalIndentClass(n,f,u)},t._initalFormatString=function(n,r,u){var f=new i(r);t._initalFormatStringClass(n,f,u)},t._initalCommand=function(n,r,u){var f=new i(r);t._initalCommandClass(n,f,u)},t._initalForguncyAttribute=function(n,r,u){var f=new i(r);t._initalForguncyAttributeClass(n,f,u)},t._initalId=function(n,t,i){t.attr("id",i.id);t.attr("name",i.id)},t._initWaterMark=function(n,r,u){var f=new i(r);t._initWaterMarkClass(n,f,u)},t.getFontFamily=function(t){return t&&!n.Common.IsEmpty(t.FontFamily)?t.FontFamily:n.LocaleFonts.default?n.LocaleFonts.default:null},t.setFontStyleClass=function(i,r,u){if(u===void 0&&(u=!0),i&&(!u||r.Dom)){var f=t.getFontFamily(i);f&&r.FeedStyle("font-family",'"'+f+'"');i.FontSize!==-1&&(isNaN(i.FontSize)?r.FeedStyle("font-size",i.FontSize):r.FeedStyle("font-size",i.FontSize+"px"));r.FeedStyle("color",n.ColorHelper.Convert(i.Foreground));i.WordWrap?(r.FeedStyle("word-wrap","break-word"),r.FeedStyle("word-break","break-word"),r.FeedStyle("white-space","pre-wrap")):r.FeedStyle("white-space","pre");n.Common.IsEmpty(i.Underline)&&n.Common.IsEmpty(i.Strikethrough)?r.FeedStyle("text-decoration",""):i.Underline&&i.Strikethrough?r.FeedStyle("text-decoration","underline line-through"):i.Underline?r.FeedStyle("text-decoration","underline"):i.Strikethrough?r.FeedStyle("text-decoration","line-through"):r.FeedStyle("text-decoration","");n.Common.IsEmpty(i.FontWeight)?r.FeedStyle("font-weight",""):r.FeedStyle("font-weight",t.getFontWeightText(i.FontWeight));n.Common.IsEmpty(i.FontStyle)?r.FeedStyle("font-style",""):r.FeedStyle("font-style",t.getFontStlyeText(i.FontStyle))}},t._initalIndentClass=function(n,i){var r=n.StyleInfo;r&&t.setTextIndent(r,i)},t.setTextIndent=function(t,i){t.TextIndent&&(t.HorizontalAlignment===n.CellHorizontalAlignment.Left?i.FeedStyle("padding-left",t.TextIndent):t.HorizontalAlignment===n.CellHorizontalAlignment.Right&&i.FeedStyle("padding-right",t.TextIndent))},t._initalFormatStringClass=function(n,t){var i=n.StyleInfo;i&&typeof i.Formatter!="undefined"&&t.Dom.attr("formatString",i.Formatter)},t._initalCommandClass=function(n,t){n.CellType&&n.CellType.CommandList&&t.FeedStyle("cursor","pointer")},t._initalForguncyAttributeClass=function(n,t,i){!i.isInListview&&n.CellType&&n.CellType.ForguncyAttribute&&t.Dom.attr("forguncyattr",n.CellType.ForguncyAttribute)},t._initalIdClass=function(n,t,i){t.Dom.attr("id",i.id);t.Dom.attr("name",i.id)},t._initWaterMarkClass=function(t,i){t&&t.CellType&&!n.Common.IsEmpty(t.CellType.WaterMark)&&(n.Platform.isMobile()&&(t.CellType.$type==="Forguncy.DropDownListCellType, ServerDesignerCommon"||t.CellType.$type==="Forguncy.DateCellType, ServerDesignerCommon"||t.CellType.$type==="Forguncy.TimeCellType, ServerDesignerCommon"||t.CellType.$type==="Forguncy.UserCellType, ServerDesignerCommon")||i.Dom.attr("placeholder",t.CellType.WaterMark))},t.getHorizontalAlignmentText=function(t){switch(t){case n.CellHorizontalAlignment.Left:return"left";case n.CellHorizontalAlignment.Center:return"center";case n.CellHorizontalAlignment.Right:default:return"right"}},t.getHorizontalAlignmentClass=function(t){switch(t){case n.CellHorizontalAlignment.Left:return"fgc-textalign-left";case n.CellHorizontalAlignment.Center:return"fgc-textalign-center";case n.CellHorizontalAlignment.Right:default:return"fgc-textalign-right"}},t.getVerticalAlignmentText=function(t){switch(t){case n.CellVerticalAlignment.Top:return"top";case n.CellVerticalAlignment.Center:return"middle";case n.CellVerticalAlignment.Bottom:default:return"bottom"}},t.getVerticalAlignmentClass=function(t){switch(t){case n.CellVerticalAlignment.Top:return"fgc-verticalalign-top";case n.CellVerticalAlignment.Center:return"fgc-verticalalign-middle";case n.CellVerticalAlignment.Bottom:default:return"fgc-verticalalign-bottom"}},t.getFontStlyeText=function(t){return n.Common.IsEmpty(t)?"":t.toLowerCase()},t.getFontWeightText=function(t){return n.Common.IsEmpty(t)?"":t.toLowerCase()},t.setContainerOverFlow=function(t,i){t.css("overflow",i);(i==="scroll"||i==="auto")&&n.Platform.isIOSDevice()&&t.css("-webkit-overflow-scrolling","touch")},t.applySimpleBar=function(t){return n.MetadataLoader.IsMobile()||n.Platform.isIpad()?null:new SimpleBar(t[0])},t.applyPentrableEvent=function(){$(document).on("click",function(n){var f,i,r,u;if(n.clientX&&n.clientY&&!t.isClickable(n.target)&&(f=document.elementsFromPoint||document.msElementsFromPoint,i=f.call(document,n.clientX,n.clientY),i))for(r=0;r<i.length;r++)if(u=$(i[r]),t.isClickable(u[0])){u.closest(".fgc-clickHandler").triggerHandler("click");break}})},t.isClickable=function(n){return $(n).closest(".fgc-penetrable").length===0},t.SetTextEllipsis=function(n,t,i){i===void 0&&(i=null);t>0&&(n.css({display:"inline-block",overflow:"hidden","max-width":t+"px","text-overflow":"ellipsis","white-space":"pre"}),i!==null&&i())},t.ClearTextEllipsis=function(n,t){t===void 0&&(t=null);n.css({display:"",overflow:"","max-width":"","text-overflow":"","white-space":""});t!==null&&t()},t.funcs={},t.classMethods={},t.inited=!1,t.classMethodsInited=!1,t}();n.DomUtilities=t;r=function(){function i(){}return i.createTextElement=function(i,r,u,f,e,o){var s,c,h;return(f===void 0&&(f=!0),e===void 0&&(e=!0),o===void 0&&(o=!1),s=[1,4,2,3],o||s.push(0),t.setPropertyToDom(i,r,u,s),r.addClass("fgc-whitespace-pre"),e&&i.Value!==undefined&&i.Value!==null&&(c=i.Value,r.append(document.createTextNode(c))),n.Common.typeContains(i.CellType,"HyperlinkCellType")&&(i.RightOverflowSpace>0||i.LeftOverflowSpace>0)||r.css("display","block"),f)?(h=t.createJqueryDomElement("div"),h.append(r),t.createAlignmentContainer(h,i.StyleInfo.HorizontalAlignment,i.StyleInfo.VerticalAlignment)):r},i.createCantSelectLabel=function(){return $("<label style='-moz-user-select: none; -webkit-user-select: none; -ms-user-select:none; user-select:none;' unselectable='on' onselectstart='return false;' onmousedown='return false;'><\/label>")},i.createControlContainer=function(){var n=t.createJqueryDomElement("div");return n.css("width","100%"),n.css("height","100%"),n},i.initalInputBox=function(i,r,u){r.addClass("fgc-inputbox");i.StyleInfo.Background&&r.css("background-color",n.ColorHelper.Convert(i.StyleInfo.Background));t.setPropertyToDom(i,r,u,[0,2,5,6])},i.GenerateInputClassName=function(){var n=(new Date).getTime()+"_"+Math.floor(Math.random()*1e3);return"input_"+n},i.initalInputBoxWithClassName=function(n,r,u){var h=i.GenerateInputClassName(),e=[],o,s;e.push("border:none;");e.push("padding:2px;");e.push("width:100%;");e.push("height:100%;");e.push("position:inherit;");e.push("box-sizing:border-box;");n.StyleInfo.Background&&e.push("background-color:".concat(n.StyleInfo.Background));o=[0,2,5,6];s=new f(r,e,h);t.setPropertyToClass(n,s,u,o)},i.AllInputClassName={},i}();n.CellDomCreateHelper=r})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return Object.defineProperty(t,"emptyImageUrl",{get:function(){return n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/no_image.png"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"emptyUploadImageUrl",{get:function(){return n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/upload_no_image.png"},enumerable:!1,configurable:!0}),t.encodeImageUrl=function(t){var i,r;if(!n.Common.IsEmpty(t)&&typeof t=="string"&&!this.isBase64StringUrl(t)){i=t.indexOf("?");r=void 0;r=i===-1?t.lastIndexOf("/"):t.lastIndexOf("/",i);var u=t.slice(0,r===-1?0:r+1),f=t.slice(r+1,i===-1?undefined:i),e=i===-1?"":t.slice(i);return u+encodeURIComponent(f)+e}return t},t.encodeImageUrlAndUpdateQuery=function(t,r,u){if(!n.Common.IsEmpty(t)&&typeof t=="string"){var o=n.ForguncyData.ForguncyRoot+"Upload/",s=t.toString().indexOf(o)===0,f=t.indexOf("?"),e=f===-1?t.lastIndexOf("/"):t.lastIndexOf("/",f);var h=t.slice(0,e===-1?0:e+1),c=t.slice(e+1,f===-1?undefined:f),l=f===-1?"":t.slice(f),a=s?i.getImageQueryString(r,u):l;return h+encodeURIComponent(c)+a}return t},t.getImageSrcFromCellContentElement=function(i,r,u){var f=null;return f=n.Common.IsEmpty(i.Value)?t.getImageSrcFromElementImagePath(i):t.getImageSrcFromElementValue(i,u),n.Common.isForguncyFile(f)&&(f=t.getUploadImageSrc(f)),f},t.getImageUrlFromImagePath=function(t,i,r){r===void 0&&(r=!1);var u=n.PictureSourceType.Custom;return t&&(u=r?n.PictureSourceType.Theme:n.PictureSourceType.BuiltInIcon),this.getImageUrlBySourceType(u,i)},t.getImageUrlBySourceType=function(t,i){var r="";if(t===n.PictureSourceType.BuiltInIcon)r="Resources/Images/CellTypeBuiltInImage/";else if(t===n.PictureSourceType.Theme)r="Resources/Themes/"+n.ForguncyData.GlobalSettings.ThemeBasePath+"/Images/";else if(t===n.PictureSourceType.BuiltInBackground)r="Resources/Images/BackgroundBuiltInImage/";else return r="GeneratedResources/Images/GenerateImages/ImageCellType/",n.ForguncyData.ForguncyRoot+r+i+"?v="+n.StaticData.MetaDataVersion;return n.ForguncyData.ForguncyRoot+r+i},t.setImageSource=function(i,r){var u,f,e;r||(u=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(i.attr("id")),r=!n.Common.IsEmpty(u)&&u.cellType instanceof n.ImageCellType?t.getImageSrcFromElementImagePath(u.cellType.CellElement):t.emptyImageUrl);i.attr("forguncyImage")?(f=t.getImageUrl(r),i.css("background-image",'url("'+f+'")'),i.css("font-size","0"),t.appendInnerImage(i,f)):(e=t.encodeImageUrl(r),i.attr("src",n.Helper.preProcessImageSrc(e)))},t.getImageUrl=function(i){var r=n.Common.isForguncyFile(i)?t.getUploadImageSrc(i):i,u=t.encodeImageUrl(r);return n.Helper.preProcessImageSrc(u)},t.appendInnerImage=function(n,t){var i=$("<img><\/img>").attr("src",t);i.css("opacity","0");i.addClass("fgc-container-absolute");n.append(i)},t.convertPathToFileName=function(t){if(!n.Common.IsEmpty(t)&&t.toString().indexOf(n.ForguncyData.ForguncyRoot+"Upload/")!==-1){var i=t.toString(),u=i.lastIndexOf("/"),r=i.lastIndexOf("?");return i.slice(u+1,r===-1?undefined:r)}return t},t.convertFileNameToPath=function(t){return n.Common.IsEmpty(t)?null:n.Common.isForguncyFile(t)?n.ForguncyData.ForguncyRoot+"Upload/"+t:t},t.getImageSrcFromElementValue=function(t,r){var u=null,f;return n.Common.isForguncyFile(t.Value)?(f=r?i.getImageQueryString(t.FullWidth,t.FullHeight,t.Value):"",u=t.Value+f):u=t.Value,u},t.getImageSrcFromElementImagePath=function(i){var r=i.CellType,u=r.ImagePath;return n.Common.IsEmpty(u)?r.$type==="Forguncy.ImageCellType, ServerDesignerCommon"?this.emptyImageUrl:this.emptyUploadImageUrl:t.getImageUrlFromImagePath(r.BuiltIn,r.ImagePath,!1)},t.getUploadImageSrc=function(t){return n.ForguncyData.ForguncyRoot+"Upload/"+t},t.isBase64StringUrl=function(n){return n.indexOf("data:")===0?!0:!1},t.preHandleSvg=function(t,i){var v,y,c,e,w,u,l,a,o,r,s,f;t.css("width","100%");t.css("height","100%");v=Number(t.attr("width"));y=Number(t.attr("height"));v&&y&&!t.attr("viewBox")&&(t.attr("width","100%"),t.attr("height","100%"),t.attr("viewBox","0 0 "+v+" "+y));i&&($("*",t).attr("fill",n.ColorHelper.Convert(i)),$("*",t).css("fill",n.ColorHelper.Convert(i)));var p=$("[id]",t),h={},b="_"+Math.random().toString().substring(2);for(u=0;u<p.length;u++)c=p[u].getAttribute("id"),e=h[c],e||(e=c+b,h[c]=e),p[u].setAttribute("id",e);for(w=$("*",t),u=0;u<w.length;u++)for(l=w[u],a=l.attributes,o=0;o<a.length;o++)r=a[o].value,s=a[o].name,(s==="xlink:href"||s==="href")&&r&&r[0]==="#"?(f=h[r.substring(1)],f&&l.setAttribute(s,"#"+f)):r&&r.toLowerCase().indexOf("url(#")===0&&r[r.length-1]===")"&&(f=h[r.substring(5,r.length-1)],f&&l.setAttribute(s,"url(#"+f+")"))},t}(),i,r,u;n.ImageHelper=t;i=function(){function n(){}return n.getImageQueryString=function(n,t,i){i===void 0&&(i=null);var r="?";return i&&i.toString().indexOf("?")>-1&&(r="&"),r+"imageSize="+this.getSuitableImageMode(n,t)},n.getSuitableImageMode=function(n,t){return n<150&&t<150?1:n<400&&t<400?2:0},n}();n.ImageQueryHelper=i;r=function(){function r(){}return r.registerDragFile=function(t,i){n.DragFileToUploadHelper.register(t,function(u){if(!i.isDisabled()&&!i.isReadOnly()){var f=i.CellElement.CellType.UploadImageLimit;n.Common.uploadImageToServer(u,f,n.UploadImageCellType.allowDragFileType,function(n){i.hideUploadingIndicator();r.uploadSuccess(n,t,i)},function(t,r){if(i.hideUploadingIndicator(),t){var u=(r===null||r===void 0?void 0:r.status)===401?n.RS.UnauthorizedUpload:t;alert(u)}},function(){i.showUploadingIndicator()})}},!1)},r.uploadSuccess=function(r,u,f){var e,o;u.empty();r?(u.attr("imagename",r),n.Common.isForguncyFile(r)&&(e=f.CellElement,r=r+i.getImageQueryString(e.FullWidth,e.FullHeight,r)),o=n.ForguncyData.ForguncyRoot+"Upload/"+r,t.setImageSource(u,o)):(u.attr("imagename",""),t.setImageSource(u,null));f.commitValue();f.validate()},r}();n.ImageUploadHelper=r;u=function(){function i(){}return i.CreateImage=function(r,u,f){var e,o,s;return r&&r.Name?(e=void 0,i.IsSvg(r.Name)?(e=n.DomUtilities.createJqueryDomElement("div"),o=t.getImageUrlFromImagePath(r.BuiltIn,r.Name),s=t.encodeImageUrl(o),this.AppendSvg(e,s,r.Color,r.UseCellTypeForeColor,null,f)):(e=n.DomUtilities.createJqueryDomElement("img"),o=t.getImageUrlFromImagePath(r.BuiltIn,r.Name),s=t.encodeImageUrl(o),e.attr("src",s)),e.addClass(n.CSSHelper.getClassName({verticalAlign:"middle",width:u+"px",height:u+"px"})),e):null},i.AppendSvg=function(i,r,u,f,e,o){$.ajax({url:r,success:function(s){var l,h,c;l=typeof s=="string"?s:s.documentElement;h=$(l);c=u;(u||f)&&(c=f?"currentColor":n.ColorHelper.Convert(u));t.preHandleSvg(h,c);h.attr("focusable",!1);e&&e(r)||(i.append(h),i.css("position","relative"),n.StaticData.IsCellTypeExporting||h.addClass("fgc-container-absolute"),o&&o(h))}})},i.GetColoredSvgRectInfo=function(t,r){var e=t+r,o=i.coloredSvgRectInfoCache[e],f,u;return o?o:(u={},u.type="GET",u.url=t,u.async=!1,u.success=function(t){var u=$(t.documentElement),o,s;r&&($("*",u).attr("fill",n.ColorHelper.Convert(r)),$("*",u).css("fill",n.ColorHelper.Convert(r)));o=$("<div/>").append(u.clone()).html();s="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(o)));f={value:s,width:u.width(),height:u.height()};i.coloredSvgRectInfoCache[e]=f},$.ajax(u),f)},i.IsSvg=function(n){return n&&n.length>4&&(n.substr(n.length-4,4).toLowerCase()===".svg"||n.toLowerCase().indexOf(".svg?")>0)},i.coloredSvgRectInfoCache={},i}();n.ImageDataHelper=u})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.AllowMoveFocusByEnterKey=function(i,r){n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.moveFocusByEnter&&i&&!r&&i.keydown(function(i){if(!i.altKey&&!i.ctrlKey&&i.keyCode===13&&!n.PageBuilder.pageIsLoading&&!n.PageBuilder.isLoadingConverShow()){var r=this;n.DelayRefresh.setTimeout(function(){i.shiftKey?t.MoveFocusToPreviousControl(r):t.MoveFocusToNextControl(r)})}})},t.MoveFocusToNextControl=function(n){t.MoveFocus(n,t.getNextIndex)},t.MoveFocusToPreviousControl=function(n){t.MoveFocus(n,t.getPreviousIndex)},t.MoveFocusToFirstElement=function(){var n=t.GetSortedElements();return n.length<=0?!1:(t.SetElementFocus(n[0]),!0)},t.MoveFocus=function(n,i){var r,f,u,e;if(n&&(r=t.GetSortedElements(),!(r.length<2))){for(f=-1,u=0;u<r.length;u++)if(n===r[u].ElementObj){f=u;break}f!==-1&&(e=i(f,r.length),t.SetElementFocus(r[e]))}},t.getNextIndex=function(n,t){return n===t-1?0:n+1},t.getPreviousIndex=function(n,t){return n===0?t-1:n-1},t.GetSortedElements=function(){var i,r,u;return(n.ForguncyData.pageInfo.hasExtraDialog?(i=$(".".concat("FUI-dialog")).not(":hidden").last(),r=!1):(i=$("#".concat("centerDiv_"+n.ForguncyData.pageInfo.pageID)),r=!0),u=t.GetElements(i,r),this.shouldSortElements())?t.SortElements(u):u},t.shouldSortElements=function(){var t,i;if(!((t=n.ForguncyData.pageInfo)===null||t===void 0?void 0:t.enableTabIndex))return!1;for(i in n.ForguncyData.pageInfo.enableTabIndex)return!0;return!1},t.GetElements=function(t,i){var f,e,u,r,o,s;for(i===void 0&&(i=!0),f=[],e=t.find("button,input,a,select,textarea,div[gcuielement='gcSheetFocusElementForTab'],div[tabindex]"),u=0;u<e.length;u++)if(r=e[u],!r.disabled&&!$(r).attr("disabled")&&!$(r).attr("ignoreInMoveFocus")&&r.style.visibility!=="hidden"&&r.style.display!=="none"&&!(r.tabIndex<=-1)&&!$(r).is(":hidden")){if(r.tagName==="DIV"){if(r.getAttribute("gcuielement")==="gcSheetFocusElementForTab"){if(o=n.SpreadJSView.getWorkBookByHost($(r).parent()).getActiveSheet(),o.getRowCount()===0||o.getColumnCount()===0)continue}else if(i)continue}else if(r.tagName==="A"){if($(r).attr("href")===undefined)continue}else if(s=r.getAttribute("isCalculatorButton"),s==="true")continue;(n.Common.IsEmpty(r.id)||r.id[0]!=="a")&&(typeof r.id!="string"||r.id.indexOf("wijspread_toolstrip_")!==0)&&f.push({ElementObj:r,ID:r.id,TabIndex:r.tabIndex})}return f},t.SortElements=function(n){var i,r,f,t,u;if(!n||n.length===0)return n;for(i=[],t=0;t<n.length;t++)r=n[t].TabIndex,i[r]===undefined&&(i[r]=[]),i[r].push(n[t]);for(f=[],t=0;t<i.length;t++)if(i[t]!==undefined)for(u=0;u<i[t].length;u++)f.push(i[t][u]);return f},t.SetElementFocus=function(t){try{if(t.ElementObj.tagName==="DIV"&&t.ElementObj.getAttribute("gcuielement")==="gcSheetFocusElementForTab"){var i=n.SpreadJSView.getWorkBookByHost($(t.ElementObj).parents("[gcuielement='gcSpread']"));i.focus(!0)}else t.ElementObj.focus()}catch(r){}},t}();n.FocusMoveHelper=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){var t=this;this.autoIDInfos={};n.ForguncyData.pageInfo.dataModel.bind("valuechanged",function(n,i){t.onValueChanged(i.arg)})}return t.prototype.getAutoIDInfo=function(n,t){var r=this.autoIDInfos[n],i;return r?(i=r[t],(i===null||i===void 0?void 0:i.isEnabled)?i:null):null},t.prototype.setAutoGeneratedIDsFromMetaData=function(n){var t,i;if(n)for(t in n){this.autoIDInfos[t]||(this.autoIDInfos[t]={});for(i in n[t])this.autoIDInfos[t][i]={isEnabled:!0,id:n[t][i].ID,fields:n[t][i].Fields}}},t.prototype.getBindingInfoGuidAndPageName=function(t,i){for(var r,f=n.ForguncyData.pageInfo.normalCellBindingManager.getRelatedCellIdsByBindingInfo({TableName:t,ColumnName:i}),u=0;u<f.length;u++)if(r=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(f[u]),r===null||r===void 0?void 0:r.bindingInfo)return{guid:r.bindingInfo.GUID,pageName:r.designerPageName};return null},t.prototype.cacheFieldCells=function(){var i=function(i){var f,r,u,e;for(f in t.autoIDInfos[i]){if(r=t.autoIDInfos[i][f],u=t.getBindingInfoGuidAndPageName(i,f),u)r.isEnabled=!0,r.bindingInfoGuid=u.guid,r.pageName=u.pageName;else{r.isEnabled=!1;r.cells=null;continue}(e=r.fields,e)&&(r.cells=e.map(function(t){var u={TableName:i,ColumnName:t},r=n.ForguncyData.pageInfo.normalCellBindingManager.getRelatedCellIdsByBindingInfo(u);return r.length>0?r[0]:null}))}},t=this;for(var r in this.autoIDInfos)i(r)},t.prototype.initAutoGeneratedID=function(t){var i,u,r,f;for(i in this.autoIDInfos)for(u in this.autoIDInfos[i])(r=this.autoIDInfos[i][u],r.isEnabled&&!n.Common.IsEmpty(r.id))&&(f={TableName:i,ColumnName:u},n.ForguncyData.pageInfo.normalCellBindingManager.setValueToBindingCell(f,r.id,t))},t.prototype.onValueChanged=function(t){var u,i,f,r;if(t&&t.id&&!n.Common.IsEmpty(t.newValue)&&!n.Common.IsEmpty(t.newValue)){u=!1;for(i in this.autoIDInfos){if(u)break;for(f in this.autoIDInfos[i])r=this.autoIDInfos[i][f],r.isEnabled&&r.cells&&r.cells.indexOf(t.id)>=0&&(this.updateAutoIdCell(i,f),u=!0)}}},t.prototype.updateAutoIdCell=function(t,i){var r=this,f={TableName:t,ColumnName:i},u=n.ForguncyData.pageInfo.normalCellBindingManager.getRelatedCellIdsByBindingInfo(f).filter(function(n){return r.shouldUpdateAutoId(n)});u.length!==0&&this.getAutoGeneratedID(t,i,!0,function(t){n.Common.IsEmpty(t)||u.forEach(function(i){r.shouldUpdateAutoId(i)&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(i,{newValue:t},7)})})},t.prototype.shouldUpdateAutoId=function(t){var i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel;return i.getValueType(t)===2?!1:!0},t.prototype.getAutoGeneratedID=function(t,i,r,u){var l=this.getFieldsValue(t,i),e,o,f,s,h,c,a;if(this.containEmptyField(l)){u(null);return}if(f=this.getAutoIDInfo(t,i),f?(e=f.bindingInfoGuid,o=f.pageName):(s=this.getBindingInfoGuidAndPageName(t,i),e=s.guid,o=s.pageName),!e||!o){u(null);return}h={bindingInfo:e,pageName:o,values:l};c=function(n){f&&(f.id=n);u&&u(n)};r?(a="GetAutoGeneratedID,"+t+"->"+i,n.Common.forguncyPost("Home/GetAutoGeneratedID",h,c,a)):n.Common.forguncyPostSync("Home/GetAutoGeneratedID",h,c)},t.prototype.containEmptyField=function(t){if(!t)return!1;for(var i in t)if(n.Common.IsEmpty(t[i]))return!0;return!1},t.prototype.getFieldsValue=function(t,i){var u={},r=this.getAutoIDInfo(t,i);return!r||!r.fields||r.fields.length===0?null:(r.fields.forEach(function(t,i){var f=r.cells[i],e=null;n.Common.IsEmpty(f)||(e=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(f));u[t]=e}),u)},t.prototype.updateAutoIDCache=function(n,t,i){var r=this.getAutoIDInfo(n,t);r&&(r.id=i)},t.prototype.getAutoIDByBindingInfo=function(n){if(!n||n.RelationBinding||!this.autoIDInfos[n.TableName])return null;var t=this.autoIDInfos[n.TableName][n.ColumnName];return(t===null||t===void 0?void 0:t.isEnabled)?{id:t.id}:null},t}();n.AutoIDManager=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){this.pageDirtyInfos={};this.cellDirtyInfo={};this.listviewDirtyInfo={};this.valueChangedHanlders={};this._hasLoaded=!1}return Object.defineProperty(t.prototype,"dataModel",{get:function(){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"listviews",{get:function(){return n.ForguncyData.pageInfo.pageElementManager.listviewCollection.listviews},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells()},enumerable:!1,configurable:!0}),t.prototype.getCellDirtyInfo=function(n,t,i){if(i===void 0&&(i=!1),!this.cellDirtyInfo[n])if(i)this.cellDirtyInfo[n]={};else return null;if(!this.cellDirtyInfo[n][t])if(i)this.cellDirtyInfo[n][t]={id:t,defaultValue:null};else return null;return this.cellDirtyInfo[n][t]},t.prototype.setDirtyInfoFromMetaData=function(n){this.setDirtyInfoFromPageSetting(n.PageSettings)},t.prototype.setDirtyInfoFromPageSetting=function(n){var t,i;this.pageDirtyInfos[n.Name]||(this.pageDirtyInfos[n.Name]={shouldCheck:n.ShouldCheckPageDirty,ignoredCells:(t=n.IgnoredDirtyCells)!==null&&t!==void 0?t:[],ignoredListviews:(i=n.IgnoredDirtyListviews)!==null&&i!==void 0?i:[]})},t.prototype.removeDirtyStatus=function(){this.removeCellDirtyStatus();this.removeListviewDirtyStatus();var n=this.getPageDirtyCheckManagerInIframe(!1);n.forEach(function(n){n.removeCellDirtyStatus();n.removeListviewDirtyStatus()})},t.prototype.removeCellDirtyStatus=function(){var r,t,u,i;for(r in this.cellDirtyInfo)if(n.ForguncyData.pageInfo.pageID+""===r)this.cacheCellDefaultValue();else{if(t=this.cellDirtyInfo[r],!t)continue;for(u in t)i=t[u],i&&(i.defaultValue=i.currentValue)}},t.prototype.removeListviewDirtyStatus=function(){var i=this,r=function(r){var f,e,u;if(n.ForguncyData.pageInfo.pageID+""===r)t.listviewDirtyInfo[r]={},t.listviews.forEach(function(n){i.listviewDirtyInfo[r][n.getCalcSheetName()]={ignoreDirty:!0,ignoreChanges:n.buildDetailListviewValues(!1)}});else{if(f=t.listviewDirtyInfo[r],!f)return"continue";for(e in f)u=f[e],u&&(u.ignoreChanges=u.editedValues,u.ignoreDirty=!0)}},t=this;for(var u in this.listviewDirtyInfo)r(u)},t.prototype.boforePageCreate=function(n){switch(n){case 0:this._hasLoaded=!1;this.onNavigate();break;case 2:this.onClosePopup();break;case 1:this.onShowPopup()}},t.prototype.onNavigate=function(){var t,n;this.cellDirtyInfo={};this.listviewDirtyInfo={};for(t in this.valueChangedHanlders)n=this.valueChangedHanlders[t],n&&n.dataModel.unbind("valuechanged",n.handler);this.valueChangedHanlders={}},t.prototype.onClosePopup=function(){var t=n.ForguncyData.pageInfo.pageID,i;t&&(delete this.cellDirtyInfo[t],delete this.listviewDirtyInfo[t],i=this.valueChangedHanlders[t],i&&i.dataModel.unbind("valuechanged",i.handler),delete this.valueChangedHanlders[t])},t.prototype.onShowPopup=function(){this.clearNonexistentCellInfo();this.cacheNormalCellsInfo();this.clearNonexistentListviewInfo();this.cacheListviewInfo()},t.prototype.clearNonexistentCellInfo=function(){var f=this,e=n.ForguncyData.pageInfo.pageElementManager.cells,i=n.ForguncyData.pageInfo.pageID,r=[],u=this.cellDirtyInfo[i],t;if(u){for(t in u)e.getCell(t)||r.push(t);r.forEach(function(n){return delete f.cellDirtyInfo[i][n]})}},t.prototype.cacheNormalCellsInfo=function(){var n=this;this.cells.forEach(function(t){return n.cacheSingleNormalCellInfo(t)})},t.prototype.cacheSingleNormalCellInfo=function(t){var r,i,u;this.shouldCheckNormalCell(t)&&(r=n.ForguncyData.pageInfo.pageID,i=this.getCellDirtyInfo(r,t.id,!0),i.currentValue=this.getCellValue(t.id),i.currentValue!==i.defaultValue&&(u=n.Common.parseIDStr(t.id),i.pageName=n.PageManager.getDesignerPageName(u.suffix,!1),i.id=t.id))},t.prototype.clearNonexistentListviewInfo=function(){var u=n.ForguncyData.pageInfo.pageID,r=[],t=this.listviewDirtyInfo[u],i;if(t){for(i in t)n.ListviewBase.getListviewByCalcSheetName(i)||r.push(i);r.forEach(function(n){return delete t[n]})}},t.prototype.cacheListviewInfo=function(){var n=this;return this.listviews.forEach(function(t){return n.cacheSingleListviewInfo(t)})},t.prototype.cacheSingleListviewInfo=function(t){var i,u,r;this.shouldCheckListview(t)&&(i=n.ForguncyData.pageInfo.pageID,u=t.getCalcSheetName(),this.listviewDirtyInfo[i]||(this.listviewDirtyInfo[i]={}),this.listviewDirtyInfo[i][u]||(this.listviewDirtyInfo[i][u]={}),r=this.listviewDirtyInfo[i][u],r.editedValues=t.buildDetailListviewValues(!1),r.editedValues&&(r.listviewName=t.getListviewName(),r.pageName=n.PageManager.getDesignerPageName(t.runTimePageName,!1)))},t.prototype.onPageLoaded=function(){var r=this,i=function(t,i){if(t.data===n.ForguncyData.pageInfo.pageID)r.onNormalCellValueChanged(i)},t=n.ForguncyData.pageInfo.pageID;this.valueChangedHanlders[t]={dataModel:this.dataModel,handler:i};this.cacheCellDefaultValue();this.listviewDirtyInfo[t]={};this.dataModel.bind("valueortypechanged",t,i);this._hasLoaded=!0},t.prototype.onSubPageLoaded=function(n){this.cacheCellDefaultValue(n)},t.prototype.cacheCellDefaultValue=function(t){var r=this,i;if(t===void 0&&(t=null),i=n.ForguncyData.pageInfo.pageID,t){if(!this.cellDirtyInfo[i])return}else this.cellDirtyInfo[i]={};n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t).forEach(function(n){r.shouldCheckNormalCell(n)&&(r.cellDirtyInfo[i][n.id]={id:n.id,defaultValue:r.getCellValue(n.id)})})},t.prototype.getCellValue=function(t){var r=this.getCellValueFromDataModel(t),i;return r===0&&(i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t),(i===null||i===void 0?void 0:i.cellType)instanceof n.CheckBoxCellType)?null:r},t.prototype.getCellValueFromDataModel=function(t){var i=this.dataModel.getValue(t);return n.Common.IsEmpty(i)?null:i===!0?1:i===!1?0:i instanceof Date?n.Convertor.fromDateToOADate(i):i},t.prototype.onNormalCellValueChanged=function(t){var r=n.ForguncyData.pageInfo.pageID,i=this.getCellDirtyInfo(r,t.id);i&&this.shouldUpdateDefaultValue(t)&&(i.defaultValue=this.getCellValue(t.id))},t.prototype.shouldUpdateDefaultValue=function(t){var i,r;return[2,4,1].indexOf(t.valueType)>=0?!0:(i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t.id),r=n.ForguncyData.pageInfo.autoIDManager.getAutoIDByBindingInfo(i===null||i===void 0?void 0:i.bindingInfo),r&&t.newValue===r.id?!0:void 0)},t.prototype.shouldCancelByPageDirty=function(t,i,r,u,f){var e,o;return(r===void 0&&(r=null),u===void 0&&(u=null),f===void 0&&(f=!0),e=n.ForguncyData.pageDirtyCheckManager.getDirtyElement(t,i),e)?(o=confirm(n.RS.LeaveSiteConfirm),r&&n.ForguncyData.pageDirtyCheckManager.consoleWithNewLog(e,r,o),u&&n.ForguncyData.pageDirtyCheckManager.consoleLog(e,u,o),o?(f&&n.ForguncyData.pageDirtyCheckManager.removeDirtyStatus(),!1):!0):!1},t.prototype.getDirtyElement=function(n,t){var f,r,u,e,i;if(!this._hasLoaded)return null;for(f=this.getPageIDs(n),r=0,u=f;r<u.length;r++)if(e=u[r],i=this.getDirtyElementInSinglePage(e),i)return i;return t&&(i=this.getDirtyElementInTabManager(n),i)?i:null},t.prototype.getDirtyElementInTabManager=function(n){for(var u,i,f=this.getPageDirtyCheckManagerInIframe(n),t=0,r=f;t<r.length;t++)if(u=r[t],i=u.getDirtyElement(!1,!1),i)return i;return null},t.prototype.getPageDirtyCheckManagerInIframe=function(t){for(var i,e,r,u,h=t?$("#centerDiv_"+n.ForguncyData.pageInfo.pageID):n.PageBuilder.pagesContainer,o=h.find("iframe"),s=[],f=0;f<o.length;f++)try{i=o[f].contentWindow;e=(u=(r=i===null||i===void 0?void 0:i.Forguncy)===null||r===void 0?void 0:r.ForguncyData)===null||u===void 0?void 0:u.pageDirtyCheckManager;e&&s.push(e)}catch(c){}return s},t.prototype.getPageIDs=function(t){var i=t?[]:n.ForguncyData.pageInfoStack.map(function(n){return n.pageID});return i.push(n.ForguncyData.pageInfo.pageID),i},t.prototype.getDirtyElementInSinglePage=function(n){return this.getDirtyCell(n)||this.getDirtyListview(n)},t.prototype.getDirtyCell=function(t){return n.ForguncyData.pageInfo.pageID===t?this.getDirtyCellOfCurrentPage(t):this.getDirtyCellOfParentPage(t)},t.prototype.getDirtyCellOfCurrentPage=function(n){for(var t,u=this.cells,i=0,r=u;i<r.length;i++)if(t=r[i],this.cacheSingleNormalCellInfo(t),this.isCellDirty(n,t.id))return this.cellDirtyInfo[n][t.id];return null},t.prototype.getDirtyCellOfParentPage=function(n){var t=this.cellDirtyInfo[n],i;if(!t)return null;for(i in t)if(this.isCellDirty(n,i))return t[i];return null},t.prototype.isCellDirty=function(n,t){var i=this.getCellDirtyInfo(n,t);return i?i.defaultValue!==i.currentValue:!1},t.prototype.getDirtyListview=function(t){return n.ForguncyData.pageInfo.pageID===t?this.getDirtyListviewOfCurrentPage(t):this.getDirtyListviewOfParentPage(t)},t.prototype.getDirtyListviewOfCurrentPage=function(n){var f,t,i,r,u;if(this.listviewDirtyInfo[n]){for(f=this.listviews,t=0,i=f;t<i.length;t++)if(r=i[t],this.cacheSingleListviewInfo(r),u=this.listviewDirtyInfo[n][r.getCalcSheetName()],this.isListviewDirty(u))return u;return null}},t.prototype.getDirtyListviewOfParentPage=function(n){var t=this.listviewDirtyInfo[n],r,i;if(!t)return null;for(r in t)if(i=t[r],this.isListviewDirty(i))return i;return null},t.prototype.isListviewDirty=function(n){return(n===null||n===void 0?void 0:n.editedValues)?n.ignoreDirty&&n.ignoreChanges&&JSON.stringify(n.editedValues)===JSON.stringify(n.ignoreChanges)?!1:!0:!1},t.prototype.shouldCheckListview=function(t){var i,r=n.PageManager.getDesignerPageName(t.runTimePageName,!1);return((i=this.pageDirtyInfos[r])===null||i===void 0?void 0:i.shouldCheck)&&this.pageDirtyInfos[r].ignoredListviews.indexOf(t.getListviewName())===-1},t.prototype.shouldCheckNormalCell=function(t){var r,u,i,f,e;return((r=t===null||t===void 0?void 0:t.cellType)===null||r===void 0?void 0:r.shouldCheckDirtyWhenLeavePage())?(i=n.Common.parseIDStr(t.id),f=n.PageManager.getDesignerPageName(i.suffix,!1),!((u=this.pageDirtyInfos[f])===null||u===void 0?void 0:u.shouldCheck))?!1:(e=this.pageDirtyInfos[f].ignoredCells.some(function(n){return n.Row===i.row&&n.Column===i.col}),e)?!1:!0:!1},t.prototype.consoleWithNewLog=function(t,i,r){if(n.StaticData.IsDebugMode&&t){var u=new n.CommandLogHelper;u.tryStartNewRoot();u.log(i);u.startChild();this.consoleLog(t,u,r);u.endChild();u.consoleLog()}},t.prototype.consoleLog=function(t,i,r){var f,e,o;if(n.StaticData.IsDebugMode&&t){if(f="",r!==null&&(f=" "+(r?n.RS.Boolean_True:n.RS.Boolean_False)),i.log(n.RS.LeaveSiteConfirm+f),i.startChild(),e=t,e.listviewName)o=n.Common.format(n.RS.LeaveSiteConsoleMessage_Listview,t.pageName+"->"+e.listviewName),i.log(o);else{var u=t,s=n.FormulaHelper.getReferenceStringByID(u.id),h=n.Common.format(n.RS.LeaveSiteConsoleMessage_Cell,u.pageName+"->"+s);i.log(h);i.startChild();i.log(n.Common.format(n.RS.LeaveSiteConsoleMessage_Cell_DefaultValue,u.defaultValue));i.log(n.Common.format(n.RS.LeaveSiteConsoleMessage_Cell_CurrentValue,u.currentValue));i.endChild()}i.endChild()}},t}();n.PageDirtyCheckManager=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=null,i=undefined,r=function(){function n(){}return n.___toOADate=function(r){return r===i||r===t?0:(typeof r=="number"&&(r=new Date(r)),(r.getTime()*1440+3181192704e6-n._getTimezoneOffset(r)*864e5)/124416e6)},n._fromOADate=function(t){if(t instanceof Date)return t;var r=t-25569,u=new Date(r*864e5),f=r>=0?1:-1,i=new Date((t*124416e6+f-3181192704e6+n._getTimezoneOffset(u)*864e5)/1440);return i.getMilliseconds()===999?new Date(i.valueOf()+1):i},n._getTimezoneOffset=function(n){var t=n.getTimezoneOffset();return t===-485&&(t=-485-43/60),t===-321&&(t=-321-10/60),t===-507&&(t=-507-52/60),t},n}();n._DateTimeHelper=r})(t=n.SpreadJSHelpMethods||(n.SpreadJSHelpMethods={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var y="undefined",s="number",h="string",e="boolean",p="TRUE",w="FALSE",i=null,u=undefined,b=Math.abs,f="InvalidCastException",o=function(){function n(){}return n.getReg=function(t){var i=n.regDict[t];return i||(i=n.regDict[t]=new RegExp(t,"g")),i.lastIndex=0,i},n.getRegIgnoreCase=function(t){var i=n.regDictIgnoreCase[t];return i||(i=n.regDictIgnoreCase[t]=new RegExp(t,"gi")),i.lastIndex=0,i},n.getWildcardCriteria=function(i){if(n.wildcardParseRecord[i])return n.wildcardParseResultBuffer[i];if(n.getReg("[~?*]+").test(i)){var r=i,u=n.getReplaceSymbol("asterisk",r),f=n.getReplaceSymbol("question",r),e=n.getReplaceSymbol("tilde",r);return r=t.replace(r,"~~",e),r=t.replace(r,"~*",u),r=t.replace(r,"~?",f),r=r.replace(n.getReg("([.+$^\\[\\](){}|/])"),"\\$1"),r=t.replace(r,"*",".*"),r=t.replace(r,"?","."),r=t.replace(r,u,"\\*"),r=t.replace(r,f,"\\?"),r=t.replace(r,e,"~"),n.wildcardParseResultBuffer[i]=r,n.wildcardParseRecord[i]=!0,r}return null},n.getWildcardCriteriaFullMatch=function(t){var i=n.getWildcardCriteria(t);return i&&(i="^"+i+"$"),i},n.getReplaceSymbol=function(n,i){for(var r="#"+n+"0#",u=1;u<1e4;u++){if(i.indexOf(r)>0){r=t.replace(r,"#"+n+(u-1)+"#","#"+n+u+"#");continue}return r}},n.regDict={},n.regDictIgnoreCase={},n.wildcardParseRecord={},n.wildcardParseResultBuffer={},n}(),t,r,c,l,a,v;n.RegUtil=o;t=function(){function n(){}return n.replace=function(n,t,i){return n.split(t).join(i)},n}();n.StringUtil=t;r=function(){function t(){}return t.num=function(n,t){return typeof n===s||n instanceof Date||!t&&(typeof n===e||!isNaN(n)&&!isNaN(parseFloat(n)))},t._isNaNOrInfinite=function(n){return isNaN(n)||!isFinite(n)},t.I=function(n){var i=t.D(n);if(b(i)<1e21)return parseInt(i,10);throw f;},t.D=function(n){var i={value:0};if(t.rD(n,i))return i.value;throw f;},t.rD=function(r,u){var f=i,o,a,c,l;if(!r)return u.value=0,!0;o=typeof r;try{if(o===s)f=r;else if(o===h){if(r=r.trim(),r.length===0)return u.value=0,!0;if(a=!1,r.charAt(r.length-1)==="%"&&(a=!0,r=r.substr(0,r.length-1)),r.length>=2&&r[0]==="0"&&r[1]==="x")return!1;if(f=Number(r),t._isNaNOrInfinite(f)){if((c=r.charCodeAt(0),c|=32,r.length>4&&c>=96&&c<=122&&(l=r[0]+r[1]+r[2],l=l.toUpperCase(),!t.monthStrings[l]))||r[0]==="/"||r[r.length-1]==="/"||(f=new Date(r),t._isNaNOrInfinite(f.valueOf())))return!1;f=n._DateTimeHelper.___toOADate(f)}a&&(f/=100)}else if(o===e)f=r?1:0;else if(r instanceof Date)f=n._DateTimeHelper.___toOADate(r);else return!1}catch(v){return!1}return u.value=f,!0},t.arr=function(n){return n instanceof GC.Spread.CalcEngine.CalcArray},t.S=function(r){try{if(typeof r===y||r===i)return"";if(typeof r===e)return r?p:w;if(typeof r===h)return r;if(r instanceof Date)return n._DateTimeHelper.___toOADate(r).toString();if(t.arr(r))throw f;else return r.toString()}catch(u){throw f;}},t.monthStrings={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},t}();n.Convert=r;c=function(){function n(){}return n._argumentExists=function(t,i){return t&&i<t.length&&t[i]!==n.missingArgument},n.missingArgument={},n}();n._Helper=c;l=function(){function n(){}return n._buildCriteria=function(n,t){var f,l,e,s,a,c,h,v;switch(n){case 0:f=function(n,t){return n<=t};e=function(n,t){return n<=t};break;case 1:f=function(n,t){return n>=t};e=function(n,t){return n>=t};break;case 2:f=function(n,t){return n!==t};e=function(n,t){return n!==t};break;case 3:f=function(n,t){return n<t};e=function(n,t){return n<t};break;case 4:f=function(n,t){return n===t};e=function(n,t){return n===t};s=o.getWildcardCriteriaFullMatch(t);s&&(a=o.getRegIgnoreCase(s),l=function(n){return a.lastIndex=0,a.test(n)});break;case 5:f=function(n,t){return n>t};e=function(n,t){return n>t};break;default:return function(){return!1}}c=-1;h=!0;try{v={value:0};t===u||t===i?c=0:s?h=!1:r.rD(t.toString(),v)?c=v.value:h=!1}catch(y){h=!1}return function(n){if((n===u||n===i)&&(n=""),h)try{var o={value:0};if(r.rD(n,o))return e(o.value,c)}catch(a){}return s&&l?l(n.toString()):f(n.toString().toUpperCase(),t!==u&&t!==i?t.toString().toUpperCase():"")}},n._parseCriteria=function(t){var s=t,e=n.criteriaCaches,f,c,l;if(e||(n.criteriaCaches=e={}),f=e[s],f)return f;if(r.num(t))return e[s]=n._buildCriteria(4,t);var o=t!==u&&t!==i?t.toString().toUpperCase():"",h='\0';for(c=0;c<2&&c<o.length;c++)if(l=o[c],"=><".indexOf(l)!==-1){if(l==="="){switch(h){case"<":f=n._buildCriteria(0,o.substring(2));break;case">":f=n._buildCriteria(1,o.substring(2));break;default:f=n._buildCriteria(4,h==='\0'?o.substring(1):t)}return e[s]=f,f}if(h==='\0'){h=l;continue}if(h==="<")return f=l===">"?n._buildCriteria(2,o.substring(2)):n._buildCriteria(3,o.substring(1)),e[s]=f,f;if(h===">")return e[s]=f=n._buildCriteria(5,o.substring(1)),f}else switch(h){case"<":return e[s]=f=n._buildCriteria(3,o.substring(1)),f;case">":return e[s]=f=n._buildCriteria(5,o.substring(1)),f}return f=n._buildCriteria(4,t),e[s]=f,f},n}();n._MathHelper=l;a=function(){function n(){}return n.getPreferredZIndex=function(n){for(var t=n,i,r;t&&t.parentElement&&t.parentElement!==document.body;)t=t.parentElement;return i=1e3,t&&t.parentElement===document.body&&(r=parseInt($(t).css("z-index")),isNaN(r)||(i+=r)),i},n.getLinearGradientColors=function(n){var s,u,h,t,c;if(!n)return[];var y=n.indexOf("("),p=n.lastIndexOf(")"),i=n.substring(y+1,p);if(!i)return[];for(var e=[],o=0,l="";0<i.length;)s=i.indexOf("rgb",o),u=i.indexOf("rgb",o+1),u===-1&&(u=i.length),l=i.substring(s,u),e.push(l),o=s=u;for(h=[],t=0,c=e.length;t<c;t++){var f=e[t],a=f.indexOf(")"),v=f.substring(0,a+1),r=parseFloat(f.substring(a+1,f.length));(isNaN(r)&&(t===c-1?r=100:t<=1&&(r=0)),v||t!==0)&&(r=r/100,h.push({color:v,point:r}))}return h},n}();n.util=a;v=function(){function n(){}return n.paintBackground=function(t,i,r,u,f,e,o,s,h,c,l,a){(c===void 0&&(c=0),l===void 0&&(l=0),a===void 0&&(a=null),e||o)&&(t.save(),t.beginPath(),e&&(t.fillStyle!==e&&(t.fillStyle=e),t.fillRect(i,r,u,f)),a&&(i=a.x,r=a.y,u=a.width,f=a.height),n.paintBackgroundImage(t,i,r,u,f,o,s,h,c,l),t.restore())},n.paintBackgroundImage=function(n,t,i,r,u,f,e,o,s,h){s===void 0&&(s=0);h===void 0&&(h=0);var d=o._getState||o.ko,g=o._getImage||o.lo,nt=o._addImage||o.fo;if(f&&f!=="none"&&o)try{if(d.call(o,f)){var w=g.call(o,f),c=w.width||s,l=w.height||h,a=c,v=l,y=r,p=u,b=t,k=i;e===1?(a=r>=c?c:r,v=u>=l?l:u,b=r>c&&c>0?Math.ceil(t+r/2-c/2):t,k=u>l&&l>0?Math.ceil(i+u/2-l/2):i,y=a,p=v):e===2?u>0&&l>0&&r/u>c/l?(y=c/l*u,b=t+r/2-y/2):r>0&&c>0&&u/r>l/c&&(p=l/c*r,k=i+u/2-p/2):e===3&&(a=r>=c?c:r,v=u>=l?l:u,y=a,p=v);n.drawImage(w,0,0,a,v,b,k,y,p)}else nt.call(o,f)}catch(tt){}},n}();n.CellTypeContext=v})(t=n.SpreadJSHelpMethods||(n.SpreadJSHelpMethods={}))})(Forguncy||(Forguncy={}))
;(function(){function u(n){return!!n.exifdata}function v(n,t){var i;t=t||n.match(/^data\:([^\;]+)\;base64,/mi)[1]||"";n=n.replace(/^data\:([^\;]+)\;base64,/gmi,"");var r=atob(n),u=r.length,f=new ArrayBuffer(u),e=new Uint8Array(f);for(i=0;i<u;i++)e[i]=r.charCodeAt(i);return f}function y(n,t){var i=new XMLHttpRequest;i.open("GET",n,!0);i.responseType="blob";i.onload=function(){(this.status==200||this.status===0)&&t(this.response)};i.send()}function p(n,t){function f(i){var r=s(i),u=w(i);n.exifdata=r||{};n.iptcdata=u||{};t&&t.call(n)}var e,r,u;n.src?/^data\:/i.test(n.src)?(e=v(n.src),f(e)):/^blob\:/i.test(n.src)?(u=new FileReader,u.onload=function(n){f(n.target.result)},y(n.src,function(n){u.readAsArrayBuffer(n)})):(r=new XMLHttpRequest,r.onload=function(){if(this.status==200||this.status===0)f(r.response);else throw"Could not load image";r=null},r.open("GET",n.src,!0),r.responseType="arraybuffer",r.send(null)):window.FileReader&&(n instanceof window.Blob||n instanceof window.File)&&(u=new FileReader,u.onload=function(n){i&&console.log("Got file of length "+n.target.result.byteLength);f(n.target.result)},u.readAsArrayBuffer(n))}function s(n){var r=new DataView(n),t,f,u;if(i&&console.log("Got file of length "+n.byteLength),r.getUint8(0)!=255||r.getUint8(1)!=216)return i&&console.log("Not a valid JPEG"),!1;for(t=2,f=n.byteLength;t<f;){if(r.getUint8(t)!=255)return i&&console.log("Not a valid marker at offset "+t+", found: "+r.getUint8(t)),!1;if(u=r.getUint8(t+1),i&&console.log(u),u==225)return i&&console.log("Found 0xFFE1 marker"),d(r,t+4,r.getUint16(t+2)-2);t+=2+r.getUint16(t+2)}}function w(n){var u=new DataView(n),t,f,e;if(i&&console.log("Got file of length "+n.byteLength),u.getUint8(0)!=255||u.getUint8(1)!=216)return i&&console.log("Not a valid JPEG"),!1;for(var r=2,o=n.byteLength,s=function(n,t){return n.getUint8(t)===56&&n.getUint8(t+1)===66&&n.getUint8(t+2)===73&&n.getUint8(t+3)===77&&n.getUint8(t+4)===4&&n.getUint8(t+5)===4};r<o;){if(s(u,r))return t=u.getUint8(r+7),t%2!=0&&(t+=1),t===0&&(t=4),f=r+8+t,e=u.getUint16(r+6+t),b(n,f,e);r++}}function b(n,t,i){for(var s=new DataView(n),r={},h,u,c,l,a,o=t;o<t+i;)s.getUint8(o)===28&&s.getUint8(o+1)===2&&(l=s.getUint8(o+2),l in e&&(c=s.getInt16(o+3),a=c+5,u=e[l],h=f(s,o+5,c),r.hasOwnProperty(u)?r[u]instanceof Array?r[u].push(h):r[u]=[r[u],h]:r[u]=h)),o++;return r}function o(n,t,r,u,f){for(var c=n.getUint16(r,!f),h={},e,s,o=0;o<c;o++)e=r+o*12+2,s=u[n.getUint16(e,!f)],!s&&i&&console.log("Unknown tag: "+n.getUint16(e,!f)),h[s]=k(n,e,t,r,f);return h}function k(n,t,i,r,u){var y=n.getUint16(t+2,!u),s=n.getUint32(t+4,!u),h=n.getUint32(t+8,!u)+i,c,o,v,e,l,a;switch(y){case 1:case 7:if(s==1)return n.getUint8(t+8,!u);for(c=s>4?h:t+8,o=[],e=0;e<s;e++)o[e]=n.getUint8(c+e);return o;case 2:return c=s>4?h:t+8,f(n,c,s-1);case 3:if(s==1)return n.getUint16(t+8,!u);for(c=s>2?h:t+8,o=[],e=0;e<s;e++)o[e]=n.getUint16(c+2*e,!u);return o;case 4:if(s==1)return n.getUint32(t+8,!u);for(o=[],e=0;e<s;e++)o[e]=n.getUint32(h+4*e,!u);return o;case 5:if(s==1)return l=n.getUint32(h,!u),a=n.getUint32(h+4,!u),v=new Number(l/a),v.numerator=l,v.denominator=a,v;for(o=[],e=0;e<s;e++)l=n.getUint32(h+8*e,!u),a=n.getUint32(h+4+8*e,!u),o[e]=new Number(l/a),o[e].numerator=l,o[e].denominator=a;return o;case 9:if(s==1)return n.getInt32(t+8,!u);for(o=[],e=0;e<s;e++)o[e]=n.getInt32(h+4*e,!u);return o;case 10:if(s==1)return n.getInt32(h,!u)/n.getInt32(h+4,!u);for(o=[],e=0;e<s;e++)o[e]=n.getInt32(h+8*e,!u)/n.getInt32(h+4+8*e,!u);return o}}function f(t,i,r){var u="";for(n=i;n<i+r;n++)u+=String.fromCharCode(t.getUint8(n));return u}function d(n,t){var h,v,u,e,y,s,p;if(f(n,t,4)!="Exif")return i&&console.log("Not valid EXIF data! "+f(n,t,4)),!1;if(s=t+6,n.getUint16(s)==18761)h=!1;else if(n.getUint16(s)==19789)h=!0;else return i&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;if(n.getUint16(s+2,!h)!=42)return i&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(p=n.getUint32(s+4,!h),p<8)return i&&console.log("Not valid TIFF data! (First offset less than 8)",n.getUint32(s+4,!h)),!1;if(v=o(n,s,s+p,l,h),v.ExifIFDPointer){e=o(n,s,s+v.ExifIFDPointer,c,h);for(u in e){switch(u){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":e[u]=r[u][e[u]];break;case"ExifVersion":case"FlashpixVersion":e[u]=String.fromCharCode(e[u][0],e[u][1],e[u][2],e[u][3]);break;case"ComponentsConfiguration":e[u]=r.Components[e[u][0]]+r.Components[e[u][1]]+r.Components[e[u][2]]+r.Components[e[u][3]]}v[u]=e[u]}}if(v.GPSInfoIFDPointer){y=o(n,s,s+v.GPSInfoIFDPointer,a,h);for(u in y){switch(u){case"GPSVersionID":y[u]=y[u][0]+"."+y[u][1]+"."+y[u][2]+"."+y[u][3]}v[u]=y[u]}}return v}var i=!1,h=this,t=function(n){if(n instanceof t)return n;if(!(this instanceof t))return new t(n);this.EXIFwrapped=n},e;typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=t),exports.EXIF=t):h.EXIF=t;var c=t.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},l=t.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},a=t.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},r=t.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};e={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};t.getData=function(n,t){return(n instanceof Image||n instanceof HTMLImageElement)&&!n.complete?!1:(u(n)?t&&t.call(n):p(n,t),!0)};t.getTag=function(n,t){if(u(n))return n.exifdata[t]};t.getAllTags=function(n){if(!u(n))return{};var t,i=n.exifdata,r={};for(t in i)i.hasOwnProperty(t)&&(r[t]=i[t]);return r};t.pretty=function(n){if(!u(n))return"";var t,i=n.exifdata,r="";for(t in i)i.hasOwnProperty(t)&&(r+=typeof i[t]=="object"?i[t]instanceof Number?t+" : "+i[t]+" ["+i[t].numerator+"/"+i[t].denominator+"]\r\n":t+" : ["+i[t].length+" values]\r\n":t+" : "+i[t]+"\r\n");return r};t.readFromBinaryFile=function(n){return s(n)};typeof define=="function"&&define.amd&&define("exif-js",[],function(){return t})}).call(this)
;var Forguncy;(function(n){var f,e,t,i,r,u,o,s;(function(n){n.MasterPage="MasterPage";n.ChangePassword="ChangePassword";n.ForgetPassword="ForgetPassword";n.ChangeUserSettings="ChangeUserSettings";n.Login="Login";n.ResetPasswordMailSended="ResetPasswordMailSended";n.ResetPassword="ResetPassword";n.Pag401="Pag401";n.MaintenancePage="MaintenancePage";n.MailSubscriptPage="MailSubscriptPage";n.MFA_ScanBarcodePage="MFA_ScanBarcodePage";n.MFA_VerifyCodePage="MFA_VerifyCodePage"})(f=n.BuiltInPageType||(n.BuiltInPageType={})),function(n){n[n.None=0]="None";n[n.Custom=1]="Custom";n[n.Insert=2]="Insert";n[n.Delete=3]="Delete";n[n.Duplicate=4]="Duplicate"}(e=n.ContextMenuOperationType||(n.ContextMenuOperationType={}));t=function(){function n(){}return n}();n.DataValidationInfo=t;i=function(){function n(){}return n}();n.TableDataCache=i;r=function(){function n(){}return n}();n.ValueAndFormatPair=r;u=function(){function n(){}return n}();n.OffsetConditionInfo=u,function(n){n[n.None=0]="None";n[n.MouseWheel=1]="MouseWheel";n[n.SpinButton=2]="SpinButton";n[n.UpDownKeys=4]="UpDownKeys";n[n.All=7]="All"}(o=n.SpinType||(n.SpinType={})),function(n){n[n.Custom=0]="Custom";n[n.BuiltInIcon=1]="BuiltInIcon";n[n.Theme=2]="Theme";n[n.BuiltInBackground=3]="BuiltInBackground"}(s=n.PictureSourceType||(n.PictureSourceType={}))})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t=function(){function n(){this._events=[]}return n.prototype.bind=function(n,t,i){arguments.length===2&&(i=t,t=undefined);this._events.push({eventType:n,data:t,fn:i})},n.prototype.unbind=function(n,t){for(var r,u=arguments.length===1||t===undefined,f=this._events.length,i=f-1;i>=0;i--)r=this._events[i],r.eventType===n&&(u||r.fn===t)&&this._events.splice(i,1)},n.prototype.unbindAll=function(){this._events=[]},n.prototype.isEventHasBeenBinding=function(n){for(var i,r=this._events.length,t=0;t<r;t++)if(i=this._events[t],i.eventType===n)return!0;return!1},n.prototype.trigger=function(n){for(var i,r=this,u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];i=[];this._events.forEach(function(t){var u,f;r.isFunction((u=t.eventType)===null||u===void 0?void 0:u.toLowerCase)&&r.isFunction(n===null||n===void 0?void 0:n.toLowerCase)&&((f=t.eventType)===null||f===void 0?void 0:f.toLowerCase())===(n===null||n===void 0?void 0:n.toLowerCase())&&i.push(t)});i.forEach(function(n){n.fn.apply(n,__spreadArray([{data:n.data===undefined?null:n.data}],u,!1))})},n.prototype.isFunction=function(n){return Object.prototype.toString.call(n)==="[object Function]"},n}();n.EventClassBase=t})(Forguncy||(Forguncy={}))
;var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var e=function(){function i(){this.paramStack=[];this.paramToReference=[];this.paramStack.push({});this.paramToReference.push({})}return i.prototype.setValue=function(i,r,u){var f,e;if(u===void 0&&(u=t.commandLogHelper),r=r!==null&&r!==void 0?r:null,f=r+"",typeof r=="object")try{f=JSON.stringify(r)}catch(o){}u&&(e=n.Common.format(n.RS.ServerCommandLog_CreateParam,i,f),u.isRootActive?u.log(e):console.log(e));this.getCurrent()[i]=r},i.prototype.getValue=function(n){return this.getCurrent()[n]},i.prototype.clearCommandParams=function(){this.paramStack=[{}];this.paramToReference=[{}]},i.prototype.push=function(){this.paramStack.push({});this.paramToReference.push({})},i.prototype.pop=function(){this.paramStack.pop();this.paramToReference.pop()},i.prototype.getCurrent=function(){return this.paramStack[this.paramStack.length-1]},i.prototype.ParamToReference=function(t){var r=t,o=!1,f,u,e,i;if(r&&r.length>0&&r[0]==="="&&(r=r.substring(1),o=!0),f=this.getCurrentParamToExpression(),f&&t)try{if(u=n.FormulaHelper.parse(t),e=new n.UpdateParamReferVisitor(f),u=e.visit(u,0,0),e.Updated&&(i=n.FormulaHelper.unparse(u),i))return i[0]!=="="&&o&&(i="="+i),i}catch(s){return t}return t},i.prototype.SetParamToReference=function(n,t){var i=this.getCurrentParamToExpression();i&&(i[n]=t)},i.prototype.NeedUpdateReference=function(t){var i,u,r;return(t&&t.length>0&&t[0]==="="&&(t=t.substring(1)),!t)?!1:(i=this.getCurrentParamToExpression(),i&&t)?(u=n.FormulaHelper.parse(t),r=new n.UpdateParamReferVisitor(i),r.visit(u,0,0),r.Updated):!1},i.prototype.getCurrentParamToExpression=function(){return this.paramToReference.length===0?null:this.paramToReference[this.paramToReference.length-1]},i}(),i,r,t,u,f,o,s,h;n.ParameterManager=e;i=function(){function n(){this.children=[]}return n.prototype.initStartTime=function(){return this.startTime=new Date,this},n}();r=function(){function t(){this.logRootStack=[];this.suspendCount=0;this.isRootActive=!1}return t.prototype.tryStartNewRoot=function(){this.isRootActive||(this.logRootStack=[(new i).initStartTime()],this.isRootActive=!0)},t.prototype.getStackLength=function(){return this.logRootStack.length},t.prototype.suspend=function(){this.suspendCount+=1},t.prototype.resume=function(){this.suspendCount-=1},t.prototype.startChild=function(){if(n.StaticData.IsDebugMode){var t=this.getCurrentLogRoot().children;this.logRootStack.push(t[t.length-1].initStartTime())}},t.prototype.endChild=function(){n.StaticData.IsDebugMode&&this.logRootStack.pop()},t.prototype.log=function(t){var r,u;n.StaticData.IsDebugMode&&(r=this.getCurrentLogRoot(),r&&(u=new i,u.logText=t,r.children.push(u)))},t.prototype.logDuring=function(){var n=this.getCurrentLogRoot();n&&(n.logText+=this.getDuring())},t.prototype.logGroupedText=function(n){for(var l,h,u,f=n.trim().split("\r\n"),a=f.length,e=0,t=0;t<a;t++){var c=f[t],o=c.trim(),s=f[t+1],i=c.search(/\S/),r=(u=s===null||s===void 0?void 0:s.search(/\S/))!==null&&u!==void 0?u:0;if(t===0||r>i)this.log(o),this.startChild(),e++;else if(r===i)this.log(o);else if(r<i)for(this.log(o),l=(i-r)/4,h=0;h<l;h++)this.endChild(),e--}while(e-->0)this.endChild()},t.prototype.consoleLog=function(t){(t===void 0&&(t=!0),n.StaticData.IsDebugMode)&&(this.suspendCount>0||(n.Platform.isChrome()&&!n.MetadataLoader.loadVConsole()?this.consoleGroupedLog(this.logRootStack[0],0):this.consolePlainTextLog(this.logRootStack[0],""),t&&console.log(""),this.logRootStack=[],this.isRootActive=!1))},t.prototype.consoleGroupedLog=function(n,t){var u,f,i,r;for(n!==this.logRootStack[0]&&(t<=2?console.group((u=n.logText)!==null&&u!==void 0?u:""):console.groupCollapsed((f=n.logText)!==null&&f!==void 0?f:"")),i=0;i<n.children.length;i++)r=n.children[i],r.children.length===0?console.log(r.logText):this.consoleGroupedLog(r,t+1);n!==this.logRootStack[0]&&console.groupEnd()},t.prototype.consolePlainTextLog=function(n,t){var r,i;for(n!==this.logRootStack[0]&&(console.log((r=t+n.logText)!==null&&r!==void 0?r:""),t=t+"    "),i=0;i<n.children.length;i++)this.consolePlainTextLog(n.children[i],t)},t.prototype.getCurrentLogRoot=function(){return this.logRootStack[this.logRootStack.length-1]},t.prototype.getDuring=function(){var t=this.getCurrentLogRoot().startTime,i=new Date,r=i.getTime()-t.getTime();return" "+n.Common.format(n.RS.UseTime,r)},t}();n.CommandLogHelper=r;t=function(){function t(){}return t.Init=function(){n.ForguncyData.forceMobileChild||(n.ForguncyData.forceMobileChild=n.Common.GetUrlQuery("mobileChild")==="true"||n.MetadataLoader.IsInMobileSimulatorFrame());n.ForguncyData.pageInfo=new f;n.ForguncyData.userInfo=new u;n.ForguncyData.commandExcutor=new n.CommandExcutor;n.ForguncyData.pageInfoStack=[];n.DelayOperateHelper.init();n.ForguncyData.pageingInfoList=new n.PageingInfoList;n.ListviewBase.init();n.PageBuilder.init();t.pageDirtyCheckManager=new n.PageDirtyCheckManager;n.HubManager.Init();"scrollRestoration"in history&&(history.scrollRestoration="manual")},t.initGlobalSettings=function(i){t.IsAutoTest=i.IsAutoTest;t.AuthenticationType=i.AuthenticationType;t.SecurityProviderValidateType=i.SecurityProviderValidateType;t.PageBindingTables=JSON.parse(i.PageBindingTables||null)||{};var r=JSON.parse(i.ThemeData);n.ColorHelper.Colors=r.Colors;n.ColorHelper.ColorCache={};t.GlobalSettings=JSON.parse(i.GlobalSetting);t.GlobalSettings.ThemeFont=r.EnFontFamily;t.GlobalSettings.ThemeBasePath=r.ThemeBasePath;t.GlobalSettings.ListViewTemplates=JSON.parse(i.ListViewStyleTemplates);this.fillDefaultValuesOfListviewTemplate();t.GlobalSettings.CellTypeStyleTemplates=JSON.parse(i.CellTypeStyleTemplates);t.GlobalSettings.HasWorkflow=i.HasWorkflow;t.GlobalSettings.HasProcess=i.HasProcess;t.GlobalSettings.PageUIPermissions=t.parsePageUIPermissions(i.PageUIPermissions);t.GlobalSettings.CommandsDependenceModels=JSON.parse(i.CommandsDependenceModels);n.BuiltInPageManager.builtInPages=JSON.parse(i.BuiltInPages)},t.parsePageUIPermissions=function(t){if(n.Common.IsEmpty(t))return null;var i=JSON.parse(t).PageUIPermissions;return!i||Object.getOwnPropertyNames(i).length===0?null:i},t.fillDefaultValuesOfListviewTemplate=function(){var r=new n.ListViewStyleTemplate,i;if(t.GlobalSettings.ListViewTemplates)for(i=0;i<t.GlobalSettings.ListViewTemplates.length;i++)t.GlobalSettings.ListViewTemplates[i]=__assign(__assign({},r),t.GlobalSettings.ListViewTemplates[i])},t.updatePopupCoverVisbility=function(n){var i,r,u;if(n)i=this.pageInfo.dialogUI,i&&i.target.displayMode!==1&&t.pageInfoStack.forEach(function(n){n.dialogUI&&n.dialogUI.cover.css("opacity","0")});else if(i=this.pageInfo.dialogUI,i)if(i.target.displayMode!==1)i.cover.css("opacity","");else for(r=t.pageInfoStack.length-1;r>=0;r--)if(u=t.pageInfoStack[r],u.dialogUI&&u.dialogUI.target.displayMode!==1){u.dialogUI.cover.css("opacity","");break}},t.getRelatedTableWithForeignKey=function(n){var i=[];return t.getRelatedTablesWithForeignKeyInternal(n,i),i},t.initListviewPaginationInfo=function(i,r,u){var f=n.ListviewBase.getLocationString(i,r);t.pageingInfoList.Init(f,u)},t.getRelatedTablesWithForeignKeyInternal=function(i,r){if(!n.Common.IsEmpty(n.ForguncyData.pageInfo.PrimaryTableForeignKeyInfo)&&!n.Common.IsEmpty(n.ForguncyData.pageInfo.PrimaryTableForeignKeyInfo[i])){var u=n.ForguncyData.pageInfo.PrimaryTableForeignKeyInfo[i];u.forEach(function(n){r.indexOf(n)===-1&&(r.push(n),t.getRelatedTablesWithForeignKeyInternal(n,r))})}},t.getPageInfo=function(n){var i,r,u;if(t.pageInfo.pageID===n)return t.pageInfo;if(t.pageInfoStack)for(i=0,r=t.pageInfoStack;i<r.length;i++)if(u=r[i],u.pageID===n)return u;return null},t.ForguncyRoot=n.StaticData.ForguncyRoot,t.UserProfileAvatorVersion="",t.parameterManager=new e,t.commandLogHelper=new r,t}();n.ForguncyData=t;u=function(){function t(){this._requestPropertyValueCache={}}return Object.defineProperty(t.prototype,"UserName",{get:function(){return this._userName},set:function(t){this._userName=t;n.HubManager.UpdateUserName()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OrganizationSuperior",{get:function(){return this._organizationSuperiorSet||this.RequestUserInfo(),this._organizationSuperior},set:function(n){this._organizationSuperior=n;this._organizationSuperiorSet=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Properties",{get:function(){return this._propertiesSet||this.RequestUserInfo(),this._properties},set:function(n){this._properties=n;this._propertiesSet=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"OrganizationLevelValues",{get:function(){return this._organizationLevelValuesSet||this.RequestUserInfo(),this._organizationLevelValues},set:function(n){this._organizationLevelValues=n;this._organizationLevelValuesSet=!0},enumerable:!1,configurable:!0}),t.prototype.RequestUserInfo=function(){var t=this;this.UserName&&n.Common.forguncyPostSync("Account/GetDetailUserInfo",null,function(n){t.OrganizationLevelValues=n.OrganizationLevelValues;t.OrganizationSuperior=n.OrganizationSuperior;t.Properties=n.Properties})},t.prototype.GetCustomPropertyValue=function(t){var f=this,i,r,u;if(!this.UserName)return{Find:!1,Value:null};if(this._requestPropertyValueCache[t])return this._requestPropertyValueCache[t];if(this._propertiesSet){if(this._properties)for(i=0;i<this._properties.length;i++)if(r=this._properties[i],r.PropertyName===t)return{Find:!0,Value:r.Value};return{Find:!1,Value:null}}return n.Common.forguncyPostSync("Account/GetCustomPropertyValue",{propertyName:t},function(n){u=n;f._requestPropertyValueCache[t]=n}),u},t}();n.UserInfoImp=u;f=function(){function i(){this.columnFilterQueryCache={};this.pageLayouts={};this.allowZoomScreen=!1;this.moveFocusByEnter=!1;this.extraDialogCount=0}return Object.defineProperty(i.prototype,"hasExtraDialog",{get:function(){return this.extraDialogCount&&this.extraDialogCount>0},enumerable:!1,configurable:!0}),i.getCurrentPageInfo=function(){var r=n.ForguncyData.pageInfo,t=new i;return t.pageElementManager=r.pageElementManager,t.commandQuerys=r.commandQuerys,t.sortInfoCache=r.sortInfoCache,t.columnFilterQueryCache=r.columnFilterQueryCache,t.formulaManager=r.formulaManager,t.dataModel=r.dataModel,t.currentRowInfoCollection=r.currentRowInfoCollection,t.normalCellBindingManager=r.normalCellBindingManager,t.pageName=r.pageName,t.masterPageName=r.masterPageName,t.pageID=r.pageID,t.enableTabIndex=__assign({},r.enableTabIndex||{}),t.ReturnUrl=r.ReturnUrl,t.noPermissionPage=r.noPermissionPage,t.PrimaryTableForeignKeyInfo=r.PrimaryTableForeignKeyInfo,t.ViewInfoList=r.ViewInfoList,t.pageStretchInfos=r.pageStretchInfos,t.pageLayouts=r.pageLayouts,t.defaultFormulaManager=r.defaultFormulaManager,t.dependenceCellValueChangedEventHandlers=r.dependenceCellValueChangedEventHandlers,t.dialogUI=r.dialogUI,t.extraDialogCount=r.extraDialogCount,t.isPopup=r.isPopup,t.allowZoomScreen=r.allowZoomScreen,t.autoIDManager=r.autoIDManager,n.Page._pushCurrentState(),t},i.setCurrentPageInfo=function(t){var i=n.ForguncyData.pageInfo;i.pageElementManager=t.pageElementManager;i.commandQuerys=t.commandQuerys;i.sortInfoCache=t.sortInfoCache;i.columnFilterQueryCache=t.columnFilterQueryCache;i.formulaManager=t.formulaManager;i.dataModel=t.dataModel;i.currentRowInfoCollection=t.currentRowInfoCollection;i.normalCellBindingManager=t.normalCellBindingManager;i.pageName=t.pageName;i.masterPageName=t.masterPageName;i.pageID=t.pageID;i.enableTabIndex=__assign({},t.enableTabIndex||{});i.ReturnUrl=t.ReturnUrl;i.noPermissionPage=t.noPermissionPage;i.PrimaryTableForeignKeyInfo=t.PrimaryTableForeignKeyInfo;i.ViewInfoList=t.ViewInfoList;i.pageStretchInfos=t.pageStretchInfos;i.pageLayouts=t.pageLayouts;i.defaultFormulaManager=t.defaultFormulaManager;i.dependenceCellValueChangedEventHandlers=t.dependenceCellValueChangedEventHandlers;i.dialogUI=t.dialogUI;i.extraDialogCount=t.extraDialogCount;i.isPopup=t.isPopup;i.allowZoomScreen=t.allowZoomScreen;i.autoIDManager=t.autoIDManager;n.Page._popupState()},i.prototype.releaseDialog=function(){this.dialogUI&&(this.dialogUI.target.dispose(),this.dialogUI=null)},i.prototype.appendExtralPopup=function(n){var i=t.pageInfo.pageID;t.pageInfo.extraDialogCount+=1;n.on("Dispose",function(){var n=t.getPageInfo(i);n&&(n.extraDialogCount-=1)})},i.prototype.getSortInfoWithBinding=function(n){var t=this.sortInfoCache[n],i;return(t===null||t===void 0?void 0:t.sortInfo)?(i=t.sortInfo.filter(function(n){return!!n.ColumnBindingInfo}),i.length===0?null:i):null},i.prototype.getFilterInfoWithBinding=function(n){var i=this.columnFilterQueryCache[n],t;return i?(t=i.filter(function(n){return!!n.ColumnBindingInfoID}),t.length===0?null:t):null},i}();n.PageInfo=f;o=function(){function i(){}return i.getRunTimePageName=function(i){switch(i){case t.pageInfo.pageName:return n.StaticValues.RunTimeNormalPage;case t.pageInfo.masterPageName:return n.StaticValues.RunTimeMasterPage;default:var r=t.pageInfo.pageElementManager.cells.getAllContainerCells().map(function(n){return n.cellType.getRunTimePageName(i)}).filter(function(n){return n});return r.length>0?r[0]:null}},i.getRunTimeNormalPageName=function(t){return t[0]===n.StaticValues.RunTimeNormalPage?t:n.StaticValues.RunTimeNormalPage+t.substr(1)},i.getDesignerPageName=function(r,u){switch(r){case n.StaticValues.RunTimeNormalPage:return t.pageInfo.pageName;case n.StaticValues.RunTimeMasterPage:return u?t.pageInfo.pageName:t.pageInfo.masterPageName;default:var f=i.getContainerCell(r);return f?f.cellType.getDesignerPageName(r,u):t.pageInfo.pageName}},i.isNormalCellID=function(t){var i=n.Common.parseIDStr(t);return i&&i.suffix&&i.suffix.length>0&&(i.suffix[0]===n.StaticValues.RunTimeMasterPage||i.suffix[0]===n.StaticValues.RunTimeNormalPage)},i.isMasterPageName=function(t){return t&&t.length>0&&t[0]===n.StaticValues.RunTimeMasterPage},i.getPageStretchInfo=function(n){return t.pageInfo.pageStretchInfos?t.pageInfo.pageStretchInfos[n]:null},i.getPageLayout=function(n){return t.pageInfo.pageLayouts[n]},i.whetherExistPageStretch=function(n){var r,i,t,u;for(t in n.pageStretchInfos)if(r=n.pageStretchInfos[t],r.StretchMode!==0)return!0;i=n.pageLayouts;for(t in i)if(u=i[t],u.possibleStretch())return!0;return!1},i.getLocationString=function(t){var r;switch(t){case n.StaticValues.RunTimeNormalPage:return n.ForguncyData.pageInfo.pageName;case n.StaticValues.RunTimeMasterPage:return n.ForguncyData.pageInfo.masterPageName;default:if(r=i.getContainerCell(t),r){var u=r.cellType,f=u.getDesignerPageName(t,!1),e=u.getTabIndex(t);return i.getLocationString(r.runTimePageName)+","+r.row+","+r.column+","+e+","+f}return n.Common.getUniqueNumber()+""}},i.getLocatedNormalPageNames=function(t){var r,u;switch(t){case n.StaticValues.RunTimeNormalPage:case n.StaticValues.RunTimeMasterPage:return[n.ForguncyData.pageInfo.pageName];default:return r=i.getContainerCell(t),r?(u=r.cellType.getDesignerPageName(t,!0),i.getLocatedNormalPageNames(r.runTimePageName).concat([u])):[]}},i.getContainerCell=function(n){return t.pageInfo.pageElementManager.cells.getContainerCell(n)},i.isPageIsLoading=function(t){if(t===n.StaticValues.RunTimeNormalPage||t===n.StaticValues.RunTimeMasterPage)return n.PageBuilder.pageIsLoading;var r=i.getContainerCell(t);return r?r.cellType.isLoading():!1},i.getSubRunTimePageNames=function(r,u){if(u===void 0&&(u=null),n.Common.IsEmpty(r))return[];u||(u=t.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}).map(function(n){return n.cellType}));var f=[];return u.length>0&&u.forEach(function(n){n.runTimePageName===r&&n.subPageInfos.forEach(function(n){n&&(f.push(n.runTimeNormalPageName),f.push(n.runTimeMasterPageName),i.getSubRunTimePageNames(n.runTimeNormalPageName,u).forEach(function(n){return f.push(n)}))})}),f},i.getAllRunTimePageNames=function(n){if(!n)return null;var t=n.runTimeNormalPageName,r=n.runTimeMasterPageName;return __spreadArray(__spreadArray([r,t],i.getSubRunTimePageNames(r),!0),i.getSubRunTimePageNames(t),!0)},i}();n.PageManager=o;s=function(){function t(){}return t.getBindingValueKeyStr=function(n){return"".concat(n.lookupColumnBindingInfo.GUID,",").concat(n.resultColumnBindingInfo.GUID,",").concat(n.itemQueryStr)},t.getCachedBindingValue=function(n){var i,f=t.getBindingValueKeyStr(n),u=(i=t._bindingValueCache[f])===null||i===void 0?void 0:i.data,r;return u?(r=u[t.converCacheValueKey(n.lookupValue)],r===undefined?t.CannotFindValue:r):t.CannotFindValue},t.setCachedBindingValue=function(n,i){var u=t.getBindingValueKeyStr(n),f=t._bindingValueCache[u],r;f?r=f.data:(t.cacheRelatedTables(n.lookupColumnBindingInfo),t.cacheRelatedTables(n.resultColumnBindingInfo),r={},t._bindingValueCache[u]={guids:[n.lookupColumnBindingInfo.GUID,n.resultColumnBindingInfo.GUID],data:r});i.forEach(function(n){r[t.converCacheValueKey(n[0])]=n[1]})},t.converCacheValueKey=function(t){return t instanceof Date?n.ConvertDateToOADate(t):t},t.cacheRelatedTables=function(i){var f,u,r;if(!t._bindingAndTablesRelation[i.GUID]){if(f=n.Common.isView(i.TableName),u={},!f)for(u[i.TableName]=!0,r=i.RelationBinding;r;){if(!r.RelatedTable)break;if(n.Common.isView(r.RelatedTable)){f=!0;break}u[r.RelatedTable]=!0;r=r.NextRelationBinding}f&&(u={"*":!0});t._bindingAndTablesRelation[i.GUID]=u}},t.cacheComboboxText=function(i,r,u){var f,o,e,s,h,a,c,l,v;for(u=n.Common.IsEmpty(u)?(new Date).valueOf().toString():u,f=0;f<i.data.length;f++){for(o=i.cacheKeys[f],e=0,s=i.data[f].queryAndValues;e<s.length;e++)h=s[e],o.itemQueryStr=JSON.stringify(h.query),t.updateRequestCacheAndCallbackCache(o,h,r,u);i.data[f].queryAndValues=i.data[f].queryAndValues.filter(function(n){return n.values.length>0})}(a=i.data.some(function(n){return n.queryAndValues.length>0}),a)&&(c=i.cacheKeys,delete i.cacheKeys,l=function(){t.setCache([],i,c,!0)},v="Home/GetMultiComboBindingOptions",n.Common.forguncyPost(v,i,function(n){t.setCache(n,i,c,!0)},"GetMultiComboBindingOptions_"+(new Date).valueOf(),l,l))},t.setCache=function(n,i,r,u){for(var e,o,s,h,c,f=0;f<i.data.length;f++)for(e=r[f],o=0;o<i.data[f].queryAndValues.length;o++)s=i.data[f].queryAndValues[o],e.itemQueryStr=JSON.stringify(s.query),h=n[f]?(c=n[f][o])!==null&&c!==void 0?c:[]:[],t.setReversedCachedBindingValue(e,h),t.fillComboBindingOptions(h,s.values),t.setCachedBindingValue(e,h),u&&t.clearRequestCacheAndCallbackCache(e,s)},t.updateRequestCacheAndCallbackCache=function(n,i,r,u){var o=t.getBindingValueKeyStr(n),e,s,h,c,f;if(r)for(t._callBackCache[u]||(t._callBackCache[u]={data:{}}),t._callBackCache[u].callBack=r,e=t._callBackCache[u].data[o],e||(e={},t._callBackCache[u].data[o]=e),s=0,h=i.values;s<h.length;s++)c=h[s],e[c]=!0;f=t._requestCache[o];f&&(i.values=i.values.filter(function(n){return!f[n]}));i.values.length>0&&(f||(f={},t._requestCache[o]=f),i.values.forEach(function(n){return f[n]=!0}))},t.clearRequestCacheAndCallbackCache=function(i,r){var u=t.getBindingValueKeyStr(i),f=t._requestCache[u],e,o,s;f&&(r.values.forEach(function(n){return delete f[n]}),Object.getOwnPropertyNames(f).length===0&&delete t._requestCache[u]);e=[];o=function(n){var i=t._callBackCache[n];i.data[u]&&(r.values.forEach(function(n){return delete i.data[u][n]}),Object.getOwnPropertyNames(i.data[u]).length===0&&delete i.data[u]);Object.getOwnPropertyNames(i.data).length===0&&e.push(n)};for(s in t._callBackCache)o(s);e.forEach(function(i){n.DelayRefresh.setTimeout(t._callBackCache[i].callBack);delete t._callBackCache[i]})},t.setReversedCachedBindingValue=function(n,i){var r=i.map(function(n){return[n[1],n[0]]}),u={lookupColumnBindingInfo:n.resultColumnBindingInfo,resultColumnBindingInfo:n.lookupColumnBindingInfo,itemQueryStr:n.itemQueryStr,lookupValue:null};t.setCachedBindingValue(u,r)},t.lookupComboboxResultFromCache=function(i,r,u,f,e){var o;if(r instanceof n.WrongParseResult)return{result:t.CannotFindValue,cannotFindValues:[]};if(o=[r],i.AllowMultiSelect){if(n.Common.IsEmpty(r))return{result:"",cannotFindValues:[]};o=(r+"").split(",").filter(function(t){return!n.Common.IsEmpty(t)})}var l=JSON.stringify(null),a=JSON.stringify(u),s=[],h=o.map(function(n){f.itemQueryStr=a;f.lookupValue=n;var i=t.getCachedBindingValue(f);return i===t.NoneExistentValue&&e&&u&&(f.itemQueryStr=l,i=t.getCachedBindingValue(f)),i===t.CannotFindValue&&s.push(n),i}),c=t.CannotFindValue;return s.length===0&&(c=h.length>1?h.filter(function(n){return n!==t.NoneExistentValue}).join(","):h[0]),{result:c,cannotFindValues:s}},t.lookupComboboxResultSync=function(i,r,u,f,e,o,s){var a=t.lookupComboboxResultFromCache(i,r,u,o,s),h=a.cannotFindValues,c;if(h.length===0)return a.result;if(f)return t.CannotFindValue;c=[{query:u,values:h}];u&&c.push({query:null,values:h});var l={pageName:e,data:[{lookupColumnBindingInfo:o.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:o.resultColumnBindingInfo.GUID,queryAndValues:c}]},v=function(n){for(var i=[],r=0;r<l.data.length;r++)i.push(o);t.setCache(n,l,i,!1)};return n.Common.forguncyPostSync("Home/GetMultiComboBindingOptions",l,function(n){v(n)},function(){v([])}),t.lookupComboboxResultSync(i,r,u,!0,e,o,s)},t.lookupComboboxResultAsync=function(n,i,r,u,f,e,o,s){var l=t.lookupComboboxResultFromCache(n,i,r,f,s),h=l.cannotFindValues,c,a;return h.length===0?l.result:(c=[{query:r,values:h}],r&&c.push({query:null,values:h}),a={pageName:u,data:[{lookupColumnBindingInfo:f.lookupColumnBindingInfo.GUID,resultColumnBindingInfo:f.resultColumnBindingInfo.GUID,queryAndValues:c}],cacheKeys:[f]},t.cacheComboboxText(a,e,o),t.CannotFindValue)},t.fillComboBindingOptions=function(i,r){var f,e,s,o,h,c,l,u;for(r=r.map(function(t){return t instanceof Date?n.ConvertDateToOADate(t):t}),f={},e=0,s=r;e<s.length;e++)u=s[e],f[u]=u;for(o=0,h=i;o<h.length;o++)c=h[o],delete f[c[0]];for(l in f)u=f[l],i.push([u,t.getResult(i,u)])},t.getResult=function(i,r){for(var e,u=0,f=i;u<f.length;u++)if(e=f[u],n.Common.isFuzzyEquals(e[0],r))return e[1];return t.NoneExistentValue},t.getBindingValueCacheKey=function(n,t){return(t===void 0&&(t=!0),(n===null||n===void 0?void 0:n.$type)!=="Forguncy.DropDownListCellType, ServerDesignerCommon"||!n.IsBounding||!n.DataSource||!n.DisplayColumnBindingInfo||!n.ValueColumnBindingInfo)?null:{lookupColumnBindingInfo:t?n.ValueColumnBindingInfo:n.DisplayColumnBindingInfo,resultColumnBindingInfo:t?n.DisplayColumnBindingInfo:n.ValueColumnBindingInfo,itemQueryStr:null,lookupValue:null}},t.getQueryAndValuesOfCombobox=function(n,i,r,u){for(var h={},e=[],f=0;f<n.length;f++){var c=n[f],o=i[f],l=t.lookupComboboxResultFromCache(r,c,o,u,!0),s=l.cannotFindValues;s.length!==0&&(t.addToQueryAndValues(o,h,e,s),o&&t.addToQueryAndValues(null,h,e,s))}return e},t.addToQueryAndValues=function(t,i,r,u){var f=n.Common.IsEmpty(t)?"null":JSON.stringify(t),e;i[f]||(e={query:t,values:[]},i[f]={item:e,valueObj:{}},r.push(e));u.forEach(function(n){i[f].valueObj[n]||(i[f].valueObj[n]=1,i[f].item.values.push(n))})},t.updateCache=function(i){n.Common.IsEmpty(i)?t._bindingValueCache={}:t.getRelatedBindingValueCacheKeys(i).forEach(function(n){return delete t._bindingValueCache[n]})},t.getRelatedBindingValueCacheKeys=function(n){var r=[],i,u,f;for(i in t._bindingValueCache)u=t._bindingValueCache[i].guids,f=u.some(function(i){var r=t._bindingAndTablesRelation[i];return!r||r["*"]||r[n]}),f&&r.push(i);return r},t.addCacheFromGetComboBindingOptionsResult=function(n,i,r){var u,f;n&&n.length!==0&&(u=t.getBindingValueCacheKey(i),u)&&(u.itemQueryStr=JSON.stringify(r),f=n.map(function(n){return[n.Value,n.DisplayValue]}),t.setReversedCachedBindingValue(u,f),t.setCachedBindingValue(u,f))},t.NoneExistentValue="4DBB4E23-98C3-4C70-8A58-166D97B4FC40",t.CannotFindValue="13E0F8CD-FBD9-457F-99CA-D20C36056CB1",t._bindingValueCache={},t._bindingAndTablesRelation={},t._requestCache={},t._callBackCache={},t}();n.TableColumnsCacheManager=s;h=function(){function n(){}return n}();n.GetMultiComboBindingOptionsData=h})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=GC.Spread.CalcEngine,l=function(i){function r(n){var t=i.call(this,n)||this;return t._needRemovedPages=[],t}return __extends(r,i),r.prototype.addCustomName=function(t,i,r){var u,o,f,e;if(!n.Common.IsEmpty(i.Name)&&!n.Common.IsEmpty(i.Formula)&&(u=this,o=u.getCalcService(),o)){u._names||(u._names={});f=i.Name.toUpperCase();for(e in u._names)u._needRemovedPages.indexOf(e)>=0||u._names[e][f]&&(n.ErrorHelper.printErrorStr(n.Common.format(n.RS.NameConflict,f,n.PageManager.getDesignerPageName(e,!1),n.PageManager.getDesignerPageName(t,!1))),delete u._names[e][f]);u._names[t]||(u._names[t]={});u._names[t][f]=new GC.Spread.Sheets.NameInfo(f,r,i.BaseRow,i.BaseColumn,null);o.getGlobalSourceModel().updateNameCalc(f,!0)}},r.prototype.preRemoveCustomNames=function(n){this._needRemovedPages.push(n)},r.prototype.removeCustomNames=function(n){var t=this,i,r,u;if(t._names&&(i=t._names[n],i)&&(r=t.getCalcService(),r)){delete t._names[n];for(u in i)i[u]&&r.getGlobalSourceModel().updateNameCalc(u,!1)}},r.prototype.getCustomName=function(i){var u=this,o=typeof i=="string"&&!n.Common.IsEmpty(i)?i.toUpperCase():null,s,f,h,r,e;if(o&&u._names)for(s in u._names)if(f=u._names[s][o],f)return n.Common.IsEmpty(n.ForguncyData.parameterManager.getValue(i))||console.warn(n.Common.format(n.RS.NameConflictWarning,i)),f.getExpression();return(h=n.CustomFunction.GetParamFunction.getParamResult(i),h===t.Errors.Name)?null:(r=new t.Expression(t.ExpressionType.function),r.functionName="GetParam",r.function=new n.CustomFunction.GetParamFunction,e=new t.Expression(t.ExpressionType.string),e.value=i,r.arguments=[e],r)},r}(t.CalcSource),i,r,f,e,u,o,s,h,c;n.GlobalSource=l;i=function(i){function r(n,t){var r=i.call(this,n)||this;return r._name=t,r._hasRemoved=!1,r}return __extends(r,i),r.prototype.getName=function(){return this._hasRemoved?"":this._name},r.prototype.getColumnCount=function(){return this._hasRemoved?0:this._getColumnCount()},r.prototype.getRowCount=function(){return this._hasRemoved?0:this._getRowCount()},r.prototype._getColumnCount=function(){throw n.StaticValues.NeedImplementException;},r.prototype._getRowCount=function(){throw n.StaticValues.NeedImplementException;},r.prototype.getValue=function(){throw n.StaticValues.NeedImplementException;},r.prototype.setValue=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];throw n.StaticValues.NeedImplementException;},r.prototype.getReference=function(n){var r=n.row,u=n.col,f=n.rowCount,e=n.colCount,i=this;return r===-1&&u===-1?i.getSheetReference():r===-1?new t.CalcReference(i,[{row:0,rowCount:i.getRowCount(),col:u,colCount:e,rowUndefine:!0}]):u===-1?new t.CalcReference(i,[{row:r,rowCount:f,col:0,colCount:i.getColumnCount(),colUndefine:!0}]):new t.CalcReference(i,[{row:r,rowCount:f,col:u,colCount:e}])},r.prototype.referenceToArray=function(n,t,r,u,f,e,o,s){var h=i.prototype.referenceToArray.call(this,n,t,r,u,f,e,o,s);return h.isError&&(h.length===0||h.length===1&&h[0].length===0)?[]:h},r.prototype.getCustomName=function(){return null},r.prototype.getParserContext=function(t,r,u){n.Common.IsEmpty(r)&&(r={row:0,col:0});var f=i.prototype.getParserContext.call(this,t,r,u);return f.addResolver(new GC.Spread.Sheets.CalcEngine.SheetReferenceResolver(null)),f.addResolver(new GC.Spread.Sheets.CalcEngine.StructureReferenceResolver(null)),f},r.prototype.getRangeKey=function(n,t){return n.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},r.prototype.dispose=function(){this._hasRemoved=!0},r}(t.CalcSource);n.CalcSourceBase=i;r=function(t){function i(n,i,r){var u=t.call(this,n,i)||this;return u._formulaSheetDataModel=r,u.useFormulaSheetData=!1,u}return __extends(i,t),i.prototype.getValue=function(n,t){var i,r,u;return typeof n=="number"?(i=n,r=t):(i=n.row,r=n.col),u=this.useFormulaSheetData&&this._formulaSheetDataModel?this._formulaSheetDataModel.getValue(i,r):this.getActualValue(i,r),this.useFormulaSheetData=!1,u},i.prototype.getActualValue=function(){throw n.StaticValues.NeedImplementException;},i.prototype.setValue=function(){for(var r,u,f,e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];typeof t[0]=="number"?(r=t[0],u=t[1],f=t[2]):(e=t[0],r=e.row,u=e.col,f=t[1]);try{n.FormulaManager.suspendChange();this._formulaSheetDataModel.setValue(r,u,this.ajustFormulaResult(f))}finally{n.FormulaManager.resumeChange()}},i.prototype.ajustFormulaResult=function(n){return n},i.prototype.getSheet=function(){return new f(this)},i}(i);n.SheetCalcSourceBase=r;f=function(){function n(n){this._source=n}return n.prototype.name=function(){return this._source.getName()},n.prototype._getSheetSource=function(){return this._source},n}();e=function(t){function i(n,i,r,u,f){var e=t.call(this,n,i,r)||this;return e._dataModel=f,e._rowCount=u.RowCount,e._columnCount=u.ColumnCount,e}return __extends(i,t),i.prototype._getColumnCount=function(){return this._columnCount},i.prototype._getRowCount=function(){return this._rowCount},i.prototype.getActualValue=function(t,i){if(!this._dataModel)return null;var r=n.Common.getIdStr(t,i,this._name);return this._dataModel.getValue(r)},i}(r);n.PageCalcSource=e;u=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r)||this;return f._dataModel=u,f}return __extends(i,t),i.prototype._getColumnCount=function(){return this._dataModel.getColumnCount()},i.prototype._getRowCount=function(){return this._dataModel.getRowCount()},i.prototype.getActualValue=function(n,t){return this._dataModel?this._dataModel.getValue(n,t):null},i.prototype.ajustFormulaResult=function(t){return n.FormulaHelper.adjustNumberPrecision(t)},i}(r);n.ListCalcSource=u;o=function(t){function i(n,i){var r=t.call(this,n,"temp")||this;return r._formulaManager=i,r}return __extends(i,t),i.prototype.prepare=function(t){this._formulaCalcInfo={runTimePageName:t.runTimePageName,supportReferToListview:t.supportReferToListview,nullAsException:!!t.nullAsException,listInfo:t.listInfo?t.listInfo:null,rowOffset:n.Common.IsEmpty(t.rowOffset)?0:t.rowOffset,columnOffset:n.Common.IsEmpty(t.columnOffset)?0:t.columnOffset};this.updateRowCountAndColumnCount()},i.prototype.updateRowCountAndColumnCount=function(){var r=n.Common.IsEmpty(this._formulaCalcInfo.runTimePageName)?n.StaticValues.RunTimeNormalPage:this._formulaCalcInfo.runTimePageName,i=this._formulaManager.getCalcSource(r),t;i?(this._rowCount=i.getRowCount(),this._columnCount=i.getColumnCount()):(t=n.PageManager.getContainerCell(r),t&&t.cellType instanceof n.RepeaterCellType&&(this._rowCount=t.cellType.getTempalteRowCount(),this._columnCount=t.cellType.getTempalteColumnCount()))},i.prototype._getColumnCount=function(){return this._columnCount},i.prototype._getRowCount=function(){return this._rowCount},i.prototype.getValue=function(t,i){var e,f,r,h,u,l;typeof t=="number"?(e=t,f=i):(e=t.row,f=t.col);var c=null,o=e,s=f;if(this._formulaCalcInfo.supportReferToListview&&(r=this._getLocatedListview(e,f),r!==null&&(h=r.getCalcSheetName(),c=this._formulaManager.getCalcSource(h),o=this._formulaCalcInfo.listInfo&&typeof this._formulaCalcInfo.listInfo[h]=="number"?this._formulaCalcInfo.listInfo[h]:r.getCurrentRowIndex(),s=f-r.getRangeInfo().Column,r.isEditing()&&s===r.getCurrentColIndex()&&o===r.getCurrentRowIndex())))return r.getEditingValue();if(u=null,c?u=c.getValue({row:o,col:s}):(l=n.Common.getIdStr(o,s,this._formulaCalcInfo.runTimePageName),u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(l)),this._formulaCalcInfo.nullAsException&&(u===null||u===undefined)){n.FormulaManager.isNullValue=!0;throw"";}return u},i.prototype._getLocatedListview=function(t,i){return n.Common.getLocatedListview(this._formulaCalcInfo.runTimePageName,t,i)},i}(n.CalcSourceBase);n.FormulaCalculator=o;s=function(n){function t(t,i,r,u){var f=n.call(this,t,i,null,r)||this;return f._spreadJSView=u,f}return __extends(t,n),t.prototype._getRowCount=function(){return this._spreadJSView.getSheetRowCount()},t.prototype.getSheet=function(){return this._spreadJSView.getControl().getActiveSheet()},t}(u);n.ConditionFormatCalcSource=s;h=function(n){function t(t,i){return n.call(this,t,i)||this}return __extends(t,n),t.prototype._getColumnCount=function(){return 0},t.prototype._getRowCount=function(){return 0},t.prototype.getValue=function(){return null},t.prototype.setValue=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},t}(i);n.MockCalcSourceBase=h;c=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u._sheet=r,u}return __extends(t,n),t.prototype.getName=function(){return this._name},t.prototype._getColumnCount=function(){return this._sheet.getColumnCount()},t.prototype._getRowCount=function(){return this._sheet.getRowCount()},t.prototype.getValue=function(n,t){var i,r;return typeof n=="number"?(i=n,r=t):(i=n.row,r=n.col),this._sheet.getValue(i,r)},t.prototype.getSheet=function(){return this._sheet},t}(i);n.PivotTableCalcSource=c})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var b=function(t){function i(){return t.call(this,"CLIENTOData",2,255)||this}return __extends(i,t),i.prototype.defaultValue=function(){return null},i.prototype.getCellCacheKey=function(t){var i="";return t.ctx&&t.ctx.source&&t.ctx.source.getName&&(i=t.ctx.source.getName()),i=n.Common.IsEmpty(i)?"":i,n.ForguncyData.pageInfo.pageName+","+i+","+t.row+","+t.col+","+t.id},i.prototype.evaluateAsync=function(){for(var h,e,r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];var t=r[0],o={GUID:r[1],PageName:r[2],Params:r.slice(3)},f=JSON.stringify(o),s=!n.FormulaManager.syncExecuteAyncFunction;return(s&&(i.CellCache[this.getCellCacheKey(t)]=f),h=i.requestValueCache,e=h[f],e!==undefined)?e:this.processODateServerRequest(o,f,t,s,function(n){var f,e,o,c,i,u;if(Array.isArray(n)){if(n.length===0)return GC.Spread.CalcEngine.Errors.NotAvailable}else if(t.ctx.arrayFormulaMode)n=[{a:n}];else return n;var r=[],s=0,h=0;for(f=0;f<n.length;f++){e=n[f];o=[];for(c in e)o.push(e[c]),s++;h++;r.push(o)}if(n.length===1&&t.ctx.arrayIdentity)for(i=0;i<t.ctx.arrayIdentity.rowCount;i++)for(u=0;u<t.ctx.arrayIdentity.colCount;u++)i>=r.length&&r.push([]),(i>=h||u>=s)&&(r[i][u]=GC.Spread.CalcEngine.Errors.NotAvailable);return new GC.Spread.CalcEngine.CalcArray(r)})},i.prototype.processODateServerRequest=function(t,r,u,f,e){var s=this,o=null,h=i.requestCache,c=h[r];return c===undefined||f===!1?(f&&(h[r]={contexts:[{contexts:u,shouldCoverBindingValueByFormulaResult:n.FormulaManager.shouldCoverBindingValueByFormulaResult}]}),this._getTableDataByODataFormula(t,u.ctx.source.getName()+"_r"+u.row+"c"+u.col+"_"+r,function(n){n=e(n);o=s.setResult(f,s,r,u,n,o)},function(n){n=e(GC.Spread.CalcEngine.Errors.Value);o=s.setResult(f,s,r,u,n,o)},f)):c.contexts.push({contexts:u,shouldCoverBindingValueByFormulaResult:n.FormulaManager.shouldCoverBindingValueByFormulaResult}),o},i.prototype.setResult=function(n,t,i,r,u,f){return n?t.setAsyncResult(i,r,u):f=u,f},i.prototype._getTableDataByODataFormula=function(t,i,r,u,f){f===void 0&&(f=!0);(t===null||t===void 0?void 0:t.Params)&&(t.Params=t.Params.map(function(n){return typeof n=="string"?"@"+n:n}));n.Common.operateODataPost("Home/CalcOdata",t,r,u,f,i)},i.prototype.setAsyncResult=function(t,r,u){var f;(t+"").toLowerCase().indexOf("now()")<0&&(i.requestValueCache[t]=u);var e=i.requestCache,o=function(r){var f=e[t].contexts[r],o=f.contexts.ctx.source,l,h,c;if(o instanceof n.ListCalcSource)n.DelayRefresh.Push(null,function(){n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.recalc(f.shouldCoverBindingValueByFormulaResult,o)},"recalcSheet "+o.getName(),!0);else if(o instanceof n.PageCalcSource){l=n.FormulaManager.shouldCoverBindingValueByFormulaResult;n.FormulaManager.shouldCoverBindingValueByFormulaResult=f.shouldCoverBindingValueByFormulaResult;h=f.contexts;try{c=i.CellCache[s.getCellCacheKey(h)];(c===undefined||c===t)&&h.setAsyncResult(u)}finally{n.FormulaManager.shouldCoverBindingValueByFormulaResult=l}}},s=this;for(f=0;f<e[t].contexts.length;f++)o(f);e[t]=undefined},i.prototype.processNormalFomrulaData=function(n){if(n instanceof Object){if(n.length>0){var t=n[0];return this.getFirstSingleValue(t)}if(n.length===0)return GC.Spread.CalcEngine.Errors.NotAvailable}return n},i.prototype.getFirstSingleValue=function(n){if(n instanceof Object)for(var t in n)if(t!=="$type")return this.getFirstSingleValue(n[t]);return n},i.clearCache=function(t,r){if(r===void 0&&(r=null),t){t=t.toLocaleLowerCase();var u=i._clearCache(i.requestValueCache,t);r===null&&(r=u)}else r===null&&(r=i._hasODataFunctionInCurrentPage()),i.requestValueCache={};r&&n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.recalc(!1)},i._hasODataFunctionInCurrentPage=function(){var t=n.ForguncyData.pageInfo.pageName+",";for(var r in i.CellCache)if(r.length>t.length&&r.substr(0,t.length)===t)return!0;return!1},i._clearCache=function(n,t){var r=!1,i;t=t.toLocaleLowerCase();for(i in n)i&&(delete n[i],r=!0);return r},i.requestCache={},i.CellCache={},i.requestValueCache={},i._recalcSuspended=!1,i}(GC.Spread.CalcEngine.Functions.AsyncFunction),f,r,i,u,e,o,s,h,c,l,a,v,y,p,w;t.ODataFunction=b;var d=function(){function n(){}return n}(),g=function(){function n(){}return n}(),k=function(t){function i(n){var r=t.call(this,i.NAME,1,1)||this;return r._asyncFuncName=n,r}return __extends(i,t),i.prototype.evaluate=function(){for(var i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(i=GC.Spread.CalcEngine.Functions.findGlobalFunction(this._asyncFuncName),!i)return null;var u=n.ForguncyData.pageInfo.formulaManager.getCalcSource("temp"),f=u.getEvaluatorContext({row:0,col:0},!1,null),e=new GC.Spread.CalcEngine.AsyncEvaluateContext(f);return i.evaluateAsync.apply(i,__spreadArray([e],r,!0))},i.NAME="ASYNCTOSYNC",i}(GC.Spread.CalcEngine.Functions.Function);t.AsyncToSyncFunction=k;f=function(t){function i(){return t.call(this,"TEXTJOINIF",4,5)||this}return __extends(i,t),i.prototype.acceptsReference=function(n){return n===0||n===2||n===4?!0:!1},i.prototype.acceptsArray=function(n){return n===0?!0:!1},i.prototype.evaluate=function(){for(var r,s,p,h,f,e,t=[],u=0;u<arguments.length;u++)t[u]=arguments[u];var l=[],a=[],k=!!t[1],o=t[3],v=t[2],y=t[4]?t[4]:t[2];if(i.addResult(a,t[0],!1),v instanceof GC.Spread.CalcEngine.CalcReference&&y instanceof GC.Spread.CalcEngine.CalcReference){if(r=v,s=y,r.getRangeCount()<1||s.getRangeCount()<1)return null;for(p=o===0||o==="*",h=n.SpreadJSHelpMethods._MathHelper._parseCriteria(o),f=0;f<r.getRowCount(0);f++)for(e=0;e<r.getColumnCount(0);e++){var w={row:f,col:e},b=r.getValue(w,0),c=s.getValue(w,0);if(!(c instanceof GC.Spread.CalcEngine.CalcError)&&(!p||b!==null)&&h&&h(b)){if(k&&n.Common.IsEmpty(c))continue;l.push(c)}}}return i.textJoin(a,l)},i.addResult=function(n,t,r){var o,e,c,h,u,f,s;if(t instanceof GC.Spread.CalcEngine.CalcReference)for(o=t,e=0;e<o.getRangeCount();e++)for(u=0;u<o.getRowCount(e);u++)for(f=0;f<o.getColumnCount(e);f++)c={row:u,col:f},s=o.getValue(c,e),i.addSingleValue(n,s,r);else if(t instanceof GC.Spread.CalcEngine.CalcArray)for(h=t,u=0;u<h.getRowCount();u++)for(f=0;f<h.getColumnCount();f++)s=h.getValue(u,f),i.addSingleValue(n,s,r);else i.addSingleValue(n,t,r)},i.addSingleValue=function(t,i,r){if(n.Common.IsEmpty(i)){if(r)return;i=""}t.push(i)},i.textJoin=function(n,t){var u,r,i;if(t.length===0)return"";if(n.length===1)return t.join(n[0]);for(u=t[0],r=1,i=0;r<t.length;r++,i++)i===n.length&&(i=0),u+=n[i]+t[r];return u},i}(GC.Spread.CalcEngine.Functions.Function);t.TextJoinIfFunction=f,function(n){n[n.SingleByte=0]="SingleByte";n[n.DoubleByte=1]="DoubleByte";n[n.FourByte=2]="FourByte"}(r||(r={})),function(n){n[n.SingleByte_All=0]="SingleByte_All";n[n.DoubleByte_FirstHalf=1]="DoubleByte_FirstHalf";n[n.DoubleByte_SecondHalf=2]="DoubleByte_SecondHalf";n[n.FourByte_FirstHalf=3]="FourByte_FirstHalf";n[n.FourByte_SecondHalf=4]="FourByte_SecondHalf";n[n.FourByte_ThirdHalf=5]="FourByte_ThirdHalf";n[n.FourByte_FourthHalf=6]="FourByte_FourthHalf"}(i||(i={}));u=function(){function n(n){this.originStr=n;this.initLength();this.initIterator()}return n.prototype.determineType=function(n){var t=n.charCodeAt(0);return t>=0&&t<129||t===63728||t>=65377&&t<65440||t>=63729&&t<63732?r.SingleByte:t>=55296&&t<=57343?r.FourByte:r.DoubleByte},n.prototype.initLength=function(){this.length=0;for(var n=0;n<this.originStr.length;n++)switch(this.determineType(this.originStr[n])){case r.SingleByte:this.length+=1;break;case r.DoubleByte:case r.FourByte:this.length+=2}},n.prototype.initIterator=function(){var n=1,t;for(this.iteratorType=[],this.iteratorPosition=[],t=0;t<this.originStr.length;t++)switch(this.determineType(this.originStr[t])){case r.SingleByte:this.iteratorType[n]=i.SingleByte_All;this.iteratorPosition[n]=t.toString();++n;break;case r.DoubleByte:this.iteratorType[n]=i.DoubleByte_FirstHalf;this.iteratorPosition[n]=t.toString();++n;this.iteratorType[n]=i.DoubleByte_SecondHalf;this.iteratorPosition[n]=t.toString();++n;break;case r.FourByte:this.iteratorType[n]=i.FourByte_FirstHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;this.iteratorType[n]=i.FourByte_SecondHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;this.iteratorType[n]=i.FourByte_ThirdHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;this.iteratorType[n]=i.FourByte_FourthHalf;this.iteratorPosition[n]=t.toString()+"+"+(t+1).toString();++n;++t}this.iteratorLength=n-1},n}();e=function(t){function i(){return t.call(this,"LENB",1,1)||this}return __extends(i,t),i.prototype.evaluate=function(){for(var r,f,i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return r=n.SpreadJSHelpMethods.Convert.S(i[0]),f=new u(r),f.length},i}(GC.Spread.CalcEngine.Functions.Function);t.LenBFunction=e;o=function(t){function r(){return t.call(this,"FINDB",2,3)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var s,a,p,f,h,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var c=n.SpreadJSHelpMethods.Convert,w=n.SpreadJSHelpMethods._Helper,v=c.S(e[0]),l=c.S(e[1]),t=w._argumentExists(e,2)?c.I(e[2]):1,r=new u(l),y=r.iteratorLength;if(n.Common.IsEmpty(v)||n.Common.IsEmpty(l))return t>0?y+1:GC.Spread.CalcEngine.Errors.Value;if(t<1||t>y)return GC.Spread.CalcEngine.Errors.Value;s=-1;switch(r.iteratorType[t]){case i.DoubleByte_SecondHalf:if(t===r.iteratorLength){t=-1;break}++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+1>r.iteratorLength){t=-1;break}t+=1}if(t===-1||(t!==-1&&s===-1&&(s=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t])),a=l.indexOf(v,s),a===-1))return GC.Spread.CalcEngine.Errors.Value;for(p=0,f=1;f<=r.iteratorLength;f++)if(h=r.iteratorPosition[f],h.indexOf("+")>0&&(h=r.iteratorPosition[f].split("+")[0],++p),h===a.toString())return f},r}(GC.Spread.CalcEngine.Functions.Function);t.FindBFunction=o;s=function(t){function r(){return t.call(this,"LEFTB",1,2)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var r,c,s,f=[],e=0;e<arguments.length;e++)f[e]=arguments[e];var h=n.SpreadJSHelpMethods.Convert,l=n.SpreadJSHelpMethods._Helper,o=h.S(f[0]),t=l._argumentExists(f,1)?h.I(f[1]):1;if(n.Common.IsEmpty(o))return n.Common.IsEmpty(t)||t>=0?"":GC.Spread.CalcEngine.Errors.Value;if(r=new u(o),t<0)return GC.Spread.CalcEngine.Errors.Value;if(t===0)return"";if(t>=r.iteratorLength)return o;c=r.iteratorType[t];s=-1;switch(c){case i.DoubleByte_FirstHalf:if(t===1)return"";--t;break;case i.FourByte_FirstHalf:if(t-1<1)return"";t-=1;break;case i.FourByte_SecondHalf:if(t-2<1)return"";t-=2;break;case i.FourByte_ThirdHalf:if(t-3<1)return"";t-=3}return s===-1&&(s=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[1]):Number(r.iteratorPosition[t])),o.substring(0,Number(s)+1)},r}(GC.Spread.CalcEngine.Functions.Function);t.LeftBFunction=s;h=function(t){function r(){return t.call(this,"RIGHTB",1,2)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var t,l,s,e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var c=n.SpreadJSHelpMethods.Convert,a=n.SpreadJSHelpMethods._Helper,f=c.S(e[0]),r=new u(f),h=a._argumentExists(e,1)?c.I(e[1]):1;if(h<0)return GC.Spread.CalcEngine.Errors.Value;if(h===0)return"";if(t=r.iteratorLength-h+1,n.Common.IsEmpty(f))return n.Common.IsEmpty(t)||t>=0?"":GC.Spread.CalcEngine.Errors.Value;if(isNaN(Number(t))||t<=0)return f;if(t===0)return"";l=r.iteratorType[t];s=-1;switch(l){case i.DoubleByte_SecondHalf:if(t===r.iteratorLength)return"";++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+1>r.iteratorLength){t=-1;break}t+=1}return t===-1?"":(t!==-1&&s===-1&&(s=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t])),f.substring(Number(s),f.length))},r}(GC.Spread.CalcEngine.Functions.Function);t.RightBFunction=h;c=function(t){function r(){return t.call(this,"MIDB",3,3)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];var e=n.SpreadJSHelpMethods.Convert.S(s[0]),t=n.SpreadJSHelpMethods.Convert.I(s[1]),r=new u(e),f=n.SpreadJSHelpMethods.Convert.I(s[2]),a=r.iteratorType[t],o=-1,v=r.iteratorType[t+f-1],c=-1,l=t;if(n.Common.IsEmpty(e))return t>0?"":GC.Spread.CalcEngine.Errors.Value;if(t<0||f<0)return GC.Spread.CalcEngine.Errors.Value;if(t>r.iteratorLength)return"";switch(a){case i.DoubleByte_SecondHalf:if(t===r.iteratorLength){t=-1;break}++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+3>r.iteratorLength){t=-1;break}t+=1}if(t===-1)return"";if(t!==-1&&o===-1&&(o=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t])),t+f-1>r.iteratorLength)return e.substring(Number(o),e.length);switch(v){case i.DoubleByte_FirstHalf:if(f===1)return"";--f;break;case i.FourByte_FirstHalf:if(t+f-2<1)return"";f-=1;break;case i.FourByte_SecondHalf:if(t+f-3<1)return"";f-=2;break;case i.FourByte_ThirdHalf:if(t+f-4<1)return"";f-=3}return c===-1&&(c=r.iteratorPosition[l+f-1].indexOf("+")>0?Number(r.iteratorPosition[l+f-1].split("+")[1]):Number(r.iteratorPosition[l+f-1])),Number(o)!==-1&&Number(c)!==-1?e.substring(Number(o),Number(c)+1):void 0},r}(GC.Spread.CalcEngine.Functions.Function);t.MidBFunction=c;l=function(t){function r(){return t.call(this,"REPLACEB",4,4)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var f,a,e=[],h=0;h<arguments.length;h++)e[h]=arguments[h];var o=n.SpreadJSHelpMethods.Convert.S(e[0]),t=n.SpreadJSHelpMethods.Convert.I(e[1]),r=n.SpreadJSHelpMethods.Convert.I(e[2]),v=n.SpreadJSHelpMethods.Convert.S(e[3]);if(n.Common.IsEmpty(o)||n.Common.IsEmpty(t)||n.Common.IsEmpty(v))return"";if((f=new u(o),isNaN(Number(r))||r<0)||isNaN(Number(t))||t<1||t>f.iteratorLength)return GC.Spread.CalcEngine.Errors.Value;r>f.iteratorLength&&(r=f.iteratorLength-1);var y=f.iteratorType[t],s=-1,p=f.iteratorType[t+r-1],c=-1,l=t;switch(y){case i.FourByte_SecondHalf:if(t+3>f.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>f.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+3>f.iteratorLength){t=-1;break}t+=1}if(t===-1)return"";if(t!==-1&&s===-1&&(s=f.iteratorPosition[t].indexOf("+")>0?Number(f.iteratorPosition[t].split("+")[0]):Number(f.iteratorPosition[t])),t+r-1>f.iteratorLength)return o.substring(Number(s),o.length);switch(p){case i.FourByte_FirstHalf:if(t+r-2<1)return"";r-=1;break;case i.FourByte_SecondHalf:if(t+r-3<1)return"";r-=2;break;case i.FourByte_ThirdHalf:if(t+r-4<1)return"";r-=3}return c===-1&&(c=f.iteratorPosition[l+r-1].indexOf("+")>0?Number(f.iteratorPosition[l+r-1].split("+")[1]):Number(f.iteratorPosition[l+r-1])),r=Number(c)-Number(s)+1,a=o.split(""),a.splice(Number(s),r,v),a.join("")},r}(GC.Spread.CalcEngine.Functions.Function);t.ReplaceBFunction=l;a=function(t){function r(){return t.call(this,"SEARCHB",2,3)||this}return __extends(r,t),r.prototype.evaluate=function(){for(var c,o,y,b,p,k,f,l,e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];var a=n.SpreadJSHelpMethods.Convert,d=n.SpreadJSHelpMethods._Helper,v=a.S(e[0]),h=a.S(e[1]),t=d._argumentExists(e,2)?a.I(e[2]):1,r=new u(h),w=r.iteratorLength;if(n.Common.IsEmpty(v)||n.Common.IsEmpty(h))return t>0?w+1:GC.Spread.CalcEngine.Errors.Value;if(t<1||t>w)return GC.Spread.CalcEngine.Errors.Value;switch(r.iteratorType[t]){case i.DoubleByte_SecondHalf:if(t===r.iteratorLength){t=-1;break}++t;break;case i.FourByte_SecondHalf:if(t+3>r.iteratorLength){t=-1;break}t+=3;break;case i.FourByte_ThirdHalf:if(t+2>r.iteratorLength){t=-1;break}t+=2;break;case i.FourByte_FourthHalf:if(t+1>r.iteratorLength){t=-1;break}t+=1}if(c=-1,t===-1)return GC.Spread.CalcEngine.Errors.Value;t!==-1&&c===-1&&(c=r.iteratorPosition[t].indexOf("+")>0?Number(r.iteratorPosition[t].split("+")[0]):Number(r.iteratorPosition[t]));o=-1;try{y=n.SpreadJSHelpMethods.RegUtil.getWildcardCriteria(v);y?(b=n.SpreadJSHelpMethods.RegUtil.getRegIgnoreCase(y),p=b.exec(h),o=n.Common.IsEmpty(p)?-1:p.index):o=h.toLowerCase().indexOf(v.toLowerCase(),c)}catch(g){}if(o===-1)return GC.Spread.CalcEngine.Errors.Value;for(k=0,f=1;f<=r.iteratorLength;f++)if(l=r.iteratorPosition[f],l.indexOf("+")>0&&(l=r.iteratorPosition[f].split("+")[0],++k),l===o.toString())return f},r}(GC.Spread.CalcEngine.Functions.Function);t.SearchBFunction=a;v=function(t){function i(){return t.call(this,"GETURLQUERYVALUE",1,1)||this}return __extends(i,t),i.prototype.evaluate=function(){for(var r,t,u=[],i=0;i<arguments.length;i++)u[i]=arguments[i];return(r=n.SpreadJSHelpMethods.Convert.S(u[0]),n.Common.IsEmpty(r))?GC.Spread.CalcEngine.Errors.NotAvailable:(t=n.MetadataLoader.GetUrlQuery(r,!1),!t&&n.MetadataLoader.IsInMobileSimulatorFrame()&&(t=n.MetadataLoader.GetUrlQuery(r,!0)),t===null)?GC.Spread.CalcEngine.Errors.NotAvailable:t},i}(GC.Spread.CalcEngine.Functions.Function);t.GetUrlQueryValueFunction=v;y=function(t){function i(){return t.call(this,"ISDIRTY",4,4)||this}return __extends(i,t),i.prototype.getDataModel=function(t,i){var u=n.ForguncyData.pageInfo,r;if(n.ForguncyData.pageInfo.pageID!==t){if(r=n.ForguncyData.pageInfoStack.filter(function(n){return n.pageID===t}),r.length<=0)return null;u=r[0]}return u.dataModel.getListDataByCalcSheetName(i)},i.prototype.evaluate=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var u=n[0],f=n[1],r=n[2],e=n[3],i=this.getDataModel(u,f);return i?i.getRowQuery(r)&&i.isDirty(r,e):!1},i}(GC.Spread.CalcEngine.Functions.Function);t.IsDirtyFunction=y;p=function(t){function i(){return t.call(this,"GETPARAM",1,1)||this}return __extends(i,t),i.prototype.evaluate=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i.getParamResult(t[0])},i.getParamResult=function(t){var o,h=n.SpreadJSHelpMethods.Convert.S(t).replace(/\.\./g,"\n"),u=h.split(".").filter(function(n){return n}).map(function(n){return n.replace(/\n/g,".")}),i=n.ForguncyData.parameterManager,s,f,r,e;for(n.ForguncyData.parameterManager.getValue(u[0])===undefined&&(s=n.ForguncyData.commandExcutor.getCommandExecuteInfo(),s&&(f=n.PageManager.getContainerCell(s.runTimePageName),f&&f.cellType instanceof n.UserControlPageCellType&&(i=f.cellType))),r=0;r<u.length;r++)if(!n.Common.IsEmpty(i)){if(e=void 0,e=i instanceof n.ParameterManager?i.getValue(u[r]):i instanceof n.UserControlPageCellType?(o=i.GetPropertyValue(u[r]))===null||o===void 0?void 0:o.Result:i[u[r]],e===undefined)return n.ForguncyData.commandLogHelper.log(n.Common.format(n.RS.CantFindParam,u[r])),GC.Spread.CalcEngine.Errors.Name;i=e}return i},i}(GC.Spread.CalcEngine.Functions.Function);t.GetParamFunction=p;w=function(){function t(){}return t.addCustomFunctions=function(){var i=GC.Spread.CalcEngine.Functions,r,t;for(r in n.CustomFunction)t=new n.CustomFunction[r],t instanceof i.Function&&(i.removeGlobalFunction(t.name),i.defineGlobalCustomFunction(t.name,t))},t}();w.addCustomFunctions()})(t=n.CustomFunction||(n.CustomFunction={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var r=GC.Spread.CalcEngine,e=function(){function i(n){this._isReady=!1;this._bindDataModelEvent(n);this._initCalcService()}return i.prototype._initCalcService=function(){this._calcService=new r.CalcService;this._calcSourceList=[];this._formulaResultSyncOperator=[];this._formulaSheetDataModel=[];this._calcService.getGlobalSourceModel(new n.GlobalSource(this._calcService));this._formulaCalculator=new n.FormulaCalculator(this._calcService,this);this._calcSourceList.push(this._formulaCalculator)},i.isReady=function(){return n.ForguncyData.pageInfo.formulaManager&&n.ForguncyData.pageInfo.formulaManager._isReady},i.prototype.init=function(n,t,i,r){this._initCalcSource(n,t,i,r);this._initDefinedNames(i,this.getDefinedNameInfos(n,i,r));this._initFormula(this.getFormulaInfos(n,i,r));this._isReady=!0},i.prototype._initCalcSource=function(n,t,i,r){var f=this,u;this.addSheetCalcSource(i,n.PageSettings,t.normalCellDataModel);n.MasterPage&&this.addSheetCalcSource(r,n.MasterPage.PageSettings,t.normalCellDataModel);u=t.getListDataList([i,r]);u.forEach(function(n){return f.addListviewSheetCalcSource(n)});this._calcService.getParserContext(this._calcSourceList[0])},i.prototype.addSheetCalcSource=function(i,r,u){var f=new t(i+t.nameSuffix);this.addCalcSource(new n.PageCalcSource(this._calcService,i,f,r,u));this._formulaSheetDataModel.push(f);this._formulaResultSyncOperator.push(new o(f,i))},i.prototype.addListviewSheetCalcSource=function(i){var r=new t(i.name+t.nameSuffix);this.addCalcSource(new n.ListCalcSource(this._calcService,i.name,r,i));this._formulaSheetDataModel.push(r);this._formulaResultSyncOperator.push(new s(r,i))},i.prototype.getDefinedNameInfos=function(n,t,i){var r={},u;return r[n.PageSettings.Name]=t,n.MasterPage&&(r[n.MasterPage.PageSettings.Name]=i),u=this._translateDefinedNameInfo(t,r,n.DefinedNameInfos),n.MasterPage&&(u=u.concat(this._translateDefinedNameInfo(i,r,n.MasterPage.DefinedNameInfos))),u},i.prototype._translateDefinedNameInfo=function(t,i,r){if(!r)return[];var u=new n.CustomNameFormulaTranslater(t,i);return r.forEach(function(n){return n.Formula=u.translate(n.Formula)}),r},i.prototype._initDefinedNames=function(n,t){var r,i,u;if(t)for(r=this._calcService.getGlobalSourceModel().getSource(),i=0;i<t.length;i++)u=this._calcService.parse(this._calcSourceList[0],t[i].Formula,t[i].BaseRow,t[i].BaseColumn),r.addCustomName(n,t[i],u)},i.prototype.addCalcSource=function(n){var t=this._calcService.getSourceModel(n),i=t.recalculateCell;t.recalculateCell=function(){for(var n,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];n=this.getSource();try{return typeof n.useFormulaSheetData=="boolean"&&(n.useFormulaSheetData=!0),i.apply(this,r)}finally{typeof n.useFormulaSheetData=="boolean"&&(n.useFormulaSheetData=!1)}};this._calcSourceList.push(n)},i.prototype.getFormulaInfos=function(n,t,i){var r={};return this._translateFormula(t,n.FormulaInfos,r),n.MasterPage&&this._translateFormula(i,n.MasterPage.FormulaInfos,r),r},i.prototype._translateFormula=function(t,i,r){var u,f,e;if(i){u=n.ListviewBase.getAllListviews([t]);f=function(f){if(!i[f])return"continue";var e=n.Common.IsEmpty(f)?t:n.ListviewBase.getListview(f,t).getCalcSheetName(),o=new n.CellFormulaTranslater(e,t,u);i[f].forEach(function(n){return n.Formula=o.translate(n.Formula)});r[e]=i[f]};for(e in i)f(e)}},i.prototype._initFormula=function(n){var t,r,u,i;this.suspend();try{for(t in n)if(r=this.getCalcSource(t),r&&n[t])for(u=r.getCalcSourceModel(),i=0;i<n[t].length;i++)this._setFormula(u,n[t][i])}finally{this.resume(!1)}},i.prototype._setFormula=function(n,t){t.IsArraryFormula?n.setArrayFormula(t.RowIndex,t.ColumnIndex,t.RowCount,t.ColumnCount,t.Formula):n.setFormula(t.RowIndex,t.ColumnIndex,t.Formula)},i.prototype.setFormula=function(n,t,i){var r=this.getCalcSource(n),u;r&&(this.getRelatedFormulaResultSyncOperator(n).cacheShouldSyncFormulaResultMethod(t.RowIndex,t.ColumnIndex,i),u=r.getCalcSourceModel(),this._setFormula(u,t))},i.prototype.hasFormula=function(t){var r,i=n.Common.parseIDStr(t),u;return i?(u=(r=this.getCalcSource(i.suffix))===null||r===void 0?void 0:r.getCalcSourceModel(),!u)?void 0:!n.Common.IsEmpty(u.getFormula(i.row,i.col)):!1},i.prototype.getRelatedFormulaResultSyncOperator=function(n){var t=this._formulaResultSyncOperator.filter(function(t){return t.getRelatedCalcSheetName()===n});return t.length<=0?null:t[0]},i.prototype.preDestroyRunTimePage=function(n){var t=this._calcService.getGlobalSourceModel().getSource();n.forEach(function(n){return t.preRemoveCustomNames(n)})},i.prototype.destroyRunTimePage=function(n){this._removeCustomName(n);this._removeCalcSources(n)},i.prototype._removeCustomName=function(n){var t=this._calcService.getGlobalSourceModel().getSource();n.forEach(function(n){return t.removeCustomNames(n)})},i.prototype._removeCalcSources=function(t){var i=this;t.forEach(function(n){return i._removeCalcSourceAndRelatedModels(n)});n.ListviewBase.getAllListviews(t).forEach(function(n){return i._removeCalcSourceAndRelatedModels(n.getCalcSheetName())})},i.prototype._removeCalcSourceAndRelatedModels=function(n){this.removeCalcSource(n);this._formulaResultSyncOperator=this._formulaResultSyncOperator.filter(function(t){return t.getRelatedCalcSheetName()!==n});this._formulaSheetDataModel=this._formulaSheetDataModel.filter(function(i){return i.name!==n+t.nameSuffix})},i.prototype.removeCalcSource=function(n){var t=this.getCalcSource(n),i;t&&(i=this._calcSourceList.indexOf(t),this._calcService.removeSource(t),this._calcSourceList.splice(i,1),t.dispose())},i.prototype._bindDataModelEvent=function(n){var t=this;n.bind("valuechanged",function(n,i){if(t._calcService)if(i.calcName)t.onListviewValueChanged(i.calcName,i.arg);else t.onNormalCellValueChanged(i.arg)})},i.prototype.onNormalCellValueChanged=function(t){if(!i.isSuspended()){var r=n.Common.parseIDStr(t.id),u=this.getCalcSource(r.suffix);u&&this.recalc(t.valueType!==2,u,r.row,r.col)}},i.prototype.onListviewValueChanged=function(n,t){var r,u;if((this.updateFormulaSheetDataModel(n,t),!i.isSuspended())&&(r=t.cellRange,u=this.getCalcSource(n),u!==null)){var f=u,e=void 0,o=void 0;r.RowCount===1&&r.ColumnCount===1&&r.Row>=0&&r.Column>=0?(e=r.Row,o=r.Column):t.newRowCount<t.oldRowCount&&(f=null);this.recalc(t.valueType!==2,f,e,o)}},i.prototype.updateFormulaSheetDataModel=function(n,i){var f=n+t.nameSuffix,u=this._formulaSheetDataModel.filter(function(n){return n.name===f}),r;if(!(u.length<=0)){r=u[0];switch(i.actionType){case 0:r.clean();break;case 2:r.deleteRow(i.deleteRow);break;case 4:r.insertRow(i.cellRange.Row,i.cellRange.RowCount)}}},i.prototype.recalc=function(t,r,u,f){var s=i.shouldCoverBindingValueByFormulaResult,e,o;i.shouldCoverBindingValueByFormulaResult=t;try{n.Common.IsEmpty(r)||n.Common.IsEmpty(u)||n.Common.IsEmpty(f)?n.Common.IsEmpty(r)?this._calcService.recalculateAll(!0):(e=r.getColumnCount(),o=r.getRowCount(),this._calcService.recalcRange(r,0,0,o,e)):this._calcService.recalculate(r,u,f)}catch(h){}finally{i.shouldCoverBindingValueByFormulaResult=s}},i.prototype.suspend=function(){this._calcService.suspend()},i.prototype.resume=function(n){var t=i.shouldCoverBindingValueByFormulaResult;i.shouldCoverBindingValueByFormulaResult=n;try{this._calcService.resume()}finally{i.shouldCoverBindingValueByFormulaResult=t}},i.prototype.isSuspended=function(){return this._calcService.IsSuspended()},i.prototype.getCalcSource=function(n){for(var i=this._calcSourceList.length,t=0;t<i;t++)if(this._calcSourceList[t].getName()===n)return this._calcSourceList[t];return null},i.prototype.getCalcService=function(){return this._calcService},i.prototype._getMockSheet=function(){return i._mockSheet||(i._mockSheet=new GC.Spread.Sheets.Worksheet("mock"),i._mockSheetCalcService=i._mockSheet.getCalcService(),i._mockSheetSource=new n.MockCalcSourceBase(i._mockSheetCalcService,i._mockSheet.name())),i._mockSheet},i.prototype.restoreMockSheet=function(){i._mockSheet&&i._mockSheet.setCalc(i._mockSheetCalcService,i._mockSheetSource)},i.prototype.evaluateFormula=function(t,r,u){var e,c,l,a;if(u===void 0&&(u=!0),!i.shouldEvaluateFormula(t))return t!==null&&t!==void 0?t:null;if(t.charAt(0)==="=")try{n.Common.IsEmpty(r.rowOffset)&&(r.rowOffset=0);n.Common.IsEmpty(r.columnOffset)&&(r.columnOffset=0);var f=null,o=0,s=0;r.isTranslatedFormula&&(f=this.getCalcSource(r.runTimePageName),o=r.runTimePageName[0]==="s"?0:r.rowOffset,s=r.columnOffset);f||(this._formulaCalculator.prepare(r),f=this._formulaCalculator);e=this.getCalcService().parse(f,t,o,s);e=(new h).visit(e,o,s);try{return i.syncExecuteAyncFunction=!0,i.isNullValue=!1,c=this._getMockSheet(),c.setCalc(this._calcService,f),l={convertNullToZero:!1},a=GC.Spread.Sheets.CalcEngine.evaluateExpression(c,e,r.rowOffset,r.columnOffset,l),r.nullAsException&&i.isNullValue?null:a}finally{i.syncExecuteAyncFunction=!1}}catch(v){if(u)return null;throw v;}else if(t.charAt(0)==="'")return t.substring(1);return t},i.shouldEvaluateFormula=function(n){return i.isFormula(n)||i.isValueStartWithSingleQuotes(n)},i.isFormula=function(t){return n.Common.IsEmpty(t)||typeof t!="string"||t.length<1||t.charAt(0)!=="="?!1:!0},i.isValueStartWithSingleQuotes=function(t){return n.Common.IsEmpty(t)||typeof t!="string"||t.length<1||t.charAt(0)!=="'"?!1:!0},i.prototype.getValue=function(n,t){try{return this._formulaCalculator.prepare(t),this._formulaCalculator.getValue({row:n.Row,col:n.Column})}catch(i){return null}},i.isSuspended=function(){return this._suspendCount>0},i.suspendChange=function(){this._suspendCount++},i.resumeChange=function(){this._suspendCount--},i.prototype.destroy=function(){this.restoreMockSheet()},i.syncExecuteAyncFunction=!1,i.isNullValue=!1,i.shouldCoverBindingValueByFormulaResult=!1,i._mockSheet=null,i._mockSheetCalcService=null,i._mockSheetSource=null,i._suspendCount=0,i}(),t,u,o,s,i,f,h,c;n.FormulaManager=e;t=function(n){function t(t){var i=n.call(this)||this;return i.name=t,i._data=[],i}return __extends(t,n),t.prototype.clean=function(){this._data=[]},t.prototype.insertRow=function(n,t){for(var i,r=[],u=0;u<t;u++)r.push([]);(i=this._data).splice.apply(i,__spreadArray([n,0],r,!1))},t.prototype.deleteRow=function(n){this._data.splice(n,1)},t.prototype.getValue=function(n,t){if(this._data[n]===undefined)return null;var i=this._data[n][t];return i===undefined?null:i},t.prototype.setValue=function(n,t,i){var r=this.getValue(n,t);r!==i&&(this._data[n]===undefined&&(this._data[n]=[]),this._data[n][t]=i,this.trigger("valuechanged",{row:n,col:t,oldValue:r,newValue:i}))},t.nameSuffix="__",t}(n.EventClassBase);n.FormulaSheetDataModel=t;u=function(){function t(n){var t=this;this._shouldSyncFormulaResultMethodCache={};n.bind("valuechanged",function(n,i){t.onDataModelValueChanged(i)})}return t.prototype.onDataModelValueChanged=function(n){var t=this.getCurrentValueType(n.row,n.col);this.shouldSyncFormulaResult(n.row,n.col,t)&&this.syncValue(n.row,n.col,n.newValue,!1)},t.prototype.shouldSyncFormulaResult=function(n,t,i){var r=this._shouldSyncFormulaResultMethodCache[n+","+t];return r?r(i):i!==2||e.shouldCoverBindingValueByFormulaResult},t.prototype.getCurrentValueType=function(){throw n.StaticValues.NeedImplementException;},t.prototype.syncValue=function(){throw n.StaticValues.NeedImplementException;},t.prototype.getRelatedCalcSheetName=function(){throw n.StaticValues.NeedImplementException;},t.prototype.cacheShouldSyncFormulaResultMethod=function(n,t,i){this._shouldSyncFormulaResultMethodCache[n+","+t]=i},t}();n.FormulaResultSyncOperator=u;o=function(t){function i(n,i){var r=t.call(this,n)||this;return r._runTimePageName=i,r}return __extends(i,t),i.prototype.getCurrentValueType=function(t,i){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValueType(this.getID(t,i))},i.prototype.syncValue=function(t,i,r){n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.getID(t,i),{newValue:r},4)},i.prototype.getID=function(t,i){return n.Common.getIdStr(t,i,this.getRelatedCalcSheetName())},i.prototype.getRelatedCalcSheetName=function(){return this._runTimePageName},i}(u);n.NormalCellFormulaResultSyncOperator=o;s=function(n){function t(t,i){var r=n.call(this,t)||this;return r._listDataModel=i,r}return __extends(t,n),t.prototype.getCurrentValueType=function(n,t){return this._listDataModel.getValueType(n,t)},t.prototype.syncValue=function(n,t,i){this._listDataModel.setValue(n,t,i,4)},t.prototype.getRelatedCalcSheetName=function(){return this._listDataModel.name},t}(u);n.ListviewCellFormulaResultSyncOperator=s;i=function(){function t(){}return t.getRangeLocations=function(t,i){var e,u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(i),r,o,s,f;return n.ForguncyData.parameterManager.NeedUpdateReference(t)?t=n.ForguncyData.parameterManager.ParamToReference(t):(r=(e=n.PageManager.getContainerCell(i))===null||e===void 0?void 0:e.cellType,r&&r instanceof n.UserControlPageCellType&&r.needUpdateReference(t)&&(o=r.propertyToReference(t),t=o.referStr,i=o.runTimePageName,u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(i))),u||(u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(n.StaticValues.RunTimeNormalPage)),s=n.ForguncyData.pageInfo.formulaManager.getCalcService().parse(u,t,0,0),f=new c(i),f.visit(s,0,0),f.hasError?null:f.ranges},t.getCellLocation=function(t,i){return n.Helper.getCellLocation(t,{PageID:i})},t.getFormulaCalcInfo=function(t){return{runTimePageName:n.Common.getRunTimePageNameFromFormulaCalcContext(t),rowOffset:t.RowOffset,columnOffset:t.ColumnOffset,listInfo:t.ListviewRowInfo}},t.getCellIds=function(t,i){var r=this.getCellIdInfos(t,i);return r.map(function(t){return n.Common.getIdStr(t.row,t.col,t.suffix)})},t.setValueToCellLocation=function(t,i,r,u,f){var e,o,s,h;if(f===void 0&&(f=!0),!n.Common.IsEmpty(i))if(e=n.CommandBase.getCellID(i,u,!0),e&&e.length>0)for(o=0,s=e;o<s.length;o++)h=s[o],n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(h,{newValue:t},r);else i.Name&&f&&n.ForguncyData.parameterManager.setValue(i.Name,t)},t.getCellIdInfos=function(t,i){var u,r,e,f;if(typeof t!="string")return[];u=i.runTimePageName;n.ForguncyData.parameterManager.NeedUpdateReference(t)?t=n.ForguncyData.parameterManager.ParamToReference(t):(r=n.PageManager.getContainerCell(u),(r===null||r===void 0?void 0:r.cellType)instanceof n.UserControlPageCellType&&r.cellType.needUpdateReference(t)&&(e=r.cellType.propertyToReference(t),t=e.referStr,u=e.runTimePageName));f=n.ForguncyData.pageInfo.formulaManager.getCalcSource(u);f||(f=n.ForguncyData.pageInfo.formulaManager.getCalcSource(n.StaticValues.RunTimeNormalPage));var s=n.ForguncyData.pageInfo.formulaManager.getCalcService().parse(f,t,0,0),o=[];return this.getIDInfosByExpression(s,i,f,o,[],u),o},t.getIDInfosByExpression=function(i,r,u,f,e,o){var s,v,y,c,l,h,a,p,w;if(i.type===GC.Spread.CalcEngine.ExpressionType.name){if(s=i,e.indexOf(s.value)===-1&&n.ForguncyData.parameterManager.NeedUpdateReference(s.value))e.push(s.value),v=n.ForguncyData.parameterManager.ParamToReference(s.value),y=n.ForguncyData.pageInfo.formulaManager.getCalcService().parse(u,v,0,0),this.getIDInfosByExpression(y,r,u,f,e,o);else if(c=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(s.value,!1),c)for(l=0;l<c.length;l++)f.push(n.Common.parseIDStr(c[l].id))}else i.type===GC.Spread.CalcEngine.ExpressionType.reference?(h=i,t.isCellExpression(h)&&(h=this.offsetFormulaCellLocation(h,r.rowOffset,r.columnOffset),f.push({row:h.row,col:h.column,suffix:o}))):i.type===GC.Spread.CalcEngine.ExpressionType.operator&&(a=i,a.operatorType===16&&(p=n.Common.clone(e),w=n.Common.clone(e),this.getIDInfosByExpression(a.value,r,u,f,p,o),this.getIDInfosByExpression(a.value2,r,u,f,w,o)))},t.offsetFormulaCellLocation=function(t,i,r){if(n.Common.IsEmpty(t)||!t.rowRelative&&!t.columnRelative||(n.Common.IsEmpty(i)&&(i=0),n.Common.IsEmpty(r)&&(r=0),i===0&&r===0))return t;var u=n.Common.clone(t);return u.rowRelative&&(u.row+=i),u.columnRelative&&(u.column+=r),u},Object.defineProperty(t,"SheetParserContext",{get:function(){return t._sheetParserContext||(t._sheetParserContext=new GC.Spread.Sheets.CalcEngine.SheetParserContext(null,!1,{row:0,col:0})),t._sheetParserContext},enumerable:!1,configurable:!0}),t.parse=function(i,r){var u,f,o;return r===void 0&&(r=!1),e.isReady()||r?(u=n.ForguncyData.pageInfo.formulaManager.getCalcService(),f=n.ForguncyData.pageInfo.formulaManager.getCalcSource("temp"),u.parse(f,i,0,0)):(o=new GC.Spread.CalcEngine.Parser,o.parse(t.SheetParserContext,i))},t.unparse=function(n){var i=new GC.Spread.CalcEngine.Parser;return i.unparse(t.SheetParserContext,n)},t.createCellExpression=function(n,t,i,r,u,f){var e=new GC.Spread.CalcEngine.ReferenceExpression(GC.Spread.CalcEngine.ExpressionType.reference);return e.row=i,e.column=r,e.rowRelative=u,e.columnRelative=f,n&&(e.source=n),t&&(e.endSource=t),e},t.createColumnRangeExpression=function(n,i,r,u,f){return t.createRangeExpression(n,null,GC.Spread.CalcEngine.BAND_INDEX_CONST,i,GC.Spread.CalcEngine.BAND_INDEX_CONST,r,!0,u,!0,f)},t.createRangeExpression=function(n,t,i,r,u,f,e,o,s,h){var c=new GC.Spread.CalcEngine.ReferenceExpression(GC.Spread.CalcEngine.ExpressionType.reference),l;return c.isFullRow=r===GC.Spread.CalcEngine.BAND_INDEX_CONST,c.isFullRow&&i===0&&u===GC.Spread.CalcEngine.MAX_ROW_COUNT-1&&(i=u=GC.Spread.CalcEngine.BAND_INDEX_CONST),c.isFullColumn=i===GC.Spread.CalcEngine.BAND_INDEX_CONST,i>u&&(l=i,i=u,u=l,l=e,e=s,s=l),r>f&&(l=r,r=f,f=l,l=o,o=h,h=l),c.row=i,c.column=r,c.endRow=u,c.endColumn=f,c.rowRelative=e,c.columnRelative=o,c.endRowRelative=s,c.endColumnRelative=h,n&&(c.source=n),t&&(c.endSource=t),c},t.createErrorExpressionfunction=function(n,t,i){var r=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.error);return t&&(r.source=t),i&&(r.endSource=i),r.value=n,r},t.createFunctionExpression=function(n,t){var i=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.function);return i.arguments=t,n instanceof GC.Spread.CalcEngine.Expression?(i.function=n.function,i.functionName=n.functionName):(i.function=n.name&&n,i.functionName=n.name||n),i},t.createParenthesesExpression=function(n){var t=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.parentheses);return t.value=n,t},t.createOperatorExpression=function(n,t,i){var r=new GC.Spread.CalcEngine.Expression(GC.Spread.CalcEngine.ExpressionType.operator);return r.operatorType=n,r.value=t,r.value2=i,r},t.isCellExpression=function(n){return n.endRow===undefined},t.getReferenceStringByID=function(t){var i=n.Common.parseIDStr(t);return i?this.getReferenceString(i.row,i.col):null},t.getCellLogLocationString=function(t,i,r){var o=n.FormulaHelper.getReferenceStringByID(t),f=i?i.join(","):null,e=n.PageManager.getDesignerPageName(r,!1),u=o;return e&&u&&(u=e+"!"+u),f&&u&&(u=f+"("+u+")"),u},t.getListviewCellLogLocationString=function(t,i,r,u,f){var e=i===null||i===void 0?void 0:i.toString(),o,s;return r&&(e=r+":"+e),o=t===null||t===void 0?void 0:t.toString(),e&&(o="".concat(o,",").concat(e)),s=n.PageManager.getDesignerPageName(f,!1),"".concat(s,"!").concat(u,"(").concat(o,")")},t.getReferenceString=function(n,i){var r=t.createCellExpression(null,null,n,i,!0,!0);return t.unparse(r)},t.adjustNumberPrecision=function(n){return typeof n=="number"&&(n=Math.round(n*1e9)/1e9),n},t}();n.FormulaHelper=i;f=function(){function n(){}return n.prototype.visit=function(n,t,u){if(!n)return n;var f=r.ExpressionType;switch(n.type){case f.reference:return i.isCellExpression(n)?this.visitCellExpression(n,t,u):this.visitRangeExpression(n,t,u);case f.function:return this.visitFunctionExpression(n,t,u);case f.name:return this.visitNameExpression(n,t,u);case f.operator:return this.visitOperatorExpression(n,t,u);case f.parentheses:return this.visitParenthesesExpression(n,t,u);default:return n}},n.prototype.visitCellExpression=function(n){return n},n.prototype.visitRangeExpression=function(n){return n},n.prototype.visitFunctionExpression=function(n,t,r){for(var e,o=!1,f=[],u=0;u<n.arguments.length;u++)e=n.arguments[u],f[u]=this.visit(e,t,r),e!==f[u]&&(o=!0);return o?i.createFunctionExpression(n,f):n},n.prototype.visitNameExpression=function(n){return n},n.prototype.visitOperatorExpression=function(n,t,r){var u=this.visit(n.value,t,r),f=this.visit(n.value2,t,r);return u!==n.value||f!==n.value2?i.createOperatorExpression(n.operatorType,u,f):n},n.prototype.visitParenthesesExpression=function(n,t,r){var u=this.visit(n.value,t,r);return u!==n.value?i.createParenthesesExpression(u):n},n}();n.ExpressionVisitor=f;h=function(t){function u(){return t!==null&&t.apply(this,arguments)||this}return __extends(u,t),u.prototype.visitFunctionExpression=function(u,f,e){var o=t.prototype.visitFunctionExpression.call(this,u,f,e),s;return o.function instanceof r.Functions.AsyncFunction&&(s=new n.CustomFunction.AsyncToSyncFunction(o.functionName),o=i.createFunctionExpression(s,o.arguments)),o},u}(f);c=function(t){function i(n){var i=t.call(this)||this;return i._runTimePageName=n,i.ranges=[],i}return __extends(i,t),i.prototype.visit=function(t,i,u){var f,e;if(!t)return this.hasError=!0,t;f=r.ExpressionType;switch(t.type){case f.reference:return this.visitRangeExpression(t,i,u);case f.operator:return this.visitOperatorExpression(t,i,u);case f.name:return t.value?(e=n.ForguncyData.pageInfo.formulaManager.getCalcService().getGlobalSourceModel().getSource().getCustomName(t.value),this.visit(e,i,u)):(this.hasError=!0,t);default:return this.hasError=!0,t}},i.prototype.visitRangeExpression=function(t){return this.ranges.push({Row:t.row,Column:t.column,EndRow:t.endRow,EndColumn:t.endColumn,PageName:n.PageManager.getDesignerPageName(this._runTimePageName,!1),PageID:this._runTimePageName}),t},i.prototype.visitOperatorExpression=function(n,i,r){return n.operatorType!==16&&(this.hasError=!0),t.prototype.visitOperatorExpression.call(this,n,i,r)},i}(f)})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function i(){this._defaultFormulas=new t}return i.prototype.setDefaultFormula=function(t){var i=this;i.addDefaultFormulaToCollection(t);t.forEach(function(t){var r=i._defaultFormulas.getDefaultFormulaArray(t);r.forEach(function(i){n.ForguncyData.pageInfo.formulaManager.setFormula(t,i,function(n){return n===0||n===1||n===4})})})},i.prototype.clearDefaultFormula=function(t){var i=this;t.forEach(function(t){var r=i._defaultFormulas.getDefaultFormulaArray(t);r.forEach(function(i){i.Formula="";n.ForguncyData.pageInfo.formulaManager.setFormula(t,i,null)});i._defaultFormulas.clear(t)})},i.prototype.addDefaultFormulaToCollection=function(n){this.addNormalCellDefaultFomrulas(n);this._defaultFormulas.translateFormula(n)},i.prototype.addNormalCellDefaultFomrulas=function(t){var i=this,r=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t);r.forEach(function(t){var u=t.getDefaultFormula(),r;n.Common.IsEmpty(u)||(r=n.Common.parseIDStr(t.id),i._defaultFormulas.addDefaultFormula(r.suffix,r.row,r.col,u))})},i}(),t;n.DefaultFormulaManager=i;t=function(){function t(){this.defaultFormulas={}}return t.prototype.addDefaultFormula=function(n,t,i,r){var u=this.getDefaultFormulaArray(n),f=this.createFormulaInfo(t,i,r);u.push(f)},t.prototype.getDefaultFormulaArray=function(n){return this.defaultFormulas[n]||(this.defaultFormulas[n]=[]),this.defaultFormulas[n]},t.prototype.createFormulaInfo=function(n,t,i){return{RowIndex:n,ColumnIndex:t,RowCount:1,ColumnCount:1,IsArraryFormula:!1,Formula:i}},t.prototype.translateFormula=function(t){var i=this;t.forEach(function(t){var r=i.getDefaultFormulaArray(t),u,f;r&&(u=n.ListviewBase.getAllListviews([t]),f=new n.CellFormulaTranslater(t,t,u),r.forEach(function(n){return n.Formula=f.translate(n.Formula)}))})},t.prototype.clear=function(n){delete this.defaultFormulas[n]},t}()})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var e=GC.Spread.CalcEngine,i=function(){function t(){}return t.prototype.translate=function(t,i,r){if(i===void 0&&(i=0),r===void 0&&(r=0),n.Common.IsEmpty(t))return t;var u=n.FormulaHelper.parse(t,!0),f=this.createExpressionVisitor(),e=f.visit(u,i,r);return n.FormulaHelper.unparse(e)},t}(),r,u,f;n.FormulaTranslater=i;r=function(n){function t(t,i,r){var u=n.call(this)||this;return u._calcSourceName=t,u._runTimePageName=i,u._listviewList=r,u}return __extends(t,n),t.prototype.createExpressionVisitor=function(){return this._calcSourceName===this._runTimePageName?new o(this._listviewList):new s(this._calcSourceName,this._runTimePageName,this._listviewList)},t}(i);n.CellFormulaTranslater=r;var t=function(){function t(){}return t.getCalcSource=function(t){return n.ForguncyData.pageInfo.formulaManager.getCalcSource(t)},t.getLocatedListview=function(n,i,r,u,f){var o,e,s,h;if(n)for(o=n.length,e=0;e<o;e++)if(s=n[e].getRangeInfo(),h=n[e].getColumnHeaderRangeInfo(),t.isRangeIncluded(s,i,r,u,f)&&!t.isRangeIncluded(h,i,r,u,f))return n[e];return null},t.isRangeIncluded=function(n,t,i,r,u){return t>=n.Row&&r<n.Row+n.RowCount&&i>=n.Column&&u<n.Column+n.ColumnCount},t.getColumnIndexInListview=function(n,t){var r=n.getMergedColumnInfos(),i;if(r)for(i=0;i<r.length;i++)if(r[i].DesignerColumnIndex<=t&&r[i].DesignerColumnIndex+r[i].DesignerColumnCount>t){t=r[i].DesignerColumnIndex;break}return t-n.getRangeInfo().Column},t}(),o=function(i){function r(n){var t=i.call(this)||this;return t._listviewList=n,t}return __extends(r,i),r.prototype.visitNameExpression=function(n){return n.source=null,n},r.prototype.visitCellExpression=function(i){var r,f,u;return i.source?i:(r=t.getLocatedListview(this._listviewList,i.row,i.column,i.row,i.column),!r)?i:(f=t.getCalcSource(r.getCalcSheetName()),u=t.getColumnIndexInListview(r,i.column),n.FormulaHelper.createColumnRangeExpression(f,u,u,!0,!0))},r.prototype.visitRangeExpression=function(i){var r;if(i.source||(r=t.getLocatedListview(this._listviewList,i.row,i.column,i.endRow,i.endColumn),!r))return i;var u=t.getCalcSource(r.getCalcSheetName()),f=t.getColumnIndexInListview(r,i.column),e=t.getColumnIndexInListview(r,i.endColumn);return n.FormulaHelper.createColumnRangeExpression(u,f,e,!0,!0)},r}(n.ExpressionVisitor),s=function(i){function r(n,t,r){var u=i.call(this)||this;return u._calcSourceName=n,u._runTimePageName=t,u._listviewList=r,u}return __extends(r,i),r.prototype.visitNameExpression=function(n){return n.source=null,n},r.prototype.visitCellExpression=function(i){var r,u,f;return i.source?i:(r=t.getLocatedListview(this._listviewList,i.row,i.column,i.row,i.column),u=t.getCalcSource(r?r.getCalcSheetName():this._runTimePageName),r?(f=t.getColumnIndexInListview(r,i.column),r.getCalcSheetName()===this._calcSourceName?n.FormulaHelper.createCellExpression(u,null,0,f,i.rowRelative,i.columnRelative):n.FormulaHelper.createColumnRangeExpression(u,f,f,!0,!0)):(i.source=u,i))},r.prototype.visitRangeExpression=function(i){var r,u,f,e;return i.source?i:(r=t.getLocatedListview(this._listviewList,i.row,i.column,i.endRow,i.endColumn),u=t.getCalcSource(r?r.getCalcSheetName():this._runTimePageName),r?(f=t.getColumnIndexInListview(r,i.column),e=t.getColumnIndexInListview(r,i.endColumn),r.getCalcSheetName()===this._calcSourceName?n.FormulaHelper.createRangeExpression(u,null,0,f,0,e,i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative):n.FormulaHelper.createColumnRangeExpression(u,f,e,!0,!0)):(i.source=u,i))},r}(n.ExpressionVisitor),h=function(n){function t(t,i){var r=n.call(this)||this;return r._runTimePageName=t,r._namePair=i,r}return __extends(t,n),t.prototype.createExpressionVisitor=function(){return new u(this._runTimePageName,this._namePair)},t}(i);n.CustomNameFormulaTranslater=h;u=function(i){function r(n,t){var r=i.call(this)||this;return r._runTimePageName=n,r._namePair=t,r}return __extends(r,i),r.prototype.visitNameExpression=function(n){return n.source=null,n},r.prototype.visitCellExpression=function(n,t,i){return this.visitRangeExpression(n,t,i)},r.prototype.visitRangeExpression=function(i){var r=this._runTimePageName,u;return i.source instanceof GC.Spread.CalcEngine.CalcSource&&(u=i.source.getName(),r=this._namePair[u],n.Common.IsEmpty(r))?i:(i.source=t.getCalcSource(r),i)},r}(n.ExpressionVisitor);f=function(t){function i(n){var i=t.call(this)||this;return i._currentParamToReferDic=n,i.Updated=!1,i}return __extends(i,t),i.prototype.visit=function(n,i,r){if(!n)return n;var u=e.ExpressionType;return n.type===u.name?this.visitNameExpression(n):t.prototype.visit.call(this,n,i,r)},i.prototype.visitNameExpression=function(t){var i=this._currentParamToReferDic[t.value],r;if(i!==undefined)try{return r=n.FormulaHelper.parse(i),this.Updated=!0,r}catch(u){}return t},i}(n.ExpressionVisitor);n.UpdateParamReferVisitor=f})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.GetEditorInfo=function(t,i,r){var u={editorDataInfos:t};n.Common.forguncyPost("Home/GetEditorInfo",u,function(n){i&&i.apply(null,[n])},r+" GetEditorInfo")},t.GetTableDataWithOffset=function(t,i,r,u,f){var e={bindingInfos:t.columnBindingInfos,currentRowInfo:t.rowInfo,demandRowCount:t.demandRowCount,currentDataLength:t.currentDataLength,needRowVersion:t.needRowVersion,queryCommandInfo:t.queryData,editorDataInfos:t.editorDataInfos,sortCommandID:t.sortCommandID,orderByInfo:t.sortInfo,offsetConditionInfo:t.offsetCondition,columnFilterQueries:t.columnFilterQueries,totalRowBindingInfos:t.totalRowBindingInfos,pageName:t.pageName};n.Common.forguncyPost("Home/GetTableDataWithOffset",e,function(n){i&&i.apply(null,[n])},u+" GetTableDataWithOffset",function(){r()},function(){f===null||f===void 0?void 0:f()})},t.GetTotalRowValues=function(t,i,r){var u={bindingInfos:t.columnBindingInfos,currentRowInfo:t.rowInfo,queryCommandInfo:t.queryData,columnFilterQueries:t.columnFilterQueries,totalRowBindingInfos:t.totalRowBindingInfos,pageName:t.pageName};n.Common.forguncyPost("Home/GetTotalRowValues",u,function(n){i&&i.apply(null,[n])},r+" GetTotalRowValues")},t.GetRowCount=function(t,i){n.Common.forguncyPost("Home/GetRowCount",t,function(n){i&&i.apply(null,[n])})},t.CalcParamValue=function(t,i,r){n.Common.forguncyPost("Home/CalcParamValue",t,function(n){i&&i.apply(null,[n])},null,function(){r&&r.apply(null)})},t.GetRowsDataForColumnFilter=function(t,i,r){var u={bindingInfos:t.columnBindingInfos,currentRowInfo:t.rowInfo,queryCommandInfo:t.queryData,sortCommandID:t.sortCommandID,orderByInfo:t.sortInfo,offsetConditionInfo:t.offsetCondition,columnFilterQueries:t.columnFilterQueries,pageName:t.pageName};n.Common.forguncyPost("Home/GetRowsDataForColumnFilter",u,function(n){i&&i.apply(null,[n])},r+" GetRowsDataForColumnFilter")},t.GetTableDataByColumnBindingInfo=function(t,i,r,u){u===void 0&&(u=!0);var f="Home/GetTableDataByColumnBindingInfos",e=function(n){i&&i.apply(null,[n])};u?n.Common.forguncyPost(f,t,e,r+" GetTableDataByColumnBindingInfos"):n.Common.forguncyPostSync(f,t,e)},t.GetTableRowData=function(t,i){var r={bindingInfos:t.columnBindingInfos,query:t.query,currentTableName:t.table};n.Common.forguncyPost("Home/GetTableRowData",r,function(n){i&&i.apply(null,[n])},"GetTableRowData "+t.table)},t.SetUserSelectorItemsInfo=function(t,i){var r={role:typeof t.Role=="undefined"?"":t.Role,displayColumnName:t.DisplayColumnName===undefined?"":t.DisplayColumnName,columns:t.Columns,customColumns:t.CustomColumns===undefined?"":t.CustomColumns.join(",")};n.Common.forguncyPost("Account/GetUsers",r,function(i){var o,f,e,u,r;if(t.ItemsInfo=i||{Items:[]},t.haveLoadItems=!0,t.UserInfo=[],i===null||i===void 0?void 0:i.Properties)for(o=i.Properties.users,f=JSON.parse(i.Properties.columns),e=0;e<o.length;e++){u=o[e];r=null;switch(t.DisplayColumnName){case"Name":r=u.UserName;break;case"FullName":r=u.FullName;break;case"Email":r=u.Email;break;default:r=n.UserInfoHelper.getUserPropertyValue(u,t.DisplayColumnName)}n.Common.IsEmpty(r)&&n.Common.IsEmpty(t.DisplayColumnName)&&(f.Name?r=u.UserName:f.FullName?r=u.FullName:f.Email?r=u.Email:t.CustomColumns&&t.CustomColumns.length>0&&(r=n.UserInfoHelper.getUserPropertyValue(u,t.CustomColumns[0])));t.UserInfo.push({Value:u.UserName,DisplayValue:r})}},"GetUsers "+i)},t.CommitEditedTable=function(t,i,r){var u={editedTableInfo:t.tableInfo,listviewName:t.viewName,masterQuery:t.masterQuery};n.Common.forguncyPost("Home/CommitEditedTable",u,function(n){i&&i.apply(null,[n])},null,r)},t.GetAutoGeneratedIDsOfPage=function(t,i){var r={pageName:t};n.Common.forguncyPost("Home/GetAutoGeneratedIDsOfPage",r,function(n){i&&i(n)},null,function(){i&&i(null)})},t.RefreshToken=function(){var i=setInterval(function(){var r,u,f;if(n.ForguncyData.IsConcurrenyUserLicense||n.ForguncyData.EnableSession){for(r in n.BuiltInPageManager.builtInPages)if(n.BuiltInPageManager.builtInPages[r]===n.ForguncyData.pageInfo.pageName)return;if(n.ForguncyData.AutoDisconnectTimeout&&(u=n.ForguncyData.AutoDisconnectTimeout,(new Date).valueOf()-t.lastOperateTime.valueOf()>u*6e4)){if(n.ForguncyData.EnableSession){f=new n.UserManagerCommand;f.Logout({NavigateWhenLogoutMode:n.NavigateWhenLogoutMode.None},function(){t.NavigateToDisconnectedPage(i)},!0);return}t.NavigateToDisconnectedPage(i)}n.Common.forguncyPost("Refresh/B0DA262E-08A7-48FE-B478-BDE2B817B902",null,function(){})}},6e4)},t.NavigateToDisconnectedPage=function(n){$(window.document.body).children().remove();clearInterval(n);$(window.document.body).append(t.CreateDisconnectedPage());$(window.document.body).css("height","90%");$("html").css("height","100%")},t.CreateDisconnectedPage=function(){var t=n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/pageDisconnected.png";return $('\n    <div style="margin:auto" class="container">\n        <style>\n            .container{\n                width: 100%;\n                height: 80%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                flex-direction: column;\n            }\n            .reloadButton{\n                background: #4A90E2;\n                padding: 10px 30px;\n                color: white;\n                border: none;\n            }\n            .reloadButton:hover{\n                background: #8AB7EC;\n                cursor:pointer;\n            }\n            .reloadButton:active{\n                background: #3080DD;\n            }\n          <\/style>\n        <img src="'.concat(t,'" style="margin-bottom:55px"><img>\n        <div style="margin-bottom:10px">').concat(n.RS.LongTimeNoOperation,'<\/div>\n        <div style="margin-bottom:40px">').concat(n.RS.PleaseClickButtonToReload,'<\/div>\n        <button class="reloadButton" onclick="location.reload()">').concat(n.RS.ReloadPage,"<\/button>\n    <\/div>\n"))},t.Operate=function(){t.lastOperateTime=new Date},t.GetQueryInfo=function(t,i,r){var u={tableName:t,queryDic:i};n.Common.forguncyPost("Home/GetQueryInfo",u,function(n){r&&r.apply(null,[n])},"GetQueryInfo"+t)},t.GetQueryInfoByCondition=function(t,i){var r={queryCondition:t};n.Common.forguncyPost("Home/GetQueryInfoByCondition",r,function(n){i&&i.apply(null,[n])},"GetQueryInfoByCondition"+t.Id)},t.lastOperateTime=new Date,t}();n.HomeController=t;n.HomeController.RefreshToken();window.addEventListener("mousedown",function(){t.Operate()},!0);window.addEventListener("keydown",function(){t.Operate()},!0);window.addEventListener("touchstart",function(){t.Operate()},!0)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var f=function(){function t(){this.events=new n.EventClassBase}return t.prototype.on=function(n,t){return this.events.bind(n,t),this},t.prototype.off=function(n,t){return this.events.unbind(n,t),this},t.prototype.dispatch=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return(i=this.events).trigger.apply(i,__spreadArray([n],r,!1)),this},t.prototype.dispose=function(){this.events.unbindAll()},t}(),i,r,u,e,o;t.EventDispatcher=f;i=function(n){function t(){var t=n.call(this)||this;return t.enabled=!0,t.visibility=!0,t.focusable=!1,t.isFocus=!1,t.classNames="",t.properties=[],t.attrs={},t.css={},t.registDefaultProperties(),t}return __extends(t,n),t.prototype.registDefaultProperties=function(){this.registProperty("id");this.registProperty("enabled");this.registProperty("visibility");this.registProperty("focusable");this.registProperty("isFocus");this.registProperty("classNames");this.registProperty("attrs");this.registProperty("css")},t.prototype.refresh=function(){return this.dispatch("Refresh"),this},t.prototype.identify=function(n){return this.id=n,this},t.prototype.addClass=function(n){return this.classNames+=" "+n,this},t.prototype.addCss=function(n){return this.css=n,this},t.prototype.addAttrs=function(n){return this.attrs=n,this},t.prototype.show=function(){return this.visibility=!0,this},t.prototype.hide=function(){return this.visibility=!1,this},t.prototype.focus=function(){return this.isFocus=!0,this},t.prototype.blur=function(){return this.isFocus=!1,this},t.prototype.enable=function(){return this.enabled=!0,this},t.prototype.disable=function(){return this.enabled=!1,this},t.prototype.dispose=function(){this.dispatch("Dispose");n.prototype.dispose.call(this)},t.prototype.createUI=function(n){return n===void 0&&(n=this.defaultUI),new n(this)},t.prototype.bindProperty=function(n,t,i){var r=this;this.properties.indexOf(i)<0&&this.registProperty(i);n.properties.indexOf(t)<0&&n.registProperty(t);n[t]=this[i];n.on("PropertyChanged",function(u,f){f===t&&n&&(r[i]=n[t])});this.on("PropertyChanged",function(u,f){f===i&&n&&(n[t]=r[i])})},t.prototype.registProperty=function(n,t){var u,i,r;t===void 0&&(t=this[n]);i=this;r="_"+n;this[r]=t;Object.defineProperties(this,(u={},u[n]={get:function(){return i[r]},set:function(t){if(t!==i[r]){i[r]=t;i.onPropertyChanged(n)}}},u));this.properties.push(n)},t.prototype.onPropertyChanged=function(n){this.dispatch("PropertyChanged",n)},t}(f);t.UserControl=i;r=function(){function n(n){this.target=n;this.bindTargetEvents();this.createContainer();this.createContainerEvents();this.createModifiers();this.invokeModifyContainer();this.refresh()}return n.prototype.refresh=function(){return this.disposeChildren(),this.container.empty(),this.createChildren(),this},n.prototype.dispose=function(){this.disposeChildren();this.disposeModifiers();this.container.remove()},n.prototype.applyModifier=function(n){return this.modifiers||(this.modifiers=[]),this.modifiers.push(n),n.modifyContainer(),n.modifyProperties(),this},n.prototype.bindTargetEvents=function(){},n.prototype.createContainer=function(){this.container=$(document.createElement("div"))},n.prototype.createContainerEvents=function(){},n.prototype.createModifiers=function(){},n.prototype.invokeModifyContainer=function(){this.modifiers&&this.modifiers.forEach(function(n){n.modifyContainer()})},n.prototype.disposeModifiers=function(){var n;(n=this.modifiers)===null||n===void 0?void 0:n.forEach(function(n){n===null||n===void 0?void 0:n.dispose()})},n.prototype.createChildren=function(){},n.prototype.disposeChildren=function(){var n;(n=this.childrenUI)===null||n===void 0?void 0:n.forEach(function(n){n===null||n===void 0?void 0:n.dispose()});this.childrenUI=[]},n.prototype.addChild=function(n,t){return t===void 0&&(t=this.container),n&&t&&(this.childrenUI.push(n),t.append(n.container)),n},n}();t.JQueryUIBase=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"id",{set:function(t){n.Common.IsEmpty(t)?this.container.removeAttr("id"):this.container.attr("id",t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{set:function(n){this.setEnabledProperty(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visibility",{set:function(n){n?this.container.show():this.container.hide()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"focusable",{set:function(n){n&&this.target.enabled?this.focusableContainer.attr("tabindex","0"):this.focusableContainer.removeAttr("tabindex")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isFocus",{set:function(n){n&&this.target.focusable?this.focusableContainer[0].focus():this.focusableContainer[0].blur()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"focusableContainer",{get:function(){return this.container},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"classNames",{set:function(n){this.container.addClass(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"css",{set:function(n){this.container.css(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"attrs",{set:function(n){for(var t in n)this.container.attr(t,n[t])},enumerable:!1,configurable:!0}),i.prototype.refresh=function(){return t.prototype.refresh.call(this),this.initializeProperties(),this.invokeModifyProperties(),this.bindFocusAndBlurEvent(),this},i.prototype.bindTargetEvents=function(){var n=this;this.target.on("Refresh",function(){n.refresh()});this.target.on("PropertyChanged",function(t,i){n[i]=n.target[i]});this.target.on("Dispose",function(){n.dispose()})},i.prototype.initializeProperties=function(){var n=this;this.target.properties.forEach(function(t){n[t]=n.target[t]})},i.prototype.invokeModifyProperties=function(){this.modifiers&&this.modifiers.forEach(function(n){n.modifyProperties()})},i.prototype.bindFocusAndBlurEvent=function(){var n=this;this.focusableContainer.on("focus",function(){n.target.focus();n.container.toggleClass("FUI-focus",!0)});this.focusableContainer.on("blur",function(){n.target.blur();n.container.toggleClass("FUI-focus",!1)})},i.prototype.setEnabledProperty=function(n,t){t===void 0&&(t=this.container);n?(t.removeClass("FUI-disable"),t.removeAttr("disabled"),this.focusable=this.target.focusable):(t.addClass("FUI-disable"),t.attr("disabled","disabled"),this.focusable=!1)},i}(r);t.ControlUIBase=u;e=function(n){function t(){var t=n.call(this)||this;return t.moveable=!1,t.registProperty("location"),t.registProperty("moveable"),t}return __extends(t,n),t.prototype.updateSizeFromUI=function(){this.dispatch("UpdateSizeFromUI")},t}(i);t.MoveableControl=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"location",{set:function(n){n&&this.container.offset({left:n.x,top:n.y})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"moveableContainer",{get:function(){return this.container},enumerable:!1,configurable:!0}),i.prototype.createContainerEvents=function(){t.prototype.createContainerEvents.call(this);this.bindUpdateSizeEvent()},i.prototype.bindUpdateSizeEvent=function(){var n=this;this.target.on("UpdateSizeFromUI",function(){n.onUpdateSizeEvent()})},i.prototype.onUpdateSizeEvent=function(t){t===void 0&&(t=this.container);this.target.sizeFromUI=new n.Numerics.Vector2(t.width(),t.height())},i}(u);t.MoveableControlUI=o})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var i=function(){function n(n){this.ui=n}return n.prototype.modifyContainer=function(){},n.prototype.modifyProperties=function(){},n.prototype.dispose=function(){},n}(),r,u,f;t.UIModifier=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.modifyContainer=function(){this._enforceFocusToPopupContainer()},i.prototype._enforceFocusToPopupContainer=function(){$(document).off("focusin #".concat(this.ui.target.id),"",i._documentFocusinHandler);$(document).on("focusin #".concat(this.ui.target.id),"",this.ui,i._documentFocusinHandler)},i._documentFocusinHandler=function(t){var s=t.data,f=document.activeElement,r=$(f),e,u,o;if(r.attr("imcontroltype")!=="Calendar"&&r.attr("ignoreFocusInPopup")!=="true"&&!(r.closest('[ignoreFocusInPopup="true"]').length>0)&&r.attr("FGCPopup")!=="true"&&!(r.closest('[FGCPopup="true"]').length>0)&&!(r.parents("#".concat("fgc-columnfilter-contextmenu")).length>0)&&!(r.parents("#".concat("fgc-rowheader-contextmenu")).length>0)&&r.parents("#pagesContainer").length!==0){if(e=$(".".concat("FUI-dialog",".").concat("FUI-show")).not(":hidden"),e.length===0){$(document).off("focusin #".concat(s.target.id),i._documentFocusinHandler);return}(u=e.last(),u.find(".FUI-dialog-content").length!==0)&&(u[0]===f||u.has(f).length||(o=r.attr("gcuielement"),o==="gcSheetFocusElementForTab"||o==="gcEditingInput"?n.DelayRefresh.setTimeout(function(){i.lostAllListviewsFocus();i.moveFocusToFirstElement(u[0])}):i.moveFocusToFirstElement(u[0])))}},i.lostAllListviewsFocus=function(){var t=n.ListviewBase.getAllListviews();t.forEach(function(n){n.focus(!1)})},i.moveFocusToFirstElement=function(t){var i=n.FocusMoveHelper.MoveFocusToFirstElement();i||t.focus()},i}(i);t.DialogFocusModifier=r;u=function(){function t(n){this.placement=n}return Object.defineProperty(t.prototype,"location",{get:function(){var t=this.placement.offset();return new n.Numerics.Vector2(t.left,t.top)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var t=this.placement.outerWidth(),i=this.placement.outerHeight();return new n.Numerics.Vector2(t,i)},enumerable:!1,configurable:!0}),t}();t.Anchor=u;f=function(t){function i(n,i){var r=t.call(this,n)||this;r.anchor=i;n.target.on("Dispose",function(){r.releaseResizeEvent()});return r}return __extends(i,t),i.prototype.modifyProperties=function(){this.releaseResizeEvent();this.bindResizeEvent();this.adjustLocation()},i.prototype.dispose=function(){this.releaseResizeEvent()},i.prototype.bindResizeEvent=function(){var n=this;this.resizeHandler=function(){window.requestAnimationFrame(function(){return n.adjustLocation()})};$(window).on("resize",this.resizeHandler);this.visibilityChangedHandler=function(t,i){i==="visibility"&&n.ui.target.visibility&&n.resizeHandler()};this.ui.target.on("PropertyChanged",this.visibilityChangedHandler)},i.prototype.releaseResizeEvent=function(){this.resizeHandler&&$(window).off("resize",this.resizeHandler);this.visibilityChangedHandler&&this.ui.target.off("PropertyChanged",this.visibilityChangedHandler)},i.prototype.adjustLocation=function(){var s=this.anchor.location,r=s.x,u=s.y,h=this.anchor.size,y=h.x,f=h.y,e=this.ui.moveableContainer.width(),o=this.ui.moveableContainer.height(),t;if(e!==0||o!==0){var c=$(document).scrollLeft(),l=$(document).scrollTop(),a=c+$(window).innerWidth(),v=l+$(window).innerHeight(),i=r;r+e>a&&(i=r+y-e);(i<c||i>a)&&(i=r);t=u+f;u+f+o>v&&(t=u-o);(t<l||t>v)&&(t=u+f);this.ui.target.location=new n.Numerics.Vector2(i,t)}},i}(i);t.AutoLocateModifier=f})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i,t,u,f,r;n.FlexDirectionCSSNames=(i={},i[0]="FUI-flex-direction-row",i[1]="FUI-flex-direction-column",i[2]="FUI-flex-direction-row-reverse",i[3]="FUI-flex-direction-column-reverse",i);n.FlexAlignItemsCSSNames=(t={},t[0]="FUI-flex-align-items-flex-start",t[1]="FUI-flex-align-items-flex-end",t[2]="FUI-flex-align-items-center",t[3]="FUI-flex-align-items-baseline",t[4]="FUI-flex-align-items-stretch",t);u=function(){function n(){}return n}();n.FlexLayoutOption=u;f=function(n){function t(t,i){var u;t===void 0&&(t=0);i===void 0&&(i={});u=n.call(this)||this;u.items=[];u.defaultUI=r;var f=Object.assign({wrap:!1},i),e=f.alignItems,o=f.wrap;return u.registProperty("items"),u.registProperty("layout",t),u.registProperty("wrap",o),u.registProperty("alignItems",e),u}return __extends(t,n),t.prototype.add=function(){for(var t,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(t=this.items).push.apply(t,i);this.onPropertyChanged("items");return this},t.prototype.insert=function(n,t){this.items.splice(n,0,t);this.onPropertyChanged("items");return this},t.prototype.remove=function(n){this.items.splice(this.items.indexOf(n),1);this.onPropertyChanged("items");return this},t.prototype.clear=function(){this.items=[];this.onPropertyChanged("items");return this},t}(n.UserControl);n.FlexLayout=f;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"items",{set:function(){this.container.empty();this.createChildren()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"layout",{set:function(t){for(var i in n.FlexDirectionCSSNames)this.container.removeClass(n.FlexDirectionCSSNames[i]);this.container.addClass(n.FlexDirectionCSSNames[t])},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wrap",{set:function(n){n?this.container.css("flex-wrap","wrap"):this.container.css("flex-wrap","nowrap")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"alignItems",{set:function(t){for(var i in n.FlexAlignItemsCSSNames)this.container.removeClass(n.FlexAlignItemsCSSNames[i]);t&&n.FlexAlignItemsCSSNames[t]&&this.container.addClass(n.FlexAlignItemsCSSNames[t])},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"cssName",{get:function(){return""},enumerable:!1,configurable:!0}),i.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-flexlayout"," ").concat(this.cssName,'"><\/div>'))},i.prototype.createChildren=function(){var n=this;this.target.items&&this.target.items.forEach(function(t){n.addChild(t.createUI())})},i}(n.ControlUIBase);n.FlexLayoutUI=r})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var r=function(n){function i(i,r,u){i===void 0&&(i="");r===void 0&&(r="");u===void 0&&(u="");var f=n.call(this)||this;return f.classNames="".concat("FUI-button"," ").concat("FUI-button-default"),f.focusable=!0,f.defaultUI=t,f.registProperty("text",i),f.registProperty("svg",r),f.registProperty("tooltip",u),f}return __extends(i,n),i.prototype.click=function(){this.dispatch("Clicked")},i}(n.UserControl),t,u,i;n.Button=r;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"svg",{set:function(n){this.svgContainer.empty();this.svgContainer.append($(n))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{set:function(n){this.container.attr("title",n)},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("div"))},t.prototype.createChildren=function(){this.svgContainer=$(document.createElement("span")).addClass("FUI-button-svg");this.textContainer=$(document.createElement("span")).addClass("FUI-button-text");this.container.append(this.svgContainer,this.textContainer)},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("mousedown",function(n){n.stopPropagation()});this.container.on("mouseup",function(n){n.stopPropagation()});this.container.on("click",function(n){n.stopPropagation();t.target.click()});this.container.on("keypress",function(n){(n.keyCode===13||n.keyCode===32)&&(n.preventDefault(),n.stopPropagation(),t.target.click())})},t}(n.ControlUIBase);n.ButtonUI=t;u=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=i,t}return __extends(t,n),t.prototype.click=function(){n.prototype.click.call(this);this.isChecked=!this.isChecked},t}(r);n.ToggleButton=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.container.toggleClass("FUI-checked",n)},enumerable:!1,configurable:!0}),t}(t);n.ToggleButtonUI=i})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.FlexLayout),t;n.ButtonGroup=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-button-group"},enumerable:!1,configurable:!0}),t}(n.FlexLayoutUI);n.ButtonGroupUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(i,r){var u=n.call(this)||this;return u.isChecked=!1,u.focusable=!0,u.defaultUI=t,u.registProperty("text",i),u.registProperty("name",r),u.registProperty("isChecked"),u}return __extends(i,n),i}(n.UserControl),t;n.Toggle=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{set:function(n){n!==undefined&&this.inputContainer.attr("name",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.inputContainer[0].checked=n;this.container.toggleClass("FUI-checked",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusableContainer",{get:function(){return this.inputContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cssName",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("label")).addClass("FUI-toggle").addClass(this.cssName)},t.prototype.createChildren=function(){this.createInnerContainer();this.createTextContainer();this.container.append(this.innerContainer,this.textContainer)},t.prototype.createInnerContainer=function(){var n=this;this.innerContainer=$(document.createElement("label")).addClass("FUI-toggle-inner");this.inputContainer=$(document.createElement("input")).addClass("FUI-toggle-input").attr("type",this.type).on("change",function(){n.target.isChecked=n.inputContainer[0].checked});this.innerContainer.append(this.inputContainer)},t.prototype.createTextContainer=function(){this.textContainer=$(document.createElement("span")).addClass("FUI-toggle-text").text(this.target.text)},t.prototype.setEnabledProperty=function(t){n.prototype.setEnabledProperty.call(this,t);t?this.inputContainer.removeAttr("disabled"):this.inputContainer.attr("disabled","disabled")},t}(n.ControlUIBase);n.ToggleUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.Toggle),t;n.Radio=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-radio"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return"radio"},enumerable:!1,configurable:!0}),t.prototype.createInnerContainer=function(){var t=this;n.prototype.createInnerContainer.call(this);this.inputContainer.on("change",function(){t.target.isChecked&&($("input[name=".concat(t.inputContainer.attr("name"),"]")).not(t.inputContainer).trigger("change"),t.target.dispatch("Checked"))})},t}(n.ToggleUI);n.RadioUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.FlexLayout),t;n.RadioGroup=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-radio-group"},enumerable:!1,configurable:!0}),t}(n.FlexLayoutUI);n.RadioGroupUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var r=function(t){function r(r){var u=t.call(this)||this;u.actionColumns=[];u.selectedKeys=new Set;u.defaultUI=i;u.loadUserStep=25;u.loadUserTick=0;u.loadScrollDistance=50;var e=r.columns,y=e===void 0?[]:e,o=r.dataSource,p=o===void 0?[]:o,s=r.selectedKeys,w=s===void 0?[]:s,h=r.isMultiSelect,c=h===void 0?!1:h,l=r.isNeedIndex,b=l===void 0?!1:l,a=r.isNeedHeader,k=a===void 0?!0:a,f=[],v=[];return y.forEach(function(n){var t=n.type;if(!t){f.push(Object.assign({type:"Data"},n));return}switch(t){case"Action":v.push(n);break;default:f.push(n)}}),u.columns=f,u.actionColumns=v,u.dataSource=__spreadArray([],p,!0),u.canLoadDataSource=__spreadArray([],u.dataSource,!0),u.selectedKeys=new Set(w),u.isMultiSelect=c,u.isNeedIndex=b,u.isNeedHeader=k,u.isNeedCheckCol=n.Common.IsEmpty(r.isNeedCheckCol)?c:r.isNeedCheckCol,u}return __extends(r,t),Object.defineProperty(r.prototype,"isSingleSelect",{get:function(){return!this.isMultiSelect},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hasActionButton",{get:function(){return this.actionColumns.length>0},enumerable:!1,configurable:!0}),r.prototype.unselect=function(n){this.dispatch("PassiveUnselectedItems",n)},r.prototype.filter=function(n){this.dispatch("Filter",n)},r}(t.UserControl),i;t.Table=r;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-table",'"><\/div>'))},i.prototype.getLayoutTemplate=function(){var i=this,t=this.target,s=t.isMultiSelect,r=t.isNeedCheckCol,u=t.isNeedIndex,h=t.isNeedHeader,f=t.columns,e=t.hasActionButton,c=t.canLoadDataSource,l=t.selectedKeys,o="\n            <colgroup>\n                ".concat(u?'<col style="width: 50px"><\/col>':"","\n                ").concat(r?'<col style="width: 50px"><\/col>':"","\n                ").concat(f.map(function(n){switch(n.type){case"Data":return i._getLayoutColgroupBaseTemplate(n);case"Custom":return i.getLayoutColgroupCustomTemplate(n);default:return""}}).join(""),"\n                ").concat(e?"<col><\/col>":"","\n             <\/colgroup>"),a=h?"<table automationid='".concat("table_header","'>\n                    ").concat(o,"\n                    <thead>\n                        <tr>\n                            ").concat(u?'<th data-key="index"><\/th>':"","\n                            ").concat(r?'<th data-key="isChecked">'.concat(s?'<input type="checkbox" name="isAllCheck" '.concat(l.size===c.length?"checked":""," />"):"","<\/th>"):"","\n                            ").concat(f.map(function(n){switch(n.type){case"Data":return i._getLayoutHeaderBaseTemplate(n);case"Custom":return i.getLayoutHeaderCustomTemplate(n);default:return""}}).join(""),"\n                            ").concat(e?'<th data-key="actions">'.concat(n.RS.UI_Table_ActionColumn,"<\/th>"):"","\n                        <\/tr>\n                    <\/thead>\n                <\/table>"):"",v='<div class="'.concat("FUI-table-body-wrapper","\">\n                    <table automationid='").concat("table_body","'>\n                        ").concat(o,"\n                        <tbody><\/tbody>\n                    <\/table>\n                <\/div>");return"".concat(a,"\n                  ").concat(v)},i.prototype.getChildrenRows=function(n){var i=this,t=this.target,r=t.isMultiSelect,u=t.isNeedCheckCol,f=t.isNeedIndex,e=t.columns,o=t.hasActionButton,s=t.actionColumns,h=this.target.loadUserStep*this.target.loadUserTick;return n.map(function(n,t){var c=$('\n                    <tr data-key="'.concat(n.key,'">\n                        ').concat(f?'<td data-key="index">'.concat(h+t+1,"<\/td>"):"","\n                        ").concat(u?'<td data-key="isChecked"><input type="'.concat(r?"checkbox":"radio",'" name="isCheck" /><\/td>'):"","\n                        ").concat(e.map(function(n){switch(n.type){case"Data":return i._getDataColumnBaseTemplate(n);case"Custom":return i.getDataColumnCustomTemplate(n);default:return""}}).join(""),"\n                        ").concat(o?"<td class='".concat("FUI-table-action-column","'>").concat(s.map(function(n){var t=n.key,i=n.label;return'<div role="'.concat(t,'">').concat(i,"<\/div>")}).join(""),"<\/td>"):"","\n                    <\/tr>\n                "));return i.setChildrenRowData(c,n),c})},i.prototype._getLayoutColgroupBaseTemplate=function(t){var i=t.width;return n.Common.IsEmpty(i)?"<col><\/col>":'<col style="width: '.concat(i,'">')},i.prototype._getLayoutHeaderBaseTemplate=function(n){var t=n.key,i=n.label;return'<th data-key="'.concat(t,'">').concat(i,"<\/th>")},i.prototype._getDataColumnBaseTemplate=function(n){var t=n.key;return'<td data-key="'.concat(t,'"><\/td>')},i.prototype.getLayoutColgroupCustomTemplate=function(n){return this._getLayoutColgroupBaseTemplate(n)},i.prototype.getLayoutHeaderCustomTemplate=function(n){return this._getLayoutHeaderBaseTemplate(n)},i.prototype.getDataColumnCustomTemplate=function(n){return this._getDataColumnBaseTemplate(n)},i.prototype.setChildrenCellData=function(n,t,i){if(Object.prototype.hasOwnProperty.call(t,i)){var r=n.find('[data-key="'.concat(i,'"]')),u=t[i];r.text(u);r.attr("title",u)}},i.prototype.setChildrenRowData=function(n,t){var i=this;this.target.columns.forEach(function(r){var u=r.key;return i.setChildrenCellData(n,t,u)})},i.prototype.createChildren=function(){var t=this;this.container.append($(this.getLayoutTemplate()));this.initData();this.loadMoreContent();window.requestAnimationFrame(function(){n.ModuleLoader.IsModuleLoaded(["simpleBar"])?n.DomUtilities.applySimpleBar(t.container.find(".".concat("FUI-table-body-wrapper"))):n.ModuleLoader.LoadModels(["simpleBar"],n.ForguncyData.ForguncyRoot).done(function(){n.DomUtilities.applySimpleBar(t.container.find(".".concat("FUI-table-body-wrapper")))});t.container.find("table[automationid='".concat("table_body","']")).parent().on("scroll",function(n){t.target.loadUserTimer>0&&clearTimeout(t.target.loadUserTimer);t.target.loadUserTimer=setTimeout(function(){var i=n.target.scrollTop,r=n.target.scrollHeight;Math.ceil(i)+Math.ceil(t.container.height())+t.target.loadScrollDistance>=r&&t.loadMoreContent()},50)})})},i.prototype.initData=function(){this.target.loadUserTick=0;this.target.loadUserTimer=0;this.target.canLoadDataSource=__spreadArray([],this.target.dataSource,!0);this.container.find("table[automationid='".concat("table_body","'] tbody")).empty()},i.prototype.loadMoreContent=function(){var r=this,u=this.target.loadUserStep*this.target.loadUserTick,f=this.target.loadUserStep*(1+this.target.loadUserTick),t=this.target.canLoadDataSource.slice(u,f),n,i;t.length!==0&&(n=document.createDocumentFragment(),this.getChildrenRows(t).forEach(function(t){r.handleRowsChanged($(t));n.appendChild(t[0])}),i=this.container.find("table[automationid='".concat("table_body","'] tbody")),i[0].appendChild(n),this.target.loadUserTick++)},i.prototype.createContainerEvents=function(){var t=this;this.container.on("click","table thead tr input[name='isAllCheck']",function(n){var i=n.currentTarget,r=i.checked;r?t.handleSelect():t.handlUnselect()});this.container.on("click","table tbody tr",function(n){return __awaiter(t,void 0,void 0,function(){var i,t,r,e,u,f;return __generator(this,function(o){switch(o.label){case 0:return(i=n.currentTarget,t=$(i).attr("data-key"),r=$(i).find("input[name='isCheck']"),e=n.target.name==="isCheck"?r.prop("checked"):!r.prop("checked"),e?this.handleSelect([t]):this.handlUnselect([t]),u=$(n.target).attr("role"),f=this.target.dataSource.findIndex(function(n){return n.key===t}),!(u&&f>-1))?[3,2]:[4,this.actionExecute(f,u,$(i),t)];case 1:o.sent();o.label=2;case 2:return[2]}})})});this.target.on("PassiveUnselectedItems",function(n,i){t.handlUnselect([i])});this.target.on("Filter",function(i,r){t.initData();t.target.canLoadDataSource=t.target.dataSource.filter(function(t){return Object.keys(t).some(function(i){return n.Common.getLowerCaseString(t[i]).includes(n.Common.getLowerCaseString(r))})});t.loadMoreContent();t.updateIsAllCheckbox()})},i.prototype.handleSelect=function(n){var t=this,i,r;n===void 0&&(n=[]);i=n.length===0;i?(n=this.target.canLoadDataSource.map(function(n){return n.key}),n.forEach(function(n){t.target.selectedKeys.add(n)}),this.container.find("tbody tr:visible").each(function(n,i){t.handleRowsChanged($(i))})):(this.target.isSingleSelect&&(r=this.target.selectedKeys.size>0,r&&this.handlUnselect()),n.forEach(function(n){t.target.selectedKeys.add(n);t.handleRowsChanged(t.container.find("table tbody tr[data-key='".concat(n,"']")))}));this.updateIsAllCheckbox();this.target.dispatch("SelectedItems",n)},i.prototype.handlUnselect=function(n){var t=this,i;n===void 0&&(n=[]);i=n.length===0;i?(this.target.selectedKeys.clear(),this.container.find("tbody tr:visible").each(function(n,i){t.handleRowsChanged($(i))})):n.forEach(function(n){t.target.selectedKeys.delete(n);t.handleRowsChanged(t.container.find("table tbody tr[data-key='".concat(n,"']")))});this.updateIsAllCheckbox();this.target.dispatch("UnselectedItems",n)},i.prototype.handleRowsChanged=function(n){var i=n.attr("data-key"),t=n.find("input[name='isCheck']");this.target.selectedKeys.has(i)?(n.addClass("FUI-table-item-selected"),t.prop("checked",!0)):(n.removeClass("FUI-table-item-selected"),t.prop("checked",!1))},i.prototype.updateIsAllCheckbox=function(){if(!this.target.isSingleSelect){var n=this.container.find("tbody tr:visible input[name='isCheck']").toArray(),t=n.length>0&&n.every(function(n){return $(n).prop("checked")});this.container.find("thead tr input[name='isAllCheck']").prop("checked",t)}},i.prototype.actionExecute=function(){},i}(t.ControlUIBase);t.TableUI=i})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(i){var r=n.call(this,i)||this;return r.indeterminate=!1,r.defaultUI=t,r.registProperty("indeterminate"),r}return __extends(i,n),i}(n.Toggle),t;n.CheckBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"indeterminate",{set:function(n){this.inputContainer[0].indeterminate=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-checkbox"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return"checkbox"},enumerable:!1,configurable:!0}),t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("keydown",function(n){n.keyCode===32&&(n.preventDefault(),n.stopPropagation(),t.target.isChecked=!t.target.isChecked)})},t.prototype.createInnerContainer=function(){var t=this;n.prototype.createInnerContainer.call(this);this.inputContainer.on("change",function(){t.target.indeterminate=t.inputContainer[0].indeterminate});this.inputContainer.on("mousedown",function(){t.target.indeterminate&&(t.target.indeterminate=!1,t.inputContainer.trigger("change"))})},t}(n.ToggleUI);n.CheckBoxUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.FlexLayout),t;n.CheckBoxGroup=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"cssName",{get:function(){return"FUI-checkbox-group"},enumerable:!1,configurable:!0}),t}(n.FlexLayoutUI);n.CheckBoxGroupUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var c='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><title>Check menu button<\/title><g fill="#4A9F26" fill-rule="nonzero"><path d="M8 1C4.135 1 1 4.135 1 8s3.135 7 7 7 7-3.135 7-7-3.135-7-7-7zm0 12.833A5.835 5.835 0 0 1 2.167 8 5.82 5.82 0 0 1 8 2.167 5.82 5.82 0 0 1 13.833 8 5.82 5.82 0 0 1 8 13.833z"/><path d="M10.07 6.192L7.11 9.544l-1.203-1.36a.506.506 0 0 0-.757 0c-.2.226-.2.63 0 .856l1.581 1.79c.2.227.557.227.757 0l3.362-3.806c.2-.227.2-.63 0-.857a.513.513 0 0 0-.78.025z"/><\/g><\/svg>',l=function(n){function t(t){t===void 0&&(t=[]);var r=n.call(this)||this;return r.moveable=!0,r.defaultUI=i,r.registProperty("items",t),r}return __extends(t,n),t.prototype.add=function(){for(var t,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(t=this.items).push.apply(t,i);this.onPropertyChanged("items");return this},t.prototype.refill=function(n){var t;this.items.splice(0,this.items.length);(t=this.items).push.apply(t,n);this.onPropertyChanged("items");return this},t}(t.MoveableControl),i,r,o,u,s,f,h,e;t.ContextMenu=l;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"moveableContainer",{get:function(){return this.contextMenu},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"id",{set:function(t){n.Common.IsEmpty(t)?this.contextMenu.removeAttr("id"):this.contextMenu.attr("id",t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"location",{set:function(n){if(n){var t=this.contextMenu.width(),i=this.contextMenu.height();n.x+t-$(document).scrollLeft()>$(window).width()&&(n.x-=t);n.y<0&&(n.y=0);n.y+i-$(document).scrollTop()>$(window).innerHeight()&&(n.y-=i,n.y<0&&(n.y=0));this.contextMenu.offset({left:n.x,top:n.y})}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"items",{set:function(n){var t=this;this.contextMenu.empty();n&&n.forEach(function(n){n&&t.addChild(n.createUI(),t.contextMenu)})},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){t.prototype.dispose.call(this);this.escKeyDownHandler&&$(document).off("keydown",this.escKeyDownHandler)},i.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-contextmenu-outer",'"><\/div>'))},i.prototype.createContainerEvents=function(){var n=this;t.prototype.createContainerEvents.call(this);this.container.on("mousedown",function(){n.target.dispose()});this.escKeyDownHandler=function(t){t.keyCode===27&&(t.stopPropagation(),document.activeElement===document.body?n.target.dispose():document.activeElement.blur())};$(document).on("keydown",this.escKeyDownHandler)},i.prototype.createChildren=function(){this.cover=$('<div class="'.concat("FUI-contextmenu-cover",'"><\/div>'));this.contextMenu=$('<div class="'.concat("FUI-contextmenu",'" style="position: absolute"><\/div>'));this.contextMenu.on("mousedown",function(n){n.stopPropagation()});this.container.append(this.cover,this.contextMenu)},i.prototype.onUpdateSizeEvent=function(n){n===void 0&&(n=this.contextMenu);t.prototype.onUpdateSizeEvent.call(this,n)},i.prototype.setEnabledProperty=function(n){t.prototype.setEnabledProperty.call(this,n,this.contextMenu)},i}(t.MoveableControlUI);t.ContextMenuUI=i;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){n.prototype.createChildren.call(this);this.cover.hide()},t}(i);t.ContextMenuChildUI=r;o=function(n){function t(t){var i=n.call(this)||this;return i.defaultUI=u,i.registProperty("inner",t),i.registProperty("child"),i}return __extends(t,n),t}(t.UserControl);t.ContextMenuItem=o;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"inner",{set:function(n){this.container.empty();n&&this.addChild(n.createUI())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"child",{set:function(n){n?(this.container.addClass("FUI-contextmenu-parent"),n.hide(),this.addChild(n.createUI(r))):this.container.removeClass("FUI-contextmenu-parent")},enumerable:!1,configurable:!0}),i.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-contextmenu-item",'"><\/div>'))},i.prototype.createContainerEvents=function(){var t=this;this.container.on("mouseenter",function(){var i;if(t.target.child){t.target.child.show();t.target.child.updateSizeFromUI();var e=t.container.width(),h=t.container.height(),o=t.target.child.sizeFromUI.x,s=t.target.child.sizeFromUI.y,u=t.container.offset().left,f=t.container.offset().top,r=u+e;u+e+o-$(document).scrollLeft()>$(window).innerWidth()&&(r=u-o);i=f;f+s-$(document).scrollTop()>$(window).innerHeight()&&(i=f+h-s);r=Math.max(0,r);i=Math.max(0,i);t.target.child.location=new n.Numerics.Vector2(r,i)}});this.container.on("mouseleave",function(){t.target.child&&t.target.child.hide()})},i}(t.ControlUIBase);t.ContextMenuItemUI=u;s=function(n){function t(t,i,r){t===void 0&&(t="");i===void 0&&(i=c);r===void 0&&(r="");var u=n.call(this,t,i)||this;return u.defaultUI=f,u.classNames="".concat("FUI-contextmenu-button"),u.registProperty("uncheckedSVG",r),u}return __extends(t,n),t}(t.ToggleButton);t.ContextMenuButton=s;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.container.toggleClass("FUI-checked",n);this.svg=this.target.svg;this.uncheckedSVG=this.target.uncheckedSVG},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"svg",{set:function(n){this.target.isChecked&&(this.svgContainer.empty(),this.svgContainer.append($(n)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uncheckedSVG",{set:function(n){this.target.isChecked||(this.svgContainer.empty(),this.svgContainer.append($(n)))},enumerable:!1,configurable:!0}),t}(t.ToggleButtonUI);t.ContextMenuButtonUI=f;h=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=e,t}return __extends(t,n),t}(t.UserControl);t.ContextMenuSpliter=h;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-contextmenu-spliter",'"><\/div>'))},t}(t.ControlUIBase);t.ContextMenuSpliterUI=e})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var h=[{flag:1,css:"FUI-resize-up"},{flag:2,css:"FUI-resize-down"},{flag:4,css:"FUI-resize-left"},{flag:8,css:"FUI-resize-right"},{flag:5,css:"FUI-resize-nw"},{flag:9,css:"FUI-resize-ne"},{flag:6,css:"FUI-resize-sw"},{flag:10,css:"FUI-resize-se"},],r=function(){function n(){}return n}(),s,u,i,f,e,o;t.DialogEventArgs=r;s=function(i){function f(){var r=i.call(this)||this;return r.title="Dialog",r.resizeable=!0,r.centerWhenOpen=!0,r.alwaysCenter=!1,r.closeByEscKey=!0,r.closeButton=new t.Button("×"),r.footerButtonGroup=new t.ButtonGroup(2),r.moveable=!0,r.visibility=!1,r.defaultUI=u,r.disposeDelayDuration=150,r.registProperty("title"),r.registProperty("resizeable"),r.registProperty("centerWhenOpen"),r.registProperty("alwaysCenter"),r.registProperty("closeByEscKey"),r.registProperty("disposing"),r.closeButton.classNames="FUI-dialog-header-close",r.closeButton.focusable=!1,r.closeButton.on("Clicked",function(){r.close()}).identify("FUI-dialog-close"),r.footerButtonGroup.add(new t.Button(n.RS.ForguncyUI_Dialog_OK).addClass("FUI-button-primary").on("Clicked",function(){r.confirm()}).identify("FUI-dialog-ok")),r.footerButtonGroup.add(new t.Button(n.RS.ForguncyUI_Dialog_Cancel).on("Clicked",function(){r.cancel()}).identify("FUI-dialog-cancel")),r}return __extends(f,i),f.prototype.confirm=function(){var n=new r;this.dispatch("Confirm",n);n.cancel||this.dispose()},f.prototype.cancel=function(){var n=new r;this.dispatch("Cancel",n);n.cancel||this.dispose()},f.prototype.close=function(){var n=new r;this.dispatch("Close",n);n.cancel||this.dispose()},f.prototype.dispose=function(){var r=this,t;this.disposing=!0;t=n.DelayRefresh.setTimeout||window.setTimeout;t(function(){i.prototype.dispose.call(r)},this.disposeDelayDuration)},f}(t.MoveableControl);t.Dialog=s;u=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n.resizeFlag=0,n}return __extends(r,i),Object.defineProperty(r.prototype,"moveableContainer",{get:function(){return this.dialog},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"header",{get:function(){return new f(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"content",{get:function(){return new e(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"footer",{get:function(){return new o(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"id",{set:function(t){n.Common.IsEmpty(t)?this.dialog.removeAttr("id"):this.dialog.attr("id",t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"classNames",{set:function(n){this.dialog.addClass(n)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"location",{set:function(n){if(n){var t=Math.max(0,n.x),i=Math.max(0,n.y);this.dialog.css({left:t,top:i})}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"visibility",{set:function(n){var t=this;n?($(document.activeElement).blur(),this.centerWhenOpen=this.target.centerWhenOpen,window.requestAnimationFrame(function(){t.cover.addClass("FUI-show");t.dialog.addClass("FUI-show")})):(this.cover.removeClass("FUI-show"),this.dialog.removeClass("FUI-show"))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"resizeable",{set:function(n){this.clearResizes();n&&this.createResizes()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"centerWhenOpen",{set:function(n){var t=this;n&&window.requestAnimationFrame(function(){t.moveDialogToCenter()})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"alwaysCenter",{set:function(n){var t=this;if(n){this.alwaysCenterHandler=function(){window.requestAnimationFrame(function(){t.moveDialogToCenter()})};$(window).on("resize",this.alwaysCenterHandler)}else this.alwaysCenterHandler&&$(window).off("resize",this.alwaysCenterHandler)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"disposing",{set:function(n){n&&(this.dialog.addClass("FUI-disposing"),this.visibility=!1)},enumerable:!1,configurable:!0}),r.prototype.dispose=function(){this.removeMouseHandlers();this.escKeyDownHandler&&$(document).off("keydown",this.escKeyDownHandler);this.alwaysCenterHandler&&$(window).off("resize",this.alwaysCenterHandler);i.prototype.dispose.call(this)},r.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-dialog-outer",'"><\/div>'))},r.prototype.createModifiers=function(){this.modifiers=[new t.DialogFocusModifier(this)]},r.prototype.createChildren=function(){this.cover=$('<div class="'.concat("FUI-dialog-cover",'"><\/div>'));this.cursorCover=$('<div class="'.concat("FUI-cursor-cover",'"><\/div>'));this.dialog=$('<div class="'.concat("FUI-dialog",'"><\/div>'));this.actualHeader=this.addChild(this.header,this.dialog);this.actualContent=this.addChild(this.content,this.dialog);this.actualFooter=this.addChild(this.footer,this.dialog);this.container.append(this.cover,this.dialog);this.container.on("dragstart",function(n){n.preventDefault()})},r.prototype.createContainerEvents=function(){var n=this;i.prototype.createContainerEvents.call(this);this.escKeyDownHandler=function(t){n.target.closeByEscKey&&t.keyCode===27&&(t.stopPropagation(),document.activeElement===document.body&&n.target.close())};$(document).on("keydown",this.escKeyDownHandler)},r.prototype.createResizes=function(){var t,n=this,i=h.map(function(t){var i=$('<div class="'.concat(t.css,'"><\/div>'));i.on("mousedown",function(r){return n.resizeWindowByMouseDown(r,t.flag,i)});return i});this.removeMouseHandlers();this.mouseMoveHandler=function(t){window.requestAnimationFrame(function(){return n.resizeWindowByMouseMove(t,n.resizeFlag)})};this.mouseUpHandler=function(){n.resizeFlag=0;n.cursorCover.remove()};$(document).on("mousemove",this.mouseMoveHandler);$(document).on("mouseup",this.mouseUpHandler);this.resizes=i;(t=this.dialog).append.apply(t,this.resizes)},r.prototype.clearResizes=function(){this.removeMouseHandlers();this.resizes&&this.resizes.forEach(function(n){return n.remove()})},r.prototype.resizeWindowByMouseDown=function(t,i,r){t.stopPropagation();this.resizeFlag=i;this.mouseDownPosition=new n.Numerics.Vector2(t.screenX,t.screenY);this.oldSize=new n.Numerics.Vector2(this.dialog.width()||0,this.dialog.height()||0);this.oldLocation=new n.Numerics.Vector2(this.dialog.offset().left||0,this.dialog.offset().top||0);r.append(this.cursorCover)},r.prototype.resizeWindowByMouseMove=function(t,i){var r,u,f,e;i!==0&&(t.preventDefault(),t.stopPropagation(),r=new n.Numerics.Vector2(t.screenX,t.screenY).subtract(this.mouseDownPosition),u=this.oldSize.add(r),(i&1)!=0&&(f=this.target.location||this.oldLocation,this.target.location=new n.Numerics.Vector2(f.x,this.oldLocation.y+r.y),this.target.location.y>0&&this.dialog.height(this.oldSize.y-r.y)),(i&2)!=0&&this.dialog.height(u.y),(i&4)!=0&&(e=this.target.location||this.oldLocation,this.target.location=new n.Numerics.Vector2(this.oldLocation.x+r.x,e.y),this.target.location.x>0&&this.dialog.width(this.oldSize.x-r.x)),(i&8)!=0&&this.dialog.width(u.x))},r.prototype.removeMouseHandlers=function(){this.mouseMoveHandler&&$(document).off("mousemove",this.mouseMoveHandler);this.mouseUpHandler&&$(document).off("mouseup",this.mouseUpHandler)},r.prototype.moveDialogToCenter=function(){var n=this.getDialogLocation();this.target.location=n},r.prototype.getDialogLocation=function(t){var r,u;t===void 0&&(t=.5);var f=new n.Numerics.Vector2(this.cover.width(),this.cover.height()),e=new n.Numerics.Vector2(this.dialog.width(),this.dialog.height()),o=new n.Numerics.Vector2(this.cover.offset().left,this.cover.offset().top),s=new n.Numerics.Vector2((r=document.documentElement.scrollLeft)!==null&&r!==void 0?r:0,(u=document.documentElement.scrollTop)!==null&&u!==void 0?u:0),i=f.subtract(e).multiply(.5).add(o);return i.y=f.subtract(e).multiply(t).add(o).y,i.x=Math.max(s.x,i.x),i.y=Math.max(s.y,i.y),i},r}(t.MoveableControlUI);t.DialogUI=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"id",{set:function(){return},enumerable:!1,configurable:!0}),t}(t.ControlUIBase);t.DialogInnerUI=i;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"title",{set:function(n){this.titleContainer.text(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"moveable",{set:function(n){n?this.container.css("cursor","move"):this.container.css("cursor","initial")},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){t.prototype.dispose.call(this);this.removeHandlers()},i.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-dialog-header",'"><\/div>'))},i.prototype.createChildren=function(){var t=this,i,r,u;this.cursorCover=$('<div class="'.concat("FUI-cursor-cover",'"><\/div>'));this.titleContainer=$('<span class="'.concat("FUI-dialog-header-title",'"><\/span>')).text(this.target.title);i=!1;this.container.on("mousedown",function(f){t.target.moveable&&(i=!0,r=new n.Numerics.Vector2(f.screenX,f.screenY),u=new n.Numerics.Vector2(t.container.offset().left||0,t.container.offset().top||0),t.container.append(t.cursorCover))});this.removeHandlers();this.mouseMoveHandler=function(f){i&&window.requestAnimationFrame(function(){var i=new n.Numerics.Vector2(f.screenX,f.screenY).subtract(r);t.target.location=u.add(i)})};this.mouseUpHandler=function(){i=!1;t.cursorCover.remove()};this.bindHandlers();this.container.append(this.titleContainer);this.addChild(this.target.closeButton.createUI())},i.prototype.bindHandlers=function(){$(document).on("mousemove",this.mouseMoveHandler);$(document).on("mouseup",this.mouseUpHandler)},i.prototype.removeHandlers=function(){this.mouseMoveHandler&&$(document).off("mousemove",this.mouseMoveHandler);this.mouseUpHandler&&$(document).off("mouseup",this.mouseUpHandler)},i}(i);t.DialogHeaderUI=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-dialog-content",'"><\/div>'))},t}(i);t.DialogContentUI=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-dialog-footer",'"><\/div>'))},t.prototype.createChildren=function(){this.addChild(this.target.footerButtonGroup.createUI())},t}(i);t.DialogFooterUI=o})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var r=function(){function n(){}return n}(),i,t;n.ListBoxItem=r;i=function(n){function i(i){i===void 0&&(i=!1);var r=n.call(this)||this;return r.items=[],r.selections=[],r.focusable=!0,r.defaultUI=t,r.registProperty("items"),r.autoSort=i,r.compareFn=function(n,t){return n.displayText.localeCompare(t.displayText)},r}return __extends(i,n),i.prototype.add=function(){for(var i,r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=!1;t&&t.forEach(function(n){n&&(r.items.push(n),i=!0)});i&&(this.autoSort&&this.items.sort(this.compareFn),this.dispatch("ItemsChanged",this.items))},i.prototype.remove=function(){for(var t,r,u=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];t=[];r=!1;i&&i.forEach(function(n){if(n){var i=u.items.indexOf(n);i>=0&&(t.push.apply(t,u.items.splice(i,1)),r=!0)}});r&&(this.autoSort&&this.items.sort(this.compareFn),this.unSelect.apply(this,t),this.dispatch("ItemsChanged",this.items))},i.prototype.active=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.dispatch("ActiveItemsChanged",t)},i.prototype.selectAll=function(){this.select.apply(this,this.items)},i.prototype.select=function(){for(var i,r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=!1;t&&t.forEach(function(n){n&&r.selections.indexOf(n)<0&&(r.selections.push(n),i=!0)});i&&this.dispatch("SelectionsChanged",this.selections)},i.prototype.selectNew=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];n&&n.every(function(n){return n!==null&&n!==undefined})&&(this.selections=[],this.select.apply(this,n))},i.prototype.unSelect=function(){for(var i,r=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=!1;t&&t.forEach(function(n){if(n){var t=r.selections.indexOf(n);t>=0&&(r.selections.splice(t,1),i=!0)}});i&&this.dispatch("SelectionsChanged",this.selections)},i.prototype.clear=function(){this.items=[];this.selections=[];this.dispatch("SelectionsChanged",this.selections);this.dispatch("ItemsChanged",this.selections)},i.prototype.clearSelect=function(){this.selections=[];this.dispatch("SelectionsChanged",this.selections)},i.prototype.moveUpSelect=function(){var n=this,t=this.selections.sort(function(t,i){return n.items.indexOf(t)-n.items.indexOf(i)});t.forEach(function(t){var i=n.items.indexOf(t);i>0&&n.selections.indexOf(n.items[i-1])<0&&(n.items.splice(i-1,0,t),n.items.splice(i+1,1))});this.dispatch("ItemsChanged",this.items)},i.prototype.moveDownSelect=function(){var n=this,t=this.selections.sort(function(t,i){return n.items.indexOf(i)-n.items.indexOf(t)});t.forEach(function(t){var i=n.items.indexOf(t);i<n.items.length-1&&n.selections.indexOf(n.items[i+1])<0&&(n.items.splice(i+2,0,t),n.items.splice(i,1))});this.dispatch("ItemsChanged",this.items)},i.prototype.moveSelectionToViewport=function(){this.dispatch("MoveSelectionToViewport",this.selections)},i}(n.UserControl);n.ListBox=i;t=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.lastIndex=0,t}return __extends(t,n),Object.defineProperty(t.prototype,"items",{set:function(n){var t,i=this;this.container.empty();this.itemContainers=n.map(function(n){return i.createListBoxItem(n)});(t=this.container).append.apply(t,this.itemContainers);this.refreshSelections(this.target.selections)},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-listbox",'"><\/div>'))},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.target.on("ItemsChanged",function(){t.items=t.target.items});this.target.on("SelectionsChanged",function(n,i){t.refreshSelections(i)});this.target.on("MoveSelectionToViewport",function(n,i){t.moveSelectionToViewport(i)});this.container.on("click",function(){t.target.focus()});this.container.on("keydown",function(n){n.ctrlKey&&n.keyCode===65&&(n.preventDefault(),n.stopPropagation(),t.target.selectAll(),t.lastIndex=0)})},t.prototype.createListBoxItem=function(n){var t=this,i=$('<div class="'.concat("FUI-listbox-item",'"><\/div>'));return i.data("value",n),i.text(n.displayText),i.attr("title",n.displayText),i.dblclick(function(){t.target.clearSelect();t.target.select(n);t.lastIndex=t.target.items.indexOf(n);t.target.active(n)}),i.click(function(i){var u,f,r;i.ctrlKey?(t.target.selections.indexOf(n)>=0?t.target.unSelect(n):t.target.select(n),t.lastIndex=t.target.items.indexOf(n)):i.shiftKey?(r=t.target.items.indexOf(n),r<t.lastIndex?(u=t.target).selectNew.apply(u,t.target.items.slice(r,t.lastIndex+1)):(f=t.target).selectNew.apply(f,t.target.items.slice(t.lastIndex,r+1))):(t.target.selectNew(n),t.lastIndex=t.target.items.indexOf(n))}),i},t.prototype.refreshSelections=function(n){this.itemContainers.forEach(function(t){n.indexOf(t.data("value"))>=0?t.addClass("FUI-selected"):t.removeClass("FUI-selected")})},t.prototype.moveSelectionToViewport=function(n){for(var t,u=this.itemContainers.length,i=0;i<u;i++)if(t=this.itemContainers[i],n.indexOf(t.data("value"))>=0){var f=this.container.scrollTop(),r=t.position().top,e=this.container.height()-t.height();(r<=0||r>e)&&this.container.scrollTop(f+r);break}},t}(n.ControlUIBase);n.ListBoxUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var e=function(n){function i(){var i=n.call(this)||this;return i.nodes=[],i.defaultUI=t,i.registProperty("nodes"),i}return __extends(i,n),i.prototype.add=function(n){this.nodes.push(n);this.dispatch("ItemsChanged")},i.prototype.clear=function(){this.nodes=[];this.dispatch("ItemsChanged")},i.prototype.singleSelect=function(n){this.selectedNode&&this.selectedNode!==n&&(this.selectedNode.isSelected=!1);n.isSelected=!0;this.selectedNode=n},i}(n.UserControl),t,f,i,r,u;n.TreeView=e;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"nodes",{set:function(n){this.refreshNodes(n)},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-treeview",'"><\/div>'))},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.target.on("ItemsChanged",function(){t.refreshNodes(t.target.nodes)})},t.prototype.createChildren=function(){this.contentContainer=$('<div class="'.concat("FUI-treeview-content",'"><\/div>'));this.container.append(this.contentContainer)},t.prototype.refreshNodes=function(n){var t=this;this.updateRootTimer&&clearTimeout(this.updateRootTimer);this.updateRootTimer=setTimeout(function(){t.contentContainer.empty();n&&n.forEach(function(n){t.addChild(n.createUI(),t.contentContainer)})},0)},t}(n.ControlUIBase);n.TreeViewUI=t;f=function(t){function u(u,f){var e=t.call(this)||this;e.isExpand=!1;e.isChecked=!1;e.indeterminate=!1;e.isSelected=!1;e.children=[];e.defaultUI=i;e.registProperty("text",u);e.registProperty("isExpand");e.registProperty("isChecked");e.registProperty("indeterminate");e.registProperty("isSelected");e.registProperty("children");e.expandButton=new r;e.expandButton.visibility=e.children.length!==0;e.bindProperty(e.expandButton,"isChecked","isExpand");e.checkBox=new n.CheckBox(u);e.bindProperty(e.checkBox,"text","text");e.bindProperty(e.checkBox,"isChecked","isChecked");e.bindProperty(e.checkBox,"indeterminate","indeterminate");e.contentControl=f;e.on("PropertyChanged",function(n,t){t==="children"&&(e.expandButton.visibility=e.children.length!==0);t==="isChecked"&&(e.children&&e.children.forEach(function(n){return n.selectAll(e.isChecked)}),e.parent&&e.updateCheckState(e.parent));t==="indeterminate"&&e.parent&&e.updateInterminate(e.parent)});return e}return __extends(u,t),Object.defineProperty(u.prototype,"leafs",{get:function(){return this.children&&this.children.length!==0?this.children.map(function(n){return n.leafs}).reduce(function(n,t){return n.concat(t)}):[this]},enumerable:!1,configurable:!0}),u.prototype.refreshAll=function(){this.expandButton.visibility=this.children.length!==0;this.children.forEach(function(n){return n.refreshAll()})},u.prototype.selectAll=function(n){this.isChecked=n},u.prototype.addChildren=function(n){var t=this;n.forEach(function(n){n.parent=t});this.children=n;this.updateCheckState()},u.prototype.updateCheckState=function(n){n===void 0&&(n=this);var t=n.children.every(function(n){return n.isChecked===!0}),i=n.children.every(function(n){return n.isChecked===!1}),r=n.children.some(function(n){return n.indeterminate===!0});n.indeterminate=!(t||i)||r;t&&(n.isChecked=!0);i&&(n.isChecked=!1)},u.prototype.updateInterminate=function(n){var t=n.children.every(function(n){return n.isChecked===!0}),i=n.children.every(function(n){return n.isChecked===!1}),r=n.children.some(function(n){return n.indeterminate===!0});n.indeterminate=!(t||i)||r},u}(n.UserControl);n.TreeViewNode=f;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"isExpand",{set:function(n){this.childrenContainer.toggleClass("FUI-show",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.container.toggleClass("FUI-checked",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"indeterminate",{set:function(n){this.container.toggleClass("FUI-interminate",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{set:function(n){this.container.toggleClass("FUI-selected",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"children",{set:function(){var n=this;this.childrenContainer.empty();this.target.children&&this.target.children.forEach(function(t){n.addChild(t.createUI(),n.childrenContainer)})},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-treeview-node",'"><\/div>'))},t.prototype.createChildren=function(){var n,t;this.addChild(this.target.expandButton.createUI());n=this.target.checkBox.createUI();this.addChild(n);this.target.contentControl&&(t=this.target.contentControl.createUI(),this.addChild(t));this.childrenContainer=$('<div class="'.concat("FUI-treeview-node-children",'"><\/div>'));this.container.append(this.childrenContainer)},t}(n.ControlUIBase);n.TreeViewNodeUI=i;r=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=u,t}return __extends(t,n),t}(n.ToggleButton);n.ExpandTreeViewNodeButton=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-treeview-node-expand",'"><\/div>'))},Object.defineProperty(t.prototype,"visibility",{set:function(n){n?this.container.css("visibility","visible"):this.container.css("visibility","hidden")},enumerable:!1,configurable:!0}),t}(n.ToggleButtonUI);n.ExpandTreeViewNodeButtonUI=u})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var r,u,f,t,i;(function(n){n.None="none";n.Both="both";n.Horizontal="horizontal";n.Vertical="vertical"})(r=n.TextAreaResize||(n.TextAreaResize={}));u=function(){function n(){}return n}();n.TextAreaProps=u;f=function(n){function i(i){var u=n.call(this)||this;u.focusable=!0;u.defaultUI=t;var f=i.text,h=f===void 0?"":f,e=i.resize,c=e===void 0?r.None:e,o=i.autosize,l=o===void 0?!0:o,s=i.placeholder,a=s===void 0?"":s;return u.registProperty("text",h),u.registProperty("resize",c),u.registProperty("autosize",l),u.registProperty("placeholder",a),u.registProperty("needResize",""),u}return __extends(i,n),i.prototype.cssHasChanged=function(){this.needResize=(new Date).toString()},i}(n.UserControl);n.TextArea=f;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.container[0].value=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{set:function(n){this.container[0].placeholder=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resize",{set:function(n){this.container.css("resize",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needResize",{set:function(){this.resizeTextarea()},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("textarea")).addClass("FUI-textarea")},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("change",function(){t.target.text=t.container[0].value});this.container.on("keypress",function(n){n.keyCode===13&&(n.stopPropagation(),t.target.text=t.container[0].value)});this.container.on("keyup",function(){t.resizeTextarea()})},t.prototype.resizeTextarea=function(){var t=this.target.autosize,n={};if(t){var r=t,u=r.minRows,f=r.maxRows;Object.assign(n,i.calcTextareaHeight(this.container[0],u,f))}else Object.assign(n,{minHeight:i.calcTextareaHeight(this.container[0]).minHeight});this.container.css(n)},t}(n.ControlUIBase);n.TextAreaUI=t;i=function(){function n(){}return n.calculateNodeStyling=function(t){var i=t.parentElement===null?$(t).clone()[0]:null;i&&n.hiddenTextarea.appendChild(i);var r=window.getComputedStyle(i!==null&&i!==void 0?i:t),u=r.getPropertyValue("box-sizing"),f=parseFloat(r.getPropertyValue("padding-bottom"))+parseFloat(r.getPropertyValue("padding-top")),e=parseFloat(r.getPropertyValue("border-bottom-width"))+parseFloat(r.getPropertyValue("border-top-width")),o=n.CONTEXT_STYLE.map(function(n){return"".concat(n,":").concat(r.getPropertyValue(n))}).join(";");return i&&n.hiddenTextarea.removeChild(i),{contextStyle:o,paddingSize:f,borderSize:e,boxSizing:u}},n.calcTextareaHeight=function(t,i,r){var u,f,a,e,o;i===void 0&&(i=1);r===void 0&&(r=null);n.hiddenTextarea||(n.hiddenTextarea=document.createElement("textarea"),document.body.appendChild(n.hiddenTextarea));var s=n.calculateNodeStyling(t),h=s.paddingSize,l=s.borderSize,c=s.boxSizing,v=s.contextStyle;return n.hiddenTextarea.setAttribute("style","".concat(v,";").concat(n.HIDDEN_STYLE)),n.hiddenTextarea.value=t.value||t.placeholder||"",u=n.hiddenTextarea.scrollHeight,f={},c==="border-box"?u=u+l:c==="content-box"&&(u=u-h),n.hiddenTextarea.value="",a=n.hiddenTextarea.scrollHeight-h,i!==null&&(e=a*i,c==="border-box"&&(e=e+h+l),u=Math.max(e,u),f.minHeight="".concat(e,"px")),r!==null&&(o=a*r,c==="border-box"&&(o=o+h+l),f.overflow=o>=u?"hidden":"auto",u=Math.min(o,u)),f.height="".concat(u,"px"),n.hiddenTextarea.parentNode&&n.hiddenTextarea.parentNode.removeChild(n.hiddenTextarea),n.hiddenTextarea=null,f},n.HIDDEN_STYLE="\n          height:0 !important;\n          visibility:hidden !important;\n          overflow:hidden !important;\n          position:absolute !important;\n          z-index:-1000 !important;\n          top:0 !important;\n          right:0 !important\n        ",n.CONTEXT_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],n}()})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(i,r){i===void 0&&(i="");r===void 0&&(r="");var u=n.call(this)||this;return u.defaultUI=t,u.registProperty("text",i),u.registProperty("placeholder",r),u}return __extends(i,n),i}(n.UserControl),t;n.TextBlock=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){n?this.container.removeClass("FUI-textblock-empty"):this.container.addClass("FUI-textblock-empty");this.container.text(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{set:function(n){this.container.attr("data-placeholder",n)},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){var n=this;this.container=$(document.createElement("div")).addClass("FUI-textblock");this.container.on("click",function(){return n.target.dispatch("ContainerClicked")})},t}(n.ControlUIBase);n.TextBlockUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var u=function(n){function t(t,r,u){t===void 0&&(t="");r===void 0&&(r="");u===void 0&&(u="");var f=n.call(this)||this;return f.defaultUI=i,f.registProperty("text",t),f.registProperty("icon",r),f.registProperty("suffix",u),f}return __extends(t,n),t}(t.UserControl),i,r;t.IconText=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"icon",{set:function(n){this.svgContainer.empty();this.svgContainer.append($(n))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suffix",{set:function(n){this.suffixContainer.empty();this.suffixContainer.append($(n))},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("div")).addClass("FUI-svgtext")},t.prototype.createChildren=function(){var n=this;this.svgContainer=$(document.createElement("span")).addClass("FUI-svgtext-icon");this.textContainer=$(document.createElement("span")).addClass("FUI-svgtext-text");this.suffixContainer=$(document.createElement("span")).addClass("FUI-svgtext-suffix");this.svgContainer.on("click",function(){return n.target.dispatch("IconClicked")});this.textContainer.on("click",function(){return n.target.dispatch("TextClicked")});this.suffixContainer.on("click",function(){return n.target.dispatch("SuffixClicked")});this.container.on("click",function(){return n.target.dispatch("ContainerClicked")});this.container.append(this.svgContainer,this.textContainer,this.suffixContainer)},t}(t.ControlUIBase);t.SVGTextUI=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"text",{set:function(n){this.textContainer.text(n)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"icon",{set:function(t){n.Common.IsEmpty(t)?this.imageContainer.hide():(this.imageContainer.show(),this.imageContainer.attr("src",n.ImageHelper.encodeImageUrl(t)))},enumerable:!1,configurable:!0}),i.prototype.createContainer=function(){this.container=$(document.createElement("div")).addClass("FUI-imagetext")},i.prototype.createChildren=function(){var n=this;this.imageContainer=$(document.createElement("img")).addClass("FUI-imagetext-icon");this.textContainer=$(document.createElement("span")).addClass("FUI-imagetext-text");this.imageContainer.on("click",function(){return n.target.dispatch("IconClicked")});this.textContainer.on("click",function(){return n.target.dispatch("TextClicked")});this.container.on("click",function(){return n.target.dispatch("ContainerClicked")});this.container.append(this.imageContainer,this.textContainer)},i}(t.ControlUIBase);t.ImageTextUI=r})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var r=function(){function n(){}return n}(),i,t;n.PaginationProps=r;i=function(n){function i(i){var r=n.call(this)||this;r.defaultUI=t;var o=i.total,u=i.pageSize,s=u===void 0?10:u,f=i.pagerCount,h=f===void 0?7:f,e=i.currentPage,c=e===void 0?1:e;return r.registProperty("total",o),r.registProperty("pageSize",s),r.registProperty("pagerCount",h),r.registProperty("currentPage",c),r}return __extends(i,n),i}(n.UserControl);n.Pagination=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"total",{set:function(){this.dispatchPageCount()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSize",{set:function(){this.dispatchPageCount()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCount",{set:function(){console.log("please change the total or the pageSize to change the pageCount")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pagerCount",{set:function(n){var t=(n|0)===n&&n>4&&n<22&&n%2==1;if(!t){console.error("pagerCount did not pass validation");return}this.updatePages()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{set:function(n){this.updatePages();this.target.dispatch("PageChanged",n)},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$("<ul/>").addClass("FUI-pagination")},t.prototype.createChildren=function(){var n=this;this.prevContainer=$("<li/>").addClass("FUI-pagination-prev").append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M4.76310905,0.51569502 C5.11115761,0.495957698 5.46684701,0.608520797 5.7445021,0.855577756 L5.7445021,0.855577756 L12.6970218,8.01347097 L5.74461047,15.1718757 C5.48852843,15.4000255 5.16381603,15.5134861 4.84124243,15.5134861 C4.47348845,15.5134861 4.10701636,15.3657095 3.8450215,15.0797967 C3.59337852,14.8067946 3.48181404,14.4610971 3.50238557,14.1237162 C3.52230512,13.7970279 3.66630185,13.4764746 3.93334941,13.2366952 L3.93334941,13.2366952 L8.78478176,8.01347944 L3.93334533,2.79005375 C3.66630039,2.55027471 3.52230502,2.22972305 3.50238557,1.9030364 C3.48181404,1.56565547 3.59337852,1.21995802 3.84456111,0.947456003 C4.08895736,0.681591219 4.42162654,0.53505999 4.76310905,0.51569502 Z" stroke="#FFFFFF" fill="#4180E3" fill-rule="nonzero" transform="translate(8.000000, 8.013486) scale(-1, 1) translate(-8.000000, -8.013486) "><\/path> <\/g> <\/svg>');this.startContainer=$(this.createItemHTML(1));this.prevMoreContainer=$("<li/>").addClass("FUI-pagination-prev-more").append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M13.5,5.5 C14.0599988,5.5 14.5589197,5.72181313 14.9185536,6.08144702 C15.2781863,6.44107975 15.5,6.93999919 15.5,7.5 C15.5,8.05999882 15.2781869,8.5589197 14.918553,8.91855359 C14.5589203,9.27818632 14.0600008,9.5 13.5,9.5 C12.9400012,9.5 12.4410803,9.27818687 12.0814464,8.91855298 C11.7218137,8.55892025 11.5,8.06000081 11.5,7.5 C11.5,6.94000118 11.7218131,6.4410803 12.081447,6.08144641 C12.4410797,5.72181368 12.9399992,5.5 13.5,5.5 L13.5,5.5 Z M3.5,5.5 C4.05999882,5.5 4.5589197,5.72181313 4.91855359,6.08144702 C5.27818632,6.44107975 5.5,6.93999919 5.5,7.5 C5.5,8.05999882 5.27818687,8.5589197 4.91855298,8.91855359 C4.55892025,9.27818632 4.06000081,9.5 3.5,9.5 C2.94000118,9.5 2.4410803,9.27818687 2.08144641,8.91855298 C1.72181368,8.55892025 1.5,8.06000081 1.5,7.5 C1.5,6.94000118 1.72181313,6.4410803 2.08144702,6.08144641 C2.44107975,5.72181368 2.93999919,5.5 3.5,5.5 Z M8.5,5.5 C9.05999882,5.5 9.5589197,5.72181313 9.91855359,6.08144702 C10.2781863,6.44107975 10.5,6.93999919 10.5,7.5 C10.5,8.05999882 10.2781869,8.5589197 9.91855298,8.91855359 C9.55892025,9.27818632 9.06000081,9.5 8.5,9.5 C7.94000118,9.5 7.4410803,9.27818687 7.08144641,8.91855298 C6.72181368,8.55892025 6.5,8.06000081 6.5,7.5 C6.5,6.94000118 6.72181313,6.4410803 7.08144702,6.08144641 C7.44107975,5.72181368 7.93999919,5.5 8.5,5.5 L8.5,5.5 Z" stroke="#FFFFFF" fill="#767676" fill-rule="nonzero"><\/path> <\/g> <\/svg>');this.pagerContainer=$("<ul/>");this.nextMoreContainer=$("<li/>").addClass("FUI-pagination-next-more").append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M13.5,5.5 C14.0599988,5.5 14.5589197,5.72181313 14.9185536,6.08144702 C15.2781863,6.44107975 15.5,6.93999919 15.5,7.5 C15.5,8.05999882 15.2781869,8.5589197 14.918553,8.91855359 C14.5589203,9.27818632 14.0600008,9.5 13.5,9.5 C12.9400012,9.5 12.4410803,9.27818687 12.0814464,8.91855298 C11.7218137,8.55892025 11.5,8.06000081 11.5,7.5 C11.5,6.94000118 11.7218131,6.4410803 12.081447,6.08144641 C12.4410797,5.72181368 12.9399992,5.5 13.5,5.5 L13.5,5.5 Z M3.5,5.5 C4.05999882,5.5 4.5589197,5.72181313 4.91855359,6.08144702 C5.27818632,6.44107975 5.5,6.93999919 5.5,7.5 C5.5,8.05999882 5.27818687,8.5589197 4.91855298,8.91855359 C4.55892025,9.27818632 4.06000081,9.5 3.5,9.5 C2.94000118,9.5 2.4410803,9.27818687 2.08144641,8.91855298 C1.72181368,8.55892025 1.5,8.06000081 1.5,7.5 C1.5,6.94000118 1.72181313,6.4410803 2.08144702,6.08144641 C2.44107975,5.72181368 2.93999919,5.5 3.5,5.5 Z M8.5,5.5 C9.05999882,5.5 9.5589197,5.72181313 9.91855359,6.08144702 C10.2781863,6.44107975 10.5,6.93999919 10.5,7.5 C10.5,8.05999882 10.2781869,8.5589197 9.91855298,8.91855359 C9.55892025,9.27818632 9.06000081,9.5 8.5,9.5 C7.94000118,9.5 7.4410803,9.27818687 7.08144641,8.91855298 C6.72181368,8.55892025 6.5,8.06000081 6.5,7.5 C6.5,6.94000118 6.72181313,6.4410803 7.08144702,6.08144641 C7.44107975,5.72181368 7.93999919,5.5 8.5,5.5 L8.5,5.5 Z" stroke="#FFFFFF" fill="#767676" fill-rule="nonzero"><\/path> <\/g> <\/svg>');this.endContainer=$(this.createItemHTML(this.target.pageCount));this.nextContainer=$("<li/>").addClass("FUI-pagination-next").append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M4.76310905,0.51569502 C5.11115761,0.495957698 5.46684701,0.608520797 5.7445021,0.855577756 L5.7445021,0.855577756 L12.6970218,8.01347097 L5.74461047,15.1718757 C5.48852843,15.4000255 5.16381603,15.5134861 4.84124243,15.5134861 C4.47348845,15.5134861 4.10701636,15.3657095 3.8450215,15.0797967 C3.59337852,14.8067946 3.48181404,14.4610971 3.50238557,14.1237162 C3.52230512,13.7970279 3.66630185,13.4764746 3.93334941,13.2366952 L3.93334941,13.2366952 L8.78478176,8.01347944 L3.93334533,2.79005375 C3.66630039,2.55027471 3.52230502,2.22972305 3.50238557,1.9030364 C3.48181404,1.56565547 3.59337852,1.21995802 3.84456111,0.947456003 C4.08895736,0.681591219 4.42162654,0.53505999 4.76310905,0.51569502 Z" stroke="#FFFFFF" fill="#4180E3" fill-rule="nonzero"><\/path> <\/g> <\/svg>');this.prevContainer.on("click",function(){n.dispatchCurrentPage(n.target.currentPage-1)});this.startContainer.on("click",function(){n.dispatchCurrentPage(1)});this.prevMoreContainer.on("mouseenter",function(){n.prevMoreContainer.empty();n.prevMoreContainer.append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M1.76310905,0.51569502 C2.11115761,0.495957698 2.46684701,0.608520797 2.7445021,0.855577756 L2.7445021,0.855577756 L9.69702175,8.01347097 L2.74461047,15.1718757 C2.48852843,15.4000255 2.16381603,15.5134861 1.84124243,15.5134861 C1.47348845,15.5134861 1.10701636,15.3657095 0.845021502,15.0797967 C0.593378523,14.8067946 0.481814035,14.4610971 0.502385567,14.1237162 C0.522305125,13.7970279 0.666301851,13.4764746 0.933349405,13.2366952 L0.933349405,13.2366952 L5.78478176,8.01347944 L0.933345329,2.79005375 C0.666300386,2.55027471 0.522305024,2.22972305 0.502385567,1.9030364 C0.481814035,1.56565547 0.593378523,1.21995802 0.844561105,0.947456003 C1.08895736,0.681591219 1.42162654,0.53505999 1.76310905,0.51569502 Z" stroke="#FFFFFF" fill="#4180E3" fill-rule="nonzero" transform="translate(5.000000, 8.013486) scale(-1, 1) translate(-5.000000, -8.013486) "><\/path> <path d="M6.76310905,0.51569502 C7.11115761,0.495957698 7.46684701,0.608520797 7.7445021,0.855577756 L7.7445021,0.855577756 L14.6970218,8.01347097 L7.74461047,15.1718757 C7.48852843,15.4000255 7.16381603,15.5134861 6.84124243,15.5134861 C6.47348845,15.5134861 6.10701636,15.3657095 5.8450215,15.0797967 C5.59337852,14.8067946 5.48181404,14.4610971 5.50238557,14.1237162 C5.52230512,13.7970279 5.66630185,13.4764746 5.93334941,13.2366952 L5.93334941,13.2366952 L10.7847818,8.01347944 L5.93334533,2.79005375 C5.66630039,2.55027471 5.52230502,2.22972305 5.50238557,1.9030364 C5.48181404,1.56565547 5.59337852,1.21995802 5.84456111,0.947456003 C6.08895736,0.681591219 6.42162654,0.53505999 6.76310905,0.51569502 Z" stroke="#FFFFFF" fill="#4180E3" fill-rule="nonzero" transform="translate(10.000000, 8.013486) scale(-1, 1) translate(-10.000000, -8.013486) "><\/path> <\/g> <\/svg>')});this.prevMoreContainer.on("click",function(){n.dispatchCurrentPage(n.target.currentPage-n.target.pagerCount)});this.prevMoreContainer.on("mouseleave",function(){n.prevMoreContainer.empty();n.prevMoreContainer.append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M13.5,5.5 C14.0599988,5.5 14.5589197,5.72181313 14.9185536,6.08144702 C15.2781863,6.44107975 15.5,6.93999919 15.5,7.5 C15.5,8.05999882 15.2781869,8.5589197 14.918553,8.91855359 C14.5589203,9.27818632 14.0600008,9.5 13.5,9.5 C12.9400012,9.5 12.4410803,9.27818687 12.0814464,8.91855298 C11.7218137,8.55892025 11.5,8.06000081 11.5,7.5 C11.5,6.94000118 11.7218131,6.4410803 12.081447,6.08144641 C12.4410797,5.72181368 12.9399992,5.5 13.5,5.5 L13.5,5.5 Z M3.5,5.5 C4.05999882,5.5 4.5589197,5.72181313 4.91855359,6.08144702 C5.27818632,6.44107975 5.5,6.93999919 5.5,7.5 C5.5,8.05999882 5.27818687,8.5589197 4.91855298,8.91855359 C4.55892025,9.27818632 4.06000081,9.5 3.5,9.5 C2.94000118,9.5 2.4410803,9.27818687 2.08144641,8.91855298 C1.72181368,8.55892025 1.5,8.06000081 1.5,7.5 C1.5,6.94000118 1.72181313,6.4410803 2.08144702,6.08144641 C2.44107975,5.72181368 2.93999919,5.5 3.5,5.5 Z M8.5,5.5 C9.05999882,5.5 9.5589197,5.72181313 9.91855359,6.08144702 C10.2781863,6.44107975 10.5,6.93999919 10.5,7.5 C10.5,8.05999882 10.2781869,8.5589197 9.91855298,8.91855359 C9.55892025,9.27818632 9.06000081,9.5 8.5,9.5 C7.94000118,9.5 7.4410803,9.27818687 7.08144641,8.91855298 C6.72181368,8.55892025 6.5,8.06000081 6.5,7.5 C6.5,6.94000118 6.72181313,6.4410803 7.08144702,6.08144641 C7.44107975,5.72181368 7.93999919,5.5 8.5,5.5 L8.5,5.5 Z" stroke="#FFFFFF" fill="#767676" fill-rule="nonzero"><\/path> <\/g> <\/svg>')});this.pagerContainer.on("click",function(t){n.dispatchCurrentPage(+t.target.innerText)});this.nextMoreContainer.on("mouseenter",function(){n.nextMoreContainer.empty();n.nextMoreContainer.append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M2.76310905,0.51569502 C3.11115761,0.495957698 3.46684701,0.608520797 3.7445021,0.855577756 L3.7445021,0.855577756 L10.6970218,8.01347097 L3.74461047,15.1718757 C3.48852843,15.4000255 3.16381603,15.5134861 2.84124243,15.5134861 C2.47348845,15.5134861 2.10701636,15.3657095 1.8450215,15.0797967 C1.59337852,14.8067946 1.48181404,14.4610971 1.50238557,14.1237162 C1.52230512,13.7970279 1.66630185,13.4764746 1.93334941,13.2366952 L1.93334941,13.2366952 L6.78478176,8.01347944 L1.93334533,2.79005375 C1.66630039,2.55027471 1.52230502,2.22972305 1.50238557,1.9030364 C1.48181404,1.56565547 1.59337852,1.21995802 1.84456111,0.947456003 C2.08895736,0.681591219 2.42162654,0.53505999 2.76310905,0.51569502 Z" stroke="#FFFFFF" fill="#4180E3" fill-rule="nonzero"><\/path> <path d="M7.76310905,0.51569502 C8.11115761,0.495957698 8.46684701,0.608520797 8.7445021,0.855577756 L8.7445021,0.855577756 L15.6970218,8.01347097 L8.74461047,15.1718757 C8.48852843,15.4000255 8.16381603,15.5134861 7.84124243,15.5134861 C7.47348845,15.5134861 7.10701636,15.3657095 6.8450215,15.0797967 C6.59337852,14.8067946 6.48181404,14.4610971 6.50238557,14.1237162 C6.52230512,13.7970279 6.66630185,13.4764746 6.93334941,13.2366952 L6.93334941,13.2366952 L11.7847818,8.01347944 L6.93334533,2.79005375 C6.66630039,2.55027471 6.52230502,2.22972305 6.50238557,1.9030364 C6.48181404,1.56565547 6.59337852,1.21995802 6.84456111,0.947456003 C7.08895736,0.681591219 7.42162654,0.53505999 7.76310905,0.51569502 Z" stroke="#FFFFFF" fill="#4180E3" fill-rule="nonzero"><\/path> <\/g> <\/svg>')});this.nextMoreContainer.on("click",function(){n.dispatchCurrentPage(n.target.currentPage+n.target.pagerCount)});this.nextMoreContainer.on("mouseleave",function(){n.nextMoreContainer.empty();n.nextMoreContainer.append('<svg width="1em" height="1em" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <path d="M13.5,5.5 C14.0599988,5.5 14.5589197,5.72181313 14.9185536,6.08144702 C15.2781863,6.44107975 15.5,6.93999919 15.5,7.5 C15.5,8.05999882 15.2781869,8.5589197 14.918553,8.91855359 C14.5589203,9.27818632 14.0600008,9.5 13.5,9.5 C12.9400012,9.5 12.4410803,9.27818687 12.0814464,8.91855298 C11.7218137,8.55892025 11.5,8.06000081 11.5,7.5 C11.5,6.94000118 11.7218131,6.4410803 12.081447,6.08144641 C12.4410797,5.72181368 12.9399992,5.5 13.5,5.5 L13.5,5.5 Z M3.5,5.5 C4.05999882,5.5 4.5589197,5.72181313 4.91855359,6.08144702 C5.27818632,6.44107975 5.5,6.93999919 5.5,7.5 C5.5,8.05999882 5.27818687,8.5589197 4.91855298,8.91855359 C4.55892025,9.27818632 4.06000081,9.5 3.5,9.5 C2.94000118,9.5 2.4410803,9.27818687 2.08144641,8.91855298 C1.72181368,8.55892025 1.5,8.06000081 1.5,7.5 C1.5,6.94000118 1.72181313,6.4410803 2.08144702,6.08144641 C2.44107975,5.72181368 2.93999919,5.5 3.5,5.5 Z M8.5,5.5 C9.05999882,5.5 9.5589197,5.72181313 9.91855359,6.08144702 C10.2781863,6.44107975 10.5,6.93999919 10.5,7.5 C10.5,8.05999882 10.2781869,8.5589197 9.91855298,8.91855359 C9.55892025,9.27818632 9.06000081,9.5 8.5,9.5 C7.94000118,9.5 7.4410803,9.27818687 7.08144641,8.91855298 C6.72181368,8.55892025 6.5,8.06000081 6.5,7.5 C6.5,6.94000118 6.72181313,6.4410803 7.08144702,6.08144641 C7.44107975,5.72181368 7.93999919,5.5 8.5,5.5 L8.5,5.5 Z" stroke="#FFFFFF" fill="#767676" fill-rule="nonzero"><\/path> <\/g> <\/svg>')});this.endContainer.on("click",function(){n.dispatchCurrentPage(n.target.pageCount)});this.nextContainer.on("click",function(){n.dispatchCurrentPage(n.target.currentPage+1)});this.container.append(this.prevContainer,this.startContainer,this.prevMoreContainer,this.pagerContainer,this.nextMoreContainer,this.endContainer,this.nextContainer)},t.prototype.createItemHTML=function(n){return"<li key='".concat(n,"' class='").concat("FUI-pagination-item","'>").concat(n,"<\/li>")},t.prototype.dispatchPageCount=function(){var n=Math.ceil(this.target.total/this.target.pageSize);this.target.pageCount=n;this.endContainer.text(n);this.endContainer.attr("key",n);n>=0?this.startContainer.show():this.startContainer.hide();n>1?this.endContainer.show():this.endContainer.hide();this.dispatchCurrentPage();this.updatePages()},t.prototype.dispatchCurrentPage=function(n){var t=n;n<1?t=1:n>this.target.pageCount?t=Math.max(this.target.pageCount,1):isNaN(n)&&(t=1);this.target.currentPage=t},t.prototype.updatePages=function(){this.updatePagers();this.updateItemActive()},t.prototype.updatePagers=function(){var c=this,e=this.target.currentPage,t=this.target.pagerCount,r=this.target.pageCount,s=(t-1)/2,u=!1,f=!1,i,h,o,n;if(r>t&&(e>t-s&&(u=!0),e<r-s&&(f=!0)),i=[],u&&!f)for(h=r-(t-2),n=h;n<r;n++)i.push(n);else if(!u&&f)for(n=2;n<t;n++)i.push(n);else if(u&&f)for(o=Math.floor(t/2)-1,n=e-o;n<=e+o;n++)i.push(n);else for(n=2;n<r;n++)i.push(n);u?this.prevMoreContainer.show():this.prevMoreContainer.hide();f?this.nextMoreContainer.show():this.nextMoreContainer.hide();this.pagerContainer.html("".concat(i.map(function(n){return c.createItemHTML(n)}).join("")))},t.prototype.updateItemActive=function(){this.container.find(".".concat("FUI-pagination-item-active")).removeClass("FUI-pagination-item-active");this.container.find(".".concat("FUI-pagination-item","[key=").concat(this.target.currentPage,"]")).addClass("FUI-pagination-item-active")},t}(n.ControlUIBase);n.PaginationUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(){var i=n!==null&&n.apply(this,arguments)||this;return i.defaultUI=t,i}return __extends(i,n),i}(n.UserControl),t;n.Progress=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createContainer=function(){this.container=$('<div class="'.concat("FUI-progress",'"><\/div>'))},t.prototype.createChildren=function(){var n=$('<div class="spinner"><i><\/i><\/div>');this.container.append(n)},t}(n.ControlUIBase);n.ProgressUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function i(i,r,u){i===void 0&&(i="");r===void 0&&(r="");u===void 0&&(u="");var f=n.call(this)||this;return f.focusable=!0,f.defaultUI=t,f.registProperty("text",i),f.registProperty("placeholder",r),f.registProperty("type","text"),f.registProperty("autocomplete"),f.registProperty("suffix",u),f}return __extends(i,n),i.prototype.confirm=function(){this.dispatch("Confirm")},i.prototype.asSearchBox=function(){return this.type="search",this},i}(n.UserControl),t;n.TextBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"text",{set:function(n){this.inputContainer[0].value=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{set:function(n){this.inputContainer[0].placeholder=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suffix",{set:function(n){this.suffixContainer.empty();this.suffixContainer.append($(n))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{set:function(n){this.inputContainer.attr("type",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusableContainer",{get:function(){return this.inputContainer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autocomplete",{set:function(n){n&&(this.inputContainer[0].autocomplete=n)},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("div")).addClass("FUI-textbox")},t.prototype.createChildren=function(){var n=this;this.inputContainer=$(document.createElement("input")).addClass("FUI-textbox-input");this.suffixContainer=$(document.createElement("span")).addClass("FUI-textbox-suffix");this.container.append(this.inputContainer,this.suffixContainer);this.inputContainer.on("change",function(){n.target.text=n.inputContainer[0].value});this.inputContainer.on("keypress",function(t){t.keyCode===13&&(t.stopPropagation(),n.target.text=n.inputContainer[0].value,n.target.confirm())});this.suffixContainer.on("click",function(){return n.target.dispatch("SuffixClicked")})},t}(n.ControlUIBase);n.TextBoxUI=t})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var r=function(n){function i(i){i===void 0&&(i=[]);var r=n.call(this)||this;return r.focusable=!0,r.defaultUI=t,r.registProperty("value"),r.registProperty("items",i),r.registProperty("displayName"),r}return __extends(i,n),i}(n.UserControl),t,i;n.ComboBox=r;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"value",{set:function(n){this.container.val(JSON.stringify(n))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{set:function(){this.container.empty();this.createChildren();this.value=this.target.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{set:function(){this.container.empty();this.createChildren()},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("select")).addClass("FUI-combobox")},t.prototype.createContainerEvents=function(){var t=this;n.prototype.createContainerEvents.call(this);this.container.on("change",function(){t.target.value=JSON.parse(t.container.val())})},t.prototype.createChildren=function(){var n,t=this,i,r;this.target.items&&(i=!!this.target.displayName,r=this.target.items.map(function(n){var r=$(document.createElement("option")).addClass("FUI-combobox-item"),u=JSON.stringify(n);return r.val(u),r.text(i?n[t.target.displayName]:n),u===JSON.stringify(t.target.value)&&r.attr("selected","selected"),r}),(n=this.container).append.apply(n,r))},t}(n.ControlUIBase);n.ComboBoxUI=t;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"value",{set:function(n){this.container.val(JSON.stringify(n))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{set:function(){this.container.empty();this.createChildren();this.value=this.target.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{set:function(){this.container.empty();this.createChildren()},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){this.container=$(document.createElement("div")).addClass("FUI-combobox")},t.prototype.createChildren=function(){var t,n=this,i=Math.floor(Math.random()*1e8),r,u;this.inputContainer=$(document.createElement("input")).attr("list",i).on("change",function(){n.target.value=JSON.parse(n.inputContainer.val())});this.container.append(this.inputContainer);this.dataListContainer=$(document.createElement("datalist")).attr("id",i);this.target.items&&(r=!!this.target.displayName,u=this.target.items.map(function(t){var i=$(document.createElement("option")).addClass("FUI-combobox-item"),u=JSON.stringify(t);return i.val(u),i.text(r?t[n.target.displayName]:t),u===JSON.stringify(n.target.value)&&i.attr("selected","selected"),i}),(t=this.dataListContainer).append.apply(t,u));this.container.append(this.dataListContainer)},t}(n.ControlUIBase);n.RecommendComboBoxUI=i})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var r=function(t){function r(r){var u=t.call(this)||this;return u.defaultUI=i,u.isMobile=n.Platform.isMobile(),u.registProperty("dateTimeValue",n.FormatHelper.formatValue(r,"yyyy/MM/dd HH:mm:ss")),u}return __extends(r,t),r.prototype.getValue=function(){return n.Common.IsEmpty(this.dateTimeValue)?null:new Date(this.dateTimeValue)},r.prototype.setValue=function(t){n.Common.IsEmpty(t)||(this.dateTimeValue=n.FormatHelper.formatValue(t,"yyyy/MM/dd HH:mm:ss"))},r}(t.UserControl),i;t.DateTimePicker=r;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"dateTimeValue",{set:function(n){if(this.target.isMobile){if(this.getValueFromNativeControl()===n)return;this.setValueToNativeControl(n)}else{if(this.getValueFromInputManControl()===n)return;this.setValueToInputManControl(n)}},enumerable:!1,configurable:!0}),i.prototype.createContainer=function(){this.container=$("<div class=".concat("FUI-datetimepicker","><\/div>"))},i.prototype.createChildren=function(){var n=this;this.target.isMobile?(this.dateContainer=$('<input type="date"><\/input>'),this.timeContainer=$('<input type="time"><\/input>'),this.dateContainer.change(function(){n.target.dateTimeValue=n.getValueFromNativeControl()}),this.timeContainer.change(function(){n.target.dateTimeValue=n.getValueFromNativeControl()}),this.container.append(this.dateContainer,this.timeContainer)):this.container.append(this.getInputDateTime())},i.prototype.getInputDateTime=function(){var r=this,i=n.DomUtilities.createJqueryDomElement("input"),u=n.CellDomCreateHelper.createControlContainer(),t;u.append(i);t=new GC.InputMan.GcDateTime(i[0],{displayFormatPattern:"yyyy/MM/dd HH:mm:ss",formatPattern:"yyyy/MM/dd HH:mm:ss"});this._gcDateTime=t;t.addDropDown(GC.InputMan.DropDownButtonAlignment.RightSide,GC.InputMan.DateDropDownType.Picker);t.setValue(null);this.inputContainer=i;this._gcDateTime.onValueChanged(function(){r.target.dateTimeValue=r.getValueFromInputManControl()});return u},i.prototype.getValueFromInputManControl=function(){var t=this._gcDateTime.getValue();return t instanceof Date?n.FormatHelper.formatValue(t,"yyyy/MM/dd HH:mm:ss"):null},i.prototype.setValueToInputManControl=function(t){n.Common.IsEmpty(t)||this._gcDateTime.setValue(t)},i.prototype.getValueFromNativeControl=function(){if(n.Common.IsEmpty(this.dateContainer.val()))return this.timeContainer.val(""),null;n.Common.IsEmpty(this.timeContainer.val())&&this.timeContainer.val("00:00");var t=new Date("".concat(this.dateContainer.val()," ").concat(this.timeContainer.val(),":00"));return n.FormatHelper.formatValue(t,"yyyy/MM/dd HH:mm:ss")},i.prototype.setValueToNativeControl=function(t){if(!n.Common.IsEmpty(t)){var i=t.split(" "),r=i[0],u=i[1];this.dateContainer.val(n.FormatHelper.formatValue(r,"yyyy-MM-dd"));this.timeContainer.val(n.FormatHelper.formatValue(u,"HH:mm"))}},i}(t.ControlUIBase);t.DateTimePickerUI=i})(t=n.UI||(n.UI={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t,l="popuptype",a=(t={},t[0]="dialog",t[1]="dropdown",t[2]="dropdown",t[3]="drawer",t[4]="drawer",t),v=function(){function t(){}return t.createConfirmPopupDom=function(t,i,r,u){var o,c,l,f;u===void 0&&(u=!0);f=(new s).identify("fgc-popup-dialog");f.title=t;f.iconText.icon=i;f.iconText.text=r;f.closeButton.visibility=u;f.popupType="confirmbox";n.ForguncyData.pageInfo.appendExtralPopup(f);var a=f.createUI(h),v=a.container,e=$("#confirmContainer");e.append(v);e.css("display","");f.on("Dispose",function(){e.children().length<1&&e.css("display","none")});return(l=(c=(o=n.ForguncyData===null||n.ForguncyData===void 0?void 0:n.ForguncyData.pageInfo)===null||o===void 0?void 0:o.pageElementManager)===null||c===void 0?void 0:c.listviewCollection)===null||l===void 0?void 0:l.loseAllFocus(),f.show(),a},t.createPopupDom=function(t,u,f,s){var h=(new r).identify("fgc-popup-dialog"),v,l,c;h.displayMode=s.popupDisplayMode;h.title=f;h.body=u;h.autoBodySize=!0;v=n.ForguncyData.GlobalSettings.HidePopUpCloseButton;h.closeButton.visibility=!v;h.closeByEscKey=!v;h.popupType=a[s.popupDisplayMode];s.popupDisplayMode===1&&s.anchor?h.centerWhenOpen=!1:s.popupDisplayMode===3||s.popupDisplayMode===4?(h.centerWhenOpen=!1,h.drawerDirection=s.drawerDirection,h.showHeader=s.showDrawerHeader,h.moveable=!1,h.disposeDelayDuration=300,h.closeWhenClickGrayArea=s.closeWhenClickGrayArea,s.popupDisplayMode===4&&(h.cover=!0)):s.popupDisplayMode===2?h.alwaysCenter=!0:s.popupDisplayMode===0&&(h.dialogLocation=s.dialogLocation,s.dialogLocation!=="50%"&&(h.centerWhenOpen=!1));l=i;switch(s.popupDisplayMode){case 1:case 2:l=e;break;case 3:case 4:l=o}c=h.createUI(l);t.append(c.container);s.popupDisplayMode===1&&s.anchor&&(c.applyModifier(new n.UI.AutoLocateModifier(c,s.anchor)),c.container.addClass("fgc-popup-transparentcover"));h.on("Close",function(t,i){if(n.ForguncyData.pageInfo.hasExtraDialog||n.ForguncyData.pageInfo.dialogUI.target!==h){i&&(i.cancel=!0);return}var r={$type:"Forguncy.Model.ClosePopupCommand, ServerDesignerCommon",PassValueBack:!1,DisplayName:n.RS.CommandName_ClosePopupCommand};n.ForguncyData.commandExcutor.excuteCommand([r],{runTimePageName:"p",commandTrigger:null,commandID:n.RS.PopupCloseButton,eventType:"click"});i.cancel=!0});return c},t}(),r,u,i,f,e,o,s,h,c;n.PopupHelper=v;r=function(t){function r(){var r=t.call(this)||this;return r.opacity=1,r.mainTextColor=n.ColorHelper.Convert("Text 1 0"),r.drawerDirection=1,r.dialogLocation="50%",r.resizeable=!1,r.defaultUI=i,r.registProperty("body"),r.registProperty("autoBodySize"),r.registProperty("opacity"),r.registProperty("popupType"),r.registProperty("mainTextColor"),r.registProperty("drawerDirection"),r}return __extends(r,t),r}(n.UI.Dialog);n.PopupDialog=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"mainTextColor",{set:function(n){this.container.css("color",n)},enumerable:!1,configurable:!0}),t}(n.UI.DialogHeaderUI);n.PopupDialogHeaderUI=u;i=function(n){function t(t){var i=n.call(this,t)||this;return t.dialogLocation!=="50%"&&i.setPopupDialogLocation(t),i}return __extends(t,n),Object.defineProperty(t.prototype,"header",{get:function(){return new u(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return new f(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footer",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoBodySize",{set:function(n){n?(this.dialog.css("display","inline-flex"),this.dialog.css("width","auto"),this.dialog.css("height","auto"),this.centerWhenOpen=this.target.centerWhenOpen):(this.dialog.css("display","flex"),this.dialog.css("width",""),this.dialog.css("height",""))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{set:function(n){this.container.css("z-index",n);this.cover.css("z-index",n);this.dialog.css("z-index",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"popupType",{set:function(n){this.container.attr(l,n);this.dialog.attr(l,n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainTextColor",{set:function(n){this.dialog.css("color",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{set:function(n){this.container.css("opacity",n)},enumerable:!1,configurable:!0}),t.prototype.setPopupDialogLocation=function(n){var t=this,i=parseInt(n.dialogLocation)/100;window.requestAnimationFrame(function(){t.target.location=t.getDialogLocation(i)})},t}(n.UI.DialogUI);n.PopupDialogUI=i;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"body",{set:function(n){n&&(this.container.empty(),this.container.append(n))},enumerable:!1,configurable:!0}),t}(n.UI.DialogContentUI);n.PopupDialogContentUI=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"header",{get:function(){return null},enumerable:!1,configurable:!0}),t.prototype.createChildren=function(){var t=this;n.prototype.createChildren.call(this);this.cover.on("click",function(n){n.stopPropagation();t.target.close()})},t}(i);n.PopupDropdownUI=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getRealHeight=function(n){return parseFloat(getComputedStyle(n).height)},i.prototype.observerCallback=function(){if(this.dialog.find(".".concat("fgc-page-container")).length!==0){var i=this.getRealHeight(this.dialog[0]),r=this.getRealHeight(this.dialog.find(".".concat("fgc-page-container"))[0]),n=r>i?"":0,t=parseFloat(this.dialog.css("bottom"));t<0||t!==parseFloat(n.toString())&&this.dialog.css("bottom",n)}},Object.defineProperty(i.prototype,"header",{get:function(){return this.target.showHeader?new u(this.target):null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawerDirection",{set:function(n){this.dialog.addClass("fgc-drawer");this.target.showHeader&&this.dialog.addClass("fgc-drawer-includ-title");var t=this.target.cover;switch(n){case 1:this.dialog.css("width","100vw");this.dialog.css("height",t?"100vh":"auto");this.dialog.addClass("fgc-drawer-ttb");break;case 0:this.dialog.css("width","100vw");this.dialog.css("height",t?"100vh":"auto");t||(this.dialog.css("bottom","0"),this.dialog.css("max-height","100%"));this.dialog.addClass("fgc-drawer-btt");this.observer=new MutationObserver(this.observerCallback.bind(this));this.observer.observe(this.dialog[0],{attributes:!0});break;case 2:this.dialog.css("height","100vh");this.dialog.css("width",t?"100vw":"auto");this.dialog.addClass("fgc-drawer-ltr");break;case 3:this.dialog.css("height","100vh");this.dialog.css("width",t?"100vw":"auto");t||this.dialog.css("right","0");this.dialog.addClass("fgc-drawer-rtl")}},enumerable:!1,configurable:!0}),i.prototype.createChildren=function(){var n=this;t.prototype.createChildren.call(this);this.cover.on("click",function(t){n.target.closeWhenClickGrayArea&&(t.stopPropagation(),n.target.close())})},i.prototype.dispose=function(){var n,i=$(document.body);i.css("overflow",this.cachedBodyOverflow);i.css("padding-right",this.cachedPaddingRight);this.target.off("PropertyChanged",this.visibilityChangedHandler);(n=this.observer)===null||n===void 0?void 0:n.disconnect();t.prototype.dispose.call(this)},i.prototype.createContainerEvents=function(){var i=this;t.prototype.createContainerEvents.call(this);this.visibilityChangedHandler=function(t,r){var u,f,e;r==="visibility"&&(u=$(document.body),i.target.visibility?(i.cachedPaddingRight=u.css("padding-right"),f=n.DomUtilities.measureBrowserScrollbarWidth(),e=document.documentElement.clientHeight<document.body.scrollHeight,f>0&&e&&u.css("padding-right",f),i.cachedBodyOverflow=$(document.body).css("overflow"),u.css("overflow","hidden"),n.MetadataLoader.IsInMobileSimulatorFrame()&&$(".simplebar-scrollbar").css("opacity",0)):(u.css("overflow",i.cachedBodyOverflow),u.css("padding-right",i.cachedPaddingRight),n.MetadataLoader.IsInMobileSimulatorFrame()&&$(".simplebar-scrollbar").css("opacity",undefined)))};this.target.on("PropertyChanged",this.visibilityChangedHandler)},i}(i);n.DrawerUI=o;s=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.iconText=(new n.UI.IconText).identify("fgc-confirmbox-icontext"),i.mainTextColor="#333",i.autoBodySize=!0,i}return __extends(i,t),i}(r);n.PopupConfirmBox=s;h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"content",{get:function(){return new c(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"footer",{get:function(){return new n.UI.DialogFooterUI(this.target)},enumerable:!1,configurable:!0}),i}(i);n.PopupConfirmBoxUI=h;c=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createChildren=function(){this.addChild(this.target.iconText.createUI(n.UI.ImageTextUI))},i}(f);n.PopupConfirmBoxContentUI=c})(Forguncy||(Forguncy={}))
;var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var t=function(){function t(){}return t.appendSendEmailConfirm=function(t){var r={email:"",sendText:n.RS.ConcurrentLicenseError_SendEmail,cancelText:n.RS.ConcurrentLicenseError_Cancel,warningText:n.RS.ConcurrentLicenseError_NoEnoughLicense,fromAddressPlaceHolderText:n.RS.ConcurrentLicenseError_AddressPlaceHolder,messagePlaceHolderText:n.RS.ConcurrentLicenseError_MessagePlaceHolder,onSendEmail:function(t,i){var r=$("#fgc-sendemail-address").val(),u=$("#fgc-sendemail-message").val();n.PageBuilder.showPageLoadingCover();n.Common.forguncyPost("Home/NoticeAdmin",{title:n.RS.ConcurrentLicenseError_EmailTitle,address:r,message:u},function(r){n.PageBuilder.hidePageLoadingCover();r&&r.Result?(window.alert(n.RS.ConcurrentLicenseError_SendSuccess),t&&t()):(window.alert(n.RS.ConcurrentLicenseError_SendFailed+"\n"+r.Message),i&&i())})},onCancel:function(){}},i=__assign(__assign({},r),t);n.ListviewBase.lockListviewClick();n.PageBuilder.hidePageLoadingCover();n.Platform.isMobile()?this.createForMobile(i):this.createForPC(i)},t.createForMobile=function(t){var u=n.MetadataHelper.getDefaultFonts(),r;$(document.head).append($("<style>html {font-family: ".concat(u,";}<\/style>")));r='\n                <div id="'.concat("fgc-sendemail-container",'" style="position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.2);color:#333;">\n                    <div style="height:100%;padding:0 10px;background-color:#fff;">\n                        <p class="info" style="margin:0;padding:10px;text-align:left;">\n                        ').concat(t.warningText,'\n                        <\/p>\n                        <div style="margin:0 10px 10px 10px;">\n                            <textarea id="').concat("fgc-sendemail-message",'"placeholder="').concat(t.messagePlaceHolderText,'" style="display:block;height:300px;width:100%;resize:none;font-size:13.33px;box-sizing:border-box;"><\/textarea>\n                        <\/div>\n                        <div style="display:flex;align-items:center;margin:0 10px;">\n                            <label for="').concat("fgc-sendemail-address",'" style="font-size:14px;">').concat(n.RS.ConcurrentLicenseError_SenderAddress,'<\/label>\n                            <input id="').concat("fgc-sendemail-address",'" type="text" placeholder="').concat(t.fromAddressPlaceHolderText,'" style="flex-grow:1;margin-left:5px;padding:4px 1px;font-size:13.33px;box-sizing:border-box;" />\n                        <\/div>\n                        <div style="text-align:right;margin:10px 10px 0 10px;">\n                            <button id="').concat("fgc-sendemail-send",'" style="padding:4px 10px;margin-right:10px;">').concat(t.sendText,'<\/button>\n                            <button id="').concat("fgc-sendemail-cancel",'" style="padding:4px 10px;">').concat(t.cancelText,"<\/button>\n                        <\/div>\n                    <\/div>\n                <\/div>\n            ");(n.Platform.isIOSDevice()||n.Platform.isMac())&&$("meta[name='viewport']").replaceWith("<meta name='viewport' content='width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi' />");var i=$(r),f=i.find("#fgc-sendemail-send"),e=i.find("#fgc-sendemail-cancel");i.find("#fgc-sendemail-address").val(t.email);f.click(t.onSendEmail);e.click(function(){$("#fgc-sendemail-container").remove();t&&t.onCancel()});$(document.body).append(i)},t.createForPC=function(t){var u=n.MetadataHelper.getDefaultFonts(),r,i;$(document.head).append($("<style>html {font-family: ".concat(u,";}<\/style>")));r=$('\n                    <div style="width:400px;padding-bottom:10px;background-color:#fff;">\n                        <p class="info" style="margin:0;padding:10px 16px;text-align:left;">\n                        '.concat(t.warningText,'\n                        <\/p>\n                        <div style="margin:0 16px 10px 16px;">\n                            <textarea id="').concat("fgc-sendemail-message",'" placeholder="').concat(t.messagePlaceHolderText,'" style="display:block;height:150px;width:100%;resize:none;font-size:14px;box-sizing:border-box;"><\/textarea>\n                        <\/div>\n                        <div style="display:flex;align-items:center;margin:0 16px;">\n                            <label for="').concat("fgc-sendemail-address",'" style="font-size:14px;">').concat(n.RS.ConcurrentLicenseError_SenderAddress,'<\/label>\n                            <input id="').concat("fgc-sendemail-address",'" type="text" placeholder="').concat(t.fromAddressPlaceHolderText,'" style="flex-grow:1;margin-left:5px;padding:6px 1px;font-size:14px;box-sizing:border-box;" />\n                        <\/div>\n                    <\/div>\n                '));r.find("#fgc-sendemail-address").val(t.email);i=n.PopupHelper.createConfirmPopupDom("","","",!0);i.target.footerButtonGroup.items[0].text=t.sendText;i.target.footerButtonGroup.items[1].text=t.cancelText;i.container.find(".".concat("FUI-dialog")).width(400).css("height","auto");i.container.find(".".concat("FUI-dialog-content")).empty().append(r).css({width:"",height:""});i.centerWhenOpen=!0;i.target.on("Confirm",function(){i.target.visibility=!1;t.onSendEmail&&t.onSendEmail(function(){i&&i.target.close()},function(){i.target.visibility=!0})});i.target.on("Close",function(){t.onCancel&&t.onCancel()});i.target.on("Cancel",function(){t.onCancel&&t.onCancel()})},t}();n.SendEmailHelper=t})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var u=function(){function r(n,t,i,u,f){this.metadata=n;this.layout=t;this.runTimePageName=i;this.designerPageName=u;this.uniqueIndex=f===undefined?this.generateUniqueIndex():f;this.name=r.NamePrefix+this.uniqueIndex.toString();this.rowHeaderCheckBoxColmunIndex=this.isRowHeaderVisible()===!0?1:0;this.preprocessMetadata();this.initColumnBindingInfos();this.initColumns(i);this.initVisibleColumns();this.initRowHeaderInfo();this.initRowHeaderCheckBoxInfo()}return r.prototype.isRowHeaderContextMenuVisible=function(){return this.metadata.RowHeaderContextMenu&&this.metadata.RowHeaderContextMenu.ContextMenuItems&&this.metadata.RowHeaderContextMenu.ContextMenuItems.some(function(n){return n.Visible===!0})},r.prototype.getRowHeaderContextMenuData=function(){return this.metadata.RowHeaderContextMenu},r.prototype.isDoubleClickCommandsExists=function(){return this.metadata.DoubleClickCommands&&this.metadata.DoubleClickCommands.length>0},r.prototype.getDoubleClickCommands=function(){return this.metadata.DoubleClickCommands},r.prototype.generateUniqueIndex=function(){return r.Index++},r.prototype.getTabIndex=function(){return(n.ForguncyData.pageInfo.enableTabIndex||{})[this.runTimePageName]?this.metadata.TabIndex:null},r.prototype.getBindingInfoColumnTypeInDataModel=function(t){var i,u,r;if(this.metadata.Columns&&t>-1&&t<this.metadata.ColumnCount)for(i=0,u=this.metadata.Columns;i<u.length;i++)if(r=u[i],r&&r.Index===t)return r.BindingColumnDataType;return n.ColumnDataType.Other},r.prototype.preprocessMetadata=function(){var t=this.metadata;t.DataTableCanEdit=!!t.DataTableCanEdit;t.CanDelete=!!t.CanDelete;t.CanAddRow=!!t.CanAddRow;t.CanEdit=!!t.CanEdit;t.AlwaysInEditMode=!!t.AlwaysInEditMode;t.IsGroupMode=!!t.IsGroupMode;t.LoadOnDemandCount===undefined&&(t.LoadOnDemandCount=0);n.Common.AdjustCellRange(t.CellRange);t.SelectionMode===undefined&&(t.SelectionMode=0);t.AlwaysReservedSelections=!!t.AlwaysReservedSelections;t.IsSingleSelection=!!t.IsSingleSelection;t.DisableAutoSelectRow=!!t.DisableAutoSelectRow;t.AutoFitRowHeight=!!t.AutoFitRowHeight;t.AutoFitColumnWidth=!!t.AutoFitColumnWidth;this.metadata.ColumnOperation!==undefined&&this.metadata.DataTableName||(this.metadata.ColumnOperation=0)},r.prototype.initColumnBindingInfos=function(){var t,i,u;this.columnBindingInfos=[];var f=this.metadata.Columns,e=function(t){var i,u;if(!t.TemplateCell||!t.TemplateCell.Element||(i=t.TemplateCell.Element.BindingInfo,!i))return"continue";u=r.columnBindingInfos.some(function(t){return n.Common.isBindingInfoEquals(t,i)});u||r.columnBindingInfos.push(i)},r=this;for(t=0,i=f;t<i.length;t++)u=i[t],e(u)},r.prototype.initColumns=function(t){var c,s,l,f,h,e,o,r,u;for(this.columnDataInfos=[],c=this.getColumnCount(),s=0;s<c;s++)this.columnDataInfos.push(new i);for(l=this.metadata.Columns,f=0,h=l;f<h.length;f++)if(e=h[f],o=this.columnDataInfos[e.Index],e.TemplateCell&&(r=e.TemplateCell.Element,r&&(n.Common.IsEmpty(r.Value)||(o.staticValue=n.KeyWords.GetKeyWordValue(r.Value,t)),o.columnName=r.Name&&r.Name.length>0?r.Name[0]:undefined,r.BindingInfo)))for(u=0;u<this.columnBindingInfos.length;u++)if(n.Common.isBindingInfoEquals(this.columnBindingInfos[u],r.BindingInfo)){o.bindingInfoIndex=u;break}},r.prototype.initVisibleColumns=function(){var f,s,i,e,u,o,r;if(this.visibleColumns=[],f=this.metadata.Columns,f)for(s=f.length,i=0;i<s;i++)this.isRowHeaderVisible()&&i===0||this.isRowHeaderCheckBoxVisible()&&i===this.rowHeaderCheckBoxColmunIndex||(e=f[i],e.Width<=0)||(u=new t(e,this.name,this.canEdit(),this.metadata.ColumnOfDetailTable,this),o=u.cellType.constructor,(o===n.RadioGroupCellType||o===n.CheckBoxGroupCellType||o===n.ComboBoxCellType_InputMan)&&(r=u.getTemplateCell(),(r===null||r===void 0?void 0:r.CellType)&&(r.CellType.haveLoadItems=!r.CellType.IsBounding)),u.dependenceColumnsIndex=e.DependenceColumnsIndex,this.visibleColumns.push(u))},r.prototype.initRowHeaderInfo=function(){if(this.isRowHeaderVisible()){var n=this.metadata.Columns;if(!n||n.length<=0)return;this.rowHeaderColumnInfo=new t(n[0],this.name,this.canEdit(),this.metadata.ColumnOfDetailTable,this)}},r.prototype.initRowHeaderCheckBoxInfo=function(){if(this.isRowHeaderCheckBoxVisible()){var n=this.metadata.Columns;if(!n||n.length<=this.rowHeaderCheckBoxColmunIndex+1)return;this.rowHeaderCheckBoxColumnInfo=new t(n[this.rowHeaderCheckBoxColmunIndex],this.name,this.canEdit(),this.metadata.ColumnOfDetailTable,this)}},r.prototype.isColumnHeaderVisibleInDesigner=function(){return!!this.metadata.IsColumnHeaderVisibleInDesigner},r.prototype.getListviewName=function(){return this.metadata.Name},r.prototype.getDataTableName=function(){return this.metadata.DataTableName},r.prototype.getMasterDataTableName=function(){return this.metadata.MasterDataTableName},r.prototype.getColumnOfMasterTable=function(){return this.metadata.ColumnOfMasterTable},r.prototype.getColumnOfDetailTable=function(){return this.metadata.ColumnOfDetailTable},r.prototype.getRangeInfo=function(){return this.metadata.CellRange},r.prototype.getContentRangeInfo=function(){var n=this.getRangeInfo(),t;return this.metadata.IsColumnHeaderVisibleInDesigner?(t=this.getDesignerColumnHeaderRowCount(),{Column:n.Column,ColumnCount:n.ColumnCount,Row:n.Row+t,RowCount:n.RowCount-t}):n},r.prototype.getColumnHeaderRangeInfo=function(){var t=this.getDesignerColumnHeaderRowCount(),n=this.getRangeInfo();return{Row:n.Row,Column:n.Column,RowCount:t,ColumnCount:n.ColumnCount}},r.prototype.getDesignerColumnHeaderRowCount=function(){return this.metadata.ColumnHeaderHeights?this.metadata.ColumnHeaderHeights.length:0},r.prototype.getColumnMetaData=function(n){var i=this.metadata.Columns,r,t;if(!i)return null;for(r=i.length,t=0;t<r;t++)if(i[t].Index===n)return i[t];return null},r.prototype.getLoadOnDemandCount=function(){return this.metadata.LoadOnDemandCount},r.prototype.shouldLoadOnDemand=function(){return!!this.metadata.LoadOnDemandCount},r.prototype.getTemplateRowHeight=function(){return this.metadata.TemplateRowHeight},r.prototype.getColumnHeaderHeight=function(){return this.metadata.IsColumnHeaderVisibleInDesigner?this.metadata.ColumnHeaderHeights:[r.DefaultColumnHeaderHeight]},r.prototype.getConditionFormulas=function(){return this.metadata.ConditionFormulas},r.prototype.getDependenceCells=function(){return this.metadata.DependenceCells},r.prototype.getListViewStyleTemplate=function(){var i=this.metadata.ListViewStyleName,r,t;if(i)for(r=n.ListViewStyleTemplateUtils.ListViewStyleTemplates.length,t=0;t<r;t++)if(n.ListViewStyleTemplateUtils.ListViewStyleTemplates[t].Name===i)return n.Common.clone(n.ListViewStyleTemplateUtils.ListViewStyleTemplates[t]);return null},r.prototype.getAlternativeBackcolor=function(n){return n?this.getBackcolorStr(this.metadata.EvenRowBackcolor):this.getBackcolorStr(this.metadata.OddRowBackcolor)},r.prototype.getBackcolorStr=function(n){return n&&n!=="#FFFFFF"?n:null},r.prototype.isColumnHeaderVisible=function(){return this.metadata.IsColumnHeaderVisible},r.prototype.isRowHeaderVisible=function(){var n=this.metadata.Columns;return(!n||n.length<=0)&&(this.metadata.IsRowHeaderVisible=!1),this.metadata.IsRowHeaderVisible===!0?!0:!1},r.prototype.isRowHeaderCheckBoxVisible=function(){var n=this.metadata.Columns;return(!n||n.length<this.rowHeaderCheckBoxColmunIndex+1)&&(this.metadata.IsRowHeaderCheckBoxVisible=!1),this.metadata.IsRowHeaderCheckBoxVisible===!0?!0:!1},r.prototype.isRowHeaderFillNumber=function(){return this.metadata.IsRowHeaderFillNumber===!0?!0:!1},r.prototype.isMasterTable=function(){return n.Common.IsEmpty(this.getMasterDataTableName())},r.prototype.getColIndexOfColumnOfDetailTable=function(){var n=this.getColumnOfDetailTable();return n?this.getColIndexByDataColumnName(n):-1},r.prototype.canEdit=function(){return!n.Platform.isMobile()&&this.metadata.CanEdit},r.prototype.canDelete=function(){return this.metadata.CanDelete},r.prototype.canAddRow=function(){return!n.Platform.isMobile()&&this.metadata.CanAddRow},r.prototype.allowShowTotalRow=function(){return!!this.metadata.IsTotalRowVisible},r.prototype.getIsTotalRowAtFirstRow=function(){return!!this.metadata.IsTotalRowAtFirstRow},r.prototype.getIsTotalRowAtLastRow=function(){return!this.metadata.IsTotalRowAtFirstRow},r.prototype.getTotalRowBindingInfosIgnoreNullValues=function(){return this.getTotalRowSettingsIgnoreNullValues().map(function(n){return n&&n.BindingInfo}).filter(function(t){return!n.Common.IsEmpty(t)})},r.prototype.getTotalRowSettingsIgnoreNullValues=function(){return this.metadata.Columns.map(function(n){return n.TotalRowCell}).filter(function(t){return!n.Common.IsEmpty(t)})},r.prototype.ShowEditStatusIcon=function(){return this.metadata.ShowEditStatusIcon},r.prototype.isGroupMode=function(){return this.metadata.IsGroupMode},r.prototype.isColumnFull=function(){return!!this.metadata.IsColumnFull},r.prototype.getBindingInfo=function(n){var t=this.getBindingInfoIndexOfColumn(n);return t===-1?null:this.columnBindingInfos[t]},r.prototype.isBindingColumn=function(n){return this.getBindingInfoIndexOfColumn(n)!==-1},r.prototype.getBindingInfoIndexOfColumn=function(n){var t=this.columnDataInfos[n];return t?t.bindingInfoIndex:-1},r.prototype.getStaticValue=function(n){var t=this.columnDataInfos[n];return t?t.staticValue:null},r.prototype.getColIndexByDataColumnName=function(n){return this.getColIndexByBindingInfo({TableName:this.metadata.DataTableName,ColumnName:n})},r.prototype.getColIndexByBindingInfo=function(t){var u,i,r;if(!t)return-1;for(u=this.getColumnCount(),i=0;i<u;i++)if((r=this.getBindingInfo(i),r)&&n.Common.isBindingInfoEquals(r,t))return i;return-1},r.prototype.getColIndexByName=function(n,t){var u,i,r;if(!n)return-1;for(t||(n=n.toLowerCase()),u=this.getColumnCount(),i=0;i<u;i++)if((r=this.columnDataInfos[i].columnName,r)&&(t||(r=r.toLowerCase()),r===n))return i;return-1},r.prototype.getColIndexByVisibleColIndex=function(n){return n<0||n>=this.visibleColumns.length?-1:this.visibleColumns[n].getColumnIndex()},r.prototype.getMergedColIndex=function(n){var i,r,t;if(n<0||(i=this.metadata.OriginalColumns||this.metadata.Columns,!i))return-1;for(r=i.length,t=0;t<r;t++)if(i[t].Index===n)return t;return-1},r.prototype.getMergedColumnInfos=function(){return n.Common.IsEmpty(this._mergedColumnInfos)&&(this._mergedColumnInfos=this._createMergedColumnInfos(),this._mergedColumnInfos=this._mergedColumnInfos.sort(function(n,t){return n.DesignerColumnIndex-t.DesignerColumnIndex})),this._mergedColumnInfos},r.prototype._createMergedColumnInfos=function(){var f=this.metadata.Columns,t,e,r,u,i,o,s;if(!f)return[];for(t=[],e=this.getRangeInfo().Column,r=0,u=f;r<u.length;r++)i=u[r],o=this.columnDataInfos[i.Index],t.push({DesignerColumnIndex:i.Index+e,DesignerColumnCount:i.ColumnCount,ColumnName:o.columnName,ColumnDataType:this.getBindingInfoColumnTypeInDataModel(i.Index),ColumnType:n.ListviewColumnType.DataColumn});return this.isRowHeaderVisible()&&(t[0].ColumnType=n.ListviewColumnType.RowHeader),this.isRowHeaderCheckBoxVisible()&&(s=this.isRowHeaderVisible()?1:0,t[s].ColumnType=n.ListviewColumnType.SelectedColumn),t},r.prototype.getColumnCellType=function(t,i){var r=this.getColumnMetaData(t),u;return r&&r.TemplateCell?(u=n.ListivewEditorHelper.getCell(r.TemplateCell.Element,i,this.designerPageName),!u)?null:u.cellType:null},r.prototype.getDataColIndex=function(t){if(n.Common.IsEmpty(t))return-1;t=Number(t);var i=this.metadata.OriginalColumns||this.metadata.Columns;return!i||isNaN(t)||t<0||t>=i.length?-1:i[t].Index},r.prototype.getColumnCount=function(){return this.metadata.ColumnCount},r.prototype.getGrayAreaBackColor=function(){return n.Common.IsEmpty(this.metadata.GrayAreaColor)?"transparent":n.ColorHelper.Convert(this.metadata.GrayAreaColor)},r.prototype.hideSelectionWhenLostFocus=function(){return this.metadata.HideSelectionWhenLostFocus===!0?!0:!1},r.prototype.getSelectionBackColor=function(){return n.Common.IsEmpty(this.metadata.SelectionBackColor)?undefined:this.metadata.SelectionBackColor==="transparent"?"transparent":n.ColorHelper.Convert(this.metadata.SelectionBackColor)},r.prototype.getSelectionBorderColor=function(){return n.ColorHelper.Convert(this.metadata.SelectionBorderColor)},r.prototype.canUserDragDrop=function(){return this.canEdit()&&(this.metadata.AllowDragMove===!0?!0:!1)},r.prototype.canUserDragFill=function(){return this.canEdit()&&(this.metadata.AllowDragFill===!0?!0:!1)},r.prototype.getSelectionMode=function(){return this.metadata.SelectionMode},r.prototype.getAlwaysReservedSelections=function(){return this.metadata.AlwaysReservedSelections},r.prototype.isSingleSelection=function(){return this.metadata.IsSingleSelection},r.prototype.getDisableAutoSelectRow=function(){return this.getSelectionMode()===1&&this.metadata.DisableAutoSelectRow},r.prototype.getAutoFitRowHeight=function(){return this.metadata.AutoFitRowHeight},r.prototype.getAutoFitColumnWidth=function(){return this.metadata.AutoFitColumnWidth},r.prototype.getAlwaysInEditMode=function(){return this.metadata.AlwaysInEditMode},r.prototype.bindingTableCanEdit=function(){return this.metadata.DataTableCanEdit},r.prototype.getAllowGetFocus=function(){return this.metadata.AllowGetFocus===!0?!0:!1},r.prototype.getMoveFocusHorizontally=function(){return this.metadata.MoveFocusHorizontally===!0?!0:!1},r.prototype.getColumnOperation=function(){return this.metadata.ColumnOperation},r.prototype.getDataCommitMode=function(){return this.metadata.DataCommitType===undefined?0:this.metadata.DataCommitType},r.prototype.getDataValidationTime=function(){return this.metadata.DataValidationTime===undefined?0:this.metadata.DataValidationTime},r.prototype.getDoNotLoadDataWhenLoadPage=function(){return this.metadata.DoNotLoadDataWhenLoadPage===!0},r.prototype.getIsAutoReload=function(){return this.metadata.IsAutoReload===!0},r.prototype.getAutoReloadInterval=function(){return this.metadata.AutoReloadInterval||0},r.prototype.getIsAutoScroll=function(){return this.metadata.IsAutoScroll===!0},r.prototype.getAutoScrollSpeed=function(){return this.metadata.AutoScrollSpeed===undefined?0:this.metadata.AutoScrollSpeed},r.prototype.getFrozenIndex=function(){return this.metadata.FrozenIndex},r.prototype.getFrozenIndexEnd=function(){return this.metadata.FrozenIndexEnd},r.prototype.getFrozenLineColor=function(){return this.metadata.FrozenLineColor?n.ColorHelper.Convert(this.metadata.FrozenLineColor):"#9B9B9B"},r.prototype.getDataColumnBindingInfo=function(n){var t,i;return!this.columnDataInfos||!this.columnBindingInfos?null:this.isValidIndex(n,this.columnDataInfos.length)?(t=this.columnDataInfos[n],!this.isValidIndex(t.bindingInfoIndex,this.columnBindingInfos.length))?null:(i=this.columnBindingInfos[t.bindingInfoIndex],i?i:null):null},r.prototype.isValidIndex=function(n,t){return n>=0&&n<t},r.prototype.isDataColumnAllowEdit=function(t){var i=this.getDataColumnBindingInfo(t);return n.Common.cannotEditedBindingInfo(i)?!1:!0},r.prototype.getAllHeaderCellContentElement=function(){var u=[],o=this.metadata.Columns,n,f,t,s,i,e,r;if(!o)return u;for(n=0,f=o;n<f.length;n++)if(t=f[n],t&&t.HeaderCell)for(s=t.HeaderCell,i=0,e=s;i<e.length;i++)r=e[i],r&&r.Element&&u.push(r.Element);return u},r.NamePrefix="s",r.Index=0,r.DefaultColumnHeaderHeight=25,r}(),i,t,r;n.ListviewData=u;i=function(){function n(){this.bindingInfoIndex=-1;this.staticValue=null}return n}();n.ListviewColumnDataInfo=i;t=function(){function t(t,i,r,u,f){var s,e,o,h;(this.columnInfo=t,this.idSuffix=i,this.canEditInForguncy=!1,this.canEnterEditMode=!1,this.needValidateWhenShowEditor=!1,e=this.getTemplateCell(),this.cellType=n.CellTypeHelper.getCellType(e?e:{},1,n.ListivewEditorHelper.getEditorID(),f),e)&&r&&((o=this.getBindingInfo(),((s=this.getTemplateCell())===null||s===void 0?void 0:s.OriginalBindingInfoForPreview)&&(o=this.getTemplateCell().OriginalBindingInfoForPreview),n.Common.cannotEditedBindingInfo(o))||o.ColumnName!==u&&(h=e.CellType,h&&!h.ReadOnly)&&this.cellType.cellTypeData instanceof n.InputCellTypeData&&(this.canEditInForguncy=!0,this.canEnterEditMode=this.cellType.cellTypeData.canEnterEditModeInListview()))}return Object.defineProperty(t.prototype,"totalRowSetting",{get:function(){return this.columnInfo&&this.columnInfo.TotalRowCell},enumerable:!1,configurable:!0}),t.prototype.getTemplateCell=function(){return!this.columnInfo.TemplateCell||!this.columnInfo.TemplateCell.Element?null:this.columnInfo.TemplateCell.Element},t.prototype.getOriginalFormatter=function(){var n;if((n=this.columnInfo.TemplateCell)!==null&&n!==void 0)return n.OriginalFormatter},t.prototype.getClickCommandsMetaData=function(){var t,n=(t=this.getTemplateCell())===null||t===void 0?void 0:t.CellType;return!n||n.CommandExcuteKind!==0||!n.CommandList?null:n.CommandList},t.prototype.getBindingInfo=function(){var n=this.getTemplateCell();return n&&n.BindingInfo?n.BindingInfo:null},t.prototype.getFilterBindingInfo=function(){return this.columnInfo.FilterBindingInfo||this.getBindingInfo()},t.prototype.getFilterDisplayBindingInfo=function(){return this.columnInfo.FilterDisplayBindingInfo},t.prototype.getFilterActualBindingInfo=function(){return this.columnInfo.FilterDisplayBindingInfo||this.columnInfo.FilterBindingInfo||this.getBindingInfo()},t.prototype.getFilterColumnDataType=function(){var t=this.columnInfo.FilterColumnDataType;return t!==undefined?t:this.columnInfo.BindingColumnDataType||n.ColumnDataType.Other},t.prototype.getIsFilterStatisticColumn=function(){return!!this.columnInfo.IsFilterStatisticColumn},t.prototype.getColumnIndex=function(){return this.columnInfo.Index},t.prototype.getName=function(){var n=this.getTemplateCell();return!n||!n.Name||n.Name.length===0||!n.Name[0]?null:n.Name[0]},t.prototype.allowFieldSort=function(){return this.columnInfo.AllowSort},t.prototype.allowNoFieldSort=function(){var t,i,r,n,u;return this.allowFieldSort()?!1:(n=(i=(t=this.columnInfo)===null||t===void 0?void 0:t.TemplateCell)===null||i===void 0?void 0:i.Element,!n)?!0:n.BindingInfo?!1:(u=["Forguncy.ButtonCellType, ServerDesignerCommon","Forguncy.HyperlinkCellType, ServerDesignerCommon","Forguncy.ImageCellType, ServerDesignerCommon","Forguncy.UploadImageCellType, ServerDesignerCommon","Forguncy.AttachmentCelltype, ServerDesignerCommon"],u.indexOf((r=n.CellType)===null||r===void 0?void 0:r.$type)>=0)?!1:!0},t.prototype.getRightBorderWidth=function(t,i){var r=i?GC.Spread.Sheets.LineStyle.thin:GC.Spread.Sheets.LineStyle.empty;return t?r=this.columnInfo.HeaderCell&&this.columnInfo.HeaderCell.length>0&&this.columnInfo.HeaderCell[0].BorderRight?this.columnInfo.HeaderCell[0].BorderRight.Style:GC.Spread.Sheets.LineStyle.thin:this.columnInfo.TemplateCell&&this.columnInfo.TemplateCell.BorderRight&&(r=this.columnInfo.TemplateCell.BorderRight.Style),n.SpreadJSHelper.getBorderWidth(r)},t.prototype.getBottomBorderWidth=function(t){var i=t?GC.Spread.Sheets.LineStyle.thin:GC.Spread.Sheets.LineStyle.empty;return this.columnInfo.TemplateCell&&this.columnInfo.TemplateCell.BorderBottom&&(i=this.columnInfo.TemplateCell.BorderBottom.Style),n.SpreadJSHelper.getBorderWidth(i)},t.prototype.getDefaultValueFromCellType=function(){var t=this.cellType.getDefaultValue(),i;return!n.Common.IsEmpty(t)&&typeof t.Value!="undefined"&&!(typeof t.Value=="string"&&t.Value.length>0&&t.Value[0]==="=")?t.Value:(i=this.cellType.cellTypeData,i instanceof n.InputCellTypeData)?i.getDefaultValue():null},t.prototype.getDefaultFormulaFromCellType=function(){var i,t=this.cellType.getDefaultValue();return!n.Common.IsEmpty(t)&&typeof t.Value=="string"&&t.Value.length>0&&t.Value[0]==="="?t.Value:(i=this.getTemplateCell())===null||i===void 0?void 0:i.DefaultFormula},t.prototype.getDefaultValue=function(t,i,r){var s=this.getTemplateCell(),u,f,e,o;return s?(u=null,f=this.getDefaultFormulaFromCellType(),n.Common.IsEmpty(f)?(u=this.getDefaultValueFromCellType(i),e=this.cellType.cellTypeData,e instanceof n.CheckBoxCellTypeData&&(u=u===!0||u===1?1:null)):(f=new n.CellFormulaTranslater(t,i,n.ListviewBase.getAllListviews([i])).translate(f),o={runTimePageName:t,supportReferToListview:!1,nullAsException:!1,listInfo:null,rowOffset:r,columnOffset:this.getColumnIndex(),isTranslatedFormula:!0},u=n.ForguncyData.pageInfo.formulaManager.evaluateFormula("="+f,o)),u instanceof Date&&(u=n.Convertor.fromDateToOADate(u)),u):null},t}();n.VisibleListviewColumnInfo=t;r=function(){function t(n,t,i){this._locationString=n;this._visibleColumn=t;this.pageName=i}return Object.defineProperty(t.prototype,"columnFilterQuery",{get:function(){var n;return(n=this.getCachedFilterInfo(this._visibleColumn,!1))!==null&&n!==void 0?n:this.createColumnFilterInfo(this.pageName)},enumerable:!1,configurable:!0}),t.prototype.getActualCompareType=function(n){return n.filterComapreType>99?0:n.filterComapreType},t.prototype.createColumnFilterInfo=function(n){var t;return{ColumnIndex:this._visibleColumn.getColumnIndex(),ColumnBindingInfoID:(t=this._visibleColumn.getFilterActualBindingInfo())===null||t===void 0?void 0:t.GUID,pageName:n,IsNotInMode:!1,Values:null,IsOrMode:!1,Conditions:null,filterComapreType:null}},t.prototype.clearColumnFilter=function(){var t=this,i=n.ForguncyData.pageInfo.columnFilterQueryCache[this._locationString];i&&(n.ForguncyData.pageInfo.columnFilterQueryCache[this._locationString]=i.filter(function(n){return!t.isFilterCacheMatch(n,t._visibleColumn)}))},t.prototype.clearColumnFilterConditions=function(){var n=this.getCachedFilterInfo(this._visibleColumn,!1);n&&(n.Conditions=null,n.filterComapreType=null,n.IsOrMode=!1)},t.prototype.clearColumnFilterValues=function(){var n=this.getCachedFilterInfo(this._visibleColumn,!1);n&&(n.Values=null,n.IsNotInMode=!1)},t.prototype.setBasicFilter=function(n,t){var i=this.getCachedFilterInfo(this._visibleColumn,!0);i.IsNotInMode=n;i.Values=t},t.prototype.setConditionFilter=function(n,t,i){var r=this.getCachedFilterInfo(this._visibleColumn,!0);r.filterComapreType=n;r.IsOrMode=t;r.Conditions=i},t.prototype.isColumnFilterValid=function(t){return!n.Common.IsEmpty(t.Values)||!n.Common.IsEmpty(t.Conditions)},t.prototype.getCachedFilterInfo=function(t,i){var u=n.ForguncyData.pageInfo.columnFilterQueryCache[this._locationString],f,e,r;if(!u)if(i)u=[],n.ForguncyData.pageInfo.columnFilterQueryCache[this._locationString]=u;else return null;for(f=0,e=u;f<e.length;f++)if(r=e[f],this.isFilterCacheMatch(r,t))return r;return i?(r=this.createColumnFilterInfo(this.pageName),u.push(r),r):null},t.prototype.isFilterCacheMatch=function(t,i){if(n.Common.IsEmpty(t.ColumnIndex)){var r=i.getFilterActualBindingInfo();return t.ColumnBindingInfoID===r.GUID}return t.ColumnIndex===i.getColumnIndex()},t}();n.ListviewColumnFilterHelper=r;var e=function(){function n(){}return n}(),o=function(){function n(){}return n}(),f=function(){function t(){}return t.save=function(t,i){var r=JSON.parse(localStorage.getItem(this.CollectionName)),u;t.Columns.forEach(function(n){var i,r,t=(r=(i=n===null||n===void 0?void 0:n.TemplateCell)===null||i===void 0?void 0:i.Element)===null||r===void 0?void 0:r.CellType;(t===null||t===void 0?void 0:t.haveLoadItems)===!0&&(t.haveLoadItems=!1);(t===null||t===void 0?void 0:t.hasInitItemsInfo)===!0&&(t.hasInitItemsInfo=!1)});(n.Common.IsEmpty(r)||r.version!==this.getPackageVersion())&&(r={items:[],version:this.getPackageVersion()});u=r.items.filter(function(n){return n.id===i});u.length>0?u[0].metadata=t:r.items.push({metadata:t,id:i});localStorage.setItem(this.CollectionName,JSON.stringify(r))},t.getPackageVersion=function(){return n.StaticData.IsDebugMode?n.StaticData.MetaDataVersion+n.StaticData.GlobalSettingVersion:n.StaticData.MetaDataVersion},t.isExist=function(n){var t=this.restoreFromLocalStorage(n);return t&&t.length>0},t.restore=function(n){var t=this.restoreFromLocalStorage(n);return t&&t.length>0?t[0].metadata:null},t.restoreFromLocalStorage=function(t){var i=JSON.parse(localStorage.getItem(this.CollectionName));return!n.Common.IsEmpty(i)&&i.version===this.getPackageVersion()?i.items.filter(function(n){return n.id===t}):null},t.clear=function(t){var i=JSON.parse(localStorage.getItem(this.CollectionName)),r,u;n.Common.IsEmpty(i)||i.version!==this.getPackageVersion()||(r=i.items.filter(function(n){return n.id===t}),r.length>0&&(u=i.items.indexOf(r[0]),i.items.splice(u,1)));localStorage.setItem(this.CollectionName,JSON.stringify(i))},t.resolve=function(n){n.OriginalColumns=__spreadArray([],n.Columns,!0);n.Columns.forEach(function(n,t){n.OriginalWidth=n.Width>0?n.Width:0;n.IsHiddenByLayout=n.Width>0?!1:!0;n.IsHiddenByColumnOptions=!1;n.IsHiddenByJavaScriptAPI=!1;n.Order=t})},t.CollectionName="FGC_ListviewMetadataCollection",t}();n.ListviewMetadataHelper=f})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var t=function(){function n(n,t,i,r){t===void 0&&(t=null);i===void 0&&(i=[]);r===void 0&&(r=-1);this.query=n;this.rowVersion=t;this.values=i;this.index=r}return n}(),i,r,u,f,e,o;n.CachedRowData=t;i=function(i){function r(t,r,u,f){var e=i.call(this)||this,o;return e._containerDiv=t,e.listviewData=r,e.runTimePageName=u,e.designerPageName=f,e.deletedRowQuerys=[],e._isLoading=!1,e.loadingIndicator=null,e.cover=null,e._displayInDocument=!1,e._masterValue=undefined,e.isFocused=!1,e._haveTriggerOnLostFocusMethod=!1,e._hasDestoryed=!1,e._protectListview=!1,e._locationString=null,e._isAllDataLoaded=!0,e.forceHideLoadingIndicator=!0,e._selectedRowsForEvent=[],e._waitValidateRows=[],e.cacheManager=new n.ListViewHelper.SelectionCacheManager(function(n){return e.getCachedRowData(n)}),e._isLoaded=!1,e.locatedPageID=n.ForguncyData.pageInfo.pageID,e.operationTypeWhenValueChanged=0,e._commitingRows=[],o=n.ForguncyData.pageInfo.dataModel,e._listData=o.addListData(e.getListviewName(),e.getCalcSheetName(),e.listviewData.getColumnCount(),e.runTimePageName),e._listData.bind("valuechanged",function(n,t){e._onValueChangedInDataModel(t)}),e.bindCurrentRowInfoAndPagingInfoChangedEvent(),e._initHeaderCellsValue(o),e._resolveAutoReload(),e}return __extends(r,i),Object.defineProperty(r.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dataVersion",{get:function(){return this._dataVersion},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"totalRowDataVersion",{get:function(){return this._totalRowDataVersion},enumerable:!1,configurable:!0}),r.prototype._resolveAutoReload=function(){var i=this,r,n,t;this.listviewData.getIsAutoReload()&&(r=this.listviewData.getAutoReloadInterval(),r>0&&(n=r*1e3,this._forceHideLoadingIndicator=!0,t=function(){i.hasDestroyed()||(i.isInCurrentPage()?i.fillData(null,!1,!1,function(){setTimeout(t,n)},function(){setTimeout(t,n)},function(){setTimeout(t,n)}):setTimeout(t,n))},setTimeout(t,n)))},r.prototype.resetListviewData=function(t){this.listviewData=t;this._listData.resetColumnCount(this.listviewData.getColumnCount());this._initHeaderCellsValue(n.ForguncyData.pageInfo.dataModel)},r.prototype.bindCurrentRowInfoAndPagingInfoChangedEvent=function(){var t=this;this._currentRowInfoChangedEventHandler=function(n,i){t.onCurrentRowInfoChanged(i)};n.ForguncyData.pageInfo.currentRowInfoCollection.bind("currentrowinfochanged",this._currentRowInfoChangedEventHandler);n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(this.listviewData.getDependenceCells(),function(){t.onDependenceCellValueChanged()},this.runTimePageName);n.Common.IsEmpty(n.ForguncyData.pageingInfoList)&&(n.ForguncyData.pageingInfoList=new n.PageingInfoList);this._pagingInfoChangedEventHandler=function(n,i){t._hasDestoryed||t.getLocationString()!==i.listviewLocation||t.fillData(null,!1,!0)};n.ForguncyData.pageingInfoList.bind("pageingInfoChanged",this._pagingInfoChangedEventHandler)},r.prototype._initHeaderCellsValue=function(t){for(var i,u,f,o=this.getHeaderCellIDSuffix(),s=this.listviewData.getAllHeaderCellContentElement(),r=0,e=s;r<e.length;r++)i=e[r],u=n.Common.convertMetaDataDefaultValue(i.Value,this.runTimePageName),u!==null&&(f=n.Common.getIdStr(i.Row,i.Column,o),n.ForguncyData.pageInfo.formulaManager.hasFormula(f)||t.normalCellDataModel.setValue(f,{newValue:u},1,i.IgnoreExport))},r.prototype.getHeaderCellIDSuffix=function(){return this.listviewData.isColumnHeaderVisibleInDesigner()?this.runTimePageName:this.listviewData.name},r.prototype.getListDataModel=function(){return this._listData},r.prototype.onDependenceCellValueChanged=function(){this.resetToFirstPage();this.fillData()},r.prototype.onLoad=function(){this._isLoaded=!0;this.listviewData.canDelete()&&this.createDeleteButton()},r.prototype.onWindowResized=function(n){n===void 0&&(n=!1)},r.prototype.getColumnTypeByIndex=function(n){return this.listviewData.getBindingInfoColumnTypeInDataModel(n)},r.prototype.getVisibleColumnIndexInListViewByDataIndex=function(n){var t,i;if(this.listviewData.visibleColumns&&n>-1&&n<this.listviewData.getColumnCount())for(t=0;t<this.listviewData.visibleColumns.length;t++)if(i=this.listviewData.visibleColumns[t],i&&i.getColumnIndex()===n)return t;return-1},r.prototype.isInCurrentPage=function(){return this.locatedPageID===n.ForguncyData.pageInfo.pageID},r.prototype.getCellTypeByColIndex=function(n){return this.listviewData.getColumnCellType(n,this.runTimePageName)},r.prototype.onCurrentRowInfoChanged=function(n){this.syncSelectionOfListviewsHaveSameDataTable(n);this.refreshDetailListviewData(n)},r.prototype.syncSelectionOfListviewsHaveSameDataTable=function(t){var r,i;if(t.isQueryChanged&&(t.change===0||t.change===1)){if(this.isGroupMode()||t.rowInfo.currentTable!==this.getDataTableName())return;if(r=t.rowInfo.query,!n.Common.isQueryEqual(this._listData.getRowQuery(this._listData.getCurrentRowIndex()),r)&&(i=this._listData.getRowIndexByQuery(r),i>=0&&i<this.getEditorRowCount())){this.onCurrentRowChanged(i,!1);this.selectInEditor(i);this.onSelectionChanged(!1)}}},r.prototype.refreshDetailListviewData=function(n){n.isQueryChanged&&this.getMasterDataTableName()===n.rowInfo.currentTable&&(n.change===2?this.clearData():this.fillData())},r.prototype._onValueChangedInDataModel=function(n){this.operationTypeWhenValueChanged!==1&&(this.triggerAPIValueChangedEvent([__assign({},n.cellRange)],n.newRowCount,n.oldRowCount),this.operationTypeWhenValueChanged!==2)&&this.updateSelectedRowsCache()},r.prototype.triggerAPIValueChangedEvent=function(t,i,r){var u=this;t.forEach(function(n){return n.Column=u.getMergedColIndexByDataColIndex(n.Column)});u.trigger(n.ListViewEvents.ValueChanged,{CellRanges:t,NewRowCount:i,OldRowCount:r})},r.prototype._onCellValueChanged=function(n,t,i,u){var s=this.listviewData.getColIndexByVisibleColIndex(t),f,h,c,e,o;if(s!==-1&&(this._listData.setValue(n,s,i,6,u),n===this.getCurrentRowIndex()&&(f=this.listviewData.getBindingInfo(s),f&&!f.RelationBinding)))for(h=r.getAllListviews(),c=h.length,e=0;e<c;e++)o=h[e],o.getMasterDataTableName()===this.getDataTableName()&&o.getColumnOfMasterTable()===f.ColumnName&&o.masterValueChanged(i)},r.prototype.setDataToSpreadJSNow=function(n,t){n===void 0&&(n=-1);t===void 0&&(t=-1)},r.prototype.triggerClickCommand=function(t,i){var r=i,o=n.Common.getIdStr(t,r,this.getCalcSheetName()),s=this._listData.getRowCount(),h=this._listData.getColumnCount(),f,u,e;return t<0||t>=s||r<0||r>=h?!1:(f=this.listviewData.visibleColumns[r],u=f.getClickCommandsMetaData(),!u||u.length===0)?!1:(e=this._listData.getCurrentRowIndex(),e!==t&&this.selectRow(t),n.ForguncyData.commandExcutor.excuteCommand(u,{runTimePageName:this.runTimePageName,commandTrigger:this,commandID:o,eventType:"click",locationString:n.FormulaHelper.getListviewCellLogLocationString(t,r,f.getName(),this.getListviewName(),this.runTimePageName)}),!0)},r.prototype.shouldCancelCommand=function(){return!1},r.prototype.masterValueChanged=function(n){var i=this.listviewData.getColIndexOfColumnOfDetailTable(),r,t;if(this.listviewData.canEdit()&&i!==-1&&this._masterValue!==n)for(r=this._listData.getRowCount(),t=0;t<r;t++)this._listData.setValue(t,i,n,7)},r.prototype.getRowInfo=function(t){var i=new n.CurrentRowInfo,r;return i.currentTable=this.getDataTableName(),i.viewname=this.getFullListviewName(),i.listviewLocation=this.getLocationString(),i.viewCondtionFormulaValues=this.GetQueryConditionFormulaValues(),i.masterTableQuery=this.getMasterQuery(),n.Common.IsEmpty(t)&&(t=this._listData.getCurrentRowIndex()),r=this._listData.getRowCount(),t!==undefined&&t<r&&(i.selectedRowIndex=t,i.recordID=this.getRecordID(t),i.query=this._listData.getRowQuery(t)),i},r.prototype.getRowVersion=function(n){return this._listData.getRowInfo(n).rowVersion},r.prototype.getRecordID=function(t){var r=n.ForguncyData.pageingInfoList.GetPageIndex(this.getLocationString()),i;return r=this.isInvalidNumber(r)?0:r-1,i=n.ForguncyData.pageingInfoList.GetLimit(this.getLocationString()),i=this.isInvalidNumber(i)?0:i,r*i+t},r.prototype.isInvalidNumber=function(n){return typeof n!="number"||isNaN(n)||n<=0},r.prototype.getDataTableName=function(){return this.listviewData.getDataTableName()},r.prototype.getMasterDataTableName=function(){return this.listviewData.getMasterDataTableName()},r.prototype.getColumnOfMasterTable=function(){return this.listviewData.getColumnOfMasterTable()},r.prototype.getColumnOfDetailTable=function(){return this.listviewData.getColumnOfDetailTable()},r.prototype.getMasterQuery=function(){var i=this.getMasterDataTableName(),t;if(i&&(t=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(i),t))return t.query},r.prototype.allowLoadOnDemand=function(){return this.listviewData.shouldLoadOnDemand()?n.ForguncyData.pageingInfoList&&n.ForguncyData.pageingInfoList.IsPageing(this.getLocationString())?!1:this._isAllDataLoaded?!1:!0:!1},r.prototype.loadOnDemand=function(){if(this._isLoading!==!0&&this.allowLoadOnDemand()){this._isLoading=!0;this.showLoadingIndicator();var t=this;n.DelayRefresh.setTimeout(function(){t.hasDestroyed()||n.ListViewHelper.RequestHelper.queryDataFromServer(t,!0)},100)}},r.prototype.showLoadingIndicator=function(t){var i;if(t===void 0&&(t=!0),this._displayInDocument){if(this.loadingIndicator===null){if(i=this.getContainerDiv(),!i||i.length===0)return;var u=999,f=17,r=this.getColHeaderHeight();this.listviewData.getColumnOperation()!==1&&(r=0);this.cover=n.Common.getCover("transparent",1).css("position","absolute").css("width","100%").css("height","calc(100% - ".concat(r,"px)")).css("left","0").css("top",r+"px").css("zIndex",u).appendTo(i);this.loadingIndicator=$("<img class='loading-indicator'><\/img>").attr("src",n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/loading.gif").css("position","absolute").css("width",f).css("height",f).css("left","50%").css("top","50%").css("transform","translate(-50%, -50%)").css("zIndex",u).appendTo(i)}this.protectListview(!0);this.cover.show();!this._forceHideLoadingIndicator&&t&&this.loadingIndicator.show();this.hideDeleteButton()}},r.prototype.hiddenLoadingIndicator=function(n){n===void 0&&(n=!1);this.loadingIndicator&&(this.cover.hide(),this.loadingIndicator.hide(),this.protectListview(!1))},r.prototype.getColHeaderHeight=function(){return 0},r.prototype.protectListview=function(n){this._protectListview=n},r.prototype.isProtected=function(){return this._protectListview},r.prototype.needQueryData=function(){if(!this.getDataTableName()||this.listviewData.columnBindingInfos.length===0)return!1;if(!this.isMasterTable()){var n=this.getMasterQuery();if(!n)return!1}return!0},r.prototype._setInitData=function(t,i){var r,f=this._listData.getCurrentRowIndex(),u;this.clearTemporaryThings();this._listData.indexFlag=0;this._isAllDataLoaded=((r=t===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0)>=i;this._listData.setData(t);this._commitingRows=[];this.dataCache=null;this._isAllDataLoaded&&(u=n.FormulaColumnSortFilterHelper.getFilteredAndSortData(this),u!==this.dataCache&&this._listData.setData(u));this.onDataLoaded();this.initSelectionAfterInitData(f);this.trigger(n.ListViewEvents.Reloaded,{})},r.prototype.initSelectionAfterInitData=function(n){this.getEditorRowCount()>0?this.selectRowAfterInitData(n):this.isGroupMode()||this.clearCurrentRow()},r.prototype.onDataLoaded=function(){},r.prototype.allowShowTotalRow=function(){return this.listviewData.allowShowTotalRow()},r.prototype.allowAddRow=function(){return this.listviewData.canAddRow()&&!this.allowLoadOnDemand()?!0:!1},r.prototype.allowInsertRow=function(){return this.listviewData.canEdit()&&!this.allowLoadOnDemand()?!0:!1},r.prototype.allowDuplicateRow=function(){var t,n;return this.listviewData.canEdit()&&!this.allowLoadOnDemand()?(t=this.listviewData.getDataCommitMode(),t===0&&(n=this.getSelectedRowsIndexes(),n&&n.length>1))?!1:!0:!1},r.prototype.addData=function(n,t){var i;n!==[]&&(this._isAllDataLoaded=this.getListDataCount()+((i=n===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0)>=t,this._listData.addData(n,2),this.dataCache=null,this.onDataLoaded(),this._isLoading=!1)},r.prototype.selectRowAfterInitData=function(t){var e=this.getEditorRowCount(),f,i,r,u;if(!(e<=0)){if(f=this._listData.getRowCount(),i=-1,this.isGroupMode())i=n.Common.IsEmpty(t)?-1:t;else if(r=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(this.getDataTableName()),r){if(r.query)for(u=0;u<f;u++)if(n.Common.isQueryEqual(this._listData.getRowInfo(u).query,r.query)){i=u;break}i!==-1||n.Common.IsEmpty(r.selectedRowIndex)||(i=Number(r.selectedRowIndex))}i=Math.min(f-1,i);i=Math.max(0,i);this.onCurrentRowChanged(i)}},r.prototype.selectRow=function(n){if(n>=0&&n<this.getEditorRowCount()&&n!==this.getCurrentRowIndex()){this.selectInEditor(n);this.onCurrentRowChanged(n)}},r.prototype.selectCell=function(n,t){if(n>=0&&n<this.getEditorRowCount()&&t>=0&&(this.selectInEditor(n,t),n!==this.getCurrentRowIndex()))this.onCurrentRowChanged(n)},r.prototype.selectInEditor=function(){},r.prototype.isMasterTable=function(){return this.listviewData.isMasterTable()},r.prototype.commitChangeRealTime=function(n,t){if(n<0||!t)return!1;var i=this._listData.getRowQuery(n);return i?!0:t==="add"&&(this.isMasterTable()||!!this.getMasterQuery())},r.prototype.getEditorInfo=function(t){t===void 0&&(t=!1);var i=this,r=i.getEditorDataInfos(t);r&&r.length!==0&&(i.showLoadingIndicator(),n.HomeController.GetEditorInfo(r,function(r){(r&&r.errorMessage&&alert(r.errorMessage),i.hasDestroyed())||(r&&r.editor&&i.setEditorDataInfos(r.editor,t),n.DelayRefresh.Push(i,function(){i.hasDestroyed()||i.hiddenLoadingIndicator()},i.getCalcSheetName()+"hiddenLoadingIndicator"))},this.getCalcSheetName()))},r.prototype.fillData=function(t,i,r,u,f,e){var o=this;(t===void 0&&(t=null),i===void 0&&(i=!1),r===void 0&&(r=!1),u===void 0&&(u=null),f===void 0&&(f=null),e===void 0&&(e=null),this.hasDestroyed())||n.ForguncyData.pageingInfoList.RefeshRowCount(this.getLocationString(),function(){n.ListViewHelper.RequestHelper.queryDataFromServer(o,!1,t,i,r,u,f,e)})},r.prototype.beforeRefeshUIWhenQueryDataFromServer=function(){},r.prototype.updateSelectedRowsCache=function(){this.getAlwaysReservedSelections()&&this.cacheManager.update(this.getSelectedRowsIndexes())},r.prototype.updateSelectedRowsBeforeDeleteRow=function(n){this.getAlwaysReservedSelections()&&this.cacheManager.delete(n)},r.prototype.updateSelectedRowsAfterDeleteRow=function(){},r.prototype.getTotalRowSettingsIgnoreNullValues=function(){return this.listviewData.getTotalRowSettingsIgnoreNullValues()},r.prototype.getTotalRowBindingInfosIgnoreNullValues=function(){return this.listviewData.getTotalRowBindingInfosIgnoreNullValues()},r.prototype.resetToFirstPage=function(){var t=this.getLocationString();n.ForguncyData.pageingInfoList.ResetPageIndexToFirstPage(t)},r.prototype.GetQueryConditionFormulaValues=function(){var r=this.listviewData.getConditionFormulas(),u,t,f,e,i;if(r&&r.length!==0){for(u={},t=0,f=r;t<f.length;t++)e=f[t],n.FormulaManager.isReady()&&(i=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(e,{runTimePageName:this.runTimePageName,supportReferToListview:!1,nullAsException:!0,listInfo:null,rowOffset:0,columnOffset:0}),u[e]=i instanceof GC.Spread.CalcEngine.CalcError?i.toString():i);return u}},r.prototype.rollbackBindingValue=function(n){for(var i,r,u=this.listviewData.getColumnCount(),t=0;t<u;t++)i=this.listviewData.columnDataInfos[t],i.bindingInfoIndex!==-1&&(r=this._listData.getBindingValue(n,t),this._listData.setValue(n,t,r,2))},r.prototype.reloadItemsEditor=function(t){var s=this,f,e,o,i,h,r,u;if(t&&(t=t.toLowerCase()),i=this.listviewData.visibleColumns,i)for(h=function(u){var c=i[u].getTemplateCell(),h;if(!c||(h=c.CellType,!h||!h.IsBounding||!h.DataSource)||t&&h.DataSource.toLowerCase()!==t||n.Common.typeContains(h,"DropDownListCellType"))return"continue";var l={tableName:h.DataSource,valueColumnBindingInfo:(f=h.ValueColumnBindingInfo)===null||f===void 0?void 0:f.GUID,displayColumnBindingInfo:(e=h.DisplayColumnBindingInfo)===null||e===void 0?void 0:e.GUID,dropDownSubItems:(o=h.DropDownSubItems)===null||o===void 0?void 0:o.map(function(n){var t;return __assign(__assign({},n),{BindingInfo:(t=n.BindingInfo)===null||t===void 0?void 0:t.GUID})}),itemQuery:n.ConditionHelper.getComputedSqlConditionFormula(h.ItemsQuery,r.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull),itemSort:h.ItemsSort,pageName:r.designerPageName},a=r.getCalcSheetName()+u;n.Common.forguncyPost("Home/GetComboBindingOptions",l,function(t){t||(t={Items:[]});h.ItemsInfo=t;n.ItemsCellTypeHelper.initItemsOfItemsCell(c,h.ItemsInfo,h);h.haveLoadItems=!0;h.hasInitItemsInfo=!1;h.initItemsInfoCallback=function(){s.autoFit()};s.refreshUI()},"GetComboBindingOptions "+a)},r=this,u=0;u<i.length;u++)h(u)},r.prototype.autoFit=function(){},r.prototype.getEditorDataInfos=function(n){for(var o,t,i,r,s=this.getBoundingItemsElementsWithItemsCellType(n),u=[],f=0,e=s;f<e.length;f++)o=e[f],t=o.CellType,u.push({tableName:t.DataSource,pageName:this.designerPageName,valueColumnBindingInfo:(i=t.ValueColumnBindingInfo)===null||i===void 0?void 0:i.GUID,displayColumnBindingInfo:(r=t.DisplayColumnBindingInfo)===null||r===void 0?void 0:r.GUID,itemSort:t.ItemsSort});return u.length===0?null:u},r.prototype.setEditorDataInfos=function(t,i){for(var r,f,o=this,e=this.getBoundingItemsElementsWithItemsCellType(i),u=0;u<e.length;u++)r=e[u].CellType,f=t[u],n.Common.IsEmpty(f)&&(f={Items:[]}),r.ItemsInfo=f,n.ItemsCellTypeHelper.initItemsOfItemsCell(e[u],r.ItemsInfo,r),r.haveLoadItems=!0,r.hasInitItemsInfo=!1,r.initItemsInfoCallback=function(){o.autoFit()}},r.prototype.getBoundingItemsElementsWithItemsCellType=function(n){var f=[],e=this.listviewData.visibleColumns,i,u,o,r,t;if(e)for(i=0,u=e;i<u.length;i++)if(o=u[i],r=o.getTemplateCell(),r){if(t=r.CellType,t&&t.$type==="Forguncy.DropDownListCellType, ServerDesignerCommon")continue;if(!t||!t.IsBounding)continue;if(!n&&t.haveLoadItems)continue;t.DataSource&&(t.ValueColumnBindingInfo||t.DisplayColumnBindingInfo)&&f.push(r)}return f},r.prototype.getUserSelectorCellTypes=function(){var t=[],n=this.listviewData.visibleColumns;return n===null||n===void 0?void 0:n.forEach(function(n){var r=n.getTemplateCell(),i;r&&(i=r.CellType,i&&i.$type==="Forguncy.UserCellType, ServerDesignerCommon"&&t.push(i))}),t},r.prototype.clearCurrentRow=function(){n.ForguncyData.pageInfo.currentRowInfoCollection.removeCurrentRowInfo(this.getDataTableName())},r.prototype.createDeleteButton=function(){var t=this;this.listviewData.canDelete()&&(this._deleteButton=new n.ListviewDeleteButton(this.getContainerDiv()),this._deleteButton.bind("click",function(){return t.deleteOnUIClick(!1)}))},r.prototype._showDeleteButton=function(){var n,t,i;if(this._deleteButton&&!this.isProtected()){if(n=this._listData.getCurrentRowIndex(),this.isFocused&&n!==undefined&&n>=0&&(t=this._listData.getRowCount(),t>0&&n<t&&(i=this.getCurrentRowCenterY(),i!==-1))){this._deleteButton.show(i);return}this.hideDeleteButton()}},r.prototype.getCurrentRowCenterY=function(){return 0},r.prototype.hideDeleteButton=function(){this._deleteButton&&this._deleteButton.hide()},r.prototype.clearData=function(){this._isAllDataLoaded=!0;this.dataCache=null;this.clearTotalRow();this._listData.clear();this.clearTemporaryThings();this.clearCurrentRow();this.updateDataVersion();this.updateTotalRowDataVersion()},r.prototype.clearTemporaryThings=function(){this._listData.select();this._masterValue=undefined;this.hideDeleteButton()},r.prototype.clearTotalRow=function(){if(this.listviewData.allowShowTotalRow()){var n=this.listviewData.getTotalRowSettingsIgnoreNullValues().filter(function(n){return n.BindingInfo});n.forEach(function(n){n.Value=n.FormulaType===2?0:""})}},r.prototype.updateDataVersion=function(){this._dataVersion=n.Common.getUniqueNumber()},r.prototype.updateTotalRowDataVersion=function(){this._totalRowDataVersion=n.Common.getUniqueNumber()},r.prototype.insertRowBySelection=function(n){var t=this.getSelectedRowsIndexes(),i;!t||t.length<=0||(t.sort(function(n,t){return n-t}),i=t[0],this.insertRow(i,t.length,null,!0,n))},r.prototype.duplicateRowBySelection=function(n){var u=this,t=this.getSelectedRowsIndexes(),i,r;!t||t.length<=0||(t.sort(function(n,t){return n-t}),i=t.slice(-1)[0]+1,r=[],t.forEach(function(n){r.push(u.getDuplicateRowData(n))}),this._listData.insertData(i,r,7,n,!1),this._listData.select(i))},r.prototype.addNewRow=function(t,i,r,u){var e,f;for(u===void 0&&(u=7),this._listData.addData([this.getNewRowData(!1,i)],u,r),e=this._listData.getRowCount()-1,f=0;f<t.length;f++)t[f]!==undefined&&this._listData.setValue(e,f,t[f],u,r);n.Common.IsEmpty(this._listData.getCurrentRowIndex())&&this.selectRow(0)},r.prototype.addNewRowWithText=function(n,t){this.changeTextToValue(n);this.addNewRow(n,!1,t)},r.prototype.duplicateRow=function(n,t,i,r){var u=this,f=t.map(function(n){return u.getDuplicateRowData(n)});this.updateAndInsertRows(n,f,i,r)},r.prototype.insertRow=function(n,t,i,r,u){for(var o,f=[],e=0;e<t;e++)o=this.getNewRowData(!0,r),f.push(o);this.updateAndInsertRows(n,f,i,u)},r.prototype.updateAndInsertRows=function(t,i,r,u){var e,s,f,o;if(i&&i.length!==0){if(r)for(e=0;e<i.length;e++)for(s=i[e],f=0;f<r.length;f++)r[f]!==undefined&&(o=new n.ListDataValue,o.value=r[f],o.valueType=7,s.data[f]=o);this._listData.insertData(t,i,7,u,!0);this.updateSelectedRowsAfterInsertRows()}},r.prototype.updateSelectedRowsAfterInsertRows=function(){},r.prototype.insertRowWithText=function(n,t){this.changeTextToValue(t);this.insertRow(n,1,t,!1,!1)},r.prototype.changeTextToValue=function(n){for(var t in n)try{n[t]=this.validateValue(parseInt(t),n[t],!0)}catch(i){if(this.GetDataValidationTime()===0)throw i;}},r.prototype.setCellText=function(n,t,i,r){var u=i;try{u=this.validateValue(t,i,!0,!1,n)}catch(f){if(this.GetDataValidationTime()===0)throw f;}this._listData.setValue(n,t,u,7,r)},r.prototype.validateValue=function(t,i,r,u,f){var s,c,l,v,y;u===void 0&&(u=!1);f===void 0&&(f=-1);var a=i,h,o=this.getCellTypeByColIndex(t),e="";if(!n.Common.IsEmpty(i))if(o&&r&&(i=o.getValueFromListviewText(i,u)),i instanceof n.WrongParseResult&&(h=i,i=a),s=this.getColumnTypeByIndex(t),s===n.ColumnDataType.Date||s===n.ColumnDataType.Time)try{typeof i=="string"&&(i=o?o.getValueFromListviewText(i):n.FormatHelper.getValueFromText(i));i instanceof Date&&(i=n.ConvertDateToOADate(i));n.DateHelper.isValidDateValue(i)||(e=n.RS.ListViewAddNewRowError_CantConvertToDateTime)}catch(p){e=p}else s===n.ColumnDataType.Number?(i=Number(i),isNaN(i)&&(e=n.RS.ListViewAddNewRowError_CantConvertToNumber)):s===n.ColumnDataType.Bool&&(i===1||i==="1"||i===!0||(i+"").toLowerCase()==="true"?i=1:i===0||i==="0"||i===!1||(i+"").toLowerCase()==="false"?i=0:e=n.RS.ListViewAddNewRowError_CantConvertToBool);if(!n.Common.IsEmpty(e)&&h&&(i=h,e=""),o&&(c={},c[this.getCalcSheetName()]=f===-1?this.getListDataCount():f,l=o.validateValue(i,c,u),n.Common.IsEmpty(l)||(e=l)),!n.Common.IsEmpty(e)){v=this.getMergedColIndexByDataColIndex(t);y={message:e,Message:e,CellValue:a,ColumnIndex:v};throw y;}return i},r.prototype.getListDataCount=function(){return this._listData.getRowCount()},r.prototype.getNewRowData=function(t,i){var u=i?this.getRowDataWithDefaultValue():[],f=this.listviewData.getColIndexOfColumnOfDetailTable(),e,r;return f!==-1&&(this._masterValue===undefined&&(this._masterValue=this._getMasterValueForDetailTable()),u[f]=this._masterValue),e=u.map(function(t){var i=new n.ListDataValue;return i.value=t,i.valueType=7,i}),r=new n.ListRowData,r.data=e,r.isInsertRow=t,this._setStaticValueToListRowDatas(r),r},r.prototype.getRowDataWithDefaultValue=function(){for(var t,r,u,f=[],e=this._listData.getRowCount(),o=this.listviewData.visibleColumns.length,i=0;i<o;i++)(t=this.listviewData.visibleColumns[i],t)&&(r=t.getColumnIndex(),r!==-1)&&(u=t.getDefaultValue(this.getCalcSheetName(),this.runTimePageName,e),n.Common.IsEmpty(u)||(f[r]=u));return f},r.prototype.getDuplicateRowData=function(t){var r=this._listData.getRowData(t),i=new n.ListRowData;return i.data=n.Common.clone(r.data),i.data.forEach(function(t){t&&t.valueType===2&&!n.Common.IsEmpty(t.bindingValue)&&(t.value=t.bindingValue,t.bindingValue=undefined,t.valueType=7)}),i.isInsertRow=!0,i},r.prototype._setStaticValueToListRowDatas=function(t){for(var u,r,f=this.listviewData.getColumnCount(),i=0;i<f;i++)(u=this.listviewData.getStaticValue(i),u!==null)&&(r=new n.ListDataValue,r.value=u,r.valueType=1,t.data[i]=r)},r.prototype.deleteRow=function(t,i){var r,u,f,e;if(t===undefined||t===null){if(r=this._listData.getCurrentRowIndex(),n.Common.IsEmpty(r))return n.CommandResult.stop;t=r}return(u=this.getActualDataLength(),t<0||u<=0||t>=u)?n.CommandResult.stop:(f=this._listData.getRowInfo(t),f&&i)?n.CommandResult.stop:(this.hideDeleteButton(),this.updateSelectedRowsBeforeDeleteRow(t),this._listData.deleteRow(t),e=this._listData.getCurrentRowIndex(),this.updateCurrentRowAfterDeleteRow(t,!0),this.updateSelectedRowsAfterDeleteRow(t,e),this.refreshUI(),n.CommandResult.completed)},r.prototype.deleteRowInDataModel=function(n){n>=0&&n<this._listData.getRowCount()&&(this._listData.deleteRow(n),this.updateCurrentRowAfterDeleteRow(n,!1))},r.prototype.updateCurrentRowAfterDeleteRow=function(n,t){var i=this._listData.getCurrentRowIndex(),r;if(this._listData.select(),r=this._listData.getRowCount()+(this.allowAddRow()?1:0),r>0){i>n&&(i=i-1);i=Math.min(r-1,Math.max(0,i));t&&this.allowAddRow()&&r>1&&i===r-1&&(i=r-2);this.onCurrentRowChanged(i)}},r.prototype.handleAfterUpdateDataChange=function(t,i,u){var a,e,s,h,o,l,c,f;if(this._commitingRows.indexOf(t)!==-1){if(u.Success){if(i==="delete")this.deleteRow(t,!1);else if(e=u.RowData,e){for(this.getRowVersionColumnNameInServerData()&&(s=void 0,e.RowVersionInfo&&e.RowVersionInfo.RowVersion&&(s=e.RowVersionInfo.RowVersion),this._listData.setRowVersion(t,s)),h=e.Values,o=0;o<h.length;o++)for(l=h[o],c=this.listviewData.getColumnCount(),f=0;f<c;f++)this.listviewData.columnDataInfos[f].bindingInfoIndex===o&&this._listData.setValue(t,f,l,2);this._listData.setRowQuery(t,u.JustInsertedRowInfo.query?u.JustInsertedRowInfo.query:null);t===this.getCurrentRowIndex()&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(this.getRowInfo(),!0);i==="add"&&this.updateSelectedRowsCache()}else if(i==="edit")for(c=this.listviewData.getColumnCount(),f=0;f<c;f++)this.listviewData.columnDataInfos[f].bindingInfoIndex!==-1&&this._listData.setValue(t,f,this._listData.getValue(t,f),2);else if(i==="add"){this.fillData();return}i==="add"&&this.getCurrentRowIndex()===this.getActualDataLength()&&(a=r.getDetailListviews(this.getDataTableName()),a===null||a===void 0?void 0:a.forEach(function(n){return n.clearData()}))}else if(u.Message&&alert(u.Message),u.ConcurrentError){if(e=u.RowData,e)for(this.getRowVersionColumnNameInServerData()&&(s=void 0,e.RowVersionInfo&&e.RowVersionInfo.RowVersion&&(s=e.RowVersionInfo.RowVersion),this._listData.setRowVersion(t,s)),h=e.Values,o=0;o<h.length;o++)for(l=h[o],c=this.listviewData.getColumnCount(),f=0;f<c;f++)this.listviewData.columnDataInfos[f].bindingInfoIndex===o&&this._listData.setValue(t,f,l,2)}else i==="edit"?this.rollbackBindingValue(t):i==="add"&&this.deleteRowInDataModel(t);this.removeFromCommitingRow(t);this.refreshUI()}},r.prototype.removeFromCommitingRow=function(n){var t=this._commitingRows.indexOf(n);t>=0&&this._commitingRows.splice(t,1)},r.prototype.pushToCommitingRow=function(n){var t=this._commitingRows.indexOf(n);t===-1&&this._commitingRows.push(n)},r.prototype.hasCommitingRow=function(){return this._commitingRows.length>0},r.prototype.refreshOtherListViewsBindingToSameTable=function(){var u=r.getAllListviews(),i=this,t=i.getDataTableName();u.forEach(function(n){n!==i&&n.getDataTableName()===t&&n.fillData()});n.NormalCellBindingManager.updateTableDataCacheForCombo(t,!0);n.clearGetTableDataByConditionCache();n.NormalCellBindingManager.reloadItemsCellType(t,!1,!0);n.CustomFunction.ODataFunction.clearCache(t)},r.prototype.onSelectionChanged=function(n){n===void 0&&(n=!0)},r.prototype.triggerSelectedRowsChangedEvent=function(){var t=this.getSelectedRowsIndexes();this.isSelectedRowsEqual(this._selectedRowsForEvent,t)||(this._selectedRowsForEvent=t,this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{}))},r.prototype.isSelectedRowsEqual=function(n,t){if(n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0},r.prototype.delayTriggerEvent=function(t,i){var r=this;n.DelayRefresh.Push(r,function(){r.hasDestroyed()||r.trigger(t,i)},t+r.getCalcSheetName())},r.prototype.onCurrentRowChanged=function(t,i){var f,u,e,o,r;if((i===void 0&&(i=!0),u=this._listData.getCurrentRowIndex(),t===undefined||t!==u)&&(e=this.commitEditChange(),e!=="cancel")){if(this._listData.select(t),((f=this.listviewData.metadata.CurrentRowChangedCommands)===null||f===void 0?void 0:f.length)>0&&n.ForguncyData.commandExcutor.excuteCommand(this.listviewData.metadata.CurrentRowChangedCommands,{runTimePageName:this.runTimePageName,commandTrigger:this,commandID:this.getListviewName(),eventType:"currentrowinfochanged",locationString:n.FormulaHelper.getListviewCellLogLocationString(t,null,null,this.getListviewName(),this.runTimePageName)}),this.isGroupMode()){this.triggerSelectionChangedEvent(u,t);return}o=this.getActualDataLength();t!==undefined&&(t<o?this._showDeleteButton():this.hideDeleteButton());t!==undefined&&i&&(r=this.getRowInfo(),r&&r.currentTable&&r.query?n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(r,!0):this.clearCurrentRow());this.triggerSelectionChangedEvent(u,t)}},r.prototype.triggerSelectionChangedEvent=function(n,t){this.trigger("selectionchanged",{oldSelectedRowIndex:n===undefined?-1:n,newSelectedRowIndex:t===undefined?-1:t})},r.prototype.getRowVersionColumnNameInServerData=function(){return"C"+this.listviewData.columnBindingInfos.length},r.prototype.needCommit=function(n,t){if(!this.getDataTableName()||(typeof n=="undefined"&&(n=this._listData.getCurrentRowIndex()),n===undefined||this._commitingRows.indexOf(n)>=0))return!1;var i=this.getActualDataLength();return n<0||i<=0||n>=i?!1:t||this._listData.isDirty(n,-1)||this.GetDataCommitMode()!==0&&this.deletedRowQuerys.length>0||this.isDetailTableEdited()},r.prototype.deleteRowByJavascriptAPI=function(n){var t=this._listData.getRowInfo(n),i=t?t.query:null;i&&this.deletedRowQuerys.push(i);this.deleteRow(n,!1)},r.prototype.deleteOnUIClick=function(t){var i=this,f,l=this.stopEditingActiveCell(),r,e,o,c;if(l&&(r=[],r=t?(f=this.getSelectedRowsIndexes())===null||f===void 0?void 0:f.sort(function(n,t){return t-n}):[this._listData.getCurrentRowIndex()],!n.Common.IsEmpty(r)&&!(r.length<=0))){var s=this.isMasterTable(),u=[],h=[];(r.forEach(function(t){var f=i._listData.getRowInfo(t),r;if(i.needCommit(t,!0)){if(r=f?f.query:null,n.Common.IsEmpty(r)){i.deleteRow(t,!0);return}if(i.GetDataCommitMode()!==0){r&&i.deletedRowQuerys.push(r);i.deleteRow(t,!1);return}u.push(t);h.push(r)}}),u.length!==0)&&(e={ActualShowConfirm:!0,currentTable:this.getDataTableName(),querys:h,rowIndexes:u,UpdateType:"delete",columnBindingInfos:[{pageName:this.listviewData.designerPageName,bindingInfos:this.listviewData.columnBindingInfos.map(function(n){return n.GUID})}],viewName:s?null:this.getFullListviewName(),masterQuery:s?null:this.getMasterQuery(),ConfirmText:n.RS.ConfirmDelete,CheckDataValidation:!1,ReloadAfterSucceed:!0},o=new n.UpdateDataTableCommand,o.CommandParam=e,c=o.UpdateDataTableCommand(e,null,this,function(){t&&i.clearAllSelectedRows();n.ListViewHelper.RequestHelper.queryTotalRowValues(i)}),c===n.CommandResult.completed&&u.forEach(function(n){return i.pushToCommitingRow(n)}))}},r.prototype.updateDataChange=function(t){var s=this,i,u,r;if(n.Common.IsEmpty(t))return n.CommandResult.completed;if(i=this._listData.getRowInfo(t),this.needCommit(t,!1)){if(u=i?i.query:null,this.GetDataCommitMode()!==0)return n.CommandResult.completed;var f=this.isMasterTable(),e={ActualShowConfirm:!1,currentTable:this.getDataTableName(),querys:[u],rowIndexes:[t],UpdateType:i?"edit":"add",rowVersion:i?i.rowVersion:null,columnBindingInfos:[{pageName:this.listviewData.designerPageName,bindingInfos:this.listviewData.columnBindingInfos.map(function(n){return n.GUID})}],viewName:f?null:this.getFullListviewName(),masterQuery:f?null:this.getMasterQuery(),ConfirmText:null,CheckDataValidation:!1,ReloadAfterSucceed:!0},o=new n.UpdateDataTableCommand;return o.CommandParam=e,r=o.UpdateDataTableCommand(e,null,this,function(){n.ListViewHelper.RequestHelper.queryTotalRowValues(s)}),r===n.CommandResult.completed&&this.pushToCommitingRow(t),r}return n.CommandResult.completed},r.prototype.commitEditChange=function(t){var r,i,e,o,f,s,u,h;if((t===void 0&&(t=!1),this.isGroupMode())||(r=this._listData.getCurrentRowIndex(),r===undefined||r===-1)||t===!1&&!this.listviewData.canEdit()||this._commitingRows.indexOf(r)!==-1||(i=r,e=this._listData.getRowCount(),i>=e))return n.CommandResult.completed;if(o=this.validateRow(i),!o)return"cancel";for(f=!1,s=this.listviewData.getColumnCount(),u=0;u<s;u++)if((h=this.listviewData.getBindingInfo(u),!n.Common.cannotEditedBindingInfo(h))&&this._listData.isDirty(i,u)){f=!0;break}return!f&&!this.isDetailTableEdited()?n.CommandResult.completed:this.commitChangeRealTime(i,this._listData.getRowInfo(i)?"edit":"add")?this.updateDataChange(i):n.CommandResult.completed},r.prototype.checkCalcError=function(t){var u=this.listviewData.visibleColumns,i,f,r,e;if(!u)return-1;for(i=u.length-1;i>=0;i--)if((f=u[i],r=f.getBindingInfo(),r&&!r.RelationBinding)&&(e=this._listData.getValue(t,f.getColumnIndex()),e instanceof GC.Spread.CalcEngine.CalcError))return alert(n.Common.format(n.RS.InvalidValueErrorMessage,e.toString(),r.ColumnName,r.TableName)),i;return-1},r.prototype._validateRequired=function(t){var f=this.listviewData.visibleColumns,e,s,r,i,o,u,h;if(!f)return-1;for(e={},e[this.getCalcSheetName()]=t,s=f.length,r=0;r<s;r++)if(i=f[r],i.canEnterEditMode){if(i.cellType.constructor===n.CheckBoxCellType)continue;if(o=this._listData.getValue(t,i.getColumnIndex()),!n.Common.IsEmpty(o))continue;if(u=i.getTemplateCell(),!u||!u.DataValidation||u.DataValidation.IgnoreBlank)continue;if(h=n.ValidationMananger.validateDataValidation(u,o,this.runTimePageName,e),!n.Common.IsEmpty(h))return i.needValidateWhenShowEditor=!0,r}return-1},r.prototype._editAndValidateCellWithDelayRefresh=function(t,i,r){var u=this;r===void 0&&(r=null);this._waitValidateRows.indexOf(t)===-1&&this._waitValidateRows.push(t);n.DelayRefresh.NeedDelayRun?n.DelayRefresh.setTimeout(function(){!u.hasDestroyed()&&u.isInCurrentPage()&&u.editAndValidateCell(t,i,r)},100):this.editAndValidateCell(t,i,r)},r.prototype.editAndValidateCell=function(n,t,i){i===void 0&&(i=null)},r.prototype.getAllowEditedBindingInfo=function(t){var r=this.listviewData.columnBindingInfos,f=this.listviewData.columnDataInfos,i,u;return!f||!r?null:(i=f[t],i.bindingInfoIndex>=r.length||i.bindingInfoIndex<0)?null:(u=r[i.bindingInfoIndex],n.Common.cannotEditedBindingInfo(u))?null:u},r.prototype.buildEditedRowValue=function(n,t,i,r){var f=this.listviewData.columnDataInfos,u,l,a;if(!f)return null;var o={},s=[],h={},c=!1,e=-1,v=f.length;for(u=0;u<v;u++)(l=this.getAllowEditedBindingInfo(u),l)&&(r===1&&!f[u].columnName||r!==1&&f[u].bindingInfoIndex<0||(e===-1&&(e=u),(t||this._listData.isDirty(n,u))&&(c=!0,a=this._listData.getValue(n,u),this.addEditValue(o,s,h,r,f[u],a))));if(!c){var y=i||this._listData.getRowInfo(n)===undefined,p=this._listData.getRowData(n),w=p.isInsertRow;if(y&&!w&&e>=0)this.addEditValue(o,s,h,r,f[e],null);else return null}switch(r){case 1:return o;case 0:return h;case 2:return s}},r.prototype.addEditValue=function(n,t,i,r,u,f){switch(r){case 1:n[u.columnName]=f;break;case 0:i[u.bindingInfoIndex]=f;break;case 2:t.push({pageName:this.listviewData.designerPageName,bindingInfo:this.listviewData.columnBindingInfos[u.bindingInfoIndex].GUID,value:f})}},r.prototype.isDetailTableEdited=function(){var i=r.getDetailListviews(this.getDataTableName()),n,t,u;if(i)for(n=0,t=i;n<t.length;n++)if(u=t[n],u.hasEdited())return!0;return!1},r.prototype.hasEdited=function(){if(this.deletedRowQuerys.length>0)return!0;var n=this.buildDetailListviewValues(!1);return n?!0:!1},r.prototype._getMasterValueForDetailTable=function(){var r=this.listviewData.getColIndexOfColumnOfDetailTable(),u,t,i;if(r!==-1||!this.isMasterTable()){for(u=this._listData.getRowCount(),t=0;t<u;t++)if(this._listData.getRowQuery(t))return this._listData.getValue(t,r);return i=this._getMasterTable(),i?i.getCurrentRowValue(this.getColumnOfMasterTable()):n.ForguncyData.pageInfo.normalCellBindingManager.getBindingValue({TableName:this.getMasterDataTableName(),ColumnName:this.getColumnOfMasterTable()})}},r.prototype._getMasterTable=function(){var u,n,t,i;if(!this.isMasterTable())for(u=r.getAllListviews(),n=0,t=u;n<t.length;n++)if(i=t[n],i.getDataTableName()===this.getMasterDataTableName())return i},r.prototype.getCurrentRowValue=function(n){var i=this.listviewData.getColIndexByDataColumnName(n),t;return i===-1?null:(t=this._listData.getCurrentRowIndex(),t===undefined)?null:this._listData.getValue(t,i)},r.prototype.buildDetailListviewValues=function(t,i,r){var l,f,o,s,a,h,y,u,e;if(r===void 0&&(r=0),f={calcSheetName:this.getCalcSheetName(),TableName:this.getDataTableName(),EditValues:[],AddValues:[],ColumnOfMasterTable:this.getColumnOfMasterTable(),ColumnOfDetailTable:this.getColumnOfDetailTable(),DeletedValues:[],PageName:this.designerPageName,BindingInfos:(l=this.listviewData.columnBindingInfos)===null||l===void 0?void 0:l.map(function(n){return n.GUID})},o=i===n.UpdateType.add&&this.GetDataCommitMode()===1,!o)for(s=0,a=this.deletedRowQuerys;s<a.length;s++)h=a[s],f.DeletedValues.push({query:h});for(y=this._listData.getRowCount(),u=0;u<y;u++)if(this._commitingRows.indexOf(u)===-1&&(this._listData.isDirty(u,-1)||o)){var h=null,p=null,v=null,c=null;if(o)v=f.AddValues,c=this.buildEditedRowValue(u,!0,!0,r);else{if(c=this.buildEditedRowValue(u,!1,!1,r),c===null)continue;e=this._listData.getRowInfo(u);h=e?e.query:null;p=e?e.rowVersion:null;v=e===undefined?f.AddValues:f.EditValues}t&&this.pushToCommitingRow(u);v.push({values:c,query:h,rowVersion:p,rowIndex:u})}return f.EditValues.length===0&&f.AddValues.length===0&&f.DeletedValues.length===0?null:f},r.prototype.getActualDataLength=function(){return this._listData.getRowCount()},r.prototype.getEditorRowCount=function(){return this._listData.getRowCount()+(this.allowAddRow()?1:0)},r.prototype.getCurrentRowIndex=function(){return this._listData.getCurrentRowIndex()},r.prototype.getCurrentColIndex=function(){return-1},r.prototype.isEditing=function(){return!1},r.prototype.getEditingValue=function(){return null},r.prototype.getSelectedRowsIndexes=function(){var n=this.getListDataCount(),t=function(t){return t>=0&&t<n};return this.getAllSelectedRowsOfView().filter(function(n){return t(n)})},r.prototype.getNewRowIndex=function(){return-1},r.prototype.canEditInListview=function(){return this.listviewData.canEdit()||this.listviewData.canDelete()||this.listviewData.canAddRow()},r.prototype.allowEdit=function(){return this.listviewData.canEdit()},r.prototype.isGroupMode=function(){return this.listviewData.isGroupMode()},r.prototype.getColIndexOfNamedColumn=function(n,t){return this.listviewData.getColIndexByName(n,t)},r.prototype.getColIndexOfBindingColumn=function(n){return this.listviewData.getColIndexByBindingInfo(n)},r.prototype.getDataColIndexByMergedColIndex=function(n){return this.listviewData.getDataColIndex(n)},r.prototype.getMergedColIndexByDataColIndex=function(n){return this.listviewData.getMergedColIndex(n)},r.prototype.getMergedColumnInfos=function(){return this.listviewData.getMergedColumnInfos()},r.prototype.getRangeInfo=function(){return this.listviewData.getRangeInfo()},r.prototype.getContentRangeInfo=function(){return this.listviewData.getContentRangeInfo()},r.prototype.getColumnHeaderRangeInfo=function(){return this.listviewData.getColumnHeaderRangeInfo()},r.prototype.getCalcSheetName=function(){return this.listviewData.name},r.prototype.getListviewName=function(){return this.listviewData.getListviewName()},r.prototype.getFullListviewName=function(){return this.designerPageName+this.getListviewName()},r.prototype.onCellClick=function(n,t){n!==undefined&&t!==undefined&&this._showDeleteButton()},r.prototype.refreshUI=function(n,t){n===void 0&&(n=-1);t===void 0&&(t=-1);this._deleteButton&&this._deleteButton.isVisible()&&this.getCurrentRowCenterY()!==this._deleteButton.getButtonCenterY()&&this._showDeleteButton()},r.prototype.tryCommitValueBeforeQueryOrSort=function(t){if(t===void 0&&(t=!1),this.stopEditingActiveCell(t)){if(this.commitEditChange()==="cancel")return t&&this.scrollToView(),!1}else return!1;return this.allowSortOrQuery()?!0:(alert(n.RS.ErrorInfo_Uncommited),!1)},r.prototype.allowSortOrQuery=function(){return this.GetDataCommitMode()===0&&(this.isMasterTable()||this.getMasterQuery())?!0:this.containUncommitedValue()?!1:!0},r.prototype.containUncommitedValue=function(){return this.containUncommitedDeleteRows()?!0:this.canEditInListview()?this.containUncommitedEditOrAddValues()?!0:this._commitingRows.filter(function(n){return n>=0}).length>0?!0:!1:!1},r.prototype.containUncommitedDeleteRows=function(){return this.deletedRowQuerys.length>0&&this.GetDataCommitMode()!==0},r.prototype.containUncommitedEditOrAddValues=function(){for(var t,i=this._listData.getRowCount(),r=this._listData.getColumnCount(),n=0;n<r;n++)if(this.listviewData.isDataColumnAllowEdit(n))for(t=0;t<i;t++)if(this._listData.isDirty(t,n))return!0;return!1},r.prototype.allowSortByColumn=function(n){var r=this.listviewData.getColumnOperation(),t,i;return r!==1&&r!==2?!1:this.tryCommitValueBeforeQueryOrSort(!0)?(t=this.listviewData.visibleColumns,!t)?!1:(i=t[n],i.allowFieldSort())?!0:this.allowNoFieldSortFilter(i)?!0:!1:!1},r.prototype.allowNoFieldSortFilter=function(t){if(this.listviewData.getColumnOperation()!==2||!t.allowNoFieldSort())return!1;var i=n.ForguncyData.pageingInfoList.IsPageing(this.getLocationString());return i||this._isAllDataLoaded},r.prototype.sortByColumn=function(t,i){var l=this.allowSortByColumn(t),f,u,e,o,c;if(l){for(f=this.listviewData.visibleColumns,u=0;u<f.length;u++)e=this.listviewData.visibleColumns[u],o=null,t===u&&(o=n.Common.IsEmpty(i)?e.sortInfo===0?1:0:i),e.sortInfo=o;var s=n.ForguncyData,h=this.getLocationString(),r=f[t];s.pageInfo.sortInfoCache[h]||(s.pageInfo.sortInfoCache[h]={});c={ColumnIndex:r.columnInfo.Index,ColumnBindingInfo:r.allowFieldSort()?r.getBindingInfo():null,Order:r.sortInfo};s.pageInfo.sortInfoCache[h].sortInfo=[c];this.getListDataCount()<=0?this.refreshUI():r.allowFieldSort()?this.fillData():r.allowNoFieldSort()&&n.FormulaColumnSortFilterHelper.sortByColumn(this)}},r.prototype.resetDataAfterFilter=function(t){t.allowFieldSort()?(this.resetToFirstPage(),this.fillData()):this.allowNoFieldSortFilter(t)&&n.FormulaColumnSortFilterHelper.filterByColumn(this)},r.prototype.isCommiting=function(n){return this._commitingRows.indexOf(n)!==-1},r.getDetailListviews=function(n){var e,t,i,u,f;if(typeof n=="undefined")return null;for(e=r.getAllListviews(),t=[],i=0,u=e;i<u.length;i++)f=u[i],f.getMasterDataTableName()===n&&t.push(f);return t.length===0?null:t},r.getAllListviews=function(t){return n.ForguncyData.pageInfo.pageElementManager.listviewCollection.getListviews(t)},r.getListviewsRelatedWithTable=function(n){for(var t,u=[],e=r.getAllListviews(),i=0,f=e;i<f.length;i++)t=f[i],(t.getMasterDataTableName()===n||t.getDataTableName()===n)&&u.push(t);return u},r.getListviewByCalcSheetName=function(n){var t=r.getAllListviews().filter(function(t){return t.getCalcSheetName()===n});return t&&t.length>0?t[0]:null},r.getListviewByLocationString=function(n){var t=r.getAllListviews().filter(function(t){return t.getLocationString()===n});return t&&t.length>0?t[0]:null},r.getListview=function(n,t){var i=r.getAllListviews().filter(function(i){return i.getListviewName()===n&&i.runTimePageName===t});return i.length>0?i[0]:null},r.lockListviewClick=function(){$(document.body).addClass("listview-click-lock")},r.getListviewClickLocked=function(){return $(document.body).hasClass("listview-click-lock")},r.init=function(){var t=this;$(document).on("click",function(i){var s,f,e,v,y,h,c,l,o,a,u,p;if(!t.getListviewClickLocked()){if(i.target){if(n.ListviewDeleteButton&&i.target.className===n.ListviewDeleteButton.className)return;if(f=$(i.target),e=f.attr("type"),(e==="checkbox"||e==="radio"||e==="file")&&(v=f.attr(n.StaticValues.isInListview),v))return;if(y=f.closest("[gcuielement='fgcDropDownWindow']"),y.length===1)return;if(h=f.closest(".gcim-calendar,.gcim-calendar__navigator_vertical"),h.length===1&&h.parents().last()[0].tagName!=="HTML")return}if(c=r.getAllListviews(),c.length!==0)for(l=n.Common.getMousePosition(i||window.event),o=0,a=c;o<a.length;o++)u=a[o],p=u.getContainerDiv(),r.isPointInElement(l,p)?((s=u._deleteButton)===null||s===void 0?void 0:s.isVisible())&&u._deleteButton.isPointIn(l)&&u.setIsFocused(!1):u.setIsFocused(!1)}})},r.isPointInElement=function(n,t){var i=t.offset(),r=t.width(),u=t.height();return n.y<i.top||n.y>i.top+u||n.x<i.left||n.x>i.left+r?!1:!0},r.onPageCreated=function(){$("#pageWrapper_"+n.ForguncyData.pageInfo.pageID).on("focusin",r.OnPageFocusin)},r.onPageDestroyed=function(){$("#pageWrapper_"+n.ForguncyData.pageInfo.pageID).off("focusin",r.OnPageFocusin)},r.OnPageFocusin=function(t){var i,u,f;n.ListviewDeleteButton&&t.target&&t.target.className===n.ListviewDeleteButton.className||(i=r.getAllListviews(),i.length!==0)&&(u="",t.target&&(f=$(t.target).closest("[fgc-uielement='listview']"),f.length===1&&(u="#"+f.attr("id"))),i.forEach(function(n){return n.setIsFocused("#"+n._containerDiv.id===u)}))},r.prototype.setIsFocused=function(t){if(typeof t=="boolean"&&this.isFocused!==t&&(this.isFocused=t,!this.isFocused&&!this._haveTriggerOnLostFocusMethod)){this._haveTriggerOnLostFocusMethod=!0;var i=this;n.DelayRefresh.setTimeout(function(){i.hasDestroyed()||i.onLostFocus()})}},r.prototype.onLostFocus=function(){this.isFocused||(this.hideDeleteButton(),this.stopEditingActiveCell()&&this.commitEditChange(),this._haveTriggerOnLostFocusMethod=!1)},r.prototype.validateRow=function(n){var t,i;return n===undefined?!0:(t=this._validateRequired(n),t!==-1)?(this._editAndValidateCellWithDelayRefresh(n,t),!1):(t=this.checkCalcError(n),t!==-1)?(this.selectInEditor(n,t),!1):(i=r.commitDetailListviewsEdit(this.getDataTableName()),!i)?!1:!0},r.validateAllListviewsData=function(){var n=r.getAllListviews();return n?r.isListviewsValidationPassed(n,!0):!0},r.commitDetailListviewsEdit=function(n,t){t===void 0&&(t=!1);var i=r.getDetailListviews(n),u=i===null||i===void 0?void 0:i.filter(function(t){return t.getMasterDataTableName()===n});return u?r.isListviewsValidationPassed(u,t):!0},r.isListviewsValidationPassed=function(n,t){for(var r,u,f=n.length,i=0;i<f;i++)if(r=n[i],u=r.isValidationPassed(),!u)return t&&r.scrollToView(),!1;return!0},r.prototype.isValidationPassed=function(){if(!this.stopEditingActiveCell())return!1;var n=this.buildDetailListviewValues(!1);return n&&!this.validateCellValues(n)?!1:!0},r.prototype.scrollToView=function(){var t=this.getContainerDiv();t.length>0&&n.Common.scrollToElement(t,this.runTimePageName)},r.prototype.stopEditingActiveCell=function(n){return n===void 0&&(n=!1),!0},r.prototype.cancelEdit=function(){},r.prototype.tryCommitEdit=function(){return this.commitEditChange()==="cancel"?!1:this.stopEditingActiveCell()?!0:!1},r.prototype.getListviewControl=function(){return null},r.prototype.destroy=function(){this._destroy();this._currentRowInfoChangedEventHandler&&n.ForguncyData.pageInfo.currentRowInfoCollection.unbind("currentrowinfochanged",this._currentRowInfoChangedEventHandler);this._pagingInfoChangedEventHandler&&n.ForguncyData.pageingInfoList.unbind("pageingInfoChanged",this._pagingInfoChangedEventHandler);n.ForguncyData.pageInfo.dataModel.removeListData(this._listData);this._hasDestoryed=!0},r.prototype._destroy=function(){},r.prototype.hasDestroyed=function(){return this._hasDestoryed},r.prototype.GetDataCommitMode=function(){return this.listviewData.getDataCommitMode()},r.prototype.GetDataValidationTime=function(){return this.listviewData.getDataValidationTime()},r.prototype.getControl=function(){return null},r.prototype.validateCellValues=function(n){var t,r,i,u;if(n.EditValues)for(t=0,r=n.EditValues;t<r.length;t++){var f=r[t],e=f.values,o=f.rowIndex,s=this.validateRowValues(o,e,!0);if(!s)return!1}if(n.AddValues)for(i=0,u=n.AddValues;i<u.length;i++){var h=u[i],e=h.values,o=h.rowIndex,s=this.validateRowValues(o,e,!1);if(!s)return!1}return!0},r.prototype.validateRowValues=function(n,t,i){var u=this.listviewData.columnDataInfos,o,r,s,f,h,e,c;if(!u)return!0;for(o=u.length,r=0;r<o;r++)if(s=this.getAllowEditedBindingInfo(r),s){if(f=t[u[r].bindingInfoIndex],f===undefined)if(i)continue;else f=null;try{h=this.validateValue(r,f,!1,!1,n);t[u[r].bindingInfoIndex]=h}catch(l){if(e=this.getVisibleColumnIndexInListViewByDataIndex(r),e<0||!this.listviewData.visibleColumns[e].canEditInForguncy)continue;return this._listData.getCurrentRowIndex()!==n&&(c=this.commitEditChange(),c==="cancel")?!1:(this._editAndValidateCellWithDelayRefresh(n,e,l),!1)}}return!0},r.prototype.updateMultiRows=function(t,i,r){var f=this,u=this.isMasterTable(),e={tableInfo:t,viewName:u?null:this.getFullListviewName(),masterQuery:u?null:this.getMasterQuery()};n.HomeController.CommitEditedTable(e,function(t){i.apply(null,[t]);n.ListViewHelper.RequestHelper.queryTotalRowValues(f)},r)},r.prototype.isTextFormat=function(n){for(var r,u,t=0,i=this.listviewData.visibleColumns;t<i.length;t++)if(r=i[t],r.getColumnIndex()===n){if(u=r.getTemplateCell(),u)return u.StyleInfo.Formatter==="@";break}return!1},r.prototype.clearSelectionOutOfCurrentRow=function(){},r.prototype.addSelectedRow=function(){},r.prototype.setSelectedRows=function(){},r.prototype.clearSelectedRow=function(){},r.prototype.selectAllRows=function(){},r.prototype.clearAllSelectedRows=function(){},r.prototype.isSelectedRow=function(n){return this.getSelectedRowsIndexes().indexOf(n)>=0},r.prototype.getSelectedRowsDataByAPI=function(){var t=this,i=t.getMergedColumnInfos(),r=i.length,u=t.getSelectedRowsData(),f=u.map(function(u){var e,f,s,o;if(n.Common.IsEmpty(u)||n.Common.IsEmpty(u.values))return null;for(e=[],f=0;f<r;f++)s=i[f].DesignerColumnIndex-t.getRangeInfo().Column,o=u.values[s],e.push(n.Common.IsEmpty(o)?null:o);return{RowIndex:u.index,Query:__assign({},u.query),Values:e}});return f.filter(function(n){return!!n})},r.prototype.getSelectedRowsData=function(){var t=this,n=[];return n=this.getAlwaysReservedSelections()?this.cacheManager.getCachedRows():this.getSelectedRowsIndexes().map(function(n){return t.getCachedRowData(n)}),n?n:[]},r.prototype.clearSelectedRowByQuery=function(){},r.prototype.selectRowsByValue=function(t,i){var u=this,r;!n.Common.IsEmpty(t)&&t instanceof Array||(t=[]);r=t.map(function(n){return u.getRowIndexByValue(n,i)});this.getAlwaysReservedSelections()?this.selectRowsByValueInReservedMode(r,t,i):this.setSelectedRows(r)},r.prototype.selectRowsByValueInReservedMode=function(t,i,r){var e=this,u=[],f;if(t.forEach(function(n,t){n===-1&&u.push(i[t])}),f=this.getBindingInfo(r),n.Common.IsEmpty(f)||u.length===0){this.selectRowsWithCache(t,i,r,null);return}n.ListViewHelper.RequestHelper.queryListviewDatasByQuery(this,f,u,function(n){return e.selectRowsWithCache(t,i,r,n)})},r.prototype.selectRowsWithCache=function(t,i,r,u){var f=this,e;this.cacheManager.clearAll();e=t.map(function(n,t){if(n===-1){var e=f.getListRowDataFromServerData(i[t],r,u);return e?f.getCachedRowDataFromListRowData(e):null}return f.getCachedRowData(n)}).filter(function(n){return n});this.cacheManager.saveSelectionDatas(e);this.setSelectedRows(t);this.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{})},r.prototype.getListRowDataFromServerData=function(t,i,r){var e,f,o,u,s;if(!r)return null;for(f=0,o=r;f<o.length;f++)if(u=o[f],s=(e=u===null||u===void 0?void 0:u.data[i])===null||e===void 0?void 0:e.bindingValue,n.Common.isFuzzyEquals(s,t))return u;return null},r.prototype.getCachedRowDataFromListRowData=function(n){for(var r,f,i=n.rowInfo,s=i===null||i===void 0?void 0:i.query,h=i===null||i===void 0?void 0:i.rowVersion,e=[],u=0,o=n.data;u<o.length;u++)r=o[u],f=r===null||r===void 0?void 0:r.bindingValue,e.push(f===undefined?null:f);return new t(s,h,e,-1)},r.prototype.getBindingInfo=function(n){var t=this.listviewData.columnDataInfos[n].bindingInfoIndex;return t===-1?null:this.listviewData.columnBindingInfos[t]},r.prototype.getRowIndexByValue=function(t,i){for(var u,r=0;r<this._listData.getRowCount();r++)if(u=this._listData.getValue(r,i),n.Common.isFuzzyEquals(u,t))return r;return-1},r.prototype.getAlwaysReservedSelections=function(){return this.listviewData.getAlwaysReservedSelections()&&this.listviewData.isRowHeaderCheckBoxVisible()},r.prototype.getAlwaysInEditMode=function(){return this.listviewData.getAlwaysInEditMode()},r.prototype.bindingTableCanEdit=function(){return this.listviewData.bindingTableCanEdit()},r.prototype.getText=function(t,i){var u=this._listData.getValue(t,i),r;return n.Common.IsEmpty(u)?null:(r=this.listviewData.getColumnMetaData(i),r&&r.TemplateCell&&r.TemplateCell.Element&&r.TemplateCell.Element.StyleInfo&&r.TemplateCell.Element.StyleInfo.Formatter)?n.FormatHelper.format(r.TemplateCell.Element.StyleInfo.Formatter,u).text:u instanceof Date?n.FormatHelper.format(n.StaticFormatString.dateTimeDefaultFormattingString,u).text:u},r.prototype.getColumnHeaderText=function(t,i){var u=this.getHeaderCellIDSuffix(),r=this.getRangeInfo(),f=n.Common.getIdStr(t+r.Row,i+r.Column,u);return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(f)},r.prototype._getPageStretchInfo=function(){return n.PageManager.getPageStretchInfo(this.runTimePageName)},r.prototype._getPageLayout=function(){return n.ForguncyData.pageInfo.pageLayouts[this.runTimePageName]},r.prototype.getContainerDiv=function(){return $(this._containerDiv)},r.prototype.getLocationString=function(){return n.Common.IsEmpty(this._locationString)&&(this._locationString=r.getLocationString(this.runTimePageName,this.getListviewName())),this._locationString},r.getLocationString=function(t,i){return n.PageManager.getLocationString(t)+"|"+i},r.prototype.getPagingInfo=function(){var i=this.getLocationString(),t;return n.ForguncyData.pageingInfoList.IsPageing(i)?(t=n.ForguncyData.pageingInfoList.GetInfo(i),{PageCount:t.getPageCount(),PageIndex:t.getCurrentPageIndex(),MaxRowCountOfOnePage:t.limit,TotalRowCount:t.rowCount}):null},r.prototype.selectRowByQuery=function(t){for(var r=this._listData.getRowCount(),i=0;i<r;i++)if(n.Common.isQueryEqual(this._listData.getRowQuery(i),t))return this.selectRow(i),!0;return!1},r.prototype.focus=function(){},r.prototype.getRowValue=function(n){return this._listData.getRowValue(n)},r.prototype.getColumnHeaderRowCount=function(){return this.listviewData.isColumnHeaderVisible()?this.listviewData.getColumnHeaderHeight().length:0},r.prototype.getExportColmnMetadatas=function(){var n=0;return this.listviewData.isRowHeaderVisible()&&n++,this.listviewData.isRowHeaderCheckBoxVisible()&&n++,this.listviewData.metadata.Columns.slice(n)},r.prototype.getColumnWidth=function(){return 0},r.prototype.getAutoFitWidth=function(){return 0},r.prototype.getRowState=function(){return 0},r.prototype.getColumnFilterHelper=function(t){return new n.ListviewColumnFilterHelper(this.getLocationString(),t,this.designerPageName)},r.prototype.getCachedRowData=function(n){var i=this._listData.getRowInfo(n),r=i?i.query:null,u=i?i.rowVersion:null,f=this._listData.getRowValue(n);return new t(r,u,f,r?-1:n)},r.prototype.getAllSelectedRowsOfView=function(){return[]},r.prototype.clearSelectionCache=function(n){this.getAlwaysReservedSelections()&&(n?this.cacheManager.clearByQuery(n,null):this.cacheManager.clearAll())},r}(n.EventClassBase);n.ListviewBase=i;r=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f._selectedRowIndexes=[],f}return __extends(i,t),i.prototype.getAllSelectedRowsOfView=function(){return this._selectedRowIndexes},i.prototype.beforeRefeshUIWhenQueryDataFromServer=function(){this.getAlwaysReservedSelections()?this.updateSelectedRowsFromCache():this._selectedRowIndexes=[];this.triggerSelectedRowsChangedEvent()},i.prototype.updateSelectedRowsFromCache=function(){this._selectedRowIndexes=[];this.cacheManager.reset();for(var n=0;n<this._listData.getRowCount();n++)this.cacheManager.exists(this.getCachedRowData(n))&&this._selectedRowIndexes.push(n);this.cacheManager.save(this.getSelectedRowsIndexes())},i.prototype.clearSelectionOutOfCurrentRow=function(){this._selectedRowIndexes=[this._listData.getCurrentRowIndex()];this.onSelectionChanged()},i.prototype.addSelectedRow=function(n){n<0||n>=this.getListDataCount()||this._selectedRowIndexes.indexOf(n)>=0||(this.listviewData.isSingleSelection()?this._selectedRowIndexes=[n]:this._selectedRowIndexes.push(n),this.onSelectionChanged())},i.prototype.setSelectedRows=function(n){var i=this,t=n.filter(function(n){return n>=0&&n<i.getListDataCount()});this._selectedRowIndexes=this.listviewData.isSingleSelection()&&t.length>0?[t[t.length-1]]:t;this.onSelectionChanged()},i.prototype.clearSelectedRow=function(n){if(!(n<0)&&!(n>=this.getListDataCount())){var t=this._selectedRowIndexes.indexOf(n);t!==-1&&(this._selectedRowIndexes.splice(t,1),this.onSelectionChanged())}},i.prototype.selectAllRows=function(){var t,n;if(!this.listviewData.isSingleSelection()){for(t=[],n=0;n<this.getListDataCount();n++)t.push(n);this._selectedRowIndexes=t;this.onSelectionChanged()}},i.prototype.clearAllSelectedRows=function(){this._selectedRowIndexes=[];this.onSelectionChanged()},i.prototype.clearSelectedRowByQuery=function(t){var i=this;this.getSelectedRowsIndexes().forEach(function(r){if(n.Common.isQueryEqual(i._listData.getRowQuery(r),t)){var u=i._selectedRowIndexes.indexOf(r);u>=0&&i._selectedRowIndexes.splice(u,1)}});this.getAlwaysReservedSelections()&&this.cacheManager.clearByQuery(t,function(){i.delayTriggerEvent(n.ListViewEvents.SelectedRowsChanged,{})});this.onSelectionChanged()},i.prototype.selectInEditor=function(n){if(n>=0&&n<this.getListDataCount()){this._selectedRowIndexes=[n];this.onSelectionChanged(!1)}},i.prototype.onSelectionChanged=function(n){var t,i;if(n===void 0&&(n=!0),t=this.getListDataCount(),t<=0?this._selectedRowIndexes=[]:(i=function(n){return n>=0&&n<t},this._selectedRowIndexes=this._selectedRowIndexes.filter(function(n){return i(n)}).sort(function(n,t){return n-t})),n)if(this._selectedRowIndexes.length>0)this.onCurrentRowChanged(this._selectedRowIndexes[0]);else this.onCurrentRowChanged(0);this.operationTypeWhenValueChanged===0&&(this.getAlwaysReservedSelections()&&this.cacheManager.save(this.getSelectedRowsIndexes()),this.triggerSelectedRowsChangedEvent())},i.prototype.updateSelectedRowsAfterDeleteRow=function(n,t){this.getAlwaysReservedSelections()?this.updateSelectedRowsFromCache():this._listData.getCurrentRowIndex()!==t&&(this._selectedRowIndexes=[]);this.onSelectionChanged(!1)},i.prototype.updateSelectedRowsAfterInsertRows=function(){this.getAlwaysReservedSelections()?this.updateSelectedRowsFromCache():this._selectedRowIndexes=[];this.onSelectionChanged(!1)},i}(i);n.HiddenListview=r;u=function(){function t(){this.listviews=[]}return t.prototype.addSpreadJSView=function(t,i,r,u){var f=new n.SpreadJSView(t,i,r,u);return this.listviews.push(f),f},t.prototype.addHiddenListview=function(n,t,i,u){var f=new r(n,t,i,u);return this.listviews.push(f),f},t.prototype.getListviews=function(n){return n?this.listviews.filter(function(t){return n.indexOf(t.runTimePageName)>=0}):this.listviews},t.prototype.destroy=function(n){n===void 0&&(n=null);this.getListviews(n).forEach(function(n){return n.destroy()});n&&(this.listviews=this.listviews.filter(function(t){return n.indexOf(t.runTimePageName)===-1}))},t.prototype.onDefaultDataSetted=function(t){var i=this.getListviews(t).filter(function(t){return n.SpreadJSView&&t instanceof n.SpreadJSView});i.forEach(function(n){return n.initConditionFormatCalc()});i.forEach(function(n){return n.initConditionFormatFormula()})},t.prototype.loseAllFocus=function(){this.getListviews().filter(function(t){return n.SpreadJSView&&t instanceof n.SpreadJSView}).forEach(function(n){return n.focus(!1)})},t}();n.ListviewCollection=u;f=function(){function n(n,t,i){var r=this;this._finishedCallBack=t;this._stopWhenHaveError=i;this._actions=[];this._errorInfos=[];this._finishedActionCount=0;this._actions=n.map(function(n){return r.getActionWrapper(n)})}return n.prototype.getActionWrapper=function(n){var t=this;return function(){if(t.shouldDoAction()){var i=n();i&&(t._errorInfos.push(i),t._stopWhenHaveError&&t._finishedCallBack(t._errorInfos))}t._finishedActionCount++;t.shouldCallBack()&&t._finishedCallBack(t._errorInfos)}},n.prototype.shouldDoAction=function(){return this._finishedActionCount>=this._actions.length?!1:this._errorInfos.length>0&&this._stopWhenHaveError?!1:!0},n.prototype.shouldCallBack=function(){return this._finishedActionCount<this._actions.length?!1:this._stopWhenHaveError&&this._errorInfos.length>0?!1:!0},n.prototype.execute=function(){var i=this,n,t;this._actions.length===0&&this._finishedCallBack(this._errorInfos);!!window.ActiveXObject||"ActiveXObject"in window?(n=0,t=function(){setTimeout(function(){var u,r;(r=(u=i._actions)[n])===null||r===void 0?void 0:r.call(u);n<i._actions.length&&(n++,t())},0)},t()):this._actions.forEach(function(n){setTimeout(n,0)})},n}();e=function(){function t(n){this._listview=n;this._dataModel=n.getListDataModel()}return t.prototype.importDataWithText=function(t,i,r,u,e,o){var s=this,h=function(){var n=s.getValidateActions(t,u),h=function(n){n&&n.length!==0?o({Success:!1,ErrorInfos:n}):s.importData(t,i,r,u,o)};new f(n,h,e).execute()};this._listview instanceof n.SpreadJSView?this._listview.cacheComboboxForValidateText(t,h):h()},t.prototype.getValidateActions=function(t,i){for(var u=this,f=[],e=function(r){f.push(function(){try{i.forEach(function(n){t[r][n]=u._listview.validateValue(n,t[r][n],!0,!0)})}catch(e){if(u._listview.GetDataValidationTime()===0){var f=e;return f.RowIndex=r,{ErrorType:n.ImportError.ValidateError,ErrorData:f}}}})},r=0;r<t.length;r++)e(r);return f},t.prototype.prepareListview=function(){var n=this._listview.stopEditingActiveCell(!1);n||this._listview.cancelEdit();this._listview.hideDeleteButton()},t.prototype.importData=function(t,i,r,u,f){var o,e;this.prepareListview();try{e=this.getImportDataInfo(t,i,r);this.onlyAddRows(e)?this.addData(t,u,e):this.replaceData(t,u,e);n.Common.IsEmpty(this._dataModel.getCurrentRowIndex())&&this._listview.selectRow(0);o={Success:!0}}catch(s){o={Success:!1,ErrorInfos:[s]}}f(o)},t.prototype.addData=function(n,t,i){var r=[];this.updateData(r,n,t,i);this._dataModel.addData(r,7)},t.prototype.replaceData=function(n,t,i){var r=this._dataModel.getData(!0);this.updateData(r,n,t,i);this._dataModel.setData(r)},t.prototype.updateData=function(n,t,i,r){var u=this;r.editRowIndexes&&r.editRowIndexes.forEach(function(f,e){var o=t[f],s=r.editRowIndexesInListView[e],h=n[s];i.forEach(function(n){u.changeValue(o[n],n,h)})});r.deleteRowIndexesInListView&&r.deleteRowIndexesInListView.sort(function(n,t){return t-n}).forEach(function(t){n.splice(t,1).forEach(function(n){var t;((t=n.rowInfo)===null||t===void 0?void 0:t.query)&&u._listview.deletedRowQuerys.push(n.rowInfo.query)})});r.addRowIndexes&&r.addRowIndexes.forEach(function(r){var f=u._listview.getNewRowData(!1,!1);i.forEach(function(n){u.changeValue(t[r][n],n,f)});n.push(f)})},t.prototype.changeValue=function(t,i,r){var u=r.data[i];n.Common.IsEmpty(u)&&(u=new n.ListDataValue,u.bindingValue=null);u.value=t;u.valueType=7;r.data[i]=u},t.prototype.onlyAddRows=function(n){return n.editRowIndexes&&n.editRowIndexes.length>0?!1:n.deleteRowIndexesInListView&&n.deleteRowIndexesInListView.length>0?!1:!0},t.prototype.getImportDataInfo=function(t,i,r){switch(i){case n.ImportMode.Merge:return this.getImportDataInfoInMergeMode(t,r);case n.ImportMode.Replace:return r&&r.length>=1?this.getImportDataInfoInReplaceMode(t,r):this.getImportDataInfoInTotallyReplaceMode(t);case n.ImportMode.MergeIgnoreEdit:return this.getImportDataInfoInMergeIgnoreEditMode(t,r);case n.ImportMode.ReplaceIgnoreEdit:return this.getImportDataInfoInReplaceIgnoreEditMode(t,r);default:return this.getImportDataInfoInAddMode(t)}},t.prototype.getImportDataInfoInAddMode=function(n){return{addRowIndexes:n.map(function(n,t){return t})}},t.prototype.getImportDataInfoInMergeMode=function(t,i){var r=this.getPrimaryKeysFromData(t,i),u=this.getSameKeys(r);if(u.length>0)throw{ErrorType:n.ImportError.ExistSameKeys,ErrorData:n.Common.format(n.RS.ImportExcelToListViewError_ExistSameKeys,u.join("\r\n"))};var f=this.getPrimaryKeysFromListview(i),e=[],o=[],s=[];return r.forEach(function(n,t){for(var r=[],i=f.indexOf(n);i!==-1;)r.push(i),i=f.indexOf(n,i+1);r.length===0?e.push(t):r.forEach(function(n){o.push(t);s.push(n)})}),{addRowIndexes:e,editRowIndexes:o,editRowIndexesInListView:s}},t.prototype.getPrimaryKeysFromData=function(n,t){var i=n.map(function(n){return t.map(function(t){return n[t]})});return this.getPrimaryKeyStrs(i)},t.prototype.getPrimaryKeysFromListview=function(n){for(var r=this,u=this._dataModel.getRowCount(),i=[],f=function(t){var u=n.map(function(n){return r._dataModel.getValue(t,n)});i.push(u)},t=0;t<u;t++)f(t);return this.getPrimaryKeyStrs(i)},t.prototype.getPrimaryKeyStrs=function(t){return t.map(function(t){var i=t.map(function(t){return n.Common.IsEmpty(t)&&(t=null),t&&(t=t+""),t});return JSON.stringify(i)})},t.prototype.getSameKeys=function(t){return n.Common.clone(t).filter(function(n,t,i){return i.indexOf(n)!==t?!0:!1})},t.prototype.getImportDataInfoInReplaceMode=function(n,t){var r=this.getImportDataInfoInMergeMode(n,t),u,i;for(r.deleteRowIndexesInListView=[],u=this._dataModel.getRowCount(),i=0;i<u;i++)r.editRowIndexesInListView.indexOf(i)===-1&&r.deleteRowIndexesInListView.push(i);return r},t.prototype.getImportDataInfoInReplaceIgnoreEditMode=function(n,t){var i=this.getImportDataInfoInReplaceMode(n,t);return i.editRowIndexes=[],i.editRowIndexesInListView=[],i},t.prototype.getImportDataInfoInMergeIgnoreEditMode=function(n,t){var i=this.getImportDataInfoInMergeMode(n,t);return i.editRowIndexes=[],i.editRowIndexesInListView=[],i},t.prototype.getImportDataInfoInTotallyReplaceMode=function(n){var i=this.getImportDataInfoInAddMode(n),r,t;for(i.deleteRowIndexesInListView=[],r=this._dataModel.getRowCount(),t=0;t<r;t++)i.deleteRowIndexesInListView.push(t);return i},t}();n.ListviewDataImportHelper=e;o=function(){function t(n){this._listview=n}return t.prototype.showOrHideColumns=function(t,i){var u,f,r,e;if(this.containRowHeaderColumns(t))throw n.RS.HideShowColumns_CannotHideRowHeader;if(!this._listview.tryCommitEdit())throw n.RS.HideShowColumns_ListviewIsEditing;if(u=this._listview.listviewData.metadata,f=u.Columns.filter(function(n){return t.indexOf(n.Index)>=0}),this.willShowHiddenColumn(f,i))throw n.RS.HideShowColumns_CannotShowHiddenColumn;(r=!1,f.forEach(function(n){i?n.Width>0&&(r=!0,n.Width=0,n.IsHiddenByJavaScriptAPI=!0):n.Width===0&&(r=!0,n.Width=n.OriginalWidth,n.IsHiddenByJavaScriptAPI=!1)}),r)&&(e=new n.ListviewData(u,this._listview.listviewData.layout,this._listview.runTimePageName,this._listview.designerPageName,this._listview.listviewData.uniqueIndex),this._listview.resetListviewData(e))},t.prototype.containRowHeaderColumns=function(n){var t=-1,i;return(this._listview.listviewData.isRowHeaderVisible()&&t++,this._listview.listviewData.isRowHeaderCheckBoxVisible()&&t++,t===-1)?!1:(i=this._listview.listviewData.metadata.Columns[t].Index,n.some(function(n){return n<=i}))},t.prototype.willShowHiddenColumn=function(n,t){return t?!1:n.some(function(n){return n.IsHiddenByColumnOptions||n.IsHiddenByLayout})},t}();n.ListivewColumnManager=o})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function n(){}return n}(),t,r;n.ListViewStyleTemplateUtils=i;t=function(){function n(){this.SelectBack="#51141414";this.SelectBorder="#217346";this.ShowHorizontalGridLine=!0;this.ShowVerticalGridLine=!0;this.ShowColumnHeaderHorizontalGridLine=!0;this.ShowColumnHeaderVerticalGridLine=!0;this.ShowRowHeaderHorizontalGridLine=!0;this.ShowRowHeaderVerticalGridLine=!0;this.ColumnFilterButtonStyle=0;this.IconColorUseCellForground=!0;this.OutLineColor="Background 1 -15"}return n}();n.ListViewStyleTemplate=t,function(n){n[n.RowHeader=0]="RowHeader";n[n.CheckBoxRowHeader=1]="CheckBoxRowHeader";n[n.ColumnHeader=2]="ColumnHeader";n[n.CornerHeader=3]="CornerHeader"}(r=n.HeaderType||(n.HeaderType={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var o=function(n){function t(){var t=n.call(this)||this,r=t;return t.normalCellDataModel=new i,t.normalCellDataModel.bind("valuechanged",function(n,t){r.trigger("valuechanged",{arg:t})}),t._listDatas=[],t}return __extends(t,n),t.prototype.addListData=function(n,t,i,r){var e=this,f=new u(t,i,r,n);return this._listDatas.push(f),f.bind("valuechanged",function(n,i){e.trigger("valuechanged",{calcName:t,arg:i})}),f},t.prototype.removeListData=function(n){var t=this._listDatas.indexOf(n);t!==-1&&(n.unbindAll(),this._listDatas.splice(t,1))},t.prototype.getListDataList=function(n){return this._listDatas.filter(function(t){return n.indexOf(t.runTimePageName)>=0})},t.prototype.getListDataByListviewName=function(n,t){var i=this._listDatas.filter(function(i){return i.listviewName===n&&i.runTimePageName===t});return i.length>0?i[0]:null},t.prototype.getListDataByCalcSheetName=function(n){var t=this._listDatas.filter(function(t){return t.name===n});return t.length>0?t[0]:null},t}(n.EventClassBase),i,r,t,f,e,u;n.DataModel=o;i=function(n){function t(){var t=n.call(this)||this;return t._data={},t}return __extends(t,n),t.prototype.setValue=function(n,t,i,r){var u,e;r===void 0&&(r=!1);t?(u=t.newValue,e=t.uiAction):u=t;var f=this.getValue(n),s=this.getValueType(n),o={value:u,valueType:i,bindingValue:i===2?u:this.getBindingValue(n)};r&&(o.ignoreExport=!0);this._data[n]=o;(f!==u||s!==i)&&this.trigger("valueortypechanged",{id:n,oldValue:f,newValue:u,uiAction:e,valueType:i});f!==u&&this.trigger("valuechanged",{id:n,oldValue:f,newValue:u,uiAction:e,valueType:i})},t.prototype.hasValue=function(n){return typeof this._data[n]!="undefined"},t.prototype.getValue=function(n){var t=this._data[n];return typeof t=="undefined"||typeof t.value=="undefined"?null:t.value},t.prototype.getValueType=function(n){var t=this._data[n];return typeof t=="undefined"||typeof t.valueType=="undefined"?0:t.valueType},t.prototype.getBindingValue=function(n){var t=this._data[n];return typeof t=="undefined"||typeof t.bindingValue=="undefined"?null:t.bindingValue},t.prototype.getAllExportDatas=function(){var t={};for(var n in this._data)this._data[n].ignoreExport||(t[n]=this.getValue(n));return t},t.prototype.clearValue=function(n){delete this._data[n]},t}(n.EventClassBase);n.NormalCellDataModel=i;r=function(){function n(){}return n}();n.ListDataValue=r;t=function(){function n(){}return n}();n.ListRowInfo=t;f=function(){function n(){}return n}();n.ListRowData=f;e=function(){function n(){}return n}();n.ListDataModelValueChangedEventArg=e;u=function(i){function u(n,t,r,u){var f=i.call(this)||this;return f.name=n,f._columnCount=t,f.runTimePageName=r,f.listviewName=u,f.indexFlag=0,f._eventTriggerID=0,f._data=[],f}return __extends(u,i),u.prototype.resetColumnCount=function(n){this._columnCount=n;this._data=[]},u.prototype.getCurrentRowIndex=function(){return this._currentRowIndex},u.prototype.select=function(n){n!==this._currentRowIndex&&(this._currentRowIndex=n,this.trigger("selectionchanged",n))},u.prototype.getRowData=function(n){return this._isRowIndexValid(n)?this._data[n]:null},u.prototype.getData=function(t){return t?n.Common.clone(this._data):this._data},u.prototype.setData=function(n,t){var f=this,r=this.getRowCount(),i,u;(this._data=[],n&&n.length&&(n.forEach(function(n){f.setRowUniqueIndex(n)}),this._data=n),i=this.getRowCount(),i!==0||r!==0)&&(u={cellRange:{Row:-1,Column:-1,RowCount:-1,ColumnCount:-1},oldRowCount:r,newRowCount:i,uiAction:!!t,actionType:0,valueType:2},this.triggerValueChangedEvent(u))},u.prototype.setRowUniqueIndex=function(t){n.Common.IsEmpty(t.uniqueIndex)&&(t.uniqueIndex=this.indexFlag,this.indexFlag++)},u.prototype.insertData=function(n,t,i,r,u){var e,s=this,f,o;!t||t.length<=0||(f=this.getRowCount(),n<0||n>f)||(t&&t.forEach(function(n){s.setRowUniqueIndex(n)}),(e=this._data).splice.apply(e,__spreadArray([n,0],t,!1)),u&&this._currentRowIndex>=n&&this.select(this._currentRowIndex+t.length),o={cellRange:{Row:n,Column:-1,RowCount:t.length,ColumnCount:-1},oldRowCount:f,newRowCount:this.getRowCount(),uiAction:!!r,actionType:4,valueType:i},this.triggerValueChangedEvent(o))},u.prototype.addData=function(n,t,i){var e=this,r,u,f;!n||n.length<=0||(n.forEach(function(n){e.setRowUniqueIndex(n)}),r=this.getRowCount(),u=r,this._data=this._data.concat(n),f={cellRange:{Row:u,Column:-1,RowCount:n.length,ColumnCount:-1},oldRowCount:r,newRowCount:this.getRowCount(),uiAction:!!i,actionType:1,valueType:t},this.triggerValueChangedEvent(f))},u.prototype.setValue=function(n,t,i,u,f){var s,e,o,h;this._isRowIndexValid(n)&&this._isColumnIndexValid(t)&&(s=this.getValue(n,t),e=new r,e.value=i,e.valueType=u,e.bindingValue=u===2?i:this.getBindingValue(n,t),this._data[n].data[t]=e,s!==i)&&(o=this.getRowCount(),h={cellRange:{Row:n,Column:t,RowCount:1,ColumnCount:1},oldRowCount:o,newRowCount:o,uiAction:!!f,actionType:3,valueType:u},this.triggerValueChangedEvent(h))},u.prototype.getBindingValue=function(n,t){if(!this._isRowIndexValid(n)||!this._isColumnIndexValid(t))return null;var i=this._data[n].data[t];return typeof i=="undefined"||typeof i.bindingValue=="undefined"?null:i.bindingValue},u.prototype.getValueType=function(n,t){if(!this._isRowIndexValid(n)||!this._isColumnIndexValid(t))return 0;var i=this._data[n].data[t];return typeof i=="undefined"||typeof i.valueType=="undefined"?0:i.valueType},u.prototype.getValue=function(n,t){if(!this._isRowIndexValid(n)||!this._isColumnIndexValid(t))return null;var i=this._data[n].data[t];return u.getValueFromItem(i)},u.getValueFromItem=function(n){if(typeof n=="undefined")return null;var t=n.valueType===2?n.bindingValue:n.value;return typeof t=="undefined"?null:t},u.prototype.getRowValue=function(n){var i,r,t;if(!this._isRowIndexValid(n))return null;for(i=[],r=this.getColumnCount(),t=0;t<r;t++)i.push(this.getValue(n,t));return i},u.prototype.getRowInfo=function(n){return this._isRowIndexValid(n)?this._data[n].rowInfo:null},u.prototype.getRowQuery=function(n){var t=this.getRowInfo(n);return t?t.query:null},u.prototype.getRowVersion=function(n){var t=this.getRowInfo(n);return t?t.rowVersion:null},u.prototype.setRowQuery=function(n,i){if(this._isRowIndexValid(n)){var r=this._data[n];r.rowInfo||(r.rowInfo=new t);r.rowInfo.query=i}},u.prototype.setRowVersion=function(n,i){if(this._isRowIndexValid(n)){var r=this._data[n];r.rowInfo||(r.rowInfo=new t);r.rowInfo.rowVersion=i}},u.prototype.clear=function(){this.setData([])},u.prototype.getRowIndexByQuery=function(t){var u,i,r;if(!t)return-1;for(u=this._data.length,i=0;i<u;i++)if(r=this._data[i].rowInfo,r&&n.Common.isQueryEqual(r.query,t))return i;return-1},u.prototype._isRowIndexValid=function(n){return n!==null&&n>=0&&n<this._data.length},u.prototype._isColumnIndexValid=function(n){return n!==null&&n>=0&&n<this._columnCount},u.prototype.getRowCount=function(){return this._data.length},u.prototype.getColumnCount=function(){return this._columnCount},u.prototype.deleteRow=function(n,t){if(this._isRowIndexValid(n)){var i=this.getRowCount(),r=this._data.splice(n,1),u={cellRange:{Row:-1,Column:-1,RowCount:-1,ColumnCount:-1},oldRowCount:i,newRowCount:this.getRowCount(),uiAction:!!t,actionType:2,valueType:7,deleteRow:n,deletedRowUniqueIndex:r[0].uniqueIndex};this.triggerValueChangedEvent(u)}},u.prototype.isDirty=function(n,t){return n===-1&&t===-1?this._isDirtySheet():t===-1?this._isDirtyRow(n):!this._isRowIndexValid(n)||!this._isColumnIndexValid(t)?!1:this._isDirtyValue(this._data[n].data[t])},u.prototype._isDirtyValue=function(n){if(typeof n=="undefined"||n.valueType===2||n.valueType===1)return!1;var t=typeof n.bindingValue=="undefined"?null:n.bindingValue,i=typeof n.value=="undefined"?null:n.value;return this._fixNumber(t)!==this._fixNumber(i)},u.prototype._fixNumber=function(n){var t,i,r;return typeof n!="number"?n:(t=15,n>-10&&n<10&&(i=n.toString(),(i.indexOf("000000000000")>1||i.indexOf("999999999999")>1)&&(t=14)),n<1&&n>-1?(r=+n.toFixed(t),n=r===0?+n.toPrecision(t):r):n=+n.toPrecision(t),n)},u.prototype._isDirtyRow=function(n){var t,r,i;if(!this._isRowIndexValid(n))return!1;if(t=this._data[n],typeof t.rowInfo=="undefined")return!0;for(r=t.data.length,i=0;i<r;i++)if(this._isDirtyValue(t.data[i]))return!0;return!1},u.prototype._isDirtySheet=function(){for(var t=this.getRowCount(),n=0;n<t;n++)if(this._isDirtyRow(n))return!0;return!1},u.prototype.triggerValueChangedEvent=function(n){n.triggerID=++this._eventTriggerID;this.trigger("valuechanged",n)},u}(n.EventClassBase);n.ListDataModel=u})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(){function n(){}return n.prototype.setCurrentPageIndex=function(n){isNaN(n)||(this.currentPageIndex=Math.max(1,n))},n.prototype.getCurrentPageIndex=function(){return this.currentPageIndex},n.prototype.getPageCount=function(){return this.limit>0?Math.max(1,Math.ceil(this.rowCount/this.limit)):1},n}(),i;n.PageingInfoItem=t;i=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n._list={},n}return __extends(r,i),r.prototype.IsPageing=function(n){var t=this.GetInfo(n);return t.limit>0},r.prototype.Init=function(i,r){if(r===void 0&&(r=0),n.Common.IsEmpty(this._list)&&(this._list={}),n.Common.IsEmpty(this._list[i])){var u=new t;u.setCurrentPageIndex(1);u.limit=r;u.rowCount=-1;this._list[i]=u}},r.prototype.RefeshRowCount=function(n,t){this.Init(n);var i=this.GetInfo(n);if(i.getCurrentPageIndex()===1&&i.limit===0){t(-1);return}this.GetRowCount(n,t)},r.prototype.GetPageIndex=function(n){var t=this.GetInfo(n);return t.getCurrentPageIndex()},r.prototype.SetPageingInfo=function(n,t,i){var u=this._list[n],r;if(!u||u.limit!==i||u.getCurrentPageIndex()!==Math.max(1,t))return(this.Init(n),r=this._list[n],r.getCurrentPageIndex()!==t||r.limit!==i)?(r.setCurrentPageIndex(t),r.limit=i,this.triggerPageingInfoChanged(n),!0):!1},r.prototype.ResetPageIndexToFirstPage=function(n){this.Init(n);this._list[n].setCurrentPageIndex(1)},r.prototype.triggerPageingInfoChanged=function(n){var t={listviewLocation:n,pagingInfo:this.GetInfo(n)};this.triggerApiEvent(n,t);this.trigger("pageingInfoChanged",t)},r.prototype.triggerPageingRowcountChanged=function(n){var t={listviewLocation:n,pagingInfo:this.GetInfo(n)};this.triggerApiEvent(n,t);this.trigger("pageingRowcountChanged",t)},r.prototype.triggerApiEvent=function(t,i){var r=n.Page.getListViews().filter(function(n){return n._getLocationStr()===t});r.forEach(function(n){return n.trigger("pageingInfoChanged",{CurrentPageIndex:i.pagingInfo.getCurrentPageIndex(),MaxRowCountOfOnePage:i.pagingInfo.limit,TotalRowCount:i.pagingInfo.rowCount})})},r.prototype.GetLimit=function(n){var t=this.GetInfo(n);return t.limit},r.prototype.GetRowCount=function(n,t){var i=this;this.GetRowCountFromServer(n,function(r){var s=i._list[n].rowCount,u,f,e,o;s!==r?(u=i.GetPageIndex(n),f=i.GetLimit(n),u=f!==0&&r!==0?Math.min(u,Math.ceil(r/f)):1,i.SetRowCount(n,r),i._list[n].setCurrentPageIndex(u),i.triggerPageingRowcountChanged(n)):(e={listviewLocation:n,pagingInfo:i.GetInfo(n)},i.triggerApiEvent(n,e));t&&(o=i.GetInfo(n),t(o.rowCount))})},r.prototype.SetRowCount=function(n,t){this.Init(n);this._list[n].rowCount=t},r.prototype.GetInfo=function(n){this.Init(n);var r=this._list[n],i=new t;return i.setCurrentPageIndex(r.getCurrentPageIndex()),i.limit=r.limit,i.rowCount=r.rowCount,i},r.prototype.GetRowCountFromServer=function(t,i){var u=n.ListviewBase.getAllListviews().filter(function(n){return n.getLocationString()===t}),r;u.length<=0&&i(0);r=u[0];r.isGroupMode()&&i(0);var f=r.getRowInfo(),e=n.ForguncyData.pageInfo.commandQuerys[f.currentTable],o=n.ForguncyData.pageInfo.getFilterInfoWithBinding(r.getLocationString());n.HomeController.GetRowCount({queryCommandInfo:e,currentRowInfo:f,columnFilterQueries:o,pageName:r.designerPageName},function(t){if(n.Common.IsEmpty(t))return 0;var r=t;i(r)})},r}(n.EventClassBase);n.PageingInfoList=i})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var r=function(){function n(){}return n}(),t,i;n.CurrentRowInfo=r;t=function(){function n(){}return n}();n.CurrentProcessInfo=t;i=function(t){function i(n){var i=t.call(this)||this;return i._changedCounter=0,i._normalCellBindingManager=n,i.list=[],i}return __extends(i,t),i.prototype.getCurrentRowInfo=function(t){if(this.list)for(var i=0;i<this.list.length;i++)if(this.list[i].currentTable===t)return n.Common.clone(this.list[i]);return null},i.prototype.setCurrentRowInfo=function(t,i){var u,f,r,e;if(t&&t.currentTable&&t.query){for(u=!0,f=!0,r=0;r<this.list.length;r++)if(this.list[r].currentTable===t.currentTable){n.Common.isQueryEqual(this.list[r].query,t.query)&&(u=!1);this.list[r]=t;f=!1;break}e={rowInfo:t,isQueryChanged:u};f?(this.list.push(t),e.change=0):e.change=1;this.trigger("currentrowinfochanged",e);i&&u&&this._normalCellBindingManager.getBindingValuesFromServer(t.currentTable,t.query);u&&this.checkProcessChanged(t,f)}},i.prototype.removeCurrentRowInfo=function(n,t){var u,i,r;if(t===void 0&&(t=!0),n!==undefined){for(u=this.list.length,i=0;i<u;i++)if(this.list[i].currentTable===n){r=this.list.splice(i,1);this._normalCellBindingManager.clearBindingValues(n);this.trigger("currentrowinfochanged",{rowInfo:r[0],change:2,isQueryChanged:!0});t&&this.checkProcessRemoved(r[0]);break}t&&(n==="ACT_RU_TASK_View"?this.removeCurrentRowInfo("ACT_HI_TASKINST_View",!1):n==="ACT_HI_TASKINST_View"&&this.removeCurrentRowInfo("ACT_RU_TASK_View",!1))}},i.prototype.setCurrentRowInfoByAPI=function(t){var i,f,e;if(t){var o=this,u=function(t){var u,r,i;if(!n.Common.IsEmpty(t)){if(n.Common.IsEmpty(t.query)){t.table&&n.ErrorHelper.printErrorStr(n.Common.format(n.RS.SetCurrentRow_Error_NoRecord,t.table));return}for(u=n.ListviewBase.getAllListviews().filter(function(n){return n.getDataTableName()===t.table}),r=0;r<u.length;r++)if(u[r].selectRowByQuery(t.query)===!0)return;i=new n.CurrentRowInfo;i.currentTable=t.table;i.query=t.query;i.selectedRowIndex=0;i.recordID=0;o.setCurrentRowInfo(i,!0)}},r=t;if(r.TableName&&r.PrimaryKey){n.HomeController.GetQueryInfo(r.TableName,r.PrimaryKey,u);return}i=t;i.QueryCondition&&(f=n.Common.getRunTimePageNameFromFormulaCalcContext(i.FormulaCalcContext),e=n.ConditionHelper.getComputedSqlConditionFormula(i.QueryCondition,f,n.QueryNullPolicy.QueryAllItemsWhenValueIsNull,i.FormulaCalcContext.RowOffset,i.FormulaCalcContext.ColumnOffset,i.FormulaCalcContext.ListviewRowInfo),n.HomeController.GetQueryInfoByCondition(e,u))}},i.prototype.setCurrentRowInfoByProessTaskId=function(t){var i,r,f,u;t&&(i=n.FormulaHelper.getFormulaCalcInfo(t.FormulaCalcContext),i.supportReferToListview=!0,r=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t.ProcessTaskId,i),r)&&(f=this,u=new n.BPM.DataPermissionApi,u.taskId=r,u.invokeAsync().then(function(t){var e,r,u,o,s,i;if(t.code!==200)throw new Error(t.message);if(t.data.businessKey&&(r=JSON.parse(t.data.businessKey),r&&r.length!==0&&r[0]))for(u=0,o=r;u<o.length;u++)s=o[u],i=new n.CurrentRowInfo,i.currentTable=s.tableName,i.query=(e=s.primaryKeys)===null||e===void 0?void 0:e[0],i.selectedRowIndex=0,i.recordID=0,f.setCurrentRowInfo(i,!0)}))},i.prototype.getTaskId=function(){var n;return(n=this._lastChangedProcessTable==="ACT_HI_TASKINST_View"?this.getCurrentRowInfo("ACT_HI_TASKINST_View")||this.getCurrentRowInfo("ACT_RU_TASK_View"):this.getCurrentRowInfo("ACT_RU_TASK_View")||this.getCurrentRowInfo("ACT_HI_TASKINST_View"),n)?n.query.ID_.toString():null},i.prototype.getProcessInstanceId=function(){var n=this.getCurrentRowInfo("ACT_HI_PROCINST_View");return n?n.query.ID_.toString():null},i.prototype.setProcessInfo=function(n,t,i){n?this.setCurrentRowInfo({currentTable:"ACT_HI_TASKINST_View",query:{ID_:t}},!1):this.setCurrentRowInfo({currentTable:"ACT_RU_TASK_View",query:{ID_:t}},!1);this.setCurrentRowInfo({currentTable:"ACT_HI_PROCINST_View",query:{ID_:i}},!1)},i.prototype.checkProcessChanged=function(t,i){var e=this,u,r=t.currentTable,o,f;(r==="ACT_RU_TASK_View"||r==="ACT_HI_TASKINST_View")&&(this._lastChangedProcessTable=r,this._changedCounter+=1,o=this._changedCounter,n.BPM.Engine.taskService.describeBusinessKeyInfoAsync((u=t.query.ID_)===null||u===void 0?void 0:u.toString()).then(function(t){var i,r;o===e._changedCounter&&(t&&t.businessKey&&(i=JSON.parse(t.businessKey),i===null||i===void 0?void 0:i.forEach(function(t){n.Page.setCurrentRow({TableName:t.tableName,PrimaryKey:t.primaryKeys[0]})})),t&&!t.businessKey&&(r=t.tableNames,r&&r.forEach(function(n){e.removeCurrentRowInfo(n)})))}),f={change:0},f.change=i?0:1,this.trigger("currentprocessinfochanged",f),r==="ACT_RU_TASK_View"?this.removeCurrentRowInfo("ACT_HI_TASKINST_View",!1):r==="ACT_HI_TASKINST_View"&&this.removeCurrentRowInfo("ACT_RU_TASK_View",!1))},i.prototype.checkProcessRemoved=function(t){var u=this,i,r=t.currentTable,f,e;(r==="ACT_RU_TASK_View"||r==="ACT_HI_TASKINST_View")&&(this._lastChangedProcessTable=r,this._changedCounter+=1,f=this._changedCounter,n.BPM.Engine.taskService.describeBusinessKeyInfoAsync((i=t.query.ID_)===null||i===void 0?void 0:i.toString()).then(function(t){if(f===u._changedCounter&&t&&t.businessKey){var i=JSON.parse(t.businessKey);i===null||i===void 0?void 0:i.forEach(function(t){n.Common.isPageContainsTableBinding(n.ForguncyData.pageInfo.pageName,t.tableName)&&u.removeCurrentRowInfo(t.tableName)})}}),e={change:2},this.trigger("currentprocessinfochanged",e))},i}(n.EventClassBase);n.CurrentRowInfoCollection=i})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.prototype.getRelatedCellIdsByTable=function(n){for(var t,r=[],f=this._getCells(),i=0,u=f;i<u.length;i++)t=u[i],t.bindingInfo&&t.bindingInfo.TableName===n&&r.push(t.id);return r},t.prototype.getRelatedCellIdsByBindingInfo=function(t,i){for(var u,f=[],o=this._getCells(i),r=0,e=o;r<e.length;r++)u=e[r],n.Common.isBindingInfoEquals(u.bindingInfo,t)&&f.push(u.id);return f},t.prototype.getBindingInfos=function(){for(var f,t,e,i,o,h,r=[],c=this._getCells(),u=0,s=c;u<s.length;u++)if(f=s[u],t=f.bindingInfo,t){for(e=!1,i=0,o=r;i<o.length;i++)if(h=o[i],n.Common.isBindingInfoEquals(t,h.bindingInfo)){e=!0;break}e||r.push({pageName:f.designerPageName,bindingInfo:t})}return r},t.prototype._getCells=function(t){return n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.pageElementManager?n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t):[]},t}(),i=function(){function t(){}return t.prototype.getRelatedImagesByTable=function(n){for(var t,r=[],f=this._getImages(),i=0,u=f;i<u.length;i++)t=u[i],t.bindingInfo&&t.bindingInfo.TableName===n&&r.push(t.id);return r},t.prototype.getRelatedImagesByBindingInfo=function(t,i){for(var u,f=[],o=this._getImages(i),r=0,e=o;r<e.length;r++)u=e[r],n.Common.isBindingInfoEquals(u.bindingInfo,t)&&f.push(u.id);return f},t.prototype.getBindingInfos=function(){for(var f,t,e,i,o,h,r=[],c=this._getImages(),u=0,s=c;u<s.length;u++)if(f=s[u],t=f.bindingInfo,t){for(e=!1,i=0,o=r;i<o.length;i++)if(h=o[i],n.Common.isBindingInfoEquals(t,h.bindingInfo)){e=!0;break}e||r.push({pageName:f.designerPageName,bindingInfo:t})}return r},t.prototype._getImages=function(t){return n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.pageElementManager?n.ForguncyData.pageInfo.pageElementManager.backgroundImages.getBackgroundImages(t):[]},t}(),r=function(){function r(n){this._dataModel=n;this.bindingValueVersions={};this._cellBindingRef=new t;this._backgroundImageBindingRef=new i}return r.prototype.getBindingValuesFromServer=function(t,i){if(this._dataModel&&t&&i){var r=this,u=r.getBindingInfos(t),f={columnBindingInfos:u.pageBindingInfo,query:i,table:t};n.HomeController.GetTableRowData(f,function(n){r.isQueryInfoValid(t,i)&&n&&r.updateBindingValues(n,t,u.bindingInfos)})}},r.prototype.isQueryInfoValid=function(t,i){if(!n.ForguncyData.pageInfo.currentRowInfoCollection)return!1;var r=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(t);return r&&n.Common.isQueryEqual(i,r.query)},r.prototype.updateBindingValues=function(t,i,r){for(var e=t.Values.length,o=function(i){for(var h,e=r[i],o=t.Values[i],s=u._cellBindingRef.getRelatedCellIdsByBindingInfo(e),c=s.length,f=0;f<c;f++)u._dataModel.setValue(s[f],{newValue:o},2);h=u._backgroundImageBindingRef.getRelatedImagesByBindingInfo(e);n.ForguncyData.pageInfo.pageElementManager.backgroundImages.list.filter(function(n){return h.indexOf(n.id)>=0}).forEach(function(n){return n.changePicture(o)})},u=this,f=0;f<e;f++)o(f);t.RowVersionInfo?this.bindingValueVersions[t.RowVersionInfo.TableName]=t.RowVersionInfo.RowVersion:this.bindingValueVersions[i]=null},r.prototype.getRelatedCellIdsByBindingInfo=function(n){return this._cellBindingRef.getRelatedCellIdsByBindingInfo(n)},r.prototype.setValueToBindingCell=function(n,t,i){for(var f,e=this._cellBindingRef.getRelatedCellIdsByBindingInfo(n,i),r=0,u=e;r<u.length;r++)f=u[r],this._dataModel.setValue(f,{newValue:t},7)},r.prototype.clearBindingValues=function(t){var r,u,i,f;if(this._dataModel){for(r=this._cellBindingRef.getRelatedCellIdsByTable(t),u=r.length,i=0;i<u;i++)this._dataModel.setValue(r[i],{newValue:null},2);f=this._backgroundImageBindingRef.getRelatedImagesByTable(t);n.ForguncyData.pageInfo.pageElementManager.backgroundImages.list.filter(function(n){return f.indexOf(n.id)>=0}).forEach(function(n){return n.changePicture(null)})}},r.prototype.getEditedBindingValues=function(t){for(var e=[],r=this._cellBindingRef.getBindingInfos(),s=r.length,i=0;i<s;i++)if(r[i].bindingInfo.TableName===t&&!r[i].bindingInfo.RelationBinding&&!r[i].bindingInfo.AttachType){var h=r[i].bindingInfo.GUID,c=r[i].pageName,o=this._cellBindingRef.getRelatedCellIdsByBindingInfo(r[i].bindingInfo),u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(o[o.length-1]),f=n.ForguncyData.pageInfo.autoIDManager.getAutoIDByBindingInfo(r[i].bindingInfo),l=f&&!(n.Common.IsEmpty(f.id)&&n.Common.IsEmpty(u)||f.id===u);e.push({pageName:c,bindingInfo:h,value:u,isEditedAutoID:l?!0:undefined})}return e},r.prototype.getBindingValue=function(t){var i=this._cellBindingRef.getRelatedCellIdsByBindingInfo(t),r=i.length;return r===0?null:n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(i[r-1])},r.prototype.getBindingInfos=function(n){var e=[],r,s,t,i,u,h,y,f,c,p;this._cellBindingRef.getBindingInfos().filter(function(t){return t.bindingInfo.TableName===n}).forEach(function(n){return e.push(n)});this._backgroundImageBindingRef.getBindingInfos().filter(function(t){return t.bindingInfo.TableName===n}).forEach(function(n){return e.push(n)});var l={},o=[],a=[],v={};for(r=0,s=e;r<s.length;r++)t=s[r],i=l[t.pageName],v[t.bindingInfo.GUID]=t.bindingInfo,i||(i=[],l[t.pageName]=i,o.push({pageName:t.pageName,bindingInfos:i})),i.push(t.bindingInfo.GUID);for(u=0,h=o;u<h.length;u++)for(y=h[u],f=0,c=y.bindingInfos;f<c.length;f++)p=c[f],a.push(v[p]);return{pageBindingInfo:o,bindingInfos:a}},r.reloadData=function(n,t){n&&(n=n.toLowerCase());t&&(r.reloadListviewData(n),r.reloadNormalCells(n));r.clearDataCache(n,t)},r.reloadListviewData=function(t){for(var o=n.ListviewBase.getAllListviews(),r=0,u=o;r<u.length;r++){var i=u[r],f=i.getDataTableName(),e=i.getMasterDataTableName();(n.Common.IsEmpty(t)||f&&f.toLowerCase()===t||e&&e.toLowerCase()===t)&&i.fillData(null,n.Common.IsEmpty(t));n.Common.IsEmpty(t)&&i.needQueryData()||i.reloadItemsEditor(t)}},r.reloadNormalCells=function(t){for(var i,f=n.ForguncyData.pageInfo.currentRowInfoCollection.list,r=0,u=f;r<u.length;r++)i=u[r],(n.Common.IsEmpty(t)||i.currentTable&&i.currentTable.toLowerCase()===t)&&n.ForguncyData.pageInfo.normalCellBindingManager.getBindingValuesFromServer(i.currentTable,i.query)},r.clearDataCache=function(t,i){r.updateTableDataCacheForCombo(t,i);n.clearGetTableDataByConditionCache();r.reloadItemsCellType(t,!0,i);n.CustomFunction.ODataFunction.clearCache(t)},r.updateTableDataCacheForCombo=function(t,i){i&&n.TableColumnsCacheManager.updateCache(t)},r.reloadItemsCellType=function(n,t,i){n&&(n=n.toLowerCase());r.reloadItemsCellTypeForNormalCell(n,i);r.reloadItemsCellTypeInListview(n,t,i)},r.reloadItemsCellTypeForNormalCell=function(t,i){for(var h,c,f,l,e,a,u,y=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(),o=[],s=0,v=y;s<v.length;s++)(h=v[s],h.cellType)&&(u=h.cellType,c=u.getBindingTables(),c)&&r.needReloadCellType(t,c)&&o.push(u);for(f=0,l=o;f<l.length;f++)u=l[f],u.preReload();if(i)for(e=0,a=o;e<a.length;e++)u=a[e],u.reload()},r.reloadItemsCellTypeInListview=function(t,i,r){var e,u,f,o;if(r&&!i)for(e=n.ListviewBase.getAllListviews(),u=0,f=e;u<f.length;u++)o=f[u],o.reloadItemsEditor(t)},r.needReloadCellType=function(t,i){var r,u,f;if(n.Common.IsEmpty(t))return!0;for(r=0,u=i;r<u.length;r++)if(f=u[r],!n.Common.IsEmpty(f)&&f.toLowerCase()===t)return!0;return!1},r}();n.NormalCellBindingManager=r})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var e=function(){function i(u,f){var e=this;this._currentRowInfoCollection=u;this.restoring=!1;this._cellsNeedExcuteCommandWhenValueChanged=[];this._dataModel=f.normalCellDataModel;this.cells=new t(this._dataModel);this._wholeModel=f;f.bind("valuechanged",this,function(n,t){e._onValueChangedInDataModel(t)});this.listviewCollection=new n.ListviewCollection;this.backgroundImages=new r;this._currentRowInfoCollection.bind("currentrowinfochanged",this,i._onCurrentRowInfoChanged)}return Object.defineProperty(i.prototype,"chartCollection",{get:function(){return n.ChartCollection?(this._chartCollection||(this._chartCollection=new n.ChartCollection(this._wholeModel)),this._chartCollection):null},enumerable:!1,configurable:!0}),i._getChangeType=function(n){switch(n){case 2:return"binding";case 4:return"formula";case 3:return"passValue";case 5:return"command";case 6:return"userInput";case 7:return"other"}},i.prototype._onValueChangedInDataModel=function(t){var i=n.ListviewBase.getListviewByCalcSheetName(t.calcName);i?this._onListviewValueChangedInDataModel(i,t.arg):this._onNormalCellValueChangedInDataModel(t)},i.prototype._onListviewValueChangedInDataModel=function(t,r){var f,e,u;if(t.getCellTypeByColIndex&&r.actionType===3&&r.valueType!==2&&r.cellRange.RowCount===1&&r.cellRange.ColumnCount===1&&(e=t.getCalcSheetName(),u=t.getCellTypeByColIndex(r.cellRange.Column),(f=u===null||u===void 0?void 0:u.CellElement)===null||f===void 0?void 0:f.CellType)){var s=u.CellElement.CellType,h=s.CommandList,l=s.CommandExcuteKind;if(h&&l===1){var a=h.map(function(t){var i,u=n.Common.clone(t);return u.formulaListRowInfo=(i={},i[e]=r.cellRange.Row,i),u}),c=t.getVisibleColumnIndexInListViewByDataIndex(r.cellRange.Column),o=t.listviewData.visibleColumns[c];n.ForguncyData.commandExcutor.excuteCommand(a,{runTimePageName:u.runTimePageName,commandTrigger:u,commandID:e+"_"+r.cellRange.Row+"_"+r.cellRange.Column,eventType:"valuechanged",initParams:{valueChangedReason:i._getChangeType(r.valueType),valueChangedRowIndex:r.cellRange.Row},locationString:n.FormulaHelper.getListviewCellLogLocationString(r.cellRange.Row,c,o===null||o===void 0?void 0:o.getName(),t.getListviewName(),t.runTimePageName)})}}},i.prototype._onNormalCellValueChangedInDataModel=function(t){var u=t.arg,r=this.cells.getCell(u.id),s,e,f,o;if(r!==null&&(s=this._dataModel.getValue(r.id),r.setValue(s),r.bindingInfo&&!r.bindingInfo.RelationBinding&&this._dataModel.getValueType(u.id)!==2&&this._changeMasterValueOfDetailTable(r.bindingInfo,u.newValue),r.ownerContainer&&r.ownerContainer.ownerCell&&r.templateCellSource))if(r.isUserControlTwoWayBindingCell())this._dataModel.setValue(r.ownerContainer.ownerCell.id,{newValue:u.newValue,uiAction:t.arg.uiAction},u.valueType);else if(e=r.ownerContainer.ownerCell.cellType,e instanceof n.UserControlPageCellType)e.onPropertyChanged(r.templateCellSource,u.newValue,u.uiAction,u.valueType);if(u.valueType!==1)for(f=0;f<this._cellsNeedExcuteCommandWhenValueChanged.length;f++)(o=this._cellsNeedExcuteCommandWhenValueChanged[f],o.id===u.id)&&function(t){n.ForguncyData.commandExcutor.excuteCommand(t.commands,{runTimePageName:t.runTimePageName,commandTrigger:t.cellType,commandID:t.id,eventType:"valuechanged",callbackOnCommandCompleted:function(){t.cellType.initValueWhenTriggerValueChangedCommand()},initParams:{valueChangedReason:i._getChangeType(u.valueType)},locationString:n.FormulaHelper.getCellLogLocationString(t.id,t.name,t.runTimePageName)})}(o);else(r===null||r===void 0?void 0:r.cellType)&&r.cellType.initValueWhenTriggerValueChangedCommand()},i.prototype.addValueChangedCommandCell=function(n){n.cellType.initValueWhenTriggerValueChangedCommand();this._cellsNeedExcuteCommandWhenValueChanged.push(n)},i.prototype._changeMasterValueOfDetailTable=function(t,i){for(var f=n.ListviewBase.getAllListviews(),s=f.length,r=0;r<s;r++){var u=f[r],e=u.getMasterDataTableName(),o=u.getColumnOfMasterTable();e&&o&&e===t.TableName&&o===t.ColumnName&&u.masterValueChanged(i)}},i._onCurrentRowInfoChanged=function(n,t){var u=n.data,r,f,i;for(u.saveContext(),r=u.cells.getAllCells(),f=r.length,i=0;i<f;i++)r[i].onCurrentRowInfoChanged(t.rowInfo.currentTable)},i.prototype.setPrePageContext=function(t){var s=this.getStoredContext(),f,r,u,h,e,c,l,o,a,v,p,w,y,i;if((t===null||t===void 0?void 0:t.ignoreCurrentRowInfoInStoredContext)&&s&&(s.currentRowInfoList=null),t=this.mergeStoredContextToPageContext(t,s),t){if(t.currentRowInfoList)for(f=0;f<t.currentRowInfoList.length;f++){if(r=t.currentRowInfoList[f],u=t.loadBindingDataOption===1,t.loadBindingDataOption===undefined||t.loadBindingDataOption===0)for(u=!0,h=this.cells.getAllCells(),e=0;e<h.length;e++)if(c=h[e],c.commands){for(l=n.Common.enumAllCommandsMetaData(c.commands),o=0;o<l.length;o++)if(a=l[o],a.$type==="Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon"&&(v=a,v.UpdateType==="add"&&v.TableName===r.currentTable)){u=!1;break}if(!u)break}if(u){if(n.Common.isProcessView(r.currentTable)&&(p=n.ForguncyData.pageInfo.pageName,!n.Common.isPageContainsTableBinding(p,r.currentTable)&&(w=this.cells.getAllCells().some(function(n){var t,i,r;return((r=(i=(t=n.cellType)===null||t===void 0?void 0:t.cellTypeData)===null||i===void 0?void 0:i.metaData)===null||r===void 0?void 0:r.$type)==="Forguncy.ProcessPanelCellType, ServerDesignerCommon"}),!w)))continue;n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(r,!0)}}if(t.querys)for(y in t.querys)n.ForguncyData.pageInfo.commandQuerys[y]=t.querys[y];if(t.sortInfoCache)for(i in t.sortInfoCache)n.ForguncyData.pageInfo.sortInfoCache[i]=t.sortInfoCache[i];if(t.columnFilterQueryCache)for(i in t.columnFilterQueryCache)n.ForguncyData.pageInfo.columnFilterQueryCache[i]=t.columnFilterQueryCache[i]}},i.prototype.initPassedValues=function(t,i){var o,u,r,f,a,e,l;if(t)for(o=0;o<t.length;o++)if(u=t[o],r=this.getTargetCellSiteOfPassValue(u),r)if(f=n.Common.getLocatedListview(r.runTimePageName,r.Row,r.Column),f)if(i){var s=f.getListDataModel(),h=u.TargetCell.Column-f.getRangeInfo().Column,c=s.getCurrentRowIndex();c>=0&&c<s.getRowCount()&&h>=0&&s.setValue(c,h,u.Source,3)}else{var v=f.getListDataModel(),h=u.TargetCell.Column-f.getRangeInfo().Column,w=v.getRowCount(),y=u.Source,p=0;for(e=0;e<w;e++)if(l=v.getValue(e,h),!n.Common.IsEmpty(l)&&!n.Common.IsEmpty(y)&&l.toString()===y.toString()){p=e;break}f.selectRow(p)}else try{a=n.Common.getIdStr(r.Row,r.Column,r.runTimePageName);this._dataModel.setValue(a,{newValue:u.Source},3)}catch(b){}},i.prototype.initPluginPassValue=function(){var u=n.MetadataLoader.GetUrlQuery("fgc_passvalue",!1),t,i,r;if(u){t=JSON.parse(u,n.Common.dateReviver);for(i in t)try{r=n.Page.getCell(i);r&&r.setValue(t[i])}catch(f){continue}}},i.prototype.getTargetCellSiteOfPassValue=function(t){var r,i;return t.TargetCell.Row>=0&&t.TargetCell.Column>=0?{Row:t.TargetCell.Row,Column:t.TargetCell.Column,runTimePageName:n.Common.IsEmpty(t.TargetRunTimePageName)?n.StaticValues.RunTimeNormalPage:t.TargetRunTimePageName}:t.TargetCell.Name?(r=this.cells.getCellByName(t.TargetCell.Name,!0),!r)?null:(i=n.Common.parseIDStr(r.id),{Row:i.row,Column:i.col,runTimePageName:i.suffix}):null},i.prototype.saveContext=function(){this.restoring||this.saveContextInternal(this.getCurrentPageContext())},i.prototype.getCurrentPageContext=function(){var t={};return t.currentRowInfoList=n.ForguncyData.pageInfo.currentRowInfoCollection.list,t.pageName=n.ForguncyData.pageInfo.pageName,t.querys=n.ForguncyData.pageInfo.commandQuerys,t.sortInfoCache=n.ForguncyData.pageInfo.sortInfoCache,t.columnFilterQueryCache=n.ForguncyData.pageInfo.columnFilterQueryCache,t.historyIndex=n.ForguncyData.historyIndex,t},i.prototype.saveContextInternal=function(t){n.ForguncyData.PageContext||(n.ForguncyData.PageContext={});n.ForguncyData.PageContext[t.pageName]=t},i.prototype.getStoredContext=function(t){this.restoring=!0;try{return(t||(t=n.ForguncyData.pageInfo.pageName),n.ForguncyData.PageContext)?n.ForguncyData.PageContext[t]:null}catch(i){return null}finally{this.restoring=!1}},i.prototype.mergeStoredContextToPageContext=function(n,t){var r,f,u,i;if(!t)return n;if(n||(n={}),n.currentRowInfoList){if(t.currentRowInfoList)for(r=0;r<t.currentRowInfoList.length;r++)f=t.currentRowInfoList[r],this.containsTable(f.currentTable,n.currentRowInfoList)||n.currentRowInfoList.unshift(f)}else n.currentRowInfoList=t.currentRowInfoList;if(t.querys){n.querys||(n.querys={});for(u in t.querys)n.querys[u]||(n.querys[u]=t.querys[u])}if(t.sortInfoCache){n.sortInfoCache||(n.sortInfoCache={});for(i in t.sortInfoCache)n.sortInfoCache[i]||(n.sortInfoCache[i]=t.sortInfoCache[i])}if(t.columnFilterQueryCache){n.columnFilterQueryCache||(n.columnFilterQueryCache={});for(i in t.columnFilterQueryCache)n.columnFilterQueryCache[i]||(n.columnFilterQueryCache[i]=t.columnFilterQueryCache[i])}return n},i.prototype.containsTable=function(n,t){for(var r,i=0;i<t.length;i++)if(r=t[i],r.currentTable===n)return!0;return!1},i.prototype.cleanQuaryCookie=function(t){if(t===n.ForguncyData.pageInfo.pageName)n.ForguncyData.pageInfo.commandQuerys={},n.ForguncyData.pageInfo.sortInfoCache={},n.ForguncyData.pageInfo.columnFilterQueryCache={},this.saveContext();else{var i=this.getStoredContext(t);i&&(i.querys={},i.sortInfoCache={},i.columnFilterQueryCache={},this.saveContextInternal(i))}},i.prototype.initCellDefaultValue=function(n){for(var r,i=this.cells.getAllCells(n),t=0;t<i.length;t++)i[t]&&!this._dataModel.hasValue(i[t].id)&&(r=i[t].getDefaultValue(),r!==undefined&&this._dataModel.setValue(i[t].id,{newValue:r},1))},i.prototype.initUserControlDefaultValues=function(t){var i,f,h,r,e,o,u,s;if(t&&t.templateSourceDefaultValue&&t.subPages){for(i=0,f=t.subPages;i<f.length;i++)for(h=f[i],r=0,e=h.childrens;r<e.length;r++)o=e[r],u=o.templateCellSource,u&&!n.Common.IsEmpty(t.templateSourceDefaultValue[u])&&this._dataModel.setValue(o.id,{newValue:t.templateSourceDefaultValue[u]},1);for(s in t.templateSourceDefaultValue)t.userControlCellType.onPropertyChanged(s,t.templateSourceDefaultValue[s],!1,1)}},i.prototype.onDefaultDataSetted=function(n){var t=this;t.chartCollection&&t.chartCollection.initChart(n);t.cells.getAllCells(n).forEach(function(n){if(n.repaint(),n.cellType&&n.cellType.CellElement&&n.cellType.CellElement.CellType){var i=n.cellType.CellElement.CellType;i&&i.CommandList&&i.CommandList.length>0&&i.CommandExcuteKind===1&&t.addValueChangedCommandCell(n)}});t.listviewCollection.onDefaultDataSetted(n)},i.prototype.destoryRunTimePage=function(t){this.chartCollection&&this.chartCollection.destoryRunTimePage(t);this._cellsNeedExcuteCommandWhenValueChanged=this._cellsNeedExcuteCommandWhenValueChanged.filter(function(n){return t.indexOf(n.runTimePageName)===-1});this.cells.destoryRunTimePage(t);this.listviewCollection.destroy(t);this.backgroundImages.destroy(t);t.forEach(function(t){return delete n.ForguncyData.pageInfo.pageStretchInfos[t]});t.forEach(function(t){return delete n.ForguncyData.pageInfo.pageLayouts[t]})},i.prototype.destroy=function(){this.cells.destroy();this.chartCollection&&this.chartCollection.destroy();this.listviewCollection.destroy();this.backgroundImages.destroy()},i.prototype.resizePageElements=function(n,t){if(t===void 0&&(t=!1),this.cells.getAllCells(n).forEach(function(n){return n.cellType&&n.cellType.onWindowResized()}),this.listviewCollection.getListviews(n).forEach(function(n){return n.onWindowResized(t)}),this.chartCollection)this.chartCollection.onWindowResized(n,t)},i.prototype.getRepeaterCellOfListview=function(){return this.cells.getAllContainerCells().filter(function(t){return t.cellType instanceof n.RepeaterCellType}).map(function(n){return n.cellType})},i}(),u,t,i,r,f;n.PageElementManager=e;u=function(){function t(t,i,r,u,f){var o,e;if(this.id=r,this.runTimePageName=u,this.designerPageName=f,this._suspendPaintCount=0,this._value=null,o=this,this.row=t.Row,this.column=t.Column,this.layout=t.Layout,this._defaultFormula=t.DefaultFormula,this._defaultValue=t.Value,this.styleInfo={styleInfo:n.Common.clone(t.StyleInfo),isDisabled:!1,isInvisible:!1,isReadOnly:!1},this.conditionalFormattingInfo=t.ConditionalFormattingMetadata,i===0&&this.conditionalFormattingInfo&&this.conditionalFormattingInfo.DependenceCells&&this.conditionalFormattingInfo.DependenceCells.length>0&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(this.conditionalFormattingInfo.DependenceCells,function(){o.repaint()},this.runTimePageName),t.Name&&t.Name.length>0)for(this.name=t.Name,this.lowerCaseName=[],e=0;e<this.name.length;e++)this.lowerCaseName.push(this.name[e].toLowerCase());else this.name=null,this.lowerCaseName=null;this.bindingInfo=t.BindingInfo;this.formatString=t.StyleInfo.Formatter;this.templateCellSource=t.TemplateCellSource;t.CellType&&(this.commands=t.CellType.CommandList);t.CellType&&t.CellType.ForguncyAttribute&&(this.forguncyattr=t.CellType.ForguncyAttribute);this.cellType=n.CellTypeHelper.getCellType(t,i,this.id,this);this.cellType.Name=this.name}return t.prototype.getDefaultFormula=function(){if(this.cellType){var t=this.cellType.getDefaultValue();if(!n.Common.IsEmpty(t)&&typeof t.Value=="string"&&t.Value.length>0&&t.Value[0]==="=")return t.Value}return this._defaultFormula},t.prototype.getDefaultValue=function(){var i=this._defaultValue,t;return this.cellType&&(t=this.cellType.getDefaultValue(),!n.Common.IsEmpty(t)&&typeof t.Value!="undefined"&&!(typeof t.Value=="string"&&t.Value.length>0&&t.Value[0]==="=")&&(i=t.Value,i===null))?null:(i=n.Common.convertMetaDataDefaultValue(i,this.runTimePageName),i===null?undefined:i)},t.prototype.suspendPaint=function(){this._suspendPaintCount++},t.prototype.resumePaint=function(){var t=this;this._suspendPaintCount--;this._suspendPaintCount===0&&n.DelayRefresh.Push(this,function(){t.cellType.setValue(t._value);t.repaint()},"repaint_"+this.id)},t.prototype.setValue=function(t){if(this.cellType&&!this.cellType.hasDestroyed){var i=this;i._value=t;i.updateActualStyleInfo();this._suspendPaintCount===0&&n.DelayRefresh.Push(i,function(){i.cellType.setValue(t);i.repaint()},"setCellValue"+i.id)}},t.prototype.onCurrentRowInfoChanged=function(n){if(this.cellType&&!this.cellType.hasDestroyed)this.cellType.onCurrentRowInfoChanged(n)},t.prototype.repaint=function(){!this.cellType||this.cellType.hasDestroyed||this._suspendPaintCount>0||(this.cellType.applyTemplateStyle(),this.updateActualStyleInfo(),this.cellType.setBackColor(this.actualStyleInfo.styleInfo.Background),this.cellType.setFontStyle(this.actualStyleInfo.styleInfo),this.cellType.setFormatString(this.actualStyleInfo.styleInfo.Formatter),this.actualStyleInfo.isDisabled?this.cellType.disable():this.cellType.enable(),this.cellType.setVisible(!this.actualStyleInfo.isInvisible),this.cellType.setReadOnly(this.actualStyleInfo.isReadOnly))},t.prototype.updateActualStyleInfo=function(){this.actualStyleInfo=i.getActualStyleInfo(this.id,this.conditionalFormattingInfo?this.conditionalFormattingInfo.Rules:null,this.styleInfo)},t.prototype.setBackColor=function(n){this.styleInfo.styleInfo.Background!==n&&(this.styleInfo.styleInfo.Background=n,this.repaint())},t.prototype.setForeColor=function(t){t=n.ColorHelper.Convert(t);this.styleInfo.styleInfo.Foreground!==t&&(this.styleInfo.styleInfo.Foreground=t,this.repaint())},t.prototype.setVisible=function(n){n&&(n+"").toLowerCase()==="false"&&(n=!1);this.styleInfo.isInvisible!==!n&&(this.styleInfo.isInvisible=!n,this.repaint())},t.prototype.enable=function(){this.styleInfo.isDisabled!==!1&&(this.styleInfo.isDisabled=!1,this.repaint())},t.prototype.disable=function(){this.styleInfo.isDisabled!==!0&&(this.styleInfo.isDisabled=!0,this.repaint())},t.prototype.setReadOnly=function(n){n=!!n;!!this.styleInfo.isReadOnly!==n&&(this.styleInfo.isReadOnly=n,this.repaint())},t.prototype.create=function(n){this.cellType&&(this.cellType.create(n),this.styleInfo.isDisabled=this.cellType.isDisabled(),this.styleInfo.isInvisible=!this.cellType.isVisible(),this.styleInfo.isReadOnly=this.cellType.isReadOnly())},t.prototype.onLoad=function(){var t=this,i;t.cellType&&(t.cellType.onLoad(),t.cellType.CellElement)&&(i=t.cellType.CellElement.CellType,i&&i.CommandList&&i.CommandExcuteKind!==1&&t.cellType.bind("click",t.id,function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t.data);i._updateRepeaterCurrentRow();n.ForguncyData.commandExcutor.excuteCommand(i.commands,{runTimePageName:i.runTimePageName,commandTrigger:i.cellType,commandID:i.id,eventType:"click",locationString:n.FormulaHelper.getCellLogLocationString(i.id,i.name,i.runTimePageName)})}))},t.prototype.onPageLoaded=function(){var n;this._hasPagedLoaed||(this._hasPagedLoaed=!0,(n=this.cellType)===null||n===void 0?void 0:n.onPageLoaded(this.cellType.getCellTypeInfo()))},t.prototype._updateRepeaterCurrentRow=function(){var i=n.PageManager.getContainerCell(this.runTimePageName),t,r;i&&(t=i.cellType,t instanceof n.RepeaterCellType)&&(r=t.getTabIndex(this.runTimePageName),t.updateCurrentRowIndex(r))},t.prototype.destroy=function(){var t=this;t.cellType&&(t.cellType.unbindAll(),t.cellType.destroy());n.ValidationMananger.clearCache(t.id);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.clearValue(t.id)},t.prototype.setContainerInfo=function(n){this.ownerContainer=n;this.ownerContainer&&this.ownerContainer.subPageInfo&&this.ownerContainer.subPageInfo.childrens.push(this)},t.prototype.isUserControlTwoWayBindingCell=function(){return this.templateCellSource===n.UserControl_ValueBindingPropertyName},t}();n.NormalCell=u;t=function(){function t(n){this._dataModel=n;this._runTimePageNameAndCellDic={};this._cells=[];this._containerCells=[]}return t.prototype.addCell=function(t){var i=this;this._cells.push(t);t.cellType&&(t.cellType instanceof n.ContainerCellTypeBase&&this._containerCells.push(t),t.cellType.bind("valuechanged",{collection:self,cell:t},function(n,r){i._dataModel.setValue(t.id,r,6)}))},t.prototype.getCell=function(n){var i,t;if(n)for(i=this._cells.length,t=0;t<i;t++)if(this._cells[t].id===n)return this._cells[t];return null},t.prototype.getCellByName=function(n,t,i){var r=this.getCellsByName(n,t,i);return r.length>0?r[0]:null},t.prototype.getCellsByName=function(t,i,r){if(!t)return null;if(i&&(t=n.Common.getLowerCaseString(t)),t.indexOf("=")===0&&(t=t.substring(1)),t.indexOf("!")>=0)try{var u=n.FormulaHelper.parse(t);u.source=null;t=n.FormulaHelper.unparse(u)}catch(f){}return this.getAllCells(r).filter(function(n){var r=i?n.lowerCaseName:n.name;return r&&r.indexOf(t)!==-1})},t.prototype.getAllCells=function(n){var i,t,r,u;if(n){for(i={},t=0,r=n;t<r.length;t++)u=r[t],i[u]=!0;return this._cells.filter(function(n){return i[n.runTimePageName]})}return this._cells},t.prototype.getAllContainerCells=function(){return __spreadArray([],this._containerCells,!0)},t.prototype.getContainerCell=function(n){var t=this._runTimePageNameAndCellDic[n],f,i,r,u;if(!t||!t.cellType.containRunTimePage(n)){for(t=null,f=this.getAllContainerCells(),i=0,r=f;i<r.length;i++)if(u=r[i],u.cellType.containRunTimePage(n)){t=u;break}this._runTimePageNameAndCellDic[n]=t}return t},t.prototype.getForguncyattrCell=function(n){for(var i=this._cells.length,t=0;t<i;t++)if(this._cells[t].forguncyattr===n)return this._cells[t];return null},t.prototype.getValueOfForguncyattrCell=function(n){var t=this.getForguncyattrCell(n);return t?this._dataModel.getValue(t.id):null},t.prototype.setValueToForguncyattrCell=function(n,t){var i=this.getForguncyattrCell(n);if(i)return this._dataModel.setValue(i.id,{newValue:t},2)},t.prototype.destroy=function(){this._cells.forEach(function(t){return n.ValidationMananger.clearCache(t.id)});this._cells.forEach(function(n){return n.cellType&&n.cellType.destroy()})},t.prototype.destoryRunTimePage=function(n){var r,u,i,f,t;this.getAllCells(n).forEach(function(n){return n.destroy()});this._cells=this._cells.filter(function(t){return n.indexOf(t.runTimePageName)===-1});this._containerCells=this._containerCells.filter(function(t){return n.indexOf(t.runTimePageName)===-1});r=[];for(t in this._runTimePageNameAndCellDic)u=this._runTimePageNameAndCellDic[t],u&&n.indexOf(u.runTimePageName)>=0&&r.push(t);for(i=0,f=r;i<f.length;i++)t=f[i],delete this._runTimePageNameAndCellDic[t]},t.prototype.getAllRunTimePageName=function(){return Object.keys(this._runTimePageNameAndCellDic)},t}();n.NormalCellCollection=t;i=function(){function t(){}return t.getActualStyleInfo=function(n,i,r){var f,u;if(!i)return r;for(f=null,u=0;u<i.length;u++)if(t.useConditionRule(n,i[u])&&(f=t.mergeCondtionalFullStyleInfo(f,i[u].StyleInfo,i[u].IsDisabled,i[u].IsInvisible,i[u].IsReadOnly),i[u].StopIfTrue))break;return t.mergeActualFullStyleInfo(f,r)},t.useConditionRule=function(n,i){switch(i.RuleType){case 1:return t.useCellValueRule(n,i.Params);case 2:return t.useSpecificTextRule(n,i.Params);case 3:return t.useDateOccurringRule(n,i.Params);case 10:return t.useFormulaRule(n,i.Params);default:return!1}},t.useCellValueRule=function(i,r){var u=GC.Spread.Sheets.ConditionalFormatting,f=t.evaluateFormula(i,r.Value1),e=t.evaluateFormula(i,r.Value2),o=t.getCellValue(i),s=new u.NormalConditionRule(u.RuleType.cellValueRule,[],null,n.ConditionFormatRuleHelper.ConvertComparisonOperator(r.Operator),f,e),h=s.createCondition();return!!h.evaluate(null,0,0,o)},t.useSpecificTextRule=function(n,i){var r=GC.Spread.Sheets.ConditionalFormatting,u=t.evaluateFormula(n,i.Value),f=t.getCellValue(n),e=new r.NormalConditionRule(r.RuleType.specificTextRule,[],null,i.Operator,null,null,u),o=e.createCondition();return!!o.evaluate(null,0,0,f)},t.useDateOccurringRule=function(n,i){var r=t.getCellValue(n),u=new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(GC.Spread.Sheets.ConditionalFormatting.RuleType.dateOccurringRule,[],null,null,null,null,null,null,i.Operator),f=u.createCondition();return!!f.evaluate(null,0,0,r)},t.useFormulaRule=function(n,i){var r=t.evaluateFormula(n,i.Formula);return r instanceof GC.Spread.CalcEngine.CalcError?!1:!!r},t.evaluateFormula=function(t,i){var f;if(n.Common.IsEmpty(i))return i;if(!n.FormulaManager.isReady())return null;var u=n.Common.parseIDStr(t),r=u.suffix,e={runTimePageName:r,supportReferToListview:!1,nullAsException:!1,listInfo:null,rowOffset:u.row,columnOffset:u.col,isTranslatedFormula:!0};return n.FormulaManager.isFormula(i)&&(f=n.ListviewBase.getAllListviews([r]),i="="+new n.CellFormulaTranslater(r,r,f).translate(i)),n.ForguncyData.pageInfo.formulaManager.evaluateFormula(i,e)},t.getCellValue=function(t){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(t)},t.mergeCondtionalFullStyleInfo=function(i,r,u,f,e){var s={styleInfo:r,isDisabled:u,isInvisible:f,isReadOnly:e},o;return i?(o=n.Common.clone(i),n.Common.IsEmpty(o.isDisabled)&&(o.isDisabled=s.isDisabled),n.Common.IsEmpty(o.isInvisible)&&(o.isInvisible=s.isInvisible),n.Common.IsEmpty(o.isReadOnly)&&(o.isReadOnly=s.isReadOnly),o.styleInfo=t.mergeCondtionalStyleInfo(i.styleInfo,s.styleInfo),o):s},t.mergeCondtionalStyleInfo=function(t,i){if(!i)return t;if(!t)return i;var r=n.Common.clone(t);return n.Common.IsEmpty(r.Formatter)&&(r.Formatter=i.Formatter),r.FontStyle&&r.FontStyle!==n.StaticValues.Font_Normal||(r.FontStyle=i.FontStyle),r.FontWeight&&r.FontWeight!==n.StaticValues.Font_Normal||(r.FontWeight=i.FontWeight),n.Common.IsEmpty(r.Underline)&&(r.Underline=i.Underline),n.Common.IsEmpty(r.Strikethrough)&&(r.Strikethrough=i.Strikethrough),n.Common.IsEmpty(r.Foreground)&&(r.Foreground=n.ColorHelper.Convert(i.Foreground)),n.Common.IsEmpty(r.Background)&&(r.Background=n.ColorHelper.Convert(i.Background)),r},t.mergeActualFullStyleInfo=function(i,r){if(!i)return r;r||(r={});var u=n.Common.clone(r);return n.Common.IsEmpty(i.isDisabled)||(u.isDisabled=i.isDisabled),n.Common.IsEmpty(i.isInvisible)||(u.isInvisible=i.isInvisible),n.Common.IsEmpty(i.isReadOnly)||(u.isReadOnly=i.isReadOnly),u.styleInfo=t.mergeActualStyleInfo(i.styleInfo,r.styleInfo),u},t.mergeActualStyleInfo=function(i,r){var u,f,e;return i?r?(u=n.Common.clone(r),n.Common.IsEmpty(i.Formatter)||(u.Formatter=i.Formatter),f=t.getFontStyleInCondtionalStyleInfo(i),n.Common.IsEmpty(f)||(u.FontStyle=f),e=t.getFontWeightInCondtionalStyleInfo(i),n.Common.IsEmpty(e)||(u.FontWeight=e),n.Common.IsEmpty(i.Underline)||(u.Underline=i.Underline),n.Common.IsEmpty(i.Strikethrough)||(u.Strikethrough=i.Strikethrough),n.Common.IsEmpty(i.Foreground)||(u.Foreground=n.ColorHelper.Convert(i.Foreground)),n.Common.IsEmpty(i.Background)||(u.Background=n.ColorHelper.Convert(i.Background)),u):i:r},t.getFontStyleInCondtionalStyleInfo=function(t){return n.Common.IsEmpty(t.FontStyle)||t.FontStyle===n.StaticValues.Font_Normal?n.Common.IsEmpty(t.FontWeight)||t.FontWeight===n.StaticValues.Font_Normal?null:n.StaticValues.Font_Normal:t.FontStyle},t.getFontWeightInCondtionalStyleInfo=function(t){return n.Common.IsEmpty(t.FontWeight)||t.FontWeight===n.StaticValues.Font_Normal?n.Common.IsEmpty(t.FontStyle)||t.FontStyle===n.StaticValues.Font_Normal?null:n.StaticValues.Font_Normal:t.FontWeight},t}();n.CondtionalFormattingHelper=i;r=function(){function n(){this.index=0;this.list=[]}return n.prototype.addBackgroundImage=function(n){return n.id=this.getId(),this.list.push(n),n.id},n.prototype.getId=function(){return"bkg_"+ ++this.index},n.prototype.destroy=function(n){n===void 0&&(n=null);this.getBackgroundImages(n).forEach(function(n){return n.destroy()});this.list=n?this.list.filter(function(t){return n.indexOf(t.runTimePageName)===-1}):[]},n.prototype.getBackgroundImages=function(n){return n===void 0&&(n=null),this.list.filter(function(t){return!n||n.indexOf(t.runTimePageName)!==-1})},n}();n.BackgroundImageCollection=r;f=function(){function t(n,t,i,r,u){this.runTimePageName=n;this.designerPageName=t;this._pageID=i;this._imageElement=r;this.name=u.DisplayName;this.initPictureValue(u);this._originalImage=this._imageElement.css("background-image")}return t.prototype.initPictureValue=function(n){if(n.PictureValue){var t=n.PictureValue;this.initPictureValueWhenRelatedColumn(t)||this.initPictureValueWhenBindingInfo(t)||this.initPictureValueWhenCellLocation(t)}},t.prototype.initPictureValueWhenRelatedColumn=function(n){return typeof n=="string"?(this.relatedColumn=n,!0):!1},t.prototype.initPictureValueWhenBindingInfo=function(n){return n.TableName?(this.bindingInfo=n,!0):!1},t.prototype.initPictureValueWhenCellLocation=function(t){var i=this,u=t.Name,f=t.Row,e=t.Column,r=[];return(n.Common.IsEmpty(u)?n.Common.IsEmpty(f)||n.Common.IsEmpty(e)||(r.push({Row:f,Column:e,RowCount:1,ColumnCount:1}),this._cellID=n.Common.getIdStr(f,e,this.runTimePageName)):r.push(u),r.length===0)?!1:(n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(r,function(){var t,r;(i._cellID||(i._cellID=(t=n.ForguncyData.pageInfo.pageElementManager.cells.getCellByName(u,!1))===null||t===void 0?void 0:t.id),i._cellID)&&(r=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(i._cellID),i.changePicture(r))},this.runTimePageName),!0)},t.prototype.changePicture=function(t){if(n.Common.IsEmpty(t))this._imageElement.css("background-image",this._originalImage);else{var i=n.ImageHelper.getImageUrl(t);this._imageElement.css("background-image",'url("'+i+'")');this._imageElement.css("font-size","0")}},t.prototype.destroy=function(){this._imageElement=null},t}();n.BackgroundImageItem=f})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function t(){}return t.validateCell=function(i){var f,e,o,s,h,u=t.validateRules(i),r,c;switch(u.result){case 0:((e=(f=i===null||i===void 0?void 0:i.CellElement)===null||f===void 0?void 0:f.DataValidation)===null||e===void 0?void 0:e.ErrorTo)===1?n.FormulaHelper.setValueToCellLocation(null,i.CellElement.DataValidation.ErrorToTargetCell,7,i.getDefaultFormulaCalcInfo(),!1):n.ValidationTooltipHelper.destroyTooltip(i.getContainer());break;case 1:r=i.getContainer();((o=r===null||r===void 0?void 0:r.parents("#pagesContainer"))===null||o===void 0?void 0:o.length)===1&&(((h=(s=i===null||i===void 0?void 0:i.CellElement)===null||s===void 0?void 0:s.DataValidation)===null||h===void 0?void 0:h.ErrorTo)===1?n.FormulaHelper.setValueToCellLocation(u.message,i.CellElement.DataValidation.ErrorToTargetCell,7,i.getDefaultFormulaCalcInfo(),!1):(c=r[0],n.ValidationTooltipHelper.showTooltip(c,u.message)));break;case 2:n.DelayOperateHelper.Push(null,function(){t.validateCell(i)},1)}return u.result},t.validateRules=function(n){var r=n.getValidationRules();if(!r)return{result:0};var f=n.getValue(!1),e=n.getValue(!0),u=null,i=0;return r.every(function(r){var o=t.getValidator(r);i=o.validate(f,e,n.ID,n.runTimePageName);switch(i){case 0:return!0;case 1:return u=o.getErrorMessage(),!1;case 2:return!1}}),{result:i,message:u}},t.getValidator=function(t){switch(t.Type){case 0:return new n.DataValidator(t.Param);case 1:return new n.UniqueValidator(t.Param)}},t.validateAllCells=function(i,r){if(i===void 0&&(i=!0),r===void 0&&(r=null),!n.ForguncyData.pageInfo.pageElementManager)return 0;var u=null,f=!1;return n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(r).map(function(n){return n.cellType}).filter(function(n){return!!n}).forEach(function(n){switch(t.validateCell(n)){case 1:u||(u=n);break;case 2:f=!0}}),f?2:u?(i&&t.showAndFocusCell(u),1):0},t.showAndFocusCell=function(t){n.Common.scrollToElement(t.getContainer(),t.runTimePageName);n.DelayRefresh.setTimeout(function(){t.setFocus()},400)},t.clearCache=function(t){delete n.UniqueValidator.cache[t]},t.validateDataValidation=function(t,i,r,u){if(u===void 0&&(u=null),!t||!t.DataValidation)return null;var f=new n.DataValidator({dataValidationInfo:t.DataValidation},u);return f.validate(i,i,null,r)===0?null:f.getErrorMessage()},t.validateRepeaterCells=function(i,r){var f=n.ForguncyData.pageInfo.pageElementManager.getRepeaterCellOfListview(i),u=[];return f.forEach(function(n){return u=u.concat(n.getAllRunTimePageNames())}),u.length>0?t.validateAllCells(r,u):0},t}(),t;n.ValidationMananger=i;t=function(){function n(){}return n.createValidationRules=function(t,i){var r=[n.getUniqueRule(t,i),n.getDataValidationRule(t)].filter(function(n){return!!n});return r.length===0?null:r},n.getUniqueRule=function(n,t){var r,u,f,i;if(t||(r=n&&n.CellType&&n.CellType.Validators,!r))return null;for(u=0;u<r.length;u++)if((f=r[u],f.$type.indexOf("UniqueValidadator")!==-1)&&(i=n.BindingInfo,typeof i!="undefined"&&typeof i.TableName!="undefined"&&typeof i.ColumnName!="undefined"&&typeof i.RelationBinding=="undefined"))return{Type:1,Param:{table:i.TableName,column:i.ColumnName}};return null},n.getDataValidationRule=function(n){return!n||!n.DataValidation?null:{Type:0,Param:{dataValidationInfo:n.DataValidation}}},n}();n.ValidateRuleCreator=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(n){this._param=n}return t.prototype.validate=function(i,r,u){var f,e,o;return n.Common.IsEmpty(r)?0:(f=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getBindingValue(u),!n.Common.IsEmpty(f)&&(f===r||f+""==r+""))?0:(e=t.cache[u],e&&e.value===r)?e.unique:(t.cache[u]={value:r,unique:2},o={table:this._param.table,column:this._param.column,value:r},n.Common.forguncyPost("Home/CheckDatabase",o,function(n){t.cache[u]&&(t.cache[u].unique=n?0:1)},u+" CheckDatabase"),2)},t.prototype.getErrorMessage=function(){return n.RS.unique},t.cache={},t}();n.UniqueValidator=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function i(n,t){t===void 0&&(t=null);this._param=n;this._listInfo=t}return i.prototype.validate=function(n,i,r,u){return t.IsValidValue(this._param.dataValidationInfo,n,u,this._listInfo)?0:1},i.prototype.getErrorMessage=function(){var i=this._param.dataValidationInfo,t;if(!n.Common.IsEmpty(i.ErrorMessage))return i.ErrorMessage;n.Common.IsEmpty(i.NumberType)&&(i.NumberType=0);switch(i.NumberType){case 0:t=n.RS.DataValidation_Required;break;case 1:t=n.RS.DataValidation_WholeNumberDefaultErrorMessage;break;case 2:t=n.RS.DataValidation_DecimalDefaultErrorMessage;break;case 4:t=n.RS.DataValidation_DateDefaultErrorMessage;break;case 5:t=n.RS.DataValidation_TimeDefaultErrorMessage;break;case 6:t=n.RS.DataValidation_TextLenghtDefaultErrorMessage;break;case 7:t=n.RS.DataValidation_CustomDefaultErrorMessage;break;case 8:t=n.Common.IsEmpty(i.SelectedDefaultRegularExpression)?n.RS.DataValidation_RegularUserInputDefaultErrorMessage:n.Common.format(n.RS.DataValidation_RegularDefaultErrorMessage,i.SelectedDefaultRegularExpression)}return t},i.isValid=function(t,r,u){return u===void 0&&(u=n.StaticValues.RunTimeNormalPage),new i({dataValidationInfo:t}).validate(r,r,null,u)===0},i}(),t;n.DataValidator=i;t=function(){function t(){}return t.IsValidValueByDataValidationInfo=function(t,i){if(!this.IsValidDataValidationInfo(t))return!0;if(t.NumberType===undefined&&(t.NumberType=0),this.EnsureDatavalidationValue(t),n.Common.IsEmpty(i)){if(t.IgnoreBlank===!0)return!0;if(t.NumberType!==7&&t.NumberType!==8&&t.NumberType!==6)return!1}switch(t.NumberType){case 0:return this.AnyValueValidator(t,i);case 1:return this.WholeNumberValidator(t,i);case 2:return this.DecimalValidator(t,i);case 3:return this.ListValidator(t,i);case 4:return this.DateValidator(t,i);case 5:return this.TimeValidator(t,i);case 6:return this.TextLengthValidator(t,i);case 7:return this.CustomValidator(t,i);case 8:return this.RegularValidator(t,i);default:return!0}},t.IsValidValue=function(n,t,i,r){return r===void 0&&(r=null),this.runTimePageName=i,this.listInfo=r,this.IsValidValueByDataValidationInfo(n,t)},t.GetResultOfCompareValues=function(t,i,r,u){if(n.Common.IsEmpty(r)&&this.isValue1FromFormual&&this.needValue1||n.Common.IsEmpty(u)&&this.isValue2FromFormual&&this.needValue2)return!0;t===undefined&&(t=0);i=+i;r=n.Common.IsEmpty(i)?null:+r;u=n.Common.IsEmpty(i)?null:+u;switch(t){case 0:if(i>=r&&i<=u)return!0;break;case 1:if(i<r||i>u)return!0;break;case 2:if(i===r)return!0;break;case 3:if(i!==r)return!0;break;case 4:if(i>r)return!0;break;case 6:if(i>=r)return!0;break;case 5:if(i<r)return!0;break;case 7:if(i<=r)return!0}return!1},t.AnyValueValidator=function(){return!0},t.WholeNumberValidator=function(n,t){return $.isNumeric(t)?t%1!=0?!1:this.GetResultOfCompareValues(n.CompareParamType,t,this.value1,this.value2):!1},t.DecimalValidator=function(n,t){return $.isNumeric(t)?this.GetResultOfCompareValues(n.CompareParamType,t,this.value1,this.value2):!1},t.ListValidator=function(n,t){return this.value1.indexOf(t)===-1?!1:!0},t.DateValidator=function(t,i){if(typeof i=="number"&&(i=n.Convertor.fromOADateToDate(i)),!this.isValideDateTime(i))return!1;var f=new Date(i),r=this.value1,u=this.value2;return n.Common.IsEmpty(this.value1)||(r=!isNaN(this.value1)&&(this.isValue1FromFormual||!(this.value1 instanceof Date))?n.Convertor.fromOADateToDate(this.value1):new Date(this.value1)),n.Common.IsEmpty(this.value2)||(u=!isNaN(this.value2)&&(this.isValue2FromFormual||!(this.value2 instanceof Date))?n.Convertor.fromOADateToDate(this.value2):new Date(this.value2)),this.GetResultOfCompareValues(t.CompareParamType,f,r,u)},t.TimeValidator=function(t,i){if(typeof i=="number"&&(i>1&&(i=i-1),i=n.Convertor.fromOADateToDate(i)),!this.isValideDateTime(n.FormatHelper.getValueFromText(i)))return!1;var f=n.FormatHelper.getValueFromText(i),r=this.value1,u=this.value2;return n.Common.IsEmpty(this.value1)||(r=!isNaN(this.value1)&&(this.isValue1FromFormual||!(this.value1 instanceof Date))?n.Convertor.fromOADateToDate(this.value1):n.FormatHelper.getValueFromText(this.value1)),n.Common.IsEmpty(this.value2)||(u=!isNaN(this.value2)&&(this.isValue2FromFormual||!(this.value2 instanceof Date))?n.Convertor.fromOADateToDate(this.value2):n.FormatHelper.getValueFromText(this.value2)),this.GetResultOfCompareValues(t.CompareParamType,f,r,u)},t.RegularValidator=function(t,i){n.Common.IsEmpty(i)&&(i="");var r=RegExp(this.value1);return r.test(i)},t.IsValidDataValidationInfo=function(n){return n===null||n===undefined?!1:!0},t.isValideDateTime=function(n){var t=new Date(n);return!this.isInvalidDate(t)},t.isInvalidDate=function(n){return isNaN(n)},t.CustomValidator=function(){var n;return this.value1===0||this.value1==="0"||this.value1===!1||((n=this.value1)===null||n===void 0?void 0:n.toLowerCase())==="false"?!1:!0},t.TextLengthValidator=function(t,i){return n.Common.IsEmpty(i)&&(i=""),this.GetResultOfCompareValues(t.CompareParamType,i.toString().length,this.value1,this.value2)},t.EnsureDatavalidationValue=function(t){if(this.value1=t.FirstParamValue,this.value2=t.SecondParamValue,this.isValue1FromFormual=!1,this.isValue2FromFormual=!1,n.Common.IsEmpty(this.value1)||(this.isValue1FromFormual=n.FormulaManager.isFormula(this.value1),this.value1=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(this.value1,{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.listInfo,rowOffset:0,columnOffset:0}),this.value1 instanceof Date&&(this.value1=n.ConvertDateToOADate(this.value1)),this.value1=this.value1===null?this.value1:this.value1.toString()),n.Common.IsEmpty(this.value2)||(this.isValue2FromFormual=n.FormulaManager.isFormula(this.value2),this.value2=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(this.value2,{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.listInfo,rowOffset:0,columnOffset:0}),this.value2 instanceof Date&&(this.value2=n.ConvertDateToOADate(this.value2)),this.value2=this.value2===null?this.value2:this.value2.toString()),this.needValue1=!0,this.needValue2=!0,t.NumberType===0){this.needValue1=!1;this.needValue2=!1;return}if(t.NumberType===8||t.NumberType===7){this.needValue2=!1;return}t.CompareParamType!==0&&t.CompareParamType!==1&&(this.needValue2=!1)},t.runTimePageName=n.StaticValues.RunTimeNormalPage,t}()})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(){function n(n){this.metaData=n}return n.prototype.getEditorFormatString=function(){return null},n}(),t,r,u,f,e,o,s,h;n.CellTypeDataBase=i;t=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.getDefaultValue=function(){var t=this.metaData.DefaultValue;return n.Common.IsEmpty(t)&&(t=null),n.KeyWords.IsKeyWord(t)&&(t=n.KeyWords.GetKeyWordValue(t)),t},i.prototype.canEnterEditModeInListview=function(){return!0},i}(i);n.InputCellTypeData=t;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getDefaultValue=function(){var i=t.prototype.getDefaultValue.call(this);return n.Common.IsEmpty(i)?null:this._getDefaultDate(i)},i.prototype._getDefaultDate=function(t){var i=n.FormatHelper.getValueFromText(t);return n.DateHelper.isValidDateValue(i)?typeof i=="number"&&(i=n.Convertor.fromOADateToDate(i)):i=null,i},i.prototype.getEditorFormatString=function(){var t=this.metaData;return n.Common.IsEmpty(t.DisplayFormat)?n.Common.IsEmpty(t.DateFormat)?null:t.DateFormat:t.DisplayFormat},i}(t);n.DateCellTypeData=r;u=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),i.prototype.getDefaultValue=function(){var i=t.prototype.getDefaultValue.call(this);return n.Common.IsEmpty(i)?null:(i=n.FormatHelper.getValueFromText(i),!n.DateHelper.isValidDateValue(i))?null:(i instanceof Date&&(i=n.Convertor.fromDateToOADate(i)),typeof i!="number")?null:i},i.prototype.getEditorFormatString=function(){return n.StaticFormatString.timeDefaultFormattingString},i}(t);n.TimeCellTypeData=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(t);n.NumberCellTypeData=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return this.metaData.ShowOnlyEdit},t}(t);n.GroupCellTypeData=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return this.metaData.ShowOnlyEdit},t}(t);n.CheckBoxCellTypeData=o;s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return!1},t}(t);n.UploadImageCellTypeData=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.canEnterEditModeInListview=function(){return!1},t}(t);n.AttachmentCelltypeData=h})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var r=function(t){function r(i,r,u,f){var e=t.call(this)||this;return e.isEnabled=!0,e._isVisible=!0,e._isReadOnly=!1,e._settedValue=null,e._hasDestroyed=!1,e._pageID=n.ForguncyData.pageInfo.pageID,e.ID=u,e.CellElement=i,e.isInListview=r===1,e._isSettingValue=!1,e._isWaitingServerData=!1,e.allowSetValueByUser=!0,e.supportedEvents=[],e._dataValidationInfo=i.DataValidation,e.cellTypeData=e._getCellTypeData(e.CellElement.CellType),e.IsInMasterPage=n.PageManager.isMasterPageName(f===null||f===void 0?void 0:f.runTimePageName),e.owner=f,e}return __extends(r,t),Object.defineProperty(r.prototype,"runTimePageName",{get:function(){var n;if((n=this.owner)!==null&&n!==void 0)return n.runTimePageName},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"designerPageName",{get:function(){var n;if((n=this.owner)!==null&&n!==void 0)return n.designerPageName},enumerable:!1,configurable:!0}),r.prototype._getCellTypeData=function(t){return new n.CellTypeDataBase(t)},r.prototype.create=function(t){var e=this,f,r,u;this._containerCache=t;f=this.CellElement;f.Value=n.KeyWords.GetKeyWordValue(f.Value,this.runTimePageName,function(t,i){n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(e.ID,{newValue:t,uiAction:!0},7);e._keywordDisposeHandler=i});r=f.CellType;u=this.createContent();r&&r.IsDisabled&&(this._disable(u),this.isEnabled=!1);n.ValidationTooltipHelper.setTooltipAttr(t);this._setOverflowHidden(t);u=i.adjustDomForOverflow(u,t,f,this.runTimePageName);this._setTabIndexToDom(r,u);this._setDataValidationToDom(u);u&&(t.append(u),(r===null||r===void 0?void 0:r.IsInvisible)&&(this._setVisible(t,!1),this._isVisible=!1),r&&(r.ReadOnly||r.Readonly)&&this.setReadOnly(!0));this.applyTemplateStyle();this.refreshClickable()},r.prototype.shrinkToFit=function(t){var f=this.CellElement.StyleInfo,c=f.ShrinkToFit,l=f.WordWrap,e=f.VerticalAlignment,u,o;if(c&&!l){var a=n.CellVerticalAlignment[e].toLowerCase(),s=t[0].offsetWidth,i=t[0].offsetHeight,h=this.getContainer().width(),r=this.getContainer().height();s!==0&&h!==0&&i!==0&&r!==0&&(u=0,i>r&&(e===n.CellVerticalAlignment.Center?u=(i-r)/2:e===n.CellVerticalAlignment.Bottom&&(u=i-r)),o=parseFloat((h/s).toFixed(6)),o<1?(t.css("transform-origin","left ".concat(a)),t.css("transform","translateY(-".concat(u,"px) scale(").concat(o,")"))):(t.css("transform-origin",""),t.css("transform","")))}},r.prototype.applyTemplateStyle=function(){var n=this.getStyleTemplateHelper();n!==null&&n.ApplyTemplateStyle(this.CellElement.StyleTemplate,this._containerCache)},r.prototype.checkAuthority=function(n){var t=this.getUIPermission(n);return t?this.checkRoleAuthority(t.AllowRoles):!0},r.prototype.checkRoleAuthority=function(t){var i,r,u;return t&&(t.indexOf("FGC_Anonymous")!==-1||(i=n.Page.getUserInfo(),!n.Common.IsEmpty(i===null||i===void 0?void 0:i.UserName)&&t.indexOf("FGC_LoginUser")!==-1)||(r=[],n.Common.IsEmpty(i===null||i===void 0?void 0:i.Role)||(r=i.Role.split(",")),u=t.filter(function(n){return r.indexOf(n)!==-1}),u.length!==0))?!0:!1},r.prototype.getPermissionKey=function(){var f,e,o,u,t,i;if(!r._permissionPageCache[this.designerPageName]){if(u=this.designerPageName,!((o=(e=(f=n.ForguncyData)===null||f===void 0?void 0:f.GlobalSettings)===null||e===void 0?void 0:e.PageUIPermissions)===null||o===void 0?void 0:o[u])&&(t=n.PageManager.getContainerCell(this.runTimePageName),t&&t.cellType instanceof n.RepeaterCellType&&(i=n.PageManager.getLocatedNormalPageNames(this.runTimePageName),i&&i.length>1))){var c=i[i.length-2],s=n.Common.getA1ReferenceString(t.row,t.column,!0,!0),h=this.getCellName(t.name,t.runTimePageName);n.Common.IsEmpty(h)||(s=h);u=c+"->"+s+"->"+r.UIPermission_TemplatePageKey}r._permissionPageCache[this.designerPageName]=u}return r._permissionPageCache[this.designerPageName]},r.prototype.getUIPermission=function(t){var e,o,s,h,r,u,c,f;if(this.isInListview||(s=(o=(e=n.ForguncyData)===null||e===void 0?void 0:e.GlobalSettings)===null||o===void 0?void 0:o.PageUIPermissions,!s)||(h=this.getPermissionKey(),r=s[h],!r||!r.CellUIPermissions))return null;var a=h!==this.designerPageName,i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(this.ID),l=n.Common.getA1ReferenceString(i.row,i.column,!0,!0);return(a&&i.templateCellSource&&(l=i.templateCellSource),u=r.CellUIPermissions[l],!u&&(c=this.getCellName(i.name,i.runTimePageName),n.Common.IsEmpty(c)||(u=r.CellUIPermissions[c]),!u))?null:(f=u.filter(function(n){return n.Scope===t}),f.length===0||!f[0].Enabled)?null:f[0]},r.prototype.getCellName=function(t,i){var r,u;if(t&&t.length>0)for(r=0;r<t.length;r++)if(u=t[r],n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(u,!0,[i]).length===1)return u;return null},r.prototype.createContent=function(){return null},r.prototype.getStyleTemplateHelper=function(){return null},r.prototype.clearStyleTemplate=function(){var n=this.getStyleTemplateHelper();n!==null&&n.Clear();this.CellElement&&this.CellElement.StyleTemplate&&(this.CellElement.StyleTemplate=null)},r.prototype.clickable=function(){return!0},r.prototype._setOverflowHidden=function(n){n.css("overflow","hidden")},r.prototype._setTabIndexToDom=function(n,t){if(t&&this.shouldEnableTabIndex()){var i=t[0].tagName;i&&i.toUpperCase()==="DIV"?$("button, input, a, textarea",t).attr("tabindex",n.TabIndex):t.attr("tabindex",n.TabIndex)}},r.prototype.shouldEnableTabIndex=function(){var t,i=(t=this.CellElement)===null||t===void 0?void 0:t.CellType,r=this.runTimePageName;return i&&i.TabIndex&&(n.ForguncyData.pageInfo.enableTabIndex||{})[r]},r.prototype._setDataValidationToDom=function(t){var r,i;t&&(r=this,n.Common.IsEmpty(this._dataValidationInfo)||(t.attr("data-dataValidationInputTitle",this._dataValidationInfo.InputMessageTitle),t.attr("data-dataValidationInputMessage",this._dataValidationInfo.InputMessage),this._dataValidationInfo.ShowInputMessageWhenCellIsSelected!==!0||n.Common.IsEmpty(this._dataValidationInfo.InputMessage)||(i=null,t.focusin(function(){var t=$(this).attr("data-dataValidationInputTitle"),u=$(this).attr("data-dataValidationInputMessage"),f;n.Common.IsEmpty(t)&&n.Common.IsEmpty(u)||(n.DelayRefresh.NeedDelayRun===!0?$(".dataValidationInput").fadeToggle(function(){$(this).remove()}):$(".dataValidationInput").remove(),i=r.createInputMessageToolTip($(this),t,u),i.addClass("dataValidationInput"),f=$(this).parent().parent(),$(f).append(i),i.fadeToggle())}),t.focusout(function(){i!==null&&(n.DelayRefresh.NeedDelayRun===!0?i.fadeToggle(function(){$(this).remove()}):$(i).remove())})),this.hideValidationTooltipWhenInputOrSelect(t)))},r.prototype.createInputMessageToolTip=function(t,i,r){var f=t.parent(),u=$(document.createElement("div")),e,o;return u.addClass("fgc-input-tooltip"),u.css("top",f.position().top+f.height()),u.css("left",f.position().left+f.width()-90),e=$(document.createElement("div")),e.addClass("fgc-input-tooltip__title"),n.Common.IsEmpty(i)||e.append(i),u.append(e),o=$(document.createElement("div")),o.addClass("fgc-input-tooltip__message"),n.Common.IsEmpty(r)||o.append(r),u.append(o),u},r.prototype.hideValidationTooltipWhenInputOrSelect=function(n){var i=this,t=this;t._textCache=n.find("#"+t.ID).val();n.keyup(function(){var r=n.find("#"+t.ID);t._textCache!==r.val()&&i.hideValidateTooltip();t._textCache=r.val()})},r.prototype.hideValidateTooltip=function(){var t,i,r;((i=(t=this===null||this===void 0?void 0:this.CellElement)===null||t===void 0?void 0:t.DataValidation)===null||i===void 0?void 0:i.ErrorTo)===1?n.FormulaHelper.setValueToCellLocation(null,this.CellElement.DataValidation.ErrorToTargetCell,7,this.getDefaultFormulaCalcInfo(),!1):(r=this.getContainer().find("#"+this.ID),n.ValidationTooltipHelper.destroyTooltip(r))},r.prototype.getDefaultValue=function(){return null},r.prototype.executeCommand=function(t,i){!t||t.length<=0||n.ForguncyData.commandExcutor.excuteCommand(t,{runTimePageName:this.runTimePageName,commandTrigger:this,commandID:this.ID,eventType:"click",locationString:n.FormulaHelper.getCellLogLocationString(this.ID,this.Name,this.runTimePageName),initParams:i===null||i===void 0?void 0:i.initParams})},r.prototype.executeCustomCommandObject=function(t,i,r){(r===void 0&&(r="click"),!t||!t.Commands||t.Commands.length<=0)||n.ForguncyData.commandExcutor.excuteCommand(t.Commands,{runTimePageName:this.runTimePageName,commandTrigger:this,commandID:this.ID,eventType:r,initParams:i,locationString:n.FormulaHelper.getCellLogLocationString(this.ID,this.Name,this.runTimePageName)})},r.prototype.isCommandExecuting=function(){return n.ForguncyData.commandExcutor.isCommandExecuting(this.ID,"click")},r.prototype.onDependenceCellValueChanged=function(t){n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(this.CellElement.DependenceCells,t,this.runTimePageName)},r.prototype.hasFocus=function(){var n=$("#"+this.ID);return n.length>0&&document.activeElement===n[0]?!0:!1},r.prototype.setFocus=function(){var n=$("#"+this.ID);n.length>0&&n[0].focus()},r.prototype.setValue=function(n){if(!this._isSettingValue){this._settedValue=n;var t=$("#"+this.ID);(t.length!==1&&(t=this.getContainer()),t.length===1)&&(this._setValue(t,n),this._textCache=$("#"+this.ID).val())}},r.prototype._setValue=function(n,t){this._isWaitingServerData||(this._isSettingValue=!0,this.setValueToElement(n,t),this._isSettingValue=!1)},r.prototype.setValueToElement=function(){},r.prototype.getValue=function(t){var i=this.getValueFromElement(t);return n.Common.IsEmpty(i)?null:i},r.prototype.getValueFromElement=function(){return null},r.prototype.getValueFromDataModel=function(){if(!this.isInListview)return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID);throw"Not support in listview";},r.prototype.commitValue=function(){this._onValueChanged()},r.prototype._onValueChanged=function(){this._isSettingValue||this.trigger("valuechanged",{newValue:this.getValue(!1),uiAction:!0})},r.prototype.getFormatString=function(){var t=this.CellElement.StyleInfo.Formatter;return n.Common.IsEmpty(t)&&(t=this.cellTypeData.getEditorFormatString()),t},r.prototype.setFormatString=function(n){this.CellElement.StyleInfo.Formatter!==n&&(this.CellElement.StyleInfo.Formatter=n,this.onFormatterChanged())},r.prototype.onFormatterChanged=function(){},r.prototype.isDisabled=function(){return!this.isEnabled},r.prototype.disable=function(){this.isEnabled&&(this.isEnabled=!1,this._disable($("#"+this.ID+"_div").children()))},r.prototype._disable=function(n){n&&n.data("DisableCallback")&&n.data("DisableCallback")()},r.prototype.enable=function(){this.isEnabled||this.checkAuthority(2)&&(this.isEnabled=!0,this._enable($("#"+this.ID+"_div").children()))},r.prototype._enable=function(n){n&&n.data("EnableCallback")&&n.data("EnableCallback")()},r.prototype.setBackColor=function(t){this.CellElement.StyleInfo.Background=t;var i=this._getPartsUseBackcolor();t?i.css("background",n.ColorHelper.Convert(t)):i.css("background","")},r.prototype._getPartsUseBackcolor=function(){var n=$("#"+this.ID+"_backgrounddiv");return n.length>0?n:$("#"+this.ID+"_div")},r.prototype.adjustForeColor=function(t,i){var u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),r={value:null};return n.FormatHelper.formatValue(u,i,r),r.value&&(t=r.value),t?n.ColorHelper.Convert(t):""},r.prototype.setFontStyle=function(t){var i=this.CellElement.StyleInfo;i.FontFamily=t.FontFamily;i.FontStyle=t.FontStyle;i.FontSize=t.FontSize;i.FontWeight=t.FontWeight;i.Foreground=n.ColorHelper.Convert(t.Foreground);i.Strikethrough=t.Strikethrough;i.Underline=t.Underline;this._setFontStyle(t)},r.prototype._setFontStyle=function(t){var r=this._getPartsUseFontStyle(),i;r&&(i=n.Common.clone(t),i.Foreground=this.adjustForeColor(i.Foreground,this.getFormatString()),n.DomUtilities.setFontStyle(i,r))},r.prototype._needAdaptIosUnderlineinherit=function(t){var i,r,u;if(n.Platform.isIOSDevice()&&(r=((i=this.CellElement.StyleTemplate)===null||i===void 0?void 0:i.Styles[t])||{},u=0,Object.keys(r).forEach(function(n){r[n].Underline&&u++}),u>0))return!0},r.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID)},r.prototype.isVisible=function(){return this._isVisible},r.prototype.setVisible=function(n){var t;if((n=!!n,this._isVisible!==n)&&(!n||this.checkAuthority(1))){var i=this.ID+"_div",r=this.ID+"_backgrounddiv",u=$("#"+i).add("#"+r);this._setVisible(u,n);this._isVisible=n;this.refreshClickable();t=$("#"+this.ID+"_outerdiv");this.updataeOuterDivPointerEvents(t,n)}},r.prototype.refreshClickable=function(){var n=this.getContainer().parent();this.isVisible()&&this.clickable()?n.removeClass("fgc-penetrable"):n.addClass("fgc-penetrable")},r.prototype.updataeOuterDivPointerEvents=function(n,t){n.css("pointer-events",t?"":"none")},r.prototype._setVisible=function(t,i){var r=this._getVisibleParts(t),e,f,u;if(i)t.css("display",""),r&&(u=r.attr("olddisplay"),r.css("display",n.Common.IsEmpty(u)?"":u));else if(t.css("display","none"),r)for(e=0;e<r.length;e++)f=$(r[e]),f.attr("olddisplay")===undefined&&(u=f.css("display"),f.attr("olddisplay",u)),f.css("display","none")},r.prototype._getVisibleParts=function(){return null},r.prototype.isReadOnly=function(){return this._isReadOnly},r.prototype.setReadOnly=function(n){if(n=!!n,this._isReadOnly!==n){if(!n&&!this.checkAuthority(4))return;this._isReadOnly=n;this.updateReadOnlyStatus()}},r.prototype.updateReadOnlyStatus=function(){},r.prototype.enterPrintMode=function(){},r.prototype.quitPrintMode=function(){},r.prototype.trigger=function(i,r){this._pageID===n.ForguncyData.pageInfo.pageID&&this.isEnabled&&t.prototype.trigger.call(this,i,r)},r.prototype._startWaitingServerData=function(){this._isWaitingServerData=!0},r.prototype._endWaitingServerData=function(){this._isWaitingServerData=!1;var t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID);this.setValue(t)},r.prototype.getContainer=function(){return this._containerCache?this._containerCache:$("#"+this.ID+"_div")},r.prototype.validate=function(){n.ForguncyData.GlobalSettings&&n.ForguncyData.GlobalSettings.TriggerTime===1||n.ValidationMananger.validateCell(this)},r.prototype.validateValue=function(t,i,r){return i===void 0&&(i=null),r===void 0&&(r=!1),n.ValidationMananger.validateDataValidation(this.CellElement,t,this.runTimePageName,i)},r.prototype.getValidationRules=function(){return!this.needValidate()||!this.isEnabled||!this.isVisible()?null:(this._validationRules===undefined&&(this._validationRules=n.ValidateRuleCreator.createValidationRules(this.CellElement,this.isInListview)),this._validationRules)},r.prototype.needValidate=function(){return this.isReadOnly()?!1:!0},r.prototype.shouldCancelCommand=function(t,i){if(this._hasDestroyed)return!0;if(i==="valuechanged"){var r=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(t);if(r===this._valueOfTriggerValueChangedCommand)return!0;this._valueOfTriggerValueChangedCommand=r}return!this.checkAuthority(1)||!this.checkAuthority(2)||!this.checkAuthority(4)?!0:!1},r.prototype.initValueWhenTriggerValueChangedCommand=function(){this._valueOfTriggerValueChangedCommand=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID)},r.prototype.allowFormatValue=function(){return!0},r.prototype.onLoad=function(){this.checkAuthority(1)||this.setVisible(!1);this.checkAuthority(2)||this.disable();this.checkAuthority(4)||this.setReadOnly(!0)},r.prototype.getCellTypeInfo=function(){return{value:this._settedValue,isDisabled:this.isDisabled(),isReadOnly:this.isReadOnly(),styleData:__assign({},this.CellElement.StyleInfo)}},r.prototype.onPageLoaded=function(){},r.prototype.onCurrentRowInfoChanged=function(){},r.prototype.destroy=function(){var n;(n=this._keywordDisposeHandler)===null||n===void 0?void 0:n.call(this);this.clearStyleTemplate();this._containerCache&&this._containerCache.empty();this._containerCache=null;this._hasDestroyed=!0},Object.defineProperty(r.prototype,"hasDestroyed",{get:function(){return this._hasDestroyed},enumerable:!1,configurable:!0}),r.prototype.getValueFromListviewText=function(t,i){i===void 0&&(i=!1);var r=this.getFormatString();return n.Common.IsEmpty(r)?t:n.FormatHelper.getValueFromText(t,r)},r.prototype.getListviewNoneEditModeText=function(t,i,r,u){return u===void 0&&(u=null),r||(r=this.getFormatString()),n.FormatHelper.formatValue(t,r,i)},r.prototype.getControl=function(){return null},r.prototype.getBindingTables=function(){return this._bindingDataSourceTables},r.prototype.reload=function(){},r.prototype.preReload=function(){},r.prototype.evaluateFormula=function(t){return n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t,this.getDefaultFormulaCalcInfo())},r.prototype.setContextVariableValue=function(t,i){return n.ForguncyData.parameterManager.setValue(t,i,null)},r.prototype.clearContextVariableValue=function(t){return n.ForguncyData.parameterManager.setValue(t,undefined,null)},r.prototype.getDefaultFormulaCalcInfo=function(){return{runTimePageName:this.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:null,rowOffset:0,columnOffset:0}},r.prototype.getFormulaCalcContext=function(){return{IsInMasterPage:this.IsInMasterPage,PageID:this.runTimePageName}},r.prototype.shouldDisplayInListviewNewRow=function(){return!0},r.prototype.onWindowResized=function(){return null},r.prototype._getDomCreateInfo=function(){return{id:this.ID,isInListview:this.isInListview}},r.prototype.shouldCheckDirtyWhenLeavePage=function(){var n,t;return!!((t=(n=this.CellElement)===null||n===void 0?void 0:n.CellType)===null||t===void 0?void 0:t.ShouldCheckDirtyWhenLeavePage)},r.prototype.getExecutingGetBindingDataSourceResultKey=function(n,t){var f={},i,r,u,e;if(n.Params)for(i=0,r=n.Params;i<r.length;i++)u=r[i],f[u]=this.evaluateFormula(u);return e={CommandId:n.GUID,Params:f,options:t},JSON.stringify(e)},r.prototype.getBindingDataSourceValue=function(t,i,u){var o,s,h,e,c,l,a,f,v;if(t)if(t.GUID){if(t.TableName&&(this._bindingDataSourceTables||(this._bindingDataSourceTables=[]),this._bindingDataSourceTables.indexOf(t.TableName)<0&&this._bindingDataSourceTables.push(t.TableName)),h={},t.Params)for(e=0,c=t.Params;e<c.length;e++)l=c[e],h[l]=this.evaluateFormula(l);if(a={CommandId:t.GUID,Params:h,options:i},f=this.getExecutingGetBindingDataSourceResultKey(t,i),r._executingGetBindingDataSourceResult[f]){u(r._executingGetBindingDataSourceResult[f]);return}r._executingGetBindingDataSourceValue[f]?r._executingGetBindingDataSourceValue[f].push(u):(v=(s=(o=t.CacheSetting)===null||o===void 0?void 0:o.ExpiredTime)!==null&&s!==void 0?s:1,r._executingGetBindingDataSourceValue[f]=[u],n.Common.forguncyPost("Home/CalcBindingDataSource",a,function(n){r._executingGetBindingDataSourceResult[f]=n;setTimeout(function(){r._executingGetBindingDataSourceResult[f]=undefined},v*1e3);r._executingGetBindingDataSourceValue[f].forEach(function(t){return t&&t(n)});r._executingGetBindingDataSourceValue[f]=undefined},(t===null||t===void 0?void 0:t.GUID)+"|"+this.ID+"|"+this.runTimePageName))}else console.error("Can't find GUID in bindingDataSourceModel")},r.prototype.clearBindingDataSourceValueCache=function(n,t){var i=this.getExecutingGetBindingDataSourceResultKey(n,t);Reflect.has(r._executingGetBindingDataSourceResult,i)&&Reflect.deleteProperty(r._executingGetBindingDataSourceResult,i)},r.UIPermission_TemplatePageKey="0BD905CA-8A4D-4F75-BF5F-582F869D0E46",r._permissionPageCache={},r._executingGetBindingDataSourceValue={},r._executingGetBindingDataSourceResult={},r}(n.EventClassBase),u,f,e,t,o,s,i;n.CellTypeBase=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.updateContainerForSimplebar=function(){var t=n.ForguncyData.pageInfo.pageLayouts[this.runTimePageName],i=t.possibleAutoFitInRows(this.CellElement.Layout),r=t.possibleAutoFitInColumns(this.CellElement.Layout);i&&this.getContainer().css("height","auto");r&&this.getContainer().css("width","auto");this.getContainer().css("overflow","visible")},i}(r);n.CellTypeBaseWithSimplebar=u;f=function(){function n(){}return n}();n.FormulaListRowInfo=f;e=function(){function t(){}return t.getCellType=function(i,r,u,f){var e=t.getRegistedCellTypeCreateFunction(i);return n.Common.IsEmpty(e)&&(i.Value===n.KeyWords.CurrentUserStr&&n.Common.IsEmpty(i.BindingInfo)?(e=n.CurrentUserCellType,i.CellType={ShowUserPicture:!1,ShowDropDown:!0,$type:"Forguncy.CurrentUserCellType, ServerDesignerCommon",IsGenerateByKeyWord:!0},i.LeftOverflowSpace=undefined,i.RightOverflowSpace=undefined):e=n.GeneralCellType),new e(i,r,u,f)},t.registerCellType=function(i,r,u){typeof i!="string"||n.Common.IsEmpty(i)||typeof r=="function"&&(n.Common.IsEmpty(u)||typeof u=="function")&&(t._registedCellTypes[i]||(t._registedCellTypes[i]=[]),t._registedCellTypes[i].push({cellTypeCtor:r,match:u}))},t.getRegistedCellTypeCreateFunction=function(n){var i,r,u;if(!n||!n.CellType)return null;if(i=t._registedCellTypes[n.CellType.$type],!i||i.length<=0)return console.error("Can't finded cell type "+n.CellType.$type),null;for(r=i.length-1;r>=0;r--)if(u=i[r],!u.match||u.match(n))return u.cellTypeCtor;return null},t._registedCellTypes={},t}();n.CellTypeHelper=e;t=function(){function t(n){this.text=n}return t.prototype.toString=function(){return n.Common.IsEmpty(this.text)?"":this.text.toString()},t}();n.WrongParseResult=t;o=function(){function i(){}return i.getDisplayValue=function(i,r){var f,u;if(r instanceof t)return r.toString();if(i.UserInfo&&i.UserInfo.length>0)for(f=i.UserInfo,u=0;u<f.length;u++)if(n.Common.isEquals(r,f[u].Value))return n.Common.IsEmpty(f[u].DisplayValue)?"":f[u].DisplayValue.toString();if(i.ItemsInfo&&i.ItemsInfo.Items)for(f=i.ItemsInfo.Items,u=0;u<f.length;u++)if(n.Common.isEquals(r,f[u].Value))return n.Common.IsEmpty(f[u].DisplayValue)?"":f[u].DisplayValue.toString();return null},i}();n.UserSelectorCellHelper=o;s=function(){function i(){}return i.getFormattedItems=function(t,i){for(var o,s=[],h=t.length,f=0;f<h;f++){var r=t[f],e=null,u=r.DisplayValue;i&&(o=n.FormatHelper.format(i,r.DisplayValue),e=o.color,u=o.text);typeof u=="string"&&(u=u.replace(/[\r\n]/g,""));s.push({Value:r.Value,DisplayValueBeforeFormat:r.DisplayValue,DisplayValue:u,Forecolor:e?e:null,DropDownSubItemsList:r.DropDownSubItemsList})}return s},i.getDisplayValue=function(i,r,u,f,e,o,s){var l=this,h,c;if(r instanceof t)return r.toString();if(i.IsBounding)return c=this.getIndexAndText(i,r,f,e,o,s,!0,!1,null,null,!0),c.index!==-1?c.beforeFormatValue:this.needValidateItem(i)?"":n.Common.IsEmpty(r)?"":r.toString();if(i.haveLoadItems&&i.ItemsInfo&&i.ItemsInfo.Items){if(i.AllowMultiSelect)return n.Common.IsEmpty(r)?null:(r+"").split(",").map(function(n){var t;if((t=l.getDisplayValueForNoBoundingItem(i,n))!==null&&t!==void 0)return t.text}).filter(function(t){return!n.Common.IsEmpty(t)}).join(",");if(h=this.getDisplayValueForNoBoundingItem(i,r),h)return h.text}return null},i.getDisplayValueForNoBoundingItem=function(t,i){for(var r,f="",e=!1,s=t.ItemsInfo.Items,u=0,o=s;u<o.length;u++)if(r=o[u],n.Common.isEquals(i,r.Value)){e=!0;f=n.Common.IsEmpty(r.DisplayValue)?"":r.DisplayValue.toString();break}return e?{text:f}:null},i.isComboBoxItemEqual=function(t,i){return(t===null||t===undefined)&&(t=""),(i===null||i===undefined)&&(i=""),t===""||i===""?t===i:n.Common.isFuzzyEquals(t,i)},i.getIndexAndText=function(t,i,r,u,f,e,o,s,h,c,l){var a,w;if(s===void 0&&(s=!1),h===void 0&&(h=null),c===void 0&&(c=null),l===void 0&&(l=!1),n.Common.IsEmpty(i)&&t.AddNullItemWhenBinding)return{index:0,beforeFormatValue:t.NoneItemText,text:t.NoneItemText};var b=-1,v="",y="",p=n.TableColumnsCacheManager.getBindingValueCacheKey(t);return p&&(a=n.TableColumnsCacheManager.CannotFindValue,w=n.ConditionHelper.getComputedSqlConditionFormula(t.ItemsQuery,f,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,0,0,e),a=s?n.TableColumnsCacheManager.lookupComboboxResultAsync(t,i,w,u,p,h,c,o):n.TableColumnsCacheManager.lookupComboboxResultSync(t,i,w,l,u,p,o),a!==n.TableColumnsCacheManager.NoneExistentValue&&a!==n.TableColumnsCacheManager.CannotFindValue&&(b=0,v=n.Common.IsEmpty(a)?"":a,y=v,r&&(y=n.FormatHelper.format(r,v).text))),{index:b,beforeFormatValue:n.Common.IsEmpty(v)?"":v,text:n.Common.IsEmpty(y)?"":y}},i.processAsMultiSelect=function(n,t){return n.AllowMultiSelect&&t},i.needValidateItem=function(n){return n.AllowMultiSelect?!0:!n.SelectOnly&&!n.ValidateItem?!1:!0},i}();n.ComboCellHelper=s;i=function(){function t(){}return t.adjustDomForOverflow=function(i,r,u,f){var o,s,h,c,l,e;if(!i||!t.needAdjustDom(u))return i;r.css("overflow","hidden");switch(u.StyleInfo.HorizontalAlignment){case n.CellHorizontalAlignment.Right:u.Layout.leftOverflowOffset=(o=u.LeftOverflowSpace)!==null&&o!==void 0?o:0;break;case n.CellHorizontalAlignment.Center:if(u.Layout.leftOverflowOffset=(s=u.LeftOverflowSpace)!==null&&s!==void 0?s:0,u.Layout.rightOverflowOffset=(h=u.RightOverflowSpace)!==null&&h!==void 0?h:0,l=n.ForguncyData.pageInfo.pageLayouts[f],e=u.Layout,!e)return i;var a=l.getColumnWidth(e.Column-e.leftOverflowOffset,e.leftOverflowOffset),v=l.getColumnWidth(e.Column+1,e.rightOverflowOffset),y=a+v+u.FullWidth,p=n.DomUtilities.createJqueryDomElement("div"),w={position:"relative",marginLeft:a/y*100+"%",marginRight:v/y*100+"%",height:"100%"};i.css("position","relative");i.css("left","50%");i.css("transform","translateX(-50%)");p.addClass(n.CSSHelper.getClassName(w));i=p.append(i);break;default:u.Layout.rightOverflowOffset=(c=u.RightOverflowSpace)!==null&&c!==void 0?c:0}return i},t.needAdjustDom=function(n){return n.LeftOverflowSpace||n.RightOverflowSpace?!0:!1},t}();n.OverflowHelper=i})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f.supportedEvents=["click","mouseenter","mouseleave"],f}return __extends(i,t),i.prototype.bind=function(i,r,u){var f=this,e;if(f.supportedEvents.indexOf(i)!==-1&&!f.isEventHasBeenBinding(i)&&(e=f._getClickableDomId(),!n.Common.IsEmpty(e)))$("#"+e).on(i,function(){return f.trigger(i,null),!1});t.prototype.bind.call(this,i,r,u)},i.prototype.unbind=function(i,r){t.prototype.unbind.call(this,i,r);var u=this,f=u._getClickableDomId();n.Common.IsEmpty(f)||u.supportedEvents.indexOf(i)!==-1&&(u.isEventHasBeenBinding(i)||$("#"+f).off(i))},i.prototype.unbindAll=function(){var r=this,u=r._getClickableDomId(),f,i;if(!n.Common.IsEmpty(u))for(f=$("#"+u),i=0;i<r.supportedEvents.length;i++)f.off(r.supportedEvents[i]);t.prototype.unbindAll.call(this)},i.prototype._getClickableDomId=function(){throw"No implement.";},i.prototype.hasFocus=function(){var n=$("#"+this.ID+"_btn");return n.length>0&&document.activeElement===n[0]?!0:!1},i.prototype.setFocus=function(){var n=$("#"+this.ID+"_btn");n.length>0&&n[0].focus()},i}(n.CellTypeBase),i;n.ClickableCellTypeBase=t;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.destroy=function(){this.generalElement=null;t.prototype.destroy.call(this)},i.prototype.needValidate=function(){return!1},i.prototype.createContent=function(){var t=this.CellElement,n=i.createLabelElement(t,this._getDomCreateInfo());return this.generalElement=n,n},i.createLabelElement=function(t,i){var u=n.DomUtilities.createJqueryDomElement("label"),r={},f=n.CellDomCreateHelper.createTextElement(t,u,i);return r.webkitUserSelect="initial",i.isInListview&&(r.pointerEvents="none"),u.addClass(n.CSSHelper.getClassName(r)),f},i.prototype.clickable=function(){return!1},i.prototype.setValueToElement=function(n,t){this._updateText(n,t)},i.prototype._updateText=function(t,r){var u={value:null},f=n.FormatHelper.formatValue(r,this.getFormatString(),u);i.setValueToLabel(t,f,u.value,this.CellElement);this.shrinkToFit(this.generalElement)},i.prototype.onWindowResized=function(){this.shrinkToFit(this.generalElement)},i.prototype.getValueFromElement=function(){return null},i.prototype.onFormatterChanged=function(){var t=$("#"+this.ID),i;t.length===1&&(i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this._updateText(t,i))},i.setValueToLabel=function(t,i,r,u){if(n.Common.IsEmpty(i))i="";else if(r)t.css("color",n.ColorHelper.Convert(r)),t.data(n.StaticValues.conditionalForeColor,t.css("color"));else{var f=t.data(n.StaticValues.conditionalForeColor);f&&(t.removeData(n.StaticValues.conditionalForeColor),t.css("color")===f&&t.css("color",u.StyleInfo.Foreground===undefined?"black":n.ColorHelper.Convert(u.StyleInfo.Foreground)))}t.text(i)},i.prototype._getClickableDomId=function(){return this.ID+"_div"},i}(t);n.GeneralCellType=i})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var i=function(t){function i(n,i,r,u){return t.call(this,n,i,r,u)||this}return __extends(i,t),i.prototype.canInputChars=function(){return!1},i.prototype.selectAll=function(){},i.prototype.setCaretAtLast=function(){},i.prototype.focus=function(){var n=$("#"+this.ID);n.length>0&&n.focus()},i.prototype.getDropDownObj=function(){return null},i.prototype.getIgnoreKeysInListview=function(){return[]},i.prototype.setStyle=function(t,i,r,u,f,e,o){var s={Row:this.CellElement.Row,Column:this.CellElement.Column,StyleInfo:{WordWrap:this.CellElement.StyleInfo.WordWrap,Background:t,Foreground:i,FontFamily:this.CellElement.StyleInfo.FontFamily,FontSize:r,FontStyle:u?n.StaticValues.FontStyle_Italic:n.StaticValues.Font_Normal,FontWeight:f?n.StaticValues.FontWeight_Bold:n.StaticValues.Font_Normal,Underline:e,Strikethrough:o,HorizontalAlignment:this.CellElement.StyleInfo.HorizontalAlignment}};this.setStlyeInternal(s)},i.prototype.setStlyeInternal=function(){},i}(n.CellTypeBase),t;n.ListviewEditModeCellType=i;t=function(t){function i(n,i,r,u){return t.call(this,n,i,r,u)||this}return __extends(i,t),i.prototype.onFormatterChanged=function(){this.changeFormatElement()},i.prototype._getPartsUseFontStyle=function(){return this.$formatElement},i.prototype.shouldNeverShowFormatLabel=function(){return!1},i.prototype.getFormaterOfFormatLabel=function(){var n,t=this.getCellActualStyleInfo();return(n=t===null||t===void 0?void 0:t.Formatter)!==null&&n!==void 0?n:"@"},i.prototype.createContent=function(){var i=this,r=n.ForguncyData.pageInfo.pageLayouts[this.runTimePageName],t,u;return(r&&(this.shouldAutoFitInRows=r.possibleAutoFitInRows(this.CellElement.Layout),this.shouldAutoFitInColumns=r.possibleAutoFitInColumns(this.CellElement.Layout)),t=this.createCellContent(),!this.shouldHandleFormat())?t:(this._$inputElement=t.find("#"+this.ID),this._$inputElement.bind("input propertychange",function(){i.tryToAutoFitFormatElement()}),u=this.appendFormatLabelPart(t),this.showFormatElement(),this.initHandlingFormatLabelEvent(this._$inputElement,function(){return i.onFocusIn()},function(){return i.onFocusOut()}),u)},i.prototype.appendFormatLabelPart=function(t){var i=n.DomUtilities.createJqueryDomElement("div");i.addClass("fgc-container-relative");var u=this.getFormatPart(),f=t.children(),r=n.DomUtilities.createJqueryDomElement("div");return r.addClass("fgc-container-absolute"),r.append(f),i.append(u),i.append(r),t.append(i),t},Object.defineProperty(i.prototype,"$formatElement",{get:function(){return this._$formatElement||this.getFormatPart(),this._$formatElement},enumerable:!1,configurable:!0}),i.prototype.getFormatPart=function(){return this._formatPart||(this._formatPart=this.createFormatElement(),this._$formatElement=this._formatPart.find("[format-label]")),this._formatPart},i.prototype.initHandlingFormatLabelEvent=function(n,t,i){n.focusin(function(){t()});n.focusout(function(){i()})},i.prototype.onFocusIn=function(){this.hideFormatElement()},i.prototype.onFocusOut=function(){this.showFormatElement()},i.prototype.shouldHandleFormat=function(){return this.isInListview?!1:!0},i.prototype.hideFormatElement=function(){this.getContainer().toggleClass("fgc-format-label-show",!1)},i.prototype.showFormatElement=function(){this.shouldHandleFormat()&&this.changeFormatElement()},i.prototype.getCellActualStyleInfo=function(){if(this.isInListview)return this.CellElement.StyleInfo;var t=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(this.ID);return t&&t.actualStyleInfo?t.actualStyleInfo.styleInfo:null},i.prototype.changeFormatElement=function(){var t,i;this.shouldHandleFormat()&&(i=this.getFormattedResult(),this.$formatElement.text(i),n.Common.IsEmpty(this.getValueToFormat())?this.hideFormatElement():this.shouldNeverShowFormatLabel()||((t=this._$inputElement)===null||t===void 0?void 0:t.is(":focus"))||this.getContainer().toggleClass("fgc-format-label-show",!0))},i.prototype.getFormattedResult=function(){var t=this.getValueToFormat(),i=this.getFormaterOfFormatLabel(),r=n.FormatHelper.format(i,t);return r.text},i.prototype.createFormatElement=function(){var t=__assign({},this.CellElement),r,i,u;return t.runtimeContainer=null,t.StyleInfo=n.Common.clone(t.StyleInfo),r=this._getDomCreateInfo(),r.id=null,t.BindingInfo=null,t.StyleInfo||(t.StyleInfo={}),t.StyleInfo.TextIndent=1,t.StyleInfo.HorizontalAlignment=this.getHorizontalAlignmentForFormatLabel(),t.StyleInfo.VerticalAlignment=this.getVerticalAlignmentForFormatLabel(),i=n.DomUtilities.createJqueryDomElement("label"),u=n.CellDomCreateHelper.createTextElement(t,i,r),u.addClass("fgc-align-format-label"),i.attr("format-label","true"),i.css("overflow","hidden"),i.css("white-space","pre"),i.css("padding","0px 2px"),u},i.prototype.tryToAutoFitFormatElement=function(){(this.shouldAutoFitInRows||this.shouldAutoFitInColumns)&&this.changeFormatElement()},i.prototype.getHorizontalAlignmentForFormatLabel=function(){return this.CellElement.StyleInfo.HorizontalAlignment},i.prototype.getVerticalAlignmentForFormatLabel=function(){return n.CellVerticalAlignment.Center},i.prototype.setValueToElement=function(){this.changeFormatElement()},i}(n.ListviewEditModeCellType);n.SupportFormatCellType=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.prototype.ApplyTemplateStyle=function(t,i){var u,f,r;if(i){if(!t){i.attr("fgc-no-styletemplate","true");return}for(u=t.Key,f=this.MapPartsNameToDom(i),r=0;r<this.TemplateNameParts.length;r++){var e=this.TemplateNameParts[r],o=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,u,e),s=f[e];s.addClass(o)}this.OnTemplateStyleApplied(t,i)}},t.prototype.MapPartsNameToDom=function(){return null},t.prototype.OnTemplateStyleApplied=function(){},t.prototype.Clear=function(){},t}();n.CellTypeStyleTemplateHelperBase=t})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t=function(){function t(){}return t.FormatTemplateStyleClassName=function(n,t,i){return"".concat(n.replace(/\./g,""),"-").concat(t,"-").concat(i)},t.PrepareTemplateStyles=function(n){t.ParseAndAppendTemplateStyles(n);t.InitEvents()},t.InitEvents=function(){var n="data-styleTempalte-bodyHasMouseUp",i=$("body").attr(n);if(!i){$("body").attr(n,!0);$("body").on("mouseup",function(){var n=t.EventTarget;n&&n.removeClass("active")})}},t.ParseAndAppendTemplateStyles=function(n){var o,r,u,f,e,s,i,h;for(o in n){r=n[o];for(u in r)if(Object.prototype.hasOwnProperty.call(r,u)){f=r[u].Styles;for(e in f)if(Object.prototype.hasOwnProperty.call(f,e)){if(s=f[e],i=t.FormatTemplateStyleClassName(o,u,e),t.CellTypeTemplateStyleCache[i])continue;t.PrePageCellTypeTemplateStyleCache[i]&&(h=document.getElementById(i),h.remove(),t.PrePageCellTypeTemplateStyleCache[i]=!1);t.ParseAndAppendPartStyle(s,i);t.CellTypeTemplateStyleCache[i]=!0}}}},t.ParseAndAppendPartStyle=function(i,r){var u=[],s=["box-sizing:border-box;",],a;n.ForguncyData.IsAutoTest&&(i.Transition="0s");i.Transition&&s.push("transition:".concat(i.Transition,";"));var h=t.ConvertStyleString.apply(t,__spreadArray([i.NormalStyle],s,!1)),c=t.ConvertStyleString(i.HoverStyle),e=t.ConvertStyleString(i.FocusStyle),o=t.ConvertStyleString(i.ActiveStyle),l=t.ConvertStyleString(i.SelectedStyle),f=t.ConvertStyleString(i.DisableStyle);h&&u.push(".".concat(r),h);e&&u.push(".".concat(r,":not([disabled]):focus"),e,".".concat(r,"-focus:not([disabled])"),e);c&&n.Platform.isMobile()===!1&&n.Platform.isIpad()===!1&&u.push(".".concat(r,":not([disabled]):hover"),c);o&&(u.push(".".concat(r,":not([disabled]):active"),o),u.push(".".concat(r,":not([disabled]).active"),o));l&&u.push(".".concat(r,":not([disabled]).selected"),l);f&&(u.push(".".concat(r,":disabled"),f),u.push(".".concat(r,"-disabled"),f),u.push(".".concat(r,'[disabled="disabled"]'),f));u.push(".".concat(r," input, .").concat(r," textarea, .").concat(r," select"),"{color:inherit;font:inherit;}");u.push(".".concat(r," input:disabled, .").concat(r," textarea:disabled, .").concat(r," select:disabled"),"{color:inherit;}");a=u.join("");t.AddCSSTextToDocument(a,r)},t.AddCSSTextToDocument=function(n,t){var i=document.createElement("style"),r=document.body||document.getElementsByTagName("body")[0],u=document.createTextNode(n);i.type="text/css";i.id=t;i.appendChild(u);r.appendChild(i)},t.ConvertStyleString=function(t){for(var a,v=[],f=1;f<arguments.length;f++)v[f-1]=arguments[f];if(n.Common.IsEmpty(t))return null;var y=t.FontColor,p=t.Background,w=t.BorderString,b=t.BorderTopString,k=t.BorderRightString,d=t.BorderBottomString,g=t.BorderLeftString,e=t.PaddingLeft,o=t.PaddingRight,r=t.PaddingBottom,s=t.PaddingTop,h=t.MarginLeft,c=t.MarginRight,u=t.MarginBottom,l=t.MarginTop,nt=t.Opacity,rt=t.Bold,ut=t.Italic,tt=t.BorderRadiusString,it=t.BoxShadowString,ft=t.Underline,i=[];return y&&i.push("color: ".concat(n.ColorHelper.Convert(y),";")),p&&i.push("background: ".concat(n.ColorHelper.Convert(p)," border-box;")),tt&&i.push("border-radius: ".concat(n.ColorHelper.Convert(tt),";")),w?i.push("border: ".concat(n.ColorHelper.ConvertBorder(w),";")):(b&&i.push("border-top: ".concat(n.ColorHelper.ConvertBorder(b),";")),k&&i.push("border-right: ".concat(n.ColorHelper.ConvertBorder(k),";")),d&&i.push("border-bottom: ".concat(n.ColorHelper.ConvertBorder(d),";")),g&&i.push("border-left: ".concat(n.ColorHelper.ConvertBorder(g),";"))),r&&r===o&&r===s&&r===e?i.push("padding: ".concat(r,"px!important;")):(s&&i.push("padding-top: ".concat(s,"px!important;")),o&&i.push("padding-right: ".concat(o,"px!important;")),r&&i.push("padding-bottom: ".concat(r,"px!important;")),e&&i.push("padding-left: ".concat(e,"px!important;"))),u&&u===c&&u===l&&u===h?i.push("margin: ".concat(u,"px;")):(l&&i.push("margin-top: ".concat(l,"px;")),c&&i.push("margin-right: ".concat(c,"px;")),u&&i.push("margin-bottom: ".concat(u,"px;")),h&&i.push("margin-left: ".concat(h,"px;"))),n.Common.IsEmpty(nt)||i.push("opacity: ".concat(nt,";")),it&&i.push("box-shadow: ".concat(n.ColorHelper.ConvertShadow(it),";")),rt&&i.push("font-weight: bold;"),ft&&i.push("text-decoration: underline;"),ut&&i.push("font-style: italic;"),i.push.apply(i,v),a=i.join(""),a?"{"+a+"}":null},t.ApplyCellTypeStyleTemplates=function(n,t){return t?(n.addClass(t),!0):!1},t.GetStyleTemplateByKey=function(n,t,i){return i&&i[n]?i[n][t]:null},t.IsTransparentColor=function(t){if(n.Common.IsEmpty(t)||t.indexOf("rgba")===-1)return!1;var r=t.split(","),i=parseFloat(r[r.length-1]);return isNaN(i)?!1:i===255||i===0?!1:!0},t.AddFocusStyleToContainer=function(n,t){var i="data-focus-within",r=t.attr(i);!r&&n&&(t.focusin(function(){t.addClass("".concat(n,"-focus"))}),t.focusout(function(){t.removeClass("".concat(n,"-focus"))}),t.attr(i,!0))},t.AddDiableCallbackToContainer=function(n,t){var i=t.attr("data-disabled-event");t.attr("disabled")&&t.addClass("".concat(n,"-disabled"));!i&&n&&(t.data("DisableCallback",function(){t.addClass("".concat(n,"-disabled"));t.attr("disabled",!0)}),t.data("EnableCallback",function(){t.removeClass("".concat(n,"-disabled"));t.removeAttr("disabled")}),t.attr(i,!0))},t.ForceInnerEditorFontSizeToInherit=function(n,t){n&&(t.find("input").css({fontSize:"inherit"}),t.find("textarea").css({fontSize:"inherit"}))},t.CellTypeTemplateStyleCache={},t.PrePageCellTypeTemplateStyleCache={},t}();n.CellTypeStyleTemplateUtils=t})(Forguncy||(Forguncy={}))
;var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var t=function(){function t(){}return t.prepareMetaData=function(n){n.haveLoadItems===undefined&&(n.haveLoadItems=!n.IsBounding);n.ValueColumnBindingInfo&&!n.DisplayColumnBindingInfo?n.DisplayColumnBindingInfo=n.ValueColumnBindingInfo:!n.ValueColumnBindingInfo&&n.DisplayColumnBindingInfo&&(n.ValueColumnBindingInfo=n.DisplayColumnBindingInfo)},t.initItems=function(i,r,u,f){var e=r.CellType,a,h,s,c,o,l;if(!n.FormulaManager.isReady()&&e.ItemsQuery){n.DelayRefresh.setTimeout(function(){t.initItems(i,r,u,f)},0);return}if(a=n.Common.typeContains(e,"UserCellType"),h=i,!e.haveLoadItems||i.getOffsetCondition()){if(s=void 0,a){if(o=e,(n.Common.IsEmpty(o.Columns)||o.Columns===0)&&(n.Common.IsEmpty(o.CustomColumns)||o.CustomColumns.length<=0))return;s="Account/GetUsers";c={role:typeof o.Role=="undefined"?"":o.Role,displayColumnName:o.DisplayColumnName===undefined?"":o.DisplayColumnName,columns:o.Columns,customColumns:o.CustomColumns===undefined?"":o.CustomColumns.join(",")}}else{if(typeof e.ValueColumnBindingInfo=="undefined"){t.setItemsCellTypeItems(i,r,e,u,{Items:[]},f);return}s="Home/GetComboBindingOptions";c=t.getRequestDataInfo(e,h)}l=!f.isInListview&&(!n.Common.typeContains(e,"DropDownListCellType")||i instanceof n.ComboBoxCellType_Mobile);l&&h._startWaitingServerData();n.Common.forguncyPost(s,c,function(o){o||(o={Items:[]});n.TableColumnsCacheManager.addCacheFromGetComboBindingOptionsResult(o.Items,r.CellType,c.itemQuery);e.ItemsInfo=o;t.setItemsCellTypeItems(i,r,e,u,o,f);e.haveLoadItems=!0;l&&h._endWaitingServerData()},f.id+" "+s)}else t.setItemsCellTypeItems(i,r,e,u,e.ItemsInfo,f)},t.initItemsQuery=function(i,r,u,f){if(!f.isInListview){var e=r.CellType,o=i;e.IsBounding&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(r.DependenceCells,function(){e.haveLoadItems=!1;t.initItems(i,r,u,f)},o.runTimePageName)}},t.getFormulaListRowInfo=function(t){var i=n.Common.getLocatedListview(t.runTimePageName,t.CellElement.Row,t.CellElement.Column);return n.SpreadJSView&&i instanceof n.SpreadJSView?i.getFormulaListRowInfo():null},t.getRequestDataInfo=function(i,r){var u,f,e,o=t.getFormulaListRowInfo(r);return{tableName:i.DataSource,valueColumnBindingInfo:(u=i.ValueColumnBindingInfo)===null||u===void 0?void 0:u.GUID,displayColumnBindingInfo:(f=i.DisplayColumnBindingInfo)===null||f===void 0?void 0:f.GUID,dropDownSubItems:(e=i.DropDownSubItems)===null||e===void 0?void 0:e.map(function(n){var t;return __assign(__assign({},n),{BindingInfo:(t=n.BindingInfo)===null||t===void 0?void 0:t.GUID})}),itemQuery:n.ConditionHelper.getComputedSqlConditionFormula(i.ItemsQuery,r.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,0,0,o),itemSort:i.ItemsSort,offset:r.getOffsetCondition(),pageName:r.designerPageName}},t.setItemsCellTypeItems=function(i,r,u,f,e,o){n.Common.typeContains(u,"UserCellType")?i.setItems(r,f,e,o):(t.initItemsOfItemsCell(r,e,u),n.Common.typeContains(u,"DropDownListCellType")?i.setItems(r,f,e,o):(i.setItems(r,f,e.Items,o),n.DomUtilities.setPropertyToDom(r,f,o,[1])))},t.initItemsOfItemsCell=function(t,i,r){for(var e,o,l,s,h=r.IsBounding?r.AddNullItemWhenBinding:!1,c=h?r.NoneItemText:"",u=(s=i===null||i===void 0?void 0:i.Items)!==null&&s!==void 0?s:[],f=u.length-1;f>=0;f--)n.Common.IsEmpty(u[f].Value)&&(u[f].Value=null,h=!1,n.Common.IsEmpty(u[f].DisplayValue)&&(u[f].DisplayValue=c)),n.Common.IsEmpty(u[f].DisplayValue)?u[f].DisplayValue="":t.StyleInfo.Formatter||(i.DisplayValueType===1?u[f].DisplayValue=n.FormatHelper.format("yyyy/M/d",u[f].DisplayValue).text:i.DisplayValueType===4&&(u[f].DisplayValue=n.FormatHelper.format("hh:mm",u[f].DisplayValue).text));if(h){if(e=null,n.Common.typeContains(r,"DropDownListCellType")&&(e={},r.DropDownSubItems))for(o=0;o<r.DropDownSubItems.length;o++)l=r.DropDownSubItems[o],l&&(e[l.GUID]=c);u.unshift({DisplayValue:c,Value:null,DropDownSubItemsList:e})}},t.SetItemsByStringArray=function(n,t,i,r){typeof r=="string"&&(r=JSON.parse(r));var u=r.map(function(n){return{value:n,label:n}});this.SetItemsByObjectArray(n,t,i,u,"value","label")},t.SetItemsByObjectArray=function(n,i,r,u,f,e){typeof u=="string"&&(u=JSON.parse(u));e||(f=e);var o=u.map(function(n){return{Value:n[f],DisplayValue:n[e]}});t.setItemsCellTypeItems(n,n.CellElement,n.CellElement.CellType,i,{Items:o},r)},t.clearValueAfterQueryChanged=function(t,i){if(!i){var r=t.CellElement,u=t.CellElement.CellType;u.IsBounding&&n.DependenceCellValueChangeHelper.addDependenceCellValueChangeHandler(r.DependenceCells,function(i){i&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(t.ID,{newValue:null,uiAction:!0},7)},t.runTimePageName)}},t}();n.ItemsCellTypeHelper=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t=function(t){function i(i,r,u,f){var e=t.call(this,i,r,u,f)||this;return e.toggles=[],e.toggleUIs=[],n.ItemsCellTypeHelper.prepareMetaData(i.CellType),e}return __extends(i,t),i.prototype.create=function(n){this._divContainer=n;t.prototype.create.call(this,n)},i.prototype.getOffsetCondition=function(){return null},i.prototype.createContent=function(){var i=this._divContainer,r=this.CellElement,s=this.isInListview,e=this._getDomCreateInfo(),t=n.DomUtilities.createJqueryDomElement("div"),h,c,u,f,o;return n.ItemsCellTypeHelper.initItems(this,r,t,e),t.attr("id",this.ID),h=[5],n.DomUtilities.setPropertyToDom(r,t,e,h),c=n.DomUtilities.measureBrowserScrollbarWidth(),this._scrollbarWidth=c,u=n.DomUtilities.createAlignmentContainer(t,r.StyleInfo.HorizontalAlignment,r.StyleInfo.VerticalAlignment),i&&(i.css("overflow","auto"),i.css("position","relative"),i.css("z-index","0"),n.StaticData.IsCellTypeExporting&&i.css("overflow","hidden")),this.CellElement.StyleInfo.WordWrap?t.css("white-space","pre-wrap"):t.css("white-space","nowrap"),t.css("font-size","0"),s&&(f=n.DomUtilities.createAbsoluteContainerDiv(),f.css("overflow","hidden"),f.append(u),u=f),o=this.cellTypeData.getDefaultValue(),s||n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:o},1),this._setValue(t,o),n.ItemsCellTypeHelper.clearValueAfterQueryChanged(this,this.isInListview),n.ItemsCellTypeHelper.initItemsQuery(this,r,t,e),u},i.prototype.setItems=function(t,i,r,u){var l=this,f=t.CellType,e=i,w,b,d,s,y,g;e.empty();var o=__spreadArray([],r,!0),p=[],k=[],a={};f.AddOtherItem&&(a.DisplayValue=n.RS.groupCell_Other,o.push(a));var h=0,v=0,c=0;for(this.toggles=[],this.toggleUIs=[],f.LayoutMode===1&&(n.StaticData.IsCellTypeExporting?(b=n.DomUtilities.createTableContainer(o.length,f.ColumnCount),e.append(b),e=b):(w=n.DomUtilities.createGridContainer(f.ColumnCount),e.append(w),e=w)),d=function(i){var nt,w=o[i],b=n.Common.IsEmpty(w.DisplayValue)?"":w.DisplayValue,d,tt,y,r,v,it,h,g;if(k.push(b),d=void 0,t.StyleInfo.Formatter&&(tt=n.FormatHelper.format(t.StyleInfo.Formatter,b),d=tt.color,b=tt.text),y=s.createSingleItemToggle(b,null),s.toggles.push(y),r=s.createSingleItemUI(y),s.toggleUIs.push(r),v=r.container,u.isInListview&&(r.inputContainer.attr(n.StaticValues.isInListview,u.isInListview),r.inputContainer.css("outline","thin transparent")),r.inputContainer.attr("id",s.ID+"_input"+i),r.inputContainer.attr("name",s.ID),n.DomUtilities.setPropertyToDom(t,r.textContainer,s._getDomCreateInfo(),[0]),n.Common.IsEmpty(d)||(it=n.FormatColorClassManager.getClassName(d),r.textContainer.attr("useFormatColor",it),r.textContainer.addClass(it)),f.LayoutMode===1?(v=$(document.createElement("div")).append(r.container),n.StaticData.IsCellTypeExporting||n.DomUtilities.setGridRowAndColumn(v,f.ColumnCount,i),f.ColumnCount===1&&i===o.length-1||v.css("margin-bottom",f.ItemSpace)):(i!==o.length-1&&(r.container.css("margin-right",f.ItemSpace),c+=f.ItemSpace),f.IsSameWidth?r.container.css("float","left"):r.container.css("float","none")),!u.isInListview)y.on("PropertyChanged",function(n,t){t==="isChecked"&&(l._onValueChanged(),l.validate())});if(n.StaticData.IsCellTypeExporting&&f.LayoutMode===1?$(e.find("td")[i]).append(v):e.append(v),w===a){h=$(document.createElement("input")).attr((nt={type:"text",otherText:"otherText",dir:"auto"},nt["aria-label"]="Other:",nt));g=f.OtherItemTextBoxWidthSetting;s._otherTextBox=h;s._otherTextBoxWidth=g;h.attr("id",s.ID+"_input_other");h.css("width",g);f.LayoutMode===1&&(f.ColumnCount>=1?n.DomUtilities.setGridRowAndColumn(h,f.ColumnCount,o.length-1):r.container.css("display","inline-flex"));n.DomUtilities.setPropertyToDom(t,h,s._getDomCreateInfo(),[0]);c+=g+5;h.on("change keyup",function(){h.val()&&(y.isChecked=!0)});f.IsSameWidth===!0&&f.LayoutMode!==1&&(r.container.css("float","left"),h.css("float","left"));r.inputContainer.on("click",function(){h.focus()});if(!u.isInListview){h.on("change",function(){l._onValueChanged()});h.focusout(function(){l.isReadOnly()||(l._onValueChanged(),l.validate())})}r.inputContainer.attr("othercheck","otherCheck");f.LayoutMode===1?v.append(h):e.append(h);e.attr("hasotheritem","true");p.push(function(){var t=h.val();return n.Common.IsEmpty(t)?null:t})}else p.push(w.Value)},s=this,y=0;y<o.length;y++)d(y);g=n.DomUtilities.measureElementSizes(this.toggleUIs.map(function(n){return n.container}));g.forEach(function(n){f.LayoutMode===1?n.width>h&&(h=n.width):(f.IsSameWidth&&(n.width>h&&(h=n.width),n.height>v&&(v=n.height)),c+=n.width)});f.LayoutMode===1?c=h:f.IsSameWidth&&(c=(h+f.ItemSpace)*o.length);o[o.length-1]===a&&(c+=f.OtherItemTextBoxWidthSetting);this._widthBasis=Math.max(t.Width,c);f.LayoutMode!==1&&(o[o.length-1]===a?this.setMaxSizeToLabel(h,v,e,!0):this.setMaxSizeToLabel(h,v,e,!1));this.valueList=p;this.displayValueList=k;n.FocusMoveHelper.AllowMoveFocusByEnterKey(e.find("input"),this.isInListview);this._setTabIndexToDom(f,e);this.isVisible()||this._setVisible(this.getContainer(),!1);this.isDisabled()&&this._disable(e);this.isReadOnly()&&this.updateReadOnlyStatus()},i.prototype.setMaxSizeToLabel=function(n,t,i,r){var f=i.children(".".concat("FUI-toggle")),e=f.length,u;for(r&&e--,u=0;u<e;u++)$(f[u]).css("width",n||""),$(f[u]).css("height",t||"")},i.prototype.hasFocus=function(){var t=$("#"+this.ID).find("[name='"+this.ID+"']"),n;if(t.length>0)for(n=0;n<t.length;n++)if(document.activeElement===t[n])return!0;return!1},i.prototype.setFocus=function(){var n=$("#"+this.ID).find("[name='"+this.ID+"']");n.length>0&&n[0].focus()},i.prototype.focus=function(){var n=$("#"+this.ID).find("input");n.length>0&&$(n[0]).focus()},i.prototype.setValueToElement=function(n,t){var r=n.find('[name="'+this.ID+'"]'),i=this.valueList;i&&(this.setValueToUIInternal(n,r,i,t),this.setOtherValue(n,i,t))},i.prototype.getValueFromElement=function(){var t=$("#"+this.ID),i,n;return t.length===0?null:(i=t.find('[name="'+this.ID+'"]'),n=this.valueList,!n)?null:this.getValueInternal(i,n)},i.prototype.setValueToUIInternal=function(){throw"need child class implement";},i.prototype.getValueInternal=function(){throw"need child class implement";},i.prototype.getOtherValue=function(){throw"need child class implement";},i.prototype.createSingleItemToggle=function(){throw new Error("Need override");},i.prototype.createSingleItemUI=function(){throw new Error("Need override");},i.prototype._getCellTypeData=function(t){return new n.GroupCellTypeData(t)},i.prototype._setOverflowHidden=function(){return},i.prototype.adjustForeColor=function(n){return t.prototype.adjustForeColor.call(this,n,null)},i.prototype.onFormatterChanged=function(){for(var r,i=$("#"+this.ID+" .FUI-toggle-text"),t=0;t<i.length;t++){var f={value:null},e=n.FormatHelper.formatValue(this.displayValueList[t],this.getFormatString(),f),u="";f.value&&(u=n.FormatColorClassManager.getClassName(f.value));r=$(i[t]).attr("useFormatColor");n.Common.IsEmpty(r)&&(r="");r!==u&&(n.Common.IsEmpty(r)||$(i[t]).removeClass(r),n.Common.IsEmpty(u)||$(i[t]).addClass(u));$(i[t]).attr("useFormatColor",u);$(i[t]).text(e)}},i.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+" .FUI-toggle-text,#"+this.ID+"_input_other")},i.prototype._disable=function(){this.updateDisabledProperty()},i.prototype._enable=function(){this.updateDisabledProperty()},i.prototype.updateReadOnlyStatus=function(){this.updateDisabledProperty()},i.prototype.updateDisabledProperty=function(){var n=!this.isDisabled()&&!this.isReadOnly(),t=this.getContainer().find("input");this.toggles.forEach(function(t){t.enabled=n});n?t.removeAttr("disabled"):t.attr("disabled","disabled")},i.prototype.containsOtherItem=function(){var n=this.CellElement.CellType;return n.AddOtherItem?!0:!1},i.prototype.setOtherValue=function(n,t,i){if(this.containsOtherItem()){var u=this.getOtherValue(t,i),f=n.find("[otherText]"),r=n.find("[othercheck]");u===undefined||u===null?f.val()!==""&&r[0].checked===!0&&(f.val(""),r[0].checked=!1,$(r[0]).trigger("change")):(f.val(u+""),r[0].checked=!0,$(r[0]).trigger("change"))}},i.prototype.setStlyeInternal=function(t){var i=$("#"+this.ID).find("FUI-toggle-text");i.length<=0||n.DomUtilities.setPropertyToDom(t,i,this._getDomCreateInfo(),[0])},i.prototype.reload=function(){var t=this.CellElement.CellType;t.IsBounding&&(t.haveLoadItems=!1,n.ItemsCellTypeHelper.initItems(this,this.CellElement,$("#"+this.ID),this._getDomCreateInfo()))},i.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return n.IsBounding?[n.DataSource]:null},i.prototype._getVisibleParts=function(n){return n.find("input")},i.prototype.onWindowResized=function(){var t=n.ForguncyData.pageInfo.pageLayouts[this.runTimePageName];t&&t.possibleStretchInColumns(this.CellElement.Layout)&&this.resizeOtherTextBox()},i.prototype.resizeOtherTextBox=function(){if(this._otherTextBox&&this._widthBasis){var n=this.getContainerWidth(),t=n-this._widthBasis,i=Math.max(this._otherTextBoxWidth,this._otherTextBoxWidth+t-this._scrollbarWidth);this._otherTextBox.width(i)}},i.prototype.getContainerWidth=function(){var n=this.getContainer();return n?n.width():0},i.prototype.destroy=function(){this._otherTextBox=null;t.prototype.destroy.call(this)},i.prototype.ReloadForCommand=function(){this.reload()},i.prototype.SetItemsByStringArray=function(t){n.ItemsCellTypeHelper.SetItemsByStringArray(this,$("#"+this.ID),this._getDomCreateInfo(),t);this.SyncValueForNewItems()},i.prototype.SetItemsByObjectArray=function(t,i,r){n.ItemsCellTypeHelper.SetItemsByObjectArray(this,$("#"+this.ID),this._getDomCreateInfo(),t,i,r);this.SyncValueForNewItems()},i.prototype.SyncValueForNewItems=function(){var t=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID);this.setValue(t)},i.prototype.ClearOtherText=function(){if(this.containsOtherItem()){var n=this.getContainer(),i=n.find("[otherText]"),t=n.find("[othercheck]");i.val("");t[0].checked=!1;$(t[0]).trigger("change")}},i}(n.ListviewEditModeCellType);n.GroupCellTypeBase=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){function u(){return n.Platform.isMobile()}var i=function(t){function i(n){var i=t.call(this)||this;return i._mainStr="MAIN",i.TemplateNameParts=[i._mainStr],i.CellTypeString=n,i}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{MAIN:n.find(">div")}},i.prototype.OnTemplateStyleApplied=function(t,i){var r,u;t&&i&&(i.css("overflow","visible"),r=this.MapPartsNameToDom(i)[this._mainStr],r.css({overflow:"hidden",position:"relative"}),u=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,t.Key,this._mainStr),n.CellTypeStyleTemplateUtils.AddFocusStyleToContainer(u,r),n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(u,r))},i}(n.CellTypeStyleTemplateHelperBase),t,r,f,e,o,s;n.InputCellTypeStyleTemplateHelperBase=i;t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},i.prototype._getPartsUseBackcolor=function(){return $("#".concat(this.ID,"_div > div"))},i.prototype.createContent=function(){var i=this,r=t.prototype.createContent.call(this),f=this.CellElement.CellType,u;if(f.IsSelectAllOnFocus){u=r.find("#"+this.ID);u.on("focusin",function(){n.Platform.isChrome()&&!n.Platform.isWeChatOrQQBrowser()?i.selectAll():n.DelayRefresh.setTimeout(function(){i.selectAll()})})}return r},i.prototype.addClassInSimulator=function(t){n.MetadataLoader.IsInMobileSimulatorFrame()&&t.addClass("in-simulator")},i.prototype.createCellContent=function(){var r=this.CellElement,t=n.DomUtilities.createJqueryDomElement(this.inputElementTagName()),i,f,u;return this._$input=t,i=n.CellDomCreateHelper.createControlContainer(),this._$container=i,i.append(t),n.CellDomCreateHelper.initalInputBox(r,t,this._getDomCreateInfo()),t.css("background-color","transparent"),t.css("text-align",n.DomUtilities.getHorizontalAlignmentText(r.StyleInfo.HorizontalAlignment)),this.initInputElement(t),f=r.CellType,this.isInListview||(this.bindValueChangedEvent(t),u=this,t.focusout(function(){u.isReadOnly()||u.validate()})),this.initDefaultValue(t,f),n.Platform.isMobile()||this.isInListview||n.FocusMoveHelper.AllowMoveFocusByEnterKey(t,this.isInListview),i},i.prototype.bindValueChangedEvent=function(n){var t=this;n.change(function(){t.isReadOnly()||t._onValueChanged()})},i.prototype.inputElementTagName=function(){return"input"},i.prototype.initInputElement=function(){},i.prototype.initDefaultValue=function(n){var t=this.cellTypeData.getDefaultValue();t!==null&&this._setValue(n,t)},i.prototype.setValueToElement=function(n,t){n.val(t);this.changeFormatElement()},i.prototype.getValueFromElement=function(){if(this._$input){var t=this._$input.val();return n.Common.IsEmpty(t)?null:t}return null},i.prototype._disable=function(n){n.find("#"+this.ID).attr("disabled","disabled");this._$container.attr("disabled","disabled");t.prototype._disable.call(this,this._$container)},i.prototype._enable=function(){this._$input&&this._$input.removeAttr("disabled");this._$container.removeAttr("disabled");t.prototype._enable.call(this,this._$container)},i.prototype.updateReadOnlyStatus=function(){this._$input&&(this.isReadOnly()?this._$input.attr("readonly","readonly"):this._$input.prop("readonly",!1))},i.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return this._$input?this._$input.add(n):n},i.prototype.getValueToFormat=function(){return this._$input.val()},i.prototype.destroy=function(){this._$input.unbind();this._$input=null;t.prototype.destroy.call(this)},i.prototype.canInputChars=function(){return!this.isDisabled()&&!this.isReadOnly()},i.prototype.selectAll=function(){var n=$("#"+this.ID);n.length>0&&n.select()},i.prototype.setCaretAtLast=function(){var n=$("#"+this.ID),i=n.val(),t;i&&n.length>0&&(t=n[0],t.selectionStart=t.selectionEnd=i.length)},i.prototype.setCaretIndex=function(n){var i=$("#"+this.ID),t;i.length>0&&(t=i[0],t.selectionStart=t.selectionEnd=n)},i.prototype.setStlyeInternal=function(t){var i=$("#"+this.ID);i.length<=0||(n.Common.IsEmpty(t.StyleInfo.Background)||i.css("background-color",n.ColorHelper.Convert(t.StyleInfo.Background)),n.DomUtilities.setPropertyToDom(t,i,this._getDomCreateInfo(),[0]))},i.prototype._getVisibleParts=function(n){return n.find("#"+this.ID)},i}(n.SupportFormatCellType);n.InputCellTypeBase=t;r=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.createContent=function(){var u=this,e=t.prototype.createContent.call(this),r,f;this._$input.keydown(function(t){var f,e,o,i=u._$input[0];if(n.FormatHelper.isPercentageFormat((e=(f=u.CellElement)===null||f===void 0?void 0:f.StyleInfo)===null||e===void 0?void 0:e.Formatter)&&i&&(i.selectionStart===0||i.selectionStart===1&&i.value==="-")&&i.selectionEnd===((o=i===null||i===void 0?void 0:i.value)===null||o===void 0?void 0:o.length)){var r=t.keyCode,h=t.code,s=!1;event&&r&&!t.shiftKey&&(r>=96&&r<=105||r>=48&&r<=57)&&(s=!0);r===229&&!t.shiftKey&&h.length-h.replace(/[0-9]/,"").length>0&&(s=!0);s&&(i.selectionStart===1?u._$input.val("-%"):u._$input.val("%"),u.setCaretIndex(i.selectionStart-1))}});var o=this.CellElement.CellType,s=o.IconSize,i=n.ImageDataHelper.CreateImage(o.Icon,s);return i?(this._image=i,r=n.DomUtilities.createGridContainerEx(null,[s+10+"px","1fr"]),r.css("height","100%"),r.css("width","100%"),e.css("position","relative"),i.css("justify-self","center"),i.css("align-self","center"),i.css("-ms-grid-row-align","center"),i.css("-ms-grid-column-align","center"),r.append(i),r.append(e),n.DomUtilities.setGridItemPos(i,1,1),n.DomUtilities.setGridItemPos(e,1,2),f=n.DomUtilities.createJqueryDomElement("div"),f.css("width","100%").css("height","100%"),f.append(r),this._$container=f,f):e},r.prototype.createCellContent=function(){var i=this,r=t.prototype.createCellContent.call(this);return this._$input.keydown(function(t){t.which!==13||n.ForguncyData.pageInfo.moveFocusByEnter||i._onValueChanged()}),r},r.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return this._image?this._image.add(n):n},r.prototype.initInputElement=function(n){n.attr("type","text");n.attr("autocomplete","off")},r.prototype.setValueToElement=function(i,r){var u,f=n.FormatHelper.getTextFromValue(r,(u=this.CellElement.StyleInfo)===null||u===void 0?void 0:u.Formatter);t.prototype.setValueToElement.call(this,i,f)},r.prototype.getValueFromElement=function(i){var u,r=t.prototype.getValueFromElement.call(this,i),f=(u=this.CellElement.StyleInfo)===null||u===void 0?void 0:u.Formatter;return f==="@"||i||(r=n.FormatHelper.getValueFromText(r)),n.Common.IsEmpty(r)&&(r=null),r},r.prototype._onValueChanged=function(){var i,u=(i=this.CellElement.StyleInfo)===null||i===void 0?void 0:i.Formatter,r;n.FormatHelper.isPercentageFormat(u)&&(r=n.FormatHelper.format(u,this.getValueFromElement(!1)).text,this._$input.val()!==r&&this._$input.val(r));t.prototype._onValueChanged.call(this)},r.prototype.destroy=function(){t.prototype.destroy.call(this);this._image=null},r.StyleTemplateHelper=new i("Forguncy.TextCellType"),r}(t);n.TextBoxCellType=r;f=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.createContent=function(){var n=t.prototype.createContent.call(this),i;return(this.shouldAutoFitInRows||this.shouldAutoFitInColumns)&&(n.addClass("fgc-container-relative"),i=$(document.createElement("div")),i.addClass("fgc-container-relative"),n.children().wrap(i),this._$input.addClass("fgc-container-absolute"),this._$input.css("position","absolute")),n},r.prototype.setValueToElement=function(i,r){var u=n.FormatHelper.getTextFromValue(r);t.prototype.setValueToElement.call(this,i,u);this.tryToAutoFitFormatElement()},r.prototype.enterPrintMode=function(){this._$input.css("overflow","hidden");this.tryToAutoFitFormatElement()},r.prototype.quitPrintMode=function(){this._$input.css("overflow","");this.tryToAutoFitFormatElement()},r.prototype.inputElementTagName=function(){return"textarea"},r.prototype.initInputElement=function(t){var i=this,r;t.css("resize","none");r=this;t.keydown(function(t){return!n.Platform.isMobile()&&!r.isInListview&&n.ForguncyData.pageInfo.moveFocusByEnter&&!t.altKey&&!t.ctrlKey&&t.keyCode===13?!1:t.altKey&&t.keyCode===13?(r.wrapMultilineText(t.target),i.tryToAutoFitFormatElement(),!1):void 0});this.isInListview||t.focusout(function(){i.isReadOnly()||i._onValueChanged()})},r.prototype.getVerticalAlignmentForFormatLabel=function(){return n.CellVerticalAlignment.Top},r.prototype.shouldNeverShowFormatLabel=function(){return!0},r.prototype.getFormaterOfFormatLabel=function(){return"@"},r.prototype.getValueToFormat=function(){var t=this._$input.val();return n.Common.IsEmpty(t)?"":t+"@"},r.prototype.tryToAutoFitFormatElement=function(){(this.shouldAutoFitInRows||this.shouldAutoFitInColumns)&&(this.changeFormatElement(),this.shouldAutoFitInRows&&this._$input.css("overflow","hidden"))},r.prototype.wrapMultilineText=function(n){var t=n.selectionStart,i=n.value,r=i.substr(0,t),u=i.substr(n.selectionEnd);$(n).val(r+"\n"+u);t=t+1;n.setSelectionRange(t,t)},r.StyleTemplateHelper=new i("Forguncy.MultilineTextBox"),r}(t);n.MultilineTextBoxCellType=f;e=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.NumberCellTypeData(t)},r.prototype.initInputElement=function(t){var i=this;t.attr("type","number");this.isInListview||t.focusout(function(){i.isReadOnly()||i.isDisabled()||!n.Platform.isIOSDevice()||i.getValueFromElement(!1)!==null||t.val(null);window.getSelection&&window.getSelection().empty&&window.getSelection().empty()})},r.prototype.getValueFromElement=function(i){var u=t.prototype.getValueFromElement.call(this,i),r;return n.Common.IsEmpty(u)?null:(r=Number(u),isNaN(r)?null:r)},r.StyleTemplateHelper=new i("Forguncy.NumberCellType"),r}(t);n.NumberCellType_Mobile=e;o=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.DateCellTypeData(t)},r.prototype.initInputElement=function(n){n.attr("type","date");this.addClassInSimulator(n);var t=this;n.on("focus",function(){t.isReadOnly()&&$(this).trigger("blur")});n.on("touchstart",function(){if(t.isReadOnly())return!1})},r.prototype.bindValueChangedEvent=function(i){var r=this;n.Platform.isIOSDevice()?(i.blur(function(){r.isReadOnly()||r._onValueChanged()}),this.isInListview||i.focusout(function(){r.isReadOnly()||r.isDisabled()||setTimeout(function(){r._onValueChanged()},200)})):t.prototype.bindValueChangedEvent.call(this,i)},r.prototype.initDefaultValue=function(t){var i=this.cellTypeData.getDefaultValue();this._setValue(t,i);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:i},1)},r.prototype.getValueFromElement=function(){var i,t;return this._$input?(i=this._$input.val(),n.Common.IsEmpty(i))?null:(t=new Date(i),isNaN(t.valueOf())?null:(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),n.Convertor.fromDateToOADate(t))):null},r.prototype.setValueToElement=function(n,i){try{t.prototype.setValueToElement.call(this,n,this.getDateString(i))}catch(r){}},r.prototype.getDateString=function(t){var i;if(!n.DateHelper.isValidDateValue(t))return null;i=t;typeof t=="number"&&(i=n.Convertor.fromOADateToDate(t));var r=i.getMonth()+1,u=i.getDate(),f=(r<10?"0":"")+r,e=(u<10?"0":"")+u;return[i.getFullYear(),f,e].join("-")},r.StyleTemplateHelper=new i("Forguncy.DateCellType"),r}(t);n.DateCellType_Mobile=o;s=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.TimeCellTypeData(t)},r.prototype.initInputElement=function(n){n.attr("type","time");this.addClassInSimulator(n);var t=this;n.on("focus",function(){t.isReadOnly()&&$(this).trigger("blur")});n.on("touchstart",function(){if(t.isReadOnly())return!1})},r.prototype.bindValueChangedEvent=function(i){var r=this;n.Platform.isIOSDevice()?(i.blur(function(){r.isReadOnly()||r._onValueChanged()}),this.isInListview||i.focusout(function(){r.isReadOnly()||r.isDisabled()||setTimeout(function(){r._onValueChanged()},200)})):t.prototype.bindValueChangedEvent.call(this,i)},r.prototype.initDefaultValue=function(t){var i=this.cellTypeData.getDefaultValue();this._setValue(t,i);n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:i},1)},r.prototype.getValueFromElement=function(){var t,i;return this._$input?(t=this._$input.val(),n.Common.IsEmpty(t))?null:n.Common.isValidateTime(t)?(typeof t=="string"&&(t=(t+"").split(".")[0]),i=new Date(n.FormatHelper.getValueFromText(t)),n.Convertor.fromDateToOADate(i)%1):null:null},r.prototype.setValueToElement=function(i,r){try{var u=r;typeof r=="number"&&(u=n.Convertor.fromOADateToDate(r));t.prototype.setValueToElement.call(this,i,this.getTimeString(u))}catch(f){}},r.prototype.getTimeString=function(n){if(!(n instanceof Date))return null;var t=n.getHours(),i=n.getMinutes(),r=n.getSeconds(),u=(t<10?"0":"")+t,f=(i<10?"0":"")+i,e=(r<10?"0":"")+r;return[u,f,e].join(":")},r.prototype.shouldReserveRightSpace=function(){return!0},r.StyleTemplateHelper=new i("Forguncy.TimeCellType"),r}(t);n.TimeCellType_Mobile=s;n.CellTypeHelper.registerCellType("Forguncy.ReadingTextCellType, ServerDesignerCommon",r,u);n.CellTypeHelper.registerCellType("Forguncy.TextCellType, ServerDesignerCommon",r,function(t){return(n.Platform.isMobile()||!t.CellType.ReadingTextInfo)&&!t.CellType.ShowPassword});n.CellTypeHelper.registerCellType("Forguncy.MultilineTextBox, ServerDesignerCommon",f,function(t){return n.Platform.isMobile()||!t.CellType.ReadingTextInfo});n.CellTypeHelper.registerCellType("Forguncy.NumberCellType, ServerDesignerCommon",e,u);n.CellTypeHelper.registerCellType("Forguncy.DateCellType, ServerDesignerCommon",o,u);n.CellTypeHelper.registerCellType("Forguncy.TimeCellType, ServerDesignerCommon",s,u)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){function u(){return n.Platform.isMobile()}var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.OnTemplateStyleApplied=function(t,i){if(n.prototype.OnTemplateStyleApplied.call(this,t,i),t&&i){var r=i.find("select");r.length>0&&(r.css("outline","none"),r[0].style.color===""&&r.css("color","inherit"))}},t}(n.InputCellTypeStyleTemplateHelperBase),t,r;n.MobileComboBoxCellTypeStyleTemplateHelper=i;t=function(t){function r(i,r,u,f){var e=t.call(this,i,r,u,f)||this;return e._dataName="item",e._initingValues=!1,e.supportedEvents=["selectionchanged"],n.ItemsCellTypeHelper.prepareMetaData(i.CellType),e}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},r.prototype.getOffsetCondition=function(){return null},r.prototype.createCellContent=function(){var u=this.CellElement,t=n.DomUtilities.createJqueryDomElement("select"),f,r,i;return this._$select=t,f=n.CellDomCreateHelper.createControlContainer(),f.append(t),n.CellDomCreateHelper.initalInputBox(u,t,this._getDomCreateInfo()),t.css("background-color","transparent"),n.ItemsCellTypeHelper.initItems(this,u,t,this._getDomCreateInfo()),r=this.cellTypeData.getDefaultValue(),n.Common.IsEmpty(r)||(n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:r},1),this._setValue(t,r)),n.ItemsCellTypeHelper.initItemsQuery(this,u,t,this._getDomCreateInfo()),this.isInListview||(i=this,t.change(function(){i._initingValues||i.isReadOnly()||(i._onValueChanged(),n.Page&&i.trigger("selectionchanged",{}))}),t.focusout(function(){i.isReadOnly()||i.validate()})),f},r.prototype.getValueToFormat=function(){var n=this.getSelectedItem();return n?n.DisplayValueBeforeFormat:null},r.prototype.setItems=function(t,i,r){var o=this.getItems(r,this.CellElement.StyleInfo.Formatter),s=i,h,e,u,f;this._initingValues=!0;try{for(s.empty(),h=o.length,e=0;e<h;e++)u=o[e],f=n.DomUtilities.createJqueryDomElement("option"),n.Common.IsEmpty(u.DisplayValue)&&(u.DisplayValue=""),f.append(n.Common.htmlEncode(u.DisplayValue)),n.Common.IsEmpty(u.Forecolor)?f.css("color","black"):f.css("color",n.ColorHelper.Convert(u.Forecolor)),f.data(this._dataName,u),s.append(f)}finally{this._initingValues=!1}this.updateValue(o)},r.prototype.getItems=function(t,i){return n.ComboCellHelper.getFormattedItems(t.Items,i)},r.prototype.updateValue=function(t){for(var r,f,u=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),e=t.length,i=0;i<e;i++)if(n.Common.isEquals(u,t[i].Value)){if(n.Common.IsEmpty(u)&&i>0)continue;return}r=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValueType(this.ID);(r===0||r===1)&&(f=t.length===0?null:t[0].Value,n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this.ID,{newValue:f},r))},r.prototype.setValueToElement=function(t,i){var r;if(t.length===0)return null;var u=t[0],f=u.options,o=f.length,e=-1;for(r=0;r<o;r++)if(n.ComboCellHelper.isComboBoxItemEqual(i,$(f[r]).data(this._dataName).Value)){e=r;break}u.selectedIndex=e;this.changeFormatElement()},r.prototype.getValueFromElement=function(){var n=this.getSelectedItem();return n?n.Value:null},r.prototype.getSelectedItem=function(){var i=this._$select,n,t,r;return i?(n=i[0],t=n.selectedIndex,t<0)?null:(r=$(n.options[t]),r.data(this._dataName)):null},r.prototype.reload=function(){var t=this.CellElement.CellType;t.IsBounding&&(t.haveLoadItems=!1,n.ItemsCellTypeHelper.initItems(this,this.CellElement,this._$select,this._getDomCreateInfo()))},r.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return n.IsBounding?[n.DataSource]:null},r.prototype._endWaitingServerData=function(){t.prototype._endWaitingServerData.call(this);this._$select&&this.changeFormatElement()},r.prototype.setForeColorToInput=function(t){var i=this._$select;i&&(t?i.css("color",n.ColorHelper.Convert(t)):i.css("color",""))},r.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return this._$select?this._$select.add(n):n},r.prototype._disable=function(n){this.updateSelectDisabledProperty();t.prototype._disable.call(this,n)},r.prototype._enable=function(n){this.updateSelectDisabledProperty();t.prototype._enable.call(this,n)},r.prototype.updateReadOnlyStatus=function(){this.updateSelectDisabledProperty()},r.prototype.updateSelectDisabledProperty=function(){if(this._$select){var n=!this.isDisabled()&&!this.isReadOnly();n?this._$select.removeAttr("disabled"):this._$select.attr("disabled","disabled")}},r.prototype.getHorizontalAlignmentForFormatLabel=function(){return n.CellHorizontalAlignment.Left},r.prototype.destroy=function(){this._$select=null;t.prototype.destroy.call(this)},r.prototype.getListviewNoneEditModeText=function(i,r,u,f){f===void 0&&(f=null);var e=n.ComboCellHelper.getDisplayValue(this.CellElement.CellType,i,r,this.CellElement.StyleInfo.Formatter,this.designerPageName,this.runTimePageName,f);return e!==null?e:t.prototype.getListviewNoneEditModeText.call(this,i,r,u,f)},r.prototype.onFormatterChanged=function(){t.prototype.onFormatterChanged.call(this);var i=$("#"+this.ID);i.length===1&&n.ItemsCellTypeHelper.initItems(this,this.CellElement,i,this._getDomCreateInfo())},r.prototype.GetDisplayTextForCommand=function(){var n=this.getSelectedItem();return{DisplayText:n===null||n===void 0?void 0:n.DisplayValue}},r.prototype.ReloadForCommand=function(){this.reload()},r.prototype.SetItemsByStringArray=function(t){n.ItemsCellTypeHelper.SetItemsByStringArray(this,this._$select,this._getDomCreateInfo(),t)},r.prototype.SetItemsByObjectArray=function(t,i,r){n.ItemsCellTypeHelper.SetItemsByObjectArray(this,this._$select,this._getDomCreateInfo(),t,i,r)},r.StyleTemplateHelper=new i("Forguncy.DropDownListCellType"),r}(n.SupportFormatCellType);n.ComboBoxCellType_Mobile=t;r=function(t){function r(n,i,r,u){var f=t.call(this,n,i,r,u)||this,e;return f.NAME="Name",f.FULLNAME="FullName",f.EMAIL="Email",e=n.CellType,e.haveLoadItems=!1,f}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.getItems=function(t){var r=[],f=this.CellElement.CellType,i,o,s,u,e,h;if(f.AddNullItemWhenBinding&&r.push({Value:null,DisplayValue:n.Common.IsEmpty(f.NoneItemText)?"":f.NoneItemText}),i=t.Properties.users,!i||i.length===0)return r;for(o=this.CellElement.CellType.MobileDisplayColumnName,s=i.length,u=0;u<s;u++)e=i[u],h=this.getUserInfoProperty(e,o),r.push({Value:e.UserName,DisplayValue:h});return r},r.prototype.getUserInfoProperty=function(t,i){if(n.Common.IsEmpty(i))return t.UserName;switch(i){case this.NAME:return t.UserName;case this.FULLNAME:return t.FullName;case this.EMAIL:return t.Email;default:return n.UserInfoHelper.getUserPropertyValue(t,i)}},r.prototype.reload=function(){},r.prototype.getListviewNoneEditModeText=function(i,r,u,f){f===void 0&&(f=null);var e=n.UserSelectorCellHelper.getDisplayValue(this.CellElement.CellType,i,r);return e!==null?e:t.prototype.getListviewNoneEditModeText.call(this,i,r,u,f)},r.StyleTemplateHelper=new i("Forguncy.UserCellType"),r}(t);n.UserSelectorCellType_Mobile=r;n.CellTypeHelper.registerCellType("Forguncy.DropDownListCellType, ServerDesignerCommon",t,u);n.CellTypeHelper.registerCellType("Forguncy.UserCellType, ServerDesignerCommon",r,u)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var i=function(){function t(){}return t.getUniqueSubPageIndex=function(){return t._subPageIndex++},t.destroySubPage=function(t,i){if(!n.Common.IsEmpty(t)){n.ForguncyData.pageInfo.pageElementManager&&n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().filter(function(n){return n.cellType instanceof r&&n.cellType.runTimePageName===t}).forEach(function(n){n.cellType.destroyAllPages()});var u=[t,i].filter(function(n){return!!n});n.DependenceCellValueChangeHelper.destoryRunTimePage(u);n.ForguncyData.pageInfo.formulaManager.destroyRunTimePage(u);n.ForguncyData.pageInfo.pageElementManager.destoryRunTimePage(u);n.HubManager.destoryRunTimePage(u)}},t._subPageIndex=1,t}(),r,u,f,t,e,o;n.SubPageHelper=i;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._getPartsUseFontStyle=function(){return null},t.prototype._getContainerOverflowValueStr=function(n){switch(n){case 0:return"visible";case 1:return"auto";default:return"hidden"}},t}(n.CellTypeBaseWithSimplebar);n.ContainerCellTypeBase=r;u=function(t){function r(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f.subPageInfos=[],f.supportedEvents=["subpagechanged"],f}return __extends(r,t),r.prototype.needValidate=function(){return!1},r.prototype._loadContent=function(t,i,r){var u,f;if(r===void 0&&(r=!1),u=this,n.Common.IsEmpty(t)){u._emptyContent(i);return}if(u.isCircularReferencePage(t)){f=n.Common.format(n.RS.ContainerCellType_Error_CircularReference,t);alert(f);u._emptyContent(i);n.ErrorHelper.printErrorStr(f);return}n.MetadataLoader.GetMetadataRequest(t,{isSubPage:!0,isUserControl:r},function(f){if(!f){u._emptyContent(i);return}if(n.ForguncyData.pageInfo.pageID===u._pageID){var e=f;u.needQueryAutoID(e)?n.HomeController.GetAutoGeneratedIDsOfPage(e.pageName,function(n){e.autoGeneratedIDs=n;u._createSubPage(t,f,i,r)}):u._createSubPage(t,f,i,r)}})},r.prototype.needQueryAutoID=function(t){var i,u,r,f;if(!t.autoGeneratedIDs)return!1;for(i in t.autoGeneratedIDs)for(u in t.autoGeneratedIDs[i])if((r=t.autoGeneratedIDs[i][u],!r.Fields)&&!r.ID)if(f=n.ForguncyData.pageInfo.autoIDManager.getAutoIDByBindingInfo({TableName:i,ColumnName:u}),f)r.ID=f.id;else return!0;return!1},r.prototype._emptyContent=function(n){this.subPageInfos[n]=undefined;this.onPageIsReady(n);this.trigger("pageingInfoChanged",{tabIndex:n});this.trigger("loaded",{tabIndex:n});this.trigger("pagedefaultdataloaded",{tabIndex:n})},r.prototype.getChildrenCells=function(){var t=[],n,i,r;if(this.subPageInfos)for(n=0,i=this.subPageInfos;n<i.length;n++)r=i[n],t.push.apply(t,r.childrens);return t},r.prototype._createSubPage=function(t,r,u,f){var c,l,o,e,a,v,p;if(f===void 0&&(f=!1),o=this,e=n.MetadataHelper.createPageMetadata(r),n.MetadataHelper.checkError(e)===!1){o._emptyContent(u);return}if(!f&&e.pageName!==t&&n.BuiltInPageManager.isBuiltInPage(e.pageName)){a=!1;n.Common.forguncyPostSync("Home/PageNameExisted",{PageName:t,IsUserControl:f},function(n){a=n});a?o._navigateToNewPage(e,t):(o._emptyContent(u),alert(n.Common.format(n.RS.ContainerCellType_Error_NoExistedPage,t)));return}var y=i.getUniqueSubPageIndex(),s=n.StaticValues.RunTimeNormalPage+y,h=n.StaticValues.RunTimeMasterPage+y;o.subPageInfos[u]&&(v=[o.subPageInfos[u].runTimeNormalPageName,o.subPageInfos[u].runTimeMasterPageName].filter(function(n){return!!n}),v.length>0&&n.ForguncyData.pageInfo.formulaManager.preDestroyRunTimePage(v));o.subPageInfos[u]={runTimeNormalPageName:s,runTimeMasterPageName:h,designerPageName:e.PageSettings.Name,designerMasterPageName:e.MasterPage?e.MasterPage.PageSettings.Name:null,pageLoadedCommand:e.PageSettings.PageLoadedCommandList,propertyValueChangedCommand:e.PageSettings.PropertyValueChangedCommand,masterPageLoadedCommand:(l=(c=e.masterPageMetaDataObj)===null||c===void 0?void 0:c.PageSettings)===null||l===void 0?void 0:l.PageLoadedCommandList,isLoading:!0,childrens:[]};o.trigger("pageingInfoChanged",{tabIndex:u});n.ForguncyData.pageInfo.enableTabIndex=n.ForguncyData.pageInfo.enableTabIndex||{};e.PageSettings.EnableTabIndex&&(n.ForguncyData.pageInfo.enableTabIndex[s]=e.PageSettings.EnableTabIndex);p=new n.ForguncyDataSetter(e,n.ForguncyData.pageInfo,s,h,3);p.setPageInfoByMetadata();var w=function(){o.onPageContentAppended(e,u)},b=n.PageBuilder.loadUserJavaScript(e,w),k={subPageInfo:o.subPageInfos[u],ownerCell:o.owner},d=n.Presentation.PageContentCreator.create(e,s,h,3,2,k),g=o.getSubPageContainerID(u);$("#"+g).append(d);n.PageBuilder.onLoad([s,h]);b&&w()},r.prototype._navigateToNewPage=function(t,i){var r;n.Common.IsEmpty(t.ReturnUrl)||(t.ReturnUrl=((r=n.ForguncyData.pageInfoStack)===null||r===void 0?void 0:r.length)>0?n.ForguncyData.pageInfoStack[0].pageName:n.ForguncyData.pageInfo.pageName,t.noPermissionPage=i);n.PageBuilder.pageCover.show();n.Common.initalTimeStamp();n.PageBuilder.createPage(t,null)},r.prototype.getSubPageContainerID=function(){return null},r.prototype.containRunTimePage=function(n){return this.subPageInfos.some(function(t){return t&&(t.runTimeMasterPageName===n||t.runTimeNormalPageName===n)})},r.prototype.getDesignerPageName=function(n,t){for(var i,r=0;r<this.subPageInfos.length;r++)if(i=this.subPageInfos[r],i){if(i.runTimeNormalPageName===n)return i.designerPageName;if(i.runTimeMasterPageName===n)return t?i.designerPageName:i.designerMasterPageName}return null},r.prototype.getRunTimePageName=function(n){for(var t,i=0;i<this.subPageInfos.length;i++)if(t=this.subPageInfos[i],t){if(t.designerPageName===n)return t.runTimeNormalPageName;if(t.designerMasterPageName===n)return t.runTimeMasterPageName}return null},r.prototype.getTabIndex=function(n){for(var i,t=0;t<this.subPageInfos.length;t++)if(i=this.subPageInfos[t],i&&(i.runTimeNormalPageName===n||i.runTimeMasterPageName===n))return t;return-1},r.prototype.onPageContentAppended=function(t,i){var r=this.subPageInfos[i];if(this.InitDefaultDataAndModels(t,r),this.trigger("loaded",{tabIndex:i}),n.PageBuilder.hasCallOnPageLoaded)n.PageBuilder.onPageLoaded([r.runTimeNormalPageName,r.runTimeMasterPageName]);n.PageBuilder.hasExecutePageLoadedCommand&&this.initBindingDataAndExecutePageLoadedCommand(i)},r.prototype.InitDefaultDataAndModels=function(t,i){n.PageBuilder.initDefaultDataAndModels(t,i.runTimeNormalPageName,i.runTimeMasterPageName)},r.prototype.initBindingDataAndExecutePageLoadedCommand=function(t){var r=this.subPageInfos[t],i=[r.runTimeNormalPageName,r.runTimeMasterPageName];n.ForguncyData.pageInfo.currentRowInfoCollection.list.forEach(function(t){var r=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(i),u;r.forEach(function(n){return n.onCurrentRowInfoChanged(t.currentTable)});u=n.ForguncyData.pageInfo.pageElementManager.backgroundImages.getBackgroundImages(i);(r.some(function(n){return n.bindingInfo})||u.some(function(n){return n.bindingInfo}))&&n.ForguncyData.pageInfo.normalCellBindingManager.getBindingValuesFromServer(t.currentTable,t.query)});n.PageBuilder.fillAllListviewData(i);this.executeOneTabLoadedCommand(t)},r.prototype.executePageLoadedCommand=function(){var n=this;this.subPageInfos.forEach(function(t,i){return n.executeOneTabLoadedCommand(i)})},r.prototype.executeOneTabLoadedCommand=function(t){var r=this,i=this.subPageInfos[t],u,f;if(!i){r.trigger("pagedefaultdataloaded",{tabIndex:t});return}u=[i.runTimeNormalPageName,i.runTimeMasterPageName];f=function(){n.DelayOperateHelper.Push(null,function(){n.DelayRefresh.Push(null,function(){n.ForguncyData.pageInfo.defaultFormulaManager.clearDefaultFormula(u)},"clearDefaultFormula"+i.runTimeNormalPageName);r.onPageIsReady(t);$(document).trigger("initPageData");r.trigger("pagedefaultdataloaded",{tabIndex:t});n.ForguncyData.pageInfo.pageElementManager.resizePageElements(u);i.isLoading=!1},1)};this._executePageLoadedCommands(i.runTimeMasterPageName,i.masterPageLoadedCommand,i.runTimeNormalPageName,i.pageLoadedCommand,f)},r.prototype._executePageLoadedCommands=function(t,i,r,u,f){if(!n.ForguncyData.commandExcutor){f();return}var o=i&&i.length>0,e=u&&u.length>0;if(!o&&!e){f();return}o&&n.ForguncyData.commandExcutor.excuteCommand(i,{runTimePageName:t,commandTrigger:null,commandID:t,eventType:"pageloaded",callbackOnCommandCompleted:function(){e||f()}});e&&n.ForguncyData.commandExcutor.excuteCommand(u,{runTimePageName:r,commandTrigger:null,commandID:r,eventType:"pageloaded",callbackOnCommandCompleted:function(){f()}})},r.prototype.onPageIsReady=function(){},r.prototype.triggerPageLoadedEvent=function(){var n=this;n.subPageInfos.forEach(function(t,i){n.trigger("loaded",{tabIndex:i})})},r.prototype.isLoading=function(){return this.subPageInfos.some(function(n){return n.isLoading})},r.prototype.isCircularReferencePage=function(t){var i=n.PageManager.getLocatedNormalPageNames(this.runTimePageName);return i.indexOf(t)>=0},r.prototype.destroyAllPages=function(){this.subPageInfos.forEach(function(n){n&&i.destroySubPage(n.runTimeNormalPageName,n.runTimeMasterPageName)})},r.prototype.resizeUIElement=function(t){var i=n.PageManager.getAllRunTimePageNames(this.subPageInfos[t]);n.ForguncyData.pageInfo.pageElementManager.resizePageElements(i)},r}(r);n.SubPageContainerCellTypeBase=u;f=function(r){function u(){return r!==null&&r.apply(this,arguments)||this}return __extends(u,r),u.prototype.prepareCreateNewPage=function(){this.getContainer().css("pointer-events","none");this._oldSubPageContainerID=this._subPageContainerID;this._oldSubPageInfo=this.subPageInfos[0];this._subPageContainerID=this.createNewSubPageContainerID();var n=$("#"+this.ID);this.createContentContainer(n);$("#"+this.getSubPageContainerID(0)).css("display","none")},u.prototype.createContentContainer=function(t){var i=n.DomUtilities.createJqueryDomElement("div");i.css("height","100%");i.attr("id",this.getSubPageContainerID(0));t.append(i)},u.prototype.onPageIsReady=function(t){if(this.getContainer().scrollLeft(0).scrollTop(0),this.destroyOldPage(),this._oldSubPageContainerID=null,this._oldSubPageInfo=null,this.getContainer().css("pointer-events",""),!n.PageBuilder.pageIsLoading){var i=this.subPageInfos[t];if(i)n.ForguncyData.pageDirtyCheckManager.onSubPageLoaded([i.runTimeNormalPageName,i.runTimeMasterPageName])}},u.prototype.destroyOldPage=function(){$("#"+this.getSubPageContainerID(0)).css("display","");this._oldSubPageInfo&&i.destroySubPage(this._oldSubPageInfo.runTimeNormalPageName,this._oldSubPageInfo.runTimeMasterPageName);this._oldSubPageContainerID&&$("#"+this._oldSubPageContainerID).remove()},u.prototype.createNewSubPageContainerID=function(){return t._index++,this.ID+"_content"+t._index},u.prototype._setVisible=function(n,t){var u,i;if(r.prototype._setVisible.call(this,n,t),t&&((u=this.subPageInfos)===null||u===void 0?void 0:u.length)>0)for(i=0;i<this.subPageInfos.length;i++)this.resizeUIElement(i)},u.prototype.getSubPageContainerID=function(){return this._subPageContainerID},u.prototype.createContent=function(){var r=this,t,i;return this._subPageContainerID=this.createNewSubPageContainerID(),t=n.DomUtilities.createJqueryDomElement("div"),t.attr("id",this.ID),t.addClass("fgc-adjust-container"),this.createContentContainer(t),i=this.getDefaultPageName(),this._pageName=i,n.DelayRefresh.setTimeout(function(){r._pageName===i&&r.loadSubPage(i)}),t},u.prototype.loadSubPage=function(n){this._pageName=n;this._loadContent(this._pageName,0,this.isUserControl())},u.prototype.getDefaultPageName=function(){return null},u.prototype._setOverflowHidden=function(t){n.DomUtilities.setContainerOverFlow(t,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode))},u.prototype.isUserControl=function(){return!1},u}(u);n.SinglePageContainerCellType=f;t=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f.supportedEvents=["loaded","pagedefaultdataloaded","subpagechanged"],f}return __extends(i,t),i.prototype.getDefaultValue=function(){var t=this.CellElement.CellType.PageName;return{Value:n.Common.IsEmpty(t)?null:t}},i.prototype.getDefaultPageName=function(){return this.CellElement.CellType.PageName},i.prototype._isSamePage=function(t,i){return n.Common.IsEmpty(t)&&n.Common.IsEmpty(i)?!0:t===i},i.prototype.setValueToElement=function(t,i){if(!this._isSamePage(i,this._pageName)){this.prepareCreateNewPage();var r=n.Common.IsEmpty(i)?null:i+"";this.loadSubPage(r)}},i._index=0,i}(f);n.ContentContainerCellType=t;e=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._defaultActiveTabIndex=0,n._tabs=[],n._tabCount=0,n}return __extends(i,t),i.prototype.createContent=function(){var t=this,r=this.CellElement.CellType,i=r.Tabs,u;return!i||i.length<=0?null:(t._tabCount=i.length,t._defaultActiveTabIndex=r.ActiveTabIndex,t.initStyleInfo(),u=t.createContainer(i.length),this.needAddCSSRule()&&!r.HideHeader&&o.addCSSRule(t.ID,t.designerPageName,u,t._colors),n.DelayRefresh.setTimeout(function(){i.forEach(function(n,i){return t._loadContent(n,i)})}),u)},i.prototype._setOverflowHidden=function(n){this.setContainerOverFlow(n)},i.prototype.setContainerOverFlow=function(t){this.CellElement.CellType.OverflowMode===0?n.DomUtilities.setContainerOverFlow(t,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode)):n.DomUtilities.setContainerOverFlow(t,"hidden")},i.prototype.getTabCount=function(){return this._tabCount},i.prototype.createContainer=function(t){var i=n.DomUtilities.createJqueryDomElement("div"),r;return i.attr("id",this.ID),i.css("box-sizing","border-box"),i.css("height","100%"),i.css("display","flex"),i.css("flex-direction","column"),this.setContainerOverFlow(i),r=this.createHeaderPart(t),i.append(r),i.append(this.createContentPart(t)),this.CellElement.CellType.HideHeader?r.css("display","none"):i.css("border-bottom","1px solid "+n.ColorHelper.Convert(this._colors.BorderColor)),i},i.prototype.createHeaderPart=function(t){var i=n.DomUtilities.createJqueryDomElement("UL"),r;for(i.css("display","table"),i.css("margin-top",0),i.css("width","100%"),i.addClass("nav"),i.addClass("nav-tabs"),i.addClass("tabCell-nav-tabs"),i.css("border-color",n.ColorHelper.Convert(this._colors.BorderColor)),r=0;r<t;r++)i.append(this.createHeaderLI(r));return i},i.prototype.createHeaderLI=function(t){var f=this,r=n.DomUtilities.createJqueryDomElement("li"),u;return r.attr(i._tabIndexStr,t),u=this.createHeaderText(this.getHeaderID(t),this.getSubPageContainerID(t)),function(n){u.click(function(){return f.showTab(n,this),!1})}(t),r.append(u),r},i.prototype.createHeaderText=function(t,i){var r=n.DomUtilities.createJqueryDomElement("a");return r.attr("data-toggle","_tab"),r.attr("href","#"+i),r.attr("id",t),r.css("padding","7px 10px"),n.DomUtilities.setPropertyToDom(this.CellElement,r,this._getDomCreateInfo(),[0]),r.css("color",""),r},i.prototype.createContentPart=function(t){var i=n.DomUtilities.createJqueryDomElement("div"),u,r;for(i.addClass("tab-content"),i.css("box-sizing","border-box"),i.css("flex-grow","1"),i.css("flex-shrink","1"),this.CellElement.CellType.HideHeader||(u=n.ColorHelper.Convert(this._colors.BorderColor),i.css("border-left","1px solid "+u),i.css("border-right","1px solid "+u)),this.setContainerOverFlow(i),r=0;r<t;r++)i.append(this.createTabContent(r));return i},i.prototype.createTabContent=function(t){var i=n.DomUtilities.createJqueryDomElement("div");return i.attr("id",this.getSubPageContainerID(t)),i.addClass("tab-pane"),i.addClass("fade"),i.css("height","100%"),n.DomUtilities.setContainerOverFlow(i,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode)),i.css("margin","0px"),t===0&&(i.addClass("in"),i.addClass("active")),i},i.prototype.getSubPageContainerID=function(n){return this.ID+"tab"+n},i.prototype.getHeaderID=function(n){return this.ID+"header"+n},i.prototype.onPageContentAppended=function(n,i){var r=this.getHeaderID(i);$("#"+r).text(n.PageSettings.Title);t.prototype.onPageContentAppended.call(this,n,i)},i.prototype.needAddCSSRule=function(){for(var n in this._colors)if(this._colors[n]!==i._defaultColors[n])return!0;return!1},i.prototype.initStyleInfo=function(){var t=this.CellElement.CellType.Style;this._colors=t?__assign({},t):__assign({},i._defaultColors);this._colors.Color=this.CellElement.StyleInfo?n.ColorHelper.Convert(this.CellElement.StyleInfo.Foreground):i._defaultColors.Color},i.prototype.onLoad=function(){this.showTab(this._defaultActiveTabIndex)},i.prototype.showTab=function(t,i){if(!(t<0)&&!(t>=this._tabCount)){if(!this._tabs[t]){if(i||(i=$("#"+this.getHeaderID(t))[0]),!i)return;this._tabs[t]=new n.Tab(i)}this._tabs[t].show();this.onTabVisible(t)}},i.prototype.onTabVisible=function(t){if(this.getActiveTabIndex()===t){var i=this;if($("#"+this.getSubPageContainerID(t)).css("display")==="none"){n.DelayRefresh.setTimeout(function(){i.onTabVisible(t)},50);return}this.resizeUIElement(t);this.reValidate(t)}},i.prototype.reValidate=function(t){var i,r;$("#"+this.getSubPageContainerID(t)).find(".tooltip-arrow").length<=0||(i=n.PageManager.getAllRunTimePageNames(this.subPageInfos[t]),n.ValidationMananger.validateAllCells(!1,i),r=n.ListviewBase.getAllListviews(i),r.forEach(function(n){n.stopEditingActiveCell()}))},i.prototype.getActiveTabIndex=function(){var n=Number($("#"+this.ID).children("ul").find(".active").attr(i._tabIndexStr));return isNaN(n)?-1:n},i.prototype._setVisible=function(n,i){var r,u;t.prototype._setVisible.call(this,n,i);i&&((r=this.subPageInfos)===null||r===void 0?void 0:r.length)>0&&(u=this.getActiveTabIndex(),u>=0&&this.resizeUIElement(u))},i.prototype.SetActiveTabIndex=function(n){this.showTab(n-1)},i._defaultColors={BorderColor:"#A9A9A9",Color:"#337AB7",HoverColor:"#23527C",ActiveColor:"#555555"},i._tabIndexStr="tabid",i}(u);n.TabControlCellType=e;o=function(){function t(n,t){this._className=n;this._colors=t}return t.addCSSRule=function(n,i,r,u){var f=t.getClassName(i,n),e;r.addClass(f);t._classNameCache.indexOf(f)===-1&&(t._classNameCache.push(f),e=new t(f,u),e.addStyle())},t.getClassName=function(i,r){var f=n.Common.parseIDStr(r),u=t._pageNameCache.indexOf(i);return u===-1&&(u=t._pageNameCache.length,t._pageNameCache.push(i)),"tabControlStyle"+u+"_"+f.row+"_"+f.col},t.prototype.addStyle=function(){var t=[this.getNormalStatusCssStr(),this.getHoverStatusCssStr(),this.getActiveStatusCssStr()];n.CSSHelper.addCSSRules(t,this._className)},t.prototype.getNormalStatusCssStr=function(){return"."+this._className+" > .nav-tabs > li > a { color: "+n.ColorHelper.Convert(this._colors.Color)+"; }"},t.prototype.getHoverStatusCssStr=function(){return"."+this._className+" > .nav-tabs > li > a:hover,."+this._className+" > .nav-tabs > li > a:focus { color: "+n.ColorHelper.Convert(this._colors.HoverColor)+"; border-bottom-color: "+n.ColorHelper.Convert(this._colors.BorderColor)+";}"},t.prototype.getActiveStatusCssStr=function(){return"."+this._className+" > .nav-tabs > li.active > a,."+this._className+" > .nav-tabs > li.active > a:hover,."+this._className+" > .nav-tabs > li.active > a:focus { color: "+n.ColorHelper.Convert(this._colors.ActiveColor)+"; border: 1px solid "+n.ColorHelper.Convert(this._colors.BorderColor)+"; border-bottom-color: transparent;}"},t._pageNameCache=[],t._classNameCache=[],t}();n.CellTypeHelper.registerCellType("Forguncy.ContentContainerCellType, ServerDesignerCommon",t);n.CellTypeHelper.registerCellType("Forguncy.TabControlCellType, ServerDesignerCommon",e)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var r="Fgc-Listview-Selection-State-Column",e=function(e){function s(t,i,r,f){var o=e.call(this,t,i,r,f)||this;return o._runTimePageNames=[],o._hasNewRow=!1,o._suspendLoadOnDemand=!0,o._refreshSuspendCount=0,o._ignoreListviewValueChanged=!1,o._repeaterCellTypeStyleTemplateHelper=new u,o._needUpdateWaitingBlockWhenScroll=!1,o._hasError=!1,o._refreshWaitList=[],o._listviewDataID=0,o._eventTriggerID=0,o._waitingList=[],o.supportedEvents=["subpagechanged"],o._needUpdateWaitingBlockWhenScroll=n.PageManager.getPageStretchInfo(o.runTimePageName).StretchMode===4,o}return __extends(s,e),s.prototype.create=function(t){e.prototype.create.call(this,t);n.DomUtilities.setContainerOverFlow(t,this._getContainerOverflowValueStr(this.CellElement.CellType.OverflowMode))},s.prototype.needLoadOnDemand=function(){var u,f,e;if(this._suspendLoadOnDemand)return!1;var n=this.CellElement.CellType,o=n.DisplayMode===t.Vertical||n.DisplayMode===t.Flow&&n.FlowDirection===i.Row,r=0;if(o){if(u=this._scrollElement.scrollTop(),f=this.getItemsTotalLength(),u===0||f===0)return!1;r=u+this._scrollElement.height()-f}else{if(e=this._scrollElement.scrollLeft(),e===0)return!1;r=e+this._scrollElement.width()-this._scrollElement[0].scrollWidth}return r>-5?!0:!1},s.prototype.getItemsTotalLength=function(){var u=this._container.find(".repeater-item"),f=u.length,r,s,h,e,c,l,a,o,n,v,y;if(f<=0)return 0;r=u[f-1];s=this.CellElement.CellType;switch(s.DisplayMode){case t.Vertical:return r.offsetTop+r.offsetHeight;case t.Horizontal:return r.offsetLeft+r.offsetWidth;case t.Flow:if(s.FlowDirection===i.Column){for(h=r.offsetLeft,e=h+r.offsetWidth,n=f-2;n>=0;n--){if(c=u[n].offsetLeft,h!==c)break;l=c+u[n].offsetWidth;e<l&&(e=l)}return e}for(a=r.offsetTop,o=a+r.offsetHeight,n=f-2;n>=0;n--){if(v=u[n].offsetTop,a!==v)break;y=v+u[n].offsetHeight;o<y&&(o=y)}return o;default:return 0}},s.prototype.createContent=function(){var n=this.CellElement.CellType;return this._listviewName=n.ListviewName,this._container=this.createContainer(n),this._container},s.prototype.getNewRowData=function(){var r,o,t,i,u,s;if(this._defaultValues)return this._defaultValues;var f=[],h=this._getListData().getColumnCount(),e=this.getTemplateCellRelations();if(e)for(o=this._runTimePageNames[this._runTimePageNames.length-1],t=0;t<h;t++)(i=e[t],i&&i.length!==0)&&(u=i[i.length-1],s=n.Common.getIdStr(u.Row,u.Column,o),f[t]=(r=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(s))===null||r===void 0?void 0:r.getDefaultValue());return this._defaultValues=f,this._defaultValues},s.prototype.initPageByMetaDataData=function(t){var u=this,r,i;if(t){if(t.metaData&&!t.metaDataObj&&(r=JSON.parse(t.metaData),t.metaDataObj=r),t.metaDataObj&&t.metaDataObj.Modules&&!n.ModuleLoader.IsModuleLoaded(t.metaDataObj.Modules)){n.ModuleLoader.LoadModels(t.metaDataObj.Modules,n.ForguncyData.ForguncyRoot).done(function(){u.initPageByMetaDataData(t)});return}(i=n.MetadataHelper.createPageMetadata(t),n.MetadataHelper.checkError(i)!==!1)&&n.ForguncyData.pageInfo.pageID===this._pageID&&(this.updatePageStretchMode(i),this._templatePage=i,this._refresh(null))}},s.prototype.updatePageStretchMode=function(t){var u=n.PageManager.getPageStretchInfo(this.runTimePageName),i=t.PageSettings.PageResponsiveMode,r=i;i===0&&(r=n.Presentation.StretchCommon.getPageResponsiveMode(u.StretchMode));t.PageSettings.PageResponsiveMode=r},s.prototype.createContainer=function(r){var u=n.DomUtilities.createJqueryDomElement("div");u.attr("id",this.ID);u.css("display","flex");u.addClass("repeater-container");switch(r.DisplayMode){case t.Vertical:u.css("flex-wrap","nowrap");u.css("flex-direction","column");this.CellElement.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center?u.css("align-items","center"):this.CellElement.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Right&&u.css("align-items","flex-end");break;case t.Horizontal:u.css("flex-wrap","nowrap");u.css("align-items","flex-start");break;case t.Flow:u.css("flex-wrap","wrap");u.css("align-content","flex-start");r.FlowDirection===i.Column?u.css("flex-direction","column"):u.css("flex-direction","row")}return u.css("height","100%"),u.css("width","100%"),this._containerDisplayMode=u.css("display"),u},s.prototype.onLoad=function(){var t=this,i=this.CellElement.CellType.TemplatePageName,r;if(this._itemsPart=this._container,n.Common.IsEmpty(i)||n.Common.IsEmpty(this._listviewName)||!this.listview){this._hasError=!0;this.updateNoItemImage();return}this._onValueChangedEventHandler=function(n,i){if(i.calcName)t.onListveiwValueChanged(i);else t.onNormalCellValueChanged(i.arg)};n.ForguncyData.pageInfo.dataModel.bind("valuechanged",this._onValueChangedEventHandler);this._onCurrentRowInfoChangedEventHandler=function(n,i){t.refreshCurrentRowStyle(i.newSelectedRowIndex)};this.listview.bind("selectionchanged",this._onCurrentRowInfoChangedEventHandler);this._onSelectionChangedEventHandler=function(){t.onSelectedRowsChanged()};this.listview.bind("selectedrowschanged",this._onSelectionChangedEventHandler);this._currentRowHelper=new o(this.ID,this._container,this._pageID,this.listview);this._currentRowHelper.bind("RepeaterCurrentRowChanged",null,function(n,i){var r=t.listview,u;r&&(u=function(n){return!(n===-1||n===t.newRowIndex)},u(i.oldCurrentRowIndex)&&t.commitListviewRow(i.oldCurrentRowIndex),u(i.newCurrentRowIndex)?r.selectRow(i.newCurrentRowIndex):i.newCurrentRowIndex!==-1&&(r.getNewRowIndex()!==-1?r.selectRow(r.getNewRowIndex()):(r.clearAllSelectedRows(),r.clearCurrentRow())))});this._currentRowHelper.bind("click",null,function(i,r){if(!(r.rowIndex<0)&&r.rowIndex!==t.newRowIndex){var u=t.listview;u&&u.getCurrentRowIndex()===r.rowIndex&&(u instanceof n.HiddenListview||u.listviewData.getSelectionMode()===1)&&u.getSelectedRowsData().length===0&&u.addSelectedRow(r.rowIndex);u&&u.getCurrentRowIndex()===r.rowIndex&&u.getSelectedRowsData().length>1&&u.clearSelectionOutOfCurrentRow()}});this.onDependenceCellValueChanged(function(){t.updateNoItemText()});this._scrollElement=this.getContainer();this.createSimpleBar();this._scrollElement[0].addEventListener("scroll",function(){var n;t._needUpdateWaitingBlockWhenScroll&&(t._needUpdateWaitingBlockWhenScroll=!1,t.showOrHideWaitingBlock());t.needLoadOnDemand()&&(t._suspendLoadOnDemand=!0,(n=t.listview)===null||n===void 0?void 0:n.loadOnDemand())});n.Common.IsEmpty(i)||n.Common.IsEmpty(this._listviewName)||(r=n.MetadataLoader.getMetadataFromCache(i),r?this.initPageByMetaDataData(r):n.MetadataLoader.GetPageDataRequest(i,n.ForguncyData.ForguncyRoot,n.StaticData.MetaDataVersion).done(function(n){t.initPageByMetaDataData(n[i.toLowerCase()])}))},s.prototype.refreshCurrentRowStyle=function(n){var t,r,i;this._repeaterCellTypeStyleTemplateHelper.focusStyleName&&(t=$(".repeater-style-item",this._container),t.removeClass(this._repeaterCellTypeStyleTemplateHelper.focusStyleName),r=n>=0&&n<t.length,i=r?n:this.newRowIndex,i>=0&&$(t[i]).addClass(this._repeaterCellTypeStyleTemplateHelper.focusStyleName))},s.prototype.onSelectedRowsChanged=function(){var t=this.listview,n=t.getSelectedRowsIndexes();this.refreshSelectedCellsDataModel(n);this.refreshSelectedRowStyle(n)},s.prototype.refreshSelectedCellsDataModel=function(t){var r=this.getSelectedCellReleations(),u,i,f,e,o;if(r&&!(r.length<=0))try{for(this._refreshSuspendCount++,u={},i=0,f=t;i<f.length;i++)e=f[i],u[e]=1;o=n.ForguncyData.pageInfo.dataModel.normalCellDataModel;this._runTimePageNames.forEach(function(t,i){return r.forEach(function(r){var f;return o.setValue(n.Common.getIdStr(r.Row,r.Column,t),{newValue:(f=u[i])!==null&&f!==void 0?f:0,uiAction:!1},2)})})}finally{this._refreshSuspendCount--}},s.prototype.refreshSelectedRowStyle=function(n){var u=this._repeaterCellTypeStyleTemplateHelper.selectStyleName,t,i,f,r;if(u)for(t=$(".repeater-style-item",this._container),t.removeClass(u),i=0,f=n;i<f.length;i++)r=f[i],r>=0&&r<t.length&&$(t[r]).addClass(u)},s.prototype.commitListviewRow=function(t){var i=this.listview,r=n.ValidationMananger.validateAllCells(!1,[this._runTimePageNames[t]]);r===0&&i.commitEditChange(!0)},s.prototype.onListveiwValueChanged=function(n){var o=this,f,t,u,r,i,e;if(n.calcName===((f=this.listview)===null||f===void 0?void 0:f.getCalcSheetName())){if(t=n.arg,this._ignoreListviewValueChanged){this._eventTriggerID=Math.max(this._eventTriggerID,t.triggerID);return}if(u=this._eventTriggerID+1,r=t.triggerID,u<r){this._waitingList[r-u]=t;return}u>r&&(t=null);i=this._waitingList.filter(function(n){return!!n});this._waitingList=[];e=!t||t.actionType===0;this._eventTriggerID=Math.max(i.length>0?i[i.length-1].triggerID:-1,r);this._refresh(t);i.length>0&&!e&&i.forEach(function(n){return n&&o._refresh(n)})}},s.prototype.onNormalCellValueChanged=function(t){var o,i,f,u,e,s;if(!(this._refreshSuspendCount>0)&&(o=n.Common.parseIDStr(t.id),o)&&(i=this._runTimePageNames.indexOf(o.suffix),!(i<0))&&(f=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t.id),!n.Common.IsEmpty(f.templateCellSource))&&(u=this.listview,u))if(f.templateCellSource===r){if(i===this.newRowIndex)return;t.newValue===0||t.newValue===!1||n.Common.IsEmpty(t.newValue)?u.clearSelectedRow(i):u.addSelectedRow(i)}else{if(e=u.getColIndexOfNamedColumn(f.templateCellSource,!1),e===-1)return;if(i===this.newRowIndex)this.onValueChangedInNewRow(i,e,t.newValue);else s=this._getListData(),s.setValue(i,e,t.newValue,7)}},s.prototype.onValueChangedInNewRow=function(t,i,r){var e=this,f=n.ValidationMananger.validateAllCells(!1,[this._runTimePageNames[t]]),u;if(f!==1){if(f===2){n.DelayRefresh.setTimeout(function(){e.onValueChangedInNewRow(t,i,r)},100);return}u=n.Common.clone(this.getNewRowData());u[i]=r;this._ignoreListviewValueChanged=!0;try{this.listview.addNewRow(u,!1,!0,6);this.listview.selectRow(t);this._hasNewRow=!1;this._refresh({cellRange:{Row:t+1,Column:-1,RowCount:0,ColumnCount:-1},oldRowCount:t,newRowCount:t+1,uiAction:!0,actionType:1,valueType:6,triggerID:-1})}finally{this._ignoreListviewValueChanged=!1}}},s.prototype._refresh=function(n){if(!this._hasError){var t=this.addToRefreshList(n);t.refreshType===0&&this._listviewDataID++;this.doWaitingRefresh()}},s.prototype.addToRefreshList=function(n){var i,t={refreshType:(i=n===null||n===void 0?void 0:n.actionType)!==null&&i!==void 0?i:0,arg:n},r=this._refreshWaitList.some(function(n){return n.refreshType===0});return r?t:(t.refreshType===0?this._refreshWaitList=[t]:this._refreshWaitList.push(t),t)},s.prototype.doWaitingRefresh=function(){var r=this,t,i;if(!this._hasError&&this._refreshWaitList.length!==0&&!this._currentRefreshInfo){if(t=this._templatePage&&this._getListData(),!t){n.DelayRefresh.setTimeout(function(){r.doWaitingRefresh()},200);return}i=this._refreshWaitList.shift();this.doRefresh(i)}},s.prototype.doRefresh=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:this._currentRefreshInfo={info:n,dataID:this._listviewDataID};t=n.refreshType;switch(t){case 0:return[3,1];case 1:return[3,3];case 4:return[3,3];case 2:return[3,5];case 3:return[3,6]}return[3,7];case 1:return[4,this._onListviewReload()];case 2:return i.sent(),[3,8];case 3:return[4,this._onListviewAddRows(n.arg)];case 4:return i.sent(),[3,8];case 5:return this._onListviewDeleteRows(n.arg),[3,8];case 6:return this._onListviewValueChanged(n.arg),[3,8];case 7:return[3,8];case 8:return this.updateSimpleBar(),this.trigger("subpagechanged",null),this._currentRefreshInfo=null,this.doWaitingRefresh(),[2]}})})},s.prototype._onListviewValueChanged=function(n){this.refreshDataModel(n.cellRange.Row,n.cellRange.Column,n.cellRange.RowCount,n.cellRange.ColumnCount)},s.prototype._onListviewAddRows=function(n){return __awaiter(this,void 0,void 0,function(){var t,i,r,u,f;return __generator(this,function(e){switch(e.label){case 0:return t=n.cellRange.Row,i=n.cellRange.RowCount,[4,this.addRows(t,i)];case 1:return(r=e.sent(),!r)?[2]:(this._suspendLoadOnDemand=!1,u=!this._hasNewRow&&this.listview.allowAddRow(),!u)?[3,3]:[4,this.addRows(null,1)];case 2:if(f=e.sent(),!f)return[2];this._hasNewRow=!0;e.label=3;case 3:return this.showHelpImagePart(),this.refreshDataModel(t,0,i,-1),this.onSelectedRowsChanged(),[2]}})})},s.prototype._onListviewDeleteRows=function(n){this.deleteRows(n.deleteRow,1);this.showHelpImagePart();this.onSelectedRowsChanged()},s.prototype._onListviewReload=function(){return __awaiter(this,void 0,void 0,function(){var n,t,r,i,e,u,f,o;return __generator(this,function(s){switch(s.label){case 0:return(this._hasNewRow=this.listview.allowAddRow(),n=this._runTimePageNames.length,t=this._getListData().getRowCount()+(this._hasNewRow?1:0),!(n>t))?[3,1]:(this.deleteRows(t,n-t),this.resetDefaultData(),this.refreshDataModel(0,0,t),this.resetScroll(),[3,4]);case 1:n&&(this.resetDefaultData(),this.refreshDataModel(0,0,n));r=t-n;i=Math.max(10,this.getFirstTimeLoadCount());e=!0;u=n;s.label=2;case 2:return(r>0)?(f=Math.min(i,r),[4,this.addRows(null,f,25)]):[3,4];case 3:return(o=s.sent(),!o)?[2]:(this.resetDefaultData(u,f),this.refreshDataModel(u,0,f),r-=i,u+=i,i=50,e&&(this.resetScroll(),e=!1),[3,2]);case 4:return this._suspendLoadOnDemand=!1,this.refreshCurrentRowStyle(this.listview.getCurrentRowIndex()),this.showHelpImagePart(),[2]}})})},s.prototype.getFirstTimeLoadCount=function(){var n,i,r,u,f=this._container.width(),e=this._container.height(),o=(i=(n=this._templatePage)===null||n===void 0?void 0:n.PageSettings)===null||i===void 0?void 0:i.Width,s=(u=(r=this._templatePage)===null||r===void 0?void 0:r.PageSettings)===null||u===void 0?void 0:u.Height;if(f>0&&e>0&&s>0&&o>0)switch(this.CellElement.CellType.DisplayMode){case t.Horizontal:return Math.ceil(f/o);case t.Vertical:return Math.ceil(e/s);case t.Flow:return Math.ceil(f/o)*Math.ceil(e/s)}return 10},s.prototype.resetScroll=function(){var n=this.getScrollContentContainer();n.scrollTop(0);n.scrollLeft(0)},s.prototype.showHelpImagePart=function(){this.updateNoItemImage();this.showOrHideWaitingBlock()},s.prototype.updateNoItemImage=function(){this.needShowNoItemImage()?this.showNoItemImage():this.hideNoItemImage()},s.prototype.needShowNoItemImage=function(){var n=this.CellElement.CellType;return this._runTimePageNames.length<=0&&n.NoItemSetting&&(!!n.NoItemSetting.ImageForNoItem||!!n.NoItemSetting.TextForNoItem)},s.prototype.showNoItemImage=function(){var u=this.CellElement.CellType.NoItemSetting,t,e,r,i;this._noItemPart||(t=n.DomUtilities.createJqueryDomElement("label"),e=this.CellElement.Value,this.CellElement.Value=this.evaluateFormula(u.TextForNoItem),r=n.CellDomCreateHelper.createTextElement(this.CellElement,t,this._getDomCreateInfo()),n.DomUtilities.setPropertyToDom(this.CellElement,r,this._getDomCreateInfo(),[0]),this.CellElement.Value=e,t.attr("id",this.noItemTextID),t.attr("name",this.noItemTextID),t.addClass("repeater-no-item-label"),t.css("-webkit-user-select","initial"),i=n.ImageDataHelper.CreateImage(u.ImageForNoItem,u.NoItemImageSize,function(n){n.removeClass("fgc-container-absolute")}),i&&(i.insertBefore(t),i.css("display","inline-block"),t.css("display","inline-block"),u.Orientation===f.Vertical?($(document.createElement("br")).insertBefore(t),i.css("margin-bottom",5),i.css("margin-left",t.css("padding-left"))):(i.css("margin-right",5),t.css("vertical-align","middle"))),r.attr("id",this.ID+"_NoItem"),r.css("padding",20),this._noItemPart=r);this.getContainer().append(this._noItemPart);this._noItemPart.css("display","table");this._itemsPart.css("display","none")},s.prototype.hideNoItemImage=function(){this._noItemPart&&(this._noItemPart.css("display","none"),this._itemsPart.css("display",this._containerDisplayMode))},s.prototype._getPartsUseFontStyle=function(){var n=this._noItemPart;return n&&(n=n.add(n.find("#"+this.noItemTextID))),n},Object.defineProperty(s.prototype,"noItemTextID",{get:function(){return this.ID+"_noItemText"},enumerable:!1,configurable:!0}),s.prototype.updateNoItemText=function(){if(this._noItemPart){var n=this.CellElement.CellType.NoItemSetting;this._noItemPart.find("#"+this.noItemTextID).text(this.evaluateFormula(n.TextForNoItem))}},s.prototype.getScrollContentContainer=function(){return this._scrollContent||this.getContainer()},s.prototype.createSimpleBar=function(){var t=this.CellElement.CellType;t.OverflowMode===1&&(this._simpleBar||(this._simpleBar=n.DomUtilities.applySimpleBar(this.getContainer()),this._simpleBar&&(this._scrollElement=$(this._simpleBar.getScrollElement()),this._scrollContent=$(this._simpleBar.getContentElement()),this._itemsPart=this.getContainer().find(".simplebar-wrapper"),this.updateContainerForSimplebar())))},s.prototype.updateSimpleBar=function(){this._simpleBar&&this._simpleBar.recalculate()},s.prototype.showOrHideWaitingBlock=function(){this._templatePage&&(this.needShowWaitingBlock()?this.showWaitingBlock():this.hideWaitingBlock())},s.prototype.needShowWaitingBlock=function(){var n,i=this.CellElement.CellType;if(i.OverflowMode!==1||!((n=this.listview)===null||n===void 0?void 0:n.allowLoadOnDemand()))return!1;switch(i.DisplayMode){case t.Flow:return!1;case t.Vertical:if(this.getContainer().height()>=this.getItemsTotalLength())return!1;break;case t.Horizontal:if(this.getContainer().width()>=this.getItemsTotalLength())return!1;break;default:return!1}return!0},s.prototype.showWaitingBlock=function(){var r=this.CellElement.CellType,i;this._waitingBlock||(i=n.DomUtilities.createJqueryDomElement("div"),i.css("background-image",'url("'+n.ForguncyData.ForguncyRoot+'Resources/Images/SiteBuiltInImages/loading.gif")'),i.attr("id",this.ID+"wait"),i.css("background-repeat","no-repeat"),i.css("background-position-x","50%"),i.css("background-position-y","50%"),i.css("flex-shrink","0"),r.DisplayMode===t.Vertical?(i.css("width","100%"),i.css("height","30px")):r.DisplayMode===t.Horizontal?(i.css("width","30px"),i.css("height","100%")):i.css("width","30px"),this._waitingBlock=i);this._container.append(this._waitingBlock);this._waitingBlock.css("display","block")},s.prototype.hideWaitingBlock=function(){this._waitingBlock&&this._waitingBlock.css("display","none")},s.prototype.addRows=function(n,t,i){return i===void 0&&(i=50),__awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(){return[2,new Promise(function(u){r.addSomeRowsEachTime(n,t,i,function(n){u(n)})})]})})},s.prototype.addSomeRowsEachTime=function(t,i,r,u){var o=this,f,e;if(!this._currentRefreshInfo||this._currentRefreshInfo.dataID!==this._listviewDataID){u(!1);return}f=Math.min(i,r);this._refreshSuspendCount++;try{for(e=0;e<f;e++)this.addOneRow(t===null?null:t+e)}finally{this._refreshSuspendCount--}i-=f;i>0?n.DelayRefresh.setTimeout(function(){o.addSomeRowsEachTime(t===null?null:t+f,i,r,u)}):u(!0)},s.prototype.addOneRow=function(t){var b=this,s,h,c,l,a,k=n.SubPageHelper.getUniqueSubPageIndex(),r=n.StaticValues.RunTimeNormalPage+k,d=n.StaticValues.RunTimeMasterPage+k,f=n.Common.clone(this._templatePage),tt=new n.ForguncyDataSetter(f,n.ForguncyData.pageInfo,r,d,3),e,i,v,y,p,nt,w;if(tt.setPageInfoByMetadata(),e=n.Presentation.PageContentCreator.create(f,r,d,2),e.css("flex-shrink",0),e.css("background-color",""),i=this.adjustSubPageDivForStretch(e,f.PageSettings.Width,f.PageSettings.Height,r),this.CellElement.StyleTemplate){this._repeaterCellTypeStyleTemplateHelper.ApplyTemplateStyle(this.CellElement.StyleTemplate,i);i.addClass("repeater-style-item");var u=n.DomUtilities.createJqueryDomElement("div"),o=this.CellElement.StyleTemplate.Styles.TEMPLATE.NormalStyle,g=((s=o.MarginLeft)!==null&&s!==void 0?s:0)+((h=o.MarginRight)!==null&&h!==void 0?h:0);i.css("min-width")==="100%"&&(g&&i.css("min-width","calc(100% - ".concat(g,"px)")),u.css("min-width","100%"));v=((c=o.MarginTop)!==null&&c!==void 0?c:0)+((l=o.MarginBottom)!==null&&l!==void 0?l:0);i.css("min-height")==="100%"&&(v&&i.css("min-height","calc(100% - ".concat(v,"px)")),u.css("min-height","100%"));y=i.css("width")+"";y.endsWith("%")&&(i.css("width",""),u.css("width",y));p=i.css("height")+"";p.endsWith("%")&&(i.css("height",""),u.css("height",p));u.append(i);i=u}if(i.addClass("repeater-item"),nt=this.CellElement.CellType,w=(a=nt.Command)===null||a===void 0?void 0:a.Commands,w&&w.length!==0){i.addClass("repeater-item-command");i.addClass("fgc-clickHandler");i.on("click",function(n){var t=$(n.target),i;if(t.hasClass("repeater-item-command")){i=b._container.children("div.repeater-item").index(t[0]);b.onClickRepeaterItem(i)}})}n.Common.IsEmpty(t)||t>=this._runTimePageNames.length?(this._container.append(i),this._runTimePageNames.push(r)):(i.insertBefore($(this._container.find(".repeater-item")[t])),this._runTimePageNames.splice(t,0,r));n.PageBuilder.onLoad([r]);n.ForguncyData.pageInfo.pageElementManager.initCellDefaultValue([r]);n.ForguncyData.pageInfo.pageElementManager.onDefaultDataSetted([r]);if(n.PageBuilder.hasCallOnPageLoaded)n.PageBuilder.onPageLoaded([r])},s.prototype.onClickRepeaterItem=function(n){var i,t,r;this.updateCurrentRowIndex(n);var f=n===this.newRowIndex?this.getNewRowData():this.listview.getRowValue(n),e=this.listview.listviewData.getColumnCount(),u={};for(t=0;t<e;t++)(r=this.listview.listviewData.columnDataInfos[t],r.columnName)&&(u[r.columnName]=(i=f[t])!==null&&i!==void 0?i:null);this.executeCustomCommandObject(this.CellElement.CellType.Command,u,"Click:"+n)},s.prototype.adjustSubPageDivForStretch=function(t,i,r,u){var f=n.PageManager.getPageStretchInfo(u),e;f.StretchMode===4&&(e=$(document.createElement("div")).addClass("repeater-item-wrapper"),e.css("position","relative"),t.css("position","absolute"),t.css("left","0"),t.css("top","0"),t.css("right","0"),t.css("bottom","0"),t.css("width",""),t.css("height",""),e.append(t),t=e);var h=n.Presentation.StretchCommon.canHorizontallyStretch(f.StretchMode),c=n.Presentation.StretchCommon.canVerticallyStretch(f.StretchMode),o=this.CellElement.Width||this.CellElement.FullWidth,s=this.CellElement.Height||this.CellElement.FullHeight;return h&&o>0&&(t.css("width",i*100/o+"%"),t.css("min-width",i)),c&&(f.StretchMode===4?o>0&&(t.css("height",0),t.css("padding-bottom",r*100/o+"%"),t.css("min-height",r)):s>0&&(t.css("height",r*100/s+"%"),t.css("min-height",r))),t},s.prototype.deleteRows=function(n,t){for(var r=this._container.children(".repeater-item"),i=0;i<t;i++)this.deleteOneRow(n+t-i-1,r)},s.prototype.deleteOneRow=function(t,i){var r=this._runTimePageNames[t];n.Common.IsEmpty(r)||(n.SubPageHelper.destroySubPage(r),$(i[t]).off("click"),$(i[t]).remove(),this._runTimePageNames.splice(t,1))},Object.defineProperty(s.prototype,"listview",{get:function(){return this._listview||(this._listview=n.ListviewBase.getListview(this._listviewName,this.runTimePageName)),this._listview},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"newRowIndex",{get:function(){return this._hasNewRow?this._runTimePageNames.length-1:-1},enumerable:!1,configurable:!0}),s.prototype._getListData=function(){return n.ForguncyData.pageInfo.dataModel.getListDataByListviewName(this._listviewName,this.runTimePageName)},s.prototype.resetDefaultData=function(t,i){var u,f;this._refreshSuspendCount++;u=this._runTimePageNames;t!==undefined&&i!==undefined&&(u=u.slice(t,t+i));try{f=n.ForguncyData.pageInfo.dataModel.normalCellDataModel;n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(u).forEach(function(n){if(n.templateCellSource!==r&&f.getValueType(n.id)!==1){var t=n.getDefaultValue();f.setValue(n.id,{newValue:t===undefined?null:t},1)}})}finally{this._refreshSuspendCount--}},s.prototype.refreshDataModel=function(n,t,i,r){if(r===void 0&&(r=-1),i!==0&&r!==0){this._refreshSuspendCount++;try{var f=this._getListData(),e=Math.min(this._runTimePageNames.length,this._getListData().getRowCount()),o=f.getColumnCount(),s=e-n,u=o-t;i=Math.min(i,s);r=r===-1?u:Math.min(r,u);i>0&&r>0&&(this.refreshDataModelForCells(n,t,i,r),this.refreshDataModelForBackgroundImages(n,t,i,r))}finally{this._refreshSuspendCount--}}},s.prototype.refreshDataModelForCells=function(t,i,r,u){var s=this.getTemplateCellRelations(),h,c,f,o,l,a,e;if(s){for(this.suspendBindingCombobox(t,r),h=n.ForguncyData.pageInfo.dataModel.normalCellDataModel,c=this._getListData(),f=i;f<i+u;f++)if(o=s[f],o)for(l=function(t){var i=c.getValue(t,f),r=a._runTimePageNames[t];o.forEach(function(t){return h.setValue(n.Common.getIdStr(t.Row,t.Column,r),{newValue:i,uiAction:!1},2)})},a=this,e=t;e<t+r;e++)l(e);this.cacheComboboxText(t,r)}},s.prototype.suspendBindingCombobox=function(n,t){var i=this.getInfoOfComboboxNeedCacheText();i.length!==0&&this.enumComboboxCells(i,n,t,function(n){return n.suspendPaint()})},s.prototype.cacheComboboxText=function(t,i){var e=this,r=this.getInfoOfComboboxNeedCacheText(),u,f;if(r.length!==0){if(u=function(){e.enumComboboxCells(r,t,i,function(n){return n.resumePaint()})},f=this.createMultiComboBindingOptionsParam(t,i,r),!f){u();return}n.TableColumnsCacheManager.cacheComboboxText(f,u)}},s.prototype.enumComboboxCells=function(t,i,r,u){var f=this;t.forEach(function(t){for(var e=i;e<i+r;e++){var s=f._runTimePageNames[e],h=n.Common.getIdStr(t.cellLocation.Row,t.cellLocation.Row,s),o=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(h);o&&u(o)}})},s.prototype.createMultiComboBindingOptionsParam=function(n,t,i){for(var r,s,u,f,e=[],o=0,h=i;o<h.length;o++)(r=h[o],s=this.getQueryAndValuesOfCombobox(n,t,r),s.length!==0)&&e.push({lookupColumnBindingInfo:(u=r.metaData.ValueColumnBindingInfo)===null||u===void 0?void 0:u.GUID,resultColumnBindingInfo:(f=r.metaData.DisplayColumnBindingInfo)===null||f===void 0?void 0:f.GUID,queryAndValues:s});return e.length===0?null:{pageName:i[0].pageName,data:e,cacheKeys:i.map(function(n){return n.cacheKey})}},s.prototype.getQueryAndValuesOfCombobox=function(t,i,r){for(var s=n.ForguncyData.pageInfo.dataModel.normalCellDataModel,f=[],e=[],u=t;u<t+i;u++){var o=this._runTimePageNames[u],h=n.Common.getIdStr(r.cellLocation.Row,r.cellLocation.Column,o),c=s.getValue(h),l=n.ConditionHelper.getComputedSqlConditionFormula(r.metaData.ItemsQuery,o,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull);f.push(c);e.push(l)}return n.TableColumnsCacheManager.getQueryAndValuesOfCombobox(f,e,r.metaData,r.cacheKey)},s.prototype.getInfoOfComboboxNeedCacheText=function(){var f,t,i,u;if(this._comboboxCacheTextInfo)return this._comboboxCacheTextInfo;if(this._runTimePageNames.length===0)return[];for(f=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells([this._runTimePageNames[0]]),t=[],i=0,u=f;i<u.length;i++){var r=u[i],e=r.cellType.CellElement.CellType,o=n.TableColumnsCacheManager.getBindingValueCacheKey(e);o&&t.push({cellLocation:{Row:r.row,Column:r.column},metaData:e,cacheKey:o,pageName:r.designerPageName})}return this._comboboxCacheTextInfo=t,t},s.prototype.refreshDataModelForBackgroundImages=function(t,i,r,u){var s=this.getRelatedBackgroundImages(),h,f,o,c,l,e;if(s)for(h=this._getListData(),f=i;f<i+u;f++)if(o=s[f],o)for(c=function(t){var i=h.getValue(t,f),r=l._runTimePageNames[t];o.forEach(function(t){return n.ForguncyData.pageInfo.pageElementManager.backgroundImages.list.filter(function(n){return n.name===t&&n.runTimePageName===r}).forEach(function(n){return n.changePicture(i)})})},l=this,e=t;e<t+r;e++)c(e)},s.prototype.getTemplateCellRelations=function(){if(this._templateCellRelations)return this._templateCellRelations;var n=this.cacheCellRelations();return n?this._templateCellRelations:null},s.prototype.getSelectedCellReleations=function(){if(this._selectedCellReleations)return this._selectedCellReleations;var n=this.cacheCellRelations();return n?this._selectedCellReleations:null},s.prototype.cacheCellRelations=function(){var i;if(this._runTimePageNames.length===0||(i=this.listview,!i))return!1;var f=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells([this._runTimePageNames[0]]),t=[],u=[];return f.forEach(function(f){var o,e;if(!n.Common.IsEmpty(f.templateCellSource)){if(o={Row:f.row,Column:f.column},f.templateCellSource===r){u.push(o);return}(e=i.getColIndexOfNamedColumn(f.templateCellSource,!1),e!==-1)&&(t[e]||(t[e]=[]),t[e].push({Row:f.row,Column:f.column}))}}),this._templateCellRelations=t,this._selectedCellReleations=u,!0},s.prototype.getRelatedBackgroundImages=function(){if(this._relatedBackgroundImages)return this._relatedBackgroundImages;var n=this.cacheRelatedBackgroundImages();return n?this._relatedBackgroundImages:null},s.prototype.cacheRelatedBackgroundImages=function(){var u=this,i,r,t;return this._runTimePageNames.length===0?!1:(i=this.listview,!i)?!1:(r=n.ForguncyData.pageInfo.pageElementManager.backgroundImages.list.filter(function(n){return n.runTimePageName===u._runTimePageNames[0]}),t=[],r.forEach(function(r){if(!n.Common.IsEmpty(r.relatedColumn)){var u=i.getColIndexOfNamedColumn(r.relatedColumn,!1);u!==-1&&(t[u]||(t[u]=[]),t[u].push(r.name))}}),this._relatedBackgroundImages=t,!0)},s.prototype.destroy=function(){this._onValueChangedEventHandler&&(n.ForguncyData.pageInfo.dataModel.unbind("valuechanged",this._onValueChangedEventHandler),this._onValueChangedEventHandler=null);this._onCurrentRowInfoChangedEventHandler&&(this.listview.unbind("selectionchanged",this._onCurrentRowInfoChangedEventHandler),this._onCurrentRowInfoChangedEventHandler=null);this._onSelectionChangedEventHandler&&(this.listview.unbind("selectedrowschanged",this._onSelectionChangedEventHandler),this._onSelectionChangedEventHandler=null);this._currentRowHelper&&(this._currentRowHelper.destroy(),this._currentRowHelper=null);this.getContainer().empty();this._container=null;this._itemsPart=null;this._waitingBlock=null;this._noItemPart=null;this._simpleBar=null},s.prototype.containRunTimePage=function(n){return this._runTimePageNames.indexOf(n)>=0},s.prototype.getDesignerPageName=function(n){return this.containRunTimePage(n)&&this._templatePage?this._templatePage.PageSettings.Name:null},s.prototype.getRunTimePageName=function(n){return this._templatePage&&this._templatePage.pageName===n&&this._runTimePageNames.length>0?this._runTimePageNames[0]:null},s.prototype.getTabIndex=function(n){return this._runTimePageNames.indexOf(n)},s.prototype.getAllRunTimePageNames=function(){return this._runTimePageNames},s.prototype.isLoading=function(){return!1},s.prototype.getTempalteRowCount=function(){return this._templatePage?this._templatePage.PageSettings.RowCount:0},s.prototype.getTempalteColumnCount=function(){return this._templatePage?this._templatePage.PageSettings.ColumnCount:0},s.prototype.getAdditionalRowInfo=function(n){var i=this.getTabIndex(n),t;return i===-1?null:(t=this.listview,t===null)?null:t.isGroupMode()?null:t.getRowInfo(i)},s.prototype.updateCurrentRowIndex=function(n){this._currentRowHelper&&this._currentRowHelper.updateCurrentRowIndex(n)},s.prototype.onWindowResized=function(){e.prototype.onWindowResized.call(this);this.showOrHideWaitingBlock();this.updateSimpleBar()},s.prototype.destroyAllPages=function(){this._runTimePageNames.forEach(function(t){n.SubPageHelper.destroySubPage(t)})},s}(n.ContainerCellTypeBase),u,f,t,i,o;n.RepeaterCellType=e;u=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.RepeaterCellType",n.TemplateNameParts=["TEMPLATE"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{TEMPLATE:n}},i.prototype.OnTemplateStyleApplied=function(t,i){if(i){if(t.Styles.TEMPLATE.FocusStyle){var r=t.Key,u=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,r,"TEMPLATE");this.focusStyleName=u+"-focus"}t.Styles.TEMPLATE.SelectedStyle&&(this.selectStyleName="selected")}},i.prototype.Clear=function(){t.prototype.Clear.call(this)},i}(n.CellTypeStyleTemplateHelperBase);n.RepeaterCellTypeStyleTemplateHelper=u,function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"}(f||(f={})),function(n){n[n.Vertical=0]="Vertical";n[n.Horizontal=1]="Horizontal";n[n.Flow=2]="Flow"}(t||(t={})),function(n){n[n.Row=0]="Row";n[n.Column=1]="Column"}(i||(i={}));o=function(t){function i(n,i,r,u){var f=t.call(this)||this;f._id=n;f._container=i;f._pageID=r;f._listview=u;f._currentRowIndex=-1;f._focusInEventName="focusin "+f._pageID+"repeater"+f._id;f._clickEventName="click "+f._pageID+"repeater"+f._id;f._focusInEventHandler=function(){f.onCurrentElementChanged(document.activeElement)};f._clickEventHandler=function(n){f.onCurrentElementChanged(n.target)};$(document).on(f._focusInEventName,f._focusInEventHandler);$(document).on(f._clickEventName,f._clickEventHandler);return f._onCurrentRowChangedEventHandler=function(n,t){f._currentRowIndex!==-1&&(f._currentRowIndex=t.newSelectedRowIndex)},f._listview.bind("selectionchanged",f._onCurrentRowChangedEventHandler),f}return __extends(i,t),i.prototype.onCurrentElementChanged=function(t){var u=$(t),e,f,r,o,i;if(this._pageID===n.ForguncyData.pageInfo.pageID&&$("#pageWrapper_"+this._pageID).has(t).length!==0&&this._container[0]!==t&&t.id!==this._id+"wait"){for(e=u.parents(),i=0;i<e.length;i++)if($(e[i]).attr("fgcname")==="Fgc-Listview-Selection-State-Column")return;if(f=-1,this._container.has(t).length>0)for(r=u.parents("div.repeater-item"),u.hasClass("repeater-item")&&(r=r.add(u)),o=this._container.children("div.repeater-item"),i=0;i<r.length;i++)if(f=o.index(r[i]),f!==-1)break;this.updateCurrentRowIndex(f)}},i.prototype.updateCurrentRowIndex=function(n){if(this.trigger("click",{rowIndex:n}),this._currentRowIndex!==n){var t=this._currentRowIndex;this._currentRowIndex=n;this.trigger("RepeaterCurrentRowChanged",{newCurrentRowIndex:n,oldCurrentRowIndex:t})}},i.prototype.destroy=function(){$(document).off(this._focusInEventName,this._focusInEventHandler);$(document).off(this._clickEventName,this._clickEventHandler);this._listview.unbind("selectionchanged",this._onCurrentRowChangedEventHandler);this._focusInEventHandler=null;this._clickEventHandler=null;this._onCurrentRowChangedEventHandler=null;this._listview=null;this._container=null},i}(n.EventClassBase);n.CellTypeHelper.registerCellType("Forguncy.RepeaterCellType, ServerDesignerCommon",e)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var r=GC.Spread.CalcEngine,t,i;n.UserControl_ValueBindingPropertyName="Fgc-UC-TwoWayBinding-Value-Column";t=function(t){function r(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f._propertyValues={},f._propertyRefers={},f._definedPropertyNames=[],f.index=0,f.supportedEvents=["loaded","pagedefaultdataloaded","subpagechanged"],f}return __extends(r,t),r.prototype.getDefaultPageName=function(){return this.CellElement.CellType.UserControlPageName},r.prototype.isUserControl=function(){return!0},r.prototype.setValueToElement=function(t,i){var r,f,e,u,o,s;if(this.subPageInfos)for(r=0,f=this.subPageInfos;r<f.length;r++)if(e=f[r],e)for(u=0,o=e.childrens;u<o.length;u++)s=o[u],s.isUserControlTwoWayBindingCell()&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(s.id,{newValue:i,uiAction:!1},2)},r.prototype.InitDefaultDataAndModels=function(t,i){var c=this,e,r,u,f,o,s,h;if(this._definedPropertyNames=(e=t.PageSettings.PropertyNames)!==null&&e!==void 0?e:[],this.initPropertyRefers(),r=this.CellElement.CellType,u={},r.PropertyValues&&r.PropertyValues.length>0)for(f=0,o=r.PropertyValues;f<o.length;f++)s=o[f],u[s.Name]=this.evaluateFormula(s.Value);h=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID);n.Common.IsEmpty(h)||(u[n.UserControl_ValueBindingPropertyName]=h);n.PageBuilder.initDefaultDataAndModels(t,i.runTimeNormalPageName,i.runTimeMasterPageName,{templateSourceDefaultValue:u,subPages:this.subPageInfos,userControlCellType:this});this.onDependenceCellValueChanged(function(){c.syncFormulaPropertyValues(4)})},r.prototype.getFormulaPropertyValuesDic=function(){var i=this.CellElement.CellType,r,t,u,n;if(i.PropertyValues&&i.PropertyValues.length>0){for(r={},t=0,u=i.PropertyValues;t<u.length;t++)n=u[t],typeof n.Value=="string"&&n.Value[0]==="="&&(r[n.Name]=this.evaluateFormula(n.Value));return r}return null},r.prototype.onPropertyChanged=function(t,i,r,u){var v=this._propertyValues[t],y,s,c,l,h,a,f,e,o;if(!n.Common.isFuzzyEquals(i,v)){for(this._propertyValues[t]=i,y=this.getChildrenCells(),s=0,c=y;s<c.length;s++)l=c[s],l.templateCellSource===t&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(l.id,{newValue:i,uiAction:r},u);if(t!==n.UserControl_ValueBindingPropertyName)for(h=0,a=this.subPageInfos;h<a.length;h++)if(f=a[h],f.propertyValueChangedCommand){if(e={},e[f.propertyValueChangedCommand.ParamProperties.propertyName]=t,e[f.propertyValueChangedCommand.ParamProperties.oldValue]=v,e[f.propertyValueChangedCommand.ParamProperties.newValue]=i,o=f.propertyValueChangedCommand,!o||!o.Commands||o.Commands.length<=0)return;this.subPageInfos&&this.subPageInfos[0]&&this.subPageInfos[0].runTimeNormalPageName&&n.ForguncyData.commandExcutor.excuteCommand(o.Commands,{runTimePageName:f.runTimeNormalPageName,commandTrigger:this,commandID:this.ID+"-"+(this.index++).toString(),eventType:"propertyChanged",initParams:e,locationString:n.FormulaHelper.getCellLogLocationString(this.ID,this.Name,this.runTimePageName)})}}},r.prototype.syncFormulaPropertyValues=function(n){var t=this.getFormulaPropertyValuesDic(),i,r;if(t)for(i in t){r=t[i];this.onPropertyChanged(i,r,!1,n)}},r.prototype.addCommandsToCurrentExecuteList=function(t,i){var u,f,r,e;this.CellElement.CellType.CommandHandlers&&(r=this.CellElement.CellType.CommandHandlers.find(function(n){return n.CommandName===t}),((f=(u=r===null||r===void 0?void 0:r.Commands)===null||u===void 0?void 0:u.Commands)===null||f===void 0?void 0:f.length)&&(e=r.Commands.Commands,n.ForguncyData.commandExcutor.insertCommandsToCurrentExecutingList(e,this.runTimePageName,i)))},r.prototype.GetPropertyValue=function(n){var t=this._propertyValues[n];return t===undefined&&this._definedPropertyNames.indexOf(n)>=0&&(t=null),{Result:t}},r.prototype.SetPropertyValue=function(n,t){if(!(this._definedPropertyNames.indexOf(n)<0))this.onPropertyChanged(n,t,!1,5)},r.prototype.SetPropertyRefer=function(n,t,i){this._definedPropertyNames.indexOf(n)<0||typeof t=="string"&&t.startsWith("=")&&(this._propertyRefers[n]={referStr:t,runTimePageName:i})},r.prototype.SetUserControlPage=function(n,t,i){var r={UserControlPageName:n,PropertyValues:t.$values,CommandHandlers:i.$values};this.CellElement.CellType=r;this._definedPropertyNames=[];this.initPropertyRefers();this.prepareCreateNewPage();this._propertyValues={};this.loadSubPage(n)},r.prototype.initPropertyRefers=function(){var t,i,n,r,u;if(this._propertyRefers={},(t=this.CellElement.CellType)===null||t===void 0?void 0:t.PropertyValues)for(n=0,r=(i=this.CellElement.CellType)===null||i===void 0?void 0:i.PropertyValues;n<r.length;n++)u=r[n],this.SetPropertyRefer(u.Name,u.Value,this.runTimePageName)},r.prototype.destroyOldPage=function(){var i=this,r=$("#"+this.getSubPageContainerID(0)),t;r.css("display","");this._oldSubPageContainerID&&(t=$("#"+this._oldSubPageContainerID),t&&r.css("opacity",0));n.DelayRefresh.Push(null,function(){i._oldSubPageInfo&&n.SubPageHelper.destroySubPage(i._oldSubPageInfo.runTimeNormalPageName,i._oldSubPageInfo.runTimeMasterPageName);t&&(t.remove(),r.css("opacity",1))},this._oldSubPageContainerID)},r.prototype.needUpdateReference=function(t){var r,f,u;return(t&&t.length>0&&t[0]==="="&&(t=t.substring(1)),!t)?!1:(r=this.getCurrentParamToExpression(),Object.keys(r).length&&t)?(f=n.FormulaHelper.parse(t),u=new i(r),u.visit(f,0,0),u.Updated):!1},r.prototype.propertyToReference=function(t){var u=t,s=!1,o,f,e,r;if(u&&u.length>0&&u[0]==="="&&(u=u.substring(1),s=!0),o=this.getCurrentParamToExpression(),Object.keys(o).length&&t)try{if(f=n.FormulaHelper.parse(t),e=new i(o),f=e.visit(f,0,0),e.Updated&&(r=n.FormulaHelper.unparse(f),r))return r[0]!=="="&&s&&(r="="+r),{referStr:r,runTimePageName:e.runTimePageName}}catch(h){return null}return null},r.prototype.getCurrentParamToExpression=function(){return this._propertyRefers},r}(n.SinglePageContainerCellType);n.UserControlPageCellType=t;i=function(t){function i(n){var i=t.call(this)||this;return i._currentParamToReferDic=n,i.Updated=!1,i}return __extends(i,t),i.prototype.visit=function(n,i,u){if(!n)return n;var f=r.ExpressionType;return n.type===f.name?this.visitNameExpression(n):t.prototype.visit.call(this,n,i,u)},i.prototype.visitNameExpression=function(t){var i=this._currentParamToReferDic[t.value],r;if(i!==undefined)try{return r=n.FormulaHelper.parse(i.referStr),this.Updated=!0,this.runTimePageName=i.runTimePageName,r}catch(u){}return t},i}(n.ExpressionVisitor);n.CellTypeHelper.registerCellType("Forguncy.UserControlPageCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.AttachmentCelltype",n.TemplateNameParts=["ATTACHMENT_DELETE_BUTTON","ATTACHMENT_ADD_BUTTON","ATTACHMENT_LINK"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){var t=n.find("button"),i=n.find(".deleteHyperCon").find("a"),r=n.find(".downloadHyperCon").find("a");return{ATTACHMENT_ADD_BUTTON:t,ATTACHMENT_DELETE_BUTTON:i,ATTACHMENT_LINK:r}},i.prototype.OnTemplateStyleApplied=function(t,i){if(i){i.css("overflow","hidden");var r=t.Key,u=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,r,"ATTACHMENT_DELETE_BUTTON"),f=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,r,"ATTACHMENT_LINK"),e=i.find(".deleteHyperCon").find("a"),o=i.find(".downloadHyperCon").find("a");e.each(function(t,i){n.CellTypeStyleTemplateUtils.AddFocusStyleToContainer(u,$(i));n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(u,$(i))});o.each(function(t,i){n.CellTypeStyleTemplateUtils.AddFocusStyleToContainer(f,$(i));n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(f,$(i))});n.ButtonCellTypeStyleTemplateHelper.adjustButtonBorder(t,this.CellTypeString,this.TemplateNameParts[1],"ATTACHMENT_ADD_BUTTON")}},i}(n.CellTypeStyleTemplateHelperBase),t;n.AttachmentCellTypeStyleTemplateHelper=i;t=function(t){function r(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f._indicatorCount=0,f.allowSetValueByUser=!1,f}return __extends(r,t),r.prototype._getCellTypeData=function(t){return new n.AttachmentCelltypeData(t)},r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype._showLoadingIndicator=function(){this._indicatorCount++;this._indicatorContainer.css("display","")},r.prototype._hideLoadingIndicator=function(){this._indicatorCount--;this._indicatorCount<=0&&this._indicatorContainer.css("display","none")},r.prototype.createContent=function(){var e=this,o=this.CellElement,f=n.DomUtilities.createJqueryDomElement("div"),s,u,t,i;f.css("width","100%");f.css("height","100%");s=o.CellType;u=n.DomUtilities.createJqueryDomElement("div");u.css("width","100%");u.css("height","100%");u.css("display","flex");u.css("flex-direction","column");u.css("align-items","flex-start");f.append(u);t=n.DomUtilities.createJqueryDomElement("div");t.attr("data-wordWrap",!!this.CellElement.StyleInfo.WordWrap);t.css("width","100%");t.css("flex-grow","1");n.DomUtilities.setContainerOverFlow(t,"auto");t.attr("index",0);t.attr("forguncyAttachment","true");this.shouldEnableTabIndex()&&t.data("tabindex",s.TabIndex);n.DomUtilities.setPropertyToDom(o,t,e._getDomCreateInfo(),[2,0]);u.append(t);i=n.DomUtilities.createJqueryDomElement("button");i.css("font-size",t.css("font-size"));i.attr("id",e.ID+"Add");i.attr("type","button");i.text(n.RS.addStr);u.append(i);i.on("click",{cellType:this,div:t},r._onAttachmentCellAddButtonClick);return n.Platform.isMobile()&&i.addClass("mobileButtonStyle"),i.css("flex-grow","0"),i.css("font-family","inherit"),n.Platform.isIOSDevice()&&i.css("-webkit-appearance","none"),n.Platform.isIpad()&&i.css("min-height","fit-content"),i.css("outline","none"),this._registerDragUpload(t,this),this._indicatorContainer=n.DomUtilities.createLoadingIndicator(),f.append(this._indicatorContainer),this.isDisabled()&&this._disable(f),this.isReadOnly()&&this.updateReadOnlyStatus(),f},r.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+",#"+this.ID+"_a_div a")},r._onAttachmentCellAddButtonClick=function(t){var i=t.data.cellType,r,u;i.isReadOnly()||i._checkMaxUploadCount()&&(r=i.CellElement.CellType.UploadLimit,u=r?r.ExtensionFilter:null,n.Common.updateFile(u,!0,function(n){var i=t.data.cellType;i._hideLoadingIndicator();i._addAttachmentToCell(t.data.div,n)},function(t,r){if(i._hideLoadingIndicator(),t){var u=r&&r.status===401?n.RS.UnauthorizedUpload:t;alert(u)}},r,i.CellElement.ServerPropertiesId.UploadLimit,function(){i._showLoadingIndicator()}))},r.prototype._setAttachmentCellValue=function(n,t){var r,u,e=(u=(r=t===null||t===void 0?void 0:t.toString)===null||r===void 0?void 0:r.call(t))!==null&&u!==void 0?u:"",f,i;for(n.empty(),n.attr("attachmentValue",""),f=e.split("|"),i=0;i<f.length;i++)this._addAttachmentToCell(n,f[i])},r.prototype._checkMaxUploadCount=function(){var i,r,u,t=this.CellElement.CellType;return((i=t===null||t===void 0?void 0:t.UploadLimit)===null||i===void 0?void 0:i.MaxUploadFileCount)&&(((r=t===null||t===void 0?void 0:t.UploadLimit)===null||r===void 0?void 0:r.MaxUploadFileCount)!==1||!((u=t===null||t===void 0?void 0:t.UploadLimit)===null||u===void 0?void 0:u.ReplaceWhenOneFile))&&this._getFileCount()>=t.UploadLimit.MaxUploadFileCount?(alert(n.RS.uploadFileBiggerThanMaxFileCount),!1):!0},r.prototype._getFileCount=function(){var n=this.getValue(!0),r,u,t,i;if(n){for(n=n+"",r=n.split("|"),u=0,t=0;t<r.length;t++)i=r[t],i&&i.length>37&&i.charAt(36)==="_"&&u++;return u}return 0},r.prototype._createHyper=function(t,i,r,u,f,e){var h=__assign(__assign({},this.CellElement),{StyleInfo:__assign(__assign({},this.CellElement.StyleInfo),{TextIndent:0})}),o=n.HyperlinkCellType.createHyperlinkControl(h,{id:t,isInListview:this.isInListview}),s;return o.css("display","inline-block"),o.css("min-width","auto"),o.css("vertical-align","bottom"),o.addClass(i),o.css("margin-right",10),s=o.find("#"+t),this.CellElement.StyleInfo.Foreground&&o.css("color",f.css("color")),s.text(u),e!==undefined&&s.attr("tabindex",e),s.attr("href",r),o},r.prototype._addAttachmentToCell=function(t,i){var s,h,c,l,a,v,y,d=t.data("tabindex"),o=t.attr("attachmentValue"),p=t.attr("id"),w=t.attr("index"),u,k;if(o||(o=""),i&&i.length>37&&i.charAt(36)==="_"){if(!this._checkMaxUploadCount())return;u=n.DomUtilities.createJqueryDomElement("div");u.attr("id",p+"_a_div");u.css("margin","2px 0");u.css("display","flex");u.css("align-items","center");var it=p+w+"Download",rt=i.substring(37),b=i,ut=n.ModuleLoader.getCdnUrl("FileDownloadUpload/Download?file="+encodeURIComponent(b)),e=this._createHyper(it,"downloadHyperCon",n.ForguncyData.ForguncyRoot+ut,rt,t,d);u.append(e);var g=p+w+"Delete",f=this._createHyper(g,"deleteHyperCon","#",n.RS.deleteStr,t,d),nt=f.find("#"+g);if((h=(s=this.cellTypeData)===null||s===void 0?void 0:s.metaData)===null||h===void 0?void 0:h.TemplateKey){var tt=((c=this.cellTypeData)===null||c===void 0?void 0:c.metaData).TemplateKey,ft=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(r.StyleTemplateHelper.CellTypeString,tt,"ATTACHMENT_DELETE_BUTTON"),et=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(r.StyleTemplateHelper.CellTypeString,tt,"ATTACHMENT_LINK");e.find("a").addClass(et);f.find("a").addClass(ft)}this.CellElement.StyleInfo.WordWrap?(e.find("a").css("display","inline"),e.find("div").append(f),f.css("margin","0 0 0 10px"),n.Platform.isIOSDevice()&&(e.css("height","initial"),f.css("height","initial"))):u.append(f);nt.attr("fileName",b);f.attr("isDelete",1);this._attachDeleteEventHandler(nt,u,t,b);n.Platform.isMobile()&&u.addClass("mobileButtonStyle");k=((a=(l=this.CellElement.CellType)===null||l===void 0?void 0:l.UploadLimit)===null||a===void 0?void 0:a.MaxUploadFileCount)===1&&((y=(v=this.CellElement.CellType)===null||v===void 0?void 0:v.UploadLimit)===null||y===void 0?void 0:y.ReplaceWhenOneFile);k&&t.empty();t.append(u);t.attr("attachmentValue",(k?"":o)+i+"|");t.attr("index",Number(w)+1);this.isDisabled()&&this._disable(t.parent());this.isVisible()||this._setVisible(this.getContainer(),!1);this.isReadOnly()&&this.updateReadOnlyStatus();this._onValueChanged();this.validate()}else i.indexOf("<")>=0&&(t.append($("<div>".concat(n.RS.AttachmentCell_NotSupportedFile,"<\/div>"))),t.attr("attachmentValue",o+i+"|"))},r.prototype._attachDeleteEventHandler=function(n,t,i,r){var u=this;n.on("click",{cellType:this,itemContainer:t,div:i,url:r},function(n){var t,i;return u.isReadOnly()?!1:(t=n.data,t.div.focus(),t.itemContainer.remove(),i=t.div.attr("attachmentValue"),t.div.attr("attachmentValue",i.replace(t.url+"|","")),t.cellType._onValueChanged(),t.cellType.validate(),!1)})},r.prototype.setValueToElement=function(n,t){this._setAttachmentCellValue(n,t)},r.prototype.getValueFromElement=function(){var n=$("#"+this.ID);return n.length>0?n.attr("attachmentValue")?n.attr("attachmentValue"):null:null},r.prototype._disable=function(t){var f=t.find(".deleteHyperCon"),e=t.find(".downloadHyperCon"),r,i,u;f.attr("disabled","disabled");e.attr("disabled","disabled");r=t.find("#"+this.ID+"Add");r.attr("disabled","disabled");i=t.find("a");i.attr("disabled","disabled");i.off("click");i.on("click",function(){return!1});u=$("#"+this.ID);n.DragFileToUploadHelper.unRegister(u);i.css("cursor","default")},r.prototype._enable=function(){var s=$("#"+this.ID+"Add"),t,r,u,n,f,o;s.removeAttr("disabled");t=$("#"+this.ID+"_div").find("a");t.removeAttr("disabled");t.off("click");t.css("cursor","pointer");var e=$("#"+this.ID),i=e.find(".deleteHyperCon"),h=e.find(".downloadHyperCon");for(i.removeAttr("disabled"),h.removeAttr("disabled"),r=i.find("a"),u=$("#"+this.ID),n=r.length-1;n>=0;n--)f=$(r[n]),o=$(i[n]),this._attachDeleteEventHandler(f,o.parent(),u,f.attr("fileName"));this._registerDragUpload(u,this)},r.prototype._registerDragUpload=function(t,i){var r=this;n.DragFileToUploadHelper.register(t,function(u){return i._checkMaxUploadCount()?i.isReadOnly()?!1:(r._showLoadingIndicator(),n.Common.uploadFileByHTML5(u,function(n){i._addAttachmentToCell(t,n);r._hideLoadingIndicator()},function(n){r._hideLoadingIndicator();n&&alert(n)},i.CellElement.CellType.UploadLimit,i.CellElement.ServerPropertiesId.UploadLimit),!0):!1})},r.prototype._getVisibleParts=function(n){return n.find("a,button")},r.prototype.updateReadOnlyStatus=function(){var n=this.getContainer().find("div[isDelete],button");this.isReadOnly()?n.css("display","none"):n.css("display","")},r.prototype._setFontStyle=function(n){if(t.prototype._setFontStyle.call(this,n),this.CellElement.StyleTemplate){var u=this.getContainer(),f=u.find(".deleteHyperCon"),e=u.find(".downloadHyperCon"),i,r;f.find('a[href="#"]').each(function(n,t){i=t.style.color;$(t).css("white-space","")});e.find('a:not([href="#"])').each(function(n,t){r=t.style.color});i&&i!=="inherit"&&f.css("color",i);r&&r!=="inherit"&&e.css("color",r)}},r.StyleTemplateHelper=new i,r}(n.CellTypeBase);n.AttachmentCellType=t;n.CellTypeHelper.registerCellType("Forguncy.AttachmentCelltype, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.ButtonCellType",n.TemplateNameParts=["BUTTON"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{BUTTON:n.find("button")}},i.prototype.OnTemplateStyleApplied=function(n,t){if(t){var r=t.find("button");i.adjustButtonBorder(n,this.CellTypeString,this.TemplateNameParts[0],"BUTTON");r.css("outline","none");t.css("overflow","visible");r.css("overflow","hidden")}},i.adjustButtonBorder=function(t,i,r,u){var f,e,c;if(t&&t.Styles&&t.Styles[u]&&t.Styles[u].NormalStyle&&(f=t.Styles[u].NormalStyle,!f.BorderString)){e=[];f.BorderTopString||e.push("border-top:none");f.BorderRightString||e.push("border-right:none");f.BorderBottomString||e.push("border-bottom:none");f.BorderLeftString||e.push("border-left:none");var s=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(i,t.Key,r),o=document.getElementById(s),h=u+"-style-updated";o&&!o.getAttribute(h)&&(c=".".concat(s," { ").concat(e.join(";"),"; }"),o.innerText=c+o.innerText,o.setAttribute(h,"true"))}},i}(n.CellTypeStyleTemplateHelperBase),t;n.ButtonCellTypeStyleTemplateHelper=i;t=function(t){function r(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f.supportedEvents=["click","mouseenter","mouseleave"],f}return __extends(r,t),r.prototype.needValidate=function(){return!1},r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.createContent=function(){var i=this.CellElement,t=n.DomUtilities.createJqueryDomElement("button"),r;return t.addClass("fgc-btn"),t.css("margin",0),t.attr("id",this.ID+"_btn"),i.StyleInfo.Background&&(n.Platform.isIpad()||t.css("background-color",n.ColorHelper.Convert(i.StyleInfo.Background))),i.CellType.AutoExecute||t.attr("type","button"),r=this.createContentElement(i,this._getDomCreateInfo()),t.append(r),t.css("white-space","nowrap"),n.DomUtilities.setPropertyToDom(i,t,this._getDomCreateInfo(),[3,5]),t},r.prototype.createContentElement=function(t,i){var f=n.DomUtilities.createJqueryDomElement("label"),r,u;return this._label=f,r=n.CellDomCreateHelper.createTextElement(t,f,i),u=t.CellType,this.set_Icon(u.Icon),this.set_RightIcon(u.RightIcon),r.css("font-size",0),r},r.prototype.setValueToElement=function(n,t){this._updateText(n,t)},r.prototype._updateText=function(t,i){var r={value:null},u=n.FormatHelper.formatValue(i,this.getFormatString(),r);n.GeneralCellType.setValueToLabel(t,u,this.isDisabled()?null:r.value,this.CellElement);this._image&&this._image.css("margin-right",n.Common.IsEmpty(i)?0:5);this._rightImage&&this._rightImage.css("margin-left",n.Common.IsEmpty(i)?0:5)},r.prototype.getValueFromElement=function(){return null},r.prototype.onFormatterChanged=function(){var t=$("#"+this.ID),i;t.length===1&&(i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this._updateText(t,i))},r.prototype._setFontStyle=function(n){var i,u,f;t.prototype._setFontStyle.call(this,n);n.Underline===!1&&this.getContainer().find("button").css("text-decoration","none");this._needAdaptIosUnderlineinherit(r.StyleTemplateHelper.TemplateNameParts[0])&&(u=this.getContainer().find("button"),f=u.find("label"),((i=f[0])===null||i===void 0?void 0:i.style.textDecoration)==="none"&&(f.css("text-decoration","inherit"),u.find(".fgc-align,.fgc-align__inner").css("text-decoration","inherit")))},r.prototype._disable=function(n){var t=n;t.attr("disabled","disabled")},r.prototype._getPartsUseBackcolor=function(){return $("#"+this.ID+"_btn")},r.prototype._getVisibleParts=function(n){var t=this.ID+"_btn";return n.find("#"+t)},r.prototype._enable=function(){var n=$("#"+this.ID+"_btn");n.removeAttr("disabled")},r.prototype._getClickableDomId=function(){return this.ID+"_btn"},r.prototype.shouldDisplayInListviewNewRow=function(){return!1},r.prototype.destroy=function(){this._autoExecuteHandler&&$(document).off("keydown",this._autoExecuteHandler);this._image=null;this._rightImage=null;t.prototype.destroy.call(this)},r.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return n=this._image?n.add(this._image):n,this._rightImage?n.add(this._rightImage):n},r.prototype.ExecuteCommand=function(){var t=this.CellElement.CellType.CommandList;n.ForguncyData.commandExcutor.insertCommandsToCurrentExecutingList(t,this.runTimePageName)},r.prototype.set_Icon=function(n){this._setIconInternal(this._image,n,!0)},r.prototype.set_RightIcon=function(n){this._setIconInternal(this._rightImage,n,!1)},r.prototype._setIconInternal=function(t,i,r){var f,u;t&&t.remove();f=this.CellElement.CellType.IconSize;t=n.ImageDataHelper.CreateImage(i,f);u=this._label;t&&(t.css("display","inline-block"),u.css("display","inline"),u.css("vertical-align","middle"),r?(this._image=t,t.css("margin-right",n.Common.IsEmpty(this.getValueFromDataModel())?0:5),t.css("margin-left",u.css("padding-left")),u.css("padding-left",0),t.insertBefore(u)):(this._rightImage=t,t.css("margin-left",n.Common.IsEmpty(this.getValueFromDataModel())?0:5),t.css("margin-right",u.css("padding-right")),u.css("padding-right",0),t.insertAfter(u)),this.CellElement.StyleInfo.Foreground&&t.css("color",this.CellElement.StyleInfo.Foreground))},r.StyleTemplateHelper=new i,r}(n.ClickableCellTypeBase);n.ButtonCellType=t;n.CellTypeHelper.registerCellType("Forguncy.ButtonCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){function r(t,r){return(r instanceof i||n.SpreadJSViewBarcodeCellType&&r instanceof n.SpreadJSViewBarcodeCellType)&&(t=u(t)+"",t=f(t)),t}function u(n){for(var t,i=[],r=0;r<n.length;r++)t=n.charCodeAt(r),t<128?i.push(t):t<2048?i.push(192|t>>6,128|t&63):t<55296||t>=57344?i.push(224|t>>12,128|t>>6&63,128|t&63):(r++,t=65536+((t&1023)<<10|n.charCodeAt(r)&1023),i.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|t&63));return i}function f(n){for(var i="",u=0,e=n.length,r,f,o;u<e;){if(r=n.charCodeAt(u++)&255,u===e){i+=t.charAt(r>>2);i+=t.charAt((r&3)<<4);i+="==";break}if(f=n.charCodeAt(u++),u===e){i+=t.charAt(r>>2);i+=t.charAt((r&3)<<4|(f&240)>>4);i+=t.charAt((f&15)<<2);i+="=";break}o=n.charCodeAt(u++);i+=t.charAt(r>>2);i+=t.charAt((r&3)<<4|(f&240)>>4);i+=t.charAt((f&15)<<2|(o&192)>>6);i+=t.charAt(o&63)}return i}var i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createContent=function(){var t=n.DomUtilities.createJqueryDomElement("div");return t.addClass("fgc-barcode"),n.DomUtilities.setPropertyToDom(this.CellElement,t,this._getDomCreateInfo(),[2,5]),this.image=t,t},i.prototype.needValidate=function(){return!1},i.prototype.setValueToElement=function(t,r){var f=this.CellElement.CellType,u=this;if(r===""||r===undefined){u.image.empty();u.image.css("background-image","");return}n.Common.forguncyPost("Barcode/GetBarcode",i.GetRequestParam(r,f,this.CellElement.FullWidth,this.CellElement.FullHeight,this.CellElement.StyleInfo.Background,this.CellElement.StyleInfo.Foreground,u),function(t){u.image.empty();u.image.css("background-image",'url("'+t+'")');n.ImageHelper.appendInnerImage(u.image,t)},"GetBarcode "+this.ID)},i.GetRequestParam=function(t,i,u,f,e,o,s){return{value:r(t+"",s),codeType:i.CodeType,width:u,height:f,background:n.ColorHelper.Convert(e),connection:n.Common.IsEmpty(i.Connection)?!1:i.Connection,connectionNo:n.Common.IsEmpty(i.ConnectionNo)?0:i.ConnectionNo,version:n.Common.IsEmpty(i.Version)?-1:i.Version,checkDigit:n.Common.IsEmpty(i.CheckDigit)?!1:i.CheckDigit,checkDigitAlgorithm:n.Common.IsEmpty(i.CheckDigitAlgorithm)?"Modulus16":i.CheckDigitAlgorithm,foreground:n.ColorHelper.Convert(o)}},i.prototype.shouldDisplayInListviewNewRow=function(){return!1},i.prototype.clickable=function(){return!1},i.prototype.destroy=function(){t.prototype.destroy.call(this);this.image=null},i}(n.CellTypeBase),t;n.BarcodeCellType=i;n.ConvertThenEncode=r;t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";n.CellTypeHelper.registerCellType("Forguncy.BarcodeCellType, ServerDesignerCommon",i)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var h=function(t){function h(){return t!==null&&t.apply(this,arguments)||this}return __extends(h,t),h.prototype.create=function(i){t.prototype.create.call(this,i);var r=this.CellElement,u=r.CellType;u.Style!==3||n.StaticData.IsCellTypeExporting||i.css("overflow","initial");i.css("font-size",0)},h.prototype.createContent=function(){var y=this,c=this.CellElement,t=c.CellType,a,l,h,v;if(this.checkbox=t.Style!==3||n.StaticData.IsCellTypeExporting?new i(""):new r(""),this.checkbox.text=t.Caption?t.Caption:"",this.checkbox.isChecked=this.cellTypeData.getDefaultValue()===!0,this.checkbox.primaryColor=t.PrimaryColor?n.ColorHelper.Convert(t.PrimaryColor):"",this.checkbox.secondaryColor=t.SecondaryColor?n.ColorHelper.Convert(t.SecondaryColor):"",a=this._getDomCreateInfo(),a.id+="checkBoxLabel",this.checkbox.id=a.id,t.Style!==3||n.StaticData.IsCellTypeExporting||(this.checkbox.horizontalAlignment=c.StyleInfo.HorizontalAlignment,this.checkbox.verticalAlignment=c.StyleInfo.VerticalAlignment,this.checkbox.textIndent=c.StyleInfo.TextIndent),l=f,t.Style===1?l=e:t.Style===2?l=o:t.Style===3&&(l=s),n.StaticData.IsCellTypeExporting&&(l=u),h=this.checkbox.createUI(l),this.ui=h,this.isInListview)h.textContainer.css("overflow","hidden"),h.inputContainer.attr(n.StaticValues.isInListview,this.isInListview),h.inputContainer.css("outline","thin transparent");else{this.checkbox.on("PropertyChanged",function(n,t){t==="isChecked"&&y.commitValue()});n.FocusMoveHelper.AllowMoveFocusByEnterKey(h.inputContainer,this.isInListview)}return n.DomUtilities.setPropertyToDom(c,h.inputContainer,this._getDomCreateInfo(),[2,5]),t.Style!==3||n.StaticData.IsCellTypeExporting?(v=n.CellDomCreateHelper.createTextElement(c,h.container,a,!0,!1,!0),h.container.css("display",""),v):h.container},h.prototype.setValueToElement=function(n,t){this.checkbox.isChecked=h.isChecked(t)},h.prototype.getValueFromElement=function(){return this.checkbox.isChecked?1:0},h.prototype.validateValue=function(i,r,u){return r===void 0&&(r=null),u===void 0&&(u=!1),n.Common.IsEmpty(i)||typeof i=="boolean"||typeof i=="number"&&(i===1||i===0)?t.prototype.validateValue.call(this,i,r,u):n.RS.InvalidValueTypeMessage},h.prototype.destroy=function(){t.prototype.destroy.call(this);this.checkbox.dispose()},h.prototype._getCellTypeData=function(t){return new n.CheckBoxCellTypeData(t)},h.prototype._enable=function(){this.updateCheckboxEnabled()},h.prototype._disable=function(){this.updateCheckboxEnabled()},h.prototype._getPartsUseFontStyle=function(){return this.ui.textContainer},h.prototype.setStlyeInternal=function(t){n.DomUtilities.setPropertyToDom(t,this.ui.container,this._getDomCreateInfo(),[0])},h.prototype._getVisibleParts=function(){return this.ui.container},h.prototype.updateReadOnlyStatus=function(){this.updateCheckboxEnabled()},h.prototype.updateCheckboxEnabled=function(){this.checkbox.enabled=!this.isReadOnly()&&!this.isDisabled()},h.isChecked=function(t){return n.Common.isEquals(!0,t)||n.Common.isEquals(1,t)},h.count=0,h}(n.ListviewEditModeCellType),i,t,r,u,f,e,o,s,c;n.CheckBoxCellType=h;i=function(n){function i(r){var u=n.call(this,r)||this;return u.defaultUI=t,u.styleId=(i.count++).toString(),u.registProperty("styleId"),u.registProperty("foreColor"),u.registProperty("primaryColor"),u.registProperty("secondaryColor"),u}return __extends(i,n),i.count=0,i}(n.UI.CheckBox);n.DefaultCheckBox=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"styleId",{set:function(n){this.container.attr("styleid",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"foreColor",{set:function(n){this.textContainer.css("color",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){n.prototype.createContainer.call(this);this.container.addClass(this.extraCssName)},t}(n.UI.CheckBoxUI);n.DefaultCheckBoxUI=t;r=function(n){function t(t){var i=n.call(this,t)||this;return i.registProperty("horizontalAlignment"),i.registProperty("verticalAlignment"),i.registProperty("textIndent"),i}return __extends(t,n),t}(i);n.ButtonCheckBox=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return"fgc-toggle-exporting"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.inputContainer[0].checked=n;this.container.toggleClass("FUI-checked",n);this.svgContainer.empty();n?this.svgContainer.append('<svg t="1599122510588" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2706" width="14" height="14"><path d="M1024 1024H0V0h1024zM85.333333 938.666667h853.333334V85.333333H85.333333z" p-id="2707"><\/path><path d="M421.568 783.552 149.952 512 240.512 421.44 421.504 602.496 783.552 240.448 874.048 331.008Z" p-id="10034"><\/path><\/svg>'):this.svgContainer.append('<svg t="1599122510588" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2706" width="14" height="14"><path d="M1024 1024H0V0h1024zM85.333333 938.666667h853.333334V85.333333H85.333333z" p-id="2707"><\/path><\/svg>')},enumerable:!1,configurable:!0}),t.prototype.createInnerContainer=function(){n.prototype.createInnerContainer.call(this);this.svgContainer=$("<span><\/span>");this.innerContainer.append(this.svgContainer)},t}(t);n.ExportingCheckBoxUI=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return"fgc-checkbox-system"},enumerable:!1,configurable:!0}),t}(t);n.SystemCheckBoxUI=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-checkbox-modern"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var r=".".concat("FUI-checkbox",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-checked",".").concat("FUI-focus"," > .").concat("FUI-toggle-inner"),i=document.createElement("style");i.appendChild(document.createTextNode("".concat(r,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128),"}")));this.container.append($(i))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){var t=document.createElement("style");t.appendChild(document.createTextNode(".".concat("FUI-checkbox",'[styleid="').concat(this.target.styleId,'"] >.').concat("FUI-toggle-inner","::after{color:").concat(n," !important}<\/style>")));this.container.append($(t))},enumerable:!1,configurable:!0}),i}(t);n.ModernCheckBoxUI=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-switch"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var r=".".concat("FUI-checkbox",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-focus"," > .").concat("FUI-toggle-inner"),i=document.createElement("style");i.appendChild(document.createTextNode("".concat(r,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128),"}")));this.container.append($(i))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){var t=document.createElement("style");t.appendChild(document.createTextNode(".".concat("FUI-checkbox",'[styleId="').concat(this.target.styleId,'"] > .').concat("FUI-toggle-inner","::after{color:").concat(n," !important}")));this.container.append($(t))},enumerable:!1,configurable:!0}),i}(t);n.SwitchCheckBoxUI=o;s=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-button"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.container.css("color",t);var r=".".concat("FUI-checkbox",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-checked",".").concat("FUI-focus"),i=document.createElement("style");i.appendChild(document.createTextNode("".concat(r,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128),"}")));this.container.append($(i))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){var t=document.createElement("style");t.appendChild(document.createTextNode(".".concat("FUI-checkbox",'[styleid="').concat(this.target.styleId,'"].').concat("FUI-checked"," > .").concat("FUI-toggle-text","{color:").concat(n," !important}")));this.container.append($(t))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"horizontalAlignment",{set:function(t){switch(t){case n.CellHorizontalAlignment.Left:this.container.css("justify-content","flex-start");break;case n.CellHorizontalAlignment.General:case n.CellHorizontalAlignment.Center:this.container.css("justify-content","center");break;case n.CellHorizontalAlignment.Right:this.container.css("justify-content","flex-end")}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlignment",{set:function(t){switch(t){case n.CellVerticalAlignment.Top:this.container.css("align-items","flex-start");break;case n.CellVerticalAlignment.Center:this.container.css("align-items","center");break;case n.CellVerticalAlignment.Bottom:this.container.css("align-items","flex-end")}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textIndent",{set:function(t){if(t!==undefined&&t!==null){var i=this.target.horizontalAlignment;i===n.CellHorizontalAlignment.General||i===n.CellHorizontalAlignment.Left?this.textContainer.css("text-indent",t):i===n.CellHorizontalAlignment.Right&&this.textContainer.css("padding-right",t)}},enumerable:!1,configurable:!0}),i}(t);n.ButtonCheckBoxUI=s;c=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"".concat("fgc-toggle-button"," ").concat("fgc-toggle-groupbutton")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{set:function(t){n.Common.IsEmpty(t)?this.textContainer.text(" "):this.textContainer.text(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.container.css("color",t);var i=".".concat("FUI-checkbox",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-checked",".").concat("FUI-focus");this.container.append("<style>".concat(i,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128)," }<\/style>"))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){this.container.append("<style>.".concat("FUI-checkbox",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-checked"," > .").concat("FUI-toggle-text","{color:").concat(n," !important}<\/style>"))},enumerable:!1,configurable:!0}),i}(t);n.GroupButtonCheckBoxUI=c;n.CellTypeHelper.registerCellType("Forguncy.CheckBoxCellType, ServerDesignerCommon",h)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.HyperlinkCellType",n.TemplateNameParts=["LINK"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{LINK:n}},i.prototype.OnTemplateStyleApplied=function(t,i){var u,f,r;i&&(u=i.find("a"),u.css({fontSize:"inherit",color:"inherit",fontWeight:"inherit",fontStyle:"inherit",outline:"none"}),f=t.Key,r=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,f,"LINK"),n.CellTypeStyleTemplateUtils.AddFocusStyleToContainer(r,i),n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(r,i))},i.prototype.Clear=function(){t.prototype.Clear.call(this)},i}(n.CellTypeStyleTemplateHelperBase),t;n.HyperlinkCellTypeStyleTemplateHelper=i;t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.create=function(n){t.prototype.create.call(this,n);var i=this.CellElement.CellType;i&&!i.IsDisabled&&i.ClickMode===1&&n.css("cursor","pointer")},r.prototype.adjustForeColor=function(i,r){return i=t.prototype.adjustForeColor.call(this,i,r),n.Common.IsEmpty(i)?"inherit":i},r.prototype.needValidate=function(){return!1},r.prototype.createContent=function(){return r.createHyperlinkControl(this.CellElement,this._getDomCreateInfo())},r.createHyperlinkControl=function(t,i){var r=n.DomUtilities.createJqueryDomElement("a");r.attr("href","#");r.on("contextmenu",function(n){n.preventDefault()});return n.Platform.isIOSDevice()&&r.css("-webkit-text-size-adjust","100%"),t.StyleInfo.Underline||(t.StyleInfo.Underline=!1),n.DomUtilities.setPropertyToDom(t,r,i,[5]),n.CellDomCreateHelper.createTextElement(t,r,i)},r.prototype.setValueToElement=function(n,t){this._updateText(n,t)},r.prototype._updateText=function(t,i){var r={value:null},u=n.FormatHelper.formatValue(i,this.getFormatString(),r);n.GeneralCellType.setValueToLabel(t,u,r.value,this.CellElement)},r.prototype.onFormatterChanged=function(){var t=$("#"+this.ID),i;t.length===1&&(i=n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this.ID),this._updateText(t,i))},r.prototype.getValueFromElement=function(){return null},r.prototype._getClickableDomId=function(){var n=this.CellElement.CellType;return n&&n.ClickMode===1?this.ID+"_div":this.ID},r.prototype._getVisibleParts=function(n){return n.find("a")},r.prototype._disable=function(n){var r=n.find("a"),i;r.attr("disabled","disabled").css("cursor","default");i=this.getContainer();i.css("cursor","");i.attr("disabled","disabled");t.prototype._disable.call(this,i)},r.prototype._enable=function(){var i=$("#"+this.ID),n;i.removeAttr("disabled");i.css("cursor","");n=this.getContainer();n.css("cursor","pointer");n.removeAttr("disabled");t.prototype._enable.call(this,n)},r.prototype._getPartsUseBackcolor=function(){var n=$("#"+this.ID+"_backColor");return n.length===0?t.prototype._getPartsUseBackcolor.call(this):n},r.prototype.shouldDisplayInListviewNewRow=function(){return!1},r.prototype.hasFocus=function(){var n=$("#"+this.ID);return n.length>0&&document.activeElement===n[0]?!0:!1},r.prototype.setFocus=function(){var n=$("#"+this.ID);n.length>0&&n[0].focus()},r.prototype._setFontStyle=function(n){var i,u,f;t.prototype._setFontStyle.call(this,n);n.Underline===!1&&this.getContainer().css("text-decoration","none");this._needAdaptIosUnderlineinherit(r.StyleTemplateHelper.TemplateNameParts[0])&&(u=this.getContainer(),f=u.find("a"),((i=f[0])===null||i===void 0?void 0:i.style.textDecoration)==="none"&&(f.css("text-decoration","inherit"),u.find(".fgc-align,.fgc-align__inner").css("text-decoration","inherit")))},r.prototype.ExecuteCommand=function(){var t=this.CellElement.CellType.CommandList;n.ForguncyData.commandExcutor.insertCommandsToCurrentExecutingList(t,this.runTimePageName)},r.StyleTemplateHelper=new i,r}(n.ClickableCellTypeBase);n.HyperlinkCellType=t;n.CellTypeHelper.registerCellType("Forguncy.HyperlinkCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(t){function i(){var n=t.call(this)||this;return n.CellTypeString="Forguncy.ImageCellType",n.TemplateNameParts=["CONTAINER"],n}return __extends(i,t),i.prototype.MapPartsNameToDom=function(n){return{CONTAINER:n}},i.prototype.OnTemplateStyleApplied=function(t,i){if(t&&i){var r=n.CellTypeStyleTemplateUtils.FormatTemplateStyleClassName(this.CellTypeString,t.Key,"CONTAINER");n.CellTypeStyleTemplateUtils.AddDiableCallbackToContainer(r,i)}},i}(n.CellTypeStyleTemplateHelperBase),r,t,u;n.ImageCellTypeStyleTemplateHelper=i;r=function(n){function t(){var t=n.call(this)||this;return t.CellTypeString="Forguncy.UploadImageCellType",t}return __extends(t,n),t}(i);n.UploadImageCellTypeStyleTemplateHelper=r;t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.getStyleTemplateHelper=function(){return r.StyleTemplateHelper},r.prototype.isEditable=function(){return!1},r.prototype.needValidate=function(){return t.prototype.needValidate.call(this)&&this.isEditable()},r.prototype.create=function(n){n.css("margin",0);t.prototype.create.call(this,n)},r.prototype.createContent=function(){var f=this,u=this.CellElement,v=this.isInListview,e,h,p,c,o,l,s,a;v||(u.Value=null);e=n.DomUtilities.createJqueryDomElement("div");e.addClass("fgc-container-relative");var t=u.CellType,w=n.ImageHelper.getImageSrcFromCellContentElement(u),i=n.DomUtilities.createJqueryDomElement("div"),r={},y=this.isEditable();return v||y||(h=null,t.ImagePath&&(h=n.ImageHelper.getImageUrlFromImagePath(t.BuiltIn,t.ImagePath,!1)),i.attr("imagename",h),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(f.ID,{newValue:h},1)),t.ImageSizeMode===undefined||t.ImageSizeMode===0?(r.backgroundRepeat="no-repeat",i.attr("forguncyImage","true")):"background-size"in i[0].style||"backgroundSize"in i[0].style?(r.backgroundRepeat="no-repeat",r.backgroundSize=t.ImageSizeMode===1?"contain":"100% 100%",i.attr("forguncyImage","true")):i=n.DomUtilities.createJqueryDomElement("img"),r.width="100%",r.height="100%",this._image=i,(t.HorizontalAlignment===n.CellHorizontalAlignment.Center||t.HorizontalAlignment===undefined||t.HorizontalAlignment===null)&&(r.backgroundPositionX="50%"),t.HorizontalAlignment===n.CellHorizontalAlignment.Right&&(r.backgroundPositionX="100%"),(t.VerticalAlignment===n.CellVerticalAlignment.Center||t.VerticalAlignment===undefined||t.VerticalAlignment===null)&&(r.backgroundPositionY="50%"),t.VerticalAlignment===n.CellVerticalAlignment.Bottom&&(r.backgroundPositionY="100%"),i.addClass(n.CSSHelper.getClassName(r)),this.updateImageSource(w,i),p=[5,2,3],n.DomUtilities.setPropertyToDom(u,i,f._getDomCreateInfo(),p),e.append(i),t.Text&&!y&&(o=n.DomUtilities.createAbsoluteContainerDiv(),o.css("top",0),u.Value=t.Text,l=f._getDomCreateInfo(),l.id=f.ID+"_text",c=n.GeneralCellType.createLabelElement(u,l),n.DomUtilities.setPropertyToDom(u,o,l,[3]),o.append(c),e.append(o),u.Value=null),s=t.ToolTip,n.Common.IsEmpty(s)||(a=n.Common.IsEmpty(c)?i:c,n.FormulaManager.shouldEvaluateFormula(s)?a.hover(function(){var t=f.getDefaultFormulaCalcInfo(),i=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(s,t);a.attr("title",i)}):a.attr("title",s)),e},r.prototype.setValueToElement=function(t,i){var r,u;i!==this.getValue(!1)&&(t.attr("imagename",i),n.Common.isForguncyFile(i)&&(i=i+n.ImageQueryHelper.getImageQueryString(this.CellElement.FullWidth,this.CellElement.FullHeight,i)),t.empty(),r=i,n.Common.IsEmpty(i)&&(r=n.ImageHelper.getImageSrcFromElementImagePath(this.CellElement)),n.Common.isForguncyFile(r)&&(r=n.ImageHelper.getUploadImageSrc(r)),u=this.updateImageSource(r,t,i),u&&(t.attr("forguncyImage")?t.css("background-image",""):t.attr("src","")))},r.prototype.updateImageSource=function(t,i,r){var f=this,u;return r===void 0&&(r=null),n.ImageDataHelper.IsSvg(t)?(this._svgSrc=t,u=this.CellElement.CellType,n.ImageDataHelper.AppendSvg(i,t,u.Color,u.UseCellForeColor,function(n){return f.isInListview?!1:f._svgSrc!==n}),!0):(this._svgSrc=null,n.ImageHelper.setImageSource(i,n.Common.IsEmpty(r)?t:r),!1)},r.prototype.getValueFromElement=function(){var n=$("#"+this.ID);return n.length>0&&n.attr("imagename")?n.attr("imagename"):null},r.prototype._getClickableDomId=function(){return this.ID+"_div"},r.prototype._enable=function(n){this.getContainer().removeAttr("disabled");this.updateCursor(n,!0);t.prototype._enable.call(this,this.getContainer())},r.prototype._disable=function(n){this.getContainer().attr("disabled","disabled");this.updateCursor(n,!1);t.prototype._disable.call(this,this.getContainer())},r.prototype.shouldDisplayInListviewNewRow=function(){return!1},r.prototype._getPartsUseFontStyle=function(){var n=$("#"+this.ID+"_text");return this._image?this._image.add(n):n},r.prototype.updateReadOnlyStatus=function(){this.updateCursor(this.getContainer(),!this.isDisabled())},r.prototype.updateCursor=function(n,t){var i=n.find("#"+this.ID).parent().children(),r=n.find("label");this.usePointerCursor(t)?(i.css("cursor","pointer"),r.css("cursor","pointer")):(i.css("cursor",""),r.css("cursor",""))},r.prototype.usePointerCursor=function(n){return n?this.isEditable()?!this.isReadOnly():!!this.CellElement.CellType.CommandList:!1},r.prototype.destroy=function(){t.prototype.destroy.call(this);this._image=null},r.prototype.clickable=function(){var n;return((n=this.CellElement.CellType.CommandList)===null||n===void 0?void 0:n.length)>0},r.prototype.ExecuteCommand=function(){var t=this.CellElement.CellType.CommandList;n.ForguncyData.commandExcutor.insertCommandsToCurrentExecutingList(t,this.runTimePageName)},r.StyleTemplateHelper=new i,r}(n.ClickableCellTypeBase);n.ImageCellType=t;u=function(t){function i(n,i,r,u){var f=t.call(this,n,i,r,u)||this;return f.allowSetValueByUser=!1,f.supportedEvents=[],f}return __extends(i,t),i.prototype.getStyleTemplateHelper=function(){return i.StyleTemplateHelper},i.prototype._getCellTypeData=function(t){return new n.UploadImageCellTypeData(t)},i.prototype.isEditable=function(){return!0},i.prototype._disable=function(i){var r=i.find("#"+this.ID);r.off("click");n.DragFileToUploadHelper.unRegister(r);r.css("cursor","default");t.prototype._disable.call(this,this.getContainer())},i.prototype._enable=function(){var i=$("#"+this.ID);i.on("click",{cellType:this,image:i},this._onUploadImageClick);n.ImageUploadHelper.registerDragFile(i,this);i.css("cursor","pointer");t.prototype._enable.call(this,this.getContainer())},i.prototype._getClickableDomId=function(){return null},i.prototype.shouldDisplayInListviewNewRow=function(){return!0},i.prototype.showUploadingIndicator=function(){this._indicatorContainer.css("display","")},i.prototype.hideUploadingIndicator=function(){this._indicatorContainer.css("display","none")},i.prototype._onUploadImageClick=function(t){var r=t.data.cellType,u,f;!r.isEditable()||r.isDisabled()||r.isReadOnly()||(u=t.data.image,f=r.CellElement.CellType.UploadImageLimit,n.Common.uploadImageByFileSelector(f,i.allowDragFileType,function(t){r.hideUploadingIndicator();n.ImageUploadHelper.uploadSuccess(t,u,r)},function(t,i){if(r.hideUploadingIndicator(),t){var u=(i===null||i===void 0?void 0:i.status)===401?n.RS.UnauthorizedUpload:t;alert(u)}},function(){r.showUploadingIndicator()}))},i.prototype.createContent=function(){var r=t.prototype.createContent.call(this),u=this.isEditable(),i;if(u){i=r.children("[forguncyimage]");i.on("click",{cellType:this,image:i},this._onUploadImageClick);n.ImageUploadHelper.registerDragFile(i,this);i.css("cursor","pointer")}return this._indicatorContainer=n.DomUtilities.createLoadingIndicator(),r.append(this._indicatorContainer),r},i.prototype.disable=function(){t.prototype.disable.call(this);this.refreshClickable()},i.prototype.enable=function(){t.prototype.enable.call(this);this.refreshClickable()},i.prototype.setReadOnly=function(n){t.prototype.setReadOnly.call(this,n);this.refreshClickable()},i.prototype.clickable=function(){return!this.isReadOnly()&&!this.isDisabled()},i.allowDragFileType=".art, .bmp, .cmx, .cod, .dib, .gif, .ico, .ief, .jfif, .jpe, .jpeg, .jpg, .pbm, .pgm, .png, .pnm, .pnz, .ppm, .ras, .rf, .rgb, .svg, .tif, .tiff, .wbmp, .xbm, .xpm, .xwd",i.StyleTemplateHelper=new r,i}(t);n.UploadImageCellType=u;n.CellTypeHelper.registerCellType("Forguncy.ImageCellType, ServerDesignerCommon",t);n.CellTypeHelper.registerCellType("Forguncy.UploadImageCellType, ServerDesignerCommon",u)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getStyleTemplateHelper=function(){return i.StyleTemplateHelper},i.prototype._getCellTypeData=function(t){return new n.InputCellTypeData(t)},i.prototype.createCellContent=function(){var r=this,s=this.CellElement,c=this.isInListview,t=n.DomUtilities.createJqueryDomElement("input"),f,o,u,e,i,h;if(t.attr("type","password"),t.css("display","block"),n.CellDomCreateHelper.initalInputBox(s,t,this._getDomCreateInfo()),this._input=t,f=s.CellType,c||(t.change(function(){r.isReadOnly()||r._onValueChanged()}),t.focusout(function(){r.isReadOnly()||r.validate()}),n.FocusMoveHelper.AllowMoveFocusByEnterKey(t,this.isInListview)),o=this.cellTypeData.getDefaultValue(),n.Common.IsEmpty(o)||this._setValue(t,o),u=n.CellDomCreateHelper.createControlContainer(),u.append(t),e=f.IconSize,i=n.ImageDataHelper.CreateImage(f.Icon,e),this._image=i,i&&(i.css("margin","0px 5px"),i.css("position","absolute"),i.css("top","calc(50% - "+e/2+"px)"),u.append(i),this.CellElement.StyleInfo.HorizontalAlignment!==n.CellHorizontalAlignment.Center&&t.css("padding-left",e+10)),f.IsSelectAllOnFocus){h=u.find("#"+this.ID);h.on("focusin",function(){n.Platform.isChrome()?r.selectAll():n.DelayRefresh.setTimeout(function(){r.selectAll()})})}return u},i.prototype._getPartsUseFontStyle=function(){var n=t.prototype._getPartsUseFontStyle.call(this);return this._image?this._image.add(n):n},i.prototype.shouldNeverShowFormatLabel=function(){return!0},i.prototype.getValueToFormat=function(){var n=this._input.val();if(n)return n.toString().split("").map(function(){return"●"}).join("")},i.prototype.getFormaterOfFormatLabel=function(){return"@"},i.prototype.setValueToElement=function(n,t){n.val(t)},i.prototype.getValueFromElement=function(){var n=$("#"+this.ID);return n.length>0?n.val():null},i.prototype.setBackColor=function(n){var i=$("#"+this.ID);i.css("background-color","transparent");t.prototype.setBackColor.call(this,n)},i.prototype.getListviewNoneEditModeText=function(t,i,r,u){return(u===void 0&&(u=null),!n.Common.IsEmpty(t)&&this.CellElement.CellType.ShowPassword)?"******":""},i.prototype.canInputChars=function(){return!this.isDisabled()&&!this.isReadOnly()},i.prototype.selectAll=function(){var n=$("#"+this.ID);n.length>0&&n.select()},i.prototype.setCaretAtLast=function(){var n=$("#"+this.ID),i=n.val(),t;i&&n.length>0&&(t=n[0],t.selectionStart=t.selectionEnd=i.length)},i.prototype.setStlyeInternal=function(t){var i=$("#"+this.ID);i.length<=0||(n.Common.IsEmpty(t.StyleInfo.Background)||i.css("background-color",n.ColorHelper.Convert(t.StyleInfo.Background)),n.DomUtilities.setPropertyToDom(t,i,this._getDomCreateInfo(),[0]))},i.prototype._disable=function(n){n.find("#"+this.ID).attr("disabled","disabled");t.prototype._disable.call(this,n)},i.prototype._enable=function(n){$("#"+this.ID).removeAttr("disabled");t.prototype._enable.call(this,n)},i.prototype.updateReadOnlyStatus=function(){var n=this.getContainer().find("#"+this.ID);this.isReadOnly()?n.attr("readonly","readonly"):n.prop("readonly",!1)},i.prototype._getVisibleParts=function(n){return n.find("#"+this.ID)},i.prototype.getIgnoreKeysInListview=function(){return[37,39]},i.prototype.destroy=function(){t.prototype.destroy.call(this);this._image=null;this._input=null},i.StyleTemplateHelper=new n.InputCellTypeStyleTemplateHelperBase("Forguncy.TextCellType"),i}(n.SupportFormatCellType);n.PasswordCellType=t;n.CellTypeHelper.registerCellType("Forguncy.TextCellType, ServerDesignerCommon",t,function(n){return n.CellType.ShowPassword})})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.needValidate=function(){return!1},i.prototype.createContent=function(){var r=this,u=this.CellElement,e=n.DomUtilities.createJqueryDomElement("div"),t=u.CellType,h=i.AddImage(e,t.FirstImage,t,u),c=i.AddImage(e,t.PreviousImage,t,u),f,o,s,l;return t.ShowText&&(f=n.DomUtilities.createJqueryDomElement("div"),f.attr("id",r.ID+"Textdiv"),f.css("display","inline-block"),r.AddText(f,t.RecordDataTable,u,"currentIndexLabel","0",r.ID+"CurrentRow"),r.AddText(f,t.RecordDataTable,u,"","/",r.ID+"Slash"),r.AddText(f,t.RecordDataTable,u,"currentCountLabel"," 0",r.ID+"TotalRow"),i.AddRecordNavigationCellSpace(f,t,u),e.append(f)),o=i.AddImage(e,t.NextImage,t,u),s=i.AddImage(e,t.LastImage,t,u),i.AddGoToCommand(h,t.RecordDataTable,r.ID+"first",2,this),i.AddGoToCommand(c,t.RecordDataTable,r.ID+"previous",0,this),i.AddGoToCommand(o,t.RecordDataTable,r.ID+"next",1,this),i.AddGoToCommand(s,t.RecordDataTable,r.ID+"last",3,this),this._firstImage=h,this._lastImage=s,this._preImage=c,this._nextImage=o,l=n.DomUtilities.createAlignmentContainer(e,u.StyleInfo.HorizontalAlignment,u.StyleInfo.VerticalAlignment),e.css("white-space","nowrap"),l},i.AddGoToCommand=function(t,i,r,u,f){if(t){var e=[{$type:"Forguncy.Model.GoToRecordCommand, ServerDesignerCommon",TableName:i,TargetRecord:u}];t.attr("id",r);n.DomUtilities.addCustomCommand(t,e,r,f)}},i.AddImage=function(t,r,u,f){var o=u.ImageSize?u.ImageSize:16,e=n.ImageDataHelper.CreateImage(r,o);if(e)return e.css("display","inline-block"),i.AddRecordNavigationCellSpace(e,u,f),t.append(e),e},i.AddRecordNavigationCellSpace=function(t,i,r){var u=i.Space?i.Space:5;r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Left?t.css("margin-right",u):r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center?(t.css("margin-left",u/2),t.css("margin-right",u/2)):t.css("margin-left",u)},i.prototype.AddText=function(t,i,r,u,f,e){var o=n.DomUtilities.createJqueryDomElement("span");return o.text(f),o.attr("id",e),i||(i=""),u&&o.attr(u,i),o.css("min-width",50),n.DomUtilities.setPropertyToDom(r,o,this._getDomCreateInfo(),[0]),o.css("vertical-align","middle"),t.append(o),o},i.prototype._getPartsUseFontStyle=function(){var n=$("#"+this.ID+"_div span");return n=this._firstImage?n.add(this._firstImage):n,n=this._nextImage?n.add(this._nextImage):n,n=this._preImage?n.add(this._preImage):n,this._lastImage?n.add(this._lastImage):n},i.prototype.getValueFromElement=function(){return null},i.prototype.onCurrentRowInfoChanged=function(n){var t=this.CellElement.CellType.RecordDataTable;t&&t!==n||i.updateNavigationCellTypeText("currentIndexLabel",i._updateCurrentIndexLabel)},i._updateCurrentIndexLabel=function(n,t){t.text(i.getRecordID(n))},i.getRecordID=function(t){if(!t)return 0;var r=0,u=i.getRelatedListview(t.currentTable);return u?(r=u.getCurrentRowIndex()+1,(i.isInvalidNumber(r)||r>u.getActualDataLength())&&(r=0)):t&&!n.Common.IsEmpty(t.recordID)&&(r=1+Number(t.recordID),i.isInvalidNumber(r)&&(r=0)),r},i.isInvalidNumber=function(n){return typeof n!="number"||isNaN(n)||n<0},i.getRelatedListview=function(t){for(var r=n.ListviewBase.getAllListviews(),i=0;i<r.length;i++)if(r[i].getDataTableName()===t)return r[i];return null},i.updateCurrentCountLabel=function(t,r){var u,f,e,o;if(!t)return r.text("0");u=i.getRelatedListview(t.currentTable);u?(o=u.getActualDataLength(),r.text(o)):(f=n.ForguncyData.pageInfo.commandQuerys[t.currentTable],e="Home/GetRowCount",n.Common.forguncyPost(e,{queryCommandInfo:f?f:null,currentRowInfo:t},function(t){n.Common.IsEmpty(t)||r.text(t)},"GetRowCount "+r.attr("id")))},i.updateNavigationCellTypeText=function(t,i){for(var f,r,s=$("#centerDiv_"+n.ForguncyData.pageInfo.pageID).find("["+t+"]"),o=0;o<s.length;o++){var h=$(s[o]),e=h.attr(t),u=n.ListviewBase.getAllListviews();if(!e&&u&&u.length>0)for(r=0;r<u.length;r++)if(!u[r].isGroupMode()){e=u[r].getDataTableName();break}if(f=null,e){if(f=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(e),!f&&u)for(r=0;r<u.length;r++)u[r].isGroupMode()||u[r].getDataTableName()===e&&(f=u[r].getRowInfo())}else n.ForguncyData.pageInfo.currentRowInfoCollection.list.length>0&&(f=n.ForguncyData.pageInfo.currentRowInfoCollection.list[0]);i(f,h)}},i.prototype.destroy=function(){this._firstImage=null;this._nextImage=null;this._lastImage=null;this._preImage=null;t.prototype.destroy.call(this)},i}(n.CellTypeBase);n.RecordNavigationCellType=t;n.CellTypeHelper.registerCellType("Forguncy.RecordNavigationCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.needValidate=function(){return!1},i.prototype.onLoad=function(){var i=this,r=this.CellElement.CellType,t;this._listview=n.Page.getListViews(!0).filter(function(n){return n.getName()===r.PageingListviewName&&n.getRunTimePageName()===i.runTimePageName})[0];this._pagingChangedCallBack=function(n,t){r.PageLimitRowCount=t.MaxRowCountOfOnePage;i.onPagingInfoChanged(t)};this._listview.bind(n.ListViewEvents.PageingInfoChanged,this._pagingChangedCallBack);t=this._listview.getPaginationInfo();this.updateText(t.PageIndex,t.MaxRowCountOfOnePage,t.TotalRowCount)},i.prototype.initPagingInfo=function(){this._listviewLocation=n.ListviewBase.getLocationString(this.runTimePageName,this.getListviewName());n.ForguncyData.pageingInfoList.Init(this._listviewLocation,this.getLimit())},i.suspendCellTypeCommand=function(){this._isSusspend=!0},i.resumeCellTypeCommand=function(){this._isSusspend=!1},i.prototype.createContent=function(){var t=this,o,s,l;this.initPagingInfo();var r=this.CellElement,f=n.DomUtilities.createJqueryDomElement("div"),u=r.CellType;this._pageIndexID=t.ID+"currentPageIndexID";this._pageCountID=t.ID+"currentPageCountID";var h=i.addImage(f,u.FirstImage,u,r),c=i.addImage(f,u.PreviousImage,u,r),e=n.DomUtilities.createJqueryDomElement("div");e.attr("id",t.ID+"Textdiv");e.css("display","inline-block");var a=t.addTextBox(e,r,1..toString(),this._pageIndexID);return i.addInputGoToCommand(a,this._pageIndexID,this),t.addText(e,r,"/",t.ID+"Slash"),t.addText(e,r," 1",this._pageCountID),i.addPageNavigateCellSpace(e,u,r),f.append(e),o=i.addImage(f,u.NextImage,u,r),s=i.addImage(f,u.LastImage,u,r),i.addImageGoToCommand(h,t.ID+"first",0,this),i.addImageGoToCommand(c,t.ID+"previous",1,this),i.addImageGoToCommand(o,t.ID+"next",2,this),i.addImageGoToCommand(s,t.ID+"last",3,this),this._firstImage=h,this._lastImage=s,this._preImage=c,this._nextImage=o,l=n.DomUtilities.createAlignmentContainer(f,r.StyleInfo.HorizontalAlignment,r.StyleInfo.VerticalAlignment),f.css("white-space","nowrap"),l},i.prototype.onPagingInfoChanged=function(n){this.updateText(n.CurrentPageIndex,n.MaxRowCountOfOnePage,n.TotalRowCount)},i.prototype.destroy=function(){this._listview&&this._listview.unbind(n.ListViewEvents.PageingInfoChanged,this._pagingChangedCallBack);this._firstImage=null;this._nextImage=null;this._lastImage=null;this._preImage=null;t.prototype.destroy.call(this)},i.prototype.setPageIndex=function(t){if(!isNaN(t)){var i=n.ForguncyData.pageingInfoList.GetInfo(this._listviewLocation).getPageCount();return t>i?t=i:t<=0&&(t=1),this.getCurrentPageIndexLabel().val(t)}},i.prototype.setPageCount=function(n){return this.getCurrentPageCountLabel().text(" "+n)},i.prototype.getPageIndex=function(){return Number(this.getCurrentPageIndexLabel().val())},i.prototype.getListviewName=function(){return this.CellElement.CellType.PageingListviewName},i.prototype.getLimit=function(){return this.CellElement.CellType.PageLimitRowCount},i.addImageGoToCommand=function(t,i,r,u){if(t){t.attr("id",i);t.css("cursor","pointer");t.on("click",function(){if(!u.isDisabled()){var t=[{$type:"Forguncy.Model.GoToPageCommand, ServerDesignerCommon",targetPageKind:r,ListviewName:u.getListviewName(),TargetPageIndex:u.getPageIndex(),Limit:u.getLimit()}];n.ForguncyData.commandExcutor.excuteCommand(t,{runTimePageName:u.runTimePageName,commandTrigger:u,commandID:i,eventType:"click"})}return!1})}},i.addInputGoToCommand=function(t,i,r){this._isSusspend!==!0&&t&&(t.focusout(function(){if(!r.isDisabled()){r.setPageIndex(r.getPageIndex());var t=[{$type:"Forguncy.Model.GoToPageCommand, ServerDesignerCommon",targetPageKind:4,ListviewName:r.getListviewName(),TargetPageIndex:r.getPageIndex(),Limit:r.getLimit()}];n.ForguncyData.commandExcutor.excuteCommand(t,{runTimePageName:r.runTimePageName,commandTrigger:r,commandID:i,eventType:"click"})}}),t.keydown(function(n){r.isDisabled()||n.keyCode!==13||$(this).blur()}))},i.addImage=function(t,r,u,f){var o=u.ImageSize?u.ImageSize:16,e=n.ImageDataHelper.CreateImage(r,o);if(e)return e.css("display","inline-block"),i.addPageNavigateCellSpace(e,u,f),t.append(e),e},i.addPageNavigateCellSpace=function(t,i,r){var u=i.Space?i.Space:5;r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Left?t.css("margin-right",u):r.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center?(t.css("margin-left",u/2),t.css("margin-right",u/2)):t.css("margin-left",u)},i.prototype.addText=function(t,i,r,u){var f=n.DomUtilities.createJqueryDomElement("span");return f.text(r),f.attr("id",u),f.css("min-width",50),n.DomUtilities.setPropertyToDom(i,f,this._getDomCreateInfo(),[0]),f.css("vertical-align","middle"),t.append(f),f},i.prototype.addTextBox=function(t,i,r,u){var f=n.DomUtilities.createJqueryDomElement("input"),e,o;return f.val(r),f.attr("id",u),e=n.MeasureHelper.getWidth(null,null,i.StyleInfo.FontSize,i.StyleInfo.FontFamily,"000000"),o=e,f.css("width",o),n.DomUtilities.setPropertyToDom(i,f,this._getDomCreateInfo(),[0]),f.css("vertical-align","middle"),f.css("text-align","center"),f.css("margin-right","10px"),t.append(f),f},i.prototype._getPartsUseFontStyle=function(){var n=$("#"+this.ID+"_div span");return n=this._firstImage?n.add(this._firstImage):n,n=this._nextImage?n.add(this._nextImage):n,n=this._preImage?n.add(this._preImage):n,this._lastImage?n.add(this._lastImage):n},i.prototype.getValueFromElement=function(){return null},i.prototype.getCurrentPageIndexLabel=function(){return $("#"+this._pageIndexID)},i.prototype.getCurrentPageCountLabel=function(){return $("#"+this._pageCountID)},i.prototype.updateText=function(n,t,i){var r=this.getPageIndexFromPagingInfo(n,t),u=Math.max(1,Math.ceil(i/t));this.setPageCount(u);this.setPageIndex(r)},i.prototype.getPageIndexFromPagingInfo=function(n,t){return n>0&&t>0?Math.max(1,Math.ceil(n*t/this.getLimit())):1},i}(n.CellTypeBase);n.PageNavigateCellType=t;n.CellTypeHelper.registerCellType("Forguncy.PageNavigateCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(i){function r(n,t,r,u){var f=i.call(this,n,t,r,u)||this;return f.userLabelWidth=0,f.pictureWidth=0,f.arrowWidth=0,f.currentUserLabel=null,f.allowSetValueByUser=!1,f}return __extends(r,i),r.prototype.createContent=function(){var n=this.CellElement;return t.CreateCurrentUserCellType(n,this._getDomCreateInfo(),this)},r.prototype.onWindowResized=function(){this.setCurrentUserLabelEllipsis()},r.prototype.setCurrentUserLabelEllipsis=function(){var i=this,t,r;n.Common.IsEmpty(this.currentUserLabel)||(t=this.getContainer()[0].offsetWidth,t-=this.pictureWidth+this.arrowWidth,r=this.userLabelWidth,r>t?(this.currentUserLabel.attr("title",this.currentUserLabel.text()),n.DomUtilities.SetTextEllipsis(this.currentUserLabel,t,function(){i.currentUserLabel.css("padding-left","2px")})):n.DomUtilities.ClearTextEllipsis(this.currentUserLabel,function(){i.currentUserLabel.css("padding-left","0px");i.currentUserLabel.css("white-space","pre")}))},r.prototype._setOverflowHidden=function(){return},r.prototype._disable=function(n){r.disableCurrentUserCell(n,this.ID)},r.disableCurrentUserCell=function(n,t){var i=n.find("a"),r;i&&i.length&&(i.attr("disabled","disabled"),i.css("cursor","default"));r=n.find("#"+t+"_dropdown");r.length>0&&r.attr("data-toggle")==="dropdown"&&r.removeAttr("data-toggle")},r.prototype._enable=function(){r.enableCurrentUserCell(this.ID)},r.enableCurrentUserCell=function(n){var t=$("#"+n+"_div").find("a"),i;t&&t.length&&(t.removeAttr("disabled"),t.css("cursor",""));i=$("#"+n+"_dropdown");i.length>0&&i.attr("data-toggle","dropdown")},r.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+" label,#"+this.ID+"_login")},r.prototype._setDropDownButtonVisible=function(n){var i=$("#"+this.ID+"_dropdown"),t;i.length>0&&(t=i.find("span[currentUserDropDownButton = show]"),t.length>0&&(n?t.css("display",""):t.css("display","none")))},r.prototype.enterPrintMode=function(){this._setDropDownButtonVisible(!1)},r.prototype.quitPrintMode=function(){this._setDropDownButtonVisible(!0)},r.prototype._getVisibleParts=function(n){return n.find("a")},r.prototype.getBindingTables=function(){var t=this.CellElement.CellType;return t.ShowNotification?n.ForguncyData.GlobalSettings.WorkflowTables:null},r.prototype.reload=function(){n.DelayRefresh.Push(r,function(){t.UpdateAllNotificationIcon()},"RefreshNotifications")},r.prototype.destroy=function(){i.prototype.destroy.call(this);this.currentUserLabel=null},r.prototype.needValidate=function(){return this.CellElement.CellType.IsGenerateByKeyWord?!1:i.prototype.needValidate.call(this)},r}(n.CellTypeBase),t,r;n.CurrentUserCellType=i;t=function(){function t(){}return t.CreateCurrentUserCellType=function(i,r,u){var e=i.CellType,tt=n.ForguncyData.AuthenticationType===3,rt=n.ForguncyData.AuthenticationType===4,ut=n.ForguncyData.SecurityProviderValidateType===3,ft=n.ForguncyData.SecurityProviderValidateType===4,et=rt&&(ut||ft),h,o,c,d,nt,a,s,v,p,y,g;if(!n.Page.getUserName()){if(tt)return h=t._createLoginLinkForForm(i,u,r),n.DomUtilities.setPropertyToDom(i,h,r,[2]),h;if(et)return h=t._createLoginLinkForSecurityProvider(i,u,r),n.DomUtilities.setPropertyToDom(i,h,r,[2]),h}o=n.DomUtilities.createJqueryDomElement("table");o.css("border-spacing",0);c=n.DomUtilities.createJqueryDomElement("tr");o.append(c);o.css("height","100%");n.DomUtilities.setPropertyToDom(i,o,r,[1]);var l=e.ShowUserPicture&&tt,ot=e.ShowCircleUserPicture,w=e.ShowDropDown&&n.ForguncyData.AllowLogout&&n.Page.getUserName(),it=!l||e.ShowUserDisplayName,st=it&&e.ShowUserDisplayName,ht=l&&e.ShowNotification,b;if(l){b=n.DomUtilities.createJqueryDomElement("td");var f=n.DomUtilities.createJqueryDomElement("img"),ct=i.Height-2,k=Math.max(ct,0);ot?(f.css("height",k),f.css("width",k),f.css("object-fit","cover"),f.css("border-radius","50%")):(f.css("max-height",k),f.css("max-width",k));f.css("margin-top",1);f.css("margin-bottom",1);f.css("padding",0);f.css("margin-right",10);f.css("vertical-align","text-bottom");f.attr("id",u.ID+"_image");w&&f.css("cursor","pointer");b.append(f);d=void 0;n.ForguncyData.userInfo.HasPicture?(nt="",n.ForguncyData.UserProfileAvatorVersion&&(nt="&v="+n.ForguncyData.UserProfileAvatorVersion),d=n.ForguncyData.ForguncyRoot+"Account/UserImage?userName="+n.ForguncyData.userInfo.UserName+nt):d=n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/DefaultCurrentUser.png";n.ImageHelper.setImageSource(f,d);c.append(b)}if(it&&(a=n.DomUtilities.createJqueryDomElement("td"),s=n.DomUtilities.createJqueryDomElement("label"),s.attr("id",u.ID+"_name"),w&&s.css("cursor","pointer"),n.DomUtilities.setPropertyToDom(i,s,r,[0]),t._setVerticalAlign(a,i.StyleInfo.VerticalAlignment),!l&&e.ShowNotification&&a.css("position","relative"),a.append(s),c.append(a),v=u,v.currentUserLabel=s,n.DelayRefresh.setTimeout(function(){var t=$("#"+u.ID+"_image")[0];n.Common.IsEmpty(t)||(v.pictureWidth=t.offsetWidth+10);n.Common.IsEmpty(p)||(v.arrowWidth=p[0].offsetWidth);v.userLabelWidth=s[0].offsetWidth;v.setCurrentUserLabelEllipsis()},0)),p=null,l||st?(e.ShowUserDisplayName&&(n.ForguncyData.userInfo.FullName?s.text(n.ForguncyData.userInfo.FullName):s.text(n.ForguncyData.userInfo.UserName)),w&&(p=t._createPopupDropdownArrow(i,c))):(s.text(n.Page.getUserName()),w&&(p=t._createPopupDropdownArrow(i,c))),e.ShowNotification){if(y=t._createNoificationIcon(l),y.css("display","none"),y.attr("notificationIcon",""),y.attr("id",u.ID+"_notification"),g=ht?b:a,g.append(y),e.NavigatePageNameForNotification){g.data("allowNavigate",!0);g.on("click",function(){if(y.css("display")!=="none"){var i={NavigateType:"normal",DeleteCachedQuery:!0,PageName:e.NavigatePageNameForNotification},t=new n.NavigateCommand;return t.CommandParam=i,t.execute(),!1}})}u.reload()}return t._setHorizonalAlign(o,i.StyleInfo.HorizontalAlignment),e.ShowDropDown&&n.ForguncyData.AllowLogout&&(o=n.DomUtilities.createDropDownListForFormUser(i,o,u),i.StyleInfo.HorizontalAlignment===n.CellHorizontalAlignment.Center&&o.find(".dropdown-menu").css({left:"50%","-webkit-transform":"translateX(-50%)","-ms-transform":"translateX(-50%)",transform:"translateX(-50%)"})),n.DomUtilities.setPropertyToDom(i,o,r,[2]),o},t.UpdateAllNotificationIcon=function(){t._updateNotificationIcon($("[notificationIcon]"))},t._updateNotificationIcon=function(t){if(t&&t.length!==0&&(n.ForguncyData.GlobalSettings.HasWorkflow||n.ForguncyData.GlobalSettings.HasProcess)){var i=function(i){var u,f,r;if(!n.Common.IsEmpty(i))for(u=Number(i),f=t.parent(),u>99?t.text("99+"):t.text(u),u>0?t.css("display","inline"):t.css("display","none"),r=0;r<f.length;r++)$(f[r]).data("allowNavigate")&&(u>0?$(f[r]).css("cursor","pointer"):$(f[r]).css("cursor",""))};n.ForguncyData.GlobalSettings.HasWorkflow?n.Common.forguncyPost("WorkflowApi/GetNotificationNum",null,i,"GetNotificationNum"):n.ForguncyData.GlobalSettings.HasProcess&&n.BPM.Engine.taskService.getProcessNotificationNumAsync().then(function(n){i(n)})}},t._createLoginLinkForForm=function(t,i,r){var u=n.DomUtilities.createJqueryDomElement("a"),f;u.attr("href","#");u.on("contextmenu",function(n){n.preventDefault()});return u.attr("id",i.ID+"_login"),u.text(n.RS.login),n.DomUtilities.setPropertyToDom(t,u,r,[0,1]),f=n.DomUtilities.createAlignmentContainer(u,t.StyleInfo.HorizontalAlignment,t.StyleInfo.VerticalAlignment),n.DomUtilities.createNavigateCommand(u,n.BuiltInPageManager.builtInPages[n.BuiltInPageType.Login],i.ID+"login",i),f},t._createLoginLinkForSecurityProvider=function(t,i,r){var u=n.DomUtilities.createJqueryDomElement("a");return u.attr("href",n.ForguncyData.ForguncyRoot+"1C3E7540-99F6-4BE2-9654-47BE0FB82280/"+n.ForguncyData.pageInfo.pageName),u.attr("id",i.ID+"_login"),u.text(n.RS.login),n.DomUtilities.setPropertyToDom(t,u,r,[0,1]),n.DomUtilities.createAlignmentContainer(u,t.StyleInfo.HorizontalAlignment,t.StyleInfo.VerticalAlignment)},t._setVerticalAlign=function(t,i){t.css("vertical-align",n.DomUtilities.getVerticalAlignmentText(i))},t._setHorizonalAlign=function(t,i){i===n.CellHorizontalAlignment.Center?t.css("margin","auto"):i===n.CellHorizontalAlignment.Right&&t.css("margin-left","auto")},t._createPopupDropdownArrow=function(i,r){var f=n.DomUtilities.createJqueryDomElement("td"),u=$(document.createElement("span")).addClass("caret");return u.attr("currentUserDropDownButton","show"),u.css("height",4),u.css("margin",4),i.StyleInfo&&typeof i.StyleInfo.Foreground!="undefined"&&u.css("color",n.ColorHelper.Convert(i.StyleInfo.Foreground)),f.append(u),t._setVerticalAlign(f,i.StyleInfo.VerticalAlignment),r.append(f),u},t._createNoificationIcon=function(t){var i=n.DomUtilities.createJqueryDomElement("span");return t?i.addClass("fgc-notification-icon"):i.addClass("fgc-notification-name-icon"),i.css("font-family",n.LocaleFonts.default),i},t}();n.CurrentUserCellTypeBuilder=t,function(n){n[n.KeepCurrentPage=0]="KeepCurrentPage";n[n.GoToHomePage=1]="GoToHomePage";n[n.GoToSpecificPage=2]="GoToSpecificPage";n[n.GoToURL=3]="GoToURL";n[n.None=4]="None"}(r=n.NavigateWhenLogoutMode||(n.NavigateWhenLogoutMode={}));n.CellTypeHelper.registerCellType("Forguncy.CurrentUserCellType, ServerDesignerCommon",i)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var u="label",t="div",k="processCellTypeTargetTable",e="FontInfo",o="cellTypeInfo",s="getUsersResult",h="GetHistoryResult",c="1px solid rgb(160, 160, 160)",l="_changeAssigneeBtn",a="_stateBtn",d="_createBy",g="_modifyBy",nt="_action_",v="_assignTo",tt="_nextStatus",y="_comment",it="_ok",rt="_cancel",ut="_assignToTitle",p="_assignee_",ft="_radio_assignee_",et="_history",ot="_row_",st="_operator",ht="_time",ct="_action",lt="_td",at="_endStatus",vt="3F47E3C5-01F5-41D3-AEDC-0F20EC5C560F",r="version",yt="_ActionPopup",pt="_HistoryPopup",wt="_AssignToPopup",bt="_ActionDiv",w="_AssigneeDiv",b=function(b){function kt(){return b!==null&&b.apply(this,arguments)||this}return __extends(kt,b),kt.prototype.needValidate=function(){return!1},kt.prototype.createContent=function(){return this.createProcessBarCellType(this.CellElement,this.isInListview)},kt.prototype.onWindowResized=function(){n.Platform.isMobile()||i.closePopup()},kt.prototype._getPartsUseFontStyle=function(){return $("#"+this.ID+",#"+this.ID+" label")},kt.prototype._disable=function(n){var t=n.find("button");t.attr("disabled","disabled");t.css("cursor","default")},kt.prototype._enable=function(){var n=$("#"+this.ID).find("button");n.removeAttr("disabled");n.css("cursor","pointer")},kt.prototype._getVisibleParts=function(n){return n.find("button")},kt.prototype.onCurrentRowInfoChanged=function(n){this.CellElement.CellType.TableName===n&&this.refresh($("#"+this.ID))},kt.prototype.createProcessBarCellType=function(i){var s=this,u=n.DomUtilities.createJqueryDomElement(t),r,f;return u.attr("id",this.ID),r={},r.StyleInfo={},r.StyleInfo.FontWeight=i.StyleInfo.FontWeight,r.StyleInfo.FontFamily=i.StyleInfo.FontFamily,r.StyleInfo.FontSize=i.StyleInfo.FontSize,r.StyleInfo.Foreground=n.ColorHelper.Convert(i.StyleInfo.Foreground),r.StyleInfo.Underline=i.StyleInfo.Underline,r.StyleInfo.FontStyle=i.StyleInfo.FontStyle,r.StyleInfo.Strikethrough=i.StyleInfo.Strikethrough,r.StyleInfo.Underline=i.StyleInfo.Underline,n.DomUtilities.setPropertyToDom(r,u,s._getDomCreateInfo(),[0]),delete r.StyleInfo.Foreground,u.data(e,r),f=i.CellType,u.attr(k,f.TableName),u.data(o,f),this.shouldEnableTabIndex()&&u.data("tabindex",i.CellType.TabIndex),n.DomUtilities.createAlignmentContainer(u,null,i.StyleInfo.VerticalAlignment)},kt.prototype.getBindingTables=function(){var n=this.CellElement.CellType;return[n.TableName]},kt.prototype.reload=function(){var n=$("#"+this.ID);this.refresh(n)},kt.prototype.refresh=function(t){var f=n.Common.getUniqueNumber(),i,u,e;if(t.data(r,f),!n.ForguncyData.userInfo.UserName){t.empty();return}if(i=t.data(o),u=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(i.TableName),!u||!u.query){t.empty();return}e=this;n.Common.forguncyPost("WorkflowApi/GetWorkflowInfo",{currentInfo:u,needEditStatusInfo:i.ShowCreateBy||i.ShowModifyBy,needRecordInfo:i.ShowCurrentSate||i.ShowCurrentAssignTo},function(n){n&&t.data(r)===f&&e._createProcessBarByWorkflowInfo(t,i,n)},"GetWorkflowInfo"+this.ID)},kt.prototype._createProcessBarByWorkflowInfo=function(i,r,u){var f=this,s=i.data("tabindex"),h=i.data(e),o=n.DomUtilities.createJqueryDomElement(t),c=u.EditStatusInfo;i.data("creator",u.Creator);i.data("lastModifier",u.LastModifier);f._createCreatorInfoPart(r,c,o);f._createModifierInfoPart(r,c,o);f._createStateButton(r,u,o,h,s);f._createCurrentAssignToPart(r,u,o,h,s);f._createActionButtonPart(r,u,o,h,s);i.empty();i.append(o);f.isDisabled()&&f._disable(i);f.isVisible()||f._setVisible(f.getContainer(),!1)},kt.prototype._createCreatorInfoPart=function(t,i,r){if(t.ShowCreateBy&&i.CreateDate){var f=n.DomUtilities.createJqueryDomElement(u);f.attr("id",this.ID+d);f.css("margin","5px 2px");f.append(n.Common.format(n.RS.ProcessBarCell_CreateBy,kt._getNameText(i.Creator),kt._getDateString(i.CreateDate)));f.css("float","right");f.css("clear","right");r.append(f)}},kt.prototype._createModifierInfoPart=function(t,i,r){if(t.ShowModifyBy&&i.LastModifyDate){var f=n.DomUtilities.createJqueryDomElement(u);f.attr("id",this.ID+g);f.css("margin","5px 2px");f.text(n.Common.format(n.RS.ProcessBarCell_LastModifyBy,kt._getNameText(i.LastModifier),kt._getDateString(i.LastModifyDate)));f.css("float","right");f.css("clear","right");r.append(f)}},kt.prototype._createStateButton=function(t,i,r,u,f){var o=this,e;if(t.ShowCurrentSate){if(e=o._createButton(n.Common.format(n.RS.ProcessBarCell_Status,i.RecordInfo.State),t.ShowHistory,u,!t.ShowHistory,f),e.attr("id",this.ID+a),t.ShowHistory)e.on("click",function(){return o._onStateButtonClick(t.TableName,u),!1});e.css("float","right");e.css("clear","right");t.ShowActionButton&&e.css("margin-bottom","2px");r.append(e)}},kt.prototype._createCurrentAssignToPart=function(t,i,r,u,f){var y=this,l,e,h,o,a,c,s;if(t.ShowCurrentAssignTo&&(l=!1,e=i.RecordInfo.AssignTo,e&&e.length>0&&(l=kt._isAssignToMe(e),!l||e.length>1))){if(h="",l)h=n.RS.ProcessBarCell_AssignedTo_me;else for(o=0;o<e.length;o++)if(e[o].FullName!==undefined&&e[o].FullName!==null){h=String(e[o].FullName||e[o].UserName);break}a="";c=!1;e.length>1?(c=!0,a=n.RS.ProcessBarCell_AssignedTo+": "+n.Common.format(n.RS.ProcessBarCell_AssignedToMultiUser,h,e.length-1)):a=n.RS.ProcessBarCell_AssignedTo+": "+h;s=y._createButton(a,c,u,!c,f);c&&s.click(function(){return y._showAssignToPopup(s,e,u),!1});s.attr("id",this.ID+v);s.css("float","left").css("margin-bottom","2px");r.append(s)}},kt.prototype._createActionButtonPart=function(i,r,u,f,e){var h=this,o=n.DomUtilities.createJqueryDomElement(t),c,s,a,v;if(o.attr("id",this.ID+bt),c=h._createActionButton(o,i,r,f,e),r.IsAdminOrAllowPermission){s=h._createButton(n.RS.ProcessBarCell_ChangeAssignee,!1,f,!1,e);kt._notOnlyHasActionButton(i)&&s.css("margin-bottom","2px");s.attr("id",h.ID+l);s.on("click",function(){return h._onChangeAssigneeButtonClick(i.TableName,f,r.RecordInfo.AssignTo),!1});o.append(s);c=!0}c&&(o.css({float:"left",clear:"left",display:"flex","flex-wrap":"wrap","align-items":"center"}),u.append(o),o.children().length>0&&(a=o.children().first(),v=o.children().last(),a.css("margin-left",0),v.css("margin-right",0)))},kt._notOnlyHasActionButton=function(n){return n.ShowCreateBy||n.ShowCurrentAssignTo||n.ShowCurrentSate||n.ShowHistory||n.ShowModifyBy},kt.prototype._createActionButton=function(t,i,r,u,f){var s=this,a=!1,o;if(i.ShowActionButton)for(o=0;o<r.PossibleAction.length;o++){var h=r.PossibleAction[o],e=null,c=h.Action.ActionName===""?" ":h.Action.ActionName,l=kt._getActionButtonMergedStyle(i,c);if(l){if(!l.Visible)continue;e=s._createStyledButtonOrLink(l,c,u,f)}else e=s._createButton(c,!1,u,!1,f);kt._notOnlyHasActionButton(i)&&e.css("margin-bottom","2px");e.attr("id",s.ID+nt+o.toString());e.possibleAction=h,function(t,i,r){t.on("click",function(){return s._showChangeStatePopup(t,t.possibleAction,i,n.RS.ProcessBarCell_ActionPopup_Title,!0,r,u,null),!1})}(e,i.TableName,i.AllowEditComments);t.append(e);a=!0}return a},kt._getActionButtonMergedStyle=function(n,t){var u,i,r;return n.ActionButtonStyleInfo?(u=n.ActionButtonStyleInfo.CommonStyle,kt._addDefaultColor(u),i=null,n.ActionButtonStyleInfo.SpecialStyleMap&&(i=n.ActionButtonStyleInfo.SpecialStyleMap[t]),!u)?(i&&kt._addDefaultColor(i),i):i?(r=$.extend(!0,{},u),kt._addDefaultColor(i),i.IsDefaultSize||(r.IsDefaultSize=!1,r.Width=i.Width,r.Height=i.Height),r.Visible=i.Visible,i.IsDefaultGap||(r.IsDefaultGap=!1,r.Gap=i.Gap),i.IsDefaultFont||(r.IsDefaultFont=!1,r.FontFamily=i.FontFamily,r.FontSize=i.FontSize,r.FontWeight=i.FontWeight,r.FontStyle=i.FontStyle,r.IsUnderline=i.IsUnderline,r.IsStrikeThrough=i.IsStrikeThrough),i.IsDefaultColor||(r.IsDefaultColor=!1,r.ForegroundColor=i.ForegroundColor,r.BackgroundColor=i.BackgroundColor),i.IsDefaultBorder||(r.IsDefaultBorder=!1,r.BorderColor=i.BorderColor,r.BorderWidth=i.BorderWidth),r.DisplayType=i.DisplayType,i.CssClassName&&(r.CssClassName=i.CssClassName),r):u:null},kt._addDefaultColor=function(n){n.ForegroundColor||(n.ForegroundColor="#000");n.BackgroundColor||(n.BackgroundColor="#d3d3d3");n.BorderColor||(n.BorderColor="#000")},kt.prototype._createStyledButtonOrLink=function(t,i,r,u){var s=this;t||(t={DisplayType:f.ShowAsButton,IsDefaultBorder:!0,IsDefaultColor:!0,IsDefaultFont:!0,IsDefaultGap:!0,IsDefaultSize:!0});var h=t.DisplayType===f.ShowAsButton,o=null,e=null;return e=h?n.DomUtilities.createJqueryDomElement("button"):n.DomUtilities.createJqueryDomElement("a"),e.css("display","flex").css("justify-content","center").css("align-items","center").css("vertical-align","bottom").css("box-sizing","border-box").css("cursor","pointer").css("overflow","hidden").css("margin","0 2px"),n.Platform.isMobile()?e.addClass("mobileButtonStyle"):e.css("padding","1px 6px"),o=n.DomUtilities.createJqueryDomElement("span"),n.DomUtilities.setPropertyToDom(r,o,s._getDomCreateInfo(),[0]),o.text(i),e.append(o),u!==undefined&&e.attr("tabindex",u),n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.moveFocusByEnter&&e.attr("type","button"),t.IsDefaultSize||(t.Width>0&&e.css("width",t.Width+"px"),t.Height>0&&e.css("height",t.Height+"px")),!t.IsDefaultGap&&t.Gap>=0&&e.css("margin-right",t.Gap+"px"),t.IsDefaultFont||(t.FontFamily&&o.css("font-family",t.FontFamily),t.FontSize&&o.css("font-size",t.FontSize),t.FontWeight&&o.css("font-weight",t.FontWeight),t.FontStyle&&o.css("font-style",t.FontStyle),t.IsUnderline&&o.css("text-decoration","underline")),t.IsDefaultColor||(t.ForegroundColor&&e.css("color",n.ColorHelper.Convert(t.ForegroundColor)),t.BackgroundColor&&e.css("background-color",n.ColorHelper.Convert(t.BackgroundColor))),t.IsDefaultBorder||t.BorderColor&&t.BorderWidth&&e.css("border",t.BorderWidth+"px solid "+n.ColorHelper.Convert(t.BorderColor)),t.CssClassName&&e.addClass(t.CssClassName),e},kt.prototype._createButton=function(t,i,r,u,f){var v=this,e=n.DomUtilities.createJqueryDomElement("button"),o,s,h;e.css("margin","auto 2px");n.Platform.isMobile()?e.addClass("mobileButtonStyle"):e.css("padding","1px 6px");o=n.DomUtilities.createJqueryDomElement("table");o.css("border-spacing","0px");var c=n.DomUtilities.createJqueryDomElement("tr"),l=n.DomUtilities.createJqueryDomElement("td"),a=n.DomUtilities.createJqueryDomElement("span");if(n.DomUtilities.setPropertyToDom(r,a,v._getDomCreateInfo(),[0]),a.text(t),l.css("padding","0px"),l.append(a),c.append(l),i&&(s=n.DomUtilities.createJqueryDomElement("td"),h=n.DomUtilities.createJqueryDomElement("span"),h.addClass("caret"),h.css("height","4px"),s.css("padding","0px"),s.append(h),c.append(s)),u){e.css("cursor","default");e.on("click",function(){return!1})}else e.css("cursor","pointer");return o.append(c),e.append(o),f!==undefined&&e.attr("tabindex",f),n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.moveFocusByEnter&&e.attr("type","button"),e},kt._getWorkflowCommand=function(n,t,i,r){return{$type:"WorkflowCommand.WorkflowCommand, WorkflowCommand",ActionGUID:n.Action.GUID,AssignTo:r?r.join(","):"",WorkflowComments:i,TableName:t,ReloadAfterSucceed:!0}},kt.prototype._getCommands=function(t,i,r,u,f){var e,o,s;return typeof t=="string"?(!n.Common.IsEmpty(r)&&r.toString()&&(e=r.toString().replace(/\,/g,";"),t=t.replace(new RegExp("%AssignTo%","g"),e)),o=$("#"+this.ID).data("creator"),s=$("#"+this.ID).data("lastModifier"),t=t.replace(new RegExp("%Creator%","g"),o),t=t.replace(new RegExp("%LastModifier%","g"),s),t=t.replace(new RegExp(/\[%Comment%\]/,"g"),escape(u)),t=t.replace(new RegExp("618EABB7-87A4-4BE8-B2E0-912BE75F321B","g"),f),JSON.parse(t)):[]},kt.prototype._createNextStatePart=function(i,r){var u=n.DomUtilities.createJqueryDomElement(t);u.append(n.RS.ProcessBarCell_ActionPopup_NextStatus);u.css("margin","0px 0px 10px 0px");u.css("font-weight","bold");i.append(u);u=n.DomUtilities.createJqueryDomElement(t);u.attr("id",this.ID+tt);u.append(r.ToSateName);u.css("margin","0px 0px 15px 0px");i.append(u)},kt.prototype._createAssigneePart=function(i,r,u,f){var o=[],e;return r.AssignTo&&r.AssignTo.length>0&&(e=n.DomUtilities.createJqueryDomElement(t),e.attr("id",this.ID+ut),e.css("margin","0px 0px 5px 0px"),e.css("font-weight","bold"),e.append(r.Policy==="Choose"?n.RS.ProcessBarCell_ActionPopup_Assignto_Choose:n.RS.ProcessBarCell_ActionPopup_Assignto_All),i.append(e),e=n.DomUtilities.createJqueryDomElement(t),e.attr("id",this.ID+w),e.css("border-width","0px"),e.css("overflow","auto"),e.css("max-height","150px"),r.Policy==="Choose"?o=this._createChooseModeAssigneePart(e,r,f):this._createAllModeAssigneePart(e,r,u),i.append(e)),o},kt.prototype._createChooseModeAssigneePart=function(i,r,f){for(var s,c,e,h,l=this,a=[],v=n.Common.getUniqueNumber().toString(),o=0;o<r.AssignTo.length;o++)s=n.DomUtilities.createJqueryDomElement(t),n.Platform.isMobile()?s.css("margin","10px 0px 0px 0px"):o===0?s.css("margin","5px 0px 0px 0px"):s.css("margin","5px 0px 5px 0px"),c=l.ID+ft+o.toString(),e=n.DomUtilities.createJqueryDomElement("input"),e.css("margin","0px 0px 3px 0px"),e.css("padding","0px"),e.attr("type","radio"),e.attr("id",c),e.attr("ignoreFocusInPopup","true"),e.val(r.AssignTo[o].UserName),e.attr("name",v),r.Action.GUID===vt?f&&f.length>0?r.AssignTo[o].UserName===f[0].UserName&&e.prop("checked",!0):r.AssignTo[o].UserName||e.prop("checked",!0):o===0&&e.prop("checked",!0),a.push(e),s.append(e),h=n.DomUtilities.createJqueryDomElement(u),h.attr("id",l.ID+p+o.toString()),h.text(kt._getNameText(n.Common.IsEmpty(r.AssignTo[o].FullName)?r.AssignTo[o].UserName:r.AssignTo[o].FullName)),h.attr("for",c),s.append(h),i.append(s);return a},kt.prototype._createAllModeAssigneePart=function(n,t,i){var r=this._getListWithBlackSquare(t.AssignTo,i);n.append(r)},kt.prototype._createCommentPart=function(i,r){var f=n.DomUtilities.createJqueryDomElement(t),u;return f.append(n.RS.ProcessBarCell_ActionPopup_Comments),f.css("margin","15px 0px 10px 0px"),f.css("font-weight","bold"),i.append(f),u=n.DomUtilities.createJqueryDomElement("textarea"),n.DomUtilities.setPropertyToDom(r,u,this._getDomCreateInfo(),[0]),u.attr("id",this.ID+y),u.attr("ignoreFocusInPopup","true"),u.css("margin","0px"),u.css("border",c),u.css("padding","2px"),u.css("resize","none"),u.width(244),u.height(100),i.append(u),u},kt.prototype._showChangeStatePopup=function(i,r,u,f,e,o,s,h){var l=this,c=n.DomUtilities.createJqueryDomElement(t),v,a;c.css("white-space","pre-wrap");c.css("padding","10px");c.width(264);e&&this._createNextStatePart(c,r);v=this._createAssigneePart(c,r,s,h);a=o?this._createCommentPart(c,s):null;l._showPopup(i,c,f,s,l.ID+yt,function(){var t,i;if(r.Policy==="Choose")t=kt._getRadiosValue(v);else for(t=[],i=0;i<r.AssignTo.length;i++)t.push(r.AssignTo[i].UserName);var f=a?a.val():null,e=l._getCommands(r.PreCommands,r,t,f,u),o=l._getCommands(r.Commands,r,t,f,u),s=kt._getWorkflowCommand(r,u,f,t);n.ForguncyData.commandExcutor.excuteCommand(e.concat(s,o),{runTimePageName:l.runTimePageName,commandTrigger:null,commandID:null,eventType:"click"})})},kt.prototype._getListWithBlackSquare=function(t,i){var c=this,s=n.DomUtilities.createJqueryDomElement("table"),r,f,e,o,h;for(n.DomUtilities.setPropertyToDom(i,s,c._getDomCreateInfo(),[0]),s.css("white-space","pre-wrap"),r=0;r<t.length;r++)f=n.DomUtilities.createJqueryDomElement("tr"),r===0?f.css("margin","5px 0px 0px 0px"):f.css("margin","5px 0px 5px 0px"),e=n.DomUtilities.createJqueryDomElement("td"),o=n.DomUtilities.createJqueryDomElement("div"),o.width(4),o.height(4),o.css("background-color","black"),e.append(o),f.append(e),e=n.DomUtilities.createJqueryDomElement("td"),h=n.DomUtilities.createJqueryDomElement(u),h.attr("id",c.ID+p+r.toString()),h.text(kt._getNameText(n.Common.IsEmpty(t[r].FullName)?t[r].UserName:t[r].FullName)),e.append(h),f.append(e),s.append(f);return s},kt._getNameText=function(n){return n===undefined||n===null?"":String(n)},kt.prototype._showPopup=function(r,u,f,e,o,s){var v=this,y=n.DomUtilities.createJqueryDomElement(t),w,a,p,h,l;if(n.DomUtilities.setPropertyToDom(e,y,v._getDomCreateInfo(),[0]),w=n.DomUtilities.createJqueryDomElement(t),w.css("margin","5px 2px"),w.append(f),y.append(w),a=n.DomUtilities.createJqueryDomElement(t),a.css("background-color","white"),a.css("border",c),a.css("padding","2px"),a.css("margin","2px"),a.css("border-radius","4px"),a.append(u),y.append(a),s!==undefined){p=n.DomUtilities.createJqueryDomElement(t);p.css("margin","2px");h=n.DomUtilities.createJqueryDomElement("button");h.attr("id",v.ID+it);n.DomUtilities.setPropertyToDom(e,h,v._getDomCreateInfo(),[0]);h.text(n.RS.ProcessBarCell_OK);h.css("margin","2px 2px 2px 0px");h.attr("ignoreFocusInPopup","true");h.on("click",function(){i.closePopup();s()});p.append(h);l=n.DomUtilities.createJqueryDomElement("button");l.attr("id",v.ID+rt);n.DomUtilities.setPropertyToDom(e,l,v._getDomCreateInfo(),[0]);l.text(n.RS.ProcessBarCell_Cancel);l.css("margin","2px");l.attr("ignoreFocusInPopup","true");l.on("click",function(){i.closePopup()});p.append(l);n.Platform.isMobile()&&(h.addClass("mobileButtonStyle"),l.addClass("mobileButtonStyle"));y.append(p)}i.showPopup(r,y,o)},kt.prototype._onStateButtonClick=function(t,i){var u=this,s=$("#"+u.ID).data(r),f=$("#"+u.ID+a),e,o;f.length===1&&(e=f.data(h),e===undefined?(o=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(t),n.Common.forguncyPost("WorkflowApi/GetHistory",{currentInfo:o},function(n){s===$("#"+u.ID).data(r)&&(f.data(h,n),u._showHistoryPopup(f,t,i,n))},"GetHistory "+u.ID)):u._showHistoryPopup(f,t,i,e))},kt.prototype._showHistoryPopup=function(t,r,u,f){i.closePopup();var e=this._createHistoryPopupContent(f,u);this._showPopup(t,e,n.RS.ProcessBarCell_HistoryPopup_Title,u,this.ID+pt)},kt.prototype._createHistoryPopupContent=function(i,r){var a=this,f=n.DomUtilities.createJqueryDomElement(t),s,e,h,l,o,u,c,p;if(f.css("max-height","300px"),f.css("overflow","auto"),i&&i.length>0){for(s=n.DomUtilities.createJqueryDomElement("table"),s.attr("id",a.ID+et),n.DomUtilities.setPropertyToDom(r,s,a._getDomCreateInfo(),[0]),s.addClass("proceeBarHistoryTable"),e=n.DomUtilities.createJqueryDomElement("tr"),h=r.StyleInfo.FontWeight===n.StaticValues.FontWeight_Bold,kt._addTh(e,n.RS.ProcessBarCell_History_Operator,h),kt._addTh(e,n.RS.ProcessBarCell_History_Time,h),kt._addTh(e,n.RS.ProcessBarCell_History_ActionName,h),kt._addTh(e,n.RS.ProcessBarCell_History_EndStatus,h),kt._addTh(e,n.RS.ProcessBarCell_AssignedTo,h),kt._addTh(e,n.RS.ProcessBarCell_History_Comments,h),s.append(e),l=0;l<i.length;l++)o=i[l],u=n.DomUtilities.createJqueryDomElement("tr"),l%2==1&&u.css("background-color","#fafaf8"),c=a.ID+ot+l.toString(),kt._addTd(u,c+st,kt._getNameText(o.Who),0),kt._addTd(u,c+ht,kt._getDateString(o.When),0),kt._addTd(u,c+ct,o.ActionName,0),kt._addTd(u,c+at,o.State,0),kt._addTd(u,c+v,kt._getAssignToStr(o.AssignTo),0,kt._getAssignToTooltipStr(o.AssignTo)),kt._addTd(u,c+y,o.Comments,200),s.append(u);f.append(s)}else p=n.DomUtilities.createJqueryDomElement(t),p.append(n.RS.None),f.css("min-width","130px"),f.css("text-align","center"),f.css("padding","20px 0px"),f.append(p);return f},kt._getAssignToStr=function(t){if(t&&t.length>0){if(t.length>1){var i=kt._getFistAssigneeNameText(t);return n.Common.format(n.RS.ProcessBarCell_AssignedToMultiUser,i,t.length-1)}return t[0]}return n.RS.None},kt._getFistAssigneeNameText=function(n){if(n&&n.length)for(var t=0;t<n.length;t++)if(n[t]!==undefined&&n[t]!==null)return String(n[t]);return""},kt._getAssignToTooltipStr=function(n){var i,t;if(n&&n.length>0){for(i="",t=0;t<n.length;t++)i+=kt._getNameText(n[t])+(t===n.length-1?"":"\r\n");return i}return null},kt._addTh=function(t,i,r){var u=n.DomUtilities.createJqueryDomElement("th");r||u.css("font-weight","normal");u.text(i);t.append(u)},kt._addTd=function(i,r,u,f,e){var s=n.DomUtilities.createJqueryDomElement("td"),o,h;s.attr("id",r+lt);o=n.DomUtilities.createJqueryDomElement(t);h=n.DomUtilities.createJqueryDomElement("label");h.attr("id",r);h.text(u);o.append(h);f&&o.css("width",f+"px");o.css("max-height","50px");o.css("vertical-align","middle");o.css("overflow-x","hidden");o.css("word-break","break-word");o.css("text-overflow","ellipsis");s.attr("title",e?e:u);s.append(o);i.append(s)},kt.prototype._showAssignToPopup=function(i,r,u){var f=n.DomUtilities.createJqueryDomElement(t),e;f.css("white-space","pre-wrap");f.css("padding","10px");f.css("max-height","200px");f.css("min-width","200px");f.css("overflow","auto");f.attr("id",this.ID+w);e=this._getListWithBlackSquare(r,u);f.append(e);this._showPopup(i,f,n.RS.ProcessBarCell_AssignedToPopup_Title,u,this.ID+wt)},kt.prototype._onChangeAssigneeButtonClick=function(t,i,u){var f=this,h=$("#"+f.ID).data(r),e=$("#"+f.ID+l),o;e.length===1&&(o=e.data(s),o===undefined?n.Common.forguncyPost("Account/GetUsers",{role:"",columns:3,sortedByFullName:!0},function(o){var l,c;h===$("#"+f.ID).data(r)&&o&&o.Result&&(l=o.Properties.users,l&&(c={},c.FullName=n.RS.None,c.UserName=null,l.unshift(c)),e.data(s,o),f._showChangeAssigneePopup(e,t,i,o,u))},"GetUsers "+f.ID):f._showChangeAssigneePopup(e,t,i,o,u))},kt.prototype._showChangeAssigneePopup=function(t,i,r,u,f){var e=u.Properties.users;t.possibleAction={Action:{ActionName:n.RS.ProcessBarCell_ChangeAssignee,GUID:"3F47E3C5-01F5-41D3-AEDC-0F20EC5C560F"},Policy:"Choose",AssignTo:e};this._showChangeStatePopup(t,t.possibleAction,i,n.RS.ProcessBarCell_ChangeAssignee,!1,!0,r,f)},kt._getRadiosValue=function(n){var i=[],t;if(n)for(t=0;t<n.length;t++)n[t][0].checked&&i.push(n[t].val());return i},kt._isAssignToMe=function(t){var r,i;if(t&&t.length>0&&n.ForguncyData.userInfo.UserName)for(r=n.ForguncyData.userInfo.UserName.toLowerCase(),i=0;i<t.length;i++)if(t[i].UserName.toLowerCase()===r)return!0;return!1},kt._getDateString=function(t){return typeof t=="number"?n.FormatHelper.getTextFromValue(n.Convertor.fromOADateToDate(t)):n.FormatHelper.getTextFromValue(t)},kt.prototype.destroy=function(){i.closePopup();b.prototype.destroy.call(this)},kt}(n.CellTypeBase),f,i;n.ProcessBarCellType=b,function(n){n[n.ShowAsButton=0]="ShowAsButton";n[n.ShowAsHyperLink=1]="ShowAsHyperLink"}(f||(f={}));i=function(){function t(){}return t.showPopup=function(i,r,u){var l=$(document.body),s=n.Common.getPageConver("#FFF",.01),f,e,h,c,o,a;s.attr("FGCPopup","true");s.css("z-index",-1);f=n.DomUtilities.createJqueryDomElement("div");e=n.DomUtilities.createJqueryDomElement("div");e.css("padding",5);e.css("background-color","#e0e0e0");e.css("border","1px solid #a0a0a0");e.css("border-radius","4px");f.css("overflow","auto");f.css("position","absolute");f.css("z-index","100");f.attr("id",u);h=t._createIndicator(!0);f.append(h);e.append(r);f.append(e);c=t._createIndicator(!1);f.append(c);l.append(s);l.append(f);f.attr("FGCPopup","true");o=i.offset();/webkit.*mobile/i.test(navigator.userAgent)&&!/iPhone|iPad/i.test(navigator.userAgent)&&n.ForguncyData.pageInfo.allowZoomScreen&&(o.top=o.top-window.scrollY,o.left=o.left-window.scrollX);a={x:o.left,y:o.top,width:i.outerWidth(),height:i.outerHeight()};t._updatePosition(f,h,c,a);n.DelayRefresh.setTimeout(function(){s.css("z-index",99)},0);f.on("click",function(){return!0});s.on("click",function(){t.closePopup()})},t._updatePosition=function(n,i,r,u){var c=$(window).outerWidth(),a=$(window).outerHeight(),f=n.outerWidth(),e=t._setLeft(n,f,u,c),s,h,o,l;f=n.outerWidth();(e>u.x+u.width-20||e+f<u.x+20)&&(e=t._setLeft(n,f,u,c));s=Math.ceil(n.outerHeight())+10;t._isPopupPlaceDown(a,s,u)?(h=u.y+u.height+i.outerHeight(),$(n.children()[1]).css("margin-top",10),o=i):(h=Math.floor(u.y-s),n.css("padding-bottom",10),o=r);n.css("top",h);o.css("display","");l=n.outerWidth()-30;o.css("margin-left",Math.min(l,u.x-e+u.width/3-10))},t._setLeft=function(n,t,i,r){var u=i.x+(i.width-t)/3,f=$(document).scrollLeft();return u=Math.min(u,r-t-10+f),u=Math.max(f,u),n.css("left",u),u},t._isPopupPlaceDown=function(n,t,i){return n-(i.y+i.height-window.pageYOffset)>t||i.y-window.pageYOffset<t},t._createIndicator=function(i){var u=n.DomUtilities.createJqueryDomElement("div"),f,r;return i?u.css("top",1):u.css("margin-top",-1),t._setArrowProperty(u,"#e0e0e0",i),f=n.DomUtilities.createJqueryDomElement("div"),t._setArrowProperty(f,"#a0a0a0",i),r=n.DomUtilities.createJqueryDomElement("div"),r.append(f),r.append(u),r.css("display","none"),r},t._setArrowProperty=function(n,t,i){n.width(0);n.height(0);n.css(i?"border-bottom":"border-top","10px solid "+t);n.css("border-left","10px solid transparent");n.css("border-right","10px solid transparent");n.css("position","absolute")},t.closePopup=function(){var n=$("[FGCPopup]");n.off("click");n.remove()},t}();n.CellTypeHelper.registerCellType("Forguncy.ProcessBarCellType, ServerDesignerCommon",b)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createSingleItemToggle=function(t,i){var u=this.CellElement.CellType,r=new n.DefaultCheckBox(t);return r.foreColor=i,r.primaryColor=n.ColorHelper.Convert(u.PrimaryColor),r.secondaryColor=n.ColorHelper.Convert(u.SecondaryColor),r},i.prototype.createSingleItemUI=function(t){var r=this.CellElement.CellType,i=n.SystemCheckBoxUI;return r.Style===1?i=n.ModernCheckBoxUI:r.Style===2?i=n.SwitchCheckBoxUI:r.Style===3&&(i=n.GroupButtonCheckBoxUI),n.StaticData.IsCellTypeExporting&&(i=n.ExportingCheckBoxUI),t.createUI(i)},i.prototype.setValueToUIInternal=function(t,i,r,u){var s=u?u.toString().split(","):null,o=null,h,c,e,f;if(s){for(h=s.length-1,e=h;e>=0;e--)s[e]=n.Common.trimStr(s[e]);for(f=0;f<r.length;f++){if(typeof r[f]!="string")if(n.Common.IsEmpty(r[f]))continue;else u=r[f]+"";else u=n.Common.trimStr(r[f]);for(c=!1,e=h;e>=0;e--)if(s[e]===u){c=!0;break}o=i[f];o.checked=c;$(o).trigger("change")}}else for(f=0;f<r.length;f++)typeof r[f]!="function"&&(o=i[f],o.checked=!1,$(o).trigger("change"))},i.prototype.getValueInternal=function(t,i){for(var u,e,o=i.length,r="",f=0;f<o;f++)t[f].checked&&(u=i[f],typeof u=="function"?u()&&(r.length>0&&(r+=","),r+=u()):(r.length>0&&(r+=","),e=n.Common.IsEmpty(u)?"":u.toString(),r+=e));return n.Common.IsEmpty(r)?null:r},i.prototype.getOtherValue=function(n,t){var r,f,i,u;if(this.containsOtherItem()&&t)for(r=t.toString().split(","),f=function(t){var i=(r[t]+"").trim(),u=!1;return $(n).each(function(){if((this||this===0)&&(this+"").trim()===i)return u=!0,!1}),u?void 0:{value:i}},i=0;i<r.length;i++)if(u=f(i),typeof u=="object")return u.value},i.prototype.allowFormatValue=function(){return!1},i.prototype.getListviewNoneEditModeText=function(n,i,r,u){var e,o,f;for(u===void 0&&(u=null),e=this.getValuesToFormat(n),o=[],f=0;f<e.length;f++)o.push(t.prototype.getListviewNoneEditModeText.call(this,e[f],null,r,u));return o.join(",")},i.prototype.getValuesToFormat=function(t){var s=[],u=this.CellElement.CellType,f,e,o,h,c,i,r;if(!n.Common.IsEmpty(t)&&u.haveLoadItems&&u.ItemsInfo&&(f=t.toString().split(","),f)){for(e=u.ItemsInfo.Items,o=0;o<f.length;o++)for(i=e.length-1;i>=0;i--)n.Common.isFuzzyEquals(e[i].Value,f[o])&&s.push(e[i].DisplayValue);if(this.containsOtherItem()){for(h=[],c=u.ItemsInfo.Items,i=0;i<c.length;i++)h.push(c[i].Value);r=this.getOtherValue(h,t);n.Common.IsEmpty(r)||(r=r+"",n.Common.IsEmpty(r)||s.push(r))}}return s},i}(n.GroupCellTypeBase);n.CheckBoxGroupCellType=t;n.CellTypeHelper.registerCellType("Forguncy.CheckBoxGroupCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var s=function(t){function s(){return t!==null&&t.apply(this,arguments)||this}return __extends(s,t),s.prototype.createSingleItemToggle=function(t,r){var f=this.CellElement.CellType,u=new i(t);return u.foreColor=r,u.primaryColor=n.ColorHelper.Convert(f.PrimaryColor),u.secondaryColor=n.ColorHelper.Convert(f.SecondaryColor),u},s.prototype.createSingleItemUI=function(t){var s=this.CellElement.CellType,i=u;return s.Style===1?i=f:s.Style===2?i=e:s.Style===3&&(i=o),n.StaticData.IsCellTypeExporting&&(i=r),t.createUI(i)},s.prototype.setValueToUIInternal=function(t,i,r,u){for(var e,f=0;f<r.length;f++)e=i[f],e.checked=n.Common.isEquals(r[f],u),$(e).trigger("change")},s.prototype.getValueInternal=function(n,t){for(var r,u=t.length,i=0;i<u;i++)if(n[i].checked)return r=t[i],typeof r=="function"?r():r;return null},s.prototype.getOtherValue=function(t,i){var u,r,f;if(this.containsOtherItem()){for(u=n.Common.IsEmpty(i)?"":i.toString(),r=0;r<t.length;r++)if(f=n.Common.IsEmpty(t[r])?"":t[r].toString(),u===f)return;return i}},s.prototype.getListviewNoneEditModeText=function(n,i,r,u){return u===void 0&&(u=null),n=this.getValueToFormat(n),t.prototype.getListviewNoneEditModeText.call(this,n,i,r,u)},s.prototype.getValueToFormat=function(t){var u=this.CellElement.CellType,r,i;if(u.haveLoadItems&&u.ItemsInfo)for(r=u.ItemsInfo.Items,i=0;i<r.length;i++)if(n.Common.isFuzzyEquals(r[i].Value,t))return r[i].DisplayValue;return this.containsOtherItem()?t:""},s}(n.GroupCellTypeBase),i,t,r,u,f,e,o;n.RadioGroupCellType=s;i=function(n){function i(r){var u=n.call(this,r)||this;return u.defaultUI=t,u.styleId=(i.count++).toString(),u.registProperty("styleId"),u.registProperty("foreColor"),u.registProperty("primaryColor"),u.registProperty("secondaryColor"),u}return __extends(i,n),i.count=0,i}(n.UI.Radio);n.DefaultRadio=i;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"styleId",{set:function(n){this.container.attr("styleid",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"foreColor",{set:function(n){this.textContainer.css("color",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return""},enumerable:!1,configurable:!0}),t.prototype.createContainer=function(){n.prototype.createContainer.call(this);this.container.addClass(this.extraCssName)},t}(n.UI.RadioUI);n.DefaultRadioUI=t;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return"fgc-toggle-exporting"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{set:function(n){this.inputContainer[0].checked=n;this.container.toggleClass("FUI-checked",n);this.svgContainer.empty();n?this.svgContainer.append('<svg t="1599123147130" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3561" width="14" height="14"><path d="M506.892 81.849c-241.603 0-439.276 197.674-439.276 439.276 0 241.598 197.674 439.271 439.276 439.271 241.598 0 439.269-197.674 439.269-439.271 0-241.603-197.674-439.276-439.269-439.276z m0 834.618c-219.637 0-395.348-175.709-395.348-395.342 0-219.637 175.709-395.348 395.348-395.348 219.633 0 395.342 175.709 395.342 395.348-0.001 219.633-175.711 395.342-395.342 395.342z m0 0z" p-id="3562"><\/path><path d="M287.253 521.124c0 28.751 5.714 57.488 16.719 84.049 11.002 26.562 27.28 50.929 47.611 71.255 20.331 20.331 44.69 36.609 71.255 47.612 26.559 11.006 55.301 16.718 84.053 16.718 28.751 0 57.488-5.714 84.049-16.718 26.562-11.003 50.929-27.282 71.255-47.612 20.331-20.327 36.609-44.69 47.612-71.255 11.006-26.56 16.718-55.299 16.718-84.049 0-28.752-5.714-57.494-16.718-84.053-11.003-26.563-27.282-50.925-47.612-71.255-20.327-20.331-44.69-36.609-71.255-47.611-26.56-11.007-55.299-16.719-84.049-16.719-28.752 0-57.494 5.714-84.053 16.719-26.563 11.002-50.925 27.28-71.255 47.611-20.331 20.331-36.609 44.69-47.611 71.255-11.007 26.559-16.719 55.301-16.719 84.053z m0 0z" p-id="3563"><\/path><\/svg>'):this.svgContainer.append('<svg t="1599123147130" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3561" width="14" height="14"><path d="M506.892 81.849c-241.603 0-439.276 197.674-439.276 439.276 0 241.598 197.674 439.271 439.276 439.271 241.598 0 439.269-197.674 439.269-439.271 0-241.603-197.674-439.276-439.269-439.276z m0 834.618c-219.637 0-395.348-175.709-395.348-395.342 0-219.637 175.709-395.348 395.348-395.348 219.633 0 395.342 175.709 395.342 395.348-0.001 219.633-175.711 395.342-395.342 395.342z m0 0z" p-id="3562"><\/path><\/svg>')},enumerable:!1,configurable:!0}),t.prototype.createInnerContainer=function(){n.prototype.createInnerContainer.call(this);this.svgContainer=$("<span><\/span>");this.innerContainer.append(this.svgContainer)},t}(t);n.ExportingRadioUI=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"extraCssName",{get:function(){return"fgc-radio-system"},enumerable:!1,configurable:!0}),t}(t);n.SystemRadioUI=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-radio-modern"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var r=".".concat("FUI-radio",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-checked",".").concat("FUI-focus"," > .").concat("FUI-toggle-inner"),i=document.createElement("style");i.appendChild(document.createTextNode("".concat(r,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128),"}")));this.container.append($(i))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){var t=document.createElement("style");t.appendChild(document.createTextNode(".".concat("FUI-radio",'[styleid="').concat(this.target.styleId,'"] >.').concat("FUI-toggle-inner","::after{background-color:").concat(n," !important}")));this.container.append($(t))},enumerable:!1,configurable:!0}),i}(t);n.ModernRadioUI=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"fgc-toggle-switch"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.innerContainer.css("color",t);var r=".".concat("FUI-radio",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-focus"," > .").concat("FUI-toggle-inner"),i=document.createElement("style");i.appendChild(document.createTextNode("".concat(r,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128),"}")));this.container.append($(i))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){var t=document.createElement("style");t.appendChild(document.createTextNode(".".concat("FUI-radio",'[styleid="').concat(this.target.styleId,'"] > .').concat("FUI-toggle-inner","::after{color:").concat(n," !important}")));this.container.append($(t))},enumerable:!1,configurable:!0}),i}(t);n.SwitchRadioUI=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"extraCssName",{get:function(){return"".concat("fgc-toggle-button"," ").concat("fgc-toggle-groupbutton")},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{set:function(t){n.Common.IsEmpty(t)?this.textContainer.text(" "):this.textContainer.text(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"primaryColor",{set:function(t){this.container.css("color",t);var r=".".concat("FUI-radio",'[styleId="').concat(this.target.styleId,'"].').concat("FUI-checked",".").concat("FUI-focus"),i=document.createElement("style");i.appendChild(document.createTextNode("".concat(r,"{box-shadow: 0 0 3px 2px ").concat(n.ColorHelper.UpdateTint(t,0,128),"}")));this.container.append($(i))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"secondaryColor",{set:function(n){var t=document.createElement("style");t.appendChild(document.createTextNode(".".concat("FUI-radio",'[styleid="').concat(this.target.styleId,'"].').concat("FUI-checked"," > .").concat("FUI-toggle-text","{color:").concat(n," !important}")));this.container.append($(t))},enumerable:!1,configurable:!0}),i}(t);n.ButtonRadioUI=o;n.CellTypeHelper.registerCellType("Forguncy.RadioGroupCellType, ServerDesignerCommon",s)})(Forguncy||(Forguncy={}))
;var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var f=function(){function t(){}return t.initialize=function(){$(document).on("initPageData",function(){t.OnRowCountChanged()});$(window).on("ForguncyRowCountChanged",function(){t.OnRowCountChanged()});n.Platform.isIOSDevice&&(window.onpageshow=function(n){n.persisted&&($("body").remove(),window.location.reload())});$(window).resize(function(){n.PageBuilder.onWindowResize(!1,!1,!0)});$(window).on("popstate",function(r){var o,e,f,u,s;if(i.pagesContainer.length&&r.originalEvent.state){if(e=r.originalEvent.state,e.isPopup){e.commandParam&&n.ForguncyData.commandExcutor.excuteCommand([JSON.parse(e.commandParam)],{runTimePageName:"p",commandTrigger:null,commandID:n.RS.PopupCloseButton,eventType:"click",initParams:JSON.parse((o=e.params)!==null&&o!==void 0?o:"null")});return}if(f=r.originalEvent.state,f.pageName===t.getRootPageName())return;if(u=JSON.parse(f.pageContext),!n.Platform.isIOSDevice()&&(t.tryToCommitActvieElement(),s=n.ForguncyData.pageDirtyCheckManager.shouldCancelByPageDirty(!1,!0,"Window: popstate event"),s)){n.ForguncyData.historyIndex>(u===null||u===void 0?void 0:u.historyIndex)?history.forward():history.back();return}u&&(u.querys=undefined,u.passValues=undefined,u.sortInfoCache=undefined,u.columnFilterQueryCache=undefined,f.pageContext=JSON.stringify(u));n.SessionStorageManager.pageContext=n.Common.JsonUrlSwitch(f.pageContext);n.PageBuilder.loadPage(f.pageName,u);n.SessionStorageManager.pageContext=null;n.Platform.isIOSDevice()&&window.location.reload()}});$(window).on("beforeunload",function(r){var u,f;if(!i.isDownloading)return(t.tryToCommitActvieElement(),u=n.ForguncyData.pageDirtyCheckManager.getDirtyElement(!1,!1),!u)?void 0:(n.ForguncyData.pageDirtyCheckManager.consoleWithNewLog(u,"Window: beforeunload event",null),f=n.RS.LeaveSiteConfirm,r&&(r.returnValue=f),f)});n.DomUtilities.applyPentrableEvent();n.PageZoomHelper.disablePageZoomForMobile()},t.getRootPageName=function(){var t;return((t=n.ForguncyData.pageInfoStack)===null||t===void 0?void 0:t.length)>0?n.ForguncyData.pageInfoStack[0].pageName:n.ForguncyData.pageInfo.pageName},t.tryToCommitActvieElement=function(){var i,t;document.activeElement&&(t=(i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(document.activeElement.id))===null||i===void 0?void 0:i.cellType,(t===null||t===void 0?void 0:t.shouldCheckDirtyWhenLeavePage())&&t.commitValue())},t.OnRowCountChanged=function(){n.RecordNavigationCellType.updateNavigationCellTypeText("currentCountLabel",n.RecordNavigationCellType.updateCurrentCountLabel)},t}(),r,i,t,u;n.GlobalEventManager=f;r=function(){function t(){}return t.isBuiltInPage=function(i){for(var r in n.BuiltInPageType)if(t.builtInPages[r]===i)return!0;return!1},t}();n.BuiltInPageManager=r;i=function(){function i(){}return Object.defineProperty(i,"pagesContainer",{get:function(){return $("#pagesContainer")},enumerable:!1,configurable:!0}),Object.defineProperty(i,"pageCover",{get:function(){return $("#pageCover")},enumerable:!1,configurable:!0}),Object.defineProperty(i,"pageLoadingCover",{get:function(){return $("#pageLoadingCover")},enumerable:!1,configurable:!0}),Object.defineProperty(i,"pageLoadingText",{get:function(){return $("#pageLoadingText")},enumerable:!1,configurable:!0}),i.hidePageLoadingCover=function(){var n;(n=i===null||i===void 0?void 0:i.pageLoadingCover)===null||n===void 0?void 0:n.hide()},i.showPageLoadingCover=function(t){var r,u,f,e,o;(f=(u=(r=n.ForguncyData===null||n.ForguncyData===void 0?void 0:n.ForguncyData.pageInfo)===null||r===void 0?void 0:r.pageElementManager)===null||u===void 0?void 0:u.listviewCollection)===null||f===void 0?void 0:f.loseAllFocus();(e=i===null||i===void 0?void 0:i.pageLoadingCover)===null||e===void 0?void 0:e.css("background-color",t!==null&&t!==void 0?t:this.DefaultLoadingCoverColor);(o=i===null||i===void 0?void 0:i.pageLoadingCover)===null||o===void 0?void 0:o.show()},i.isLoadingConverShow=function(){return i.pageLoadingCover.css("display")!=="none"},i.init=function(){if(n.MetadataLoader.IsInMobileSimulatorFrame()){var i=document.createElement("style");i.innerHTML="\n::-webkit-scrollbar {\n    height: 0px;\n    width: 0px;\n}";document.head.appendChild(i);$("#simpleBarContainer").css("overflow","hidden")}f.initialize();n.MetadataLoader.GetMetaDataResult(function(i){var r=t.createPageMetadata(i);n.PageBuilder.createPage(r,n.Common.getPageContext())})},i.executePageLoadedCommand=function(t,i,r,u,f){if(!n.ForguncyData.commandExcutor){f();return}var o=i&&i.length>0,s=u&&u.length>0,e=function(){n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}).forEach(function(n){return n.cellType.executePageLoadedCommand()});s?n.ForguncyData.commandExcutor.excuteCommand(u,{runTimePageName:r,commandTrigger:null,commandID:r,eventType:"pageloaded",callbackOnCommandCompleted:function(){f()}}):f()};o?n.ForguncyData.commandExcutor.excuteCommand(i,{runTimePageName:t,commandTrigger:null,commandID:t,eventType:"pageloaded",callbackOnCommandCompleted:function(){e()}}):e()},i.loadPage=function(r,u,f){i.pageCover.show();n.Common.initalTimeStamp();n.MetadataLoader.GetMetadataRequest(r,{isSubPage:!1},function(e){var s,o;e&&(o=t.createPageMetadata(e),f&&i.shouldCancelPopup(r,o===null||o===void 0?void 0:o.pageName)&&(n.Common.IsEmpty(o.ReturnUrl)||(o.ReturnUrl=((s=n.ForguncyData.pageInfoStack)===null||s===void 0?void 0:s.length)>0?n.ForguncyData.pageInfoStack[0].pageName:n.ForguncyData.pageInfo.pageName),f=null),n.PageBuilder.createPage(o,u,f))})},i.shouldCancelPopup=function(t,i){return n.Common.IsEmpty(t)||n.Common.IsEmpty(i)||t.toLowerCase()===i.toLowerCase()?!1:r.isBuiltInPage(i)},i.reloadPage=function(){var u=n.ForguncyData.pageInfo.pageName,i=n.Common.getPageContext(),r=n.ForguncyData.pageInfo.pageElementManager.getCurrentPageContext(),t;if(n.MetadataLoader.globalSettingsInited=!1,n.CellTypeStyleTemplateUtils.CellTypeTemplateStyleCache){for(t in n.CellTypeStyleTemplateUtils.CellTypeTemplateStyleCache)n.CellTypeStyleTemplateUtils.PrePageCellTypeTemplateStyleCache[t]=!0;n.CellTypeStyleTemplateUtils.CellTypeTemplateStyleCache={}}if(i)for(t in r)r[t]&&(i[t]=r[t]);else i=r;n.ForguncyData.pageInfoStack=[];n.ForguncyData.pageingInfoList=new n.PageingInfoList;this.loadPage(u,i,null);n.CellTypeStyleTemplateUtils.PrePageCellTypeTemplateStyleCache={}},i.closePopup=function(t,r,u){var h,a,e,c,o,l,f,s,v;for(n.Common.initalTimeStamp(),h=n.ForguncyData.pageInfo.currentRowInfoCollection.list,n.PageBuilder.prepareForShowNewPage(2),a=n.ForguncyData.pageInfoStack,e=a.pop(),n.PageInfo.setCurrentPageInfo(e),n.PageZoomHelper.initPageZoomInfo(),n.ForguncyData.updatePopupCoverVisbility(!1),c=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(),f=0;f<c.length;f++)(o=c[f],o.cellType&&o.cellType.CellElement)&&(l=o.cellType.CellElement.CellType,l&&l.CommandExcuteKind===1&&o.cellType.initValueWhenTriggerValueChangedCommand());for(n.PageBuilder._restoreParentPageElements(i.pagesContainer.find("#centerDiv_"+e.pageID)),n.ListviewBase.onPageCreated(),f=0;f<h.length;f++)n.Common.isPageContainsTableBinding(e.pageName,h[f].currentTable)&&e.currentRowInfoCollection.setCurrentRowInfo(h[f],!1);if(u&&t&&t.querys)for(s in t.querys)n.ForguncyData.pageInfo.commandQuerys[s]!==t.querys[s]&&(n.ForguncyData.pageInfo.commandQuerys[s]=t.querys[s],r=!0);n.NormalCellBindingManager.reloadData(null,r);t&&t.passValues&&(v=t.passValues,n.DelayOperateHelper.Push(null,function(){n.ForguncyData.pageInfo.pageElementManager.initPassedValues(v,!0)},1));n.DelayOperateHelper.Push(null,function(){n.Page._trigger("popupclosed")},1);i.pageCover.hide()},i.getHistoryIndex=function(t){var r,u,i=t===null||t===void 0?void 0:t.historyIndex,f;return n.Common.IsEmpty(i)?(f=(r=history.state)===null||r===void 0?void 0:r.pageContext,n.Common.IsEmpty(f)||(i=(u=JSON.parse(f))===null||u===void 0?void 0:u.historyIndex),!n.Common.IsEmpty(i))?i:history.length:i},i.createPage=function(r,f,e){var w=this,a,o,h,v;if(t.checkError(r)!==!1){if(o=[],r.Modules&&(o=o.concat(r.Modules)),((a=r===null||r===void 0?void 0:r.MasterPage)===null||a===void 0?void 0:a.Modules)&&(o=o.concat(r.MasterPage.Modules)),!n.ModuleLoader.IsModuleLoaded(o)){n.ModuleLoader.LoadModels(o,n.ForguncyData.ForguncyRoot).done(function(){w.createPage(r,f,e)});return}i.pageIsLoading=!0;i.hasCallOnPageLoaded=!1;i.hasExecutePageLoadedCommand=!1;n.ForguncyData.enterHistoryCount=history.length;h=e&&e.isShowAsPopup;h||(n.ForguncyData.historyIndex=this.getHistoryIndex(f));n.PageBuilder.prepareForShowNewPage(h?1:0);var s=n.StaticValues.RunTimeNormalPage,c=n.StaticValues.RunTimeMasterPage,l=3;e&&e.isShowAsPopup&&(l=2,e.popupDisplayMode===4&&(l=3),e.popupDisplayMode===3&&(e.drawerDirection===1||e.drawerDirection===0?l=0:(e.drawerDirection===2||e.drawerDirection===3)&&(l=1)));v=new u(r,n.ForguncyData.pageInfo,s,c,l);v.initForguncyData(h,s);v.setPageInfoByMetadata();var y=n.ForguncyData.pageInfo.pageID,p=function(){i.initDefaultDataAndModels(r,s,c);var u=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().some(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}),t=(e===null||e===void 0?void 0:e.popupDisplayMode)===0;u?n.DelayOperateHelper.Push(null,function(){i.initPageDataAndExecutePageLoadedCommand(r,f,h,s,c,t,y)},1):i.initPageDataAndExecutePageLoadedCommand(r,f,h,s,c,t,y)},b=n.PageBuilder.loadUserJavaScript(r,p);n.PageZoomHelper.initPageZoomInfo();i._createPageElements(r,e,s,c,l);i.onLoad([s,c]);n.ListviewBase.onPageCreated();b&&p();n.HomeController.Operate();$(document).trigger("forguncyPageloaded")}},i.onWindowResize=function(t,r,u){t?n.PageBuilder._reallyResize(r,u):(n.PageBuilder._resizeTimer&&(n.DelayRefresh.clearTimeout(n.PageBuilder._resizeTimer),n.PageBuilder._resizeTimer=null),n.PageBuilder._resizeTimer=n.DelayRefresh.setTimeout(function(){window.requestAnimationFrame(function(){n.PageBuilder._reallyResize(r,u)})},20));i.adjustBackgroundImageSize(!0)},i.adjustBackgroundImageSize=function(n){var f=$("[".concat("FitToBrowserHeight","]")),e=$("[".concat("FitToBrowserWidth","]")),o=$("[".concat("fgc-page-mainpart","]")),t;for(f.css("position","relative"),e.css("position","relative"),t=0;t<f.length;t++){var r=$(f[t]),c=r.offset(),s=r.css("top"),a=s.endsWith("px")?Number(s.substr(0,s.length-2)):0,l=parseFloat(o.css("padding-bottom"));r.css("top",a-c.top);r.css("height",Math.max(i.pagesContainer.height(),o.height(),r.parent().height(),isNaN(l)?0:l))}for(t=0;t<e.length;t++){var u=$(e[t]),c=u.offset(),h=u.css("left"),v=h.endsWith("px")?Number(h.substr(0,h.length-2)):0;u.css("left",v-c.left);u.css("width",Math.max(i.pagesContainer.width(),u.parent().width(),o.width()))}n&&f.length>0&&i.adjustBackgroundImageSize(!1)},i._reallyResize=function(t,i){var r,u;i&&n.ForguncyData.pageInfoStack.forEach(function(t){var i;(t.isPopup||n.PageManager.whetherExistPageStretch(t))&&((i=t===null||t===void 0?void 0:t.pageElementManager)===null||i===void 0?void 0:i.resizePageElements(null,!1))});(t||n.ForguncyData.pageInfo.isPopup||n.PageManager.whetherExistPageStretch(n.ForguncyData.pageInfo))&&((u=(r=n.ForguncyData.pageInfo)===null||r===void 0?void 0:r.pageElementManager)===null||u===void 0?void 0:u.resizePageElements(null,t));n.PageBuilder._resizeTimer=null},i.prepareForShowNewPage=function(t){t===1&&n.ListviewBase.getAllListviews().forEach(function(n){return n.focus(!1)});t!==2&&(n.DelayRefresh.RunNow(),n.ForguncyData.pageInfoStack.push(n.PageInfo.getCurrentPageInfo()));n.ForguncyData.pageDirtyCheckManager.boforePageCreate(t);n.ForguncyData.commandExcutor&&n.ForguncyData.commandExcutor.init();n.ForguncyData.pageInfo.pageID&&n.ListviewBase.onPageDestroyed();t===2&&i._destroyOldPageElements(n.ForguncyData.pageInfo);i.clearForguncyData();n.Page._init();n.DelayRefresh.Init()},i.clearForguncyData=function(){n.ForguncyData.pageInfo.pageElementManager&&(n.ForguncyData.pageInfo.pageElementManager=undefined);n.ForguncyData.pageInfo.formulaManager&&(n.ForguncyData.pageInfo.formulaManager.destroy(),n.ForguncyData.pageInfo.formulaManager=undefined);n.ForguncyData.pageInfo.commandQuerys={};n.ForguncyData.pageInfo.sortInfoCache={};n.ForguncyData.pageInfo.columnFilterQueryCache={};n.ForguncyData.pageInfo.dataModel=new n.DataModel},i._destroyOldPageElements=function(n){n&&n.pageElementManager&&(n.releaseDialog(),n.pageElementManager.destroy())},i._changeParentPageElements=function(n){n.length!==0&&(i._changeElementIdAndName(n),i._recoverySvgElementId(n),i._changeElementAttr(n,"fgcname","fgcname_temp",!1,null),i._changeElementAttr(n,"tabindex","tabindex_temp",!1,-1))},i._recoverySvgElementId=function(n){for(var i,r=n.find("svg").find("[id_temp]"),t=0;t<r.length;t++)i=r[t],i.id=i.getAttribute("id_temp")},i._changeElementIdAndName=function(n){for(var t,r=n.find("[id]"),u=r.length,i=0;i<u;i++)t=$(r[i]),t.attr("id_temp",t.attr("id")),t.attr("name_temp",t.attr("name")),t.attr("id",null),t.attr("name",null)},i._changeElementAttr=function(n,t,i,r,u){for(var f,o=n.find("["+t+"]"),s=o.length,e=0;e<s;e++)f=$(o[e]),f.attr(i,f.attr(t)),r?f.removeAttr(t):f.attr(t,u)},i._restoreParentPageElements=function(n){var u,f,r,t;if(n.length!==0){for(u=n.find("[id_temp]"),f=u.length,r=0;r<f;r++)t=$(u[r]),t.attr("id",t.attr("id_temp")),t.attr("name",t.attr("name_temp")),t.attr("id_temp",null),t.attr("name_temp",null);i._changeElementAttr(n,"fgcname_temp","fgcname",!1,null);i._changeElementAttr(n,"tabindex_temp","tabindex",!0,null)}},i._createPageElements=function(t,r,u,f,e){var l=i.pagesContainer,y=n.ForguncyData.pageInfoStack,p=y.length,w,b,o,k,c,a,v,h;p>0&&(w=y[p-1].pageID,n.PageBuilder._changeParentPageElements(l.find("#centerDiv_"+w)));b=n.ForguncyData.pageInfo.pageID;o=$(document.createElement("form")).attr({method:"post",id:"".concat("pageWrapper_"+b)});o.addClass("fgc-page-wrapper");o.submit(function(){return!1});r&&r.isShowAsPopup?(k=t.PageSettings.Title,c=n.PopupHelper.createPopupDom(l,o,k,r),c.target.opacity=0,c.zIndex=n.ForguncyData.pageInfoStack.length,n.ForguncyData.pageInfo.dialogUI=c,n.ForguncyData.pageInfo.dialogUI.target.show()):(o.css("z-index",n.ForguncyData.pageInfoStack.length),o.css("opacity","0"),o.addClass("fgc-container-absolute"),l.append(o));n.ForguncyData.pageInfo.normalCellBindingManager=new n.NormalCellBindingManager(n.ForguncyData.pageInfo.dataModel.normalCellDataModel);n.PageBuilder.initalPageElementManager();var d=i.createPageContent(t,u,f,r&&r.isShowAsPopup,e),tt=t.MasterPage?f:u,g=n.PageManager.getPageStretchInfo(tt);if(i.updatePageWrapperLayout(o,d,g,t),o.append(d),o.append($(document.createElement("input")).css("display","none")),a=t.TrailMessage,!a||r&&r.isShowAsPopup||(n.RS.Culture==="CN"?o.append("<a href='https://www.grapecity.com.cn/solutions/huozige?utm_source=exe&utm_medium=huozige' target='_blank' style='color:black; text-decoration: none;'><div style='display:flex; align-items:center; justify-content: center; text-align: center; background-color:#F1F3F4; font-size:12px; position:fixed; bottom:0; width:100%; height:30px;'><img src='"+n.ForguncyData.ForguncyRoot+"Resources/Images/SiteBuiltInImages/huozigeLogo.png' width='16' height='16' /><span style='margin-left:5px;'>本系统由活字格免费版开发<\/span><\/div><\/a>"):n.RS.Culture==="EN"?o.append("<a href='https://www.forguncy.net/' target='_blank' style='color:black; text-decoration: none;'><div style='display:flex; align-items:center; justify-content: center; text-align: center; background-color:#F1F3F4; font-size:12px; position:fixed; bottom:0; width:100%; height:30px; font-family: Calibri'><span style='margin-left:5px;'>This application is running on an unlicensed Forguncy server. Visit www.forguncy.net to purchase the server license.<\/span><\/div><\/a>"):(v=$("<div style='color:red;text-align: center;position:relative;z-index:1000'>"+a+"<div>"),g.StretchMode!==4&&n.Presentation.GridRender.renderElement(v[0],{rowStart:1,rowEnd:2,columnStart:2,columnEnd:3}),o.prepend(v))),n.ForguncyData.forceMobileChild&&!(r&&r.isShowAsPopup)){var nt=327,s=nt/o.children().width();s>1&&(s=1);h=$("#fgc-mobile-iframe",window.parent.document);h.css("transform","scale("+s+")");h.css("transform-origin","left top");h.width(nt/s);h.height(582/s)}},i.createPageContent=function(t,i,r,u,f){var e=n.Presentation.PageContentCreator.create(t,i,r,u?1:0,f);return e.attr("id","centerDiv_"+n.ForguncyData.pageInfo.pageID),e.attr("fgc-page-mainpart","true"),e},i.updatePageWrapperLayout=function(t,i,r,u){var f;if(r.StretchMode!==4){f=new n.Presentation.Grid;f.rows=["auto","1fr"];var o=(u.MasterPage||u).PageSettings,s=o.ColumnDefinitions.some(function(n){return n.Mode===2}),h=n.Presentation.StretchCommon.canHorizontallyStretch(r.StretchMode)||s,e=h?"100%":"auto";switch(n.ForguncyData.GlobalSettings.MainPageHorizontalAlignment){case 1:f.columns=["1fr",e,"1fr"];break;case 2:f.columns=["1fr",e,"0"];break;default:f.columns=["0",e,"1fr"]}n.Presentation.GridRender.renderContainer(t[0],f);n.Presentation.GridRender.renderElement(i[0],{rowStart:2,rowEnd:3,columnStart:2,columnEnd:3})}},i.onLoad=function(t){var r=n.ListviewBase.getAllListviews(t),i;r.forEach(function(n){return n.onLoad()});i=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t);i.forEach(function(n){return n.onLoad()})},i.onPageLoaded=function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(t);i.forEach(function(n){return n.onPageLoaded()})},i.initDefaultDataAndModels=function(t,i,r,u){var f=[i,r];n.ForguncyData.pageInfo.autoIDManager.cacheFieldCells();n.ForguncyData.pageInfo.pageElementManager.initCellDefaultValue(f);n.ForguncyData.pageInfo.autoIDManager.initAutoGeneratedID(f);n.ForguncyData.pageInfo.formulaManager.init(t,n.ForguncyData.pageInfo.dataModel,i,r);n.ForguncyData.pageInfo.defaultFormulaManager.setDefaultFormula(f);n.ForguncyData.pageInfo.pageElementManager.initUserControlDefaultValues(u);n.ForguncyData.pageInfo.pageElementManager.onDefaultDataSetted(f)},i.initPageDataAndExecutePageLoadedCommand=function(t,r,u,f,e,o,s){var h,c,l;n.Page._trigger("loaded");i.hasCallOnPageLoaded=!0;i.onPageLoaded();n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().filter(function(t){return t.cellType instanceof n.SubPageContainerCellTypeBase}).forEach(function(n){return n.cellType.triggerPageLoadedEvent()});n.ForguncyData.pageInfo.pageElementManager.setPrePageContext(r);this.fillAllListviewData();n.DelayOperateHelper.Push(null,function(){if(r&&r.passValues){var t=r.passValues;n.ForguncyData.pageInfo.pageElementManager.initPassedValues(t,!1)}u||n.ForguncyData.pageInfo.pageElementManager.initPluginPassValue()},1);l=n.ForguncyData.pageInfoStack;u||(n.Page._clearState(),n.ForguncyData.pageInfoStack=[]);i.hasExecutePageLoadedCommand=!0;i.executePageLoadedCommand(e,(c=(h=t.masterPageMetaDataObj)===null||h===void 0?void 0:h.PageSettings)===null||c===void 0?void 0:c.PageLoadedCommandList,f,t.PageSettings.PageLoadedCommandList,function(){n.DelayOperateHelper.Push(null,function(){n.DelayRefresh.Push(null,function(){n.ForguncyData.pageInfo.defaultFormulaManager.clearDefaultFormula([f,e])},"clearDefaultFormula"+f);i.showNewPage(t,u,s,l,o);i.pageIsLoading=!1},1)});$(document).trigger("initPageData")},i.fillAllListviewData=function(t){var i=n.ListviewBase.getAllListviews(t);i.forEach(function(n){n.listviewData.getDoNotLoadDataWhenLoadPage()?(n.clearCurrentRow(),n.getEditorInfo(!0)):n.fillData(null,!0)})},i.showNewPage=function(t,r,u,f,e){e===void 0&&(e=!1);n.DelayRefresh.Push(null,function(){if(u===n.ForguncyData.pageInfo.pageID||n.ForguncyData.pageInfoStack.some(function(n){return n.pageID===u})){i.hidePageLoadingCover();i.pageCover.hide();r||i.prepareShowNewPageDivContainer(u,f,t.PageSettings.Title);n.Page._trigger("pagedefaultdataloaded");n.PageBuilder.onWindowResize(!0,!1,!1);if(n.ForguncyData.pageDirtyCheckManager.onPageLoaded(),r){if(e){var o=n.ForguncyData.pageInfo.dialogUI;o===null||o===void 0?void 0:o.setPopupDialogLocation(o.target)}i.showNewPopupDivContainer(u)}else i.showNewPageDivContainer(u);i.showSimplebarInSimulator()}},"showNewPage"+u)},i.prepareShowNewPageDivContainer=function(n,t,r){for(var e,f,o=t.length,u=0;u<o;u++)i._destroyOldPageElements(t[u]);for(document.title=r,i.onDocumentTitleChanged(),e="pageWrapper_"+n,$("#"+e).css("z-index","0"),f=i.pagesContainer.children(),u=0;u<f.length-1;u++){if(f[u].id===e)break;$(f[u]).remove()}window.scrollTo(0,0)},i.showNewPopupDivContainer=function(t){n.ForguncyData.updatePopupCoverVisbility(!0);var i=n.ForguncyData.pageInfoStack.filter(function(n){return n.pageID===t});i&&i.length>0?i[0].dialogUI.target.opacity=1:n.ForguncyData.pageInfo.dialogUI.target.opacity=1},i.showNewPageDivContainer=function(n){var t="pageWrapper_"+n;$("#"+t).css("opacity","")},i.showSimplebarInSimulator=function(){if(n.MetadataLoader.IsInMobileSimulatorFrame()){var t=$("#simpleBarContainer");t.css("overflow")==="hidden"&&(new SimpleBar(t[0]),t.css("overflow","auto"))}},i.onDocumentTitleChanged=function(){if(window!==window.top)try{window.parent.location.origin===location.origin&&window.parent.postMessage({type:"TITLE CHANGED",message:{title:window.document.title,url:window.location.href,uid:window.name}},window.location.origin)}catch(n){}},i.loadUserJavaScript=function(t,i){var u,f,r;return n.Common.IsEmpty(t.PageSettings.Script)?!0:(u="userScript_"+t.PageSettings.Name,document.getElementById(u))?!0:(f=document.getElementsByTagName("head")[0],r=document.createElement("script"),r.setAttribute("type","text/javascript"),r.setAttribute("id",u),r.setAttribute("src",n.Common.format("{0}GeneratedResources/UserJavaScript/{1}?v={2}",n.ForguncyData.ForguncyRoot,t.PageSettings.Script,n.StaticData.MetaDataVersion)),r.readyState==="loaded")?(f.appendChild(r),!0):(r.onload=r.onreadystatechange=function(){r.ready||r.readyState&&r.readyState!=="loaded"&&r.readyState!=="complete"||(r.ready=!0,i())},f.appendChild(r),!1)},i.initalPageElementManager=function(){n.ForguncyData.pageInfo.currentRowInfoCollection=new n.CurrentRowInfoCollection(n.ForguncyData.pageInfo.normalCellBindingManager);var t=new n.PageElementManager(n.ForguncyData.pageInfo.currentRowInfoCollection,n.ForguncyData.pageInfo.dataModel);n.ForguncyData.pageInfo.pageElementManager=t},i.DefaultLoadingCoverColor="rgba(255, 255, 255, 0.70)",i.pageIsLoading=!1,i.hasCallOnPageLoaded=!1,i.hasExecutePageLoadedCommand=!1,i.isDownloading=!1,i._resizeTimer=null,i}();n.PageBuilder=i;t=function(){function t(){}return t.checkError=function(t){var r=t?t.ErrorMessage:"",u,f;return r==="UserLoginedInOtherPlace"?(n.ForguncyData&&n.ForguncyData.userInfo&&n.ForguncyData.userInfo.UserName&&alert(n.Common.format("账号{0}已经在其他计算机上登录",n.ForguncyData.userInfo.UserName)),location.reload(),!1):r==="YouHaveBeKickoffed"?(alert(n.RS.ConcurrentLicenseError_Kickoffed),i.hidePageLoadingCover(),!1):(r&&r.indexOf("1C3E7540-99F6-4BE2-9654-47BE0FB82280")!==-1&&(location.href=n.ForguncyData.ForguncyRoot+r),r&&r.indexOf("DoNotHaveEnoughConcurrencyLicense")===0)?(u=r.split("|"),f="",u.length>=2&&(f=u[1]),n.SendEmailHelper.appendSendEmailConfirm({email:f}),!1):!0},t.createPageMetadata=function(i){var f,e,r,u;return typeof i=="string"?{ErrorMessage:i}:(r=i,r.globalSettings&&(n.ForguncyData.initGlobalSettings(r.globalSettings),t.applyGlobalFontFamilyAndTextColor((e=(f=n.ForguncyData.GlobalSettings)===null||f===void 0?void 0:f.ThemeFont)!==null&&e!==void 0?e:""),t.applyGlobalCSSColorVariables()),u=r.metaDataObj,u.MasterPage=r.masterPageMetaDataObj,u=__assign(__assign({},r),u),t.preProcess(u),u)},t.preProcess=function(i){this.updateMasterPageRowDefinition(i);this.updateMetadataOverflowCellBackgrounds(i);this.updateMetadataOverflowCellBackgrounds(i.MasterPage);t.referStyles(i);t.referStyles(i.MasterPage);n.CellTypeStyleTemplateUtils.PrepareTemplateStyles(n.ForguncyData.GlobalSettings.CellTypeStyleTemplates);n.ListViewStyleTemplateUtils.ListViewStyleTemplates=n.ForguncyData.GlobalSettings.ListViewTemplates},t.updateMetadataOverflowCellBackgrounds=function(t){t&&(t.OverflowCellBackgrounds=t.Cells.map(function(t){return n.OverflowHelper.needAdjustDom(t)?{Layout:n.Common.clone(t.Layout)}:null}).filter(function(n){return n!==null}))},t.updateMasterPageRowDefinition=function(n){var r,t,u,i,e,f;if(n.MasterPage&&(r=n.PageSettings.Height,t=n.MasterPage.PlaceHolders[0],t&&t.Height<r)){for(u=!1,i=0;i<t.Layout.RowSpan;i++)if(e=t.Layout.Row+i,f=n.MasterPage.PageSettings.RowDefinitions[e],f.Mode===1||f.Mode===2){u=!0;break}if(!u){var s=t.Layout.Row+t.Layout.RowSpan-1,h=n.MasterPage.PageSettings.RowDefinitions[s],o=r-t.Height;h.DesignLengthInPixel+=o;n.MasterPage.PageSettings.Height+=o}}},t.getDefaultFonts=function(t){return t=t!==null&&t!==void 0?t:n.LocaleFonts[n.RS.Culture],n.RS.Culture==="CN"?'"'.concat(t,'","PingFangSC","Helvetica neue","Hiragino sans gb","Arial","Microsoft YaHei UI","Microsoft YaHei","SimSun","sans-serif"'):n.RS.Culture==="JA"?'"'.concat(t,'","Meiryo","ヒラギノ角ゴ Pro W3","Hiragino Kaku Gothic Pro","ＭＳ Ｐゴシック","Arial","sans-serif"'):n.RS.Culture==="KR"?'"'.concat(t,'","Malgun Gothic","돋움","Dotum","Helvetica Neue","Helvetica","Arial","sans-serif"'):'"'.concat(t,'","Calibri","Segoe UI","Arial","sans-serif"')},t.applyGlobalFontFamilyAndTextColor=function(i){if(!t.isGlobalFontFamilyExisted){t.isGlobalFontFamilyExisted=!0;var r=t.getDefaultFonts(i),u=n.ColorHelper.Convert("Text 1");$(document.head).append($("<style>html {font-family: ".concat(r,"; color:").concat(u,";}<\/style>")))}},t.applyGlobalCSSColorVariables=function(){var t=document.createElement("style");t.type="text/css";t.id="FGC_CSS_Color_Variables";t.innerHTML="\n                :root {\n                  ".concat("--FGC_Accent1",": ").concat(n.ColorHelper.GetThemeColor("Accent 1"),";\n                  ").concat("--FGC_ButtonPrimary",": ").concat(n.ColorHelper.GetThemeColor("Accent 1"),";\n                  ").concat("--FGC_ButtonHover",": ").concat(n.ColorHelper.GetThemeColor("Accent 1 20"),";\n                  ").concat("--FGC_ButtonActive",": ").concat(n.ColorHelper.GetThemeColor("Accent 1 -20"),";\n                  ").concat("--FGC_Accent1_RGB_Number",": ").concat(n.ColorHelper.GetRGBNumberString("Accent 1"),";\n                  ").concat("--FGC_ButtonPrimary_RGB_Number",": ").concat(n.ColorHelper.GetRGBNumberString("Accent 1"),";\n                  ").concat("--FGC_ButtonHover_RGB_Number",": ").concat(n.ColorHelper.GetRGBNumberString("Accent 1 20"),";\n                  ").concat("--FGC_ButtonActive_RGB_Number",": ").concat(n.ColorHelper.GetRGBNumberString("Accent 1 -20"),";\n                }");document.getElementsByTagName("head")[0].appendChild(t)},t.referStyles=function(i){var u,r;if(i)for(u=0;u<i.Cells.length;u++)r=i.Cells[u],r.StyleIndex>=0&&(r.StyleInfo=n.Common.clone(i.StyleMetaDatas[r.StyleIndex])),t.referStyleTemplateMetadata(r,n.ForguncyData.GlobalSettings.CellTypeStyleTemplates)},t.referStyleTemplateMetadata=function(t,i){if(t.CellType&&t.CellType.TemplateKey){var r=t.CellType.$type.split(",")[0],u=t.CellType.TemplateKey;t.StyleTemplate=n.CellTypeStyleTemplateUtils.GetStyleTemplateByKey(r,u,i)}},t.getPageStretchInfo=function(t,i){var r={StretchMode:0},u;return i===2?r:n.Common.IsEmpty(t)?r:(u=t.PageSettings,r.StretchMode=n.Presentation.StretchCommon.getStretchMode(u.PageResponsiveMode,i),r)},t}();n.MetadataHelper=t;u=function(){function i(n,t,i,r,u){this.pageMetadata=n;this.pageInfo=t;this.runTimeNormalPageName=i;this.runTimeMasterPageName=r;this.drawerFitContent=u}return i.prototype.initForguncyData=function(t,i){var r=this.pageMetadata;n.ForguncyData.userInfo=new n.UserInfoImp;n.ForguncyData.userInfo.UserName=r.storageUserName?r.storageUserName:"";n.ForguncyData.userInfo.FullName=r.fullName?r.fullName:"";n.ForguncyData.userInfo.HasPicture=r.hasPicture?r.hasPicture:!1;n.ForguncyData.userInfo.Email=r.email?r.email:"";n.ForguncyData.userInfo.Role=r.role;n.ForguncyData.AllowLogout=r.allowLogout;n.ForguncyData.AutoDisconnectTimeout=r.autoDisconnectTimeout;n.ForguncyData.EnableSession=r.enableSession;n.ForguncyData.IsConcurrenyUserLicense=r.isConcurrenyUserLicense;n.ForguncyData.AllowUserChangeMFAStatus=r.allowUserChangeMFAStatus;this.initPageInfo(t,i)},i.prototype.initPageInfo=function(t,i){var r=this.pageInfo,u=this.pageMetadata;r.pageName=u.PageSettings.Name;r.masterPageName=u.MasterPage?u.MasterPage.PageSettings.Name:"";r.enableTabIndex=r.enableTabIndex||{};u.PageSettings.EnableTabIndex&&(r.enableTabIndex[i]=u.PageSettings.EnableTabIndex);r.moveFocusByEnter=n.ForguncyData.GlobalSettings.MoveFocusByEnter;r.pageID=n.Common.getUniqueNumber();r.ViewInfoList=[];r.PrimaryTableForeignKeyInfo={};r.ReturnUrl=n.Common.IsEmpty(u.ReturnUrl)?null:u.ReturnUrl;r.noPermissionPage=n.Common.IsEmpty(u.noPermissionPage)?null:u.noPermissionPage;r.formulaManager=new n.FormulaManager(n.ForguncyData.pageInfo.dataModel);r.defaultFormulaManager=new n.DefaultFormulaManager;r.dependenceCellValueChangedEventHandlers={};r.pageStretchInfos={};r.pageLayouts={};r.isPopup=t;r.autoIDManager=new n.AutoIDManager;r.extraDialogCount=0;r.allowZoomScreen=!n.Platform.isMobile()||u.AllowZoomScreen},i.prototype.setPageInfoByMetadata=function(){this.pageInfo.autoIDManager.setAutoGeneratedIDsFromMetaData(this.pageMetadata.autoGeneratedIDs);this._setPageStretchInfos();this._setViewInfoList();this._setPrimaryTableForeignKeyInfo();n.ForguncyData.pageDirtyCheckManager.setDirtyInfoFromMetaData(this.pageMetadata)},i.prototype._setPageStretchInfos=function(){this.pageInfo.pageStretchInfos||(this.pageInfo.pageStretchInfos={});this.pageInfo.pageStretchInfos[this.runTimeNormalPageName]=t.getPageStretchInfo(this.pageMetadata,this.drawerFitContent);this.pageInfo.pageStretchInfos[this.runTimeMasterPageName]=t.getPageStretchInfo(this.pageMetadata.MasterPage,this.drawerFitContent)},i.prototype._setViewInfoList=function(){var n=this.pageMetadata.ViewInfoList,t;this.pageMetadata.MasterPage&&(n=n.concat(this.pageMetadata.MasterPage.ViewInfoList));t=this.pageInfo.ViewInfoList;n.forEach(function(n){t.some(function(t){return t.ViewName===n.ViewName})||t.push(n)})},i.prototype._setPrimaryTableForeignKeyInfo=function(){var n=__assign(__assign({},this.pageInfo.PrimaryTableForeignKeyInfo),this.pageMetadata.PrimaryTableForeignKeyInfo);this.pageMetadata.MasterPage&&(n=__assign(__assign({},n),this.pageMetadata.MasterPage.PrimaryTableForeignKeyInfo));this.pageInfo.PrimaryTableForeignKeyInfo=n},i}();n.ForguncyDataSetter=u})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var u,f,y=function(){function i(){}return i.create=function(n,t,i,r,u,f){return u===void 0&&(u=2),f===void 0&&(f=null),n.MasterPage?this.createPagePartDiv(n.MasterPage,n,i,t,r,u,f):this.createPagePartDiv(n,null,t,t,r,u,f)},i.createPagePartDiv=function(i,r,u,f,e,o,s){var p=this,h=n.DomUtilities.createJqueryDomElement("div"),a,v,l;h.css("position","relative");h.addClass("fgc-page-container");h.attr("fgc-page-name",i.pageName);n.ForguncyData.GlobalSettings.IsPageInContainerBackgroundHardCodeWhite&&h.css("background-color","white");var y=n.PageManager.getPageStretchInfo(u),w=e===2?0:y.StretchMode,c=t.StretchLayout.adjustMainDiv(h,w,i,e);return c.addClass("fgc-page-elements-container"),a=$(document.createElement("div")).attr("fgc-border-spliter-start","").css("display","none"),v=$(document.createElement("div")).attr("fgc-border-spliter-end","").css("display","none"),c.append(a),c.append(v),l=new t.PageLayout(c,i,y,e,o),n.ForguncyData.pageInfo.pageLayouts[u]=l,l.createElementHanlder=function(n,t){var o=p.createUIElement(n,i,r,u,f,t,e,s);n.runtimeContainer=o;t<6?o.insertBefore(a):t===6?o.insertBefore(v):c.append(o)},l.generateElements(),l.locateElements(),h},i.createUIElement=function(n,t,i,u,f,y,p,w){var b,d=(b={},b[0]=s,b[1]=h,b[2]=c,b[3]=e,b[4]=l,b[5]=o,b[6]=a,b[7]=v,b[8]=r,b),g=d[y],k=new g(n,t,i,u,f,p);return k instanceof o&&k.setContainerInfo(w),k instanceof e&&k.setContainerInfo(w),k.create()},i}(),i,s,h,c,e,l,o,a,v,r;t.PageContentCreator=y;i=function(){function t(t,i,r,u,f,e){this.element=t;this.pageMetadata=i;this.placeholderContent=r;this.runTimePageName=u;this.runTimePlaceholderPageName=f;this.pageContentType=e;this.pageStretchInfo=n.PageManager.getPageStretchInfo(u)}return t.prototype.create=function(){var i,t=n.DomUtilities.createJqueryDomElement("div"),u={},r;return this.createInternal(t,u),r=(i=this.innerContainer)!==null&&i!==void 0?i:t,this.name&&r.attr("fgcname",this.name),this.cssName&&r.addClass(this.cssName),this.clickable()||t.addClass("fgc-penetrable"),t.addClass(n.CSSHelper.getClassName(u)),t},t.prototype.clickable=function(){return!1},t.prototype.createInternal=function(){},t}();t.PageElementPresenter=i;s=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.clickable=function(){var n;return((n=this.element.CommandList)===null||n===void 0?void 0:n.length)>0},i.prototype.createInternal=function(n,t){r.setImageContainerStyle(t,this.element);this.createBackgroundImage(n,this.element,this.pageContentType,this.runTimePageName)},i.prototype.createBackgroundImage=function(t,i,u,f){var s,o,e,h,c;if(t.attr("fgc-gui","isBgImg"),i.DisplayName&&t.attr("fgc-gui-bgname",i.DisplayName),o=n.DomUtilities.createJqueryDomElement("div"),e={flex:"1"},i.FitToBrowserHeight&&u===0&&t.attr("FitToBrowserHeight","true"),i.FitToBrowserWidth&&u===0&&t.attr("FitToBrowserWidth","true"),h=i.ImageSrc||i.PictureName,r.setBackground(t,e,i),r.applyBackgroundLayoutProperties(e,i.Repeat,i.Stretch),h&&r.applyImageSource(this.element,e),((s=i.CommandList)===null||s===void 0?void 0:s.length)>0){t.addClass("fgc-clickHandler");t.on("click",r.getImageClickFunction(i,f))}o.addClass(n.CSSHelper.getClassName(e));t.append(o);c=n.ForguncyData.pageInfo.pageElementManager.backgroundImages.addBackgroundImage(new n.BackgroundImageItem(f,this.pageMetadata.PageSettings.Name,n.ForguncyData.pageInfo.pageID,o,i));t.attr("id",c)},i}(i);t.BackgroundImageElementPresenter=s;h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createInternal=function(n){this.createBackground(n,this.element)},i.prototype.createBackground=function(t,i){t.css("background-color",n.ColorHelper.Convert(i.Color))},i}(i);t.BackgroundElementPresenter=h;c=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createInternal=function(n){this.createOverflowCellBackground(n,this.element,this.runTimePageName)},i.prototype.createOverflowCellBackground=function(t,i,r){var u=n.Common.getIdStr(this.element.Layout.Row,i.Layout.Column,r);t.attr("id",u+"_backgrounddiv")},i}(i);t.OverflowCellBackgroundElementPresenter=c;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.clickable=function(){return!0},i.prototype.createInternal=function(n){this.createPlaceHolder(n,this.placeholderContent)},i.prototype.createPlaceHolder=function(t,i){var r,u,f;t.attr("id","placeHolderDiv");r=n.PageManager.getPageLayout(this.runTimePageName);u=r.possibleStretch(this.element.Layout);u?(t.css("overflow-x","auto"),t.css("overflow-y","auto")):i.PageOverflowMode===2?t.css("overflow-x","hidden"):i.PageOverflowMode===1&&t.css("overflow-x","auto");f=y.createPagePartDiv(i,null,this.runTimePlaceholderPageName,this.runTimePlaceholderPageName,3,2,this._containerInfo);this.element.BackgroundColor&&t.css("background-color",n.ColorHelper.Convert(this.element.BackgroundColor));t.append(f)},i.prototype.setContainerInfo=function(n){this._containerInfo=n},i}(i);t.PlaceHolderElementPresenter=e;l=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.clickable=function(){return!0},i.prototype.createInternal=function(n){this.name=this.element.Data.Name;this.createListView(n,this.element,this.runTimePageName,this.pageMetadata.PageSettings.Name)},i.prototype.createListView=function(t,i,r,u){var s=i.Width>0&&i.Height>0,e,h,o;s||t.css("display","none");n.ListviewMetadataHelper.resolve(i.Data);var c=n.ListviewBase.getLocationString(r,i.Data.Name),l=n.ListviewMetadataHelper.restore(c)||i.Data,f=new n.ListviewData(l,i.Layout,r,u);t.attr("id",f.name);t.attr("fgc-uielement","listview");e=n.ForguncyData.pageInfo.pageElementManager.listviewCollection;h=s?e.addSpreadJSView(t[0],f,r,u):e.addHiddenListview(t[0],f,r,u);o=h.getRangeInfo();t.attr(n.StaticValues.InnerID,n.Common.getIdStr(o.Row,o.Column,r))},i}(i);t.ListViewElementPresenter=l;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.clickable=function(){return!0},i.prototype.createInternal=function(n,t){this.name=this.getNormalCellFgcName(this.element);this.cssName=this.element.CssClassName;var i=this.createCell(n,this.element,this.pageStretchInfo,this.runTimePageName,t);this.cell=i},i.prototype.getNormalCellFgcName=function(t){var i,r;return((r=(i=this._containerInfo)===null||i===void 0?void 0:i.ownerCell)===null||r===void 0?void 0:r.cellType)instanceof n.UserControlPageCellType?(t.Name&&t.Name.length)>0?t.Name[0]:null:n.Common.IsEmpty(t.TemplateCellSource)?(t.Name&&t.Name.length)>0?t.Name[0]:null:t.TemplateCellSource},i.prototype.createCell=function(t,i,r,u){var o=n.Common.getIdStr(i.Row,i.Column,u),f,s,e,h;return t.attr("id",o+"_outerdiv"),f=$(document.createElement("div")),s={},f.attr("id",o+"_div"),f.attr(n.StaticValues.InnerID,o),t.append(f),e=new n.NormalCell(i,0,o,u,this.pageMetadata.PageSettings.Name),e.setContainerInfo(this._containerInfo),n.ForguncyData.pageInfo.pageElementManager.cells.addCell(e),e.create(f),s.width="100%",s.height="100%",h=n.CSSHelper.getClassName(s),h&&f.addClass(h),this.innerContainer=f,e},i.createCell=function(t,i,r){var o=n.StaticData.CellTypeStyleTemplates,e,u,f;return n.MetadataHelper.referStyleTemplateMetadata(i,o),e="p",u=n.Common.getIdStr(i.Row,i.Column,e),t.attr("id",u+"_div"),t.attr(n.StaticValues.InnerID,u),f=new n.NormalCell(i,0,u,e,r),n.ForguncyData.pageInfo.pageElementManager.cells.addCell(f),f.create(t),f},i.prototype.setContainerInfo=function(n){this._containerInfo=n},i}(i);t.CellContentElementPresenter=o;a=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createInternal=function(n,t){this.createBorder(n,t,this.element)},i.prototype.createBorder=function(t,r,u){var o,s,e=u.Layout,f=this.pageMetadata.BorderStyles[u.StyleIndex],c=i.borderPositionMap[(o=u.Position)!==null&&o!==void 0?o:0],l=f.BorderWidth+"px ",a=i.borderStyleMap[(s=f.Style)!==null&&s!==void 0?s:2],v=n.ColorHelper.Convert(f.Color),h;r.pointerEvents="none";r[c]="".concat(l," ").concat(a," ").concat(v);u.Position===0?(u.topSpace&&(r.top=-u.topSpace/2+"px"),u.bottomSpace&&(r.bottom=-u.bottomSpace/2+"px"),r.left=-f.BorderWidth/2+"px",u.topSpace+u.bottomSpace&&(r.height="calc(100% + ".concat((u.topSpace+u.bottomSpace)/2,"px)"))):u.Position===1?(u.leftSpace&&(r.left=-u.leftSpace/2+"px"),u.rightSpace&&(r.right=-u.rightSpace/2+"px"),r.top=-f.BorderWidth/2+"px",u.leftSpace+u.rightSpace&&(r.width="calc(100% + ".concat((u.leftSpace+u.rightSpace)/2,"px)"))):u.Position===2?(u.topSpace&&(r.top=-u.topSpace/2+"px"),u.bottomSpace&&(r.bottom=-u.bottomSpace/2+"px"),r.right=-f.BorderWidth/2+"px",u.topSpace+u.bottomSpace&&(r.height="calc(100% + ".concat((u.topSpace+u.bottomSpace)/2,"px)"))):u.Position===3&&(u.leftSpace&&(r.left=-u.leftSpace/2+"px"),u.rightSpace&&(r.right=-u.rightSpace/2+"px"),r.bottom=-f.BorderWidth/2+"px",u.leftSpace+u.rightSpace&&(r.width="calc(100% + ".concat((u.leftSpace+u.rightSpace)/2,"px)")));r.position="absolute";t.attr("isborder",!0);h="".concat(this.runTimePageName,"-").concat(e.Row,"-").concat(e.RowSpan,"-").concat(e.Column,"-").concat(e.ColumnSpan);t.addClass(h)},i.borderStyleMap=(u={},u[0]="dotted",u[1]="dashed",u[2]="solid",u[3]="double",u),i.borderPositionMap=(f={},f[0]="border-left",f[1]="border-top",f[2]="border-right",f[3]="border-bottom",f),i}(i);t.BorderElementPresenter=a;v=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.clickable=function(){var n,t;return((t=(n=this.element.ChartCommandMetadata)===null||n===void 0?void 0:n.Commands)===null||t===void 0?void 0:t.length)>0},i.prototype.createInternal=function(n){this.createChart(n,this.element,this.runTimePageName)},i.prototype.createChart=function(t,i,r){var u=n.ForguncyData.pageInfo.pageElementManager.chartCollection.createChart(i,r);t.append(u)},i}(i);t.ChartElementPresenter=v;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.clickable=function(){var n;return((n=this.element.CommandList)===null||n===void 0?void 0:n.length)>0},i.prototype.createInternal=function(n,t){i.setImageContainerStyle(t,this.element);this.createImage(n,this.element,this.runTimePageName)},i.prototype.createImage=function(t,r,u){var e,o,f;if(t.attr("fgc-gui","isImg"),o=n.DomUtilities.createJqueryDomElement("div"),f={flexGrow:"1"},i.setBackground(t,f,r),(r.ImageSrc||r.PictureName)&&(i.applyImageSource(this.element,f),i.applyBackgroundLayoutProperties(f,!1,2)),((e=r.CommandList)===null||e===void 0?void 0:e.length)>0){t.addClass("fgc-clickHandler");t.on("click",i.getImageClickFunction(r,u))}o.addClass(n.CSSHelper.getClassName(f));t.append(o)},i.getImageClickFunction=function(t,i){return function(){var r;n.ForguncyData.commandExcutor.excuteCommand(t.CommandList,{runTimePageName:i,commandTrigger:null,commandID:((r=t.DisplayName)!==null&&r!==void 0?r:t.PictureName)+"_"+i,eventType:"click"})}},i.applyImageSource=function(t,r){var u=i.getImageUrl(t),f=n.ImageHelper.encodeImageUrl(u),e=n.Helper.preProcessImageSrc(f);r.backgroundImage='url("'+e+'")';r.fontSize="0"},i.applyBackgroundLayoutProperties=function(n,t,i){if(t)n.backgroundSize="auto",n.backgroundRepeat="repeat";else{n.backgroundRepeat="no-repeat";switch(i){case 1:n.backgroundSize="100% 100%";break;case 2:n.backgroundSize="contain";n.backgroundPosition="50% 50%";break;case 3:n.backgroundSize="cover";break;case 0:n.backgroundSize="auto";n.backgroundPosition="50% 50%"}}},i.getImageUrl=function(t){return t.PictureName?n.ImageHelper.getImageUrlBySourceType(t.SourceType,t.PictureName):n.ForguncyData.ForguncyRoot+"GeneratedResources/Images/GenerateImages/FlowingImages/"+t.ImageSrc},i.setBackground=function(t,i,r){var u,f,e;r.Background&&(u=n.ColorHelper.Convert(r.Background),u.includes("gradient")?(f=n.DomUtilities.createJqueryDomElement("div"),e={background:u,width:"100%",height:"100%",position:"absolute"},i.position="absolute",i.width="100%",i.height="100%",f.addClass(n.CSSHelper.getClassName(e)),f.attr("fgc-gui","imagebg"),t.append(f)):i.background=u)},i.setImageContainerStyle=function(t,i){var r;t.overflow="hidden";t.display="flex";t.flex="1";t.boxSizing="border-box";i.BoxShadow&&(t.boxShadow=n.ColorHelper.ConvertShadow(i.BoxShadow));i.Border&&(t.border=n.ColorHelper.ConvertBorder(i.Border));i.CornerRadius>0&&(t.borderRadius=i.CornerRadius+"px");i.Transparency<1&&(t.opacity=(r=i.Transparency)===null||r===void 0?void 0:r.toString())},i}(i);t.ImageElementPresenter=r})(t=n.Presentation||(n.Presentation={}))})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var u=function(){function n(){}return n.prototype.initialize=function(n){this.generateDefinitions();this.generateAreas(n)},n.prototype.generateDefinitions=function(){var n=this;this.rows=this.rowDefinitions.map(function(t){return n.getGridColumnRowDefinitionValue(t,n.rowUnit)});this.columns=this.columnDefinitions.map(function(t){return n.getGridColumnRowDefinitionValue(t,n.columnUnit)})},n.prototype.generateAreas=function(n){var t=this;this.areas=n.map(function(n){var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,i=n.Layout,et=i.Row+1,ot=i.Row+i.RowSpan+1,st=i.Column+1-((r=i.leftOverflowOffset)!==null&&r!==void 0?r:0),ht=i.Column+i.ColumnSpan+1+((u=i.rightOverflowOffset)!==null&&u!==void 0?u:0),ct=i.Column+1,lt=i.Column+i.ColumnSpan+1,it=(e=(f=n.Layout)===null||f===void 0?void 0:f.PaddingLeft)!==null&&e!==void 0?e:0,rt=(s=(o=n.Layout)===null||o===void 0?void 0:o.PaddingRight)!==null&&s!==void 0?s:0,ut=(c=(h=n.Layout)===null||h===void 0?void 0:h.PaddingTop)!==null&&c!==void 0?c:0,ft=(a=(l=n.Layout)===null||l===void 0?void 0:l.PaddingBottom)!==null&&a!==void 0?a:0;((v=n)===null||v===void 0?void 0:v.FitToBrowserHeight)===!0&&(et=1,ot=t.rowDefinitions.length+1,ut=0,ft=0);((y=n)===null||y===void 0?void 0:y.FitToBrowserWidth)===!0&&(st=1,ht=t.columnDefinitions.length+1,it=0,rt=0);((p=t.rowDefinitions[i.Row])===null||p===void 0?void 0:p.IsHidden)&&(ut=0);((w=t.rowDefinitions[i.Row+i.RowSpan-1])===null||w===void 0?void 0:w.IsHidden)&&(ft=0);((b=t.columnDefinitions[i.Column])===null||b===void 0?void 0:b.IsHidden)&&(it=0);((k=t.columnDefinitions[i.Column+i.ColumnSpan-1])===null||k===void 0?void 0:k.IsHidden)&&(rt=0);var at=((d=t.columnDefinitions[i.Column])===null||d===void 0?void 0:d.Mode)===2?"fr":t.columnUnit,vt=((g=t.columnDefinitions[i.Column+i.ColumnSpan-1])===null||g===void 0?void 0:g.Mode)===2?"fr":t.columnUnit,yt=((nt=t.rowDefinitions[i.Row])===null||nt===void 0?void 0:nt.Mode)===2?"fr":t.columnUnit,pt=((tt=t.rowDefinitions[i.Row+i.RowSpan-1])===null||tt===void 0?void 0:tt.Mode)===2?"fr":t.columnUnit;return{rowStart:et,rowEnd:ot,columnStart:st,columnEnd:ht,columnStartWithoutOverflow:ct,columnEndWithoutOverflow:lt,paddingLeft:it,paddingRight:rt,paddingTop:ut,paddingBottom:ft,paddingLeftUnit:at,paddingRightUnit:vt,paddingTopUnit:yt,paddingBottomUnit:pt,element:n}})},n.prototype.getGridColumnRowDefinitionValue=function(n,t){var r,u,f,e,o,i,s;if(n.IsHidden)return"0";if(t==="fr")return i=n.DesignLengthInPixel,s=n.DesignLengthInPixel,"minmax(".concat(i,"px, ").concat(s,"fr)");if(n.Mode===1)return"auto";if(n.Mode===2){var h=((r=n.MaxLength)===null||r===void 0?void 0:r.Unit)===2?"fr":t,i=(f=(u=n.MinLength)===null||u===void 0?void 0:u.Value)!==null&&f!==void 0?f:0,s=(o=(e=n.MaxLength)===null||e===void 0?void 0:e.Value)!==null&&o!==void 0?o:Math.max(i,n.DesignLengthInPixel);return"minmax(".concat(i).concat("px",", ").concat(s).concat(h,")")}return"".concat(n.DesignLengthInPixel,"px")},n}(),i,f,r;t.Grid=u;i=function(){function n(){}return n.renderContainer=function(n,t){var r=t.rows.join(" "),u=t.columns.join(" "),i=n.style;i.display="grid";i.gridTemplateRows=r;i.gridTemplateColumns=u;i.alignContent="start";i.justifyContent="start";i.display="-ms-grid";i.msGridRows=r;i.msGridColumns=u},n.renderFullSizeElement=function(n,t,i){var r=document.createElement("div"),u;$(r).addClass("fgc-penetrable");n.appendChild(r);u={rowStart:1,rowEnd:t,columnStart:1,columnEnd:i};this.renderElement(r,u);this.renderElementPosition(r)},n.renderElement=function(n,t){var i=n.style;i.gridRowStart=t.rowStart+"";i.gridRowEnd=t.rowEnd+"";i.gridColumnStart=t.columnStart+"";i.gridColumnEnd=t.columnEnd+"";i.msGridRow=t.rowStart+"";i.msGridRowSpan=t.rowEnd-t.rowStart+"";i.msGridColumn=t.columnStart+"";i.msGridColumnSpan=t.columnEnd-t.columnStart+""},n.renderElementPosition=function(n){n.classList.add("fgc-container-relative")},n.renderElementMargin=function(n,t){var i,r,u;(t.paddingLeft||t.paddingRight||t.paddingTop||t.paddingBottom)&&(i=n.style,i.width="auto",i.height="auto",r=t.paddingLeft+t.element.FullWidth+t.paddingRight,u=r,i.marginTop=t.paddingTopUnit==="px"?t.paddingTop+"px":t.paddingTop/u*100+"%",i.marginBottom=t.paddingBottomUnit==="px"?t.paddingBottom+"px":t.paddingBottom/u*100+"%",i.marginLeft=t.paddingLeftUnit==="px"?t.paddingLeft+"px":t.paddingLeft/r*100+"%",i.marginRight=t.paddingRightUnit==="px"?t.paddingRight+"px":t.paddingRight/r*100+"%")},n.updateVisibility=function(n,t,i){var r=n.style,u=i.rowDefinitions.slice(t.rowStart-1,t.rowEnd-1),f=i.columnDefinitions.slice(t.columnStartWithoutOverflow-1,t.columnEndWithoutOverflow-1),e=u.length>0&&u.every(function(n){return n.IsHidden||n.DesignLengthInPixel===0}),o=f.length>0&&f.every(function(n){return n.IsHidden||n.DesignLengthInPixel===0});e||o?r.display!=="none"&&(r.display="none"):r.display==="none"&&(r.display="")},n}();t.GridRender=i;f=function(){function t(t,i,u,f,e){this.drawerFitContent=2;this.parentElement=t;this.metadata=i;this.pageStretchInfo=u;this.pageContentType=f;this.drawerFitContent=e;this.rowDefinitions=n.Common.clone(this.metadata.PageSettings.RowDefinitions);this.columnDefinitions=n.Common.clone(this.metadata.PageSettings.ColumnDefinitions);this.preProcessDefinitions();this.borderLayout=new r;this.borderLayout.generateRuntimeCells(i,this.rowDefinitions,this.columnDefinitions)}return t.prototype.preProcessDefinitions=function(){this.pageContentType===1&&((this.drawerFitContent===2||this.drawerFitContent===0)&&this.rowDefinitions.filter(function(n){return n.Mode===2}).forEach(function(n){return n.Mode=0}),(this.drawerFitContent===2||this.drawerFitContent===1)&&this.columnDefinitions.filter(function(n){return n.Mode===2}).forEach(function(n){return n.Mode=0}))},t.prototype.generateElements=function(){var n,i=this.metadata,t=(n={},n[0]=i.BackgroundImages.map(function(n){return{type:0,value:n}}),n[1]=i.Backgrounds.map(function(n){return{type:1,value:n}}),n[2]=i.OverflowCellBackgrounds.map(function(n){return{type:2,value:n}}),n[3]=i.PlaceHolders.map(function(n){return{type:3,value:n}}),n[4]=i.ListViews.map(function(n){return{type:4,value:n}}),n[5]=i.Cells.map(function(n){return{type:5,value:n}}),n[6]=[],n[7]=i.Charts.map(function(n){return{type:7,value:n}}),n[8]=i.Images.map(function(n){return{type:8,value:n}}),n),f=__spreadArray(__spreadArray(__spreadArray([],t[3],!0),t[4],!0),t[5],!0),u,e,r,o,s;for(f.sort(function(n,t){return n.value.Layout.Row-t.value.Layout.Row||n.value.Layout.Column-t.value.Layout.Column}),u=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],t[0],!0),t[1],!0),t[2],!0),f,!0),t[6],!0),t[7],!0),t[8],!0),e=u.length,r=0;r<e;r++)o=u[r].value,s=u[r].type,this.createElementHanlder(o,s)},t.prototype.locateElements=function(t){var e;t===void 0&&(t=!1);this.refreshRuntimeBorders();var o=this.getAllElements(this.metadata),r=new u,f=this.pageStretchInfo.StretchMode;if(r.rowUnit=f===0||f===1?"px":"fr",r.columnUnit=f===0||f===2?"px":"fr",r.rowDefinitions=this.rowDefinitions,r.columnDefinitions=this.columnDefinitions,r.initialize(o),e=this.parentElement[0],i.renderContainer(e,r),r.areas.forEach(function(n){var t=n.element.runtimeContainer,u;i.renderElement(t[0],n);i.renderElementPosition(t[0]);i.updateVisibility(t[0],n,r);u=t.children()[0];u&&i.renderElementMargin(t[0],n)}),(this.pageContentType===0||this.pageContentType===1)&&this.borderLayout.updateContainerLeftTopPadding(e),this.pageContentType!==2&&this.borderLayout.updateContainerRightBottomPadding(e),t)n.PageBuilder.onWindowResize(!0,!0,!1)},t.prototype.lazyLocateElements=function(t){var i=this;this._resizeTimer&&(n.DelayRefresh.clearTimeout(this._resizeTimer),this._resizeTimer=null);this._resizeTimer=n.DelayRefresh.setTimeout(function(){window.requestAnimationFrame(function(){i.locateElements(!0);t===null||t===void 0?void 0:t()})},20)},t.prototype.changeRowVisibility=function(n,t){this.rowDefinitions[n].IsHidden=!t},t.prototype.changeColumnVisibility=function(n,t){this.columnDefinitions[n].IsHidden=!t},t.prototype.possibleStretch=function(n){return this.possibleStretchInRows(n)||this.possibleStretchInColumns(n)},t.prototype.possibleStretchInRows=function(n){var t=n?n.Row:0,i=n?n.Row+n.RowSpan:this.rowDefinitions.length,r=this.rowDefinitions.slice(t,i);return r.some(function(n){return n.Mode===2})},t.prototype.possibleStretchInColumns=function(n){var t=n?n.Column:0,i=n?n.Column+n.ColumnSpan:this.columnDefinitions.length,r=this.columnDefinitions.slice(t,i);return r.some(function(n){return n.Mode===2})},t.prototype.possibleAutoFit=function(n){return this.possibleAutoFitInRows(n)||this.possibleAutoFitInColumns(n)},t.prototype.possibleAutoFitInRows=function(n){var t=n?n.Row:0,i=n?n.Row+n.RowSpan:this.rowDefinitions.length,r=this.rowDefinitions.slice(t,i);return r.some(function(n){return n.Mode===1})},t.prototype.possibleAutoFitInColumns=function(n){var t=n?n.Column:0,i=n?n.Column+n.ColumnSpan:this.columnDefinitions.length,r=this.columnDefinitions.slice(t,i);return r.some(function(n){return n.Mode===1})},t.prototype.getColumnWidth=function(n,t){for(var r,f,u=0,e=n+t,i=n;i<e;i++)r=this.columnDefinitions[i],f=r.IsHidden?0:r.DesignLengthInPixel,u+=f;return u},t.prototype.getRowHeight=function(n,t){for(var r,f,u=0,e=n+t,i=n;i<e;i++)r=this.rowDefinitions[i],f=r.IsHidden?0:r.DesignLengthInPixel,u+=f;return u},t.prototype.getAllElements=function(n){return[].concat(n.Backgrounds,n.BackgroundImages,n.OverflowCellBackgrounds,n.Cells,n.ListViews,n.PlaceHolders,this.borderLayout.runtimeBorders,n.Charts,n.Images)},t.prototype.refreshRuntimeBorders=function(){var t,i,n;for(this.borderLayout.refreshRuntimeBorders(this.metadata,this.rowDefinitions,this.columnDefinitions),t=this.borderLayout.runtimeBorders,i=t.length,n=0;n<i;n++)this.createElementHanlder(t[n],6)},t}();t.PageLayout=f;r=function(){function t(){this.runtimeBorders=[];this.paddingTop=0;this.paddingBottom=0;this.paddingLeft=0;this.paddingRight=0}return t.prototype.generateRuntimeCells=function(t,i,r){var u=this,f=r.length,e=i.length;this.runtimeLayoutCells=new n.Array2(f,e);t.Borders.forEach(function(n){for(var i,e,f,t=n.Layout,r=t.Row;r<t.Row+t.RowSpan;r++)for(i=t.Column;i<t.Column+t.ColumnSpan;i++)e=u.runtimeLayoutCells.get(i,r),e?e[n.Position]=n:u.runtimeLayoutCells.set(i,r,(f={},f[n.Position]=n,f))})},t.prototype.refreshRuntimeBorders=function(n,t,i){this.clearOldRuntimeBorders();this.createRowBorders(n,t,i);this.createColBorders(n,t,i);this.sortBorders(n)},t.prototype.updateContainerLeftTopPadding=function(n){n.style.paddingLeft=this.paddingLeft/2+"px";n.style.paddingTop=this.paddingTop/2+"px"},t.prototype.updateContainerRightBottomPadding=function(n){n.style.paddingRight=this.paddingRight/2+"px";n.style.paddingBottom=this.paddingBottom/2+"px"},t.prototype.clearOldRuntimeBorders=function(){this.runtimeBorders.forEach(function(n){n.runtimeContainer.remove()});this.runtimeBorders=[]},t.prototype.sortBorders=function(n){this.runtimeBorders.sort(function(t,i){return n.BorderStyles[t.StyleIndex].Order-n.BorderStyles[i.StyleIndex].Order})},t.prototype.createRowBorders=function(t,i,r){var b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,l=t.BorderStyles,yt=i.map(function(n,t){return{rawIndex:t,isHidden:n.IsHidden}}).filter(function(n){return!n.isHidden}),f=r.map(function(n,t){return{rawIndex:t,isHidden:n.IsHidden}}).filter(function(n){return!n.isHidden}),kt,e,a,c,w;for(this.paddingLeft=0,this.paddingRight=0,kt=yt.length,e=0;e<kt+1;e++){var pt=(k=(b=yt[e-1])===null||b===void 0?void 0:b.rawIndex)!==null&&k!==void 0?k:-1,o=(g=(d=yt[e])===null||d===void 0?void 0:d.rawIndex)!==null&&g!==void 0?g:-1,u=void 0,ni=f.length;for(a=0;a<ni+1;a++){var v=a,s=(tt=(nt=f[v])===null||nt===void 0?void 0:nt.rawIndex)!==null&&tt!==void 0?tt:-1,y=(it=this.runtimeLayoutCells.get(s,pt))===null||it===void 0?void 0:it[3],p=(rt=this.runtimeLayoutCells.get(s,o))===null||rt===void 0?void 0:rt[1],h=void 0;(h=y&&p?l[y.StyleIndex].Order>l[p.StyleIndex].Order?y:p:y||p,h&&u&&h.StyleIndex===u.StyleIndex)||(u&&(u.Layout.ColumnSpan=((ft=(ut=f[v])===null||ut===void 0?void 0:ut.rawIndex)!==null&&ft!==void 0?ft:f.slice(-1)[0].rawIndex+1)-u.Layout.Column,w=(ot=(et=f[v-1])===null||et===void 0?void 0:et.rawIndex)!==null&&ot!==void 0?ot:-1,u.rightSpace=this.getMaxBorderLeftRightSpace(t,s,o,w,pt),this.runtimeBorders.push(u),u=null),h&&!u&&(c=n.Common.clone(h),c.Layout.Column=s,c.Layout.ColumnSpan=1,w=(ht=(st=f[v-1])===null||st===void 0?void 0:st.rawIndex)!==null&&ht!==void 0?ht:-1,c.leftSpace=this.getMaxBorderLeftRightSpace(t,s,o,w,pt),u=c))}var ti=(lt=(ct=f[0])===null||ct===void 0?void 0:ct.rawIndex)!==null&&lt!==void 0?lt:-1,wt=this.runtimeLayoutCells.get(ti,o),dt=wt===null||wt===void 0?void 0:wt[0];dt&&(this.paddingLeft=Math.max(this.paddingLeft,l[dt.StyleIndex].BorderWidth));var ii=(vt=(at=f[f.length-1])===null||at===void 0?void 0:at.rawIndex)!==null&&vt!==void 0?vt:-1,bt=this.runtimeLayoutCells.get(ii,o),gt=bt===null||bt===void 0?void 0:bt[2];gt&&(this.paddingRight=Math.max(this.paddingRight,l[gt.StyleIndex].BorderWidth))}},t.prototype.createColBorders=function(t,i,r){for(var a,h,w,gt,kt,ni,dt,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,c=t.BorderStyles,f=i.map(function(n,t){return{rawIndex:t,isHidden:n.IsHidden}}).filter(function(n){return!n.isHidden}),wt=r.map(function(n,t){return{rawIndex:t,isHidden:n.IsHidden}}).filter(function(n){return!n.isHidden}),ti=wt.length,l=0;l<ti+1;l++){var bt=(k=(b=wt[l-1])===null||b===void 0?void 0:b.rawIndex)!==null&&k!==void 0?k:-1,e=(g=(d=wt[l])===null||d===void 0?void 0:d.rawIndex)!==null&&g!==void 0?g:-1,u=void 0,ii=f.length;for(a=0;a<ii+1;a++){var v=a,o=(tt=(nt=f[v])===null||nt===void 0?void 0:nt.rawIndex)!==null&&tt!==void 0?tt:-1,y=(it=this.runtimeLayoutCells.get(bt,o))===null||it===void 0?void 0:it[2],p=(rt=this.runtimeLayoutCells.get(e,o))===null||rt===void 0?void 0:rt[0],s=void 0;(s=y&&p?c[y.StyleIndex].Order>c[p.StyleIndex].Order?y:p:y||p,s&&u&&s.StyleIndex===u.StyleIndex)||(u&&(u.Layout.RowSpan=((ft=(ut=f[v])===null||ut===void 0?void 0:ut.rawIndex)!==null&&ft!==void 0?ft:f.slice(-1)[0].rawIndex+1)-u.Layout.Row,w=(ot=(et=f[v-1])===null||et===void 0?void 0:et.rawIndex)!==null&&ot!==void 0?ot:-1,u.bottomSpace=this.getMaxBorderTopBottomSpace(t,e,o,bt,w),this.runtimeBorders.push(u),u=null),s&&!u&&(h=n.Common.clone(s),h.Layout.Row=o,h.Layout.RowSpan=1,w=(ht=(st=f[v-1])===null||st===void 0?void 0:st.rawIndex)!==null&&ht!==void 0?ht:-1,h.topSpace=this.getMaxBorderTopBottomSpace(t,e,o,bt,w),u=h))}gt=(lt=(ct=f[0])===null||ct===void 0?void 0:ct.rawIndex)!==null&&lt!==void 0?lt:-1;kt=(at=this.runtimeLayoutCells.get(e,gt))===null||at===void 0?void 0:at[1];kt&&(this.paddingTop=Math.max(this.paddingTop,c[kt.StyleIndex].BorderWidth));ni=(yt=(vt=f[f.length-1])===null||vt===void 0?void 0:vt.rawIndex)!==null&&yt!==void 0?yt:-1;dt=(pt=this.runtimeLayoutCells.get(e,ni))===null||pt===void 0?void 0:pt[3];dt&&(this.paddingBottom=Math.max(this.paddingBottom,c[dt.StyleIndex].BorderWidth))}},t.prototype.getMaxBorderLeftRightSpace=function(n,t,i,r,u){var e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,f=n.BorderStyles,ft=(c=(h=f[(s=(o=(e=this.runtimeLayoutCells.get(r,u))===null||e===void 0?void 0:e[2])===null||o===void 0?void 0:o.StyleIndex)!==null&&s!==void 0?s:-1])===null||h===void 0?void 0:h.BorderWidth)!==null&&c!==void 0?c:0,et=(p=(y=f[(v=(a=(l=this.runtimeLayoutCells.get(t,u))===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.StyleIndex)!==null&&v!==void 0?v:-1])===null||y===void 0?void 0:y.BorderWidth)!==null&&p!==void 0?p:0,ot=(g=(d=f[(k=(b=(w=this.runtimeLayoutCells.get(r,i))===null||w===void 0?void 0:w[2])===null||b===void 0?void 0:b.StyleIndex)!==null&&k!==void 0?k:-1])===null||d===void 0?void 0:d.BorderWidth)!==null&&g!==void 0?g:0,st=(ut=(rt=f[(it=(tt=(nt=this.runtimeLayoutCells.get(t,i))===null||nt===void 0?void 0:nt[0])===null||tt===void 0?void 0:tt.StyleIndex)!==null&&it!==void 0?it:-1])===null||rt===void 0?void 0:rt.BorderWidth)!==null&&ut!==void 0?ut:0;return[ft,et,ot,st].sort(function(n,t){return t-n})[0]},t.prototype.getMaxBorderTopBottomSpace=function(n,t,i,r,u){var e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,f=n.BorderStyles,ft=(c=(h=f[(s=(o=(e=this.runtimeLayoutCells.get(r,u))===null||e===void 0?void 0:e[3])===null||o===void 0?void 0:o.StyleIndex)!==null&&s!==void 0?s:-1])===null||h===void 0?void 0:h.BorderWidth)!==null&&c!==void 0?c:0,et=(p=(y=f[(v=(a=(l=this.runtimeLayoutCells.get(r,i))===null||l===void 0?void 0:l[1])===null||a===void 0?void 0:a.StyleIndex)!==null&&v!==void 0?v:-1])===null||y===void 0?void 0:y.BorderWidth)!==null&&p!==void 0?p:0,ot=(g=(d=f[(k=(b=(w=this.runtimeLayoutCells.get(t,u))===null||w===void 0?void 0:w[3])===null||b===void 0?void 0:b.StyleIndex)!==null&&k!==void 0?k:-1])===null||d===void 0?void 0:d.BorderWidth)!==null&&g!==void 0?g:0,st=(ut=(rt=f[(it=(tt=(nt=this.runtimeLayoutCells.get(t,i))===null||nt===void 0?void 0:nt[1])===null||tt===void 0?void 0:tt.StyleIndex)!==null&&it!==void 0?it:-1])===null||rt===void 0?void 0:rt.BorderWidth)!==null&&ut!==void 0?ut:0;return[ft,et,ot,st].sort(function(n,t){return t-n})[0]},t}();t.PageBorderLayout=r})(t=n.Presentation||(n.Presentation={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var r=function(){function t(){}return t.canHorizontallyStretch=function(n){return n===1||n===3||n===4},t.canVerticallyStretch=function(n){return n===2||n===3||n===4},t.getStretchMode=function(i,r){switch(i){case 0:return n.ForguncyData.GlobalSettings.PageResponsiveMode===0?0:t.getStretchMode(n.ForguncyData.GlobalSettings.PageResponsiveMode,r);case 4:if(r===3)return 3;if(r===0)return 1;if(r===1)return 2;break;case 2:if(r===3||r===0)return 1;break;case 3:if(r===3||r===1)return 2;break;case 5:if(r===3)return 4;break;default:return 0}return 0},t.getPageResponsiveMode=function(n){switch(n){case 3:return 4;case 1:return 2;case 2:return 3;case 4:return 5;default:return 1}},t}(),i;t.StretchCommon=r;i=function(){function n(){}return n.adjustMainDiv=function(i,r,u,f){var e=i,s=u.PageSettings.Width,h=u.PageSettings.Height,o;switch(r){case 1:i.css("width","100%");i.css("min-width","100%");this.adjustMainDivHeight(i,u,f);break;case 2:i.css("height","100%");i.css("min-height","100%");this.adjustMainDivWidth(i,u,f);break;case 3:i.css("width","100%");i.css("height","100%");i.css("min-width","100%");i.css("min-height","100%");break;case 4:i.css("width","100%");i.css("height","0");i.css("min-width","100%");i.css("padding-bottom",n._calcPaddingBottomRatio(s,h)+"%");e=$(document.createElement("div"));e.css("position","absolute");e.css("left","0");e.css("top","0");e.css("right","0");e.css("bottom","0");e.css("width","");e.css("height","");i.append(e);break;case 0:default:this.adjustMainDivWidth(i,u,f);this.adjustMainDivHeight(i,u,f)}return o=u.PageSettings,t.GridRender.renderFullSizeElement(e[0],o.RowCount+1,o.ColumnCount+1),e},n.adjustMainDivWidth=function(n,t,i){var r=i===1,u=t.PageSettings.ColumnDefinitions,f=u.some(function(n){return n.Mode===2});f&&!r?(n.css("width","inherit"),n.css("min-width","100%")):n.css("width","")},n.adjustMainDivHeight=function(n,t){var i=t.PageSettings.RowDefinitions,r=i.some(function(n){return n.Mode===2});r?(n.css("height","inherit"),n.css("min-height","100%")):n.css("height","")},n._calcPaddingBottomRatio=function(n,t){return n>0?100*t/n:100},n}();t.StretchLayout=i})(t=n.Presentation||(n.Presentation={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){}return t.initPageZoomInfo=function(){t.removeDisableZoomCss();n.ForguncyData.pageInfo.allowZoomScreen?$("meta[name='viewport']").replaceWith("<meta name='viewport' content='width=device-width'>"):($("meta[name='viewport']").replaceWith("<meta name='viewport' content='width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi' />"),t.injectDisableZoomCss())},t.disablePageZoomForMobile=function(){if(n.Platform.isMobile()){var t=function(t){n.ForguncyData.pageInfo.allowZoomScreen||t.touches.length>1&&t.preventDefault()};window.addEventListener("touchstart",t,!1)}},t.injectDisableZoomCss=function(){var t,i;n.Platform.isIOSDevice()&&(t=document.createElement("style"),t.setAttribute("id","disablegestures"),document.body.appendChild(t),i=t.sheet,i.insertRule?i.insertRule("*{touch-action:manipulation;}",0):i.addRule("*","{touch-action:manipulation;}",0))},t.removeDisableZoomCss=function(){if(n.Platform.isIOSDevice()){var t=$("style#disablegestures");t.length!==0&&t.remove()}},t}();n.PageZoomHelper=t})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(){var i=this;$(document.body).on("click","["+t.AttributeName+"]",function(){var e=$(this),u=e.attr(t.AttributeName),f=i.getUserManagerOperation(u),r;if(f!==13)return r=[],r.push({$type:"Forguncy.Model.UserManagerCommand, ServerDesignerCommon",operation:f}),n.ForguncyData.commandExcutor.excuteCommand(r,{runTimePageName:n.StaticValues.RunTimeNormalPage,commandTrigger:null,commandID:u,eventType:"click"}),!1});$(document).on("forguncyPageloaded",function(){i.loadUserProfile();i.loadUserSubscription();i.loadMFASettings()})}return t.prototype.getUserManagerOperation=function(n){if(n.indexOf("Logout:")===0)return this.getLogoutOperation(n);switch(n){case"LogIn_Button":return 0;case"ForgotPassword_Send":return 3;case"ChangeProfile_Button":return 7;case"ChangePassword_Button":return 4;case"CancelChangePassword_Button":return 5;case"ResetPassword_Button":return 6;case"401Login":return 2;case"MailSubscription_Button":return 8;case"MFA_Secret_Next_Button":return 9;case"MFA_VerifyCode_SubmitButton":return 10;case"MFA_Enable":return 11;case"MFA_Disable":return 12;default:return 13}},t.prototype.getLogoutOperation=function(t){var r,f=t.split(":"),e=f[1],u=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(e).cellType,i;return u?n.ForguncyData.pageDirtyCheckManager.shouldCancelByPageDirty(!1,!0,"Logout")?13:(i=u.cellTypeData.metaData,{option:1,param:(r=i===null||i===void 0?void 0:i.NavigateSettingWhenLogout)!==null&&r!==void 0?r:{NavigateWhenLogoutMode:n.NavigateWhenLogoutMode.KeepCurrentPage}}):13},t.prototype.loadUserProfile=function(){this.containBuiltinElement("ChangeProfile_Button")&&n.Common.forguncyPost("Account/GetUserProfile",null,function(i){if(i){var r=$("["+t.AttributeName+"=ChangeProfile_Picture]");n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("ChangeProfile_FullName",i.FullName);n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("ChangeProfile_Email",i.Email);n.ImageHelper.setImageSource(r,i.Picture)}})},t.prototype.loadUserSubscription=function(){if(this.containBuiltinElement("MailSubscription_Button")){var i=n.Common.getPageContext(),t={};t.commandID=i.commandID;n.Common.forguncyPost("Home/GetSubscription",t,function(t){t&&n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("MailSubscription_Choice",t)})}},t.prototype.loadMFASettings=function(){this.containBuiltinElement("MFA_Secret_Barcode")&&n.Common.forguncyPost("Account/GetMFABarcodeText",null,function(t){var i=n.Common.IsEmpty(t)?null:t;n.ForguncyData.pageInfo.pageElementManager.cells.setValueToForguncyattrCell("MFA_Secret_Barcode",i);n.Common.removeCookie("HasMFASecret=0")})},t.prototype.containBuiltinElement=function(i){var r=$("#pageWrapper_"+n.ForguncyData.pageInfo.pageID).find("["+t.AttributeName+" = "+i+"]");return r.length>0},t.AttributeName="forguncyattr",t}();new t})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var i=function(){function t(){this.executingContext={}}return Object.defineProperty(t.prototype,"designerPageName",{get:function(){return n.PageManager.getDesignerPageName(this.runTimePageName,!1)},enumerable:!1,configurable:!0}),t.prototype.getCurrentRowInfoCollection=function(){return n.ForguncyData.pageInfo.currentRowInfoCollection},t.prototype.getBindingValueVersions=function(){return n.ForguncyData.pageInfo.normalCellBindingManager.bindingValueVersions},t}(),r,u,t;n.CommandExecuteInfo=i;r=function(){function r(){this.middleClick=!1;this.commandFactor=new n.CommandFactory;var t=this;t._waitingQueque=[];$(document).on("mousedown mouseup",function(i){if(i.which===2&&i.target.tagName==="A")return i.type==="mousedown"&&(t.__swcp__||(t.__swcp__=$('<div style="position:fixed;top:0px;left:0px;width:100%;height:100%;background:#000;display:block;z-index:9999;opacity:0.01;filter:alpha(opacity:1);" />').appendTo("body")),n.DelayRefresh.setTimeout(function(){try{t.middleClick=!0;$(i.target).trigger("click","middleButton")}finally{t.middleClick=!1}},50),t.__swcp__.show(),n.DelayRefresh.setTimeout(function(){t.__swcp__.hide()},1e3)),!1});this.createFileInputElementForImportExcelToListViewCommand()}return r.prototype.init=function(){this._commandExecuteInfo=undefined;this._waitingQueque=[];this._clickCommandsEndTime={}},r.prototype.createFileInputElementForImportExcelToListViewCommand=function(){var t=n.DomUtilities.createJqueryDomElement("input"),i;t.attr("type","file");t.attr("id","forguncy_FileInput");i=".xlsx";n.Platform.isAndroid()&&n.Platform.isWeChatOrQQBrowser()&&(i=null);t.attr("accept",i);t.css("display","none");t.appendTo("body")},r.prototype.ajustCurrentRowInfo=function(t,i,r,u){var f=this.getAjustedRowInfo(i,r,u);f.forEach(function(t){var i=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(t.currentTable);(n.Common.IsEmpty(i)||i.listviewLocation!==t.listviewLocation||!n.Common.isQueryEqual(i.query,t.query))&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(t,!0)});f.length>0&&n.DeleteRecordCommand.prepareRowInfo(t,f[0])},r.prototype.getAjustedRowInfo=function(t,i,r){var f=[],u;if(i instanceof n.ListviewBase&&f.push(i.getRowInfo()),r==="valuechanged")return f;for(u=n.PageManager.getContainerCell(t);u;)u.cellType instanceof n.RepeaterCellType&&f.push(u.cellType.getAdditionalRowInfo(t)),t=u.runTimePageName,u=n.PageManager.getContainerCell(t);return f},r.prototype.alertRepeatMessage=function(t,i){t==="click"&&(new Date).valueOf()-i.valueOf()>1e3&&alert(n.RS.Commit_ExecutingMessage)},r.prototype.isCommandExecuting=function(n,t){return this._commandExecuteInfo&&this._commandExecuteInfo.commandId===n&&this._commandExecuteInfo.eventType===t},r.prototype.excuteCommand=function(t,i){var u,e,r,f;if(this.isCommandExecuting(i.commandID,i.eventType)){this.alertRepeatMessage(i.eventType,this._commandExecuteInfo.startTime);return}for(e=this._waitingQueque.length,r=0;r<e;r++)if(this._waitingQueque[r].commandID===i.commandID&&this._waitingQueque[r].eventType===i.eventType){this.alertRepeatMessage(i.eventType,this._waitingQueque[r].startTime);return}(n.ForguncyData.IsAutoTest||i.eventType!=="click"||n.Common.IsEmpty(i.commandID)||(f=this._clickCommandsEndTime[i.commandID],n.Common.IsEmpty(f)||!((new Date).valueOf()-f.valueOf()<300)))&&(this.ajustCurrentRowInfo(t,i.runTimePageName,i.commandTrigger,i.eventType),this._waitingQueque.push({commandID:i.commandID,commands:t,runTimePageName:i.runTimePageName,eventType:i.eventType,initParams:i.initParams,commandTrigger:i.commandTrigger,isMiddelClick:this.isMiddleClick(t,i.eventType),callbackOnCommandCompleted:i.callbackOnCommandCompleted,startTime:new Date,locationStr:i.locationString,logHelper:(u=i.logHelper)!==null&&u!==void 0?u:new n.CommandLogHelper}),this.excuteCommandFromWaitingQueque())},r.prototype.excuteCommandFromWaitingQueque=function(){var u,f,t,i,r;if(this._waitingQueque.length!==0&&!this._commandExecuteInfo){t=this._waitingQueque.shift();this._commandExecuteInfo=this._createCommandExecuteInfo(t);n.ForguncyData.commandLogHelper=this._commandExecuteInfo.logHelper;n.ForguncyData.commandLogHelper.tryStartNewRoot();i=n.RS.StartExecuteCommand;switch(t.eventType){case"pageloaded":i=n.Common.format(n.RS.StartExecutePageLoadCommand,n.PageManager.getDesignerPageName(t.runTimePageName,!1));break;case"click":i=n.Common.format(n.RS.StartExecuteCellClickCommand,(u=t.locationStr)!==null&&u!==void 0?u:t.commandID);break;case"valuechanged":i=n.Common.format(n.RS.StartExecuteCellValudeChangedCommand,(f=t.locationStr)!==null&&f!==void 0?f:t.commandID);break;case"processprecommand":i=n.Common.format(n.RS.BPM_LogText_ExecutePreCommands);break;case"processpostcommand":i=n.Common.format(n.RS.BPM_LogText_ExecutePostCommands);break;case"processsavebusinessdatacommand":i=n.Common.format(n.RS.BPM_LogText_SaveBussinessDataCommand);break;default:i=t.locationStr}if(this._commandExecuteInfo.logHelper.log(i),this._commandExecuteInfo.logHelper.startChild(),this._commandExecuteInfo.executingContext={},t.initParams){this._commandExecuteInfo.logHelper.log(n.RS.CreateCommandContextVariables);this._commandExecuteInfo.logHelper.startChild();for(r in t.initParams)n.ForguncyData.parameterManager.setValue(r,t.initParams[r],this._commandExecuteInfo.logHelper),r==="valueChangedReason"&&(this._commandExecuteInfo.executingContext[1]=t.initParams[r]);this._commandExecuteInfo.logHelper.endChild()}this._executeCommand()}},r.prototype.insertCommandsToCurrentExecutingList=function(t,i,r){var u,e,f,o;if(r===void 0&&(r=null),u=this._commandExecuteInfo,u===null||u===void 0?void 0:u.currentCommandList){if(e=u.runTimePageName,u.runTimePageName=i,n.ForguncyData.parameterManager.push(),r)for(f in r)n.ForguncyData.parameterManager.setValue(f,r[f]);o=t.concat([new n.RestoreRuntimePageNameParam(e)]);u.currentCommandList=o.concat(u.currentCommandList)}},r.prototype.getCommandExecuteInfo=function(){return this._commandExecuteInfo},r.prototype.isMiddleClick=function(n,t){return t!=="click"||n.length>1?!1:this.middleClick},r.prototype._createCommandExecuteInfo=function(n){var r=new i,f,u;for(r.isFirstCommand=!0,r.commandId=n.commandID,r.validateResult=!1,r.currentCommandList=[],f=n.commands.length,u=0;u<f;u++)n.commands[u]&&r.currentCommandList.push(n.commands[u]);return r.commandTrigger=n.commandTrigger,r.runTimePageName=n.runTimePageName,r.haveCommitListView=!1,r.eventType=n.eventType,r.isMiddelClick=this.isMiddleClick(n.commands,n.eventType),r.callbackOnCommandCompleted=n.callbackOnCommandCompleted,r.cacheDataHelper=new t,r.startTime=n.startTime,r.logHelper=n.logHelper,r},r.prototype._executeCommand=function(){var t=this,i=this._commandExecuteInfo;if(i&&i.suspend){setTimeout(function(){t._executeCommand()},10);return}i&&i.currentCommandList&&n.DelayOperateHelper.Push(t,function(){var i,r=t._commandExecuteInfo,u;if(r&&r.suspend){t._executeCommand();return}if(((i=t===null||t===void 0?void 0:t._commandExecuteInfo)===null||i===void 0?void 0:i.currentCommandList)&&!t._commandExecuteInfo.currentCommandList.every(function(t){return n.ModuleLoader.isPluginLoaded(t.$type)})){u=t._commandExecuteInfo.currentCommandList.map(function(t){return n.ModuleLoader.LoadTypeModule(t.$type)});$.when.apply($,u).then(function(){t._executeCommand()});return}return t._executeFirstCommandInList()},0)},r.prototype._executeFirstCommandInList=function(){return __awaiter(this,void 0,void 0,function(){var t,i,f,r,o,h,u,e,s;return __generator(this,function(c){switch(c.label){case 0:if(t=this._commandExecuteInfo,!t||!t.currentCommandList)return[2];if(t.isFirstCommand&&t.commandTrigger&&(t.isFirstCommand=!1,t.commandTrigger.shouldCancelCommand(t.commandId,t.eventType)))return this.stopExecuteCommandList(t),[2];if(i=t.currentCommandList,i.length===0)return this.stopExecuteCommandList(t,!0),[2];if(f=i[0],r=f.$type,!f.Disabled&&!t.haveCommitListView&&(r==="Forguncy.Model.NavigateCommand, ServerDesignerCommon"||r==="Forguncy.Model.ShowPopupCommand, ServerDesignerCommon"||r==="Forguncy.Model.ClosePopupCommand, ServerDesignerCommon")){if(t.haveCommitListView=!0,o=this.addCommitAllEditedTableCommand(i,r),o===!0)return this._executeCommand(),[2];if(o===n.CommandResult.stop)return this.stopExecuteCommandList(t),[2]}h=i.map(function(n){return n});i.shift();u=n.CommandResult.stop;c.label=1;case 1:return(c.trys.push([1,,5,6]),e=this._executeSingleCommand(f),!(e instanceof Promise))?[3,3]:[4,e];case 2:return u=c.sent(),[3,4];case 3:u=e;c.label=4;case 4:return[3,6];case 5:return s=!0,u===n.CommandResult.stop?(this.stopExecuteCommandList(t),s=!1):u===n.CommandResult.delay&&(t.currentCommandList=h),s&&this._executeCommand(),[7];case 6:return[2]}})})},r.prototype._executeSingleCommand=function(t){var i,u;return t.Disabled?n.CommandResult.completed:(i=this.commandFactor.CreateCommand(t),!i.EnableProtect&&this._commandExecuteInfo.logHelper.getStackLength()>r.stackSizeLimit)?(console.error("Maximum call stack size exceeded"),n.CommandResult.stop):(i.CommandExecutingInfo=this._commandExecuteInfo,i.CommandExecutor=this,t.DisplayName&&(this._commandExecuteInfo.logHelper.log(t.DisplayName),this._commandExecuteInfo.logHelper.startChild(),u=new n.CommandTerminateParam,u.command=i,this._commandExecuteInfo.currentCommandList=[u].concat(this._commandExecuteInfo.currentCommandList)),i.execute())},r.prototype.stopExecuteCommandList=function(t,i){var f=this,e,r,u;if(i===void 0&&(i=!1),t&&t===this._commandExecuteInfo){if(t.currentCommandList.every(function(t){return n.ModuleLoader.LoadTypeModule(t.$type)}),!t.currentCommandList.every(function(t){return n.ModuleLoader.isPluginLoaded(t.$type)})){n.DelayRefresh.setTimeout(function(){f.stopExecuteCommandList(t,i)});return}if(e=new n.CommandFactory,r=t.currentCommandList.filter(function(n){try{var t=e.CreateCommand(n);return t.EnableProtect}catch(i){return!1}}),r&&r.length>0)for(u=0;u<r.length;u++)this._executeSingleCommand(r[u]);this._commandExecuteInfo=undefined;t.eventType!=="click"||n.Common.IsEmpty(t.commandId)||(this._clickCommandsEndTime[t.commandId]=new Date);n.DelayRefresh.NeedDelayRun?n.DelayRefresh.setTimeout(function(){f.excuteCommandFromWaitingQueque()}):this.excuteCommandFromWaitingQueque();n.ForguncyData.parameterManager.clearCommandParams();t.logHelper.logDuring();t.logHelper.endChild();t.logHelper.consoleLog();t.callbackOnCommandCompleted&&t.callbackOnCommandCompleted(i)}},r.prototype.addCommitAllEditedTableCommand=function(t,i){for(var r,o,f=n.ListviewBase.getAllListviews(),e=i==="Forguncy.Model.ShowPopupCommand, ServerDesignerCommon"?1:0,s=f.length,u=0;u<s;u++)if(r=f[u],o=r.stopEditingActiveCell(!0),r.GetDataCommitMode()===0){if(!o)return e===0?n.CommandResult.stop:!1;if(r.isMasterTable()&&r.needCommit())return t.unshift({$type:"Forguncy.Model.commitEditTableCommand, ServerDesignerCommon",listView:r,failOptions:e}),!0}return!1},r.prototype.createCommand=function(n){return this.commandFactor.CreateCommand(n)},r.stackSizeLimit=1e3,r}();n.CommandExcutor=r,function(n){n[n.stop=0]="stop";n[n.completed=1]="completed";n[n.delay=2]="delay"}(u=n.CommandResult||(n.CommandResult={}));t=function(){function t(){t._id++;this._cachedData=[]}return t.prototype.cacheData=function(n){var i=this._cachedData.length;return this._cachedData.push(n),{id:t._id,index:i}},t.prototype.getCachedData=function(i){return n.Common.IsEmpty(i)?null:t._id!==i.id?null:this.cacheData.length<=i.index||0>i.index?null:this._cachedData[i.index]},t._id=0,t}();n.CacheDataHelper=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(){function t(){this.CommandExecutingInfo=new n.CommandExecuteInfo;this.CommandExecutingInfo.currentCommandList=[]}return t.prototype.stopExecuteCommandList=function(){this.CommandExecutor&&this.CommandExecutor.stopExecuteCommandList&&this.CommandExecutor.stopExecuteCommandList(this.CommandExecutingInfo)},t.prototype.addToCommandList=function(t,i,r,u){var f,e,o;if(!n.Common.IsEmpty(t)&&!(t.length<=0)){for(i=n.Common.IsEmpty(i)?this.CommandParam.rowOffset:i,r=n.Common.IsEmpty(r)?this.CommandParam.columnOffset:r,u=n.Common.IsEmpty(u)?this.CommandParam.formulaListRowInfo:u,f=n.Common.clone(t),e=0;e<f.length;e++)o=f[e],o.rowOffset=n.Common.IsEmpty(i)?0:i,o.columnOffset=n.Common.IsEmpty(r)?0:r,o.formulaListRowInfo=n.Common.IsEmpty(u)?null:n.Common.clone(u);this.CommandExecutingInfo.currentCommandList&&(this.CommandExecutingInfo.currentCommandList=f.concat(this.CommandExecutingInfo.currentCommandList))}},t.prototype.getCellLocation=function(t){return n.Helper.getCellLocation(t,this.getFormulaCalcContext())},t.getCellID=function(i,r,u){var l=[],p=r===null||r===void 0?void 0:r.runTimePageName,e,o,f,s,h,c;if(n.ForguncyData.parameterManager.NeedUpdateReference(i.Name)?(o=n.ForguncyData.parameterManager.ParamToReference(i.Name),f=n.Common.parseCellReferenceFormulaToCellLocation(o),f.length>0&&(i=f[0])):(e=n.PageManager.getContainerCell(r.runTimePageName),(e===null||e===void 0?void 0:e.cellType)instanceof n.UserControlPageCellType&&e.cellType.needUpdateReference(i.Name)&&(o=e.cellType.propertyToReference(i.Name),f=n.Common.parseCellReferenceFormulaToCellLocation(o.referStr),f.length>0&&(i=f[0],p=o.runTimePageName))),n.Common.IsEmpty(i.Name)){i=t.offsetFormulaCellLocation(i,r.rowOffset,r.columnOffset);var a=i.Row,v=i.Column,y=p;u||(s=n.Common.getLocatedListview(y,a,v),s&&(a=0,v-=s.getRangeInfo().Column,y=s.getCalcSheetName()));l.push(n.Common.getIdStr(a,v,y))}else if(h=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(i.Name,!1),h)for(c=0;c<h.length;c++)l.push(h[c].id);return l},t.offsetFormulaCellLocation=function(t,i,r,u){var e,s,f,o;return((t===null||t===void 0?void 0:t.Name)&&(n.ForguncyData.parameterManager.NeedUpdateReference(t.Name)?(s=n.ForguncyData.parameterManager.ParamToReference(t.Name),f=n.Common.parseCellReferenceFormulaToCellLocation(s),f.length>0&&(t=f[0])):u&&(e=n.PageManager.getContainerCell(u),(e===null||e===void 0?void 0:e.cellType)instanceof n.UserControlPageCellType&&e.cellType.needUpdateReference(t.Name)&&(s=e.cellType.propertyToReference(t.Name),f=n.Common.parseCellReferenceFormulaToCellLocation(s.referStr),f.length>0&&(t=f[0])))),n.Common.IsEmpty(t)||!n.Common.IsEmpty(t.Name)||!t.RowRelative&&!t.ColumnRelative)?t:(n.Common.IsEmpty(i)&&(i=0),n.Common.IsEmpty(r)&&(r=0),i===0&&r===0)?t:(o=n.Common.clone(t),o.RowRelative&&(o.Row+=i),o.ColumnRelative&&(o.Column+=r),o)},t.prototype.evaluateKeyword=function(t){return n.KeyWords.GetKeyWordValue(t,this.CommandExecutingInfo.runTimePageName)},t.prototype.evaluateFormula=function(t){return n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t,this.getDefaultFormulaCalcInfo())},t.prototype.getFormulaCalcContext=function(){var t=this.CommandExecutingInfo.runTimePageName;return{IsInMasterPage:n.PageManager.isMasterPageName(t),PageID:t,ListviewRowInfo:this.CommandParam.formulaListRowInfo,RowOffset:this.CommandParam.rowOffset,ColumnOffset:this.CommandParam.columnOffset}},t.prototype.getDefaultFormulaCalcInfo=function(){return{runTimePageName:this.CommandExecutingInfo.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:this.CommandParam.formulaListRowInfo,rowOffset:this.CommandParam.rowOffset,columnOffset:this.CommandParam.columnOffset}},t.prototype.commandPost=function(t,i,r,u){var f=this;n.Common.forguncyPost(t,i,r,u,function(){alert(n.RS.Command_postFail_ErrorMessage);f.stopExecuteCommandList()})},t.prototype.log=function(n){this.CommandExecutingInfo.logHelper.log(n)},t.prototype.executeCustomCommandObject=function(t,i,r){var u;(r===void 0&&(r="click"),!t||!t.Commands||t.Commands.length<=0)||n.ForguncyData.commandExcutor.excuteCommand(t.Commands,{runTimePageName:this.CommandExecutingInfo.runTimePageName,commandTrigger:null,commandID:this.CommandExecutingInfo.commandId,eventType:r,initParams:i,locationString:n.Common.format(n.RS.TriggerByCommand,(u=this.CommandParam.DisplayName)!==null&&u!==void 0?u:"Command")})},t}(),t,f,r,e,u;n.CommandBase=i;t=function(){function t(){}return t.prototype.CreateCommand=function(n){var t=this._createCommandInstance(n);return t.CommandParam=n,t},t.prototype._createCommandInstance=function(i){var r,u;if(i.$type==="Forguncy.Model.ImportExcelToListViewCommand, ServerDesignerCommon"&&(n.ImportExcelToListViewCommand||(r=document.createElement("script"),r.type="text/javascript",r.src=n.ForguncyData.ForguncyRoot+"Resources/ImportExcel.js?v="+n.StaticData.JSVersion,$("head").append(r))),u=t._registedCommands[i.$type],u)return new u;throw"Not Support This Type: "+i.$type;},t.registerCommand=function(n,i){t._registedCommands[n]=i},t._registedCommands={},t}();n.CommandFactory=t;f=function(){function n(){this.$type="Forguncy.Model.CommandTerminateParam, ServerDesignerCommon"}return n}();n.CommandTerminateParam=f;r=function(t){function i(){var n=t.call(this)||this;return n.EnableProtect=!0,n}return __extends(i,t),i.prototype.execute=function(){return this.CommandExecutingInfo.logHelper.logDuring(),this.CommandExecutingInfo.logHelper.endChild(),n.CommandResult.completed},i}(i);n.CommandTerminate=r;t.registerCommand("Forguncy.Model.CommandTerminateParam, ServerDesignerCommon",r);e=function(){function n(n){this.$type="Forguncy.Model.RestoreRuntimePageNameParam, ServerDesignerCommon";this.runTimePageName=n}return n}();n.RestoreRuntimePageNameParam=e;u=function(t){function i(){var n=t.call(this)||this;return n.EnableProtect=!0,n}return __extends(i,t),i.prototype.execute=function(){return this.CommandExecutingInfo.runTimePageName=this.CommandParam.runTimePageName,n.ForguncyData.parameterManager.pop(),n.CommandResult.completed},i}(i);n.RestoreRuntimePageNameCommand=u;t.registerCommand("Forguncy.Model.RestoreRuntimePageNameParam, ServerDesignerCommon",u)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t,e=(t={},t[0]="",t[1]="Question",t[2]="Information",t[3]="Error",t[4]="Warning",t),u=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.execute=function(){var n=this.CommandParam;return this.ExecuteConditionCommand(n)},r.prototype.ExecuteConditionCommand=function(t){var u,e,r,i;if(!t||!t.ConditionAndCommandPairList)return n.CommandResult.completed;u=t.ConditionAndCommandPairList;e=t.FunctionNameForGenerate;try{return r=this.getNoValueBindingInfos(u),this._ifConditionParamCalculator=new f(this.getDefaultFormulaCalcInfo(),r,this.CommandExecutingInfo),r.length>0?(i=this,i.commandPost("Home/GetConditionParamResult",{bindingInfos:r===null||r===void 0?void 0:r.map(function(n){return n.GUID}),currentRowInfos:i.CommandExecutingInfo.getCurrentRowInfoCollection().list,pageName:i.CommandExecutingInfo.designerPageName},function(t){if(t===""||t===null||t===undefined||t==="null")return i.stopExecuteCommandList(),n.CommandResult.stop;var r=typeof t=="string"?JSON.parse(t):t;i._ifConditionParamCalculator.tableValues=r;i.excuteCommandIfConditionIsRight(u,e)})):this.excuteCommandIfConditionIsRight(u,e),n.CommandResult.completed}catch(o){o.stack.indexOf(e)?n.ErrorHelper.printError(o):alert(o)}},r.prototype.getNoValueBindingInfos=function(n){for(var i=[],t=0;t<n.length;t++)this.getNoValueBindingInfoUsedInCondition(n[t].Condition,i);return i},r.prototype.getNoValueBindingInfoUsedInCondition=function(t,i){for(var r,e,u,o=n.ConditionHelper.enumAllConditions(t),f=0;f<o.length;f++)if(r=o[f],!n.Common.IsEmpty(r.param)&&!n.Common.IsEmpty(r.param.tableData)){for(e=!1,u=i.length-1;u>=0;u--)if(n.Common.isBindingInfoEquals(r.param.tableData,i[u])){e=!0;break}e||i.push(r.param.tableData)}},r.prototype.logCondition=function(t,i){t.ConditionDispay?t.ConditionDispay.indexOf("{0}")>=0?this.log(n.Common.format(t.ConditionDispay,i)):this.log(t.ConditionDispay):this.log("IF")},r.prototype.excuteCommandIfConditionIsRight=function(t,r,u){var e=this,h,f,o,s;for(u===void 0&&(u=0),h=function(u){var s,o,h;return t[u].ConfirmDialogSettings?(f.showConfirmBox(t[u],function(){e.logCondition(t[u],t[u].ConfirmDialogSettings.YesButtonText);e.CommandExecutingInfo.logHelper.startChild();e.addToCommandList([new i]);e.addToCommandList(t[u].CommandList)},function(){e.logCondition(t[u],t[u].ConfirmDialogSettings.NoButtonText);e.excuteCommandIfConditionIsRight(t,r,u+1)}),{value:!1}):t[u].JSText?(s=f.getJSFunction(t[u].FunctionNameForJS),o=!0,s&&(o=s()),n.Common.isFuzzyEquals(o,!0)?(f.logCondition(t[u],o),f.CommandExecutingInfo.logHelper.startChild(),f.addToCommandList([new n.CommandTerminateParam]),f.addToCommandList(t[u].CommandList),{value:!0}):(f.excuteCommandIfConditionIsRight(t,r,u+1),f.logCondition(t[u],o),{value:!1})):(h=n.ConditionHelper.getConditionResult(t[u].Condition,f._ifConditionParamCalculator.formulaCalcInfo,f._ifConditionParamCalculator),f.logCondition(t[u],h),h)?(f.CommandExecutingInfo.logHelper.startChild(),f.addToCommandList([new n.CommandTerminateParam]),f.addToCommandList(t[u].CommandList),"break"):void 0},f=this,o=u;o<t.length;o++){if(s=h(o),typeof s=="object")return s.value;if(s==="break")break}return!0},r.prototype.getJSFunction=function(t){var i=n.RunJavaScriptCommandFunctions;if(i)return i[t]},r.prototype.showConfirmBox=function(t,i,r){var a=this,o=document.activeElement,l,f,h;this.CommandExecutingInfo.suspend=!0;var u=t.ConfirmDialogSettings,s=function(){o&&o.tagName==="BUTTON"&&($(o).hide(),$(o).show());a.CommandExecutingInfo.suspend=!1},c="";u.ConfirmIcon!==0&&(c=n.ForguncyData.ForguncyRoot+"Resources/Images/ConfirmDialog/"+e[u.ConfirmIcon]+".png");l=this.evaluateFormula(u.FormulaText);f=n.PopupHelper.createConfirmPopupDom(u.Title,c,l,!n.ForguncyData.GlobalSettings.HidePopUpCloseButton);f.zIndex=n.ForguncyData.pageInfoStack.length;h=f.target.footerButtonGroup.items;h[0].text=u.YesButtonText;h[1].text=u.NoButtonText;f.target.on("Confirm",function(){s();i()});f.target.on("Cancel",function(){s();r()});f.target.on("Close",function(){s()})},r}(n.CommandBase),f,i,r;n.ConditionCommand=u;f=function(){function t(n,t,i){this.formulaCalcInfo=n;this.bindingInfoList=t;this.commandExecuteInfo=i}return t.prototype.calc=function(t){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(t.param))return null;var i=t.param;return typeof i.result=="undefined"&&(i.result=this.getParamResult(t.param)),i.result},t.prototype.getParamResult=function(t){var i,o,f,u,e,r;if(typeof t.cellLocations!="undefined")return(i=t.cellLocations,i===null||i===undefined||i.length!==1)?null:i===null||i===undefined||i.length!==1?null:n.Common.IsEmpty(i[0].Name)?(o=n.CommandBase.offsetFormulaCellLocation(i[0],this.formulaCalcInfo.rowOffset,this.formulaCalcInfo.columnOffset),n.ForguncyData.pageInfo.formulaManager.getValue(o,this.formulaCalcInfo)):n.ForguncyData.pageInfo.formulaManager.evaluateFormula("="+i[0].Name,this.formulaCalcInfo);if(typeof t.tableData!="undefined"){for(f=n.ListviewBase.getAllListviews(),r=0;r<f.length;r++)if((u=f[r],u.getDataTableName()===t.tableData.TableName&&!u.isGroupMode())&&(e=u.getColIndexOfBindingColumn(t.tableData),e!==-1))return u.getListDataModel().getValue(u.getCurrentRowIndex(),e);for(r=0;r<this.bindingInfoList.length;r++)if(n.Common.isBindingInfoEquals(this.bindingInfoList[r],t.tableData))return this.tableValues[r]}else return typeof t.contextProperty!="undefined"?this.commandExecuteInfo.executingContext[t.contextProperty.ContextInfoType]:typeof t.currentUserProperty!="undefined"?n.UserInfoHelper.getUserInfo(t.currentUserProperty):null},t.prototype.needUnparseValue2=function(t){if(typeof t.param.cellLocations!="undefined"){if(t.param.cellLocations===null||t.param.cellLocations===undefined||t.param.cellLocations.length!==1)return!0;try{var i=n.CommandBase.getCellID(t.param.cellLocations[0],this.formulaCalcInfo,!1);return!i||i.length!==1?!0:n.SetCellPropertyCommand.shouldUnparseText(i[0])}catch(r){return!1}}else return typeof t.param.tableData!="undefined"?!0:typeof t.param.currentUserProperty!="undefined"?!1:!0},t.prototype.equals=function(t,i){return n.Common.isFuzzyEquals(t,i)},t}();n.CommandFactory.registerCommand("Forguncy.Model.ConditionCommand, ServerDesignerCommon",u);i=function(){function n(){this.$type="Forguncy.Model.ConditionTerminateParam, ServerDesignerCommon"}return n}();n.ConditionTerminateParam=i;r=function(t){function i(){var n=t.call(this)||this;return n.EnableProtect=!0,n}return __extends(i,t),i.prototype.execute=function(){return this.CommandExecutingInfo.logHelper.endChild(),n.CommandResult.completed},i}(n.CommandBase);n.ConditionTerminate=r;n.CommandFactory.registerCommand("Forguncy.Model.ConditionTerminateParam, ServerDesignerCommon",r)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.commitEditedTable(this.CommandParam)},i.prototype.commitEditedTable=function(t){var i,r;try{return(i=t.listView,typeof i=="undefined")?n.CommandResult.completed:(r=i.commitEditChange(),t.failOptions===0&&r==="cancel")?n.CommandResult.stop:n.CommandResult.completed}catch(u){alert(u)}},i}(n.CommandBase);n.commitEditTableCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.commitEditTableCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._isPdf=!1,n}return __extends(i,t),i.prototype.execute=function(){if(n.Common.IsEmpty(this.CommandParam))return n.CommandResult.completed;if(n.Platform.isWeChatOrQQBrowser()&&!this._isPdf&&n.Platform.isMobile())return alert(n.ChineseStaticValues.WeChartBrowser_CantDownloadFileWarning),n.CommandResult.completed;this.CommandExecutingInfo.suspend=!0;try{this.export(this.CommandParam)}catch(t){return alert(t),this.CommandExecutingInfo.suspend=!1,n.CommandResult.completed}},i.prototype.export=function(t){var i=this,u,r=this.getExportParam(t),f=((u=n.PageManager.getContainerCell(r.runTimePageName))===null||u===void 0?void 0:u.cellType)instanceof n.RepeaterCellType;if(r.pageName.length>31&&!f)throw r.isExportListview?n.RS.ExportListviewToExcelCommand_PageNameTooLong:n.RS.ExportPageToExcelCommand_PageNameTooLong;n.Common.forguncyPost("Home/GiveParam",r,function(t){try{i._isPdf?n.Common.openWindow(n.ForguncyData.ForguncyRoot+"Home/ExportFile?key="+t):n.Common.download(n.ForguncyData.ForguncyRoot+"Home/ExportFile?key="+t)}finally{n.DelayRefresh.setTimeout(function(){i.CommandExecutingInfo.suspend=!1},500)}},"export",function(){i.CommandExecutingInfo.suspend=!1},function(){i.CommandExecutingInfo.suspend=!1})},i.prototype.getExportParam=function(t){var i=this.getRunTimeNormalPageName(),u=n.ListviewBase.getAllListviews([i]),r=this.getListview(t,i),o=this.getExportFileName(t),f=this.getRepeatInfo(t,r),e={pageName:this.getExportDesignerPageName(t,i),runTimePageName:i,tableName:t.ListViewName,currentRowInfoList:this.CommandExecutingInfo.getCurrentRowInfoCollection().list,exportTableMode:t.ExportTableOverFlowMode,exportExcelPageNameMode:t.ExportExcelPageNameMode,otherName:o,exportExcelListviewNameMode:t.ExportExcelListviewNameMode,isOnlyExportValue:t.TargetPageName?!1:!!t.IsOnlyExportValue,dataModel:t.TargetPageName?null:n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getAllExportDatas(),queryCondition:this.getQueryCondition(),sortInfoCache:this.getSortInfoCache(i),columnFilterQueries:this.getColumnFilterQueries(t.ListViewName?[r]:u),viewQueryConditionFormulaValues:this.getViewQueryConditionFormulaValues(t,u),isPdf:this._isPdf,repeatQureys:f.querys,repeatTableName:f.tableName,AutoFitRowHeight:t.AutoFitRowHeight,ListviewColumns:this.getListviewColumnInfos(r),isExportListview:this.isExportListview(t)};if(this.isExportListview(t)&&e.ListviewColumns.length===0)throw n.RS.ExportListviewNoColumnError;return e},i.prototype.getExportDesignerPageName=function(t,i){return t.TargetPageName?t.TargetPageName:n.PageManager.getDesignerPageName(i,!0)},i.prototype.getRunTimeNormalPageName=function(){var t=this.CommandExecutingInfo.runTimePageName;return n.PageManager.getRunTimeNormalPageName(t)},i.prototype.getListview=function(t,i){if(n.Common.IsEmpty(t.ListViewName))return null;var r=n.ListviewBase.getListview(t.ListViewName,i);if(!r)throw n.RS.listviewNotExisted;return r},i.prototype.getQueryCondition=function(){var t={};for(var i in n.ForguncyData.pageInfo.commandQuerys)t[i]=JSON.stringify(n.ForguncyData.pageInfo.commandQuerys[i]);return t},i.prototype.getViewQueryConditionFormulaValues=function(n,t){if(n.TargetPageName)return null;var i={};return t.forEach(function(n){var t=n.GetQueryConditionFormulaValues();t&&(i[n.getListviewName()]=t)}),i},i.prototype.getSortInfoCache=function(t){for(var r,u,f={},o=n.ListviewBase.getAllListviews([t]),i=0,e=o;i<e.length;i++)(r=e[i],u=n.ForguncyData.pageInfo.getSortInfoWithBinding(r.getLocationString()),u)&&(f[r.getFullListviewName()]=u);return f},i.prototype.getColumnFilterQueries=function(t){var i={};return t.forEach(function(t){var r=n.ForguncyData.pageInfo.getFilterInfoWithBinding(t.getLocationString());r&&(i[t.getFullListviewName()]=r)}),i},i.prototype.getExportFileName=function(t){var i=null,e=this.isExportListview(t)?t.ExportExcelListviewNameMode===1:t.ExportExcelPageNameMode===2,r,u,f;if(e){if(i=this.evaluateFormula(t.NewOtherName),i instanceof GC.Spread.CalcEngine.CalcError)if(this._isPdf)throw n.RS.ExprotToPDFCalFormulaError;else throw n.RS.ExprotToExcelCalFormulaError;}else n.Common.IsEmpty(t.TargetPageName)&&(r=n.PageManager.getContainerCell(this.CommandExecutingInfo.runTimePageName),r&&r.cellType instanceof n.RepeaterCellType&&(u=r.cellType,f=u.listview.getListviewName(),i=f+"-"+(u.getTabIndex(this.CommandExecutingInfo.runTimePageName)+1)));return i},i.prototype.getRepeatInfo=function(t,i){var r,s="",f,u,e,o;if(!n.Common.IsEmpty(t.RowsToExport)&&i)if(r=[],s=i.getDataTableName(),f=i.getListDataModel(),t.RowsToExport===0)for(u=0;u<f.getRowCount();u++)e=f.getRowQuery(u),e&&r.push(e);else{if(o=i.getSelectedRowsData(),o.length===0)throw n.RS.NoSelectedRowError;o.forEach(function(n){n.query&&r.push(n.query)})}return{tableName:s,querys:r}},i.prototype.getListviewColumnInfos=function(t){var u=this,i,r;return t?(i=n.SpreadJSView&&t instanceof n.SpreadJSView,r=t.getExportColmnMetadatas(),r.map(function(n,r){return{index:n.Index,name:n.IsExternal?n.TemplateCell.Element.Name[0]:null,width:i?t.getColumnWidth(r):n.Width,shouldAutofit:u.shouldAutofit(t,i,r),commandID:n.ColumnOptionsCommandID}}).filter(function(n){return n.width!==0})):null},i.prototype.shouldAutofit=function(n,t,i){if(!n.listviewData.getAutoFitColumnWidth())return!1;if(t){var r=n.getColumnWidth(i),u=n.getAutoFitWidth(i);return r===u}return!0},i.prototype.isExportListview=function(n){return!this._isPdf&&!!n.ListViewName},i}(n.CommandBase),i;n.ExportCommand=t;i=function(n){function t(){var t=n.call(this)||this;return t._isPdf=!0,t}return __extends(t,n),t}(t);n.ExportCommandPDF=i;n.CommandFactory.registerCommand("Forguncy.Model.ExportListViewToExcelCommand, ServerDesignerCommon",t);n.CommandFactory.registerCommand("Forguncy.Model.ExportPageToExcelCommand, ServerDesignerCommon",t);n.CommandFactory.registerCommand("Forguncy.Model.ExportPageToPdfCommand, ServerDesignerCommon",i)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.Goto(this.CommandParam)},i.prototype.Goto=function(t){var r,e,f,o,i;try{if(n.Common.IsEmpty(t))return n.CommandResult.completed;r=t.TableName;r||(e=this.CommandExecutingInfo.getCurrentRowInfoCollection(),e.list.length>0&&(r=e.list[0].currentTable));var u=t.TargetRecord,h=n.ListviewBase.getAllListviews(),l=h.length;for(f=0;f<l;f++)if(o=h[f],o.getDataTableName()===r)return this._goToListviewRecord(o,u),n.CommandResult.completed;if((i=this.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(r),i===null)||i.recordID===0&&(u===0||u===2))return this.stopExecuteCommandList(),n.CommandResult.stop;var a=n.ForguncyData.pageInfo.getFilterInfoWithBinding(i.listviewLocation),s=i.currentTable,c=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(s),v=this;return n.Common.forguncyPost("Home/GetTargetRecordData",{bindingInfos:c.pageBindingInfo,targetRecord:u,currentRowInfo:i,queryCommandInfo:n.ForguncyData.pageInfo.commandQuerys[s],sortInfo:n.ForguncyData.pageInfo.getSortInfoWithBinding(i.listviewLocation),columnFilterQueries:a},function(t){if(t&&t.data){var i=v.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(s);if(i){i.query=t.query;switch(u){case 0:i.recordID=Number(i.recordID)-1;break;case 1:i.recordID=Number(i.recordID)+1;break;case 2:i.recordID=0;break;case 3:i.recordID=Number(t.recordCount)-1}i.recordID>=Number(t.recordCount)?i.recordID=Number(t.recordCount)-1:i.recordID<0&&(i.recordID=0);n.ForguncyData.pageInfo.normalCellBindingManager.updateBindingValues(t.data,i.currentTable,c.bindingInfos);n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(i,!1)}}}),n.CommandResult.completed}catch(y){alert(y)}},i.prototype._goToListviewRecord=function(n,t){var r=n.getActualDataLength(),i,u;r<=0||(i=-1,t===2?i=0:t===3?i=r-1:(u=n.getCurrentRowIndex(),t===0?i=u-1:t===1&&(i=u+1)),i>=0&&i<r&&n.selectRow(i))},i}(n.CommandBase);n.GoToRecordCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.GoToRecordCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){try{return i.gotoPage(this.CommandParam,this.CommandExecutingInfo.runTimePageName),n.CommandResult.completed}catch(t){alert(t)}},i.gotoPage=function(t,i){var s=this;if(this.isParamsValid(t)){var u=t.TargetPageIndex,f=t.Limit,e=n.ListviewBase.getListview(t.ListviewName,i),r=e.getLocationString(),o=n.ForguncyData.pageingInfoList.GetInfo(r);n.ForguncyData.pageingInfoList.GetRowCount(r,function(i){var c,h;u=s.ensureIndexByTargetPageKind(u,f,t.targetPageKind,i);c=n.ForguncyData.pageingInfoList.SetPageingInfo(r,u,f);c||(h=n.ForguncyData.pageingInfoList.GetInfo(r),(h.getCurrentPageIndex()!==o.getCurrentPageIndex()||h.getPageCount()!==o.getPageCount())&&e.fillData())})}},i.ensureIndexByTargetPageKind=function(n,t,i,r){switch(i){case 0:n=1;break;case 1:n--;break;case 2:n++;break;case 3:n=Math.ceil(r/t)}return n=Math.min(n,Math.ceil(r/t)),Math.max(n,1)},i.isParamsValid=function(t){return n.Common.IsEmpty(t)?!1:isNaN(t.TargetPageIndex)?!1:isNaN(t.Limit)?!1:!0},i}(n.CommandBase);n.GoToPageCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.GoToPageCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.navigateToPage=function(t,i,r,u,f){var o,e,c,l,h,s,a;return this.CommandExecutingInfo.isMiddelClick?(this.stopExecuteCommandList(),n.CommandResult.stop):(o=t.PageName,t.DeleteCachedQuery&&n.ForguncyData.pageInfo.pageElementManager.cleanQuaryCookie(o),e={historyIndex:history.length-1,ignoreCurrentRowInfoInStoredContext:t.IgnoreTargetPageCachedCurrentRowInfo},this.commandID&&(e.commandID=this.commandID),(t.LoadBindingDataOption===1||t.LoadBindingDataOption===2)&&(e.loadBindingDataOption=t.LoadBindingDataOption),c=null,t&&t.PassValues&&t.PassValues&&t.PassValues.length>0&&(c=t.PassValues),l=this.getPassValues(c,i,r,u),l&&(e.passValues=l,this.logPassValues(l)),this.addCurrentInfosToPageContext(e,o),this.addCrossPageQueryToPageContext(e,o,t.DeleteCachedQuery),this.addCrossSortCommandInfoToPageContext(e,o,t.DeleteCachedQuery),this.addCrossColumnFilterQueriesToPageContext(e,o,t.DeleteCachedQuery),h=null,s="",e.currentRowInfoList===undefined&&e.querys===undefined&&e.sortInfoCache===undefined&&e.columnFilterQueryCache===undefined&&e.passValues===undefined&&e.loadBindingDataOption===undefined&&e.commandID===undefined?s=this.generateUrlWhenQueryIsNull(o):(h=n.Common.JsonUrlSwitch(JSON.stringify(e)),s=this.generateUrlWhenQueryIsNotNull(o,h)),t.IsOpenInNewTab)?this.navigateToUrl(s,!0,h):(f||(n.SessionStorageManager.pageContext=h),window.history.replaceState?(a=n.ForguncyData.pageInfo.pageName,this.navigateByLoadMetadata(a,o,e,s,c)):(window.open(s,"_self"),this.stopExecuteCommandList()),n.CommandResult.stop)},i.prototype.navigateToUrl=function(t,i,r){var u=n.SessionStorageManager.pageContext;return n.SessionStorageManager.pageContext=r,i?(n.Common.openWindow(t),n.SessionStorageManager.pageContext=u,n.CommandResult.completed):(window.open(t,"_self"),this.stopExecuteCommandList(),n.CommandResult.stop)},i.prototype.logPassValues=function(t){var i=this,r=function(t){return t.Name?t.Name:n.FormulaHelper.getReferenceString(t.Row,t.Column)};this.CommandExecutingInfo.logHelper.log(n.RS.Log_NavigateCommand_PassValues);this.CommandExecutingInfo.logHelper.startChild();t.forEach(function(n){var t=JSON.stringify(n.Source)+" -> "+r(n.TargetCell);i.CommandExecutingInfo.logHelper.log(t)});this.CommandExecutingInfo.logHelper.endChild()},i.prototype.generateUrlWhenQueryIsNull=function(t){t===void 0&&(t="");var i="";return i=n.ForguncyData.ForguncyRoot+t,n.ForguncyData.forceMobileChild&&(i=i+"?mobileChild=true"),i},i.prototype.shouldReserveUrlQuery=function(){return n.ForguncyData.GlobalSettings.ReserveUrlQuery||n.SessionStorageManager.isInIframe},i.prototype.generateUrlWhenQueryIsNotNull=function(t,i){var r="";return this.shouldReserveUrlQuery()?(r=n.ForguncyData.ForguncyRoot+t+"?pageContext="+encodeURIComponent(i),n.ForguncyData.forceMobileChild&&(r=r+"&mobileChild=true")):(r=n.ForguncyData.ForguncyRoot+t,n.ForguncyData.forceMobileChild&&(r=r+"?mobileChild=true")),r},i.prototype.getPassValues=function(n,t,i,r){var f,u,e,o,s;if(n){for(f=[],u=0,e=n;u<e.length;u++)o=e[u],o.Source&&(s=this.convertPassValueItem(o,t,i,r),f.push(s));return f}},i.prototype.convertPassValueItem=function(t,i,r,u){var h=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(t.Source,{runTimePageName:this.CommandExecutingInfo.runTimePageName,supportReferToListview:!0,nullAsException:!1,listInfo:u,rowOffset:i,columnOffset:r}),f=t.TargetCell?n.CommandBase.offsetFormulaCellLocation(t.TargetCell,i,r,this.CommandExecutingInfo.runTimePageName):{Name:t.CellName},e={Row:f.Row,Column:f.Column,Name:f.Name},o=this.getTargetRunTimePageName(e,t),s={Source:h,TargetCell:e,TargetRunTimePageName:o};return o===n.StaticValues.RunTimeNormalPage&&delete s.TargetRunTimePageName,s},i.prototype.getTargetRunTimePageName=function(t,i){return n.Common.IsEmpty(i.TargetRunTimePageName)?n.StaticValues.RunTimeNormalPage:i.TargetRunTimePageName},i.prototype.addCurrentInfosToPageContext=function(t,i){var r=this.CommandExecutingInfo.getCurrentRowInfoCollection().list.filter(function(t){return n.Common.isPageContainsTableBinding(i,t.currentTable)||n.Common.isProcessView(t.currentTable)});r&&r.length>0&&(t.currentRowInfoList=r)},i.prototype.addCrossPageQueryToPageContext=function(n,t,i){i||this.addCommandQuerysFromCache(n,t);this.addCommandQuerysFromCommand(n)},i.prototype.addCommandQuerysFromCache=function(t,i){for(var r in n.ForguncyData.pageInfo.commandQuerys)n.Common.isPageContainsTableBinding(i,r)&&(t.querys||(t.querys={}),t.querys[r]=n.ForguncyData.pageInfo.commandQuerys[r])},i.prototype.addCommandQuerysFromCommand=function(t){var i,u,r,f;if(!(this.CommandExecutingInfo.currentCommandList.length<=0))for(i=0,u=this.CommandExecutingInfo.currentCommandList;i<u.length;i++)(r=u[i],r.Disabled||r.$type!=="Forguncy.Model.QueryCommand, ServerDesignerCommon")||(t.querys||(t.querys={}),f=r,t.querys[f.TargetTableName]=n.QueryCommand.getQueryData(f,this.CommandExecutingInfo.runTimePageName))},i.prototype.addCrossSortCommandInfoToPageContext=function(t,i,r){var u,f;if(!r)for(u in n.ForguncyData.pageInfo.sortInfoCache)(f=n.ListviewBase.getListviewByLocationString(u),f)&&n.Common.isPageContainsTableBinding(i,f.getDataTableName())&&(t.sortInfoCache||(t.sortInfoCache={}),t.sortInfoCache[u]=n.ForguncyData.pageInfo.sortInfoCache[u])},i.prototype.addCrossColumnFilterQueriesToPageContext=function(t,i,r){var u,f;if(!r&&n.ForguncyData.pageInfo.columnFilterQueryCache)for(u in n.ForguncyData.pageInfo.columnFilterQueryCache)(f=n.ListviewBase.getListviewByLocationString(u),f)&&n.Common.isPageContainsTableBinding(i,f.getDataTableName())&&(t.columnFilterQueryCache||(t.columnFilterQueryCache={}),t.columnFilterQueryCache[u]=n.ForguncyData.pageInfo.columnFilterQueryCache[u])},i.prototype.navigateByLoadMetadata=function(){throw"Need implement";},i}(n.CommandBase),t,i;n.NavigateCommandBase=r;t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.execute=function(){return this.navigate(this.CommandParam)},r.prototype.navigate=function(t){var r,u;try{if(n.Common.IsEmpty(t))return n.CommandResult.completed;if(r=t.NavigateType,r===i.back)return this.navigateToBack();if(r===i.normal||r===null||r===undefined)return u=this.getNavigateUrl(t),u?this.navigateToUrl(u,t.IsOpenInNewTab,null):t.PageName?this.shouldCancelByPageDirty(t)?n.CommandResult.stop:this.navigateToPage(t,this.CommandParam.rowOffset,this.CommandParam.columnOffset,this.CommandParam.formulaListRowInfo,!1):n.CommandResult.completed}catch(f){alert(f)}},r.prototype.shouldCancelByPageDirty=function(t){return t.IsOpenInNewTab?!1:n.ForguncyData.pageDirtyCheckManager.shouldCancelByPageDirty(!1,!0,null,this.CommandExecutingInfo.logHelper)},r.prototype.getNavigateUrl=function(t){var u=t.ValidUrl,r;if(t.ValueFormula){var i=this.evaluateFormula(t.ValueFormula),f=!1,e={};e.PageName=i;n.Common.forguncyPostSync("Home/PageNameExisted",e,function(n){f=n});f?t.PageName=i:(t.PageName=null,n.Common.IsEmpty(i)||(r=i+"",u=r.toLowerCase().indexOf("servercommand")===0?n.ForguncyData.ForguncyRoot+i:r.indexOf("http://")!==0&&r.indexOf("https://")!==0&&r.indexOf("file://")!==0?"http://"+i:i))}return u},r.prototype.navigateToBack=function(){return n.Common.back(),this.stopExecuteCommandList(),n.CommandResult.stop},r.prototype.navigateByLoadMetadata=function(t,i,r,u){var o,f,e,s;n.ForguncyData.pageInfoStack.length>0&&(t=n.ForguncyData.pageInfoStack[0].pageName);n.ForguncyData.historyIndex=history.length-1;o={pageName:t,pageContext:JSON.stringify(r)};f={};for(e in r)f[e]=r[e];f.historyIndex=history.length;s={pageName:i,pageContext:JSON.stringify(f)};history.replaceState(o,t);u||(u=n.ForguncyData.ForguncyRoot+i);history.pushState(s,i,u);this.stopExecuteCommandList();n.PageBuilder.loadPage(i,f)},r}(r);n.NavigateCommand=t;i=function(){function n(){}return n.back="back",n.normal="normal",n}();n.CommandFactory.registerCommand("Forguncy.Model.NavigateCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.queryCommand(this.CommandExecutingInfo.eventType==="pageloaded",this.CommandParam)},i.prototype.queryCommand=function(t,r){var e,o,u,f;if(n.ForguncyData.pageInfo.commandQuerys[r.TargetTableName]&&t)return n.CommandResult.completed;if(e=n.ListviewBase.getAllListviews(),e.length===0)return n.ForguncyData.pageInfo.commandQuerys[r.TargetTableName]=i.getQueryData(r,this.CommandExecutingInfo.runTimePageName),n.CommandResult.completed;for(o=[],u=0;u<e.length;u++)if(f=e[u],f.getDataTableName()===r.TargetTableName){if(!f.tryCommitValueBeforeQueryOrSort(!0))return n.CommandResult.stop;o.push(f)}for(n.ForguncyData.pageInfo.commandQuerys[r.TargetTableName]=i.getQueryData(r,this.CommandExecutingInfo.runTimePageName),u=0;u<o.length;u++)f=o[u],f.resetToFirstPage(),f.fillData();return $(window).trigger("ForguncyRowCountChanged"),n.CommandResult.completed},i.getQueryData=function(n,t){return{id:n.ID,paramList:this.getCommandQarams(n.Params,t,n)}},i.getCommandQarams=function(t,i,r){var e={},u,f;if(t)for(u=0;u<t.length;u++)f=t[u],e[f]=n.ForguncyData.pageInfo.formulaManager.evaluateFormula(f,{runTimePageName:i,supportReferToListview:!0,nullAsException:!0,listInfo:r.formulaListRowInfo,rowOffset:r.rowOffset,columnOffset:r.columnOffset});return e},i}(n.CommandBase);n.QueryCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.QueryCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var u=this.CommandParam,r=n.ListviewBase.getListview(u.ListViewName,this.CommandExecutingInfo.runTimePageName),t,i;return r?(t=r.getLocationString(),i=n.ForguncyData.pageInfo.sortInfoCache,i[t]&&i[t].sortCommandID&&this.CommandExecutingInfo.eventType==="pageloaded")?n.CommandResult.completed:r.tryCommitValueBeforeQueryOrSort(!0)?(i[t]||(i[t]={}),i[t].sortCommandID=u.ID,r.fillData(u.ID),n.CommandResult.completed):n.CommandResult.stop:n.CommandResult.completed},i}(n.CommandBase);n.SortCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SortCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.sendMailCommand(this.CommandParam)},i.prototype.sendMailCommand=function(t){var r,u,f,e={},i,o;if(t.Params)for(i=0;i<t.Params.length;i++)o=t.Params[i],e[o]=(u=(r=this.evaluateFormula(t.Params[i]))===null||r===void 0?void 0:r.toString())!==null&&u!==void 0?u:"";return n.Common.forguncyPost("Home/SendMailForCommand",{ID:t.ID,Params:e,CurrentRowInfoListStr:this.CommandExecutingInfo.getCurrentRowInfoCollection().list,ConstValue:(f=t.ConstValue)!==null&&f!==void 0?f:null,Keywords:t.Keywords},function(n){n&&alert(n)},t.ID,function(n){n&&alert(n)}),n.CommandResult.completed},i.sendMail=function(t,r,u,f,e,o){var s={From:t,To:r,Content:f,Title:u};i.sendMailInternal(s,null,n.ForguncyData.pageInfo.currentRowInfoCollection,e,o)},i.sendMailMessage=function(t,r,u){i.sendMailInternal(t,null,n.ForguncyData.pageInfo.currentRowInfoCollection,r,u)},i.sendMailInternal=function(t,i,r,u,f){n.Common.forguncyPost("Home/SendMail",{id:t.ID,from:t.From,to:t.To,title:t.Title,cc:t.CC,bcc:t.BCC,skipCalc:t.SkipCalc,enhanced_to:t.EnhancedTo,enhanced_cc:t.EnhancedCC,enhanced_bcc:t.EnhancedBCC,attachments:t.Attachments,content:t.Content,sendAsPlainText:t.SendAsPlainText,tableName:i,priority:t.Priority,currentRowInfoListStr:r.list},function(n){n?f&&f(n):u&&u()})},i}(n.CommandBase);n.SendMailCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SendMailCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.runJavascriptCommand(this.CommandParam)},i.prototype.runJavascriptCommand=function(t){var f=n.Common.IsEmpty(t)?null:t.FunctionNameForGenerate,i,r,u;return n.Common.IsEmpty(f)?n.CommandResult.completed:(i=null,r=n.RunJavaScriptCommandFunctions,r&&(i=r[f]),u=!1,i&&(u=i()),u===!1?n.CommandResult.stop:n.CommandResult.completed)},i}(n.CommandBase);n.RunJavaScriptCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.RunJavaScriptCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this;return(n.Platform.isMobile()||n.Platform.isIOSDevice())&&this.CommandExecutingInfo.eventType==="valuechanged"?(this.CommandExecutingInfo.suspend=!0,n.DelayRefresh.setTimeout(function(){t.showMessageCommand(t.CommandParam);t.CommandExecutingInfo.suspend=!1},100)):this.showMessageCommand(this.CommandParam),n.CommandResult.completed},i.prototype.showMessageCommand=function(n){try{var t=this.getMessage(n);alert(t)}catch(i){alert(i)}},i.prototype.getMessage=function(t){if(n.Common.IsEmpty(t))return"";var i=this.evaluateFormula(t.MessageFormula);return n.Common.IsEmpty(i)?"":i},i}(n.CommandBase);n.ShowMessageCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ShowMessageCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.SubscribeCommand(this.CommandParam)},i.prototype.SubscribeCommand=function(t){var i,r;try{return i=new n.NavigateCommand,i.commandID=t.ID,r={},r.PageName=n.BuiltInPageManager.builtInPages[n.BuiltInPageType.MailSubscriptPage],i.CommandParam=r,i.execute(),n.CommandResult.stop}catch(u){alert(u)}return n.CommandResult.completed},i}(n.CommandBase);n.SubscribeCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SubscribeCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var h=function(){function r(){}return r.prototype.checkCanUpdate=function(n){i.checkCanUpdate(n)},r.prototype.buildRequestData=function(t,r,u){var e=t.CommandParam,f={},s,o;return f.updateType=n.UpdateType.add,s=i.getMasterTableData(t,u),o=i.getDetailTableData(e),f.editedValues=s,o&&(f.detailTableValues=o),f.tableName=e.TableName,f.bindingInfos=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(e.TableName).pageBindingInfo,f},r.prototype.checkRequestDataValid=function(i,r){if(n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues)){alert(n.Common.format(n.RS.noFieldErrorInfo,r.TableName));throw n.CommandResult.stop;}t.checkMasterDetailValues(r.TableName,i.editedValues,i.detailTableValues,r)},r.prototype.prepareBeforePostServer=function(n){i.preparePostServer(n)},r.prototype.completeAfterPostServer=function(n,t,r){i.postProcessing(n,t,r,r.detailTableValues)},r}(),u,f,e,o,s,t,i,r;n.AddRecordCommandExecutor=h;u=function(){function r(){}return r.prototype.checkCanUpdate=function(n){i.checkCanUpdate(n)},r.prototype.buildRequestData=function(r,u,f){var e=r.CommandParam,o={},l,s,h,c;return o.updateType=n.UpdateType.edit,l=i.getMasterTableData(r,f),s=i.getDetailTableData(e),o.editedValues=l,s&&(o.detailTableValues=s),o.bindingInfos=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(e.TableName).pageBindingInfo,o.tableName=e.TableName,h=r.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(e.TableName),h&&(o.query=h.query),o.rowVersion=r.CommandExecutingInfo.getBindingValueVersions()[e.TableName],o.rowsToUpdate=e.RowsToUpdate,e.RowsToUpdate===1?o.rowsToUpdateCondition=n.ConditionHelper.getComputedSqlConditionFormula(e.RowsToUpdateCondition,r.CommandExecutingInfo.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,e.rowOffset,e.columnOffset,e.formulaListRowInfo):e.RowsToUpdate===2&&(o.rowsToUpdateListViewQuery=t.getRowsToUpdateListViewQuery(e,r.CommandExecutingInfo.runTimePageName),c=t.getUpdateSpecialRecordsRowVersion(e,r.CommandExecutingInfo.runTimePageName),c.length>0&&(o.rowsToUpdateListViewRowVersion=c)),o},r.prototype.checkRequestDataValid=function(i,r){if((n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues))&&(n.Common.IsEmpty(i.detailTableValues)||i.detailTableValues.length===0))throw n.CommandResult.completed;if(!i.tableName||!i.query&&!i.rowsToUpdateCondition&&!i.rowsToUpdateListViewQuery)throw n.CommandResult.completed;t.checkMasterDetailValues(r.TableName,i.editedValues,i.detailTableValues,r)},r.prototype.prepareBeforePostServer=function(n){i.preparePostServer(n)},r.prototype.completeAfterPostServer=function(n,t,r){i.postProcessing(n,t,r,r.detailTableValues)},r}();n.EditRecordCommandExecutor=u;f=function(){function r(){}return r.prototype.checkCanUpdate=function(t){var i=t.CommandParam;if(i.ActualShowConfirm&&!confirm(i.ConfirmText))throw n.CommandResult.stop;if(!i.TableName)throw n.CommandResult.stop;},r.prototype.buildRequestData=function(i){var u={},r,f;return u.updateType=n.UpdateType.DELETE,r=i.CommandParam,u.rowsToUpdate=r.RowsToUpdate,r.RowsToUpdate===1?u.rowsToUpdateCondition=n.ConditionHelper.getComputedSqlConditionFormula(r.RowsToUpdateCondition,i.CommandExecutingInfo.runTimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull,r.rowOffset,r.columnOffset,r.formulaListRowInfo):r.RowsToUpdate===2&&(u.rowsToUpdateListViewQuery=t.getRowsToUpdateListViewQuery(r,i.CommandExecutingInfo.runTimePageName)),f=i.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(r.TableName),f&&(u.query=f.query),u.tableName=r.TableName,u},r.prototype.checkRequestDataValid=function(t){if(!t.query&&!t.rowsToUpdateCondition&&!t.rowsToUpdateListViewQuery)throw n.CommandResult.completed;},r.prototype.prepareBeforePostServer=function(n){i.preparePostServer(n)},r.prototype.completeAfterPostServer=function(t,r,u){var f,e;i.postProcessing(t,r,u,null);f=r.CommandParam;t.Success&&f.RowsToUpdate===2&&(e=n.ListviewBase.getListview(f.RowsToUpdateListViewName,r.CommandExecutingInfo.runTimePageName),e&&e.clearSelectionOutOfCurrentRow())},r}();n.DeleteRecordCommandExecutor=f;e=function(){function i(){}return i.prototype.checkCanUpdate=function(n){r.checkCanUpdate(n)},i.prototype.buildRequestData=function(t,i){var f=t.CommandParam,u={},h,o,e,s,c;if(u.updateType=n.UpdateType.add,h=r.getMasterTableData(f,i),o=r.getDetailTableData(f),u.editedValues=h,u.editedValues)for(e=0,s=u.editedValues;e<s.length;e++)c=s[e],c.isEditedAutoID=!0;return o&&(u.detailTableValues=o),u.tableName=f.currentTable,u.bindingInfos=f.columnBindingInfos,f.viewName&&(u.listViewName=f.viewName,u.masterQuery=f.masterQuery),u},i.prototype.checkRequestDataValid=function(i,r){if(n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues)){alert(n.Common.format(n.RS.noFieldErrorInfo,r.currentTable));throw n.CommandResult.stop;}t.checkMasterDetailValues(r.currentTable,i.editedValues,i.detailTableValues,r)},i.prototype.prepareBeforePostServer=function(){},i.prototype.completeAfterPostServer=function(n,t,i,u){r.postProcessing(n,t,i,u,i.detailTableValues)},i}();n.AddRecordListviewExecutor=e;o=function(){function i(){}return i.prototype.checkCanUpdate=function(n){r.checkCanUpdate(n)},i.prototype.buildRequestData=function(t,i){var f=t.CommandParam,u={},o,e;return u.updateType=n.UpdateType.edit,o=r.getMasterTableData(f,i),e=r.getDetailTableData(f),u.editedValues=o,e&&(u.detailTableValues=e),u.tableName=f.currentTable,u.query=f.querys[0],u.rowVersion=f.rowVersion,u.bindingInfos=f.columnBindingInfos,u.rowsToUpdate=f.RowsToUpdate,u},i.prototype.checkRequestDataValid=function(i,r){if((n.Common.IsEmpty(i.editedValues)||n.Common.isObjEmpty(i.editedValues))&&(n.Common.IsEmpty(i.detailTableValues)||i.detailTableValues.length>0))throw n.CommandResult.completed;if(!i.tableName||!i.query)throw n.CommandResult.stop;t.checkMasterDetailValues(r.currentTable,i.editedValues,i.detailTableValues,r)},i.prototype.prepareBeforePostServer=function(){},i.prototype.completeAfterPostServer=function(t,i,u,f){var s,e,o;if(r.postProcessing(t,i,u,f,u.detailTableValues),s=i.CommandParam,e=n.ListviewBase.getDetailListviews(f.getDataTableName()),e)for(o=0;o<e.length;o++)e[o].hasCommitingRow()&&n.Common.isQueryEqual(s.querys[0],e[o].getMasterQuery())&&e[o].fillData()},i}();n.EditRecordListviewExecutor=o;s=function(){function t(){}return t.prototype.checkCanUpdate=function(t){r.checkCanUpdate(t);var i=t.CommandParam;if(i.ActualShowConfirm&&!confirm(i.ConfirmText))throw n.CommandResult.stop;},t.prototype.buildRequestData=function(t){var i={},r;return i.updateType=n.UpdateType.DELETE,r=t.CommandParam,r.querys.length>1?(i.rowsToUpdateListViewQuery=r.querys,i.rowsToUpdate=2):i.query=r.querys[0],i.tableName=r.currentTable,i},t.prototype.checkRequestDataValid=function(t){if(t.rowsToUpdate===2){if(!t.rowsToUpdateListViewQuery||t.rowsToUpdateListViewQuery.length<=0)throw n.CommandResult.completed;}else if(!t.query)throw n.CommandResult.completed;},t.prototype.prepareBeforePostServer=function(){},t.prototype.completeAfterPostServer=function(n,t,i,u){r.postProcessing(n,t,i,u,null)},t}();n.DeleteRecordListviewExecutor=s;t=function(){function t(){}return t.checkCanUpdate=function(t){if(n.Common.isBuiltInDataBaseView(t)){alert(n.RS.UpdateViewFail_Error);throw n.CommandResult.stop;}},t.checkMasterDetailValues=function(t,i,r,u){var f=n.UpdateDataTableCommand.checkCalcErrorValue(t,i,r,u);if(!n.Common.IsEmpty(f)){alert(f);throw n.CommandResult.stop;}},t.getDetailTableData=function(n,t){var i,r,u;if(n.length===0)return null;for(i=[],r=0;r<n.length;r++)u=n[r].buildDetailListviewValues(!0,t),u&&i.push(u);return i.length===0?null:i},t.getRowsToUpdateListViewQuery=function(t,i){var u,r,f;return t.RowsToUpdate!==2?null:(u=n.ListviewBase.getListview(t.RowsToUpdateListViewName,i),!u)?null:(r=[],f=u.getSelectedRowsData(),f.forEach(function(t){n.Common.IsEmpty(t.query)||r.push(t.query)}),r.length===0?null:r)},t.getUpdateSpecialRecordsRowVersion=function(t,i){var r=[],u,f;return t.RowsToUpdate!==2?r:(u=n.ListviewBase.getListview(t.RowsToUpdateListViewName,i),!u)?r:(f=u.getSelectedRowsData(),f.forEach(function(t){n.Common.IsEmpty(t.query)||r.push(t.rowVersion)}),r)},t.postProcessing=function(t,i,r,u){i.removeCommitingRowForDetailListivew(u);var f=i.CommandParam;t.Success&&f.ReloadAfterSucceed&&(n.ForguncyData.getRelatedTableWithForeignKey(r.tableName).forEach(function(t){return n.NormalCellBindingManager.reloadData(t,!0)}),n.ForguncyData.pageInfo.ViewInfoList.map(function(n){return n.ViewName}).forEach(function(t){return n.NormalCellBindingManager.reloadData(t,!0)}));$(window).trigger("ForguncyRowCountChanged")},t}();n.UpdateTableHelper=t;i=function(){function i(){}return i.checkCanUpdate=function(i){var r,u;if(n.Common.IsEmpty(i)||n.Common.IsEmpty(i.CommandParam))throw n.CommandResult.stop;if(r=i.CommandParam,t.checkCanUpdate(r.TableName),r.CheckDataValidation){if(!n.ListviewBase.commitDetailListviewsEdit(r.TableName,!0)){i.CommandExecutingInfo.logHelper.log(n.RS.DataValidationNotPassed);throw n.CommandResult.stop;}if(!i.CommandExecutingInfo.validateResult){u=n.ValidationMananger.validateAllCells();switch(u){case 2:throw n.CommandResult.delay;case 1:i.CommandExecutingInfo.logHelper.log(n.RS.DataValidationNotPassed);throw n.CommandResult.stop;case 0:i.CommandExecutingInfo.validateResult=!0}}}if(r.ActualShowConfirm&&!confirm(r.ConfirmText))throw n.CommandResult.stop;},i.getMasterTableData=function(t,i){var f=[],r=t.CommandParam,u,e,o;if(r.RowsToUpdate===0&&(f=n.ForguncyData.pageInfo.normalCellBindingManager.getEditedBindingValues(r.TableName)),!n.Common.IsEmpty(r.UpdateBindingValues))for(u=0;u<r.UpdateBindingValues.length;u++)e=r.UpdateBindingValues[u],o=t.evaluateFormula(e.Value),f.push({pageName:i,bindingInfo:e.BindingInfo.GUID,value:o===undefined?null:o});return f},i.getDetailTableData=function(i){var r=n.ListviewBase.getAllListviews().filter(function(n){return n.getMasterDataTableName()===i.TableName});return t.getDetailTableData(r,i.UpdateType)},i.preparePostServer=function(t){var u=n.ForguncyData.getRelatedTableWithForeignKey(t.TableName),i=n.ListviewBase.getListviewsRelatedWithTable(t.TableName),r;if(u.forEach(function(t){i=i.concat(n.ListviewBase.getListviewsRelatedWithTable(t))}),t.ReloadAfterSucceed)for(r=0;r<i.length;r++)i[r].showLoadingIndicator()},i.postProcessing=function(r,u,f,e){var o=u.CommandParam,b=n.ForguncyData.getRelatedTableWithForeignKey(o.TableName),h,a,c,y,p,v,w,l,s;r.AutoIDConflictErrorInfo&&(h=r.AutoIDConflictErrorInfo,h.NewID?(a=h.BindingInfo,n.ForguncyData.pageInfo.autoIDManager.updateAutoIDCache(a.TableName,a.ColumnName,h.NewID),n.ForguncyData.pageInfo.normalCellBindingManager.setValueToBindingCell(a,h.NewID),r.Message=n.RS.AutoGeneratedID_Conflict_Error):r.Message=n.RS.AutoGeneratedID_Generate_Error);try{if(r.NothingDid)return;if(r.Success){if(o.ReloadAfterSucceed){for(r.JustInsertedRowInfo&&o.RowsToUpdate===0&&(c=u.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(o.TableName),c?c.query=r.JustInsertedRowInfo.query:c=r.JustInsertedRowInfo,n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfo(c,!1)),(r.RowData||r.UpdatedRowResults instanceof Array)&&(y=n.ForguncyData.pageInfo.normalCellBindingManager.getBindingInfos(o.TableName),r.RowData?n.ForguncyData.pageInfo.normalCellBindingManager.updateBindingValues(r.RowData,o.TableName,y.bindingInfos):(p=u.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(o.TableName),p&&r.UpdatedRowResults.forEach(function(t){t.JustInsertedRowInfo&&n.Common.isQueryEqual(t.JustInsertedRowInfo.query,p.query)&&n.ForguncyData.pageInfo.normalCellBindingManager.updateBindingValues(t.RowData,o.TableName,y.bindingInfos)}))),v=n.ListviewBase.getListviewsRelatedWithTable(o.TableName),s=0;s<v.length;s++)i.RemoveSelectionOfDeletedRows(o,f,v[s]),v[s].fillData();for(n.NormalCellBindingManager.updateTableDataCacheForCombo(o.TableName,!0),n.clearGetTableDataByConditionCache(),n.NormalCellBindingManager.reloadItemsCellType(o.TableName,!1,!0),n.CustomFunction.ODataFunction.clearCache(o.TableName),w=n.ListviewBase.getAllListviews().filter(function(n){return n.getMasterDataTableName()===o.TableName}),s=0;s<w.length;s++)n.CustomFunction.ODataFunction.clearCache(w[s].getDataTableName())}}else{n.Common.IsEmpty(r.Message)||alert(r.Message);throw n.CommandResult.stop;}}finally{if(o.ReloadAfterSucceed)for(l=n.ListviewBase.getListviewsRelatedWithTable(o.TableName),b.forEach(function(t){l=l.concat(n.ListviewBase.getListviewsRelatedWithTable(t))}),s=0;s<l.length;s++)l[s].hiddenLoadingIndicator();t.postProcessing(r,u,f,e)}},i.RemoveSelectionOfDeletedRows=function(t,i,r){if(t.UpdateType===n.UpdateType.DELETE){var u=null;switch(t.RowsToUpdate){case 0:u=i.query;break;case 2:break;default:return}r.clearSelectionCache(u)}},i}();n.UpdateTableByCommandHelper=i;r=function(){function i(){}return i.checkCanUpdate=function(i){if(n.Common.IsEmpty(i)||n.Common.IsEmpty(i.CommandParam))throw n.CommandResult.stop;t.checkCanUpdate(i.CommandParam.currentTable)},i.getMasterTableData=function(t,i){return n.Common.IsEmpty(t)||n.Common.IsEmpty(i)?[]:i.buildEditedRowValue(t.rowIndexes[0],!1,!1,2)},i.getDetailTableData=function(i){var r=n.ListviewBase.getAllListviews().filter(function(n){return n.getMasterDataTableName()===i.currentTable&&n.GetDataCommitMode()===0});return t.getDetailTableData(r,i.UpdateType)},i.postProcessing=function(i,r,u,f,e){var s=r.CommandParam,o;i.AutoIDConflictErrorInfo&&(o=i.AutoIDConflictErrorInfo,o.NewID?(n.ForguncyData.pageInfo.normalCellBindingManager.setValueToBindingCell(o.BindingInfo,o.NewID),i.Message=n.Common.format(n.RS.AutoGeneratedID_Conflict_Listview_Error,o.BindingInfo.ColumnName)):i.Message=n.RS.AutoGeneratedID_Generate_Error);s.rowIndexes.forEach(function(n){return f.handleAfterUpdateDataChange(n,s.UpdateType,i)});f.refreshOtherListViewsBindingToSameTable();t.postProcessing(i,r,u,e)},i}();n.UpdateTableByListviewHelper=r})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.execute=function(){return this.UpdateDataTableCommand(this.CommandParam,this.CommandExecutingInfo.designerPageName)},r.prototype.UpdateDataTableCommand=function(t,i,u,f){var p=this,h,v,e,y;if(u===void 0&&(u=null),f===void 0&&(f=null),t===undefined)return n.CommandResult.stop;var o=r.enumAllUpdateDataTableCommand(this),a=[],s=[],l=[];for(e=0;e<o.length;e++)try{h=o[e].getUpdateDataTableExecutor(u);h.checkCanUpdate(o[e]);v=h.buildRequestData(o[e],u,i);h.checkRequestDataValid(v,o[e].CommandParam);a.push(o[e]);s.push(h);l.push(v)}catch(c){if(c===n.CommandResult.stop)return this.stopExecuteCommandList(),n.CommandResult.stop;if(c===n.CommandResult.delay)return c;if(c===n.CommandResult.completed)continue;else return alert(c),this.stopExecuteCommandList(),n.CommandResult.stop}if(l.length===0)return n.CommandResult.completed;for(e=0;e<s.length;e++)s[e].prepareBeforePostServer(a[e].CommandParam);return y={},y.requestDataList=l,this.commandPost("Home/UpdateMultiDataTable",y,function(t){var r,i;if(t.length===1&&!t[0].Success)for(i=0;i<s.length-1;i++)t.push({Success:!1,ConcurrentError:!1,Message:""});for(r=!1,i=0;i<s.length;i++)try{s[i].completeAfterPostServer(t[i],a[i],l[i],u)}catch(e){if(e===n.CommandResult.stop){r=!0;continue}}r&&p.stopExecuteCommandList();f&&f()}),n.CommandResult.completed},r.prototype.getUpdateDataTableExecutor=function(i){i===void 0&&(i=null);var r=this.CommandParam;return i===null?r.UpdateType===t.add?new n.AddRecordCommandExecutor:r.UpdateType===t.edit?new n.EditRecordCommandExecutor:new n.DeleteRecordCommandExecutor:r.UpdateType===t.add?new n.AddRecordListviewExecutor:r.UpdateType===t.edit?new n.EditRecordListviewExecutor:new n.DeleteRecordListviewExecutor},r.checkCalcErrorValue=function(t,i,u,f){var a,v,y,p,w,tt,h,b,it,k,d,g,o,nt,c,l,e,s;if(i)if(Array.isArray(i)){for(tt=function(i){var s=i.value,u,r,h,e,o,c;if(s instanceof GC.Spread.CalcEngine.CalcError){if(u=i.bindingInfo,r=(a=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells().find(function(n){var t;return((t=n===null||n===void 0?void 0:n.bindingInfo)===null||t===void 0?void 0:t.GUID)===u}))===null||a===void 0?void 0:a.bindingInfo,!r&&f&&(r=(y=(v=f.UpdateBindingValues)===null||v===void 0?void 0:v.find(function(n){var t;return((t=n===null||n===void 0?void 0:n.BindingInfo)===null||t===void 0?void 0:t.GUID)===u}))===null||y===void 0?void 0:y.BindingInfo),!r)for(h=n.ListviewBase.getAllListviews(),e=0,o=h;e<o.length;e++)if(c=o[e],r=(p=c.listviewData)===null||p===void 0?void 0:p.columnBindingInfos.find(function(n){return(n===null||n===void 0?void 0:n.GUID)===u}),r)break;return{value:n.Common.format(n.RS.InvalidValueErrorMessage,s.toString(),(w=r===null||r===void 0?void 0:r.ColumnName)!==null&&w!==void 0?w:"Column",t)}}},h=0,b=i;h<b.length;h++)if(it=b[h],k=tt(it),typeof k=="object")return k.value}else for(d in i)if(g=i[d],g instanceof GC.Spread.CalcEngine.CalcError)return n.Common.format(n.RS.InvalidValueErrorMessage,g.toString(),d,t);if(u)for(o=0;o<u.length;o++){if(nt=u[o].TableName,c=u[o].AddValues,c)for(e=0;e<c.length;e++)if(s=r.checkCalcErrorValue(nt,c[e].values,null,f),!n.Common.IsEmpty(s))return s;if(l=u[o].EditValues,l)for(e=0;e<l.length;e++)if(s=r.checkCalcErrorValue(nt,l[e].values,null,f),!n.Common.IsEmpty(s))return s}},r.prototype.removeCommitingRowForDetailListivew=function(t){var r,u,f,e,i;if(t)for(r=0;r<t.length;r++)if(u=n.ListviewBase.getListviewByCalcSheetName(t[r].calcSheetName),u){if(f=t[r].EditValues,f)for(i=0;i<f.length;i++)u.removeFromCommitingRow(f[i].rowIndex);if(e=t[r].AddValues,e)for(i=0;i<e.length;i++)u.removeFromCommitingRow(e[i].rowIndex)}},r.enumAllUpdateDataTableCommand=function(t){var f=[],i,u;if(n.Common.IsEmpty(t)||n.Common.IsEmpty(t.CommandParam))return f;for(f.push(t),i=t.CommandParam.NextUpdateDataTableCommand;!n.Common.IsEmpty(i);)u=new r,u.CommandExecutingInfo=t.CommandExecutingInfo,u.CommandExecutor=t.CommandExecutor,u.CommandParam=i,i.rowOffset=t.CommandParam.rowOffset,i.columnOffset=t.CommandParam.columnOffset,i.formulaListRowInfo=t.CommandParam.formulaListRowInfo,f.push(u),i=i.NextUpdateDataTableCommand;return f},r}(n.CommandBase),r,u,t;n.UpdateDataTableCommand=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var r,u,i=this.getOperatedListview(),t=this.CommandParam,f,e;if(t.TableName=t.currentTable,f=((r=t.querys)===null||r===void 0?void 0:r.length)===1?t.querys[0]:null,e=((u=t.rowIndexes)===null||u===void 0?void 0:u.length)===1?t.rowIndexes[0]:null,f)if(i&&i.GetDataCommitMode()!==0){if(i)return t.ActualShowConfirm&&!confirm(t.ConfirmText)||!t.currentTable?n.CommandResult.stop:(i.deletedRowQuerys.push(f),i.deleteRow(e,!1))}else return this.UpdateDataTableCommand(t,null);else if(i)return t.ActualShowConfirm&&!confirm(t.ConfirmText)?n.CommandResult.stop:i.deleteRow(e,!0)},i.prototype.getOperatedListview=function(){var i=this.CommandExecutingInfo,u=i.runTimePageName,r=i.commandTrigger,t;return r instanceof n.ListviewBase?r:(t=n.PageManager.getContainerCell(u),t&&t.cellType instanceof n.RepeaterCellType)?t.cellType.listview:null},i.prepareRowInfo=function(n,t){n&&n.forEach(function(n){if(n.$type==="Forguncy.Model.DeleteRecordCommand, ServerDesignerCommon"){var r=n;r.currentTable=t.currentTable;r.querys=[t.query]}else n.$type==="Forguncy.Model.ConditionCommand, ServerDesignerCommon"&&n.ConditionAndCommandPairList.forEach(function(n){return i.prepareRowInfo(n.CommandList,t)})})},i}(i);n.DeleteRecordCommand=r;u=function(){function n(){}return n}();n.UpdateValueItem=u;t=function(){function n(){}return n.edit="edit",n.add="add",n.DELETE="delete",n}();n.UpdateType=t;n.CommandFactory.registerCommand("Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",i);n.CommandFactory.registerCommand("Forguncy.Model.DeleteRecordCommand, ServerDesignerCommon",r)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t;try{if(!this._isPopupPage())return this.CommandParam.HistoryBack?n.Common.back():alert(n.RS.ClosePopupCommand_NotPopup),n.CommandResult.stop;if(t=n.ForguncyData.pageDirtyCheckManager.shouldCancelByPageDirty(!0,!0,null,this.CommandExecutingInfo.logHelper,!1),t)return n.CommandResult.stop;var u=this._getNavigateCommandParam(),r=this.getPassValueOffset(),f=this.navigateToPage(u,r.Row,r.Column,null,!0);return i._popupPassValueInfo.splice(i._popupPassValueInfo.length-1,1),f}catch(e){alert(e)}},i.prototype._isPopupPage=function(){return n.ForguncyData.pageInfoStack.length>0},i.prototype.getParentPagePassValueInfo=function(){return i._popupPassValueInfo[i._popupPassValueInfo.length-1]},i.prototype.getPassValueOffset=function(){var t={Row:0,Column:0},i=this.getParentPagePassValueInfo();return n.Common.IsEmpty(i)||(t.Row=i.rowOffset,t.Column=i.columnOffset),t},i.prototype._getNavigateCommandParam=function(){var i={},r=this.getPassValueItems(),t;return r.length>0&&(i.PassValues=r),t=n.ForguncyData.pageInfoStack,t.length>0&&(i.PageName=t[t.length-1].pageName),i},i.prototype.getPassValueItems=function(){var r,u,f,i,e,t,o;if(!this.CommandParam.PassValueBack)return[];if(r=this.getParentPagePassValueInfo(),u=n.Common.IsEmpty(r)?null:r.items,!u)return[];for(f=[],i=0,e=u;i<e.length;i++)(t=e[i],t&&t.CellName&&!t.TargetCell&&(t.TargetCell={Name:t.CellName}),o=this.convertPassvalueItem(t),o)&&f.push(o);return f},i.prototype.convertPassvalueItem=function(t){if(!t||!t.Source||t.Source.length===0||t.Source[0]!=="="||!t.TargetCell)return null;var i={};if(t.TargetCell.Row>=0&&t.TargetCell.Column>=0)i.Source="="+n.Common.getA1ReferenceString(t.TargetCell.Row,t.TargetCell.Column,t.TargetCell.RowRelative,t.TargetCell.ColumnRelative);else if(t.TargetCell.Name)i.Source="="+t.TargetCell.Name;else return null;return(i.TargetCell=this.translateSourceToTarget(t.Source),!i.TargetCell)?null:(i.TargetRunTimePageName=t.SourceRunTimePageName,i)},i.prototype.translateSourceToTarget=function(t){var r,i;return n.Common.IsEmpty(t)?null:(r=n.FormulaHelper.parse(t),r.type===GC.Spread.CalcEngine.ExpressionType.name)?{Row:-1,Column:-1,Name:r.value}:r.type===GC.Spread.CalcEngine.ExpressionType.reference&&(i=r,n.FormulaHelper.isCellExpression(i))?{Row:i.row,Column:i.column,RowRelative:i.rowRelative,ColumnRelative:i.columnRelative}:null},i.prototype.navigateByLoadMetadata=function(t,i,r){this.stopExecuteCommandList();var u=this.CommandParam;n.PageBuilder.closePopup(r,u.ReloadData,u.PassQueryCondition)},i.addPopupPassValueInfo=function(n,t,r,u){i._popupPassValueInfo.push({items:t,rowOffset:r,columnOffset:u})},i._popupPassValueInfo=[],i}(n.NavigateCommandBase);n.ClosePopupCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ClosePopupCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t,i;try{if(t=this.CommandParam,i=JSON.stringify(t),t.ValueFormula){var r=this.evaluateFormula(t.ValueFormula),f={PageName:r},u=!1;if(n.Common.forguncyPostSync("Home/PageNameExisted",f,function(n){u=n}),u)t.PageName=r;else return n.CommandResult.completed}return t.PageName?(t.PopupDisplayMode===4&&n.Platform.isMobile()&&(history.replaceState({isPopup:!0,commandParam:JSON.stringify({$type:"Forguncy.Model.ClosePopupCommand, ServerDesignerCommon",PassValueBack:!1,DisplayName:n.RS.CommandName_ClosePopupCommand,HistoryBack:!0})},n.ForguncyData.pageInfo.pageName),history.pushState({isPopup:!0,commandParam:i,params:JSON.stringify(__assign({},n.ForguncyData.parameterManager.getCurrent()))},t.PageName)),this.navigateToPage(t,this.CommandParam.rowOffset,this.CommandParam.columnOffset,this.CommandParam.formulaListRowInfo,!0)):n.CommandResult.completed}catch(e){alert(e)}},i.prototype.navigateByLoadMetadata=function(t,i,r,u,f){var e=null,o,h,s,v,w,c,y,l,a,p,b;if(f&&f.length>0)for(e=n.Common.clone(f),o=0;o<e.length;o++)h=this.CommandExecutingInfo.runTimePageName,n.ForguncyData.parameterManager.NeedUpdateReference(e[o].Source)?e[o].Source=n.ForguncyData.parameterManager.ParamToReference(e[o].Source):(s=n.PageManager.getContainerCell(h),(s===null||s===void 0?void 0:s.cellType)instanceof n.UserControlPageCellType&&s.cellType.needUpdateReference(e[o].Source)&&(v=s.cellType.propertyToReference(e[o].Source),e[o].Source=v.referStr,h=v.runTimePageName)),h!==n.StaticValues.RunTimeNormalPage&&(e[o].SourceRunTimePageName=h),e[o].TargetCell=n.CommandBase.offsetFormulaCellLocation(e[o].TargetCell,0,0,this.CommandExecutingInfo.runTimePageName);n.ClosePopupCommand.addPopupPassValueInfo(n.ForguncyData.pageInfo.pageID.toString(),e,this.CommandParam.rowOffset,this.CommandParam.columnOffset);y=this.CommandParam.Placement;y&&(l=n.CommandBase.getCellID(y,this.getDefaultFormulaCalcInfo(),!0),l&&l.length>0&&(a=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(l[0]),a&&a.cellType&&(c=a.cellType.getContainer())));c||(p=this.CommandExecutingInfo.commandTrigger,p instanceof n.CellTypeBase&&(c=p.getContainer()));c&&(w=new n.UI.Anchor(c));b={isShowAsPopup:!0,popupDisplayMode:this.CommandParam.PopupDisplayMode,anchor:w,drawerDirection:this.CommandParam.DrawerDirection,dialogLocation:this.CommandParam.DialogLocation,showDrawerHeader:this.CommandParam.ShowDrawerHeader,closeWhenClickGrayArea:this.CommandParam.CloseWhenClickGrayArea};this.stopExecuteCommandList();n.PageBuilder.loadPage(i,r,b)},i}(n.NavigateCommandBase);n.ShowPopupCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ShowPopupCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){for(var t,u,r,o=this.CommandParam,f=0;f<o.PropertyItemsList.length;f++)if(t=o.PropertyItemsList[f],t){var e=n.FormulaHelper.getCellIds(t.TargetCells,this.getDefaultFormulaCalcInfo()),i=t.PropertyType===4?t.Value:this.evaluateFormula(t.Value),s=i;for(t.PropertyType===undefined&&(t.PropertyType=0),u=0;u<e.length;u++){r=e[u];switch(t.PropertyType){case 2:this.setBackColor(i,r);break;case 3:this.setForeColor(i,r);break;case 0:this.setIsEnabled(i,r);break;case 1:this.setIsVisible(i,r);break;case 4:s=this.setValue(i,r);break;case 5:this.setReadOnly(i,r)}}this.logSetProperty(t,s,e)}return n.CommandResult.completed},i.prototype.logSetProperty=function(t,i,r){var u="";r&&r.length>0&&(u=r.map(function(t){return n.FormulaHelper.getReferenceStringByID(t)}).join(","));t.PropertyTypeDisplay&&(u+="."+t.PropertyTypeDisplay);this.log(u+" = "+i)},i.shouldUnparseText=function(t){var i,f,r,u;return n.PageManager.isNormalCellID(t)?(i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t),!i)?!1:(f=!i.cellType||i.cellType.allowFormatValue(),i.formatString!=="@"&&f?!0:!1):(r=n.Common.parseIDStr(t),u=n.ListviewBase.getListviewByCalcSheetName(r.suffix),u)?!u.isTextFormat(r.col):!0},i.prototype.setValue=function(t,r){var u,f;return t===i.AUTO_GENERATED_ID_VALUE?(u=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(r),u&&(f=u.bindingInfo,f&&!f.RelationBinding&&(t=this.getAutoGeneratedID(u)))):t=n.ConditionHelper.calcValue(t,this.getDefaultFormulaCalcInfo(),i.shouldUnparseText(r)),n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(r,{newValue:t},5),t},i.prototype.getAutoGeneratedID=function(t){var i,r;return t?(i=t.bindingInfo,!i||i.RelationBinding)?null:(r=null,n.ForguncyData.pageInfo.autoIDManager.getAutoGeneratedID(i.TableName,i.ColumnName,!1,function(n){r=n}),r):null},i.prototype.setIsEnabled=function(n,t){n&&(n+"").toLowerCase()==="false"&&(n=!1);var i=this.getCell(t);i&&(n?i.enable():i.disable())},i.prototype.setIsVisible=function(n,t){var i=this.getCell(t);i&&i.setVisible(n)},i.prototype.setReadOnly=function(n,t){var i=this.getCell(t);i&&i.setReadOnly(n)},i.prototype.setBackColor=function(n,t){var i=this.getCell(t);i&&i.setBackColor(n)},i.prototype.setForeColor=function(n,t){var i=this.getCell(t);i&&i.setForeColor(n)},i.prototype.getCell=function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(t);return i?i:null},i.AUTO_GENERATED_ID_VALUE="%AutoGeneratedID%",i}(n.CommandBase);n.SetCellPropertyCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SetCellPropertyCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){for(var t,u,e,i,f=this.CommandParam,r=0;r<f.PropertyItemsList.length;r++)t=f.PropertyItemsList[r],t&&(u=this.evaluateFormula(t.Value),e=(i=t.PropertyType)!==null&&i!==void 0?i:0,e===0&&(this.setRowVisibility(u,t.Location),this.setColumnVisibility(u,t.Location)));return n.CommandResult.completed},i.prototype.setRowVisibility=function(t,i){var u=this,r=n.FormulaHelper.getRangeLocations(i,this.CommandExecutingInfo.runTimePageName);r===null||r===void 0?void 0:r.forEach(function(i){var r;if(i&&!(i.Row<0)){var f=n.ForguncyData.pageInfo.pageLayouts[i.PageID],e=i.Row,o=i.EndRow;for(r=e;r<=o;r++)f.changeRowVisibility(r,t);u.updateLayout(f)}})},i.prototype.setColumnVisibility=function(t,i){var u=this,r=n.FormulaHelper.getRangeLocations(i,this.CommandExecutingInfo.runTimePageName);r===null||r===void 0?void 0:r.forEach(function(i){var r;if(i&&!(i.Column<0)){var f=n.ForguncyData.pageInfo.pageLayouts[i.PageID],e=i.Column,o=i.EndColumn;for(r=e;r<=o;r++)f.changeColumnVisibility(r,t);u.updateLayout(f)}})},i.prototype.updateLayout=function(t){var r,i=(r=n.ForguncyData.pageInfo)===null||r===void 0?void 0:r.dialogUI,u=(i===null||i===void 0?void 0:i.target.visibility)===!1;u?t.lazyLocateElements(function(){i.centerWhenOpen=i.target.centerWhenOpen}):t.lazyLocateElements()},i}(n.CommandBase);n.SetRowColumnLayoutCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SetRowColumnLayoutCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.CommandExecutingInfo.eventType==="pageloaded"?this.DelayPrint(function(){return n.PageBuilder.pageCover.css("display")==="none"}):this.PrintImmediatly(),n.CommandResult.completed},i.prototype.DelayPrint=function(n){var t=this;setTimeout(function(){n()?t.PrintImmediatly():t.DelayPrint(n)},50)},i.prototype.PrintImmediatly=function(){var t,r,u;n.DelayRefresh.RunNow();i.IsPrinting=!0;try{return this.Print()}finally{if(i.IsPrinting=!1,t=n.ListviewBase.getAllListviews(),t)for(r=0;r<t.length;r++)n.SpreadJSView&&t[r]instanceof n.SpreadJSView&&(u=t[r],u.refresh())}},i.prototype.Print=function(){var h=[],c=[],r=n.ListviewBase.getAllListviews(),u,o,i,e,t,f;if(r)for(t=0;t<r.length;t++)u={ShowHorizontal:!1,ShowVertical:!1},o=!1,n.SpreadJSView&&r[t]instanceof n.SpreadJSView&&(i=r[t],o=i.hideSelection(),o||i.hideSelection(!0),i.showHorizontalScrollBar()&&(i.showHorizontalScrollBar(!1),u.ShowHorizontal=!0),i.showVerticalScrollBar()&&(i.showVerticalScrollBar(!1),u.ShowVertical=!0),i.refresh()),c.push(o),h.push(u),r[t].hiddenLoadingIndicator(!0);for(e=n.ForguncyData.pageInfo.pageElementManager.cells.getAllCells(),t=0;t<e.length;t++)f=e[t].cellType,f&&f.enterPrintMode();var l=this.CommandParam,s=this.CommandExecutingInfo.commandTrigger,a=!1;if(l.HiddenPrintElement===!0&&s&&(s.setVisible(!1),a=!0),window.print(),r)for(t=0;t<r.length;t++)if(n.SpreadJSView&&r[t]instanceof n.SpreadJSView){var u=h[t],v=c[t],i=r[t];u.ShowHorizontal&&i.showHorizontalScrollBar(!0);u.ShowVertical&&i.showVerticalScrollBar(!0);v||i.hideSelection(!1);i.refresh()}for(t=0;t<e.length;t++)f=e[t].cellType,f&&f.quitPrintMode();return l.HiddenPrintElement===!0&&s&&a&&s.setVisible(!0),n.CommandResult.completed},i}(n.CommandBase),i;n.PrintCommand=t;i=function(){function n(){}return n}();n.CommandFactory.registerCommand("Forguncy.Model.PrintCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this,i=this.CommandParam.operation,r=i;if(r.option===1)return t.Logout(r.param);switch(i){case 0:return t.logIn();case 3:return t.ForgotPassword();case 7:return t.ChangeUserProfile();case 4:return t.ChangePassword();case 5:return t.CancelChangePassword();case 6:return t.ResetPassword();case 2:return n.ForguncyData.SecurityProviderValidateType===2||n.ForguncyData.AuthenticationType===1?t.WindowsChangeUser():t.Logout();case 8:return t.SubscribeMeByMail();case 9:return t.goToMFAVerifyPage();case 10:return t.VerifyMFACode();case 11:return t.changeMFAStatus(!0);case 12:return t.changeMFAStatus(!1);default:return n.CommandResult.completed}},i.prototype.SubscribeMeByMail=function(){if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;var i=n.Common.getPageContext(),t={};return t.commandID=i.commandID,t.setting=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("MailSubscription_Choice"),n.Common.forguncyPost("Home/AddSubscription",t,function(t){n.Common.IsEmpty(t)||n.Common.back()}),n.CommandResult.completed},i.prototype._forceCommitValue=function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getForguncyattrCell(t);i&&i.cellType&&i.cellType.commitValue()},i.prototype.logIn=function(){var t=this;if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;n.Platform.isMobile()&&(this._forceCommitValue("LogIn_Username"),this._forceCommitValue("LogIn_Password"));var r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("LogIn_Username"),u=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("LogIn_Password"),i=$("[forguncyattr=LogIn_RememberMe]")[0],f=i&&i.checked;return this.loginByRSA(r,u,f,function(i){if(i&&i.Result)if(i.Properties&&i.Properties["to-page"]){var r=n.BuiltInPageManager.builtInPages[i.Properties["to-page"]];r==n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangePassword]&&alert(n.RS.NeedChangeOriginPassword);t.goToReturnURL(r)}else t.goToReturnURL()},function(t){var i=JSON.parse(t.responseText);n.Common.IsEmpty(i.Message)?alert(n.RS.UserNameOrPasswordIsIncorrect):alert(i.Message)}),n.CommandResult.completed},i.prototype.goToReturnURL=function(t){if(n.Common.IsEmpty(t)){var i=n.Common.GetUrlQuery("ReturnUrl");t=i?i:n.ForguncyData.pageInfo.ReturnUrl}location.href=t?location.origin+n.ForguncyData.ForguncyRoot+t+this.removeURLParameter(location.search,"ReturnUrl"):location.origin+n.ForguncyData.ForguncyRoot},i.prototype.removeURLParameter=function(n,t){var u=n.split("?"),f,i,r;if(u.length>=2){for(f=encodeURIComponent(t)+"=",i=u[1].split("&"),r=i.length;r--;r>0)i[r].lastIndexOf(f,0)!==-1&&i.splice(r,1);return u[0]+(i.length>0?"?"+i.join("&"):"")}return n},i.prototype.Logout=function(t,i,r){if(n.ForguncyData.pageDirtyCheckManager.removeDirtyStatus(),n.ForguncyData.AuthenticationType===4&&n.ForguncyData.SecurityProviderValidateType===3)location.href=r?n.ForguncyData.ForguncyRoot+"5528EDA2-BD0D-4340-A891-92B9760C458E/"+n.ForguncyData.pageInfo.pageName:n.ForguncyData.ForguncyRoot+"38969272-D69D-4812-B2B0-643EE98215D8";else return n.Common.forguncyPost("Account/Logout",null,function(){if(i&&i(),t&&t.NavigateWhenLogoutMode!==n.NavigateWhenLogoutMode.KeepCurrentPage)t.NavigateWhenLogoutMode===n.NavigateWhenLogoutMode.GoToHomePage?location.href=location.origin+n.ForguncyData.ForguncyRoot:t.NavigateWhenLogoutMode===n.NavigateWhenLogoutMode.GoToURL?location.href=t.Url:t.NavigateWhenLogoutMode===n.NavigateWhenLogoutMode.GoToSpecificPage&&(location.href=location.origin+n.ForguncyData.ForguncyRoot+t.PageName);else{var r=n.ForguncyData.pageInfo.ReturnUrl;r||(r=n.Common.GetUrlQuery("ReturnUrl"));r?location.pathname=n.ForguncyData.ForguncyRoot+r:location.reload()}}),n.CommandResult.completed},i.prototype.WindowsChangeUser=function(){var t=n.ForguncyData.pageInfo.noPermissionPage?n.ForguncyData.pageInfo.noPermissionPage:n.ForguncyData.pageInfo.ReturnUrl;if(t)return n.Common.forguncyPost("Home/LoginByOtherWindowsUser",{pageName:t},function(){location.pathname=n.ForguncyData.ForguncyRoot+n.ForguncyData.pageInfo.ReturnUrl}),n.CommandResult.completed},i.prototype.ForgotPassword=function(){if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;var t=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ForgotPassword_UserOrEmail");return n.Common.forguncyPost("Account/ForgotPassword",{userNameOrEmail:t},function(t){t&&t.Result?n.PageBuilder.loadPage(n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ResetPasswordMailSended]):t.Message?alert(t.Message):alert(n.RS.Failed)}),n.CommandResult.completed},i.prototype.ChangeUserProfile=function(){if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;var t=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangeProfile_Picture"),i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangeProfile_FullName"),r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangeProfile_Email");return n.Common.forguncyPost("Account/ChangeUserProfile",{email:r,fullName:i,image:t},function(t){t&&t.Result?(alert(n.RS.Success),n.ForguncyData.UserProfileAvatorVersion=Math.floor(Math.random()*1e8).toString(),n.Common.back()):t.Message?alert(t.Message):alert(n.RS.Failed)}),n.CommandResult.completed},i.prototype.ChangePassword=function(){var u=this;if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;var f=$("[forguncyattr=ChangePassword_ConfirmPassword]"),e=$("[forguncyattr=ChangePassword_NewPassword]"),i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangePassword_OldPassword"),t=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangePassword_NewPassword"),r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ChangePassword_ConfirmPassword");if(t!==r){n.ValidationTooltipHelper.showTooltip(f[0],n.RS.PasswordIsNotSame);return}if(t==i){n.ValidationTooltipHelper.showTooltip(e[0],n.RS.PasswordNotChange);return}return this.changePasswordByRSA(t,i,r,function(t){t&&t.Result?(alert(n.RS.Success),t.Properties&&t.Properties["and-login"]?u.goToReturnURL():n.Common.back()):t.Message?alert(t.Message):alert(n.RS.Failed)}),n.CommandResult.completed},i.prototype.CancelChangePassword=function(){return n.Common.forguncyPost("Account/CancelChangePassword",null,function(t){t&&t.Properties&&t.Properties["to-page"]?n.PageBuilder.loadPage(n.BuiltInPageManager.builtInPages[t.Properties["to-page"]]):window.history.back()}),n.CommandResult.completed},i.prototype.ResetPassword=function(){var t;if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;var u=$("[forguncyattr=ResetPassword_ConfirmPassword]"),i=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ResetPassword_NewPassword"),r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("ResetPassword_ConfirmPassword");if(i!==r){n.ValidationTooltipHelper.showTooltip(u[0],n.RS.PasswordIsNotSame);return}if(t=n.Common.GetUrlQuery("token"),!t){alert(n.RS.TokenIsInvalid);return}return this.resetPasswordByRSA(t,i,r,function(t){t&&t.Result?(alert(n.RS.ResetPasswordSuccess),n.PageBuilder.loadPage(n.BuiltInPageManager.builtInPages[n.BuiltInPageType.Login])):t.Message?alert(t.Message):alert(n.RS.Failed)}),n.CommandResult.completed},i.prototype.loginByRSA=function(t,i,r,u,f){n.Security.SecurityManager.requestRSAPublicKey(function(e){n.Security.Encrypter.encrypt(i.toString(),e.Value,function(i){n.Common.forguncyPost("Account/Login",{userName:t,password:i,rememberMe:!!r,keyId:e.Id,deviceInfo:n.Common.getMFADeviceInfo()},function(t,i,r){n.ForguncyData.pageDirtyCheckManager.removeDirtyStatus();u===null||u===void 0?void 0:u(t,i,r)},null,f)})})},i.prototype.resetPasswordByRSA=function(t,i,r,u){n.Security.SecurityManager.requestRSAPublicKey(function(f){var e="",o="",s=n.Security.Encrypter.encrypt(i.toString(),f.Value,function(n){e=n}),h=n.Security.Encrypter.encrypt(r.toString(),f.Value,function(n){o=n});$.when(s,h).done(function(){n.Common.forguncyPost("Account/ResetPassword",{token:t,newPassword:e,confirmPassword:o,keyId:f.Id},u)})})},i.prototype.changePasswordByRSA=function(t,i,r,u){var f="",e="",o="";n.Security.SecurityManager.requestRSAPublicKey(function(s){var h=n.Security.Encrypter.encrypt(t.toString(),s.Value,function(n){return f=n}),c=n.Security.Encrypter.encrypt(i.toString(),s.Value,function(n){return e=n}),l=n.Security.Encrypter.encrypt(r.toString(),s.Value,function(n){return o=n});$.when(h,c,l).done(function(){n.Common.forguncyPost("Account/ChangePassword",{newPassword:f,oldPassword:e,confirmPassword:o,keyId:s.Id},u)})})},i.prototype.goToMFAVerifyPage=function(){return this.goToReturnURL(n.BuiltInPageManager.builtInPages[n.BuiltInPageType.MFA_VerifyCodePage]),n.Common.setCookie("HasMFASecret=1"),n.CommandResult.completed},i.prototype.VerifyMFACode=function(){var i=this;if(n.ValidationMananger.validateAllCells()!==0)return n.CommandResult.stop;var r=n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("MFA_VerifyCode_Inputbox"),t=!!n.ForguncyData.pageInfo.pageElementManager.cells.getValueOfForguncyattrCell("MFA_VerifyCode_TrustDevice"),u=t?n.Common.getMFADeviceInfo():null;n.Common.forguncyPost("Account/VerifyMFACode",{code:r,trustDevice:t,deviceInfo:u},function(t){var r,u;t.Result?(n.Common.removeCookie("HasMFASecret=0"),localStorage.setItem(n.Common.mfaDeviceLocalStorageKey,(r=t.Properties.key)!==null&&r!==void 0?r:n.Common.mfaDeviceLocalStorageKey),u=n.BuiltInPageManager.builtInPages[t.Properties["to-page"]],u==n.BuiltInPageManager.builtInPages[n.BuiltInPageType.ChangePassword]&&alert(n.RS.NeedChangeOriginPassword),i.goToReturnURL(u)):alert(t.Message)})},i.prototype.changeMFAStatus=function(t){var i=t?n.RS.ChangeCurrentUserMFA_Enable_Confirm:n.RS.ChangeCurrentUserMFA_Disable_Confirm;return confirm(i)!==!0?n.CommandResult.completed:n.ForguncyData.pageDirtyCheckManager.shouldCancelByPageDirty(!1,!0,"changeMFAStatus")?n.CommandResult.completed:(n.Common.forguncyPost("Account/ChangeCurrentUserMFAEnabled",{isEnabled:t},function(i){i.Result||alert(t?n.RS.ChangeCurrentUserMFA_Enable_Fail:n.RS.ChangeCurrentUserMFA_Disable_Fail);location.reload()}),n.CommandResult.completed)},i}(n.CommandBase);n.UserManagerCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.UserManagerCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this.CommandParam,i=this.getLoopCategory(t.LoopInfo);switch(i){case 2:this.LoopByCountOrArray(t);break;case 0:this.LoopByListview(t);break;case 1:this.LoopByCell(t)}return n.CommandResult.completed},i.prototype.getLoopCategory=function(n){return n.$type.indexOf("CountLoopInfo")!==-1?2:n.$type.indexOf("ListviewKindLoopInfo")!==-1?0:n.$type.indexOf("CellLoopInfo")!==-1?1:3},i.prototype.LoopByCountOrArray=function(t){var r=this.getLoopCountOrArray(t.LoopInfo),u,i;if(r instanceof Array)for(u=this.evaluateFormula(t.LoopInfo.LoopItemParamName),i=r.length-1;i>=0;i--)this.addToCommandList(t.CommandList),n.Common.IsEmpty(u)||this.addToCommandList([{$type:"Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",ParameterName:u+"",ParameterValue:r[i]}]);else for(i=0;i<r;i++)this.addToCommandList(t.CommandList)},i.prototype.getLoopCountOrArray=function(n){var i=this.evaluateFormula(n.LoopCount),r,t;return i instanceof Array?i:(r=typeof i,r!=="string"&&r!=="number")?0:(t=Number(i),!isFinite(t)||isNaN(t)||t<=0)?0:Number(t.toFixed(0))},i.prototype.LoopByListview=function(t){var o=t.LoopInfo.ListviewName,s=t.LoopInfo.ListViewLoopMode,e=n.ListviewBase.getListview(o,this.CommandExecutingInfo.runTimePageName),f,i,r,u;(s===1&&n.Common.IsEmpty(t.LoopInfo.LastLoopIndex)&&(t.LoopInfo.SelectedRowsCache=e.getSelectedRowsIndexes()),f=this._getListViewLoopCount(t),f<=0)||(i=0,n.Common.IsEmpty(t.LoopInfo.LastLoopIndex)||(i=t.LoopInfo.LastLoopIndex+1),i>=f)||(r=n.Common.clone(this.CommandParam),r.$type="Forguncy.Model.LoopCommand, ServerDesignerCommon",r.DisplayName=null,r.LoopInfo.LastLoopIndex=i,this.addToCommandList([r]),u=null,u=this.CommandParam.formulaListRowInfo?n.Common.clone(this.CommandParam.formulaListRowInfo):{},u[e.getCalcSheetName()]=this._getCurrentLoopRowIndex(t,i),this.addToCommandList(t.CommandList,null,null,u))},i.prototype.LoopByCell=function(t){for(var r,u,f=n.Common.IsEmpty(t.rowOffset)?0:t.rowOffset,e=n.Common.IsEmpty(t.columnOffset)?0:t.columnOffset,o=t.LoopInfo.OffsetList.length,i=o-1;i>=0;i--)r=n.Common.IsEmpty(t.LoopInfo.OffsetList[i].Row)?-1:t.LoopInfo.OffsetList[i].Row,u=n.Common.IsEmpty(t.LoopInfo.OffsetList[i].Column)?-1:t.LoopInfo.OffsetList[i].Column,this.addToCommandList(t.CommandList,f+r,e+u)},i.prototype._getListViewLoopCount=function(t){if(t.LoopInfo.ListViewLoopMode===0){var i=n.ForguncyData.pageInfo.dataModel.getListDataByListviewName(t.LoopInfo.ListviewName,this.CommandExecutingInfo.runTimePageName);return i?i.getRowCount():0}return t.LoopInfo.SelectedRowsCache.length},i.prototype._getCurrentLoopRowIndex=function(n,t){return n.LoopInfo.ListViewLoopMode===0?t:n.LoopInfo.SelectedRowsCache[t]},i}(n.CommandBase);n.LoopCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.LoopCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this.CommandExecutingInfo.currentCommandList,r=t.findIndex(function(t){return t instanceof n.CommandTerminateParam&&t.command instanceof n.LoopCommand}),u,i;if(r>-1){for(u=[],i=0;i<r;i++)t[i].$type==="Forguncy.Model.CommandTerminateParam, ServerDesignerCommon"&&u.push(t[i]);t.splice(0,r);t.unshift.apply(t,u)}return n.CommandResult.completed},i}(n.CommandBase);n.EndLoopCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.EndLoopCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.execute=function(){return __awaiter(this,void 0,void 0,function(){var i,t=this;return __generator(this,function(){if(i=this.initProperties(),!i)return[2,n.CommandResult.completed];if(this._param.UpdateListviewCommandRunTimeMethodSetting)return this._listview instanceof n.SpreadJSView&&this._listview.isWaitForRefresh?[2,new Promise(function(i){var r=setInterval(function(){t._listview.isWaitForRefresh||(clearInterval(r),n.RuntimeMethedExecuteHelper.execute(new n.ListView(t._listview,!1),t._param.UpdateListviewCommandRunTimeMethodSetting,t),i(n.CommandResult.completed))},50)})]:(n.RuntimeMethedExecuteHelper.execute(new n.ListView(this._listview,!1),this._param.UpdateListviewCommandRunTimeMethodSetting,this),[2,n.CommandResult.completed]);switch(this._param.UpdateType){case 0:return[2,this.edit()];case 1:return[2,this.add()];case 4:return[2,this.insert(!1)];case 5:return[2,this.insert(!0)];case 2:return[2,this.delete()];case 3:return[2,r.updateListview(this._listview,function(n){t.updateListviewCallBack(t._listview,n)},function(){t.stopExecuteCommandList()})];case 6:return[2,this.clearSort()];default:return[2,n.CommandResult.completed]}return[2]})})},r.prototype.initProperties=function(){return(this._param=this.CommandParam,!this._param)?!1:(this._listview=n.ListviewBase.getListview(this._param.ListviewName,this.CommandExecutingInfo.runTimePageName),!this._listview)?!1:(this._dataModel=this._listview.getListDataModel(),!this._dataModel)?!1:!0},r.prototype.edit=function(){var s=this._listview.stopEditingActiveCell(!0),t,i,e,r,o;if(!s)return n.CommandResult.stop;if(!this._param.UpdateValues)return n.CommandResult.completed;var f=this.getUpdateRowIndexList(),h=this.getDefaultFormulaCalcInfo(),u=this._param.UpdateValues;for(t=0;t<u.length;t++)if(i=n.Common.getColumnIndex(u[t].Column,this._listview),i!==-1)for(e=n.ConditionHelper.calcValue(u[t].Value,h,!this._listview.isTextFormat(i)),r=f.length-1;r>=0;r--)o=f[r],this._dataModel.setValue(o,i,e,5);return n.CommandResult.completed},r.prototype.add=function(){var i=this._listview.stopEditingActiveCell(!0),t;return i?(t=this.getNewRowData(),this._listview.addNewRow(t),n.CommandResult.completed):n.CommandResult.stop},r.prototype.getNewRowData=function(){var e=this.getDefaultFormulaCalcInfo(),f=[],i=this._param.UpdateValues,t,r,u;if(i)for(t=0;t<i.length;t++)(r=n.Common.getColumnIndex(i[t].Column,this._listview),r!==-1)&&(u=n.ConditionHelper.calcValue(i[t].Value,e,!this._listview.isTextFormat(r)),u!==null)&&(f[r]=u);return f},r.prototype.insert=function(t){var f=this._listview.stopEditingActiveCell(!0),i;if(!f)return n.CommandResult.stop;if(i=this.getUpdateRowIndexList(),!i||i.length<=0)return n.CommandResult.completed;i.sort(function(n,t){return n-t});var r=this._param.InsertInRear?i.slice(-1)[0]+1:i[0],e=i.length,u=this.getNewRowData();return t?this._listview.duplicateRow(r,i,u,!1):this._listview.insertRow(r,e,u,!0,!1),n.CommandResult.completed},r.prototype.delete=function(){var r=this._listview.stopEditingActiveCell(!0),i,t;if(!r)return n.CommandResult.stop;for(i=this.getUpdateRowIndexList(),t=i.length-1;t>=0;t--)this._listview.deleteRowByJavascriptAPI(i[t]);return this._param.UpdateRowType===0&&this._listview.clearSelectionOutOfCurrentRow(),n.CommandResult.completed},r.prototype.getUpdateRowIndexList=function(){switch(this._param.UpdateRowType){case 1:return this.getRowsByCondition();case 0:return this.getSelectedRows();case 2:return this.getAllRows();case 3:return this.getCurrentRow();default:return[]}},r.prototype.getSelectedRows=function(){return this._listview.getSelectedRowsIndexes()},r.prototype.getRowsByCondition=function(){var t;if(!this._param.SpecifiedRowCondition)return[];var f=this._dataModel.getRowCount(),e=this.getDefaultFormulaCalcInfo(),r=new i(this._listview,this._dataModel,this.CommandExecutingInfo.cacheDataHelper),o=n.ConditionHelper.handlingConditionValue(this._param.SpecifiedRowCondition,e,r),u=[];for(t=0;t<f;t++)r.rowIndex=t,n.ConditionHelper.excuteConditionResult(o,r)&&u.push(t);return u},r.prototype.getAllRows=function(){for(var i=this._dataModel.getRowCount(),t=[],n=0;n<i;n++)t.push(n);return t},r.prototype.getCurrentRow=function(){if(this.CommandParam.formulaListRowInfo){var t=this.CommandParam.formulaListRowInfo[this._listview.getCalcSheetName()];if(!n.Common.IsEmpty(t))return[t]}return[this._listview.getCurrentRowIndex()]},r.updateListview=function(t,i,u){if(!r.isListviewAllowUpdate(t))return n.CommandResult.stop;var f=r.getEditedValues(t);return f?(t.showLoadingIndicator(),t.GetDataValidationTime()===1&&!t.validateCellValues(f))?(t.hiddenLoadingIndicator(),n.CommandResult.stop):(t.updateMultiRows(f,i,function(){alert(n.RS.Commit_FailMessage);t.hiddenLoadingIndicator();u()}),n.CommandResult.completed):(i(null),n.CommandResult.completed)},r.isListviewAllowUpdate=function(t){var i=t.stopEditingActiveCell(!0);return i?t.isGroupMode()?(alert(n.RS.UpdateListviewCommand_Listview_Group),!1):!t.isMasterTable()&&!t.getMasterQuery()?(alert(n.RS.UpdateListviewCommand_Listview_DetailListview),!1):t.bindingTableCanEdit()?n.ValidationMananger.validateRepeaterCells(t,!0)===1?!1:!0:(alert(n.RS.UpdateListViewFail_BindingTableCantEditError),!1):!1},r.getEditedValues=function(t){var i=t.buildDetailListviewValues(!1),r;return i?(r=n.UpdateDataTableCommand.checkCalcErrorValue(null,null,[i]),!n.Common.IsEmpty(r))?(alert(r),null):i:null},r.prototype.updateListviewCallBack=function(t,i){if(!t.hasDestroyed()&&i){var r=i;if(r.Message){t.hiddenLoadingIndicator();this.stopExecuteCommandList();alert(r.Message);return}n.NormalCellBindingManager.reloadData(t.getDataTableName(),!0);n.ForguncyData.getRelatedTableWithForeignKey(t.getDataTableName()).forEach(function(t){n.NormalCellBindingManager.reloadData(t,!0)});n.ForguncyData.pageInfo.ViewInfoList.map(function(n){return n.ViewName}).forEach(function(t){return n.NormalCellBindingManager.reloadData(t,!0)})}},r.prototype.clearSort=function(){if(!this._listview.tryCommitValueBeforeQueryOrSort(!0))return n.CommandResult.stop;var t=this._listview.getLocationString();return n.ForguncyData.pageInfo.sortInfoCache[t]=undefined,this._listview.fillData(),n.CommandResult.completed},r}(n.CommandBase),i;n.UpdateListviewCommand=t;i=function(){function t(i,r,u){this._listview=i;this._dataModel=r;this._columnIndexCache=u.getCachedData(t._cacheDataKey);n.Common.IsEmpty(this._columnIndexCache)&&(this._columnIndexCache={},t._cacheDataKey=u.cacheData(this._columnIndexCache))}return t.prototype.calc=function(n){var t=this.getColumnIndex(n);return t===-1?null:this.getValue(t)},t.prototype.getValue=function(n){return n===-1?null:this._dataModel.getValue(this.rowIndex,n)},t.prototype.getColumnIndex=function(t){if(n.Common.IsEmpty(t)||n.Common.IsEmpty(t.Column))return-1;if(typeof t.columnIndex=="undefined"){var r=this._listview.getFullListviewName()+"@"+t.Column,i=this._columnIndexCache[r];n.Common.IsEmpty(i)&&(i=n.Common.getColumnIndex(t.Column,this._listview));this._columnIndexCache[r]=i;t.columnIndex=i}return t.columnIndex},t.prototype.needUnparseValue2=function(n){var t=this.getColumnIndex(n);return t===-1?!1:!this._listview.isTextFormat(t)},t.prototype.equals=function(t,i){return n.Common.isFuzzyEquals(t,i)},t}();n.CommandFactory.registerCommand("Forguncy.Model.UpdateListviewCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.Export(this.CommandParam)},i.prototype.Export=function(t){if(n.Platform.isWeChatOrQQBrowser()&&n.Platform.isMobile())return alert(n.ChineseStaticValues.WeChartBrowser_CantDownloadFileWarning),n.CommandResult.completed;this.CommandExecutingInfo.suspend=!0;try{if(n.Common.IsEmpty(t))return n.CommandResult.completed;var i=n.ModuleLoader.getCdnUrl("DownloadFile/Download?fileName="+encodeURIComponent(t.FileName)+"&fileGuid="+t.FileGuid+"&fileExtension="+t.FileExtension),r=n.ForguncyData.ForguncyRoot+i;n.Common.download(r)}catch(u){alert(u)}finally{this.CommandExecutingInfo.suspend=!1}return n.CommandResult.completed},i}(n.CommandBase);n.DownloadFileCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.DownloadFileCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.runWorkflowCommand(this.CommandParam)},i.prototype.runWorkflowCommand=function(t){var i=this.evaluateFormula(t.TableName),r=t.ActionGUID,u=this.evaluateFormula(t.AssignTo),f=this.evaluateFormula(t.WorkflowComments),e=this.evaluateFormula(t.NextState),o=this.evaluateFormula(t.ActionName),s=this.CommandExecutingInfo.getBindingValueVersions()[i],h=this.CommandExecutingInfo.getCurrentRowInfoCollection().getCurrentRowInfo(i),c=this;return n.Common.forguncyPostSync("WorkflowApi/ExecuteFlowAction",{actionGuid:r,currentInfo:h,comments:f,assignTo:u,newState:e,actionName:o,rowVersion:s},function(r){if(!r||!r.Success)return r.ErrorMessage?alert(r.ErrorMessage):alert(n.RS.ProcessBarCell_ChangeStateFailed),c.stopExecuteCommandList(),n.CommandResult.stop;t.ReloadAfterSucceed&&(n.NormalCellBindingManager.reloadData(i,!0),n.ForguncyData.pageInfo.ViewInfoList.filter(function(n){return n.ViewType===2&&n.RelatedWorkflowTableName===i}).map(function(n){return n.ViewName}).forEach(function(t){return n.NormalCellBindingManager.reloadData(t,!0)}))}),n.CommandResult.completed},i}(n.CommandBase);n.WorkflowCommand=t;n.CommandFactory.registerCommand("WorkflowCommand.WorkflowCommand, WorkflowCommand",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var r=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.execute=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.shareCommand(this.CommandParam)];case 1:return[2,n.sent()]}})})},r.prototype.shareCommand=function(i){return __awaiter(this,void 0,void 0,function(){var s,r,w,b,k,v,e,h,l,f,a,u,o,y,p,c;return __generator(this,function(d){switch(d.label){case 0:return(s=i.ShareCommandContainerRefer.ShareCommandContainerID,n.ForguncyData.GlobalSettings.ShareCommands||(n.ForguncyData.GlobalSettings.ShareCommands={}),r=n.ForguncyData.GlobalSettings.ShareCommands[s],!(r===undefined))?[3,3]:(w=n.ForguncyData.ForguncyRoot+"Home/GetShareCommand?commandId="+s+"&v="+n.StaticData.ShareCommandVersion,[4,fetch(w)]);case 1:return b=d.sent(),[4,b.text()];case 2:k=d.sent();n.ForguncyData.GlobalSettings.ShareCommands[s]=JSON.parse(k);r=n.ForguncyData.GlobalSettings.ShareCommands[s];d.label=3;case 3:if(r&&r.Commands){if(v={},e={},h={},r.Params)for(f=0;f<r.Params.length;f++)l=r.Params[f],e[l.Name]=null,v[l.ID]=l.Name;if(i.Params)for(f=0;f<i.Params.length;f++)a=i.Params[f],u=v[a.ParamReferObject.ParamID],u&&(e[u]=this.evaluateFormula(a.Value),h[u]=n.ForguncyData.parameterManager.ParamToReference(a.Value),o=h[u],o&&o.startsWith("=")?(o=o.substring(1),this.log(n.Common.format(n.RS.ServerCommandLog_CreateParam,u,o+"("+e[u]+")"))):this.log(n.Common.format(n.RS.ServerCommandLog_CreateParam,u,e[u])));n.ForguncyData.parameterManager.push();for(y in e)n.ForguncyData.parameterManager.setValue(y,e[y],null);for(p in h)n.ForguncyData.parameterManager.SetParamToReference(p,h[p]);c=new t;c.ResultErrorCodeTo=i.ResultErrorCodeTo;c.ResultMessageTo=i.ResultMessageTo;c.ReturnPropertiesTo=i.ReturnPropertiesTo.map(function(n){var t,i=((t=r.Returns)!==null&&t!==void 0?t:[]).filter(function(t){return t.ID===n.ReturnPropertyReferObject.ParamID});if(i&&i.length===1)return{ResultTo:n.ResultTo,Name:i[0].Name}}).filter(function(n){return n});this.addToCommandList([].concat(r.Commands,c))}return[2,n.CommandResult.completed]}})})},r}(n.CommandBase),t,i;n.ShareCommand=r;n.CommandFactory.registerCommand("Forguncy.Model.ShareCommand, ServerDesignerCommon",r);t=function(){function n(){this.$type="Forguncy.Model.ShareCommandTerminate, ServerDesignerCommon"}return n}();n.ShareCommandTerminateParam=t;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return n.ForguncyData.parameterManager.pop(),n.CommandResult.completed},i}(n.CommandBase);n.ShareCommandTerminate=i;n.CommandFactory.registerCommand("Forguncy.Model.ShareCommandTerminate, ServerDesignerCommon",i)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var i={Left:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowleft" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-2" fill="currentColor" transform="translate(5.000000, 5.000000) scale(-1, 1) rotate(90.000000) translate(-5.000000, -5.000000) " points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>',Right:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowright" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-2" fill="currentColor" transform="translate(5.000000, 5.000000) rotate(90.000000) translate(-5.000000, -5.000000) " points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>',Up:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowup" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-2" fill="currentColor" points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>',Down:'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="arrowdown" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Path-5-Copy-3" fill="currentColor" transform="translate(5.000000, 5.000000) scale(1, -1) translate(-5.000000, -5.000000) " points="0 8 10 8 5 2"><\/polygon><\/g><\/svg>'},u=function(t){function r(){var i=t.call(this)||this;return i.id="fgc-columnoptions-dialog",i.defaultUI=f,i.availableTextBlock=new n.UI.TextBlock(n.RS.ColumnOptionsCommand_AvailableColumns).identify("fgc-columnoptions-availabletext"),i.selectedTextBlock=new n.UI.TextBlock(n.RS.ColumnOptionsCommand_SelectedColumns).identify("fgc-columnoptions-selectedtext"),i.availableListBox=new n.UI.ListBox(!0).identify("fgc-columnoptions-availablebox"),i.selectedListBox=(new n.UI.ListBox).identify("fgc-columnoptions-selectedbox"),i.addOrRemoveButtonGroup=new n.UI.ButtonGroup(1),i.moveDownOrUpButtonGroup=new n.UI.ButtonGroup(1),i.resetButton=new n.UI.Button(n.RS.ColumnOptionsCommand_ResetSetting).identify("fgc-columnoptions-button-reset"),i.outerFlex=new n.UI.FlexLayout(0).identify("fgc-columnoptions-outerflex"),i.innerFlex1=new n.UI.FlexLayout(1).identify("fgc-columnoptions-availableflex"),i.innerFlex2=new n.UI.FlexLayout(1).identify("fgc-columnoptions-selectedflex"),i.initializeListBoxs(),i.initializeButtons(),i.title=n.RS.ColumnOptionsCommand_Title,i.initializeFlexLayout(),i}return __extends(r,t),r.prototype.initializeFlexLayout=function(){this.outerFlex.add(this.innerFlex1);this.outerFlex.add(this.addOrRemoveButtonGroup);this.outerFlex.add(this.innerFlex2);this.outerFlex.add(this.moveDownOrUpButtonGroup);this.innerFlex1.add(this.availableTextBlock);this.innerFlex1.add(this.availableListBox);this.innerFlex2.add(this.selectedTextBlock);this.innerFlex2.add(this.selectedListBox);this.footerButtonGroup.add(this.resetButton)},r.prototype.initializeListBoxs=function(){this.availableListBox.compareFn=function(n,t){return n.value.Order-t.value.Order}},r.prototype.initializeButtons=function(){var t=this;this.addOrRemoveButtonGroup.add(new n.UI.Button("",i.Right,n.RS.ColumnOptionsCommand_AddColumn).on("Clicked",function(){t.moveToRight()}).identify("fgc-columnoptions-button-add"));this.availableListBox.on("ActiveItemsChanged",function(){t.moveToRight()});this.addOrRemoveButtonGroup.add(new n.UI.Button("",i.Left,n.RS.ColumnOptionsCommand_RemoveColumn).on("Clicked",function(){t.moveToLeft()}).identify("fgc-columnoptions-button-remove"));this.selectedListBox.on("ActiveItemsChanged",function(){t.moveToLeft()});this.availableListBox.on("SelectionsChanged",function(){t.addOrRemoveButtonGroup.items[0].enabled=t.availableListBox.selections.length>0});this.selectedListBox.on("SelectionsChanged",function(){var n=t.selectedListBox.selections.length>0;t.addOrRemoveButtonGroup.items[1].enabled=n;t.moveDownOrUpButtonGroup.items.forEach(function(t){return t.enabled=n})});this.moveDownOrUpButtonGroup.add(new n.UI.Button("",i.Up,n.RS.ColumnOptionsCommand_MoveColumnUp).on("Clicked",function(){t.selectedListBox.moveUpSelect();t.selectedListBox.moveSelectionToViewport()}).identify("fgc-columnoptions-button-up"));this.moveDownOrUpButtonGroup.add(new n.UI.Button("",i.Down,n.RS.ColumnOptionsCommand_MoveColumnDown).on("Clicked",function(){t.selectedListBox.moveDownSelect();t.selectedListBox.moveSelectionToViewport()}).identify("fgc-columnoptions-button-down"))},r.prototype.moveToRight=function(){var n,t,i;(n=this.selectedListBox).add.apply(n,this.availableListBox.selections);(t=this.selectedListBox).select.apply(t,this.availableListBox.selections);this.selectedListBox.moveSelectionToViewport();(i=this.availableListBox).remove.apply(i,this.availableListBox.selections);this.selectedListBox.focus()},r.prototype.moveToLeft=function(){var n,t,i;(n=this.availableListBox).add.apply(n,this.selectedListBox.selections);(t=this.availableListBox).select.apply(t,this.selectedListBox.selections);this.availableListBox.moveSelectionToViewport();(i=this.selectedListBox).remove.apply(i,this.selectedListBox.selections);this.availableListBox.focus()},r}(n.UI.Dialog),f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new e(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerFlex.createUI())},t}(n.UI.DialogContentUI),r=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n.control=new u,n.externalColumns=[],n}return __extends(r,i),r.prototype.execute=function(){var u=this,i,r;return(this.param=this.CommandParam,this.listview=n.ListviewBase.getListview(this.param.ListviewName,this.CommandExecutingInfo.runTimePageName),!this.listview.tryCommitEdit())?n.CommandResult.stop:(this.createControl(),i=n.Common.clone(this.listview.listviewData.metadata),this.metadata=i,r=n.ListviewMetadataHelper.isExist(this.listview.getLocationString()),this.control.resetButton.visibility=r,this.externalColumns=this.param.Columns.map(function(n,r){return t.generate(i,n,u.param.ID,r+1e6)}),this.resetListBoxItems(),this.control.footerButtonGroup.items[0].enabled=!1,this.control.show(),n.CommandResult.stop)},r.prototype.createControl=function(){this.bindControlEvents();n.ForguncyData.pageInfo.appendExtralPopup(this.control);n.PageBuilder.pagesContainer.append(this.control.createUI().container)},r.prototype.bindControlEvents=function(){var t=this;this.control.on("Confirm",function(){t.resetListView()});this.control.resetButton.on("Clicked",function(){confirm(n.RS.ColumnOptionsCommand_ConfirmResetSetting)&&(n.ListviewMetadataHelper.clear(t.listview.getLocationString()),location.reload())});this.control.selectedListBox.on("ItemsChanged",function(){t.control.footerButtonGroup.items[0].enabled=!0})},r.prototype.resetListBoxItems=function(){var n,t,i=this.generateListBoxItems();this.control.selectedListBox.clear();(n=this.control.selectedListBox).add.apply(n,i.filter(function(n){return n.value.Width>0}));this.control.availableListBox.clear();(t=this.control.availableListBox).add.apply(t,i.filter(function(n){return n.value.IsHiddenByColumnOptions&&!n.value.IsHiddenByLayout&&!n.value.IsHiddenByJavaScriptAPI}))},r.prototype.generateListBoxItems=function(){var i=this,n=[],r=t.distinct(this.metadata,this.externalColumns);return n.push.apply(n,r.map(function(n){return{value:n,displayText:i.getColumnName(n)}})),n},r.prototype.resetListView=function(){var f=this.control.availableListBox.items.map(function(n){return n.value}),r,i,u,e;f.forEach(function(n){n.Width=0;n.IsHiddenByColumnOptions=!0});r=this.control.selectedListBox.items.map(function(n){return n.value});r.forEach(function(n){n.Width<=0&&(n.Width=n.OriginalWidth,n.IsHiddenByColumnOptions=!1)});i=this.metadata;t.mix(i,__spreadArray(__spreadArray([],f,!0),r,!0));n.ListviewMetadataHelper.save(i,this.listview.getLocationString());u=this.listview.listviewData;e=new n.ListviewData(i,u.layout,this.CommandExecutingInfo.runTimePageName,this.CommandExecutingInfo.designerPageName,u.uniqueIndex);this.listview.resetListviewData(e)},r.prototype.getColumnName=function(t){var i=t.TemplateCell&&t.TemplateCell.Element&&t.TemplateCell.Element.Name;return i&&!n.Common.IsEmpty(i[0])?i[0]:n.RS.ColumnOptionsCommand_UnamedColumn},r}(n.CommandBase),t;n.ColumnOptionsCommand=r;t=function(){function t(){}return t.distinct=function(t,i){var r=n.Common.clone(t.Columns),f=this.getPreserveColumnCount(t),u;return r=r.slice(f),u=r.map(function(n){var t=n.TemplateCell&&n.TemplateCell.Element&&n.TemplateCell.Element.Name;if(t)return t[0]}),i.forEach(function(n){var t=n.TemplateCell&&n.TemplateCell.Element&&n.TemplateCell.Element.Name;t&&u.indexOf(t[0])<0&&r.push(n)}),r},t.mix=function(n,t){var u,e=this.getPreserveColumnCount(n),i,f,r;n.Columns=__spreadArray(__spreadArray([],n.Columns.slice(0,e),!0),n.Columns.filter(function(n){return n.IsHiddenByLayout||n.IsHiddenByJavaScriptAPI}),!0);(u=n.Columns).push.apply(u,t.filter(function(n){return!(n.Width<=0&&n.IsExternal)}));i=__spreadArray([],n.Columns,!0).sort(function(n,t){return n.Index-t.Index});i.forEach(function(t,r){t.IsExternal?(t.Index=r===0?0:i[r-1].Index+i[r-1].ColumnCount,t.HeaderCell&&t.HeaderCell.forEach(function(i,r){i.Element.Column=t.Index+n.CellRange.Column;i.Element.Row=n.CellRange.Row+r})):t.HeaderCell&&t.HeaderCell.forEach(function(n){n.ColumnSpan=1})});f=n.Columns.length;f>0?(r=__spreadArray([],n.Columns,!0).sort(function(n,t){return t.Index-n.Index})[0],n.ColumnCount=r.Index+r.ColumnCount):n.ColumnCount=0},t.generate=function(n,t,i,r){return r===void 0&&(r=0),{AllowSort:t.AllowSort,AllowAutoMerge:!1,BindingColumnDataType:t.BindingColumnDataType,FilterBindingInfo:t.BindingInfo,FilterColumnDataType:t.BindingColumnDataType,ColumnCount:1,DependenceColumnsIndex:null,Index:1e5,HeaderCell:[{ColumnSpan:1,RowSpan:n.ColumnHeaderHeights.length,Row:0,Element:{Value:t.Name,Row:-1,Column:-1,StyleInfo:t.HeaderCellStyleMetadata||this.DefaultHeaderStyleInfo,IgnoreExport:!0}}],TemplateCell:{Element:{BindingInfo:t.BindingInfo,Name:[t.Name],StyleInfo:t.TemplateCellStyleMetadata||this.DefaultTemplateStyleInfo,CellType:t.CellType,DataValidation:t.DataValidation,ServerPropertiesId:t.ServerPropertiesId}},Width:0,OriginalWidth:t.Width||0,IsHiddenByLayout:!1,IsHiddenByColumnOptions:!0,IsHiddenByJavaScriptAPI:!1,Order:r,IsExternal:!0,ColumnOptionsCommandID:i}},t.getPreserveColumnCount=function(n){var t=0;return n.IsRowHeaderVisible&&(t+=1),n.IsRowHeaderCheckBoxVisible&&(t+=1),t},Object.defineProperty(t,"DefaultHeaderStyleInfo",{get:function(){return{FontFamily:n.LocaleFonts.default,FontSize:n.StaticValues.DefaultFontSizeInPx,FontStyle:"Normal",FontWeight:"Normal",HorizontalAlignment:n.CellHorizontalAlignment.Center,Strikethrough:!1,TextIndent:0,Underline:!1,VerticalAlignment:n.CellVerticalAlignment.Center,WordWrap:!1}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DefaultTemplateStyleInfo",{get:function(){return{FontFamily:n.LocaleFonts.default,FontSize:n.StaticValues.DefaultFontSizeInPx,FontStyle:"Normal",FontWeight:"Normal",HorizontalAlignment:n.CellHorizontalAlignment.Left,Strikethrough:!1,TextIndent:0,Underline:!1,VerticalAlignment:n.CellVerticalAlignment.Center,WordWrap:!1}},enumerable:!1,configurable:!0}),t}();n.ColumnOptionsListviewMetadataHelper=t;n.CommandFactory.registerCommand("Forguncy.Model.ColumnOptionsCommand, ServerDesignerCommon",r)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.runCallStoredProcedureCommand(this.CommandParam)},i.prototype.runCallStoredProcedureCommand=function(t){for(var i,u,h=t.ID,c=t.Parmeters,e=[],o={},r=0,s=c;r<s.length;r++)i=s[r],u={Name:i.Name,Value:this.evaluateFormula(i.Value),Direction:i.Direction,DataType:i.DataType},e.push(u),o[u.Name]=i.ReturnCell;var f=this,l=t.ReturningValue;return n.Common.forguncyPostSync("Home/CallStoredProcedure",{ID:h,parList:e},function(i){var r,h,e,s,u;if(!n.Common.IsEmpty(i))if(r=i,r.Success===!0){for(h=r.ReturnValue,e=0,s=h;e<s.length;e++)u=s[e],u.Direction===3||u.Direction===2?f.SetValue(u.Value,o[u.Name]):u.Direction===6&&f.SetValue(u.Value,l);t.ReturnsName&&r.ReturnResult&&(n.ForguncyData.parameterManager.setValue(t.ReturnsName,r.ReturnResult),n.ForguncyData.parameterManager.SetParamToReference(t.ReturnsName,n.ForguncyData.parameterManager.ParamToReference(r.ReturnResult)));t.ReloadAfterSucceed&&n.NormalCellBindingManager.reloadData(null,!0)}else return alert(r.ReturnValue),console.error(n.RS.CallStoredProcedureCommand_ExecuteFailed+"\r\n"+r.ReturnValue),f.stopExecuteCommandList(),n.CommandResult.stop}),n.CommandResult.completed},i.prototype.SetValue=function(t,i){n.FormulaHelper.setValueToCellLocation(t,i,5,this.getDefaultFormulaCalcInfo())},i}(n.CommandBase);n.CallStoredProcedureCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.CallStoredProcedureCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.CallUserControlPageCommand(this.CommandParam),n.CommandResult.completed},i.prototype.CallUserControlPageCommand=function(t){var f={},i,r,u,e,o;if(t.CommandParamValue)for(i=0,r=t.CommandParamValue;i<r.length;i++)u=r[i],f[u.Name]=this.evaluateFormula(u.Value);e=n.PageManager.getContainerCell(this.CommandExecutingInfo.runTimePageName);o=e.cellType;o.addCommandsToCurrentExecuteList(t.CommandName,f)},i}(n.CommandBase);n.CallUserControlPageCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.CallUserControlPageCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.SetUserControlPagePropertyValue(this.CommandParam),n.CommandResult.completed},i.prototype.SetUserControlPagePropertyValue=function(t){var i=n.PageManager.getContainerCell(this.CommandExecutingInfo.runTimePageName);i.cellType instanceof n.UserControlPageCellType&&(i.cellType.SetPropertyValue(t.PropertyName,this.evaluateFormula(t.PropertyValue)),i.cellType.SetPropertyRefer(t.PropertyName,t.PropertyValue,this.CommandExecutingInfo.runTimePageName))},i}(n.CommandBase);n.SetUserControlPagePropertyValueCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SetUserControlPagePropertyValueCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.sendRequestToServer(this.CommandParam)},i.prototype.sendRequestToServer=function(t){var i;return __awaiter(this,void 0,void 0,function(){var l,r,e,u,h,o,s,f,c,a=this;return __generator(this,function(){if(t.CheckDataValidation){if(!n.ListviewBase.validateAllListviewsData())return this.showWarningForCantPassDatavalidation(),this.stopExecuteCommandList(),[2,n.CommandResult.stop];l=n.ValidationMananger.validateAllCells();switch(l){case 2:return[2,n.CommandResult.delay];case 1:return this.showWarningForCantPassDatavalidation(),this.stopExecuteCommandList(),[2,n.CommandResult.stop]}}try{if(r=null,t.OnlySendChangeParams=(i=t.OnlySendChangeParams)!==null&&i!==void 0?i:[],t.Parameters&&t.Parameters.length>0)for(r={},e=0;e<t.Parameters.length;e++)u=t.Parameters[e],u.$type.indexOf("ObjectParam")>=0?(r[u.ParamName]=this.evaluateFormula(u.Value),r[u.ParamName]instanceof Date&&(r[u.ParamName]=n.Convertor.fromDateToOADate(r[u.ParamName]))):r[u.ParamName]=this.getListviewData(u,t.OnlySendChangeParams.indexOf(u.ParamName)>=0);if(h=function(i,r,u){var f=u.getResponseHeader("fgc_redirect");f&&(f.toLowerCase().indexOf("http://")===0||f.toLowerCase().indexOf("https://")===0?n.Common.download(f):n.Common.download(n.ForguncyData.ForguncyRoot+f));a.setResult(t,i);t.RefreshAfterFinish&&n.Page.reloadBindingData()},o=function(n,i){var r={ErrCode:n.status,Message:i};a.setResult(t,r)},t.RequestAsync)s="ServerCommand/"+t.ServerCommandName,s=encodeURI(n.ForguncyData.ForguncyRoot+s),f=new XMLHttpRequest,f.open("POST",s,!0),f.setRequestHeader("connectionId",n.HubManager.GetconnectionId()),f.onload=function(){if(this.status>=200&&this.status<400){var n=this.getResponseHeader("content-type"),t=this.response;n&&n.toLowerCase().indexOf("application/json")>=0&&(t=JSON.parse(this.response));h(t,null,f)}else o(f,this.response)},f.onerror=function(){o(f,this.response)},n.Common.IsEmpty(r)||(r=n.Common.adjustDate(r),typeof r=="object"&&(f.setRequestHeader("Content-Type","application/json"),r=JSON.stringify(r))),f.send(r);else return c="ServerCommand/"+t.ServerCommandName,[2,new Promise(function(t){n.Common.forguncyPost(c,r,function(i,r,u){h(i,r,u);t(n.CommandResult.completed)},c,function(i,r){o(i,r);t(n.CommandResult.completed)},null,{connectionId:n.HubManager.GetconnectionId()})})];return[2,n.CommandResult.completed]}catch(v){alert(v)}return[2]})})},i.prototype.showWarningForCantPassDatavalidation=function(){this.log(n.RS.DataValidationNotPassed)},i.prototype.setResult=function(t,i){var f,r,u;if(t.ResultMessageTo&&this.setValue(i.Message,t.ResultMessageTo),t.ResultErrorCodeTo&&this.setValue(i.ErrCode,t.ResultErrorCodeTo),t.ReturnPropertiesTo)for(f=0;f<t.ReturnPropertiesTo.length;f++)r=t.ReturnPropertiesTo[f],(r===null||r===void 0?void 0:r.ResultTo)&&this.setValue(i[r.ResultPropertyName],r.ResultTo);i.Log&&(u=this.CommandExecutingInfo.logHelper,t.RequestAsync&&(u=new n.CommandLogHelper,u.tryStartNewRoot()),u.logGroupedText(i.Log),t.RequestAsync&&u.consoleLog());i.ErrCode===0||n.Common.IsEmpty(i.Message)||t.ResultMessageTo||t.ResultErrorCodeTo||alert(i.Message)},i.prototype.setValue=function(t,i){n.FormulaHelper.setValueToCellLocation(t,i,5,this.getDefaultFormulaCalcInfo())},i.prototype.getListviewData=function(t,i){var p,v,o,k,a,f,c,l,d,g,w,s,e,h,r,u,b,it,y;if(i){if(e={AddRows:[],EditRows:[],DeleteRows:[]},p=n.ListviewBase.getAllListviews().filter(function(n){return n.getListviewName()===t.ListviewName}),p.length===0)throw n.Common.format(n.RS.CannotFindListview,t.ListviewName);if(v=p[0],o=v.buildDetailListviewValues(!1,null,1),!o)return e;for(r=0;r<o.AddValues.length;r++){if(u={},k=o.AddValues[r],t.Columns)for(f=0;f<t.Columns.length;f++)c=t.Columns[f].ArrayItemName,l=k.values[t.Columns[f].Column],u[c]=l;e.AddRows.push(u)}for(r=0;r<o.EditValues.length;r++){if(u={},a=o.EditValues[r],t.Columns)for(f=0;f<t.Columns.length;f++)c=t.Columns[f].ArrayItemName,l=a.values[t.Columns[f].Column],l!==undefined?u[c]=l:(d=v.getColIndexOfNamedColumn(t.Columns[f].Column,!1),g=v.getListDataModel().getValue(a.rowIndex,d),u[c]=g);for(s in a.query)u[s]=a.query[s];e.EditRows.push(u)}for(r=0;r<o.DeletedValues.length;r++){u={};w=o.DeletedValues[r];for(s in w.query)u[s]=w.query[s];e.DeleteRows.push(u)}return e}if(e=[],h=n.Page.getListView(t.ListviewName),h===null)throw n.Common.format(n.RS.CannotFindListview,t.ListviewName);if(t.Scope===1){var nt=h.getSelectedRowsData(),rt=h.getMergedColumnInfos(),tt=this.mergedColumnInfos(t,rt);for(r=0;r<nt.length;r++){u={};for(b in tt)it=tt[b],u[b]=nt[r].Values[it];e.push(u)}}else for(y=0;y<h.getRowCount();y++)this.addRowData(e,t,y,h);return e},i.prototype.mergedColumnInfos=function(n,t){for(var f,e,i,u={},r=0;r<n.Columns.length;r++)for(f=n.Columns[r].ArrayItemName,e=n.Columns[r].Column,i=0;i<t.length;i++)t[i].ColumnName===e&&(u[f]=i);return u},i.prototype.addRowData=function(n,t,i,r){var f={},u,e;if(t.Columns)for(u=0;u<t.Columns.length;u++)e=t.Columns[u].ArrayItemName,f[e]=r.getValue(i,t.Columns[u].Column);n.push(f)},i.prototype.getMessage=function(t){if(n.Common.IsEmpty(t))return"";var i=this.evaluateFormula(t.MessageFormula);return n.Common.IsEmpty(i)?"":i},i}(n.CommandBase);n.RequestServerCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.RequestServerCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function r(){return t!==null&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.execute=function(){try{return this.exportActiveReportToPdf(this.CommandParam)}catch(t){return alert(t),this.CommandExecutingInfo.suspend=!1,n.CommandResult.completed}},r.prototype.exportActiveReportToPdf=function(t){var r=this,u;if(this.preHandlePassParameterItems(t),u=this.evaluateFormula(t.CustomName),u instanceof GC.Spread.CalcEngine.CalcError)throw n.RS.ExprotActiveReportsCalFormulaError;return n.Common.forguncyPost("ARExport/SetExportParam",{ExportReportType:t.ExportReportType,ReportFiles:t.ExportReportNameList,ReportParameters:t.PassParameters,FileName:u,IsPageBreakBefores:t.IsPageBreakBefores,ReportGaps:t.ReportGaps},function(u){try{t.ExportReportType===i.Pdf?n.Common.openWindow(n.ForguncyData.ForguncyRoot+"ARExport/ExportReport"+"?CacheGuid=".concat(u,"&exportType=").concat(t.ExportReportType)):n.Common.download(n.ForguncyData.ForguncyRoot+"ARExport/ExportReport"+"?CacheGuid=".concat(u,"&exportType=").concat(t.ExportReportType))}finally{n.DelayRefresh.setTimeout(function(){r.CommandExecutingInfo.suspend=!1},500)}},"export",function(){r.CommandExecutingInfo.suspend=!1},function(){r.CommandExecutingInfo.suspend=!1}),n.CommandResult.completed},r.prototype.preHandlePassParameterItems=function(t){var r=this,i;(i=t.PassParameters)===null||i===void 0?void 0:i.forEach(function(t){var i=r.evaluateFormula(t.SourceValue);if(i instanceof GC.Spread.CalcEngine.CalcError)throw n.RS.ActiveReportsParameterValueCalFormulaError;t.ActualSourceValue=i;t.ActualTargetParameter=t.TargetParameter})},r}(n.CommandBase),i;n.ExportActiveReportCommand=t,function(n){n[n.Pdf=0]="Pdf";n[n.Word=1]="Word";n[n.Excel=2]="Excel";n[n.Csv=3]="Csv"}(i=n.ExportReportType||(n.ExportReportType={}));n.CommandFactory.registerCommand("Forguncy.Model.ExportActiveReportCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t=this;return new Promise(function(i){try{n.LoadModule("f4d61031-b4c0-435b-af6e-991d81290afd").then(function(){i(t.openActiveReportToPdf(t.CommandParam))})}catch(r){alert(r);i(n.CommandResult.completed)}})},i.prototype.openActiveReportToPdf=function(t){var f,u,r,i,e,o,s;return this.preHandlePassParameterItems(t),this.saveSessions(t),u="".concat(n.ForguncyData.ForguncyRoot,"ReportsService/preview/").concat(t.SessionGuid,"/").concat(t.OpenReportName,".rdlx"),(t.PassParameters||t.OpenReportTitle)&&(i=this.evaluateFormula(t.OpenReportTitle),r=i instanceof GC.Spread.CalcEngine.CalcError||n.Common.IsEmpty(i)?"":typeof i=="string"?i.trim():i instanceof Date?i.toJSON():i.toString(),n.Common.forguncyPostSync("ARExport/SetOpenParam",{ReportParameters:t.PassParameters,ReportName:t.OpenReportName,PageTitle:r},function(n){u+="?CacheGuid=".concat(n)})),e=n.ForguncyData.pageInfo.pageID,((f=window===null||window===void 0?void 0:window.TabManager)===null||f===void 0?void 0:f.TabContainer.getCurrentInstance(window,e))?(o=t.OpenReportName,r&&r.length>0&&(o=r),s=new TabManager.Tab(!1,"",window.location.origin+u,o,0),TabManager.TabContainer.addTab(s,e)):n.Common.openWindow(u),n.CommandResult.completed},i.prototype.preHandlePassParameterItems=function(t){var r=this,i;(i=t.PassParameters)===null||i===void 0?void 0:i.forEach(function(t){var i=r.evaluateFormula(t.SourceValue);if(i instanceof GC.Spread.CalcEngine.CalcError)throw n.RS.ActiveReportsParameterValueCalFormulaError;t.ActualSourceValue=i;t.ActualTargetParameter=t.TargetParameter})},i.prototype.saveSessions=function(n){this.saveToSessionStorage(n.SessionGuid,JSON.stringify(n))},i.prototype.saveToSessionStorage=function(n,t){t?sessionStorage.setItem(n,t):sessionStorage.removeItem(n)},i}(n.CommandBase),i;n.OpenActiveReportCommand=t,function(n){n[n.None=0]="None";n[n.Left=1]="Left"}(i=n.SideBarPosition||(n.SideBarPosition={}));n.CommandFactory.registerCommand("Forguncy.Model.OpenActiveReportCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.execute=function(){var i;return __awaiter(this,void 0,void 0,function(){var u,r,f;return __generator(this,function(e){switch(e.label){case 0:return(u=this.CommandParam,r=n.FormulaHelper.getCellIds(u.TargetPageElement,this.getDefaultFormulaCalcInfo()),f=(r===null||r===void 0?void 0:r.length)===1?(i=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(r[0]))===null||i===void 0?void 0:i.cellType:null,!f)?[3,2]:(n.DelayRefresh.RunNow(),[4,t.execute(f,u,this)]);case 1:return e.sent(),[3,3];case 2:this.log("Can't find target ".concat(u.TargetPageElement));e.label=3;case 3:return[2,n.CommandResult.completed]}})})},r}(n.CommandBase),t;n.OperateCellTypeCommand=i;t=function(){function t(){}return t.execute=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u,h,c,e,o,s,l;return __generator(this,function(a){switch(a.label){case 0:if(f=t[i.MethodName],!f)return[3,6];if(u=[],i.ParameterValues)for(h in i.ParameterValues)u.push(r.evaluateFormula(i.ParameterValues[h]));c=u.map(function(t){if(n.Common.IsEmpty(t))return"null";try{return JSON.stringify(t)}catch(i){return t}}).join(",");r.log("".concat(i.MethodName,"(").concat(c,")"));a.label=1;case 1:return(a.trys.push([1,4,,5]),e=f.apply(t,u),t instanceof n.UserControlPageCellType&&f===n.UserControlPageCellType.prototype.SetPropertyValue&&t.SetPropertyRefer(u[0],i.ParameterValues.value,r.CommandExecutingInfo.runTimePageName),o=e,!(e instanceof Promise))?[3,3]:[4,e];case 2:o=a.sent();a.label=3;case 3:if(o&&i.RetrunParamNames)for(s in i.RetrunParamNames)this.setValue(o[s],i.RetrunParamNames[s],r);return[3,5];case 4:return l=a.sent(),r.CommandExecutingInfo.logHelper.startChild(),r.CommandExecutingInfo.logHelper.log("Fail to operate cell type.\r\nException:\r\n".concat(JSON.stringify(l))),r.CommandExecutingInfo.logHelper.endChild(),[3,5];case 5:return[3,7];case 6:r.log("Can't find method ".concat(i.MethodName));a.label=7;case 7:return[2]}})})},t.setValue=function(t,i,r){n.FormulaHelper.setValueToCellLocation(t,i,5,r.getDefaultFormulaCalcInfo())},t}();n.RuntimeMethedExecuteHelper=t;n.CommandFactory.registerCommand("Forguncy.Model.OperateCellTypeCommand, ServerDesignerCommon",i)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.setParameterCommand(this.CommandParam)},i.prototype.setParameterCommand=function(t){var r,u,i,f;if(t.IsTableValue){if(u={},t.Params)for(i=0;i<t.Params.length;i++)f=t.Params[i],u[f]=this.evaluateFormula(t.Params[i]);return n.HomeController.CalcParamValue({CommandId:t.ID,Params:u},function(i){var r=i.Success?i.Param:GC.Spread.CalcEngine.Errors.Value;!i.Success&&i.ErrorMessage&&alert(i.ErrorMessage);n.ForguncyData.parameterManager.setValue(t.ParameterName,r)},function(){n.ForguncyData.parameterManager.setValue(t.ParameterName,GC.Spread.CalcEngine.Errors.Value)}),n.CommandResult.completed}return r=this.evaluateKeyword(t.ParameterValue),r=this.evaluateFormula(r),n.ForguncyData.parameterManager.setValue(t.ParameterName,r),n.ForguncyData.parameterManager.SetParamToReference(t.ParameterName,n.ForguncyData.parameterManager.ParamToReference(t.ParameterValue)),n.CommandResult.completed},i}(n.CommandBase);n.SetParameterCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.Commands.SetParameterCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.returnCommand(this.CommandParam)},i.prototype.returnCommand=function(t){for(var r,l,o,c,i,a=this,u=this.CommandExecutingInfo.currentCommandList,f=0;f<u.length;f++)if(u[f].$type==="Forguncy.Model.ShareCommandTerminate, ServerDesignerCommon"){for(r=u[f],i=f;i>=0;i--)l=this.CommandExecutor.createCommand(u[i]),l.EnableProtect||u.splice(i,1);var v=new n.ShareCommandTerminate,s=this.evaluateFormula(t.ErrorCode),h=this.evaluateFormula(t.Message),e=[];if(t.CustomReturns&&(e=t.CustomReturns.map(function(n){return{property:n.ReturnPropertyName,value:a.evaluateFormula(n.Value)}})),v.execute(),this.setValueToCell(r.ResultErrorCodeTo,s),this.setValueToCell(r.ResultMessageTo,h),r.ReturnPropertiesTo)for(o=0;o<r.ReturnPropertiesTo.length;o++)for(c=r.ReturnPropertiesTo[o],i=0;i<e.length;i++)if(e[i].property===c.Name){this.setValueToCell(c.ResultTo,e[i].value);break}!s||Number(s)===0||n.Common.IsEmpty(h)||r.ResultErrorCodeTo||r.ResultMessageTo||alert(h);return}return n.CommandResult.stop},i.prototype.setValueToCell=function(t,i){n.FormulaHelper.setValueToCellLocation(i,t,5,this.getDefaultFormulaCalcInfo())},i}(n.CommandBase);n.ReturnCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ReturnCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return n.ForguncyData.pageDirtyCheckManager.removeDirtyStatus(),n.CommandResult.completed},i}(n.CommandBase);n.IgnorePageDirtyCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.IgnorePageDirtyCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return n.CommandResult.stop},i}(n.CommandBase);n.StopCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.StopCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.SubscribeNotificationCommand(this.CommandParam)},i.prototype.SubscribeNotificationCommand=function(t){try{return n.HubManager.SubscribeNotification(t.Name,t,this.CommandExecutingInfo.runTimePageName),n.CommandResult.completed}catch(i){alert(i)}return n.CommandResult.completed},i}(n.CommandBase);n.SubscribeNotificationCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.SubscribeNotificationCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return this.UnSubscribeNotificationCommand(this.CommandParam)},i.prototype.UnSubscribeNotificationCommand=function(t){try{return n.HubManager.UnSubscribeNotification(t.NotificationName),n.CommandResult.completed}catch(i){alert(i)}return n.CommandResult.completed},i}(n.CommandBase);n.UnSubscribeNotificationCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.UnSubscribeNotificationCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var i=function(){function i(){}return i.showTooltip=function(r,u){n.DelayOperateHelper.Push(null,function(){var n=i.getToolTipElement($(r)),f=n.attr("title");f!==u&&(i.tooltip(n,t.destroy),n.attr("title",u));i.updateTooltipPlacementLocation(n);i.tooltip(n,t.show,{placement:n.attr("data-placement")})},1)},i.destroyTooltip=function(r){n.DelayOperateHelper.Push(null,function(){var n=i.getToolTipElement(r);i.tooltip(n,t.destroy)},1)},i.getToolTipElement=function(n){return $(n).closest("[data-trigger]")},i.tooltip=function(t,r,u){return t.each(function(){var f=$(this),t=f.data(i.DataKey);(t||r!=="destroy")&&(t||(t=new n.Tooltip(this,u),f.data(i.DataKey,t)),typeof r=="string"&&t[r]())})},i.setTooltipAttr=function(n,t){t===void 0&&(t=!1);n.addClass("red-tooltip");n.attr("data-trigger","manual");n.attr("data-placement","bottom");t||n.addClass("fgc-tooltip-normalcell")},i.updateTooltipPlacementLocation=function(n){var t,i=((t=n.offset())===null||t===void 0?void 0:t.top)>60?"top":"bottom";n.attr("data-placement",i)},i.DataKey="bs.tooltip",i}(),t;n.ValidationTooltipHelper=i;t=function(){function n(){}return n.show="show",n.destroy="destroy",n}()})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=GC.Spread.Sheets.ConditionalFormatting,i=function(){function i(){}return i.prototype.ConvertConditionRuleToSpreadJS=function(n,t,i,r,u){return u===void 0&&(u=0),this.ConvertConditionRuleToSpreadJSByRanges(n,t,[new GC.Spread.Sheets.Range(u,i,r,1)])},i.prototype.ConvertConditionRuleToSpreadJSByRanges=function(n,t,r){if(!t)return null;this._colStyleInfo=n;var u=null;switch(t.RuleType){case 1:u=this.GenerateCellValueRule(t);break;case 2:u=this.GenerateSpecificTextRule(t);break;case 3:u=this.GenerateDateOccurringRule(t);break;case 4:u=this.GenerateDuplicateRule(t);break;case 5:u=this.GenerateUniqueRule(t);break;case 6:u=i.GenerateTwoColorScaleRule(t);break;case 7:u=i.GenerateThreeColorScaleRule(t);break;case 8:u=this.GenerateTop10Rule(t);break;case 9:u=this.GenerateAverageRule(t);break;case 10:u=this.GenerateFormulaRule(t);break;case 11:u=i.GenerateIconSetRule(t);break;case 12:u=i.GenerateDataBarRule(t)}return u.stopIfTrue(!!t.StopIfTrue),u.ranges(r),u},i.prototype.GenerateCellValueRule=function(n){var r=n.Params,u=i.ConvertComparisonOperator(r.Operator),f=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.cellValueRule,[],f,u,r.Value1,r.Value2)},i.prototype.GenerateSpecificTextRule=function(n){var i=n.Params,r=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.specificTextRule,[],r,i.Operator,null,null,i.Value)},i.prototype.GenerateDateOccurringRule=function(n){var i=n.Params,r=i.Operator,u=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.dateOccurringRule,[],u,null,null,null,null,null,r)},i.prototype.GenerateDuplicateRule=function(n){var i=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.duplicateRule,[],i)},i.prototype.GenerateUniqueRule=function(n){var i=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.uniqueRule,[],i)},i.GenerateTwoColorScaleRule=function(r){var u=r.Params,f=i.ConvertScaleValueType(u.MinimumType),e=i.ConvertScaleValueType(u.MaximumType);return new t.ScaleRule(t.RuleType.twoScaleRule,f,u.MinimumValue,n.ColorHelper.Convert(u.MinimumColor),null,null,null,e,u.MaximumValue,n.ColorHelper.Convert(u.MaximumColor),[])},i.GenerateThreeColorScaleRule=function(r){var u=r.Params,f=i.ConvertScaleValueType(u.MinimumType),e=i.ConvertScaleValueType(u.MidpointType),o=i.ConvertScaleValueType(u.MaximumType);return new t.ScaleRule(t.RuleType.threeScaleRule,f,u.MinimumValue,n.ColorHelper.Convert(u.MinimumColor),e,u.MidpointValue,n.ColorHelper.Convert(u.MidpointColor),o,u.MaximumValue,n.ColorHelper.Convert(u.MaximumColor),[])},i.GenerateIconSetRule=function(n){var f=n.Params,h=i.ConvertIconSetType(f.IconSetType),e=new t.IconSetRule(h,[]),s,o,r,u;if(e.showIconOnly(f.ShowIconOnly),e.reverseIconOrder(f.ReverseIconOrder),s=e.iconCriteria(),o=s.length,o>=2&&o<=4)for(r=0;r<o;r++)u=f.IconCriteria.$values,s[r]=new t.IconCriterion(u[r].IsGreaterThanOrEqualTo===undefined?!1:u[r].IsGreaterThanOrEqualTo,i.ConvertIconValueType(u[r].IconValueType),u[r].Value===undefined?0:u[r].Value);return e},i.GenerateDataBarRule=function(r){var u=r.Params,e=i.ConvertScaleValueType(u.MaximumType),o=i.ConvertScaleValueType(u.MinimumType),f=new t.DataBarRule(o,u.MinimumValue,e,u.MaximumValue,n.ColorHelper.Convert(u.Color),[]);return f.gradient(u.Gradient),f.axisColor(n.ColorHelper.Convert(u.AxisColor)),f.axisPosition(i.ConvertDataBarAxisPosition(u.AxisPosition)),f.borderColor(n.ColorHelper.Convert(u.BorderColor)),f.negativeBorderColor(n.ColorHelper.Convert(u.NegativeBorderColor)),f.negativeFillColor(n.ColorHelper.Convert(u.NegativeFillColor)),f.showBarOnly(u.ShowBarOnly),f.showBorder(u.ShowBorder),f.useNegativeBorderColor(u.UseNegativeBorderColor),f.useNegativeFillColor(u.UseNegativeFillColor),f.dataBarDirection(i.ConvertDataBarDirection(u.DataBarDirection)),f},i.prototype.GenerateTop10Rule=function(n){var i=n.Params,r=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.top10Rule,[],r,null,null,null,null,null,i.Operator,i.Rank)},i.prototype.GenerateAverageRule=function(n){var r=n.Params,u=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.averageRule,[],u,null,null,null,null,null,i.ConvertAverageRuleType(r.Operator))},i.ConvertAverageRuleType=function(n){switch(n){case 0:return t.AverageConditionType.above;case 4:return t.AverageConditionType.above1StdDev;case 6:return t.AverageConditionType.above2StdDev;case 8:return t.AverageConditionType.above3StdDev;case 1:return t.AverageConditionType.below;case 5:return t.AverageConditionType.below1StdDev;case 7:return t.AverageConditionType.below2StdDev;case 9:return t.AverageConditionType.below3StdDev;case 2:return t.AverageConditionType.equalOrAbove;case 3:return t.AverageConditionType.equalOrBelow}},i.prototype.GenerateFormulaRule=function(n){var i=n.Params,r=this.GenerateStyle(n.StyleInfo);return new t.NormalConditionRule(t.RuleType.formulaRule,[],r,null,null,null,null,i.Formula)},i.ConvertScaleValueType=function(n){switch(n){case 8:return t.ScaleValueType.automax;case 6:return t.ScaleValueType.automin;case 7:return t.ScaleValueType.formula;case 3:return t.ScaleValueType.highestValue;case 2:return t.ScaleValueType.lowestValue;case 1:return t.ScaleValueType.number;case 4:return t.ScaleValueType.percent;case 5:return t.ScaleValueType.percentile}},i.ConvertIconValueType=function(n){switch(n){case 7:return t.IconValueType.formula;case 1:return t.IconValueType.number;case 4:return t.IconValueType.percent;case 5:return t.IconValueType.percentile}},i.ConvertIconSetType=function(n){switch(n){case 15:return t.IconSetType.fiveArrowsColored;case 16:return t.IconSetType.fiveArrowsGray;case 19:return t.IconSetType.fiveBoxes;case 18:return t.IconSetType.fiveQuarters;case 17:return t.IconSetType.fiveRatings;case 10:return t.IconSetType.fourArrowsColored;case 11:return t.IconSetType.fourArrowsGray;case 13:return t.IconSetType.fourRatings;case 12:return t.IconSetType.fourRedToBlack;case 14:return t.IconSetType.fourTrafficLights;case 0:return t.IconSetType.threeArrowsColored;case 1:return t.IconSetType.threeArrowsGray;case 4:return t.IconSetType.threeFlags;case 7:return t.IconSetType.threeSigns;case 3:return t.IconSetType.threeStars;case 8:return t.IconSetType.threeSymbolsCircled;case 9:return t.IconSetType.threeSymbolsUncircled;case 6:return t.IconSetType.threeTrafficLightsRimmed;case 5:return t.IconSetType.threeTrafficLightsUnrimmed;case 2:return t.IconSetType.threeTriangles}},i.ConvertDataBarAxisPosition=function(n){switch(n){case 0:return t.DataBarAxisPosition.automatic;case 1:return t.DataBarAxisPosition.cellMidPoint;case 2:return t.DataBarAxisPosition.none}},i.ConvertDataBarDirection=function(n){switch(n){case 0:return t.BarDirection.leftToRight;case 1:return t.BarDirection.rightToLeft}},i.ConvertComparisonOperator=function(n){switch(n){case 1:return t.ComparisonOperators.between;case 2:return t.ComparisonOperators.notBetween;case 3:return t.ComparisonOperators.equalsTo;case 4:return t.ComparisonOperators.notEqualsTo;case 5:return t.ComparisonOperators.greaterThan;case 6:return t.ComparisonOperators.lessThan;case 7:return t.ComparisonOperators.greaterThanOrEqualsTo;case 8:return t.ComparisonOperators.lessThanOrEqualsTo}},i.prototype.GenerateStyle=function(t){var i,r,u;return n.Common.IsEmpty(t)?null:(i=n.Common.clone(t),this._colStyleInfo&&(r=this._colStyleInfo,n.Common.IsEmpty(i.FontFamily)&&(i.FontFamily=n.Common.IsEmpty(r.FontFamily)?n.LocaleFonts.default:r.FontFamily),i.FontSize===-1&&(i.FontSize=r.FontSize),i.FontStyle===n.StaticValues.Font_Normal&&(i.FontStyle=r.FontStyle),i.FontWeight===n.StaticValues.Font_Normal&&(i.FontWeight=r.FontWeight),n.Common.IsEmpty(i.Underline)&&(i.Underline=r.Underline),n.Common.IsEmpty(i.Strikethrough)&&(i.Strikethrough=r.Strikethrough)),u=n.ListViewHelper.SpreadJSStyleHelper.generateStlyeObject(i),delete u.wordWrap,delete u.hAlign,delete u.vAlign,delete u.textIndent,n.Common.IsEmpty(t.Underline)&&n.Common.IsEmpty(t.Strikethrough)&&delete u.textDecoration,u)},i}();n.ConditionFormatRuleHelper=i})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var v=function(){function n(){}return n}(),t,i,r,u,f,e,o,s,h,c,l,a;n.ConditionalFormattingMetadata=v;t=function(){function n(){}return n}();n.ConditionRuleModel=t;i=function(){function n(){}return n}();n.CellValueRuleParam=i;r=function(){function n(){}return n}();n.SpecificTextRuleParam=r;u=function(){function n(){}return n}();n.DateOccurringRuleParam=u;f=function(){function n(){}return n}();n.TwoColorScaleRuleParam=f;e=function(){function n(){}return n}();n.ThreeColorScaleRuleParam=e;o=function(){function n(){}return n}();n.IconSetRuleParam=o;s=function(){function n(){}return n}();n.DataBarRuleParam=s;h=function(){function n(){}return n}();n.IconCriterion=h;c=function(){function n(){}return n}();n.Top10RuleParam=c;l=function(){function n(){}return n}();n.AverageRuleParam=l;a=function(){function n(){}return n}();n.FormulaRuleParam=a})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t=function(){function t(n){this._runTimePageName=n;this._dependences=[];this._dependenceListviews=[]}return t.prototype.getDependences=function(){return this._dependences},Object.defineProperty(t.prototype,"dependenceListviews",{get:function(){return this._dependenceListviews},enumerable:!1,configurable:!0}),t.prototype.HandleFormulaInConditionFormat=function(n){var t=n.Params;switch(n.RuleType){case 1:this.HandleCellValueRuleParam(t);break;case 2:this.HandleSpecificTextRuleParam(t);break;case 6:this.HandleTwoColorScaleRuleParam(t);break;case 7:this.HandleThreeColorScaleRuleParam(t);break;case 10:this.HandleFormulaRuleParam(t);break;case 11:this.HandleIconSetRuleParam(t);break;case 12:this.HandleDataBarRuleParam(t)}},t.prototype.HandleCellValueRuleParam=function(n){this.HandleFormula(n,"Value1");this.HandleFormula(n,"Value2")},t.prototype.HandleSpecificTextRuleParam=function(n){this.HandleFormula(n,"Value")},t.prototype.HandleTwoColorScaleRuleParam=function(n){this.HandleFormula(n,"MaximumValue");this.HandleFormula(n,"MinimumValue")},t.prototype.HandleThreeColorScaleRuleParam=function(n){this.HandleFormula(n,"MaximumValue");this.HandleFormula(n,"MinimumValue");this.HandleFormula(n,"MidpointValue")},t.prototype.HandleIconSetRuleParam=function(n){for(var i=n.IconCriteria.$values,t=0;t<i.length;t++)this.HandleFormula(i[t],"Value")},t.prototype.HandleDataBarRuleParam=function(n){this.HandleFormula(n,"MaximumValue");this.HandleFormula(n,"MinimumValue")},t.prototype.HandleFormulaRuleParam=function(n){this.HandleFormula(n,"Formula")},t.prototype.HandleFormula=function(t,i){var e=t[i],r,u;if(typeof e=="string"&&(r=e,r=r.trim(),r.length>0&&r[0]==="="))try{var o=n.FormulaHelper.parse(r),f=this,s=this.adjustFormula(o,function(n){return f.adjustCellExpression(n)},function(n){return f.adjustRangeExpression(n)},function(n){return f.adjustNameExpression(n)});s!==o&&(u=n.FormulaHelper.unparse(s),u="="+u,t[i]=u)}catch(h){}},t.prototype.adjustCellExpression=function(t){var i=n.Common.getLocatedListview(this._runTimePageName,t.row,t.column),r,f,u;return i&&n.SpreadJSView&&i instanceof n.SpreadJSView?(f=i.getConditionFormatCalcSourceName(),r=n.ForguncyData.pageInfo.formulaManager.getCalcSource(f),u=i.getContentRangeInfo(),t.row=t.row-u.Row,t.column=t.column-u.Column,this._dependenceListviews.indexOf(i.getCalcSheetName())===-1&&this._dependenceListviews.push(i.getCalcSheetName())):(r=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this._runTimePageName),this._dependences.push({Row:t.row,Column:t.column,ColumnCount:1,RowCount:1})),n.FormulaHelper.createCellExpression(r,null,t.row,t.column,t.rowRelative,t.columnRelative)},t.prototype.adjustRangeExpression=function(t){var i=n.Common.getLocatedListview(this._runTimePageName,t.row,t.column),u,r;return i?(u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(i.getCalcSheetName()),r=i.getContentRangeInfo(),t.row=t.row-r.Row,t.column=t.column-r.Column,t.endRow=t.endRow-r.Row,t.endColumn=t.endColumn-r.Column,this._dependenceListviews.indexOf(i.getCalcSheetName())===-1&&this._dependenceListviews.push(i.getCalcSheetName())):(u=n.ForguncyData.pageInfo.formulaManager.getCalcSource(this._runTimePageName),this._dependences.push({Row:t.row,Column:t.column,ColumnCount:t.endColumn-t.column+1,RowCount:t.endRow-t.row+1})),n.FormulaHelper.createRangeExpression(u,null,t.row,t.column,t.endRow,t.endColumn,t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative)},t.prototype.adjustNameExpression=function(n){return this._dependences.push(n.value),n},t.prototype.adjustFormula=function(t,i,r,u){var e,f,o,a;if(!t)return t;if(e=this,f=GC.Spread.CalcEngine.ExpressionType,t.type===f.operator){var s=t,v=s.value,y=s.value2,p=e.adjustFormula(v,i,r,u),w=e.adjustFormula(y,i,r,u);if(v!==p||y!==w)return n.FormulaHelper.createOperatorExpression(s.operatorType,p,w)}else if(t.type===f.function){var h=t,b=[],c=void 0,l=!1;for(o=0;o<h.arguments.length;o++)c=h.arguments[o],a=e.adjustFormula(c,i,r,u),l=l||c!==a,b.push(a);if(l)return n.FormulaHelper.createFunctionExpression(h,b)}else{if(t.type===f.reference)return n.FormulaHelper.isCellExpression(t)?i(t):r(t);if(t.type===f.parentheses){var g=t,k=g.value,d=e.adjustFormula(k,i,r,u);if(k!==d)return n.FormulaHelper.createParenthesesExpression(d)}else if(t.type===f.name)return u(t)}return t},t}();n.ConditionFormatFormulaHelper=t})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){function ri(t,i,r,u,f,e){n.Common.IsEmpty(u)&&typeof t=="object"&&(n.Common.IsEmpty(r)||typeof r=="function")&&(n.Common.IsEmpty(i)||typeof i=="function")?n.SendMailCommand.sendMailMessage(t,i,r):n.Common.IsEmpty(e)===!1?n.SendMailCommand.sendMail(t,i,r,u,f,e):typeof u=="string"?n.SendMailCommand.sendMail(t,i,r,u,f,e):n.SendMailCommand.sendMail("",t,i,r,u,f)}function ui(t){try{return n.Convertor.fromOADateToDate(t)}catch(i){n.ErrorHelper.printJavascriptAIPError("OADate","ConvertOADateToDate",i)}}function fi(t){try{return n.Convertor.fromDateToOADate(t)}catch(i){n.ErrorHelper.printJavascriptAIPError("OADate","ConvertDateToOADate",i)}}function ei(t){return n.ColorHelper.Convert(t)}var i="rowIndex",o="fn",d="getCell",at="getListView",vt="getCellArray",w="getValue",c="setValue",e="bind",l="unbind",yt="selectRow",st="addNewRow",pt="executeCommand",wt="getVariableValue",bt="setVariableValue",kt="getAllVariableValues",r="Page",a="CommandHelper",f="Cell",u="ListView",t=function(n){return n=String(n),n.toLowerCase()},s=function(t,i,r,u){return typeof t!="function"?(n.ErrorHelper.printJavascriptAIPError(i,r,n.Common.format(n.RS.InvalidFunctionParam,u)),!1):!0},dt=function(){function n(){}return n.Loaded="loaded",n.PageDefaultDataLoaded="pagedefaultdataloaded",n.PopupClosed="popupclosed",n}(),g,nt,ht,v,ct,b,k,y,tt,it,rt,ut,p,ft,h,et,gt,ni,ti,ii,ot,lt;n.PageEvents=dt;g=function(){function i(){this._supportedForguncyEvents=["loaded","pagedefaultdataloaded","popupclosed"];this._elements=new v}return i.prototype._getRunTimePageNames=function(t){return t?null:[n.StaticValues.RunTimeNormalPage,n.StaticValues.RunTimeMasterPage]},i.prototype.getCell=function(n,t){return t===void 0&&(t=!0),this._elements.getCell(n,this._getRunTimePageNames(t))},i.prototype.getCellByLocation=function(n){return this._elements.getCellByLocation(n)},i.prototype.getCellArray=function(n,t){return t===void 0&&(t=!0),this._elements.getCellArray(n,this._getRunTimePageNames(t))},i.prototype.getContainerCells=function(n){return n===void 0&&(n=!0),this._elements.getContainerCells(this._getRunTimePageNames(n))},i.prototype.getSubPageInfoByPageID=function(t){var i,r;return this._getRunTimePageNames(!1).indexOf(t)>=0?null:(i=n.PageManager.getContainerCell(t),!i||!i.cellType)?null:(r=this._elements._getCellByPageCell([i])[0],!r)?null:r.getSubPageByPageID(t)},i.prototype.getListView=function(n,t){return t===void 0&&(t=!0),this._elements.getListView(n,this._getRunTimePageNames(t))},i.prototype.getListViews=function(n){return n===void 0&&(n=!0),this._elements.getListViews(this._getRunTimePageNames(n))},i.prototype.recalc=function(){n.FormulaManager.isReady()&&(n.CustomFunction.ODataFunction.clearCache(null,!1),n.ForguncyData.pageInfo.formulaManager.recalc(!0))},i.prototype.suspendCalc=function(){n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.suspend()},i.prototype.resumeCalc=function(){n.FormulaManager.isReady()&&n.ForguncyData.pageInfo.formulaManager.resume(!0)},i.prototype.reloadBindingData=function(t){n.NormalCellBindingManager.reloadData(t,!0)},i.prototype.getUserName=function(){return n.ForguncyData.userInfo.UserName},i.prototype.getUserInfo=function(){return n.ForguncyData.userInfo},i.prototype.getPageName=function(){return n.ForguncyData.pageInfo.pageName},i.prototype.getMasterPageName=function(){return n.ForguncyData.pageInfo.masterPageName},i.prototype.setCurrentRow=function(t){n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.currentRowInfoCollection&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfoByAPI(t)},i.prototype._init=function(){this._elements.destory();this._elements=new v},i.prototype._pushCurrentState=function(){i._stateStack.push(this._elements);this._elements=new v},i.prototype._popupState=function(){i._stateStack.length!==0&&(this._init(),this._elements=i._stateStack.pop())},i.prototype._clearState=function(){i._stateStack.forEach(function(n){return n.destory()});i._stateStack=[]},i.prototype.ready=function(n){this.bind("loaded",null,n)},i.prototype.bind=function(u,f,h,c){var v=t(u),l,a;this._checkEventType(v,u,e)&&(arguments.length===2?(h=f,f=undefined):arguments.length===3&&typeof f=="function"&&(c=h,h=f,f=undefined),s(h,r,e,o))&&(l=n.Common.IsEmpty(c)||typeof c!="string"?n.ForguncyData.pageInfo?n.ForguncyData.pageInfo.pageName:null:c,a={eventType:v,data:f,fn:h},l?(i._userEvents[l]||(i._userEvents[l]=[]),i._userEvents[l].push(a)):(this._tempReadyEvents||(this._tempReadyEvents=[]),this._tempReadyEvents.push(a)))},i.prototype.unbind=function(u,f,h){var w=t(u),v,y,c,a,p;if(this._checkEventType(w,u,l)&&(v=arguments.length===1||n.Common.IsEmpty(f),v!==!1||s(f,r,e,o))&&(y=n.Common.IsEmpty(h)||typeof h!="string"?n.ForguncyData.pageInfo.pageName:h,c=y?i._userEvents[y]:this._tempReadyEvents,c))for(a=c.length-1;a>=0;a--)p=c[a],p.eventType===w&&(v||p.fn===f)&&c.splice(a,1)},i.prototype.unbindAll=function(t){var r=n.Common.IsEmpty(t)||typeof t!="string"?n.ForguncyData.pageInfo.pageName:t;r?i._userEvents[r]=[]:this._tempReadyEvents=[]},i.prototype._setTempReadyEvents=function(){var r=n.ForguncyData.pageInfo.pageName,t;r&&(this._tempReadyEvents&&this._tempReadyEvents.length>0&&(t=i._userEvents[r],t=t&&t.length>0?this._tempReadyEvents.concat(t):this._tempReadyEvents,i._userEvents[r]=t),this._tempReadyEvents=null)},i.prototype._trigger=function(t){var r=this;this._setTempReadyEvents();t=t.toLowerCase();t==="loaded"&&n.ForguncyData.pageInfo.dataModel.normalCellDataModel.bind("valuechanged",function(n,t){r._onCellValueChanged(t)});this._triggerUserEvents(i._userEvents[n.ForguncyData.pageInfo.pageName],t);this._triggerUserEvents(i._userEvents["*"],t)},i.prototype._triggerUserEvents=function(t,i){var f,e,u,r;if(t)for(f=t.map(function(n){return n}),e=f.length,u=0;u<e;u++)r=f[u],r.eventType===i&&r.fn({data:r.data===undefined?null:r.data},{pageName:n.ForguncyData.pageInfo.pageName})},i.prototype._checkEventType=function(t,i,u){return this._supportedForguncyEvents.indexOf(t)===-1?(n.ErrorHelper.printJavascriptAIPError(r,u,n.Common.format(n.RS.NotSupportEventForPage,i,r)),!1):!0},i.prototype._onCellValueChanged=function(n){var t=this._elements.getExistingCellById(n.id);t!==null&&t.trigger("valuechanged",{oldValue:n.oldValue,newValue:n.newValue})},Object.defineProperty(i.prototype,"AutoDisconnectTimeout",{get:function(){return n.ForguncyData.AutoDisconnectTimeout},set:function(t){n.ForguncyData.AutoDisconnectTimeout=t},enumerable:!1,configurable:!0}),i._userEvents={},i._stateStack=[],i}();n.ForguncyPage=g;nt=function(){function i(){}return i.prototype.executeCellCommand=function(i,r){var f=t(i),u=n.ForguncyData.pageInfo.pageElementManager.cells.getCellByName(f,!0,null);if(u===null){n.ErrorHelper.printJavascriptAIPError(a,d,n.Common.format(n.RS.CannotFindCell,i));return}if(!u.commands){n.ErrorHelper.printJavascriptAIPError(a,pt,n.Common.format(n.RS.CannotFindCommandInCell,i));return}n.ForguncyData.commandExcutor.excuteCommand(u.commands,{runTimePageName:u.runTimePageName,commandTrigger:u.cellType,commandID:u.id,eventType:"Api",callbackOnCommandCompleted:r?function(){return r()}:undefined})},i.prototype.getVariableValue=function(t){var i=n.ForguncyData.parameterManager.getCurrent();return i||n.ErrorHelper.printJavascriptAIPError(a,wt,n.RS.CannotUseCommandParameterInCurrentContext),n.ForguncyData.parameterManager.getValue(t)},i.prototype.setVariableValue=function(t,i){var r=n.ForguncyData.parameterManager.getCurrent();return r||n.ErrorHelper.printJavascriptAIPError(a,bt,n.RS.CannotUseCommandParameterInCurrentContext),n.ForguncyData.parameterManager.setValue(t,i)},i.prototype.getAllVariableValues=function(){var t=n.ForguncyData.parameterManager.getCurrent();return t||n.ErrorHelper.printJavascriptAIPError(a,kt,n.RS.CannotUseCommandParameterInCurrentContext),t},i}();n.ForguncyCommandHelper=nt;ht=function(){function t(){}return t.setCurrentRowByProcessTask=function(t){n.ForguncyData.pageInfo&&n.ForguncyData.pageInfo.currentRowInfoCollection&&n.ForguncyData.pageInfo.currentRowInfoCollection.setCurrentRowInfoByProessTaskId(t)},t}();n.ForguncyInternalPage=ht;v=function(){function i(){this._listViews=null;this._cells=null}return i.prototype.getExistingCellById=function(n){var i,t;if(this._cells){for(i=this._cells.length,t=0;t<i;t++)if(this._cells[t]._getCellId()===n)return this._cells[t]}else this._cells=[];return null},i.prototype._createCell=function(t){var i;return t.runTimePageName&&n.Page.getSubPageInfoByPageID(t.runTimePageName),i=t.cellType instanceof n.ContentContainerCellType?new tt(t):t.cellType instanceof n.UserControlPageCellType?new it(t):t.cellType instanceof n.TabControlCellType?new rt(t):t.cellType instanceof n.RepeaterCellType?new ut(t):new b(t),this._cells===null&&(this._cells=[]),this._cells.push(i),i},i.prototype.getCell=function(i,u){var o=t(i),f=n.ForguncyData.pageInfo.pageElementManager.cells.getCellByName(o,!0,u),e;return f===null?(n.ErrorHelper.printJavascriptAIPError(r,d,n.Common.format(n.RS.CannotFindCell,i)),null):(e=this.getExistingCellById(f.id),e!==null)?e:this._createCell(f)},i.prototype.getCellByLocation=function(t){var u,i,f,e;return t?(u=this._getRunTimePageName(t),n.Common.IsEmpty(u))?null:(i=n.Common.getIdStr(t.Row,t.Column,u),f=this.getExistingCellById(i),f!==null)?f:(e=n.ForguncyData.pageInfo.pageElementManager.cells.getCell(i),e===null)?(n.ErrorHelper.printJavascriptAIPError(r,d,n.Common.format(n.RS.CannotFindCellById,i)),null):this._createCell(e):null},i.prototype._getRunTimePageName=function(t){if(t.PageID)return t.PageID;var i="";return t.PageName&&(i=n.PageManager.getRunTimePageName(t.PageName)),n.Common.IsEmpty(i)?n.StaticValues.RunTimeNormalPage:i},i.prototype.getCellArray=function(i,u){var e=t(i),f=n.ForguncyData.pageInfo.pageElementManager.cells.getCellsByName(e,!0,u);return!f||f.length===0?(n.ErrorHelper.printJavascriptAIPError(r,vt,n.Common.format(n.RS.CannotFindCell,i)),null):this._getCellByPageCell(f)},i.prototype._getCellByPageCell=function(n){var t=this,i=this;return n.map(function(n){var r=t.getExistingCellById(n.id);return r!==null?r:i._createCell(n)})},i.prototype.getContainerCells=function(t){var i=n.ForguncyData.pageInfo.pageElementManager.cells.getAllContainerCells();return t&&(i=i.filter(function(n){return n.runTimePageName&&t.indexOf(n.runTimePageName)>=0})),this._getCellByPageCell(i)},i.prototype.getListView=function(i,u){for(var e,s=t(i),o=this.getListViews(u),f=0;f<o.length;f++)if(e=o[f],e.getName().toLowerCase()===s)return e;return n.ErrorHelper.printJavascriptAIPError(r,at,n.Common.format(n.RS.CannotFindListview,i)),null},i.prototype.getListViews=function(t){var i=this,r=n.ListviewBase.getAllListviews(t);return r.map(function(n){return i._getListviewAPIObject(n)})},i.prototype._getListviewAPIObject=function(n){var t=this._getExistingListview(n.getCalcSheetName());return t?t:this._createListview(n)},i.prototype._getExistingListview=function(n){var i,t;if(this._listViews)for(i=this._listViews.length,t=0;t<i;t++)if(this._listViews[t]._getUniqueID()===n)return this._listViews[t];return null},i.prototype._createListview=function(n){this._listViews===null&&(this._listViews=[]);var t=new et(n);return this._listViews.push(t),t},i.prototype.destory=function(n){this._listViews&&(this._listViews.filter(function(t){return!n||n.indexOf(t.getRunTimePageName())>=0}).forEach(function(n){return n.unbindAll()}),this._listViews=n?this._listViews.filter(function(t){return n.indexOf(t.getRunTimePageName())===-1}):null);this._cells&&(this._cells.filter(function(t){return!n||n.indexOf(t._getPageID())>=0}).forEach(function(n){return n.unbindAll()}),this._cells=n?this._cells.filter(function(t){return n.indexOf(t._getPageID())===-1}):null)},i}();n.APIPageElements=v;ct=function(){function n(){}return n.ValueChanged="valuechanged",n.Click="click",n.MouseEnter="mouseenter",n.MouseLeave="mouseleave",n.SelectionChanged="selectionchanged",n.PivottableClick="pivottableclick",n}();n.CellEvents=ct;b=function(i){function r(n){var t=i.call(this)||this;return t._pageCell=n,t}return __extends(r,i),r.prototype._getPageID=function(){return this._pageCell.runTimePageName},r.prototype._getCellId=function(){return this._pageCell.id},r.prototype.getValue=function(){return n.ForguncyData.pageInfo.dataModel.normalCellDataModel.getValue(this._pageCell.id)},r.prototype.setValue=function(t){if(!this._pageCell.cellType.allowSetValueByUser){n.ErrorHelper.printJavascriptAIPError(f,c,n.Common.format(n.RS.NotSupportSetValue,this.getCellName()));return}var i=this.getValue();(t===undefined&&(t=null),n.Common.equals(i,t))||n.ForguncyData.pageInfo.dataModel.normalCellDataModel.setValue(this._pageCell.id,{newValue:t},7)},r.prototype.getCellName=function(){return this._pageCell.name&&this._pageCell.name.length>0?this._pageCell.name[0]:n.Common.getA1ReferenceString(this._pageCell.row,this._pageCell.column,!0,!0)},r.prototype.setText=function(n){n===undefined&&(n=null);var t=this._pageCell.cellType.getValueFromListviewText(n);this.setValue(t)},r.prototype.setVisible=function(n){this._pageCell.setVisible(n)},r.prototype.hide=function(){this.setVisible(!1)},r.prototype.show=function(){this.setVisible(!0)},r.prototype.setBackColor=function(n){this._pageCell.setBackColor(n)},r.prototype.setForeColor=function(n){this._pageCell.setForeColor(n)},r.prototype.disable=function(){this._pageCell.disable()},r.prototype.enable=function(){this._pageCell.enable()},r.prototype.setReadOnly=function(n){this._pageCell.setReadOnly(n)},r.prototype.hasFocus=function(){var n=this._pageCell.cellType;return n?n.hasFocus():!1},r.prototype.setFocus=function(){var n=this._pageCell.cellType;n&&n.setFocus()},r.prototype.getControl=function(){return this._pageCell.cellType.getControl()},r.prototype.bind=function(r,u,h){if(arguments.length===2&&(h=u,u=undefined),s(h,f,e,o)){var c=t(r);c==="valuechanged"||this._pageCell.cellType.supportedEvents.indexOf(c)>=0?(i.prototype.bind.call(this,c,u,h),c!=="valuechanged"&&this._pageCell.cellType.bind(c,u,h)):n.ErrorHelper.printJavascriptAIPError(f,e,n.Common.format(n.RS.NotSupportEventForCellOrListview,r,f,this.getCellName()))}},r.prototype.unbind=function(r,u){var h=arguments.length===1,e;(h!==!1||s(u,f,l,o))&&(e=t(r),e==="valuechanged"||this._pageCell.cellType.supportedEvents.indexOf(e)>=0?(i.prototype.unbind.call(this,e,u),e!=="valuechanged"&&this._pageCell.cellType.unbind(e,u)):n.ErrorHelper.printJavascriptAIPError(f,l,n.Common.format(n.RS.NotSupportEventForCellOrListview,r,f,this.getCellName())))},r.prototype.unbindAll=function(){for(var n,r=this._events.length,t=0;t<r;t++)n=this._events[t],this._pageCell.cellType.supportedEvents.indexOf(n.eventType)>=0&&this._pageCell.cellType.unbind(n.eventType,n.fn);i.prototype.unbindAll.call(this)},r.prototype.getCellType=function(){return this._pageCell.cellType},r}(n.EventClassBase);n.Cell=b;k=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(b);n.ContainerCellBase=k;y=function(n){function t(t){var r=n.call(this,t)||this,i;return r._subPages=[],i=r,i._cellType=t.cellType,i._cellType.bind("pageingInfoChanged",function(n,t){i._updateSubPage(t.tabIndex)}),i._cellType.subPageInfos.forEach(function(n,t){return i._updateSubPage(t)}),r}return __extends(t,n),t.prototype._updateSubPage=function(n){n===void 0&&(n=0);this._subPages[n]||(this._subPages[n]=new p(null,null));var t=this._subPages[n],i=this._cellType.subPageInfos[n],r=i?i.runTimeNormalPageName:null,u=i?i.runTimeMasterPageName:null;(r!==t.runTimeNormalPageName||u!==t.runTimeMasterPageName)&&(t.destory(),t.runTimeNormalPageName=r,t.runTimeMasterPageName=u)},t.prototype._getSubPage=function(n){return n===void 0&&(n=0),this._subPages[n]||(this._subPages[n]=new p(null,null)),this._subPages[n]},t.prototype.getSubPageByPageID=function(n){var t=this._subPages.filter(function(t){return t.runTimeMasterPageName===n||t.runTimeNormalPageName===n});return t.length>0?t[0]:null},t}(k);n.SubPageContainerCellBase=y;tt=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getContentPage=function(){return this._getSubPage(0)},t}(y);n.ContentContainerCell=tt;it=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getContentPage=function(){return this._getSubPage(0)},t}(y);n.UserControlPageCell=it;rt=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getTabPage=function(n){return this._getSubPage(n)},t.prototype.showTab=function(n){this._cellType&&this._cellType.showTab(n)},t.prototype.getActiveTabIndex=function(){return this._cellType?this._cellType.getActiveTabIndex():-1},t.prototype.getTabCount=function(){return this._cellType?this._cellType.getTabCount():0},t}(y);n.TabControlCell=rt;ut=function(t){function i(n){var r=t.call(this,n)||this,i;return r._subPages=[],i=r,i._cellType=n.cellType,i._cellType.bind("subpagechanged",function(){i.removeSubPage()}),r}return __extends(i,t),i.prototype.removeSubPage=function(){var t=this;this._subPages.filter(function(n){return!t._cellType.containRunTimePage(n.runTimeNormalPageName)}).forEach(function(n){n.destory();n.runTimeNormalPageName=null});this._subPages=this._subPages.filter(function(t){return!n.Common.IsEmpty(t.runTimeNormalPageName)})},i.prototype.getSubPageByPageID=function(n){var t=this._subPages.filter(function(t){return t.runTimeNormalPageName===n}),i;return t&&t.length>0?t[0]:this._cellType.containRunTimePage(n)?(i=new ft(n),this._subPages.push(i),i):null},i}(k);n.RepeaterCell=ut;p=function(){function t(t,i){t===void 0&&(t=n.StaticValues.RunTimeNormalPage);i===void 0&&(i=n.StaticValues.RunTimeMasterPage);this.runTimeNormalPageName=t;this.runTimeMasterPageName=i}return t.prototype._getRunTimePageNames=function(){return[this.runTimeNormalPageName,this.runTimeMasterPageName].filter(function(t){return!n.Common.IsEmpty(t)})},t.prototype.getCell=function(t){return n.Page._elements.getCell(t,this._getRunTimePageNames())},t.prototype.getCellArray=function(t){return n.Page._elements.getCellArray(t,this._getRunTimePageNames())},t.prototype.getContainerCells=function(){return n.Page._elements.getContainerCells(this._getRunTimePageNames())},t.prototype.getListView=function(t){return n.Page._elements.getListView(t,this._getRunTimePageNames())},t.prototype.getListViews=function(){return n.Page._elements.getListViews(this._getRunTimePageNames())},t.prototype.getPageName=function(){return n.Common.IsEmpty(this.runTimeNormalPageName)?null:n.PageManager.getDesignerPageName(this.runTimeNormalPageName,!1)},t.prototype.getMasterPageName=function(){return n.Common.IsEmpty(this.runTimeMasterPageName)?null:n.PageManager.getDesignerPageName(this.runTimeMasterPageName,!1)},t.prototype.destory=function(){n.Page._elements.destory(this._getRunTimePageNames())},t}();n.SubPage=p;ft=function(n){function t(t){return n.call(this,t,null)||this}return __extends(t,n),t.prototype.getPageName=function(){return null},t}(p);n.TemplatePage=ft;h=function(){function n(){}return n.Reloaded="reloaded",n.SelectionChanged="selectionchanged",n.SelectedRowsChanged="selectedrowschanged",n.ValueChanged="valuechanged",n.PageingInfoChanged="pageingInfoChanged",n}();n.ListViewEvents=h;et=function(a){function v(n,t){var i,r,u;if(t===void 0&&(t=!0),i=a.call(this)||this,i._grid=n,t){r=i;for(u in h)(function(n){r._grid.bind(n,function(t,i){r._triggerListviewEvent(n,i)})})(h[u])}return i}return __extends(v,a),v.prototype._triggerListviewEvent=function(n,t){try{this.trigger(n,t)}catch(i){}},v.prototype.getRunTimePageName=function(){return this._grid.runTimePageName},v.prototype._getUniqueID=function(){return this._grid.getCalcSheetName()},v.prototype._getLocationStr=function(){return this._grid.getLocationString()},v.prototype.getName=function(){return this._grid.getListviewName()},v.prototype.getDataTableName=function(){return this._grid.getDataTableName()},v.prototype.getControl=function(){return this._grid.getControl()},v.prototype.getRowCount=function(){return this._grid.getListDataCount()},v.prototype.getSelectedRowIndex=function(){return this._grid.getCurrentRowIndex()},v.prototype.getSelectedRowIndexs=function(){return this._grid.getSelectedRowsIndexes()},v.prototype.getSelectedRowsData=function(){return this._grid.getSelectedRowsDataByAPI()},v.prototype.clearSelectedRowByQuery=function(t){return n.DelayRefresh.RunNow(),this._grid.clearSelectedRowByQuery(t)},v.prototype.selectRowsByValue=function(t,i){var r=this._getValidColumnIndexParam(i,"selectRowsByValue");if(r!==-1)return n.DelayRefresh.RunNow(),this._grid.selectRowsByValue(t,r)},v.prototype.getQuery=function(n){return this._grid.getListDataModel().getRowQuery(n)},v.prototype.getMergedColumnInfos=function(){return this._grid.getMergedColumnInfos()},v.prototype.getDesignerRangeInfo=function(){return this._grid.getRangeInfo()},v.prototype.getText=function(t,r){if(t=this._getValidRowIndexParam(t,w,i),t===-1)return"";var u=this._getValidColumnIndexParam(r,w);return u===-1?"":(n.DelayRefresh.RunNow(),this._grid.getText(t,u))},v.prototype.getValue=function(n,t){if(n=this._getValidRowIndexParam(n,w,i),n===-1)return null;var r=this._getValidColumnIndexParam(t,w);return r===-1?null:this._grid.getListDataModel().getValue(n,r)},v.prototype._getValidColumnIndexParam=function(i,r,f){var h=this,c,e,o,s;if(f===void 0&&(f=!1),c=function(i){var f,r,u,e;return n.Common.IsEmpty(i)?{colIndex:-1,isName:!0}:typeof i=="string"&&(f=t(i),r=h._grid.getColIndexOfNamedColumn(f,!1),r!==-1)?{colIndex:r,isName:!0}:(u=Number(i),isNaN(u))?{colIndex:-1,isName:!0}:(e=h._grid.getDataColIndexByMergedColIndex(u),{colIndex:e,isName:!1})},e=c(i,r),e.colIndex===-1)if(o=n.Common.IsEmpty(i)?"":i.toString(),s=e.isName?n.Common.format(n.RS.CannotFindColumn,o,this.getName()):n.Common.format(n.RS.CannotFindColumnIndex,o,this.getName()),f)throw s;else n.ErrorHelper.printJavascriptAIPError(u,r,s);return e.colIndex},v.prototype.setValue=function(n,t,r){if(n=this._getValidRowIndexParam(n,c,i),n!==-1){var u=this._getValidColumnIndexParam(t,c);u!==-1&&(r=this._ajustValue(r),this._grid.getListDataModel().setValue(n,u,r,7))}},v.prototype.setText=function(n,t,r){if(n=this._getValidRowIndexParam(n,c,i),n!==-1){var u=this._getValidColumnIndexParam(t,c);u!==-1&&this._grid.setCellText(n,u,r)}},v.prototype.addNewRow=function(n,t){if(t===void 0&&(t=!1),n){var i=n instanceof Array?this._getRowDataFromColumnIndexData(n):this._getRowDataFromColumnNameData(n);!i||i.length<=0||(t?this._grid.addNewRowWithText(i):this._grid.addNewRow(i))}},v.prototype.insertRow=function(n,t,i){if((i===void 0&&(i=!1),!(n<0)&&!(n>=this.getRowCount()))&&t){var r=t instanceof Array?this._getRowDataFromColumnIndexData(t):this._getRowDataFromColumnNameData(t);!r||r.length<=0||(i?this._grid.insertRowWithText(n,r):this._grid.insertRow(n,1,r,!1,!1))}},v.prototype.importData=function(t,i,r,u,f,e){var o=this;t||(t=[]);var s=t.map(function(n){return n instanceof Array?o._getRowDataFromColumnIndexData(n):o._getRowDataFromColumnNameData(n)}),h=u===null||u===void 0?void 0:u.map(function(n){return o._getValidColumnIndexParam(n,"importData")}),c=f===null||f===void 0?void 0:f.map(function(n){return o._getValidColumnIndexParam(n,"importData")}),l=new n.ListviewDataImportHelper(this._grid);i?l.importDataWithText(s,r,h,c,!0,e):l.importData(s,r,h,c,e)},v.prototype._getRowDataFromColumnNameData=function(n){var r=[],t,i;for(t in n){if(i=this._getValidColumnIndexParam(t,st),i<0)return null;r[i]=this._ajustValue(n[t])}return r},v.prototype._getRowDataFromColumnIndexData=function(n){for(var i,r=[],t=0;t<n.length;t++){if(i=this._getValidColumnIndexParam(t,st),i<0)return null;n[t]!==undefined&&(r[i]=this._ajustValue(n[t]))}return r},v.prototype._ajustValue=function(n){return n===undefined?null:n},v.prototype.deleteRow=function(n){(n=this._getValidRowIndexParam(n,"deleteRow",i),n!==-1)&&this._grid.deleteRowByJavascriptAPI(n)},v.prototype.selectRow=function(n){n=this._getValidRowIndexParam(n,yt,i);n!==-1&&this._grid.selectRow(n)},v.prototype.addSelectedRow=function(t){t=this._getValidRowIndexParam(t,"addSelectedRow",i);t!==-1&&(n.DelayRefresh.RunNow(),this._grid.addSelectedRow(t))},v.prototype.clearSelectedRow=function(t){t=this._getValidRowIndexParam(t,"clearSelectedRow",i);t!==-1&&(n.DelayRefresh.RunNow(),this._grid.clearSelectedRow(t))},v.prototype.selectAllRows=function(){n.DelayRefresh.RunNow();this._grid.selectAllRows()},v.prototype.clearAllSelectedRows=function(){n.DelayRefresh.RunNow();this._grid.clearAllSelectedRows()},v.prototype.isSelectedRow=function(t){return t=this._getValidRowIndexParam(t,"isSelectedRow",i),t!==-1?(n.DelayRefresh.RunNow(),this._grid.isSelectedRow(t)):!1},v.prototype._getValidRowIndexParam=function(t,i,r,f){var o,s,e;return(f===void 0&&(f=!1),o=this.getRowCount(),f&&this._grid.getNewRowIndex()>=0&&o++,s=function(t,i){if(n.Common.IsEmpty(t))return{rowIndex:-1,error:n.Common.format(n.RS.InvalidNumberParam,i)};var r=Number(t);return isNaN(r)?{rowIndex:-1,error:n.Common.format(n.RS.InvalidNumberParam,i)}:r<0||r>=o?{rowIndex:-1,error:n.Common.format(n.RS.IndexOutOfRange,i)}:{rowIndex:r}},e=s(t,r),e.error)?(n.ErrorHelper.printJavascriptAIPError(u,i,e.error),-1):e.rowIndex},v.prototype.reload=function(){this._grid.fillData(null,!0)},v.prototype.clearAllColumnFilters=function(){n.ColumnFilterHelper.clearColumnFilterCache(this._grid.getLocationString())},v.prototype.bind=function(i,f,h){var c=t(i);if(arguments.length===2&&(h=f,f=undefined),s(h,r,e,o)){if(this._isSupportedEvent(c)){a.prototype.bind.call(this,c,f,h);return}n.ErrorHelper.printJavascriptAIPError(u,e,n.Common.format(n.RS.NotSupportEventForCellOrListview,i,u,this.getName()))}},v.prototype._isSupportedEvent=function(n){for(var t in h)if((h[t]+"").toLowerCase()===n)return!0;return!1},v.prototype.unbind=function(i,r){var h=arguments.length===1,e;if(h!==!1||s(r,f,l,o)){if(e=t(i),this._isSupportedEvent(e)){a.prototype.unbind.call(this,e,r);return}n.ErrorHelper.printJavascriptAIPError(u,l,n.Common.format(n.RS.NotSupportEventForCellOrListview,i,u,this.getName()))}},v.prototype.getPaginationInfo=function(){return this._grid.getPagingInfo()},v.prototype.usePaginationDisplay=function(n,t){(t===void 0&&(t=1),n<=0||t<0)||this._paginationDisplayListview(4,t,n)},v.prototype.goToFirstPage=function(){this._paginationDisplayListview(0,1)},v.prototype.goToPreviousPage=function(){var t=n.ForguncyData.pageingInfoList.GetPageIndex(this._grid.getLocationString());this._paginationDisplayListview(1,t)},v.prototype.goToNextPage=function(){var t=n.ForguncyData.pageingInfoList.GetPageIndex(this._grid.getLocationString());this._paginationDisplayListview(2,t)},v.prototype.goToLastPage=function(){this._paginationDisplayListview(3,1)},v.prototype.goToSpecifiedPage=function(n){n<0||this._paginationDisplayListview(4,n)},v.prototype._paginationDisplayListview=function(t,i,r){if(r===void 0&&(r=0),r===0&&(r=n.ForguncyData.pageingInfoList.GetLimit(this._grid.getLocationString())),!(r<=0)){var u={$type:"Forguncy.Model.GoToPageCommand, ServerDesignerCommon",targetPageKind:t,ListviewName:this.getName(),Limit:r,TargetPageIndex:i};n.GoToPageCommand.gotoPage(u,this._grid.runTimePageName)}},v.prototype.showLoadingIndicator=function(){this._grid.showLoadingIndicator()},v.prototype.hiddenLoadingIndicator=function(){this._grid.hiddenLoadingIndicator()},v.prototype.commitEditChange=function(){return this._grid.commitEditChange()},v.prototype.getRowValue=function(n){return this._grid.getRowValue(n)},v.prototype.getDataCommitMode=function(){return this._grid.GetDataCommitMode()},v.prototype.getDataValidationTime=function(){return this._grid.GetDataValidationTime()},v.prototype.isRowHeaderVisible=function(){return n.SpreadJSView&&this._grid instanceof n.SpreadJSView?this._grid.isRowHeaderVisible():!1},v.prototype.isRowHeaderCheckBoxVisible=function(){return n.SpreadJSView&&this._grid instanceof n.SpreadJSView?this._grid.isRowHeaderCheckBoxVisible():!1},v.prototype.setSelection=function(t,i){n.SpreadJSView&&this._grid instanceof n.SpreadJSView&&this._grid.setSelectionWithEvent(t,i,1,1)},v.prototype.hideColumns=function(n){return this.showOrHideColumns(n,!0)},v.prototype.showColumns=function(n){return this.showOrHideColumns(n,!1)},v.prototype.showOrHideColumns=function(t,i){var f=this,r,u;!t||t.length<=0||(r=i?"hideColumns":"showColumns",u=t.map(function(n){return f._getValidColumnIndexParam(n,r,!0)}),new n.ListivewColumnManager(this._grid).showOrHideColumns(u,i))},v.prototype.Reload=function(t,i){if(t===void 0&&(t=!1),i===void 0&&(i=!1),this.isTrue(t)){if(!this._grid.tryCommitValueBeforeQueryOrSort(!0))return;n.ColumnFilterHelper.clearColumnFilterCache(this._grid.getLocationString())}if(this.isTrue(i)){if(!this._grid.tryCommitValueBeforeQueryOrSort(!0))return;n.ForguncyData.pageInfo.sortInfoCache[this._grid.getLocationString()]=undefined}this.reload()},v.prototype.isTrue=function(t){return!n.Common.IsEmpty(t)&&t!==0&&t!==!1&&(t+"").toLowerCase()!=="false"},v.prototype.GetCurrentRowIndex=function(){return{RowIndex:this.getSelectedRowIndex()}},v.prototype.GetCurrentColumnIndex=function(){return{ColumnIndex:this._grid.getMergedColIndexByDataColIndex(this._grid.getCurrentColIndex())}},v.prototype.GetSelectedRows=function(){var t,n=this.getSelectedRowIndexs();return{SelectedRows:n!==null&&n!==void 0?n:[],SelectedRowCount:(t=n===null||n===void 0?void 0:n.length)!==null&&t!==void 0?t:0}},v.prototype.ClearAllSelectedRows=function(){this.clearAllSelectedRows()},v.prototype.SelectAllRows=function(){this.selectAllRows()},v.prototype.AddRowSelection=function(n){this.addSelectedRow(n)},v.prototype.RemoveRowSelection=function(n){this.clearSelectedRow(n)},v.prototype.HideColumn=function(t){try{this.hideColumns([t])}catch(i){n.ErrorHelper.printJavascriptAIPError(u,"HideColumn",i)}},v.prototype.ShowColumn=function(t){try{this.showColumns([t])}catch(i){n.ErrorHelper.printJavascriptAIPError(u,"HideColumn",i)}},v.prototype.SelectCell=function(t,r){var f="SelectCell",e,o;if((t=this._getValidRowIndexParam(t,f,i,!0),t!==-1)&&(e=this._getValidColumnIndexParam(r,f),e!==-1)){if(o=this._grid.getVisibleColumnIndexInListViewByDataIndex(e),o===-1){n.ErrorHelper.printJavascriptAIPError(u,f,n.RS.CannotSelectCellInColumn);return}this._grid.selectCell(t,o)}},v.prototype.GetValue=function(n,t){return{Value:this.getValue(n,t)}},v.prototype.GetText=function(n,t){return{Text:this.getText(n,t)}},v.prototype.SetValue=function(n,t,i){this.setValue(n,t,i)},v.prototype.SetText=function(n,t,i){this.setText(n,t,i)},v}(n.EventClassBase);n.ListView=et,function(n){n[n.Add=0]="Add";n[n.Merge=1]="Merge";n[n.Replace=2]="Replace";n[n.MergeIgnoreEdit=3]="MergeIgnoreEdit";n[n.ReplaceIgnoreEdit=4]="ReplaceIgnoreEdit"}(gt=n.ImportMode||(n.ImportMode={})),function(n){n[n.ExistSameKeys=0]="ExistSameKeys";n[n.ValidateError=1]="ValidateError"}(ni=n.ImportError||(n.ImportError={})),function(n){n[n.RowHeader=0]="RowHeader";n[n.SelectedColumn=1]="SelectedColumn";n[n.DataColumn=2]="DataColumn"}(ti=n.ListviewColumnType||(n.ListviewColumnType={})),function(n){n[n.Other=0]="Other";n[n.Number=1]="Number";n[n.Bool=2]="Bool";n[n.Date=3]="Date";n[n.Time=4]="Time";n[n.String=5]="String";n[n.Image=6]="Image";n[n.Attachment=7]="Attachment";n[n.User=8]="User"}(ii=n.ColumnDataType||(n.ColumnDataType={}));n.Page=new g;n.CommandHelper=new nt;ot=function(){function t(){}return t.prototype.getBaseUrl=function(){return n.ForguncyData.ForguncyRoot},t.prototype.getBuiltInImageFolderPath=function(){return n.ForguncyData.ForguncyRoot+"Resources/Images/CellTypeBuiltInImage/"},t.prototype.getImageEditorUploadImageFolderPath=function(){return n.ForguncyData.ForguncyRoot+"GeneratedResources/Images/GenerateImages/ImageCellType/"},t.prototype.getUploadFileFolderPathInDesigner=function(){return n.ForguncyData.ForguncyRoot+"GeneratedResources/Images/UserCustomCellTypeFiles/"},t.prototype.getUploadImageFolderPathInServer=function(){return n.ForguncyData.ForguncyRoot+"Upload/"},t.prototype.getUserFileFolderPath=function(){return n.ForguncyData.ForguncyRoot+"GeneratedResources/UserFile/"},t.prototype.getPluginRootPath=function(t){return n.ModuleLoader.getPluginRoot(t)},t}();n.SpecialPath=ot;lt=function(){function t(){}return t.post=function(t,i,r,u){u===void 0&&(u=!0);u?n.Common.forguncyPost(t,i,r):n.Common.forguncyPostSync(t,i,r)},t.getCellLocation=function(t,i){var r=n.FormulaHelper.getCellIdInfos(t,n.FormulaHelper.getFormulaCalcInfo(i));return r.length>=1?{Row:r[0].row,Column:r[0].col,PageID:r[0].suffix,PageName:n.PageManager.getDesignerPageName(r[0].suffix,!1)}:null},t.preSetEchartOption=function(){},t.preProcessImageSrc=function(t){return n.ModuleLoader.getCdnUrl(t,n.ForguncyData.ForguncyRoot)},t.SpecialPath=new ot,t}();n.Helper=lt;n.SendMail=ri;n.ConvertOADateToDate=ui;n.ConvertDateToOADate=fi;n.ConvertToCssColor=ei})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){function b(n,t,u,f){var o={};o[r]=t;i(e,n,o,u,f)}function k(t,i,r,u){u===void 0&&(u=!0);n.Common.operateODataPost(y,{ODataString:t},i,r,u)}function d(i,r,u,f){f===void 0&&(f=!0);var s="Home/GetTableDataForPlugins",h=n.Common.IsEmpty(i.QueryPolicy)?!0:i.QueryPolicy.Distinct,c=n.Common.getRunTimePageNameFromFormulaCalcContext(r),l=n.Common.IsEmpty(i.QueryPolicy)?n.QueryNullPolicy.QueryAllItemsWhenValueIsNull:i.QueryPolicy.QueryNullPolicy,o={tableName:i.TableName,columns:i.Columns,queryCondition:n.ConditionHelper.getComputedSqlConditionFormula(i.QueryCondition,c,l,r.RowOffset,r.ColumnOffset,r.ListviewRowInfo),sortCondition:i.SortCondition,distinct:h},e=JSON.stringify(o),a=n.Common.IsEmpty(i.QueryPolicy)?!1:i.QueryPolicy.IgnoreCache;a||t[e]===undefined?f?n.Common.forguncyPost(s,o,function(n){t[e]=n;u&&u(n)}):n.Common.forguncyPostSync(s,o,function(n){t[e]=n;u&&u(n)}):u&&u(t[e])}function g(n,t,u,f){var e={};e[r]=t;i(a,n,e,u,f)}function nt(n,t,r,u){var f={};f[c]=t;i(v,n,f,r,u)}function tt(n,t,u,f,e){var o={};o[r]=t;o[h]=u;i(l,n,o,f,e)}function it(n,t,r){var f={};f.updateData=n;i(u,null,f,t,r)}function rt(t,i){n.Common.forguncyPost(p,{tableName:t},function(n){i&&i(n)})}function i(t,i,r,h,c){var y,l,a,v;if(t===u){for(y in r.updateData)if(i=String(y),l=s(i,r),l){c&&c(l);return}}else if(i=String(i),l=s(i,r),l){c&&c(l);return}a={};a[f]=i;for(v in r)a[v]=r[v];n.Common.forguncyPost(t,a,function(n){var f=n,s,l;if(f.Success){if(t!==e){if(t===u)for(s in r.updateData)o(s,!0);else o(i,!0);$(window).trigger("ForguncyRowCountChanged")}h&&(f.TableRowData?(l=f.TableRowData,h(l)):h())}else c&&c(f.ErrorMessage)},undefined,function(n){var t;c&&c((t=n===null||n===void 0?void 0:n.responseText)!==null&&t!==void 0?t:"")})}function o(t,i){n.NormalCellBindingManager.reloadData(t,i);n.ForguncyData.getRelatedTableWithForeignKey(t).forEach(function(t){n.NormalCellBindingManager.reloadData(t,i)})}function s(t,i){if(t==="")return n.Common.format(n.RS.WebApi_ErrorInfo_NonemptyStringParam,f);for(var r in i)if(typeof i[r]!="object")return n.Common.format(n.RS.WebApi_ErrorInfo_ParamInvalid,r)}function ut(){t={}}var f="tableName",r="primaryKey",h="updateValue",c="newValue",e="Home/GetTableDataApi",l="Home/UpdateTableDataApi",a="Home/DeleteTableDataApi",v="Home/AddTableDataApi",u="Home/ModifyTablesDataApi",y="Home/GetTableDataODataApi",p="Home/ForceSyncExternalBuiltInTableDataApi",w,t;(function(n){n[n.QueryAllItemsWhenValueIsNull=0]="QueryAllItemsWhenValueIsNull";n[n.QueryZeroItemsWhenValueIsNull=1]="QueryZeroItemsWhenValueIsNull"})(w=n.QueryNullPolicy||(n.QueryNullPolicy={}));n.getTableData=b;n.getTableDataByOData=k;n.getTableDataByCondition=d;n.deleteTableData=g;n.addTableData=nt;n.updateTableData=tt;n.modifyTablesData=it;n.forceSyncTableData=rt;t={};n.clearGetTableDataByConditionCache=ut})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){function r(t,i,r,u,f){var e=new n.UserManagerCommand,o=u!==null&&u!==void 0?u:function(){location.reload()};e.loginByRSA(t,i,r,o,f)}function u(t){var i=new n.UserManagerCommand;i.Logout(t?{NavigateWhenLogoutMode:n.NavigateWhenLogoutMode.GoToHomePage}:null)}function f(r,u,f,e,o,s){if(n.ForguncyData.AuthenticationType===1){if(o=u,s=f,u=undefined,f=undefined,e=undefined,!t(o,"function")||!t(s,"function")||!t(r,"string")){alert(n.RS.AddUserApiParamError);return}i("AddUser",{userName:r},o,s)}else{if(!t(u,"string")||!t(f,"string")||!t(e,"string")||!t(o,"function")||!t(s,"function")||!t(r,"string")){alert(n.RS.AddUserApiParamError);return}n.Security.SecurityManager.requestRSAPublicKey(function(t){n.Security.Encrypter.encrypt(u,t.Value,function(n){i("AddUser",{userName:r,password:n,displayName:f,email:e,keyId:t.Id},o,s)})})}}function t(n,t){return typeof n===t?!0:!1}function e(n,t,r){i("DeleteUser",{userName:n},t,r)}function o(n,t,r,u){i("AddUserToRole",{userName:n,roleName:t},r,u)}function s(n,t,r,u){i("DeleteUserFromRole",{userName:n,roleName:t},r,u)}function i(t,i,r,u){n.Common.forguncyPost("Account/"+t,i,function(n){n.Result?r&&r():u&&u(n.Message)})}n.logIn=r;n.logOut=u;n.addUser=f;n.deleteUser=e;n.addUserToRole=o;n.deleteUserFromRole=s})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){t.CellHorizontalAlignment=n.CellHorizontalAlignment;t.CellVerticalAlignment=n.CellVerticalAlignment;t.CellTypeBase=n.CellTypeBase;t.CellTypeBaseWithSimplebar=n.CellTypeBaseWithSimplebar;t.CellTypeHelper=n.CellTypeHelper;t.CommandBase=n.CommandBase;t.CommandFactory=n.CommandFactory})(t=n.Plugin||(n.Plugin={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){function r(){$.ajaxSetup({"async":!1});n.ForguncyData.ForguncyRoot=n.StaticData.ForguncyRoot;$("head").append($('<base href="'.concat(n.StaticData.WebsiteBase,'">')));n.ColorHelper.Colors=n.StaticData.ThemeData.Colors;n.ColorHelper.ColorCache={};n.MetadataHelper.applyGlobalFontFamilyAndTextColor(n.StaticData.ThemeData.EnFontFamily);var t=n.StaticData.CellTypeStyleTemplates;n.CellTypeStyleTemplateUtils.PrepareTemplateStyles(t);$(document.body).append($('<div id="pageLoadingCover"><\/div>'));$(document.head).append($("<style>.listViewButton{background:linear-gradient(180deg, #ECECEC 0.00%, #D5D5D5 100.00%);} <\/style>"))}function u(t,i){var r=new n.PageInfo,u,e,f,o,s,h,c,l;r.dataModel=new n.DataModel;r.formulaManager=new n.FormulaManager(r.dataModel);r.normalCellBindingManager=new n.NormalCellBindingManager(r.dataModel.normalCellDataModel);r.currentRowInfoCollection=new n.CurrentRowInfoCollection(r.normalCellBindingManager);r.pageElementManager=new n.PageElementManager(r.currentRowInfoCollection,r.dataModel);n.ForguncyData.pageInfo=r;u=$(document.createElement("div"));e=n.PageBuilder.pagesContainer;e.empty().append(u);e.attr("fgc-exporting","true");f=t;try{f=JSON.parse(t)}catch(a){}return f.CellType.IsInvisible=!1,o=f.Value,s=n.Presentation.CellContentElementPresenter.createCell(u,f,r.pageName),s.setValue(o),n.DelayRefresh.RunNow(),h=f.Height,c=f.Width,u.css("width",c),u.css("height",h),u.css("left",0),u.css("top",0),u.find("*").css("transition","none"),i&&f.CellType.$type.indexOf("Forguncy.ButtonCellType")>=0&&(u.find("button").addClass("listViewButton"),u.find("*").css("opacity","1"),u.find("*").css("box-shadow","none")),l="myId",u.attr("id","myId"),l}function f(){var t=n.PageBuilder.pagesContainer.find("img").toArray();return t.every(function(n){return n.complete===!0})}function e(t){return n.ListViewHelper.PreviewHelper.createImage(t)}function o(t){var f,e,s,h,o;try{n.DelayRefresh.DisableDelayRun();var i=typeof t=="string"?JSON.parse(t):t,c=i.GlobalSettings,l=i.PivotTablePreviewID,a=i.ListViewMetaData,v=i.RowMasterListViewMetaData,y=i.ColumnMasterListViewMetaData,u=i.PivotTableMetaData,p=i.StyleTemplate,w=i.StyleInfo;return u.CellType.PivotTableSetting.IsPreviewing=!0,u.StyleTemplate=p,u.StyleInfo=w,n.ListViewHelper.PreviewHelper.createImage(a,v,y),n.ForguncyData.initGlobalSettings(c),f=new n.PivotTableCellType(u,0,l,null),e=f.createContent(),n.PageBuilder.pagesContainer.append(e),f.paintPivotTable(),s=e.find("canvas"),h=s.length>0?s[0].toDataURL():"",e.remove(),f.destroy(),h}catch(r){return console.error(r),o="Error:"+r,r&&r.stack&&(o=o+"\r\n"+r.stack),o}}function i(t){n.ColorHelper.Colors=t.ThemeColors;n.ColorHelper.ColorCache={};n.ForguncyData=n.ForguncyData;n.ForguncyData.pageInfo=new n.PageInfo;n.ForguncyData.pageInfo.formulaManager=new n.FormulaManager(new n.DataModel);n.ForguncyData.pageInfo.formulaManager.evaluateFormula=function(n){return n}}function s(n,t,r){var u,a,s,f,c,p,l;try{r||(r=1);u=JSON.parse(n);i(u);var v=u.Width,y=u.Height,o=$("#chart");return o.css("width",v),o.css("height",y),a=$("canvas",o),a.css("width",v),a.css("height",y),s=window.echarts.init(o[0]),f=u.ChartGeoJsonMetadata,f&&f.GeoAreaJsonFileName&&(c=f.GeoAreaJsonFileName,c=c.replace(/\\/g,"_"),window.echarts.registerMap(c,f.GeoAreaJsonContent)),h(u,s),p=s.getDataURL({pixelRatio:r,backgroundColor:"transparent"}),t||s.clear(),p}catch(e){return console.error(e),l="Error:"+e,e&&e.stack&&(l=l+"\r\n"+e.stack),l}}function h(t,i){var r=n.ConvertChartHelper.convertChartModelToECharts(t.ChartJson,t.ChartDataMapping,null,t.ChartGeoJsonMetadata);r.animation=!1;i.setOption(r);i.resize()}function c(t){var r,i,u;return typeof t=="string"&&(t=JSON.parse(t)),r=$(t.svg),n.ImageHelper.preHandleSvg(r,t.color),i=$(document.createElement("div")),i.css("max-width",200),i.css("max-height",200),i.css("left",0),i.css("top",0),i.append(r),u=n.PageBuilder.pagesContainer,u.empty().append(i),{width:i.outerWidth(),height:i.outerHeight()}}t.prepareForCellTypeExporting=r;t.getCellTypePreviewImage=u;t.getCellTypeImageLoaded=f;t.getListviewPreviewImage=e;t.getPivotTablePreviewImage=o;t.AddLoadChartMissedContext=i;t.getChartPreviewImage=s;t.getSvgImage=c})(t=n.Preview||(n.Preview={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(t){var i,r;$(document).ready(function(){if(location.hostname==="localhost"){var n=null;$(document).on("keydown",function(t){var f,u;if(!n&&t.key==="m"&&t.ctrlKey===!0){for(f=$("[innerid],[fgcname],[chartname]"),n=$(document.createElement("div")),n.addClass("fgc-cell-tip__cover"),u=0;u<f.length;u++){var i=$(f[u]),e=i.attr("innerid"),r=$(document.createElement("div"));r.addClass("fgc-cell-tip__label");r.css("left",i.offset().left);r.css("top",i.offset().top);i.attr("fgcname")?e=i.attr("fgcname"):i.attr("chartname")&&(e=i.attr("chartname"));r.text(e);n.append(r)}return $(document.body).append(n),!1}});$(document).on("keyup",function(){n&&(n.remove(),n=null)})}});i=function(){function t(){}return t.getListviewControl=function(t){for(var r=n.ListviewBase.getAllListviews(),i=0;i<r.length;i++)if(r[i].getListviewName()===t)return r[i]},t.getSpreadJSNewRowIndex=function(i){var r=t.getListviewControl(i);return n.SpreadJSView&&r&&r instanceof n.SpreadJSView?r.getNewRowIndex():-1},t.IsListviewAllowEdit=function(n){var i=t.getListviewControl(n);return i?i.allowEdit():!1},t.getTextIndent=function(t,i,r){var u=this.getActualStyle(t,i,r);return u&&!n.Common.IsEmpty(u.textIndent)?u.textIndent:0},t.getBackcolor=function(t,i,r){var u=this.getActualStyle(t,i,r);return u&&!n.Common.IsEmpty(u.backColor)?u.backColor:""},t.getForecolor=function(t,i,r){var u=this.getActualStyle(t,i,r);return u&&!n.Common.IsEmpty(u.foreColor)?u.foreColor:""},t.getActualStyle=function(n,i,r){var u=t.getListviewControl(n);return u?u.getActualStyle(i,r):null},t.getRowHeaderIcon=function(n,i){var r=t.getListviewControl(n);return r?r.getRowState(i):0},t.getRowHeaderText=function(i,r){var u=t.getListviewControl(i);return u?n.SpreadJSRowHeaderCellType.getRowHeaderText(r,u.getCalcSheetName()):""},t.getImageTooltip=function(i,r,u){var f=t.getListviewControl(i),e;return n.SpreadJSView&&f instanceof n.SpreadJSView&&(e=f.getSheet().getCellType(-1,u),n.SpreadJSViewImageCellType&&e instanceof n.SpreadJSViewImageCellType)?e.getTooltipContent(f.getCalcSheetName(),r):null},t.isSimplebar=function(i){var r=t.getListviewControl(i);return n.SpreadJSView&&r instanceof n.SpreadJSView?r.getSpread().options.scrollbarAppearance===GC.Spread.Sheets.ScrollbarAppearance.mobile:!1},t}();t.Listview=i;r=function(){function t(){}return t.login=function(t,i,r){var u=new n.UserManagerCommand;u.loginByRSA(t,i,r,function(){location.reload()})},t}();t.UserManager=r})(t=n.AutoTest||(n.AutoTest={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var i=function(t){function i(){var i=t.call(this)||this;return n.Platform.isMobile()&&(i.addClass("fgc-bpm-dialog-mobile"),i.isMobileMode=!0,i.closeButton.text="",i.closeButton.svg='<?xml version="1.0" encoding="UTF-8"?><svg width="8px" height="12px" viewBox="0 0 8 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Designer-Icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M4.54726758,2.31385803 C4.53447812,2.2990491 4.51692479,2.2944275 4.50336287,2.28056285 C4.50018695,2.27688545 4.49937153,2.27131968 4.49619562,2.26764229 C4.18242368,1.90894768 3.67706884,1.91078789 3.36647295,2.27320806 L-1.76856402,8.4247363 C-2.0791175,8.78805311 -2.0767548,9.3723113 -1.76375725,9.73189857 C-1.60809479,9.9103015 -1.40449282,10 -1.2017077,10 C-0.996518206,10 -0.790556287,9.90846273 -0.634850421,9.72638255 L3.94454148,4.22563179 L8.63967301,9.68567826 C8.79533547,9.86408119 8.99816401,9.95377969 9.20172256,9.95377969 C9.40768448,9.95377969 9.61287397,9.86224242 9.76857984,9.68016224 C10.0791333,9.31774097 10.0767282,8.73253813 9.76377304,8.37295085 L4.54726758,2.31385803 Z" fill="#6B6B6B" transform="translate(4.000000, 6.000000) scale(1, -1) rotate(-90.000000) translate(-4.000000, -6.000000) "><\/path><\/g><\/svg>',i.footerButtonGroup.items[1].visibility=!1),i}return __extends(i,t),i.prototype.appendExtralPopup=function(){n.ForguncyData.pageInfo.appendExtralPopup(this);this.extraDialogCount=n.ForguncyData.pageInfo.extraDialogCount;n.PageBuilder.pagesContainer.append(this.createUI().container)},i.prototype.canClose=function(){return this.extraDialogCount===n.ForguncyData.pageInfo.extraDialogCount},i}(n.UI.Dialog);t.BPMDialog=i})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var u=function(r){function u(t){var f=t.isMultiSelect,s=f===void 0?!1:f,e=t.userInfos,h=e===void 0?[]:e,o=t.selectedUserNames,c=o===void 0?[]:o,u=r.call(this)||this;return u.selectionlayoutTitleText=n.RS.UserSelectorDialog_Selection_Title,u.defaultUI=i,u.identify("fgc-bpm-userselectordialog"),u.title=n.RS.TaskActionDialog_AssigneesRow_SelectorDialogTitle,u.isMultiSelect=s,u.userInfos=h,u._selectedUserNames=new Set(c),u.initUI(),u.initUIEvents(),u}return __extends(u,r),Object.defineProperty(u.prototype,"isSingleMode",{get:function(){return!this.isMultiSelect},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"dialogResult",{get:function(){var n=this;return{selectedUserInfos:this.userInfos.filter(function(t){return n._selectedUserNames.has(t.UserName)})}},enumerable:!1,configurable:!0}),u.prototype.initUI=function(){this.searchInput=new n.UI.TextBox("",n.RS.UserSelectorDialog_SearchInput,'<?xml version="1.0" encoding="UTF-8"?><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M7.02867366,1 C10.3582182,1 13.0573473,3.69912914 13.0573473,7.02867366 C13.0573473,8.32221061 12.6499561,9.52059624 11.9564796,10.5025245 C12.2176302,10.756983 12.4911409,11.0222645 12.7639532,11.2870677 C13.561905,12.0616577 13.3738436,11.8726065 13.8302386,12.319114 C14.1025732,12.5854965 14.3137633,12.7931835 14.457975,12.936475 C14.5392585,13.0172345 14.5998567,13.0780473 14.6432237,13.1224281 C14.7579395,13.2398368 14.99661,13.4841298 15,13.9048783 C15,14.2043686 14.8986259,14.4515177 14.6958778,14.6463257 C14.3917557,14.9385378 14.2287409,14.9505997 13.9609586,14.9505997 C13.7495485,14.9505997 13.5366685,14.8863852 13.3524424,14.7555389 C13.3264966,14.7371013 13.3007004,14.717086 13.2735264,14.6943146 C13.2512208,14.6756067 13.2258365,14.6532711 13.1936972,14.6239864 C13.1474012,14.5818653 13.0842012,14.5227758 13.0004248,14.4433642 C12.8536746,14.3042212 12.6404486,14.099311 12.3666605,13.8343802 C11.908517,13.3910446 12.0963115,13.5794538 11.2995422,12.8005309 C11.0173144,12.5246218 10.7344739,12.2478231 10.4633881,11.9823445 C9.4897578,12.6603669 8.30557561,13.0573473 7.02867366,13.0573473 C3.69912914,13.0573473 1,10.3582182 1,7.02867366 C1,3.69912914 3.69912914,1 7.02867366,1 Z M7.02867366,3.00955789 C4.80897731,3.00955789 3.00955789,4.80897731 3.00955789,7.02867366 C3.00955789,9.24837001 4.80897731,11.0477894 7.02867366,11.0477894 C9.24837001,11.0477894 11.0477894,9.24837001 11.0477894,7.02867366 C11.0477894,4.80897731 9.24837001,3.00955789 7.02867366,3.00955789 Z" fill="currentColor" fill-rule="nonzero"><\/path><\/g><\/svg>').addClass("fgc-bpm-userselectordialog-search").addAttrs({AutomationId:"userSelectorDialog_searchInput"});this.searchInput.autocomplete="new-password";this.table=new n.UI.Table({isMultiSelect:this.isMultiSelect,columns:[{key:"UserName",label:n.RS.ForguncyUserAvator_UserName,width:"33.3%"},{key:"FullName",label:n.RS.ForguncyUserAvator_FullName,width:"33.3%"},{key:"Email",label:n.RS.ForguncyUserAvator_Email,width:"33.3%"},],dataSource:this.userInfos.map(function(n){var t=n.UserName,i=n.FullName,r=n.Email;return{key:t,UserName:t,FullName:i,Email:r}}),selectedKeys:Array.from(this._selectedUserNames)});this.outerlayout=new n.UI.FlexLayout(1).add(this.searchInput,this.table);this.isSingleMode?this.outerlayout=new n.UI.FlexLayout(1).add(this.searchInput,this.table):(this.selectionlayoutTitle=(new n.UI.TextBlock).addClass("fgc-bpm-userselectordialog-selection-title"),this.updateSelectionlayoutTitle(),this.selection=new t.UserSelectionArea(this.userInfos,this._selectedUserNames),this.outerlayout=new n.UI.FlexLayout(1).add(this.searchInput,this.table,this.selectionlayoutTitle,this.selection))},u.prototype.initUIEvents=function(){var n=this;this.searchInput.on("Confirm",function(){n.table.filter(n.searchInput.text)});this.searchInput.on("SuffixClicked",function(){n.table.filter(n.searchInput.text)});this.table.on("SelectedItems",function(t,i){i.forEach(function(t){n._selectedUserNames.add(t)});n.isMultiSelect&&n.selection.adds(i);n.updateSelectionlayoutTitle()});this.table.on("UnselectedItems",function(t,i){i.length==0?(n._selectedUserNames.clear(),n.isMultiSelect&&n.selection.clear()):i.forEach(function(t){n._selectedUserNames.delete(t);n.isMultiSelect&&n.selection.remove(t)});n.updateSelectionlayoutTitle()});if(this.isMultiSelect)this.selection.on("ActivelyRemove",function(t,i){n._selectedUserNames.delete(i);n.table.unselect(i);n.updateSelectionlayoutTitle()})},u.prototype.updateSelectionlayoutTitle=function(){this.isMultiSelect&&(this.selectionlayoutTitle.text=n.Common.format(this.selectionlayoutTitleText,this._selectedUserNames.size))},u}(t.BPMDialog),i,r;t.UserSelectorDialog=u;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new r(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI);r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerlayout.createUI())},t}(n.UI.DialogContentUI)})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var e=function(t){function r(){var i=t!==null&&t.apply(this,arguments)||this;return i.selectionlayoutTitleText=n.RS.TaskActionDialog_AssigneesRow_SelectorDialogTitle_Mobile,i.defaultUI=o,i}return __extends(r,t),r.prototype.initUI=function(){this.searchInput=new n.UI.TextBox("",n.RS.UserSelectorDialog_SearchInput,'<?xml version="1.0" encoding="UTF-8"?><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M7.02867366,1 C10.3582182,1 13.0573473,3.69912914 13.0573473,7.02867366 C13.0573473,8.32221061 12.6499561,9.52059624 11.9564796,10.5025245 C12.2176302,10.756983 12.4911409,11.0222645 12.7639532,11.2870677 C13.561905,12.0616577 13.3738436,11.8726065 13.8302386,12.319114 C14.1025732,12.5854965 14.3137633,12.7931835 14.457975,12.936475 C14.5392585,13.0172345 14.5998567,13.0780473 14.6432237,13.1224281 C14.7579395,13.2398368 14.99661,13.4841298 15,13.9048783 C15,14.2043686 14.8986259,14.4515177 14.6958778,14.6463257 C14.3917557,14.9385378 14.2287409,14.9505997 13.9609586,14.9505997 C13.7495485,14.9505997 13.5366685,14.8863852 13.3524424,14.7555389 C13.3264966,14.7371013 13.3007004,14.717086 13.2735264,14.6943146 C13.2512208,14.6756067 13.2258365,14.6532711 13.1936972,14.6239864 C13.1474012,14.5818653 13.0842012,14.5227758 13.0004248,14.4433642 C12.8536746,14.3042212 12.6404486,14.099311 12.3666605,13.8343802 C11.908517,13.3910446 12.0963115,13.5794538 11.2995422,12.8005309 C11.0173144,12.5246218 10.7344739,12.2478231 10.4633881,11.9823445 C9.4897578,12.6603669 8.30557561,13.0573473 7.02867366,13.0573473 C3.69912914,13.0573473 1,10.3582182 1,7.02867366 C1,3.69912914 3.69912914,1 7.02867366,1 Z M7.02867366,3.00955789 C4.80897731,3.00955789 3.00955789,4.80897731 3.00955789,7.02867366 C3.00955789,9.24837001 4.80897731,11.0477894 7.02867366,11.0477894 C9.24837001,11.0477894 11.0477894,9.24837001 11.0477894,7.02867366 C11.0477894,4.80897731 9.24837001,3.00955789 7.02867366,3.00955789 Z" fill="currentColor" fill-rule="nonzero"><\/path><\/g><\/svg>').addClass("fgc-bpm-userselectordialog-search").addAttrs({AutomationId:"userSelectorDialog_searchInput"});this.searchInput.autocomplete="new-password";this.table=new i({isNeedCheckCol:!0,isMultiSelect:this.isMultiSelect,isNeedHeader:!1,columns:[{key:"info",label:"",width:"100%",type:"Custom"},{key:"info-username",type:"Custom"},{key:"info-email",type:"Custom"},],dataSource:this.userInfos.map(function(t){var i=t.UserName,r=t.FullName,u=t.Email;return{key:i,UserName:i,FullName:r,Email:u,"info-username":"".concat(n.Common.IsEmpty(r)?i:"".concat(r,"(").concat(i,")")),"info-email":u}}),selectedKeys:Array.from(this._selectedUserNames)});this.isSingleMode?(this.addClass("fgc-bpm-userselectordialog-singlemode"),this.outerlayout=new n.UI.FlexLayout(1).add(this.searchInput,this.table)):(this.selectionlayoutTitle=new n.UI.TextBlock,this.updateSelectionlayoutTitle(),this.selectionlayoutIcon=new n.UI.IconText("","",'<?xml version="1.0" encoding="UTF-8"?><svg viewBox="0 0 8 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Designer-Icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M4.54726758,2.31385803 C4.53447812,2.2990491 4.51692479,2.2944275 4.50336287,2.28056285 C4.50018695,2.27688545 4.49937153,2.27131968 4.49619562,2.26764229 C4.18242368,1.90894768 3.67706884,1.91078789 3.36647295,2.27320806 L-1.76856402,8.4247363 C-2.0791175,8.78805311 -2.0767548,9.3723113 -1.76375725,9.73189857 C-1.60809479,9.9103015 -1.40449282,10 -1.2017077,10 C-0.996518206,10 -0.790556287,9.90846273 -0.634850421,9.72638255 L3.94454148,4.22563179 L8.63967301,9.68567826 C8.79533547,9.86408119 8.99816401,9.95377969 9.20172256,9.95377969 C9.40768448,9.95377969 9.61287397,9.86224242 9.76857984,9.68016224 C10.0791333,9.31774097 10.0767282,8.73253813 9.76377304,8.37295085 L4.54726758,2.31385803 Z" fill="#6B6B6B" transform="translate(4.000000, 6.000000) scale(1, -1) rotate(-270.000000) translate(-4.000000, -6.000000) "><\/path><\/g><\/svg>'),this.outerlayout=new n.UI.FlexLayout(1).add(this.searchInput,this.table,(new n.UI.FlexLayout).addClass("fgc-bpm-userselectordialog-selection-title").add(this.selectionlayoutTitle,this.selectionlayoutIcon)))},r.prototype.initUIEvents=function(){var n=this;this.searchInput.on("Confirm",function(){n.table.filter(n.searchInput.text)});this.searchInput.on("SuffixClicked",function(){n.table.filter(n.searchInput.text)});this.table.on("SelectedItems",function(t,i){i.forEach(function(t){n._selectedUserNames.add(t)});n.updateSelectionlayoutTitle()});this.table.on("UnselectedItems",function(t,i){i.length==0?n._selectedUserNames.clear():i.forEach(function(t){n._selectedUserNames.delete(t)});n.updateSelectionlayoutTitle()});if(this.isMultiSelect){this.selectionlayoutTitle.on("ContainerClicked",function(){n.openSelectedDialog()});this.selectionlayoutIcon.on("SuffixClicked",function(){n.openSelectedDialog()})}},r.prototype.openSelectedDialog=function(){var t=this,i=new u({isNeedHeader:!1,columns:[{key:"info",label:"",width:"100%",type:"Custom"},{key:"info-username",type:"Custom"},{key:"info-email",type:"Custom"},{key:"delete",label:"",width:"30px",type:"Custom"},],dataSource:this.dialogResult.selectedUserInfos.map(function(t){var i=t.UserName,r=t.FullName,u=t.Email;return{key:i,UserName:i,FullName:r,Email:u,"info-username":"".concat(n.Common.IsEmpty(r)?i:"".concat(r,"(").concat(i,")")),"info-email":u}}),selectedKeys:Array.from(this._selectedUserNames)}).identify("fgc-bpm-userselectordialog-area"),r=this.openDrawDialog(i.createUI().container);i.on("UnselectedItems",function(i,u){u.forEach(function(n){t._selectedUserNames.delete(n);t.table.unselect(n)});r.title=n.Common.format(n.RS.UserSelectorDialog_Selection_Title,t._selectedUserNames.size);t.updateSelectionlayoutTitle()})},r.prototype.openDrawDialog=function(t){var i=new n.PopupDialog;return i.title=n.Common.format(n.RS.UserSelectorDialog_Selection_Title,this._selectedUserNames.size),i.body=t,i.closeButton.text="",i.closeButton.svg='<?xml version="1.0" encoding="UTF-8"?><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="CaretDownOutlined" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M8.45605632,4.23539352 C8.44539843,4.22428682 8.43077066,4.22082062 8.41946906,4.21042214 C8.41682246,4.20766409 8.41614294,4.20348976 8.41349635,4.20073172 C8.15201974,3.93171076 7.7308907,3.93309092 7.47206079,4.20490604 L1.19286332,10.8185522 C0.934068751,11.0910398 0.936037664,11.5292335 1.19686896,11.7989239 C1.32658767,11.9327261 1.49625598,12 1.66524359,12 C1.83623483,12 2.00786976,11.931347 2.13762465,11.7947869 L7.95378456,5.66922384 L13.8663942,11.7642587 C13.9961129,11.8980609 14.1651367,11.9653348 14.3347688,11.9653348 C14.5064037,11.9653348 14.677395,11.8966818 14.8071499,11.7601217 C15.0659444,11.4883057 15.0639402,11.0494036 14.8031442,10.7797131 L8.45605632,4.23539352 Z" fill="#6B6B6B" fill-rule="nonzero" transform="translate(8.000000, 8.000000) scale(1, -1) translate(-8.000000, -8.000000) "><\/path><\/g><\/svg>',i.addClass("fgc-bpm-userselectordialog-selection-area-mobile"),i.addClass("fgc-bpm-dialog-mobile"),i.showHeader=!0,i.moveable=!1,i.closeWhenClickGrayArea=!0,i.centerWhenOpen=!1,i.displayMode=3,i.popupType="drawer",i.drawerDirection=0,i.disposeDelayDuration=300,n.ForguncyData.pageInfo.appendExtralPopup(i),n.PageBuilder.pagesContainer.append(i.createUI(n.DrawerUI).container),i.show(),i},r}(t.UserSelectorDialog),i,r,u,f;t.UserSelectorDialogMobile=e;i=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=r,t}return __extends(t,n),t}(n.UI.Table);t.TableList=i;r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getDataColumnCustomTemplate=function(n){var t=n.key;switch(t){case"info":return'<td data-key="info">\n                    <div data-key="info-username"><\/div>\n                    <div data-key="info-email"><\/div>\n                <\/td>';default:return""}},t}(n.UI.TableUI);t.TableListUI=r;u=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=f,t}return __extends(t,n),t}(n.UI.Table);t.TableDeleteList=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.getLayoutColgroupCustomTemplate=function(n){switch(n.key){case"info":case"delete":return t.prototype.getLayoutColgroupCustomTemplate.call(this,n);default:return""}},i.prototype.getDataColumnCustomTemplate=function(n){switch(n.key){case"info":return'<td data-key="info">\n                    <div data-key="info-username"><\/div>\n                    <div data-key="info-email"><\/div>\n                <\/td>';case"delete":return'<th data-key="delete">'.concat('<?xml version="1.0" encoding="UTF-8"?><svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Designer-Icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M10,0 C15.5228475,0 20,4.4771525 20,10 C20,15.5228475 15.5228475,20 10,20 C4.4771525,20 0,15.5228475 0,10 C0,4.4771525 4.4771525,0 10,0 Z M10,1.25 C5.16750844,1.25 1.25,5.16750844 1.25,10 C1.25,14.8324916 5.16750844,18.75 10,18.75 C14.8324916,18.75 18.75,14.8324916 18.75,10 C18.75,5.16750844 14.8324916,1.25 10,1.25 Z M14.2381662,5 C14.4415965,5 14.6330125,5.07937935 14.7771299,5.22349937 C15.0742863,5.52066107 15.0742863,6.00421741 14.7771299,6.30139028 L14.7771299,6.30139028 L11.0780671,10.0002512 L14.7765158,13.6987325 C14.9206332,13.8428637 15,14.0342607 15,14.2377059 C15,14.4411511 14.9206221,14.6325704 14.7765158,14.7767128 C14.6333251,14.9206095 14.4420655,15 14.2381662,15 C14.0345571,15 13.8431747,14.9206876 13.6992248,14.7766793 L13.6992248,14.7766793 L10.0003182,11.0779635 L6.3013782,14.7767016 C6.15818752,14.9205983 5.96669343,15 5.76240329,15 C5.55886126,15 5.36746767,14.9206765 5.22348421,14.7766681 C5.07938909,14.6325481 5,14.4411511 5,14.2377059 C5,14.0342607 5.07938909,13.8428302 5.22350654,13.6987214 L5.22350654,13.6987214 L8.92240191,10.0000726 L5.22349538,6.30140145 C5.07938909,6.15727026 5,5.96586208 5,5.76243924 C5,5.55901641 5.07937793,5.36760822 5.22349538,5.2234882 C5.36762399,5.07936818 5.55901759,5 5.76243679,5 C5.96585599,5 6.15726075,5.07937935 6.30136703,5.2234882 L6.30136703,5.2234882 L10.0001842,8.92234916 L13.6992583,5.22349937 C13.8433422,5.07937935 14.0347358,5 14.2381662,5 Z" fill="#00ADEE"><\/path><\/g><\/svg>',"<\/th>");default:return""}},i.prototype.createContainerEvents=function(){var t=this;this.container.on("click","table tbody tr",function(i){var u=i.currentTarget,f=$(u).find("div[data-key=info-username]").text(),r=n.PopupHelper.createConfirmPopupDom(n.RS.UserSelectorDialog_DeleteList_Title,"",n.Common.format(n.RS.UserSelectorDialog_DeleteListTip_Text,f),!n.ForguncyData.GlobalSettings.HidePopUpCloseButton);r.zIndex=n.ForguncyData.pageInfoStack.length;r.container.find(".".concat("FUI-imagetext-text")).css({"white-space":"normal","word-break":"break-all"});r.target.on("Confirm",function(){var n=i.currentTarget,r=$(n).attr("data-key");t.target.selectedKeys.delete(r);$(n).remove();t.target.dispatch("UnselectedItems",[r])})})},i}(n.UI.TableUI);t.TableDeleteListUI=f;var o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"header",{get:function(){return new h(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return new s(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI),s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerlayout.createUI())},t}(n.UI.DialogContentUI),h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){n.prototype.createChildren.call(this);this.container.empty();this.addChild(this.target.closeButton.createUI());this.container.append(this.titleContainer)},t}(n.UI.DialogHeaderUI)})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var r=function(t){function r(r,u){var f=t.call(this)||this;return f.selectedKeys=new Set,f.defaultUI=i,f.containerHeight=0,f.loadUserStep=25,f.loadUserTick=0,f.addClass("fgc-bpm-userselectordialog-selection-area"),f.userInfos=__spreadArray([],r,!0),f.selectedKeys=new Set(u),f.canLoadUserInfos=Array.from(u).map(function(n){return f.userInfos.find(function(t){return t.UserName===n})}),f.principalLayout=new n.UI.FlexLayout(0,{wrap:!0}),f}return __extends(r,t),Object.defineProperty(r.prototype,"size",{get:function(){return this.selectedKeys.size},enumerable:!1,configurable:!0}),r.prototype.has=function(n){return this.selectedKeys.has(n)},r.prototype.adds=function(n){var r,t=this,i=[];n.forEach(function(n){t.has(n)||(t.selectedKeys.add(n),i.push(t.userInfos.find(function(t){return t.UserName===n})))});(r=this.canLoadUserInfos).push.apply(r,i);this.dispatch("AddItems",i)},r.prototype.remove=function(n){this.selectedKeys.has(n)&&(this.selectedKeys.delete(n),this.canLoadUserInfos.splice(this.canLoadUserInfos.findIndex(function(t){return t.UserName===n}),1),this.dispatch("PassiveRemove",n))},r.prototype.clear=function(){this.selectedKeys.clear();this.canLoadUserInfos=[];this.dispatch("Clear")},r}(n.UI.UserControl),i;t.UserSelectionArea=r;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.createContainer=function(){this.container=this.target.principalLayout.createUI().container},i.prototype.createChildren=function(){this.initData();this.loadMoreContent()},i.prototype.initData=function(){this.target.loadUserStep=25;this.target.loadUserTick=0;this.target.loadUserTimer=0;this.container.empty()},i.prototype.createContainerEvents=function(){var n=this;this.container.on("click","div[data-key] svg",function(t){var i=$(t.currentTarget).parent().attr("data-key");n.target.selectedKeys.has(i)&&(n.target.selectedKeys.delete(i),n.target.canLoadUserInfos.splice(n.target.canLoadUserInfos.findIndex(function(n){return n.UserName===i}),1),n.target.dispatch("ActivelyRemove",i))});this.target.on("AddItems",function(t,i){var r=n.target.loadUserStep*(1+n.target.loadUserTick),u;n.container.children().length>=r||(u=i.slice(0,r-n.container.children().length),u.length!==0)&&(n.handleAddItem(u),n.container.children().length==r&&n.target.loadUserTick++,n.target.containerHeight=Math.ceil(n.container.height()))});this.target.on("ActivelyRemove",function(t,i){n.handleItemRemove(i)});this.target.on("PassiveRemove",function(t,i){n.handleItemRemove(i)});this.target.on("Clear",function(){n.container.empty();n.initData()});this.container.on("scroll",function(t){n.target.loadUserTimer>0&&clearTimeout(n.target.loadUserTimer);n.target.loadUserTimer=setTimeout(function(){var i=t.target.scrollTop,r=t.target.scrollHeight;i+n.target.containerHeight>=r&&n.loadMoreContent()},50)})},i.prototype.loadMoreContent=function(){var t=this.container.children().length,i=this.target.loadUserStep*(1+this.target.loadUserTick),n=this.target.canLoadUserInfos.slice(t,i);n.length!==0&&(this.handleAddItem(n),this.target.loadUserTick++)},i.prototype.handleAddItem=function(n){var t=document.createDocumentFragment();this.getChildrenTempletes(n).forEach(function(n){var i=$(n);t.appendChild(i[0])});this.container.append(t);this.target.containerHeight=Math.ceil(this.container.height())},i.prototype.getChildrenTempletes=function(t){return t.map(function(t){return'\n                <div data-key="'.concat(t.UserName,'">\n                    ').concat(n.Common.IsEmpty(t.FullName)?t.UserName:t.FullName,"<\/span>").concat('<svg viewBox="64 64 896 896" focusable="false" fill="currentColor"><path d="M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z" /><\/svg>',"\n                <\/div>\n            ")})},i.prototype.handleItemRemove=function(n){this.container.find("div[data-key='".concat(n,"']")).remove()},i}(n.UI.ControlUIBase)})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var i,u,f,e;(function(n){n[n.Get=0]="Get";n[n.Post=1]="Post"})(i=t.InvokeType||(t.InvokeType={}));var o="BpmService",s="bpm/runtime",r=function(){function t(){}return t.prototype.invokeAsync=function(){var t,r,u;if(this.ensureInvokeData(),t=this.routeUrl(),t.startsWith("/")||(t="/".concat(t)),t="".concat(this.domainUrl()).concat(t),r=this.invokeType(),r===i.Get)return u=this.jointGetUrl(t),n.Common.forguncyGETAsync(u);if(r===i.Post)return n.Common.forguncyPOSTAsync(t,this);throw new Error("Method not implemented.");},t.prototype.ensureInvokeData=function(){var t=this.routeUrl(),n;if(!t||t==="")throw new Error("Route url is undefined");if(n=this.invokeType(),n!==i.Get&&n!==i.Post)throw new Error("Invoke type is undefined");},t.prototype.jointGetUrl=function(n){var t="",i,r;for(i in this)Object.prototype.hasOwnProperty.call(this,i)&&(r=this[i],r)&&(t+="".concat(i,"=").concat(r,"&"));return t===""?this.avoidBrowserCache("".concat(n,"?")):(t=t.substring(0,t.length-1),this.avoidBrowserCache("".concat(n,"?").concat(t,"&")))},t.prototype.avoidBrowserCache=function(n){return n+"v="+(new Date).getTime()},t}();t.BaseApi=r;u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.domainUrl=function(){return o},t}(r);t.BaseEngineApi=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.domainUrl=function(){return s},t}(r);t.BaseServerApi=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(u);t.ActionApi=e})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var t;(function(t){var l=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"delegation-configuration/query/list"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi),i,r,u,f,e,o,s,h,c,a;t.ListConfigurationApi=l;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"delegation-configuration/update-status"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.BaseEngineApi);t.UpdateConfigStatusApi=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"delegation-configuration/delete"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.BaseEngineApi);t.DeleteConfigStatusApi=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"delegation-configuration/create"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.BaseEngineApi);t.CreateConfigurationApi=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"delegation-configuration/update"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.BaseEngineApi);t.UpdateConfigurationApi=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetCanBeDelegatedUserInfos"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseServerApi);t.GetCanBeDelegatedUserInfosApi=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetUserInfos"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.BaseServerApi);t.GetUserInfosApi=o;s=function(){function n(){}return n}();t.DelegationProcessDetailEntity=s;h=function(){function n(){}return n}();t.DelegationToDetailEntity=h;c=function(){function n(){}return n}();t.DelegationConfigurationEntity=c,function(n){n[n.Select=0]="Select";n[n.All=1]="All"}(a=t.DelegationProcessType||(t.DelegationProcessType={}))})(t=n.DelegationConfiguration||(n.DelegationConfiguration={}))})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(n.ActionApi),i,r,u,f,e,o,s,h,c;n.TaskActionApi=t;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/commit"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.CommitTaskApi=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/terminate"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.TerminateTaskApi=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/rollback"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.RollbackTaskApi=u;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.routeUrl=function(){return"task/dispatch"},t}(i);n.DispatchTaskApi=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/delegate"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.DelegateTaskApi=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/cancel-delegate"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.CancelDelegateTaskApi=o;s=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/add-on-sign"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.AddOnSignTaskApi=s;h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/carbon-copy"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.CarbonCopyTaskApi=h;c=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/read-carbon-copy"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(t);n.ReadCarbonCopyTaskApi=c})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(n.ActionApi),t;n.ProcessInstanceApi=i;t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"process-instance/start"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.ActionApi);n.StartProcessInstanceApi=t})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var u=function(){function n(){}return n}(),t,i,r;n.DefinitionByDeploymentDto=u;t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(n.ActionApi);n.ProcessDefinitionApi=t;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"process-definition/query/get-resource-name"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi);n.GetProcessDefinitionResourceNameApi=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"process-definition/query/list-by-deployment"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi);n.ListByDeploymentApi=r})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(n){var h=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/query/detail"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi),t,i,r,u,f,e,o,s;n.TaskDetailApi=h;t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetMoveInfoWithUsers"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseServerApi);n.GetMoveInfoWithUsersApi=t;i=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetDispatchMoveInfoWithUsers"},i.prototype.invokeType=function(){return n.InvokeType.Post},i}(n.BaseServerApi);n.GetDispatchMoveInfoWithUsersApi=i;r=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetDelegateUsers"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseServerApi);n.GetDelegateUsersApi=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetAddOnSignUsers"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseServerApi);n.GetAddOnSignUsersApi=u;f=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"GetCarbonCopyUsers"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseServerApi);n.GetCarbonCopyUsersApi=f;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/query/notification-number"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi);n.ProcessNotificationNumApi=e;o=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/query/data-permission"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi);n.DataPermissionApi=o;s=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.routeUrl=function(){return"task/query/business-key-info"},i.prototype.invokeType=function(){return n.InvokeType.Get},i}(n.BaseEngineApi);n.BusinessKeyInfoApi=s})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t,i,r;(function(n){n[n.SelectByUser=1]="SelectByUser";n[n.All=2]="All"})(t=n.AssigneeTarget||(n.AssigneeTarget={})),function(n){n[n.Fixed=1]="Fixed";n[n.TableField=2]="TableField"}(i=n.HybridValueType||(n.HybridValueType={})),function(n){n[n.Text=1]="Text"}(r=n.RemarkKeys||(n.RemarkKeys={}))})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.queryConfigurationInfoAsync=function(t){return __awaiter(this,void 0,void 0,function(){var u,r,i;return __generator(this,function(f){switch(f.label){case 0:return u=t!==null&&t!==void 0?t:new n.DelegationConfigurationEntity,r=new n.ListConfigurationApi,r.id=u.id,r.delegationProcessType=u.delegationProcessType,r.enabled=u.enabled,r.startTime=u.startTime,r.endTime=u.endTime,[4,r.invokeAsync()];case 1:if(i=f.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i===null||i===void 0?void 0:i.data]}})})},t.prototype.enableConfigurationAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.UpdateConfigStatusApi,r.id=t,r.isEnabled=!0,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i===null||i===void 0?void 0:i.data]}})})},t.prototype.disableConfigurationAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.UpdateConfigStatusApi,r.id=t,r.isEnabled=!1,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i===null||i===void 0?void 0:i.data]}})})},t.prototype.deleteConfigurationAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.DeleteConfigStatusApi,r.id=t,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i===null||i===void 0?void 0:i.data]}})})},t.prototype.createConfigurationAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.CreateConfigurationApi,r.delegationProcessType=t.delegationProcessType,r.delegateToDetails=t.delegateToDetails,r.delegateProcessDetails=t.delegateProcessDetails,r.startTime=t.startTime,r.endTime=t.endTime,r.description=t.description,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i===null||i===void 0?void 0:i.data]}})})},t.prototype.updateConfigurationAsync=function(t){return __awaiter(this,void 0,void 0,function(){var i,r;return __generator(this,function(u){switch(u.label){case 0:return i=new n.UpdateConfigurationApi,i.id=t.id,i.delegationProcessType=t.delegationProcessType,i.delegateToDetails=t.delegateToDetails,i.delegateProcessDetails=t.delegateProcessDetails,i.startTime=t.startTime,i.endTime=t.endTime,i.description=t.description,[4,i.invokeAsync()];case 1:if(r=u.sent(),!r||r.code!==200)throw new Error(r===null||r===void 0?void 0:r.message);return[2,r===null||r===void 0?void 0:r.data]}})})},t.prototype.getCanBeDelegatedUserInfosAsync=function(){return __awaiter(this,void 0,void 0,function(){var i,t;return __generator(this,function(r){switch(r.label){case 0:return i=new n.GetCanBeDelegatedUserInfosApi,[4,i.invokeAsync()];case 1:if(t=r.sent(),!t||t.code!==200)throw new Error(t===null||t===void 0?void 0:t.message);return[2,t.data]}})})},t.prototype.getUserInfosAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.GetUserInfosApi,r.userNames=t,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i.data]}})})},t}();n.DelegationConfigurationService=t})(t=n.DelegationConfiguration||(n.DelegationConfiguration={}))})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.getProcessDefinitionResourceNameAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.GetProcessDefinitionResourceNameApi,r.processDefinitionId=t,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i.data]}})})},t.prototype.getProcessDefinitionDeploymentAsync=function(){return __awaiter(this,void 0,void 0,function(){var i,t;return __generator(this,function(r){switch(r.label){case 0:return i=new n.ListByDeploymentApi,[4,i.invokeAsync()];case 1:if(t=r.sent(),!t||t.code!==200)throw new Error(t===null||t===void 0?void 0:t.message);return[2,t.data]}})})},t}();n.ProcessDefinitionService=t})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(t){var i=function(){function i(){}return i.prototype.startProcessAsync=function(n,i){return __awaiter(this,void 0,void 0,function(){var u,f,e,r;return __generator(this,function(o){switch(o.label){case 0:return u=new t.StartProcessInstanceApi,u.processDefinitionId=n,f=i===null||i===void 0?void 0:i.processInstanceName,f&&(u.processName=f),[4,this.resolveBusinessKeyAsync(i===null||i===void 0?void 0:i.businessKeyQuery)];case 1:return e=o.sent(),e&&(u.businessKey=e),[4,u.invokeAsync()];case 2:if(r=o.sent(),!r||r.code!==200)throw new Error(r===null||r===void 0?void 0:r.message);return[2,r===null||r===void 0?void 0:r.data]}})})},i.prototype.startProcessFormNameAsync=function(n,i){return __awaiter(this,void 0,void 0,function(){var u,f,e,r;return __generator(this,function(o){switch(o.label){case 0:return u=new t.StartProcessInstanceApi,u.processDefinitionResourceName=n,f=i===null||i===void 0?void 0:i.processInstanceName,f&&(u.processName=f),[4,this.resolveBusinessKeyAsync(i===null||i===void 0?void 0:i.businessKeyQuery)];case 1:return e=o.sent(),e&&(u.businessKey=e),[4,u.invokeAsync()];case 2:if(r=o.sent(),!r||r.code!==200)throw new Error(r===null||r===void 0?void 0:r.message);return[2,r===null||r===void 0?void 0:r.data]}})})},i.prototype.resolveBusinessKeyAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,f,o,i,u,e;return __generator(this,function(s){switch(s.label){case 0:if(!t||!t.queries||t.queries.length===0)return[2,null];r=[];f=0;o=t.queries;s.label=1;case 1:if(!(f<o.length))return[3,6];if(i=o[f],i.tableName===undefined)return[3,5];if(!(i.rowMode===0))return[3,2];if(u=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(i.tableName),!u||!u.query)throw n.RS.CurrentRow_NotExist;return r.push({tableName:u.currentTable,primaryKeys:[u.query]}),[3,5];case 2:return(i.rowMode===1)?(i.sqlCondition=n.ConditionHelper.getComputedSqlConditionFormula(i.sqlCondition,i.runtimePageName,n.QueryNullPolicy.QueryZeroItemsWhenValueIsNull),[4,n.Common.forguncyPOSTAsync("Home/GetTableDataPrimaryKey",i)]):[3,4];case 3:return e=s.sent(),e&&e.length!==0&&r.push({tableName:i.tableName,primaryKeys:e}),[3,5];case 4:throw n.RS.RowMode_NotExist;case 5:return f++,[3,1];case 6:return r.length>0?[2,JSON.stringify(r)]:[2,null]}})})},i}();t.ProcessInstanceService=i})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.describeDetailAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.TaskDetailApi,r.taskId=t,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i.data]}})})},t.prototype.describeBusinessKeyInfoAsync=function(t){return __awaiter(this,void 0,void 0,function(){var r,i;return __generator(this,function(u){switch(u.label){case 0:return r=new n.BusinessKeyInfoApi,r.taskId=t,[4,r.invokeAsync()];case 1:if(i=u.sent(),!i||i.code!==200)throw new Error(i===null||i===void 0?void 0:i.message);return[2,i.data]}})})},t.prototype.commitAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.CommitTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,f.selectedUserInfos=r===null||r===void 0?void 0:r.selectedUserInfos,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.terminateAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.TerminateTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.rollbackAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.RollbackTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.dispatchAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.DispatchTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,f.selectedUserInfos=r===null||r===void 0?void 0:r.selectedUserInfos,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.delegateAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.DelegateTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,f.delegateTo=r===null||r===void 0?void 0:r.delegateTo,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.cancelDelegateAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.CancelDelegateTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.addOnSignAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var u,f;return __generator(this,function(e){switch(e.label){case 0:return u=new n.AddOnSignTaskApi,u.taskId=t,u.comment=r===null||r===void 0?void 0:r.comment,u.actionKey=i.key,u.addOnSignTos=r===null||r===void 0?void 0:r.addOnSignTos,u.addOnSignCustomType=r===null||r===void 0?void 0:r.addOnSignCustomType,[4,u.invokeAsync()];case 1:if(f=e.sent(),!f||f.code!==200)throw new Error(f===null||f===void 0?void 0:f.message);return[2,f.data]}})})},t.prototype.carbonCopyAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.CarbonCopyTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,f.carbonCopyTos=r===null||r===void 0?void 0:r.carbonCopyTos,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.readCarbonCopyAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var f,u;return __generator(this,function(e){switch(e.label){case 0:return f=new n.ReadCarbonCopyTaskApi,f.taskId=t,f.comment=r===null||r===void 0?void 0:r.comment,f.actionKey=i.key,[4,f.invokeAsync()];case 1:if(u=e.sent(),!u||u.code!==200)throw new Error(u===null||u===void 0?void 0:u.message);return[2,u.data]}})})},t.prototype.getMoveInfoWithUsersAsync=function(t,i){return __awaiter(this,void 0,void 0,function(){var u,r;return __generator(this,function(f){switch(f.label){case 0:return u=new n.GetMoveInfoWithUsersApi,u.taskId=t,u.takeSequenceFlowId=i,[4,u.invokeAsync()];case 1:if(r=f.sent(),!r||r.code!==200)throw new Error(r===null||r===void 0?void 0:r.message);return[2,r.data]}})})},t.prototype.getDispatchMoveInfoWithUsersAsync=function(t,i){return __awaiter(this,void 0,void 0,function(){var u,r;return __generator(this,function(f){switch(f.label){case 0:return u=new n.GetDispatchMoveInfoWithUsersApi,u.taskId=t,u.actionKey=i,[4,u.invokeAsync()];case 1:if(r=f.sent(),!r||r.code!==200)throw new Error(r===null||r===void 0?void 0:r.message);return[2,r.data]}})})},t.prototype.getDelegateInfoAsync=function(){return __awaiter(this,void 0,void 0,function(){var i,t;return __generator(this,function(r){switch(r.label){case 0:return i=new n.GetDelegateUsersApi,[4,i.invokeAsync()];case 1:if(t=r.sent(),!t||t.code!==200)throw new Error(t===null||t===void 0?void 0:t.message);return[2,t.data]}})})},t.prototype.getAddOnSignInfoAsync=function(){return __awaiter(this,void 0,void 0,function(){var i,t;return __generator(this,function(r){switch(r.label){case 0:return i=new n.GetAddOnSignUsersApi,[4,i.invokeAsync()];case 1:if(t=r.sent(),!t||t.code!==200)throw new Error(t===null||t===void 0?void 0:t.message);return[2,t.data]}})})},t.prototype.getCarbonCopyInfoAsync=function(){return __awaiter(this,void 0,void 0,function(){var i,t;return __generator(this,function(r){switch(r.label){case 0:return i=new n.GetCarbonCopyUsersApi,[4,i.invokeAsync()];case 1:if(t=r.sent(),!t||t.code!==200)throw new Error(t===null||t===void 0?void 0:t.message);return[2,t.data]}})})},t.prototype.getProcessNotificationNumAsync=function(){return __awaiter(this,void 0,void 0,function(){var i,t;return __generator(this,function(r){switch(r.label){case 0:return i=new n.ProcessNotificationNumApi,[4,i.invokeAsync()];case 1:if(t=r.sent(),!t||t.code!==200)throw new Error(t===null||t===void 0?void 0:t.message);return[2,t.data]}})})},t}();n.TaskService=t})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var t;(function(n){var t=function(){function t(){this.taskService=new n.TaskService;this.processDefinitionService=new n.ProcessDefinitionService;this.processInstanceService=new n.ProcessInstanceService;this.delegationConfigurationService=new n.DelegationConfiguration.DelegationConfigurationService}return t}();n.Engine=new t})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t=function(){function t(){}return t.actionCommand=function(t,i,r){var u,f,e,o,s,h;return __awaiter(this,void 0,void 0,function(){var a,v,c,tt,p,it,w,nt,b,k,d,y,l,rt,g;return __generator(this,function(ut){switch(ut.label){case 0:return ut.trys.push([0,50,,51]),[4,n.BPM.Engine.taskService.describeDetailAsync(t)];case 1:a=ut.sent();v=new n.CommandLogHelper;v.tryStartNewRoot();v.suspend();v.log(n.Common.format(n.RS.BPM_LogText_ExecuteTaskNodeAction,i.title||n.RS.ProcessPanelCellType_UnnamedAction,t));v.startChild();c={taskInfo:a,action:i,cell:r,logHelper:v};tt=i.type;switch(tt){case 100:return[3,2];case 200:return[3,8];case 300:return[3,11];case 400:return[3,14];case 500:return[3,20];case 501:return[3,26];case 600:return[3,29];case 800:return[3,35];case 801:return[3,41];case 1e3:return[3,43];case 2e3:return[3,45]}return[3,47];case 2:return(p=(u=i===null||i===void 0?void 0:i.commitOption)===null||u===void 0?void 0:u.autoSave,!p)?[3,4]:[4,this.saveBusinessData(c)];case 3:p=ut.sent();ut.label=4;case 4:return p,[4,n.BPM.Engine.taskService.getMoveInfoWithUsersAsync(a.taskId,undefined)];case 5:return it=ut.sent(),[4,this.openDialog(i,[{type:1,payload:{moveInfo:it}},{type:0,payload:{taskInfo:a,action:i}},])];case 6:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 7:return ut.sent(),[3,48];case 8:return[4,this.openDialog(i,[{type:0,payload:{taskInfo:a,action:i}},])];case 9:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 10:return ut.sent(),[3,48];case 11:return[4,this.openDialog(i,[{type:0,payload:{taskInfo:a,action:i}},])];case 12:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 13:return ut.sent(),[3,48];case 14:return(w=(f=i===null||i===void 0?void 0:i.dispatchOption)===null||f===void 0?void 0:f.autoSave,!w)?[3,16]:[4,this.saveBusinessData(c)];case 15:w=ut.sent();ut.label=16;case 16:return w,[4,n.BPM.Engine.taskService.getDispatchMoveInfoWithUsersAsync(t,i.key)];case 17:return nt=ut.sent(),[4,this.openDialog(i,[{type:1,payload:{moveInfo:nt,initTrackPath:nt.TrackInfo.activityId}},{type:0,payload:{taskInfo:a,action:i}},])];case 18:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 19:return ut.sent(),[3,48];case 20:return(b=(e=i===null||i===void 0?void 0:i.delegateOption)===null||e===void 0?void 0:e.autoSave,!b)?[3,22]:[4,this.saveBusinessData(c)];case 21:b=ut.sent();ut.label=22;case 22:return b,[4,n.BPM.Engine.taskService.getDelegateInfoAsync()];case 23:return y=ut.sent(),[4,this.openDialog(i,[{type:2,payload:{userInfos:y}},{type:0,payload:{taskInfo:a,action:i}},])];case 24:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 25:return ut.sent(),[3,48];case 26:return[4,this.openDialog(i,[{type:0,payload:{taskInfo:a,action:i}},])];case 27:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 28:return ut.sent(),[3,48];case 29:return(k=(o=i===null||i===void 0?void 0:i.addOnSignOption)===null||o===void 0?void 0:o.autoSave,!k)?[3,31]:[4,this.saveBusinessData(c)];case 30:k=ut.sent();ut.label=31;case 31:return k,[4,n.BPM.Engine.taskService.getAddOnSignInfoAsync()];case 32:return y=ut.sent(),[4,this.openDialog(i,[{type:3,payload:{userInfos:y,type:(s=i.addOnSignOption)===null||s===void 0?void 0:s.type}},{type:0,payload:{taskInfo:a,action:i}},])];case 33:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 34:return ut.sent(),[3,48];case 35:return(d=(h=i===null||i===void 0?void 0:i.carbonCopyOption)===null||h===void 0?void 0:h.autoSave,!d)?[3,37]:[4,this.saveBusinessData(c)];case 36:d=ut.sent();ut.label=37;case 37:return d,[4,n.BPM.Engine.taskService.getCarbonCopyInfoAsync()];case 38:return y=ut.sent(),[4,this.openDialog(i,[{type:4,payload:{userInfos:y}},{type:0,payload:{taskInfo:a,action:i}},])];case 39:return l=ut.sent(),[4,this.executeActionCommand(c,l)];case 40:return ut.sent(),[3,48];case 41:return[4,this.executeActionCommand(c,null)];case 42:return ut.sent(),[3,48];case 43:return[4,this.executeActionCommand(c,null)];case 44:return ut.sent(),[3,48];case 45:return[4,this.executeActionCommand(c,null)];case 46:return ut.sent(),[3,48];case 47:throw"error action type";case 48:return n.NormalCellBindingManager.reloadData(null,!1),[4,this.executePostCommand(c)];case 49:return(rt=ut.sent(),v.endChild(),v.resume(),v.consoleLog(),!rt)?[2]:(n.Page.reloadBindingData(),r.debounceLoad(),[3,51]);case 50:return(g=ut.sent(),g&&g.notNeedBeHandled)?[2]:(alert(g.message),[3,51]);case 51:return[2]}})})},t.openDialog=function(t,i){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(u){switch(u.label){case 0:return[4,new Promise(function(r){var u=new n.BPM.TaskActionDialog(i);u.title=t.title||n.RS.ProcessPanelCellType_UnnamedAction;u.on("Confirm",function(n,t){if(!u.verify())return t&&(t.cancel=!0),null;r(u.dialogResult)});u.on("Close",function(n,t){if(!u.canClose()){t&&(t.cancel=!0);return}r(null)});u.on("Cancel",function(){r(null)});if(!u.hasContent){u.dispatch("Confirm");return}u.appendExtralPopup();u.show()})];case 1:if(r=u.sent(),!r)throw{message:"dialog isn't confirmed",notNeedBeHandled:!0};return[2,r]}})})},t.executePreCommand=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(i){switch(i.label){case 0:return[4,this.executeForguncyCommand("processprecommand",n)];case 1:if(t=i.sent(),!t)throw{message:"".concat("processprecommand"," isn't completed"),notNeedBeHandled:!0};return[2]}})})},t.executePostCommand=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.executeForguncyCommand("processpostcommand",n)];case 1:return[2,t.sent()]}})})},t.executeForguncyCommand=function(t,i){var u=i.taskInfo,f=i.action,r=i.cell,e=i.logHelper;return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,new Promise(function(i){var s,h,c,l,o;switch(t){case"processprecommand":o=(h=(s=r===null||r===void 0?void 0:r.CellElement)===null||s===void 0?void 0:s.CellType)===null||h===void 0?void 0:h.PreCommands;break;case"processpostcommand":o=(l=(c=r===null||r===void 0?void 0:r.CellElement)===null||c===void 0?void 0:c.CellType)===null||l===void 0?void 0:l.PostCommands;break;default:throw"don't support other eventType";}if(!o||o.length===0){i(!0);return}n.ForguncyData.commandExcutor.excuteCommand(o,{runTimePageName:r.runTimePageName,commandTrigger:r,commandID:r.ID,eventType:t,callbackOnCommandCompleted:i,initParams:{Process:{Id:u.processInstanceId,Name:u.processName,DefinitionId:u.processDefinitionId},Task:{Id:u.taskId,Name:u.name,Description:u.description,Assignee:u.assignee},Action:{Name:f.title}},locationString:n.FormulaHelper.getCellLogLocationString(r.ID,r.Name,r.runTimePageName),logHelper:e})})];case 1:return[2,i.sent()]}})})},t.saveBusinessData=function(t){return __awaiter(this,void 0,void 0,function(){var o,l,u,f,a,r,e,s,i,h,c,v;return __generator(this,function(y){switch(y.label){case 0:if(o=t.taskInfo,l=t.logHelper,u=o.businessKey,f=o.extensionElement.generalSetting.tables,!f||f.length===0)return[2];for(a=new Set(JSON.parse(u!==null&&u!==void 0?u:"[]").map(function(n){return n.tableName})),r=[],e=0,s=f;e<s.length;e++)(i=s[e],n.Common.isBuiltInDataBaseView(i))||(h=n.ForguncyData.pageInfo.normalCellBindingManager.getEditedBindingValues(i),h&&h.length)&&(c=n.ForguncyData.pageInfo.currentRowInfoCollection.getCurrentRowInfo(i),a.has(i)?c&&r.push({tableName:i,UpdateType:"edit"}):c||r.push({tableName:i,UpdateType:"add"}));return r.length>0&&l.log(n.RS.BPM_LogText_SaveBussinessData+JSON.stringify(r)),[4,this.executeUpdateDataTableCommand(t,r)];case 1:if(v=y.sent(),v===!1)throw{message:"save data isn't completed",notNeedBeHandled:!0};return[2]}})})},t.executeUpdateDataTableCommand=function(t,i){var r=t.cell,f=t.logHelper,u;if(i&&i.length!==0)return u=i.map(function(t){var i=t.tableName,r=t.UpdateType;return{$type:"Forguncy.Model.UpdateDataTableCommand, ServerDesignerCommon",ConfirmText:n.RS.ProcessPanelCellType_UpdateCurrentRowsClosure_ConfirmText,RowsToUpdate:0,TableName:i,UpdateType:r,UpdateBindingValues:[],CheckDataValidation:!0,ReloadAfterSucceed:!0}}),new Promise(function(t){n.ForguncyData.commandExcutor.excuteCommand(u,{runTimePageName:r.runTimePageName,commandTrigger:r,commandID:r.ID,eventType:"processsavebusinessdatacommand",callbackOnCommandCompleted:t,logHelper:f})})},t.executeActionCommand=function(t,i){return __awaiter(this,void 0,void 0,function(){var f,u,e,o,r;return __generator(this,function(s){switch(s.label){case 0:n.PageBuilder.pageCover.show();s.label=1;case 1:return s.trys.push([1,,26,27]),[4,this.executePreCommand(t)];case 2:s.sent();f=t.taskInfo.taskId;u=t.action;e=t.logHelper;o=u.type;switch(o){case 100:return[3,3];case 200:return[3,5];case 300:return[3,7];case 400:return[3,9];case 500:return[3,11];case 501:return[3,13];case 600:return[3,15];case 800:return[3,17];case 801:return[3,19];case 1e3:return[3,21];case 2e3:return[3,23]}return[3,24];case 3:return[4,n.BPM.Engine.taskService.commitAsync(f,u,i)];case 4:return r=s.sent(),this.log(e,n.RS.BPM_LogText_CommitTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 5:return[4,n.BPM.Engine.taskService.terminateAsync(f,u,i)];case 6:return r=s.sent(),this.log(e,n.RS.BPM_LogText_TerminateTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 7:return[4,n.BPM.Engine.taskService.rollbackAsync(f,u,i)];case 8:return r=s.sent(),this.log(e,n.RS.BPM_LogText_RollbackTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 9:return[4,n.BPM.Engine.taskService.dispatchAsync(f,u,i)];case 10:return r=s.sent(),this.log(e,n.RS.BPM_LogText_DispatchTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 11:return[4,n.BPM.Engine.taskService.delegateAsync(f,u,i)];case 12:return r=s.sent(),this.log(e,n.RS.BPM_LogText_DelegateTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 13:return[4,n.BPM.Engine.taskService.cancelDelegateAsync(f,u,i)];case 14:return r=s.sent(),this.log(e,n.RS.BPM_LogText_CancelDelegateTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 15:return[4,n.BPM.Engine.taskService.addOnSignAsync(f,u,i)];case 16:return r=s.sent(),this.log(e,n.RS.BPM_LogText_AddOnSignTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 17:return[4,n.BPM.Engine.taskService.carbonCopyAsync(f,u,i)];case 18:return r=s.sent(),this.log(e,n.RS.BPM_LogText_CarbonCopyTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 19:return[4,n.BPM.Engine.taskService.readCarbonCopyAsync(f,u,i)];case 20:return r=s.sent(),this.log(e,n.RS.BPM_LogText_ReadCarbonCopyTitle,r===null||r===void 0?void 0:r.logText),[3,25];case 21:return[4,this.saveBusinessData(t)];case 22:return s.sent(),[3,25];case 23:return[3,25];case 24:throw"error type of send action service";case 25:return[3,27];case 26:return n.PageBuilder.pageCover.hide(),[7];case 27:return[2]}})})},t.log=function(n,t,i){n.log(t);i&&(n.startChild(),n.logGroupedText(i),n.endChild())},t.setHorizontalAlignment=function(t,i){switch(i){case n.CellHorizontalAlignment.General:case n.CellHorizontalAlignment.Left:t.css("justify-content","flex-start");break;case n.CellHorizontalAlignment.Center:t.css("justify-content","center");break;case n.CellHorizontalAlignment.Right:t.css("justify-content","flex-end")}},t.setVerticalAlignment=function(t,i){switch(i){case n.CellVerticalAlignment.Top:t.css("align-items","flex-start");break;case n.CellVerticalAlignment.Center:t.css("align-items","center");break;case n.CellVerticalAlignment.Bottom:t.css("align-items","flex-end")}},t.setLineSpacingToControl=function(t,i,r,u){if(i.length!==0)switch(r){case n.CellVerticalAlignment.Top:i.forEach(function(n){return n.css("margin-bottom",u)});break;case n.CellVerticalAlignment.Center:i.forEach(function(n){return n.css("margin-bottom",u)});t.css("margin-bottom","-".concat(u,"px"));break;case n.CellVerticalAlignment.Bottom:i.forEach(function(n){return n.css("margin-top",u)})}},t.setIndentToControl=function(t,i){var r=i.TextIndent,u=i.HorizontalAlignment;if(r&&!(r<0))switch(u){case n.CellHorizontalAlignment.General:case n.CellHorizontalAlignment.Left:t.css("padding-left",r);break;case n.CellHorizontalAlignment.Right:t.css("padding-right",r)}},t}(),i,r;n.ProcessPanelHelper=t;i=function(n){function t(){var t=n.call(this)||this;return t.CellTypeString="Forguncy.ProcessPanelCellType",t.TemplateNameParts=["PROCESS_PANEL"],t}return __extends(t,n),t.prototype.MapPartsNameToDom=function(n){return{PROCESS_PANEL:n}},t}(n.CellTypeStyleTemplateHelperBase);n.ProcessPanelCellTypeStyleTemplateHelper=i;r=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n._collapsedIndex=-1,n.actionButtonsInfos=[],n}return __extends(u,r),Object.defineProperty(u.prototype,"isWrap",{get:function(){return this.CellElement.StyleInfo.WordWrap},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"collapsedIndex",{get:function(){return this._collapsedIndex},set:function(n){this._collapsedIndex=n;this.updateButtons();t.setHorizontalAlignment(this.getContainer(),this.CellElement.StyleInfo.HorizontalAlignment);this.updateMoreButtonContextMenu()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"isCollapsed",{get:function(){return this.collapsedIndex>-1},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"contentContainer",{get:function(){return $("#"+this.ID)},enumerable:!1,configurable:!0}),u.prototype.Refresh=function(){this.debounceLoad()},u.prototype.create=function(n){r.prototype.create.call(this,n);n.css({display:"flex"});t.setVerticalAlignment(n,this.CellElement.StyleInfo.VerticalAlignment)},u.prototype.createContent=function(){var t=n.DomUtilities.createJqueryDomElement("div").attr("id",this.ID);return t.css({display:"flex",flexWrap:"nowrap"}),t},u.prototype.onLoad=function(){var t=this;this.debounceLoad();n.ForguncyData.pageInfo.currentRowInfoCollection.bind("currentprocessinfochanged",function(){t.debounceLoad()})},u.prototype.onWindowResized=function(){this.updatePanelLayout()},u.prototype.getStyleTemplateHelper=function(){return u.StyleTemplateHelper},u.prototype.applyTemplateStyle=function(){var e=this,i;if(this.actionButtonsInfos.length!==0){var r=__spreadArray(__spreadArray([],this.actionButtonsInfos,!0),[this.moreButtonInfo],!1),s=r.length,u=this.CellElement.CellType,h=u.ActionButtonStyleTemplateInfos,o=u.ButtonGap,c=u.TemplateKey,f=this.getStyleTemplateHelper();f!==null&&(i=n.ForguncyData.GlobalSettings.CellTypeStyleTemplates[f.CellTypeString],i&&r.forEach(function(n){var r,u,o=n.title,s=n.container,t=(u=(r=h.find(function(n){var t=n.ActionTitle;return t===o}))===null||r===void 0?void 0:r.TemplateKey)!==null&&u!==void 0?u:c,e;t&&Object.prototype.hasOwnProperty.call(i,t)&&(e=i[t],Object.prototype.hasOwnProperty.call(i,t)&&f.ApplyTemplateStyle(e,s))}));r.forEach(function(t,i){var r=t.container;n.DomUtilities.setPropertyToDom(e.CellElement,r,e._getDomCreateInfo(),[0]);i<s-2&&r.css("margin-right",o)});this.isWrap&&t.setLineSpacingToControl(this.contentContainer,r.map(function(n){return n.container}),this.CellElement.StyleInfo.VerticalAlignment,o);t.setIndentToControl(this.getContainer(),this.CellElement.StyleInfo)}},u.prototype.debounceLoad=function(){var t=this;this.debounceTimer&&(n.DelayRefresh.clearTimeout(this.debounceTimer),this.debounceTimer=null);this.debounceTimer=n.DelayRefresh.setTimeout(function(){window.requestAnimationFrame(function(){return __awaiter(t,void 0,void 0,function(){var t,i,r;return __generator(this,function(u){switch(u.label){case 0:if(t=n.ForguncyData.pageInfo.currentRowInfoCollection.getTaskId(),!t)return this.clearActionButtons(),[2];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,n.BPM.Engine.taskService.describeDetailAsync(t)];case 2:return i=u.sent(),this.clearActionButtons(),this.createButtons(i),this.updatePanelLayout(!0),[3,4];case 3:return r=u.sent(),alert(r.message),[3,4];case 4:return[2]}})})})},20)},u.prototype.clearActionButtons=function(){this.actionButtonsInfos=[];this.moreButtonInfo=null;this.contentContainer.empty()},u.prototype.calulateCollapsedIndex=function(){if(this.isWrap||this.actionButtonsInfos.length===0)return-1;var n=this.getContainer().width(),t=this.actionButtonsInfos[this.actionButtonsInfos.length-1].arrivedWidth,i=t>n?n-(this.moreButtonInfo.arrivedWidth-t):n;return this.actionButtonsInfos.findIndex(function(n){var t=n.arrivedWidth;return t>i})},u.prototype.updatePanelLayout=function(n){n===void 0&&(n=!1);var t=this.calulateCollapsedIndex();(n||t!==this.collapsedIndex)&&(this.collapsedIndex=t)},u.prototype.createButtons=function(i){var r,u,f=i.extensionElement,e=i.taskId,o=i.isSuspend;return __awaiter(this,void 0,void 0,function(){var s,i,h=this;return __generator(this,function(){return s=o?[]:(u=(r=f===null||f===void 0?void 0:f.generalSetting)===null||r===void 0?void 0:r.actions)!==null&&u!==void 0?u:[],this.actionButtonsInfos=s.filter(function(n){return n.enable}).map(function(i){return{title:i.title||n.RS.ProcessPanelCellType_UnnamedAction,container:n.DomUtilities.createJqueryDomElement("div").addClass("fgc-bpm-panel-actionbutton").text(i.title||n.RS.ProcessPanelCellType_UnnamedAction).click(function(){return __awaiter(h,void 0,void 0,function(){return __generator(this,function(){return t.actionCommand(e,i,this),[2]})})})}}),this.moreButtonInfo={title:"···",container:n.DomUtilities.createJqueryDomElement("div").addClass("fgc-bpm-panel-morebutton").append($('<svg t="1637914159908" class="icon" viewBox="0 0 1024 1024" version="1.1" fill="currentColor" xmlns="http://www.w3.org/2000/svg" p-id="1337" width="200" height="200"><path d="M227.14123 413.647995c-52.14973 0-94.587262 42.439578-94.587262 94.587262 0 52.14973 42.437531 94.587262 94.587262 94.587262 52.147684 0 94.587262-42.437531 94.587262-94.587262C321.728492 456.087573 279.288914 413.647995 227.14123 413.647995z" p-id="1338"><\/path><path d="M510.903016 413.647995c-52.14973 0-94.587262 42.439578-94.587262 94.587262 0 52.14973 42.437531 94.587262 94.587262 94.587262 52.147684 0 94.587262-42.437531 94.587262-94.587262C605.490278 456.087573 563.051723 413.647995 510.903016 413.647995z" p-id="1339"><\/path><path d="M794.665825 413.647995c-52.14973 0-94.587262 42.439578-94.587262 94.587262 0 52.14973 42.437531 94.587262 94.587262 94.587262 52.147684 0 94.587262-42.437531 94.587262-94.587262C889.253086 456.087573 846.813508 413.647995 794.665825 413.647995z" p-id="1340"><\/path><\/svg>')).click(function(){h.createMoreButtonContextMenu()})},i=__spreadArray(__spreadArray([],this.actionButtonsInfos,!0),[this.moreButtonInfo],!1),this.contentContainer.append(i.map(function(n){return n.container})),this.applyTemplateStyle(),i.forEach(function(n){var t=n.container[0];n.arrivedWidth=t.offsetLeft+t.offsetWidth}),[2]})})},u.prototype.updateButtons=function(){var n=this;this.isCollapsed?(this.actionButtonsInfos.forEach(function(t,i){var r=t.container;i<n.collapsedIndex?r.show():r.hide()}),this.moreButtonInfo.container.show()):(this.actionButtonsInfos.forEach(function(n){var t=n.container;t.show()}),this.moreButtonInfo.container.hide())},u.prototype.createMoreButtonContextMenu=function(){var t,i;this.isCollapsed&&(t=(new n.UI.ContextMenu).identify("fgc-columnfilter-contextmenu"),this.moreButtonContextMenu=t,this.updateMoreButtonContextMenu(),n.ForguncyData.pageInfo.appendExtralPopup(t),i=t.createUI(),n.PageBuilder.pagesContainer.append(i.container),i.applyModifier(new n.UI.AutoLocateModifier(i,new n.UI.Anchor(this.moreButtonInfo.container))),t.show())},u.prototype.updateMoreButtonContextMenu=function(){var r=this,t,i;this.moreButtonContextMenu&&(this.isCollapsed?(t=this.actionButtonsInfos.slice(this.collapsedIndex),i=t.map(function(t){var i=t.title,u=t.container;return new n.UI.ContextMenuItem(new n.UI.ContextMenuButton(i).on("Clicked",function(){u.click();r.moreButtonContextMenu.dispose()}))}),this.moreButtonContextMenu.refill(i),this.moreButtonContextMenu.show()):(this.moreButtonContextMenu.refill([]),this.moreButtonContextMenu.hide()))},u.StyleTemplateHelper=new i,u}(n.CellTypeBase);n.ProcessPanelCellType=r;n.CellTypeHelper.registerCellType("Forguncy.ProcessPanelCellType, ServerDesignerCommon",r)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.localStorageKey="FGC_PROCESS_TRACKER_INSTANCEKEY",n._iframe=undefined,n.instanceId="",n.Refresh=function(){var t,i;((i=(t=n._iframe)===null||t===void 0?void 0:t.contentWindow)===null||i===void 0?void 0:i.FGC_refresh)?n._iframe.contentWindow.FGC_refresh():n._iframe.contentWindow.location.reload()},n}return __extends(i,t),Object.defineProperty(i.prototype,"contentContainer",{get:function(){return $("#"+this.ID)},enumerable:!1,configurable:!0}),i.prototype.create=function(n){t.prototype.create.call(this,n);this.createIframe(n)},i.prototype.createIframe=function(t){var r=n.PageInfo.getCurrentPageInfo(),u="".concat(n.ForguncyData.ForguncyRoot,"BPM/Portal/tracker.html?instId=").concat(this.instanceId,"&lang=").concat(n.StaticData.Lang,"&ID=").concat(r.pageName+"_"+this.ID),i=document.createElement("iframe");i.title="tracker";i.width="100%";i.height="100%";i.src=u;i.style.border="none";t[0].innerHTML="";t[0].appendChild(i);this._iframe=i},i.prototype.setValueToElement=function(n,t){var i,r;this.instanceId=t;((r=(i=this._iframe)===null||i===void 0?void 0:i.contentWindow)===null||r===void 0?void 0:r.setTrackerInstaceId)?this._iframe.contentWindow.setTrackerInstaceId(this.instanceId):this.createIframe(n)},i.prototype.getValueFromElement=function(){return this.instanceId},i}(n.CellTypeBase);n.ProcessTrackerCellType=t;n.CellTypeHelper.registerCellType("Forguncy.ProcessTrackerCellType, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var r=function(i){function r(r){var o,e=i.call(this)||this;return e.defaultUI=u,e.options=[],e.generateTaskRows=(o={},o[0]=new t.TaskActionDialogTaskRowTypeRemark,o[1]=new t.TaskActionDialogTaskRowTypeTaskMoveInfo,o[2]=new t.TaskActionDialogTaskRowTypeTaskDelegateInfo,o[3]=new t.TaskActionDialogTaskRowTypeTaskAddOnSignInfo,o[4]=new t.TaskActionDialogTaskRowTypeTaskCarbonCopyInfo,o),e.options=r,e.identify("fgc-bpm-dialog"),e.layouts=new n.UI.FlexLayout(1),e.attrs.popuptype="dialog",e.createContent(),e.isMobileMode&&(e.defaultUI=f),e}return __extends(r,i),Object.defineProperty(r.prototype,"hasContent",{get:function(){return this.layouts.items.length!==0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dialogResult",{get:function(){var n=this;return this.options.reduce(function(t,i){var r=i.type;return Object.assign(t,n.generateTaskRows[r].result())},{})},enumerable:!1,configurable:!0}),r.prototype.createContent=function(){var n=this;this.options.forEach(function(t){var i=t.type,r=t.payload;n.generateTaskRows[i].generate(n.layouts,r)})},r.prototype.verify=function(){var n=this;return this.options.every(function(t){var i=t.type;return n.generateTaskRows[i].verify()})},r}(t.BPMDialog);t.TaskActionDialog=r;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new i(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI),f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"header",{get:function(){return new e(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return new i(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI),i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.layouts.createUI())},t}(n.UI.DialogContentUI),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){n.prototype.createChildren.call(this);this.container.empty();this.addChild(this.target.closeButton.createUI());this.container.append(this.titleContainer)},t}(n.UI.DialogHeaderUI)})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Forguncy;(function(n){var t;(function(t){var u=function(){function n(){}return n.prototype.generate=function(n,r){var e=r.taskInfo,o=r.action,u=e.extensionElement.generalSetting.actions.find(function(n){return n.key===o.key}),f;u&&u.remarks&&(f=u.remarks.find(function(n){return n.key===t.RemarkKeys.Text}),f&&f.enable)&&(this.taskRow=new i,n.add(this.taskRow))},n.prototype.verify=function(){return!0},n.prototype.result=function(){var n;return{comment:(n=this.taskRow)===null||n===void 0?void 0:n.getValue()}},n}(),i,r;t.TaskActionDialogTaskRowTypeRemark=u;i=function(t){function i(){var i=t.call(this)||this;return i.contentContainer=new n.UI.TextArea({placeholder:n.RS.TaskActionDialog_CommentTextRow_PlaceHolder,autosize:{minRows:5,maxRows:5}}).addAttrs({AutomationId:"remarkRow_TextArea"}),i.defaultUI=r,i.addClass("fgc-bpm-form-row"),i.principalLayout=n.Platform.isMobile()?new n.UI.FlexLayout(1).addClass("fgc-bpm-form-field-remark").add(new n.UI.TextBlock(n.RS.TaskActionDialog_CommentTextRow_Label).addClass("fgc-bpm-form-row-title"),i.contentContainer):(new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.TaskActionDialog_CommentTextRow_Label).addClass("fgc-bpm-form-field-name"),i.contentContainer),i}return __extends(i,t),i.prototype.getValue=function(){return this.contentContainer.text},i}(n.UI.UserControl);r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.principalLayout.createUI())},t}(n.UI.ControlUIBase)})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var o=function(){function t(){this.selectedUserInfos={}}return t.prototype.generate=function(t,r){var s=this,u=r.moveInfo,f=r.initTrackPath,h=f===void 0?"":f,o;(u===null||u===void 0?void 0:u.TrackInfo)&&(o=e.getLoopInfos(u,h),o.forEach(function(r){var e=r.trackInfo,o=e.activityId,f=e.activityName,h=r.trackPath;t.add(new n.UI.FlexLayout(1).addClass("fgc-bpm-form-row").addAttrs({AutomationId:"moveInfoRow"}).add(new n.UI.TextBlock(f!==null&&f!==void 0?f:n.RS.BPM_UserSetting_UnnamedNode).addClass("fgc-bpm-form-row-title").addAttrs({AutomationId:"moveInfoRow_activityName"}),(new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_AssginToLabel).addClass("fgc-bpm-form-field-name"),i.generateMoveInfo(u,o,h,s.selectedUserInfos))))}))},t.prototype.verify=function(){var t,i;for(t in this.selectedUserInfos)for(i in this.selectedUserInfos[t])if(this.selectedUserInfos[t][i].length===0)return alert(n.RS.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty),!1;return!0},t.prototype.result=function(){var t=this,n={};return Object.keys(this.selectedUserInfos).forEach(function(i){n[i]={};Object.keys(t.selectedUserInfos[i]).forEach(function(r){n[i][r]=t.selectedUserInfos[i][r].join(",")})}),{selectedUserInfos:n}},t}(),r,u,f,e,i;t.TaskActionDialogTaskRowTypeTaskMoveInfo=o;r=function(){function t(){this.options={delegateTo:""}}return t.prototype.generate=function(t,r){var u=r.userInfos;t.add(new n.UI.FlexLayout(1).addClass("fgc-bpm-form-row").addAttrs({AutomationId:"moveInfoRow"}).add((new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_DelegateToLabel).addClass("fgc-bpm-form-field-name"),i.generateDelegate(u,this.options))))},t.prototype.verify=function(){return n.Common.IsEmpty(this.options.delegateTo)?(alert(n.RS.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty),!1):!0},t.prototype.result=function(){return this.options},t}();t.TaskActionDialogTaskRowTypeTaskDelegateInfo=r;u=function(){function t(){this.options={addOnSignTos:[]}}return t.prototype.generate=function(t,r){var f=r.userInfos,u=r.type;u===undefined||u===1?t.add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_AddOnSignTypePre).addClass("fgc-bpm-textblock-quote")).addAttrs({AutomationId:"addOnSignTypePre"}):u===2?t.add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_AddOnSignTypePost).addClass("fgc-bpm-textblock-quote")).addAttrs({AutomationId:"addOnSignTypePost"}):(this.radioGroup=new n.UI.RadioGroup(1).add(new n.UI.Radio(n.RS.TaskActionDialog_AssigneesRow_AddOnSignTypePre,"FGC_AddOnSignType_Radio").addAttrs({AutomationId:"addOnSignTypePre"}),new n.UI.Radio(n.RS.TaskActionDialog_AssigneesRow_AddOnSignTypePost,"FGC_AddOnSignType_Radio").addAttrs({AutomationId:"addOnSignTypePost"})).addClass("fgc-bpm-radiogroup"),this.radioGroup.items[0].isChecked=!0,t.add(new n.UI.FlexLayout(1).addClass("fgc-bpm-form-row").addAttrs({AutomationId:"addOnSignTypeRow"}).add((new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_AddOnSignTypeLabel).addClass("fgc-bpm-form-field-name"),this.radioGroup))));t.add(new n.UI.FlexLayout(1).addClass("fgc-bpm-form-row").addAttrs({AutomationId:"moveInfoRow"}).add((new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_AddOnSignToLabel).addClass("fgc-bpm-form-field-name"),i.generateAddOnSign(f,this.options))))},t.prototype.verify=function(){return this.options.addOnSignTos.length===0?(alert(n.RS.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty),!1):!0},t.prototype.result=function(){var n={addOnSignTos:this.options.addOnSignTos.join(",")};return this.radioGroup&&(n.addOnSignCustomType=this.radioGroup.items[0].isChecked?1:2),n},t}();t.TaskActionDialogTaskRowTypeTaskAddOnSignInfo=u;f=function(){function t(){this.options={carbonCopyTos:[]}}return t.prototype.generate=function(t,r){var u=r.userInfos;t.add(new n.UI.FlexLayout(1).addClass("fgc-bpm-form-row").addAttrs({AutomationId:"moveInfoRow"}).add((new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_CarbonCopyToLabel).addClass("fgc-bpm-form-field-name"),i.generateCarbonCopy(u,this.options))))},t.prototype.verify=function(){return this.options.carbonCopyTos.length===0?(alert(n.RS.TaskActionDialog_AssigneesRow_Error_AssigneesCanNotBeEmpty),!1):!0},t.prototype.result=function(){return{carbonCopyTos:this.options.carbonCopyTos.join(",")}},t}();t.TaskActionDialogTaskRowTypeTaskCarbonCopyInfo=f;e=function(){function i(){}return i.getLoopInfos=function(n,i){var r=[];return this.loopTrackInfo(n.TrackInfo,i,function(i,u){var f=n.ActivityPropertyInfos[i===null||i===void 0?void 0:i.activityId],e;f&&(e=f.userSetting.assigneeTarget===t.AssigneeTarget.SelectByUser,e)&&r.push({trackInfo:i,trackPath:u})}),r},i.loopTrackInfo=function(t,i,r){var f=this,u;((u=t.next)===null||u===void 0?void 0:u.length)>0?t.next.forEach(function(t){f.loopTrackInfo(t,"".concat(n.Common.IsEmpty(i)?"":"".concat(i,"&")).concat(t.activityId),r)}):r(t,i)},i}();i=function(){function i(){}return i.generateMoveInfo=function(i,r,u,f){var e=i.ActivityPropertyInfos[r].userSetting.assigneeTarget;switch(e){case t.AssigneeTarget.SelectByUser:return this.generateMoveInfoOfSelectByUser(i,r,u,f);case t.AssigneeTarget.All:throw"暂不支持渲染所有用户信息";default:throw n.RS.BPM_Error_AssigneesTarget_TypeIsNotExist;}},i.generateDelegate=function(n,t){var i=function(){return{userInfos:n,selectedUserNames:[t.delegateTo]}},r=function(n){t.delegateTo=n.map(function(n){return n.UserName})[0]};return this.generateUserSelectRow(i,r)},i.generateAddOnSign=function(n,t){var i=function(){return{isMultiSelect:!0,userInfos:n,selectedUserNames:__spreadArray([],t.addOnSignTos,!0)}},r=function(n){t.addOnSignTos=n.map(function(n){return n.UserName})};return this.generateUserSelectRow(i,r)},i.generateCarbonCopy=function(n,t){var i=function(){return{isMultiSelect:!0,userInfos:n,selectedUserNames:__spreadArray([],t.carbonCopyTos,!0)}},r=function(n){t.carbonCopyTos=n.map(function(n){return n.UserName})};return this.generateUserSelectRow(i,r)},i.generateMoveInfoOfSelectByUser=function(t,i,r,u){var f,e,o,s;return(u[i]={},u[i][r]=[],f=t.SelectableUserInfos[i],e=f&&f.length>0,!e)?new n.UI.TextBlock(n.RS.TaskActionDialog_AssigneesRow_Error_NoUserInfo).addAttrs({AutomationId:"moveInfoRow_noselectedInfo"}):(o=function(){return{isMultiSelect:t.ActivityPropertyInfos[i].userSetting.isMultiple,userInfos:f,selectedUserNames:u[i][r]}},s=function(n){u[i][r]=n.map(function(n){return n.UserName})},this.generateUserSelectRow(o,s))},i.generateUserSelectRow=function(i,r){var f=new n.UI.Button("",n.Platform.isMobile()?'<?xml version="1.0" encoding="UTF-8"?><svg width="8px" height="12px" viewBox="0 0 8 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Designer-Icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M4.54726758,2.31385803 C4.53447812,2.2990491 4.51692479,2.2944275 4.50336287,2.28056285 C4.50018695,2.27688545 4.49937153,2.27131968 4.49619562,2.26764229 C4.18242368,1.90894768 3.67706884,1.91078789 3.36647295,2.27320806 L-1.76856402,8.4247363 C-2.0791175,8.78805311 -2.0767548,9.3723113 -1.76375725,9.73189857 C-1.60809479,9.9103015 -1.40449282,10 -1.2017077,10 C-0.996518206,10 -0.790556287,9.90846273 -0.634850421,9.72638255 L3.94454148,4.22563179 L8.63967301,9.68567826 C8.79533547,9.86408119 8.99816401,9.95377969 9.20172256,9.95377969 C9.40768448,9.95377969 9.61287397,9.86224242 9.76857984,9.68016224 C10.0791333,9.31774097 10.0767282,8.73253813 9.76377304,8.37295085 L4.54726758,2.31385803 Z" fill="#6B6B6B" transform="translate(4.000000, 6.000000) scale(1, -1) rotate(-270.000000) translate(-4.000000, -6.000000) "><\/path><\/g><\/svg>':'<?xml version="1.0" encoding="utf-8"?><svg version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g transform="matrix(1 0 0 1 -320 -109 )"><path d="M 11 4.000720307931644  C 11 5.070091464100898  10.58420909175021 6.074266749035218  9.827959920080218 6.829189478502059  C 9.630733270899157 7.026073327943607  9.41665703364805 7.199895715734783  9.188994866188807 7.349294356860256  C 9.369802956612034 7.408994278921696  9.54856544721838 7.476299087671891  9.725049281339125 7.551171917176049  C 10.03068835974392 7.680561654988082  10.3247812505914 7.830382004394863  10.606411363392112 8  L 10 8  L 10.000003421276915 8.713608725536616  C 9.146746832375698 8.256671053560197  8.134050113607827 8.006070657625173  7.000716356881469 8.006070657625173  C 3.456649524798763 8.006070657625173  1.0576066635126153 10.454686450525159  1.0576066635126153 14  C 1.0576066635126153 14  0 14  0 14  C 0 13.052671099558637  0.1848701412330911 12.144265281024445  0.550310501413037 11.280193583170785  C 0.9028530736205198 10.444822995862324  1.4073048613040555 9.697006552489668  2.050769461711809 9.052542647649588  C 2.6942320832330893 8.408072796857454  3.4423124927382105 7.904266333711462  4.2763834324237 7.551171917176049  C 4.452610833891185 7.476407242661665  4.6311105538151764 7.409188765542439  4.811650545160887 7.349553176840558  C 4.5835752579369 7.199761042453417  4.369251783882362 7.025378236571171  4.172040079919782 6.827748862638785  C 3.417241267213626 6.072814128039738  3 5.0671982272421445  3 3.999279692068356  C 3.000000000200032 2.9313571551838464  3.4157909082497895 1.9271938753817326  4.172040079919782 1.1722511373612292  C 4.926838892625938 0.4158657826220775  5.930823378786272 0  7 0  C 8.06773026324015 0  9.073173110344783 0.4158657826220775  9.827959920080218 1.1722511373612292  C 10.582758732786374 1.927185871960262  11 2.9313511526177507  11 4.000720307931644  Z M 11.000005605509386 12  L 9 12  L 9 11  L 10.999999999999773 10.999999999997485  L 10.999999999999773 9  L 11.999999999999773 9  L 11.999994394490159 11  L 14 11  L 14 12  L 11.999999999999773 12.000000000002515  L 11.999999999999773 14  L 10.999999999999773 14  L 11.000005605509386 12  Z M 7 1  C 5.345617985413753 1  4 2.3456144762929654  4 4  C 4 5.654382014586247  5.345614476292951 7  7 7  C 8.653111712860323 6.998729354380259  10 5.653115221981139  10 4  C 10 2.346888287139663  8.653115221981125 1  7 1  Z M 13.929498276515346 13.000000003986898  C 13.976412363887789 13.328203127915629  14 13.661618452205573  14 14  C 14 14  12.907256252035495 14  13 13.999999993969809  L 13 12.999999987939617  L 13.929498276515346 13.000000003986898  Z " fill-rule="nonzero" fill="currentColor" stroke="none" transform="matrix(1 0 0 1 320 109 )" /><\/g><\/svg>').addAttrs({AutomationId:"moveInfoRow_editUserButton","fgc-bpm-id":"edit_user_btn"}),u=new n.UI.TextBlock("",n.RS.BPM_AssigneesRow_SelectByUser_Placeholder).addAttrs({AutomationId:"moveInfoRow_selectedInfo"}),e=function(){var e=i(),f=n.Platform.isMobile()?new t.UserSelectorDialogMobile(e):new t.UserSelectorDialog(e);f.on("Confirm",function(){var t=f.dialogResult.selectedUserInfos;r===null||r===void 0?void 0:r(t);u.text=t.map(function(t){return n.Common.IsEmpty(t.FullName)?t.UserName:t.FullName}).join(",")});f.on("Close",function(n,t){if(!f.canClose()){t&&(t.cancel=!0);return}});f.appendExtralPopup();f.show()};f.on("Clicked",function(){e()});u.on("ContainerClicked",function(){e()});return(new n.UI.FlexLayout).add(u,f).addClass("fgc-bpm-form-field-selectuser")},i}()})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return __awaiter(this,void 0,void 0,function(){var r,h,f,e,i,o,t,u,s;return __generator(this,function(c){switch(c.label){case 0:if(r=this.CommandParam,h=r.ProcessDefinitionId,f=r.ReturnResultName,e=this.evaluateFormula(h),i=this.evaluateFormula(r.ProcessInstanceName),i&&i._error){alert(n.RS.ProcessInstanceName_EvaluteError);throw n.RS.ProcessInstanceName_EvaluteError;}return(o=this.getBusinessKeyQuery(r),!(r.StartType===1))?[3,2]:(this.CommandExecutingInfo.logHelper.log(n.Common.format(n.RS.BPM_LogText_CallStartProcessCommand_ByDefinitionID,e,i!==null&&i!==void 0?i:"<empty>")),this.CommandExecutingInfo.logHelper.startChild(),[4,this.startAsync(e,o,i)]);case 1:return t=c.sent(),[3,4];case 2:return this.CommandExecutingInfo.logHelper.log(n.Common.format(n.RS.BPM_LogText_CallStartProcessCommand_ByName,r.ProcessDefinitionResourceName,i!==null&&i!==void 0?i:"<empty>")),this.CommandExecutingInfo.logHelper.startChild(),[4,this.startFromNameAsync(r.ProcessDefinitionResourceName,o,i)];case 3:t=c.sent();c.label=4;case 4:t.logText&&this.CommandExecutingInfo.logHelper.logGroupedText(t.logText);this.CommandExecutingInfo.logHelper.endChild();n.NormalCellBindingManager.reloadData(null,!1);u={};t.success?t.page&&t.page!=="%NULL%"?u[f]={ID:t.processInstanceId,Page:t.page,TaskExists:t.taskExists,ErrorMessage:""}:t.page&&t.page!=="%NULL%"||(u[f]={ID:t.processInstanceId,Page:null,TaskExists:t.taskExists,ErrorMessage:""}):u[f]={Page:null,ErrorMessage:t.message,TaskExists:!1};for(s in u)n.ForguncyData.parameterManager.setValue(s,u[s],this.CommandExecutingInfo.logHelper);return[2,n.CommandResult.completed]}})})},i.prototype.getBusinessKeyQuery=function(n){return{queries:[{tableName:n===null||n===void 0?void 0:n.SelectedTable,rowMode:n===null||n===void 0?void 0:n.RowsToUpdate,sqlCondition:n===null||n===void 0?void 0:n.RowsToUpdateCondition,listviewName:n===null||n===void 0?void 0:n.ListViewName,runtimePageName:this.CommandExecutingInfo.runTimePageName}]}},i.prototype.startAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var u;return __generator(this,function(f){switch(f.label){case 0:return u={},[4,n.BPM.Engine.processInstanceService.startProcessAsync(t,{businessKeyQuery:i,processInstanceName:r}).then(function(t){var r,f,i=t.taskList[0];u.success=!0;u.processInstanceId=t.processInstanceId;u.page=(f=(r=i===null||i===void 0?void 0:i.extensionElement)===null||r===void 0?void 0:r.generalSetting)===null||f===void 0?void 0:f.page;u.taskExists=!1;u.logText=t.logText;i&&(u.taskExists=!0,n.ForguncyData.pageInfo.currentRowInfoCollection.setProcessInfo(i.isEnd,i.taskId,i.processInstanceId))}).catch(function(n){var t;u.success=!1;u.message=(t=n===null||n===void 0?void 0:n.message)!==null&&t!==void 0?t:n})];case 1:return f.sent(),[2,u]}})})},i.prototype.startFromNameAsync=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var u;return __generator(this,function(f){switch(f.label){case 0:return u={},[4,n.BPM.Engine.processInstanceService.startProcessFormNameAsync(t,{businessKeyQuery:i,processInstanceName:r}).then(function(t){var r,f,i=t.taskList[0];u.taskExists=!1;i&&(u.taskExists=!0,n.ForguncyData.pageInfo.currentRowInfoCollection.setProcessInfo(i.isEnd,i.taskId,i.processInstanceId));u.success=!0;u.processInstanceId=t.processInstanceId;u.page=(f=(r=i===null||i===void 0?void 0:i.extensionElement)===null||r===void 0?void 0:r.generalSetting)===null||f===void 0?void 0:f.page;u.logText=t.logText}).catch(function(n){var t;u.success=!1;u.message=(t=n===null||n===void 0?void 0:n.message)!==null&&t!==void 0?t:n})];case 1:return f.sent(),[2,u]}})})},i}(n.CommandBase);n.ProcessStartCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ProcessStartCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){var t;return __awaiter(this,void 0,void 0,function(){var r,f,i,u,e,o,s,h;return __generator(this,function(c){switch(c.label){case 0:return(r=this.CommandParam,f=r.StartType,i="",!(f===0))?[3,1]:(i=r.ProcessName,[3,3]);case 1:if(!(f===1))return[3,3];if(u=this.evaluateFormula(r.ProcessDefinitionId),u&&u._error){alert(n.RS.ProcessDefinitionId_EvaluteError);throw n.RS.ProcessDefinitionId_EvaluteError;}return[4,n.BPM.Engine.processDefinitionService.getProcessDefinitionResourceNameAsync(u)];case 2:e=c.sent();i=e.substring(0,e.lastIndexOf("."));c.label=3;case 3:return o="".concat(n.ForguncyData.ForguncyRoot,"BPM/Portal/modeler?template=").concat(i,".bpmn&lang=").concat(n.RS.Culture.toLowerCase()),s=n.ForguncyData.pageInfo.pageID,((t=window===null||window===void 0?void 0:window.TabManager)===null||t===void 0?void 0:t.TabContainer.getCurrentInstance(window,s))?(h=new TabManager.Tab(!1,"",window.location.origin+o,i,0),TabManager.TabContainer.addTab(h,s)):n.Common.openWindow(o),[2,n.CommandResult.completed]}})})},i}(n.CommandBase);n.ProcessOpenOnlineCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ProcessOpenOnlineCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.execute=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.openDelegationListDialog()];case 1:return t.sent(),[2,n.CommandResult.completed]}})})},i.prototype.openDelegationListDialog=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(){return t=new n.BPM.Delegation.DelegationListDialog,t.appendExtralPopup(),t.show(),[2]})})},i}(n.CommandBase);n.ProcessDelegateSettingCommand=t;n.CommandFactory.registerCommand("Forguncy.Model.ProcessDelegateSettingCommand, ServerDesignerCommon",t)})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(t){var i;(function(i){var r=function(){function i(){}return i.getUserInfos=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,t.Engine.delegationConfigurationService.getUserInfosAsync(n)];case 1:return[2,i.sent()||[]]}})})},i.dateFormatValue=function(t){return n.FormatHelper.formatValue(new Date(t),"YYYY-MM-DD hh:mm:ss")},i.delegationToNames=function(t,i){return i.map(function(i){var u,f=i.delegateTo,r=t.find(function(n){var t=n.UserName;return t===f});if(!r)return"(".concat(n.RS.CreateDelegateDialog_User_NotExist,")").concat(f);var e=r.FullName,o=n.Common.IsEmpty(e)?f:e,s=(u=r===null||r===void 0?void 0:r.IsEnabled)!==null&&u!==void 0?u:!0;return s?o:"(".concat(n.RS.CreateDelegateDialog_User_Disabled,")").concat(o)}).join(",")},i.delegationProcessNames=function(i,r){var u=i.delegationProcessType,f=i.delegateProcessDetails;switch(u){case t.DelegationConfiguration.DelegationProcessType.Select:return f.map(function(t){var i=t.processDefinitionKey,u=r.find(function(n){var t=n.key;return t===i});return u?u.name:"(".concat(n.RS.CreateDelegateDialog_User_NotExist,")").concat(i)}).join(",");case t.DelegationConfiguration.DelegationProcessType.All:return n.RS.DelegationListDialog_Table_AllProcesses;default:throw new Error("error delegation process type");}},i.deletgationListTable=function(t,r,u){var f=t.id,s=t.delegateToDetails,e=t.startTime,o=t.endTime,h=t.createDate,c=t.description,l=t.enabled;return{key:f,id:f,delegationToNames:i.delegationToNames(u,s),delegationProcessNames:i.delegationProcessNames(t,r),startTime:n.Common.IsEmpty(e)?n.RS.DelegationListDialog_Table_EmptyTime:i.dateFormatValue(e),endTime:n.Common.IsEmpty(o)?n.RS.DelegationListDialog_Table_EmptyTime:i.dateFormatValue(o),createDate:i.dateFormatValue(h),description:c,enabled:!!l}},i}(),u=function(u){function e(){var t=u.call(this)||this;return t.defaultUI=f,t.identify("fgc-bpm-delegate-list-dialog"),t.title=n.RS.DelegationListDialog_Title,t.initUI(),t.initUIEvents(),t.initDataAsync(),t}return __extends(e,u),e.prototype.initUI=function(){this.createDelegateButton=new n.UI.Button(n.RS.DelegationListDialog_CreateDelegation).addCss({height:"30px","margin-bottom":"15px",color:"#fff","border-color":"var(--FGC_ButtonPrimary)",background:"var(--FGC_ButtonPrimary)",border:"4px"}).addAttrs({AutomationId:"create_delegate_button"});this.deletgationListTable=new o({isNeedIndex:!0,columns:[{key:"delegationToNames",label:n.RS.DelegationListDialog_Table_DataColumn_Agent,width:"180px"},{key:"delegationProcessNames",label:n.RS.DelegationListDialog_Table_DataColumn_DelegatedProcess,width:"180px"},{key:"startTime",label:n.RS.DelegationListDialog_Table_DataColumn_StartTime,width:"150px"},{key:"endTime",label:n.RS.DelegationListDialog_Table_DataColumn_EndTime,width:"150px"},{key:"createDate",label:n.RS.DelegationListDialog_Table_DataColumn_CreateDate,width:"150px"},{key:"description",label:n.RS.DelegationListDialog_Table_DataColumn_Description,width:"150px"},{key:"status",label:n.RS.DelegationListDialog_Table_DataColumn_Enable,type:"Custom",width:"50px"},{key:"update",label:n.RS.DelegationListDialog_Table_DataColumn_Update,type:"Action"},{key:"delete",label:n.RS.DelegationListDialog_Table_DataColumn_Delete,type:"Action"},]}).addAttrs({AutomationId:"deletgation_list_table"});this.outerlayout=new n.UI.FlexLayout(1).add((new n.UI.FlexLayout).add(this.createDelegateButton),this.deletgationListTable)},e.prototype.initUIEvents=function(){var n=this;this.createDelegateButton.on("Clicked",function(){n.openCreateDelegateDialog()})},e.prototype.initDataAsync=function(){var n;return __awaiter(this,void 0,void 0,function(){var f,i,u,e,o;return __generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),[4,t.Engine.processDefinitionService.getProcessDefinitionDeploymentAsync()];case 1:return f=s.sent()||[],[4,t.Engine.delegationConfigurationService.queryConfigurationInfoAsync()];case 2:return(i=s.sent(),!i)?[2]:(u=new Set,i.forEach(function(n){var t=n.delegateToDetails;t&&t.forEach(function(n){var t=n.delegateTo;return u.add(t)})}),[4,r.getUserInfos(Array.from(u))]);case 3:return e=s.sent(),this.deletgationListTable.dataSource=i.map(function(n){return r.deletgationListTable(n,f,e)}),((n=this.deletgationListTable.dataSource)===null||n===void 0?void 0:n.length)>0&&(this.deletgationListTable.selectedKeys.clear(),this.deletgationListTable.selectedKeys.add(this.deletgationListTable.dataSource[0].key)),this.deletgationListTable.refresh(),[3,5];case 4:return o=s.sent(),console.log(o),[3,5];case 5:return[2]}})})},e.prototype.openCreateDelegateDialog=function(){var r=this,n=new i.CreateDelegateDialog;n.on("Confirm",function(i,u){return __awaiter(r,void 0,void 0,function(){var i;return __generator(this,function(r){switch(r.label){case 0:if(u&&(u.cancel=!0),!n.verify())return[2,null];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.Engine.delegationConfigurationService.createConfigurationAsync(n.getDialogResult())];case 2:return r.sent(),u&&(u.cancel=!1),n.dispose(),this.initDataAsync(),[3,4];case 3:return i=r.sent(),console.log(i),alert(i),[3,4];case 4:return[2]}})})});n.appendExtralPopup();n.show()},e}(t.BPMDialog);i.DelegationListDialog=u;var f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new e(this.target)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footer",{get:function(){return null},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerlayout.createUI())},t}(n.UI.DialogContentUI),o=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=s,t}return __extends(t,n),t}(n.UI.Table),s=function(u){function f(){return u!==null&&u.apply(this,arguments)||this}return __extends(f,u),f.prototype._getLayoutHeaderBaseTemplate=function(n){var t=n.key,i=n.label;switch(t){case"delegationToNames":case"delegationProcessNames":case"startTime":case"endTime":case"createDate":case"description":return'<th data-key="'.concat(t,'" class="table-align-left">').concat(i,"<\/th>");default:return'<th data-key="'.concat(t,'">').concat(i,"<\/th>")}},f.prototype._getDataColumnBaseTemplate=function(n){var t=n.key;switch(t){case"delegationToNames":case"delegationProcessNames":case"startTime":case"endTime":case"createDate":case"description":return'<td data-key="'.concat(t,'" class="table-align-left"><\/td>');default:return'<td data-key="'.concat(t,'"><\/td>')}},f.prototype.getDataColumnCustomTemplate=function(n){var t=n.key;switch(t){case"status":return'<td><input type="checkbox" role="'.concat(t,'"><\/td>');default:return""}},f.prototype.setChildrenCellData=function(n,t,i){return u.prototype.setChildrenCellData.call(this,n,t,i),t.enabled?n.find("[role=status]").prop("checked",!0):n.find("[role=status]").prop("checked",!1),n},f.prototype.updateRowData=function(i,u){return __awaiter(this,void 0,void 0,function(){var s,f,e,h,c,l,o;return __generator(this,function(a){switch(a.label){case 0:return s=this.target.dataSource[i],[4,t.Engine.delegationConfigurationService.queryConfigurationInfoAsync({id:s.id})];case 1:return(f=a.sent(),!f||f.length!==1)?(alert(n.RS.DelegationListDialog_Error_DelegationConfigurationIsEmpty),[2]):(e=f[0],[4,t.Engine.processDefinitionService.getProcessDefinitionDeploymentAsync()]);case 2:return h=a.sent()||[],c=e.delegateToDetails.map(function(n){return n.delegateTo}),[4,r.getUserInfos(c)];case 3:return l=a.sent(),o=r.deletgationListTable(e,h,l),this.target.dataSource[i]=o,this.setChildrenRowData(u,o),[2]}})})},f.prototype.actionExecute=function(r,u,f,e){return __awaiter(this,void 0,void 0,function(){var c,l,h,o,a,v,y,p,w,s,b,k=this;return __generator(this,function(d){switch(d.label){case 0:c=u;switch(c){case"update":return[3,1];case"delete":return[3,5];case"status":return[3,10]}return[3,23];case 1:return d.trys.push([1,3,,4]),l=this.target.dataSource[r],[4,t.Engine.delegationConfigurationService.queryConfigurationInfoAsync({id:l.id})];case 2:if(h=d.sent(),!h||h.length!==1)return alert(n.RS.DelegationListDialog_Error_DelegationConfigurationIsEmpty),[2];o=new i.UpdateDelegateDialog(h[0]);o.on("Confirm",function(n,i){return __awaiter(k,void 0,void 0,function(){var n;return __generator(this,function(u){switch(u.label){case 0:if(i&&(i.cancel=!0),!o.verify())return[2,null];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,t.Engine.delegationConfigurationService.updateConfigurationAsync(o.getDialogResult())];case 2:return u.sent(),i&&(i.cancel=!1),[4,this.updateRowData(r,f)];case 3:return u.sent(),o.dispose(),[3,5];case 4:return n=u.sent(),alert(n),[3,5];case 5:return[2]}})})});return o.appendExtralPopup(),o.show(),[3,4];case 3:return a=d.sent(),alert(a),[2];case 4:return[3,23];case 5:if(s=confirm(n.RS.DelegationListDialog_Comfirm_DeleteConfuguration),!s)return[2];d.label=6;case 6:return d.trys.push([6,8,,9]),[4,t.Engine.delegationConfigurationService.deleteConfigurationAsync(e)];case 7:return d.sent(),f.empty(),[3,9];case 8:return v=d.sent(),alert(v.message),[3,9];case 9:return[3,23];case 10:y=f.find("[role=status]").is(":checked")?"enabled":"disable";p=y;switch(p){case"disable":return[3,11];case"enabled":return[3,17]}return[3,23];case 11:if(s=confirm(n.RS.DelegationListDialog_Comfirm_DisabledConfuguration),!s)return event.preventDefault(),[2];d.label=12;case 12:return d.trys.push([12,15,,16]),[4,t.Engine.delegationConfigurationService.disableConfigurationAsync(e)];case 13:return d.sent(),[4,this.updateRowData(r,f)];case 14:return d.sent(),[3,16];case 15:return w=d.sent(),alert(w.message),[3,16];case 16:return[3,23];case 17:if(s=confirm(n.RS.DelegationListDialog_Comfirm_EnabledConfuguration),!s)return event.preventDefault(),[2];d.label=18;case 18:return d.trys.push([18,21,,22]),[4,t.Engine.delegationConfigurationService.enableConfigurationAsync(e)];case 19:return d.sent(),[4,this.updateRowData(r,f)];case 20:return d.sent(),[3,22];case 21:return b=d.sent(),alert(b.message),[3,22];case 22:return[3,23];case 23:return[2]}})})},f}(n.UI.TableUI)})(i=t.Delegation||(t.Delegation={}))})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Forguncy;(function(n){var t;(function(t){var i;(function(i){var r=function(i){function r(t){t===void 0&&(t={});var r=i.call(this)||this;return r.tableDataSourceConvert={processTable:function(n){var i=n.key,r=n.name,t=n.description;return{key:i,id:i,name:r,description:t!==null&&t!==void 0?t:""}},agentsTable:function(t,i){var u,r=i.find(function(n){var i=n.UserName;return i===t});if(!r)return{key:t,UserName:"(".concat(n.RS.CreateDelegateDialog_User_NotExist,")").concat(t),FullName:"",Email:""};var f=r.UserName,e=r.FullName,o=r.Email,s=(u=r===null||r===void 0?void 0:r.IsEnabled)!==null&&u!==void 0?u:!0;return s?{key:t,UserName:f,FullName:e,Email:o}:{key:t,UserName:"(".concat(n.RS.CreateDelegateDialog_User_Disabled,")").concat(f),FullName:e,Email:o}}},r.defaultUI=u,r.identify("fgc-bpm-create-delegate-dialog"),r.title=n.RS.CreateDelegateDialog_Title,r.configurationInfo=t,r.initUI(),r.initUIEvents(),r.initDataAsync(),r}return __extends(r,i),r.prototype.initUI=function(){return __awaiter(this,void 0,void 0,function(){var r,i=this;return __generator(this,function(){return this.startTimePicker=(new n.UI.DateTimePicker).addAttrs({AutomationId:"start_time_picker"}),this.endTimePicker=(new n.UI.DateTimePicker).addAttrs({AutomationId:"end_time_picker"}),this.selectAgentsButton=new n.UI.Button(n.RS.CreateDelegateDialog_Agent_SelectAgent).addCss({color:"#fff","border-color":"var(--FGC_ButtonPrimary)",background:"var(--FGC_ButtonPrimary)",border:"4px",width:"100px",height:"26px","line-height":"26px",padding:0,"text-align":"center","font-size":"13.33px"}).addAttrs({AutomationId:"select_agents_button"}),this.agentsTable=new o({columns:[{key:"UserName",label:n.RS.ForguncyUserAvator_UserName,width:"180px"},{key:"FullName",label:n.RS.ForguncyUserAvator_FullName,width:"180px"},{key:"Email",label:n.RS.ForguncyUserAvator_Email,width:"180px"},{key:"delete",label:n.RS.CreateDelegateDialog_Agent_DeleteAgent,type:"Action"}]}).addAttrs({AutomationId:"agents_table"}),this.radios={all:{ui:new n.UI.Radio(n.RS.CreateDelegateDialog_DelegatedProcess_AllProcesses,"delegationProcessType").addAttrs({role:"all",AutomationId:"delegation_process_type_all"}),delegationProcessType:t.DelegationConfiguration.DelegationProcessType.All,checkedEvent:function(){i.processTable.hide()}},select:{ui:new n.UI.Radio(n.RS.CreateDelegateDialog_DelegatedProcess_SelectProcesses,"delegationProcessType").addAttrs({role:"select",AutomationId:"delegation_process_type_select"}),delegationProcessType:t.DelegationConfiguration.DelegationProcessType.Select,checkedEvent:function(){i.processTable.show()}}},this.processTable=new e({isMultiSelect:!0,columns:[{key:"name",label:n.RS.CreateDelegateDialog_ProcessTable_Title,width:"280px"},{key:"description",label:n.RS.CreateDelegateDialog_ProcessTable_Description,width:"290px"},]}).addAttrs({AutomationId:"process_table"}),this.descriptionTextArea=new n.UI.TextArea({autosize:{minRows:3,maxRows:3},placeholder:n.RS.CreateDelegateDialog_Description_Placeholder}).addAttrs({AutomationId:"description_text_area"}),this.outerlayout=new n.UI.FlexLayout(1).add((new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_Tip).addCss({height:"38px","line-height":"38px",color:"#D2A417","font-size":"14.67px"})),new n.UI.FlexLayout(1).add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_DelegatedTime_Title).addClass("fgc-bpm-create-delegate-dialog-group-title"),(new n.UI.FlexLayout).addClass("fgc-bpm-create-delegate-dialog-group-content").addClass("fgc-bpm-create-delegate-dialog-group-item-delegate-time").add((new n.UI.FlexLayout).add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_DelegatedTime_StartTime),this.startTimePicker),(new n.UI.FlexLayout).addCss({"margin-left":"40px"}).add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_DelegatedTime_EndTime),this.endTimePicker))),new n.UI.FlexLayout(1).add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_Agent_Title).addClass("fgc-bpm-create-delegate-dialog-group-title"),new n.UI.FlexLayout(1).addClass("fgc-bpm-create-delegate-dialog-group-content").add((new n.UI.FlexLayout).add(this.selectAgentsButton),new n.UI.TextBlock(n.RS.CreateDelegateDialog_Agent_Tip).addClass("fgc-bpm-create-delegate-dialog-group-tip"),this.agentsTable.addCss({height:"160px","margin-bottom":"30px"}))),new n.UI.FlexLayout(1).add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_DelegatedProcess_Title).addClass("fgc-bpm-create-delegate-dialog-group-title"),new n.UI.FlexLayout(1).addClass("fgc-bpm-create-delegate-dialog-group-content").add((new n.UI.FlexLayout).addClass("fgc-bpm-create-delegate-dialog-group-item-delegate-process").add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_DelegatedProcess_Type),(r=new n.UI.RadioGroup).add.apply(r,Object.keys(this.radios).map(function(n){return i.radios[n].ui}))),new n.UI.TextBlock(n.RS.CreateDelegateDialog_DelegatedProcess_Tip).addClass("fgc-bpm-create-delegate-dialog-group-tip"),this.processTable.addCss({height:"180px"}))),new n.UI.FlexLayout(1).addClass("fgc-bpm-create-delegate-dialog-group-item-description").add(new n.UI.TextBlock(n.RS.CreateDelegateDialog_Description_Title).addClass("fgc-bpm-create-delegate-dialog-group-title"),new n.UI.FlexLayout(1).addClass("fgc-bpm-create-delegate-dialog-group-content").add(this.descriptionTextArea))),[2]})})},r.prototype.initUIEvents=function(){var n=this;this.selectAgentsButton.on("Clicked",function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(){return this.openSelectAgentsDialog(),[2]})})});Object.keys(this.radios).forEach(function(t){var i=n.radios[t],r=i.ui,u=i.checkedEvent,f=i.delegationProcessType;r.on("Checked",function(){u();n.delegationProcessType=f})})},r.prototype.initDataAsync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return this.radios.all.ui.isChecked=!0,this.radios.all.ui.dispatch("Checked"),[4,this.initProcessTableData()];case 1:return n.sent(),[2]}})})},r.prototype.initProcessTableData=function(){return __awaiter(this,void 0,void 0,function(){var n,i,r=this;return __generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,t.Engine.processDefinitionService.getProcessDefinitionDeploymentAsync()];case 1:return n=u.sent()||[],this.processTable.dataSource=n.map(function(n){return r.tableDataSourceConvert.processTable(n)}),this.processTable.refresh(),[3,3];case 2:return i=u.sent(),console.log(i),[3,3];case 3:return[2]}})})},r.prototype.openSelectAgentsDialog=function(){var n;return __awaiter(this,void 0,void 0,function(){var u,i,r=this;return __generator(this,function(f){switch(f.label){case 0:return!this.canBeDelegatedUserInfos?(u=this,[4,t.Engine.delegationConfigurationService.getCanBeDelegatedUserInfosAsync()]):[3,2];case 1:u.canBeDelegatedUserInfos=(n=f.sent())!==null&&n!==void 0?n:[];f.label=2;case 2:i=new t.UserSelectorDialog({userInfos:this.canBeDelegatedUserInfos});i.on("Confirm",function(){var n=i.dialogResult.selectedUserInfos,f=n&&n.length>0,t,u;f&&((t=n[0].UserName,u=r.agentsTable.dataSource.some(function(n){var i=n.key;return i===t}),u)||(r.agentsTable.dataSource.push(r.tableDataSourceConvert.agentsTable(t,r.canBeDelegatedUserInfos)),r.agentsTable.refresh()))});return i.appendExtralPopup(),i.show(),[2]}})})},r.prototype.getDialogResult=function(){var r=this.agentsTable.dataSource.map(function(n){return n.key}),u=this.processTable.selectedKeys,t=this.startTimePicker.getValue(),i=this.endTimePicker.getValue();return{startTime:n.Common.IsEmpty(t)?"":t.toISOString(),endTime:n.Common.IsEmpty(i)?"":i.toISOString(),description:this.descriptionTextArea.text,delegationProcessType:this.delegationProcessType,delegateToDetails:r.map(function(n){return{delegateTo:n}}),delegateProcessDetails:Array.from(u).map(function(n){return{processDefinitionKey:n}})}},r.prototype.verify=function(){var i=this.getDialogResult(),r=i.startTime,u=i.endTime,f=i.delegateToDetails,o=i.delegationProcessType,e=i.delegateProcessDetails,s=n.Common.IsEmpty(r),h=n.Common.IsEmpty(u);return!s&&!h&&new Date(u).valueOf()<=new Date(r).valueOf()?(alert(n.RS.CreateDelegateDialog_DelegatedTime_Error_EndTimeMustEarilerStartTime),!1):(f&&f.length>0)?o===t.DelegationConfiguration.DelegationProcessType.Select&&(!e||e.length===0)?(alert(n.RS.CreateDelegateDialog_DelegatedProcess_Error_ProcessCannotBeEmpty),!1):!0:(alert(n.RS.CreateDelegateDialog_Agent_Error_AgentCannotBeEmpty),!1)},r}(t.BPMDialog);i.CreateDelegateDialog=r;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"content",{get:function(){return new f(this.target)},enumerable:!1,configurable:!0}),t}(n.UI.DialogUI),f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createChildren=function(){this.addChild(this.target.outerlayout.createUI())},t}(n.UI.DialogContentUI),e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(n.UI.Table),o=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.defaultUI=s,t}return __extends(t,n),t}(n.UI.Table),s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.actionExecute=function(n,t,i,r){switch(t){case"delete":var u=confirm("确定删除代理人".concat($(i).find('td[data-key="'.concat(r,'"]')).text(),"吗？"));if(!u)return;this.target.dataSource.splice(n,1);$(i).remove()}},t}(n.UI.TableUI)})(i=t.Delegation||(t.Delegation={}))})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},__spreadArray=this&&this.__spreadArray||function(n,t,i){if(i||arguments.length===2)for(var r=0,f=t.length,u;r<f;r++)!u&&r in t||(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return n.concat(u||Array.prototype.slice.call(t))},Forguncy;(function(n){var t;(function(t){var i;(function(i){var r=function(i){function r(t){var r=i.call(this,t)||this;return r.title=n.RS.UpdateDelegateDialog_Title,r}return __extends(r,i),r.prototype.getDialogResult=function(){var n=i.prototype.getDialogResult.call(this);return __assign({id:this.configurationInfo.id},n)},r.prototype.initProcessTableData=function(){return __awaiter(this,void 0,void 0,function(){var i,u,f,r,e,o,s,h,c=this;return __generator(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),i=this.configurationInfo,u=i.delegationProcessType,f=i.delegateProcessDetails,[4,t.Engine.processDefinitionService.getProcessDefinitionDeploymentAsync()];case 1:return r=l.sent()||[],e=u===t.DelegationConfiguration.DelegationProcessType.Select,o=e&&f||[],s=o.filter(function(n){var t=n.processDefinitionKey;return r.findIndex(function(n){var i=n.key;return i===t})===-1}).map(function(t){var i=t.processDefinitionKey;return{key:i,name:"(".concat(n.RS.CreateDelegateDialog_User_NotExist,")").concat(i),description:""}}),this.processTable.dataSource=__spreadArray(__spreadArray([],s,!0),r,!0).map(function(n){return c.tableDataSourceConvert.processTable(n)}),this.processTable.refresh(),[3,3];case 2:return h=l.sent(),console.log(h),[3,3];case 3:return[2]}})})},r.prototype.initDataAsync=function(){return __awaiter(this,void 0,void 0,function(){var n,r,u,f,e,o,s,h,c,l,a=this;return __generator(this,function(v){switch(v.label){case 0:return[4,i.prototype.initDataAsync.call(this)];case 1:return v.sent(),n=this.configurationInfo,r=n.startTime,u=n.endTime,f=n.delegateToDetails,e=n.delegationProcessType,o=n.delegateProcessDetails,s=n.description,this.startTimePicker.setValue(r),this.endTimePicker.setValue(u),h=this.configurationInfo.delegateToDetails.map(function(n){return n.delegateTo}),[4,t.Engine.delegationConfigurationService.getUserInfosAsync(h)];case 2:c=v.sent();this.agentsTable.dataSource=f.map(function(n){var t=n.delegateTo;return a.tableDataSourceConvert.agentsTable(t,c)});this.agentsTable.refresh();switch(e){case t.DelegationConfiguration.DelegationProcessType.Select:this.radios.select.ui.isChecked=!0;this.radios.select.ui.dispatch("Checked");l=o.map(function(n){return n.processDefinitionKey});this.processTable.selectedKeys=new Set(l);this.processTable.refresh();break;case t.DelegationConfiguration.DelegationProcessType.All:this.radios.all.ui.isChecked=!0;this.radios.all.ui.dispatch("Checked");break;default:throw new Error("error delegation process type");}return this.descriptionTextArea.text=s,[2]}})})},r}(i.CreateDelegateDialog);i.UpdateDelegateDialog=r})(i=t.Delegation||(t.Delegation={}))})(t=n.BPM||(n.BPM={}))})(Forguncy||(Forguncy={}))
;var Forguncy;(function(n){var u=function(){function i(){}return Object.defineProperty(i,"NotificationHub",{get:function(){var n;return(n=i.notificationHub)!==null&&n!==void 0?n:new f},enumerable:!1,configurable:!0}),i.Init=function(){if(!i.notificationHub)try{t.Init();i.Create()}catch(r){n.HubManager.notificationHub=null}},i.Create=function(){var u=n.ForguncyData.ForguncyRoot+"ForguncyHub/SR",r=(new signalR.HubConnectionBuilder).withUrl(u).configureLogging(signalR.LogLevel.None).withAutomaticReconnect({nextRetryDelayInMilliseconds:function(){return 5e3}}).build();r.on("ExecuteCommand",function(n){i.ExecuteCommand(n)});r.on("AskClientSubscribeInfoClient",function(r,u){var f,e;u.isSubscribed=t.CurrentSubscribeNotification.UserName===n.ForguncyData.userInfo.UserName&&((e=(f=t.CurrentSubscribeNotification.MessageInfo)===null||f===void 0?void 0:f.get(u===null||u===void 0?void 0:u.notificationName))===null||e===void 0?void 0:e.length)>0;i.NotificationHub.invoke("ReturnToServerSubscribeInfoClient",r,u)});r.onreconnected(function(){n.HubManager.ConnectionSuccess()});r.start().then(function(){n.HubManager.ConnectionSuccess()});i.notificationHub=r},i.ExecuteCommand=function(r){var f,e=r.messageDic[i.NotificationHub.connectionId],u;e!==null&&(u=null,r.params&&r.params.length>0&&(u={},r.params.forEach(function(n){u[n.name]=n.value})),(f=t.CurrentSubscribeNotification.MessageInfo.get(r.messageName))===null||f===void 0?void 0:f.forEach(function(t){var r=t.CommandParam,f="",e;r.MergeCommand||(f=i.uuid());e=t.ID+t.RuntimePageName+f;n.ForguncyData.commandExcutor.excuteCommand(r.CommandList,{runTimePageName:t.RuntimePageName,commandTrigger:null,commandID:e,eventType:"NotificationCommand",initParams:u,locationString:n.RS.NotificationLocationString})}))},i.ConnectionSuccess=function(){var n;i.notificationHub.invoke("GetClientId").then(function(n){i.clientId=n});i.UpdateUserName();t.CurrentSubscribeNotification.MessageInfo.forEach(function(n,t){n===null||n===void 0?void 0:n.forEach(function(n){i.SubscribeNotification(t,n.CommandParam,n.RuntimePageName)})});(n=i.waitSubscribeNotification)===null||n===void 0?void 0:n.forEach(function(n){n.Subscribe===!0?i.SubscribeNotification(n.Name,n.CommandParam,n.RuntimePageName):i.UnSubscribeNotification(n.Name)});i.waitSubscribeNotification=[]},i.UpdateUserName=function(){i.NotificationHub.state===signalR.HubConnectionState.Connected&&i.NotificationHub.invoke("UpdateConnectionNameAsync",i.NotificationHub.connectionId,n.ForguncyData.userInfo.UserName)},i.SubscribeNotification=function(u,f,o){var c,h,s;i.NotificationHub.state===signalR.HubConnectionState.Connected?(i.NotificationHub.invoke("SubscribeCommand",u,f.ID).catch(function(){alert(n.RS.NotificationUnauthorized)}),h=new e,h.ID=f.ID,h.RuntimePageName=o,h.CommandParam=f,t.SetStorgeItem(u,!1,h)):(i.waitSubscribeNotification=(c=i.waitSubscribeNotification)!==null&&c!==void 0?c:[],s=new r,s.Name=u,s.ID=f.ID,s.Subscribe=!0,s.CommandParam=f,s.RuntimePageName=o,i.waitSubscribeNotification.push(s))},i.UnSubscribeNotification=function(n){var f,u;i.NotificationHub.state===signalR.HubConnectionState.Connected?(i.NotificationHub.invoke("UnSubscribeCommand",n),t.SetStorgeItem(n,!0,null)):(i.waitSubscribeNotification=(f=i.waitSubscribeNotification)!==null&&f!==void 0?f:[],u=new r,u.Name=n,u.Subscribe=!1,i.waitSubscribeNotification.push(u))},i.GetconnectionId=function(){return i.clientId},i.uuid=function(){for(var n=[],t=0;t<36;t++)n[t]="0123456789abcdefghijklmnopqrstuvwxyz".substr(Math.floor(Math.random()*36),1);return n[8]=n[13]=n[18]=n[23]="-",n.join("")},i.destoryRunTimePage=function(n){t.DestoryRunTimePage(n)},i.GetSubscribeStack=function(){return t.GetSubscribeStack()},i}();n.HubManager=u;var f=function(){function n(){}return n.prototype.invoke=function(){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Promise(function(){})},n.prototype.on=function(){},n}(),t=function(){function t(){}return Object.defineProperty(t,"_storageName",{get:function(){var n="C8CAE81063DA4293BE3D4BA79EEE8258";try{window.self!==window.top&&(n+=window.name,window.addEventListener("unload",function(){sessionStorage.removeItem(n)}))}catch(t){}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CurrentSubscribeNotification",{get:function(){for(var r,n;t._storageItem.length>0;)if(n=t._storageItem[t._storageItem.length-1],n.Equal(new i)){(r=n===null||n===void 0?void 0:n.MessageInfo)===null||r===void 0?void 0:r.forEach(function(n){n.forEach(function(i,r){t.RunTimePageExist(i.RuntimePageName)===!1&&n.splice(r,1)})});break}else t._storageItem.pop();return t._storageItem.length===0&&t._storageItem.push(new i),t.SaveToStorage(),t._storageItem[t._storageItem.length-1]},enumerable:!1,configurable:!0}),t.RunTimePageExist=function(t){return n.ForguncyData.pageInfo.pageElementManager.cells.getAllRunTimePageName().indexOf(t)!==-1},t.Init=function(){t._storageItem=[];$(document).on("forguncyPageloaded",function(){t._storageItem.length>0?(n.ForguncyData.pageInfo.isPopup!==!0&&(t._storageItem=[]),t._storageItem.push(new i),t.SaveToStorage()):t._storageItem.push(t.LoadStorage())});n.Page.bind("popupclosed",null,function(){t._storageItem.pop();t.SaveToStorage()})},t.GetSubscribeStack=function(){return t._storageItem},t.SaveToStorage=function(){if(t._storageItem.length>0){var n=t._storageItem[0].GetJsonObjectString();sessionStorage.setItem(t._storageName,window.btoa(unescape(encodeURIComponent(n))))}else sessionStorage.removeItem(t._storageName)},t.LoadStorage=function(){var n=new i,u=sessionStorage.getItem(t._storageName),r;return u?(r=decodeURIComponent(escape(window.atob(sessionStorage.getItem(t._storageName)))),n.LoadJsonObject(r),n):n},t.SetStorgeItem=function(n,i,r){var f,u;i===!0?t.CurrentSubscribeNotification.MessageInfo.delete(n):(u=(f=t.CurrentSubscribeNotification.MessageInfo.get(n))!==null&&f!==void 0?f:[],u.filter(function(n){return n.ID===r.ID&&n.RuntimePageName===r.RuntimePageName}).length===0&&u.push(r),t.CurrentSubscribeNotification.MessageInfo.set(n,u));t.SaveToStorage()},t.DestoryRunTimePage=function(n){var i=t.CurrentSubscribeNotification;i.MessageInfo.forEach(function(t,i,r){t=t.filter(function(t){return n.indexOf(t.RuntimePageName)===-1});t&&t.length===0?r.delete(i):r.set(i,t)});t.SaveToStorage()},t}(),o=function(){function n(){}return n}(),r=function(){function n(){}return n}(),s=function(){function n(){}return n}(),e=function(){function n(){}return n}(),i=function(){function t(){this.PageName=n.ForguncyData.pageInfo.isPopup===!0?n.ForguncyData.pageInfo.pageName+n.ForguncyData.pageInfo.pageID:n.ForguncyData.pageInfo.pageName;this.UserName=n.ForguncyData.userInfo.UserName;this.MessageInfo=new Map;this.MetaDataVersion=n.StaticData.MetaDataVersion}return t.prototype.GetJsonObjectString=function(){var n={};return n.UserName=this.UserName,n.PageName=this.PageName,n.MetaDataVersion=this.MetaDataVersion,n.MessageInfo=Array.from(this.MessageInfo.entries()),JSON.stringify(n)},t.prototype.LoadJsonObject=function(n){var t=JSON.parse(n);this.MessageInfo=t.MessageInfo&&!jQuery.isEmptyObject(t.MessageInfo)?new Map(t.MessageInfo):new Map;this.PageName=t.PageName;this.UserName=t.UserName;this.MetaDataVersion=t.MetaDataVersion},t.prototype.Equal=function(n){return this.PageName===n.PageName&&this.UserName===n.UserName&&this.MetaDataVersion===n.MetaDataVersion},t}(),h=function(){function n(){}return n}()})(Forguncy||(Forguncy={}))
;+function(n){"use strict";var t=function(n,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null;this.init("tooltip",n,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1};t.prototype.init=function(t,i,r){var f,e,u,o,s;for(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),f=this.options.trigger.split(" "),e=f.length;e--;)if(u=f[e],u=="click")this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else if(u!="manual"){o=u=="hover"?"mouseenter":"focusin";s=u=="hover"?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this));this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this))}this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()};t.prototype.getDefaults=function(){return t.DEFAULTS};t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t};t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r)}),t};t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){i.hoverState=="in"&&i.show()},i.options.delay.show)};t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){i.hoverState=="out"&&i.hide()},i.options.delay.hide)};t.prototype.show=function(){var h=n.Event("show.bs."+this.type),u,i,v,s;if(this.hasContent()&&this.enabled){if(this.$element.trigger(h),h.isDefaultPrevented())return;u=this;i=this.tip();this.setContent();this.options.animation&&i.addClass("fade");var t=typeof this.options.placement=="function"?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,l=c.test(t);l&&(t=t.replace(c,"")||"top");i.detach().css({top:0,left:0,display:"block"}).addClass(t);this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var r=this.getPosition(),f=i[0].offsetWidth,e=i[0].offsetHeight;if(l){var o=this.$element.parent(),y=t,a=document.documentElement.scrollTop||document.body.scrollTop,p=this.options.container=="body"?window.innerWidth:o.outerWidth(),w=this.options.container=="body"?window.innerHeight:o.outerHeight(),b=this.options.container=="body"?0:o.offset().left;t=t=="bottom"&&r.top+r.height+e-a>w?"top":t=="top"&&r.top-a-e<0?"bottom":t=="right"&&r.right+f>p?"left":t=="left"&&r.left-f<b?"right":t;i.removeClass(y).addClass(t)}v=this.getCalculatedOffset(t,r,f,e);this.applyPlacement(v,t);this.hoverState=null;s=function(){u.$element.trigger("shown.bs."+u.type)};n.support.transition&&this.$tip.hasClass("fade")?i.one(n.support.transition.end,s).emulateTransitionEnd(150):s()}};t.prototype.applyPlacement=function(t,i){var c,r=this.tip(),l=r[0].offsetWidth,e=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),s=parseInt(r.css("margin-left"),10),f,u,h;isNaN(o)&&(o=0);isNaN(s)&&(s=0);t.top=t.top+o;t.left=t.left+s;n.offset.setOffset(r[0],n.extend({using:function(n){r.css({top:Math.round(n.top),left:Math.round(n.left)})}},t),0);r.addClass("in");f=r[0].offsetWidth;u=r[0].offsetHeight;i=="top"&&u!=e&&(c=!0,t.top=t.top+e-u);/bottom|top/.test(i)?(h=0,t.left<0&&(h=t.left*-2,t.left=0,r.offset(t),f=r[0].offsetWidth,u=r[0].offsetHeight),this.replaceArrow(h-l+f,f,"left")):this.replaceArrow(u-e,u,"top");c&&r.offset(t)};t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i,n?50*(1-n/t)+"%":"")};t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t);n.removeClass("fade in top bottom left right")};t.prototype.hide=function(){function u(){t.hoverState!="in"&&i.detach();t.$element.trigger("hidden.bs."+t.type)}var t=this,i=this.tip(),r=n.Event("hide.bs."+this.type);if(this.$element.trigger(r),!r.isDefaultPrevented())return i.removeClass("in"),n.support.transition&&this.$tip.hasClass("fade")?i.one(n.support.transition.end,u).emulateTransitionEnd(150):u(),this.hoverState=null,this};t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||typeof n.attr("data-original-title")!="string")&&n.attr("data-original-title",n.attr("title")||"").attr("title","")};t.prototype.hasContent=function(){return this.getTitle()};t.prototype.getPosition=function(){var t=this.$element[0];return n.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())};t.prototype.getCalculatedOffset=function(n,t,i,r){return n=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-i/2}:n=="top"?{top:t.top-r,left:t.left+t.width/2-i/2}:n=="left"?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width}};t.prototype.getTitle=function(){var t=this.$element,n=this.options;return t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title)};t.prototype.tip=function(){return this.$tip=this.$tip||n(this.options.template)};t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")};t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)};t.prototype.enable=function(){this.enabled=!0};t.prototype.disable=function(){this.enabled=!1};t.prototype.toggleEnabled=function(){this.enabled=!this.enabled};t.prototype.toggle=function(t){var i=t?n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)};t.prototype.destroy=function(){clearTimeout(this.timeout);this.hide().$element.off("."+this.type).removeData("bs."+this.type)};Forguncy&&(Forguncy.Tooltip=t)}(jQuery,Forguncy)
;+function(n){"use strict";function r(i){n(f).remove();n(t).each(function(){var t=u(n(this)),r={relatedTarget:this};t.hasClass("open")&&((t.trigger(i=n.Event("hide.bs.dropdown",r)),i.isDefaultPrevented())||t.removeClass("open").trigger("hidden.bs.dropdown",r))})}function u(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent()}var f=".dropdown-backdrop",t="[data-toggle=_dropdown]",i=function(t){n(t).on("click.bs.dropdown",this.toggle)};i.prototype.toggle=function(t){var f=n(this),i,o,e;if(!f.is(".disabled, :disabled")){if(i=u(f),o=i.hasClass("open"),r(),!o){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length)n('<div class="dropdown-backdrop"/>').insertAfter(n(this)).on("click",r);if(e={relatedTarget:this},i.trigger(t=n.Event("show.bs.dropdown",e)),t.isDefaultPrevented())return;i.toggleClass("open").trigger("shown.bs.dropdown",e);f.focus()}return!1}};i.prototype.keydown=function(i){var e,o,s,h,f,r;if(/(38|40|27)/.test(i.keyCode)&&(e=n(this),i.preventDefault(),i.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=u(e),s=o.hasClass("open"),!s||s&&i.keyCode==27)return i.which==27&&o.find(t).focus(),e.click();(h=" li:not(.divider):visible a",f=o.find("[role=menu]"+h+", [role=listbox]"+h),f.length)&&(r=f.index(f.filter(":focus")),i.keyCode==38&&r>0&&r--,i.keyCode==40&&r<f.length-1&&r++,~r||(r=0),f.eq(r).focus())}};n(document).on("click.bs.dropdown.data-api",r).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation()}).on("click.bs.dropdown.data-api",t,i.prototype.toggle).on("keydown.bs.dropdown.data-api",t+", [role=menu], [role=listbox]",i.prototype.keydown)}(jQuery)
;+function(n){"use strict";var t=function(t){this.element=n(t)};t.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.data("target"),r,u,f;(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),t.parent("li").hasClass("active"))||(r=e.find(".active:last a")[0],u=n.Event("show.bs.tab",{relatedTarget:r}),t.trigger(u),u.isDefaultPrevented())||(f=n(i),this.activate(t.parent("li"),e),this.activate(f,f.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:r})}))};t.prototype.activate=function(t,i,r){function e(){u.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");t.addClass("active");f?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade");t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active");r&&r()}var u=i.find("> .active"),f=r&&n.support.transition&&u.hasClass("fade");f?u.one(n.support.transition.end,e).emulateTransitionEnd(150):e();u.removeClass("in")};Forguncy&&(Forguncy.Tab=t)}(jQuery)
;var t,e;t=self,e=function(){return(()=>{var t={d:(e,s)=>{for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"t",{value:!0})};var e,s={};t.r(s),t.d(s,{AbortError:()=>r,DefaultHttpClient:()=>H,HttpClient:()=>d,HttpError:()=>n,HttpResponse:()=>u,HttpTransportType:()=>M,HubConnection:()=>N,HubConnectionBuilder:()=>Q,HubConnectionState:()=>R,JsonHubProtocol:()=>G,LogLevel:()=>e,MessageType:()=>A,NullLogger:()=>f,Subject:()=>U,TimeoutError:()=>i,TransferFormat:()=>W,VERSION:()=>p});class n extends Error{constructor(t,e){const s=new.target.prototype;super(`${t}: Status code '${e}'`),this.statusCode=e,this.__proto__=s}}class i extends Error{constructor(t="A timeout occurred."){const e=new.target.prototype;super(t),this.__proto__=e}}class r extends Error{constructor(t="An abort occurred."){const e=new.target.prototype;super(t),this.__proto__=e}}class o extends Error{constructor(t,e){const s=new.target.prototype;super(t),this.transport=e,this.errorType="UnsupportedTransportError",this.__proto__=s}}class h extends Error{constructor(t,e){const s=new.target.prototype;super(t),this.transport=e,this.errorType="DisabledTransportError",this.__proto__=s}}class c extends Error{constructor(t,e){const s=new.target.prototype;super(t),this.transport=e,this.errorType="FailedToStartTransportError",this.__proto__=s}}class a extends Error{constructor(t){const e=new.target.prototype;super(t),this.errorType="FailedToNegotiateWithServerError",this.__proto__=e}}class l extends Error{constructor(t,e){const s=new.target.prototype;super(t),this.innerErrors=e,this.__proto__=s}}class u{constructor(t,e,s){this.statusCode=t,this.statusText=e,this.content=s}}class d{get(t,e){return this.send({...e,method:"GET",url:t})}post(t,e){return this.send({...e,method:"POST",url:t})}delete(t,e){return this.send({...e,method:"DELETE",url:t})}getCookieString(t){return""}}!function(t){t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Information=2]="Information",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Critical=5]="Critical",t[t.None=6]="None"}(e||(e={}));class f{constructor(){}log(t,e){}}f.instance=new f;const p="6.0.7";class w{static isRequired(t,e){if(null==t)throw new Error(`The '${e}' argument is required.`)}static isNotEmpty(t,e){if(!t||t.match(/^\s*$/))throw new Error(`The '${e}' argument should not be empty.`)}static isIn(t,e,s){if(!(t in e))throw new Error(`Unknown ${s} value: ${t}.`)}}class g{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&void 0===window.document}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function y(t,e){let s="";return m(t)?(s=`Binary data of length ${t.byteLength}`,e&&(s+=`. Content: '${function(t){const e=new Uint8Array(t);let s="";return e.forEach((t=>{s+=`0x${t<16?"0":""}${t.toString(16)} `})),s.substr(0,s.length-1)}(t)}'`)):"string"==typeof t&&(s=`String data of length ${t.length}`,e&&(s+=`. Content: '${t}'`)),s}function m(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}async function b(t,s,n,i,r,o,h){let c={};if(r){const t=await r();t&&(c={Authorization:`Bearer ${t}`})}const[a,l]=$();c[a]=l,t.log(e.Trace,`(${s} transport) sending data. ${y(o,h.logMessageContent)}.`);const u=m(o)?"arraybuffer":"text",d=await n.post(i,{content:o,headers:{...c,...h.headers},responseType:u,timeout:h.timeout,withCredentials:h.withCredentials});t.log(e.Trace,`(${s} transport) request complete. Response status: ${d.statusCode}.`)}class v{constructor(t,e){this.i=t,this.h=e}dispose(){const t=this.i.observers.indexOf(this.h);t>-1&&this.i.observers.splice(t,1),0===this.i.observers.length&&this.i.cancelCallback&&this.i.cancelCallback().catch((t=>{}))}}class E{constructor(t){this.l=t,this.out=console}log(t,s){if(t>=this.l){const n=`[${(new Date).toISOString()}] ${e[t]}: ${s}`;switch(t){case e.Critical:case e.Error:this.out.error(n);break;case e.Warning:this.out.warn(n);break;case e.Information:this.out.info(n);break;default:this.out.log(n)}}}}function $(){let t="X-SignalR-User-Agent";return g.isNode&&(t="User-Agent"),[t,C(p,S(),g.isNode?"NodeJS":"Browser",k())]}function C(t,e,s,n){let i="Microsoft SignalR/";const r=t.split(".");return i+=`${r[0]}.${r[1]}`,i+=` (${t}; `,i+=e&&""!==e?`${e}; `:"Unknown OS; ",i+=`${s}`,i+=n?`; ${n}`:"; Unknown Runtime Version",i+=")",i}function S(){if(!g.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function k(){if(g.isNode)return process.versions.node}function P(t){return t.stack?t.stack:t.message?t.message:`${t}`}class T extends d{constructor(e){if(super(),this.u=e,"undefined"==typeof fetch){const t=require;this.p=new(t("tough-cookie").CookieJar),this.m=t("node-fetch"),this.m=t("fetch-cookie")(this.m,this.p)}else this.m=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const t=require;this.v=t("abort-controller")}else this.v=AbortController}async send(t){if(t.abortSignal&&t.abortSignal.aborted)throw new r;if(!t.method)throw new Error("No method defined.");if(!t.url)throw new Error("No url defined.");const s=new this.v;let o;t.abortSignal&&(t.abortSignal.onabort=()=>{s.abort(),o=new r});let h,c=null;if(t.timeout){const n=t.timeout;c=setTimeout((()=>{s.abort(),this.u.log(e.Warning,"Timeout from HTTP request."),o=new i}),n)}try{h=await this.m(t.url,{body:t.content,cache:"no-cache",credentials:!0===t.withCredentials?"include":"same-origin",headers:{"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest",...t.headers},method:t.method,mode:"cors",redirect:"follow",signal:s.signal})}catch(t){if(o)throw o;throw this.u.log(e.Warning,`Error from HTTP request. ${t}.`),t}finally{c&&clearTimeout(c),t.abortSignal&&(t.abortSignal.onabort=null)}if(!h.ok){const t=await I(h,"text");throw new n(t||h.statusText,h.status)}const a=I(h,t.responseType),l=await a;return new u(h.status,h.statusText,l)}getCookieString(t){let e="";return g.isNode&&this.p&&this.p.getCookies(t,((t,s)=>e=s.join("; "))),e}}function I(t,e){let s;switch(e){case"arraybuffer":s=t.arrayBuffer();break;case"text":s=t.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:s=t.text()}return s}class _ extends d{constructor(t){super(),this.u=t}send(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new r):t.method?t.url?new Promise(((s,o)=>{const h=new XMLHttpRequest;h.open(t.method,t.url,!0),h.withCredentials=void 0===t.withCredentials||t.withCredentials,h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.setRequestHeader("Content-Type","text/plain;charset=UTF-8");const c=t.headers;c&&Object.keys(c).forEach((t=>{h.setRequestHeader(t,c[t])})),t.responseType&&(h.responseType=t.responseType),t.abortSignal&&(t.abortSignal.onabort=()=>{h.abort(),o(new r)}),t.timeout&&(h.timeout=t.timeout),h.onload=()=>{t.abortSignal&&(t.abortSignal.onabort=null),h.status>=200&&h.status<300?s(new u(h.status,h.statusText,h.response||h.responseText)):o(new n(h.response||h.responseText||h.statusText,h.status))},h.onerror=()=>{this.u.log(e.Warning,`Error from HTTP request. ${h.status}: ${h.statusText}.`),o(new n(h.statusText,h.status))},h.ontimeout=()=>{this.u.log(e.Warning,"Timeout from HTTP request."),o(new i)},h.send(t.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class H extends d{constructor(t){if(super(),"undefined"!=typeof fetch||g.isNode)this.$=new T(t);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this.$=new _(t)}}send(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new r):t.method?t.url?this.$.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(t){return this.$.getCookieString(t)}}class D{static write(t){return`${t}${D.RecordSeparator}`}static parse(t){if(t[t.length-1]!==D.RecordSeparator)throw new Error("Message is incomplete.");const e=t.split(D.RecordSeparator);return e.pop(),e}}D.RecordSeparatorCode=30,D.RecordSeparator=String.fromCharCode(D.RecordSeparatorCode);class x{writeHandshakeRequest(t){return D.write(JSON.stringify(t))}parseHandshakeResponse(t){let e,s;if(m(t)){const n=new Uint8Array(t),i=n.indexOf(D.RecordSeparatorCode);if(-1===i)throw new Error("Message is incomplete.");const r=i+1;e=String.fromCharCode.apply(null,Array.prototype.slice.call(n.slice(0,r))),s=n.byteLength>r?n.slice(r).buffer:null}else{const n=t,i=n.indexOf(D.RecordSeparator);if(-1===i)throw new Error("Message is incomplete.");const r=i+1;e=n.substring(0,r),s=n.length>r?n.substring(r):null}const n=D.parse(e),i=JSON.parse(n[0]);if(i.type)throw new Error("Expected a handshake response from the server.");return[s,i]}}var A,R;!function(t){t[t.Invocation=1]="Invocation",t[t.StreamItem=2]="StreamItem",t[t.Completion=3]="Completion",t[t.StreamInvocation=4]="StreamInvocation",t[t.CancelInvocation=5]="CancelInvocation",t[t.Ping=6]="Ping",t[t.Close=7]="Close"}(A||(A={}));class U{constructor(){this.observers=[]}next(t){for(const e of this.observers)e.next(t)}error(t){for(const e of this.observers)e.error&&e.error(t)}complete(){for(const t of this.observers)t.complete&&t.complete()}subscribe(t){return this.observers.push(t),new v(this,t)}}!function(t){t.Disconnected="Disconnected",t.Connecting="Connecting",t.Connected="Connected",t.Disconnecting="Disconnecting",t.Reconnecting="Reconnecting"}(R||(R={}));class N{constructor(t,s,n,i){this.C=0,this.S=()=>{this.u.log(e.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},w.isRequired(t,"connection"),w.isRequired(s,"logger"),w.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.u=s,this.k=n,this.connection=t,this.P=i,this.T=new x,this.connection.onreceive=t=>this.I(t),this.connection.onclose=t=>this._(t),this.H={},this.D={},this.A=[],this.R=[],this.U=[],this.N=0,this.L=!1,this.q=R.Disconnected,this.j=!1,this.M=this.k.writeMessage({type:A.Ping})}static create(t,e,s,n){return new N(t,e,s,n)}get state(){return this.q}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(t){if(this.q!==R.Disconnected&&this.q!==R.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t}start(){return this.W=this.O(),this.W}async O(){if(this.q!==R.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this.q=R.Connecting,this.u.log(e.Debug,"Starting HubConnection.");try{await this.F(),g.isBrowser&&window.document.addEventListener("freeze",this.S),this.q=R.Connected,this.j=!0,this.u.log(e.Debug,"HubConnection connected successfully.")}catch(t){return this.q=R.Disconnected,this.u.log(e.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}}async F(){this.B=void 0,this.L=!1;const t=new Promise(((t,e)=>{this.X=t,this.J=e}));await this.connection.start(this.k.transferFormat);try{const s={protocol:this.k.name,version:this.k.version};if(this.u.log(e.Debug,"Sending handshake request."),await this.V(this.T.writeHandshakeRequest(s)),this.u.log(e.Information,`Using HubProtocol '${this.k.name}'.`),this.G(),this.K(),this.Y(),await t,this.B)throw this.B}catch(t){throw this.u.log(e.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this.G(),this.Z(),await this.connection.stop(t),t}}async stop(){const t=this.W;this.tt=this.et(),await this.tt;try{await t}catch(t){}}et(t){return this.q===R.Disconnected?(this.u.log(e.Debug,`Call to HubConnection.stop(${t}) ignored because it is already in the disconnected state.`),Promise.resolve()):this.q===R.Disconnecting?(this.u.log(e.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnecting state.`),this.tt):(this.q=R.Disconnecting,this.u.log(e.Debug,"Stopping HubConnection."),this.st?(this.u.log(e.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.st),this.st=void 0,this.nt(),Promise.resolve()):(this.G(),this.Z(),this.B=t||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(t)))}stream(t,...e){const[s,n]=this.it(e),i=this.rt(t,e,n);let r;const o=new U;return o.cancelCallback=()=>{const t=this.ot(i.invocationId);return delete this.H[i.invocationId],r.then((()=>this.ht(t)))},this.H[i.invocationId]=(t,e)=>{e?o.error(e):t&&(t.type===A.Completion?t.error?o.error(new Error(t.error)):o.complete():o.next(t.item))},r=this.ht(i).catch((t=>{o.error(t),delete this.H[i.invocationId]})),this.ct(s,r),o}V(t){return this.Y(),this.connection.send(t)}ht(t){return this.V(this.k.writeMessage(t))}send(t,...e){const[s,n]=this.it(e),i=this.ht(this.at(t,e,!0,n));return this.ct(s,i),i}invoke(t,...e){const[s,n]=this.it(e),i=this.at(t,e,!1,n);return new Promise(((t,e)=>{this.H[i.invocationId]=(s,n)=>{n?e(n):s&&(s.type===A.Completion?s.error?e(new Error(s.error)):t(s.result):e(new Error(`Unexpected message type: ${s.type}`)))};const n=this.ht(i).catch((t=>{e(t),delete this.H[i.invocationId]}));this.ct(s,n)}))}on(t,e){t&&e&&(t=t.toLowerCase(),this.D[t]||(this.D[t]=[]),-1===this.D[t].indexOf(e)&&this.D[t].push(e))}off(t,e){if(!t)return;t=t.toLowerCase();const s=this.D[t];if(s)if(e){const n=s.indexOf(e);-1!==n&&(s.splice(n,1),0===s.length&&delete this.D[t])}else delete this.D[t]}onclose(t){t&&this.A.push(t)}onreconnecting(t){t&&this.R.push(t)}onreconnected(t){t&&this.U.push(t)}I(t){if(this.G(),this.L||(t=this.lt(t),this.L=!0),t){const s=this.k.parseMessages(t,this.u);for(const t of s)switch(t.type){case A.Invocation:this.ut(t);break;case A.StreamItem:case A.Completion:{const s=this.H[t.invocationId];if(s){t.type===A.Completion&&delete this.H[t.invocationId];try{s(t)}catch(t){this.u.log(e.Error,`Stream callback threw error: ${P(t)}`)}}break}case A.Ping:break;case A.Close:{this.u.log(e.Information,"Close message received from server.");const s=t.error?new Error("Server returned an error on close: "+t.error):void 0;!0===t.allowReconnect?this.connection.stop(s):this.tt=this.et(s);break}default:this.u.log(e.Warning,`Invalid message type: ${t.type}.`)}}this.K()}lt(t){let s,n;try{[n,s]=this.T.parseHandshakeResponse(t)}catch(t){const s="Error parsing handshake response: "+t;this.u.log(e.Error,s);const n=new Error(s);throw this.J(n),n}if(s.error){const t="Server returned handshake error: "+s.error;this.u.log(e.Error,t);const n=new Error(t);throw this.J(n),n}return this.u.log(e.Debug,"Server handshake complete."),this.X(),n}Y(){this.connection.features.inherentKeepAlive||(this.C=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this.Z())}K(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this.dt=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this.ft))){let t=this.C-(new Date).getTime();t<0&&(t=0),this.ft=setTimeout((async()=>{if(this.q===R.Connected)try{await this.V(this.M)}catch{this.Z()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}ut(t){const s=this.D[t.target.toLowerCase()];if(s){try{s.forEach((e=>e.apply(this,t.arguments)))}catch(s){this.u.log(e.Error,`A callback for the method ${t.target.toLowerCase()} threw error '${s}'.`)}if(t.invocationId){const t="Server requested a response, which is not supported in this version of the client.";this.u.log(e.Error,t),this.tt=this.et(new Error(t))}}else this.u.log(e.Warning,`No client method with the name '${t.target}' found.`)}_(t){this.u.log(e.Debug,`HubConnection.connectionClosed(${t}) called while in state ${this.q}.`),this.B=this.B||t||new Error("The underlying connection was closed before the hub handshake could complete."),this.X&&this.X(),this.wt(t||new Error("Invocation canceled due to the underlying connection being closed.")),this.G(),this.Z(),this.q===R.Disconnecting?this.nt(t):this.q===R.Connected&&this.P?this.gt(t):this.q===R.Connected&&this.nt(t)}nt(t){if(this.j){this.q=R.Disconnected,this.j=!1,g.isBrowser&&window.document.removeEventListener("freeze",this.S);try{this.A.forEach((e=>e.apply(this,[t])))}catch(s){this.u.log(e.Error,`An onclose callback called with error '${t}' threw error '${s}'.`)}}}async gt(t){const s=Date.now();let n=0,i=void 0!==t?t:new Error("Attempting to reconnect due to a unknown error."),r=this.yt(n++,0,i);if(null===r)return this.u.log(e.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this.nt(t);if(this.q=R.Reconnecting,t?this.u.log(e.Information,`Connection reconnecting because of error '${t}'.`):this.u.log(e.Information,"Connection reconnecting."),0!==this.R.length){try{this.R.forEach((e=>e.apply(this,[t])))}catch(s){this.u.log(e.Error,`An onreconnecting callback called with error '${t}' threw error '${s}'.`)}if(this.q!==R.Reconnecting)return void this.u.log(e.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==r;){if(this.u.log(e.Information,`Reconnect attempt number ${n} will start in ${r} ms.`),await new Promise((t=>{this.st=setTimeout(t,r)})),this.st=void 0,this.q!==R.Reconnecting)return void this.u.log(e.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this.F(),this.q=R.Connected,this.u.log(e.Information,"HubConnection reconnected successfully."),0!==this.U.length)try{this.U.forEach((t=>t.apply(this,[this.connection.connectionId])))}catch(t){this.u.log(e.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${t}'.`)}return}catch(t){if(this.u.log(e.Information,`Reconnect attempt failed because of error '${t}'.`),this.q!==R.Reconnecting)return this.u.log(e.Debug,`Connection moved to the '${this.q}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this.q===R.Disconnecting&&this.nt());i=t instanceof Error?t:new Error(t.toString()),r=this.yt(n++,Date.now()-s,i)}}this.u.log(e.Information,`Reconnect retries have been exhausted after ${Date.now()-s} ms and ${n} failed attempts. Connection disconnecting.`),this.nt()}yt(t,s,n){try{return this.P.nextRetryDelayInMilliseconds({elapsedMilliseconds:s,previousRetryCount:t,retryReason:n})}catch(n){return this.u.log(e.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${t}, ${s}) threw error '${n}'.`),null}}wt(t){const s=this.H;this.H={},Object.keys(s).forEach((n=>{const i=s[n];try{i(null,t)}catch(s){this.u.log(e.Error,`Stream 'error' callback called with '${t}' threw error: ${P(s)}`)}}))}Z(){this.ft&&(clearTimeout(this.ft),this.ft=void 0)}G(){this.dt&&clearTimeout(this.dt)}at(t,e,s,n){if(s)return 0!==n.length?{arguments:e,streamIds:n,target:t,type:A.Invocation}:{arguments:e,target:t,type:A.Invocation};{const s=this.N;return this.N++,0!==n.length?{arguments:e,invocationId:s.toString(),streamIds:n,target:t,type:A.Invocation}:{arguments:e,invocationId:s.toString(),target:t,type:A.Invocation}}}ct(t,e){if(0!==t.length){e||(e=Promise.resolve());for(const s in t)t[s].subscribe({complete:()=>{e=e.then((()=>this.ht(this.bt(s))))},error:t=>{let n;n=t instanceof Error?t.message:t&&t.toString?t.toString():"Unknown error",e=e.then((()=>this.ht(this.bt(s,n))))},next:t=>{e=e.then((()=>this.ht(this.vt(s,t))))}})}}it(t){const e=[],s=[];for(let n=0;n<t.length;n++){const i=t[n];if(this.Et(i)){const r=this.N;this.N++,e[r]=i,s.push(r.toString()),t.splice(n,1)}}return[e,s]}Et(t){return t&&t.subscribe&&"function"==typeof t.subscribe}rt(t,e,s){const n=this.N;return this.N++,0!==s.length?{arguments:e,invocationId:n.toString(),streamIds:s,target:t,type:A.StreamInvocation}:{arguments:e,invocationId:n.toString(),target:t,type:A.StreamInvocation}}ot(t){return{invocationId:t,type:A.CancelInvocation}}vt(t,e){return{invocationId:t,item:e,type:A.StreamItem}}bt(t,e,s){return e?{error:e,invocationId:t,type:A.Completion}:{invocationId:t,result:s,type:A.Completion}}}const L=[0,2e3,1e4,3e4,null];class q{constructor(t){this.$t=void 0!==t?[...t,null]:L}nextRetryDelayInMilliseconds(t){return this.$t[t.previousRetryCount]}}class j{}var M,W;j.Authorization="Authorization",j.Cookie="Cookie",function(t){t[t.None=0]="None",t[t.WebSockets=1]="WebSockets",t[t.ServerSentEvents=2]="ServerSentEvents",t[t.LongPolling=4]="LongPolling"}(M||(M={})),function(t){t[t.Text=1]="Text",t[t.Binary=2]="Binary"}(W||(W={}));class O{constructor(){this.Ct=!1,this.onabort=null}abort(){this.Ct||(this.Ct=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this.Ct}}class F{constructor(t,e,s,n){this.$=t,this.St=e,this.u=s,this.kt=new O,this.Pt=n,this.Tt=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this.kt.aborted}async connect(t,s){if(w.isRequired(t,"url"),w.isRequired(s,"transferFormat"),w.isIn(s,W,"transferFormat"),this.It=t,this.u.log(e.Trace,"(LongPolling transport) Connecting."),s===W.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[i,r]=$(),o={[i]:r,...this.Pt.headers},h={abortSignal:this.kt.signal,headers:o,timeout:1e5,withCredentials:this.Pt.withCredentials};s===W.Binary&&(h.responseType="arraybuffer");const c=await this._t();this.Ht(h,c);const a=`${t}&_=${Date.now()}`;this.u.log(e.Trace,`(LongPolling transport) polling: ${a}.`);const l=await this.$.get(a,h);200!==l.statusCode?(this.u.log(e.Error,`(LongPolling transport) Unexpected response code: ${l.statusCode}.`),this.Dt=new n(l.statusText||"",l.statusCode),this.Tt=!1):this.Tt=!0,this.xt=this.At(this.It,h)}async _t(){return this.St?await this.St():null}Ht(t,e){t.headers||(t.headers={}),e?t.headers[j.Authorization]=`Bearer ${e}`:t.headers[j.Authorization]&&delete t.headers[j.Authorization]}async At(t,s){try{for(;this.Tt;){const r=await this._t();this.Ht(s,r);try{const i=`${t}&_=${Date.now()}`;this.u.log(e.Trace,`(LongPolling transport) polling: ${i}.`);const r=await this.$.get(i,s);204===r.statusCode?(this.u.log(e.Information,"(LongPolling transport) Poll terminated by server."),this.Tt=!1):200!==r.statusCode?(this.u.log(e.Error,`(LongPolling transport) Unexpected response code: ${r.statusCode}.`),this.Dt=new n(r.statusText||"",r.statusCode),this.Tt=!1):r.content?(this.u.log(e.Trace,`(LongPolling transport) data received. ${y(r.content,this.Pt.logMessageContent)}.`),this.onreceive&&this.onreceive(r.content)):this.u.log(e.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(t){this.Tt?t instanceof i?this.u.log(e.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.Dt=t,this.Tt=!1):this.u.log(e.Trace,`(LongPolling transport) Poll errored after shutdown: ${t.message}`)}}}finally{this.u.log(e.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.Rt()}}async send(t){return this.Tt?b(this.u,"LongPolling",this.$,this.It,this.St,t,this.Pt):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this.u.log(e.Trace,"(LongPolling transport) Stopping polling."),this.Tt=!1,this.kt.abort();try{await this.xt,this.u.log(e.Trace,`(LongPolling transport) sending DELETE request to ${this.It}.`);const t={},[s,n]=$();t[s]=n;const i={headers:{...t,...this.Pt.headers},timeout:this.Pt.timeout,withCredentials:this.Pt.withCredentials},r=await this._t();this.Ht(i,r),await this.$.delete(this.It,i),this.u.log(e.Trace,"(LongPolling transport) DELETE request sent.")}finally{this.u.log(e.Trace,"(LongPolling transport) Stop finished."),this.Rt()}}Rt(){if(this.onclose){let t="(LongPolling transport) Firing onclose event.";this.Dt&&(t+=" Error: "+this.Dt),this.u.log(e.Trace,t),this.onclose(this.Dt)}}}class B{constructor(t,e,s,n){this.$=t,this.St=e,this.u=s,this.Pt=n,this.onreceive=null,this.onclose=null}async connect(t,s){if(w.isRequired(t,"url"),w.isRequired(s,"transferFormat"),w.isIn(s,W,"transferFormat"),this.u.log(e.Trace,"(SSE transport) Connecting."),this.It=t,this.St){const e=await this.St();e&&(t+=(t.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(e)}`)}return new Promise(((n,i)=>{let r,o=!1;if(s===W.Text){if(g.isBrowser||g.isWebWorker)r=new this.Pt.EventSource(t,{withCredentials:this.Pt.withCredentials});else{const e=this.$.getCookieString(t),s={};s.Cookie=e;const[n,i]=$();s[n]=i,r=new this.Pt.EventSource(t,{withCredentials:this.Pt.withCredentials,headers:{...s,...this.Pt.headers}})}try{r.onmessage=t=>{if(this.onreceive)try{this.u.log(e.Trace,`(SSE transport) data received. ${y(t.data,this.Pt.logMessageContent)}.`),this.onreceive(t.data)}catch(t){return void this.Ut(t)}},r.onerror=t=>{o?this.Ut():i(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},r.onopen=()=>{this.u.log(e.Information,`SSE connected to ${this.It}`),this.Nt=r,o=!0,n()}}catch(t){return void i(t)}}else i(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(t){return this.Nt?b(this.u,"SSE",this.$,this.It,this.St,t,this.Pt):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this.Ut(),Promise.resolve()}Ut(t){this.Nt&&(this.Nt.close(),this.Nt=void 0,this.onclose&&this.onclose(t))}}class X{constructor(t,e,s,n,i,r){this.u=s,this.St=e,this.Lt=n,this.qt=i,this.$=t,this.onreceive=null,this.onclose=null,this.jt=r}async connect(t,s){if(w.isRequired(t,"url"),w.isRequired(s,"transferFormat"),w.isIn(s,W,"transferFormat"),this.u.log(e.Trace,"(WebSockets transport) Connecting."),this.St){const e=await this.St();e&&(t+=(t.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(e)}`)}return new Promise(((n,i)=>{let r;t=t.replace(/^http/,"ws");const o=this.$.getCookieString(t);let h=!1;if(g.isNode){const e={},[s,n]=$();e[s]=n,o&&(e[j.Cookie]=`${o}`),r=new this.qt(t,void 0,{headers:{...e,...this.jt}})}r||(r=new this.qt(t)),s===W.Binary&&(r.binaryType="arraybuffer"),r.onopen=s=>{this.u.log(e.Information,`WebSocket connected to ${t}.`),this.Mt=r,h=!0,n()},r.onerror=t=>{let s=null;s="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:"There was an error with the transport",this.u.log(e.Information,`(WebSockets transport) ${s}.`)},r.onmessage=t=>{if(this.u.log(e.Trace,`(WebSockets transport) data received. ${y(t.data,this.Lt)}.`),this.onreceive)try{this.onreceive(t.data)}catch(t){return void this.Ut(t)}},r.onclose=t=>{if(h)this.Ut(t);else{let e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",i(new Error(e))}}}))}send(t){return this.Mt&&this.Mt.readyState===this.qt.OPEN?(this.u.log(e.Trace,`(WebSockets transport) sending data. ${y(t,this.Lt)}.`),this.Mt.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this.Mt&&this.Ut(void 0),Promise.resolve()}Ut(t){this.Mt&&(this.Mt.onclose=()=>{},this.Mt.onmessage=()=>{},this.Mt.onerror=()=>{},this.Mt.close(),this.Mt=void 0),this.u.log(e.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this.Wt(t)||!1!==t.wasClean&&1e3===t.code?t instanceof Error?this.onclose(t):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${t.code} (${t.reason||"no reason given"}).`)))}Wt(t){return t&&"boolean"==typeof t.wasClean&&"number"==typeof t.code}}class J{constructor(t,s={}){var n;if(this.Ot=()=>{},this.features={},this.Ft=1,w.isRequired(t,"url"),this.u=void 0===(n=s.logger)?new E(e.Information):null===n?f.instance:void 0!==n.log?n:new E(n),this.baseUrl=this.Bt(t),(s=s||{}).logMessageContent=void 0!==s.logMessageContent&&s.logMessageContent,"boolean"!=typeof s.withCredentials&&void 0!==s.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");s.withCredentials=void 0===s.withCredentials||s.withCredentials,s.timeout=void 0===s.timeout?1e5:s.timeout;let i=null,r=null;if(g.isNode){const t=require;i=t("ws"),r=t("eventsource")}g.isNode||"undefined"==typeof WebSocket||s.WebSocket?g.isNode&&!s.WebSocket&&i&&(s.WebSocket=i):s.WebSocket=WebSocket,g.isNode||"undefined"==typeof EventSource||s.EventSource?g.isNode&&!s.EventSource&&void 0!==r&&(s.EventSource=r):s.EventSource=EventSource,this.$=s.httpClient||new H(this.u),this.q="Disconnected",this.j=!1,this.Pt=s,this.onreceive=null,this.onclose=null}async start(t){if(t=t||W.Binary,w.isIn(t,W,"transferFormat"),this.u.log(e.Debug,`Starting connection with transfer format '${W[t]}'.`),"Disconnected"!==this.q)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this.q="Connecting",this.Xt=this.F(t),await this.Xt,"Disconnecting"===this.q){const t="Failed to start the HttpConnection before stop() was called.";return this.u.log(e.Error,t),await this.tt,Promise.reject(new Error(t))}if("Connected"!==this.q){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this.u.log(e.Error,t),Promise.reject(new Error(t))}this.j=!0}send(t){return"Connected"!==this.q?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.Jt||(this.Jt=new z(this.transport)),this.Jt.send(t))}async stop(t){return"Disconnected"===this.q?(this.u.log(e.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this.q?(this.u.log(e.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnecting state.`),this.tt):(this.q="Disconnecting",this.tt=new Promise((t=>{this.Ot=t})),await this.et(t),void await this.tt)}async et(t){this.zt=t;try{await this.Xt}catch(t){}if(this.transport){try{await this.transport.stop()}catch(t){this.u.log(e.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this.Vt()}this.transport=void 0}else this.u.log(e.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async F(t){let s=this.baseUrl;this.St=this.Pt.accessTokenFactory;try{if(this.Pt.skipNegotiation){if(this.Pt.transport!==M.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this.Gt(M.WebSockets),await this.Kt(s,t)}else{let e=null,n=0;do{if(e=await this.Qt(s),"Disconnecting"===this.q||"Disconnected"===this.q)throw new Error("The connection was stopped during negotiation.");if(e.error)throw new Error(e.error);if(e.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(e.url&&(s=e.url),e.accessToken){const t=e.accessToken;this.St=()=>t}n++}while(e.url&&n<100);if(100===n&&e.url)throw new Error("Negotiate redirection limit exceeded.");await this.Yt(s,this.Pt.transport,e,t)}this.transport instanceof F&&(this.features.inherentKeepAlive=!0),"Connecting"===this.q&&(this.u.log(e.Debug,"The HttpConnection connected successfully."),this.q="Connected")}catch(t){return this.u.log(e.Error,"Failed to start the connection: "+t),this.q="Disconnected",this.transport=void 0,this.Ot(),Promise.reject(t)}}async Qt(t){const s={};if(this.St){const t=await this.St();t&&(s[j.Authorization]=`Bearer ${t}`)}const[i,r]=$();s[i]=r;const o=this.Zt(t);this.u.log(e.Debug,`Sending negotiation request: ${o}.`);try{const t=await this.$.post(o,{content:"",headers:{...s,...this.Pt.headers},timeout:this.Pt.timeout,withCredentials:this.Pt.withCredentials});if(200!==t.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${t.statusCode}'`));const e=JSON.parse(t.content);return(!e.negotiateVersion||e.negotiateVersion<1)&&(e.connectionToken=e.connectionId),e}catch(t){let s="Failed to complete negotiation with the server: "+t;return t instanceof n&&404===t.statusCode&&(s+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this.u.log(e.Error,s),Promise.reject(new a(s))}}te(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+`id=${e}`:t}async Yt(t,s,n,i){let r=this.te(t,n.connectionToken);if(this.ee(s))return this.u.log(e.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=s,await this.Kt(r,i),void(this.connectionId=n.connectionId);const o=[],h=n.availableTransports||[];let a=n;for(const n of h){const h=this.se(n,s,i);if(h instanceof Error)o.push(`${n.transport} failed:`),o.push(h);else if(this.ee(h)){if(this.transport=h,!a){try{a=await this.Qt(t)}catch(t){return Promise.reject(t)}r=this.te(t,a.connectionToken)}try{return await this.Kt(r,i),void(this.connectionId=a.connectionId)}catch(t){if(this.u.log(e.Error,`Failed to start the transport '${n.transport}': ${t}`),a=void 0,o.push(new c(`${n.transport} failed: ${t}`,M[n.transport])),"Connecting"!==this.q){const t="Failed to select transport before stop() was called.";return this.u.log(e.Debug,t),Promise.reject(new Error(t))}}}}return o.length>0?Promise.reject(new l(`Unable to connect to the server with any of the available transports. ${o.join(" ")}`,o)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}Gt(t){switch(t){case M.WebSockets:if(!this.Pt.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new X(this.$,this.St,this.u,this.Pt.logMessageContent,this.Pt.WebSocket,this.Pt.headers||{});case M.ServerSentEvents:if(!this.Pt.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new B(this.$,this.St,this.u,this.Pt);case M.LongPolling:return new F(this.$,this.St,this.u,this.Pt);default:throw new Error(`Unknown transport: ${t}.`)}}Kt(t,e){return this.transport.onreceive=this.onreceive,this.transport.onclose=t=>this.Vt(t),this.transport.connect(t,e)}se(t,s,n){const i=M[t.transport];if(null==i)return this.u.log(e.Debug,`Skipping transport '${t.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${t.transport}' because it is not supported by this client.`);if(!function(t,e){return!t||0!=(e&t)}(s,i))return this.u.log(e.Debug,`Skipping transport '${M[i]}' because it was disabled by the client.`),new h(`'${M[i]}' is disabled by the client.`,i);if(!(t.transferFormats.map((t=>W[t])).indexOf(n)>=0))return this.u.log(e.Debug,`Skipping transport '${M[i]}' because it does not support the requested transfer format '${W[n]}'.`),new Error(`'${M[i]}' does not support ${W[n]}.`);if(i===M.WebSockets&&!this.Pt.WebSocket||i===M.ServerSentEvents&&!this.Pt.EventSource)return this.u.log(e.Debug,`Skipping transport '${M[i]}' because it is not supported in your environment.'`),new o(`'${M[i]}' is not supported in your environment.`,i);this.u.log(e.Debug,`Selecting transport '${M[i]}'.`);try{return this.Gt(i)}catch(t){return t}}ee(t){return t&&"object"==typeof t&&"connect"in t}Vt(t){if(this.u.log(e.Debug,`HttpConnection.stopConnection(${t}) called while in state ${this.q}.`),this.transport=void 0,t=this.zt||t,this.zt=void 0,"Disconnected"!==this.q){if("Connecting"===this.q)throw this.u.log(e.Warning,`Call to HttpConnection.stopConnection(${t}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${t}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this.q&&this.Ot(),t?this.u.log(e.Error,`Connection disconnected with error '${t}'.`):this.u.log(e.Information,"Connection disconnected."),this.Jt&&(this.Jt.stop().catch((t=>{this.u.log(e.Error,`TransportSendQueue.stop() threw error '${t}'.`)})),this.Jt=void 0),this.connectionId=void 0,this.q="Disconnected",this.j){this.j=!1;try{this.onclose&&this.onclose(t)}catch(s){this.u.log(e.Error,`HttpConnection.onclose(${t}) threw error '${s}'.`)}}}else this.u.log(e.Debug,`Call to HttpConnection.stopConnection(${t}) was ignored because the connection is already in the disconnected state.`)}Bt(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if(!g.isBrowser)throw new Error(`Cannot resolve '${t}'.`);const s=window.document.createElement("a");return s.href=t,this.u.log(e.Information,`Normalizing '${t}' to '${s.href}'.`),s.href}Zt(t){const e=t.indexOf("?");let s=t.substring(0,-1===e?t.length:e);return"/"!==s[s.length-1]&&(s+="/"),s+="negotiate",s+=-1===e?"":t.substring(e),-1===s.indexOf("negotiateVersion")&&(s+=-1===e?"?":"&",s+="negotiateVersion="+this.Ft),s}}class z{constructor(t){this.ne=t,this.ie=[],this.re=!0,this.oe=new V,this.he=new V,this.ce=this.ae()}send(t){return this.le(t),this.he||(this.he=new V),this.he.promise}stop(){return this.re=!1,this.oe.resolve(),this.ce}le(t){if(this.ie.length&&typeof this.ie[0]!=typeof t)throw new Error(`Expected data to be of type ${typeof this.ie} but was of type ${typeof t}`);this.ie.push(t),this.oe.resolve()}async ae(){for(;;){if(await this.oe.promise,!this.re){this.he&&this.he.reject("Connection stopped.");break}this.oe=new V;const t=this.he;this.he=void 0;const e="string"==typeof this.ie[0]?this.ie.join(""):z.ue(this.ie);this.ie.length=0;try{await this.ne.send(e),t.resolve()}catch(e){t.reject(e)}}}static ue(t){const e=t.map((t=>t.byteLength)).reduce(((t,e)=>t+e)),s=new Uint8Array(e);let n=0;for(const e of t)s.set(new Uint8Array(e),n),n+=e.byteLength;return s.buffer}}class V{constructor(){this.promise=new Promise(((t,e)=>[this.de,this.fe]=[t,e]))}resolve(){this.de()}reject(t){this.fe(t)}}class G{constructor(){this.name="json",this.version=1,this.transferFormat=W.Text}parseMessages(t,s){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===s&&(s=f.instance);const n=D.parse(t),i=[];for(const t of n){const n=JSON.parse(t);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case A.Invocation:this.pe(n);break;case A.StreamItem:this.we(n);break;case A.Completion:this.ge(n);break;case A.Ping:case A.Close:break;default:s.log(e.Information,"Unknown message type '"+n.type+"' ignored.");continue}i.push(n)}return i}writeMessage(t){return D.write(JSON.stringify(t))}pe(t){this.ye(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.ye(t.invocationId,"Invalid payload for Invocation message.")}we(t){if(this.ye(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")}ge(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.ye(t.error,"Invalid payload for Completion message."),this.ye(t.invocationId,"Invalid payload for Completion message.")}ye(t,e){if("string"!=typeof t||""===t)throw new Error(e)}}const K={trace:e.Trace,debug:e.Debug,info:e.Information,information:e.Information,warn:e.Warning,warning:e.Warning,error:e.Error,critical:e.Critical,none:e.None};class Q{configureLogging(t){if(w.isRequired(t,"logging"),void 0!==t.log)this.logger=t;else if("string"==typeof t){const e=function(t){const e=K[t.toLowerCase()];if(void 0!==e)return e;throw new Error(`Unknown log level: ${t}`)}(t);this.logger=new E(e)}else this.logger=new E(t);return this}withUrl(t,e){return w.isRequired(t,"url"),w.isNotEmpty(t,"url"),this.url=t,this.httpConnectionOptions="object"==typeof e?{...this.httpConnectionOptions,...e}:{...this.httpConnectionOptions,transport:e},this}withHubProtocol(t){return w.isRequired(t,"protocol"),this.protocol=t,this}withAutomaticReconnect(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return t?Array.isArray(t)?this.reconnectPolicy=new q(t):this.reconnectPolicy=t:this.reconnectPolicy=new q,this}build(){const t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const e=new J(this.url,t);return N.create(e,this.logger||f.instance,this.protocol||new G,this.reconnectPolicy)}}return Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,"indexOf",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:function(t,e){return new Uint8Array(Array.prototype.slice.call(this,t,e))},writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach,writable:!0}),s})()},"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.signalR=e():t.signalR=e();
 //@microsoft/signalr 6.0.7;